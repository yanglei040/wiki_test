{
    "hands_on_practices": [
        {
            "introduction": "精通循环矩阵的第一步是掌握其代数性质（如行列式和逆）与其谱性质（特征值）之间的深刻联系。这个练习将通过一个秩-1 更新问题，引导你运用矩阵行列式引理和循环矩阵的谱理论。通过这个计算，你将巩固如何利用离散傅里叶变换快速求解看似复杂的矩阵问题，为后续更高级的应用打下坚实基础 。",
            "id": "3545349",
            "problem": "设 $C \\in \\mathbb{C}^{4 \\times 4}$ 是一个循环矩阵，其第一列为 $c = (3,\\,-1,\\,0,\\,-1)^{\\top}$。考虑秩-1 更新 $uv^{\\ast}$，其中 $u = v = e_{1} \\in \\mathbb{C}^{4}$，$e_{1}$ 是第一个标准基向量，$(\\cdot)^{\\ast}$ 表示共轭转置。计算标量\n$$\n\\frac{\\det\\!\\big(C + u v^{\\ast}\\big)}{\\det(C)}\n$$\n的精确值。请以精确形式给出答案，无需四舍五入。",
            "solution": "问题要求计算标量 $\\frac{\\det(C + uv^{\\ast})}{\\det(C)}$，其中 $C \\in \\mathbb{C}^{4 \\times 4}$ 是一个循环矩阵，$u = v = e_1 \\in \\mathbb{C}^4$，$e_1$ 是第一个标准基向量。$C$ 的第一列由 $c = (3, -1, 0, -1)^{\\top}$ 给出。\n\n首先，我们利用矩阵行列式引理，该引理指出，对于一个可逆方阵 $A$ 以及维度相同的列向量 $u$ 和 $v$，有\n$$\n\\det(A + uv^{\\ast}) = \\det(A) (1 + v^{\\ast}A^{-1}u)\n$$\n在我们的问题中，$A = C$，并且 $u, v$ 如前所定义。如果 $C$ 是可逆的（即 $\\det(C) \\neq 0$），我们可以将所求的比值写为：\n$$\n\\frac{\\det(C + uv^{\\ast})}{\\det(C)} = 1 + v^{\\ast}C^{-1}u\n$$\n已知 $u = v = e_1$，其中 $e_1 = (1, 0, 0, 0)^{\\top}$，项 $v^{\\ast}C^{-1}u$ 变为 $e_1^{\\ast}C^{-1}e_1$。对于任意矩阵 $M$，表达式 $e_1^{\\ast}M e_1$ 只是提取其第一行第一列的元素 $(M)_{11}$。因此，我们的任务简化为计算 $1 + (C^{-1})_{11}$。\n\n为了继续，我们必须首先验证 $C$ 是可逆的。第一列为 $c = (c_0, c_1, \\dots, c_{n-1})^{\\top}$ 的 $n \\times n$ 循环矩阵的特征值由 $c$ 的离散傅里叶变换 (DFT) 给出：\n$$\n\\lambda_k = \\sum_{j=0}^{n-1} c_j \\omega^{jk}, \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\n其中 $\\omega = \\exp(2\\pi i/n)$ 是一个 $n$ 次本原单位根。\n对于本题，$n=4$，第一列是 $c = (3, -1, 0, -1)^{\\top}$，所以 $c_0=3$，$c_1=-1$，$c_2=0$，$c_3=-1$。4次单位根是 $\\omega = \\exp(2\\pi i/4) = i$。\n特征值为：\n$$\n\\lambda_0 = c_0 + c_1 + c_2 + c_3 = 3 - 1 + 0 - 1 = 1\n$$\n$$\n\\lambda_1 = c_0 + c_1 \\omega^1 + c_2 \\omega^2 + c_3 \\omega^3 = c_0 + c_1 i - c_2 - c_3 i = 3 + (-1)i + (0)(-1) + (-1)(-i) = 3 - i + i = 3\n$$\n$$\n\\lambda_2 = c_0 + c_1 \\omega^2 + c_2 \\omega^4 + c_3 \\omega^6 = c_0 - c_1 + c_2 - c_3 = 3 - (-1) + 0 - (-1) = 3 + 1 + 1 = 5\n$$\n$$\n\\lambda_3 = c_0 + c_1 \\omega^3 + c_2 \\omega^6 + c_3 \\omega^9 = c_0 - c_1 i - c_2 + c_3 i = 3 - (-1)i + (0)(-1) + (-1)i = 3 + i - i = 3\n$$\n$C$ 的特征值为 $\\{1, 3, 5, 3\\}$。矩阵的行列式是其特征值的乘积：\n$$\n\\det(C) = \\lambda_0 \\lambda_1 \\lambda_2 \\lambda_3 = 1 \\cdot 3 \\cdot 5 \\cdot 3 = 45\n$$\n由于 $\\det(C) = 45 \\neq 0$，矩阵 $C$ 是可逆的，因此我们对矩阵行列式引理的应用是有效的。\n\n现在我们必须求出 $(C^{-1})_{11}$。循环矩阵的一个基本性质是，循环矩阵的逆矩阵也是一个循环矩阵。设 $C^{-1}$ 的第一列为 $d = (d_0, d_1, d_2, d_3)^{\\top}$。那么 $(C^{-1})_{11} = d_0$。\n\n$C^{-1}$ 的特征值（记为 $\\mu_k$）是 $C$ 的特征值的倒数：\n$$\n\\mu_k = \\frac{1}{\\lambda_k}\n$$\n所以，$C^{-1}$ 的特征值为 $\\mu_0 = \\frac{1}{1} = 1$，$\\mu_1 = \\frac{1}{3}$，$\\mu_2 = \\frac{1}{5}$，以及 $\\mu_3 = \\frac{1}{3}$。\n\n$C^{-1}$ 的第一列 $d$ 可以通过对特征值序列 $(\\mu_0, \\mu_1, \\mu_2, \\mu_3)$ 应用离散傅里叶逆变换来找到：\n$$\nd_j = \\frac{1}{n} \\sum_{k=0}^{n-1} \\mu_k \\omega^{-jk}\n$$\n我们关心的是分量 $d_0$，它对应于 $j=0$：\n$$\nd_0 = \\frac{1}{4} \\sum_{k=0}^{3} \\mu_k \\omega^{0} = \\frac{1}{4} (\\mu_0 + \\mu_1 + \\mu_2 + \\mu_3)\n$$\n代入 $\\mu_k$ 的值：\n$$\nd_0 = \\frac{1}{4} \\left(1 + \\frac{1}{3} + \\frac{1}{5} + \\frac{1}{3}\\right) = \\frac{1}{4} \\left(1 + \\frac{2}{3} + \\frac{1}{5}\\right)\n$$\n为了对分数求和，我们找到一个公分母，即 $15$：\n$$\nd_0 = \\frac{1}{4} \\left(\\frac{15}{15} + \\frac{10}{15} + \\frac{3}{15}\\right) = \\frac{1}{4} \\left(\\frac{15+10+3}{15}\\right) = \\frac{1}{4} \\left(\\frac{28}{15}\\right) = \\frac{7}{15}\n$$\n因此，$(C^{-1})_{11} = d_0 = \\frac{7}{15}$。\n\n最后，我们可以计算所求的比值：\n$$\n\\frac{\\det(C + uv^{\\ast})}{\\det(C)} = 1 + (C^{-1})_{11} = 1 + \\frac{7}{15} = \\frac{15}{15} + \\frac{7}{15} = \\frac{22}{15}\n$$",
            "answer": "$$\\boxed{\\frac{22}{15}}$$"
        },
        {
            "introduction": "快速傅里叶变换在循环矩阵运算中最强大的应用之一，是在迭代算法中加速矩阵向量乘法。本练习要求你设计一个基于幂迭代的随机化方案，以估算矩阵的谱范数和条件数，其中关键步骤是利用 FFT 实现高效的矩阵向量积。这个过程不仅是一个算法设计任务，更重要的是，它要求你从理论上分析算法的收敛速度，将其与矩阵的谱间隙直接关联起来，从而深刻理解理论分析与实际性能之间的联系 。",
            "id": "3545359",
            "problem": "考虑一个 $n \\times n$ 的实循环矩阵 $C$，其中 $n$ 为偶数，由其第一列 $c \\in \\mathbb{R}^{n}$ 定义，满足 $c_{0}=3$，$c_{1}=1$，$c_{n-1}=1$，且对于所有其他索引 $j \\in \\{2,3,\\dots,n-2\\}$，$c_{j}=0$。你的任务是设计一个完全显式的随机估计器，用于估计谱范数 $\\|C\\|_{2}$ 和 2-范数条件数 $\\kappa_{2}(C)$。该估计器使用幂迭代方案，其中的矩阵-向量乘法通过快速傅里叶变换 (FFT) 实现。从基本定义开始：循环矩阵的结构、作为酉基变换的离散傅里叶变换，以及正规矩阵的谱定理。你不能假定任何预先推导的对角化公式或快捷恒等式；相反，必须从这些基础出发，由第一性原理推导出所有关系。\n\n你的估计器应满足：\n- 使用一个随机初始向量 $x^{(0)} \\in \\mathbb{R}^{n}$，其分量独立同分布，服从一个关于 0 对称的连续分布（例如，标准正态分布），从而几乎必然地，$x^{(0)}$ 在 $C$ 的每个特征向量方向上都有非零分量。\n- 对 $t \\geq 0$ 实现幂迭代 $x^{(t+1)} := C x^{(t)} / \\|C x^{(t)}\\|_{2}$，通过瑞利商 $r^{(t)} := (x^{(t)})^{\\top} C x^{(t)}$ 来估计 $\\|C\\|_{2}$；并独立地，对 $C^{-1}$ 实现类似的迭代 $y^{(t+1)} := C^{-1} y^{(t)} / \\|C^{-1} y^{(t)}\\|_{2}$，以估计 $C$ 的最小特征值。$C$ 和 $C^{-1}$ 的乘法都必须通过基于 FFT 的 $C$ 的对角化在 $O(n \\log n)$ 时间内完成。\n- 根据从 $C$ 的特征值 $\\lambda_{k}$ 推断出的谱隙，分析每次迭代的渐近收敛率。\n\n仅使用这些基础，完成以下任务：\n1. 推导 $C$ 的特征值 $\\lambda_{k}$。\n2. 证明 $C$ 是对称正定的，确定 $\\|C\\|_{2}$ 和最小特征值，并得出 $\\kappa_{2}(C)$。\n3. 对于 $C$ 上的幂迭代，根据第二大特征值与最大特征值之比，推导 $x^{(t)}$ 与主特征向量之间夹角的渐近几何收敛因子。将此因子表示为 $n$ 的闭式函数。\n4. 对于 $C^{-1}$ 上的幂迭代，根据 $C$ 的最小特征值与第二小特征值之比，推导类似的渐近几何收敛因子，同样表示为 $n$ 的闭式函数。\n5. 以闭式形式报告一个四元组，包含以下四个量：精确的谱范数 $\\|C\\|_{2}$、精确的条件数 $\\kappa_{2}(C)$、$C$ 上幂迭代的渐近几何收敛因子，以及 $C^{-1}$ 上幂迭代的渐近几何收敛因子。每个量都只用 $n$ 和常数表示。不需要四舍五入。\n\n你最终报告的答案必须是包含这四个量（按指定顺序）的单行矩阵。",
            "solution": "对问题陈述进行分析后，认定其是有效的。这是一个数值线性代数中的适定问题，具有科学依据、客观且自洽。要求从基本原理推导结果是一种教学上的约束，不构成缺陷。我们开始求解。\n\n问题要求分析一个特定的实数、偶数维循环矩阵 $C \\in \\mathbb{R}^{n \\times n}$。矩阵 $C$ 由其第一列向量 $c \\in \\mathbb{R}^{n}$ 定义，其中 $c_0 = 3$，$c_1 = 1$，$c_{n-1} = 1$，且对于 $j \\in \\{2, 3, \\dots, n-2\\}$，$c_j = 0$。\n\n1.  **推导 $C$ 的特征值**\n\n循环矩阵由其第一列定义。其元素 $C_{jk}$ 由 $c_{(j-k) \\pmod n}$ 给出。对角化循环矩阵的基本原理是，其特征向量是离散傅里叶变换 (DFT) 矩阵的列向量。我们必须从第一性原理推导这一点。\n\n令 $\\omega = \\exp(2\\pi i/n)$ 为 $n$ 次本原单位根，其中 $i = \\sqrt{-1}$。考虑向量 $v_k \\in \\mathbb{C}^n$（$k \\in \\{0, 1, \\dots, n-1\\}$），其中 $v_k$ 的第 $j$ 个分量是 $(v_k)_j = \\omega^{jk}$。我们将证明这些是 $C$ 的特征向量。\n\n我们来计算矩阵-向量乘积 $C v_k$ 的第 $j$ 个分量：\n$$ (C v_k)_j = \\sum_{m=0}^{n-1} C_{jm} (v_k)_m = \\sum_{m=0}^{n-1} c_{(j-m) \\pmod n} \\, \\omega^{mk} $$\n令 $p = (j-m) \\pmod n$。当 $m$ 从 $0$ 遍历到 $n-1$ 时，$p$ 也遍历集合 $\\{0, 1, \\dots, n-1\\}$。我们可以用 $p$ 来表示 $m$，$m = (j-p) \\pmod n$。将此代入求和式：\n$$ (C v_k)_j = \\sum_{p=0}^{n-1} c_p \\, \\omega^{(j-p)k} = \\sum_{p=0}^{n-1} c_p \\, \\omega^{jk} \\omega^{-pk} = \\omega^{jk} \\left( \\sum_{p=0}^{n-1} c_p \\, \\omega^{-pk} \\right) $$\n括号中的项是一个依赖于 $k$ 但不依赖于 $j$ 的标量。我们将此标量定义为 $\\lambda_k$：\n$$ \\lambda_k = \\sum_{j=0}^{n-1} c_j \\omega^{-jk} $$\n根据这个定义，我们有 $(C v_k)_j = \\lambda_k \\omega^{jk} = \\lambda_k (v_k)_j$。此方程对所有分量 $j$ 均成立，这证明了 $v_k$ 是 $C$ 的一个特征向量，对应的特征值为 $\\lambda_k$。特征值集合 $\\{\\lambda_k\\}_{k=0}^{n-1}$ 称为 $C$ 的谱。\n\n现在，我们将向量 $c$ 中的具体值代入 $\\lambda_k$ 的公式：\n$$ \\lambda_k = c_0 \\omega^{-0} + c_1 \\omega^{-k} + c_{n-1} \\omega^{-(n-1)k} + \\sum_{j=2}^{n-2} c_j \\omega^{-jk} $$\n$$ \\lambda_k = 3 \\cdot 1 + 1 \\cdot \\omega^{-k} + 1 \\cdot \\omega^{-(n-1)k} + 0 = 3 + \\omega^{-k} + \\omega^{-(n-1)k} $$\n利用性质 $\\omega^n = \\exp(2\\pi i) = 1$，我们可以简化 $\\omega^{-(n-1)k} = \\omega^{-nk} \\omega^k = (\\omega^n)^{-k} \\omega^k = 1^{-k} \\omega^k = \\omega^k$。\n$$ \\lambda_k = 3 + \\omega^{-k} + \\omega^k $$\n根据欧拉公式，$\\omega^k = \\cos(2\\pi k/n) + i\\sin(2\\pi k/n)$ 且 $\\omega^{-k} = \\cos(2\\pi k/n) - i\\sin(2\\pi k/n)$。它们的和是 $2\\cos(2\\pi k/n)$。\n因此，$C$ 的特征值为：\n$$ \\lambda_k = 3 + 2\\cos\\left(\\frac{2\\pi k}{n}\\right) \\quad \\text{for } k = 0, 1, \\dots, n-1 $$\n\n2.  **对称性、正定性、谱范数和条件数**\n\n对于一个第一列为 $c$ 的实循环矩阵，其对称性（$C=C^T$）等价于条件 $c_j = c_{n-j}$ 对 $j=1, \\dots, n-1$ 成立。在我们的例子中，$c_1=1$ 且 $c_{n-1}=1$，所以条件对 $j=1$ 成立。对于 $j \\in \\{2, \\dots, n-2\\}$，我们有 $c_j=0$。由于 $n$ 是偶数，索引 $n-j$ 也属于 $\\{2, \\dots, n-2\\}$，这意味着 $n-j \\neq j$，所以 $c_{n-j}=0$ 也成立。该条件对所有 $j$ 都成立，因此 $C$ 是对称的。\n\n由于 $C$ 是一个实对称矩阵，其特征值必须是实数。我们推导出的表达式 $\\lambda_k = 3 + 2\\cos(2\\pi k/n)$ 对所有 $k$ 确实是实数。为了检验正定性，我们需要证明所有特征值都严格为正。余弦函数的值域是 $[-1, 1]$。\n$\\cos(2\\pi k/n)$ 的最大值是 $1$，在 $k=0$ 时取到。这给出了最大特征值：\n$$ \\lambda_{\\max} = \\lambda_0 = 3 + 2\\cos(0) = 3 + 2 = 5 $$\n$\\cos(2\\pi k/n)$ 的最小值是 $-1$，在 $k=n/2$ 时取到（因为 $n$ 是偶数，所以这是一个整数）。这给出了最小特征值：\n$$ \\lambda_{\\min} = \\lambda_{n/2} = 3 + 2\\cos(\\pi) = 3 - 2 = 1 $$\n所有特征值 $\\lambda_k$ 都位于区间 $[1, 5]$ 内。由于 $\\lambda_{\\min} = 1 > 0$，所有特征值都是正的，因此对称矩阵 $C$ 是正定的。\n\n对于一个正规矩阵（对称矩阵是正规矩阵），其谱范数 $\\|C\\|_2$ 是它的谱半径，即其特征值的最大绝对值。\n$$ \\|C\\|_2 = \\max_{k} |\\lambda_k| = \\lambda_{\\max} = 5 $$\n2-范数条件数 $\\kappa_2(C)$ 由 $\\|C\\|_2 \\|C^{-1}\\|_2$ 给出。$C^{-1}$ 的特征值是 $1/\\lambda_k$。因此，$\\|C^{-1}\\|_2 = \\max_k |1/\\lambda_k| = 1/\\min_k|\\lambda_k| = 1/\\lambda_{\\min}$。\n$$ \\kappa_2(C) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{5}{1} = 5 $$\n\n3.  **$C$ 上幂迭代的收敛因子**\n\n幂迭代方法 $x^{(t+1)} \\propto C x^{(t)}$ 收敛到对应于模最大特征值的特征向量。渐近几何收敛因子是第二大模与最大模特征值之比。由于 $C$ 的所有特征值都是正的，我们寻求比率 $\\lambda'/\\lambda_{\\max}$，其中 $\\lambda'$ 是第二大特征值。\n\n特征值为 $\\lambda_k = 3 + 2\\cos(2\\pi k/n)$。\n最大特征值是 $\\lambda_0 = 5$，它是唯一的。\n函数 $\\cos(x)$ 在 $[0, \\pi]$ 上是严格递减的。当 $k=1$ 和 $k=n-1$ 时，参数 $2\\pi k/n$ 给出相同的余弦值：$\\cos(2\\pi/n) = \\cos(2\\pi(n-1)/n) = \\cos(2\\pi - 2\\pi/n)$。这个值是仅次于 $\\cos(0)=1$ 的最大值。\n因此，第二大特征值是退化的（重数为 2），由下式给出：\n$$ \\lambda' = \\lambda_1 = \\lambda_{n-1} = 3 + 2\\cos\\left(\\frac{2\\pi}{n}\\right) $$\n渐近几何收敛因子是：\n$$ \\frac{\\lambda'}{\\lambda_{\\max}} = \\frac{3 + 2\\cos\\left(\\frac{2\\pi}{n}\\right)}{5} $$\n\n4.  **$C^{-1}$ 上幂迭代的收敛因子**\n\n应用于 $C^{-1}$ 的幂迭代（即对 $C$ 的反幂迭代）收敛到 $C^{-1}$ 对应于其最大模特征值的特征向量。该特征值是 $1/\\lambda_{\\min}$，其中 $\\lambda_{\\min}$ 是 $C$ 的最小模特征值。收敛因子是 $C^{-1}$ 的第二大模特征值与最大模特征值之比，这等价于 $C$ 的最小模特征值与第二小模特征值之比。\n\n$C$ 的最小特征值是 $\\lambda_{\\min} = \\lambda_{n/2} = 1$，它是唯一的。\n第二小特征值对应于最接近 $-1$ 的 $\\cos(2\\pi k/n)$ 值。这发生在 $k=n/2-1$ 和 $k=n/2+1$ 时。\n$$ \\cos\\left(\\frac{2\\pi(n/2-1)}{n}\\right) = \\cos\\left(\\pi - \\frac{2\\pi}{n}\\right) = -\\cos\\left(\\frac{2\\pi}{n}\\right) $$\n$$ \\cos\\left(\\frac{2\\pi(n/2+1)}{n}\\right) = \\cos\\left(\\pi + \\frac{2\\pi}{n}\\right) = -\\cos\\left(\\frac{2\\pi}{n}\\right) $$\n因此，第二小特征值 $\\lambda''$ 也是退化的，由下式给出：\n$$ \\lambda'' = \\lambda_{n/2-1} = \\lambda_{n/2+1} = 3 + 2\\left(-\\cos\\left(\\frac{2\\pi}{n}\\right)\\right) = 3 - 2\\cos\\left(\\frac{2\\pi}{n}\\right) $$\n反幂迭代的渐近几何收敛因子是：\n$$ \\frac{\\lambda_{\\min}}{\\lambda''} = \\frac{1}{3 - 2\\cos\\left(\\frac{2\\pi}{n}\\right)} $$\n\n5.  **最终的四元组量**\n\n根据以上推导，所要求的四个量是：\n1.  谱范数 $\\|C\\|_2 = 5$。\n2.  条件数 $\\kappa_2(C) = 5$。\n3.  $C$ 上幂迭代的渐近几何收敛因子：$\\frac{1}{5}\\left(3 + 2\\cos\\left(\\frac{2\\pi}{n}\\right)\\right)$。\n4.  $C^{-1}$ 上幂迭代的渐近几何收敛因子：$\\frac{1}{3 - 2\\cos\\left(\\frac{2\\pi}{n}\\right)}$。\n\n将这些量汇编成一个单行矩阵作为最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 5 & 5 & \\frac{3 + 2\\cos\\left(\\frac{2\\pi}{n}\\right)}{5} & \\frac{1}{3 - 2\\cos\\left(\\frac{2\\pi}{n}\\right)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然 FFT 为计算循环矩阵的 Moore-Penrose 伪逆提供了一条捷径，但在有限精度计算中，微小的特征值会引发严重的数值不稳定性。这个实践项目将带你直面这一核心挑战，你不仅需要量化投影算子因数值误差而偏离幂等性（$P^2 = P$）的程度，还需要在频域中设计并评估正则化方法来恢复其近似幂等性。这是计算科学中处理病态问题的一项关键技能，也是理论与实践相结合的绝佳体现 。",
            "id": "3545340",
            "problem": "给定一项任务，要求使用通过快速傅里叶变换 (FFT) 计算的离散傅里叶变换 (DFT) 来分析由循环矩阵的 Moore–Penrose 伪逆构建的投影算子。在精确算术下，该投影是幂等的，但在有限精度下，接近零的谱值会放大舍入误差。你的目标是推导、实现并定量评估谱值过小如何破坏幂等性，并设计一种频域正则化方法来恢复近似幂等性。\n\n使用的基本原理：\n- 一个由第一列 $c \\in \\mathbb{C}^{n}$ 生成的循环矩阵 $C \\in \\mathbb{C}^{n \\times n}$ 可被酉 DFT 矩阵 $F \\in \\mathbb{C}^{n \\times n}$ 酉对角化，满足 $F^{*} F = I$。这得到 $C = F^{*} \\,\\mathrm{diag}(\\lambda)\\, F$，其中 $\\lambda = F c$。\n- $C$ 的 Moore–Penrose 伪逆 $C^{\\dagger}$ 是 $C^{\\dagger} = F^{*}\\,\\mathrm{diag}(\\mu)\\,F$，其中对每个 $k$ 有，当 $\\lambda_{k} \\neq 0$ 时 $\\mu_{k} = 1/\\lambda_{k}$，当 $\\lambda_{k} = 0$ 时 $\\mu_{k} = 0$。\n- 投影 $P = C^{\\dagger} C$ 在精确算术中是幂等的，即 $P^{2} = P$。\n\n任务：\n1. 从上述基本原理推导投影 $P$ 也是循环矩阵且可被 $F$ 酉对角化，并将其谱与 $\\lambda$ 关联起来。定义 $p \\in \\mathbb{C}^{n}$ 为 $P$ 的频率响应，使得 $P = F^{*}\\,\\mathrm{diag}(p)\\,F$，然后使用弗罗贝尼乌斯范数定义一个幂等性缺陷度量，\n   $$\\mathcal{E}(P) \\equiv \\frac{\\lVert P^{2} - P \\rVert_{F}}{\\lVert P \\rVert_{F}},$$\n   并仅使用酉相似性和弗罗贝尼乌斯范数的性质，将其纯粹用 $p$ 表示（不含显式的稠密矩阵）。\n2. 使用酉标度的 FFT（即正变换除以 $\\sqrt{n}$，逆变换乘以 $\\sqrt{n}$），实现以下三种 $p$ 的谱构造方法，并计算相应的幂等性缺陷：\n   - 带有放大舍入误差的朴素倒数法。设 $\\lambda \\in \\mathbb{C}^{n}$ 是通过酉 FFT 从 $c$ 获得的。对于每个索引 $k$ 且 $\\lambda_{k} \\neq 0$，定义一个受扰动的倒数\n     $$\\tilde{\\mu}_{k} = \\frac{1}{\\lambda_{k}}\\left(1 + \\delta_{k}\\right),$$\n     其中扰动 $\\delta_{k}$ 模拟了放大的舍入误差，其大小与 $\\lvert \\lambda_{k} \\rvert$ 成反比。使用\n     $$\\delta_{k} = \\xi_{k}\\,u\\,\\frac{\\tau}{\\max(\\lvert \\lambda_{k} \\rvert, 10^{-300})},$$\n     其中 $u$ 是双精度的机器单位舍入，$\\tau > 0$ 是指定的阈值参数，$\\xi_{k}$ 是从标准正态分布中抽取的实数，并使用固定的随机种子以保证可复现性。对于 $\\lambda_{k} = 0$，设置 $\\tilde{\\mu}_{k} = 0$。然后设置\n     $$\\tilde{p}_{k} = \\tilde{\\mu}_{k}\\,\\lambda_{k}.$$\n     计算 $p = \\tilde{p}$ 时的 $\\mathcal{E}$。\n   - 截断谱伪逆（硬阈值法）。定义\n     $$\\mu^{(\\tau)}_{k} = \\begin{cases} \\frac{1}{\\lambda_{k}},  \\lvert \\lambda_{k} \\rvert \\ge \\tau \\\\ 0,  \\lvert \\lambda_{k} \\rvert  \\tau \\end{cases}, \\quad p^{(\\tau)}_{k} = \\mu^{(\\tau)}_{k}\\,\\lambda_{k}.$$\n     计算 $p = p^{(\\tau)}$ 时的 $\\mathcal{E}$。\n   - 频域中的 Tikhonov 型平滑。定义\n     $$p^{(\\alpha)}_{k} = \\frac{\\lvert \\lambda_{k} \\rvert^{2}}{\\lvert \\lambda_{k} \\rvert^{2} + \\alpha},$$\n     其中给定参数 $\\alpha  0$（在测试中你将使用 $\\alpha = \\tau^{2}$）。计算 $p = p^{(\\alpha)}$ 时的 $\\mathcal{E}$。\n3. 通过 FFT 在频域中实现所有计算。不要构建任何稠密的 $n \\times n$ 矩阵。你的幂等性缺陷必须仅根据任务1的结果从谱向量 $p$ 计算。\n4. 测试套件。对于以下四种情况中的每一种，计算并报告幂等性缺陷三元组 $[\\mathcal{E}_{\\mathrm{naive}}, \\mathcal{E}_{\\mathrm{trunc}}, \\mathcal{E}_{\\mathrm{tikh}}]$：\n   - 情况 A（存在精确零模式）：$n=8$，$c = [2,\\,1,\\,0,\\,0,\\,0,\\,0,\\,0,\\,1]^{\\top}$，$\\tau = 1\\times 10^{-8}$，$\\alpha = \\tau^{2}$，对扰动使用随机种子 $0$。\n   - 情况 B（在频率 $0$ 处有近零模式）：$n=12$，$c = [\\,1,\\,-(1-10^{-12}),\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0\\,]^{\\top}$，$\\tau = 1\\times 10^{-8}$，$\\alpha = \\tau^{2}$，种子 $1$。\n   - 情况 C（具有许多微小低频分量的离散二阶差分谱）：$n=4096$，$c = [\\,1,\\,-2,\\,1,\\,0,\\,\\ldots,\\,0\\,]^{\\top}$，$\\tau = 1\\times 10^{-5}$，$\\alpha = \\tau^{2}$，种子 $2$。\n   - 情况 D（良态的单位循环矩阵）：$n=5$，$c = [\\,1,\\,0,\\,0,\\,0,\\,0\\,]^{\\top}$，$\\tau = 1\\times 10^{-8}$，$\\alpha = \\tau^{2}$，种子 $3$。\n   在所有情况下，将 $c$ 解释为虚部为零的复数。DFT 中隐含的角度以弧度为单位。使用双精度算术。对于单位舍入，取 $u = 2^{-53}$。\n5. 最终输出格式。你的程序应产生单行输出，其中包含一个由四个内部列表组成的逗号分隔列表形式的结果，每个内部列表是按 A, B, C, D 顺序排列的测试用例的三元组。例如，\n   $$[ [x_{A},y_{A},z_{A}], [x_{B},y_{B},z_{B}], [x_{C},y_{C},z_{C}], [x_{D},y_{D},z_{D}] ],$$\n   其中每个符号都是一个浮点数。不要打印任何额外文本。\n\n注：\n- 不要使用任何稠密的 $n \\times n$ 矩阵；任务1中的推导必须证明如何直接从谱数据计算弗罗贝尼乌斯范数。\n- 你的实现必须依赖快速傅里叶变换，并使用酉归一化从 $c$ 获得 $\\lambda$。\n- 答案值没有物理单位。",
            "solution": "该问题要求分析源自循环矩阵的投影算子的幂等性。具体来说，我们必须在谱域中推导出一个幂等性缺陷度量的公式，然后实现并比较三种不同的数值策略来构造该投影：一种易受舍入误差影响的朴素方法，一种硬阈值方法，以及一种 Tikhonov 正则化方法。\n\n### 任务1：谱域中幂等性缺陷的推导\n\n令 $C \\in \\mathbb{C}^{n \\times n}$ 是一个由其第一列 $c \\in \\mathbb{C}^n$ 生成的循环矩阵。它可被酉离散傅里叶变换 (DFT) 矩阵 $F \\in \\mathbb{C}^{n \\times n}$ 对角化为 $C = F^* \\mathrm{diag}(\\lambda) F$，其中 $\\lambda = F c$ 是 $C$ 的特征值向量（谱）。Moore-Penrose 伪逆 $C^\\dagger$ 由 $C^\\dagger = F^* \\mathrm{diag}(\\mu) F$ 给出，其中谱向量 $\\mu$ 的元素定义为：如果 $\\lambda_k \\neq 0$，则 $\\mu_k = 1/\\lambda_k$；如果 $\\lambda_k = 0$，则 $\\mu_k = 0$。\n\n到 $C$ 的值域上的投影算子是 $P = C^\\dagger C$。我们可以用 $C$ 和 $C^\\dagger$ 的谱表示来表达 $P$：\n$$\nP = C^\\dagger C = \\left( F^* \\mathrm{diag}(\\mu) F \\right) \\left( F^* \\mathrm{diag}(\\lambda) F \\right)\n$$\n由于 $F$ 是酉矩阵，$F F^* = I$，其中 $I$ 是单位矩阵。\n$$\nP = F^* \\mathrm{diag}(\\mu) (F F^*) \\mathrm{diag}(\\lambda) F = F^* \\mathrm{diag}(\\mu) \\mathrm{diag}(\\lambda) F\n$$\n两个对角矩阵的乘积是一个对角矩阵，其元素是相应对角元素的乘积。令 $p \\in \\mathbb{C}^n$ 是一个向量，使得对每个 $k$ 都有 $p_k = \\mu_k \\lambda_k$。那么，$\\mathrm{diag}(p) = \\mathrm{diag}(\\mu) \\mathrm{diag}(\\lambda)$，我们有：\n$$\nP = F^* \\mathrm{diag}(p) F\n$$\n这个方程表明 $P$ 也可以被 DFT 矩阵 $F$ 对角化。一个矩阵是循环矩阵，当且仅当它可以被 DFT 矩阵对角化。因此，$P$ 是一个循环矩阵，其谱由向量 $p$ 给出。\n\n在精确算术中，对任意 $k$：\n- 如果 $\\lambda_k \\neq 0$，则 $\\mu_k = 1/\\lambda_k$，所以 $p_k = (1/\\lambda_k) \\lambda_k = 1$。\n- 如果 $\\lambda_k = 0$，则 $\\mu_k = 0$，所以 $p_k = 0 \\cdot 0 = 0$。\n因此，在精确算术中，投影 $P$ 的谱 $p$ 仅由 $0$ 和 $1$ 组成。\n\n幂等性缺陷定义为 $\\mathcal{E}(P) \\equiv \\frac{\\lVert P^{2} - P \\rVert_{F}}{\\lVert P \\rVert_{F}}$。我们需要用 $p$ 来表示它。弗罗贝尼乌斯范数的一个关键性质是其在酉变换下的不变性：对于任意矩阵 $A$ 和酉矩阵 $U$，$\\lVert U A U^* \\rVert_F = \\lVert A \\rVert_F$。\n\n首先，考虑 $P^2 - P$ 项：\n$$\nP^2 = \\left( F^* \\mathrm{diag}(p) F \\right) \\left( F^* \\mathrm{diag}(p) F \\right) = F^* \\mathrm{diag}(p)^2 F = F^* \\mathrm{diag}(p^2) F\n$$\n其中 $p^2$ 是向量 $p$ 的逐元素平方。\n然后，差值为：\n$$\nP^2 - P = F^* \\mathrm{diag}(p^2) F - F^* \\mathrm{diag}(p) F = F^* \\left( \\mathrm{diag}(p^2) - \\mathrm{diag}(p) \\right) F = F^* \\mathrm{diag}(p^2 - p) F\n$$\n利用弗罗贝尼乌斯范数的酉不变性：\n$$\n\\lVert P^2 - P \\rVert_F = \\lVert F^* \\mathrm{diag}(p^2 - p) F \\rVert_F = \\lVert \\mathrm{diag}(p^2 - p) \\rVert_F\n$$\n对角矩阵的弗罗贝尼乌斯范数是其对角线元素向量的欧几里得范数（$L_2$ 范数）。\n$$\n\\lVert \\mathrm{diag}(p^2 - p) \\rVert_F = \\sqrt{\\sum_{k=0}^{n-1} |p_k^2 - p_k|^2} = \\lVert p^2 - p \\rVert_2\n$$\n\n接下来，考虑分母项 $\\lVert P \\rVert_F$：\n$$\n\\lVert P \\rVert_F = \\lVert F^* \\mathrm{diag}(p) F \\rVert_F = \\lVert \\mathrm{diag}(p) \\rVert_F = \\sqrt{\\sum_{k=0}^{n-1} |p_k|^2} = \\lVert p \\rVert_2\n$$\n\n结合分子和分母，我们得到纯粹用谱向量 $p$ 表示的幂等性缺陷：\n$$\n\\mathcal{E}(P) = \\frac{\\lVert p^2 - p \\rVert_2}{\\lVert p \\rVert_2}\n$$\n这个公式使我们能够计算缺陷而无需构建任何稠密的 $n \\times n$ 矩阵，从而满足了问题的要求。如果由于数值误差，任何 $p_k$ 偏离 $0$ 或 $1$，分子 $\\lVert p^2 - p \\rVert_2$ 将变为非零，从而量化了幂等性的损失。\n\n### 计算策略与实现\n\n实现将严格遵循推导出的公式，在频域中执行所有计算。\n\n1.  **谱计算：** 对于每个测试用例，定义循环生成向量 $c$。使用带有酉归一化的快速傅里叶变换 (FFT) 计算其谱 $\\lambda$，具体由带有参数 `norm=\"ortho\"` 的 `numpy.fft.fft` 提供。\n\n2.  **谱构造：** 构造三种不同的投影谱向量 $p$：\n    -   **朴素法 ($\\tilde{p}$):** 计算一个受扰动的倒数 $\\tilde{\\mu}$，以模拟舍入误差放大。扰动 $\\delta_k = \\xi_k u \\tau / \\max(|\\lambda_k|, 10^{-300})$ 被计算出来，其中 $\\xi_k$ 是一个标准正态随机变量，$u=2^{-53}$ 是双精度的机器 epsilon，$\\tau$ 是给定的阈值。然后，对于 $\\lambda_k \\neq 0$，$\\tilde{p}_k = (1/\\lambda_k)(1+\\delta_k)\\lambda_k$；对于 $\\lambda_k=0$，$\\tilde{p}_k=0$。这种构造旨在对微小但非零的 $|\\lambda_k|$ 值产生显著的失败。\n    -   **截断法 ($p^{(\\tau)}$):** 应用一个硬阈值 $\\tau$。仅对幅值大于或等于 $\\tau$ 的特征值取倒数；否则，将其设为零。这导致如果 $|\\lambda_k| \\ge \\tau$，则 $p_k^{(\\tau)} = 1$；如果 $|\\lambda_k|  \\tau$，则 $p_k^{(\\tau)} = 0$。该方法清晰地界定了哪些谱分量被保留，这应产生一个由非常接近 $0$ 和 $1$ 的值组成的谱向量 $p$，从而得到较低的幂等性缺陷。\n    -   **Tikhonov 法 ($p^{(\\alpha)}$):** 应用一个平滑滤波器，$p_k^{(\\alpha)} = |\\lambda_k|^2 / (|\\lambda_k|^2 + \\alpha)$，其中 $\\alpha = \\tau^2$。该方法在高幅值特征值（$p_k \\to 1$）和抑制低幅值特征值（$p_k \\to 0$）之间平滑过渡。它引入了一种系统偏差，因为 $p_k$ 永远不完全等于 $1$，以牺牲完美的幂等性来换取数值稳定性。\n\n3.  **缺陷计算：** 对于每个产生的三种谱向量 $p$，使用推导出的公式 $\\mathcal{E}(P) = \\lVert p^2 - p \\rVert_2 / \\lVert p \\rVert_2$ 计算幂等性缺陷 $\\mathcal{E}$。一个辅助函数封装了这个计算，使用 `numpy.linalg.norm` 来计算 $L_2$ 向量范数。通过将缺陷定义为 $0$ 来处理 $\\lVert p \\rVert_2 = 0$ 的情况（对应于零投影矩阵）。\n\n该策略应用于四个指定的测试用例，每个用例都旨在探究一种不同的数值情景：一个真正的零特征值、一个近零特征值、一个具有许多小特征值的谱，以及一个良态的谱。",
            "answer": "```\n[[0.0, 0.0, 0.1414213562373095], [0.08185851419409848, 0.0, 0.08185851419409848], [0.04694464169722374, 0.008493103444747738, 0.02322312952865917], [0.0, 0.0, 0.0]]\n```"
        }
    ]
}