{
    "hands_on_practices": [
        {
            "introduction": "多前沿方法的核心在于它如何处理在分解过程中产生的“填充”（fill-in）非零元。这个练习将引导你通过一个具体的稀疏矩阵图模型，从第一性原理出发，手动追踪符号乔列斯基分解（symbolic Cholesky factorization）的过程。通过这个实践，你将直观地理解消除一个变量如何使其邻居节点形成一个“团”（clique），这正是填充的来源，也是构建前沿矩阵的基础。",
            "id": "3560922",
            "problem": "考虑一个实对称正定（SPD）矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$，其稀疏图 $G(A)$ 是一个采用自然行主序的 $2 \\times 3$ 矩形网格。也就是说，顶点集为 $\\{1,2,3,4,5,6\\}$，无向边集为\n$$\nE \\;=\\; \\{(1,2),(2,3),(4,5),(5,6),(1,4),(2,5),(3,6)\\}.\n$$\n假设矩阵 $A$ 中与 $G(A)$ 对应的非零元为通用值，从而没有数值抵消导致结构性零元，并进行一次不带主元选择也无重新排序的 Cholesky 分解（即消元顺序为 $1,2,3,4,5,6$）。使用稀疏 Cholesky 分解的图模型和消元树，从第一性原理出发，推导 Cholesky 因子 $L$（对角线为正的下三角矩阵）的非零模式，并预测所有由消元产生的填充边。然后，从多波前（multifrontal）的视角进行推理，以验证所预测的模式：在消除每个顶点 $j$ 时，其当前具有更高索引的邻居会形成一个团，这个团是波前矩阵的变量部分，并且这种饱和过程会适当地引入填充。\n\n你的任务是：\n- 仅使用核心定义来推导消元树和 $L$ 的每一列的预测非零模式：在消除顶点 $j$ 时， $j$ 的当前具有更高索引的邻居被构造成一个团；$j$ 在消元树中的父节点是 $L$ 的第 $j$ 列中最小的、大于 $j$ 的行索引。\n- 通过枚举波前矩阵中的变量集及其所蕴含的填充边，从多波前角度独立地验证相同的模式。\n- 确定在 $L$ 的严格下三角部分产生的填充非零元的精确数量（即 $L$ 中对角线下方的、不对应于 $G(A)$ 原始边的非零元）。\n\n报告 $L$ 严格下三角部分中填充项的精确数量作为你的最终答案。不要四舍五入。不需要单位。",
            "solution": "首先验证问题，以确保其是适定的、有科学依据的和客观的。\n\n### 步骤1：提取已知条件\n-   矩阵 $A$ 是一个实对称正定（SPD）矩阵，$A \\in \\mathbb{R}^{6 \\times 6}$。\n-   $A$ 的稀疏图，记为 $G(A)$，其顶点集为 $V = \\{1, 2, 3, 4, 5, 6\\}$，无向边集为 $E = \\{(1,2), (2,3), (4,5), (5,6), (1,4), (2,5), (3,6)\\}$。这些顶点对应于一个采用自然行主序的 $2 \\times 3$ 网格。\n-   分解方法是 Cholesky 分解，$A = LL^T$，其中 $L$ 是下三角矩阵。\n-   消元顺序固定为 $(1, 2, 3, 4, 5, 6)$，无主元选择或重新排序。\n-   假设：不发生偶然的数值抵消，因此符号分解能准确预测非零结构。\n\n### 步骤2：使用已知条件进行验证\n-   **科学依据：**该问题是数值线性代数领域的一个标准练习，特别是关于稀疏矩阵分解。所有概念（SPD 矩阵、Cholesky 分解、稀疏图、填充（fill-in）、消元树、多波前方法）都是成熟的概念。\n-   **适定性：**该问题提供了一个完全指定的图和一个固定的消元顺序。对于 SPD 矩阵，Cholesky 分解存在且唯一。在没有数值抵消的情况下，因子 $L$ 的最终非零模式是唯一确定的。任务具体，并能得出确定的答案。\n-   **客观性：**问题陈述使用了精确的数学术语，没有歧义或主观因素。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 求解推导\n\n问题的核心是确定稀疏矩阵 $A$ 的 Cholesky 因子 $L$ 的非零结构。该结构等价于填充图 $G^+(A)$ 的结构，填充图是通过在符号消元过程中向原始图 $G(A)$ 添加“填充”边而得到的。\n\nCholesky 分解的图论模型是通过逐个消去顶点来进行的。当一个顶点 $k$ 被消去时，其当前具有更高索引的邻居集会通过添加任何缺失的边而形成一个团。这些新边就是“填充边”。在所有顶点都被消去后得到的最终图就是填充图 $G^+(A)$。$L$ 的非零结构由以下规则给出：对于 $i \\geq j$，$L_{ij} \\neq 0$ 当且仅当 $(i,j)$ 是 $G^+(A)$ 中的一条边（对角线元素对应自环 $(j,j)$）。\n\n令 $G_0 = G(A)$。我们将生成一个图序列 $G_1, G_2, \\ldots, G_5$，其中 $G_k$ 是消去顶点 $k$ 后的图。\n\n**初始图 $G_0$:**\n$G_0 = (V,E)$ 的邻接表为：\n-   $\\text{adj}_0(1) = \\{2, 4\\}$\n-   $\\text{adj}_0(2) = \\{1, 3, 5\\}$\n-   $\\text{adj}_0(3) = \\{2, 6\\}$\n-   $\\text{adj}_0(4) = \\{1, 5\\}$\n-   $\\text{adj}_0(5) = \\{2, 4, 6\\}$\n-   $\\text{adj}_0(6) = \\{3, 5\\}$\n\n**步骤1：消去顶点1**\n-   $G_0$ 中顶点 $1$ 的邻居是 $\\{2, 4\\}$。\n-   其具有更高索引的邻居集也是 $\\{2, 4\\}$。\n-   这些邻居必须形成一个团。边 $(2,4)$ 在 $G_0$ 中不存在。\n-   **填充边：** 我们向图中添加边 $(2,4)$。这是第一个填充。\n-   新图为 $G_1 = (V, E \\cup \\{(2,4)\\})$。\n-   $L$ 的第 1 列的非零结构由 $G_0$ 中 1 的邻居确定：$L_{11}, L_{21}, L_{41}$ 为非零元。\n-   消元树中顶点 1 的父节点由 $\\text{parent}(1) = \\min\\{i > 1 \\mid L_{i1} \\neq 0\\} = \\min\\{2, 4\\} = 2$ 给出。\n\n**步骤2：消去顶点2**\n-   $G_1$ 中顶点 2 的邻居是 $\\{1, 3, 5\\}$（来自 $G_0$）和 $\\{4\\}$（来自填充）。因此，$\\text{adj}_1(2) = \\{1, 3, 4, 5\\}$。\n-   其具有更高索引的邻居集是 $\\{3, 4, 5\\}$。\n-   这些邻居必须形成一个团。\n    -   边 $(4,5)$ 存在于 $G_0$ 中。\n    -   边 $(3,4)$ 不存在。**填充边：** 添加 $(3,4)$。\n    -   边 $(3,5)$ 不存在。**填充边：** 添加 $(3,5)$。\n-   新图为 $G_2 = (V, E \\cup \\{(2,4), (3,4), (3,5)\\})$。\n-   $L$ 的第 2 列的非零结构由 $G_1$ 中 2 的邻居确定：$L_{22}, L_{32}, L_{42}, L_{52}$ 为非零元。\n-   $\\text{parent}(2) = \\min\\{i > 2 \\mid L_{i2} \\neq 0\\} = \\min\\{3, 4, 5\\} = 3$。\n\n**步骤3：消去顶点3**\n-   $G_2$ 中顶点 3 的邻居是 $\\{2, 6\\}$（来自 $G_0$）和 $\\{4, 5\\}$（来自填充）。因此，$\\text{adj}_2(3) = \\{2, 4, 5, 6\\}$。\n-   其具有更高索引的邻居集是 $\\{4, 5, 6\\}$。\n-   这些邻居必须形成一个团。\n    -   边 $(4,5)$ 存在于 $G_0$ 中。\n    -   边 $(5,6)$ 存在于 $G_0$ 中。\n    -   边 $(4,6)$ 不存在。**填充边：** 添加 $(4,6)$。\n-   新图为 $G_3 = (V, E \\cup \\{(2,4), (3,4), (3,5), (4,6)\\})$。\n-   $L$ 的第 3 列的非零结构对应于 $G_2$ 中 3 的邻居：$L_{33}, L_{43}, L_{53}, L_{63}$ 为非零元。\n-   $\\text{parent}(3) = \\min\\{i > 3 \\mid L_{i3} \\neq 0\\} = \\min\\{4, 5, 6\\} = 4$。\n\n**步骤4：消去顶点4**\n-   $G_3$ 中顶点 4 的邻居是 $\\{1, 5\\}$（来自 $G_0$）和 $\\{2, 3, 6\\}$（来自填充）。因此，$\\text{adj}_3(4) = \\{1, 2, 3, 5, 6\\}$。\n-   其具有更高索引的邻居集是 $\\{5, 6\\}$。\n-   这些邻居必须形成一个团。边 $(5,6)$ 已存在于 $G_0$ 中。没有新的填充。\n-   $G_4 = G_3$。\n-   $L$ 的第 4 列的非零结构对应于 $G_3$ 中 4 的邻居：$L_{44}, L_{54}, L_{64}$ 为非零元。\n-   $\\text{parent}(4) = \\min\\{i > 4 \\mid L_{i4} \\neq 0\\} = \\min\\{5, 6\\} = 5$。\n\n**步骤5：消去顶点5**\n-   $G_4$ 中顶点 5 的邻居是 $\\{2, 4, 6\\}$（来自 $G_0$）和 $\\{3\\}$（来自填充）。因此，$\\text{adj}_4(5) = \\{2, 3, 4, 6\\}$。\n-   其具有更高索引的邻居集是 $\\{6\\}$。单个顶点是一个平凡团。没有新的填充。\n-   $G_5 = G_4$。\n-   $L$ 的第 5 列的非零结构对应于 $G_4$ 中 5 的邻居：$L_{55}, L_{65}$ 为非零元。\n-   $\\text{parent}(5) = \\min\\{i > 5 \\mid L_{i5} \\neq 0\\} = \\min\\{6\\} = 6$。\n\n**步骤6：消去顶点6**\n-   顶点 6 是最后一个顶点。它没有更高索引的邻居。过程结束。顶点 6 是消元树的根。\n\n**图消元法结果摘要：**\n\n1.  **消元树：** 父节点关系为 $1 \\to 2$, $2 \\to 3$, $3 \\to 4$, $4 \\to 5$, $5 \\to 6$。这形成了一条路径：\n    $$1 \\to 2 \\to 3 \\to 4 \\to 5 \\to 6$$\n2.  **L 的非零模式：** 对于 $i>j$ 的非零元 $L_{ij}$ 对应于最终填充图 $G^+ = G_5$ 中的边 $(i,j)$。\n    -   第 1 列：$\\{1, 2, 4\\}$\n    -   第 2 列：$\\{2, 3, 4, 5\\}$\n    -   第 3 列：$\\{3, 4, 5, 6\\}$\n    -   第 4 列：$\\{4, 5, 6\\}$\n    -   第 5 列：$\\{5, 6\\}$\n    -   第 6 列：$\\{6\\}$\n3.  **填充边：** 总共产生了 4 条填充边：$(2,4), (3,4), (3,5), (4,6)$。\n\n### 多波前验证\n\n多波前方法提供了另一种等效的视角。在每一步 $k$，会为顶点 $k$ 及其在当前图中的更高索引邻居形成一个小的、稠密的“波前矩阵” $F_k$。从 $F_k$ 中分解出 $k$ 会在这些邻居上产生一个“舒尔补”或“更新矩阵”，然后将其组装到主系统中。关键的洞见是，这个更新矩阵是稠密的，这恰好对应于将邻居们构成一个团。\n\n-   **波前矩阵 $F_1$：** 变量为 $\\{1\\} \\cup \\text{adj}_{G_0}(1, >1) = \\{1, 2, 4\\}$。从这个 $3 \\times 3$ 矩阵中分解出 1 会在 $\\{2, 4\\}$ 上产生一个稠密的 $2 \\times 2$ 更新。这会对系统的 $(2,4)$ 项产生非零贡献，从而验证了填充边 $(2,4)$。\n\n-   **波前矩阵 $F_2$：** 变量为 $\\{2\\} \\cup \\text{adj}_{G_1}(2, >2) = \\{2, 3, 4, 5\\}$。从这个 $4 \\times 4$ 矩阵中分解出 2 会在 $\\{3, 4, 5\\}$ 上产生一个稠密的 $3 \\times 3$ 更新。这验证了填充边 $(3,4)$ 和 $(3,5)$。\n\n-   **波前矩阵 $F_3$：** 变量为 $\\{3\\} \\cup \\text{adj}_{G_2}(3, >3) = \\{3, 4, 5, 6\\}$。从这个 $4 \\times 4$ 矩阵中分解出 3 会在 $\\{4, 5, 6\\}$ 上产生一个稠密的 $3 \\times 3$ 更新。这验证了填充边 $(4,6)$。\n\n-   **波前矩阵 $F_4$：** 变量为 $\\{4\\} \\cup \\text{adj}_{G_3}(4, >4) = \\{4, 5, 6\\}$。分解出 4 会在 $\\{5, 6\\}$ 上产生一个稠密的 $2 \\times 2$ 更新。由于 $(5,6)$ 已经是一条边，这不会产生填充，但会填充一个已有的非零元。\n\n-   **波前矩阵 $F_5$：** 变量为 $\\{5\\} \\cup \\text{adj}_{G_4}(5, >5) = \\{5, 6\\}$。没有新的填充产生。\n\n因此，多波前视角独立地证实了图消元模型生成的填充序列。\n\n### 填充计数的确定\n\n在 $L$ 的严格下三角部分中的填充非零元是指满足 $i>j$ 且 $L_{ij} \\neq 0$ 但 $A_{ij} = 0$ 的元素 $L_{ij}$。这个数量与符号分解过程中创建的填充边数量相同。\n\n原始图 $G(A)$ 在其上三角部分有 7 条边：$(1,2), (1,4), (2,3), (2,5), (3,6), (4,5), (5,6)$。\n填充图 $G^+(A)$ 包含所有这些边以及填充边。\n填充边是：\n1.  $(2,4)$\n2.  $(3,4)$\n3.  $(3,5)$\n4.  $(4,6)$\n\n这四条边对应于 Cholesky 因子 $L$ 严格下三角部分中的填充非零元 $L_{42}$、$L_{43}$、$L_{53}$ 和 $L_{64}$。\n填充非零元的总数为 $4$。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "在理解了填充的图论模型后，下一步是深入算法的数值计算细节。本练习要求你对一个典型的带状矩阵逐步执行多前沿$LDL^{\\top}$分解。你将亲手构造每个前沿矩阵，执行消元操作，并计算传递给下一个前沿的“舒尔补”更新块，这个过程将把多前沿方法从一个抽象概念转变为一套具体、可执行的计算步骤。",
            "id": "3560937",
            "problem": "考虑对称正定（SPD）带状矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  0  0\\\\\n-1  2  -1  0  0\\\\\n0  -1  2  -1  0\\\\\n0  0  -1  2  -1\\\\\n0  0  0  -1  2\n\\end{pmatrix} \\in \\mathbb{R}^{5 \\times 5}.\n$$\n使用多波前方法和变量 $\\{1,2,3,4,5\\}$ 的自然消元顺序，对矩阵 $A$ 进行完整的下三角-对角-下三角转置（LDL$^{\\top}$）分解，不进行数值主元选择。假设使用标准的多波前术语：在每一步 $i$，在变量集 $\\{i,i+1\\}$（最后一步为 $\\{5\\}$）上组装一个波前矩阵，合并任何来自先前已消元变量的贡献，消去主元 $i$ 以在剩余变量上产生一个贡献块，并将此贡献向前传播以供后续组装。明确列出直至分解完成的整个过程中波前组装、消元和更新（贡献）的序列。\n\n完成分解后，根据你的分解因子计算 $\\det(A)$。你的最终答案必须是一个实数。不要四舍五入。",
            "solution": "该问题要求使用多波前方法和自然消元顺序，对一个给定的对称正定（SPD）$5 \\times 5$ 矩阵 $A$ 进行完整的下三角-对角-下三角转置（LDL$^{\\top}$）分解。随后，我们必须根据得到的因子计算 $A$ 的行列式。\n\n首先，我们验证问题陈述的有效性。\n1.  **已知条件**：\n    *   矩阵 $A = \\begin{pmatrix} 2  -1  0  0  0\\\\ -1  2  -1  0  0\\\\ 0  -1  2  -1  0\\\\ 0  0  -1  2  -1\\\\ 0  0  0  -1  2 \\end{pmatrix}$。\n    *   分解方法是多波前 LDL$^{\\top}$ 分解。\n    *   消元顺序是变量 $\\{1,2,3,4,5\\}$ 的自然顺序。\n    *   规定的波前集对于 $i \\in \\{1,2,3,4\\}$ 是 $\\{i, i+1\\}$，对于 $i=5$ 是 $\\{5\\}$。\n\n2.  **有效性验证**：\n    *   该问题具有科学依据，涉及数值线性代数中的一个标准算法（多波前分解），并应用于一个经典的测试矩阵（一维离散拉普拉斯算子）。\n    *   该问题是适定的。对于一个 SPD 矩阵，存在唯一的 LDL$^{\\top}$ 分解。指定的消元顺序使得整个过程是确定性的。\n    *   该问题是客观和完整的，提供了所有必要信息，没有歧义术语，前提是假设采用多波前方法的标准定义，其中“贡献”是加性更新块（舒尔补更新）。\n\n问题有效。我们开始求解。\n\n多波前方法按步骤进行，根据指定的顺序一次消去一个变量。在每一步 $k$，组装一个波前矩阵 $F_k$。组装过程包括从原始矩阵 $A$ 中提取相应的元素，并加上来自先前已消元变量（在消元树中的子节点）的任何更新贡献。对于本问题，消元树是一条简单的路径 $1 \\to 2 \\to 3 \\to 4 \\to 5$，因此每一步 $k > 1$ 只从第 $k-1$ 步接收一个贡献。\n\n波前矩阵 $F_k$ 相对于主元变量 $k$ 进行分块，其分解为：\n$$ F_k = \\begin{pmatrix} F_{11}  F_{12} \\\\ F_{21}  F_{22} \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ F_{21}F_{11}^{-1}  I \\end{pmatrix} \\begin{pmatrix} F_{11}  0 \\\\ 0  F_{22} - F_{21}F_{11}^{-1}F_{12} \\end{pmatrix} \\begin{pmatrix} I  F_{11}^{-1}F_{12} \\\\ 0  I \\end{pmatrix} $$\n最终因子 $D$ 的对角块是 $D_{kk} = F_{11}$。最终因子 $L$ 的元素由 $F_{21}F_{11}^{-1}$ 计算得出。项 $C_{k+1} = -F_{21}F_{11}^{-1}F_{12}$ 是传递给父节点的更新贡献块。\n\n**第 1 步：消去变量 1**\n波前集为 $\\{1, 2\\}$。初始波前矩阵 $F_1$ 由 $A$ 的相应子矩阵构成，因为没有先前的贡献。\n$$ F_1 = \\begin{pmatrix} A_{11}  A_{12} \\\\ A_{21}  A_{22} \\end{pmatrix} = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} $$\n我们消去主元变量 1。主元块为 $D_{11} = 2$。\n$L$ 因子中对应的元素是 $L_{21} = A_{21} D_{11}^{-1} = (-1) (2)^{-1} = -\\frac{1}{2}$。\n对剩余变量 2 的更新贡献是一个将在下一步中组装的 $1 \\times 1$ 矩阵 $C_2$。\n$$ C_2 = -A_{21} D_{11}^{-1} A_{12} = -(-1)(2^{-1})(-1) = -\\frac{1}{2} $$\n\n**第 2 步：消去变量 2**\n波前集为 $\\{2, 3\\}$。波前矩阵 $F_2$ 的组装方法是：取 $A$ 中索引为 $\\{2, 3\\}$ 的子矩阵，并将贡献 $C_2$ 加到对应于变量 2 的元素上。\n$$ F_2 = \\begin{pmatrix} A_{22}  A_{23} \\\\ A_{32}  A_{33} \\end{pmatrix} + \\begin{pmatrix} C_2  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2}  -1 \\\\ -1  2 \\end{pmatrix} $$\n我们消去主元变量 2。主元块为 $D_{22} = \\frac{3}{2}$。\n$L$ 因子中的元素是 $L_{32} = F_{2(2,1)} D_{22}^{-1} = (-1) (\\frac{3}{2})^{-1} = -\\frac{2}{3}$。\n对变量 3 的更新贡献是 $C_3$。\n$$ C_3 = -F_{2(2,1)} D_{22}^{-1} F_{2(1,2)} = -(-1)(\\frac{2}{3})(-1) = -\\frac{2}{3} $$\n\n**第 3 步：消去变量 3**\n波前集为 $\\{3, 4\\}$。波前矩阵 $F_3$ 由 $A$ 的相应部分和贡献 $C_3$ 组装而成。\n$$ F_3 = \\begin{pmatrix} A_{33}  A_{34} \\\\ A_{43}  A_{44} \\end{pmatrix} + \\begin{pmatrix} C_3  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} + \\begin{pmatrix} -\\frac{2}{3}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3}  -1 \\\\ -1  2 \\end{pmatrix} $$\n我们消去主元变量 3。主元块为 $D_{33} = \\frac{4}{3}$。\n$L$ 因子中的元素是 $L_{43} = F_{3(2,1)} D_{33}^{-1} = (-1) (\\frac{4}{3})^{-1} = -\\frac{3}{4}$。\n对变量 4 的更新贡献是 $C_4$。\n$$ C_4 = -F_{3(2,1)} D_{33}^{-1} F_{3(1,2)} = -(-1)(\\frac{3}{4})(-1) = -\\frac{3}{4} $$\n\n**第 4 步：消去变量 4**\n波前集为 $\\{4, 5\\}$。波前矩阵 $F_4$ 由 $A$ 的相应部分和贡献 $C_4$ 组装而成。\n$$ F_4 = \\begin{pmatrix} A_{44}  A_{45} \\\\ A_{54}  A_{55} \\end{pmatrix} + \\begin{pmatrix} C_4  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} + \\begin{pmatrix} -\\frac{3}{4}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4}  -1 \\\\ -1  2 \\end{pmatrix} $$\n我们消去主元变量 4。主元块为 $D_{44} = \\frac{5}{4}$。\n$L$ 因子中的元素是 $L_{54} = F_{4(2,1)} D_{44}^{-1} = (-1) (\\frac{5}{4})^{-1} = -\\frac{4}{5}$。\n对变量 5 的更新贡献是 $C_5$。\n$$ C_5 = -F_{4(2,1)} D_{44}^{-1} F_{4(1,2)} = -(-1)(\\frac{4}{5})(-1) = -\\frac{4}{5} $$\n\n**第 5 步：消去变量 5**\n波前集为 $\\{5\\}$。这是最后一步（消元树的根节点）。波前矩阵 $F_5$ 由 $A_{55}$ 和贡献 $C_5$ 组装而成。\n$$ F_5 = (A_{55}) + (C_5) = (2) + (-\\frac{4}{5}) = (\\frac{6}{5}) $$\n这个完全组装好的矩阵是最后一个主元块，即 $D_{55} = \\frac{6}{5}$。分解完成。\n\n分解 $A = LDL^{\\top}$ 得到的因子为：\n$$\nL = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n-\\frac{1}{2}  1  0  0  0 \\\\\n0  -\\frac{2}{3}  1  0  0 \\\\\n0  0  -\\frac{3}{4}  1  0 \\\\\n0  0  0  -\\frac{4}{5}  1\n\\end{pmatrix},\n\\quad\nD = \\begin{pmatrix}\n2  0  0  0  0 \\\\\n0  \\frac{3}{2}  0  0  0 \\\\\n0  0  \\frac{4}{3}  0  0 \\\\\n0  0  0  \\frac{5}{4}  0 \\\\\n0  0  0  0  \\frac{6}{5}\n\\end{pmatrix}\n$$\n\n最后，我们计算 $A$ 的行列式。利用性质 $\\det(XYZ) = \\det(X)\\det(Y)\\det(Z)$，我们有：\n$$ \\det(A) = \\det(L)\\det(D)\\det(L^{\\top}) $$\n由于 $L$ 和 $L^{\\top}$ 是单位三角矩阵，它们的行列式都为 1。因此，$\\det(A) = \\det(D)$。对角矩阵 $D$ 的行列式是其对角元素的乘积。\n$$ \\det(A) = D_{11} \\cdot D_{22} \\cdot D_{33} \\cdot D_{44} \\cdot D_{55} $$\n$$ \\det(A) = 2 \\times \\frac{3}{2} \\times \\frac{4}{3} \\times \\frac{5}{4} \\times \\frac{6}{5} $$\n这是一个伸缩积：\n$$ \\det(A) = \\cancel{2} \\times \\frac{\\cancel{3}}{\\cancel{2}} \\times \\frac{\\cancel{4}}{\\cancel{3}} \\times \\frac{\\cancel{5}}{\\cancel{4}} \\times \\frac{6}{\\cancel{5}} = 6 $$\n矩阵 $A$ 的行列式是 $6$。",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "通过前面的具体示例，我们已经观察到消除一个节点会在其邻居之间产生一个稠密的更新块。这个最后的练习旨在将这一观察推广和形式化。你将推导出一个通用公式，用于量化由单节点消元产生的舒尔补更新的影响范围及其引入的新增非零元的数量，完成这个推导将帮助你牢固掌握填充生成的核心机制，这是理解多前沿和超节点方法性能的关键。",
            "id": "3560966",
            "problem": "考虑一个对称正定 (SPD) 稀疏矩阵 $A \\in \\mathbb{R}^{n \\times n}$，并设其稀疏模式由一个无向图 $G(A)$ 表示，该图的顶点集为 $\\{1,2,\\dots,n\\}$，其中当且仅当对于 $p \\neq q$ 有 $A_{pq} \\neq 0$ 时，存在一条无向边 $\\{p,q\\}$。设 $i \\in \\{1,\\dots,n\\}$ 是一个在多波前或超节点直接求解器中待消元的节点。定义邻居集合 $N(i) = \\{ j \\in \\{1,\\dots,n\\} \\setminus \\{i\\} : A_{ij} \\neq 0 \\}$ 并设 $R = \\{1,\\dots,n\\} \\setminus \\{i\\}$。通过消去节点 $i$ 在 $R$ 上产生的舒尔补是矩阵 $S^{(i)} \\in \\mathbb{R}^{(n-1) \\times (n-1)}$，由下式给出：\n$$\nS^{(i)} = A_{RR} - A_{Ri} A_{ii}^{-1} A_{iR}.\n$$\n假设使用精确算术且无数值抵消。设 $k = |N(i)|$，并设 $m$ 表示子矩阵 $A_{N(i),N(i)}$ 中最初存在的上三角非对角非零元的数量（等价于 $G(A)$ 在 $N(i)$ 上的导出子图中的无向边数）。\n\n仅使用稀疏矩阵的图和舒尔补的核心定义，推导出：\n- 受消去 $i$ 影响的舒尔补更新子矩阵的大小（表示为受影响索引集的维度），以及\n- 相对于 $A_{RR}$，在 $S^{(i)}$ 的受影响子矩阵内新引入的上三角非对角非零元的数量。\n\n请使用 $\\mathrm{pmatrix}$ 环境将你的最终答案表示为一个双元素行向量，其中第一个元素等于维度，第二个元素等于新上三角非对角非零元的数量，以 $k$ 和 $m$ 的符号函数形式给出。无需四舍五入，且不涉及物理单位。",
            "solution": "我们从稀疏矩阵的图和舒尔补的基本定义出发。对于一个对称正定矩阵 $A$，在多波前或超节点直接求解器中消去单个节点 $i$ 会在剩余的索引集 $R = \\{1,\\dots,n\\} \\setminus \\{i\\}$ 上产生一个舒尔补：\n$$\nS^{(i)} = A_{RR} - A_{Ri} A_{ii}^{-1} A_{iR}.\n$$\n项 $A_{Ri} A_{ii}^{-1} A_{iR}$ 是由消去 $i$ 引起的更新项。因为 $A$ 是对称的，$A_{Ri} = A_{iR}^{\\top}$，所以该更新项可以写成一个由标量 $A_{ii}^{-1}$ 缩放的秩一外积。通过下式定义向量 $u \\in \\mathbb{R}^{n-1}$：\n$$\nu = A_{Ri},\n$$\n该向量汇集了矩阵 $A$ 的第 $i$ 列中除对角元 $A_{ii}$ 之外的所有元素。根据邻居集合的定义，$u$ 的支撑集（即 $u$ 的非零元所在的索引集合）恰好是 $N(i)$。那么更新项为：\n$$\nU^{(i)} := A_{Ri} A_{ii}^{-1} A_{iR} = A_{ii}^{-1} \\, u \\, u^{\\top}.\n$$\n\n我们分析两个方面：受影响子矩阵的大小（维度），以及稀疏性（新上三角非对角非零元的数量）。\n\n1. 大小（受影响子矩阵的维度）：\n更新项 $U^{(i)}$ 的非零元仅出现在索引对 $(p,q)$ 处，其中 $p$ 和 $q$ 都在 $u$ 的支撑集中，即 $p \\in N(i)$ 且 $q \\in N(i)$。因此，该更新只影响由 $N(i) \\times N(i)$ 索引的子矩阵。这个受影响子矩阵的维度（即索引集 $N(i)$ 的基数）为\n$$\nk = |N(i)|.\n$$\n因此，舒尔补中受影响块的大小为 $k$（意即一个 $k \\times k$ 的子矩阵）。\n\n2. 稀疏性（新引入的上三角非对角非零元的数量）：\n由于 $U^{(i)} = A_{ii}^{-1} \\, u \\, u^{\\top}$ 是一个外积，且 $u$ 的非零元恰好在 $N(i)$ 上，因此更新项 $U^{(i)}$ 限制在 $N(i) \\times N(i)$ 上是稠密的：对于任何 $p,q \\in N(i)$，我们有\n$$\nU^{(i)}_{pq} = A_{ii}^{-1} \\, u_{p} \\, u_{q},\n$$\n在无数值抵消和精确算术的假设下，只要 $u_{p}$ 和 $u_{q}$ 非零，该式就非零。因此，在上三角部分，所有满足 $p \\neq q$ 且 $p,q \\in N(i)$ 的非对角位置 $(p,q)$ 在更新中都变为非零。一个 $k \\times k$ 矩阵中不同上三角非对角位置的总数为 $\\binom{k}{2}$。\n\n然而，其中一些位置在原始子矩阵 $A_{N(i),N(i)}$ 中可能已经是非零的。设 $m$ 表示最初存在于 $A_{N(i),N(i)}$ 中的上三角非对角非零元的数量。这些对应于 $G(A)$ 中在 $N(i)$ 上的导出子图中的无向边，并且在上三角中只被计数一次。新引入的上三角非对角非零元（即填充元）是那些在 $A_{N(i),N(i)}$ 中为零，但由于 $U^{(i)}$ 而变为非零的位置。因此，新上三角非对角非零元的数量为：\n$$\n\\binom{k}{2} - m.\n$$\n\n汇总所求的两个量：\n- 受影响子矩阵的维度为 $k$。\n- 该子矩阵内新引入的上三角非对角非零元的数量为 $\\binom{k}{2} - m$。\n\n因此，最终答案是双元素行向量\n$$\n\\begin{pmatrix}\nk  \\binom{k}{2} - m\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} k  \\binom{k}{2} - m \\end{pmatrix}}$$"
        }
    ]
}