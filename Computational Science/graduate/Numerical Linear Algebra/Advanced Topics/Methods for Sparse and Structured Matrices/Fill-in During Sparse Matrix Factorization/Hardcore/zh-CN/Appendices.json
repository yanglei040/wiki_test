{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于稀疏矩阵分解的图论模型。在这个模型中，消去一个节点等同于将其所有邻接点连接成一个完全图（团），而填充（fill-in）正是此过程中添加的边。 这个练习将引导你通过一个基础的案例，亲手计算和可视化填充的产生过程。通过在一个简单的4-循环图上比较两种不同的消元顺序，你将直接观察到消元顺序如何改变Cholesky因子的结构，这是理解重排序算法为何至关重要的第一步。",
            "id": "3545912",
            "problem": "考虑对称正定 (SPD) 矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其稀疏模式对应于顶点集为 $\\{1,2,3,4\\}$ 的 $4$-循环图，即，对所有 $i$，$a_{ii} \\neq 0$；且当且仅当 $\\{i,j\\} \\in \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}\\}$ 时，$a_{ij} \\neq 0$，所有其他非对角线元素为零。假设该模式上的非零值为一般值，从而没有偶然的数值抵消影响结构性填充。我们进行不带主元选择的 Cholesky 分解 $A = L L^{\\top}$，并纯粹在由顶点排序引发的消去图的层面上分析填充（fill-in）。\n\n仅使用稀疏 Cholesky 分解的核心定义及其图论解释（即：在消去一个顶点的过程中，其所有尚未被消去的邻接点在填充图中形成一个团；因子 $L$ 的非零模式对应于这个三角化图或弦化补全图的边），完成以下任务：\n\n- 对于两种排序 $\\pi_{1} = (1,2,3,4)$ 和 $\\pi_{2} = (2,3,4,1)$，精确地列出在每种排序下，除了由 $A$ 的原始稀疏性所决定的位置之外，$L$ 的哪些严格下三角位置 $(i,j)$（其中 $i  j$）因填充而变为非零。\n- 使用弦化补全和完美消去排序的概念，解释为什么即使原始矩阵相同，两种填充模式的位置也可能不同。\n\n令 $f(\\pi)$ 表示在使用排序 $\\pi$ 时，$L$ 中不在 $A$ 原始稀疏模式中的严格下三角填充项的总数。计算单一番量 $|f(\\pi_{1}) - f(\\pi_{2})|$。请以无单位的精确整数形式提供最终答案。无需四舍五入。",
            "solution": "该问题要求对一个特定的稀疏对称正定 (SPD) 矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 在两种不同排序下的 Cholesky 分解过程中的填充（fill-in）进行分析。该分析将使用稀疏矩阵分解的图论模型进行。\n\n首先，我们定义图 $G=(V, E)$ 来表示矩阵 $A$ 的稀疏模式。顶点集为 $V = \\{1, 2, 3, 4\\}$。边集 $E$ 包含一条边 $\\{i,j\\}$ 当且仅当元素 $a_{ij}$ 是一个指定的非对角非零元。根据题目描述，$a_{ij} \\neq 0$ 当且仅当 $\\{i,j\\} \\in \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}\\}$。这个结构对应于一个长度为4的循环图，通常表示为 $C_4$。对角线元素 $a_{ii}$ 也是非零的，这在图表示中对于一个顶点是隐含的。\n\n$A$ 的严格下三角部分的非零元对应于 $E$ 中的边。对于一条边 $\\{i,j\\}$，对应的矩阵位置是 $(\\max(i,j), \\min(i,j))$。因此，$A$ 的严格下三角部分的初始非零位置是 $(2,1)$, $(3,2)$, $(4,3)$ 和 $(4,1)$。\n\n填充项是在 Cholesky 因子 $L$ 中，在原始矩阵 $A$ 中为零的位置上创建的新非零元。在图模型中，这对应于在消去过程中向图 $G$ 中添加边。$L+L^{\\top}$ 的非零模式由最终的*填充图*（或*弦化补全图*）的边集给出，记为 $G^+$。\n\n对于一个排序 $\\pi$，消去过程通过逐一消去顶点来进行。当一个顶点 $v$ 被消去时，其在当前图中所有尚未被消去的邻接点被连接起来形成一个团。在此过程中添加的任何不在原始图 $G$ 中的边都代表一个填充。\n\n让我们分析给定的两种排序。\n\n**对排序 $\\pi_{1} = (1, 2, 3, 4)$ 的分析**\n\n我们从图 $G = (V, E)$ 开始，其中 $E = \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}\\}$。我们将消去过程中生成的图序列表示为 $G_0, G_1, G_2, \\dots$，其中 $G_0=G$。\n\n1.  **消去顶点 $1$**：在 $G_0$ 中，顶点 $1$ 的邻接点是顶点 $\\{2,4\\}$。这些邻接点在 $G_0$ 中没有边相连（即 $\\{2,4\\} \\notin E$）。为了形成一个团，我们必须添加边 $\\{2,4\\}$。这是一条填充边。新图为 $G_1 = (V, E \\cup \\{\\{2,4\\}\\})$。这个填充对应于 Cholesky 因子 $L$ 在位置 $(\\max(2,4), \\min(2,4)) = (4,2)$ 处的一个新非零元。\n\n2.  **消去顶点 $2$**：我们现在考虑图 $G_1$。在 $G_1$ 中，顶点 $2$ 的邻接点是 $\\{1,3,4\\}$。未被消去的邻接点（在 $\\pi_1$ 中出现在 $2$ 之后的点）是 $\\{3,4\\}$。我们必须确保这些邻接点形成一个团。边 $\\{3,4\\}$ 已经存在于原始图 $G_0$ 中（因此也存在于 $G_1$ 中）。因此，没有新边被添加。\n\n3.  **消去顶点 $3$**：我们考虑当前的图。顶点 $3$ 的邻接点是 $\\{2,4\\}$。唯一未被消去的邻接点是顶点 $4$。只含单个顶点的集合自然是一个团，所以没有新边被添加。\n\n4.  **消去顶点 $4$**：这是排序中的最后一个顶点，所以没有未被消去的邻接点需要连接。不产生填充。\n\n对于排序 $\\pi_1$，恰好发生一次填充。填充图为 $G_1^+ = (V, E \\cup \\{\\{2,4\\}\\})$。对应于 $L$ 中严格下三角非零元的边集是 $\\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}, \\{2,4\\}\\}$。这些边对应的位置是 $(2,1), (3,2), (4,3), (4,1), (4,2)$。与原始非零元相比，唯一的填充项在位置 $(4,2)$。\n因此，填充项的数量为 $f(\\pi_1) = 1$。\n\n**对排序 $\\pi_{2} = (2, 3, 4, 1)$ 的分析**\n\n我们再次从图 $G = (V, E)$ 开始。\n\n1.  **消去顶点 $2$**：在 $G_0$ 中，顶点 $2$ 的邻接点是 $\\{1,3\\}$。这些顶点没有边相连。为了形成一个团，我们添加边 $\\{1,3\\}$。这是一条填充边。新图为 $G_1 = (V, E \\cup \\{\\{1,3\\}\\})$。这个填充对应于 $L$ 在位置 $(\\max(1,3), \\min(1,3)) = (3,1)$ 处的一个新非零元。\n\n2.  **消去顶点 $3$**：在当前图 $G_1$ 中，顶点 $3$ 的邻接点是 $\\{2,4,1\\}$。未被消去的邻接点（在 $\\pi_2$ 中出现在 $3$ 之后的点）是 $\\{4,1\\}$。我们必须检查 $\\{4,1\\}$ 是否是一条边。边 $\\{4,1\\}$ 存在于原始图 $G_0$ 中，所以没有新边被添加。\n\n3.  **消去顶点 $4$**：在当前图中，顶点 $4$ 的邻接点是 $\\{3,1\\}$，其中只有 $\\{1\\}$ 是未被消去的。不需要新边。\n\n4.  **消去顶点 $1$**：这是最后一个顶点。不产生填充。\n\n对于排序 $\\pi_2$，也恰好发生一次填充。填充图为 $G_2^+ = (V, E \\cup \\{\\{1,3\\}\\})$。填充项在位置 $(3,1)$。\n因此，填充项的数量为 $f(\\pi_2) = 1$。\n\n**填充模式差异的解释**\n\n填充模式之所以不同，是因为消去排序决定了原始图如何被三角化。一个图是*弦图*（或*三角化图*），如果其每个长度为 $4$ 或更长的环都有一条*弦*（连接环中两个不相邻顶点的边）。稀疏 Cholesky 分解的过程隐式地计算了矩阵图的一个*弦化补全*，其中填充边就是添加的弦。\n\n初始图 $G$ 是一个 $4$-环，这是非弦图的最简单例子。因此，任何消去排序都会导致至少产生一条填充边来打破这个 $4$-环。不产生任何填充的排序称为*完美消去排序* (PEO)，一个图拥有 PEO 当且仅当它是弦图。\n\n-   对于排序 $\\pi_1 = (1,2,3,4)$，消去过程添加了边 $\\{2,4\\}$。这条边作为环 $1-2-3-4-1$ 的一条弦，将其分解为两个 $3$-环（$1-2-4-1$ 和 $2-3-4-2$）。得到的填充图 $G_1^+$ 是弦图。填充的位置是 $(4,2)$。\n\n-   对于排序 $\\pi_2 = (2,3,4,1)$，过程添加了边 $\\{1,3\\}$。这条边也作为同一个 $4$-环的一条弦，但它将其分解为两个不同的 $3$-环（$1-2-3-1$ 和 $1-3-4-1$）。得到的填充图 $G_2^+$ 也是弦图，但它与 $G_1^+$ 是不同的图。填充的位置是 $(3,1)$。\n\n这两种不同的排序导致了对原始图 $G$ 的两种不同的有效弦化补全。由于填充项正是与添加的弦相对应的矩阵位置，不同的弦化补全会导致不同的填充模式。尽管在这个特定的对称情况下，填充的总*数量*是相同的（$1$），但它们的*位置*（$(4,2)$ vs. $(3,1)$）是不同的。\n\n**最终计算**\n\n问题要求计算 $|f(\\pi_1) - f(\\pi_2)|$ 的值。\n我们发现，对于排序 $\\pi_1$，严格下三角填充项的数量为 $f(\\pi_1) = 1$。\n对于排序 $\\pi_2$，严格下三角填充项的数量为 $f(\\pi_2) = 1$。\n因此，所求的量为：\n$$\n|f(\\pi_1) - f(\\pi_2)| = |1 - 1| = 0\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "既然我们知道顺序至关重要，自然会问：如何找到一个好的消元顺序？最简单的策略是最小度（Minimum Degree）启发式算法。 这个练习通过一个精心设计的思想实验，揭示了这种看似直观的策略的内在缺陷。你将分析一个特殊构造的图，其中两个节点的度相同，但消除它们产生的填充却截然不同，从而深刻理解为何仅仅考虑节点度不足以预测填充，其邻接点子图的结构同样关键。",
            "id": "3545929",
            "problem": "考虑对一个实对称正定矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 进行无数值主元选择的稀疏对称 Cholesky 分解，其中稀疏模式的演化由标准消去图模型控制：消去一个顶点 $v$ 会添加填充边，使其邻居集 $N(v)$ 在当前图中成为一个团。\n\n构造以下由整数 $m \\geq 3$ 参数化的稀疏矩阵族。设顶点集被划分为 $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$，其中 $U = \\{u_1,\\dots,u_m\\}$ 且 $V = \\{v_1,\\dots,v_m\\}$。定义 $A$ 的结构模式（等价于初始图 $G$）如下：\n- $U$ 是一个独立集：对所有 $1 \\leq i  j \\leq m$，$A_{u_i u_j} = 0$。\n- $V$ 是一个团：对所有 $1 \\leq i  j \\leq m$，$A_{v_i v_j} \\neq 0$。\n- $x$ 仅与 $U$ 相邻：对所有 $1 \\leq i \\leq m$，$A_{x u_i} \\neq 0$，且对所有 $1 \\leq j \\leq m$，$A_{x y} = 0$，$A_{x v_j} = 0$。\n- $y$ 仅与 $V$ 相邻：对所有 $1 \\leq j \\leq m$，$A_{y v_j} \\neq 0$，且对所有 $1 \\leq i \\leq m$，$A_{x y} = 0$，$A_{y u_i} = 0$。\n- 对角线元素 $A_{ii} > 0$ 被选择得足够大以使 $A$ 成为对称正定矩阵；在这 $2m+2$ 个顶点中，不存在其他非对角线的非零元。\n\n假设使用最小度启发式算法来选择消去主元，并且在具有相同当前度的顶点之间任意打破平局。在初始图 $G$ 中，注意 $\\deg(x) = m$ 和 $\\deg(y) = m$，而 $\\deg(u_i) = 1$ 和 $\\deg(v_j) = m$。为了在启发式算法必须在 $x$ 和 $y$ 之间做出选择时分离其行为，我们将注意力限制在 $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$ 上的导出子图上，在消去过程的某个阶段，先前被消去的顶点已经移除了任何度数更低的干扰项，因此 $x$ 和 $y$ 都属于当前的最小度候选顶点。仅使用基本规则，即消去一个顶点 $v$ 会精确地添加 $N(v)$ 中缺失的边，以使 $N(v)$ 成为一个团。\n\n关于此构造中的填充行为以及最小度启发式算法可能失败的结构性原因，下列哪些陈述是正确的？\n\nA. 如果启发式算法在 $y$ 之前选择 $x$，那么在第一个消去步骤中，它会在 $U$ 的顶点之间引入恰好 $\\binom{m}{2}$ 条新的填充边。\n\nB. 如果启发式算法在 $x$ 之前选择 $y$，那么在第一个消去步骤中，它会在 $V$ 的顶点之间引入恰好 $\\binom{m}{2}$ 条新的填充边。\n\nC. 存在一个关于 $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$ 的消去顺序，可以在此导出子图内产生零条新的填充边。\n\nD. 最小度启发式算法在此处表现不佳的结构性原因是，$x$ 和 $y$ 具有相同的度 $m$，但其邻居集上的导出子图的密度差异巨大：$N(x) = U$ 是一个独立集，而 $N(y) = V$ 是一个团，因此仅凭度数无法预测消去 $x$ 与消去 $y$ 所产生的即将到来的填充。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **背景**：对实对称正定矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 进行稀疏对称 Cholesky 分解。\n- **方法**：无数值主元选择的消去图模型。\n- **填充规则**：消去一个顶点 $v$ 会通过添加必要的填充边，使其邻居集 $N(v)$ 成为一个团。\n- **图的构造**：在一个划分为 $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$ 的顶点集上构造一个图 $G$。\n- **参数**：$m$ 是一个整数，满足 $m \\geq 3$。\n- **顶点集**：$U = \\{u_1, u_2, \\dots, u_m\\}$ 和 $V = \\{v_1, v_2, \\dots, v_m\\}$。指定的子图中的顶点总数为 $2m+2$。\n- **邻接结构**：\n    1.  $U$ 是一个独立集：对任意 $1 \\leq i  j \\leq m$，边 $(u_i, u_j)$ 不存在。\n    2.  $V$ 是一个团：对任意 $1 \\leq i  j \\leq m$，边 $(v_i, v_j)$ 存在。\n    3.  $x$ 仅与 $U$ 相邻：对所有 $i=1,\\dots,m$，边 $(x, u_i)$ 存在。不存在边 $(x,y)$、$(x,v_j)$。\n    4.  $y$ 仅与 $V$ 相邻：对所有 $j=1,\\dots,m$，边 $(y, v_j)$ 存在。不存在边 $(y,x)$、$(y,u_i)$。\n- **主元选择启发式**：使用最小度启发式算法。任意打破平局。\n- **情景**：问题要求在 $x$ 和 $y$ 属于当前最小度候选顶点的假设条件下，分析该启发式算法的行为，以比较选择其中一个而非另一个的后果。分析应基于初始图结构。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学基础**：该问题在稀疏矩阵分解和图算法的既有理论中有很好的基础。消去图模型、最小度启发式算法以及填充、团和独立集等概念在数值线性代数和计算机科学中都是标准的。\n2.  **适定性**：图结构被明确地定义。消去规则是标准的。问题要求分析特定选择的后果，这可以通过直接应用所述规则来确定。\n3.  **客观性**：问题以精确、客观的数学语言陈述。\n4.  **一致性**：我们来验证在顶点集 $S = \\{x, y\\} \\cup U \\cup V$ 上定义的图 $G$ 中的初始度数。\n    - 对任意 $u_i \\in U$，其唯一的邻居是 $x$。所以 $\\deg(u_i) = 1$。\n    - 对任意 $v_j \\in V$，其邻居是 $y$ 和 $V$ 中的其他 $m-1$ 个顶点。所以 $\\deg(v_j) = 1 + (m-1) = m$。\n    - 对 $x$ 而言，其邻居是 $U$ 中的 $m$ 个顶点。所以 $\\deg(x) = m$。\n    - 对 $y$ 而言，其邻居是 $V$ 中的 $m$ 个顶点。所以 $\\deg(y) = m$。\n    问题陈述设定了一个 $x$ 和 $y$ 是最小度候选顶点的情景。在初始图中，最小度为 1（由所有 $u_i$ 持有），而 $\\deg(x)=\\deg(y)=m$。问题中的措辞“在消去过程的某个阶段，先前被消去的顶点已经移除了任何度数更低的干扰项”是一种教学手段，用以证明直接从初始图中比较消去 $x$ 与消去 $y$ 的合理性，尽管它们不是初始的最小度节点。这种设置不是矛盾，而是一种将问题聚焦于关键概念点的方法。因此，就其目的而言，该问题被认为是自洽的。\n\n### 步骤3：结论与行动\n该问题是有效的。它提出了一个关于最小度启发式算法行为的标准的、具有指导意义的例子。我将继续进行解答。\n\n### 推导与选项分析\n\n设 $G_0$ 是如上所述的初始图。消去一个顶点 $v$ 所产生的填充边数量是 $v$ 的非相邻邻居对的数量。如果邻居集是 $N(v)$，其大小为 $k = \\deg(v)$，则顶点对的数量为 $\\binom{k}{2}$。如果 $N(v)$ 上的导出子图有 $e_{N(v)}$ 条边，则填充边的数量为 $\\binom{k}{2} - e_{N(v)}$。\n\n**选项 A 分析：**\n此选项考虑启发式算法从初始图中选择 $x$ 进行消去的情况。\n- 待消去的顶点是 $x$。\n- 其邻居集是 $N(x) = U = \\{u_1, \\dots, u_m\\}$。\n- $x$ 的度是 $\\deg(x) = |U| = m$。\n- 根据定义，$U$ 是一个独立集。这意味着在 $U$ 上的导出子图中的边数为 $e_{N(x)} = 0$。\n- 为了使 $N(x)$ 成为一个团，我们必须在 $U$ 中的每一对顶点之间添加一条边。一个大小为 $m$ 的团中的边数是 $\\binom{m}{2}$。\n- 产生的填充边数量是 $\\binom{m}{2} - e_{N(x)} = \\binom{m}{2} - 0 = \\binom{m}{2}$。\n- 该陈述声称消去 $x$ 会引入恰好 $\\binom{m}{2}$ 条新的填充边。这与我们的计算相符。\n\n因此，选项 A 是**正确的**。\n\n**选项 B 分析：**\n此选项考虑启发式算法从初始图中选择 $y$ 进行消去的情况。\n- 待消去的顶点是 $y$。\n- 其邻居集是 $N(y) = V = \\{v_1, \\dots, v_m\\}$。\n- $y$ 的度是 $\\deg(y) = |V| = m$。\n- 根据定义，$V$ 是一个团。这意味着在 $V$ 上的导出子图中的边数已经是最大值：$e_{N(y)} = \\binom{m}{2}$。\n- 邻居集 $N(y)$ 已经是一个团，因此不需要新的边。\n- 产生的填充边数量是 $\\binom{m}{2} - e_{N(y)} = \\binom{m}{2} - \\binom{m}{2} = 0$。\n- 该陈述声称消去 $y$ 会引入恰好 $\\binom{m}{2}$ 条新的填充边。我们的计算显示填充边为 0 条。由于 $m \\geq 3$，$\\binom{m}{2} = \\frac{m(m-1)}{2} \\geq 3$，不为 0。\n\n因此，选项 B 是**不正确的**。\n\n**选项 C 分析：**\n此选项询问是否存在针对给定子图中顶点的零填充消去顺序。如果在每一步中，被消去顶点的邻居都已形成一个团，则该顺序导致零填充。这被称为完美消去顺序。\n让我们尝试构造这样一个顺序：\n1.  消去 $U = \\{u_1, \\dots, u_m\\}$ 中的顶点。对任意 $u_i \\in U$，其邻居集为 $N(u_i) = \\{x\\}$。只有一个顶点的集合自然是一个团。消去任何 $u_i$ 都会产生 0 填充。对所有 $u_i$ 重复此操作后，顶点 $x$ 将没有邻居，即被孤立。\n2.  消去顶点 $x$。在 $U$ 中所有顶点被消去后，$N(x)$ 为空。空集自然是一个团，因此消去 $x$ 产生 0 填充。\n3.  剩余的顶点是 $\\{y\\} \\cup V$。这些顶点上的图结构未改变：$y$ 连接到 $V$ 的所有顶点，且 $V$ 是一个团。\n4.  消去顶点 $y$。其邻居集为 $N(y) = V$。根据构造，$V$ 是一个团。因此，消去 $y$ 产生 0 填充。\n5.  剩余的顶点构成团 $V$。从一个团中消去任何顶点 $v$ 会留下一个更小的团。$v$ 在剩余图中的邻居也构成一个团，所以不会产生填充。例如，如果我们消去 $v_1$，其邻居 $\\{v_2, \\dots, v_m\\}$ 构成一个团。这个过程一直持续到所有顶点都被消去。\n\n一个零填充顺序的例子是 $(u_1, u_2, \\dots, u_m, x, y, v_1, v_2, \\dots, v_m)$。由于存在这样的顺序，该陈述是正确的。\n\n因此，选项 C 是**正确的**。\n\n**选项 D 分析：**\n此选项为最小度启发式算法在此情况下的行为提供了一个解释。让我们分析其组成部分：\n- “最小度启发式算法在此处表现不佳的结构性原因……”：该启发式算法可能表现不佳，因为在允许任意打破平局的情况下，它可能会在 $y$ 之前选择消去 $x$。如 A 所示，消去 $x$ 会产生 $\\binom{m}{2}$ 的填充。如 C 所示，存在一个产生 0 填充的最优顺序。因此，该启发式算法可能导致次优结果。这部分是正确的。\n- “……是 $x$ 和 $y$ 具有相同的度 $m$……”：根据我们最初的分析，$\\deg(x) = m$ 且 $\\deg(y) = m$。这是正确的。因为度数相同，最小度启发式算法无法区分它们。\n- “……但其邻居集上的导出子图的密度差异巨大……”：$x$ 的邻居集是 $N(x)=U$。$U$ 上的导出子图是一个独立集（有 0 条边）。$y$ 的邻居集是 $N(y)=V$。$V$ 上的导出子图是一个团（有 $\\binom{m}{2}$ 条边）。$G[U]$ 的边密度为 0，而 $G[V]$ 的边密度为 1。这是一个巨大的差异。这部分是正确的。\n- “……因此仅凭度数无法预测消去 $x$ 与消去 $y$ 所产生的即将到来的填充。”：填充量取决于邻域的“团性”（clique-ness），而不仅仅是其大小（度数）。由于 $\\deg(x)=\\deg(y)$，但填充量分别为 $\\binom{m}{2}$ 和 0，因此在这种情况下，度数是填充的一个糟糕的预测指标。这个陈述正确地指出了这个例子旨在展示的启发式算法的局限性。\n\nD 中的整个陈述是对该问题的正确而深刻的分析。\n\n因此，选项 D 是**正确的**。",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "到目前为止，我们的讨论都集中在如何最小化填充，这是一个纯粹的结构问题。然而在实际计算中，数值稳定性同样至关重要，而保证稳定性的部分主元法（partial pivoting）可能会与保持稀疏性的目标相冲突。 这个练习将让你通过一个具体的计算案例，直观地对比两种分解策略。你将量化地看到，为保证数值稳定性而引入的行交换如何破坏矩阵原有的稀疏结构，并导致远超预期的额外填充，从而理解在稀疏直接求解器设计中，稀疏性与稳定性之间存在的根本性权衡。",
            "id": "3545917",
            "problem": "考虑对称正定 (SPD) 矩阵 $\\mathbf{A} \\in \\mathbb{R}^{5 \\times 5}$，它由 Gram 构造 $\\mathbf{A} = \\mathbf{B}^{\\top}\\mathbf{B} + \\alpha \\mathbf{I}$ 定义，其中 $\\mathbf{B} \\in \\mathbb{R}^{5 \\times 5}$ 是一个稀疏矩阵，由下式给出\n$$\n\\mathbf{B} = \n\\begin{pmatrix}\n1  10  0  0  0 \\\\\n0  10  10  0  0 \\\\\n0  0  10  10  0 \\\\\n0  0  0  10  10 \\\\\n0  0  0  0  10\n\\end{pmatrix},\n$$\n且 $\\alpha = 1$。因此，矩阵 $\\mathbf{A}$ 依其构造是对称正定的。定义矩阵 $\\mathbf{M}$ 中非对角非零元的数量为 $\\mathbf{M}$ 中不位于其对角线上且非零的元素个数；将此量记为 $\\operatorname{nnz}_{\\text{off}}(\\mathbf{M})$。\n\n使用精确算术对 $\\mathbf{A}$ 进行两种分解：\n1. 不进行任何主元选择的 Cholesky 分解（即 $\\mathbf{A} = \\mathbf{L}_{\\text{chol}} \\mathbf{L}_{\\text{chol}}^{\\top}$，其中 $\\mathbf{L}_{\\text{chol}}$ 是下三角矩阵），\n2. 带部分主元选择的 LU 分解（即 $\\mathbf{P}\\mathbf{A} = \\mathbf{L}_{\\text{lu}}\\mathbf{U}_{\\text{lu}}$，其中 $\\mathbf{P}$ 是由主元选择导出的置换矩阵）。\n\n采用标准的“在每一步中，从当前列主元位置及其下方选取绝对值最大的元素作为主元”的部分主元选择策略，确定确切的主元序列以及最终得到的 $\\mathbf{L}_{\\text{lu}}$ 和 $\\mathbf{U}_{\\text{lu}}$ 的稀疏模式。然后，计算比率\n$$\nR \\;=\\; \\frac{\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{lu}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{U}_{\\text{lu}})}{\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}^{\\top})},\n$$\n该比率量化了在同一个对称正定矩阵上，与不带主元选择的 Cholesky 分解相比，带部分主元选择的 LU 分解因主元选择引起的行交换所可能导致的填充元增加。将 $R$ 的最终值表示为最简分数。无需四舍五入。",
            "solution": "当 $\\alpha=1$ 时，矩阵 $\\mathbf{A} = \\mathbf{B}^{\\top}\\mathbf{B} + \\alpha \\mathbf{I}$ 是对称正定的，因为对于任意非零向量 $\\mathbf{x} \\in \\mathbb{R}^{5}$，\n$$\n\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x} = \\mathbf{x}^{\\top}\\mathbf{B}^{\\top}\\mathbf{B}\\mathbf{x} + \\alpha \\|\\mathbf{x}\\|^{2} = \\|\\mathbf{B}\\mathbf{x}\\|^{2} + \\|\\mathbf{x}\\|^{2}  0.\n$$\n我们首先显式地计算 $\\mathbf{A}$。$\\mathbf{B}$ 的列向量为\n$$\n\\mathbf{b}_{1} = (1,0,0,0,0)^{\\top}, \\quad \\mathbf{b}_{2} = (10,10,0,0,0)^{\\top}, \\quad \\mathbf{b}_{3} = (0,10,10,0,0)^{\\top},\n$$\n$$\n\\mathbf{b}_{4} = (0,0,10,10,0)^{\\top}, \\quad \\mathbf{b}_{5} = (0,0,0,10,10)^{\\top}.\n$$\n因此，对角元为\n$$\na_{11} = \\|\\mathbf{b}_{1}\\|^{2} + 1 = 1 + 1 = 2, \\quad a_{ii} = \\|\\mathbf{b}_{i}\\|^{2} + 1 = 200 + 1 = 201 \\text{ for } i=2,3,4,5,\n$$\n非对角元可由内积得出：\n$$\na_{12} = \\mathbf{b}_{1}^{\\top}\\mathbf{b}_{2} = 10, \\quad a_{23} = \\mathbf{b}_{2}^{\\top}\\mathbf{b}_{3} = 100, \\quad a_{34} = 100, \\quad a_{45} = 100,\n$$\n根据对称性有 $a_{21} = a_{12}$，$a_{32} = a_{23}$ 等，且所有其他非对角元均为零。因此，\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n2  10  0  0  0 \\\\\n10  201  100  0  0 \\\\\n0  100  201  100  0 \\\\\n0  0  100  201  100 \\\\\n0  0  0  100  201\n\\end{pmatrix},\n$$\n该矩阵是三对角的，且具有值很大的上、下对角元。\n\n对于不带主元选择的 Cholesky 分解，数值线性代数中一个经过充分检验的结论是：对称正定带状矩阵的 Cholesky 因子会保持其带宽；具体来说，对于一个三对角对称正定矩阵，其 Cholesky 因子 $\\mathbf{L}_{\\text{chol}}$ 也是带状的，且只有一条下对角线（在该带之外没有额外的填充元）。因此，$\\mathbf{L}_{\\text{chol}}$ 的严格下三角部分的非零元出现在位置 $(2,1)$、$(3,2)$、$(4,3)$、$(5,4)$，总计 $\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) = 4$。由于 $\\mathbf{L}_{\\text{chol}}^{\\top}$ 具有相同数量的严格非对角非零元（位于 $(1,2)$、$(2,3)$、$(3,4)$、$(4,5)$），我们得到\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}^{\\top}) = 4 + 4 = 8.\n$$\n\n我们现在进行带部分主元选择的 LU 分解。该算法在每一步中选择活动列中具有最大绝对值元素的行，并将其交换到主元位置。我们追踪行交换及随后的更新，以确定 $\\mathbf{L}_{\\text{lu}}$ 和 $\\mathbf{U}_{\\text{lu}}$ 的稀疏性。\n\n步骤 $1$（第 $1$ 列主元）：第 $1$ 列的元素在第 $2$ 行为 $10$，在第 $1$ 行为 $2$，其余下方元素为零。绝对值最大的是第 $2$ 行的 $10$，因此交换第 $1$ 行和第 $2$ 行。第一个主元是 $u_{11} = 10$。第 $2$ 行的乘子是 $m_{21} = 2/10 = 0.2$，且 $m_{31} = m_{41} = m_{51} = 0$。通过从第 $2$ 行减去第 $1$ 行的 $m_{21}$ 倍来更新第 $2$ 行，在位置 $(2,3)$ 引入了一个新的非零元：\n$$\na_{23}^{\\text{(updated)}} = 0 - 0.2 \\cdot 100 = -20,\n$$\n更新后的 $(2,2)$ 元素变为 $10 - 0.2 \\cdot 201 = -30.2$。$\\mathbf{L}_{\\text{lu}}$ 的严格下三角元 $(2,1)$ 为 $0.2$。\n\n步骤 $2$（第 $2$ 列主元）：考虑第 $2$ 列的第 $2$ 至 $5$ 行，其值在第 $2$ 行为 $-30.2$，第 $3$ 行为 $100$，其余下方元素为零。绝对值最大的是第 $3$ 行的 $100$，因此交换第 $2$ 行和第 $3$ 行。主元是 $u_{22} = 100$。乘子为 $m_{32} = (-30.2)/100 = -0.302$，$m_{42} = 0$，$m_{52} = 0$。通过从第 $3$ 行减去第 $2$ 行的 $m_{32}$ 倍来更新第 $3$ 行，得到\n$$\na_{33}^{\\text{(updated)}} = -20 - (-0.302) \\cdot 201 = -20 + 60.702 = 40.702,\n$$\n和\n$$\na_{34}^{\\text{updated)}} = 0 - (-0.302) \\cdot 100 = 30.2.\n$$\n因此，$\\mathbf{L}_{\\text{lu}}$ 的严格下三角元 $(3,2)$ 为 $-0.302$。\n\n步骤 $3$（第 $3$ 列主元）：在第 $3$ 列的第 $3$ 至 $5$ 行中，绝对值分别为第 $3$ 行的 $|40.702|$，第 $4$ 行的 $|100|$，以及第 $5$ 行的 $0$。交换第 $3$ 行和第 $4$ 行。主元是 $u_{33} = 100$。乘子为 $m_{43} = 40.702/100 = 0.40702$，$m_{53} = 0$。更新第 $4$ 行：\n$$\na_{44}^{\\text{(updated)}} = 30.2 - 0.40702 \\cdot 201 = 30.2 - 81.81102 = -51.61102,\n$$\n$$\na_{45}^{\\text{(updated)}} = 0 - 0.40702 \\cdot 100 = -40.702.\n$$\n因此，$\\mathbf{L}_{\\text{lu}}$ 的严格下三角元 $(4,3)$ 为 $0.40702$。\n\n步骤 $4$（第 $4$ 列主元）：在第 $4$ 列的第 $4$ 行和第 $5$ 行中，绝对值分别为第 $4$ 行的 $|{-51.61102}|$ 和第 $5$ 行的 $|100|$。交换第 $4$ 行和第 $5$ 行。主元是 $u_{44} = 100$。乘子是 $m_{54} = (-51.61102)/100 = -0.5161102$。更新第 $5$ 行：\n$$\na_{55}^{\\text{(updated)}} = -40.702 - (-0.5161102)\\cdot 201 = -40.702 + 103.7381502 = 63.0361502.\n$$\n因此，$\\mathbf{L}_{\\text{lu}}$ 的严格下三角元 $(5,4)$ 为 $-0.5161102$。\n\n在这些主元选择步骤之后，收集最终的上三角因子 $\\mathbf{U}_{\\text{lu}}$，其各行为\n$$\n\\text{row }1: (u_{11}, u_{12}, u_{13}, 0, 0) = (10, 201, 100, 0, 0),\n$$\n$$\n\\text{row }2: (0, u_{22}, u_{23}, u_{24}, 0) = (0, 100, 201, 100, 0),\n$$\n$$\n\\text{row }3: (0, 0, u_{33}, u_{34}, u_{35}) = (0, 0, 100, 201, 100),\n$$\n$$\n\\text{row }4: (0, 0, 0, u_{44}, u_{45}) = (0, 0, 0, 100, 201),\n$$\n$$\n\\text{row }5: (0, 0, 0, 0, u_{55}) = (0, 0, 0, 0, 63.0361502).\n$$\n由此可知，$\\mathbf{U}_{\\text{lu}}$ 的严格非对角非零元出现在位置 $(1,2)$、$(1,3)$、$(2,3)$、$(2,4)$、$(3,4)$、$(3,5)$、$(4,5)$，得到\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{U}_{\\text{lu}}) = 7.\n$$\n$\\mathbf{L}_{\\text{lu}}$ 的严格非对角非零元仅出现在第一条下对角线上的位置 $(2,1)$、$(3,2)$、$(4,3)$、$(5,4)$，得到\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{lu}}) = 4.\n$$\n因此，\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{lu}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{U}_{\\text{lu}}) = 4 + 7 = 11.\n$$\n\n相比之下，对于此三对角对称正定矩阵，我们之前在不进行主元选择的 Cholesky 分解中发现\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}^{\\top}) = 8.\n$$\n因此，所求的比率为\n$$\nR = \\frac{11}{8}.\n$$\n这个结果量化了在同一个稀疏对称正定矩阵上，使用带部分主元选择的 LU 分解相比于不带主元选择的 Cholesky 分解，由于主元选择引起的行交换所可能导致的填充元增加。",
            "answer": "$$\\boxed{\\frac{11}{8}}$$"
        }
    ]
}