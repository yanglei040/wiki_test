{
    "hands_on_practices": [
        {
            "introduction": "在区域分解方法中，限制算子 $R_i$ 和延拓算子 $P_i$ 是在全局问题和局部子问题之间传递信息的关键工具。然而，当子区域存在重叠时，直接将局部解分量相加会导致重叠部分的信息被重复计算。本练习  将通过一个简单的一维问题，清晰地揭示这一问题，并引导您构造一个加权的“单位分解”，这是正确组合子区域贡献的基石。",
            "id": "3544213",
            "problem": "考虑一个具有 $7$ 个内部点的均匀网格上的典范一维泊松算子，其带有齐次狄利克雷边界条件。其刚度矩阵是一个 $7 \\times 7$ 的对称正定 (SPD) 三对角矩阵\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0  0  0  0  0 \\\\\n-1  2  -1  0  0  0  0 \\\\\n0  -1  2  -1  0  0  0 \\\\\n0  0  -1  2  -1  0  0 \\\\\n0  0  0  -1  2  -1  0 \\\\\n0  0  0  0  -1  2  -1 \\\\\n0  0  0  0  0  -1  2\n\\end{pmatrix}.\n$$\n将全局索引集 $\\{1,2,3,4,5,6,7\\}$ 划分为两个重叠子域\n$$\n\\Omega_1 \\;=\\; \\{1,2,3,4\\}, \\qquad \\Omega_2 \\;=\\; \\{4,5,6,7\\},\n$$\n在索引 $4$ 处有一个单节点的重叠。令 $R_i \\in \\mathbb{R}^{4 \\times 7}$ 表示从 $\\mathbb{R}^7$ 中的全局向量提取 $\\Omega_i$ 中分量的限制算子，并令 $P_i \\in \\mathbb{R}^{7 \\times 4}$ 为相应的自然注入算子 (即 $P_i = R_i^{\\top}$)。\n\n任务：\n- 明确地将 $R_1$、$R_2$、$P_1$ 和 $P_2$ 写成 0-1 矩阵。\n- 仅使用限制和注入的定义，验证 $\\sum_{i=1}^{2} P_i R_i \\neq I_7$。\n- 现在引入对角缩放 $D_1 = \\mathrm{diag}(1,1,1,w) \\in \\mathbb{R}^{4 \\times 4}$ 和 $D_2 = \\mathrm{diag}(w,1,1,1) \\in \\mathbb{R}^{4 \\times 4}$，其中 $w \\in \\mathbb{R}$ 是一个单个重叠权重，对称地应用于每个子域中的共享节点，而所有非重叠节点的权重为 $1$。确定 $w$ 的唯一实数值（在此对称性假设下），使得单位分解恒等式\n$$\n\\sum_{i=1}^{2} P_i D_i R_i \\;=\\; I_7\n$$\n精确成立。\n\n你的最终答案必须是 $w$ 的精确数值。无需四舍五入。",
            "solution": "该问题在数值线性代数领域，特别是关于区域分解方法方面，是适定的且有科学依据的。所有的定义和数据都是自洽且一致的。刚度矩阵 $A$ 为这类问题的来源提供了背景，但其具体数值对于这些任务而言并非必需，因为这些任务侧重于几何分解和单位分解的构造。因此，我们可以进行完整的解答。\n\n该问题要求我们执行与一个7节点网格的区域分解相关的三个任务。全局索引集为 $\\{1, 2, 3, 4, 5, 6, 7\\}$。\n\n**任务1：明确写出 $R_1$、$R_2$、$P_1$ 和 $P_2$**\n\n对于一个从具有 $n$ 个索引的全局域中抽取的、包含 $m_i$ 个索引的子域 $\\Omega_i$，其限制算子 $R_i \\in \\mathbb{R}^{m_i \\times n}$ 是一个提取与 $\\Omega_i$ 对应的分量的矩阵。此处，全局维度为 $n=7$，两个子域的局部维度均为 $m_1=m_2=4$。\n\n对于第一个子域 $\\Omega_1 = \\{1, 2, 3, 4\\}$，限制算子 $R_1 \\in \\mathbb{R}^{4 \\times 7}$ 提取 $\\mathbb{R}^7$ 中一个全局向量的前四个分量。它的行是 $\\mathbb{R}^7$ 的标准基向量 $e_1^{\\top}, e_2^{\\top}, e_3^{\\top}, e_4^{\\top}$。\n$$\nR_1 \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  0  0  0 \\\\\n0  1  0  0  0  0  0 \\\\\n0  0  1  0  0  0  0 \\\\\n0  0  0  1  0  0  0\n\\end{pmatrix}\n$$\n相应的注入算子 $P_1 \\in \\mathbb{R}^{7 \\times 4}$ 是 $R_1$ 的转置：\n$$\nP_1 = R_1^{\\top} \\;=\\;\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n$$\n\n对于第二个子域 $\\Omega_2 = \\{4, 5, 6, 7\\}$，限制算子 $R_2 \\in \\mathbb{R}^{4 \\times 7}$ 提取分量 $4, 5, 6, 7$。它的行是 $\\mathbb{R}^7$ 的标准基向量 $e_4^{\\top}, e_5^{\\top}, e_6^{\\top}, e_7^{\\top}$。\n$$\nR_2 \\;=\\;\n\\begin{pmatrix}\n0  0  0  1  0  0  0 \\\\\n0  0  0  0  1  0  0 \\\\\n0  0  0  0  0  1  0 \\\\\n0  0  0  0  0  0  1\n\\end{pmatrix}\n$$\n相应的注入算子 $P_2 \\in \\mathbb{R}^{7 \\times 4}$ 是 $R_2$ 的转置：\n$$\nP_2 = R_2^{\\top} \\;=\\;\n\\begin{pmatrix}\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n\n**任务2：验证 $\\sum_{i=1}^{2} P_i R_i \\neq I_7$**\n\n我们计算乘积 $P_1 R_1$ 和 $P_2 R_2$ 并将它们相加。\n乘积 $P_1 R_1$ 是一个 $7 \\times 7$ 矩阵：\n$$\nP_1 R_1 \\;=\\;\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  0  0  0  0  0 \\\\\n0  1  0  0  0  0  0 \\\\\n0  0  1  0  0  0  0 \\\\\n0  0  0  1  0  0  0\n\\end{pmatrix} \\;=\\; \\mathrm{diag}(1, 1, 1, 1, 0, 0, 0)\n$$\n乘积 $P_2 R_2$ 也是一个 $7 \\times 7$ 矩阵：\n$$\nP_2 R_2 \\;=\\;\n\\begin{pmatrix}\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n0  0  0  1  0  0  0 \\\\\n0  0  0  0  1  0  0 \\\\\n0  0  0  0  0  1  0 \\\\\n0  0  0  0  0  0  1\n\\end{pmatrix} \\;=\\; \\mathrm{diag}(0, 0, 0, 1, 1, 1, 1)\n$$\n和为：\n$$\n\\sum_{i=1}^{2} P_i R_i = P_1 R_1 + P_2 R_2 = \\mathrm{diag}(1, 1, 1, 1, 0, 0, 0) + \\mathrm{diag}(0, 0, 0, 1, 1, 1, 1) = \\mathrm{diag}(1, 1, 1, 2, 1, 1, 1)\n$$\n这个结果矩阵不是 $7 \\times 7$ 的单位矩阵 $I_7 = \\mathrm{diag}(1, 1, 1, 1, 1, 1, 1)$，因为第四个对角线元素是 $2$ 而不是 $1$。这是全局索引为 $4$ 的节点同时属于两个子域的直接结果。因此，我们验证了 $\\sum_{i=1}^{2} P_i R_i \\neq I_7$。\n\n**任务3：确定满足单位分解恒等式的 $w$**\n\n我们被要求找出 $w \\in \\mathbb{R}$ 的值，使得 $\\sum_{i=1}^{2} P_i D_i R_i = I_7$，其中 $D_1 = \\mathrm{diag}(1, 1, 1, w)$ 且 $D_2 = \\mathrm{diag}(w, 1, 1, 1)$。我们计算 $P_1 D_1 R_1$ 和 $P_2 D_2 R_2$ 这两项。\n\n对于第一项：\n$$\nP_1 D_1 R_1 = P_1 \\begin{pmatrix}\n1  0  0  0  0  0  0 \\\\\n0  1  0  0  0  0  0 \\\\\n0  0  1  0  0  0  0 \\\\\n0  0  0  w  0  0  0\n\\end{pmatrix} = \\mathrm{diag}(1, 1, 1, w, 0, 0, 0)\n$$\n对于第二项：\n$$\nP_2 D_2 R_2 = P_2 \\begin{pmatrix}\n0  0  0  w  0  0  0 \\\\\n0  0  0  0  1  0  0 \\\\\n0  0  0  0  0  1  0 \\\\\n0  0  0  0  0  0  1\n\\end{pmatrix} = \\mathrm{diag}(0, 0, 0, w, 1, 1, 1)\n$$\n和为：\n$$\n\\sum_{i=1}^{2} P_i D_i R_i = \\mathrm{diag}(1, 1, 1, w, 0, 0, 0) + \\mathrm{diag}(0, 0, 0, w, 1, 1, 1) = \\mathrm{diag}(1, 1, 1, w+w, 1, 1, 1)\n$$\n$$\n= \\mathrm{diag}(1, 1, 1, 2w, 1, 1, 1)\n$$\n为使该矩阵等于单位矩阵 $I_7 = \\mathrm{diag}(1, 1, 1, 1, 1, 1, 1)$，它们的对应元素必须相等。索引为 $1, 2, 3, 5, 6, 7$ 的元素已经为 $1$。对于第四个对角线元素，我们必须有：\n$$\n2w = 1\n$$\n解出 $w$ 可得：\n$$\nw = \\frac{1}{2}\n$$\n这是满足单位分解条件的 $w$ 的唯一值。这种加权方案确保了被计算两次的重叠节点的贡献在每个子域中都按二分之一进行缩放，从而使其总贡献和为一。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在理解了如何在子区域间分配信息后，我们便可以着手构建一个完整的预条件子。本练习  将指导您完成单层加性 Schwarz (AS) 预条件子的完整代数构建过程。通过显式地构造局部矩阵 $A_i$、计算其逆矩阵，并将它们组合成预条件子 $M^{-1}$，您将对 Schwarz 预条件子的定义以及它如何作用于原系统矩阵 $A$ 获得具体而深入的理解。",
            "id": "3544279",
            "problem": "考虑一维泊松方程，其带有齐次狄利克雷边界条件，使用标准的二阶中心有限差分（FD）方法在一个具有$8$个内部点的均匀网格上进行离散化。这产生了一个对称正定矩阵$A \\in \\mathbb{R}^{8 \\times 8}$，其主对角线上的元素为$2$，第一副对角线和第一超对角线上的元素为$-1$。两个重叠的子区域由索引集$\\mathcal{I}_{1}=\\{1,2,3,4,5\\}$和$\\mathcal{I}_{2}=\\{4,5,6,7,8\\}$定义。设限制算子$R_{1} \\in \\mathbb{R}^{5 \\times 8}$和$R_{2} \\in \\mathbb{R}^{5 \\times 8}$分别提取全局向量中对应于$\\mathcal{I}_{1}$和$\\mathcal{I}_{2}$中索引的分量。构建局部算子$A_{1}=R_{1} A R_{1}^{\\top} \\in \\mathbb{R}^{5 \\times 5}$和$A_{2}=R_{2} A R_{2}^{\\top} \\in \\mathbb{R}^{5 \\times 5}$。通过规范公式定义单层加性Schwarz（AS）预条件子\n$$\nM^{-1} \\;=\\; R_{1}^{\\top} A_{1}^{-1} R_{1} \\;+\\; R_{2}^{\\top} A_{2}^{-1} R_{2}.\n$$\n显式计算$R_{1}$和$R_{2}$，显式计算$A_{1}$和$A_{2}$，并根据区域分解的第一性原理以代数形式组装$M^{-1}$和预处理算子$M^{-1}A$。最后，报告矩阵$M^{-1}A$在位置$\\left(4,4\\right)$处的元素精确值。以精确数的形式提供最终答案。无需四舍五入，不涉及单位。",
            "solution": "问题陈述是数值线性代数中一个适定且自洽的练习，具体涉及为一个模型问题构建一个单层加性Schwarz（AS）预条件子。所有参数和定义都是清晰、科学上合理且在区域分解方法领域中是标准的。因此，该问题是有效的。\n\n我们按照问题中概述的步骤进行求解。\n\n**第1步：构建全局矩阵 $A$**\n\n问题描述了使用中心有限差分格式对具有$8$个内部点的均匀网格上的一维泊松方程进行离散化。这产生一个$8 \\times 8$的对称三对角矩阵$A$，其主对角线上的元素为$2$，第一副对角线和超对角线上的元素为$-1$。\n\n$$\nA = \\begin{pmatrix}\n2  -1  0  0  0  0  0  0 \\\\\n-1  2  -1  0  0  0  0  0 \\\\\n0  -1  2  -1  0  0  0  0 \\\\\n0  0  -1  2  -1  0  0  0 \\\\\n0  0  0  -1  2  -1  0  0 \\\\\n0  0  0  0  -1  2  -1  0 \\\\\n0  0  0  0  0  -1  2  -1 \\\\\n0  0  0  0  0  0  -1  2\n\\end{pmatrix}\n$$\n\n**第2步：构建限制算子 $R_1$ 和 $R_2$**\n\n子区域由索引集$\\mathcal{I}_{1}=\\{1,2,3,4,5\\}$和$\\mathcal{I}_{2}=\\{4,5,6,7,8\\}$定义。限制算子$R_k$是一个矩阵，它提取全局向量中对应于$\\mathcal{I}_k$中索引的分量。\n\n算子$R_1 \\in \\mathbb{R}^{5 \\times 8}$通过选择前$5$个分量，将$\\mathbb{R}^8$中的向量映射到$\\mathbb{R}^5$中的向量。这由一个包含$8 \\times 8$单位矩阵前$5$行的矩阵表示。\n\n$$\nR_1 = \\begin{pmatrix}\n1  0  0  0  0  0  0  0 \\\\\n0  1  0  0  0  0  0  0 \\\\\n0  0  1  0  0  0  0  0 \\\\\n0  0  0  1  0  0  0  0 \\\\\n0  0  0  0  1  0  0  0\n\\end{pmatrix}\n$$\n\n算子$R_2 \\in \\mathbb{R}^{5 \\times 8}$通过选择分量$4, 5, 6, 7, 8$，将$\\mathbb{R}^8$中的向量映射到$\\mathbb{R}^5$中的向量。\n\n$$\nR_2 = \\begin{pmatrix}\n0  0  0  1  0  0  0  0 \\\\\n0  0  0  0  1  0  0  0 \\\\\n0  0  0  0  0  1  0  0 \\\\\n0  0  0  0  0  0  1  0 \\\\\n0  0  0  0  0  0  0  1\n\\end{pmatrix}\n$$\n\n**第3步：构建局部算子 $A_1$ 和 $A_2$**\n\n局部算子定义为 $A_k = R_k A R_k^{\\top}$。\n\n对于 $A_1 = R_1 A R_1^{\\top}$，$R_1 A$ 选择了 $A$ 的前 $5$ 行，然后右乘以 $R_1^{\\top}$ 选择了结果的前 $5$ 列。这对应于提取与索引 $\\{1,2,3,4,5\\}$ 相关联的 $A$ 的主子矩阵。\n\n$$\nA_1 = R_1 A R_1^{\\top} = \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}\n$$\n\n对于 $A_2 = R_2 A R_2^{\\top}$，该操作提取了与索引 $\\{4,5,6,7,8\\}$ 相关联的 $A$ 的主子矩阵。\n\n$$\nA_2 = R_2 A R_2^{\\top} = \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}\n$$\n\n因此，$A_1$ 和 $A_2$ 是相同的 $5 \\times 5$ 矩阵。\n\n**第4步：计算局部算子的逆**\n\n我们需要计算 $A_1^{-1}$ 和 $A_2^{-1}$。由于 $A_1=A_2$，它们的逆也相同。对于一个主对角线上为$2$，副对角线上为$-1$的$n \\times n$矩阵$T_n$，其逆矩阵的元素由公式$(T_n^{-1})_{ij} = \\frac{\\min(i,j)(n+1-\\max(i,j))}{n+1}$给出。\n对于我们的 $5 \\times 5$ 矩阵，$n=5$。因此，$(A_1^{-1})_{ij} = \\frac{\\min(i,j)(6-\\max(i,j))}{6}$。\n\n$$\nA_1^{-1} = A_2^{-1} = \\frac{1}{6} \\begin{pmatrix}\n5  4  3  2  1 \\\\\n4  8  6  4  2 \\\\\n3  6  9  6  3 \\\\\n2  4  6  8  4 \\\\\n1  2  3  4  5\n\\end{pmatrix}\n$$\n\n**第5步：组装预条件子 $M^{-1}$**\n\n加性Schwarz预条件子由$M^{-1} = R_{1}^{\\top} A_{1}^{-1} R_{1} + R_{2}^{\\top} A_{2}^{-1} R_{2}$给出。\n\n项 $R_{1}^{\\top} A_{1}^{-1} R_{1}$ 将局部逆 $A_1^{-1}$“延拓”回全局$8 \\times 8$空间，并用零填充。这导致 $A_1^{-1}$ 占据了对应于索引 $\\{1,2,3,4,5\\}$ 的左上角 $5 \\times 5$ 块。\n项 $R_{2}^{\\top} A_{2}^{-1} R_{2}$ 类似地将 $A_2^{-1}$ 延拓到对应于索引 $\\{4,5,6,7,8\\}$ 的 $8 \\times 8$ 块中。\n\n我们将这两个矩阵相加。重叠部分发生在对应于索引 $\\{4,5\\}$ 的块上。\n\n$$\n6 M^{-1} =\n\\begin{pmatrix}\n5  4  3  2  1  0  0  0 \\\\\n4  8  6  4  2  0  0  0 \\\\\n3  6  9  6  3  0  0  0 \\\\\n2  4  6  8  4  0  0  0 \\\\\n1  2  3  4  5  0  0  0 \\\\\n0  0  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  0\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0  0  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  0 \\\\\n0  0  0  5  4  3  2  1 \\\\\n0  0  0  4  8  6  4  2 \\\\\n0  0  0  3  6  9  6  3 \\\\\n0  0  0  2  4  6  8  4 \\\\\n0  0  0  1  2  3  4  5\n\\end{pmatrix}\n$$\n\n$$\n6 M^{-1} =\n\\begin{pmatrix}\n5  4  3  2  1  0  0  0 \\\\\n4  8  6  4  2  0  0  0 \\\\\n3  6  9  6  3  0  0  0 \\\\\n2  4  6  13  8  3  2  1 \\\\\n1  2  3  8  13  6  4  2 \\\\\n0  0  0  3  6  9  6  3 \\\\\n0  0  0  2  4  6  8  4 \\\\\n0  0  0  1  2  3  4  5\n\\end{pmatrix}\n$$\n\n因此，我们得到了 $M^{-1}$ 的代数形式。\n\n**第6步：计算元素 $(M^{-1}A)_{4,4}$**\n\n预处理算子 $M^{-1}A$ 的元素 $(M^{-1}A)_{4,4}$ 是 $M^{-1}$ 的第 $4$ 行与 $A$ 的第 $4$ 列的内积。\n\n$M^{-1}$ 的第 $4$ 行是：\n$$ (M^{-1})_{4,*} = \\frac{1}{6} \\begin{pmatrix} 2  4  6  13  8  3  2  1 \\end{pmatrix} $$\n\n$A$ 的第 $4$ 列是：\n$$ (A)_{*,4} = \\begin{pmatrix} 0  0  -1  2  -1  0  0  0 \\end{pmatrix}^{\\top} $$\n\n现在，我们计算内积：\n$$ (M^{-1}A)_{4,4} = \\left( \\frac{1}{6} \\begin{pmatrix} 2  4  6  13  8  3  2  1 \\end{pmatrix} \\right) \\cdot \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\\\ 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n$$ (M^{-1}A)_{4,4} = \\frac{1}{6} \\left[ (2)(0) + (4)(0) + (6)(-1) + (13)(2) + (8)(-1) + (3)(0) + (2)(0) + (1)(0) \\right] $$\n$$ (M^{-1}A)_{4,4} = \\frac{1}{6} \\left[ 0 + 0 - 6 + 26 - 8 + 0 + 0 + 0 \\right] $$\n$$ (M^{-1}A)_{4,4} = \\frac{1}{6} \\left[ 26 - 14 \\right] $$\n$$ (M^{-1}A)_{4,4} = \\frac{12}{6} = 2 $$\n\n或者，我们可以利用 $A$ 的结构：$(M^{-1}A)_{4,4} = (M^{-1}( -e_3 + 2e_4 - e_5 ))_4 = -(M^{-1})_{4,3} + 2(M^{-1})_{4,4} - (M^{-1})_{4,5}$，其中 $e_j$ 是标准基向量。使用我们计算出的 $M^{-1}$ 第 $4$ 行的元素：\n$$ (M^{-1})_{4,3} = \\frac{6}{6} = 1 $$\n$$ (M^{-1})_{4,4} = \\frac{13}{6} $$\n$$ (M^{-1})_{4,5} = \\frac{8}{6} $$\n因此：\n$$ (M^{-1}A)_{4,4} = -1 + 2\\left(\\frac{13}{6}\\right) - \\frac{8}{6} = -\\frac{6}{6} + \\frac{26}{6} - \\frac{8}{6} = \\frac{26 - 14}{6} = \\frac{12}{6} = 2 $$\n两种方法得到相同的结果。$M^{-1}A$ 在重叠节点处的对角线元素值为 $2$，这反映了该自由度是两个子问题的一部分，局部解的简单加性组合导致了在该节点处的“双重”校正。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "除了并行修正的加性方法，Schwarz 方法还有另一种重要的形式：乘性方法，其中子区域的修正是按顺序依次进行的。本练习  将焦点转向乘性 Schwarz 方法，要求您推导其误差传播算子。通过计算该算子的谱半径，您将能直接评估算法的收敛速度，从而体验将 Schwarz 方法作为定常迭代进行理论分析的核心思想。",
            "id": "3544255",
            "problem": "考虑一维泊松边值问题 $-u''(x)=f(x)$，定义在区间 $[0,1]$ 上，并带有齐次狄利克雷边界条件 $u(0)=u(1)=0$。使用标准二阶中心有限差分法进行离散化，设内部网格点数量为 $N=5$。对于线性系统 $A u = b$，取刚度矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 为未缩放的狄利克雷离散拉普拉斯算子\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}.\n$$\n将索引集 $\\{1,2,3,4,5\\}$ 划分为两个重叠的子区域 $\\Omega_{1}=\\{1,2,3\\}$ 和 $\\Omega_{2}=\\{3,4,5\\}$。定义限制算子 $R_{1},R_{2} \\in \\mathbb{R}^{3 \\times 5}$ 分别用于提取在 $\\Omega_{1}$ 和 $\\Omega_{2}$ 上的分量，并设置延拓算子为 $P_{i}=R_{i}^{\\top}$（其中 $i \\in \\{1,2\\}$）。通过 $A_{i} = R_{i} A P_{i}$ 定义局部算子，这对应于在人工子区域边界上施加齐次狄利克雷条件下的精确子区域求解。考虑乘性交替 Schwarz 方法 (ASM)，该方法在每次迭代中先对 $\\Omega_{1}$ 进行精确求解，然后对 $\\Omega_{2}$ 进行精确求解。将其视为一个线性作用于当前误差向量的定常方法。\n\n仅从这些定义出发，首先推导双子区域乘性 Schwarz 迭代的单步误差传播算子，用 $A$, $R_{i}$, $P_{i}$ 和 $A_{i}^{-1}$ 表示，并根据数值线性代数和区域分解的基本原理解释推导的每一步。然后，对于上述具体数据，构建显式的 $5 \\times 5$ 迭代矩阵并计算其谱半径 $\\rho(E)$。\n\n提供 $\\rho(E)$ 的精确值作为最终答案。无需四舍五入，也无需报告单位。",
            "solution": "该问题是有效的，因为它具有科学依据、是适定的、客观且完整的。它代表了区域分解方法数值分析中的一个标准练习。我将按要求进行求解，求解过程包括两个主要部分：首先，推导误差传播算子；其次，根据给定数据进行显式计算并求出其谱半径。\n\n**第一部分：乘性 Schwarz 误差传播算子的推导**\n\n设线性系统的精确解为 $u$，满足 $A u = b$。设 $u^{(k)}$ 为第 $k$ 次迭代的近似解。本次迭代的误差定义为 $e^{(k)} = u - u^{(k)}$。残差为 $r^{(k)} = b - A u^{(k)} = A u - A u^{(k)} = A(u - u^{(k)}) = A e^{(k)}$。\n\n乘性交替 Schwarz 方法 (ASM) 包括在子区域 $\\Omega_1$ 和 $\\Omega_2$ 上的顺序校正。\n\n**第一步：在子区域 $\\Omega_1$ 上的校正**\n\n从近似解 $u^{(k)}$ 开始，我们计算一个限制在 $\\Omega_1$ 自由度上的校正量。该校正量通过求解关于当前残差的局部问题来确定。在 $\\Omega_1$ 上的残差为 $r_1^{(k)} = R_1 r^{(k)}$。在 $\\Omega_1$ 坐标系下的局部校正量 $c_1$ 通过求解局部系统 $A_1 c_1 = r_1^{(k)}$ 得到，这对应于在子区域上的精确求解。因此，$c_1 = A_1^{-1} r_1^{(k)} = A_1^{-1} R_1 r^{(k)}$。\n\n然后，这个局部校正量被延拓回全局网格，并加到当前解上，从而产生一个中间解 $u^{(k+1/2)}$：\n$$ u^{(k+1/2)} = u^{(k)} + P_1 c_1 = u^{(k)} + P_1 A_1^{-1} R_1 r^{(k)} $$\n为了找到这一步的误差传播算子，我们分析误差的变换。新的误差为 $e^{(k+1/2)} = u - u^{(k+1/2)}$。\n$$ e^{(k+1/2)} = u - \\left(u^{(k)} + P_1 A_1^{-1} R_1 r^{(k)}\\right) $$\n代入 $u-u^{(k)} = e^{(k)}$ 和 $r^{(k)}=A e^{(k)}$：\n$$ e^{(k+1/2)} = (u - u^{(k)}) - P_1 A_1^{-1} R_1 (A e^{(k)}) $$\n$$ e^{(k+1/2)} = e^{(k)} - P_1 A_1^{-1} R_1 A e^{(k)} = (I - P_1 A_1^{-1} R_1 A) e^{(k)} $$\n我们将第一个半步的误差传播算子定义为 $E_1 = I - P_1 A_1^{-1} R_1 A$。\n\n**第二步：在子区域 $\\Omega_2$ 上的校正**\n\n接下来，我们从中间近似解 $u^{(k+1/2)}$ 开始，并对子区域 $\\Omega_2$ 应用类似的校正。此时的残差为 $r^{(k+1/2)} = b - A u^{(k+1/2)} = A e^{(k+1/2)}$。局部残差是 $r_2^{(k+1/2)} = R_2 r^{(k+1/2)}$，局部校正量为 $c_2 = A_2^{-1} r_2^{(k+1/2)}$。第 $k$ 次迭代的最终更新解为：\n$$ u^{(k+1)} = u^{(k+1/2)} + P_2 c_2 = u^{(k+1/2)} + P_2 A_2^{-1} R_2 r^{(k+1/2)} $$\n相应的误差变换为：\n$$ e^{(k+1)} = u - u^{(k+1)} = u - \\left(u^{(k+1/2)} + P_2 A_2^{-1} R_2 r^{(k+1/2)}\\right) $$\n代入 $u-u^{(k+1/2)} = e^{(k+1/2)}$ 和 $r^{(k+1/2)}=A e^{(k+1/2)}$：\n$$ e^{(k+1)} = e^{(k+1/2)} - P_2 A_2^{-1} R_2 A e^{(k+1/2)} = (I - P_2 A_2^{-1} R_2 A) e^{(k+1/2)} $$\n我们将第二个半步的误差传播算子定义为 $E_2 = I - P_2 A_2^{-1} R_2 A$。\n\n**第三步：组合算子**\n\n通过组合这两个步骤，我们得到一次完整迭代的总误差传播：\n$$ e^{(k+1)} = E_2 e^{(k+1/2)} = E_2 (E_1 e^{(k)}) = (E_2 E_1) e^{(k)} $$\n因此，乘性 Schwarz 方法的单步误差传播算子为 $E = E_2 E_1$，即：\n$$ E = (I - P_2 A_2^{-1} R_2 A) (I - P_1 A_1^{-1} R_1 A) $$\n推导至此完成。\n\n**第二部分：针对给定问题的计算**\n\n全局刚度矩阵为 $A \\in \\mathbb{R}^{5 \\times 5}$：\n$$ A = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} $$\n子区域为 $\\Omega_1=\\{1,2,3\\}$ 和 $\\Omega_2=\\{3,4,5\\}$。限制算子 $R_1, R_2$ 和延拓算子 $P_1=R_1^\\top, P_2=R_2^\\top$ 分别为：\n$$ R_1 = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  1  0  0  0 \\\\ 0  0  1  0  0 \\end{pmatrix}, \\quad P_1 = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ R_2 = \\begin{pmatrix} 0  0  1  0  0 \\\\ 0  0  0  1  0 \\\\ 0  0  0  0  1 \\end{pmatrix}, \\quad P_2 = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n局部算子 $A_i = R_i A P_i$ 是 $A$ 的主子矩阵：\n$$ A_1 = R_1 A P_1 = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}, \\quad A_2 = R_2 A P_2 = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix} $$\n需要求这个 $3 \\times 3$ 矩阵的逆。设 $B = A_1=A_2$。其行列式为 $\\det(B) = 2(4-1) - (-1)(-2) = 4$。\n$$ B^{-1} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} $$\n所以，$A_1^{-1} = A_2^{-1} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix}$。\n\n现在，我们构建 $E_1 = I - P_1 A_1^{-1} R_1 A$。\n$$ R_1 A = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\end{pmatrix} $$\n$$ A_1^{-1} (R_1 A) = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4  0  0  -1  0 \\\\ 0  4  0  -2  0 \\\\ 0  0  4  -3  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0  -1/4  0 \\\\ 0  1  0  -1/2  0 \\\\ 0  0  1  -3/4  0 \\end{pmatrix} $$\n$$ P_1 (A_1^{-1} R_1 A) = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0  -1/4  0 \\\\ 0  1  0  -1/2  0 \\\\ 0  0  1  -3/4  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0  -1/4  0 \\\\ 0  1  0  -1/2  0 \\\\ 0  0  1  -3/4  0 \\\\ 0  0  0  0  0 \\\\ 0  0  0  0  0 \\end{pmatrix} $$\n$$ E_1 = I - P_1 A_1^{-1} R_1 A = \\begin{pmatrix} 0  0  0  1/4  0 \\\\ 0  0  0  1/2  0 \\\\ 0  0  0  3/4  0 \\\\ 0  0  0  1  0 \\\\ 0  0  0  0  1 \\end{pmatrix} $$\n接着，我们构建 $E_2 = I - P_2 A_2^{-1} R_2 A$。\n$$ R_2 A = \\begin{pmatrix} 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} $$\n$$ A_2^{-1} (R_2 A) = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0  -3  4  0  0 \\\\ 0  -2  0  4  0 \\\\ 0  -1  0  0  4 \\end{pmatrix} = \\begin{pmatrix} 0  -3/4  1  0  0 \\\\ 0  -1/2  0  1  0 \\\\ 0  -1/4  0  0  1 \\end{pmatrix} $$\n$$ P_2 (A_2^{-1} R_2 A) = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0  -3/4  1  0  0 \\\\ 0  -1/2  0  1  0 \\\\ 0  -1/4  0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0  0 \\\\ 0  0  0  0  0 \\\\ 0  -3/4  1  0  0 \\\\ 0  -1/2  0  1  0 \\\\ 0  -1/4  0  0  1 \\end{pmatrix} $$\n$$ E_2 = I - P_2 A_2^{-1} R_2 A = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  1  0  0  0 \\\\ 0  3/4  0  0  0 \\\\ 0  1/2  0  0  0 \\\\ 0  1/4  0  0  0 \\end{pmatrix} $$\n现在我们计算最终的迭代矩阵 $E = E_2 E_1$：\n$$ E = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  1  0  0  0 \\\\ 0  3/4  0  0  0 \\\\ 0  1/2  0  0  0 \\\\ 0  1/4  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  0  0  1/4  0 \\\\ 0  0  0  1/2  0 \\\\ 0  0  0  3/4  0 \\\\ 0  0  0  1  0 \\\\ 0  0  0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  1/4  0 \\\\ 0  0  0  1/2  0 \\\\ 0  0  0  (3/4)(1/2)  0 \\\\ 0  0  0  (1/2)(1/2)  0 \\\\ 0  0  0  (1/4)(1/2)  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  1/4  0 \\\\ 0  0  0  1/2  0 \\\\ 0  0  0  3/8  0 \\\\ 0  0  0  1/4  0 \\\\ 0  0  0  1/8  0 \\end{pmatrix} $$\n最后，我们计算谱半径 $\\rho(E)$，即 $E$ 的特征值的最大绝对值。特征值 $\\lambda$ 是特征方程 $\\det(E - \\lambda I) = 0$ 的根。\n$$ E - \\lambda I = \\begin{pmatrix} -\\lambda  0  0  1/4  0 \\\\ 0  -\\lambda  0  1/2  0 \\\\ 0  0  -\\lambda  3/8  0 \\\\ 0  0  0  1/4-\\lambda  0 \\\\ 0  0  0  1/8  -\\lambda \\end{pmatrix} $$\n这是一个上三角矩阵。其行列式是对角线元素的乘积：\n$$ \\det(E - \\lambda I) = (-\\lambda)(-\\lambda)(-\\lambda)(1/4 - \\lambda)(-\\lambda) = \\lambda^4 (1/4 - \\lambda) $$\n特征方程 $\\lambda^4 (1/4 - \\lambda)=0$ 的根是 $\\lambda_1=\\lambda_2=\\lambda_3=\\lambda_4=0$ 和 $\\lambda_5 = 1/4$。\n$E$ 的特征值集合是 $\\sigma(E) = \\{0, 1/4\\}$。\n谱半径是这些特征值的最大模：\n$$ \\rho(E) = \\max_{\\lambda \\in \\sigma(E)} |\\lambda| = \\max\\{|0|, |1/4|\\} = 1/4 $$\n这就是迭代矩阵谱半径的精确值。",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        }
    ]
}