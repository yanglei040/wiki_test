{
    "hands_on_practices": [
        {
            "introduction": "在尝试求解一个线性系统之前，我们必须首先理解其基本代数属性。本练习将引导你通过一个具体的例子，深入研究鞍点矩阵的奇异性和零空间结构，这些性质由其子块的秩所决定。掌握这种结构分析对于确保问题是适定的，并为设计稳健的数值解法奠定基础至关重要 。",
            "id": "3566657",
            "problem": "考虑块鞍点矩阵 $$K=\\begin{pmatrix}A  B^{\\top} \\\\ B  -C\\end{pmatrix},$$ 其中 $A\\in\\mathbb{R}^{n\\times n}$ 是对称正定 (SPD) 矩阵，$B\\in\\mathbb{R}^{m\\times n}$，且 $C\\in\\mathbb{R}^{m\\times m}$ 是对称半正定矩阵。在许多鞍点系统的预处理策略中，块对角和块三角预条件子会使用舒尔补，其行为受到 $B$ 的秩性质和 $C$ 的定性的强烈影响。从耦合线性系统定义以及零空间和秩的标准性质出发，在 $A=I_n$ 和 $C=0_{m\\times m}$ 的特殊情况下，分析 $K$ 的奇异性和零空间结构。\n\n构造一个具体例子，其中 $n=4$, $m=3$, $$A=I_4,\\qquad C=0_{3\\times 3},\\qquad B=\\begin{pmatrix}1  0  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  0\\end{pmatrix}.$$ 仅使用零空间、秩的基本定义以及格拉姆矩阵 $B B^{\\top}$ 的性质，完成以下任务：\n- 从第一性原理推导系统 $$K\\begin{pmatrix}x \\\\ y\\end{pmatrix}=0,$$ 的核条件，其中 $x\\in\\mathbb{R}^{4}$ 且 $y\\in\\mathbb{R}^{3}$，并证明所得到的约束条件意味着 $K$ 是奇异的。\n- 用 $B$ 明确地刻画 $\\mathcal{N}(K)$，并计算 $\\mathcal{N}(K)$ 的一组基。\n- 报告给定 $A$、$B$ 和 $C$ 时零空间 $\\dim\\big(\\mathcal{N}(K)\\big)$ 的维数。\n\n将你的最终答案以等于 $\\dim\\big(\\mathcal{N}(K)\\big)$ 的单个实数值形式给出。无需四舍五入。",
            "solution": "该问题要求分析一个特定鞍点矩阵 $K$ 的零空间。验证过程确认了该问题是适定的、有科学依据的，并包含了所有必要信息。因此，我们可以开始求解。\n\n鞍点矩阵由下式给出\n$$K=\\begin{pmatrix}A  B^{\\top} \\\\ B  -C\\end{pmatrix}$$\n具体选择为 $A=I_n$, $C=0_{m\\times m}$, $n=4$, 且 $m=3$。因此矩阵 $K$ 为\n$$K = \\begin{pmatrix} I_4  B^{\\top} \\\\ B  0_{3\\times 3} \\end{pmatrix} \\in \\mathbb{R}^{7 \\times 7}$$\n其中 $I_4$ 是 $4 \\times 4$ 的单位矩阵，$0_{3 \\times 3}$ 是 $3 \\times 3$ 的零矩阵，并且\n$$B=\\begin{pmatrix}1  0  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  0\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 4}$$\n其转置为\n$$B^{\\top}=\\begin{pmatrix}1  1  0 \\\\ 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 3}$$\n\n我们需要刻画 $K$ 的零空间（或核），记为 $\\mathcal{N}(K)$。根据定义，一个向量 $z = \\begin{pmatrix}x \\\\ y\\end{pmatrix} \\in \\mathcal{N}(K)$，其中 $x \\in \\mathbb{R}^4$ 且 $y \\in \\mathbb{R}^3$，必须满足方程 $Kz=0$。\n\n**核条件的推导**\n\n将方程 $K\\begin{pmatrix}x \\\\ y\\end{pmatrix} = \\begin{pmatrix}0_4 \\\\ 0_3\\end{pmatrix}$ 写成块形式，我们得到一个包含两个线性方程的耦合系统：\n$$\n\\begin{align*}\nI_4 x + B^{\\top} y = 0_4 \\quad (1) \\\\\nB x - 0_{3\\times 3} y = 0_3 \\quad (2)\n\\end{align*}\n$$\n其中 $0_4$ 和 $0_3$ 分别是 $\\mathbb{R}^4$ 和 $\\mathbb{R}^3$ 中的零向量。\n\n由方程 (2)，我们直接得到约束条件：\n$$B x = 0_3$$\n这意味着向量 $x$ 必须属于 $B$ 的零空间，即 $x \\in \\mathcal{N}(B)$。\n\n由方程 (1)，我们可以用 $y$ 表示 $x$：\n$$x = -B^{\\top} y$$\n这表明 $x$ 必须位于 $B^{\\top}$ 的值域（列空间）中，即 $x \\in \\mathcal{R}(B^{\\top})$。\n\n因此，向量 $x$ 必须同时满足 $x \\in \\mathcal{N}(B)$ 和 $x \\in \\mathcal{R}(B^{\\top})$。在线性代数中，一个矩阵的零空间与其转置的值域是正交补。即 $\\mathcal{N}(B) = (\\mathcal{R}(B^{\\top}))^{\\perp}$。唯一一个同时属于一个子空间及其正交补的向量是零向量。因此，我们必须有：\n$$x = 0_4$$\n\n将 $x=0_4$ 代回方程 (1) 得到：\n$$I_4 (0_4) + B^{\\top} y = 0_4 \\implies B^{\\top} y = 0_4$$\n此条件意味着向量 $y$ 必须属于 $B^{\\top}$ 的零空间，即 $y \\in \\mathcal{N}(B^{\\top})$。\n将 $x=0_4$ 代入方程 (2) 得到 $B(0_4) = 0_3$，即 $0_3=0_3$。这是一个重言式，对 $y$ 没有提供进一步的约束。\n\n因此，$K$ 的零空间由所有满足 $x=0_4$ 和 $y \\in \\mathcal{N}(B^{\\top})$ 的向量 $\\begin{pmatrix}x \\\\ y\\end{pmatrix}$ 组成。我们可以将其写为：\n$$\\mathcal{N}(K) = \\left\\{ \\begin{pmatrix} 0_4 \\\\ y \\end{pmatrix} \\mid y \\in \\mathcal{N}(B^{\\top}) \\right\\}$$\n\n另一种推导方法，如问题所建议，使用格拉姆矩阵的性质，从将 (1) 中的 $x = -B^{\\top}y$ 代入 (2) 开始：\n$$B(-B^{\\top}y) = 0_3 \\implies -BB^{\\top}y = 0_3 \\implies BB^{\\top}y = 0_3$$\n这表示 $y \\in \\mathcal{N}(BB^{\\top})$。格拉姆矩阵 $BB^{\\top}$ 的一个基本性质是其零空间与 $B^{\\top}$ 的零空间相同，即 $\\mathcal{N}(BB^{\\top}) = \\mathcal{N}(B^{\\top})$。我们可以从第一性原理证明这一点。\n如果 $v \\in \\mathcal{N}(B^{\\top})$，则 $B^{\\top}v=0$，这意味着 $BB^{\\top}v = B(0) = 0$，所以 $v \\in \\mathcal{N}(BB^{\\top})$。\n反之，如果 $v \\in \\mathcal{N}(BB^{\\top})$，则 $BB^{\\top}v=0$。与 $v$ 作点积得到 $v^{\\top}BB^{\\top}v=0$。这可以写成 $(B^{\\top}v)^{\\top}(B^{\\top}v) = \\|B^{\\top}v\\|_2^2 = 0$。一个向量的范数为零当且仅当该向量本身为零，所以 $B^{\\top}v=0$。这意味着 $v \\in \\mathcal{N}(B^{\\top})$。\n因此，我们证明了 $\\mathcal{N}(BB^{\\top}) = \\mathcal{N}(B^{\\top})$。对 $y$ 的条件是 $y \\in \\mathcal{N}(B^{\\top})$。\n如果 $y \\in \\mathcal{N}(B^{\\top})$，则 $B^{\\top}y = 0_4$。将此代入方程 (1) 得到 $x = -B^{\\top}y = -0_4 = 0_4$。这证实了之前的结果。\n\n**K 的奇异性**\n\n矩阵 $K$ 是奇异的当且仅当其零空间 $\\mathcal{N}(K)$ 至少包含一个非零向量。这等价于证明 $\\mathcal{N}(B^{\\top})$ 至少包含一个非零向量，即 $\\dim(\\mathcal{N}(B^{\\top})) > 0$。\n根据秩-零度定理，$B^{\\top}$（一个 $\\mathbb{R}^{4 \\times 3}$ 矩阵）的零空间维数由下式给出：\n$$\\dim(\\mathcal{N}(B^{\\top})) = (\\text{$B^{\\top}$ 的列数}) - \\text{rank}(B^{\\top})$$\n$B^{\\top}$ 的列数为 $m=3$。$B^{\\top}$ 的秩等于 $B$ 的秩。矩阵 $B$ 有两个相同的非零行 $\\begin{pmatrix}1  0  0  0\\end{pmatrix}$ 和一个零行。行空间由单个向量张成，因此 $\\text{rank}(B)=1$。因此，$\\text{rank}(B^{\\top})=1$。\n所以，$\\dim(\\mathcal{N}(B^{\\top})) = 3 - 1 = 2$。\n由于 $\\dim(\\mathcal{N}(B^{\\top})) = 2 > 0$，存在非零向量 $y \\in \\mathcal{N}(B^{\\top})$。对于任何这样的非零 $y$，向量 $\\begin{pmatrix}0_4 \\\\ y\\end{pmatrix}$ 是 $\\mathcal{N}(K)$ 中的一个非零向量。因此，$K$ 是奇异的。\n\n**$\\mathcal{N}(K)$ 的基及其维数**\n\n我们已经证明了 $\\dim(\\mathcal{N}(K)) = \\dim(\\mathcal{N}(B^{\\top})) = 2$。为了找到 $\\mathcal{N}(K)$ 的一组基，我们首先找到 $\\mathcal{N}(B^{\\top})$ 的一组基。我们需要求解 $B^{\\top}y = 0_4$ 对于 $y = (y_1, y_2, y_3)^{\\top} \\in \\mathbb{R}^3$：\n$$\\begin{pmatrix}1  1  0 \\\\ 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n该矩阵方程可简化为单个标量方程：\n$$y_1 + y_2 = 0 \\implies y_1 = -y_2$$\n变量 $y_3$ 不受约束，因此它是一个自由变量。设 $y_2=c_1$ 和 $y_3=c_2$ 为任意实数参数。那么 $y_1 = -c_1$。$\\mathcal{N}(B^{\\top})$ 中的一个通用向量是：\n$$y = \\begin{pmatrix} -c_1 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = c_1 \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + c_2 \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$$\n$\\mathcal{N}(B^{\\top})$ 的一组基由对应于参数 $c_1$ 和 $c_2$ 的两个线性无关的向量构成：\n$$\\text{$\\mathcal{N}(B^{\\top})$ 的基} = \\left\\{ \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}$$\n使用 $\\mathcal{N}(K) = \\{ \\begin{pmatrix} 0_4 \\\\ y \\end{pmatrix} \\mid y \\in \\mathcal{N}(B^{\\top}) \\}$ 的刻画，我们可以通过用 $\\mathbb{R}^4$ 中的零向量填充这些基向量来构造 $\\mathcal{N}(K)$ 的一组基：\n$$\\text{$\\mathcal{N}(K)$ 的基} = \\left\\{ \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}$$\n该基由两个向量组成。因此，$K$ 的零空间的维数是 $2$。\n$$\\dim(\\mathcal{N}(K)) = 2$$\n这与秩-零度定理的结果相符。所要求的最终答案就是这个维数。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "舒尔补在鞍点问题的预处理中扮演着核心角色。本练习旨在对比两种主要的理想预处理策略：块对角预处理和块三角预处理。通过使用精确的舒尔补进行直接的解析比较，你将揭示它们在效果上的显著结构性差异，并理解为何其中一种结构能够产生完美的谱聚类 。",
            "id": "3566697",
            "problem": "考虑一个鞍点系统，其对称正定 (SPD) 块 $A \\in \\mathbb{R}^{2 \\times 2}$ 和行满秩约束块 $B \\in \\mathbb{R}^{1 \\times 2}$ 由下式给出\n$$\nA = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1  -2 \\end{pmatrix},\n$$\n以及 $3 \\times 3$ 的 KKT (Karush–Kuhn–Tucker) 矩阵\n$$\nK = \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix}.\n$$\n定义理想舒尔补 $S_{\\star} = B A^{-1} B^{\\top}$ 和两个预条件子：\n- 块对角预条件子\n$$\nM_{D} = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix},\n$$\n- 块三角预条件子\n$$\nM_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix}.\n$$\n从舒尔补、预处理和块矩阵运算的核心定义出发，首先计算给定 $A$ 和 $B$ 时预处理算子 $M_{D}^{-1} K$ 的谱（特征值的多重集）。然后，对块三角预条件子重复此计算，即计算相同 $A$ 和 $B$ 下 $M_{T}^{-1} K$ 的谱。通过解释任何聚集性差异的结构性原因，包括使用精确舒尔补和块分解性质的影响，来比较这两个谱。\n\n将 $M_{T}^{-1} K$ 的特征值以精确形式单行列表（包括重数）作为最终答案。无需四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- 对称正定 (SPD) 块 $A \\in \\mathbb{R}^{2 \\times 2}$ 为 $A = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。\n- 行满秩约束块 $B \\in \\mathbb{R}^{1 \\times 2}$ 为 $B = \\begin{pmatrix} 1  -2 \\end{pmatrix}$。\n- Karush–Kuhn–Tucker (KKT) 矩阵为 $K = \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix}$。\n- 理想舒尔补定义为 $S_{\\star} = B A^{-1} B^{\\top}$。\n- 块对角预条件子为 $M_{D} = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix}$。\n- 块三角预条件子为 $M_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix}$。\n- 任务是计算 $M_{D}^{-1} K$ 的谱，计算 $M_{T}^{-1} K$ 的谱，并对它们进行比较并给出结构性解释。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题源于数值线性代数，特别是鞍点系统的预处理。所有定义和矩阵在该领域都是标准的。\n2.  **适定性**：矩阵 $A$ 是对称的。其行列式为 $\\det(A) = (4)(3) - (1)(1) = 11 > 0$，且顺序主子式为 $4 > 0$，因此 $A$ 如所述是正定的。矩阵 $B$ 是一个非零行向量，因此它具有行满秩。这些条件确保了 KKT 矩阵 $K$ 是非奇异的，并且舒尔补 $S_{\\star}$ 是良定义且可逆的。该问题是自洽的，并指定了清晰的计算任务。\n3.  **客观性**：该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n### 第 3 步：结论与行动\n该问题是有效的。它是适定的、有科学依据的、客观的。将提供完整的解答。\n\n### 解答\n\n解答过程首先计算必要的组成部分，然后分析每个预处理系统，最后提供结构性比较。\n\n**1. 预备计算**\n\n首先，我们计算矩阵 $A$ 的逆：\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}\n$$\n接着，我们计算 $B$ 的转置：\n$$\nB^{\\top} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n$$\n现在，我们可以计算理想舒尔补 $S_{\\star} = B A^{-1} B^{\\top}$。由于 $B$ 是一个 $1 \\times 2$ 矩阵，$S_{\\star}$ 将是一个 $1 \\times 1$ 矩阵（一个标量）。\n$$\nS_{\\star} = \\begin{pmatrix} 1  -2 \\end{pmatrix} \\left( \\frac{1}{11} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n$$\n$$\nS_{\\star} = \\frac{1}{11} \\begin{pmatrix} 1  -2 \\end{pmatrix} \\begin{pmatrix} 3(1) + (-1)(-2) \\\\ -1(1) + 4(-2) \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 1  -2 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ -9 \\end{pmatrix}\n$$\n$$\nS_{\\star} = \\frac{1}{11} \\left( 1(5) + (-2)(-9) \\right) = \\frac{1}{11} (5 + 18) = \\frac{23}{11}\n$$\n\n**2. 块对角预处理系统 $M_{D}^{-1} K$ 的谱**\n\n块对角预条件子为 $M_{D} = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix}$。其逆矩阵为 $M_{D}^{-1} = \\begin{pmatrix} A^{-1}  0 \\\\ 0  S_{\\star}^{-1} \\end{pmatrix}$。\n预处理后的矩阵是：\n$$\nM_{D}^{-1} K = \\begin{pmatrix} A^{-1}  0 \\\\ 0  S_{\\star}^{-1} \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix} = \\begin{pmatrix} A^{-1}A  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B  0 \\end{pmatrix} = \\begin{pmatrix} I  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B  0 \\end{pmatrix}\n$$\n为了找到特征值 $\\lambda$，我们求解特征方程 $\\det(M_{D}^{-1} K - \\lambda I) = 0$。\n特征多项式由 $\\det \\begin{pmatrix} (1-\\lambda)I  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B  -\\lambda I_p \\end{pmatrix} = 0$ 给出，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$I_p$ 是 $1 \\times 1$ 单位矩阵。\n使用块矩阵的行列式公式，对于 $\\lambda \\neq 1$：\n$$\n\\det((1-\\lambda)I) \\det(-\\lambda I_p - (S_{\\star}^{-1}B) ((1-\\lambda)I)^{-1} (A^{-1}B^{\\top})) = 0\n$$\n$$\n(1-\\lambda)^{2} \\det(-\\lambda - \\frac{1}{1-\\lambda} S_{\\star}^{-1} (B A^{-1} B^{\\top})) = 0\n$$\n$$\n(1-\\lambda)^{2} (-\\lambda - \\frac{1}{1-\\lambda} S_{\\star}^{-1} S_{\\star}) = 0\n$$\n$$\n(1-\\lambda)^{2} (-\\lambda - \\frac{1}{1-\\lambda}) = 0\n$$\n乘以 $(1-\\lambda)$，我们得到 $(1-\\lambda) [-\\lambda(1-\\lambda) - 1] = 0$。这对 $\\lambda \\neq 1$ 成立。如果 $\\lambda=1$ 是一个根，我们必须单独检查。在此公式中，我们发现：\n$$\n(1-\\lambda) (\\lambda^2 - \\lambda - 1) = 0\n$$\n这个方程给出了三个不同的特征值：\n- $\\lambda_1 = 1$\n- $\\lambda^2 - \\lambda - 1 = 0$ 的根，根据二次方程求根公式为 $\\lambda = \\frac{1 \\pm \\sqrt{1 - 4(1)(-1)}}{2} = \\frac{1 \\pm \\sqrt{5}}{2}$。\n所以，$\\lambda_2 = \\frac{1+\\sqrt{5}}{2}$ 且 $\\lambda_3 = \\frac{1-\\sqrt{5}}{2}$。\n$M_{D}^{-1} K$ 的谱为 $\\left\\{ 1, \\frac{1+\\sqrt{5}}{2}, \\frac{1-\\sqrt{5}}{2} \\right\\}$。\n\n**3. 块三角预处理系统 $M_{T}^{-1} K$ 的谱**\n\n块三角预条件子为 $M_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix}$。为了求其逆矩阵 $M_{T}^{-1} = \\begin{pmatrix} X  Y \\\\ Z  W \\end{pmatrix}$，我们求解 $M_{T} M_{T}^{-1} = I$：\n$$\n\\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix} \\begin{pmatrix} X  Y \\\\ Z  W \\end{pmatrix} = \\begin{pmatrix} AX  AY \\\\ BX-S_{\\star}Z  BY-S_{\\star}W \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ 0  I \\end{pmatrix}\n$$\n这得到 $AX=I \\implies X=A^{-1}$；$AY=0 \\implies Y=0$；$-S_{\\star}W=I \\implies W=-S_{\\star}^{-1}$；以及 $BX-S_{\\star}Z=0 \\implies Z=S_{\\star}^{-1}BX=S_{\\star}^{-1}BA^{-1}$。\n所以，$M_{T}^{-1} = \\begin{pmatrix} A^{-1}  0 \\\\ S_{\\star}^{-1}BA^{-1}  -S_{\\star}^{-1} \\end{pmatrix}$。\n预处理后的矩阵是：\n$$\nM_{T}^{-1} K = \\begin{pmatrix} A^{-1}  0 \\\\ S_{\\star}^{-1}BA^{-1}  -S_{\\star}^{-1} \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix}\n$$\n$$\nM_{T}^{-1} K = \\begin{pmatrix} A^{-1}A  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}BA^{-1}A - S_{\\star}^{-1}B  S_{\\star}^{-1}BA^{-1}B^{\\top} \\end{pmatrix} = \\begin{pmatrix} I  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B - S_{\\star}^{-1}B  S_{\\star}^{-1}S_{\\star} \\end{pmatrix}\n$$\n$$\nM_{T}^{-1} K = \\begin{pmatrix} I  A^{-1}B^{\\top} \\\\ 0  1 \\end{pmatrix}\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵，1 是标量 1。这是一个块上三角矩阵。块三角矩阵的特征值是其对角块的特征值。\n- 左上角块 $I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$ 的特征值是 1 和 1。\n- 右下角块，即标量 1，的特征值是 1。\n因此，$M_{T}^{-1} K$ 的谱为 $\\{1, 1, 1\\}$。\n\n**4. 比较与结构性解释**\n\n$M_{D}^{-1} K$ 的谱为 $\\left\\{ 1, \\frac{1+\\sqrt{5}}{2}, \\frac{1-\\sqrt{5}}{2} \\right\\}$，而 $M_{T}^{-1} K$ 的谱为 $\\{1, 1, 1\\}$。这一差异是显著的，源于预条件子的结构特性。\n\nKKT 矩阵 $K$ 具有一个类块 LU 分解：\n$$\nK = \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix} \\begin{pmatrix} I  A^{-1} B^{\\top} \\\\ 0  I \\end{pmatrix}\n$$\n块三角预条件子 $M_T$ 定义为：\n$$\nM_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix}\n$$\n$M_T$ 被构造成恰好是 $K$ 的分解式中的前两个矩阵的乘积。因此，当我们构建预处理算子 $M_T^{-1} K$ 时，这两个因子会完全抵消：\n$$\nM_{T}^{-1} K = \\left( \\left( \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix} \\right)^{-1} \\right) \\left( \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix} \\begin{pmatrix} I  A^{-1} B^{\\top} \\\\ 0  I \\end{pmatrix} \\right) = \\begin{pmatrix} I  A^{-1} B^{\\top} \\\\ 0  I \\end{pmatrix}\n$$\n结果是一个主对角线上为 1、左下角为零块的矩阵。这样的矩阵是幺幂的，其所有特征值都为 1。这就是为什么 $M_{T}^{-1} K$ 的谱完全聚集在 1。在实践中，使用精确舒尔补使得 $M_T$ 成为一个理想的预条件子，能让像 GMRES 这样的迭代方法在可预测的少量迭代次数内收敛。\n\n块对角预条件子 $M_D = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix}$ 没有完全捕捉到 $K$ 的分解结构。它正确地预处理了对角块 $A$，但它对 $(2,2)$ 块 $S_{\\star}$ 的处理与分解项 $-S_{\\star}$ 的符号不同，更重要的是，它忽略了 L 和 U 因子（由 $B$ 和 $B^{\\top}$ 代表）中固有的非对角耦合。由此产生的预处理算子 $M_{D}^{-1} K$ 不是三角矩阵，其特征值通常不为 1。在使用精确 $A$ 和精确 $S_{\\star}$ 的情况下，一个已知的理论结果是，特征值总是 1（重数等于 $A$ 的大小减去 $B$ 的秩）以及 $\\lambda^2 - \\lambda - 1 = 0$ 的根（每个根的重数等于 $B$ 的秩）。我们的计算证实了这一普适理论在秩为 1 约束的特定 $2 \\times 2$ 情形下成立。\n\n总之，$M_T$ 是一个结构上更优越的预条件子，因为它基于 $K$ 的块分解，从而得到一个理想的谱。$M_D$ 的构造更简单，但效果较差，因为它忽略了非对角块结构，导致谱的聚集性较差。",
            "answer": "$$\n\\boxed{1, 1, 1}\n$$"
        },
        {
            "introduction": "理论上的理想预处理为我们提供了深刻的见解，但在实际应用中，我们通常依赖于对舒尔补的高效近似。这个动手编程练习将理论与实践相结合，要求你为一个混合泊松问题实现并比较几种常见的舒尔补近似。通过分析预处理后系统的特征值谱，你将能够量化不同预处理器的性能，并直观地看到谱聚类对迭代求解的重要性 。",
            "id": "3566630",
            "problem": "设计并实现一个完整的、可运行的程序，该程序使用最低阶混合方法，在均匀的 $2\\times 2$ 笛卡尔网格上构建泊松方程（Poisson equation）的离散混合格式。其中，通量未知量位于内部边上，压力位于单元中心。您的目标是组装一个对称鞍点矩阵，定义三个块对角预条件子，并计算对称预处理算子的特征值，以说明谱聚类现象。\n\n从以下基本原理开始：\n- 泊松方程的混合格式引入了通量变量 $\\boldsymbol{q}$ 和标量压力 $u$，满足 $ \\boldsymbol{q} + \\nabla u = \\boldsymbol{0}$ 和 $ \\nabla \\cdot \\boldsymbol{q} = g$。离散化后，得到如下形式的对称鞍点系统：\n$$\n\\begin{bmatrix}\n\\boldsymbol{M}  \\boldsymbol{B}^{\\top} \\\\\n\\boldsymbol{B}  \\boldsymbol{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\boldsymbol{q} \\\\\n\\boldsymbol{u}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\boldsymbol{f} \\\\\n\\boldsymbol{g}\n\\end{bmatrix},\n$$\n其中 $\\boldsymbol{M}$ 是一个对称正定（SPD）的通量质量矩阵，$\\boldsymbol{B}$ 是一个离散散度算子。\n- 预处理使用一个块对角SPD矩阵 $\\boldsymbol{P} = \\operatorname{diag}(\\boldsymbol{M}, \\boldsymbol{S}_{\\text{approx}})$，其中 $\\boldsymbol{S}_{\\text{approx}}$ 是对舒尔补（Schur complement） $\\boldsymbol{S} = \\boldsymbol{B}\\,\\boldsymbol{M}^{-1}\\boldsymbol{B}^{\\top}$ 的一个SPD近似。\n\n在单位正方形上使用一个包含 $2\\times 2$ 个单元的均匀网格。仅将内部边上的通量视为未知量（边界边上的法向通量为零），并通过移除一个单元压力自由度来施加零均值压力约束，以消除零空间。将四个单元索引为 $c_0$（左下）、$c_1$（右下）、$c_2$（左上）和 $c_3$（右上）。按如下方式索引四个内部边：\n- $e_0$：$c_0$ 和 $c_1$ 之间的垂直边，正方向从 $c_0$ 指向 $c_1$，\n- $e_1$：$c_2$ 和 $c_3$ 之间的垂直边，正方向从 $c_2$ 指向 $c_3$，\n- $e_2$：$c_0$ 和 $c_2$ 之间的水平边，正方向从 $c_0$ 指向 $c_2$，\n- $e_3$：$c_1$ 和 $c_3$ 之间的水平边，正方向从 $c_1$ 指向 $c_3$。\n\n令通量质量矩阵为 $\\boldsymbol{M}=\\boldsymbol{I}_{4}$（4条内部边上的单位矩阵）。通过移除对应于 $c_3$ 的方程来构造离散散度矩阵 $\\boldsymbol{B}\\in\\mathbb{R}^{3\\times 4}$ 以施加零均值约束，其列对应于边 $(e_0,e_1,e_2,e_3)$，行对应于单元 $(c_0,c_1,c_2)$：\n- 对于 $e_0$（在 $c_0$ 和 $c_1$ 之间）：在 $c_0$ 的行中置 $+1$，在 $c_1$ 的行中置 $-1$，\n- 对于 $e_1$（在 $c_2$ 和 $c_3$ 之间）：在 $c_2$ 的行中置 $+1$，\n- 对于 $e_2$（在 $c_0$ 和 $c_2$ 之间）：在 $c_0$ 的行中置 $+1$，在 $c_2$ 的行中置 $-1$，\n- 对于 $e_3$（在 $c_1$ 和 $c_3$ 之间）：在 $c_1$ 的行中置 $+1$。\n\n组装鞍点矩阵\n$$\n\\boldsymbol{K}=\n\\begin{bmatrix}\n\\boldsymbol{M}  \\boldsymbol{B}^{\\top} \\\\\n\\boldsymbol{B}  \\boldsymbol{0}\n\\end{bmatrix}\n\\in \\mathbb{R}^{7\\times 7}.\n$$\n\n定义三个块对角SPD预条件子\n$$\n\\boldsymbol{P}=\\operatorname{diag}(\\boldsymbol{M},\\boldsymbol{S}_{\\text{approx}}),\n$$\n对应于以下舒尔补近似 $\\boldsymbol{S}_{\\text{approx}}$ 的测试套件：\n- 测试1：精确舒尔补 $\\boldsymbol{S}=\\boldsymbol{B}\\,\\boldsymbol{M}^{-1}\\boldsymbol{B}^{\\top}$，\n- 测试2：Jacobi 近似 $\\boldsymbol{S}_{\\text{diag}}=\\operatorname{diag}(\\boldsymbol{S})$，\n- 测试3：压力质量近似 $\\boldsymbol{S}_{\\text{mass}}=(h^2)\\,\\boldsymbol{I}_{3}$，其中单元宽度 $h=1/2$，因此 $\\boldsymbol{S}_{\\text{mass}}=\\frac{1}{4}\\,\\boldsymbol{I}_{3}$。\n\n对于每个测试，计算对称预处理算子的实特征值\n$$\n\\boldsymbol{C} = \\boldsymbol{P}^{-1/2}\\,\\boldsymbol{K}\\,\\boldsymbol{P}^{-1/2},\n$$\n其中 $\\boldsymbol{P}$ 的对称平方根和逆平方根是分块计算的，压力块使用谱分解。将特征值按升序排序。\n\n您的程序必须实现上述构造，执行三个测试，并输出特征值列表（作为浮点数）。无需报告物理单位。不使用角度。不使用百分比。\n\n测试套件：\n- 输入是隐式的；构造并评估与上面定义的测试标识符 $1,2,3$ 相对应的三种情况。\n\n预期输出类型和格式：\n- 对于每个测试用例，生成一个排序后的特征值列表，作为浮点数列表。\n- 将三个列表聚合到单行输出中，形式为类似JSON的嵌套列表，不含空格，例如 $[ [\\cdot],[\\cdot],[\\cdot] ]$ 但逗号后没有空格。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个特征值格式化为浮点数（例如，$-1.00000000$）。确切地说：程序必须打印形如 $[[\\text{vals\\_for\\_test\\_1}],[\\text{vals\\_for\\_test\\_2}],[\\text{vals\\_for\\_test\\_3}]]$ 的单行，不含额外文本。",
            "solution": "该问题是有效的。它提出了一个明确定义的数值线性代数任务，其基础是混合有限元方法产生的鞍点系统预处理的既定理论。所有必要的数据和定义都已提供，问题是自洽、一致且科学合理的。\n\n目标是分析从 $2 \\times 2$ 网格上泊松方程（Poisson equation）的混合离散化派生出的鞍点系统的谱特性。该分析通过在应用三个不同的对称块对角预条件子后计算系统特征值来进行。\n\n首先，我们构造离散鞍点系统的矩阵：\n$$\n\\boldsymbol{K}\\begin{bmatrix} \\boldsymbol{q} \\\\ \\boldsymbol{u} \\end{bmatrix} = \\begin{bmatrix} \\boldsymbol{M}  \\boldsymbol{B}^{\\top} \\\\ \\boldsymbol{B}  \\boldsymbol{0} \\end{bmatrix} \\begin{bmatrix} \\boldsymbol{q} \\\\ \\boldsymbol{u} \\end{bmatrix} = \\begin{bmatrix} \\boldsymbol{f} \\\\ \\boldsymbol{g} \\end{bmatrix}\n$$\n通量自由度 $\\boldsymbol{q} \\in \\mathbb{R}^4$ 对应于4条内部边，压力自由度 $\\boldsymbol{u} \\in \\mathbb{R}^3$ 对应于单元 $c_0, c_1, c_2$ 中的压力，单元 $c_3$ 中的压力已被消除以施加零均值约束。\n\n通量质量矩阵 $\\boldsymbol{M}$ 被指定为 $4 \\times 4$ 单位矩阵，$\\boldsymbol{M} = \\boldsymbol{I}_4$。\n\n离散散度算子 $\\boldsymbol{B} \\in \\mathbb{R}^{3 \\times 4}$ 将边 $(e_0, e_1, e_2, e_3)$ 上的通量映射到单元 $(c_0, c_1, c_2)$ 中心的散度。根据指定的方向和连接性：\n- 边 $e_0$（从 $c_0$ 到 $c_1$）：对单元 $c_0$ 贡献 $+1$，对单元 $c_1$ 贡献 $-1$。\n- 边 $e_1$（从 $c_2$ 到 $c_3$）：对单元 $c_2$ 贡献 $+1$（对 $c_3$ 的贡献被省略）。\n- 边 $e_2$（从 $c_0$ 到 $c_2$）：对单元 $c_0$ 贡献 $+1$，对单元 $c_2$ 贡献 $-1$。\n- 边 $e_3$（从 $c_1$ 到 $c_3$）：对单元 $c_1$ 贡献 $+1$（对 $c_3$ 的贡献被省略）。\n这得到了以下矩阵：\n$$\n\\boldsymbol{B} = \\begin{bmatrix}\n1  0  1  0 \\\\\n-1  0  0  1 \\\\\n0  1  -1  0\n\\end{bmatrix}\n$$\n完整的 $7 \\times 7$ 鞍点矩阵 $\\boldsymbol{K}$ 则是：\n$$\n\\boldsymbol{K} =\n\\begin{bmatrix}\n\\boldsymbol{I}_4  \\boldsymbol{B}^{\\top} \\\\\n\\boldsymbol{B}  \\boldsymbol{0}_{3\\times3}\n\\end{bmatrix}\n=\n\\left[\n\\begin{array}{cccc|ccc}\n1  0  0  0  1  -1  0 \\\\\n0  1  0  0  0  0  1 \\\\\n0  0  1  0  1  0  -1 \\\\\n0  0  0  1  0  1  0 \\\\\n\\hline\n1  0  1  0  0  0  0 \\\\\n-1  0  0  1  0  0  0 \\\\\n0  1  -1  0  0  0  0\n\\end{array}\n\\right]\n$$\n我们分析对称预处理算子 $\\boldsymbol{C} = \\boldsymbol{P}^{-1/2} \\boldsymbol{K} \\boldsymbol{P}^{-1/2}$ 的特征值，其中 $\\boldsymbol{P} = \\operatorname{diag}(\\boldsymbol{M}, \\boldsymbol{S}_{\\text{approx}})$ 是块对角预条件子。给定 $\\boldsymbol{M} = \\boldsymbol{I}_4$，预条件子为 $\\boldsymbol{P} = \\operatorname{diag}(\\boldsymbol{I}_4, \\boldsymbol{S}_{\\text{approx}})$，其逆平方根为 $\\boldsymbol{P}^{-1/2} = \\operatorname{diag}(\\boldsymbol{I}_4, \\boldsymbol{S}_{\\text{approx}}^{-1/2})$。预处理后的矩阵简化为：\n$$\n\\boldsymbol{C} = \\begin{bmatrix} \\boldsymbol{I}_4  \\boldsymbol{B}^{\\top} \\boldsymbol{S}_{\\text{approx}}^{-1/2} \\\\ \\boldsymbol{S}_{\\text{approx}}^{-1/2} \\boldsymbol{B}  \\boldsymbol{0}_{3\\times3} \\end{bmatrix}\n$$\n这是一个对称矩阵，因此其特征值为实数。我们针对 $\\boldsymbol{S}_{\\text{approx}}$ 的三种选择计算这些特征值。\n\n测试1：精确舒尔补（Schur complement）预条件子。\n这里，$\\boldsymbol{S}_{\\text{approx}} = \\boldsymbol{S} = \\boldsymbol{B}\\boldsymbol{M}^{-1}\\boldsymbol{B}^{\\top} = \\boldsymbol{B}\\boldsymbol{B}^{\\top}$。\n$$\n\\boldsymbol{S} = \\begin{bmatrix}\n1  0  1  0 \\\\\n-1  0  0  1 \\\\\n0  1  -1  0\n\\end{bmatrix}\n\\begin{bmatrix}\n1  -1  0 \\\\\n0  0  1 \\\\\n1  0  -1 \\\\\n0  1  0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2  -1  -1 \\\\\n-1  2  0 \\\\\n-1  0  2\n\\end{bmatrix}\n$$\n逆平方根 $\\boldsymbol{S}^{-1/2}$ 通过谱分解计算：$\\boldsymbol{S} = \\boldsymbol{V}\\boldsymbol{\\Lambda}\\boldsymbol{V}^{\\top}$，因此 $\\boldsymbol{S}^{-1/2} = \\boldsymbol{V}\\boldsymbol{\\Lambda}^{-1/2}\\boldsymbol{V}^{\\top}$。理论上已知，所得矩阵 $\\boldsymbol{C}_1$ 的特征值为 $1$（重数为 $4-3=1$）和 $\\frac{1 \\pm \\sqrt{5}}{2}$（每个重数为 $3$）。\n\n测试2：Jacobi 预条件子。\n该近似为精确舒尔补的对角部分：$\\boldsymbol{S}_{\\text{approx}} = \\boldsymbol{S}_{\\text{diag}} = \\operatorname{diag}(\\boldsymbol{S})$。\n$$\n\\boldsymbol{S}_{\\text{diag}} = \\operatorname{diag}(2, 2, 2) = 2\\boldsymbol{I}_3\n$$\n其逆平方根为 $\\boldsymbol{S}_{\\text{diag}}^{-1/2} = (2\\boldsymbol{I}_3)^{-1/2} = \\frac{1}{\\sqrt{2}}\\boldsymbol{I}_3$。然后构造矩阵 $\\boldsymbol{C}_2$，并数值计算其特征值。\n\n测试3：压力质量矩阵预条件子。\n该近似为 $\\boldsymbol{S}_{\\text{approx}} = \\boldsymbol{S}_{\\text{mass}} = h^2 \\boldsymbol{I}_3$。当单元宽度 $h = 1/2$ 时，这变为 $\\boldsymbol{S}_{\\text{mass}} = \\frac{1}{4}\\boldsymbol{I}_3$。\n其逆平方根为 $\\boldsymbol{S}_{\\text{mass}}^{-1/2} = (\\frac{1}{4}\\boldsymbol{I}_3)^{-1/2} = 2\\boldsymbol{I}_3$。然后构造矩阵 $\\boldsymbol{C}_3$，并计算其特征值。\n\n对于这三种情况中的每一种，计算相应矩阵 $\\boldsymbol{C}$ 的七个实特征值，并按升序排序。然后将这些特征值列表作为最终结果报告。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Constructs a saddle-point system for a mixed-FEM discretization of the\n    Poisson equation on a 2x2 grid, applies three different block-diagonal\n    preconditioners, and computes the eigenvalues of the preconditioned systems.\n    \"\"\"\n    \n    # Define the flux mass matrix M (4x4 identity) and the discrete divergence B (3x4).\n    # M is for 4 interior edge fluxes.\n    # B maps fluxes to divergences in cells c0, c1, c2.\n    M = np.eye(4)\n    B = np.array([\n        [1.0, 0.0, 1.0, 0.0],   # Divergence in cell c0\n        [-1.0, 0.0, 0.0, 1.0],  # Divergence in cell c1\n        [0.0, 1.0, -1.0, 0.0]   # Divergence in cell c2\n    ])\n\n    test_cases_defs = []\n\n    # Test 1: Exact Schur complement preconditioner\n    # S_approx = S = B * M^-1 * B.T. Since M=I, S = B * B.T\n    S = B @ B.T\n    # Calculate S_approx^{-1/2} using spectral decomposition (eigh)\n    w_s, v_s = linalg.eigh(S)\n    if np.any(w_s == 0):\n        # This should not happen for a valid problem setup\n        raise ValueError(\"Schur complement S is not positive definite.\")\n    S_inv_sqrt_1 = v_s @ np.diag(1.0 / np.sqrt(w_s)) @ v_s.T\n    test_cases_defs.append(S_inv_sqrt_1)\n\n    # Test 2: Jacobi preconditioner\n    # S_approx = diag(S)\n    S_diag = np.diag(np.diag(S))\n    # S_diag is diagonal, so its inverse square root is easy to compute\n    S_inv_sqrt_2 = np.diag(1.0 / np.sqrt(np.diag(S_diag)))\n    test_cases_defs.append(S_inv_sqrt_2)\n\n    # Test 3: Pressure mass matrix preconditioner\n    # S_approx = h^2 * I, with h=1/2.\n    h = 0.5\n    S_mass = (h**2) * np.eye(3)\n    # S_mass is a multiple of identity, inverse square root is scalar operation.\n    S_inv_sqrt_3 = (1.0 / h) * np.eye(3)\n    test_cases_defs.append(S_inv_sqrt_3)\n\n    results = []\n    num_flux_dofs = M.shape[0]\n    num_pressure_dofs = B.shape[0]\n    total_dofs = num_flux_dofs + num_pressure_dofs\n\n    for S_approx_inv_sqrt in test_cases_defs:\n        # Construct the symmetrically preconditioned matrix C\n        # C = [ I,            B.T @ S_approx^{-1/2} ]\n        #     [ S_approx^{-1/2} @ B,  0          ]\n        # Since M=I, the (1,1) block is M^{-1/2} @ M @ M^{-1/2} = I\n        C = np.zeros((total_dofs, total_dofs))\n        \n        # Top-left block (flux-flux)\n        C[0:num_flux_dofs, 0:num_flux_dofs] = np.eye(num_flux_dofs)\n        \n        # Top-right block (flux-pressure)\n        C[0:num_flux_dofs, num_flux_dofs:total_dofs] = B.T @ S_approx_inv_sqrt\n        \n        # Bottom-left block (pressure-flux)\n        C[num_flux_dofs:total_dofs, 0:num_flux_dofs] = S_approx_inv_sqrt @ B\n        \n        # Bottom-right block is zero.\n\n        # C is symmetric, so use eigh for efficiency and guaranteed real eigenvalues.\n        # linalg.eigh returns eigenvalues in ascending order.\n        eigenvalues = linalg.eigvalsh(C)\n        results.append(eigenvalues.tolist())\n\n    # Format the final output string as a JSON-like nested list with no spaces.\n    results_str = []\n    for eig_list in results:\n        formatted_eigs = [f\"{eig:.8f}\" for eig in eig_list]\n        results_str.append(\"[\" + \",\".join(formatted_eigs) + \"]\")\n    final_output = \"[\" + \",\".join(results_str) + \"]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}