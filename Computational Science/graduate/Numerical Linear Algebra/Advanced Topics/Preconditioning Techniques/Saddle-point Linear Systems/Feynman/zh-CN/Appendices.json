{
    "hands_on_practices": [
        {
            "introduction": "鞍点线性系统的核心特征之一是其系统矩阵 $K$ 的不定性，这也是“鞍点”一词的由来。本练习旨在通过一个具体的构造性问题，加深你对这一根本性质的理解。你将亲手构建一个简单的鞍点矩阵，并利用二次型 $z^T K z$ 的定义，直接证明其不定性，即找到向量使其二次型分别大于和小于零。这个实践将帮助你直观地感受鞍点矩阵的结构，并理解为何它对专为正定系统设计的求解器构成了挑战 。",
            "id": "3575826",
            "problem": "考虑如下形式的鞍点分块矩阵 $K \\in \\mathbb{R}^{3 \\times 3}$\n$$\nK = \\begin{bmatrix} A  B^{T} \\\\ B  -C \\end{bmatrix},\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是对称矩阵，$B \\in \\mathbb{R}^{1 \\times 2}$，$C \\in \\mathbb{R}^{1 \\times 1}$。在离散集合内进行操作\n$$\n\\mathcal{A} \\;=\\; \\left\\{ \\begin{bmatrix} a  b \\\\ b  d \\end{bmatrix} \\,\\middle|\\, a,b,d \\in \\{0,1\\} \\right\\}, \n\\quad\n\\mathcal{B} \\;=\\; \\left\\{ \\begin{bmatrix} b_{1}  b_{2} \\end{bmatrix} \\,\\middle|\\, b_{1}, b_{2} \\in \\{0,1\\} \\right\\},\n\\quad\n\\mathcal{C} \\;=\\; \\{1\\},\n$$\n并施加约束条件：$A$ 是对称正定（SPD）矩阵且 $B \\neq \\mathbf{0}$。为消除歧义，对参数元组使用字典序：对 $A$ 比较 $(a,b,d)$；对 $B$ 比较 $(b_{1},b_{2})$；对 $C$ 只有 $1$。选择满足这些约束条件的字典序最小的三元组 $(A,B,C) \\in \\mathcal{A} \\times \\mathcal{B} \\times \\mathcal{C}$。\n\n从二次型的定性定义出发，并仅使用基本的线性代数知识（例如二次型的性质、配方法以及严格凸二次函数极小值点的刻画），构造一个非零向量 $z \\in \\mathbb{R}^{3}$ 使得 $z^{T} K z  0$，并通过找出一个能产生正二次型的向量来论证 $K$ 是对称不定的。\n\n最后，对于您构造的用于证明负性的向量 $z$，计算标量 $z^{T} K z$ 的精确值。请将最终答案表示为一个精确的整数，无需四舍五入。",
            "solution": "该问题是有效的，因其数学上定义明确、内容完整且逻辑一致。\n\n首先，我们必须通过从给定集合 $\\mathcal{A} \\times \\mathcal{B} \\times \\mathcal{C}$ 中选择满足指定约束条件的字典序最小的三元组 $(A, B, C)$ 来确定具体的矩阵 $K$。\n\n矩阵 $A \\in \\mathcal{A}$ 的形式为 $A = \\begin{bmatrix} a  b \\\\ b  d \\end{bmatrix}$，其中 $a, b, d \\in \\{0, 1\\}$。约束条件是 $A$ 必须为对称正定（SPD）矩阵。一个对称矩阵是正定的，当且仅当其所有顺序主子式都为正。\n第一个顺序主子式是 $\\det(A_1) = a$。为使 $A$ 为对称正定矩阵，必须有 $a  0$。由于 $a \\in \\{0, 1\\}$，这意味着 $a=1$。\n第二个顺序主子式是 $\\det(A_2) = \\det(A) = ad - b^2$。为使 $A$ 为对称正定矩阵，必须有 $ad - b^2  0$。代入 $a=1$，该条件变为 $d - b^2  0$。\n我们需要找到满足这些条件的字典序最小的元组 $(a,b,d)$。我们已知 $a=1$。\n我们测试 $b \\in \\{0, 1\\}$ 的值。\n- 如果 $b=0$，条件变为 $d - 0^2  0$，即 $d  0$。由于 $d \\in \\{0, 1\\}$，我们必须有 $d=1$。这给出了元组 $(1,0,1)$。\n- 如果 $b=1$，条件变为 $d - 1^2  0$，即 $d  1$。对于 $d \\in \\{0, 1\\}$ 没有解。\n因此，唯一可能的元组是 $(1,0,1)$，它必然是字典序最小的那个。\n得到的矩阵是 $A = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，即 $2 \\times 2$ 的单位矩阵 $I_2$。\n\n矩阵 $B \\in \\mathcal{B}$ 的形式为 $B = \\begin{bmatrix} b_1  b_2 \\end{bmatrix}$，其中 $b_1, b_2 \\in \\{0, 1\\}$。约束条件是 $B \\neq \\mathbf{0}$ 且元组 $(b_1, b_2)$ 必须是字典序最小的。集合 $\\mathcal{B}$ 由元组 $(0,0), (0,1), (1,0), (1,1)$ 组成。排除零向量后，可能的元组集合为 $\\{(0,1), (1,0), (1,1)\\}$。其中字典序最小的是 $(0,1)$。\n因此，$B = \\begin{bmatrix} 0  1 \\end{bmatrix}$。\n\n矩阵 $C \\in \\mathcal{C}$ 从单元素集 $\\mathcal{C} = \\{1\\}$ 中选取。因此，$C = [1]$。\n\n现在我们组装鞍点矩阵 $K$：\n$A = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，$B = \\begin{bmatrix} 0  1 \\end{bmatrix}$，$C = [1]$。\n我们有 $B^T = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 和 $-C = [-1]$。\n$$\nK = \\begin{bmatrix} A  B^T \\\\ B  -C \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  1  -1 \\end{bmatrix}.\n$$\n问题要求我们证明 $K$ 是对称不定的。根据构造，$K$ 是对称的。为了证明其不定性，我们必须找到向量 $z_1, z_2 \\in \\mathbb{R}^3$ 使得 $z_1^T K z_1  0$ 且 $z_2^T K z_2  0$。\n\n设一个通用向量 $z \\in \\mathbb{R}^3$ 被分块为 $z = \\begin{bmatrix} x \\\\ y \\end{bmatrix}$，其中 $x = \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} \\in \\mathbb{R}^2$ 且 $y \\in \\mathbb{R}$。与 $K$ 相关的二次型为：\n$$\nz^T K z = \\begin{bmatrix} x^T  y \\end{bmatrix} \\begin{bmatrix} A  B^T \\\\ B  -C \\end{bmatrix} \\begin{bmatrix} x \\\\ y \\end{bmatrix} = x^T A x + x^T B^T y + y B x - y^2 C = x^T A x + 2 y B x - y^2 C.\n$$\n代入具体的矩阵 $A$, $B$, 和 $C$：\n$$\nz^T K z = x^T I_2 x + 2y \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} - y^2(1) = (x_1^2 + x_2^2) + 2yx_2 - y^2.\n$$\n为了找到一个能产生正二次型的向量，考虑形如 $z = \\begin{bmatrix} x \\\\ 0 \\end{bmatrix}$ 的向量，其中 $x \\neq \\mathbf{0}$。对于这类向量，$y=0$，二次型简化为 $z^T K z = x^T A x$。由于 $A=I_2$ 是对称正定矩阵，对于所有 $x \\neq \\mathbf{0}$，都有 $x^T A x  0$。例如，我们选择 $x = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。这给出了向量 $z_p = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n二次型的值为 $z_p^T K z_p = 1^2 + 0^2 + 2(0)(0) - 0^2 = 1  0$。\n\n接下来，我们必须构造一个非零向量 $z$ 使得 $z^T K z  0$。我们通过对变量 $x_2$ 使用配方法来分析二次型 $x_1^2 + x_2^2 + 2yx_2 - y^2$：\n$$\nz^T K z = x_1^2 + (x_2^2 + 2yx_2 + y^2) - y^2 - y^2 = x_1^2 + (x_2 + y)^2 - 2y^2.\n$$\n为了使该表达式为负，我们可以选择 $x_1, x_2, y$ 使正项消失。我们设置：\n$x_1 = 0$\n$x_2 + y = 0 \\implies x_2 = -y$\n这个选择使得 $z^T K z = 0^2 + 0^2 - 2y^2 = -2y^2$。为确保 $z$ 是一个非零向量，我们可以为 $y$ 选择任意非零值。我们选择 $y=1$。这意味着 $x_1=0$ 且 $x_2=-1$。得到的向量是：\n$$\nz = \\begin{bmatrix} x_1 \\\\ x_2 \\\\ y \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}.\n$$\n这个向量是非零的。通过这个对 $z$ 的选择，我们证明了 $z^T K z  0$。存在既能产生正值又能产生负值的向量，这证实了对称矩阵 $K$ 是不定的。\n\n最后，我们计算这个构造出的向量 $z = \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}$ 所对应的标量 $z^T K z$ 的精确值。\n使用配方法得到的表达式：\n$$\nz^T K z = x_1^2 + (x_2 + y)^2 - 2y^2 = 0^2 + (-1 + 1)^2 - 2(1)^2 = 0 + 0 - 2 = -2.\n$$\n或者，通过直接矩阵乘法：\n$$\nz^T K z = \\begin{bmatrix} 0  -1  1 \\end{bmatrix} \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  1  -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} (0)(1) + (-1)(0) + (1)(0)  (0)(0) + (-1)(1) + (1)(1)  (0)(0) + (-1)(1) + (1)(-1) \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 0  0  -2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix} = (0)(0) + (0)(-1) + (-2)(1) = -2.\n$$\n两种方法得到相同的结果。该值是所要求的精确整数。",
            "answer": "$$\\boxed{-2}$$"
        },
        {
            "introduction": "理解了鞍点矩阵的结构后，下一个问题便是如何高效求解相应的线性系统。基于 Schur 补 $S = B A^{-1} B^T$ 的迭代法是一类重要的求解策略，其中 Uzawa 方法是典型代表。本练习将引导你分析 Uzawa 方法的收敛性，你会发现迭代步长 $\\tau$ 的选择至关重要。通过计算一个具体例子中 Schur 补的特征值，你将确定收敛区间，并验证当步长选择不当时，迭代将如何发散。这个过程将加深你对迭代法收敛理论（特别是谱半径条件）在实践中如何应用的理解 。",
            "id": "3575856",
            "problem": "考虑一个鞍点线性系统，其分块矩阵为 $K=\\begin{bmatrix}A  B^{T}\\\\ B  0\\end{bmatrix}$，其中 $A\\in\\mathbb{R}^{n\\times n}$ 是对称正定矩阵，$B\\in\\mathbb{R}^{m\\times n}$。对此系统应用步长为常数 $\\tau0$ 的 Uzawa 方法，会产生一个关于拉格朗日乘子误差的线性定常迭代，其迭代矩阵为 $I-\\tau S$，其中 $S:=B A^{-1} B^{T}$ 是 Schur 补。线性定常迭代的一个经过充分检验的事实是，迭代收敛当且仅当迭代矩阵的谱半径严格小于 $1$。\n\n仅使用这些定义和事实，通过以下明确且科学上一致的选择来验证 Uzawa 方法的发散性：\n- 取 $A=\\mathrm{diag}(2,1)\\in\\mathbb{R}^{2\\times 2}$ 和 $B=\\begin{bmatrix}1  1\\end{bmatrix}\\in\\mathbb{R}^{1\\times 2}$。\n- 计算 Schur 补 $S=B A^{-1} B^{T}$ 及其最大特征值 $\\lambda_{\\max}(S)$。\n- 确定保证 Uzawa 迭代收敛的 $\\tau$ 的开区间。\n- 然后选择步长 $\\tau=\\dfrac{3}{2}$，并通过计算谱半径 $\\rho(I-\\tau S)$ 并验证其超过 $1$ 来证明发散。\n\n报告 $\\rho(I-\\tau S)$ 的精确值作为你的最终答案。无需四舍五入，也不涉及单位。",
            "solution": "该问题经验证是自洽的、有科学依据且适定的。所有提供的数据和定义都是数值线性代数中的标准内容，并且内部一致。我现在开始解答。\n\n该问题要求我们分析特定鞍点线性系统的 Uzawa 方法的收敛性。系统矩阵由 $K=\\begin{bmatrix}A  B^{T}\\\\ B  0\\end{bmatrix}$ 给出，其中 $A=\\mathrm{diag}(2,1)\\in\\mathbb{R}^{2\\times 2}$ 且 $B=\\begin{bmatrix}1  1\\end{bmatrix}\\in\\mathbb{R}^{1\\times 2}$。针对拉格朗日乘子误差的 Uzawa 迭代的迭代矩阵为 $I-\\tau S$，其中 $S = B A^{-1} B^{T}$ 是 Schur 补，$\\tau  0$ 是步长。收敛的充要条件是谱半径 $\\rho(I-\\tau S)  1$。\n\n首先，我们必须计算 Schur 补 $S$。矩阵 $A$ 是一个对角矩阵，因此其逆矩阵 $A^{-1}$ 可以通过取其对角元素的倒数得到。\n$$A = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix} \\implies A^{-1} = \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{bmatrix}$$\n矩阵 $B$ 已知为 $B = \\begin{bmatrix} 1  1 \\end{bmatrix}$，其转置为 $B^{T} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n\n现在，我们计算 $S = B A^{-1} B^{T}$：\n$$S = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$$\n从左到右进行矩阵乘法：\n$$B A^{-1} = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} (1)(\\frac{1}{2}) + (1)(0)  (1)(0) + (1)(1) \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2}  1 \\end{bmatrix}$$\n然后，我们完成 $S$ 的计算：\n$$S = (B A^{-1}) B^{T} = \\begin{bmatrix} \\frac{1}{2}  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\left[ (\\frac{1}{2})(1) + (1)(1) \\right] = \\left[ \\frac{1}{2} + 1 \\right] = \\left[ \\frac{3}{2} \\right]$$\n所以，Schur 补 $S$ 是一个 $1 \\times 1$ 矩阵，可以看作标量 $\\frac{3}{2}$。\n\n一个标量矩阵的特征值就是该标量本身。因此，$S$ 的唯一特征值是 $\\lambda(S) = \\frac{3}{2}$。最大特征值是 $\\lambda_{\\max}(S) = \\frac{3}{2}$。\n\n接下来，我们确定保证收敛的 $\\tau$ 的开区间。迭代矩阵是 $M = I - \\tau S$。由于 $S$ 是标量 $\\frac{3}{2}$，单位矩阵 $I$ 是标量 $1$，所以迭代矩阵是标量 $M = 1 - \\tau(\\frac{3}{2})$。\n标量矩阵的谱半径是其绝对值。收敛要求 $\\rho(M)  1$：\n$$ \\rho(I-\\tau S) = \\left| 1 - \\frac{3\\tau}{2} \\right|  1 $$\n这个不等式等价于：\n$$ -1  1 - \\frac{3\\tau}{2}  1 $$\n我们解这个关于 $\\tau$ 的复合不等式。首先，对于左边部分：\n$$ -1  1 - \\frac{3\\tau}{2} \\implies \\frac{3\\tau}{2}  1 + 1 \\implies \\frac{3\\tau}{2}  2 \\implies \\tau  \\frac{4}{3} $$\n接着，对于右边部分：\n$$ 1 - \\frac{3\\tau}{2}  1 \\implies -\\frac{3\\tau}{2}  0 \\implies \\frac{3\\tau}{2} > 0 \\implies \\tau > 0 $$\n综合这些结果，Uzawa 迭代在 $\\tau \\in (0, \\frac{4}{3})$ 时收敛。\n\n问题要求我们选择步长 $\\tau = \\frac{3}{2}$。由于 $\\frac{3}{2} = \\frac{9}{6}$ 且 $\\frac{4}{3} = \\frac{8}{6}$，我们有 $\\tau > \\frac{4}{3}$，所以选择的 $\\tau$ 在收敛区间之外。因此我们预期迭代会发散。\n\n为了证明这一点，我们计算当 $\\tau = \\frac{3}{2}$ 时的谱半径 $\\rho(I - \\tau S)$。\n迭代矩阵为 $M = I - \\tau S$。当 $S = \\frac{3}{2}$ 和 $\\tau = \\frac{3}{2}$ 时，我们有：\n$$ M = 1 - \\left(\\frac{3}{2}\\right) \\left(\\frac{3}{2}\\right) = 1 - \\frac{9}{4} = \\frac{4}{4} - \\frac{9}{4} = -\\frac{5}{4} $$\n谱半径是这个标量的绝对值：\n$$ \\rho(I - \\tau S) = \\left| -\\frac{5}{4} \\right| = \\frac{5}{4} $$\n由于 $\\rho(I - \\tau S) = \\frac{5}{4} > 1$，收敛条件被破坏，迭代如预期一样发散。需要报告的值就是这个谱半径。",
            "answer": "$$\\boxed{\\frac{5}{4}}$$"
        },
        {
            "introduction": "理论上优雅的求解方法在面对有限精度计算时，有时会暴露出数值不稳定性的问题，尤其是在处理病态子问题时。本练习通过一个精心设计的例子，揭示了当 $(1,1)$ 块 $A$ 病态时，直接构造 Schur 补 $S = B A^{-1} B^T + C$ 会导致“灾难性抵消”，从而严重损失计算精度。作为解决方案，练习引入了增广拉格朗日方法这一强大的正则化技术，并引导你不仅推导其稳定的形式，还要通过优化增广块的条件数来寻找最佳的正则化参数 $\\gamma$。这项实践对于理解和解决实际应用中的数值挑战至关重要 。",
            "id": "3575855",
            "problem": "考虑一个由带等式约束的二次规划产生的 $2\\times 2$ 分块鞍点线性系统。令 $n=2$ 且 $m=1$，并定义\n$$\nA=\\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix},\\qquad B=\\begin{pmatrix} 1  1 \\end{pmatrix},\\qquad C=-\\frac{1}{\\epsilon}+\\delta,\n$$\n其中 $\\epsilon\\in(0,1)$ 是一个小参数，$\\delta\\in\\mathbb{R}$ 是 $\\mathcal{O}(1)$ 阶的。鞍点矩阵为\n$$\n\\mathcal{K}=\\begin{pmatrix}\nA  B^{T} \\\\\nB  -C\n\\end{pmatrix}.\n$$\n通过消去主变量关联的舒尔补定义为\n$$\nS = B A^{-1} B^{T} + C.\n$$\n要求您分析当 $A$ 是病态时显式构造 $S$ 的数值不稳定性，并通过增广拉格朗日修正提出一种稳定的替代方案。\n\n任务：\n1. 从舒尔补和矩阵逆的定义出发，推导 $S$ 关于 $\\epsilon$ 和 $\\delta$ 的精确表达式，并解释为什么当 $\\epsilon\\to 0^{+}$ 时，显式构造 $A^{-1}$ 然后计算 $S$ 会表现出灾难性抵消。\n\n2. 考虑使用如下的增广拉格朗日稳定化方法\n$$\nA_{\\gamma}=A+\\gamma B^{T}B,\\qquad \\gamma0.\n$$\n仅使用秩一更新的基本恒等式，推导\n$$\nS_{\\gamma}=B A_{\\gamma}^{-1} B^{T} + C\n$$\n关于 $\\epsilon$、$\\gamma$ 和 $\\delta$ 的有理函数的闭式表达式，除了秩一更新所隐含的逆之外，不显式构造任何矩阵的逆。\n\n3. 为了在使用 $A_{\\gamma}$ 进行内部求解的成本和稳定性与 $S_{\\gamma}$ 改进的数值行为之间取得平衡，选择 $\\gamma$ 来最小化 $A_{\\gamma}$ 的谱条件数 $\\kappa_{2}(A_{\\gamma})$（其在欧几里得范数下的最大特征值与最小特征值之比）。从一个 $2\\times 2$ 对称矩阵的特征多项式出发，推导在 $\\gamma0$ 上的最小化子 $\\gamma^{\\star}(\\epsilon)$ 的精确表达式。\n\n您最终报告的答案应该是 $\\gamma^{\\star}(\\epsilon)$ 关于 $\\epsilon$ 的解析函数的闭式表达式。不要包含任何单位。不要对答案进行四舍五入。",
            "solution": "在尝试解答之前，问题需要经过验证。\n\n### 步骤 1：提取已知条件\n- **问题类型**：$2 \\times 2$ 分块鞍点线性系统分析。\n- **维度**：$n=2$， $m=1$。\n- **矩阵和向量定义**：\n  - $A = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix}$\n  - $B = \\begin{pmatrix} 1  1 \\end{pmatrix}$\n  - $C = -\\frac{1}{\\epsilon} + \\delta$\n- **鞍点矩阵**：$\\mathcal{K} = \\begin{pmatrix} A  B^{T} \\\\ B  -C \\end{pmatrix}$\n- **参数**：$\\epsilon \\in (0,1)$ 是一个小参数，$\\delta \\in \\mathbb{R}$ 的数量级为单位一 ($\\mathcal{O}(1)$)，$\\gamma  0$ 是一个正则化参数。\n- **舒尔补**：$S = B A^{-1} B^{T} + C$\n- **增广矩阵和舒尔补**：$A_{\\gamma} = A + \\gamma B^{T}B$ 和 $S_{\\gamma} = B A_{\\gamma}^{-1} B^{T} + C$。\n- **任务**：\n  1. 推导 $S$ 的精确表达式，并解释在数值上构造它时发生的灾难性抵消。\n  2. 使用秩一更新恒等式推导 $S_{\\gamma}$ 的有理函数闭式表达式。\n  3. 找到最小化谱条件数 $\\kappa_{2}(A_{\\gamma})$ 的参数 $\\gamma^{\\star}(\\epsilon)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数值线性代数领域有坚实的科学基础，涉及鞍点系统、舒尔补、增广拉格朗日方法和矩阵条件数等标准概念。该问题是适定的；矩阵定义清晰，且在需要时逆存在（$A$ 是可逆的，因为 $\\epsilon \\neq 0$；$A_{\\gamma}$ 是对称正定的，因此也是可逆的，因为 $A$ 是对称正定矩阵 (SPD)，而对于 $\\gamma0$，$B^T B$ 是半正定矩阵 (SPSD)）。该问题是客观的，使用了精确的数学语言。其设定是自洽且无矛盾的。该模型虽然简单，但代表了在实际应用中遇到的病态问题的典型案例，使得分析具有非平凡性和意义。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 第 1 部分：舒尔补 $S$ 的分析\n\n首先，我们推导舒尔补 $S$ 的精确表达式。\n矩阵 $A$ 由 $A = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix}$ 给出。其逆为 $A^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1/\\epsilon \\end{pmatrix}$。\n矩阵 $B$ 是 $B = \\begin{pmatrix} 1  1 \\end{pmatrix}$，所以其转置是 $B^T = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n项 $B A^{-1} B^T$ 的计算如下：\n$$\nB A^{-1} B^T = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\epsilon} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{\\epsilon} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1 \\cdot 1 + \\frac{1}{\\epsilon} \\cdot 1 = 1 + \\frac{1}{\\epsilon}.\n$$\n现在，我们加上项 $C = -\\frac{1}{\\epsilon} + \\delta$ 来求 $S$：\n$$\nS = (B A^{-1} B^T) + C = \\left(1 + \\frac{1}{\\epsilon}\\right) + \\left(-\\frac{1}{\\epsilon} + \\delta\\right) = 1 + \\delta.\n$$\n$S$ 的精确值为 $1+\\delta$，这是一个 $\\mathcal{O}(1)$ 阶的量。\n\n数值不稳定性源于“显式构造 $A^{-1}$ 然后计算 $S$”的过程。在浮点运算中，当 $\\epsilon$ 非常小（例如，相对于 $1$ 小于机器ε）时，数 $1/\\epsilon$ 会变得非常大。\n计算过程如下：\n1. 构造 $B A^{-1} B^T = 1 + 1/\\epsilon$。在浮点运算中，如果 $1/\\epsilon$ 足够大，加法 $1 + 1/\\epsilon$ 的结果在计算上与 $1/\\epsilon$ 无法区分。关于项 '$1$' 的信息丢失了。\n2. 构造 $C = -1/\\epsilon + \\delta$。\n3. 计算 $S = (B A^{-1} B^T) + C$。在数值上，这变成了 $(1/\\epsilon) + (-1/\\epsilon + \\delta)$。这个两个相近的大数相减导致计算结果为 $\\delta$。\n真实结果是 $1+\\delta$，但计算结果是 $\\delta$。这种两个大数相减消除了前面的有效数字，并暴露了先前不显著的噪声或误差的现象，被称为灾难性抵消。相对误差为 $(\\text{真值}-\\text{计算值})/\\text{真值} = ((1+\\delta)-\\delta)/(1+\\delta) = 1/(1+\\delta)$，这是一个 $\\mathcal{O}(1)$ 的相对误差，表明精度的完全丧失。\n\n### 第 2 部分：增广舒尔补 $S_{\\gamma}$ 的推导\n\n我们需要推导 $S_{\\gamma} = B A_{\\gamma}^{-1} B^{T} + C$ 的表达式，其中 $A_{\\gamma} = A + \\gamma B^{T}B$。矩阵 $A_{\\gamma}$ 是 $A$ 的一个秩一更新。我们可以使用 Sherman-Morrison 公式来求秩一更新矩阵的逆：\n$$\n(M + uv^T)^{-1} = M^{-1} - \\frac{M^{-1}uv^T M^{-1}}{1+v^T M^{-1} u}.\n$$\n在我们的情况下，$M=A$，$u=\\gamma B^T$，$v^T=B$。\n$$\nA_{\\gamma}^{-1} = (A + \\gamma B^T B)^{-1} = A^{-1} - \\frac{A^{-1}(\\gamma B^T)B A^{-1}}{1+B(\\gamma A^{-1}) B^T} = A^{-1} - \\frac{\\gamma A^{-1} B^T B A^{-1}}{1+\\gamma B A^{-1} B^T}.\n$$\n现在，我们左乘 $B$ 并右乘 $B^T$：\n$$\nB A_{\\gamma}^{-1} B^T = B A^{-1} B^T - \\frac{\\gamma B A^{-1} B^T B A^{-1} B^T}{1+\\gamma B A^{-1} B^T}.\n$$\n令 $X = B A^{-1} B^T$。表达式简化为：\n$$\nB A_{\\gamma}^{-1} B^T = X - \\frac{\\gamma X^2}{1+\\gamma X} = \\frac{X(1+\\gamma X) - \\gamma X^2}{1+\\gamma X} = \\frac{X + \\gamma X^2 - \\gamma X^2}{1+\\gamma X} = \\frac{X}{1+\\gamma X}.\n$$\n代入 $X = 1 + 1/\\epsilon$：\n$$\nB A_{\\gamma}^{-1} B^T = \\frac{1+1/\\epsilon}{1+\\gamma(1+1/\\epsilon)}.\n$$\n现在我们通过加上 $C$ 来计算 $S_{\\gamma}$：\n$$\nS_{\\gamma} = \\frac{1+1/\\epsilon}{1+\\gamma(1+1/\\epsilon)} + C = \\frac{1+1/\\epsilon}{1+\\gamma(1+1/\\epsilon)} - \\frac{1}{\\epsilon} + \\delta.\n$$\n为了得到关于 $\\epsilon, \\gamma, \\delta$ 的有理函数，我们首先通过将分子和分母乘以 $\\epsilon$ 来重写分数：\n$$\nB A_{\\gamma}^{-1} B^T = \\frac{\\epsilon(1+1/\\epsilon)}{\\epsilon(1+\\gamma(1+1/\\epsilon))} = \\frac{\\epsilon+1}{\\epsilon+\\gamma(\\epsilon+1)} = \\frac{1+\\epsilon}{\\epsilon + \\gamma(1+\\epsilon)}.\n$$\n然后，我们合并 $S_{\\gamma}$ 的所有项：\n$$\nS_{\\gamma} = \\frac{1+\\epsilon}{\\epsilon + \\gamma(1+\\epsilon)} - \\frac{1}{\\epsilon} + \\delta = \\frac{\\epsilon(1+\\epsilon) - (\\epsilon + \\gamma(1+\\epsilon))}{\\epsilon(\\epsilon + \\gamma(1+\\epsilon))} + \\delta.\n$$\n分数的分子是 $\\epsilon + \\epsilon^2 - \\epsilon - \\gamma - \\gamma\\epsilon = \\epsilon^2 - \\gamma(1+\\epsilon)$。\n分母是 $\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon)$。\n所以我们有：\n$$\nS_{\\gamma} = \\frac{\\epsilon^2 - \\gamma(1+\\epsilon)}{\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon)} + \\delta.\n$$\n最后，将 $\\delta$ 合并到分数中，得到所需的有理函数：\n$$\nS_{\\gamma} = \\frac{\\epsilon^2 - \\gamma(1+\\epsilon) + \\delta(\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon))}{\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon)}.\n$$\n此表达式避免了对 $A$ 的显式求逆或像 $1/\\epsilon$ 这样的大项的中间计算。\n\n### 第 3 部分：$A_{\\gamma}$ 条件数的最小化\n\n首先，我们构造矩阵 $A_{\\gamma}$：\n$$\nA_{\\gamma} = A + \\gamma B^T B = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix} + \\gamma \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix} + \\gamma \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1+\\gamma  \\gamma \\\\ \\gamma  \\epsilon+\\gamma \\end{pmatrix}.\n$$\n$A_{\\gamma}$ 的特征值 $\\lambda$ 是其特征多项式 $\\det(A_{\\gamma} - \\lambda I) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} 1+\\gamma-\\lambda  \\gamma \\\\ \\gamma  \\epsilon+\\gamma-\\lambda \\end{pmatrix} = (1+\\gamma-\\lambda)(\\epsilon+\\gamma-\\lambda) - \\gamma^2 = 0.\n$$\n展开此式得到：\n$$\n\\lambda^2 - (\\epsilon+\\gamma+1+\\gamma)\\lambda + (1+\\gamma)(\\epsilon+\\gamma) - \\gamma^2 = 0\n$$\n$$\n\\lambda^2 - (1+\\epsilon+2\\gamma)\\lambda + (\\epsilon+\\gamma+\\gamma\\epsilon) = 0.\n$$\n特征值 $\\lambda_{1,2}$ 由二次公式给出：\n$$\n\\lambda_{1,2} = \\frac{(1+\\epsilon+2\\gamma) \\pm \\sqrt{(1+\\epsilon+2\\gamma)^2 - 4(\\epsilon+\\gamma+\\gamma\\epsilon)}}{2}.\n$$\n我们来简化判别式 $\\Delta$：\n$$\n\\Delta = (1+\\epsilon)^2 + 4\\gamma(1+\\epsilon) + 4\\gamma^2 - 4\\epsilon - 4\\gamma - 4\\gamma\\epsilon\n$$\n$$\n\\Delta = 1+2\\epsilon+\\epsilon^2 + 4\\gamma+4\\gamma\\epsilon + 4\\gamma^2 - 4\\epsilon - 4\\gamma - 4\\gamma\\epsilon = 1-2\\epsilon+\\epsilon^2+4\\gamma^2 = (1-\\epsilon)^2+4\\gamma^2.\n$$\n所以特征值为 $\\lambda_1 = \\frac{1+\\epsilon+2\\gamma + \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}{2}$ 和 $\\lambda_2 = \\frac{1+\\epsilon+2\\gamma - \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}{2}$。\n谱条件数为 $\\kappa_2(A_{\\gamma}) = \\lambda_1/\\lambda_2$。\n$$\n\\kappa_2(\\gamma) = \\frac{1+\\epsilon+2\\gamma + \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}{1+\\epsilon+2\\gamma - \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}.\n$$\n为了关于 $\\gamma  0$ 最小化 $\\kappa_2(\\gamma)$，我们可以将其导数设为零。最小化 $\\ln(\\kappa_2(\\gamma))$ 是等价且更简单的。令 $u(\\gamma) = 1+\\epsilon+2\\gamma$ 和 $v(\\gamma) = \\sqrt{(1-\\epsilon)^2+4\\gamma^2}$。\n则 $\\ln(\\kappa_2(\\gamma)) = \\ln(u+v) - \\ln(u-v)$。\n$$\n\\frac{d}{d\\gamma} \\ln(\\kappa_2(\\gamma)) = \\frac{u'+v'}{u+v} - \\frac{u'-v'}{u-v} = \\frac{(u'+v')(u-v) - (u'-v')(u+v)}{u^2-v^2} = \\frac{2(v'u - u'v)}{u^2-v^2}.\n$$\n当 $v'u - u'v = 0$ 时，导数为零。\n我们有 $u'(\\gamma) = 2$ 和 $v'(\\gamma) = \\frac{8\\gamma}{2\\sqrt{(1-\\epsilon)^2+4\\gamma^2}} = \\frac{4\\gamma}{v}$。\n条件变为：\n$$\n\\frac{4\\gamma}{v}u - 2v = 0 \\implies 4\\gamma u - 2v^2 = 0 \\implies 2\\gamma u = v^2.\n$$\n代入 $u$ 和 $v^2$ 的表达式：\n$$\n2\\gamma(1+\\epsilon+2\\gamma) = (1-\\epsilon)^2+4\\gamma^2.\n$$\n$$\n2\\gamma(1+\\epsilon) + 4\\gamma^2 = (1-\\epsilon)^2 + 4\\gamma^2.\n$$\n$$\n2\\gamma(1+\\epsilon) = (1-\\epsilon)^2.\n$$\n解出 $\\gamma$ 得到最优值 $\\gamma^{\\star}(\\epsilon)$：\n$$\n\\gamma^{\\star}(\\epsilon) = \\frac{(1-\\epsilon)^2}{2(1+\\epsilon)}.\n$$\n因为 $\\epsilon \\in (0,1)$，我们有 $1-\\epsilon  0$ 和 $1+\\epsilon  0$，所以 $\\gamma^{\\star}(\\epsilon)  0$，符合要求。该值最小化了正则化块 $A_{\\gamma}$ 的条件数。",
            "answer": "$$\\boxed{\\frac{(1-\\epsilon)^2}{2(1+\\epsilon)}}$$"
        }
    ]
}