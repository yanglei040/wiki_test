{
    "hands_on_practices": [
        {
            "introduction": "我们首先通过一个具体计算来探索定义投影算子的核心属性，以此区分斜投影算子和正交投影算子。通过构建一个其值域与零空间不正交的投影算子，我们将亲手验证 $P \\neq P^\\top$ 的具体表现，并理解为何其算子范数 $\\|P\\|_2$ 可以大于 $1$，这是理解稳定性的关键一步。",
            "id": "3563339",
            "problem": "设 $\\mathbb{R}^{2}$ 具有标准欧几里得内积。考虑一维子空间 $U = \\operatorname{span}\\{[1,0]^{\\top}\\}$ 和 $V = \\operatorname{span}\\{[1,\\tfrac{1}{2}]^{\\top}\\}$。仅使用线性代数的核心定义，完成以下任务：\n\n1. 构造唯一的幂等线性算子 $P : \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$，其值域 $\\operatorname{range}(P) = U$ 且零空间 $\\operatorname{null}(P) = V$。将 $P$ 写成标准基下的一个 $2 \\times 2$ 实矩阵。\n2. 从基本原理出发，证明 $P$ 是幂等的，并且 $P$ 不是一个正交投影算子（即，它不是到其值域上的正交投影）。\n3. 直接从你构造的矩阵确定 $\\operatorname{range}(P)$ 和 $\\operatorname{null}(P)$，并验证它们分别等于 $U$ 和 $V$。\n4. 通过计算斜对称部分 $\\|P - P^{\\top}\\|_{2}$ 的诱导谱范数（2-范数）来量化其与正交性的偏离程度，并将其与由 $\\mathbb{R}^{2}$ 上的内积定义的 $\\operatorname{range}(P)$ 和 $\\operatorname{null}(P)$ 之间的主夹角联系起来。\n5. 最后，计算谱算子范数 $\\|P\\|_{2}$ 的精确值。\n\n给出 $\\|P\\|_{2}$ 的精确值作为你的最终答案。不需要四舍五入，也不涉及单位。所有中间步骤必须从幂等算子、值域、零空间和算子2-范数的定义出发。",
            "solution": "所述问题在数学上是适定且自洽的。幂等算子 $P$ 的存在性和唯一性是得到保证的，因为指定的的值域 $U = \\operatorname{span}\\{[1,0]^{\\top}\\}$ 和零空间 $V = \\operatorname{span}\\{[1,\\tfrac{1}{2}]^{\\top}\\}$ 是一维子空间，且它们的基向量是线性无关的。因此，$\\mathbb{R}^{2}$ 可以表示为直和 $U \\oplus V$，这是存在一个唯一的、沿着 $V$ 到 $U$ 上的投影算子的充分必要条件。我们进行求解。\n\n**1. 构造投影矩阵 $P$**\n\n设 $P: \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$ 是值域为 $\\operatorname{range}(P) = U$ 且零空间为 $\\operatorname{null}(P) = V$ 的线性算子。根据投影算子的定义，对于任意向量 $\\mathbf{x} \\in \\mathbb{R}^{2}$，我们可以将其唯一地分解为 $\\mathbf{x} = \\mathbf{x}_U + \\mathbf{x}_V$，其中 $\\mathbf{x}_U \\in U$ 且 $\\mathbf{x}_V \\in V$。投影算子 $P$ 的作用则定义为 $P(\\mathbf{x}) = \\mathbf{x}_U$。\n\n设 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathbb{R}^{2}$。我们可以用 $U$ 和 $V$ 的基向量来表示它的分量。设 $U$ 的基为 $\\mathbf{u}_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$V$ 的基为 $\\mathbf{v}_1 = \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix}$。\n分解形式为 $\\mathbf{x} = c_1 \\mathbf{u}_1 + c_2 \\mathbf{v}_1$，其中 $c_1, c_2 \\in \\mathbb{R}$ 是唯一的标量。\n$$\n\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = c_1 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + c_2 \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} c_1 + c_2 \\\\ \\frac{1}{2}c_2 \\end{pmatrix}\n$$\n这就得到了一个关于 $c_1$ 和 $c_2$ 的线性方程组：\n1) $\\quad x_1 = c_1 + c_2$\n2) $\\quad x_2 = \\frac{1}{2}c_2$\n\n从方程(2)，我们得到 $c_2 = 2x_2$。将此代入方程(1)得到 $c_1 = x_1 - c_2 = x_1 - 2x_2$。\n$\\mathbf{x}$ 在 $U$ 上的投影是 $\\mathbf{x}_U = c_1 \\mathbf{u}_1$。因此，\n$$\nP(\\mathbf{x}) = (x_1 - 2x_2) \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} x_1 - 2x_2 \\\\ 0 \\end{pmatrix}\n$$\n这个线性变换可以由一个矩阵 $P$ 表示，使得 $P\\mathbf{x} = \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix}\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。\n因此，算子 $P$ 在标准基下的矩阵为：\n$$\nP = \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix}\n$$\n\n**2. 幂等性和非正交性的证明**\n\n一个算子是幂等的，如果将它作用两次与作用一次的效果相同，即 $P^2 = P$。\n$$\nP^2 = \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + (-2) \\cdot 0  1 \\cdot (-2) + (-2) \\cdot 0 \\\\ 0 \\cdot 1 + 0 \\cdot 0  0 \\cdot (-2) + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix} = P\n$$\n这证明了 $P$ 是幂等的。\n\n正交投影算子是一个同时也是自伴的幂等算子，即 $P = P^{\\top}$。$P$ 的转置是：\n$$\nP^{\\top} = \\begin{pmatrix} 1  0 \\\\ -2  0 \\end{pmatrix}\n$$\n由于 $P \\neq P^{\\top}$，$P$ 不是一个自伴算子，因此不是一个正交投影算子。一个更根本的原因是，对于一个正交投影算子，其值域和零空间必须是正交补。$U$ 和 $V$ 的基向量的内积是：\n$$\n\\left\\langle \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix} \\right\\rangle = 1 \\cdot 1 + 0 \\cdot \\frac{1}{2} = 1 \\neq 0\n$$\n由于 $\\operatorname{range}(P)$ 和 $\\operatorname{null}(P)$ 不是正交的，所以 $P$ 不是一个正交投影算子。\n\n**3. 值域和零空间的验证**\n\n$P$ 的值域，记作 $\\operatorname{range}(P)$，是其矩阵表示的列空间。\n$$\n\\operatorname{range}(P) = \\operatorname{span}\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} \\right\\}\n$$\n由于第二个向量是第一个向量的标量倍（-2倍），所以其张成的空间仅由第一个向量决定。\n$$\n\\operatorname{range}(P) = \\operatorname{span}\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\} = U\n$$\n$P$ 的零空间，记作 $\\operatorname{null}(P)$，是所有满足 $P\\mathbf{x} = \\mathbf{0}$ 的向量 $\\mathbf{x}$ 的集合。\n$$\n\\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这对应于单个方程 $x_1 - 2x_2 = 0$，即 $x_1 = 2x_2$。零空间中的任意向量都必须是 $\\begin{pmatrix} 2x_2 \\\\ x_2 \\end{pmatrix} = x_2 \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$ 的形式。因此，零空间是：\n$$\n\\operatorname{null}(P) = \\operatorname{span}\\left\\{ \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\right\\}\n$$\n子空间 $V$ 被定义为 $\\operatorname{span}\\{[1, \\frac{1}{2}]^{\\top}\\}$。由于 $\\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = 2 \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix}$，这两个向量张成相同的一维子空间。因此，$\\operatorname{null}(P) = V$。\n\n**4. 与正交性的偏离**\n\n与正交性的偏离程度可以通过 $P$ 的斜对称部分 $P - P^{\\top}$ 的范数来量化。\n$$\nP - P^{\\top} = \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ -2  0 \\end{pmatrix} = \\begin{pmatrix} 0  -2 \\\\ 2  0 \\end{pmatrix}\n$$\n诱导谱范数（2-范数）为 $\\|P-P^{\\top}\\|_{2} = \\sqrt{\\lambda_{\\max}((P-P^{\\top})^{\\top}(P-P^{\\top}))}$。\n设 $S = P-P^{\\top}$。\n$$\nS^{\\top}S = \\begin{pmatrix} 0  2 \\\\ -2  0 \\end{pmatrix} \\begin{pmatrix} 0  -2 \\\\ 2  0 \\end{pmatrix} = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix}\n$$\n$S^{\\top}S$ 的特征值均为 $4$。因此，$\\lambda_{\\max}(S^{\\top}S) = 4$。\n$$\n\\|P - P^{\\top}\\|_{2} = \\sqrt{4} = 2\n$$\n$U$ 和 $V$ 之间的主夹角 $\\theta_{UV}$ 是它们基向量之间的夹角。\n$$\n\\cos(\\theta_{UV}) = \\frac{\\left| \\left\\langle \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix} \\right\\rangle \\right|}{\\left\\| \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\| \\left\\| \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix} \\right\\|} = \\frac{|1|}{\\sqrt{1^2+0^2} \\sqrt{1^2+(\\frac{1}{2})^2}} = \\frac{1}{\\sqrt{\\frac{5}{4}}} = \\frac{2}{\\sqrt{5}}\n$$\n由此，我们可以求出 $\\sin(\\theta_{UV}) = \\sqrt{1 - \\cos^2(\\theta_{UV})} = \\sqrt{1 - \\frac{4}{5}} = \\frac{1}{\\sqrt{5}}$。\n该夹角的余切值为 $\\cot(\\theta_{UV}) = \\frac{\\cos(\\theta_{UV})}{\\sin(\\theta_{UV})} = \\frac{2/\\sqrt{5}}{1/\\sqrt{5}} = 2$。\n因此，我们找到了直接关系：$\\|P - P^{\\top}\\|_{2} = \\cot(\\theta_{UV})$。\n\n**5. $P$ 的谱范数**\n\n$P$ 的谱范数由 $\\|P\\|_{2} = \\sqrt{\\lambda_{\\max}(P^{\\top}P)}$ 给出。首先，我们计算 $P^{\\top}P$。\n$$\nP^{\\top}P = \\begin{pmatrix} 1  0 \\\\ -2  0 \\end{pmatrix} \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ -2  4 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(P^{\\top}P - \\lambda I) = 0$ 来求该矩阵的特征值。\n$$\n\\det\\begin{pmatrix} 1-\\lambda  -2 \\\\ -2  4-\\lambda \\end{pmatrix} = (1-\\lambda)(4-\\lambda) - (-2)(-2) = 0\n$$\n$$\n4 - 5\\lambda + \\lambda^2 - 4 = 0\n$$\n$$\n\\lambda^2 - 5\\lambda = 0\n$$\n$$\n\\lambda(\\lambda - 5) = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = 5$。最大特征值为 $\\lambda_{\\max}(P^{\\top}P) = 5$。\n因此，$P$ 的谱范数为：\n$$\n\\|P\\|_{2} = \\sqrt{5}\n$$\n这个结果与投影算子范数的一般公式 $\\|P\\|_2 = 1/\\sin(\\theta_{UV})$ 一致，其中 $\\theta_{UV}$ 是值域和零空间之间的最小夹角。如前所算，$\\sin(\\theta_{UV}) = 1/\\sqrt{5}$，所以 $\\|P\\|_2 = 1/(1/\\sqrt{5}) = \\sqrt{5}$。",
            "answer": "$$\\boxed{\\sqrt{5}}$$"
        },
        {
            "introduction": "尽管正交投影在欧几里得范数下是非扩张的（即 $\\|P\\|_2=1$），但它在其他范数下的行为可能出人意料，并具有重要的实际意义。这个分析性练习将引导我们探究秩为一的正交投影算子的 $\\|P\\|_1$ 和 $\\|P\\|_\\infty$ 范数如何随空间维度增长。这一现象揭示了高维应用中数值不稳定性的一个潜在来源，即微小的分量误差可能被显著放大。",
            "id": "3550808",
            "problem": "设 $n \\ge 2$，且 $\\|\\cdot\\|_p$ 表示与 $\\mathbb{R}^n$ 上的向量 $\\ell_p$ 范数相关联的 $\\mathbb{R}^{n \\times n}$ 上的诱导矩阵范数，其定义为 $\\|A\\|_p := \\sup_{x \\ne 0} \\frac{\\|Ax\\|_p}{\\|x\\|_p}$。回顾一下，正交投影子是一个满足 $P^2 = P = P^{\\top}$ 的实对称幂等矩阵 $P \\in \\mathbb{R}^{n \\times n}$。考虑秩为一的正交投影子族 $P = u u^{\\top}$，其中 $u \\in \\mathbb{R}^n$ 且 $\\|u\\|_2 = 1$。从诱导范数和正交投影子的定义出发，并且不使用任何非从基本原理推导的专门公式，确定所有这类 $P$ 的 $\\|P\\|_1$ 的精确上确界（作为 $n$ 的函数），并证明该值也是同一族上 $\\|P\\|_{\\infty}$ 的上确界。然后，利用诱导范数的定义解释为什么存在正交投影子 $P$，其 $\\|P\\|_2 = 1$ 但 $\\|P\\|_1$ 和 $\\|P\\|_{\\infty}$ 随着 $n \\to \\infty$ 无界增长，并将此现象与形式为 $x \\mapsto Q D Q^{\\top} x$ 的坐标截断方案的潜在数值不稳定性联系起来，其中 $Q$ 是正交矩阵， $D$ 是对角线上元素为 $0$ 或 $1$ 的对角矩阵。将 $\\|P\\|_1$ 的上确界表示为关于 $n$ 的闭式解析表达式。无需四舍五入。",
            "solution": "问题陈述的严格验证如下。\n\n**步骤 1：提取已知条件**\n- $n \\ge 2$ 是一个整数。\n- $\\|\\cdot\\|_p$ 是从 $\\mathbb{R}^n$ 上的向量 $\\ell_p$ 范数诱导的 $\\mathbb{R}^{n \\times n}$ 上的矩阵范数。\n- $\\|A\\|_p := \\sup_{x \\ne 0} \\frac{\\|Ax\\|_p}{\\|x\\|_p}$。\n- 正交投影子是一个矩阵 $P \\in \\mathbb{R}^{n \\times n}$，满足 $P^2 = P = P^{\\top}$。\n- 我们考虑秩为一的正交投影子族 $P = u u^{\\top}$，其中 $u \\in \\mathbb{R}^n$ 且 $\\|u\\|_2 = 1$。\n- **目标 1：** 确定所有这类 $P$ 的 $\\|P\\|_1$ 的精确上确界，作为 $n$ 的函数。\n- **目标 2：** 证明此上确界也是 $\\|P\\|_{\\infty}$ 的上确界。\n- **目标 3：** 解释为何存在 $\\|P\\|_2 = 1$ 但 $\\|P\\|_1$ 和 $\\|P\\|_{\\infty}$ 随 $n \\to \\infty$ 无界增长的正交投影子 $P$。\n- **目标 4：** 将此与形式为 $x \\mapsto Q D Q^{\\top} x$ 的方案的数值不稳定性联系起来，其中 $Q$ 是正交矩阵，$D$ 是对角元素为 $\\{0, 1\\}$ 的对角矩阵。\n- **最终答案要求：** $\\|P\\|_1$ 上确界的闭式解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在数学上是良定义的且自洽的。它基于数值线性代数的基本概念，包括诱导矩阵范数和正交投影子。所提供的定义是标准且正确的。所提出的问题是精确的，并且可以进行严格的数学求解。不存在科学或事实上的不健全之处，没有矛盾，没有歧义，且问题并非微不足道。构造 $P = u u^{\\top}$ 其中 $\\|u\\|_2 = 1$ 正确地定义了一个秩为一的正交投影子，因为 $P^{\\top} = (u u^{\\top})^{\\top} = u u^{\\top} = P$ 且 $P^2 = (u u^{\\top})(u u^{\\top}) = u(u^{\\top}u)u^{\\top} = u(\\|u\\|_2^2)u^{\\top} = u(1)u^{\\top} = P$。该问题是有效的。\n\n**步骤 3：结论与行动**\n问题有效。开始求解。\n\n设 $P = u u^{\\top}$，其中 $u \\in \\mathbb{R}^n$ 是一个列向量，其分量为 $u_i$，且 $\\|u\\|_2 = (\\sum_{i=1}^n u_i^2)^{1/2} = 1$。矩阵 $P$ 的元素由 $p_{ij} = u_i u_j$ 给出。\n\n首先，我们建立 $\\|P\\|_1$ 和 $\\|P\\|_{\\infty}$ 之间的关系。矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的诱导 $1$-范数是最大绝对列和，$\\|A\\|_1 = \\max_{1 \\le j \\le n} \\sum_{i=1}^n |a_{ij}|$。对于 $P = u u^{\\top}$，这变为：\n$$\n\\|P\\|_1 = \\max_{1 \\le j \\le n} \\sum_{i=1}^n |p_{ij}| = \\max_{1 \\le j \\le n} \\sum_{i=1}^n |u_i u_j| = \\max_{1 \\le j \\le n} \\left( |u_j| \\sum_{i=1}^n |u_i| \\right)\n$$\n和 $\\sum_{i=1}^n |u_i|$ 是向量 $u$ 的 $1$-范数，记为 $\\|u\\|_1$。该表达式可以从关于 $j$ 的最大化中提取出来：\n$$\n\\|P\\|_1 = \\left( \\sum_{i=1}^n |u_i| \\right) \\left( \\max_{1 \\le j \\le n} |u_j| \\right) = \\|u\\|_1 \\|u\\|_{\\infty}\n$$\n其中 $\\|u\\|_{\\infty} = \\max_{1 \\le j \\le n} |u_j|$ 是向量 $u$ 的无穷范数。\n\n类似地，矩阵 $A$ 的诱导 $\\infty$-范数是最大绝对行和，$\\|A\\|_{\\infty} = \\max_{1 \\le i \\le n} \\sum_{j=1}^n |a_{ij}|$。对于 $P = u u^{\\top}$：\n$$\n\\|P\\|_{\\infty} = \\max_{1 \\le i \\le n} \\sum_{j=1}^n |p_{ij}| = \\max_{1 \\le i \\le n} \\sum_{j=1}^n |u_i u_j| = \\max_{1 \\le i \\le n} \\left( |u_i| \\sum_{j=1}^n |u_j| \\right)\n$$\n这可以简化为：\n$$\n\\|P\\|_{\\infty} = \\left( \\max_{1 \\le i \\le n} |u_i| \\right) \\left( \\sum_{j=1}^n |u_j| \\right) = \\|u\\|_{\\infty} \\|u\\|_1\n$$\n因此，对于任何秩为一的投影子 $P = u u^{\\top}$ 且 $\\|u\\|_2 = 1$，我们有 $\\|P\\|_1 = \\|P\\|_{\\infty} = \\|u\\|_1 \\|u\\|_{\\infty}$。这直接意味着在指定的投影子族上，$\\|P\\|_1$ 的上确界等于 $\\|P\\|_{\\infty}$ 的上确界，从而证明了问题的第二部分。\n\n我们的主要任务简化为在满足约束条件 $\\|u\\|_2 = 1$ 的所有向量 $u \\in \\mathbb{R}^n$ 上，求函数 $f(u) = \\|u\\|_1 \\|u\\|_{\\infty}$ 的上确界。\n$$\n\\sup_{\\|u\\|_2=1} \\|u u^{\\top}\\|_1 = \\sup_{\\|u\\|_2=1} (\\|u\\|_1 \\|u\\|_{\\infty})\n$$\n设 $u$ 的分量为 $u_1, u_2, \\dots, u_n$。函数 $f(u)$ 仅取决于分量的绝对值 $|u_i|$。由于将 $u_i$ 替换为 $|u_i|$ 不会改变 $\\|u\\|_2$ 或 $\\|u\\|_{\\infty}$，并且不会减小 $\\|u\\|_1$，因此上确界将在一个具有非负分量的向量上达到。所以我们可以假设对所有 $i$ 都有 $u_i \\ge 0$。\n问题是在约束条件 $\\sum_{i=1}^n u_i^2 = 1$ 和 $u_i \\ge 0$ 下，最大化 $f(u) = (\\sum_{i=1}^n u_i) (\\max_{j} u_j)$。\n通过置换下标，我们可以假设 $u_1 \\ge u_2 \\ge \\dots \\ge u_n \\ge 0$。那么 $\\max_j u_j = u_1$。问题变为：\n在约束条件 $\\sum_{i=1}^n u_i^2 = 1$ 和 $u_1 \\ge u_2 \\ge \\dots \\ge u_n \\ge 0$ 下，最大化 $F(u_1, \\dots, u_n) = u_1 \\sum_{i=1}^n u_i$。\n\n对于固定的 $u_1$ 值，我们需要在约束 $\\sum_{i=2}^n u_i^2 = 1 - u_1^2$ 下最大化 $\\sum_{i=2}^n u_i$。根据 $\\mathbb{R}^{n-1}$ 中向量 $(1, 1, \\dots, 1)$ 和 $(u_2, \\dots, u_n)$ 的柯西-施瓦茨不等式：\n$$\n\\left(\\sum_{i=2}^n 1 \\cdot u_i\\right)^2 \\le \\left(\\sum_{i=2}^n 1^2\\right) \\left(\\sum_{i=2}^n u_i^2\\right) = (n-1)(1 - u_1^2)\n$$\n等号成立当且仅当向量 $(u_2, \\dots, u_n)$ 是 $(1, \\dots, 1)$ 的倍数，这意味着 $u_2 = u_3 = \\dots = u_n$。设 $c$ 为这个共同的值。\n约束 $u_1 \\ge u_2 \\ge \\dots$ 意味着 $u_1 \\ge c$。\n现在问题是在约束 $u_1^2 + (n-1)c^2 = 1$ 和 $u_1 \\ge c \\ge 0$ 下，最大化 $g(u_1, c) = u_1 (u_1 + (n-1)c)$。从约束条件，我们得到 $c = \\sqrt{\\frac{1-u_1^2}{n-1}}$。\n要最大化的函数变成只关于 $u_1$ 的函数：\n$$\nh(u_1) = u_1 \\left(u_1 + (n-1)\\sqrt{\\frac{1-u_1^2}{n-1}}\\right) = u_1^2 + u_1\\sqrt{(n-1)(1-u_1^2)}\n$$\n约束 $u_1 \\ge c$ 意味着 $u_1^2 \\ge c^2 = \\frac{1-u_1^2}{n-1}$，化简为 $(n-1)u_1^2 \\ge 1-u_1^2$，即 $nu_1^2 \\ge 1$，所以 $u_1 \\ge 1/\\sqrt{n}$。$u_1$ 的定义域是 $[1/\\sqrt{n}, 1]$。\n我们进行代换 $x = u_1^2$。我们想要在 $x \\in [1/n, 1]$ 上最大化 $k(x) = x + \\sqrt{x} \\sqrt{(n-1)(1-x)} = x + \\sqrt{n-1} \\sqrt{x-x^2}$。\n我们计算关于 $x$ 的导数：\n$$\nk'(x) = 1 + \\sqrt{n-1} \\frac{1-2x}{2\\sqrt{x-x^2}}\n$$\n令 $k'(x)=0$ 得 $2\\sqrt{x-x^2} = -\\sqrt{n-1}(1-2x)$。为使此等式成立，由于左侧非负，我们必须有 $1-2x \\le 0$，所以 $x \\ge 1/2$。两边平方：\n$4(x-x^2) = (n-1)(1-2x)^2 = (n-1)(1-4x+4x^2)$\n$4x - 4x^2 = (n-1) - 4(n-1)x + 4(n-1)x^2$\n$0 = (4n-4+4)x^2 - (4n-4+4)x + (n-1-0)$\n$4nx^2 - 4nx + (n-1) = 0$\n解这个关于 $x$ 的二次方程：\n$$\nx = \\frac{4n \\pm \\sqrt{16n^2 - 16n(n-1)}}{8n} = \\frac{4n \\pm \\sqrt{16n}}{8n} = \\frac{4n \\pm 4\\sqrt{n}}{8n} = \\frac{n \\pm \\sqrt{n}}{2n} = \\frac{1}{2} \\left(1 \\pm \\frac{1}{\\sqrt{n}}\\right)\n$$\n我们需要 $x \\ge 1/2$。解 $x = \\frac{1}{2}(1 - 1/\\sqrt{n})$ 小于 $1/2$（对于 $n>1$），因此是增根。唯一有效的临界点是 $x = \\frac{1}{2}(1 + 1/\\sqrt{n})$。该点在定义域 $[1/n, 1]$ 内，因为当 $n \\ge 2$ 时，$n+\\sqrt{n} \\ge 2$。\n我们在此临界点计算 $k(x)$ 的值。\n$1-x = 1 - \\frac{1}{2}(1+1/\\sqrt{n}) = \\frac{1}{2}(1-1/\\sqrt{n})$。\n$x-x^2 = x(1-x) = \\frac{1}{4}(1-1/n) = \\frac{n-1}{4n}$。\n$k(x)$ 的值为：\n$$\nk(x) = x + \\sqrt{n-1}\\sqrt{x-x^2} = \\frac{1}{2}\\left(1+\\frac{1}{\\sqrt{n}}\\right) + \\sqrt{n-1}\\sqrt{\\frac{n-1}{4n}} = \\frac{1}{2} + \\frac{1}{2\\sqrt{n}} + \\frac{n-1}{2\\sqrt{n}}\n$$\n$$\nk(x) = \\frac{1}{2} + \\frac{1+n-1}{2\\sqrt{n}} = \\frac{1}{2} + \\frac{n}{2\\sqrt{n}} = \\frac{1}{2} + \\frac{\\sqrt{n}}{2} = \\frac{1+\\sqrt{n}}{2}\n$$\n在边界 $x=1/n$ 处，值为 $1$。在 $x=1$ 处，值为 $1$。由于当 $n \\ge 2$ 时 $\\frac{1+\\sqrt{n}}{2} > 1$，这个临界点是最大值点。\n$\\|P\\|_1$ 的上确界（实际上是最大值）是 $\\frac{1+\\sqrt{n}}{2}$。\n\n接下来，我们解决问题的解释部分。\n对于任何非零的正交投影子 $P$，其诱导 $2$-范数为 $\\|P\\|_2=1$。这是因为任何向量 $x \\in \\mathbb{R}^n$ 都可以分解为正交分量 $x = Px + (I-P)x$。根据勾股定理，$\\|x\\|_2^2 = \\|Px\\|_2^2 + \\|(I-P)x\\|_2^2$。这意味着对所有 $x$，都有 $\\|Px\\|_2 \\le \\|x\\|_2$，所以 $\\|P\\|_2 \\le 1$。由于 $P$ 非零，其值域非平凡，因此存在一个向量 $v$ 使得 $Pv=v$。对于单位向量 $u = v/\\|v\\|_2$，我们有 $\\|u\\|_2=1$ 且 $\\|Pu\\|_2=\\|u\\|_2=1$。因此，$\\|P\\|_2 = \\sup_{\\|x\\|_2=1} \\|Px\\|_2 = 1$。\n\n我们已经证明，对于每个 $n \\ge 2$，都存在一个秩为一的投影子 $P_n$（即为达到最大值而构造的那个），它满足 $\\|P_n\\|_1 = \\|P_n\\|_{\\infty} = \\frac{1+\\sqrt{n}}{2}$。当 $n \\to \\infty$ 时，这个值无界增长，具体来说是 $O(\\sqrt{n})$。同时，对于这些投影子中的每一个，都有 $\\|P_n\\|_2 = 1$。这提供了所要求的例子。\n\n最后，我们将此与形如 $x \\mapsto Q D Q^{\\top} x$ 的方案的数值稳定性联系起来，其中 $Q$ 是正交矩阵，$D$ 是对角元素为零或一的对角矩阵。设 $P = Q D Q^{\\top}$。\n$P^{\\top}=(Q D Q^{\\top})^{\\top} = (Q^{\\top})^{\\top}D^{\\top}Q^{\\top} = Q D Q^{\\top} = P$。\n$P^2 = (Q D Q^{\\top})(Q D Q^{\\top}) = Q D (Q^{\\top}Q) D Q^{\\top} = Q D^2 Q^{\\top}$。\n由于 $D$ 的对角元素为 $0$ 或 $1$，所以 $d_{ii}^2 = d_{ii}$，即 $D^2 = D$。因此 $P^2=P$。\n算子 $P$ 是一个正交投影子。如前所述，$\\|P\\|_2=1$。\n这意味着操作 $x \\mapsto Px$ 在欧几里得范数（$\\ell_2$-范数）下是非扩张的，即 $\\|Px\\|_2 \\le \\|x\\|_2$。以 $\\ell_2$-范数度量的误差不会被放大。\n然而，数值稳定性通常关注的是分量级误差。误差向量 $\\delta x$ 的最大分量是 $\\|\\delta x\\|_{\\infty}$。输出中的结果误差是 $P\\delta x$。其最大分量是 $\\|P\\delta x\\|_{\\infty}$。我们有不等式 $\\|P\\delta x\\|_{\\infty} \\le \\|P\\|_{\\infty} \\|\\delta x\\|_{\\infty}$。\n$\\|P\\|_{\\infty}$ 可能很大（随 $n$ 增长）这一事实意味着，输入中的一个小的分量级误差可能导致输出中一个大的分量级误差。例如，如果我们取 $P$ 为 $\\|P\\|_{\\infty} = \\frac{1+\\sqrt{n}}{2}$ 的投影子之一，我们可以找到一个输入向量 $x$，其 $\\|x\\|_{\\infty}=1$，使得 $\\|Px\\|_{\\infty} = \\|P\\|_{\\infty}$。设 $|p_{ij}|$ 的第 $k$ 行和为最大。定义向量 $x$ 为 $x_j = \\mathrm{sgn}(p_{kj})$。那么 $\\|x\\|_{\\infty}=1$。$y=Px$ 的第 $k$ 个分量是 $y_k = \\sum_j p_{kj} x_j = \\sum_j |p_{kj}| = \\|P\\|_{\\infty}$。一个分量绝对值至多为 $1$ 的输入向量被变换为一个分量大小为 $\\frac{1+\\sqrt{n}}{2}$ 的向量。\n这种分量级幅度的放大是一种数值不稳定性。高维投影操作虽然在 $\\ell_2$ 意义下几何上很简单，但在计算环境中可能会产生问题，因为在这些环境中，量是以有限精度存储的，并且误差通常是在分量级（即 $\\ell_{\\infty}$）意义下有界的。",
            "answer": "$$\\boxed{\\frac{1+\\sqrt{n}}{2}}$$"
        },
        {
            "introduction": "现实世界中的问题常常涉及多个子空间的相互作用，这可以由一组投影算子来描述。本计算练习旨在深入探讨这组投影算子是否交换所带来的几何与代数后果。我们将量化算子间的非交换性，并研究其如何直接影响交替投影法这一重要算法的收敛速度。",
            "id": "3567703",
            "problem": "设计并实现一个程序，该程序针对 $\\mathbb{R}^n$ 上的几个明确指定的线性正交投影算子有限族，量化其非对易性并分析循环交替投影的收敛性。您的程序必须完全按照下文描述来构造每个投影算子族，仅使用线性代数定义从第一性原理计算所需量，并将所有结果聚合到指定格式的单行输出中。\n\n将使用的基本概念和定义：\n- （线性）投影算子是一个满足 $P^2 = P$ 的矩阵 $P \\in \\mathbb{R}^{n \\times n}$。正交投影算子额外满足 $P^\\top = P$。\n- 矩阵 $A$ 的算子范数 $\\lVert A \\rVert_2$ 是 $A$ 的最大奇异值。\n- 两个矩阵 $A$ 和 $B$ 的对易子是 $[A,B] := AB - BA$。\n- 给定一个投影算子族 $\\{P_i\\}_{i=1}^m$，循环交替投影映射为 $T := P_m P_{m-1} \\cdots P_1$。\n- 交子空间为 $\\mathcal{I} := \\bigcap_{i=1}^m \\operatorname{range}(P_i)$，投影到 $\\mathcal{I}$ 上的正交投影算子记为 $P_{\\cap}$。\n- 控制远离不动点的收敛性的误差传播算子是 $E := (I - P_{\\cap}) \\, T \\, (I - P_{\\cap})$。\n- 由 $\\{P_i\\}$ 和正权重 $\\{w_i\\}$ 导出的单位模糊分解是近似式 $\\sum_{i=1}^m w_i P_i \\approx I$。其偏差由算子范数 $\\left\\lVert \\sum_{i=1}^m w_i P_i - I \\right\\rVert_2$ 度量。\n\n角度单位说明：\n- 以下所有角度均以弧度为单位。\n\n您的程序必须为每个测试用例计算以下五个实数：\n- 最大成对乘积范数 $M_{\\text{prod}} := \\max_{i \\neq j} \\lVert P_i P_j \\rVert_2$。\n- 最大对易子范数 $M_{\\text{comm}} := \\max_{i  j} \\lVert P_i P_j - P_j P_i \\rVert_2$。\n- 单步收缩界 $C := \\lVert E \\rVert_2$，其中 $E$ 根据测试用例中的循环顺序按上文定义。\n- 经验渐进率 $R := \\lVert E^K \\rVert_2^{1/K}$，其中 $K = 20$。\n- 模糊分解偏差 $D := \\left\\lVert \\sum_{i=1}^m w_i P_i - I \\right\\rVert_2$，其中对所有 $i$ 都有 $w_i = \\frac{1}{m}$。\n\n您必须仅使用子空间相交从第一性原理构造 $P_{\\cap}$，不得使用任何关于 $P_{\\cap}$ 的先验公式。一种可接受的方法是为 $P_i$ 的值域构建标准正交基，通过主夹角确定它们的交集，提取出在合理容差内数值上等于 $1$ 的奇异值所对应的公共方向，然后将 $P_{\\cap}$ 构建为投影到所得交集基上的正交投影算子。\n\n测试套件：\n所有测试用例都在 $\\mathbb{R}^3$ 中，使用标准基 $e_1 = (1,0,0)^\\top$, $e_2 = (0,1,0)^\\top$, $e_3 = (0,0,1)^\\top$。\n\n- 测试用例 $1$（近对易对，二维子空间）：\n  - 设 $\\theta = 0.1$。\n  - 定义 $P_1$ 为投影到 $\\operatorname{span}\\{e_1,e_2\\}$ 上的正交投影算子。\n  - 定义 $P_2$ 为投影到 $\\operatorname{span}\\{e_1, u_\\theta\\}$ 上的正交投影算子，其中 $u_\\theta = (0,\\cos\\theta,\\sin\\theta)^\\top$。\n  - 循环顺序：$T = P_2 P_1$。\n  - 权重：$w_1 = w_2 = \\frac{1}{2}$。\n\n- 测试用例 $2$（强非对易对，二维子空间）：\n  - 设 $\\phi = 0.9$。\n  - 定义 $P_1$ 为投影到 $\\operatorname{span}\\{e_1,e_2\\}$ 上的正交投影算子。\n  - 定义 $P_2$ 为投影到 $\\operatorname{span}\\{v_\\phi,e_3\\}$ 上的正交投影算子，其中 $v_\\phi = (\\cos\\phi,\\sin\\phi,0)^\\top$。\n  - 循环顺序：$T = P_2 P_1$。\n  - 权重：$w_1 = w_2 = \\frac{1}{2}$。\n\n- 测试用例 $3$（对易嵌套对）：\n  - 定义 $P_1$ 为投影到 $\\operatorname{span}\\{e_1,e_2\\}$ 上的正交投影算子。\n  - 定义 $P_2$ 为投影到 $\\operatorname{span}\\{e_1\\}$ 上的正交投影算子。\n  - 循环顺序：$T = P_2 P_1$。\n  - 权重：$w_1 = w_2 = \\frac{1}{2}$。\n\n- 测试用例 $4$（构成单位模糊分解的三个平面）：\n  - 设 $n_1 = e_1$，$n_2 = e_2$ 和 $n_3 = \\frac{1}{\\sqrt{3}} (1,1,1)^\\top$。\n  - 对每个 $i \\in \\{1,2,3\\}$，定义 $P_i = I - n_i n_i^\\top$，即投影到与 $n_i$ 正交的平面上的正交投影算子。\n  - 循环顺序：$T = P_3 P_2 P_1$。\n  - 权重：$w_1 = w_2 = w_3 = \\frac{1}{3}$。\n\n对每个测试用例，按规定计算 $(M_{\\text{prod}}, M_{\\text{comm}}, C, R, D)$。将每个值四舍五入到恰好 $6$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表，每个测试用例对应一个子列表，每个子列表按 $[M_{\\text{prod}}, M_{\\text{comm}}, C, R, D]$ 顺序排列，所有数值四舍五入到 $6$ 位小数，不含空格。例如：\"[[a,b,c,d,e],[a,b,c,d,e],[a,b,c,d,e],[a,b,c,d,e]]\"。\n- 不应打印任何额外文本。",
            "solution": "该问题提出了一个数值线性代数领域中有效且适定的任务。它要求为正交投影算子族计算若干与非对易性和收敛性相关的特定度量。所有定义都是标准的，测试用例是明确构造的，所需量都有明确无歧义的定义。该问题在科学上是合理的，在计算上是可行的。\n\n解决方案首先基于基本的线性代数原理建立一个稳健的计算方法，然后将此方法应用于四个指定的测试用例中的每一个。\n\n### 通用方法\n\n**1. 正交投影算子的构造**\n\n投影到线性子空间 $\\mathcal{S} \\subset \\mathbb{R}^n$ 上的正交投影算子 $P$ 是一个对称的幂等矩阵（$P=P^\\top$, $P^2=P$）。如果子空间 $\\mathcal{S}$ 由一组向量 $\\{v_1, \\dots, v_k\\}$ 的张成空间定义，则投影算子 $P$ 可以按如下方式构造：\n首先，从张成向量集中提取 $\\mathcal{S}$ 的一个标准正交基。设矩阵 $A \\in \\mathbb{R}^{n \\times k}$ 的列是向量 $v_j$。为 $A$ 的列空间 $\\operatorname{range}(A) = \\mathcal{S}$ 寻找标准正交基的一种数值稳定方法是计算 $A$ 的瘦 QR 分解，使得 $A=QR$，其中 $Q \\in \\mathbb{R}^{n \\times r}$ 有 $r$ 个标准正交列（$r=\\operatorname{rank}(A)$），$R$ 是一个上三角矩阵。$Q$ 的列构成了所需的标准正交基。\n投影到 $\\mathcal{S}$ 上的正交投影算子由矩阵乘积给出：\n$$\nP = Q Q^\\top\n$$\n此公式将用于从指定的张成向量集构造所有投影算子 $P_i$。\n\n**2. 交集投影算子 $P_{\\cap}$ 的计算**\n\n问题要求从第一性原理构造投影到交子空间 $\\mathcal{I} := \\bigcap_{i=1}^m \\operatorname{range}(P_i)$ 上的投影算子 $P_{\\cap}$。尽管提示建议了基于主夹角的方法，但我们将采用一种更直接且可扩展的方法。该方法基于以下定理：\n\n一个向量 $v$ 位于一族正交投影算子 $\\{P_i\\}_{i=1}^m$ 的值域交集中的充要条件是，它是求和矩阵 $S = \\sum_{i=1}^m P_i$ 的特征向量，且对应的特征值为 $m$。\n\n*证明*：如果 $v \\in \\mathcal{I}$，那么对所有 $i$ 都有 $v \\in \\operatorname{range}(P_i)$。由于 $P_i$ 是正交投影算子，这意味着对所有 $i$ 都有 $P_i v = v$。对 $i$ 求和得到 $S v = \\left(\\sum_{i=1}^m P_i\\right) v = \\sum_{i=1}^m (P_i v) = \\sum_{i=1}^m v = m v$。\n反之，假设 $S v = m v$。对于任何投影算子 $P_i$，我们有 $\\|v\\|^2 \\ge \\|P_i v\\|^2$。对投影误差的平方范数求和得到 $\\sum_{i=1}^m \\|v - P_i v\\|^2 = \\sum_{i=1}^m (v - P_i v)^\\top (v - P_i v) = \\sum_{i=1}^m (v^\\top v - 2 v^\\top P_i v + v^\\top P_i^\\top P_i v)$。因为 $P_i = P_i^\\top = P_i^2$，这可以简化为 $\\sum_{i=1}^m (\\|v\\|^2 - \\|P_i v\\|^2) = m\\|v\\|^2 - \\sum_{i=1}^m \\|P_i v\\|^2$。另外，将 $Sv=mv$ 与 $v$ 作内积得到 $v^\\top S v = m\\|v\\|^2$。由于 $S$ 是对称的，$v^\\top S v = v^\\top (\\sum P_i) v = \\sum v^\\top P_i v = \\sum v^\\top P_i^\\top P_i v = \\sum \\|P_i v\\|^2$。令 $\\sum \\|P_i v\\|^2$ 的两个表达式相等，得到 $m\\|v\\|^2 = \\sum \\|P_i v\\|^2$。这意味着 $\\sum_{i=1}^m (\\|v\\|^2 - \\|P_i v\\|^2) = 0$。由于每一项 $\\|v\\|^2 - \\|P_i v\\|^2 \\ge 0$，所以和为零的唯一可能是每一项都为零，即对所有 $i$ 都有 $\\|v\\|^2 = \\|P_i v\\|^2$。这个条件成立的充要条件是，对所有 $i$ 都有 $P_i v = v$，这意味着对所有 $i$ 都有 $v \\in \\operatorname{range}(P_i)$。因此，$v \\in \\mathcal{I}$。\n\n这个定理为寻找 $P_\\cap$ 提供了以下算法：\n1.  构造求和矩阵 $S = \\sum_{i=1}^m P_i$。\n2.  计算对称矩阵 $S$ 的特征值和特征向量。\n3.  识别出那些对应特征值在数值上等于 $m$（在一个小容差范围内，例如 $10^{-9}$）的特征向量。这些特征向量构成了交子空间 $\\mathcal{I}$ 的一个基。由于它们来自于单个矩阵的对称特征求解器，它们已经是正交的。\n4.  构成一个矩阵 $Q_\\cap$，其列是这些标准正交基向量。\n5.  构造投影算子 $P_\\cap = Q_\\cap Q_\\cap^\\top$。如果不存在这样的特征向量，则交集是平凡子空间 $\\{0\\}$，$P_\\cap$ 是零矩阵。\n\n**3. 所需度量的计算**\n\n对于每个测试用例，五个指定的度量按如下方式计算。算子范数 $\\left\\lVert A \\right\\rVert_2$ 被计算为矩阵 $A$ 的最大奇异值。\n\n*   **最大成对乘积范数, $M_{\\text{prod}}$**：\n    $$M_{\\text{prod}} := \\max_{i \\neq j} \\lVert P_i P_j \\rVert_2$$\n    通过遍历所有不同的对 $(i, j)$，计算乘积 $P_i P_j$ 的算子范数，并找出最大值来计算。\n\n*   **最大对易子范数, $M_{\\text{comm}}$**：\n    $$M_{\\text{comm}} := \\max_{i  j} \\lVert P_i P_j - P_j P_i \\rVert_2$$\n    这个量化了非对易性的程度。它通过遍历所有满足 $i  j$ 的对 $(i, j)$，构造对易子 $[P_i, P_j] = P_i P_j - P_j P_i$，计算其范数，并找出最大值来计算。\n\n*   **单步收缩界, $C$**：\n    $$C := \\lVert E \\rVert_2 \\quad \\text{where} \\quad E := (I - P_{\\cap}) \\, T \\, (I - P_{\\cap})$$\n    首先构成循环乘积 $T$, $T = P_m \\cdots P_1$。然后如上所述计算 $P_{\\cap}$。组装误差算子 $E$，并计算其算子范数。\n\n*   **经验渐进率, $R$**：\n    $$R := \\lVert E^K \\rVert_2^{1/K} \\quad \\text{with} \\quad K = 20$$\n    将矩阵 $E$ 升至 $K=20$ 次幂。计算所得矩阵 $E^{20}$ 的算子范数，然后取 $K$ 次方根。这近似于 $E$ 的谱半径，该谱半径决定了长期收敛率。\n\n*   **模糊分解偏差, $D$**：\n    $$D := \\left\\lVert \\sum_{i=1}^m w_i P_i - I \\right\\rVert_2$$\n    使用给定的权重 $w_i=1/m$ 计算投影算子的加权和 $\\sum_i w_i P_i$。减去单位矩阵 $I$，并计算所得偏差矩阵的算子范数。\n\n对问题陈述中定义的四个测试用例，系统地执行这些步骤。最终的数值结果四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef create_projector_from_basis(basis_vectors):\n    \"\"\"\n    Creates an orthogonal projector matrix onto the subspace spanned by the given vectors.\n    \n    Args:\n        basis_vectors (list of np.ndarray): A list of vectors spanning the subspace.\n    \n    Returns:\n        np.ndarray: The projector matrix.\n    \"\"\"\n    if not basis_vectors:\n        return np.zeros((3, 3)) # Assuming R^3 from problem context\n    \n    A = np.array(basis_vectors, dtype=float).T\n    \n    # Check for empty or zero matrix to avoid QR decomposition issues\n    if A.shape[1] == 0:\n        return np.zeros((A.shape[0], A.shape[0]))\n    if np.allclose(A, 0):\n        return np.zeros((A.shape[0], A.shape[0]))\n    \n    # Use QR decomposition to find an orthonormal basis for the column space\n    q, _ = np.linalg.qr(A)\n    \n    # The projector is P = Q * Q^T\n    return q @ q.T\n\ndef compute_intersection_projector(projectors):\n    \"\"\"\n    Computes the orthogonal projector onto the intersection of the ranges of given projectors.\n    \n    Args:\n        projectors (list of np.ndarray): A list of orthogonal projector matrices.\n        \n    Returns:\n        np.ndarray: The projector onto the intersection subspace.\n    \"\"\"\n    if not projectors:\n        # The intersection of an empty set of subspaces is the whole space.\n        # This case is not hit by the problem spec, but included for completeness.\n        return np.eye(3) \n\n    m = len(projectors)\n    n = projectors[0].shape[0]\n    \n    # Sum the projector matrices\n    S = np.sum(projectors, axis=0)\n    \n    # The intersection is the eigenspace of S for eigenvalue m.\n    # Use eigh for symmetric matrices.\n    eigenvalues, eigenvectors = np.linalg.eigh(S)\n    \n    # Find eigenvectors corresponding to eigenvalue m using a tolerance\n    tol = 1e-9\n    intersection_basis_indices = np.where(np.abs(eigenvalues - m)  tol)[0]\n    \n    if len(intersection_basis_indices) == 0:\n        # Intersection is the trivial subspace {0}\n        return np.zeros((n, n))\n    \n    # Eigenvectors from eigh for a symmetric matrix are orthonormal\n    Q_intersect = eigenvectors[:, intersection_basis_indices]\n    \n    return Q_intersect @ Q_intersect.T\n\ndef analyze_projector_family(projectors, cyclic_order_indices, weights):\n    \"\"\"\n    Computes the five specified metrics for a family of projectors.\n    \n    Args:\n        projectors (list of np.ndarray): The family of projectors {P_i}.\n        cyclic_order_indices (list of int): 1-based indices for the cyclic product T.\n        weights (list of float): weights {w_i} for the fuzzy partition.\n        \n    Returns:\n        tuple: A tuple containing (M_prod, M_comm, C, R, D).\n    \"\"\"\n    m = len(projectors)\n    n = projectors[0].shape[0]\n    I = np.eye(n)\n    \n    # 1. Maximum pairwise product norm, M_prod\n    max_prod_norm = 0.0\n    if m > 1:\n        for i in range(m):\n            for j in range(m):\n                if i == j:\n                    continue\n                prod_norm = np.linalg.norm(projectors[i] @ projectors[j], 2)\n                if prod_norm > max_prod_norm:\n                    max_prod_norm = prod_norm\n    M_prod = max_prod_norm\n\n    # 2. Maximum commutator norm, M_comm\n    max_comm_norm = 0.0\n    if m > 1:\n        for i in range(m):\n            for j in range(i + 1, m):\n                commutator = projectors[i] @ projectors[j] - projectors[j] @ projectors[i]\n                comm_norm = np.linalg.norm(commutator, 2)\n                if comm_norm > max_comm_norm:\n                    max_comm_norm = comm_norm\n    M_comm = max_comm_norm\n\n    # 3. and 4. One-step contraction C and empirical rate R\n    # Build cyclic product T\n    T = I\n    # The problem specifies T := P_m P_{m-1} ... P_1, which means P_1 acts on a vector first.\n    # In matrix multiplication, this product is P_m @ P_{m-1} @ ... @ P_1.\n    # Our loop T = P_{idx} @ T with idx = 1, 2, ... m will compute P_m @ ... @ P_1 @ I.\n    for idx in cyclic_order_indices:\n        T = projectors[idx-1] @ T\n    \n    # Build intersection projector P_cap\n    P_cap = compute_intersection_projector(projectors)\n    \n    # Build error operator E\n    E = (I - P_cap) @ T @ (I - P_cap)\n    \n    # C = ||E||_2\n    C = np.linalg.norm(E, 2)\n    \n    # R = ||E^K||_2^(1/K) with K=20\n    K = 20\n    E_pow_K = np.linalg.matrix_power(E, K)\n    norm_E_pow_K = np.linalg.norm(E_pow_K, 2)\n    # Handle the case where the norm is zero to avoid 0^_ power issues\n    R = norm_E_pow_K**(1/K) if norm_E_pow_K > 0 else 0.0\n\n    # 5. Fuzzy partition deviation D\n    sum_wP = np.zeros_like(I)\n    for i in range(m):\n        sum_wP += weights[i] * projectors[i]\n    \n    D = np.linalg.norm(sum_wP - I, 2)\n    \n    return M_prod, M_comm, C, R, D\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run analysis, and print results.\n    \"\"\"\n    e1 = np.array([1., 0., 0.])\n    e2 = np.array([0., 1., 0.])\n    e3 = np.array([0., 0., 1.])\n    \n    test_cases = []\n    \n    # Test case 1\n    theta = 0.1\n    u_theta = np.array([0., np.cos(theta), np.sin(theta)])\n    P1_1 = create_projector_from_basis([e1, e2])\n    P1_2 = create_projector_from_basis([e1, u_theta])\n    test_cases.append({\n        \"projectors\": [P1_1, P1_2],\n        \"cyclic_order\": [1, 2], # T = P2 * P1\n        \"weights\": [0.5, 0.5]\n    })\n    \n    # Test case 2\n    phi = 0.9\n    v_phi = np.array([np.cos(phi), np.sin(phi), 0.])\n    P2_1 = create_projector_from_basis([e1, e2])\n    P2_2 = create_projector_from_basis([v_phi, e3])\n    test_cases.append({\n        \"projectors\": [P2_1, P2_2],\n        \"cyclic_order\": [1, 2], # T = P2 * P1\n        \"weights\": [0.5, 0.5]\n    })\n    \n    # Test case 3\n    P3_1 = create_projector_from_basis([e1, e2])\n    P3_2 = create_projector_from_basis([e1])\n    test_cases.append({\n        \"projectors\": [P3_1, P3_2],\n        \"cyclic_order\": [1, 2], # T = P2 * P1\n        \"weights\": [0.5, 0.5]\n    })\n    \n    # Test case 4\n    n1 = e1\n    n2 = e2\n    n3 = (1./np.sqrt(3.)) * np.array([1., 1., 1.])\n    I3 = np.eye(3)\n    P4_1 = I3 - np.outer(n1, n1)\n    P4_2 = I3 - np.outer(n2, n2)\n    P4_3 = I3 - np.outer(n3, n3)\n    test_cases.append({\n        \"projectors\": [P4_1, P4_2, P4_3],\n        \"cyclic_order\": [1, 2, 3], # T = P3 * P2 * P1\n        \"weights\": [1./3., 1./3., 1./3.]\n    })\n\n    all_results = []\n    for case in test_cases:\n        results = analyze_projector_family(\n            case[\"projectors\"],\n            case[\"cyclic_order\"],\n            case[\"weights\"]\n        )\n        \n        # Format results to 6 decimal places\n        formatted_results = [\"{:.6f}\".format(r) for r in results]\n        all_results.append(f\"[{','.join(formatted_results)}]\")\n\n    print(f\"[{','.join(all_results)}]\")\n    \n\nsolve()\n```"
        }
    ]
}