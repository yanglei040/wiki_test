{
    "hands_on_practices": [
        {
            "introduction": "此练习探讨了数据分析和控制理论中的一个基本问题：一个系统对扰动的鲁棒性如何？我们将使用弗罗贝尼乌斯范数来衡量一个给定的满秩矩阵与最近的奇异（秩亏）矩阵之间的“距离”。这个练习提供了埃卡特-杨-米尔斯基定理的一个具体应用，并展示了奇异值，特别是最小奇异值，如何量化一个矩阵的稳定性。",
            "id": "1397974",
            "problem": "在许多领域，例如数据分析和控制理论中，系统的行为由一个矩阵来建模。这个矩阵的秩是一个基本属性，其稳定性通常与该矩阵在秩发生变化前可以被扰动的程度有关。这种扰动的大小可以用各种矩阵范数来量化。\n\n考虑一个由矩阵 $A = \\begin{pmatrix} 3  1 \\\\ 0  3 \\end{pmatrix}$ 表示的线性变换。该变换将二维空间中的向量映射到另一个二维空间。矩阵 $A$ 是满秩的。我们感兴趣的是找到对该矩阵的最小可能扰动，使得变换不再是满秩的（即秩为1或0）。\n\n设 $E$ 是一个 $2 \\times 2$ 的扰动矩阵。这个扰动的大小由弗罗贝尼乌斯范数（Frobenius norm）衡量，其定义为 $\\|E\\|_F = \\sqrt{\\sum_{i=1}^2 \\sum_{j=1}^2 |E_{ij}|^2}$。\n\n确定最小弗罗贝尼乌斯范数 $\\min \\|E\\|_F$ 的精确值，使得扰动后的矩阵 $A+E$ 的秩最多为1。请用一个单一的、封闭形式的解析表达式来表示你的答案。",
            "solution": "我们寻求扰动矩阵 $E$ 的最小弗罗贝尼乌斯范数，使得对于 $A=\\begin{pmatrix}3  1 \\\\ 0  3\\end{pmatrix}$，有 $\\operatorname{rank}(A+E) \\leq 1$。这等价于矩阵 $A$ 到秩最多为1的矩阵集合的距离（在弗罗贝尼乌斯范数下）。根据关于酉不变范数的 Eckart–Young–Mirsky 定理，矩阵 $A$ 到秩最多为1的矩阵集合在弗罗贝尼乌斯范数下的距离，等于 $A$ 的所有奇异值中除了最大奇异值之外的其余奇异值的平方和的平方根。对于一个 $2 \\times 2$ 矩阵，这个最小值就是较小的那个奇异值 $\\sigma_{2}$。\n\n因此，我们计算 $A$ 的奇异值。奇异值是 $A^{T}A$ 的特征值的平方根。首先计算\n$$\nA^{T}A=\\begin{pmatrix}3  0 \\\\ 1  3\\end{pmatrix}\\begin{pmatrix}3  1 \\\\ 0  3\\end{pmatrix}\n=\\begin{pmatrix}9  3 \\\\ 3  10\\end{pmatrix}.\n$$\n设 $\\lambda$ 是 $A^{T}A$ 的一个特征值。其特征多项式为\n$$\n\\det\\!\\left(\\begin{pmatrix}9  3 \\\\ 3  10\\end{pmatrix}-\\lambda I\\right)\n=(9-\\lambda)(10-\\lambda)-9\n=\\lambda^{2}-19\\lambda+81.\n$$\n判别式为\n$$\n\\Delta=19^{2}-4\\cdot 81=361-324=37,\n$$\n所以特征值为\n$$\n\\lambda_{\\pm}=\\frac{19\\pm\\sqrt{37}}{2}.\n$$\n因此，奇异值为\n$$\n\\sigma_{1}=\\sqrt{\\frac{19+\\sqrt{37}}{2}},\\qquad \\sigma_{2}=\\sqrt{\\frac{19-\\sqrt{37}}{2}}.\n$$\n根据关于弗罗贝尼乌斯范数的 Eckart–Young–Mirsky 定理，使得 $\\operatorname{rank}(A+E)\\leq 1$ 的扰动 $E$ 的最小弗罗贝尼乌斯范数等于 $\\sigma_{2}$。因此\n$$\n\\min\\|E\\|_{F}=\\sqrt{\\frac{19-\\sqrt{37}}{2}}.\n$$",
            "answer": "$$\\boxed{\\sqrt{\\frac{19-\\sqrt{37}}{2}}}$$"
        },
        {
            "introduction": "在范数与奇异值之间建立联系的基础上，本练习深入探讨了弗罗贝尼乌斯范数的结构特性。你将从迹算子出发，推导出一个矩阵的弗罗贝尼乌斯范数与其奇异值平方和之间的重要恒等式。这个练习对于理解低秩近似以及像截断SVD这类方法的误差分析至关重要。",
            "id": "3547391",
            "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 的秩为 $r$，其奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其对角线上的元素为非负值 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\cdots \\ge \\sigma_{r} > 0$，其后为零。对于满足 $1 \\le k \\le r$ 的固定整数 $k$，定义秩-$k$ 截断近似 $A_{k} := U \\Sigma_{k} V^{\\top}$，其中 $\\Sigma_{k}$ 是通过仅保留 $\\Sigma$ 的前 $k$ 个最大的对角元素并将所有其他对角元素置为 0 得到的。\n\n仅从线性代数的基本定义和常用事实出发，包括：\n- 弗罗贝尼乌斯范数 $\\|A\\|_{F} = \\sqrt{\\sum_{i=1}^{m} \\sum_{j=1}^{n} a_{ij}^{2}}$ 的定义，\n- 迹算子 $\\mathrm{trace}(\\cdot)$ 的定义，及其在乘积有定义时的循环不变性 $\\mathrm{trace}(XYZ) = \\mathrm{trace}(ZXY)$，\n- $U$ 和 $V$ 的正交性，即 $U^{\\top} U = I$ 和 $V^{\\top} V = I$，\n\n完成以下任务：\n- 通过基于这些原理的推导，解释将 $A$ 的 SVD 截断为 $A_{k}$ 如何影响弗罗贝尼乌斯范数，包括为将 $\\|A\\|_{F}^{2}$ 分解为与 $A_{k}$ 和残差 $A - A_{k}$ 相关的平方和的毕达哥拉斯型分解提供理由。\n- 用奇异值 $\\sigma_{1}, \\ldots, \\sigma_{r}$ 和截断水平 $k$ 显式计算弗罗贝尼乌斯范数 $\\|A_{k}\\|_{F}$。\n\n你的最终答案必须是关于 $\\sigma_{1}, \\ldots, \\sigma_{r}$ 和 $k$ 的单个闭式解析表达式。不需要数值计算，也不需要四舍五入。最终答案无需单位。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题适定、客观且内部一致，是数值线性代数中的一个标准练习。我们按要求进行推导。\n\n我们的出发点是矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 的弗罗贝尼乌斯范数与迹算子之间的关系。弗罗贝尼乌斯范数的平方定义为其所有元素平方的总和：\n$$\n\\|A\\|_{F}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} a_{ij}^{2}\n$$\n方阵的迹是其对角线元素的总和。考虑矩阵乘积 $A^{\\top} A$，这是一个 $n \\times n$ 矩阵。该乘积第 $j$ 行第 $j$ 列的元素由下式给出：\n$$\n(A^{\\top} A)_{jj} = \\sum_{i=1}^{m} (A^{\\top})_{ji} A_{ij} = \\sum_{i=1}^{m} a_{ij} a_{ij} = \\sum_{i=1}^{m} a_{ij}^{2}\n$$\n$A^{\\top} A$ 的迹是这些对角元素的总和：\n$$\n\\mathrm{trace}(A^{\\top} A) = \\sum_{j=1}^{n} (A^{\\top} A)_{jj} = \\sum_{j=1}^{n} \\sum_{i=1}^{m} a_{ij}^{2}\n$$\n通过将其与弗罗贝尼乌斯范数的定义进行比较，我们建立了基本恒等式：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(A^{\\top} A)\n$$\n现在我们将此恒等式应用于 $A$ 的奇异值分解 (SVD)，即 $A = U \\Sigma V^{\\top}$。$A$ 的转置是 $A^{\\top} = (U \\Sigma V^{\\top})^{\\top} = V \\Sigma^{\\top} U^{\\top}$。将这些代入迹表达式中：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}( (V \\Sigma^{\\top} U^{\\top}) (U \\Sigma V^{\\top}) )\n$$\n由于 $U$ 是正交矩阵，有 $U^{\\top} U = I$，其中 $I$ 是 $m \\times m$ 的单位矩阵。表达式简化为：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(V \\Sigma^{\\top} \\Sigma V^{\\top})\n$$\n使用迹的循环性质 $\\mathrm{trace}(XYZ) = \\mathrm{trace}(ZXY)$，我们可以重新排列矩阵：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(V^{\\top} V \\Sigma^{\\top} \\Sigma)\n$$\n由于 $V$ 也是正交矩阵，有 $V^{\\top} V = I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。这导致：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(\\Sigma^{\\top} \\Sigma)\n$$\n矩阵 $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 的主对角线上有非负实数 $\\sigma_i$，其他位置为零。矩阵 $\\Sigma^{\\top} \\Sigma$ 是一个 $n \\times n$ 的对角矩阵。其对角元素是 $A$ 的奇异值的平方。具体来说，对于 $i=1, \\dots, \\min(m, n)$，有 $(\\Sigma^{\\top} \\Sigma)_{ii} = \\sigma_{i}^{2}$，对于 $i > \\min(m, n)$，有 $(\\Sigma^{\\top} \\Sigma)_{ii} = 0$。由于 $A$ 的秩为 $r$，我们知道当 $i \\le r$ 时 $\\sigma_i > 0$，当 $i > r$ 时 $\\sigma_i = 0$。迹是这些对角元素的和：\n$$\n\\|A\\|_{F}^{2} = \\sum_{i=1}^{r} \\sigma_{i}^{2}\n$$\n这将弗罗贝尼乌斯范数与矩阵的奇异值联系起来。\n\n现在，我们分析截断 SVD 的效果。秩-$k$ 近似为 $A_k = U \\Sigma_k V^{\\top}$，残差为 $A - A_k$。让我们检查残差的结构：\n$$\nA - A_k = U \\Sigma V^{\\top} - U \\Sigma_k V^{\\top} = U (\\Sigma - \\Sigma_k) V^{\\top}\n$$\n矩阵 $\\Sigma_k$ 是通过保留 $\\Sigma$ 的前 $k$ 个奇异值并将其余奇异值置零而形成的。因此，矩阵 $\\Sigma - \\Sigma_k$ 是一个对角矩阵（在矩形意义上），其对角线上的元素在索引 $i=1, \\dots, k$ 时为 0，在索引 $i = k+1, \\dots, r$ 时为 $\\sigma_i$。表达式 $U (\\Sigma - \\Sigma_k) V^{\\top}$ 是残差矩阵 $A - A_k$ 的 SVD，其奇异值为 $\\{\\sigma_{k+1}, \\sigma_{k+2}, \\dots, \\sigma_r\\}$。\n\n为了证明毕达哥拉斯型分解，我们考虑 $A$ 的弗罗贝尼乌斯范数的平方：\n$$\n\\|A\\|_{F}^{2} = \\|A_k + (A - A_k)\\|_{F}^{2}\n$$\n弗罗贝尼乌斯范数由弗罗贝尼乌斯内积导出，定义为 $\\langle X, Y \\rangle_F = \\mathrm{trace}(X^{\\top} Y)$。对于此类范数，我们有性质 $\\|X+Y\\|_{F}^{2} = \\|X\\|_{F}^{2} + \\|Y\\|_{F}^{2} + 2\\langle X, Y \\rangle_F$。我们需要证明 $A_k$ 和 $A-A_k$ 在此内积下是正交的，即 $\\langle A_k, A - A_k \\rangle_F = 0$。\n$$\n\\langle A_k, A - A_k \\rangle_F = \\mathrm{trace}(A_k^{\\top} (A - A_k))\n$$\n代入 SVD 形式：\n$$\nA_k^{\\top}(A - A_k) = (U \\Sigma_k V^{\\top})^{\\top} (U (\\Sigma - \\Sigma_k) V^{\\top}) = (V \\Sigma_k^{\\top} U^{\\top}) (U (\\Sigma - \\Sigma_k) V^{\\top})\n$$\n使用 $U^{\\top} U = I$，上式简化为 $V \\Sigma_k^{\\top} (\\Sigma - \\Sigma_k) V^{\\top}$。现在我们取迹并应用循环性质：\n$$\n\\mathrm{trace}(V \\Sigma_k^{\\top} (\\Sigma - \\Sigma_k) V^{\\top}) = \\mathrm{trace}(V^{\\top} V \\Sigma_k^{\\top} (\\Sigma - \\Sigma_k)) = \\mathrm{trace}(\\Sigma_k^{\\top} (\\Sigma - \\Sigma_k))\n$$\n矩阵乘积 $\\Sigma_k^{\\top} (\\Sigma - \\Sigma_k)$ 是一个对角矩阵。其第 $i$ 个对角元素是 $\\Sigma_k$（转置后）和 $\\Sigma - \\Sigma_k$ 的第 $i$ 个对角元素的乘积。$\\Sigma_k$ 的对角线包含 $\\{\\sigma_1, \\dots, \\sigma_k, 0, \\dots\\}$。$\\Sigma-\\Sigma_k$ 的对角线包含 $\\{0, \\dots, 0, \\sigma_{k+1}, \\dots, \\sigma_r, 0, \\dots\\}$。对于任何索引 $i$，要么 $\\Sigma_k$ 的对角线的第 $i$ 个元素为零（当 $i>k$ 时），要么 $(\\Sigma-\\Sigma_k)$ 的对角线的第 $i$ 个元素为零（当 $i \\le k$ 时）。因此，它们的乘积始终为零。矩阵 $\\Sigma_k^{\\top} (\\Sigma - \\Sigma_k)$ 是零矩阵，其迹为 0。\n由于 $\\langle A_k, A - A_k \\rangle_F = 0$，毕达哥拉斯型关系成立：\n$$\n\\|A\\|_{F}^{2} = \\|A_k\\|_{F}^{2} + \\|A - A_k\\|_{F}^{2}\n$$\n此分解表明 $A$ 的弗罗贝尼乌斯范数的平方被划分到其秩-$k$ 近似和残差之间。\n\n最后，我们显式计算 $A_k$ 的弗罗贝尼乌斯范数。推导过程与 $\\|A\\|_F$ 的推导过程相同。我们使用恒等式 $\\|A_k\\|_{F}^{2} = \\mathrm{trace}(A_k^{\\top} A_k)$。\n$$\n\\|A_k\\|_{F}^{2} = \\mathrm{trace}((U \\Sigma_k V^{\\top})^{\\top} (U \\Sigma_k V^{\\top})) = \\mathrm{trace}(V \\Sigma_k^{\\top} U^{\\top} U \\Sigma_k V^{\\top})\n$$\n使用 $U^{\\top}U = I$ 和迹的循环性质以及 $V^{\\top}V = I$：\n$$\n\\|A_k\\|_{F}^{2} = \\mathrm{trace}(V \\Sigma_k^{\\top} \\Sigma_k V^{\\top}) = \\mathrm{trace}(\\Sigma_k^{\\top} \\Sigma_k)\n$$\n矩阵 $\\Sigma_k^{\\top} \\Sigma_k$ 是一个 $n \\times n$ 的对角矩阵，其对角元素为 $\\sigma_1^2, \\dots, \\sigma_k^2$，其余为零。迹是这些对角元素的和：\n$$\n\\|A_k\\|_{F}^{2} = \\sum_{i=1}^{k} \\sigma_{i}^{2}\n$$\n取平方根即可得到秩-$k$ 近似的弗罗贝尼乌斯范数：\n$$\n\\|A_k\\|_{F} = \\sqrt{\\sum_{i=1}^{k} \\sigma_{i}^{2}}\n$$\n此表达式即为所求的最终答案。",
            "answer": "$$\n\\boxed{\\sqrt{\\sum_{i=1}^{k} \\sigma_{i}^{2}}}\n$$"
        },
        {
            "introduction": "这最后一个练习通过研究范数选择在数值算法中的实际后果，将理论与计算联系起来。通过设计一个“最坏情况”场景，你将分析使用弗罗贝尼乌斯范数与谱范数作为停止准则，如何影响迭代求解器的性能。这个练习突显了在设计和分析实际数值方法时，理解不同范数之间关系的重要性。",
            "id": "3547404",
            "problem": "设 $n \\in \\mathbb{N}$，并考虑一个定义在 $\\mathbb{R}$ 上的方阵序列 $\\{A_n\\}_{n\\ge 2}$，该序列满足 $\\operatorname{rank}(A_n)=1$ 和 $\\lVert A_n\\rVert_F=1$ 这两个约束条件。您将从第一性原理出发，分析残差范数的选择（弗罗贝尼乌斯范数与谱范数）如何影响一个理想化的定常迭代求解器在特意构造的最坏情况族上的停止准则。您的程序必须实现所推导的公式，并报告指定测试套件的预测迭代次数。\n\n任务：\n\n1. 仅使用核心定义，为 $A_n$ 设计一个显式选择，并为其设计一个相关的扰动 $E_n$，使得对于从 $A_n + E_n$ 中移除其最佳秩-1分量后所剩下的残差，残差范数比值界\n$$\n\\lVert R\\rVert_F \\le \\sqrt{\\operatorname{rank}(R)}\\,\\lVert R\\rVert_2\n$$\n作为等式成立。您的设计必须确保：\n   - $A_n$ 具有 $\\operatorname{rank}(A_n)=1$ 和 $\\lVert A_n\\rVert_F=1$。\n   - $E_n$ 与 $A_n$ 的顶层奇异方向正交，且具有相同的非零奇异值，从而在提取最佳秩-1部分后，残差支撑在一个 $(n-1)$ 维子空间上，并具有相等的奇异值。\n\n2. 考虑一个理想化的定常迭代求解器，该求解器从移除 $A_n + E_n$ 的最佳秩-1部分后得到的初始残差 $R_0$ 开始，在每次迭代中以一个固定的因子 $\\rho \\in (0,1)$ 统一地收缩残差的所有奇异值。也就是说，如果 $R_0$ 的非零奇异值均等于 $c_n>0$ 且重数为 $n-1$，那么在第 $k$ 次迭代时的残差 $R_k$ 的所有奇异值均等于 $\\rho^k c_n$，且重数相同。使用两种停止法则：\n   - 谱范数法则（记为 $k_2$）：在满足 $\\lVert R_k\\rVert_2 \\le \\varepsilon$ 的最小 $k\\in\\mathbb{N}\\cup\\{0\\}$ 处停止。\n   - 弗罗贝尼乌斯范数法则（记为 $k_F$）：在满足 $\\lVert R_k\\rVert_F \\le \\varepsilon$ 的最小 $k\\in\\mathbb{N}\\cup\\{0\\}$ 处停止。\n\n   仅基于谱范数、弗罗贝尼乌斯范数、奇异值以及统一收缩模型的定义，推导出 $k_2$ 和 $k_F$ 作为 $(n, c_n, \\rho, \\varepsilon)$ 的函数的显式公式。\n\n3. 实现一个程序，对于下面测试套件中的每个测试用例 $(n, c_n, \\rho, \\varepsilon)$，计算数对 $(k_2, k_F)$ 和差值 $k_F - k_2$。当 $\\varepsilon$ 已大于或等于相关的初始残差范数时，相应的停止索引必须为 $0$。\n\n4. 测试套件：\n   - 用例1（通用，中等维度）：$(n, c_n, \\rho, \\varepsilon) = (64, 10^{-3}, 0.8, 10^{-6})$。\n   - 用例2（边界，最小非平凡维度）：$(n, c_n, \\rho, \\varepsilon) = (2, 10^{-2}, 0.8, 10^{-6})$。\n   - 用例3（大维度，温和收缩）：$(n, c_n, \\rho, \\varepsilon) = (1024, 10^{-4}, 0.9, 10^{-6})$。\n   - 用例4（初始已满足容差）：$(n, c_n, \\rho, \\varepsilon) = (10, 10^{-8}, 0.5, 10^{-7})$。\n   - 用例5（初始时范数不匹配）：$(n, c_n, \\rho, \\varepsilon) = (10, 10^{-3}, 0.7, 2\\times 10^{-3})$。\n\n5. 最终输出格式：\n   - 您的程序应生成单行输出，包含一个列表的列表，其中每个内部列表对应一个测试用例，并按此顺序包含三个整数 $[k_2, k_F, k_F - k_2]$，聚合为一个用方括号括起来的逗号分隔列表。例如，三个用例的输出将如下所示\n     $$\n     [[k_{2,1},k_{F,1},\\Delta_1],[k_{2,2},k_{F,2},\\Delta_2],[k_{2,3},k_{F,3},\\Delta_3]]。\n     $$\n   不应打印任何额外文本。\n\n注：\n- 完全在纯数学框架内进行；不涉及物理单位或角度。\n- 您必须从弗罗贝尼乌斯范数、谱范数和奇异值的定义出发进行推理。请勿在问题陈述中假设或陈述任何快捷公式或解题提示。",
            "solution": "在尝试解答之前，该问题经过了严格的验证过程。\n\n### 步骤1：提取已知条件\n- 一个 $n \\times n$ 维的实方阵序列 $\\{A_n\\}_{n\\ge 2}$，其中 $n \\in \\mathbb{N}$ 且 $n \\ge 2$。\n- 约束1：$\\operatorname{rank}(A_n)=1$。\n- 约束2：$\\lVert A_n\\rVert_F=1$。\n- 对于一个矩阵 $R$，弗罗贝尼乌斯范数和谱范数之间的一个特定关系：$\\lVert R\\rVert_F \\le \\sqrt{\\operatorname{rank}(R)}\\,\\lVert R\\rVert_2$。\n- 任务1要求设计 $A_n$ 和一个扰动 $E_n$，使得上述不等式对于残差 $R_0$ 成为等式，其中 $R_0$ 定义为矩阵 $A_n + E_n$ 移除其最佳秩-1分量后的结果。\n- $A_n$ 和 $E_n$ 的设计约束：$A_n$ 必须满足初始约束；$E_n$ 必须与 $A_n$ 的顶层奇异方向正交；$E_n$ 必须有相同的非零奇异值，这导致残差 $R_0$ 有 $n-1$ 个相同的非零奇异值。\n- 任务2描述了一个理想化的定常迭代求解器。第 $k$ 次迭代的残差，记为 $R_k$，由初始残差 $R_0$ 导出。\n- $R_0$ 的非零奇异值均等于常数 $c_n>0$，重数为 $n-1$。\n- 求解器每一步以因子 $\\rho \\in (0,1)$ 统一收缩这些奇异值，使得 $R_k$ 的非零奇异值为 $\\rho^k c_n$，重数为 $n-1$。\n- 基于容差 $\\varepsilon > 0$，定义了两个停止准则：\n    - 谱范数法则：在 $\\lVert R_k\\rVert_2 \\le \\varepsilon$ 的最小整数 $k_2 \\ge 0$ 处停止。\n    - 弗罗贝尼乌斯范数法则：在 $\\lVert R_k\\rVert_F \\le \\varepsilon$ 的最小整数 $k_F \\ge 0$ 处停止。\n- 任务3要求推导 $k_2$ 和 $k_F$ 作为 $n$、$c_n$、$\\rho$ 和 $\\varepsilon$ 的函数的显式公式。\n- 提供了一个包含五个用例的测试套件用于实现和计算。\n- 最终输出必须是一个列表的列表，其中每个内部列表包含对应测试用例的 $[k_2, k_F, k_F - k_2]$。\n\n### 步骤2：验证\n- **科学依据**：该问题在数值线性代数领域有坚实的理论基础。它利用了矩阵秩、奇异值分解(SVD)、弗罗贝尼乌斯范数($\\lVert \\cdot \\rVert_F$)、谱范数($\\lVert \\cdot \\rVert_2$)以及用于低秩近似的Eckart-Young-Mirsky定理等核心概念。所定义的迭代过程是定常迭代法的一个简化但数学上连贯的模型。\n- **良定性**：该问题是良定的。目标陈述清晰，所提供的信息足以推导所需公式并进行计算。迭代次数 $k_2$ 和 $k_F$ 的存在性和唯一性由所涉及的不等式和对数函数的性质保证。\n- **客观性**：问题以精确、客观的数学语言陈述，没有任何主观或模棱两可的术语。\n\n### 步骤3：结论\n该问题是有效的。这是一个在理想化迭代求解器的背景下应用矩阵范数基本定义的明确练习。有必要提供完整解答。\n\n---\n\n### 解题推导\n\n本解答分两部分呈现。首先，我们确认矩阵的构造能够导出初始残差的指定性质。其次，我们推导迭代次数 $k_2$ 和 $k_F$ 的公式。\n\n**第1部分：矩阵与初始残差的构造**\n\n设 $\\{u_i\\}_{i=1}^n$ 和 $\\{v_i\\}_{i=1}^n$ 是 $\\mathbb{R}^n$ 中的两组标准正交基向量。我们使用这些基向量（它们对应于左、右奇异向量）来构造矩阵 $A_n$ 和 $E_n$。\n\n一个秩-1矩阵可以写成其SVD形式 $A_n = \\sigma_1 u_1 v_1^T$。弗罗贝尼乌斯范数定义为其奇异值平方和的平方根。对于秩-1矩阵，这简化为 $\\lVert A_n \\rVert_F = \\sqrt{\\sigma_1^2} = |\\sigma_1|$。约束 $\\lVert A_n \\rVert_F = 1$ 意味着我们可以将其唯一的非零奇异值设为1。我们将 $A_n$ 定义为：\n$$\nA_n = u_1 v_1^T\n$$\n该矩阵满足 $\\operatorname{rank}(A_n)=1$ 和 $\\lVert A_n \\rVert_F=1$。其顶层奇异方向由 $u_1$ 和 $v_1$ 张成。\n\n扰动 $E_n$ 要求与 $A_n$ 的顶层奇异方向正交。这意味着它的左奇异向量必须与 $u_1$ 正交，右奇异向量必须与 $v_1$ 正交。此外，它的非零奇异值必须相同。设这个共同的奇异值为 $c_n$。因此，我们可以用剩余的基向量构造 $E_n$：\n$$\nE_n = \\sum_{i=2}^{n} c_n u_i v_i^T\n$$\n该矩阵有 $n-1$ 个非零奇异值，均等于 $c_n$。其秩为 $n-1$。\n\n现在，考虑矩阵 $M_n = A_n + E_n$：\n$$\nM_n = u_1 v_1^T + \\sum_{i=2}^{n} c_n u_i v_i^T\n$$\n这个形式是 $M_n$ 的SVD，其奇异值为 $\\{1, c_n, c_n, \\dots, c_n\\}$。假设 $c_n \\ne 1$，则最大奇异值为 $1$。Eckart-Young-Mirsky定理指出，$M_n$ 的最佳秩-1近似是由其最大奇异值及相应的奇异向量构成的矩阵，即 $u_1 v_1^T = A_n$。\n\n移除这个最佳秩-1分量后的残差定义为 $R_0$：\n$$\nR_0 = M_n - A_n = (A_n + E_n) - A_n = E_n = \\sum_{i=2}^{n} c_n u_i v_i^T\n$$\n问题陈述断言初始残差 $R_0$ 的非零奇异值均等于 $c_n$，重数为 $n-1$。我们的构造恰好得出了这个结果。\n\n我们现在验证这个构造在界 $\\lVert R\\rVert_F \\le \\sqrt{\\operatorname{rank}(R)}\\,\\lVert R\\rVert_2$ 中达到了等式。对于我们的残差 $R_0$：\n- $R_0$ 的奇异值为 $\\{c_n, c_n, \\dots, c_n\\}$（$n-1$ 次）和一个 $0$。\n- 秩为 $\\operatorname{rank}(R_0) = n-1$。\n- 谱范数是最大奇异值：$\\lVert R_0 \\rVert_2 = \\max(\\sigma_i(R_0)) = c_n$。\n- 弗罗贝尼乌斯范数是奇异值的均方根和：$\\lVert R_0 \\rVert_F = \\sqrt{\\sum_{i=1}^{n-1} c_n^2} = \\sqrt{(n-1)c_n^2} = c_n \\sqrt{n-1}$。\n\n将这些代入等式检验：\n$$\n\\lVert R_0 \\rVert_F = c_n \\sqrt{n-1}\n$$\n$$\n\\sqrt{\\operatorname{rank}(R_0)} \\, \\lVert R_0 \\rVert_2 = \\sqrt{n-1} \\cdot c_n\n$$\n等式成立，证实了问题前提的有效性。\n\n**第2部分：迭代次数 $k_2$ 和 $k_F$ 的推导**\n\n迭代求解器模型指出，第 $k$ 次迭代的残差，记为 $R_k$，有 $n-1$ 个非零奇异值，均等于 $\\sigma_k = \\rho^k c_n$。我们可以直接从这些奇异值计算 $R_k$ 的范数。\n\n$R_k$ 的谱范数是其最大奇异值：\n$$\n\\lVert R_k \\rVert_2 = \\rho^k c_n\n$$\n$R_k$ 的弗罗贝尼乌斯范数是其奇异值的均方根和：\n$$\n\\lVert R_k \\rVert_F = \\sqrt{\\sum_{i=1}^{n-1} (\\rho^k c_n)^2} = \\sqrt{(n-1)(\\rho^k c_n)^2} = \\rho^k c_n \\sqrt{n-1}\n$$\n\n**$k_2$ 的推导（谱范数停止法则）**\n停止条件是 $\\lVert R_k \\rVert_2 \\le \\varepsilon$。\n首先，我们检查 $k=0$ 的情况。如果 $\\lVert R_0 \\rVert_2 = c_n \\le \\varepsilon$，则初始条件已满足，因此 $k_2 = 0$。\n如果 $c_n > \\varepsilon$，我们寻找满足下式的最小整数 $k \\ge 1$：\n$$\n\\rho^k c_n \\le \\varepsilon \\implies \\rho^k \\le \\frac{\\varepsilon}{c_n}\n$$\n由于 $\\rho \\in (0,1)$，其对数 $\\ln(\\rho)$ 是负数。对两边取自然对数，并在除以一个负数时反转不等号，得到：\n$$\nk \\ln(\\rho) \\le \\ln\\left(\\frac{\\varepsilon}{c_n}\\right) \\implies k \\ge \\frac{\\ln(\\varepsilon/c_n)}{\\ln(\\rho)} = \\frac{\\ln(\\varepsilon) - \\ln(c_n)}{\\ln(\\rho)}\n$$\n由于 $k$ 必须是整数，我们对右侧取上取整。\n$$\nk_2 = \\begin{cases} 0  \\text{若 } c_n \\le \\varepsilon \\\\ \\left\\lceil \\frac{\\ln(\\varepsilon) - \\ln(c_n)}{\\ln(\\rho)} \\right\\rceil  \\text{若 } c_n > \\varepsilon \\end{cases}\n$$\n\n**$k_F$ 的推导（弗罗贝尼乌斯范数停止法则）**\n停止条件是 $\\lVert R_k \\rVert_F \\le \\varepsilon$。\n首先，我们检查 $k=0$ 的情况。如果 $\\lVert R_0 \\rVert_F = c_n \\sqrt{n-1} \\le \\varepsilon$，则初始条件已满足，因此 $k_F = 0$。\n如果 $c_n \\sqrt{n-1} > \\varepsilon$，我们寻找满足下式的最小整数 $k \\ge 1$：\n$$\n\\rho^k c_n \\sqrt{n-1} \\le \\varepsilon \\implies \\rho^k \\le \\frac{\\varepsilon}{c_n \\sqrt{n-1}}\n$$\n取自然对数并求解 $k$：\n$$\nk \\ln(\\rho) \\le \\ln\\left(\\frac{\\varepsilon}{c_n \\sqrt{n-1}}\\right) \\implies k \\ge \\frac{\\ln(\\varepsilon / (c_n \\sqrt{n-1}))}{\\ln(\\rho)} = \\frac{\\ln(\\varepsilon) - \\ln(c_n) - \\frac{1}{2}\\ln(n-1)}{\\ln(\\rho)}\n$$\n由于 $k$ 必须是整数，我们取上取整。\n$$\nk_F = \\begin{cases} 0  \\text{若 } c_n \\sqrt{n-1} \\le \\varepsilon \\\\ \\left\\lceil \\frac{\\ln(\\varepsilon) - \\ln(c_n) - \\frac{1}{2}\\ln(n-1)}{\\ln(\\rho)} \\right\\rceil  \\text{若 } c_n \\sqrt{n-1} > \\varepsilon \\end{cases}\n$$\n这些公式为实现提供了所需的 $k_2$ 和 $k_F$ 的显式表达式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the number of iterations for two stopping criteria based on\n    spectral and Frobenius norms for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (n, c_n, rho, epsilon).\n    test_cases = [\n        (64, 1e-3, 0.8, 1e-6),\n        (2, 1e-2, 0.8, 1e-6),\n        (1024, 1e-4, 0.9, 1e-6),\n        (10, 1e-8, 0.5, 1e-7),\n        (10, 1e-3, 0.7, 2e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, c_n, rho, epsilon = case\n\n        # Ensure n >= 2 as per problem statement, to avoid log(0) or sqrt of negative.\n        if n  2:\n            raise ValueError(\"Dimension n must be >= 2.\")\n\n        # --- Calculate k_2 (spectral-norm based iterations) ---\n        # The initial residual norm is ||R_0||_2 = c_n.\n        initial_norm_2 = c_n\n        \n        k_spectral = 0\n        # If the initial residual is already below the tolerance, k=0.\n        # Otherwise, calculate the number of iterations required.\n        if initial_norm_2 > epsilon:\n            # Derived formula: k_2 = ceil( (ln(epsilon) - ln(c_n)) / ln(rho) )\n            numerator = np.log(epsilon) - np.log(c_n)\n            denominator = np.log(rho)\n            k_spectral = int(np.ceil(numerator / denominator))\n        \n        # --- Calculate k_F (Frobenius-norm based iterations) ---\n        # The initial residual norm is ||R_0||_F = c_n * sqrt(n - 1).\n        initial_norm_F = c_n * np.sqrt(n - 1)\n        \n        k_frobenius = 0\n        # If the initial residual is already below the tolerance, k=0.\n        # Otherwise, calculate the number of iterations required.\n        if initial_norm_F > epsilon:\n            # Derived formula: k_F = ceil( (ln(epsilon) - ln(||R_0||_F)) / ln(rho) )\n            # Which is: ceil( (ln(epsilon) - ln(c_n) - 0.5*ln(n-1)) / ln(rho) )\n            # We use the norm directly for numerical stability and clarity.\n            numerator = np.log(epsilon) - np.log(initial_norm_F)\n            denominator = np.log(rho)\n            k_frobenius = int(np.ceil(numerator / denominator))\n        \n        # --- Calculate the difference ---\n        delta_k = k_frobenius - k_spectral\n        \n        results.append([k_spectral, k_frobenius, delta_k])\n\n    # Final print statement must produce a single-line list of lists.\n    # We construct the string representation manually to ensure no extra spaces.\n    # e.g., [[val1,val2,val3],[val4,val5,val6]]\n    inner_strings = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}