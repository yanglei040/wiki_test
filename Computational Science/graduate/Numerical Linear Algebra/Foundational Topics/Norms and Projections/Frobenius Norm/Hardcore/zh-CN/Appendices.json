{
    "hands_on_practices": [
        {
            "introduction": "掌握任何一个概念，都始于对其基本定义的实践。本练习旨在通过直接计算一个给定矩阵的Frobenius范数，来巩固你对该范数定义的理解。这是一个基础但至关重要的步骤，它将为我们后续探索更深层次的理论和应用打下坚实的基础 。",
            "id": "1033975",
            "problem": "计算矩阵 $D = \\begin{bmatrix} 1  0  -1 \\\\ 2  1  0 \\end{bmatrix}$ 的弗罗贝尼乌斯范数。对于一个矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其弗罗贝尼乌斯范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i=1}^{m} \\sum_{j=1}^{n} |a_{ij}|^2}$。请用精确形式表示结果。",
            "solution": "1. $D\\in\\mathbb{R}^{m\\times n}$ 的弗罗贝尼乌斯范数定义为\n\n$$\n\\|D\\|_F = \\sqrt{\\sum_{i=1}^m\\sum_{j=1}^n |d_{ij}|^2}.\n$$\n\n2. 对于\n\n$$\nD=\\begin{bmatrix}1  0  -1\\\\2  1  0\\end{bmatrix},\n$$\n\n其各项元素的平方和为\n\n$$\n1^2 + 0^2 + (-1)^2 + 2^2 + 1^2 + 0^2\n=1 + 0 + 1 + 4 + 1 + 0\n=7.\n$$\n\n3. 因此，\n\n$$\n\\|D\\|_F = \\sqrt{7}.\n$$",
            "answer": "$$\\boxed{\\sqrt{7}}$$"
        },
        {
            "introduction": "Frobenius范数的真正威力体现在它与矩阵奇异值分解(SVD)的深刻联系上。这个练习将引导你从第一性原理出发，推导出矩阵的Frobenius范数如何通过其奇异值来表达。理解这一关系对于在低秩近似和数据压缩等高级应用中有效使用Frobenius范数至关重要 。",
            "id": "3547391",
            "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 的秩为 $r$，其奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其对角线元素为非负值 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\cdots \\ge \\sigma_{r} > 0$，其余为零。对于满足 $1 \\le k \\le r$ 的固定整数 $k$，定义秩为 $k$ 的截断近似 $A_{k} := U \\Sigma_{k} V^{\\top}$，其中 $\\Sigma_{k}$ 是通过保留 $\\Sigma$ 的前 $k$ 个对角线元素并将所有其他对角线元素设为 0 得到的。\n\n仅从线性代数的基本定义和广泛使用的基本事实出发，包括：\n- Frobenius 范数的定义 $\\|A\\|_{F} = \\sqrt{\\sum_{i=1}^{m} \\sum_{j=1}^{n} a_{ij}^{2}}$，\n- 迹算子 $\\mathrm{trace}(\\cdot)$ 的定义，及其在乘积有定义时的循环不变性 $\\mathrm{trace}(XYZ) = \\mathrm{trace}(ZXY)$，\n- $U$ 和 $V$ 的正交性，使得 $U^{\\top} U = I$ 且 $V^{\\top} V = I$，\n\n完成以下任务：\n- 通过基于这些原理的推导来解释，将 $A$ 的 SVD 截断为 $A_{k}$ 如何影响 Frobenius 范数，包括证明 $\\|A\\|_{F}^{2}$ 可以分解为与 $A_{k}$ 和残差 $A - A_{k}$ 相关联的平方和的毕达哥拉斯式分解。\n- 用奇异值 $\\sigma_{1}, \\ldots, \\sigma_{r}$ 和截断水平 $k$ 来显式计算 Frobenius 范数 $\\|A_{k}\\|_{F}$。\n\n你的最终答案必须是一个用 $\\sigma_{1}, \\ldots, \\sigma_{r}$ 和 $k$ 表示的单一闭式解析表达式。无需进行数值计算，也无需四舍五入。最终答案不带任何单位。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、提法明确、客观且内部一致，是数值线性代数中的一个标准练习。我们按要求进行推导。\n\n我们的出发点是矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 的 Frobenius 范数与迹算子之间的关系。Frobenius 范数的平方定义为其所有元素平方的总和：\n$$\n\\|A\\|_{F}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} a_{ij}^{2}\n$$\n方阵的迹是其对角线元素的总和。考虑矩阵乘积 $A^{\\top} A$，它是一个 $n \\times n$ 矩阵。该乘积的第 $j$ 行第 $j$ 列的元素由下式给出：\n$$\n(A^{\\top} A)_{jj} = \\sum_{i=1}^{m} (A^{\\top})_{ji} A_{ij} = \\sum_{i=1}^{m} a_{ij} a_{ij} = \\sum_{i=1}^{m} a_{ij}^{2}\n$$\n$A^{\\top} A$ 的迹是这些对角线元素的总和：\n$$\n\\mathrm{trace}(A^{\\top} A) = \\sum_{j=1}^{n} (A^{\\top} A)_{jj} = \\sum_{j=1}^{n} \\sum_{i=1}^{m} a_{ij}^{2}\n$$\n通过将其与 Frobenius 范数的定义进行比较，我们建立起以下基本恒等式：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(A^{\\top} A)\n$$\n现在我们将这个恒等式应用于 $A$ 的奇异值分解 (SVD)，即 $A = U \\Sigma V^{\\top}$。$A$ 的转置是 $A^{\\top} = (U \\Sigma V^{\\top})^{\\top} = V \\Sigma^{\\top} U^{\\top}$。将这些代入迹的表达式中：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}( (V \\Sigma^{\\top} U^{\\top}) (U \\Sigma V^{\\top}) )\n$$\n由于 $U$ 是一个正交矩阵，所以 $U^{\\top} U = I$，其中 $I$ 是 $m \\times m$ 单位矩阵。表达式简化为：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(V \\Sigma^{\\top} \\Sigma V^{\\top})\n$$\n使用迹的循环性质 $\\mathrm{trace}(XYZ) = \\mathrm{trace}(ZXY)$，我们可以重排矩阵的顺序：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(V^{\\top} V \\Sigma^{\\top} \\Sigma)\n$$\n由于 $V$ 也是一个正交矩阵，所以 $V^{\\top} V = I$，其中 $I$ 是 $n \\times n$ 单位矩阵。这导致：\n$$\n\\|A\\|_{F}^{2} = \\mathrm{trace}(\\Sigma^{\\top} \\Sigma)\n$$\n矩阵 $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 的主对角线上有非负实数 $\\sigma_i$，其他位置均为零。矩阵 $\\Sigma^{\\top} \\Sigma$ 是一个 $n \\times n$ 对角矩阵。其对角线元素是 $A$ 的奇异值的平方。具体来说，当 $i=1, \\dots, \\min(m, n)$ 时，$(\\Sigma^{\\top} \\Sigma)_{ii} = \\sigma_{i}^{2}$；当 $i > \\min(m, n)$ 时，$(\\Sigma^{\\top} \\Sigma)_{ii} = 0$。由于 $A$ 的秩为 $r$，我们知道当 $i \\le r$ 时 $\\sigma_i > 0$，当 $i > r$ 时 $\\sigma_i = 0$。迹是这些对角线元素的总和：\n$$\n\\|A\\|_{F}^{2} = \\sum_{i=1}^{r} \\sigma_{i}^{2}\n$$\n这就将 Frobenius 范数与矩阵的奇异值联系起来了。\n\n现在，我们分析截断 SVD 的效果。秩为 $k$ 的近似是 $A_k = U \\Sigma_k V^{\\top}$，残差是 $A - A_k$。让我们来考察残差的结构：\n$$\nA - A_k = U \\Sigma V^{\\top} - U \\Sigma_k V^{\\top} = U (\\Sigma - \\Sigma_k) V^{\\top}\n$$\n矩阵 $\\Sigma_k$ 是通过保留 $\\Sigma$ 的前 $k$ 个奇异值并将其余的设为零而形成的。因此，矩阵 $\\Sigma - \\Sigma_k$ 是一个（矩形意义上的）对角矩阵，其对角线元素在索引 $i=1, \\dots, k$ 时为 0，在索引 $i = k+1, \\dots, r$ 时为 $\\sigma_i$。表达式 $U (\\Sigma - \\Sigma_k) V^{\\top}$ 是残差矩阵 $A - A_k$ 的 SVD，其奇异值为 $\\{\\sigma_{k+1}, \\sigma_{k+2}, \\dots, \\sigma_r\\}$。\n\n为了证明毕达哥拉斯式分解，我们考虑 $A$ 的 Frobenius 范数的平方：\n$$\n\\|A\\|_{F}^{2} = \\|A_k + (A - A_k)\\|_{F}^{2}\n$$\nFrobenius 范数是由 Frobenius 内积导出的，定义为 $\\langle X, Y \\rangle_F = \\mathrm{trace}(X^{\\top} Y)$。对于这类范数，我们有性质 $\\|X+Y\\|_{F}^{2} = \\|X\\|_{F}^{2} + \\|Y\\|_{F}^{2} + 2\\langle X, Y \\rangle_F$。我们需要证明 $A_k$ 和 $A-A_k$ 在这个内积下是正交的，即 $\\langle A_k, A - A_k \\rangle_F = 0$。\n$$\n\\langle A_k, A - A_k \\rangle_F = \\mathrm{trace}(A_k^{\\top} (A - A_k))\n$$\n代入 SVD 形式：\n$$\nA_k^{\\top}(A - A_k) = (U \\Sigma_k V^{\\top})^{\\top} (U (\\Sigma - \\Sigma_k) V^{\\top}) = (V \\Sigma_k^{\\top} U^{\\top}) (U (\\Sigma - \\Sigma_k) V^{\\top})\n$$\n使用 $U^{\\top} U = I$，这简化为 $V \\Sigma_k^{\\top} (\\Sigma - \\Sigma_k) V^{\\top}$。现在我们取迹并应用循环性质：\n$$\n\\mathrm{trace}(V \\Sigma_k^{\\top} (\\Sigma - \\Sigma_k) V^{\\top}) = \\mathrm{trace}(V^{\\top} V \\Sigma_k^{\\top} (\\Sigma - \\Sigma_k)) = \\mathrm{trace}(\\Sigma_k^{\\top} (\\Sigma - \\Sigma_k))\n$$\n矩阵乘积 $\\Sigma_k^{\\top} (\\Sigma - \\Sigma_k)$ 是一个对角矩阵。其第 $i$ 个对角线元素是 $\\Sigma_k$ 和 $\\Sigma - \\Sigma_k$ 的第 $i$ 个对角线元素（在转置 $\\Sigma_k$ 之后）的乘积。$\\Sigma_k$ 的对角线包含 $\\{\\sigma_1, \\dots, \\sigma_k, 0, \\dots\\}$。$\\Sigma-\\Sigma_k$ 的对角线包含 $\\{0, \\dots, 0, \\sigma_{k+1}, \\dots, \\sigma_r, 0, \\dots\\}$。对于任何索引 $i$，要么 $\\Sigma_k$ 对角线的第 $i$ 个元素为零（当 $i>k$ 时），要么 $(\\Sigma-\\Sigma_k)$ 对角线的第 $i$ 个元素为零（当 $i \\le k$ 时）。因此，它们的乘积总是零。矩阵 $\\Sigma_k^{\\top} (\\Sigma - \\Sigma_k)$ 是零矩阵，其迹为 0。\n由于 $\\langle A_k, A - A_k \\rangle_F = 0$，毕达哥拉斯式关系成立：\n$$\n\\|A\\|_{F}^{2} = \\|A_k\\|_{F}^{2} + \\|A - A_k\\|_{F}^{2}\n$$\n这个分解表明，$A$ 的 Frobenius 范数的平方被划分到其秩为 $k$ 的近似和残差上。\n\n最后，我们显式计算 $A_k$ 的 Frobenius 范数。推导过程与 $\\|A\\|_F$ 的推导过程相同。我们使用恒等式 $\\|A_k\\|_{F}^{2} = \\mathrm{trace}(A_k^{\\top} A_k)$。\n$$\n\\|A_k\\|_{F}^{2} = \\mathrm{trace}((U \\Sigma_k V^{\\top})^{\\top} (U \\Sigma_k V^{\\top})) = \\mathrm{trace}(V \\Sigma_k^{\\top} U^{\\top} U \\Sigma_k V^{\\top})\n$$\n使用 $U^{\\top}U = I$ 和迹的循环性质以及 $V^{\\top}V = I$：\n$$\n\\|A_k\\|_{F}^{2} = \\mathrm{trace}(V \\Sigma_k^{\\top} \\Sigma_k V^{\\top}) = \\mathrm{trace}(\\Sigma_k^{\\top} \\Sigma_k)\n$$\n矩阵 $\\Sigma_k^{\\top} \\Sigma_k$ 是一个 $n \\times n$ 对角矩阵，其对角线元素为 $\\sigma_1^2, \\dots, \\sigma_k^2$，其余为零。迹是这些对角线元素的总和：\n$$\n\\|A_k\\|_{F}^{2} = \\sum_{i=1}^{k} \\sigma_{i}^{2}\n$$\n取平方根得到秩为 $k$ 的近似的 Frobenius 范数：\n$$\n\\|A_k\\|_{F} = \\sqrt{\\sum_{i=1}^{k} \\sigma_{i}^{2}}\n$$\n这个表达式就是所求的最终答案。",
            "answer": "$$\n\\boxed{\\sqrt{\\sum_{i=1}^{k} \\sigma_{i}^{2}}}\n$$"
        },
        {
            "introduction": "理论知识的价值最终体现在解决实际问题的能力上。这个高级练习将理论付诸实践，探讨了在设计迭代求解器时，选择Frobenius范数与谱范数作为收敛判据所带来的不同影响。通过构建一个“最坏情况”的场景，你将分析并量化这两种范数在算法性能评估中的差异，从而深入理解在实际数值计算中选择合适范数的重要性 。",
            "id": "3547404",
            "problem": "设 $n \\in \\mathbb{N}$，并考虑一个在 $\\mathbb{R}$ 上的方阵序列 $\\{A_n\\}_{n\\ge 2}$，该序列满足两个约束条件：$\\operatorname{rank}(A_n)=1$ 和 $\\lVert A_n\\rVert_F=1$。您将从第一性原理出发，分析在一个刻意构造的最坏情况族上，残差范数（弗罗贝尼乌斯范数与谱范数）的选择如何影响一个理想化定常迭代求解器的停止准则。您的程序必须实现推导出的公式，并报告指定测试套件的预测迭代次数。\n\n任务：\n\n1.  仅使用核心定义，设计一个 $A_n$ 的显式选择和一个相关的扰动 $E_n$，使得对于从 $A_n + E_n$ 中移除最佳秩-1 分量后剩余的残差，残差范数比率界\n    $$\n    \\lVert R\\rVert_F \\le \\sqrt{\\operatorname{rank}(R)}\\,\\lVert R\\rVert_2\n    $$\n    作为等式成立。您的设计必须确保：\n    -   $A_n$ 满足 $\\operatorname{rank}(A_n)=1$ 和 $\\lVert A_n\\rVert_F=1$。\n    -   $E_n$ 与 $A_n$ 的顶层奇异方向正交，并且具有相同的非零奇异值，从而在提取最佳秩-1 部分后，残差支撑在一个具有相等奇异值的 $(n-1)$ 维子空间上。\n\n2.  考虑一个理想化的定常迭代求解器，该求解器从移除 $A_n + E_n$ 的最佳秩-1 部分后的残差 $R_0$ 开始，在每次迭代中将残差的所有奇异值一致地按一个固定因子 $\\rho \\in (0,1)$ 收缩。也就是说，如果 $R_0$ 的非零奇异值都等于 $c_n>0$ 且重数为 $n-1$，那么在第 $k$ 次迭代时的残差 $R_k$ 的奇异值都等于 $\\rho^k c_n$ 且具有相同的重数。使用两种停止规则：\n    -   谱范数规则（记为 $k_2$）：在最小的 $k\\in\\mathbb{N}\\cup\\{0\\}$ 处停止，使得 $\\lVert R_k\\rVert_2 \\le \\varepsilon$。\n    -   弗罗贝尼乌斯范数规则（记为 $k_F$）：在最小的 $k\\in\\mathbb{N}\\cup\\{0\\}$ 处停止，使得 $\\lVert R_k\\rVert_F \\le \\varepsilon$。\n\n    仅基于谱范数、弗罗贝尼乌斯范数、奇异值以及一致收缩模型的定义，推导 $k_2$ 和 $k_F$ 作为 $(n, c_n, \\rho, \\varepsilon)$ 的函数的显式公式。\n\n3.  实现一个程序，对于下面测试套件中的每个测试用例 $(n, c_n, \\rho, \\varepsilon)$，计算数对 $(k_2, k_F)$ 以及差值 $k_F - k_2$。当 $\\varepsilon$ 已经大于或等于相关的初始残差范数时，相应的停止索引必须为 $0$。\n\n4.  测试套件：\n    -   用例 1（一般情况，中等维度）：$(n, c_n, \\rho, \\varepsilon) = (64, 10^{-3}, 0.8, 10^{-6})$。\n    -   用例 2（边界情况，最小非平凡维度）：$(n, c_n, \\rho, \\varepsilon) = (2, 10^{-2}, 0.8, 10^{-6})$。\n    -   用例 3（大维度，收缩缓慢）：$(n, c_n, \\rho, \\varepsilon) = (1024, 10^{-4}, 0.9, 10^{-6})$。\n    -   用例 4（初始即满足容差）：$(n, c_n, \\rho, \\varepsilon) = (10, 10^{-8}, 0.5, 10^{-7})$。\n    -   用例 5（初始时范数不匹配）：$(n, c_n, \\rho, \\varepsilon) = (10, 10^{-3}, 0.7, 2\\times 10^{-3})$。\n\n5.  最终输出格式：\n    -   您的程序应生成单行输出，包含一个列表的列表，其中每个内部列表对应一个测试用例，并按此顺序包含三个整数 $[k_2, k_F, k_F - k_2]$，聚合为一个由逗号分隔并用方括号括起来的列表。例如，三个用例的输出应如下所示：\n        $$\n        [[k_{2,1},k_{F,1},\\Delta_1],[k_{2,2},k_{F,2},\\Delta_2],[k_{2,3},k_{F,3},\\Delta_3]].\n        $$\n    不应打印任何额外文本。\n\n注释：\n-   完全在纯数学框架内进行；不涉及物理单位或角度。\n-   您必须从弗罗贝尼乌斯范数、谱范数和奇异值的定义出发进行推理。请勿在问题陈述中假设或陈述任何快捷公式或解题提示。",
            "solution": "在尝试求解之前，此问题经过了严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 一个维度为 $n \\times n$ 的实数方阵序列 $\\{A_n\\}_{n\\ge 2}$，其中 $n \\in \\mathbb{N}$ 且 $n \\ge 2$。\n- 约束 1：$\\operatorname{rank}(A_n)=1$。\n- 约束 2：$\\lVert A_n\\rVert_F=1$。\n- 对于矩阵 $R$，弗罗贝尼乌斯范数和谱范数之间的一个特定关系：$\\lVert R\\rVert_F \\le \\sqrt{\\operatorname{rank}(R)}\\,\\lVert R\\rVert_2$。\n- 任务 1 要求设计 $A_n$ 和一个扰动 $E_n$，使得对于残差 $R_0$（定义为矩阵 $A_n + E_n$ 去除其最佳秩-1分量后得到），上述不等式变为等式。\n- 对 $A_n$ 和 $E_n$ 的设计约束：$A_n$ 必须满足初始约束；$E_n$ 必须与 $A_n$ 的顶层奇异方向正交；$E_n$ 必须具有相同的非零奇异值，这导致残差 $R_0$ 有 $n-1$ 个相同的非零奇异值。\n- 任务 2 描述了一个理想化的定常迭代求解器。第 $k$ 次迭代的残差（记为 $R_k$）是从初始残差 $R_0$ 派生出来的。\n- $R_0$ 的非零奇异值都等于一个常数 $c_n>0$，重数为 $n-1$。\n- 求解器在每一步都以一个因子 $\\rho \\in (0,1)$ 一致地收缩这些奇异值，使得 $R_k$ 的非零奇异值为 $\\rho^k c_n$，重数也为 $n-1$。\n- 定义了两个基于容差 $\\varepsilon > 0$ 的停止准则：\n    - 谱范数规则：在最小的整数 $k_2 \\ge 0$ 处停止，其中 $\\lVert R_k\\rVert_2 \\le \\varepsilon$。\n    - 弗罗贝尼乌斯范数规则：在最小的整数 $k_F \\ge 0$ 处停止，其中 $\\lVert R_k\\rVert_F \\le \\varepsilon$。\n- 任务 3 要求推导 $k_2$ 和 $k_F$ 关于 $n$、$c_n$、$\\rho$ 和 $\\varepsilon$ 的显式公式。\n- 提供了一个包含五个案例的测试套件用于实现和计算。\n- 最终输出必须是一个列表的列表，每个内部列表包含对应测试用例的 $[k_2, k_F, k_F - k_2]$。\n\n### 步骤 2：验证\n- **科学依据**：该问题在数值线性代数中有坚实的基础。它利用了核心概念，如矩阵秩、奇异值分解（SVD）、弗罗贝尼乌斯范数（$\\lVert \\cdot \\rVert_F$）、谱范数（$\\lVert \\cdot \\rVert_2$）以及用于低秩近似的 Eckart-Young-Mirsky 定理。所定义的迭代过程是定常迭代法的一个简化但数学上一致的模型。\n- **适定性**：该问题是适定的。目标陈述清晰，提供的信息足以推导出所需公式并进行计算。由于所涉及的不等式和对数函数的性质，迭代次数 $k_2$ 和 $k_F$ 的存在性和唯一性得到了保证。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有任何主观或模糊的术语。\n\n### 步骤 3：结论\n此问题有效。这是一个在理想化迭代求解器的背景下，应用矩阵范数基本定义的良好练习。有必要给出完整解答。\n\n---\n\n### 解题推导\n\n本解答分为两部分。首先，我们确认导致初始残差具有指定性质的矩阵构造。其次，我们推导迭代次数 $k_2$ 和 $k_F$ 的公式。\n\n**第一部分：矩阵和初始残差的构造**\n\n设 $\\{u_i\\}_{i=1}^n$ 和 $\\{v_i\\}_{i=1}^n$ 为 $\\mathbb{R}^n$ 中的两组标准正交基向量。我们使用这些基（对应于左、右奇异向量）来构造矩阵 $A_n$ 和 $E_n$。\n\n一个秩-1 矩阵可以用其 SVD 形式写为 $A_n = \\sigma_1 u_1 v_1^T$。弗罗贝尼乌斯范数定义为其奇异值平方和的平方根。对于秩-1 矩阵，这即为 $\\lVert A_n \\rVert_F = \\sqrt{\\sigma_1^2} = |\\sigma_1|$。约束条件 $\\lVert A_n \\rVert_F = 1$ 因此意味着我们可以将其唯一的非零奇异值设为 1。我们定义 $A_n$ 为：\n$$\nA_n = u_1 v_1^T\n$$\n该矩阵满足 $\\operatorname{rank}(A_n)=1$ 和 $\\lVert A_n \\rVert_F=1$。其顶层奇异方向由 $u_1$ 和 $v_1$ 张成。\n\n扰动 $E_n$ 被要求与 $A_n$ 的顶层奇异方向正交。这意味着它的左奇异向量必须与 $u_1$ 正交，右奇异向量必须与 $v_1$ 正交。此外，其非零奇异值必须相同。设这个共同的奇异值为 $c_n$。因此我们可以用剩余的基向量构造 $E_n$：\n$$\nE_n = \\sum_{i=2}^{n} c_n u_i v_i^T\n$$\n该矩阵有 $n-1$ 个非零奇异值，均等于 $c_n$。其秩为 $n-1$。\n\n现在，考虑矩阵 $M_n = A_n + E_n$：\n$$\nM_n = u_1 v_1^T + \\sum_{i=2}^{n} c_n u_i v_i^T\n$$\n此形式是 $M_n$ 的 SVD，其奇异值为 $\\{1, c_n, c_n, \\dots, c_n\\}$。假设 $c_n \\ne 1$，则最大奇异值为 $1$。根据 Eckart-Young-Mirsky 定理，$M_n$ 的最佳秩-1 近似是由其最大奇异值和相应奇异向量构成的矩阵，即 $u_1 v_1^T = A_n$。\n\n移除这个最佳秩-1 分量后的残差定义为 $R_0$：\n$$\nR_0 = M_n - A_n = (A_n + E_n) - A_n = E_n = \\sum_{i=2}^{n} c_n u_i v_i^T\n$$\n问题陈述断言初始残差 $R_0$ 的非零奇异值均等于 $c_n$，重数为 $n-1$。我们的构造恰好得出了这个结果。\n\n我们现在验证这个构造在界 $\\lVert R\\rVert_F \\le \\sqrt{\\operatorname{rank}(R)}\\,\\lVert R\\rVert_2$ 中达到了等式。对于我们的残差 $R_0$：\n-   $R_0$ 的奇异值为 $\\{c_n, c_n, \\dots, c_n\\}$（$n-1$ 次）和一个 $0$。\n-   秩为 $\\operatorname{rank}(R_0) = n-1$。\n-   谱范数是最大奇异值：$\\lVert R_0 \\rVert_2 = \\max(\\sigma_i(R_0)) = c_n$。\n-   弗罗贝尼乌斯范数是奇异值的均方根：$\\lVert R_0 \\rVert_F = \\sqrt{\\sum_{i=1}^{n-1} c_n^2} = \\sqrt{(n-1)c_n^2} = c_n \\sqrt{n-1}$。\n\n将这些代入等式检查中：\n$$\n\\lVert R_0 \\rVert_F = c_n \\sqrt{n-1}\n$$\n$$\n\\sqrt{\\operatorname{rank}(R_0)} \\, \\lVert R_0 \\rVert_2 = \\sqrt{n-1} \\cdot c_n\n$$\n等式成立，证实了问题前提的有效性。\n\n**第二部分：迭代次数 $k_2$ 和 $k_F$ 的推导**\n\n迭代求解器模型指出，第 $k$ 次迭代的残差（记为 $R_k$）有 $n-1$ 个非零奇异值，均等于 $\\sigma_k = \\rho^k c_n$。我们可以直接从这些奇异值计算 $R_k$ 的范数。\n\n$R_k$ 的谱范数是其最大奇异值：\n$$\n\\lVert R_k \\rVert_2 = \\rho^k c_n\n$$\n$R_k$ 的弗罗贝尼乌斯范数是其奇异值的均方根：\n$$\n\\lVert R_k \\rVert_F = \\sqrt{\\sum_{i=1}^{n-1} (\\rho^k c_n)^2} = \\sqrt{(n-1)(\\rho^k c_n)^2} = \\rho^k c_n \\sqrt{n-1}\n$$\n\n**$k_2$ 的推导（谱范数停止规则）**\n停止条件是 $\\lVert R_k \\rVert_2 \\le \\varepsilon$。\n首先，我们检查 $k=0$ 的情况。如果 $\\lVert R_0 \\rVert_2 = c_n \\le \\varepsilon$，则条件初始即满足，所以 $k_2 = 0$。\n如果 $c_n > \\varepsilon$，我们寻求最小的整数 $k \\ge 1$ 使得：\n$$\n\\rho^k c_n \\le \\varepsilon \\implies \\rho^k \\le \\frac{\\varepsilon}{c_n}\n$$\n因为 $\\rho \\in (0,1)$，其对数 $\\ln(\\rho)$ 是负数。对两边取自然对数，并在除以一个负数时反转不等号，得到：\n$$\nk \\ln(\\rho) \\le \\ln\\left(\\frac{\\varepsilon}{c_n}\\right) \\implies k \\ge \\frac{\\ln(\\varepsilon/c_n)}{\\ln(\\rho)} = \\frac{\\ln(\\varepsilon) - \\ln(c_n)}{\\ln(\\rho)}\n$$\n由于 $k$ 必须是整数，我们对右侧表达式取上取整。\n$$\nk_2 = \\begin{cases} 0 & \\text{若 } c_n \\le \\varepsilon \\\\ \\left\\lceil \\frac{\\ln(\\varepsilon) - \\ln(c_n)}{\\ln(\\rho)} \\right\\rceil & \\text{若 } c_n > \\varepsilon \\end{cases}\n$$\n\n**$k_F$ 的推导（弗罗贝尼乌斯范数停止规则）**\n停止条件是 $\\lVert R_k \\rVert_F \\le \\varepsilon$。\n首先，我们检查 $k=0$ 的情况。如果 $\\lVert R_0 \\rVert_F = c_n \\sqrt{n-1} \\le \\varepsilon$，则条件初始即满足，所以 $k_F = 0$。\n如果 $c_n \\sqrt{n-1} > \\varepsilon$，我们寻求最小的整数 $k \\ge 1$ 使得：\n$$\n\\rho^k c_n \\sqrt{n-1} \\le \\varepsilon \\implies \\rho^k \\le \\frac{\\varepsilon}{c_n \\sqrt{n-1}}\n$$\n取自然对数并解出 $k$：\n$$\nk \\ln(\\rho) \\le \\ln\\left(\\frac{\\varepsilon}{c_n \\sqrt{n-1}}\\right) \\implies k \\ge \\frac{\\ln(\\varepsilon / (c_n \\sqrt{n-1}))}{\\ln(\\rho)} = \\frac{\\ln(\\varepsilon) - \\ln(c_n) - \\frac{1}{2}\\ln(n-1)}{\\ln(\\rho)}\n$$\n由于 $k$ 必须是整数，我们取上取整。\n$$\nk_F = \\begin{cases} 0 & \\text{若 } c_n \\sqrt{n-1} \\le \\varepsilon \\\\ \\left\\lceil \\frac{\\ln(\\varepsilon) - \\ln(c_n) - \\frac{1}{2}\\ln(n-1)}{\\ln(\\rho)} \\right\\rceil & \\text{若 } c_n \\sqrt{n-1} > \\varepsilon \\end{cases}\n$$\n这些公式为实现所需的 $k_2$ 和 $k_F$ 提供了显式表达式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the number of iterations for two stopping criteria based on\n    spectral and Frobenius norms for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (n, c_n, rho, epsilon).\n    test_cases = [\n        (64, 1e-3, 0.8, 1e-6),\n        (2, 1e-2, 0.8, 1e-6),\n        (1024, 1e-4, 0.9, 1e-6),\n        (10, 1e-8, 0.5, 1e-7),\n        (10, 1e-3, 0.7, 2e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, c_n, rho, epsilon = case\n\n        # Ensure n >= 2 as per problem statement, to avoid log(0) or sqrt of negative.\n        if n  2:\n            raise ValueError(\"Dimension n must be >= 2.\")\n\n        # --- Calculate k_2 (spectral-norm based iterations) ---\n        # The initial residual norm is ||R_0||_2 = c_n.\n        initial_norm_2 = c_n\n        \n        k_spectral = 0\n        # If the initial residual is already below the tolerance, k=0.\n        # Otherwise, calculate the number of iterations required.\n        if initial_norm_2 > epsilon:\n            # Derived formula: k_2 = ceil( (ln(epsilon) - ln(c_n)) / ln(rho) )\n            numerator = np.log(epsilon) - np.log(c_n)\n            denominator = np.log(rho)\n            k_spectral = int(np.ceil(numerator / denominator))\n        \n        # --- Calculate k_F (Frobenius-norm based iterations) ---\n        # The initial residual norm is ||R_0||_F = c_n * sqrt(n - 1).\n        initial_norm_F = c_n * np.sqrt(n - 1)\n        \n        k_frobenius = 0\n        # If the initial residual is already below the tolerance, k=0.\n        # Otherwise, calculate the number of iterations required.\n        if initial_norm_F > epsilon:\n            # Derived formula: k_F = ceil( (ln(epsilon) - ln(||R_0||_F)) / ln(rho) )\n            # Which is: ceil( (ln(epsilon) - ln(c_n) - 0.5*ln(n-1)) / ln(rho) )\n            # We use the norm directly for numerical stability and clarity.\n            numerator = np.log(epsilon) - np.log(initial_norm_F)\n            denominator = np.log(rho)\n            k_frobenius = int(np.ceil(numerator / denominator))\n        \n        # --- Calculate the difference ---\n        delta_k = k_frobenius - k_spectral\n        \n        results.append([k_spectral, k_frobenius, delta_k])\n\n    # Final print statement must produce a single-line list of lists.\n    # We construct the string representation manually to ensure no extra spaces.\n    # e.g., [[val1,val2,val3],[val4,val5,val6]]\n    inner_strings = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}