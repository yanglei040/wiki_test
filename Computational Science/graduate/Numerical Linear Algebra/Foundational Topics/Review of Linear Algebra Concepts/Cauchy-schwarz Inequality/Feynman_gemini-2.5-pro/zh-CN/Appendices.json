{
    "hands_on_practices": [
        {
            "introduction": "掌握柯西-施瓦茨不等式，首先需要深刻理解其定义，尤其是该不等式何时取等。本练习  将引导你推导在复向量空间中的柯西-施瓦茨不等式，并构造满足等式条件的具体向量，将一个抽象的概念转化为具体的计算实践。通过这个过程，你将加深对内积、范数以及向量之间线性相关性如何决定不等式紧致性的理解。",
            "id": "3536444",
            "problem": "设 $\\mathbb{C}^{n}$ 上配备有标准的埃尔米特内积 $\\langle x,y\\rangle = \\sum_{k=1}^{n} x_{k}\\,\\overline{y_{k}}$（其对第一个参数是线性的，对第二个参数是共轭线性的），以及其诱导范数 $\\|x\\| = \\sqrt{\\langle x,x\\rangle}$。考虑向量 $x,y\\in\\mathbb{C}^{n}$，其内积满足 $\\langle x,y\\rangle = 3 - 4 i$，并假设其范数固定为 $\\|x\\| = \\sqrt{14}$ 和 $\\|y\\| = \\dfrac{5}{\\sqrt{14}}$。仅使用内积的定义性质（正定性、线性、共轭对称性）和诱导范数，推导一个用 $\\|x\\|$ 和 $\\|y\\|$ 表示的 $|\\langle x,y\\rangle|$ 的上界。然后，确定该上界取等时的充分必要条件。最后，在给定的 $\\langle x,y\\rangle$ 和范数同时满足等式成立的条件下，通过设 $x = \\lambda\\,y$（对于一个合适的复标量 $\\lambda\\in\\mathbb{C}$，其模和相位与指定的内积一致）来构造一个显式地使等式成立的向量对。计算 $\\lambda$ 的闭式表达式。你的最终答案必须是 $\\lambda$ 的单一表达式。",
            "solution": "该问题是有效的，因为它在标准线性代数中有科学依据，是自洽的、一致的且适定的。所提供的数值与柯西-施瓦茨不等式的等号成立情况一致，这是问题的核心。\n\n该问题要求三个主要部分：推导 $|\\langle x,y\\rangle|$ 的上界、等号成立的条件，以及在等号成立条件下计算特定的标量 $\\lambda$。\n\n首先，我们推导上界，即柯西-施瓦茨不等式。设 $x$ 和 $y$ 是 $\\mathbb{C}^{n}$ 中的向量。如果 $y$ 是零向量，那么 $\\langle x,y \\rangle = \\langle x, 0 \\cdot y \\rangle = 0 \\langle x, y \\rangle = 0$ 且 $\\|y\\|=0$，因此不等式 $|\\langle x,y\\rangle| \\le \\|x\\|\\|y\\|$ 变为 $0 \\le 0$，这是平凡成立的。让我们假设 $y \\ne 0$。\n\n考虑向量 $z = x - \\text{proj}_{y}x$，其中 $\\text{proj}_{y}x$ 是 $x$ 到 $y$ 上的投影。对于给定的埃尔米特内积，该投影由 $\\frac{\\langle x,y \\rangle}{\\|y\\|^2} y$ 给出。因此，令 $z = x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y$。\n\n根据内积的正定性，$\\langle z,z \\rangle \\ge 0$。我们现在使用内积的性质（对第一个参数的线性、对第二个参数的共轭线性以及共轭对称性 $\\langle u,v \\rangle = \\overline{\\langle v,u \\rangle}$）展开这个表达式。\n$$ \\langle z,z \\rangle = \\left\\langle x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y, \\quad x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y \\right\\rangle $$\n使用在第一个位置上的线性：\n$$ = \\left\\langle x, x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y \\right\\rangle - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\left\\langle y, x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y \\right\\rangle $$\n使用在第二个位置上的共轭线性：\n$$ = \\langle x,x \\rangle - \\overline{\\left(\\frac{\\langle x,y \\rangle}{\\|y\\|^2}\\right)} \\langle x,y \\rangle - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\langle y,x \\rangle + \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\overline{\\left(\\frac{\\langle x,y \\rangle}{\\|y\\|^2}\\right)} \\langle y,y \\rangle $$\n我们使用以下事实：$\\langle u,u \\rangle = \\|u\\|^2$、$\\langle y,x \\rangle = \\overline{\\langle x,y \\rangle}$，以及对于任意复数 $c$，$c\\overline{c} = |c|^2$。因为 $\\|y\\|^2$ 是一个实数，所以它的共轭是它本身。\n$$ \\langle z,z \\rangle = \\|x\\|^2 - \\frac{\\overline{\\langle x,y \\rangle}}{\\|y\\|^2} \\langle x,y \\rangle - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\overline{\\langle x,y \\rangle} + \\frac{\\langle x,y \\rangle \\overline{\\langle x,y \\rangle}}{\\|y\\|^4} \\|y\\|^2 $$\n$$ = \\|x\\|^2 - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} + \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} $$\n$$ = \\|x\\|^2 - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} $$\n由于我们已经确定 $\\langle z,z \\rangle \\ge 0$，因此可得：\n$$ \\|x\\|^2 - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} \\ge 0 $$\n$$ \\|x\\|^2 \\|y\\|^2 \\ge |\\langle x,y \\rangle|^2 $$\n对两边取平方根，我们得到柯西-施瓦茨不等式，它提供了所要求的上界：\n$$ |\\langle x,y \\rangle| \\le \\|x\\| \\|y\\| $$\n\n第二，我们确定等号成立的充分必要条件。等式 $|\\langle x,y \\rangle| = \\|x\\| \\|y\\|$ 成立，当且仅当 $\\langle z,z \\rangle = 0$。根据内积的正定性，$\\langle z,z \\rangle = 0$ 当且仅当 $z=0$。\n代入 $z$ 的定义：\n$$ x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y = 0 $$\n这可以重排为：\n$$ x = \\left(\\frac{\\langle x,y \\rangle}{\\|y\\|^2}\\right) y $$\n这表明 $x$ 是 $y$ 的一个标量倍。令 $\\lambda = \\frac{\\langle x,y \\rangle}{\\|y\\|^2}$，我们得到 $x = \\lambda y$，其中 $\\lambda \\in \\mathbb{C}$。因此，等号成立的充分必要条件是向量 $x$ 和 $y$ 线性相关。\n\n第三，我们为给定的向量 $x$ 和 $y$ 计算 $\\lambda$ 的具体值，题目中说明它们使等式成立。\n所提供的值为：\n$\\langle x,y \\rangle = 3 - 4i$\n$\\|x\\| = \\sqrt{14}$\n$\\|y\\| = \\frac{5}{\\sqrt{14}}$\n\n首先，我们验证这些值确实满足等式成立条件：\n$|\\langle x,y \\rangle| = |3 - 4i| = \\sqrt{3^2 + (-4)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。\n$\\|x\\| \\|y\\| = \\sqrt{14} \\cdot \\frac{5}{\\sqrt{14}} = 5$。\n因为 $|\\langle x,y \\rangle| = \\|x\\| \\|y\\|$, 所以等式成立的条件得到满足。\n\n我们现在可以使用为线性相关的向量推导出的标量 $\\lambda$ 的公式：\n$$ \\lambda = \\frac{\\langle x,y \\rangle}{\\|y\\|^2} $$\n我们需要计算 $\\|y\\|^2$：\n$$ \\|y\\|^2 = \\left(\\frac{5}{\\sqrt{14}}\\right)^2 = \\frac{5^2}{(\\sqrt{14})^2} = \\frac{25}{14} $$\n现在，我们将给定的 $\\langle x,y \\rangle$ 值和计算出的 $\\|y\\|^2$ 值代入 $\\lambda$ 的表达式中：\n$$ \\lambda = \\frac{3 - 4i}{\\frac{25}{14}} $$\n$$ \\lambda = (3-4i) \\cdot \\frac{14}{25} = \\frac{14(3-4i)}{25} = \\frac{42 - 56i}{25} $$\n因此，该复标量为 $\\lambda = \\frac{42}{25} - \\frac{56}{25}i$。\n作为检验，如果 $x = \\lambda y$，那么我们必须有 $\\langle x,y \\rangle = \\langle \\lambda y, y \\rangle = \\lambda \\langle y,y \\rangle = \\lambda \\|y\\|^2$。\n$$ \\left( \\frac{42 - 56i}{25} \\right) \\left( \\frac{25}{14} \\right) = \\frac{14(3-4i)}{25} \\frac{25}{14} = 3-4i $$\n这与给定的内积值相符。\n同样，我们必须有 $\\|x\\| = \\|\\lambda y\\| = |\\lambda| \\|y\\|$。\n$$ |\\lambda| = \\left|\\frac{14(3-4i)}{25}\\right| = \\frac{14}{25} |3-4i| = \\frac{14}{25} \\sqrt{25} = \\frac{14}{5} $$\n$$ \\|x\\| = \\frac{14}{5} \\cdot \\|y\\| = \\frac{14}{5} \\cdot \\frac{5}{\\sqrt{14}} = \\frac{14}{\\sqrt{14}} = \\sqrt{14} $$\n这与给定的 $x$ 的范数相符。两个条件都满足。",
            "answer": "$$ \\boxed{\\frac{42}{25} - \\frac{56}{25}i} $$"
        },
        {
            "introduction": "柯西-施瓦茨不等式的强大之处在于其普适性，它远远超出了有限维向量空间的范畴。这个练习  将这一概念推广到函数空间，这是数学分析和应用数学中常见的设定。通过确定两个函数使不等式取等的条件，你将看到线性相关的基本原理如何无缝地转换到一个新的领域。",
            "id": "25277",
            "problem": "### 积分柯西-施瓦茨不等式中的等号成立条件\n\n积分形式的柯西-施瓦茨不等式指出，对于给定区间 $[a, b]$ 上的任意两个实值连续函数 $f(x)$ 和 $g(x)$，以下关系式成立：\n$$ \\left( \\int_a^b f(x)g(x) \\, dx \\right)^2 \\leq \\left( \\int_a^b f(x)^2 \\, dx \\right) \\left( \\int_a^b g(x)^2 \\, dx \\right) $$\n等号成立当且仅当一个函数是另一个函数的常数倍，即对于某个常数 $c$，有 $g(x) = c \\cdot f(x)$。\n\n考虑区间 $[0, 1]$ 上的函数 $f(x) = x$ 和 $g(x) = 3x + b$，其中 $b$ 是一个实常数。\n\n推导 $b$ 的具体值，使得对于这些函数和给定的区间，柯西-施瓦茨不等式的等号成立。",
            "solution": "根据积分形式的柯西-施瓦茨不等式的等号成立条件，必须存在一个常数 $c$ 使得\n$$g(x)=c\\,f(x)\\quad\\text{for all }x\\in[0,1].$$\n此处 $f(x)=x$ 且 $g(x)=3x+b$，所以我们要求\n$$3x+b = c\\,x\\quad\\text{for all }x.$$\n比较 $x$ 的系数和常数项，得到两个方程：\n1. $x$ 的系数： $3 = c$。\n2. 常数项： $b = 0$。\n因此，唯一的值是 $b=0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "柯西-施瓦茨不等式是数值分析领域的基石工具之一，其最重要的用途之一是为误差和敏感性分析推导界限。本练习  提供了一个动手推导瑞利商（Rayleigh quotient）扰动界限的机会，这是特征值问题的核心量。这个推导过程将展示基础不等式如何支撑数值算法的稳定性分析，让你亲身体验从第一性原理出发解决数值问题的过程。",
            "id": "3536475",
            "problem": "考虑一个实内积空间 $\\mathbb{R}^n$，其配备了欧几里得内积和范数，其中对于向量 $u,v \\in \\mathbb{R}^n$，有 $\\langle u,v \\rangle = u^\\top v$ 且 $\\|u\\|_2 = \\sqrt{u^\\top u}$。对于一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，定义瑞利商（Rayleigh quotient） $q:\\mathbb{R}^n \\setminus \\{0\\} \\to \\mathbb{R}$ 为 $q(x) = \\dfrac{x^\\top A x}{x^\\top x}$。设 $\\|\\cdot\\|_2$ 也表示诱导矩阵 $2$-范数（谱范数），即对于矩阵 $A$，$\\|A\\|_2 = \\max_{\\|x\\|_2=1} \\|A x\\|_2$，其值等于最大奇异值。\n\n你的任务是推导并以计算方式验证在向量扰动下瑞利商的一个非平凡扰动界。设 $x \\in \\mathbb{R}^n \\setminus \\{0\\}$ 和 $\\delta x \\in \\mathbb{R}^n$ 满足 $\\|\\delta x\\|_2  \\|x\\|_2$。记 $y = x + \\delta x$。仅从核心定义和下面列出的经过充分检验的不等式出发，推导一个显式的、闭合形式的上界 $B(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2)$，使得\n$$\n\\left| q(y) - q(x) \\right| \\le B\\big(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2\\big).\n$$\n\n你必须遵守以下推导约束：\n- 仅使用以下基础工具：瑞利商的定义、诱导矩阵 $2$-范数的定义、柯西-施瓦茨（Cauchy–Schwarz）不等式和三角不等式。你可以使用对于任意向量 $u,v$ 和矩阵 $A$，有 $\\left|u^\\top A v\\right| \\le \\|A\\|_2 \\|u\\|_2 \\|v\\|_2$，以及 $\\|x+\\delta x\\|_2 \\ge \\|x\\|_2 - \\|\\delta x\\|_2$。\n- 最终的界 $B(\\cdot,\\cdot,\\cdot)$ 必须仅用标量 $\\|A\\|_2$、$\\|x\\|_2$ 和 $\\|\\delta x\\|_2$ 来表示。$B$ 中不允许出现其他依赖于向量或矩阵的量。\n- 不要引用或假设任何已有的瑞利商扰动结果；从上述定义和不等式推导你的界。\n\n然后，实现一个程序，在一小组结构化测试用例上数值验证你推导出的界的正确性。你的程序必须：\n- 假设所有矩阵 $A$ 都是实对称的。\n- 对于每个测试用例，计算在 $x$ 和 $x+\\delta x$ 处的瑞利商，计算你的界 $B(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2)$，并返回一个布尔值，指示不等式是否在小的绝对容差 $\\tau = 10^{-12}$ 内成立，即\n$$\n\\left| q(x+\\delta x) - q(x) \\right| \\le B\\big(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2\\big) + \\tau.\n$$\n是否成立。\n\n测试套件和覆盖率要求：\n- 使用以下六个确定性测试用例，它们涵盖了典型、病态、近边界和退化的扰动。在每种情况下，验证 $\\|\\delta x\\|_2  \\|x\\|_2$ 均成立。\n    1. $A_1 = \\mathrm{diag}([\\,1,\\,2,\\,4\\,])$, $x_1 = [\\,1,\\,-1,\\,2\\,]^\\top$, $\\delta x_1 = [\\,10^{-3},\\,-2\\cdot 10^{-3},\\,10^{-3}\\,]^\\top$。\n    2. $A_2 \\in \\mathbb{R}^{5 \\times 5}$ 是三对角托普利茨（Toeplitz）矩阵，主对角线元素为 $2$，次/超对角线元素为 $-1$；$x_2 = [\\,1,\\,2,\\,3,\\,4,\\,5\\,]^\\top$, $\\delta x_2 = [\\,0,\\,10^{-1},\\,0,\\,0,\\,0\\,]^\\top$。\n    3. $A_3 \\in \\mathbb{R}^{5 \\times 5}$ 是希尔伯特（Hilbert）矩阵，其元素为 $(A_3)_{ij} = \\dfrac{1}{i+j-1}$，其中索引 $i,j$ 从 $1$ 开始；$x_3 = [\\,1,\\,1,\\,1,\\,1,\\,1\\,]^\\top$, $\\delta x_3 = [\\,0,\\,4\\cdot 10^{-1},\\,0,\\,0,\\,0\\,]^\\top$。\n    4. $A_4 \\in \\mathbb{R}^{8 \\times 8}$ 是三对角托普利茨（Toeplitz）矩阵，主对角线元素为 $2$，次/超对角线元素为 $-1$；$x_4 \\in \\mathbb{R}^8$ 的元素为 $(x_4)_k = \\sin(k)$，其中 $k \\in \\{1,2,\\dots,8\\}$，角度以弧度计，且 $\\delta x_4 = -9\\cdot 10^{-1}\\, x_4$。\n    5. $A_5 = \\mathrm{diag}([\\,1,\\,10^{3},\\,10^{6},\\,3,\\,7\\,])$, $x_5 = [\\,1,\\,5\\cdot 10^{-1},\\,-25\\cdot 10^{-2},\\,75\\cdot 10^{-2},\\,-3\\cdot 10^{-1}\\cdot 5\\,]^\\top$, $\\delta x_5 = 10^{-4}\\,[\\,-1,\\,2,\\,-3,\\,4,\\,-5\\,]^\\top$。\n    6. $A_6 = A_2$, $x_6 = [\\,1,\\,-2,\\,1,\\,5\\cdot 10^{-1},\\,-5\\cdot 10^{-1}\\,]^\\top$, $\\delta x_6 = [\\,0,\\,0,\\,0,\\,0,\\,0\\,]^\\top$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例 1 到 6 的顺序给出结果，每个条目为字符串 True 或 False（例如，\"[True,True,False,True,True,True]\"）。",
            "solution": "用户提供的问题已经过验证，被认为是数值线性代数领域一个有效的、适定的问题。现在将介绍扰动界的推导及其数值验证。\n\n### 扰动界的推导\n\n设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个实对称矩阵。对于任意非零向量 $x \\in \\mathbb{R}^n$，瑞利商定义为 $q(x) = \\dfrac{x^\\top A x}{x^\\top x}$。我们被要求找到绝对差 $|q(y) - q(x)|$ 的一个界 $B$，其中 $y = x + \\delta x$ 是一个扰动向量，且满足约束 $\\|\\delta x\\|_2  \\|x\\|_2$。界 $B$ 只能依赖于 $\\|A\\|_2$、$\\|x\\|_2$ 和 $\\|\\delta x\\|_2$。\n\n我们从表示差值 $q(y) - q(x)$ 开始。一个有效的方法是通过从 $q(y)$ 中减去 $q(x)$ 来重写这个差值：\n$$\nq(y) - q(x) = \\frac{y^\\top A y}{y^\\top y} - q(x)\n$$\n为了通分并简化，我们可以将第二项乘以 $\\frac{y^\\top y}{y^\\top y} = 1$：\n$$\nq(y) - q(x) = \\frac{y^\\top A y - q(x) (y^\\top y)}{y^\\top y}\n$$\n分子可以表示为 $y^\\top (A - q(x)I) y$，其中 $I$ 是单位矩阵。因此，\n$$\nq(y) - q(x) = \\frac{y^\\top (A - q(x)I) y}{y^\\top y}\n$$\n现在，我们将 $y = x + \\delta x$ 代入分子：\n$$\ny^\\top (A - q(x)I) y = (x + \\delta x)^\\top (A - q(x)I) (x + \\delta x)\n$$\n展开这个二次型得到三项：\n$$\n(x + \\delta x)^\\top (A - q(x)I) (x + \\delta x) = x^\\top(A - q(x)I)x + 2x^\\top(A - q(x)I)\\delta x + (\\delta x)^\\top(A - q(x)I)\\delta x\n$$\n我们来分析第一项，$x^\\top(A - q(x)I)x$：\n$$\nx^\\top(A - q(x)I)x = x^\\top A x - q(x) (x^\\top x)\n$$\n根据定义，$q(x) = \\frac{x^\\top A x}{x^\\top x}$，所以 $q(x)(x^\\top x) = x^\\top A x$。因此，\n$$\nx^\\top(A - q(x)I)x = x^\\top A x - x^\\top A x = 0\n$$\n这个关键的简化使我们得到：\n$$\nq(y) - q(x) = \\frac{2x^\\top(A - q(x)I)\\delta x + (\\delta x)^\\top(A - q(x)I)\\delta x}{\\|y\\|_2^2}\n$$\n我们现在可以取绝对值并对分子应用三角不等式：\n$$\n|q(y) - q(x)| \\le \\frac{2|x^\\top(A - q(x)I)\\delta x| + |(\\delta x)^\\top(A - q(x)I)\\delta x|}{\\|y\\|_2^2}\n$$\n下一步是使用给定的不等式和定义来为每一项定界。设 $M = A - q(x)I$。由于 $A$ 是对称的，$M$ 也是对称的。\n\n首先，我们为 $|x^\\top M \\delta x|$ 定界。这可以写成 $|(Mx)^\\top \\delta x|$。根据柯西-施瓦茨（Cauchy-Schwarz）不等式，$|\\langle u, v \\rangle| \\le \\|u\\|_2 \\|v\\|_2$：\n$$\n|(Mx)^\\top \\delta x| \\le \\|Mx\\|_2 \\|\\delta x\\|_2\n$$\n项 $\\|Mx\\|_2$ 可以使用诱导 $2$-范数的定义来定界：\n$$\n\\|Mx\\|_2 = \\|(A - q(x)I)x\\|_2 \\le \\|A - q(x)I\\|_2 \\|x\\|_2\n$$\n使用矩阵范数的三角不等式，$\\|A - q(x)I\\|_2 \\le \\|A\\|_2 + \\|-q(x)I\\|_2 = \\|A\\|_2 + |q(x)|\\|I\\|_2$。由于 $\\|I\\|_2 = 1$，我们有 $\\|A - q(x)I\\|_2 \\le \\|A\\|_2 + |q(x)|$。\n瑞利商本身受 $A$ 的谱范数的限制。从给定的不等式 $|u^\\top A v| \\le \\|A\\|_2 \\|u\\|_2 \\|v\\|_2$ 出发，设 $u=v=x$，得到 $|x^\\top A x| \\le \\|A\\|_2 \\|x\\|_2^2$。两边除以 $\\|x\\|_2^2 = x^\\top x$ 得到 $|q(x)| \\le \\|A\\|_2$。\n将此代入 $\\|A - q(x)I\\|_2$ 的界中，得到：\n$$\n\\|A - q(x)I\\|_2 \\le \\|A\\|_2 + \\|A\\|_2 = 2\\|A\\|_2\n$$\n结合这些结果，我们得到分子第一项的界：\n$$\n2|x^\\top(A - q(x)I)\\delta x| \\le 2 (\\|A - q(x)I\\|_2 \\|x\\|_2) \\|\\delta x\\|_2 \\le 2(2\\|A\\|_2 \\|x\\|_2)\\|\\delta x\\|_2 = 4\\|A\\|_2 \\|x\\|_2 \\|\\delta x\\|_2\n$$\n其次，我们为 $|(\\delta x)^\\top M \\delta x|$ 定界。使用给定的不等式 $|u^\\top M v| \\le \\|M\\|_2 \\|u\\|_2 \\|v\\|_2$，其中 $u=v=\\delta x$：\n$$\n|(\\delta x)^\\top M \\delta x| \\le \\|M\\|_2 \\|\\delta x\\|_2^2 = \\|A - q(x)I\\|_2 \\|\\delta x\\|_2^2 \\le 2\\|A\\|_2 \\|\\delta x\\|_2^2\n$$\n整个分子的界是这两个界的和：\n$$\n\\text{Numerator Bound} \\le 4\\|A\\|_2 \\|x\\|_2 \\|\\delta x\\|_2 + 2\\|A\\|_2 \\|\\delta x\\|_2^2\n$$\n最后，我们需要分母 $\\|y\\|_2^2 = \\|x+\\delta x\\|_2^2$ 的一个下界。使用给定的反三角不等式，$\\|x+\\delta x\\|_2 \\ge \\|x\\|_2 - \\|\\delta x\\|_2$。问题陈述了 $\\|\\delta x\\|_2  \\|x\\|_2$，这保证了该下界为正。两边平方得到 $\\|x+\\delta x\\|_2^2 \\ge (\\|x\\|_2 - \\|\\delta x\\|_2)^2$。因此：\n$$\n\\frac{1}{\\|y\\|_2^2} \\le \\frac{1}{(\\|x\\|_2 - \\|\\delta x\\|_2)^2}\n$$\n结合分子和分母的界，我们得到最终的扰动界 $B$：\n$$\n|q(y) - q(x)| \\le \\frac{4\\|A\\|_2 \\|x\\|_2 \\|\\delta x\\|_2 + 2\\|A\\|_2 \\|\\delta x\\|_2^2}{(\\|x\\|_2 - \\|\\delta x\\|_2)^2}\n$$\n提出公因式后，该界表示为：\n$$\nB(\\|A\\|_2, \\|x\\|_2, \\|\\delta x\\|_2) = \\frac{2\\|A\\|_2 \\|\\delta x\\|_2 (2 \\|x\\|_2 + \\|\\delta x\\|_2)}{(\\|x\\|_2 - \\|\\delta x\\|_2)^2}\n$$\n该界完全由 $\\|A\\|_2$、$\\|x\\|_2$ 和 $\\|\\delta x\\|_2$ 表示，符合要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Derives and numerically verifies a perturbation bound for the Rayleigh quotient.\n    \"\"\"\n\n    def make_tridi_toeplitz(n):\n        \"\"\"\n        Creates a symmetric tridiagonal Toeplitz matrix with 2 on the main\n        diagonal and -1 on the first off-diagonals.\n        \"\"\"\n        return np.diag(2 * np.ones(n)) - np.diag(np.ones(n - 1), k=1) - np.diag(np.ones(n - 1), k=-1)\n\n    # Define the tolerance for numerical verification.\n    tau = 1e-12\n\n    # Define the six deterministic test cases.\n    A1 = np.diag([1.0, 2.0, 4.0])\n    x1 = np.array([1.0, -1.0, 2.0])\n    dx1 = np.array([1e-3, -2e-3, 1e-3])\n\n    A2 = make_tridi_toeplitz(5)\n    x2 = np.arange(1.0, 6.0)\n    dx2 = np.array([0.0, 1e-1, 0.0, 0.0, 0.0])\n    \n    A3 = linalg.hilbert(5)\n    x3 = np.ones(5)\n    dx3 = np.array([0.0, 4e-1, 0.0, 0.0, 0.0])\n\n    A4 = make_tridi_toeplitz(8)\n    x4 = np.sin(np.arange(1, 9, dtype=float))\n    dx4 = -9e-1 * x4\n\n    A5 = np.diag([1.0, 1e3, 1e6, 3.0, 7.0])\n    x5 = np.array([1.0, 0.5, -0.25, 0.75, -1.5]) \n    dx5 = 1e-4 * np.array([-1.0, 2.0, -3.0, 4.0, -5.0])\n\n    A6 = A2\n    x6 = np.array([1.0, -2.0, 1.0, 0.5, -0.5])\n    dx6 = np.zeros(5)\n    \n    test_cases = [\n        (A1, x1, dx1),\n        (A2, x2, dx2),\n        (A3, x3, dx3),\n        (A4, x4, dx4),\n        (A5, x5, dx5),\n        (A6, x6, dx6),\n    ]\n\n    results = []\n    for A, x, dx in test_cases:\n        # Check problem condition ||dx||_2  ||x||_2.\n        norm_x = np.linalg.norm(x, 2)\n        norm_dx = np.linalg.norm(dx, 2)\n        if not (norm_dx  norm_x):\n            # This case violates problem assumptions.\n            # While not expected, we handle it by marking as invalid (False).\n            # This can happen if norm_dx is extremely close to norm_x due to float precision.\n            results.append(False)\n            continue\n\n        # Compute Rayleigh quotients.\n        y = x + dx\n        \n        # Guard against zero-division for the case x=0, which is disallowed by problem.\n        # The condition norm_dx  norm_x also prevents y=0.\n        q_x = (x.T @ A @ x) / (x.T @ x)\n        q_y = (y.T @ A @ y) / (y.T @ y)\n\n        # Compute the absolute difference (LHS of the inequality).\n        diff = abs(q_y - q_x)\n\n        # Compute the derived bound B (RHS of the inequality).\n        norm_A = np.linalg.norm(A, 2)\n        \n        # Handle the dx=0 case. The bound numerator becomes 0, so B=0.\n        if norm_dx == 0:\n            B = 0.0\n        else:\n            bound_numerator = 2 * norm_A * norm_dx * (2 * norm_x + norm_dx)\n            bound_denominator = (norm_x - norm_dx)**2\n            B = bound_numerator / bound_denominator\n\n        # Verify the inequality with the given tolerance.\n        inequality_holds = (diff = B + tau)\n        results.append(inequality_holds)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}