{
    "hands_on_practices": [
        {
            "introduction": "高效的内存使用是带状矩阵求解器的一大核心优势。本练习将深入探讨高斯消元法在带状矩阵上的力学原理，证明其填充（fill-in）被限制在原始带宽内。通过这个分析，我们将推导出存储 LU 分解因子所需内存的精确公式 ，这是理解带状求解器效率的第一步。",
            "id": "3534144",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个非奇异矩阵，其下带宽为 $p$，上带宽为 $q$，意即当 $i - j > p$ 或 $j - i > q$ 时，$a_{ij} = 0$，其中 $n \\in \\mathbb{N}$ 且 $0 \\leq p, q \\leq n - 1$。假设对 $A$ 可以应用不带主元选择的高斯消元法（因此所有顺序主子式都是非奇异的），并且其得到的 $LU$ 分解 $A = LU$ 遵循以下约定进行存储：\n- $L$ 是单位下三角矩阵，只存储其严格下对角元素。\n- $U$ 是上三角矩阵，存储其对角线及以上所有结构上非零的元素。\n\n从带状结构和高斯消元法的定义出发，推理消元过程如何影响带内的稀疏性，证明 $L$ 和 $U$ 的带宽，然后通过计算这些带宽所隐含的每行（或每列）的非零元素数量，推导出一个闭式表达式 $T(n,p,q)$，表示在上述约定下存储这些 $LU$ 因子所需的浮点标量总数。从第一性原理出发，总结为什么对于固定的 $p$ 和 $q$，当 $n \\to \\infty$ 时，存储量按 $O(n(p+q))$ 的规模增长。\n\n你的最终答案必须是闭式形式的精确解析表达式 $T(n,p,q)$。不要提供不等式或大O表达式作为最终答案。",
            "solution": "我们从带状矩阵的定义开始。一个矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 具有下带宽 $p$ 和上带宽 $q$，如果当 $i - j > p$ 或 $j - i > q$ 时，$a_{ij} = 0$。等价地，在每一行 $i$ 中，非零元素只能出现在满足 $i - p \\leq j \\leq i + q$ 的列 $j$ 中，并与有效索引范围取交集。\n\n我们在每个顺序主子式都非奇异的假设下，对 $A$ 应用不带主元选择的高斯消元法，从而保证所有消元步骤都是良定义的。在第 $k$ 步消元中，我们通过为 $i = k+1, \\dots, \\min\\{n, k + p\\}$ 构造乘子 $l_{ik} = a_{ik}^{(k)}/a_{kk}^{(k)}$ 来消除第 $k$ 列主元下方的元素，因为当 $i - k > p$ 时 $a_{ik}^{(k)} = 0$。因此，在 $L$ 的第 $k$ 列中，只有到第 $k + p$ 行的元素才可能是非零的乘子。这表明 $L$ 最多有 $p$ 条下对角线，即 $L$ 的下带宽为 $p$，并且由于 $L$ 是单位下三角矩阵，根据约定其对角线元素为 $1$，在所述的存储方案下不被存储。\n\n现在我们考虑消元过程对上三角因子 $U$ 的影响。在第 $k$ 步，舒尔补更新通过减去第 $k+1:\\min\\{n, k + p\\}$ 行的乘子向量与第 $k+1:\\min\\{n, k + q\\}$ 列的主元行元素的外积来修改后继子矩阵。由于主元行 $k$ 中的非零元素最多延伸到第 $k + q$ 列，而非零乘子最多延伸到第 $k + p$ 行，所以此更新不会在原始带之外产生非零元素：对于任何满足 $j - i > q$ 或 $i - j > p$ 的位置 $(i,j)$，根据外积的结构，更新后的值仍为零。因此，对 $k$ 的归纳论证表明，中间的舒尔补仍然保持相同的 $(p,q)$ 带宽结构，因此 $U$ 只在对角线及其上方的 $q$ 条超对角线内累积非零元素。因此，$U$ 的上带宽为 $q$。\n\n确定了 $L$ 和 $U$ 的带宽之后，我们现在根据所述的存储约定来计算存储的元素数量。\n\n- 对于 $U$：在第 $i$ 行，对角线及其上方的非零元素延伸至第 $\\min\\{n, i + q\\}$ 列，因此第 $i$ 行存储的元素数量为\n$$\n\\#U(i) \\;=\\; \\min\\{n, i+q\\} - i + 1 \\,.\n$$\n对于行 $i = 1, \\dots, n - q$，该数量等于 $q + 1$。对于最后 $q$ 行，即 $i = n - q + 1, \\dots, n$，该数量从 $q$ 线性递减到 $1$。求和得，\n$$\n\\#U \\;=\\; \\sum_{i=1}^{n - q} (q + 1) \\;+\\; \\sum_{k=1}^{q} k \\;=\\; (n - q)(q + 1) \\;+\\; \\frac{q(q + 1)}{2} \\,.\n$$\n这可以等价地写成\n$$\n\\#U \\;=\\; n q + n \\;-\\; \\frac{q^2 + q}{2} \\,.\n$$\n\n- 对于 $L$（不包括单位对角线）：在第 $i$ 行，严格下对角元素的数量是 $\\min\\{p, i - 1\\}$。因此，\n$$\n\\#L_{\\text{sub}} \\;=\\; \\sum_{i=1}^{n} \\min\\{p, i - 1\\} \\,.\n$$\n对于 $0 \\leq p \\leq n - 1$，这个和可以分为一个初始的递增部分和一个平台部分：\n$$\n\\#L_{\\text{sub}} \\;=\\; \\sum_{i=1}^{p+1} (i - 1) \\;+\\; \\sum_{i=p+2}^{n} p \\;=\\; \\frac{p(p + 1)}{2} \\;+\\; p(n - p - 1) \\,.\n$$\n这可以简化为\n$$\n\\#L_{\\text{sub}} \\;=\\; p(n - 1) \\;-\\; \\frac{p(p - 1)}{2} \\,.\n$$\n\n存储的标量总数是以下各项之和\n$$\nT(n,p,q) \\;=\\; \\#L_{\\text{sub}} \\;+\\; \\#U \\;=\\; \\left[p(n - 1) - \\frac{p(p - 1)}{2}\\right] \\;+\\; \\left[n q + n - \\frac{q^2 + q}{2}\\right].\n$$\n合并各项得到闭式形式\n$$\nT(n,p,q) \\;=\\; n(p + q + 1) \\;-\\; \\frac{p^2 + p + q^2 + q}{2}.\n$$\n\n为了总结其规模，注意到对于固定的 $p$ 和 $q$，\n$$\nT(n,p,q) \\;=\\; n(p + q + 1) \\;-\\; \\frac{p^2 + p + q^2 + q}{2} \\;\\leq\\; n(p + q + 1),\n$$\n并且被减去的项与 $n$ 无关。因此，当 $n \\to \\infty$ 时，存储量随 $n$ 线性增长，并与 $p + q$ 成正比，即 $T(n,p,q) = O\\!\\left(n(p + q)\\right)$，符合要求。",
            "answer": "$$\\boxed{n(p+q+1)-\\frac{p^2+p+q^2+q}{2}}$$"
        },
        {
            "introduction": "在了解了带状矩阵的内存成本之后，一个关键的实践问题是：我们应该在什么时候选择使用带状求解器？本练习通过推导带状求解器的计算复杂度和存储复杂度，并将其与密集矩阵求解器进行比较，从而确定其性能优势的明确阈值 。掌握这项技能对于在科学计算中做出明智的算法选择至关重要。",
            "id": "3534191",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个带状矩阵，其下带宽为 $p \\geq 0$，上带宽为 $q \\geq 0$，这意味着当 $i - j > p$ 或 $j - i > q$ 时，$A_{ij} = 0$。考虑使用直接分解法求解 $A x = b$。假设可以进行高斯消元，并且不会在带外产生填充（例如，由于矩阵结构或保持带状结构的主元选择策略）。你可以假设以下为基本事实：(i) 一次标量融合乘加的运算成本（以浮点运算次数衡量）为 $2$ 次浮点运算，(ii) 一个 $n \\times n$ 稠密矩阵采用部分选主元的高斯消元法渐近需要 $\\tfrac{2}{3} n^{3}$ 次浮点运算并存储 $\\Theta(n^{2})$ 个实数，以及 (iii) $A$ 的带状存储只需要存储带内的非零元素。\n\n基于带宽的定义和高斯消元法的结构，推导出带状高斯消元法的主阶运算成本和存储成本，用 $n$、$p$ 和 $q$ 表示。然后，通过将这些成本与稠密矩阵的情况进行比较，确定明确的渐近阈值函数 $\\tau_{t}(n)$ 和 $\\tau_{m}(n)$，它们具有以下性质：如果当 $n \\to \\infty$ 时，$p q = o(\\tau_{t}(n))$ 且 $p + q = o(\\tau_{m}(n))$，那么带状直接求解器分别在时间和内存上渐近优于稠密求解器。将 $\\tau_{t}(n)$ 和 $\\tau_{m}(n)$ 表示为关于 $n$ 的最简闭合形式函数。\n\n你的最终答案必须以一个单行矩阵的形式给出，其中按顺序包含 $\\tau_{t}(n)$ 和 $\\tau_{m}(n)$ 的闭合形式解析表达式。不需要进行数值四舍五入。",
            "solution": "问题要求推导使用高斯消元法求解带状线性系统 $A x = b$ 的主阶运算成本和存储成本，并随后找到阈值函数 $\\tau_t(n)$ 和 $\\tau_m(n)$，以确定带状方法何时渐近优于稠密求解器。\n\n首先，我们分析带状高斯消元法的运算成本。该过程包括两个阶段：矩阵 $A$ 的 LU 分解，然后是用于求解 $x$ 的前向和后向代换。\n\n设 $A$ 是一个具有下带宽 $p$ 和上带宽 $q$ 的 $n \\times n$ 矩阵。高斯消元过程分 $n-1$ 步进行。在第 $k$ 步（$k=1, 2, \\dots, n-1$），我们消去第 $k$ 列主对角线下方的非零元素。\n\n由于下带宽为 $p$，在第 $k$ 步需要消去的非零元素仅为 $A_{ik}$，其中 $i = k+1, \\dots, \\min(n, k+p)$。最多有 $p$ 个这样的元素。对于每个这样的行 $i$，我们执行行操作 $R_i \\leftarrow R_i - m_{ik}R_k$，其中乘数为 $m_{ik} = A_{ik}/A_{kk}$。计算这 $p$ 个乘数中的每一个需要 1 次浮点运算 (flop)。\n\n主元行 $R_k$ 仅在满足 $j-k \\le q$（即 $j \\le k+q$）的列 $j$ 中有非零元素。更新操作 $A_{ij} \\leftarrow A_{ij} - m_{ik}A_{kj}$ 是一次融合乘加，成本为 2 次浮点运算。对于每个在前面的步骤之后 $A_{kj}$ 和 $A_{ij}$ 都可能为非零的列 $j$，都需要执行此更新。无带外填充的假设意味着我们只需要考虑第 $k$ 行带内的列。用于更新的相关列为 $j = k+1, \\dots, \\min(n, k+q)$。这样的列数最多为 $q$。\n\n因此，在第 $k$ 步，对于要更新的 $p$ 行中的每一行，我们执行 $q$ 次融合乘加操作。假设 $k$ 距离矩阵边界足够远（即 $k \\le n-p$ 和 $k \\le n-q$），第 $k$ 步的总浮点运算次数约等于计算乘数和执行行更新的成本之和：$p \\times (1 \\text{ flop/division}) + p \\times q \\times (2 \\text{ flops/FMA}) = p(1+2q)$ 次浮点运算。主导项是 $2pq$。\n\nLU 分解的总成本 $C_{LU}$ 是所有 $n-1$ 步的成本之和。对于大的 $n$ 且 $p, q \\ll n$，我们可以用主阶项 $2pq$ 来近似每一步的成本。\n$$C_{LU} \\approx \\sum_{k=1}^{n-1} 2pq = 2pq(n-1)$$\n渐近地，当 $n \\to \\infty$ 时，主阶成本为 $2npq$ 次浮点运算。\n\n接下来，我们考虑代换阶段。分解 $A=LU$ 产生一个下带宽为 $p$ 的下三角矩阵 $L$ 和一个上带宽为 $q$ 的上三角矩阵 $U$。\n求解 $Ly=b$（前向代换）需要对 $i=1, \\dots, n$ 计算 $y_i = (b_i - \\sum_{j=\\max(1, i-p)}^{i-1} L_{ij}y_j)$。每一步最多涉及 $p$ 次乘加运算。总成本约为 $2np$ 次浮点运算。\n求解 $Ux=y$（后向代换）需要对 $i=n, \\dots, 1$ 计算 $x_i = (y_i - \\sum_{j=i+1}^{\\min(n, i+q)} U_{ij}x_j)/U_{ii}$。每一步最多涉及 $q$ 次乘加运算。总成本约为 $2nq$ 次浮点运算。\n\n带状求解器的总运算成本 $C_t^{\\text{banded}}$ 是这些成本的总和：\n$$C_t^{\\text{banded}} \\approx 2npq + 2np + 2nq = 2n(pq+p+q)$$\n对于 $p \\geq 1$ 和 $q \\geq 1$，主导项是 $2npq$。如果 $p=0$ 或 $q=0$，成本会更低，但表达式 $2n(pq+p+q)$ 仍然是一个有效的主阶近似。因此，主阶运算成本为 $C_t^{\\text{banded}} \\sim 2npq$。\n\n现在，我们分析存储成本。问题陈述中提到使用带状存储，并且带外没有填充。这意味着 LU 因子可以存储在最初为 $A$ 分配的相同空间中。矩阵 $A$ 有 $p$ 条下对角线、1 条主对角线和 $q$ 条上对角线。对角线的总数为 $p+q+1$。对于一个大的 $n \\times n$ 矩阵，每条对角线上的元素数量约为 $n$。因此，需要存储的非零元素总数约为 $n(p+q+1)$。主阶存储成本为 $C_m^{\\text{banded}} \\sim n(p+q)$ 个浮点数。\n\n为了找到阈值函数，我们将这些成本与稠密情况进行比较。\n一个稠密 $n \\times n$ 矩阵求解器的成本给出如下：\n运算成本：$C_t^{\\text{dense}} \\sim \\frac{2}{3}n^3$ 次浮点运算。\n存储成本：$C_m^{\\text{dense}} = \\Theta(n^2)$，我们取其为 $C_m^{\\text{dense}} \\sim n^2$ 个数。\n\n如果当 $n \\to \\infty$ 时，$C_t^{\\text{banded}} = o(C_t^{\\text{dense}})$，则带状求解器在时间上渐近优于稠密求解器。\n$$2npq = o\\left(\\frac{2}{3}n^3\\right)$$\n两边除以 $2n$ 并将常数因子 $\\frac{1}{3}$ 吸收到小o符号中，我们得到：\n$$pq = o(n^2)$$\n问题将阈值函数 $\\tau_t(n)$ 定义为使得性能提升的条件是 $pq = o(\\tau_t(n))$。通过直接比较，我们确定：\n$$\\tau_t(n) = n^2$$\n\n如果当 $n \\to \\infty$ 时，$C_m^{\\text{banded}} = o(C_m^{\\text{dense}})$，则带状求解器在内存上渐近优于稠密求解器。\n$$n(p+q) = o(n^2)$$\n两边除以 $n$，我们得到：\n$$p+q = o(n)$$\n问题将阈值函数 $\\tau_m(n)$ 定义为使得内存节省的条件是 $p+q = o(\\tau_m(n))$。通过直接比较，我们确定：\n$$\\tau_m(n) = n$$\n\n因此，阈值函数为 $\\tau_t(n)=n^2$ 和 $\\tau_m(n)=n$。如果半带宽之积 $pq$ 的增长速度慢于 $n^2$，则带状求解器渐近地更快；如果总带宽 $p+q$ 的增长速度慢于 $n$，则它在内存上渐近地更高效。",
            "answer": "$$\\boxed{\\begin{pmatrix} n^2 & n \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然带宽是衡量稀疏性的一个有用指标，但它并非故事的全部。这个高级练习将介绍矩阵“轮廓”（profile）这一更精细的概念，它是衡量 Cholesky 分解过程中填充量的更精确指标。通过为一个具体问题比较两种不同的节点排序方式，你将亲眼见证一个巧妙的置换如何显著降低计算成本 ，这是高性能稀疏矩阵计算中的一项关键技术。",
            "id": "3534179",
            "problem": "考虑一个 $n \\times n$ 的实对称正定 (SPD) 矩阵 $A$，其关联的无向图为 $G(A)$，顶点集为 $\\{1,2,\\dots,n\\}$，其中，当且仅当对于 $i \\neq j$ 有 $a_{ij} \\neq 0$ 时，顶点 $i$ 和 $j$ 相邻。对于 $\\{1,2,\\dots,n\\}$ 的一个置换 $\\pi$，令 $P_{\\pi}$ 表示相应的置换矩阵，并考虑对称置换后的矩阵 $A_{\\pi} = P_{\\pi}^{\\top} A P_{\\pi}$。$A_{\\pi}$ 的带宽（具体来说是半带宽）定义为 $w(A_{\\pi}) = \\max\\{|i - j| : (A_{\\pi})_{ij} \\neq 0\\}$。$A_{\\pi}$ 的对称轮廓（也称为包络）定义为\n$$\n\\operatorname{prof}(A_{\\pi}) = \\sum_{i=1}^{n} \\big(i - f_{i}(A_{\\pi})\\big),\n$$\n其中，如果集合非空，$f_{i}(A_{\\pi}) = \\min\\{\\, j \\leq i : (A_{\\pi})_{ij} \\neq 0 \\,\\}$；如果第 $i$ 行在对角线左侧严格区域没有非零元，则 $f_{i}(A_{\\pi}) = i$。在 SPD 矩阵的变带宽 (skyline) Cholesky 分解中，一个经过充分检验的事实是：分解因子中存储的严格下对角线非零元数量等于 $\\operatorname{prof}(A_{\\pi})$，并且对称置换会改变轮廓，但绝不会在包络外产生填充。\n\n你的任务是根据上述定义进行严格推理，并用它们来量化通过合适的置换来最小化轮廓可以如何减少填充，同时保持存储中可用的半带宽参数 $w$ 固定不变（也就是说，你可以选择任何满足 $w(A_{\\pi}) \\leq w$ 的置换 $\\pi$，而存储/算法所使用的已声明的半带宽参数 $w$ 保持不变）。\n\n为了使问题具体化，考虑一个 $m \\geq 2$ 的 $2 \\times m$ 矩形网格图（一个“梯形图”），其顶点为 $\\{(r,c) : r \\in \\{1,2\\},\\, c \\in \\{1,2,\\dots,m\\}\\}$，其边连接每行中的水平最近邻和每列内的垂直最近邻。设 $A$ 是一个 SPD 矩阵，其构造方法为：在每个顶点上放置一个正对角元 $d > 0$，并在每条边上放置一个对称权重 $-1$，使得 $A$ 是严格对角占优的，并因此是 SPD 矩阵。在两种对称置换下对顶点进行索引：\n- 自然行主序 $\\pi_{\\mathrm{nat}}$: $(1,1),(1,2),\\dots,(1,m),(2,1),(2,2),\\dots,(2,m)$。\n- 列交错序 $\\pi_{\\mathrm{col}}$: $(1,1),(2,1),(1,2),(2,2),\\dots,(1,m),(2,m)$。\n\n你可以认为已知 $w(A_{\\pi_{\\mathrm{nat}}}) = m$ 和 $w(A_{\\pi_{\\mathrm{col}}}) = 2 \\leq m$，因此，如果存储中可用的半带宽参数固定为 $w = m$，则两种排序都是允许的。仅使用上述定义和关于 SPD 矩阵的 skyline Cholesky 分解的标准事实，计算精确比率\n$$\nR(m) \\equiv \\frac{\\operatorname{prof}(A_{\\pi_{\\mathrm{col}}})}{\\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}})}\n$$\n结果表示为关于 $m$ 的封闭形式解析表达式。\n\n你的最终答案必须是 $R(m)$ 的这个精确表达式（无单位）。不要提供不等式或等式。不需要四舍五入。",
            "solution": "问题要求我们计算与 $2 \\times m$ 网格图相关的对称正定矩阵 $A$ 在两种不同顶点排序下的轮廓比率 $R(m) = \\frac{\\operatorname{prof}(A_{\\pi_{\\mathrm{col}}})}{\\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}})}$。顶点总数为 $n = 2m$。对称轮廓的定义为 $\\operatorname{prof}(A_{\\pi}) = \\sum_{i=1}^{n} (i - f_{i}(A_{\\pi}))$，其中 $f_{i}(A_{\\pi}) = \\min\\{ j \\leq i : (A_{\\pi})_{ij} \\neq 0 \\}$。由于矩阵 $A$ 对角元为正，对所有 $i$ 都有 $(A_{\\pi})_{ii} \\neq 0$，因此 $f_i(A_{\\pi})$ 总有定义。\n\n我们将分别计算每种排序的轮廓。\n\n**1. 自然行主序 ($\\pi_{\\mathrm{nat}}$)**\n\n顶点按行排序：$(1,1), \\dots, (1,m), (2,1), \\dots, (2,m)$。从网格顶点 $(r,c)$ 到其索引 $i$ 的映射是：\n- 对于 $r=1$ (第一行), 顶点 $(1,c)$ 映射到索引 $i=c$。\n- 对于 $r=2$ (第二行), 顶点 $(2,c)$ 映射到索引 $i=m+c$。\n\n我们对每个 $i=1, \\dots, 2m$ 确定 $f_i = f_i(A_{\\pi_{\\mathrm{nat}}})$：\n- **对于第一行的顶点 ($i \\in \\{1, \\dots, m\\}$):** 顶点 $i$ 对应于 $(1,i)$。它在图上与 $(1, i-1)$ (如果 $i>1$) 和 $(2,i)$ (索引为 $m+i$) 相邻。我们只关心索引小于或等于 $i$ 的邻居。\n  - 对于 $i=1$ (顶点 $(1,1)$)，没有索引小于1的邻居，因此 $f_1 = 1$。其对轮廓的贡献为 $1 - 1 = 0$。\n  - 对于 $i \\in \\{2, \\dots, m\\}$ (顶点 $(1,i)$)，其最左侧的邻居是 $(1, i-1)$，索引为 $i-1$。因此 $f_i = i-1$。其贡献为 $i - (i-1) = 1$。\n  - 第一行顶点的总轮廓贡献为 $0 + (m-1) \\times 1 = m-1$。\n\n- **对于第二行的顶点 ($i \\in \\{m+1, \\dots, 2m\\}$):** 顶点 $i$ 对应于 $(2,c)$，其中 $i = m+c$。它在图上与 $(2, c-1)$ (索引 $i-1=m+c-1$，如果 $c>1$) 和 $(1,c)$ (索引 $c$) 相邻。\n  - 对于所有 $c \\in \\{1, \\dots, m\\}$，我们需要在所有邻居索引中找到最小值。邻居 $(1,c)$ 的索引是 $c$，邻居 $(2,c-1)$ 的索引是 $i-1$。由于对于所有 $c \\ge 1$ 和 $m \\ge 1$ 都有 $c  m+c-1$，因此最左侧的非对角非零元总是对应于与第一行顶点的连接。\n  - 所以，对于 $i=m+c$，$f_i = c$。其对轮廓的贡献为 $i - f_i = (m+c) - c = m$。\n  - 这对第二行的所有 $m$ 个顶点都成立。因此，第二行顶点的总轮廓贡献为 $m \\times m = m^2$。\n\n- **总轮廓:** $\\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}}) = (m-1) + m^2 = m^2 + m - 1$。\n\n**2. 列交错序 ($\\pi_{\\mathrm{col}}$)**\n\n顶点按列交错排序：$(1,1), (2,1), (1,2), (2,2), \\dots, (1,m), (2,m)$。从网格顶点 $(r,c)$ 到其索引 $i$ 的映射为 $i = 2(c-1)+r$。\n\n- **对于奇数索引的顶点 ($i = 2c-1$, 对应 $(1,c)$):** 顶点 $i$ 与 $(1, c-1)$ (索引 $i-2$, 如果 $c>1$) 和 $(2,c)$ (索引 $i+1$) 相邻。\n  - 对于 $i=1$ (顶点 $(1,1)$)，没有索引小于1的邻居。$f_1 = 1$。贡献为 $0$。\n  - 对于 $i \\ge 3$，最左侧邻居的索引是 $i-2$。$f_i = i-2$。贡献为 $2$。\n\n- **对于偶数索引的顶点 ($i = 2c$, 对应 $(2,c)$):** 顶点 $i$ 与 $(2, c-1)$ (索引 $i-2$, 如果 $c>1$) 和 $(1,c)$ (索引 $i-1$) 相邻。\n  - 对于 $i=2$ (顶点 $(2,1)$)，最左侧邻居是 $(1,1)$，索引为1。$f_2=1$。贡献为 $1$。\n  - 对于 $i \\ge 4$，最左侧邻居的索引是 $\\min(i-1, i-2) = i-2$。$f_i = i-2$。贡献为 $2$。\n\n- **总轮廓:** $\\operatorname{prof}(A_{\\pi_{\\mathrm{col}}})$ 是所有贡献之和：\n  - $i=1$ 的贡献：0\n  - $i=2$ 的贡献：1\n  - $i=3, \\dots, 2m$ 的贡献：对于这 $(2m-2)$ 个顶点，每个贡献为 2。\n  - 总和为 $0 + 1 + 2 \\times (2m-2) = 1 + 4m - 4 = 4m-3$。\n\n**3. 比率 $R(m)$**\n\n最后，我们计算比率：\n$$\nR(m) = \\frac{\\operatorname{prof}(A_{\\pi_{\\mathrm{col}}})}{\\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}})} = \\frac{4m-3}{m^2+m-1}\n$$\n这表明对于较大的 $m$，列交错序能显著减小矩阵轮廓（$O(m)$ vs $O(m^2)$），从而大幅减少 Cholesky 分解中的填充和计算成本。",
            "answer": "$$\\boxed{\\frac{4m-3}{m^2+m-1}}$$"
        }
    ]
}