{
    "hands_on_practices": [
        {
            "introduction": "带状矩阵的主要优势在于其稀疏结构，这能有效节省存储空间和计算资源。本练习旨在从第一性原理出发，通过分析高斯消元过程对带状结构的影响，精确推导其LU分解后$L$和$U$因子的存储成本。掌握这一推导过程，是理解和量化带状求解器效率优势的基础，它将帮助你建立对算法存储效率的直观感知。",
            "id": "3534144",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个非奇异矩阵，其下带宽为 $p$，上带宽为 $q$，即当 $i - j > p$ 或 $j - i > q$ 时，$a_{ij} = 0$。其中 $n \\in \\mathbb{N}$ 且 $0 \\leq p, q \\leq n - 1$。假设不带主元选择的高斯消元法适用于矩阵 $A$（因此所有顺序主子式均非奇异），且其得到的 $LU$ 分解 $A = LU$ 按以下约定存储：\n- $L$ 是单位下三角矩阵，只存储其严格下对角线上的元素。\n- $U$ 是上三角矩阵，存储其对角线及以上所有结构上非零的元素。\n\n从带状结构和高斯消元法的定义出发，分析消元过程如何影响带内的稀疏性，论证 $L$ 和 $U$ 的带宽，然后通过计算这些带宽所隐含的每行（或每列）的非零元素数量，推导出在上述存储约定下存储这些 $LU$ 因子所需的浮点标量总数的封闭形式表达式 $T(n,p,q)$。从第一性原理出发，总结为什么当 $p$ 和 $q$ 固定时，随着 $n \\to \\infty$，存储量会按 $\\mathcal{O}(n(p+q))$ 的规模增长。\n\n你的最终答案必须是封闭形式的精确解析表达式 $T(n,p,q)$。不要提供不等式或大-$\\mathcal{O}$ 表达式作为最终答案。",
            "solution": "我们从带状矩阵的定义开始。一个矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的下带宽为 $p$，上带宽为 $q$，如果当 $i - j > p$ 或 $j - i > q$ 时，$a_{ij} = 0$。等价地，在每一行 $i$ 中，非零元素只能出现在满足 $i - p \\leq j \\leq i + q$ 的列 $j$ 中，并与有效索引范围取交集。\n\n我们对 $A$ 应用不带主元选择的高斯消元法，假设每个顺序主子式都非奇异，因此所有消元步骤都是良定义的。在第 $k$ 步消元中，我们通过为 $i = k+1, \\dots, \\min\\{n, k + p\\}$ 形成乘子 $l_{ik} = a_{ik}^{(k)}/a_{kk}^{(k)}$ 来消除第 $k$ 列主元下方的元素，因为当 $i - k > p$ 时 $a_{ik}^{(k)} = 0$。因此，在 $L$ 的第 $k$ 列中，只有到第 $k + p$ 行才可能包含非零乘子。这表明 $L$ 最多有 $p$ 条次对角线，即 $L$ 的下带宽为 $p$。由于 $L$ 是单位下三角矩阵，按照约定其对角线元素为 $1$，并且在所述的存储方案下不被存储。\n\n我们现在考虑消元过程对上三角因子 $U$ 的影响。在第 $k$ 步，舒尔补更新通过减去行 $k+1:\\min\\{n, k + p\\}$ 中的乘子向量与列 $k+1:\\min\\{n, k + q\\}$ 中的主元行元素向量的外积来修改尾随子矩阵。由于主元行 $k$ 中的非零元素最多延伸到第 $k + q$ 列，而非零乘子最多延伸到第 $k + p$ 行，因此该更新不会在原始带之外产生非零元素：对于任何满足 $j - i > q$ 或 $i - j > p$ 的位置 $(i,j)$，根据外积的结构，更新后的值仍为零。因此，对 $k$ 的归纳论证表明，中间的舒尔补仍然保持相同的 $(p,q)$ 带状结构，因此 $U$ 仅在对角线及其上方的 $q$ 条超对角线内累积非零元素。所以，$U$ 的上带宽为 $q$。\n\n确定了 $L$ 和 $U$ 的带宽后，我们现在根据所述的存储约定来计算存储的元素数量。\n\n- 对于 $U$：在第 $i$ 行，对角线及其上方的非零元素延伸至第 $\\min\\{n, i + q\\}$ 列，因此第 $i$ 行存储的元素数量为\n$$\n\\#U(i) \\;=\\; \\min\\{n, i+q\\} - i + 1 \\,.\n$$\n对于行 $i = 1, \\dots, n - q$，此计数等于 $q + 1$。对于最后 $q$ 行，即 $i = n - q + 1, \\dots, n$，计数从 $q$ 线性递减至 $1$。求和得，\n$$\n\\#U \\;=\\; \\sum_{i=1}^{n - q} (q + 1) \\;+\\; \\sum_{k=1}^{q} k \\;=\\; (n - q)(q + 1) \\;+\\; \\frac{q(q + 1)}{2} \\,.\n$$\n这可以等价地写为\n$$\n\\#U \\;=\\; n q + n \\;-\\; \\frac{q^2 + q}{2} \\,.\n$$\n\n- 对于 $L$（不包括单位对角线）：在第 $i$ 行，严格下对角线元素的数量为 $\\min\\{p, i - 1\\}$。因此，\n$$\n\\#L_{\\text{sub}} \\;=\\; \\sum_{i=1}^{n} \\min\\{p, i - 1\\} \\,.\n$$\n对于 $0 \\leq p \\leq n - 1$，这个和可以分解为一个初始的递增部分和一个平台部分：\n$$\n\\#L_{\\text{sub}} \\;=\\; \\sum_{i=1}^{p+1} (i - 1) \\;+\\; \\sum_{i=p+2}^{n} p \\;=\\; \\frac{p(p + 1)}{2} \\;+\\; p(n - p - 1) \\,.\n$$\n化简后得到\n$$\n\\#L_{\\text{sub}} \\;=\\; np - \\frac{p^2+p}{2} \\,.\n$$\n\n存储的标量总数是两部分之和\n$$\nT(n,p,q) \\;=\\; \\#L_{\\text{sub}} \\;+\\; \\#U \\;=\\; \\left[np - \\frac{p^2+p}{2}\\right] \\;+\\; \\left[n q + n - \\frac{q^2 + q}{2}\\right].\n$$\n合并同类项得到封闭形式\n$$\nT(n,p,q) \\;=\\; n(p + q + 1) \\;-\\; \\frac{p^2 + p + q^2 + q}{2}.\n$$\n\n为了总结其规模，注意到对于固定的 $p$ 和 $q$，\n$$\nT(n,p,q) \\;=\\; n(p + q + 1) \\;-\\; \\frac{p^2 + p + q^2 + q}{2} \\;\\leq\\; n(p + q + 1),\n$$\n并且减去的项与 $n$ 无关。因此，当 $n \\to \\infty$ 时，存储量随 $n$ 线性增长，并与 $p + q$ 成正比，即 $T(n,p,q) = \\mathcal{O}\\!\\left(n(p + q)\\right)$，符合要求。",
            "answer": "$$\\boxed{n(p+q+1)-\\frac{p^2+p+q^2+q}{2}}$$"
        },
        {
            "introduction": "在量化了存储优势后，一个更实际的问题是：我们应该在何时选择带状求解器而非标准的稠密求解器？本练习将分析的重点从存储成本转向计算复杂度，通过推导带状高斯消元的运算量，并与稠密矩阵方法进行比较，你将学会建立明确的性能判断准则。这种渐近分析对于在实践中根据问题规模和带宽来选择最优算法至关重要。",
            "id": "3534191",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个带状矩阵，其下带宽为 $p \\geq 0$，上带宽为 $q \\geq 0$，意即当 $i - j > p$ 或 $j - i > q$ 时，$A_{ij} = 0$。考虑使用直接分解法求解 $A x = b$。假设可以进行高斯消元，并且不会在带外产生非零元素（填充）（例如，由于保持带状结构的特殊结构或主元选择策略）。您可以假定以下为基本事实：(i) 一次标量融合乘加运算的算术成本（以浮点运算次数衡量）为 $2$ 次浮点运算，(ii) 对一个 $n \\times n$ 的稠密矩阵进行部分主元高斯消元，渐近需要 $\\frac{2}{3}n^3$ 次浮点运算，并存储 $\\Theta(n^2)$ 个实数，以及 (iii) 带状矩阵 $A$ 的存储只需存储带内的非零元素。\n\n从带宽的定义和高斯消元的结构出发，推导带状高斯消元的主阶算术成本和存储成本，用 $n$、$p$ 和 $q$ 表示。然后，通过将这些成本与稠密矩阵的情况进行比较，确定明确的渐近阈值函数 $\\tau_{t}(n)$ 和 $\\tau_{m}(n)$，它们具有以下性质：当 $n \\to \\infty$ 时，如果 $p q = o(\\tau_{t}(n))$ 且 $p + q = o(\\tau_{m}(n))$，则带状直接求解器在时间和内存上分别渐近优于稠密求解器。将 $\\tau_{t}(n)$ 和 $\\tau_{m}(n)$ 表示为关于 $n$ 的最简闭合形式函数。\n\n您的最终答案必须以单行矩阵的形式给出，其中按顺序包含 $\\tau_{t}(n)$ 和 $\\tau_{m}(n)$ 的闭合形式解析表达式。不需要进行数值取整。",
            "solution": "该问题要求推导使用高斯消元法求解带状线性系统 $A x = b$ 的主阶算术成本和存储成本，并随后找出阈值函数 $\\tau_t(n)$ 和 $\\tau_m(n)$，这些函数决定了带状方法何时在渐近意义上优于稠密求解器。\n\n首先，我们分析带状高斯消元的算术成本。该过程包括两个阶段：矩阵 $A$ 的 LU 分解，然后是通过向前和向后代入求解 $x$。\n\n设 $A$ 是一个具有下带宽 $p$ 和上带宽 $q$ 的 $n \\times n$ 矩阵。高斯消元过程分 $n-1$ 步进行。在第 $k$ 步（$k=1, 2, \\dots, n-1$），我们消去第 $k$ 列主对角线下方的非零元素。\n\n由于下带宽为 $p$，在第 $k$ 步需要消去的非零元素仅为 $A_{ik}$，其中 $i = k+1, \\dots, \\min(n, k+p)$。最多有 $p$ 个这样的元素。对于每个这样的行 $i$，我们执行行操作 $R_i \\leftarrow R_i - m_{ik}R_k$，其中乘数是 $m_{ik} = A_{ik}/A_{kk}$。计算 $p$ 个乘数中的每一个都需要 1 次浮点运算 (flop)。\n\n主元行 $R_k$ 仅在满足 $j-k \\le q$（即 $j \\le k+q$）的列 $j$ 中有非零元素。更新操作 $A_{ij} \\leftarrow A_{ij} - m_{ik}A_{kj}$ 是一次融合乘加运算，成本为 2 次浮点运算。对于先前步骤后 $A_{kj}$ 和 $A_{ij}$ 都可能为非零的每一列 $j$，都需要执行此更新。没有带外填充的假设意味着我们只需要考虑第 $k$ 行带内的列。更新的相关列是 $j = k+1, \\dots, \\min(n, k+q)$。这样的列数最多为 $q$。\n\n因此，在第 $k$ 步，对于正在更新的 $p$ 行中的每一行，我们执行 $q$ 次融合乘加运算。假设 $k$ 离矩阵边界足够远（即 $k \\le n-p$ 和 $k \\le n-q$），第 $k$ 步的总浮点运算次数约等于计算乘数的成本与执行行更新的成本之和：$p \\times (1 \\text{ flop/division}) + p \\times q \\times (2 \\text{ flops/FMA}) = p(1+2q)$ 次浮点运算。主导项是 $2pq$。\n\nLU 分解的总成本 $C_{LU}$ 是所有 $n-1$ 步成本的总和。对于大 $n$ 且 $p, q \\ll n$ 的情况，我们可以用主阶项 $2pq$ 来近似每一步的成本。\n$$C_{LU} \\approx \\sum_{k=1}^{n-1} 2pq = 2pq(n-1)$$\n当 $n \\to \\infty$ 时，渐近地，主阶成本是 $2npq$ 次浮点运算。\n\n接下来，我们考虑代入阶段。分解 $A=LU$ 产生一个下带宽为 $p$ 的下三角矩阵 $L$ 和一个上带宽为 $q$ 的上三角矩阵 $U$。\n求解 $Ly=b$（向前代入）需要计算 $y_i = (b_i - \\sum_{j=\\max(1, i-p)}^{i-1} L_{ij}y_j)$，其中 $i=1, \\dots, n$。每一步最多涉及 $p$ 次乘加运算。总成本约为 $2np$ 次浮点运算。\n求解 $Ux=y$（向后代入）需要计算 $x_i = (y_i - \\sum_{j=i+1}^{\\min(n, i+q)} U_{ij}x_j)/U_{ii}$，其中 $i=n, \\dots, 1$。每一步最多涉及 $q$ 次乘加运算。总成本约为 $2nq$ 次浮点运算。\n\n带状求解器的总算术成本 $C_t^{\\text{banded}}$ 是这些成本的总和：\n$$C_t^{\\text{banded}} \\approx 2npq + 2np + 2nq = 2n(pq+p+q)$$\n对于 $p \\geq 1$ 和 $q \\geq 1$，主导项是 $2npq$。如果 $p=0$ 或 $q=0$，成本会更低，但表达式 $2n(pq+p+q)$ 仍然是一个有效的主阶近似。因此，主阶算术成本为 $C_t^{\\text{banded}} \\sim 2npq$。\n\n现在，我们分析存储成本。问题指出使用带状存储，并且带外没有填充。这意味着 LU 因子可以存储在最初为 $A$ 分配的相同空间中。矩阵 $A$ 有 $p$ 条下对角线、1 条主对角线和 $q$ 条上对角线。对角线的总数为 $p+q+1$。对于一个大的 $n \\times n$ 矩阵，每条对角线中的元素数量约等于 $n$。因此，需要存储的非零元素总数约为 $n(p+q+1)$。主阶存储成本为 $C_m^{\\text{banded}} \\sim n(p+q)$ 个浮点数。\n\n为了找到阈值函数，我们将这些成本与稠密矩阵的情况进行比较。\n对于一个稠密的 $n \\times n$ 矩阵求解器，其成本如下：\n算术成本：$C_t^{\\text{dense}} \\sim \\frac{2}{3}n^3$ 次浮点运算。\n存储成本：$C_m^{\\text{dense}} = \\Theta(n^2)$，我们将其视为 $C_m^{\\text{dense}} \\sim n^2$ 个数。\n\n当 $n \\to \\infty$ 时，如果 $C_t^{\\text{banded}} = o(C_t^{\\text{dense}})$，则带状求解器在时间上渐近优于稠密求解器。\n$$2npq = o\\left(\\frac{2}{3}n^3\\right)$$\n两边除以 $2n$ 并将常数因子 $\\frac{1}{3}$ 吸收到小o符号中，我们得到：\n$$pq = o(n^2)$$\n问题将阈值函数 $\\tau_t(n)$ 定义为性能增益的条件是 $pq = o(\\tau_t(n))$。通过直接比较，我们确定：\n$$\\tau_t(n) = n^2$$\n\n当 $n \\to \\infty$ 时，如果 $C_m^{\\text{banded}} = o(C_m^{\\text{dense}})$，则带状求解器在内存上渐近优于稠密求解器。\n$$n(p+q) = o(n^2)$$\n两边除以 $n$，我们得到：\n$$p+q = o(n)$$\n问题将阈值函数 $\\tau_m(n)$ 定义为内存节省的条件是 $p+q = o(\\tau_m(n))$。通过直接比较，我们确定：\n$$\\tau_m(n) = n$$\n\n因此，阈值函数是 $\\tau_t(n)=n^2$ 和 $\\tau_m(n)=n$。如果半带宽之积 $pq$ 的增长速度慢于 $n^2$，则带状求解器在渐近意义上更快；如果总带宽 $p+q$ 的增长速度慢于 $n$，则它在渐近意义上更节省内存。",
            "answer": "$$\\boxed{\\begin{pmatrix} n^2 & n \\end{pmatrix}}$$"
        },
        {
            "introduction": "我们已经知道，小带宽能带来巨大的计算优势。但我们还能做得更好吗？本练习引入了矩阵重排（reordering）这一高级优化技巧，揭示了矩阵的带宽并非决定计算成本的唯一因素。通过一个具体的例子，你将看到不同的变量排序如何显著改变矩阵的“轮廓”（profile），从而在不改变带宽的情况下，大幅减少因子分解过程中的填充（fill-in）和计算量，这是许多高性能科学计算软件库中的核心技术。",
            "id": "3534179",
            "problem": "考虑一个 $n \\times n$ 的实对称正定 (SPD) 矩阵 $A$，其关联一个顶点集为 $\\{1,2,\\dots,n\\}$ 的无向图 $G(A)$，其中任意两个不同的顶点 $i$ 和 $j$ 之间存在一条边，当且仅当 $a_{ij} \\neq 0$。对于 $\\{1,2,\\dots,n\\}$ 的一个置换 $\\pi$，令 $P_{\\pi}$ 表示相应的置换矩阵，并考虑对称置换矩阵 $A_{\\pi} = P_{\\pi}^{\\top} A P_{\\pi}$。$A_{\\pi}$ 的带宽 (具体来说，半带宽) 定义为 $w(A_{\\pi}) = \\max\\{|i - j| : (A_{\\pi})_{ij} \\neq 0\\}$。$A_{\\pi}$ 的对称剖面 (也称为包络) 定义为\n$$\n\\operatorname{prof}(A_{\\pi}) = \\sum_{i=1}^{n} \\big(i - f_{i}(A_{\\pi})\\big),\n$$\n其中，如果集合非空，$f_{i}(A_{\\pi}) = \\min\\{\\, j \\leq i : (A_{\\pi})_{ij} \\neq 0 \\,\\}$；如果第 $i$ 行在对角线左侧严格无非零元，则 $f_{i}(A_{\\pi}) = i$。在 SPD 矩阵的变带宽 (天际线) Cholesky 分解中，一个经过充分检验的事实是，存储在因子中的严格下对角非零元的数量等于 $\\operatorname{prof}(A_{\\pi})$，并且对称置换会改变剖面，但绝不会在包络外产生填充。\n\n你的任务是根据以上定义进行严谨推理，并用其量化如何通过合适的置换来最小化剖面，从而在保持存储中固定的半带宽参数 $w$ 的同时减少填充 (也就是说，你可以选择任何满足 $w(A_{\\pi}) \\leq w$ 的置换 $\\pi$，且存储/算法所使用的已声明半带宽参数 $w$ 保持不变)。\n\n为了使问题具体化，考虑一个 $m \\geq 2$ 的 $2 \\times m$ 矩形网格图 (一个“阶梯图”)，其顶点为 $\\{(r,c) : r \\in \\{1,2\\},\\, c \\in \\{1,2,\\dots,m\\}\\}$，其边连接每行中的水平最近邻和每列内的垂直最近邻。设 $A$ 是一个 SPD 矩阵，通过在每个顶点上放置一个正对角元 $d > 0$ 并在每条边上放置一个对称权重 $-1$ 得到，因此 $A$ 是严格对角占优的，故而是 SPD 矩阵。在两种对称置换下对顶点进行索引：\n- 自然行主序 $\\pi_{\\mathrm{nat}}$: $(1,1),(1,2),\\dots,(1,m),(2,1),(2,2),\\dots,(2,m)$。\n- 列交错序 $\\pi_{\\mathrm{col}}$: $(1,1),(2,1),(1,2),(2,2),\\dots,(1,m),(2,m)$。\n\n你可以认为已知 $w(A_{\\pi_{\\mathrm{nat}}}) = m$ 和 $w(A_{\\pi_{\\mathrm{col}}}) = 2 \\leq m$，因此如果存储中可用的半带宽参数固定为 $w = m$，则两种排序都是容许的。仅使用以上定义和关于 SPD 矩阵的天际线 Cholesky 分解的标准事实，计算精确比值\n$$\nR(m) \\equiv \\frac{\\operatorname{prof}(A_{\\pi_{\\mathrm{col}}})}{\\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}})}\n$$\n的闭式解析表达式。\n\n你的最终答案必须是 $R(m)$ 的这个精确表达式 (无单位)。不要提供不等式或方程式。无需四舍五入。",
            "solution": "我们的目标是计算两种不同顶点排序下矩阵剖面的比值 $R(m)$。顶点总数 $n=2m$。根据定义，对称剖面为 $\\operatorname{prof}(A_{\\pi}) = \\sum_{i=1}^{n} (i - f_{i}(A_{\\pi}))$，其中 $f_{i}(A_{\\pi})$ 是第 $i$ 行第一个非零元素的列索引。\n\n**1. 自然行主序 ($\\pi_{\\mathrm{nat}}$) 的剖面计算**\n\n在此排序下，顶点 $(r,c)$ 映射到索引 $i$ 的规则是：\n- 顶点 $(1,c)$ 映射到 $i=c$，对应索引 $1, \\dots, m$。\n- 顶点 $(2,c)$ 映射到 $i=m+c$，对应索引 $m+1, \\dots, 2m$。\n\n我们逐行确定 $f_i(A_{\\pi_{\\mathrm{nat}}})$：\n- 对于 $i \\in \\{1, \\dots, m\\}$（第一行顶点）：顶点 $(1,i)$ 与 $(1,i-1)$ (索引 $i-1$) 和 $(2,i)$ (索引 $m+i$) 相邻。由于 $i-1  i  m+i$，因此第 $i$ 行第一个非零下对角元素的索引是 $i-1$（当 $i>1$ 时）。对于 $i=1$，没有索引小于1的邻居，所以 $f_1 = 1$。因此，对这部分行剖面的贡献是：\n$$ \\sum_{i=1}^{m} (i - f_i) = (1-1) + \\sum_{i=2}^{m} (i - (i-1)) = 0 + \\sum_{i=2}^{m} 1 = m-1 $$\n- 对于 $i \\in \\{m+1, \\dots, 2m\\}$（第二行顶点）：顶点是 $(2, c)$，其中 $i=m+c$。它与 $(2,c-1)$ (索引 $i-1$) 和 $(1,c)$ (索引 $c=i-m$) 相邻。由于 $i-m  i-1  i$，第一个非零元素的列索引是 $i-m$。因此，$f_i = i-m$。对这部分行剖面的贡献是：\n$$ \\sum_{i=m+1}^{2m} (i - f_i) = \\sum_{i=m+1}^{2m} (i - (i-m)) = \\sum_{i=m+1}^{2m} m = m \\cdot m = m^2 $$\n因此，总剖面为：\n$$ \\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}}) = (m-1) + m^2 = m^2+m-1 $$\n\n**2. 列交错序 ($\\pi_{\\mathrm{col}}$) 的剖面计算**\n\n在此排序下，顶点 $(r,c)$ 映射到索引 $i$ 的规则是：\n- 顶点 $(1,c)$ 映射到 $i=2c-1$。\n- 顶点 $(2,c)$ 映射到 $i=2c$。\n\n我们按奇偶性确定 $f_i(A_{\\pi_{\\mathrm{col}}})$：\n- 对于奇数索引 $i=2c-1$（来自第一行的顶点 $(1,c)$）：它与 $(1,c-1)$ (索引 $2(c-1)-1 = i-2$) 和 $(2,c)$ (索引 $2c=i+1$) 相邻。第一个非零下对角元素的索引是 $i-2$（当 $c>1$ 时）。对于 $i=1$ ($c=1$)，$f_1 = 1$。对这部分行剖面的贡献是：\n$$ \\sum_{c=1}^{m} ((2c-1) - f_{2c-1}) = (1-1) + \\sum_{c=2}^{m} ((2c-1) - (2c-3)) = 0 + \\sum_{c=2}^{m} 2 = 2(m-1) $$\n- 对于偶数索引 $i=2c$（来自第二行的顶点 $(2,c)$）：它与 $(2,c-1)$ (索引 $2(c-1) = i-2$) 和 $(1,c)$ (索引 $2c-1 = i-1$) 相邻。第一个非零下对角元素的索引是 $i-2$（当 $c>1$ 时）。对于 $i=2$ ($c=1$)，它与索引为1的顶点相邻，所以 $f_2=1$。对这部分行剖面的贡献是：\n$$ \\sum_{c=1}^{m} (2c - f_{2c}) = (2 - f_2) + \\sum_{c=2}^{m} (2c - f_{2c}) = (2-1) + \\sum_{c=2}^{m} (2c - (2c-2)) = 1 + \\sum_{c=2}^{m} 2 = 1 + 2(m-1) $$\n因此，总剖面为：\n$$ \\operatorname{prof}(A_{\\pi_{\\mathrm{col}}}) = 2(m-1) + (1 + 2(m-1)) = 4m-4+1 = 4m-3 $$\n\n**3. 计算比值**\n\n最后，我们计算比值 $R(m)$：\n$$ R(m) = \\frac{\\operatorname{prof}(A_{\\pi_{\\mathrm{col}}})}{\\operatorname{prof}(A_{\\pi_{\\mathrm{nat}}})} = \\frac{4m-3}{m^2+m-1} $$",
            "answer": "$$\n\\boxed{\\frac{4m-3}{m^2+m-1}}\n$$"
        }
    ]
}