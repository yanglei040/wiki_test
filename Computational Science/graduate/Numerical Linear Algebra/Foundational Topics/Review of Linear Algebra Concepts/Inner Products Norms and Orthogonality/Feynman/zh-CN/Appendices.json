{
    "hands_on_practices": [
        {
            "introduction": "我们的几何直觉通常建立在标准的欧几里得内积（点积）之上。然而，通过引入一个对称正定矩阵 $W$，我们可以定义一个全新的加权内积，从而改变我们衡量向量长度和角度的方式。这个练习将指导你亲手计算一个加权内积如何改变两个向量之间的夹角 ，让你直观地理解它如何重新“加权”和“混合”坐标，这是许多高级算法（如预条件方法）背后的核心思想。",
            "id": "3551127",
            "problem": "设 $W \\in \\mathbb{R}^{3 \\times 3}$ 是对称正定 (SPD) 矩阵\n$$\nW \\;=\\; \\begin{pmatrix}\n3  1  0 \\\\\n1  2  1 \\\\\n0  1  4\n\\end{pmatrix},\n$$\n并设 $x, y \\in \\mathbb{R}^{3}$ 是向量 $x = \\begin{pmatrix} 1 \\\\ 2 \\\\ -1 \\end{pmatrix}$ 和 $y = \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix}$。仅使用有限维实向量空间上内积、由内积诱导的范数以及由内积诱导的角度的核心定义，计算由 $W$ 诱导的 $x$ 和 $y$ 之间的角度。同时计算 $x$ 和 $y$ 之间的欧几里得角，然后从第一性原理出发，除了定义之外不使用任何现成的公式，解释由 $W$ 定义的度量如何对坐标进行重新加权和混合，从而改变了相对于欧几里得情况下的角度。在你的解释中，通过 $W$ 的唯一具有正对角元的下三角 Cholesky 因子来解释 $W$。\n\n将由 $W$ 诱导的最终角度表示为精确的闭式解析表达式，单位为弧度。请勿近似计算。作为最终答案，仅提供以精确形式表示的 $W$-角度（单位为弧度）。",
            "solution": "首先验证问题的科学性、良定性和客观性。\n已知条件如下：\n一个对称矩阵 $W \\in \\mathbb{R}^{3 \\times 3}$：\n$$\nW \\;=\\; \\begin{pmatrix}\n3  1  0 \\\\\n1  2  1 \\\\\n0  1  4\n\\end{pmatrix}\n$$\n两个向量 $x, y \\in \\mathbb{R}^{3}$：\n$$\nx = \\begin{pmatrix} 1 \\\\ 2 \\\\ -1 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n问题陈述 $W$ 是对称正定 (SPD) 的。如果 $W = W^T$，则矩阵是对称的，经检验可知此条件成立。为验证正定性，我们使用 Sylvester 判据，检查各阶主子式的行列式：\n$D_1 = \\det(3) = 3 > 0$。\n$D_2 = \\det\\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} = 3 \\cdot 2 - 1 \\cdot 1 = 5 > 0$。\n$D_3 = \\det(W) = 3(2 \\cdot 4 - 1 \\cdot 1) - 1(1 \\cdot 4 - 0 \\cdot 1) = 3(7) - 4 = 17 > 0$。\n由于所有主子式均为正，因此 $W$ 确实是 SPD。\n该问题是良定的、自洽的且科学上是合理的。这是一个涉及内积空间的线性代数标准练习。因此，我们继续进行求解。\n\n实向量空间 $V$ 上内积的核心定义是一个函数 $\\langle \\cdot, \\cdot \\rangle: V \\times V \\to \\mathbb{R}$，它具有正定性、对称性和双线性。对于任何 SPD 矩阵 $W \\in \\mathbb{R}^{n \\times n}$，函数 $\\langle u, v \\rangle_W = u^T W v$ 在 $\\mathbb{R}^n$ 上定义了一个有效的内积。\n\n由该内积诱导的向量 $u$ 的范数是 $\\|u\\|_W = \\sqrt{\\langle u, u \\rangle_W} = \\sqrt{u^T W u}$。\n\n两个非零向量 $x$ 和 $y$ 之间的角度 $\\theta_W$ 由以下关系定义：\n$$\n\\cos(\\theta_W) = \\frac{\\langle x, y \\rangle_W}{\\|x\\|_W \\|y\\|_W}\n$$\n这意味着 $\\theta_W = \\arccos\\left(\\frac{\\langle x, y \\rangle_W}{\\|x\\|_W \\|y\\|_W}\\right)$。\n\n我们首先计算由 $W$ 诱导的角度所需的量。\n1. 内积 $\\langle x, y \\rangle_W$：\n$$\n\\langle x, y \\rangle_W = x^T W y = \\begin{pmatrix} 1  2  -1 \\end{pmatrix} \\begin{pmatrix} 3  1  0 \\\\ 1  2  1 \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n首先，我们计算乘积 $W y$：\n$$\nW y = \\begin{pmatrix} 3(2) + 1(-1) + 0(1) \\\\ 1(2) + 2(-1) + 1(1) \\\\ 0(2) + 1(-1) + 4(1) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 1 \\\\ 3 \\end{pmatrix}\n$$\n然后，我们计算 $x^T (W y)$：\n$$\n\\langle x, y \\rangle_W = \\begin{pmatrix} 1  2  -1 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ 1 \\\\ 3 \\end{pmatrix} = 1(5) + 2(1) + (-1)(3) = 5 + 2 - 3 = 4\n$$\n\n2. $x$ 的诱导范数 $\\|x\\|_W$：\n$$\n\\|x\\|_W^2 = \\langle x, x \\rangle_W = x^T W x = \\begin{pmatrix} 1  2  -1 \\end{pmatrix} \\begin{pmatrix} 3  1  0 \\\\ 1  2  1 \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ -1 \\end{pmatrix}\n$$\n首先，计算 $W x$：\n$$\nW x = \\begin{pmatrix} 3(1) + 1(2) + 0(-1) \\\\ 1(1) + 2(2) + 1(-1) \\\\ 0(1) + 1(2) + 4(-1) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 4 \\\\ -2 \\end{pmatrix}\n$$\n然后，计算 $x^T (W x)$：\n$$\n\\|x\\|_W^2 = \\begin{pmatrix} 1  2  -1 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ 4 \\\\ -2 \\end{pmatrix} = 1(5) + 2(4) + (-1)(-2) = 5 + 8 + 2 = 15\n$$\n所以，$\\|x\\|_W = \\sqrt{15}$。\n\n3. $y$ 的诱导范数 $\\|y\\|_W$：\n$$\n\\|y\\|_W^2 = \\langle y, y \\rangle_W = y^T W y = \\begin{pmatrix} 2  -1  1 \\end{pmatrix} \\begin{pmatrix} 3  1  0 \\\\ 1  2  1 \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n我们已经有 $W y = \\begin{pmatrix} 5 \\\\ 1 \\\\ 3 \\end{pmatrix}$。\n$$\n\\|y\\|_W^2 = \\begin{pmatrix} 2  -1  1 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ 1 \\\\ 3 \\end{pmatrix} = 2(5) + (-1)(1) + 1(3) = 10 - 1 + 3 = 12\n$$\n所以，$\\|y\\|_W = \\sqrt{12} = 2\\sqrt{3}$。\n\n现在，我们计算角度 $\\theta_W$ 的余弦值：\n$$\n\\cos(\\theta_W) = \\frac{4}{\\sqrt{15} \\sqrt{12}} = \\frac{4}{\\sqrt{180}} = \\frac{4}{\\sqrt{36 \\cdot 5}} = \\frac{4}{6\\sqrt{5}} = \\frac{2}{3\\sqrt{5}} = \\frac{2\\sqrt{5}}{15}\n$$\n因此，角度 $\\theta_W$ 是：\n$$\n\\theta_W = \\arccos\\left(\\frac{2\\sqrt{5}}{15}\\right)\n$$\n由于 $\\frac{2\\sqrt{5}}{15} > 0$，角度 $\\theta_W$ 是一个锐角。\n\n接下来，我们计算标准欧几里得角 $\\theta_E$。欧几里得内积是 $\\langle x, y \\rangle_E = x^T y$（这对应于 $W=I$，单位矩阵）。\n$$\n\\langle x, y \\rangle_E = \\begin{pmatrix} 1  2  -1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix} = 1(2) + 2(-1) + (-1)(1) = 2 - 2 - 1 = -1\n$$\n欧几里得范数是：\n$$\n\\|x\\|_E^2 = x^T x = 1^2 + 2^2 + (-1)^2 = 1 + 4 + 1 = 6 \\implies \\|x\\|_E = \\sqrt{6}\n$$\n$$\n\\|y\\|_E^2 = y^T y = 2^2 + (-1)^2 + 1^2 = 4 + 1 + 1 = 6 \\implies \\|y\\|_E = \\sqrt{6}\n$$\n欧几里得角 $\\theta_E$ 的余弦值是：\n$$\n\\cos(\\theta_E) = \\frac{\\langle x, y \\rangle_E}{\\|x\\|_E \\|y\\|_E} = \\frac{-1}{\\sqrt{6} \\sqrt{6}} = -\\frac{1}{6}\n$$\n欧几里得角是 $\\theta_E = \\arccos\\left(-\\frac{1}{6}\\right)$。由于 $\\cos(\\theta_E)  0$，角度 $\\theta_E$ 是一个钝角。\n\n最后，我们解释度量 $W$ 如何改变角度。关键在于使用 $W$ 的 Cholesky 分解。由于 $W$ 是 SPD 矩阵，它有唯一的分解 $W = LL^T$，其中 $L$ 是一个具有正对角元的下三角矩阵。设 $L = \\begin{pmatrix} l_{11}  0  0 \\\\ l_{21}  l_{22}  0 \\\\ l_{31}  l_{32}  l_{33} \\end{pmatrix}$。\n$$\nLL^T = \\begin{pmatrix} l_{11}^2  l_{11}l_{21}  l_{11}l_{31} \\\\ l_{21}l_{11}  l_{21}^2+l_{22}^2  l_{21}l_{31}+l_{22}l_{32} \\\\ l_{31}l_{11}  l_{31}l_{21}+l_{32}l_{22}  l_{31}^2+l_{32}^2+l_{33}^2 \\end{pmatrix} = \\begin{pmatrix} 3  1  0 \\\\ 1  2  1 \\\\ 0  1  4 \\end{pmatrix}\n$$\n求解 $L$ 的元素：\n$l_{11} = \\sqrt{3}$\n$l_{21} = 1/l_{11} = 1/\\sqrt{3}$\n$l_{31} = 0/l_{11} = 0$\n$l_{22} = \\sqrt{2 - l_{21}^2} = \\sqrt{2 - 1/3} = \\sqrt{5/3}$\n$l_{32} = (1 - l_{21}l_{31})/l_{22} = 1/\\sqrt{5/3} = \\sqrt{3/5}$\n$l_{33} = \\sqrt{4 - l_{31}^2 - l_{32}^2} = \\sqrt{4 - 0 - 3/5} = \\sqrt{17/5}$\n因此，Cholesky 因子是：\n$$\nL = \\begin{pmatrix} \\sqrt{3}  0  0 \\\\ 1/\\sqrt{3}  \\sqrt{5/3}  0 \\\\ 0  \\sqrt{3/5}  \\sqrt{17/5} \\end{pmatrix}\n$$\n由 $W$ 诱导的内积可以用 $L$ 重写：\n$$\n\\langle x, y \\rangle_W = x^T W y = x^T (LL^T) y = (L^T x)^T (L^T y)\n$$\n我们定义一个坐标变换 $z' = L^T z$。那么 $\\langle x, y \\rangle_W = (x')^T y' = \\langle x', y' \\rangle_E$。这个等式是解释的核心。它表明 $x$ 和 $y$ 的 $W$-内积等价于变换后向量 $x' = L^T x$ 和 $y' = L^T y$ 的标准欧几里得内积。因此，$x$ 和 $y$ 之间的角度 $\\theta_W$ 正是 $x'$ 和 $y'$ 之间的欧几里得角。\n\n变换矩阵是 $L^T = \\begin{pmatrix} \\sqrt{3}  1/\\sqrt{3}  0 \\\\ 0  \\sqrt{5/3}  \\sqrt{3/5} \\\\ 0  0  \\sqrt{17/5} \\end{pmatrix}$。这个变换对向量 $z = (z_1, z_2, z_3)^T$ 的原始坐标进行重新加权和混合，以产生一个新的向量 $z'=(z'_1, z'_2, z'_3)^T$：\n$z'_1 = \\sqrt{3} z_1 + (1/\\sqrt{3}) z_2$\n$z'_2 = \\sqrt{5/3} z_2 + \\sqrt{3/5} z_3$\n$z'_3 = \\sqrt{17/5} z_3$\n\n与欧几里得度量（其中 $W=I$）不同，欧几里得度量以相等的权重独立地处理每个坐标轴，而 $W$ 度量则施加权重并在坐标之间产生“串扰”。$W$ 的对角元（$3, 2, 4$）相比欧几里得范数，给予坐标的平方（$x_1^2, x_2^2, x_3^2$）更大的权重，而非对角元（$W_{12}=W_{21}=1, W_{23}=W_{32}=1$）则引入了耦合项（$x_1x_2, x_2x_3$）。Cholesky 分解提供了一种系统的方法，将此视为坐标变换。\n\n将此变换 $L^T$ 应用于我们的向量 $x$ 和 $y$：\n$$\nx' = L^T x = \\begin{pmatrix} \\sqrt{3}  1/\\sqrt{3}  0 \\\\ 0  \\sqrt{5/3}  \\sqrt{3/5} \\\\ 0  0  \\sqrt{17/5} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{3} + 2/\\sqrt{3} \\\\ 2\\sqrt{5/3} - \\sqrt{3/5} \\\\ -\\sqrt{17/5} \\end{pmatrix} = \\begin{pmatrix} 5/\\sqrt{3} \\\\ 7/\\sqrt{15} \\\\ -\\sqrt{17/5} \\end{pmatrix}\n$$\n$$\ny' = L^T y = \\begin{pmatrix} \\sqrt{3}  1/\\sqrt{3}  0 \\\\ 0  \\sqrt{5/3}  \\sqrt{3/5} \\\\ 0  0  \\sqrt{17/5} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2\\sqrt{3} - 1/\\sqrt{3} \\\\ -\\sqrt{5/3} + \\sqrt{3/5} \\\\ \\sqrt{17/5} \\end{pmatrix} = \\begin{pmatrix} 5/\\sqrt{3} \\\\ -2/\\sqrt{15} \\\\ \\sqrt{17/5} \\end{pmatrix}\n$$\n这些变换后向量的欧几里得点积是：\n$$\n\\langle x', y' \\rangle_E = \\left(\\frac{5}{\\sqrt{3}}\\right)\\left(\\frac{5}{\\sqrt{3}}\\right) + \\left(\\frac{7}{\\sqrt{15}}\\right)\\left(\\frac{-2}{\\sqrt{15}}\\right) + \\left(\\frac{-\\sqrt{17}}{\\sqrt{5}}\\right)\\left(\\frac{\\sqrt{17}}{\\sqrt{5}}\\right) = \\frac{25}{3} - \\frac{14}{15} - \\frac{17}{5} = \\frac{125 - 14 - 51}{15} = \\frac{60}{15} = 4\n$$\n这与我们之前计算的 $\\langle x, y \\rangle_W$ 相匹配。变换 $L^T$ 扭曲了空间。最显著的影响是在第一个坐标上：$x'_1$ 和 $y'_1$ 都等于 $5/\\sqrt{3}$。变换后向量的主要第一分量上的这种强对齐为其点积创造了一个大的正贡献（$25/3 \\approx 8.33$），这个贡献克服了来自其他分量的负贡献。这就是为什么角度从钝角（$\\cos(\\theta_E)  0$）变为锐角（$\\cos(\\theta_W) > 0$）。由 $W$ 定义的几何结构将向量 $x$ 和 $y$ “拉”得比它们在标准欧几里得几何中更近。",
            "answer": "$$\n\\boxed{\\arccos\\left(\\frac{2\\sqrt{5}}{15}\\right)}\n$$"
        },
        {
            "introduction": "在理解了加权内积如何重塑几何概念之后，我们可以进一步探索这对一个基本线性代数运算——正交投影——意味着什么。此练习将引导你分别在标准欧几里得空间和加权内积空间中计算向量在同一子空间上的投影 。通过对比这两种情况下的结果，你将掌握加权最小二乘法等重要方法的精髓，这些方法在处理具有不同不确定性的数据时至关重要。",
            "id": "3551176",
            "problem": "考虑$\\mathbb{R}^{3}$上的加权内积，其定义为 $\\langle x, y \\rangle_{W} = x^{\\mathsf{T}} W y$，其中 $W$ 是一个对称正定 (SPD) 矩阵。设 $W = \\mathrm{diag}(2,3,5)$，设 $A \\in \\mathbb{R}^{3 \\times 2}$ 的列为 $a_{1} = (1,0,1)^{\\mathsf{T}}$ 和 $a_{2} = (0,1,1)^{\\mathsf{T}}$，并设 $b = (2,3,4)^{\\mathsf{T}}$。仅使用内积、范数和正交性的基本定义，构建 $b$ 的 $W$-正交分解 $b = p_{W} + q_{W}$（其中 $p_{W} \\in \\mathrm{range}(A)$ 且 $q_{W} \\in \\mathrm{range}(A)^{\\perp_{W}}$）以及在标准内积下的欧几里得分解 $b = p_{2} + q_{2}$（其中 $p_{2} \\in \\mathrm{range}(A)$ 且 $q_{2} \\in \\mathrm{range}(A)^{\\perp_{2}}$）。计算投影分量的范数平方之比 $R$，\n$$\nR \\;=\\; \\frac{\\|p_{W}\\|_{W}^{2}}{\\|p_{2}\\|_{2}^{2}} \\;=\\; \\frac{p_{W}^{\\mathsf{T}} W p_{W}}{p_{2}^{\\mathsf{T}} p_{2}},\n$$\n并将最终答案表示为精确值。无需四舍五入。",
            "solution": "该问题要求计算向量 $b$ 在矩阵 $A$ 的列所张成的子空间上的两种不同正交投影的范数平方之比。第一个投影是关于标准欧几里得内积的，第二个是关于由矩阵 $W$ 定义的加权内积的。\n\n给定的数据如下：\n向量空间为 $\\mathbb{R}^{3}$。\n加权内积为 $\\langle x, y \\rangle_{W} = x^{\\mathsf{T}} W y$。\n权重矩阵为 $W = \\mathrm{diag}(2,3,5) = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  5 \\end{pmatrix}$。该矩阵是对称的，并且对角线元素为正，因此它是正定的。\n矩阵 $A \\in \\mathbb{R}^{3 \\times 2}$ 由其列 $a_{1} = (1,0,1)^{\\mathsf{T}}$ 和 $a_{2} = (0,1,1)^{\\mathsf{T}}$ 给出。因此，$A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix}$。\n待投影的向量为 $b = (2,3,4)^{\\mathsf{T}}$。\n\n我们所关注的子空间是 $A$ 的列空间，记作 $\\mathrm{range}(A)$，它是由其列向量 $\\{a_{1}, a_{2}\\}$ 张成的空间。\n\n首先，我们求 $b$ 到 $\\mathrm{range}(A)$ 上的欧几里得投影 $p_{2}$。\n向量 $p_{2}$ 是 $\\mathrm{range}(A)$ 中的唯一向量，使得残差向量 $q_{2} = b - p_{2}$ 相对于标准欧几里得内积 $\\langle u, v \\rangle_{2} = u^{\\mathsf{T}}v$ 与 $\\mathrm{range}(A)$ 正交。\n由于 $p_{2} \\in \\mathrm{range}(A)$，它可以写成 $A$ 的列的线性组合，即 $p_{2} = Ax$，其中 $x = (x_{1}, x_{2})^{\\mathsf{T}} \\in \\mathbb{R}^{2}$ 是某个向量。\n正交性条件为，对于所有 $v \\in \\mathrm{range}(A)$，$\\langle b - Ax, v \\rangle_{2} = 0$。我们只需对基向量 $a_{1}$ 和 $a_{2}$ 强制施加此条件：\n$$\n\\langle b - Ax, a_{1} \\rangle_{2} = a_{1}^{\\mathsf{T}}(b - Ax) = 0\n$$\n$$\n\\langle b - Ax, a_{2} \\rangle_{2} = a_{2}^{\\mathsf{T}}(b - Ax) = 0\n$$\n这两个方程可以写成矩阵形式 $A^{\\mathsf{T}}(b - Ax) = 0$，这导出了正规方程：\n$$\nA^{\\mathsf{T}}Ax = A^{\\mathsf{T}}b\n$$\n我们计算所涉及的矩阵：\n$$\nA^{\\mathsf{T}}A = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\nA^{\\mathsf{T}}b = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}\n$$\n我们求解方程组 $\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$。\n$A^{\\mathsf{T}}A$ 的逆是 $(A^{\\mathsf{T}}A)^{-1} = \\frac{1}{(2)(2) - (1)(1)} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$。\n所以，$x = \\frac{1}{3} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} (2)(6) - (1)(7) \\\\ (-1)(6) + (2)(7) \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 5 \\\\ 8 \\end{pmatrix}$。\n投影为 $p_{2} = Ax = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 5 \\\\ 8 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 5 \\\\ 8 \\\\ 13 \\end{pmatrix}$。\n$p_{2}$ 的欧几里得范数平方为 $\\|p_{2}\\|_{2}^{2} = p_{2}^{\\mathsf{T}}p_{2}$。一个更直接的计算方法是利用正交性：$\\langle p_{2}, b - p_{2} \\rangle_{2} = 0$，这意味着 $\\|p_{2}\\|_{2}^{2} = \\langle p_{2}, p_{2} \\rangle_{2} = \\langle p_{2}, b \\rangle_{2} = p_{2}^{\\mathsf{T}}b$。\n$$\n\\|p_{2}\\|_{2}^{2} = \\left(\\frac{1}{3} \\begin{pmatrix} 5 \\\\ 8 \\\\ 13 \\end{pmatrix}\\right)^{\\mathsf{T}} \\begin{pmatrix} 2 \\\\ 3 \\\\ 4 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 5  8  13 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\\\ 4 \\end{pmatrix} = \\frac{1}{3}((5)(2) + (8)(3) + (13)(4)) = \\frac{1}{3}(10 + 24 + 52) = \\frac{86}{3}.\n$$\n\n其次，我们求 $b$ 到 $\\mathrm{range}(A)$ 上的 $W$-正交投影 $p_{W}$。\n向量 $p_{W}$ 在 $\\mathrm{range}(A)$ 中，因此 $p_{W} = Ay$，其中 $y = (y_{1}, y_{2})^{\\mathsf{T}} \\in \\mathbb{R}^{2}$ 是某个向量。残差 $q_{W} = b - p_{W}$ 必须关于 $W$-内积与 $\\mathrm{range}(A)$ 正交。\n这意味着对于所有 $v \\in \\mathrm{range}(A)$，$\\langle b - Ay, v \\rangle_{W} = 0$。我们对基向量 $a_{1}$ 和 $a_{2}$ 进行检验：\n$$\n\\langle b - Ay, a_{i} \\rangle_{W} = a_{i}^{\\mathsf{T}}W(b - Ay) = 0 \\quad \\text{for } i=1,2.\n$$\n这导出了加权正规方程 $A^{\\mathsf{T}}W(b - Ay) = 0$，或：\n$$\nA^{\\mathsf{T}}WAy = A^{\\mathsf{T}}Wb\n$$\n我们计算该方程组的矩阵：\n$$\nA^{\\mathsf{T}}W = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  5 \\end{pmatrix} = \\begin{pmatrix} 2  0  5 \\\\ 0  3  5 \\end{pmatrix}\n$$\n$$\nA^{\\mathsf{T}}WA = (A^{\\mathsf{T}}W)A = \\begin{pmatrix} 2  0  5 \\\\ 0  3  5 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  8 \\end{pmatrix}\n$$\n$$\nA^{\\mathsf{T}}Wb = (A^{\\mathsf{T}}W)b = \\begin{pmatrix} 2  0  5 \\\\ 0  3  5 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} (2)(2) + (0)(3) + (5)(4) \\\\ (0)(2) + (3)(3) + (5)(4) \\end{pmatrix} = \\begin{pmatrix} 24 \\\\ 29 \\end{pmatrix}\n$$\n我们求解方程组 $\\begin{pmatrix} 7  5 \\\\ 5  8 \\end{pmatrix} \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} = \\begin{pmatrix} 24 \\\\ 29 \\end{pmatrix}$。\n$A^{\\mathsf{T}}WA$ 的逆是 $(A^{\\mathsf{T}}WA)^{-1} = \\frac{1}{(7)(8) - (5)(5)} \\begin{pmatrix} 8  -5 \\\\ -5  7 \\end{pmatrix} = \\frac{1}{31} \\begin{pmatrix} 8  -5 \\\\ -5  7 \\end{pmatrix}$。\n所以，$y = \\frac{1}{31} \\begin{pmatrix} 8  -5 \\\\ -5  7 \\end{pmatrix} \\begin{pmatrix} 24 \\\\ 29 \\end{pmatrix} = \\frac{1}{31} \\begin{pmatrix} (8)(24) - (5)(29) \\\\ (-5)(24) + (7)(29) \\end{pmatrix} = \\frac{1}{31} \\begin{pmatrix} 192 - 145 \\\\ -120 + 203 \\end{pmatrix} = \\frac{1}{31} \\begin{pmatrix} 47 \\\\ 83 \\end{pmatrix}$。\n$p_{W}$ 的 $W$-范数平方是 $\\|p_{W}\\|_{W}^{2} = p_{W}^{\\mathsf{T}}Wp_{W}$。使用 $W$-正交性条件 $\\langle p_{W}, b - p_{W}\\rangle_{W} = 0$，我们有 $\\|p_{W}\\|_{W}^{2} = \\langle p_{W}, b \\rangle_{W} = p_{W}^{\\mathsf{T}}Wb$。\n由于 $p_{W} = Ay$，这变为 $\\|p_{W}\\|_{W}^{2} = (Ay)^{\\mathsf{T}}Wb = y^{\\mathsf{T}}(A^{\\mathsf{T}}Wb)$。\n$$\n\\|p_{W}\\|_{W}^{2} = \\left(\\frac{1}{31} \\begin{pmatrix} 47 \\\\ 83 \\end{pmatrix}\\right)^{\\mathsf{T}} \\begin{pmatrix} 24 \\\\ 29 \\end{pmatrix} = \\frac{1}{31} \\begin{pmatrix} 47  83 \\end{pmatrix} \\begin{pmatrix} 24 \\\\ 29 \\end{pmatrix} = \\frac{1}{31}((47)(24) + (83)(29)).\n$$\n我们计算乘积：$47 \\times 24 = 1128$ 和 $83 \\times 29 = 2407$。\n$$\n\\|p_{W}\\|_{W}^{2} = \\frac{1}{31}(1128 + 2407) = \\frac{3535}{31}.\n$$\n\n最后，我们计算比值 $R$：\n$$\nR = \\frac{\\|p_{W}\\|_{W}^{2}}{\\|p_{2}\\|_{2}^{2}} = \\frac{3535/31}{86/3} = \\frac{3535 \\times 3}{31 \\times 86} = \\frac{10605}{2666}.\n$$\n分子和分母中的数可以进行因式分解。\n$10605 = 3 \\times 3535 = 3 \\times 5 \\times 707 = 3 \\times 5 \\times 7 \\times 101$。\n$2666 = 2 \\times 1333 = 2 \\times 31 \\times 43$。\n分子和分母之间没有公因子，所以该分数已是最简形式。",
            "answer": "$$\\boxed{\\frac{10605}{2666}}$$"
        },
        {
            "introduction": "现在，让我们将注意力转回标准欧几里得空间，探讨投影的另一个关键方面：数值稳定性。正交投影是稳健的，但当投影方向与目标子空间不成直角时，我们得到的是斜投影。这个练习将通过推导和编码，揭示当投影的几何构型变得“倾斜”时，相应的投影算子范数会如何变得巨大，并导致计算中微小的舍入误差被灾难性地放大 。",
            "id": "3551195",
            "problem": "设 $\\mathbb{R}^n$ 空间具有标准的欧几里得内积，对于向量 $x,y \\in \\mathbb{R}^n$ 定义为 $\\langle x,y\\rangle = x^\\top y$，以及其诱导的 $2$-范数 $\\|x\\|_2 = \\sqrt{\\langle x,x\\rangle}$。如果一个线性算子 $P \\in \\mathbb{R}^{n \\times n}$ 满足 $P^2 = P$，则称其为投影算子。如果一个投影算子的值域与其零空间正交，则称其为正交投影算子。任何非正交的投影算子都称为斜投影算子，其典型特征是其值域和零空间不正交。矩阵 $P$ 的谱范数，记为 $\\|P\\|_2$，是由向量 $2$-范数诱导的算子范数，定义为 $\\|P\\|_2 = \\max_{\\|x\\|_2=1} \\|Px\\|_2$，其值等于 $P$ 的最大奇异值。\n\n从上述基本定义出发，推导如何构造一个投影算子 $P$，使其沿着一个互补子空间投影到一个给定的子空间上，过程中不假设任何关于 $P$ 的预先给定的公式。然后，在 $n=2$ 的特殊情况下，目标子空间由向量 $a = [1,0]^{\\mathsf{T}}$ 张成，互补方向由 $b = [\\cos \\alpha, \\sin \\alpha]^{\\mathsf{T}}$（角度必须以弧度为单位）诱导的线性泛函定义，构造一个沿着 $\\operatorname{null}(b^{\\mathsf{T}})$ 投影到 $\\operatorname{span}\\{a\\}$ 上的斜投影算子。解释为什么当角度 $\\alpha$ 接近 $\\pi/2$ 时，谱范数 $\\|P\\|_2$ 会变得很大，以及为什么这会导致在基于投影的计算中舍入误差的放大。\n\n你的程序必须为每个测试用例实现以下步骤：\n- 构造 $P \\in \\mathbb{R}^{2 \\times 2}$，使其对于指定的角度 $\\alpha$，沿着 $\\operatorname{null}(b^{\\mathsf{T}})$ 投影到 $\\operatorname{span}\\{a\\}$ 上。\n- 使用 $P$ 的奇异值分解计算谱范数 $\\|P\\|_2$。\n- 通过向输入向量 $x$ 添加一个扰动 $\\delta = \\varepsilon v$ 来模拟舍入误差，其中 $x = [0,0]^{\\mathsf{T}}$，$\\varepsilon = 10^{-12}$，$v$ 是对应于 $P$ 的最大奇异值的右奇异向量（这个选择代表了 $2$-范数下放大的最坏情况方向）。\n- 计算放大率 $r = \\frac{\\|P(x+\\delta)-P x\\|_2}{\\|\\delta\\|_2}$，它等于 $\\frac{\\|P\\delta\\|_2}{\\|\\delta\\|_2}$；将此比率以浮点数形式报告。\n\n使用以下角度值的测试套件（所有角度均以弧度为单位）：\n- $\\alpha_1 = 0.0$ (基准类正交情况)，\n- $\\alpha_2 = 1.2$ (中等斜交性)，\n- $\\alpha_3 = 1.5706$ (近简并斜交性，具有非常大的 $\\|P\\|_2$)。\n\n对于每个测试用例，输出两个浮点数：首先是谱范数 $\\|P\\|_2$，然后是放大率 $r$。你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\|P\\|_2(\\alpha_1), r(\\alpha_1), \\|P\\|_2(\\alpha_2), r(\\alpha_2), \\|P\\|_2(\\alpha_3), r(\\alpha_3)]$。",
            "solution": "该问题是有效的，因为它在科学上基于线性代数和数值分析，是适定且客观的。所有必要的定义和数据都已提供，以获得唯一解。\n\n我们首先进行理论推导。\n\n一个沿着互补子空间 $\\mathcal{N}$ 投影到子空间 $\\mathcal{R}$ 上的投影算子 $P$ 由以下性质定义：对于任何向量 $x \\in \\mathbb{R}^n$，其像 $Px$ 位于 $\\mathcal{R}$ 中，而残差 $x - Px$ 位于 $\\mathcal{N}$ 中。空间 $\\mathbb{R}^n$ 是这些子空间的直和，即 $\\mathbb{R}^n = \\mathcal{R} \\oplus \\mathcal{N}$。这些条件唯一地定义了投影。投影算子的值域是 $\\operatorname{range}(P) = \\mathcal{R}$，其零空间是 $\\operatorname{null}(P) = \\mathcal{N}$。投影算子是幂等的，即 $P^2 = P$。\n\n设目标子空间 $\\mathcal{R}$ 是一个具有线性无关列的矩阵 $A \\in \\mathbb{R}^{n \\times k}$ 的列空间（值域）。设互补子空间 $\\mathcal{N}$ 是一个矩阵 $B^{\\mathsf{T}} \\in \\mathbb{R}^{k \\times n}$ 的零空间，即 $\\mathcal{N} = \\operatorname{null}(B^{\\mathsf{T}})$，其中 $B \\in \\mathbb{R}^{n \\times k}$ 也具有线性无关的列。条件 $\\mathbb{R}^n = \\mathcal{R} \\oplus \\mathcal{N}$ 意味着矩阵 $B^{\\mathsf{T}} A \\in \\mathbb{R}^{k \\times k}$ 是可逆的。\n\n为了构造矩阵 $P$，我们将其定义性质形式化地应用于任意向量 $x \\in \\mathbb{R}^n$：\n1.  投影 $Px$ 必须位于 $\\mathcal{R} = \\operatorname{range}(A)$ 中。这意味着存在一个系数向量 $c \\in \\mathbb{R}^k$ 使得 $Px = Ac$。\n2.  残差 $x - Px$ 必须位于 $\\mathcal{N} = \\operatorname{null}(B^{\\mathsf{T}})$ 中。这意味着 $B^{\\mathsf{T}} (x - Px) = 0$。\n\n将第一个性质中的表达式代入第二个性质，得到：\n$$\nB^{\\mathsf{T}} (x - Ac) = 0\n$$\n$$\nB^{\\mathsf{T}} x - B^{\\mathsf{T}} Ac = 0\n$$\n$$\nB^{\\mathsf{T}} Ac = B^{\\mathsf{T}} x\n$$\n由于矩阵 $B^{\\mathsf{T}} A$ 是可逆的，我们可以解出系数向量 $c$：\n$$\nc = (B^{\\mathsf{T}} A)^{-1} B^{\\mathsf{T}} x\n$$\n将 $c$ 的这个表达式代回方程 $Px = Ac$，我们得到：\n$$\nPx = A\\left((B^{\\mathsf{T}} A)^{-1} B^{\\mathsf{T}} x\\right)\n$$\n由于此方程对任意向量 $x$ 都必须成立，投影算子 $P$ 的矩阵表示为：\n$$\nP = A(B^{\\mathsf{T}} A)^{-1} B^{\\mathsf{T}}\n$$\n这就是沿着 $\\operatorname{null}(B^{\\mathsf{T}})$ 投影到 $\\operatorname{range}(A)$ 上的斜投影算子的通用公式。\n\n现在，我们将此公式应用于问题中给出的 $n=2$ 的具体情况。\n目标子空间是 $\\mathcal{R} = \\operatorname{span}\\{a\\}$，其中 $a = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。这对应于设置 $A=a$。\n互补子空间是 $\\mathcal{N} = \\operatorname{null}(b^{\\mathsf{T}})$，其中 $b = \\begin{pmatrix} \\cos \\alpha \\\\ \\sin \\alpha \\end{pmatrix}$。这对应于设置 $B=b$。\n\n在这种情况下，$A$ 和 $B$ 是列向量，因此乘积 $b^{\\mathsf{T}} a$ 是一个 $1 \\times 1$ 矩阵（一个标量）：\n$$\nb^{\\mathsf{T}} a = \\begin{pmatrix} \\cos \\alpha  \\sin \\alpha \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\cos \\alpha\n$$\n其逆为 $(b^{\\mathsf{T}} a)^{-1} = \\frac{1}{\\cos \\alpha}$。这个逆存在的当且仅当 $\\cos \\alpha \\neq 0$，即对于任意整数 $k$，$\\alpha \\neq \\frac{\\pi}{2} + k\\pi$。这是 $\\mathcal{R}$ 和 $\\mathcal{N}$ 成为互补子空间的条件。\n\n代入 $P$ 的通用公式：\n$$\nP = a(b^{\\mathsf{T}} a)^{-1} b^{\\mathsf{T}} = a \\left(\\frac{1}{\\cos \\alpha}\\right) b^{\\mathsf{T}} = \\frac{1}{\\cos \\alpha} a b^{\\mathsf{T}}\n$$\n我们计算外积 $ab^{\\mathsf{T}}$：\n$$\nab^{\\mathsf{T}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} \\cos \\alpha  \\sin \\alpha \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot \\cos \\alpha  1 \\cdot \\sin \\alpha \\\\ 0 \\cdot \\cos \\alpha  0 \\cdot \\sin \\alpha \\end{pmatrix} = \\begin{pmatrix} \\cos \\alpha  \\sin \\alpha \\\\ 0  0 \\end{pmatrix}\n$$\n最后，我们得到投影算子 $P$ 的矩阵：\n$$\nP = \\frac{1}{\\cos \\alpha} \\begin{pmatrix} \\cos \\alpha  \\sin \\alpha \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{\\sin \\alpha}{\\cos \\alpha} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\tan \\alpha \\\\ 0  0 \\end{pmatrix}\n$$\n谱范数 $\\|P\\|_2$ 定义为 $P$ 的最大奇异值，也就是矩阵 $P^{\\mathsf{T}} P$ 的最大特征值的平方根。\n$$\nP^{\\mathsf{T}} P = \\begin{pmatrix} 1  0 \\\\ \\tan \\alpha  0 \\end{pmatrix} \\begin{pmatrix} 1  \\tan \\alpha \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\tan \\alpha \\\\ \\tan \\alpha  \\tan^2 \\alpha \\end{pmatrix}\n$$\n$P^{\\mathsf{T}} P$ 的特征值 $\\lambda$ 是特征方程 $\\det(P^{\\mathsf{T}} P - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} 1-\\lambda  \\tan \\alpha \\\\ \\tan \\alpha  \\tan^2 \\alpha - \\lambda \\end{pmatrix} = (1-\\lambda)(\\tan^2 \\alpha - \\lambda) - \\tan^2 \\alpha = 0\n$$\n$$\n\\lambda^2 - \\lambda(1 + \\tan^2 \\alpha) = 0 \\implies \\lambda(\\lambda - (1 + \\tan^2 \\alpha)) = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = 1 + \\tan^2 \\alpha = \\sec^2 \\alpha$。\n$P$ 的奇异值是这些特征值的平方根：$\\sigma_1 = \\sqrt{\\sec^2 \\alpha} = |\\sec \\alpha|$ 和 $\\sigma_2 = 0$。最大奇异值为 $\\sigma_{\\max} = |\\sec \\alpha|$。\n因此，投影算子的谱范数为：\n$$\n\\|P\\|_2 = |\\sec \\alpha| = \\frac{1}{|\\cos \\alpha|}\n$$\n当角度 $\\alpha$ 趋近于 $\\frac{\\pi}{2}$ 时，$\\cos \\alpha$ 趋近于 $0$，导致 $\\|P\\|_2$ 趋近于无穷大。从几何上看，当 $\\alpha \\to \\frac{\\pi}{2}$ 时，向量 $b$ 变得与 $a$ 正交。空间 $\\mathcal{N} = \\operatorname{null}(b^{\\mathsf{T}}) = (\\operatorname{span}\\{b\\})^\\perp$ 变得几乎与空间 $\\mathcal{R} = \\operatorname{span}\\{a\\}$ 相同，因为如果 $b \\perp a$，那么 $a \\in (\\operatorname{span}\\{b\\})^\\perp$。这两个子空间不再互补，投影变得病态，这反映在其无界的范数上。\n\n舍入误差的放大是算子范数定义的直接结果。设 $x$ 是一个输入向量，$\\delta$ 是一个小的扰动（例如，舍入误差）。扰动后输入的投影输出是 $P(x+\\delta)$。根据线性性，输出中的误差是 $P(x+\\delta) - Px = P\\delta$。此输出误差的大小是 $\\|P\\delta\\|_2$。\n谱范数的定义是 $\\|P\\|_2 = \\max_{\\delta \\neq 0} \\frac{\\|P\\delta\\|_2}{\\|\\delta\\|_2}$。这导出了不等式 $\\|P\\delta\\|_2 \\le \\|P\\|_2 \\|\\delta\\|_2$。谱范数 $\\|P\\|_2$ 是输入误差范数的最坏情况下的放大因子。\n当 $\\|P\\|_2$ 很大时（即当 $\\alpha \\approx \\pi/2$ 时），一个小的输入误差 $\\|\\delta\\|_2$ 可能会被放大成一个大的输出误差 $\\|P\\delta\\|_2$。当误差向量 $\\delta$ 与对应于最大奇异值 $\\sigma_{\\max} = \\|P\\|_2$ 的右奇异向量 $v$ 对齐时，会发生这种最大放大。对于这样的 $\\delta = \\varepsilon v$，放大率恰好是：\n$$\nr = \\frac{\\|P\\delta\\|_2}{\\|\\delta\\|_2} = \\frac{\\|P(\\varepsilon v)\\|_2}{\\|\\varepsilon v\\|_2} = \\frac{\\varepsilon \\|Pv\\|_2}{\\varepsilon \\|v\\|_2} = \\frac{\\sigma_{\\max}\\|v\\|_2}{\\|v\\|_2} = \\sigma_{\\max} = \\|P\\|_2\n$$\n问题要求计算与此最坏情况方向对齐的扰动 $\\delta$ 的这个比率。鉴于初始向量是 $x = [0,0]^{\\mathsf{T}}$，则 $Px=0$，所以该比率简化为 $\\frac{\\|P(x+\\delta)-P x\\|_2}{\\|\\delta\\|_2} = \\frac{\\|P\\delta\\|_2}{\\|\\delta\\|_2}$，如上所示，它将等于 $\\|P\\|_2$。数值实现将验证这种关系。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs oblique projectors for given angles, computes their spectral norms,\n    and calculates the amplification ratio for a worst-case perturbation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,      # baseline orthogonal-like case\n        1.2,      # moderate obliqueness\n        1.5706,   # near-degenerate obliqueness\n    ]\n\n    results = []\n    # Epsilon for perturbation, as specified.\n    epsilon = 1e-12\n    # Input vector x, as specified.\n    x = np.array([0.0, 0.0])\n\n    for alpha in test_cases:\n        # Construct the oblique projector P as derived in the solution.\n        # P = [[1, tan(alpha)], [0, 0]]\n        tan_alpha = np.tan(alpha)\n        P = np.array([[1.0, tan_alpha],\n                      [0.0, 0.0]])\n\n        # Compute the singular value decomposition of P.\n        # U: left singular vectors, s: singular values, Vh: right singular vectors (Hermitian).\n        # The spectral norm is the largest singular value.\n        try:\n            U, s, Vh = np.linalg.svd(P)\n        except np.linalg.LinAlgError:\n            # Handle potential numerical errors for extreme cases, though unlikely here.\n            results.extend([np.inf, np.inf])\n            continue\n            \n        spectral_norm = s[0]\n\n        # Emulate a rounding error by perturbing the input vector x.\n        # The worst-case direction for amplification is the right singular vector 'v'\n        # corresponding to the largest singular value. 'v' is the first row of Vh.\n        v = Vh[0, :]\n        \n        # Create the perturbation delta.\n        delta = epsilon * v\n        \n        # The problem asks for the amplification ratio r.\n        # r = ||P(x+delta) - Px||_2 / ||delta||_2\n        # Since x is the zero vector, Px is also the zero vector.\n        # So, r = ||P(delta)||_2 / ||delta||_2\n        \n        # Project the perturbation\n        P_delta = P @ delta\n        \n        # Calculate the norms of the projected perturbation and the original perturbation.\n        norm_P_delta = np.linalg.norm(P_delta)\n        norm_delta = np.linalg.norm(delta)\n        \n        # Compute the amplification ratio.\n        # This should theoretically be equal to the spectral norm.\n        if norm_delta  0:\n            amplification_ratio = norm_P_delta / norm_delta\n        else:\n            # This case should not be reached with epsilon  0 and v being a unit vector.\n            amplification_ratio = 0.0\n        \n        results.extend([spectral_norm, amplification_ratio])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}