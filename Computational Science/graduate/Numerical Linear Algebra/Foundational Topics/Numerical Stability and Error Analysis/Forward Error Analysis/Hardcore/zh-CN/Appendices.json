{
    "hands_on_practices": [
        {
            "introduction": "这个练习提供了一个前向误差分析的典型例子。我们将构建一个简单的线性系统，其中计算出的解在后向误差很小的意义上是“好”的，但在远离真实解的意义上却是“坏”的。我们将通过矩阵的巨大条件数 $\\kappa(A)$ 来解释这种差异，条件数在这里扮演了一个强大的误差放大器角色。",
            "id": "3546754",
            "problem": "设 $\\|\\cdot\\|$ 表示谱范数（对向量是欧几里得 2-范数，对矩阵是诱导算子 2-范数）。考虑 $2 \\times 2$ 对角矩阵\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix},\n\\quad \\text{其中 } \\varepsilon = 10^{-14},\n$$\n精确解\n$$\nx = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n以及对应的右端项\n$$\nb = A x = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}.\n$$\n假设报告的计算解为\n$$\n\\hat{x} = \\begin{pmatrix} 1 \\\\ 1 - \\alpha \\end{pmatrix},\n\\quad \\text{其中 } \\alpha = 10^{-2}.\n$$\n你需要验证范数意义下的后向误差不大于 $10^{-16}$，而范数意义下的前向误差约为 $10^{-2}$，然后使用矩阵 $A$ 的条件数来解释这种差异。\n\n任务：\n1. 使用范数意义下的后向误差定义（即存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足 $(A + \\Delta A)\\hat{x} = b + \\Delta b$，且 $\\|\\Delta A\\| \\le \\eta \\|A\\|$ 和 $\\|\\Delta b\\| \\le \\eta \\|b\\|$ 的最小 $\\eta$），给出具体的 $\\Delta A$ 和 $\\Delta b$，以表明 $\\hat{x}$ 的后向误差不超过 $10^{-16}$。\n2. 计算范数意义下的前向误差比 $\\|x - \\hat{x}\\| / \\|x\\|$。\n3. 从条件数 $\\kappa_{2}(A) = \\|A\\| \\,\\|A^{-1}\\|$、后向误差和前向误差的定义出发，推导一个不等式来解释为什么对于病态矩阵 $A$，前向误差会远大于后向误差，并对给定的数据评估此不等式以解释你的结果。\n\n作为你的最终答案，报告前向误差比 $\\|x - \\hat{x}\\| / \\|x\\|$ 的数值，四舍五入到四位有效数字。",
            "solution": "这个问题要求对一个线性系统的计算解进行三部分分析，重点关注后向误差、前向误差和条件数这些概念。\n\n给定的量如下：\n- 矩阵 $A = \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix}$，其中 $\\varepsilon = 10^{-14}$。\n- 精确解 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- 右端项 $b = Ax = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}$。\n- 计算解 $\\hat{x} = \\begin{pmatrix} 1 \\\\ 1 - \\alpha \\end{pmatrix}$，其中 $\\alpha = 10^{-2}$。\n- 范数 $\\|\\cdot\\|$ 是谱范数（对向量是 2-范数，对矩阵是诱导 2-范数）。\n\n### 任务1：后向误差验证\n\n范数意义下的后向误差 $\\eta$ 是指，存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足 $(A + \\Delta A)\\hat{x} = b + \\Delta b$ 且 $\\|\\Delta A\\| \\le \\eta \\|A\\|$ 和 $\\|\\Delta b\\| \\le \\eta \\|b\\|$ 的最小非负数。通过定义残差向量 $r = b - A\\hat{x}$，这个条件可以被重写。方程变为：\n$$\n\\Delta b - \\Delta A \\hat{x} = A\\hat{x} - b = -r\n$$\n首先，我们计算残差 $r$：\n$$\nA\\hat{x} = \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1-\\alpha \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\varepsilon(1-\\alpha) \\end{pmatrix}\n$$\n$$\nr = b - A\\hat{x} = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ \\varepsilon(1-\\alpha) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\varepsilon\\alpha \\end{pmatrix}\n$$\n为了证明后向误差不超过 $10^{-16}$，我们需要给出具体的扰动 $\\Delta A$ 和 $\\Delta b$，使得它们对于某个 $\\eta \\le 10^{-16}$ 满足误差方程和范数界。一个简单的选择是将整个残差归因于 $b$ 的扰动，即设 $\\Delta A = 0$。\n设 $\\Delta A$ 为 $2 \\times 2$ 的零矩阵，$\\Delta A = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$。误差方程简化为 $\\Delta b = -r$。\n$$\n\\Delta b = -r = \\begin{pmatrix} 0 \\\\ -\\varepsilon\\alpha \\end{pmatrix}\n$$\n现在我们必须为某个 $\\eta \\le 10^{-16}$ 验证范数条件。第一个条件 $\\|\\Delta A\\| \\le \\eta \\|A\\|$ 变为 $0 \\le \\eta \\|A\\|$，这对任何 $\\eta \\ge 0$ 都成立。\n对于第二个条件，我们需要找到满足 $\\|\\Delta b\\| \\le \\eta \\|b\\|$ 的最小 $\\eta$。这给出 $\\eta \\ge \\frac{\\|\\Delta b\\|}{\\|b\\|}$。我们来计算这些范数：\n$$\n\\|\\Delta b\\|_2 = \\left\\| \\begin{pmatrix} 0 \\\\ -\\varepsilon\\alpha \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + (-\\varepsilon\\alpha)^2} = \\varepsilon\\alpha = (10^{-14})(10^{-2}) = 10^{-16}\n$$\n$$\n\\|b\\|_2 = \\left\\| \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix} \\right\\|_2 = \\sqrt{1^2 + \\varepsilon^2} = \\sqrt{1 + (10^{-14})^2} = \\sqrt{1 + 10^{-28}}\n$$\n对于我们选择的 $\\Delta A$ 和 $\\Delta b$，后向误差度量为 $\\eta = \\frac{\\|\\Delta b\\|}{\\|b\\|} = \\frac{10^{-16}}{\\sqrt{1 + 10^{-28}}}$。\n由于 $\\sqrt{1 + 10^{-28}} > 1$，我们有 $\\eta  10^{-16}$。真正的范数意义下的后向误差是所有可能扰动下的最小值，因此它必须小于或等于这个值。所以，我们证明了 $\\hat{x}$ 的后向误差不超过 $10^{-16}$。\n\n### 任务2：前向误差计算\n\n范数意义下的前向误差比由 $\\frac{\\|x - \\hat{x}\\|}{\\|x\\|}$ 给出。\n首先，我们计算误差向量 $x - \\hat{x}$：\n$$\nx - \\hat{x} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1-\\alpha \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\alpha \\end{pmatrix}\n$$\n接下来，我们计算所需的范数：\n$$\n\\|x - \\hat{x}\\|_2 = \\left\\| \\begin{pmatrix} 0 \\\\ \\alpha \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + \\alpha^2} = \\alpha = 10^{-2}\n$$\n$$\n\\|x\\|_2 = \\left\\| \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right\\|_2 = \\sqrt{1^2 + 1^2} = \\sqrt{2}\n$$\n前向误差比是：\n$$\n\\frac{\\|x - \\hat{x}\\|}{\\|x\\|} = \\frac{10^{-2}}{\\sqrt{2}}\n$$\n为了提供四舍五入到四位有效数字的数值：\n$$\n\\frac{10^{-2}}{\\sqrt{2}} \\approx \\frac{10^{-2}}{1.41421356} \\approx 0.0070710678 \\approx 7.071 \\times 10^{-3}\n$$\n该值约为 $0.007071$。\n\n### 任务3：使用条件数进行解释\n\n小的后向误差（约 $10^{-16}$）和大的多的前向误差（约 $10^{-2}$）之间的差异，可以用矩阵 $A$ 的条件数来解释。\n\n首先，我们推导一个关联前向误差和后向误差的一般性界。从 $(A + \\Delta A)\\hat{x} = b + \\Delta b$ 和 $Ax = b$ 出发，我们可以写出：\n$$\n(A+\\Delta A)\\hat{x} = Ax + \\Delta b \\implies \\hat{x} = (A+\\Delta A)^{-1}(Ax + \\Delta b)\n$$\n误差为 $\\hat{x}-x = (A+\\Delta A)^{-1}(Ax+\\Delta b) - x = (A+\\Delta A)^{-1}[Ax+\\Delta b - (A+\\Delta A)x] = (A+\\Delta A)^{-1}(\\Delta b - \\Delta A x)$。\n取范数，我们得到 $\\|\\hat{x}-x\\| \\le \\|(A+\\Delta A)^{-1}\\| (\\|\\Delta b\\| + \\|\\Delta A\\|\\|x\\|)$。\n使用 Banach 引理，如果 $\\|\\Delta A\\|\\|A^{-1}\\|  1$，那么 $\\|(A+\\Delta A)^{-1}\\| \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|}$。\n将此代入，我们得到：\n$$\n\\|\\hat{x}-x\\| \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|} (\\|\\Delta b\\| + \\|\\Delta A\\|\\|x\\|)\n$$\n除以 $\\|x\\|$ 以得到相对误差：\n$$\n\\frac{\\|\\hat{x}-x\\|}{\\|x\\|} \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|} \\left(\\frac{\\|\\Delta b\\|}{\\|x\\|} + \\|\\Delta A\\|\\right)\n$$\n使用不等式 $\\|b\\|=\\|Ax\\| \\le \\|A\\|\\|x\\| \\implies \\frac{1}{\\|x\\|} \\le \\frac{\\|A\\|}{\\|b\\|}$：\n$$\n\\frac{\\|\\hat{x}-x\\|}{\\|x\\|} \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|} \\left(\\frac{\\|\\Delta b\\|\\|A\\|}{\\|b\\|} + \\|\\Delta A\\|\\right) = \\frac{\\|A\\|\\|A^{-1}\\|}{1-\\|A\\|\\|A^{-1}\\|\\frac{\\|\\Delta A\\|}{\\|A\\|}} \\left(\\frac{\\|\\Delta b\\|}{\\|b\\|} + \\frac{\\|\\Delta A\\|}{\\|A\\|}\\right)\n$$\n令条件数为 $\\kappa_2(A) = \\|A\\|\\|A^{-1}\\|$，并使用后向误差 $\\eta$ 的定义来界定 $\\frac{\\|\\Delta A\\|}{\\|A\\|}$ 和 $\\frac{\\|\\Delta b\\|}{\\|b\\|}$，我们便得到标准界：\n$$\n\\frac{\\|\\hat{x}-x\\|}{\\|x\\|} \\le \\frac{\\kappa_2(A)}{1-\\kappa_2(A)\\frac{\\|\\Delta A\\|}{\\|A\\|}} \\left(\\frac{\\|\\Delta A\\|}{\\|A\\|} + \\frac{\\|\\Delta b\\|}{\\|b\\|}\\right)\n$$\n对于小的后向误差，项 $1-\\kappa_2(A)\\frac{\\|\\Delta A\\|}{\\|A\\|}$ 接近于 $1$。这个界表明，相对于后向误差，前向误差可以被放大一个因子，即条件数 $\\kappa_2(A)$。\n\n现在，我们对给定的数据进行评估。首先，我们计算条件数 $\\kappa_2(A)$。对角矩阵的谱范数是其对角元素绝对值的最大值。\n$$\n\\|A\\|_2 = \\max(1, |\\varepsilon|) = \\max(1, 10^{-14}) = 1\n$$\n$A$ 的逆是 $A^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1/\\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  10^{14} \\end{pmatrix}$。\n$$\n\\|A^{-1}\\|_2 = \\max(1, |1/\\varepsilon|) = \\max(1, 10^{14}) = 10^{14}\n$$\n条件数是：\n$$\n\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = 1 \\cdot 10^{14} = 10^{14}\n$$\n这是一个极大的条件数，表明矩阵 $A$ 是非常病态的。\n\n推导出的不等式表明，前向误差被一个与条件数和后向误差的乘积成正比的量所界定：\n$$\n\\text{前向误差} \\lesssim \\kappa_2(A) \\times (\\text{后向误差})\n$$\n在我们的例子中，后向误差 $\\eta$ 的数量级是 $10^{-16}$，而条件数 $\\kappa_2(A)$ 是 $10^{14}$。它们的乘积约为 $10^{14} \\times 10^{-16} = 10^{-2}$。这个理论估计与我们计算出的前向误差比 $\\frac{10^{-2}}{\\sqrt{2}} \\approx 7.071 \\times 10^{-3}$ 的数量级完全吻合。大的条件数充当了一个放大因子，将一个非常小的后向误差（意味着 $\\hat{x}$ 是一个邻近问题的精确解）转换成一个大的前向误差（意味着 $\\hat{x}$ 远离真实解 $x$）。",
            "answer": "$$\\boxed{0.007071}$$"
        },
        {
            "introduction": "尽管条件数是一个强大的工具，但单一的范数误差度量有时可能会产生误导。本练习探讨了一个场景，其中矩阵是完美条件的（即 $\\kappa(A)=1$），但输入数据中的灾难性相消误差导致解的一个分量出现巨大的相对误差。这突出了在评估数值解的质量时，范数误差分析和分量误差分析之间的关键区别。",
            "id": "3546786",
            "problem": "考虑一个线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 且 $b \\in \\mathbb{R}^{3}$。在精确算术中，设 $A = I_{3}$，并定义右端项为\n$$\nb^{\\ast} = \\begin{pmatrix}\n\\left(10^{8} + 1\\right) - 10^{8} \\\\\n10^{8} \\\\\n-10^{8}\n\\end{pmatrix}.\n$$\n假设使用精度为 $t=8$ 位有效数字且每次运算都舍入到最近的十进制浮点算术，先计算 $\\left(10^{8} + 1\\right)$，然后减去 $10^{8}$。令 $\\widehat{b}$ 表示一个向量，其第一个分量是这两步运算的浮点结果，第二和第三个分量是精确赋值，并令 $\\widehat{x}$ 表示在相同算术下 $A x = \\widehat{b}$ 的计算解。因为 $A = I_{3}$，我们有 $x^{\\ast} = b^{\\ast}$ 且 $\\widehat{x} = \\widehat{b}$。\n\n使用数值线性代数中前向误差的标准定义，其中范数相对前向误差为 $\\left\\|\\widehat{x} - x^{\\ast}\\right\\|_{2} / \\left\\|x^{\\ast}\\right\\|_{2}$，分量相对前向误差为 $\\max_{i} \\left|\\widehat{x}_{i} - x^{\\ast}_{i}\\right| / \\left|x^{\\ast}_{i}\\right|$，请构建由上述算术和相消导致的显式向量 $x^{\\ast}$ 和 $\\widehat{x}$，并解释为什么分量前向误差很大而范数前向误差很小。然后计算比率\n$$\n\\rho = \\frac{\\displaystyle \\max_{i} \\frac{\\left|\\widehat{x}_{i} - x^{\\ast}_{i}\\right|}{\\left|x^{\\ast}_{i}\\right|}}{\\displaystyle \\frac{\\left\\|\\widehat{x} - x^{\\ast}\\right\\|_{2}}{\\left\\|x^{\\ast}\\right\\|_{2}}}.\n$$\n将您关于 $\\rho$ 的最终答案表示为一个单一的闭式解析表达式。无需进行舍入。",
            "solution": "该问题旨在通过一个具体的例子，阐明范数相对前向误差和分量相对前向误差之间的区别。我们将遵循以下步骤：\n1.  根据精确算术计算真实解 $x^{\\ast}$。\n2.  模拟指定的 $t=8$ 位十进制浮点运算，以计算受灾难性相消影响的计算解 $\\widehat{x}$。\n3.  计算并比较两种类型的相对前向误差。\n4.  推导并计算所要求的比率 $\\rho$。\n\n**1. 构建精确解 $x^{\\ast}$**\n由于系数矩阵 $A = I_3$（单位矩阵），精确解 $x^{\\ast}$ 等于精确的右端项 $b^{\\ast}$。\n$$\nx^{\\ast} = b^{\\ast} = \\begin{pmatrix}\n(10^{8} + 1) - 10^{8} \\\\\n10^{8} \\\\\n-10^{8}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{8} \\\\\n-10^{8}\n\\end{pmatrix}\n$$\n\n**2. 构建计算解 $\\widehat{x}$**\n计算解 $\\widehat{x}$ 等于计算出的右端项 $\\widehat{b}$。我们需要使用 $t=8$ 位有效数字的十进制浮点算术来计算 $\\widehat{b}$ 的第一个分量。\n*   **第一步：加法**\n    $10^8 + 1 = 100,000,001$。用科学记数法表示为 $1.00000001 \\times 10^8$。这个数有9位有效数字。\n    在精度为 $t=8$ 的算术中，我们需要将其舍入到8位有效数字。由于第9位数字是1（小于5），我们向下舍入（截断）。\n    因此，$\\text{fl}(10^8 + 1) = 1.0000000 \\times 10^8 = 10^8$。\n*   **第二步：减法**\n    接下来，我们用上一步的结果减去 $10^8$。\n    $\\text{fl}(\\text{fl}(10^8 + 1) - 10^8) = \\text{fl}(10^8 - 10^8) = 0$。\n    这个过程是**灾难性相消**的典型例子：在加法中，一个较小的数（1）的信息被完全丢失，导致随后的减法产生了一个与真实值（1）相差甚远的错误结果（0）。\n\n因此，计算出的右端项向量为：\n$$\n\\widehat{b} = \\begin{pmatrix} 0 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix}\n$$\n由于 $A=I_3$，计算解 $\\widehat{x} = \\widehat{b}$。\n\n**3. 误差分析**\n现在我们计算两种相对前向误差。\n*   **分量相对前向误差**:\n    误差向量为 $\\widehat{x} - x^{\\ast} = \\begin{pmatrix} 0 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n    各分量的相对误差为：\n    - 第1分量: $\\frac{|\\widehat{x}_1 - x^{\\ast}_1|}{|x^{\\ast}_1|} = \\frac{|0-1|}{|1|} = 1$ (即100%的误差)。\n    - 第2分量: $\\frac{|\\widehat{x}_2 - x^{\\ast}_2|}{|x^{\\ast}_2|} = \\frac{|10^8-10^8|}{|10^8|} = 0$。\n    - 第3分量: $\\frac{|\\widehat{x}_3 - x^{\\ast}_3|}{|x^{\\ast}_3|} = \\frac{|-10^8 - (-10^8)|}{|-10^8|} = 0$。\n    分量相对前向误差是这些值的最大值：\n    $$ \\max_{i} \\frac{|\\widehat{x}_{i} - x^{\\ast}_{i}|}{|x^{\\ast}_{i}|} = \\max(1, 0, 0) = 1 $$\n    这个值很大，反映了第一个分量计算的完全失败。\n\n*   **范数相对前向误差**:\n    首先，计算误差向量和真实解向量的2-范数：\n    - $\\|\\widehat{x} - x^{\\ast}\\|_2 = \\left\\| \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{(-1)^2 + 0^2 + 0^2} = 1$。\n    - $\\|x^{\\ast}\\|_2 = \\left\\| \\begin{pmatrix} 1 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix} \\right\\|_2 = \\sqrt{1^2 + (10^8)^2 + (-10^8)^2} = \\sqrt{1 + 2 \\times 10^{16}}$。\n    范数相对前向误差为：\n    $$ \\frac{\\|\\widehat{x} - x^{\\ast}\\|_{2}}{\\|x^{\\ast}\\|_{2}} = \\frac{1}{\\sqrt{1 + 2 \\times 10^{16}}} $$\n    由于 $\\sqrt{1 + 2 \\times 10^{16}} \\approx \\sqrt{2} \\times 10^8$，这个误差值非常小。\n    \n**解释**: 范数误差很小，因为它将误差（完全集中在第一个分量上）的大小与整个向量的巨大范数进行了比较。向量的范数由其大分量（$10^8$和$-10^8$）主导，这掩盖了小分量上的灾难性误差。相反，分量误差分析则能精确地揭示出第一个分量上的巨大相对误差。\n\n**4. 计算比率 $\\rho$**\n比率 $\\rho$ 的定义为：\n$$\n\\rho = \\frac{\\displaystyle \\max_{i} \\frac{|\\widehat{x}_{i} - x^{\\ast}_{i}|}{|x^{\\ast}_{i}|}}{\\displaystyle \\frac{\\|\\widehat{x} - x^{\\ast}\\|_{2}}{\\|x^{\\ast}\\|_{2}}}\n$$\n代入我们计算出的值：\n$$\n\\rho = \\frac{1}{\\frac{1}{\\sqrt{1 + 2 \\times 10^{16}}}} = \\sqrt{1 + 2 \\times 10^{16}}\n$$\n这就是所要求的闭式解析表达式。",
            "answer": "$$ \\boxed{\\sqrt{1 + 2 \\times 10^{16}}} $$"
        },
        {
            "introduction": "看过病态条件如何降低解的精度后，一个自然的问题是：我们能对此做些什么吗？本练习介绍了一种称为“平衡”（equilibration）的预处理实用技术。我们将看到，简单的行和列缩放如何能显著改善矩阵的条件数，从而收紧前向误差的理论界限，并最终获得更准确的数值解。",
            "id": "3546820",
            "problem": "考虑线性系统 $A x = b$，其中\n$$\nA = \\begin{pmatrix} 10^{-3}  0 \\\\ 0  1 \\end{pmatrix}, \n\\qquad \nx_{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n\\qquad \nb = A x_{\\star} = \\begin{pmatrix} 10^{-3} \\\\ 1 \\end{pmatrix}.\n$$\n我们使用一个简单的直接求解器，在基数为10、有效数字为 $t=3$ 位的四舍五入浮点运算中求解 $x$。假设该求解器在以下意义上是范数后向稳定的：计算出的解 $\\widehat{x}$ 是一个扰动系统 $(A + \\Delta A)\\widehat{x} = b + \\Delta b$ 的精确解，其中\n$$\n\\max\\!\\left\\{\\frac{\\|\\Delta A\\|_{2}}{\\|A\\|_{2}},\\,\\frac{\\|\\Delta b\\|_{2}}{\\|b\\|_{2}}\\right\\} \\;\\le\\; u,\n\\qquad\nu \\;=\\; 5\\times 10^{-4}.\n$$\n您将研究一个同时使用行和列缩放的平衡步骤之前和之后的正向误差。定义对角缩放\n$$\nD_{r} \\;=\\; \\operatorname{diag}\\!\\big(10^{3/2},\\,1\\big),\n\\qquad\nD_{c} \\;=\\; \\operatorname{diag}\\!\\big(10^{3/2},\\,1\\big),\n$$\n并考虑平衡后的系统\n$$\n\\big(D_{r} A D_{c}\\big)\\,y \\;=\\; D_{r} b,\n\\qquad\nx \\;=\\; D_{c}\\,y.\n$$\n\n使用谱范数（也称为$2$-范数）下的范数正向误差分析，按以下步骤进行：\n\n1. 从后向稳定性的定义关系和基本扰动恒等式出发，推导出标准界，即在 $\\kappa_{2}(M)\\,\\eta  1$ 的条件下，\n$$\n\\frac{\\|\\widehat{z}-z\\|_{2}}{\\|z\\|_{2}} \\;\\le\\; \\frac{\\kappa_{2}(M)\\,\\eta}{\\,1 - \\kappa_{2}(M)\\,\\eta\\,},\n$$\n其中 $M$ 是一个非奇异系数矩阵，$z$ 是 $M z = f$ 的精确解，$\\widehat{z}$ 是计算解，$\\eta$ 是范数相对后向误差。\n2. 计算 $2$-范数条件数 $\\kappa_{2}(A)$ 和 $\\kappa_{2}(D_{r} A D_{c})$。\n3. 根据后向稳定性假设，用 $u$ 代替 $\\eta$，构建原始系统和平衡后系统的最坏情况相对正向误差界，然后计算比率\n$$\nR \\;=\\; \\frac{\\text{平衡前的界}}{\\text{平衡后的界}}.\n$$\n\n$R$ 的数值是多少？将您的答案四舍五入到四位有效数字。最终答案必须以纯数字形式报告，不带单位。",
            "solution": "该问题要求我们分析一个简单的预处理技术——平衡（equilibration），如何通过改善矩阵的条件数来减小前向误差的理论上界。我们将按照指定的三个步骤进行求解。\n\n### 第1部分：正向误差界的推导\n\n我们推导线性系统 $Mz=f$ 的标准正向误差界。设 $M$ 为非奇异矩阵，精确解为 $z = M^{-1}f$。计算解 $\\widehat{z}$ 满足一个扰动系统。为推导题目中给出的特定公式，我们考虑如下后向误差模型：\n$$(M + \\Delta M) \\widehat{z} = f$$\n其中后向误差由 $\\|\\Delta M\\|_2 \\le \\eta \\|M\\|_2$ 界定。\n\n从 $(M + \\Delta M) \\widehat{z} = f$ 和 $Mz=f$ 出发，我们得到：\n$$(M + \\Delta M) \\widehat{z} - Mz = 0 \\implies M(\\widehat{z} - z) = -\\Delta M \\widehat{z}$$\n两边乘以 $M^{-1}$，然后取范数：\n$$\\widehat{z} - z = -M^{-1} \\Delta M \\widehat{z} \\implies \\|\\widehat{z} - z\\|_{2} \\le \\|M^{-1}\\|_{2} \\|\\Delta M\\|_{2} \\|\\widehat{z}\\|_{2}$$\n使用后向误差界 $\\|\\Delta M\\|_2 \\le \\eta \\|M\\|_2$ 和条件数 $\\kappa_2(M) = \\|M\\|_2 \\|M^{-1}\\|_2$：\n$$\\|\\widehat{z} - z\\|_{2} \\le \\|M^{-1}\\|_{2} (\\eta \\|M\\|_{2}) \\|\\widehat{z}\\|_{2} = \\eta \\kappa_2(M) \\|\\widehat{z}\\|_{2}$$\n为了得到相对误差，两边除以 $\\|z\\|_2$：\n$$\\frac{\\|\\widehat{z} - z\\|_{2}}{\\|z\\|_{2}} \\le \\eta \\kappa_2(M) \\frac{\\|\\widehat{z}\\|_{2}}{\\|z\\|_{2}}$$\n我们用三角不等式界定 $\\|\\widehat{z}\\|_2$：$\\|\\widehat{z}\\|_2 = \\|z + (\\widehat{z}-z)\\|_2 \\le \\|z\\|_2 + \\|\\widehat{z}-z\\|_2$。两边除以 $\\|z\\|_2$ 得：\n$$\\frac{\\|\\widehat{z}\\|_2}{\\|z\\|_2} \\le 1 + \\frac{\\|\\widehat{z}-z\\|_2}{\\|z\\|_2}$$\n令 $e_{rel} = \\frac{\\|\\widehat{z} - z\\|_{2}}{\\|z\\|_{2}}$，将此关系代入主不等式：\n$$e_{rel} \\le \\eta \\kappa_2(M) (1 + e_{rel}) \\implies e_{rel}(1 - \\eta \\kappa_2(M)) \\le \\eta \\kappa_2(M)$$\n在假设 $\\eta \\kappa_2(M)  1$ 的条件下，我们可以整理得到所要求的界：\n$$e_{rel} = \\frac{\\|\\widehat{z}-z\\|_{2}}{\\|z\\|_{2}} \\le \\frac{\\kappa_{2}(M)\\,\\eta}{\\,1 - \\kappa_{2}(M)\\,\\eta\\,}$$\n\n### 第2部分：条件数的计算\n\n**a) 原始矩阵 $A$**\n$$A = \\begin{pmatrix} 10^{-3}  0 \\\\ 0  1 \\end{pmatrix}$$\n由于 $A$ 是对角矩阵，其 $2$-范数是其对角元素绝对值的最大值：$\\|A\\|_2 = \\max(10^{-3}, 1) = 1$。\n其逆矩阵为 $A^{-1} = \\begin{pmatrix} 10^{3}  0 \\\\ 0  1 \\end{pmatrix}$，因此 $\\|A^{-1}\\|_2 = \\max(10^3, 1) = 10^3$。\n所以，条件数为：\n$$\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = 1 \\times 10^3 = 1000$$\n\n**b) 平衡后矩阵 $\\tilde{A} = D_r A D_c$**\n给定的缩放矩阵为 $D_r = \\operatorname{diag}(10^{3/2}, 1)$ 和 $D_c = \\operatorname{diag}(10^{3/2}, 1)$。\n$$\\tilde{A} = D_r A D_c = \\begin{pmatrix} 10^{3/2}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10^{-3}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10^{3/2}  0 \\\\ 0  1 \\end{pmatrix}$$\n矩阵乘法得到：\n$$\\tilde{A} = \\begin{pmatrix} 10^{3/2} \\cdot 10^{-3} \\cdot 10^{3/2}  0 \\\\ 0  1 \\cdot 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 10^{3/2 - 3 + 3/2}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 10^{0}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$$\n平衡后的矩阵是单位矩阵 $I$。单位矩阵的条件数是所有非奇异矩阵中最小的：\n$$\\kappa_2(D_r A D_c) = \\kappa_2(I) = 1$$\n\n### 第3部分：正向误差界的比率\n\n我们使用第1部分推导的公式和给定的后向误差上界 $\\eta = u = 5 \\times 10^{-4}$ 来计算误差界。\n\n**平衡前的误差界**:\n该界基于 $\\kappa_2(A) = 1000$。\n首先检查条件 $\\kappa_2(A) u  1$: $1000 \\times (5 \\times 10^{-4}) = 0.5  1$。条件满足。\n$$\\text{Bound}_{\\text{before}} = \\frac{\\kappa_2(A) u}{1 - \\kappa_2(A) u} = \\frac{0.5}{1 - 0.5} = \\frac{0.5}{0.5} = 1$$\n\n**平衡后的误差界**:\n该界基于 $\\kappa_2(\\tilde{A}) = 1$。\n首先检查条件 $\\kappa_2(\\tilde{A}) u  1$: $1 \\times (5 \\times 10^{-4}) = 0.0005  1$。条件满足。\n$$\\text{Bound}_{\\text{after}} = \\frac{\\kappa_2(\\tilde{A}) u}{1 - \\kappa_2(\\tilde{A}) u} = \\frac{0.0005}{1 - 0.0005} = \\frac{0.0005}{0.9995}$$\n\n**比率 $R$**:\n$$R = \\frac{\\text{Bound}_{\\text{before}}}{\\text{Bound}_{\\text{after}}} = \\frac{1}{\\frac{0.0005}{0.9995}} = \\frac{0.9995}{0.0005} = \\frac{9995}{5} = 1999$$\n比率 $R$ 的精确值为 $1999$。四舍五入到四位有效数字即为 $1999$。",
            "answer": "$$\\boxed{1999}$$"
        }
    ]
}