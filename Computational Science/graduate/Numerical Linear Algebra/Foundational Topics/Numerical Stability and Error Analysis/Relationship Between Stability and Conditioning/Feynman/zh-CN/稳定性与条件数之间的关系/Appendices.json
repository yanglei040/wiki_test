{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在阐明问题条件与算法稳定性之间的基本关系。我们将分析一个情景：一个具有显著、非平凡向后误差（因此是不稳定的）的算法，被应用于一个条件非常好的问题。这个练习将展示良好的条件如何能够减轻算法的不稳定性，从而得到一个出人意料的精确结果，并具体验证“向前误差约等于条件数乘以向后误差”这一经验法则。",
            "id": "3573488",
            "problem": "考虑 $\\mathbb{R}^{3}$ 中的线性系统 $A x = b$，其中\n$$\nA = \\mathrm{diag}(1, 2, 3), \\qquad b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}.\n$$\n一个求解器中的实现错误会产生迭代值 $y$，该错误首先将 $A$ 替换为 $A + E$（其中 $E = 0.05\\,A$），然后计算\n$$\ny = (A + E)^{-1} b.\n$$\n这种做法在算法上是不稳定的，因为后向误差 $\\|E\\|_{2} / \\|A\\|_{2}$ 不接近底层算术的舍入误差水平。然而，问题实例 $(A, b)$ 可能具有足够好的条件，从而减轻这种不稳定性，并仍然能得到一个精确的 $y$。\n\n仅使用数值线性代数的核心定义（2-范数条件数 $\\kappa_{2}(A) = \\|A\\|_{2}\\,\\|A^{-1}\\|_{2}$、由扰动 $E$ 表征的后向误差，以及前向误差 $\\|y - x\\|_{2}$，其中 $x = A^{-1} b$），执行以下操作：\n\n1. 计算 2-范数条件数 $\\kappa_{2}(A)$。\n2. 计算相对后向误差 $\\|E\\|_{2} / \\|A\\|_{2}$。\n3. 从 $(A + E) y = b$ 出发，推导出用 $x$ 和 $A^{-1}E$ 表示的 $y$，并求出相对前向误差 $\\|y - x\\|_{2} / \\|x\\|_{2}$ 的精确值。\n4. 提供相对前向误差的精确值，以单个数字表示。不要四舍五入；以最简精确形式表示答案。\n\n您的最终答案必须是如上所述的单个实数值。",
            "solution": "所述问题在形式上是合理的。它内容自洽，在数值线性代数领域有科学依据，并且是适定的，提供了计算唯一可验证解所需的所有信息。所有术语均根据该领域的标准惯例定义。因此，有必要给出完整解。\n\n问题要求四个具体项目：矩阵 $A$ 的条件数、相对后向误差、相对前向误差的推导及其精确值。我们将依次解决每一项。\n\n给定的线性系统是 $A x = b$，其中矩阵 $A$ 和向量 $b$ 定义如下：\n$$\nA = \\mathrm{diag}(1, 2, 3) = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n精确解是 $x = A^{-1} b$。\n一个扰动解 $y$ 是从 $(A+E)y=b$ 计算得出的，其中扰动为 $E = 0.05 A$。\n\n**1. 条件数 $\\kappa_{2}(A)$ 的计算**\n\n2-范数条件数定义为 $\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2}$。对于对角矩阵，矩阵的 2-范数是其对角线元素绝对值的最大值。\n矩阵 $A$ 的对角线元素为 $1$、$2$ 和 $3$。因此，其 2-范数为：\n$$\n\\|A\\|_{2} = \\max(|1|, |2|, |3|) = 3\n$$\n$A$ 的逆矩阵也是一个对角矩阵，可以通过取每个对角线元素的倒数来得到：\n$$\nA^{-1} = \\mathrm{diag}(1^{-1}, 2^{-1}, 3^{-1}) = \\mathrm{diag}\\left(1, \\frac{1}{2}, \\frac{1}{3}\\right)\n$$\n$A^{-1}$ 的 2-范数同样是其对角线元素绝对值的最大值：\n$$\n\\|A^{-1}\\|_{2} = \\max\\left(|1|, \\left|\\frac{1}{2}\\right|, \\left|\\frac{1}{3}\\right|\\right) = 1\n$$\n因此，条件数 $\\kappa_{2}(A)$ 为：\n$$\n\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2} = 3 \\times 1 = 3\n$$\n\n**2. 相对后向误差的计算**\n\n相对后向误差由表达式 $\\|E\\|_{2} / \\|A\\|_{2}$ 给出。\n扰动矩阵 $E$ 定义为 $E = 0.05 A$。\n$$\nE = 0.05 \\times \\mathrm{diag}(1, 2, 3) = \\mathrm{diag}(0.05, 0.10, 0.15)\n$$\n$E$ 的 2-范数是其对角线元素绝对值的最大值：\n$$\n\\|E\\|_{2} = \\max(|0.05|, |0.10|, |0.15|) = 0.15\n$$\n那么相对后向误差为：\n$$\n\\frac{\\|E\\|_{2}}{\\|A\\|_{2}} = \\frac{0.15}{3} = 0.05\n$$\n另外，由于范数是齐次的，对于 $E=cA$（其中 $c$ 是一个标量），我们有 $\\|E\\|_2 = \\|cA\\|_2 = |c|\\|A\\|_2$。因此，相对后向误差为 $\\frac{|c|\\|A\\|_2}{\\|A\\|_2} = |c|$。在这个问题中，$c = 0.05$，所以相对后向误差必定是 $0.05$。\n\n**3. 相对前向误差的推导与计算**\n\n计算出的解 $y$ 满足方程 $(A + E) y = b$。精确解 $x$ 满足 $A x = b$。我们可以将 $b=Ax$ 代入第一个方程：\n$$\n(A + E) y = A x\n$$\n由于 $A = \\mathrm{diag}(1, 2, 3)$，其行列式为 $1 \\times 2 \\times 3 = 6 \\neq 0$，所以 $A$ 是可逆的。我们可以从左侧乘以 $A^{-1}$：\n$$\nA^{-1}(A + E) y = A^{-1}(A x)\n$$\n$$\n(A^{-1}A + A^{-1}E) y = (A^{-1}A) x\n$$\n$$\n(I + A^{-1}E) y = I x = x\n$$\n这里，$I$ 是 $3 \\times 3$ 的单位矩阵。\n问题给出了扰动的具体结构，$E = 0.05 A$。我们可以将其代入 $A^{-1}E$ 项中：\n$$\nA^{-1}E = A^{-1}(0.05 A) = 0.05 (A^{-1} A) = 0.05 I\n$$\n这极大地简化了关于 $y$ 的方程：\n$$\n(I + 0.05 I) y = x\n$$\n$$\n(1.05 I) y = x\n$$\n解出 $y$ 可以得到 $y$ 和 $x$ 之间的一个简单关系：\n$$\ny = (1.05 I)^{-1} x = \\frac{1}{1.05} I x = \\frac{1}{1.05} x\n$$\n现在我们可以确定前向误差 $y - x$：\n$$\ny - x = \\frac{1}{1.05} x - x = \\left(\\frac{1}{1.05} - 1\\right) x = \\left(\\frac{1 - 1.05}{1.05}\\right) x = -\\frac{0.05}{1.05} x\n$$\n相对前向误差定义为 $\\frac{\\|y - x\\|_{2}}{\\|x\\|_{2}}$。\n对前向误差向量取 2-范数：\n$$\n\\|y - x\\|_{2} = \\left\\|-\\frac{0.05}{1.05} x\\right\\|_{2} = \\left|-\\frac{0.05}{1.05}\\right| \\|x\\|_{2} = \\frac{0.05}{1.05} \\|x\\|_{2}\n$$\n向量 $x = A^{-1} b = \\mathrm{diag}(1, 1/2, 1/3) \\begin{pmatrix} 1, 1, 1 \\end{pmatrix}^T = \\begin{pmatrix} 1, 1/2, 1/3 \\end{pmatrix}^T$ 不是零向量，所以其范数 $\\|x\\|_{2}$ 非零，我们可以用它来除。\n相对前向误差为：\n$$\n\\frac{\\|y - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\frac{0.05}{1.05} \\|x\\|_{2}}{\\|x\\|_{2}} = \\frac{0.05}{1.05}\n$$\n\n**4. 相对前向误差的精确值**\n\n最后一步是将这个值表示为其最简精确形式。\n$$\n\\frac{0.05}{1.05} = \\frac{5/100}{105/100} = \\frac{5}{105}\n$$\n将分子和分母同除以它们的最大公约数 $5$：\n$$\n\\frac{5}{105} = \\frac{5 \\div 5}{105 \\div 5} = \\frac{1}{21}\n$$\n因此，相对前向误差的精确值为 $\\frac{1}{21}$。",
            "answer": "$$\\boxed{\\frac{1}{21}}$$"
        },
        {
            "introduction": "在核心概念的基础上，本实践将探讨对于一个病态问题，算法的选择如何极大地影响解的精度。我们将比较求解最小二乘问题的两种方法：一种基于QR分解，另一种使用正规方程。本练习将通过证明正规方程方法的误差界与问题条件数的平方 $\\kappa_2(A)^2$ 相关（而非更稳定的QR方法），来量化解释为何正规方程在数值上是不稳定的。",
            "id": "3573481",
            "problem": "考虑一个超定最小二乘 (LS) 问题，其矩阵和右端项为\n$$\nA_{\\delta} \\in \\mathbb{R}^{3 \\times 2}, \\quad A_{\\delta} = \\begin{pmatrix} 1  0 \\\\ 0  \\delta \\\\ 0  0 \\end{pmatrix}, \n\\qquad \nb_{\\delta} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix},\n$$\n其中 $\\delta \\in (0,1)$ 是一个参数。精确的最小二乘解 $x^{\\star}$ 满足 $A_{\\delta} x^{\\star} = b_{\\delta}$。\n\n假设使用浮点运算，单位舍入误差为 $u = 2^{-53}$。考虑两种求解器：\n1. 基于正交三角 (QR) 分解的最小二乘求解器。\n2. 一个正规方程求解器，它首先在浮点运算中形成 $A_{\\delta}^{\\top} A_{\\delta}$ 和 $A_{\\delta}^{\\top} b_{\\delta}$，然后用数值稳定的方法求解得到的对称正定 (SPD) 线性系统。\n\n仅从以下基础出发：\n- 对于一个满列秩矩阵 $M$，谱（二范数）条件数 $\\kappa_{2}(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$，其中 $\\sigma_{\\max}(M)$ 和 $\\sigma_{\\min}(M)$ 分别是最大和最小奇异值。\n- 后向稳定性的定义：一个后向稳定的算法返回一个邻近问题的精确解，该问题的输入数据在相对范数意义下有量级为 $u$ 的扰动。\n- 前向误差与条件数之间的一阶关系：在主导阶上，相对前向误差的界是条件数乘以数据的相对后向误差。\n- 对于任何满列秩矩阵 $A$，恒等式 $\\kappa_{2}(A^{\\top}A) = \\kappa_{2}(A)^{2}$ 成立。\n\n推导每个求解器相对前向误差 $\\|x_{\\mathrm{comp}} - x^{\\star}\\|_{2}/\\|x^{\\star}\\|_{2}$ 的显式一阶上界，用 $\\kappa_{2}(A_{\\delta})$ 和 $u$ 表示。使用这些上界，计算比率\n$$\nR(\\delta) = \\frac{\\text{(正规方程前向误差界)}}{\\text{(QR前向误差界)}}\n$$\n在 $\\delta = 10^{-8}$ 的具体实例下。将 $R(10^{-8})$ 作为你的最终答案报告。无需四舍五入，也无需单位。",
            "solution": "用户希望我批判性地验证并解决一个数值线性代数问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   最小二乘问题，矩阵为 $A_{\\delta} \\in \\mathbb{R}^{3 \\times 2}$，右端项为 $b_{\\delta}$，其中\n    $$\n    A_{\\delta} = \\begin{pmatrix} 1  0 \\\\ 0  \\delta \\\\ 0  0 \\end{pmatrix}, \n    \\qquad \n    b_{\\delta} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix}.\n    $$\n*   参数 $\\delta$ 的范围是 $\\delta \\in (0,1)$。\n*   精确的最小二乘解 $x^{\\star}$ 满足方程 $A_{\\delta} x^{\\star} = b_{\\delta}$。\n*   使用浮点运算，单位舍入误差为 $u = 2^{-53}$。\n*   考虑两种求解器：基于 QR 的求解器和正规方程求解器。\n*   分析必须基于四个基本原则：\n    1.  谱条件数为 $\\kappa_{2}(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$。\n    2.  一个后向稳定的算法给出邻近问题的精确解，该问题的输入数据在相对范数意义下有量级为 $u$ 的扰动。\n    3.  一阶关系：相对前向误差 $\\le$ (条件数) $\\times$ (相对后向误差)。\n    4.  恒等式：对于满列秩矩阵 $A$，$\\kappa_{2}(A^{\\top}A) = \\kappa_{2}(A)^{2}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题在数值线性代数的既定原则上具有坚实的科学基础。它是用于说明条件数和稳定性概念的典型例子。问题陈述是客观、自洽且数学上一致的。对于 $\\delta \\in (0,1)$，矩阵 $A_\\delta$ 是满列秩的。条件 $A_{\\delta} x^{\\star} = b_{\\delta}$ 意味着最小二乘问题的残差为零，这是一个至关重要的细节。\n设 $x^{\\star} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。那么 $A_{\\delta} x^{\\star} = \\begin{pmatrix} 1  0 \\\\ 0  \\delta \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} x_1 \\\\ \\delta x_2 \\\\ 0 \\end{pmatrix}$。令其等于 $b_{\\delta} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix}$，得到 $x_1=1$ 和 $\\delta x_2 = \\delta$。由于 $\\delta \\neq 0$，我们有 $x_2=1$。因此，精确解是 $x^{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，这证实了问题陈述的一致性。该问题是适定的，并且基于所提供的基础，有唯一且有意义的求解路径。\n\n**步骤 3：结论和行动**\n\n问题有效。将提供完整解答。\n\n### 解答\n\n解答需要推导两种不同最小二乘求解器的相对前向误差的一阶上界，然后计算它们的比率。前向误差定义为 $\\|x_{\\mathrm{comp}} - x^{\\star}\\|_{2}/\\|x^{\\star}\\|_{2}$。\n\n首先，我们确定矩阵 $A_{\\delta}$ 的条件数。$A_{\\delta}$ 的奇异值是 $A_{\\delta}^{\\top}A_{\\delta}$ 的特征值的平方根。\n$$\nA_{\\delta}^{\\top}A_{\\delta} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\delta  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\delta \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\delta^2 \\end{pmatrix}.\n$$\n这个对角矩阵的特征值是 $\\lambda_1 = 1$ 和 $\\lambda_2 = \\delta^2$。$A_{\\delta}$ 的奇异值是 $\\sigma_{\\max}(A_{\\delta}) = \\sqrt{1} = 1$ 和 $\\sigma_{\\min}(A_{\\delta}) = \\sqrt{\\delta^2} = \\delta$，因为 $\\delta > 0$。\n$A_{\\delta}$ 的谱条件数是：\n$$\n\\kappa_2(A_{\\delta}) = \\frac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})} = \\frac{1}{\\delta}.\n$$\n\n现在，我们使用所提供的基础来分析每个求解器。指导原则是一阶误差关系：\n$$\n\\frac{\\|x_{\\mathrm{comp}} - x^{\\star}\\|_{2}}{\\|x^{\\star}\\|_{2}} \\le (\\text{条件数}) \\times (\\text{相对后向误差}).\n$$\n\n**1. 正交三角 (QR) 分解求解器**\n\n基于 QR 分解的最小二乘求解器是公认的后向稳定算法。根据问题的基础，这意味着计算出的解 $x_{\\mathrm{QR}}$ 是一个邻近问题的精确解，其中数据 $(A_{\\delta}, b_{\\delta})$ 的相对扰动量级为 $u$。所以，相对后向误差的量级为 $u$。\n\n最小二乘问题的适用条件数取决于残差。对于零残差问题，如此处的情况 $A_{\\delta}x^{\\star}=b_{\\delta}$，解的敏感性由 $\\kappa_2(A_{\\delta})$ 决定。\n应用给定的误差关系，QR 求解器的相对前向误差的一阶上界是：\n$$\nE_{\\mathrm{QR}} = \\kappa_2(A_{\\delta}) \\cdot u = \\frac{1}{\\delta} u.\n$$\n这里，我们忽略任何 $O(1)$ 的常数，因为重点是与 $\\kappa_2(A_{\\delta})$ 和 $u$ 的依赖关系。\n\n**2. 正规方程求解器**\n\n该方法包括两个部分：\na. 在浮点运算中形成正规方程矩阵 $C = A_{\\delta}^{\\top}A_{\\delta}$ 和右端项向量 $d = A_{\\delta}^{\\top}b_{\\delta}$。\nb. 使用数值稳定的方法求解得到的对称正定 (SPD) 线性系统 $Cx=d$。\n\n可以将整个过程看作是求解线性系统 $Cx=d$ 的一个算法。步骤(a)中的浮点计算会给该线性系统的数据 $(C, d)$ 引入扰动。步骤(b)中的数值稳定求解器也会贡献后向误差。累积效应是，计算出的解 $x_{\\mathrm{NE}}$ 是一个扰动线性系统的精确解，其中对 $C$ 和 $d$ 的相对扰动量级为 $u$。因此，求解 $Cx=d$ 问题的相对后向误差的量级为 $u$。\n\n与此线性系统问题相关的条件数是 $\\kappa_2(C) = \\kappa_2(A_{\\delta}^{\\top}A_{\\delta})$。使用问题陈述中提供的恒等式，我们可以将其与 $A_{\\delta}$ 的条件数联系起来：\n$$\n\\kappa_2(A_{\\delta}^{\\top}A_{\\delta}) = \\kappa_2(A_{\\delta})^2 = \\left(\\frac{1}{\\delta}\\right)^2 = \\frac{1}{\\delta^2}.\n$$\n应用误差关系，正规方程求解器的相对前向误差的一阶上界是：\n$$\nE_{\\mathrm{NE}} = \\kappa_2(A_{\\delta}^{\\top}A_{\\delta}) \\cdot u = \\kappa_2(A_{\\delta})^2 \\cdot u = \\frac{1}{\\delta^2} u.\n$$\n\n**误差界之比**\n\n我们需要计算比率 $R(\\delta) = \\frac{\\text{(正规方程前向误差界)}}{\\text{(QR前向误差界)}}$。\n$$\nR(\\delta) = \\frac{E_{\\mathrm{NE}}}{E_{\\mathrm{QR}}} = \\frac{\\frac{1}{\\delta^2} u}{\\frac{1}{\\delta} u} = \\frac{1}{\\delta}.\n$$\n\n最后，我们计算在 $\\delta = 10^{-8}$ 的具体实例下该比率的值。\n$$\nR(10^{-8}) = \\frac{1}{10^{-8}} = 10^8.\n$$\n这个结果表明，对于一个病态问题（小的 $\\delta$），正规方程法的误差界显著大于基于 QR 分解的方法的误差界，这突显了后者的优越数值稳定性。",
            "answer": "$$\n\\boxed{10^8}\n$$"
        },
        {
            "introduction": "我们已经看到条件数如何影响精度，现在我们转向一个改善条件数的实用技术。本练习将通过对一个尺度不当的线性系统进行对角缩放，来展示预处理的威力。你将亲眼见证一个简单的变换如何能显著降低矩阵的条件数，从而为一个诸如带部分主元消去的LU分解这样的稳定算法，改善其理论误差界。",
            "id": "3573473",
            "problem": "考虑使用带部分主元法的 LU (Lower–Upper) 分解来求解线性方程组 $A x = b$。设\n$$\nA \\;=\\; \\begin{pmatrix} 10^{-8}  1 \\\\[4pt] 1  10^{7} \\end{pmatrix},\n$$\n该矩阵是尺度不佳的。定义对角缩放矩阵\n$$\nD_{r} \\;=\\; \\begin{pmatrix} 1  0 \\\\[4pt] 0  10^{-7} \\end{pmatrix}, \\qquad\nD_{c} \\;=\\; \\begin{pmatrix} 10^{8}  0 \\\\[4pt] 0  1 \\end{pmatrix},\n$$\n以及缩放后的系数矩阵\n$$\nS \\;=\\; D_{r} \\, A \\, D_{c}.\n$$\n你将分析在后向稳定算法下，对角缩放如何影响无穷范数条件数和前向误差界。\n\n仅从以下基本定义和事实出发：\n- 矩阵无穷范数为 $\\|A\\|_{\\infty} \\;=\\; \\max_{1 \\leq i \\leq n} \\sum_{j=1}^{n} |a_{ij}|$.\n- (无穷范数)条件数为 $\\kappa_{\\infty}(A) \\;=\\; \\|A\\|_{\\infty} \\, \\|A^{-1}\\|_{\\infty}$.\n- 带部分主元法的高斯消元的后向稳定性：计算出的解 $\\hat{x}$ 满足 $(A + \\Delta A)\\hat{x} = b$，其后向误差的界为 $\\|\\Delta A\\|_{\\infty} \\leq C \\, n \\, \\rho \\, \\epsilon \\, \\|A\\|_{\\infty}$，其中 $C$ 是一个与 $A$ 无关的适中常数，$n$ 是维数，$\\rho$ 是增长因子，$\\epsilon$ 是机器精度。\n- 前向误差和条件作用通过第一性原理相关联：如果 $(A + \\Delta A)\\hat{x} = b$ 且 $A x = b$，则 $A(\\hat{x} - x) = -\\Delta A \\hat{x}$，这可以与上述不等式结合，得出一个前向误差界，其主项与 $\\kappa_{\\infty}(A)$ 和相对后向误差的乘积成正比。\n\n任务：\n1. 根据 $A$, $D_{r}$ 和 $D_{c}$ 显式计算 $S$，并使用上述范数和条件数的定义精确计算 $\\kappa_{\\infty}(A)$ 和 $\\kappa_{\\infty}(S)$。\n2. 对每个矩阵执行 $2 \\times 2$ 带部分主元法的 LU 分解，并通过比较得到的上三角因子中的最大绝对值元素与原始矩阵中的最大绝对值元素来确定增长因子 $\\rho$。\n3. 仅使用给定的定义和事实，推导相对前向误差 $\\|\\hat{x} - x\\|_{\\infty}/\\|x\\|_{\\infty}$ 的一个上界，其主阶项（关于 $\\epsilon$）分离出对 $\\kappa_{\\infty}(\\cdot)$ 的依赖关系，并解释对角缩放如何改变这个界。\n4. 最后，在简化假设下（即 $C$, $n$, $\\rho$ 和 $\\epsilon$ 对两个系统是相同的，且主阶项占主导地位，即为了得到一个有意义的界，可以忽略 $\\epsilon$ 的高阶项），计算精确比值\n$$\nR \\;=\\; \\frac{\\text{A 的主阶上界}}{\\text{S 的主阶上界}},\n$$\n其中 leading-order upper bound for A 指 A 的主阶上界，leading-order upper bound for S 指 S 的主阶上界。\n\n将你的最终答案 $R$ 表示为最简形式的单个精确有理数。无需四舍五入。",
            "solution": "这个问题是数值线性代数中的一个有效练习，考察了矩阵缩放、条件数和 LU 分解的误差分析等概念。所有给定的定义都是标准的，任务也是适定的。我们将按顺序完成四个指定的任务来给出解答。\n\n### 任务1：缩放矩阵和条件数\n\n首先，我们计算缩放矩阵 $S = D_{r} A D_{c}$。\n给定的矩阵是：\n$$ A = \\begin{pmatrix} 10^{-8}  1 \\\\ 1  10^{7} \\end{pmatrix}, \\quad D_{r} = \\begin{pmatrix} 1  0 \\\\ 0  10^{-7} \\end{pmatrix}, \\quad D_{c} = \\begin{pmatrix} 10^{8}  0 \\\\ 0  1 \\end{pmatrix} $$\n乘积计算如下：\n$$ S = D_{r} A D_{c} = \\begin{pmatrix} 1  0 \\\\ 0  10^{-7} \\end{pmatrix} \\begin{pmatrix} 10^{-8}  1 \\\\ 1  10^{7} \\end{pmatrix} \\begin{pmatrix} 10^{8}  0 \\\\ 0  1 \\end{pmatrix} $$\n$$ S = \\begin{pmatrix} 1 \\cdot 10^{-8} + 0 \\cdot 1  1 \\cdot 1 + 0 \\cdot 10^{7} \\\\ 0 \\cdot 10^{-8} + 10^{-7} \\cdot 1  0 \\cdot 1 + 10^{-7} \\cdot 10^{7} \\end{pmatrix} \\begin{pmatrix} 10^{8}  0 \\\\ 0  1 \\end{pmatrix} $$\n$$ S = \\begin{pmatrix} 10^{-8}  1 \\\\ 10^{-7}  1 \\end{pmatrix} \\begin{pmatrix} 10^{8}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 10^{-8} \\cdot 10^{8} + 1 \\cdot 0  10^{-8} \\cdot 0 + 1 \\cdot 1 \\\\ 10^{-7} \\cdot 10^{8} + 1 \\cdot 0  10^{-7} \\cdot 0 + 1 \\cdot 1 \\end{pmatrix} $$\n$$ S = \\begin{pmatrix} 1  1 \\\\ 10  1 \\end{pmatrix} $$\n接下来，我们计算条件数 $\\kappa_{\\infty}(A)$ 和 $\\kappa_{\\infty}(S)$。条件数定义为 $\\kappa_{\\infty}(M) = \\|M\\|_{\\infty} \\|M^{-1}\\|_{\\infty}$。对于一个通用的 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵为 $M^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n\n对于矩阵 $A$：\n无穷范数是 $\\|A\\|_{\\infty} = \\max(|10^{-8}| + |1|, |1| + |10^{7}|) = 1 + 10^{7}$。\n行列式是 $\\det(A) = (10^{-8})(10^{7}) - (1)(1) = 10^{-1} - 1 = 0.1 - 1 = -0.9 = -\\frac{9}{10}$。\n逆矩阵是 $A^{-1} = \\frac{1}{-9/10} \\begin{pmatrix} 10^{7}  -1 \\\\ -1  10^{-8} \\end{pmatrix} = -\\frac{10}{9} \\begin{pmatrix} 10^{7}  -1 \\\\ -1  10^{-8} \\end{pmatrix}$。\n逆矩阵的范数是 $\\|A^{-1}\\|_{\\infty} = |-\\frac{10}{9}| \\max(|10^{7}| + |-1|, |-1| + |10^{-8}|) = \\frac{10}{9} (10^{7} + 1)$。\n$A$ 的条件数是：\n$$ \\kappa_{\\infty}(A) = \\|A\\|_{\\infty} \\|A^{-1}\\|_{\\infty} = (10^{7} + 1) \\cdot \\frac{10}{9} (10^{7} + 1) = \\frac{10}{9} (10^{7} + 1)^{2} $$\n\n对于矩阵 $S$：\n无穷范数是 $\\|S\\|_{\\infty} = \\max(|1| + |1|, |10| + |1|) = \\max(2, 11) = 11$。\n行列式是 $\\det(S) = (1)(1) - (1)(10) = -9$。\n逆矩阵是 $S^{-1} = \\frac{1}{-9} \\begin{pmatrix} 1  -1 \\\\ -10  1 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} -1  1 \\\\ 10  -1 \\end{pmatrix}$。\n逆矩阵的范数是 $\\|S^{-1}\\|_{\\infty} = \\frac{1}{9} \\max(|-1| + |1|, |10| + |-1|) = \\frac{1}{9} \\max(2, 11) = \\frac{11}{9}$。\n$S$ 的条件数是：\n$$ \\kappa_{\\infty}(S) = \\|S\\|_{\\infty} \\|S^{-1}\\|_{\\infty} = 11 \\cdot \\frac{11}{9} = \\frac{121}{9} $$\n\n### 任务2：LU 分解和增长因子\n\n我们执行带部分主元法的 LU 分解。对于一个矩阵 $M$，增长因子 $\\rho$ 是计算出的上三角因子 $U$ 中的最大绝对值元素与 $M$ 中的最大绝对值元素之比。\n\n对于矩阵 $A = \\begin{pmatrix} 10^{-8}  1 \\\\ 1  10^{7} \\end{pmatrix}$：\n第一列中最大绝对值元素是 $|a_{21}| = 1$。我们通过交换第1行和第2行来选主元。\n令 $P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$。\n$PA = \\begin{pmatrix} 1  10^{7} \\\\ 10^{-8}  1 \\end{pmatrix}$。\n消去乘子是 $m_{21} = \\frac{10^{-8}}{1} = 10^{-8}$。\n$L$ 和 $U$ 因子是：\n$L_{A} = \\begin{pmatrix} 1  0 \\\\ 10^{-8}  1 \\end{pmatrix}$, $U_{A} = \\begin{pmatrix} 1  10^{7} \\\\ 0  1 - (10^{-8})(10^{7}) \\end{pmatrix} = \\begin{pmatrix} 1  10^{7} \\\\ 0  1 - 0.1 \\end{pmatrix} = \\begin{pmatrix} 1  10^{7} \\\\ 0  0.9 \\end{pmatrix}$。\n$A$ 中的最大绝对值元素是 $\\|A\\|_{\\max} = 10^{7}$。$U_A$ 中的最大绝对值元素是 $\\|U_A\\|_{\\max} = 10^{7}$。\n$A$ 的增长因子是 $\\rho_{A} = \\frac{\\|U_A\\|_{\\max}}{\\|A\\|_{\\max}} = \\frac{10^{7}}{10^{7}} = 1$。\n\n对于矩阵 $S = \\begin{pmatrix} 1  1 \\\\ 10  1 \\end{pmatrix}$：\n第一列中最大绝对值元素是 $|s_{21}| = 10$。我们通过交换第1行和第2行来选主元。\n令 $P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$。\n$PS = \\begin{pmatrix} 10  1 \\\\ 1  1 \\end{pmatrix}$。\n消去乘子是 $m_{21} = \\frac{1}{10} = 0.1$。\n$L$ 和 $U$ 因子是：\n$L_{S} = \\begin{pmatrix} 1  0 \\\\ 0.1  1 \\end{pmatrix}$, $U_{S} = \\begin{pmatrix} 10  1 \\\\ 0  1 - (0.1)(1) \\end{pmatrix} = \\begin{pmatrix} 10  1 \\\\ 0  0.9 \\end{pmatrix}$。\n$S$ 中的最大绝对值元素是 $\\|S\\|_{\\max} = 10$。$U_S$ 中的最大绝对值元素是 $\\|U_S\\|_{\\max} = 10$。\n$S$ 的增长因子是 $\\rho_{S} = \\frac{\\|U_S\\|_{\\max}}{\\|S\\|_{\\max}} = \\frac{10}{10} = 1$。\n\n### 任务3：前向误差界推导\n\n给定 $Ax = b$ 的计算解 $\\hat{x}$ 满足 $(A + \\Delta A)\\hat{x} = b$，其中 $\\Delta A$ 是后向误差矩阵。真实解满足 $Ax=b$。\n两方程相减得到 $A\\hat{x} + \\Delta A \\hat{x} - Ax = 0$，整理后为 $A(\\hat{x}-x) = -\\Delta A \\hat{x}$。\n为了求 $x$ 的误差，我们可以写成 $\\hat{x} = x + (\\hat{x}-x)$。将其代入右侧可得：\n$A(\\hat{x}-x) = -\\Delta A (x + (\\hat{x}-x))$。\n整理各项以求解误差 $\\hat{x}-x$：\n$(A+\\Delta A)(\\hat{x}-x) = -\\Delta A x$。\n$\\hat{x}-x = -(A+\\Delta A)^{-1} \\Delta A x$。\n对两边取无穷范数：\n$\\|\\hat{x}-x\\|_{\\infty} = \\|-(A+\\Delta A)^{-1} \\Delta A x\\|_{\\infty} \\le \\|(A+\\Delta A)^{-1}\\|_{\\infty} \\|\\Delta A\\|_{\\infty} \\|x\\|_{\\infty}$。\n我们可以写成 $(A+\\Delta A)^{-1} = (A(I+A^{-1}\\Delta A))^{-1} = (I+A^{-1}\\Delta A)^{-1} A^{-1}$。\n使用范数的次乘性质和 $(I-B)^{-1}$ 的级数展开，假设 $\\|A^{-1}\\Delta A\\|_{\\infty}  1$：\n$\\|(A+\\Delta A)^{-1}\\|_{\\infty} \\le \\|(I+A^{-1}\\Delta A)^{-1}\\|_{\\infty} \\|A^{-1}\\|_{\\infty} \\le \\frac{\\|A^{-1}\\|_{\\infty}}{1-\\|A^{-1}\\Delta A\\|_{\\infty}}$。\n将此代入误差不等式，得到相对前向误差的界：\n$$ \\frac{\\|\\hat{x}-x\\|_{\\infty}}{\\|x\\|_{\\infty}} \\le \\frac{\\|A^{-1}\\|_{\\infty} \\|\\Delta A\\|_{\\infty}}{1 - \\|A^{-1}\\|_{\\infty} \\|\\Delta A\\|_{\\infty}} $$\n给定 $\\|\\Delta A\\|_{\\infty} \\le C n \\rho \\epsilon \\|A\\|_{\\infty}$。令 $\\eta = C n \\rho \\epsilon$。\n则 $\\|A^{-1}\\|_{\\infty} \\|\\Delta A\\|_{\\infty} \\le \\|A^{-1}\\|_{\\infty} (\\eta \\|A\\|_{\\infty}) = \\eta \\kappa_{\\infty}(A)$。\n代入后，我们得到界：\n$$ \\frac{\\|\\hat{x}-x\\|_{\\infty}}{\\|x\\|_{\\infty}} \\le \\frac{\\eta \\kappa_{\\infty}(A)}{1 - \\eta \\kappa_{\\infty}(A)} $$\n对于小的 $\\epsilon$，项 $\\eta \\kappa_{\\infty}(A)$ 也很小，我们可以将分母展开为几何级数：$\\eta \\kappa_{\\infty}(A) (1 + \\eta \\kappa_{\\infty}(A) + (\\eta \\kappa_{\\infty}(A))^2 + \\dots)$。\n这个上界的主阶项（关于 $\\epsilon$）是 $\\eta \\kappa_{\\infty}(A) = C n \\rho \\epsilon \\kappa_{\\infty}(A)$。\n\n对角缩放将问题 $Ax=b$ 转换为一个等价系统 $Sy=d$，其中 $S=D_r A D_c$，$y=D_c^{-1}x$，$d=D_r b$。求解这个新系统 $y$ 的前向误差界的主阶项为 $C n \\rho_S \\epsilon \\kappa_{\\infty}(S)$。缩放通过将原始系统的乘积 $\\rho_A \\kappa_{\\infty}(A)$ 替换为缩放后系统的 $\\rho_S \\kappa_{\\infty}(S)$ 来改变这个界。在这个问题中，$\\rho_A=\\rho_S=1$，因此误差界的变化由条件数的变化决定。我们的计算显示 $\\kappa_{\\infty}(A) \\approx 1.1 \\times 10^{14}$ 而 $\\kappa_{\\infty}(S) \\approx 13.4$，因此缩放显著降低了条件数，从而也降低了前向误差的理论上界。\n\n### 任务4：误差界之比\n\n比值 $R$ 定义为系统 $A$ 的主阶上界除以系统 $S$ 的主阶上界。使用任务3的结果以及假设 $C$, $n$, $\\rho$ 和 $\\epsilon$ 对两个系统是相同的：\n$$ R = \\frac{\\text{A 的主阶上界}}{\\text{S 的主阶上界}} = \\frac{C n \\rho \\epsilon \\, \\kappa_{\\infty}(A)}{C n \\rho \\epsilon \\, \\kappa_{\\infty}(S)} = \\frac{\\kappa_{\\infty}(A)}{\\kappa_{\\infty}(S)} $$\n代入在任务1中计算出的值：\n$$ \\kappa_{\\infty}(A) = \\frac{10}{9} (10^{7} + 1)^{2} $$\n$$ \\kappa_{\\infty}(S) = \\frac{121}{9} $$\n该比值为：\n$$ R = \\frac{\\frac{10}{9} (10^{7} + 1)^{2}}{\\frac{121}{9}} = \\frac{10(10^{7} + 1)^{2}}{121} $$\n为了简化，我们注意到 $10^{7}+1 = 10000001$。其交错数字和为 $1-0+0-0+0-0+0-1=0$，这意味着 $10000001$ 能被 $11$ 整除。\n确实，$10000001 = 11 \\times 909091$。\n将此代入 $R$ 的表达式：\n$$ R = \\frac{10(11 \\times 909091)^{2}}{121} = \\frac{10 \\times 11^{2} \\times 909091^{2}}{121} = 10 \\times 909091^{2} $$\n我们计算平方 $909091^{2}$：\n$$ 909091^{2} = 826446446281 $$\n最后，我们乘以 $10$：\n$$ R = 10 \\times 826446446281 = 8264464462810 $$\n这就是比值 $R$ 的精确有理数值。",
            "answer": "$$\n\\boxed{8264464462810}\n$$"
        }
    ]
}