{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，在三维欧氏空间$ \\mathbb{R}^3 $中应用格拉姆-施密特（Gram-Schmidt）正交化过程。这个练习旨在将抽象的算法步骤与具体的几何直觉联系起来，通过处理一组线性相关的向量，你将亲手构建一个子空间的标准正交基。这个过程不仅能加深你对向量投影和正交性的理解，还能让你探索正交补$ S^{\\perp} $这一核心概念。",
            "id": "3537535",
            "problem": "考虑配备了标准内积 $x \\cdot y = x_{1} y_{1} + x_{2} y_{2} + x_{3} y_{3}$ 的实向量空间 $\\mathbb{R}^{3}$。令 $a_{1} = (1,\\,1,\\,0)$，$a_{2} = (0,\\,1,\\,1)$ 以及 $a_{3} = (1,\\,2,\\,1)$。仅使用内积、向量投影以及经典 Gram–Schmidt 正交化过程的定义，构造一个张成子空间 $S = \\operatorname{span}\\{a_{1}, a_{2}, a_{3}\\} \\subset \\mathbb{R}^{3}$ 的正交集 $\\{q_{1}, q_{2}\\}$，并证明 $S$ 是 $\\mathbb{R}^{3}$ 的一个真子空间。然后，通过与 $q_{1}$ 和 $q_{2}$ 的内积所表示的条件，来刻画所有与 $S$ 正交的向量 $v \\in \\mathbb{R}^{3}$。最后，确定向量 $b = (3,\\,0,\\,1)$ 在正交补 $S^{\\perp}$ 上的正交投影的欧几里得范数的平方。最终答案以单个实数形式给出。无需四舍五入。",
            "solution": "我们从 $\\mathbb{R}^{3}$ 上的标准内积开始，其定义为 $x \\cdot y = \\sum_{i=1}^{3} x_{i} y_{i}$。经典 Gram–Schmidt 正交化过程通过从每个向量中迭代地减去其在先前已构造的正交方向上的投影来构造正交向量。\n\n首先，注意到 $a_{3} = a_{1} + a_{2}$。因此，\n$$\nS = \\operatorname{span}\\{a_{1}, a_{2}, a_{3}\\} = \\operatorname{span}\\{a_{1}, a_{2}\\}.\n$$\n由于 $a_{1} = (1,\\,1,\\,0)$ 和 $a_{2} = (0,\\,1,\\,1)$ 是线性无关的（不存在标量 $\\alpha$ 满足 $(1,\\,1,\\,0) = \\alpha(0,\\,1,\\,1)$），子空间 $S$ 的维数为 $2$。因此 $S$ 是 $\\mathbb{R}^{3}$ 的一个真子空间。\n\n我们现在对 $\\{a_{1}, a_{2}\\}$ 应用经典 Gram–Schmidt 正交化过程，以生成一个张成 $S$ 的正交集 $\\{q_{1}, q_{2}\\}$。\n\n第 1 步：设 $q_{1} = a_{1} = (1,\\,1,\\,0)$。\n\n第 2 步：通过从 $a_{2}$ 中减去其在 $q_{1}$ 上的投影来计算 $q_{2}$。$a_{2}$ 在 $q_{1}$ 上的投影为\n$$\n\\operatorname{proj}_{q_{1}}(a_{2}) = \\frac{a_{2} \\cdot q_{1}}{q_{1} \\cdot q_{1}}\\, q_{1}.\n$$\n计算内积：\n$$\na_{2} \\cdot q_{1} = (0)(1) + (1)(1) + (1)(0) = 1, \\quad q_{1} \\cdot q_{1} = (1)^{2} + (1)^{2} + (0)^{2} = 2.\n$$\n因此，\n$$\n\\operatorname{proj}_{q_{1}}(a_{2}) = \\frac{1}{2} q_{1} = \\left(\\frac{1}{2},\\, \\frac{1}{2},\\, 0\\right),\n$$\n并且\n$$\nq_{2} = a_{2} - \\operatorname{proj}_{q_{1}}(a_{2}) = \\left(0,\\,1,\\,1\\right) - \\left(\\frac{1}{2},\\, \\frac{1}{2},\\, 0\\right) = \\left(-\\frac{1}{2},\\, \\frac{1}{2},\\, 1\\right).\n$$\n我们验证其正交性：\n$$\nq_{1} \\cdot q_{2} = (1)\\left(-\\frac{1}{2}\\right) + (1)\\left(\\frac{1}{2}\\right) + (0)(1) = -\\frac{1}{2} + \\frac{1}{2} + 0 = 0.\n$$\n因此，$\\{q_{1}, q_{2}\\}$ 是一个张成 $S$ 的正交集。\n\n接下来，我们刻画 $S$ 的正交补 $S^{\\perp}$。根据定义，一个向量 $v \\in \\mathbb{R}^{3}$ 属于 $S^{\\perp}$ 当且仅当 $v$ 与 $S$ 中的每个向量都正交。由于 $\\{q_{1}, q_{2}\\}$ 张成 $S$，这等价于\n$$\nv \\cdot q_{1} = 0 \\quad \\text{and} \\quad v \\cdot q_{2} = 0.\n$$\n记 $v = (x,\\,y,\\,z)$，这些条件构成线性方程组\n$$\nx + y + 0 z = 0, \\quad -\\frac{1}{2} x + \\frac{1}{2} y + 1 z = 0.\n$$\n从 $x + y = 0$ 我们得到 $y = -x$。代入第二个方程：\n$$\n-\\frac{1}{2} x + \\frac{1}{2}(-x) + z = 0 \\quad \\Rightarrow \\quad -x + z = 0 \\quad \\Rightarrow \\quad z = x.\n$$\n因此 $v = (x,\\,-x,\\,x) = x(1,\\,-1,\\,1)$。所以，\n$$\nS^{\\perp} = \\operatorname{span}\\{(1,\\,-1,\\,1)\\}.\n$$\n\n最后，我们计算 $b = (3,\\,0,\\,1)$ 在 $S^{\\perp}$ 上的正交投影的欧几里得范数的平方。$b$ 在由 $n = (1,\\,-1,\\,1)$ 张成的一维子空间上的正交投影具有形式 $\\alpha n$，其中 $\\alpha$ 的选择使得 $b - \\alpha n$ 与 $n$ 正交。条件 $(b - \\alpha n) \\cdot n = 0$ 得出\n$$\nb \\cdot n - \\alpha (n \\cdot n) = 0 \\quad \\Rightarrow \\quad \\alpha = \\frac{b \\cdot n}{n \\cdot n}.\n$$\n计算\n$$\nb \\cdot n = (3)(1) + (0)(-1) + (1)(1) = 4, \\quad n \\cdot n = (1)^{2} + (-1)^{2} + (1)^{2} = 3.\n$$\n因此投影为 $\\alpha n$，其中 $\\alpha = \\frac{4}{3}$，其欧几里得范数的平方为\n$$\n\\|\\alpha n\\|^{2} = \\alpha^{2} \\|n\\|^{2} = \\left(\\frac{4}{3}\\right)^{2} \\cdot 3 = \\frac{16}{9} \\cdot 3 = \\frac{16}{3}.\n$$\n因此，$b$ 在 $S^{\\perp}$ 上的正交投影的范数的平方是 $\\frac{16}{3}$。",
            "answer": "$$\\boxed{\\frac{16}{3}}$$"
        },
        {
            "introduction": "经典格拉姆-施密特（CGS）过程的一个重要特性是其“路径依赖性”，即产生的$ Q $和$ R $因子取决于输入矩阵列的顺序。这个练习通过一个简单的$ 2 \\times 2 $矩阵及其列置换后的版本，让你直接观察并量化这一现象。通过计算和几何解释，你将明白为什么改变列的顺序会导致不同的正交基，这对于理解CGS与其它更稳健的QR分解方法（如带有列主元的QR分解）之间的差异至关重要。",
            "id": "3537517",
            "problem": "设矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 的列向量为 $a_{1}$ 和 $a_{2}$，给定为\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n1  0\n\\end{pmatrix}\n\\;=\\; \\bigl[\\, a_{1} \\;\\; a_{2} \\,\\bigr], \\quad a_{1} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad a_{2} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n设 $P \\in \\mathbb{R}^{2 \\times 2}$ 是交换两列的置换矩阵，即\n$$\nP \\;=\\; \\begin{pmatrix}\n0  1 \\\\\n1  0\n\\end{pmatrix},\n\\quad \\text{因此} \\quad AP \\;=\\; \\bigl[\\, a_{2} \\;\\; a_{1} \\,\\bigr] \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n0  1\n\\end{pmatrix}.\n$$\n使用经典的 Gram–Schmidt (CGS) 过程，并以欧几里得内积为基础，计算正交三角 (QR) 分解\n$$\nA \\;=\\; Q_{A} R_{A}, \\qquad AP \\;=\\; Q_{AP} R_{AP},\n$$\n其中 $Q_{A}, Q_{AP} \\in \\mathbb{R}^{2 \\times 2}$ 具有标准正交列，$R_{A}, R_{AP} \\in \\mathbb{R}^{2 \\times 2}$ 是具有正对角元的上三角矩阵。通过从头开始执行 CGS 过程，明确地证明置换列会改变 $R$ 因子，即 $R_{A} \\neq R_{AP}$。然后，（在由列向量张成的平面内）给出一个几何解释，说明为什么在列置换下，正交因子 $Q$ 也会改变。\n\n最后，为了量化三角因子的变化，计算它们差的弗罗贝尼乌斯范数，\n$$\n\\bigl\\| R_{A} \\;-\\; R_{AP} \\bigr\\|_{F},\n$$\n并将此值以精确的封闭形式（无舍入）作为最终答案报告。",
            "solution": "我们按照经典 Gram-Schmidt (CGS) 过程，分别为矩阵 $A$ 和 $AP$ 计算 QR 分解。\n\n**$A = Q_A R_A$ 的 QR 分解**\n\n我们将 CGS 过程应用于 $A$ 的列 $a_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $a_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。设 $Q_A$ 的标准正交列为 $q_1$ 和 $q_2$。\n\n1.  **处理第一列 $a_1$：**\n    第一个正交向量是 $v_1 = a_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n    $R_A$ 的第一个对角元是 $r_{11} = \\|v_1\\|_2 = \\sqrt{1^2 + 1^2} = \\sqrt{2}$。\n    第一个标准正交向量是 $q_1 = \\frac{v_1}{r_{11}} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n2.  **处理第二列 $a_2$：**\n    $R_A$ 的非对角元为 $r_{12} = q_1^T a_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}$。\n    第二个正交向量是 $v_2 = a_2 - r_{12} q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix}$。\n    $R_A$ 的第二个对角元是 $r_{22} = \\|v_2\\|_2 = \\sqrt{(1/2)^2 + (-1/2)^2} = \\sqrt{1/2} = \\frac{1}{\\sqrt{2}}$。\n    第二个标准正交向量是 $q_2 = \\frac{v_2}{r_{22}} = \\sqrt{2}\\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n因此，分解的因子为：\n$$ Q_A = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad R_A = \\begin{pmatrix} \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\\\ 0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} $$\n\n**$AP = Q_{AP} R_{AP}$ 的 QR 分解**\n\n我们将 CGS 过程应用于 $AP$ 的列 $a'_1 = a_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $a'_2 = a_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。设 $Q_{AP}$ 的标准正交列为 $q'_1$ 和 $q'_2$。\n\n1.  **处理第一列 $a'_1$：**\n    第一个正交向量是 $v'_1 = a'_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n    $R_{AP}$ 的第一个对角元是 $r'_{11} = \\|v'_1\\|_2 = \\sqrt{1^2 + 0^2} = 1$。\n    第一个标准正交向量是 $q'_1 = \\frac{v'_1}{r'_{11}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n2.  **处理第二列 $a'_2$：**\n    $R_{AP}$ 的非对角元是 $r'_{12} = (q'_1)^T a'_2 = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1$。\n    第二个正交向量是 $v'_2 = a'_2 - r'_{12} q'_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n    $R_{AP}$ 的第二个对角元是 $r'_{22} = \\|v'_2\\|_2 = \\sqrt{0^2 + 1^2} = 1$。\n    第二个标准正交向量是 $q'_2 = \\frac{v'_2}{r'_{22}} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n因此，分解的因子为：\n$$ Q_{AP} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I, \\quad R_{AP} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} $$\n\n**比较、解释与计算**\n\n通过直接比较，我们看到 $R_A \\neq R_{AP}$ 和 $Q_A \\neq Q_{AP}$。\n几何上，$Q$ 因子改变是因为 Gram-Schmidt 过程的顺序性。$Q$ 矩阵的第一列 $q_1$ 被定义为与输入矩阵的第一列同向的单位向量。由于 $A$ 的第一列 $a_1=(1,1)^T$ 和 $AP$ 的第一列 $a_2=(1,0)^T$ 指向不同方向，它们各自生成的 $q_1$ 向量也不同，从而导致整个标准正交基不同。\n\n最后，我们计算三角因子之差的弗罗贝尼乌斯范数：\n$$\nD = R_A - R_{AP} = \\begin{pmatrix} \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\\\ 0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} - \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2} - 1  \\frac{1}{\\sqrt{2}} - 1 \\\\ 0  \\frac{1}{\\sqrt{2}} - 1 \\end{pmatrix}.\n$$\n其弗罗贝尼乌斯范数的平方为：\n$$\n\\|D\\|_F^2 = (\\sqrt{2} - 1)^2 + \\left(\\frac{1}{\\sqrt{2}} - 1\\right)^2 + 0^2 + \\left(\\frac{1}{\\sqrt{2}} - 1\\right)^2\n$$\n计算各项：\n$$\n(\\sqrt{2} - 1)^2 = 2 - 2\\sqrt{2} + 1 = 3 - 2\\sqrt{2}\n$$\n$$\n\\left(\\frac{1}{\\sqrt{2}} - 1\\right)^2 = \\frac{1}{2} - \\sqrt{2} + 1 = \\frac{3}{2} - \\sqrt{2}\n$$\n将各项平方加和：\n$$\n\\|D\\|_F^2 = (3 - 2\\sqrt{2}) + 2\\left(\\frac{3}{2} - \\sqrt{2}\\right) = 3 - 2\\sqrt{2} + 3 - 2\\sqrt{2} = 6 - 4\\sqrt{2}\n$$\n因此，弗罗贝尼乌斯范数为：\n$$\n\\| R_{A} - R_{AP} \\|_{F} = \\sqrt{6 - 4\\sqrt{2}} = \\sqrt{(2-\\sqrt{2})^2} = 2 - \\sqrt{2}.\n$$",
            "answer": "$$\n\\boxed{2 - \\sqrt{2}}\n$$"
        },
        {
            "introduction": "虽然经典格拉姆-施密特（CGS）在精确算术中表现完美，但在有限精度计算中却存在严重的数值不稳定性。这个高级练习将带你深入探究这一核心问题，通过在一个简化的三位数浮点模型下手动模拟CGS过程。你将处理一组近乎共线的向量，亲身体验并分析舍入误差是如何在投影和向量更新步骤中累积，最终导致正交性的灾难性损失，即使采用了看似合理的启发式策略也无济于事。",
            "id": "3537544",
            "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 是一个满列秩矩阵。在精确算术中，将经典格拉姆-施密特（CGS）过程应用于矩阵 $A$ 的列，会产生一个具有标准正交列的矩阵 $Q \\in \\mathbb{R}^{m \\times n}$ 和一个上三角矩阵 $R \\in \\mathbb{R}^{n \\times n}$，使得 $A = Q R$，因此 $Q^{\\top} Q = I$。然而，在浮点算术中，内积和投影中的舍入会引起正交性的损失，这种损失可以用弗罗贝尼乌斯范数 $\\|Q^{\\top} Q - I\\|_{F}$ 来量化。一种自然的列排序启发式方法是按照列的欧几里得范数的非增顺序（即最大 $2$-范数优先）来处理这些列。考虑以下有限精度模型和矩阵：\n- 算术模型：基数为10的浮点数，每次基本运算（乘法、加法、除法和平方根）后都四舍五入到 $3$ 位有效数字，平局时采用“四舍六入五成双”规则。内积通过按给定顺序对乘积进行朴素求和来计算，每次乘法和每次加法后都应用相同的舍入规则。归一化操作 $q = v / \\|v\\|$ 是通过一个舍入后的内积和平方根来计算范数 $\\|v\\|$，然后逐分量相除并进行舍入。\n- 矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 的列 $a_{1}$ 和 $a_{2}$ 如下：\n$$\na_{1} = \\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix}, \\qquad a_{2} = \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}.\n$$\n任务：\n1. 仅使用CGS的基本定义和所述的浮点模型，从第一性原理出发，解释列的排序如何影响投影步骤中舍入误差的累积，并从而影响 $\\|Q^{\\top} Q - I\\|_{F}$。\n2. 在所述的算术模型下执行两次CGS：\n   - 首先使用最大范数优先（LNF）排序 $(a_{2}, a_{1})$。\n   - 然后使用最小范数优先（SNF）排序 $(a_{1}, a_{2})$。\n   在每次运行中，计算由CGS产生的舍入后的 $Q$，然后使用计算出的 $Q$ 在实数算术中评估 $Q^{\\top} Q - I$ 的精确弗罗贝尼乌斯范数。\n3. 设 $E_{\\mathrm{LNF}} = \\|Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} - I\\|_{F}$ 和 $E_{\\mathrm{SNF}} = \\|Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} - I\\|_{F}$。报告其比率\n$$\nR \\;=\\; \\frac{E_{\\mathrm{LNF}}}{E_{\\mathrm{SNF}}}.\n$$\n将 $R$ 的最终值舍入到四位有效数字。最终答案必须是 $R$ 的单个舍入值。",
            "solution": "### 1. 列排序对舍入误差的影响\n\n经典格拉姆-施密特（CGS）过程的核心是在每一步减去向量在一个子空间上的投影：$v_k = a_k - \\sum_{j=1}^{k-1} \\langle q_j, a_k \\rangle q_j$。在浮点运算中，当向量 $a_k$ 与先前向量张成的子空间近似共线时，其投影会非常接近 $a_k$ 本身。此时，这个减法会成为两个几乎相等的大数之差，导致“灾难性抵消”，使得计算出的 $v_k$ 的有效数字严重损失。\n\n正交性的损失程度 $|\\hat{q}_k^{\\top} \\hat{q}_j|$（其中 $\\hat{q}$ 是计算出的向量）与比率 $\\|a_k\\|_2 / \\|v_k\\|_2$ 成正比。$\\|v_k\\|_2$ 是 $a_k$ 与子空间“正交”分量的大小。如果 $a_k$ 与子空间夹角很小，则 $\\|v_k\\|_2$ 会很小，导致正交性损失被放大。\n\n列的排序决定了处理向量的顺序，从而改变了每一步中子空间的构成和向量 $a_k$。不同的排序会导致不同的 $\\|v_k\\|_2$ 值，进而影响舍入误差的累积和最终正交性的好坏。理想的排序会尽量在每一步最大化 $\\|v_k\\|_2$，以减轻灾难性抵消的影响。\n\n### 2. 浮点算术中的CGS计算\n\n我们使用指定的3位浮点模型（基数10，四舍六入五成双）对两种排序进行计算。设 $\\mathrm{fl}(\\cdot)$ 表示此模型下的浮点运算。\n\n#### 最大范数优先（LNF）排序：$(a_{2}, a_{1})$\n\n令 $a'_1 = a_2 = \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}$ 和 $a'_2 = a_1 = \\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix}$。\n\n*   **步骤1：处理 $a'_1$**\n    $\\mathrm{fl}(\\langle a'_1, a'_1 \\rangle) = \\mathrm{fl}(\\mathrm{fl}(1.00^2) + \\mathrm{fl}(1.01^2)) = \\mathrm{fl}(1.00 + 1.02) = 2.02$。\n    $\\|a'_1\\|_2 = \\mathrm{fl}(\\sqrt{2.02}) = 1.42$。\n    $q_1 = (\\mathrm{fl}(1.00 / 1.42), \\mathrm{fl}(1.01 / 1.42))^T = (0.704, 0.711)^T$。\n\n*   **步骤2：处理 $a'_2$**\n    $r_{12} = \\mathrm{fl}(\\langle q_1, a'_2 \\rangle) = \\mathrm{fl}(\\mathrm{fl}(0.704 \\times 1.00) + \\mathrm{fl}(0.711 \\times 1.00)) = \\mathrm{fl}(0.704 + 0.711) = \\mathrm{fl}(1.415) = 1.42$ (舍入到偶数)。\n    投影向量：$(\\mathrm{fl}(1.42 \\times 0.704), \\mathrm{fl}(1.42 \\times 0.711))^T = (1.00, 1.01)^T$。\n    $v_2 = \\mathrm{fl}(a'_2 - (1.00, 1.01)^T) = (\\mathrm{fl}(1.00 - 1.00), \\mathrm{fl}(1.00 - 1.01))^T = (0.00, -0.0100)^T$。\n    $\\|v_2\\|_2 = \\mathrm{fl}(\\sqrt{\\mathrm{fl}(0^2 + (-0.01)^2)}) = \\mathrm{fl}(\\sqrt{1.00 \\times 10^{-4}}) = 0.0100$。\n    $q_2 = (\\mathrm{fl}(0.00 / 0.0100), \\mathrm{fl}(-0.0100 / 0.0100))^T = (0.00, -1.00)^T$。\n\n因此，$Q_{\\mathrm{LNF}} = \\begin{pmatrix} 0.704  0.00 \\\\ 0.711  -1.00 \\end{pmatrix}$。\n\n#### 最小范数优先（SNF）排序：$(a_{1}, a_{2})$\n\n令 $a'_1 = a_1 = \\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix}$ 和 $a'_2 = a_2 = \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}$。\n\n*   **步骤1：处理 $a'_1$**\n    $\\mathrm{fl}(\\langle a'_1, a'_1 \\rangle) = \\mathrm{fl}(1.00^2 + 1.00^2) = 2.00$。\n    $\\|a'_1\\|_2 = \\mathrm{fl}(\\sqrt{2.00}) = 1.41$。\n    $q_1 = (\\mathrm{fl}(1.00 / 1.41), \\mathrm{fl}(1.00 / 1.41))^T = (0.709, 0.709)^T$。\n\n*   **步骤2：处理 $a'_2$**\n    $r_{12} = \\mathrm{fl}(\\langle q_1, a'_2 \\rangle) = \\mathrm{fl}(\\mathrm{fl}(0.709 \\times 1.00) + \\mathrm{fl}(0.709 \\times 1.01)) = \\mathrm{fl}(0.709 + 0.716) = \\mathrm{fl}(1.425) = 1.42$ (舍入到偶数)。\n    投影向量：$(\\mathrm{fl}(1.42 \\times 0.709), \\mathrm{fl}(1.42 \\times 0.709))^T = (1.01, 1.01)^T$。\n    $v_2 = \\mathrm{fl}(a'_2 - (1.01, 1.01)^T) = (\\mathrm{fl}(1.00 - 1.01), \\mathrm{fl}(1.01 - 1.01))^T = (-0.0100, 0.00)^T$。\n    $\\|v_2\\|_2 = 0.0100$ (计算同上)。\n    $q_2 = (\\mathrm{fl}(-0.0100 / 0.0100), \\mathrm{fl}(0.00 / 0.0100))^T = (-1.00, 0.00)^T$。\n\n因此，$Q_{\\mathrm{SNF}} = \\begin{pmatrix} 0.709  -1.00 \\\\ 0.709  0.00 \\end{pmatrix}$。\n\n### 3. 误差计算和比率\n\n我们使用精确算术计算 $\\|Q^{\\top} Q - I\\|_{F}$。\n\n*   **LNF的误差：**\n    $Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} - I = \\begin{pmatrix} 0.704^2 + 0.711^2 - 1  -0.711 \\\\ -0.711  (-1.00)^2 - 1 \\end{pmatrix} = \\begin{pmatrix} 0.001137  -0.711 \\\\ -0.711  0 \\end{pmatrix}$。\n    $E_{\\mathrm{LNF}} = \\|Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} - I\\|_{F} = \\sqrt{0.001137^2 + (-0.711)^2 + (-0.711)^2} \\approx 1.005506$。\n\n*   **SNF的误差：**\n    $Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} - I = \\begin{pmatrix} 2 \\times 0.709^2 - 1  -0.709 \\\\ -0.709  (-1.00)^2 - 1 \\end{pmatrix} = \\begin{pmatrix} 0.005362  -0.709 \\\\ -0.709  0 \\end{pmatrix}$。\n    $E_{\\mathrm{SNF}} = \\|Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} - I\\|_{F} = \\sqrt{0.005362^2 + (-0.709)^2 + (-0.709)^2} \\approx 1.002692$。\n\n*   **比率：**\n    $R = \\frac{E_{\\mathrm{LNF}}}{E_{\\mathrm{SNF}}} = \\frac{1.005506...}{1.002692...} \\approx 1.002807...$。\n    舍入到四位有效数字，我们得到 $1.003$。",
            "answer": "$$\n\\boxed{1.003}\n$$"
        }
    ]
}