{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握一个算法，最好的方法之一就是亲手计算一个具体例子。这个练习将引导你对一个精心挑选的 $3 \\times 3$ 矩阵执行列主元 QR (CPQR) 分解。通过逐步执行贪心选择策略并进行正交化，你将能够推导出 $R$ 矩阵对角线元素的精确表达式，并亲自验证其大小非增的关键性质 $|r_{11}| \\ge |r_{22}| \\ge |r_{33}|$。这个过程将加深你对 CPQR 算法内部工作机制的理解。",
            "id": "3571796",
            "problem": "考虑矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 定义为\n$$\nA=\\begin{bmatrix}\n1 & \\epsilon & 0 \\\\\n0 & 1 & \\epsilon \\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\n其中 $0 < \\epsilon \\ll 1$。矩阵 $A$ 的列主元 QR (CPQR) 分解是一种形如 $A \\Pi = Q R$ 的分解，其中 $\\Pi$ 是一个置换矩阵，$Q$ 是正交矩阵，$R$ 是上三角矩阵。该分解通过贪心策略根据当前最大的列 $2$-范数来选择主元列（若范数相同则选择最小的列索引），并将后续列与所选的 Householder 反射变换进行正交化，或者等价地，在 Gram–Schmidt 观点下与当前的标准正交向量进行正交化。\n\n从作为列主元 QR 分解基础的 $2$-范数和正交投影的基本定义出发，确定主元顺序，并推导出 $A$ 的 CPQR 分解中 $R$ 的对角线元素大小的精确表达式（作为 $\\epsilon$ 的函数）。你的推导应通过从第一性原理出发的显式计算，验证对角线元素大小的非递增性质 $|r_{11}| \\ge |r_{22}| \\ge |r_{33}|$。\n\n答案规格：请提供单个行向量 $(|r_{11}|, |r_{22}|, |r_{33}|)$ 作为最终答案，其形式为关于 $\\epsilon$ 的封闭形式。不允许进行任何数值四舍五入。不要包含任何单位。",
            "solution": "我们将逐步执行列主元 QR 分解算法来确定主元顺序和 $R$ 的对角线元素。\n\n**第 1 步：选择第一个主元**\n\n首先，我们计算矩阵 $A$ 的三列 $a_1, a_2, a_3$ 的欧几里得范数（$2$-范数）：\n$a_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$, $a_2 = \\begin{pmatrix} \\epsilon \\\\ 1 \\\\ 0 \\end{pmatrix}$, $a_3 = \\begin{pmatrix} 0 \\\\ \\epsilon \\\\ 1 \\end{pmatrix}$。\n$\\|a_1\\|_2^2 = 1^2 + 0^2 + 0^2 = 1$\n$\\|a_2\\|_2^2 = \\epsilon^2 + 1^2 + 0^2 = 1 + \\epsilon^2$\n$\\|a_3\\|_2^2 = 0^2 + \\epsilon^2 + 1^2 = 1 + \\epsilon^2$\n\n由于 $\\|a_2\\|_2 = \\|a_3\\|_2 > \\|a_1\\|_2$，我们从第 2 列和第 3 列中选择一个作为主元。根据规则，当范数相同时，选择索引最小的列，因此我们选择第 2 列 ($a_2$) 作为第一个主元。\n置换矩阵 $\\Pi$ 将把第 2 列换到第 1 列的位置。$R$ 的第一个对角线元素的大小是第一个主元的范数：\n$|r_{11}| = \\|a_2\\|_2 = \\sqrt{1 + \\epsilon^2}$。\n\n**第 2 步：选择第二个主元**\n\n接下来，我们需要在剩余的列（$a_1$ 和 $a_3$）中选择下一个主元。选择的依据是它们与已选主元方向正交的分量的范数。我们计算 $a_1$ 和 $a_3$ 在与 $a_2$ 正交的空间上的投影。设 $q_1 = a_2 / \\|a_2\\|_2$。\n我们需要比较 $\\|a_1 - (q_1^T a_1) q_1\\|_2$ 和 $\\|a_3 - (q_1^T a_3) q_1\\|_2$。\n计算 $a_1$ 的正交分量范数：\n$q_1^T a_1 = \\frac{a_2^T a_1}{\\|a_2\\|_2} = \\frac{\\epsilon}{\\sqrt{1+\\epsilon^2}}$。\n更新后的列 $a_1'$ 的范数平方为：\n$\\|a_1'\\|_2^2 = \\|a_1\\|_2^2 - (q_1^T a_1)^2 = 1 - \\left(\\frac{\\epsilon}{\\sqrt{1+\\epsilon^2}}\\right)^2 = 1 - \\frac{\\epsilon^2}{1+\\epsilon^2} = \\frac{1}{1+\\epsilon^2}$。\n计算 $a_3$ 的正交分量范数：\n$q_1^T a_3 = \\frac{a_2^T a_3}{\\|a_2\\|_2} = \\frac{\\epsilon}{\\sqrt{1+\\epsilon^2}}$。\n更新后的列 $a_3'$ 的范数平方为：\n$\\|a_3'\\|_2^2 = \\|a_3\\|_2^2 - (q_1^T a_3)^2 = (1+\\epsilon^2) - \\left(\\frac{\\epsilon}{\\sqrt{1+\\epsilon^2}}\\right)^2 = 1+\\epsilon^2 - \\frac{\\epsilon^2}{1+\\epsilon^2} = \\frac{(1+\\epsilon^2)^2 - \\epsilon^2}{1+\\epsilon^2} = \\frac{1+2\\epsilon^2+\\epsilon^4-\\epsilon^2}{1+\\epsilon^2} = \\frac{1+\\epsilon^2+\\epsilon^4}{1+\\epsilon^2}$。\n\n比较这两个范数：由于 $1+\\epsilon^2+\\epsilon^4 > 1$，我们有 $\\|a_3'\\|_2^2 > \\|a_1'\\|_2^2$。因此，我们选择 $a_3$ 作为第二个主元。\n最终的主元顺序（列置换）是 $(2, 3, 1)$。\n$R$ 的第二个对角线元素的大小是第二个主元的更新范数：\n$|r_{22}| = \\|a_3'\\|_2 = \\sqrt{\\frac{1+\\epsilon^2+\\epsilon^4}{1+\\epsilon^2}}$。\n\n**第 3 步：确定第三个对角线元素**\n\n$R$ 的第三个对角线元素 $|r_{33}|$ 是剩余列（即 $a_1$）在与前两个主元（$a_2, a_3$）张成的空间正交后的范数。\n我们可以利用行列式的性质来简化计算：$|\\det(A)| = |\\det(A\\Pi)| = |\\det(QR)| = |\\det(Q)||\\det(R)| = |\\det(R)|$。\n由于 $R$ 是上三角矩阵，其行列式是其对角线元素的乘积：$|\\det(R)| = |r_{11} r_{22} r_{33}| = |r_{11}| |r_{22}| |r_{33}|$。\n矩阵 $A$ 的行列式是：$\\det(A) = 1 \\cdot (1 \\cdot 1 - \\epsilon \\cdot 0) - \\epsilon \\cdot (0 \\cdot 1 - \\epsilon \\cdot 0) + 0 = 1$。\n因此，我们有 $1 = |r_{11}| |r_{22}| |r_{33}|$。\n$|r_{33}| = \\frac{1}{|r_{11}| |r_{22}|} = \\frac{1}{\\sqrt{1+\\epsilon^2} \\cdot \\sqrt{\\frac{1+\\epsilon^2+\\epsilon^4}{1+\\epsilon^2}}} = \\frac{1}{\\sqrt{1+\\epsilon^2+\\epsilon^4}}$。\n\n**总结与验证**\n\n$R$ 的对角线元素的大小为：\n$|r_{11}| = \\sqrt{1+\\epsilon^2}$\n$|r_{22}| = \\sqrt{\\frac{1+\\epsilon^2+\\epsilon^4}{1+\\epsilon^2}}$\n$|r_{33}| = \\frac{1}{\\sqrt{1+\\epsilon^2+\\epsilon^4}}$\n\n最后，我们验证非递增性质 $|r_{11}| \\ge |r_{22}| \\ge |r_{33}|$。由于 $\\epsilon > 0$，我们比较它们的平方：\n$|r_{11}|^2 = 1+\\epsilon^2$。\n$|r_{22}|^2 = \\frac{1+\\epsilon^2+\\epsilon^4}{1+\\epsilon^2} = 1 + \\frac{\\epsilon^4}{1+\\epsilon^2}$。由于 $1+\\epsilon^2 > 1$，$\\epsilon^2 > \\frac{\\epsilon^4}{1+\\epsilon^2}$，所以 $|r_{11}|^2 > |r_{22}|^2$。\n$|r_{33}|^2 = \\frac{1}{1+\\epsilon^2+\\epsilon^4}$。由于 $1+\\epsilon^2+\\epsilon^4 > 1$，我们有 $\\frac{1+\\epsilon^2+\\epsilon^4}{1+\\epsilon^2} > 1 > \\frac{1}{1+\\epsilon^2+\\epsilon^4}$，所以 $|r_{22}|^2 > |r_{33}|^2$。\n因此，非递增性质得到验证。\n\n最终答案以行向量形式给出：",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{1+\\epsilon^{2}}, & \\sqrt{\\frac{1+\\epsilon^{2}+\\epsilon^{4}}{1+\\epsilon^{2}}}, & \\frac{1}{\\sqrt{1+\\epsilon^{2}+\\epsilon^{4}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "标准的列主元 QR 算法为何采用看似复杂的“更新列范数”策略，而不是简单地按原始列范数排序？这个练习通过构建一个巧妙的反例来回答这一问题。你将看到，一种简化的、基于“纯范数”的主元选择方法会错误地选择两个几乎共线的向量，导致分解结果中出现一个病态的子矩阵 $R_{11}$。通过分析这个问题，你将理解标准 CPQR 算法采用的投影更新策略  如何能够避免这种陷阱，从而更可靠地揭示矩阵的真实秩结构。",
            "id": "3571791",
            "problem": "在揭示秩的QR（RRQR）分解的背景下，考虑以下带有列主元选择的正交三角分解（QR分解）设置。设反例矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 的列向量为\n$$\na_1 = M \\begin{pmatrix}1 \\\\ 0 \\\\ 0\\end{pmatrix}, \\quad\na_2 = M \\begin{pmatrix}\\cos(\\theta) \\\\ \\sin(\\theta) \\\\ 0\\end{pmatrix}, \\quad\na_3 = N \\begin{pmatrix}0 \\\\ 1 \\\\ 0\\end{pmatrix},\n$$\n其中参数 $M>0$，$N>0$ 以及 $\\theta \\in (0,\\pi/2)$ 满足严格不等式 $M \\sin(\\theta) < N < M$。对于主元选择规则，将“纯粹基于范数的主元选择”定义为仅根据其原始的 $2$-范数来选择列，而在正交化后不对其范数进行重新加权或降权。\n\n- 使用QR分解、奇异值和2-范数条件数的定义，证明纯粹基于范数的主元选择会选择 $a_1$ 和 $a_2$ 作为前两个主元，并推导与这两个主元相关的前导 $2 \\times 2$ 上三角块 $R_{11}$。\n- 从第一性原理出发——具体而言，即 $R_{11}$ 的奇异值等于由所选列构成的 $3 \\times 2$ 子矩阵的奇异值——计算 $\\kappa_2(R_{11})$ 的精确2-范数条件数，作为 $\\theta$ 的一个闭式函数。\n- 接着，在已选择一组主元 $\\mathcal{S}$ 后，将列 $a_j$ 的“增广得分”定义为 $s_j(\\mathcal{S}) = \\|P_{\\mathcal{S}^\\perp} a_j\\|_2$，其中 $P_{\\mathcal{S}^\\perp}$ 是到所选列张成空间的补空间上的正交投影算子。解释为什么在给定的不等式 $M \\sin(\\theta) < N < M$ 条件下，这种增广得分方法会在选择 $a_1$ 之后选择 $a_3$ 作为第二个主元，并解释为什么这样做可以避免一个病态的 $R_{11}$。\n\n将你的最终答案表示为在纯粹基于范数的主元选择下获得的 $\\kappa_2(R_{11})$ 的精确解析表达式，用 $\\theta$ 表示。不需要进行数值舍入。",
            "solution": "该问题要求我们分析两种不同的列主元选择策略，并计算其中一种策略导致的病态子矩阵的条件数。\n\n**第一部分：纯粹基于范数的主元选择与条件数计算**\n\n1.  **主元选择**：该策略根据列的原始 $2$-范数来选择主元。我们计算三个列向量的范数：\n    $\\|a_1\\|_2 = \\| M [1, 0, 0]^T \\|_2 = M$\n    $\\|a_2\\|_2 = \\| M [\\cos(\\theta), \\sin(\\theta), 0]^T \\|_2 = M \\sqrt{\\cos^2(\\theta) + \\sin^2(\\theta)} = M$\n    $\\|a_3\\|_2 = \\| N [0, 1, 0]^T \\|_2 = N$\n\n    根据问题给定的不等式 $M \\sin(\\theta) < N < M$，我们有 $M > N$。因此，范数大小关系为 $\\|a_1\\|_2 = \\|a_2\\|_2 = M > \\|a_3\\|_2 = N$。\n    纯粹基于范数的策略会选择范数最大的列。由于 $a_1$ 和 $a_2$ 范数相同且最大，它们将被选为前两个主元。通常按索引顺序打破平局，所以主元顺序为 $(a_1, a_2, a_3)$。\n\n2.  **条件数计算**：前导 $2 \\times 2$ 子矩阵 $R_{11}$ 是由选定的主元列 $A_p = [a_1, a_2]$ 进行 QR 分解得到的。$R_{11}$ 的奇异值与 $A_p$ 的奇异值相同。$A_p$ 的奇异值是 $A_p^T A_p$ 特征值的平方根。\n    我们计算 $A_p^T A_p$：\n    $a_1^T a_1 = M^2$\n    $a_2^T a_2 = M^2$\n    $a_1^T a_2 = (M[1,0,0]) \\cdot (M[\\cos(\\theta),\\sin(\\theta),0]^T) = M^2 \\cos(\\theta)$\n    $$\n    A_p^T A_p = \\begin{pmatrix} a_1^T a_1 & a_1^T a_2 \\\\ a_2^T a_1 & a_2^T a_2 \\end{pmatrix} = \\begin{pmatrix} M^2 & M^2 \\cos(\\theta) \\\\ M^2 \\cos(\\theta) & M^2 \\end{pmatrix} = M^2 \\begin{pmatrix} 1 & \\cos(\\theta) \\\\ \\cos(\\theta) & 1 \\end{pmatrix}\n    $$\n    该矩阵的特征值 $\\lambda$ 满足 $\\det(A_p^T A_p - \\lambda I) = 0$，即 $(M^2 - \\lambda)^2 - (M^2 \\cos(\\theta))^2 = 0$。解得 $\\lambda = M^2(1 \\pm \\cos(\\theta))$。\n    $R_{11}$ 的奇异值为这些特征值的平方根：\n    $\\sigma_{\\max}(R_{11}) = \\sqrt{M^2(1 + \\cos(\\theta))} = M\\sqrt{1 + \\cos(\\theta)}$\n    $\\sigma_{\\min}(R_{11}) = \\sqrt{M^2(1 - \\cos(\\theta))} = M\\sqrt{1 - \\cos(\\theta)}$\n\n    $R_{11}$ 的 $2$-范数条件数 $\\kappa_2(R_{11})$ 是最大奇异值与最小奇异值的比值：\n    $$\n    \\kappa_2(R_{11}) = \\frac{\\sigma_{\\max}(R_{11})}{\\sigma_{\\min}(R_{11})} = \\frac{M\\sqrt{1 + \\cos(\\theta)}}{M\\sqrt{1 - \\cos(\\theta)}} = \\sqrt{\\frac{1 + \\cos(\\theta)}{1 - \\cos(\\theta)}}\n    $$\n    利用半角公式 $1+\\cos(\\theta) = 2\\cos^2(\\theta/2)$ 和 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n    $$\n    \\kappa_2(R_{11}) = \\sqrt{\\frac{2\\cos^2(\\theta/2)}{2\\sin^2(\\theta/2)}} = \\sqrt{\\cot^2(\\theta/2)} = |\\cot(\\theta/2)|\n    $$\n    因为 $\\theta \\in (0, \\pi/2)$，所以 $\\theta/2 \\in (0, \\pi/4)$，$\\cot(\\theta/2)$ 为正。因此 $\\kappa_2(R_{11}) = \\cot(\\theta/2)$。当 $\\theta$ 趋近于 $0$ 时，$a_1$ 和 $a_2$ 几乎共线，$\\cot(\\theta/2)$ 趋近于无穷大，表明 $R_{11}$ 是病态的。\n\n**第二部分：增广得分策略**\n\n标准 CPQR 算法使用增广得分来选择主元。\n1.  **第一个主元**：在第一步，增广得分就是列的范数。与前面一样，我们选择 $a_1$（或 $a_2$）作为第一个主元。我们选 $a_1$。此时已选主元集合 $\\mathcal{S}=\\{a_1\\}$。\n\n2.  **第二个主元**：我们计算剩余列 $a_2$ 和 $a_3$ 相对于已选主元空间的正交补空间的分量范数。\n    对于 $a_2$：得分是它与 $a_1$ 正交的分量的范数。\n    $s_2(\\{a_1\\}) = \\|a_2 - \\text{proj}_{a_1} a_2\\|_2 = \\|a_2 - \\frac{a_1^T a_2}{a_1^T a_1} a_1\\|_2$\n    $a_2 - \\frac{M^2 \\cos\\theta}{M^2} a_1 = M[\\cos\\theta, \\sin\\theta, 0]^T - \\cos\\theta (M[1,0,0]^T) = M[0, \\sin\\theta, 0]^T$\n    $s_2(\\{a_1\\}) = \\|M[0, \\sin\\theta, 0]^T\\|_2 = M\\sin\\theta$。\n\n    对于 $a_3$：得分是它与 $a_1$ 正交的分量的范数。\n    $s_3(\\{a_1\\}) = \\|a_3 - \\text{proj}_{a_1} a_3\\|_2$。\n    由于 $a_1^T a_3 = 0$，$a_3$ 本身就与 $a_1$ 正交，所以投影为零。\n    $s_3(\\{a_1\\}) = \\|a_3\\|_2 = N$。\n\n3.  **选择与影响**：现在我们比较这两个得分。根据问题给定的不等式 $M\\sin\\theta < N$，我们有 $s_2(\\{a_1\\}) < s_3(\\{a_1\\})$。因此，增广得分策略会选择 $a_3$作为第二个主元。主元顺序变为 $(a_1, a_3, a_2)$。\n\n    这个选择避免了病态。新的前导子矩阵 $R'_{11}$ 来自于对几乎正交（在本例中是完全正交）的列 $[a_1, a_3]$ 进行 QR 分解。由于 $a_1$ 和 $a_3$ 正交，得到的 $R'_{11}$ 是一个对角矩阵：\n    $$\n    R'_{11} = \\begin{pmatrix} \\|a_1\\|_2 & 0 \\\\ 0 & \\|a_3\\|_2 \\end{pmatrix} = \\begin{pmatrix} M & 0 \\\\ 0 & N \\end{pmatrix}\n    $$\n    其条件数为 $\\kappa_2(R'_{11}) = \\frac{\\max(M,N)}{\\min(M,N)} = \\frac{M}{N}$。根据 $N > M\\sin\\theta$，我们有 $\\frac{M}{N}  \\frac{1}{\\sin\\theta}$。对于小 $\\theta$，$\\cot(\\theta/2) \\approx 2/\\theta$，而 $M/N  1/\\sin\\theta \\approx 1/\\theta$。增广得分策略选择的基底更稳定，其条件数虽然也随 $\\theta \\to 0$ 增长，但增长速度较慢，且正确地识别出 $a_3$ 提供了比 $a_2$ 更多的新信息。\n\n最终答案是在纯粹基于范数的主元选择下获得的 $\\kappa_2(R_{11})$ 的表达式。",
            "answer": "$$\n\\boxed{\\cot\\left(\\frac{\\theta}{2}\\right)}\n$$"
        },
        {
            "introduction": "在数值线性代数中，不同的矩阵分解方法适用于不同的任务。虽然带部分主元的高斯消去（GEPP）是求解线性系统的主要工具，但它在估计矩阵的数值秩方面可能表现不佳。这个练习将探讨一个著名的例子，其中 GEPP 会产生指数级的主元增长，从而掩盖了矩阵的近秩亏特性。通过将 GEPP 的结果与秩揭示 QR (RRQR) 分解的结果进行对比 ，你将清楚地看到 RRQR 在识别和量化矩阵秩亏方面的优越性，这正是其在数据分析和科学计算中如此重要的原因。",
            "id": "3571775",
            "problem": "设 $n \\geq 3$ 且 $0  \\epsilon  1$ 为固定值。考虑如下构造的 $n \\times n$ 矩阵 $A$。定义前 $n-1$ 列，使其顶部的 $(n-1) \\times (n-1)$ 子块为单位下三角矩阵，其中当 $i  j$ 时 $A_{ij} = 0$，当 $1 \\leq j \\leq n-1$ 时 $A_{jj} = 1$，当 $j  i \\leq n-1$ 时 $A_{ij} = -1$。将这前 $n-1$ 列的最后一行设置为零：当 $1 \\leq j \\leq n-1$ 时 $A_{n,j} = 0$。设最后一列为 $c$，其中当 $1 \\leq i \\leq n-1$ 时 $c_i = 1$，且 $c_n = \\epsilon$。因此\n$$\nA = \\begin{bmatrix}\n1  0  0  \\cdots  0  1 \\\\\n-1  1  0  \\cdots  0  1 \\\\\n-1  -1  1  \\cdots  0  1 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n-1  -1  -1  \\cdots  1  1 \\\\\n0  0  0  \\cdots  0  \\epsilon\n\\end{bmatrix}.\n$$\n\n根据第一性原理：\n\n1. 使用部分主元高斯消去法 (GEPP) 的定义来确定主元增长因子，其定义为\n$$\n\\gamma(A) = \\dfrac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A_{ij}|},\n$$\n其中 $P A = L U$ 是通过部分主元法选择行置换 $P$ 得到的 LU 分解，$L$ 是单位下三角矩阵，$U$ 是上三角矩阵。\n\n2. 使用列主元 QR 分解 (CPQR) 和秩揭示 QR 分解 (RRQR) 的定义来论证，在保持前 $n-1$ 列不变并将最后一列 $c$ 置于末尾的列置换下，QR 分解 $A \\Pi = Q R$ 中三角因子 $R$ 的最后一个对角线元素等于 $c$ 正交于前 $n-1$ 列的列空间的分量的欧几里得范数。请明确求出此值。\n\n以闭合形式计算比率\n$$\n\\rho(n,\\epsilon) = \\frac{\\gamma(A)}{|R_{nn}|}.\n$$\n您的最终答案必须是关于 $n$ 和 $\\epsilon$ 的单个解析表达式。无需四舍五入。明确表示任何幂；此问题不涉及角度，也没有物理单位。",
            "solution": "我们将分步解决这个问题，首先计算 GEPP 的主元增长因子，然后计算 QR 分解的最后一个对角元，最后求出它们的比率。\n\n**第 1 部分：计算主元增长因子 $\\gamma(A)$**\n\n主元增长因子定义为 $\\gamma(A) = \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A_{ij}|}$。\n首先，矩阵 $A$ 的元素为 $0, 1, -1, \\epsilon$。由于 $0  \\epsilon  1$，矩阵元素的最大绝对值为 $\\max_{i,j} |A_{ij}| = 1$。\n\n接下来，我们对矩阵 $A$ 执行部分主元高斯消去法 (GEPP) 以找到上三角矩阵 $U$。\n在第 1 步消去时，第一列的主元候选元素的最大绝对值为 1。我们可以选择 $A_{11}=1$ 作为主元，无需行交换。对于行 $i=2, \\dots, n-1$，消去乘数为 $m_{i1} = A_{i1}/A_{11} = -1/1 = -1$。第 $n$ 行的乘数为 $m_{n1}=0$。\n行 $i$ ($2 \\le i \\le n-1$) 更新为 $R_i \\leftarrow R_i - m_{i1} R_1 = R_i + R_1$。\n我们特别关注最后一列的变化。更新后，对于 $i=2, \\dots, n-1$，有 $A_{i,n}^{(2)} = A_{i,n}^{(1)} + A_{1,n}^{(1)} = 1+1=2$。\n在第 2 步消去时，主元子矩阵的结构与原矩阵相似。主元 $A_{22}^{(2)}=1$，无需行交换。对于行 $i=3, \\dots, n-1$，乘数为 $m_{i2}=-1$。\n最后一列再次更新。对于 $i=3, \\dots, n-1$，有 $A_{i,n}^{(3)} = A_{i,n}^{(2)} + A_{2,n}^{(2)} = 2+2=4=2^2$。\n\n这个模式会持续下去。在第 $k$ 步消去后（对于 $k=1, \\dots, n-2$），最后一列的元素 $A_{i,n}$（对于 $i > k$）将变为 $2^k$。\n因此，在消去过程结束时，上三角矩阵 $U$ 的最后一列的元素为 $U_{i,n} = 2^{i-1}$，对于 $i=1, \\dots, n-1$。\n$A$ 的最后一行始终为零（除了最后一个元素），因此在消去过程中它不会被用作其他行的加数，并且由于所有主元都为1，乘数也为零，所以它自身也不会被改变。\n最终的 $U$ 矩阵为：\n$$\nU = \\begin{bmatrix}\n1  0  0  \\cdots  0  1 \\\\\n0  1  0  \\cdots  0  2 \\\\\n0  0  1  \\cdots  0  4 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  1  2^{n-2} \\\\\n0  0  0  \\cdots  0  \\epsilon\n\\end{bmatrix}\n$$\n$U$ 中绝对值最大的元素是 $U_{n-1, n} = 2^{n-2}$（因为 $n \\geq 3$）。\n因此，主元增长因子为 $\\gamma(A) = \\frac{2^{n-2}}{1} = 2^{n-2}$。\n\n**第 2 部分：计算 $|R_{nn}|$**\n\n问题指定列置换 $\\Pi=I$（即不进行列交换），因此我们计算 $A=QR$。\n根据 QR 分解的 Gram-Schmidt 解释，$R$ 的最后一个对角元素 $|R_{nn}|$ 是 $A$ 的最后一列 $c$ 与由前 $n-1$ 列 $a_1, \\dots, a_{n-1}$ 张成的子空间 $W$ 正交的分量的范数。\n即 $|R_{nn}| = \\| c - \\text{proj}_W c \\|_2$，其中 $\\text{proj}_W c$ 是 $c$ 在 $W$ 上的正交投影。\n$c - \\text{proj}_W c$ 必须与 $W$ 中的所有向量正交，特别是与基向量 $a_1, \\dots, a_{n-1}$ 正交。\n\n我们来确定这个投影。考虑向量 $y = [1, 1, \\dots, 1, 0]^T$。我们证明 $y = \\text{proj}_W c$。\n首先，我们需要证明 $y \\in W$。这意味着存在一个向量 $x \\in \\mathbb{R}^{n-1}$ 使得 $[a_1, \\dots, a_{n-1}]x = y$。\n展开这个方程组：\n$x_1 = 1$\n$-x_1 + x_2 = 1 \\implies x_2 = 2$\n$-x_1 - x_2 + x_3 = 1 \\implies x_3 = 4$\n...\n$x_k = 2^{k-1}$ for $k=1, \\dots, n-1$。\n由于可以找到这样一个 $x$，所以 $y \\in W$。\n\n其次，我们需要证明 $c-y$ 与 $W$ 正交。\n$c - y = [1, \\dots, 1, \\epsilon]^T - [1, \\dots, 1, 0]^T = [0, \\dots, 0, \\epsilon]^T$。\n这个向量只在最后一个分量上非零。而 $W$ 的所有基向量 $a_j$ ($j=1, \\dots, n-1$) 的最后一个分量 $A_{n,j}$ 均为零。\n因此，对于任意 $j \\in \\{1, \\dots, n-1\\}$，$(c-y)^T a_j = 0$。\n这证明了 $c-y$ 与 $W$ 正交。\n\n因此，$y$ 确实是 $c$ 在 $W$ 上的正交投影。正交分量为 $c - y$，其范数为：\n$|R_{nn}| = \\|c-y\\|_2 = \\|[0, \\dots, 0, \\epsilon]^T\\|_2 = \\sqrt{\\epsilon^2} = \\epsilon$ (因为 $\\epsilon>0$)。\n\n**第 3 部分：计算比率 $\\rho(n,\\epsilon)$**\n\n现在我们可以计算所要求的比率：\n$$\n\\rho(n,\\epsilon) = \\frac{\\gamma(A)}{|R_{nn}|} = \\frac{2^{n-2}}{\\epsilon}\n$$\n这个结果表明，当 $\\epsilon$ 很小时，矩阵 $A$ 接近奇异（因为 $|R_{nn}|$ 很小），但 GEPP 的主元增长因子很大，完全掩盖了这一事实。RRQR 则能通过小的对角元 $|R_{nn}|$ 有效地揭示秩亏。",
            "answer": "$$\\boxed{\\frac{2^{n-2}}{\\epsilon}}$$"
        }
    ]
}