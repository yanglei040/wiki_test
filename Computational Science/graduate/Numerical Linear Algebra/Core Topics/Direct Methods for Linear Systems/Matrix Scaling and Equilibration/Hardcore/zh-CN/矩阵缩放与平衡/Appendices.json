{
    "hands_on_practices": [
        {
            "introduction": "矩阵缩放的一个主要动机是改善求解线性方程组 $Ax=b$ 时的数值稳定性。范数反向误差是衡量一个近似解质量的关键指标，它量化了需要对原始问题进行多大程度的扰动才能使该近似解成为精确解。这个练习  将通过一个具体的计算，让你亲手验证一个简单的对角列缩放如何能够显著减小反向误差，从而让你对矩阵平衡的威力有一个直观的认识。",
            "id": "3559217",
            "problem": "考虑线性系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix}, \\qquad \\widehat{x} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n假设计算出的残差为\n$$\nr \\;=\\; b - A \\widehat{x} \\;=\\; \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix},\n$$\n因此 $b = A \\widehat{x} + r$。你需要评估对角缩放对范数反向误差的影响，使用诱导无穷范数。\n\n对于未缩放的系统，将范数反向误差（在无穷范数下）定义为最小标量 $\\eta \\ge 0$，使得存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足 $(A + \\Delta A)\\,\\widehat{x} = b + \\Delta b$，且 $\\|\\Delta A\\|_{\\infty} \\le \\eta \\,\\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} \\le \\eta \\,\\|b\\|_{\\infty}$。对于缩放后的系统，应用对角列缩放 $D_c = \\mathrm{diag}(10^{-3}, 10^{3})$，将系统重写为 $(A D_c) y = b$，其中 $y = D_c^{-1} \\widehat{x}$，并为对 $(A D_c, b)$ 类似地定义缩放后的范数反向误差。\n\n仅使用诱导矩阵范数和范数反向误差的基本定义，推导未缩放和缩放系统在无穷范数下的范数反向误差的标准界，并计算缩减因子\n$$\n\\rho \\;=\\; \\frac{\\eta_{\\mathrm{scaled}}}{\\eta_{\\mathrm{unscaled}}}.\n$$\n将你对 $\\rho$ 的最终答案四舍五入到 4 位有效数字。答案是无量纲的，应以实数形式给出。",
            "solution": "该问题要求评估对角列缩放对给定线性系统的范数反向误差的影响。分析将使用诱导无穷范数进行。我们必须首先推导范数反向误差的标准公式，然后将其应用于未缩放和缩放的系统以计算缩减因子。\n\n设给定系统 $A x = b$ 的近似解为 $\\widehat{x}$。残差为 $r = b - A\\widehat{x}$。范数反向误差 $\\eta$ 定义为最小的非负数，使得存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足\n$$\n(A + \\Delta A)\\,\\widehat{x} = b + \\Delta b\n$$\n且约束条件为 $\\|\\Delta A\\|_{\\infty} \\le \\eta \\,\\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} \\le \\eta \\,\\|b\\|_{\\infty}$。\n\n首先，我们推导 $\\eta$ 的通用公式。重排扰动后的系统方程，我们得到残差的表达式：\n$$\nr = b - A\\widehat{x} = \\Delta A \\widehat{x} - \\Delta b\n$$\n对两边取无穷范数并应用三角不等式，我们得到：\n$$\n\\|r\\|_{\\infty} = \\|\\Delta A \\widehat{x} - \\Delta b\\|_{\\infty} \\le \\|\\Delta A \\widehat{x}\\|_{\\infty} + \\|\\Delta b\\|_{\\infty}\n$$\n使用诱导矩阵范数的性质 $\\|\\Delta A \\widehat{x}\\|_{\\infty} \\le \\|\\Delta A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty}$，我们有：\n$$\n\\|r\\|_{\\infty} \\le \\|\\Delta A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|\\Delta b\\|_{\\infty}\n$$\n现在，我们代入对扰动的约束条件 $\\|\\Delta A\\|_{\\infty} \\le \\eta \\,\\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} \\le \\eta \\,\\|b\\|_{\\infty}$：\n$$\n\\|r\\|_{\\infty} \\le (\\eta \\,\\|A\\|_{\\infty}) \\|\\widehat{x}\\|_{\\infty} + (\\eta \\,\\|b\\|_{\\infty}) = \\eta \\left( \\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty} \\right)\n$$\n这个不等式为 $\\eta$ 提供了一个下界：\n$$\n\\eta \\ge \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}}\n$$\n这个下界是可以达到的。可以构造一个特定的扰动选择 $\\Delta A$ 和 $\\Delta b$ 来证明这个最小值可以达到。因此，范数反向误差精确地为：\n$$\n\\eta = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}}\n$$\n\n现在，我们将此公式应用于未缩放的系统。给定的量为：\n$$\nA = \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix}, \\quad \\widehat{x} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad r = \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix}\n$$\n根据这些，我们可以确定右侧向量 $b$：\n$$\nb = A\\widehat{x} + r = \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix} = \\begin{pmatrix} 1001 \\\\ 1.001 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix} = \\begin{pmatrix} 1002 \\\\ 1.002 \\end{pmatrix}\n$$\n我们计算所需的无穷范数。诱导矩阵无穷范数是最大绝对行和。\n$$\n\\|A\\|_{\\infty} = \\max(|1000| + |1|, |1| + |0.001|) = \\max(1001, 1.001) = 1001\n$$\n$$\n\\|\\widehat{x}\\|_{\\infty} = \\max(|1|, |1|) = 1\n$$\n$$\n\\|b\\|_{\\infty} = \\max(|1002|, |1.002|) = 1002\n$$\n$$\n\\|r\\|_{\\infty} = \\max(|1|, |0.001|) = 1\n$$\n未缩放系统的反向误差 $\\eta_{\\mathrm{unscaled}}$ 为：\n$$\n\\eta_{\\mathrm{unscaled}} = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}} = \\frac{1}{1001 \\cdot 1 + 1002} = \\frac{1}{2003}\n$$\n\n接下来，我们分析缩放后的系统。缩放由 $D_c = \\mathrm{diag}(10^{-3}, 10^{3})$ 定义。系统被重写为 $(A D_c) y = b$，其中新矩阵为 $A' = A D_c$，新未知数为 $y = D_c^{-1} x$。缩放后系统的近似解为 $\\widehat{y} = D_c^{-1} \\widehat{x}$。\n我们来计算缩放后系统的各组成部分：\n$$\nA' = A D_c = \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix} \\begin{pmatrix} 10^{-3}  0 \\\\ 0  10^{3} \\end{pmatrix} = \\begin{pmatrix} 1  1000 \\\\ 0.001  1 \\end{pmatrix}\n$$\n$$\n\\widehat{y} = D_c^{-1} \\widehat{x} = \\begin{pmatrix} 10^{3}  0 \\\\ 0  10^{-3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1000 \\\\ 0.001 \\end{pmatrix}\n$$\n缩放后系统的残差 $r' = b - A'\\widehat{y}$ 为：\n$$\nr' = b - (A D_c)(D_c^{-1} \\widehat{x}) = b - A\\widehat{x} = r = \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix}\n$$\n现在我们计算缩放后问题的范数：\n$$\n\\|A'\\|_{\\infty} = \\max(|1| + |1000|, |0.001| + |1|) = \\max(1001, 1.001) = 1001\n$$\n$$\n\\|\\widehat{y}\\|_{\\infty} = \\max(|1000|, |0.001|) = 1000\n$$\n$b$ 和 $r'$（即 $r$）的范数保持不变：$\\|b\\|_{\\infty} = 1002$ 和 $\\|r'\\|_{\\infty} = 1$。\n缩放后系统的反向误差 $\\eta_{\\mathrm{scaled}}$ 为：\n$$\n\\eta_{\\mathrm{scaled}} = \\frac{\\|r'\\|_{\\infty}}{\\|A'\\|_{\\infty} \\|\\widehat{y}\\|_{\\infty} + \\|b\\|_{\\infty}} = \\frac{1}{1001 \\cdot 1000 + 1002} = \\frac{1}{1001000 + 1002} = \\frac{1}{1002002}\n$$\n最后，我们计算缩减因子 $\\rho$，即缩放后的反向误差与未缩放的反向误差之比：\n$$\n\\rho = \\frac{\\eta_{\\mathrm{scaled}}}{\\eta_{\\mathrm{unscaled}}} = \\frac{1/1002002}{1/2003} = \\frac{2003}{1002002}\n$$\n为了得到最终的数值答案，我们计算这个值并将其四舍五入到 4 位有效数字：\n$$\n\\rho \\approx 0.001998994...\n$$\n四舍五入到 4 位有效数字得到 $0.001999$。",
            "answer": "$$\\boxed{0.001999}$$"
        },
        {
            "introduction": "对于高斯消去法等直接求解器，其数值稳定性与计算过程中出现的元素增长因子密切相关。然而，缩放并非总是带来益处；不当的缩放甚至可能恶化问题。这个练习  通过构建两个对比鲜明的例子，巧妙地展示了对角缩放既可能有效降低增长因子，也可能意外地增大它，从而强调了审慎选择缩放策略的重要性。",
            "id": "3559226",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$，并考虑带部分主元选择的高斯消去法，其中每一步的主元是当前活动子矩阵的当前列中绝对值最大的元素，若存在多个，则选择行索引最小的元素。将计算出的因子记为 $P A = L U$，其中 $P$ 是一个置换矩阵，$L$ 是单位下三角矩阵，$U$ 是上三角矩阵。定义无穷范数下的元素增长因子为\n$$\n\\gamma_{\\infty}(A) \\equiv \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A_{ij}|}.\n$$\n我们研究对角缩放（平衡）如何减少或增加 $\\gamma_{\\infty}(A)$，以及这种影响如何传播到标准的相对后向误差界。\n\n使用固定的符号模式矩阵\n$$\nS \\equiv \\begin{pmatrix}\n1  1  1 \\\\\n-1  1  1 \\\\\n-1  -1  1\n\\end{pmatrix}.\n$$\n构建两个显式的 $3 \\times 3$ 矩阵：\n- 一个减小例子，$A^{(R)} \\equiv S$ 及其列对角缩放 $D_{c}^{(\\downarrow)} \\equiv \\operatorname{diag}(1, \\tfrac{1}{2}, \\tfrac{1}{4})$。\n- 一个增大例子，$A^{(I)} \\equiv S \\operatorname{diag}(1, \\tfrac{1}{2}, \\tfrac{1}{4})$ 及其列对角缩放 $D_{c}^{(\\uparrow)} \\equiv \\operatorname{diag}(1, 2, 4)$。\n\n对每个例子，执行以下操作：\n1. 对未缩放的矩阵和列缩放后的矩阵，计算（如上所述的）带部分主元选择的 $L U$ 分解，并从这些分解中计算出相应的增长因子 $\\gamma_{\\infty}$。\n2. 从浮点运算的标准舍入模型以及带部分主元选择的高斯消去法的经典后向稳定性框架出发，推导出一个形式如下的相对后向误差界\n$$\n\\frac{\\|\\Delta A\\|_{\\infty}}{\\|A\\|_{\\infty}} \\leq c \\, u \\, p(n) \\, \\gamma_{\\infty}(A),\n$$\n其中 $u$ 是单位舍入误差，$c$ 是一个与 $A$ 和 $n$ 无关的适中常数，$p(n)$ 是一个不依赖于 $A$ 的关于 $n$ 的多项式。解释为什么在固定的 $n$ 和相同的消去算法下，比较缩放前后时，相对后向误差界之比等于相应增长因子之比。\n\n设 $\\rho_{R}$ 表示减小例子 $A^{(R)}$ 与 $D_{c}^{(\\downarrow)}$ 的“缩放后界除以缩放前界”之比，并设 $\\rho_{I}$ 表示增大例子 $A^{(I)}$ 与 $D_{c}^{(\\uparrow)}$ 的类似比率。\n\n将数对 $\\big(\\rho_{R}, \\rho_{I}\\big)$ 以单个行向量的形式报告。以精确形式给出最终答案。无需四舍五入，也不涉及物理单位。",
            "solution": "我们通过分析每个例子，然后推导误差界的理由，最后计算所需的比率来继续。\n\n**1. 减小例子：$A^{(R)}$ 和 $A^{(R)} D_{c}^{(\\downarrow)}$**\n\n**a) 未缩放的矩阵：$A^{(R)} = S = \\begin{pmatrix} 1  1  1 \\\\ -1  1  1 \\\\ -1  -1  1 \\end{pmatrix}$**\n\n绝对值最大的元素是 $\\max_{i,j} |A^{(R)}_{ij}| = 1$。\n\n我们执行 GEPP。\n*   **第1步：**第一列是 $(1, -1, -1)^T$。最大绝对值为 $1$，三个元素都达到此值。平局打破规则选择行索引最小的元素，所以主元是 $A_{11}^{(R)} = 1$。不需要行交换，因此 $P_1 = I$。乘子是 $l_{21} = \\frac{-1}{1} = -1$ 和 $l_{31} = \\frac{-1}{1} = -1$。\n    矩阵变为：\n    $$\n    A' = \\begin{pmatrix} 1  1  1 \\\\ -1 - (-1)\\cdot1  1 - (-1)\\cdot1  1 - (-1)\\cdot1 \\\\ -1 - (-1)\\cdot1  -1 - (-1)\\cdot1  1 - (-1)\\cdot1 \\end{pmatrix} = \\begin{pmatrix} 1  1  1 \\\\ 0  2  2 \\\\ 0  0  2 \\end{pmatrix}\n    $$\n*   **第2步：**矩阵已经是上三角矩阵。过程终止。\n\n分解为 $P A^{(R)} = L U$，其中 $P = I$，\n$$\nL = \\begin{pmatrix} 1  0  0 \\\\ -1  1  0 \\\\ -1  0  1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1  1  1 \\\\ 0  2  2 \\\\ 0  0  2 \\end{pmatrix}\n$$\n$U$ 中绝对值最大的元素是 $\\max_{i,j} |U_{ij}| = 2$。\n$A^{(R)}$ 的增长因子是：\n$$\n\\gamma_{\\infty}(A^{(R)}) = \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A^{(R)}_{ij}|} = \\frac{2}{1} = 2\n$$\n\n**b) 缩放后的矩阵：$A_{s}^{(R)} = A^{(R)} D_{c}^{(\\downarrow)} = \\begin{pmatrix} 1  1  1 \\\\ -1  1  1 \\\\ -1  -1  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2}  \\frac{1}{4} \\\\ -1  \\frac{1}{2}  \\frac{1}{4} \\\\ -1  -\\frac{1}{2}  \\frac{1}{4} \\end{pmatrix}$**\n\n绝对值最大的元素是 $\\max_{i,j} |A_{s,ij}^{(R)}| = 1$。\n\n我们执行 GEPP。\n*   **第1步：**第一列是 $(1, -1, -1)^T$。和之前一样，主元是 $(1,1)$ 元素。不需要交换。乘子是 $l_{21} = -1$ 和 $l_{31} = -1$。\n    矩阵变为：\n    $$\n    A'_{s} = \\begin{pmatrix} 1  \\frac{1}{2}  \\frac{1}{4} \\\\ -1 - (-1)\\cdot1  \\frac{1}{2} - (-1)\\cdot\\frac{1}{2}  \\frac{1}{4} - (-1)\\cdot\\frac{1}{4} \\\\ -1 - (-1)\\cdot1  -\\frac{1}{2} - (-1)\\cdot\\frac{1}{2}  \\frac{1}{4} - (-1)\\cdot\\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2}  \\frac{1}{4} \\\\ 0  1  \\frac{1}{2} \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}\n    $$\n*   **第2步：**矩阵已经是上三角矩阵。\n\n分解为 $P A_{s}^{(R)} = L_s U_s$，其中 $P = I$，\n$$\nL_s = \\begin{pmatrix} 1  0  0 \\\\ -1  1  0 \\\\ -1  0  1 \\end{pmatrix}, \\quad U_s = \\begin{pmatrix} 1  \\frac{1}{2}  \\frac{1}{4} \\\\ 0  1  \\frac{1}{2} \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}\n$$\n$U_s$ 中绝对值最大的元素是 $\\max_{i,j} |U_{s,ij}| = 1$。\n$A_{s}^{(R)}$ 的增长因子是：\n$$\n\\gamma_{\\infty}(A_{s}^{(R)}) = \\frac{\\max_{i,j} |U_{s,ij}|}{\\max_{i,j} |A_{s,ij}^{(R)}|} = \\frac{1}{1} = 1\n$$\n在这种情况下，列缩放将增长因子从 $2$ 减小到 $1$。\n\n**2. 增大例子：$A^{(I)}$ 和 $A^{(I)} D_{c}^{(\\uparrow)}$**\n\n**a) 未缩放的矩阵：$A^{(I)} = S \\operatorname{diag}(1, \\tfrac{1}{2}, \\tfrac{1}{4}) = \\begin{pmatrix} 1  \\frac{1}{2}  \\frac{1}{4} \\\\ -1  \\frac{1}{2}  \\frac{1}{4} \\\\ -1  -\\frac{1}{2}  \\frac{1}{4} \\end{pmatrix}$**\n\n这与减小例子中的矩阵 $A_{s}^{(R)}$ 相同。因此，我们可以直接从前面的计算中陈述其性质。\n$$\n\\gamma_{\\infty}(A^{(I)}) = 1\n$$\n\n**b) 缩放后的矩阵：$A_{s}^{(I)} = A^{(I)} D_{c}^{(\\uparrow)} = \\left(S \\operatorname{diag}(1, \\tfrac{1}{2}, \\tfrac{1}{4})\\right) \\operatorname{diag}(1, 2, 4)$**\n\n利用矩阵乘法的结合律以及对角矩阵相乘时可交换的事实，我们有：\n$$\nA_{s}^{(I)} = S \\left(\\operatorname{diag}(1, \\tfrac{1}{2}, \\tfrac{1}{4}) \\operatorname{diag}(1, 2, 4)\\right) = S \\operatorname{diag}(1\\cdot1, \\tfrac{1}{2}\\cdot2, \\tfrac{1}{4}\\cdot4) = S \\operatorname{diag}(1, 1, 1) = S I = S\n$$\n所以，$A_{s}^{(I)} = \\begin{pmatrix} 1  1  1 \\\\ -1  1  1 \\\\ -1  -1  1 \\end{pmatrix}$。这与未缩放的 $A^{(R)}$ 矩阵相同。因此，我们可以直接陈述其性质。\n$$\n\\gamma_{\\infty}(A_{s}^{(I)}) = 2\n$$\n在这种情况下，列缩放将增长因子从 $1$ 增加到 $2$。\n\n**3. 后向误差界和比率的证明**\n\n带部分主元选择的高斯消去法的标准后向误差分析表明，线性系统 $Ax=b$ 的计算解 $\\hat{x}$ 是一个扰动系统 $(A + \\Delta A)\\hat{x} = b$ 的精确解。后向误差矩阵 $\\Delta A$ 是有界的。其无穷范数的一个常见界的形式是：\n$$\n\\|\\Delta A\\|_{\\infty} \\le f(n) u \\max_{i,j,k} |a_{ij}^{(k)}| + O(u^2)\n$$\n其中 $u$ 是单位舍入误差，$f(n)$ 是矩阵维度 $n$ 的一个低次多项式，而 $a_{ij}^{(k)}$ 是在消去过程中生成的矩阵的元素。项 $\\max_{i,j,k} |a_{ij}^{(k)}|$ 表示在消去过程的任何阶段出现的量级最大的元素。假设最大元素出现在最终因子 $U$ 中，则它受 $\\max_{i,j} |U_{ij}|$ 的限制。\n\n我们使用问题中对增长因子的定义：$\\gamma_{\\infty}(A) = \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A_{ij}|}$。我们可以写成 $\\max_{i,j} |U_{ij}| = \\gamma_{\\infty}(A) \\max_{i,j} |A_{ij}|$。忽略 $O(u^2)$ 项，误差界变为：\n$$\n\\|\\Delta A\\|_{\\infty} \\lesssim f(n) u \\, \\gamma_{\\infty}(A) \\max_{i,j} |A_{ij}|\n$$\n为了得到相对后向误差界，我们除以 $\\|A\\|_{\\infty}$：\n$$\n\\frac{\\|\\Delta A\\|_{\\infty}}{\\|A\\|_{\\infty}} \\lesssim f(n) u \\, \\gamma_{\\infty}(A) \\frac{\\max_{i,j} |A_{ij}|}{\\|A\\|_{\\infty}}\n$$\n问题陈述给出的误差界形式为 $c \\, u \\, p(n) \\, \\gamma_{\\infty}(A)$，其中 $c$ 是一个常数，$p(n)$ 只依赖于 $n$。这种形式意味着依赖于矩阵的项 $\\frac{\\max_{i,j} |A_{ij}|}{\\|A\\|_{\\infty}}$ 被视为已并入常数中，这是评估 $\\gamma_{\\infty}(A)$ 作用的常用启发式方法。按照问题的指示，采用这种简化模型，矩阵 $A$ 的相对后向误差界可取为：\n$$\n\\text{Bound}(A) = C(n) u \\, \\gamma_{\\infty}(A)\n$$\n其中 $C(n)$ 合并了所有依赖于 $n$ 或基本常数的因子。\n\n当比较同一维度 $n$ 的缩放后矩阵 $A_{scaled}$ 和缩放前矩阵 $A_{unscaled}$ 的误差界时，它们的比率为：\n$$\n\\frac{\\text{Bound}(A_{scaled})}{\\text{Bound}(A_{unscaled})} = \\frac{C(n) u \\, \\gamma_{\\infty}(A_{scaled})}{C(n) u \\, \\gamma_{\\infty}(A_{unscaled})} = \\frac{\\gamma_{\\infty}(A_{scaled})}{\\gamma_{\\infty}(A_{unscaled})}\n$$\n这证明了在问题的假设下，为什么误差界之比就是相应增长因子之比。\n\n**4. 比率的最终计算**\n\n我们现在计算比率 $\\rho_{R}$ 和 $\\rho_{I}$。\n\n对于减小例子：\n$$\n\\rho_{R} = \\frac{\\gamma_{\\infty}(A_{s}^{(R)})}{\\gamma_{\\infty}(A^{(R)})} = \\frac{\\gamma_{\\infty}(A^{(R)} D_{c}^{(\\downarrow)})}{\\gamma_{\\infty}(A^{(R)})} = \\frac{1}{2}\n$$\n\n对于增大例子：\n$$\n\\rho_{I} = \\frac{\\gamma_{\\infty}(A_{s}^{(I)})}{\\gamma_{\\infty}(A^{(I)})} = \\frac{\\gamma_{\\infty}(A^{(I)} D_{c}^{(\\uparrow)})}{\\gamma_{\\infty}(A^{(I)})} = \\frac{2}{1} = 2\n$$\n\n所需的数对是 $(\\rho_{R}, \\rho_{I}) = (\\frac{1}{2}, 2)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了改善矩阵的数值属性外，矩阵缩放还用于将矩阵变换为具有特定结构的形态。Sinkhorn-Knopp 缩放就是这样一个例子，它旨在将一个非负矩阵缩放成一个具有预定行和与列和的矩阵，例如双随机矩阵。这项练习  将引导你深入该算法的理论核心，通过验证其存在性条件、计算一个具体案例并分析解的唯一性，来巩固对这一重要缩放技术的理解。",
            "id": "3559220",
            "problem": "考虑一个非负矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 以及将其对角缩放至双随机形式的问题，该问题被称为Sinkhorn-Knopp缩放。如果一个矩阵 $B \\in \\mathbb{R}^{n \\times n}$ 的所有元素均为非负，且每行之和与每列之和都等于$1$，则该矩阵被称为双随机矩阵。Sinkhorn-Knopp缩放问题要求寻找正对角矩阵 $D = \\mathrm{diag}(d_{1}, \\dots, d_{n})$ 和 $E = \\mathrm{diag}(e_{1}, \\dots, e_{n})$，使得 $B = D A E$ 是双随机的。一个经过充分检验的事实是，如果 $A$ 具有全支撑（等价地，$A$ 的每个正元素都位于一个正置换上），则Sinkhorn-Knopp算法收敛且存在这样的缩放；此外，如果 $A$ 是完全不可分的（即其零元素模式不允许任何非平凡的分块三角形式），则缩放在相差一个公共正常数因子的意义下是唯一的，即如果 $D$ 和 $E$ 得到一个双随机缩放，那么对于任何 $t  0$，$t D$ 和 $t^{-1} E$ 也是如此，并且所有解都以这种方式产生。\n\n处理具体矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  2 \\\\\n2  0  1 \\\\\n1  2  0\n\\end{pmatrix}.\n$$\n\n仅使用核心定义和上述广为接受的事实，完成以下任务：\n- 通过在置换支撑层面验证适当的结构条件，确定给定的矩阵 $A$ 是否存在Sinkhorn-Knopp缩放。\n- 利用定义中可推导的任何结构不变性，计算 $A$ 的一对明确的正对角缩放 $D$ 和 $E$，使得 $B = D A E$ 为双随机矩阵（不要引用未经证明的简化公式）。\n- 分析该矩阵缩放的唯一性（在相差一个正常数因子的意义下），并找出在变换 $(D,E) \\mapsto (t D, t^{-1} E)$ 下缩放的一个不变乘法量。\n\n报告与您计算出的缩放相关的不变乘积 $\\det(D)\\,\\det(E)$ 的精确值。无需四舍五入。将答案表示为单个实数或单个无单位的封闭形式解析表达式。",
            "solution": "解答分为三个部分：首先，验证Sinkhorn-Knopp缩放的存在性；其次，计算一对明确的缩放矩阵；第三，分析缩放的唯一性并计算指定的不变量。\n\n**第1部分：缩放的存在性**\n\n问题指出，如果矩阵 $A$ 具有全支撑，则Sinkhorn-Knopp缩放存在。一个矩阵具有全支撑，是指其每个正元素都位于一个正置换上。对于一个 $n \\times n$ 矩阵 $A$，如果相应元素的乘积 $\\prod_{i=1}^{n} a_{i, \\sigma(i)}$ 为正，则称 $\\{1, 2, \\dots, n\\}$ 的一个置换 $\\sigma$ 是正的。\n\n给定矩阵为 $A = \\begin{pmatrix} 0  1  2 \\\\ 2  0  1 \\\\ 1  2  0 \\end{pmatrix}$。这是一个 $3 \\times 3$ 矩阵，因此我们检查 $\\{1, 2, 3\\}$ 的 $3! = 6$ 个置换。\n\\begin{enumerate}\n    \\item $\\sigma = (1, 2, 3)$ (单位置换): $a_{11}a_{22}a_{33} = 0 \\cdot 0 \\cdot 0 = 0$。不是正置换。\n    \\item $\\sigma = (1, 3, 2)$: $a_{11}a_{23}a_{32} = 0 \\cdot 1 \\cdot 2 = 0$。不是正置换。\n    \\item $\\sigma = (2, 1, 3)$: $a_{12}a_{21}a_{33} = 1 \\cdot 2 \\cdot 0 = 0$。不是正置换。\n    \\item $\\sigma = (2, 3, 1)$: $a_{12}a_{23}a_{31} = 1 \\cdot 1 \\cdot 1 = 1 > 0$。这是一个正置换。涉及的元素是 $\\{a_{12}, a_{23}, a_{31}\\}$。\n    \\item $\\sigma = (3, 1, 2)$: $a_{13}a_{21}a_{32} = 2 \\cdot 2 \\cdot 2 = 8 > 0$。这是一个正置换。涉及的元素是 $\\{a_{13}, a_{21}, a_{32}\\}$。\n    \\item $\\sigma = (3, 2, 1)$: $a_{13}a_{22}a_{31} = 2 \\cdot 0 \\cdot 1 = 0$。不是正置换。\n\\end{enumerate}\n有两个正置换。$A$ 中的正元素集合是 $\\{ a_{12}, a_{13}, a_{21}, a_{23}, a_{31}, a_{32} \\}$。我们检查每个元素是否位于两个正置换之一上：\n- $a_{12} = 1$：位于置换 $\\sigma=(2, 3, 1)$ 上。\n- $a_{13} = 2$：位于置换 $\\sigma=(3, 1, 2)$ 上。\n- $a_{21} = 2$：位于置换 $\\sigma=(3, 1, 2)$ 上。\n- $a_{23} = 1$：位于置换 $\\sigma=(2, 3, 1)$ 上。\n- $a_{31} = 1$：位于置换 $\\sigma=(2, 3, 1)$ 上。\n- $a_{32} = 2$：位于置换 $\\sigma=(3, 1, 2)$ 上。\n由于 $A$ 的每个正元素都位于一个正置换上，所以 $A$ 具有全支撑。因此，Sinkhorn-Knopp缩放存在。\n\n**第2部分：计算缩放矩阵 $D$ 和 $E$**\n\n我们寻找正对角矩阵 $D = \\mathrm{diag}(d_1, d_2, d_3)$ 和 $E = \\mathrm{diag}(e_1, e_2, e_3)$，使得 $B = DAE$ 是双随机的。矩阵 $B$ 的元素为 $b_{ij} = d_i a_{ij} e_j$。\n$$\nB = \\begin{pmatrix} d_1  0  0 \\\\ 0  d_2  0 \\\\ 0  0  d_3 \\end{pmatrix} \\begin{pmatrix} 0  1  2 \\\\ 2  0  1 \\\\ 1  2  0 \\end{pmatrix} \\begin{pmatrix} e_1  0  0 \\\\ 0  e_2  0 \\\\ 0  0  e_3 \\end{pmatrix} = \\begin{pmatrix} 0  d_1 e_2  2 d_1 e_3 \\\\ 2 d_2 e_1  0  d_2 e_3 \\\\ d_3 e_1  2 d_3 e_2  0 \\end{pmatrix}\n$$\n$B$ 是双随机矩阵的条件是其行和与列和都等于$1$。\n行和：\n1. $d_1 e_2 + 2 d_1 e_3 = 1 \\implies d_1 (e_2 + 2 e_3) = 1$\n2. $2 d_2 e_1 + d_2 e_3 = 1 \\implies d_2 (2 e_1 + e_3) = 1$\n3. $d_3 e_1 + 2 d_3 e_2 = 1 \\implies d_3 (e_1 + 2 e_2) = 1$\n列和：\n4. $2 d_2 e_1 + d_3 e_1 = 1 \\implies e_1 (2 d_2 + d_3) = 1$\n5. $d_1 e_2 + 2 d_3 e_2 = 1 \\implies e_2 (d_1 + 2 d_3) = 1$\n6. $2 d_1 e_3 + d_2 e_3 = 1 \\implies e_3 (2 d_1 + d_2) = 1$\n\n由方程(1)和(5)可得 $d_1 (e_2 + 2 e_3) = e_2 (d_1 + 2 d_3)$，化简为 $d_1 e_2 + 2d_1 e_3 = d_1 e_2 + 2d_3 e_2$，所以 $d_1 e_3 = d_3 e_2$。\n由方程(2)和(6)可得 $d_2 (2 e_1 + e_3) = e_3 (2 d_1 + d_2)$，化简为 $2d_2 e_1 + d_2 e_3 = 2d_1 e_3 + d_2 e_3$，所以 $d_2 e_1 = d_1 e_3$。\n由方程(3)和(4)可得 $d_3 (e_1 + 2 e_2) = e_1 (2 d_2 + d_3)$，化简为 $d_3 e_1 + 2d_3 e_2 = 2d_2 e_1 + d_3 e_1$，所以 $d_3 e_2 = d_2 e_1$。\n综合这些关系，我们得到 $d_2 e_1 = d_3 e_2 = d_1 e_3$。\n由于 $A$ 具有高度的对称性（所有行和与列和都等于3），我们可以推测解也具有对称性，即 $d_1 = d_2 = d_3 = d$ 和 $e_1 = e_2 = e_3 = e$。\n将 $d_i=d$ 和 $e_j=e$ 代入六个原始方程中的任意一个，例如方程(1)，得到 $d(e+2e) = 1$，即 $3de=1$。\n因此，任何解都必须具有 $D=dI$ 和 $E=eI$ 的形式，其中 $I$ 是 $3 \\times 3$ 单位矩阵，$d,e$ 是满足 $de = 1/3$ 的正常数。\n对于一对明确的解，我们可以选择 $d=e$。那么 $d^2 = 1/3 \\implies d = 1/\\sqrt{3}$。\n所以，一对可能的缩放矩阵是 $D = \\mathrm{diag}(1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$ 和 $E = \\mathrm{diag}(1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$。\n\n**第3部分：唯一性与不变量**\n\n问题指出，如果 $A$ 是完全不可分的，则缩放在相差一个标量因子的意义下是唯一的。一个矩阵如果是非负的且具有全支撑，则它是完全不可分的。我们在第1部分中验证了 $A$ 具有全支撑，因此它是完全不可分的。\n唯一性属性意味着如果 $(D, E)$ 是一对缩放矩阵，那么任何其他对 $(D', E')$ 都必须是 $(tD, t^{-1}E)$ 的形式，其中 $t0$ 是某个标量。\n我们在第2部分的推导表明，所有解都具有 $D=dI, E=eI$ 的形式，且 $de=1/3$。这与所述的唯一性属性是一致的。设 $(D_0, E_0)$ 是一个解，比如 $D_0=I$ 和 $E_0=(1/3)I$。那么任何其他解都是 $(tD_0, t^{-1}E_0) = (tI, (1/3t)I)$。这具有 $(dI, eI)$ 的形式，其中 $d=t$ 且 $e=1/(3t)$，所以 $de = t \\cdot (1/(3t)) = 1/3$。\n\n我们被要求找出在变换 $(D, E) \\mapsto (tD, t^{-1}E)$ 下的不变量 $\\det(D)\\det(E)$ 的值。\n设 $D' = tD$ 和 $E' = t^{-1}E$。\n一个缩放后的对角矩阵的行列式是 $\\det(tD) = \\det(\\mathrm{diag}(td_1, \\dots, td_n)) = (td_1)\\cdots(td_n) = t^n \\det(D)$。\n对于我们的 $n=3$ 的情况：\n$\\det(D') = \\det(tD) = t^3 \\det(D)$。\n$\\det(E') = \\det(t^{-1}E) = (t^{-1})^3 \\det(E) = t^{-3} \\det(E)$。\n乘积为 $\\det(D')\\det(E') = (t^3 \\det(D))(t^{-3} \\det(E)) = t^3 t^{-3} \\det(D)\\det(E) = \\det(D)\\det(E)$。\n这证实了量 $\\det(D)\\det(E)$ 确实是一个不变量。\n\n为了计算它的值，我们可以使用任何有效的缩放对。根据第2部分，任何有效的缩放都具有 $D=dI$ 和 $E=eI$ 的形式，且 $de = 1/3$。\n$\\det(D) = \\det(dI) = d^3$。\n$\\det(E) = \\det(eI) = e^3$。\n不变积是 $\\det(D)\\det(E) = d^3 e^3 = (de)^3$。\n由于 $de = 1/3$，不变量的值是 $(1/3)^3$。\n$$\n\\det(D)\\det(E) = \\left(\\frac{1}{3}\\right)^3 = \\frac{1}{27}\n$$\n这个值与 $t$ 的具体选择无关，正如一个不变量所必须的那样。",
            "answer": "$$\\boxed{\\frac{1}{27}}$$"
        }
    ]
}