{
    "hands_on_practices": [
        {
            "introduction": "在深入探讨完整的算法之前，掌握高斯消元法中全主元消元策略的单步操作至关重要。这个练习将引导你亲手实践全主元消元的核心机制：在一个矩阵中寻找全局最大主元，执行相应的行和列置换，并通过构造舒尔补（Schur complement）来理解这一步操作如何导出矩阵的块 $LU$ 分解。通过这个具体的计算，你将对全主元消元的基本原理建立坚实的直观理解。",
            "id": "3538574",
            "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 是矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n3  -1  2  4 \\\\\n0  5  7  -2 \\\\\n-6  1  0  8 \\\\\n2  -9  1  1\n\\end{pmatrix}.\n$$\n考虑一步采用全主元法的高斯消元。使用以下基本定义和事实作为您的出发点：\n- 排列矩阵是通过对单位矩阵的行或列进行排列得到的，当它与一个矩阵相乘时，会产生相同的排列效果。\n- 全主元法在每一步中，在剩余的子矩阵中选择绝对值最大的元素，并应用行和列的排列将其移动到主元位置。\n- 使用排列矩阵 $P$ 和 $Q$ 将主元移动到 $(1,1)$ 位置后，排列后的矩阵可以写成 $2 \\times 2$ 的分块形式：\n$$\nP A Q \\;=\\; \\begin{pmatrix}\n\\alpha  w^{\\top} \\\\\nz  A_{22}\n\\end{pmatrix},\n$$\n其中 $\\alpha \\in \\mathbb{R}$，$w \\in \\mathbb{R}^{3}$，$z \\in \\mathbb{R}^{3}$，以及 $A_{22} \\in \\mathbb{R}^{3 \\times 3}$。\n- 舒尔补是由一步高斯消元产生的，该步骤消去主元下方的第一列元素并更新剩余的子矩阵。\n\n任务：\n1. 对矩阵 $A$ 使用全主元法确定主元 $\\alpha$，并构建相应的排列矩阵 $P$ 和 $Q$ 将主元移动到 $(1,1)$ 位置。显式地写出排列后的矩阵 $P A Q$。\n2. 将 $P A Q$ 分解为包含 $\\alpha$、$w^{\\top}$、$z$ 和 $A_{22}$ 的 $2 \\times 2$ 分块形式。执行一步消元，显式地构建 $P A Q$ 中关于 $\\alpha$ 的舒尔补 $S$。\n3. 通过直接的矩阵乘法，验证分块因子重新组合后得到排列后的矩阵，\n$$\n\\begin{pmatrix}\n1  0 \\\\\n\\ell  I_3\n\\end{pmatrix}\n\\begin{pmatrix}\n\\alpha  w^{\\top} \\\\\n0  S\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\alpha  w^{\\top} \\\\\nz  A_{22}\n\\end{pmatrix}\n\\;=\\;\nP A Q,\n$$\n其中 $\\ell \\in \\mathbb{R}^{3}$ 是用于消去 $\\alpha$ 下方第一列元素的乘子向量，$I_3$ 是 $3 \\times 3$ 的单位矩阵。\n4. 以精确的最简分数形式报告舒尔补 $S$ 的行列式。不要对答案进行四舍五-入。\n\n您的最终答案应该是 $\\det(S)$ 的单一精确值，以最简分数形式表示，不带单位。不要在最终答案中提供中间步骤。",
            "solution": "用户希望对一个给定的 $4 \\times 4$ 矩阵 $A$ 执行一步采用全主元法的高斯消元，并计算得到的舒尔补的行列式。\n\n给定的矩阵是：\n$$\nA \\;=\\; \\begin{pmatrix}\n3  -1  2  4 \\\\\n0  5  7  -2 \\\\\n-6  1  0  8 \\\\\n2  -9  1  1\n\\end{pmatrix}\n$$\n\n**任务1：确定主元 $\\alpha$、排列矩阵 $P$ 和 $Q$，以及排列后的矩阵 $P A Q$。**\n\n全主元法要求在整个矩阵 $A$ 中找到绝对值最大的元素。$A$ 的元素为 $\\{3, -1, 2, 4, 0, 5, 7, -2, -6, 1, 0, 8, 2, -9, 1, 1\\}$。最大绝对值为 $|-9| = 9$，对应于元素 $a_{42} = -9$。\n\n因此，主元是 $\\alpha = -9$。\n\n为了将此元素移动到 $(1,1)$ 位置，我们必须执行行排列和列排列。具体来说，我们需要交换第4行和第1行，以及交换第2列和第1列。\n\n行排列是通过将 $A$ 左乘一个排列矩阵 $P$ 来实现的，该矩阵 $P$ 交换了单位矩阵 $I_4$ 的第一行和第四行。\n$$\nP \\;=\\; \\begin{pmatrix}\n0  0  0  1 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n1  0  0  0\n\\end{pmatrix}\n$$\n列排列是通过将 $A$ 右乘一个排列矩阵 $Q$ 来实现的，该矩阵 $Q$ 交换了单位矩阵 $I_4$ 的第一列和第二列。\n$$\nQ \\;=\\; \\begin{pmatrix}\n0  1  0  0 \\\\\n1  0  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n现在，我们计算排列后的矩阵 $P A Q$：\n$$\nPA \\;=\\; \\begin{pmatrix}\n0  0  0  1 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n1  0  0  0\n\\end{pmatrix} \\begin{pmatrix}\n3  -1  2  4 \\\\\n0  5  7  -2 \\\\\n-6  1  0  8 \\\\\n2  -9  1  1\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n2  -9  1  1 \\\\\n0  5  7  -2 \\\\\n-6  1  0  8 \\\\\n3  -1  2  4\n\\end{pmatrix}\n$$\n$$\nP A Q \\;=\\; (PA)Q \\;=\\; \\begin{pmatrix}\n2  -9  1  1 \\\\\n0  5  7  -2 \\\\\n-6  1  0  8 \\\\\n3  -1  2  4\n\\end{pmatrix} \\begin{pmatrix}\n0  1  0  0 \\\\\n1  0  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n-9  2  1  1 \\\\\n5  0  7  -2 \\\\\n1  -6  0  8 \\\\\n-1  3  2  4\n\\end{pmatrix}\n$$\n\n**任务2：分解 $P A Q$ 并构建舒尔补 $S$。**\n\n我们将 $P A Q$ 分解为 $2 \\times 2$ 的分块形式：\n$$\nP A Q \\;=\\; \\begin{pmatrix}\n\\alpha  w^{\\top} \\\\\nz  A_{22}\n\\end{pmatrix}\n$$\n根据任务1的结果，我们确定以下分块：\n$$\n\\alpha \\;=\\; -9\n$$\n$$\nw^{\\top} \\;=\\; \\begin{pmatrix} 2  1  1 \\end{pmatrix} \\implies w \\;=\\; \\begin{pmatrix} 2 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nz \\;=\\; \\begin{pmatrix} 5 \\\\ 1 \\\\ -1 \\end{pmatrix}\n$$\n$$\nA_{22} \\;=\\; \\begin{pmatrix} 0  7  -2 \\\\ -6  0  8 \\\\ 3  2  4 \\end{pmatrix}\n$$\n舒尔补 $S$ 定义为 $S = A_{22} - z \\alpha^{-1} w^{\\top}$。这可以计算为 $S = A_{22} - \\ell w^{\\top}$，其中 $\\ell$ 是乘子向量。\n乘子计算为 $\\ell = z / \\alpha$：\n$$\n\\ell \\;=\\; \\frac{1}{-9} \\begin{pmatrix} 5 \\\\ 1 \\\\ -1 \\end{pmatrix} \\;=\\; \\begin{pmatrix} -5/9 \\\\ -1/9 \\\\ 1/9 \\end{pmatrix}\n$$\n接下来，我们计算外积 $\\ell w^{\\top}$：\n$$\n\\ell w^{\\top} \\;=\\; \\begin{pmatrix} -5/9 \\\\ -1/9 \\\\ 1/9 \\end{pmatrix} \\begin{pmatrix} 2  1  1 \\end{pmatrix} \\;=\\; \\begin{pmatrix}\n-10/9  -5/9  -5/9 \\\\\n-2/9  -1/9  -1/9 \\\\\n2/9  1/9  1/9\n\\end{pmatrix}\n$$\n最后，我们计算舒尔补 $S = A_{22} - \\ell w^{\\top}$：\n$$\nS \\;=\\; \\begin{pmatrix} 0  7  -2 \\\\ -6  0  8 \\\\ 3  2  4 \\end{pmatrix} - \\begin{pmatrix}\n-10/9  -5/9  -5/9 \\\\\n-2/9  -1/9  -1/9 \\\\\n2/9  1/9  1/9\n\\end{pmatrix}\n$$\n$$\nS \\;=\\; \\begin{pmatrix}\n0 - (-\\frac{10}{9})  7 - (-\\frac{5}{9})  -2 - (-\\frac{5}{9}) \\\\\n-6 - (-\\frac{2}{9})  0 - (-\\frac{1}{9})  8 - (-\\frac{1}{9}) \\\\\n3 - \\frac{2}{9}  2 - \\frac{1}{9}  4 - \\frac{1}{9}\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n\\frac{10}{9}  \\frac{63+5}{9}  \\frac{-18+5}{9} \\\\\n\\frac{-54+2}{9}  \\frac{1}{9}  \\frac{72+1}{9} \\\\\n\\frac{27-2}{9}  \\frac{18-1}{9}  \\frac{36-1}{9}\n\\end{pmatrix}\n$$\n$$\nS \\;=\\; \\begin{pmatrix}\n10/9  68/9  -13/9 \\\\\n-52/9  1/9  73/9 \\\\\n25/9  17/9  35/9\n\\end{pmatrix}\n$$\n\n**任务3：验证分块分解。**\n\n我们需要验证 $\\begin{pmatrix} 1  0 \\\\ \\ell  I_3 \\end{pmatrix} \\begin{pmatrix} \\alpha  w^{\\top} \\\\ 0  S \\end{pmatrix} = P A Q$。方程的左侧对应于分块LU分解：\n$$\n\\begin{pmatrix} 1  0 \\\\ \\ell  I_3 \\end{pmatrix} \\begin{pmatrix} \\alpha  w^{\\top} \\\\ 0  S \\end{pmatrix} \\;=\\; \\begin{pmatrix}\n(1)(\\alpha) + (0)(0)  (1)w^{\\top} + (0)S \\\\\n\\ell \\alpha + I_3 0  \\ell w^{\\top} + I_3 S\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n\\alpha  w^{\\top} \\\\\n\\ell \\alpha  \\ell w^{\\top} + S\n\\end{pmatrix}\n$$\n根据定义，我们有 $\\ell \\alpha = (z/\\alpha)\\alpha = z$。同样根据 $S$ 的定义，我们有 $S = A_{22} - \\ell w^{\\top}$，这意味着 $\\ell w^{\\top} + S = A_{22}$。将这些代入分块乘积中，得到：\n$$\n\\begin{pmatrix}\n\\alpha  w^{\\top} \\\\\nz  A_{22}\n\\end{pmatrix}\n$$\n这正是 $P A Q$ 的分块表示。因此，通过各部分的定义，验证得以确认。\n\n**任务4：报告舒尔补 $S$ 的行列式。**\n\n舒尔补矩阵是：\n$$\nS \\;=\\; \\frac{1}{9} \\begin{pmatrix}\n10  68  -13 \\\\\n-52  1  73 \\\\\n25  17  35\n\\end{pmatrix}\n$$\n对于一个 $n \\times n$ 矩阵 $M$，使用性质 $\\det(cM) = c^n \\det(M)$， $S$ 的行列式为：\n$$\n\\det(S) \\;=\\; \\left(\\frac{1}{9}\\right)^3 \\det \\begin{pmatrix}\n10  68  -13 \\\\\n-52  1  73 \\\\\n25  17  35\n\\end{pmatrix}\n$$\n我们使用沿第一行的余子式展开来计算该整数矩阵的行列式：\n$$\n\\det \\begin{pmatrix}\n10  68  -13 \\\\\n-52  1  73 \\\\\n25  17  35\n\\end{pmatrix} \\;=\\; 10 \\begin{vmatrix} 1  73 \\\\ 17  35 \\end{vmatrix} - 68 \\begin{vmatrix} -52  73 \\\\ 25  35 \\end{vmatrix} + (-13) \\begin{vmatrix} -52  1 \\\\ 25  17 \\end{vmatrix}\n$$\n$$\n\\;=\\; 10(1 \\cdot 35 - 73 \\cdot 17) - 68(-52 \\cdot 35 - 73 \\cdot 25) - 13(-52 \\cdot 17 - 1 \\cdot 25)\n$$\n$$\n\\;=\\; 10(35 - 1241) - 68(-1820 - 1825) - 13(-884 - 25)\n$$\n$$\n\\;=\\; 10(-1206) - 68(-3645) - 13(-909)\n$$\n$$\n\\;=\\; -12060 + 247860 + 11817\n$$\n$$\n\\;=\\; 247617\n$$\n现在，我们计算 $\\det(S)$：\n$$\n\\det(S) \\;=\\; \\frac{247617}{9^3} \\;=\\; \\frac{247617}{729}\n$$\n为了化简分数，我们观察到分子的各位数字之和为 $2+4+7+6+1+7 = 27$，可以被 $9$ 整除。分母的各位数字之和为 $7+2+9=18$，可以被 $9$ 整除。事实上，$729 = 9^3 = 81 \\times 9$。$247617 \\div 81 = 3057$。$729 \\div 81 = 9$。\n所以，\n$$\n\\det(S) \\;=\\; \\frac{3057}{9}\n$$\n$3057$ 的各位数字之和为 $3+0+5+7 = 15$，可以被 $3$ 整除，但不能被 $9$ 整除。将分子和分母同时除以 $3$：\n$$\n\\det(S) \\;=\\; \\frac{3057 \\div 3}{9 \\div 3} \\;=\\; \\frac{1019}{3}\n$$\n$1019$ 的质因数不小，且不能被 $3$ 整除。因此，该分数为最简形式。\n\n一个替代的检验方法是利用性质 $\\det(PAQ) = \\det(L)\\det(U_S)$，其中 $L$ 是分块下三角矩阵，$U_S$ 是分块上三角矩阵。$\\det(P) = -1$ (一次行交换)，$\\det(Q) = -1$ (一次列交换)，所以 $\\det(PAQ) = \\det(P)\\det(A)\\det(Q) = (-1)\\det(A)(-1) = \\det(A)$。$\\det(L)=1$ 且 $\\det(U_S) = \\alpha \\cdot \\det(S)$。因此，$\\det(A) = \\alpha \\det(S)$，这得到 $\\det(S) = \\det(A) / \\alpha$。\n一个单独的计算表明 $\\det(A) = -3057$。当 $\\alpha = -9$ 时，我们得到：\n$$\n\\det(S) \\;=\\; \\frac{-3057}{-9} \\;=\\; \\frac{3057}{9} \\;=\\; \\frac{1019}{3}\n$$\n这证实了结果。",
            "answer": "$$\n\\boxed{\\frac{1019}{3}}\n$$"
        },
        {
            "introduction": "理解了单步操作后，下一个关键问题是：为什么全主元策略是必要的，它与更常见的列主元策略有何不同？本练习提供了一个精心设计的矩阵，在该矩阵上，两种主元选择策略会产生不同的主元序列。通过为两种策略分别计算完整的 $P A = L U$ 或 $P A Q = L U$ 分解，你将直接观察到主元选择如何从第一步开始就影响整个分解过程以及最终的 $L$ 和 $U$ 因子。",
            "id": "3538559",
            "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 是矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n1  2  3  4 \\\\\n2  1  1  20 \\\\\n3  1  1  1 \\\\\n4  1  1  1\n\\end{pmatrix}.\n$$\n回顾一下，部分主元高斯消元法 (GEPP) 在每一步中通过行置换将当前列中绝对值最大的元素作为主元移动到对角线位置，而完全主元高斯消元法 (GECP) 则通过行和列的置换将当前待处理子矩阵中全局绝对值最大的元素作为主元移动到对角线位置。请基于高斯消元法、置换矩阵以及 LU 分解 ($P A = L U$ 用于部分主元法，$P A Q = L U$ 用于完全主元法) 的基本定义进行计算，其中 $P$ 和 $Q$ 是置換矩阵，$L$ 是单位下三角矩阵，$U$ 是上三角矩阵。\n\n(a) 在第一步消元时，确定 GEPP 和 GECP 分别选择哪个主元，并解释为什么对于矩阵 $A$ 它们的主元序列不同。\n\n(b) 对矩阵 $A$ 执行 GEPP，计算满足 $P_{\\mathrm{p}} A = L_{\\mathrm{p}} U_{\\mathrm{p}}$ 的置换矩阵 $P_{\\mathrm{p}}$、单位下三角因子 $L_{\\mathrm{p}}$ 和上三角因子 $U_{\\mathrm{p}}$。\n\n(c) 对矩阵 $A$ 执行 GECP，计算满足 $P_{\\mathrm{c}} A Q_{\\mathrm{c}} = L_{\\mathrm{c}} U_{\\mathrm{c}}$ 的置换矩阵 $P_{\\mathrm{c}}$ 和 $Q_{\\mathrm{c}}$，以及单位下三角因子 $L_{\\mathrm{c}}$ 和上三角因子 $U_{\\mathrmc}$。\n\n(d) 使用你计算出的 $L_{\\mathrm{p}}$ 和 $L_{\\mathrm{c}}$，计算它们差的弗罗贝尼乌斯范数的平方\n$$\nS \\;=\\; \\|\\,L_{\\mathrm{p}} \\;-\\; L_{\\mathrm{c}}\\,\\|_{F}^{2} \\;=\\; \\sum_{i=1}^{4} \\sum_{j=1}^{4} \\bigl(L_{\\mathrm{p}} - L_{\\mathrm{c}}\\bigr)_{ij}^{2}.\n$$\n请将 $S$ 的最终答案表示为精确表达式（不要四舍五入）。",
            "solution": "用户提供的问题是数值线性代数中一个定义明确的练习。所有给定条件都是明确的，任务基于标准的、可形式化的算法（部分主元和完全主元高斯消元法）。矩阵 $A$ 是非奇异的，这确保了对于指定的主元策略，LU 分解存在且唯一。因此，该问题是有效的。\n\n给定矩阵为\n$$\nA \\;=\\; \\begin{pmatrix}\n1  2  3  4 \\\\\n2  1  1  20 \\\\\n3  1  1  1 \\\\\n4  1  1  1\n\\end{pmatrix}.\n$$\n\n(a) 在第一步消元时，确定 GEPP 和 GECP 分别选择哪个主元，并解释为什么对于矩阵 $A$ 它们的主元序列不同。\n\n对于部分主元高斯消元法 (GEPP)，在第一步 ($k=1$)，我们在第一列中寻找绝对值最大的元素。\n$A$ 的第一列是 $(1, 2, 3, 4)^T$。最大绝对值为 $|A_{41}| = 4$。\n因此，GEPP 选择 $A_{41}=4$ 作为第一个主元。这需要交换第 1 行和第 4 行。\n\n对于完全主元高斯消元法 (GECP)，在第一步 ($k=1$)，我们在整个矩阵 $A$ 中寻找绝对值最大的元素。\n通过检查 $A$ 中的所有元素，最大绝对值为 $|A_{24}| = 20$。\n因此，GECP 选择 $A_{24}=20$ 作为第一个主元。这需要将第 1 行与第 2 行交换，并将第 1 列与第 4 列交换，以将主元元素带到活动子矩阵的 $(1,1)$ 位置。\n\n主元之所以不同，是因为 GEPP 的主元搜索范围仅限于当前列，而 GECP 的搜索空间是整个当前待处理子矩阵。对于矩阵 $A$，第一列中绝对值最大的元素 ($4$) 并不是整个矩阵中绝对值最大的元素 ($20$)。\n\n(b) 对矩阵 $A$ 执行 GEPP，计算满足 $P_{\\mathrm{p}} A = L_{\\mathrm{p}} U_{\\mathrm{p}}$ 的 $P_{\\mathrm{p}}$、$L_{\\mathrm{p}}$ 和 $U_{\\mathrm{p}}$。\n\n我们执行高斯消元法，用一个向量 $p=(1,2,3,4)$ 跟踪置换，并将乘子存储在矩阵的下三角部分。\n\n**第一步：** 主元是 $A_{41}=4$。交换第 1 行和第 4 行。$p$ 变为 $(4,2,3,1)$。\n矩阵变为：\n$$ A^{(1)} := \\begin{pmatrix} 4  1  1  1 \\\\ 2  1  1  20 \\\\ 3  1  1  1 \\\\ 1  2  3  4 \\end{pmatrix} $$\n乘子：$m_{21} = \\frac{2}{4}=\\frac{1}{2}$，$m_{31} = \\frac{3}{4}$，$m_{41} = \\frac{1}{4}$。\n消元后（将乘子存储在对角线下方）：\n$$ \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{2}  1-\\frac{1}{2}  1-\\frac{1}{2}  20-\\frac{1}{2} \\\\ \\frac{3}{4}  1-\\frac{3}{4}  1-\\frac{3}{4}  1-\\frac{3}{4} \\\\ \\frac{1}{4}  2-\\frac{1}{4}  3-\\frac{1}{4}  4-\\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{39}{2} \\\\ \\frac{3}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\end{pmatrix} $$\n\n**第二步：** 查看子列 $(\\frac{1}{2}, \\frac{1}{4}, \\frac{7}{4})^T$。主元是 $\\frac{7}{4}$。它在当前矩阵的第 4 行。交换第 2 行和第 4 行。$p$ 原为 $(4,2,3,1)$，现在变为 $(4,1,3,2)$（交换索引 2 和 4 处的元素）。\n交换整个矩阵的第 2 行和第 4 行，包括已经计算出的乘子：\n$$ \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\\\ \\frac{3}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\\\ \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{39}{2} \\end{pmatrix} $$\n乘子：$m_{32} = \\frac{1/4}{7/4}=\\frac{1}{7}$，$m_{42} = \\frac{1/2}{7/4}=\\frac{2}{7}$。\n消元后：\n$$ \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\\\ \\frac{3}{4}  \\frac{1}{7}  \\frac{1}{4}-\\frac{1}{7}\\frac{11}{4}  \\frac{1}{4}-\\frac{1}{7}\\frac{15}{4} \\\\ \\frac{1}{2}  \\frac{2}{7}  \\frac{1}{2}-\\frac{2}{7}\\frac{11}{4}  \\frac{39}{2}-\\frac{2}{7}\\frac{15}{4} \\end{pmatrix} = \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\\\ \\frac{3}{4}  \\frac{1}{7}  -\\frac{1}{7}  -\\frac{2}{7} \\\\ \\frac{1}{2}  \\frac{2}{7}  -\\frac{2}{7}  \\frac{129}{7} \\end{pmatrix} $$\n\n**第三步：** 查看子列 $(-\\frac{1}{7}, -\\frac{2}{7})^T$。主元是 $-\\frac{2}{7}$。它在第 4 行。交换第 3 行和第 4 行。$p$ 变为 $(4,1,2,3)$。\n交换整个矩阵的第 3 行和第 4 行：\n$$ \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\\\ \\frac{1}{2}  \\frac{2}{7}  -\\frac{2}{7}  \\frac{129}{7} \\\\ \\frac{3}{4}  \\frac{1}{7}  -\\frac{1}{7}  -\\frac{2}{7} \\end{pmatrix} $$\n乘子：$m_{43} = \\frac{-1/7}{-2/7}=\\frac{1}{2}$。\n消元后：\n$$ \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\\\ \\frac{1}{2}  \\frac{2}{7}  -\\frac{2}{7}  \\frac{129}{7} \\\\ \\frac{3}{4}  \\frac{1}{7}  \\frac{1}{2}  -\\frac{2}{7}-\\frac{1}{2}\\frac{129}{7} \\end{pmatrix} = \\begin{pmatrix} 4  1  1  1 \\\\ \\frac{1}{4}  \\frac{7}{4}  \\frac{11}{4}  \\frac{15}{4} \\\\ \\frac{1}{2}  \\frac{2}{7}  -\\frac{2}{7}  \\frac{129}{7} \\\\ \\frac{3}{4}  \\frac{1}{7}  \\frac{1}{2}  -\\frac{19}{2} \\end{pmatrix} $$\n最终的置换向量 $p=(4,1,2,3)$ 意味着原始的第 4 行现在是第 1 行，第 1 行是第 2 行，第 2 行是第 3 行，第 3 行是第 4 行。\n$P_{\\mathrm{p}} = \\begin{pmatrix} 0  0  0  1 \\\\ 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix}$，$L_{\\mathrm{p}} = \\begin{pmatrix} 1  0  0  0 \\\\ 1/4  1  0  0 \\\\ 1/2  2/7  1  0 \\\\ 3/4  1/7  1/2  1 \\end{pmatrix}$，$U_{\\mathrm{p}} = \\begin{pmatrix} 4  1  1  1 \\\\ 0  7/4  11/4  15/4 \\\\ 0  0  -2/7  129/7 \\\\ 0  0  0  -19/2 \\end{pmatrix}$。\n\n(c) 对矩阵 $A$ 执行 GECP，计算满足 $P_{\\mathrm{c}} A Q_{\\mathrm{c}} = L_{\\mathrm{c}} U_{\\mathrm{c}}$ 的 $P_{\\mathrm{c}}$、$Q_{\\mathrm{c}}$、$L_{\\mathrm{c}}$ 和 $U_{\\mathrm{c}}$。\n\n我们从 $p=(1,2,3,4)$ 和 $q=(1,2,3,4)$ 开始。\n**第一步：** 主元是 $A_{24}=20$。交换行 1,2 ($p \\to (2,1,3,4)$) 和列 1,4 ($q \\to (4,2,3,1)$)。\n... 经过完整的GECP过程，最终的置换是 $p=(2,4,1,3)$ 和 $q=(4,1,3,2)$。\n$P_{\\mathrm{c}}$ 将行 $(1,2,3,4)$ 映射到 $(3,1,4,2)$。所以 $P_{\\mathrm{c}} = \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  0  1 \\\\ 1  0  0  0 \\\\ 0  0  1  0 \\end{pmatrix}$。\n$Q_{\\mathrm{c}}$ 将列 $(1,2,3,4)$ 映射到 $(2,4,3,1)$。所以 $Q_{\\mathrm{c}} = \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  0  1 \\\\ 0  0  1  0 \\\\ 1  0  0  0 \\end{pmatrix}$。\n需要被分解的矩阵是：\n$$ P_{\\mathrm{c}} A Q_{\\mathrm{c}} = \\begin{pmatrix} 20  2  1  1 \\\\ 1  4  1  1 \\\\ 4  1  3  2 \\\\ 1  3  1  1 \\end{pmatrix} $$\n现在我们对这个矩阵执行不带主元选择的 LU 分解。\n$m_{21} = \\frac{1}{20}$，$m_{31} = \\frac{4}{20}=\\frac{1}{5}$，$m_{41} = \\frac{1}{20}$。\n$m_{32} = \\frac{3/5}{39/10} = \\frac{2}{13}$，$m_{42} = \\frac{29/10}{39/10} = \\frac{29}{39}$。\n$m_{43} = \\frac{19/78}{69/26} = \\frac{19}{207}$。\n由此得到因子：\n$L_{\\mathrm{c}} = \\begin{pmatrix} 1  0  0  0 \\\\ 1/20  1  0  0 \\\\ 1/5  2/13  1  0 \\\\ 1/20  29/39  19/207  1 \\end{pmatrix}$\n$U_{\\mathrm{c}} = \\begin{pmatrix} 20  2  1  1 \\\\ 0  39/10  19/20  19/20 \\\\ 0  0  69/26  43/26 \\\\ 0  0  0  19/207 \\end{pmatrix}$\n\n(d) 使用你计算出的 $L_{\\mathrm{p}}$ 和 $L_{\\mathrm{c}}$，计算它们差的弗罗贝尼乌斯范数的平方 $S = \\|L_{\\mathrm{p}} - L_{\\mathrm{c}}\\|_{F}^{2}$。\n首先，我们计算差矩阵 $D = L_{\\mathrm{p}} - L_{\\mathrm{c}}$。对角线元素均为 $1-1=0$。\n$$\nD = \\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{4}  1  0  0 \\\\\n\\frac{1}{2}  \\frac{2}{7}  1  0 \\\\\n\\frac{3}{4}  \\frac{1}{7}  \\frac{1}{2}  1\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{20}  1  0  0 \\\\\n\\frac{1}{5}  \\frac{2}{13}  1  0 \\\\\n\\frac{1}{20}  \\frac{29}{39}  \\frac{19}{207}  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  0  0  0 \\\\\n\\frac{1}{4}-\\frac{1}{20}  0  0  0 \\\\\n\\frac{1}{2}-\\frac{1}{5}  \\frac{2}{7}-\\frac{2}{13}  0  0 \\\\\n\\frac{3}{4}-\\frac{1}{20}  \\frac{1}{7}-\\frac{29}{39}  \\frac{1}{2}-\\frac{19}{207}  0\n\\end{pmatrix}\n$$\n$D$ 的非零元素为：\n$D_{21} = \\frac{5-1}{20} = \\frac{4}{20} = \\frac{1}{5}$\n$D_{31} = \\frac{5-2}{10} = \\frac{3}{10}$\n$D_{32} = \\frac{26-14}{91} = \\frac{12}{91}$\n$D_{41} = \\frac{15-1}{20} = \\frac{14}{20} = \\frac{7}{10}$\n$D_{42} = \\frac{39-203}{273} = -\\frac{164}{273}$\n$D_{43} = \\frac{207-38}{414} = \\frac{169}{414}$\n\n弗罗贝尼乌斯范数的平方是所有元素平方的总和：\n$$ S = D_{21}^2 + D_{31}^2 + D_{32}^2 + D_{41}^2 + D_{42}^2 + D_{43}^2 $$\n$$ S = \\left(\\frac{1}{5}\\right)^2 + \\left(\\frac{3}{10}\\right)^2 + \\left(\\frac{12}{91}\\right)^2 + \\left(\\frac{7}{10}\\right)^2 + \\left(-\\frac{164}{273}\\right)^2 + \\left(\\frac{169}{414}\\right)^2 $$\n$$ S = \\frac{1}{25} + \\frac{9}{100} + \\frac{144}{8281} + \\frac{49}{100} + \\frac{26896}{74529} + \\frac{28561}{171396} $$\n合并同分母项：\n第一、第二和第四项：$\\frac{1}{25} + \\frac{9}{100} + \\frac{49}{100} = \\frac{4}{100} + \\frac{58}{100} = \\frac{62}{100} = \\frac{31}{50}$。\n第三和第五项 ($74529 = 9 \\times 8281$)：$\\frac{144}{8281} + \\frac{26896}{74529} = \\frac{144 \\times 9}{74529} + \\frac{26896}{74529} = \\frac{1296 + 26896}{74529} = \\frac{28192}{74529}$。\n因此，$S$ 的精确表达式为：\n$$ S = \\frac{31}{50} + \\frac{28192}{74529} + \\frac{28561}{171396} $$",
            "answer": "$$\\boxed{\\frac{31}{50} + \\frac{28192}{74529} + \\frac{28561}{171396}}$$"
        },
        {
            "introduction": "全主元消元法的主要理论优势在于其对元素增长的出色控制，这是保证数值稳定性的关键。本练习将理论与经验验证相结合，要求你将这一优势进行量化。通过编程实现全主元和列主元两种策略，并在一系列经典的“病态”或具有挑战性的测试矩阵上计算增长因子 $\\rho$，你将能够亲眼见证并量化全主元策略在抑制误差增长方面的实际效果。",
            "id": "3538569",
            "problem": "你需要使用机器双精度算术，为一组给定的方阵分析在高斯消去法过程中，采用不同主元选择策略时的元素增长情况。矩阵增长因子根据高斯消去法的基本原理定义，并将通过数值计算得出。\n\n从以下标准基础开始：\n- 高斯消去法执行一系列有限的基本下三角消去运算，将矩阵转换为一个上三角矩阵，此过程之前可能会进行行和/或列的置换以选择稳定的主元。\n- 在完全主元选择中，每一步消去时，主元选为当前活动尾部子矩阵中绝对值最大的元素；在消去更新之前，允许进行一次行交换和一次列交换。\n- 在部分主元选择中，每一步消去时，主元选为当前活动主元列中绝对值最大的元素；在消去更新之前，只允许进行行交换。\n- 将在消去过程中演化的矩阵记为 $A^{(0)}, A^{(1)}, \\dots, A^{(n-1)}$，其中 $A^{(0)} = A$ 是原始矩阵，$A^{(k)}$ 是在选择了第 $(k+1)$ 个主元并将主元列中主元下方的元素消去后的矩阵。对于给定的主元选择策略，增长因子是以下比率：\n$$\n\\rho \\;=\\; \\frac{\\max\\{\\,|a^{(k)}_{ij}| \\,:\\, 0 \\le k \\le n-1,\\, 1 \\le i,j \\le n\\,\\}}{\\max\\{\\,|a^{(0)}_{ij}| \\,:\\, 1 \\le i,j \\le n\\,\\}}.\n$$\n此定义仅取决于主元选择策略所允许的基本运算和置换，并且独立于任何特定的矩阵分解表示。\n\n任务：\n1. 遵循上述定义，为实数矩阵实现具有完全主元选择和部分主元选择的数值高斯消去法。对于每种主元选择策略，跟踪在所有消去步骤中（包括每次整列消去后）演化矩阵里遇到的最大绝对值元素。使用给定矩阵的初始最大绝对值元素作为分母。使用你的编程环境提供的标准机器双精度算术。不涉及物理单位。\n2. 对于下面测试套件中的每个矩阵，计算两个增长因子：一个在完全主元选择下，一个在部分主元选择下。同时计算这两个增长因子的比率，其中部分主元选择的增长因子为分子，完全主元选择的增长因子为分母。\n3. 你的算法必须完全按照主元选择方案的规定处理行和列的交换，并且对于非奇异矩阵必须是稳健的。你可以假设以下所有矩阵都是非奇异的。\n\n测试套件（所有矩阵均为 $5 \\times 5$ 实数矩阵）：\n- 测试用例1（已知在部分主元选择下会引起大增长的Wilkinson型矩阵）：\n$$\nA_1 \\;=\\; \\begin{bmatrix}\n1  0  0  0  1\\\\\n-1  1  0  0  1\\\\\n-1  -1  1  0  1\\\\\n-1  -1  -1  1  1\\\\\n-1  -1  -1  -1  1\n\\end{bmatrix}.\n$$\n- 测试用例2（希尔伯特矩阵）：\n$$\nA_2 \\;=\\; \\bigl[\\, (i+j-1)^{-1} \\,\\bigr]_{i,j=1}^{5}.\n$$\n- 测试用例3（对角元素递增的对角占优矩阵）：\n$$\nA_3 \\;=\\; \\begin{bmatrix}\n10  2  3  4  5\\\\\n1  20  3  4  5\\\\\n1  2  30  4  5\\\\\n1  2  3  40  5\\\\\n1  2  3  4  50\n\\end{bmatrix}.\n$$\n- 测试用例4（对角线为零，非对角线为一的对称矩阵）：\n$$\nA_4 \\;=\\; \\begin{bmatrix}\n0  1  1  1  1\\\\\n1  0  1  1  1\\\\\n1  1  0  1  1\\\\\n1  1  1  0  1\\\\\n1  1  1  1  0\n\\end{bmatrix}.\n$$\n\n输出规格：\n- 对于每个测试矩阵 $A_k$，输出一个包含三个实数的列表 $[\\rho_{\\mathrm{CP}}(A_k), \\rho_{\\mathrm{PP}}(A_k), \\rho_{\\mathrm{PP}}(A_k)/\\rho_{\\mathrm{CP}}(A_k)]$，其中 $\\rho_{\\mathrm{CP}}$ 表示完全主元选择下的增长因子，$\\rho_{\\mathrm{PP}}$ 表示部分主元选择下的增长因子，定义如上。\n- 将所有四个测试用例的结果聚合到一个列表中，顺序为 $[\\,\\text{用例1}, \\text{用例2}, \\text{用例3}, \\text{用例4}\\,]$。\n- 你的程序应生成单行输出，其中包含一个JSON格式的列表的列表，内含十进制数，无额外文本。例如，打印的行应如下所示：\n$$\n[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}],[x_{41},x_{42},x_{43}]].\n$$\n不需要物理单位或角度，输出中也不出现百分比。数字可以表示为标准的十进制浮点字面量。",
            "solution": "该问题要求计算在一组给定的 $5 \\times 5$ 实数矩阵上，采用两种不同的主元选择策略（部分主元选择和完全主元选择）进行高斯消去时的矩阵增长因子 $\\rho$。\n\n增长因子定义为在整个消去过程中遇到的最大绝对值元素与原始矩阵中最大绝对值元素之比。设原始矩阵为 $A^{(0)} = A$，大小为 $n \\times n$。高斯消去过程生成一系列矩阵 $A^{(0)}, A^{(1)}, \\dots, A^{(n-1)}$，其中 $A^{(k)}$ 是经过 $k$ 步消去（即前 $k$ 列对角线下方元素已被处理为零）后的矩阵。最终矩阵 $A^{(n-1)}$ 是上三角矩阵。增长因子 $\\rho$ 的正式定义为：\n$$\n\\rho \\;=\\; \\frac{\\max\\{\\,|a^{(k)}_{ij}| \\,:\\, 0 \\le k \\le n-1,\\, 1 \\le i,j \\le n\\,\\}}{\\max\\{\\,|a^{(0)}_{ij}| \\,:\\, 1 \\le i,j \\le n\\,\\}}\n$$\n我们的任务是实现带有部分和完全主元选择的高斯消去算法，对几个测试矩阵计算每种策略下的 $\\rho$ 值，并报告结果。\n\n解决方案的核心是一个统一的函数，它执行高斯消去并跟踪元素增长。该函数接受一个输入矩阵 $A$ 和一个指定主元选择策略的参数。\n\n设输入矩阵为 $A_{orig}$。我们首先创建一个工作副本 $A = A_{orig}$ 以执行类似就地的消去。矩阵的维度是 $n$。增长因子的分母 $\\max_{i,j} |a^{(0)}_{ij}|$ 最初从输入矩阵计算得出，并存储为 $m_{initial}$。一个变量 $m_{overall}$ 初始化为 $m_{initial}$，并将被更新以跟踪分子 $\\max_{k,i,j} |a^{(k)}_{ij}|$。\n\n消去过程在一个从 $k=0$ 到 $n-2$ 的循环中进行。每次迭代 $k$ 对应于处理矩阵的第 $k$ 列。\n\n**步骤1：主元选择**\n在每一步 $k$ 的开始，从活动（或尾部）子矩阵（即块 $A[k:n, k:n]$）中选择一个主元。主元选择策略决定了如何选择这个主元。\n\n-   **部分主元选择 (PP)**：主元的搜索范围仅限于当前列，即第 $k$ 列。我们在 $A[k:n, k]$ 中找到绝对值最大的元素。设该元素位于行索引 $p$ 处，其中 $k \\le p  n$。如果 $p \\neq k$，则交换第 $k$ 行和第 $p$ 行。这将最大绝对值元素带到主元位置 $(k,k)$。\n\n-   **完全主元选择 (CP)**：主元的搜索在整个活动子矩阵 $A[k:n, k:n]$ 上进行。我们在此子矩阵中找到绝对值最大的元素。设该元素位于位置 $(p, q)$，其中 $k \\le p, q  n$。为了将此元素移动到主元位置 $(k,k)$，我们执行两次交换：第 $k$ 行与第 $p$ 行交换，第 $k$ 列与第 $q$ 列交换。\n\n**步骤2：消去**\n主元元素 $a_{kk}$ 就位后，我们消去第 $k$ 列中其下方的非零项。对于从 $k+1$ 到 $n-1$ 的每一行 $i$，我们计算一个乘数 $l_{ik} = a_{ik} / a_{kk}$。然后，我们通过从第 $i$ 行减去 $l_{ik}$ 乘以第 $k$ 行来更新第 $i$ 行：$Row_i \\leftarrow Row_i - l_{ik} \\times Row_k$。此操作应用于该行从第 $k$ 列开始的所有元素，即对于 $j=k, \\dots, n-1$，有 $a_{ij} \\leftarrow a_{ij} - l_{ik} a_{kj}$。这确保了新的元素 $a_{ik}$ 变为零。\n\n**步骤3：增长因子更新**\n在步骤 $k$ 的消去操作完成后，矩阵 $A$ 已被转换为 $A^{(k+1)}$。然后，我们在整个矩阵 $A$ 的当前状态中找到任意元素的最大绝对值，如果这个新最大值更大，则更新 $m_{overall}$。即，$m_{overall} = \\max(m_{overall}, \\max_{i,j} |a_{ij}|)$。\n\n**步骤4：最终计算**\n循环完成（即对所有从 $0$ 到 $n-2$ 的 $k$）后，$m_{overall}$ 保存了在所有矩阵 $A^{(0)}, \\dots, A^{(n-1)}$ 中遇到的最大绝对值元素。然后增长因子计算为 $\\rho = m_{overall} / m_{initial}$。如果 $m_{initial}$ 为零（对于零矩阵），则 $\\rho$ 取为 $1$。\n\n此过程将应用于每个测试矩阵的 'pp' 和 'cp' 两种策略。结果 $\\rho_{CP}$ 和 $\\rho_{PP}$ 及其比率 $\\rho_{PP}/\\rho_{CP}$ 将被收集并按规定格式化。数值计算使用标准的双精度浮点算术进行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_growth(A_orig, pivot_type: str):\n    \"\"\"\n    Computes the growth factor for Gaussian elimination on matrix A.\n\n    Args:\n        A_orig: The input square numpy array.\n        pivot_type: The pivoting strategy, 'pp' for partial or 'cp' for complete.\n\n    Returns:\n        The growth factor rho.\n    \"\"\"\n    A = A_orig.copy().astype(np.float64)\n    n = A.shape[0]\n\n    if n == 0:\n        return 1.0\n\n    max_initial = np.max(np.abs(A))\n    if np.isclose(max_initial, 0.0):\n        return 1.0\n\n    max_overall = max_initial\n\n    for k in range(n - 1):\n        if pivot_type == 'pp':\n            # Partial Pivoting: find max in current column from diagonal down\n            pivot_row_rel = np.argmax(np.abs(A[k:, k]))\n            pivot_row_abs = k + pivot_row_rel\n\n            # Swap rows to bring pivot to A[k, k]\n            if pivot_row_abs != k:\n                A[[k, pivot_row_abs], :] = A[[pivot_row_abs, k], :]\n\n        elif pivot_type == 'cp':\n            # Complete Pivoting: find max in the active submatrix\n            submatrix = A[k:, k:]\n            p_rel, q_rel = np.unravel_index(np.argmax(np.abs(submatrix)), submatrix.shape)\n            pivot_row_abs = k + p_rel\n            pivot_col_abs = k + q_rel\n\n            # Swap rows to bring pivot to A[k, k]\n            if pivot_row_abs != k:\n                A[[k, pivot_row_abs], :] = A[[pivot_row_abs, k], :]\n            \n            # Swap columns to bring pivot to A[k, k]\n            if pivot_col_abs != k:\n                A[:, [k, pivot_col_abs]] = A[:, [pivot_col_abs, k]]\n        \n        else:\n            raise ValueError(\"Invalid pivot_type: must be 'pp' or 'cp'\")\n\n        pivot_val = A[k, k]\n        # As per problem, we assume non-singular matrices, so pivot_val != 0.\n        if np.isclose(pivot_val, 0.0):\n            continue \n\n        # Elimination for column k\n        for i in range(k + 1, n):\n            multiplier = A[i, k] / pivot_val\n            A[i, k:] -= multiplier * A[k, k:]\n        \n        # After step k, the matrix is A^(k+1). Update overall max.\n        current_max = np.max(np.abs(A))\n        if current_max  max_overall:\n            max_overall = current_max\n\n    growth_factor = max_overall / max_initial\n    return growth_factor\n\ndef solve():\n    # Define the test cases from the problem statement.\n    \n    # Test case 1: Wilkinson-type matrix\n    A1 = np.array([\n        [1,  0,  0,  0, 1],\n        [-1, 1,  0,  0, 1],\n        [-1, -1, 1,  0, 1],\n        [-1, -1, -1, 1, 1],\n        [-1, -1, -1, -1, 1]\n    ], dtype=float)\n\n    # Test case 2: Hilbert matrix\n    n_hilbert = 5\n    A2 = np.array([[1.0 / (i + j - 1) for j in range(1, n_hilbert + 1)] for i in range(1, n_hilbert + 1)])\n\n    # Test case 3: Diagonally dominant\n    A3 = np.array([\n        [10, 2, 3, 4, 5],\n        [1, 20, 3, 4, 5],\n        [1, 2, 30, 4, 5],\n        [1, 2, 3, 40, 5],\n        [1, 2, 3, 4, 50]\n    ], dtype=float)\n\n    # Test case 4: Symmetric with zero diagonal\n    A4 = np.ones((5, 5), dtype=float) - np.eye(5, dtype=float)\n\n    test_cases = [A1, A2, A3, A4]\n\n    results = []\n    for A in test_cases:\n        rho_cp = compute_growth(A, 'cp')\n        rho_pp = compute_growth(A, 'pp')\n        if np.isclose(rho_cp, 0.0):\n            ratio = 0.0 # Avoid division by zero\n        else:\n            ratio = rho_pp / rho_cp\n        results.append([rho_cp, rho_pp, ratio])\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}