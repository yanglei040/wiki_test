{
    "hands_on_practices": [
        {
            "introduction": "为了巩固部分主元消去法的基本操作，我们将从一个具体的计算问题开始。这个练习将引导你完整地执行一次带部分主元的 LU 分解，你需要仔细记录行交换（由置换矩阵 $P$ 体现）、乘数（构成下三角矩阵 $L$）以及最终的上三角矩阵 $U$。这是掌握更高级概念和进行误差分析前必须具备的基础技能。",
            "id": "3507947",
            "problem": "在计算天体物理学的辐射流体力学隐式时间积分中，由耦合的能量密度和辐射矩的线性化产生的局部雅可比块，会形成一个虽小但不可忽略的系统，该系统必须被稳健地求解。考虑矩阵\n$$\nA=\\begin{pmatrix}\n0   2  3 \\\\\n1   -1  0 \\\\\n2   0  1\n\\end{pmatrix}.\n$$\n为了在浮点运算中增强数值稳定性，请执行带部分主元法的LU分解（Lower-Upper decomposition）。这是一种高斯消元过程，通过行置换来为每一列选择绝对值最大的主元。构建编码行交换的置换矩阵 $P$、由乘子组成的单位下三角矩阵 $L$ 以及上三角矩阵 $U$，使得\n$$\nP A = L U.\n$$\n通过矩阵乘法显式地验证等式 $PA=LU$。最后，使用你的分解结果，将矩阵 $A$ 的行列式确定为一个实数值。最终答案应表示为精确值，不进行四舍五入，不带单位。最终答案必须仅为 $A$ 的行列式。",
            "solution": "该问题要求我们对给定的 $3 \\times 3$ 矩阵 $A$ 执行带部分主元法的LU分解，找到矩阵 $P$、$L$ 和 $U$ 使得 $PA = LU$。随后，我们必须验证此分解，并用它来计算 $A$ 的行列式。部分主元法是高斯消元中使用的一种策略，通过选择当前列中绝对值最大的元素作为主元来增强数值稳定性，从而最小化乘子的大小并控制舍入误差的传播。\n\n给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n0   2  3 \\\\\n1   -1  0 \\\\\n2   0  1\n\\end{pmatrix}\n$$\n\n我们将逐步进行高斯消元，并在一个置换矩阵 $P$ 中追踪行置换，该矩阵初始化为单位矩阵 $I$。\n\n**步骤1：第一列的消元**\n\n我们从 $A^{(0)} = A$ 和 $P^{(0)} = I$ 开始。\n$$\nA^{(0)} = \\begin{pmatrix}\n0   2  3 \\\\\n1   -1  0 \\\\\n2   0  1\n\\end{pmatrix}, \\quad P^{(0)} = \\begin{pmatrix}\n1   0  0 \\\\\n0   1  0 \\\\\n0   0  1\n\\end{pmatrix}\n$$\n对于第一列，我们检查对角线及其下方的元素：$|a_{11}| = 0$，$|a_{21}| = 1$，$|a_{31}| = 2$。最大的绝对值是 $2$，位于第三行。因此，我们必须交换第1行和第3行。此置换对应于左乘置换矩阵 $P_1$：\n$$\nP_1 = \\begin{pmatrix}\n0   0  1 \\\\\n0   1  0 \\\\\n1   0  0\n\\end{pmatrix}\n$$\n我们将此置换应用于 $A^{(0)}$ 和我们的累积置换矩阵 $P^{(0)}$：\n$$\nA' = P_1 A^{(0)} = \\begin{pmatrix}\n2   0  1 \\\\\n1   -1  0 \\\\\n0   2  3\n\\end{pmatrix}\n$$\n$$\nP^{(1)} = P_1 P^{(0)} = \\begin{pmatrix}\n0   0  1 \\\\\n0   1  0 \\\\\n1   0  0\n\\end{pmatrix}\n$$\n现在主元是 $a'_{11} = 2$。我们计算消除 $A'$ 第一列中次对角线元素所需的乘子：\n第2行的乘子：$m_{21} = \\frac{a'_{21}}{a'_{11}} = \\frac{1}{2}$。\n第3行的乘子：$m_{31} = \\frac{a'_{31}}{a'_{11}} = \\frac{0}{2} = 0$。\n\n我们执行行操作 $R_2 \\leftarrow R_2 - m_{21}R_1$ 和 $R_3 \\leftarrow R_3 - m_{31}R_1$：\n$R_2 \\leftarrow R_2 - \\frac{1}{2}R_1 \\Rightarrow [1, -1, 0] - \\frac{1}{2}[2, 0, 1] = [0, -1, -\\frac{1}{2}]$。\n$R_3 \\leftarrow R_3 - 0 \\cdot R_1 \\Rightarrow R_3$ 不变。\n\n第一阶段消元后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n2   0  1 \\\\\n0   -1  -\\frac{1}{2} \\\\\n0   2  3\n\\end{pmatrix}\n$$\n我们将存储乘子 $m_{21}$ 和 $m_{31}$，以便后续构建矩阵 $L$。\n\n**步骤2：第二列的消元**\n\n现在我们考虑从第二行第二列开始的子矩阵。我们检查第二列中对角线及其下方的元素：$|a^{(1)}_{22}| = |-1| = 1$，$|a^{(1)}_{32}| = |2| = 2$。最大的绝对值是 $2$，位于（当前矩阵的）第三行。我们必须交换第2行和第3行。此置换对应于矩阵 $P_2$：\n$$\nP_2 = \\begin{pmatrix}\n1   0  0 \\\\\n0   0  1 \\\\\n0   1  0\n\\end{pmatrix}\n$$\n我们将此置换应用于 $A^{(1)}$ 并更新我们的累积置换矩阵 $P^{(1)}$：\n$$\nA'' = P_2 A^{(1)} = \\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n0   -1  -\\frac{1}{2}\n\\end{pmatrix}\n$$\n$$\nP = P_2 P^{(1)} = \\begin{pmatrix}\n1   0  0 \\\\\n0   0  1 \\\\\n0   1  0\n\\end{pmatrix} \\begin{pmatrix}\n0   0  1 \\\\\n0   1  0 \\\\\n1   0  0\n\\end{pmatrix} = \\begin{pmatrix}\n0   0  1 \\\\\n1   0  0 \\\\\n0   1  0\n\\end{pmatrix}\n$$\n关键的是，这次行交换也适用于我们已经计算出的乘子。第一列的乘子是 $(m_{21}, m_{31}) = (\\frac{1}{2}, 0)$。交换它们的位置得到 $(\\tilde{m}_{21}, \\tilde{m}_{31}) = (0, \\frac{1}{2})$。\n\n现在主元是 $a''_{22} = 2$。我们计算第3行的乘子：\n$m_{32} = \\frac{a''_{32}}{a''_{22}} = \\frac{-1}{2}$。\n\n我们执行行操作 $R_3 \\leftarrow R_3 - m_{32}R_2$：\n$R_3 \\leftarrow R_3 - (-\\frac{1}{2})R_2 \\Rightarrow [0, -1, -\\frac{1}{2}] + \\frac{1}{2}[0, 2, 3] = [0, 0, -\\frac{1}{2} + \\frac{3}{2}] = [0, 0, 1]$。\n\n最终的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n0   0  1\n\\end{pmatrix}\n$$\n单位下三角矩阵 $L$ 是由乘子构建的，这些乘子被放置在所有置换完成后的最终位置。\n$L_{21} = \\tilde{m}_{21} = 0$。\n$L_{31} = \\tilde{m}_{31} = \\frac{1}{2}$。\n$L_{32} = m_{32} = -\\frac{1}{2}$。\n$$\nL = \\begin{pmatrix}\n1   0  0 \\\\\n0   1  0 \\\\\n\\frac{1}{2}   -\\frac{1}{2}  1\n\\end{pmatrix}\n$$\n最终的置换矩阵是 $P = \\begin{pmatrix}\n0   0  1 \\\\\n1   0  0 \\\\\n0   1  0\n\\end{pmatrix}$。\n\n**分解总结：**\n$$\nP = \\begin{pmatrix}\n0   0  1 \\\\\n1   0  0 \\\\\n0   1  0\n\\end{pmatrix}, \\quad\nL = \\begin{pmatrix}\n1   0  0 \\\\\n0   1  0 \\\\\n\\frac{1}{2}   -\\frac{1}{2}  1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n0   0  1\n\\end{pmatrix}\n$$\n**验证**\n\n我们必须显式地验证 $PA = LU$。首先，我们计算 $PA$：\n$$\nPA = \\begin{pmatrix}\n0   0  1 \\\\\n1   0  0 \\\\\n0   1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n0   2  3 \\\\\n1   -1  0 \\\\\n2   0  1\n\\end{pmatrix}\n= \\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n1   -1  0\n\\end{pmatrix}\n$$\n接下来，我们计算 $LU$：\n$$\nLU = \\begin{pmatrix}\n1   0  0 \\\\\n0   1  0 \\\\\n\\frac{1}{2}   -\\frac{1}{2}  1\n\\end{pmatrix}\n\\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n0   0  1\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 2 + 0 \\cdot 0 + 0 \\cdot 0  1 \\cdot 0 + 0 \\cdot 2 + 0 \\cdot 0  1 \\cdot 1 + 0 \\cdot 3 + 0 \\cdot 1 \\\\\n0 \\cdot 2 + 1 \\cdot 0 + 0 \\cdot 0  0 \\cdot 0 + 1 \\cdot 2 + 0 \\cdot 0  0 \\cdot 1 + 1 \\cdot 3 + 0 \\cdot 1 \\\\\n\\frac{1}{2} \\cdot 2 - \\frac{1}{2} \\cdot 0 + 1 \\cdot 0  \\frac{1}{2} \\cdot 0 - \\frac{1}{2} \\cdot 2 + 1 \\cdot 0  \\frac{1}{2} \\cdot 1 - \\frac{1}{2} \\cdot 3 + 1 \\cdot 1\n\\end{pmatrix}\n$$\n$$\nLU = \\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n1   -1  \\frac{1}{2} - \\frac{3}{2} + 1\n\\end{pmatrix}\n= \\begin{pmatrix}\n2   0  1 \\\\\n0   2  3 \\\\\n1   -1  0\n\\end{pmatrix}\n$$\n等式 $PA = LU$ 得以验证。\n\n**行列式计算**\n\n从分解式 $PA = LU$，我们可以写出 $\\det(PA) = \\det(LU)$。\n使用行列式的乘法性质，这变为 $\\det(P)\\det(A) = \\det(L)\\det(U)$。\n因此，$\\det(A) = \\frac{\\det(L)\\det(U)}{\\det(P)}$。\n\n我们计算每个矩阵的行列式：\n1.  $\\det(L)$：由于 $L$ 是一个单位下三角矩阵，其行列式是对角元素的乘积。$\\det(L) = 1 \\cdot 1 \\cdot 1 = 1$。\n2.  $\\det(U)$：由于 $U$ 是一个上三角矩阵，其行列式也是对角元素的乘积。$\\det(U) = 2 \\cdot 2 \\cdot 1 = 4$。\n3.  $\\det(P)$：置换矩阵的行列式是 $(-1)^s$，其中 $s$ 是执行的行交换次数。我们执行了两次交换：$(R_1 \\leftrightarrow R_3)$ 然后是 $(R_2 \\leftrightarrow R_3)$。因此，$s=2$。\n    $\\det(P) = (-1)^2 = 1$。\n\n将这些值代入 $\\det(A)$ 的方程中：\n$$\n\\det(A) = \\frac{1 \\cdot 4}{1} = 4\n$$\n矩阵 $A$ 的行列式是 $4$。这证实了我们最初的判断，即该矩阵是非奇异的，且LU分解是良定义的。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "理解了如何执行部分主元法后，下一个关键问题是分析其数值稳定性。这个练习引入了一类特殊的矩阵，在这些矩阵上，部分主元法虽然每一步都选择了局部最优的主元，但却会导致矩阵元素显著增长。通过推导其增长因子，你将深刻理解为何局部最优选择不一定能保证全局稳定性，这揭示了部分主元法的一个潜在弱点。",
            "id": "3564343",
            "problem": "设 $n \\geq 2$ 是一个整数。考虑 $n \\times n$ 矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$，其元素由下式指定\n$$\na_{ij} =\n\\begin{cases}\n1,  \\text{if } i=j, \\\\\n-1,  \\text{if } i=j+1, \\\\\n1,  \\text{if } j=n, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n因此，$A_n$ 是一个下双对角矩阵，其主对角线上的元素为 $1$，次对角线上的元素为 $-1$，并且其最后一列的元素全为 $1$。执行带部分主元选择的高斯消去法 (GEPP)，其中部分主元选择定义如下：在第 $k$ 步，在第 $k$ 列中，从第 $k,k+1,\\dots,n$ 行中选择绝对值最大的元素作为主元，如果存在多个绝对值相同的最大元素，则选择行号最小的那个。对于每个消去步骤 $k=1,2,\\dots,n-1$，根据该步骤的列结构直接证明 GEPP 选择的主元。利用这些证明和消去更新，推导出得到的上三角因子 $U$ 并计算增长因子\n$$\n\\gamma(A_n) = \\frac{\\max_{1 \\leq i,j \\leq n} |u_{ij}|}{\\max_{1 \\leq i,j \\leq n} |a_{ij}|}.\n$$\n你的最终答案必须是关于 $n$ 的单个封闭形式表达式，并且不需要四舍五入。",
            "solution": "该问题要求我们对一个特定的 $n \\times n$ 矩阵 $A_n$ 执行带部分主元选择的高斯消去法 (GEPP)，推导出得到的上三角因子 $U$，并计算增长因子。\n\n首先，我们写出矩阵 $A_n$。其元素 $a_{ij}$ 由下式给出：\n$$\na_{ij} =\n\\begin{cases}\n1,  \\text{if } i=j, \\\\\n-1,  \\text{if } i=j+1, \\\\\n1,  \\text{if } j=n, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n这意味着 $A_n$ 的主对角线元素为 $1$，第一条次对角线元素为 $-1$，最后一列元素为 $1$。所有其他元素均为 $0$。例如，对于 $n=4$，矩阵为：\n$$\nA_4 = \\begin{pmatrix}\n1  0  0  1 \\\\\n-1  1  0  1 \\\\\n0  -1  1  1 \\\\\n0  0  -1  1\n\\end{pmatrix}\n$$\n增长因子定义为 $\\gamma(A_n) = \\frac{\\max_{1 \\leq i,j \\leq n} |u_{ij}|}{\\max_{1 \\leq i,j \\leq n} |a_{ij}|}$。$A_n$ 的元素仅为 $1$、$-1$ 和 $0$。因此，$A_n$ 中任意元素的最大绝对值为 $\\max_{i,j} |a_{ij}| = 1$。增长因子简化为 $\\gamma(A_n) = \\max_{1 \\leq i,j \\leq n} |u_{ij}|$。\n\n我们将消去法第 $k$ 步开始时的矩阵记为 $A^{(k)}$，其中 $A^{(1)} = A_n$。该过程包含 $n-1$ 个步骤，从 $k=1$ 到 $k=n-1$。\n\n**步骤 $k=1$：**\n我们检查 $A^{(1)}=A_n$ 的第一列。其元素为 $a_{11}=1$，$a_{21}=-1$，以及当 $i > 2$ 时 $a_{i1}=0$。对于部分主元选择，我们在该列中从第 $1$ 行到第 $n$ 行寻找绝对值最大的元素。候选元素是 $a_{11}$ 和 $a_{21}$。我们有 $|a_{11}| = |1| = 1$ 和 $|a_{21}| = |-1| = 1$。由于绝对值存在相同的情况，问题规定“选择行号最小的那个”。因此，主元是 $a_{11}=1$。不需要进行行交换。\n\n主元下方的唯一非零元素是 $a_{21}=-1$。我们计算乘数 $m_{21} = a_{21}/a_{11} = -1/1 = -1$。对于 $i > 2$，所有其他乘数 $m_{i1}$ 均为 $0$。我们通过操作 $R_2 \\leftarrow R_2 - m_{21} R_1$（即 $R_2 \\leftarrow R_2 + R_1$）来更新第 $2$ 行。原始的第 $1$ 行是 $(1, 0, \\dots, 0, 1)$，第 $2$ 行是 $(-1, 1, 0, \\dots, 0, 1)$。\n$A^{(2)}$ 的新第 $2$ 行为：\n$$ (a_{21}+a_{11}, a_{22}+a_{12}, \\dots, a_{2,n-1}+a_{1,n-1}, a_{2n}+a_{1n}) = (-1+1, 1+0, \\dots, 0+0, 1+1) = (0, 1, 0, \\dots, 0, 2) $$\n现在矩阵 $A^{(2)}$ 为：\n$$\nA^{(2)} = \\begin{pmatrix}\n1  0  0  \\dots  1 \\\\\n0  1  0  \\dots  2 \\\\\n0  -1  1  \\dots  1 \\\\\n0  0  -1  \\dots  1 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\vdots \\\\\n0  0  \\dots  -1  1\n\\end{pmatrix}\n$$\n$A^{(2)}$ 的第一行是最终矩阵 $U$ 的第一行。所以，$u_{11}=1$，$u_{1n}=1$，并且对于 $j \\in \\{2, \\dots, n-1\\}$，$u_{1j}=0$。\n\n**一般步骤 $k$ (对于 $1 \\le k  n-1$)：**\n我们用归纳法证明，在第 $k$ 步开始时，矩阵 $A^{(k)}$ 的第 $k$ 行对角线元素为 1，最后一列元素为 $k$，即 $a_{kk}^{(k)}=1$ 和 $a_{kn}^{(k)}=k$。\n我们已经证明了 $k=1$（$a_{1n}^{(1)}=1$）和 $k=2$（$a_{2n}^{(2)}=2$）时该假设成立。现在假设它对第 $k$ 步成立。\n\n**第 $k$ 步主元选择的理由：**\n在第 $k$ 步，我们查看第 $k$ 列从第 $k$ 行开始向下的部分。这些元素是 $a^{(k)}_{kk}=1$，$a^{(k)}_{k+1,k}=-1$，以及对于 $i > k+1$，$a^{(k)}_{ik}=0$。主元候选元素的绝对值集合是 $\\{|a^{(k)}_{kk}|, |a^{(k)}_{k+1,k}|, \\dots \\} = \\{1, 1, 0, \\dots, 0\\}$。最大绝对值为 $1$。这个值出现在第 $k$ 行和第 $k+1$ 行。根据处理相同情况的规则，我们选择行号最小的那个，即第 $k$ 行。所以，主元是 $a^{(k)}_{kk}=1$。不执行行交换。\n\n**第 $k$ 步的消去：**\n在第 $k$ 列中唯一需要消去的非零元素是 $a^{(k)}_{k+1,k}=-1$。乘数是 $m_{k+1,k} = a^{(k)}_{k+1,k}/a^{(k)}_{kk} = -1/1 = -1$。对于 $i>k+1$ 的所有其他乘数 $m_{ik}$ 均为 $0$。\n我们更新第 $k+1$ 行：$R_{k+1} \\leftarrow R_{k+1} - m_{k+1,k}R_k = R_{k+1} + R_k$。\n$A^{(k)}$ 的原始第 $k$ 行是 $(0, \\dots, 0, 1, 0, \\dots, 0, k)$，其中第 $k$ 列的元素为 $1$。\n$A^{(k)}$ 的原始第 $k+1$ 行是 $(0, \\dots, 0, -1, 1, 0, \\dots, 0, 1)$，其中第 $k$ 列的元素为 $-1$，第 $k+1$ 列的元素为 $1$。\n$A^{(k+1)}$ 的新第 $k+1$ 行变为：\n- 对于列 $j=k$：$a^{(k+1)}_{k+1,k} = a^{(k)}_{k+1,k} + a^{(k)}_{k,k} = -1+1=0$。\n- 对于列 $j=k+1$：$a^{(k+1)}_{k+1,k+1} = a^{(k)}_{k+1,k+1} + a^{(k)}_{k,k+1} = 1+0=1$。\n- 对于列 $j=n$：$a^{(k+1)}_{k+1,n} = a^{(k)}_{k+1,n} + a^{(k)}_{k,n} = 1+k = k+1$。\n- 对于所有其他列 $j$，元素为 $0+0=0$。\n所以在第 $k+1$ 步开始时，$A^{(k+1)}$ 的第 $k+1$ 行在对角线位置 $(k+1,k+1)$ 处的元素为 $1$，最后一列的元素为 $k+1$，其他位置均为零。这证实了对第 $k+1$ 步的归纳假设。\n\n这个过程一直持续到 $k=n-1$。\n\n**步骤 $n-1$：**\n在第 $n-1$ 步开始时，矩阵 $A^{(n-1)}$ 为：\n$$\nA^{(n-1)} = \\begin{pmatrix}\n1  0  \\cdots  0  1 \\\\\n0  1  \\cdots  0  2 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  \\cdots  1  n-2 \\\\\n0  0  \\cdots  0  1  n-1 \\\\\n0  0  \\cdots  0  -1  1\n\\end{pmatrix}\n$$\n我们检查第 $n-1$ 列从第 $n-1$ 行开始向下的部分。元素为 $a^{(n-1)}_{n-1,n-1}=1$ 和 $a^{(n-1)}_{n,n-1}=-1$。与之前所有步骤一样，根据处理相同情况的规则，主元是 $a^{(n-1)}_{n-1,n-1}=1$。\n乘数是 $m_{n,n-1} = a^{(n-1)}_{n,n-1}/a^{(n-1)}_{n-1,n-1} = -1/1 = -1$。\n我们更新最后一行：$R_n \\leftarrow R_n - m_{n,n-1} R_{n-1} = R_n + R_{n-1}$。\n新的第 $n$ 行的元素是：\n- 第 $n-1$ 列：$a^{(n)}_{n,n-1} = -1+1=0$。\n- 第 $n$ 列：$a^{(n)}_{n,n} = a^{(n-1)}_{n,n} + a^{(n-1)}_{n-1,n} = 1 + (n-1) = n$。\n\n**上三角矩阵 U：**\n过程终止，得到上三角矩阵 $U = A^{(n)}$。综合所有步骤的结果：\n- 对于 $i \\in \\{1, 2, \\dots, n-1\\}$，第 $i$ 行有 $u_{ii}=1$，$u_{in}=i$，所有其他元素 $u_{ij}=0$（对于 $j \\neq i, n$）。\n- 对于 $i=n$，第 $n$ 行有 $u_{nn}=n$，所有其他元素 $u_{nj}=0$。\n因此，矩阵 $U$ 为：\n$$\nU = \\begin{pmatrix}\n1  0  \\dots  0  1 \\\\\n0  1  \\dots  0  2 \\\\\n0  0  \\ddots  \\vdots  \\vdots \\\\\n\\vdots    1  n-1 \\\\\n0  0  \\dots  0  n\n\\end{pmatrix}\n$$\n$U$ 的元素是 $1, 2, \\dots, n$ 以及一些 $0$。$U$ 中绝对值最大的元素显然是右下角的元素 $u_{nn}=n$。\n\n**增长因子：**\n增长因子是\n$$\n\\gamma(A_n) = \\max_{1 \\leq i,j \\leq n} |u_{ij}| = |u_{nn}| = n.\n$$",
            "answer": "$$\\boxed{n}$$"
        },
        {
            "introduction": "既然我们已经看到了部分主元法的局限性，一个自然的问题是：是否存在其他更稳健的策略？这个练习将引导你对同一个矩阵分别应用部分主元法（GEPP）和完全主元法（GECP）进行高斯消去。通过这个案例研究，你将直接观察到不同的主元选择策略如何显著影响增长因子，从而更深入地理解设计数值算法时在计算成本和数值稳定性之间的权衡。",
            "id": "3564346",
            "problem": "考虑以下矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$：\n$$\nA \\;=\\;\n\\begin{bmatrix}\n1   0  0  1 \\\\\n-1  1  0  1 \\\\\n0   -1  1  1 \\\\\n0   0  -1  1\n\\end{bmatrix}.\n$$\n在整个过程中，将高斯消元法解释为一种标准算法，该算法对前导主子块执行连续的舒尔补运算，并且在每个舒尔补步骤之前，可以根据主元选择规则自由地对行和/或列进行置换。\n\n对于给定的主元选择策略 $\\mathcal{P}$，定义增长因子 $\\rho(A,\\mathcal{P})$ 为\n$$\n\\rho(A,\\mathcal{P}) \\;=\\; \\frac{\\displaystyle \\max_{k} \\max_{i,j} \\left| a_{ij}^{(k)} \\right|}{\\displaystyle \\max_{i,j} \\left| a_{ij}^{(0)} \\right|},\n$$\n其中 $a_{ij}^{(0)}$ 是初始矩阵 $A$ 的元素，而 $a_{ij}^{(k)}$ 是第 $k$ 步消元（采用所选主元策略）后矩阵的元素。分子扫描了消元过程中任何中间阶段出现的所有元素，包括任何行/列置换后的元素；分母是初始矩阵 $A$ 中元素绝对值的最大值。\n\n考虑两种主元选择策略：\n- 部分主元高斯消元法 (GEPP)：在第 $k$ 步，通过行置换，将第 $k$ 列（在第 $k,k+1,\\ldots$ 行中）绝对值最大的元素放到 $(k,k)$ 位置。如果出现相同值，则选择最小的行索引。\n- 全主元高斯消元法 (GECP)：在第 $k$ 步，通过行和列的置换，将后继子矩阵（第 $k,k+1,\\ldots$ 行和列）中绝对值最大的元素放到 $(k,k)$ 位置。如果出现相同值，则选择最小的行索引，然后再选择最小的列索引。\n\n仅根据上述高斯消元法、部分主元和全主元选择以及增长因子的定义，计算给定矩阵 $A$ 的两个增长因子 $\\rho(A,\\text{GEPP})$ 和 $\\rho(A,\\text{GECP})$。最终答案必须是写成单行矩阵的一对数值。无需四舍五入，不涉及单位。",
            "solution": "问题要求计算给定 $4 \\times 4$ 矩阵 $A$ 在部分主元高斯消元法 (GEPP) 和全主元高斯消元法 (GECP) 下的增长因子。\n\n给定的矩阵是：\n$$\nA = A^{(0)} =\n\\begin{bmatrix}\n1   0  0  1 \\\\\n-1  1  0  1 \\\\\n0   -1  1  1 \\\\\n0   0  -1  1\n\\end{bmatrix}\n$$\n增长因子定义为 $\\rho(A,\\mathcal{P}) = \\frac{\\displaystyle \\max_{k,i,j} \\left| a_{ij}^{(k)} \\right|}{\\displaystyle \\max_{i,j} \\left| a_{ij}^{(0)} \\right|}$，其中分子是任何中间矩阵中出现的所有元素的最大绝对值，分母是初始矩阵中所有元素的最大绝对值。\n\n首先，我们确定分母。$A^{(0)}$ 的元素来自集合 $\\{1, 0, -1\\}$。这些元素的最大绝对值是：\n$$\n\\max_{i,j} |a_{ij}^{(0)}| = 1\n$$\n因此，对于任何主元选择策略 $\\mathcal{P}$，增长因子简化为：\n$$\n\\rho(A,\\mathcal{P}) = \\max_{k,i,j} |a_{ij}^{(k)}|\n$$\n这是在消元过程中（包括初始矩阵和所有中间矩阵）遇到的任何元素的最大幅值。我们将跟踪这个最大值，称之为 $M$，并初始化为 $M=1$。\n\n### 部分主元高斯消元法 (GEPP)\n\n**步骤 $k=1$：**\n我们检查 $A^{(0)}$ 的第一列：$[1, -1, 0, 0]^T$。最大绝对值为 $1$，出现在第 $1$ 行和第 $2$ 行。GEPP 的平局决胜规则选择索引最小的行，所以我们选择 $a_{11}^{(0)}=1$ 作为主元。不需要进行行置换。\n乘数为 $m_{21} = \\frac{-1}{1} = -1$，$m_{31}=0$ 和 $m_{41}=0$。消元步骤是更新第 $2$ 行：$R_2 \\to R_2 - m_{21} R_1 = R_2 + R_1$。\n$R_2' = [-1, 1, 0, 1] + [1, 0, 0, 1] = [0, 1, 0, 2]$。\n步骤 $1$ 后的矩阵是：\n$$\nA^{(1)} = \\begin{bmatrix}\n1   0  0  1 \\\\\n0   1  0  2 \\\\\n0   -1  1  1 \\\\\n0   0  -1  1\n\\end{bmatrix}\n$$\n$A^{(1)}$ 的元素中包含一个新值 $2$。到目前为止出现的最大绝对值为 $M = \\max(1, |2|) = 2$。\n\n**步骤 $k=2$：**\n我们在第二列中从第 $2$ 行开始向下寻找主元：$[1, -1, 0]^T$。最大绝对值为 $1$，出现在第 $2$ 行和第 $3$ 行。平局决胜规则选择第 $2$ 行，所以主元是 $a_{22}^{(1)}=1$。不需要进行行置换。\n乘数为 $m_{32} = \\frac{-1}{1} = -1$ 和 $m_{42}=0$。消元步骤是 $R_3 \\to R_3 - m_{32} R_2 = R_3 + R_2$。\n$R_3' = [0, -1, 1, 1] + [0, 1, 0, 2] = [0, 0, 1, 3]$。\n步骤 $2$ 后的矩阵是：\n$$\nA^{(2)} = \\begin{bmatrix}\n1   0  0  1 \\\\\n0   1  0  2 \\\\\n0   0  1  3 \\\\\n0   0  -1  1\n\\end{bmatrix}\n$$\n新出现的元素是 $3$。当前的最大绝对值为 $M = \\max(2, |3|) = 3$。\n\n**步骤 $k=3$：**\n我们在第三列中从第 $3$ 行开始向下寻找主元：$[1, -1]^T$。最大绝对值为 $1$，出现在第 $3$ 行和第 $4$ 行。平局决胜规则选择第 $3$ 行，所以主元是 $a_{33}^{(2)}=1$。不需要进行行置换。\n乘数为 $m_{43} = \\frac{-1}{1} = -1$。消元步骤是 $R_4 \\to R_4 - m_{43}R_3 = R_4 + R_3$。\n$R_4' = [0, 0, -1, 1] + [0, 0, 1, 3] = [0, 0, 0, 4]$。\n最终的上三角矩阵是：\n$$\nA^{(3)} = U = \\begin{bmatrix}\n1   0  0  1 \\\\\n0   1  0  2 \\\\\n0   0  1  3 \\\\\n0   0  0  4\n\\end{bmatrix}\n$$\n新出现的元素是 $4$。当前的最大绝对值变为 $M = \\max(3, |4|) = 4$。\n\n在所有矩阵 $A^{(0)}, A^{(1)}, A^{(2)}, A^{(3)}$ 中，最大绝对值为 $4$。\n因此，GEPP 的增长因子是 $\\rho(A,\\text{GEPP}) = 4$。\n\n### 全主元高斯消元法 (GECP)\n\n**步骤 $k=1$：**\n我们搜索整个矩阵 $A^{(0)}$ 以寻找绝对值最大的元素。最大绝对值为 $1$。有多个这样的元素。GECP 的平局决胜规则是选择行索引最小的，然后是列索引最小的。这对应于 $a_{11}^{(0)}=1$。所以，主元是 $1$。不需要进行置换。\n这一步与 GEPP 相同。步骤 $1$ 后的矩阵是：\n$$\nA^{(1)} = \\begin{bmatrix}\n1   0  0  1 \\\\\n0   1  0  2 \\\\\n0   -1  1  1 \\\\\n0   0  -1  1\n\\end{bmatrix}\n$$\n遇到的最大绝对值为 $M = 2$。\n\n**步骤 $k=2$：**\n我们在后继子矩阵 $A^{(1)}_{2:4, 2:4}$ 中寻找主元：\n$$\nS_2 = \\begin{bmatrix} 1  0  2 \\\\ -1  1  1 \\\\ 0  -1  1 \\end{bmatrix}\n$$\n$S_2$ 中绝对值最大的元素是 $2$，位于完整矩阵 $A^{(1)}$ 的 $(2,4)$ 位置。我们必须将这个元素移动到主元位置 $(2,2)$。这需要交换第 $2$ 列和第 $4$ 列。由于该元素已在最小行索引（第 $2$ 行）中，因此不需要行交换。我们将置换后的矩阵记为 $\\tilde{A}^{(1)}$：\n$$\n\\tilde{A}^{(1)} = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  0  1 \\\\\n0  1  1  -1 \\\\\n0  1  -1  0\n\\end{bmatrix}\n$$\n这个矩阵中的最大绝对值仍然是 $2$。主元是 $p_2 = 2$。\n乘数为 $m_{32} = \\frac{1}{2}$ 和 $m_{42} = \\frac{1}{2}$。\n$R_3 \\to R_3 - \\frac{1}{2}R_2$: $[0, 1, 1, -1] - \\frac{1}{2}[0, 2, 0, 1] = [0, 0, 1, -3/2]$。\n$R_4 \\to R_4 - \\frac{1}{2}R_2$: $[0, 1, -1, 0] - \\frac{1}{2}[0, 2, 0, 1] = [0, 0, -1, -1/2]$。\n步骤 $2$ 后的矩阵是：\n$$\nA^{(2)} = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  0  1 \\\\\n0  0  1  -3/2 \\\\\n0  0  -1  -1/2\n\\end{bmatrix}\n$$\n新元素的幅值为 $|1|, |-3/2|=1.5, |-1|=1, |-1/2|=0.5$。到目前为止所有元素的最大幅值仍然是 $M = 2$。\n\n**步骤 $k=3$：**\n我们搜索子矩阵 $A^{(2)}_{3:4, 3:4}$：\n$$\nS_3 = \\begin{bmatrix} 1  -3/2 \\\\ -1  -1/2 \\end{bmatrix}\n$$\n最大绝对值为 $|-3/2| = 1.5$，位于 $A^{(2)}$ 的 $(3,4)$ 位置。这个元素成为主元。我们交换第 $3$ 列和第 $4$ 列，将其移到 $(3,3)$ 位置。\n置换后的矩阵是：\n$$\n\\tilde{A}^{(2)} = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  1  0 \\\\\n0  0  -3/2  1 \\\\\n0  0  -1/2  -1\n\\end{bmatrix}\n$$\n这个矩阵中的最大绝对值仍然是 $2$。主元是 $p_3 = -3/2$。\n乘数为 $m_{43} = \\frac{-1/2}{-3/2} = 1/3$。\n$R_4 \\to R_4 - \\frac{1}{3}R_3$: $[0, 0, -1/2, -1] - \\frac{1}{3}[0, 0, -3/2, 1] = [0, 0, 0, -4/3]$。\n最终的矩阵是：\n$$\nA^{(3)} = U = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  1  0 \\\\\n0  0  -3/2  1 \\\\\n0  0  0  -4/3\n\\end{bmatrix}\n$$\n新元素是 $-4/3$。其绝对值约为 $1.33$。$A^{(3)}$ 中的最大绝对值为 $2$。\n在 GECP 过程中遇到的所有矩阵集合是 $A^{(0)}, A^{(1)}, \\tilde{A}^{(1)}, A^{(2)}, \\tilde{A}^{(2)}, A^{(3)}$。所有这些矩阵的所有元素的最大绝对值为 $2$。\n因此，GECP 的增长因子是 $\\rho(A,\\text{GECP}) = 2$。\n\n计算出的两个增长因子是 $\\rho(A,\\text{GEPP}) = 4$ 和 $\\rho(A,\\text{GECP}) = 2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4   2\n\\end{pmatrix}\n}\n$$"
        }
    ]
}