{
    "hands_on_practices": [
        {
            "introduction": "我们首先通过一个特殊但极具启发性的场景来开启我们的实践：当右侧向量 $b$ 与矩阵 $A$ 的列空间完全正交时。这个思想实验  将问题简化至其本质，揭示了 $A$ 的零空间与所有最小二乘解集合之间的根本联系。理解这个特例为解决更一般性的问题提供了清晰的几何直觉。",
            "id": "3571433",
            "problem": "考虑一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其零空间非平凡 $\\mathcal{N}(A) \\neq \\{0\\}$，以及一个向量 $b \\in \\mathbb{R}^{m}$ 满足 $b \\perp \\mathcal{R}(A)$，其中 $\\mathcal{R}(A)$ 表示 $A$ 的值域（列空间），$\\perp$ 表示正交。在最小二乘问题中，我们寻求对所有 $x \\in \\mathbb{R}^{n}$ 最小化欧几里得范数 $\\|A x - b\\|_{2}$。目的是分析最小化子的结构、残差范数以及与最小范数选择的相互作用。\n为了使讨论更具体，也考虑一个具体的设计 $A = \\mathrm{diag}(1,0,0) \\in \\mathbb{R}^{3 \\times 3}$ 和 $b = (0,1,-2)^\\top \\in \\mathbb{R}^{3}$，该设计满足 $b \\perp \\mathcal{R}(A)$ 和 $\\mathcal{N}(A) \\neq \\{0\\}$。此外，检验极端情况 $A = 0 \\in \\mathbb{R}^{m \\times n}$。\n下列哪个陈述是正确的？请选择所有适用的选项。\n\nA. 对于任意实矩阵 $A \\in \\mathbb{R}^{m \\times n}$（其零空间 $\\mathcal{N}(A) \\neq \\{0\\}$）和任意满足 $b \\perp \\mathcal{R}(A)$ 的向量 $b \\in \\mathbb{R}^m$，每个 $x \\in \\mathbb{R}^n$ 都能最小化 $\\|A x - b\\|_2$，即所有 $x$ 都是最小二乘最小化子。\n\nB. 在相同条件下，最小残差范数等于 $\\|b\\|_2$，且最小二乘最小化子的集合等于 $\\mathcal{N}(A)$。\n\nC. 每当 $b \\perp \\mathcal{R}(A)$ 时，Moore-Penrose 伪逆 $A^{\\dagger}$ 给出最小范数最小二乘解 $x^{\\star} = A^{\\dagger} b = 0$。\n\nD. 如果 $A = 0$（零矩阵），那么 $\\|A x - b\\|_2$ 与 $x$ 无关，因此每个 $x \\in \\mathbb{R}^n$ 都是最小二乘最小化子，且最小范数最小二乘解是 $x^{\\star} = 0$。\n\nE. 在具体设计 $A = \\mathrm{diag}(1,0,0)$ 和 $b = (0,1,-2)^\\top$ 中，正规方程组 $A^\\top A x = A^\\top b$ 有唯一解 $x = (0,0,0)^\\top$。\n\nF. 对于任意 $\\lambda > 0$，每当 $b \\perp \\mathcal{R}(A)$ 时，Tikhonov 正则化解 $x_{\\lambda} = (A^\\top A + \\lambda I)^{-1} A^\\top b$ 等于 $0$。\n\nG. 对于任意满足 $b \\perp \\mathcal{R}(A)$ 的 $A$ 和 $b$，在最小范数最小二乘解 $x^{\\star}$ 处的残差向量等于 $b$ 并且与 $\\mathcal{R}(A)$ 正交。",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n**问题验证**\n\n1.  **提取的已知条件**：\n    *   $A \\in \\mathbb{R}^{m \\times n}$ 是一个实矩阵。\n    *   $A$ 的零空间非平凡：$\\mathcal{N}(A) \\neq \\{0\\}$。\n    *   $b \\in \\mathbb{R}^{m}$ 是一个实向量。\n    *   $b$ 与 $A$ 的值域（列空间）正交：$b \\perp \\mathcal{R}(A)$。\n    *   目标是针对所有 $x \\in \\mathbb{R}^{n}$ 最小化欧几里得范数 $\\|A x - b\\|_{2}$。\n    *   具体案例 1：$A = \\mathrm{diag}(1,0,0) \\in \\mathbb{R}^{3 \\times 3}$ 和 $b = (0,1,-2)^\\top \\in \\mathbb{R}^{3}$。\n    *   具体案例 2：$A = 0 \\in \\mathbb{R}^{m \\times n}$。\n\n2.  **验证分析**：\n    *   该问题是**有科学依据的**和**客观的**。它是在线性代数和数值分析的标准数学框架内表述的。所有术语，如零空间、值域、正交性、最小二乘、伪逆和 Tikhonov 正则化，都是良定义的。\n    *   该问题是**适定的**和**自洽的**。给定条件足以分析最小二乘解的性质。条件 $b \\perp \\mathcal{R}(A)$ 等价于 $b$ 在 $A$ 的左零空间中，即 $b \\in \\mathcal{N}(A^\\top)$，这意味着 $A^\\top b = 0$。这是一个一致的数学设定。\n    *   提供的具体例子是有效的，并且与一般条件一致。对于 $A = \\mathrm{diag}(1,0,0)$，$\\mathcal{R}(A)$ 是由第一个标准基向量 $e_1 = (1,0,0)^\\top$ 张成的空间。向量 $b = (0,1,-2)^\\top$ 确实与 $\\mathcal{R}(A)$ 正交，因为 $b^\\top e_1 = 0$。此外，$\\mathcal{N}(A)$ 是由 $\\{e_2, e_3\\}$ 张成的空间，这是非平凡的。对于 $A=0$，$\\mathcal{R}(A)=\\{0\\}$，因此任何向量 $b$ 都与 $\\mathcal{R}(A)$ 正交。这些例子可作为有效的说明。\n    *   该问题没有表现出说明中列出的任何缺陷（例如，科学上不健全、模糊、矛盾）。\n\n3.  **结论**：问题陈述是**有效的**。\n\n**一般性质的推导**\n\n最小二乘问题旨在找到最小化残差范数平方 $\\|A x - b\\|_2^2$ 的 $x$。向量空间 $\\mathbb{R}^m$ 可以分解为 $A$ 的列空间及其正交补的正交直和：$\\mathbb{R}^m = \\mathcal{R}(A) \\oplus \\mathcal{R}(A)^\\perp$。列空间的正交补是左零空间，即 $\\mathcal{R(A)}^\\perp = \\mathcal{N}(A^\\top)$。\n\n任何向量 $b \\in \\mathbb{R}^m$ 都可以唯一地写为 $b = b_{\\mathcal{R}} + b_{\\mathcal{N}}$，其中 $b_{\\mathcal{R}} = P_{\\mathcal{R}(A)}b \\in \\mathcal{R}(A)$ 是 $b$ 在 $\\mathcal{R}(A)$ 上的正交投影，而 $b_{\\mathcal{N}} = b - b_{\\mathcal{R}} \\in \\mathcal{N}(A^\\top)$。\n\n残差范数的平方可以重写为：\n$$ \\|A x - b\\|_2^2 = \\|A x - (b_{\\mathcal{R}} + b_{\\mathcal{N}})\\|_2^2 = \\|(A x - b_{\\mathcal{R}}) - b_{\\mathcal{N}}\\|_2^2 $$\n由于 $A x \\in \\mathcal{R}(A)$ 且 $b_{\\mathcal{R}} \\in \\mathcal{R}(A)$，它们的差 $(A x - b_{\\mathcal{R}})$ 也在 $\\mathcal{R}(A)$ 中。向量 $b_{\\mathcal{N}}$ 在 $\\mathcal{N}(A^\\top) = \\mathcal{R}(A)^\\perp$ 中。根据勾股定理，对于正交向量，我们有：\n$$ \\|A x - b\\|_2^2 = \\|A x - b_{\\mathcal{R}}\\|_2^2 + \\|b_{\\mathcal{N}}\\|_2^2 $$\n问题给出的条件是 $b \\perp \\mathcal{R}(A)$。这意味着 $b$ 已经在 $\\mathcal{R}(A)$ 的正交补中，所以 $b \\in \\mathcal{N}(A^\\top)$。这意味着它在 $\\mathcal{R}(A)$ 上的投影是零向量，$b_{\\mathcal{R}} = 0$，并且 $b_{\\mathcal{N}} = b$。\n\n将这些代入残差范数的表达式中得到：\n$$ \\|A x - b\\|_2^2 = \\|A x - 0\\|_2^2 + \\|b\\|_2^2 = \\|A x\\|_2^2 + \\|b\\|_2^2 $$\n为了最小化 $\\|A x - b\\|_2^2$，必须最小化 $\\|A x\\|_2^2$，因为 $\\|b\\|_2^2$ 是一个常数。$\\|A x\\|_2^2$ 的最小可能值是 $0$。当且仅当 $A x = 0$ 时，达到这个最小值，根据定义，这意味着 $x$ 在 $A$ 的零空间中，即 $x \\in \\mathcal{N}(A)$。\n\n基于此推导：\n1.  所有最小二乘最小化子的集合是 $\\mathcal{N}(A)$。\n2.  残差范数的最小值是 $\\sqrt{0 + \\|b\\|_2^2} = \\|b\\|_2$。\n3.  最小范数最小二乘解 $x^{\\star}$ 是最小化子集合 $\\mathcal{N}(A)$ 中欧几里得范数最小的向量。由于 $\\mathcal{N}(A)$ 是一个子空间，范数最小的唯一元素是零向量，$x^{\\star} = 0$。\n\n**逐项分析**\n\n**A. 对于任意实矩阵 $A \\in \\mathbb{R}^{m \\times n}$（其零空间 $\\mathcal{N}(A) \\neq \\{0\\}$）和任意满足 $b \\perp \\mathcal{R}(A)$ 的向量 $b \\in \\mathbb{R}^m$，每个 $x \\in \\mathbb{R}^n$ 都能最小化 $\\|A x - b\\|_2$，即所有 $x$ 都是最小二乘最小化子。**\n如上所推导，最小化子的集合是 $\\mathcal{N}(A)$。该陈述声称该集合是 $\\mathbb{R}^n$。这仅在 $\\mathcal{N}(A) = \\mathbb{R}^n$ 时成立，这意味着 $A=0$。该陈述必须对任何具有非平凡零空间的 $A$ 都成立，而不仅仅是 $A=0$。对于具体设计 $A = \\mathrm{diag}(1,0,0)$，$\\mathcal{N}(A)$ 是由 $(0,1,0)^\\top$ 和 $(0,0,1)^\\top$ 张成的空间。如果我们取 $x=(1,0,0)^\\top \\notin \\mathcal{N}(A)$，那么 $\\|Ax\\|_2 = \\|(1,0,0)^\\top\\|_2 = 1 > 0$。任何 $x' \\in \\mathcal{N}(A)$ 都得到 $\\|Ax'\\|_2=0$。因此，$x$ 不是一个最小化子。\n**结论：不正确。**\n\n**B. 在相同条件下，最小残差范数等于 $\\|b\\|_2$，且最小二乘最小化子的集合等于 $\\mathcal{N}(A)$。**\n这个陈述与我们的推导完全相符。最小残差范数是 $\\|b\\|_2$，且达到这个最小值的向量 $x$ 的集合恰好是满足 $Ax=0$ 的那些向量，即 $x \\in \\mathcal{N}(A)$。\n**结论：正确。**\n\n**C. 每当 $b \\perp \\mathcal{R}(A)$ 时，Moore-Penrose 伪逆 $A^{\\dagger}$ 给出最小范数最小二乘解 $x^{\\star} = A^{\\dagger} b = 0$。**\nMoore-Penrose 伪逆 $A^{\\dagger}$ 通过 $x^{\\star} = A^{\\dagger}b$ 提供了唯一的最小范数最小二乘解。根据我们的推导，最小范数解是 $x^{\\star}=0$。因此，必然有 $A^{\\dagger}b = 0$。这可以直接证明：条件 $b \\perp \\mathcal{R}(A)$ 意味着 $b \\in \\mathcal{N}(A^\\top)$。乘积 $A^{\\dagger}b$ 将 $b$ 投影到 $\\mathcal{R}(A^\\top)$ 上，但由于 $b \\in \\mathcal{N}(A^\\top) = \\mathcal{R}(A^\\top)^\\perp$，这个投影是零向量。或者，使用奇异值分解 $A = U\\Sigma V^\\top$，我们有 $A^{\\dagger} = V\\Sigma^{\\dagger}U^\\top$。$b \\in \\mathcal{N}(A^\\top)$ 意味着 $U^\\top b$ 的前 $r=\\mathrm{rank}(A)$ 个分量为零。由于 $\\Sigma^{\\dagger}$ 仅在其前 $r$ 个对角线位置有非零项，乘积 $\\Sigma^{\\dagger} (U^\\top b)$ 是零向量。因此 $x^{\\star} = V(\\Sigma^{\\dagger}U^\\top b) = V \\cdot 0 = 0$。\n**结论：正确。**\n\n**D. 如果 $A = 0$（零矩阵），那么 $\\|A x - b\\|_2$ 与 $x$ 无关，因此每个 $x \\in \\mathbb{R}^n$ 都是最小二乘最小化子，且最小范数最小二乘解是 $x^{\\star} = 0$。**\n如果 $A=0$，那么对于任何 $x \\in \\mathbb{R}^n$，$Ax=0$。需要最小化的量是 $\\|0 \\cdot x - b\\|_2 = \\|-b\\|_2 = \\|b\\|_2$。这个值对于所有 $x$ 都是常数。因此，每个 $x \\in \\mathbb{R}^n$ 都是最小二乘最小化子。最小化子的集合是 $\\mathbb{R}^n$。最小范数解 $x^{\\star}$ 是 $\\mathbb{R}^n$ 中范数最小的向量，即零向量，$x^{\\star}=0$。该陈述完全正确。这是我们一般性发现的一个特例，其中 $\\mathcal{N}(A) = \\mathbb{R}^n$。\n**结论：正确。**\n\n**E. 在具体设计 $A = \\mathrm{diag}(1,0,0)$ 和 $b = (0,1,-2)^\\top$ 中，正规方程组 $A^\\top A x = A^\\top b$ 有唯一解 $x = (0,0,0)^\\top$。**\n所有最小二乘最小化子的集合是正规方程组的解集。对于这个具体设计，$A^\\top = A = \\mathrm{diag}(1,0,0)$。\n$A^\\top A = A^2 = A = \\mathrm{diag}(1,0,0)$。\n$A^\\top b = \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n正规方程组是 $A x = 0$。\n$$ \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n该方程组意味着 $x_1=0$，而 $x_2$ 和 $x_3$ 可以是任意实数。解集是 $\\{ (0, x_2, x_3)^\\top \\mid x_2, x_3 \\in \\mathbb{R} \\}$，也就是 $A$ 的零空间。这个集合包含无限多个解。关于解是唯一的陈述是错误的。\n**结论：不正确。**\n\n**F. 对于任意 $\\lambda > 0$，每当 $b \\perp \\mathcal{R}(A)$ 时，Tikhonov 正则化解 $x_{\\lambda} = (A^\\top A + \\lambda I)^{-1} A^\\top b$ 等于 $0$。**\n条件 $b \\perp \\mathcal{R}(A)$ 等价于 $b \\in \\mathcal{N}(A^\\top)$，这意味着 $A^\\top b = 0$。将此代入 Tikhonov 公式：\n$ x_{\\lambda} = (A^\\top A + \\lambda I)^{-1} (A^\\top b) = (A^\\top A + \\lambda I)^{-1} \\cdot 0 $。\n对于 $\\lambda > 0$，矩阵 $A^\\top A + \\lambda I$ 是对称正定的，因此是可逆的。任何矩阵乘以零向量结果都是零向量。因此，$x_{\\lambda} = 0$。\n**结论：正确。**\n\n**G. 对于任意满足 $b \\perp \\mathcal{R}(A)$ 的 $A$ 和 $b$，在最小范数最小二乘解 $x^{\\star}$ 处的残差向量等于 $b$ 并且与 $\\mathcal{R}(A)$ 正交。**\n如前所述，最小范数最小二乘解是 $x^{\\star}=0$。对应的残差向量是 $r = A x^{\\star} - b = A(0) - b = -b$。该陈述声称残差是 $b$。这仅在 $-b=b$ 时成立，这意味着 $b=0$。由于该陈述必须对任何满足条件的 $b$ 都成立，因此它是错误的。例如，使用具体设计，$b=(0,1,-2)^\\top$，残差是 $-(0,1,-2)^\\top = (0,-1,2)^\\top \\neq b$。该声明的第二部分，即残差与 $\\mathcal{R}(A)$ 正交，是正确的，因为如果 $b \\perp \\mathcal{R}(A)$，那么 $-b \\perp \\mathcal{R}(A)$。然而，由于合取式的第一部分是假的，整个陈述是假的。\n**结论：不正确。**",
            "answer": "$$\\boxed{BCDF}$$"
        },
        {
            "introduction": "理论分析至关重要，但实际应用需要一种数值稳定的算法来计算解。这个练习  将指导你使用奇异值分解 (Singular Value Decomposition, SVD) 来实现一个秩亏最小二乘问题的求解器，SVD 是最可靠的方法。你将学会通过设置恰当的容差来处理数值秩亏问题，这是开发稳健的科学计算软件的一项关键技能。",
            "id": "3271561",
            "problem": "您的任务是设计并实现一个鲁棒的求解器，用于解决秩亏最小二乘问题。该求解器需使用奇异值分解（Singular Value Decomposition, SVD），其中奇异值分解定义为将一个实数矩阵分解为正交因子和对角因子的过程。该数学问题如下：给定一个实数矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和一个实数向量 $b \\in \\mathbb{R}^{m}$，计算一个向量 $x \\in \\mathbb{R}^{n}$，以最小化残差的欧几里得范数，即 $\\lVert A x - b \\rVert_2$，即使在 $A$ 是秩亏或接近秩亏的情况下也要能求解。您的实现必须通过使用基于SVD的方法，以数值稳定的方式解决此问题，并且必须返回最小欧几里得范数解。该求解器必须通过选择一个与机器精度和问题规模相关的原则性数值公差来处理秩亏情况，以决定哪些奇异值应被视为零。不允许使用正规方程或任何会使条件数平方的方法。\n\n此任务的基本依据包括：\n- 最小二乘的欧几里得范数最小化定义，$\\min_{x \\in \\mathbb{R}^n} \\lVert A x - b \\rVert_2$。\n- 通过奇异值分解（SVD）对实数矩阵进行分解，$A = U \\Sigma V^\\top$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 的对角线元素为非负数，称为奇异值。\n- 与使用机器精度 $\\epsilon$ 的浮点运算相关的数值秩和条件数概念。\n\n实现一个程序，该程序：\n- 使用基于SVD的伪逆计算最小欧几里得范数最小二乘解，通过将在与 $\\epsilon$ 和 $A$ 的尺度相关的公差下被视为数值上可忽略的奇异值置零，从而鲁棒地处理秩亏情况。\n- 将此求解器应用于以下固定的矩阵和向量测试套件。对于每个测试用例，返回解向量 $x$ 的分量，四舍五入到8位小数。\n\n测试套件：\n- 案例1（秩亏，相容）：\n  $$A_1 = \\begin{bmatrix} 1  2 \\\\ 2  4 \\\\ 3  6 \\end{bmatrix}, \\quad b_1 = \\begin{bmatrix} 3 \\\\ 6 \\\\ 9 \\end{bmatrix}.$$\n- 案例2（秩亏，不相容）：\n  $$A_2 = \\begin{bmatrix} 1  2 \\\\ 2  4 \\\\ 3  6 \\end{bmatrix}, \\quad b_2 = \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\end{bmatrix}.$$\n- 案例3（零矩阵边界情况）：\n  $$A_3 = \\begin{bmatrix} 0  0 \\\\ 0  0 \\\\ 0  0 \\end{bmatrix}, \\quad b_3 = \\begin{bmatrix} 1 \\\\ -2 \\\\ 3 \\end{bmatrix}.$$\n- 案例4（接近秩亏，需在数值上谨慎处理小的奇异值）：\n  $$A_4 = \\begin{bmatrix} 1  (1 + 10^{-16}) \\\\ 2  (2 + 2 \\cdot 10^{-16}) \\\\ 3  (3 + 3 \\cdot 10^{-16}) \\end{bmatrix}, \\quad b_4 = \\begin{bmatrix} 2 \\\\ 4 \\\\ 6 \\end{bmatrix}.$$\n- 案例5（满秩，超定）：\n  $$A_5 = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix}, \\quad b_5 = \\begin{bmatrix} 1 \\\\ 2 \\\\ 3 \\end{bmatrix}.$$\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[result_1,result_2,\\dots]$）。\n- 每个元素 $result_k$ 本身必须是一个列表，表示案例 $k$ 的解向量 $x$，其分量需四舍五入到8位小数，并以十进制数（而非分数）形式呈现。\n- 因此，输出必须采用格式 $[[x_{1,1},x_{1,2}], [x_{2,1},x_{2,2}], [x_{3,1},x_{3,2}], [x_{4,1},x_{4,2}], [x_{5,1},x_{5,2}]]$，并且行内任何地方都不能有空格。",
            "solution": "目标是为给定的实数矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和实数向量 $b \\in \\mathbb{R}^m$，找到最小二乘问题 $\\min_{x} \\lVert A x - b \\rVert_2$ 的最小欧几里得范数解 $x \\in \\mathbb{R}^n$。此问题需要使用基于奇异值分解（SVD）的数值鲁棒方法来解决，当矩阵 $A$ 是秩亏或病态时，该方法尤其有效。明确禁止使用会使条件数平方的方法，例如构建正规方程 $A^\\top A x = A^\\top b$。\n\n该方法的基础是矩阵 $A$ 的奇异值分解（SVD）：\n$$A = U \\Sigma V^\\top$$\n其中：\n- $U \\in \\mathbb{R}^{m \\times m}$ 是一个正交矩阵（$U^\\top U = I_m$），其列 $\\mathbf{u}_i$ 是左奇异向量。\n- $V \\in \\mathbb{R}^{n \\times n}$ 是一个正交矩阵（$V^\\top V = I_n$），其列 $\\mathbf{v}_i$ 是右奇异向量。\n- $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是一个矩形对角矩阵，其对角线上的非负实数被称为奇异值 $\\sigma_i$。它们按 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_r > 0$ 的顺序排列，其中 $r$ 是 $A$ 的秩。所有其他奇异值为零。\n\n将SVD代入最小二乘目标函数，我们寻求最小化：\n$$\\lVert A x - b \\rVert_2 = \\lVert U \\Sigma V^\\top x - b \\rVert_2$$\n欧几里得范数在乘以正交矩阵时保持不变。因此，我们可以将范数内的项乘以 $U^\\top$ 而不改变其值：\n$$\\lVert U \\Sigma V^\\top x - b \\rVert_2 = \\lVert U^\\top (U \\Sigma V^\\top x - b) \\rVert_2 = \\lVert (U^\\top U) \\Sigma V^\\top x - U^\\top b \\rVert_2 = \\lVert \\Sigma V^\\top x - U^\\top b \\rVert_2$$\n为了简化这个表达式，我们引入变量替换。令 $y = V^\\top x$。因为 $V$ 是正交的，我们有 $x = V y$。此外，$x$ 的范数得以保留：$\\lVert x \\rVert_2 = \\lVert V y \\rVert_2 = \\lVert y \\rVert_2$。因此，寻找 $x$ 的最小范数解等价于寻找 $y$ 的最小范数解。\n令 $\\hat{b} = U^\\top b$。问题转化为最小化 $\\lVert \\Sigma y - \\hat{b} \\rVert_2$。\n\n范数的平方由下式给出：\n$$\\lVert \\Sigma y - \\hat{b} \\rVert_2^2 = \\sum_{i=1}^{\\min(m, n)} (\\sigma_i y_i - \\hat{b}_i)^2 + \\sum_{i=\\min(m, n)+1}^{m} \\hat{b}_i^2$$\n第二项是最终残差的一部分，且与 $y$ 无关。为了最小化范数，我们必须最小化第一项。\n- 对于奇异值 $\\sigma_i > 0$ 的索引 $i$（即 $i=1, \\dots, r$），通过将该项设为零来达到最小值：$\\sigma_i y_i - \\hat{b}_i = 0$，这得出 $y_i = \\hat{b}_i / \\sigma_i$。\n- 对于 $\\sigma_i = 0$ 的索引 $i$（即 $i=r+1, \\dots, n$），该项变为 $(0 \\cdot y_i - \\hat{b}_i)^2 = \\hat{b}_i^2$。$y_i$ 的值是任意的，不影响残差范数。\n\n为了找到具有最小欧几里得范数 $\\lVert x \\rVert_2 = \\lVert y \\rVert_2$ 的解，我们必须选择 $y$ 的分量以最小化 $\\lVert y \\rVert_2^2 = \\sum_{i=1}^n y_i^2$。对于 $i=1, \\dots, r$，$y_i = \\hat{b}_i / \\sigma_i$ 的值是固定的。为了最小化平方和，$y$ 的其余任意分量必须设为零。因此，对于 $i=r+1, \\dots, n$，我们设置 $y_i=0$。\n\n$y$ 的最小范数解的分量为：\n$$y_i = \\begin{cases} \\hat{b}_i / \\sigma_i,  \\text{if } \\sigma_i > 0 \\\\ 0,  \\text{if } \\sigma_i = 0 \\end{cases}$$\n这个结果可以用 $A$ 的 Moore-Penrose 伪逆表示，记作 $A^\\dagger = V \\Sigma^\\dagger U^\\top$。这里，$\\Sigma^\\dagger \\in \\mathbb{R}^{n \\times m}$ 是 $\\Sigma$ 的伪逆，其非零对角线元素为 $(\\Sigma^\\dagger)_{ii} = 1/\\sigma_i$（对于 $\\sigma_i > 0$）。解即为 $x = A^\\dagger b = V \\Sigma^\\dagger U^\\top b$。\n\n在数值计算中，由于浮点表示误差，理论上为零的奇异值可能会计算为非常小的非零数。用这些小数相除会导致数值不稳定。为了解决这个问题，我们通过引入一个公差 $\\tau$ 来定义数值秩。任何小于 $\\tau$ 的奇异值 $\\sigma_i$ 都被视为零。对此公差的一个原则性选择是将其与机器精度 $\\epsilon_{\\text{machine}}$ 和问题规模联系起来：\n$$\\tau = \\max(m, n) \\cdot \\sigma_1 \\cdot \\epsilon_{\\text{machine}}$$\n其中 $\\sigma_1$ 是最大的奇异值。\n\n算法如下：\n1. 给定 $A$ 和 $b$，计算 SVD：$A = U \\Sigma V^\\top$。这将得到 $U$、奇异值向量 $s$ 和 $V^\\top$。\n2. 如果 $A$ 是零矩阵（即所有奇异值均为零），则最小范数解为 $x=0$。\n3. 否则，确定公差 $\\tau = \\max(m, n) \\cdot s[0] \\cdot \\epsilon_{\\text{machine}}$。\n4. 将数值秩 $r$ 确定为大于或等于 $\\tau$ 的奇异值 $s_i$ 的数量。\n5. 对于每个满足 $s_i \\ge \\tau$ 的奇异值 $s_i$，我们计算解基向量 $\\mathbf{v}_i$ 的相应系数：$c_i = (\\mathbf{u}_i^\\top b) / s_i$。\n6. 最终解是前 $r$ 个右奇异向量的线性组合，权重为这些系数：\n$$x = \\sum_{i=1}^{r} \\frac{\\mathbf{u}_i^\\top b}{\\sigma_i} \\mathbf{v}_i$$\n此过程以数值稳定的方式构建了最小范数最小二乘解，通过截断可忽略的奇异值来正确处理秩亏和病态情况。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a set of rank-deficient least squares problems using SVD.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (rank-deficient, consistent)\n        (np.array([[1.0, 2.0], [2.0, 4.0], [3.0, 6.0]]),\n         np.array([3.0, 6.0, 9.0])),\n\n        # Case 2 (rank-deficient, inconsistent)\n        (np.array([[1.0, 2.0], [2.0, 4.0], [3.0, 6.0]]),\n         np.array([1.0, 1.0, 1.0])),\n\n        # Case 3 (zero matrix boundary)\n        (np.array([[0.0, 0.0], [0.0, 0.0], [0.0, 0.0]]),\n         np.array([1.0, -2.0, 3.0])),\n\n        # Case 4 (nearly rank-deficient, numerically treat small singular values carefully)\n        (np.array([[1.0, 1.0 + 1e-16], \n                   [2.0, 2.0 + 2e-16], \n                   [3.0, 3.0 + 3e-16]]),\n         np.array([2.0, 4.0, 6.0])),\n\n        # Case 5 (full rank, overdetermined)\n        (np.array([[1.0, 0.0], [0.0, 1.0], [1.0, 1.0]]),\n         np.array([1.0, 2.0, 3.0]))\n    ]\n\n    results = []\n    \n    for A, b in test_cases:\n        m, n = A.shape\n        \n        # Compute the Singular Value Decomposition\n        U, s, Vt = np.linalg.svd(A)\n\n        # Handle the case of a zero matrix or matrix with no non-zero singular values.\n        # The SVD of a zero matrix might result in an empty 's' array if m or n is 0,\n        # or s[0] will be 0.\n        if not s.size or np.isclose(s[0], 0):\n            x = np.zeros(n)\n            results.append(np.round(x, 8).tolist())\n            continue\n\n        # Define the tolerance for treating singular values as zero.\n        # This is a standard choice in numerical linear algebra.\n        tol = np.max(A.shape) * s[0] * np.finfo(float).eps\n        \n        # Determine the numerical rank by counting singular values above the tolerance.\n        rank = np.sum(s > tol)\n        \n        if rank == 0:\n            # If all singular values are below tolerance, treat as a zero matrix.\n            x = np.zeros(n)\n        else:\n            # The solution x is given by sum_{i=1 to r} (u_i^T * b / s_i) * v_i\n            # This is equivalent to V_r @ diag(1/s_r) @ U_r.T @ b\n            \n            # 1. Take the first 'rank' singular values and invert them.\n            s_inv = 1.0 / s[:rank]\n            \n            # 2. Compute U.T @ b and take the first 'rank' components.\n            # U has shape (m, m), b has shape (m,), so U.T @ b has shape (m,).\n            c = U.T @ b\n            c = c[:rank]\n            \n            # 3. Compute coefficients for the linear combination of V's columns.\n            # This is equivalent to diag(1/s_r) @ U_r.T @ b\n            x_coeffs = s_inv * c\n            \n            # 4. Compute the solution x by combining the first 'rank' columns of V (which are rows of Vt).\n            # Vt has shape (n, n). Vt[:rank].T gives the first 'rank' columns of V.\n            x = Vt[:rank].T @ x_coeffs\n        \n        # Round the components of the solution vector to 8 decimal places.\n        rounded_x = np.round(x, 8).tolist()\n        results.append(rounded_x)\n\n    # Format the final output string according to the specification.\n    # The str() representation of a list includes spaces, which need to be removed.\n    output_str = f\"[{','.join(str(r) for r in results)}]\"\n    output_str = output_str.replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一个常见的误解是，最小二乘解会随着问题数据的平滑变化而平滑变化。我们的最后一个练习  将揭示一个令人惊讶但重要的反例：最小范数解可能是非连续的。通过分析从矩阵中移除列所产生的影响，我们将看到矩阵秩的变化如何导致解的突然跳变，这突显了秩亏问题敏感的本质。",
            "id": "3571427",
            "problem": "考虑秩亏最小二乘问题，其矩阵 $A \\in \\mathbb{R}^{2 \\times 3}$ 和右端项 $b \\in \\mathbb{R}^{2}$ 由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1  0 \\\\\n0  0  1\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n$A$ 的三个列向量为 $a_{1} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，$a_{2} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 和 $a_{3} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。最小二乘目标是对于 $x \\in \\mathbb{R}^{3}$ 最小化 $\\|A x - b\\|_{2}$，并定义 $x^{\\dagger}$ 为最小范数解（即在所有最小化解中具有最小欧几里得范数的唯一解）。列删除序列的定义是：首先移除第3列形成 $A^{(1)} \\in \\mathbb{R}^{2 \\times 2}$，然后移除第2列形成 $A^{(2)} \\in \\mathbb{R}^{2 \\times 1}$。为了在不同删除步骤间进行比较，将解嵌入到 $\\mathbb{R}^{3}$ 中，方法是在被删除列的位置用零填充。\n\n仅使用摩尔-彭罗斯伪逆、到列空间的正交投影以及正规方程组的核心定义，并从基本的最小二乘关系出发，推导删除序列中每个矩阵的 $x^{\\dagger}$。确定每次删除下零空间维度的变化。在每个步骤中，通过格拉姆矩阵（预解式）的摩尔-彭罗斯伪逆，即 $(A^{\\top}A)^{\\dagger}$，跟踪最小范数解的变化，以解释第二次删除引起的 $x^{\\dagger}$ 的不连续性。\n\n计算在上述序列中删除第2列前后，嵌入的最小范数解之间的跳跃的精确欧几里得范数。请以单个精确值的形式给出最终答案。不需要四舍五入。",
            "solution": "该问题是适定的，具有科学依据，并包含唯一解所需的所有信息。我们按要求进行推导。\n\n最小二乘问题旨在找到一个向量 $x$，使得残差的欧几里得范数 $\\|Ax-b\\|_2$ 最小。所有这些最小化解的集合由正规方程组 $A^\\top A x = A^\\top b$ 的解给出。如果系统是秩亏的，则有无穷多个解。最小范数解，记为 $x^{\\dagger}$，是同时最小化 $\\|x\\|_2$ 的唯一解。该解位于 $A$ 的行空间 $\\mathcal{R}(A^\\top)$ 中，并由 $x^\\dagger = A^\\dagger b$ 给出，其中 $A^\\dagger$ 是 $A$ 的摩尔-彭罗斯伪逆。伪逆的一个核心恒等式是 $A^\\dagger = (A^\\top A)^\\dagger A^\\top$。\n\n**步骤1：对原始矩阵 $A$ 的分析**\n\n初始矩阵和向量为：\n$$\nA = \\begin{pmatrix} 1  1  0 \\\\ 0  0  1 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 3}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\in \\mathbb{R}^{2}\n$$\n$A$ 的列向量为 $a_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$a_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $a_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。由于 $a_1 = a_2$，这些列是线性相关的。$A$ 的秩为 $\\text{rank}(A) = 2$，因为 $\\{a_1, a_3\\}$ 构成了 $\\mathbb{R}^2$ 的一个基。该矩阵是秩亏的，因为它的秩小于列数（$2  3$）。零空间维度是 $\\dim(\\mathcal{N}(A)) = n - \\text{rank}(A) = 3 - 2 = 1$。为了找到零空间，我们求解 $Ax=0$，得到方程 $x_1+x_2 = 0$ 和 $x_3=0$。因此，$\\mathcal{N}(A) = \\text{span}\\left\\{ \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix} \\right\\}$。\n\n由于 $b = a_1$，$b$ 在 $A$ 的列空间中，所以系统 $Ax=b$ 是相容的，最小残差为 $0$。解集为 $\\{x \\in \\mathbb{R}^3 \\mid x_1+x_2=1, x_3=0\\}$。任意解都可以写成 $x(c) = x_p + x_h = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} + c \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}$ 的形式，其中 $c \\in \\mathbb{R}$ 是某个标量。为了找到最小范数解 $x^\\dagger_A$，我们最小化 $\\|x(c)\\|_2^2$：\n$$\n\\|x(c)\\|_2^2 = (1+c)^2 + (-c)^2 + 0^2 = 1 + 2c + 2c^2\n$$\n对 $c$ 进行最小化：$\\frac{d}{dc}(1+2c+2c^2) = 2+4c = 0 \\implies c = -1/2$。\n原始问题的最小范数解为：\n$$\nx^\\dagger_A = \\begin{pmatrix} 1 - 1/2 \\\\ -(-1/2) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\end{pmatrix}\n$$\n\n**步骤2：第一次删除后的分析（矩阵 $A^{(1)}$）**\n\n从 $A$ 中移除第3列，形成 $A^{(1)} \\in \\mathbb{R}^{2 \\times 2}$：\n$$\nA^{(1)} = \\begin{pmatrix} 1  1 \\\\ 0  0 \\end{pmatrix}\n$$\n$A^{(1)}$ 的列向量相同，所以 $\\text{rank}(A^{(1)})=1$。零空间维度是 $\\dim(\\mathcal{N}(A^{(1)})) = 2-1 = 1$。零空间是 $\\mathcal{N}(A^{(1)}) = \\text{span}\\left\\{ \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\right\\}$。零空间维度保持不变，但其所在的环境空间从 $\\mathbb{R}^3$ 变为 $\\mathbb{R}^2$。\n对于 $A^{(1)}$ 和右端项 $b$ 的最小二乘问题也是相容的。解集为 $\\{x \\in \\mathbb{R}^2 \\mid x_1+x_2=1\\}$。最小范数解的计算与 $x_A^\\dagger$ 的前两个分量的计算相同，得到：\n$$\nx^{\\dagger}_{A^{(1)}} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n将该解嵌入到 $\\mathbb{R}^3$ 中，通过用零填充被删除的第三个分量，得到：\n$$\nx^{(1)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\end{pmatrix}\n$$\n我们观察到 $x^{(1)} = x^\\dagger_A$。第一次删除没有改变最小范数解。\n\n**步骤3：第二次删除后的分析（矩阵 $A^{(2)}$）**\n\n从 $A^{(1)}$ 中移除第2列，形成 $A^{(2)} \\in \\mathbb{R}^{2 \\times 1}$：\n$$\nA^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n该矩阵仅包含一个非零列，因此是列满秩的，其秩为 $\\text{rank}(A^{(2)})=1$。零空间维度发生显著变化：$\\dim(\\mathcal{N}(A^{(2)})) = n - \\text{rank}(A^{(2)}) = 1-1=0$。零空间是平凡的，$\\mathcal{N}(A^{(2)}) = \\{0\\}$。\n对于一个满秩矩阵，最小二乘问题有唯一解，由正规方程组给出：$(A^{(2)})^\\top A^{(2)} x_1 = (A^{(2)})^\\top b$。\n$$(A^{(2)})^\\top A^{(2)} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$$\n$$(A^{(2)})^\\top b = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$$\n正规方程为 $1 \\cdot x_1 = 1$，得出唯一解 $x_1=1$。这就是最小范数解。\n$$\nx^{\\dagger}_{A^{(2)}} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\n将该解嵌入到 $\\mathbb{R}^3$ 中，通过用零填充被删除的第二和第三列，得到：\n$$\nx^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n解从 $x^{(1)}$ 不连续地跳跃到了 $x^{(2)}$。\n\n**步骤4：通过预解式 $(A^\\top A)^\\dagger$ 解释不连续性**\n\n我们在每个步骤分析格拉姆矩阵（预解式）的伪逆。\n对于 $A^{(1)}$，格拉姆矩阵是 $G^{(1)} = (A^{(1)})^\\top A^{(1)} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\end{pmatrix}\\begin{pmatrix} 1  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$。该矩阵是奇异的。其特征值为 $\\lambda_1=2, \\lambda_2=0$，对应的特征向量为 $u_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $u_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。伪逆由非零特征值及其特征向量构造：\n$$\n(G^{(1)})^\\dagger = \\frac{1}{\\lambda_1} u_1 u_1^\\top = \\frac{1}{2}\\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\\right)\\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix}\\right) = \\frac{1}{4}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n对于 $A^{(2)}$，格拉姆矩阵是 $G^{(2)} = (A^{(2)})^\\top A^{(2)} = \\begin{pmatrix} 1 \\end{pmatrix}$。这是一个满秩矩阵。其伪逆就是其逆：$(G^{(2)})^\\dagger = (1)^{-1} = 1$。\n\n解 $x^\\dagger$ 的不连续性是在秩不恒定的矩阵处矩阵伪逆运算不连续的直接后果。从 $A^{(1)}$ 中删除第2列使其从一个秩亏矩阵变为一个满秩矩阵。这对应于格拉姆矩阵从 $G^{(1)}$ 变为 $G^{(2)}$。$G^{(1)}$ 的伪逆不是一个更大矩阵伪逆的简单子块，并且其元素与其子矩阵的伪逆没有连续关系。具体来说，$(G^{(1)})^\\dagger_{11} = 1/4$，而 $(G^{(2)})^\\dagger = 1$。因为解 $x^\\dagger$ 直接依赖于这个预解式，所以 $(A^\\top A)^\\dagger$ 的不连续性会传递到解中。\n\n从根本上说，对于秩亏问题 $A^{(1)}$，最小范数解通过分配解的分量来最小化 $\\|x\\|_2$ 来满足 $x_1+x_2=1$，从而得到 $x_1=x_2=1/2$。删除第2列后，相应的变量 $x_2$ 被约束为 $0$。对于 $A^{(2)}$ 的问题将全部“负载”施加到 $x_1$ 上，得到 $x_1=1$。这种从秩亏情况下的分布式解到满秩情况下的局部化解的变化导致了跳跃。\n\n**步骤5：计算跳跃幅度**\n解的跳跃是删除第2列前后的嵌入最小范数解之差。\n删除前的解：$x^{(1)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\end{pmatrix}$。\n删除后的解：$x^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n跳跃向量是 $\\Delta x = x^{(2)} - x^{(1)} = \\begin{pmatrix} 1 - 1/2 \\\\ 0 - 1/2 \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -1/2 \\\\ 0 \\end{pmatrix}$。\n该跳跃的欧几里得范数是：\n$$\n\\|\\Delta x\\|_2 = \\sqrt{\\left(\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + 0^2} = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{2}{4}} = \\sqrt{\\frac{1}{2}} = \\frac{\\sqrt{2}}{2}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{2}}{2}}\n$$"
        }
    ]
}