{
    "hands_on_practices": [
        {
            "introduction": "掌握任何一种克雷洛夫子空间方法的第一步都是要理解其核心的投影过程。对于为对称系统设计的MINRES和SYMMLQ方法，其基础是对称Lanczos过程，它能将原矩阵三对角化。这个练习将带你亲手计算Lanczos过程的初始几个步骤，为后续更复杂的算法分析打下坚实的计算基础 。",
            "id": "3560312",
            "problem": "考虑线性系统 $A x = b$，其中矩阵 $A$ 是对称不定的：\n$$A=\\begin{bmatrix}210\\\\1-11\\\\010\\end{bmatrix}$$\n右端项为\n$$b=\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}。$$\n对于对称不定系统，最小残差法 (Minimal Residual Method, MINRES) 和对称LQ方法 (Symmetric LQ method, SYMMLQ) 都建立在对称 Lanczos 过程之上。该过程通过三项递推关系为 Krylov 子空间 $\\mathcal{K}_k(A,r_0)$（其中 $r_0=b-Ax_0$）生成一组标准正交基 $\\{v_j\\}$，并将 $A$ 三对角化。从零初始猜测 $x_0=\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}$ 开始，不使用预处理，采用欧几里得范数，并使用常规的 Lanczos 初始化 $v_1=r_0/\\|r_0\\|$，执行前两个 Lanczos 步骤，并显式计算前三个 Lanczos 系数 $\\alpha_1$、$\\beta_1$ 和 $\\alpha_2$。请提供精确值（不要四舍五入）。您的最终答案必须按顺序依次列出 $\\alpha_1$、$\\beta_1$ 和 $\\alpha_2$。",
            "solution": "该问题是有效的。这是一个适定的数值线性代数问题，要求针对给定的对称不定矩阵和右端项，计算对称 Lanczos 过程生成的前三个系数。所有必要信息都已提供，且前提条件在事实上是正确的。\n\n对称 Lanczos 过程生成一个标准正交向量序列 $\\{v_j\\}$ 和一个对称三对角矩阵 $T_k$，其元素是 Lanczos 系数 $\\alpha_j$ 和 $\\beta_j$。矩阵 $A$ 与这些量之间的关系由矩阵方程 $A V_k = V_k T_k + \\beta_k v_{k+1} e_k^T$ 给出，其中 $V_k = [v_1, v_2, \\dots, v_k]$，$T_k$ 是一个 $k \\times k$ 的对称三对角矩阵。\n$$T_k = \\begin{pmatrix} \\alpha_1  \\beta_1     \\\\ \\beta_1  \\alpha_2  \\beta_2  \\\\   \\beta_2  \\ddots  \\ddots \\\\    \\ddots  \\alpha_{k-1}  \\beta_{k-1} \\\\    \\beta_{k-1}  \\alpha_k \\end{pmatrix}$$\n算法流程如下：\n1.  初始化：从一个初始猜测 $x_0$ 开始。计算初始残差 $r_0 = b - A x_0$。将其归一化以得到第一个 Lanczos 向量：$v_1 = r_0 / \\|r_0\\|_2$。\n2.  迭代：对于 $j = 1, 2, \\dots, k$：\n    a. 计算矩阵向量乘积 $w_j = A v_j$。\n    b. 对角系数为 $\\alpha_j = v_j^T w_j$。\n    c. 计算下一个未归一化的向量。对于 $j=1$，为 $\\hat{v}_{j+1} = w_j - \\alpha_j v_j$。对于 $j1$，为 $\\hat{v}_{j+1} = w_j - \\alpha_j v_j - \\beta_j v_{j-1}$。\n    d. 次对角系数是该向量的范数：$\\beta_j = \\|\\hat{v}_{j+1}\\|_2$。\n    e. 如果 $\\beta_j = 0$，算法终止。否则，进行归一化以得到下一个 Lanczos 向量：$v_{j+1} = \\hat{v}_{j+1} / \\beta_j$。\n\n题目要求我们执行前两个步骤来求解 $\\alpha_1$、$\\beta_1$ 和 $\\alpha_2$。\n\n**初始化**\n\n给定的矩阵为 $A=\\begin{bmatrix}210\\\\1-11\\\\010\\end{bmatrix}$，右端项为 $b=\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$。\n初始猜测是零向量，$x_0=\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}$。\n\n初始残差 $r_0$ 为：\n$$r_0 = b - A x_0 = b - 0 = \\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$$\n$r_0$ 的欧几里得范数为：\n$$\\|r_0\\|_2 = \\sqrt{1^2 + 0^2 + 1^2} = \\sqrt{2}$$\n第一个 Lanczos 向量 $v_1$ 为：\n$$v_1 = \\frac{r_0}{\\|r_0\\|_2} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$$\n\n**第一个 Lanczos 步骤（求解 $\\alpha_1$ 和 $\\beta_1$）**\n\n首先，我们计算矩阵向量乘积 $w_1 = A v_1$：\n$$w_1 = A v_1 = \\begin{bmatrix}210\\\\1-11\\\\010\\end{bmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}2(1)+1(0)+0(1)\\\\1(1)-1(0)+1(1)\\\\0(1)+1(0)+0(1)\\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}2\\\\2\\\\0\\end{bmatrix} = \\sqrt{2} \\begin{bmatrix}1\\\\1\\\\0\\end{bmatrix}$$\n接下来，我们计算系数 $\\alpha_1$：\n$$\\alpha_1 = v_1^T w_1 = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}101\\end{bmatrix} \\right) \\left( \\sqrt{2} \\begin{bmatrix}1\\\\1\\\\0\\end{bmatrix} \\right) = (1)(1) + (0)(1) + (1)(0) = 1$$\n现在，我们为下一步计算未归一化的向量 $\\hat{v}_2$：\n$$\\hat{v}_2 = w_1 - \\alpha_1 v_1 = \\sqrt{2} \\begin{bmatrix}1\\\\1\\\\0\\end{bmatrix} - (1) \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\left( 2 \\begin{bmatrix}1\\\\1\\\\0\\end{bmatrix} - \\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}2-1\\\\2-0\\\\0-1\\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1\\\\2\\\\-1\\end{bmatrix}$$\n系数 $\\beta_1$ 是 $\\hat{v}_2$ 的范数：\n$$\\beta_1 = \\|\\hat{v}_2\\|_2 = \\left\\| \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1\\\\2\\\\-1\\end{bmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{2}} \\sqrt{1^2 + 2^2 + (-1)^2} = \\frac{1}{\\sqrt{2}} \\sqrt{1+4+1} = \\frac{\\sqrt{6}}{\\sqrt{2}} = \\sqrt{3}$$\n我们通过归一化 $\\hat{v}_2$ 得到第二个 Lanczos 向量 $v_2$：\n$$v_2 = \\frac{\\hat{v}_2}{\\beta_1} = \\frac{1}{\\sqrt{3}} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1\\\\2\\\\-1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{6}} \\begin{bmatrix}1\\\\2\\\\-1\\end{bmatrix}$$\n\n**第二个 Lanczos 步骤（求解 $\\alpha_2$）**\n\n我们进入第二个步骤来求解 $\\alpha_2$。首先，我们计算 $w_2 = A v_2$：\n$$w_2 = A v_2 = \\begin{bmatrix}210\\\\1-11\\\\010\\end{bmatrix} \\left( \\frac{1}{\\sqrt{6}} \\begin{bmatrix}1\\\\2\\\\-1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{6}} \\begin{bmatrix}2(1)+1(2)+0(-1)\\\\1(1)-1(2)+1(-1)\\\\0(1)+1(2)+0(-1)\\end{bmatrix} = \\frac{1}{\\sqrt{6}} \\begin{bmatrix}4\\\\-2\\\\2\\end{bmatrix}$$\n系数 $\\alpha_2$ 由内积 $\\alpha_2 = v_2^T w_2$ 给出：\n$$\\alpha_2 = v_2^T w_2 = \\left( \\frac{1}{\\sqrt{6}} \\begin{bmatrix}12-1\\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}} \\begin{bmatrix}4\\\\-2\\\\2\\end{bmatrix} \\right) = \\frac{1}{6} \\left( (1)(4) + (2)(-2) + (-1)(2) \\right) = \\frac{1}{6} (4 - 4 - 2) = -\\frac{2}{6} = -\\frac{1}{3}$$\n题目只要求计算 $\\alpha_1$、$\\beta_1$ 和 $\\alpha_2$。我们现在已经计算出所有需要的系数。\n\n结果总结：\n第一个对角系数是 $\\alpha_1 = 1$。\n第一个次对角系数是 $\\beta_1 = \\sqrt{3}$。\n第二个对角系数是 $\\alpha_2 = -1/3$。\n题目要求提供精确值，我们已经提供了。\n得到的 $2 \\times 2$ 三对角矩阵是 $T_2 = \\begin{pmatrix} 1  \\sqrt{3} \\\\ \\sqrt{3}  -1/3 \\end{pmatrix}$。\n\n所求的 Lanczos 系数为：\n$\\alpha_1 = 1$\n$\\beta_1 = \\sqrt{3}$\n$\\alpha_2 = -\\frac{1}{3}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\sqrt{3}  -\\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在熟悉了Lanczos过程后，我们可以进一步探究一个完整的迭代算法是如何运作的。本练习将以一个简单的二维问题为例，引导你完整地执行两步MINRES迭代，包括通过吉文斯旋转（Givens rotation）求解最小二乘子问题。通过这个实践 ，你将看到MINRES如何系统地最小化残差范数，并最终精确地求解线性系统。",
            "id": "3560282",
            "problem": "设 $A \\in \\mathbb{R}^{2 \\times 2}$ 是对称不定的，其中 $A=\\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix}$，并且设 $b=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$。考虑在精确算术下，从 $x_0=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$ 开始，对线性系统 $A x = b$ 应用对称系统的最小残差方法（MINRES）。\n\n从下面的基本定义出发，精确执行两次 MINRES 迭代，并确定迭代解 $x_2$ 和残差的 $2$-范数 $\\|r_2\\|_2$，其中 $r_k=b-Ax_k$。\n\n使用的基本定义：\n1. 初始残差为 $r_0=b-Ax_0$，其中 $\\beta_1=\\|r_0\\|_2$ 且 $v_1=r_0/\\beta_1$。\n2. 对称 Lanczos 过程通过以下方式构建标准正交向量 $v_j$ 和标量 $\\alpha_j, \\beta_{j+1}$\n   $$\\beta_{j+1} v_{j+1} = A v_j - \\alpha_j v_j - \\beta_j v_{j-1}, \\quad \\alpha_j = v_j^{\\mathsf{T}} A v_j, \\quad v_0=0,$$\n   生成三对角矩阵 $T_k$，其对角线元素为 $\\alpha_j$，次/超对角线元素为 $\\beta_{j+1}$。\n3. MINRES 迭代解 $x_k$ 位于 Krylov 子空间 $\\mathcal{K}_k(A,r_0)=\\operatorname{span}\\{r_0, A r_0, \\dots, A^{k-1} r_0\\}$ 中，并最小化残差范数。记 $x_k = V_k y_k$，$V_k=[v_1,\\dots,v_k]$，最小化残差的系数 $y_k$ 求解最小二乘问题\n   $$\\min_{y \\in \\mathbb{R}^k} \\left\\| \\beta_1 e_1 - \\bar{T}_k y \\right\\|_2,$$\n   其中 $\\bar{T}_k \\in \\mathbb{R}^{(k+1)\\times k}$ 是在 $T_k$ 的基础上增加了次对角线元素 $\\beta_{k+1}$ 得到的增广矩阵。\n4. Givens 旋转 $G(c,s)$ 作用于两个分量，通过以下方式消去一个元素\n   $$\\begin{bmatrix} c  s \\\\ -s  c \\end{bmatrix} \\begin{bmatrix} a \\\\ b \\end{bmatrix} = \\begin{bmatrix} \\sqrt{a^2+b^2} \\\\ 0 \\end{bmatrix}, \\quad c=\\dfrac{a}{\\sqrt{a^2+b^2}}, \\quad s=\\dfrac{b}{\\sqrt{a^2+b^2}},$$\n   并应用于 $\\bar{T}_k$ 的行和右侧向量，以维持一个等价的上三角最小二乘问题。经过 $k$ 次迭代后，残差范数等于变换后右侧向量最后一个分量的绝对值。\n\n明确地进行推导：为 $k=1,2$ 构建 Lanczos 标量和向量，为 $k=1$ 和 $k=2$ 构造最小二乘问题，构建并应用必要的 Givens 旋转（使用精确的余弦和正弦值），求解系数 $y_k$，并恢复出 $x_k=V_k y_k$ 以及 $k=2$ 时的 $\\|r_k\\|_2$。报告精确的 $x_2$ 和 $\\|r_2\\|_2$。不需要四舍五入。你的最终答案必须是三元组 $(x_{2,1}, x_{2,2}, \\|r_2\\|_2)$，形式为一个单行矩阵。",
            "solution": "我们从初始数据开始。初始迭代解为 $x_0=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$，所以初始残差为\n$$\nr_0=b-Ax_0=b=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}.\n$$\n其范数为 $\\beta_1=\\|r_0\\|_2=1$，因此\n$$\nv_1=\\frac{r_0}{\\beta_1}=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}.\n$$\n\n我们继续对称 Lanczos 过程。如上初始化 $v_0=0$ 和 $\\beta_1$。\n\n对于 $j=1$，计算\n$$\nw = A v_1 - \\beta_1 v_0 = \\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix} \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} - 1 \\cdot \\begin{bmatrix}0 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\n然后\n$$\n\\alpha_1 = v_1^{\\mathsf{T}} A v_1 = \\begin{bmatrix}1  0\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = 0,\n$$\n正交化后的向量是 $w - \\alpha_1 v_1 = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$。其范数给出\n$$\n\\beta_2 = \\left\\| \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} \\right\\|_2 = 1, \\quad v_2 = \\frac{1}{\\beta_2} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\n\n对于 $j=2$，计算\n$$\nw = A v_2 - \\beta_2 v_1 = \\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} - 1 \\cdot \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} - \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}.\n$$\n因此\n$$\n\\alpha_2 = v_2^{\\mathsf{T}} A v_2 = \\begin{bmatrix}0  1\\end{bmatrix} \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} = 0, \\quad \\beta_3 = \\| w - \\alpha_2 v_2 \\|_2 = \\| 0 \\|_2 = 0.\n$$\n\n因此，$2 \\times 2$ 的三对角矩阵为\n$$\nT_2 = \\begin{bmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix},\n$$\n用于最小二乘问题的增广矩阵为\n$$\n\\bar{T}_2 = \\begin{bmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\\\ 0  \\beta_3 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ 1  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n我们还有 $V_2 = [v_1, v_2] = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix}$ 且 $\\beta_1 = 1$。\n\nMINRES 迭代解 $x_k$ 由 $x_k = V_k y_k$ 给出，其中 $y_k$ 最小化残差范数\n$$\n\\left\\| \\beta_1 e_1 - \\bar{T}_k y \\right\\|_2.\n$$\n我们逐次迭代，构建并应用 Givens 旋转来三角化最小二乘系统。\n\n迭代 $k=1$。矩阵 $\\bar{T}_1$ 是 $\\bar{T}_2$ 的第一列，\n$$\n\\bar{T}_1 = \\begin{bmatrix} \\alpha_1 \\\\ \\beta_2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\n$$\n最小二乘问题是\n$$\n\\min_{y_1 \\in \\mathbb{R}} \\left\\| \\beta_1 e_1 - \\bar{T}_1 y_1 \\right\\|_2 = \\min_{y_1 \\in \\mathbb{R}} \\left\\| \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} - \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} y_1 \\right\\|_2 = \\min_{y_1} \\sqrt{ (1 - 0 \\cdot y_1)^2 + (0 - y_1)^2 } = \\min_{y_1} \\sqrt{1 + y_1^2}.\n$$\n显然，最小化解是 $y_1=0$，得到 $x_1 = V_1 y_1 = v_1 \\cdot 0 = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$ 且 $\\|r_1\\|_2 = 1$。\n\n等价地，通过 Givens 旋转，我们使用作用于第1行和第2行的 $G_1$ 来消去 $\\bar{T}_1$ 中的次对角线元素。当 $a=\\alpha_1=0$ 且 $b=\\beta_2=1$ 时，我们有\n$$\n\\rho_1 = \\sqrt{a^2 + b^2} = 1, \\quad c_1 = \\frac{a}{\\rho_1} = 0, \\quad s_1 = \\frac{b}{\\rho_1} = 1,\n$$\n并且\n$$\nG_1 = \\begin{bmatrix} c_1  s_1  0 \\\\ -s_1  c_1  0 \\\\ 0  0  1 \\end{bmatrix} = \\begin{bmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  1 \\end{bmatrix}.\n$$\n将 $G_1$ 应用于 $\\bar{T}_1$ 得到 $\\begin{bmatrix} \\rho_1 \\\\ 0 \\\\ 0 \\end{bmatrix}$，并将 $G_1$ 应用于右侧向量 $g=\\begin{bmatrix}\\beta_1 \\\\ 0 \\\\ 0\\end{bmatrix}=\\begin{bmatrix}1 \\\\ 0 \\\\ 0\\end{bmatrix}$ 得到变换后的向量\n$$\n\\begin{bmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{bmatrix} = G_1 g = \\begin{bmatrix} c_1 \\beta_1 \\\\ -s_1 \\beta_1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1 \\\\ 0 \\end{bmatrix}.\n$$\n一次迭代后的残差范数为 $|\\phi_2|=1$，这证实了最小二乘的结果和 $x_1=0$。\n\n迭代 $k=2$。我们现在考虑 $\\bar{T}_2$ 并对其应用 $G_1$：\n$$\nG_1 \\bar{T}_2 = \\begin{bmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  1 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  0 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  -1 \\\\ 0  0 \\end{bmatrix}.\n$$\n第一列已经是上三角形式，首项为 $\\rho_1=1$。对于第二列，为消去第3行中的次对角线元素，我们构建作用于第2行和第3行的 $G_2$，使用对 $(a,b)=(\\alpha_2', \\beta_3')=(-1,0)$。因此\n$$\n\\rho_2 = \\sqrt{a^2 + b^2} = 1, \\quad c_2 = \\frac{a}{\\rho_2} = -1, \\quad s_2 = \\frac{b}{\\rho_2} = 0,\n$$\n并且\n$$\nG_2 = \\begin{bmatrix} 1  0  0 \\\\ 0  c_2  s_2 \\\\ 0  -s_2  c_2 \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{bmatrix}.\n$$\n应用 $G_2$ 后，我们得到三角化矩阵：\n$$\nG_2 (G_1 \\bar{T}_2) = \\begin{bmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  -1 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix}.\n$$\n将 $G_2$ 应用于先前变换过的右侧向量，得到\n$$\nG_2 \\begin{bmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} \\phi_1' \\\\ \\phi_2' \\\\ \\phi_3' \\end{bmatrix}.\n$$\n因此，完全变换后的最小二乘系统为\n$$\n\\min_{y \\in \\mathbb{R}^2} \\left\\| \\begin{bmatrix} \\phi_1' \\\\ \\phi_2' \\\\ \\phi_3' \\end{bmatrix} - \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix} y \\right\\|_2 = \\min_{y \\in \\mathbb{R}^2} \\left\\| \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} y_1 \\\\ y_2 \\\\ 0 \\end{bmatrix} \\right\\|_2 = \\min_{y} \\sqrt{ (0 - y_1)^2 + (1 - y_2)^2 }.\n$$\n唯一的最小化解是 $y_1=0$, $y_2=1$。因此，\n$$\nx_2 = V_2 y = [v_1, v_2] \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = v_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n两次迭代后的残差范数等于 $|\\phi_3'|=0$，即\n$$\n\\| r_2 \\|_2 = 0.\n$$\n\n我们得出结论，对于这个 $2 \\times 2$ 的问题，第二次 MINRES 迭代解是精确的，其中 $x_2=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$ 且 $\\|r_2\\|_2=0$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0  1  0\\end{pmatrix}}$$"
        },
        {
            "introduction": "MINRES和SYMMLQ虽然都基于Lanczos过程，但它们在求解投影子问题时采用了不同的策略，这导致了它们在稳定性和收敛行为上的差异。这个练习构造了一个特殊的病态情形，其中Lanczos生成的三对角矩阵 $T_k$ 接近奇异。通过分析并比较两种方法在该情形下的残差范数 ，你将深刻理解它们各自的代数结构如何影响算法的稳健性。",
            "id": "3560327",
            "problem": "考虑一个由小正标量 $\\varepsilon  0$ 参数化的对称三对角线性系统族。设系数矩阵为\n$$\nA(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1  1  0 \\\\\n1  1+\\varepsilon  \\varepsilon^{2} \\\\\n0  \\varepsilon^{2}  -1\n\\end{pmatrix},\n$$\n右端项为 $b = (1,0,0)^{\\top}$。从 $x_{0} = 0$ 开始，初始残差为 $r_{0} = b$，并使用对称矩阵的三项递推关系构造 Lanczos 向量，其中 $v_{1} = r_{0}/\\|r_{0}\\| = e_{1}$。用 $V_{k}$ 表示 $k$ 步后的 Lanczos 基，用 $T_{k}$ 表示该过程生成的 $k \\times k$ 对称三对角矩阵。增广三对角矩阵 $\\underline{T}_{k}$ 是一个 $(k+1)\\times k$ 矩阵，通过在位置 $(k+1,k)$ 附加次对角耦合项 $\\beta_{k+1}$ 得到。\n\n你将比较 $k=2$ 次迭代后的最小残差方法 (MINRES) 和对称 LQ 方法 (SYMMLQ)。这些方法通过标准的 Krylov 投影定义：\n- MINRES 选择 $y \\in \\mathbb{R}^{k}$ 来最小化增广残差的 $2$-范数，\n$$\n\\left\\|\\begin{pmatrix}\\beta_{1} e_{1} - T_{k} y \\\\ -\\beta_{k+1} e_{k}^{\\top} y \\end{pmatrix}\\right\\|_{2},\n$$\n其中 $\\beta_{1} = \\|b\\|_{2}$，$e_{j}$ 是第 $j$ 个坐标向量。\n- SYMMLQ 使用下三角-正交 (LQ) 分解求解三对角系统 $T_{k} y = \\beta_{1} e_{1}$，返回 Krylov 子空间中的最小长度解；完整的残差范数则为 $\\|r\\|_{2} = |\\beta_{k+1} e_{k}^{\\top} y|$。\n\n任务：\n1. 使用三项 Lanczos 递推关系，并以 $v_{1} = e_{1}$ 开始，为给定的 $A(\\varepsilon)$ 和 $b$ 显式推导 $T_{2}$ 和 $\\beta_{3}$。用 $\\varepsilon$ 表示 $T_{2}$。\n2. 仅使用 Krylov 投影关系和上述 MINRES 及 SYMMLQ 的定义（不要引入除投影和三对角结构之外的任何特定于算法的递推关系），计算 MINRES 和 SYMMLQ 在 $k=2$ 次迭代后的残差 $2$-范数，作为 $\\varepsilon$ 的函数。\n3. 定义比率\n$$\n\\rho(\\varepsilon) \\;=\\; \\frac{\\|r_{\\text{MINRES}}^{(2)}\\|_{2}}{\\|r_{\\text{SYMMLQ}}^{(2)}\\|_{2}},\n$$\n并将其简化为关于 $\\varepsilon$ 的单个封闭形式表达式。\n\n从业代数的角度，解释为什么 SYMMLQ 中基于 LQ 的求解方法与 MINRES 中基于 QR 的最小二乘法对 $T_2$ 的近奇异结构的处理方式不同，并说明这种结构性差异如何体现在你推导出的表达式中。你的解释应基于 $2\\times 2$ 三对角系统及其 $(3\\times 2)$ 增广形式。\n\n你的最终答案必须是 $\\rho(\\varepsilon)$ 的简化解析表达式。不需要四舍五入，也不需要报告单位。",
            "solution": "用户希望我在提供完整解答之前，对问题陈述进行批判性验证。\n该问题是有效的。它在数值线性代数方面有科学依据，问题陈述清晰，信息充分，可得到唯一解，并使用客观、正式的语言表述。这是一个标准问题，比较了两种著名的 Krylov 子空间方法——MINRES 和 SYMMLQ——在一个特定的对称不定系统上的表现。陈述中没有矛盾、歧义或伪科学主张。\n\n解答按问题陈述要求分为三个部分。\n\n第 1 部分：Lanczos 递推\n给定矩阵 $A(\\varepsilon)$、右端项 $b$ 和初始猜测 $x_{0}$。\n$$\nA(\\varepsilon) = \\begin{pmatrix} 1  1  0 \\\\ 1  1+\\varepsilon  \\varepsilon^{2} \\\\ 0  \\varepsilon^{2}  -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n初始残差为 $r_{0} = b - Ax_{0} = b$。Lanczos 过程从归一化 $r_0$ 开始。\n范数为 $\\beta_{1} = \\|r_{0}\\|_{2} = \\|(1,0,0)^{\\top}\\|_{2} = 1$。\n第一个 Lanczos 向量是 $v_{1} = r_{0}/\\beta_{1} = (1,0,0)^{\\top} = e_{1}$。\n\n第一次迭代 ($k=1$)：\n我们计算 $w_{1} = A v_{1} = A e_{1}$，即 $A(\\varepsilon)$ 的第一列。\n$$\nw_{1} = (1, 1, 0)^{\\top}\n$$\n$T_k$ 的第一个对角元素是 $\\alpha_{1} = v_{1}^{\\top} w_{1} = e_{1}^{\\top} (1, 1, 0)^{\\top} = 1$。\n下一个未归一化的 Lanczos 向量计算为 $\\hat{r}_{1} = w_{1} - \\alpha_{1} v_{1}$。\n$$\n\\hat{r}_{1} = (1, 1, 0)^{\\top} - 1 \\cdot (1, 0, 0)^{\\top} = (0, 1, 0)^{\\top}\n$$\n$T_k$ 的第一个次对角元素是 $\\beta_{2} = \\|\\hat{r}_{1}\\|_{2} = \\|(0, 1, 0)^{\\top}\\|_{2} = 1$。\n第二个 Lanczos 向量是 $v_{2} = \\hat{r}_{1}/\\beta_{2} = (0, 1, 0)^{\\top} = e_{2}$。\n\n第二次迭代 ($k=2$)：\n我们计算 $w_{2} = A v_{2} = A e_{2}$，即 $A(\\varepsilon)$ 的第二列。\n$$\nw_{2} = (1, 1+\\varepsilon, \\varepsilon^{2})^{\\top}\n$$\n第二个对角元素是 $\\alpha_{2} = v_{2}^{\\top} w_{2} = e_{2}^{\\top} (1, 1+\\varepsilon, \\varepsilon^{2})^{\\top} = 1+\\varepsilon$。\n下一个未归一化的 Lanczos 向量是 $\\hat{r}_{2} = w_{2} - \\alpha_{2} v_{2} - \\beta_{2} v_{1}$。\n$$\n\\hat{r}_{2} = (1, 1+\\varepsilon, \\varepsilon^{2})^{\\top} - (1+\\varepsilon) \\cdot (0, 1, 0)^{\\top} - 1 \\cdot (1, 0, 0)^{\\top} = (1 - 1, 1+\\varepsilon - (1+\\varepsilon), \\varepsilon^{2})^{\\top} = (0, 0, \\varepsilon^{2})^{\\top}\n$$\n第二个次对角元素（也是与增广矩阵相关的第一个元素）是 $\\beta_{3} = \\|\\hat{r}_{2}\\|_{2} = \\|(0, 0, \\varepsilon^{2})^{\\top}\\|_{2} = |\\varepsilon^{2}| = \\varepsilon^{2}$，因为 $\\varepsilon > 0$。\n第三个 Lanczos 向量应为 $v_{3} = \\hat{r}_{2}/\\beta_{3} = (0, 0, 1)^{\\top} = e_{3}$。\n\n根据这些计算， $2 \\times 2$ 对称三对角矩阵 $T_{2}$ 为：\n$$\nT_{2} = \\begin{pmatrix} \\alpha_{1}  \\beta_{2} \\\\ \\beta_{2}  \\alpha_{2} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon \\end{pmatrix}\n$$\n并且下一步的耦合标量是 $\\beta_{3} = \\varepsilon^{2}$。\n\n第 2 部分：$k=2$ 时 MINRES 和 SYMMLQ 的残差范数\n\n对于 SYMMLQ：\n该方法通过求解投影系统 $T_{2} y = \\beta_{1} e_{1}$ 来找到 $y_{\\text{SYMMLQ}} \\in \\mathbb{R}^{2}$。\n$$\n\\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon \\end{pmatrix} \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} = 1 \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n这是一个标准的 $2 \\times 2$ 线性系统。由第一个方程，$y_{1} + y_{2} = 1$，所以 $y_{1} = 1-y_{2}$。代入第二个方程：\n$$\n(1 - y_{2}) + (1+\\varepsilon)y_{2} = 0 \\implies 1 + \\varepsilon y_{2} = 0 \\implies y_{2} = -\\frac{1}{\\varepsilon}\n$$\n这得到 $y_{1} = 1 - (-\\frac{1}{\\varepsilon}) = 1 + \\frac{1}{\\varepsilon} = \\frac{\\varepsilon+1}{\\varepsilon}$。\n解向量是 $y_{\\text{SYMMLQ}} = ((\\varepsilon+1)/\\varepsilon, -1/\\varepsilon)^{\\top}$。\nSYMMLQ 的残差范数由公式 $\\|r_{\\text{SYMMLQ}}^{(2)}\\|_{2} = |\\beta_{3} e_{2}^{\\top} y_{\\text{SYMMLQ}}| = |\\beta_{3} y_{2}|$ 给出。\n$$\n\\|r_{\\text{SYMMLQ}}^{(2)}\\|_{2} = \\left|\\varepsilon^{2} \\left(-\\frac{1}{\\varepsilon}\\right)\\right| = |-\\varepsilon| = \\varepsilon\n$$\n\n对于 MINRES：\n该方法找到 $y_{\\text{MINRES}} \\in \\mathbb{R}^{2}$，它最小化增广残差的范数。对于 $k=2$，这是：\n$$\n\\|r_{\\text{MINRES}}^{(2)}\\|_{2} = \\min_{y \\in \\mathbb{R}^{2}} \\left\\| \\begin{pmatrix} \\beta_{1} e_{1} \\\\ 0 \\end{pmatrix} - \\underline{T}_{2} y \\right\\|_{2}\n$$\n其中 $\\underline{T}_{2}$ 是 $3 \\times 2$ 增广矩阵：\n$$\n\\underline{T}_{2} = \\begin{pmatrix} T_{2} \\\\ \\beta_{3} e_{2}^{\\top} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon \\\\ 0  \\varepsilon^{2} \\end{pmatrix} \\quad \\text{且} \\quad \\beta_{1}e_{1} (\\text{在 } \\mathbb{R}^3 \\text{中}) = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这是一个线性最小二乘问题。我们可以通过使用 Givens 旋转计算 $\\underline{T}_{2}$ 的 QR 分解来求解它。\n首先，对第 1 行和第 2 行应用 Givens 旋转 $\\Omega_{1}$ 来消除 $(2,1)$ 元素。令 $c_{1} = 1/\\sqrt{1^2+1^2} = 1/\\sqrt{2}$ 且 $s_{1} = 1/\\sqrt{2}$。\n$$\n\\Omega_{1} = \\begin{pmatrix} c_{1}  s_{1}  0 \\\\ -s_{1}  c_{1}  0 \\\\ 0  0  1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1  0 \\\\ -1  1  0 \\\\ 0  0  \\sqrt{2} \\end{pmatrix}\n$$\n将此应用于 $\\underline{T}_{2}$ 和右端向量 $\\underline{b} = (1,0,0)^{\\top}$：\n$$\n\\Omega_{1} \\underline{T}_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon \\end{pmatrix} \\text{ (顶部)} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 2  2+\\varepsilon \\\\ 0  \\varepsilon \\end{pmatrix} \\implies \\Omega_{1} \\underline{T}_{2} = \\begin{pmatrix} \\sqrt{2}  \\frac{2+\\varepsilon}{\\sqrt{2}} \\\\ 0  \\frac{\\varepsilon}{\\sqrt{2}} \\\\ 0  \\varepsilon^{2} \\end{pmatrix}\n$$\n$$\n\\Omega_{1} \\underline{b} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}\n$$\n接着，对第 2 行和第 3 行应用 Givens 旋转 $\\Omega_{2}$ 来消除 $\\Omega_{1} \\underline{T}_{2}$ 的 $(3,2)$ 元素。需要旋转的元素是 $(\\varepsilon/\\sqrt{2}, \\varepsilon^{2})$。斜边长是 $h = \\sqrt{(\\varepsilon/\\sqrt{2})^{2} + (\\varepsilon^{2})^{2}} = \\sqrt{\\varepsilon^{2}/2 + \\varepsilon^{4}} = \\frac{|\\varepsilon|}{\\sqrt{2}}\\sqrt{1+2\\varepsilon^{2}} = \\frac{\\varepsilon}{\\sqrt{2}}\\sqrt{1+2\\varepsilon^{2}}$。\nGivens 参数是 $c_{2} = \\frac{\\varepsilon/\\sqrt{2}}{h} = \\frac{1}{\\sqrt{1+2\\varepsilon^{2}}}$ 和 $s_{2} = \\frac{\\varepsilon^{2}}{h} = \\frac{\\sqrt{2}\\varepsilon}{\\sqrt{1+2\\varepsilon^{2}}}$。\n$$\n\\Omega_{2} = \\begin{pmatrix} 1  0  0 \\\\ 0  c_{2}  s_{2} \\\\ 0  -s_{2}  c_{2} \\end{pmatrix}\n$$\n最小二乘残差范数是完全旋转后的右端向量 $\\Omega_{2}\\Omega_{1}\\underline{b}$ 的最后一个分量的模。\n$$\n\\Omega_{2} (\\Omega_{1} \\underline{b}) = \\begin{pmatrix} 1  0  0 \\\\ 0  c_{2}  s_{2} \\\\ 0  -s_{2}  c_{2} \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -c_{2}/\\sqrt{2} \\\\ s_{2}/\\sqrt{2} \\end{pmatrix}\n$$\n残差范数是与所得 R 因子列向量正交的那部分向量的范数，它就是最后一个分量的模。\n$$\n\\|r_{\\text{MINRES}}^{(2)}\\|_{2} = \\left| \\frac{s_{2}}{\\sqrt{2}} \\right| = \\frac{1}{\\sqrt{2}} \\frac{\\sqrt{2}\\varepsilon}{\\sqrt{1+2\\varepsilon^{2}}} = \\frac{\\varepsilon}{\\sqrt{1+2\\varepsilon^{2}}}\n$$\n\n第 3 部分：比率与解释\n比率 $\\rho(\\varepsilon)$ 是：\n$$\n\\rho(\\varepsilon) = \\frac{\\|r_{\\text{MINRES}}^{(2)}\\|_{2}}{\\|r_{\\text{SYMMLQ}}^{(2)}\\|_{2}} = \\frac{\\varepsilon / \\sqrt{1+2\\varepsilon^{2}}}{\\varepsilon} = \\frac{1}{\\sqrt{1+2\\varepsilon^{2}}}\n$$\n\n解释：\nMINRES 和 SYMMLQ 之间的代数差异根植于它们在第 $k$ 次迭代时求解的系统。\nSYMMLQ 求解 $k \\times k$ 投影系统 $T_{k}y = \\beta_{1}e_{1}$。在我们的例子中，当 $k=2$ 时，这是一个 $2 \\times 2$ 系统，矩阵为 $T_2 = \\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon \\end{pmatrix}$。该矩阵的行列式是 $\\det(T_{2}) = (1)(1+\\varepsilon) - (1)(1) = \\varepsilon$。对于一个小的正数 $\\varepsilon$，$T_{2}$ 是近奇异的。因此，求解 $T_{2}y=\\beta_{1}e_{1}$ 会产生一个具有大范数的解向量 $y_{\\text{SYMMLQ}}$，具体来说，其分量的数量级为 $O(1/\\varepsilon)$。然后，SYMMLQ 的残差范数计算为 $\\|r^{(2)}_{\\text{SYMMLQ}}\\|_{2} = |\\beta_{3} y_{2}|$。在这里，$y_{2} = -1/\\varepsilon$ 的大数值被 $\\beta_{3} = \\varepsilon^{2}$ 的小数值所抵消，从而得到残差范数为 $\\varepsilon$。$y$ 的计算与 $\\beta_{3}$ 中包含的信息完全解耦。\n\n相比之下，MINRES 通过求解涉及 $(k+1) \\times k$ 增广矩阵 $\\underline{T}_{k}$ 的最小二乘问题，来最小化 Krylov 子空间上的残差。当 $k=2$ 时，这是一个 $3 \\times 2$ 矩阵 $\\underline{T}_{2}$。$\\underline{T}_{2}$ 的第三行是 $(0, \\beta_{3}) = (0, \\varepsilon^{2})$。这个包含来自 Lanczos 过程下一步信息的附加行的存在，从根本上改变了问题。$y$ 的最小二乘解不依赖于单独对近奇异矩阵 $T_{2}$ 求逆。相反，它找到一个 $y$ 来平衡方程 $T_{2}y \\approx \\beta_{1}e_{1}$（前两行）中的误差和项 $\\beta_{3}e_{2}^{\\top}y$（第三行）的大小。实际上，这个附加行对由 $T_{2}$ 定义的病态系统起到了正则化的作用。MINRES 使用的 QR 分解过程通过混合来自 $\\underline{T}_{2}$ 所有行的信息来直接产生残差范数，从而优雅地处理了这个问题。最终的残差 $\\|r^{(2)}_{\\text{MINRES}}\\|_{2} = \\frac{\\varepsilon}{\\sqrt{1+2\\varepsilon^{2}}}$，是通过 Givens 旋转参数 $s_2$ 同时依赖于 $\\varepsilon$（来自 $T_2$）和 $\\varepsilon^2$（来自 $\\beta_3$）的函数。\n\n总之，SYMMLQ 求解一个基于 $T_{2}$ 的病态系统，然后使用 $\\beta_{3}$ 计算残差。MINRES 在增广矩阵 $\\underline{T}_{2}$ 上求解一个条件更好的最小二乘问题，将来自 $\\beta_{3}$ 的正则化信息直接整合到 $y$ 的求解过程中。这就解释了为什么得到的残差范数具有不同的代数形式。正如其定义所预期的，MINRES 的残差更小，因为对于 $\\varepsilon > 0$，有 $\\rho(\\varepsilon) = 1/\\sqrt{1+2\\varepsilon^{2}}  1$。",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{1+2\\varepsilon^{2}}}}$$"
        }
    ]
}