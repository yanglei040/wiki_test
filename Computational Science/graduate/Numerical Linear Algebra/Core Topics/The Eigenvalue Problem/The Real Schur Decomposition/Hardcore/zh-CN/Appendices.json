{
    "hands_on_practices": [
        {
            "introduction": "实舒尔分解的结构由矩阵的特征值直接决定。本练习提供了一个具体的机会，通过手动计算来建立这种联系，从矩阵的特征多项式出发，识别出与复共轭特征对相对应的规范 $2 \\times 2$ 块的参数。通过这项实践，您将加深对实舒尔分解核心定义的理解。",
            "id": "3595443",
            "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是首一多项式 $p(\\lambda) = \\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15$ 的实伴随矩阵，即\n$$\nA = \\begin{pmatrix}\n0  0  15 \\\\\n1  0  -11 \\\\\n0  1  5\n\\end{pmatrix}.\n$$\n从不变子空间和正交相似的定义出发，通过识别一个与非实数谱相关的实二维不变子空间，并为该子空间建立一个标准正交基，然后将其扩充为 $\\mathbb{R}^{3}$ 的一个标准正交基，来构造 $A$ 的实舒尔范式。在您构造的基下，实舒尔范式 $R = Q^{\\top} A Q$ 是准上三角矩阵，并包含一个与 $A$ 的共轭复特征值对对应的 $2 \\times 2$ 实数块。通过从第一性原理出发，充分论证不变子空间的选择和标准正交化过程，确定出现在该 $2 \\times 2$ 块中的参数 $\\beta$ 的精确值，该块具有典范式\n$$\n\\begin{pmatrix}\n\\alpha  \\beta \\\\\n-\\beta  \\alpha\n\\end{pmatrix}.\n$$\n请以单个实数形式提供您的最终答案。无需四舍五入。",
            "solution": "用户希望我确定给定矩阵 $A$ 的实舒尔范式中参数 $\\beta$ 的值。\n\n### 第一步：问题验证\n\n**1. 提取已知条件：**\n- 矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 是首一多项式 $p(\\lambda) = \\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15$ 的实伴随矩阵。\n- 矩阵的显式形式为 $A = \\begin{pmatrix} 0  0  15 \\\\ 1  0  -11 \\\\ 0  1  5 \\end{pmatrix}$。\n- 需要构造实舒尔范式 $R = Q^{\\top} A Q$，其中 $Q$ 是一个正交矩阵。\n- 舒尔范式 $R$ 包含一个与 $A$ 的共轭复特征值对对应的 $2 \\times 2$ 实数块。\n- 这个 $2 \\times 2$ 块具有典范式 $\\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix}$。\n- 任务是求出 $\\beta$ 的精确值。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：**该问题是数值线性代数中的一个标准练习，具体涉及实矩阵的实舒尔分解。这些概念是公认的。它在科学上是合理的。\n- **良态性：**对于任何实矩阵 $A$，都存在实舒尔分解。舒尔范式中任何块的特征值都必须是原矩阵 $A$ 的特征值。这一约束条件，加上指定的块的典范结构，确定了 $\\alpha$ 和 $|\\beta|$ 的值。问题要求求出 $\\beta$ 的“那个”值，这意味着唯一性。根据惯例，通过选择 $\\beta$ 为正来确立这种唯一性。因此，根据这个标准惯例，该问题是良态的。\n- **客观性：**该问题以精确的数学语言陈述，没有主观性。\n\n**3. 结论与行动：**\n问题是有效的。我将继续进行解答。\n\n### 第二步：解答\n\n问题要求找到矩阵 $A$ 的实舒尔范式中一个 $2 \\times 2$ 块里的参数 $\\beta$。解题过程如下：\n\n首先，我们必须确定矩阵 $A$ 的特征值。伴随矩阵的特征多项式是直接给出的。在本例中，特征多项式 $p(\\lambda)$ 已给出：\n$$p(\\lambda) = \\det(A - \\lambda I) = \\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15 = 0$$\n我们求这个多项式的根。根据有理根定理，任何整数根都必须是常数项 $-15$ 的因数。这些因数是 $\\pm 1, \\pm 3, \\pm 5, \\pm 15$。我们测试这些值：\n对于 $\\lambda=3$：\n$$p(3) = (3)^{3} - 5(3)^{2} + 11(3) - 15 = 27 - 5(9) + 33 - 15 = 27 - 45 + 33 - 15 = 60 - 60 = 0$$\n所以，$\\lambda_1 = 3$ 是一个实特征值。\n为了找到其他特征值，我们将 $p(\\lambda)$ 除以 $(\\lambda - 3)$ 进行多项式除法：\n$$ \\frac{\\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15}{\\lambda - 3} = \\lambda^2 - 2\\lambda + 5 $$\n剩下的特征值是二次方程 $\\lambda^2 - 2\\lambda + 5 = 0$ 的根。使用求根公式：\n$$ \\lambda = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(1)(5)}}{2(1)} = \\frac{2 \\pm \\sqrt{4 - 20}}{2} = \\frac{2 \\pm \\sqrt{-16}}{2} = \\frac{2 \\pm 4i}{2} = 1 \\pm 2i $$\n因此，$A$ 的特征值为 $\\lambda_1 = 3$，$\\lambda_2 = 1+2i$ 和 $\\lambda_3 = 1-2i$。\n\n根据实舒尔分解定理，对于任何实矩阵 $A$，存在一个正交矩阵 $Q$，使得 $R = Q^{\\top} A Q$ 是一个实的准上三角矩阵。$R$ 的对角线元素由与 $A$ 的实特征值对应的 $1 \\times 1$ 块和与共轭复特征值对对应的 $2 \\times 2$ 块组成。\n\n在我们的例子中，特征值为 $\\{3, 1+2i, 1-2i\\}$。实舒尔范式 $R$ 将有一个 $1 \\times 1$ 的块 $[3]$ 和一个 $2 \\times 2$ 的块，后者的特征值是共轭复数对 $\\{1+2i, 1-2i\\}$。\n\n问题指明这个 $2 \\times 2$ 块具有典范式：\n$$ R_{11} = \\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix} $$\n该块的特征值是其特征多项式的根：\n$$ \\det(R_{11} - \\lambda I) = \\det \\begin{pmatrix} \\alpha - \\lambda  \\beta \\\\ -\\beta  \\alpha - \\lambda \\end{pmatrix} = (\\alpha - \\lambda)^2 + \\beta^2 = 0 $$\n求解 $\\lambda$：\n$$ (\\lambda - \\alpha)^2 = -\\beta^2 \\implies \\lambda - \\alpha = \\pm i\\sqrt{\\beta^2} \\implies \\lambda = \\alpha \\pm i|\\beta| $$\n所以，这个典范块的特征值是 $\\{\\alpha + i|\\beta|, \\alpha - i|\\beta|\\}$。\n\n这些特征值必须等于 $A$ 的共轭复特征值对，即 $\\{1+2i, 1-2i\\}$。通过比较这两组特征值的实部和虚部，我们可以确定 $\\alpha$ 和 $|\\beta|$：\n$$ \\alpha = \\text{Re}(1 \\pm 2i) = 1 $$\n$$ |\\beta| = |\\text{Im}(1 \\pm 2i)| = | \\pm 2 | = 2 $$\n这意味着 $\\alpha = 1$ 且 $\\beta = \\pm 2$。\n\n问题要求求出“参数 $\\beta$ 的精确值”，这意味着解是唯一的。选择 $\\beta = 2$ 还是 $\\beta = -2$ 取决于为不变子空间选择的基向量的方向。然而，在数值线性代数中，一个标准的惯例是选择非对角元素的符号为正（或基于上半平面中特征值虚部的符号）。具体来说，对于一对共轭复特征值 $a \\pm ib$ 且 $b>0$，典范块通常被定义为与虚部相对应的参数就是 $b$ 本身，即正数。\n\n遵循此惯例，我们将参数 $\\beta$ 与特征值对的正虚部相关联，即 $2$。\n因此，我们有 $\\alpha=1$ 并且我们选择 $\\beta=2$。\n得到的块将是 $\\begin{pmatrix} 1  2 \\\\ -2  1 \\end{pmatrix}$，其特征值为 $1\\pm 2i$。\n\n论证的核心是，舒尔块的特征值由矩阵 A 的特征值决定。指定的舒尔块结构随后强制确定了 $\\alpha$ 和 $|\\beta|$ 的值。$\\beta$ 的唯一性通过标准惯例解决。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "与需要完整特征向量基的特征分解不同，舒尔分解的一个关键优势在于它对*任何*实矩阵都存在。本练习通过研究一个“亏损”矩阵来探讨这种稳健性。您将验证其亏损性，并看到实舒尔形式仍然可以构建，同时您还将量化其“非正规性”，这是一个对于理解数值稳定性至关重要的概念。",
            "id": "3595396",
            "problem": "考虑实数矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0\\\\\n0  0  1\\\\\n0  0  0\n\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}.\n$$\n已知该矩阵是亏损的（defective），因为它不具有完整的特征向量基。请在实舒尔分解的背景下，从第一性原理出发解决以下问题。\n\n- 仅使用“当一个矩阵的几何重数严格小于其代数重数时，该矩阵是亏损的”这一定义，验证 $A$ 是亏损的。\n- 从“对于任意实数矩阵 $A$，存在一个正交矩阵 $Q \\in \\mathbb{R}^{3 \\times 3}$ 使得 $Q^{\\mathsf{T}} A Q$ 是实上拟三角矩阵（实舒尔型）”这一基本论断出发，显式地构造一个 $A$ 的有效实舒尔分解，并解释为什么即使 $A$ 是亏损的，该分解仍然是良定义的。\n- 为了量化与正交相似下的数值稳定性相关的非正规性，定义换位子\n$$\n\\Delta \\;=\\; T^{\\mathsf{T}} T \\;-\\; T T^{\\mathsf{T}},\n$$\n其中 $T$ 是 $A$ 的一个实舒尔型，并精确计算弗罗贝尼乌斯范数 $\\lVert \\Delta \\rVert_{F}$。\n\n请给出 $\\lVert \\Delta \\rVert_{F}$ 的精确值作为最终答案，不要四舍五入。最终答案必须是单个实数或单个封闭形式的解析表达式。",
            "solution": "该问题要求对矩阵 $A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix}$ 进行三部分分析。我们首先验证问题陈述。\n\n### 问题验证\n**1. 提取已知条件：**\n- 矩阵 $A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}$。\n- 亏损矩阵的定义：至少有一个特征值的几何重数严格小于其代数重数。\n- 实舒尔分解：对于一个实数矩阵 $A$，存在一个正交矩阵 $Q \\in \\mathbb{R}^{3 \\times 3}$ 使得 $T = Q^{\\mathsf{T}} A Q$ 是实上拟三角矩阵。\n- 换位子定义：$\\Delta = T^{\\mathsf{T}} T - T T^{\\mathsf{T}}$，其中 $T$ 是 $A$ 的一个实舒尔型。\n- 任务：验证 $A$ 是亏损的，构造 $A$ 的一个实舒尔分解，并计算弗罗贝尼乌斯范数 $\\lVert \\Delta \\rVert_{F}$。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学基础：** 该问题牢固地植根于数值线性代数的标准、成熟概念，包括特征值、特征向量、矩阵分解（舒尔分解）和矩阵范数。矩阵 $A$ 是幂零若尔当块的一个经典例子，常用于阐释亏损性和非正规性等概念。\n- **适定性：** 该问题是适定的。各项任务定义清晰，并能导出一个唯一且有意义的解。实舒尔分解的存在性是一个基本定理。待计算的量 $\\lVert \\Delta \\rVert_{F}$ 不受舒尔分解中正交矩阵 $Q$ 的选择影响，因为弗罗贝尼乌斯范数是酉不变的。即 $\\lVert \\Delta \\rVert_{F} = \\lVert T^{\\mathsf{T}} T - T T^{\\mathsf{T}} \\rVert_F = \\lVert (Q^{\\mathsf{T}}AQ)^{\\mathsf{T}}(Q^{\\mathsf{T}}AQ) - (Q^{\\mathsf{T}}AQ)(Q^{\\mathsf{T}}AQ)^{\\mathsf{T}} \\rVert_F = \\lVert Q^{\\mathsf{T}}(A^{\\mathsf{T}}A - AA^{\\mathsf{T}})Q \\rVert_F = \\lVert A^{\\mathsf{T}}A - AA^{\\mathsf{T}} \\rVert_F$。这确保了最终答案的唯一性。\n- **客观性：** 问题使用精确、客观的数学语言陈述。\n- **完整性：** 提供了所有必要的信息和定义。\n\n**3. 结论与行动：**\n该问题是有效的，因为它科学合理、适定且无歧义。我们继续进行解答。\n\n### 第1部分：验证亏损性\n\n如果一个矩阵至少有一个特征值的几何重数严格小于其代数重数，则该矩阵是亏损的。\n\n首先，我们通过求解特征多项式 $p(\\lambda) = \\det(A - \\lambda I)$ 的根来确定特征值及其代数重数。\n$$\np(\\lambda) = \\det \\begin{pmatrix} -\\lambda  1  0\\\\ 0  -\\lambda  1\\\\ 0  0  -\\lambda \\end{pmatrix} = (-\\lambda)^3\n$$\n令 $p(\\lambda) = 0$ 得 $-\\lambda^3 = 0$，这给出了一个单一的特征值 $\\lambda = 0$，其代数重数为 $m_a(0) = 3$。\n\n接下来，我们确定 $\\lambda = 0$ 的几何重数。几何重数 $m_g(\\lambda)$ 是对应于 $\\lambda$ 的特征空间的维度，也就是矩阵 $(A - \\lambda I)$ 的零空间。对于 $\\lambda = 0$，我们需要找到 $A$ 的零空间的维度。\n$$\n\\text{Nul}(A) = \\{ \\mathbf{x} \\in \\mathbb{R}^3 \\mid A\\mathbf{x} = \\mathbf{0} \\}\n$$\n我们求解方程组 $A\\mathbf{x} = \\mathbf{0}$：\n$$\n\\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n该矩阵方程对应于以下线性方程组：\n$x_2 = 0$\n$x_3 = 0$\n$0 = 0$\n变量 $x_1$ 是自由变量。任何特征向量都必须形如 $\\begin{pmatrix} x_1 \\\\ 0 \\\\ 0 \\end{pmatrix} = x_1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。特征空间是由向量 $\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 张成的空间。该空间的维度是 $1$。\n因此，特征值 $\\lambda=0$ 的几何重数是 $m_g(0) = 1$。\n\n比较两个重数，我们有 $m_g(0) = 1  m_a(0) = 3$。根据定义，矩阵 $A$ 是亏损的。\n\n### 第2部分：实舒尔分解\n\n实舒尔分解定理保证，对于任意实数矩阵 $A \\in \\mathbb{R}^{n \\times n}$，存在一个正交矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 和一个实上拟三角矩阵 $T \\in \\mathbb{R}^{n \\times n}$，使得 $A = Q T Q^{\\mathsf{T}}$，或等价地 $T = Q^{\\mathsf{T}} A Q$。矩阵 $T$ 被称为 $A$ 的一个实舒尔型。其对角线上的元素由对应于实特征值的 $1 \\times 1$ 块和对应于复共轭特征值对的 $2 \\times 2$ 块组成。\n\n这个分解的存在性是通过一个构造性证明来建立的，该证明不要求矩阵是可对角化的（即非亏损的）。证明过程通过归纳法进行，只需要任何矩阵至少有一个特征值和相应的特征向量（这在 $\\mathbb{C}$ 上由代数基本定理保证，而对于实矩阵，如果存在复特征值，其共轭对也存在，从而产生一个实不变子空间）。该过程找到一个实特征向量（或一个对应于复数对的二维不变子空间），用它来构成 $Q$ 的第一列（或两列），执行一个相似变换使矩阵块三角化，然后对右下角的子矩阵递归地进行处理。无论矩阵是否亏损，这个过程总是能成功。\n\n由于我们的矩阵 $A$ 的所有特征值都是实的（$\\lambda=0$），它的实舒尔型 $T$ 将是严格上三角的。\n\n为了构造这个分解，我们遵循构造性证明的步骤。\n1. 找到 $A$ 的一个特征向量。我们已经发现 $\\mathbf{v}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 是对应于 $\\lambda=0$ 的一个特征向量。我们将其单位化以得到 $Q$ 的第一列：$\\mathbf{q}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n2. 将 $\\{\\mathbf{q}_1\\}$ 扩展为 $\\mathbb{R}^3$ 的一个标准正交基。最简单的方法是选择标准基向量。令 $\\mathbf{q}_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 和 $\\mathbf{q}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。集合 $\\{\\mathbf{q}_1, \\mathbf{q}_2, \\mathbf{q}_3\\}$ 构成一个标准正交基。\n3. 用这些向量作为列来构造正交矩阵 $Q$：\n$$\nQ = \\begin{pmatrix} \\mathbf{q}_1  \\mathbf{q}_2  \\mathbf{q}_3 \\end{pmatrix} = \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix} = I\n$$\n4. 计算舒尔型 $T$：\n$$\nT = Q^{\\mathsf{T}} A Q = I^{\\mathsf{T}} A I = A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix}\n$$\n得到的矩阵 $T=A$ 是上三角矩阵，因此它是 $A$ 的一个有效实舒尔型。相关的正交矩阵是单位矩阵 $Q=I$。这个分解 $A = I A I^{\\mathsf{T}}$ 是良定义的，并且表明即使是亏损矩阵也具有实舒尔分解。\n\n### 第3部分：计算 $\\lVert \\Delta \\rVert_{F}$\n\n我们被要求计算换位子 $\\Delta = T^{\\mathsf{T}} T - T T^{\\mathsf{T}}$ 的弗罗贝尼乌斯范数，其中 $T$ 是 $A$ 的一个实舒尔型。使用我们在第2部分中找到的舒尔型 $T=A$。\n\n首先，我们计算两个乘积 $T^{\\mathsf{T}} T$ 和 $T T^{\\mathsf{T}}$。\n$$\nT = A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\quad \\implies \\quad T^{\\mathsf{T}} = A^{\\mathsf{T}} = \\begin{pmatrix} 0  0  0\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix}\n$$\n现在，我们计算矩阵乘积：\n$$\nT^{\\mathsf{T}} T = \\begin{pmatrix} 0  0  0\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\nT T^{\\mathsf{T}} = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  0  0\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  0 \\end{pmatrix}\n$$\n接下来，我们计算换位子 $\\Delta$：\n$$\n\\Delta = T^{\\mathsf{T}} T - T T^{\\mathsf{T}} = \\begin{pmatrix} 0  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} -1  0  0\\\\ 0  0  0\\\\ 0  0  1 \\end{pmatrix}\n$$\n最后，我们计算 $\\Delta$ 的弗罗贝尼乌斯范数。矩阵 $M$ 的弗罗贝尼乌斯范数定义为 $\\lVert M \\rVert_{F} = \\sqrt{\\sum_{i,j} |m_{ij}|^2}$。\n$$\n\\lVert \\Delta \\rVert_{F} = \\sqrt{(-1)^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2 + 1^2} = \\sqrt{1 + 1} = \\sqrt{2}\n$$\n值 $\\lVert \\Delta \\rVert_{F}$ 量化了 $T$ 偏离正规性的程度。如验证部分所述，这个量与所选的具体舒尔型无关，因为它等于 $\\lVert A^{\\mathsf{T}}A - AA^{\\mathsf{T}} \\rVert_{F}$。我们的计算在 $T=A$ 的具体情况下证实了这一普适性质。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "实舒尔形式不仅仅是一种静态表示，它还可以被灵活地操控。其中一项强大的技术是重排对角块，这对于许多高级应用至关重要。本练习将引导您体验这个优雅的过程，即通过求解一个西尔维斯特方程（Sylvester equation）并构造一个局部正交变换来交换相邻的对角块。",
            "id": "3595392",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$，并设 $A = Q T Q^{\\top}$ 是一个实舒尔分解，其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$T \\in \\mathbb{R}^{n \\times n}$ 是实准上三角矩阵，其对角线上有 $1 \\times 1$ 和 $2 \\times 2$ 的块。考虑 $T$ 的一个由两个相邻对角块组成的 $2 \\times 2$ 首部主子矩阵，\n$$\nS \\;=\\; \\begin{bmatrix}\nS_{11}  S_{12} \\\\\n0  S_{22}\n\\end{bmatrix},\n$$\n其中 $S_{11} \\in \\mathbb{R}^{p \\times p}$ 和 $S_{22} \\in \\mathbb{R}^{q \\times q}$ 是 $1 \\times 1$ 或 $2 \\times 2$ 的实舒尔块，且谱不相交。我们寻求通过一个局限于此 $2 \\times 2$ 块的正交相似变换来局部重排 $S_{11}$ 和 $S_{22}$，使得得到的 $2 \\times 2$ 首部主子块保持为实准上三角形式，且 $S_{22}$ 位于 $S_{11}$ 之上。\n\n从实舒尔形式和Sylvester方程的定义出发，并仅使用以下基本事实：\n- 当 $\\sigma(S_{11}) \\cap \\sigma(S_{22}) = \\varnothing$ 时，Sylvester方程 $S_{11} X - X S_{22} = S_{12}$ 的解 $X$ 存在且唯一，\n- 正交变换保持内积和相似结构，\n- 简约 $\\mathrm{QR}$ 分解将一组向量正交规范化以产生一个正交基，\n\n推导通过Sylvester方程的解 $X$ 和一个适当块列的简约 $\\mathrm{QR}$ 分解来构造此 $2 \\times 2$ 块上的一个小型正交更新，并解释为什么所得的相似变换能产生所期望的局部重排。\n\n然后，将问题特化到标量情况 $p = q = 1$，其中\n$$\nS_{11} = a, \\quad S_{22} = d, \\quad S_{12} = b, \\quad \\text{with } a,d,b \\in \\mathbb{R}, \\; a \\neq d.\n$$\n求解标量Sylvester方程得到 $X \\in \\mathbb{R}$，通过对 $2 \\times 1$ 列向量 $\\begin{bmatrix} 1 \\\\ X \\end{bmatrix}$ 进行简约 $\\mathrm{QR}$ 分解来构造 $2 \\times 2$ 的正交更新，使其归一化版本成为正交因子的一个列，并用满足以下条件的角度 $\\theta$ (以弧度为单位) 来参数化此正交更新\n$$\n\\begin{bmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{bmatrix}\n\\;=\\;\n\\frac{1}{\\sqrt{1 + X^{2}}}\\,\\begin{bmatrix} 1 \\\\ X \\end{bmatrix}.\n$$\n最后，根据具体数据\n$$\na = 4, \\quad d = 1, \\quad b = 2.\n$$\n计算这个角度。\n将您的最终答案表示为 $\\theta$ 的单个精确解析表达式（以弧度为单位）。不要提供中间量。最终答案中不要包含单位符号。如果选择近似计算，请将答案四舍五入到四位有效数字；否则，请保持精确值。",
            "solution": "该问题要求推导实舒尔形式的 $2 \\times 2$ 块子矩阵的特征值重排算法，然后针对标量情况进行具体计算。该问题是适定的且数学上合理的。\n\n首先，我们推导重排矩阵对角块的一般构造：\n$$\nS = \\begin{bmatrix} S_{11}  S_{12} \\\\ 0  S_{22} \\end{bmatrix}\n$$\n其中 $S_{11} \\in \\mathbb{R}^{p \\times p}$ 和 $S_{22} \\in \\mathbb{R}^{q \\times q}$ 具有不相交的谱，$\\sigma(S_{11}) \\cap \\sigma(S_{22}) = \\varnothing$。我们寻求一个正交矩阵 $U \\in \\mathbb{R}^{(p+q) \\times (p+q)}$，使得相似变换 $\\hat{S} = U^{\\top} S U$ 得到一个对角块交换后的准上三角矩阵：\n$$\n\\hat{S} = \\begin{bmatrix} \\hat{S}_{11}  \\hat{S}_{12} \\\\ 0  \\hat{S}_{22} \\end{bmatrix}\n$$\n其中 $\\sigma(\\hat{S}_{11}) = \\sigma(S_{22})$ 且 $\\sigma(\\hat{S}_{22}) = \\sigma(S_{11})$。\n\n条件 $U^{\\top} S U = \\hat{S}$ 等价于 $S U = U \\hat{S}$。让我们将正交矩阵 $U$ 与 $S$ 进行相容的分块：\n$$\nU = \\begin{bmatrix} U_{11}  U_{12} \\\\ U_{21}  U_{22} \\end{bmatrix}\n$$\n其中 $U_{11} \\in \\mathbb{R}^{p \\times p}$，$U_{12} \\in \\mathbb{R}^{p \\times q}$，$U_{21} \\in \\mathbb{R}^{q \\times p}$，$U_{22} \\in \\mathbb{R}^{q \\times q}$。方程 $S U = U \\hat{S}$ 变为：\n$$\n\\begin{bmatrix} S_{11}  S_{12} \\\\ 0  S_{22} \\end{bmatrix} \\begin{bmatrix} U_{11}  U_{12} \\\\ U_{21}  U_{22} \\end{bmatrix} = \\begin{bmatrix} U_{11}  U_{12} \\\\ U_{21}  U_{22} \\end{bmatrix} \\begin{bmatrix} \\hat{S}_{11}  \\hat{S}_{12} \\\\ 0  \\hat{S}_{22} \\end{bmatrix}\n$$\n令两边的第一个块列相等，得到两个方程：\n$$(1) \\quad S_{11} U_{11} + S_{12} U_{21} = U_{11} \\hat{S}_{11}$$\n$$(2) \\quad S_{22} U_{21} = U_{21} \\hat{S}_{11}$$\n从方程 $(2)$ 可知，如果 $U_{21}$ 是方阵且可逆，我们将有 $\\hat{S}_{11} = U_{21}^{-1} S_{22} U_{21}$，这表明 $\\hat{S}_{11}$ 与 $S_{22}$ 相似，正如所期望的。\n\n我们定义一个矩阵 $X = U_{11} U_{21}^{-1}$，这意味着 $U_{11} = X U_{21}$。同样，这假设 $U_{21}$ 是方阵且可逆，但通常情况下并非如此。然而，这一推理思路指出了一个关系。将 $U_{11} = X U_{21}$ 代入方程 $(1)$：\n$$S_{11} (X U_{21}) + S_{12} U_{21} = (X U_{21}) \\hat{S}_{11}$$\n使用方程 $(2)$ 替换 $U_{21} \\hat{S}_{11}$：\n$$S_{11} X U_{21} + S_{12} U_{21} = X (S_{22} U_{21})$$\n$$(S_{11} X - X S_{22} + S_{12}) U_{21} = 0$$\n为使此式成立，我们需要 $S_{11} X - X S_{22} + S_{12} = 0$，这等价于 $S_{11} X - X S_{22} = -S_{12}$。\n\n问题陈述将Sylvester方程定义为 $S_{11} X_p - X_p S_{22} = S_{12}$。因此，我们推导中的矩阵 $X$ 是问题中Sylvester方程解的负值，即 $X = -X_p$。由于 $\\sigma(S_{11}) \\cap \\sigma(S_{22}) = \\varnothing$，Sylvester方程有唯一解 $X_p$。\n\n关系 $U_{11} = X U_{21} = -X_p U_{21}$ 表明 $U$ 的第一列的块是相关的。块列 $\\begin{bmatrix} U_{11} \\\\ U_{21} \\end{bmatrix}$ 可以写为 $\\begin{bmatrix} -X_p U_{21} \\\\ I_p U_{21} \\end{bmatrix} = \\begin{bmatrix} -X_p \\\\ I_p \\end{bmatrix} U_{21}$。这意味着 $\\begin{bmatrix} U_{11} \\\\ U_{21} \\end{bmatrix}$ 的列空间包含在 $\\begin{bmatrix} -X_p \\\\ I_p \\end{bmatrix}$ 的列空间中。$\\begin{bmatrix} U_{11} \\\\ U_{21} \\end{bmatrix}$ 的列是标准正交的，因此它们构成了由 $\\begin{bmatrix} -X_p \\\\ I_p \\end{bmatrix}$ 的列张成的空间的一个标准正交基。这个基可以通过计算 $\\begin{bmatrix} -X_p \\\\ I_p \\end{bmatrix}$ 的简约QR分解得到。\n\n这解释了Sylvester方程和QR分解的作用。然而，问题中的标量情况指的是对一个不同的矩阵 $\\begin{bmatrix} 1 \\\\ X \\end{bmatrix}$ 进行QR分解。我们可以通过研究 $U$ 的第二个块列来理解这一点。正交条件 $U^\\top U = I$ 意味着块列是正交的：$U_{11}^\\top U_{12} + U_{21}^\\top U_{22} = 0$。代入 $U_{11} = -X_p U_{21}$：\n$$(-X_p U_{21})^\\top U_{12} + U_{21}^\\top U_{22} = 0 \\implies U_{21}^\\top (-X_p^\\top U_{12} + U_{22}) = 0$$\n这表明存在关系 $U_{22} = X_p^\\top U_{12}$。因此，$U$ 的第二个块列可以写为 $\\begin{bmatrix} U_{12} \\\\ U_{22} \\end{bmatrix} = \\begin{bmatrix} I_q U_{12} \\\\ X_p^\\top U_{12} \\end{bmatrix} = \\begin{bmatrix} I_q \\\\ X_p^\\top \\end{bmatrix} U_{12}$。这表明 $\\begin{bmatrix} U_{12} \\\\ U_{22} \\end{bmatrix}$ 的标准正交列构成了由 $\\begin{bmatrix} I_q \\\\ X_p^\\top \\end{bmatrix}$ 的列张成的空间的一个基。一个标准正交基可以通过对 $\\begin{bmatrix} I_q \\\\ X_p^\\top \\end{bmatrix}$ 进行简约QR分解得到。\n\n现在，我们特化到 $p=q=1$ 的标量情况。这些块是标量：$S_{11} = a$，$S_{22} = d$，$S_{12} = b$，其中 $a, d, b \\in \\mathbb{R}$ 且 $a \\neq d$。矩阵为 $S = \\begin{bmatrix} a  b \\\\ 0  d \\end{bmatrix}$。Sylvester方程变为关于标量 $X$ 的线性方程：\n$$aX - Xd = b \\implies (a-d)X = b$$\n由于 $a \\neq d$，唯一解是 $X = \\frac{b}{a-d}$。\n根据我们的一般推导，其QR分解给出更新矩阵一列的‘适当块列’是 $\\begin{bmatrix} 1 \\\\ X^\\top \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ X \\end{bmatrix}$。\n\n让我们构造一个 $2 \\times 2$ 的正交更新矩阵 $U$。我们要求它的一列是 $\\begin{bmatrix} 1 \\\\ X \\end{bmatrix}$ 的归一化版本。设这个归一化向量为 $v = \\frac{1}{\\sqrt{1+X^2}}\\begin{bmatrix} 1 \\\\ X \\end{bmatrix}$。我们选择 $U$ 为一个平面旋转矩阵，使其第二列为 $v$。这个选择不是唯一的，但一个这样的矩阵是 $U = \\begin{bmatrix} \\frac{X}{\\sqrt{1+X^2}}  \\frac{1}{\\sqrt{1+X^2}} \\\\ \\frac{-1}{\\sqrt{1+X^2}}  \\frac{X}{\\sqrt{1+X^2}} \\end{bmatrix}$。令 $c=\\frac{X}{\\sqrt{1+X^2}}$ 和 $s=\\frac{1}{\\sqrt{1+X^2}}$。则 $U=\\begin{bmatrix} c  s \\\\ -s  c \\end{bmatrix}$。应用相似变换：\n$$U^\\top S U = \\begin{bmatrix} c  -s \\\\ s  c \\end{bmatrix} \\begin{bmatrix} a  b \\\\ 0  d \\end{bmatrix} \\begin{bmatrix} c  s \\\\ -s  c \\end{bmatrix}$$\n$\\hat{S}=U^\\top S U$ 得到的 $(2,1)$ 元素是\n$$\\hat{S}_{21} = \\begin{bmatrix} s  c \\end{bmatrix} \\begin{bmatrix} a  b \\\\ 0  d \\end{bmatrix} \\begin{bmatrix} c \\\\ -s \\end{bmatrix} = \\begin{bmatrix} as  bs+cd \\end{bmatrix} \\begin{bmatrix} c \\\\ -s \\end{bmatrix} = asc - (bs+cd)s = asc - bs^2 - cds$$\n我们希望 $\\hat{S}_{21}=0$。\n$$c(as - ds) - bs^2 = 0 \\implies c(a-d)s - bs^2 = 0$$\n假设 $s \\neq 0$，我们得到 $c(a-d) = bs$，这意味着 $\\frac{s}{c} = \\frac{a-d}{b}$。\n根据我们对 $c$ 和 $s$ 的定义，$\\frac{s}{c} = \\frac{1/\\sqrt{1+X^2}}{X/\\sqrt{1+X^2}} = \\frac{1}{X}$。\n因此，交换的条件是 $\\frac{1}{X} = \\frac{a-d}{b}$，这意味着 $X = \\frac{b}{a-d}$。这与Sylvester方程的解相匹配，证实了我们的构造是正确的。变换后矩阵的对角线元素将是 $d$ 和 $a$。\n\n最后，我们为给定数据 $a=4, d=1, b=2$ 计算角度 $\\theta$。\nSylvester方程的解是：\n$$X = \\frac{b}{a-d} = \\frac{2}{4-1} = \\frac{2}{3}$$\n问题通过以下参数化定义了角度 $\\theta$：\n$$\n\\begin{bmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{bmatrix}\n\\;=\\;\n\\frac{1}{\\sqrt{1 + X^{2}}}\\,\\begin{bmatrix} 1 \\\\ X \\end{bmatrix}\n$$\n这意味着 $\\cos \\theta = \\frac{1}{\\sqrt{1+X^2}}$ 且 $\\sin \\theta = \\frac{X}{\\sqrt{1+X^2}}$。两式之比得出：\n$$\\tan \\theta = \\frac{\\sin \\theta}{\\cos \\theta} = X$$\n因此，角度 $\\theta$ 是 $X$ 的反正切主值：\n$$\\theta = \\arctan(X)$$\n代入计算出的 $X$ 值：\n$$\\theta = \\arctan\\left(\\frac{2}{3}\\right)$$\n这就是所要求的以弧度表示的 $\\theta$ 的精确解析表达式。",
            "answer": "$$\\boxed{\\arctan\\left(\\frac{2}{3}\\right)}$$"
        }
    ]
}