{
    "hands_on_practices": [
        {
            "introduction": "理解一个矩阵的约当标准型是分析其性质的第一步。本练习将引导你通过基本定义，如代数和几何重数，来确定一个具有给定特征多项式的矩阵的唯一约当结构。此外，通过对扰动的定性分析，本练习揭示了为何有缺陷矩阵的谱结构在数值上是脆弱的。",
            "id": "3553198",
            "problem": "设 $A \\in \\mathbb{C}^{3 \\times 3}$ 是一个复矩阵，其特征多项式为 $(x-1)^{3}$。假设与特征值 $1$ 相关联的特征空间的维数满足 $\\dim\\ker(A-I)=1$。在若尔当标准型 (JCF) 的框架下进行讨论，其定义如下：对于任意矩阵 $A \\in \\mathbb{C}^{n \\times n}$，存在一个相似变换，可将 $A$ 化为一个块对角矩阵 $J$，其对角块为若尔当块 $J_{k}(\\lambda)$，每个块的大小为 $k$，对角线上为特征值 $\\lambda$，超对角线上为1；对于给定的特征值，其若尔当块大小的多重集编码了该矩阵相对于该特征值的结构。$\\lambda$ 的代数重数是它在特征多项式中的重数，而 $\\lambda$ 的几何重数是 $\\dim\\ker(A-\\lambda I)$。线性代数中一个熟知的事实是，对于给定的特征值 $\\lambda$，与 $\\lambda$ 相关联的若尔当块的数量等于 $\\lambda$ 的几何重数。\n\n(a) 对于特征多项式为 $(x-1)^{3}$ 的矩阵，列举所有可能的若尔当块结构（即将 $3$ 划分为正整数之和），并将每种划分解释为特征值 $1$ 的一种可能的若尔当标准型。\n\n(b) 仅使用上述基本事实和定义，确定哪种若尔当标准型与数据 $\\dim\\ker(A-I)=1$ 一致。请提供清晰的论证。\n\n(c) 为了与数值不稳定性联系起来，考虑一个一般的秩一扰动 $A_{\\varepsilon} = A + \\varepsilon u v^{\\top}$，其中 $u,v \\in \\mathbb{C}^{3}$ 是固定的非零向量，$\\varepsilon \\in \\mathbb{C}$ 是一个最小参数。在假设 $A$ 与一个对应于特征值 $1$ 的单一若尔当块相似的情况下，利用其幂零部分的结构，定性地解释当 $\\varepsilon \\to 0$ 时，$A_{\\varepsilon}$ 的特征值如何在 $1$ 附近分裂，并说明主阶特征值偏移量与 $\\varepsilon$ 的标度关系。你的推理应从形式 $J = I + N$（其中 $N$ 是幂零矩阵）开始，并应避免使用未经证明的快捷公式，而应依赖于行列式层面的考虑和最小多项式。\n\n作为你的最终答案，提供与 (a) 和 (b) 部分中给定数据一致的显式若尔当标准型矩阵 $J$。无需四舍五入，也不涉及物理单位。将你的最终答案表示为这个单一矩阵。",
            "solution": "该问题被认为是有效的，因为它具有线性代数中的科学依据，是自洽且适定的。我们开始进行解答。\n\n问题分为三个部分。我们将按顺序解答它们。矩阵 $A$ 是一个 $3 \\times 3$ 的复矩阵，$A \\in \\mathbb{C}^{3 \\times 3}$。其特征多项式为 $(x-1)^{3}$。这立即使我们知道 $A$ 的唯一特征值是 $\\lambda=1$，其代数重数为 $3$。\n\n(a) 列举所有特征多项式为 $(x-1)^{3}$ 的矩阵的可能若尔当块结构。\n\n一个矩阵的若尔当标准型 (JCF) 由其若尔当块的大小决定。对于一个大小为 $n \\times n$ 的矩阵，所有若尔当块的大小之和必须等于 $n$。在本例中，$n=3$。由于唯一的特征值是 $\\lambda=1$，所有的若尔当块都必须是 $J_k(1)$ 的形式，其中大小 $k \\ge 1$。\n\n因此，可能的 JCF 结构由整数 $3$ 划分为正整数之和的划分给出。$3$ 的划分有：\n1.  $3$：这对应于一个大小为 $3$ 的单一若尔当块。其 JCF 为 $J = J_3(1) = \\begin{pmatrix} 1 & 1 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{pmatrix}$。\n2.  $2+1$：这对应于一个大小为 $2$ 的若尔当块和一个大小为 $1$ 的若尔当块。其 JCF 为 $J = \\begin{pmatrix} J_2(1) & 0 \\\\ 0 & J_1(1) \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$。沿对角线的块的顺序不是唯一的，但块的集合是唯一的。\n3.  $1+1+1$：这对应于三个大小为 $1$ 的若尔当块。其 JCF 为 $J = \\begin{pmatrix} J_1(1) & 0 & 0 \\\\ 0 & J_1(1) & 0 \\\\ 0 & 0 & J_1(1) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = I$，其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n\n这三种结构代表了具有给定特征多项式的矩阵所有可能的若尔当标准型。\n\n(b) 确定哪种若尔当标准型与数据 $\\dim\\ker(A-I)=1$ 一致。\n\n问题提供了这样一个基本事实：对于给定的特征值 $\\lambda$，与 $\\lambda$ 相关联的若尔当块的数量等于其几何重数，几何重数定义为 $\\dim\\ker(A-\\lambda I)$。\n\n对于本题，特征值为 $\\lambda=1$，并且我们已知其几何重数为 $\\dim\\ker(A-I)=1$。这意味着 $A$ 的 JCF 必须恰好包含一个与特征值 $1$ 相关联的若尔当块。\n\n我们现在检查 (a) 部分中确定的三种可能结构：\n1.  划分 $3$：此结构由单个若尔当块 $J_3(1)$ 组成。块的数量为 $1$。这与给定的几何重数一致。\n2.  划分 $2+1$：此结构由两个若尔当块 $J_2(1)$ 和 $J_1(1)$ 组成。块的数量为 $2$。这与给定的几何重数 $1$ 不一致。\n3.  划分 $1+1+1$：此结构由三个大小为 $1$ 的若尔当块组成。块的数量为 $3$。这也与给定的几何重数 $1$ 不一致。\n\n因此，与所有给定数据一致的唯一若尔当标准型是对应于划分 $3$ 的那一种，即一个大小为 $3$ 的单一若尔当块。其显式矩阵为 $J_3(1)$。\n\n(c) 定性解释当 $\\varepsilon \\to 0$ 时，$A_{\\varepsilon} = A + \\varepsilon u v^{\\top}$ 的特征值如何在 $1$ 附近分裂。\n\n从 (b) 部分我们知道，$A$ 与单个若尔当块 $J = J_3(1)$ 相似。由于特征值在相似变换下是不变的，我们可以不失一般性地对 $J$ 本身进行扰动分析。因此设 $A=J$。\n我们可以将 $J$ 写成单位矩阵和一个幂零矩阵的和：\n$$J = I + N, \\quad \\text{其中} \\quad N = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n矩阵 $N$ 是一个 $3$ 阶幂零矩阵，即 $N^2 = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$ 且 $N^3=0$。$J$ 的最小多项式是 $(x-1)^3$。\n\n扰动后的矩阵是 $A_{\\varepsilon} = J + \\varepsilon u v^{\\top}$。我们求其特征值，记为 $\\lambda_{\\varepsilon}$。特征值是特征方程 $\\det(A_{\\varepsilon} - \\lambda_{\\varepsilon} I) = 0$ 的根。\n代入 $A_{\\varepsilon} = I + N + \\varepsilon u v^{\\top}$，我们得到：\n$$\\det(I + N + \\varepsilon u v^{\\top} - \\lambda_{\\varepsilon} I) = 0$$\n对于小的 $\\varepsilon$，我们预期特征值 $\\lambda_{\\varepsilon}$ 会接近原始特征值 $\\lambda=1$。我们定义偏移量 $\\delta = \\lambda_{\\varepsilon} - 1$。我们预期当 $\\varepsilon \\to 0$ 时 $\\delta \\to 0$。代入 $\\lambda_{\\varepsilon} = 1 + \\delta$，方程变为：\n$$\\det(N - \\delta I + \\varepsilon u v^{\\top}) = 0$$\n这是矩阵 $N + \\varepsilon u v^{\\top}$ 在 $\\delta$ 处的特征多项式。为了求解，我们可以使用矩阵行列式引理，该引理指出对于可逆矩阵 $M$，有 $\\det(M + \\mathbf{x} \\mathbf{y}^\\top) = \\det(M)(1 + \\mathbf{y}^\\top M^{-1} \\mathbf{x})$。令 $M = N - \\delta I$，$\\mathbf{x} = \\varepsilon u$，以及 $\\mathbf{y} = v$。\n只要 $\\delta$ 不是 $N$ 的特征值，矩阵 $M$ 就是可逆的。幂零矩阵 $N$ 的所有特征值都是 $0$。假设 $\\delta \\neq 0$，我们可以应用该引理：\n$$\\det(N - \\delta I) \\left(1 + \\varepsilon v^{\\top} (N - \\delta I)^{-1} u\\right) = 0$$\n行列式 $\\det(N - \\delta I)$ 是 $N$ 的特征多项式，即 $(-\\delta)^3$。因此，方程为：\n$$(-\\delta)^3 \\left(1 + \\varepsilon v^{\\top} (N - \\delta I)^{-1} u\\right) = 0$$\n如果 $\\delta=0$ 或者第二个因子为零，则该方程成立。特征值的分裂来自于第二个因子。\n$$1 + \\varepsilon v^{\\top} (N - \\delta I)^{-1} u = 0$$\n为了求逆矩阵 $(N - \\delta I)^{-1}$，我们将其写为 $(N - \\delta I)^{-1} = -\\frac{1}{\\delta}(I - \\frac{1}{\\delta}N)^{-1}$。由于 $N$ 是幂零的 ($N^3=0$)，逆矩阵的几何级数展开是有限的：\n$$(I - \\frac{1}{\\delta}N)^{-1} = I + \\frac{1}{\\delta}N + \\frac{1}{\\delta^2}N^2$$\n将其代回，我们得到：\n$$(N - \\delta I)^{-1} = -\\frac{1}{\\delta}\\left(I + \\frac{1}{\\delta}N + \\frac{1}{\\delta^2}N^2\\right)$$\n现在，我们将其代入关于 $\\delta$ 的方程中：\n$$1 + \\varepsilon v^{\\top} \\left(-\\frac{1}{\\delta}\\left(I + \\frac{1}{\\delta}N + \\frac{1}{\\delta^2}N^2\\right)\\right) u = 0$$\n$$1 = \\frac{\\varepsilon}{\\delta} v^{\\top} \\left(I + \\frac{1}{\\delta}N + \\frac{1}{\\delta^2}N^2\\right) u$$\n$$\\delta = \\varepsilon \\left( v^{\\top}u + \\frac{1}{\\delta} v^{\\top}Nu + \\frac{1}{\\delta^2} v^{\\top}N^2u \\right)$$\n两边乘以 $\\delta^2$ 得到一个关于特征值偏移量 $\\delta$ 的三次方程：\n$$\\delta^3 = \\varepsilon \\left( (v^{\\top}u)\\delta^2 + (v^{\\top}Nu)\\delta + (v^{\\top}N^2u) \\right)$$\n对于小的 $\\varepsilon$，我们预期 $\\delta$ 也很小。在此极限下，左边的 $\\delta^3$ 必须与右边的主导项相平衡。右边是 $\\varepsilon$ 的量级。如果我们假设 $\\delta$ 很小，那么项 $(v^{\\top}u)\\delta^2$ 和 $(v^{\\top}Nu)\\delta$ 相对于（关于 $\\delta$ 的）常数项 $v^{\\top}N^2u$ 而言是高阶项。因此，对于主阶行为，我们有近似式：\n$$\\delta^3 \\approx \\varepsilon (v^{\\top}N^2u)$$\n对于一般的非零向量 $u, v \\in \\mathbb{C}^3$，标量项 $c = v^{\\top}N^2u$ 将不为零。设 $v=(v_1, v_2, v_3)^{\\top}$ 和 $u=(u_1, u_2, u_3)^{\\top}$。那么 $v^{\\top}N^2u = v_1 u_3$。一般情况下，$v_1 \\neq 0$ 且 $u_3 \\neq 0$。\n方程 $\\delta^3 \\approx \\varepsilon c$ 有三个不同的复根 $\\delta$：\n$$\\delta_k = (\\varepsilon c)^{1/3} \\exp\\left(\\frac{2\\pi i k}{3}\\right), \\quad k=0, 1, 2$$\n这个结果表明，在扰动下，原矩阵 $J$ 的单一特征值 $\\lambda=1$ 分裂为三个不同的特征值 $\\lambda_{\\varepsilon,k} = 1+\\delta_k$。特征值偏移量的模 $|\\delta_k|$ 的标度为 $|\\varepsilon c|^{1/3}$。因此，主阶特征值偏移量的标度为 $\\varepsilon^{1/3}$。这种对 $\\varepsilon$ 的分数次幂依赖性是与大小为 $3$ 的若尔当块对应的亏损特征值扰动的特征，它解释了为什么这类特征值在数值上是不稳定的：矩阵的一个小变化 $\\varepsilon$ 可能导致特征值发生一个大得多的变化 $\\varepsilon^{1/3}$。\n\n最终答案要求给出与 (a) 和 (b) 部分一致的显式若尔当矩阵形式。根据已确定的结果，这就是单个若尔当块 $J_3(1)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 0 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论分析之后，我们需要一个定量的方法来衡量特征值对扰动的敏感度。本练习通过计算一个简单但极具代表性的 $2 \\times 2$ 扰动约当块的特征值条件数，来精确地量化这种不稳定性。你将亲手推导条件数如何随着矩阵趋近于有缺陷矩阵而趋于无穷大，从而深刻理解其数值上的病态性质。",
            "id": "3553213",
            "problem": "设 $A(\\epsilon) \\in \\mathbb{R}^{2 \\times 2}$ 由下式给出\n$$\nA(\\epsilon) \\;=\\; \\begin{bmatrix} \\lambda & 1 \\\\ \\epsilon & \\lambda \\end{bmatrix},\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 是一个固定的实数，且 $\\epsilon>0$。考虑 $A(\\epsilon)$ 的一个单特征值 $\\mu$ 的右特征值问题 $A(\\epsilon)\\,x=\\mu\\,x$ 和左特征值问题 $y^{\\top}A(\\epsilon)=\\mu\\,y^{\\top}$。使用向量二范数进行计算。你的任务是：\n\n1. 从特征多项式定义和特征向量方程出发，确定 $A(\\epsilon)$ 的两个特征值，并构造相应的非零右特征向量和左特征向量。\n\n2. 使用单特征值的条件数定义，\n$$\n\\kappa_{2}(\\mu) \\;=\\; \\frac{\\|x\\|_{2}\\,\\|y\\|_{2}}{|y^{\\top}x|},\n$$\n其中 $x$ 和 $y$ 是相应的右特征向量和左特征向量（具有任意非零缩放），对于具有较真实部的特征值 $\\mu_{+}$，将 $\\kappa_{2}(\\mu)$ 明确地表示为 $\\epsilon$ 的函数进行求值。\n\n3. 从第一性原理出发，解释当 $\\epsilon \\to 0^{+}$ 时，$\\kappa_{2}(\\mu_{+})$ 的行为如何反映 $A(\\epsilon)$ 趋近于一个具有单个 Jordan 块的亏损矩阵，并推导出其在 $\\epsilon$ 中的精确缩放规律。\n\n作为你的最终答案，报告 $\\kappa_{2}(\\mu_{+})$ 作为 $\\epsilon$ 的函数的最简精确闭式表达式。不需要进行数值舍入，也不涉及任何单位。",
            "solution": "该问题陈述具有科学依据、提法恰当、客观且完整。它代表了数值线性代数中关于亏损矩阵附近特征值敏感性的标准分析。因此，我们可以开始求解。\n\n问题分为三个部分。我们将按顺序解决它们。\n\n**第一部分：$A(\\epsilon)$ 的特征值和特征向量**\n\n矩阵由下式给出\n$$\nA(\\epsilon) = \\begin{bmatrix} \\lambda & 1 \\\\ \\epsilon & \\lambda \\end{bmatrix}\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 且 $\\epsilon > 0$。\n\n特征值 $\\mu$ 是特征多项式 $\\det(A(\\epsilon) - \\mu I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det\\left(\\begin{bmatrix} \\lambda - \\mu & 1 \\\\ \\epsilon & \\lambda - \\mu \\end{bmatrix}\\right) = (\\lambda - \\mu)^2 - \\epsilon = 0\n$$\n求解 $\\mu$，我们得到 $\\lambda - \\mu = \\pm\\sqrt{\\epsilon}$，这给出了两个特征值：\n$$\n\\mu_{\\pm} = \\lambda \\pm \\sqrt{\\epsilon}\n$$\n由于 $\\epsilon > 0$，两个特征值 $\\mu_+$ 和 $\\mu_-$ 是实数且不相等。因此，它们是单特征值，正如问题所述。\n\n接下来，我们求解相应的右特征向量和左特征向量。\n\n**右特征向量：**\n对应于特征值 $\\mu$ 的右特征向量 $x$ 满足方程 $(A(\\epsilon) - \\mu I)x = 0$。\n\n对于 $\\mu_{+} = \\lambda + \\sqrt{\\epsilon}$：\n需要求解的系统是 $(A(\\epsilon) - \\mu_{+} I)x_{+} = 0$：\n$$\n\\begin{bmatrix} \\lambda - (\\lambda + \\sqrt{\\epsilon}) & 1 \\\\ \\epsilon & \\lambda - (\\lambda + \\sqrt{\\epsilon}) \\end{bmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{bmatrix} -\\sqrt{\\epsilon} & 1 \\\\ \\epsilon & -\\sqrt{\\epsilon} \\end{bmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程 $-\\sqrt{\\epsilon} x_1 + x_2 = 0$，即 $x_2 = \\sqrt{\\epsilon} x_1$。我们可以通过设 $x_1 = 1$ 来选择一个非零特征向量，从而得到 $x_2 = \\sqrt{\\epsilon}$。\n因此，$\\mu_{+}$ 的一个右特征向量是 $x_{+} = \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix}$。\n\n**左特征向量：**\n对应于特征值 $\\mu$ 的左特征向量 $y$ 满足 $y^{\\top}(A(\\epsilon) - \\mu I) = 0^{\\top}$，这等价于 $(A(\\epsilon)^{\\top} - \\mu I)y = 0$。$A(\\epsilon)$ 的转置是 $A(\\epsilon)^{\\top} = \\begin{bmatrix} \\lambda & \\epsilon \\\\ 1 & \\lambda \\end{bmatrix}$。\n\n对于 $\\mu_{+} = \\lambda + \\sqrt{\\epsilon}$：\n需要求解的系统是 $(A(\\epsilon)^{\\top} - \\mu_{+} I)y_{+} = 0$：\n$$\n\\begin{bmatrix} \\lambda - (\\lambda + \\sqrt{\\epsilon}) & \\epsilon \\\\ 1 & \\lambda - (\\lambda + \\sqrt{\\epsilon}) \\end{bmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{bmatrix} -\\sqrt{\\epsilon} & \\epsilon \\\\ 1 & -\\sqrt{\\epsilon} \\end{bmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程 $y_1 - \\sqrt{\\epsilon} y_2 = 0$，即 $y_1 = \\sqrt{\\epsilon} y_2$。我们可以通过设 $y_2 = 1$ 来选择一个非零特征向量，从而得到 $y_1 = \\sqrt{\\epsilon}$。\n因此，$\\mu_{+}$ 的一个左特征向量是 $y_{+} = \\begin{pmatrix} \\sqrt{\\epsilon} \\\\ 1 \\end{pmatrix}$。\n\n**第二部分：特征值条件数 $\\kappa_{2}(\\mu_{+})$**\n\n具有较真实部的特征值是 $\\mu_{+} = \\lambda + \\sqrt{\\epsilon}$。条件数 $\\kappa_{2}(\\mu_{+})$ 的定义如下：\n$$\n\\kappa_{2}(\\mu) = \\frac{\\|x\\|_{2}\\,\\|y\\|_{2}}{|y^{\\top}x|}\n$$\n我们使用对应于 $\\mu_{+}$ 的右特征向量 $x_{+} = \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix}$ 和左特征向量 $y_{+} = \\begin{pmatrix} \\sqrt{\\epsilon} \\\\ 1 \\end{pmatrix}$。\n\n首先，我们计算所需的范数和内积。所使用的范数是向量 $2$-范数。\n$$\n\\|x_{+}\\|_{2} = \\sqrt{1^2 + (\\sqrt{\\epsilon})^2} = \\sqrt{1 + \\epsilon}\n$$\n$$\n\\|y_{+}\\|_{2} = \\sqrt{(\\sqrt{\\epsilon})^2 + 1^2} = \\sqrt{\\epsilon + 1}\n$$\n接下来，我们计算内积 $y_{+}^{\\top}x_{+}$：\n$$\ny_{+}^{\\top}x_{+} = \\begin{pmatrix} \\sqrt{\\epsilon} & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix} = (\\sqrt{\\epsilon})(1) + (1)(\\sqrt{\\epsilon}) = 2\\sqrt{\\epsilon}\n$$\n由于 $\\epsilon > 0$，我们有 $|y_{+}^{\\top}x_{+}| = |2\\sqrt{\\epsilon}| = 2\\sqrt{\\epsilon}$。\n\n将这些代入条件数的公式中：\n$$\n\\kappa_{2}(\\mu_{+}) = \\frac{(\\sqrt{1 + \\epsilon})(\\sqrt{1 + \\epsilon})}{2\\sqrt{\\epsilon}} = \\frac{1 + \\epsilon}{2\\sqrt{\\epsilon}}\n$$\n\n**第三部分：当 $\\epsilon \\to 0^{+}$ 时的解释**\n\n当 $\\epsilon \\to 0^{+}$ 时，矩阵 $A(\\epsilon)$ 趋近于矩阵 $A(0)$：\n$$\nA(0) = \\lim_{\\epsilon\\to 0^{+}} A(\\epsilon) = \\begin{bmatrix} \\lambda & 1 \\\\ 0 & \\lambda \\end{bmatrix}\n$$\n矩阵 $A(0)$ 是 Jordan 标准型。它是一个上三角矩阵，因此其特征值是其对角线元素。存在一个代数重数为 $2$ 的单特征值 $\\mu = \\lambda$。\n\n为了找到几何重数，我们计算 $A(0) - \\lambda I$ 的零空间维度：\n$$\nA(0) - \\lambda I = \\begin{bmatrix} 0 & 1 \\\\ 0 & 0 \\end{bmatrix}\n$$\n该矩阵的秩为 $1$。根据秩-零度定理，其零空间的维度是 $2 - 1 = 1$。几何重数为 $1$。由于几何重数（$1$）小于代数重数（$2$），矩阵 $A(0)$ 是亏损的。它由一个与特征值 $\\lambda$ 相关联的 $2 \\times 2$ Jordan 块组成。\n\n现在，让我们研究当 $\\epsilon \\to 0^{+}$ 时条件数 $\\kappa_{2}(\\mu_{+})$ 的行为：\n$$\n\\lim_{\\epsilon\\to 0^{+}} \\kappa_{2}(\\mu_{+}) = \\lim_{\\epsilon\\to 0^{+}} \\frac{1 + \\epsilon}{2\\sqrt{\\epsilon}}\n$$\n当 $\\epsilon \\to 0^{+}$ 时，分子 $1 + \\epsilon \\to 1$，而分母 $2\\sqrt{\\epsilon} \\to 0^{+}$。因此，极限为：\n$$\n\\lim_{\\epsilon\\to 0^{+}} \\kappa_{2}(\\mu_{+}) = \\infty\n$$\n条件数的发散表明，对于接近亏损矩阵的矩阵，其特征值问题是病态的。对于任意小的 $\\epsilon > 0$，矩阵 $A(\\epsilon)$ 有两个不同的特征值 $\\lambda \\pm \\sqrt{\\epsilon}$，但随着 $\\epsilon$ 变得无穷小，这些特征值对扰动 $\\epsilon$ 变得极其敏感。\n\n当 $\\epsilon \\to 0^{+}$ 时的精确缩放行为由 $\\kappa_{2}(\\mu_{+})$ 表达式中的主导项决定：\n$$\n\\kappa_{2}(\\mu_{+}) = \\frac{1}{2\\sqrt{\\epsilon}} + \\frac{\\epsilon}{2\\sqrt{\\epsilon}} = \\frac{1}{2}\\epsilon^{-1/2} + \\frac{1}{2}\\epsilon^{1/2}\n$$\n对于小的 $\\epsilon$，项 $\\epsilon^{-1/2}$ 是主导项。因此，条件数的缩放级别为 $O(\\epsilon^{-1/2})$。\n\n这种病态性具有几何解释。条件数与 $|y_{+}^{\\top}x_{+}|$ 成反比。该项与右特征向量和左特征向量之间的夹角 $\\theta$ 的余弦有关：\n$$\n\\cos(\\theta) = \\frac{y_{+}^{\\top}x_{+}}{\\|x_{+}\\|_{2} \\|y_{+}\\|_{2}} = \\frac{2\\sqrt{\\epsilon}}{1+\\epsilon} = \\frac{1}{\\kappa_2(\\mu_{+})}\n$$\n当 $\\epsilon \\to 0^{+}$ 时，我们有 $\\cos(\\theta) \\to 0$，这意味着 $\\theta \\to \\frac{\\pi}{2}$。这表示右特征向量和左特征向量变得相互正交。\n让我们检查特征向量本身的极限：\n$$\n\\lim_{\\epsilon\\to 0^{+}} x_{+} = \\lim_{\\epsilon\\to 0^{+}} \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\lim_{\\epsilon\\to 0^{+}} y_{+} = \\lim_{\\epsilon\\to 0^{+}} \\begin{pmatrix} \\sqrt{\\epsilon} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n这些极限向量确实分别是亏损矩阵 $A(0)$ 的右特征向量和左特征向量，并且它们是正交的：$\\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 0$。当矩阵趋近于亏损矩阵时，内积 $y^{\\top}x$ 的消失是特征值条件数激增的根本原因。",
            "answer": "$$\n\\boxed{\\frac{1 + \\epsilon}{2\\sqrt{\\epsilon}}}\n$$"
        },
        {
            "introduction": "理论和分析最终需要在计算实践中得到验证。本练习要求你设计并实现一个数值实验，以观察和量化约当块在有限精度计算中的不稳定性。通过编程，你将直观地看到一个理想的重根特征值在随机扰动（包括舍入误差）下如何分裂成多个不同的值，从而验证约当标准型在实际应用中为何不可靠。",
            "id": "3553193",
            "problem": "考虑若尔当标准型 (JCF)，它将一个矩阵表示为由若干个若尔当块构成的块对角矩阵。一个与特征值 $\\lambda \\in \\mathbb{C}$ 相关的大小为 $m$ 的若尔当块，定义为一个 $m \\times m$ 的矩阵 $J_m(\\lambda)$，其对角线上为 $\\lambda$，超对角线上为1，其余位置为0。在有限精度算术中，任何输入矩阵都会受到不可避免的舍入误差，这种误差可建模为一种加性扰动。对于具有非平凡若尔当结构的矩阵，已知此类扰动会导致特征值分裂，并且在连续随机扰动下，会以概率1产生一个可对角化的矩阵。\n\n从以下基础出发：\n- $J_m(\\lambda)$ 的特征多项式是 $(x - \\lambda)^m$，因此当 $m \\geq 2$ 时，它只有一个代数重数为 $m$、几何重数为 $1$ 的特征值 $\\lambda$。\n- 在浮点运算中，一个矩阵 $A$ 实际上是 $A + \\Delta A$，其中 $\\lVert \\Delta A \\rVert$ 的量级为机器 epsilon 乘以 $A$ 中元素的大小。\n- 扰动后多项式的特征值通常会发生根分裂，其分裂情况由新引入的低次项系数的大小决定。\n\n您的任务是设计并实现一个完整的程序，通过进行数值实验来展示和量化若尔当标准型在特征值计算方面的数值不稳定性。对于每个测试用例，构造扰动矩阵\n$$\nA_\\delta = J_m(\\lambda) + \\delta E,\n$$\n其中 $E$ 是一个实值随机矩阵，其元素是独立地从标准正态分布中抽样得到的，而 $\\delta \\ge 0$ 是一个控制扰动大小的标量。为每个测试用例使用固定的伪随机种子以确保可复现性。\n\n对于每个构造的矩阵 $A_\\delta$，执行以下步骤：\n1. 计算 $A_\\delta$ 的所有特征值 $\\mu_1,\\dots,\\mu_m \\in \\mathbb{C}$。\n2. 使用绝对容差 $\\tau = 10^{-12}$，计算等于不同特征值数量的整数 $k$，其中如果两个特征值的绝对差小于或等于 $\\tau$，则它们被认为是相同的。\n3. 计算观测到的特征值散布\n$$\nr = \\max_{1 \\le i \\le m} \\left| \\mu_i - \\lambda \\right|.\n$$\n4. 通过缺陷敏感的标度律估计有效扰动大小：\n$$\n\\widehat{\\varepsilon} = r^m.\n$$\n报告 $k$ 以数值方式支持以下论断：在一般性扰动下，计算出的谱几乎必然是单谱的（因此是可对角化的）；并报告 $\\widehat{\\varepsilon}$ 作为从特征值散布推断出的潜在扰动大小的估计值。\n\n测试套件：\n- 情况 1：$(m,\\lambda,\\delta,\\text{seed}) = (1, 2, 10^{-12}, 0)$。\n- 情况 2：$(m,\\lambda,\\delta,\\text{seed}) = (2, 0, 2^{-52}, 1)$，其中 $2^{-52}$ 是双精度机器 epsilon。\n- 情况 3：$(m,\\lambda,\\delta,\\text{seed}) = (3, 1, 10^{-8}, 2)$。\n- 情况 4：$(m,\\lambda,\\delta,\\text{seed}) = (4, 0.5, 0, 3)$。\n- 情况 5：$(m,\\lambda,\\delta,\\text{seed}) = (5, -3.2, 10^{-30}, 4)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按顺序输出两个值：首先是整数 $k$，然后是浮点数 $\\widehat{\\varepsilon}$。所有测试用例的输出应按照测试套件的顺序平铺到一个列表中。例如，最终输出应具有以下形式：\n$$\n[k_1,\\widehat{\\varepsilon}_1,k_2,\\widehat{\\varepsilon}_2,k_3,\\widehat{\\varepsilon}_3,k_4,\\widehat{\\varepsilon}_4,k_5,\\widehat{\\varepsilon}_5].\n$$\n不涉及物理单位或角度。所有数值量都应报告为原始数值。使用任何现代语言实现该程序，并遵循最终答案中指定的运行时环境。",
            "solution": "在尝试任何解决方案之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- **任务**：设计并实现一个程序，以展示和量化若尔当标准型 (JCF) 在特征值计算方面的数值不稳定性。\n- **矩阵构造**：$A_\\delta = J_m(\\lambda) + \\delta E$。\n- **$J_m(\\lambda)$**：一个大小为 $m \\times m$、特征值为 $\\lambda$ 的若尔当块。其对角线上为 $\\lambda$，超对角线上为1，其余位置为0。\n- **$E$**：一个实值随机矩阵，其元素独立地从标准正态分布中抽样得到。\n- **$\\delta$**：一个标量扰动大小，$\\delta \\ge 0$。\n- **可复现性**：为每个测试用例使用固定的伪随机种子。\n- **计算步骤**：\n    1. 计算 $A_\\delta$ 的所有特征值 $\\mu_1, \\dots, \\mu_m \\in \\mathbb{C}$。\n    2. 使用绝对容差 $\\tau = 10^{-12}$，计算不同特征值的数量 $k$。如果两个特征值的绝对差小于或等于 $\\tau$，则它们被认为是相同的。\n    3. 计算观测到的特征值散布 $r = \\max_{1 \\le i \\le m} |\\mu_i - \\lambda|$。\n    4. 估计有效扰动大小 $\\widehat{\\varepsilon} = r^m$。\n- **测试套件**：\n    - 情况 1：$(m, \\lambda, \\delta, \\text{seed}) = (1, 2, 10^{-12}, 0)$。\n    - 情况 2：$(m, \\lambda, \\delta, \\text{seed}) = (2, 0, 2^{-52}, 1)$。\n    - 情况 3：$(m, \\lambda, \\delta, \\text{seed}) = (3, 1, 10^{-8}, 2)$。\n    - 情况 4：$(m, \\lambda, \\delta, \\text{seed}) = (4, 0.5, 0, 3)$。\n    - 情况 5：$(m, \\lambda, \\delta, \\text{seed}) = (5, -3.2, 10^{-30}, 4)$。\n- **输出格式**：单行文本：$[k_1,\\widehat{\\varepsilon}_1,k_2,\\widehat{\\varepsilon}_2,k_3,\\widehat{\\varepsilon}_3,k_4,\\widehat{\\varepsilon}_4,k_5,\\widehat{\\varepsilon}_5]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定的验证标准对问题陈述进行评估。\n\n- **科学依据**：该问题在根本上是合理的。它涉及数值线性代数中的一个经典课题：亏损矩阵特征值的敏感性。若尔当块 $J_m(\\lambda)$ 的特征多项式确实是 $(x - \\lambda)^m$。对此类矩阵的一般性扰动通常会产生一个具有 $m$ 个不同特征值的可对角化矩阵。对于一个亏损特征值，扰动大小 $\\varepsilon$ 与由此产生的特征值散布 $r$ 之间的关系由著名结果 $r = O(\\varepsilon^{1/m})$ 给出。所提出的估计量 $\\widehat{\\varepsilon} = r^m$ 是该标度律的直接推论，旨在从观测到的散布中恢复对扰动大小的估计。整个前提在科学上是正确的。\n- **适定性**：该问题是适定的。对于每个测试用例，所有必需的参数（$m, \\lambda, \\delta, \\text{seed}$）都已提供。计算输出（$k$ 和 $\\widehat{\\varepsilon}$）的过程有明确定义，包括用于区分特征值的数值容差 $\\tau$。为随机数生成器使用固定种子确保了实验是确定性和可复现的。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n该问题没有表现出任何列出的无效性缺陷。它在科学上是合理的、适定的、客观的、可形式化的、完整的且非平凡的。\n\n### 步骤 3：结论与行动\n此问题**有效**。将提供解决方案。\n\n### 解决方案\n目标是进行一项数值实验，以研究若尔当块的特征值在小扰动下的不稳定性。对于由 $(m, \\lambda, \\delta, \\text{seed})$ 指定的每个测试用例，我们将构造一个扰动矩阵 $A_\\delta$ 并分析其计算出的谱。\n\n**理论背景**\n当 $m \\ge 2$ 时，若尔当块 $J_m(\\lambda)$ 是一个亏损矩阵，这意味着它的线性无关特征向量数量少于其维度。它拥有一个代数重数为 $m$ 但几何重数仅为 $1$ 的单一特征值 $\\lambda$。此类矩阵的特征值对扰动高度敏感。根据扰动理论可以证明，一个大小为 $\\delta$ 的一般性扰动会将该单一特征值分裂为 $m$ 个不同的特征值 $\\mu_i$，这些特征值位于复平面上以 $\\lambda$ 为中心、半径为 $O(\\delta^{1/m})$ 的圆盘内。\n扰动后的特征多项式可以近似为：\n$$ \\det(xI - A_\\delta) = \\det(xI - J_m(\\lambda) - \\delta E) \\approx (x-\\lambda)^m - c \\delta = 0 $$\n其中常数 $c$ 取决于扰动矩阵 $E$ 的元素，对于 $J_m(0)$，具体来说 $c \\approx (-1)^{m+1} E_{m,1}$。该多项式的根近似为 $\\mu_j \\approx \\lambda + (c\\delta)^{1/m}$。与 $\\lambda$ 的最大距离即为散布 $r = \\max_j |\\mu_j - \\lambda|$，其标度关系为 $r \\propto \\delta^{1/m}$。因此，我们可以通过反转此关系来估计扰动的有效大小：$\\widehat{\\varepsilon} = r^m$，其量级应与 $\\delta$ 相当。\n\n**算法流程**\n对于每个测试用例 $(m, \\lambda, \\delta, \\text{seed})$，执行以下步骤：\n\n1.  **设置种子以保证可复现性**：将伪随机数生成器的种子固定为测试用例中指定的值。这确保了每次执行实验时，随机矩阵 $E$ 都是相同的。\n\n2.  **构造矩阵**：\n    - 创建一个大小为 $m \\times m$ 的若尔当块 $J_m(\\lambda)$。该矩阵主对角线上的值为 $\\lambda$，第一超对角线上的值为 $1$。\n    - 生成一个 $m \\times m$ 的扰动矩阵 $E$，其中每个元素都是从标准正态分布 $\\mathcal{N}(0, 1)$ 中独立抽样的样本。\n    - 最终的扰动矩阵计算为 $A_\\delta = J_m(\\lambda) + \\delta E$。\n\n3.  **计算特征值**：使用标准的数值库函数计算矩阵 $A_\\delta$ 的特征值 $\\mu_1, \\dots, \\mu_m$。即使 $A_\\delta$ 是实矩阵，这些特征值也可能是复数。\n\n4.  **计算不同特征值的数量 ($k$)**：根据给定的容差 $\\tau = 10^{-12}$ 确定不同特征值的数量。采用一种迭代算法：\n    - 初始化一个空的不同特征值列表。\n    - 对于每个计算出的特征值 $\\mu_i$：\n        - 检查它是否与已在不同特征值列表中的任何特征值“接近”，即对于列表中已有的任何 $\\mu_j$，是否有 $|\\mu_i - \\mu_j| \\le \\tau$。\n        - 如果它与任何已有的不同特征值都不接近，则将其添加到列表中。\n    - 计数 $k$ 是该不同特征值列表的最终大小。对于 $\\delta > 0$ 和 $m > 1$，我们期望 $k=m$ 的概率非常高。对于 $\\delta=0$ 或 $m=1$，我们期望 $k=1$。\n\n5.  **计算特征值散布 ($r$)**：计算出的特征值与原始特征值 $\\lambda$ 的最大绝对偏差计算如下：\n    $$ r = \\max_{1 \\le i \\le m} |\\mu_i - \\lambda| $$\n    其中 $|\\cdot|$ 表示复数的模。\n\n6.  **估计有效扰动 ($\\widehat{\\varepsilon}$)**：使用从扰动理论推导出的标度律来估计有效扰动大小：\n    $$ \\widehat{\\varepsilon} = r^m $$\n    该值提供了从其对谱的影响推断出的扰动大小的估计。对于 $\\delta > 0$，我们期望 $\\widehat{\\varepsilon}$ 的量级与 $\\delta$ 相当。\n\n收集每个测试用例的结果（$k$ 和 $\\widehat{\\varepsilon}$），并将其格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Conducts numerical experiments to demonstrate the instability of the\n    Jordan canonical form's eigenvalues under perturbation.\n    \"\"\"\n    # Test suite: (m, lambda, delta, seed)\n    test_cases = [\n        (1, 2.0, 1e-12, 0),\n        (2, 0.0, 2**-52, 1),\n        (3, 1.0, 1e-8, 2),\n        (4, 0.5, 0.0, 3),\n        (5, -3.2, 1e-30, 4),\n    ]\n\n    # Tolerance for distinguishing eigenvalues\n    tau = 1e-12\n    \n    results = []\n    \n    for m, lam, delta, seed in test_cases:\n        # 1. Set seed for reproducibility\n        np.random.seed(seed)\n        \n        # 2. Construct matrices\n        # Construct the Jordan block J_m(lambda)\n        J = np.diag(np.full(m, lam)) + np.diag(np.ones(m - 1), k=1)\n        \n        # Construct the random perturbation matrix E\n        E = np.random.standard_normal(size=(m, m))\n        \n        # Construct the perturbed matrix A_delta\n        A_delta = J + delta * E\n        \n        # 3. Compute eigenvalues\n        eigenvalues = np.linalg.eigvals(A_delta)\n        \n        # 4. Count distinct eigenvalues (k)\n        distinct_eigenvalues = []\n        for eig_val in eigenvalues:\n            is_new = True\n            for distinct_eig in distinct_eigenvalues:\n                if np.abs(eig_val - distinct_eig) <= tau:\n                    is_new = False\n                    break\n            if is_new:\n                distinct_eigenvalues.append(eig_val)\n        k = len(distinct_eigenvalues)\n        \n        # 5. Calculate eigenvalue spread (r)\n        # Handle the edge case of m=0 for an empty eigenvalues array\n        if m > 0:\n            r = np.max(np.abs(eigenvalues - lam))\n        else:\n            r = 0.0\n            \n        # 6. Estimate effective perturbation (widehat_epsilon)\n        widehat_epsilon = r**m\n        \n        results.append(k)\n        results.append(widehat_epsilon)\n        \n    # Format the final output as a single comma-separated string in brackets.\n    # Use a custom formatter to ensure sufficient precision for small numbers.\n    def format_number(n):\n        if isinstance(n, int):\n            return str(n)\n        # Use scientific notation for small floats to preserve precision.\n        return f\"{n:.16e}\"\n\n    print(f\"[{','.join(map(format_number, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}