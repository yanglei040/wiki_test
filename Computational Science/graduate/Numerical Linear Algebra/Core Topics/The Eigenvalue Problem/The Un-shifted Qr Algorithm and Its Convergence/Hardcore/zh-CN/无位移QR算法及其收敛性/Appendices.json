{
    "hands_on_practices": [
        {
            "introduction": "理论是抽象的，而计算是具体的。本练习将通过一个简单的 $2 \\times 2$ 实对称矩阵，引导您手动执行两轮非移位QR迭代。通过亲手进行QR分解和矩阵乘法，您不仅能深入理解算法的每一步操作，还能验证迭代过程中矩阵之间的相似性关系，从而为后续更复杂的收敛性分析打下坚实的基础。",
            "id": "3598477",
            "problem": "考虑将无位移的正交三角（QR）算法应用于实对称矩阵\n$$\nA_0=\\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix}.\n$$\n无位移 QR 迭代的定义如下。在迭代索引 $k$ 处，计算正交三角（QR）分解 $A_k=Q_k R_k$，其中 $Q_k$ 是正交矩阵（因此 $Q_k^{\\top}Q_k=I$），$R_k$ 是上三角矩阵，然后构成 $A_{k+1}=R_k Q_k$。已知此过程会生成一个通过相似变换连接的矩阵序列，并用于迭代地揭示特征值信息。\n\n仅使用满秩方阵的正交三角（QR）分解的基本定义和正交性 $Q_k^{\\top}Q_k=I$，从 $A_0$ 开始精确执行两次无位移 QR 迭代，从而构造出 $A_1$ 和 $A_2$。在每一步中，明确确认连接 $A_{k+1}$ 与 $A_k$ 的相似关系。\n\n您必须精确计算这些分解和乘积，除了正交三角（QR）分解和正交性的定义属性外，不得借助任何预先说明的算法捷径。将您的最终结果表示为精确的有理数。\n\n$A_2$ 的 $(1,1)$ 元的精确值是多少？",
            "solution": "题目要求对矩阵 $A_0 = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$ 执行两次无位移 QR 算法迭代。该算法由序列 $A_k = Q_k R_k$ 和 $A_{k+1} = R_k Q_k$ 定义，其中 $A_k = Q_k R_k$ 是 $A_k$ 的正交三角（QR）分解。\n\n首先，我们来分析给定的矩阵。矩阵 $A_0$ 是一个 $2 \\times 2$ 的实对称矩阵。\n$$\nA_0 = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n其行列式为 $\\det(A_0) = (2)(2) - (1)(1) = 3 \\neq 0$，因此该矩阵是满秩的，并且存在唯一的 QR 分解（在符号上可能有差异）。\n\n**迭代 1：计算 $A_1$**\n\n我们首先计算 $A_0$ 的 QR 分解。设 $A_0$ 的列向量为 $a_1 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$ 和 $a_2 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。我们对 $A_0$ 的列向量应用 Gram-Schmidt 过程来求正交矩阵 $Q_0$。\n\n设 $Q_0$ 的列向量为 $q_1$ 和 $q_2$。\n第一个未标准化的正交向量 $u_1$ 就是 $a_1$：\n$$\nu_1 = a_1 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n其范数的平方为 $\\|u_1\\|^2 = 2^2 + 1^2 = 5$。范数为 $\\|u_1\\| = \\sqrt{5}$。\n$Q_0$ 的第一列是标准化向量 $q_1$：\n$$\nq_1 = \\frac{u_1}{\\|u_1\\|} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n第二个未标准化的正交向量 $u_2$ 是通过从 $a_2$ 中减去其在 $u_1$ 上的投影得到的：\n$$\nu_2 = a_2 - \\frac{a_2^{\\top} u_1}{u_1^{\\top} u_1} u_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{(1)(2) + (2)(1)}{5} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{4}{5} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{8}{5} \\\\ 2 - \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{5} \\\\ \\frac{6}{5} \\end{pmatrix}\n$$\n其范数的平方为 $\\|u_2\\|^2 = (-\\frac{3}{5})^2 + (\\frac{6}{5})^2 = \\frac{9}{25} + \\frac{36}{25} = \\frac{45}{25} = \\frac{9}{5}$。范数为 $\\|u_2\\| = \\sqrt{\\frac{9}{5}} = \\frac{3}{\\sqrt{5}}$。\n$Q_0$ 的第二列是标准化向量 $q_2$：\n$$\nq_2 = \\frac{u_2}{\\|u_2\\|} = \\frac{1}{3/\\sqrt{5}} \\begin{pmatrix} -3/5 \\\\ 6/5 \\end{pmatrix} = \\frac{\\sqrt{5}}{3} \\frac{3}{5} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n因此，正交矩阵 $Q_0$ 是：\n$$\nQ_0 = [q_1 \\ q_2] = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2  -1 \\\\ 1  2 \\end{pmatrix}\n$$\n上三角矩阵 $R_0$ 由 $A_0 = Q_0 R_0 \\implies R_0 = Q_0^{\\top} A_0$ 得到，因为 $Q_0$ 是正交的（$Q_0^{\\top}Q_0 = I$）。\n$$\nR_0 = \\left(\\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2  1 \\\\ -1  2 \\end{pmatrix}\\right) \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} (2)(2)+(1)(1)  (2)(1)+(1)(2) \\\\ (-1)(2)+(2)(1)  (-1)(1)+(2)(2) \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5  4 \\\\ 0  3 \\end{pmatrix}\n$$\n找到 $Q_0$ 和 $R_0$ 后，我们计算序列中的下一个矩阵 $A_1$：\n$$\nA_1 = R_0 Q_0 = \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5  4 \\\\ 0  3 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2  -1 \\\\ 1  2 \\end{pmatrix} \\right) = \\frac{1}{5} \\begin{pmatrix} (5)(2)+(4)(1)  (5)(-1)+(4)(2) \\\\ (0)(2)+(3)(1)  (0)(-1)+(3)(2) \\end{pmatrix}\n$$\n$$\nA_1 = \\frac{1}{5} \\begin{pmatrix} 14  3 \\\\ 3  6 \\end{pmatrix}\n$$\n为确认相似关系，我们证明 $A_1 = Q_0^{\\top} A_0 Q_0$。根据定义，$A_1 = R_0 Q_0$ 且 $R_0 = Q_0^{\\top} A_0$。将第二个式子代入第一个，得到 $A_1 = (Q_0^{\\top} A_0) Q_0$，这就是所求的关系。由于 $A_0$ 是对称的，$A_1$ 也必须是对称的，我们的结果证实了这一点。\n\n**迭代 2：计算 $A_2$**\n\n现在我们对 $A_1 = \\frac{1}{5} \\begin{pmatrix} 14  3 \\\\ 3  6 \\end{pmatrix}$ 重复此过程。设其列向量为 $a'_1 = \\frac{1}{5} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}$ 和 $a'_2 = \\frac{1}{5} \\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix}$。我们计算 QR 分解 $A_1 = Q_1 R_1$。\n\n第一个未标准化向量 $u'_1$：\n$$\nu'_1 = a'_1 = \\frac{1}{5} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}\n$$\n其范数的平方为 $\\|u'_1\\|^2 = (\\frac{1}{5})^2 (14^2 + 3^2) = \\frac{1}{25}(196+9) = \\frac{205}{25} = \\frac{41}{5}$。范数为 $\\|u'_1\\|=\\sqrt{\\frac{41}{5}} = \\frac{\\sqrt{205}}{5}$。\n$Q_1$ 的第一列是 $q'_1$：\n$$\nq'_1 = \\frac{u'_1}{\\|u'_1\\|} = \\frac{\\frac{1}{5} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}}{\\frac{\\sqrt{205}}{5}} = \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}\n$$\n第二个未标准化向量 $u'_2$ 是：\n$$\nu'_2 = a'_2 - \\frac{{a'_2}^{\\top} u'_1}{{u'_1}^{\\top} u'_1} u'_1\n$$\n点积为 ${a'_2}^{\\top} u'_1 = (\\frac{1}{5})^2 ((3)(14)+(6)(3)) = \\frac{1}{25}(42+18) = \\frac{60}{25} = \\frac{12}{5}$。\n$$\nu'_2 = \\frac{1}{5}\\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix} - \\frac{12/5}{41/5} \\left( \\frac{1}{5}\\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix} \\right) = \\frac{1}{5}\\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix} - \\frac{12}{41} \\frac{1}{5}\\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix} = \\frac{1}{205} \\left( 41\\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix} - 12\\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix} \\right)\n$$\n$$\nu'_2 = \\frac{1}{205} \\begin{pmatrix} 123-168 \\\\ 246-36 \\end{pmatrix} = \\frac{1}{205}\\begin{pmatrix} -45 \\\\ 210 \\end{pmatrix} = \\frac{15}{205}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix} = \\frac{3}{41}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix}\n$$\n其范数的平方为 $\\|u'_2\\|^2 = (\\frac{3}{41})^2 ((-3)^2+14^2) = \\frac{9}{41^2}(9+196) = \\frac{9 \\cdot 205}{41^2} = \\frac{9 \\cdot 5 \\cdot 41}{41^2} = \\frac{45}{41}$。范数为 $\\|u'_2\\| = \\sqrt{\\frac{45}{41}} = \\frac{3\\sqrt{5}}{\\sqrt{41}} = \\frac{3\\sqrt{205}}{41}$。\n$Q_1$ 的第二列是 $q'_2$：\n$$\nq'_2 = \\frac{u'_2}{\\|u'_2\\|} = \\frac{\\frac{3}{41}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix}}{\\frac{3\\sqrt{205}}{41}} = \\frac{1}{\\sqrt{205}}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix}\n$$\n正交矩阵 $Q_1$ 是：\n$$\nQ_1 = [q'_1 \\ q'_2] = \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14  -3 \\\\ 3  14 \\end{pmatrix}\n$$\n上三角矩阵 $R_1 = Q_1^{\\top} A_1$：\n$$\nR_1 = \\left( \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14  3 \\\\ -3  14 \\end{pmatrix} \\right) \\left( \\frac{1}{5} \\begin{pmatrix} 14  3 \\\\ 3  6 \\end{pmatrix} \\right) = \\frac{1}{5\\sqrt{205}} \\begin{pmatrix} 14^2+3^2  (14)(3)+(3)(6) \\\\ (-3)(14)+(14)(3)  (-3)(3)+(14)(6) \\end{pmatrix}\n$$\n$$\nR_1 = \\frac{1}{5\\sqrt{205}} \\begin{pmatrix} 196+9  42+18 \\\\ -42+42  -9+84 \\end{pmatrix} = \\frac{1}{5\\sqrt{205}} \\begin{pmatrix} 205  60 \\\\ 0  75 \\end{pmatrix} = \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 41  12 \\\\ 0  15 \\end{pmatrix}\n$$\n现在我们计算 $A_2 = R_1 Q_1$：\n$$\nA_2 = \\left( \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 41  12 \\\\ 0  15 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14  -3 \\\\ 3  14 \\end{pmatrix} \\right) = \\frac{1}{205} \\begin{pmatrix} (41)(14)+(12)(3)  (41)(-3)+(12)(14) \\\\ (0)(14)+(15)(3)  (0)(-3)+(15)(14) \\end{pmatrix}\n$$\n$$\nA_2 = \\frac{1}{205} \\begin{pmatrix} 574+36  -123+168 \\\\ 45  210 \\end{pmatrix} = \\frac{1}{205} \\begin{pmatrix} 610  45 \\\\ 45  210 \\end{pmatrix}\n$$\n提取公因数（所有元素和分母 $205=5 \\times 41$ 都可以被 $5$ 整除）：\n$$\nA_2 = \\frac{5}{205} \\begin{pmatrix} 122  9 \\\\ 9  42 \\end{pmatrix} = \\frac{1}{41} \\begin{pmatrix} 122  9 \\\\ 9  42 \\end{pmatrix}\n$$\n和之前一样，相似关系 $A_2 = Q_1^{\\top} A_1 Q_1$ 由构造过程保证。由于 $A_1$ 是对称的，$A_2$ 也必须是对称的，我们的结果证实了这一点。\n\n题目要求 $A_2$ 的 $(1,1)$ 元。从上面推导出的矩阵 $A_2$ 中，这个值是：\n$$\n(A_2)_{11} = \\frac{122}{41}\n$$\n这个分数是不可约分的，因为 $41$ 是一个素数，而 $122 = 2 \\times 61$。",
            "answer": "$$\\boxed{\\frac{122}{41}}$$"
        },
        {
            "introduction": "理解了QR迭代的基本步骤后，下一个关键问题是：它收敛得多快？本练习将深入探讨算法的收敛速度，特别是针对一个对称矩阵的非对角元素。您将运用QR算法与同步迭代之间的等价性，从第一性原理推导出非对角元素 $|a_{21}^{(k)}|$ 随迭代次数 $k$ 变化的显式表达式，从而定量地揭示其几何收敛率，并理解该收敛率与特征值之比的内在联系。",
            "id": "3598462",
            "problem": "考虑将非移位的正交三角分解 (QR) 算法应用于一个 $3 \\times 3$ 的实对称矩阵 $A$，其迭代定义为 $A^{(k)} = Q^{(k)} R^{(k)}$ 和 $A^{(k+1)} = R^{(k)} Q^{(k)}$，其中 $Q^{(k)}$ 是正交矩阵，$R^{(k)}$ 是上三角矩阵。用 $a_{ij}^{(k)}$ 表示 $A^{(k)}$ 的 $(i,j)$ 元。设\n$$\n\\Lambda = \\operatorname{diag}(2, 1, \\tfrac{1}{3}), \\quad\nV = \\begin{pmatrix}\n\\frac{\\sqrt{2}}{2}  -\\frac{\\sqrt{2}}{2}  0 \\\\\n\\frac{\\sqrt{2}}{2}  \\phantom{-}\\frac{\\sqrt{2}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nA = V \\Lambda V^{\\top}.\n$$\n从 $A^{(0)} = A$ 和 $Q^{(0)} = I$ 开始，利用非移位 QR 算法与对正规矩阵的同时正交迭代的等价性，从第一性原理出发，推导出一个关于 $k$ 的 $|a_{21}^{(k)}|$ 的显式表达式，并由此推导出一个形式为 $|a_{21}^{(k)}| \\leq C r^{k}$ 且 $r \\in (0,1)$ 的几何速率界，其中常数 $C$ 和比率 $r$ 必须由谱数据和 $V$ 导出的初始基确定。然后，使用你推导出的界，计算满足 $|a_{21}^{(k)}| \\leq \\varepsilon$ 且 $\\varepsilon = 1.0 \\times 10^{-6}$ 的最小整数 $k$。你的最终答案必须仅为 $k$ 的值；此整数输出无需舍入说明。",
            "solution": "该问题要求分析由非移位 QR 算法生成的矩阵 $A^{(k)}$ 的 $(2,1)$ 元的收敛性。解决方案的核心在于利用 QR 算法与同时正交迭代之间的等价性。\n\n非移位 QR 迭代定义为 $A^{(k)} = Q^{(k)}R^{(k)}$ 和 $A^{(k+1)} = R^{(k)}Q^{(k)}$，其中 $A^{(0)} = A$。这意味着 $A^{(k+1)} = (Q^{(k)})^{\\top} A^{(k)} Q^{(k)}$。通过归纳法，如果我们定义累积正交矩阵 $\\mathcal{Q}^{(k)} = Q^{(0)}Q^{(1)}\\cdots Q^{(k-1)}$，则有 $A^{(k)} = (\\mathcal{Q}^{(k)})^{\\top} A \\mathcal{Q}^{(k)}$。QR 算法的一个关键恒等式是 $A^k = \\mathcal{Q}^{(k)} \\mathcal{R}^{(k)}$，其中 $\\mathcal{R}^{(k)} = R^{(k-1)}\\cdots R^{(0)}$。这意味着 $\\mathcal{Q}^{(k)}$ 是矩阵幂 $A^k$ 进行 QR 分解得到的正交因子。\n\n从标准基（由单位矩阵 $I$ 表示）开始的同时正交迭代，通过对 $A^k$ 的列应用格拉姆-施密特过程来生成一系列正交矩阵。得到的正交矩阵恰好是 $\\mathcal{Q}^{(k)}$。我们将利用这一事实来推导 $\\mathcal{Q}^{(k)}$ 的列的表达式。\n\n矩阵 $A$ 由其谱分解 $A = V \\Lambda V^{\\top}$ 给出，其中特征值为 $\\lambda_1 = 2$, $\\lambda_2 = 1$, $\\lambda_3 = 1/3$，对应的标准正交特征向量矩阵为\n$$\nV = \\begin{pmatrix} v_1  v_2  v_3 \\end{pmatrix} = \\begin{pmatrix}\n\\frac{\\sqrt{2}}{2}  -\\frac{\\sqrt{2}}{2}  0 \\\\\n\\frac{\\sqrt{2}}{2}  \\phantom{-}\\frac{\\sqrt{2}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n矩阵 $V$ 是正交的，所以 $V^{-1}=V^{\\top}$。矩阵幂 $A^k$ 是 $A^k = (V \\Lambda V^{\\top})^k = V \\Lambda^k V^{\\top}$。\n\n设 $q_j^{(k)}$ 表示 $\\mathcal{Q}^{(k)}$ 的第 $j$ 列。这些列是通过对 $A^k$ 的列应用格拉姆-施密特过程找到的，这些列是 $A^k e_j$，其中 $j=1, 2, 3$。\n\n我们来求 $A^k$ 的前两列：\n第一列是 $A^k e_1 = V \\Lambda^k V^{\\top} e_1$。$V^{\\top}$ 的第一行是 $(\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0)$。$V^\\top e_1$ 是 $V^\\top$ 的第一列, 即 $(\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2}, 0)^{\\top}$。\n$$\nA^k e_1 = V \\begin{pmatrix} 2^k  0  0 \\\\ 0  1^k  0 \\\\ 0  0  (1/3)^k \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ -\\frac{\\sqrt{2}}{2} \\\\ 0 \\end{pmatrix} = V \\begin{pmatrix} \\frac{\\sqrt{2}}{2} 2^k \\\\ -\\frac{\\sqrt{2}}{2} 1^k \\\\ 0 \\end{pmatrix} = \\frac{\\sqrt{2}}{2} (2^k v_1 - 1^k v_2) = \\frac{\\sqrt{2}}{2} 2^k (v_1 - (\\tfrac{1}{2})^k v_2).\n$$\n$\\mathcal{Q}^{(k)}$ 的第一列 $q_1^{(k)}$ 是通过单位化 $A^k e_1$ 得到的。因为 $v_1$ 和 $v_2$ 是正交单位向量，\n$$\nq_1^{(k)} = \\frac{v_1 - (\\tfrac{1}{2})^k v_2}{\\|v_1 - (\\tfrac{1}{2})^k v_2\\|} = \\frac{v_1 - (\\tfrac{1}{2})^k v_2}{\\sqrt{\\|v_1\\|^2 + ((\\tfrac{1}{2})^k)^2 \\|v_2\\|^2}} = \\frac{v_1 - (\\tfrac{1}{2})^k v_2}{\\sqrt{1 + (\\tfrac{1}{4})^k}}.\n$$\n$A^k$ 的第二列是 $A^k e_2 = V \\Lambda^k V^{\\top} e_2$。$V^{\\top}$ 的第二行是 $(-\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0)$。$V^\\top e_2$ 是 $V^\\top$ 的第二列，即 $(\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0)^{\\top}$。\n$$\nA^k e_2 = V \\begin{pmatrix} 2^k  0  0 \\\\ 0  1^k  0 \\\\ 0  0  (1/3)^k \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ \\frac{\\sqrt{2}}{2} \\\\ 0 \\end{pmatrix} = V \\begin{pmatrix} \\frac{\\sqrt{2}}{2} 2^k \\\\ \\frac{\\sqrt{2}}{2} 1^k \\\\ 0 \\end{pmatrix} = \\frac{\\sqrt{2}}{2} (2^k v_1 + 1^k v_2) = \\frac{\\sqrt{2}}{2} 2^k (v_1 + (\\tfrac{1}{2})^k v_2).\n$$\n为了求 $q_2^{(k)}$，我们首先将 $A^k e_2$ 相对于 $q_1^{(k)}$ 进行正交化。我们记 $\\rho = \\tfrac{1}{2}$。未单位化的向量分别与 $\\tilde{q}_1 = v_1 - \\rho^k v_2$ 和 $\\tilde{y}_2 = v_1 + \\rho^k v_2$ 成比例。正交化后的向量是 $\\tilde{q}_2 = \\tilde{y}_2 - \\frac{\\langle \\tilde{y}_2, \\tilde{q}_1 \\rangle}{\\langle \\tilde{q}_1, \\tilde{q}_1 \\rangle} \\tilde{q}_1$。\n$$\n\\langle \\tilde{y}_2, \\tilde{q}_1 \\rangle = \\langle v_1 + \\rho^k v_2, v_1 - \\rho^k v_2 \\rangle = \\|v_1\\|^2 - \\rho^{2k}\\|v_2\\|^2 = 1 - \\rho^{2k}.\n$$\n$$\n\\langle \\tilde{q}_1, \\tilde{q}_1 \\rangle = \\|v_1 - \\rho^k v_2\\|^2 = \\|v_1\\|^2 + \\rho^{2k}\\|v_2\\|^2 = 1 + \\rho^{2k}.\n$$\n$$\n\\tilde{q}_2 = (v_1 + \\rho^k v_2) - \\frac{1 - \\rho^{2k}}{1 + \\rho^{2k}}(v_1 - \\rho^k v_2) = \\frac{(1+\\rho^{2k}) - (1-\\rho^{2k})}{1+\\rho^{2k}}v_1 + \\frac{\\rho^k(1+\\rho^{2k}) + \\rho^k(1-\\rho^{2k})}{1+\\rho^{2k}}v_2 = \\frac{2\\rho^{2k}}{1+\\rho^{2k}}v_1 + \\frac{2\\rho^k}{1+\\rho^{2k}}v_2.\n$$\n这个向量与 $\\rho^k v_1 + v_2$ 成比例。对这个向量进行单位化得到 $q_2^{(k)}$：\n$$\nq_2^{(k)} = \\frac{\\rho^k v_1 + v_2}{\\|\\rho^k v_1 + v_2\\|} = \\frac{(\\tfrac{1}{2})^k v_1 + v_2}{\\sqrt{(\\tfrac{1}{4})^k + 1}}.\n$$\n$A^{(k)}$ 的元 $a_{21}^{(k)}$ 由 $a_{21}^{(k)} = (q_2^{(k)})^{\\top} A q_1^{(k)}$ 给出。首先，我们计算 $A q_1^{(k)}$：\n$$\nA q_1^{(k)} = A \\frac{v_1 - \\rho^k v_2}{\\sqrt{1 + \\rho^{2k}}} = \\frac{A v_1 - \\rho^k A v_2}{\\sqrt{1 + \\rho^{2k}}} = \\frac{\\lambda_1 v_1 - \\rho^k \\lambda_2 v_2}{\\sqrt{1 + \\rho^{2k}}}.\n$$\n现在，我们计算与 $(q_2^{(k)})^{\\top}$ 的点积：\n$$\na_{21}^{(k)} = \\frac{(\\rho^k v_1^{\\top} + v_2^{\\top})}{\\sqrt{1+\\rho^{2k}}} \\frac{(\\lambda_1 v_1 - \\rho^k \\lambda_2 v_2)}{\\sqrt{1 + \\rho^{2k}}} = \\frac{1}{1+\\rho^{2k}} (\\rho^k \\lambda_1 v_1^{\\top}v_1 - \\rho^{2k}\\lambda_2 v_1^{\\top}v_2 + \\lambda_1 v_2^{\\top}v_1 - \\rho^k\\lambda_2 v_2^{\\top}v_2).\n$$\n使用 $v_i^{\\top}v_j = \\delta_{ij}$，我们得到：\n$$\na_{21}^{(k)} = \\frac{1}{1+\\rho^{2k}} (\\rho^k \\lambda_1 - 0 + 0 - \\rho^k \\lambda_2) = \\frac{\\rho^k (\\lambda_1 - \\lambda_2)}{1+\\rho^{2k}}.\n$$\n代入 $\\lambda_1 = 2$, $\\lambda_2 = 1$ 和 $\\rho = 1/2$（这里需要注意，$\\rho$之前被用于代表$1/2$，而收敛率是$|\\lambda_2/\\lambda_1|=1/2$，所以 $\\rho$ 的使用是一致的）：\n$$\n|a_{21}^{(k)}| = a_{21}^{(k)} = \\frac{(\\tfrac{1}{2})^k (2 - 1)}{1+(\\tfrac{1}{2})^{2k}} = \\frac{(\\tfrac{1}{2})^k}{1+(\\tfrac{1}{4})^k}.\n$$\n这就是所求的 $|a_{21}^{(k)}|$ 的显式表达式。\n\n接下来，我们推导一个几何速率界 $|a_{21}^{(k)}| \\leq C r^{k}$。从上面的表达式，我们有 $|a_{21}^{(k)}| = \\frac{1}{1+(1/4)^k} (\\frac{1}{2})^k$。因为 $k \\geq 0$，所以 $(1/4)^k > 0$，因此 $1+(1/4)^k > 1$。所以，$\\frac{1}{1+(1/4)^k}  1$。我们可以用 $r=1/2$ 建立这个界：\n$$\n|a_{21}^{(k)}| \\leq 1 \\cdot (\\tfrac{1}{2})^k.\n$$\n因此，我们可以选择常数 $C=1$ 和比率 $r=1/2$。\n\n最后，我们必须找到满足 $|a_{21}^{(k)}| \\leq \\varepsilon = 1.0 \\times 10^{-6}$ 的最小整数 $k$。\n$$\n\\frac{(\\tfrac{1}{2})^k}{1+(\\tfrac{1}{4})^k} \\leq 10^{-6}.\n$$\n因为 $1+(1/4)^k > 1$，一个稍宽松但充分的条件是 $(\\tfrac{1}{2})^k \\leq 10^{-6}$。解此不等式可以得到 $k$ 的一个下界。\n$$\n-k \\ln(2) \\leq \\ln(10^{-6}) = -6 \\ln(10).\n$$\n$$\nk \\geq \\frac{6 \\ln(10)}{\\ln(2)}.\n$$\n使用 $\\ln(10) \\approx 2.302585$ 和 $\\ln(2) \\approx 0.693147$ 的值，我们发现：\n$$\nk \\geq \\frac{6 \\times 2.302585}{0.693147} \\approx 19.93156.\n$$\n因为 $k$ 必须是整数，所以最小可能值为 $k=20$。我们可以用原始不等式验证这个选择。\n对于 $k=19$: $|a_{21}^{(19)}| = \\frac{(1/2)^{19}}{1+(1/4)^{19}} \\approx (1/2)^{19} \\approx 1.907 \\times 10^{-6} > 10^{-6}$。\n对于 $k=20$: $|a_{21}^{(20)}| = \\frac{(1/2)^{20}}{1+(1/4)^{20}} \\approx (1/2)^{20} \\approx 0.953 \\times 10^{-6}  10^{-6}$。\n因此，最小的整数 $k$ 是 20。",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "现实世界中的矩阵并非总是对称的，其特征值也可能是复数。本练习将探讨非移位QR算法在处理具有复共轭特征值的实矩阵时的行为。您将分析为何算法在这种情况下不会收敛到对角矩阵，而是收敛到一种更通用的结构——实舒尔型，并在此过程中发现诸如循环等有趣的现象。这个练习有助于您理解QR算法在更广泛场景下的适用性与局限性。",
            "id": "3598473",
            "problem": "考虑将无位移QR分解算法应用于一个实的、非既约上黑森堡矩阵，并约定在每次迭代中上三角矩阵的主对角线元素严格为正。设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是首一多项式 $p(x) = x^{3} - x^{2} + x - 1$ 的友矩阵，即\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0  0  1 \\\\\n1  0  -1 \\\\\n0  1  1\n\\end{pmatrix}.\n$$\n无位移 QR 迭代定义为 $A_{0} = A$，并且对于 $k \\geq 0$，计算唯一的 QR 分解 $A_{k} = Q_{k} R_{k}$，其中 $Q_{k}^{\\top} Q_{k} = I$ 且 $R_{k}$ 是主对角线元素严格为正的上三角矩阵，然后令 $A_{k+1} = R_{k} Q_{k}$。仅使用以下事实：相似变换保持特征值不变；实舒尔定理保证任何实矩阵都正交相似于一个对角线上有 $1 \\times 1$ 和 $2 \\times 2$ 块的上拟三角矩阵；以及 QR 步 $A_{k+1} = Q_{k}^{\\top} A_{k} Q_{k}$ 是一个正交相似变换。\n\n从这些基础出发：\n\n1.  确定 $A$ 的特征值并描述其谱分解类型（一个一维实特征空间和一个对应于共轭复数对的二维不变子空间）。\n\n2.  在结构层面上分析无位移 QR 迭代如何作为一系列正交相似变换起作用，并论证为何对于此矩阵 $A$，收敛过程会趋向于实舒尔形式，并带有一个代表共轭复数对的持久的尾部 $2 \\times 2$ 块。特别地，解释为什么在二维不变子空间中不可能降阶到一个纯对角形式。\n\n3.  研究当 QR 分解选择 $R_{k}$ 中主对角线元素严格为正时，对于此矩阵 $A$，在无位移 QR 迭代下是否可能出现非平凡的有限循环（周期大于1）。你的研究应基于 QR 步的唯一性、正交相似不变量以及极限实舒尔形式上的对易变换结构进行推理，而不是援引任何现成的收敛定理。\n\n4.  设极限的尾部 $2 \\times 2$ 实舒尔块（在限制于二维不变子空间内进行适当的正交基变换后）由一个平面旋转矩阵表示\n$$\n\\begin{pmatrix}\n\\cos(\\theta)  \\sin(\\theta) \\\\\n-\\sin(\\theta)  \\cos(\\theta)\n\\end{pmatrix}.\n$$\n计算与 $A$ 的共轭复特征值对相关的角 $\\theta$ 的精确值，以弧度表示。\n\n你的最终答案必须是 $\\theta$ 以弧度为单位的单个值，不进行四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 矩阵是 $A = \\begin{pmatrix} 0  0  1 \\\\ 1  0  -1 \\\\ 0  1  1 \\end{pmatrix}$，它被确定为多项式 $p(x) = x^{3} - x^{2} + x - 1$ 的友矩阵。\n- 算法是无位移 QR 迭代：$A_{0} = A$。对于 $k \\geq 0$，计算唯一的 QR 分解 $A_{k} = Q_{k} R_{k}$，其中 $Q_{k}$ 是正交矩阵（$Q_{k}^{\\top} Q_{k} = I$），$R_{k}$ 是主对角线元素严格为正的上三角矩阵。下一个迭代矩阵为 $A_{k+1} = R_{k} Q_{k}$。\n- 使用的基础事实：\n    1. 相似变换保持特征值不变。\n    2. 实舒尔定理：任何实矩阵都正交相似于一个上拟三角矩阵。\n    3. QR 步是一个正交相似：$A_{k+1} = Q_{k}^{\\top} A_{k} Q_{k}$。\n- 极限的尾部 $2 \\times 2$ 块由一个形如 $\\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta) \\\\ -\\sin(\\theta)  \\cos(\\theta) \\end{pmatrix}$ 的旋转矩阵表示。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据充分**：该问题属于数值线性代数领域，涉及标准概念：QR 算法、友矩阵、特征值和舒尔分解。所有原理在数学上都是合理的。\n- **良构性**：矩阵 $A$ 已明确定义。对于非奇异矩阵，带有 $R_k$ 对角线元素为正的条件的无位移 QR 算法是一个定义明确的、唯一的迭代过程。问题要求进行一系列逻辑推导，最终得到一个特定的值，该值似乎可以从前提中唯一确定。\n- **客观性**：问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n\n### 第3步：结论与行动\n该问题是有效的。这是一个在数值线性代数领域中良构、自洽且科学上合理的问题。将提供解答。\n\n### 解答\n\n解答按顺序处理问题的四个部分。\n\n**1. $A$ 的特征值和谱分解**\n\n友矩阵的特征值是其相关特征多项式的根。给定的矩阵 $A$ 是多项式 $p(x) = x^{3} - x^{2} + x - 1$ 的友矩阵。$A$ 的特征值 $\\lambda$ 是方程 $p(\\lambda) = 0$ 的根。\n\n我们求解 $p(\\lambda) = \\lambda^{3} - \\lambda^{2} + \\lambda - 1 = 0$。\n分解多项式：\n$$ \\lambda^{2}(\\lambda - 1) + 1(\\lambda - 1) = 0 $$\n$$ (\\lambda^{2} + 1)(\\lambda - 1) = 0 $$\n根是 $\\lambda_1 = 1$、$\\lambda_2 = i$ 和 $\\lambda_3 = -i$。\n\n$A$ 的谱由一个实特征值 $\\lambda_1 = 1$ 和一个共轭复数对 $\\{\\lambda_2, \\lambda_3\\} = \\{i, -i\\}$ 组成。对于像 $A$ 这样的实矩阵，与实特征值 $\\lambda_1=1$ 对应的特征空间是 $\\mathbb{R}^3$ 的一个一维实子空间。共轭复特征值对 $\\{i, -i\\}$ 对应于 $\\mathbb{R}^3$ 中的一个二维不变子空间，该子空间由与 $i$ 或 $-i$ 相关联的特征向量的实部和虚部张成。\n\n**2. 收敛到实舒尔形式**\n\n无位移 QR 迭代生成一个矩阵序列 $\\{A_k\\}$，其中每个矩阵都与前一个矩阵正交相似：$A_{k+1} = R_k Q_k = (Q_k^{-1} A_k) Q_k = Q_k^{\\top} A_k Q_k$。通过归纳法，所有矩阵 $A_k$ 都与初始矩阵 $A_0 = A$ 正交相似。因此，它们都有相同的特征值：$1$、$i$ 和 $-i$。\n\n如果序列 $\\{A_k\\}$ 收敛到一个矩阵 $A_{\\infty}$，那么 $A_{\\infty}$ 也必须与 $A$ 正交相似。实舒尔定理指出，任何实矩阵都正交相似于一个实的上拟三角矩阵，其对角线由对应实特征值的 $1 \\times 1$ 块和对应共轭复特征值对的 $2 \\times 2$ 块组成。\n\n由于 $A$ 是一个具有复特征值（$i$ 和 $-i$）的实矩阵，它不能通过实正交变换对角化。一个实矩阵可被正交对角化的充要条件是它是对称的。给定的矩阵 $A$ 不是对称的（例如，$A_{21}=1$ 而 $A_{12}=0$），所以它不能在 $\\mathbb{R}$ 上被正交对角化。\n\nQR 算法执行一系列实正交相似变换。因此，它不能收敛到一个对角矩阵。它能达到的“最佳”结构是实舒尔形式。对于矩阵 $A$，这种形式必须包含一个对应特征值 $1$ 的 $1 \\times 1$ 块和一个对应特征值 $\\{i, -i\\}$ 的 $2 \\times 2$ 块。因此，如果迭代收敛，它必须收敛到一个带有持久的 $2 \\times 2$ 块的形式，这反映了与复特征值相关的二维不变子空间。在这个框架内，降阶到一个纯对角形式是不可能的。无位移 QR 算法的收敛通常按特征值的模长排序，但这里所有特征值的模长都为 $1$。尽管如此，由实正交变换施加的基本代数约束决定了极限的结构，使得 $2 \\times 2$ 块成为必要。\n\n**3. 有限循环的探究**\n\n我们探究是否可能出现周期为 $p > 1$ 的非平凡有限循环，即对于某个 $k$ 有 $A_{k+p} = A_k$。如果存在这样的循环，则该过程从那一点开始是周期的。为简单起见，我们假设循环从 $k=0$ 开始，所以 $A_p = A_0$。\n\n从相似关系，$A_p = (Q_{p-1}^{\\top} \\dots Q_0^{\\top}) A_0 (Q_0 \\dots Q_{p-1})$。令 $\\mathbf{Q} = Q_0 Q_1 \\dots Q_{p-1}$。则 $A_p = \\mathbf{Q}^{\\top} A_0 \\mathbf{Q}$。对于一个循环，$A_p=A_0$，这意味着 $A_0 = \\mathbf{Q}^{\\top} A_0 \\mathbf{Q}$，或者 $A_0 \\mathbf{Q} = \\mathbf{Q} A_0$。正交矩阵 $\\mathbf{Q}$ 必须与 $A_0$ 对易。\n\n这个特定矩阵 $A$ 的一个关键性质是 $A^4=I$。我们可以从其特征多项式 $p(\\lambda) = \\lambda^3-\\lambda^2+\\lambda-1$ 来验证这一点。根据凯莱-哈密顿定理，$p(A) = A^3 - A^2 + A - I = 0$。两边乘以 $(A+I)$ 得到 $(A+I)(A^3 - A^2 + A - I) = A^4 - A^3 + A^2 - A + A^3 - A^2 + A - I = A^4 - I = 0$。因此，$A^4 = I$。\n\n有一个将 QR 迭代与矩阵的幂联系起来的基本结果：$A^p = (Q_0 \\dots Q_{p-1})(R_{p-1} \\dots R_0)$。令 $\\mathbf{Q}_p = Q_0 \\dots Q_{p-1}$ 且 $\\mathbf{R}_p = R_{p-1} \\dots R_0$。那么 $A^p = \\mathbf{Q}_p \\mathbf{R}_p$ 是 $A^p$ 的 QR 分解，由于 $A$ 是非奇异的（$\\det(A)=1$）并且我们要求 $R$ 具有正的对角线元素，该分解是唯一的。\n\n让我们对 $p=4$ 应用这个结果。我们有 $A^4=I$。单位矩阵 $I$ 的唯一 QR 分解（其中 R 因子具有正的对角线元素）是 $I = I \\cdot I$。因此，我们必须有 $\\mathbf{Q}_4 = Q_0 Q_1 Q_2 Q_3 = I$ 和 $\\mathbf{R}_4 = R_3 R_2 R_1 R_0 = I$。\n\n现在，我们来看迭代矩阵 $A_4$。\n$$ A_4 = \\mathbf{Q}_4^{\\top} A_0 \\mathbf{Q}_4 = I^{\\top} A_0 I = A_0 $$\n这证明了 $A_4=A_0$。该序列是周期的，周期整除 $4$。\n周期不可能是 $p=1$，因为那将意味着 $A_1 = A_0$，而对于一个非既约黑森堡矩阵，这要求它必须是三角矩阵。$A$ 不是三角矩阵。因此，对于这个特定的矩阵 $A$，必须发生非平凡的有限循环（周期为 $2$ 或 $4$）。\n\n**4. 角 $\\theta$ 的计算**\n\n极限的 $2 \\times 2$ 实舒尔块（我们称之为 $B$）必须具有特征值 $i$ 和 $-i$。这个块的特征多项式必须是 $(\\lambda-i)(\\lambda+i) = \\lambda^2+1=0$。这意味着 $\\mathrm{tr}(B) = 0$ 且 $\\det(B) = 1$。\n\n问题陈述这个块可以由一个形如下式的旋转矩阵表示：\n$$ C = \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta) \\\\ -\\sin(\\theta)  \\cos(\\theta) \\end{pmatrix} $$\n该矩阵 $C$ 的特征值是特征方程 $\\lambda^2 - \\mathrm{tr}(C)\\lambda + \\det(C) = 0$ 的根。\n$$ \\lambda^2 - (2\\cos(\\theta))\\lambda + 1 = 0 $$\n根是 $\\lambda = \\cos(\\theta) \\pm \\sqrt{\\cos^2(\\theta)-1} = \\cos(\\theta) \\pm i\\sin(\\theta) = e^{\\pm i\\theta}$。\n\n为了使 $C$ 的特征值与所需的特征值 $\\{i, -i\\}$ 相匹配，我们必须有集合恒等式 $\\{e^{i\\theta}, e^{-i\\theta}\\} = \\{i, -i\\}$。\n这要求 $\\cos(\\theta) = 0$ 且 $\\sin(\\theta) = \\pm 1$。\n\n与一对共轭复特征值 $re^{\\pm i\\phi}$ 相关的旋转角 $\\theta$ 从根本上由特征值的辐角 $\\phi$ 给出。这里，特征值是 $i$ 和 $-i$。它们的极坐标表示是：\n$$ i = 1 \\cdot \\exp\\left(i\\frac{\\pi}{2}\\right) $$\n$$ -i = 1 \\cdot \\exp\\left(-i\\frac{\\pi}{2}\\right) $$\n按照惯例，旋转角取为虚部为正的特征值的辐角。$i$ 的辐角是 $\\arg(i) = \\frac{\\pi}{2}$。\n因此，旋转角 $\\theta$ 是 $\\frac{\\pi}{2}$。\n\n让我们用矩阵形式检查这个值。如果 $\\theta = \\frac{\\pi}{2}$，我们有 $\\cos(\\frac{\\pi}{2}) = 0$ 和 $\\sin(\\frac{\\pi}{2}) = 1$。$C$ 的特征值是 $e^{\\pm i\\pi/2}$，即 $\\pm i$。这是一致的。\n如果我们选择 $\\theta = -\\frac{\\pi}{2}$，特征值将是 $e^{\\mp i\\pi/2}$，也即 $\\pm i$。然而，正值 $\\frac{\\pi}{2}$ 是对应于该特征值对的角度的标准选择。",
            "answer": "$$\\boxed{\\frac{\\pi}{2}}$$"
        }
    ]
}