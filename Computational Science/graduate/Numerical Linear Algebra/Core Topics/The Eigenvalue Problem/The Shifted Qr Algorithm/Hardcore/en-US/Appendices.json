{
    "hands_on_practices": [
        {
            "introduction": "To truly understand the shifted QR algorithm, we must begin with the fundamental mechanics of a single iterative step. This exercise provides a concrete, hands-on calculation for a symmetric tridiagonal matrix, a common and important structure in numerical applications. By manually performing one shifted QR step using numerically stable Givens rotations, you will see precisely how the similarity transformation $A_1 = Q^T A Q$ works to preserve the eigenvalues while beginning the process of zeroing out off-diagonal elements. ",
            "id": "3597253",
            "problem": "Let $A \\in \\mathbb{R}^{3 \\times 3}$ be the symmetric tridiagonal matrix\n$$\nA \\;=\\; \\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 3 & 1 \\\\\n0 & 1 & 4\n\\end{pmatrix},\n$$\nwhich has three distinct eigenvalues. Consider one shifted step of the orthogonal-triangular factorization (QR) algorithm with the explicit shift $\\mu = 3$. By definition, a shifted QR step forms $B = A - \\mu I$, factors $B = Q R$ with $Q$ orthogonal and $R$ upper triangular, and then updates $A_1 = R Q + \\mu I$. Starting from the fundamental facts that\n- $Q$ is orthogonal if and only if $Q^{T} Q = I$,\n- and that the shifted QR step produces a similarity update $A_1 = Q^{T} A Q$ when $B = A - \\mu I$ is factored as $B = Q R$,\ncarry out one complete shifted QR step by hand, using elementary orthogonal transformations that preserve numerical stability and the spectrum. Compute the updated matrix $A_1$ as an orthogonal similarity of $A$, and then extract a single scalar diagnostic from $A_1$: the $(1,2)$ entry. \n\nWhat is the exact value of the $(1,2)$ entry of $A_1$? Provide your answer as a closed-form analytic expression. No rounding is required or permitted.",
            "solution": "The problem requires computing the $(1,2)$ entry of the matrix $A_1$ resulting from a single shifted QR step applied to matrix $A$ with shift $\\mu=3$. The updated matrix is given by the similarity transformation $A_1 = Q^T A Q$, where $Q$ is the orthogonal factor from the QR factorization of $B = A - \\mu I$.\n\nFirst, we form the shifted matrix $B$:\n$$B = A - \\mu I = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 3 & 1 \\\\ 0 & 1 & 4 \\end{pmatrix} - 3 \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix}$$\nNext, we find the orthogonal matrix $Q^T$ that transforms $B$ into an upper triangular matrix $R$ (i.e., $Q^T B = R$) using a sequence of Givens rotations. Let $Q^T = G_2 G_1$.\n\n**Step 1: Eliminate the (2,1) entry of B.**\nWe use a Givens rotation $G_1$ acting on rows 1 and 2. To rotate the vector $\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ to $\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$, we define $G_1 = \\begin{pmatrix} c_1 & s_1 \\\\ -s_1 & c_1 \\end{pmatrix}$ where $r = \\sqrt{(-1)^2+1^2} = \\sqrt{2}$, $c_1 = -1/\\sqrt{2}$, and $s_1 = 1/\\sqrt{2}$. The full $3 \\times 3$ matrix is:\n$$G_1 = \\begin{pmatrix} -1/\\sqrt{2} & 1/\\sqrt{2} & 0 \\\\ -1/\\sqrt{2} & -1/\\sqrt{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nThis matrix is orthogonal and applying it to $B$ gives:\n$$G_1 B = \\begin{pmatrix} \\sqrt{2} & -1/\\sqrt{2} & 1/\\sqrt{2} \\\\ 0 & -1/\\sqrt{2} & -1/\\sqrt{2} \\\\ 0 & 1 & 1 \\end{pmatrix}$$\n\n**Step 2: Eliminate the (3,2) entry of $G_1 B$.**\nWe use a Givens rotation $G_2$ on rows 2 and 3. To rotate $\\begin{pmatrix} -1/\\sqrt{2} \\\\ 1 \\end{pmatrix}$ to $\\begin{pmatrix} r' \\\\ 0 \\end{pmatrix}$, we define $G_2$'s active block with $r' = \\sqrt{(-1/\\sqrt{2})^2+1^2} = \\sqrt{3/2}$, $c_2 = (-1/\\sqrt{2})/r' = -1/\\sqrt{3}$, and $s_2 = 1/r' = \\sqrt{2/3}$.\n$$G_2 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1/\\sqrt{3} & \\sqrt{2}/\\sqrt{3} \\\\ 0 & -\\sqrt{2}/\\sqrt{3} & -1/\\sqrt{3} \\end{pmatrix}$$\nThis gives $Q^T = G_2 G_1$. The similarity transformation is $A_1 = Q^T A Q = (G_2 G_1) A (G_1^T G_2^T)$. We compute this as $A_1 = G_2 (G_1 A G_1^T) G_2^T$.\n\n**Step 3: Compute $A' = G_1 A G_1^T$.**\n$$A' = G_1 A G_1^T = \\begin{pmatrix} -1/\\sqrt{2} & 1/\\sqrt{2} & 0 \\\\ -1/\\sqrt{2} & -1/\\sqrt{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 3 & 1 \\\\ 0 & 1 & 4 \\end{pmatrix} \\begin{pmatrix} -1/\\sqrt{2} & -1/\\sqrt{2} & 0 \\\\ 1/\\sqrt{2} & -1/\\sqrt{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 3/2 & -1/2 & 1/\\sqrt{2} \\\\ -1/2 & 7/2 & -1/\\sqrt{2} \\\\ 1/\\sqrt{2} & -1/\\sqrt{2} & 4 \\end{pmatrix}$$\n\n**Step 4: Compute the (1,2) entry of $A_1 = G_2 A' G_2^T$.**\nThe $(1,2)$ entry of $A_1$ is the dot product of the first row of $(G_2 A')$ and the second column of $G_2^T$.\nSince the first row of $G_2$ is $(1,0,0)$, the first row of $(G_2 A')$ is identical to the first row of $A'$.\nThe second column of $G_2^T$ is $(0, c_2, s_2)^T = (0, -1/\\sqrt{3}, \\sqrt{2}/\\sqrt{3})^T$.\n$$(A_1)_{12} = \\begin{pmatrix} 3/2 & -1/2 & 1/\\sqrt{2} \\end{pmatrix} \\cdot \\begin{pmatrix} 0 \\\\ -1/\\sqrt{3} \\\\ \\sqrt{2}/\\sqrt{3} \\end{pmatrix}$$\n$$(A_1)_{12} = \\left(\\frac{3}{2}\\right)(0) + \\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{\\sqrt{3}}\\right) + \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{\\sqrt{2}}{\\sqrt{3}}\\right)$$\n$$(A_1)_{12} = \\frac{1}{2\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{1+2}{2\\sqrt{3}} = \\frac{3}{2\\sqrt{3}}$$\nRationalizing the denominator, we get:\n$$(A_1)_{12} = \\frac{3\\sqrt{3}}{2 \\cdot 3} = \\frac{\\sqrt{3}}{2}$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$"
        },
        {
            "introduction": "The remarkable efficiency of the QR algorithm stems not just from its structure, but from intelligent shift selection strategies. This practice moves beyond mechanical computation into the realm of algorithmic analysis, exploring *why* certain shifts dramatically outperform others. By dissecting a carefully constructed example with a small spectral gap, you will justify the slow convergence of a naive Rayleigh shift and discover the theoretical power of the Wilkinson shift, which is a cornerstone of modern implementations. ",
            "id": "3597266",
            "problem": "Consider the shifted orthogonal-triangular factorization (QR) algorithm applied to a real symmetric tridiagonal matrix. The orthogonal-triangular (QR) factorization of a square matrix $A$ is a factorization of the form $A = Q R$ where $Q$ is orthogonal and $R$ is upper triangular. In the shifted QR algorithm, one computes the QR factorization of $A - \\mu I$ for a chosen scalar shift $\\mu$ and then forms $A^{+} = R Q + \\mu I$, which is orthogonally similar to $A$ and preserves symmetry and tridiagonal structure under the implicit formulation.\n\nLet $\\varepsilon$ be a small positive parameter and consider the symmetric tridiagonal matrix\n$$\nT(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1 & \\varepsilon & 0 \\\\\n\\varepsilon & 1 + \\varepsilon^{2} & \\varepsilon \\\\\n0 & \\varepsilon & 1 + 2 \\varepsilon^{2}\n\\end{pmatrix}.\n$$\nFocus attention on the trailing $2 \\times 2$ block\n$$\nB(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1 + \\varepsilon^{2} & \\varepsilon \\\\\n\\varepsilon & 1 + 2 \\varepsilon^{2}\n\\end{pmatrix}.\n$$\nThe Rayleigh quotient shift taken as the bottom-right element, $\\mu_{\\mathrm{R}}(\\varepsilon) = T_{33}(\\varepsilon) = 1 + 2 \\varepsilon^{2}$, is often used in practice, but when the bottom two eigenvalues are separated by a small gap, this choice can lead to slow convergence of the bottom subdiagonal toward zero and delayed deflation.\n\nStarting from the definitions and properties above, do the following:\n\n1. Derive the exact eigenvalues of the trailing block $B(\\varepsilon)$ and determine the spectral gap between them as a function of $\\varepsilon$. Explain why this gap is small for small $\\varepsilon$.\n\n2. Using an argument based on orthogonal similarity and the behavior of the shifted QR step in an eigenbasis, justify why a small spectral gap between the last two eigenvalues of $T(\\varepsilon)$ implies slow decay of the bottom subdiagonal when the shift is taken as $\\mu_{\\mathrm{R}}(\\varepsilon)$. Your justification should make precise the dependence of the decay on the distances $|\\lambda_{2}(\\varepsilon) - \\mu|$ and $|\\lambda_{3}(\\varepsilon) - \\mu|$ for an appropriate choice of eigenvalues $\\lambda_{2}(\\varepsilon)$ and $\\lambda_{3}(\\varepsilon)$.\n\n3. Propose an improved shift based on the eigenstructure of the trailing $2 \\times 2$ block, and compute it exactly as a function of $\\varepsilon$. Express your final answer as a single closed-form analytical expression for the improved shift. If simplification is possible, provide the simplified form. No rounding is required.",
            "solution": "This problem requires a three-part analysis of the shifted QR algorithm applied to a specific symmetric tridiagonal matrix $T(\\varepsilon)$.\n\n**1. Eigenvalues and Spectral Gap of the Trailing Block $B(\\varepsilon)$**\n\nThe trailing $2 \\times 2$ block is given by:\n$$\nB(\\varepsilon) =\n\\begin{pmatrix}\n1 + \\varepsilon^{2} & \\varepsilon \\\\\n\\varepsilon & 1 + 2 \\varepsilon^{2}\n\\end{pmatrix}\n$$\nThe eigenvalues of $B(\\varepsilon)$, denoted by $\\lambda$, are the roots of the characteristic equation $\\det(B(\\varepsilon) - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix}\n1 + \\varepsilon^{2} - \\lambda & \\varepsilon \\\\\n\\varepsilon & 1 + 2 \\varepsilon^{2} - \\lambda\n\\end{pmatrix} = 0\n$$\nExpanding the determinant gives the quadratic equation:\n$$\n(1 + \\varepsilon^{2} - \\lambda)(1 + 2 \\varepsilon^{2} - \\lambda) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - \\lambda(1 + \\varepsilon^{2} + 1 + 2 \\varepsilon^{2}) + (1 + \\varepsilon^{2})(1 + 2 \\varepsilon^{2}) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - (2 + 3\\varepsilon^{2})\\lambda + (1 + 3\\varepsilon^{2} + 2\\varepsilon^{4}) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - (2 + 3\\varepsilon^{2})\\lambda + (1 + 2\\varepsilon^{2} + 2\\varepsilon^{4}) = 0\n$$\nWe solve for $\\lambda$ using the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b=-(2 + 3\\varepsilon^{2})$, and $c=1 + 2\\varepsilon^{2} + 2\\varepsilon^{4}$.\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{(-(2 + 3\\varepsilon^{2}))^2 - 4(1)(1 + 2\\varepsilon^{2} + 2\\varepsilon^{4})}}{2}\n$$\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{(4 + 12\\varepsilon^{2} + 9\\varepsilon^{4}) - (4 + 8\\varepsilon^{2} + 8\\varepsilon^{4})}}{2}\n$$\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{4\\varepsilon^{2} + \\varepsilon^{4}}}{2}\n$$\nSince $\\varepsilon$ is a small positive parameter, we can factor out $\\varepsilon^2$ from the square root:\n$$\n\\lambda = \\frac{2 + 3\\varepsilon^{2} \\pm \\sqrt{\\varepsilon^{2}(4 + \\varepsilon^{2})}}{2} = \\frac{2 + 3\\varepsilon^{2} \\pm \\varepsilon\\sqrt{4 + \\varepsilon^{2}}}{2}\n$$\nThe two eigenvalues of $B(\\varepsilon)$ are:\n$$\n\\lambda_B^{-}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n$$\n\\lambda_B^{+}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\nThe spectral gap between these eigenvalues is $\\Delta\\lambda_B = \\lambda_B^{+}(\\varepsilon) - \\lambda_B^{-}(\\varepsilon)$.\n$$\n\\Delta\\lambda_B = \\left(1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - \\left(1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) = \\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\nFor small $\\varepsilon$, we can analyze the behavior of the gap: $\\Delta\\lambda_B = \\varepsilon \\cdot 2\\sqrt{1 + \\varepsilon^2/4} \\approx 2\\varepsilon(1 + \\varepsilon^2/8) \\approx 2\\varepsilon$. The gap is of order $O(\\varepsilon)$, which is small when $\\varepsilon$ is small. This confirms that the eigenvalues of the trailing block are close to each other.\n\n**2. Justification for Slow Convergence with Rayleigh Shift**\n\nThe convergence of the bottom subdiagonal element $T_{n, n-1}$ in the shifted QR algorithm is determined by the choice of shift $\\mu$. The rate of convergence is related to the effectiveness of the shift in isolating one of the eigenvalues. The key mechanism can be understood via the shift-and-invert interpretation of the QR step. The algorithm implicitly performs a step of the power method on $(T - \\mu I)^{-1}$. The convergence rate towards the eigenvector corresponding to an eigenvalue $\\lambda_j$ of $T$ is governed by the ratio $|\\frac{\\lambda_j - \\mu}{\\lambda_k - \\mu}|$, where $\\lambda_j$ is the eigenvalue of $T$ closest to $\\mu$, and $\\lambda_k$ is the next closest. Fast convergence occurs when this ratio is small.\n\nFor the given matrix $T(\\varepsilon)$, the bottom two eigenvalues, let's call them $\\lambda_2(\\varepsilon)$ and $\\lambda_3(\\varepsilon)$, are well-approximated by the eigenvalues of $B(\\varepsilon)$, i.e., $\\lambda_2(\\varepsilon) \\approx \\lambda_B^{-}(\\varepsilon)$ and $\\lambda_3(\\varepsilon) \\approx \\lambda_B^{+}(\\varepsilon)$. The Rayleigh quotient shift is given as $\\mu_{\\mathrm{R}}(\\varepsilon) = T_{33}(\\varepsilon) = 1 + 2 \\varepsilon^{2}$.\n\nLet's analyze the distances from this shift to the eigenvalues of $B(\\varepsilon)$. Let $\\lambda_3(\\varepsilon)$, approximated by $\\lambda_B^{+}(\\varepsilon)$, be the target eigenvalue. The convergence rate is governed by the ratio of the distance from the shift to the desired eigenvalue over the distance to the next-closest eigenvalue.\n$$\n|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\left| \\left(1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - (1 + 2\\varepsilon^{2}) \\right| = \\left| -\\frac{1}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} \\right|\n$$\nSince $\\sqrt{4+\\varepsilon^2} > \\sqrt{\\varepsilon^2} = \\varepsilon$ for $\\varepsilon>0$, the term inside the absolute value is positive.\n$$\n|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}\n$$\nAnd for the other eigenvalue:\n$$\n|\\lambda_B^{-}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\left| \\left(1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - (1 + 2\\varepsilon^{2}) \\right| = \\left| -\\frac{1}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} \\right| = \\frac{1}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n$\\lambda_B^{+}(\\varepsilon)$ is the eigenvalue closer to $\\mu_R$. The convergence of the process which isolates $\\lambda_3(\\varepsilon)$ is governed by the ratio:\n$$\n\\frac{|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}|}{|\\lambda_B^{-}(\\varepsilon) - \\mu_{\\mathrm{R}}|} = \\frac{\\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}}{\\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} + \\frac{1}{2}\\varepsilon^{2}} = \\frac{\\sqrt{4 + \\varepsilon^{2}} - \\varepsilon}{\\sqrt{4 + \\varepsilon^{2}} + \\varepsilon}\n$$\nFor small $\\varepsilon$, $\\sqrt{4 + \\varepsilon^{2}} \\approx 2(1 + \\varepsilon^2/8) = 2 + \\varepsilon^2/4$. The ratio becomes:\n$$\n\\frac{(2 + \\varepsilon^2/4) - \\varepsilon}{(2 + \\varepsilon^2/4) + \\varepsilon} \\approx \\frac{2 - \\varepsilon}{2 + \\varepsilon} = \\frac{1 - \\varepsilon/2}{1 + \\varepsilon/2} \\approx (1 - \\varepsilon/2)^2 \\approx 1 - \\varepsilon\n$$\nA convergence ratio close to $1$ signifies very slow convergence. The Rayleigh shift $\\mu_{\\mathrm{R}}(\\varepsilon)$ lies between the two close eigenvalues $\\lambda_2(\\varepsilon)$ and $\\lambda_3(\\varepsilon)$ but is not particularly close to either one, hence its poor performance in this case.\n\n**3. Improved Shift Proposal and Computation**\n\nThe slow convergence of the Rayleigh shift can be rectified by choosing a shift that is an excellent approximation to one of the target eigenvalues. The standard, and far superior, strategy in this situation is the Wilkinson shift. The Wilkinson shift for a symmetric tridiagonal matrix is defined as the eigenvalue of the trailing $2 \\times 2$ submatrix that is closer to the bottom-right entry, $T_{nn}$.\n\nIn our case, the trailing submatrix is $B(\\varepsilon)$ and the bottom-right entry is $T_{33}(\\varepsilon) = B_{22}(\\varepsilon) = 1 + 2\\varepsilon^2$. We must determine which of the two eigenvalues, $\\lambda_B^{-}(\\varepsilon)$ or $\\lambda_B^{+}(\\varepsilon)$, is closer to $1 + 2\\varepsilon^2$.\nWe already computed the distances in Part 2:\n$$\n|\\lambda_B^{+}(\\varepsilon) - (1+2\\varepsilon^2)| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}\n$$\n$$\n|\\lambda_B^{-}(\\varepsilon) - (1+2\\varepsilon^2)| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} + \\frac{1}{2}\\varepsilon^{2}\n$$\nBy inspection, it is clear that $|\\lambda_B^{+}(\\varepsilon) - (1+2\\varepsilon^2)| < |\\lambda_B^{-}(\\varepsilon) - (1+2\\varepsilon^2)|$.\nTherefore, the improved shift, which is the Wilkinson shift $\\mu_W(\\varepsilon)$, is $\\lambda_B^{+}(\\varepsilon)$.\n\nThe exact analytical expression for this improved shift is:\n$$\n\\mu_W(\\varepsilon) = \\lambda_B^{+}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\nThis expression is in its simplest closed form. This choice of shift is a very close approximation to the true eigenvalue $\\lambda_3(\\varepsilon)$ of $T(\\varepsilon)$, ensuring that the ratio $|\\lambda_3(\\varepsilon) - \\mu_W| / |\\lambda_2(\\varepsilon) - \\mu_W|$ is extremely small, which in turn guarantees rapid (cubic for symmetric matrices) convergence of the bottom subdiagonal element to zero.",
            "answer": "$$\\boxed{1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}}$$"
        },
        {
            "introduction": "A theoretically sound algorithm can fail in practice if not implemented with care for the realities of finite-precision arithmetic. This advanced exercise bridges the gap between abstract theory and robust numerical software by exposing a subtle but critical pitfall in computing the Wilkinson shift: catastrophic cancellation. By analyzing this specific failure mode and deriving a \"guarded\" formula, you will gain insight into the sophisticated techniques required to build reliable and accurate numerical linear algebra routines. ",
            "id": "3597254",
            "problem": "Consider the orthogonal-triangular (QR) algorithm with shifts applied to a symmetric tridiagonal matrix. In the shifted QR algorithm, the shift is chosen from the eigenvalues of the trailing $2 \\times 2$ principal submatrix. Let the trailing block be\n$$\nB \\;=\\; \\begin{pmatrix}\n\\alpha & \\beta \\\\\n\\beta & \\gamma\n\\end{pmatrix}, \\quad \\text{with } \\delta \\equiv \\frac{\\alpha - \\gamma}{2}, \\quad s \\equiv \\frac{\\alpha + \\gamma}{2}, \\quad r \\equiv \\sqrt{\\delta^{2} + \\beta^{2}}.\n$$\nWork under a floating-point model that rounds to nearest with a decimal mantissa of $8$ significant figures. Construct a symmetric tridiagonal matrix $T \\in \\mathbb{R}^{5 \\times 5}$ having this trailing $2 \\times 2$ block with parameters\n$$\n\\gamma \\;=\\; 0, \\quad \\delta \\;=\\; -10^{-8}, \\quad \\beta \\;=\\; 3 \\times 10^{-13},\n$$\nand assume the other entries of $T$ are moderate in magnitude so that only the trailing block governs the shift choice. The shift is taken to be the eigenvalue of $B$ that is closer to $\\gamma$.\n\nUsing only core definitions and well-tested facts about the QR algorithm and floating-point rounding, do the following:\n\n1. Starting from the characteristic polynomial of $B$, express its eigenvalues in terms of $s$ and $r$. Identify which choice, $s + r$ or $s - r$, is closer to $\\gamma$ when $\\delta < 0$. Explain why the naive evaluation of this choice suffers catastrophic cancellation in finite precision (under the stated rounding model), and determine the value the naive evaluation $\\mu_{\\text{naive}}$ takes in this case.\n\n2. Derive algebraically, without invoking any pre-stated “guarded formula,” an equivalent representation of the same eigenvalue that provably avoids subtractive cancellation. Use identities implied by the characteristic polynomial to rationalize the expression and obtain a denominator that is well-conditioned when $\\delta < 0$. Then, for the given numerical parameters, simplify the resulting guarded expression $\\mu_{\\text{guarded}}$ to leading order in the small ratio $|\\beta|/|\\delta|$.\n\n3. Evaluate $\\mu_{\\text{guarded}}$ numerically for the given parameters and express your final answer in scientific notation. Round your final answer to two significant figures.\n\nYour final answer must be the stabilized shift $\\mu_{\\text{guarded}}$ obtained in step 3, expressed as a single real number in scientific notation.",
            "solution": "We begin with the trailing block\n$$\nB \\;=\\; \\begin{pmatrix}\n\\alpha & \\beta \\\\\n\\beta & \\gamma\n\\end{pmatrix}, \\quad \\delta \\equiv \\frac{\\alpha - \\gamma}{2}, \\quad s \\equiv \\frac{\\alpha + \\gamma}{2}, \\quad r \\equiv \\sqrt{\\delta^{2} + \\beta^{2}}.\n$$\nThe characteristic polynomial of $B$ is\n$$\np(\\lambda) \\;=\\; \\lambda^{2} - (\\alpha + \\gamma)\\lambda + (\\alpha \\gamma - \\beta^{2}),\n$$\nand its two real eigenvalues are the roots\n$$\n\\lambda_{\\pm} \\;=\\; s \\pm r.\n$$\nThe shift in the symmetric tridiagonal shifted QR algorithm is chosen to be the eigenvalue closer to the bottom-right entry $\\gamma$ (the so-called Wilkinson choice). We determine which of $\\lambda_{+}$ or $\\lambda_{-}$ is closer to $\\gamma$ when $\\delta < 0$. Note that\n$$\ns \\;=\\; \\frac{\\alpha + \\gamma}{2} \\;=\\; \\gamma + \\delta,\n$$\nso\n$$\n\\lambda_{+} \\;=\\; s + r \\;=\\; \\gamma + \\delta + r, \\qquad \\lambda_{-} \\;=\\; s - r \\;=\\; \\gamma + \\delta - r.\n$$\nWhen $\\delta < 0$, we have $r \\approx |\\delta|$, hence\n$$\n|\\lambda_{+} - \\gamma| \\;=\\; |\\delta + r| \\;\\approx\\; | -|\\delta| + |\\delta| | \\;\\approx\\; 0, \\qquad |\\lambda_{-} - \\gamma| \\;\\approx\\; |-|\\delta| - |\\delta|| \\;=\\; 2|\\delta|,\n$$\nso the eigenvalue closer to $\\gamma$ is $\\lambda_{+} = s + r$.\n\nWe now show that the naive evaluation of $s + r$ suffers catastrophic cancellation in finite precision and, under the stated rounding model, yields $\\mu_{\\text{naive}} = \\gamma$. With the given parameters\n$$\n\\gamma = 0, \\quad \\delta = -10^{-8}, \\quad \\beta = 3 \\times 10^{-13}.\n$$\nCompute $r$ exactly:\n$$\nr \\;=\\; \\sqrt{\\delta^{2} + \\beta^{2}} \\;=\\; \\sqrt{(10^{-8})^{2} + (3 \\times 10^{-13})^{2}} \\;=\\; 10^{-8}\\sqrt{1 + 9 \\times 10^{-10}}.\n$$\nUsing a first-order expansion $\\sqrt{1 + x} = 1 + \\frac{x}{2} + \\mathcal{O}(x^{2})$ with $x = 9 \\times 10^{-10}$, we have\n$$\nr \\;=\\; 10^{-8}\\left(1 + \\frac{9 \\times 10^{-10}}{2} + \\mathcal{O}\\!\\left(10^{-20}\\right)\\right) \\;=\\; 10^{-8} + 4.5 \\times 10^{-18} + \\mathcal{O}\\!\\left(10^{-28}\\right).\n$$\nUnder decimal rounding to nearest with $8$ significant figures, the unit in the last place at the scale $10^{-8}$ is $10^{-16}$. The increment $4.5 \\times 10^{-18}$ is below half an ulp ($5 \\times 10^{-17}$), so\n$$\n\\mathrm{fl}(r) \\;=\\; 10^{-8}, \\qquad \\mathrm{fl}(s) \\;=\\; \\mathrm{fl}(\\gamma + \\delta) \\;=\\; -10^{-8}.\n$$\nTherefore, the naive evaluation\n$$\n\\mu_{\\text{naive}} \\;=\\; \\mathrm{fl}(s + r) \\;=\\; \\mathrm{fl}(-10^{-8} + 10^{-8}) \\;=\\; 0 \\;=\\; \\gamma,\n$$\nwhich places the shift exactly at the bottom-right diagonal and produces a near-breakdown in the subsequent implicit QR step because $B - \\mu_{\\text{naive}} I$ has a bottom-right zero diagonal, causing the initial bulge injection to be ill-conditioned.\n\nTo restore stability, we seek an algebraically equivalent representation of $\\lambda_{+}$ that avoids the subtraction of two nearly equal numbers. Starting from the identity\n$$\nr^{2} - \\delta^{2} \\;=\\; \\beta^{2} \\quad \\Rightarrow \\quad r + \\delta \\;=\\; \\frac{\\beta^{2}}{r - \\delta},\n$$\nwe can rewrite $\\lambda_{+}$ as\n$$\n\\lambda_{+} \\;=\\; s + r \\;=\\; \\gamma + \\delta + r \\;=\\; \\gamma + (r + \\delta) \\;=\\; \\gamma + \\frac{\\beta^{2}}{r - \\delta}.\n$$\nThis form is guarded against cancellation when $\\delta < 0$ because $r - \\delta \\approx |\\delta| - (-|\\delta|) = 2|\\delta|$ is well-separated from zero. For our parameters,\n$$\nr - \\delta \\;=\\; \\left(10^{-8} + 4.5 \\times 10^{-18} + \\cdots\\right) - (-10^{-8}) \\;=\\; 2 \\times 10^{-8} + 4.5 \\times 10^{-18} + \\cdots.\n$$\nHence the guarded shift is\n$$\n\\mu_{\\text{guarded}} \\;=\\; \\gamma + \\frac{\\beta^{2}}{r - \\delta} \\;=\\; \\frac{(3 \\times 10^{-13})^{2}}{2 \\times 10^{-8} + 4.5 \\times 10^{-18} + \\cdots}.\n$$\nTo leading order in the small ratio $|\\beta|/|\\delta|$, we neglect terms of order $\\mathcal{O}\\!\\left(\\beta^{4}/\\delta^{3}\\right)$ and obtain the asymptotic simplification\n$$\n\\mu_{\\text{guarded}} \\;\\approx\\; \\gamma + \\frac{\\beta^{2}}{2|\\delta|} \\;=\\; \\frac{(3 \\times 10^{-13})^{2}}{2 \\times 10^{-8}} \\;=\\; \\frac{9 \\times 10^{-26}}{2 \\times 10^{-8}} \\;=\\; 4.5 \\times 10^{-18}.\n$$\nThis value is a small positive shift distinct from $\\gamma$, so it breaks the exact cancellation that stalled the naive computation and yields a well-conditioned first implicit QR step.\n\nPer the problem statement, we report the final value in scientific notation rounded to two significant figures. The leading-order value is already represented with two significant figures:\n$$\n\\mu_{\\text{guarded}} \\;\\approx\\; 4.5 \\times 10^{-18}.\n$$",
            "answer": "$$\\boxed{4.5 \\times 10^{-18}}$$"
        }
    ]
}