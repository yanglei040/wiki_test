{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握位移 QR 算法，最有效的方法就是亲手实践一个完整的迭代步骤。这个练习将引导你对一个$3 \\times 3$的对称三对角矩阵，使用一个给定的位移值，手动执行一步位移 QR 迭代。通过这个过程 ，你将巩固对 QR 分解、相似变换以及如何利用 Givens 旋转来保持矩阵结构的核心概念的理解。",
            "id": "3597253",
            "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是对称三对角矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n2  1  0 \\\\\n1  3  1 \\\\\n0  1  4\n\\end{pmatrix},\n$$\n该矩阵有三个不同的特征值。考虑使用显式位移 $\\mu = 3$ 的正交三角分解（QR）算法的一个位移步。根据定义，一个位移 QR 步首先构建 $B = A - \\mu I$，然后将其分解为 $B = Q R$（其中 $Q$ 是正交矩阵，$R$ 是上三角矩阵），最后更新 $A_1 = R Q + \\mu I$。从以下基本事实出发：\n- $Q$ 是正交的当且仅当 $Q^{T} Q = I$，\n- 并且当 $B = A - \\mu I$ 被分解为 $B = Q R$ 时，位移 QR 步会产生一个相似更新 $A_1 = Q^{T} A Q$，\n请手动执行一个完整的位移 QR 步，使用能保持数值稳定性和谱的基本正交变换。将更新后的矩阵 $A_1$ 计算为 $A$ 的一个正交相似变换，然后从 $A_1$ 中提取一个标量诊断值：第 $(1,2)$ 个元素。\n\n$A_1$ 的第 $(1,2)$ 个元素的确切值是多少？请以闭式解析表达式的形式给出你的答案。不允许进行四舍五入。",
            "solution": "本题要求计算对给定矩阵 $A$ 和位移 $\\mu$ 应用单位移 QR 步后所得矩阵 $A_1$ 的第 $(1,2)$ 个元素。给定矩阵为\n$$A = \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix}$$\n位移为 $\\mu = 3$。题目指出，更新后的矩阵 $A_1$ 与原始矩阵 $A$ 通过相似变换 $A_1 = Q^{T} A Q$ 相关联，其中 $Q$ 是来自 $B = A - \\mu I$ 的 QR 分解的正交矩阵。我们将利用此性质来计算 $A_1$。\n\n首先，我们构建位移矩阵 $B$：\n$$B = A - \\mu I = \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix} - 3 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} -1  1  0 \\\\ 1  0  1 \\\\ 0  1  1 \\end{pmatrix}$$\n接下来，我们通过使用吉文斯旋转（Givens rotations）对 $B$ 进行 QR 分解来找到正交矩阵 $Q$。目标是找到一系列正交矩阵 $G_i$，使得它们的乘积构成 $Q^T$，从而将 $B$ 变换为上三角矩阵 $R$。具体来说，$Q^T B = R$。由于 $A$ 是三对角的，$B$ 也是三对角的。我们只需要消去次对角线上的元素。\n\n第一步是消去 $B$ 的第 $(2,1)$ 个元素。我们在 $(1,2)$ 平面内使用一个吉文斯旋转 $G_1$。该旋转定义为将向量 $\\begin{pmatrix} B_{11} \\\\ B_{21} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ 变换为 $\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$。吉文斯矩阵是\n$$G_1 = \\begin{pmatrix} c_1   s_1   0 \\\\ -s_1   c_1   0 \\\\ 0   0   1 \\end{pmatrix}$$\n其中 $r = \\sqrt{(-1)^2 + 1^2} = \\sqrt{2}$，$c_1 = \\frac{B_{11}}{r} = -\\frac{1}{\\sqrt{2}}$，以及 $s_1 = \\frac{B_{21}}{r} = \\frac{1}{\\sqrt{2}}$。\n因此，\n$$G_1 = \\begin{pmatrix} -1/\\sqrt{2}   1/\\sqrt{2}   0 \\\\ -1/\\sqrt{2}   -1/\\sqrt{2}   0 \\\\ 0   0   1 \\end{pmatrix}$$\n将此旋转应用于 $B$ 得到\n$$G_1 B = \\begin{pmatrix} \\sqrt{2}   -1/\\sqrt{2}   1/\\sqrt{2} \\\\ 0   -1/\\sqrt{2}   -1/\\sqrt{2} \\\\ 0   1   1 \\end{pmatrix}$$\n第二步是消去所得矩阵 $G_1 B$ 的第 $(3,2)$ 个元素。我们在 $(2,3)$ 平面内使用一个吉文斯旋转 $G_2$。要旋转的向量是 $\\begin{pmatrix} (G_1 B)_{22} \\\\ (G_1 B)_{32} \\end{pmatrix} = \\begin{pmatrix} -1/\\sqrt{2} \\\\ 1 \\end{pmatrix}$。吉文斯矩阵是\n$$G_2 = \\begin{pmatrix} 1   0   0 \\\\ 0   c_2   s_2 \\\\ 0   -s_2   c_2 \\end{pmatrix}$$\n其中 $r' = \\sqrt{(-1/\\sqrt{2})^2 + 1^2} = \\sqrt{1/2 + 1} = \\sqrt{3/2}$，$c_2 = \\frac{-1/\\sqrt{2}}{r'} = -\\frac{1}{\\sqrt{3}}$，以及 $s_2 = \\frac{1}{r'} = \\frac{\\sqrt{2}}{\\sqrt{3}}$。\n因此，\n$$G_2 = \\begin{pmatrix} 1   0   0 \\\\ 0   -1/\\sqrt{3}   \\sqrt{2}/\\sqrt{3} \\\\ 0   -\\sqrt{2}/\\sqrt{3}   -1/\\sqrt{3} \\end{pmatrix}$$\n完整的正交矩阵 $Q^T$ 是这些旋转的乘积：$Q^T = G_2 G_1$。\n更新后的矩阵 $A_1$ 则由 $A_1 = Q^T A Q = (G_2 G_1) A (G_2 G_1)^T = G_2 (G_1 A G_1^T) G_2^T$ 给出。我们可以分两步计算。首先，令 $A' = G_1 A G_1^T$。\n$$G_1^T = \\begin{pmatrix} -1/\\sqrt{2}   -1/\\sqrt{2}   0 \\\\ 1/\\sqrt{2}   -1/\\sqrt{2}   0 \\\\ 0   0   1 \\end{pmatrix}$$\n$$G_1 A = \\begin{pmatrix} -1/\\sqrt{2}   1/\\sqrt{2}   0 \\\\ -1/\\sqrt{2}   -1/\\sqrt{2}   0 \\\\ 0   0   1 \\end{pmatrix} \\begin{pmatrix} 2   1   0 \\\\ 1   3   1 \\\\ 0   1   4 \\end{pmatrix} = \\begin{pmatrix} -1/\\sqrt{2}   \\sqrt{2}   1/\\sqrt{2} \\\\ -3/\\sqrt{2}   -2\\sqrt{2}   -1/\\sqrt{2} \\\\ 0   1   4 \\end{pmatrix}$$\n$$A' = (G_1 A) G_1^T = \\begin{pmatrix} -1/\\sqrt{2}   \\sqrt{2}   1/\\sqrt{2} \\\\ -3/\\sqrt{2}   -2\\sqrt{2}   -1/\\sqrt{2} \\\\ 0   1   4 \\end{pmatrix} \\begin{pmatrix} -1/\\sqrt{2}   -1/\\sqrt{2}   0 \\\\ 1/\\sqrt{2}   -1/\\sqrt{2}   0 \\\\ 0   0   1 \\end{pmatrix} = \\begin{pmatrix} 3/2   -1/2   1/\\sqrt{2} \\\\ -1/2   7/2   -1/\\sqrt{2} \\\\ 1/\\sqrt{2}   -1/\\sqrt{2}   4 \\end{pmatrix}$$\n现在，我们计算 $A_1 = G_2 A' G_2^T$。我们只对 $A_1$ 的第 $(1,2)$ 个元素感兴趣。该元素的计算公式为 $(A_1)_{12} = \\sum_{k,l} (G_2)_{1k} A'_{kl} (G_2^T)_{l2}$。\n由于 $G_2$ 的第一行是 $(1, 0, 0)$，这可以简化为 $(A_1)_{12} = \\sum_{l} A'_{1l} (G_2^T)_{l2}$。这是 $A'$ 的第一行与 $G_2^T$ 的第二列的点积。\n$A'$ 的第一行是 $(3/2, -1/2, 1/\\sqrt{2})$。\n矩阵 $G_2^T$ 是：\n$$G_2^T = \\begin{pmatrix} 1   0   0 \\\\ 0   c_2   -s_2 \\\\ 0   s_2   c_2 \\end{pmatrix} = \\begin{pmatrix} 1   0   0 \\\\ 0   -1/\\sqrt{3}   -\\sqrt{2}/\\sqrt{3} \\\\ 0   \\sqrt{2}/\\sqrt{3}   -1/\\sqrt{3} \\end{pmatrix}$$\n$G_2^T$ 的第二列是 $(0, c_2, s_2)^T$。这是因为 $(G_2^T)_{12}=0$，$(G_2^T)_{22}=c_2$，$(G_2^T)_{32}=s_2$。\n我们所需的列向量是 $(0, c_2, s_2)^T = (0, -1/\\sqrt{3}, \\sqrt{2}/\\sqrt{3})^T$。\n\n$A_1$ 的第 $(1,2)$ 个元素是：\n$$(A_1)_{12} = \\left(\\frac{3}{2}\\right)(0) + \\left(-\\frac{1}{2}\\right)(c_2) + \\left(\\frac{1}{\\sqrt{2}}\\right)(s_2)$$\n代入数值 $c_2 = -1/\\sqrt{3}$ 和 $s_2 = \\sqrt{2}/\\sqrt{3}$：\n$$(A_1)_{12} = \\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{\\sqrt{3}}\\right) + \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{\\sqrt{2}}{\\sqrt{3}}\\right)$$\n$$(A_1)_{12} = \\frac{1}{2\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{1+2}{2\\sqrt{3}} = \\frac{3}{2\\sqrt{3}}$$\n将分母有理化，我们得到：\n$$(A_1)_{12} = \\frac{3\\sqrt{3}}{2 \\cdot 3} = \\frac{\\sqrt{3}}{2}$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$"
        },
        {
            "introduction": "在掌握了单步位移 QR 迭代的机理后，一个更深层次的问题是：如何选择最优的位移？不同的位移策略对算法的收敛速度有天壤之别。本练习  聚焦于一个精心设计的例子，通过分析揭示为何一个简单的瑞利商位移（Rayleigh quotient shift）在特征值间隙很小时收敛缓慢，并引导你推导出性能更优的威尔金森位移（Wilkinson shift）。",
            "id": "3597266",
            "problem": "考虑将带位移的正交三角分解（QR）算法应用于一个实对称三对角矩阵。一个方阵 $A$ 的正交三角（QR）分解是形如 $A = Q R$ 的分解，其中 $Q$ 是正交矩阵，$R$ 是上三角矩阵。在带位移的QR算法中，对于一个选定的标量位移 $\\mu$，我们计算 $A - \\mu I$ 的QR分解，然后构造 $A^{+} = R Q + \\mu I$。这个新矩阵与 $A$ 正交相似，并且在隐式构造下保持对称性和三对角结构。\n\n设 $\\varepsilon$ 为一个小的正参数，并考虑对称三对角矩阵\n$$\nT(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1  \\varepsilon  0 \\\\\n\\varepsilon  1 + \\varepsilon^{2}  \\varepsilon \\\\\n0  \\varepsilon  1 + 2 \\varepsilon^{2}\n\\end{pmatrix}.\n$$\n关注其末尾的 $2 \\times 2$ 子块\n$$\nB(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1 + \\varepsilon^{2}  \\varepsilon \\\\\n\\varepsilon  1 + 2 \\varepsilon^{2}\n\\end{pmatrix}.\n$$\n以右下角元素 $\\mu_{\\mathrm{R}}(\\varepsilon) = T_{33}(\\varepsilon) = 1 + 2 \\varepsilon^{2}$ 作为 Rayleigh 商位移在实践中很常用，但当最末两个特征值之间的间隔很小时，这种选择会导致最末的次对角线元素向零收敛缓慢，并延迟降阶。\n\n从上述定义和性质出发，完成以下任务：\n\n1. 推导末尾子块 $B(\\varepsilon)$ 的精确特征值，并确定它们之间的谱隙作为 $\\varepsilon$ 的函数。解释为什么当 $\\varepsilon$ 很小时，这个谱隙也很小。\n\n2. 使用基于正交相似性和带位移QR步在特征基下的行为的论证，来证明当位移取为 $\\mu_{\\mathrm{R}}(\\varepsilon)$ 时，为什么 $T(\\varepsilon)$ 的最后两个特征值之间的小谱隙意味着最末次对角线元素的缓慢衰减。你的论证应精确说明衰减对距离 $|\\lambda_{2}(\\varepsilon) - \\mu|$ 和 $|\\lambda_{3}(\\varepsilon) - \\mu|$ 的依赖关系，其中 $\\lambda_{2}(\\varepsilon)$ 和 $\\lambda_{3}(\\varepsilon)$ 是适当选择的特征值。\n\n3. 基于末尾 $2 \\times 2$ 子块的特征结构，提出一个改进的位移，并将其精确计算为 $\\varepsilon$ 的函数。将你的最终答案表示为该改进位移的单个闭式解析表达式。如果可以简化，请提供简化形式。无需四舍五入。",
            "solution": "该问题提法明确，在数值线性代数中有其科学依据，并提供了一个自洽、一致的设定。求解所需的所有数据均已提供。因此，我将进行完整的推导。\n\n该问题要求对应用于特定对称三对角矩阵 $T(\\varepsilon)$ 的带位移QR算法进行三部分分析。\n\n**1. 末尾子块 $B(\\varepsilon)$ 的特征值和谱隙**\n\n末尾的 $2 \\times 2$ 子块由下式给出：\n$$\nB(\\varepsilon) =\n\\begin{pmatrix}\n1 + \\varepsilon^{2}  \\varepsilon \\\\\n\\varepsilon  1 + 2 \\varepsilon^{2}\n\\end{pmatrix}\n$$\n$B(\\varepsilon)$ 的特征值，记为 $\\lambda$，是特征方程 $\\det(B(\\varepsilon) - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix}\n1 + \\varepsilon^{2} - \\lambda  \\varepsilon \\\\\n\\varepsilon  1 + 2 \\varepsilon^{2} - \\lambda\n\\end{pmatrix} = 0\n$$\n展开行列式得到二次方程：\n$$\n(1 + \\varepsilon^{2} - \\lambda)(1 + 2 \\varepsilon^{2} - \\lambda) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - \\lambda(1 + \\varepsilon^{2} + 1 + 2 \\varepsilon^{2}) + (1 + \\varepsilon^{2})(1 + 2 \\varepsilon^{2}) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - (2 + 3\\varepsilon^{2})\\lambda + (1 + 3\\varepsilon^{2} + 2\\varepsilon^{4}) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - (2 + 3\\varepsilon^{2})\\lambda + (1 + 2\\varepsilon^{2} + 2\\varepsilon^{4}) = 0\n$$\n我们使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来求解 $\\lambda$，其中 $a=1$, $b=-(2 + 3\\varepsilon^{2})$, $c=1 + 2\\varepsilon^{2} + 2\\varepsilon^{4}$。\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{(-(2 + 3\\varepsilon^{2}))^2 - 4(1)(1 + 2\\varepsilon^{2} + 2\\varepsilon^{4})}}{2}\n$$\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{(4 + 12\\varepsilon^{2} + 9\\varepsilon^{4}) - (4 + 8\\varepsilon^{2} + 8\\varepsilon^{4})}}{2}\n$$\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{4\\varepsilon^{2} + \\varepsilon^{4}}}{2}\n$$\n由于 $\\varepsilon$ 是一个小的正参数，我们可以从平方根中提取因子 $\\varepsilon^2$：\n$$\n\\lambda = \\frac{2 + 3\\varepsilon^{2} \\pm \\sqrt{\\varepsilon^{2}(4 + \\varepsilon^{2})}}{2} = \\frac{2 + 3\\varepsilon^{2} \\pm \\varepsilon\\sqrt{4 + \\varepsilon^{2}}}{2}\n$$\n$B(\\varepsilon)$ 的两个特征值是：\n$$\n\\lambda_B^{-}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n$$\n\\lambda_B^{+}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n这些特征值之间的谱隙为 $\\Delta\\lambda_B = \\lambda_B^{+}(\\varepsilon) - \\lambda_B^{-}(\\varepsilon)$。\n$$\n\\Delta\\lambda_B = \\left(1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - \\left(1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) = \\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n对于小的 $\\varepsilon$，我们可以分析谱隙的行为：$\\Delta\\lambda_B = \\varepsilon \\cdot 2\\sqrt{1 + \\varepsilon^2/4} \\approx 2\\varepsilon(1 + \\varepsilon^2/8) \\approx 2\\varepsilon$。该谱隙是 $O(\\varepsilon)$ 阶的，当 $\\varepsilon$ 很小时，这个值也很小。这证实了末尾子块的特征值彼此接近。\n\n**2. 使用 Rayleigh 位移导致慢收敛的论证**\n\n在带位移QR算法中，最末次对角线元素 $T_{n, n-1}$ 的收敛性取决于位移 $\\mu$ 的选择。收敛速度与位移在分离某个特征值方面的有效性有关。其关键机制可以通过QR步的位移反演解释来理解。该算法隐式地对 $(T - \\mu I)^{-1}$ 执行一步幂法。向对应于 $T$ 的某个特征值 $\\lambda_j$ 的特征向量的收敛速度，由 $(T - \\mu I)^{-1}$ 的特征值大小的比率决定，具体为 $|\\frac{1/(\\lambda_k-\\mu)}{1/(\\lambda_j-\\mu)}| = |\\frac{\\lambda_j - \\mu}{\\lambda_k - \\mu}|$，其中 $\\lambda_j$ 是 $T$ 的最接近 $\\mu$ 的特征值，而 $\\lambda_k$ 是次接近的。当这个比率很小时，收敛就很快。\n\n对于给定的矩阵 $T(\\varepsilon)$，其最末两个特征值，我们称之为 $\\lambda_2(\\varepsilon)$ 和 $\\lambda_3(\\varepsilon)$，可以由 $B(\\varepsilon)$ 的特征值很好地近似，即 $\\lambda_2(\\varepsilon) \\approx \\lambda_B^{-}(\\varepsilon)$ 和 $\\lambda_3(\\varepsilon) \\approx \\lambda_B^{+}(\\varepsilon)$。Rayleigh 商位移由 $\\mu_{\\mathrm{R}}(\\varepsilon) = T_{33}(\\varepsilon) = 1 + 2 \\varepsilon^{2}$ 给出。\n\n让我们分析该位移到 $B(\\varepsilon)$ 的特征值的距离。设 $\\lambda_3(\\varepsilon)$ 为目标特征值。(3,2)元素的降阶的收敛因子将与 $|\\lambda_{2}(\\varepsilon) - \\mu_{\\mathrm{R}}| / |\\lambda_{3}(\\varepsilon) - \\mu_{\\mathrm{R}}|$ 相关。使用我们从 $B(\\varepsilon)$ 得到的近似值：\n$$\n|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\left| \\left(1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - (1 + 2\\varepsilon^{2}) \\right| = \\left| -\\frac{1}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} \\right|\n$$\n由于对于 $\\varepsilon>0$，$\\sqrt{4+\\varepsilon^2} > \\sqrt{4} = 2 > \\varepsilon$ （对于小的$\\varepsilon$），绝对值内的项为正。\n$$\n|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}\n$$\n对于另一个特征值：\n$$\n|\\lambda_B^{-}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\left| \\left(1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - (1 + 2\\varepsilon^{2}) \\right| = \\left| -\\frac{1}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} \\right| = \\frac{1}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n$\\lambda_B^{+}(\\varepsilon)$ 是更接近 $\\mu_R$ 的特征值。分离 $\\lambda_3(\\varepsilon)$（由 $\\lambda_B^{+}(\\varepsilon)$ 近似）的过程的收敛性，由 $\\mu_R$ 到次近特征值 $\\lambda_2(\\varepsilon)$ 的距离与到 $\\lambda_3(\\varepsilon)$ 的距离之比决定。\n这个比率近似为：\n$$\n\\frac{|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}|}{|\\lambda_B^{-}(\\varepsilon) - \\mu_{\\mathrm{R}}|} = \\frac{\\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}}{\\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} + \\frac{1}{2}\\varepsilon^{2}} = \\frac{\\sqrt{4 + \\varepsilon^{2}} - \\varepsilon}{\\sqrt{4 + \\varepsilon^{2}} + \\varepsilon}\n$$\n对于小的 $\\varepsilon$，$\\sqrt{4 + \\varepsilon^{2}} \\approx 2(1 + \\varepsilon^2/8) = 2 + \\varepsilon^2/4$。该比率变为：\n$$\n\\frac{(2 + \\varepsilon^2/4) - \\varepsilon}{(2 + \\varepsilon^2/4) + \\varepsilon} \\approx \\frac{2 - \\varepsilon}{2 + \\varepsilon} = \\frac{1 - \\varepsilon/2}{1 + \\varepsilon/2} \\approx (1 - \\varepsilon/2)^2 \\approx 1 - \\varepsilon\n$$\n接近 1 的收敛比意味着非常缓慢的收敛。Rayleigh 位移 $\\mu_{\\mathrm{R}}(\\varepsilon)$ 位于两个接近的特征值 $\\lambda_2(\\varepsilon)$ 和 $\\lambda_3(\\varepsilon)$ 之间，但并未特别接近其中任何一个，因此在这种情况下其表现不佳。\n\n**3. 改进位移的提议与计算**\n\nRayleigh 位移的慢收敛问题可以通过选择一个能极好地近似目标特征值之一的位移来纠正。在这种情况下，标准的且远为优越的策略是 Wilkinson 位移。对于对称三对角矩阵，Wilkinson 位移被定义为末尾 $2 \\times 2$ 子矩阵中，更接近右下角元素 $T_{nn}$ 的那个特征值。\n\n在我们的例子中，末尾子矩阵是 $B(\\varepsilon)$，右下角元素是 $T_{33}(\\varepsilon) = B_{22}(\\varepsilon) = 1 + 2\\varepsilon^2$。我们必须确定两个特征值 $\\lambda_B^{-}(\\varepsilon)$ 和 $\\lambda_B^{+}(\\varepsilon)$ 中哪一个更接近 $1 + 2\\varepsilon^2$。\n我们已经在第2部分计算了这些距离：\n$$\n|\\lambda_B^{+}(\\varepsilon) - (1+2\\varepsilon^2)| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}\n$$\n$$\n|\\lambda_B^{-}(\\varepsilon) - (1+2\\varepsilon^2)| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} + \\frac{1}{2}\\varepsilon^{2}\n$$\n通过观察可以明显看出，$|\\lambda_B^{+}(\\varepsilon) - (1+2\\varepsilon^2)|  |\\lambda_B^{-}(\\varepsilon) - (1+2\\varepsilon^2)|$。\n因此，改进的位移，即 Wilkinson 位移 $\\mu_W(\\varepsilon)$，是 $\\lambda_B^{+}(\\varepsilon)$。\n\n这个改进位移的精确解析表达式是：\n$$\n\\mu_W(\\varepsilon) = \\lambda_B^{+}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n该表达式已是其最简闭式形式。这个位移选择是 $T(\\varepsilon)$ 真实特征值 $\\lambda_3(\\varepsilon)$ 的一个非常精确的近似，确保了比率 $|\\lambda_3(\\varepsilon) - \\mu_W| / |\\lambda_2(\\varepsilon) - \\mu_W|$ 极小，这反过来又保证了最末次对角线元素向零的快速（对于对称矩阵是三次）收敛。\n通过将 $1/2$ 移入平方根可以得到一个等价形式：\n$$\n\\mu_W(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\varepsilon\\sqrt{1 + \\frac{\\varepsilon^{2}}{4}}\n$$\n然而，第一种形式是标准的。",
            "answer": "$$\\boxed{1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}}$$"
        },
        {
            "introduction": "理论上的最优算法在实际的计算机中可能因为浮点数运算的限制而失效。这个练习将我们从理想的精确算术带入到数值计算的现实世界。本练习  展示了一个看似稳健的威尔金森位移在特定情况下，由于灾难性抵消（catastrophic cancellation）而导致计算失败的场景。你将学习如何通过代数变换推导出一个等价但数值稳定的“保护型”公式，从而体会到设计鲁棒数值软件的关键考量。",
            "id": "3597254",
            "problem": "考虑应用于对称三对角矩阵的带位移的正交三角（QR）算法。在带位移的 QR 算法中，位移从末尾 $2 \\times 2$ 主子矩阵的特征值中选取。设末尾块为\n$$\nB \\;=\\; \\begin{pmatrix}\n\\alpha  \\beta \\\\\n\\beta  \\gamma\n\\end{pmatrix}, \\quad \\text{其中 } \\delta \\equiv \\frac{\\alpha - \\gamma}{2}, \\quad s \\equiv \\frac{\\alpha + \\gamma}{2}, \\quad r \\equiv \\sqrt{\\delta^{2} + \\beta^{2}}.\n$$\n在浮点模型下进行计算，该模型采用四舍五入到最近值的方式，并具有 $8$ 位有效数字的十进制尾数。构造一个对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，其末尾 $2 \\times 2$ 块具有以下参数\n$$\n\\gamma \\;=\\; 0, \\quad \\delta \\;=\\; -10^{-8}, \\quad \\beta \\;=\\; 3 \\times 10^{-13},\n$$\n并假设 $T$ 的其他元素在数值上是适中的，因此只有末尾块决定位移的选择。位移取为 $B$ 的那个更接近 $\\gamma$ 的特征值。\n\n仅使用 QR 算法和浮点舍入的核心定义和公认事实，完成以下任务：\n\n1. 从 $B$ 的特征多项式出发，用 $s$ 和 $r$ 表示其特征值。当 $\\delta  0$ 时，确定 $s + r$ 和 $s - r$ 中哪一个更接近 $\\gamma$。解释为什么在有限精度下（在所述舍入模型下），对该选择的朴素计算会遭遇灾难性抵消，并确定在这种情况下朴素计算 $\\mu_{\\text{naive}}$ 所得到的值。\n\n2. 在不引用任何预先给出的“受保护公式”的情况下，通过代数推导，得到同一特征值的一个等价表示，该表示可证明能避免相减抵消。利用特征多项式所蕴含的恒等式对表达式进行有理化，得到一个在 $\\delta  0$ 时是良态的分母。然后，对于给定的数值参数，将得到的受保护表达式 $\\mu_{\\text{guarded}}$ 简化为关于小比率 $|\\beta|/|\\delta|$ 的主阶项。\n\n3. 对于给定的参数，数值计算 $\\mu_{\\text{guarded}}$，并用科学记数法表示最终答案。将最终答案四舍五入到两位有效数字。\n\n你的最终答案必须是第 3 步中获得的稳定位移 $\\mu_{\\text{guarded}}$，表示为一个科学记数法的实数。",
            "solution": "我们从末尾块开始\n$$\nB \\;=\\; \\begin{pmatrix}\n\\alpha  \\beta \\\\\n\\beta  \\gamma\n\\end{pmatrix}, \\quad \\delta \\equiv \\frac{\\alpha - \\gamma}{2}, \\quad s \\equiv \\frac{\\alpha + \\gamma}{2}, \\quad r \\equiv \\sqrt{\\delta^{2} + \\beta^{2}}.\n$$\n$B$ 的特征多项式为\n$$\np(\\lambda) \\;=\\; \\lambda^{2} - (\\alpha + \\gamma)\\lambda + (\\alpha \\gamma - \\beta^{2}),\n$$\n其两个实特征值是根\n$$\n\\lambda_{\\pm} \\;=\\; s \\pm r.\n$$\n在对称三对角带位移 QR 算法中，位移被选为更接近右下角元素 $\\gamma$ 的特征值（即所谓的 Wilkinson 选择）。我们确定当 $\\delta  0$ 时，$\\lambda_{+}$ 和 $\\lambda_{-}$ 中哪一个更接近 $\\gamma$。注意到\n$$\ns \\;=\\; \\frac{\\alpha + \\gamma}{2} \\;=\\; \\gamma + \\delta,\n$$\n所以\n$$\n\\lambda_{+} \\;=\\; s + r \\;=\\; \\gamma + \\delta + r, \\qquad \\lambda_{-} \\;=\\; s - r \\;=\\; \\gamma + \\delta - r.\n$$\n当 $\\delta  0$ 时，我们有 $r = \\sqrt{\\delta^2+\\beta^2} \\approx |\\delta| = -\\delta$。因此\n$$\n|\\lambda_{+} - \\gamma| \\;=\\; |\\delta + r| \\;\\approx\\; |\\delta - \\delta| \\;\\approx\\; 0, \\qquad |\\lambda_{-} - \\gamma| \\;\\approx\\; |\\delta - r| \\;\\approx\\; |\\delta - (-\\delta)| \\;=\\; 2|\\delta|,\n$$\n所以更接近 $\\gamma$ 的特征值是 $\\lambda_{+} = s + r$。\n\n我们现在证明，在有限精度下，$s + r$ 的朴素计算会遭遇灾难性抵消，并且在所述的舍入模型下，得到 $\\mu_{\\text{naive}} = \\gamma$。使用给定的参数\n$$\n\\gamma = 0, \\quad \\delta = -10^{-8}, \\quad \\beta = 3 \\times 10^{-13}.\n$$\n精确计算 $r$：\n$$\nr \\;=\\; \\sqrt{\\delta^{2} + \\beta^{2}} \\;=\\; \\sqrt{(-10^{-8})^{2} + (3 \\times 10^{-13})^{2}} \\;=\\; 10^{-8}\\sqrt{1 + 9 \\times 10^{-10}}.\n$$\n使用一阶展开式 $\\sqrt{1 + x} \\approx 1 + \\frac{x}{2} + \\mathcal{O}(x^{2})$，其中 $x = 9 \\times 10^{-10}$，我们有\n$$\nr \\;\\approx\\; 10^{-8}\\left(1 + \\frac{9 \\times 10^{-10}}{2} \\right) \\;=\\; 10^{-8} + 4.5 \\times 10^{-18}.\n$$\n在具有 $8$ 位有效数字的十进制四舍五入到最近值的规则下，在 $10^{-8}$ 的量级上，末位单位 (ulp) 是 $10^{-16}$。增量 $4.5 \\times 10^{-18}$ 小于半个 ulp ($5 \\times 10^{-17}$)，所以\n$$\n\\mathrm{fl}(r) \\;=\\; 10^{-8}, \\qquad \\mathrm{fl}(s) \\;=\\; \\mathrm{fl}(\\gamma + \\delta) \\;=\\; -10^{-8}.\n$$\n因此，朴素计算得到\n$$\n\\mu_{\\text{naive}} \\;=\\; \\mathrm{fl}(s + r) \\;=\\; \\mathrm{fl}(-10^{-8} + 10^{-8}) \\;=\\; 0 \\;=\\; \\gamma,\n$$\n这将位移恰好置于右下角对角线上，并在随后的隐式 QR 步中产生近乎分解的情况，因为 $B - \\mu_{\\text{naive}} I$ 的右下角对角元素为零，导致初始的凸起注入是病态的。\n\n为了恢复稳定性，我们寻求一个 $\\lambda_{+}$ 的代数等价表示，以避免两个几乎相等的数相减。我们想重写 $\\lambda_{+} = s+r = \\gamma + \\delta + r$ 中的 $\\delta+r$ 项。\n从恒等式 $r^{2} - \\delta^{2} = \\beta^{2}$，即 $(r-\\delta)(r+\\delta) = \\beta^2$，我们可以得到\n$$\nr + \\delta \\;=\\; \\frac{\\beta^{2}}{r - \\delta}.\n$$\n将此代入 $\\lambda_{+}$ 的表达式：\n$$\n\\lambda_{+} \\;=\\; \\gamma + (r + \\delta) \\;=\\; \\gamma + \\frac{\\beta^{2}}{r - \\delta}.\n$$\n当 $\\delta  0$ 时，这个新形式可以防止抵消，因为分母 $r - \\delta \\approx |\\delta| - \\delta = |\\delta| - (-|\\delta|) = 2|\\delta|$ 远离零，避免了相减。\n因此受保护的位移是\n$$\n\\mu_{\\text{guarded}} \\;=\\; \\gamma + \\frac{\\beta^{2}}{r - \\delta}.\n$$\n在小比率 $|\\beta|/|\\delta|$ 的主阶上，我们可以近似分母 $r-\\delta = \\sqrt{\\delta^2+\\beta^2} - \\delta \\approx |\\delta| - \\delta = 2|\\delta|$。这给出了渐近简化：\n$$\n\\mu_{\\text{guarded}} \\;\\approx\\; \\gamma + \\frac{\\beta^{2}}{2|\\delta|} \\;=\\; 0 + \\frac{(3 \\times 10^{-13})^{2}}{2 \\times |-10^{-8}|} \\;=\\; \\frac{9 \\times 10^{-26}}{2 \\times 10^{-8}} \\;=\\; 4.5 \\times 10^{-18}.\n$$\n这个值是一个区别于 $\\gamma$ 的小的正位移，因此它打破了导致朴素计算停滞的精确抵消，并产生了一个良态的初始隐式 QR 步。\n\n根据题目要求，我们以科学记数法报告最终值，并四舍五入到两位有效数字。主阶值已经用两位有效数字表示：\n$$\n\\mu_{\\text{guarded}} \\;\\approx\\; 4.5 \\times 10^{-18}.\n$$",
            "answer": "$$\\boxed{4.5 \\times 10^{-18}}$$"
        }
    ]
}