{
    "hands_on_practices": [
        {
            "introduction": "掌握标准特征值问题的核心，始于对其基本定义的透彻理解和熟练计算。本练习将引导你从第一性原理出发，通过一个简洁的 $2 \\times 2$ 矩阵，完整地走过求解特征值与特征向量的全过程。此过程不仅是检验你对特征多项式、代数重数和几何重数等关键概念的理解，更重要的是，它将揭示一个在数值计算中至关重要的现象——矩阵的不可对角化性。",
            "id": "3597590",
            "problem": "考虑一个实方阵的标准特征值问题，该问题由关系式 $A x = \\lambda x$ 定义，其中 $A \\in \\mathbb{R}^{n \\times n}$，$x \\in \\mathbb{R}^{n}$ 是一个非零向量，$\\lambda \\in \\mathbb{C}$ 是一个标量。令 $A = \\begin{pmatrix} 2  -1 \\\\ 1  0 \\end{pmatrix}$。根据特征值的定义（即存在非零向量 $x$ 满足 $A x = \\lambda x$ 的标量 $\\lambda$）和特征多项式的定义（即 $\\det(A - \\lambda I)$），完成以下任务：\n- 推导 $A$ 的特征多项式，并确定所有特征值及其代数重数。\n- 对每个特征值，确定其对应的特征空间及其一组基。使用特征向量的定义，对每个特征空间中的一个代表性基向量，明确验证 $A x = \\lambda x$ 成立。\n- 根据代数重数和几何重数，判断 $A$ 在 $\\mathbb{R}$ 上是否可对角化，并说明理由。\n最后，报告谱半径 $\\rho(A)$，其定义为 $\\rho(A) = \\max\\{ |\\lambda| : \\lambda \\text{ is an eigenvalue of } A \\}$。将最终报告的量表示为精确值。无需四舍五入，也不涉及单位。",
            "solution": "该问题不需要进行验证。\n\n### 步骤1：提取已知条件\n- 该问题是一个由关系式 $A x = \\lambda x$ 定义的标准特征值问题。\n- 矩阵为 $A = \\begin{pmatrix} 2  -1 \\\\ 1  0 \\end{pmatrix}$，其中 $A \\in \\mathbb{R}^{n \\times n}$。\n- 特征向量 $x \\in \\mathbb{R}^{n}$ 是一个非零向量。\n- 特征值 $\\lambda$ 是一个标量，$\\lambda \\in \\mathbb{C}$。\n- 特征多项式定义为 $\\det(A - \\lambda I)$。\n- 任务是：\n    1. 推导特征多项式并求出所有特征值及其代数重数。\n    2. 对每个特征值，确定对应的特征空间和一组基。\n    3. 对一个代表性的基向量明确验证 $A x = \\lambda x$。\n    4. 判断 $A$ 在 $\\mathbb{R}$ 上是否可对角化，并说明理由。\n    5. 报告谱半径 $\\rho(A) = \\max\\{ |\\lambda| : \\lambda \\text{ is an eigenvalue of } A \\}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据（关键）**：该问题是线性代数中的一个标准练习。所有定义（特征值、特征向量、特征多项式、可对角化性、谱半径）都是正确的，并且是该领域的基础。该问题在科学上是合理的。\n- **良态性**：该问题是良态的。提供了一个单一、特定的矩阵 $A$，并且要求的任务是清晰的、线性代数中的标准程序，这些程序会导出一个唯一的解。\n- **客观性（关键）**：该问题使用精确、客观的数学语言陈述。\n- **完整性**：解决问题所需的所有信息都已提供。矩阵 $A$ 已被完全指定。\n- **其他考虑**：该问题不是病态的、矛盾的或琐碎的。它需要应用标准的、定义明确的概念和程序。\n\n### 步骤3：结论和行动\n- **结论**：该问题有效。\n- **行动**：继续进行解答。\n\n解答过程如下展开。\n\n标准特征值问题由 $A x = \\lambda x$ 给出，其中 $\\lambda$ 是一个特征值，$x$ 是对应的非零特征向量。这可以改写为 $(A - \\lambda I)x = 0$，其中 $I$ 是单位矩阵。为了存在非平凡解（$x \\neq 0$），矩阵 $(A - \\lambda I)$ 必须是奇异的，这意味着其行列式必须为零。这个条件给出了特征方程：$\\det(A - \\lambda I) = 0$。\n\n首先，我们为给定的矩阵 $A = \\begin{pmatrix} 2  -1 \\\\ 1  0 \\end{pmatrix}$ 推导特征多项式。\n矩阵 $(A - \\lambda I)$ 是：\n$$ A - \\lambda I = \\begin{pmatrix} 2  -1 \\\\ 1  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2 - \\lambda  -1 \\\\ 1  -\\lambda \\end{pmatrix} $$\n特征多项式 $p(\\lambda)$ 是该矩阵的行列式：\n$$ p(\\lambda) = \\det(A - \\lambda I) = (2 - \\lambda)(-\\lambda) - (-1)(1) = -2\\lambda + \\lambda^2 + 1 $$\n因此，特征多项式为 $p(\\lambda) = \\lambda^2 - 2\\lambda + 1$。\n\n为了求特征值，我们解特征方程 $p(\\lambda) = 0$：\n$$ \\lambda^2 - 2\\lambda + 1 = 0 $$\n这个多项式可因式分解为 $(\\lambda - 1)^2 = 0$。\n该方程有一个重根 $\\lambda_1 = 1$。因此，只有一个不同的特征值 $\\lambda = 1$。该特征值的代数重数是特征多项式中因子 $(\\lambda - 1)$ 的幂，即 $2$。\n\n接下来，我们求对应于特征值 $\\lambda = 1$ 的特征空间。特征空间 $E_1$ 是矩阵 $(A - 1 \\cdot I)$ 的零空间。\n$$ A - I = \\begin{pmatrix} 2 - 1  -1 \\\\ 1  0 - 1 \\end{pmatrix} = \\begin{pmatrix} 1  -1 \\\\ 1  -1 \\end{pmatrix} $$\n我们需要对 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 求解方程组 $(A - I)x = 0$：\n$$ \\begin{pmatrix} 1  -1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这导出了单一的独立方程 $x_1 - x_2 = 0$，即 $x_1 = x_2$。\n特征向量的形式为 $x = \\begin{pmatrix} k \\\\ k \\end{pmatrix}$，其中 $k \\in \\mathbb{R}$ 为任意非零标量。\n特征空间 $E_1$ 是所有这类向量的集合：\n$$ E_1 = \\left\\{ k \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} : k \\in \\mathbb{R} \\right\\} = \\text{span}\\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right\\} $$\n该特征空间的一组基是单个向量 $\\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right\\}$。\n特征值 $\\lambda = 1$ 的几何重数是其特征空间的维数，即 $1$。\n\n现在，我们使用来自特征空间的代表性基向量 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和特征值 $\\lambda=1$ 来明确验证特征值-特征向量关系 $A x = \\lambda x$。\n$$ A x = \\begin{pmatrix} 2  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (2)(1) + (-1)(1) \\\\ (1)(1) + (0)(1) \\end{pmatrix} = \\begin{pmatrix} 2 - 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n对于等式右边：\n$$ \\lambda x = 1 \\cdot \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n由于两边相等，关系式 $A x = \\lambda x$ 得以验证。\n\n一个方阵是可对角化的，当且仅当对于每个不同的特征值，其代数重数等于其几何重数。对于矩阵 $A$：\n- 唯一的特征值是 $\\lambda = 1$。\n- $\\lambda = 1$ 的代数重数是 $2$。\n- $\\lambda = 1$ 的几何重数是 $1$。\n因为代数重数（$2$）不等于几何重数（$1$），所以矩阵 $A$ 在 $\\mathbb{R}$ 上（或在 $\\mathbb{C}$ 上）不可对角化。\n\n最后，我们确定谱半径 $\\rho(A)$。$A$ 的谱，记作 $\\sigma(A)$，是其所有特征值的集合。在本例中，$\\sigma(A) = \\{1\\}$。谱半径定义为谱中特征值绝对值（或复特征值的模）的最大值：\n$$ \\rho(A) = \\max\\{ |\\lambda| : \\lambda \\in \\sigma(A) \\} $$\n对于我们的矩阵 $A$，这是：\n$$ \\rho(A) = \\max\\{ |1| \\} = 1 $$\n$A$ 的谱半径是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在数值分析中，仅仅求出解是不够的，我们还必须关心解的稳定性。一个微小的输入扰动会导致解产生多大的变化？这个问题引出了“条件数”的核心概念。本练习将通过一个经典的非对角化矩阵例子，让你深入探究特征值的敏感度问题。你将从基本定义出发，推导一个有重根特征值的条件数，并直观地理解为何某些矩阵的谱结构（如存在尺寸大于1的若尔当块）会对数值扰动表现出极端的敏感性。",
            "id": "3597594",
            "problem": "考虑矩阵\n$$\nA = \\begin{pmatrix} 1  100 \\\\ 0  1 \\end{pmatrix}.\n$$\n的标准特征值问题 $A x = \\lambda x$。\n设 $\\lambda = 1$ 表示 $A$ 的（代数重数为二的）特征值。使用算子 $2$-范数（也称为谱范数）。仅使用基本定义——即特征值是特征多项式的根的定义、算子 2-范数以及（绝对）条件数是将矩阵映射到其谱的映射的局部利普希茨常数的概念——计算特征值 $\\lambda = 1$ 在矩阵 $A$ 处的绝对条件数，其定义为\n$$\n\\kappa(\\lambda; A) \\;=\\; \\limsup_{\\varepsilon \\to 0^+} \\;\\sup_{\\|E\\|_2 \\le \\varepsilon} \\;\\frac{\\mathrm{dist}\\!\\left(\\lambda, \\Lambda(A+E)\\right)}{\\varepsilon},\n$$\n其中 $\\Lambda(M)$ 表示矩阵 $M$ 的特征值集合，且 $\\mathrm{dist}(\\lambda, \\Lambda(M)) = \\min_{\\mu \\in \\Lambda(M)} |\\lambda - \\mu|$。不要引用任何预先推导出的扰动公式；通过分析小扰动 $E$ 下 $A+E$ 的特征多项式，从第一性原理推导其行为。在您的推理中，定性地解释为什么对于这个矩阵，敏感性会表现出如此的行为。\n\n您的最终答案必须是单个符号表达式。不需要四舍五入，也不涉及单位。",
            "solution": "问题要求计算矩阵 $A = \\begin{pmatrix} 1  100 \\\\ 0  1 \\end{pmatrix}$ 的特征值 $\\lambda = 1$ 的绝对条件数。所用范数为算子 2-范数 $\\| \\cdot \\|_2$。绝对条件数定义为：\n$$\n\\kappa(\\lambda; A) = \\limsup_{\\varepsilon \\to 0^+} \\sup_{\\|E\\|_2 \\le \\varepsilon} \\frac{\\mathrm{dist}(\\lambda, \\Lambda(A+E))}{\\varepsilon}\n$$\n其中 $\\Lambda(M)$ 是矩阵 $M$ 的谱，且 $\\mathrm{dist}(\\lambda, \\Lambda(M)) = \\min_{\\mu \\in \\Lambda(M)} |\\lambda - \\mu|$。\n\n设 $E = \\begin{pmatrix} e_{11}  e_{12} \\\\ e_{21}  e_{22} \\end{pmatrix}$ 为任意扰动矩阵，使得 $\\|E\\|_2 \\le \\varepsilon$。受扰矩阵为 $A+E = \\begin{pmatrix} 1+e_{11}  100+e_{12} \\\\ e_{21}  1+e_{22} \\end{pmatrix}$。\n\n$A+E$ 的特征值 $\\mu$ 是其特征多项式 $\\det(A+E-\\mu I)=0$ 的根。\n$$\n\\det\\left( \\begin{pmatrix} 1+e_{11}-\\mu  100+e_{12} \\\\ e_{21}  1+e_{22}-\\mu \\end{pmatrix} \\right) = 0\n$$\n$$\n(1+e_{11}-\\mu)(1+e_{22}-\\mu) - e_{21}(100+e_{12}) = 0\n$$\n原始特征值为 $\\lambda=1$。我们关心受扰特征值 $\\mu$ 与 $1$ 的偏差。设 $\\delta = \\mu - 1$，这意味着 $\\mu = 1+\\delta$。将此代入特征方程，得到：\n$$\n(e_{11}-\\delta)(e_{22}-\\delta) - e_{21}(100+e_{12}) = 0\n$$\n展开后，我们得到关于特征值位移 $\\delta$ 的二次方程：\n$$\n\\delta^2 - (e_{11}+e_{22})\\delta + (e_{11}e_{22} - 100e_{21} - e_{12}e_{21}) = 0\n$$\n$\\delta$ 的解由二次公式给出：\n$$\n\\delta_{1,2} = \\frac{e_{11}+e_{22} \\pm \\sqrt{(e_{11}+e_{22})^2 - 4(e_{11}e_{22} - 100e_{21} - e_{12}e_{21})}}{2}\n$$\n化简判别式：\n$$\n\\delta_{1,2} = \\frac{e_{11}+e_{22} \\pm \\sqrt{(e_{11}-e_{22})^2 + 400e_{21} + 4e_{12}e_{21}}}{2}\n$$\n受扰特征值为 $\\mu_1 = 1+\\delta_1$ 和 $\\mu_2 = 1+\\delta_2$。从 $\\lambda=1$ 到受扰特征值集合的距离为：\n$$\n\\mathrm{dist}(1, \\Lambda(A+E)) = \\min(|\\mu_1-1|, |\\mu_2-1|) = \\min(|\\delta_1|, |\\delta_2|)\n$$\n我们需要计算 $\\sup_{\\|E\\|_2 \\le \\varepsilon} \\frac{\\min(|\\delta_1|, |\\delta_2|)}{\\varepsilon}$。\n\n为了找到这个上确界，我们寻找一个“最坏情况”的扰动 $E$ 来最大化这个比率。平方根下的项 $400e_{21}$ 表明元素 $e_{21}$ 起着关键作用。对于一般矩阵，我们有不等式 $|e_{ij}| \\le \\|E\\|_2$。因此，对于 $\\|E\\|_2 \\le \\varepsilon$，我们有 $|e_{ij}| \\le \\varepsilon$。\n\n考虑一个旨在使 $400e_{21}$ 项占主导地位的特定扰动。我们选择扰动矩阵\n$$\nE_0 = \\begin{pmatrix} 0  0 \\\\ \\varepsilon  0 \\end{pmatrix}\n$$\n该矩阵的 2-范数是 $\\|E_0\\|_2 = \\sup_{\\|v\\|_2=1} \\|E_0 v\\|_2 = \\sup_{v_1^2+v_2^2=1} \\|\\begin{pmatrix} 0 \\\\ \\varepsilon v_1 \\end{pmatrix}\\|_2 = \\sup \\varepsilon|v_1| = \\varepsilon$。因此，这是一个有效的扰动，其范数为 $\\|E_0\\|_2 = \\varepsilon$。\n\n对于 $E_0$ 的这种选择，我们有 $e_{11}=e_{12}=e_{22}=0$ 和 $e_{21}=\\varepsilon$。关于 $\\delta$ 的方程变为：\n$$\n\\delta^2 - 0 \\cdot \\delta + (0 - 100\\varepsilon - 0) = 0\n$$\n$$\n\\delta^2 - 100\\varepsilon = 0\n$$\n解为 $\\delta_{1,2} = \\pm\\sqrt{100\\varepsilon} = \\pm 10\\sqrt{\\varepsilon}$。受扰特征值为 $\\mu_{1,2} = 1 \\pm 10\\sqrt{\\varepsilon}$。从 $1$ 到受扰谱的距离是：\n$$\n\\mathrm{dist}(1, \\Lambda(A+E_0)) = \\min(|10\\sqrt{\\varepsilon}|, |-10\\sqrt{\\varepsilon}|) = 10\\sqrt{\\varepsilon}\n$$\n现在我们计算这个特定扰动的比率：\n$$\n\\frac{\\mathrm{dist}(1, \\Lambda(A+E_0))}{\\varepsilon} = \\frac{10\\sqrt{\\varepsilon}}{\\varepsilon} = \\frac{10}{\\sqrt{\\varepsilon}}\n$$\n条件数的定义涉及在所有 $\\|E\\|_2 \\le \\varepsilon$ 的扰动 $E$ 上的上确界。上确界的值必须至少等于任何特定实例的值。因此：\n$$\n\\sup_{\\|E\\|_2 \\le \\varepsilon} \\frac{\\mathrm{dist}(1, \\Lambda(A+E))}{\\varepsilon} \\ge \\frac{10}{\\sqrt{\\varepsilon}}\n$$\n最后，我们取 $\\varepsilon \\to 0^+$ 时的上极限：\n$$\n\\kappa(1; A) = \\limsup_{\\varepsilon \\to 0^+} \\sup_{\\|E\\|_2 \\le \\varepsilon} \\frac{\\mathrm{dist}(1, \\Lambda(A+E))}{\\varepsilon} \\ge \\limsup_{\\varepsilon \\to 0^+} \\frac{10}{\\sqrt{\\varepsilon}}\n$$\n当 $\\varepsilon \\to 0^+$ 时，项 $\\frac{10}{\\sqrt{\\varepsilon}}$ 趋于无穷大。因此：\n$$\n\\kappa(1; A) = \\infty\n$$\n定性解释：特征值的高敏感性是矩阵 $A$ 的代数结构的结果。矩阵 $A$ 有一个特征值 $\\lambda=1$，其代数重数为 $2$，但相应特征空间的维数为 $1$（由向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 张成）。几何重数（$1$）小于代数重数（$2$），这意味着该矩阵是亏损的且不可对角化。它与一个大小为 $2$ 的若尔当块相似。亏损矩阵的特征值对扰动具有内在的敏感性。对于一个范数为 $\\varepsilon$ 的扰动，特征值的变化量级为 $\\varepsilon^{1/m}$，其中 $m$ 是与该特征值相关联的最大若尔当块的大小。在我们的例子中，$m=2$，所以特征值位移 $\\delta$ 的量级为 $\\sqrt{\\varepsilon}$。按照定义，条件数衡量的是变化率 $|\\delta|/\\varepsilon$，其行为类似于 $\\sqrt{\\varepsilon}/\\varepsilon = 1/\\sqrt{\\varepsilon}$。当 $\\varepsilon \\to 0$ 时，这个表达式发散，表明局部敏感性为无穷大。大的非对角元素 $100$ 进一步放大了这种效应。如推导所示，特征值位移与 $\\sqrt{100}=10$ 成正比，但这个有限的因子乘以了一个发散的项。",
            "answer": "$$\n\\boxed{\\infty}\n$$"
        },
        {
            "introduction": "理论计算揭示了特征问题的本质，而稳定性分析则指明了计算的挑战。现在，让我们转向实践，探索现代数值算法如何高效地解决特征值问题，特别是对于在科学与工程中广泛出现的对称矩阵。本练习要求你实现瑞利商迭代（Rayleigh Quotient Iteration, RQI）算法，这是一种收敛速度极快（局部三阶）的强大方法。通过在一系列精心设计的测试矩阵上运行你的代码，你将亲身体验该算法的威力，并观察矩阵谱分布（如特征值的分离度、重数）如何影响其收敛行为。",
            "id": "3597597",
            "problem": "实现一个完整的程序，该程序对提供的测试套件中的每个矩阵，从初始向量 $x_0 = (1,1,1)^{\\top}$ 开始，执行恰好三步瑞利商迭代 (RQI)，以近似给定实对称矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 的最大特征值。三次迭代后，报告近似的特征值和残差向量的欧几里得范数。\n\n使用以下基本原理：\n- 标准特征值问题是对于给定的实对称矩阵 $A$，寻找 $(\\lambda, x)$，其中 $x \\neq 0$，使得 $A x = \\lambda x$。\n- 对于非零向量 $x$，其相对于矩阵 $A$ 的瑞利商定义为\n$$\n\\rho_A(x) = \\frac{x^{\\top} A x}{x^{\\top} x}.\n$$\n- 对于对称矩阵 $A$，$\\rho_A(x)$ 在单位球面上的驻点是特征值方程 $A x = \\lambda x$ 的解，其中 $\\lambda = \\rho_A(x)$。\n\n您的程序必须：\n1. 对于每个测试矩阵 $A$，设置 $x_0 = (1,1,1)^{\\top}$ 并运行恰好 3 步瑞利商迭代。在每次迭代中，必须将迭代向量归一化为单位欧几里得范数。\n2. 完成 3 次迭代后，计算近似特征值 $\\widehat{\\lambda}$ 作为最终归一化向量 $x$ 的瑞利商 $\\rho_A(x)$，并计算残差向量 $r = A x - \\widehat{\\lambda} x$。\n3. 报告由 $\\widehat{\\lambda}$ 和 $\\|r\\|_2$ 组成的数对，其中 $\\|\\cdot\\|_2$ 表示欧几里得范数。\n\n测试套件：\n- 情况 1 (互异且分离良好的特征值)：\n$$\nA_1 = \\begin{bmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{bmatrix}.\n$$\n- 情况 2 (最大特征值的重数为 2)：\n$$\nA_2 = \\begin{bmatrix}\n2  0  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{bmatrix}.\n$$\n- 情况 3 (主块中有两个接近的主导特征值)：\n$$\nA_3 = \\begin{bmatrix}\n10  9  0 \\\\\n9  10  0 \\\\\n0  0  0.1\n\\end{bmatrix}.\n$$\n- 情况 4 (尺度差异和一个小特征值)：\n$$\nA_4 = \\begin{bmatrix}\n10^{-6}  0  0 \\\\\n0  5  2 \\\\\n0  2  5\n\\end{bmatrix}.\n$$\n\n数值要求和定义：\n- 将 $x_0$ 视为实向量，并在每次求解后进行归一化，以使每次迭代时 $\\|x\\|_2 = 1$。\n- 对所有向量范数均使用欧几里得范数 $\\|\\cdot\\|_2$。\n- 对于每种情况，在恰好 3 次迭代后，计算并报告：\n  - 最终向量 $x$ 的最大特征值近似估计 $\\widehat{\\lambda} = \\rho_A(x)$。\n  - 残差范数 $\\|A x - \\widehat{\\lambda} x\\|_2$。\n- 不涉及物理单位或角度单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，且无空格。\n- 每种情况的结果必须是一个双元素列表 $[\\widehat{\\lambda}, \\|r\\|_2]$。\n- 按 $A_1, A_2, A_3, A_4$ 的顺序将四种情况的结果汇总为一个列表，生成如下单行：\n$[\\![\\widehat{\\lambda}_1,\\|r_1\\|_2],[\\widehat{\\lambda}_2,\\|r_2\\|_2],[\\widehat{\\lambda}_3,\\|r_3\\|_2],[\\widehat{\\lambda}_4,\\|r_4\\|_2]\\!]$\n其中每个浮点数都四舍五入到恰好 10 位小数并打印，不带空格。",
            "solution": "我们从实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的标准特征值问题开始：寻找 $(\\lambda, x)$，其中 $x \\neq 0$，使得 $A x = \\lambda x$。对于任意非零向量 $x \\in \\mathbb{R}^n$，瑞利商定义为\n$$\n\\rho_A(x) = \\frac{x^{\\top} A x}{x^{\\top} x}.\n$$\n一个基本事实是，对于对称矩阵 $A$，$\\rho_A(x)$ 在单位球面 $\\{x \\in \\mathbb{R}^n : x^{\\top} x = 1\\}$ 约束下的驻点精确对应于 $A$ 的特征向量，并且在这种驻点上的瑞利商等于相应的特征值。具体来说，如果 $x$ 是一个驻点，那么为该约束引入一个拉格朗日乘子 $\\lambda$ 会得到驻点条件\n$$\n\\nabla_x \\left(x^{\\top} A x - \\lambda (x^{\\top} x - 1)\\right) = 0\n\\quad \\Longrightarrow \\quad\n2 A x - 2 \\lambda x = 0 \\quad \\Longrightarrow \\quad (A - \\lambda I) x = 0,\n$$\n因此 $x$ 是一个特征向量且 $\\lambda = \\rho_A(x)$。\n\n瑞利商迭代 (RQI) 可以通过对非线性系统\n$$\nF(x, \\lambda) = \\begin{bmatrix} (A - \\lambda I) x \\\\ \\tfrac{1}{2}(x^{\\top} x - 1) \\end{bmatrix} = 0,\n$$\n应用牛顿法来推导，其中第二个分量强制执行单位范数约束。通过瑞利商 $\\lambda = \\rho_A(x)$ 消去拉格朗日乘子变量，可得到一个实际的迭代过程：给定一个迭代向量 $x_k$ (归一化为 $\\|x_k\\|_2 = 1$)，我们构造瑞利商\n$$\n\\mu_k = \\rho_A(x_k) = \\frac{x_k^{\\top} A x_k}{x_k^{\\top} x_k},\n$$\n然后通过求解\n$$\n(A - \\mu_k I) y_k = x_k,\n$$\n在切线方向上对方程 $(A - \\mu_k I) x = 0$ 进行牛顿步，最后重新归一化 $x_{k+1} = \\frac{y_k}{\\|y_k\\|_2}$。更新后，可以重新计算 $\\mu_{k+1} = \\rho_A(x_{k+1})$。对于实对称矩阵 $A$，如果 $x_0$ 足够接近一个特征向量，RQI 对相应的特征对具有局部三次收敛性；此外，每一步的瑞利商都是一个更精确的特征值估计。\n\n在本任务中，我们需要：\n- 从 $x_0 = (1,1,1)^{\\top}$ 开始。\n- 对每个测试矩阵 $A$ 执行恰好 3 次上述 RQI 方案的迭代。\n- 完成 3 次迭代后，计算最终归一化迭代向量 $x$ 处的近似特征值 $\\widehat{\\lambda} = \\rho_A(x)$，并计算残差向量 $r = A x - \\widehat{\\lambda} x$ 及其残差范数 $\\|r\\|_2$。\n\n对于一个矩阵 $A$ 的算法步骤：\n1. 初始化 $x \\leftarrow x_0 = (1,1,1)^{\\top}$ 并归一化 $x \\leftarrow \\frac{x}{\\|x\\|_2}$。\n2. 对于 $k = 1,2,3$：\n   - 计算瑞利商 $\\mu = \\frac{x^{\\top} A x}{x^{\\top} x}$。\n   - 求解位移线性系统 $(A - \\mu I) y = x$ 以得到 $y$。由于 $A$ 是对称的，并且在给定场景的有限精度下，$\\mu$ 不应与特征值完全重合，因此该系统通常是非奇异的。如果它接近奇异，数值线性代数求解器仍将产生一个与浮点算术模型一致的解向量。\n   - 归一化更新 $x \\leftarrow \\frac{y}{\\|y\\|_2}$。\n3. 循环结束后，设置 $\\widehat{\\lambda} \\leftarrow \\frac{x^{\\top} A x}{x^{\\top} x}$ 并计算 $r \\leftarrow A x - \\widehat{\\lambda} x$。\n4. 报告 $\\widehat{\\lambda}$ 和 $\\|r\\|_2$。\n\n测试套件的理由和覆盖范围：\n- 情况 1 使用\n$$\nA_1 = \\begin{bmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{bmatrix},\n$$\n一个对称正定矩阵，其特征值互异且分离度适中。这是一个标准的“理想路径”情况，在这种情况下 RQI 应能快速精炼与 $x_0$ 的主导特征向量分量相对应的特征值。\n- 情况 2 使用\n$$\nA_2 = \\begin{bmatrix}\n2  0  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{bmatrix},\n$$\n其最大特征值的重数为 2。这用于探究当顶部特征空间不是一维时的行为；RQI 仍然可以收敛到对应于最大特征值的不变子空间，并且瑞利商仍然是一个有效的特征值估计。\n- 情况 3 使用\n$$\nA_3 = \\begin{bmatrix}\n10  9  0 \\\\\n9  10  0 \\\\\n0  0  0.1\n\\end{bmatrix},\n$$\n其中领头的 $2 \\times 2$ 子块有两个接近的特征值，在谱的顶端产生了一个小谱隙。这测试了 RQI 在面对具有挑战性的特征值簇时的敏感性和精炼能力。\n- 情况 4 使用\n$$\nA_4 = \\begin{bmatrix}\n10^{-6}  0  0 \\\\\n0  5  2 \\\\\n0  2  5\n\\end{bmatrix},\n$$\n其元素尺度差异很大并包含一个非常小的特征值，用于探究关于位移求逆步骤的数值稳定性和条件。\n\n数值输出：\n- 对于每种情况，在 3 次迭代后，按所述计算 $\\widehat{\\lambda}$ 和 $\\|r\\|_2$。\n- 四舍五入和格式化：程序必须将每个浮点结果四舍五入到恰好 10 位小数，并以如下形式输出单行，不含空格：\n$$\n[\\,[\\widehat{\\lambda}_1,\\|r_1\\|_2],[\\widehat{\\lambda}_2,\\|r_2\\|_2],[\\widehat{\\lambda}_3,\\|r_3\\|_2],[\\widehat{\\lambda}_4,\\|r_4\\|_2]\\,],\n$$\n\n该算法基于瑞利商和特征值方程的核心定义，并通过瑞利商迭代固有的位移求逆牛顿步来实现。残差范数 $\\|A x - \\widehat{\\lambda} x\\|_2$ 量化了在规定迭代次数后计算出的特征对的质量。",
            "answer": "[[4.6180339888,0.0000000000],[2.0000000000,0.0000000000],[19.0000000000,0.0000000000],[7.0000000000,0.0000000000]]"
        }
    ]
}