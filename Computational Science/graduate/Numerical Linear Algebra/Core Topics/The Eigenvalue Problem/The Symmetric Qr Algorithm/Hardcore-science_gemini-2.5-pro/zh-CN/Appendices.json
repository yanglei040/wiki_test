{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固 QR 算法的基本运作机制。通过手动构造 Givens 旋转将一个对称三对角矩阵三角化，你将具体理解正交因子 $Q$ 和上三角因子 $R$ 是如何形成的，这是每次 QR 迭代的基石。",
            "id": "3597852",
            "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个实对称三对角矩阵\n$$\nA \\;=\\;\n\\begin{pmatrix}\n5  2  0 \\\\\n2  4  3 \\\\\n0  3  1\n\\end{pmatrix}.\n$$\n实矩阵 $A$ 的正交三角(QR)分解是其一种表示形式 $A = Q R$，其中 $Q$ 是正交矩阵（即 $Q^{\\top} Q = I$），$R$ 是上三角矩阵。对于对称三对角矩阵，对称 QR 算法应用一系列平面 Givens 旋转来消去次对角线元素，在保持正交性的同时，在变换后的矩阵中维持上三角结构。\n\n从正交性和 Givens 旋转的基本定义出发，显式地构造一个由两次 Givens 旋转组成的序列，当它们从左侧乘以 $A$ 时，会消去其第 $1$ 列和第 $2$ 列的次对角线元素。将这些旋转表示为 $G_{1}$（作用于第 $1$ 行和第 $2$ 行）和 $G_{2}$（作用于第 $2$ 行和第 $3$ 行）。从第一性原理出发，验证得到的矩阵 $R = G_{2} G_{1} A$ 是上三角矩阵，且正交因子满足 $Q = G_{1}^{\\top} G_{2}^{\\top}$。用符号形式提供所有中间量（不要代入十进制近似值），并且只使用由核心定义证明的精确代数运算。\n\n你的最终任务是报告通过此过程得到的上三角因子 $R$ 的 $(2,3)$ 元素的确切闭式值。将最终答案表示为单一的解析表达式。不需要四舍五入。",
            "solution": "此问题需进行验证。\n\n### 第一步：提取已知信息\n已知条件如下：\n- 一个实对称三对角矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n5  2  0 \\\\\n2  4  3 \\\\\n0  3  1\n\\end{pmatrix}\n$$\n- QR 分解定义为 $A = Q R$，其中 $Q$ 是正交矩阵（$Q^{\\top} Q = I$），$R$ 是上三角矩阵。\n- 该过程涉及通过左乘应用一系列两次 Givens 旋转，$G_{1}$ 和 $G_{2}$。\n- $G_{1}$ 作用于第 1 行和第 2 行，以消去第 1 列的次对角线元素。\n- $G_{2}$ 作用于第 2 行和第 3 行，以消去第 2 列的次对角线元素。\n- 得到的上三角矩阵是 $R = G_{2} G_{1} A$。\n- 正交因子是 $Q = G_{1}^{\\top} G_{2}^{\\top}$。\n- 任务是求出 $R$ 的 $(2,3)$ 元素的确切值。\n\n### 第二步：使用提取的已知信息进行验证\n1.  **科学性：** 该问题描述了数值线性代数中的一个标准过程，具体来说是使用 Givens 旋转对三对角矩阵进行 QR 分解的第一步。所有概念在数学中都是公认的。\n2.  **适定性：** 问题陈述清晰。矩阵 $A$ 已给出，过程已定义，并且指明了最终要求的值。有足够的信息来找到唯一解。\n3.  **客观性：** 问题使用了精确的数学语言，没有任何主观或模棱两可的陈述。\n4.  **完整性与一致性：** 已知条件是自洽的。Givens 旋转、正交性和 QR 算法的定义都是标准的。问题不包含相互矛盾的约束。\n\n### 第三步：结论与行动\n此问题被判定为**有效**。将提供完整解答。\n\n***\n\n目标是计算矩阵 $R$ 的 $(2,3)$ 元素，其中 $R = G_{2} G_{1} A$。这个过程涉及使用 Givens 旋转进行两步消元。\n\n一个通用的 $2 \\times 2$ Givens 旋转矩阵具有以下形式：\n$$\nG(\\theta) = \\begin{pmatrix} \\cos(\\theta) & -\\sin(\\theta) \\\\ \\sin(\\theta) & \\cos(\\theta) \\end{pmatrix} = \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n$$\n其中 $c^2 + s^2 = 1$。当应用于向量 $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 时，结果是 $\\begin{pmatrix} cx_1 - sx_2 \\\\ sx_1 + cx_2 \\end{pmatrix}$。为消去第二个分量，我们需要 $sx_1 + cx_2 = 0$。满足此条件及 $c^2+s^2=1$ 的一个标准选择是 $c = \\frac{x_1}{\\sqrt{x_1^2 + x_2^2}}$ 和 $s = \\frac{-x_2}{\\sqrt{x_1^2 + x_2^2}}$。\n\n**第一步：消去 $A$ 的 $(2,1)$ 元素**\n\n我们对 $A$ 的第 1 行和第 2 行应用一个 Givens 旋转 $G_1$ 来消去元素 $A_{21}=2$。相关元素来自第一列：$x_1 = A_{11} = 5$ 和 $x_2 = A_{21} = 2$。\n\n旋转的参数 $c_1$ 和 $s_1$ 计算如下：\n$$\nr_1 = \\sqrt{x_1^2 + x_2^2} = \\sqrt{5^2 + 2^2} = \\sqrt{25 + 4} = \\sqrt{29}\n$$\n$$\nc_1 = \\frac{x_1}{r_1} = \\frac{5}{\\sqrt{29}}, \\quad s_1 = \\frac{-x_2}{r_1} = \\frac{-2}{\\sqrt{29}}\n$$\nGivens 旋转矩阵 $G_1$ 作用于第一和第二坐标平面，在其他地方是单位矩阵。\n$$\nG_1 = \\begin{pmatrix} c_1 & -s_1 & 0 \\\\ s_1 & c_1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{\\sqrt{29}} & \\frac{2}{\\sqrt{29}} & 0 \\\\ \\frac{-2}{\\sqrt{29}} & \\frac{5}{\\sqrt{29}} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n我们现在计算中间矩阵 $A' = G_1 A$：\n$$\nA' = \\begin{pmatrix} \\frac{5}{\\sqrt{29}} & \\frac{2}{\\sqrt{29}} & 0 \\\\ \\frac{-2}{\\sqrt{29}} & \\frac{5}{\\sqrt{29}} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 5 & 2 & 0 \\\\ 2 & 4 & 3 \\\\ 0 & 3 & 1 \\end{pmatrix}\n$$\n$A'$ 的各行为：\n- 第 1 行：$(\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 5 & 2 & 0 \\end{pmatrix} + (\\frac{2}{\\sqrt{29}})\\begin{pmatrix} 2 & 4 & 3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 25+4 & 10+8 & 0+6 \\end{pmatrix} = \\begin{pmatrix} \\frac{29}{\\sqrt{29}} & \\frac{18}{\\sqrt{29}} & \\frac{6}{\\sqrt{29}} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{29} & \\frac{18}{\\sqrt{29}} & \\frac{6}{\\sqrt{29}} \\end{pmatrix}$\n- 第 2 行：$(\\frac{-2}{\\sqrt{29}})\\begin{pmatrix} 5 & 2 & 0 \\end{pmatrix} + (\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 2 & 4 & 3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} -10+10 & -4+20 & 0+15 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{16}{\\sqrt{29}} & \\frac{15}{\\sqrt{29}} \\end{pmatrix}$\n- 第 3 行：该行保持不变：$\\begin{pmatrix} 0 & 3 & 1 \\end{pmatrix}$。\n\n因此，中间矩阵为：\n$$\nA' = \\begin{pmatrix} \\sqrt{29} & \\frac{18}{\\sqrt{29}} & \\frac{6}{\\sqrt{29}} \\\\ 0 & \\frac{16}{\\sqrt{29}} & \\frac{15}{\\sqrt{29}} \\\\ 0 & 3 & 1 \\end{pmatrix}\n$$\n如要求，$(2,1)$ 元素已被消去。\n\n**第二步：消去 $A'$ 的 $(3,2)$ 元素**\n\n接着，我们对 $A'$ 的第 2 行和第 3 行应用一个 Givens 旋转 $G_2$ 来消去元素 $A'_{32}=3$。相关元素来自 $A'$ 的第二列：$x_1' = A'_{22} = \\frac{16}{\\sqrt{29}}$ 和 $x_2' = A'_{32} = 3$。\n\n该旋转的参数 $c_2$ 和 $s_2$ 为：\n$$\nr_2 = \\sqrt{(x_1')^2 + (x_2')^2} = \\sqrt{\\left(\\frac{16}{\\sqrt{29}}\\right)^2 + 3^2} = \\sqrt{\\frac{256}{29} + 9} = \\sqrt{\\frac{256 + 9 \\cdot 29}{29}} = \\sqrt{\\frac{256 + 261}{29}} = \\sqrt{\\frac{517}{29}}\n$$\n$$\nc_2 = \\frac{x_1'}{r_2} = \\frac{16/\\sqrt{29}}{\\sqrt{517/29}} = \\frac{16}{\\sqrt{517}}, \\quad s_2 = \\frac{-x_2'}{r_2} = \\frac{-3}{\\sqrt{517/29}} = \\frac{-3\\sqrt{29}}{\\sqrt{517}}\n$$\nGivens 旋转矩阵 $G_2$ 作用于第二和第三坐标平面：\n$$\nG_2 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & c_2 & -s_2 \\\\ 0 & s_2 & c_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{16}{\\sqrt{517}} & \\frac{3\\sqrt{29}}{\\sqrt{517}} \\\\ 0 & \\frac{-3\\sqrt{29}}{\\sqrt{517}} & \\frac{16}{\\sqrt{517}} \\end{pmatrix}\n$$\n\n**第三步：计算 $R = G_2 A'$ 的 $(2,3)$ 元素**\n\n最终的上三角矩阵是 $R = G_2 A'$。我们需要求的是元素 $R_{23}$。该元素是 $G_2$ 的第二行与 $A'$ 的第三列的点积。\n$$\nR_{23} = (G_2)_{21}A'_{13} + (G_2)_{22}A'_{23} + (G_2)_{23}A'_{33}\n$$\n代入数值：\n$$\nR_{23} = (0)A'_{13} + (c_2)A'_{23} + (-s_2)A'_{33} = c_2 A'_{23} - s_2 A'_{33}\n$$\n我们有 $A'_{23} = \\frac{15}{\\sqrt{29}}$ 和 $A'_{33} = 1$。代入 $c_2$ 和 $s_2$ 的值：\n$$\nR_{23} = \\left(\\frac{16}{\\sqrt{517}}\\right) \\left(\\frac{15}{\\sqrt{29}}\\right) - \\left(\\frac{-3\\sqrt{29}}{\\sqrt{517}}\\right) (1)\n$$\n$$\nR_{23} = \\frac{16 \\cdot 15}{\\sqrt{517}\\sqrt{29}} + \\frac{3\\sqrt{29}}{\\sqrt{517}}\n$$\n为了合并这些项，我们找到一个公分母，即 $\\sqrt{517}\\sqrt{29} = \\sqrt{517 \\cdot 29} = \\sqrt{14993}$。\n$$\nR_{23} = \\frac{240}{\\sqrt{14993}} + \\frac{3\\sqrt{29} \\cdot \\sqrt{29}}{\\sqrt{517}\\sqrt{29}} = \\frac{240}{\\sqrt{14993}} + \\frac{3 \\cdot 29}{\\sqrt{14993}}\n$$\n$$\nR_{23} = \\frac{240 + 87}{\\sqrt{14993}} = \\frac{327}{\\sqrt{14993}}\n$$\n\n**性质验证**\n\n根据要求，我们简要验证分解的性质。\n1.  **$Q$ 的正交性**：正交因子是 $Q=G_1^\\top G_2^\\top$。由于 Givens 旋转是正交矩阵（$G_1^\\top G_1 = I$, $G_2^\\top G_2 = I$），它们的转置也是正交的。正交矩阵的乘积是正交的。我们可以直接验证：\n    $$\n    Q^\\top Q = (G_1^\\top G_2^\\top)^\\top (G_1^\\top G_2^\\top) = (G_2 G_1) (G_1^\\top G_2^\\top) = G_2 (G_1 G_1^\\top) G_2^\\top = G_2 I G_2^\\top = G_2 G_2^\\top = I\n    $$\n2.  **$R$ 的上三角结构**：矩阵 $R=G_2 G_1 A = G_2 A'$。\n    - $A'_{21}$ 和 $A'_{31}$ 为零。应用 $G_2$ 不会改变这些值，因为 $G_2$ 只混合第 2 行和第 3 行。因此 $R_{21}=0$ 和 $R_{31}=0$。\n    - 元素 $R_{32}$ 是由 $G_2$ 的第三行和 $A'$ 的第二列计算得出。\n      $$\n      R_{32} = s_2 A'_{22} + c_2 A'_{32} = (\\frac{-3\\sqrt{29}}{\\sqrt{517}})(\\frac{16}{\\sqrt{29}}) + (\\frac{16}{\\sqrt{517}})(3) = \\frac{-48}{\\sqrt{517}} + \\frac{48}{\\sqrt{517}} = 0\n      $$\n    这证实了 $R$ 确实是一个上三角矩阵。\n\n最终推导出的 $R_{23}$ 的值是解析精确的，并且基于第一性原理。",
            "answer": "$$\\boxed{\\frac{327}{\\sqrt{14993}}}$$"
        },
        {
            "introduction": "在基本 QR 分解步骤的基础上，本练习将深入探讨现代对称 QR 算法的核心：隐式位移 QR 步骤。你将执行“凸起追逐”（bulge-chasing）序列的初始阶段，这是一种巧妙的技术，它能在不显式构造矩阵的情况下执行相似变换，从而保持三对角结构并确保计算效率。",
            "id": "3597848",
            "problem": "考虑对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，其对角线元素为 $a_1=6$、$a_2=5$、$a_3=4$、$a_4=5$、$a_5=6$，非对角线元素为 $b_1=1$、$b_2=2$、$b_3=2$、$b_4=1$，即：\n$$\nT \\;=\\;\n\\begin{pmatrix}\n6  1  0  0  0 \\\\\n1  5  2  0  0 \\\\\n0  2  4  2  0 \\\\\n0  0  2  5  1 \\\\\n0  0  0  1  6\n\\end{pmatrix}.\n$$\n使用位移 $\\mu=5$ 执行一步隐式位移正交三角分解（QR）算法的前两次凸起追逐吉文斯旋转（Givens rotation），步骤如下：\n\n1. 构造一个作用于索引 $(1,2)$ 的吉文斯旋转 $G_1$，使得 $G_1^{\\top} (T - \\mu I) e_1$ 是 $e_1$ 的标量倍，并更新 $T^{(1)} = G_1^{\\top} T G_1$。\n\n2. 然后构造一个作用于索引 $(2,3)$ 的吉文斯旋转 $G_2$，使得通过左乘 $G_2^{\\top}$ 消去 $T^{(1)}$ 的 $(3,1)$ 元素，并更新 $T^{(2)} = G_2^{\\top} T^{(1)} G_2$。\n\n仅从正交相似、吉文斯旋转和隐式位移构造的定义出发，显式地执行这两次旋转，并计算前导 $3 \\times 3$ 子块中受影响的更新后的三对角元素。报告这两次旋转后第 2 行和第 3 行之间更新后的非对角线元素的单个实数值，即 $b_2^{(2)} = T^{(2)}_{2,3}$。请以精确的封闭形式给出答案，不要四舍五入。",
            "solution": "用户希望我严格验证所提供的问题陈述，如果有效，则提供一个完整的、有理有据的解决方案。\n\n### 步骤 1：提取已知条件\n\n问题提供了以下信息：\n- 一个对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$：\n$$\nT \\;=\\;\n\\begin{pmatrix}\n6  1  0  0  0 \\\\\n1  5  2  0  0 \\\\\n0  2  4  2  0 \\\\\n0  0  2  5  1 \\\\\n0  0  0  1  6\n\\end{pmatrix}\n$$\n对角线元素为 $a_1=6$、$a_2=5$、$a_3=4$、$a_4=5$、$a_5=6$。非对角线元素为 $b_1=1$、$b_2=2$、$b_3=2$、$b_4=1$。注意 $T_{i,i} = a_i$ 且 $T_{i,i+1} = T_{i+1,i} = b_i$。\n- 一个位移值 $\\mu = 5$。\n- 指定了一个两步过程：\n    1. 构造一个作用于索引 $(1,2)$ 的吉文斯旋转 $G_1$，使得 $G_1^{\\top} (T - \\mu I) e_1$ 是 $e_1$ 的标量倍。然后计算更新后的矩阵 $T^{(1)} = G_1^{\\top} T G_1$。\n    2. 构造一个作用于索引 $(2,3)$ 的吉文斯旋转 $G_2$，使得通过左乘 $G_2^{\\top}$ 消去 $T^{(1)}$ 的 $(3,1)$ 元素。然后计算更新后的矩阵 $T^{(2)} = G_2^{\\top} T^{(1)} G_2$。\n- 最终目标是计算这两次旋转后第 2 行和第 3 行之间更新后的非对角线元素的值，记为 $b_2^{(2)} = T^{(2)}_{2,3}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n- **科学依据：** 该问题描述了对称矩阵隐式QR算法中凸起追逐过程的前两个步骤。这是数值线性代数中计算特征值的基本标准技术。该问题在科学上是合理的。\n- **适定性：** 所有必要数据（$T$、$\\mu$）和所需步骤都得到了明确无误的定义。该任务会导出一个唯一的、可计算的值。\n- **客观性：** 问题以精确的数学语言陈述，没有任何主观性或偏见。\n\n该问题没有违反任何无效性标准。这是一个定义明确的数值线性代数练习。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。我们开始求解。\n\n### 解答\n\n该过程包括使用吉文斯旋转的两个阶段的相似变换。\n\n**阶段 1：第一次吉文斯旋转以产生凸起**\n\n带位移 $\\mu$ 的隐式QR迭代的第一步是应用一个旋转 $G_1$，如果我们显式计算，这个旋转会在位移矩阵 $T - \\mu I$ 的第一列中引入一个零。$T - \\mu I$ 的第一列由下式给出：\n$$\nx = (T - \\mu I)e_1 = (T - 5I)e_1 =\n\\begin{pmatrix}\n6-5 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n我们需要找到一个作用于 $(1,2)$ 平面的吉文斯旋转 $G_1$，它将向量 $x$ 的第二个分量置零。一个吉文斯旋转矩阵 $G(i,j,c,s)$ 通常被定义为其转置 $G(i,j,c,s)^{\\top}$ 来旋转向量。设该旋转由 $c = \\cos(\\theta)$ 和 $s = \\sin(\\theta)$ 定义。作用于 $(1,2)$ 平面的矩阵 $G_1^{\\top}$ 的形式如下：\n$$\nG_1^{\\top} =\n\\begin{pmatrix}\nc  s  0  0  0 \\\\\n-s  c  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n为了将 $x=(1,1,0,0,0)^{\\top}$ 的第二个分量置零，我们设 $c = \\frac{x_1}{r}$ 和 $s = \\frac{x_2}{r}$，其中 $r = \\sqrt{x_1^2 + x_2^2}$。\n当 $x_1=1$ 且 $x_2=1$ 时：\n$$\nr = \\sqrt{1^2 + 1^2} = \\sqrt{2}\n$$\n$$\nc = \\frac{1}{\\sqrt{2}}, \\quad s = \\frac{1}{\\sqrt{2}}\n$$\n隐式QR方法通过相似变换将此旋转应用于矩阵 $T$ 本身：$T^{(1)} = G_1^{\\top} T G_1$。此变换仅影响第 1 行和第 2 行以及第 1 列和第 2 列。\n$G_1 = (G_1^{\\top})^{\\top} = \\begin{pmatrix}\nc & -s & 0 & \\dots \\\\\ns & c & 0 & \\dots \\\\\n0 & 0 & 1 & \\dots \\\\\n\\vdots & & & \\ddots\n\\end{pmatrix}$。\n变换为 $T^{(1)} = G_1^{\\top} T G_1$。这在位置 $(1,3)$ 和 $(3,1)$ 处产生一个非零项，即“凸起”。让我们计算 $T^{(1)}$ 中与下一步相关的元素。\n变化被限制在一个子问题中。让我们考虑 $T$ 的左上角 $3 \\times 3$ 子块：\n$$\nT_{1:3,1:3} = \\begin{pmatrix} 6 & 1 & 0 \\\\ 1 & 5 & 2 \\\\ 0 & 2 & 4 \\end{pmatrix}\n$$\n作用于该子块的变换为：\n$$\nT^{(1)}_{1:3,1:3} = \\begin{pmatrix} c & s & 0 \\\\ -s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 6 & 1 & 0 \\\\ 1 & 5 & 2 \\\\ 0 & 2 & 4 \\end{pmatrix} \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n让我们计算 $T^{(1)}$ 的元素。\n$T^{(1)}_{22}$：这是对 $T$ 的前导主子矩阵进行 $2 \\times 2$ 相似变换的一部分。使用对称相似更新的公式：$A'_{22} = s^2 A_{11} - 2cs A_{12} + c^2 A_{22}$。\n$T^{(1)}_{22} = s^2 T_{11} - 2cs T_{12} + c^2 T_{22} = (\\frac{1}{\\sqrt{2}})^2(6) - 2(\\frac{1}{\\sqrt{2}})(\\frac{1}{\\sqrt{2}})(1) + (\\frac{1}{\\sqrt{2}})^2(5) = \\frac{1}{2}(6) - 1 + \\frac{1}{2}(5) = 3 - 1 + 2.5 = 4.5 = \\frac{9}{2}$。\n$T^{(1)}_{33}$：该旋转不涉及第 3 行/列，因此对角元素 $T_{33}$ 在第一次旋转中保持不变。$T^{(1)}_{33} = T_{33} = 4$。\n$T^{(1)}_{23}$：该项将旋转后的块与矩阵的其余部分耦合起来。$T^{(1)}_{23} = (G_1^\\top T G_1)_{23} = \\sum_{k,l} (G_1^\\top)_{2k} T_{kl} (G_1)_{l3}$。由于对于 $l=1,2,3$ 有 $(G_1)_{l3}=\\delta_{l3}$：\n$T^{(1)}_{23} = \\sum_{k} (G_1^\\top)_{2k} T_{k3} = -s \\cdot T_{13} + c \\cdot T_{23} = -(\\frac{1}{\\sqrt{2}})(0) + (\\frac{1}{\\sqrt{2}})(2) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$。\n\n第一次旋转还在 $T^{(1)}_{13} = T^{(1)}_{31}$ 处产生一个凸起：\n$T^{(1)}_{31} = (G_1^\\top T G_1)_{31} = \\sum_{k,l} (G_1^\\top)_{3k} T_{kl} (G_1)_{l1} = T_{32}(G_1)_{21} = (2)(s) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$。\n\n因此，在第一步之后，我们得到 $T^{(1)}$ 的相关元素如下：\n$T^{(1)}_{22} = \\frac{9}{2}$，$T^{(1)}_{33} = 4$，$T^{(1)}_{23} = \\sqrt{2}$，以及凸起 $T^{(1)}_{31} = \\sqrt{2}$。\n\n**阶段 2：第二次吉文斯旋转以追逐凸起**\n\n下一步是沿对角线“追逐”凸起。我们应用第二次吉文斯旋转 $G_2$，作用于 $(2,3)$ 平面，以消除新的非零元素 $T^{(1)}_{31} = \\sqrt{2}$。这是通过左乘 $G_2^\\top$ 来完成的，它旋转 $T^{(1)}$ 的第 2 行和第 3 行。为了将 $(3,1)$ 元素置零，我们必须利用 $T^{(1)}$ 第一列的第 2 个分量，将其第 3 个分量置零。\n$T^{(1)}$ 的第一列是：\n$$\nT^{(1)}e_1 = \\begin{pmatrix} T^{(1)}_{11} \\\\ T^{(1)}_{21} \\\\ T^{(1)}_{31} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} c T_{11} + s T_{21} \\\\ -s T_{11} + c T_{21} \\\\ s T_{32} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}(6) + \\frac{1}{\\sqrt{2}}(1) \\\\ -\\frac{1}{\\sqrt{2}}(6) + \\frac{1}{\\sqrt{2}}(1) \\\\ \\frac{1}{\\sqrt{2}}(2) \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 7/\\sqrt{2} \\\\ -5/\\sqrt{2} \\\\ \\sqrt{2} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n我们需要旋转向量 $\\begin{pmatrix} -5/\\sqrt{2} \\\\ \\sqrt{2} \\end{pmatrix}$ 以将其第二个分量置零。设新的旋转参数为 $c'$ 和 $s'$。\n$x'_2 = -5/\\sqrt{2}$ 和 $x'_3 = \\sqrt{2}$。\n$r' = \\sqrt{(x'_2)^2 + (x'_3)^2} = \\sqrt{(-\\frac{5}{\\sqrt{2}})^2 + (\\sqrt{2})^2} = \\sqrt{\\frac{25}{2} + 2} = \\sqrt{\\frac{29}{2}}$。\n我推导 $T^{(1)} e_1$ 的过程有误，因为它没有考虑与 $G_1$ 的后乘。让我们从 $T^{(1)}=G_1^\\top T G_1$ 重新计算：\n$T^{(1)}_{11} = c^2 T_{11} + s^2 T_{22} + 2cs T_{12} = \\frac{1}{2}(6) + \\frac{1}{2}(5) + 2(\\frac{1}{2})(1) = 3+2.5+1=6.5=\\frac{13}{2}$。\n$T^{(1)}_{21} = (c^2-s^2)T_{12} + cs(T_{22}-T_{11}) = 0 \\cdot 1 + \\frac{1}{2}(5-6) = -\\frac{1}{2}$。\n$T^{(1)}_{31} = \\sqrt{2}$ (如前计算)。\n所以 $T^{(1)}$ 的第一列是 $(\\frac{13}{2}, -\\frac{1}{2}, \\sqrt{2}, 0, 0)^\\top$。\n\n一个更简单的方法是利用 $G_1^\\top (T-\\mu I)e_1$ 是 $e_1$ 的标量倍这一性质。\n$G_1^\\top (T-\\mu I) e_1 = G_1^\\top \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2} \\\\ 0 \\\\ 0 \\\\ \\vdots \\end{pmatrix} = \\sqrt{2} e_1$。\n所以 $G_1^\\top(T-\\mu I) = \\sqrt{2} e_1 e_1^\\top + \\dots$。\n$(T-\\mu I) G_1 = G_1 (G_1^\\top(T-\\mu I)G_1) = G_1 (\\sqrt{2}e_1 e_1^\\top G_1 + \\dots)$。\n这条路径也很复杂。让我们使用显式计算出的 $T^{(1)}$。\n$T^{(1)}_{11} = c^2 T_{11} + s^2 T_{22} + 2cs T_{12} = \\frac{1}{2}(6) + \\frac{1}{2}(5) + 2(\\frac{1}{2})(1) = 3+2.5+1=6.5=\\frac{13}{2}$。\n$T^{(1)}_{21} = (c^2-s^2)T_{12} + cs(T_{22}-T_{11}) = 0 \\cdot 1 + \\frac{1}{2}(5-6) = -\\frac{1}{2}$。\n$T^{(1)}_{31} = \\sqrt{2}$ (如前计算)。\n所以 $T^{(1)}$ 的第一列是 $(\\frac{13}{2}, -\\frac{1}{2}, \\sqrt{2}, 0, 0)^\\top$。\n\n旋转 $G_2$ 将作用于 $(2,3)$ 平面，利用 $T^{(1)}_{21}=-1/2$ 将 $T^{(1)}_{31}=\\sqrt{2}$ 置零。相关分量为 $x'_2 = -1/2$ 和 $x'_3 = \\sqrt{2}$。\n$r' = \\sqrt{(x'_2)^2 + (x'_3)^2} = \\sqrt{(-\\frac{1}{2})^2 + (\\sqrt{2})^2} = \\sqrt{\\frac{1}{4} + 2} = \\sqrt{\\frac{9}{4}} = \\frac{3}{2}$。\n新的旋转参数是：\n$c' = \\frac{x'_2}{r'} = \\frac{-1/2}{3/2} = -\\frac{1}{3}$。\n$s' = \\frac{x'_3}{r'} = \\frac{\\sqrt{2}}{3/2} = \\frac{2\\sqrt{2}}{3}$。\n\n现在我们计算 $T^{(2)} = G_2^{\\top} T^{(1)} G_2$。我们关心的是元素 $T^{(2)}_{2,3}$。旋转 $G_2$ 作用于第 2 行/列和第 3 行/列。我们可以通过考虑对子矩阵 $T^{(1)}_{2:3, 2:3}$ 的相似变换来找到元素 $T^{(2)}_{2,3}$。\n设 $A = T^{(1)}_{2:3, 2:3} = \\begin{pmatrix} T^{(1)}_{22} & T^{(1)}_{23} \\\\ T^{(1)}_{32} & T^{(1)}_{33} \\end{pmatrix} = \\begin{pmatrix} 9/2 & \\sqrt{2} \\\\ \\sqrt{2} & 4 \\end{pmatrix}$。\n更新后的子矩阵为 $A' = G'^{\\top} A G'$，其中 $G' = \\begin{pmatrix} c' & -s' \\\\ s' & c' \\end{pmatrix}$。\n$A'$ 的 $(1,2)$ 元素对应于 $T^{(2)}_{2,3}$。\n$A'_{12} = (c'^2 - s'^2)A_{12} + c's'(A_{22} - A_{11})$。\n我们有以下数值：\n$c' = -1/3 \\implies c'^2 = 1/9$。\n$s' = 2\\sqrt{2}/3 \\implies s'^2 = 8/9$。\n$A_{11} = T^{(1)}_{22} = 9/2$。\n$A_{12} = T^{(1)}_{23} = \\sqrt{2}$。\n$A_{22} = T^{(1)}_{33} = 4$。\n\n将这些值代入 $A'_{12}$ 的公式中：\n$T^{(2)}_{2,3} = \\left(\\frac{1}{9} - \\frac{8}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{1}{3}\\right)\\left(\\frac{2\\sqrt{2}}{3}\\right)\\left(4 - \\frac{9}{2}\\right)$。\n$T^{(2)}_{2,3} = \\left(-\\frac{7}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(\\frac{8}{2} - \\frac{9}{2}\\right)$。\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(-\\frac{1}{2}\\right)$。\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{2\\sqrt{2}}{18}$。\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{\\sqrt{2}}{9}$。\n$T^{(2)}_{2,3} = -\\frac{6\\sqrt{2}}{9} = -\\frac{2\\sqrt{2}}{3}$。\n\n更新后的非对角线元素 $b_2^{(2)}$ 的值是 $T^{(2)}_{2,3}$。",
            "answer": "$$\n\\boxed{-\\frac{2\\sqrt{2}}{3}}\n$$"
        },
        {
            "introduction": "一个迭代算法的实用价值取决于其收敛和终止的能力。本练习聚焦于对 QR 算法效率至关重要的“紧缩”（deflation）过程。通过推导并应用一个基于向后误差原理的标准紧缩检验，你将学会算法如何识别已收敛的特征值，从而将问题分解为更小、更易于管理的部分。",
            "id": "3597821",
            "problem": "考虑对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，\n$$\nT \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  1.0 \\times 10^{-16} \\\\\n0  0  0  1.0 \\times 10^{-16}  9\n\\end{pmatrix}.\n$$\n将带有 Wilkinson 位移的单步正交三角（QR）算法应用于对称三对角矩阵，会执行一个保持对称性和三对角结构的正交相似变换。在遵循标准舍入模型 $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1 + \\delta)$（其中 $|\\delta| \\leq u$，$u$ 为单位舍入）的浮点运算中，计算出的步骤是向后稳定的，即对于一个轻微扰动的矩阵是精确的。假设机器模型为电气与电子工程师协会（IEEE）双精度，单位舍入 $u = 2^{-53}$。\n\n从对称三对角矩阵的正交相似变换的后向误差观点以及特征值在正交相似性下的不变性出发，推导一个针对索引为 $k$ 的次对角线元素 $b_{k}$ 的实际合理的降阶检验（deflation test），以确保任何强制置零 $b_{k} \\leftarrow 0$ 的操作都在计算出的 QR 步骤的后向误差范围内。将你推导出的检验方法应用于 $T$ 的末尾次对角线元素，并判断是否应在该索引处执行降阶。如果执行降阶，写下执行降阶后得到的块对角结构。你最终报告的量必须是发生分裂的降阶索引 $k$。如果不需要降阶，则报告 $k = 0$。\n\n以单个整数形式提供你的最终答案。无需舍入。不涉及物理单位。",
            "solution": "该问题要求推导一个用于对称QR算法的实际合理的降阶检验方法，并将其应用于一个特定的对称三对角矩阵 $T$。\n\n首先，我们验证问题陈述的有效性。\n给定条件如下：\n矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$：\n$$\nT \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  1.0 \\times 10^{-16} \\\\\n0  0  0  1.0 \\times 10^{-16}  9\n\\end{pmatrix}\n$$\n浮点运算法则模型为 $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1 + \\delta)$，其中 $|\\delta| \\leq u$。\n对于 IEEE 双精度，单位舍入为 $u = 2^{-53}$。\n背景是应用了 Wilkinson 位移的对称 QR 算法的单步计算。计算出的步骤是向后稳定的。\n\n该问题在数值线性代数这一成熟领域有其科学依据，特别是在特征值算法的误差分析方面。它提法明确、客观，并包含足够的信息以得到唯一解。因此，该问题是有效的。\n\n我们来推导降阶检验。设 $T$ 是一个大小为 $n \\times n$ 的对称三对角矩阵，其对角线元素为 $a_1, \\dots, a_n$，次对角线元素为 $b_1, \\dots, b_{n-1}$。\n$$\nT \\;=\\;\n\\begin{pmatrix}\na_1  b_1    \\\\\nb_1  a_2  b_2   \\\\\n \\ddots  \\ddots  \\ddots  \\\\\n  b_{n-2}  a_{n-1}  b_{n-1} \\\\\n   b_{n-1}  a_n\n\\end{pmatrix}\n$$\nQR 算法的核心原理是生成一个正交相似矩阵序列 $T_s$，该序列收敛于一个由特征值组成的对角矩阵。由于浮点运算，计算出的迭代矩阵 $\\hat{T}_{s+1}$ 与前一个迭代矩阵 $T_s$ 并非完全正交相似。然而，由 J.H. Wilkinson 开创的后向误差分析表明，$\\hat{T}_{s+1}$ 与一个扰动矩阵 $T_s + E_s$ 完全正交相似，其中 $E_s$ 是一个对称扰动矩阵。$E_s$ 的元素很小，数量级约为 $u \\|T_s\\|$，其中 $u$ 是单位舍入。\n\n降阶是将一个足够小的次对角线元素 $b_k$ 置为零的过程。这将矩阵解耦成两个更小的、独立的三对角块 $T(1:k, 1:k)$ 和 $T(k+1:n, k+1:n)$。整个特征值问题于是简化为两个更小的子问题。这一策略对于算法的效率和收敛性至关重要。\n\n将 $b_k=0$ 的理由来自后向误差的观点。将 $b_k$ 置为零会对矩阵 $T$ 引入一个扰动 $\\Delta T_k$，其中唯一的非零项是 $(\\Delta T_k)_{k, k+1} = (\\Delta T_k)_{k+1, k} = -b_k$。修改后矩阵 $T - \\Delta T_k$ 的特征值是两个所得块的特征值的并集。根据对称矩阵的 Bauer-Fike 定理，特征值的扰动由变化的谱范数界定，即 $\\|\\Delta T_k\\|_2 = |b_k|$。\n\n关键步骤是确定这个扰动 $|b_k|$ 何时是“可接受的小”。如果一个扰动与先前计算累积的舍入误差导致的矩阵元素内在不确定性处于同一数量级，那么这个扰动就是可接受的。计算出的对角元素 $a_k$ 和 $a_{k+1}$ 并非精确值；它们分别带有大约 $u|a_k|$ 和 $u|a_{k+1}|$ 的不确定性。\n\n一个实用且广泛使用的降阶准则是，如果 $b_k$ 的量级相对于其相邻对角线元素的大小而言，达到了机器精度的量级，则可认为 $b_k$ 是可忽略的。这确保了将 $b_k$ 置零的影响消融在 $a_k$ 和 $a_{k+1}$ 浮点表示的“噪声”中。具体的检验方法是：\n$$|b_k| \\le u (|a_k| + |a_{k+1}|)$$\n如果这个条件成立，我们可以设置 $b_k \\leftarrow 0$，而不会引入超出 QR 算法单步计算固有后向误差的显著误差。这就是我们将要使用的实际合理的降阶检验。\n\n现在，我们将此检验应用于给定的矩阵 $T$。矩阵元素为：\n对角线元素：$a_1=4$，$a_2=6$，$a_3=5$，$a_4=7$，$a_5=9$。\n次对角线元素：$b_1=0.8$，$b_2=0.3$，$b_3=0.4$，$b_4=1.0 \\times 10^{-16}$。\n\n问题要求检验末尾的次对角线元素，即 $b_4$。因此，我们设 $k=4$。相关元素为：\n$b_4 = 1.0 \\times 10^{-16}$\n$a_4 = 7$\n$a_5 = 9$\n单位舍入给定为 $u = 2^{-53}$。\n\n我们将这些值代入降阶不等式：\n$$|b_4| \\le u (|a_4| + |a_5|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (|7| + |9|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (16)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} \\cdot 2^4$$\n$$1.0 \\times 10^{-16} \\le 2^{-49}$$\n为了在没有计算器的情况下验证此不等式，我们可以比较两边的对数。例如，使用以 10 为底的对数：\n$\\log_{10}(1.0 \\times 10^{-16}) = -16$。\n$\\log_{10}(2^{-49}) = -49 \\log_{10}(2)$。\n使用近似值 $\\log_{10}(2) \\approx 0.30103$：\n$-49 \\times 0.30103 = -14.75047$。\n不等式变为 $-16 \\le -14.75047$，这是成立的。\n因此，对于 $b_4$，降阶条件得到满足。\n\n由于条件 $|b_4| \\le u(|a_4| + |a_5|)$ 成立，应当通过将 $b_4$ 置为 0 来执行降阶。这意味着矩阵 $T$ 在第 4 行和第 5 行及第 4 列和第 5 列之间分裂。发生分裂的索引是 $k=4$。\n得到的矩阵具有块对角结构：\n$$\nT' \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  0 \\\\\n0  0  0  0  9\n\\end{pmatrix}\n$$\n问题现在被分解为求解前导 $4 \\times 4$ 子矩阵和末尾 $1 \\times 1$ 子矩阵的特征值。后者立即给出一个特征值 $\\lambda=9$。然后算法将继续处理这个 $4 \\times 4$ 的子问题。\n\n发生分裂的降阶索引 $k$ 是被置为零的次对角线元素的索引。在本例中，即为 $k=4$。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}