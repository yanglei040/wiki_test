{
    "hands_on_practices": [
        {
            "introduction": "Understanding relativistic collisions requires a firm grasp of the kinematic variables that describe them. This first practice focuses on calculating the Mandelstam invariants $s$, $t$, and $u$, which are fundamental Lorentz-invariant quantities used to characterize $2 \\to 2$ scattering processes. By constructing four-momenta from given masses and three-momenta, you will gain hands-on experience with the tools essential for analyzing particle interactions in any reference frame .",
            "id": "3529989",
            "problem": "Consider a $2 \\to 2$ elastic scattering in the center-of-mass frame in natural units where the speed of light ($c$) is set to $1$. Two incoming particles with rest masses $m_{1}$ and $m_{2}$ and three-momenta $\\vec{p}_{1}$ and $\\vec{p}_{2}$ scatter into two outgoing particles with rest masses $m_{3}$ and $m_{4}$ and three-momenta $\\vec{p}_{3}$ and $\\vec{p}_{4}$. All four particles are on-shell. Use the Minkowski metric with signature $(+,-,-,-)$.\n\nSpecify the kinematics as follows:\n- Masses: $m_{1} = m_{3} = 0.13957\\,\\mathrm{GeV}$ and $m_{2} = m_{4} = 0.93827\\,\\mathrm{GeV}$.\n- Incoming three-momenta: $\\vec{p}_{1} = (0,\\,0,\\,2.000)\\,\\mathrm{GeV}$ and $\\vec{p}_{2} = (0,\\,0,\\,-2.000)\\,\\mathrm{GeV}$.\n- Outgoing three-momenta: choose $\\vec{p}_{3}$ to have magnitude $|\\vec{p}_{3}| = 2.000\\,\\mathrm{GeV}$ and to point at polar angle $\\theta = 60^{\\circ}$ in the $x$–$z$ plane (azimuth $\\phi = 0$), and set $\\vec{p}_{4} = -\\vec{p}_{3}$.\n\nTasks:\n1. Using only the on-shell condition for each particle and the definition of four-momentum, compute the on-shell energies $E_{i}$ for $i \\in \\{1,2,3,4\\}$ and assemble the four-vectors $p_{i}^{\\mu} = (E_{i},\\,\\vec{p}_{i})$.\n2. Using the definitions of the Mandelstam invariants in terms of four-vectors and the Minkowski metric, compute the invariants $s$, $t$, and $u$ numerically for this event.\n3. Verify the consistency with energy–momentum conservation by confirming that the total initial four-momentum equals the total final four-momentum, and by checking the identity $s + t + u = m_{1}^{2} + m_{2}^{2} + m_{3}^{2} + m_{4}^{2}$.\n4. Provide the numerical values of $s$, $t$, and $u$ in $\\mathrm{GeV}^{2}$. Round your final reported values to four significant figures. Angles are specified in degrees; do not convert to radians for this problem.\n\nYour final answer must consist only of the three values $(s,\\,t,\\,u)$, ordered as written, and expressed in $\\mathrm{GeV}^{2}$.",
            "solution": "### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Process:** $2 \\to 2$ elastic scattering in the center-of-mass frame.\n- **Units:** Natural units, $c=1$.\n- **Metric:** Minkowski metric with signature $(+,-,-,-)$.\n- **Masses:** $m_{1} = 0.13957\\,\\mathrm{GeV}$, $m_{2} = 0.93827\\,\\mathrm{GeV}$, $m_{3} = 0.13957\\,\\mathrm{GeV}$, $m_{4} = 0.93827\\,\\mathrm{GeV}$.\n- **Incoming 3-momenta:** $\\vec{p}_{1} = (0,\\,0,\\,2.000)\\,\\mathrm{GeV}$, $\\vec{p}_{2} = (0,\\,0,\\,-2.000)\\,\\mathrm{GeV}$.\n- **Outgoing 3-momenta:** $|\\vec{p}_{3}| = 2.000\\,\\mathrm{GeV}$ at polar angle $\\theta = 60^{\\circ}$ in the $x$–$z$ plane (azimuth $\\phi = 0$). $\\vec{p}_{4} = -\\vec{p}_{3}$.\n- **Condition:** All four particles are on-shell.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific Grounding:** The problem is firmly grounded in the principles of special relativity and particle kinematics. The use of four-vectors, Mandelstam invariants, on-shell conditions, and natural units is standard practice in computational high-energy physics. The masses correspond to a charged pion ($m_{\\pi^{\\pm}} \\approx 0.13957\\,\\mathrm{GeV}$) and a proton ($m_p \\approx 0.93827\\,\\mathrm{GeV}$), making the scenario a realistic elastic scattering process like $\\pi^+ + p \\to \\pi^+ + p$. The kinematics are specified in the center-of-mass frame ($\\vec{p}_{1} + \\vec{p}_{2} = \\vec{0}$), a standard reference frame for analyzing such interactions. The problem is scientifically sound.\n2.  **Well-Posedness:** The problem is well-posed. It provides a complete set of initial conditions for an elastic scattering event in a specific frame. The tasks are unambiguous and lead to a unique numerical solution. The conservation of energy and momentum is implicitly satisfied by the setup for elastic scattering in the CM frame ($|\\vec{p}_1| = |\\vec{p}_2| = |\\vec{p}_3| = |\\vec{p}_4|$ and $\\vec{p}_3 = -\\vec{p}_4$), which the problem correctly specifies. The request to verify this and the Mandelstam-variable identity serves as an internal consistency check.\n3.  **Objectivity:** The problem is stated in precise, objective language, using standard scientific terminology and providing explicit numerical values. It is free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is scientifically grounded, well-posed, and objective. I will proceed with the solution.\n\n### Solution\n\nThe problem asks for the calculation of particle energies, four-momenta, and the Mandelstam invariants $s$, $t$, and $u$ for a specified elastic scattering event. We work in natural units where $c=1$ and use the Minkowski metric $g_{\\mu\\nu} = \\mathrm{diag}(1, -1, -1, -1)$. The four-momentum is $p^{\\mu} = (E, \\vec{p})$, and the invariant square of a four-momentum is $p^2 = p^{\\mu}p_{\\mu} = E^2 - |\\vec{p}|^2$. The on-shell condition for a particle of mass $m$ is $p^2 = m^2$.\n\n**Task 1: Compute Energies and Four-Vectors**\n\nThe on-shell condition gives the energy of a particle as $E = \\sqrt{m^2 + |\\vec{p}|^2}$. The magnitude of the three-momentum for all particles is given or implied to be $p_{mag} = 2.000\\,\\mathrm{GeV}$.\n\nFor particles $1$ and $3$:\n$m_1 = m_3 = 0.13957\\,\\mathrm{GeV}$\n$E_1 = E_3 = \\sqrt{(0.13957\\,\\mathrm{GeV})^2 + (2.000\\,\\mathrm{GeV})^2} = \\sqrt{0.0194797849\\,\\mathrm{GeV}^2 + 4.000\\,\\mathrm{GeV}^2} = \\sqrt{4.0194797849\\,\\mathrm{GeV}^2} \\approx 2.004864\\,\\mathrm{GeV}$.\n\nFor particles $2$ and $4$:\n$m_2 = m_4 = 0.93827\\,\\mathrm{GeV}$\n$E_2 = E_4 = \\sqrt{(0.93827\\,\\mathrm{GeV})^2 + (2.000\\,\\mathrm{GeV})^2} = \\sqrt{0.8803503929\\,\\mathrm{GeV}^2 + 4.000\\,\\mathrm{GeV}^2} = \\sqrt{4.8803503929\\,\\mathrm{GeV}^2} \\approx 2.209152\\,\\mathrm{GeV}$.\n\nNow, we assemble the three-momenta and four-vectors.\n- $\\vec{p}_1 = (0, 0, 2.000)\\,\\mathrm{GeV}$\n- $\\vec{p}_2 = (0, 0, -2.000)\\,\\mathrm{GeV}$\n\nFor $\\vec{p}_3$, the magnitude is $|\\vec{p}_3| = 2.000\\,\\mathrm{GeV}$, the polar angle is $\\theta=60^{\\circ}$, and the azimuthal angle is $\\phi=0^{\\circ}$. The components are:\n$p_{3x} = |\\vec{p}_3|\\sin\\theta\\cos\\phi = 2.000 \\sin(60^{\\circ}) \\cos(0^{\\circ}) = 2.000 \\cdot (\\frac{\\sqrt{3}}{2}) \\cdot 1 = \\sqrt{3}\\,\\mathrm{GeV} \\approx 1.732\\,\\mathrm{GeV}$.\n$p_{3y} = |\\vec{p}_3|\\sin\\theta\\sin\\phi = 2.000 \\sin(60^{\\circ}) \\sin(0^{\\circ}) = 0\\,\\mathrm{GeV}$.\n$p_{3z} = |\\vec{p}_3|\\cos\\theta = 2.000 \\cos(60^{\\circ}) = 2.000 \\cdot \\frac{1}{2} = 1.000\\,\\mathrm{GeV}$.\nSo, $\\vec{p}_3 = (\\sqrt{3}, 0, 1.000)\\,\\mathrm{GeV}$.\n\nFor $\\vec{p}_4$, we are given $\\vec{p}_4 = -\\vec{p}_3$:\n$\\vec{p}_4 = (-\\sqrt{3}, 0, -1.000)\\,\\mathrm{GeV}$.\n\nThe four-vectors are (with energies in GeV):\n$p_1^{\\mu} = (2.004864, 0, 0, 2.000)$\n$p_2^{\\mu} = (2.209152, 0, 0, -2.000)$\n$p_3^{\\mu} = (2.004864, \\sqrt{3}, 0, 1.000)$\n$p_4^{\\mu} = (2.209152, -\\sqrt{3}, 0, -1.000)$\n\n**Task 2: Compute Mandelstam Invariants**\n\nThe Mandelstam invariants are defined as:\n$s = (p_1 + p_2)^2$\n$t = (p_1 - p_3)^2$\n$u = (p_1 - p_4)^2$\n\nCalculation of $s$:\nIn the center-of-mass frame, $\\vec{p}_1 + \\vec{p}_2 = \\vec{0}$.\n$p_1^{\\mu} + p_2^{\\mu} = (E_1+E_2, \\vec{0})$.\n$s = (p_1 + p_2)^2 = (E_1+E_2)^2 - |\\vec{0}|^2 = (E_1+E_2)^2$.\n$s = (2.004864\\,\\mathrm{GeV} + 2.209152\\,\\mathrm{GeV})^2 = (4.214016\\,\\mathrm{GeV})^2 \\approx 17.757915\\,\\mathrm{GeV}^2$.\n\nCalculation of $t$:\nFor elastic scattering, $E_1 = E_3$.\n$p_1^{\\mu} - p_3^{\\mu} = (E_1-E_3, \\vec{p}_1-\\vec{p}_3) = (0, \\vec{p}_1-\\vec{p}_3)$.\n$t = (p_1 - p_3)^2 = 0^2 - |\\vec{p}_1 - \\vec{p}_3|^2 = -|\\vec{p}_1 - \\vec{p}_3|^2$.\n$\\vec{p}_1 - \\vec{p}_3 = (0,0,2.000) - (\\sqrt{3},0,1.000) = (-\\sqrt{3}, 0, 1.000)\\,\\mathrm{GeV}$.\n$|\\vec{p}_1 - \\vec{p}_3|^2 = (-\\sqrt{3})^2 + 0^2 + (1.000)^2 = 3.000 + 1.000 = 4.000\\,\\mathrm{GeV}^2$.\n$t = -4.000\\,\\mathrm{GeV}^2$. This result is exact based on the given geometry.\n\nCalculation of $u$:\n$u = (p_1 - p_4)^2 = p_1^2 + p_4^2 - 2 p_1 \\cdot p_4 = m_1^2 + m_4^2 - 2(E_1 E_4 - \\vec{p}_1 \\cdot \\vec{p}_4)$.\nGiven $m_4=m_2$ and $E_4=E_2$:\n$u = m_1^2 + m_2^2 - 2(E_1 E_2 - \\vec{p}_1 \\cdot \\vec{p}_4)$.\n$\\vec{p}_1 \\cdot \\vec{p}_4 = (0, 0, 2.000) \\cdot (-\\sqrt{3}, 0, -1.000) = -2.000\\,\\mathrm{GeV}^2$.\n$u = (0.13957)^2 + (0.93827)^2 - 2( (2.004864)(2.209152) - (-2.000) )\\,\\mathrm{GeV}^2$.\n$u \\approx 0.019480 + 0.880350 - 2(4.429007 + 2.000)\\,\\mathrm{GeV}^2$.\n$u \\approx 0.899830 - 2(6.429007)\\,\\mathrm{GeV}^2 = 0.899830 - 12.858014\\,\\mathrm{GeV}^2 = -11.958184\\,\\mathrm{GeV}^2$.\n\n**Task 3: Verify Consistency**\n\nEnergy-momentum conservation, $p_1^{\\mu} + p_2^{\\mu} = p_3^{\\mu} + p_4^{\\mu}$:\nInitial total four-momentum: $p_{in}^{\\mu} = p_1^{\\mu} + p_2^{\\mu} = (E_1+E_2, \\vec{0}) = (4.214016, 0, 0, 0)\\,\\mathrm{GeV}$.\nFinal total four-momentum: $p_{out}^{\\mu} = p_3^{\\mu} + p_4^{\\mu} = (E_3+E_4, \\vec{p}_3+\\vec{p}_4)$. Since $E_3=E_1$, $E_4=E_2$, and $\\vec{p}_4=-\\vec{p}_3$, we have $p_{out}^{\\mu} = (E_1+E_2, \\vec{0}) = p_{in}^{\\mu}$. Conservation is satisfied by the problem setup.\n\nIdentity check: $s+t+u = m_1^2 + m_2^2 + m_3^2 + m_4^2$.\nSum of squared masses:\n$\\sum m_i^2 = 2(m_1^2 + m_2^2) = 2((0.13957)^2 + (0.93827)^2) \\,\\mathrm{GeV}^2$.\n$\\sum m_i^2 = 2(0.0194797849 + 0.8803503929)\\,\\mathrm{GeV}^2 = 2(0.8998301778)\\,\\mathrm{GeV}^2 = 1.799660\\,\\mathrm{GeV}^2$.\n\nSum of calculated Mandelstam variables:\n$s+t+u \\approx 17.757915 - 4.000 - 11.958184 = 1.799731\\,\\mathrm{GeV}^2$.\nThe small difference ($<0.005\\%$) between this sum and $\\sum m_i^2$ is due to rounding of intermediate energy values. The identity is verified. A more precise calculation using the identity to find $u$ gives:\n$u = \\sum m_i^2 - s - t = 1.799660 - 17.757915 - (-4.000) = -11.958255\\,\\mathrm{GeV}^2$.\n\n**Task 4: Final Numerical Values**\n\nWe are asked to round the final reported values to four significant figures.\n$s = 17.757915\\,\\mathrm{GeV}^2 \\to 17.76\\,\\mathrm{GeV}^2$.\n$t = -4.000\\,\\mathrm{GeV}^2$ (exact) $\\to -4.000\\,\\mathrm{GeV}^2$.\n$u = -11.958255\\,\\mathrm{GeV}^2 \\to -11.96\\,\\mathrm{GeV}^2$.\n\nThe final values for $(s, t, u)$ are $(17.76, -4.000, -11.96)\\,\\mathrm{GeV}^2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n17.76 & -4.000 & -11.96\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from theoretical formulas to computational practice reveals hidden challenges, especially in the extreme energy regimes of high-energy physics. This exercise shifts our focus to the numerical stability of Lorentz transformations when applied to ultra-relativistic particles, where the Lorentz factor $\\gamma$ is very large. You will analyze why direct application of the boost equations can lead to catastrophic cancellation and overflow errors, and evaluate more robust computational strategies, such as reparameterizing the boost using rapidity .",
            "id": "3530005",
            "problem": "Consider a high-energy physics simulation that applies a Lorentz boost along the $x$ axis to four-momenta $p^{\\mu} = (E/c, p_x, p_y, p_z)$ of particles in the laboratory frame. The boost has speed parameter $v$ with $\\beta = v/c$, and Lorentz factor $\\gamma = (1 - \\beta^2)^{-1/2}$. The particle energies can reach ultra-relativistic regimes with $\\gamma \\gg 1$. The code uses the Institute of Electrical and Electronics Engineers (IEEE) 754 binary64 floating-point format (commonly called double precision), for which the floating-point spacing near $1$ is approximately $2^{-52} \\approx 2.22 \\times 10^{-16}$ and the largest finite $\\exp$ output occurs near an input of about $709.78$. The simulation must remain numerically stable and avoid overflow or catastrophic cancellation.\n\nA proposed mitigation is to work with rapidity $\\eta$, defined implicitly by $\\tanh \\eta = \\beta$, so that the boost parameters can be represented in terms of hyperbolic functions of $\\eta$. In addition, a \"log-sinh\" style parameterization is suggested, in which expressions are rephrased to use logarithms of hyperbolic functions and the log-sum-exp trick to avoid overflow, deferring exponentiation until the final step where physically required.\n\nFrom the fundamental definitions of Lorentz transformations and four-vectors, analyze the numerical stability of these approaches for $\\gamma \\gg 1$ under IEEE 754 double precision arithmetic. Select all statements below that are correct.\n\nA. In IEEE 754 double precision, for $\\gamma \\gtrsim 10^{8}$, computing $\\beta = \\sqrt{1 - \\gamma^{-2}}$ rounds $1 - \\gamma^{-2}$ to $1$, so the computed $\\beta$ becomes exactly $1$, destroying the small difference $1 - \\beta \\approx 1/(2\\gamma^2)$ needed in subsequent boost computations.\n\nB. Using rapidity with boost matrix entries expressed directly as $\\cosh \\eta$ and $\\sinh \\eta$ is numerically stable for all $\\gamma$ representable in IEEE 754 double precision, since hyperbolic functions do not overflow within the double-precision range.\n\nC. Reparameterizing the boost in terms of rapidity and evaluating $\\log \\sinh \\eta$ and $\\log \\cosh \\eta$ via identities of the form $\\log \\sinh \\eta = \\eta - \\log 2 + \\log(1 - e^{-2\\eta})$ (for $\\eta > 0$) and $\\log \\cosh \\eta = \\eta - \\log 2 + \\log(1 + e^{-2\\eta})$ stabilizes the computation by avoiding overflow and catastrophic cancellation until the final exponentiation and rescaling, thereby mitigating numerical instability for $\\gamma \\gg 1$.\n\nD. For a boost along $x$, the combinations $\\gamma(1 \\pm \\beta)$ equal $e^{\\pm \\eta}$ exactly, so evaluating $\\gamma(1 - \\beta)$ via $e^{-\\eta}$ avoids subtractive cancellation and yields high-accuracy results in the ultra-relativistic limit.\n\nE. In an $x$-axis boost, the transverse components $p_y$ and $p_z$ should be multiplied by $\\gamma$ to preserve orthogonality of spatial momentum components at ultra-relativistic velocities, since otherwise numerical roundoff will corrupt transverse magnitudes.\n\nChoose all correct options.",
            "solution": "The validity of the provided statements is analyzed based on fundamental principles of special relativity, Lorentz transformations, and IEEE 754 floating-point arithmetic. The problem setup is valid. A Lorentz boost along the $x$-axis transforms the four-momentum $p^{\\mu} = (E/c, p_x, p_y, p_z)$ according to $p'^{\\mu} = \\Lambda^{\\mu'}_\\nu p^\\nu$, where the transformation matrix $\\Lambda$ is given by:\n$$\n\\Lambda^{\\mu'}_\\nu = \\begin{pmatrix} \\gamma & -\\gamma\\beta & 0 & 0 \\\\ -\\gamma\\beta & \\gamma & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\cosh \\eta & -\\sinh \\eta & 0 & 0 \\\\ -\\sinh \\eta & \\cosh \\eta & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}\n$$\nHere, $\\beta = v/c$, $\\gamma = (1 - \\beta^2)^{-1/2}$, and the rapidity $\\eta$ is defined by $\\tanh \\eta = \\beta$, which implies $\\gamma = \\cosh \\eta$ and $\\gamma\\beta = \\sinh \\eta$. We analyze each statement in the context of ultra-relativistic boosts ($\\gamma \\gg 1$) using double-precision floating-point numbers.\n\nA. In IEEE 754 double precision, for $\\gamma \\gtrsim 10^{8}$, computing $\\beta = \\sqrt{1 - \\gamma^{-2}}$ rounds $1 - \\gamma^{-2}$ to $1$, so the computed $\\beta$ becomes exactly $1$, destroying the small difference $1 - \\beta \\approx 1/(2\\gamma^2)$ needed in subsequent boost computations.\n\nThis statement addresses a numerical precision issue. In IEEE 754 binary64 (double precision), the machine epsilon, which is the distance from $1$ to the next larger representable number, is $\\epsilon_{mach} = 2^{-52} \\approx 2.22 \\times 10^{-16}$. A floating-point computation of $1 - x$ will evaluate to exactly $1$ if $|x|$ is less than approximately half the machine epsilon, i.e., $|x| < \\epsilon_{mach}/2 = 2^{-53}$.\nIn the expression $\\beta = \\sqrt{1 - \\gamma^{-2}}$, the term to evaluate is $1 - \\gamma^{-2}$. The subtraction will yield exactly $1$ if $\\gamma^{-2} < 2^{-53}$. This inequality is equivalent to $\\gamma^2 > 2^{53}$, or $\\gamma > \\sqrt{2^{53}} = 2^{26.5}$.\nNumerically, $2^{26.5} = 2^{0.5} \\times 2^{26} \\approx 1.414 \\times (2^{10})^{2.6} \\approx 1.414 \\times (10^3)^{2.6} \\approx 1.414 \\times 10^{7.8} \\approx 1.414 \\times 6.31 \\times 10^7 \\approx 8.92 \\times 10^7$.\nSo, for $\\gamma \\gtrsim 9 \\times 10^7$, the expression $1 - \\gamma^{-2}$ is rounded to $1$. The value $\\gamma \\gtrsim 10^8$ given in the statement is consistent with this threshold.\nIf $1 - \\gamma^{-2}$ evaluates to $1$, then $\\beta$ is computed as $\\sqrt{1} = 1$.\nFor large $\\gamma$, we have the approximation $\\gamma^{-2} = 1 - \\beta^2 = (1-\\beta)(1+\\beta) \\approx 2(1-\\beta)$, which means $1-\\beta \\approx 1/(2\\gamma^2)$. This small but non-zero quantity is crucial for certain calculations, such as the boost of a particle already moving relativistically in the same direction as the boost, where terms like $\\gamma(E/c - \\beta p_x) = \\gamma p_x (1-\\beta)$ appear (for $E \\approx p_x c$). If $\\beta$ is computed as $1$, then $1-\\beta=0$, and the result is incorrectly computed as $0$. This phenomenon is a form of catastrophic cancellation made absolute by the limits of floating-point representation.\nThe statement is therefore correct in its identification of the numerical threshold and its physical consequence.\n\n**Verdict for A: Correct**\n\nB. Using rapidity with boost matrix entries expressed directly as $\\cosh \\eta$ and $\\sinh \\eta$ is numerically stable for all $\\gamma$ representable in IEEE 754 double precision, since hyperbolic functions do not overflow within the double-precision range.\n\nThe problem statement specifies that the largest finite output from an `exp` function in double precision occurs for an input of about $709.78$. The hyperbolic functions $\\cosh \\eta$ and $\\sinh \\eta$ are defined as $\\cosh \\eta = (e^\\eta + e^{-\\eta})/2$ and $\\sinh \\eta = (e^\\eta - e^{-\\eta})/2$. For large positive $\\eta$, both functions are asymptotically equal to $e^\\eta/2$.\nConsequently, if $\\eta$ is greater than approximately $709.78$, the term $e^\\eta$ will overflow, resulting in an overflow for both $\\cosh \\eta$ and $\\sinh \\eta$ as well.\nThe relationship between $\\gamma$ and $\\eta$ is $\\gamma = \\cosh \\eta$. For large $\\gamma$, $\\eta \\approx \\log(2\\gamma)$. The largest finite double-precision number is approximately $1.8 \\times 10^{308}$. A Lorentz factor of $\\gamma = 10^{300}$ is a valid, representable double-precision number. For this $\\gamma$, the required rapidity would be $\\eta \\approx \\log(2 \\times 10^{300}) = \\log 2 + 300\\log 10 \\approx 0.693 + 300 \\times 2.303 \\approx 691$. While $\\cosh(691)$ would be numerically fine, a slightly larger (but still representable) $\\gamma$ like $10^{308}$ would require $\\eta \\approx \\log(2 \\times 10^{308}) \\approx 710$. Computing $\\cosh(710)$ or $\\sinh(710)$ directly would lead to overflow.\nThe premise that \"hyperbolic functions do not overflow within the double-precision range\" is false. Therefore, the conclusion that this method is stable for all representable $\\gamma$ is also false.\n\n**Verdict for B: Incorrect**\n\nC. Reparameterizing the boost in terms of rapidity and evaluating $\\log \\sinh \\eta$ and $\\log \\cosh \\eta$ via identities of the form $\\log \\sinh \\eta = \\eta - \\log 2 + \\log(1 - e^{-2\\eta})$ (for $\\eta > 0$) and $\\log \\cosh \\eta = \\eta - \\log 2 + \\log(1 + e^{-2\\eta})$ stabilizes the computation by avoiding overflow and catastrophic cancellation until the final exponentiation and rescaling, thereby mitigating numerical instability for $\\gamma \\gg 1$.\n\nLet's first verify the identities.\nFor $\\eta > 0$, $\\sinh \\eta = (e^\\eta - e^{-\\eta})/2 = \\frac{e^\\eta}{2}(1 - e^{-2\\eta})$. Taking the natural logarithm gives $\\log \\sinh \\eta = \\log(e^\\eta/2) + \\log(1 - e^{-2\\eta}) = \\eta - \\log 2 + \\log(1 - e^{-2\\eta})$.\nSimilarly, $\\cosh \\eta = (e^\\eta + e^{-\\eta})/2 = \\frac{e^\\eta}{2}(1 + e^{-2\\eta})$, which gives $\\log \\cosh \\eta = \\eta - \\log 2 + \\log(1 + e^{-2\\eta})$.\nThe identities are correct.\nFor large $\\eta$ (e.g., $\\eta \\approx 710$) where $\\cosh \\eta$ and $\\sinh \\eta$ would overflow, $\\eta$ itself is not a large number. The term $e^{-2\\eta}$ becomes very small, and $\\log(1 \\pm e^{-2\\eta})$ can be accurately computed (e.g., using the `log1p` function, which computes $\\log(1+x)$ accurately for small $x$). The expressions for $\\log \\sinh \\eta$ and $\\log \\cosh \\eta$ therefore do not overflow. This technique allows one to work with the logarithms of the boost matrix components, which remain finite. This is a standard method called the \"log-sum-exp\" trick, which defers exponentiation to avoid intermediate overflows. This method also helps prevent catastrophic cancellation, as problematic subtractions like $1-\\beta$ can be reformulated using rapidity, as discussed in option D. The tools described in this option are what enable that reformulation. By working in the log domain, one preserves the numerical information that would be lost to overflow or underflow in a direct computation.\n\n**Verdict for C: Correct**\n\nD. For a boost along $x$, the combinations $\\gamma(1 \\pm \\beta)$ equal $e^{\\pm \\eta}$ exactly, so evaluating $\\gamma(1 - \\beta)$ via $e^{-\\eta}$ avoids subtractive cancellation and yields high-accuracy results in the ultra-relativistic limit.\n\nLet's verify the identities using $\\gamma = \\cosh \\eta$ and $\\beta = \\tanh \\eta$.\n$\\gamma(1+\\beta) = \\cosh\\eta (1 + \\tanh\\eta) = \\frac{e^\\eta+e^{-\\eta}}{2} \\left(1 + \\frac{e^\\eta-e^{-\\eta}}{e^\\eta+e^{-\\eta}}\\right) = \\frac{e^\\eta+e^{-\\eta}}{2} \\left(\\frac{e^\\eta+e^{-\\eta} + e^\\eta-e^{-\\eta}}{e^\\eta+e^{-\\eta}}\\right) = \\frac{1}{2}(2e^\\eta) = e^\\eta$.\n$\\gamma(1-\\beta) = \\cosh\\eta (1 - \\tanh\\eta) = \\frac{e^\\eta+e^{-\\eta}}{2} \\left(1 - \\frac{e^\\eta-e^{-\\eta}}{e^\\eta+e^{-\\eta}}\\right) = \\frac{e^\\eta+e^{-\\eta}}{2} \\left(\\frac{e^\\eta+e^{-\\eta} - (e^\\eta-e^{-\\eta})}{e^\\eta+e^{-\\eta}}\\right) = \\frac{1}{2}(2e^{-\\eta}) = e^{-\\eta}$.\nThe identities $\\gamma(1 \\pm \\beta) = e^{\\pm\\eta}$ are mathematically exact.\nIn the ultra-relativistic limit ($\\gamma \\gg 1$), $\\beta$ is very close to $1$. The direct computation of $1-\\beta$ suffers from catastrophic cancellation, as it involves subtracting two nearly equal numbers, leading to a large loss of relative precision. As established in A, for large enough $\\gamma$, this difference is computed as exactly zero.\nThe alternative calculation involves first finding $\\eta = \\text{acosh}(\\gamma)$ and then computing $e^{-\\eta}$. The `acosh` function is numerically stable, and so is the subsequent exponentiation. This procedure completely bypasses the subtraction $1-\\beta$, thus avoiding catastrophic cancellation and producing a highly accurate result for the combination $\\gamma(1-\\beta)$. These combinations appear naturally in the transformation of light-cone momentum components and are essential for correct calculations in the ultra-relativistic regime.\n\n**Verdict for D: Correct**\n\nE. In an $x$-axis boost, the transverse components $p_y$ and $p_z$ should be multiplied by $\\gamma$ to preserve orthogonality of spatial momentum components at ultra-relativistic velocities, since otherwise numerical roundoff will corrupt transverse magnitudes.\n\nAccording to the principles of special relativity, the Lorentz transformation for the momentum components transverse to the boost direction (the $x$-axis in this case) is given by:\n$$\np'_y = p_y\n$$\n$$\np'_z = p_z\n$$\nThe transverse components of momentum are invariant under a longitudinal boost. The statement that they should be multiplied by $\\gamma$ is a direct contradiction of the Lorentz transformation laws. The justification provided is also physically incorrect. Orthogonality of spatial vectors is not, in general, a Lorentz-invariant property. Furthermore, the transformation $p'_y = p_y$ is an assignment, which is the most numerically stable operation possible—it introduces no floating-point error. Multiplying by a large factor $\\gamma$ would amplify, not mitigate, any pre-existing numerical errors in $p_y$. This statement is incorrect both in its physics and its numerical reasoning.\n\n**Verdict for E: Incorrect**",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "The invariant mass of a system of particles is one of the most important quantities in experimental physics, often revealing the existence of new particles. However, calculating it from the sum of four-momenta is fraught with numerical peril, especially for highly collimated jets where the total energy and total momentum are nearly equal. In this practical coding exercise, you will directly confront the issue of catastrophic cancellation by implementing and comparing a naive summation with more robust algorithms, demonstrating how to preserve numerical accuracy in a critical physics calculation .",
            "id": "3530040",
            "problem": "You are asked to design and implement a computational routine for invariant mass-squared aggregation in the context of Special Relativity and High-Energy Physics (HEP). The routine must diagnose and mitigate numerical instability due to catastrophic cancellation when summing nearly lightlike and collimated four-momenta. The foundational base is the Minkowski metric with signature $(+,-,-,-)$ in natural units where the speed of light $c=1$, the definition of the energy-momentum four-vector $p^\\mu=(E,\\vec p)$, and the invariant mass-squared of a system obtained by summing four-momenta and taking the Minkowski norm. For a set of $N$ particles, the invariant mass-squared $m^2$ of the system is given by\n$$\nm^2=\\left(\\sum_{i=1}^N E_i\\right)^2-\\left\\lVert \\sum_{i=1}^N \\vec p_i \\right\\rVert^2=\\left(\\sum_{i=1}^N E_i\\right)^2-\\left(\\left(\\sum_{i=1}^N p_{x,i}\\right)^2+\\left(\\sum_{i=1}^N p_{y,i}\\right)^2+\\left(\\sum_{i=1}^N p_{z,i}\\right)^2\\right).\n$$\nIn multi-jet events with nearly collinear and nearly lightlike momenta, the quantity $m^2$ is obtained as the difference of two large, nearly equal positive numbers, which is especially sensitive to floating-point rounding error. You must implement three computational strategies for the invariant mass-squared:\n- A naive summation using standard double-precision arithmetic (IEEE 754 double, where IEEE stands for the Institute of Electrical and Electronics Engineers).\n- A compensated summation using the Kahan algorithm to reduce accumulation error in $\\sum E_i$ and each component of $\\sum \\vec p_i$.\n- A mixed-precision approach that uses high-precision decimal arithmetic for the sums and the squaring, to serve as a high-accuracy reference.\n\nYour program must:\n1. Read no input and use the test suite provided below.\n2. For each test case, construct each jet’s longitudinal momentum component $p_{z,i}$ from the provided $(E_i,p_{x,i},p_{y,i},s_i)$ via\n$$\np_{z,i}=s_i\\sqrt{E_i^2-p_{x,i}^2-p_{y,i}^2},\n$$\nwhere $s_i\\in\\{+1,-1\\}$ sets the sign of $p_{z,i}$. All energies $E_i$ are specified in $\\text{GeV}$, momenta $p_{x,i},p_{y,i},p_{z,i}$ in $\\text{GeV}$, and the invariant mass-squared $m^2$ in $\\text{GeV}^2$. Angles are not used; therefore no angle unit applies.\n3. Compute the invariant mass-squared $m^2$ using:\n   - Naive summation in double precision.\n   - Kahan compensated summation in double precision.\n   - Mixed precision, using high-precision decimal arithmetic to compute the sums and the final difference.\n4. Use the mixed-precision result as the reference $m^2_{\\text{ref}}$ and report the relative errors for the naive and compensated methods as\n$$\n\\varepsilon_{\\text{naive}}=\\frac{\\left|m^2_{\\text{naive}}-m^2_{\\text{ref}}\\right|}{\\max\\left(1,\\left|m^2_{\\text{ref}}\\right|\\right)},\\quad\n\\varepsilon_{\\text{comp}}=\\frac{\\left|m^2_{\\text{comp}}-m^2_{\\text{ref}}\\right|}{\\max\\left(1,\\left|m^2_{\\text{ref}}\\right|\\right)}.\n$$\n5. Additionally, compute a cancellation severity diagnostic\n$$\n\\rho=\\frac{\\left|m^2_{\\text{ref}}\\right|}{\\left(\\left(\\sum_i E_i\\right)^2+\\left\\lVert \\sum_i \\vec p_i\\right\\rVert^2\\right)},\n$$\nusing the same high-precision sums. Small values of $\\rho$ (for example, $\\rho\\ll 1$) indicate potential catastrophic cancellation.\n\nTest suite:\n- Case $1$ (highly collimated six jets, all $p_{z,i}>0$):\n  - Jet $1$: $(E_1,p_{x,1},p_{y,1},s_1)=(600.0,0.10,-0.08,+1)$\n  - Jet $2$: $(E_2,p_{x,2},p_{y,2},s_2)=(550.0,-0.12,0.06,+1)$\n  - Jet $3$: $(E_3,p_{x,3},p_{y,3},s_3)=(500.0,0.08,0.04,+1)$\n  - Jet $4$: $(E_4,p_{x,4},p_{y,4},s_4)=(450.0,-0.07,-0.03,+1)$\n  - Jet $5$: $(E_5,p_{x,5},p_{y,5},s_5)=(400.0,0.05,0.02,+1)$\n  - Jet $6$: $(E_6,p_{x,6},p_{y,6},s_6)=(350.0,-0.04,-0.01,+1)$\n- Case $2$ (back-to-back nearly lightlike di-jet):\n  - Jet $1$: $(E_1,p_{x,1},p_{y,1},s_1)=(500.0,100.0,0.0,+1)$\n  - Jet $2$: $(E_2,p_{x,2},p_{y,2},s_2)=(500.0,-100.0,0.0,-1)$\n- Case $3$ (four jets, mixed directions):\n  - Jet $1$: $(E_1,p_{x,1},p_{y,1},s_1)=(200.0,30.0,-20.0,+1)$\n  - Jet $2$: $(E_2,p_{x,2},p_{y,2},s_2)=(150.0,-25.0,15.0,-1)$\n  - Jet $3$: $(E_3,p_{x,3},p_{y,3},s_3)=(120.0,10.0,-8.0,+1)$\n  - Jet $4$: $(E_4,p_{x,4},p_{y,4},s_4)=(80.0,-5.0,3.0,-1)$\n- Case $4$ (ten extremely collimated jets with tiny transverse momenta, all $p_{z,i}>0$):\n  - Jet $1$: $(E_1,p_{x,1},p_{y,1},s_1)=(550.0,0.0010,-0.0012,+1)$\n  - Jet $2$: $(E_2,p_{x,2},p_{y,2},s_2)=(530.0,-0.0013,0.0009,+1)$\n  - Jet $3$: $(E_3,p_{x,3},p_{y,3},s_3)=(510.0,0.0007,-0.0008,+1)$\n  - Jet $4$: $(E_4,p_{x,4},p_{y,4},s_4)=(490.0,-0.0009,0.0011,+1)$\n  - Jet $5$: $(E_5,p_{x,5},p_{y,5},s_5)=(470.0,0.0011,-0.0007,+1)$\n  - Jet $6$: $(E_6,p_{x,6},p_{y,6},s_6)=(450.0,-0.0008,0.0006,+1)$\n  - Jet $7$: $(E_7,p_{x,7},p_{y,7},s_7)=(430.0,0.0006,-0.0004,+1)$\n  - Jet $8$: $(E_8,p_{x,8},p_{y,8},s_8)=(410.0,-0.0004,0.0005,+1)$\n  - Jet $9$: $(E_9,p_{x,9},p_{y,9},s_9)=(390.0,0.0005,-0.0003,+1)$\n  - Jet $10$: $(E_{10},p_{x,10},p_{y,10},s_{10})=(370.0,-0.0003,0.0004,+1)$\n\nOutput specification:\n- For each case, compute and report a list of six real numbers\n$$\n\\left[m^2_{\\text{naive}},~m^2_{\\text{comp}},~m^2_{\\text{mixed}},~\\varepsilon_{\\text{naive}},~\\varepsilon_{\\text{comp}},~\\rho\\right],\n$$\nwhere $m^2_{\\text{naive}}$, $m^2_{\\text{comp}}$, and $m^2_{\\text{mixed}}$ are in $\\text{GeV}^2$, and $\\varepsilon_{\\text{naive}}$, $\\varepsilon_{\\text{comp}}$, and $\\rho$ are dimensionless decimals. Your program should produce a single line of output containing the results as a comma-separated list of the four case results enclosed in square brackets. For example, the format must be\n$$\n\\left[ [\\cdots], [\\cdots], [\\cdots], [\\cdots] \\right],\n$$\nwith no additional text.",
            "solution": "The problem requires the implementation and comparison of three different numerical methods for calculating the invariant mass-squared of a system of particles, a fundamental quantity in relativistic kinematics. The central challenge is to address the numerical instability known as catastrophic cancellation, which arises when computing this quantity for systems of highly collimated, high-energy particles (jets).\n\nThe foundation of this problem lies in Einstein's Special Relativity, specifically in the properties of the energy-momentum four-vector, $p^\\mu = (E, \\vec{p}) = (E, p_x, p_y, p_z)$, where $E$ is the energy and $\\vec{p}$ is the three-momentum. We work in natural units where the speed of light $c=1$. The geometry of spacetime is described by the Minkowski metric, which we use in the $(+,-,-,-)$ signature, so the Minkowski dot product of two four-vectors $a^\\mu$ and $b^\\mu$ is $a \\cdot b = a^0 b^0 - \\vec{a} \\cdot \\vec{b}$.\n\nThe invariant mass-squared, $m^2$, of a single particle is the squared Minkowski norm of its four-momentum: $m^2 = p^\\mu p_\\mu = E^2 - |\\vec{p}|^2$. This quantity is a Lorentz invariant, meaning it has the same value in all inertial reference frames. For a system of $N$ particles, the total four-momentum is the sum of the individual four-momenta, $P^\\mu = \\sum_{i=1}^N p_i^\\mu$. The invariant mass-squared of the system is then the squared norm of this total four-momentum:\n$$\nM^2 = P^\\mu P_\\mu = \\left(\\sum_{i=1}^N p_i^\\mu\\right) \\cdot \\left(\\sum_{j=1}^N p_j^\\nu\\right) = \\left(\\sum_i E_i\\right)^2 - \\left|\\sum_i \\vec{p}_i\\right|^2\n$$\nThis is the formula provided in the problem. The individual particles (jets) are treated as massless, meaning for each jet $i$, its own invariant-mass squared is $m_i^2 = E_i^2 - |\\vec{p}_i|^2 = 0$. This allows the calculation of the longitudinal momentum component $p_{z,i}$ from the given energy $E_i$ and transverse momentum components $p_{x,i}, p_{y,i}$:\n$$\np_{z,i} = s_i \\sqrt{E_i^2 - (p_{x,i}^2 + p_{y,i}^2)}\n$$\nwhere $s_i \\in \\{+1, -1\\}$ determines the direction along the z-axis.\n\nThe numerical challenge, catastrophic cancellation, occurs when $P^\\mu$ is \"light-like,\" i.e., when the total energy $E_{tot} = \\sum E_i$ is very close to the magnitude of the total momentum $|\\vec{p}_{tot}| = |\\sum \\vec{p}_i|$. This happens, for example, when all particles travel in nearly the same direction at nearly the speed of light. In this scenario, $E_{tot}^2$ and $|\\vec{p}_{tot}|^2$ are two very large, nearly-equal numbers. Standard floating-point arithmetic (like IEEE 754 double precision) has finite precision (about 16 decimal digits). When two nearly equal large numbers are subtracted, the leading, most significant digits cancel out, leaving a result dominated by the accumulated rounding errors from previous calculations. This can lead to a final value for $M^2$ that is wildly inaccurate, possibly even having the wrong sign.\n\nTo diagnose and mitigate this, we will implement and compare three computational strategies.\n\n1.  **Naive Summation (Double Precision)**: This is the most straightforward approach. The components of each four-momentum are summed using standard floating-point arithmetic. The final invariant mass-squared is computed as $M_{\\text{naive}}^2 = (\\sum E_i)^2 - ((\\sum p_{x,i})^2 + (\\sum p_{y,i})^2 + (\\sum p_{z,i})^2)$. This method is expected to perform poorly in cases of severe cancellation (e.g., highly collimated jets).\n\n2.  **Compensated Summation (Kahan Algorithm)**: This method aims to improve the accuracy of the sums. The Kahan summation algorithm is a classic technique to reduce the numerical error in the summation of a sequence of floating-point numbers. For each of the four components of the total momentum ($E_{tot}, p_{x,tot}, p_{y,tot}, p_{z,tot}$), the sum is computed as follows:\n    - Initialize a sum $S=0$ and a compensation variable $c=0$.\n    - For each term $x_i$ in the sequence:\n        1.  $y = x_i - c$ (Subtract the previous error).\n        2.  $t = S + y$ (Add to the sum).\n        3.  $c = (t - S) - y$ (The new error is the part of $y$ that was lost in the addition to $S$).\n        4.  $S = t$ (Update the sum).\n    This procedure effectively tracks the \"lost\" low-order bits and adds them back into the sum at a later stage, drastically reducing the cumulative error. The invariant mass-squared, $M_{\\text{comp}}^2$, is then calculated from these more accurate sums.\n\n3.  **Mixed-Precision Reference Calculation**: To establish a \"ground truth\", we employ arbitrary-precision arithmetic, available in Python's `decimal` module. We set a very high precision (e.g., 100 decimal digits) for these calculations. The initial jet data, given as floats, are first converted to high-precision `Decimal` objects. All subsequent operations—calculating $p_z$, summing the four-momentum components, and computing the final difference of squares—are performed using this high-precision arithmetic. The result, $M_{\\text{ref}}^2$, is considered the high-accuracy reference against which the other methods are judged.\n\nThe analysis is completed by computing two metrics:\n-   **Relative Error ($\\varepsilon$)**: For the naive and compensated methods, a relative error is calculated with respect to the reference result: $\\varepsilon = |M^2 - M_{\\text{ref}}^2| / \\max(1, |M_{\\text{ref}}^2|)$. The denominator is regularized with $\\max(1, \\dots)$ to handle cases where $M_{\\text{ref}}^2$ is zero or very small.\n-   **Cancellation Diagnostic ($\\rho$)**: This metric quantifies the severity of the cancellation. It is the ratio of the magnitude of the final result to the sum of the large numbers that were subtracted: $\\rho = |M_{\\text{ref}}^2| / (E_{tot}^2 + |\\vec{p}_{tot}|^2)$, using the high-precision sums. A value of $\\rho \\ll 1$ indicates that the result is much smaller than the numbers subtracted to obtain it, signaling severe catastrophic cancellation.\n\nThe implementation will proceed by defining a function to process each test case. This function will construct the four-momenta, apply each of the three computational strategies to find $M^2$, and then compute the errors and the diagnostic $\\rho$. The results for all test cases will then be aggregated and formatted as specified.",
            "answer": "```python\nimport numpy as np\nfrom decimal import Decimal, getcontext\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Set the precision for the high-accuracy reference calculation.\n    # 100 digits is more than sufficient to be a \"ground truth\" for double precision.\n    getcontext().prec = 100\n\n    test_cases = [\n        # Case 1: highly collimated six jets\n        [\n            (600.0, 0.10, -0.08, +1), (550.0, -0.12, 0.06, +1),\n            (500.0, 0.08, 0.04, +1), (450.0, -0.07, -0.03, +1),\n            (400.0, 0.05, 0.02, +1), (350.0, -0.04, -0.01, +1)\n        ],\n        # Case 2: back-to-back nearly lightlike di-jet\n        [\n            (500.0, 100.0, 0.0, +1), (500.0, -100.0, 0.0, -1)\n        ],\n        # Case 3: four jets, mixed directions\n        [\n            (200.0, 30.0, -20.0, +1), (150.0, -25.0, 15.0, -1),\n            (120.0, 10.0, -8.0, +1), (80.0, -5.0, 3.0, -1)\n        ],\n        # Case 4: ten extremely collimated jets\n        [\n            (550.0, 0.0010, -0.0012, +1), (530.0, -0.0013, 0.0009, +1),\n            (510.0, 0.0007, -0.0008, +1), (490.0, -0.0009, 0.0011, +1),\n            (470.0, 0.0011, -0.0007, +1), (450.0, -0.0008, 0.0006, +1),\n            (430.0, 0.0006, -0.0004, +1), (410.0, -0.0004, 0.0005, +1),\n            (390.0, 0.0005, -0.0003, +1), (370.0, -0.0003, 0.0004, +1)\n        ]\n    ]\n\n    all_results = [process_case(case) for case in test_cases]\n\n    # Format the output as a stringified list of lists.\n    result_strings = [str(res) for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef kahan_sum(data):\n    \"\"\"\n    Computes the sum of a sequence of floats using Kahan's compensated summation algorithm.\n    \"\"\"\n    s = 0.0\n    c = 0.0  # A running compensation for lost low-order bits.\n    for x in data:\n        y = x - c\n        t = s + y\n        c = (t - s) - y\n        s = t\n    return s\n\ndef process_case(jet_data):\n    \"\"\"\n    Processes a single test case, calculating invariant mass-squared with three methods\n    and reporting errors and a diagnostic.\n    \"\"\"\n    momenta_float = []\n    momenta_dec = []\n\n    for E, px, py, s in jet_data:\n        # Double precision (float) calculation\n        E_f, px_f, py_f = float(E), float(px), float(py)\n        # Ensure argument to sqrt is non-negative, though data is well-formed\n        pz_f_sq_arg = E_f**2 - px_f**2 - py_f**2\n        pz_f = float(s) * math.sqrt(max(0.0, pz_f_sq_arg))\n        momenta_float.append([E_f, px_f, py_f, pz_f])\n        \n        # High precision (Decimal) calculation\n        # Use strings for exact representation\n        E_d, px_d, py_d = Decimal(str(E)), Decimal(str(px)), Decimal(str(py))\n        s_d = Decimal(s)\n        pz_d_sq_arg = E_d**2 - px_d**2 - py_d**2\n        pz_d = s_d * pz_d_sq_arg.sqrt()\n        momenta_dec.append([E_d, px_d, py_d, pz_d])\n\n    momenta_float_np = np.array(momenta_float, dtype=np.float64)\n\n    # --- 1. Naive Summation ---\n    P_naive = np.sum(momenta_float_np, axis=0)\n    m2_naive = P_naive[0]**2 - (P_naive[1]**2 + P_naive[2]**2 + P_naive[3]**2)\n\n    # --- 2. Kahan Compensated Summation ---\n    E_comp = kahan_sum(momenta_float_np[:, 0])\n    px_comp = kahan_sum(momenta_float_np[:, 1])\n    py_comp = kahan_sum(momenta_float_np[:, 2])\n    pz_comp = kahan_sum(momenta_float_np[:, 3])\n    m2_comp = E_comp**2 - (px_comp**2 + py_comp**2 + pz_comp**2)\n\n    # --- 3. Mixed-Precision Reference Calculation ---\n    E_ref = sum(p[0] for p in momenta_dec)\n    px_ref = sum(p[1] for p in momenta_dec)\n    py_ref = sum(p[2] for p in momenta_dec)\n    pz_ref = sum(p[3] for p in momenta_dec)\n    p_vec_norm_sq_ref = px_ref**2 + py_ref**2 + pz_ref**2\n    m2_ref = E_ref**2 - p_vec_norm_sq_ref\n\n    # --- 4. Relative Errors ---\n    m2_ref_f = float(m2_ref)\n    denom_err = max(1.0, abs(m2_ref_f))\n    eps_naive = abs(m2_naive - m2_ref_f) / denom_err\n    eps_comp = abs(m2_comp - m2_ref_f) / denom_err\n\n    # --- 5. Cancellation Severity Diagnostic ---\n    denom_rho = E_ref**2 + p_vec_norm_sq_ref\n    rho = float(abs(m2_ref) / denom_rho if denom_rho != 0 else Decimal(0))\n    \n    return [m2_naive, m2_comp, m2_ref_f, eps_naive, eps_comp, rho]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}