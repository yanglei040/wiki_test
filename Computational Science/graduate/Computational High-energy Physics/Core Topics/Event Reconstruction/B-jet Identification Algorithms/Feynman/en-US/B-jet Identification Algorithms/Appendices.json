{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of identifying b-jets lies in the relatively long lifetime of B-hadrons, which allows them to travel a measurable distance before decaying. This practice focuses on the primary consequence of this lifetime: the displacement of their decay products from the primary interaction vertex. You will derive and compute the signed three-dimensional impact parameter significance (), a powerful variable that combines geometric information with measurement uncertainty to distinguish these signal tracks from the background.",
            "id": "3505937",
            "problem": "In computational high-energy physics b-jet identification algorithms (b-tagging), the three-dimensional Impact Parameter (IP) is a geometric quantity used to quantify the displacement of a charged particle trajectory from the Primary Vertex (PV). The signed three-dimensional Impact Parameter is constructed by assigning a sign according to the jet direction, with the intent of enhancing discrimination between heavy-flavor and light-flavor jets. The Primary Vertex (PV) is located at the origin. The jet axis is given by the unit vector $\\hat{n}_{\\text{jet}} = \\left(\\frac{3}{5}, 0, \\frac{4}{5}\\right)$. Consider three reconstructed charged-particle tracks. Each track is approximated locally as a straight line parameterized by $\\vec{r}_i(t) = \\vec{r}_{0,i} + t \\hat{u}_i$, where $\\vec{r}_{0,i}$ is a point on the track and $\\hat{u}_i$ is the unit direction vector along the track. The provided tracks and measurement resolutions are:\n- Track $1$: $\\vec{r}_{0,1} = (0.4, -0.3, 0)\\ \\mathrm{mm}$, $\\hat{u}_1 = \\left(\\frac{3}{5}, \\frac{4}{5}, 0\\right)$, $\\sigma_1 = 0.03\\ \\mathrm{mm}$.\n- Track $2$: $\\vec{r}_{0,2} = (0.6, 0, 0)\\ \\mathrm{mm}$, $\\hat{u}_2 = (0, 0, 1)$, $\\sigma_2 = 0.04\\ \\mathrm{mm}$.\n- Track $3$: $\\vec{r}_{0,3} = (-0.6, 0, 0.2)\\ \\mathrm{mm}$, $\\hat{u}_3 = (0, 1, 0)$, $\\sigma_3 = 0.03\\ \\mathrm{mm}$.\n\nStarting from first principles of three-dimensional Euclidean geometry, determine for each track the point of closest approach (PCA) to the PV, the magnitude of the three-dimensional IP $d_{3\\mathrm{D},i}$, and its sign defined by the scalar projection of the PCA displacement onto the jet axis, namely positive if $(\\vec{r}_{\\text{PCA},i} - \\vec{r}_{\\text{PV}}) \\cdot \\hat{n}_{\\text{jet}} > 0$ and negative if $(\\vec{r}_{\\text{PCA},i} - \\vec{r}_{\\text{PV}}) \\cdot \\hat{n}_{\\text{jet}}  0$. Using a Gaussian measurement model for the IP with per-track resolution $\\sigma_i$, construct the combined signed impact parameter significance\n$$\nS \\equiv \\sum_{i=1}^{3} \\frac{d_{3\\mathrm{D},i}^{\\text{signed}}}{\\sigma_i}.\n$$\nDiscuss, based on physical and statistical reasoning, how the above sign convention affects the discrimination power between heavy-flavor and light-flavor jets.\n\nCompute $S$ from the given numerical inputs. Round your final answer for $S$ to four significant figures. Express $S$ as a dimensionless number with no units.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. All necessary information is provided, and the concepts are fundamental to experimental high-energy physics. We may proceed with the solution.\n\nThe problem asks for the computation of a combined signed impact parameter significance, $S$, for three charged-particle tracks relative to a Primary Vertex (PV) located at the origin, $\\vec{r}_{\\text{PV}} = \\vec{0}$. The solution requires several steps for each track: determining the point of closest approach (PCA), calculating the magnitude of the $3\\mathrm{D}$ impact parameter ($d_{3\\mathrm{D}}$), assigning a sign based on the jet direction, and finally computing the significance.\n\nA charged-particle track $i$ is modeled as a straight line with parameterization $\\vec{r}_i(t) = \\vec{r}_{0,i} + t \\hat{u}_i$. The vector from the PV (origin) to an arbitrary point on this track is $\\vec{r}_i(t)$. The distance squared from the PV to this point is $d^2(t) = |\\vec{r}_i(t)|^2 = \\vec{r}_i(t) \\cdot \\vec{r}_i(t)$. The point of closest approach (PCA) corresponds to the value of the parameter $t$, denoted $t_{\\text{PCA}}$, that minimizes this distance. This occurs when the vector $\\vec{r}_i(t_{\\text{PCA}})$ is orthogonal to the track's direction vector $\\hat{u}_i$.\n$$\n\\frac{d}{dt} d^2(t) \\Big|_{t=t_{\\text{PCA}}} = 2 \\vec{r}_i(t_{\\text{PCA}}) \\cdot \\frac{d\\vec{r}_i}{dt} = 2 \\vec{r}_i(t_{\\text{PCA}}) \\cdot \\hat{u}_i = 0\n$$\nSubstituting the parameterization of the track:\n$$\n(\\vec{r}_{0,i} + t_{\\text{PCA},i} \\hat{u}_i) \\cdot \\hat{u}_i = 0\n$$\n$$\n\\vec{r}_{0,i} \\cdot \\hat{u}_i + t_{\\text{PCA},i} (\\hat{u}_i \\cdot \\hat{u}_i) = 0\n$$\nSince $\\hat{u}_i$ is a unit vector, $\\hat{u}_i \\cdot \\hat{u}_i = 1$. This yields the parameter value at the PCA:\n$$\nt_{\\text{PCA},i} = -(\\vec{r}_{0,i} \\cdot \\hat{u}_i)\n$$\nThe position vector of the PCA is then:\n$$\n\\vec{r}_{\\text{PCA},i} = \\vec{r}_{0,i} + t_{\\text{PCA},i} \\hat{u}_i = \\vec{r}_{0,i} - (\\vec{r}_{0,i} \\cdot \\hat{u}_i) \\hat{u}_i\n$$\nThe magnitude of the three-dimensional impact parameter, $d_{3\\mathrm{D},i}$, is the distance from the PV (origin) to this point:\n$$\nd_{3\\mathrm{D},i} = |\\vec{r}_{\\text{PCA},i}|\n$$\nThe sign of the impact parameter is determined by the scalar product of the PCA vector with the jet axis unit vector $\\hat{n}_{\\text{jet}} = \\left(\\frac{3}{5}, 0, \\frac{4}{5}\\right)$.\nThe signed impact parameter is $d_{3\\mathrm{D},i}^{\\text{signed}} = (\\text{sign}(\\vec{r}_{\\text{PCA},i} \\cdot \\hat{n}_{\\text{jet}})) d_{3\\mathrm{D},i}$.\nFinally, the combined significance is $S = \\sum_{i=1}^{3} S_i = \\sum_{i=1}^{3} \\frac{d_{3\\mathrm{D},i}^{\\text{signed}}}{\\sigma_i}$.\n\nWe now apply this procedure to each track.\n\n**Track 1:**\n- $\\vec{r}_{0,1} = (0.4, -0.3, 0)\\ \\mathrm{mm}$\n- $\\hat{u}_1 = \\left(\\frac{3}{5}, \\frac{4}{5}, 0\\right) = (0.6, 0.8, 0)$\n- $\\sigma_1 = 0.03\\ \\mathrm{mm}$\n\nFirst, we find $t_{\\text{PCA},1}$:\n$$\n\\vec{r}_{0,1} \\cdot \\hat{u}_1 = (0.4)(0.6) + (-0.3)(0.8) + (0)(0) = 0.24 - 0.24 = 0\n$$\n$$\nt_{\\text{PCA},1} = -0 = 0\n$$\nThis indicates that the point $\\vec{r}_{0,1}$ is itself the point of closest approach.\n$$\n\\vec{r}_{\\text{PCA},1} = \\vec{r}_{0,1} = (0.4, -0.3, 0)\\ \\mathrm{mm}\n$$\nThe magnitude of the impact parameter is:\n$$\nd_{3\\mathrm{D},1} = |\\vec{r}_{\\text{PCA},1}| = \\sqrt{(0.4)^2 + (-0.3)^2 + 0^2} = \\sqrt{0.16 + 0.09} = \\sqrt{0.25} = 0.5\\ \\mathrm{mm}\n$$\nNext, we determine the sign using $\\hat{n}_{\\text{jet}} = (0.6, 0, 0.8)$:\n$$\n\\vec{r}_{\\text{PCA},1} \\cdot \\hat{n}_{\\text{jet}} = (0.4)(0.6) + (-0.3)(0) + (0)(0.8) = 0.24\n$$\nSince the scalar product is positive, the sign is positive.\n$$\nd_{3\\mathrm{D},1}^{\\text{signed}} = +0.5\\ \\mathrm{mm}\n$$\nThe significance for Track $1$ is:\n$$\nS_1 = \\frac{d_{3\\mathrm{D},1}^{\\text{signed}}}{\\sigma_1} = \\frac{0.5}{0.03} = \\frac{50}{3}\n$$\n\n**Track 2:**\n- $\\vec{r}_{0,2} = (0.6, 0, 0)\\ \\mathrm{mm}$\n- $\\hat{u}_2 = (0, 0, 1)$\n- $\\sigma_2 = 0.04\\ \\mathrm{mm}$\n\nFind $t_{\\text{PCA},2}$:\n$$\n\\vec{r}_{0,2} \\cdot \\hat{u}_2 = (0.6)(0) + (0)(0) + (0)(1) = 0\n$$\n$$\nt_{\\text{PCA},2} = -0 = 0\n$$\nSo, $\\vec{r}_{\\text{PCA},2} = \\vec{r}_{0,2} = (0.6, 0, 0)\\ \\mathrm{mm}$.\nThe magnitude of the impact parameter is:\n$$\nd_{3\\mathrm{D},2} = |\\vec{r}_{\\text{PCA},2}| = \\sqrt{(0.6)^2 + 0^2 + 0^2} = 0.6\\ \\mathrm{mm}\n$$\nDetermine the sign:\n$$\n\\vec{r}_{\\text{PCA},2} \\cdot \\hat{n}_{\\text{jet}} = (0.6)(0.6) + (0)(0) + (0)(0.8) = 0.36\n$$\nThe scalar product is positive, so the sign is positive.\n$$\nd_{3\\mathrm{D},2}^{\\text{signed}} = +0.6\\ \\mathrm{mm}\n$$\nThe significance for Track $2$ is:\n$$\nS_2 = \\frac{d_{3\\mathrm{D},2}^{\\text{signed}}}{\\sigma_2} = \\frac{0.6}{0.04} = 15\n$$\n\n**Track 3:**\n- $\\vec{r}_{0,3} = (-0.6, 0, 0.2)\\ \\mathrm{mm}$\n- $\\hat{u}_3 = (0, 1, 0)$\n- $\\sigma_3 = 0.03\\ \\mathrm{mm}$\n\nFind $t_{\\text{PCA},3}$:\n$$\n\\vec{r}_{0,3} \\cdot \\hat{u}_3 = (-0.6)(0) + (0)(1) + (0.2)(0) = 0\n$$\n$$\nt_{\\text{PCA},3} = -0 = 0\n$$\nSo, $\\vec{r}_{\\text{PCA},3} = \\vec{r}_{0,3} = (-0.6, 0, 0.2)\\ \\mathrm{mm}$.\nThe magnitude of the impact parameter is:\n$$\nd_{3\\mathrm{D},3} = |\\vec{r}_{\\text{PCA},3}| = \\sqrt{(-0.6)^2 + 0^2 + (0.2)^2} = \\sqrt{0.36 + 0.04} = \\sqrt{0.4}\\ \\mathrm{mm}\n$$\nDetermine the sign:\n$$\n\\vec{r}_{\\text{PCA},3} \\cdot \\hat{n}_{\\text{jet}} = (-0.6)(0.6) + (0)(0) + (0.2)(0.8) = -0.36 + 0.16 = -0.20\n$$\nThe scalar product is negative, so the sign is negative.\n$$\nd_{3\\mathrm{D},3}^{\\text{signed}} = -\\sqrt{0.4}\\ \\mathrm{mm}\n$$\nThe significance for Track $3$ is:\n$$\nS_3 = \\frac{d_{3\\mathrm{D},3}^{\\text{signed}}}{\\sigma_3} = \\frac{-\\sqrt{0.4}}{0.03}\n$$\n\n**Combined Significance:**\nThe total significance $S$ is the sum of the individual significances:\n$$\nS = S_1 + S_2 + S_3 = \\frac{50}{3} + 15 + \\frac{-\\sqrt{0.4}}{0.03}\n$$\nWe convert to a common denominator and combine terms:\n$$\nS = \\frac{50}{3} + \\frac{45}{3} - \\frac{\\sqrt{0.4}}{0.03} = \\frac{95}{3} - \\frac{\\sqrt{4 \\times 10^{-1}}}{3 \\times 10^{-2}} = \\frac{95}{3} - \\frac{2 \\times 10^{-1/2}}{3 \\times 10^{-2}}\n$$\nLet's express it in a more convenient form for numerical calculation:\n$$\nS = \\frac{95}{3} - \\frac{\\sqrt{0.4}}{0.03} = \\frac{95}{3} - \\frac{\\sqrt{4/10}}{3/100} = \\frac{95}{3} - \\frac{2/\\sqrt{10}}{3/100} = \\frac{95}{3} - \\frac{200}{3\\sqrt{10}}\n$$\n$$\nS = \\frac{1}{3} \\left( 95 - \\frac{200}{\\sqrt{10}} \\right) = \\frac{1}{3} \\left( 95 - \\frac{200\\sqrt{10}}{10} \\right) = \\frac{1}{3} (95 - 20\\sqrt{10})\n$$\nNow, we compute the numerical value:\n$$\nS \\approx \\frac{1}{3} (95 - 20 \\times 3.16227766) = \\frac{1}{3} (95 - 63.2455532) = \\frac{31.7544468}{3} \\approx 10.5848156\n$$\nRounding to four significant figures gives $10.58$.\n\n**Discussion on Discrimination Power:**\nThe use of a signed impact parameter significantly enhances the ability to distinguish between jets originating from heavy-flavor quarks (bottom, charm) and those from light-flavor quarks (up, down, strange) or gluons. The physical reasoning is as follows:\n\n$1$. **Heavy-Flavor Jets:** Hadrons containing b-quarks (B-hadrons) have a considerable lifetime of approximately $1.5 \\times 10^{-12}\\ \\mathrm{s}$. In high-energy collisions, they are produced with large Lorentz boosts, allowing them to travel a macroscopic distance (typically on the order of millimeters) from the primary interaction point (PV) before they decay. This decay point forms a displaced secondary vertex (SV). The charged particles originating from this SV will have tracks that, when extrapolated back, do not point to the PV. Consequently, these tracks exhibit a large impact parameter. Critically, the SV is displaced from the PV *along* the direction of the B-hadron, which is highly correlated with the overall jet axis $\\hat{n}_{\\text{jet}}$. Therefore, the displacement vector from the PV to the PCA of such a track, $\\vec{r}_{\\text{PCA}}$, tends to have a positive projection onto the jet axis. This results in a distribution of signed impact parameters that is predominantly positive.\n\n$2$. **Light-Flavor Jets:** Light quarks and gluons hadronize promptly, meaning the particles in the resulting jet originate effectively from the PV. Any measured non-zero impact parameter for these tracks is primarily due to the finite resolution of the tracking detectors and multiple scattering. These effects are random in nature. The vector $\\vec{r}_{\\text{PCA}}$ will have a random orientation in the plane transverse to the track. Consequently, its projection onto the jet axis, $\\vec{r}_{\\text{PCA}} \\cdot \\hat{n}_{\\text{jet}}$, will be positive and negative with roughly equal probability. The resulting distribution of signed impact parameters is symmetric about zero.\n\n$3$. **Statistical Separation:** By summing the signed impact parameter significances, $S = \\sum_i S_i$, we leverage this difference. For a heavy-flavor jet, the individual terms $S_i$ are mostly positive and add coherently, yielding a large positive value for $S$. For a light-flavor jet, the terms $S_i$ are a mix of positive and negative values that tend to cancel, leading to a value of $S$ that is consistent with a random walk around zero. The resulting distribution of the test statistic $S$ for heavy-flavor jets (the \"signal\") will have a large positive mean, while the distribution for light-flavor jets (the \"background\") will be centered at zero. A cut on a sufficiently large value of $S$ can thus effectively select a sample of jets highly enriched in heavy flavors.",
            "answer": "$$\n\\boxed{10.58}\n$$"
        },
        {
            "introduction": "While single-track impact parameters are powerful, combining information from all tracks originating from a B-hadron decay provides an even more robust signature. This exercise guides you through the statistical procedure of secondary vertex reconstruction, applying a maximum-likelihood approach analogous to a Kalman filter formalism (). By estimating the vertex position and its uncertainty, you will construct the flight distance significance, one of the most crucial inputs to modern b-tagging algorithms.",
            "id": "3505861",
            "problem": "In computational high-energy physics, a key component of bottom quark jet identification (b-tagging) is the reconstruction of a displaced secondary vertex, whose position is estimated from charged-particle tracks. Consider the special case of a linear-Gaussian measurement model within the Kalman filter formalism for a static state: the secondary vertex position in the transverse plane, denoted by the vector $\\mathbf{r} \\in \\mathbb{R}^{2}$. Assume a set of $N$ reconstructed tracks, each providing an unbiased Gaussian estimate $\\mathbf{r}_{i}$ of the same vertex position with known symmetric positive-definite covariance matrix $\\mathbf{C}_{i}$. The tracks are conditionally independent given $\\mathbf{r}$. The primary vertex (PV) position $\\mathbf{r}_{\\mathrm{PV}}$ is known with Gaussian uncertainty described by a covariance matrix $\\mathbf{V}_{\\mathrm{PV}}$. A unit vector $\\hat{\\mathbf{u}}$ approximates the jet axis in the transverse plane. The flight distance along $\\hat{\\mathbf{u}}$ is the projection $L = \\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})$, and its uncertainty $\\sigma_{L}$ is obtained by linear propagation of the PV and secondary vertex covariances.\n\nStarting from the Gaussian likelihood implied by the Kalman filter measurement model, construct the likelihood function $\\mathcal{L}(\\mathbf{r})$ for the secondary vertex position, derive the maximum-likelihood estimator $\\mathbf{\\hat{r}}$, obtain the vertex chi-squared $\\chi^{2}$ at the optimum, and show how to compute the flight distance significance $S = L / \\sigma_{L}$ from the posterior covariance $\\mathbf{V}_{\\mathrm{SV}}$ and $\\mathbf{V}_{\\mathrm{PV}}$.\n\nThen, for the following scientifically realistic dataset in millimeters, compute the flight distance significance. Use distances in millimeters and express the final significance as a pure number. Round your final answer to four significant figures.\n\nTracks ($N = 3$):\n- Track $1$: $\\mathbf{r}_{1} = \\begin{pmatrix} 0.50 \\\\ 0.30 \\end{pmatrix}$, $\\mathbf{C}_{1} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix}$.\n- Track $2$: $\\mathbf{r}_{2} = \\begin{pmatrix} 0.62 \\\\ 0.28 \\end{pmatrix}$, $\\mathbf{C}_{2} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix}$.\n- Track $3$: $\\mathbf{r}_{3} = \\begin{pmatrix} 0.55 \\\\ 0.35 \\end{pmatrix}$, $\\mathbf{C}_{3} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix}$.\n\nPrimary vertex (PV): $\\mathbf{r}_{\\mathrm{PV}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, $\\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} (0.010)^{2}  0 \\\\ 0  (0.010)^{2} \\end{pmatrix}$.\n\nJet axis unit vector: $\\hat{\\mathbf{u}} = \\begin{pmatrix} 0.8 \\\\ 0.6 \\end{pmatrix}$.",
            "solution": "The user-provided problem has been validated and is found to be scientifically grounded, well-posed, objective, and complete. All provided data and conditions are consistent and realistic within the context of high-energy physics. The problem is a standard application of maximum likelihood estimation and error propagation. We may therefore proceed with the solution.\n\nThe problem asks for a derivation of the key quantities in vertex fitting and a numerical calculation of the flight distance significance. We will first provide the theoretical derivation and then apply it to the given dataset.\n\n**Part 1: Theoretical Derivation**\n\nLet the true secondary vertex (SV) position be the $2$-dimensional vector $\\mathbf{r}$. We are given $N$ measurements (tracks), where each track $i$ provides an estimate $\\mathbf{r}_i$ of the vertex position. The measurement model for each track is a multivariate Gaussian distribution with mean $\\mathbf{r}$ and a known symmetric positive-definite covariance matrix $\\mathbf{C}_i$. The probability density function for observing $\\mathbf{r}_i$ given $\\mathbf{r}$ is:\n$$p(\\mathbf{r}_i | \\mathbf{r}) = \\frac{1}{2\\pi \\sqrt{\\det(\\mathbf{C}_i)}} \\exp\\left(-\\frac{1}{2}(\\mathbf{r}_i - \\mathbf{r})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r})\\right)$$\nThe tracks are conditionally independent given $\\mathbf{r}$, so the total likelihood function $\\mathcal{L}(\\mathbf{r})$ for the set of $N$ tracks is the product of the individual probability densities:\n$$\\mathcal{L}(\\mathbf{r}) = \\prod_{i=1}^{N} p(\\mathbf{r}_i | \\mathbf{r})$$\nIt is computationally more convenient to work with the negative log-likelihood, which is proportional to a chi-squared function $\\chi^2(\\mathbf{r})$:\n$$\\chi^2(\\mathbf{r}) = -2 \\ln \\mathcal{L}(\\mathbf{r}) + \\text{const} = \\sum_{i=1}^{N} (\\mathbf{r}_i - \\mathbf{r})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r})$$\nThe maximum-likelihood estimator (MLE) for the vertex position, denoted $\\mathbf{\\hat{r}}$, is the value of $\\mathbf{r}$ that minimizes $\\chi^2(\\mathbf{r})$. We find this by setting the gradient of $\\chi^2(\\mathbf{r})$ with respect to $\\mathbf{r}$ to zero:\n$$\\nabla_{\\mathbf{r}} \\chi^2(\\mathbf{r}) = \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}} \\left( (\\mathbf{r}_i - \\mathbf{r})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r}) \\right) = \\sum_{i=1}^{N} -2 \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r}) = \\mathbf{0}$$\nDividing by $-2$ and rearranging terms gives:\n$$\\sum_{i=1}^{N} \\mathbf{C}_i^{-1} \\mathbf{r}_i - \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1}\\right) \\mathbf{r} = \\mathbf{0}$$\nSolving for $\\mathbf{r}$ gives the MLE $\\mathbf{\\hat{r}}$:\n$$\\mathbf{\\hat{r}} = \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1}\\right)^{-1} \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1} \\mathbf{r}_i\\right)$$\nThis is a generalized weighted average, where the weight matrix for each measurement is the inverse of its covariance matrix, $\\mathbf{W}_i = \\mathbf{C}_i^{-1}$. The posterior covariance matrix of the estimated secondary vertex position, $\\mathbf{V}_{\\mathrm{SV}}$, is given by the inverse of the sum of the weight matrices:\n$$\\mathbf{V}_{\\mathrm{SV}} = \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1}\\right)^{-1}$$\nThe vertex chi-squared at the optimum is the value of the $\\chi^2$ function evaluated at $\\mathbf{\\hat{r}}$:\n$$\\chi^{2}_{\\text{vertex}} = \\sum_{i=1}^{N} (\\mathbf{r}_i - \\mathbf{\\hat{r}})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{\\hat{r}})$$\nThis quantity serves as a goodness-of-fit metric for the vertex fit.\n\nNext, we address the flight distance significance. The flight distance $L$ is the projection of the displacement vector $(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})$ onto the jet axis unit vector $\\hat{\\mathbf{u}}$:\n$$L = \\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})$$\nThe uncertainty in $L$, denoted $\\sigma_L$, is found using linear error propagation. The displacement vector $\\mathbf{d} = \\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}}$ has a covariance matrix $\\mathbf{V_d}$ that is the sum of the covariances of $\\mathbf{\\hat{r}}$ and $\\mathbf{r}_{\\mathrm{PV}}$, since they are independent variables (the PV position is determined independently of the tracks forming the SV).\n$$\\mathbf{V_d} = \\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}}$$\nThe variance of the scalar projection $L = \\hat{\\mathbf{u}}^{\\top}\\mathbf{d}$ is then given by:\n$$\\sigma_L^2 = \\hat{\\mathbf{u}}^{\\top} \\mathbf{V_d} \\hat{\\mathbf{u}} = \\hat{\\mathbf{u}}^{\\top} (\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}}) \\hat{\\mathbf{u}}$$\nThe flight distance significance $S$ is the ratio of the flight distance to its uncertainty:\n$$S = \\frac{L}{\\sigma_L} = \\frac{\\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})}{\\sqrt{\\hat{\\mathbf{u}}^{\\top} (\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}}) \\hat{\\mathbf{u}}}}$$\n\n**Part 2: Numerical Calculation**\n\nWe are given the following dataset with distances in millimeters:\nNumber of tracks: $N=3$.\nTrack positions: $\\mathbf{r}_{1} = \\begin{pmatrix} 0.50 \\\\ 0.30 \\end{pmatrix}$, $\\mathbf{r}_{2} = \\begin{pmatrix} 0.62 \\\\ 0.28 \\end{pmatrix}$, $\\mathbf{r}_{3} = \\begin{pmatrix} 0.55 \\\\ 0.35 \\end{pmatrix}$.\nTrack covariances: $\\mathbf{C}_{1} = \\mathbf{C}_{2} = \\mathbf{C}_{3} = \\mathbf{C} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix} = \\begin{pmatrix} 0.0016  0 \\\\ 0  0.0016 \\end{pmatrix}$.\nPrimary vertex position: $\\mathbf{r}_{\\mathrm{PV}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nPrimary vertex covariance: $\\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} (0.010)^{2}  0 \\\\ 0  (0.010)^{2} \\end{pmatrix} = \\begin{pmatrix} 0.0001  0 \\\\ 0  0.0001 \\end{pmatrix}$.\nJet axis unit vector: $\\hat{\\mathbf{u}} = \\begin{pmatrix} 0.8 \\\\ 0.6 \\end{pmatrix}$.\n\nSince all track covariances $\\mathbf{C}_i$ are identical and equal to $\\mathbf{C}$, the formula for $\\mathbf{\\hat{r}}$ simplifies to the arithmetic mean:\n$$\\mathbf{\\hat{r}} = \\left(N \\mathbf{C}^{-1}\\right)^{-1} \\left(\\mathbf{C}^{-1} \\sum_{i=1}^{N} \\mathbf{r}_i\\right) = \\frac{1}{N} \\mathbf{C} \\mathbf{C}^{-1} \\sum_{i=1}^{N} \\mathbf{r}_i = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{r}_i$$\nCalculating $\\mathbf{\\hat{r}}$:\n$$\\mathbf{\\hat{r}} = \\frac{1}{3} \\left( \\begin{pmatrix} 0.50 \\\\ 0.30 \\end{pmatrix} + \\begin{pmatrix} 0.62 \\\\ 0.28 \\end{pmatrix} + \\begin{pmatrix} 0.55 \\\\ 0.35 \\end{pmatrix} \\right) = \\frac{1}{3} \\begin{pmatrix} 1.67 \\\\ 0.93 \\end{pmatrix} = \\begin{pmatrix} 1.67/3 \\\\ 0.31 \\end{pmatrix}$$\nThe flight distance $L$ is:\n$$L = \\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}}) = \\begin{pmatrix} 0.8  0.6 \\end{pmatrix} \\left( \\begin{pmatrix} 1.67/3 \\\\ 0.31 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\right)$$\n$$L = 0.8 \\times \\frac{1.67}{3} + 0.6 \\times 0.31 = \\frac{1.336}{3} + 0.186 = \\frac{1.336 + 3 \\times 0.186}{3} = \\frac{1.336 + 0.558}{3} = \\frac{1.894}{3} \\approx 0.63133...$$\nNow we compute the uncertainty. First, the SV covariance $\\mathbf{V}_{\\mathrm{SV}}$:\n$$\\mathbf{V}_{\\mathrm{SV}} = \\left(\\sum_{i=1}^{3} \\mathbf{C}^{-1}\\right)^{-1} = (3 \\mathbf{C}^{-1})^{-1} = \\frac{1}{3} \\mathbf{C} = \\frac{1}{3} \\begin{pmatrix} 0.0016  0 \\\\ 0  0.0016 \\end{pmatrix}$$\nThe total covariance for the displacement vector is:\n$$\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} \\frac{0.0016}{3}  0 \\\\ 0  \\frac{0.0016}{3} \\end{pmatrix} + \\begin{pmatrix} 0.0001  0 \\\\ 0  0.0001 \\end{pmatrix} = \\begin{pmatrix} \\frac{0.0016}{3} + 0.0001  0 \\\\ 0  \\frac{0.0016}{3} + 0.0001 \\end{pmatrix}$$\n$$\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} \\frac{0.0016+0.0003}{3}  0 \\\\ 0  \\frac{0.0016+0.0003}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{0.0019}{3}  0 \\\\ 0  \\frac{0.0019}{3} \\end{pmatrix} = \\frac{0.0019}{3} \\mathbf{I}$$\nwhere $\\mathbf{I}$ is the $2 \\times 2$ identity matrix.\nThe variance of the flight distance $\\sigma_L^2$ is:\n$$\\sigma_L^2 = \\hat{\\mathbf{u}}^{\\top} \\left( \\frac{0.0019}{3} \\mathbf{I} \\right) \\hat{\\mathbf{u}} = \\frac{0.0019}{3} (\\hat{\\mathbf{u}}^{\\top} \\hat{\\mathbf{u}})$$\nSince $\\hat{\\mathbf{u}}$ is a unit vector, $\\hat{\\mathbf{u}}^{\\top} \\hat{\\mathbf{u}} = \\|\\hat{\\mathbf{u}}\\|^2 = 0.8^2 + 0.6^2 = 0.64 + 0.36 = 1$.\nTherefore, the variance is simply the scalar prefactor:\n$$\\sigma_L^2 = \\frac{0.0019}{3} \\approx 0.0006333...$$\nThe uncertainty $\\sigma_L$ is the square root:\n$$\\sigma_L = \\sqrt{\\frac{0.0019}{3}} \\approx 0.025166...$$\nFinally, the flight distance significance $S$ is:\n$$S = \\frac{L}{\\sigma_L} = \\frac{1.894/3}{\\sqrt{0.0019/3}} \\approx \\frac{0.63133...}{0.025166...} \\approx 25.08643...$$\nRounding the result to four significant figures, we get $25.09$.",
            "answer": "$$\\boxed{25.09}$$"
        },
        {
            "introduction": "Modern b-tagging relies heavily on deep neural networks, but their performance is highly sensitive to the representation of input features. This problem explores the critical step of feature engineering, examining how different scaling and parameterization choices affect the numerical stability of the model's input matrix (). Through this computational study, you will discover why physics-informed feature design is essential for building robust and high-performing machine learning classifiers in a real-world physics environment.",
            "id": "3505888",
            "problem": "Design and implement a program to quantitatively assess how different parameterization and normalization choices for charged-particle track features affect the numerical conditioning of the input design matrix used by a simple feed-forward neural network surrogate in the context of identifying bottom quark jets through bottom-jet tagging. The study must focus on the standard per-track parameterization choices and a set of transformations that mimic common detector-level nuisance variations, and it must propose and test physics-informed invariant feature scalings.\n\nStart from the standard five-parameter per-track representation: transverse impact parameter $d_0$, longitudinal impact parameter $z_0$, azimuthal angle $\\phi$, polar angle $\\theta$, and charge-over-momentum $q/p$. All angles must be specified in radians. Use the following physically plausible generative model for a synthetic sample of $N$ tracks per test case:\n- Draw $d_0$ in millimeters from a mixture modeling prompt and displaced tracks: with probability $f_{\\mathrm{disp}}$, sample $d_0 \\sim \\mathcal{N}(\\mu_{\\mathrm{disp}},\\sigma_{\\mathrm{disp}})$, and with probability $1 - f_{\\mathrm{disp}}$, sample $d_0 \\sim \\mathcal{N}(0,\\sigma_{d_0})$, where $\\mu_{\\mathrm{disp}}$ and $\\sigma_{\\mathrm{disp}}$ are positive constants in millimeters.\n- Draw $z_0$ in millimeters from $z_0 \\sim \\mathcal{N}(0,\\sigma_{z_0})$.\n- Draw $\\phi$ from a uniform distribution over $[-\\pi,\\pi)$.\n- Draw $\\cos\\theta$ uniformly over $[-1,1]$ and set $\\theta = \\arccos(\\cos\\theta)$.\n- Draw the particle momentum $p$ in gigaelectronvolts from a log-normal distribution with median scale near a few gigaelectronvolts, and select charge $q \\in \\{-1,+1\\}$ uniformly; set $q/p$ in $\\mathrm{GeV}^{-1}$.\n\nModel two physically motivated nuisance transformations applied event-wide:\n- A global azimuthal rotation by angle $\\alpha$: $\\phi \\mapsto \\phi' = \\phi + \\alpha$ followed by wrapping to $[-\\pi,\\pi)$.\n- A transverse beamspot translation by $(\\Delta x,\\Delta y)$ in millimeters. Under small-arc approximations, the signed transverse impact parameter $d_0$ transforms approximately as $d_0' = d_0 - \\Delta x \\sin\\phi' + \\Delta y \\cos\\phi'$, while $z_0$, $\\theta$, and $q/p$ remain unchanged by a purely transverse translation.\n\nDefine and compare three normalization or scaling schemes applied to the per-track features:\n- Scheme A (raw): use the raw five features ($d_0,z_0,\\phi,\\theta,q/p$) without any normalization.\n- Scheme B (z-score): for each of the five raw features, subtract the sample mean and divide by the sample standard deviation computed over the tracks in the test case.\n- Scheme C (physics-informed invariant): construct a dimensionless, bounded feature set that is insensitive to angular wrapping and has reduced sensitivity to global rotations. Use the following mapping and scales:\n  - Replace $\\phi$ by the pair $(\\cos\\phi,\\sin\\phi)$.\n  - Replace $\\theta$ by the pair $(\\cos\\theta,\\sin\\theta)$.\n  - Scale $d_0$ by a characteristic resolution $\\sigma_{d_0}$ to get $d_0/\\sigma_{d_0}$.\n  - Scale $z_0$ by $\\sigma_{z_0}$ to get $z_0/\\sigma_{z_0}$.\n  - Scale $q/p$ by a reference momentum $p_{\\mathrm{ref}}$ to get $(q/p)\\cdot p_{\\mathrm{ref}}$.\n  The resulting feature vector has seven components $(d_0/\\sigma_{d_0}, z_0/\\sigma_{z_0}, \\cos\\phi, \\sin\\phi, \\cos\\theta, \\sin\\theta, (q/p)\\cdot p_{\\mathrm{ref}})$.\n\nUse the $2$-norm condition number $\\kappa_2(X)$ of the $N \\times d$ design matrix $X$ as a proxy for numerical stability, where $d$ is the feature dimensionality of a given scheme (either $5$ or $7$). For each test case and scheme, compute $\\kappa_2(X)$ by singular value decomposition.\n\nImplement the following test suite, all with $N = 5000$ tracks and a fixed random seed $42$ for reproducibility, using the parameter values:\n- Mixture model parameters: $f_{\\mathrm{disp}} = 0.1$, $\\mu_{\\mathrm{disp}} = 0.5\\,\\mathrm{mm}$, $\\sigma_{\\mathrm{disp}} = 0.1\\,\\mathrm{mm}$, $\\sigma_{d_0} = 0.05\\,\\mathrm{mm}$, $\\sigma_{z_0} = 1.0\\,\\mathrm{mm}$.\n- Momentum distribution: $\\ln p \\sim \\mathcal{N}(\\ln 5, 0.6^2)$ in $\\mathrm{GeV}$.\n- Reference momentum for physics-informed scaling: $p_{\\mathrm{ref}} = 10.0\\,\\mathrm{GeV}$.\n\nTest cases, each defined by $(\\alpha,\\Delta x,\\Delta y,s)$ where $s$ multiplies $q/p$ event-wide:\n1. Baseline: $(0, 0, 0, 1)$.\n2. Pure rotation: $(\\pi/2, 0, 0, 1)$.\n3. Pure translation: $(0, 0.2, -0.1, 1)$ with $\\Delta x$ and $\\Delta y$ in millimeters.\n4. Rotation and momentum distortion: $(\\pi/3, 0, 0, 3)$.\n\nFor each test case, compute and record three floating-point results in the following order: the $2$-norm condition numbers for Scheme A, Scheme B, and Scheme C. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_{12}]$), where $r_{3k-2}$, $r_{3k-1}$, and $r_{3k}$ correspond to the three schemes for test case $k$ in the sequence above.\n\nAll physical quantities in the program must adhere to the stated units. The final outputs are dimensionless floats. The program must be deterministic given the fixed random seed and must require no user input or external files.",
            "solution": "The problem requires a quantitative analysis of how different feature parameterization and normalization schemes affect the numerical conditioning of a design matrix used in a machine learning context for b-jet identification. The numerical stability will be assessed using the $2$-norm condition number, $\\kappa_2(X)$, of the design matrix $X$. A high condition number signifies that small perturbations in the input data can cause large changes in the output of linear algebra operations, which are fundamental to training algorithms like neural networks, potentially leading to slow convergence or unstable training. We will implement a physically motivated generative model for charged particle tracks, apply realistic nuisance transformations, construct design matrices using three different schemes, and compute their condition numbers.\n\nFirst, we establish the generative model for a synthetic sample of $N$ charged particle tracks. Each track is described by five standard parameters: transverse impact parameter $d_0$ (in mm), longitudinal impact parameter $z_0$ (in mm), azimuthal angle $\\phi$ (in radians), polar angle $\\theta$ (in radians), and charge-over-momentum $q/p$ (in $\\mathrm{GeV}^{-1}$). The distributions are chosen to be physically representative:\n- $d_0$: A mixture of two Gaussian distributions models the two primary sources of tracks in a b-jet. A narrow Gaussian, $\\mathcal{N}(0, \\sigma_{d_0})$, represents \"prompt\" tracks originating from the primary interaction vertex. A wider, shifted Gaussian, $\\mathcal{N}(\\mu_{\\mathrm{disp}}, \\sigma_{\\mathrm{disp}})$, represents \"displaced\" tracks from the decay of long-lived B-hadrons, which travel a measurable distance before decaying. A fraction $f_{\\mathrm{disp}}$ of tracks are from this displaced population.\n- $z_0$: A single Gaussian $\\mathcal{N}(0, \\sigma_{z_0})$ models the spread of track origins along the beam axis.\n- $\\phi$ and $\\theta$: A uniform distribution in $\\phi$ over $[-\\pi, \\pi)$ and a uniform distribution in $\\cos\\theta$ over $[-1, 1]$ reflect an isotropic or cylindrically symmetric production of particles, a common approximation. $\\theta$ is then derived as $\\theta = \\arccos(\\cos\\theta)$, naturally falling in $[0, \\pi]$.\n- $q/p$: The momentum magnitude $p$ is drawn from a log-normal distribution, which is a good empirical model for the steeply falling momentum spectra of particles in jets. The charge $q$ is chosen uniformly from $\\{-1, +1\\}$.\n\nNext, we model common experimental systematic uncertainties as nuisance transformations applied to the entire set of tracks:\n1.  A global azimuthal rotation $\\phi \\mapsto \\phi' = \\phi + \\alpha$.\n2.  A transverse beamspot translation $(\\Delta x, \\Delta y)$, which shifts the assumed origin. This affects the transverse impact parameter according to the first-order approximation $d_0' = d_0 - \\Delta x \\sin\\phi' + \\Delta y \\cos\\phi'$. The formulation correctly uses the post-rotation angle $\\phi'$, as the impact parameter is geometrically defined in the final coordinate system.\n3.  A scaling of $q/p \\mapsto s \\cdot (q/p)$ models a potential miscalibration of the magnetic field or momentum reconstruction scale.\n\nWe then construct the $N \\times d$ design matrix $X$ using three distinct schemes, where $d$ is the number of features.\n- **Scheme A (Raw)**: The features are the raw, untransformed physical quantities $(d_0, z_0, \\phi, \\theta, q/p)$. These features have disparate physical units and numerical scales (e.g., $d_0 \\sim 10^{-1}$ mm vs. $\\phi \\sim 1$ rad), which is known to produce poorly conditioned matrices. The dimensionality is $d=5$.\n- **Scheme B (Z-score)**: Each of the five raw features is individually standardized by subtracting its sample mean and dividing by its sample standard deviation. This forces all features to have a mean of $0$ and a standard deviation of $1$. While effective at unifying scales, this transformation is data-dependent and breaks any inherent physical symmetries or invariances present in the raw data. The dimensionality is $d=5$.\n- **Scheme C (Physics-Informed Invariant)**: This scheme uses physical insight to create a more robust feature set. The dimensionality is $d=7$.\n    - The angles $\\phi$ and $\\theta$ are mapped to $(\\cos\\phi, \\sin\\phi)$ and $(\\cos\\theta, \\sin\\theta)$, respectively. This removes the artificial discontinuity at the wrapping point (e.g., $\\phi=-\\pi$ vs. $\\phi=\\pi$) and represents rotations as linear transformations in a 2D subspace, which is easier for machine learning models to handle.\n    - $d_0$ and $z_0$ are scaled by their characteristic resolutions, $\\sigma_{d_0}$ and $\\sigma_{z_0}$, yielding dimensionless quantities of order unity, $d_0/\\sigma_{d_0}$ and $z_0/\\sigma_{z_0}$.\n    - The charge-over-momentum $q/p$ is scaled by a reference momentum $p_{\\mathrm{ref}}$ to produce another dimensionless feature, $(q/p) \\cdot p_{\\mathrm{ref}}$.\n    This approach aims to create features that are dimensionless, have similar numerical ranges, and exhibit more stable behavior under the specified nuisance transformations, by design.\n\nThe core of the analysis is the computation of the $2$-norm condition number, $\\kappa_2(X)$, defined as the ratio of the largest to the smallest singular value of the matrix $X$: $\\kappa_2(X) = \\sigma_{\\max} / \\sigma_{\\min}$. We compute the singular values using Singular Value Decomposition (SVD). A value of $\\kappa_2(X) \\approx 1$ is ideal, indicating a well-conditioned matrix. A large value indicates poor conditioning.\n\nThe implementation will proceed by generating a dataset of $N=5000$ tracks with a fixed random seed for reproducibility. For each of the four test cases—which apply different combinations of nuisance transformations—we will generate the data, apply the transformations, construct the design matrices for schemes A, B, and C, and compute their respective condition numbers. This systematic comparison will reveal which feature engineering strategy yields the most numerically stable representation in the face of realistic experimental variations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# language: Python\n# version: 3.12\n# libraries:\n#   name: numpy, version: 1.23.5\n#   name: scipy, version: 1.11.4\n\ndef generate_tracks(N, seed, f_disp, mu_disp, sigma_disp, sigma_d0, sigma_z0, p_log_mean, p_log_std):\n    \"\"\"\n    Generates a synthetic sample of N tracks based on the specified physical model.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # 1. Generate d_0 from the mixture model\n    is_displaced = rng.uniform(0, 1, N)  f_disp\n    n_disp = np.sum(is_displaced)\n    n_prompt = N - n_disp\n    \n    d0 = np.zeros(N, dtype=np.float64)\n    d0[is_displaced] = rng.normal(loc=mu_disp, scale=sigma_disp, size=n_disp)\n    d0[~is_displaced] = rng.normal(loc=0.0, scale=sigma_d0, size=n_prompt)\n\n    # 2. Generate z_0\n    z0 = rng.normal(loc=0.0, scale=sigma_z0, size=N)\n\n    # 3. Generate phi\n    phi = rng.uniform(-np.pi, np.pi, size=N)\n\n    # 4. Generate theta\n    cos_theta = rng.uniform(-1.0, 1.0, size=N)\n    theta = np.arccos(cos_theta)\n\n    # 5. Generate q/p\n    log_p = rng.normal(loc=p_log_mean, scale=p_log_std, size=N)\n    p = np.exp(log_p)\n    q = rng.choice([-1, 1], size=N)\n    q_over_p = q / p\n\n    return d0, z0, phi, theta, q_over_p, cos_theta\n\ndef apply_transformations(d0, z0, phi, theta, q_over_p, alpha, delta_x, delta_y, s):\n    \"\"\"\n    Applies event-wide nuisance transformations to the track features.\n    \"\"\"\n    # Apply azimuthal rotation and wrap to [-pi, pi)\n    phi_prime = np.arctan2(np.sin(phi + alpha), np.cos(phi + alpha))\n\n    # Apply beamspot translation\n    d0_prime = d0 - delta_x * np.sin(phi_prime) + delta_y * np.cos(phi_prime)\n    \n    # z0 and theta are unchanged by these transformations\n    z0_prime = z0\n    theta_prime = theta\n\n    # Apply momentum scale distortion\n    q_over_p_prime = q_over_p * s\n    \n    return d0_prime, z0_prime, phi_prime, theta_prime, q_over_p_prime\n\ndef compute_condition_number(X):\n    \"\"\"\n    Computes the 2-norm condition number of matrix X using SVD.\n    \"\"\"\n    try:\n        s = np.linalg.svd(X, compute_uv=False)\n        # Check for singularity\n        if s[-1]  1e-12:  # Use a small tolerance for floating point\n            return np.inf\n        return s[0] / s[-1]\n    except np.linalg.LinAlgError:\n        # This can happen for ill-conditioned matrices, though unlikely here.\n        return np.inf\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation and analysis.\n    \"\"\"\n    # Global parameters\n    N = 5000\n    RANDOM_SEED = 42\n    \n    # Generative model parameters\n    F_DISP = 0.1\n    MU_DISP = 0.5  # mm\n    SIGMA_DISP = 0.1  # mm\n    SIGMA_D0 = 0.05  # mm\n    SIGMA_Z0 = 1.0  # mm\n    P_LOG_MEAN = np.log(5.0) # Corresponds to median p = 5 GeV\n    P_LOG_STD = 0.6\n    \n    # Physics-informed scaling parameters\n    P_REF = 10.0  # GeV\n\n    # Test cases: (alpha, delta_x, delta_y, s)\n    test_cases = [\n        (0.0, 0.0, 0.0, 1.0),          # 1. Baseline\n        (np.pi / 2, 0.0, 0.0, 1.0),    # 2. Pure rotation\n        (0.0, 0.2, -0.1, 1.0),         # 3. Pure translation\n        (np.pi / 3, 0.0, 0.0, 3.0),    # 4. Rotation and momentum distortion\n    ]\n\n    all_results = []\n\n    # Generate base tracks once\n    d0_raw, z0_raw, phi_raw, theta_raw, q_over_p_raw, cos_theta_raw = generate_tracks(\n        N, RANDOM_SEED, F_DISP, MU_DISP, SIGMA_DISP, SIGMA_D0, SIGMA_Z0, P_LOG_MEAN, P_LOG_STD\n    )\n\n    for alpha, delta_x, delta_y, s in test_cases:\n        # Apply transformations for the current test case\n        d0_t, z0_t, phi_t, theta_t, q_over_p_t = apply_transformations(\n            d0_raw, z0_raw, phi_raw, theta_raw, q_over_p_raw, alpha, delta_x, delta_y, s\n        )\n        \n        # --- Scheme A: Raw features ---\n        X_A = np.column_stack([d0_t, z0_t, phi_t, theta_t, q_over_p_t])\n        kappa_A = compute_condition_number(X_A)\n        all_results.append(kappa_A)\n\n        # --- Scheme B: Z-score normalization ---\n        # Note: Mean and std are calculated on the transformed data for this test case\n        mean_A = np.mean(X_A, axis=0)\n        std_A = np.std(X_A, axis=0)\n        # Avoid division by zero if a feature is constant (highly unlikely)\n        std_A[std_A == 0] = 1.0\n        X_B = (X_A - mean_A) / std_A\n        kappa_B = compute_condition_number(X_B)\n        all_results.append(kappa_B)\n        \n        # --- Scheme C: Physics-informed invariant scaling ---\n        # Note: This scheme uses the transformed values, but its scales are fixed constants.\n        d0_scaled = d0_t / SIGMA_D0\n        z0_scaled = z0_t / SIGMA_Z0\n        cos_phi = np.cos(phi_t)\n        sin_phi = np.sin(phi_t)\n        # The original cos_theta is unaffected by the transformations\n        cos_theta_t = np.cos(theta_t) # theta_t is same as theta_raw\n        sin_theta = np.sin(theta_t)\n        q_over_p_scaled = q_over_p_t * P_REF\n        \n        X_C = np.column_stack([\n            d0_scaled, z0_scaled, cos_phi, sin_phi, cos_theta_t, sin_theta, q_over_p_scaled\n        ])\n        kappa_C = compute_condition_number(X_C)\n        all_results.append(kappa_C)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.6f}' for r in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}