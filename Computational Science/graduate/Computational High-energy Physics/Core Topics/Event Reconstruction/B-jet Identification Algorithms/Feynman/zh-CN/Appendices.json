{
    "hands_on_practices": [
        {
            "introduction": "b-tagging 的核心在于识别由 b 强子衰变产生的位移径迹。冲击参数（Impact Parameter, IP）是从几何上量化这种位移的关键变量。本练习 () 将指导您从第一性原理出发，计算径迹相对于主顶点（Primary Vertex, PV）的三维有符号冲击参数。通过这个实践，您将理解符号的定义如何利用 b 强子沿喷注方向飞行的物理特性，从而极大地增强对重味喷注和轻味喷注的区分能力。",
            "id": "3505937",
            "problem": "在计算高能物理的b喷注鉴别算法（b-tagging）中，三维撞击参数（IP）是一个几何量，用于量化带电粒子径迹相对于主顶点（PV）的位移。带符号三维撞击参数是通过根据喷注方向赋予一个符号来构造的，其目的是增强重味喷注和轻味喷注之间的区分能力。主顶点（PV）位于原点。喷注轴由单位向量 $\\hat{n}_{\\text{jet}} = \\left(\\frac{3}{5}, 0, \\frac{4}{5}\\right)$ 给出。考虑三条重建的带电粒子径迹。每条径迹在局部被近似为一条直线，参数化为 $\\vec{r}_i(t) = \\vec{r}_{0,i} + t \\hat{u}_i$，其中 $\\vec{r}_{0,i}$ 是径迹上的一点，$\\hat{u}_i$ 是沿径迹的单位方向向量。给定的径迹和测量分辨率如下：\n- 径迹 $1$：$\\vec{r}_{0,1} = (0.4, -0.3, 0)\\ \\mathrm{mm}$，$\\hat{u}_1 = \\left(\\frac{3}{5}, \\frac{4}{5}, 0\\right)$，$\\sigma_1 = 0.03\\ \\mathrm{mm}$。\n- 径迹 $2$：$\\vec{r}_{0,2} = (0.6, 0, 0)\\ \\mathrm{mm}$，$\\hat{u}_2 = (0, 0, 1)$，$\\sigma_2 = 0.04\\ \\mathrm{mm}$。\n- 径迹 $3$：$\\vec{r}_{0,3} = (-0.6, 0, 0.2)\\ \\mathrm{mm}$，$\\hat{u}_3 = (0, 1, 0)$，$\\sigma_3 = 0.03\\ \\mathrm{mm}$。\n\n从三维欧几里得几何的第一性原理出发，对每条径迹确定其到主顶点（PV）的最近接点（PCA），三维撞击参数（IP）的大小 $d_{3\\mathrm{D},i}$，及其由PCA位移在喷注轴上标量投影所定义的符号，即如果 $(\\vec{r}_{\\text{PCA},i} - \\vec{r}_{\\text{PV}}) \\cdot \\hat{n}_{\\text{jet}} > 0$ 则为正，如果 $(\\vec{r}_{\\text{PCA},i} - \\vec{r}_{\\text{PV}}) \\cdot \\hat{n}_{\\text{jet}}  0$ 则为负。使用IP的高斯测量模型，其中每条径迹的分辨率为 $\\sigma_i$，构建组合的带符号撞击参数显著性\n$$\nS \\equiv \\sum_{i=1}^{3} \\frac{d_{3\\mathrm{D},i}^{\\text{signed}}}{\\sigma_i}.\n$$\n基于物理和统计推理，讨论上述符号约定如何影响重味喷注和轻味喷注之间的区分能力。\n\n根据给定的数值输入计算 $S$。将您的最终答案 $S$ 四舍五入到四位有效数字。将 $S$ 表示为一个无单位的无量纲数。",
            "solution": "该问题经核实具有科学依据，提法明确，客观且信息自足。所有必要信息均已提供，且所涉概念为实验高能物理学的基础。我们可以着手求解。\n\n该问题要求计算三条带电粒子径迹相对于位于原点的主顶点（PV）（$\\vec{r}_{\\text{PV}} = \\vec{0}$）的组合带符号撞击参数显著性 $S$。该求解过程对每条径迹需要几个步骤：确定最近接点（PCA），计算三维撞击参数的大小（$d_{3\\mathrm{D}}$），根据喷注方向赋予符号，最后计算显著性。\n\n一条带电粒子径迹 $i$ 被建模为一条直线，其参数化为 $\\vec{r}_i(t) = \\vec{r}_{0,i} + t \\hat{u}_i$。从主顶点（原点）到该径迹上任意一点的向量是 $\\vec{r}_i(t)$。从主顶点到该点的距离平方是 $d^2(t) = |\\vec{r}_i(t)|^2 = \\vec{r}_i(t) \\cdot \\vec{r}_i(t)$。最近接点（PCA）对应于使该距离最小化的参数 $t$ 的值，记为 $t_{\\text{PCA}}$。这发生在向量 $\\vec{r}_i(t_{\\text{PCA}})$ 与径迹的方向向量 $\\hat{u}_i$ 正交时。\n$$\n\\frac{d}{dt} d^2(t) \\Big|_{t=t_{\\text{PCA}}} = 2 \\vec{r}_i(t_{\\text{PCA}}) \\cdot \\frac{d\\vec{r}_i}{dt} = 2 \\vec{r}_i(t_{\\text{PCA}}) \\cdot \\hat{u}_i = 0\n$$\n代入径迹的参数化形式：\n$$\n(\\vec{r}_{0,i} + t_{\\text{PCA},i} \\hat{u}_i) \\cdot \\hat{u}_i = 0\n$$\n$$\n\\vec{r}_{0,i} \\cdot \\hat{u}_i + t_{\\text{PCA},i} (\\hat{u}_i \\cdot \\hat{u}_i) = 0\n$$\n由于 $\\hat{u}_i$ 是单位向量，$\\hat{u}_i \\cdot \\hat{u}_i = 1$。这给出了PCA处的参数值：\n$$\nt_{\\text{PCA},i} = -(\\vec{r}_{0,i} \\cdot \\hat{u}_i)\n$$\nPCA的位置向量则为：\n$$\n\\vec{r}_{\\text{PCA},i} = \\vec{r}_{0,i} + t_{\\text{PCA},i} \\hat{u}_i = \\vec{r}_{0,i} - (\\vec{r}_{0,i} \\cdot \\hat{u}_i) \\hat{u}_i\n$$\n三维撞击参数的大小 $d_{3\\mathrm{D},i}$ 是从主顶点（原点）到此点的距离：\n$$\nd_{3\\mathrm{D},i} = |\\vec{r}_{\\text{PCA},i}|\n$$\n撞击参数的符号由PCA向量与喷注轴单位向量 $\\hat{n}_{\\text{jet}} = \\left(\\frac{3}{5}, 0, \\frac{4}{5}\\right)$ 的标量积决定。\n带符号撞击参数为 $d_{3\\mathrm{D},i}^{\\text{signed}} = (\\text{sign}(\\vec{r}_{\\text{PCA},i} \\cdot \\hat{n}_{\\text{jet}})) d_{3\\mathrm{D},i}$。\n最后，组合显著性为 $S = \\sum_{i=1}^{3} S_i = \\sum_{i=1}^{3} \\frac{d_{3\\mathrm{D},i}^{\\text{signed}}}{\\sigma_i}$。\n\n我们现在将此过程应用于每条径迹。\n\n**径迹 1：**\n- $\\vec{r}_{0,1} = (0.4, -0.3, 0)\\ \\mathrm{mm}$\n- $\\hat{u}_1 = \\left(\\frac{3}{5}, \\frac{4}{5}, 0\\right) = (0.6, 0.8, 0)$\n- $\\sigma_1 = 0.03\\ \\mathrm{mm}$\n\n首先，我们求解 $t_{\\text{PCA},1}$：\n$$\n\\vec{r}_{0,1} \\cdot \\hat{u}_1 = (0.4)(0.6) + (-0.3)(0.8) + (0)(0) = 0.24 - 0.24 = 0\n$$\n$$\nt_{\\text{PCA},1} = -0 = 0\n$$\n这表明点 $\\vec{r}_{0,1}$ 本身就是最近接点。\n$$\n\\vec{r}_{\\text{PCA},1} = \\vec{r}_{0,1} = (0.4, -0.3, 0)\\ \\mathrm{mm}\n$$\n撞击参数的大小为：\n$$\nd_{3\\mathrm{D},1} = |\\vec{r}_{\\text{PCA},1}| = \\sqrt{(0.4)^2 + (-0.3)^2 + 0^2} = \\sqrt{0.16 + 0.09} = \\sqrt{0.25} = 0.5\\ \\mathrm{mm}\n$$\n接下来，我们使用 $\\hat{n}_{\\text{jet}} = (0.6, 0, 0.8)$ 来确定符号：\n$$\n\\vec{r}_{\\text{PCA},1} \\cdot \\hat{n}_{\\text{jet}} = (0.4)(0.6) + (-0.3)(0) + (0)(0.8) = 0.24\n$$\n由于标量积为正，符号为正。\n$$\nd_{3\\mathrm{D},1}^{\\text{signed}} = +0.5\\ \\mathrm{mm}\n$$\n径迹 $1$ 的显著性为：\n$$\nS_1 = \\frac{d_{3\\mathrm{D},1}^{\\text{signed}}}{\\sigma_1} = \\frac{0.5}{0.03} = \\frac{50}{3}\n$$\n\n**径迹 2：**\n- $\\vec{r}_{0,2} = (0.6, 0, 0)\\ \\mathrm{mm}$\n- $\\hat{u}_2 = (0, 0, 1)$\n- $\\sigma_2 = 0.04\\ \\mathrm{mm}$\n\n求解 $t_{\\text{PCA},2}$：\n$$\n\\vec{r}_{0,2} \\cdot \\hat{u}_2 = (0.6)(0) + (0)(0) + (0)(1) = 0\n$$\n$$\nt_{\\text{PCA},2} = -0 = 0\n$$\n所以, $\\vec{r}_{\\text{PCA},2} = \\vec{r}_{0,2} = (0.6, 0, 0)\\ \\mathrm{mm}$。\n撞击参数的大小为：\n$$\nd_{3\\mathrm{D},2} = |\\vec{r}_{\\text{PCA},2}| = \\sqrt{(0.6)^2 + 0^2 + 0^2} = 0.6\\ \\mathrm{mm}\n$$\n确定符号：\n$$\n\\vec{r}_{\\text{PCA},2} \\cdot \\hat{n}_{\\text{jet}} = (0.6)(0.6) + (0)(0) + (0)(0.8) = 0.36\n$$\n标量积为正，所以符号为正。\n$$\nd_{3\\mathrm{D},2}^{\\text{signed}} = +0.6\\ \\mathrm{mm}\n$$\n径迹 $2$ 的显著性为：\n$$\nS_2 = \\frac{d_{3\\mathrm{D},2}^{\\text{signed}}}{\\sigma_2} = \\frac{0.6}{0.04} = 15\n$$\n\n**径迹 3：**\n- $\\vec{r}_{0,3} = (-0.6, 0, 0.2)\\ \\mathrm{mm}$\n- $\\hat{u}_3 = (0, 1, 0)$\n- $\\sigma_3 = 0.03\\ \\mathrm{mm}$\n\n求解 $t_{\\text{PCA},3}$：\n$$\n\\vec{r}_{0,3} \\cdot \\hat{u}_3 = (-0.6)(0) + (0)(1) + (0.2)(0) = 0\n$$\n$$\nt_{\\text{PCA},3} = -0 = 0\n$$\n所以, $\\vec{r}_{\\text{PCA},3} = \\vec{r}_{0,3} = (-0.6, 0, 0.2)\\ \\mathrm{mm}$。\n撞击参数的大小为：\n$$\nd_{3\\mathrm{D},3} = |\\vec{r}_{\\text{PCA},3}| = \\sqrt{(-0.6)^2 + 0^2 + (0.2)^2} = \\sqrt{0.36 + 0.04} = \\sqrt{0.4}\\ \\mathrm{mm}\n$$\n确定符号：\n$$\n\\vec{r}_{\\text{PCA},3} \\cdot \\hat{n}_{\\text{jet}} = (-0.6)(0.6) + (0)(0) + (0.2)(0.8) = -0.36 + 0.16 = -0.20\n$$\n标量积为负，所以符号为负。\n$$\nd_{3\\mathrm{D},3}^{\\text{signed}} = -\\sqrt{0.4}\\ \\mathrm{mm}\n$$\n径迹 $3$ 的显著性为：\n$$\nS_3 = \\frac{d_{3\\mathrm{D},3}^{\\text{signed}}}{\\sigma_3} = \\frac{-\\sqrt{0.4}}{0.03}\n$$\n\n**组合显著性：**\n总显著性 $S$ 是各个显著性的和：\n$$\nS = S_1 + S_2 + S_3 = \\frac{50}{3} + 15 + \\frac{-\\sqrt{0.4}}{0.03}\n$$\n我们转换为共同分母并合并各项：\n$$\nS = \\frac{50}{3} + \\frac{45}{3} - \\frac{\\sqrt{0.4}}{0.03} = \\frac{95}{3} - \\frac{\\sqrt{4 \\times 10^{-1}}}{3 \\times 10^{-2}} = \\frac{95}{3} - \\frac{2 \\times 10^{-1/2}}{3 \\times 10^{-2}}\n$$\n让我们用更方便的形式进行数值计算：\n$$\nS = \\frac{95}{3} - \\frac{\\sqrt{0.4}}{0.03} = \\frac{95}{3} - \\frac{\\sqrt{4/10}}{3/100} = \\frac{95}{3} - \\frac{2/\\sqrt{10}}{3/100} = \\frac{95}{3} - \\frac{200}{3\\sqrt{10}}\n$$\n$$\nS = \\frac{1}{3} \\left( 95 - \\frac{200}{\\sqrt{10}} \\right) = \\frac{1}{3} \\left( 95 - \\frac{200\\sqrt{10}}{10} \\right) = \\frac{1}{3} (95 - 20\\sqrt{10})\n$$\n现在，我们计算数值：\n$$\nS \\approx \\frac{1}{3} (95 - 20 \\times 3.16227766) = \\frac{1}{3} (95 - 63.2455532) = \\frac{31.7544468}{3} \\approx 10.5848156\n$$\n四舍五入到四位有效数字得到 $10.58$。\n\n**关于区分能力的讨论：**\n使用带符号撞击参数可以显著增强区分源于重味夸克（底、粲）的喷注与源于轻味夸克（上、下、奇）或胶子的喷注的能力。物理原因如下：\n\n$1$。 **重味喷注：** 含有b夸克的强子（B强子）具有约 $1.5 \\times 10^{-12}\\ \\mathrm{s}$ 的可观寿命。在高能碰撞中，它们以大的洛伦兹增强产生，使其能够在衰变前从主相互作用点（PV）飞行宏观距离（通常在毫米量级）。这个衰变点形成一个位移的次级顶点（SV）。源于该SV的带电粒子的径迹，在向后外推时，并不指向PV。因此，这些径迹表现出大的撞击参数。关键在于，SV相对于PV的位移是*沿着*B强子的方向，而该方向与总喷注轴 $\\hat{n}_{\\text{jet}}$ 高度相关。因此，从PV到这类径迹的PCA的位移矢量 $\\vec{r}_{\\text{PCA}}$，倾向于在喷注轴上具有正的投影。这导致带符号撞击参数的分布主要为正值。\n\n$2$。 **轻味喷注：** 轻夸克和胶子会立即强子化，这意味着产生的喷注中的粒子实际上都源于PV。这些径迹测得的任何非零撞击参数，主要归因于径迹探测器的有限分辨率和多重散射。这些效应本质上是随机的。矢量 $\\vec{r}_{\\text{PCA}}$ 在垂直于径迹的平面上将具有随机的取向。因此，它在喷注轴上的投影 $\\vec{r}_{\\text{PCA}} \\cdot \\hat{n}_{\\text{jet}}$ 将以大致相等的概率为正或为负。由此产生的带符号撞击参数的分布关于零对称。\n\n$3$。 **统计分离：** 通过对带符号撞击参数显著性求和 $S = \\sum_i S_i$，我们利用了这一差异。对于重味喷注，各个项 $S_i$ 大多为正且相干地相加，从而为 $S$ 产生一个大的正值。对于轻味喷注，各项 $S_i$ 是正负值的混合，倾向于相互抵消，导致 $S$ 的值与围绕零的随机游走一致。因此，对于重味喷注（“信号”），检验统计量 $S$ 的结果分布将具有一个大的正均值，而对于轻味喷注（“本底”），其分布将以零为中心。因此，对足够大的 $S$ 值进行筛选，可以有效地选择出高度富集重味的喷注样本。",
            "answer": "$$\n\\boxed{10.58}\n$$"
        },
        {
            "introduction": "虽然单个径迹的冲击参数信息量很大，但将来自同一 b 强子衰变的多个径迹组合起来，可以重建出一个共同的、位移的次级顶点（Secondary Vertex, SV）。本练习 () 深入探讨了如何利用基于卡尔曼滤波思想的似然函数方法，来统计性地合并径迹信息，从而估计次级顶点的位置。更重要的是，您将学会如何计算其相对于主顶点的飞行距离显著性，这是 b-tagging 算法中一个极其强大的特征。",
            "id": "3505861",
            "problem": "在计算高能物理中，底夸克喷注鉴别（b-tagging）的一个关键组成部分是重建一个位移的次级顶点，其位置通过带电粒子径迹来估计。考虑在卡尔曼滤波器框架内，针对一个静态（次级顶点位置）的线性高斯测量模型的特殊情况。该次级顶点位于横向平面，其位置由向量 $\\mathbf{r} \\in \\mathbb{R}^{2}$ 表示。假设有一组 $N$ 条重建径迹，每条径迹都对同一顶点位置提供一个无偏高斯估计 $\\mathbf{r}_{i}$，其协方差矩阵 $\\mathbf{C}_{i}$ 为已知的对称正定矩阵。给定 $\\mathbf{r}$，这些径迹是条件独立的。主顶点（PV）的位置 $\\mathbf{r}_{\\mathrm{PV}}$ 是已知的，其高斯不确定度由协方差矩阵 $\\mathbf{V}_{\\mathrm{PV}}$ 描述。一个单位向量 $\\hat{\\mathbf{u}}$ 近似表示横向平面内的喷注轴。沿着 $\\hat{\\mathbf{u}}$ 的飞行距离是投影 $L = \\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})$，其不确定度 $\\sigma_{L}$ 是通过对主顶点和次级顶点的协方差进行线性传播得到的。\n\n从卡尔曼滤波器测量模型所隐含的高斯似然出发，为次级顶点位置构建似然函数 $\\mathcal{L}(\\mathbf{r})$，推导其最大似然估计量 $\\mathbf{\\hat{r}}$，求出最优解处的顶点卡方值 $\\chi^{2}$，并展示如何根据后验协方差 $\\mathbf{V}_{\\mathrm{SV}}$ 和 $\\mathbf{V}_{\\mathrm{PV}}$ 计算飞行距离显著性 $S = L / \\sigma_{L}$。\n\n然后，使用以下单位为毫米的科学真实数据集，计算飞行距离显著性。使用毫米作为距离单位，并将最终的显著性表示为一个纯数。将最终答案四舍五入到四位有效数字。\n\n径迹（$N = 3$）：\n- 径迹 1：$\\mathbf{r}_{1} = \\begin{pmatrix} 0.50 \\\\ 0.30 \\end{pmatrix}$，$\\mathbf{C}_{1} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix}$。\n- 径迹 2：$\\mathbf{r}_{2} = \\begin{pmatrix} 0.62 \\\\ 0.28 \\end{pmatrix}$，$\\mathbf{C}_{2} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix}$。\n- 径迹 3：$\\mathbf{r}_{3} = \\begin{pmatrix} 0.55 \\\\ 0.35 \\end{pmatrix}$，$\\mathbf{C}_{3} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix}$。\n\n主顶点（PV）：$\\mathbf{r}_{\\mathrm{PV}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，$\\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} (0.010)^{2}  0 \\\\ 0  (0.010)^{2} \\end{pmatrix}$。\n\n喷注轴单位向量：$\\hat{\\mathbf{u}} = \\begin{pmatrix} 0.8 \\\\ 0.6 \\end{pmatrix}$。",
            "solution": "用户提供的问题已经过验证，被认为是具有科学依据、良构、客观且完整的。所有提供的数据和条件在高能物理的背景下都是一致且真实的。该问题是最大似然估计和误差传播的一个标准应用。因此，我们可以开始进行解答。\n\n该问题要求推导顶点拟合中的关键量，并对飞行距离显著性进行数值计算。我们将首先提供理论推导，然后将其应用于给定的数据集。\n\n**第一部分：理论推导**\n\n设真实的次级顶点（SV）位置为二维向量 $\\mathbf{r}$。给定 $N$ 个测量（径迹），其中每条径迹 $i$ 提供顶点位置的一个估计 $\\mathbf{r}_i$。每条径迹的测量模型是一个多元高斯分布，其均值为 $\\mathbf{r}$，协方差矩阵 $\\mathbf{C}_i$ 是一个已知的对称正定矩阵。在给定 $\\mathbf{r}$ 的情况下观测到 $\\mathbf{r}_i$ 的概率密度函数是：\n$$p(\\mathbf{r}_i | \\mathbf{r}) = \\frac{1}{2\\pi \\sqrt{\\det(\\mathbf{C}_i)}} \\exp\\left(-\\frac{1}{2}(\\mathbf{r}_i - \\mathbf{r})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r})\\right)$$\n由于在给定 $\\mathbf{r}$ 的情况下径迹是条件独立的，因此 $N$ 条径迹的总似然函数 $\\mathcal{L}(\\mathbf{r})$ 是各个概率密度的乘积：\n$$\\mathcal{L}(\\mathbf{r}) = \\prod_{i=1}^{N} p(\\mathbf{r}_i | \\mathbf{r})$$\n在计算上，处理负对数似然更为方便，它与一个卡方函数 $\\chi^2(\\mathbf{r})$ 成正比：\n$$\\chi^2(\\mathbf{r}) = -2 \\ln \\mathcal{L}(\\mathbf{r}) + \\text{const} = \\sum_{i=1}^{N} (\\mathbf{r}_i - \\mathbf{r})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r})$$\n顶点位置的最大似然估计量（MLE），记为 $\\mathbf{\\hat{r}}$，是使 $\\chi^2(\\mathbf{r})$ 最小化的 $\\mathbf{r}$ 值。我们通过将 $\\chi^2(\\mathbf{r})$ 对 $\\mathbf{r}$ 的梯度设为零来找到这个值：\n$$\\nabla_{\\mathbf{r}} \\chi^2(\\mathbf{r}) = \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}} \\left( (\\mathbf{r}_i - \\mathbf{r})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r}) \\right) = \\sum_{i=1}^{N} -2 \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{r}) = \\mathbf{0}$$\n两边同除以 $-2$ 并整理各项可得：\n$$\\sum_{i=1}^{N} \\mathbf{C}_i^{-1} \\mathbf{r}_i - \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1}\\right) \\mathbf{r} = \\mathbf{0}$$\n解出 $\\mathbf{r}$ 即可得到最大似然估计量 $\\mathbf{\\hat{r}}$：\n$$\\mathbf{\\hat{r}} = \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1}\\right)^{-1} \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1} \\mathbf{r}_i\\right)$$\n这是一个广义加权平均，其中每次测量的权重矩阵是其协方差矩阵的逆，即 $\\mathbf{W}_i = \\mathbf{C}_i^{-1}$。估计的次级顶点位置的后验协方差矩阵 $\\mathbf{V}_{\\mathrm{SV}}$ 由权重矩阵之和的逆给出：\n$$\\mathbf{V}_{\\mathrm{SV}} = \\left(\\sum_{i=1}^{N} \\mathbf{C}_i^{-1}\\right)^{-1}$$\n最优解处的顶点卡方值是在 $\\mathbf{\\hat{r}}$ 处计算的 $\\chi^2$ 函数值：\n$$\\chi^{2}_{\\text{vertex}} = \\sum_{i=1}^{N} (\\mathbf{r}_i - \\mathbf{\\hat{r}})^{\\top} \\mathbf{C}_i^{-1} (\\mathbf{r}_i - \\mathbf{\\hat{r}})$$\n这个量可作为顶点拟合的拟合优度度量。\n\n接下来，我们讨论飞行距离显著性。飞行距离 $L$ 是位移向量 $(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})$ 在喷注轴单位向量 $\\hat{\\mathbf{u}}$ 上的投影：\n$$L = \\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})$$\n$L$ 的不确定度，记为 $\\sigma_L$，通过线性误差传播得到。位移向量 $\\mathbf{d} = \\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}}$ 的协方差矩阵 $\\mathbf{V_d}$ 是 $\\mathbf{\\hat{r}}$ 和 $\\mathbf{r}_{\\mathrm{PV}}$ 的协方差之和，因为它们是独立变量（主顶点位置的确定与构成次级顶点的径迹无关）。\n$$\\mathbf{V_d} = \\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}}$$\n标量投影 $L = \\hat{\\mathbf{u}}^{\\top}\\mathbf{d}$ 的方差由下式给出：\n$$\\sigma_L^2 = \\hat{\\mathbf{u}}^{\\top} \\mathbf{V_d} \\hat{\\mathbf{u}} = \\hat{\\mathbf{u}}^{\\top} (\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}}) \\hat{\\mathbf{u}}$$\n飞行距离显著性 $S$ 是飞行距离与其不确定度的比率：\n$$S = \\frac{L}{\\sigma_L} = \\frac{\\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}})}{\\sqrt{\\hat{\\mathbf{u}}^{\\top} (\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}}) \\hat{\\mathbf{u}}}}$$\n\n**第二部分：数值计算**\n\n给定以下数据集，距离单位为毫米：\n径迹数量：$N=3$。\n径迹位置：$\\mathbf{r}_{1} = \\begin{pmatrix} 0.50 \\\\ 0.30 \\end{pmatrix}$，$\\mathbf{r}_{2} = \\begin{pmatrix} 0.62 \\\\ 0.28 \\end{pmatrix}$，$\\mathbf{r}_{3} = \\begin{pmatrix} 0.55 \\\\ 0.35 \\end{pmatrix}$。\n径迹协方差：$\\mathbf{C}_{1} = \\mathbf{C}_{2} = \\mathbf{C}_{3} = \\mathbf{C} = \\begin{pmatrix} (0.040)^{2}  0 \\\\ 0  (0.040)^{2} \\end{pmatrix} = \\begin{pmatrix} 0.0016  0 \\\\ 0  0.0016 \\end{pmatrix}$。\n主顶点位置：$\\mathbf{r}_{\\mathrm{PV}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n主顶点协方差：$\\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} (0.010)^{2}  0 \\\\ 0  (0.010)^{2} \\end{pmatrix} = \\begin{pmatrix} 0.0001  0 \\\\ 0  0.0001 \\end{pmatrix}$。\n喷注轴单位向量：$\\hat{\\mathbf{u}} = \\begin{pmatrix} 0.8 \\\\ 0.6 \\end{pmatrix}$。\n\n由于所有径迹的协方差 $\\mathbf{C}_i$ 都相同且等于 $\\mathbf{C}$，因此 $\\mathbf{\\hat{r}}$ 的公式简化为算术平均值：\n$$\\mathbf{\\hat{r}} = \\left(N \\mathbf{C}^{-1}\\right)^{-1} \\left(\\mathbf{C}^{-1} \\sum_{i=1}^{N} \\mathbf{r}_i\\right) = \\frac{1}{N} \\mathbf{C} \\mathbf{C}^{-1} \\sum_{i=1}^{N} \\mathbf{r}_i = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{r}_i$$\n计算 $\\mathbf{\\hat{r}}$：\n$$\\mathbf{\\hat{r}} = \\frac{1}{3} \\left( \\begin{pmatrix} 0.50 \\\\ 0.30 \\end{pmatrix} + \\begin{pmatrix} 0.62 \\\\ 0.28 \\end{pmatrix} + \\begin{pmatrix} 0.55 \\\\ 0.35 \\end{pmatrix} \\right) = \\frac{1}{3} \\begin{pmatrix} 1.67 \\\\ 0.93 \\end{pmatrix} = \\begin{pmatrix} 1.67/3 \\\\ 0.31 \\end{pmatrix}$$\n飞行距离 $L$ 是：\n$$L = \\hat{\\mathbf{u}}^{\\top}(\\mathbf{\\hat{r}} - \\mathbf{r}_{\\mathrm{PV}}) = \\begin{pmatrix} 0.8  0.6 \\end{pmatrix} \\left( \\begin{pmatrix} 1.67/3 \\\\ 0.31 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\right)$$\n$$L = 0.8 \\times \\frac{1.67}{3} + 0.6 \\times 0.31 = \\frac{1.336}{3} + 0.186 = \\frac{1.336 + 3 \\times 0.186}{3} = \\frac{1.336 + 0.558}{3} = \\frac{1.894}{3} \\approx 0.63133...$$\n现在我们计算不确定度。首先，次级顶点的协方差 $\\mathbf{V}_{\\mathrm{SV}}$ 为：\n$$\\mathbf{V}_{\\mathrm{SV}} = \\left(\\sum_{i=1}^{3} \\mathbf{C}^{-1}\\right)^{-1} = (3 \\mathbf{C}^{-1})^{-1} = \\frac{1}{3} \\mathbf{C} = \\frac{1}{3} \\begin{pmatrix} 0.0016  0 \\\\ 0  0.0016 \\end{pmatrix}$$\n位移向量的总协方差是：\n$$\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} \\frac{0.0016}{3}  0 \\\\ 0  \\frac{0.0016}{3} \\end{pmatrix} + \\begin{pmatrix} 0.0001  0 \\\\ 0  0.0001 \\end{pmatrix} = \\begin{pmatrix} \\frac{0.0016}{3} + 0.0001  0 \\\\ 0  \\frac{0.0016}{3} + 0.0001 \\end{pmatrix}$$\n$$\\mathbf{V}_{\\mathrm{SV}} + \\mathbf{V}_{\\mathrm{PV}} = \\begin{pmatrix} \\frac{0.0016+0.0003}{3}  0 \\\\ 0  \\frac{0.0016+0.0003}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{0.0019}{3}  0 \\\\ 0  \\frac{0.0019}{3} \\end{pmatrix} = \\frac{0.0019}{3} \\mathbf{I}$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。\n飞行距离的方差 $\\sigma_L^2$ 是：\n$$\\sigma_L^2 = \\hat{\\mathbf{u}}^{\\top} \\left( \\frac{0.0019}{3} \\mathbf{I} \\right) \\hat{\\mathbf{u}} = \\frac{0.0019}{3} (\\hat{\\mathbf{u}}^{\\top} \\hat{\\mathbf{u}})$$\n因为 $\\hat{\\mathbf{u}}$ 是一个单位向量，所以 $\\hat{\\mathbf{u}}^{\\top} \\hat{\\mathbf{u}} = \\|\\hat{\\mathbf{u}}\\|^2 = 0.8^2 + 0.6^2 = 0.64 + 0.36 = 1$。\n因此，方差就是前面的标量因子：\n$$\\sigma_L^2 = \\frac{0.0019}{3} \\approx 0.0006333...$$\n不确定度 $\\sigma_L$ 是其平方根：\n$$\\sigma_L = \\sqrt{\\frac{0.0019}{3}} \\approx 0.025166...$$\n最后，飞行距离显著性 $S$ 是：\n$$S = \\frac{L}{\\sigma_L} = \\frac{1.894/3}{\\sqrt{0.0019/3}} \\approx \\frac{0.63133...}{0.025166...} \\approx 25.08643...$$\n将结果四舍五入到四位有效数字，我们得到 $25.09$。",
            "answer": "$$\\boxed{25.09}$$"
        },
        {
            "introduction": "从物理特征到监督式机器学习的桥梁，是为训练数据建立可靠的“真值”（ground truth）。为了训练 b-tagging 分类器，模拟事件中的每个喷注都必须被明确地标记为 b 喷注或非 b 喷注。本编码练习 () 旨在解决一个实际问题：当一个 b 强子靠近多个喷注，或一个喷注内有多个 b 强子时，如何设计一个确定性的规则来解决这些模糊性，从而为每个喷注分配唯一的 b 标签。这是构建任何高性能 b-tagging 算法的关键预处理步骤。",
            "id": "3505922",
            "problem": "给定质子-质子对撞中代表喷注和强子的简化事件记录，以及状态码和粒子来源。您的任务是实现一个确定性算法，为每个喷注分配一个唯一的二进制 $b$ 标签，用以指示该喷注是否匹配到至少一个底强子（$b$强子）。该算法需遵循现实约束，即一个喷注内可能存在多个 $b$ 强子，或者 $b$ 强子可能被邻近的多个喷注共享。分配必须是唯一的：任何单个 $b$ 强子都不能用于标记一个以上的喷注。\n\n从以下计算高能物理中使用的基础概念开始：\n- 喷注是通过赝快度 $\\eta$、方位角 $\\phi$ 和横向动量 $p_T$ 来表征的重建对象。角度以弧度为单位。强子与喷注之间的距离通过角间距来量化\n$$\n\\Delta R = \\sqrt{(\\Delta \\eta)^2 + (\\Delta \\phi)^2},\n$$\n其中 $\\Delta \\phi$ 的计算考虑了在 $[-\\pi,\\pi]$ 区间内的周期性包裹。\n- 一个 $b$ 强子是任何含有底夸克的强子。我们通过粒子数据组（PDG）标识符来识别 $b$ 强子：$B^+$ 的 $\\mathrm{PDG}\\,\\,\\mathrm{ID} = 521$，$B^0$ 的 $\\mathrm{PDG}\\,\\,\\mathrm{ID} = 511$，$B_s^0$ 的 $\\mathrm{PDG}\\,\\,\\mathrm{ID} = 531$，以及 $\\Lambda_b^0$ 的 $\\mathrm{PDG}\\,\\,\\mathrm{ID} = 5122$。如果一个强子的来源中包含 $\\mathrm{PDG}\\,\\,\\mathrm{ID} = 5$ 的底夸克，则该强子被视为一个有效的 $b$ 强子候选者。\n- 状态码编码了粒子在事件记录中所处的阶段。对于本问题，如果一个强子的状态码等于 $2$，则认为它可用于真值匹配。\n- 如果一个 $b$ 强子位于喷注半径参数 $R$ 的 $\\Delta R$ 范围之内，即 $\\Delta R \\le R$，则该喷注与此 $b$ 强子匹配。\n\n实现以下规则，以产生 $b$ 强子到喷注的唯一分配，从而为每个喷注生成唯一的二进制 $b$ 标签：\n- 如果一个 $b$ 强子位于多个喷注的半径 $R$ 范围内，则将其分配给 $\\Delta R$ 最近的喷注。如果 $\\Delta R$ 出现平局，则选择具有较大 $p_T$ 的喷注来打破平局；如果仍然平局，则选择在给定列表中索引最小的喷注。\n- 如果一个喷注在半径 $R$ 内包含多个 $b$ 强子，则最多只允许一个 $b$ 强子分配给该喷注。当喷注必须在候选者中进行选择时，优先选择具有较大 $p_T$ 的 $b$ 强子。\n\n您必须从基础概念中逻辑地推导出这些规则，并以算法方式实现它们，以确保每个强子最多分配给一个喷注，每个喷注最多接收一个强子。最终每个喷注的 $b$ 标签是一个整数：如果至少有一个 $b$ 强子分配给该喷注，则为 $1$，否则为 $0$。\n\n角度必须以弧度为单位。除角度外，不需要进行其他物理单位转换。最终输出必须是单行文本，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表的列表。每个内部列表必须包含代表该测试用例中各喷注的 $b$ 标签的整数。例如，您的程序应打印类似\n$$\n[\\,[1,0],\\,[0,1]\\,]\n$$\n的内容，但使用下面测试套件的实际结果。\n\n测试套件：\n- 案例 1 (常规匹配): $R = 0.4$。喷注:\n  - 喷注 $0$: $(p_T = 80.0, \\eta = 0.2, \\phi = 0.1)$\n  - 喷注 $1$: $(p_T = 60.0, \\eta = -1.0, \\phi = 2.4)$\n  强子 (状态 $2$):\n  - 强子 $0$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 521, p_T = 20.0, \\eta = 0.22, \\phi = 0.12)$，来源 $[5, 23]$\n  - 强子 $1$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 5122, p_T = 15.0, \\eta = -0.95, \\phi = 2.35)$，来源 $[5, 21]$\n- 案例 2 (一个强子靠近两个喷注，最近者获胜): $R = 0.4$。喷注:\n  - 喷注 $0$: $(p_T = 100.0, \\eta = 0.0, \\phi = 0.0)$\n  - 喷注 $1$: $(p_T = 90.0, \\eta = 0.0, \\phi = 0.35)$\n  强子 (状态 $2$):\n  - 强子 $0$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 511, p_T = 18.0, \\eta = 0.0, \\phi = 0.2)$，来源 $[5, 21]$\n- 案例 3 (一个喷注内有多个 $b$ 强子，选择 $p_T$ 较大者): $R = 0.4$。喷注:\n  - 喷注 $0$: $(p_T = 120.0, \\eta = 1.5, \\phi = -2.0)$\n  - 喷注 $1$: $(p_T = 70.0, \\eta = -0.3, \\phi = 1.0)$\n  强子 (状态 $2$):\n  - 强子 $0$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 531, p_T = 25.0, \\eta = 1.55, \\phi = -1.95)$，来源 $[5, 21]$\n  - 强子 $1$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 521, p_T = 10.0, \\eta = 1.52, \\phi = -2.10)$，来源 $[5, 21]$\n  - 强子 $2$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 411, p_T = 12.0, \\eta = -0.32, \\phi = 1.02)$，来源 $[4]$ (一个粲强子，不是 $b$ 强子)\n- 案例 4 (边界与平局处理): $R = 0.4$。喷注:\n  - 喷注 $0$: $(p_T = 80.0, \\eta = 0.0, \\phi = 0.0)$\n  - 喷注 $1$: $(p_T = 80.0, \\eta = 0.0, \\phi = 0.4)$\n  强子 (状态 $2$):\n  - 强子 $0$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 511, p_T = 22.0, \\eta = 0.0, \\phi = 0.2)$，来源 $[5]$\n- 案例 5 (两个邻近喷注和来自胶子分裂的两个 $b$ 强子): $R = 0.4$。喷注:\n  - 喷注 $0$: $(p_T = 110.0, \\eta = -0.5, \\phi = -2.7)$\n  - 喷注 $1$: $(p_T = 95.0, \\eta = -0.6, \\phi = -3.0)$\n  强子 (状态 $2$):\n  - 强子 $0$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 521, p_T = 18.0, \\eta = -0.52, \\phi = -2.68)$，来源 $[5, 21]$\n  - 强子 $1$: $(\\mathrm{PDG}\\,\\mathrm{ID} = 511, p_T = 16.0, \\eta = -0.58, \\phi = -2.95)$，来源 $[5, 21]$\n\n您的程序必须实现所述逻辑，并生成单行输出，其中包含按测试用例划分的喷注标签列表，该列表以逗号分隔并如前述用方括号括起。每个标签必须是整数（$0$ 或 $1$）。",
            "solution": "该问题要求实现一个确定性算法，根据一组重建喷注与事件记录中 $b$ 强子的空间关联，为这些喷注分配二进制 $b$ 标签。问题的核心是建立 $b$ 强子和喷注之间唯一的、一对一（或至多一对一）的映射关系，解决当多个喷注靠近单个 $b$ 强子或多个 $b$ 强子靠近单个喷注时出现的任何歧义。\n\n该解决方案设计为一个顺序执行的两阶段匹配过程，并基于所提供的规则。首先，执行以强子为中心的分配，每个 $b$ 强子做出选择。其次，通过以喷注为中心的最终处理来解决多个 $b$ 强子选择了同一喷注的冲突。\n\n关联的基本度量是在赝快度-方位角（$\\eta$-$\\phi$）空间中的角间距，定义为：\n$$\n\\Delta R = \\sqrt{(\\Delta \\eta)^2 + (\\Delta \\phi)^2}\n$$\n此处，$\\Delta \\eta = \\eta_{\\text{hadron}} - \\eta_{\\text{jet}}$ 是赝快度的差值。方位角差 $\\Delta \\phi = \\phi_{\\text{hadron}} - \\phi_{\\text{jet}}$ 必须考虑 $\\phi$ 坐标的周期性。$\\Delta \\phi$ 的值被包裹到区间 $[-\\pi, \\pi]$ 内。一个稳健的计算方法是使用四象限反正切函数：$\\Delta\\phi_{\\text{wrapped}} = \\operatorname{atan2}(\\sin(\\Delta\\phi), \\cos(\\Delta\\phi))$。\n\n算法按以下步骤进行：\n\n1.  **候选者识别**：第一步是筛选所提供的强子列表，以获得一组有效的 $b$ 强子候选者。一个强子被认为是有效候选者，需同时满足三个条件：\n    *   其粒子数据组（PDG）标识符是指定的 $b$ 强子之一：$\\{521, 511, 531, 5122\\}$。\n    *   其来源列表中包含底夸克的 PDG ID，即 $5$。\n    *   其状态码为 $2$，表示它是记录中一个最终的、可用的粒子。\n\n2.  **阶段 I：以强子为中心的临时分配**：在此阶段，每个有效的 $b$ 强子识别其唯一的、最佳的喷注伙伴。\n    *   对于每个有效的 $b$ 强子，我们计算它与事件中每个喷注的 $\\Delta R$。\n    *   任何满足 $\\Delta R \\le R$（其中 $R$ 是给定的喷注半径参数）的喷注都被视为一个潜在的匹配对象。\n    *   从其潜在匹配集合中，该 $b$ 强子被临时分配给满足以下标准的唯一喷注，标准按优先级顺序排列：\n        1.  最小的 $\\Delta R$。\n        2.  如果 $\\Delta R$ 值相同，则选择横向动量（$p_T$）最大的喷注。\n        3.  如果 $\\Delta R$ 和 $p_T$ 都相同，则选择输入列表中索引最小的喷注。\n    *   如果一个 $b$ 强子没有潜在的匹配对象（即不在任何喷注的半径 $R$ 范围内），则不进行分配。\n    *   此阶段产生一个临时分配列表，其中每个做出选择的 $b$ 强子都与一个喷注精确配对。在此阶段，一个喷注可能会被分配给多个 $b$ 强子。\n\n3.  **阶段 II：以喷注为中心的冲突解决**：此阶段确保每个喷注最终最多只与一个 $b$ 强子关联，从而保证最终分配的唯一性。\n    *   我们按目标喷注对临时分配进行分组。对于每个喷注，我们现在都有一个在阶段 I 中选择了它的所有 $b$ 强子的列表。\n    *   如果一个喷注被分配了零个或一个 $b$ 强子，其分配即为最终分配。\n    *   如果一个喷注被分配了多个 $b$ 强子，则存在冲突。冲突的解决方法是，喷注选择横向动量（$p_T$）最大的那个 $b$ 强子。分配给该喷注的所有其他临时分配都将被丢弃。问题陈述未指定强子 $p_T$ 的平局处理规则，并假定测试数据中不会出现此类平局。\n\n4.  **最终标签分配**：在所有冲突解决后，我们得到一组唯一的、最终的（$b$强子，喷注）配对。\n    *   为每个喷注创建一个标签数组，并全部初始化为 $0$。\n    *   对于出现在最终配对中的每个喷注，其对应的标签被设置为 $1$。不属于任何最终配对的喷注则保持其标签为 $0$。\n    *   这个二进制标签数组构成了一个测试用例的最终结果。\n\n这个多步骤、基于规则的过程是确定性的，并确保最终的 $b$ 标记决策是唯一的，且与问题陈述所施加的类物理约束一致。",
            "answer": "[[1,1],[0,1],[1,0],[1,0],[1,1]]"
        }
    ]
}