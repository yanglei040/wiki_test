{
    "hands_on_practices": [
        {
            "introduction": "对多重部分子相互作用的理解始于量化单次碰撞中发生多次散射的概率。本练习将从基本假设出发，推导双部分子散射（Double Parton Scattering, DPS）截面的基本公式。通过这个推导，我们将引出关键参数——有效截面 $\\sigma_{\\mathrm{eff}}$，它概括了碰撞的横向几何结构，是所有MPI模型的核心。",
            "id": "3535735",
            "problem": "在高能质子-质子碰撞中，底层事件（underlying event）包含来自多重部分子相互作用（Multiple Parton Interactions, MPI）的贡献，其中包括双部分子散射（Double Parton Scattering, DPS），即在单次强子-强子碰撞中发生两次独立的硬散射。考虑两个不同的硬过程，标记为 $X$ 和 $Y$，其包容性单次散射截面分别为 $\\sigma^{X}$ 和 $\\sigma^{Y}$。假设：\n\n- 纵向动量分数根据单个部分子分布函数（Parton Distribution Functions, PDFs）进行因子分解，因此纵向和横向自由度是独立的。\n- 两次硬散射在概率上是独立的。\n- 每个强子的横向结构由一个归一化的非负碰撞参数分布 $A(b)$ 编码，该分布仅取决于两个强子中心之间的横向矢量 $b$，并满足 $\\int d^{2}b\\,A(b)=1$。\n- 末态 $X$ 和 $Y$ 是不同的，因此不需要对称因子。\n\n从这些假设以及将 $\\sigma^{X}$ 和 $\\sigma^{Y}$ 解释为包容性单次散射截面出发，推导包容性双部分子散射截面 $\\sigma_{\\mathrm{DPS}}^{XY}$ 的表达式，用 $\\sigma^{X}$、$\\sigma^{Y}$ 和一个关于碰撞参数 $b$ 的积分来表示。通过关系式\n$$\n\\sigma_{\\mathrm{DPS}}^{XY}=\\frac{\\sigma^{X}\\,\\sigma^{Y}}{\\sigma_{\\mathrm{eff}}}\\,,\n$$\n定义有效截面 $\\sigma_{\\mathrm{eff}}$，并用 $A(b)$ 表示 $\\sigma_{\\mathrm{eff}}$。\n\n然后，对于宽度参数为 $B0$ 的高斯碰撞参数分布\n$$\nA(b)=\\frac{1}{2\\pi B}\\,\\exp\\!\\left(-\\frac{b^{2}}{2B}\\right),\n$$\n计算由此得到的 $\\sigma_{\\mathrm{eff}}$，将其表示为关于 $B$ 的闭合形式解析表达式。将最终答案表示为关于 $B$ 的单个解析表达式。无需四舍五入。最终的方框答案中不要包含单位。",
            "solution": "该问题陈述具有科学依据、提法明确、客观，并包含足够的信息以获得唯一解。它代表了高能粒子物理领域的一个标准理论推导，特别是在多重部分子相互作用（MPI）的建模中。因此，该问题是有效的，我们可以着手求解。\n\n推导始于在碰撞参数图像下对散射截面的概率性解释。例如，对于类型为 $X$ 的单个硬过程，其包容性截面表示为 $\\sigma^{X}$。问题指定了一个归一化的非负碰撞参数分布 $A(b)$，它描述了碰撞质子内部部分子相互作用的横向空间分布。归一化条件为 $\\int d^{2}b\\,A(b)=1$，其中 $b$ 是两个质子中心之间横向分离矢量的大小。\n\n在半经典 MPI 模型中，在固定的碰撞参数 $b$ 下，单次质子-质子碰撞中发生的类型为 $X$ 的硬散射平均数（记为 $\\langle n_{X}(b) \\rangle$）被假定为与单次散射截面 $\\sigma^{X}$ 和横向物质重叠函数 $A(b)$ 均成正比。这种关系表示为：\n$$\n\\langle n_{X}(b) \\rangle = \\sigma^{X} A(b)\n$$\n该形式在硬散射是稀有事件的假设下有效，此时相互作用的概率可以很好地由相互作用的平均数来近似。$\\langle n_{X}(b) \\rangle$ 的无量纲性质得以保持，因为 $\\sigma^{X}$ 的单位是面积，而 $A(b)$ 的单位是面积的倒数。\n\n类似地，对于第二个不同的硬过程 $Y$，在碰撞参数 $b$ 处的散射平均数为：\n$$\n\\langle n_{Y}(b) \\rangle = \\sigma^{Y} A(b)\n$$\n问题陈述了两次硬散射 $X$ 和 $Y$ 在概率上是独立的。在固定的碰撞参数 $b$ 下，同时发生双部分子散射（DPS）事件（其中一次散射是类型 $X$，另一次是类型 $Y$）的平均数是它们各自平均数的乘积：\n$$\n\\langle n_{XY}(b) \\rangle = \\langle n_{X}(b) \\rangle \\langle n_{Y}(b) \\rangle\n$$\n缺少 $1/2$ 的对称因子是因为末态 $X$ 和 $Y$ 被指定为不同的。如果它们是相同的（例如，过程 $X$ 发生两次），则需要一个 $1/2$ 的因子以避免重复计数。\n\n代入 $\\langle n_{X}(b) \\rangle$ 和 $\\langle n_{Y}(b) \\rangle$ 的表达式，我们得到在碰撞参数 $b$ 处 $XY$ 对的平均数：\n$$\n\\langle n_{XY}(b) \\rangle = (\\sigma^{X} A(b)) (\\sigma^{Y} A(b)) = \\sigma^{X}\\sigma^{Y} [A(b)]^{2}\n$$\n双部分子散射过程的包容性截面 $\\sigma_{\\mathrm{DPS}}^{XY}$，是通过将这对的平均数对所有可能的碰撞参数进行积分得到的：\n$$\n\\sigma_{\\mathrm{DPS}}^{XY} = \\int d^{2}b \\, \\langle n_{XY}(b) \\rangle = \\int d^{2}b \\, \\sigma^{X}\\sigma^{Y} [A(b)]^{2}\n$$\n由于 $\\sigma^{X}$ 和 $\\sigma^{Y}$ 是关于 $b$ 积分的常数，它们可以被提出来：\n$$\n\\sigma_{\\mathrm{DPS}}^{XY} = \\sigma^{X}\\sigma^{Y} \\int d^{2}b \\, [A(b)]^{2}\n$$\n这就是所求的包容性 DPS 截面的表达式。\n\n接下来，我们被给予有效截面 $\\sigma_{\\mathrm{eff}}$ 的定义：\n$$\n\\sigma_{\\mathrm{DPS}}^{XY} = \\frac{\\sigma^{X}\\sigma^{Y}}{\\sigma_{\\mathrm{eff}}}\n$$\n通过将此定义与推导出的 $\\sigma_{\\mathrm{DPS}}^{XY}$ 表达式进行比较，我们可以确定 $\\sigma_{\\mathrm{eff}}$ 的表达式。\n$$\n\\frac{\\sigma^{X}\\sigma^{Y}}{\\sigma_{\\mathrm{eff}}} = \\sigma^{X}\\sigma^{Y} \\int d^{2}b \\, [A(b)]^{2}\n$$\n假设 $\\sigma^X  0$ 且 $\\sigma^Y  0$，我们可以消去两边的 $\\sigma^{X}\\sigma^{Y}$ 项，得到：\n$$\n\\frac{1}{\\sigma_{\\mathrm{eff}}} = \\int d^{2}b \\, [A(b)]^{2}\n$$\n因此，有效截面是碰撞参数分布平方的积分的倒数：\n$$\n\\sigma_{\\mathrm{eff}} = \\frac{1}{\\int d^{2}b \\, [A(b)]^{2}}\n$$\n现在，我们必须为高斯碰撞参数分布的特定情况计算 $\\sigma_{\\mathrm{eff}}$：\n$$\nA(b) = \\frac{1}{2\\pi B} \\exp\\left(-\\frac{b^{2}}{2B}\\right)\n$$\n其中 $B0$ 是宽度参数。我们需要计算积分 $\\int d^{2}b \\, [A(b)]^{2}$。首先，我们对函数 $A(b)$ 进行平方：\n$$\n[A(b)]^{2} = \\left(\\frac{1}{2\\pi B}\\right)^{2} \\exp\\left(-2 \\cdot \\frac{b^{2}}{2B}\\right) = \\frac{1}{4\\pi^{2}B^{2}} \\exp\\left(-\\frac{b^{2}}{B}\\right)\n$$\n积分是在二维横向平面上进行的。在极坐标中计算最为方便，其中微分面积元为 $d^{2}b = b \\, db \\, d\\phi$。积分范围是 $b \\in [0, \\infty)$ 和 $\\phi \\in [0, 2\\pi)$。\n$$\n\\int d^{2}b \\, [A(b)]^{2} = \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\infty} db \\, b \\, \\left[ \\frac{1}{4\\pi^{2}B^{2}} \\exp\\left(-\\frac{b^{2}}{B}\\right) \\right]\n$$\n被积函数与角度 $\\phi$ 无关，因此角度积分只给出一个因子 $2\\pi$：\n$$\n\\int d^{2}b \\, [A(b)]^{2} = 2\\pi \\cdot \\frac{1}{4\\pi^{2}B^{2}} \\int_{0}^{\\infty} b \\, \\exp\\left(-\\frac{b^{2}}{B}\\right) db = \\frac{1}{2\\pi B^{2}} \\int_{0}^{\\infty} b \\, \\exp\\left(-\\frac{b^{2}}{B}\\right) db\n$$\n为了求解剩余的径向积分，我们进行变量替换。令 $u = b^{2}/B$。那么 $du = (2b/B)db$，这意味着 $b \\, db = (B/2)du$。$u$ 的积分极限仍然是 $0$ 和 $\\infty$。\n$$\n\\int_{0}^{\\infty} b \\, \\exp\\left(-\\frac{b^{2}}{B}\\right) db = \\int_{0}^{\\infty} \\exp(-u) \\left(\\frac{B}{2}\\right) du = \\frac{B}{2} \\int_{0}^{\\infty} \\exp(-u) du\n$$\n从 $0$ 到 $\\infty$ 对 $\\exp(-u)$ 的积分是一个标准结果：\n$$\n\\int_{0}^{\\infty} \\exp(-u) du = \\left[-\\exp(-u)\\right]_{0}^{\\infty} = (-\\exp(-\\infty)) - (-\\exp(0)) = 0 - (-1) = 1\n$$\n所以，径向积分的计算结果为 $B/2$。将此结果代回：\n$$\n\\int d^{2}b \\, [A(b)]^{2} = \\frac{1}{2\\pi B^{2}} \\left(\\frac{B}{2}\\right) = \\frac{B}{4\\pi B^{2}} = \\frac{1}{4\\pi B}\n$$\n最后，我们使用其定义计算 $\\sigma_{\\mathrm{eff}}$：\n$$\n\\sigma_{\\mathrm{eff}} = \\frac{1}{\\int d^{2}b \\, [A(b)]^{2}} = \\frac{1}{1/(4\\pi B)} = 4\\pi B\n$$\n因此，对于宽度参数为 $B$ 的高斯碰撞参数分布，有效截面是 $4\\pi B$。",
            "answer": "$$\n\\boxed{4\\pi B}\n$$"
        },
        {
            "introduction": "在理解了MPI的截面（“是什么”）之后，我们转向其模拟方法（“如何做”）。现代事件生成器采用复杂的算法，根据理论概率来抽样相互作用。本练习将实现苏达科夫否决算法（Sudakov veto algorithm），这是一种模拟如MPI和部分子簇射等事件序列的核心技术。",
            "id": "3535737",
            "problem": "实现一个完整的、可运行的程序，在一个多重部分子相互作用 (MPI) 加初态辐射 (ISR) 的玩具模型中，使用一个基于否决的采样器模拟一个交错的发射序列，并验证采样得到的横向动量谱在统计不certainty范围内，能够再现解析积分的速率。横向动量必须以吉电子伏特 (GeV) 为单位进行解释，所有对横向动量的积分都必须以 GeV 表示。该程序不得要求任何输入，并且必须按如下规定打印单行输出。\n\n基本原理和定义：\n- 发射序列被建模为在演化变量横向动量 $p_T$ 上的一个非齐次泊松过程，其总强度（率密度）$f(p_T)$ 是两个通道强度之和，\n  $$ f(p_T) \\equiv f_1(p_T) + f_2(p_T), $$\n  分别代表多重部分子相互作用 (MPI) 和初态辐射 (ISR)。在本问题中，使用以下具体形式：\n  $$ f_1(p_T) = \\frac{A}{p_T + \\lambda_1}, \\quad f_2(p_T) = \\frac{B}{p_T + \\lambda_2}, $$\n  其中 $A$、$B$、$\\lambda_1$ 和 $\\lambda_2$ 均为严格为正的常数。\n- 演化按 $p_T$ 排序，从初始标度 $Q$ 向下进行到截止标度 $p_{T0}$（两者单位均为 GeV）。在某一标度 $p_T$ 之上没有发射的概率由 Sudakov 形状因子给出：\n  $$ \\Delta_f(p_T \\mid Q) = \\exp\\!\\left(-\\int_{p_T}^{Q} f(t)\\,dt\\right). $$\n- 否决算法是一种用于非齐次泊松过程的拒绝采样方法。要使用它，需构建一个过高估计函数 $G(p_T)$，该函数对 $[p_{T0},Q]$ 中的所有 $p_T$ 均满足 $G(p_T) \\ge f(p_T)$，并且其积分具有解析可逆性。在本问题中，您必须使用\n  $$ G(p_T) = \\frac{A+B}{p_T + \\lambda_{\\min}}, \\quad \\lambda_{\\min} = \\min(\\lambda_1,\\lambda_2), $$\n  这是一个有效的过高估计，因为对于所有 $p_T \\ge 0$，有 $\\frac{A}{p_T+\\lambda_1} \\le \\frac{A}{p_T+\\lambda_{\\min}}$ 和 $\\frac{B}{p_T+\\lambda_2} \\le \\frac{B}{p_T+\\lambda_{\\min}}$，所以 $f_1(p_T)+f_2(p_T) \\le \\frac{A+B}{p_T+\\lambda_{\\min}}$。\n- 积分强度为\n  $$ I_1 = \\int_{p_{T0}}^{Q} f_1(t)\\,dt = A \\ln\\!\\left(\\frac{Q+\\lambda_1}{p_{T0}+\\lambda_1}\\right), \\quad\n     I_2 = \\int_{p_{T0}}^{Q} f_2(t)\\,dt = B \\ln\\!\\left(\\frac{Q+\\lambda_2}{p_{T0}+\\lambda_2}\\right), $$\n  且 $I = I_1 + I_2$。在 $p_{T0}$ 之上零发射的解析概率为 $\\Delta_f(p_{T0}\\mid Q) = e^{-I}$，每个事例的平均发射数为 $I$。对于一个包含 $N$ 个独立事例的样本，样本平均发射多重数的标准差为 $\\sqrt{I/N}$，零发射分数的标准差为 $\\sqrt{e^{-I}(1-e^{-I})/N}$（所有量均为无量纲）。\n\n任务要求：\n1. 实现一个基于否决的采样器，使用指定的 $G(p_T)$，为每个事例生成按 $p_T$ 从 $Q$ 向下到 $p_{T0}$ 排序的完整交错的已接受发射序列。在每次已接受的发射时，还需根据在已接受的 $p_T$ 处的相对贡献，按条件概率在 $f_1$ 和 $f_2$ 之间进行通道选择。\n2. 针对测试套件中的每个参数点，为一组独立事例运行模拟。记录：\n   - 已接受的发射总数，$M$。\n   - 通道 1 中已接受的发射数，$M_1$。\n   - 通道 2 中已接受的发射数，$M_2$。\n   - 零发射事例的数量，$Z$。\n   计算以下可观测量：\n   - 每个事例的样本平均发射多重数，$\\hat{\\mu} = M/N$（无量纲）。\n   - 解析总积分强度 $I$（无量纲），以及比率 $r_{\\text{tot}} = \\hat{\\mu}/I$。\n   - 总均值的 $z$-分数，$z_{\\text{tot}} = (\\hat{\\mu} - I)/\\sqrt{I/N}$（无量纲）。\n   - 样本零发射分数，$\\hat{\\Delta} = Z/N$（无量纲），及其与解析值的比率，$r_{0} = \\hat{\\Delta}/e^{-I}$。\n   - 零发射分数的 $z$-分数，$z_{0} = (\\hat{\\Delta} - e^{-I})/\\sqrt{e^{-I}(1-e^{-I})/N}$（无量纲）。\n   - 每个通道的样本平均多重数，$\\hat{\\mu}_1 = M_1/N$ 和 $\\hat{\\mu}_2 = M_2/N$（无量纲），及其与解析值的比率 $r_1 = \\hat{\\mu}_1/I_1$，$r_2 = \\hat{\\mu}_2/I_2$（无量纲）。\n3. 使用固定的随机种子 $12345$ 以保证可复现性。\n4. 单位：$p_T$、$Q$、$p_{T0}$、$\\lambda_1$ 和 $\\lambda_2$ 必须以 GeV 为单位；$A$、$B$、$I$ 以及所有比率和 $z$-分数均为无量纲。\n5. 测试套件：为以下三个参数集运行您的程序，每个参数集有 $N$ 个事例：\n   - 情况 A (一般情况): $A = 0.8$, $B = 0.6$, $\\lambda_1 = 2.0\\,\\mathrm{GeV}$, $\\lambda_2 = 1.0\\,\\mathrm{GeV}$, $Q = 50.0\\,\\mathrm{GeV}$, $p_{T0} = 0.5\\,\\mathrm{GeV}$, $N = 100000$。\n   - 情况 B (低活跃度/接近零发射边界): $A = 0.05$, $B = 0.02$, $\\lambda_1 = 5.0\\,\\mathrm{GeV}$, $\\lambda_2 = 3.0\\,\\mathrm{GeV}$, $Q = 100.0\\,\\mathrm{GeV}$, $p_{T0} = 1.0\\,\\mathrm{GeV}$, $N = 100000$。\n   - 情况 C (高活跃度): $A = 1.5$, $B = 1.2$, $\\lambda_1 = 1.0\\,\\mathrm{GeV}$, $\\lambda_2 = 0.8\\,\\mathrm{GeV}$, $Q = 30.0\\,\\mathrm{GeV}$, $p_{T0} = 0.4\\,\\mathrm{GeV}$, $N = 100000$。\n6. 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，按情况 A、情况 B、情况 C 的顺序连接：\n   - 对于每种情况，输出六个浮点数：$[r_{\\text{tot}}, z_{\\text{tot}}, r_{0}, z_{0}, r_1, r_2]$。\n   因此，最后一行必须在一个方括号内包含 $18$ 个逗号分隔的数值条目。所有输出均为无量纲。\n\n以指定的单位表示所有涉及物理量的答案。不使用角度。不得使用百分比；在适用的地方使用小数。程序必须完全自包含，并能使用给定的随机种子复现。",
            "solution": "我们将多重部分子相互作用 (MPI) 和初态辐射 (ISR) 中的交错发射序列建模为一个在横向动量变量 $p_T$ 上的非齐次泊松过程，按从一个硬标度 $Q$ 向下到截止标度 $p_{T0}$ 的顺序演化。基本出发点是，一个区间上的非齐次泊松过程（强度为 $f(p_T)$）与其由 Sudakov 形状因子给出的无事件概率之间的对应关系。具体来说，给定在 $p_T \\in [p_{T0}, Q]$ 上的强度 $f(p_T)$，在某一标度 $p_T$ 之上没有发射的概率为\n$$ \\Delta_f(p_T \\mid Q) = \\exp\\!\\left(-\\int_{p_T}^Q f(t)\\, dt\\right), $$\n而每个事例的预期发射数是积分\n$$ I = \\int_{p_{T0}}^Q f(t)\\, dt. $$\n这些是非齐次泊松过程的标准结果，并构成了部分子簇射和多重部分子相互作用 (MPI) 模拟中使用的 Sudakov 表述的基础。\n\n在当前设置中，总强度是两个通道之和，\n$$ f(p_T) = f_1(p_T) + f_2(p_T), \\quad f_1(p_T) = \\frac{A}{p_T + \\lambda_1}, \\quad f_2(p_T) = \\frac{B}{p_T + \\lambda_2}, $$\n其中 $A$、$B$、$\\lambda_1$ 和 $\\lambda_2$ 是正常数，而 $p_T$、$\\lambda_1$、$\\lambda_2$、$Q$、$p_{T0}$ 的单位是吉电子伏特 (GeV)。直接积分可得\n$$ I_1 = \\int_{p_{T0}}^Q \\frac{A}{t + \\lambda_1}\\, dt = A \\ln\\!\\left(\\frac{Q + \\lambda_1}{p_{T0} + \\lambda_1}\\right), \\quad\n   I_2 = \\int_{p_{T0}}^Q \\frac{B}{t + \\lambda_2}\\, dt = B \\ln\\!\\left(\\frac{Q + \\lambda_2}{p_{T0} + \\lambda_2}\\right), $$\n因此\n$$ I = I_1 + I_2, \\quad \\Delta_f(p_{T0}\\mid Q) = e^{-I}. $$\n\n为了生成按 $p_T$ 排序的发射序列，我们使用否决算法。该算法依赖于构建一个过高估计函数 $G(p_T)$，使得对于相关范围内的所有 $p_T$，都有 $G(p_T) \\ge f(p_T)$，并且 $G(p_T)$ 的积分具有解析可逆性，以便对候选点进行采样。我们选择\n$$ G(p_T) = \\frac{A+B}{p_T + \\lambda_{\\min}}, \\quad \\lambda_{\\min} \\equiv \\min(\\lambda_1,\\lambda_2). $$\n这满足 $G(p_T) \\ge f(p_T)$，因为 $p_T + \\lambda_{\\min} \\le p_T + \\lambda_i$ 意味着 $\\frac{1}{p_T+\\lambda_i} \\le \\frac{1}{p_T+\\lambda_{\\min}}$（对于 $i \\in \\{1,2\\}$），因此\n$$ f_1(p_T) + f_2(p_T) = \\frac{A}{p_T+\\lambda_1} + \\frac{B}{p_T+\\lambda_2} \\le \\frac{A}{p_T+\\lambda_{\\min}} + \\frac{B}{p_T+\\lambda_{\\min}} = \\frac{A+B}{p_T+\\lambda_{\\min}} = G(p_T). $$\n\n$G(p_T)$ 在两个有序标度 $p_T'  p_T$ 之间的积分为\n$$ \\int_{p_T'}^{p_T} G(t)\\, dt = (A+B) \\int_{p_T'}^{p_T} \\frac{dt}{t + \\lambda_{\\min}} = (A+B)\\, \\ln\\!\\left( \\frac{p_T + \\lambda_{\\min}}{p_T' + \\lambda_{\\min}} \\right). $$\n在从 $p_T = Q$ 到 $p_{T0}$ 的向后演化中，用于非齐次泊松过程的标准稀疏法（Lewis-Shedler 稀疏法）等价于 Sudakov 否决算法。从当前标度 $p$ 开始，我们抽取一个均匀随机变量 $U \\in (0,1)$ 并求解\n$$ \\exp\\!\\left( - \\int_{p'}^{p} G(t)\\, dt \\right) = U \\quad \\iff \\quad (A+B)\\, \\ln\\!\\left( \\frac{p + \\lambda_{\\min}}{p' + \\lambda_{\\min}} \\right) = -\\ln U, $$\n这产生下一个候选标度\n$$ p' = \\left(p + \\lambda_{\\min}\\right)\\, U^{1/(A+B)} - \\lambda_{\\min}. $$\n如果 $p' \\le p_{T0}$，演化停止。否则，以概率\n$$ P_{\\text{acc}}(p') = \\frac{f(p')}{G(p')} = \\frac{\\frac{A}{p' + \\lambda_1} + \\frac{B}{p' + \\lambda_2}}{\\frac{A+B}{p' + \\lambda_{\\min}}} \\in (0,1]. $$\n接受该候选。如果接受，则在 $p'$ 处记录一次发射，并通过竞争选择发射通道，概率为 $P(\\text{ch}=1\\mid p') = f_1(p')/f(p')$ 和 $P(\\text{ch}=2\\mid p') = f_2(p')/f(p')$。无论候选被接受还是否决，演化都从新的当前标度 $p \\leftarrow p'$ 继续，强制严格的 $p_T$ 排序，直到 $p \\le p_{T0}$。\n\n统计验证基于非齐次泊松过程的经过充分检验的性质：每个事例的总计数服从均值为 $I$ 的泊松分布，因此在 $N$ 个事例上的样本均值 $\\hat{\\mu}$ 的标准差为 $\\sqrt{I/N}$；零发射指示变量服从均值为 $e^{-I}$ 的伯努利分布，因此零发射分数 $\\hat{\\Delta}$ 的标准差为 $\\sqrt{e^{-I}(1-e^{-I})/N}$。\n\n计算所需可观量的算法设计：\n1. 对每个测试用例，固定随机种子以确保可复现性。初始化已接受发射总数 $M$、各通道发射数 $M_1$、$M_2$ 以及零发射事例数 $Z$ 的计数器。\n2. 对 $N$ 个事例中的每一个，设置 $p \\leftarrow Q$，并使用 $G(p_T)$ 的可逆累积函数如上所示重复采样候选标度 $p'$。如果 $p' \\le p_{T0}$，则结束该事例。否则计算 $P_{\\text{acc}}(p')$，抽取一个均匀随机数 $V \\in (0,1)$，如果 $V  P_{\\text{acc}}(p')$ 则接受，更新计数，并根据 $f_i(p')/f(p')$ 选择发射通道。设置 $p \\leftarrow p'$ 并重复。\n3. 在 $N$ 个事例后，计算 $\\hat{\\mu} = M/N$、$\\hat{\\mu}_1 = M_1/N$、$\\hat{\\mu}_2 = M_2/N$ 和 $\\hat{\\Delta} = Z/N$。计算解析值 $I_1$、$I_2$、$I=I_1+I_2$ 和 $\\Delta = e^{-I}$，以及标准差 $\\sigma_{\\text{tot}} = \\sqrt{I/N}$ 和 $\\sigma_0 = \\sqrt{\\Delta (1-\\Delta)/N}$。构建比率 $r_{\\text{tot}} = \\hat{\\mu}/I$、$r_1 = \\hat{\\mu}_1/I_1$、$r_2 = \\hat{\\mu}_2/I_2$、$r_0 = \\hat{\\Delta}/\\Delta$，以及 $z$-分数 $z_{\\text{tot}} = (\\hat{\\mu}-I)/\\sigma_{\\text{tot}}$、$z_0 = (\\hat{\\Delta}-\\Delta)/\\sigma_0$。\n4. 为保证数值稳健性，如果由于极端参数（在提供的套件中并非如此）导致标准差为零，则按惯例将相应的 $z$-分数设置为 $0$。\n5. 按要求的顺序 $[r_{\\text{tot}}, z_{\\text{tot}}, r_0, z_0, r_1, r_2]$，将情况 A、情况 B、情况 C 的结果连接成一个单一列表，作为单行输出。\n\n此过程源于非齐次泊松过程、Sudakov 形状因子和稀疏（否决）算法的基本理论。所选的 $G(p_T)$ 与接受概率 $f/G$ 相结合，保证了采样的精确性，而通道的交错是通过在每次接受的发射时按比例于 $f_i(p_T)$ 的竞争概率实现的。通过接近于 1 的比率和数量级为 1 的 $z$-分数（在统计涨落范围内）进行的验证表明，采样的 $p_T$ 谱在统计不确定性范围内再现了积分得到的解析速率。",
            "answer": "```python\nimport numpy as np\n\ndef simulate_case(A, B, lam1, lam2, Q, pT0, N, rng):\n    \"\"\"\n    Simulate N events of a pT-ordered interleaved sequence using a veto algorithm\n    with overestimate G(pT) = (A+B)/(pT + lam_min). Return (M, M1, M2, Z).\n    \"\"\"\n    lam_min = min(lam1, lam2)\n    AB = A + B\n\n    total_emissions = 0\n    ch1_emissions = 0\n    ch2_emissions = 0\n    zero_events = 0\n\n    for _ in range(N):\n        p = Q\n        accepted_in_event = 0\n\n        while True:\n            # Generate next candidate from G via inversion:\n            U = rng.random()\n            # p' = (p + lam_min) * U^(1/(A+B)) - lam_min\n            p_candidate = (p + lam_min) * (U ** (1.0 / AB)) - lam_min\n\n            if p_candidate = pT0:\n                break\n\n            # Compute f1, f2, f and G at candidate\n            f1 = A / (p_candidate + lam1)\n            f2 = B / (p_candidate + lam2)\n            f_total = f1 + f2\n            g = AB / (p_candidate + lam_min)\n\n            # Accept with probability f_total/g\n            V = rng.random()\n            if V  (f_total / g):\n                # Accepted emission\n                total_emissions += 1\n                accepted_in_event += 1\n                # Channel competition\n                W = rng.random()\n                if W  (f1 / f_total):\n                    ch1_emissions += 1\n                else:\n                    ch2_emissions += 1\n\n            # Continue evolution from candidate scale regardless of accept/reject\n            p = p_candidate\n\n        if accepted_in_event == 0:\n            zero_events += 1\n\n    return total_emissions, ch1_emissions, ch2_emissions, zero_events\n\n\ndef analytics(A, B, lam1, lam2, Q, pT0):\n    \"\"\"\n    Compute analytic integrals I1, I2, I and Delta = exp(-I).\n    \"\"\"\n    I1 = A * np.log((Q + lam1) / (pT0 + lam1))\n    I2 = B * np.log((Q + lam2) / (pT0 + lam2))\n    I = I1 + I2\n    Delta = np.exp(-I)\n    return I1, I2, I, Delta\n\n\ndef summarize_results(A, B, lam1, lam2, Q, pT0, N, rng):\n    M, M1, M2, Z = simulate_case(A, B, lam1, lam2, Q, pT0, N, rng)\n    I1, I2, I, Delta = analytics(A, B, lam1, lam2, Q, pT0)\n\n    # Sample means\n    mu_hat = M / N\n    mu1_hat = M1 / N\n    mu2_hat = M2 / N\n    Delta_hat = Z / N\n\n    # Ratios\n    r_tot = mu_hat / I if I > 0 else 1.0\n    r1 = mu1_hat / I1 if I1 > 0 else 1.0\n    r2 = mu2_hat / I2 if I2 > 0 else 1.0\n    r0 = Delta_hat / Delta if Delta > 0 else 1.0\n\n    # Standard deviations and z-scores\n    sigma_tot = np.sqrt(I / N) if I > 0 else 0.0\n    if sigma_tot > 0:\n        z_tot = (mu_hat - I) / sigma_tot\n    else:\n        z_tot = 0.0\n\n    var0 = Delta * (1.0 - Delta) / N\n    sigma0 = np.sqrt(var0) if var0 > 0 else 0.0\n    if sigma0 > 0:\n        z0 = (Delta_hat - Delta) / sigma0\n    else:\n        z0 = 0.0\n\n    return [r_tot, z_tot, r0, z0, r1, r2]\n\n\ndef solve():\n    rng = np.random.default_rng(12345)\n\n    # Test suite: three cases\n    test_cases = [\n        # Case A: general\n        (0.8, 0.6, 2.0, 1.0, 50.0, 0.5, 100000),\n        # Case B: low activity\n        (0.05, 0.02, 5.0, 3.0, 100.0, 1.0, 100000),\n        # Case C: high activity\n        (1.5, 1.2, 1.0, 0.8, 30.0, 0.4, 100000),\n    ]\n\n    results = []\n    for A, B, lam1, lam2, Q, pT0, N in test_cases:\n        res = summarize_results(A, B, lam1, lam2, Q, pT0, N, rng)\n        results.extend(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "掌握了理论和算法工具后，我们现在可以用它们来研究真实的物理现象。本练习将构建一个玩具模型，以探究“底层事件”活动如何随碰撞能量变化。通过这个实践，我们将展示简单模型为何会失效，并揭示引入新物理概念的必要性，例如能量依赖的颜色屏蔽尺度。",
            "id": "3535748",
            "problem": "在一个多重部分子相互作用（MPI）的框架内，对底层事件（UE）平台区的能量标度进行一次基于原理的玩具模型研究，重点关注固定的软正规化标度无法再现观测到的随质心能量上升的现象。使用以下基本原理和假设，并从中推导出所需的算法。\n\n1. 基本原理和模型假设：\n   - 在一个半硬微射流模型中，由横向动量红外标度正规化的包容性半硬射流截面，其形式可以概括地由一个积分给出：\n     $$ \\sigma_{\\text{jet}}(s; p_T^0) \\propto \\int_{0}^{\\infty} \\frac{\\alpha_s^2 \\, dp_T^2}{\\left(p_T^2 + (p_T^0)^2\\right)^2} \\, \\mathcal{L}(x_1, x_2; s), $$\n     其中 $p_T^0$ 是一个有效的软正规化（色屏蔽）标度，$s$ 是强子质心能量的平方，$\\alpha_s$ 是强耦合常数，$\\mathcal{L}$ 代表部分子光度。近似地认为 $\\alpha_s$ 在积分的主要区域内变化缓慢，并利用\n     $$ \\int_{0}^{\\infty} \\frac{dp_T^2}{\\left(p_T^2 + (p_T^0)^2\\right)^2} = \\frac{1}{(p_T^0)^2}, $$\n     可以得到参数依赖关系\n     $$ \\sigma_{\\text{jet}}(s; p_T^0) \\propto \\frac{\\mathcal{L}(s)}{(p_T^0)^2}. $$\n   - 在小部分子动量分数处，唯象拟合和微扰量子色动力学（QCD）演化促使我们假设相关的部分子光度随能量近似呈幂律增长，\n     $$ \\mathcal{L}(s) \\propto s^{\\epsilon}, $$\n     其中 $0  \\epsilon  1$ 代表有效的小-$x$增长。\n   - 在一个程像绘景中，每个非弹性事件中半硬部分子-部分子相互作用的平均数与半硬截面除以一个有效重叠截面成正比，\n     $$ \\langle N_{\\text{MPI}}(s) \\rangle \\propto \\frac{\\sigma_{\\text{jet}}(s; p_T^0(s))}{\\sigma_{\\text{eff}}}, $$\n     其中 $\\sigma_{\\text{eff}}$ 是一个恒定的有效重叠标度。假设UE平台区可观测密度与平均相互作用数成正比，\n     $$ \\rho_{\\text{UE}}(s) \\propto \\langle N_{\\text{MPI}}(s) \\rangle. $$\n   - 结合以上各式，得到基线比例关系\n     $$ \\rho_{\\text{UE}}(s) \\propto \\frac{s^{\\epsilon}}{\\left(p_T^0(s)\\right)^2}. $$\n\n2. 真实参考模型与测试模型：\n   - 真实参考模型（具有能量依赖的屏蔽）：假设软正规化标度依赖于能量，形式为\n     $$ p_T^0(s) = p_{T,\\text{ref}}^0 \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon_0}, $$\n     其中给定的 $\\epsilon_0 > 0$。那么UE平台区的标度行为是\n     $$ \\rho_{\\text{true}}(s) \\propto \\frac{s^{\\epsilon}}{\\left(p_{T,\\text{ref}}^0\\right)^2} \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{-2\\epsilon_0} \\propto \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon - 2\\epsilon_0}. $$\n   - 测试模型（具有固定的软正规化）：假设 $p_T^0(s) = p_{T,\\text{ref}}^0$ 不依赖于 $s$。那么UE平台区的标度行为是\n     $$ \\rho_{\\text{fix}}(s) \\propto \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon}. $$\n\n3. 归一化方案：\n   - 将两个模型在一个选定的参考能量 $s_{\\text{ref}}$ 处归一化到同一个平台区值，使得\n     $$ \\rho_{\\text{true}}(s_{\\text{ref}}) = \\rho_{\\text{fix}}(s_{\\text{ref}}) = \\rho_{\\text{ref}}. $$\n     在此归一化下，任意能量下的预测值之比为\n     $$ R(s) \\equiv \\frac{\\rho_{\\text{fix}}(s)}{\\rho_{\\text{true}}(s)} = \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{2\\epsilon_0}. $$\n\n4. 研究目标：\n   - 实现一个能量标度研究，其中在测试模型中保持 $p_T^0$ 固定，只有 $\\sigma_{\\text{jet}}$ 通过 $s^{\\epsilon}$ 演化。将其与上述具有能量依赖的 $p_T^0(s)$ 的真实参考模型进行比较，并量化固定 $p_T^0$ 模型在再现UE平台区随能量上升方面的失败程度。通过从差异中推断有效的 $\\epsilon_0$ 来诊断缺失的物理成分。\n\n5. 参数和测试套件：\n   - 使用以下固定参数：\n     - 部分子光度增长的幂指数：$\\epsilon = 0.32$。\n     - 软正规化的能量依赖性（真实参考模型）：$\\epsilon_0 = 0.10$。\n     - 参考质心能量：$\\sqrt{s_{\\text{ref}}} = 7.0$ TeV，所以 $s_{\\text{ref}} = (7.0)^2$ TeV$^2$。\n     - 参考平台区值：$\\rho_{\\text{ref}} = 4.0$（任意一致单位）。\n   - 测试能量（质心，单位为TeV）：$\\sqrt{s} \\in \\{0.9, 2.76, 7.0, 13.0\\}$。计算中使用 $s = (\\sqrt{s})^2$，单位为 TeV$^2$。答案中不需要其他物理单位。\n   - 失败标志的容忍度：定义为失败，如果对于任何测试能量 $s \\neq s_{\\text{ref}}$，绝对偏差 $|R(s) - 1|$ 大于或等于 $\\delta_{\\text{tol}} = 0.15$。\n\n6. 所需计算：\n   - 对于每个测试能量，计算比值\n     $$ R(s) = \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{2\\epsilon_0}. $$\n   - 根据上述规则计算一个布尔值的失败标志。\n   - 通过对所有测试能量的 $\\ln R$ 与 $\\ln(s/s_{\\text{ref}})$ 进行线性回归，从比值的能量依赖性中推断缺失的物理成分 $\\epsilon_0$。如果\n     $$ \\ln R(s) = m \\, \\ln\\left(\\frac{s}{s_{\\text{ref}}}\\right) + b, $$\n     那么推断出的软正规化的能量依赖性是\n     $$ \\epsilon_{0,\\text{inferred}} = \\frac{m}{2}. $$\n\n7. 输出规范：\n   - 你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须包含：\n     - 对应于测试能量 $\\{0.9, 2.76, 7.0, 13.0\\}$ TeV 的四个比值 $R(s)$，按顺序排列，每个值四舍五入到三位小数。\n     - 布尔值的失败标志（True 或 False）。\n     - 推断出的 $\\epsilon_{0,\\text{inferred}}$，四舍五入到三位小数。\n   - 格式示例（所示数值仅为说明）：[0.440,0.689,1.000,1.281,True,0.100]。\n\n你的任务是：实现一个完整、可运行的程序，执行上述计算并仅打印指定的单行输出。不需要用户输入。确保按规定进行数值稳定性和正确的四舍五入。",
            "solution": "该问题已经过验证，被认为是科学上合理、定义明确且客观的。它提出了一个简化但有物理动机的玩具模型，用于研究高能强子碰撞中底层事件（UE）的能量标度，这是计算高能物理中的一个标准课题。所有得出唯一解所必需的参数和定义均已提供。\n\n该问题研究了以下假设：观测到的UE随质心能量 $\\sqrt{s}$ 的上升，需要一个依赖于能量的软正规化标度 $p_T^0(s)$。这与一个更简单的、$p_T^0$ 保持固定的模型形成对比。\n\n理论框架建立在以下原则之上：\n1.  UE活动与多重部分子相互作用（MPI）的平均数 $\\langle N_{\\text{MPI}} \\rangle$ 成正比。\n2.  在程像模型中，$\\langle N_{\\text{MPI}} \\rangle \\propto \\sigma_{\\text{jet}} / \\sigma_{\\text{eff}}$，其中 $\\sigma_{\\text{eff}}$ 是一个恒定的有效强子重叠面积。\n3.  半硬射流截面 $\\sigma_{\\text{jet}}$ 具有参数依赖关系 $\\sigma_{\\text{jet}}(s; p_T^0) \\propto \\mathcal{L}(s) / (p_T^0)^2$。\n4.  在小部分子动量分数下，部分子光度 $\\mathcal{L}(s)$ 表现出幂律增长，$\\mathcal{L}(s) \\propto s^{\\epsilon}$。\n\n综合这几点，得到UE平台区密度 $\\rho_{\\text{UE}}$ 的核心关系式：\n$$\n\\rho_{\\text{UE}}(s) \\propto \\langle N_{\\text{MPI}}(s) \\rangle \\propto \\sigma_{\\text{jet}}(s; p_T^0(s)) \\propto \\frac{s^{\\epsilon}}{\\left(p_T^0(s)\\right)^2}.\n$$\n该研究比较了关于 $p_T^0(s)$ 行为的两种假设：\n\n-   **真实参考模型**：该模型假设了一个能量依赖的色屏蔽标度，这是由更高级的QCD理论所启示的。该标度随能量呈幂律形式上升：\n    $$\n    p_T^0(s) = p_{T,\\text{ref}}^0 \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon_0}.\n    $$\n    将此代入 $\\rho_{\\text{UE}}(s)$ 的比例关系，得到真实模型的标度行为：\n    $$\n    \\rho_{\\text{true}}(s) \\propto \\frac{s^{\\epsilon}}{\\left[p_{T,\\text{ref}}^0 (s/s_{\\text{ref}})^{\\epsilon_0}\\right]^2} \\propto \\frac{s^{\\epsilon}}{(s/s_{\\text{ref}})^{2\\epsilon_0}} = \\frac{(s/s_{\\text{ref}} s_{\\text{ref}})^{\\epsilon}}{(s/s_{\\text{ref}})^{2\\epsilon_0}} \\propto (s/s_{\\text{ref}})^{\\epsilon-2\\epsilon_0}.\n    $$\n-   **测试模型**：这是一个更简单、朴素的模型，假设一个固定的软正规化标度，$p_T^0(s) = p_{T,\\text{ref}}^0$。其标度行为则为：\n    $$\n    \\rho_{\\text{fix}}(s) \\propto \\frac{s^{\\epsilon}}{(p_{T,\\text{ref}}^0)^2} \\propto s^{\\epsilon} \\propto (s/s_{\\text{ref}})^{\\epsilon}.\n    $$\n\n两个模型都在一个参考能量 $s_{\\text{ref}}$ 处归一化到同一个值 $\\rho_{\\text{ref}}$。这意味着我们可以将它们写成等式：\n$$\n\\rho_{\\text{true}}(s) = \\rho_{\\text{ref}} \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon - 2\\epsilon_0}\n$$\n$$\n\\rho_{\\text{fix}}(s) = \\rho_{\\text{ref}} \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon}\n$$\n问题要求计算固定 $p_T^0$ 模型的预测与真实参考模型预测的比值 $R(s)$。该比值量化了两者之间的差异：\n$$\nR(s) = \\frac{\\rho_{\\text{fix}}(s)}{\\rho_{\\text{true}}(s)} = \\frac{\\rho_{\\text{ref}} (s/s_{\\text{ref}})^{\\epsilon}}{\\rho_{\\text{ref}} (s/s_{\\text{ref}})^{\\epsilon-2\\epsilon_0}} = \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{\\epsilon - (\\epsilon - 2\\epsilon_0)} = \\left(\\frac{s}{s_{\\text{ref}}}\\right)^{2\\epsilon_0}.\n$$\n请注意，这个 $R(s)$ 的最终表达式仅依赖于指数 $\\epsilon_0$，而与 $\\epsilon$ 和 $\\rho_{\\text{ref}}$ 无关。\n\n计算过程如下：\n\n**1. 定义参数和输入：**\n计算使用所提供的参数：\n-   屏蔽标度的能量依赖性指数：$\\epsilon_0 = 0.10$。\n-   参考质心能量：$\\sqrt{s_{\\text{ref}}} = 7.0$ TeV。因此，平方参考能量为 $s_{\\text{ref}} = (7.0)^2 = 49.0$ TeV$^2$。\n-   测试质心能量：$\\sqrt{s} \\in \\{0.9, 2.76, 7.0, 13.0\\}$ TeV。这些能量将转换为平方能量 $s_i = (\\sqrt{s_i})^2$。\n-   失败容忍度：$\\delta_{\\text{tol}} = 0.15$。\n\n**2. 计算比值 $R(s)$：**\n对于集合 $\\{0.81, 7.6176, 49.0, 169.0\\}$ TeV$^2$ 中的每个测试能量 $s$，使用推导出的公式计算比值：\n$$\nR(s_i) = \\left(\\frac{s_i}{s_{\\text{ref}}}\\right)^{2\\epsilon_0} = \\left(\\frac{s_i}{49.0}\\right)^{0.2}.\n$$\n将结果值存储起来，并在最终输出时四舍五入到三位小数。\n\n**3. 确定失败标志：**\n如果固定 $p_T^0$ 模型的预测与真实模型显著偏离，则认为该模型失败。这通过检查对于任何 $s \\neq s_{\\text{ref}}$ 的测试能量，是否满足 $|R(s) - 1| \\geq \\delta_{\\text{tol}}$ 来量化。如果至少有一个这样的能量满足此条件，则布尔标志设置为 `True`，否则为 `False`。\n\n**4. 推断缺失的物理参数 $\\epsilon_{0,\\text{inferred}}$：**\n这一步执行一个“闭包测试”，以验证比值 $R(s)$ 的能量依赖性是否可以被用来正确推断底层的物理参数 $\\epsilon_0$。我们通过取自然对数来将 $R(s)$ 的模型线性化：\n$$\n\\ln(R(s)) = \\ln\\left(\\left(\\frac{s}{s_{\\text{ref}}}\\right)^{2\\epsilon_0}\\right) = 2\\epsilon_0 \\ln\\left(\\frac{s}{s_{\\text{ref}}}\\right).\n$$\n这是一个 $y = m x + b$ 形式的线性方程，其中 $y = \\ln(R(s))$，$x = \\ln(s/s_{\\text{ref}})$，斜率为 $m = 2\\epsilon_0$，截距为 $b=0$。我们对所有测试能量 $s_i$ 的点集 $\\{(\\ln(s_i/s_{\\text{ref}}), \\ln(R(s_i)))\\}$ 进行线性回归。从拟合的斜率 $m$ 中，我们可以推断出参数 $\\epsilon_0$：\n$$\n\\epsilon_{0,\\text{inferred}} = \\frac{m}{2}.\n$$\n由于数据是从精确公式生成的，回归应能完美地恢复输入值 $\\epsilon_0=0.10$，误差仅限于数值精度。结果四舍五入到三位小数。\n\n这就完成了从所提供的物理原理和模型假设推导算法的过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a toy-model study of the energy scaling of the underlying event (UE) plateau\n    within the framework of Multiple Parton Interactions (MPI).\n    \"\"\"\n\n    # 1. Define Parameters and Inputs\n    # Fixed parameters from the problem statement\n    epsilon_0 = 0.10\n    sqrt_s_ref = 7.0  # in TeV\n    delta_tol = 0.15\n    \n    # Test energies (center-of-mass) in TeV\n    sqrt_s_values_tev = np.array([0.9, 2.76, 7.0, 13.0])\n\n    # Convert center-of-mass energies to squared energies s (in TeV^2)\n    s_ref = sqrt_s_ref**2\n    s_values = sqrt_s_values_tev**2\n\n    # 2. Compute the Ratio R(s)\n    # The ratio R(s) = (s / s_ref)^(2 * epsilon_0)\n    exponent = 2 * epsilon_0\n    r_values = (s_values / s_ref)**exponent\n\n    # 3. Determine the Failure Flag\n    failure_flag = False\n    for i in range(len(s_values)):\n        s_val = s_values[i]\n        r_val = r_values[i]\n        # Check failure condition only for energies different from the reference energy\n        if not np.isclose(s_val, s_ref):\n            if abs(r_val - 1.0) >= delta_tol:\n                failure_flag = True\n                break  # The flag is set, no need to check further\n\n    # 4. Infer the Missing Physics Parameter epsilon_0_inferred\n    # We perform a linear regression of ln(R) vs ln(s/s_ref).\n    # The model is ln(R(s)) = m * ln(s/s_ref) + b, where m = 2 * epsilon_0 and b = 0.\n    \n    # Prepare data for regression.\n    # Handle the case s = s_ref where ln(s/s_ref) would be ln(1)=0,\n    # which is numerically stable. log(0) is not an issue here.\n    x_data = np.log(s_values / s_ref)\n    y_data = np.log(r_values)\n\n    # Perform a linear fit (degree=1 polynomial) using numpy.polyfit.\n    # It returns [slope, intercept].\n    # We expect an almost perfect fit since the data is generated from the model.\n    slope, _ = np.polyfit(x_data, y_data, 1)\n\n    # Infer epsilon_0 from the slope m: epsilon_0_inferred = m / 2.\n    epsilon_0_inferred = slope / 2.0\n    \n    # 5. Format and Print the Final Output\n    # Round R values to three decimal places\n    r_values_rounded = [round(r, 3) for r in r_values]\n    \n    # Round inferred epsilon_0 to three decimal places\n    epsilon_0_inferred_rounded = round(epsilon_0_inferred, 3)\n\n    # Combine all results into a list\n    results = r_values_rounded + [failure_flag, epsilon_0_inferred_rounded]\n    \n    # Format the list into the specified string format\n    output_str = f\"[{','.join(map(str, results))}]\"\n\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}