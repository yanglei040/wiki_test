{
    "hands_on_practices": [
        {
            "introduction": "在模拟μ子系统响应时，首要步骤是理解μ子如何与探测器中的致密材料（如铁吸收体）相互作用。这决定了μ子的能量和路径，是后续精确测量的基础。本练习将引导你应用粒子物理中的标准模型——Bethe公式和多重库仑散射理论，来量化μ子穿过铁层时的平均能量损失和角向偏折，这是模拟粒子输运的核心技能。",
            "id": "3535085",
            "problem": "一个动能远大于其静止质量的高能μ子进入一个厚铁吸收体，这是对撞机探测器中μ子系统的典型配置。在校准μ子系统响应的快速模拟的背景下，确定主导径迹参数在吸收体中演化的两个主要材料相互作用效应：平均碰撞能量损失和相对于初始方向的多次库仑散射角的均方根（RMS）。考虑一个总能量为 $50\\,\\mathrm{GeV}$ 的μ子穿过厚度为 $1\\,\\mathrm{m}$ 的铁。使用以下材料和粒子性质：$\\rho = 7.87\\,\\mathrm{g/cm^3}$，$Z=26$，$A=55.85\\,\\mathrm{g/mol}$，平均激发能 $I=286\\,\\mathrm{eV}$，以及辐射长度 $X_0=1.76\\,\\mathrm{cm}$。假设μ子电荷为 $z=1$，电子静止能量为 $m_e c^2 = 0.511\\,\\mathrm{MeV}$，μ子静止能量为 $m_\\mu c^2 = 105.658\\,\\mathrm{MeV}$，常数 $K = 0.307075\\,\\mathrm{MeV\\,cm^2\\,mol^{-1}}$。忽略电离损失的壳层修正和密度效应修正，并忽略此能量下μ子的辐射损失。对于多次散射，使用适用于厚散射体的领头对数小角度近似。将平均碰撞能量损失以 $\\mathrm{GeV}$ 表示，将RMS散射角以毫弧度表示。\n\n从第一性原理和经过充分检验的高能近似出发，计算：\n- μ子在 $1\\,\\mathrm{m}$ 铁层中的平均碰撞能量损失，以及\n- 在该层中累积的RMS多次散射偏转角。\n\n将两个结果四舍五入到三位有效数字。陈述您所采用的任何标准近似。最终答案必须按顺序以两个数字给出，即以 $\\mathrm{GeV}$ 为单位的能量损失和以毫弧度为单位的角度。",
            "solution": "用户提供的问题已被验证，并被确定为高能粒子物理学中一个具有科学依据、提法恰当且客观的问题。所有必要的数据均已提供，所要求的计算是该领域的标准程序。\n\n问题要求计算描述μ子穿过铁吸收体的两个量：平均碰撞能量损失（$\\Delta E$）和多次库仑散射角的均方根（RMS）（$\\theta_{\\text{RMS}}$）。我们将使用标准模型，在指定的近似下计算这些量。\n\n**1. 平均碰撞能量损失**\n\n带电粒子穿过介质时因电离和激发而产生的平均能量损失率由 Bethe 公式给出。问题指定忽略壳层修正和密度效应修正。单位路径长度的平均能量损失 $-\\frac{dE}{dx}$ 的公式为：\n$$\n-\\frac{dE}{dx} = K z^2 \\frac{Z}{A} \\rho \\frac{1}{\\beta^2} \\left[ \\frac{1}{2}\\ln\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2 T_{\\text{max}}}{I^2}\\right) - \\beta^2 \\right]\n$$\n此处，$K$ 是一个常数，$z$ 是入射粒子的电荷数，$Z$ 和 $A$ 分别是吸收体材料的原子序数和摩尔质量，$\\rho$ 是吸收体的密度，$\\beta$ 和 $\\gamma$ 是入射粒子的相对论因子，$m_e c^2$ 是电子的静止能量，$I$ 是吸收体的平均激发能，$T_{\\text{max}}$ 是单次碰撞中可转移给电子的最大动能。\n\n首先，我们确定能量为 $50\\,\\mathrm{GeV}$ 的μ子的相对论参数。\nμ子的静止能量为 $m_\\mu c^2 = 105.658\\,\\mathrm{MeV}$。总能量为 $E = 50\\,\\mathrm{GeV} = 50000\\,\\mathrm{MeV}$。\n洛伦兹因子 $\\gamma$ 为：\n$$\n\\gamma = \\frac{E}{m_\\mu c^2} = \\frac{50000\\,\\mathrm{MeV}}{105.658\\,\\mathrm{MeV}} \\approx 473.25\n$$\n相对论速度 $\\beta$ 由 $\\beta = \\sqrt{1 - 1/\\gamma^2}$ 给出。对于如此大的 $\\gamma$，$\\beta$ 极度接近 1：\n$$\n\\beta = \\sqrt{1 - \\frac{1}{(473.25)^2}} \\approx 0.99999778\n$$\n因此，我们可以使用近似 $\\beta \\approx 1$。\n\n接下来，我们计算μ子（质量为 $m_\\mu$）与电子（质量为 $m_e$）散射时的 $T_{\\text{max}}$：\n$$\nT_{\\text{max}} = \\frac{2 m_e c^2 \\beta^2 \\gamma^2}{1 + 2\\gamma \\frac{m_e}{m_\\mu} + \\left(\\frac{m_e}{m_\\mu}\\right)^2}\n$$\n电子与μ子的质量比为 $\\frac{m_e}{m_\\mu} = \\frac{0.511\\,\\mathrm{MeV}}{105.658\\,\\mathrm{MeV}} \\approx 0.004836$。\n$$\nT_{\\text{max}} \\approx \\frac{2(0.511\\,\\mathrm{MeV})(1)^2(473.25)^2}{1 + 2(473.25)(0.004836) + (0.004836)^2} \\approx \\frac{228890}{1 + 4.580 + 2.34 \\times 10^{-5}} \\approx \\frac{228890}{5.580} \\approx 41019.7\\,\\mathrm{MeV}\n$$\n\n现在我们将所有值代入 Bethe 公式。\n给定值：\n- $K = 0.307075\\,\\mathrm{MeV\\,cm^2\\,mol^{-1}}$\n- $z = 1$ (对于μ子)\n- $Z = 26$ (对于铁)\n- $A = 55.85\\,\\mathrm{g/mol}$ (对于铁)\n- $\\rho = 7.87\\,\\mathrm{g/cm^3}$ (对于铁)\n- $I = 286\\,\\mathrm{eV} = 2.86 \\times 10^{-4}\\,\\mathrm{MeV}$\n\n阻止本领为：\n$$\n-\\frac{dE}{dx} = (0.307075)(1)^2 \\frac{26}{55.85} (7.87) \\frac{1}{1^2} \\left[ \\frac{1}{2}\\ln\\left(\\frac{2(0.511)(1)^2(473.25)^2(41019.7)}{(2.86 \\times 10^{-4})^2}\\right) - 1^2 \\right]\n$$\n$$\n-\\frac{dE}{dx} \\approx 1.1245 \\left[ \\frac{1}{2}\\ln\\left(\\frac{9.388 \\times 10^9}{8.1796 \\times 10^{-8}}\\right) - 1 \\right] \\,\\frac{\\mathrm{MeV}}{\\mathrm{cm}}\n$$\n$$\n-\\frac{dE}{dx} \\approx 1.1245 \\left[ \\frac{1}{2}\\ln(1.1477 \\times 10^{17}) - 1 \\right] \\,\\frac{\\mathrm{MeV}}{\\mathrm{cm}}\n$$\n$$\n-\\frac{dE}{dx} \\approx 1.1245 \\left[ \\frac{1}{2}(39.28) - 1 \\right] = 1.1245 [19.64 - 1] = 1.1245 \\times 18.64 \\approx 20.96\\,\\frac{\\mathrm{MeV}}{\\mathrm{cm}}\n$$\n在厚度 $x = 1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$ 上的总能量损失 $\\Delta E$ 是通过假设 $-\\frac{dE}{dx}$ 是一个常数来求得的，这是一个合理的近似，因为总能量损失（$ \\approx 2.1\\,\\mathrm{GeV}$）与初始能量（$50\\,\\mathrm{GeV}$）相比很小。\n$$\n\\Delta E = \\left(-\\frac{dE}{dx}\\right) \\times x = 20.96\\,\\frac{\\mathrm{MeV}}{\\mathrm{cm}} \\times 100\\,\\mathrm{cm} = 2096\\,\\mathrm{MeV} = 2.096\\,\\mathrm{GeV}\n$$\n四舍五入到三位有效数字，平均碰撞能量损失为 $2.10\\,\\mathrm{GeV}$。\n\n**2. 多次库仑散射角的均方根**\n\n对于厚吸收体，多次库仑散射的投影角的均方根 $\\theta_0$ 可以使用 Highland 公式进行近似，该公式由粒子数据组（Particle Data Group, PDG）给出：\n$$\n\\theta_0 = \\theta_{\\text{plane, RMS}} = \\frac{13.6\\,\\mathrm{MeV}}{\\beta c p} z \\sqrt{\\frac{x}{X_0}} \\left[ 1 + 0.038 \\ln\\left(\\frac{x}{X_0}\\right) \\right]\n$$\n该公式给出了投影角分布中心高斯部分的RMS宽度。我们将问题所要求的“多次库仑散射角的均方根”解释为这个标准参数 $\\theta_0$。\n\n我们使用μ子的初始动量。对于超相对论性粒子，$pc \\approx E$。\n- $pc \\approx 50\\,\\mathrm{GeV} = 50000\\,\\mathrm{MeV}$\n- $\\beta \\approx 1$\n- $z = 1$\n- $x = 1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$\n- $X_0 = 1.76\\,\\mathrm{cm}$ (铁的辐射长度)\n\n首先，我们以辐射长度为单位计算厚度：\n$$\n\\frac{x}{X_0} = \\frac{100\\,\\mathrm{cm}}{1.76\\,\\mathrm{cm}} \\approx 56.818\n$$\n由于 $x/X_0 \\gg 1$，厚吸收体近似是有效的。接下来，我们计算对数修正项：\n$$\n1 + 0.038 \\ln\\left(\\frac{x}{X_0}\\right) = 1 + 0.038 \\ln(56.818) \\approx 1 + 0.038 (4.040) \\approx 1 + 0.1535 = 1.1535\n$$\n现在我们将所有部分组合起来求 $\\theta_0$：\n$$\n\\theta_0 = \\frac{13.6\\,\\mathrm{MeV}}{50000\\,\\mathrm{MeV}} (1) \\sqrt{56.818} [1.1535]\n$$\n$$\n\\theta_0 = (2.72 \\times 10^{-4}) (7.538) [1.1535] \\approx 0.002364\\,\\text{radians}\n$$\n问题要求答案以毫弧度（mrad）为单位。\n$$\n\\theta_{\\text{RMS}} = 0.002364\\,\\text{rad} \\times 1000\\,\\frac{\\mathrm{mrad}}{\\mathrm{rad}} = 2.364\\,\\mathrm{mrad}\n$$\n四舍五入到三位有效数字，RMS散射角为 $2.36\\,\\mathrm{mrad}$。\n\n所要求的两个值是：以 $\\mathrm{GeV}$ 为单位的平均碰撞能量损失和以 $\\mathrm{mrad}$ 为单位的RMS散射角。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.10  2.36 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当μ子穿过气体探测器时，它会产生一团电子云，这些电子在电场中向阳极丝漂移。这个漂移过程中的随机热运动，即扩散效应，从根本上限制了我们测量μ子径迹位置的精度。本练习旨在从第一性原理出发，推导电子云的横向扩散宽度与漂移距离的关系，并将基础物理量与探测器模拟中常用的唯象参数联系起来，从而深化对探测器空间分辨率物理极限的理解。",
            "id": "3535035",
            "problem": "考虑一个μ子穿过高能物理μ子系统中的气体径迹探测单元，产生一个在均匀电场下漂移的电子云。假设电子输运处于热学机制，因此爱因斯坦关系式成立，即 $D=\\mu k_{B} T / e$，其中 $D$ 是扩散系数，$\\mu$ 是迁移率，$k_{B}$ 是玻尔兹曼常数，$T$ 是温度，$e$ 是元电荷。电子以恒定的漂移速度 $v_{d}$ 沿长度为 $L$ 的直线路径漂移，其横向展宽完全由扩散引起。忽略空间电荷、磁场以及任何非热效应。\n\n从扩散方程和恒定电场下漂移的定义出发，根据第一性原理推导漂移电子云的均方根 (RMS) 横向宽度 $\\sigma_{T}$ 作为漂移时间 $t$ 和扩散系数 $D$ 的函数，然后仅用 $L$ 和一个列表给出的横向扩散参数 $D_{T}$ 来表示 $\\sigma_{T}$。该参数 $D_{T}$ 的定义使得横向均方根宽度与漂移长度的平方根成正比。最后，使用列表值 $D_{T} = 200~\\mu\\mathrm{m}/\\sqrt{\\mathrm{cm}}$ 和漂移长度 $L = 2~\\mathrm{cm}$，计算横向均方根宽度的数值。\n\n最终宽度以微米为单位表示，并四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "用户要求我解决一个关于气体探测器中电子漂移和扩散的问题。我需要首先验证该问题，如果问题有效，则提供详细的解决方案。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **系统：** 一个μ子在气体径迹探测单元中产生一个电子云。\n*   **物理模型：** 电子云在均匀电场下于热学机制中漂移。\n*   **控制关系：** 爱因斯坦关系式成立：$D=\\mu k_{B} T / e$。\n*   **定义：**\n    *   $D$：扩散系数。\n    *   $\\mu$：电子迁移率。\n    *   $k_{B}$：玻尔兹曼常数。\n    *   $T$：气体温度。\n    *   $e$：元电荷。\n*   **条件：**\n    *   漂移速度 $v_{d}$ 是恒定的。\n    *   漂移路径是长度为 $L$ 的直线。\n    *   横向展宽仅由扩散引起。\n    *   空间电荷、磁场和非热效应被忽略。\n*   **任务1：** 推导均方根 (RMS) 横向宽度 $\\sigma_{T}$ 作为漂移时间 $t$ 和扩散系数 $D$ 的函数。\n*   **任务2：** 用 $L$ 和一个列表给出的横向扩散参数 $D_{T}$ 来表示 $\\sigma_{T}$，该参数的定义使得 $\\sigma_T \\propto \\sqrt{L}$。\n*   **任务3 (数值计算):**\n    *   列表值：$D_{T} = 200~\\mu\\mathrm{m}/\\sqrt{\\mathrm{cm}}$。\n    *   漂移长度：$L = 2~\\mathrm{cm}$。\n    *   计算 $\\sigma_{T}$ 的数值。\n*   **输出格式：** 最终宽度以微米表示，并四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题坚实地基于气体中电子输运的标准模型，这是粒子探测器物理学中的一个基本课题。漂移-扩散方程、爱因斯坦关系式以及漂移速度和扩散系数的概念都是标准的、科学正确的。给定的数值对于典型的漂移室气体是符合实际的。\n*   **适定性：** 该问题是适定的。它要求从第一性原理进行推导，然后进行计算。问题隐含假设了初始条件（点状电荷云），这在此类问题中是标准做法。参数 $D_{T}$ 的定义是函数式给出的，这足以满足其使用需求。存在唯一、稳定且有意义的解。\n*   **客观性：** 该问题以精确、客观的语言陈述，不含任何主观或基于观点的内容。\n\n**缺陷清单：**\n\n1.  **科学或事实不准确：** 无。所涉及的物理学是标准且正确的。\n2.  **不可形式化或不相关：** 无。该问题是一个可形式化的物理问题，与μ子系统响应的模拟直接相关。\n3.  **不完整或矛盾的设置：** 无。问题为推导和计算提供了所有必要信息。基本扩散系数 $D$ 与唯象参数 $D_T$ 之间的关系可以从问题陈述中推导出来。\n4.  **不切实际或不可行：** 无。物理场景和所提供的数值都是现实的。\n5.  **不适定或结构不良：** 无。问题结构逻辑清晰，从理论推导引导到实际应用。\n6.  **故作高深、微不足道或同义反复：** 无。该问题需要从一个偏微分方程进行标准的但非平凡的推导。\n7.  **超出科学可验证范围：** 无。该模型是探测器物理学的基石，并且是可以通过实验验证的。\n\n**第3步：结论与行动**\n\n问题有效。我将继续进行解答。\n\n### 解答\n\n电子云数密度 $n(\\mathbf{r}, t)$ 的演化由漂移-扩散方程描述。在没有源或汇的情况下，这是一个连续性方程 $\\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0$，其中电流密度 $\\mathbf{J}$ 由漂移项和扩散项（菲克定律）之和给出：$\\mathbf{J} = \\mathbf{v}_d n - D \\nabla n$。我们假设漂移沿 $z$ 轴方向，因此漂移速度矢量为 $\\mathbf{v}_d = (0, 0, v_d)$。根据“热学机制”条件的暗示，扩散被假定为各向同性的，系数为 $D$。因此，漂移-扩散方程为：\n$$\n\\frac{\\partial n}{\\partial t} + v_d \\frac{\\partial n}{\\partial z} = D \\nabla^2 n = D \\left( \\frac{\\partial^2 n}{\\partial x^2} + \\frac{\\partial^2 n}{\\partial y^2} + \\frac{\\partial^2 n}{\\partial z^2} \\right)\n$$\n我们考虑在时间 $t=0$ 时刻原点处发生的一次电离事件，这可以建模为狄拉克δ函数初始条件：$n(\\mathbf{r}, 0) = \\delta(\\mathbf{r}) = \\delta(x)\\delta(y)\\delta(z)$。对于此初始条件，漂移-扩散方程的解是一个漂移的高斯函数：\n$$\nn(x, y, z, t) = \\frac{1}{(4\\pi D t)^{3/2}} \\exp\\left( -\\frac{x^2 + y^2 + (z-v_d t)^2}{4Dt} \\right)\n$$\n该函数表示在时间 $t$、位置 $(x, y, z)$ 找到一个电子的概率密度。\n\n为了找到横向展宽，我们考虑其中一个横向维度（例如 $x$）的分布。我们通过对 $n(x, y, z, t)$ 在其他坐标 $y$ 和 $z$ 上积分来获得边际概率密度 $P(x, t)$：\n$$\nP(x, t) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} n(x, y, z, t) \\,dy \\,dz\n$$\n代入 $n$ 的表达式：\n$$\nP(x, t) = \\frac{1}{(4\\pi D t)^{3/2}} \\exp\\left(-\\frac{x^2}{4Dt}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{y^2}{4Dt}\\right) \\,dy \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(z-v_d t)^2}{4Dt}\\right) \\,dz\n$$\n这些积分是标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$。\n对 $y$ 的积分得到 $\\sqrt{4\\pi D t}$。对 $z$ 的积分也得到 $\\sqrt{4\\pi D t}$。\n将这些结果代回 $P(x,t)$ 的表达式中：\n$$\nP(x, t) = \\frac{1}{(4\\pi D t)^{3/2}} \\exp\\left(-\\frac{x^2}{4Dt}\\right) (\\sqrt{4\\pi D t}) (\\sqrt{4\\pi D t}) = \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{x^2}{4Dt}\\right)\n$$\n这是一个关于位置 $x$ 的一维高斯分布，形式为 $P(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$，其均值 $\\mu = 0$，方差为 $\\sigma^2$。通过比较两种形式，我们可以确定横向分布的方差 $\\sigma_T^2$：\n$$\n2\\sigma_T^2 = 4Dt \\implies \\sigma_T^2 = 2Dt\n$$\n均方根 (RMS) 横向宽度即标准差 $\\sigma_T$。这完成了推导的第一部分：\n$$\n\\sigma_T(t, D) = \\sqrt{2Dt}\n$$\n对于第二部分，我们需要用漂移长度 $L$ 和列表参数 $D_T$ 来表示 $\\sigma_T$。漂移长度 $L$ 是在时间 $t$ 内以恒定漂移速度 $v_d$ 行进的距离，所以 $L = v_d t$，这意味着 $t = L/v_d$。将此代入我们的 $\\sigma_T$ 表达式中：\n$$\n\\sigma_T = \\sqrt{2D \\left(\\frac{L}{v_d}\\right)} = \\left(\\sqrt{\\frac{2D}{v_d}}\\right) \\sqrt{L}\n$$\n这个方程表明，横向均方根宽度 $\\sigma_T$ 与漂移长度 $L$ 的平方根成正比。问题将列表给出的横向扩散参数（我们在此记为 $D_{T, \\text{tab}}$）定义为该关系中的比例常数。因此，我们有定义关系式：\n$$\n\\sigma_T = D_{T, \\text{tab}} \\sqrt{L}\n$$\n通过比较 $\\sigma_T$ 的两个表达式，我们可以将基本扩散系数 $D$ 与列表参数 $D_{T, \\text{tab}}$ 关联起来，即 $D_{T, \\text{tab}} = \\sqrt{2D/v_d}$。问题要求仅用 $L$ 和这个列表参数来表示 $\\sigma_T$，即方程 $\\sigma_T = D_{T, \\text{tab}} \\sqrt{L}$。在解题的剩余部分，我们将使用 $D_T$ 来代表这个列表值。\n\n最后，我们使用给定的数据计算横向均方根宽度的数值：\n$D_{T} = 200~\\mu\\mathrm{m}/\\sqrt{\\mathrm{cm}}$ 且 $L = 2~\\mathrm{cm}$。\n$$\n\\sigma_T = \\left(200~\\frac{\\mu\\mathrm{m}}{\\sqrt{\\mathrm{cm}}}\\right) \\times \\sqrt{2~\\mathrm{cm}}\n$$\n$$\n\\sigma_T = 200 \\times \\sqrt{2} ~\\mu\\mathrm{m}\n$$\n使用 $\\sqrt{2} \\approx 1.41421356$，我们得到：\n$$\n\\sigma_T \\approx 200 \\times 1.41421356 ~\\mu\\mathrm{m} \\approx 282.842712 ~\\mu\\mathrm{m}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\sigma_T \\approx 282.8 ~\\mu\\mathrm{m}\n$$\n最终答案是以微米表示的数值。",
            "answer": "$$\n\\boxed{282.8}\n$$"
        },
        {
            "introduction": "漂移室等气体探测器直接测量的是电子漂移到阳极丝所需的时间，而非径迹的位置。为了将测量到的时间信息转化为精确的空间坐标，必须首先标定出描述半径和时间对应关系的“空间-时间关系”曲线（$r(t)$）。本综合练习是一个计算实践，要求你从概率守恒的基本原理出发推导$r(t)$的重建方法，并编写程序从给定的时间谱数据中实际计算出这一关键的标定曲线，最终完成一个解码任务。",
            "id": "3535020",
            "problem": "设计并实现一个完整的、可运行的程序，该程序从时间谱中重建圆柱形漂移室（Drift Chamber, DC）的时空标定曲线，并用它来解码一个隐藏信息，该信息被编码为在指定探测时间的阈值化半径。该场景模拟一个半径为 $R$、最大漂移时间为 $t_{\\max}$ 的单个漂移室单元，径迹均匀地照射在单元的横截面上。漂移时间分布以直方图的形式给出。从第一性原理出发，从概率密度的定义以及在单调漂移函数下半径和漂移时间之间的映射关系开始。您可以假定以下基础物理原理：对于半径为 $R$ 的圆形单元中的均匀照射，均匀随机径迹穿越的径向概率密度与同心圆的周长成正比，并且映射 $r(t)$ 是单调的；漂移时间的直方图与时域概率密度成正比。您必须推导出能够从测量的时间谱中恢复 $r(t)$ 的关系式，然后实现一个对有限分箱直方图有效的离散估计器。仅使用所提供的时间谱，并且除了从基本原理推导出的关系外，不要假定任何 $r(t)$ 的闭合形式。单位：时间以纳秒 (ns) 表示，半径以毫米 (mm) 表示。角度不出现。您的最终数值输出包含解码后的 American Standard Code for Information Interchange (ASCII) 码，以无单位整数的形式表示。\n\n隐藏信息编码规则。每个测试用例都提供一个探测时间列表 $\\{t_i\\}$。对于每个 $t_i$，计算重建的半径 $r(t_i)$（单位为毫米），并将其与阈值半径 $r_{\\mathrm{thr}} = \\beta R$（其中 $\\beta = 0.6$）进行比较。如果 $r(t_i) > r_{\\mathrm{thr}}$，记录比特 $1$，否则记录比特 $0$。比特按时间顺序以 $7$ 个为一组进行分组，并按大端序（块中的第一个比特是最高有效位）解释为 $7$ 位 ASCII 码。最终输出是所有测试用例解码出的所有 ASCII 码按顺序连接而成的列表。\n\n离散重建要求。您必须推导一个仅使用直方图分箱计数的重建方法。设直方图有 $N$ 个等宽的分箱，覆盖区间 $[0,t_{\\max}]$，其计数为 $\\{c_j\\}_{j=0}^{N-1}$。将直方图视为漂移时间概率密度的分段常数估计器。对于任何 $t \\in [0,t_{\\max}]$，通过累加直到包含 $t$ 的分箱的所有完整分箱的概率，并假定该分箱内的密度恒定，加上该分箱内的部分贡献，来计算累积分布函数 $F(t)$。然后使用您推导出的关系将 $F(t)$ 转换为 $r(t)$。所有作为数学实体的中间量必须在您的推导中符号化，但您的程序应实现离散估计器。\n\n测试套件。为以下三个合成案例实现您的程序。在每个案例中，直方图计数 $\\{c_j\\}$ 都是由已知的单项式概率密度生成的，以确保科学真实性并提供覆盖范围。然而，您必须从直方图本身重建 $r(t)$，而不是从生成函数。直方图有 $N$ 个等宽的分箱，覆盖 $[0,t_{\\max}]$。分箱计数由单项式在分箱边界之间的精确积分给出，因此\n$$\nc_j \\propto \\int_{j/N}^{(j+1)/N} x^k\\,dx = \\frac{(j+1)^{k+1} - j^{k+1}}{N^{k+1}(k+1)} \\quad \\text{for } j \\in \\{0,\\dots,N-1\\},\n$$\n选择的比例系数使得整数计数为\n$$\nc_j = (j+1)^{k+1} - j^{k+1} \\quad \\text{for } j \\in \\{0,\\dots,N-1\\}.\n$$\n您必须在代码中对这些计数进行归一化，以获得在 $[0,t_{\\max}]$ 上的概率密度。\n\n- 案例 A（类边界，平坦时间谱）：\n  - 单元半径 $R = 15.0$ mm。\n  - 最大漂移时间 $t_{\\max} = 400$ ns。\n  - 分箱数量 $N = 32$。\n  - 单项式指数 $k = 0$。\n  - 阈值分数 $\\beta = 0.6$（因此 $r_{\\mathrm{thr}} = 0.6 R$）。\n  - 探测时间 $\\{t_i\\}$，单位 ns（顺序很重要）：$[360,120,120,360,360,120,360,360,120,360,120,360,120,360,360,120,120,360,360,360,360]$。\n\n- 案例 B（理想情况，线性 $r(t)$）：\n  - $R = 12.0$ mm。\n  - $t_{\\max} = 320$ ns。\n  - $N = 32$。\n  - $k = 1$。\n  - $\\beta = 0.6$。\n  - 探测时间 (ns)：$[288,96,96,288,288,288,96,288,96,288,96,96,288,288]$。\n\n- 案例 C（急剧上升的时间谱）：\n  - $R = 20.0$ mm。\n  - $t_{\\max} = 500$ ns。\n  - $N = 32$。\n  - $k = 2$。\n  - $\\beta = 0.6$。\n  - 探测时间 (ns)：$[450,150,450,150,150,450,450,450,150,450,450,150,150,450,450,150,450,150,150,450,450]$。\n\n您的程序必须做什么：\n- 从第一性原理出发，推导出一个在均匀照射和单调 $r(t)$ 条件下从测量的时间谱重建 $r(t)$ 的有效关系式。\n- 仅使用 $\\{c_j\\}$, $N$, 和 $t_{\\max}$ 实现一个离散估计器，以计算在 $[0,t_{\\max}]$ 内任意时间 $t$ 的 $F(t)$，并由此计算 $r(t)$（单位为毫米）。\n- 对于每个测试用例，使用 $r(t_i)$ 和 $r_{\\mathrm{thr}}$ 计算在所提供的探测时间的比特，按时间顺序将比特分为 $7$ 位的块，将每个块转换为一个 $7$ 位 ASCII 码（大端序），并将整数码附加到结果列表中。\n- 最终输出格式：您的程序应生成单行文本，其中包含所有案例的解码 ASCII 码连接而成的逗号分隔列表，并用方括号括起来，例如 $[a_1,a_2,\\dots,a_M]$，其中每个 $a_m$ 是一个整数。\n- 程序必须是自包含的，不需要用户输入。所有数值计算都必须遵守规定的单位：时间单位为 ns，半径单位为 mm，最终解码输出是无单位的整数。",
            "solution": "问题要求重建圆柱形漂移室单元的时空关系 $r(t)$，并应用它来解码一个隐藏信息。重建必须从第一性原理推导，并实现为一个作用于漂移时间直方图的离散估计器。\n\n**1. 时空关系的推导**\n\n问题的核心是找到给出漂移半径 $r$ 作为漂移时间 $t$ 的函数的关系式 $r(t)$。这可以通过关联半径和时间的概率分布来推导。\n\n首先，我们建立径迹半径的概率密度函数 (PDF) $p_r(r)$。问题陈述，漂移室受到均匀的径迹照射。对于半径为 $R$ 的圆形单元，这意味着径迹穿过任何面元 $dA$ 的概率是恒定的。径迹在半径 $r$ 和 $r+dr$ 之间通过的概率与相应环带的面积 $dA = 2\\pi r dr$ 成正比。因此，PDF $p_r(r)$ 与 $r$ 成正比：\n$$\np_r(r) = C \\cdot r\n$$\n其中 $C$ 是归一化常数。为了求出 $C$，我们强制要求在单元半径范围（从 $0$ 到 $R$）上的总概率为1：\n$$\n\\int_0^R p_r(r) \\, dr = \\int_0^R C \\cdot r \\, dr = 1\n$$\n$$\nC \\left[ \\frac{r^2}{2} \\right]_0^R = C \\frac{R^2}{2} = 1 \\implies C = \\frac{2}{R^2}\n$$\n所以，归一化后的半径 PDF 为：\n$$\np_r(r) = \\frac{2r}{R^2}, \\quad \\text{for } r \\in [0, R]\n$$\n\n接下来，我们将 $p_r(r)$ 与漂移时间的 PDF $p_t(t)$ 联系起来。给定一个单调、可微的关系 $r=r(t)$，概率守恒原理表明 $p_r(r)|dr| = p_t(t)|dt|$。这使我们能够将一个密度转换为另一个密度：\n$$\np_t(t) = p_r(r(t)) \\left| \\frac{dr}{dt} \\right|\n$$\n问题指明 $r(t)$ 是单调的。由于 $r(0)=0$ （中心径迹的漂移时间为零）且 $r(t_{\\max})=R$，$r(t)$ 是一个非递减函数，因此 $dr/dt \\ge 0$。我们可以因此去掉绝对值符号。代入 $p_r(r)$ 的表达式：\n$$\np_t(t) = \\frac{2r(t)}{R^2} \\frac{dr}{dt}\n$$\n这个表达式可以方便地使用链式法则重写，注意到 $\\frac{d}{dt}[r(t)]^2 = 2r(t) \\frac{dr}{dt}$：\n$$\np_t(t) = \\frac{1}{R^2} \\frac{d}{dt}[r(t)]^2\n$$\n为了解出 $r(t)$，我们将两边对时间从 $0$ 积分到一个任意时间 $t'$：\n$$\n\\int_0^{t'} p_t(t) \\, dt = \\int_0^{t'} \\frac{1}{R^2} \\frac{d}{dt}[r(t)]^2 \\, dt\n$$\n左边根据定义是漂移时间的累积分布函数 (CDF)，$F_t(t') = \\int_0^{t'} p_t(t) \\, dt$。右边使用微积分基本定理进行计算：\n$$\nF_t(t') = \\frac{1}{R^2} \\left( [r(t')]^2 - [r(0)]^2 \\right)\n$$\n根据物理边界条件，中心处的径迹漂移时间为零，即 $r(0)=0$。这将方程简化为：\n$$\nF_t(t') = \\frac{[r(t')]^2}{R^2}\n$$\n将 $t'$ 替换为通用变量 $t$ 并求解 $r(t)$，得到所需的时空关系：\n$$\nr(t) = R \\sqrt{F_t(t)}\n$$\n这个基本结果表明，如果知道了直到时间 $t$ 的漂移时间的累积概率，就可以求出任何时间 $t$ 的漂移半径。\n\n**2. 从直方图得到的 $r(t)$ 的离散估计器**\n\n问题以直方图的形式提供了时间谱，该直方图在区间 $[0, t_{\\max}]$ 上有 $N$ 个分箱和计数 $\\{c_j\\}_{j=0}^{N-1}$。我们必须基于这些数据构建一个 $r(t)$ 的离散估计器。\n\n直方图被视为 PDF $p_t(t)$ 的分段常数近似。每个分箱的宽度为 $\\Delta t = t_{\\max} / N$。漂移时间落入分箱 $j$ 的概率是 $P_j = c_j / C_{\\text{total}}$，其中 $C_{\\text{total}} = \\sum_{k=0}^{N-1} c_k$ 是总事件数。在分箱 $j$ 内（对于 $t \\in [j\\Delta t, (j+1)\\Delta t)$），恒定的 PDF 值为 $p_j = P_j / \\Delta t = c_j / (C_{\\text{total}} \\cdot \\Delta t)$。\n\n为了找到 $r(t)$，我们首先需要计算 CDF, $F_t(t) = \\int_0^t p_t(\\tau) \\, d\\tau$。对于给定的探测时间 $t$，我们找到它的分箱索引 $m = \\lfloor t / \\Delta t \\rfloor$。CDF 通过对直到 $m-1$ 的所有完整分箱的概率求和，并加上来自第 $m$ 个分箱内的部分概率来计算：\n$$\nF_t(t) = \\sum_{j=0}^{m-1} P_j + \\int_{m\\Delta t}^{t} p_m \\, d\\tau = \\sum_{j=0}^{m-1} \\frac{c_j}{C_{\\text{total}}} + \\frac{c_m}{C_{\\text{total}}\\Delta t} (t - m\\Delta t)\n$$\n这可以纯粹用计数和时间分数来表示：\n$$\nF_t(t) = \\frac{1}{C_{\\text{total}}} \\left( \\sum_{j=0}^{m-1} c_j + c_m \\frac{t - m\\Delta t}{\\Delta t} \\right)\n$$\n这个离散公式允许我们估计任何 $t \\in [0, t_{\\max}]$ 的 $F_t(t)$。将其代入我们推导出的时空关系，得到重建半径的实用公式：\n$$\nr(t) = R \\sqrt{\\frac{1}{C_{\\text{total}}} \\left( \\sum_{j=0}^{m-1} c_j + c_m \\frac{t - m\\Delta t}{\\Delta t} \\right)}\n$$\n\n**3. 信息解码算法**\n\n任务的最后一部分是使用这种重建方法解码信息。算法如下：\n1.  对于每个测试用例，获取参数：单元半径 $R$、最大漂移时间 $t_{\\max}$、分箱数 $N$、单项式指数 $k$ 以及探测时间列表 $\\{t_i\\}$。\n2.  使用提供的公式生成直方图分箱计数：$c_j = (j+1)^{k+1} - j^{k+1}$，其中 $j=0, \\dots, N-1$。\n3.  计算阈值半径 $r_{\\mathrm{thr}} = \\beta R = 0.6R$。\n4.  初始化一个空比特串。按时间顺序对每个探测时间 $t_i$：\n    a. 使用上面推导的离散估计器计算重建半径 $r(t_i)$。\n    b. 将半径与阈值进行比较：如果 $r(t_i) > r_{\\mathrm{thr}}$，追加比特 '1'；否则，追加比特 '0'。\n5.  将得到的比特串分成 $7$ 位的块。\n6.  将每个 $7$ 位块解释为大端序二进制数，并将其转换为其整数 ASCII 码。\n7.  将所有测试用例中解码出的所有 ASCII 码收集到一个连接起来的列表中。\n\n这个过程，从第一性原理推导到数值实现，为该问题提供了一个完整的解决方案。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the drift chamber decoding problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"R\": 15.0, \"t_max\": 400.0, \"N\": 32, \"k\": 0, \"beta\": 0.6,\n            \"probe_times\": [360, 120, 120, 360, 360, 120, 360, 360, 120, 360, 120, 360, 120, 360, 360, 120, 120, 360, 360, 360, 360]\n        },\n        {\n            \"R\": 12.0, \"t_max\": 320.0, \"N\": 32, \"k\": 1, \"beta\": 0.6,\n            \"probe_times\": [288, 96, 96, 288, 288, 288, 96, 288, 96, 288, 96, 96, 288, 288]\n        },\n        {\n            \"R\": 20.0, \"t_max\": 500.0, \"N\": 32, \"k\": 2, \"beta\": 0.6,\n            \"probe_times\": [450, 150, 450, 150, 150, 450, 450, 450, 150, 450, 450, 150, 150, 450, 450, 150, 450, 150, 150, 450, 450]\n        }\n    ]\n\n    all_decoded_codes = []\n\n    for case in test_cases:\n        decoded_codes = process_case(case)\n        all_decoded_codes.extend(decoded_codes)\n\n    print(f\"[{','.join(map(str, all_decoded_codes))}]\")\n\ndef process_case(case_params):\n    \"\"\"\n    Processes a single test case: reconstructs radii, decodes bits, and returns ASCII codes.\n    \"\"\"\n    R = case_params[\"R\"]\n    t_max = case_params[\"t_max\"]\n    N = case_params[\"N\"]\n    k = case_params[\"k\"]\n    beta = case_params[\"beta\"]\n    probe_times = case_params[\"probe_times\"]\n    \n    r_thr = beta * R\n    \n    # Generate histogram counts. Using Python's arbitrary precision integers is safe.\n    counts = np.array([(j + 1)**(k + 1) - j**(k + 1) for j in range(N)], dtype=np.int64)\n    total_counts = np.sum(counts)\n    \n    # Pre-calculate cumulative counts for efficiency\n    cum_counts = np.cumsum(counts)\n\n    bit_string = \"\"\n    for t in probe_times:\n        r_t = reconstruct_radius(t, R, t_max, N, counts, total_counts, cum_counts)\n        if r_t > r_thr:\n            bit_string += \"1\"\n        else:\n            bit_string += \"0\"\n            \n    decoded_codes = []\n    num_bits = 7\n    for i in range(0, len(bit_string), num_bits):\n        bit_block = bit_string[i:i+num_bits]\n        if len(bit_block) == num_bits:\n            # Big-endian interpretation is default for int(..., 2)\n            decoded_codes.append(int(bit_block, 2))\n            \n    return decoded_codes\n\ndef reconstruct_radius(t, R, t_max, N, counts, total_counts, cum_counts):\n    \"\"\"\n    Reconstructs the radius r(t) for a given time t using the discrete estimator.\n    \n    Args:\n        t (float): The probe time in ns.\n        R (float): The cell radius in mm.\n        t_max (float): The maximum drift time in ns.\n        N (int): The number of histogram bins.\n        counts (np.ndarray): Array of histogram bin counts.\n        total_counts (int): The sum of all counts.\n        cum_counts (np.ndarray): The cumulative sum of counts.\n\n    Returns:\n        float: The reconstructed radius in mm.\n    \"\"\"\n    if t >= t_max:\n        return R\n    if t = 0:\n        return 0.0\n\n    dt = t_max / N\n    \n    # Find bin index for time t\n    bin_idx = math.floor(t / dt)\n    if bin_idx >= N: # Handle case where t is exactly t_max\n        bin_idx = N - 1\n\n    # Sum of counts in bins before the current one\n    sum_prev_bins = cum_counts[bin_idx-1] if bin_idx > 0 else 0\n    \n    # Fractional contribution from the current bin\n    time_in_bin = t - bin_idx * dt\n    frac_in_bin = time_in_bin / dt\n    \n    # Calculate the Cumulative Distribution Function (CDF) F(t)\n    F_t = (sum_prev_bins + counts[bin_idx] * frac_in_bin) / total_counts\n    \n    # The derived relation is r(t) = R * sqrt(F(t))\n    # Handle potential floating point inaccuracies leading to F_t  0\n    if F_t  0:\n        F_t = 0\n        \n    r = R * math.sqrt(F_t)\n    \n    return r\n\nsolve()\n```"
        }
    ]
}