{
    "hands_on_practices": [
        {
            "introduction": "在精确测量粒子能量时，一个稳定且已知的基线是至关重要的。然而，探测器信号常常伴随着缓慢的基线漂移，必须通过数字信号处理技术进行校正。本练习  旨在通过分析两种常用的基线恢复方法——逐事件基座减除和数字高通滤波——来揭示它们在存在线性基线漂移时如何引入幅度估计的系统偏差。理解这些偏差的来源和性质，对于在高精度测量中进行误差预算和选择最佳处理算法至关重要。",
            "id": "3511781",
            "problem": "高能物理量能器中的一个数字化通道在离散时间上被建模为一个模板形状的脉冲、一个缓慢变化的基线和一个零均值电子噪声的叠加组合。设采样信号为 $x[n] = A\\,h[n] + b_0 + s\\,n + w[n]$，其中 $n \\in \\mathbb{Z}$ 是采样点索引，$A$ 是真实脉冲幅度，$h[n]$ 是一个已知模板，满足 $h[0] = 1$ 且对于所有 $n  0$ 有 $h[n] = 0$，$b_0$ 是一个恒定的基底，$s$ 是事件窗口内的恒定基线斜率（线性漂移），$w[n]$ 是具有有限方差的零均值噪声。假设 $w[n]$ 与 $A$、$b_0$ 和 $s$ 无关。事件时间被对齐，使得脉冲的最大值出现在 $n = 0$ 处，且 $n  0$ 处的基底采样点不受脉冲的污染。\n\n考虑两种基线恢复策略及其相应的幅度估计器：\n\n- 逐事件基底扣除：通过对 $M$ 个预采样点进行平均来估计基底 $\\hat b = \\frac{1}{M}\\sum_{k=1}^{M} x[-k]$（其中 $M \\ge 1$），并通过在峰值处进行单点采样来形成幅度估计 $\\hat A_{\\mathrm{ped}} = x[0] - \\hat b$。\n\n- 高通数字基线恢复：将 $x[n]$ 通过一个一阶高通滤波器，该滤波器由 $y[n] = \\alpha \\left(y[n-1] + x[n] - x[n-1]\\right)$ 递归定义，其中 $0  \\alpha  1$，极点参数通过 $\\alpha = e^{-T_s/\\tau_{\\mathrm{HP}}}$ 与时间常数 $\\tau_{\\mathrm{HP}}$ 和采样周期 $T_s$ 相关。假设在脉冲出现之前，滤波器在基线漂移作用下已达到稳态（即，对于所有 $n  0$，$y[n]$ 等于其对 $b_0 + s\\,n$ 的稳态响应）。通过对滤波后波形的峰值进行单点采样，并按零漂移增益进行缩放，来定义一个校准后的幅度估计 $\\hat A_{\\mathrm{HP}} = y[0]/K(\\alpha)$，其中 $K(\\alpha)$ 是从具有相同形状和时间的零漂移（$s = 0$）校准脉冲中确定的增益因子。\n\n仅使用线性、线性泛函的期望和线性时不变滤波的定义，分析当漂移斜率 $s \\ne 0$ 时，$\\hat A_{\\mathrm{ped}}$ 和 $\\hat A_{\\mathrm{HP}}$ 的偏差。在所述假设下，选择所有关于每种方法使幅度估计产生偏差的条件以及该偏差对 $(M,\\alpha,s)$ 的函数依赖关系的正确陈述。\n\nA. 对于使用 $M$ 个预采样点和峰值采样估计器 $\\hat A_{\\mathrm{ped}} = x[0] - \\hat b$ 的逐事件基底扣除法，期望幅度偏差为 $+s\\,\\frac{M+1}{2}$，且该估计器是无偏的当且仅当 $s = 0$。\n\nB. 对于一阶高通滤波器 $y[n] = \\alpha\\left(y[n-1] + x[n] - x[n-1]\\right)$ 和校准后的单点采样估计器 $\\hat A_{\\mathrm{HP}} = y[0]/K(\\alpha)$，线性漂移被差分操作完全消除，因此对于任何 $s$ 和 $\\alpha$，该估计器都是无偏的。\n\nC. 在相同的高通方案和脉冲前的稳态初始化条件下，线性漂移 $s$ 在用于幅度的输出采样点上产生一个附加贡献，校准后其大小为 $s/(1-\\alpha)$，因此只要 $s \\ne 0$，估计器就有偏差，且偏差随着 $\\alpha \\to 1$ 而增加。\n\nD. 当使用单个滤波后的样本进行幅度估计时，选择远低于 $h[n]$ 主要频谱成分的高通截止角频率，可以保证对于任何非零的 $s$，幅度都是无偏的。\n\nE. 如果基底由 $M_{\\mathrm{pre}}$ 个预采样点和 $M_{\\mathrm{post}}$ 个后采样点计算得出，其中 $M_{\\mathrm{pre}} = M_{\\mathrm{post}}$ 对称地包围峰值，并且幅度被估计为峰值样本减去该对称平均值，那么只要基底采样点未受脉冲污染，由任何线性漂移引起的期望偏差都为零。",
            "solution": "该问题要求分析两种不同幅度估计器对数字化量能器信号的偏差。对于参数 $\\theta$，其估计器 $\\hat{\\theta}$ 的偏差定义为 $B(\\hat{\\theta}) = E[\\hat{\\theta}] - \\theta$。这里，参数是真实脉冲幅度 $A$。分析将基于估计器的期望值。信号模型由 $x[n] = A\\,h[n] + b_0 + s\\,n + w[n]$ 给出。由于噪声 $w[n]$ 是零均值的，信号的期望为 $E[x[n]] = A\\,h[n] + b_0 + s\\,n$。我们将使用期望算子的线性性质。\n\n首先，让我们分析基底扣除法。\n幅度的估计器是 $\\hat{A}_{\\mathrm{ped}} = x[0] - \\hat{b}$，其中基底的估计是 $\\hat{b} = \\frac{1}{M}\\sum_{k=1}^{M} x[-k]$。\n幅度估计器的期望是：\n$$E[\\hat{A}_{\\mathrm{ped}}] = E[x[0] - \\frac{1}{M}\\sum_{k=1}^{M} x[-k]]$$\n根据期望的线性性质：\n$$E[\\hat{A}_{\\mathrm{ped}}] = E[x[0]] - \\frac{1}{M}\\sum_{k=1}^{M} E[x[-k]]$$\n我们使用 $E[x[n]] = A\\,h[n] + b_0 + s\\,n$ 来计算各个期望值。\n对于峰值处的样本 $n=0$：\n$E[x[0]] = A\\,h[0] + b_0 + s \\cdot 0$。给定 $h[0]=1$，这变为 $E[x[0]] = A + b_0$。\n对于预采样点，$n = -k$ 其中 $k \\in \\{1, 2, ..., M\\}$：\n$E[x[-k]] = A\\,h[-k] + b_0 + s(-k)$。给定对于 $n0$ 有 $h[n]=0$，则对于 $k \\ge 1$ 有 $h[-k]=0$。\n因此，$E[x[-k]] = b_0 - s\\,k$。\n\n将这些代入 $E[\\hat{A}_{\\mathrm{ped}}]$ 的表达式中：\n$$E[\\hat{A}_{\\mathrm{ped}}] = (A + b_0) - \\frac{1}{M}\\sum_{k=1}^{M} (b_0 - s\\,k)$$\n$$E[\\hat{A}_{\\mathrm{ped}}] = A + b_0 - \\frac{1}{M} \\left( \\sum_{k=1}^{M} b_0 - s\\sum_{k=1}^{M} k \\right)$$\n$$E[\\hat{A}_{\\mathrm{ped}}] = A + b_0 - \\frac{1}{M} \\left( M b_0 - s \\frac{M(M+1)}{2} \\right)$$\n$$E[\\hat{A}_{\\mathrm{ped}}] = A + b_0 - b_0 + s \\frac{M(M+1)}{2M}$$\n$$E[\\hat{A}_{\\mathrm{ped}}] = A + s \\frac{M+1}{2}$$\n偏差是该期望与真实幅度 $A$ 之间的差值：\n$$B(\\hat{A}_{\\mathrm{ped}}) = E[\\hat{A}_{\\mathrm{ped}}] - A = s \\frac{M+1}{2}$$\n\n其次，让我们分析高通滤波器法。\n该滤波器是一个线性时不变（LTI）系统，由 $y[n] = \\alpha \\left(y[n-1] + x[n] - x[n-1]\\right)$ 描述。由于线性，总输出是输入信号各分量 $x[n] = A\\,h[n] + b_0 + s\\,n + w[n]$ 的输出之和。幅度估计器是 $\\hat{A}_{\\mathrm{HP}} = y[0]/K(\\alpha)$。\n估计器的期望是 $E[\\hat{A}_{\\mathrm{HP}}] = E[y[0]]/K(\\alpha)$。\n$E[y[0]]$ 是滤波器在 $n=0$ 时对期望输入信号 $E[x[n]] = A\\,h[n] + b_0 + s\\,n$ 的输出。\n令 $\\mathcal{L}\\{\\cdot\\}$ 表示LTI滤波器的操作。在 $n=0$ 时的输出是：\n$$E[y[0]] = \\mathcal{L}\\{A\\,h[n]\\}_0 + \\mathcal{L}\\{b_0\\}_0 + \\mathcal{L}\\{s\\,n\\}_0$$\n校准因子 $K(\\alpha)$ 是为零漂移（$s=0$）脉冲确定的。对于输入 $x'[n] = A\\,h[n]+b_0$，滤波后的输出是 $y'[n]$，且估计值 $y'[0]/K(\\alpha)$ 必须等于 $A$。\n$E[y'[0]] = \\mathcal{L}\\{A\\,h[n]\\}_0 + \\mathcal{L}\\{b_0\\}_0$。\n让我们找出对恒定基底 $b_0$ 的响应。滤波器差分级的输入是 $x[n]-x[n-1] = b_0 - b_0 = 0$。滤波器递归变为 $y[n] = \\alpha y[n-1]$。因此，对恒定输入的稳态响应是 $y_{ss}=0$。所以，$\\mathcal{L}\\{b_0\\}_0 = 0$。\n校准条件变为 $A = E[y'[0]]/K(\\alpha) = (\\mathcal{L}\\{A\\,h[n]\\}_0)/K(\\alpha) = A(\\mathcal{L}\\{h[n]\\}_0)/K(\\alpha)$。这意味着 $K(\\alpha) = \\mathcal{L}\\{h[n]\\}_0$。让我们计算这个值。对 $h[n]$ 的响应从静止开始，所以对于 $n0$，有 $y_h[n]=0$。在 $n=0$ 时：\n$y_h[0] = \\alpha(y_h[-1] + h[0] - h[-1]) = \\alpha(0 + 1 - 0) = \\alpha$。\n所以，校准常数是 $K(\\alpha) = \\alpha$。\n\n现在，我们求出对线性漂移分量 $u[n] = s\\,n$ 的响应。差分级的输入是 $u[n]-u[n-1] = s\\,n - s(n-1) = s$。此分量的滤波器递归是 $y_s[n] = \\alpha y_s[n-1] + \\alpha s$。\n问题陈述滤波器在 $n0$ 时处于稳态。稳态值 $y_{ss}$ 满足 $y_{ss} = \\alpha y_{ss} + \\alpha s$，这给出 $y_{ss}(1-\\alpha) = \\alpha s$，或 $y_{ss} = \\frac{\\alpha s}{1-\\alpha}$。\n所以，对于 $n0$，输出恒定为该值。特别是，$y_s[-1] = \\frac{\\alpha s}{1-\\alpha}$。\n那么在 $n=0$ 时的输出是：\n$y_s[0] = \\mathcal{L}\\{s\\,n\\}_0 = \\alpha y_s[-1] + \\alpha s = \\alpha\\left(\\frac{\\alpha s}{1-\\alpha}\\right) + \\alpha s = \\frac{\\alpha^2 s + \\alpha s(1-\\alpha)}{1-\\alpha} = \\frac{\\alpha s}{1-\\alpha}$。\n\n将在 $n=0$ 时的所有分量组合起来，得到总的期望输出：\n$$E[y[0]] = A\\,\\mathcal{L}\\{h[n]\\}_0 + \\mathcal{L}\\{b_0\\}_0 + \\mathcal{L}\\{s\\,n\\}_0 = A\\,K(\\alpha) + 0 + \\frac{\\alpha s}{1-\\alpha}$$\n幅度估计器的期望是：\n$$E[\\hat{A}_{\\mathrm{HP}}] = \\frac{E[y[0]]}{K(\\alpha)} = \\frac{A\\,K(\\alpha) + \\frac{\\alpha s}{1-\\alpha}}{K(\\alpha)} = A + \\frac{1}{K(\\alpha)}\\frac{\\alpha s}{1-\\alpha}$$\n代入 $K(\\alpha)=\\alpha$：\n$$E[\\hat{A}_{\\mathrm{HP}}] = A + \\frac{1}{\\alpha}\\frac{\\alpha s}{1-\\alpha} = A + \\frac{s}{1-\\alpha}$$\n偏差是：\n$$B(\\hat{A}_{\\mathrm{HP}}) = E[\\hat{A}_{\\mathrm{HP}}] - A = \\frac{s}{1-\\alpha}$$\n\n现在我们评估每个选项。\n\nA. 对于使用 $M$ 个预采样点和峰值采样估计器 $\\hat A_{\\mathrm{ped}} = x[0] - \\hat b$ 的逐事件基底扣除法，期望幅度偏差为 $+s\\,\\frac{M+1}{2}$，且该估计器是无偏的当且仅当 $s = 0$。\n我们为此方法推导出的偏差是 $B(\\hat{A}_{\\mathrm{ped}}) = s \\frac{M+1}{2}$。这与选项中的表达式相符。由于 $M \\ge 1$，项 $\\frac{M+1}{2}$ 始终非零。因此，偏差为零当且仅当 $s=0$。该陈述是正确的。\n**结论：正确**\n\nB. 对于一阶高通滤波器 $y[n] = \\alpha\\left(y[n-1] + x[n] - x[n-1]\\right)$ 和校准后的单点采样估计器 $\\hat A_{\\mathrm{HP}} = y[0]/K(\\alpha)$，线性漂移被差分操作完全消除，因此对于任何 $s$ 和 $\\alpha$，该估计器都是无偏的。\n我们为此方法推导出的偏差是 $B(\\hat{A}_{\\mathrm{HP}}) = \\frac{s}{1-\\alpha}$。由于 $0  \\alpha  1$，只要 $s \\ne 0$，偏差就非零。差分操作 $x[n]-x[n-1]$ 将线性漂移 $s\\,n$ 变为一个恒定的阶跃 $s$，但滤波器的递归性质导致了对该阶跃的非零稳态响应。该陈述是错误的。\n**结论：错误**\n\nC. 在相同的高通方案和脉冲前的稳态初始化条件下，线性漂移 $s$ 在用于幅度的输出采样点上产生一个附加贡献，校准后其大小为 $s/(1-\\alpha)$，因此只要 $s \\ne 0$，估计器就有偏差，且偏差随着 $\\alpha \\to 1$ 而增加。\n“校准后的附加贡献”正是我们计算出的偏差项 $B(\\hat{A}_{\\mathrm{HP}}) = \\frac{s}{1-\\alpha}$。对于 $s \\ne 0$，此项非零。当 $\\alpha \\to 1$（从下方逼近）时，分母 $1-\\alpha$ 从上方逼近 $0$，因此偏差的绝对值 $|\\frac{s}{1-\\alpha}|$ 趋向于无穷大。该陈述是正确的。\n**结论：正确**\n\nD. 当使用单个滤波后的样本进行幅度估计时，选择远低于 $h[n]$ 主要频谱成分的高通截止角频率，可以保证对于任何非零的 $s$，幅度都是无偏的。\n低截止频率旨在使信号脉冲 $h[n]$ 以很小的衰减通过。低截止频率对应于长的时间常数 $\\tau_{\\mathrm{HP}}$，这意味着 $\\alpha = e^{-T_s/\\tau_{\\mathrm{HP}}}$ 趋近于 $1$。如选项 C 的分析所示，当 $\\alpha \\to 1$ 时，偏差 $\\frac{s}{1-\\alpha}$ 变得非常大，而不是零。该陈述与事实恰好相反。\n**结论：错误**\n\nE. 如果基底由 $M_{\\mathrm{pre}}$ 个预采样点和 $M_{\\mathrm{post}}$ 个后采样点计算得出，其中 $M_{\\mathrm{pre}} = M_{\\mathrm{post}}$ 对称地包围峰值，并且幅度被估计为峰值样本减去该对称平均值，那么只要基底采样点未受脉冲污染，由任何线性漂移引起的期望偏差都为零。\n该选项提出了一个新的估计器。设 $M_{\\mathrm{pre}} = M_{\\mathrm{post}} = M_s$。新的基底估计是 $\\hat{b}_{\\mathrm{sym}} = \\frac{1}{2M_s}\\left(\\sum_{k=1}^{M_s} x[-k] + \\sum_{k=1}^{M_s} x[k]\\right)$。幅度估计是 $\\hat{A}_{\\mathrm{sym}} = x[0] - \\hat{b}_{\\mathrm{sym}}$。我们计算其期望。\n$E[\\hat{A}_{\\mathrm{sym}}] = E[x[0]] - E[\\hat{b}_{\\mathrm{sym}}]$。\n如前所述，$E[x[0]] = A+b_0$。对于基底估计的期望：\n$E[\\hat{b}_{\\mathrm{sym}}] = \\frac{1}{2M_s}\\left(\\sum_{k=1}^{M_s} E[x[-k]] + \\sum_{k=1}^{M_s} E[x[k]]\\right)$。\n条件“基底采样点未受脉冲污染”意味着对于所用的样本，$h[n]=0$。我们知道对于 $k\\ge 1$，$h[-k]=0$。我们假设对于 $k \\in \\{1, ..., M_s\\}$，$h[k]=0$。\n$E[x[-k]] = A\\,h[-k] + b_0 - s\\,k = b_0 - s\\,k$。\n$E[x[k]] = A\\,h[k] + b_0 + s\\,k = b_0 + s\\,k$。\n代入 $\\hat{b}_{\\mathrm{sym}}$ 的期望表达式中：\n$$E[\\hat{b}_{\\mathrm{sym}}] = \\frac{1}{2M_s}\\left(\\sum_{k=1}^{M_s} (b_0 - s\\,k) + \\sum_{k=1}^{M_s} (b_0 + s\\,k)\\right)$$\n$$E[\\hat{b}_{\\mathrm{sym}}] = \\frac{1}{2M_s}\\left( (M_s b_0 - s\\sum_{k=1}^{M_s} k) + (M_s b_0 + s\\sum_{k=1}^{M_s} k) \\right)$$\n$$E[\\hat{b}_{\\mathrm{sym}}] = \\frac{1}{2M_s}(2 M_s b_0) = b_0$$\n由于对称平均，涉及斜率 $s$ 的项完全抵消了。\n期望的幅度是 $E[\\hat{A}_{\\mathrm{sym}}] = (A+b_0) - b_0 = A$。\n偏差是 $B(\\hat{A}_{\\mathrm{sym}}) = E[\\hat{A}_{\\mathrm{sym}}] - A = 0$。该陈述是正确的。\n**结论：正确**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "除了系统偏差，信号固有的随机性和电子学噪声共同决定了能量分辨率的统计极限。本练习  将引导你为一个带有次级雪崩（afterpulsing）效应的硅光电倍增管（SiPM）信号建立一个精细的随机模型。你将通过推导和编程实现，比较两种主流的数字化策略——积分型ADC（测量总电荷）和峰值采样ADC（测量脉冲峰高）——在不同条件下对能量分辨率的影响，从而深入理解信号特征提取与测量精度之间的关系。",
            "id": "3511813",
            "problem": "考虑一个用于高能物理仪器中能量测量的硅光电倍增管 (SiPM) 脉冲数字化的简化但科学上合理的模型。SiPM 探测到的能量沉积会触发随机数量的原初微单元雪崩，其数量被建模为一个均值为 $\\mu$ 的泊松 (Poisson) 随机变量。每个原初微单元雪崩有 $r_a$ 的概率产生一个后脉冲。后脉冲的幅度是原初雪崩幅度的 $\\alpha$ 倍，并具有一个独立的延迟 $t$，该延迟从率（rate）为 $1/\\tau_a$ 的指数分布中抽取（即，对于 $t \\ge 0$，其概率密度为 $f(t) = \\frac{1}{\\tau_a} e^{-t/\\tau_a}$）。前端电子学是线性时不变的，被建模为一次单极微分后接一次单极积分（通常称为“CR-RC 成形”），成形时间为 $\\tau_s$，产生的成形脉冲在 $t_p = \\tau_s$ 时达到峰值。\n\n将对两种数字化策略进行比较：\n\n1. 积分型模数转换器 (ADC)：这是一种通过在从原初脉冲时间起点开始的固定时间窗口 $T_{\\mathrm{int}}$ 内对成形信号进行积分来测量总电荷的模数转换器 (ADC)。假设积分器捕获积分窗口内发生的任何后脉冲贡献（即，任何延迟 $t \\le T_{\\mathrm{int}}$ 的后脉冲都以其幅度分数 $\\alpha$ 贡献于测得的电荷）。积分器输出建模为 $Q$，并带有方差为 $\\sigma_Q^2$ 的加性电子学噪声，该噪声与信号无关。\n\n2. 峰值敏感数字化：此方法在有限的采集窗口内扫描成形波形以寻找其最大值。假设峰值主要由其在 $t_p = \\tau_s$ 附近的峰值处的原初脉冲决定，并且只有在 $t_p$ 周围宽度为 $w$ 的对称捕获窗口内发生的后脉冲才会叠加在原初峰值上（即，延迟 $t \\in [\\max(0, t_p - w/2), t_p + w/2]$ 的后脉冲以其幅度分数 $\\alpha$ 贡献于测得的峰值）。峰值输出建模为 $V$，并带有方差为 $\\sigma_V^2$ 的加性电子学噪声，该噪声与信号无关。\n\n假设每个原初雪崩的电荷单位增益为 $q_0$，每个原初雪崩的峰值幅度单位增益为 $a_0$。将 $q_0$ 和 $a_0$ 视为已知常数。\n\n从基本定义出发，为每种数字化策略计算测量量的均值和方差，将其表示为 $\\mu$, $r_a$, $\\alpha$ 以及由上述窗口和指数后脉冲延迟模型所隐含的有效捕获概率的函数。由此，推导出每种策略的能量分辨率，定义为相对标准差 $R = \\frac{\\sqrt{\\mathrm{Var}}}{\\mathrm{E}[\\cdot]}$，并以小数形式表示。使用以下物理单位约定：\n- 时间参数 $\\tau_a$, $\\tau_s$, $T_{\\mathrm{int}}$ 和 $w$ 在计算中必须以纳秒 (ns) 为单位处理。\n- 能量分辨率 $R$ 必须以小数（例如 $0.1$）报告，而不是百分比。\n\n您的程序必须实现推导出的表达式，并为以下测试套件生成结果。每个测试用例指定为一个元组 $(\\mu, r_a, \\alpha, \\tau_a, \\tau_s, T_{\\mathrm{int}}, w, q_0, a_0, \\sigma_Q, \\sigma_V)$，其中所有时间参数的单位均为 ns，所有非时间参数均为无量纲或使用任意、一致的信号单位：\n\n- 测试用例 1 (通用“理想路径”)：$(100, 0.1, 0.5, 50, 20, 200, 20, 1.0, 1.0, 2.0, 2.0)$。\n- 测试用例 2 (边界，无后脉冲)：$(100, 0.0, 0.5, 50, 20, 200, 20, 1.0, 1.0, 2.0, 2.0)$。\n- 测试用例 3 (边缘情况，窗口极短)：$(100, 0.1, 0.5, 50, 20, 5, 5, 1.0, 1.0, 2.0, 2.0)$。\n- 测试用例 4 (高后脉冲率，不同参数)：$(60, 0.5, 0.3, 30, 15, 40, 10, 1.0, 1.0, 1.0, 1.0)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，输出两个值：首先是积分型 ADC 的能量分辨率 $R_Q$，然后是峰值敏感型能量分辨率 $R_V$。按顺序汇总所有测试用例的结果，最终得到一个包含八个十进制数的列表：\n$[ R_{Q,1}, R_{V,1}, R_{Q,2}, R_{V,2}, R_{Q,3}, R_{V,3}, R_{Q,4}, R_{V,4} ]$。\n\n仅使用所述的假设和定义来实现计算。不要使用任何未从这些基础上推导出的快捷公式。",
            "solution": "该问题具有科学依据，是良定的，并包含得出唯一解所需的所有信息。因此，我们可以进行推导。\n\n目标是计算两种不同信号数字化策略的能量分辨率，其定义为相对标准差 $R = \\sqrt{\\mathrm{Var}[\\cdot]} / \\mathrm{E}[\\cdot]$。问题的核心在于为每种策略的测量量建立均值和方差的模型。这需要将概率论谨慎地应用于 SiPM 信号的随机模型。\n\n设 $N_p$ 为原初微单元雪崩的数量，它是一个均值为 $\\mu$ 的泊松 (Poisson) 随机变量。\n$$N_p \\sim \\mathrm{Poisson}(\\mu)$$\n$N_p$ 的均值和方差分别为 $\\mathrm{E}[N_p] = \\mu$ 和 $\\mathrm{Var}[N_p] = \\mu$。\n\n每个原初雪崩都可能触发一个后脉冲。总信号是所有原初雪崩及其被电子学系统捕获的相应后脉冲的贡献之和。让我们对单个原初雪崩的信号贡献进行建模。这包括原初雪崩自身的信号（归一化为 $1$）加上来自后脉冲的潜在贡献。\n\n后脉冲以概率 $r_a$ 发生。它以一定的概率 $p$ 被数字化电子学系统捕获，该概率取决于具体策略（积分型 vs. 峰值敏感型）。因此，单个原初雪崩产生一个*被捕获的*后脉冲的概率为 $r_{\\mathrm{eff}} = r_a \\cdot p$。\n\n设 $X$ 为一个伯努利 (Bernoulli) 随机变量，如果一个原初雪崩产生了一个被捕获的后脉冲，则 $X=1$，否则 $X=0$。$P(X=1) = r_{\\mathrm{eff}}$。\n来自一个原初雪崩及其潜在后脉冲的信号贡献可以建模为一个随机变量 $Y$。原初雪崩贡献 1 个单位的信号。后脉冲如果发生并被捕获，则额外贡献幅度分数为 $\\alpha$ 的信号。因此，\n$$Y = 1 + \\alpha X$$\n来自所有 $N_p$ 个原初雪崩的总信号（不含电子学噪声）由 $S_{\\mathrm{sig}} = g \\sum_{i=1}^{N_p} Y_i$ 给出，其中 $g$ 是增益常数（$q_0$ 或 $a_0$），$Y_i$ 是与 $Y$ 同分布的独立同分布随机变量。这是一个经典的复合泊松过程。\n\n为了求出 $S_{\\mathrm{sig}}$ 的均值和方差，我们使用复合泊松分布的性质。如果 $S = \\sum_{i=1}^{N} Z_i$ 其中 $N \\sim \\mathrm{Poisson}(\\lambda)$ 且 $Z_i$ 是独立同分布的，那么 $\\mathrm{E}[S] = \\lambda \\mathrm{E}[Z]$ 且 $\\mathrm{Var}[S] = \\lambda \\mathrm{E}[Z^2]$。\n\n在我们的例子中，信号是 $S_{\\mathrm{sig}}$，$N$ 是 $N_p$（其中 $\\lambda=\\mu$），$Z_i$ 是 $g Y_i$。所以我们需要求 $gY_i$ 的前两阶矩。\n首先，我们求 $Y$ 的矩。\n$Y$ 的均值为：\n$$\\mathrm{E}[Y] = \\mathrm{E}[1 + \\alpha X] = 1 + \\alpha \\mathrm{E}[X] = 1 + \\alpha r_{\\mathrm{eff}}$$\n对于二阶矩，我们使用伯努利变量的性质 $X^2 = X$：\n$$\\mathrm{E}[Y^2] = \\mathrm{E}[(1 + \\alpha X)^2] = \\mathrm{E}[1 + 2\\alpha X + \\alpha^2 X^2] = 1 + 2\\alpha \\mathrm{E}[X] + \\alpha^2 \\mathrm{E}[X] = 1 + (2\\alpha + \\alpha^2)r_{\\mathrm{eff}}$$\n\n现在我们将复合泊松公式应用于 $S_{\\mathrm{sig}} = \\sum_{i=1}^{N_p} (g Y_i)$：\n$$\\mathrm{E}[S_{\\mathrm{sig}}] = \\mu \\cdot \\mathrm{E}[gY] = g \\mu \\mathrm{E}[Y] = g \\mu (1 + \\alpha r_{\\mathrm{eff}})$$\n$$\\mathrm{Var}[S_{\\mathrm{sig}}] = \\mu \\cdot \\mathrm{E}[(gY)^2] = g^2 \\mu \\mathrm{E}[Y^2] = g^2 \\mu (1 + (2\\alpha + \\alpha^2)r_{\\mathrm{eff}})$$\n\n总测量量（我们称之为 $S$）包含均值为 0、方差为 $\\sigma^2$ 的加性电子学噪声 $N_{\\mathrm{elec}}$。信号和噪声是独立的。\n$$S = S_{\\mathrm{sig}} + N_{\\mathrm{elec}}$$\n总测量信号的均值为：\n$$\\mathrm{E}[S] = \\mathrm{E}[S_{\\mathrm{sig}}] + \\mathrm{E}[N_{\\mathrm{elec}}] = g \\mu (1 + \\alpha r_{\\mathrm{eff}})$$\n总测量信号的方差为：\n$$\\mathrm{Var}[S] = \\mathrm{Var}[S_{\\mathrm{sig}}] + \\mathrm{Var}[N_{\\mathrm{elec}}] = g^2 \\mu (1 + (2\\alpha + \\alpha^2)r_{\\mathrm{eff}}) + \\sigma^2$$\n\n剩下的唯一任务是确定每种策略的捕获概率 $p$。后脉冲延迟 $t$ 服从概率密度函数 (PDF) 为 $f(t) = \\frac{1}{\\tau_a} e^{-t/\\tau_a}$ 的指数分布。相应的累积分布函数 (CDF) 是 $F(t) = P(T \\le t) = 1 - e^{-t/\\tau_a}$。\n\n策略 1：积分型 ADC (量 $Q$)\n该策略捕获延迟 $t \\le T_{\\mathrm{int}}$ 的后脉冲。因此，捕获概率 $p_Q$ 为：\n$$p_Q = P(t \\le T_{\\mathrm{int}}) = F(T_{\\mathrm{int}}) = 1 - e^{-T_{\\mathrm{int}}/\\tau_a}$$\n有效后脉冲率为 $r_{\\mathrm{eff}, Q} = r_a \\cdot p_Q$。增益为 $g=q_0$，噪声方差为 $\\sigma_Q^2$。\n均值和方差为：\n$$\\mathrm{E}[Q] = q_0 \\mu (1 + \\alpha r_{\\mathrm{eff}, Q})$$\n$$\\mathrm{Var}[Q] = q_0^2 \\mu (1 + (2\\alpha + \\alpha^2)r_{\\mathrm{eff}, Q}) + \\sigma_Q^2$$\n分辨率为 $R_Q = \\sqrt{\\mathrm{Var}[Q]} / \\mathrm{E}[Q]$。\n\n策略 2：峰值敏感型 ADC (量 $V$)\n该策略捕获延迟 $t$ 在窗口 $[\\max(0, t_p - w/2), t_p + w/2]$ 内的后脉冲。已知 $t_p = \\tau_s$。设 $t_{\\min} = \\max(0, \\tau_s - w/2)$ 且 $t_{\\max} = \\tau_s + w/2$。捕获概率 $p_V$ 为：\n$$p_V = P(t_{\\min} \\le t \\le t_{\\max}) = F(t_{\\max}) - F(t_{\\min})$$\n$$p_V = (1 - e^{-t_{\\max}/\\tau_a}) - (1 - e^{-t_{\\min}/\\tau_a}) = e^{-t_{\\min}/\\tau_a} - e^{-t_{\\max}/\\tau_a}$$\n有效后脉冲率为 $r_{\\mathrm{eff}, V} = r_a \\cdot p_V$。增益为 $g=a_0$，噪声方差为 $\\sigma_V^2$。\n均值和方差为：\n$$\\mathrm{E}[V] = a_0 \\mu (1 + \\alpha r_{\\mathrm{eff}, V})$$\n$$\\mathrm{Var}[V] = a_0^2 \\mu (1 + (2\\alpha + \\alpha^2)r_{\\mathrm{eff}, V}) + \\sigma_V^2$$\n分辨率为 $R_V = \\sqrt{\\mathrm{Var}[V]} / \\mathrm{E}[V]$。\n\n这些推导出的表达式在下面的程序中被实现，用以计算给定测试用例的分辨率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# SciPy is specified as available in the execution environment\n# but is not necessary for this implementation, as the required\n# functions (exp, sqrt) are readily available in NumPy.\n\ndef solve():\n    \"\"\"\n    Main function to solve the SiPM resolution problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple:\n    # (μ, r_a, α, τ_a, τ_s, T_int, w, q_0, a_0, σ_Q, σ_V)\n    test_cases = [\n        (100.0, 0.1, 0.5, 50.0, 20.0, 200.0, 20.0, 1.0, 1.0, 2.0, 2.0),\n        (100.0, 0.0, 0.5, 50.0, 20.0, 200.0, 20.0, 1.0, 1.0, 2.0, 2.0),\n        (100.0, 0.1, 0.5, 50.0, 20.0, 5.0, 5.0, 1.0, 1.0, 2.0, 2.0),\n        (60.0, 0.5, 0.3, 30.0, 15.0, 40.0, 10.0, 1.0, 1.0, 1.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        mu, r_a, alpha, tau_a, tau_s, T_int, w, q_0, a_0, sigma_Q, sigma_V = case\n\n        # --- Strategy 1: Integrating ADC ---\n        \n        # Calculate afterpulse capture probability for the integrator\n        # p_Q = 1 - exp(-T_int / tau_a)\n        p_Q = 1.0 - np.exp(-T_int / tau_a)\n        \n        # Calculate effective afterpulse rate\n        r_eff_Q = r_a * p_Q\n        \n        # Calculate mean of the measured charge Q\n        # E[Q] = q_0 * mu * (1 + alpha * r_eff_Q)\n        mean_Q = q_0 * mu * (1.0 + alpha * r_eff_Q)\n        \n        # Calculate variance of the measured charge Q\n        # Var[Q] = q_0^2 * mu * (1 + (2*alpha + alpha^2)*r_eff_Q) + sigma_Q^2\n        var_Q = (q_0**2 * mu * (1.0 + (2.0 * alpha + alpha**2) * r_eff_Q)) + sigma_Q**2\n        \n        # Calculate resolution R_Q\n        resolution_Q = np.sqrt(var_Q) / mean_Q\n        results.append(resolution_Q)\n        \n        # --- Strategy 2: Peak-sensing ADC ---\n\n        # Define the capture window boundaries for the peak-sensing ADC\n        t_p = tau_s\n        t_min = max(0.0, t_p - w / 2.0)\n        t_max = t_p + w / 2.0\n        \n        # Calculate afterpulse capture probability for the peak-sensor\n        # p_V = exp(-t_min / tau_a) - exp(-t_max / tau_a)\n        p_V = np.exp(-t_min / tau_a) - np.exp(-t_max / tau_a)\n        \n        # Calculate effective afterpulse rate\n        r_eff_V = r_a * p_V\n        \n        # Calculate mean of the measured peak voltage V\n        # E[V] = a_0 * mu * (1 + alpha * r_eff_V)\n        mean_V = a_0 * mu * (1.0 + alpha * r_eff_V)\n        \n        # Calculate variance of the measured peak voltage V\n        # Var[V] = a_0^2 * mu * (1 + (2*alpha + alpha^2)*r_eff_V) + sigma_V^2\n        var_V = (a_0**2 * mu * (1.0 + (2.0 * alpha + alpha**2) * r_eff_V)) + sigma_V**2\n        \n        # Calculate resolution R_V\n        resolution_V = np.sqrt(var_V) / mean_V\n        results.append(resolution_V)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在高能物理实验中，精确的时间测量与能量测量同等重要，它决定了粒子径迹重建和飞行时间测量的精度。本练习  从第一性原理出发，指导你推导一个综合性的时间分辨率模型，该模型包含了电子学噪声、信号转换速率（slew rate）以及甄别器和时钟抖动等多种独立误差源。通过比较前沿甄别（LED）和恒比定时（CFD）这两种经典技术，你将量化评估不同因素对实现皮秒级时间分辨率的贡献和限制。",
            "id": "3511856",
            "problem": "位于对撞机探测器中的一个快速硅传感器产生电流脉冲，经过具有单极点响应的前端放大后，在甄别器输入端表现为电压脉冲，其模型为 $v(t) = A \\bigl(1 - \\exp(-(t - t_{0})/\\tau_{r})\\bigr) u(t - t_{0})$，其中 $A$ 是脉冲幅度，$\\tau_{r}$ 是上升时间常数，$t_{0}$ 是真实到达时间，$u(\\cdot)$ 是单位阶跃函数。前端会引入加性、平稳、零均值的高斯电子学噪声，其折合到甄别器输入端的均方根 (RMS) 值为 $\\sigma_{n}$。考虑两种计时架构：一种是具有固定阈值 $V_{\\mathrm{th}}$ 的前沿甄别器 (Leading-Edge Discriminator, LED)，另一种是恒比定时甄别器 (Constant-Fraction Discriminator, CFD)，其实现方式是对一个延迟并按比例缩放的信号副本进行减法运算，$v_{\\mathrm{CFD}}(t) = v(t) - f\\,v(t - \\Delta)$，然后由一个过零比较器进行处理。假设 CFD 减法运算输入端的噪声是不相关的，并且每个支路的噪声均方根值均为 $\\sigma_{n}$。两种架构中的比较器都表现出固有的计时抖动，其均方根值为 $\\sigma_{\\mathrm{disc}}$，且与输入转换速率无关；时间-数字转换器 (Time-to-Digital Converter, TDC) 的采样时钟也引入了独立的均方根抖动 $\\sigma_{\\mathrm{clk}}$。所有抖动均为零均值高斯分布且相互独立。\n\n从第一性原理出发，将由隐式穿越条件定义的时间拾取与微小加性电压扰动对推断时间的影响联系起来，并仅使用核心定义和线性化方法，推导出一个总体时间分辨率 $\\sigma_{t}$ 的通用表达式。该表达式需结合加性电子学噪声、比较器固有抖动和 TDC 时钟抖动的贡献，并分别适用于以下两种情况：\n- LED，其时间 $t_{\\ast}$ 由 $v(t_{\\ast}) = V_{\\mathrm{th}}$ 定义，以及\n- CFD，其时间 $t_{\\ast}$ 由 $v_{\\mathrm{CFD}}(t_{\\ast}) = 0$ 定义。\n\n对于 CFD，请将您的推导应用于给定的指数上升脉冲，并明确展示在过零点处的有效转换速率和有效均方根噪声如何依赖于分数 $f$ 和延迟 $\\Delta$。同时，请确定为确保在上升沿上存在有效过零点所需对 $\\Delta$ 的任何约束条件。然后，对于以下数值参数集：\n- $\\tau_{r} = 250\\,\\mathrm{ps}$，\n- $A = 20\\,\\mathrm{mV}$，\n- $\\sigma_{n} = 0.5\\,\\mathrm{mV}$，\n- $V_{\\mathrm{th}} = 5\\,\\mathrm{mV}$，\n- $f = 0.2$，\n- $\\Delta = 200\\,\\mathrm{ps}$，\n- $\\sigma_{\\mathrm{disc}} = 5\\,\\mathrm{ps}$，\n- $\\sigma_{\\mathrm{clk}} = 12\\,\\mathrm{ps}$，\n\n计算 LED 和 CFD 的总时间分辨率 $\\sigma_{t}$。将您的最终数值结果四舍五入至四位有效数字，并以皮秒 (ps) 为单位表示 $\\sigma_{t}$。",
            "solution": "该问题提法明确，具有科学依据，并包含了推导所需时间分辨率的全部必要信息。我们将开始进行解答。\n\n将微小电压扰动（噪声）$\\delta v$ 与微小时间误差（抖动）$\\delta t$ 联系起来的基本原理，是通过在时间拾取点 $t_{\\ast}$ 附近对信号 $v(t)$ 进行线性化来推导的。设拾取时间 $t_{\\ast}$ 由隐式条件 $F(v(t_{\\ast})) = C$ 定义，其中 $C$ 是一个常数。在存在一个微小的加性噪声电压 $n(t)$ 的情况下，该条件在一个略微不同的时间 $t_{\\ast} + \\delta t$ 被满足，因此有 $F(v(t_{\\ast} + \\delta t) + n(t_{\\ast})) = C$。\n\n对于简单的阈值穿越，例如在前沿甄别器 (LED) 中，条件是 $v(t_{\\ast}) = V_{\\mathrm{th}}$。在有噪声的情况下，这变为 $v(t_{\\ast} + \\delta t) + n(t_{\\ast}) = V_{\\mathrm{th}}$。将 $v(t)$ 在 $t_{\\ast}$ 附近进行一阶泰勒展开，得到 $v(t_{\\ast} + \\delta t) \\approx v(t_{\\ast}) + \\frac{dv}{dt}\\big|_{t_{\\ast}} \\delta t$。将此式和原始条件 $v(t_{\\ast}) = V_{\\mathrm{th}}$ 代入受扰动的方程，我们得到 $V_{\\mathrm{th}} + \\frac{dv}{dt}\\big|_{t_{\\ast}} \\delta t + n(t_{\\ast}) \\approx V_{\\mathrm{th}}$。这可以简化为 $\\delta t \\approx - \\frac{n(t_{\\ast})}{\\frac{dv}{dt}\\big|_{t_{\\ast}}}$。\n\n计时抖动的方差 $\\sigma_{t, \\text{noise}}^2$ 是 $(\\delta t)^2$ 的期望值。由于噪声 $n(t)$ 是一个均方根值为 $\\sigma_n$ 的平稳零均值过程，我们有 $\\mathbb{E}[n(t_{\\ast})^2] = \\sigma_n^2$。因此，由电子学噪声引起的抖动贡献由下式给出\n$$\n\\sigma_{t, \\text{noise}}^2 = \\mathbb{E}[(\\delta t)^2] = \\frac{\\mathbb{E}[n(t_{\\ast})^2]}{\\left(\\frac{dv}{dt}\\big|_{t_{\\ast}}\\right)^2} = \\left(\\frac{\\sigma_n}{\\frac{dv}{dt}\\big|_{t_{\\ast}}}\\right)^2\n$$\n项 $\\frac{dv}{dt}\\big|_{t_{\\ast}}$ 是信号在穿越时间的转换速率。通过使用时间信号在其过零点处的有效转换速率和有效噪声，同样的原理也适用于更复杂的时间信号，例如在恒比定时甄别器 (CFD) 中。\n\n总时间分辨率 $\\sigma_t$ 是所有独立抖动源的方和根。问题指定了三个这样的来源：电子学噪声 ($\\sigma_{t, \\text{noise}}$)、甄别器固有抖动 ($\\sigma_{\\mathrm{disc}}$) 和 TDC 时钟抖动 ($\\sigma_{\\mathrm{clk}}$)。因此，总时间分辨率为：\n$$\n\\sigma_t = \\sqrt{\\sigma_{t, \\text{noise}}^2 + \\sigma_{\\mathrm{disc}}^2 + \\sigma_{\\mathrm{clk}}^2}\n$$\n\n现在我们将这个框架应用于 LED 和 CFD 架构。电压脉冲由 $v(t) = A \\bigl(1 - \\exp(-(t - t_{0})/\\tau_{r})\\bigr) u(t - t_{0})$ 给出，在计算中，我们可以不失一般性地设 $t_0=0$。\n\n**1. 前沿甄别器 (LED)**\n\n对于 LED，时间拾取点 $t_{\\ast}$ 由 $v(t_{\\ast}) = V_{\\mathrm{th}}$ 定义。\n$$\nA \\bigl(1 - \\exp(-t_{\\ast}/\\tau_{r})\\bigr) = V_{\\mathrm{th}} \\implies \\exp(-t_{\\ast}/\\tau_{r}) = 1 - \\frac{V_{\\mathrm{th}}}{A} = \\frac{A - V_{\\mathrm{th}}}{A}\n$$\n信号的转换速率为 $\\frac{dv}{dt} = \\frac{d}{dt}\\left[A(1-\\exp(-t/\\tau_r))\\right] = \\frac{A}{\\tau_r}\\exp(-t/\\tau_r)$。\n在穿越时间 $t_{\\ast}$ 处计算转换速率：\n$$\n\\frac{dv}{dt}\\bigg|_{t_{\\ast}} = \\frac{A}{\\tau_r}\\exp(-t_{\\ast}/\\tau_r) = \\frac{A}{\\tau_r}\\left(\\frac{A - V_{\\mathrm{th}}}{A}\\right) = \\frac{A - V_{\\mathrm{th}}}{\\tau_r}\n$$\n那么，由噪声引起的抖动贡献为：\n$$\n\\sigma_{t, \\text{noise, LED}} = \\frac{\\sigma_n}{\\frac{dv}{dt}\\big|_{t_{\\ast}}} = \\frac{\\sigma_n}{(A - V_{\\mathrm{th}})/\\tau_r} = \\frac{\\sigma_n \\tau_r}{A - V_{\\mathrm{th}}}\n$$\nLED 的总时间分辨率为：\n$$\n\\sigma_{t, \\text{LED}} = \\sqrt{\\left(\\frac{\\sigma_n \\tau_r}{A - V_{\\mathrm{th}}}\\right)^2 + \\sigma_{\\mathrm{disc}}^2 + \\sigma_{\\mathrm{clk}}^2}\n$$\n\n**2. 恒比定时甄别器 (CFD)**\n\nCFD 形成一个双极性信号 $v_{\\mathrm{CFD}}(t) = v(t) - f\\,v(t - \\Delta)$，时间拾取点 $t_{\\ast}$ 在其过零点处，即 $v_{\\mathrm{CFD}}(t_{\\ast}) = 0$。这意味着 $v(t_{\\ast}) = f\\,v(t_{\\ast} - \\Delta)$。\n\n抖动由 $v_{\\mathrm{CFD}}(t)$ 的有效转换速率和该信号上的有效噪声决定。在 $t_{\\ast}$ 处的有效转换速率为：\n$$\nS_{\\text{eff}} = \\frac{dv_{\\mathrm{CFD}}}{dt}\\bigg|_{t_{\\ast}} = \\frac{dv}{dt}\\bigg|_{t_{\\ast}} - f \\frac{d v(t - \\Delta)}{dt}\\bigg|_{t_{\\ast}} = \\frac{dv}{dt}\\bigg|_{t_{\\ast}} - f \\frac{dv}{dt}\\bigg|_{t_{\\ast}-\\Delta}\n$$\nCFD 信号上的噪声为 $n_{\\mathrm{CFD}}(t) = n_1(t) - f n_2(t)$，其中 $n_1(t)$ 和 $n_2(t)$ 分别是来自非延迟支路和延迟支路的噪声贡献。问题指出它们是不相关的，且每个支路的均方根值均为 $\\sigma_n$。有效噪声的方差为：\n$$\n\\sigma_{n, \\text{eff}}^2 = \\mathbb{E}[n_{\\mathrm{CFD}}^2] = \\mathbb{E}[(n_1 - fn_2)^2] = \\mathbb{E}[n_1^2] - 2f\\mathbb{E}[n_1 n_2] + f^2\\mathbb{E}[n_2^2] = \\sigma_n^2 + f^2\\sigma_n^2 = (1+f^2)\\sigma_n^2\n$$\n因此，有效均方根噪声为 $\\sigma_{n, \\text{eff}} = \\sigma_n \\sqrt{1+f^2}$。\n\n现在，我们针对给定的脉冲形状，推导 $S_{\\text{eff}}$ 的更明确表达式。过零条件为：\n$$\nA(1-\\exp(-t_{\\ast}/\\tau_r)) = f A(1-\\exp(-(t_{\\ast}-\\Delta)/\\tau_r))\n$$\n$$\n1-\\exp(-t_{\\ast}/\\tau_r) = f(1-\\exp(-t_{\\ast}/\\tau_r)\\exp(\\Delta/\\tau_r))\n$$\n令 $x = \\exp(-t_{\\ast}/\\tau_r)$，我们求解 $x$：$1-x = f(1-x\\exp(\\Delta/\\tau_r)) \\implies 1-f = x(1-f\\exp(\\Delta/\\tau_r))$，这给出\n$$\nx = \\exp(-t_{\\ast}/\\tau_r) = \\frac{1-f}{1-f\\exp(\\Delta/\\tau_r)}\n$$\n为了得到一个物理上有意义的解 ($t_{\\ast}>0$)，我们需要 $0  x  1$。由于 $f1$，分子 $1-f$ 是正的。为了使分母为正，我们需要 $1-f\\exp(\\Delta/\\tau_r) > 0$，这就得出了对延迟 $\\Delta$ 的约束条件：\n$$\n\\Delta  \\tau_r \\ln(1/f)\n$$\n对于 $\\Delta>0$ 和 $f1$ 的情况，条件 $x1$ 总是满足的。\n\n转换速率项为：\n$\\frac{dv}{dt}\\big|_{t_{\\ast}} = \\frac{A}{\\tau_r}\\exp(-t_{\\ast}/\\tau_r) = \\frac{A}{\\tau_r} \\frac{1-f}{1-f\\exp(\\Delta/\\tau_r)}$。\n$\\frac{dv}{dt}\\big|_{t_{\\ast}-\\Delta} = \\frac{A}{\\tau_r}\\exp(-(t_{\\ast}-\\Delta)/\\tau_r) = \\frac{A}{\\tau_r}\\exp(-t_{\\ast}/\\tau_r)\\exp(\\Delta/\\tau_r) = \\frac{dv}{dt}\\big|_{t_{\\ast}}\\exp(\\Delta/\\tau_r)$。\n\n因此，有效转换速率为：\n$$\nS_{\\text{eff}} = \\frac{dv}{dt}\\bigg|_{t_{\\ast}} - f \\left(\\frac{dv}{dt}\\bigg|_{t_{\\ast}}\\exp(\\Delta/\\tau_r)\\right) = \\frac{dv}{dt}\\bigg|_{t_{\\ast}} \\left(1 - f\\exp(\\Delta/\\tau_r)\\right)\n$$\n代入 $\\frac{dv}{dt}\\big|_{t_{\\ast}}$ 的表达式：\n$$\nS_{\\text{eff}} = \\left(\\frac{A}{\\tau_r} \\frac{1-f}{1-f\\exp(\\Delta/\\tau_r)}\\right) \\left(1 - f\\exp(\\Delta/\\tau_r)\\right) = \\frac{A(1-f)}{\\tau_r}\n$$\n这就是有效转换速率的明确依赖关系。它依赖于 $f$ 但不依赖于 $\\Delta$。有效均方根噪声 $\\sigma_{n, \\text{eff}} = \\sigma_n\\sqrt{1+f^2}$ 依赖于 $f$ 但不依赖于 $\\Delta$。\n\nCFD 由噪声引起的抖动贡献为：\n$$\n\\sigma_{t, \\text{noise, CFD}} = \\frac{\\sigma_{n, \\text{eff}}}{S_{\\text{eff}}} = \\frac{\\sigma_n \\sqrt{1+f^2}}{A(1-f)/\\tau_r} = \\frac{\\tau_r \\sigma_n \\sqrt{1+f^2}}{A(1-f)}\n$$\nCFD 的总时间分辨率为：\n$$\n\\sigma_{t, \\text{CFD}} = \\sqrt{\\left(\\frac{\\tau_r \\sigma_n \\sqrt{1+f^2}}{A(1-f)}\\right)^2 + \\sigma_{\\mathrm{disc}}^2 + \\sigma_{\\mathrm{clk}}^2}\n$$\n\n**3. 数值计算**\n\n给定参数为：\n$\\tau_{r} = 250\\,\\mathrm{ps}$，$A = 20\\,\\mathrm{mV}$，$\\sigma_{n} = 0.5\\,\\mathrm{mV}$，$V_{\\mathrm{th}} = 5\\,\\mathrm{mV}$，$f = 0.2$，$\\Delta = 200\\,\\mathrm{ps}$，$\\sigma_{\\mathrm{disc}} = 5\\,\\mathrm{ps}$，$\\sigma_{\\mathrm{clk}} = 12\\,\\mathrm{ps}$。\n\n**对于 LED：**\n噪声引起的抖动贡献为：\n$$\n\\sigma_{t, \\text{noise, LED}} = \\frac{(0.5\\,\\mathrm{mV})(250\\,\\mathrm{ps})}{20\\,\\mathrm{mV} - 5\\,\\mathrm{mV}} = \\frac{125}{15}\\,\\mathrm{ps} = \\frac{25}{3}\\,\\mathrm{ps} \\approx 8.333\\,\\mathrm{ps}\n$$\n总时间分辨率为：\n$$\n\\sigma_{t, \\text{LED}} = \\sqrt{\\left(\\frac{25}{3}\\right)^2 + 5^2 + 12^2}\\,\\mathrm{ps} = \\sqrt{\\frac{625}{9} + 25 + 144}\\,\\mathrm{ps} = \\sqrt{69.444\\dots + 169}\\,\\mathrm{ps} = \\sqrt{238.444\\dots}\\,\\mathrm{ps} \\approx 15.4416\\,\\mathrm{ps}\n$$\n四舍五入到四位有效数字，$\\sigma_{t, \\text{LED}} = 15.44\\,\\mathrm{ps}$。\n\n**对于 CFD：**\n首先，我们检查对 $\\Delta$ 的约束条件：\n$$\n\\Delta  \\tau_r \\ln(1/f) \\implies 200\\,\\mathrm{ps}  (250\\,\\mathrm{ps})\\ln(1/0.2) = (250\\,\\mathrm{ps})\\ln(5) \\approx (250\\,\\mathrm{ps})(1.6094) \\approx 402.4\\,\\mathrm{ps}\n$$\n条件 $200  402.4$ 得到满足。\n噪声引起的抖动贡献为：\n$$\n\\sigma_{t, \\text{noise, CFD}} = \\frac{(250\\,\\mathrm{ps})(0.5\\,\\mathrm{mV})\\sqrt{1 + 0.2^2}}{(20\\,\\mathrm{mV})(1-0.2)} = \\frac{125\\sqrt{1.04}}{16}\\,\\mathrm{ps} \\approx \\frac{125 \\times 1.0198}{16}\\,\\mathrm{ps} \\approx 7.9672\\,\\mathrm{ps}\n$$\n总时间分辨率为：\n$$\n\\sigma_{t, \\text{CFD}} = \\sqrt{(7.9672\\dots)^2 + 5^2 + 12^2}\\,\\mathrm{ps} = \\sqrt{63.476\\dots + 25 + 144}\\,\\mathrm{ps} = \\sqrt{232.476\\dots}\\,\\mathrm{ps} \\approx 15.2472\\,\\mathrm{ps}\n$$\n四舍五入到四位有效数字，$\\sigma_{t, \\text{CFD}} = 15.25\\,\\mathrm{ps}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 15.44  15.25 \\end{pmatrix}}\n$$"
        }
    ]
}