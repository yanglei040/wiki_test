{
    "hands_on_practices": [
        {
            "introduction": "模拟复杂的粒子簇射过程，其核心在于精确追踪构成簇射的每一个粒子。最基本的问题是：一个粒子在与物质发生下一次相互作用之前会行进多远？本练习将引导你运用逆变换采样法——一种核心的蒙特卡洛技术——来模拟这一随机过程，这是构建详细簇射模拟程序的基石 。",
            "id": "3533651",
            "problem": "一个带电粒子在穿过均匀量能器材料时会经历随机相互作用，这可以建模为关于路径长度的一维泊松过程。设该材料的微观截面为 $\\sigma$（单位 $\\mathrm{cm}^2$），数密度为 $n$（单位 $\\mathrm{cm}^{-3}$）。宏观相互作用系数为 $\\mu = n \\sigma$（单位 $\\mathrm{cm}^{-1}$），平均自由程为 $\\lambda = 1/\\mu$（单位 $\\mathrm{cm}$）。在量能器簇射的蒙特卡洛（MC）模拟中，到下一次相互作用的自由路径长度是一个随机变量，它遵循由泊松过程所隐含的指数存活概率。\n\n从上述物理模型和基本定义出发，使用逆变换采样法推导自由路径长度的采样过程，该过程适用于由平均自由程 $\\lambda$ 参数化的指数分布。然后，你必须实现一个程序，对下面指定的每个测试用例，计算平均自由程 $\\lambda$，并根据逆变换采样法使用提供的均匀分布随机数 $u \\in (0,1)$ 生成两个自由路径长度。所有长度必须以厘米表示。\n\n你的程序必须处理以下测试套件，其中每个测试用例以 $(n,\\sigma,u_1,u_2)$ 的形式给出，$n$ 的单位为 $\\mathrm{cm}^{-3}$，$\\sigma$ 的单位为 $\\mathrm{cm}^2$，$u_1,u_2$ 无单位：\n- 测试用例1（一般情况）：$n = 5 \\times 10^{22}$，$\\sigma = 2 \\times 10^{-24}$，$u_1 = 0.2$，$u_2 = 0.8$。\n- 测试用例2（罕见长步长边缘情况）：$n = 1 \\times 10^{23}$，$\\sigma = 1 \\times 10^{-23}$，$u_1 = 1 \\times 10^{-12}$，$u_2 = 0.5$。\n- 测试用例3（$u$ 接近1的精度边缘情况）：$n = 1 \\times 10^{23}$，$\\sigma = 1 \\times 10^{-26}$，$u_1 = 0.999999$，$u_2 = 0.999$。\n- 测试用例4（短平均自由程情况）：$n = 8 \\times 10^{22}$，$\\sigma = 3 \\times 10^{-23}$，$u_1 = 0.1$，$u_2 = 0.5$。\n\n对每个测试用例，计算：\n1. 平均自由程 $\\lambda$（单位 $\\mathrm{cm}$）。\n2. 分别使用 $u_1$ 和 $u_2$ 通过逆变换采样法得到的两个自由路径长度样本 $\\ell_1$ 和 $\\ell_2$（单位 $\\mathrm{cm}$）。\n\n输出规格：\n- 将每个数值结果四舍五入至六位小数。\n- 你的程序应生成单行输出，其中包含所有测试用例按顺序连接的结果，形式为方括号括起来的逗号分隔列表。每个测试用例的顺序为：[$\\lambda, \\ell_1, \\ell_2$]，并跨四个测试用例进行连接。例如：[$\\lambda_1, \\ell_{1,1}, \\ell_{1,2}, \\lambda_2, \\ell_{2,1}, \\ell_{2,2}, \\ldots$]。",
            "solution": "用户想要解决一个物理问题。\n用户希望我执行以下操作：\n1.  **验证问题**：检查问题是否科学合理、适定、客观和完整。\n2.  **推导解法**：如果问题有效，推导用于对自由路径长度进行采样的数学公式。\n3.  **实现解法**：编写一个 Python 程序来计算给定测试用例的结果。\n\n### 问题验证\n\n我将首先根据说明验证问题陈述。\n\n#### 步骤1：提取已知信息\n\n*   **物理模型**：粒子相互作用被建模为关于路径长度的一维泊松过程。\n*   **定义**：\n    *   微观截面：$\\sigma$，单位 $\\mathrm{cm}^2$。\n    *   靶粒子数密度：$n$，单位 $\\mathrm{cm}^{-3}$。\n    *   宏观相互作用系数（或线性衰减系数）：$\\mu = n \\sigma$，单位 $\\mathrm{cm}^{-1}$。\n    *   平均自由程：$\\lambda = 1/\\mu$，单位 $\\mathrm{cm}$。\n*   **任务**：使用逆变换采样法推导自由路径长度 $\\ell$ 的采样过程。\n*   **随机数**：提供均匀随机数 $u \\in (0,1)$。\n*   **测试用例**（以 $(n, \\sigma, u_1, u_2)$ 形式给出）：\n    1.  测试用例1：$(5 \\times 10^{22} \\, \\mathrm{cm}^{-3}, 2 \\times 10^{-24} \\, \\mathrm{cm}^2, 0.2, 0.8)$\n    2.  测试用例2：$(1 \\times 10^{23} \\, \\mathrm{cm}^{-3}, 1 \\times 10^{-23} \\, \\mathrm{cm}^2, 1 \\times 10^{-12}, 0.5)$\n    3.  测试用例3：$(1 \\times 10^{23} \\, \\mathrm{cm}^{-3}, 1 \\times 10^{-26} \\, \\mathrm{cm}^2, 0.999999, 0.999)$\n    4.  测试用例4：$(8 \\times 10^{22} \\, \\mathrm{cm}^{-3}, 3 \\times 10^{-23} \\, \\mathrm{cm}^2, 0.1, 0.5)$\n*   **输出要求**：\n    *   对每个测试用例，计算 $\\lambda$、$\\ell_1$ 和 $\\ell_2$。\n    *   将所有结果四舍五入至六位小数。\n    *   生成单行输出：$[\\lambda_1,\\ell_{1,1},\\ell_{1,2},\\lambda_2,\\ell_{2,1},\\ell_{2,2},\\ldots]$。\n\n#### 步骤2：使用提取的已知信息进行验证\n\n*   **科学性（关键）**：该问题在根本上是合理的。使用恒定的宏观截面（$\\mu$）来描述粒子相互作用概率是一个标准的物理模型。这直接导出了在给定路径长度上的相互作用次数服从泊松过程，并因此推导出两次相互作用之间的自由路径长度服从指数分布。关系式 $\\mu = n \\sigma$ 在材料科学和粒子物理学中是一个定义性恒等式。逆变换采样法是蒙特卡洛方法中一种标准的、数学上严谨的技术。所有前提在物理学和计算科学中都是公认的。\n*   **适定性**：问题是适定的。它提供了所有必要信息（物理模型、定义、输入数据）以唯一确定所需的输出。采样公式的推导及其在给定测试用例上的应用会得出一组唯一的、确定性的结果。\n*   **客观性（关键）**：问题以精确、客观和量化的术语陈述。没有主观因素或歧义。术语定义清晰，所需计算的规定没有偏见。\n\n该问题没有表现出验证标准中列出的任何缺陷。数据值对于凝聚态物质和辐射相互作用在物理上是合理的。为均匀分布随机数（$u$ 接近 $0$ 和 $u$ 接近 $1$）选择的边缘情况很好地测试了采样公式在其极限处的数值行为，这是一个精心设计的计算问题的标志。\n\n#### 步骤3：结论与行动\n\n问题是**有效的**。我现在将继续进行解答。\n\n### 推导与解法\n\n该问题要求推导在均匀介质中粒子自由路径长度 $\\ell$ 的采样方法。其基本物理模型是支配相互作用的泊松过程。\n\n$1$. **自由路径长度的概率分布**\n宏观相互作用系数 $\\mu$ 表示粒子在单位路径长度上发生相互作用的恒定概率。对于一个已经行进了距离 $x$ 的粒子，它在下一个无穷小区间 $dx$ 内发生相互作用的概率是 $\\mu dx$。它在该区间内*不*发生相互作用的概率是 $1 - \\mu dx$。\n\n粒子行进至少距离 $x$ 而不发生相互作用的概率 $P(x)$（即存活概率）可以通过将路径视为一系列无穷小步长来找到。存活到 $x+dx$ 的概率是存活到 $x$ 的概率与在 $dx$ 内不发生相互作用的概率的乘积：\n$$ P(x+dx) = P(x) (1 - \\mu dx) $$\n整理可得：\n$$ \\frac{P(x+dx) - P(x)}{dx} = - \\mu P(x) $$\n当 $dx \\to 0$ 时取极限，我们得到微分方程：\n$$ \\frac{dP(x)}{dx} = - \\mu P(x) $$\n在边界条件为距离 $0$ 处的存活概率为 $1$（即 $P(0)=1$）的情况下，该方程的解是指数衰减函数：\n$$ P(x) = e^{-\\mu x} $$\n这个函数也被称为存活函数 $S(x)$。\n\n我们关心的随机变量是到*第一次*相互作用的路径长度 $\\ell$。累积分布函数（CDF）$F(\\ell)$ 给出了相互作用发生在路径长度小于或等于 $\\ell$ 处的概率。这等价于 $1$ 减去存活超过长度 $\\ell$ 的概率：\n$$ F(\\ell) = 1 - S(\\ell) = 1 - e^{-\\mu \\ell} $$\n概率密度函数（PDF）$p(\\ell)$ 是累积分布函数的导数：\n$$ p(\\ell) = \\frac{dF(\\ell)}{d\\ell} = \\mu e^{-\\mu \\ell}, \\quad \\text{for } \\ell \\ge 0 $$\n这是率参数为 $\\mu$ 的指数分布。该分布的均值确实是 $1/\\mu$，这与平均自由程 $\\lambda$ 的定义是一致的。\n\n$2$. **逆变换采样法**\n逆变换采样法是一种从任何其累积分布函数（CDF）的反函数已知的概率分布中生成随机样本的过程。该方法通过从区间 $(0, 1)$ 上的标准均匀分布中生成一个随机数 $u$，然后计算样本 $\\ell$：\n$$ \\ell = F^{-1}(u) $$\n其中 $F^{-1}$ 是CDF的反函数。\n\n为了求 $F^{-1}$，我们设 $F(\\ell) = u$ 并解出 $\\ell$：\n$$ u = 1 - e^{-\\mu \\ell} $$\n$$ e^{-\\mu \\ell} = 1 - u $$\n对两边取自然对数：\n$$ \\ln(e^{-\\mu \\ell}) = \\ln(1 - u) $$\n$$ -\\mu \\ell = \\ln(1 - u) $$\n$$ \\ell = -\\frac{1}{\\mu} \\ln(1 - u) $$\n由于平均自由程定义为 $\\lambda = 1/\\mu$，采样公式变为：\n$$ \\ell = -\\lambda \\ln(1 - u) $$\n一个常见且等效的简化是基于这样一个性质：如果 $u$ 是一个在 $(0, 1)$ 上均匀分布的随机变量，那么随机变量 $u' = 1 - u$ 也在 $(0, 1)$ 上均匀分布。因此，我们可以在公式中用 $u$ 替代 $1 - u$，从而得到更直接的表达式：\n$$ \\ell = -\\lambda \\ln(u) $$\n这种形式因其简单性以及与存活函数（$S(\\ell) = u$）的直接联系而在蒙特卡洛模拟中被广泛使用。我们将在计算中使用这种形式。\n\n$3$. **计算算法**\n对于每个由元组 $(n, \\sigma, u_1, u_2)$ 给出的测试用例：\na. 计算宏观相互作用系数：$\\mu = n \\sigma$。\nb. 计算平均自由程：$\\lambda = 1/\\mu$。\nc. 使用 $u_1$ 采样第一个自由路径长度：$\\ell_1 = -\\lambda \\ln(u_1)$。\nd. 使用 $u_2$ 采样第二个自由路径长度：$\\ell_2 = -\\lambda \\ln(u_2)$。\ne. 将 $\\lambda$、$\\ell_1$ 和 $\\ell_2$ 四舍五入至六位小数并存储结果。\n\n此过程将应用于所有四个测试用例，以生成最终的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mean free path and samples free path lengths for a set of\n    test cases based on the inverse transform sampling method for an\n    exponential distribution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n, sigma, u1, u2)\n    # n: number density in cm^-3\n    # sigma: microscopic cross section in cm^2\n    # u1, u2: uniform random variates in (0,1)\n    test_cases = [\n        (5e22, 2e-24, 0.2, 0.8),\n        (1e23, 1e-23, 1e-12, 0.5),\n        (1e23, 1e-26, 0.999999, 0.999),\n        (8e22, 3e-23, 0.1, 0.5),\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        n, sigma, u1, u2 = case\n        \n        # 1. Calculate the macroscopic interaction coefficient (mu)\n        mu = n * sigma\n        \n        # 2. Calculate the mean free path (lambda)\n        lambda_val = 1.0 / mu\n        \n        # 3. Sample two free path lengths (l1, l2) using inverse transform sampling\n        # The formula is l = -lambda * ln(u)\n        l1 = -lambda_val * np.log(u1)\n        l2 = -lambda_val * np.log(u2)\n        \n        # Append the rounded results to the list\n        # The output format requires 6 decimal places.\n        results.append(f\"{lambda_val:.6f}\")\n        results.append(f\"{l1:.6f}\")\n        results.append(f\"{l2:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了如何模拟单个粒子步长后，我们需要对形成簇射的集体行为进行建模。簇射的横向尺寸是一个关键特征。本练习将探讨簇射中的粒子经历的多次小角度库仑散射如何累积并导致宏观上的横向展宽，从而将一个基本的电磁过程与量能器设计中的一个关键可观测量联系起来 。",
            "id": "3533635",
            "problem": "一个能量为 $E=5\\,\\mathrm{GeV}$ 的超相对论性电子进入一个均匀的铅电磁量能器。该材料的辐射长度为 $X_0=0.56\\,\\mathrm{cm}$。在量能器响应的一个计算模型中，电子因多重库仑散射引起的角度偏转被近似为一个与 Molière 理论一致的高斯过程，其在深度 $x$ 处的特征均方根 (RMS) 投影散射角由经过充分检验的 Highland 参数化方法及其标准对数修正来描述。假设 $x=1\\,\\mathrm{cm}$，在此步长内忽略能量损失，取速度参数为 $\\beta \\approx 1$，并使用 $p \\approx E/c$ 作为动量。\n\n从小角度多重散射可被视为角扩散，且横向位移源于瞬时角度的路径积分这一建模前提出发，推导在深度 $x$ 处的横向 RMS 位移 $y_{\\mathrm{rms}}$ 关于 $x$ 和 RMS 投影散射角 $\\theta_0(x)$ 的表达式，然后计算其在 $x=1\\,\\mathrm{cm}$ 处的值。使用 Highland 参数化方法计算 $\\theta_0$ 在 $x=1\\,\\mathrm{cm}$ 处的数值，并使用你推导的关系式计算 $y_{\\mathrm{rms}}$ 的值。将你的答案四舍五入到四位有效数字。将 $\\theta_0$ 以弧度表示，将 $y_{\\mathrm{rms}}$ 以厘米表示。",
            "solution": "问题陈述具有科学依据，提法恰当且客观。它基于粒子与物质相互作用的既定原理，特别是多重库仑散射。所有必要的数据和明确定义的物理近似都已提供，这使得问题有唯一且有意义的解。因此，我们开始进行求解。\n\n该任务分为两部分：首先，推导均方根 (RMS) 横向位移 $y_{\\mathrm{rms}}$ 关于深度 $x$ 和 RMS 投影散射角 $\\theta_0(x)$ 的表达式；其次，在指定深度处对 $\\theta_0(x)$ 和 $y_{\\mathrm{rms}}(x)$ 进行数值计算。\n\n第 1 部分：推导 RMS 横向位移 $y_{\\mathrm{rms}}(x)$\n\n我们考虑一个最初沿某一轴线（我们称之为纵向）运动的粒子。问题中使用 $x$ 作为深度的符号，因此我们将遵循此约定。在深度 $x$ 处，横向平面（例如 $y$-平面）内的横向位移记为 $y(x)$。在小角度近似下（该近似适用于高能粒子的多重库仑散射），横向位移是相对于初始方向的投影角 $\\theta_y(x')$ 的路径积分：\n$$ y(x) = \\int_0^x \\theta_y(x') dx' $$\n其中 $x'$ 是代表深度的积分变量。\n\nRMS 位移 $y_{\\mathrm{rms}}$ 定义为位移平方 $y(x)^2$ 的期望值（或系综平均，用 $\\langle \\dots \\rangle$ 表示）的平方根：\n$$ y_{\\mathrm{rms}}^2(x) = \\langle y(x)^2 \\rangle = \\left\\langle \\left( \\int_0^x \\theta_y(x') dx' \\right)^2 \\right\\rangle $$\n通过将积分的平方写成一个二重积分，并将期望算符移到积分内部，我们得到：\n$$ \\langle y(x)^2 \\rangle = \\int_0^x dx' \\int_0^x dx'' \\langle \\theta_y(x') \\theta_y(x'') \\rangle $$\n项 $\\langle \\theta_y(x') \\theta_y(x'') \\rangle$ 表示在两个不同深度处投影角的相关性。问题的前提是散射被处理为角扩散，这是一个马尔可夫过程。这意味着在不重叠的路径段上的角度偏转是统计独立的。我们假设 $x' \\le x''$。深度 $x''$ 处的角度是深度 $x'$ 处的角度与在 $x'$ 和 $x''$ 之间累积的后续角度偏转之和，即 $\\theta_y(x'') = \\theta_y(x') + \\Delta\\theta_y(x', x'')$。于是相关函数变为：\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(x') (\\theta_y(x') + \\Delta\\theta_y(x', x'')) \\rangle = \\langle \\theta_y(x')^2 \\rangle + \\langle \\theta_y(x') \\Delta\\theta_y(x', x'') \\rangle $$\n由于散射过程是马尔可夫性的，角度增量 $\\Delta\\theta_y(x', x'')$ 与角度 $\\theta_y(x')$ 无关。此外，平均角度为零，$\\langle \\theta_y(x') \\rangle = \\langle \\Delta\\theta_y(x', x'') \\rangle = 0$。因此，交叉项为零：$\\langle \\theta_y(x') \\Delta\\theta_y(x', x'') \\rangle = \\langle \\theta_y(x') \\rangle \\langle \\Delta\\theta_y(x', x'') \\rangle = 0$。\n这就将 $x' \\le x''$ 时的相关函数简化为在较浅深度 $x'$ 处角度的方差：\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(x')^2 \\rangle $$\n更一般地，对于任意两个深度 $x'$ 和 $x''$，相关性由两个深度中较小者处的方差给出：\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(\\min(x', x''))^2 \\rangle $$\n为了推导函数形式，我们使用多重散射的基本模型（按要求忽略能量损失），在该模型中，投影角的方差随深度线性增长，即 $\\langle \\theta_y(x')^2 \\rangle \\propto x'$。已知 $\\theta_0(x)$ 是深度 $x$ 处的 RMS 角，因此 $\\theta_0(x)^2 = \\langle \\theta_y(x)^2 \\rangle$。这使我们能够用最终深度 $x$ 处的方差来表示中间深度 $x'$ 处的方差：\n$$ \\langle \\theta_y(x')^2 \\rangle = \\theta_0(x')^2 \\approx \\frac{x'}{x} \\theta_0(x)^2 $$\n将此代入 $\\langle y(x)^2 \\rangle$ 的积分中：\n$$ \\langle y(x)^2 \\rangle = \\int_0^x dx' \\int_0^x dx'' \\frac{\\min(x', x'')}{x} \\theta_0(x)^2 $$\n在方形区域 $[0,x] \\times [0,x]$ 上的积分可以利用被积函数的对称性来简化。它等于在 $x' \\le x''$ 的三角形区域上积分的两倍：\n$$ \\langle y(x)^2 \\rangle = 2 \\int_0^x dx'' \\int_0^{x''} dx' \\frac{x'}{x} \\theta_0(x)^2 $$\n我们先对 $x'$ 进行内层积分：\n$$ \\int_0^{x''} \\frac{x'}{x} \\theta_0(x)^2 dx' = \\frac{\\theta_0(x)^2}{x} \\left[ \\frac{x'^2}{2} \\right]_0^{x''} = \\frac{\\theta_0(x)^2}{2x} (x'')^2 $$\n接下来，我们对 $x''$ 进行外层积分：\n$$ \\langle y(x)^2 \\rangle = 2 \\int_0^x \\frac{\\theta_0(x)^2}{2x} (x'')^2 dx'' = \\frac{\\theta_0(x)^2}{x} \\int_0^x (x'')^2 dx'' = \\frac{\\theta_0(x)^2}{x} \\left[ \\frac{(x'')^3}{3} \\right]_0^x = \\frac{\\theta_0(x)^2}{x} \\frac{x^3}{3} = \\frac{1}{3} x^2 \\theta_0(x)^2 $$\n取平方根得到 RMS 横向位移的最终表达式：\n$$ y_{\\mathrm{rms}}(x) = \\sqrt{\\frac{1}{3} x^2 \\theta_0(x)^2} = \\frac{x \\theta_0(x)}{\\sqrt{3}} $$\n\n第 2 部分：数值计算\n\n我们现在计算在 $x = 1\\,\\mathrm{cm}$ 处 $\\theta_0(x)$ 和 $y_{\\mathrm{rms}}(x)$ 的数值。RMS 投影散射角的 Highland 参数化公式为：\n$$ \\theta_0 = \\frac{13.6\\,\\mathrm{MeV}}{\\beta c p} z \\sqrt{\\frac{x}{X_0}} \\left[ 1 + 0.038 \\ln\\left(\\frac{x}{X_0}\\right) \\right] $$\n给定参数如下：\n- 粒子：电子 ($z=1$)。\n- 能量：$E = 5\\,\\mathrm{GeV} = 5000\\,\\mathrm{MeV}$。\n- 近似：$\\beta \\approx 1$ 且 $pc \\approx E = 5000\\,\\mathrm{MeV}$。\n- 深度：$x = 1\\,\\mathrm{cm}$。\n- 辐射长度：$X_0 = 0.56\\,\\mathrm{cm}$。\n\n首先，我们计算比值 $x/X_0$：\n$$ \\frac{x}{X_0} = \\frac{1\\,\\mathrm{cm}}{0.56\\,\\mathrm{cm}} = \\frac{1}{0.56} \\approx 1.785714 $$\n将数值代入 $\\theta_0$ 的公式中：\n$$ \\theta_0 \\approx \\frac{13.6\\,\\mathrm{MeV}}{5000\\,\\mathrm{MeV}} (1) \\sqrt{\\frac{1}{0.56}} \\left[ 1 + 0.038 \\ln\\left(\\frac{1}{0.56}\\right) \\right] $$\n$$ \\theta_0 \\approx 0.00272 \\times \\sqrt{1.785714...} \\times [1 + 0.038 \\ln(1.785714...)] $$\n$$ \\theta_0 \\approx 0.00272 \\times 1.336306... \\times [1 + 0.038 \\times (0.579818...)] $$\n$$ \\theta_0 \\approx 0.00363475... \\times [1 + 0.022033...] $$\n$$ \\theta_0 \\approx 0.00363475... \\times 1.022033... \\approx 0.00371483\\,\\mathrm{rad} $$\n四舍五入到四位有效数字，我们得到 RMS 投影角：\n$$ \\theta_0(x=1\\,\\mathrm{cm}) \\approx 0.003715\\,\\mathrm{rad} $$\n接下来，我们使用推导出的表达式计算在 $x = 1\\,\\mathrm{cm}$ 处的 RMS 横向位移 $y_{\\mathrm{rms}}$，为获得更高精度，我们使用未四舍五入的 $\\theta_0$ 值：\n$$ y_{\\mathrm{rms}}(1\\,\\mathrm{cm}) = \\frac{(1\\,\\mathrm{cm}) \\times \\theta_0(1\\,\\mathrm{cm})}{\\sqrt{3}} \\approx \\frac{1 \\times 0.00371483...}{\\sqrt{3}} $$\n$$ y_{\\mathrm{rms}}(1\\,\\mathrm{cm}) \\approx \\frac{0.00371483...}{1.7320508...}\\,\\mathrm{cm} \\approx 0.00214476\\,\\mathrm{cm} $$\n四舍五入到四位有效数字，我们得到 RMS 横向位移：\n$$ y_{\\mathrm{rms}}(x=1\\,\\mathrm{cm}) \\approx 0.002145\\,\\mathrm{cm} $$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.003715 & 0.002145 \\end{pmatrix}}$$"
        },
        {
            "introduction": "如果没有对探测器如何响应簇射沉积能量的建模，那么模拟就是不完整的。本练习聚焦于探测器响应的一个关键方面：沉积能量到可测量信号（光电子）的转换过程，以及其中固有的统计涨落。通过推导能量分辨率中著名的随机项，你将理解限制采样量能器测量精度的主要物理因素 。",
            "id": "3533695",
            "problem": "在高能物理（HEP）中使用的采样量能器的快速模拟中，对入射的强子或电磁簇射的响应是通过将闪烁光转换为光电子计数从而估算能量来建模的。考虑一个理想化的铅-闪烁体采样量能器，其中总簇射能量 $E$ 的一部分（比例为 $f_s$）沉积在闪烁体层中。测量链被假定为线性的：闪烁体对每 $\\mathrm{GeV}$ 实际沉积在其中的能量平均产生 $N_{pe}$ 个光电子，并且能量估计量是根据所计数的总光电子构建的，以确保其无偏性。假设唯一的涨落来源是光电子计数统计，该过程遵循泊松过程。所有其他分辨率贡献（例如，采样非均匀性、上游泄漏、来自校准和非均匀性的常数项以及电子噪声）均可忽略不计。\n\n从泊松统计和线性响应的定义出发，推导仅由光电子统计涨落引起的分数能量分辨率。以此为基础，将随机系数 $a$ 定义为在量能器模拟中使用的正则参数化中，控制分数分辨率 $E^{-1/2}$ 标度的无量纲前置因子，其中 $E$ 以 $\\mathrm{GeV}$ 为单位。然后，对于一个以 $f_s = 0.3$ 和 $N_{pe} = 2000/\\mathrm{GeV}$ 为特征的铅-闪烁体量能器，在上述假设下，计算 $a$ 并预测在 $E = 50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\sigma_E/E$。\n\n将你的答案四舍五入到四位有效数字。将 $a$ 和 $\\sigma_E/E$ 均表示为无量纲小数。",
            "solution": "问题要求在给定一组参数的情况下，推导理想采样量能器的随机系数和分数能量分辨率。根据协议，第一步是验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 系统是一个理想化的铅-闪烁体采样量能器。\n- $f_s$：总簇射能量 $E$ 中沉积在闪烁体层内的比例。\n- $E$：总簇射能量。\n- 测量链是线性的。\n- $N_{pe}$：每 $\\mathrm{GeV}$ 沉积在闪烁体中的能量所产生的平均光电子数。\n- 能量估计量是无偏的。\n- 涨落仅由遵循泊松过程的光电子计数统计引起。\n- 所有其他分辨率贡献均可忽略不计。\n- 随机系数 $a$ 是分数分辨率 $E^{-1/2}$ 标度的无量纲前置因子，其中 $E$ 的单位为 $\\mathrm{GeV}$。\n- 特定情况：$f_s = 0.3$。\n- 特定情况：$N_{pe} = 2000/\\mathrm{GeV}$。\n- 分数分辨率 $\\sigma_E/E$ 需要在 $E = 50\\,\\mathrm{GeV}$ 时计算。\n- 最终数值答案必须四舍五入到四位有效数字，并表示为无量纲小数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题使用了量能器分辨率的标准简化模型。光电子产生的泊松统计假设是闪烁探测器物理学的基石。用一个按 $E^{-1/2}$ 标度的随机项来参数化能量分辨率，在高能物理和核物理中是正则做法。该问题在根本上是合理的。\n- **适定性**：所有必需的变量（$f_s, N_{pe}$）和条件（泊松统计、线性和无偏估计量）都已提供，可以推导出所求量（$a$ 和 $\\sigma_E/E$）的唯一解。\n- **客观性**：问题陈述使用了粒子物理仪器领域常见的精确技术语言，没有主观或含糊不清的术语。\n\n**步骤3：结论与行动**\n该问题具有科学依据、适定性、客观性，并且没有可识别的缺陷。因此，它被判定为**有效**。现在将推导解答。\n\n### 推导与求解\n\n设 $E$ 为粒子的总入射能量。沉积在活性闪烁体层中的能量 $E_{\\text{scint}}$ 是总能量的一小部分，比例为 $f_s$：\n$$\nE_{\\text{scint}} = f_s E\n$$\n闪烁体以每单位沉积能量 $N_{pe}$ 的产额产生光电子。因此，对于给定的簇射，光电子的平均数 $\\langle n \\rangle$ 为：\n$$\n\\langle n \\rangle = N_{pe} E_{\\text{scint}} = N_{pe} f_s E\n$$\n问题陈述光电子的产生遵循泊松过程。泊松分布的一个基本性质是其方差等于其均值。因此，光电子数目的方差 $\\sigma_n^2$ 为：\n$$\n\\sigma_n^2 = \\langle n \\rangle = N_{pe} f_s E\n$$\n光电子计数的标准差是方差的平方根：\n$$\n\\sigma_n = \\sqrt{N_{pe} f_s E}\n$$\n能量估计量 $\\hat{E}$ 是根据测得的光电子数 $n$ 构建的。它被指定为线性和无偏的。设估计量的形式为 $\\hat{E} = C \\cdot n$，其中 $C$ 是一个校准常数。无偏条件要求估计量的期望值等于真实能量，即 $\\langle \\hat{E} \\rangle = E$。\n$$\n\\langle \\hat{E} \\rangle = \\langle C \\cdot n \\rangle = C \\langle n \\rangle\n$$\n代入 $\\langle n \\rangle$ 的表达式：\n$$\n\\langle \\hat{E} \\rangle = C (N_{pe} f_s E)\n$$\n为使其无偏，我们必须有 $C (N_{pe} f_s E) = E$，由此可得校准常数为：\n$$\nC = \\frac{1}{N_{pe} f_s}\n$$\n因此，总能量的估计量为 $\\hat{E} = \\frac{n}{N_{pe} f_s}$。能量测量的不确定度 $\\sigma_E$ 是该估计量的标准差。方差 $\\sigma_E^2$ 可通过标准误差传播求得：\n$$\n\\sigma_E^2 = \\text{Var}(\\hat{E}) = \\text{Var}\\left(\\frac{n}{N_{pe} f_s}\\right) = \\left(\\frac{1}{N_{pe} f_s}\\right)^2 \\text{Var}(n) = \\frac{\\sigma_n^2}{(N_{pe} f_s)^2}\n$$\n代入 $\\sigma_n^2 = N_{pe} f_s E$：\n$$\n\\sigma_E^2 = \\frac{N_{pe} f_s E}{(N_{pe} f_s)^2} = \\frac{E}{N_{pe} f_s}\n$$\n能量分辨率为 $\\sigma_E = \\sqrt{\\frac{E}{N_{pe} f_s}}$。分数能量分辨率为 $\\frac{\\sigma_E}{E}$：\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{E} \\sqrt{\\frac{E}{N_{pe} f_s}} = \\sqrt{\\frac{E}{E^2 N_{pe} f_s}} = \\frac{1}{\\sqrt{E \\cdot N_{pe} f_s}}\n$$\n该表达式展示了随机项的 $E^{-1/2}$ 标度特性。正则参数化形式为 $\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E}}$，其中 $E$ 以 $\\mathrm{GeV}$ 表示，而 $a$ 是一个无量纲系数。为了使此比较严谨，设 $E_{\\text{GeV}}$ 是以 $\\mathrm{GeV}$ 为单位的能量数值，$\\mathcal{N}_{pe}$ 是以 $(\\mathrm{GeV})^{-1}$ 为单位的 $N_{pe}$ 的数值。我们推导出的方程是：\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{\\sqrt{E_{\\text{GeV}} \\cdot \\mathcal{N}_{pe} \\cdot f_s}} = \\frac{1}{\\sqrt{\\mathcal{N}_{pe} f_s}} \\frac{1}{\\sqrt{E_{\\text{GeV}}}}\n$$\n将此与 $\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E_{\\text{GeV}}}}$ 进行比较，我们可以确定随机系数 $a$：\n$$\na = \\frac{1}{\\sqrt{\\mathcal{N}_{pe} f_s}}\n$$\n使用给定值 $\\mathcal{N}_{pe} = 2000$ 和 $f_s = 0.3$：\n$$\na = \\frac{1}{\\sqrt{2000 \\times 0.3}} = \\frac{1}{\\sqrt{600}} = \\frac{1}{10\\sqrt{6}} \\approx 0.0408248\n$$\n四舍五入到四位有效数字，随机系数为 $a = 0.04082$。$a$ 的单位隐含为 $\\sqrt{\\mathrm{GeV}}$，但问题要求的是无量纲前置因子，也就是这个数值。\n\n接下来，我们计算能量为 $E = 50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\frac{\\sigma_E}{E}$。我们使用推导出的公式，其中 $E_{\\text{GeV}} = 50$：\n$$\n\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E_{\\text{GeV}}}} = \\frac{0.0408248...}{\\sqrt{50}}\n$$\n或者，使用完整表达式：\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{\\sqrt{E_{\\text{GeV}} \\cdot \\mathcal{N}_{pe} \\cdot f_s}} = \\frac{1}{\\sqrt{50 \\times 2000 \\times 0.3}} = \\frac{1}{\\sqrt{30000}} = \\frac{1}{100\\sqrt{3}} \\approx 0.0057735\n$$\n四舍五入到四位有效数字，在 $50\\,\\mathrm{GeV}$ 时的分数分辨率为 $\\frac{\\sigma_E}{E} = 0.005774$。\n\n两个所求值分别是随机系数 $a$ 和在 $E=50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\frac{\\sigma_E}{E}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.04082 & 0.005774 \\end{pmatrix}}\n$$"
        }
    ]
}