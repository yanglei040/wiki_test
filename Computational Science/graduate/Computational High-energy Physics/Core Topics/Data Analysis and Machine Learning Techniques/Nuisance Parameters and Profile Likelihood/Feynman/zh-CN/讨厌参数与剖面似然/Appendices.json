{
    "hands_on_practices": [
        {
            "introduction": "这个首个练习旨在建立剖析（profiling）的抽象定义与具体计算之间的基本联系。通过处理一个简单的二次对数似然函数，你将分析性地证明，对讨厌参数进行最大化等价于求解一个线性方程，从而将其从模型中“剖析掉”。",
            "id": "3524873",
            "problem": "在一个简化的计算高能物理（HEP）信号强度拟合中，考虑一个对感兴趣的参数 $\\mu$（信号强度）和单个讨厌参数 $\\theta$（本底归一化）的双参数对数似然近似，该近似是通过在全局最大值点附近的二阶泰勒展开获得的。该对数似然被建模为一个严格凹的二次型，形式如下\n$$\n\\ell(\\mu,\\theta) \\equiv \\ln L(\\mu,\\theta) \\;=\\; -\\frac{1}{2}\\left[a\\,\\mu^{2} + 2 b\\,\\mu\\,\\theta + c\\,\\theta^{2}\\right] \\;+\\; s\\,\\mu \\;+\\; t\\,\\theta \\;+\\; k,\n$$\n其中 $a$、$b$、$c$、$s$、$t$ 和 $k$ 是由数据和似然函数的局部曲率决定的实常数；这些常数满足 $c>0$ 和 $a c - b^{2} > 0$，以使该二次型在 $(\\mu,\\theta)$ 上是严格凹的。$\\mu$ 的剖面似然由最大似然估计中剖面化的基本定义给出：\n$$\n\\tilde{L}(\\mu) \\;=\\; \\max_{\\theta} \\, L(\\mu,\\theta) \\;=\\; \\exp\\!\\left(\\max_{\\theta}\\, \\ell(\\mu,\\theta)\\right).\n$$\n仅使用上述定义和凹函数优化的标准微积分方法，证明剖面化等同于通过求解从 $\\partial \\ell/\\partial \\theta = 0$ 得到的正规方程来消去 $\\theta$，并推导剖面似然 $\\tilde{L}(\\mu)$ 作为 $\\mu$ 和常数 $a$、$b$、$c$、$s$、$t$ 和 $k$ 的函数的闭式表达式。以闭式形式给出 $\\tilde{L}(\\mu)$ 的最终表达式。你的最终答案必须是单一的解析表达式。不包括单位。不要四舍五入。",
            "solution": "问题是为关于感兴趣的参数 $\\mu$ 和讨厌参数 $\\theta$ 呈二次型的二元对数似然函数 $\\ell(\\mu, \\theta)$ 推导剖面似然 $\\tilde{L}(\\mu)$ 的闭式表达式。\n\n给出的对数似然函数为：\n$$\n\\ell(\\mu,\\theta) = -\\frac{1}{2}\\left[a\\,\\mu^{2} + 2 b\\,\\mu\\,\\theta + c\\,\\theta^{2}\\right] + s\\,\\mu + t\\,\\theta + k\n$$\n这些常数满足 $c>0$ 和 $a c - b^{2} > 0$，这确保了该二次型是严格凹的，意味着该函数有一个唯一的全局最大值。\n\n$\\mu$ 的剖面似然，记作 $\\tilde{L}(\\mu)$，定义为在固定 $\\mu$ 值的情况下，对讨厌参数 $\\theta$ 的空间进行最大化后的似然函数：\n$$\n\\tilde{L}(\\mu) = \\max_{\\theta} L(\\mu,\\theta)\n$$\n因为自然对数是严格单调递增函数，所以最大化似然函数 $L(\\mu,\\theta)$ 等价于最大化对数似然函数 $\\ell(\\mu,\\theta) = \\ln L(\\mu,\\theta)$。因此，我们可以写出：\n$$\n\\tilde{L}(\\mu) = \\exp\\left(\\max_{\\theta} \\ell(\\mu,\\theta)\\right)\n$$\n我们将剖面对数似然定义为 $\\tilde{\\ell}(\\mu) = \\max_{\\theta} \\ell(\\mu,\\theta)$。我们的任务是首先找到 $\\tilde{\\ell}(\\mu)$。\n\n对于固定的 $\\mu$ 值，对数似然函数 $\\ell(\\mu,\\theta)$ 可以看作是仅关于 $\\theta$ 的函数：\n$$\n\\ell(\\theta | \\mu) = \\left(-\\frac{c}{2}\\right)\\theta^2 + (t - b\\mu)\\theta + \\left(-\\frac{a}{2}\\mu^2 + s\\mu + k\\right)\n$$\n这是一个关于 $\\theta$ 的二次函数。因为给定 $c > 0$，所以 $\\theta^2$ 项的系数 $-c/2$ 是负的。这证实了该函数是一个关于 $\\theta$ 的严格开口向下的抛物线，因此是严格凹的，并具有唯一的最大值。\n\n可微凹函数的最大值出现在其一阶导数为零的临界点。这就是最小二乘法和最大似然问题中“正规方程”的由来。这一步证明了剖面化过程等同于通过求解正规方程 $\\partial \\ell/\\partial \\theta = 0$ 来消去讨厌参数。\n\n我们计算 $\\ell(\\mu,\\theta)$ 关于 $\\theta$ 的偏导数：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(-\\frac{1}{2}a\\mu^2 - b\\mu\\theta - \\frac{1}{2}c\\theta^2 + s\\mu + t\\theta + k \\right)\n$$\n将 $\\mu$ 视为常数，我们得到：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta} = -b\\mu - c\\theta + t\n$$\n将此导数设为零，得到关于 $\\theta$ 的正规方程：\n$$\n-b\\mu - c\\theta + t = 0\n$$\n求解 $\\theta$ 可得到在给定 $\\mu$ 的情况下使 $\\ell$ 最大化的值。我们将这个 $\\theta$ 的条件最大似然估计量记作 $\\hat{\\hat{\\theta}}(\\mu)$：\n$$\nc\\theta = t - b\\mu \\implies \\hat{\\hat{\\theta}}(\\mu) = \\frac{t - b\\mu}{c}\n$$\n现在，我们通过将这个关于 $\\theta$ 的表达式代回原始的对数似然函数 $\\ell(\\mu,\\theta)$ 来找到剖面对数似然 $\\tilde{\\ell}(\\mu)$：\n$$\n\\tilde{\\ell}(\\mu) = \\ell(\\mu, \\hat{\\hat{\\theta}}(\\mu)) = -\\frac{1}{2}a\\mu^2 - b\\mu\\left(\\frac{t-b\\mu}{c}\\right) - \\frac{1}{2}c\\left(\\frac{t-b\\mu}{c}\\right)^2 + s\\mu + t\\left(\\frac{t-b\\mu}{c}\\right) + k\n$$\n我们现在进行代数展开和简化：\n$$\n\\tilde{\\ell}(\\mu) = -\\frac{a}{2}\\mu^2 - \\frac{bt\\mu - b^2\\mu^2}{c} - \\frac{c}{2}\\frac{t^2 - 2bt\\mu + b^2\\mu^2}{c^2} + s\\mu + \\frac{t^2 - bt\\mu}{c} + k\n$$\n$$\n\\tilde{\\ell}(\\mu) = -\\frac{a}{2}\\mu^2 - \\frac{bt\\mu}{c} + \\frac{b^2\\mu^2}{c} - \\frac{t^2 - 2bt\\mu + b^2\\mu^2}{2c} + s\\mu + \\frac{t^2}{c} - \\frac{bt\\mu}{c} + k\n$$\n为简化起见，让我们按 $\\mu$ 的幂次对各项进行分组：\n$\\mu^2$ 的系数：\n$$\n-\\frac{a}{2} + \\frac{b^2}{c} - \\frac{b^2}{2c} = -\\frac{a}{2} + \\frac{b^2}{2c} = \\frac{-ac + b^2}{2c} = -\\frac{ac - b^2}{2c}\n$$\n$\\mu$ 的系数：\n$$\ns - \\frac{bt}{c} + \\frac{2bt}{2c} - \\frac{bt}{c} = s - \\frac{2bt}{c} + \\frac{bt}{c} = s - \\frac{bt}{c} = \\frac{sc - bt}{c}\n$$\n常数项（与 $\\mu$ 无关）：\n$$\n-\\frac{t^2}{2c} + \\frac{t^2}{c} + k = \\frac{t^2}{2c} + k\n$$\n将这些项组合起来，得到剖面对数似然：\n$$\n\\tilde{\\ell}(\\mu) = -\\left(\\frac{ac - b^2}{2c}\\right)\\mu^2 + \\left(\\frac{sc - bt}{c}\\right)\\mu + \\left(k + \\frac{t^2}{2c}\\right)\n$$\n该表达式可以写在公分母 $2c$上：\n$$\n\\tilde{\\ell}(\\mu) = \\frac{-(ac-b^2)\\mu^2 + 2(sc-bt)\\mu + t^2 + 2ck}{2c}\n$$\n最后，剖面似然 $\\tilde{L}(\\mu)$ 是剖面对数似然 $\\tilde{\\ell}(\\mu)$ 的指数：\n$$\n\\tilde{L}(\\mu) = \\exp(\\tilde{\\ell}(\\mu)) = \\exp\\left( -\\frac{ac - b^2}{2c}\\mu^2 + \\left(s - \\frac{bt}{c}\\right)\\mu + k + \\frac{t^2}{2c} \\right)\n$$\n这就是所求的剖面似然的闭式表达式。",
            "answer": "$$\\boxed{\\exp\\left( -\\frac{ac - b^2}{2c}\\mu^2 + \\left(s - \\frac{bt}{c}\\right)\\mu + k + \\frac{t^2}{2c} \\right)}$$"
        },
        {
            "introduction": "从一个通用的二次型模型转向一个更真实的统计模型，本练习将探讨讨厌参数对测量精度的直接影响。你将在一个常见的高能物理场景中计算剖面费雪信息（profiled Fisher information），从而量化讨厌参数的不确定性如何削弱我们对目标参数可获得的信息。",
            "id": "3524856",
            "problem": "考虑高能物理测量中的两个统计独立的计数通道（或称区间），每个通道都由泊松分布建模。设区间 $i \\in \\{1,2\\}$ 中的期望计数为\n$$\nm_i(\\mu,\\theta) = \\mu\\, s_i\\,(1+\\theta) + b_i,\n$$\n其中 $\\mu \\ge 0$ 是我们感兴趣的信号强度参数，$s_i > 0$ 是单位强度下区间 $i$ 的已知信号产额模板，$b_i \\ge 0$ 是区间 $i$ 中的已知本底期望，$\\theta$ 是一个公共的乘性效率系统误差参数，由已知 $\\sigma_\\theta > 0$ 的高斯约束 $\\theta \\sim \\mathcal{N}(0,\\sigma_\\theta)$ 建模。观测到的计数 $n_i$ 是独立的，且 $n_i \\sim \\text{Poisson}(m_i(\\mu,\\theta))$。包含高斯约束的联合似然函数为\n$$\nL(\\mu,\\theta) \\;=\\; \\prod_{i=1}^{2} \\left[ \\frac{m_i(\\mu,\\theta)^{n_i}\\,\\exp\\!\\big(-m_i(\\mu,\\theta)\\big)}{n_i!} \\right] \\times \\exp\\!\\left(-\\frac{\\theta^2}{2\\,\\sigma_\\theta^2}\\right).\n$$\n\n在大样本（渐近）情况下，计算在真实参数值 $\\mu=\\mu_0>0$ 和 $\\theta=0$ 处关于 $\\mu$ 的剖面费雪信息 $I_{\\mu\\mu}^{\\text{prof}}$，使用从 Asimov 数据集导出的期望费雪信息（即，在计算期望时用 $m_i(\\mu_0,0)$ 替代 $n_i$）。\n\n请将您的最终结果表示为关于 $s_1, s_2, b_1, b_2, \\mu_0$ 和 $\\sigma_\\theta$ 的单个闭式解析表达式。\n\n最后，简要解释 $I_{\\mu\\mu}^{\\text{prof}}$ 如何依赖于 $\\sigma_\\theta$，包括极限情况 $\\sigma_\\theta \\to 0$ 和 $\\sigma_\\theta \\to \\infty$。\n\n你的最终答案必须是 $I_{\\mu\\mu}^{\\text{prof}}$ 的解析表达式。不需要进行数值计算。",
            "solution": "该问题提法清晰，具有科学依据，并为完整推导提供了所有必要信息。我们开始求解。\n\n目标是计算我们感兴趣的参数 $\\mu$ 的剖面费雪信息，记为 $I_{\\mu\\mu}^{\\text{prof}}$。这包括首先计算参数 $(\\mu, \\theta)$ 的完整的 $2 \\times 2$ 期望费雪信息矩阵，然后使用剖面化公式。\n\n联合对数似然函数 $\\ell(\\mu,\\theta) = \\ln L(\\mu,\\theta)$ 由下式给出：\n$$\n\\ell(\\mu,\\theta) = \\sum_{i=1}^{2} \\left[ n_i \\ln m_i(\\mu,\\theta) - m_i(\\mu,\\theta) - \\ln(n_i!) \\right] - \\frac{\\theta^2}{2\\sigma_\\theta^2}\n$$\n其中 $m_i(\\mu,\\theta) = \\mu s_i (1+\\theta) + b_i$。\n\n期望费雪信息矩阵 $I$ 的元素定义为 $I_{jk} = -E\\left[ \\frac{\\partial^2 \\ell}{\\partial \\phi_j \\partial \\phi_k} \\right]$，其中 $\\phi = (\\mu, \\theta)$。在渐近极限下，我们使用 Asimov 数据集，这意味着我们将观测计数 $n_i$ 替换为其期望值 $E[n_i] = m_i$。这极大地简化了计算。对数似然函数的二阶偏导数为：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\phi_j \\partial \\phi_k} = \\sum_{i=1}^{2} \\left[ -\\frac{n_i}{m_i^2} \\frac{\\partial m_i}{\\partial \\phi_j} \\frac{\\partial m_i}{\\partial \\phi_k} + \\left(\\frac{n_i}{m_i} - 1\\right) \\frac{\\partial^2 m_i}{\\partial \\phi_j \\partial \\phi_k} \\right] - \\frac{\\partial^2}{\\partial \\phi_j \\partial \\phi_k} \\left( \\frac{\\theta^2}{2\\sigma_\\theta^2} \\right)\n$$\n对于 Asimov 数据集，设 $n_i = m_i$，则 $(\\frac{n_i}{m_i} - 1)$ 项变为零。费雪信息矩阵的元素随后计算如下：\n$$\nI_{jk} = - \\left. \\frac{\\partial^2 \\ell}{\\partial \\phi_j \\partial \\phi_k} \\right|_{\\substack{n_i=m_i}} = \\sum_{i=1}^{2} \\frac{1}{m_i} \\frac{\\partial m_i}{\\partial \\phi_j} \\frac{\\partial m_i}{\\partial \\phi_k} + (\\text{来自约束项})\n$$\n约束项 $-\\frac{\\theta^2}{2\\sigma_\\theta^2}$ 只对 $I_{\\theta\\theta}$ 元素有贡献，其关于 $\\theta$ 的二阶导数为 $-\\frac{1}{\\sigma_\\theta^2}$。因此，对 $I_{\\theta\\theta}$ 的贡献为 $\\frac{1}{\\sigma_\\theta^2}$。\n\n首先，我们计算 $m_i(\\mu,\\theta)$ 的偏导数：\n$$\n\\frac{\\partial m_i}{\\partial \\mu} = s_i(1+\\theta)\n$$\n$$\n\\frac{\\partial m_i}{\\partial \\theta} = \\mu s_i\n$$\n问题要求在真实参数值 $(\\mu, \\theta) = (\\mu_0, 0)$ 处进行评估。在这一点上，期望计数为 $m_{i0} \\equiv m_i(\\mu_0, 0) = \\mu_0 s_i + b_i$。在这一点上评估的导数为：\n$$\n\\left. \\frac{\\partial m_i}{\\partial \\mu} \\right|_{(\\mu_0,0)} = s_i\n$$\n$$\n\\left. \\frac{\\partial m_i}{\\partial \\theta} \\right|_{(\\mu_0,0)} = \\mu_0 s_i\n$$\n现在我们使用 Asimov 数据 $m_{i0}$ 计算在 $(\\mu_0, 0)$ 处评估的费雪信息矩阵 $I$ 的元素：\n$$\nI_{\\mu\\mu} = \\sum_{i=1}^{2} \\frac{1}{m_{i0}} \\left( \\left. \\frac{\\partial m_i}{\\partial \\mu} \\right|_{(\\mu_0,0)} \\right)^2 = \\sum_{i=1}^{2} \\frac{s_i^2}{\\mu_0 s_i + b_i}\n$$\n$$\nI_{\\theta\\theta} = \\sum_{i=1}^{2} \\frac{1}{m_{i0}} \\left( \\left. \\frac{\\partial m_i}{\\partial \\theta} \\right|_{(\\mu_0,0)} \\right)^2 + \\frac{1}{\\sigma_\\theta^2} = \\sum_{i=1}^{2} \\frac{(\\mu_0 s_i)^2}{\\mu_0 s_i + b_i} + \\frac{1}{\\sigma_\\theta^2}\n$$\n$$\nI_{\\mu\\theta} = I_{\\theta\\mu} = \\sum_{i=1}^{2} \\frac{1}{m_{i0}} \\left( \\left. \\frac{\\partial m_i}{\\partial \\mu} \\right|_{(\\mu_0,0)} \\right) \\left( \\left. \\frac{\\partial m_i}{\\partial \\theta} \\right|_{(\\mu_0,0)} \\right) = \\sum_{i=1}^{2} \\frac{s_i (\\mu_0 s_i)}{\\mu_0 s_i + b_i} = \\mu_0 \\sum_{i=1}^{2} \\frac{s_i^2}{\\mu_0 s_i + b_i}\n$$\n我们可以观察到 $I_{\\mu\\theta} = \\mu_0 I_{\\mu\\mu}$。我们定义量 $A = I_{\\mu\\mu} = \\sum_{i=1}^{2} \\frac{s_i^2}{\\mu_0 s_i + b_i}$。费雪信息矩阵为：\n$$\nI = \\begin{pmatrix} I_{\\mu\\mu} & I_{\\mu\\theta} \\\\ I_{\\theta\\mu} & I_{\\theta\\theta} \\end{pmatrix} = \\begin{pmatrix} A & \\mu_0 A \\\\ \\mu_0 A & \\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2} \\end{pmatrix}\n$$\n$\\mu$ 的剖面费雪信息是通过消除系统误差参数 $\\theta$ 得到的。公式为：\n$$\nI_{\\mu\\mu}^{\\text{prof}} = I_{\\mu\\mu} - I_{\\mu\\theta} (I_{\\theta\\theta})^{-1} I_{\\theta\\mu}\n$$\n代入矩阵元素的表达式：\n$$\nI_{\\mu\\mu}^{\\text{prof}} = A - (\\mu_0 A) \\left( \\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2} \\right)^{-1} (\\mu_0 A) = A - \\frac{\\mu_0^2 A^2}{\\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2}}\n$$\n为了简化，我们通分：\n$$\nI_{\\mu\\mu}^{\\text{prof}} = \\frac{A \\left( \\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2} \\right) - \\mu_0^2 A^2}{\\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2}} = \\frac{A \\mu_0^2 A + \\frac{A}{\\sigma_\\theta^2} - \\mu_0^2 A^2}{\\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2}} = \\frac{\\frac{A}{\\sigma_\\theta^2}}{\\mu_0^2 A + \\frac{1}{\\sigma_\\theta^2}}\n$$\n分子分母同乘以 $\\sigma_\\theta^2$ 得到：\n$$\nI_{\\mu\\mu}^{\\text{prof}} = \\frac{A}{1 + \\mu_0^2 \\sigma_\\theta^2 A}\n$$\n最后，将 $A$ 的表达式代回，我们得到完整的闭式解析表达式：\n$$\nI_{\\mu\\mu}^{\\text{prof}} = \\frac{\\sum_{i=1}^2 \\frac{s_i^2}{\\mu_0 s_i + b_i}}{1 + \\mu_0^2 \\sigma_\\theta^2 \\sum_{i=1}^2 \\frac{s_i^2}{\\mu_0 s_i + b_i}}\n$$\n该表达式表示在考虑了系统误差参数 $\\theta$ 的不确定度之后，关于信号强度 $\\mu$ 的信息。\n\n解释：\n分母显示了关于 $\\mu$ 的信息如何因 $\\theta$ 的不确定度而衰减。项 $I_{\\mu\\mu} = \\sum_{i=1}^2 \\frac{s_i^2}{\\mu_0 s_i + b_i}$ 是在 $\\theta$ 完全已知（即不是一个参数而是一个固定常数）的情况下，关于 $\\mu$ 的费雪信息。剖面信息 $I_{\\mu\\mu}^{\\text{prof}}$ 总是小于或等于 $I_{\\mu\\mu}$，这说明系统误差参数的不确定度会降低测量感兴趣参数的统计功效。\n\n1.  情况 $\\sigma_\\theta \\to 0$：这个极限对应于一个完全已知的系统误差参数 $\\theta$（因为它被一个中心在零、宽度为零的高斯分布所约束）。分母趋近于 1，我们有：\n    $$\n    \\lim_{\\sigma_\\theta \\to 0} I_{\\mu\\mu}^{\\text{prof}} = \\sum_{i=1}^2 \\frac{s_i^2}{\\mu_0 s_i + b_i} = I_{\\mu\\mu}\n    $$\n    关于 $\\mu$ 的信息是最大的，因为没有来自 $\\theta$ 的不确定度需要考虑。\n\n2.  情况 $\\sigma_\\theta \\to \\infty$：这个极限对应于一个完全未知的系统误差参数（高斯约束变得平坦，不提供任何信息）。分母无限增大。\n    $$\n    \\lim_{\\sigma_\\theta \\to \\infty} I_{\\mu\\mu}^{\\text{prof}} = 0\n    $$\n    关于 $\\mu$ 的信息降至零。这是因为，在没有对 $\\theta$ 的约束的情况下，在 $\\mu(1+\\theta)$ 项中，$\\mu$ 和 $\\theta$ 之间存在完全的简并性。信号强度 $\\mu$ 的变化可以被效率参数 $\\theta$ 的补偿性变化完美地模仿，使得无法区分这两种效应，因此无法单独提取关于 $\\mu$ 的任何信息。\n$I_{\\mu\\mu}^{\\text{prof}}$ 的值是 $\\sigma_\\theta$ 的单调递减函数，在这两个物理极限之间平滑地插值。",
            "answer": "$$\n\\boxed{\\frac{\\sum_{i=1}^2 \\frac{s_i^2}{\\mu_0 s_i + b_i}}{1 + \\mu_0^2 \\sigma_\\theta^2 \\sum_{i=1}^2 \\frac{s_i^2}{\\mu_0 s_i + b_i}}}\n$$"
        },
        {
            "introduction": "复杂的模型有时会遇到参数不可识别的问题，即不同的参数组合会导致相同的物理预测，从而使参数无法被唯一确定。本练习让你亲手探究这个问题，通过分析黑塞矩阵（Hessian matrix）来寻找似然空间中的“平坦方向”，这是诊断和调试统计模型的一项关键技能。",
            "id": "3524818",
            "problem": "考虑在大型强子对撞机（Large Hadron Collider, LHC）的计算高能物理中进行的一次双通道计数分析，以测量一个稀有过程的信号强度参数 $\\mu$。每个通道 $i \\in \\{1,2\\}$ 具有已知的本底期望 $b_i > 0$ 和已知的信号模板产额 $s_i > 0$。通道 $i$ 中的预期事件数建模为\n$$\n\\nu_i(\\mu,\\theta_1,\\theta_2) = b_i + \\mu\\,s_i\\,(1+\\alpha),\n$$\n其中两个 nuisance 参数 $\\theta_1$ 和 $\\theta_2$ 分别代表全局光度定标偏移和全局触发效率偏移，它们的组合效应仅通过其和\n$$\n\\alpha \\equiv \\theta_1 + \\theta_2\n$$\n进入产额。存在一个外部定标，为 $\\alpha$ 提供了一个具有已知宽度 $\\sigma_{\\alpha} > 0$ 的单一辅助高斯约束，但对 $\\theta_1$ 和 $\\theta_2$ 的任何正交组合没有辅助约束。似然函数由每个通道中观测计数 $n_i \\in \\mathbb{N}$ 的独立泊松概率与对 $\\alpha$ 的高斯辅助约束的乘积构成：\n$$\nL(\\mu,\\theta_1,\\theta_2) \\equiv \\left[\\prod_{i=1}^{2} \\frac{\\nu_i(\\mu,\\theta_1,\\theta_2)^{n_i}\\,\\exp\\!\\big(-\\nu_i(\\mu,\\theta_1,\\theta_2)\\big)}{n_i!} \\right] \\times \\exp\\!\\left(-\\frac{\\alpha^2}{2\\,\\sigma_{\\alpha}^2}\\right).\n$$\n假设观测计数等于在某个真实 $\\mu_0 > 0$ 和 $\\alpha_0 = 0$ 时的名义期望值，即 $n_i = b_i + \\mu_0 s_i$。\n\n从泊松似然和高斯约束的基本定义出发，仅使用标准微积分和线性代数，完成以下任务：\n- 推导对数似然 $\\ell(\\mu,\\theta_1,\\theta_2) \\equiv \\ln L(\\mu,\\theta_1,\\theta_2)$，并明确证明其对 $(\\theta_1,\\theta_2)$ 的依赖性仅通过 $\\alpha$ 体现。\n- 计算 $\\ell$ 关于 $(\\theta_1,\\theta_2)$ 的 Hessian 矩阵，并在最大似然点 $(\\mu,\\alpha) = (\\mu_0,0)$ 处求值。\n- 证明在 $(\\theta_1,\\theta_2)$ 空间中存在一个平坦方向，并找出 Hessian 矩阵对应于零特征值（即平坦方向）的归一化特征向量。\n\n答案规格：\n- 使用 LaTeX 的 $\\verb|\\pmatrix|$ 环境，将对应于平坦方向的归一化特征向量表示为单个行向量。\n- 无需四舍五入。\n- 最终答案没有物理单位。",
            "solution": "该问题陈述具有科学依据，提法恰当且客观，根植于高能物理学中使用的标准统计方法。所有必要组成部分均已提供，不存在内部矛盾或含糊不清之处。因此，该问题被认定为有效，并将提供完整解答。\n\n主要任务是分析对数似然函数关于 nuisance 参数 $\\theta_1$ 和 $\\theta_2$ 的结构。分析按要求分三步进行。\n\n首先，我们推导对数似然函数 $\\ell(\\mu, \\theta_1, \\theta_2)$，并证明其对 $\\theta_1$ 和 $\\theta_2$ 的依赖性完全通过它们的和 $\\alpha \\equiv \\theta_1 + \\theta_2$ 来体现。似然函数给定为：\n$$\nL(\\mu,\\theta_1,\\theta_2) = \\left[\\prod_{i=1}^{2} \\frac{\\nu_i(\\mu,\\theta_1,\\theta_2)^{n_i}\\,\\exp(-\\nu_i(\\mu,\\theta_1,\\theta_2))}{n_i!} \\right] \\times \\exp\\left(-\\frac{\\alpha^2}{2\\,\\sigma_{\\alpha}^2}\\right)\n$$\n对数似然 $\\ell \\equiv \\ln L$ 是此表达式的自然对数。利用对数的性质，我们可以将 $\\ell$ 写成各项之和：\n$$\n\\ell(\\mu,\\theta_1,\\theta_2) = \\ln\\left(\\prod_{i=1}^{2} \\frac{\\nu_i^{n_i}\\,e^{-\\nu_i}}{n_i!}\\right) + \\ln\\left(\\exp\\left(-\\frac{\\alpha^2}{2\\,\\sigma_{\\alpha}^2}\\right)\\right)\n$$\n$$\n\\ell(\\mu,\\theta_1,\\theta_2) = \\sum_{i=1}^{2} \\ln\\left(\\frac{\\nu_i^{n_i}\\,e^{-\\nu_i}}{n_i!}\\right) - \\frac{\\alpha^2}{2\\,\\sigma_{\\alpha}^2}\n$$\n$$\n\\ell(\\mu,\\theta_1,\\theta_2) = \\sum_{i=1}^{2} \\left( n_i \\ln \\nu_i - \\nu_i - \\ln(n_i!) \\right) - \\frac{\\alpha^2}{2\\,\\sigma_{\\alpha}^2}\n$$\n预期事件数 $\\nu_i$ 定义为 $\\nu_i(\\mu,\\theta_1,\\theta_2) = b_i + \\mu\\,s_i\\,(1+\\alpha)$，其中 $\\alpha = \\theta_1 + \\theta_2$。显然，$\\nu_i$ 对 $\\theta_1$ 和 $\\theta_2$ 的依赖仅通过它们的和 $\\alpha$ 体现。辅助约束项也仅依赖于 $\\alpha$。涉及观测计数 $n_i$ 的项相对于模型参数是常数。因此，整个对数似然函数 $\\ell(\\mu, \\theta_1, \\theta_2)$ 可以写成 $\\mu$ 和 $\\alpha$ 的函数，即对于某个函数 $f$，有 $\\ell(\\mu, \\theta_1, \\theta_2) = f(\\mu, \\alpha(\\theta_1, \\theta_2)) = f(\\mu, \\theta_1+\\theta_2)$。这明确表明其对 $(\\theta_1, \\theta_2)$ 的依赖性仅通过 $\\alpha$ 体现。\n\n其次，我们计算 $\\ell$ 关于 $(\\theta_1, \\theta_2)$ 的 Hessian 矩阵，并在点 $(\\mu, \\alpha) = (\\mu_0, 0)$ 处求值。Hessian 矩阵 $H$ 的元素为 $H_{jk} = \\frac{\\partial^2 \\ell}{\\partial \\theta_j \\partial \\theta_k}$，其中 $j, k \\in \\{1, 2\\}$。\n由于 $\\ell$ 是 $\\alpha = \\theta_1 + \\theta_2$ 的函数，我们使用链式法则。\n一阶偏导数为：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta_j} = \\frac{d \\ell}{d \\alpha} \\frac{\\partial \\alpha}{\\partial \\theta_j}\n$$\n因为 $\\frac{\\partial \\alpha}{\\partial \\theta_1} = 1$ 且 $\\frac{\\partial \\alpha}{\\partial \\theta_2} = 1$，我们有：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta_1} = \\frac{\\partial \\ell}{\\partial \\theta_2} = \\frac{d \\ell}{d \\alpha}\n$$\n二阶偏导数为：\n$$\nH_{jk} = \\frac{\\partial^2 \\ell}{\\partial \\theta_j \\partial \\theta_k} = \\frac{\\partial}{\\partial \\theta_j}\\left(\\frac{d \\ell}{d \\alpha}\\right) = \\frac{d^2 \\ell}{d \\alpha^2} \\frac{\\partial \\alpha}{\\partial \\theta_j} = \\frac{d^2 \\ell}{d \\alpha^2}\n$$\n这对 $j, k \\in \\{1, 2\\}$ 的所有组合都成立，因此 Hessian 矩阵的所有四个元素都相同，且等于 $\\frac{d^2 \\ell}{d \\alpha^2}$。\n为了求这个二阶导数，我们首先计算 $\\ell$ 关于 $\\alpha$ 的一阶导数：\n$$\n\\frac{d \\ell}{d \\alpha} = \\sum_{i=1}^{2} \\left( \\frac{n_i}{\\nu_i} \\frac{d \\nu_i}{d \\alpha} - \\frac{d \\nu_i}{d \\alpha} \\right) - \\frac{\\alpha}{\\sigma_{\\alpha}^2}\n$$\n由于 $\\nu_i = b_i + \\mu s_i (1+\\alpha)$，我们有 $\\frac{d \\nu_i}{d \\alpha} = \\mu s_i$。代入得：\n$$\n\\frac{d \\ell}{d \\alpha} = \\sum_{i=1}^{2} \\left( \\frac{n_i}{\\nu_i} - 1 \\right) \\mu s_i - \\frac{\\alpha}{\\sigma_{\\alpha}^2}\n$$\n现在，我们计算二阶导数：\n$$\n\\frac{d^2 \\ell}{d \\alpha^2} = \\frac{d}{d\\alpha}\\left[ \\sum_{i=1}^{2} \\left( \\frac{n_i}{\\nu_i} - 1 \\right) \\mu s_i - \\frac{\\alpha}{\\sigma_{\\alpha}^2} \\right] = \\sum_{i=1}^{2} \\left( -\\frac{n_i}{\\nu_i^2} \\left(\\frac{d\\nu_i}{d\\alpha}\\right)^2 \\right) - \\frac{1}{\\sigma_{\\alpha}^2}\n$$\n再次代入 $\\frac{d\\nu_i}{d\\alpha} = \\mu s_i$：\n$$\n\\frac{d^2 \\ell}{d \\alpha^2} = -\\sum_{i=1}^{2} \\frac{n_i (\\mu s_i)^2}{\\nu_i^2} - \\frac{1}{\\sigma_{\\alpha}^2}\n$$\n我们必须在指定点 $(\\mu, \\alpha) = (\\mu_0, 0)$ 处计算此表达式的值。在该点，观测计数为 $n_i = b_i + \\mu_0 s_i$。在 $(\\mu_0, 0)$ 处的模型期望为 $\\nu_i = b_i + \\mu_0 s_i(1+0) = b_i + \\mu_0 s_i$。因此，在求值点，我们有 $n_i = \\nu_i$。\n将 $\\mu = \\mu_0$ 和 $n_i = \\nu_i = b_i + \\mu_0 s_i$ 代入二阶导数的表达式中：\n$$\n\\left. \\frac{d^2 \\ell}{d \\alpha^2} \\right|_{(\\mu_0,0)} = -\\sum_{i=1}^{2} \\frac{(b_i + \\mu_0 s_i) (\\mu_0 s_i)^2}{(b_i + \\mu_0 s_i)^2} - \\frac{1}{\\sigma_{\\alpha}^2} = -\\sum_{i=1}^{2} \\frac{(\\mu_0 s_i)^2}{b_i + \\mu_0 s_i} - \\frac{1}{\\sigma_{\\alpha}^2}\n$$\n我们将此常数值记为 $C_{\\alpha\\alpha}$。在该点求值的 Hessian 矩阵为：\n$$\nH = \\begin{pmatrix} C_{\\alpha\\alpha} & C_{\\alpha\\alpha} \\\\ C_{\\alpha\\alpha} & C_{\\alpha\\alpha} \\end{pmatrix}\n$$\n\n第三，我们证明存在一个平坦方向，并找到其对应的归一化特征向量。参数空间中的平坦方向对应于 Hessian 矩阵的零特征值。我们通过求解特征方程 $\\det(H - \\lambda I) = 0$ 来找到 $H$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} C_{\\alpha\\alpha} - \\lambda & C_{\\alpha\\alpha} \\\\ C_{\\alpha\\alpha} & C_{\\alpha\\alpha} - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(C_{\\alpha\\alpha} - \\lambda)^2 - C_{\\alpha\\alpha}^2 = 0\n$$\n$$\n\\lambda^2 - 2 \\lambda C_{\\alpha\\alpha} + C_{\\alpha\\alpha}^2 - C_{\\alpha\\alpha}^2 = 0\n$$\n$$\n\\lambda (\\lambda - 2 C_{\\alpha\\alpha}) = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = 2C_{\\alpha\\alpha}$。零特征值 $\\lambda_1 = 0$ 的存在证明了在 $(\\theta_1, \\theta_2)$ 参数空间中存在一个平坦方向。\n\n为找到对应于零特征值的特征向量 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$，我们求解方程 $(H - 0 \\cdot I)v = 0$，即 $Hv=0$：\n$$\n\\begin{pmatrix} C_{\\alpha\\alpha} & C_{\\alpha\\alpha} \\\\ C_{\\alpha\\alpha} & C_{\\alpha\\alpha} \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到单个方程 $C_{\\alpha\\alpha} v_1 + C_{\\alpha\\alpha} v_2 = 0$。由于 $b_i, s_i, \\mu_0, \\sigma_\\alpha > 0$，显然 $C_{\\alpha\\alpha} < 0$。因此，我们可以除以 $C_{\\alpha\\alpha}$ 得到 $v_1 + v_2 = 0$，或 $v_1 = -v_2$。特征空间由任何形如 $\\begin{pmatrix} k \\\\ -k \\end{pmatrix}$（其中 $k \\ne 0$）的向量张成。一个代表性的特征向量是 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n为了找到归一化特征向量，我们将此向量除以其欧几里得范数：\n$$\n\\|v\\| = \\sqrt{1^2 + (-1)^2} = \\sqrt{2}\n$$\n对应于平坦方向的归一化特征向量是：\n$$\n\\hat{v} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n该向量表示 $(\\theta_1, \\theta_2)$ 平面中对数似然在二阶近似下不发生变化的方向。这是模型对这些参数的依赖仅通过其和 $\\alpha = \\theta_1 + \\theta_2$ 产生的直接结果。\n\n问题要求将答案表示为单个行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\sqrt{2}} & -\\frac{1}{\\sqrt{2}} \\end{pmatrix}}\n$$"
        }
    ]
}