{
    "hands_on_practices": [
        {
            "introduction": "Any numerical simulation of fluid dynamics must obey stability conditions to prevent unphysical results. The Courant-Friedrichs-Lewy (CFL) condition provides the fundamental constraint, linking the time step $\\Delta \\tau$ to the grid spacing and the local signal speed. In the expanding spacetimes relevant to heavy-ion collisions, this calculation must carefully account for the non-trivial metric, as explored in this exercise .",
            "id": "3516494",
            "problem": "Consider an explicit finite-volume solver for relativistic ideal hydrodynamics used in heavy-ion collision simulations that couples a background fluid to localized energy-momentum deposition from jets (jet quenching) via source terms. The fluid obeys conservation of energy-momentum, expressed as $\\partial_{\\mu} T^{\\mu \\nu} = J^{\\nu}$, where $T^{\\mu \\nu} = (\\varepsilon + p) u^{\\mu} u^{\\nu} - p g^{\\mu \\nu}$ for an ideal fluid and $J^{\\nu}$ encodes jet energy-momentum deposition. The evolution is performed in Milne coordinates $(\\tau, x, y, \\eta_{s})$, suitable for near boost-invariant longitudinal expansion in heavy-ion collisions, with metric $\\mathrm{diag}(+1,-1,-1,-\\tau^{2})$. In these curvilinear coordinates, proper spatial distances at fixed $\\tau$ are $|dx|$, $|dy|$, and $\\tau |d\\eta_{s}|$ along $x$, $y$, and $\\eta_{s}$, respectively.\n\nA necessary condition for stability of an explicit scheme is the Courant–Friedrichs–Lewy (CFL) criterion, which requires that within one time step the fastest signal along any coordinate direction must not traverse more than one cell in that direction, when measured against the proper spatial scale of the grid cell. In a local orthonormal frame, the fastest signal relative to the fluid is bounded by the speed of sound $c_{s}$, and the fastest laboratory-frame signal along a given direction is bounded above by the sum of the fluid speed component magnitude and $c_{s}$ along that direction. In curvilinear coordinates, the coordinate speed along directions with nontrivial metric scale factors must be converted using the appropriate proper-to-coordinate length relation.\n\nAssume the equation of state is approximately conformal so that $c_{s} = \\sqrt{1/3}$ in natural units (set the speed of light $c = 1$), and the local three-velocity components (in the local orthonormal frame aligned with $(x,y,\\eta_{s})$) at a given grid point are $v_{x} = 0.40$, $v_{y} = 0.30$, and $v_{\\eta} = 0.05$. At a hydrodynamic time $\\tau = 3.0$ fm/$c$, the mesh spacings are $\\Delta x = 0.06$ fm, $\\Delta y = 0.08$ fm, and $\\Delta \\eta_{s} = 0.02$. The explicit time integrator uses a Courant number $C = 0.50$.\n\nStarting from the above principles, derive the CFL stability condition appropriate to Milne coordinates and compute the maximum allowable time step $\\Delta \\tau_{\\max}$ at this grid point. Round your answer to four significant figures and express $\\Delta \\tau_{\\max}$ in femtometer per speed of light (fm/$c$).",
            "solution": "The problem asks for the derivation of the Courant–Friedrichs–Lewy (CFL) stability condition for a relativistic hydrodynamic simulation in Milne coordinates and the calculation of the maximum allowable time step $\\Delta \\tau_{\\max}$ at a specific grid point.\n\nThe validation process confirms that the problem is scientifically grounded, well-posed, objective, and internally consistent. All necessary physical principles and numerical data are provided. The context is a standard scenario in computational high-energy physics. Thus, the problem is valid, and a solution can be formulated.\n\nThe CFL condition is a necessary condition for the stability of explicit numerical schemes for solving partial differential equations. It states that the numerical domain of dependence of a grid point must contain the physical domain of dependence. For an explicit time-stepping scheme, this implies that within a single time step $\\Delta t$, the fastest propagating signal must not travel further than one grid cell. This can be expressed for each spatial dimension $i$ as:\n$$ \\Delta t \\le C \\frac{\\Delta L_i}{v_{\\text{sig}, i}} $$\nwhere $\\Delta L_i$ is the proper physical size of the grid cell in direction $i$, $v_{\\text{sig}, i}$ is the maximum proper speed of any signal in that direction, and $C$ is the Courant number, a safety factor typically less than or equal to $1$. The overall maximum time step is limited by the most restrictive of these conditions:\n$$ \\Delta t_{\\max} = C \\cdot \\min_{i} \\left( \\frac{\\Delta L_i}{v_{\\text{sig}, i}} \\right) $$\n\nIn this problem, the time coordinate is the proper time $\\tau$, so we are seeking $\\Delta \\tau_{\\max}$. The spatial coordinates are $(x, y, \\eta_{s})$, which are curvilinear. The relationship between coordinate intervals and proper spatial distances is given by the spacetime metric, $g_{\\mu\\nu} = \\mathrm{diag}(+1, -1, -1, -\\tau^2)$. The invariant line element is $ds^2 = g_{\\mu\\nu} dx^{\\mu} dx^{\\nu}$. At a fixed time $\\tau$ (i.e., $d\\tau = 0$), the square of a proper spatial distance element $dL$ is:\n$$ dL^2 = -ds^2 = dx^2 + dy^2 + \\tau^2 d\\eta_s^2 $$\nFrom this, we identify the proper length of the grid cells along each coordinate axis, given the coordinate grid spacings $\\Delta x$, $\\Delta y$, and $\\Delta \\eta_s$:\n\\begin{itemize}\n    \\item Along the $x$-axis: $\\Delta L_x = \\Delta x$\n    \\item Along the $y$-axis: $\\Delta L_y = \\Delta y$\n    \\item Along the $\\eta_s$-axis: $\\Delta L_{\\eta} = \\tau \\Delta \\eta_s$\n\\end{itemize}\n\nNext, we establish the maximum signal propagation speeds. The problem specifies that in a local orthonormal frame, the fastest signal speed along a direction $i$ is the sum of the magnitude of the fluid velocity component $|v_i|$ and the speed of sound $c_s$. These are the proper speeds, corresponding to propagation over proper distances.\n\\begin{itemize}\n    \\item Signal speed in $x$ direction: $v_{\\text{sig}, x} = |v_x| + c_s$\n    \\item Signal speed in $y$ direction: $v_{\\text{sig}, y} = |v_y| + c_s$\n    \\item Signal speed in $\\eta$ direction: $v_{\\text{sig}, \\eta} = |v_{\\eta}| + c_s$\n\\end{itemize}\nThe speed of light is set to $c=1$.\n\nCombining these elements, the CFL condition for the maximum time step $\\Delta \\tau_{\\max}$ becomes:\n$$ \\Delta \\tau_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta L_x}{v_{\\text{sig}, x}}, \\frac{\\Delta L_y}{v_{\\text{sig}, y}}, \\frac{\\Delta L_{\\eta}}{v_{\\text{sig}, \\eta}} \\right) $$\nSubstituting the expressions for proper lengths and signal speeds:\n$$ \\Delta \\tau_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta x}{|v_x| + c_s}, \\frac{\\Delta y}{|v_y| + c_s}, \\frac{\\tau \\Delta \\eta_s}{|v_{\\eta}| + c_s} \\right) $$\n\nWe now substitute the numerical values provided in the problem statement:\n\\begin{itemize}\n    \\item Courant number: $C = 0.50$\n    \\item Speed of sound: $c_s = \\sqrt{1/3}$\n    \\item Fluid velocity components: $v_x = 0.40$, $v_y = 0.30$, $v_{\\eta} = 0.05$\n    \\item Hydrodynamic time: $\\tau = 3.0$ fm/$c$\n    \\item Mesh spacings: $\\Delta x = 0.06$ fm, $\\Delta y = 0.08$ fm, $\\Delta \\eta_s = 0.02$\n\\end{itemize}\n\nFirst, we calculate the three time-scale limits corresponding to each spatial direction:\n1.  For the $x$-direction:\n    $$ \\frac{\\Delta x}{|v_x| + c_s} = \\frac{0.06}{|0.40| + \\sqrt{1/3}} = \\frac{0.06}{0.40 + \\sqrt{1/3}} \\text{ fm}/c $$\n2.  For the $y$-direction:\n    $$ \\frac{\\Delta y}{|v_y| + c_s} = \\frac{0.08}{|0.30| + \\sqrt{1/3}} = \\frac{0.08}{0.30 + \\sqrt{1/3}} \\text{ fm}/c $$\n3.  For the $\\eta_s$-direction:\n    $$ \\frac{\\tau \\Delta \\eta_s}{|v_{\\eta}| + c_s} = \\frac{(3.0)(0.02)}{|0.05| + \\sqrt{1/3}} = \\frac{0.06}{0.05 + \\sqrt{1/3}} \\text{ fm}/c $$\n\nNow, we evaluate these expressions numerically. We use the value $c_s = \\sqrt{1/3} \\approx 0.57735$.\n1.  $x$-direction limit:\n    $$ \\frac{0.06}{0.40 + 0.57735} = \\frac{0.06}{0.97735} \\approx 0.061395 \\text{ fm}/c $$\n2.  $y$-direction limit:\n    $$ \\frac{0.08}{0.30 + 0.57735} = \\frac{0.08}{0.87735} \\approx 0.091184 \\text{ fm}/c $$\n3.  $\\eta_s$-direction limit:\n    $$ \\frac{0.06}{0.05 + 0.57735} = \\frac{0.06}{0.62735} \\approx 0.095640 \\text{ fm}/c $$\n\nThe minimum of these three values determines the overall time step constraint:\n$$ \\min(0.061395, 0.091184, 0.095640) = 0.061395 \\text{ fm}/c $$\nThis most restrictive condition comes from the $x$-direction.\n\nFinally, we apply the Courant number $C = 0.50$ to find the maximum allowed time step $\\Delta \\tau_{\\max}$:\n$$ \\Delta \\tau_{\\max} = C \\cdot \\min(\\dots) = 0.50 \\times 0.061395 \\text{ fm}/c \\approx 0.0306975 \\text{ fm}/c $$\n\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $3, 0, 6, 9$. The next digit is $7$, so we round up the last significant digit.\n$$ \\Delta \\tau_{\\max} \\approx 0.03070 \\text{ fm}/c $$\nThe trailing zero is significant.",
            "answer": "$$\\boxed{0.03070}$$"
        },
        {
            "introduction": "Once a numerical solver is stable, it must be validated to ensure it accurately reproduces the underlying physics. Analytic solutions provide the gold standard for this verification, though they are rare for complex systems like relativistic hydrodynamics. This practice  explores the celebrated Gubser flow, a non-trivial exact solution with transverse dynamics, whose elegant derivation relies on the system's conformal symmetry.",
            "id": "3516455",
            "problem": "Consider ideal conformal relativistic hydrodynamics for a fluid created in a high-energy nucleus–nucleus collision, modeled in flat Minkowski spacetime written in Milne coordinates with metric $ds^{2} = -d\\tau^{2} + dr^{2} + r^{2} d\\phi^{2} + \\tau^{2} d\\eta^{2}$. Assume the energy-momentum tensor is that of an ideal fluid, $T^{\\mu\\nu} = (\\epsilon + p) u^{\\mu} u^{\\nu} + p\\, g^{\\mu\\nu}$, with the conformal equation of state $\\epsilon = 3 p$ and vanishing bulk viscosity, so that the system is invariant under Weyl rescalings combined with suitable field redefinitions. Impose longitudinal boost invariance, azimuthal symmetry in the transverse plane, and a nontrivial transverse scale characterized by a dimensionful parameter $q$ consistent with conformal symmetry, generating the $\\mathrm{SO}(3)_{q} \\times \\mathrm{SO}(1,1) \\times \\mathbb{Z}_{2}$ symmetry of the flow. Using only these ingredients, select the option that presents a self-consistent construction of a nontrivial analytic solution with transverse dynamics, including: a correct Weyl mapping to a curved background where the flow is static, the appropriate coordinate transformation between flat and curved coordinates, the resulting evolution equation for the temperature in the curved frame and its solution, the mapping of thermodynamic fields and four-velocity back to Minkowski space, and a concise explanation of why this solution serves as a stringent benchmark for numerical solvers and jet-energy-loss modules beyond purely longitudinal expansion.\n\nA. Perform a Weyl rescaling with factor $\\Omega = 1/\\tau$ so that $d\\hat{s}^{2} = ds^{2}/\\tau^{2}$ becomes the metric of $\\mathrm{dS}_{3} \\times \\mathbb{R}$ in coordinates $(\\rho,\\theta,\\phi,\\eta)$ given by\n$$\n\\sinh \\rho \\equiv -\\frac{1 - q^{2}\\tau^{2} + q^{2} r^{2}}{2 q \\tau}\\,, \\qquad \\tan \\theta \\equiv \\frac{2 q r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}\\,,\n$$\nso that $d\\hat{s}^{2} = - d\\rho^{2} + \\cosh^{2}\\!\\rho\\, (d\\theta^{2} + \\sin^{2}\\!\\theta\\, d\\phi^{2}) + d\\eta^{2}$. In the hatted frame, impose a static flow $\\hat{u}^{\\mu} = (1,0,0,0)$ and solve energy-momentum conservation $\\hat{\\nabla}_{\\mu} \\hat{T}^{\\mu\\nu} = 0$ with $\\hat{T}^{\\mu\\nu}$ ideal and conformal, which reduces to an ordinary differential equation for the temperature,\n$$\n\\frac{1}{\\hat{T}(\\rho)} \\frac{d \\hat{T}}{d\\rho} = - \\frac{2}{3} \\tanh \\rho\\,,\n$$\nso that $\\hat{T}(\\rho) = \\hat{T}_{0} \\, (\\cosh \\rho)^{-2/3}$ and $\\hat{\\epsilon}(\\rho) \\propto \\hat{T}^{4}(\\rho) \\propto (\\cosh \\rho)^{-8/3}$. Map back to Minkowski space using Weyl weights appropriate for a conformal fluid, $T(\\tau,r) = \\hat{T}(\\rho)/\\tau$ and $\\epsilon(\\tau,r) = \\hat{\\epsilon}(\\rho)/\\tau^{4}$, and obtain a transverse flow with radial velocity\n$$\nv_{\\perp}(\\tau,r) = \\tanh \\kappa(\\tau,r) = \\frac{2 q^{2}\\, \\tau\\, r}{1 + q^{2}\\tau^{2} + q^{2} r^{2}}\\,,\n$$\nwith $u^{\\tau} = \\cosh \\kappa$ and $u^{r} = \\sinh \\kappa$. This solution, known as Gubser flow, supplies analytic, time-dependent transverse gradients and radial flow while preserving boost invariance, providing a nontrivial benchmark for hydrodynamic solvers and for coupling to jet-energy-loss modules to test sensitivity to transverse flow and path-length variations, well beyond purely longitudinal Bjorken expansion.\n\nB. Perform a Weyl rescaling with factor $\\Omega = \\tau$ and map flat Minkowski space to $\\mathrm{AdS}_{3} \\times \\mathbb{R}$ where the flow remains static in Minkowski coordinates $u^{\\mu} = (1,0,0,0)$. Then impose boost invariance to obtain a temperature profile that depends only on proper time via $T(\\tau) \\propto \\tau^{-1/3}$ with no radial dependence, and use this longitudinal-only solution as a benchmark since transverse dynamics are small at early times.\n\nC. Enforce conformal symmetry by setting both bulk and shear viscosities to zero, which implies the temperature in any curved frame must satisfy $d\\hat{T}/d\\rho = - \\frac{1}{3} \\hat{T}\\, \\tanh \\rho$, giving $\\hat{T}(\\rho) \\propto (\\cosh \\rho)^{-1/3}$. Mapping back with $T(\\tau,r) = \\hat{T}(\\rho)$ and keeping $u^{\\mu} = (1,0,0,0)$ in Minkowski space yields a radially static configuration that nevertheless exhibits transverse pressure gradients sufficient for benchmarking jet quenching with path-length dependence.\n\nD. Use the same Weyl mapping as in option A but allow a nonstatic hatted flow with $\\hat{u}^{\\rho} \\neq 0$ to generate stronger transverse dynamics. The resulting velocity in Minkowski space is $v_{\\perp}(\\tau,r) = \\frac{q\\, r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}$, while the temperature transforms as $T(\\tau,r) = \\hat{T}(\\rho)\\, \\tau$ because temperature has Weyl weight minus one. This flow features nontrivial transverse shear and thus is a better benchmark than any static-hat-frame construction.\n\nE. Perform no Weyl rescaling but introduce the scale $q$ by hand into the equation of state $p(\\epsilon) = \\epsilon/3 + q^{4}$ to break translational invariance, keeping $u^{\\mu} = (1,0,0,0)$. The resulting pressure gradients in the transverse plane lead to a radially accelerating solution that is exactly boost invariant and hence provides a robust benchmark for hydrodynamics and jet quenching without any mapping to curved space.",
            "solution": "The problem statement asks to identify the correct self-consistent construction of a nontrivial analytic solution to ideal conformal relativistic hydrodynamics in Minkowski space, imposing specific symmetries that include longitudinal boost invariance and a transverse scale. This class of solution is known as Gubser flow.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **System:** Ideal conformal relativistic hydrodynamics.\n-   **Spacetime:** Flat Minkowski space in Milne coordinates, metric $ds^{2} = -d\\tau^{2} + dr^{2} + r^{2} d\\phi^{2} + \\tau^{2} d\\eta^{2}$.\n-   **Energy-Momentum Tensor:** Ideal fluid, $T^{\\mu\\nu} = (\\epsilon + p) u^{\\mu} u^{\\nu} + p\\, g^{\\mu\\nu}$.\n-   **Equation of State (EoS):** Conformal, $\\epsilon = 3 p$.\n-   **Viscosity:** Vanishing bulk viscosity, consistent with conformal symmetry.\n-   **Invariance:** System is invariant under Weyl rescalings combined with suitable field redefinitions.\n-   **Symmetries:**\n    1.  Longitudinal boost invariance ($\\mathrm{SO}(1,1)$ symmetry in the longitudinal rapidity $\\eta$).\n    2.  Azimuthal symmetry in the transverse plane.\n    3.  A nontrivial transverse scale $q$ generating a symmetry group $\\mathrm{SO}(3)_{q} \\times \\mathrm{SO}(1,1) \\times \\mathbb{Z}_{2}$.\n-   **Task:** Select the option that correctly describes the construction of a nontrivial analytic solution with transverse dynamics, including the Weyl mapping, coordinate change, evolution equation, solution, and final mapping back to physical spacetime.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Groundedness:** The problem is firmly located within the well-established framework of relativistic fluid dynamics and its application to high-energy nuclear physics. All concepts, such as Milne coordinates, conformal symmetry, Weyl transformations, and the specified symmetry groups, are standard in this field of theoretical physics. The problem describes the setup for deriving the Gubser flow, a known and important analytic solution.\n-   **Well-Posedness:** The problem asks to identify the correct derivation of a known solution among a set of choices. The existence and uniqueness of the Gubser flow construction under these symmetries ensure the problem is well-posed.\n-   **Objectivity:** The problem statement is formulated using precise, technical language devoid of subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, and objective. It provides all necessary information to evaluate the options. Therefore, the problem is **valid**. I will proceed to derive the solution and evaluate each option.\n\n### Solution Derivation and Option Analysis\n\nThe core strategy to find this solution is to exploit the conformal symmetry of the hydrodynamic equations. We perform a Weyl transformation of the metric, $g_{\\mu\\nu} \\to \\hat{g}_{\\mu\\nu} = \\Omega^2 g_{\\mu\\nu}$, accompanied by a coordinate change, to map the problem from flat Minkowski space (where the flow is complex and time-dependent) to a curved spacetime where the flow is static. The hydrodynamic equations become much simpler in this \"hatted\" frame, reducing to an ordinary differential equation (ODE). After solving the ODE, we map the solution back to the physical Minkowski spacetime.\n\nThe symmetry group $\\mathrm{SO}(3)_{q} \\times \\mathrm{SO}(1,1) \\times \\mathbb{Z}_{2}$ indicates that the appropriate target space for the mapping is the direct product of $3$-dimensional de Sitter space and a real line, $\\mathrm{dS}_{3} \\times \\mathbb{R}$.\n\nLet's analyze each option based on this framework.\n\n**A. Perform a Weyl rescaling with factor $\\Omega = 1/\\tau$ so that $d\\hat{s}^{2} = ds^{2}/\\tau^{2}$ becomes the metric of $\\mathrm{dS}_{3} \\times \\mathbb{R}$ in coordinates $(\\rho,\\theta,\\phi,\\eta)$ ...**\n\n1.  **Weyl Mapping and Coordinates:** The option proposes a Weyl factor $\\Omega = 1/\\tau$. This gives the hatted metric $\\hat{g}_{\\mu\\nu} = (1/\\tau^2) g_{\\mu\\nu}$, so $d\\hat{s}^2 = ds^2/\\tau^2$. The proposed coordinate transformation,\n    $$\n    \\sinh \\rho \\equiv -\\frac{1 - q^{2}\\tau^{2} + q^{2} r^{2}}{2 q \\tau}\\,, \\qquad \\tan \\theta \\equiv \\frac{2 q r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}\\,,\n    $$\n    combined with the Weyl scaling, is a known (though not unique) mapping that transforms the flat metric in Milne coordinates to the metric of $\\mathrm{dS}_3 \\times \\mathbb{R}$, which is correctly given as $d\\hat{s}^{2} = - d\\rho^{2} + \\cosh^{2}\\!\\rho\\, (d\\theta^{2} + \\sin^{2}\\!\\theta\\, d\\phi^{2}) + d\\eta^{2}$.\n\n2.  **Flow in the Hatted Frame:** The goal is to find a static solution in the curved frame. The timelike coordinate in this static patch of $\\mathrm{dS}_3$ is $\\rho$. A static fluid is at rest with respect to the coordinates, so its four-velocity $\\hat{u}^{\\mu}$ must point purely in the time direction. Normalization $\\hat{g}_{\\mu\\nu}\\hat{u}^\\mu\\hat{u}^\\nu = -1$ with $\\hat{g}_{\\rho\\rho}=-1$ requires $\\hat{u}^{\\mu} = (1,0,0,0)$ in $(\\rho,\\theta,\\phi,\\eta)$ coordinates. This is correct.\n\n3.  **Hydrodynamic Equation and Solution:** We must solve $\\hat{\\nabla}_{\\mu} \\hat{T}^{\\mu\\nu} = 0$ for a static fluid in this background. The energy conservation equation is $\\hat{\\nabla}_{\\mu}(\\hat{\\epsilon}\\hat{u}^{\\mu})+\\hat{p}\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu}=0$. Projecting this along the flow lines ($\\hat{u}_\\nu \\hat{\\nabla}_\\mu \\hat{T}^{\\mu\\nu}=0$) gives $\\partial_{\\rho}\\hat{\\epsilon} = -(\\hat{\\epsilon}+\\hat{p})(\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu})$.\n    The four-divergence of the static velocity field is $\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu} = \\frac{1}{\\sqrt{-\\hat{g}}}\\partial_{\\rho}(\\sqrt{-\\hat{g}})$ where $\\sqrt{-\\hat{g}} = \\cosh^2\\rho \\sin\\theta$. This yields $\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu} = 2\\tanh\\rho$.\n    Using the conformal EoS $\\hat{\\epsilon}=3\\hat{p}$, we have $\\hat{\\epsilon}+\\hat{p} = \\frac{4}{3}\\hat{\\epsilon}$. The energy conservation equation becomes\n    $$\n    \\frac{d\\hat{\\epsilon}}{d\\rho} = -\\frac{4}{3}\\hat{\\epsilon} (2 \\tanh\\rho) = -\\frac{8}{3}\\hat{\\epsilon}\\tanh\\rho\n    $$\n    Since $\\hat{\\epsilon} \\propto \\hat{T}^4$ for a conformal fluid, we have $\\frac{1}{\\hat{\\epsilon}}\\frac{d\\hat{\\epsilon}}{d\\rho} = \\frac{4}{\\hat{T}}\\frac{d\\hat{T}}{d\\rho}$. Substituting this gives\n    $$\n    \\frac{1}{\\hat{T}} \\frac{d\\hat{T}}{d\\rho} = -\\frac{2}{3}\\tanh\\rho\n    $$\n    This matches the equation in the option. Integrating this ODE gives $\\ln\\hat{T} = -\\frac{2}{3}\\ln(\\cosh\\rho) + C$, which leads to $\\hat{T}(\\rho) = \\hat{T}_{0}(\\cosh\\rho)^{-2/3}$, exactly as stated. Consequently, $\\hat{\\epsilon} \\propto \\hat{T}^4 \\propto (\\cosh\\rho)^{-8/3}$.\n\n4.  **Mapping Back to Minkowski Space:** Fields with mass dimension $\\Delta$ transform as $\\hat{\\Phi} = \\Omega^{-\\Delta}\\Phi$. Temperature $T$ has $\\Delta=1$ and energy density $\\epsilon$ has $\\Delta=4$. With $\\Omega=1/\\tau$, we have $\\hat{T} = (1/\\tau)^{-1}T = \\tau T \\implies T = \\hat{T}/\\tau$. Similarly, $\\hat{\\epsilon} = (1/\\tau)^{-4}\\epsilon = \\tau^4\\epsilon \\implies \\epsilon = \\hat{\\epsilon}/\\tau^4$. These transformation rules are correct.\n\n5.  **Velocity Field:** The four-velocity is given by $u^\\tau = \\cosh\\kappa$ and $u^r = \\sinh\\kappa$. The transverse velocity $v_\\perp=u^r/u^\\tau = \\tanh\\kappa$. The expression provided,\n    $$\n    v_{\\perp}(\\tau,r) = \\frac{2 q^{2}\\, \\tau\\, r}{1 + q^{2}\\tau^{2} + q^{2} r^{2}}\n    $$\n    is the correct expression for the transverse velocity of the Gubser flow associated with this specific coordinate choice.\n\n6.  **Significance as a Benchmark:** The explanation is accurate. Bjorken flow is a 1+1D expansion (time + longitudinal). Gubser flow is the first known analytic solution in 3+1D that incorporates nontrivial transverse expansion dynamics while maintaining boost invariance. This makes it an essential benchmark for validating the accuracy of numerical hydrodynamic codes and for studying phenomena like jet quenching where the path length and flow velocity of the medium are critical.\n\n**Verdict on A:** **Correct**. All parts of this option are consistent and accurately describe the construction and properties of Gubser flow.\n\n---\n\n**B. Perform a Weyl rescaling with factor $\\Omega = \\tau$ and map flat Minkowski space to $\\mathrm{AdS}_{3} \\times \\mathbb{R}$ where the flow remains static in Minkowski coordinates $u^{\\mu} = (1,0,0,0)$. ...**\n\n-   The map is to de Sitter space ($\\mathrm{dS}_3$), not Anti-de Sitter space ($\\mathrm{AdS}_3$).\n-   Assuming the flow is static in Minkowski coordinates, $u^\\mu=(1,0,0,0)$, means there is no flow and no transverse dynamics, contradicting the goal of the problem.\n-   The temperature profile $T(\\tau) \\propto \\tau^{-1/3}$ describes Bjorken flow, which has only longitudinal expansion and no transverse dynamics, again contradicting the problem's requirements.\n\n**Verdict on B:** **Incorrect**. It misidentifies the target spacetime and describes the trivial/Bjorken solution, not one with transverse dynamics.\n\n---\n\n**C. Enforce conformal symmetry by setting both bulk and shear viscosities to zero, which implies the temperature in any curved frame must satisfy $d\\hat{T}/d\\rho = - \\frac{1}{3} \\hat{T}\\, \\tanh \\rho$, giving $\\hat{T}(\\rho) \\propto (\\cosh \\rho)^{-1/3}$. ...**\n\n-   The temperature evolution equation is wrong. The correct coefficient is $-2/3$, as derived above. A coefficient of $-1/3$ would lead to an incorrect solution.\n-   The mapping law $T(\\tau,r) = \\hat{T}(\\rho)$ is incorrect. It lacks the factor of $\\Omega^{-1}$ (i.e., $1/\\tau$) from the Weyl transformation.\n-   It assumes $u^{\\mu}=(1,0,0,0)$ in Minkowski space, which is a static fluid with no flow, contradicting the problem's goal.\n\n**Verdict on C:** **Incorrect**. It presents an incorrect evolution equation, an incorrect mapping law for temperature, and assumes a trivial velocity field.\n\n---\n\n**D. Use the same Weyl mapping as in option A but allow a nonstatic hatted flow with $\\hat{u}^{\\rho} \\neq 0$ to generate stronger transverse dynamics. ...**\n\n-   The central idea of the conformal mapping technique for Gubser flow is to simplify the problem by finding a frame where the flow is static. Allowing a non-static flow in the hatted frame defeats this purpose and makes the problem difficult again.\n-   The velocity $v_{\\perp}(\\tau,r) = \\frac{q\\, r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}$ is unphysical; the denominator can go to zero for certain values of $\\tau$ and $r$, leading to a superluminal velocity.\n-   The temperature transformation $T(\\tau,r) = \\hat{T}(\\rho)\\, \\tau$ is incorrect. As established in the analysis of A, the correct relation is $T = \\hat{T}/\\tau$.\n-   An ideal fluid has zero shear viscosity by definition, so it cannot feature \"nontrivial transverse shear\" (i.e., non-zero shear-stress tensor).\n\n**Verdict on D:** **Incorrect**. It misuses the mapping technique, proposes an unphysical velocity, uses an incorrect transformation law, and makes a false claim about shear stress.\n\n---\n\n**E. Perform no Weyl rescaling but introduce the scale $q$ by hand into the equation of state $p(\\epsilon) = \\epsilon/3 + q^{4}$ to break translational invariance, keeping $u^{\\mu} = (1,0,0,0)$. ...**\n\n-   The proposed equation of state $p(\\epsilon) = \\epsilon/3 + q^{4}$ is not conformal. It violates the problem's explicit condition that $\\epsilon=3p$.\n-   It proposes keeping $u^{\\mu} = (1,0,0,0)$, which means no flow.\n-   The option is self-contradictory: it states that the resulting pressure gradients lead to acceleration, which is incompatible with the assumption of a static velocity field $u^{\\mu}=(1,0,0,0)$.\n\n**Verdict on E:** **Incorrect**. It violates a fundamental premise of the problem (conformal EoS) and is internally contradictory.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The ultimate hands-on test is to construct a complete numerical solver from the ground up. This capstone exercise  challenges you to implement a modern, second-order accurate shock-capturing scheme to solve the equations of ideal relativistic hydrodynamics in $2+1$ dimensions. By applying your solver to a classic blast-wave problem, you will engage with all the key practical aspects of a simulation, from managing curvilinear coordinates to ensuring the positivity of physical quantities like energy density.",
            "id": "3516450",
            "problem": "Implement a complete, runnable program that numerically solves the ideal relativistic hydrodynamics equations for a conformal fluid in Milne coordinates using a Kurganov–Tadmor central scheme with total variation diminishing (TVD) limiters, and tests positivity preservation of the energy density and pressure in a transverse two-dimensional ($2$D) blast-wave problem. The implementation must start from the covariant conservation of the energy–momentum tensor and use an equation of state appropriate to conformal matter, with the coordinate system chosen to reflect the longitudinal boost invariance relevant to ultrarelativistic heavy-ion collisions. The algorithm must be designed from first principles and must not assume any pre-packaged fluid solver. The required numerical outputs are binary indicators of whether the computed fields remain non-negative under each test configuration.\n\nPhysical and mathematical model:\n- Use the covariant conservation law $\\nabla_{\\mu} T^{\\mu \\nu} = 0$ as the fundamental starting point, where the ideal fluid energy–momentum tensor is $T^{\\mu \\nu} = (\\epsilon + p)\\, u^{\\mu} u^{\\nu} - p\\, g^{\\mu \\nu}$ with energy density $\\epsilon$, pressure $p$, and fluid four-velocity $u^{\\mu}$. Work in Milne coordinates $(\\tau, x, y, \\eta)$ with metric $g_{\\mu \\nu} = \\mathrm{diag}(1, -1, -1, -\\tau^{2})$, assume longitudinal boost invariance (no dependence on spatial rapidity $\\eta$) and $u^{\\eta} = 0$. The equation of state is conformal: $p = c_{s}^{2}\\, \\epsilon$ with $c_{s}^{2} = 1/3$.\n- Starting from the conservation law and the Milne metric, reduce the system to a conservative form for the transverse plane with proper time $\\tau$ as the evolution variable. Denote $Q^{\\nu} = T^{\\tau \\nu}$ with $\\nu \\in \\{\\tau, x, y\\}$. Show that the equations can be written in the form\n$$\n\\partial_{\\tau} \\left( \\tau\\, Q^{\\nu} \\right) + \\partial_{x} \\left( \\tau\\, T^{x \\nu} \\right) + \\partial_{y} \\left( \\tau\\, T^{y \\nu} \\right) = S^{\\nu}(\\tau, \\mathbf{x}),\n$$\nwhere $S^{\\tau} = -p$ and $S^{x} = S^{y} = 0$, consistently derived from $\\nabla_{\\mu} T^{\\mu \\nu} = 0$ using the non-vanishing Christoffel symbols of the Milne metric. This establishes the conservative variables $\\tau\\, Q^{\\nu}$ and their geometric source terms.\n\nNumerical algorithm requirements:\n- Implement a Kurganov–Tadmor central-upwind scheme in the transverse directions with TVD slope limiting (e.g., minmod family) to achieve second-order accuracy in space while controlling spurious oscillations near strong gradients. Use a two-stage Strong Stability Preserving Runge–Kutta (SSP-RK$2$) time integrator for the semi-discrete system.\n- Reconstruct left and right states at each face using limited slopes applied to primitive variables $(\\epsilon, v_{x}, v_{y})$, where $v_{i}$ are the spatial components of the three-velocity and $u^{\\mu} = \\gamma \\, (1, v_{x}, v_{y}, 0)$ with $\\gamma = 1/\\sqrt{1 - v^{2}}$ and $v^{2} = v_{x}^{2} + v_{y}^{2}$. Compute fluxes $T^{i \\nu}$ from the reconstructed primitives and use them in the central scheme.\n- Determine local one-dimensional signal speeds in direction $n \\in \\{x,y\\}$ from the relativistic velocity addition rule as\n$$\n\\lambda_{\\pm} = \\frac{v_{n} \\pm c_{s}}{1 \\pm v_{n}\\, c_{s}},\n$$\nwhere $c_{s} = \\sqrt{c_{s}^{2}}$. Use these to set the central-upwind flux’s one-sided speeds $a^{+} = \\max(0, \\lambda_{+}^{L}, \\lambda_{+}^{R})$ and $a^{-} = \\min(0, \\lambda_{-}^{L}, \\lambda_{-}^{R})$ at each face.\n- At each stage, recover primitive variables from the conservative ones by inverting the ideal-fluid relations for $T^{\\mu \\nu}$ under the conformal equation of state. This inversion must be derived from first principles using the definitions of $T^{\\mu \\nu}$ and the relation $p = c_{s}^{2}\\, \\epsilon$, and it must ensure $v^{2}  1$. Adopt a robust method that handles strong gradients.\n- Use an explicit Courant–Friedrichs–Lewy (CFL) condition based on the maximum local signal speeds to choose the time step $\\Delta \\tau$. The underlying spatial discretization is uniform with grid spacings $\\Delta x$ and $\\Delta y$.\n- Boundary conditions: adopt transmissive (zero-gradient) outflow conditions at the transverse boundaries.\n\nBlast-wave initial condition:\n- Consider a blast-wave initial condition in the transverse plane at proper time $\\tau_{0}$ in which the energy density is centrally peaked and the initial transverse flow vanishes. Use a smooth radial profile to avoid non-physical oscillations. Specifically, with radius $r = \\sqrt{x^{2} + y^{2}}$, initialize\n$$\n\\epsilon(\\tau_{0}, x, y) = \\epsilon_{\\mathrm{out}} + \\left(\\epsilon_{\\mathrm{in}} - \\epsilon_{\\mathrm{out}}\\right) \\exp \\left( -\\frac{r^{2}}{2 \\sigma^{2}} \\right),\n$$\nwith $\\sigma = r_{0} / 2$, initial $v_{x}(\\tau_{0}, x, y) = 0$, and initial $v_{y}(\\tau_{0}, x, y) = 0$. Set $p(\\tau_{0}, x, y) = c_{s}^{2}\\, \\epsilon(\\tau_{0}, x, y)$.\n- Adopt natural units where $\\hbar = c = k_{B} = 1$, so all quantities are dimensionless, and no explicit physical units are required in the output.\n\nComputational domain and discretization:\n- Transverse domain: $x, y \\in [-L, L]$ with $L$ specified per test.\n- Uniform grid with $N_{x} \\times N_{y}$ cells. Use $N_{x} = N_{y} = 40$. Grid spacings are $\\Delta x = 2L/N_{x}$ and $\\Delta y = 2L/N_{y}$.\n- Evolve from $\\tau_{0}$ to $\\tau_{f}$ with a constant equation of state parameter $c_{s}^{2} = 1/3$.\n\nTest suite:\n- Implement the solver and run it for the following three parameter sets. In each, $N_{x} = N_{y} = 40$, $c_{s}^{2} = 1/3$, initial transverse velocities are zero, reconstruction limiter parameter $\\theta = 1.8$, Courant factor $\\mathrm{CFL} = 0.4$, transmissive boundaries, and SSP-RK$2$ is used.\n    1. Case A (happy path): $L = 6.0$, $\\tau_{0} = 0.6$, $\\tau_{f} = 1.0$, $\\epsilon_{\\mathrm{in}} = 10.0$, $\\epsilon_{\\mathrm{out}} = 1.0$, $r_{0} = 1.5$.\n    2. Case B (low exterior energy, stronger gradient): $L = 6.0$, $\\tau_{0} = 0.6$, $\\tau_{f} = 1.0$, $\\epsilon_{\\mathrm{in}} = 8.0$, $\\epsilon_{\\mathrm{out}} = 0.2$, $r_{0} = 1.0$.\n    3. Case C (narrow hot spot): $L = 6.0$, $\\tau_{0} = 0.6$, $\\tau_{f} = 1.0$, $\\epsilon_{\\mathrm{in}} = 12.0$, $\\epsilon_{\\mathrm{out}} = 0.5$, $r_{0} = 0.8$.\n- For each case, after evolving to $\\tau_{f}$, compute the minimum values of $\\epsilon$ and $p$ over all grid cells. Define a positivity indicator $\\Pi$ that equals $1$ if both $\\min \\epsilon \\ge 0$ and $\\min p \\ge 0$, and equals $0$ otherwise.\n\nFinal output format:\n- Your program should produce a single line of output containing the three positivity indicators for the test cases as a comma-separated list enclosed in square brackets. For example: \"[1,1,1]\".\n- The program must not require any user input and must not read or write any external files. It must run to completion under the specified execution environment.\n\nNotes:\n- Your derivation must start from $\\nabla_{\\mu} T^{\\mu \\nu} = 0$ and the definition of $T^{\\mu \\nu}$, and may use well-tested relations such as the relativistic signal speeds for a barotropic ideal fluid. Avoid invoking pre-derived discretization shortcuts in the problem statement; the full algorithmic pathway must be made explicit in your implementation and in the solution discussion.",
            "solution": "The user-provided problem is a valid, well-posed, and scientifically grounded task in computational high-energy physics. It requires the implementation of a numerical solver for the equations of ideal relativistic hydrodynamics in a specific coordinate system relevant to heavy-ion collisions. The problem specifies the physical model, governing equations, numerical methods, initial and boundary conditions, and test parameters with complete clarity. All terms are formally defined, and the required output is objective and verifiable. The solution proceeds as follows.\n\n### 1. Derivation of the Equations of Motion\n\nThe fundamental equation is the covariant conservation of the energy-momentum tensor, $\\nabla_{\\mu} T^{\\mu \\nu} = 0$. For a general coordinate system, this can be written as:\n$$\n\\frac{1}{\\sqrt{-g}} \\partial_{\\mu} (\\sqrt{-g} T^{\\mu \\nu}) + \\Gamma^{\\nu}_{\\sigma \\rho} T^{\\sigma \\rho} = 0\n$$\nwhere $\\Gamma^{\\nu}_{\\sigma \\rho}$ are the Christoffel symbols and $g$ is the determinant of the metric tensor $g_{\\mu \\nu}$.\n\nThe problem is formulated in Milne coordinates $(\\tau, x, y, \\eta)$, with the metric tensor $g_{\\mu \\nu} = \\mathrm{diag}(1, -1, -1, -\\tau^2)$. The metric determinant is $g = (1)(-1)(-1)(-\\tau^2) = -\\tau^2$, so $\\sqrt{-g} = \\tau$. The non-vanishing Christoffel symbols for this metric are $\\Gamma^{\\tau}_{\\eta\\eta} = \\tau$ and $\\Gamma^{\\eta}_{\\tau\\eta} = \\Gamma^{\\eta}_{\\eta\\tau} = 1/\\tau$.\n\nSubstituting $\\sqrt{-g} = \\tau$ into the conservation law and multiplying by $\\tau$ yields:\n$$\n\\partial_{\\mu} (\\tau T^{\\mu \\nu}) + \\tau \\Gamma^{\\nu}_{\\sigma \\rho} T^{\\sigma \\rho} = 0\n$$\nWe assume longitudinal boost invariance, so all derivatives with respect to spatial rapidity $\\eta$ vanish, i.e., $\\partial_{\\eta} = 0$. The equation becomes:\n$$\n\\partial_{\\tau} (\\tau T^{\\tau \\nu}) + \\partial_{x} (\\tau T^{x \\nu}) + \\partial_{y} (\\tau T^{y \\nu}) = -\\tau \\Gamma^{\\nu}_{\\sigma \\rho} T^{\\sigma \\rho}\n$$\nThis matches the required conservative form $\\partial_{\\tau} \\left( \\tau\\, Q^{\\nu} \\right) + \\partial_{x} \\left( \\tau\\, T^{x \\nu} \\right) + \\partial_{y} \\left( \\tau\\, T^{y \\nu} \\right) = S^{\\nu}$, with conserved variables $U^{\\nu} = \\tau Q^{\\nu} = \\tau T^{\\tau \\nu}$ and source term $S^{\\nu} = -\\tau \\Gamma^{\\nu}_{\\sigma \\rho} T^{\\sigma \\rho}$.\n\nWe now compute the source terms for $\\nu \\in \\{\\tau, x, y\\}$.\n*   For $\\nu=x$ and $\\nu=y$, the Christoffel symbols $\\Gamma^{x}_{\\sigma\\rho}$ and $\\Gamma^{y}_{\\sigma\\rho}$ are all zero. Thus, $S^{x} = 0$ and $S^{y} = 0$.\n*   For $\\nu=\\tau$, the only non-zero Christoffel symbol is $\\Gamma^{\\tau}_{\\eta\\eta} = \\tau$. The source term is $S^{\\tau} = -\\tau \\Gamma^{\\tau}_{\\eta\\eta} T^{\\eta\\eta} = -\\tau^2 T^{\\eta\\eta}$.\n\nThe energy-momentum tensor is $T^{\\mu \\nu} = (\\epsilon + p) u^{\\mu} u^{\\nu} - p g^{\\mu \\nu}$. The inverse metric is $g^{\\mu \\nu} = \\mathrm{diag}(1, -1, -1, -1/\\tau^2)$. With the condition $u^\\eta=0$, the $T^{\\eta\\eta}$ component is:\n$$\nT^{\\eta\\eta} = (\\epsilon + p) (u^{\\eta})^2 - p g^{\\eta\\eta} = 0 - p (-1/\\tau^2) = p/\\tau^2\n$$\nSubstituting this into the expression for $S^{\\tau}$:\n$$\nS^{\\tau} = -\\tau^2 (p/\\tau^2) = -p\n$$\nThis confirms the source terms given in the problem statement: $S^{\\tau} = -p$ and $S^{x} = S^{y} = 0$. The term $S^{\\tau}=-p$ represents the work done by pressure due to the longitudinal expansion of the system, causing the total energy in a transverse slice to decrease over time.\n\n### 2. State Vectors and Conversions\n\nThe numerical simulation evolves a vector of conserved variables $\\mathbf{U} = (\\tau T^{\\tau\\tau}, \\tau T^{\\tau x}, \\tau T^{\\tau y})^T$. However, reconstruction and flux calculations are most naturally performed using primitive variables $\\mathbf{V} = (\\epsilon, v_x, v_y)^T$. Therefore, robust conversion routines between these two representations are essential.\n\n**Primitive-to-Conserved:** Given $\\mathbf{V} = (\\epsilon, v_x, v_y)^T$, we use the conformal EoS $p = c_s^2 \\epsilon$ with $c_s^2=1/3$. The Lorentz factor is $\\gamma = (1-v_x^2-v_y^2)^{-1/2}$. The components of the energy-momentum tensor are:\n$$\nT^{\\tau\\tau} = (\\epsilon + p)\\gamma^2 - p = \\epsilon(1+c_s^2)\\gamma^2 - c_s^2\\epsilon \\\\\nT^{\\tau x} = (\\epsilon + p)\\gamma^2 v_x = \\epsilon(1+c_s^2)\\gamma^2 v_x \\\\\nT^{\\tau y} = (\\epsilon + p)\\gamma^2 v_y = \\epsilon(1+c_s^2)\\gamma^2 v_y\n$$\nThe conserved variables are then $U^{\\nu} = \\tau T^{\\tau\\nu}$.\n\n**Conserved-to-Primitive:** This inversion is more complex. Let $S_{\\tau} = U_0/\\tau = T^{\\tau\\tau}$ and $M_{i} = U_{i}/\\tau = T^{\\tau i}$. Let $M^2=M_x^2+M_y^2$. We have:\n$$\nS_{\\tau} + p = (\\epsilon+p)\\gamma^2 \\quad \\text{and} \\quad \\mathbf{M} = (\\epsilon+p)\\gamma^2\\mathbf{v}\n$$\nFrom these, we derive a quadratic equation for the energy density $\\epsilon$:\n$$\nc_s^2 \\epsilon^2 + S_{\\tau}(1-c_s^2)\\epsilon - (S_{\\tau}^2 - M^2) = 0\n$$\nSolving for $\\epsilon > 0$ and substituting $c_s^2=1/3$, we obtain:\n$$\n\\epsilon = -S_{\\tau} + \\sqrt{4S_{\\tau}^2 - 3M^2}\n$$\nThis requires the argument of the square root to be non-negative. Once $\\epsilon$ is found, pressure is $p=c_s^2 \\epsilon$. The velocities are then recovered from:\n$$\nv_x = \\frac{M_x}{S_{\\tau} + p}, \\quad v_y = \\frac{M_y}{S_{\\tau} + p}\n$$\nA robust implementation must handle potential numerical issues, such as the square root argument becoming negative or the resulting velocity squared $v^2$ exceeding $1$.\n\n### 3. Numerical Algorithm\n\nThe solver is implemented using a finite-volume method. The domain is divided into cells, and the evolution equation is integrated over each cell.\n\n**Spatial Discretization:** The Kurganov-Tadmor (KT) central-upwind scheme is used to compute numerical fluxes at cell interfaces. This scheme is well-suited for hyperbolic conservation laws as it properly incorporates signal propagation speeds to ensure stability. The numerical flux $\\hat{\\mathbf{F}}$ between a left (L) and right (R) state is:\n$$\n\\hat{\\mathbf{F}} = \\frac{a^+ \\mathbf{F}(\\mathbf{V}_R) - a^- \\mathbf{F}(\\mathbf{V}_L)}{a^+ - a^-} + \\frac{a^+ a^-}{a^+ - a^-} (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nwhere $\\mathbf{F}$ is the physical flux vector, and $a^+$ and $a^-$ are the maximum right-going and minimum left-going signal speeds at the interface, respectively. These speeds are computed from the relativistic velocity addition formula for sound waves: $\\lambda_{\\pm} = (v_n \\pm c_s) / (1 \\pm v_n c_s)$, where $v_n$ is the fluid velocity normal to the interface.\n\n**Second-Order Reconstruction:** To achieve second-order spatial accuracy, the states $\\mathbf{V}_L$ and $\\mathbf{V}_R$ are obtained by a linear reconstruction from cell-averaged values. A Total Variation Diminishing (TVD) slope limiter is applied to prevent spurious oscillations near sharp gradients (shocks or contact discontinuities). The specific implementation uses a generalized minmod limiter with a parameter $\\theta=1.8$, which provides a balance between being diffusive and compressive.\n\n**Time Integration:** A two-stage, second-order Strong Stability Preserving Runge-Kutta (SSP-RK2) method is used for time evolution. This ensures that the time-stepping does not introduce new oscillations and preserves the stability properties of the spatial discretization. A Courant-Friedrichs-Lewy (CFL) condition determines the time step $\\Delta\\tau$ based on the maximum signal speed across the grid, ensuring numerical stability.\n\n**Positivity Check:** The problem requires testing whether the energy density $\\epsilon$ and pressure $p$ remain non-negative throughout the evolution. Since $p=c_s^2\\epsilon$ and $c_s^20$, this reduces to checking if $\\min(\\epsilon) \\ge 0$. After the final time step, the minimum value of $\\epsilon$ is computed across the grid. A binary indicator is set to $1$ if this condition is met, and $0$ otherwise. High-gradient regions or insufficient resolution can lead to numerical errors that violate positivity, a common challenge in hydrodynamic simulations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global constants and simulation parameters\nC_S2 = 1.0 / 3.0\nC_S = np.sqrt(C_S2)\nGHOST_CELLS = 2\n\ndef minmod_limiter(a, b, theta):\n    \"\"\"\n    Generalized minmod limiter with parameter theta for slope reconstruction.\n    \"\"\"\n    if a * b = 0:\n        return 0.0\n    else:\n        return np.sign(a) * min(abs(a) * theta, abs(b) * theta, 0.5 * abs(a + b))\n\ndef cons_to_prim(U, tau):\n    \"\"\"\n    Converts a conserved variable vector U to a primitive variable vector V = (epsilon, vx, vy).\n    U = (tau*T_tt, tau*T_tx, tau*T_ty)\n    \"\"\"\n    S_tau = U[0] / tau\n    M_x = U[1] / tau\n    M_y = U[2] / tau\n    M_sq = M_x**2 + M_y**2\n\n    rad_arg = 4.0 * S_tau**2 - 3.0 * M_sq\n    if rad_arg  0:\n        return np.array([1e-9, 0.0, 0.0])\n\n    eps = -S_tau + np.sqrt(rad_arg)\n    \n    if eps = 0:\n        return np.array([1e-9, 0.0, 0.0])\n\n    p = C_S2 * eps\n    S_tau_plus_p = S_tau + p\n    \n    if abs(S_tau_plus_p)  1e-12:\n        return np.array([eps, 0.0, 0.0])\n        \n    v_sq = M_sq / (S_tau_plus_p**2)\n    vx = M_x / S_tau_plus_p\n    vy = M_y / S_tau_plus_p\n\n    if v_sq = 1.0:\n        factor = 0.99999 / np.sqrt(v_sq)\n        vx *= factor\n        vy *= factor\n\n    return np.array([eps, vx, vy])\n\ndef prim_to_cons(V, tau):\n    \"\"\"Converts primitive variables V to conserved variables U.\"\"\"\n    eps, vx, vy = V\n    v_sq = vx**2 + vy**2\n    if v_sq = 1.0:\n        gamma = 1e6\n    else:\n        gamma = 1.0 / np.sqrt(1.0 - v_sq)\n        \n    p = C_S2 * eps\n    h = eps + p\n    \n    T_tt = h * gamma**2 - p\n    T_tx = h * gamma**2 * vx\n    T_ty = h * gamma**2 * vy\n    \n    return np.array([tau * T_tt, tau * T_tx, tau * T_ty])\n\ndef prim_to_flux_x(V, tau):\n    \"\"\"Calculates x-flux from primitive variables V.\"\"\"\n    eps, vx, vy = V\n    v_sq = vx**2 + vy**2\n    if v_sq = 1.0:\n        gamma = 1e6\n    else:\n        gamma = 1.0 / np.sqrt(1.0 - v_sq)\n        \n    p = C_S2 * eps\n    h = eps + p\n    \n    F_x = np.zeros(3)\n    F_x[0] = tau * h * gamma**2 * vx\n    F_x[1] = tau * (h * gamma**2 * vx**2 + p)\n    F_x[2] = tau * h * gamma**2 * vx * vy\n    return F_x\n\ndef prim_to_flux_y(V, tau):\n    \"\"\"Calculates y-flux from primitive variables V.\"\"\"\n    eps, vx, vy = V\n    v_sq = vx**2 + vy**2\n    if v_sq = 1.0:\n        gamma = 1e6\n    else:\n        gamma = 1.0 / np.sqrt(1.0 - v_sq)\n        \n    p = C_S2 * eps\n    h = eps + p\n    \n    F_y = np.zeros(3)\n    F_y[0] = tau * h * gamma**2 * vy\n    F_y[1] = tau * h * gamma**2 * vx * vy\n    F_y[2] = tau * (h * gamma**2 * vy**2 + p)\n    return F_y\n\ndef apply_bcs(V_grid):\n    \"\"\"Applies transmissive (zero-gradient) boundary conditions.\"\"\"\n    gh = GHOST_CELLS\n    Nx_phy, Ny_phy, _ = V_grid.shape\n    Nx, Ny = Nx_phy - 2 * gh, Ny_phy - 2 * gh\n\n    for i in range(gh):\n        V_grid[i, :, :] = V_grid[gh, :, :]\n        V_grid[Nx + gh + i, :, :] = V_grid[Nx + gh - 1, :, :]\n    \n    for j in range(gh):\n        V_grid[:, j, :] = V_grid[:, gh, :]\n        V_grid[:, Ny + gh + j, :] = V_grid[:, Ny + gh - 1, :]\n\ndef get_source(V):\n    \"\"\"Calculates the source term S = (-p, 0, 0).\"\"\"\n    eps = V[0]\n    p = C_S2 * eps\n    return np.array([-p, 0.0, 0.0])\n\ndef compute_rhs(V_grid, tau, dx, dy, Nx, Ny, theta):\n    gh = GHOST_CELLS\n    Nx_full, Ny_full, _ = V_grid.shape\n    RHS = np.zeros_like(V_grid)\n    \n    # X-direction sweep\n    slopes_x = np.zeros_like(V_grid)\n    for j in range(Ny_full):\n        for i in range(1, Nx_full - 1):\n             for k in range(3):\n                slopes_x[i, j, k] = minmod_limiter(V_grid[i, j, k] - V_grid[i-1, j, k], V_grid[i+1, j, k] - V_grid[i, j, k], theta)\n\n    for j in range(gh, Ny + gh):\n        for i in range(gh - 1, Nx + gh):\n            VL = V_grid[i, j, :] + 0.5 * slopes_x[i, j, :]\n            VR = V_grid[i+1, j, :] - 0.5 * slopes_x[i+1, j, :]\n            \n            UL = prim_to_cons(VL, tau)\n            UR = prim_to_cons(VR, tau)\n            FxL = prim_to_flux_x(VL, tau)\n            FxR = prim_to_flux_x(VR, tau)\n            \n            lambda_p_L = (VL[1] + C_S) / (1. + VL[1]*C_S)\n            lambda_m_L = (VL[1] - C_S) / (1. - VL[1]*C_S)\n            lambda_p_R = (VR[1] + C_S) / (1. + VR[1]*C_S)\n            lambda_m_R = (VR[1] - C_S) / (1. - VR[1]*C_S)\n            \n            ap = max(0.0, lambda_p_L, lambda_p_R)\n            am = min(0.0, lambda_m_L, lambda_m_R)\n            \n            if ap - am  1e-9:\n                flux = (ap * FxL - am * FxR + ap * am * (UR - UL)) / (ap - am)\n            else:\n                flux = 0.5 * (FxL + FxR)\n            \n            RHS[i, j, :] -= flux / dx\n            RHS[i+1, j, :] += flux / dx\n\n    # Y-direction sweep\n    slopes_y = np.zeros_like(V_grid)\n    for i in range(Nx_full):\n        for j in range(1, Ny_full-1):\n             for k in range(3):\n                slopes_y[i, j, k] = minmod_limiter(V_grid[i, j, k] - V_grid[i, j-1, k], V_grid[i, j+1, k] - V_grid[i, j, k], theta)\n                \n    for i in range(gh, Nx + gh):\n        for j in range(gh - 1, Ny + gh):\n            VL = V_grid[i, j, :] + 0.5 * slopes_y[i, j, :]\n            VR = V_grid[i, j+1, :] - 0.5 * slopes_y[i, j+1, :]\n\n            UL = prim_to_cons(VL, tau)\n            UR = prim_to_cons(VR, tau)\n            FyL = prim_to_flux_y(VL, tau)\n            FyR = prim_to_flux_y(VR, tau)\n\n            lambda_p_L = (VL[2] + C_S) / (1. + VL[2]*C_S)\n            lambda_m_L = (VL[2] - C_S) / (1. - VL[2]*C_S)\n            lambda_p_R = (VR[2] + C_S) / (1. + VR[2]*C_S)\n            lambda_m_R = (VR[2] - C_S) / (1. - VR[2]*C_S)\n\n            ap = max(0.0, lambda_p_L, lambda_p_R)\n            am = min(0.0, lambda_m_L, lambda_m_R)\n            \n            if ap - am  1e-9:\n                flux = (ap * FyL - am * FyR + ap * am * (UR - UL)) / (ap - am)\n            else:\n                flux = 0.5 * (FyL + FyR)\n\n            RHS[i, j, :] -= flux / dy\n            RHS[i, j+1, :] += flux / dy\n            \n    # Add source term\n    for i in range(gh, Nx + gh):\n       for j in range(gh, Ny + gh):\n           RHS[i, j, :] += get_source(V_grid[i, j, :])\n           \n    return RHS\n\ndef solve_hydro(L, tau0, tauf, eps_in, eps_out, r0, Nx, Ny, CFL, theta):\n    \"\"\"Main hydro solver function for one test case.\"\"\"\n    dx = 2.0 * L / Nx\n    dy = 2.0 * L / Ny\n    gh = GHOST_CELLS\n    \n    Nx_full, Ny_full = Nx + 2*gh, Ny + 2*gh\n    V_grid = np.zeros((Nx_full, Ny_full, 3))\n    \n    x_coords = np.linspace(-L - (gh - 0.5)*dx, L + (gh - 0.5)*dx, Nx_full)\n    y_coords = np.linspace(-L - (gh - 0.5)*dy, L + (gh - 0.5)*dy, Ny_full)\n    \n    sigma_blast = r0 / 2.0\n    for i in range(Nx_full):\n        for j in range(Ny_full):\n            r = np.sqrt(x_coords[i]**2 + y_coords[j]**2)\n            eps_val = eps_out + (eps_in - eps_out) * np.exp(-r**2 / (2 * sigma_blast**2))\n            V_grid[i, j, :] = [eps_val, 0.0, 0.0]\n\n    U_grid = np.zeros_like(V_grid)\n    for i in range(Nx_full):\n        for j in range(Ny_full):\n            U_grid[i, j, :] = prim_to_cons(V_grid[i, j, :], tau0)\n            \n    tau = tau0\n    while tau  tauf:\n        apply_bcs(V_grid)\n        \n        max_speed = 1e-9\n        for i in range(gh, Nx + gh):\n            for j in range(gh, Ny + gh):\n                _, vx, vy = V_grid[i,j]\n                speed_x = (abs(vx) + C_S) / (1. + abs(vx)*C_S)\n                speed_y = (abs(vy) + C_S) / (1. + abs(vy)*C_S)\n                max_speed = max(max_speed, speed_x, speed_y)\n        \n        dt = CFL * min(dx, dy) / max_speed\n        if tau + dt  tauf:\n            dt = tauf - tau\n        \n        # SSP-RK2 Stage 1\n        RHS_n = compute_rhs(V_grid, tau, dx, dy, Nx, Ny, theta)\n        U1 = U_grid + dt * RHS_n\n        V1 = np.zeros_like(V_grid)\n        for i in range(Nx_full):\n            for j in range(Ny_full):\n                 V1[i, j, :] = cons_to_prim(U1[i,j], tau + dt)\n\n        # SSP-RK2 Stage 2\n        apply_bcs(V1)\n        RHS_1 = compute_rhs(V1, tau + dt, dx, dy, Nx, Ny, theta)\n        U_np1 = 0.5 * U_grid + 0.5 * (U1 + dt * RHS_1)\n\n        # Update for next step\n        U_grid = U_np1\n        for i in range(Nx_full):\n            for j in range(Ny_full):\n                V_grid[i, j, :] = cons_to_prim(U_grid[i,j], tau + dt)\n        tau += dt\n    \n    min_eps = np.min(V_grid[gh:-gh, gh:-gh, 0])\n    return 1 if min_eps = 0.0 else 0\n\ndef solve():\n    test_cases = [\n        # (Parameter set 1: Case A)\n        {'L': 6.0, 'tau0': 0.6, 'tauf': 1.0, 'eps_in': 10.0, 'eps_out': 1.0, 'r0': 1.5, 'Nx': 40, 'Ny': 40, 'CFL': 0.4, 'theta': 1.8},\n        # (Parameter set 2: Case B)\n        {'L': 6.0, 'tau0': 0.6, 'tauf': 1.0, 'eps_in': 8.0, 'eps_out': 0.2, 'r0': 1.0, 'Nx': 40, 'Ny': 40, 'CFL': 0.4, 'theta': 1.8},\n        # (Parameter set 3: Case C)\n        {'L': 6.0, 'tau0': 0.6, 'tauf': 1.0, 'eps_in': 12.0, 'eps_out': 0.5, 'r0': 0.8, 'Nx': 40, 'Ny': 40, 'CFL': 0.4, 'theta': 1.8},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = solve_hydro(**params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}