{
    "hands_on_practices": [
        {
            "introduction": "布莱特-维格纳（Breit-Wigner）分布是描述不稳定粒子的基石。在许多应用中，窄宽度近似（Narrow Width Approximation, NWA）通过将共振态视为一个壳上（on-shell）态，提供了一种极其宝贵的简化方法。本练习将指导您从第一性原理推导窄宽度近似的积分形式，更重要的是，计算其领头阶修正，从而对该近似的适用范围和局限性建立定量的理解 。",
            "id": "3531465",
            "problem": "考虑一个在高能散射过程中产生的标量不稳定共振，它由一个标量场的因果传播子来建模，其模的平方在共振峰附近由相对论性布赖特-维格纳线型给出，\n$$\n|D(s)|^{2} \\equiv \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, ,\n$$\n其中 $M$ 是极点质量，$\\Gamma$ 是总衰变宽度。在窄宽度近似 (NWA) 中，定义为极限 $\\Gamma/M \\to 0$，总截面或衰变率通常通过对不变质量平方 $s$ 进行积分来计算，积分中包含一个缓变因子 $f(s)$，该因子编码了剩余的动力学和相空间信息。在此近似下，人们将 $f(s)$ 替换为 $f(M^{2})$，并从对布赖特-维格纳分布的 $s$ 积分中提取一个普适的归一化因子。\n\n从因果传播子和标准的实分析出发，执行以下步骤：\n1. 仅使用相对论性布莱特-维格纳分布的性质和 NWA 的定义，说明对共振因子的 $s$ 积分是如何由 $s = M^{2}$ 附近的区域所主导的。\n2. 计算共振因子在物理上允许的区域 $s \\in [0,\\infty)$ 上的积分，\n$$\nI_{0}^{\\infty} \\equiv \\int_{0}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, ,\n$$\n并将其与在整个实轴上的理想化积分进行比较，\n$$\nI_{-\\infty}^{\\infty} \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n3. 在极限 $\\Gamma/M \\ll 1$ 下，推导领头的分数修正\n$$\n\\delta \\equiv \\frac{I_{0}^{\\infty} - I_{-\\infty}^{\\infty}}{I_{-\\infty}^{\\infty}}\n$$\n该修正纯粹源于物理下限 $s \\geq 0$（即，省略了非物理区域 $s  0$），并将其表示为关于 $\\Gamma/M$ 的领头阶的闭合形式解析表达式。\n\n请提供 $\\delta$ 关于 $M$ 和 $\\Gamma$ 的解析表达式作为最终答案。不需要进行数值计算，最终表达式中不应包含单位。",
            "solution": "我们首先回顾相对论性布赖特-维格纳分布在不稳定标量粒子的因果传播子中的起源。标量传播子作为不变质量平方 $s$ 的函数为\n$$\nD(s) \\sim \\frac{1}{s - M^{2} + i M \\Gamma} \\, ,\n$$\n因此，通过 $|D(s)|^{2}$ 进入截面计算的共振因子是\n$$\n|D(s)|^{2} = \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n在由 $\\Gamma/M \\to 0$ 定义的窄宽度近似 (NWA) 中，被积函数在 $s = M^{2}$ 处有一个尖锐的峰，其宽度由 $M \\Gamma$ 控制。因此，当与一个缓变函数 $f(s)$ 进行积分时，在对积分起主导贡献的狭窄区域内，可以近似地认为 $f(s) \\approx f(M^{2})$。这将计算简化为对布赖特-维格纳分布的一个普适归一化积分。\n\n我们现在计算两个相关的积分。首先，考虑在整个实轴上的积分：\n$$\nI_{-\\infty}^{\\infty} \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n进行变量替换\n$$\nu \\equiv \\frac{s - M^{2}}{M \\Gamma} \\quad \\Rightarrow \\quad s = M^{2} + M \\Gamma \\, u \\,, \\quad \\mathrm{d}s = M \\Gamma \\, \\mathrm{d}u \\, .\n$$\n分母变为\n$$\n(s - M^{2})^{2} + M^{2}\\Gamma^{2} = (M \\Gamma)^{2}(u^{2} + 1) \\, ,\n$$\n所以积分为\n$$\nI_{-\\infty}^{\\infty} = \\int_{-\\infty}^{\\infty} \\frac{M \\Gamma \\, \\mathrm{d}u}{(M \\Gamma)^{2}(u^{2} + 1)} = \\frac{1}{M \\Gamma} \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}u}{u^{2} + 1} = \\frac{1}{M \\Gamma} \\left[ \\arctan(u) \\right]_{-\\infty}^{\\infty} = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} - \\left( - \\frac{\\pi}{2} \\right) \\right) = \\frac{\\pi}{M \\Gamma} \\, .\n$$\n\n接下来，考虑物理上允许的区域 $s \\in [0,\\infty)$:\n$$\nI_{0}^{\\infty} \\equiv \\int_{0}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n使用相同的变量替换，积分下限 $s = 0$ 映射到\n$$\nu_{0} = \\frac{0 - M^{2}}{M \\Gamma} = - \\frac{M}{\\Gamma} \\, ,\n$$\n而积分上限 $s \\to \\infty$ 映射到 $u \\to \\infty$。因此，\n$$\nI_{0}^{\\infty} = \\frac{1}{M \\Gamma} \\int_{u_{0}}^{\\infty} \\frac{\\mathrm{d}u}{u^{2} + 1} = \\frac{1}{M \\Gamma} \\left[ \\arctan(u) \\right]_{u_{0}}^{\\infty} = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} - \\arctan\\!\\left( - \\frac{M}{\\Gamma} \\right) \\right) = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) \\right) \\, .\n$$\n\n我们现在计算分数修正\n$$\n\\delta \\equiv \\frac{I_{0}^{\\infty} - I_{-\\infty}^{\\infty}}{I_{-\\infty}^{\\infty}} = \\frac{ \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) \\right) - \\frac{\\pi}{M \\Gamma} }{ \\frac{\\pi}{M \\Gamma} } = \\frac{ \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) - \\pi }{ \\pi } \\, .\n$$\n因此，\n$$\n\\delta = \\frac{ \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) - \\frac{\\pi}{2} }{ \\pi } = - \\frac{ \\frac{\\pi}{2} - \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) }{ \\pi } \\, .\n$$\n\n为了在 $\\Gamma/M \\ll 1$ 的情况下提取领头行为，我们使用反正切函数在大宗量 $x$ 时的标准渐近展开，\n$$\n\\arctan(x) = \\frac{\\pi}{2} - \\frac{1}{x} + \\frac{1}{3 x^{3}} - \\frac{1}{5 x^{5}} + \\cdots \\quad \\text{for} \\quad x \\to \\infty \\, .\n$$\n令 $x = M/\\Gamma$，我们得到\n$$\n\\frac{\\pi}{2} - \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) = \\frac{\\Gamma}{M} - \\frac{1}{3} \\left( \\frac{\\Gamma}{M} \\right)^{3} + \\mathcal{O}\\!\\left( \\left( \\frac{\\Gamma}{M} \\right)^{5} \\right) \\, .\n$$\n将其代入 $\\delta$ 得到领头的分数修正，\n$$\n\\delta = - \\frac{1}{\\pi} \\left( \\frac{\\Gamma}{M} - \\frac{1}{3} \\left( \\frac{\\Gamma}{M} \\right)^{3} + \\cdots \\right) \\, .\n$$\n在 $\\Gamma/M$ 的领头阶上，结果为\n$$\n\\delta \\simeq - \\frac{\\Gamma}{\\pi M} \\, .\n$$\n\n这个负修正反映了一个事实：只在 $s \\geq 0$ 上积分会省略理想化实轴积分中来自 $s  0$ 的贡献（这部分贡献是非物理的，但在数学上存在），从而相对于全实轴积分的结果，减小了归一化值。在 NWA 极限下，该效应被 $\\Gamma/M$ 线性抑制，并在 $\\Gamma/M \\to 0$ 时消失，这与近共振区域占主导地位的结论是一致的。",
            "answer": "$$\\boxed{-\\frac{\\Gamma}{\\pi M}}$$"
        },
        {
            "introduction": "在实际情况中，共振过程很少孤立发生；它经常与一个平滑的非共振背景振幅发生干涉。本练习通过对此类干涉进行建模，深入探究了实验中观察到的复杂线型的量子力学起源 。通过明确推导干涉项，您将发现导致不对称的法诺式（Fano-like）轮廓出现的条件，这是拟合实验数据的关键特征。",
            "id": "3531483",
            "problem": "考虑高能物理中一个孤立 $s$ 道共振附近的弹性、自旋平均的单通道散射过程。在一个能够描述离壳效应以及共振极点与光滑非共振连续谱之间干涉的玩具模型中，标量振幅被建模为\n$$\nA(s) \\;=\\; \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma} \\;+\\; b\\,\\exp(i\\,\\phi),\n$$\n其中 $c$、$b$ 和 $\\phi$ 是实常数，$M$ 是共振质量，$\\Gamma$ 是其恒定的总宽度，$s$ 是通常的 Mandelstam 不变量。可测量的速率通过振幅的相干叠加与 $|A(s)|^{2}$ 成正比。假设 $M0$，$\\Gamma0$，$b\\ge 0$，且 $\\phi$ 是一个以弧度表示的角度。\n\n从振幅的相干叠加和复数模的定义出发，推导出对 $|A(s)|^{2}$ 的显式干涉贡献项，即关于 $c$ 和 $b$ 都是线性的项。然后，通过引入无量纲离壳变量 $\\varepsilon \\equiv (s - M^{2})/(M\\,\\Gamma)$，分析干涉项在 $\\varepsilon \\mapsto -\\varepsilon$ 变换下的宇称，并推导出线型关于 $s = M^{2}$ 不对称（即 Fano 型偏斜而非纯粹的对称畸变）时 $b$、$c$ 和 $\\phi$ 需满足的充分必要条件。将干涉项的最终结果表示为用 $s$、$M$、$\\Gamma$、$c$、$b$ 和 $\\phi$ 表示的闭式解析表达式。",
            "solution": "总散射振幅 $A(s)$ 是共振振幅 $A_{res}(s)$ 和非共振背景振幅 $A_{bg}(s)$ 的相干和。\n$$\nA(s) = A_{res}(s) + A_{bg}(s)\n$$\n其中\n$$\nA_{res}(s) = \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma}\n$$\n和\n$$\nA_{bg}(s) = b\\,\\exp(i\\,\\phi)\n$$\n可测量的速率与总振幅的模的平方 $|A(s)|^{2}$ 成正比。我们展开这个量：\n$$\n|A(s)|^{2} = \\left( A_{res}(s) + A_{bg}(s) \\right) \\left( A_{res}(s) + A_{bg}(s) \\right)^{*} = \\left( A_{res}(s) + A_{bg}(s) \\right) \\left( A_{res}^{*}(s) + A_{bg}^{*}(s) \\right)\n$$\n$$\n|A(s)|^{2} = |A_{res}(s)|^{2} + |A_{bg}(s)|^{2} + A_{res}(s)A_{bg}^{*}(s) + A_{res}^{*}(s)A_{bg}(s)\n$$\n前两项分别代表来自共振和背景的速率的非相干和。后两项代表这两个过程之间的量子力学干涉。题目要求的是干涉贡献，我们将其记为 $I(s)$：\n$$\nI(s) = A_{res}(s)A_{bg}^{*}(s) + A_{res}^{*}(s)A_{bg}(s)\n$$\n使用对于任意复数 $z$，都有 $z + z^{*} = 2\\,\\text{Re}(z)$ 的性质，干涉项可以写为：\n$$\nI(s) = 2\\,\\text{Re}\\left( A_{res}(s)A_{bg}^{*}(s) \\right)\n$$\n为了计算此项，我们首先求乘积 $A_{res}(s)A_{bg}^{*}(s)$。背景振幅的复共轭是 $A_{bg}^{*}(s) = b\\,\\exp(-i\\,\\phi)$。\n$$\nA_{res}(s)A_{bg}^{*}(s) = \\left( \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma} \\right) \\left( b\\,\\exp(-i\\,\\phi) \\right)\n$$\n为简化实部的提取，我们将共振项的分子和分母同乘以其复共轭 $M^{2} - s + i\\,M\\,\\Gamma$：\n$$\nA_{res}(s) = \\frac{c(M^{2} - s + i\\,M\\,\\Gamma)}{(M^{2} - s - i\\,M\\,\\Gamma)(M^{2} - s + i\\,M\\,\\Gamma)} = \\frac{c(M^{2} - s + i\\,M\\,\\Gamma)}{(M^{2}-s)^{2} + (M\\,\\Gamma)^{2}}\n$$\n现在，乘积变为：\n$$\nA_{res}(s)A_{bg}^{*}(s) = \\frac{cb}{(M^{2}-s)^{2} + (M\\,\\Gamma)^{2}} \\left( M^{2} - s + i\\,M\\,\\Gamma \\right) \\left( \\cos\\phi - i\\,\\sin\\phi \\right)\n$$\n我们展开分子中复数项的乘积：\n$$\n(M^{2} - s + i\\,M\\,\\Gamma)(\\cos\\phi - i\\,\\sin\\phi) = (M^{2}-s)\\cos\\phi - i(M^{2}-s)\\sin\\phi + iM\\Gamma\\cos\\phi - i^{2}M\\Gamma\\sin\\phi\n$$\n$$\n= \\left[ (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right] + i\\left[ M\\Gamma\\cos\\phi - (M^{2}-s)\\sin\\phi \\right]\n$$\n因此，$A_{res}(s)A_{bg}^{*}(s)$ 的实部是：\n$$\n\\text{Re}\\left( A_{res}(s)A_{bg}^{*}(s) \\right) = \\frac{cb \\left( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}\n$$\n总干涉项（关于 $c$ 和 $b$ 都是线性的）是这个量的 2 倍：\n$$\nI(s) = \\frac{2cb \\left( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}\n$$\n这就是干涉项的闭式表达式。\n\n接下来，我们分析该项的宇称。我们引入无量纲变量 $\\varepsilon = \\frac{s - M^{2}}{M\\,\\Gamma}$，这意味着 $s - M^{2} = \\varepsilon M \\Gamma$ 且 $M^{2} - s = -\\varepsilon M \\Gamma$。我们将其代入 $I(s)$ 的表达式中，得到 $I(\\varepsilon)$：\n- 分母：$(M^{2}-s)^{2} + (M\\,\\Gamma)^{2} = (-\\varepsilon M \\Gamma)^{2} + (M\\,\\Gamma)^{2} = (M\\Gamma)^{2}(\\varepsilon^{2} + 1)$。\n- 分子：$2cb \\left( (-\\varepsilon M \\Gamma)\\cos\\phi + M\\Gamma\\sin\\phi \\right) = 2cb M\\Gamma \\left( \\sin\\phi - \\varepsilon\\cos\\phi \\right)$。\n所以，作为 $\\varepsilon$ 函数的干涉项是：\n$$\nI(\\varepsilon) = \\frac{2cb M\\Gamma (\\sin\\phi - \\varepsilon\\cos\\phi)}{(M\\Gamma)^{2}(\\varepsilon^{2} + 1)} = \\frac{2cb}{M\\Gamma} \\frac{\\sin\\phi - \\varepsilon\\cos\\phi}{1+\\varepsilon^{2}}\n$$\n我们可以将其分解为一个偶部（关于 $\\varepsilon=0$ 对称）和一个奇部（关于 $\\varepsilon=0$ 反对称）：\n$$\nI(\\varepsilon) = \\underbrace{\\frac{2cb\\sin\\phi}{M\\Gamma(1+\\varepsilon^{2})}}_{\\text{偶部}} + \\underbrace{\\left(-\\frac{2cb\\cos\\phi}{M\\Gamma}\\frac{\\varepsilon}{1+\\varepsilon^{2}}\\right)}_{\\text{奇部}}\n$$\n速率的线型由 $|A(s)|^{2}$ 决定。让我们用 $\\varepsilon$ 来考察 $|A(s)|^{2}$ 的所有贡献项的宇称：\n$$\n|A_{res}(\\varepsilon)|^{2} = \\left| \\frac{c}{-\\varepsilon M\\Gamma - iM\\Gamma} \\right|^{2} = \\frac{c^{2}}{(M\\Gamma)^{2}(\\varepsilon^{2}+1)} \\quad (\\text{偶})\n$$\n$$\n|A_{bg}(\\varepsilon)|^{2} = |b\\,\\exp(i\\phi)|^{2} = b^{2} \\quad (\\text{偶})\n$$\n总速率为 $|A(\\varepsilon)|^{2} = |A_{res}(\\varepsilon)|^{2} + |A_{bg}(\\varepsilon)|^{2} + I(\\varepsilon)$。由于非干涉项纯粹是 $\\varepsilon$ 的偶函数，因此线型中关于共振峰（$s=M^{2}$，即 $\\varepsilon=0$）的任何不对称性都必须源于干涉项 $I(\\varepsilon)$ 的奇部。\n\n线型不对称的充分必要条件是 $I(\\varepsilon)$ 的奇部非零。奇部是 $-\\frac{2cb\\cos\\phi}{M\\Gamma}\\frac{\\varepsilon}{1+\\varepsilon^{2}}$。要使此项对于任何 $\\varepsilon \\neq 0$ 都非零，其系数必须非零：\n$$\n\\frac{2cb\\cos\\phi}{M\\Gamma} \\neq 0\n$$\n考虑到初始约束条件 $M0$ 和 $\\Gamma0$，该条件简化为：\n$$\nc \\neq 0 \\quad \\text{且} \\quad b \\neq 0 \\quad \\text{且} \\quad \\cos\\phi \\neq 0\n$$\n由于题目规定 $b \\ge 0$，条件 $b \\neq 0$ 变为 $b  0$。条件 $\\cos\\phi \\neq 0$ 意味着相位 $\\phi$ 不能是 $\\pi/2$ 的奇数倍，即对任意整数 $n$，$\\phi \\neq \\frac{(2n+1)\\pi}{2}$。\n这些是线型呈不对称（Fano 型）的充分必要条件。如果 $c=0$，则没有共振。如果 $b=0$，则没有干涉。如果 $\\cos\\phi=0$，则背景与共振分母的实部纯粹异相，导致对称畸变而非偏斜。\n最终要求的结果是对 $|A(s)|^{2}$ 的显式干涉贡献项的解析表达式。",
            "answer": "$$\n\\boxed{\\frac{2cb \\bigl( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\bigr)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}}\n$$"
        },
        {
            "introduction": "本练习旨在连接理论与计算，重点是构建一个更真实的共振模型，即实现一个能量依赖的宽度。常数宽度近似通常是不够的，尤其是在远离共振峰或接近衰变阈值时 。您将实现一个能够正确反映相空间和角动量势垒等基本物理效应的宽度模型，这是现代唯象学和实验分析中的一项基本技能。",
            "id": "3531427",
            "problem": "您的任务是基于基本的两体相空间和角动量势垒考量，使用能量依赖的宽度来建模共振线型。目标是为一个相对论性共振实现一个计算模型，该共振的不变质量平方为 $s$，衰变为两个质量为 $m_f$ 的相同末态粒子，轨道角动量为 $L$。能量依赖的宽度必须遵循标度关系 $p^{2L+1}(s)/s$，其中 $p(s)$ 是共振静止系中任一子粒子的三维动量大小。\n\n从计算高能物理相关的基本原理出发，使用以下基本事实：\n\n- 共振的相对论色散关系意味着存在一个传播子，其虚部由衰变过程通过光学定理确定，从而导致宽度依赖于相空间和相互作用动力学。\n- 对于一个不变质量为 $\\sqrt{s}$ 的母粒子衰变为两个质量为 $m_f$ 的相同粒子的两体衰变，洛伦兹不变的两体相空间密度按 $p(s)/\\sqrt{s}$ 标度。\n- 在阈值附近，离心势垒抑制了轨道角动量为 $L$ 的分波，产生一个与 $p^L(s)$ 成正比的振幅标度因子；因此，衰变率获得一个与 $p^{2L}(s)$ 成正比的因子。\n\n基于这些，建立能量依赖的宽度模型：\n1. 共振静止系中的三维动量大小由下式给出\n$$\np(s) = \\frac{\\sqrt{\\lambda\\!\\left(s,m_f^2,m_f^2\\right)}}{2\\sqrt{s}},\n$$\n其中 Källén 函数为 $\\lambda(a,b,c) = a^2 + b^2 + c^2 - 2ab - 2ac - 2bc$。\n2. 两体阈值为 $s_{\\mathrm{thr}} = (2 m_f)^2$。对于 $s \\le s_{\\mathrm{thr}}$，宽度必须为零。\n3. 归一化到在壳宽度的能量依赖宽度满足\n$$\n\\Gamma_L(s) = \n\\begin{cases}\n\\Gamma_0 \\left(\\dfrac{p(s)}{p(m_R^2)}\\right)^{2L+1} \\left(\\dfrac{m_R^2}{s}\\right),  s  s_{\\mathrm{thr}},\\\\\n0,  s \\le s_{\\mathrm{thr}},\n\\end{cases}\n$$\n其中 $m_R$ 是共振质量，$\\Gamma_0$ 是在 $s=m_R^2$ 时的宽度，$p(m_R^2)$ 是在壳动量。\n4. 共振振幅（线型）由相对论性 Breit–Wigner 传播子建模\n$$\nA_L(s) = \\frac{1}{m_R^2 - s - i\\, m_R\\, \\Gamma_L(s)},\n$$\n并且对应的强度为\n$$\nS_L(s) = \\left|A_L(s)\\right|^2.\n$$\n\n实现一个程序，使用以下参数，为指定的 $s$ 测试值计算 $L=0, L=1$ 和 $L=2$ 时的 $S_L(s)$：\n- 共振质量 $m_R = 1.02$ GeV。\n- 在壳宽度 $\\Gamma_0 = 0.05$ GeV。\n- 末态质量 $m_f = 0.495$ GeV（相同粒子）。\n- 阈值 $s_{\\mathrm{thr}} = (2 m_f)^2$，单位为 $\\mathrm{GeV}^2$。\n- 所有能量单位必须是 GeV，所有不变质量平方单位必须是 $\\mathrm{GeV}^2$；强度 $S_L(s)$ 是无量纲的。\n\n使用以下不变质量平方值 $s$（单位为 $\\mathrm{GeV}^2$）的测试组，该测试组探测在阈值处及附近、阈值以下、略高于阈值以及共振峰周围的行为：\n- $s_0 = s_{\\mathrm{thr}} \\times 0.99$,\n- $s_1 = s_{\\mathrm{thr}}$,\n- $s_2 = s_{\\mathrm{thr}} \\times 1.01$,\n- $s_3 = m_R^2$,\n- $s_4 = s_{\\mathrm{thr}} \\times 1.05$,\n- $s_5 = s_{\\mathrm{thr}} \\times 1.10$.\n\n您的程序必须：\n- 按照上述定义，为测试组中的每个 $s$ 和每个 $L \\in \\{0,1,2\\}$ 计算 $S_L(s)$。\n- 使用规则：对于 $s \\le s_{\\mathrm{thr}}$，$\\Gamma_L(s)=0$ 且 $p(s)=0$。\n- 将最终输出生成为单行，内容为方括号括起来的逗号分隔列表，强度按 $[S_{L=0}(s_0), S_{L=1}(s_0), S_{L=2}(s_0), S_{L=0}(s_1), S_{L=1}(s_1), S_{L=2}(s_1), \\dots ]$ 的顺序排列。\n- 将每个浮点数四舍五入到六位小数。",
            "solution": "该问题提出了一个计算高能物理中有效且适定的场景。所有提供的参数、公式和条件在科学上都是合理的，没有矛盾，并且足以推导出唯一的数值解。所描述的模型——一个考虑了相空间和离心势垒效应的、具有能量依赖宽度的相对论性 Breit-Wigner 共振——是粒子物理唯象学中一个标准且基本的构造。\n\n目标是计算一个质量为 $m_R$、在壳宽度为 $\\Gamma_0$ 的粒子衰变为两个质量为 $m_f$ 的相同粒子时的共振强度 $S_L(s)$。强度是系统不变质量平方 $s$ 和衰变轨道角动量 $L$ 的函数。\n\n计算基于所提供的理论框架，通过一系列定义明確的步骤进行。\n\n首先，我们定义基本的运动学量。共振静止系中任一末态粒子的三维动量大小 $p(s)$ 由下式给出：\n$$\np(s) = \\frac{\\sqrt{\\lambda(s, m_f^2, m_f^2)}}{2\\sqrt{s}}\n$$\n其中 $\\lambda(a, b, c) = a^2 + b^2 + c^2 - 2ab - 2ac - 2bc$ 是 Källén 运动学函数。对于两个相同的末态粒子，该函数简化为 $\\lambda(s, m_f^2, m_f^2) = s(s - 4m_f^2)$。只有在阈值 $s_{\\mathrm{thr}} = (2m_f)^2 = 4m_f^2$ 以上，衰变在运动学上才是可能的。对于 $s \\le s_{\\mathrm{thr}}$，动量 $p(s)$ 为零。\n\n其次，我们对能量依赖的宽度 $\\Gamma_L(s)$进行建模。这个量反映了当共振在“离壳”状态（即 $\\sqrt{s} \\neq m_R$）产生时，衰变概率如何变化。该模型包含了两个关键的物理效应：衰变的可用的相空间，以及抑制非零角动量衰变的离心势垒（尤其是在阈值附近）。指定的宽度模型为：\n$$\n\\Gamma_L(s) = \n\\begin{cases}\n\\Gamma_0 \\left(\\dfrac{p(s)}{p(m_R^2)}\\right)^{2L+1} \\left(\\dfrac{m_R^2}{s}\\right),  s  s_{\\mathrm{thr}} \\\\\n0,  s \\le s_{\\mathrm{thr}}\n\\end{cases}\n$$\n此处，$\\Gamma_0$ 是在共振峰（$s=m_R^2$）处测量的名义宽度，$p(m_R^2)$ 是在壳动量，作为一个归一化常数。项 $(p(s))^{2L+1}$ 结合了相空间因子（$p(s)$）和离心势垒因子（$p(s)^{2L}$）。因子 $(m_R^2/s)$ 是参数化剩余离壳依赖性的一个常规选择。\n\n第三，我们使用相对论性 Breit-Wigner 公式来描述共振振幅 $A_L(s)$。这个公式对不稳定粒子的传播子行为进行建模：\n$$\nA_L(s) = \\frac{1}{m_R^2 - s - i m_R \\Gamma_L(s)}\n$$\n分母的实部 $m_R^2 - s$ 描述了一个稳定粒子的传播，而虚部 $-i m_R \\Gamma_L(s)$ 则解释了衰变，根据光学定理赋予了传播子一个有限的寿命。\n\n最后，可观测的共振信号强度 $S_L(s)$ 与振幅模的平方成正比：\n$$\nS_L(s) = |A_L(s)|^2 = \\left| \\frac{1}{m_R^2 - s - i m_R \\Gamma_L(s)} \\right|^2 = \\frac{1}{(m_R^2 - s)^2 + (m_R \\Gamma_L(s))^2}\n$$\n\n计算算法实现如下：\n1.  定义输入的物理常数：共振质量 $m_R = 1.02 \\, \\mathrm{GeV}$，在壳宽度 $\\Gamma_0 = 0.05 \\, \\mathrm{GeV}$，以及末态粒子质量 $m_f = 0.495 \\, \\mathrm{GeV}$。\n2.  预计算派生常数：$m_R^2$、$m_f^2$、阈值 $s_{\\mathrm{thr}} = 4m_f^2$ 以及在壳动量 $p_0 \\equiv p(m_R^2)$。\n3.  定义问题陈述中指定的不变质量平方 $s$ 的测试点集。\n4.  对于每个测试点 $s$ 和每个要求的角动量 $L \\in \\{0, 1, 2\\}$，执行以下计算：\n    a. 计算离壳动量 $p(s)$，并强制执行条件：当 $s \\le s_{\\mathrm{thr}}$ 时，$p(s) = 0$。\n    b. 使用其分段定义计算能量依赖的宽度 $\\Gamma_L(s)$。\n    c. 将这些值代入强度 $S_L(s)$ 的表达式以获得结果。\n5.  按指定顺序收集结果，并将其格式化为六位小数。\n\n对于 $s \\le s_{\\mathrm{thr}}$ 的特殊情况，我们有 $\\Gamma_L(s) = 0$。强度计算简化为：\n$$\nS_L(s) = \\frac{1}{(m_R^2 - s)^2} \\quad (\\text{for } s \\le s_{\\mathrm{thr}})\n$$\n这个结果与角动量 $L$ 无关。\n\n对于在壳情况 $s = m_R^2$，我们有 $p(m_R^2) = p_0$。宽度公式给出 $\\Gamma_L(m_R^2) = \\Gamma_0$。强度变为：\n$$\nS_L(m_R^2) = \\frac{1}{(m_R^2 - m_R^2)^2 + (m_R \\Gamma_0)^2} = \\frac{1}{(m_R \\Gamma_0)^2}\n$$\n这个结果也与 $L$ 无关，并对应于此模型中共振峰的最大高度。程序实现了这个逻辑以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes resonance intensities S_L(s) using a relativistic Breit-Wigner\n    model with an energy-dependent width.\n    \"\"\"\n    \n    # ------------------\n    # 1. Define Constants  Parameters\n    # ------------------\n    # All energies are in GeV, and invariant masses squared are in GeV^2.\n    mR = 1.02  # Resonance mass\n    Gamma0 = 0.05  # On-shell width\n    mf = 0.495  # Final-state particle mass\n\n    # Derived constants\n    mR_sq = mR**2\n    mf_sq = mf**2\n    s_thr = (2 * mf)**2\n\n    # ------------------\n    # 2. Define Helper Functions\n    # ------------------\n\n    def get_momentum(s, s_threshold, mf_squared):\n        \"\"\"\n        Calculates the three-momentum p(s) in the resonance rest frame.\n        p(s) = 0 for s = s_thr.\n        \"\"\"\n        if s = s_threshold:\n            return 0.0\n        \n        # Simplified Källén function: lambda(s, m^2, m^2) = s * (s - 4*m^2)\n        # s_thr = 4*m^2\n        kallen_lambda = s * (s - s_threshold)\n        \n        # Check for numerical precision issues near threshold\n        if kallen_lambda  0:\n            return 0.0\n            \n        return np.sqrt(kallen_lambda) / (2 * np.sqrt(s))\n\n    def get_energy_dependent_width(s, L, p_s_val, p_on_shell, s_threshold):\n        \"\"\"\n        Calculates the energy-dependent width Gamma_L(s).\n        \"\"\"\n        if s = s_threshold or p_on_shell == 0:\n            return 0.0\n        \n        ratio_p = p_s_val / p_on_shell\n        ratio_s = mR_sq / s\n        \n        return Gamma0 * (ratio_p**(2 * L + 1)) * ratio_s\n\n    def get_intensity(s, L, p_s_val, p_on_shell, s_threshold):\n        \"\"\"\n        Calculates the intensity S_L(s) = |A_L(s)|^2.\n        \"\"\"\n        gamma_l_s = get_energy_dependent_width(s, L, p_s_val, p_on_shell, s_threshold)\n        \n        real_part_denom = mR_sq - s\n        imag_part_denom = -mR * gamma_l_s\n        \n        denominator_sq = real_part_denom**2 + imag_part_denom**2\n        \n        # Avoid division by zero, although it's unlikely with this model\n        if denominator_sq == 0:\n            return float('inf')\n            \n        return 1.0 / denominator_sq\n\n    # ------------------\n    # 3. Pre-computation\n    # ------------------\n    \n    # Calculate on-shell momentum for normalization\n    p_on_shell = get_momentum(mR_sq, s_thr, mf_sq)\n\n    # ------------------\n    # 4. Generate Test Cases and Compute Results\n    # ------------------\n    \n    # Define the test suite for s in GeV^2\n    s_test_suite = [\n        s_thr * 0.99,  # s0\n        s_thr,         # s1\n        s_thr * 1.01,  # s2\n        mR_sq,         # s3\n        s_thr * 1.05,  # s4\n        s_thr * 1.10   # s5\n    ]\n    \n    L_values = [0, 1, 2]\n    \n    results = []\n    \n    for s_val in s_test_suite:\n        # Calculate momentum once for the current s value\n        p_current = get_momentum(s_val, s_thr, mf_sq)\n        for L_val in L_values:\n            intensity = get_intensity(s_val, L_val, p_current, p_on_shell, s_thr)\n            # Round to six decimal places as required\n            results.append(f\"{intensity:.6f}\")\n\n    # ------------------\n    # 5. Final Output\n    # ------------------\n    \n    # Format the final output as a single-line comma-separated list\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}