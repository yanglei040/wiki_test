{
    "hands_on_practices": [
        {
            "introduction": "窄宽度近似（NWA）是粒子物理学中一个简化计算的强大工具，它允许我们将共振过程的总截面分解为产生和衰变两部分。本练习旨在通过要求学生推导一个通常在NWA中被忽略的领头阶修正项，来深入探究NWA的数学基础。通过这个计算，你将精确地量化理想化积分与物理积分范围之间的差异，从而更清晰地理解该近似的适用范围与局限性 。",
            "id": "3531465",
            "problem": "考虑一个在高能散射过程中产生的标量不稳定共振，它由一个标量场的因果传播子来建模，其模的平方在共振峰附近由相对论Breit–Wigner线型给出，\n$$\n|D(s)|^{2} \\equiv \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, ,\n$$\n其中 $M$ 是极点质量，$\\Gamma$ 是总衰变宽度。在窄宽度近似 (NWA) 中，定义为极限 $\\Gamma/M \\to 0$，总截面或衰变率通常通过对不变质量平方 $s$ 进行积分来计算，积分中包含一个缓变因子 $f(s)$，该因子编码了剩余的动力学和相空间。在此近似下，人们将 $f(s)$ 替换为 $f(M^{2})$，并从Breit–Wigner的 $s$ 积分中提取一个普适的归一化因子。\n\n从因果传播子和标准实分析出发，执行以下步骤：\n1. 仅使用相对论Breit–Wigner的性质和NWA的定义，说明对共振因子的 $s$ 积分是如何由 $s = M^{2}$ 附近的区域所控制的。\n2. 计算共振因子在物理上允许的定义域 $s \\in [0,\\infty)$ 上的积分，\n$$\nI_{0}^{\\infty} \\equiv \\int_{0}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, ,\n$$\n并将其与在整个实轴上的理想化积分进行比较，\n$$\nI_{-\\infty}^{\\infty} \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n3. 在极限 $\\Gamma/M \\ll 1$下，推导领头分数修正\n$$\n\\delta \\equiv \\frac{I_{0}^{\\infty} - I_{-\\infty}^{\\infty}}{I_{-\\infty}^{\\infty}}\n$$\n该修正纯粹源于物理下界 $s \\geq 0$（即，源于忽略了非物理区域 $s  0$），并将其表示为关于 $\\Gamma/M$ 的领头阶的闭式解析表达式。\n\n将你的最终答案表示为关于 $M$ 和 $\\Gamma$ 的解析表达式 $\\delta$。无需进行数值计算，最终表达式中不应包含单位。",
            "solution": "我们首先回顾相对论Breit–Wigner在不稳定标量粒子的因果传播子中的来源。标量传播子作为不变质量平方 $s$ 的函数是\n$$\nD(s) \\sim \\frac{1}{s - M^{2} + i M \\Gamma} \\, ,\n$$\n因此，通过 $|D(s)|^{2}$ 进入截面的共振因子是\n$$\n|D(s)|^{2} = \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n在由 $\\Gamma/M \\to 0$ 定义的窄宽度近似 (NWA) 中，被积函数在 $s = M^{2}$ 处有一个尖峰，其宽度由 $M \\Gamma$ 控制。因此，当与一个缓变函数 $f(s)$ 进行积分时，人们在对积分起主导作用的狭窄区域内近似 $f(s) \\approx f(M^{2})$。这将计算简化为对Breit–Wigner的普适归一化积分。\n\n我们现在计算两个相关的积分。首先，考虑在整个实轴上的积分：\n$$\nI_{-\\infty}^{\\infty} \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n进行变量替换\n$$\nu \\equiv \\frac{s - M^{2}}{M \\Gamma} \\quad \\Rightarrow \\quad s = M^{2} + M \\Gamma \\, u \\,, \\quad \\mathrm{d}s = M \\Gamma \\, \\mathrm{d}u \\, .\n$$\n分母变为\n$$\n(s - M^{2})^{2} + M^{2}\\Gamma^{2} = (M \\Gamma)^{2}(u^{2} + 1) \\, ,\n$$\n所以积分为\n$$\nI_{-\\infty}^{\\infty} = \\int_{-\\infty}^{\\infty} \\frac{M \\Gamma \\, \\mathrm{d}u}{(M \\Gamma)^{2}(u^{2} + 1)} = \\frac{1}{M \\Gamma} \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}u}{u^{2} + 1} = \\frac{1}{M \\Gamma} \\left[ \\arctan(u) \\right]_{-\\infty}^{\\infty} = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} - \\left( - \\frac{\\pi}{2} \\right) \\right) = \\frac{\\pi}{M \\Gamma} \\, .\n$$\n\n接下来，考虑物理上允许的定义域 $s \\in [0,\\infty)$：\n$$\nI_{0}^{\\infty} \\equiv \\int_{0}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n使用相同的变量替换，积分下限 $s = 0$ 映射为\n$$\nu_{0} = \\frac{0 - M^{2}}{M \\Gamma} = - \\frac{M}{\\Gamma} \\, ,\n$$\n而积分上限 $s \\to \\infty$ 映射为 $u \\to \\infty$。因此，\n$$\nI_{0}^{\\infty} = \\frac{1}{M \\Gamma} \\int_{u_{0}}^{\\infty} \\frac{\\mathrm{d}u}{u^{2} + 1} = \\frac{1}{M \\Gamma} \\left[ \\arctan(u) \\right]_{u_{0}}^{\\infty} = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} - \\arctan\\!\\left( - \\frac{M}{\\Gamma} \\right) \\right) = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) \\right) \\, .\n$$\n\n我们现在计算分数修正\n$$\n\\delta \\equiv \\frac{I_{0}^{\\infty} - I_{-\\infty}^{\\infty}}{I_{-\\infty}^{\\infty}} = \\frac{ \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) \\right) - \\frac{\\pi}{M \\Gamma} }{ \\frac{\\pi}{M \\Gamma} } = \\frac{ \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) - \\pi }{ \\pi } \\, .\n$$\n因此，\n$$\n\\delta = \\frac{ \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) - \\frac{\\pi}{2} }{ \\pi } = - \\frac{ \\frac{\\pi}{2} - \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) }{ \\pi } \\, .\n$$\n\n为了在 $\\Gamma/M \\ll 1$ 时提取领头行为，我们使用反正切函数在大自变量 $x$ 时的标准渐近展开式，\n$$\n\\arctan(x) = \\frac{\\pi}{2} - \\frac{1}{x} + \\frac{1}{3 x^{3}} - \\frac{1}{5 x^{5}} + \\cdots \\quad \\text{for} \\quad x \\to \\infty \\, .\n$$\n令 $x = M/\\Gamma$，我们得到\n$$\n\\frac{\\pi}{2} - \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) = \\frac{\\Gamma}{M} - \\frac{1}{3} \\left( \\frac{\\Gamma}{M} \\right)^{3} + \\mathcal{O}\\!\\left( \\left( \\frac{\\Gamma}{M} \\right)^{5} \\right) \\, .\n$$\n将此代入 $\\delta$ 得到领头分数修正，\n$$\n\\delta = - \\frac{1}{\\pi} \\left( \\frac{\\Gamma}{M} - \\frac{1}{3} \\left( \\frac{\\Gamma}{M} \\right)^{3} + \\cdots \\right) \\, .\n$$\n在 $\\Gamma/M$ 的领头阶上，结果是\n$$\n\\delta \\simeq - \\frac{\\Gamma}{\\pi M} \\, .\n$$\n\n这个负修正反映了这样一个事实：仅在 $s \\geq 0$ 上积分忽略了理想化的实轴积分中来自 $s  0$ 的（非物理但数学上存在的）贡献，从而相对于整个实轴上的结果减少了归一化值。在NWA极限下，该效应被 $\\Gamma/M$ 线性抑制，并在 $\\Gamma/M \\to 0$ 时消失，这与近共振区域的主导地位是一致的。",
            "answer": "$$\\boxed{-\\frac{\\Gamma}{\\pi M}}$$"
        },
        {
            "introduction": "实验观测中的共振峰形往往并非完美的对称洛伦兹曲线，而是呈现出各种不对称的形状。本练习将引导你探索这种不对称性的量子力学根源：共振过程与一个平滑的非共振背景过程之间的相干干涉。通过构建一个包含这两种效应的玩具模型，你将亲手推导出导致线形不对称（即类Fano线形）的关键干涉项，并确定其存在的必要条件 。",
            "id": "3531483",
            "problem": "考虑一个高能物理中孤立$s$道共振附近的弹性、自旋平均的单通道散射过程。在一个能够捕捉离壳效应以及共振极点与平滑非共振连续背景之间干涉的玩具模型中，标量振幅被建模为\n$$\nA(s) \\;=\\; \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma} \\;+\\; b\\,\\exp(i\\,\\phi),\n$$\n其中$c$、$b$和$\\phi$是实常数，$M$是共振质量，$\\Gamma$是其常数总宽度，$s$是通常的Mandelstam不变量。可测量的速率通过振幅的相干叠加与$|A(s)|^{2}$成正比。假设$M0$，$\\Gamma0$，$b\\ge 0$，且$\\phi$是以弧度表示的角度。\n\n从振幅的相干叠加和复模数的定义出发，推导$|A(s)|^{2}$中明确的干涉贡献项，即同时对$c$和$b$呈线性的项。然后，通过引入无量纲的离壳变量 $\\varepsilon \\equiv (s - M^{2})/(M\\,\\Gamma)$，分析干涉项在$\\varepsilon \\mapsto -\\varepsilon$变换下的宇称性，并推导线形关于$s = M^{2}$不对称（即类似Fano的偏斜，而非纯粹的对称畸变）时$b$、$c$和$\\phi$所需满足的充要条件。将干涉项的最终结果表示为以$s$、$M$、$\\Gamma$、$c$、$b$和$\\phi$为变量的闭合形式解析表达式。",
            "solution": "总散射振幅$A(s)$是共振振幅$A_{res}(s)$和非共振背景振幅$A_{bg}(s)$的相干叠加。\n$$\nA(s) = A_{res}(s) + A_{bg}(s)\n$$\n其中\n$$\nA_{res}(s) = \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma}\n$$\n以及\n$$\nA_{bg}(s) = b\\,\\exp(i\\,\\phi)\n$$\n可测量的速率与总振幅的模的平方$|A(s)|^{2}$成正比。我们展开这个量：\n$$\n|A(s)|^{2} = \\left( A_{res}(s) + A_{bg}(s) \\right) \\left( A_{res}(s) + A_{bg}(s) \\right)^{*} = \\left( A_{res}(s) + A_{bg}(s) \\right) \\left( A_{res}^{*}(s) + A_{bg}^{*}(s) \\right)\n$$\n$$\n|A(s)|^{2} = |A_{res}(s)|^{2} + |A_{bg}(s)|^{2} + A_{res}(s)A_{bg}^{*}(s) + A_{res}^{*}(s)A_{bg}(s)\n$$\n前两项代表来自共振和背景各自速率的非相干叠加。后两项代表这两个过程之间的量子力学干涉。题目要求的是干涉贡献项，我们记为$I(s)$：\n$$\nI(s) = A_{res}(s)A_{bg}^{*}(s) + A_{res}^{*}(s)A_{bg}(s)\n$$\n利用对任意复数$z$，$z + z^{*} = 2\\,\\text{Re}(z)$的性质，干涉项可以写成：\n$$\nI(s) = 2\\,\\text{Re}\\left( A_{res}(s)A_{bg}^{*}(s) \\right)\n$$\n为了计算这个值，我们首先求乘积$A_{res}(s)A_{bg}^{*}(s)$。背景振幅的复共轭是$A_{bg}^{*}(s) = b\\,\\exp(-i\\,\\phi)$。\n$$\nA_{res}(s)A_{bg}^{*}(s) = \\left( \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma} \\right) \\left( b\\,\\exp(-i\\,\\phi) \\right)\n$$\n为了简化实部的提取，我们将共振项的分子和分母同乘以其复共轭$M^{2} - s + i\\,M\\,\\Gamma$：\n$$\nA_{res}(s) = \\frac{c(M^{2} - s + i\\,M\\,\\Gamma)}{(M^{2} - s - i\\,M\\,\\Gamma)(M^{2} - s + i\\,M\\,\\Gamma)} = \\frac{c(M^{2} - s + i\\,M\\,\\Gamma)}{(M^{2}-s)^{2} + (M\\,\\Gamma)^{2}}\n$$\n现在，乘积变为：\n$$\nA_{res}(s)A_{bg}^{*}(s) = \\frac{cb}{(M^{2}-s)^{2} + (M\\,\\Gamma)^{2}} \\left( M^{2} - s + i\\,M\\,\\Gamma \\right) \\left( \\cos\\phi - i\\,\\sin\\phi \\right)\n$$\n我们展开分子中复数项的乘积：\n$$\n(M^{2} - s + i\\,M\\,\\Gamma)(\\cos\\phi - i\\,\\sin\\phi) = (M^{2}-s)\\cos\\phi - i(M^{2}-s)\\sin\\phi + iM\\Gamma\\cos\\phi - i^{2}M\\Gamma\\sin\\phi\n$$\n$$\n= \\left[ (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right] + i\\left[ M\\Gamma\\cos\\phi - (M^{2}-s)\\sin\\phi \\right]\n$$\n因此，$A_{res}(s)A_{bg}^{*}(s)$的实部是：\n$$\n\\text{Re}\\left( A_{res}(s)A_{bg}^{*}(s) \\right) = \\frac{cb \\left( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}\n$$\n总的干涉项，即同时对$c$和$b$呈线性的项，是这个量的$2$倍：\n$$\nI(s) = \\frac{2cb \\left( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}\n$$\n这就是干涉项的闭合形式表达式。\n\n接下来，我们分析该项的宇称性。我们引入无量纲变量$\\varepsilon = \\frac{s - M^{2}}{M\\,\\Gamma}$，这意味着$s - M^{2} = \\varepsilon M \\Gamma$以及$M^{2} - s = -\\varepsilon M \\Gamma$。我们将其代入$I(s)$的表达式中得到$I(\\varepsilon)$：\n- 分母：$(M^{2}-s)^{2} + (M\\,\\Gamma)^{2} = (-\\varepsilon M \\Gamma)^{2} + (M\\,\\Gamma)^{2} = (M\\Gamma)^{2}(\\varepsilon^{2} + 1)$。\n- 分子：$2cb \\left( (-\\varepsilon M \\Gamma)\\cos\\phi + M\\Gamma\\sin\\phi \\right) = 2cb M\\Gamma \\left( \\sin\\phi - \\varepsilon\\cos\\phi \\right)$。\n所以，作为$\\varepsilon$函数的干涉项是：\n$$\nI(\\varepsilon) = \\frac{2cb M\\Gamma (\\sin\\phi - \\varepsilon\\cos\\phi)}{(M\\Gamma)^{2}(\\varepsilon^{2} + 1)} = \\frac{2cb}{M\\Gamma} \\frac{\\sin\\phi - \\varepsilon\\cos\\phi}{1+\\varepsilon^{2}}\n$$\n我们可以将其分解为一个偶部（关于$\\varepsilon=0$对称）和一个奇部（关于$\\varepsilon=0$反对称）：\n$$\nI(\\varepsilon) = \\underbrace{\\frac{2cb\\sin\\phi}{M\\Gamma(1+\\varepsilon^{2})}}_{\\text{偶部}} + \\underbrace{\\left(-\\frac{2cb\\cos\\phi}{M\\Gamma}\\frac{\\varepsilon}{1+\\varepsilon^{2}}\\right)}_{\\text{奇部}}\n$$\n总速率为$|A(\\varepsilon)|^{2}$，由于非干涉项是纯粹的$\\varepsilon$的偶函数，因此线形关于共振峰（$s=M^{2}$，即$\\varepsilon=0$）的任何不对称性都必须来自干涉项$I(\\varepsilon)$的奇部。\n\n线形不对称的充要条件是$I(\\varepsilon)$的奇部不为零。奇部是$-\\frac{2cb\\cos\\phi}{M\\Gamma}\\frac{\\varepsilon}{1+\\varepsilon^{2}}$。要使该项对任何$\\varepsilon \\neq 0$都不为零，其系数必须不为零：\n$$\nc \\neq 0 \\quad \\text{and} \\quad b \\neq 0 \\quad \\text{and} \\quad \\cos\\phi \\neq 0\n$$\n考虑到题目规定$b \\ge 0$，条件$b \\neq 0$变为$b > 0$。条件$\\cos\\phi \\neq 0$意味着相位$\\phi$不能是$\\pi/2$的奇数倍，即对任意整数$n$，$\\phi \\neq \\frac{(2n+1)\\pi}{2}$。这些是线形不对称（类似Fano）的充要条件。",
            "answer": "$$\n\\boxed{\\frac{2cb \\bigl( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\bigr)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}}\n$$"
        },
        {
            "introduction": "在实际应用中，使用恒定宽度的简单相对论性Breit-Wigner模型通常是一种过度简化。为了获得精确的理论预言，尤其是在接近产生阈值的能区，必须采用依赖于能量的宽度。本计算练习将指导你实现一个基于相空间和离心势垒效应的物理模型，这两种效应在决定衰变宽度随能量的变化中起着至关重要的作用。通过编程实践，你将直观地看到不同轨道角动量（$L=0, 1, 2$）对共振线形，特别是在阈值附近的显著影响 。",
            "id": "3531427",
            "problem": "您的任务是基于基本的两体相空间和角动量势垒考量，使用能量依赖宽度来模拟共振线型。目标是为一个相对论性共振实现一个计算模型。该共振的不变质量平方为$s$，衰变为两个质量为$m_f$、轨道角动量为$L$的相同末态粒子。能量依赖宽度必须遵循$p^{2L+1}(s)/s$的标度关系，其中$p(s)$是共振静止系中任一子粒子的三动量大小。\n\n从计算高能物理相关的第一性原理出发，使用以下基本事实：\n\n- 共振的相对论色散关系意味着其传播子的虚部由衰变过程通过光学定理确定，从而导致一个依赖于相空间和相互作用动力学的宽度。\n- 对于一个不变质量为$\\sqrt{s}$的母粒子衰变为两个质量为$m_f$的相同粒子，洛伦兹不变的两体相空间密度按$p(s)/\\sqrt{s}$进行标度。\n- 在阈值附近，离心势垒会抑制轨道角动量为$L$的分波，产生一个与$p^L(s)$成正比的振幅标度因子；因此，衰变率获得一个与$p^{2L}(s)$成正比的因子。\n\n基于这些，建立能量依赖宽度模型：\n1. 共振静止系中三动量的大小由下式给出\n$$\np(s) = \\frac{\\sqrt{\\lambda\\!\\left(s,m_f^2,m_f^2\\right)}}{2\\sqrt{s}},\n$$\n其中Källén函数为 $\\lambda(a,b,c) = a^2 + b^2 + c^2 - 2ab - 2ac - 2bc$。\n2. 两体阈值为 $s_{\\mathrm{thr}} = (2 m_f)^2$。对于 $s \\le s_{\\mathrm{thr}}$，宽度必须为零。\n3. 归一化到在壳宽度的能量依赖宽度满足\n$$\n\\Gamma_L(s) = \n\\begin{cases}\n\\Gamma_0 \\left(\\dfrac{p(s)}{p(m_R^2)}\\right)^{2L+1} \\left(\\dfrac{m_R^2}{s}\\right),  s  s_{\\mathrm{thr}},\\\\\n0,  s \\le s_{\\mathrm{thr}},\n\\end{cases}\n$$\n其中$m_R$是共振质量，$\\Gamma_0$是$s=m_R^2$时的宽度，$p(m_R^2)$是在壳动量。\n4. 共振振幅（线型）由相对论布莱特-维格纳传播子建模\n$$\nA_L(s) = \\frac{1}{m_R^2 - s - i\\, m_R\\, \\Gamma_L(s)},\n$$\n相应的强度为\n$$\nS_L(s) = \\left|A_L(s)\\right|^2.\n$$\n\n实现一个程序，使用以下参数，为指定的$s$测试值计算$L=0$、$L=1$和$L=2$时的$S_L(s)$：\n- 共振质量 $m_R = 1.02$ GeV。\n- 在壳宽度 $\\Gamma_0 = 0.05$ GeV。\n- 末态质量 $m_f = 0.495$ GeV（相同粒子）。\n- 阈值 $s_{\\mathrm{thr}} = (2 m_f)^2$ in $\\mathrm{GeV}^2$。\n- 所有能量单位必须是GeV，所有不变质量平方单位必须是$\\mathrm{GeV}^2$；强度$S_L(s)$是无量纲的。\n\n使用以下不变质量平方值$s$（单位为$\\mathrm{GeV}^2$）的测试套件，该套件探测了阈值处及附近、阈值以下、略高于阈值以及共振周围的行为：\n- $s_0 = s_{\\mathrm{thr}} \\times 0.99$,\n- $s_1 = s_{\\mathrm{thr}}$,\n- $s_2 = s_{\\mathrm{thr}} \\times 1.01$,\n- $s_3 = m_R^2$,\n- $s_4 = s_{\\mathrm{thr}} \\times 1.05$,\n- $s_5 = s_{\\mathrm{thr}} \\times 1.10$。\n\n您的程序必须：\n- 遵循上述定义，为测试套件中的每个$s$和每个$L \\in \\{0,1,2\\}$计算$S_L(s)$。\n- 使用规则：当$s \\le s_{\\mathrm{thr}}$时，$\\Gamma_L(s)=0$且$p(s)=0$。\n- 将最终输出生成为单行，内容是一个用方括号括起来的逗号分隔列表，强度按$[S_{L=0}(s_0), S_{L=1}(s_0), S_{L=2}(s_0), S_{L=0}(s_1), S_{L=1}(s_1), S_{L=2}(s_1), \\dots ]$的顺序排列。\n- 将每个浮点数四舍五入到六位小数。",
            "solution": "为了计算共振强度 $S_L(s)$，我们遵循以下步骤：\n1.  **定义物理常数与运动学**: 根据问题陈述，我们使用给定的共振质量 $m_R = 1.02 \\, \\mathrm{GeV}$、在壳宽度 $\\Gamma_0 = 0.05 \\, \\mathrm{GeV}$ 和末态粒子质量 $m_f = 0.495 \\, \\mathrm{GeV}$。首先，我们计算出阈值 $s_{\\mathrm{thr}} = (2m_f)^2$。\n2.  **计算三动量**: 对于给定的不变质量平方 $s$，我们计算共振静止系中末态粒子的三动量大小 $p(s)$。该值由Källén函数 $\\lambda(s, m_f^2, m_f^2) = s(s - 4m_f^2)$ 确定：\n    $$ p(s) = \\frac{\\sqrt{s(s - s_{\\mathrm{thr}})}}{2\\sqrt{s}} $$\n    根据物理条件，当 $s \\le s_{\\mathrm{thr}}$ 时，$p(s) = 0$。我们还需预先计算在壳动量 $p(m_R^2)$，它将用于归一化。\n3.  **计算能量依赖宽度**: 利用动量值，我们根据给定的公式计算能量依赖宽度 $\\Gamma_L(s)$：\n    $$ \\Gamma_L(s) = \\Gamma_0 \\left(\\frac{p(s)}{p(m_R^2)}\\right)^{2L+1} \\left(\\frac{m_R^2}{s}\\right) \\quad (\\text{对于 } s > s_{\\mathrm{thr}}) $$\n    当 $s \\le s_{\\mathrm{thr}}$ 时，$\\Gamma_L(s) = 0$。\n4.  **计算强度**: 最后，我们将 $s$ 和计算出的 $\\Gamma_L(s)$ 代入相对论布莱特-维格纳强度公式：\n    $$ S_L(s) = |A_L(s)|^2 = \\frac{1}{(m_R^2 - s)^2 + (m_R \\Gamma_L(s))^2} $$\n对于 $s \\le s_{\\mathrm{thr}}$，该公式简化为 $S_L(s) = 1/(m_R^2 - s)^2$。对于在壳情况 $s = m_R^2$，强度达到峰值 $S_L(m_R^2) = 1/(m_R \\Gamma_0)^2$。\n程序将对测试套件中的每个 $s$ 值和每个角动量 $L \\in \\{0, 1, 2\\}$ 重复此过程，并按要求格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes resonance intensities S_L(s) using a relativistic Breit-Wigner\n    model with an energy-dependent width.\n    \"\"\"\n    \n    # ------------------\n    # 1. Define Constants  Parameters\n    # ------------------\n    # All energies are in GeV, and invariant masses squared are in GeV^2.\n    mR = 1.02  # Resonance mass\n    Gamma0 = 0.05  # On-shell width\n    mf = 0.495  # Final-state particle mass\n\n    # Derived constants\n    mR_sq = mR**2\n    mf_sq = mf**2\n    s_thr = (2 * mf)**2\n\n    # ------------------\n    # 2. Define Helper Functions\n    # ------------------\n\n    def get_momentum(s, s_threshold, mf_squared):\n        \"\"\"\n        Calculates the three-momentum p(s) in the resonance rest frame.\n        \"\"\"\n        if s = s_threshold:\n            return 0.0\n        \n        # Simplified Källén function: lambda(s, m^2, m^2) = s * (s - 4*m^2)\n        kallen_lambda = s * (s - s_threshold)\n        \n        # Check for numerical precision issues near threshold\n        if kallen_lambda  0:\n            return 0.0\n            \n        return np.sqrt(kallen_lambda) / (2 * np.sqrt(s))\n\n    def get_energy_dependent_width(s, L, p_s_val, p_on_shell, s_threshold):\n        \"\"\"\n        Calculates the energy-dependent width Gamma_L(s).\n        \"\"\"\n        if s = s_threshold or p_on_shell == 0:\n            return 0.0\n        \n        ratio_p = p_s_val / p_on_shell\n        ratio_s = mR_sq / s\n        \n        return Gamma0 * (ratio_p**(2 * L + 1)) * ratio_s\n\n    def get_intensity(s, L, p_s_val, p_on_shell, s_threshold):\n        \"\"\"\n        Calculates the intensity S_L(s) = |A_L(s)|^2.\n        \"\"\"\n        gamma_l_s = get_energy_dependent_width(s, L, p_s_val, p_on_shell, s_threshold)\n        \n        real_part_denom = mR_sq - s\n        imag_part_denom = -mR * gamma_l_s\n        \n        denominator_sq = real_part_denom**2 + imag_part_denom**2\n        \n        # Avoid division by zero, although it's unlikely with this model\n        if denominator_sq == 0:\n            return float('inf')\n            \n        return 1.0 / denominator_sq\n\n    # ------------------\n    # 3. Pre-computation\n    # ------------------\n    \n    # Calculate on-shell momentum for normalization\n    p_on_shell = get_momentum(mR_sq, s_thr, mf_sq)\n\n    # ------------------\n    # 4. Generate Test Cases and Compute Results\n    # ------------------\n    \n    # Define the test suite for s in GeV^2\n    s_test_suite = [\n        s_thr * 0.99,  # s0\n        s_thr,         # s1\n        s_thr * 1.01,  # s2\n        mR_sq,         # s3\n        s_thr * 1.05,  # s4\n        s_thr * 1.10   # s5\n    ]\n    \n    L_values = [0, 1, 2]\n    \n    results = []\n    \n    for s_val in s_test_suite:\n        # Calculate momentum once for the current s value\n        p_current = get_momentum(s_val, s_thr, mf_sq)\n        for L_val in L_values:\n            intensity = get_intensity(s_val, L_val, p_current, p_on_shell, s_thr)\n            # Round to six decimal places as required\n            results.append(f\"{intensity:.6f}\")\n\n    # ------------------\n    # 5. Final Output\n    # ------------------\n    \n    # Format the final output as a single-line comma-separated list\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}