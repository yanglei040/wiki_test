{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，计算的准确性和稳定性在很大程度上取决于网格质量。一个关键的衡量标准来自于从理想化的参考单元到物理空间中实际单元的几何映射。这个练习将指导您动手计算这一映射的雅可比矩阵及其相关属性，它们是量化单元扭曲、拉伸和方向的核心指标。",
            "id": "3514474",
            "problem": "在一个多物理场耦合模拟中，一个二维等参线性三角形有限元的物理节点坐标为 $\\mathbf{x}_{1}=(0,0)$、$\\mathbf{x}_{2}=(2,0)$ 和 $\\mathbf{x}_{3}=(0.1,1)$。考虑一个标准参考三角形 $\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$，其顶点为 $\\hat{\\mathbf{X}}_{1}=(0,0)$、$\\hat{\\mathbf{X}}_{2}=(1,0)$ 和 $\\hat{\\mathbf{X}}_{3}=(0,1)$。等参映射为 $\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$，其中线性形函数为 $N_{1}(\\xi,\\eta)=1-\\xi-\\eta$、$N_{2}(\\xi,\\eta)=\\xi$ 和 $N_{3}(\\xi,\\eta)=\\eta$。雅可比矩阵为 $J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$，其行列式 $\\det J$ 表征局部面积变形和方向，而 2-范数条件数 $\\kappa_{2}(J)$ 表征度量各向异性和扭曲度。在自适应网格加密（AMR）的背景下，$\\det J\\le 0$ 或 $|\\det J|$ 非常小的单元被认为是接近翻转的，而大的 $\\kappa_{2}(J)$ 表示高度各向异性或扭曲的单元。\n\n仅使用这些基本定义，计算单元中心 $(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$ 处的 $\\det J$，估计 $\\kappa_{2}(J)$，并确定该单元是接近翻转还是仅仅是扭曲。请基于映射以及通过 $J$ 的奇异值对 $\\kappa_{2}(J)$ 的谱定义提供清晰的推理。对于最终报告值，仅提供四位有效数字的 $\\kappa_{2}(J)$，以无量纲小数表示。",
            "solution": "首先验证问题，以确保其自洽、科学上合理且适定。\n\n**步骤 1：提取已知条件**\n- **单元类型**：二维等参线性三角形有限元。\n- **物理节点坐标**：$\\mathbf{x}_{1}=(0,0)$、$\\mathbf{x}_{2}=(2,0)$ 和 $\\mathbf{x}_{3}=(0.1,1)$。\n- **标准参考三角形**：$\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$。\n- **参考顶点**：$\\hat{\\mathbf{X}}_{1}=(0,0)$、$\\hat{\\mathbf{X}}_{2}=(1,0)$ 和 $\\hat{\\mathbf{X}}_{3}=(0,1)$。\n- **等参映射**：$\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$。\n- **线性形函数**：$N_{1}(\\xi,\\eta)=1-\\xi-\\eta$、$N_{2}(\\xi,\\eta)=\\xi$ 和 $N_{3}(\\xi,\\eta)=\\eta$。\n- **雅可比矩阵定义**：$J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$。\n- **质量度量定义**：$\\det J \\le 0$ 或 $|\\det J|$ 非常小表示接近翻转；大的 $\\kappa_{2}(J)$ 表示高度各向异性或扭曲。\n- **求值点**：单元中心，$(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$。\n- **最终答案格式**：$\\kappa_{2}(J)$ 四舍五入到四位有效数字。\n\n**步骤 2：使用已知条件进行验证**\n该问题在科学上是合理的，因为它涉及有限元方法（FEM）的标准理论，特别是等参映射和单元质量评估。该问题是适定的，为获得唯一解提供了所有必要的定义和数据。语言客观而精确。该问题没有任何科学或事实上的不健全、不完整、矛盾或验证标准中列出的其他缺陷。\n\n**步骤 3：结论与操作**\n该问题有效。将提供完整的解答。\n\n**求解推导**\n\n物理单元内任意点的位置向量 $\\mathbf{x}$ 由等参映射给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} x(\\xi, \\eta) \\\\ y(\\xi, \\eta) \\end{pmatrix} = N_{1}(\\xi, \\eta)\\mathbf{x}_{1} + N_{2}(\\xi, \\eta)\\mathbf{x}_{2} + N_{3}(\\xi, \\eta)\\mathbf{x}_{3}\n$$\n代入给定的形函数和节点坐标：\n$$\n\\mathbf{x}(\\xi, \\eta) = (1-\\xi-\\eta)\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\xi\\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\eta\\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}\n$$\n这可以简化为坐标分量：\n$$\nx(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(2) + \\eta(0.1) = 2\\xi + 0.1\\eta\n$$\n$$\ny(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(0) + \\eta(1) = \\eta\n$$\n因此，映射为 $\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} 2\\xi + 0.1\\eta \\\\ \\eta \\end{pmatrix}$。\n\n变换的雅可比矩阵 $J$ 定义为：\n$$\nJ = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = 2, \\quad \\frac{\\partial x}{\\partial \\eta} = 0.1\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = 1\n$$\n因此，雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} 2  0.1 \\\\ 0  1 \\end{pmatrix}\n$$\n对于线性等参单元，从参考坐标到物理坐标的映射是仿射的。因此，雅可比矩阵在整个单元中是常数。其值与求值点 $(\\xi, \\eta)$ 无关，因此在单元中心的值与在其他任何地方的值都相同。\n\n首先，我们计算雅可比行列式 $\\det J$，以评估单元是否翻转。\n$$\n\\det J = (2)(1) - (0.1)(0) = 2\n$$\n由于 $\\det J = 2  0$ 且不接近于零，该单元没有翻转或接近翻转。该映射是保持方向的，具有一个恒定的局部面积膨胀因子 2。\n\n接下来，我们计算 2-范数条件数 $\\kappa_{2}(J)$，以评估扭曲度和各向异性。$\\kappa_{2}(J)$ 定义为 $J$ 的最大奇异值 ($\\sigma_{\\max}$) 与最小奇异值 ($\\sigma_{\\min}$)之比：\n$$\n\\kappa_{2}(J) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}\n$$\n$J$ 的奇异值是矩阵 $J^T J$ 特征值的平方根。让我们计算 $J^T J$：\n$$\nJ^T = \\begin{pmatrix} 2  0 \\\\ 0.1  1 \\end{pmatrix}\n$$\n$$\nJ^T J = \\begin{pmatrix} 2  0 \\\\ 0.1  1 \\end{pmatrix} \\begin{pmatrix} 2  0.1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (2)(2) + (0)(0)  (2)(0.1) + (0)(1) \\\\ (0.1)(2) + (1)(0)  (0.1)(0.1) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 4  0.2 \\\\ 0.2  1.01 \\end{pmatrix}\n$$\n$J^T J$ 的特征值 $\\lambda$ 可通过特征方程 $\\det(J^T J - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{pmatrix} 4-\\lambda  0.2 \\\\ 0.2  1.01-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(4-\\lambda)(1.01-\\lambda) - (0.2)^2 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4.04 - 0.04 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda = \\frac{5.01 \\pm \\sqrt{(-5.01)^2 - 4(1)(4)}}{2} = \\frac{5.01 \\pm \\sqrt{25.1001 - 16}}{2} = \\frac{5.01 \\pm \\sqrt{9.1001}}{2}\n$$\n两个特征值为 $\\lambda_{\\max} = \\frac{5.01 + \\sqrt{9.1001}}{2}$ 和 $\\lambda_{\\min} = \\frac{5.01 - \\sqrt{9.1001}}{2}$。\n条件数可以计算为 $\\kappa_{2}(J) = \\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$：\n$$\n\\kappa_{2}(J) = \\sqrt{\\frac{5.01 + \\sqrt{9.1001}}{5.01 - \\sqrt{9.1001}}}\n$$\n我们现在计算数值：\n$$\n\\sqrt{9.1001} \\approx 3.0166399\n$$\n$$\n\\kappa_{2}(J) \\approx \\sqrt{\\frac{5.01 + 3.0166399}{5.01 - 3.0166399}} = \\sqrt{\\frac{8.0266399}{1.9933601}} \\approx \\sqrt{4.026870} \\approx 2.0067064\n$$\n四舍五入到四位有效数字，我们得到 $\\kappa_{2}(J) \\approx 2.007$。\n条件数 $\\kappa_{2}(J)=1$ 表示完全各向同性的映射（例如，映射到等边三角形）。由于 $\\kappa_{2}(J) \\approx 2.007  1$，该单元表现出各向异性。这个值不是非常高，因此它代表一个中等程度扭曲或偏斜的单元。\n\n总而言之，当 $\\det J = 2$ 且 $\\kappa_{2}(J) \\approx 2.007$ 时，该单元被确定为仅仅是扭曲，而非接近翻转。最终要求的答案是 $\\kappa_{2}(J)$ 的数值。",
            "answer": "$$\\boxed{2.007}$$"
        },
        {
            "introduction": "虽然良好的几何质量很重要，但自适应网格优化的最终目标是精确地求解物理问题。为此，我们需要一种方法来识别求解误差最大的区域，“事后误差估计”正提供了这样的工具。这个练习将带您计算一个典型的基于残差的误差指示子，它是驱动自适应网格加密（AMR）决策过程的核心引擎。",
            "id": "3514528",
            "problem": "考虑一个稳态标量扩散模型，该模型代表了多物理场耦合模拟中的一个单场子问题，由有界多边形域上的强形式 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 控制，并在二维网格上采用协调有限元方法（FEM）近似 $u_h \\in V_h$。在用于自适应网格细化的基于残差的后验误差估计中，单元指标由单元内部残差及其边上的通量跳跃残差构成。设单元 $K$ 是形状规则的，其直径为 $h_K$，边长为 $\\{h_e\\}_{e \\subset \\partial K}$，并设单元内部残差大小为 $r_K$，边上的通量跳跃大小为 $\\{j_e\\}_{e \\subset \\partial K}$。网格质量度量 $h_K$ 和边长 $\\{h_e\\}$ 通过形状规则网格上的标准逆不等式和迹不等式进入指标的缩放。\n\n假设单个三角形单元 $K$ 具有以下数据：直径为 $h_K = 0.1$，单元内部残差大小为 $r_K = 5$，其三条边上的通量跳跃大小分别为 $(3, 1, 2)$，对应边长分别为 $(0.1, 0.1, 0.141)$。使用由弱形式和分部积分残差表示所蕴含的典型基于残差的缩放，计算单元 $K$ 的单元指标 $\\eta_K$。将最终答案表示为单个简化的精确表达式。无需四舍五入。",
            "solution": "该问题陈述被评估为有效。它在有限元方法（FEM）的后验误差估计的既定理论中具有科学依据，其给定条件完整且一致，问题是适定的，并以客观、正式的语言表达。没有违反基本原则、矛盾或歧义之处。因此，我们可以进行求解。\n\n该问题要求计算二维域中单个三角形单元 $K$ 的局部、基于残差的后验误差指标，记为 $\\eta_K$。其基础物理由一个稳态标量扩散方程描述，$-\\nabla \\cdot (\\kappa \\nabla u) = f$，其中 $u$ 是标量场，$\\kappa$ 是扩散系数，$f$ 是源项。通过有限元方法得到的近似解记为 $u_h$。\n\n误差指标 $\\eta_K$ 的“典型基于残差的缩放”是从残差方程的弱形式以及在形状规则网格上应用标准迹不等式和逆不等式推导出来的。指标的平方 $\\eta_K^2$ 由两部分主要贡献组成：一部分来自单元内部的残差，另一部分来自跨单元边的通量跳跃。其一般形式为：\n$$\n\\eta_K^2 = C_{int}^2 h_K^2 \\|R_K\\|_{L_2(K)}^2 + \\sum_{e \\in \\partial K} C_{edge}^2 h_e \\|J_e\\|_{L_2(e)}^2\n$$\n此处，$h_K$ 是单元 $K$ 的直径，$\\{h_e\\}$ 是其边的长度。项 $R_K = f + \\nabla \\cdot (\\kappa \\nabla u_h)$ 是内部残差，$\\|R_K\\|_{L_2(K)}$ 是其在单元 $K$ 上的 $L_2$ 范数。项 $J_e = [\\![\\kappa \\nabla u_h \\cdot \\mathbf{n}]\\!]$ 表示通量法向分量跨过边 $e$ 的跳跃，$\\|J_e\\|_{L_2(e)}$ 是其在边 $e$ 上的 $L_2$ 范数。常数 $C_{int}$ 和 $C_{edge}$ 依赖于插值理论和单元形状规则性，但在指标的标准定义中（由“典型”一词所暗示）通常取为 $1$。\n\n问题提供了以下数据，我们将其映射到公式中的各项：\n- 单元直径：$h_K = 0.1$。\n- 单元内部残差的大小（$L_2$范数）：$r_K = \\|R_K\\|_{L_2(K)} = 5$。\n- 该单元是一个三角形，因此有三条边，此处用 $i \\in \\{1, 2, 3\\}$ 索引。\n- 边长：$h_{e_1} = 0.1$，$h_{e_2} = 0.1$ 和 $h_{e_3} = 0.141$。\n- 对应边上的通量跳跃大小（$L_2$范数）：$j_{e_1} = \\|J_{e_1}\\|_{L_2(e_1)} = 3$，$j_{e_2} = \\|J_{e_2}\\|_{L_2(e_2)} = 1$ 和 $j_{e_3} = \\|J_{e_3}\\|_{L_2(e_3)} = 2$。\n\n当常数 $C_{int}$ 和 $C_{edge}$ 设为 $1$ 时，指标平方的公式变为：\n$$\n\\eta_K^2 = h_K^2 r_K^2 + h_{e_1} j_{e_1}^2 + h_{e_2} j_{e_2}^2 + h_{e_3} j_{e_3}^2\n$$\n现在我们将给定的数值代入此表达式。为按要求保持精确性，我们将使用分数进行计算。\n$h_K = \\frac{1}{10}$，$r_K = 5$\n$h_{e_1} = \\frac{1}{10}$，$j_{e_1} = 3$\n$h_{e_2} = \\frac{1}{10}$，$j_{e_2} = 1$\n$h_{e_3} = \\frac{141}{1000}$，$j_{e_3} = 2$\n\n来自内部残差的贡献是：\n$$\nh_K^2 r_K^2 = \\left(\\frac{1}{10}\\right)^2 (5)^2 = \\frac{1}{100} \\times 25 = \\frac{25}{100} = \\frac{1}{4}\n$$\n来自三条边上通量跳跃的贡献是：\n$$\nh_{e_1} j_{e_1}^2 = \\frac{1}{10} \\times (3)^2 = \\frac{9}{10}\n$$\n$$\nh_{e_2} j_{e_2}^2 = \\frac{1}{10} \\times (1)^2 = \\frac{1}{10}\n$$\n$$\nh_{e_3} j_{e_3}^2 = \\frac{141}{1000} \\times (2)^2 = \\frac{141}{1000} \\times 4 = \\frac{564}{1000} = \\frac{141}{250}\n$$\n现在，我们将这些分量相加来求 $\\eta_K^2$：\n$$\n\\eta_K^2 = \\frac{1}{4} + \\frac{9}{10} + \\frac{1}{10} + \\frac{141}{250}\n$$\n首先合并具有相同分母的项：\n$$\n\\eta_K^2 = \\frac{1}{4} + \\left(\\frac{9}{10} + \\frac{1}{10}\\right) + \\frac{141}{250} = \\frac{1}{4} + 1 + \\frac{141}{250} = \\frac{5}{4} + \\frac{141}{250}\n$$\n为了将这些分数相加，我们找到一个公分母，即 $500$：\n$$\n\\eta_K^2 = \\frac{5 \\times 125}{4 \\times 125} + \\frac{141 \\times 2}{250 \\times 2} = \\frac{625}{500} + \\frac{282}{500} = \\frac{625 + 282}{500} = \\frac{907}{500}\n$$\n问题要求的是单元指标 $\\eta_K$，它是这个值的平方根：\n$$\n\\eta_K = \\sqrt{\\frac{907}{500}}\n$$\n为提供一个简化的精确表达式，我们可以将分母有理化：\n$$\n\\eta_K = \\frac{\\sqrt{907}}{\\sqrt{500}} = \\frac{\\sqrt{907}}{\\sqrt{100 \\times 5}} = \\frac{\\sqrt{907}}{10\\sqrt{5}}\n$$\n将分子和分母同乘以 $\\sqrt{5}$：\n$$\n\\eta_K = \\frac{\\sqrt{907} \\times \\sqrt{5}}{10\\sqrt{5} \\times \\sqrt{5}} = \\frac{\\sqrt{907 \\times 5}}{10 \\times 5} = \\frac{\\sqrt{4535}}{50}\n$$\n数字 $907$ 是一个质数，所以根式 $\\sqrt{4535}$ 无法进一步简化。这就是单元指标的最终精确表达式。",
            "answer": "$$\\boxed{\\frac{\\sqrt{4535}}{50}}$$"
        },
        {
            "introduction": "在自适应加密过程向网格中添加新单元后，可能会导致部分区域的单元形状质量下降。为了恢复网格的整体质量并保证数值模拟的稳定性，我们通常会执行网格平滑操作。这个练习向您介绍拉普拉斯平滑，这是一种最常用且直观的网格优化技术，它通过将节点移动到其邻近节点的几何中心来改善单元形状。",
            "id": "3514501",
            "problem": "考虑一个无量纲化的二维域中的耦合热弹性和流体流动的多物理场模拟，其中应用自适应网格加密（AMR）来解析界面附近的陡峭梯度。为在加密后保持单元质量，通过最小化与网格顶点和边的图相关的标准狄利克雷能量来执行网格平滑阶段，其中边的权重为均匀正值。假设边界顶点保持固定（代表多物理场耦合中典型的狄利克雷边界条件），而内部顶点被平滑。\n\n从用于网格平滑的、具有均匀权重的狄利克雷能量的定义出发，推导内部顶点关于其相邻顶点的一阶最优性条件。然后，对一个初始位于 $(1,1)$ 的内部顶点应用一次基于拉普拉斯算子的平滑更新，该顶点的直接邻居位于 $(0,1)$、$(2,1)$、$(1,0)$ 和 $(1,3)$，并在更新过程中将这些邻居视为固定。坐标是无量纲的，因此不需要物理单位。\n\n将一步平滑后更新的顶点位置报告为单个有序对。无需四舍五入。",
            "solution": "该问题被评估为有效。它在科学上根植于偏微分方程数值方法这一成熟领域，特别是关于通过拉普拉斯平滑进行网格生成和质量改进。该问题是适定的、客观的、自洽的，并提供了推导唯一且有意义的解所需的所有必要信息。不存在矛盾、歧义或违反科学原理之处。\n\n根据要求，解答过程分为两部分：首先，推导内部顶点的一阶最优性条件；其次，将此结果应用于特定的顶点配置。\n\n第1部分：一阶最优性条件的推导\n\n问题指明，网格平滑是通过最小化网格图的标准狄利克雷能量来执行的。设网格中的顶点集合为 $V$，边集合为 $\\mathcal{E}$。每个顶点 $v_i \\in V$ 有一个位置向量 $\\mathbf{x}_i \\in \\mathbb{R}^2$。对于每条边 $(i,j) \\in \\mathcal{E}$，图的狄利克雷能量 $E$（具有均匀正权重 $w$）由边的平方长度之和给出，并由权重缩放：\n$$ E = \\sum_{(i,j) \\in \\mathcal{E}} w \\|\\mathbf{x}_i - \\mathbf{x}_j\\|^2 $$\n我们感兴趣的是通过最小化该能量来找到单个内部顶点（称之为 $v_k$）的最优位置。所有其他顶点的位置，包括 $v_k$ 的邻居和边界顶点，都被视为固定。因此，我们只需要考虑求和中涉及 $\\mathbf{x}_k$ 的项。 $v_k$ 的邻居集合表示为 $N(k)$。总能量中依赖于 $\\mathbf{x}_k$ 的部分是：\n$$ E_k(\\mathbf{x}_k) = \\sum_{j \\in N(k)} w \\|\\mathbf{x}_k - \\mathbf{x}_j\\|^2 $$\n为了找到使 $E_k$ 最小化的位置 $\\mathbf{x}_k$，我们必须找到 $E_k$ 相对于 $\\mathbf{x}_k$ 的梯度为零的点。这是一阶最优性条件。由于权重 $w$ 是一个均匀正常数，它缩放了能量函数但并未改变其最小值的位置。因此，对于这个最小化问题，我们可以不失一般性地设置 $w=1$。\n设 $\\mathbf{x}_k = (x_k, y_k)$ 且一个相邻顶点的位置为 $\\mathbf{x}_j = (x_j, y_j)$。能量函数变为：\n$$ E_k(x_k, y_k) = \\sum_{j \\in N(k)} \\left[ (x_k - x_j)^2 + (y_k - y_j)^2 \\right] $$\n我们计算 $E_k$ 关于 $x_k$ 和 $y_k$ 的偏导数：\n$$ \\frac{\\partial E_k}{\\partial x_k} = \\frac{\\partial}{\\partial x_k} \\sum_{j \\in N(k)} \\left[ (x_k - x_j)^2 + (y_k - y_j)^2 \\right] = \\sum_{j \\in N(k)} 2(x_k - x_j) $$\n$$ \\frac{\\partial E_k}{\\partial y_k} = \\frac{\\partial}{\\partial y_k} \\sum_{j \\in N(k)} \\left[ (x_k - x_j)^2 + (y_k - y_j)^2 \\right] = \\sum_{j \\in N(k)} 2(y_k - y_j) $$\n通过将梯度 $\\nabla_{\\mathbf{x}_k} E_k = \\left( \\frac{\\partial E_k}{\\partial x_k}, \\frac{\\partial E_k}{\\partial y_k} \\right)$ 设置为零向量 $\\mathbf{0} = (0,0)$，可以找到一阶最优性条件。\n对于 $x$ 分量：\n$$ \\sum_{j \\in N(k)} 2(x_k - x_j) = 0 $$\n$$ \\sum_{j \\in N(k)} x_k - \\sum_{j \\in N(k)} x_j = 0 $$\n设 $|N(k)|$ 是顶点 $v_k$ 的邻居数量。求和 $\\sum_{j \\in N(k)} x_k$ 简记为 $|N(k)| \\cdot x_k$。\n$$ |N(k)| x_k = \\sum_{j \\in N(k)} x_j \\implies x_k = \\frac{1}{|N(k)|} \\sum_{j \\in N(k)} x_j $$\n类似地，对于 $y$ 分量：\n$$ |N(k)| y_k = \\sum_{j \\in N(k)} y_j \\implies y_k = \\frac{1}{|N(k)|} \\sum_{j \\in N(k)} y_j $$\n将这些结果组合成向量形式，最优位置 $\\mathbf{x}_k$ 由下式给出：\n$$ \\mathbf{x}_k = \\frac{1}{|N(k)|} \\sum_{j \\in N(k)} \\mathbf{x}_j $$\n该条件表明，内部顶点的能量最小化位置是其相邻顶点的几何中心（重心）。这是拉普拉斯平滑的基本方程。\n\n第2部分：一次平滑更新的应用\n\n题目要求我们对一个内部顶点应用一次基于拉普拉斯算子的平滑更新。这意味着我们将顶点从其初始位置移动到上面推导出的最优位置，即其固定邻居的重心。\n\n该内部顶点的初始位置是 $\\mathbf{x}_{old} = (1, 1)$。\n其邻居的位置如下：\n$\\mathbf{x}_1 = (0, 1)$\n$\\mathbf{x}_2 = (2, 1)$\n$\\mathbf{x}_3 = (1, 0)$\n$\\mathbf{x}_4 = (1, 3)$\n\n邻居的数量是 $|N| = 4$。\n更新后的位置 $\\mathbf{x}_{new} = (x_{new}, y_{new})$ 使用第1部分推导的公式计算。\n\n对于 $x$ 坐标：\n$$ x_{new} = \\frac{1}{4} \\sum_{j=1}^{4} x_j = \\frac{1}{4} (0 + 2 + 1 + 1) = \\frac{4}{4} = 1 $$\n\n对于 $y$ 坐标：\n$$ y_{new} = \\frac{1}{4} \\sum_{j=1}^{4} y_j = \\frac{1}{4} (1 + 1 + 0 + 3) = \\frac{5}{4} $$\n\n因此，经过一步拉普拉斯平滑后，更新的顶点位置是 $(1, \\frac{5}{4})$。",
            "answer": "$$\\boxed{(1, \\frac{5}{4})}$$"
        }
    ]
}