{
    "hands_on_practices": [
        {
            "introduction": "The geometric quality of a finite element mesh is paramount for simulation accuracy. This exercise  grounds this abstract concept in the concrete mathematics of the isoparametric mapping. By computing the Jacobian's determinant and condition number, you will learn to quantitatively diagnose element distortion, a foundational skill in computational analysis.",
            "id": "3514474",
            "problem": "A two-dimensional isoparametric linear triangular finite element in a multiphysics coupled simulation has physical node coordinates $\\mathbf{x}_{1}=(0,0)$, $\\mathbf{x}_{2}=(2,0)$, and $\\mathbf{x}_{3}=(0.1,1)$. Consider the canonical reference triangle $\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$ with vertices $\\hat{\\mathbf{X}}_{1}=(0,0)$, $\\hat{\\mathbf{X}}_{2}=(1,0)$, and $\\hat{\\mathbf{X}}_{3}=(0,1)$. The isoparametric mapping is $\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$ with linear shape functions $N_{1}(\\xi,\\eta)=1-\\xi-\\eta$, $N_{2}(\\xi,\\eta)=\\xi$, and $N_{3}(\\xi,\\eta)=\\eta$. The Jacobian matrix is $J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$, and its determinant $\\det J$ characterizes local area deformation and orientation, while the two-norm condition number $\\kappa_{2}(J)$ characterizes metric anisotropy and skewness. In the context of Adaptive Mesh Refinement (AMR), elements with $\\det J\\le 0$ or very small $|\\det J|$ are considered near inversion, whereas large $\\kappa_{2}(J)$ indicates highly anisotropic or skewed elements.\n\nUsing only these fundamental definitions, compute $\\det J$ at the element center $(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$, estimate $\\kappa_{2}(J)$, and determine whether the element is near inversion or merely skewed. Provide clear reasoning based on the mapping and the spectral definition of $\\kappa_{2}(J)$ via the singular values of $J$. For your final reported value, provide only $\\kappa_{2}(J)$ rounded to four significant figures, expressed as a dimensionless decimal.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n**Step 1: Extract Givens**\n- **Element Type**: A two-dimensional isoparametric linear triangular finite element.\n- **Physical Node Coordinates**: $\\mathbf{x}_{1}=(0,0)$, $\\mathbf{x}_{2}=(2,0)$, and $\\mathbf{x}_{3}=(0.1,1)$.\n- **Canonical Reference Triangle**: $\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$.\n- **Reference Vertices**: $\\hat{\\mathbf{X}}_{1}=(0,0)$, $\\hat{\\mathbf{X}}_{2}=(1,0)$, and $\\hat{\\mathbf{X}}_{3}=(0,1)$.\n- **Isoparametric Mapping**: $\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$.\n- **Linear Shape Functions**: $N_{1}(\\xi,\\eta)=1-\\xi-\\eta$, $N_{2}(\\xi,\\eta)=\\xi$, and $N_{3}(\\xi,\\eta)=\\eta$.\n- **Jacobian Matrix Definition**: $J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$.\n- **Quality Metric Definitions**: $\\det J \\le 0$ or very small $|\\det J|$ indicates near inversion; large $\\kappa_{2}(J)$ indicates high anisotropy or skewness.\n- **Evaluation Point**: The element center, $(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$.\n- **Final Answer Format**: $\\kappa_{2}(J)$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it pertains to the standard theory of the Finite Element Method (FEM), specifically isoparametric mapping and element quality assessment. It is well-posed, providing all necessary definitions and data for a unique solution. The language is objective and precise. The problem is free of any scientific or factual unsoundness, incompleteness, contradictions, or other flaws listed in the validation criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe position vector $\\mathbf{x}$ of any point within the physical element is given by the isoparametric mapping:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} x(\\xi, \\eta) \\\\ y(\\xi, \\eta) \\end{pmatrix} = N_{1}(\\xi, \\eta)\\mathbf{x}_{1} + N_{2}(\\xi, \\eta)\\mathbf{x}_{2} + N_{3}(\\xi, \\eta)\\mathbf{x}_{3}\n$$\nSubstituting the given shape functions and nodal coordinates:\n$$\n\\mathbf{x}(\\xi, \\eta) = (1-\\xi-\\eta)\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\xi\\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\eta\\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}\n$$\nThis simplifies to the coordinate components:\n$$\nx(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(2) + \\eta(0.1) = 2\\xi + 0.1\\eta\n$$\n$$\ny(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(0) + \\eta(1) = \\eta\n$$\nThe mapping is therefore $\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} 2\\xi + 0.1\\eta \\\\ \\eta \\end{pmatrix}$.\n\nThe Jacobian matrix $J$ of the transformation is defined as:\n$$\nJ = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial x}{\\partial \\xi} = 2, \\quad \\frac{\\partial x}{\\partial \\eta} = 0.1\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = 1\n$$\nThus, the Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} 2  0.1 \\\\ 0  1 \\end{pmatrix}\n$$\nFor a linear isoparametric element, the mapping from reference to physical coordinates is affine. Consequently, the Jacobian matrix is constant throughout the element. Its value is independent of the evaluation point $(\\xi, \\eta)$, so the value at the element center is the same as everywhere else.\n\nFirst, we compute the determinant of the Jacobian, $\\det J$, to assess for element inversion.\n$$\n\\det J = (2)(1) - (0.1)(0) = 2\n$$\nSince $\\det J = 2 > 0$ and is not close to zero, the element is not inverted or near inversion. The mapping is orientation-preserving, with a constant local area expansion factor of $2$.\n\nNext, we compute the two-norm condition number, $\\kappa_{2}(J)$, to assess for skewness and anisotropy. $\\kappa_{2}(J)$ is defined as the ratio of the largest singular value ($\\sigma_{\\max}$) to the smallest singular value ($\\sigma_{\\min}$) of $J$:\n$$\n\\kappa_{2}(J) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}\n$$\nThe singular values of $J$ are the square roots of the eigenvalues of the matrix $J^T J$. Let's compute $J^T J$:\n$$\nJ^T = \\begin{pmatrix} 2  0 \\\\ 0.1  1 \\end{pmatrix}\n$$\n$$\nJ^T J = \\begin{pmatrix} 2  0 \\\\ 0.1  1 \\end{pmatrix} \\begin{pmatrix} 2  0.1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (2)(2) + (0)(0)  (2)(0.1) + (0)(1) \\\\ (0.1)(2) + (1)(0)  (0.1)(0.1) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 4  0.2 \\\\ 0.2  1.01 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $J^T J$ are found from the characteristic equation $\\det(J^T J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} 4-\\lambda  0.2 \\\\ 0.2  1.01-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(4-\\lambda)(1.01-\\lambda) - (0.2)^2 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4.04 - 0.04 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4 = 0\n$$\nUsing the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\lambda = \\frac{5.01 \\pm \\sqrt{(-5.01)^2 - 4(1)(4)}}{2} = \\frac{5.01 \\pm \\sqrt{25.1001 - 16}}{2} = \\frac{5.01 \\pm \\sqrt{9.1001}}{2}\n$$\nThe two eigenvalues are $\\lambda_{\\max} = \\frac{5.01 + \\sqrt{9.1001}}{2}$ and $\\lambda_{\\min} = \\frac{5.01 - \\sqrt{9.1001}}{2}$.\nThe condition number can be calculated as $\\kappa_{2}(J) = \\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$:\n$$\n\\kappa_{2}(J) = \\sqrt{\\frac{5.01 + \\sqrt{9.1001}}{5.01 - \\sqrt{9.1001}}}\n$$\nWe now compute the numerical value:\n$$\n\\sqrt{9.1001} \\approx 3.0166399\n$$\n$$\n\\kappa_{2}(J) \\approx \\sqrt{\\frac{5.01 + 3.0166399}{5.01 - 3.0166399}} = \\sqrt{\\frac{8.0266399}{1.9933601}} \\approx \\sqrt{4.026870} \\approx 2.0067064\n$$\nRounding to four significant figures, we get $\\kappa_{2}(J) \\approx 2.007$.\nA condition number of $\\kappa_{2}(J)=1$ signifies a perfectly isotropic mapping (e.g., mapping to an equilateral triangle). Since $\\kappa_{2}(J) \\approx 2.007 > 1$, the element exhibits anisotropy. The value is not extremely high, so it represents a moderately distorted or skewed element.\n\nIn summary, with $\\det J = 2$ and $\\kappa_{2}(J) \\approx 2.007$, the element is determined to be merely skewed, not near inversion. The final answer required is the numerical value of $\\kappa_{2}(J)$.",
            "answer": "$$\\boxed{2.007}$$"
        },
        {
            "introduction": "An effective adaptive strategy must refine the mesh where the solution error is largest. This practice  demonstrates how to quantify this error using a canonical residual-based error indicator. By combining contributions from the element interior and flux jumps at its edges, you will learn how an adaptive algorithm 'sees' the error and marks regions for refinement.",
            "id": "3514528",
            "problem": "Consider a stationary scalar diffusion model representative of a single-field subproblem within a multiphysics coupled simulation, governed by the strong form $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a bounded polygonal domain, with a conforming Finite Element Method (FEM) approximation $u_h \\in V_h$ on a two-dimensional mesh. In residual-based a posteriori error estimation for adaptive mesh refinement, the elementwise indicator is constructed from the element interior residual and the flux jump residuals across its edges. Let an element $K$ be shape-regular, with diameter $h_K$ and edge lengths $\\{h_{e}\\}_{e \\subset \\partial K}$, and let the elementwise interior residual magnitude be $r_K$ and the edgewise flux jump magnitudes be $\\{j_e\\}_{e \\subset \\partial K}$. The mesh quality metric $h_K$ and the edge lengths $\\{h_e\\}$ enter the scaling of the indicator through standard inverse and trace inequalities on shape-regular meshes.\n\nAssume the following data for a single triangular element $K$: the diameter is $h_K = 0.1$, the element interior residual magnitude is $r_K = 5$, and its three edges have flux jump magnitudes $(3, 1, 2)$ on edges of lengths $(0.1, 0.1, 0.141)$, respectively. Using the canonical residual-based scaling implied by the weak form and integration-by-parts residual representation, compute the element indicator $\\eta_K$ for $K$. Express your final answer as a single simplified exact expression. No rounding is required.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded within the established theory of a posteriori error estimation for the Finite Element Method (FEM), is well-posed with a complete and consistent set of givens, and is expressed in objective, formal language. There are no violations of fundamental principles, contradictions, or ambiguities. We may therefore proceed with the solution.\n\nThe problem asks for the computation of a local, residual-based a posteriori error indicator, denoted as $\\eta_K$, for a single triangular element $K$ in a two-dimensional domain. The underlying physics is described by a stationary scalar diffusion equation, $-\\nabla \\cdot (\\kappa \\nabla u) = f$, where $u$ is the scalar field, $\\kappa$ is the diffusion coefficient, and $f$ is a source term. The approximate solution obtained via FEM is denoted by $u_h$.\n\nThe \"canonical residual-based scaling\" for the error indicator $\\eta_K$ is derived from the weak form of the residual equation and the application of standard trace and inverse inequalities on a shape-regular mesh. The squared indicator $\\eta_K^2$ is composed of two main contributions: one from the residual within the element's interior and one from the jumps in flux across the element's edges. The general form is:\n$$\n\\eta_K^2 = C_{int}^2 h_K^2 \\|R_K\\|_{L_2(K)}^2 + \\sum_{e \\in \\partial K} C_{edge}^2 h_e \\|J_e\\|_{L_2(e)}^2\n$$\nHere, $h_K$ is the diameter of element $K$, and $\\{h_e\\}$ are the lengths of its edges. The term $R_K = f + \\nabla \\cdot (\\kappa \\nabla u_h)$ is the interior residual, and $\\|R_K\\|_{L_2(K)}$ is its $L_2$-norm over the element $K$. The term $J_e = [\\![\\kappa \\nabla u_h \\cdot \\mathbf{n}]\\!]$ represents the jump of the normal component of the flux across an edge $e$, and $\\|J_e\\|_{L_2(e)}$ is its $L_2$-norm over the edge $e$. The constants $C_{int}$ and $C_{edge}$ depend on interpolation theory and element shape regularity but are typically taken as $1$ in the standard definition of the indicator, which is implied by the term \"canonical\".\n\nThe problem provides the following data, which we map to the terms in the formula:\n- Element diameter: $h_K = 0.1$.\n- Magnitude of the element interior residual ($L_2$-norm): $r_K = \\|R_K\\|_{L_2(K)} = 5$.\n- The element is a triangle, hence it has three edges, indexed here by $i \\in \\{1, 2, 3\\}$.\n- Edge lengths: $h_{e_1} = 0.1$, $h_{e_2} = 0.1$, and $h_{e_3} = 0.141$.\n- Magnitudes of the flux jumps ($L_2$-norms) on the corresponding edges: $j_{e_1} = \\|J_{e_1}\\|_{L_2(e_1)} = 3$, $j_{e_2} = \\|J_{e_2}\\|_{L_2(e_2)} = 1$, and $j_{e_3} = \\|J_{e_3}\\|_{L_2(e_3)} = 2$.\n\nWith the constants $C_{int}$ and $C_{edge}$ set to $1$, the formula for the squared indicator becomes:\n$$\n\\eta_K^2 = h_K^2 r_K^2 + h_{e_1} j_{e_1}^2 + h_{e_2} j_{e_2}^2 + h_{e_3} j_{e_3}^2\n$$\nWe now substitute the given numerical values into this expression. To maintain exactness as requested, we will perform the calculation using fractions.\n$h_K = \\frac{1}{10}$, $r_K = 5$\n$h_{e_1} = \\frac{1}{10}$, $j_{e_1} = 3$\n$h_{e_2} = \\frac{1}{10}$, $j_{e_2} = 1$\n$h_{e_3} = \\frac{141}{1000}$, $j_{e_3} = 2$\n\nThe contribution from the interior residual is:\n$$\nh_K^2 r_K^2 = \\left(\\frac{1}{10}\\right)^2 (5)^2 = \\frac{1}{100} \\times 25 = \\frac{25}{100} = \\frac{1}{4}\n$$\nThe contributions from the flux jumps across the three edges are:\n$$\nh_{e_1} j_{e_1}^2 = \\frac{1}{10} \\times (3)^2 = \\frac{9}{10}\n$$\n$$\nh_{e_2} j_{e_2}^2 = \\frac{1}{10} \\times (1)^2 = \\frac{1}{10}\n$$\n$$\nh_{e_3} j_{e_3}^2 = \\frac{141}{1000} \\times (2)^2 = \\frac{141}{1000} \\times 4 = \\frac{564}{1000} = \\frac{141}{250}\n$$\nNow, we sum these components to find $\\eta_K^2$:\n$$\n\\eta_K^2 = \\frac{1}{4} + \\frac{9}{10} + \\frac{1}{10} + \\frac{141}{250}\n$$\nCombining the terms with common denominators first:\n$$\n\\eta_K^2 = \\frac{1}{4} + \\left(\\frac{9}{10} + \\frac{1}{10}\\right) + \\frac{141}{250} = \\frac{1}{4} + 1 + \\frac{141}{250} = \\frac{5}{4} + \\frac{141}{250}\n$$\nTo sum these fractions, we find a common denominator, which is $500$:\n$$\n\\eta_K^2 = \\frac{5 \\times 125}{4 \\times 125} + \\frac{141 \\times 2}{250 \\times 2} = \\frac{625}{500} + \\frac{282}{500} = \\frac{625 + 282}{500} = \\frac{907}{500}\n$$\nThe problem asks for the element indicator $\\eta_K$, which is the square root of this value:\n$$\n\\eta_K = \\sqrt{\\frac{907}{500}}\n$$\nTo provide a simplified exact expression, we can rationalize the denominator:\n$$\n\\eta_K = \\frac{\\sqrt{907}}{\\sqrt{500}} = \\frac{\\sqrt{907}}{\\sqrt{100 \\times 5}} = \\frac{\\sqrt{907}}{10\\sqrt{5}}\n$$\nMultiplying the numerator and denominator by $\\sqrt{5}$:\n$$\n\\eta_K = \\frac{\\sqrt{907} \\times \\sqrt{5}}{10\\sqrt{5} \\times \\sqrt{5}} = \\frac{\\sqrt{907 \\times 5}}{10 \\times 5} = \\frac{\\sqrt{4535}}{50}\n$$\nThe number $907$ is a prime number, so the radical $\\sqrt{4535}$ cannot be simplified further. This is the final exact expression for the element indicator.",
            "answer": "$$\\boxed{\\frac{\\sqrt{4535}}{50}}$$"
        },
        {
            "introduction": "Closing the adaptive loop requires a strategy for how to refine. This final exercise  explores the decision-making at the heart of $hp$-adaptivity, where one must choose between mesh size ($h$) or polynomial order ($p$) refinement. By working through a scenario to find an optimal refinement plan, you will gain insight into balancing accuracy gains against computational costs, a core challenge in modern simulation.",
            "id": "3514525",
            "problem": "Consider a two-dimensional elliptic problem discretized by a continuous Galerkin finite element method on a shape-regular quadrilateral mesh. For each element $K$, let the local polynomial degree be $p_K$, the elementwise a posteriori error indicator be $\\eta_K$, and the local Degrees of Freedom (DOF) count be $d(p_K)$. Assume a scalar field approximation with tensor-product polynomials of degree $p_K$ on each quadrilateral, so that $d(p) = (p+1)^2$. Let the mesh quality metric $Q_K$ be unity for all elements, indicating no degradation due to element shape.\n\nYou are tasked with designing a single-step $hp$ refinement plan that targets equidistribution of the normalized error-per-DOF, defined elementwise by $q_K := \\eta_K / d(p_K)$. Consider two refinement options for any element $K$:\n\n- Uniform $h$-refinement: split one quadrilateral into four congruent children, preserving $p_K$ on each child. For sufficiently smooth solutions, invoke the interpolation error scaling law from polynomial approximation theory, in which elementwise error behaves like $C h^{p_K+1}$ for mesh size $h$. Under a uniform split $h \\mapsto h/2$, the sum of the childrenâ€™s indicators scales by a factor $2^{-(p_K+1)}$. Treating the four children as identical, the per-child normalized error becomes\n$$\nq_{K,h} = \\frac{\\eta_K \\, 2^{-(p_K+1)}}{4 \\, d(p_K)}.\n$$\n\n- $p$-refinement: increase the polynomial degree by one, $p_K \\mapsto p_K+1$. For analytic solutions, the error obeys exponential $p$-convergence, $\\eta_K \\propto \\exp(-\\sigma p_K)$ for some $\\sigma  0$ depending on the singularity structure. For this exercise, take $\\sigma = \\ln(2)$, so that one degree increase multiplies the indicator by $2^{-1}$. The normalized error becomes\n$$\nq_{K,p} = \\frac{\\eta_K \\, 2^{-1}}{d(p_K+1)}.\n$$\n\nDefine equidistribution after one refinement step by choosing, for each element, either $h$-refinement or $p$-refinement to minimize the sum of squared deviations from the mean of the post-refinement $\\{q_K\\}$ values across the three elements. Use the following sample data for three elements:\n- Element $1$: $(\\eta_1, p_1) = (0.2, 1)$,\n- Element $2$: $(\\eta_2, p_2) = (0.05, 3)$,\n- Element $3$: $(\\eta_3, p_3) = (0.3, 1)$.\n\nAdopt the coding convention $0$ for $h$-refinement and $1$ for $p$-refinement. Let $t$ denote the mean of the three post-refinement normalized error-per-DOF values. Determine the action for each element and the resulting $t$ that minimizes the sum of squared deviations from $t$. Express your final answer as a single row matrix containing the three action codes followed by $t$, in the order of Elements $1,2,3$, then $t$. No rounding is required; express $t$ exactly as a fraction.",
            "solution": "The user has provided a problem on adaptive mesh refinement and requested a solution. As per the instructions, the first step is to validate the problem statement.\n\n### Step 1: Extract Givens\nThe data, variables, and conditions explicitly given in the problem statement are:\n- A two-dimensional elliptic problem is discretized using a continuous Galerkin finite element method on a shape-regular quadrilateral mesh.\n- For each element $K$, we have a local polynomial degree $p_K$ and an a posteriori error indicator $\\eta_K$.\n- The local Degrees of Freedom (DOF) count is $d(p) = (p+1)^2$ for tensor-product polynomials of degree $p$.\n- The mesh quality metric $Q_K$ is $1$ for all elements.\n- The normalized error-per-DOF is defined as $q_K := \\eta_K / d(p_K)$.\n- There are two refinement options for each element:\n    1.  **Uniform $h$-refinement (action code $0$):** A quadrilateral is split into four congruent children. The polynomial degree $p_K$ is preserved. The normalized error per child is given by the formula:\n        $$\n        q_{K,h} = \\frac{\\eta_K \\, 2^{-(p_K+1)}}{4 \\, d(p_K)}\n        $$\n    2.  **$p$-refinement (action code $1$):** The polynomial degree is increased by one, $p_K \\mapsto p_K+1$. The error indicator is multiplied by $2^{-1}$. The new normalized error is:\n        $$\n        q_{K,p} = \\frac{\\eta_K \\, 2^{-1}}{d(p_K+1)}\n        $$\n- The objective is to choose a refinement action for each of three specified elements to minimize the sum of squared deviations from the mean of the three post-refinement normalized error-per-DOF values.\n- The data for the three elements are:\n    - Element $1$: $(\\eta_1, p_1) = (0.2, 1)$\n    - Element $2$: $(\\eta_2, p_2) = (0.05, 3)$\n    - Element $3$: $(\\eta_3, p_3) = (0.3, 1)$\n- The final answer should be a row matrix containing the three action codes followed by the resulting mean, $t$, of the post-refinement values.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the theory of adaptive finite element methods, specifically $hp$-adaptivity. The formulas for error reduction under $h$- and $p$-refinement are simplified but standard models representing algebraic and exponential convergence, respectively. The concept of equidistributing an error measure is a cornerstone of adaptive meshing strategies. The DOF counting is correct for tensor-product elements. The problem is scientifically sound.\n- **Well-Posed:** The problem is a discrete optimization problem. With three elements and two choices for each, there are $2^3 = 8$ possible refinement scenarios. For each scenario, the objective function (sum of squared deviations) is uniquely defined. Since the set of possible outcomes is finite, a minimum value must exist. The problem is therefore well-posed.\n- **Objective:** The problem is stated using precise mathematical definitions and objective language, free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically grounded, well-posed, and objective. I will now proceed with the solution.\n\n### Solution\nThe objective is to find the refinement strategy $(a_1, a_2, a_3)$, where $a_i \\in \\{0, 1\\}$ represents the action for element $i$, which minimizes the sum of squared deviations of the post-refinement normalized errors $\\{q'_1, q'_2, q'_3\\}$ from their mean $t = \\frac{1}{3}(q'_1 + q'_2 + q'_3)$. This is equivalent to minimizing the variance of the set $\\{q'_1, q'_2, q'_3\\}$.\n\nFirst, we must calculate the two possible post-refinement normalized error values, $q_{i,h}$ and $q_{i,p}$, for each of the three elements using the provided data and formulas.\n\n**Element 1:** $(\\eta_1, p_1) = (0.2, 1)$\n- The initial DOF count is $d(p_1) = d(1) = (1+1)^2 = 4$.\n- For $h$-refinement (action $0$):\n  $$\n  q_{1,h} = \\frac{\\eta_1 \\, 2^{-(p_1+1)}}{4 \\, d(p_1)} = \\frac{0.2 \\cdot 2^{-(1+1)}}{4 \\cdot 4} = \\frac{0.2 \\cdot 2^{-2}}{16} = \\frac{0.2 \\cdot \\frac{1}{4}}{16} = \\frac{0.05}{16} = \\frac{\\frac{5}{100}}{16} = \\frac{\\frac{1}{20}}{16} = \\frac{1}{320}\n  $$\n- For $p$-refinement (action $1$):\n  - The new polynomial degree is $p_1+1 = 2$. The new DOF count is $d(2) = (2+1)^2 = 9$.\n  $$\n  q_{1,p} = \\frac{\\eta_1 \\, 2^{-1}}{d(p_1+1)} = \\frac{0.2 \\cdot \\frac{1}{2}}{9} = \\frac{0.1}{9} = \\frac{\\frac{1}{10}}{9} = \\frac{1}{90}\n  $$\n\n**Element 2:** $(\\eta_2, p_2) = (0.05, 3)$\n- The initial DOF count is $d(p_2) = d(3) = (3+1)^2 = 16$.\n- For $h$-refinement (action $0$):\n  $$\n  q_{2,h} = \\frac{\\eta_2 \\, 2^{-(p_2+1)}}{4 \\, d(p_2)} = \\frac{0.05 \\cdot 2^{-(3+1)}}{4 \\cdot 16} = \\frac{0.05 \\cdot 2^{-4}}{64} = \\frac{0.05 \\cdot \\frac{1}{16}}{64} = \\frac{\\frac{5}{100}}{1024} = \\frac{\\frac{1}{20}}{1024} = \\frac{1}{20480}\n  $$\n- For $p$-refinement (action $1$):\n  - The new polynomial degree is $p_2+1 = 4$. The new DOF count is $d(4) = (4+1)^2 = 25$.\n  $$\n  q_{2,p} = \\frac{\\eta_2 \\, 2^{-1}}{d(p_2+1)} = \\frac{0.05 \\cdot \\frac{1}{2}}{25} = \\frac{0.025}{25} = \\frac{\\frac{25}{1000}}{25} = \\frac{1}{1000}\n  $$\n\n**Element 3:** $(\\eta_3, p_3) = (0.3, 1)$\n- The initial DOF count is $d(p_3) = d(1) = (1+1)^2 = 4$.\n- For $h$-refinement (action $0$):\n  $$\n  q_{3,h} = \\frac{\\eta_3 \\, 2^{-(p_3+1)}}{4 \\, d(p_3)} = \\frac{0.3 \\cdot 2^{-(1+1)}}{4 \\cdot 4} = \\frac{0.3 \\cdot 2^{-2}}{16} = \\frac{0.3 \\cdot \\frac{1}{4}}{16} = \\frac{0.075}{16} = \\frac{\\frac{75}{1000}}{16} = \\frac{\\frac{3}{40}}{16} = \\frac{3}{640}\n  $$\n- For $p$-refinement (action $1$):\n  - The new polynomial degree is $p_3+1 = 2$. The new DOF count is $d(2) = (2+1)^2 = 9$.\n  $$\n  q_{3,p} = \\frac{\\eta_3 \\, 2^{-1}}{d(p_3+1)} = \\frac{0.3 \\cdot \\frac{1}{2}}{9} = \\frac{0.15}{9} = \\frac{\\frac{15}{100}}{9} = \\frac{\\frac{3}{20}}{9} = \\frac{3}{180} = \\frac{1}{60}\n  $$\n\nWe now have the set of possible outcomes for each element:\n- $q'_1 \\in \\left\\{ q_{1,h}, q_{1,p} \\right\\} = \\left\\{ \\frac{1}{320}, \\frac{1}{90} \\right\\}$\n- $q'_2 \\in \\left\\{ q_{2,h}, q_{2,p} \\right\\} = \\left\\{ \\frac{1}{20480}, \\frac{1}{1000} \\right\\}$\n- $q'_3 \\in \\left\\{ q_{3,h}, q_{3,p} \\right\\} = \\left\\{ \\frac{3}{640}, \\frac{1}{60} \\right\\}$\n\nTo minimize the variance, we should select the three values (one from each pair) that are closest to one another. Let's compare the values. Using decimal approximations can guide our intuition:\n- $q_{1,h} = 0.003125$; $q_{1,p} \\approx 0.01111$\n- $q_{2,h} \\approx 0.000049$; $q_{2,p} = 0.001$\n- $q_{3,h} = 0.0046875$; $q_{3,p} \\approx 0.01667$\n\nThe six possible values, in increasing order, are approximately $0.000049$, $0.001$, $0.003125$, $0.0046875$, $0.01111$, and $0.01667$. We need to pick one value from each element's pair $\\{q'_{1}, q'_{2}, q'_{3}\\}$ to form the tightest possible cluster.\n- For element 1, the choices are $\\approx 0.0031$ and $\\approx 0.0111$.\n- For element 2, the choices are $\\approx 0.00005$ and $0.001$.\n- For element 3, the choices are $\\approx 0.0047$ and $\\approx 0.0167$.\n\nConsider the set of values $\\{q_{1,h}, q_{2,p}, q_{3,h}\\} = \\{1/320, 1/1000, 3/640\\}$, which are approximately $\\{0.003125, 0.001, 0.0046875\\}$. These values appear to be clustered more tightly than any other combination. For instance, if we chose $q_{2,h}$ instead of $q_{2,p}$, the resulting set $\\{0.003125, 0.000049, 0.0046875\\}$ would have a much larger spread due to the very small value of $q_{2,h}$. Similarly, any combination involving the larger $p$-refinement values for elements $1$ and $3$ would also result in a larger spread.\n\nTherefore, the optimal strategy corresponds to the action vector $(0, 1, 0)$, which selects $h$-refinement for element $1$, $p$-refinement for element $2$, and $h$-refinement for element $3$. Let us calculate the mean $t$ for this optimal set of values $\\{q'_1, q'_2, q'_3\\} = \\{1/320, 1/1000, 3/640\\}$.\n\nTo compute the mean, we find a common denominator for $320$, $1000$, and $640$.\n- $320 = 2^6 \\cdot 5$\n- $1000 = 2^3 \\cdot 5^3$\n- $640 = 2^7 \\cdot 5$\nThe least common multiple is $2^7 \\cdot 5^3 = 128 \\cdot 125 = 16000$.\n\nNow we convert the fractions:\n- $q'_1 = \\frac{1}{320} = \\frac{1 \\cdot 50}{320 \\cdot 50} = \\frac{50}{16000}$\n- $q'_2 = \\frac{1}{1000} = \\frac{1 \\cdot 16}{1000 \\cdot 16} = \\frac{16}{16000}$\n- $q'_3 = \\frac{3}{640} = \\frac{3 \\cdot 25}{640 \\cdot 25} = \\frac{75}{16000}$\n\nThe sum of these values is:\n$$\n\\sum_{i=1}^{3} q'_i = \\frac{50}{16000} + \\frac{16}{16000} + \\frac{75}{16000} = \\frac{50 + 16 + 75}{16000} = \\frac{141}{16000}\n$$\nThe mean value $t$ is one-third of this sum:\n$$\nt = \\frac{1}{3} \\sum_{i=1}^{3} q'_i = \\frac{1}{3} \\cdot \\frac{141}{16000} = \\frac{47}{16000}\n$$\nThe optimal refinement strategy is given by the action codes $(0, 1, 0)$ for elements $1$, $2$, and $3$, respectively, resulting in a mean normalized error-per-DOF of $t = \\frac{47}{16000}$. The final answer is the row matrix of these four values.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  1  0  \\frac{47}{16000} \\end{pmatrix}}\n$$"
        }
    ]
}