{
    "hands_on_practices": [
        {
            "introduction": "The reliability of any finite element simulation hinges on the quality of the underlying mesh, as poorly shaped elements can lead to inaccurate results and numerical instability. We quantify an element's geometric quality by examining the isoparametric mapping from an ideal reference shape to its physical form in the mesh. This practice guides you through calculating two critical quality metrics from this mapping's Jacobian matrix—the determinant, which relates to element area and orientation, and the condition number, which measures anisotropy and skewness—to diagnose element distortion and the risk of inversion .",
            "id": "3514474",
            "problem": "A two-dimensional isoparametric linear triangular finite element in a multiphysics coupled simulation has physical node coordinates $\\mathbf{x}_{1}=(0,0)$, $\\mathbf{x}_{2}=(2,0)$, and $\\mathbf{x}_{3}=(0.1,1)$. Consider the canonical reference triangle $\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$ with vertices $\\hat{\\mathbf{X}}_{1}=(0,0)$, $\\hat{\\mathbf{X}}_{2}=(1,0)$, and $\\hat{\\mathbf{X}}_{3}=(0,1)$. The isoparametric mapping is $\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$ with linear shape functions $N_{1}(\\xi,\\eta)=1-\\xi-\\eta$, $N_{2}(\\xi,\\eta)=\\xi$, and $N_{3}(\\xi,\\eta)=\\eta$. The Jacobian matrix is $J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$, and its determinant $\\det J$ characterizes local area deformation and orientation, while the two-norm condition number $\\kappa_{2}(J)$ characterizes metric anisotropy and skewness. In the context of Adaptive Mesh Refinement (AMR), elements with $\\det J\\le 0$ or very small $|\\det J|$ are considered near inversion, whereas large $\\kappa_{2}(J)$ indicates highly anisotropic or skewed elements.\n\nUsing only these fundamental definitions, compute $\\det J$ at the element center $(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$, estimate $\\kappa_{2}(J)$, and determine whether the element is near inversion or merely skewed. Provide clear reasoning based on the mapping and the spectral definition of $\\kappa_{2}(J)$ via the singular values of $J$. For your final reported value, provide only $\\kappa_{2}(J)$ rounded to four significant figures, expressed as a dimensionless decimal.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n**Step 1: Extract Givens**\n- **Element Type**: A two-dimensional isoparametric linear triangular finite element.\n- **Physical Node Coordinates**: $\\mathbf{x}_{1}=(0,0)$, $\\mathbf{x}_{2}=(2,0)$, and $\\mathbf{x}_{3}=(0.1,1)$.\n- **Canonical Reference Triangle**: $\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$.\n- **Reference Vertices**: $\\hat{\\mathbf{X}}_{1}=(0,0)$, $\\hat{\\mathbf{X}}_{2}=(1,0)$, and $\\hat{\\mathbf{X}}_{3}=(0,1)$.\n- **Isoparametric Mapping**: $\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$.\n- **Linear Shape Functions**: $N_{1}(\\xi,\\eta)=1-\\xi-\\eta$, $N_{2}(\\xi,\\eta)=\\xi$, and $N_{3}(\\xi,\\eta)=\\eta$.\n- **Jacobian Matrix Definition**: $J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$.\n- **Quality Metric Definitions**: $\\det J \\le 0$ or very small $|\\det J|$ indicates near inversion; large $\\kappa_{2}(J)$ indicates high anisotropy or skewness.\n- **Evaluation Point**: The element center, $(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$.\n- **Final Answer Format**: $\\kappa_{2}(J)$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it pertains to the standard theory of the Finite Element Method (FEM), specifically isoparametric mapping and element quality assessment. It is well-posed, providing all necessary definitions and data for a unique solution. The language is objective and precise. The problem is free of any scientific or factual unsoundness, incompleteness, contradictions, or other flaws listed in the validation criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe position vector $\\mathbf{x}$ of any point within the physical element is given by the isoparametric mapping:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} x(\\xi, \\eta) \\\\ y(\\xi, \\eta) \\end{pmatrix} = N_{1}(\\xi, \\eta)\\mathbf{x}_{1} + N_{2}(\\xi, \\eta)\\mathbf{x}_{2} + N_{3}(\\xi, \\eta)\\mathbf{x}_{3}\n$$\nSubstituting the given shape functions and nodal coordinates:\n$$\n\\mathbf{x}(\\xi, \\eta) = (1-\\xi-\\eta)\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\xi\\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\eta\\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}\n$$\nThis simplifies to the coordinate components:\n$$\nx(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(2) + \\eta(0.1) = 2\\xi + 0.1\\eta\n$$\n$$\ny(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(0) + \\eta(1) = \\eta\n$$\nThe mapping is therefore $\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} 2\\xi + 0.1\\eta \\\\ \\eta \\end{pmatrix}$.\n\nThe Jacobian matrix $J$ of the transformation is defined as:\n$$\nJ = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial x}{\\partial \\xi} = 2, \\quad \\frac{\\partial x}{\\partial \\eta} = 0.1\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = 1\n$$\nThus, the Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} 2 & 0.1 \\\\ 0 & 1 \\end{pmatrix}\n$$\nFor a linear isoparametric element, the mapping from reference to physical coordinates is affine. Consequently, the Jacobian matrix is constant throughout the element. Its value is independent of the evaluation point $(\\xi, \\eta)$, so the value at the element center is the same as everywhere else.\n\nFirst, we compute the determinant of the Jacobian, $\\det J$, to assess for element inversion.\n$$\n\\det J = (2)(1) - (0.1)(0) = 2\n$$\nSince $\\det J = 2 > 0$ and is not close to zero, the element is not inverted or near inversion. The mapping is orientation-preserving, with a constant local area expansion factor of $2$.\n\nNext, we compute the two-norm condition number, $\\kappa_{2}(J)$, to assess for skewness and anisotropy. $\\kappa_{2}(J)$ is defined as the ratio of the largest singular value ($\\sigma_{\\max}$) to the smallest singular value ($\\sigma_{\\min}$) of $J$:\n$$\n\\kappa_{2}(J) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}\n$$\nThe singular values of $J$ are the square roots of the eigenvalues of the matrix $J^T J$. Let's compute $J^T J$:\n$$\nJ^T = \\begin{pmatrix} 2 & 0 \\\\ 0.1 & 1 \\end{pmatrix}\n$$\n$$\nJ^T J = \\begin{pmatrix} 2 & 0 \\\\ 0.1 & 1 \\end{pmatrix} \\begin{pmatrix} 2 & 0.1 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (2)(2) + (0)(0) & (2)(0.1) + (0)(1) \\\\ (0.1)(2) + (1)(0) & (0.1)(0.1) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 4 & 0.2 \\\\ 0.2 & 1.01 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $J^T J$ are found from the characteristic equation $\\det(J^T J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} 4-\\lambda & 0.2 \\\\ 0.2 & 1.01-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(4-\\lambda)(1.01-\\lambda) - (0.2)^2 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4.04 - 0.04 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4 = 0\n$$\nUsing the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\lambda = \\frac{5.01 \\pm \\sqrt{(-5.01)^2 - 4(1)(4)}}{2} = \\frac{5.01 \\pm \\sqrt{25.1001 - 16}}{2} = \\frac{5.01 \\pm \\sqrt{9.1001}}{2}\n$$\nThe two eigenvalues are $\\lambda_{\\max} = \\frac{5.01 + \\sqrt{9.1001}}{2}$ and $\\lambda_{\\min} = \\frac{5.01 - \\sqrt{9.1001}}{2}$.\nThe condition number can be calculated as $\\kappa_{2}(J) = \\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$:\n$$\n\\kappa_{2}(J) = \\sqrt{\\frac{5.01 + \\sqrt{9.1001}}{5.01 - \\sqrt{9.1001}}}\n$$\nWe now compute the numerical value:\n$$\n\\sqrt{9.1001} \\approx 3.0166399\n$$\n$$\n\\kappa_{2}(J) \\approx \\sqrt{\\frac{5.01 + 3.0166399}{5.01 - 3.0166399}} = \\sqrt{\\frac{8.0266399}{1.9933601}} \\approx \\sqrt{4.026870} \\approx 2.0067064\n$$\nRounding to four significant figures, we get $\\kappa_{2}(J) \\approx 2.007$.\nA condition number of $\\kappa_{2}(J)=1$ signifies a perfectly isotropic mapping (e.g., mapping to an equilateral triangle). Since $\\kappa_{2}(J) \\approx 2.007 > 1$, the element exhibits anisotropy. The value is not extremely high, so it represents a moderately distorted or skewed element.\n\nIn summary, with $\\det J = 2$ and $\\kappa_{2}(J) \\approx 2.007$, the element is determined to be merely skewed, not near inversion. The final answer required is the numerical value of $\\kappa_{2}(J)$.",
            "answer": "$$\\boxed{2.007}$$"
        },
        {
            "introduction": "While good geometric quality is essential, an efficient mesh must also be adapted to the unique features of the physical solution, with higher density in regions of steep gradients. A posteriori error indicators are computed from an initial numerical solution to quantify the local error and guide the adaptive mesh refinement (AMR) process. This exercise provides a hands-on calculation of a standard residual-based error indicator, demonstrating how information about the solution's residual, both inside an element and at its boundaries, is combined to \"flag\" the element for refinement .",
            "id": "3514528",
            "problem": "Consider a stationary scalar diffusion model representative of a single-field subproblem within a multiphysics coupled simulation, governed by the strong form $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a bounded polygonal domain, with a conforming Finite Element Method (FEM) approximation $u_h \\in V_h$ on a two-dimensional mesh. In residual-based a posteriori error estimation for adaptive mesh refinement, the elementwise indicator is constructed from the element interior residual and the flux jump residuals across its edges. Let an element $K$ be shape-regular, with diameter $h_K$ and edge lengths $\\{h_{e}\\}_{e \\subset \\partial K}$, and let the elementwise interior residual magnitude be $r_K$ and the edgewise flux jump magnitudes be $\\{j_e\\}_{e \\subset \\partial K}$. The mesh quality metric $h_K$ and the edge lengths $\\{h_e\\}$ enter the scaling of the indicator through standard inverse and trace inequalities on shape-regular meshes.\n\nAssume the following data for a single triangular element $K$: the diameter is $h_K = 0.1$, the element interior residual magnitude is $r_K = 5$, and its three edges have flux jump magnitudes $(3, 1, 2)$ on edges of lengths $(0.1, 0.1, 0.141)$, respectively. Using the canonical residual-based scaling implied by the weak form and integration-by-parts residual representation, compute the element indicator $\\eta_K$ for $K$. Express your final answer as a single simplified exact expression. No rounding is required.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded within the established theory of a posteriori error estimation for the Finite Element Method (FEM), is well-posed with a complete and consistent set of givens, and is expressed in objective, formal language. There are no violations of fundamental principles, contradictions, or ambiguities. We may therefore proceed with the solution.\n\nThe problem asks for the computation of a local, residual-based a posteriori error indicator, denoted as $\\eta_K$, for a single triangular element $K$ in a two-dimensional domain. The underlying physics is described by a stationary scalar diffusion equation, $-\\nabla \\cdot (\\kappa \\nabla u) = f$, where $u$ is the scalar field, $\\kappa$ is the diffusion coefficient, and $f$ is a source term. The approximate solution obtained via FEM is denoted by $u_h$.\n\nThe \"canonical residual-based scaling\" for the error indicator $\\eta_K$ is derived from the weak form of the residual equation and the application of standard trace and inverse inequalities on a shape-regular mesh. The squared indicator $\\eta_K^2$ is composed of two main contributions: one from the residual within the element's interior and one from the jumps in flux across the element's edges. The general form is:\n$$\n\\eta_K^2 = C_{int}^2 h_K^2 \\|R_K\\|_{L_2(K)}^2 + \\sum_{e \\in \\partial K} C_{edge}^2 h_e \\|J_e\\|_{L_2(e)}^2\n$$\nHere, $h_K$ is the diameter of element $K$, and $\\{h_e\\}$ are the lengths of its edges. The term $R_K = f + \\nabla \\cdot (\\kappa \\nabla u_h)$ is the interior residual, and $\\|R_K\\|_{L_2(K)}$ is its $L_2$-norm over the element $K$. The term $J_e = \\llbracket \\kappa \\nabla u_h \\cdot \\mathbf{n} \\rrbracket$ represents the jump of the normal component of the flux across an edge $e$, and $\\|J_e\\|_{L_2(e)}$ is its $L_2$-norm over the edge $e$. The constants $C_{int}$ and $C_{edge}$ depend on interpolation theory and element shape regularity but are typically taken as $1$ in the standard definition of the indicator, which is implied by the term \"canonical\".\n\nThe problem provides the following data, which we map to the terms in the formula:\n- Element diameter: $h_K = 0.1$.\n- Magnitude of the element interior residual ($L_2$-norm): $r_K = \\|R_K\\|_{L_2(K)} = 5$.\n- The element is a triangle, hence it has three edges, indexed here by $i \\in \\{1, 2, 3\\}$.\n- Edge lengths: $h_{e_1} = 0.1$, $h_{e_2} = 0.1$, and $h_{e_3} = 0.141$.\n- Magnitudes of the flux jumps ($L_2$-norms) on the corresponding edges: $j_{e_1} = \\|J_{e_1}\\|_{L_2(e_1)} = 3$, $j_{e_2} = \\|J_{e_2}\\|_{L_2(e_2)} = 1$, and $j_{e_3} = \\|J_{e_3}\\|_{L_2(e_3)} = 2$.\n\nWith the constants $C_{int}$ and $C_{edge}$ set to $1$, the formula for the squared indicator becomes:\n$$\n\\eta_K^2 = h_K^2 r_K^2 + h_{e_1} j_{e_1}^2 + h_{e_2} j_{e_2}^2 + h_{e_3} j_{e_3}^2\n$$\nWe now substitute the given numerical values into this expression. To maintain exactness as requested, we will perform the calculation using fractions.\n$h_K = \\frac{1}{10}$, $r_K = 5$\n$h_{e_1} = \\frac{1}{10}$, $j_{e_1} = 3$\n$h_{e_2} = \\frac{1}{10}$, $j_{e_2} = 1$\n$h_{e_3} = \\frac{141}{1000}$, $j_{e_3} = 2$\n\nThe contribution from the interior residual is:\n$$\nh_K^2 r_K^2 = \\left(\\frac{1}{10}\\right)^2 (5)^2 = \\frac{1}{100} \\times 25 = \\frac{25}{100} = \\frac{1}{4}\n$$\nThe contributions from the flux jumps across the three edges are:\n$$\nh_{e_1} j_{e_1}^2 = \\frac{1}{10} \\times (3)^2 = \\frac{9}{10}\n$$\n$$\nh_{e_2} j_{e_2}^2 = \\frac{1}{10} \\times (1)^2 = \\frac{1}{10}\n$$\n$$\nh_{e_3} j_{e_3}^2 = \\frac{141}{1000} \\times (2)^2 = \\frac{141}{1000} \\times 4 = \\frac{564}{1000} = \\frac{141}{250}\n$$\nNow, we sum these components to find $\\eta_K^2$:\n$$\n\\eta_K^2 = \\frac{1}{4} + \\frac{9}{10} + \\frac{1}{10} + \\frac{141}{250}\n$$\nCombining the terms with common denominators first:\n$$\n\\eta_K^2 = \\frac{1}{4} + \\left(\\frac{9}{10} + \\frac{1}{10}\\right) + \\frac{141}{250} = \\frac{1}{4} + 1 + \\frac{141}{250} = \\frac{5}{4} + \\frac{141}{250}\n$$\nTo sum these fractions, we find a common denominator, which is $500$:\n$$\n\\eta_K^2 = \\frac{5 \\times 125}{4 \\times 125} + \\frac{141 \\times 2}{250 \\times 2} = \\frac{625}{500} + \\frac{282}{500} = \\frac{625 + 282}{500} = \\frac{907}{500}\n$$\nThe problem asks for the element indicator $\\eta_K$, which is the square root of this value:\n$$\n\\eta_K = \\sqrt{\\frac{907}{500}}\n$$\nTo provide a simplified exact expression, we can rationalize the denominator:\n$$\n\\eta_K = \\frac{\\sqrt{907}}{\\sqrt{500}} = \\frac{\\sqrt{907}}{\\sqrt{100 \\times 5}} = \\frac{\\sqrt{907}}{10\\sqrt{5}}\n$$\nMultiplying the numerator and denominator by $\\sqrt{5}$:\n$$\n\\eta_K = \\frac{\\sqrt{907} \\times \\sqrt{5}}{10\\sqrt{5} \\times \\sqrt{5}} = \\frac{\\sqrt{907 \\times 5}}{10 \\times 5} = \\frac{\\sqrt{4535}}{50}\n$$\nThe number $907$ is a prime number, so the radical $\\sqrt{4535}$ cannot be simplified further. This is the final exact expression for the element indicator.",
            "answer": "$$\\boxed{\\frac{\\sqrt{4535}}{50}}$$"
        },
        {
            "introduction": "Once an element is marked for refinement, the process of subdividing it can introduce topological challenges that must be carefully managed to maintain the integrity of the simulation. A common outcome of local refinement is the creation of \"hanging nodes\" on interfaces between coarse and fine elements, which, if left unconstrained, would violate the required continuity of the finite element solution space. In this final practice, you will derive the linear constraint for a hanging node on a bilinear quadrilateral element, a fundamental procedure for ensuring a valid, conforming approximation on an adaptively refined mesh .",
            "id": "3514507",
            "problem": "Consider a multiphysics coupled simulation discretized by the Finite Element Method (FEM) on a two-dimensional mesh of isoparametric bilinear quadrilateral elements (bilinear $Q_1$ elements). Adaptive Mesh Refinement (AMR) with a $2{:}1$ refinement ratio is applied near a coupled interface where a mesh quality metric indicates deteriorating element shape quality and anisotropy. On a coarse-to-fine interface, this AMR produces a hanging node at the midpoint of a coarse element edge. Assume a scalar field $u$ (for example, pressure in a fluid-structure interaction subproblem) is represented by piecewise bilinear shape functions on each element, and global continuity in the Sobolev space $H^1$ (requiring square-integrable values and first-order partial derivatives) across the interface must be enforced.\n\nStarting from the core definitions of isoparametric bilinear quadrilateral shape functions on the reference square $\\left[-1,1\\right] \\times \\left[-1,1\\right]$, and the requirement that the trace of $u$ be continuous across the coarse-fine interface, derive the linear constraint that relates the degrees of freedom at a hanging node to its two parent coarse-edge vertex values. Let the two parent vertex values on the coarse edge be $u_{A}$ and $u_{B}$, and let the hanging node value be $u_{h}$. The hanging node lies at the midpoint of the straight coarse edge between the two parent vertices.\n\nExpress your final answer as a single closed-form analytic expression for $u_{h}$ in terms of $u_{A}$ and $u_{B}$. No numerical rounding is required. No physical units apply.",
            "solution": "The problem is well-posed and scientifically grounded in the theory of the Finite Element Method (FEM). It requests the derivation of a standard constraint for a hanging node that arises in adaptive mesh refinement (AMR) for isoparametric bilinear quadrilateral elements. The derivation is based on fundamental principles of FEM, specifically the requirement for function continuity across element boundaries.\n\nThe core principle for this derivation is the enforcement of continuity for the scalar field $u$ across the interface between the coarse element and the refined elements. The problem specifies that the solution space is the Sobolev space $H^1$, which implies, among other properties, that the function $u$ must be continuous across element boundaries (it must possess $C^0$ continuity). The value of the field at any point on the shared boundary must be the same regardless of which element is used for its evaluation.\n\nLet us consider the coarse bilinear quadrilateral element. The field $u$ within this element is interpolated from the values at its four vertices using bilinear shape functions. In a local parametric coordinate system $(\\xi, \\eta)$, where $\\xi \\in [-1, 1]$ and $\\eta \\in [-1, 1]$ on a reference square, the field is given by:\n$$u(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i$$\nwhere $u_i$ are the nodal values at the four vertices of the element and $N_i(\\xi, \\eta)$ are the bilinear shape functions:\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\nLet the coarse edge in question be aligned with the edge $\\eta = -1$ on the reference square. This edge connects the vertices corresponding to local node numbers $1$ (at $\\xi = -1, \\eta = -1$) and $2$ (at $\\xi = 1, \\eta = -1$). Let the nodal values at these two parent vertices be $u_A$ and $u_B$, respectively. Thus, we associate $u_A$ with local node $1$ ($u_1$) and $u_B$ with local node $2$ ($u_2$).\n\nTo find the variation of the field $u$ along this edge, we evaluate the shape functions at $\\eta = -1$:\n$$N_1(\\xi, -1) = \\frac{1}{4}(1-\\xi)(1 - (-1)) = \\frac{1}{2}(1-\\xi)$$\n$$N_2(\\xi, -1) = \\frac{1}{4}(1+\\xi)(1 - (-1)) = \\frac{1}{2}(1+\\xi)$$\n$$N_3(\\xi, -1) = \\frac{1}{4}(1+\\xi)(1 - 1) = 0$$\n$$N_4(\\xi, -1) = \\frac{1}{4}(1-\\xi)(1 - 1) = 0$$\n\nAs expected, the field along this edge depends only on the nodal values at the ends of the edge. The interpolation for $u$ along the edge becomes a one-dimensional linear interpolation in the parameter $\\xi$:\n$$u(\\xi, -1) = N_1(\\xi, -1)u_{A} + N_2(\\xi, -1)u_{B} = \\frac{1}{2}(1-\\xi)u_{A} + \\frac{1}{2}(1+\\xi)u_{B}$$\nThis equation shows that the interpolated field $u$ varies linearly along the edge of a bilinear element.\n\nThe problem states that the elements are isoparametric, meaning the geometric coordinates are interpolated using the same shape functions. It also specifies a straight coarse edge. A hanging node, with an associated degree of freedom $u_h$, is located at the midpoint of this physical edge. For a straight edge defined by two vertices, the geometric midpoint in physical space corresponds to the midpoint in the parametric space. The parametric edge runs from $\\xi = -1$ to $\\xi = 1$, so its midpoint is at $\\xi = 0$.\n\nTo enforce continuity, the value of the degree of freedom at the hanging node, $u_h$, must be equal to the value of the field as interpolated from the coarse element's degrees of freedom at that physical location. We therefore evaluate the expression for $u$ along the coarse edge at the parametric coordinate of the hanging node, $\\xi = 0$:\n$$u_h = u(0, -1) = \\frac{1}{2}(1-0)u_{A} + \\frac{1}{2}(1+0)u_{B}$$\n\nThis simplifies to the required linear constraint:\n$$u_h = \\frac{1}{2}u_{A} + \\frac{1}{2}u_{B}$$\nThis constraint ensures that the piecewise field representation remains continuous across the coarse-to-fine interface. The value at the hanging node is not an independent degree of freedom but is determined by the average of the values at its two parent vertices on the coarse edge.",
            "answer": "$$\\boxed{\\frac{1}{2}(u_{A} + u_{B})}$$"
        }
    ]
}