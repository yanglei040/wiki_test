{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，从理想的参考单元到物理空间中实际单元的几何映射是至关重要的。该映射的雅可比矩阵（Jacobian matrix）是评估单元几何形状质量的核心工具，其行列式和条件数可以分别揭示单元是否发生翻转以及其扭曲或各向异性的程度。本练习将通过一个具体的计算，帮助你掌握这些关键指标的应用，从而能够量化地评估网格单元的质量。",
            "id": "3514474",
            "problem": "在多物理场耦合模拟中，一个二维等参线性三角形有限元的物理节点坐标为 $\\mathbf{x}_{1}=(0,0)$、$\\mathbf{x}_{2}=(2,0)$ 和 $\\mathbf{x}_{3}=(0.1,1)$。考虑标准参考三角形 $\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$，其顶点为 $\\hat{\\mathbf{X}}_{1}=(0,0)$、$\\hat{\\mathbf{X}}_{2}=(1,0)$ 和 $\\hat{\\mathbf{X}}_{3}=(0,1)$。等参映射为 $\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$，其中线性形函数为 $N_{1}(\\xi,\\eta)=1-\\xi-\\eta$、$N_{2}(\\xi,\\eta)=\\xi$ 和 $N_{3}(\\xi,\\eta)=\\eta$。雅可比矩阵为 $J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$，其行列式 $\\det J$ 表征局部面积变形和方向，而其2-范数条件数 $\\kappa_{2}(J)$ 表征度量各向异性和偏斜度。在自适应网格加密（AMR）的背景下，$\\det J\\le 0$ 或 $|\\det J|$ 值非常小的单元被认为是接近翻转的，而大的 $\\kappa_{2}(J)$ 表示高度各向异性或偏斜的单元。\n\n仅使用这些基本定义，计算单元中心 $(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$ 处的 $\\det J$，估算 $\\kappa_{2}(J)$，并确定该单元是接近翻转还是仅仅是偏斜。请基于映射和通过 $J$ 的奇异值得出的 $\\kappa_{2}(J)$ 的谱定义，提供清晰的推理。对于最终报告值，仅提供四位有效数字的 $\\kappa_{2}(J)$，以无量纲小数形式表示。",
            "solution": "首先验证问题，以确保其自洽、科学上可靠且是适定的。\n\n**第1步：提取已知条件**\n- **单元类型**：二维等参线性三角形有限元。\n- **物理节点坐标**：$\\mathbf{x}_{1}=(0,0)$, $\\mathbf{x}_{2}=(2,0)$, 和 $\\mathbf{x}_{3}=(0.1,1)$。\n- **标准参考三角形**：$\\hat{T}=\\{(\\xi,\\eta)\\,|\\,\\xi\\ge 0,\\,\\eta\\ge 0,\\,\\xi+\\eta\\le 1\\}$。\n- **参考顶点**：$\\hat{\\mathbf{X}}_{1}=(0,0)$, $\\hat{\\mathbf{X}}_{2}=(1,0)$, 和 $\\hat{\\mathbf{X}}_{3}=(0,1)$。\n- **等参映射**：$\\mathbf{x}(\\xi,\\eta)=N_{1}(\\xi,\\eta)\\,\\mathbf{x}_{1}+N_{2}(\\xi,\\eta)\\,\\mathbf{x}_{2}+N_{3}(\\xi,\\eta)\\,\\mathbf{x}_{3}$。\n- **线性形函数**：$N_{1}(\\xi,\\eta)=1-\\xi-\\eta$, $N_{2}(\\xi,\\eta)=\\xi$, 和 $N_{3}(\\xi,\\eta)=\\eta$。\n- **雅可比矩阵定义**：$J(\\xi,\\eta)=\\partial \\mathbf{x}/\\partial(\\xi,\\eta)$。\n- **质量度量定义**：$\\det J \\le 0$ 或非常小的 $|\\det J|$ 表示接近翻转；大的 $\\kappa_{2}(J)$ 表示高度各向异性或偏斜。\n- **求值点**：单元中心，$(\\xi,\\eta)=(\\frac{1}{3},\\frac{1}{3})$。\n- **最终答案格式**：$\\kappa_{2}(J)$ 四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在科学上是可靠的，因为它涉及有限元方法（FEM）的标准理论，特别是等参映射和单元质量评估。它是适定的，为得到唯一解提供了所有必要的定义和数据。语言客观而精确。该问题没有任何科学或事实上的不健全、不完整、矛盾或验证标准中列出的其他缺陷。\n\n**第3步：结论与行动**\n问题有效。将提供完整的解决方案。\n\n**求解过程**\n\n物理单元内任意点的位置向量 $\\mathbf{x}$ 由等参映射给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} x(\\xi, \\eta) \\\\ y(\\xi, \\eta) \\end{pmatrix} = N_{1}(\\xi, \\eta)\\mathbf{x}_{1} + N_{2}(\\xi, \\eta)\\mathbf{x}_{2} + N_{3}(\\xi, \\eta)\\mathbf{x}_{3}\n$$\n代入给定的形函数和节点坐标：\n$$\n\\mathbf{x}(\\xi, \\eta) = (1-\\xi-\\eta)\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\xi\\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\eta\\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}\n$$\n这简化为坐标分量：\n$$\nx(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(2) + \\eta(0.1) = 2\\xi + 0.1\\eta\n$$\n$$\ny(\\xi, \\eta) = (1-\\xi-\\eta)(0) + \\xi(0) + \\eta(1) = \\eta\n$$\n因此，映射为 $\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} 2\\xi + 0.1\\eta \\\\ \\eta \\end{pmatrix}$。\n\n变换的雅可比矩阵 $J$ 定义为：\n$$\nJ = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = 2, \\quad \\frac{\\partial x}{\\partial \\eta} = 0.1\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = 1\n$$\n因此，雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} 2  0.1 \\\\ 0  1 \\end{pmatrix}\n$$\n对于线性等参单元，从参考坐标到物理坐标的映射是仿射的。因此，雅可比矩阵在整个单元内是常数。其值与求值点 $(\\xi, \\eta)$ 无关，因此在单元中心的值与在其他任何地方的值都相同。\n\n首先，我们计算雅可比矩阵的行列式 $\\det J$，以评估单元是否翻转。\n$$\n\\det J = (2)(1) - (0.1)(0) = 2\n$$\n由于 $\\det J = 2  0$ 且不接近于零，因此该单元没有翻转或接近翻转。该映射是保向的，具有一个恒定的局部面积扩大因子 $2$。\n\n接下来，我们计算2-范数条件数 $\\kappa_{2}(J)$，以评估偏斜度和各向异性。$\\kappa_{2}(J)$ 定义为 $J$ 的最大奇异值 ($\\sigma_{\\max}$) 与最小奇异值 ($\\sigma_{\\min}$) 之比：\n$$\n\\kappa_{2}(J) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}\n$$\n$J$ 的奇异值是矩阵 $J^T J$ 的特征值的平方根。我们来计算 $J^T J$：\n$$\nJ^T = \\begin{pmatrix} 2  0 \\\\ 0.1  1 \\end{pmatrix}\n$$\n$$\nJ^T J = \\begin{pmatrix} 2  0 \\\\ 0.1  1 \\end{pmatrix} \\begin{pmatrix} 2  0.1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (2)(2) + (0)(0)  (2)(0.1) + (0)(1) \\\\ (0.1)(2) + (1)(0)  (0.1)(0.1) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 4  0.2 \\\\ 0.2  1.01 \\end{pmatrix}\n$$\n$J^T J$ 的特征值 $\\lambda$ 可从特征方程 $\\det(J^T J - \\lambda I) = 0$ 中求得：\n$$\n\\det \\begin{pmatrix} 4-\\lambda  0.2 \\\\ 0.2  1.01-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(4-\\lambda)(1.01-\\lambda) - (0.2)^2 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4.04 - 0.04 = 0\n$$\n$$\n\\lambda^2 - 5.01\\lambda + 4 = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda = \\frac{5.01 \\pm \\sqrt{(-5.01)^2 - 4(1)(4)}}{2} = \\frac{5.01 \\pm \\sqrt{25.1001 - 16}}{2} = \\frac{5.01 \\pm \\sqrt{9.1001}}{2}\n$$\n两个特征值为 $\\lambda_{\\max} = \\frac{5.01 + \\sqrt{9.1001}}{2}$ 和 $\\lambda_{\\min} = \\frac{5.01 - \\sqrt{9.1001}}{2}$。\n条件数可以计算为 $\\kappa_{2}(J) = \\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$：\n$$\n\\kappa_{2}(J) = \\sqrt{\\frac{5.01 + \\sqrt{9.1001}}{5.01 - \\sqrt{9.1001}}}\n$$\n我们现在计算数值：\n$$\n\\sqrt{9.1001} \\approx 3.0166399\n$$\n$$\n\\kappa_{2}(J) \\approx \\sqrt{\\frac{5.01 + 3.0166399}{5.01 - 3.0166399}} = \\sqrt{\\frac{8.0266399}{1.9933601}} \\approx \\sqrt{4.026870} \\approx 2.0067064\n$$\n四舍五入到四位有效数字，我们得到 $\\kappa_{2}(J) \\approx 2.007$。\n条件数 $\\kappa_{2}(J)=1$ 表示完全各向同性的映射（例如，映射到等边三角形）。由于 $\\kappa_{2}(J) \\approx 2.007  1$，该单元表现出各向异性。这个值不是非常高，因此它代表一个中等程度扭曲或偏斜的单元。\n\n总而言之，由于 $\\det J = 2$ 且 $\\kappa_{2}(J) \\approx 2.007$，该单元被确定为仅仅是偏斜，而非接近翻转。所要求的最终答案是 $\\kappa_{2}(J)$ 的数值。",
            "answer": "$$\\boxed{2.007}$$"
        },
        {
            "introduction": "拥有一个几何质量良好的网格是第一步，但为了高效地求解问题，我们还需要确保网格分辨率能够充分捕捉解的关键特征。自适应网格加密（Adaptive Mesh Refinement, AMR）技术的核心在于准确地识别出需要细化的区域，而后验误差指示子（a posteriori error indicator）正是实现这一目标的关键。本练习将指导你计算一个典型的基于残差的误差指示子，让你清晰地看到单元内部残差和跨边界通量跳跃是如何共同构成局部误差估计的。",
            "id": "3514528",
            "problem": "考虑一个稳态标量扩散模型，该模型代表了多物理场耦合模拟中的一个单场子问题，其强形式为 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，定义在一个有界多边形域上。在二维网格上，使用协调有限元法(FEM)对其进行近似，得到近似解 $u_h \\in V_h$。在用于自适应网格加密的基于残差的后验误差估计中，单元指标由单元内部残差及其边上的通量跳跃残差构成。设单元 $K$ 是形状正则的，其直径为 $h_K$，边长为 $\\{h_{e}\\}_{e \\subset \\partial K}$。设单元内部残差的幅值为 $r_K$，各边上通量跳跃的幅值为 $\\{j_e\\}_{e \\subset \\partial K}$。网格质量度量 $h_K$ 和边长 $\\{h_e\\}$ 通过形状正则网格上的标准逆不等式和迹不等式，进入到指标的缩放因子中。\n\n假设单个三角形单元 $K$ 具有以下数据：直径为 $h_K = 0.1$，单元内部残差幅值为 $r_K = 5$，其三条边的长度分别为 $(0.1, 0.1, 0.141)$，对应边上的通量跳跃幅值分别为 $(3, 1, 2)$。使用由弱形式和分部积分残差表示所隐含的、基于残差的正则缩放方法，计算单元 $K$ 的单元指标 $\\eta_K$。将最终答案表示为单个简化的精确表达式，无需四舍五入。",
            "solution": "问题陈述经评估有效。其科学基础扎根于已建立的有限元法(FEM)后验误差估计理论，问题是适定的，给出了完整且一致的数据，并以客观、正式的语言表述。不存在违反基本原则、矛盾或含糊不清之处。因此，我们可以着手求解。\n\n该问题要求计算二维域中单个三角形单元 $K$ 的局部、基于残差的后验误差指标，记为 $\\eta_K$。其背后的物理学由稳态标量扩散方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 描述，其中 $u$ 是标量场，$\\kappa$ 是扩散系数， $f$ 是源项。通过有限元法获得的近似解记为 $u_h$。\n\n误差指标 $\\eta_K$ 的“正则残差缩放”源自残差方程的弱形式以及在形状正则网格上应用标准迹不等式和逆不等式。指标的平方 $\\eta_K^2$ 由两部分主要贡献构成：一部分来自单元内部的残差，另一部分来自穿过单元各边的通量跳跃。其一般形式为：\n$$\n\\eta_K^2 = C_{int}^2 h_K^2 \\|R_K\\|_{L_2(K)}^2 + \\sum_{e \\in \\partial K} C_{edge}^2 h_e \\|J_e\\|_{L_2(e)}^2\n$$\n此处，$h_K$ 是单元 $K$ 的直径，$\\{h_e\\}$ 是其各边的长度。项 $R_K = f + \\nabla \\cdot (\\kappa \\nabla u_h)$ 是内部残差，$\\|R_K\\|_{L_2(K)}$ 是其在单元 $K$ 上的 $L_2$ 范数。项 $J_e = [\\![\\kappa \\nabla u_h \\cdot \\mathbf{n}]\\!]$ 代表通量法向分量穿过边 $e$ 的跳跃，$\\|J_e\\|_{L_2(e)}$ 是其在边 $e$ 上的 $L_2$ 范数。常数 $C_{int}$ 和 $C_{edge}$ 依赖于插值理论和单元形状正则性，但在指标的标准定义中通常取为 $1$，这由术语“正则”所隐含。\n\n问题提供了以下数据，我们将其映射到公式中的各项：\n- 单元直径：$h_K = 0.1$。\n- 单元内部残差幅值（$L_2$范数）：$r_K = \\|R_K\\|_{L_2(K)} = 5$。\n- 该单元是三角形，因此有三条边，此处用 $i \\in \\{1, 2, 3\\}$ 索引。\n- 边长：$h_{e_1} = 0.1$，$h_{e_2} = 0.1$，以及 $h_{e_3} = 0.141$。\n- 对应边上的通量跳跃幅值（$L_2$范数）：$j_{e_1} = \\|J_{e_1}\\|_{L_2(e_1)} = 3$，$j_{e_2} = \\|J_{e_2}\\|_{L_2(e_2)} = 1$，以及 $j_{e_3} = \\|J_{e_3}\\|_{L_2(e_3)} = 2$。\n\n将常数 $C_{int}$ 和 $C_{edge}$ 设为 $1$，指标平方的公式变为：\n$$\n\\eta_K^2 = h_K^2 r_K^2 + h_{e_1} j_{e_1}^2 + h_{e_2} j_{e_2}^2 + h_{e_3} j_{e_3}^2\n$$\n现在，我们将给定的数值代入此表达式。为按要求保持精确性，我们将使用分数进行计算。\n$h_K = \\frac{1}{10}$，$r_K = 5$\n$h_{e_1} = \\frac{1}{10}$，$j_{e_1} = 3$\n$h_{e_2} = \\frac{1}{10}$，$j_{e_2} = 1$\n$h_{e_3} = \\frac{141}{1000}$，$j_{e_3} = 2$\n\n来自内部残差的贡献是：\n$$\nh_K^2 r_K^2 = \\left(\\frac{1}{10}\\right)^2 (5)^2 = \\frac{1}{100} \\times 25 = \\frac{25}{100} = \\frac{1}{4}\n$$\n来自三条边上通量跳跃的贡献是：\n$$\nh_{e_1} j_{e_1}^2 = \\frac{1}{10} \\times (3)^2 = \\frac{9}{10}\n$$\n$$\nh_{e_2} j_{e_2}^2 = \\frac{1}{10} \\times (1)^2 = \\frac{1}{10}\n$$\n$$\nh_{e_3} j_{e_3}^2 = \\frac{141}{1000} \\times (2)^2 = \\frac{141}{1000} \\times 4 = \\frac{564}{1000} = \\frac{141}{250}\n$$\n现在，我们将这些分量相加来求 $\\eta_K^2$：\n$$\n\\eta_K^2 = \\frac{1}{4} + \\frac{9}{10} + \\frac{1}{10} + \\frac{141}{250}\n$$\n首先合并具有相同分母的项：\n$$\n\\eta_K^2 = \\frac{1}{4} + \\left(\\frac{9}{10} + \\frac{1}{10}\\right) + \\frac{141}{250} = \\frac{1}{4} + 1 + \\frac{141}{250} = \\frac{5}{4} + \\frac{141}{250}\n$$\n为了对这些分数求和，我们找到一个公分母，即 $500$：\n$$\n\\eta_K^2 = \\frac{5 \\times 125}{4 \\times 125} + \\frac{141 \\times 2}{250 \\times 2} = \\frac{625}{500} + \\frac{282}{500} = \\frac{625 + 282}{500} = \\frac{907}{500}\n$$\n问题要求的是单元指标 $\\eta_K$，即该值的平方根：\n$$\n\\eta_K = \\sqrt{\\frac{907}{500}}\n$$\n为了提供一个简化的精确表达式，我们可以将分母有理化：\n$$\n\\eta_K = \\frac{\\sqrt{907}}{\\sqrt{500}} = \\frac{\\sqrt{907}}{\\sqrt{100 \\times 5}} = \\frac{\\sqrt{907}}{10\\sqrt{5}}\n$$\n将分子和分母同乘以 $\\sqrt{5}$：\n$$\n\\eta_K = \\frac{\\sqrt{907} \\times \\sqrt{5}}{10\\sqrt{5} \\times \\sqrt{5}} = \\frac{\\sqrt{907 \\times 5}}{10 \\times 5} = \\frac{\\sqrt{4535}}{50}\n$$\n数字 $907$ 是一个质数，所以根式 $\\sqrt{4535}$ 无法进一步简化。这就是单元指标的最终精确表达式。",
            "answer": "$$\\boxed{\\frac{\\sqrt{4535}}{50}}$$"
        },
        {
            "introduction": "当我们根据误差指示子对特定单元进行加密时，网格中可能会出现非协调的界面，即一个粗单元的边与多个细单元的边相邻，从而产生“悬挂节点”（hanging node）。为了保证有限元解的全局连续性（$C^0$连续性）和数学上的正确性，我们必须对这些悬挂节点处的自由度施加约束。本练习将引导你从形函数的基本定义出发，推导双线性四边形单元上悬挂节点的线性约束关系，这是实现非协调自适应网格加密的关键一步。",
            "id": "3514507",
            "problem": "考虑一个多物理场耦合仿真，该仿真通过有限元法 (FEM) 在一个二维网格上进行离散化，网格由等参双线性四边形单元（双线性 $Q_1$ 单元）组成。在耦合界面附近，一个网格质量度量指标显示单元形状质量和各向异性正在恶化，因此应用了加密比为 $2{:}1$ 的自适应网格加密 (AMR)。在粗细网格界面上，这种 AMR 会在粗单元边的中点产生一个悬挂节点。假设一个标量场 $u$（例如，流固耦合子问题中的压力）在每个单元上由分段双线性形函数表示，并且必须在整个界面上强制其在索伯列夫空间 $H^1$（一阶平方可积导数）中的全局连续性。\n\n从参考正方形 $\\left[-1,1\\right] \\times \\left[-1,1\\right]$ 上的等参双线性四边形形函数的核心定义出发，并根据 $u$ 的迹在粗细网格界面上必须连续的要求，推导出一个线性约束，该约束将悬挂节点处的自由度与其两个父粗糙边顶点值相关联。设粗糙边上的两个父顶点值分别为 $u_{A}$ 和 $u_{B}$，悬挂节点值为 $u_{h}$。该悬挂节点位于两个父顶点之间的笔直粗糙边的中点。\n\n将您的最终答案表示为 $u_{h}$ 关于 $u_{A}$ 和 $u_{B}$ 的单个闭式解析表达式。不需要数值舍入。不适用物理单位。",
            "solution": "该问题定义明确，并在科学上基于有限元法 (FEM) 的理论。它要求推导在自适应网格加密 (AMR) 中对等参双线性四边形单元产生的悬挂节点的标准约束。该推导基于有限元法的基本原理，特别是跨单元边界的函数连续性要求。\n\n此推导的核心原理是在粗单元和加密单元之间的界面上强制标量场 $u$ 的连续性。问题指明解空间为索伯列夫空间 $H^1$，这意味着，除其他性质外，函数 $u$ 必须跨单元边界连续（它必须具有 $C^0$ 连续性）。在共享边界上的任何一点，无论使用哪个单元进行计算，场的值都必须相同。\n\n让我们考虑粗糙的双线性四边形单元。该单元内的场 $u$ 是通过使用双线性形函数从其四个顶点的值插值得到的。在局部参数坐标系 $(\\xi, \\eta)$ 中，其中在参考正方形上 $\\xi \\in [-1, 1]$ 且 $\\eta \\in [-1, 1]$，场由下式给出：\n$$u(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i$$\n其中 $u_i$ 是单元四个顶点的节点值，$N_i(\\xi, \\eta)$ 是双线性形函数：\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\n假设所讨论的粗糙边与参考正方形上 $\\eta = -1$ 的边对齐。该边连接对应于局部节点编号 $1$（在 $\\xi = -1, \\eta = -1$ 处）和 $2$（在 $\\xi = 1, \\eta = -1$ 处）的顶点。设这两个父顶点的节点值分别为 $u_A$ 和 $u_B$。因此，我们将 $u_A$ 与局部节点 $1$ ($u_1$) 相关联，将 $u_B$ 与局部节点 $2$ ($u_2$) 相关联。\n\n为了找到场 $u$ 沿该边的变化，我们在 $\\eta = -1$ 处评估形函数：\n$$N_1(\\xi, -1) = \\frac{1}{4}(1-\\xi)(1 - (-1)) = \\frac{1}{2}(1-\\xi)$$\n$$N_2(\\xi, -1) = \\frac{1}{4}(1+\\xi)(1 - (-1)) = \\frac{1}{2}(1+\\xi)$$\n$$N_3(\\xi, -1) = \\frac{1}{4}(1+\\xi)(1 - 1) = 0$$\n$$N_4(\\xi, -1) = \\frac{1}{4}(1-\\xi)(1 - 1) = 0$$\n\n正如预期的那样，沿该边的场仅取决于该边两端的节点值。沿该边的 $u$ 的插值成为参数 $\\xi$ 的一维线性插值：\n$$u(\\xi, -1) = N_1(\\xi, -1)u_{A} + N_2(\\xi, -1)u_{B} = \\frac{1}{2}(1-\\xi)u_{A} + \\frac{1}{2}(1+\\xi)u_{B}$$\n此方程表明，插值场 $u$ 沿双线性单元的边呈线性变化。\n\n问题指出单元是等参的，意味着几何坐标使用相同的形函数进行插值。它还指定了一条笔直的粗糙边。一个具有相关自由度 $u_h$ 的悬挂节点位于此物理边的中点。对于由两个顶点定义的直边，物理空间中的几何中点对应于参数空间中的中点。参数边从 $\\xi = -1$ 延伸到 $\\xi = 1$，因此其中点在 $\\xi = 0$ 处。\n\n为强制连续性，悬挂节点处的自由度值 $u_h$ 必须等于在该物理位置上从粗单元的自由度插值得到的场值。因此，我们在悬挂节点的参数坐标 $\\xi = 0$ 处评估沿粗糙边的 $u$ 的表达式：\n$$u_h = u(0, -1) = \\frac{1}{2}(1-0)u_{A} + \\frac{1}{2}(1+0)u_{B}$$\n\n这简化为所需的线性约束：\n$$u_h = \\frac{1}{2}u_{A} + \\frac{1}{2}u_{B}$$\n该约束确保了分段场表示在粗细网格界面上保持连续。悬挂节点处的值不是一个独立的自由度，而是由其在粗糙边上的两个父顶点值的平均值决定的。",
            "answer": "$$\\boxed{\\frac{1}{2}(u_{A} + u_{B})}$$"
        }
    ]
}