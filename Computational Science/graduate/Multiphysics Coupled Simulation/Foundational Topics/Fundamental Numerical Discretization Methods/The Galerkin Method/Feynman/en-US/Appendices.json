{
    "hands_on_practices": [
        {
            "introduction": "The power of the Galerkin method lies in its ability to systematically transform complex differential equations into manageable systems of algebraic equations. This first exercise walks you through the fundamental mechanics of this process for a one-dimensional diffusion-reaction problem, a model that appears in countless physical scenarios from heat transfer to chemical transport. By deriving the element stiffness and mass matrices and assembling them into a global system, you will build the foundational skills needed for any finite element analysis .",
            "id": "3528432",
            "problem": "Consider the scalar diffusion-reaction Partial Differential Equation (PDE) on the interval $(0,1)$,\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u = f,$$\nwhere $k>0$ and $c\\ge 0$ are spatially constant coefficients. Use the Galerkin method with the Finite Element Method (FEM), employing continuous piecewise linear shape functions ($P_1$ elements) on a mesh of $(0,1)$.\n\nStarting from the weak form obtained by the principle of weighted residuals and integration by parts, derive the element-level bilinear forms on an arbitrary element of length $h_e$ and compute the element stiffness matrix and the element reaction-mass matrix for the operator $-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u$ with constant $k$ and $c$. Then, consider a uniform mesh partition of $(0,1)$ into three equal elements with nodal points $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, $x_3=1$, and impose homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nAssemble the global Galerkin system matrix for the two interior degrees of freedom corresponding to nodes $x_1$ and $x_2$, expressing your final assembled matrix entirely in terms of $k$ and $c$. Provide the final assembled global matrix as your answer. No rounding is required. Do not include any physical units in your final expression.",
            "solution": "The problem is found to be valid. It is a well-posed boundary value problem from mathematical physics, suitable for solution by the specified Finite Element Method. All conditions and data required for a unique derivation are provided.\n\nThe governing Partial Differential Equation (PDE) is the steady-state diffusion-reaction equation on the domain $\\Omega = (0,1)$:\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u = f(x)$$\nwhere the coefficients $k$ and $c$ are positive constants.\n\nThe first step in the Galerkin method is to derive the weak formulation. We multiply the PDE by a test function $v(x)$ from a suitable function space and integrate over the domain $\\Omega$:\n$$\\int_{0}^{1} \\left(-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u\\right)v \\,dx = \\int_{0}^{1} f v \\,dx$$\nApplying integration by parts to the second-order term yields:\n$$\\int_{0}^{1} \\left(k\\,\\frac{du}{dx}\\frac{dv}{dx}\\right) dx - \\left[k\\,\\frac{du}{dx}v\\right]_{0}^{1} + \\int_{0}^{1} (c\\,u\\,v) \\,dx = \\int_{0}^{1} f v \\,dx$$\nThe test functions $v$ are chosen from the space of trial solutions, which must satisfy the homogeneous form of the Dirichlet boundary conditions. The problem specifies $u(0)=0$ and $u(1)=0$. Thus, we require $v(0)=0$ and $v(1)=0$. This causes the boundary term $\\left[k\\,\\frac{du}{dx}v\\right]_{0}^{1}$ to vanish.\n\nThe resulting weak form is: Find $u$ such that for all valid test functions $v$,\n$$\\int_{0}^{1} \\left(k\\,\\frac{du}{dx}\\frac{dv}{dx} + c\\,u\\,v\\right) dx = \\int_{0}^{1} f v \\,dx$$\nThis can be written in abstract form as $a(u,v) = L(v)$, where the bilinear form $a(u,v)$ represents the left-hand side and the linear functional $L(v)$ represents the right-hand side.\n\nNext, we discretize the domain and the solution. The solution $u(x)$ is approximated by a function $u_h(x)$ which is a linear combination of piecewise linear basis functions (shape functions) $N_j(x)$:\n$u(x) \\approx u_h(x) = \\sum_{j} U_j N_j(x)$\nHere, $U_j$ are the nodal values of the approximate solution. In the Galerkin method, the test functions $v$ are chosen from the same set of basis functions, i.e., $v(x) = N_i(x)$ for each node $i$. Substituting these into the weak form gives the Galerkin system of linear equations $A \\mathbf{U} = \\mathbf{F}$, where the entries of the system matrix $A$ are given by:\n$$A_{ij} = a(N_j, N_i) = \\int_{0}^{1} \\left(k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx}\\right) dx + \\int_{0}^{1} \\left(c\\,N_j N_i\\right) dx$$\nThe matrix $A$ can be expressed as the sum of a stiffness matrix $K$ and a reaction-mass matrix $C$:\n$$A_{ij} = K_{ij} + C_{ij}$$\nwhere $K_{ij} = \\int_{0}^{1} k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx} dx$ and $C_{ij} = \\int_{0}^{1} c\\,N_j N_i dx$.\n\nWe now derive the element-level matrices on a generic element $\\Omega_e = [x_a, x_b]$ of length $h_e = x_b - x_a$. We use a local coordinate system $\\xi \\in [0, 1]$ where $x(\\xi) = x_a + \\xi h_e$. The chain rule for differentiation gives $\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{h_e}\\frac{d}{d\\xi}$. The piecewise linear shape functions in local coordinates are $N_1(\\xi) = 1-\\xi$ and $N_2(\\xi) = \\xi$. Their derivatives are $\\frac{dN_1}{d\\xi} = -1$ and $\\frac{dN_2}{d\\xi} = 1$.\n\nThe element stiffness matrix $K^e$ has components:\n$$K^e_{ij} = \\int_{\\Omega_e} k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx}\\,dx = k \\int_{0}^{1} \\left(\\frac{1}{h_e}\\frac{dN_j}{d\\xi}\\right)\\left(\\frac{1}{h_e}\\frac{dN_i}{d\\xi}\\right) h_e\\,d\\xi = \\frac{k}{h_e} \\int_{0}^{1} \\frac{dN_j}{d\\xi}\\frac{dN_i}{d\\xi}\\,d\\xi$$\nCalculating the four components:\n$K^e_{11} = \\frac{k}{h_e}\\int_0^1 (-1)(-1) d\\xi = \\frac{k}{h_e}$\n$K^e_{12} = \\frac{k}{h_e}\\int_0^1 (1)(-1) d\\xi = -\\frac{k}{h_e}$\n$K^e_{21} = \\frac{k}{h_e}\\int_0^1 (-1)(1) d\\xi = -\\frac{k}{h_e}$\n$K^e_{22} = \\frac{k}{h_e}\\int_0^1 (1)(1) d\\xi = \\frac{k}{h_e}$\nSo, the element stiffness matrix is:\n$$K^e = \\frac{k}{h_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\nThe element reaction-mass matrix $C^e$ has components:\n$$C^e_{ij} = \\int_{\\Omega_e} c\\,N_j N_i\\,dx = c\\int_{0}^{1} N_j(\\xi)N_i(\\xi) h_e\\,d\\xi = c h_e \\int_{0}^{1} N_j(\\xi)N_i(\\xi) \\,d\\xi$$\nCalculating the four components:\n$C^e_{11} = c h_e \\int_0^1 (1-\\xi)^2 d\\xi = c h_e \\left[-\\frac{(1-\\xi)^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{3}$\n$C^e_{12} = c h_e \\int_0^1 (1-\\xi)\\xi d\\xi = c h_e \\left[\\frac{\\xi^2}{2}-\\frac{\\xi^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{6}$\n$C^e_{21} = C^e_{12} = \\frac{c h_e}{6}$\n$C^e_{22} = c h_e \\int_0^1 \\xi^2 d\\xi = c h_e \\left[\\frac{\\xi^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{3}$\nSo, the element reaction-mass matrix is:\n$$C^e = \\frac{c h_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n\nThe total element system matrix is $A^e = K^e + C^e$.\n\nFor the specific problem, the domain $(0,1)$ is divided into three equal elements. The nodes are at $x_0=0$, $x_1=1/3$, $x_2=2/3$, and $x_3=1$. The length of each element is $h_e = 1/3$.\nSubstituting $h_e=1/3$ into the element matrix expressions:\n$K^e = \\frac{k}{1/3} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 3k \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$\n$C^e = \\frac{c(1/3)}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\frac{c}{18} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$\nThe element system matrix $A^e$ is:\n$$A^e = \\begin{pmatrix} 3k + \\frac{2c}{18} & -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18} & 3k + \\frac{2c}{18} \\end{pmatrix} = \\begin{pmatrix} 3k + \\frac{c}{9} & -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18} & 3k + \\frac{c}{9} \\end{pmatrix}$$\n\nThe global system matrix is assembled by summing the contributions from the three elements. The degrees of freedom are $U_0, U_1, U_2, U_3$.\nElement $1$ (nodes $0, 1$) contributes $A^e$ to the submatrix for rows/columns $0, 1$.\nElement $2$ (nodes $1, 2$) contributes $A^e$ to the submatrix for rows/columns $1, 2$.\nElement $3$ (nodes $2, 3$) contributes $A^e$ to the submatrix for rows/columns $2, 3$.\n\nThe global matrix $A_{global}$ before applying boundary conditions is a $4 \\times 4$ matrix:\n$$A_{global} = \\begin{pmatrix} A^e_{11} & A^e_{12} & 0 & 0 \\\\ A^e_{21} & A^e_{22}+A^e_{11} & A^e_{12} & 0 \\\\ 0 & A^e_{21} & A^e_{22}+A^e_{11} & A^e_{12} \\\\ 0 & 0 & A^e_{21} & A^e_{22} \\end{pmatrix}$$\nSubstituting the values:\n$A^e_{11} = A^e_{22} = 3k + \\frac{c}{9}$\n$A^e_{12} = A^e_{21} = -3k + \\frac{c}{18}$\n$A^e_{22} + A^e_{11} = 2(3k + \\frac{c}{9}) = 6k + \\frac{2c}{9}$\n\nThe problem imposes homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. This fixes the nodal values $U_0=0$ and $U_3=0$. We are interested in the system for the unknown interior degrees of freedom, $U_1$ and $U_2$. This system is obtained by taking the $2 \\times 2$ submatrix of $A_{global}$ corresponding to rows $1$ and $2$ and columns $1$ and $2$:\n$$A_{interior} = \\begin{pmatrix} A^e_{22}+A^e_{11} & A^e_{12} \\\\ A^e_{21} & A^e_{22}+A^e_{11} \\end{pmatrix}$$\nSubstituting the expressions for the matrix entries:\n$$A_{interior} = \\begin{pmatrix} 6k + \\frac{2c}{9} & -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18} & 6k + \\frac{2c}{9} \\end{pmatrix}$$\nThis is the final assembled global Galerkin system matrix for the two interior degrees of freedom.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6k + \\frac{2c}{9} & -3k + \\frac{c}{18} \\\\\n-3k + \\frac{c}{18} & 6k + \\frac{2c}{9}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond solving for steady-state responses to external forces, the Galerkin framework is essential for analyzing the intrinsic properties of a system, such as its natural frequencies and mode shapes. This practice extends the matrix assembly skills from the previous exercise to a Helmholtz-type eigenproblem, which is central to acoustics, quantum mechanics, and structural dynamics. You will formulate the generalized matrix eigenvalue problem and compute the discrete eigenvalues, providing a concrete look at how the finite element method approximates the continuous spectrum of an operator .",
            "id": "3528326",
            "problem": "In multiphysics coupled simulation, modal analyses and operator splittings often require solving scalar elliptic eigenproblems that arise from coupling operators. Consider the canonical one-dimensional Helmholtz-type eigenproblem obtained from the Laplacian on the unit interval: find nontrivial $u$ and $\\lambda$ such that $-u'' = \\lambda u$ on $(0,1)$ with homogeneous Dirichlet boundary conditions $u(0)=u(1)=0$. Starting from the weak form derived by integrating by parts and enforcing the boundary conditions in the Sobolev space $H_0^1(0,1)$, perform a Bubnov–Galerkin discretization using the Finite Element Method (FEM) with the piecewise linear polynomial space ($P_1$) on a uniform mesh of $3$ elements on $(0,1)$. Assemble the consistent stiffness matrix $K$ and mass matrix $M$, formulate the resulting generalized matrix eigenvalue problem $K\\mathbf{u}=\\lambda M\\mathbf{u}$, and compute its smallest eigenvalue $\\lambda_h$. The exact first eigenvalue of the continuous problem is $\\lambda_1=\\pi^2$. Report the dimensionless comparison ratio $r=\\lambda_h/\\lambda_1$ rounded to $4$ significant figures. Express your answer as a pure number (no units).",
            "solution": "The user has provided a problem that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Differential Equation**: $-u'' = \\lambda u$\n- **Domain**: $(0,1)$\n- **Boundary Conditions**: $u(0)=0$, $u(1)=0$ (homogeneous Dirichlet)\n- **Function Space**: Sobolev space $H_0^1(0,1)$\n- **Discretization Method**: Bubnov-Galerkin Finite Element Method (FEM)\n- **Element Type**: Piecewise linear polynomials ($P_1$)\n- **Mesh**: Uniform mesh of $3$ elements on $(0,1)$\n- **Outputs Required**:\n    1. Consistent stiffness matrix $K$ and mass matrix $M$.\n    2. Formulation of the generalized matrix eigenvalue problem $K\\mathbf{u}=\\lambda M\\mathbf{u}$.\n    3. The smallest eigenvalue $\\lambda_h$ of the matrix problem.\n- **Comparison**: The dimensionless ratio $r=\\lambda_h/\\lambda_1$, where $\\lambda_1=\\pi^2$ is the exact first eigenvalue of the continuous problem. The result must be rounded to $4$ significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is a canonical example of applying the Finite Element Method to a Sturm-Liouville eigenvalue problem (the one-dimensional Helmholtz equation). This is a fundamental topic in numerical analysis and computational physics. The problem is scientifically and mathematically sound.\n- **Well-Posed**: The problem is well-posed. The continuous problem has a known, unique, and stable solution set of eigenvalues and eigenfunctions. The discretized problem is also well-posed, leading to a symmetric definite generalized matrix eigenvalue problem which has real, positive eigenvalues.\n- **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n- **Completeness**: All necessary information is provided. The PDE, domain, boundary conditions, discretization method, element type, and mesh specification are all explicitly stated.\n- **Other Criteria**: The problem is not trivial, contradictory, or unverifiable. It is a standard, solvable problem in applied mathematics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\nThe problem is to find nontrivial solutions $(u, \\lambda)$ to the eigenproblem $-u'' = \\lambda u$ on the interval $(0,1)$ with boundary conditions $u(0)=u(1)=0$.\n\nFirst, we derive the weak form. We multiply the differential equation by a test function $v$ from the solution space $H_0^1(0,1)$ (which incorporates the boundary conditions $v(0)=v(1)=0$) and integrate over the domain $\\Omega=(0,1)$:\n$$-\\int_0^1 u''(x) v(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx$$\nWe apply integration by parts to the left-hand side:\n$$-\\left[ u'(x)v(x) \\right]_0^1 + \\int_0^1 u'(x) v'(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx$$\nSince the test function $v \\in H_0^1(0,1)$, we have $v(0)=0$ and $v(1)=0$. Thus, the boundary term $[u'v]_0^1$ vanishes. The weak form of the problem is: Find $u \\in H_0^1(0,1)$ and $\\lambda \\in \\mathbb{R}$ such that\n$$\\int_0^1 u'(x) v'(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx \\quad \\forall v \\in H_0^1(0,1)$$\nThis can be written in terms of bilinear forms $a(u,v) = \\int_0^1 u'(x) v'(x) \\, dx$ and $b(u,v) = \\int_0^1 u(x) v(x) \\, dx$, as $a(u,v)=\\lambda b(u,v)$.\n\nNext, we perform the Bubnov-Galerkin discretization. The domain $(0,1)$ is divided into $3$ uniform elements, so the element size is $h=1/3$. The nodes are located at $x_0=0$, $x_1=1/3$, $x_2=2/3$, and $x_3=1$. The solution space is approximated by the finite-dimensional space $V_h \\subset H_0^1(0,1)$ of piecewise linear ($P_1$) polynomials. Due to the homogeneous Dirichlet boundary conditions, the degrees of freedom at the boundary nodes $x_0$ and $x_3$ are zero. We only have two active interior nodes, $x_1$ and $x_2$.\n\nThe basis for $V_h$ consists of two linear \"hat\" functions, $\\phi_1(x)$ and $\\phi_2(x)$, associated with the interior nodes $x_1$ and $x_2$ respectively. The approximate solution $u_h(x)$ is a linear combination of these basis functions:\n$$u_h(x) = U_1 \\phi_1(x) + U_2 \\phi_2(x) = \\sum_{j=1}^{2} U_j \\phi_j(x)$$\nwhere $U_1$ and $U_2$ are the unknown nodal values of the solution at $x_1$ and $x_2$.\n\nIn the Bubnov-Galerkin method, the test functions are chosen from the same space as the trial functions, i.e., $v_h(x) = \\phi_i(x)$ for $i=1,2$. Substituting $u_h$ and $v_h$ into the weak form gives a system of algebraic equations:\n$$\\sum_{j=1}^{2} U_j \\left( \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\, dx \\right) = \\lambda_h \\sum_{j=1}^{2} U_j \\left( \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx \\right) \\quad \\text{for } i=1,2$$\nThis is the generalized matrix eigenvalue problem $K\\mathbf{u} = \\lambda_h M\\mathbf{u}$, where $\\mathbf{u} = [U_1, U_2]^T$, and the stiffness matrix $K$ and mass matrix $M$ have entries:\n$$K_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\, dx$$\n$$M_{ij} = b(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx$$\n\nWe assemble these matrices. For a standard linear element of length $h$, the element stiffness matrix $k^e$ and mass matrix $m^e$ are:\n$$k^e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad m^e = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\nIn our case, $h=1/3$, so:\n$$k^e = \\frac{1}{1/3} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 3 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n$$m^e = \\frac{1/3}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\nWe assemble the global matrices for the two interior degrees of freedom (corresponding to nodes $x_1$ and $x_2$).\nThe stiffness matrix $K$ is assembled from the contributions of all three elements:\n$$K = 3 \\begin{pmatrix} 1+1 & -1 \\\\ -1 & 1+1 \\end{pmatrix} = 3 \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix}$$\nThe mass matrix $M$ is assembled similarly:\n$$M = \\frac{1}{18} \\begin{pmatrix} 2+2 & 1 \\\\ 1 & 2+2 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix}$$\nThe resulting generalized matrix eigenvalue problem is:\n$$\\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\lambda_h \\frac{1}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix}$$\nTo find the eigenvalues $\\lambda_h$, we solve the characteristic equation $\\det(K - \\lambda_h M) = 0$.\n$$\\det\\left( \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix} - \\frac{\\lambda_h}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\right) = 0$$\n$$\\det\\begin{pmatrix} 6 - \\frac{4\\lambda_h}{18} & -3 - \\frac{\\lambda_h}{18} \\\\ -3 - \\frac{\\lambda_h}{18} & 6 - \\frac{4\\lambda_h}{18} \\end{pmatrix} = 0$$\nThis gives the equation:\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right)^2 - \\left(-3 - \\frac{\\lambda_h}{18}\\right)^2 = 0$$\nThis is a difference of squares $A^2 - B^2 = (A-B)(A+B) = 0$.\nCase 1: $A-B=0$\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right) - \\left(-3 - \\frac{\\lambda_h}{18}\\right) = 0$$\n$$9 - \\frac{3\\lambda_h}{18} = 0 \\implies 9 - \\frac{\\lambda_h}{6} = 0 \\implies \\lambda_h = 54$$\nCase 2: $A+B=0$\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right) + \\left(-3 - \\frac{\\lambda_h}{18}\\right) = 0$$\n$$3 - \\frac{5\\lambda_h}{18} = 0 \\implies 3 = \\frac{5\\lambda_h}{18} \\implies \\lambda_h = \\frac{3 \\times 18}{5} = \\frac{54}{5} = 10.8$$\nThe two eigenvalues are $\\lambda_{h,1}=10.8$ and $\\lambda_{h,2}=54$. The smallest eigenvalue is $\\lambda_h = 10.8$.\n\nFinally, we compute the required dimensionless comparison ratio $r = \\lambda_h / \\lambda_1$. The exact first eigenvalue of the continuous problem is $\\lambda_1 = \\pi^2$.\n$$r = \\frac{10.8}{\\pi^2}$$\nUsing the value $\\pi^2 \\approx 9.8696044...$, we get:\n$$r \\approx \\frac{10.8}{9.8696044} \\approx 1.0942699$$\nRounding to $4$ significant figures, we get $r=1.094$.",
            "answer": "$$\\boxed{1.094}$$"
        },
        {
            "introduction": "Our theoretical derivations often rely on exact integration, but practical implementations almost always use numerical quadrature to evaluate the integrals in the weak form. This raises a critical question: what happens if the quadrature rule is not accurate enough? This exercise uses a simple one-element model to demonstrate the concept of a \"variational crime,\" where under-integration of the mass matrix compromises the integrity of the Galerkin method and leads to significant errors. This practice highlights the crucial link between approximation theory and the practical details of numerical computation .",
            "id": "3528433",
            "problem": "Consider the one-dimensional Helmholtz eigenproblem that arises as the acoustic subproblem in an acousto-elastic coupling: find $u$ and $\\lambda$ such that $-u''(x) = \\lambda u(x)$ for $x \\in (0,\\pi)$ with homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(\\pi) = 0$. The weak form is: find $u \\in H_{0}^{1}(0,\\pi)$ and $\\lambda \\in \\mathbb{R}$ such that $\\int_{0}^{\\pi} u'(x) v'(x) \\, dx = \\lambda \\int_{0}^{\\pi} u(x) v(x) \\, dx$ for all $v \\in H_{0}^{1}(0,\\pi)$. Using the Galerkin method, approximate $u$ in the one-element quadratic Lagrange subspace on $(0,\\pi)$ with nodes at $x=0$, $x=\\pi/2$, and $x=\\pi$, where the endpoint degrees of freedom are constrained to zero by the boundary conditions. Let the sole basis function be the mapped midpoint quadratic shape function from the reference element $\\xi \\in [-1,1]$ given by $\\hat{\\varphi}(\\xi) = 1 - \\xi^{2}$, with the affine mapping $x = \\frac{\\pi}{2}(\\xi+1)$. \n\n1. Derive, from first principles, the exact element stiffness $K = \\int_{0}^{\\pi} \\left(\\frac{d\\varphi}{dx}\\right)^{2} \\, dx$ and the exact element mass $M = \\int_{0}^{\\pi} \\varphi^{2} \\, dx$, where $\\varphi(x) = \\hat{\\varphi}(\\xi(x))$. \n\n2. Explain how computing $M$ by a one-point Gauss–Legendre quadrature rule on the reference element (with node $\\xi=0$ and weight $2$) while computing $K$ exactly constitutes a variational crime in the Galerkin method, and derive the under-integrated mass $M_{\\text{under}}$.\n\n3. The generalized finite element (Finite Element Method (FEM)) eigenproblem in this one-degree-of-freedom subspace reduces to the scalar equation $K = \\lambda M$ if $M$ is exact, and $K = \\lambda M_{\\text{under}}$ if the mass is under-integrated. Compute the corresponding discrete eigenvalues $\\lambda_{\\text{FE}}^{\\text{exact}}$ and $\\lambda_{\\text{FE}}^{\\text{under}}$.\n\n4. The exact first continuous eigenvalue for the Helmholtz problem on $(0,\\pi)$ is $\\lambda_{1} = 1$. Quantify the impact of under-integration by computing the relative error $\\delta = \\frac{|\\lambda_{\\text{FE}}^{\\text{under}} - \\lambda_{1}|}{\\lambda_{1}}$. Express the final quantity as a single closed-form analytic expression. The final quantity is dimensionless; do not attach units and do not round.",
            "solution": "The problem requires a multistep analysis of a one-dimensional finite element approximation for a Helmholtz eigenproblem. The validation of the problem statement has confirmed that it is well-posed, scientifically sound, and contains all necessary information. We proceed with the solution.\n\nThe core of the problem involves transforming integrals from the physical domain $x \\in [0, \\pi]$ to a reference element $\\xi \\in [-1, 1]$. The given affine mapping is $x(\\xi) = \\frac{\\pi}{2}(\\xi+1)$. The Jacobian of this transformation is $J = \\frac{dx}{d\\xi} = \\frac{\\pi}{2}$. The inverse mapping for the derivative is given by the chain rule: $\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{J}\\frac{d}{d\\xi} = \\frac{2}{\\pi}\\frac{d}{d\\xi}$. The sole basis function in the physical domain, $\\varphi(x)$, corresponds to the reference quadratic shape function $\\hat{\\varphi}(\\xi) = 1 - \\xi^2$.\n\n**1. Derivation of Element Stiffness $K$ and Mass $M$**\n\nFirst, we compute the element stiffness contribution, $K$. The stiffness is defined as $K = \\int_{0}^{\\pi} \\left(\\frac{d\\varphi}{dx}\\right)^{2} \\, dx$. We must first express the derivative $\\frac{d\\varphi}{dx}$ in terms of the reference coordinate $\\xi$.\n$$\n\\frac{d\\varphi}{dx} = \\frac{1}{J} \\frac{d\\hat{\\varphi}}{d\\xi} = \\frac{2}{\\pi} \\frac{d}{d\\xi}(1 - \\xi^2) = \\frac{2}{\\pi} (-2\\xi) = -\\frac{4\\xi}{\\pi}\n$$\nNow, we transform the integral for $K$ to the reference domain, noting that the differential element transforms as $dx = J d\\xi = \\frac{\\pi}{2} d\\xi$.\n$$\nK = \\int_{-1}^{1} \\left(-\\frac{4\\xi}{\\pi}\\right)^2 J \\, d\\xi = \\int_{-1}^{1} \\frac{16\\xi^2}{\\pi^2} \\left(\\frac{\\pi}{2}\\right) \\, d\\xi = \\frac{8}{\\pi} \\int_{-1}^{1} \\xi^2 \\, d\\xi\n$$\nThe integral is straightforward to evaluate:\n$$\n\\int_{-1}^{1} \\xi^2 \\, d\\xi = \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{1^3}{3} - \\frac{(-1)^3}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\nSubstituting this result back gives the exact stiffness:\n$$\nK = \\frac{8}{\\pi} \\left(\\frac{2}{3}\\right) = \\frac{16}{3\\pi}\n$$\nNext, we compute the element mass contribution, $M$. The mass is defined as $M = \\int_{0}^{\\pi} \\varphi(x)^2 \\, dx$. We transform this integral to the reference domain as well.\n$$\nM = \\int_{-1}^{1} \\hat{\\varphi}(\\xi)^2 J \\, d\\xi = \\int_{-1}^{1} (1 - \\xi^2)^2 \\left(\\frac{\\pi}{2}\\right) \\, d\\xi = \\frac{\\pi}{2} \\int_{-1}^{1} (1 - 2\\xi^2 + \\xi^4) \\, d\\xi\n$$\nEvaluating this integral:\n$$\n\\int_{-1}^{1} (1 - 2\\xi^2 + \\xi^4) \\, d\\xi = \\left[\\xi - \\frac{2\\xi^3}{3} + \\frac{\\xi^5}{5}\\right]_{-1}^{1} = \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) - \\left(-1 + \\frac{2}{3} - \\frac{1}{5}\\right) = 2\\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right)\n$$\n$$\n= 2\\left(\\frac{15 - 10 + 3}{15}\\right) = 2\\left(\\frac{8}{15}\\right) = \\frac{16}{15}\n$$\nSubstituting this result gives the exact mass:\n$$\nM = \\frac{\\pi}{2} \\left(\\frac{16}{15}\\right) = \\frac{8\\pi}{15}\n$$\n\n**2. Variational Crime and Under-integrated Mass $M_{\\text{under}}$**\n\nA \"variational crime\" in the context of the Galerkin Finite Element Method refers to the use of numerical approximations, typically numerical quadrature, that are inconsistent with the exact satisfaction of the weak form for the functions in the chosen finite element space. The Galerkin method's theoretical power, including its best-approximation property, stems from projecting the continuous problem exactly onto a finite-dimensional subspace. This requires exact integration of the terms in the weak form.\n\nIn this problem, the stiffness term $K$ involves integrating $\\left(\\frac{d\\varphi}{dx}\\right)^2$, which is a polynomial of degree $2$ in $\\xi$. The mass term $M$ involves integrating $\\varphi(x)^2$, which is a polynomial of degree $4$ in $\\xi$. A Gauss-Legendre quadrature rule with $n$ points integrates polynomials of degree up to $2n-1$ exactly. To compute $K$ exactly requires a rule with $2n-1 \\ge 2$, so $n \\ge 2$ points. To compute $M$ exactly requires a rule with $2n-1 \\ge 4$, so $n \\ge 3$ points.\n\nThe problem describes computing $K$ exactly but computing $M$ with a one-point Gauss-Legendre rule on the reference element. This rule is only exact for polynomials of degree $2(1)-1=1$. Using it to integrate the fourth-degree polynomial in the mass integral is an example of under-integration. This discrepancy—using an exact calculation for the stiffness bilinear form and an inexact one for the mass bilinear form—breaks the consistency of the Galerkin projection and constitutes a variational crime.\n\nWe now compute the under-integrated mass, $M_{\\text{under}}$, using the specified one-point quadrature rule. The rule for an integral on $[-1, 1]$ is $\\int_{-1}^{1} f(\\xi) \\, d\\xi \\approx w_1 f(\\xi_1)$, with node $\\xi_1 = 0$ and weight $w_1 = 2$. The integrand for the mass integral is $f(\\xi) = \\hat{\\varphi}(\\xi)^2 J = (1-\\xi^2)^2 \\frac{\\pi}{2}$.\n$$\nM_{\\text{under}} \\approx w_1 f(\\xi_1) = 2 \\cdot \\left[ (1 - 0^2)^2 \\frac{\\pi}{2} \\right] = 2 \\cdot \\left(\\frac{\\pi}{2}\\right) = \\pi\n$$\n\n**3. Discrete Eigenvalues $\\lambda_{\\text{FE}}^{\\text{exact}}$ and $\\lambda_{\\text{FE}}^{\\text{under}}$**\n\nThe generalized FEM eigenproblem for the single-degree-of-freedom system reduces to the scalar equation $K = \\lambda M$. The discrete eigenvalue is therefore $\\lambda = K/M$.\n\nUsing the exactly computed $K$ and $M$:\n$$\n\\lambda_{\\text{FE}}^{\\text{exact}} = \\frac{K}{M} = \\frac{16/(3\\pi)}{8\\pi/15} = \\frac{16}{3\\pi} \\cdot \\frac{15}{8\\pi} = \\frac{2 \\cdot 5}{\\pi^2} = \\frac{10}{\\pi^2}\n$$\nUsing the exactly computed $K$ and the under-integrated mass $M_{\\text{under}}$:\n$$\n\\lambda_{\\text{FE}}^{\\text{under}} = \\frac{K}{M_{\\text{under}}} = \\frac{16/(3\\pi)}{\\pi} = \\frac{16}{3\\pi^2}\n$$\n\n**4. Impact of Under-integration**\n\nThe problem states that the exact first eigenvalue of the continuous problem is $\\lambda_1 = 1$. We are asked to quantify the impact of the variational crime by computing the relative error $\\delta = \\frac{|\\lambda_{\\text{FE}}^{\\text{under}} - \\lambda_{1}|}{\\lambda_{1}}$.\n$$\n\\delta = \\frac{\\left|\\frac{16}{3\\pi^2} - 1\\right|}{1} = \\left|\\frac{16}{3\\pi^2} - 1\\right|\n$$\nTo remove the absolute value, we note that $\\pi \\approx 3.14$, so $\\pi^2 \\approx 9.87$. Then $3\\pi^2 \\approx 29.61$. The fraction $\\frac{16}{3\\pi^2}$ is approximately $\\frac{16}{29.61}$, which is less than $1$. Therefore, the expression inside the absolute value is negative.\n$$\n\\delta = -\\left(\\frac{16}{3\\pi^2} - 1\\right) = 1 - \\frac{16}{3\\pi^2}\n$$\nExpressing this as a single fraction gives the final analytical expression:\n$$\n\\delta = \\frac{3\\pi^2 - 16}{3\\pi^2}\n$$",
            "answer": "$$\n\\boxed{1 - \\frac{16}{3\\pi^2}}\n$$"
        }
    ]
}