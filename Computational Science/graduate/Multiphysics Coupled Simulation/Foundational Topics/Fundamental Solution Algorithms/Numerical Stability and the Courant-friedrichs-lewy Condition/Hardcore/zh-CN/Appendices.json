{
    "hands_on_practices": [
        {
            "introduction": "掌握数值稳定性的第一步是分析一个简单而稳定的格式。一阶迎风格式是一个经典的例子，其离散化方式直接反映了信息流动的物理特性。本练习将指导您通过冯·诺依曼稳定性分析，从第一性原理推导出著名的 Courant-Friedrichs-Lewy (CFL) 条件，从而揭示一个基于物理直觉的格式是如何实现条件稳定性的。",
            "id": "3518897",
            "problem": "考虑一个一维无源标量 $u(x,t)$ 在分区多物理场环境中以恒定速度 $a$ 平流，其中标量 $u$ 代表通过显式、滞后耦合与第二个物理模块交换的场。输运步骤的控制偏微分方程 (PDE) 为 $u_{t} + a\\,u_{x} = 0$，定义在一个长度为 $L$ 的周期性域上，网格间距均匀，为 $\\Delta x = L/N$，其中 $N$ 是一个正整数。与第二个物理模块的耦合是代数的且时间上是滞后的，因此在显式输运更新期间，它不会改变作用于 $u$ 的空间算子。\n\n您使用空间上的一阶迎风有限差分和时间上步长为 $\\Delta t$ 的前向欧拉更新来离散化输运方程。必须根据 $a$ 的符号选择迎风格式，以确保物理迎风。假设为周期性边界条件，并用 $u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$ 表示网格值，适用于所有整数索引 $j$ 和时间层 $n$。\n\n使用 von Neumann (傅里叶) 稳定性分析，推导该格式的放大因子，并确定 $\\Delta t$ 需满足的条件，以使对于周期性网格所允许的任何傅里叶模式，放大因子的模都不超过 1。由此，提取出保证稳定性的最大允许时间步长的闭式表达式，用 $a$ 和 $\\Delta x$ 表示。报告这个最大稳定时间步长，并用秒作单位表达您的最终答案。不要引用任何已有的 Courant-Friedrichs-Lewy (CFL) 条件；相反，应从离散更新和傅里叶模式拟设直接推导。最终答案必须是单一的解析表达式。",
            "solution": "首先验证问题，以确保其科学上合理、内容完备且适定。\n\n### 步骤 1：提取已知条件\n- **控制偏微分方程 (PDE)**：$u_{t} + a\\,u_{x} = 0$，其中 $u(x,t)$ 是一个无源标量，$a$ 是恒定的平流速度。\n- **定义域**：周期性，长度为 $L$。\n- **网格**：均匀间距 $\\Delta x = L/N$，其中 $N$ 为正整数。\n- **时间离散**：前向欧拉，时间步长为 $\\Delta t$。\n- **空间离散**：一阶迎风有限差分。\n- **边界条件**：周期性。\n- **记法**：$u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$。\n- **分析方法**：von Neumann 稳定性分析。\n- **目标**：推导放大因子，并求出最大稳定时间步长 $\\Delta t_{max}$ 作为 $a$ 和 $\\Delta x$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题探讨了线性平流方程的标准数值格式（时间前向，空间迎风）的稳定性，这是计算流体动力学的基石。对于此类问题，使用 von Neumann 分析是正确且标准的方法。该设定在科学上是严谨的。\n- **适定性**：问题定义清晰，包含了所有必要组成部分：偏微分方程、离散化方法、边界条件以及待回答的问题。该格式存在一个唯一的、明确定义的稳定性判据。\n- **客观性**：问题以精确、客观、标准的数学语言陈述，没有歧义或主观看法。\n\n### 步骤 3：结论与行动\n该问题是有效的。这是一个数值分析中的经典且适定的问题。现在开始求解过程。\n\n### 稳定性条件的推导\n\n控制偏微分方程为：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n我们使用时间上的前向差分（前向欧拉）和空间上的一阶迎风差分来离散该方程。迎风格式的选择取决于平流速度 $a$ 的符号。\n\n时间导数的近似为：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\n空间导数 $\\frac{\\partial u}{\\partial x}$ 的近似基于信息“迎风”而来的方向。\n\n**情况 1：$a > 0$**\n如果速度 $a$ 为正，波从左向右传播。迎风方向在左侧，因此我们对空间导数使用后向差分：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}\n$$\n将这些近似代入 PDE $u_t = -a u_x$，得到离散更新方程：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j}^{n} - u_{j-1}^{n})\n$$\n\n**情况 2：$a  0$**\n如果速度 $a$ 为负，波从右向左传播。迎风方向在右侧，因此我们对空间导数使用前向差分：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x}\n$$\n代入 PDE 得到离散更新方程：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j+1}^{n} - u_{j}^{n})\n$$\n\n现在，我们进行 von Neumann 稳定性分析。我们考虑网格上解的单个傅里叶模式：\n$$\nu_{j}^{n} = G^{n} e^{i k x_{j}} = G^{n} e^{i k j \\Delta x}\n$$\n其中 $k$ 是波数，$i = \\sqrt{-1}$，$G$ 是每个时间步的放大因子。为使格式稳定，对于任何可能的波数，放大因子的模都不能超过 1，即 $|G| \\le 1$。\n\n让我们用这个拟设重新分析这两种情况。\n\n**对 $a > 0$ 的稳定性分析**\n我们将傅里叶模式代入 $a > 0$ 的离散方程：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k j \\Delta x} - G^{n} e^{i k (j-1) \\Delta x} \\right)\n$$\n我们定义 Courant 数 $\\sigma = \\frac{a \\Delta t}{\\Delta x}$。因为 $a > 0$，所以 $\\sigma$ 是正的。将整个方程除以 $G^n e^{i k j \\Delta x}$ 得到放大因子 $G$：\n$$\nG = 1 - \\sigma \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\n令 $\\theta = k \\Delta x$ 为无量纲波数。\n$$\nG = 1 - \\sigma (1 - (\\cos\\theta - i\\sin\\theta)) = (1 - \\sigma + \\sigma\\cos\\theta) + i\\sigma\\sin\\theta\n$$\n放大因子的模的平方为 $|G|^2$：\n$$\n|G|^2 = (1 - \\sigma + \\sigma\\cos\\theta)^2 + (\\sigma\\sin\\theta)^2\n$$\n$$\n|G|^2 = (1 - \\sigma(1 - \\cos\\theta))^2 + \\sigma^2 \\sin^2\\theta\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2\\sin^2\\theta\n$$\n使用 $\\sin^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta)$:\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2(1 - \\cos\\theta)(1 + \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta) [ (1 - \\cos\\theta) + (1 + \\cos\\theta) ]\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)(2)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + 2\\sigma^2(1 - \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta)\n$$\n为保证稳定性，我们要求 $|G|^2 \\le 1$。这意味着 $1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 1$，可简化为：\n$$\n-2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 0\n$$\n由于对所有实数 $\\theta$ 都有 $\\sigma = \\frac{a \\Delta t}{\\Delta x} > 0$ 且 $(1 - \\cos\\theta) \\ge 0$，该不等式成立的充要条件是：\n$$\n1 - \\sigma \\ge 0 \\implies \\sigma \\le 1\n$$\n所以，对于 $a > 0$，稳定性条件是 $\\frac{a \\Delta t}{\\Delta x} \\le 1$。\n\n**对 $a  0$ 的稳定性分析**\n我们将傅里叶模式代入 $a  0$ 的离散方程：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k (j+1) \\Delta x} - G^{n} e^{i k j \\Delta x} \\right)\n$$\n再次令 $\\sigma = \\frac{a \\Delta t}{\\Delta x}$。因为 $a  0$，所以 $\\sigma$ 是负的。除以 $G^n e^{i k j \\Delta x}$ 得到：\n$$\nG = 1 - \\sigma (e^{i k \\Delta x} - 1)\n$$\n我们定义一个非负的 Courant 数 $C = \\frac{|a| \\Delta t}{\\Delta x}$。那么 $\\sigma = -C$。将此代入 $G$ 的表达式中：\n$$\nG = 1 - (-C) (e^{i\\theta} - 1) = 1 + C(e^{i\\theta} - 1)\n$$\n$$\nG = 1 + C(\\cos\\theta - 1 + i\\sin\\theta) = (1 - C + C\\cos\\theta) + iC\\sin\\theta\n$$\n这个 $G$ 的表达式与为 $a > 0$ 推导出的表达式形式相同，只是用 $C$ 替换了 $\\sigma$。因此，后续对 $|G|^2$ 的推导是相同的，只需将 $\\sigma$ 替换为 $C$：\n$$\n|G|^2 = 1 - 2C(1 - C)(1 - \\cos\\theta)\n$$\n为保证稳定性，要求 $|G|^2 \\le 1$，这需要 $-2C(1 - C)(1 - \\cos\\theta) \\le 0$。\n由于 $C = \\frac{|a| \\Delta t}{\\Delta x} > 0$ 且 $(1 - \\cos\\theta) \\ge 0$，该不等式成立的充要条件是：\n$$\n1 - C \\ge 0 \\implies C \\le 1\n$$\n所以，对于 $a  0$，稳定性条件是 $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$。\n\n**结论**\n两种情况都导出了相同的稳定性要求，可以使用速度的绝对值紧凑地表示为：\n$$\n\\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\n这就是一阶迎风格式的 Courant-Friedrichs-Lewy (CFL) 条件。问题要求的是使格式稳定的最大允许时间步长 $\\Delta t_{max}$。这在条件达到极限时获得：\n$$\n\\frac{|a| \\Delta t_{max}}{\\Delta x} = 1\n$$\n求解 $\\Delta t_{max}$ 得到最终表达式。\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{|a|}\n$$\n该表达式代表了能确保网格可分辨的任何傅里叶模式都数值稳定的最大时间步长。它的物理解释是，在单个时间步内，信息传播的距离不能超过一个网格单元。",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "在理解了一个稳定格式之后，探索为何其他看似合理的格式会失效同样至关重要。本练习将研究时间前向、空间中心的 (FTCS) 格式，这通常是初学者在离散化时凭直觉想到的方法。通过傅里叶分析，我们将证明该格式对于平流问题是无条件不稳定的，这个“反面教材”突显了离散模板的选择与数值稳定性之间微妙而关键的联系。",
            "id": "3518829",
            "problem": "在一个分区多物理场求解器中，存在一个线性平流子步，该求解器在流体平流和被动标量输运之间交替计算。考虑一个具有恒定波速的单空间维度中的标量平流方程，\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\n该方程定义在周期为 $L$ 的周期性域上，其中 $a0$ 是一个常数。在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，该平流子步通过时间上的前向欧拉更新和空间上的中心差分进行近似。用 $u_{j}^{n}$ 表示在空间索引 $j$ 和时间层 $n$ 的数值解。假设解和离散算子都是周期性的且具有位移不变性。\n\n从前向欧拉法和中心差分算子的定义出发，利用与周期性域兼容的空间傅里叶模态，进行 von Neumann (傅里叶) 稳定性分析，以确定离散放大因子及其模。引入由 $C = a\\,\\Delta t / \\Delta x$ 定义的 Courant-Friedrichs-Lewy (CFL) 数 $C$，以及与空间傅里叶模态相关联的无量纲相位 $\\theta$。利用这样一个事实：对于周期性网格上的线性、常系数、位移不变格式，复指数是离散空间导数的特征函数。\n\n基于第一性原理和你推导出的放大因子的模，解释为什么这种时空离散格式在 von Neumann 意义上是无条件不稳定的。你的最终答案应该是一个关于 $\\theta$ 和 $C$ 的、表示放大因子模的单一闭式解析表达式。最终答案中不应包含任何单位。不需要进行数值舍入。",
            "solution": "首先验证问题陈述，以确保其具有科学依据、是适定的和客观的。\n\n**步骤 1：提取已知条件**\n- **控制方程：** $u_{t} + a\\,u_{x} = 0$\n- **波速：** $a  0$，常数。\n- **区域：** 周期性，周期为 $L$。\n- **离散化：**\n  - 时间：前向欧拉法。\n  - 空间：中心差分法。\n  - 网格：均匀，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。\n- **数值解记法：** $u_{j}^{n}$，表示在空间索引 $j$ 和时间层 $n$ 的解。\n- **假设：** 解和离散算子是周期性的且具有位移不变性。\n- **分析方法：** von Neumann (傅里叶) 稳定性分析。\n- **定义：**\n  - Courant-Friedrichs-Lewy (CFL) 数：$C = a\\,\\Delta t / \\Delta x$。\n  - 无量纲相位：$\\theta$，用于空间傅里叶模态。\n- **任务：** 推导离散放大因子及其模，并用此结果解释为何该格式是无条件不稳定的。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是偏微分方程数值分析中的一个经典练习。控制方程是基本的线性平流方程。该数值格式（前向时间中心空间，或 FTCS）是一种标准的、尽管有缺陷的离散格式。分析方法，即 von Neumann 稳定性分析，是处理周期性域上线性常系数问题的典型工具。所有的定义和术语（$C$, $\\theta$）都是标准的。问题是自洽的、科学上合理的和适定的。它没有违反任何无效标准。\n\n**步骤 3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n**解答推导**\n\n给定的偏微分方程 (PDE) 是一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n我们被要求使用时间上的前向差分（前向欧拉法）和空间上的中心差分来离散化此方程。在网格点 $(j, n)$ 处，时间导数的前向差分近似为：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\n空间导数的中心差分近似为：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x}\n$$\n将这些近似代入 PDE，得到有限差分方程：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left( \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} \\right) = 0\n$$\n为了找到 $u_{j}^{n+1}$ 的更新法则，我们解出此项：\n$$\nu_{j}^{n+1} = u_{j}^{n} - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\n我们引入 Courant-Friedrichs-Lewy (CFL) 数，定义为 $C = a\\,\\Delta t / \\Delta x$。将 $C$ 代入方程，得到离散格式的最终形式：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\n对于 von Neumann 稳定性分析，我们考虑将单个空间傅里叶模态作为解。在点为 $x_j = j \\Delta x$ 的网格上，一个通用的傅里叶模态具有 $e^{i k x_j} = e^{i k j \\Delta x}$ 的形式，其中 $k$ 是波数。我们定义无量纲相角 $\\theta = k \\Delta x$。在给定时间层 $n$ 的解表示为此类模态的叠加。由于格式的线性特性，我们可以分析单个模态的行为：\n$$\nu_{j}^{n} = \\hat{u}^{n}(k) e^{i j \\theta}\n$$\n其中 $\\hat{u}^{n}(k)$ 是在时间层 $n$ 时相位为 $\\theta$ 的模态的振幅。将此拟设代入离散格式，得到：\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} - \\frac{C}{2} \\left( \\hat{u}^{n} e^{i (j+1) \\theta} - \\hat{u}^{n} e^{i (j-1) \\theta} \\right)\n$$\n我们可以提出公因子 $\\hat{u}^{n} e^{i j \\theta}$：\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\n两边除以 $e^{i j \\theta}$，得到模态振幅的演化过程：\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\n放大因子 $G(\\theta)$ 定义为连续时间步上振幅的比值，即 $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$。因此：\n$$\nG(\\theta) = 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta})\n$$\n使用欧拉恒等式 $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$，我们可以简化 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = 1 - \\frac{C}{2} (2i \\sin(\\theta)) = 1 - iC\\sin(\\theta)\n$$\n这就是复放大因子。为了评估稳定性，我们必须求出它的模 $|G(\\theta)|$。对于复数 $z = x + iy$，其模为 $|z| = \\sqrt{x^2 + y^2}$。在我们的例子中，实部是 $1$，虚部是 $-C\\sin(\\theta)$。\n$$\n|G(\\theta)| = \\sqrt{1^2 + (-C\\sin(\\theta))^2}\n$$\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}\n$$\n该表达式给出了放大因子的模，它是 CFL 数 $C$ 和无量纲相位 $\\theta$ 的函数。\n\n**无条件不稳定性的解释**\n对于一个数值格式，von Neumann 稳定性判据要求对于所有可能的傅里叶模态，放大因子的模必须小于或等于 1，即对于所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|G(\\theta)| \\le 1$。如果这个条件对任何模态不成立，那么该模态的振幅将随着每个时间步呈指数增长，导致数值不稳定性，并迅速淹没真实解。\n\n让我们来考察我们推导出的模，即 $|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}$。\n根据问题陈述，波速 $a$ 是正的。网格间距 $\\Delta x$ 和时间步长 $\\Delta t$ 也是正的物理量。因此，CFL 数 $C = a \\Delta t / \\Delta x$ 是严格为正的（$C  0$）。\n项 $\\sin^2(\\theta)$ 总是非负的，即 $\\sin^2(\\theta) \\ge 0$。\n因此，乘积 $C^2 \\sin^2(\\theta)$ 也是非负的。\n\n只有在以下情况下 $C^2 \\sin^2(\\theta) = 0$：\n1. 如果 $C = 0$。这是一个平凡的情况，即 $\\Delta t = 0$，意味着模拟在时间上没有推进。\n2. 如果 $\\sin(\\theta) = 0$。这发生在当 $\\theta = n\\pi$ (n为任意整数)时。这些模态对应于网格上的常数值（$\\theta=0$）或奈奎斯特频率模态（$\\theta=\\pi$），它们分别具有无限波长或最小波长。对于这些特定的模态，有 $|G(\\theta)| = \\sqrt{1+0} = 1$，所以它们不会增长。\n\n然而，对于任何其他傅里叶模态，即 $\\sin(\\theta) \\neq 0$ 的情况，项 $C^2 \\sin^2(\\theta)$ 是严格为正的。因此，对于任何这样的模态：\n$$\n1 + C^2 \\sin^2(\\theta)  1\n$$\n取平方根，我们发现：\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}  1\n$$\n这个不等式对于 CFL 数 $C$ 的任何非零值以及任何不是 $\\pi$ 整数倍的模态 $\\theta$ 都成立。由于稳定性判据必须对所有模态都满足，而它对于几乎所有模态都失效（只要 $C  0$），而这与 $\\Delta t$ 和 $\\Delta x$ 的选择无关，因此该格式对于任何时间步长的选择都是不稳定的。这就是无条件不稳定性的定义。放大因子中的虚数项 $iC\\sin(\\theta)$ 源于中心差分算子，其作用纯粹是在每个时间步向系统中增加能量，而没有任何相应的耗散机制，从而导致解无界增长。",
            "answer": "$$\n\\boxed{\\sqrt{1 + C^2 \\sin^2(\\theta)}}\n$$"
        },
        {
            "introduction": "真实世界的多物理场问题常常涉及在迥异的时间尺度上发生的物理现象。本练习将通过局部时间步进（或子循环）技术来应对这一挑战，这是一种提高仿真效率的实用方法。我们将为一个耦合系统推导稳定性约束，展示全局时间步$\\Delta T$如何受到最严格的局部 CFL 条件的限制，并学习如何优化它以实现最高计算效率，从而将基础理论与高级仿真实践联系起来。",
            "id": "3518854",
            "problem": "一个一维耦合双曲输运问题包含两个子域，即 $x0$ 的 $\\Omega_{1}$ 和 $x0$ 的 $\\Omega_{2}$，它们在界面 $x=0$ 处耦合。每个子域都由形式为 $\\partial_{t} u + \\partial_{x} f(u) = 0$ 的线性守恒律控制，其中，在所关心的时间区间内，特征波速的大小在 $\\Omega_{i}$ 中以常数 $c_{i}$ 为界, $i \\in \\{1,2\\}$。每个 $\\Omega_{i}$ 中的空间离散是网格尺寸为 $\\Delta x_{i}$ 的均匀网格，时间离散是采用前向欧拉时间步进和迎风数值通量的显式一阶有限体积法 (FVM)。为了在确保稳定性的同时限制数值耗散，对所有局部更新施加一个 Courant-Friedrichs-Lewy (CFL) 安全因子 $C^{\\star}$，其中 $0C^{\\star}\\leq 1$。\n\n为了适应不同的波速和网格分辨率，您将采用局部时间步进（子循环）：引入一个全局宏观时间步长 $\\Delta T$，并选择整数 $n_{1}$ 和 $n_{2}$，使得 $\\Omega_{1}$ 中的局部时间步长为 $\\Delta t_{1}=\\Delta T/n_{1}$，$\\Omega_{2}$ 中的局部时间步长为 $\\Delta t_{2}=\\Delta T/n_{2}$。在界面处，数值通量在 $[t^{m},t^{m}+\\Delta T]$ 的一个划分上进行一致性评估，该划分是通过取 $\\Omega_{1}$ 和 $\\Omega_{2}$ 中子步长边界的有序并集得到的；在每个子区间上，界面状态是分段常数，使用一个黎曼求解器为该子区间计算单个界面通量，并且将大小相等、方向相反的通量贡献累加到两侧相邻的控制体积中，以保持守恒性。\n\n从线性平流定律的有限体积更新和显式迎风法的 CFL 条件定义出发，推导出一个关于 $\\Delta T$ 的稳定性约束，该约束确保在上述子循环策略下，两个子域中的 Courant 数都以 $C^{\\star}$ 为界，同时在界面处保持全局守恒性。然后，在子循环因子受限于 $n_{1} \\leq N_{1}^{\\max}$ 和 $n_{2} \\leq N_{2}^{\\max}$ 的附加计算约束下，确定最大允许宏观时间步长 $\\Delta T_{\\max}$。\n\n使用以下数据：\n- $c_{1} = 2500\\,\\mathrm{m/s}$, $c_{2} = 600\\,\\mathrm{m/s}$,\n- $\\Delta x_{1} = 0.5\\,\\mathrm{m}$, $\\Delta x_{2} = 0.2\\,\\mathrm{m}$,\n- $C^{\\star} = 0.9$,\n- $N_{1}^{\\max} = 8$, $N_{2}^{\\max} = 10$.\n\n将 $\\Delta T_{\\max}$ 的最终答案以毫秒表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导一个使用局部时间步进（子循环）求解的耦合系统的稳定性约束，并随后在给定约束下求出最大可能的全局时间步长 $\\Delta T_{\\max}$。\n\n该数值格式是用于线性守恒律的、带迎风通量的显式一阶有限体积法。这种格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件控制。对于子域 $\\Omega_i$ 中的一维问题，其特征波速为 $c_i$，均匀网格间距为 $\\Delta x_i$，时间步长为 $\\Delta t_i$，则 Courant 数定义为：\n$$\n\\text{Cr}_i = \\frac{c_i \\Delta t_i}{\\Delta x_i}\n$$\n问题陈述，为保证稳定性，每个子域中的 Courant 数必须以安全因子 $C^{\\star}$ 为界，其中 $0  C^{\\star} \\leq 1$。这为每个子域 $\\Omega_i$（$i \\in \\{1,2\\}$）施加了一个条件：\n$$\n\\frac{c_1 \\Delta t_1}{\\Delta x_1} \\leq C^{\\star}\n$$\n$$\n\\frac{c_2 \\Delta t_2}{\\Delta x_2} \\leq C^{\\star}\n$$\n局部时间步进策略通过整数子循环因子 $n_1$ 和 $n_2$ 将局部时间步长 $\\Delta t_1$ 和 $\\Delta t_2$ 与全局宏观时间步长 $\\Delta T$ 联系起来：\n$$\n\\Delta t_1 = \\frac{\\Delta T}{n_1} \\quad \\text{和} \\quad \\Delta t_2 = \\frac{\\Delta T}{n_2}\n$$\n将这些表达式代入稳定性不等式，得到：\n$$\n\\frac{c_1 (\\Delta T / n_1)}{\\Delta x_1} \\leq C^{\\star} \\implies \\Delta T \\leq n_1 \\frac{C^{\\star} \\Delta x_1}{c_1}\n$$\n$$\n\\frac{c_2 (\\Delta T / n_2)}{\\Delta x_2} \\leq C^{\\star} \\implies \\Delta T \\leq n_2 \\frac{C^{\\star} \\Delta x_2}{c_2}\n$$\n为使整个方法稳定，全局时间步长 $\\Delta T$ 必须对于所选的一对整数 $(n_1, n_2)$ 同时满足这两个条件。这导出了关于 $\\Delta T$ 的组合稳定性约束：\n$$\n\\Delta T \\leq \\min \\left( n_1 \\frac{C^{\\star} \\Delta x_1}{c_1}, n_2 \\frac{C^{\\star} \\Delta x_2}{c_2} \\right)\n$$\n对于任何有效的子循环因子对 $(n_1, n_2)$，此表达式是 $\\Delta T$ 的通用稳定性约束。界面通量计算的描述证实了这是一种守恒耦合，它不会引入比各子域内显式更新所产生的约束更严格的稳定性约束。\n\n问题的第二部分是，在给定子循环因子界限 $1 \\leq n_1 \\leq N_1^{\\max}$ 和 $1 \\leq n_2 \\leq N_2^{\\max}$ 的情况下，求出最大允许宏观时间步长 $\\Delta T_{\\max}$。我们需要在所有允许的整数对 $(n_1, n_2)$ 上最大化 $\\Delta T$ 的上界：\n$$\n\\Delta T_{\\max} = \\max_{\\substack{1 \\leq n_1 \\leq N_1^{\\max} \\\\ 1 \\leq n_2 \\leq N_2^{\\max}}} \\left\\{ \\min \\left( n_1 \\frac{C^{\\star} \\Delta x_1}{c_1}, n_2 \\frac{C^{\\star} \\Delta x_2}{c_2} \\right) \\right\\}\n$$\n让我们将单位子循环（$n_i=1$）的特征稳定时间步长定义为 $\\Delta \\tau_i = \\frac{C^{\\star} \\Delta x_i}{c_i}$。需要最大化的函数是 $F(n_1, n_2) = \\min(n_1 \\Delta \\tau_1, n_2 \\Delta \\tau_2)$。由于 $\\Delta \\tau_1  0$ 且 $\\Delta \\tau_2  0$，函数 $F(n_1, n_2)$ 是关于 $n_1$ 和 $n_2$ 的非减函数。因此，它在整数矩形域 $[1, N_1^{\\max}] \\times [1, N_2^{\\max}]$ 上的最大值必然出现在两个变量都取最大值的角点，即 $(n_1, n_2) = (N_1^{\\max}, N_2^{\\max})$。\n\n因此，通过设置 $n_1 = N_1^{\\max}$ 和 $n_2 = N_2^{\\max}$，可以找到最大宏观时间步长：\n$$\n\\Delta T_{\\max} = \\min \\left( N_1^{\\max} \\frac{C^{\\star} \\Delta x_1}{c_1}, N_2^{\\max} \\frac{C^{\\star} \\Delta x_2}{c_2} \\right)\n$$\n现在，我们代入给定的数值：\n- $c_1 = 2500\\,\\mathrm{m/s}$\n- $c_2 = 600\\,\\mathrm{m/s}$\n- $\\Delta x_1 = 0.5\\,\\mathrm{m}$\n- $\\Delta x_2 = 0.2\\,\\mathrm{m}$\n- $C^{\\star} = 0.9$\n- $N_1^{\\max} = 8$\n- $N_2^{\\max} = 10$\n\n我们计算 minimum 函数的两个参数：\n第一个子域的项是：\n$$\nN_1^{\\max} \\frac{C^{\\star} \\Delta x_1}{c_1} = 8 \\times \\frac{0.9 \\times 0.5}{2500} = 8 \\times \\frac{0.45}{2500} = \\frac{3.6}{2500} = 0.00144\\,\\mathrm{s}\n$$\n第二个子域的项是：\n$$\nN_2^{\\max} \\frac{C^{\\star} \\Delta x_2}{c_2} = 10 \\times \\frac{0.9 \\times 0.2}{600} = 10 \\times \\frac{0.18}{600} = \\frac{1.8}{600} = 0.003\\,\\mathrm{s}\n$$\n现在，我们求这两个值的最小值来确定 $\\Delta T_{\\max}$：\n$$\n\\Delta T_{\\max} = \\min(0.00144\\,\\mathrm{s}, 0.003\\,\\mathrm{s}) = 0.00144\\,\\mathrm{s}\n$$\n问题要求答案以毫秒（ms）为单位，并四舍五入到四位有效数字。\n$$\n\\Delta T_{\\max} = 0.00144\\,\\mathrm{s} \\times \\frac{1000\\,\\mathrm{ms}}{1\\,\\mathrm{s}} = 1.44\\,\\mathrm{ms}\n$$\n为了用四位有效数字表示 $1.44$，我们在末尾添加一个零，这在此上下文中是有效的。\n$$\n\\Delta T_{\\max} = 1.440\\,\\mathrm{ms}\n$$",
            "answer": "$$\\boxed{1.440}$$"
        }
    ]
}