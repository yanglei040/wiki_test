{
    "hands_on_practices": [
        {
            "introduction": "Understanding numerical stability begins with analyzing a scheme known for its robustness. This first practice invites you to derive the Courant-Friedrichs-Lewy (CFL) condition for the first-order upwind method , a cornerstone of computational fluid dynamics. By performing a von Neumann stability analysis, you will directly connect the physical properties of wave propagation to the mathematical constraints on the time step, establishing a fundamental principle for stable explicit simulations.",
            "id": "3518897",
            "problem": "Consider a one-dimensional passive scalar $u(x,t)$ being advected at a constant velocity $a$ in a partitioned multiphysics setting, where the scalar $u$ represents a field exchanged with a second physics module through an explicit, lagged coupling. The governing partial differential equation (PDE) for the transport step is $u_{t} + a\\,u_{x} = 0$ on a periodic domain of length $L$ with a uniform grid spacing $\\Delta x = L/N$, where $N$ is a positive integer. The coupling to the second physics module is algebraic and lagged in time, so that during the explicit transport update it does not alter the spatial operator acting on $u$.\n\nYou discretize the transport equation using a first-order upwind finite difference in space and a forward Euler update in time with step $\\Delta t$. The upwind stencil must be chosen according to the sign of $a$ to ensure physical upwinding. Assume periodic boundary conditions and represent grid values by $u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$ for all integer indices $j$ and time levels $n$.\n\nUsing von Neumann (Fourier) stability analysis, derive the amplification factor for this scheme and determine the condition on $\\Delta t$ such that the magnitude of the amplification factor does not exceed unity for any Fourier mode admitted by the periodic grid. From this, extract the maximum allowable time step for stability as a closed-form expression in terms of $a$ and $\\Delta x$. Report this maximum stable time step, and express your final answer in seconds. Do not quote any pre-existing Courant-Friedrichs-Lewy (CFL) condition; instead, derive it directly from the discrete update and the Fourier-mode ansatz. The final answer must be a single analytic expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Governing PDE**: $u_{t} + a\\,u_{x} = 0$, where $u(x,t)$ is a passive scalar and $a$ is a constant advection velocity.\n- **Domain**: Periodic with length $L$.\n- **Grid**: Uniform spacing $\\Delta x = L/N$ for positive integer $N$.\n- **Temporal Discretization**: Forward Euler with time step $\\Delta t$.\n- **Spatial Discretization**: First-order upwind finite difference.\n- **Boundary Conditions**: Periodic.\n- **Notation**: $u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$.\n- **Analysis Method**: von Neumann stability analysis.\n- **Objective**: Derive the amplification factor and find the maximum stable time step $\\Delta t_{max}$ as a function of $a$ and $\\Delta x$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem addresses the stability of a standard numerical scheme (Forward Time, Upwind Space) for the linear advection equation, a cornerstone of computational fluid dynamics. The use of von Neumann analysis is the correct and standard procedure for this type of problem. The setup is scientifically rigorous.\n- **Well-Posedness**: The problem is clearly defined with all necessary components: the PDE, discretization method, boundary conditions, and the question to be answered. A unique, well-defined stability criterion exists for this scheme.\n- **Objectivity**: The problem is stated in precise, objective, and standard mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a classic and well-posed problem in numerical analysis. The solution process will now proceed.\n\n### Derivation of the Stability Condition\n\nThe governing partial differential equation is:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nWe discretize this equation using a forward difference in time (Forward Euler) and a first-order upwind difference in space. The choice of the upwind stencil depends on the sign of the advection velocity $a$.\n\nThe time derivative is approximated as:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\nThe spatial derivative, $\\frac{\\partial u}{\\partial x}$, is approximated based on the direction from which information is \"upwind\".\n\n**Case 1: $a > 0$**\nIf the velocity $a$ is positive, the wave propagates from left to right. The upwind direction is to the left, so we use a backward difference for the spatial derivative:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}\n$$\nSubstituting these approximations into the PDE, $u_t = -a u_x$, yields the discrete update equation:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j}^{n} - u_{j-1}^{n})\n$$\n\n**Case 2: $a < 0$**\nIf the velocity $a$ is negative, the wave propagates from right to left. The upwind direction is to the right, so we use a forward difference for the spatial derivative:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x}\n$$\nSubstituting into the PDE gives the discrete update equation:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j+1}^{n} - u_{j}^{n})\n$$\n\nNow, we perform von Neumann stability analysis. We consider a single Fourier mode of the solution on the grid:\n$$\nu_{j}^{n} = G^{n} e^{i k x_{j}} = G^{n} e^{i k j \\Delta x}\n$$\nwhere $k$ is the wavenumber, $i = \\sqrt{-1}$, and $G$ is the amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any possible wavenumber, i.e., $|G| \\le 1$.\n\nLet's re-analyze both cases using this ansatz.\n\n**Stability Analysis for $a > 0$**\nWe substitute the Fourier mode into the discrete equation for $a > 0$:\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k j \\Delta x} - G^{n} e^{i k (j-1) \\Delta x} \\right)\n$$\nLet's define the Courant number $\\sigma = \\frac{a \\Delta t}{\\Delta x}$. Since $a > 0$, $\\sigma$ is positive. Dividing the entire equation by $G^n e^{i k j \\Delta x}$ gives the amplification factor $G$:\n$$\nG = 1 - \\sigma \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\nLet $\\theta = k \\Delta x$ be the dimensionless wavenumber.\n$$\nG = 1 - \\sigma (1 - (\\cos\\theta - i\\sin\\theta)) = (1 - \\sigma + \\sigma\\cos\\theta) + i\\sigma\\sin\\theta\n$$\nThe squared magnitude of the amplification factor is $|G|^2$:\n$$\n|G|^2 = (1 - \\sigma + \\sigma\\cos\\theta)^2 + (\\sigma\\sin\\theta)^2\n$$\n$$\n|G|^2 = (1 - \\sigma(1 - \\cos\\theta))^2 + \\sigma^2 \\sin^2\\theta\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2\\sin^2\\theta\n$$\nUsing $\\sin^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta)$:\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2(1 - \\cos\\theta)(1 + \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta) [ (1 - \\cos\\theta) + (1 + \\cos\\theta) ]\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)(2)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + 2\\sigma^2(1 - \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta)\n$$\nFor stability, we require $|G|^2 \\le 1$. This implies $1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 1$, which simplifies to:\n$$\n-2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 0\n$$\nSince $\\sigma = \\frac{a \\Delta t}{\\Delta x} > 0$ and $(1 - \\cos\\theta) \\ge 0$ for all real $\\theta$, the inequality holds if and only if:\n$$\n1 - \\sigma \\ge 0 \\implies \\sigma \\le 1\n$$\nSo, for $a > 0$, the stability condition is $\\frac{a \\Delta t}{\\Delta x} \\le 1$.\n\n**Stability Analysis for $a < 0$**\nWe substitute the Fourier mode into the discrete equation for $a < 0$:\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k (j+1) \\Delta x} - G^{n} e^{i k j \\Delta x} \\right)\n$$\nAgain, let $\\sigma = \\frac{a \\Delta t}{\\Delta x}$. Since $a < 0$, $\\sigma$ is negative. Dividing by $G^n e^{i k j \\Delta x}$ gives:\n$$\nG = 1 - \\sigma (e^{i k \\Delta x} - 1)\n$$\nLet's define a non-negative Courant number $C = \\frac{|a| \\Delta t}{\\Delta x}$. Then $\\sigma = -C$. Substituting this into the expression for $G$:\n$$\nG = 1 - (-C) (e^{i\\theta} - 1) = 1 + C(e^{i\\theta} - 1)\n$$\n$$\nG = 1 + C(\\cos\\theta - 1 + i\\sin\\theta) = (1 - C + C\\cos\\theta) + iC\\sin\\theta\n$$\nThis expression for $G$ is identical in form to the one derived for $a > 0$ with $\\sigma$ replaced by $C$. The subsequent derivation for $|G|^2$ is therefore identical, replacing $\\sigma$ with $C$:\n$$\n|G|^2 = 1 - 2C(1 - C)(1 - \\cos\\theta)\n$$\nFor stability, $|G|^2 \\le 1$, which requires $-2C(1 - C)(1 - \\cos\\theta) \\le 0$.\nSince $C = \\frac{|a| \\Delta t}{\\Delta x} > 0$ and $(1 - \\cos\\theta) \\ge 0$, the inequality holds if and only if:\n$$\n1 - C \\ge 0 \\implies C \\le 1\n$$\nSo, for $a < 0$, the stability condition is $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$.\n\n**Conclusion**\nBoth cases lead to the same stability requirement, which can be expressed compactly using the absolute value of the velocity:\n$$\n\\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\nThis is the Courant-Friedrichs-Lewy (CFL) condition for the first-order upwind scheme. The problem asks for the maximum allowable time step, $\\Delta t_{max}$, for which the scheme is stable. This is obtained when the condition is at its limit:\n$$\n\\frac{|a| \\Delta t_{max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{max}$ gives the final expression.\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{|a|}\n$$\nThis expression represents the maximum time step that ensures numerical stability for any Fourier mode that the grid can resolve. It has the physical interpretation that in a single time step, information cannot travel further than a single grid cell.",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "While the upwind scheme provides stability by respecting the direction of information flow, what happens if we use a more symmetrical, higher-order approximation? This exercise explores the Forward-Time Central-Space (FTCS) scheme, a classic cautionary tale in numerical analysis . Your analysis will reveal why this seemingly intuitive method is unconditionally unstable for advection problems, providing a critical insight into the subtle interplay between discretization choice and stability.",
            "id": "3518829",
            "problem": "A linear advection substep appears inside a partitioned multiphysics solver that alternates between fluid advection and passive scalar transport. Consider the scalar advection equation in a single spatial dimension with constant wave speed,\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nposed on a periodic domain with period $L$, where $a>0$ is constant. On a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, the advection substep is approximated by a forward Euler update in time and a central difference in space. Denote by $u_{j}^{n}$ the numerical solution at spatial index $j$ and time level $n$. Assume the solution and the discrete operator are both periodic and shift-invariant.\n\nStarting from the definitions of the forward Euler method and the central difference operator, and using spatial Fourier modes compatible with the periodic domain, perform a von Neumann (Fourier) stability analysis to determine the discrete amplification factor and its magnitude. Introduce the Courant-Friedrichs-Lewy (CFL) number $C$ defined by $C = a\\,\\Delta t / \\Delta x$ and a nondimensional phase $\\theta$ associated with a spatial Fourier mode. Use the fact that for linear, constant-coefficient, shift-invariant schemes on periodic grids, complex exponentials are eigenfunctions of the discrete spatial derivative.\n\nExplain, based on first principles and your derived magnitude of the amplification factor, why this time-space discretization is unconditionally unstable in the sense of von Neumann. Your final answer should be a single, closed-form analytic expression for the magnitude of the amplification factor as a function of $\\theta$ and $C$. Do not include any units in the final answer. No numerical rounding is required.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Governing Equation:** $u_{t} + a\\,u_{x} = 0$\n- **Wave Speed:** $a > 0$, constant.\n- **Domain:** Periodic with period $L$.\n- **Discretization:**\n  - Time: Forward Euler method.\n  - Space: Central difference method.\n  - Grid: Uniform with spatial step $\\Delta x$ and time step $\\Delta t$.\n- **Numerical Solution Notation:** $u_{j}^{n}$ at spatial index $j$ and time level $n$.\n- **Assumptions:** Solution and discrete operator are periodic and shift-invariant.\n- **Analysis Method:** von Neumann (Fourier) stability analysis.\n- **Definitions:**\n  - Courant-Friedrichs-Lewy (CFL) number: $C = a\\,\\Delta t / \\Delta x$.\n  - Nondimensional phase: $\\theta$ for a spatial Fourier mode.\n- **Task:** Derive the discrete amplification factor and its magnitude, and use the result to explain why the scheme is unconditionally unstable.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a classic exercise in the numerical analysis of partial differential equations. The governing equation is the fundamental linear advection equation. The numerical scheme (Forward Time, Central Space, or FTCS) is a standard, albeit flawed, discretization. The method of analysis, von Neumann stability analysis, is the canonical tool for linear, constant-coefficient problems on periodic domains. All definitions and terms ($C$, $\\theta$) are standard. The problem is self-contained, scientifically sound, and well-posed. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe given partial differential equation (PDE) is the one-dimensional linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nWe are instructed to discretize this equation using a forward difference in time (Forward Euler) and a central difference in space. The forward difference approximation for the time derivative at grid point $(j, n)$ is:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\nThe central difference approximation for the spatial derivative is:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x}\n$$\nSubstituting these approximations into the PDE yields the finite difference equation:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left( \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} \\right) = 0\n$$\nTo find the update rule for $u_{j}^{n+1}$, we solve for this term:\n$$\nu_{j}^{n+1} = u_{j}^{n} - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\nWe introduce the Courant-Friedrichs-Lewy (CFL) number, defined as $C = a\\,\\Delta t / \\Delta x$. Substituting $C$ into the equation gives the final form of the discrete scheme:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\nFor the von Neumann stability analysis, we consider a single spatial Fourier mode as a solution. On a grid with points $x_j = j \\Delta x$, a general Fourier mode has the form $e^{i k x_j} = e^{i k j \\Delta x}$, where $k$ is the wavenumber. We define the nondimensional phase angle $\\theta = k \\Delta x$. The solution at a given time level $n$ is represented as a superposition of such modes. Due to the linearity of the scheme, we can analyze the behavior of a single mode:\n$$\nu_{j}^{n} = \\hat{u}^{n}(k) e^{i j \\theta}\n$$\nwhere $\\hat{u}^{n}(k)$ is the amplitude of the mode with phase $\\theta$ at time level $n$. Substituting this ansatz into the discrete scheme gives:\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} - \\frac{C}{2} \\left( \\hat{u}^{n} e^{i (j+1) \\theta} - \\hat{u}^{n} e^{i (j-1) \\theta} \\right)\n$$\nWe can factor out the common term $\\hat{u}^{n} e^{i j \\theta}$:\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\nDividing by $e^{i j \\theta}$ gives the evolution of the mode's amplitude:\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\nThe amplification factor, $G(\\theta)$, is defined as the ratio of the amplitudes at successive time steps, $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$. Therefore:\n$$\nG(\\theta) = 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta})\n$$\nUsing Euler's identity, $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$, we can simplify the expression for $G(\\theta)$:\n$$\nG(\\theta) = 1 - \\frac{C}{2} (2i \\sin(\\theta)) = 1 - iC\\sin(\\theta)\n$$\nThis is the complex amplification factor. To assess stability, we must find its magnitude, $|G(\\theta)|$. For a complex number $z = x + iy$, its magnitude is $|z| = \\sqrt{x^2 + y^2}$. In our case, the real part is $1$ and the imaginary part is $-C\\sin(\\theta)$.\n$$\n|G(\\theta)| = \\sqrt{1^2 + (-C\\sin(\\theta))^2}\n$$\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}\n$$\nThis expression gives the magnitude of the amplification factor as a function of the CFL number $C$ and the nondimensional phase $\\theta$.\n\n**Explanation of Unconditional Instability**\nThe von Neumann stability criterion for a numerical scheme requires that the magnitude of the amplification factor must be less than or equal to one for all possible Fourier modes, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. If this condition is violated for any mode, that mode's amplitude will grow exponentially with each time step, leading to a numerical instability that quickly overwhelms the true solution.\n\nLet's examine our derived magnitude, $|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}$.\nAccording to the problem statement, the wave speed $a$ is positive. The grid spacing $\\Delta x$ and time step $\\Delta t$ are also positive physical quantities. Therefore, the CFL number $C = a \\Delta t / \\Delta x$ is strictly positive ($C > 0$).\nThe term $\\sin^2(\\theta)$ is always non-negative, $\\sin^2(\\theta) \\ge 0$.\nThe product $C^2 \\sin^2(\\theta)$ is therefore also non-negative.\n\nThe only cases where $C^2 \\sin^2(\\theta) = 0$ are:\n1.  If $C = 0$. This is a trivial case where $\\Delta t = 0$, meaning the simulation does not advance in time.\n2.  If $\\sin(\\theta) = 0$. This occurs when $\\theta = n\\pi$ for any integer $n$. These modes correspond to constant values ($\\theta=0$) or the Nyquist frequency mode ($\\theta=\\pi$) on the grid, which have infinite or minimal wavelength, respectively. For these specific modes, $|G(\\theta)| = \\sqrt{1+0} = 1$, so they do not grow.\n\nHowever, for any other Fourier mode, where $\\sin(\\theta) \\neq 0$, the term $C^2 \\sin^2(\\theta)$ is strictly positive. Consequently, for any such mode:\n$$\n1 + C^2 \\sin^2(\\theta) > 1\n$$\nTaking the square root, we find:\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)} > 1\n$$\nThis inequality holds for any non-zero value of the CFL number $C$ and for any mode $\\theta$ that is not an integer multiple of $\\pi$. Since the stability criterion must be satisfied for all modes, and it fails for almost all of them regardless of the choice of $\\Delta t$ and $\\Delta x$ (as long as $C > 0$), the scheme is unstable for any choice of time step. This is the definition of unconditional instability. The imaginary term $iC\\sin(\\theta)$ in the amplification factor, which arises from the central difference operator, acts purely to add energy to the system at each time step without any corresponding dissipative mechanism, causing the solution to grow without bound.",
            "answer": "$$\n\\boxed{\\sqrt{1 + C^2 \\sin^2(\\theta)}}\n$$"
        },
        {
            "introduction": "Theoretical stability analysis often assumes periodic domains, but real-world simulations are finite and bounded. This advanced practice examines how boundary conditions influence system stability, moving beyond standard von Neumann analysis . By analyzing a small system with a specific inflow boundary treatment, you will determine how local numerical formulations at the domain's edge can impose a stricter CFL limit than the interior scheme alone, a vital consideration in practical code development.",
            "id": "3518925",
            "problem": "Consider a one-dimensional linear transport subproblem extracted from a larger multiphysics coupled simulation, where a conserved scalar field $u(x,t)$ (for example, a passive thermal tracer being advected by a prescribed flow) obeys the advection equation $\\partial_t u + a \\,\\partial_x u = 0$ on a short domain consisting of $2$ uniform finite volume cells of size $\\Delta x$, with constant advection speed $a>0$. The temporal discretization is the explicit forward Euler method with time step $\\Delta t$. The spatial discretization is a first-order upwind finite volume method, with flux $F = a \\, u$ at every face. The Courant–Friedrichs–Lewy (CFL) number is defined here as $\\nu = \\dfrac{a \\, \\Delta t}{\\Delta x}$.\n\nThe left boundary at $x=0$ is inflow and is to be enforced by a ghost cell value $u_0$ entering the left face flux of the first interior cell. Two boundary treatments are considered:\n\n- A reflective (zero-gradient) ghost cell, $u_0 = u_1$.\n- A penalty ghost cell for inflow enforcement, $u_0 = u_1 - \\tau \\,(u_1 - u_{\\mathrm{in}})$, where $u_{\\mathrm{in}}$ is a constant inflow state and $\\tau>0$ is a nondimensional penalty coefficient.\n\nThe right boundary at $x=2 \\Delta x$ is outflow and requires no special treatment for $a>0$. Assume $u_{\\mathrm{in}}$ is constant in time so that it acts only as a steady inhomogeneous forcing on the first cell.\n\nStarting from the advection equation, the conservative finite volume update, and the explicit forward Euler time stepping, derive the homogeneous two-cell amplification operator that maps $\\begin{pmatrix} u_1^n \\\\ u_2^n \\end{pmatrix}$ to $\\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix}$ for each of the two boundary treatments. Then, using the forward Euler absolute stability requirement applied to the eigenvalues of the homogeneous amplification operator, determine the tight bound on the CFL number $\\nu$ in terms of the penalty parameter $\\tau$.\n\nFinally, evaluate the maximum allowable CFL number for the penalty inflow boundary with penalty coefficient $\\tau = 3$. Give your final answer as a single simplified rational number without units. No rounding is required.",
            "solution": "The problem asks for the derivation of the amplification operator for a two-cell finite volume discretization of the 1D advection equation under two different boundary conditions, followed by a stability analysis to find the CFL limit for one of those conditions.\n\nFirst, we establish the semi-discrete finite volume equations for the scalar field $u(x,t)$ in the two cells. Let $u_1(t)$ and $u_2(t)$ be the cell-averaged values in cell 1 ($[0, \\Delta x]$) and cell 2 ($[\\Delta x, 2\\Delta x]$), respectively. The governing partial differential equation is $\\partial_t u + a \\, \\partial_x u = 0$.\n\nThe conservative finite volume formulation for cell $i$ is given by:\n$$ \\frac{d u_i}{dt} = - \\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\nwhere $F_{i \\pm 1/2}$ are the numerical fluxes at the cell faces. The faces for our two-cell system are located at $x_{1/2}=0$, $x_{3/2}=\\Delta x$, and $x_{5/2}=2\\Delta x$.\n\nThe update equations for $u_1$ and $u_2$ are:\n$$ \\frac{d u_1}{dt} = - \\frac{1}{\\Delta x} (F_{3/2} - F_{1/2}) $$\n$$ \\frac{d u_2}{dt} = - \\frac{1}{\\Delta x} (F_{5/2} - F_{3/2}) $$\n\nWe use a first-order upwind scheme for the flux $F=au$. Since the advection speed $a>0$, the flow is from left to right. The flux at any face is determined by the cell value to its immediate left.\n-   The flux at the interface between cells 1 and 2, $x_{3/2}=\\Delta x$, is $F_{3/2} = a u_1$.\n-   The flux at the outflow boundary, $x_{5/2}=2\\Delta x$, is $F_{5/2} = a u_2$.\n-   The flux at the inflow boundary, $x_{1/2}=0$, is $F_{1/2} = a u_0$, where $u_0$ is the value in a ghost cell to the left of cell 1.\n\nSubstituting these fluxes into the conservation laws gives:\n$$ \\frac{d u_1}{dt} = - \\frac{1}{\\Delta x} (a u_1 - a u_0) = \\frac{a}{\\Delta x} (u_0 - u_1) $$\n$$ \\frac{d u_2}{dt} = - \\frac{1}{\\Delta x} (a u_2 - a u_1) = \\frac{a}{\\Delta x} (u_1 - u_2) $$\n\nThis system can be written in vector form as:\n$$ \\frac{d}{dt} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\frac{a}{\\Delta x} \\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} + \\frac{a}{\\Delta x} \\begin{pmatrix} u_0 \\\\ 0 \\end{pmatrix} $$\n\nTo determine the homogeneous amplification operator, we must express $u_0$ in terms of $u_1$ and $u_2$ and set any external forcing to zero.\n\n**Case 1: Reflective Boundary Condition**\nThe boundary condition is $u_0 = u_1$. Substituting this into the equation for $du_1/dt$:\n$$ \\frac{d u_1}{dt} = \\frac{a}{\\Delta x} (u_1 - u_1) = 0 $$\n$$ \\frac{d u_2}{dt} = \\frac{a}{\\Delta x} (u_1 - u_2) $$\nThe semi-discrete system is $\\frac{d\\mathbf{u}}{dt} = A_1 \\mathbf{u}$, where $\\mathbf{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ and the matrix $A_1$ is:\n$$ A_1 = \\frac{a}{\\Delta x} \\begin{pmatrix} 0 & 0 \\\\ 1 & -1 \\end{pmatrix} $$\nApplying the explicit forward Euler method, $\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t (A_1 \\mathbf{u}^n) = (I + \\Delta t A_1) \\mathbf{u}^n$. The amplification operator $G_1$ is $G_1 = I + \\Delta t A_1$. Defining the CFL number $\\nu = \\frac{a \\Delta t}{\\Delta x}$:\n$$ G_1 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\frac{a \\Delta t}{\\Delta x} \\begin{pmatrix} 0 & 0 \\\\ 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\nu \\begin{pmatrix} 0 & 0 \\\\ 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ \\nu & 1-\\nu \\end{pmatrix} $$\n\n**Case 2: Penalty Boundary Condition**\nThe boundary condition is $u_0 = u_1 - \\tau(u_1 - u_{\\mathrm{in}})$. For the homogeneous system, we set the external forcing $u_{\\mathrm{in}}$ to zero, which gives $u_0 = u_1 - \\tau u_1 = (1-\\tau)u_1$.\nSubstituting this into the equation for $du_1/dt$:\n$$ \\frac{d u_1}{dt} = \\frac{a}{\\Delta x} ((1-\\tau)u_1 - u_1) = -\\frac{a\\tau}{\\Delta x} u_1 $$\n$$ \\frac{d u_2}{dt} = \\frac{a}{\\Delta x} (u_1 - u_2) $$\nThe semi-discrete system is $\\frac{d\\mathbf{u}}{dt} = A_2 \\mathbf{u}$, with the matrix $A_2$:\n$$ A_2 = \\frac{a}{\\Delta x} \\begin{pmatrix} -\\tau & 0 \\\\ 1 & -1 \\end{pmatrix} $$\nThe amplification operator $G_2$ is $G_2 = I + \\Delta t A_2$:\n$$ G_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\frac{a \\Delta t}{\\Delta x} \\begin{pmatrix} -\\tau & 0 \\\\ 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\nu \\begin{pmatrix} -\\tau & 0 \\\\ 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1-\\nu\\tau & 0 \\\\ \\nu & 1-\\nu \\end{pmatrix} $$\n\n**Stability Analysis for the Penalty Boundary**\nFor the scheme to be stable, the spectral radius of the amplification matrix $G_2$ must be no greater than $1$. That is, for every eigenvalue $\\lambda$ of $G_2$, we must have $|\\lambda| \\le 1$.\nThe matrix $G_2$ is lower triangular, so its eigenvalues are its diagonal entries:\n$$ \\lambda_1 = 1 - \\nu\\tau $$\n$$ \\lambda_2 = 1 - \\nu $$\n\nWe must satisfy the stability conditions for both eigenvalues:\n1.  $|\\lambda_1| \\le 1 \\implies |1 - \\nu\\tau| \\le 1$. This inequality is equivalent to $-1 \\le 1 - \\nu\\tau \\le 1$.\n    -   $1 - \\nu\\tau \\le 1 \\implies -\\nu\\tau \\le 0$. Since $\\nu = a\\Delta t/\\Delta x > 0$ and $\\tau > 0$, this is always true.\n    -   $-1 \\le 1 - \\nu\\tau \\implies \\nu\\tau \\le 2 \\implies \\nu \\le \\frac{2}{\\tau}$.\n\n2.  $|\\lambda_2| \\le 1 \\implies |1 - \\nu| \\le 1$. This inequality is equivalent to $-1 \\le 1 - \\nu \\le 1$.\n    -   $1 - \\nu \\le 1 \\implies -\\nu \\le 0 \\implies \\nu \\ge 0$. This is always true.\n    -   $-1 \\le 1 - \\nu \\implies \\nu \\le 2$.\n\nFor the overall scheme to be stable, both conditions must be met simultaneously. Therefore, the CFL number $\\nu$ must be less than or equal to the minimum of the two derived upper bounds:\n$$ \\nu \\le \\min\\left(\\frac{2}{\\tau}, 2\\right) $$\nThis is the tight bound on the CFL number in terms of the penalty parameter $\\tau$.\n\n**Final Evaluation**\nThe problem asks for the maximum allowable CFL number for a penalty coefficient of $\\tau = 3$. We substitute this value into our derived stability bound:\n$$ \\nu_{\\max} = \\min\\left(\\frac{2}{3}, 2\\right) $$\nThe minimum of the two values is clearly $\\frac{2}{3}$.\nThus, the maximum allowable CFL number is $\\frac{2}{3}$.",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        }
    ]
}