{
    "hands_on_practices": [
        {
            "introduction": "牛顿法不仅仅是求解抽象方程组的工具，它更是求解由物理定律（如偏微分方程）离散化后产生的非线性系统的核心算法。本练习将理论与应用相结合，展示了如何为通过 $\\theta$ 方法进行时间离散化的非线性反应扩散问题构建牛顿迭代系统。通过这个实践，你将掌握为科学计算中常见的复杂结构型问题推导雅可比矩阵的关键技能。",
            "id": "3455013",
            "problem": "考虑从一维非线性扩散反应偏微分方程 (PDE) $u_{t} = \\nu u_{xx} + \\alpha u - \\beta u^{3}$（在区间 $x \\in (0,L)$ 上，具有齐次狄利克雷边界条件 $u(0,t) = u(L,t) = 0$）得到的半离散系统。使用具有两个内部点（因此未知数数量为 $m=2$）的均匀空间网格，带有齐次狄利克雷边界条件的中心差分拉普拉斯算子得到矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$，由 $A = \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix}$ 给出，网格间距为 $h = L/3$。由此得到的半离散常微分方程 (ODE) 系统为 $u'(t) = f(u(t))$，其中 $f: \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$ 定义为 $f(u) = \\frac{\\nu}{h^{2}} A u + \\alpha u - \\beta u^{\\odot 3}$，其中 $u^{\\odot 3}$ 表示 $u$ 的逐分量立方。\n\n时间积分采用通用的 $\\theta$ 方法，对于从 $t^{n}$ 到 $t^{n+1} = t^{n} + \\Delta t$ 的时间步长，施加非线性系统\n$$\nG(u^{n+1}) = u^{n+1} - u^{n} - \\Delta t \\Big[(1-\\theta) f(u^{n}) + \\theta f(u^{n+1})\\Big] = 0,\n$$\n需求解 $u^{n+1} \\in \\mathbb{R}^{2}$。\n\n从非线性系统的牛顿法标准定义和矩阵微积分的基本规则出发，完成以下任务：\n\n1. 构建求解 $G(u^{n+1}) = 0$ 的牛顿迭代法，清晰地指出牛顿更新量和每次迭代中需求解的线性系统。\n2. 对于给定的 $f(u)$，显式地推导雅可比矩阵 $\\frac{\\partial G}{\\partial u}(u)$，并用 $\\nu$、$\\alpha$、$\\beta$、$h$、$\\Delta t$、$\\theta$、$A$ 和 $u$ 表示。\n3. 对于参数值 $L = 3$，$\\nu = 0.5$，$\\alpha = 1$，$\\beta = 2$，$\\Delta t = 0.1$，$\\theta = 0.7$，以及求值点 $u^{n+1} = \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix}$，计算雅可比矩阵 $\\frac{\\partial G}{\\partial u}(u^{n+1})$ 的行列式。\n\n将最终的行列式结果四舍五入到四位有效数字。将最终答案表示为一个纯数（无单位）。",
            "solution": "该问题被评估为有效，因为它在偏微分方程的数值分析方面有科学依据，问题设定良好，信息充分且一致，并以客观、正式的语言表述。我们可以按要求分三部分进行求解。\n\n### 第一部分：牛顿迭代的构建\n\n任务是求解非线性方程组 $G(u^{n+1}) = 0$ 以得到未知向量 $u^{n+1} \\in \\mathbb{R}^{2}$。该系统由下式给出\n$$\nG(u^{n+1}) = u^{n+1} - u^{n} - \\Delta t \\Big[(1-\\theta) f(u^{n}) + \\theta f(u^{n+1})\\Big] = 0\n$$\n牛顿法是用于寻找向量值函数 $G(x)=0$ 根的迭代过程。从初始猜测 $x_{(0)}$ 开始，它通过以下更新公式生成一系列近似值 $x_{(k)}$\n$$\nx_{(k+1)} = x_{(k)} - \\left[ J_G(x_{(k)}) \\right]^{-1} G(x_{(k)})\n$$\n其中 $J_G(x) = \\frac{\\partial G}{\\partial x}(x)$ 是 $G$ 在 $x$ 处求值的雅可比矩阵。\n\n在实践中，通常不直接计算雅可比矩阵的逆。而是在每次迭代 $k$ 中，我们求解一个关于更新向量 $\\delta x = x_{(k+1)} - x_{(k)}$ 的线性系统。该线性系统为\n$$\nJ_G(x_{(k)}) \\delta x = -G(x_{(k)})\n$$\n一旦求得 $\\delta x$，下一个近似值就计算为 $x_{(k+1)} = x_{(k)} + \\delta x$。\n\n对于当前具体问题，未知量是 $u^{n+1}$。我们将 $u^{n+1}$ 的第 $k$ 次牛顿迭代记为向量 $u_{(k)}$。一个常见的初始猜测是 $u_{(0)} = u^{n}$。迭代过程如下：\n对于 $k = 0, 1, 2, \\dots$ 直至收敛：\n1.  **计算牛顿更新量** $\\delta u \\in \\mathbb{R}^{2}$。这是迭代的核心，需要求解以下 $2 \\times 2$ 线性系统：\n    $$\n    \\frac{\\partial G}{\\partial u}(u_{(k)}) \\delta u = -G(u_{(k)})\n    $$\n    此处，$\\frac{\\partial G}{\\partial u}(u_{(k)})$ 是在当前迭代值 $u_{(k)}$ 处计算的 $G$ 的雅可比矩阵，而 $G(u_{(k)})$ 是残差向量：\n    $$\n    G(u_{(k)}) = u_{(k)} - u^{n} - \\Delta t \\Big[(1-\\theta) f(u^{n}) + \\theta f(u_{(k)})\\Big]\n    $$\n\n2.  **更新解**：\n    $$\n    u_{(k+1)} = u_{(k)} + \\delta u\n    $$\n重复此迭代过程，直到更新量的范数 $\\|\\delta u\\|$ 或残差的范数 $\\|G(u_{(k+1)})\\|$ 小于预设的容差。\n\n### 第二部分：雅可比矩阵的推导\n\n下一个任务是推导雅可比矩阵 $\\frac{\\partial G}{\\partial u}(u)$ 的解析表达式，为简化表示，这里的 $u$ 代表变量 $u^{n+1}$。函数 $G$ 为\n$$\nG(u) = u - u^{n} - \\Delta t \\Big[(1-\\theta) f(u^{n}) + \\theta f(u)\\Big]\n$$\n为了求雅可比矩阵，我们将 $G(u)$ 对向量 $u$ 求导。项 $u^{n}$ 和 $f(u^{n})$ 对于此求导是常数。\n$$\n\\frac{\\partial G}{\\partial u}(u) = \\frac{\\partial}{\\partial u}(u) - \\frac{\\partial}{\\partial u}(u^{n}) - \\Delta t (1-\\theta) \\frac{\\partial}{\\partial u}(f(u^{n})) - \\Delta t \\theta \\frac{\\partial}{\\partial u}(f(u))\n$$\n常数项的导数为零。$u$ 对自身的导数是单位矩阵 $I \\in \\mathbb{R}^{2 \\times 2}$。\n$$\n\\frac{\\partial G}{\\partial u}(u) = I - 0 - 0 - \\Delta t \\theta \\frac{\\partial f}{\\partial u}(u) = I - \\Delta t \\theta \\frac{\\partial f}{\\partial u}(u)\n$$\n现在我们需要求 $f(u)$ 的雅可比矩阵，其中 $f(u) = \\frac{\\nu}{h^{2}} A u + \\alpha u - \\beta u^{\\odot 3}$。\n函数 $f(u)$ 由一个线性部分和一个非线性部分组成。线性部分 $\\frac{\\nu}{h^{2}} A u + \\alpha u = (\\frac{\\nu}{h^{2}} A + \\alpha I)u$ 的雅可比矩阵就是其矩阵系数：\n$$\n\\frac{\\partial}{\\partial u} \\left(\\frac{\\nu}{h^{2}} A u + \\alpha u\\right) = \\frac{\\nu}{h^{2}} A + \\alpha I\n$$\n非线性部分是 $-\\beta u^{\\odot 3}$。令 $u = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$。则 $-\\beta u^{\\odot 3} = -\\beta \\begin{pmatrix} u_1^3 \\\\ u_2^3 \\end{pmatrix}$。这一项的雅可比矩阵是：\n$$\n\\frac{\\partial}{\\partial u} (-\\beta u^{\\odot 3}) = -\\beta \\begin{pmatrix} \\frac{\\partial(u_1^3)}{\\partial u_1}  \\frac{\\partial(u_1^3)}{\\partial u_2} \\\\ \\frac{\\partial(u_2^3)}{\\partial u_1}  \\frac{\\partial(u_2^3)}{\\partial u_2} \\end{pmatrix} = -\\beta \\begin{pmatrix} 3u_1^2  0 \\\\ 0  3u_2^2 \\end{pmatrix} = -3\\beta \\cdot \\text{diag}(u_1^2, u_2^2)\n$$\n这可以紧凑地写为 $-3\\beta \\cdot \\text{diag}(u^{\\odot 2})$。\n结合 $f(u)$ 各部分的雅可比矩阵：\n$$\n\\frac{\\partial f}{\\partial u}(u) = \\frac{\\nu}{h^{2}} A + \\alpha I - 3\\beta \\cdot \\text{diag}(u^{\\odot 2})\n$$\n最后，将此代入 $\\frac{\\partial G}{\\partial u}(u)$ 的表达式中：\n$$\n\\frac{\\partial G}{\\partial u}(u) = I - \\Delta t \\theta \\left[ \\frac{\\nu}{h^{2}} A + \\alpha I - 3\\beta \\cdot \\text{diag}(u^{\\odot 2}) \\right]\n$$\n分配标量因子，得到雅可比矩阵的最终表达式：\n$$\n\\frac{\\partial G}{\\partial u}(u) = (1 - \\Delta t \\theta \\alpha)I - \\frac{\\Delta t \\theta \\nu}{h^2} A + 3 \\Delta t \\theta \\beta \\cdot \\text{diag}(u^{\\odot 2})\n$$\n\n### 第三部分：行列式的计算\n\n我们需要根据给定的参数值计算雅可比矩阵 $\\frac{\\partial G}{\\partial u}(u^{n+1})$ 的行列式。\n参数如下：\n$L = 3$，$\\nu = 0.5$，$\\alpha = 1$，$\\beta = 2$，$\\Delta t = 0.1$，$\\theta = 0.7$。\n求值点为 $u^{n+1} = \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix}$。\n首先，我们计算网格间距 $h$：\n$h = L/3 = 3/3 = 1$。\n\n接下来，我们计算雅可比表达式中的标量系数：\n单位矩阵 $I$ 的系数：\n$$\n1 - \\Delta t \\theta \\alpha = 1 - (0.1)(0.7)(1) = 1 - 0.07 = 0.93\n$$\n矩阵 $A$ 的系数：\n$$\n-\\frac{\\Delta t \\theta \\nu}{h^2} = -\\frac{(0.1)(0.7)(0.5)}{1^2} = -0.035\n$$\n对角矩阵的系数：\n$$\n3 \\Delta t \\theta \\beta = 3(0.1)(0.7)(2) = 0.42\n$$\n现在，我们根据求值点 $u = u^{n+1}$ 构建对角矩阵项：\n$$\nu^{\\odot 2} = \\begin{pmatrix} (0.1)^2 \\\\ (-0.2)^2 \\end{pmatrix} = \\begin{pmatrix} 0.01 \\\\ 0.04 \\end{pmatrix}\n$$\n所以，完整的对角项为：\n$$\n3 \\Delta t \\theta \\beta \\cdot \\text{diag}(u^{\\odot 2}) = 0.42 \\begin{pmatrix} 0.01  0 \\\\ 0  0.04 \\end{pmatrix} = \\begin{pmatrix} 0.0042  0 \\\\ 0  0.0168 \\end{pmatrix}\n$$\n现在我们可以组装雅可比矩阵，记为 $J_G$：\n$$\nJ_G = 0.93 \\cdot I - 0.035 \\cdot A + \\begin{pmatrix} 0.0042  0 \\\\ 0  0.0168 \\end{pmatrix}\n$$\n代入 $I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$ 和 $A = \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix}$：\n$$\nJ_G = 0.93 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - 0.035 \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} + \\begin{pmatrix} 0.0042  0 \\\\ 0  0.0168 \\end{pmatrix}\n$$\n$$\nJ_G = \\begin{pmatrix} 0.93  0 \\\\ 0  0.93 \\end{pmatrix} + \\begin{pmatrix} 0.07  -0.035 \\\\ -0.035  0.07 \\end{pmatrix} + \\begin{pmatrix} 0.0042  0 \\\\ 0  0.0168 \\end{pmatrix}\n$$\n逐分量相加矩阵：\n$$\nJ_G = \\begin{pmatrix} 0.93 + 0.07 + 0.0042  -0.035 \\\\ -0.035  0.93 + 0.07 + 0.0168 \\end{pmatrix}\n$$\n$$\nJ_G = \\begin{pmatrix} 1.0042  -0.035 \\\\ -0.035  1.0168 \\end{pmatrix}\n$$\n最后，我们计算这个 $2 \\times 2$ 矩阵的行列式：\n$$\n\\det(J_G) = (1.0042)(1.0168) - (-0.035)(-0.035)\n$$\n$$\n\\det(J_G) = 1.02107496 - (0.035)^2\n$$\n$$\n\\det(J_G) = 1.02107496 - 0.001225\n$$\n$$\n\\det(J_G) = 1.01984996\n$$\n题目要求将结果四舍五入到四位有效数字。前四位有效数字是 $1, 0, 1, 9$。第五位数字是 $8$，所以我们将第四位数字向上取整。\n$$\n\\det(J_G) \\approx 1.020\n$$\n在这种情况下，末尾的零是有效数字。",
            "answer": "$$\\boxed{1.020}$$"
        },
        {
            "introduction": "在建立了求解非线性系统的牛顿法框架后，我们面临一个更深层次的问题：如何确保该方法能够稳健收敛，尤其是在处理非光滑或刚性模型时？本练习探讨了正则化技术，它通过平滑处理（例如，用一个光滑函数近似绝对值函数）来改善问题的数学性质。你将通过推导雅可比矩阵的利普希茨常数，深入分析其对回溯线搜索等全局化策略收敛性的影响，从而理解算法设计的理论基础。",
            "id": "3518036",
            "problem": "考虑一个源于多物理场耦合模拟的一维剪切流子问题，其中，关联剪切应力与剪切速率的本构流变关系被正则化以避免不可微性。设剪切应力由以下本构关系建模\n$$\n\\tau = \\eta_{0} \\left( 1 + a \\, |\\dot{\\gamma}|_{\\epsilon} \\right) \\dot{\\gamma},\n$$\n其中 $\\eta_{0}  0$ 是一个参考粘度，$a \\ge 0$ 是一个无量纲剪切增稠系数，$\\dot{\\gamma} \\in \\mathbb{R}$ 是剪切速率，平滑绝对值定义为\n$$\n|\\dot{\\gamma}|_{\\epsilon} = \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}},\n$$\n其中 $\\epsilon  0$。对于一个给定的外部剪切应力 $\\tau^{\\star}$，定义非线性残差为\n$$\nR(\\dot{\\gamma}) = \\eta_{0} \\left( 1 + a \\, \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} \\right) \\dot{\\gamma} - \\tau^{\\star},\n$$\n该方程通过牛顿-拉夫逊（NR）方法求解。令雅可比为 $J(\\dot{\\gamma}) = \\frac{dR}{d\\dot{\\gamma}}(\\dot{\\gamma})$。\n\n从牛顿-拉夫逊方法、可微性和利普希茨连续性的定义出发，推导雅可比 $J(\\dot{\\gamma})$ 在 $\\dot{\\gamma} \\in \\mathbb{R}$ 上的利普希茨常数 $L_{J}$ 的一个精确全局界，其中 $L_{J}$ 是满足以下条件的最小常数\n$$\n|J(\\dot{\\gamma}_{1}) - J(\\dot{\\gamma}_{2})| \\le L_{J} \\, |\\dot{\\gamma}_{1} - \\dot{\\gamma}_{2}| \\quad \\text{for all} \\quad \\dot{\\gamma}_{1}, \\dot{\\gamma}_{2} \\in \\mathbb{R}.\n$$\n你的推导必须明确显示其对 $\\epsilon$ 的任何依赖性，并评估 $\\epsilon$ 是否以及如何改变 $L_{J}$。\n\n接着，考虑一个基于残差平方罚函数 $\\Phi(\\dot{\\gamma}) = \\frac{1}{2} R(\\dot{\\gamma})^{2}$ 和使用带有参数 $\\sigma \\in (0,1)$ 的 Armijo 条件的标准回溯线搜索的全局化策略，当满足以下条件时，该策略接受完整的 NR 步长\n$$\n\\Phi\\big(\\dot{\\gamma} - R(\\dot{\\gamma})/J(\\dot{\\gamma})\\big) \\le \\Phi(\\dot{\\gamma}) - \\sigma \\, R(\\dot{\\gamma})^{2}.\n$$\n仅使用上述基本定义以及你对 $L_{J}$ 的界，推导出一个以 $L_{J}$ 表示的、对 $\\epsilon$ 一致的充分接受条件，并明确说明 $\\epsilon$ 是否影响此条件。你必须将 $L_{J}$ 的精确解析表达式作为最终答案。不需要进行数值计算。",
            "solution": "这个问题分为两个部分。第一部分要求推导雅可比 $J(\\dot{\\gamma})$ 的全局利普希茨常数 $L_J$。第二部分要求基于推导出的 $L_J$，推导在回溯线搜索中接受完整牛顿-拉夫逊步长的充分条件。\n\n首先，我们必须验证问题陈述。\n\n### 第1步：提取已知条件\n- 本构关系：$\\tau = \\eta_{0} \\left( 1 + a \\, |\\dot{\\gamma}|_{\\epsilon} \\right) \\dot{\\gamma}$\n- 参考粘度：$\\eta_{0}  0$\n- 剪切增稠系数：$a \\ge 0$\n- 剪切速率：$\\dot{\\gamma} \\in \\mathbb{R}$\n- 平滑绝对值：$|\\dot{\\gamma}|_{\\epsilon} = \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}$\n- 平滑参数：$\\epsilon  0$\n- 给定的外部剪切应力：$\\tau^{\\star}$\n- 非线性残差：$R(\\dot{\\gamma}) = \\eta_{0} \\left( 1 + a \\, \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} \\right) \\dot{\\gamma} - \\tau^{\\star}$\n- 雅可比：$J(\\dot{\\gamma}) = \\frac{dR}{d\\dot{\\gamma}}(\\dot{\\gamma})$\n- 雅可比的利普希茨常数：$L_{J}$ 是对所有 $\\dot{\\gamma}_{1}, \\dot{\\gamma}_{2} \\in \\mathbb{R}$ 满足 $|J(\\dot{\\gamma}_{1}) - J(\\dot{\\gamma}_{2})| \\le L_{J} \\, |\\dot{\\gamma}_{1} - \\dot{\\gamma}_{2}|$ 的最小常数。\n- 罚函数：$\\Phi(\\dot{\\gamma}) = \\frac{1}{2} R(\\dot{\\gamma})^{2}$\n- 完整步长的 Armijo 条件：$\\Phi\\big(\\dot{\\gamma} - R(\\dot{\\gamma})/J(\\dot{\\gamma})\\big) \\le \\Phi(\\dot{\\gamma}) - \\sigma \\, R(\\dot{\\gamma})^{2}$，其中 $\\sigma \\in (0,1)$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，代表了一个正则化的非牛顿流体模型，这是计算流变学和多物理场中的一个标准课题。对于 $\\epsilon  0$，函数 $R(\\dot{\\gamma})$ 是无穷次可微的（$C^{\\infty}$），确保了雅可比及其导数的良定义性。该问题是适定的，要求推导一个利普希茨常数和一个充分条件，这两者都是数值分析中的标准任务。语言是客观的，定义在数学上是精确且自洽的。没有矛盾或信息缺失。\n\n### 第3步：结论与行动\n问题是有效的。我们可以继续进行求解。\n\n### 第1部分：利普希茨常数 $L_J$ 的推导\n\n雅可比 $J(\\dot{\\gamma})$ 是残差 $R(\\dot{\\gamma})$ 关于剪切速率 $\\dot{\\gamma}$ 的导数。\n$$\nR(\\dot{\\gamma}) = \\eta_{0} \\dot{\\gamma} + \\eta_{0} a \\dot{\\gamma} \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} - \\tau^{\\star}\n$$\n为求得 $J(\\dot{\\gamma})$，我们对 $R(\\dot{\\gamma})$ 求导：\n$$\nJ(\\dot{\\gamma}) = \\frac{dR}{d\\dot{\\gamma}} = \\eta_{0} + \\eta_{0} a \\frac{d}{d\\dot{\\gamma}} \\left(\\dot{\\gamma} \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}\\right)\n$$\n对第二项使用乘法法则：\n$$\n\\frac{d}{d\\dot{\\gamma}} \\left(\\dot{\\gamma} \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}\\right) = (1) \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} + \\dot{\\gamma} \\left(\\frac{2\\dot{\\gamma}}{2\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}}\\right) = \\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} + \\frac{\\dot{\\gamma}^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}}\n$$\n$$\n= \\frac{(\\dot{\\gamma}^{2} + \\epsilon^{2}) + \\dot{\\gamma}^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} = \\frac{2\\dot{\\gamma}^{2} + \\epsilon^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}}\n$$\n将此结果代回 $J(\\dot{\\gamma})$ 的表达式中：\n$$\nJ(\\dot{\\gamma}) = \\eta_{0} + \\eta_{0} a \\left( \\frac{2\\dot{\\gamma}^{2} + \\epsilon^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} \\right)\n$$\n在 $\\mathbb{R}$ 上，可微函数 $J(\\dot{\\gamma})$ 的利普希茨常数 $L_J$ 由其导数绝对值的上确界给出，即 $L_J = \\sup_{\\dot{\\gamma} \\in \\mathbb{R}} |J'(\\dot{\\gamma})|$。我们来计算 $J'(\\dot{\\gamma}) = \\frac{dJ}{d\\dot{\\gamma}}$。\n$$\nJ'(\\dot{\\gamma}) = \\eta_{0} a \\frac{d}{d\\dot{\\gamma}} \\left( \\frac{2\\dot{\\gamma}^{2} + \\epsilon^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} \\right)\n$$\n为了简化求导，我们重写该项：\n$$\n\\frac{2\\dot{\\gamma}^{2} + \\epsilon^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} = \\frac{2(\\dot{\\gamma}^{2} + \\epsilon^{2}) - \\epsilon^{2}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} = 2\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} - \\epsilon^{2}(\\dot{\\gamma}^{2} + \\epsilon^{2})^{-1/2}\n$$\n现在，我们对这个表达式求导：\n$$\n\\frac{d}{d\\dot{\\gamma}} \\left( 2\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}} - \\epsilon^{2}(\\dot{\\gamma}^{2} + \\epsilon^{2})^{-1/2} \\right) = 2 \\frac{\\dot{\\gamma}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} - \\epsilon^{2} \\left(-\\frac{1}{2}(\\dot{\\gamma}^{2} + \\epsilon^{2})^{-3/2} (2\\dot{\\gamma})\\right)\n$$\n$$\n= \\frac{2\\dot{\\gamma}}{\\sqrt{\\dot{\\gamma}^{2} + \\epsilon^{2}}} + \\frac{\\dot{\\gamma}\\epsilon^{2}}{(\\dot{\\gamma}^{2} + \\epsilon^{2})^{3/2}} = \\frac{2\\dot{\\gamma}(\\dot{\\gamma}^{2} + \\epsilon^{2}) + \\dot{\\gamma}\\epsilon^{2}}{(\\dot{\\gamma}^{2} + \\epsilon^{2})^{3/2}} = \\frac{2\\dot{\\gamma}^{3} + 3\\dot{\\gamma}\\epsilon^{2}}{(\\dot{\\gamma}^{2} + \\epsilon^{2})^{3/2}}\n$$\n因此，雅可比的导数为：\n$$\nJ'(\\dot{\\gamma}) = \\eta_{0} a \\left( \\frac{\\dot{\\gamma}(2\\dot{\\gamma}^{2} + 3\\epsilon^{2})}{(\\dot{\\gamma}^{2} + \\epsilon^{2})^{3/2}} \\right)\n$$\n为了找到 $L_J$，我们必须求出 $|J'(\\dot{\\gamma})|$ 的上确界。令 $g(\\dot{\\gamma}) = \\frac{\\dot{\\gamma}(2\\dot{\\gamma}^{2} + 3\\epsilon^{2})}{(\\dot{\\gamma}^{2} + \\epsilon^{2})^{3/2}}$。函数 $g(\\dot{\\gamma})$ 是 $\\dot{\\gamma}$ 的一个奇函数。我们可以通过分析其在 $\\dot{\\gamma} \\to \\infty$ 时的行为来找到其上确界。我们进行变量替换 $u = \\dot{\\gamma}/\\epsilon$。\n$$\ng(\\dot{\\gamma}) = g(\\epsilon u) = \\frac{\\epsilon u(2(\\epsilon u)^{2} + 3\\epsilon^{2})}{((\\epsilon u)^{2} + \\epsilon^{2})^{3/2}} = \\frac{\\epsilon^{3} u(2u^{2} + 3)}{\\epsilon^{3}(u^{2} + 1)^{3/2}} = \\frac{u(2u^{2} + 3)}{(u^{2} + 1)^{3/2}}\n$$\n设这个新函数为 $h(u)$。$|g(\\dot{\\gamma})|$ 在 $\\mathbb{R}$ 上的上确界与 $|h(u)|$ 在 $\\mathbb{R}$ 上的上确界相同。$h(u)$ 的导数是：\n$$\nh'(u) = \\frac{d}{du} \\left( \\frac{2u^3 + 3u}{(u^2 + 1)^{3/2}} \\right) = \\frac{3}{(u^2+1)^{5/2}}\n$$\n由于对所有 $u \\in \\mathbb{R}$ 都有 $h'(u)  0$，函数 $h(u)$ 是单调递增的。其上确界是当 $u \\to \\infty$ 时的极限。\n$$\n\\lim_{u \\to \\infty} h(u) = \\lim_{u \\to \\infty} \\frac{2u^{3} + 3u}{(u^{2} + 1)^{3/2}} = \\lim_{u \\to \\infty} \\frac{u^{3}(2 + 3/u^{2})}{(u^{2}(1 + 1/u^{2}))^{3/2}} = \\lim_{u \\to \\infty} \\frac{u^{3}(2 + 3/u^{2})}{u^{3}(1 + 1/u^{2})^{3/2}} = \\frac{2}{1} = 2\n$$\n由于 $h(u)$ 是奇函数，其下确界是 $\\lim_{u \\to -\\infty} h(u) = -2$。因此，其绝对值的上确界是 $2$。\n$$\n\\sup_{\\dot{\\gamma} \\in \\mathbb{R}} |g(\\dot{\\gamma})| = \\sup_{u \\in \\mathbb{R}} |h(u)| = 2\n$$\n那么，利普希茨常数 $L_J$ 为：\n$$\nL_J = \\sup_{\\dot{\\gamma} \\in \\mathbb{R}} |J'(\\dot{\\gamma})| = \\eta_{0} a \\sup_{\\dot{\\gamma} \\in \\mathbb{R}} |g(\\dot{\\gamma})| = 2 \\eta_{0} a\n$$\n此推导表明，利普希茨常数 $L_J$ 是一个精确界，并且值得注意的是，它与正则化参数 $\\epsilon$ 无关。\n\n### 第2部分：充分接受条件的推导\n\n接受完整牛顿-拉夫逊步长 $p = -R(\\dot{\\gamma})/J(\\dot{\\gamma})$ 的 Armijo 条件由下式给出：\n$$\n\\Phi(\\dot{\\gamma} + p) \\le \\Phi(\\dot{\\gamma}) - \\sigma R(\\dot{\\gamma})^2\n$$\n代入定义 $\\Phi(\\dot{\\gamma}) = \\frac{1}{2}R(\\dot{\\gamma})^2$，条件变为：\n$$\n\\frac{1}{2} R(\\dot{\\gamma} + p)^2 \\le \\frac{1}{2} R(\\dot{\\gamma})^2 - \\sigma R(\\dot{\\gamma})^2 = \\left(\\frac{1}{2} - \\sigma\\right) R(\\dot{\\gamma})^2\n$$\n这要求 $\\sigma  1/2$。如果 $\\sigma \\ge 1/2$，右侧为非正数，不等式只有在 $R(\\dot{\\gamma})=0$ 时才能满足，这意味着我们已经到达解。因此我们假设 $\\sigma \\in (0, 1/2)$。该条件等价于：\n$$\nR(\\dot{\\gamma} + p)^2 \\le (1 - 2\\sigma) R(\\dot{\\gamma})^2\n$$\n为了利用利普希茨常数 $L_J$，我们对新点处的残差 $R(\\dot{\\gamma} + p)$ 进行定界。根据带积分余项的泰勒定理：\n$$\nR(\\dot{\\gamma} + p) = R(\\dot{\\gamma}) + \\int_0^1 J(\\dot{\\gamma} + t p) p \\, dt = R(\\dot{\\gamma}) + J(\\dot{\\gamma})p + \\int_0^1 [J(\\dot{\\gamma} + tp) - J(\\dot{\\gamma})] p \\, dt\n$$\n由于 $p = -R(\\dot{\\gamma})/J(\\dot{\\gamma})$，我们有 $R(\\dot{\\gamma}) + J(\\dot{\\gamma})p = 0$。因此：\n$$\nR(\\dot{\\gamma} + p) = \\int_0^1 [J(\\dot{\\gamma} + tp) - J(\\dot{\\gamma})] p \\, dt\n$$\n取绝对值并对积分使用三角不等式：\n$$\n|R(\\dot{\\gamma} + p)| \\le \\int_0^1 |J(\\dot{\\gamma} + tp) - J(\\dot{\\gamma})| |p| \\, dt\n$$\n使用 $J$ 的利普希茨性质，$|J(\\dot{\\gamma} + tp) - J(\\dot{\\gamma})| \\le L_J |(\\dot{\\gamma} + tp) - \\dot{\\gamma}| = L_J t |p|$：\n$$\n|R(\\dot{\\gamma} + p)| \\le \\int_0^1 (L_J t |p|) |p| \\, dt = L_J |p|^2 \\int_0^1 t \\, dt = \\frac{L_J}{2} |p|^2\n$$\n代入 $p = -R(\\dot{\\gamma})/J(\\dot{\\gamma})$：\n$$\n|R(\\dot{\\gamma} + p)| \\le \\frac{L_J}{2} \\left( \\frac{R(\\dot{\\gamma})}{J(\\dot{\\gamma})} \\right)^2 = \\frac{L_J R(\\dot{\\gamma})^2}{2 J(\\dot{\\gamma})^2}\n$$\n因此，如果我们的 $|R(\\dot{\\gamma} + p)|$ 的上界也满足 Armijo 条件 $R(\\dot{\\gamma} + p)^2 \\le (1 - 2\\sigma) R(\\dot{\\gamma})^2$，则该条件成立：\n$$\n\\left( \\frac{L_J R(\\dot{\\gamma})^2}{2 J(\\dot{\\gamma})^2} \\right)^2 \\le (1 - 2\\sigma) R(\\dot{\\gamma})^2\n$$\n假设我们不在解处，即 $R(\\dot{\\gamma}) \\ne 0$，我们可以除以 $R(\\dot{\\gamma})^2$：\n$$\n\\frac{L_J^2 R(\\dot{\\gamma})^2}{4 J(\\dot{\\gamma})^4} \\le 1 - 2\\sigma\n$$\n这是接受完整牛顿-拉夫逊步长的充分条件。\n\n现在，我们评估 $\\epsilon$ 的影响。\n- 这个条件的推导是通用的，对任何 $\\epsilon  0$ 都成立。\n- 利普希茨常数 $L_J = 2 \\eta_{0} a$ 对 $\\epsilon$ 是一致的（即与 $\\epsilon$ 无关）。\n- 然而，充分条件中的量 $R(\\dot{\\gamma})$ 和 $J(\\dot{\\gamma})$ 都通过项 $\\sqrt{\\dot{\\gamma}^2 + \\epsilon^2}$ 显式地依赖于 $\\epsilon$。对于任意给定的迭代点 $\\dot{\\gamma}$，不等式左侧 $\\frac{L_J^2 R(\\dot{\\gamma})^2}{4 J(\\dot{\\gamma})^4}$ 的数值会随 $\\epsilon$ 而改变。\n- 因此，尽管充分条件的*形式*和常数 $L_J$ 对 $\\epsilon$ 是一致的，但每次迭代中的实际检验*确实*受到 $\\epsilon$ 选择的影响。",
            "answer": "$$ \\boxed{2\\eta_{0}a} $$"
        },
        {
            "introduction": "对于大规模多物理场问题，精确计算和求逆完整的雅可比矩阵往往成本过高。因此，在实际应用中，我们常常采用“非精确牛顿法”。本练习将介绍这一关键的高性能计算概念，你将使用一个分块高斯-赛德尔 (Block Gauss–Seidel) 矩阵来近似真实的雅可比矩阵。通过推导迭代矩阵并分析其谱半径，你将学会如何预测这种实用算法的收敛行为，这是解决复杂工程与科学问题的必备技能。",
            "id": "3518059",
            "problem": "考虑一个源于多物理场模型的耦合非线性系统，其抽象形式为求解向量值函数 $F(x) = 0$ 的根，其中 $x \\in \\mathbb{R}^{n}$，雅可比矩阵为 $J(x) = \\partial F / \\partial x$。在一个分块分区公式中，假设未知向量被分割为 $x = \\begin{bmatrix} x_{1} \\\\ x_{2} \\end{bmatrix}$，相应的残差分区为 $F(x) = \\begin{bmatrix} F_{1}(x_{1}, x_{2}) \\\\ F_{2}(x_{1}, x_{2}) \\end{bmatrix}$，在当前迭代点处的雅可比矩阵表示为\n$$\nJ = \\begin{bmatrix} A  B \\\\ C  D \\end{bmatrix},\n$$\n其中 $A \\in \\mathbb{R}^{n_{1} \\times n_{1}}$，$B \\in \\mathbb{R}^{n_{1} \\times n_{2}}$，$C \\in \\mathbb{R}^{n_{2} \\times n_{1}}$，$D \\in \\mathbb{R}^{n_{2} \\times n_{2}}$。非精确牛顿法用一个近似雅可比矩阵 $M$ 替换精确雅可比矩阵 $J$，以构建一个用于更新的线性模型。在块高斯-赛德尔 (GS) 近似中，使用块下三角矩阵\n$$\nM = \\begin{bmatrix} A  0 \\\\ C  D \\end{bmatrix}。\n$$\n从平滑函数 $F$ 的牛顿线性化基本定义出发：$F(x + \\delta x) \\approx F(x) + J \\, \\delta x$，非精确牛顿更新在每次迭代中求解 $M \\, \\delta x = -F(x)$ 而不是 $J \\, \\delta x = -F(x)$，并应用 $x \\leftarrow x + \\delta x$。该方案在解 $x^\\star$ 附近的局部线性收敛性可以通过分析从 $J$ 和 $M$ 之间的模型误差导出的不动点误差传播算子来预测。\n\n任务：\n1) 从牛顿法和线性化的第一性原理出发，推导非精确牛顿法（使用上述块高斯-赛德尔 (GS) 近似雅可比矩阵 $M$）中将当前线性化误差映射到下一个线性化误差的精确线性算子。用纯粹的 $J$ 和 $M$ 表达式来表示该算子。\n2) 将您的推导应用于给定的块结构，并将该算子简化为以 $A$、$B$、$C$ 和 $D$ 表示的显式块形式。然后，确定其谱如何依赖于这些块。\n3) 实现一个程序，对于一组给定的指定块 $A$、$B$、$C$ 和 $D$ 的测试用例，计算您在第 2 部分中推导出的迭代矩阵的谱半径（特征值绝对值的最大值）。谱半径必须报告为实数。除了明确给出的条件外，您不应假设对称性或交换性。\n4) 使用以下测试套件。所有矩阵都应视为维度一致且无物理单位的实数矩阵。对于每个案例，计算迭代矩阵的谱半径，并将其四舍五入到八位小数。\n- 测试用例 1 (理想情况，弱耦合，方块矩阵)：$A = I_{2}$，$D = I_{2}$，$B = 0.2 \\, I_{2}$，$C = 0.3 \\, I_{2}$。\n- 测试用例 2 (中等耦合，非对称块)：\n  $A = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix}$，\n  $D = \\begin{bmatrix} 3  1 \\\\ 1  2 \\end{bmatrix}$，\n  $B = \\begin{bmatrix} 0.5  0.1 \\\\ 0.2  0.3 \\end{bmatrix}$，\n  $C = \\begin{bmatrix} 0.4  0.0 \\\\ 0.1  0.6 \\end{bmatrix}$。\n- 测试用例 3 (上块非耦合，精确解)：\n  $A = \\begin{bmatrix} 4  1 \\\\ 1  3 \\end{bmatrix}$，\n  $D = \\begin{bmatrix} 2  0.5 \\\\ 0.5  1.5 \\end{bmatrix}$，\n  $B = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$，\n  $C = \\begin{bmatrix} 0.7  -0.2 \\\\ 0.1  0.9 \\end{bmatrix}$。\n- 测试用例 4 (标量块，接近收敛)：$A = [2]$，$D = [5]$，$B = [3.3]$，$C = [3.0]$。\n- 测试用例 5 (标量块，边界情况)：$A = [2]$，$D = [5]$，$B = [2.0]$，$C = [5.0]$。\n- 测试用例 6 (标量块，发散)：$A = [2]$，$D = [5]$，$B = [3.0]$，$C = [3.5]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含六个测试用例的谱半径，按顺序排列，以逗号分隔并用方括号括起来。每个条目必须四舍五入到八位小数。例如，一个包含两个假设结果的输出将如下所示：$\\texttt{[0.12345678,0.87654321]}$。\n- 每个测试用例的答案必须是实数（浮点数）。不应打印任何其他文本。",
            "solution": "用户提供的问题经过严格验证，确认为数值分析领域中一个有效且适定的问题。所有组成部分都是自洽的、科学上合理的，并且是客观陈述的。\n\n该问题要求推导块高斯-赛德尔非精确牛顿法的迭代矩阵，并为几个测试用例计算其谱半径。\n\n### 第 1 部分：通用误差传播算子的推导\n\n设 $x^{(k)}$ 是逼近非线性系统 $F(x) = 0$ 的解 $x^{\\star}$ 的第 $k$ 次迭代。此迭代的误差定义为 $e^{(k)} = x^{(k)} - x^{\\star}$。根据定义，$F(x^{\\star}) = 0$。\n\n$F(x)$ 在解 $x^{\\star}$ 附近的泰勒展开为：\n$$\nF(x^{(k)}) = F(x^{\\star} + e^{(k)}) \\approx F(x^{\\star}) + J(x^{\\star}) e^{(k)}\n$$\n其中 $J(x^{\\star})$ 是 $F$ 在解处求值的雅可比矩阵。由于 $F(x^{\\star}) = 0$，对于足够接近 $x^{\\star}$ 的迭代 $x^{(k)}$，我们有近似关系：\n$$\nF(x^{(k)}) \\approx J e^{(k)}\n$$\n这里，我们将解处的雅可比矩阵表示为 $J = J(x^{\\star})$，并且对于局部收敛性分析，我们假设当前迭代的雅可比矩阵 $J(x^{(k)})$ 近似等于 $J(x^{\\star})$。\n\n非精确牛顿法通过求解线性系统 $M \\, \\delta x^{(k)} = -F(x^{(k)})$ 来定义更新步 $\\delta x^{(k)}$，其中 $M$ 是真实雅可比矩阵 $J$ 的一个近似。然后应用更新 $x^{(k+1)} = x^{(k)} + \\delta x^{(k)}$。\n\n求解 $\\delta x^{(k)}$ 得到 $\\delta x^{(k)} = -M^{-1} F(x^{(k)})$。\n下一次迭代为 $x^{(k+1)} = x^{(k)} - M^{-1} F(x^{(k)})$。\n\n我们现在可以写出下一次迭代的误差表达式，$e^{(k+1)} = x^{(k+1)} - x^{\\star}$：\n$$\ne^{(k+1)} = (x^{(k)} - M^{-1} F(x^{(k)})) - x^{\\star} = (x^{(k)} - x^{\\star}) - M^{-1} F(x^{(k)}) = e^{(k)} - M^{-1} F(x^{(k)})\n$$\n将线性化 $F(x^{(k)}) \\approx J e^{(k)}$ 代入此方程，得到连续误差之间的关系：\n$$\ne^{(k+1)} \\approx e^{(k)} - M^{-1} (J e^{(k)}) = (I - M^{-1} J) e^{(k)}\n$$\n将当前线性化误差映射到下一个的线性算子是矩阵 $G = I - M^{-1} J$，称为迭代矩阵。这完成了第一个任务。\n\n### 第 2 部分：应用于块结构的具体化\n\n我们已知真实雅可比矩阵 $J$ 和近似雅可比矩阵 $M$ 的分块结构：\n$$\nJ = \\begin{bmatrix} A  B \\\\ C  D \\end{bmatrix}, \\quad M = \\begin{bmatrix} A  0 \\\\ C  D \\end{bmatrix}\n$$\n为了找到迭代矩阵 $G = I - M^{-1} J$，我们首先需要计算块下三角矩阵 $M$ 的逆。我们假设对角块 $A$ 和 $D$ 是可逆的，这是该方法适用的标准要求。$M$ 的逆 $M^{-1}$ 也将是块下三角的：\n$$\nM^{-1} = \\begin{bmatrix} A^{-1}  0 \\\\ -D^{-1}CA^{-1}  D^{-1} \\end{bmatrix}\n$$\n这可以通过检查 $M M^{-1} = I$ 来验证。\n\n接下来，我们计算乘积 $M^{-1}J$：\n$$\nM^{-1}J = \\begin{bmatrix} A^{-1}  0 \\\\ -D^{-1}CA^{-1}  D^{-1} \\end{bmatrix} \\begin{bmatrix} A  B \\\\ C  D \\end{bmatrix}\n$$\n$$\nM^{-1}J = \\begin{bmatrix} (A^{-1}A + 0 \\cdot C)  (A^{-1}B + 0 \\cdot D) \\\\ (-D^{-1}CA^{-1}A + D^{-1}C)  (-D^{-1}CA^{-1}B + D^{-1}D) \\end{bmatrix}\n$$\n$$\nM^{-1}J = \\begin{bmatrix} I  A^{-1}B \\\\ (-D^{-1}C + D^{-1}C)  (I - D^{-1}CA^{-1}B) \\end{bmatrix}\n$$\n$$\nM^{-1}J = \\begin{bmatrix} I  A^{-1}B \\\\ 0  I - D^{-1}CA^{-1}B \\end{bmatrix}\n$$\n现在，我们可以找到迭代矩阵 $G$：\n$$\nG = I - M^{-1}J = \\begin{bmatrix} I  0 \\\\ 0  I \\end{bmatrix} - \\begin{bmatrix} I  A^{-1}B \\\\ 0  I - D^{-1}CA^{-1}B \\end{bmatrix}\n$$\n$$\nG = \\begin{bmatrix} 0  -A^{-1}B \\\\ 0  D^{-1}CA^{-1}B \\end{bmatrix}\n$$\n这是迭代矩阵的显式块形式。\n\n块（上或下）三角矩阵的特征值是其对角块特征值的并集。在这种情况下，$G$ 的对角块是零矩阵 $0 \\in \\mathbb{R}^{n_1 \\times n_1}$ 和矩阵 $K = D^{-1}CA^{-1}B \\in \\mathbb{R}^{n_2 \\times n_2}$。\n\n零矩阵的特征值全部为 $0$。因此，$G$ 的谱由以下公式给出：\n$$\n\\text{spec}(G) = \\text{spec}(0) \\cup \\text{spec}(D^{-1}CA^{-1}B) = \\{0\\} \\cup \\text{spec}(D^{-1}CA^{-1}B)\n$$\n非精确牛顿法的收敛性由谱半径 $\\rho(G) = \\max_{\\lambda \\in \\text{spec}(G)} |\\lambda|$ 决定。从上面推导的谱，迭代矩阵的谱半径为：\n$$\n\\rho(G) = \\max(\\{0\\} \\cup \\{|\\lambda| : \\lambda \\in \\text{spec}(D^{-1}CA^{-1}B)\\}) = \\rho(D^{-1}CA^{-1}B)\n$$\n因此，局部收敛率由矩阵乘积 $D^{-1}CA^{-1}B$ 的谱半径决定。\n\n### 第 3 和 4 部分：实现与计算\n\n最后的任务是实现一个程序，为提供的测试用例计算 $\\rho(K)$，其中 $K = D^{-1}CA^{-1}B$。这涉及构建矩阵，执行矩阵乘法和求逆，找到结果矩阵 $K$ 的特征值，并取其绝对值的最大值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the spectral radius of the iteration matrix for a block Gauss-Seidel\n    inexact Newton method for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: happy path, weak coupling, square blocks\n        {\n            \"A\": np.identity(2, dtype=float),\n            \"B\": 0.2 * np.identity(2, dtype=float),\n            \"C\": 0.3 * np.identity(2, dtype=float),\n            \"D\": np.identity(2, dtype=float),\n        },\n        # Test Case 2: moderate coupling, nonsymmetric blocks\n        {\n            \"A\": np.array([[2., 0.], [0., 1.]]),\n            \"B\": np.array([[0.5, 0.1], [0.2, 0.3]]),\n            \"C\": np.array([[0.4, 0.0], [0.1, 0.6]]),\n            \"D\": np.array([[3., 1.], [1., 2.]]),\n        },\n        # Test Case 3: uncoupled upper block, exact solve\n        {\n            \"A\": np.array([[4., 1.], [1., 3.]]),\n            \"B\": np.zeros((2, 2), dtype=float),\n            \"C\": np.array([[0.7, -0.2], [0.1, 0.9]]),\n            \"D\": np.array([[2., 0.5], [0.5, 1.5]]),\n        },\n        # Test Case 4: scalar blocks, near-convergent\n        {\n            \"A\": np.array([[2.]]),\n            \"B\": np.array([[3.3]]),\n            \"C\": np.array([[3.0]]),\n            \"D\": np.array([[5.]]),\n        },\n        # Test Case 5: scalar blocks, boundary\n        {\n            \"A\": np.array([[2.]]),\n            \"B\": np.array([[2.0]]),\n            \"C\": np.array([[5.0]]),\n            \"D\": np.array([[5.]]),\n        },\n        # Test Case 6: scalar blocks, divergent\n        {\n            \"A\": np.array([[2.]]),\n            \"B\": np.array([[3.0]]),\n            \"C\": np.array([[3.5]]),\n            \"D\": np.array([[5.]]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        A, B, C, D = case[\"A\"], case[\"B\"], case[\"C\"], case[\"D\"]\n\n        # The iteration matrix for the error is G, with spectral radius\n        # rho(G) = rho(K), where K = D^{-1} * C * A^{-1} * B.\n        \n        # Calculate matrix K\n        inv_A = np.linalg.inv(A)\n        inv_D = np.linalg.inv(D)\n        \n        K = inv_D @ C @ inv_A @ B\n        \n        # Compute eigenvalues of K.\n        # If K is a 0x0 matrix (empty), its spectrum is empty, and spectral radius is 0.\n        if K.size == 0:\n            spec_rad = 0.0\n        else:\n            eigenvalues = np.linalg.eigvals(K)\n            # Spectral radius is the maximum absolute value of the eigenvalues.\n            spec_rad = np.max(np.abs(eigenvalues))\n        \n        results.append(spec_rad)\n\n    # Format results to eight decimal places and print in the specified format.\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}