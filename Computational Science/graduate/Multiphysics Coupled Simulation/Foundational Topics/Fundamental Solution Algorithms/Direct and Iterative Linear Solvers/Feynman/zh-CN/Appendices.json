{
    "hands_on_practices": [
        {
            "introduction": "在多物理场仿真中，许多问题（如基于能量最小化原理推导的系统）最终会归结为求解对称正定（SPD）线性系统。Cholesky 分解是一种专门针对此类系统的高效且数值稳定的直接解法。通过本练习 ，您将亲手对一个源自热力耦合模型的简化 SPD 矩阵进行 Cholesky 分解，并利用它求解线性方程组，从而掌握这一基本工具。",
            "id": "3503388",
            "problem": "一个双场多物理场模型的单片隐式时间积分将线性各向同性热传导与线性弹性小应变力学耦合起来。在一个牛顿步上对弱形式进行线性化，会产生一个用于增量更新的对称正定（SPD）线性系统，其中系统矩阵来自于凸能量泛函的Hessian矩阵。在一个对应于Schur补凝聚界面的简化的双自由度设置中，线性系统为 $A x = b$，其中\n$$\nA = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}, \\quad b = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}.\n$$\n从对称正定性的定义以及SPD矩阵存在Cholesky分解出发，将矩阵 $A$ 分解为 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素严格为正的下三角矩阵，然后使用前向和后向代换求解 $x$。在适当的情况下，用根式精确表示所有中间量，并明确报告最终的解向量 $x$。无需四舍五入。将最终的 $x$ 以行向量的形式给出。",
            "solution": "在尝试任何求解之前，对问题进行验证。\n\n**步骤1：提取已知条件**\n- 背景是一个双场多物理场（热-力）模型的单片隐式时间积分。\n- 得到的线性系统是对称正定（SPD）的。\n- 线性系统由 $A x = b$ 给出。\n- 系统矩阵为 $A = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}$。\n- 右端向量为 $b = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}$。\n- 任务是将 $A$ 分解为 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素严格为正的下三角矩阵。\n- 指定的求解方法是使用Cholesky因子进行前向和后向代换。\n- 所有中间量和最终量都必须精确表示。\n- 最终解向量 $x$ 需要以行向量的形式报告。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是适定的且有科学依据。\n1.  **科学合理性**：该问题描述了计算力学中的一个标准程序，其中基于凸能量泛函的变分问题的线性化会产生一个对称正定（SPD）的线性系统。我们验证给定矩阵 $A$ 的SPD性质。\n    -   **对称性**：矩阵 $A$ 是对称的，因为 $A_{12} = A_{21} = 2$。\n    -   **正定性**：我们检查顺序主子式。第一个子式是 $\\det([4]) = 4  0$。第二个子式是 $\\det(A) = (4)(3) - (2)(2) = 12 - 4 = 8  0$。由于所有顺序主子式都为正，矩阵 $A$ 确实是正定的。\n2.  **适定性**：由于 $A$ 是SPD矩阵，它是非奇异的（$\\det(A) \\neq 0$），这保证了系统 $A x = b$ 存在唯一解 $x$。实对称正定矩阵的Cholesky分解是唯一的，确保了明确的求解路径。\n3.  **完整性**：所有必要的组成部分（$A$ 和 $b$）都已提供。指令清晰明确。\n\n**步骤3：结论与行动**\n该问题有效。将制定一个完整的解决方案。\n\n该问题要求使用Cholesky分解求解线性系统 $A x = b$。给定矩阵 $A$ 是对称且正定的，这保证了存在一个唯一的、对角线元素严格为正的下三角矩阵 $L$，使得 $A = L L^{\\top}$。\n\n待求解的系统是：\n$$\n\\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}\n$$\n\n首先，我们计算Cholesky分解 $A = L L^{\\top}$。设下三角矩阵 $L$ 为\n$$\nL = \\begin{bmatrix} L_{11}  0 \\\\ L_{21}  L_{22} \\end{bmatrix}\n$$\n其中 $L_{11}  0$ 且 $L_{22}  0$。\n\n那么 $L L^{\\top}$ 是：\n$$\nL L^{\\top} = \\begin{bmatrix} L_{11}  0 \\\\ L_{21}  L_{22} \\end{bmatrix} \\begin{bmatrix} L_{11}  L_{21} \\\\ 0  L_{22} \\end{bmatrix} = \\begin{bmatrix} L_{11}^2  L_{11}L_{21} \\\\ L_{21}L_{11}  L_{21}^2 + L_{22}^2 \\end{bmatrix}\n$$\n将 $L L^{\\top}$ 的分量与 $A$ 的分量相等：\n$$\n\\begin{bmatrix} L_{11}^2  L_{11}L_{21} \\\\ L_{21}L_{11}  L_{21}^2 + L_{22}^2 \\end{bmatrix} = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}\n$$\n我们按顺序求解 $L$ 的元素：\n1.  从 $(1,1)$ 元素：$L_{11}^2 = 4$。由于 $L_{11}$ 必须为正，所以 $L_{11} = 2$。\n2.  从 $(2,1)$ 元素：$L_{21}L_{11} = 2$。代入 $L_{11}=2$，我们得到 $2 L_{21} = 2$，解得 $L_{21} = 1$。\n3.  从 $(2,2)$ 元素：$L_{21}^2 + L_{22}^2 = 3$。代入 $L_{21}=1$，我们得到 $1^2 + L_{22}^2 = 3$，所以 $L_{22}^2 = 2$。由于 $L_{22}$ 必须为正，所以 $L_{22} = \\sqrt{2}$。\n\n因此，Cholesky因子 $L$ 是：\n$$\nL = \\begin{bmatrix} 2  0 \\\\ 1  \\sqrt{2} \\end{bmatrix}\n$$\n原始系统 $A x = b$ 现在被重写为 $L L^{\\top} x = b$。这可以通过两个步骤求解：\n1.  求解 $L y = b$ 得到中间向量 $y$（前向代换）。\n2.  求解 $L^{\\top} x = y$ 得到最终解向量 $x$（后向代换）。\n\n**步骤1：前向代换**\n我们求解系统 $L y = b$：\n$$\n\\begin{bmatrix} 2  0 \\\\ 1  \\sqrt{2} \\end{bmatrix} \\begin{bmatrix} y_1 \\\\ y_2 \\end{bmatrix} = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}\n$$\n从第一行：\n$$\n2 y_1 = 6 \\implies y_1 = 3\n$$\n从第二行：\n$$\ny_1 + \\sqrt{2} y_2 = 5\n$$\n代入 $y_1=3$：\n$$\n3 + \\sqrt{2} y_2 = 5 \\implies \\sqrt{2} y_2 = 2 \\implies y_2 = \\frac{2}{\\sqrt{2}} = \\sqrt{2}\n$$\n中间向量是 $y = \\begin{bmatrix} 3 \\\\ \\sqrt{2} \\end{bmatrix}$。\n\n**步骤2：后向代换**\n我们求解系统 $L^{\\top} x = y$：\n$$\n\\begin{bmatrix} 2  1 \\\\ 0  \\sqrt{2} \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} = \\begin{bmatrix} 3 \\\\ \\sqrt{2} \\end{bmatrix}\n$$\n从第二行（从最后一个变量开始向后求解）：\n$$\n\\sqrt{2} x_2 = \\sqrt{2} \\implies x_2 = 1\n$$\n从第一行：\n$$\n2 x_1 + x_2 = 3\n$$\n代入 $x_2=1$：\n$$\n2 x_1 + 1 = 3 \\implies 2 x_1 = 2 \\implies x_1 = 1\n$$\n解向量是 $x = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n按照要求，最终解以行向量的形式报告。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "并非所有在多物理场耦合中遇到的对称矩阵都是正定的；不定系统也十分常见，尤其是在涉及鞍点问题或强耦合项时。在这种情况下，标准的 Cholesky 分解会失效。本练习  将揭示 Cholesky 分解失败的根本原因，并引导您通过对称主元选择和 $LDL^{T}$ 分解来稳定地求解一个对称不定系统，展示直接求解器在更广泛问题上的适应性。",
            "id": "3503367",
            "problem": "在单体多物理场耦合模拟中，线性化过程通常会为耦合增量产生对称但不定（indefinite）的雅可比块。考虑一个简化的 $2 \\times 2$ 对称系统\n$$\nA \\, \\mathbf{u} = \\mathbf{b}, \\quad A = \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix},\n$$\n该系统作为一个双场耦合的简化模型出现，其中非对角线项代表了物理场间的耦合。你需要使用直接求解器的第一性原理来分析该系统的求解器选择。\n\n任务：\n1. 从对称正定（SPD）的定义出发，即对称矩阵 $A$ 是SPD的充要条件是对于所有非零向量 $\\mathbf{x}$ 都有 $\\mathbf{x}^{T} A \\mathbf{x}  0$，或者等价地，所有顺序主子式（leading principal minors）都为正。请说明为什么标准的Cholesky分解（需要SPD条件）对矩阵 $A$ 不适用。\n2. 使用对称不定分解的定义，构造一个带有对称主元选择（symmetric pivoting）的显式下三角-对角-下三角转置（LDL$^{T}$）分解。也就是说，找到一个置换矩阵 $P$、一个单位下三角矩阵 $L$（对角线元素为1）以及一个由 $1 \\times 1$ 块组成的块对角矩阵 $D$，使得\n$$\nP^{T} A P = L D L^{T}.\n$$\n请手动显式地进行分解，展示所有遵循带对称置换的高斯消去法的中间步骤。\n\n将你从分解中得到的 $D$ 的 $(1,1)$ 对角线元素的值作为最终答案。不需要四舍五入。请以纯数字形式提供最终答案，不带单位。",
            "solution": "问题要求对一个给定的 $2 \\times 2$ 对称不定矩阵 $A$ 进行求解器选择分析，具体方法是证明Cholesky分解的失败，然后构造一个对称不定分解 $P^T A P = L D L^T$。\n\n给定的矩阵是：\n$$\nA = \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix}\n$$\n\n**任务1：Cholesky分解失败的理由**\n\n标准的Cholesky分解 $A = R^T R$（或 $A=LL^T$），其中 $R$ 是上三角矩阵，$L$ 是下三角矩阵，仅当矩阵 $A$ 是对称正定（SPD）时才适用。一个对称矩阵被定义为SPD，如果它满足某些等价条件。我们将使用问题描述中提到的两个条件来证明 $A$ 不是SPD。\n\n首先，如果对于每一个非零向量 $\\mathbf{x} \\in \\mathbb{R}^n$，二次型 $\\mathbf{x}^T A \\mathbf{x}  0$ 都成立，那么对称矩阵 $A$ 就是SPD。我们来检验给定矩阵 $A$ 是否满足这个条件。我们可以选择一个非零向量 $\\mathbf{x}$，例如 $\\mathbf{x} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。二次型为：\n$$\n\\mathbf{x}^{T} A \\mathbf{x} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(1)  (1)(1) + (0)(1) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = (0)(1) + (1)(0) = 0\n$$\n由于我们找到了一个非零向量 $\\mathbf{x}$，使得 $\\mathbf{x}^T A \\mathbf{x}$ 不严格为正，因此矩阵 $A$ 不是正定的。实际上，它是不定的，因为我们也可以找到一个向量使得二次型为负，例如，对于 $\\mathbf{x} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$：\n$$\n\\mathbf{x}^{T} A \\mathbf{x} = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = -1  0\n$$\n\n其次，一个对称矩阵是SPD的等价条件是其所有顺序主子式都必须为正。一个 $n \\times n$ 矩阵的顺序主子式是指其左上角 $k \\times k$ 子矩阵的行列式，其中 $k = 1, \\dots, n$。\n对于我们的矩阵 $A$，第一个顺序主子式 $M_1$ 是左上角 $1 \\times 1$ 子矩阵的行列式，即元素 $A_{11}$。\n$$\nM_1 = \\det([0]) = 0\n$$\n所有顺序主子式必须为正的条件在第一步就被违反了，因为 $M_1 = 0$。为完整起见，第二个顺序主子式是 $A$ 本身的行列式：\n$$\nM_2 = \\det(A) = (0)(1) - (1)(1) = -1\n$$\n这个值也不是正数。由于并非所有顺序主子式都为正，所以 $A$ 不是SPD。\n\n因为矩阵 $A$ 不是对称正定的，所以标准的Cholesky分解无法应用。\n\n**任务2：构造带对称主元选择的 $LDL^T$ 分解**\n\n我们被要求找到一个置换矩阵 $P$、一个单位下三角矩阵 $L$ 和一个对角矩阵 $D$，使得 $P^T A P = L D L^T$。这种分解是针对对称矩阵的高斯消去法的一种变体。\n\n过程从矩阵 $A$ 开始：\n$$\nA = \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix}\n$$\n不带主元选择的标准算法会选择 $(1,1)$ 元 $A_{11}=0$ 作为第一个主元。零主元是不允许的，因为它会导致除以零。因此，主元选择是必要的。对于对称矩阵，我们使用对称主元选择以保持对称性。这涉及到交换第 $i$ 行与第 $j$ 行，以及第 $i$ 列与第 $j$ 列。我们需要将一个非零元素移动到 $(1,1)$ 的主元位置。元素 $A_{22}=1$ 是一个合适的候选。我们可以交换第1行和第2行，以及第1列和第2列。\n\n这个置换由置换矩阵 $P$ 表示：\n$$\nP = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\n$$\n注意 $P$ 是对称的，所以 $P^T = P$。我们现在构建置换后的矩阵 $A' = P^T A P$：\n$$\nA' = P A P = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  0 \\end{bmatrix}\n$$\n现在我们来求 $A' = \\begin{bmatrix} 1  1 \\\\ 1  0 \\end{bmatrix}$ 的 $LDL^T$ 分解。我们要寻找 $L = \\begin{bmatrix} 1  0 \\\\ l_{21}  1 \\end{bmatrix}$ 和 $D = \\begin{bmatrix} d_1  0 \\\\ 0  d_2 \\end{bmatrix}$。\n\n分解过程逐步进行，类似于高斯消去法。\n**步骤 1：**\n第一个主元是 $A'$ 的 $(1,1)$ 元素，它成为 $D$ 的第一个对角元素。\n$$\nd_1 = A'_{11} = 1\n$$\n计算用于消去 $A'$ 的 $(2,1)$ 元素的乘数。这个乘数成为 $L$ 的 $(2,1)$ 元素。\n$$\nl_{21} = \\frac{A'_{21}}{d_1} = \\frac{1}{1} = 1\n$$\n我们更新剩余的子矩阵。在这个 $2 \\times 2$ 的情况下，这只是 $(2,2)$ 元素。更新规则是 $A'_{22, \\text{new}} = A'_{22, \\text{old}} - l_{21} d_1 l_{21}^T$。对于通用算法，舒尔补（Schur complement）的更新方式为 $S = A'_{22} - \\frac{A'_{12}A'_{21}}{A'_{11}}$。由于 $A'$ 是对称的，这可以写成 $S = A'_{22} - \\frac{(A'_{21})^2}{d_1}$。这个更新后的值成为 $d_2$。\n$$\nd_2 = A'_{22} - \\frac{(A'_{21})^2}{d_1} = 0 - \\frac{1^2}{1} = -1\n$$\n\n因此，分解完成。这些矩阵是：\n$$\nP = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}, \\quad L = \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}, \\quad D = \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix}\n$$\n我们可以验证结果：\n$$\nL D L^T = \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 1  -1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  0 \\end{bmatrix}= P^T A P\n$$\n分解是正确的。\n\n问题要求的是 $D$ 的 $(1,1)$ 对角元素的值。从我们构造的矩阵 $D$ 中，这个值是 $d_1$。\n$$\nd_1 = 1\n$$",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "对于大型稀疏线性系统，迭代法通常比直接法更具优势。预条件共轭梯度（PCG）法是求解对称正定系统的基石算法之一，它通过在 A-共轭方向上进行搜索来迭代地逼近精确解。本练习  要求您从第一性原理出发，推导并应用 PCG 算法，并结合对角缩放这种简单的预条件子，亲身体验预条件技术如何显著加速收敛过程。",
            "id": "3503384",
            "problem": "一个在多物理场模拟中出现的双场耦合扩散-反应模型，在对界面未知量进行静态凝聚后，导出一个形如 $A x = b$ 的对称正定舒尔补线性系统。在一个保留了耦合算子的基本代数特征以及块雅可比预条件子的分离物理场缩放特性的简化测试问题中，考虑\n$$\nA=\\begin{bmatrix} 4  1 \\\\ 1  3 \\end{bmatrix},\\quad b=\\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix},\n$$\n并令预条件子为对角缩放 $M=\\mathrm{diag}(A)=\\mathrm{diag}(4,3)$，这在每个物理场都由其自身的刚度进行缩放时是常见的做法。从 $x_{0}=\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ 开始，应用两轮预条件共轭梯度（PCG）法。PCG（预条件共轭梯度）法需要从第一性原理出发进行构建，即将解视为二次能量泛函 $\\phi(x)=\\tfrac{1}{2}x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 在逐次仿射克雷洛夫子空间中的最小化子，其搜索方向的选择要强制满足 $A$-共轭性，步长则通过在 $M^{-1}$ 加权框架下的线搜索最小化来确定。你的任务是：\n- 从这些原理中推导出你所需要的更新关系式（而不是直接引用现成的算法公式），并\n- 从 $x_{0}$ 开始，精确执行两轮迭代。\n\n报告残差 $r_{k}=b-Ax_{k}$（$k=0,1,2$）的欧几里得范数，以精确值的形式。最终答案必须是三个残差范数 $\\|r_{0}\\|_{2}$、$\\|r_{1}\\|_{2}$ 和 $\\|r_{2}\\|_{2}$，以精确表达式形式给出。不要四舍五入。",
            "solution": "该问题被验证为是适定的、有科学依据的，并且没有任何不一致或模糊之处。矩阵 $A = \\begin{bmatrix} 4  1 \\\\ 1  3 \\end{bmatrix}$ 是对称正定的，因为其主子式为 $4  0$ 和 $\\det(A) = 4 \\times 3 - 1 \\times 1 = 11  0$。预条件子 $M = \\mathrm{diag}(A) = \\begin{bmatrix} 4  0 \\\\ 0  3 \\end{bmatrix}$ 也是对称正定的。这些条件确保了预条件共轭梯度（PCG）法是适用的，并且保证收敛。\n\n首先，我们从指定的第一性原理推导 PCG 算法。线性系统 $Ax=b$ 的解等价于二次能量泛函 $\\phi(x) = \\frac{1}{2}x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 的唯一最小化子。该泛函的梯度是 $\\nabla \\phi(x) = Ax - b$，我们将其定义为负残差，即 $-r(x)$。\n\nPCG 方法是一个迭代过程，它生成一个近似序列 $x_k$，这些近似值在不断扩大的仿射子空间上最小化 $\\phi(x)$。每一步的更新由 $x_{k+1} = x_k + \\alpha_k p_k$ 给出，其中 $p_k$ 是搜索方向，$\\alpha_k$ 是步长。\n\n步长 $\\alpha_k$ 的选择是为了沿方向 $p_k$ 最小化 $\\phi(x_k + \\alpha_k p_k)$。这是一个一维最小化问题（线搜索）。我们将关于 $\\alpha$ 的导数设为零：\n$$\n\\frac{d}{d\\alpha} \\phi(x_k + \\alpha p_k) \\Big|_{\\alpha=\\alpha_k} = p_k^{\\mathsf{T}} (A(x_k + \\alpha_k p_k) - b) = 0\n$$\n$$\np_k^{\\mathsf{T}} (Ax_k - b + \\alpha_k A p_k) = 0\n$$\n$$\np_k^{\\mathsf{T}} (-r_k + \\alpha_k A p_k) = 0\n$$\n求解 $\\alpha_k$ 得到最优步长：\n$$\n\\alpha_k = \\frac{p_k^{\\mathsf{T}} r_k}{p_k^{\\mathsf{T}} A p_k}\n$$\n搜索方向 $\\{p_k\\}$ 被选择为 $A$-共轭的，即对于 $i \\neq j$ 有 $p_i^{\\mathsf{T}} A p_j = 0$。此性质保证了在第 $k$ 步对扩展搜索空间的最小化不会破坏先前步骤的最小化结果。\n\n在算法的预处理版本中，搜索方向是使用预处理残差 $z_k = M^{-1}r_k$ 构建的。初始搜索方向为 $p_0 = z_0$。后续方向的构建方法是使新的预处理残差 $z_{k+1}$ 与前一个搜索方向 $p_k$ $A$-共轭。这通过一个类似格拉姆-施密特的过程来实现：\n$$\np_{k+1} = z_{k+1} + \\beta_{k+1} p_k\n$$\n我们强制执行 $A$-共轭条件 $p_{k+1}^{\\mathsf{T}} A p_k = 0$：\n$$\n(z_{k+1} + \\beta_{k+1} p_k)^{\\mathsf{T}} A p_k = 0 \\implies z_{k+1}^{\\mathsf{T}} A p_k + \\beta_{k+1} p_k^{\\mathsf{T}} A p_k = 0\n$$\n这给出了系数 $\\beta_{k+1} = -\\frac{z_{k+1}^{\\mathsf{T}} A p_k}{p_k^{\\mathsf{T}} A p_k}$。\n\n为了计算效率，$\\alpha_k$ 和 $\\beta_k$ 的这些表达式被简化了。残差具有性质 $r_k^{\\mathsf{T}} z_j = 0$ (对于 $j  k$)。由 $p_j = z_j + \\beta_j p_{j-1}$ 可知，$p_j$ 位于 $\\{z_0, \\dots, z_j\\}$ 的张成空间中，因此对于 $j  k$ 有 $r_k^{\\mathsf{T}} p_j = 0$。\n利用这个性质，$\\alpha_k$ 的分子变为：\n$p_k^{\\mathsf{T}} r_k = (z_k + \\beta_k p_{k-1})^{\\mathsf{T}} r_k = z_k^{\\mathsf{T}} r_k + \\beta_k p_{k-1}^{\\mathsf{T}} r_k = z_k^{\\mathsf{T}} r_k + 0 = r_k^{\\mathsf{T}} z_k$。\n所以，$\\alpha_k = \\frac{r_k^{\\mathsf{T}} z_k}{p_k^{\\mathsf{T}} A p_k}$。\n\n对于 $\\beta_{k+1}$，我们使用残差更新公式 $r_{k+1} = r_k - \\alpha_k A p_k$，这意味着 $A p_k = \\frac{1}{\\alpha_k}(r_k - r_{k+1})$。\n$\\beta_{k+1}$ 表达式的分子变为：\n$z_{k+1}^{\\mathsf{T}} A p_k = z_{k+1}^{\\mathsf{T}} \\frac{1}{\\alpha_k}(r_k - r_{k+1}) = \\frac{1}{\\alpha_k} (r_{k+1}^{\\mathsf{T}} M^{-1} r_k - r_{k+1}^{\\mathsf{T}} M^{-1} r_{k+1})$。\n$z_j$ 是 $M$-自伴的，残差是 $M^{-1}$-正交的，即 $r_{k+1}^{\\mathsf{T}} M^{-1} r_k =0$。因此分子简化为 $-\\frac{1}{\\alpha_k} r_{k+1}^{\\mathsf{T}} z_{k+1}$。\n分母是 $p_k^{\\mathsf{T}} A p_k = \\frac{r_k^{\\mathsf{T}} z_k}{\\alpha_k}$。\n因此，$\\beta_{k+1} = \\frac{-r_{k+1}^{\\mathsf{T}} z_{k+1} / \\alpha_k}{r_k^{\\mathsf{T}} z_k / \\alpha_k} = \\frac{r_{k+1}^{\\mathsf{T}} z_{k+1}}{r_k^{\\mathsf{T}} z_k}$。\n\n要实现的 PCG 算法如下：\n1. $r_0 = b - Ax_0$\n2. $z_0 = M^{-1}r_0$\n3. $p_0 = z_0$\n4. 对于 $k=0, 1, \\dots$：\n   a. $\\alpha_k = \\frac{r_k^{\\mathsf{T}} z_k}{p_k^{\\mathsf{T}} A p_k}$\n   b. $x_{k+1} = x_k + \\alpha_k p_k$\n   c. $r_{k+1} = r_k - \\alpha_k A p_k$\n   d. $z_{k+1} = M^{-1} r_{k+1}$\n   e. $\\beta_{k+1} = \\frac{r_{k+1}^{\\mathsf{T}} z_{k+1}}{r_k^{\\mathsf{T}} z_k}$\n   f. $p_{k+1} = z_{k+1} + \\beta_{k+1} p_k$\n\n我们现在用给定的数据执行两轮迭代：\n$A=\\begin{bmatrix}4  1 \\\\ 1  3\\end{bmatrix}$, $b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}$, $M=\\begin{bmatrix}4  0 \\\\ 0  3\\end{bmatrix}$, $M^{-1}=\\begin{bmatrix}1/4  0 \\\\ 0  1/3\\end{bmatrix}$, $x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$。\n\n**迭代 $k=0$**\n$r_0 = b - A x_0 = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} - \\begin{bmatrix}0 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}$。\n欧几里得范数是 $\\|r_0\\|_2 = \\sqrt{1^2+1^2} = \\sqrt{2}$。\n\n$z_0 = M^{-1} r_0 = \\begin{bmatrix}1/4  0 \\\\ 0  1/3\\end{bmatrix} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} = \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix}$。\n$p_0 = z_0 = \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix}$。\n\n$\\alpha_0$ 的分子： $r_0^{\\mathsf{T}} z_0 = \\begin{bmatrix}1  1\\end{bmatrix} \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix} = \\frac{1}{4} + \\frac{1}{3} = \\frac{7}{12}$。\n$\\alpha_0$ 的分母：\n$A p_0 = \\begin{bmatrix}4  1 \\\\ 1  3\\end{bmatrix} \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix} = \\begin{bmatrix}1+1/3 \\\\ 1/4+1\\end{bmatrix} = \\begin{bmatrix}4/3 \\\\ 5/4\\end{bmatrix}$。\n$p_0^{\\mathsf{T}} A p_0 = \\begin{bmatrix}1/4  1/3\\end{bmatrix} \\begin{bmatrix}4/3 \\\\ 5/4\\end{bmatrix} = \\frac{1}{4}\\frac{4}{3} + \\frac{1}{3}\\frac{5}{4} = \\frac{1}{3} + \\frac{5}{12} = \\frac{4+5}{12} = \\frac{9}{12} = \\frac{3}{4}$。\n$\\alpha_0 = \\frac{7/12}{3/4} = \\frac{7}{12} \\cdot \\frac{4}{3} = \\frac{7}{9}$。\n\n$x_1 = x_0 + \\alpha_0 p_0 = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix} + \\frac{7}{9}\\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix} = \\begin{bmatrix}7/36 \\\\ 7/27\\end{bmatrix}$。\n$r_1 = r_0 - \\alpha_0 A p_0 = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} - \\frac{7}{9}\\begin{bmatrix}4/3 \\\\ 5/4\\end{bmatrix} = \\begin{bmatrix}1 - 28/27 \\\\ 1 - 35/36\\end{bmatrix} = \\begin{bmatrix}-1/27 \\\\ 1/36\\end{bmatrix}$。\n欧几里得范数是 $\\|r_1\\|_2 = \\sqrt{(-\\frac{1}{27})^2 + (\\frac{1}{36})^2} = \\sqrt{\\frac{1}{729} + \\frac{1}{1296}} = \\sqrt{\\frac{16+9}{11664}} = \\sqrt{\\frac{25}{11664}} = \\frac{5}{108}$。\n\n**迭代 $k=1$**\n$z_1 = M^{-1} r_1 = \\begin{bmatrix}1/4  0 \\\\ 0  1/3\\end{bmatrix} \\begin{bmatrix}-1/27 \\\\ 1/36\\end{bmatrix} = \\begin{bmatrix}-1/108 \\\\ 1/108\\end{bmatrix}$。\n\n$\\beta_1$ 的分子：$r_1^{\\mathsf{T}} z_1 = \\begin{bmatrix}-1/27  1/36\\end{bmatrix} \\begin{bmatrix}-1/108 \\\\ 1/108\\end{bmatrix} = \\frac{1}{27 \\cdot 108} + \\frac{1}{36 \\cdot 108} = \\frac{4+3}{108 \\cdot 108} = \\frac{7}{11664}$。\n$\\beta_1$ 的分母是 $r_0^{\\mathsf{T}} z_0 = 7/12$。\n$\\beta_1 = \\frac{r_1^{\\mathsf{T}} z_1}{r_0^{\\mathsf{T}} z_0} = \\frac{7/11664}{7/12} = \\frac{12}{11664} = \\frac{1}{972}$。\n\n$p_1 = z_1 + \\beta_1 p_0 = \\begin{bmatrix}-1/108 \\\\ 1/108\\end{bmatrix} + \\frac{1}{972}\\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix} = \\begin{bmatrix}-1/108+1/3888 \\\\ 1/108+1/2916\\end{bmatrix} = \\begin{bmatrix}(-36+1)/3888 \\\\ (27+1)/2916\\end{bmatrix} = \\begin{bmatrix}-35/3888 \\\\ 28/2916\\end{bmatrix} = \\begin{bmatrix}-35/3888 \\\\ 7/729\\end{bmatrix}$。\n\n$\\alpha_1$ 的分子：$r_1^{\\mathsf{T}} z_1 = 7/11664$。\n$\\alpha_1$ 的分母：\n$A p_1 = \\begin{bmatrix}4  1 \\\\ 1  3\\end{bmatrix} \\begin{bmatrix}-35/3888 \\\\ 7/729\\end{bmatrix} = \\frac{77}{972} \\begin{bmatrix} -1/3 \\\\ 1/4 \\end{bmatrix}$ (从推导过程)。\n$p_1^{\\mathsf{T}} A p_1 = \\frac{1}{972} \\begin{bmatrix} -35/4  28/3 \\end{bmatrix} \\frac{77}{972} \\begin{bmatrix} -1/3 \\\\ 1/4 \\end{bmatrix} = \\frac{77}{972^2} \\left( \\frac{35}{12} + \\frac{28}{12} \\right) = \\frac{77 \\cdot 63}{972^2 \\cdot 12} = \\frac{539 \\cdot 9}{944784 \\cdot 12} = \\frac{539}{12 \\cdot 14608} = \\frac{539}{175296}$。\n$\\alpha_1 = \\frac{r_1^{\\mathsf{T}} z_1}{p_1^{\\mathsf{T}} A p_1} = \\frac{7/11664}{p_1^{\\mathsf{T}} A p_1} = \\frac{108}{77}$ (从理论推导)。\n\n$r_2 = r_1 - \\alpha_1 A p_1 = \\begin{bmatrix}-1/27 \\\\ 1/36\\end{bmatrix} - \\frac{108}{77} \\left( \\frac{77}{108} \\begin{bmatrix}-1/27 \\\\ 1/36\\end{bmatrix} \\right) = \\begin{bmatrix}-1/27 \\\\ 1/36\\end{bmatrix} - \\begin{bmatrix}-1/27 \\\\ 1/36\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$。\n欧几里得范数是 $\\|r_2\\|_2 = \\sqrt{0^2+0^2}=0$。这是预料之中的，因为对于一个 $n \\times n$ 的系统，PCG 方法在至多 $n=2$ 次迭代内收敛。\n\n$k=0,1,2$ 的残差的欧几里得范数是：\n$\\|r_0\\|_2 = \\sqrt{2}$\n$\\|r_1\\|_2 = \\frac{5}{108}$\n$\\|r_2\\|_2 = 0$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{2}  \\frac{5}{108}  0 \\end{pmatrix}}\n$$"
        }
    ]
}