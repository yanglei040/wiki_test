{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex, time-varying phenomena, it is essential to master the foundational static cases of Maxwell's equations. This practice provides a rigorous exercise in applying magnetostatic principles to derive an exact analytical solution for the magnetic field of a finite solenoid . Mastering such derivations builds deep physical insight and provides invaluable benchmarks for verifying the accuracy of numerical simulation software.",
            "id": "3514106",
            "problem": "A long, thin-walled solenoid of finite length is modeled for magnetostatic analysis in a multiphysics coupled simulation, where electromagnetic fields are decoupled from mechanical and thermal fields due to steady direct current and negligible Joule heating. The solenoid has radius $a$, total length $\\ell$, and $N$ tightly packed turns carrying a steady current $I$ in the azimuthal direction, producing an effective surface current density on the cylindrical shell. Assume free space surrounds the solenoid so that the magnetic response is linear and isotropic with $\\mathbf{B}=\\mu_{0}\\mathbf{H}$. The solenoid’s axis is aligned with the $z$-axis and spans from $z=-\\ell/2$ to $z=+\\ell/2$. \n\nStarting from the magnetostatic Maxwell equations $\\nabla\\times\\mathbf{H}=\\mathbf{J}_{f}$ and $\\nabla\\cdot\\mathbf{B}=0$, and using only well-tested results that can be derived from these equations under magnetostatic conditions, model the winding as a continuous distribution of circular current loops and derive the exact magnetic flux density component $B_{z}(z)$ on the axis at an arbitrary axial coordinate $z$ (measured from the solenoid center). Express your final answer as a single closed-form analytic expression in terms of $\\mu_{0}$, $N$, $I$, $a$, $\\ell$, and $z$. Use the International System of Units (SI), so the magnetic flux density is in tesla. Do not provide intermediate steps or multiple alternatives in your final expression; give a single simplified expression only. No numerical evaluation or rounding is required.",
            "solution": "The problem statement has been validated and is deemed valid. It is a scientifically grounded, well-posed, and objective problem from the field of electromagnetism. All necessary information is provided, and the objective is clearly defined.\n\nThe problem requires the derivation of the axial component of the magnetic flux density, $B_z(z)$, on the axis of a finite solenoid. We begin from the fundamental equations of magnetostatics and a suitable model for the solenoid's current distribution.\n\nThe governing equations are the magnetostatic forms of Maxwell's equations:\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{f} $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\nwhere $\\mathbf{H}$ is the magnetic field intensity, $\\mathbf{B}$ is the magnetic flux density, and $\\mathbf{J}_{f}$ is the free current density. For a linear, isotropic medium like free space, $\\mathbf{B} = \\mu_{0}\\mathbf{H}$.\n\nThe solenoid has $N$ turns over a length $\\ell$, carrying a steady current $I$. Since the turns are tightly packed, we can model this as a continuous cylindrical sheet of current. The number of turns per unit length is $n = N/\\ell$. The effective surface current density, $K$, is the total current crossing a unit length along the axis. This is given by $K = nI = (N/\\ell)I$. The direction of this current is azimuthal ($\\hat{\\boldsymbol{\\phi}}$).\n\nA standard result derivable from the Biot-Savart law (which itself is a solution to Maxwell's equations for localized currents) is the magnetic field on the axis of a single circular loop of radius $a$ carrying a current $I_{\\text{loop}}$. If the loop is centered at the origin and lies in the $xy$-plane, the magnetic flux density at a point $z$ on the axis is:\n$$ B_z^{\\text{loop}}(z) = \\frac{\\mu_{0} I_{\\text{loop}} a^2}{2(a^2 + z^2)^{3/2}} $$\n\nWe model the finite solenoid as a continuous stack of such circular loops. Consider an infinitesimal segment of the solenoid of axial length $dz'$ located at position $z'$. The current flowing in this infinitesimal ring is $dI = K \\, dz' = (N/\\ell)I \\, dz'$. This ring produces an infinitesimal magnetic flux density $dB_z$ at an observation point $(0,0,z)$ on the axis. The axial distance from the ring to the observation point is $(z-z')$. Using the formula for a single loop, we can write the contribution from this infinitesimal ring as:\n$$ dB_z = \\frac{\\mu_{0} (dI) a^2}{2(a^2 + (z-z')^2)^{3/2}} = \\frac{\\mu_{0} (N/\\ell)I a^2}{2(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n\nTo find the total magnetic flux density $B_z(z)$, we integrate this expression over the entire length of the solenoid, from $z' = -\\ell/2$ to $z' = +\\ell/2$:\n$$ B_z(z) = \\int_{-\\ell/2}^{+\\ell/2} \\frac{\\mu_{0} N I a^2}{2\\ell} \\frac{1}{(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\nLet's factor out the constants:\n$$ B_z(z) = \\frac{\\mu_{0} N I a^2}{2\\ell} \\int_{-\\ell/2}^{+\\ell/2} \\frac{1}{(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n\nTo solve the integral, we perform a change of variables. Let $u = z' - z$. Then $du = dz'$. The limits of integration for $u$ become:\n- Lower limit: $z' = -\\ell/2 \\implies u = -\\ell/2 - z = -(z + \\ell/2)$\n- Upper limit: $z' = +\\ell/2 \\implies u = \\ell/2 - z$\n\nThe integral becomes:\n$$ \\int_{-(z + \\ell/2)}^{\\ell/2 - z} \\frac{1}{(a^2 + u^2)^{3/2}} \\, du $$\nThe standard indefinite integral is:\n$$ \\int \\frac{1}{(a^2 + u^2)^{3/2}} \\, du = \\frac{1}{a^2} \\frac{u}{\\sqrt{a^2 + u^2}} $$\nNow, we evaluate the definite integral using the fundamental theorem of calculus:\n$$ \\left[ \\frac{1}{a^2} \\frac{u}{\\sqrt{a^2 + u^2}} \\right]_{-(z + \\ell/2)}^{\\ell/2 - z} = \\frac{1}{a^2} \\left( \\frac{\\ell/2 - z}{\\sqrt{a^2 + (\\ell/2 - z)^2}} - \\frac{-(z + \\ell/2)}{\\sqrt{a^2 + (-(z + \\ell/2))^2}} \\right) $$\n$$ = \\frac{1}{a^2} \\left( \\frac{\\ell/2 - z}{\\sqrt{a^2 + (\\ell/2 - z)^2}} + \\frac{z + \\ell/2}{\\sqrt{a^2 + (z + \\ell/2)^2}} \\right) $$\n\nSubstituting this result back into the expression for $B_z(z)$:\n$$ B_z(z) = \\frac{\\mu_{0} N I a^2}{2\\ell} \\left[ \\frac{1}{a^2} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + (z + \\frac{\\ell}{2})^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right) \\right] $$\nThe $a^2$ terms cancel, yielding the final expression for the magnetic flux density on the axis of the finite solenoid:\n$$ B_z(z) = \\frac{\\mu_{0} N I}{2\\ell} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + \\left(z + \\frac{\\ell}{2}\\right)^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right) $$\nThis expression gives the axial component of the magnetic flux density at any point $z$ on the axis of the solenoid, defined from $z=-\\ell/2$ to $z=+\\ell/2$. It is expressed purely in terms of the given parameters, as required.",
            "answer": "$$\\boxed{\\frac{\\mu_{0} N I}{2\\ell} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + \\left(z + \\frac{\\ell}{2}\\right)^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right)}$$"
        },
        {
            "introduction": "In many practical engineering and physics scenarios, solving the full set of Maxwell's equations is computationally prohibitive and often unnecessary. This exercise explores the powerful magnetoquasistatic (MQS) approximation, a cornerstone of low-frequency analysis where displacement currents are considered negligible . By analytically deriving and computationally comparing the MQS solution to the full-wave solution for eddy currents, you will develop a critical intuition for the domains of validity of such indispensable simplifying assumptions.",
            "id": "3514073",
            "problem": "Consider an infinite, homogeneous, isotropic conducting half-space occupying $x \\ge 0$ with constant electrical conductivity $\\sigma$ (in $\\mathrm{S/m}$), magnetic permeability $\\mu$ (in $\\mathrm{H/m}$), and electric permittivity $\\varepsilon$ (in $\\mathrm{F/m}$). A time-harmonic tangential magnetic field with complex amplitude $H_0$ (in $\\mathrm{A/m}$) is imposed at the surface: the total magnetic field is $H_z(x,t) = \\Re\\{ \\tilde{H}_z(x) e^{j \\omega t} \\}$, with the boundary condition $\\tilde{H}_z(0) = H_0$ and angular frequency $\\omega = 2 \\pi f$ (with $f$ in $\\mathrm{Hz}$). Assume one-dimensional variation along the normal direction $x$ and uniformity along tangential directions, with nonzero field components $\\tilde{E}_y(x)$ and $\\tilde{H}_z(x)$ only.\n\nStarting from Maxwell's equations and the constitutive relations in the International System of Units (SI),\n- Faraday's law: $\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$,\n- Ampère-Maxwell law: $\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$,\n- Ohm's law: $\\tilde{J} = \\sigma \\tilde{E}$,\n- Electric displacement: $\\tilde{D} = \\varepsilon \\tilde{E}$,\n- Magnetic flux: $\\tilde{B} = \\mu \\tilde{H}$,\nderive the governing one-dimensional equations for $\\tilde{E}_y(x)$ and $\\tilde{H}_z(x)$ under the stated symmetry and time-harmonic convention $e^{j \\omega t}$.\n\nThen:\n- Derive the full solution for the eddy current density $\\tilde{J}_y(x)$ including displacement current (the full Maxwell solution).\n- Derive the magnetoquasistatic (MQS) solution by neglecting displacement current (i.e., omitting the $j \\omega \\varepsilon \\tilde{E}$ term in the Ampère-Maxwell law), and obtain the corresponding eddy current density $\\tilde{J}_y^{\\mathrm{MQS}}(x)$.\n- For each test case below, define an evaluation interval $x \\in [0, L]$ where $L$ equals $5$ times the characteristic penetration depth of the MQS solution (commonly referred to as the skin depth of the MQS solution). All distances must be in $\\mathrm{m}$.\n- On this interval, compute the relative $L^2$ error between the MQS and full Maxwell eddy current densities:\n$$\n\\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}}.\n$$\nHere $\\left| \\cdot \\right|$ denotes the complex modulus. The error $\\mathcal{E}$ is dimensionless and must be reported as a floating-point number.\n\nYour implementation must use a numerical quadrature over a uniform grid with at least $1000$ points spanning $[0, L]$ to approximate the integrals. All input parameters must be interpreted in SI units: $\\sigma$ in $\\mathrm{S/m}$, $\\mu$ in $\\mathrm{H/m}$, $\\varepsilon$ in $\\mathrm{F/m}$, $f$ in $\\mathrm{Hz}$, $H_0$ in $\\mathrm{A/m}$, and $L$ in $\\mathrm{m}$.\n\nTest suite:\nUse the following four scientifically consistent parameter sets; for each case, set $L$ to $5$ times the MQS penetration depth as specified above.\n\n- Case $1$ (good conductor, low frequency, non-magnetic):\n  - $\\sigma = 5.8 \\times 10^{7} \\ \\mathrm{S/m}$,\n  - $\\mu = \\mu_0$ with $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$,\n  - $\\varepsilon = \\varepsilon_0$ with $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$,\n  - $f = 60 \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\n- Case $2$ (magnetic material, moderate conductivity, low frequency):\n  - $\\sigma = 1 \\times 10^{6} \\ \\mathrm{S/m}$,\n  - $\\mu = 100 \\, \\mu_0$,\n  - $\\varepsilon = \\varepsilon_0$,\n  - $f = 100 \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\n- Case $3$ (poor conductor, high permittivity, high frequency; displacement current significant):\n  - $\\sigma = 1 \\times 10^{-6} \\ \\mathrm{S/m}$,\n  - $\\mu = \\mu_0$,\n  - $\\varepsilon = 4 \\, \\varepsilon_0$,\n  - $f = 10^{6} \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\n- Case $4$ (intermediate conductivity, higher frequency; transitional regime):\n  - $\\sigma = 1 \\times 10^{3} \\ \\mathrm{S/m}$,\n  - $\\mu = \\mu_0$,\n  - $\\varepsilon = \\varepsilon_0$,\n  - $f = 10^{5} \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the relative $L^2$ errors for the 4 test cases as a comma-separated list enclosed in square brackets, with no spaces, for example: `[e_1,e_2,e_3,e_4]`.",
            "solution": "The problem is well-posed, scientifically grounded, and provides sufficient information for a unique solution. We proceed with the derivation and computational solution.\n\nThe analysis begins with the time-harmonic form of Maxwell's equations in a linear, isotropic, and homogeneous medium, using the $e^{j \\omega t}$ convention:\n1.  Faraday's Law: $\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$\n2.  Ampère-Maxwell Law: $\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$\n\nThe constitutive relations are:\n3.  Ohm's Law: $\\tilde{J} = \\sigma \\tilde{E}$\n4.  Electric Displacement: $\\tilde{D} = \\varepsilon \\tilde{E}$\n5.  Magnetic Flux Density: $\\tilde{B} = \\mu \\tilde{H}$\n\nSubstituting the constitutive relations $3$, $4$, and $5$ into $1$ and $2$ yields:\n$$ \\nabla \\times \\tilde{E} = - j \\omega \\mu \\tilde{H} $$\n$$ \\nabla \\times \\tilde{H} = \\sigma \\tilde{E} + j \\omega \\varepsilon \\tilde{E} = (\\sigma + j \\omega \\varepsilon) \\tilde{E} $$\n\nThe problem states that the fields vary only in the $x$ direction and have only specific components: $\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$ and $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$. The curl operator in Cartesian coordinates simplifies under these conditions:\nFor $\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$, we have $\\nabla \\times \\tilde{E} = \\frac{d\\tilde{E}_y}{dx} \\hat{z}$.\nFor $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$, we have $\\nabla \\times \\tilde{H} = -\\frac{d\\tilde{H}_z}{dx} \\hat{y}$.\n\nSubstituting these simplified curls into Maxwell's equations gives a system of one-dimensional ordinary differential equations:\n$$ \\frac{d\\tilde{E}_y}{dx} \\hat{z} = -j \\omega \\mu \\tilde{H}_z \\hat{z} \\implies \\frac{d\\tilde{E}_y}{dx} = -j \\omega \\mu \\tilde{H}_z \\quad (I) $$\n$$ -\\frac{d\\tilde{H}_z}{dx} \\hat{y} = (\\sigma + j \\omega \\varepsilon) \\tilde{E}_y \\hat{y} \\implies \\frac{d\\tilde{H}_z}{dx} = -(\\sigma + j \\omega \\varepsilon) \\tilde{E}_y \\quad (II) $$\n\nTo obtain a governing equation for $\\tilde{H}_z$, we differentiate equation $(II)$ with respect to $x$ and substitute equation $(I)$:\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} = -(\\sigma + j \\omega \\varepsilon) \\frac{d\\tilde{E}_y}{dx} = -(\\sigma + j \\omega \\varepsilon) (-j \\omega \\mu \\tilde{H}_z) = j \\omega \\mu (\\sigma + j \\omega \\varepsilon) \\tilde{H}_z $$\nThis is the Helmholtz equation for $\\tilde{H}_z(x)$:\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} - \\gamma^2 \\tilde{H}_z = 0 $$\nwhere $\\gamma$ is the complex propagation constant, defined by $\\gamma^2 = j \\omega \\mu (\\sigma + j \\omega \\varepsilon)$.\n\nThe general solution is $\\tilde{H}_z(x) = A e^{-\\gamma x} + C e^{\\gamma x}$. For a physically realistic solution in the half-space $x \\ge 0$, the fields must decay as $x \\to \\infty$. We must choose the root for $\\gamma$ such that its real part $\\Re\\{\\gamma\\} > 0$. This forces the coefficient of the growing exponential term to be zero, so $C=0$. The boundary condition at the surface is $\\tilde{H}_z(0) = H_0$, which gives $A=H_0$. Thus, the full Maxwell solution for the magnetic field is:\n$$ \\tilde{H}_z(x) = H_0 e^{-\\gamma x} $$\n\nFrom equation $(II)$, we can find the electric field $\\tilde{E}_y(x)$:\n$$ \\tilde{E}_y(x) = \\frac{-1}{\\sigma + j \\omega \\varepsilon} \\frac{d\\tilde{H}_z}{dx} = \\frac{-1}{\\sigma + j \\omega \\varepsilon} (- \\gamma H_0 e^{-\\gamma x}) = \\frac{\\gamma}{\\sigma + j \\omega \\varepsilon} H_0 e^{-\\gamma x} $$\nThe eddy current density is $\\tilde{J}_y(x) = \\sigma \\tilde{E}_y(x)$. Therefore, the full solution for the eddy current density is:\n$$ \\tilde{J}_y(x) = \\frac{\\sigma \\gamma}{\\sigma + j \\omega \\varepsilon} H_0 e^{-\\gamma x} \\quad (\\text{Full Maxwell Solution}) $$\nwhere $\\gamma = \\sqrt{j \\omega \\mu (\\sigma + j \\omega \\varepsilon)}$.\n\nNext, we derive the magnetoquasistatic (MQS) solution. The MQS approximation neglects displacement current, which is equivalent to setting $\\varepsilon = 0$ or, more formally, dropping the $j \\omega \\varepsilon \\tilde{E}$ term. The Ampère-Maxwell law becomes $\\nabla \\times \\tilde{H} = \\tilde{J} = \\sigma \\tilde{E}$.\nEquation $(II)$ simplifies to $\\frac{d\\tilde{H}_z}{dx} = -\\sigma \\tilde{E}_y$. The Helmholtz equation for $\\tilde{H}_z$ becomes:\n$$ \\frac{d^2\\tilde{H}_z^{\\mathrm{MQS}}}{dx^2} - (\\gamma^{\\mathrm{MQS}})^2 \\tilde{H}_z^{\\mathrm{MQS}} = 0 $$\nwhere the MQS propagation constant is $(\\gamma^{\\mathrm{MQS}})^2 = j \\omega \\mu \\sigma$.\nThe solution for the magnetic field, applying the same boundary conditions, is:\n$$ \\tilde{H}_z^{\\mathrm{MQS}}(x) = H_0 e^{-\\gamma^{\\mathrm{MQS}} x} $$\nFrom the simplified Ampère's law, $\\tilde{E}_y^{\\mathrm{MQS}}(x) = \\frac{-1}{\\sigma} \\frac{d\\tilde{H}_z^{\\mathrm{MQS}}}{dx} = \\frac{\\gamma^{\\mathrm{MQS}}}{\\sigma} H_0 e^{-\\gamma^{\\mathrm{MQS}} x}$.\nThe corresponding MQS eddy current density is $\\tilde{J}_y^{\\mathrm{MQS}}(x) = \\sigma \\tilde{E}_y^{\\mathrm{MQS}}(x)$:\n$$ \\tilde{J}_y^{\\mathrm{MQS}}(x) = \\gamma^{\\mathrm{MQS}} H_0 e^{-\\gamma^{\\mathrm{MQS}} x} \\quad (\\text{MQS Solution}) $$\nwhere $\\gamma^{\\mathrm{MQS}} = \\sqrt{j \\omega \\mu \\sigma}$.\n\nThe MQS propagation constant can be expressed as $\\gamma^{\\mathrm{MQS}} = \\sqrt{j} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\sqrt{2}} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\delta}$, where $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$ is the classical skin depth. The problem defines the integration interval as $x \\in [0, L]$, with $L = 5\\delta$.\n\nThe relative $L^2$ error between the MQS and full Maxwell solutions is:\n$$ \\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}} $$\nTo compute $\\mathcal{E}$, we will use numerical integration. We establish a uniform grid of $N \\ge 1000$ points over the interval $[0, L]$. For each point $x_i$ on the grid, we evaluate the complex values of $\\tilde{J}_y(x_i)$ and $\\tilde{J}_y^{\\mathrm{MQS}}(x_i)$ using the derived expressions. We then compute the squared magnitudes of their difference for the numerator's integrand and the squared magnitude of the full solution for the denominator's integrand. The integrals are approximated using a numerical quadrature rule, such as Simpson's rule, a standard method for integration over a uniform grid. Finally, the error $\\mathcal{E}$ is computed from the ratio of these integrals. The parameter $H_0$ is a common multiplicative factor in all current densities and thus cancels out in the final error calculation.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetism problem for the given test cases.\n    It calculates the relative L2 error between the full Maxwell and MQS\n    solutions for eddy current density.\n    \"\"\"\n    \n    # Physical constants in SI units\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    EPSILON_0 = 8.854187817e-12  # Permittivity of free space (F/m)\n\n    test_cases = [\n        # Case 1: good conductor, low frequency, non-magnetic\n        # sigma (S/m), mu_r, epsilon_r, f (Hz), H0 (A/m)\n        (5.8e7, 1.0, 1.0, 60, 1.0),\n        # Case 2: magnetic material, moderate conductivity, low frequency\n        (1.0e6, 100.0, 1.0, 100, 1.0),\n        # Case 3: poor conductor, high permittivity, high frequency\n        (1.0e-6, 1.0, 4.0, 1.0e6, 1.0),\n        # Case 4: intermediate conductivity, higher frequency\n        (1.0e3, 1.0, 1.0, 1.0e5, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sigma, mu_r, epsilon_r, f, H0 = case\n        \n        # Absolute material properties\n        mu = mu_r * MU_0\n        epsilon = epsilon_r * EPSILON_0\n        omega = 2 * np.pi * f\n        \n        # --- MQS Solution ---\n        # MQS propagation constant\n        gamma_mqs = np.sqrt(1j * omega * mu * sigma)\n        \n        # Classical skin depth for MQS solution\n        # This defines the integration domain length L\n        if omega * mu * sigma > 0:\n            skin_depth_mqs = np.sqrt(2 / (omega * mu * sigma))\n        else:\n            # Handle cases with zero sigma or omega to avoid division by zero,\n            # though not present in test suite.\n            skin_depth_mqs = np.inf\n\n        L = 5 * skin_depth_mqs\n        \n        # If L is infinite or very large, cap it for practical computation.\n        # This scenario implies MQS predicts no decay, which would make the integral diverge.\n        # However, the test cases provided are well-behaved.\n        if np.isinf(L):\n           L = 1.0 # Fallback for non-conducting case.\n\n        # --- Full Maxwell Solution ---\n        # Full propagation constant\n        complex_permittivity = sigma + 1j * omega * epsilon\n        gamma_full = np.sqrt(1j * omega * mu * complex_permittivity)\n\n        # Ensure the root with positive real part is used for decaying wave\n        if np.real(gamma_full)  0:\n            gamma_full = -gamma_full\n        \n        # --- Numerical Integration Setup ---\n        # Create a uniform grid with N > 1000 points\n        N = 2000\n        x = np.linspace(0, L, N)\n\n        # --- Calculate Current Densities on the Grid ---\n        # The constant H0 cancels in the relative error formula.\n        # J_y(x) = C_full * exp(-gamma_full * x)\n        # J_y_MQS(x) = C_mqs * exp(-gamma_mqs * x)\n        \n        # Prefactor for full Maxwell current density\n        C_full = H0 * sigma * gamma_full / complex_permittivity\n        \n        # Prefactor for MQS current density\n        C_mqs = H0 * gamma_mqs\n        \n        # Evaluate current densities on the grid\n        J_full_vals = C_full * np.exp(-gamma_full * x)\n        J_mqs_vals = C_mqs * np.exp(-gamma_mqs * x)\n        \n        # --- Compute L2 Norms using Simpson's Rule ---\n        # The integrands are the squared magnitudes\n        integrand_num = np.abs(J_full_vals - J_mqs_vals)**2\n        integrand_den = np.abs(J_full_vals)**2\n\n        # Integrate using scipy.integrate.simpson\n        integral_num = simpson(y=integrand_num, x=x)\n        integral_den = simpson(y=integrand_den, x=x)\n        \n        # --- Calculate Relative Error ---\n        # Guard against division by zero if the true solution is identically zero\n        if integral_den == 0:\n            error = 0.0 if integral_num == 0 else np.inf\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        results.append(error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from the continuous equations of physics to their discrete counterparts for computer simulation introduces subtle but profound challenges. A numerical scheme that is not carefully constructed can violate fundamental conservation laws, leading to unphysical results and instability. This practice delves into the crucial concept of discrete charge conservation, revealing the exact mathematical \"contract\" that must exist between charge and current updates in a time-domain solver to perfectly uphold Gauss's law at every time step .",
            "id": "3514083",
            "problem": "Consider a compatible finite-volume discretization of Maxwell’s equations for electromagnetism on a staggered grid typical of Finite-Difference Time-Domain (FDTD) and mixed finite element methods. The electric flux density $\\mathbf{D}$ is stored as face-normal fluxes, the magnetic field $\\mathbf{H}$ is stored on edges, and the charge density $\\rho$ is stored as cell averages. Let the computational domain be partitioned into control volumes $K$ with boundary $\\partial K$ and faces $f \\subset \\partial K$. Denote by $|K|$ the volume of $K$ and by $|f|$ the area of face $f$. The discrete divergence operator acting on face-normal fluxes is defined by\n$$\n(\\nabla_h \\cdot \\mathbf{D})_K = \\frac{1}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, D_f \\, |f|,\n$$\nwhere $\\sigma_{Kf} \\in \\{+1,-1\\}$ encodes the orientation of face $f$ relative to the outward normal of $K$. The discrete curl operator $\\nabla_h \\times$ is chosen so that the discrete vector identity $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$ holds exactly for all $\\mathbf{H}$.\n\nAssume time advancement from time level $n$ to $n+1$ with step $\\Delta t$ using a centered-in-time discretization of the Ampère-Maxwell law,\n$$\n\\frac{\\mathbf{D}^{n+1} - \\mathbf{D}^{n}}{\\Delta t} = \\nabla_h \\times \\mathbf{H}^{n+1/2} - \\mathbf{J}^{n+1/2},\n$$\nwhere $\\mathbf{J}^{n+1/2}$ is the total current density at the half time level, assembled from multiple physics modules (for example, conduction currents from a charge transport solver and convection currents from a Particle-In-Cell (PIC) module). The charge density is updated by a separate module that assigns charges from the coupled physics to cells, producing $\\rho^{n+1}$.\n\nYou are told that at time level $n$ the discrete Gauss’s law holds in every control volume,\n$$\n(\\nabla_h \\cdot \\mathbf{D}^{n})_K = \\rho_K^{n}.\n$$\n\nWhich statement best explains the discrete requirement on charge assignment and current updates that ensures the equality\n$$\n(\\nabla_h \\cdot \\mathbf{D}^{n+1})_K = \\rho_K^{n+1}\n$$\nholds for every control volume $K$ at the next time step?\n\nA. The face-centered current update $\\mathbf{J}^{n+1/2}$ must be deposited so that, for every control volume $K$, the discrete continuity equation\n$$\n\\rho_K^{n+1} - \\rho_K^{n} + \\frac{\\Delta t}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, J_f^{n+1/2} \\, |f| = 0\n$$\nis satisfied using the same face currents $J_f^{n+1/2}$ that enter the Ampère-Maxwell update of $\\mathbf{D}$; together with the property $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$, this guarantees preservation of discrete Gauss’s law.\n\nB. It is sufficient to conserve total charge globally, $\\int \\rho^{n+1} \\, \\mathrm{d}V = \\int \\rho^{n} \\, \\mathrm{d}V$, even if local cell-wise continuity is not enforced, because global charge conservation implies discrete Gauss’s law is preserved everywhere.\n\nC. If the electric flux density $\\mathbf{D}$ is advanced using the total current $\\mathbf{J}^{n+1/2}$, then the next-step charge density $\\rho^{n+1}$ can be computed independently from a Poisson solve that ignores the currents; the initial satisfaction of Gauss’s law is then automatically preserved by the time integration.\n\nD. Any consistent time integrator with sufficiently small $\\Delta t$ will preserve Gauss’s law to within truncation error without needing a local discrete continuity relation, so enforcing a compatibility condition between charge assignment and current updates is unnecessary.",
            "solution": "The user has provided a problem concerning the numerical solution of Maxwell's equations and has asked for a critical validation before proceeding to a solution.\n\n### Step 1: Extract Givens\nThe problem statement provides the following information:\n-   **Discretization**: A compatible finite-volume discretization on a staggered grid.\n-   **Variable Storage**:\n    -   Electric flux density $\\mathbf{D}$ is stored as face-normal fluxes, $D_f$.\n    -   Magnetic field $\\mathbf{H}$ is stored on edges.\n    -   Charge density $\\rho$ is stored as cell averages, $\\rho_K$.\n-   **Domain Elements**:\n    -   Control volumes $K$ with boundary $\\partial K$.\n    -   Faces $f \\subset \\partial K$.\n    -   Volume of a control volume: $|K|$.\n    -   Area of a face: $|f|$.\n-   **Discrete Operators**:\n    -   The discrete divergence operator applied to a face-based field $\\mathbf{D}$ is:\n        $$(\\nabla_h \\cdot \\mathbf{D})_K = \\frac{1}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, D_f \\, |f|$$\n        where $\\sigma_{Kf} \\in \\{+1,-1\\}$ is an orientation factor.\n    -   The discrete curl operator $\\nabla_h \\times$ is defined such that the discrete vector identity holds exactly:\n        $$\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$$\n-   **Time Integration**:\n    -   Time levels are $n$ and $n+1$, with a time step $\\Delta t$.\n    -   The Ampère-Maxwell law is discretized as:\n        $$\\frac{\\mathbf{D}^{n+1} - \\mathbf{D}^{n}}{\\Delta t} = \\nabla_h \\times \\mathbf{H}^{n+1/2} - \\mathbf{J}^{n+1/2}$$\n        This is an equation for face-based quantities.\n    -   The total current density $\\mathbf{J}^{n+1/2}$ is given.\n-   **Initial Condition**: At time level $n$, the discrete Gauss's law holds in every control volume $K$:\n    $$(\\nabla_h \\cdot \\mathbf{D}^{n})_K = \\rho_K^{n}$$\n-   **Charge Density Update**: The charge density at the new time level, $\\rho_K^{n+1}$, is provided by a separate module.\n-   **Question**: What is the discrete requirement that ensures the discrete Gauss's law also holds at time level $n+1$?\n    $$(\\nabla_h \\cdot \\mathbf{D}^{n+1})_K = \\rho_K^{n+1}$$\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n\n-   **Scientifically Grounded**: The problem is firmly rooted in the field of computational electromagnetism. The concepts presented—staggered grids (like the Yee grid), compatible or mimetic discretizations, and the challenge of maintaining Gauss's law (charge conservation)—are central to the theory and practice of methods like the Finite-Difference Time-Domain (FDTD), mixed Finite Element Methods (FEM), and Finite Integration Technique (FIT). The identity $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$ is a defining feature of such schemes, emulating the continuum vector identity $\\nabla \\cdot (\\nabla \\times \\mathbf{H}) = 0$. The setup is scientifically and mathematically sound.\n-   **Well-Posed**: The question asks for a specific condition to maintain a discrete invariant of the numerical scheme. The givens are sufficient to derive this condition uniquely. The problem is well-posed.\n-   **Objective**: The terminology is standard, precise, and free of ambiguity or subjective claims.\n\nThe problem statement exhibits none of the invalidating flaws. It is scientifically sound, well-posed, and objective.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Derivation\nThe objective is to find the condition under which the discrete Gauss's law is preserved from time level $n$ to $n+1$.\n\nWe are given that at time $n$:\n$$(\\nabla_h \\cdot \\mathbf{D}^{n})_K = \\rho_K^{n}$$\nWe require that at time $n+1$:\n$$(\\nabla_h \\cdot \\mathbf{D}^{n+1})_K = \\rho_K^{n+1}$$\n\nSubtracting the first equation from the second gives the required change over one time step:\n$$(\\nabla_h \\cdot \\mathbf{D}^{n+1})_K - (\\nabla_h \\cdot \\mathbf{D}^{n})_K = \\rho_K^{n+1} - \\rho_K^{n}$$\n\nThe discrete divergence operator $\\nabla_h \\cdot$ is linear. Therefore, the left side can be rewritten as:\n$$(\\nabla_h \\cdot (\\mathbf{D}^{n+1} - \\mathbf{D}^{n}))_K = \\rho_K^{n+1} - \\rho_K^{n}$$\n\nNow, we use the provided time-stepping formula for the Ampère-Maxwell law to substitute for the term $(\\mathbf{D}^{n+1} - \\mathbf{D}^{n})$. Rearranging the given formula yields:\n$$\\mathbf{D}^{n+1} - \\mathbf{D}^{n} = \\Delta t \\left( \\nabla_h \\times \\mathbf{H}^{n+1/2} - \\mathbf{J}^{n+1/2} \\right)$$\n\nSubstituting this expression into our evolving equation:\n$$(\\nabla_h \\cdot [\\Delta t (\\nabla_h \\times \\mathbf{H}^{n+1/2} - \\mathbf{J}^{n+1/2})])_K = \\rho_K^{n+1} - \\rho_K^{n}$$\n\nWe can factor out the constant $\\Delta t$ and apply the linearity of the divergence operator again:\n$$\\Delta t \\left[ (\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}^{n+1/2}))_K - (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})_K \\right] = \\rho_K^{n+1} - \\rho_K^{n}$$\n\nThe problem statement explicitly gives the property that the discrete curl and divergence operators are compatible, meaning $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$ for any discrete field $\\mathbf{H}$. Applying this to $\\mathbf{H}^{n+1/2}$, the first term inside the brackets vanishes:\n$$\\Delta t \\left[ 0 - (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})_K \\right] = \\rho_K^{n+1} - \\rho_K^{n}$$\n$$-\\Delta t (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})_K = \\rho_K^{n+1} - \\rho_K^{n}$$\n\nNow, we must express the discrete divergence of the current density, $(\\nabla_h \\cdot \\mathbf{J}^{n+1/2})_K$. The current density $\\mathbf{J}$ must be discretized in the same way as the electric flux density $\\mathbf{D}$ (i.e., as face-normal quantities $J_f$) for it to be part of the face-based Ampère-Maxwell update. Applying the definition of the discrete divergence operator to $\\mathbf{J}^{n+1/2}$:\n$$(\\nabla_h \\cdot \\mathbf{J}^{n+1/2})_K = \\frac{1}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, J_f^{n+1/2} \\, |f|$$\n\nSubstituting this into our equation:\n$$-\\Delta t \\left( \\frac{1}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, J_f^{n+1/2} \\, |f| \\right) = \\rho_K^{n+1} - \\rho_K^{n}$$\n\nRearranging the terms to obtain the final condition:\n$$\\rho_K^{n+1} - \\rho_K^{n} + \\frac{\\Delta t}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, J_f^{n+1/2} \\, |f| = 0$$\n\nThis equation is the discrete form of the charge continuity equation, $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0$, integrated over the control volume $K$ and over the time step $\\Delta t$. This derivation shows that for the time-stepping of Ampère's law to be compatible with Gauss's law, the charge update and current update must satisfy this discrete continuity equation for every control volume $K$.\n\n### Option-by-Option Analysis\n\n**A. The face-centered current update $\\mathbf{J}^{n+1/2}$ must be deposited so that, for every control volume $K$, the discrete continuity equation $\\rho_K^{n+1} - \\rho_K^{n} + \\frac{\\Delta t}{|K|} \\sum_{f \\in \\partial K} \\sigma_{Kf} \\, J_f^{n+1/2} \\, |f| = 0$ is satisfied using the same face currents $J_f^{n+1/2}$ that enter the Ampère-Maxwell update of $\\mathbf{D}$; together with the property $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$, this guarantees preservation of discrete Gauss’s law.**\n-   **Analysis**: This statement perfectly matches the result of our derivation. It correctly identifies the discrete continuity equation as the necessary condition. It also correctly notes that this relies on two key components: the exact satisfaction of $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}) \\equiv 0$ and the use of the *same* current $J_f^{n+1/2}$ in both the Ampère-Maxwell law and the charge continuity equation. This coupling is precisely what makes charge conservation an exact property of the scheme.\n-   **Verdict**: **Correct**.\n\n**B. It is sufficient to conserve total charge globally, $\\int \\rho^{n+1} \\, \\mathrm{d}V = \\int \\rho^{n} \\, \\mathrm{d}V$, even if local cell-wise continuity is not enforced, because global charge conservation implies discrete Gauss’s law is preserved everywhere.**\n-   **Analysis**: This statement is incorrect. The problem demands that Gauss's law, $(\\nabla_h \\cdot \\mathbf{D})_K = \\rho_K$, holds *in every control volume $K$*. This is a local condition. Global charge conservation is a weaker condition that can be satisfied even if charge is not conserved locally (e.g., charge is incorrectly moved from one cell to another without a corresponding current flux across the boundary). If local charge continuity is not enforced, the local relationship between $\\nabla_h \\cdot \\mathbf{D}$ and $\\rho$ will be violated, even if the total charge in the simulation domain remains constant.\n-   **Verdict**: **Incorrect**.\n\n**C. If the electric flux density $\\mathbf{D}$ is advanced using the total current $\\mathbf{J}^{n+1/2}$, then the next-step charge density $\\rho^{n+1}$ can be computed independently from a Poisson solve that ignores the currents; the initial satisfaction of Gauss’s law is then automatically preserved by the time integration.**\n-   **Analysis**: This is incorrect. The derivation explicitly shows that $\\rho^{n+1}$ is not independent; its change, $\\rho^{n+1} - \\rho^n$, must be strictly coupled to the divergence of the current, $\\nabla_h \\cdot \\mathbf{J}$. Computing $\\rho^{n+1}$ from an independent Poisson solve (e.g., by solving $\\nabla^2_h \\phi = -\\rho/\\epsilon$ and then re-evaluating $\\mathbf{D} = -\\epsilon\\nabla_h\\phi$) is a form of \"divergence cleaning,\" which is a corrective measure used when charge is *not* conserved by the time-update scheme. It is not the mechanism for inherent preservation. The scheme described in the problem is designed to preserve Gauss's law without such a correction, provided the continuity equation is satisfied.\n-   **Verdict**: **Incorrect**.\n\n**D. Any consistent time integrator with sufficiently small $\\Delta t$ will preserve Gauss’s law to within truncation error without needing a local discrete continuity relation, so enforcing a compatibility condition between charge assignment and current updates is unnecessary.**\n-   **Analysis**: This is a common fallacy. While a \"consistent\" scheme ensures that the error approaches zero as the discretization parameters ($\\Delta t$, grid spacing) approach zero, for any finite step size, an error will be introduced at each time step if the discrete continuity equation is not satisfied. This error is typically proportional to $\\Delta t$ and accumulates over time, potentially leading to large, unphysical divergence of the electric field and numerical instability. The entire purpose of compatible discretizations is to avoid this accumulation by ensuring the discrete analogue of $\\nabla \\cdot \\mathbf{D} - \\rho$ remains exactly zero (to machine precision), not just close to zero. This requires enforcing the compatibility condition (the discrete continuity equation).\n-   **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}