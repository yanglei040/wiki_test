{
    "hands_on_practices": [
        {
            "introduction": "麦克斯韦方程组在静态条件下的应用是理解电磁学的基础，此时方程解耦为独立的电场和磁场问题。本练习将通过一个经典的有限长螺线管问题，帮助我们掌握如何从磁静力学方程 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$ 出发，通过积分计算由稳恒电流分布产生的磁通量密度 $\\mathbf{B}$。这个过程不仅能加深对毕奥-萨伐尔定律（Biot-Savart law）应用的理解，也为分析更复杂的电流-场相互作用奠定了坚实的解析基础。",
            "id": "3514106",
            "problem": "一个有限长度的长薄壁螺线管被建模用于多物理场耦合仿真中的静磁分析，其中由于稳恒直流电和可忽略的焦耳热，电磁场与机械场和热场解耦。该螺线管半径为 $a$，总长度为 $\\ell$，有 $N$ 匝紧密缠绕的线圈，承载着沿方位角方向的稳恒电流 $I$，在圆柱壳上产生有效的表面电流密度。假设螺线管周围是自由空间，因此磁响应是线性和各向同性的，满足 $\\mathbf{B}=\\mu_{0}\\mathbf{H}$。螺线管的轴与 $z$ 轴对齐，范围从 $z=-\\ell/2$ 到 $z=+\\ell/2$。\n\n从静磁学麦克斯韦方程组 $\\nabla\\times\\mathbf{H}=\\mathbf{J}_{f}$ 和 $\\nabla\\cdot\\mathbf{B}=0$ 出发，并仅使用可以从这些方程在静磁条件下推导出的、经过充分验证的结果，将绕组建模为圆形电流环的连续分布，并推导轴上任意轴向坐标 $z$ 处（从螺线管中心测量）的精确磁通密度分量 $B_{z}(z)$。将您的最终答案表示为仅含 $\\mu_{0}$、$N$、$I$、$a$、$\\ell$ 和 $z$ 的单个闭式解析表达式。使用国际单位制（SI），因此磁通密度的单位是特斯拉。在最终表达式中不要提供中间步骤或多种替代形式；只给出一个简化的表达式。不需要进行数值计算或四舍五入。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个来自电磁学领域的、有科学依据的、适定且客观的问题。所有必要的信息都已提供，目标也已明确定义。\n\n该问题要求推导有限长螺线管轴上的磁通密度轴向分量 $B_z(z)$。我们从静磁学的基本方程和螺线管电流分布的合适模型开始。\n\n控制方程是麦克斯韦方程组的静磁形式：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{f} $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n其中 $\\mathbf{H}$ 是磁场强度，$\\mathbf{B}$ 是磁通密度，$\\mathbf{J}_{f}$ 是自由电流密度。对于像自由空间这样的线性、各向同性介质，$\\mathbf{B} = \\mu_{0}\\mathbf{H}$。\n\n螺线管在长度 $\\ell$ 上有 $N$ 匝线圈，承载着稳恒电流 $I$。由于线圈是紧密缠绕的，我们可以将其建模为一个连续的圆柱形电流片。单位长度的匝数是 $n = N/\\ell$。有效表面电流密度 $K$ 是沿轴向单位长度上通过的总电流。它由 $K = nI = (N/\\ell)I$ 给出。此电流的方向是方位角方向（$\\hat{\\boldsymbol{\\phi}}$）。\n\n从毕奥-萨伐尔定律（该定律本身是麦克斯韦方程组在局部电流情况下的解）可以推导出一个标准结果，即半径为 $a$、载有电流 $I_{\\text{loop}}$ 的单个圆形回路轴线上的磁场。如果该回路以原点为中心，位于 $xy$ 平面内，那么轴上 $z$ 点的磁通密度为：\n$$ B_z^{\\text{loop}}(z) = \\frac{\\mu_{0} I_{\\text{loop}} a^2}{2(a^2 + z^2)^{3/2}} $$\n\n我们将有限长螺线管建模为这类圆形回路的连续堆叠。考虑螺线管在位置 $z'$ 处的一个轴向长度为 $dz'$ 的无穷小段。流过这个无穷小环的电流是 $dI = K \\, dz' = (N/\\ell)I \\, dz'$。这个环在轴上的观测点 $(0,0,z)$ 处产生一个无穷小的磁通密度 $dB_z$。从环到观测点的轴向距离是 $(z-z')$。使用单个回路的公式，我们可以写出这个无穷小环的贡献为：\n$$ dB_z = \\frac{\\mu_{0} (dI) a^2}{2(a^2 + (z-z')^2)^{3/2}} = \\frac{\\mu_{0} (N/\\ell)I a^2}{2(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n\n为了求得总磁通密度 $B_z(z)$，我们将此表达式在螺线管的整个长度上进行积分，从 $z' = -\\ell/2$ 到 $z' = +\\ell/2$：\n$$ B_z(z) = \\int_{-\\ell/2}^{+\\ell/2} \\frac{\\mu_{0} N I a^2}{2\\ell} \\frac{1}{(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n让我们将常数提取出来：\n$$ B_z(z) = \\frac{\\mu_{0} N I a^2}{2\\ell} \\int_{-\\ell/2}^{+\\ell/2} \\frac{1}{(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n\n为了求解该积分，我们进行变量替换。令 $u = z' - z$。则 $du = dz'$。$u$ 的积分上下限变为：\n- 下限：$z' = -\\ell/2 \\implies u = -\\ell/2 - z = -(z + \\ell/2)$\n- 上限：$z' = +\\ell/2 \\implies u = \\ell/2 - z$\n\n积分变为：\n$$ \\int_{-(z + \\ell/2)}^{\\ell/2 - z} \\frac{1}{(a^2 + u^2)^{3/2}} \\, du $$\n标准不定积分为：\n$$ \\int \\frac{1}{(a^2 + u^2)^{3/2}} \\, du = \\frac{1}{a^2} \\frac{u}{\\sqrt{a^2 + u^2}} $$\n现在，我们使用微积分基本定理计算定积分：\n$$ \\left[ \\frac{1}{a^2} \\frac{u}{\\sqrt{a^2 + u^2}} \\right]_{-(z + \\ell/2)}^{\\ell/2 - z} = \\frac{1}{a^2} \\left( \\frac{\\ell/2 - z}{\\sqrt{a^2 + (\\ell/2 - z)^2}} - \\frac{-(z + \\ell/2)}{\\sqrt{a^2 + (-(z + \\ell/2))^2}} \\right) $$\n$$ = \\frac{1}{a^2} \\left( \\frac{\\ell/2 - z}{\\sqrt{a^2 + (\\ell/2 - z)^2}} + \\frac{z + \\ell/2}{\\sqrt{a^2 + (z + \\ell/2)^2}} \\right) $$\n\n将此结果代回到 $B_z(z)$ 的表达式中：\n$$ B_z(z) = \\frac{\\mu_{0} N I a^2}{2\\ell} \\left[ \\frac{1}{a^2} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + (z + \\frac{\\ell}{2})^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right) \\right] $$\n$a^2$ 项相互抵消，得到有限长螺线管轴上磁通密度的最终表达式：\n$$ B_z(z) = \\frac{\\mu_{0} N I}{2\\ell} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + \\left(z + \\frac{\\ell}{2}\\right)^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right) $$\n此表达式给出了螺线管轴上任意点 $z$ (定义范围从 $z=-\\ell/2$ 到 $z=+\\ell/2$) 的磁通密度轴向分量。它完全由给定的参数表示，符合要求。",
            "answer": "$$\\boxed{\\frac{\\mu_{0} N I}{2\\ell} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + \\left(z + \\frac{\\ell}{2}\\right)^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right)}$$"
        },
        {
            "introduction": "当电磁场随时间变化时，完整的麦克斯韦-安培定律 $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}$ 描述了传导电流和位移电流共同作为磁场的源。本练习探讨了磁准静态（MQS）近似，即忽略位移电流项 $\\frac{\\partial \\mathbf{D}}{\\partial t}$ 的情况，这在低频和高电导率材料中是有效的。通过编程计算并比较MQS解与完整解，你将量化该近似的误差，深刻理解其适用范围和在多物理场仿真中的重要性。",
            "id": "3514073",
            "problem": "考虑一个占据 $x \\ge 0$ 的无限、均匀、各向同性的导电半空间，其电导率 $\\sigma$（单位：$\\mathrm{S/m}$）、磁导率 $\\mu$（单位：$\\mathrm{H/m}$）和介电常数 $\\varepsilon$（单位：$\\mathrm{F/m}$）均为常数。在表面施加一个时谐切向磁场，其复振幅为 $H_0$（单位：$\\mathrm{A/m}$）：总磁场为 $H_z(x,t) = \\Re\\{ \\tilde{H}_z(x) e^{j \\omega t} \\}$，边界条件为 $\\tilde{H}_z(0) = H_0$，角频率为 $\\omega = 2 \\pi f$（其中 $f$ 的单位为 $\\mathrm{Hz}$）。假设场仅沿法向 $x$ 方向一维变化，在切向方向上是均匀的，且只有场分量 $\\tilde{E}_y(x)$ 和 $\\tilde{H}_z(x)$ 不为零。\n\n从国际单位制（SI）中的麦克斯韦方程组和本构关系出发，\n- 法拉第定律：$\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$，\n- 安培-麦克斯韦定律：$\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$，\n- 欧姆定律：$\\tilde{J} = \\sigma \\tilde{E}$，\n- 电位移：$\\tilde{D} = \\varepsilon \\tilde{E}$，\n- 磁通密度：$\\tilde{B} = \\mu \\tilde{H}$，\n在所述的对称性和时谐约定 $e^{j \\omega t}$ 下，推导 $\\tilde{E}_y(x)$ 和 $\\tilde{H}_z(x)$ 的一维控制方程。\n\n接着：\n- 推导包含位移电流的涡流密度 $\\tilde{J}_y(x)$ 的全解（即完整的麦克斯韦解）。\n- 通过忽略位移电流（即在安培-麦克斯韦定律中省略 $j \\omega \\varepsilon \\tilde{E}$ 项）来推导磁准静态（MQS）解，并求出相应的涡流密度 $\\tilde{J}_y^{\\mathrm{MQS}}(x)$。\n- 对于下方的每个测试案例，定义一个评估区间 $x \\in [0, L]$，其中 $L$ 等于 MQS 解的特征穿透深度的 5 倍（通常称为 MQS 解的趋肤深度）。所有距离单位必须为 $\\mathrm{m}$。\n- 在此区间上，计算 MQS 涡流密度与完整麦克斯韦涡流密度之间的相对 $L^2$ 误差：\n$$\n\\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}}.\n$$\n此处 $\\left| \\cdot \\right|$ 表示复数模。误差 $\\mathcal{E}$ 是无量纲的，并且必须以浮点数形式报告。\n\n你的实现必须在跨越 $[0, L]$ 且至少包含 $1000$ 个点的均匀网格上使用数值积分来近似计算这些积分。所有输入参数必须以国际单位制（SI）进行解释：$\\sigma$ 单位为 $\\mathrm{S/m}$，$\\mu$ 单位为 $\\mathrm{H/m}$，$\\varepsilon$ 单位为 $\\mathrm{F/m}$，$f$ 单位为 $\\mathrm{Hz}$，$H_0$ 单位为 $\\mathrm{A/m}$，$L$ 单位为 $\\mathrm{m}$。\n\n测试套件：\n使用以下四组科学上一致的参数集；对于每种情况，将 $L$ 设置为上述指定的 MQS 穿透深度的 5 倍。\n\n- 情况 $1$（良导体，低频，非磁性）：\n  - $\\sigma = 5.8 \\times 10^{7} \\ \\mathrm{S/m}$，\n  - $\\mu = \\mu_0$，其中 $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$，\n  - $\\varepsilon = \\varepsilon_0$，其中 $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$，\n  - $f = 60 \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n- 情况 $2$（磁性材料，中等电导率，低频）：\n  - $\\sigma = 1 \\times 10^{6} \\ \\mathrm{S/m}$，\n  - $\\mu = 100 \\, \\mu_0$，\n  - $\\varepsilon = \\varepsilon_0$，\n  - $f = 100 \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n- 情况 $3$（不良导体，高介电常数，高频；位移电流显著）：\n  - $\\sigma = 1 \\times 10^{-6} \\ \\mathrm{S/m}$，\n  - $\\mu = \\mu_0$，\n  - $\\varepsilon = 4 \\, \\varepsilon_0$，\n  - $f = 10^{6} \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n- 情况 $4$（中等电导率，较高频率；过渡区域）：\n  - $\\sigma = 1 \\times 10^{3} \\ \\mathrm{S/m}$，\n  - $\\mu = \\mu_0$，\n  - $\\varepsilon = \\varepsilon_0$，\n  - $f = 10^{5} \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含 4 个测试案例的相对 $L^2$ 误差，格式为用方括号括起来的逗号分隔列表，例如 $\\left[ e_1, e_2, e_3, e_4 \\right]$，其中每个 $e_i$ 是一个浮点数。该行必须严格遵循 $\\left[ e_1,e_2,e_3,e_4 \\right]$ 的格式，值之间用逗号分隔，无额外空格。",
            "solution": "该问题提法明确，具有科学依据，并为获得唯一解提供了充分的信息。我们着手进行推导和计算求解。\n\n分析始于线性、各向同性、均匀介质中采用 $e^{j \\omega t}$ 约定的时谐形式麦克斯韦方程组：\n1.  法拉第定律：$\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$\n2.  安培-麦克斯韦定律：$\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$\n\n本构关系为：\n3.  欧姆定律：$\\tilde{J} = \\sigma \\tilde{E}$\n4.  电位移：$\\tilde{D} = \\varepsilon \\tilde{E}$\n5.  磁通密度：$\\tilde{B} = \\mu \\tilde{H}$\n\n将本构关系 $3$、$4$ 和 $5$ 代入 $1$ 和 $2$ 中，得到：\n$$ \\nabla \\times \\tilde{E} = - j \\omega \\mu \\tilde{H} $$\n$$ \\nabla \\times \\tilde{H} = \\sigma \\tilde{E} + j \\omega \\varepsilon \\tilde{E} = (\\sigma + j \\omega \\varepsilon) \\tilde{E} $$\n\n问题陈述场仅在 $x$ 方向上变化，并且只有特定分量：$\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$ 和 $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$。在这些条件下，笛卡尔坐标系中的旋度算子简化为：\n对于 $\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$，我们有 $\\nabla \\times \\tilde{E} = - \\frac{d\\tilde{E}_y}{dx} \\hat{z}$。\n对于 $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$，我们有 $\\nabla \\times \\tilde{H} = \\frac{d\\tilde{H}_z}{dx} \\hat{y}$。\n\n将这些简化的旋度代入麦克斯韦方程组，得到一个一维常微分方程组：\n$$ - \\frac{d\\tilde{E}_y}{dx} \\hat{z} = -j \\omega \\mu \\tilde{H}_z \\hat{z} \\implies \\frac{d\\tilde{E}_y}{dx} = j \\omega \\mu \\tilde{H}_z \\quad (I) $$\n$$ \\frac{d\\tilde{H}_z}{dx} \\hat{y} = (\\sigma + j \\omega \\varepsilon) \\tilde{E}_y \\hat{y} \\implies \\frac{d\\tilde{H}_z}{dx} = (\\sigma + j \\omega \\varepsilon) \\tilde{E}_y \\quad (II) $$\n\n为了得到关于 $\\tilde{H}_z$ 的控制方程，我们将方程 $(II)$ 对 $x$ 求导，并代入方程 $(I)$：\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} = (\\sigma + j \\omega \\varepsilon) \\frac{d\\tilde{E}_y}{dx} = (\\sigma + j \\omega \\varepsilon) (j \\omega \\mu \\tilde{H}_z) $$\n这就是关于 $\\tilde{H}_z(x)$ 的亥姆霍兹方程：\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} - \\gamma^2 \\tilde{H}_z = 0 $$\n其中 $\\gamma$ 是复传播常数，定义为 $\\gamma^2 = j \\omega \\mu (\\sigma + j \\omega \\varepsilon)$。\n\n通解为 $\\tilde{H}_z(x) = A e^{-\\gamma x} + C e^{\\gamma x}$。对于半空间 $x \\ge 0$ 中物理上现实的解，场必须在 $x \\to \\infty$ 时衰减。我们必须选择 $\\gamma$ 的根，使其满足实部 $\\Re\\{\\gamma\\} > 0$。这迫使增长指数项的系数为零，即 $C=0$。表面的边界条件为 $\\tilde{H}_z(0) = H_0$，这给出 $A=H_0$。因此，磁场的完整麦克斯韦解为：\n$$ \\tilde{H}_z(x) = H_0 e^{-\\gamma x} $$\n\n从方程 $(II)$，我们可以求出电场 $\\tilde{E}_y(x)$：\n$$ \\tilde{E}_y(x) = \\frac{1}{\\sigma + j \\omega \\varepsilon} \\frac{d\\tilde{H}_z}{dx} = \\frac{1}{\\sigma + j \\omega \\varepsilon} (- \\gamma H_0 e^{-\\gamma x}) = - \\frac{\\gamma}{\\sigma + j \\omega \\varepsilon} H_0 e^{-\\gamma x} $$\n涡流密度为 $\\tilde{J}_y(x) = \\sigma \\tilde{E}_y(x)$。因此，涡流密度的全解为：\n$$ \\tilde{J}_y(x) = - \\frac{\\sigma \\gamma}{\\sigma + j \\omega \\varepsilon} H_0 e^{-\\gamma x} \\quad (\\text{完整麦克斯韦解}) $$\n其中 $\\gamma = \\sqrt{j \\omega \\mu (\\sigma + j \\omega \\varepsilon)}$。\n\n接下来，我们推导磁准静态（MQS）解。MQS 近似忽略了位移电流，这等效于设置 $\\varepsilon = 0$，或者更正式地，舍去 $j \\omega \\varepsilon \\tilde{E}$ 项。安培-麦克斯韦定律变为 $\\nabla \\times \\tilde{H} = \\tilde{J} = \\sigma \\tilde{E}$。\n方程 $(II)$ 简化为 $\\frac{d\\tilde{H}_z}{dx} = \\sigma \\tilde{E}_y$。关于 $\\tilde{H}_z$ 的亥姆霍兹方程变为：\n$$ \\frac{d^2\\tilde{H}_z^{\\mathrm{MQS}}}{dx^2} - (\\gamma^{\\mathrm{MQS}})^2 \\tilde{H}_z^{\\mathrm{MQS}} = 0 $$\n其中 MQS 传播常数为 $(\\gamma^{\\mathrm{MQS}})^2 = j \\omega \\mu \\sigma$。\n应用相同的边界条件，磁场的解为：\n$$ \\tilde{H}_z^{\\mathrm{MQS}}(x) = H_0 e^{-\\gamma^{\\mathrm{MQS}} x} $$\n从简化的安培定律，$\\tilde{E}_y^{\\mathrm{MQS}}(x) = \\frac{1}{\\sigma} \\frac{d\\tilde{H}_z^{\\mathrm{MQS}}}{dx} = -\\frac{\\gamma^{\\mathrm{MQS}}}{\\sigma} H_0 e^{-\\gamma^{\\mathrm{MQS}} x}$。\n相应的 MQS 涡流密度为 $\\tilde{J}_y^{\\mathrm{MQS}}(x) = \\sigma \\tilde{E}_y^{\\mathrm{MQS}}(x)$：\n$$ \\tilde{J}_y^{\\mathrm{MQS}}(x) = - \\gamma^{\\mathrm{MQS}} H_0 e^{-\\gamma^{\\mathrm{MQS}} x} \\quad (\\text{MQS 解}) $$\n其中 $\\gamma^{\\mathrm{MQS}} = \\sqrt{j \\omega \\mu \\sigma}$。\n\nMQS 传播常数可以表示为 $\\gamma^{\\mathrm{MQS}} = \\sqrt{j} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\sqrt{2}} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\delta}$，其中 $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$ 是经典趋肤深度。问题将积分区间定义为 $x \\in [0, L]$，其中 $L = 5\\delta$。\n\nMQS 解与完整麦克斯韦解之间的相对 $L^2$ 误差为：\n$$ \\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}} $$\n为了计算 $\\mathcal{E}$，我们将使用数值积分。我们在区间 $[0, L]$ 上建立一个包含 $N \\ge 1000$ 个点的均匀网格。对于网格上的每个点 $x_i$，我们使用推导出的表达式计算 $\\tilde{J}_y(x_i)$ 和 $\\tilde{J}_y^{\\mathrm{MQS}}(x_i)$ 的复数值。然后，我们计算它们差值的模的平方作为分子被积函数，以及全解的模的平方作为分母被积函数。这些积分通过数值求积法则（如辛普森法则，一种在均匀网格上积分的标准方法）进行近似。最后，通过这些积分的比值计算误差 $\\mathcal{E}$。参数 $H_0$ 是所有电流密度中的一个公共乘法因子，因此在最终误差计算中被抵消。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetism problem for the given test cases.\n    It calculates the relative L2 error between the full Maxwell and MQS\n    solutions for eddy current density.\n    \"\"\"\n    \n    # Physical constants in SI units\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    EPSILON_0 = 8.854187817e-12  # Permittivity of free space (F/m)\n\n    test_cases = [\n        # Case 1: good conductor, low frequency, non-magnetic\n        # sigma (S/m), mu_r, epsilon_r, f (Hz), H0 (A/m)\n        (5.8e7, 1.0, 1.0, 60, 1.0),\n        # Case 2: magnetic material, moderate conductivity, low frequency\n        (1.0e6, 100.0, 1.0, 100, 1.0),\n        # Case 3: poor conductor, high permittivity, high frequency\n        (1.0e-6, 1.0, 4.0, 1.0e6, 1.0),\n        # Case 4: intermediate conductivity, higher frequency\n        (1.0e3, 1.0, 1.0, 1.0e5, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sigma, mu_r, epsilon_r, f, H0 = case\n        \n        # Absolute material properties\n        mu = mu_r * MU_0\n        epsilon = epsilon_r * EPSILON_0\n        omega = 2 * np.pi * f\n        \n        # --- MQS Solution ---\n        # MQS propagation constant\n        gamma_mqs = np.sqrt(1j * omega * mu * sigma)\n        \n        # Classical skin depth for MQS solution\n        # This defines the integration domain length L\n        if omega * mu * sigma > 0:\n            skin_depth_mqs = np.sqrt(2 / (omega * mu * sigma))\n        else:\n            # Handle cases with zero sigma or omega to avoid division by zero,\n            # though not present in test suite.\n            skin_depth_mqs = np.inf\n\n        L = 5 * skin_depth_mqs\n        \n        # If L is infinite or very large, cap it for practical computation.\n        # This scenario implies MQS predicts no decay, which would make the integral diverge.\n        # However, the test cases provided are well-behaved.\n        if np.isinf(L):\n           L = 1.0 # Fallback for non-conducting case.\n\n        # --- Full Maxwell Solution ---\n        # Full propagation constant\n        complex_permittivity = sigma + 1j * omega * epsilon\n        gamma_full = np.sqrt(1j * omega * mu * complex_permittivity)\n\n        # Ensure the root with positive real part is used for decaying wave\n        if np.real(gamma_full)  0:\n            gamma_full = -gamma_full\n        \n        # --- Numerical Integration Setup ---\n        # Create a uniform grid with N > 1000 points\n        N = 2000\n        x = np.linspace(0, L, N)\n\n        # --- Calculate Current Densities on the Grid ---\n        # The constant H0 cancels in the relative error formula.\n        # J_y(x) = C_full * exp(-gamma_full * x)\n        # J_y_MQS(x) = C_mqs * exp(-gamma_mqs * x)\n        \n        # Prefactor for full Maxwell current density\n        C_full = -H0 * sigma * gamma_full / complex_permittivity\n        \n        # Prefactor for MQS current density\n        C_mqs = -H0 * gamma_mqs\n        \n        # Evaluate current densities on the grid\n        J_full_vals = C_full * np.exp(-gamma_full * x)\n        J_mqs_vals = C_mqs * np.exp(-gamma_mqs * x)\n        \n        # --- Compute L2 Norms using Simpson's Rule ---\n        # The integrands are the squared magnitudes\n        integrand_num = np.abs(J_full_vals - J_mqs_vals)**2\n        integrand_den = np.abs(J_full_vals)**2\n\n        # Integrate using scipy.integrate.simpson\n        integral_num = simpson(y=integrand_num, x=x)\n        integral_den = simpson(y=integrand_den, x=x)\n        \n        # --- Calculate Relative Error ---\n        # Guard against division by zero if the true solution is identically zero\n        if integral_den == 0:\n            error = 0.0 if integral_num == 0 else np.inf\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        results.append(error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在频率足够高时，时变电流会以电磁波的形式向外辐射能量，这是麦克斯韦方程组最深刻的预言之一。本练习将带你进入电磁辐射的世界，通过计算时谐电偶极子源在远场的辐射模式来实践这一概念。你将应用远场近似，从矢量势 $\\mathbf{A}$ 推导出发射电场 $\\mathbf{E}$，并探索多个源之间的相干叠加如何形成复杂的干涉图样，这是天线设计和光学中的核心问题。",
            "id": "3514117",
            "problem": "考虑一个置于真空中的局域时谐电磁源，其时间依赖关系由复数约定 $\\mathrm{e}^{- \\mathrm{i} \\omega t}$ 定义，其中 $\\omega$ 是角频率。电磁场在真空中遵循麦克斯韦方程组：\n$$\\nabla \\cdot \\mathbf{E} = \\frac{\\rho}{\\varepsilon_0}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}, \\quad \\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t},$$\n电磁势定义为 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 和 $\\mathbf{E} = - \\nabla \\Phi - \\frac{\\partial \\mathbf{A}}{\\partial t}$，并满足洛伦兹规范条件 $\\nabla \\cdot \\mathbf{A} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\Phi}{\\partial t} = 0$。你将仅从这些基本定律和定义出发，通过在辐射区中计算矢量势 $\\mathbf{A}$ 并从势中导出 $\\mathbf{E}$ 和 $\\mathbf{B}$，来计算产生的远场辐射图样。将介质视为真空，光速为 $c$，本构参数为国际单位制（SI）中的 $\\varepsilon_0$ 和 $\\mu_0$。\n\n使用针对局域源的辐射区近似，以获得在固定的、大的观测距离 $r$ 处场的角依赖性。设观测方向由球面角 $(\\theta,\\phi)$（单位为弧度）参数化，单位矢量 $\\mathbf{n} = (\\sin\\theta \\cos\\phi, \\sin\\theta \\sin\\phi, \\cos\\theta)$ 指向从源到观测点的方向。目标是计算在指定角度下电场的大小 $\\lVert \\mathbf{E} \\rVert$（单位为伏特/米），用于以下的测试组。\n\n将源建模为一系列点电偶极子之和，其复振幅为 $\\mathbf{p}_m$，位于位置 $\\mathbf{r}_m$（以米表示），且与时谐源的电荷连续性方程一致。假设真空值为 $c = 299792458\\,\\mathrm{m/s}$ 和 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$，以及 $\\varepsilon_0 = 1/(\\mu_0 c^2)\\,\\mathrm{F/m}$。对于以下所有情况，使用观测距离 $r = 1000\\,\\mathrm{m}$。\n\n你的程序必须计算辐射区矢量势，使用麦克斯韦方程组和洛伦兹规范从势推导出横向电场，然后计算在每个列出的角度处的电场大小 $\\lVert \\mathbf{E} \\rVert$。角度以弧度为单位。所有 $\\lVert \\mathbf{E} \\rVert$ 的输出都以 $\\mathrm{V/m}$ 为单位表示。\n\n测试组：\n1. 情况1（一般情况）：位于原点的单个电偶极子，其偶极矩为 $\\mathbf{p} = (0,0,p_0)$，其中 $p_0 = 1 \\times 10^{-10}\\,\\mathrm{C \\cdot m}$，频率为 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$，因此 $\\omega = 2 \\pi f$。在角度 $(\\theta,\\phi)$ 等于 $(0,0)$、$(\\pi/4,0)$ 和 $(\\pi/2,0)$ 处计算 $\\lVert \\mathbf{E} \\rVert$。\n2. 情况2（低频边界）：与情况1相同的偶极子，但频率为 $f = 3 \\times 10^{6}\\,\\mathrm{Hz}$，即 $\\omega = 2 \\pi f$。在 $(0,0)$、$(\\pi/4,0)$ 和 $(\\pi/2,0)$ 处计算 $\\lVert \\mathbf{E} \\rVert$。\n3. 情况3（干涉与对称性）：两个电偶极子，位于 $\\mathbf{r}_1 = (d/2,0,0)$ 和 $\\mathbf{r}_2 = (-d/2,0,0)$，其中 $d = 0.5\\,\\mathrm{m}$，偶极矩分别为 $\\mathbf{p}_1 = (0,0,p_0)$ 和 $\\mathbf{p}_2 = (0,0,-p_0)$，频率为 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$。在 $(\\pi/2,0)$、$(\\pi/2,\\pi/2)$、$(0,0)$ 和 $(\\pi/4,0)$ 处计算 $\\lVert \\mathbf{E} \\rVert$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。该列表应按顺序包含情况1所有角度的 $\\lVert \\mathbf{E} \\rVert$ 值（单位V/m），接着是情况2，然后是按上述顺序排列的情况3。数值输出必须是标准的浮点数。",
            "solution": "该问题已根据规定标准进行验证。\n\n### 步骤1：提取已知条件\n- **控制方程**：真空中的麦克斯韦方程组：\n  - $\\nabla \\cdot \\mathbf{E} = \\frac{\\rho}{\\varepsilon_0}$\n  - $\\nabla \\cdot \\mathbf{B} = 0$\n  - $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$\n  - $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$\n- **时间依赖性**：$\\mathrm{e}^{- \\mathrm{i} \\omega t}$，其中 $\\omega$ 为角频率。\n- **势的定义**：\n  - $\\mathbf{B} = \\nabla \\times \\mathbf{A}$\n  - $\\mathbf{E} = - \\nabla \\Phi - \\frac{\\partial \\mathbf{A}}{\\partial t}$\n- **规范条件**：洛伦兹规范，$\\nabla \\cdot \\mathbf{A} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\Phi}{\\partial t} = 0$。\n- **介质**：真空。\n- **常数**：\n  - $c = 299792458\\,\\mathrm{m/s}$\n  - $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n  - $\\varepsilon_0 = 1/(\\mu_0 c^2)\\,\\mathrm{F/m}$\n- **源模型**：一系列点电偶极子之和，其复振幅为 $\\mathbf{p}_m$，位于位置 $\\mathbf{r}_m$。\n- **观测参数**：\n  - 距离：$r = 1000\\,\\mathrm{m}$（辐射区）。\n  - 方向：由球面角 $(\\theta,\\phi)$（单位为弧度）参数化，单位矢量为 $\\mathbf{n} = (\\sin\\theta \\cos\\phi, \\sin\\theta \\sin\\phi, \\cos\\theta)$。\n- **目标**：计算电场的大小 $\\lVert \\mathbf{E} \\rVert$，单位为 $\\mathrm{V/m}$。\n- **测试组**：\n  - **情况1**：单个偶极子 $\\mathbf{p} = (0,0,10^{-10})\\,\\mathrm{C \\cdot m}$ 位于 $\\mathbf{r}=(0,0,0)$。频率 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$。角度 $(\\theta,\\phi)$：$(0,0)$, $(\\pi/4,0)$, $(\\pi/2,0)$。\n  - **情况2**：与情况1相同，但 $f = 3 \\times 10^{6}\\,\\mathrm{Hz}$。角度 $(\\theta,\\phi)$：$(0,0)$, $(\\pi/4,0)$, $(\\pi/2,0)$。\n  - **情况3**：两个偶极子，频率 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$。$\\mathbf{p}_1 = (0,0,10^{-10})\\,\\mathrm{C \\cdot m}$ 位于 $\\mathbf{r}_1=(0.25,0,0)\\,\\mathrm{m}$。$\\mathbf{p}_2 = (0,0,-10^{-10})\\,\\mathrm{C \\cdot m}$ 位于 $\\mathbf{r}_2=(-0.25,0,0)\\,\\mathrm{m}$（因为 $d=0.5\\,\\mathrm{m}$）。角度 $(\\theta,\\phi)$：$(\\pi/2,0)$, $(\\pi/2,\\pi/2)$, $(0,0)$, $(\\pi/4,0)$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于麦克斯韦方程组、电磁势以及已建立的局域源辐射理论。这些是经典电动力学的基石原理。所有常数和关系都是标准和正确的。该问题在科学上是合理的。\n- **适定性**：该问题指定了源和观测点，对此存在唯一的电磁场解。这是一个适定的边值问题。\n- **目标**：问题以精确、无歧义的科学语言陈述，不含主观因素。\n- **缺陷分析**：该问题没有列举的缺陷。它自成体系、科学一致、物理上合理，并且需要电磁理论的实质性应用，而不是琐碎或同义反复的。\n\n### 步骤3：结论与行动\n问题陈述有效。将提供一个完整且论证充分的解。\n\n### 求解推导\n目标是根据一组局域时谐电偶极子计算远场区电场的大小 $\\lVert \\mathbf{E} \\rVert$。推导从提供的基本方程开始。\n\n对于 $\\mathrm{e}^{-\\mathrm{i}\\omega t}$ 的时谐依赖关系，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为 $-\\mathrm{i}\\omega$。势的定义和洛伦兹规范变为：\n$\\mathbf{E} = -\\nabla\\Phi + \\mathrm{i}\\omega\\mathbf{A}$\n$\\nabla\\cdot\\mathbf{A} - \\mathrm{i}\\omega\\mu_0\\varepsilon_0\\Phi = 0$\n\n根据洛伦兹规范，我们用矢量势 $\\mathbf{A}$ 表示标量势 $\\Phi$。使用 $\\mu_0\\varepsilon_0 = 1/c^2$，我们得到 $\\Phi = \\frac{c^2}{\\mathrm{i}\\omega}\\nabla\\cdot\\mathbf{A}$。\n\n将 $\\Phi$ 代入 $\\mathbf{E}$ 的表达式，得到：\n$\\mathbf{E} = -\\nabla\\left(\\frac{c^2}{\\mathrm{i}\\omega}\\nabla\\cdot\\mathbf{A}\\right) + \\mathrm{i}\\omega\\mathbf{A}$\n\n由时谐电流分布 $\\mathbf{J}(\\mathbf{r}')$ 产生的矢量势 $\\mathbf{A}$ 是非齐次亥姆霍兹方程的解，由推迟势积分给出：\n$$ \\mathbf{A}(\\mathbf{r}) = \\frac{\\mu_0}{4\\pi} \\int \\frac{\\mathbf{J}(\\mathbf{r}') e^{\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}'|}}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}' $$\n其中 $k = \\omega/c$ 是波数。\n\n位于位置 $\\mathbf{r}_m$ 的偶极矩为 $\\mathbf{p}_m e^{-\\mathrm{i}\\omega t}$ 的点电偶极子，对应于复振幅为 $\\mathbf{J}(\\mathbf{r}') = -\\mathrm{i}\\omega\\mathbf{p}_m\\delta(\\mathbf{r}'-\\mathbf{r}_m)$ 的电流密度。对于这样一组偶极子，矢量势为：\n$$ \\mathbf{A}(\\mathbf{r}) = \\sum_m \\frac{\\mu_0}{4\\pi} \\int \\frac{(-\\mathrm{i}\\omega\\mathbf{p}_m)\\delta(\\mathbf{r}'-\\mathbf{r}_m) e^{\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}'|}}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}' = \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\sum_m \\mathbf{p}_m \\frac{e^{\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}_m|}}{|\\mathbf{r}-\\mathbf{r}_m|} $$\n\n在远场（辐射区），观测距离 $r=|\\mathbf{r}|$ 远大于源的尺寸（$r \\gg |\\mathbf{r}_m|$）和波长（$r \\gg \\lambda=2\\pi/k$），我们应用以下近似：\n1. 振幅项：$|\\mathbf{r}-\\mathbf{r}_m| \\approx r$。\n2. 相位项：$|\\mathbf{r}-\\mathbf{r}_m| \\approx r - \\mathbf{n}\\cdot\\mathbf{r}_m$，其中 $\\mathbf{n}=\\mathbf{r}/r$ 是观测方向的单位矢量。\n\n因此，远场中的矢量势简化为：\n$$ \\mathbf{A}(\\mathbf{r}) \\approx \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\frac{e^{\\mathrm{i}kr}}{r} \\sum_m \\mathbf{p}_m e^{-\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{r}_m} $$\n让我们定义矢量结构因子 $\\mathbf{F}(\\mathbf{n})$ 为对所有源的求和：\n$$ \\mathbf{F}(\\mathbf{n}) = \\sum_m \\mathbf{p}_m e^{-\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{r}_m} $$\n则 $\\mathbf{A}(\\mathbf{r}) \\approx \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\frac{e^{\\mathrm{i}kr}}{r} \\mathbf{F}(\\mathbf{n})$。\n\n为了求电场 $\\mathbf{E}$，我们注意到在远场中，空间导数主要由相位项 $e^{\\mathrm{i}kr}$ 的梯度决定，因此 $\\nabla \\approx \\mathrm{i}k\\mathbf{n}$。将此应用于势之间的关系：\n$\\nabla\\cdot\\mathbf{A} \\approx \\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{A}$。\n$\\Phi = \\frac{c^2}{\\mathrm{i}\\omega}(\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{A}) = \\frac{c^2 k}{\\omega}(\\mathbf{n}\\cdot\\mathbf{A}) = c(\\mathbf{n}\\cdot\\mathbf{A})$。\n则 $\\mathbf{E} = -\\nabla\\Phi + \\mathrm{i}\\omega\\mathbf{A} \\approx -\\mathrm{i}k\\mathbf{n}(c(\\mathbf{n}\\cdot\\mathbf{A})) + \\mathrm{i}\\omega\\mathbf{A} = -\\mathrm{i}\\omega\\mathbf{n}(\\mathbf{n}\\cdot\\mathbf{A}) + \\mathrm{i}\\omega\\mathbf{A}$。\n提出因子 $\\mathrm{i}\\omega$：\n$$ \\mathbf{E}(\\mathbf{r}) \\approx \\mathrm{i}\\omega[\\mathbf{A} - \\mathbf{n}(\\mathbf{n}\\cdot\\mathbf{A})] = -\\mathrm{i}\\omega[\\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{A})] $$\n这明确表明远场区电场垂直于传播方向 $\\mathbf{n}$。\n\n代入 $\\mathbf{A}$ 的远场表达式：\n$$ \\mathbf{E}(\\mathbf{r}) \\approx -\\mathrm{i}\\omega \\left[ \\mathbf{n} \\times \\left( \\mathbf{n} \\times \\left( \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\frac{e^{\\mathrm{i}kr}}{r} \\mathbf{F}(\\mathbf{n}) \\right) \\right) \\right] = \\frac{-\\omega^2\\mu_0}{4\\pi r} e^{\\mathrm{i}kr} \\left[\\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{F}(\\mathbf{n}))\\right] $$\n\n我们要求的是复矢量电场的大小 $\\lVert \\mathbf{E} \\rVert$。项 $e^{\\mathrm{i}kr}$ 的大小为1。\n$$ \\lVert \\mathbf{E} \\rVert = \\frac{\\omega^2\\mu_0}{4\\pi r} \\lVert \\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{F}(\\mathbf{n})) \\rVert $$\n由于 $\\mathbf{n}$ 是单位矢量，且 $\\mathbf{n}\\times\\mathbf{F}$ 与其垂直，矢量三重积的大小简化为：$\\lVert \\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{F}) \\rVert = \\lVert \\mathbf{n}\\times\\mathbf{F} \\rVert$。\n需要实现的最终表达式是：\n$$ \\lVert \\mathbf{E}(\\mathbf{r}) \\rVert = \\frac{\\omega^2\\mu_0}{4\\pi r} \\left\\lVert \\mathbf{n} \\times \\left( \\sum_m \\mathbf{p}_m e^{-\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{r}_m} \\right) \\right\\rVert $$\n此公式将应用于每个测试用例。对于给定的频率 $f$ 和偶极子集合 $\\{\\mathbf{p}_m, \\mathbf{r}_m\\}$，我们为每个指定的观测方向 $\\mathbf{n}(\\theta, \\phi)$ 计算此表达式。叉积的复数结果的模计算为 $\\sqrt{\\mathbf{v} \\cdot \\mathbf{v}^*}$，其中 $\\mathbf{v}^*$ 是 $\\mathbf{v}$ 的复共轭。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetic radiation problem for the given test cases.\n    \"\"\"\n    # Define physical constants\n    C_LIGHT = 299792458.0  # Speed of light in m/s\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space in H/m\n    R_OBS = 1000.0  # Observation distance in m\n\n    def compute_e_field_magnitude(sources, freq, theta, phi):\n        \"\"\"\n        Computes the magnitude of the far-zone electric field.\n\n        Args:\n            sources (list): A list of tuples, where each tuple contains\n                            a dipole moment vector (numpy array) and a\n                            position vector (numpy array).\n            freq (float): The frequency of the source in Hz.\n            theta (float): The polar angle of observation in radians.\n            phi (float): The azimuthal angle of observation in radians.\n\n        Returns:\n            float: The magnitude of the electric field in V/m.\n        \"\"\"\n        # Calculate derived physical parameters\n        omega = 2 * np.pi * freq\n        k = omega / C_LIGHT\n\n        # Observation direction unit vector\n        n_hat = np.array([\n            np.sin(theta) * np.cos(phi),\n            np.sin(theta) * np.sin(phi),\n            np.cos(theta)\n        ])\n\n        # Calculate the vector structure factor F(n)\n        # F(n) = sum over m [p_m * exp(-i*k*n.r_m)]\n        F_vec = np.zeros(3, dtype=complex)\n        for p_m, r_m in sources:\n            phase_factor = np.exp(-1j * k * np.dot(n_hat, r_m))\n            F_vec += p_m * phase_factor\n\n        # The term inside the norm is n x F(n)\n        cross_product_vec = np.cross(n_hat, F_vec)\n        \n        # Calculate the magnitude of the complex vector\n        # ||v|| = sqrt(v . v*) = sqrt(sum |v_i|^2)\n        norm_cross_product = np.linalg.norm(cross_product_vec)\n\n        # Prefactor K = omega^2 * mu_0 / (4*pi*r)\n        prefactor = (omega**2 * MU_0) / (4 * np.pi * R_OBS)\n\n        # Final E-field magnitude\n        e_mag = prefactor * norm_cross_product\n        return e_mag\n\n    # Define the test cases from the problem statement\n    p0 = 1e-10  # C.m\n\n    # Case 1: Single dipole at origin, f = 300 MHz\n    case1_sources = [(np.array([0.0, 0.0, p0]), np.array([0.0, 0.0, 0.0]))]\n    case1_freq = 300e6\n    case1_angles = [\n        (0.0, 0.0),\n        (np.pi / 4, 0.0),\n        (np.pi / 2, 0.0),\n    ]\n\n    # Case 2: Single dipole at origin, f = 3 MHz\n    case2_sources = case1_sources\n    case2_freq = 3e6\n    case2_angles = case1_angles\n\n    # Case 3: Two-dipole array, f = 300 MHz\n    d = 0.5 # m\n    case3_sources = [\n        (np.array([0.0, 0.0, p0]), np.array([d / 2, 0.0, 0.0])),\n        (np.array([0.0, 0.0, -p0]), np.array([-d / 2, 0.0, 0.0])),\n    ]\n    case3_freq = 300e6\n    case3_angles = [\n        (np.pi / 2, 0.0),\n        (np.pi / 2, np.pi / 2),\n        (0.0, 0.0),\n        (np.pi / 4, 0.0),\n    ]\n    \n    test_suite = [\n        (case1_sources, case1_freq, case1_angles),\n        (case2_sources, case2_freq, case2_angles),\n        (case3_sources, case3_freq, case3_angles),\n    ]\n    \n    results = []\n    \n    for sources, freq, angles in test_suite:\n        for theta, phi in angles:\n            result = compute_e_field_magnitude(sources, freq, theta, phi)\n            results.append(result)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}