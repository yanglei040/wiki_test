{
    "hands_on_practices": [
        {
            "introduction": "本节的实践练习旨在将麦克斯韦方程组的静电学原理应用于实际的边界值问题。我们将通过数值方法解决一个包含不同介电材料的系统中的电势分布，这对于理解和模拟复合材料或设备中的电场至关重要。这项练习不仅能加深对高斯定律和界面连续性条件的理解 ，还能培养使用有限体积法解决偏微分方程的实用技能。",
            "id": "3514139",
            "problem": "考虑一个二维静电边值问题，该问题由麦克斯韦方程组在一个宽度为 $W$、高度为 $H$ 的矩形域上控制。该域被位于 $x = W/2$ 的垂直界面划分为两个子域。左子域具有均匀、对角、可能为复数的介电常数张量 $\\boldsymbol{\\varepsilon}^{(L)} = \\mathrm{diag}(\\varepsilon_{x}^{(L)}, \\varepsilon_{y}^{(L)})$，右子域具有均匀、对角、可能为复数的介电常数张量 $\\boldsymbol{\\varepsilon}^{(R)} = \\mathrm{diag}(\\varepsilon_{x}^{(R)}, \\varepsilon_{y}^{(R)})$。静电势 $\\phi(x,y)$ 满足本构关系 $\\mathbf{D} = \\boldsymbol{\\varepsilon}\\,\\mathbf{E}$ 和 $\\mathbf{E} = -\\nabla \\phi$，在没有自由电荷的情况下，高斯定律为 $\\nabla \\cdot \\mathbf{D} = 0$。将这些关系结合起来，得到控制方程\n$$\n\\nabla \\cdot \\left( \\boldsymbol{\\varepsilon}(x,y)\\,\\nabla \\phi(x,y) \\right) = 0\n$$\n其中，$\\boldsymbol{\\varepsilon}(x,y)$ 是分段常数，当 $x  W/2$ 时等于 $\\boldsymbol{\\varepsilon}^{(L)}$，当 $x \\ge W/2$ 时等于 $\\boldsymbol{\\varepsilon}^{(R)}$。施加狄利克雷边界条件 $\\phi(0,y) = V_{\\mathrm{left}}$、$\\phi(W,y) = V_{\\mathrm{right}}$、$\\phi(x,0) = V_{\\mathrm{bottom}}$ 和 $\\phi(x,H) = V_{\\mathrm{top}}$，所有电压单位均为伏特 (V)。在界面处，物理连续性条件为：电势 $\\phi$ 是连续的，电场 $\\mathbf{E}$ 的切向分量是连续的（单位：伏特每米, V/m），电通量密度 $\\mathbf{D}$ 的法向分量是连续的（单位：库仑每平方米, C/m$^2$）。\n\n使用 $x$ 方向 $N_x$ 个点和 $y$ 方向 $N_y$ 个点的均匀网格离散化该域。对于对角 $\\boldsymbol{\\varepsilon}$，使用算子 $\\nabla \\cdot (\\boldsymbol{\\varepsilon}\\,\\nabla \\phi)$ 的保守有限体积离散化：在垂直面上对 $\\varepsilon_x$、在水平面上对 $\\varepsilon_y$ 使用调和平均计算面心系数，并为内部节点组装得到的五点模板线性系统；对于边界节点，直接施加狄利克雷条件。\n\n求解出 $\\phi(x,y)$ 后，沿着位于最左侧列和最右侧第一列之间的整个垂直界面线，数值验证界面的连续性。定义以下度量：\n\n- 穿过界面的电场切向分量跳变的最大幅值，\n$$\n\\Delta E_{\\mathrm{t},\\max} = \\max_{y\\ \\mathrm{grid}}\\left| E_y^{(L)}(y) - E_y^{(R)}(y) \\right|,\n$$\n其中，$E_y^{(L)}(y)$ 在最左侧列通过 $y$ 方向的中心有限差分近似计算，$E_y^{(R)}(y)$ 在最右侧第一列通过相应的 $y$ 方向中心有限差分近似计算。$\\Delta E_{\\mathrm{t},\\max}$ 以伏特每米 (V/m) 表示。\n\n- 穿过界面的电通量密度法向分量跳变的最大幅值，\n$$\n\\Delta D_{\\mathrm{n},\\max} = \\max_{y\\ \\mathrm{grid}}\\left| D_x^{(L)}(y) - D_x^{(R)}(y) \\right|,\n$$\n其中，$D_x^{(L)}(y) = \\varepsilon_{x}^{(L)}\\,E_x^{(L)}(y)$ 且 $D_x^{(R)}(y) = \\varepsilon_{x}^{(R)}\\,E_x^{(R)}(y)$，$E_x^{(L)}(y)$ 在最左侧列通过 $x$ 方向的后向有限差分近似计算，$E_x^{(R)}(y)$ 在最右侧第一列通过 $x$ 方向的后向有限差分近似计算。$\\Delta D_{\\mathrm{n},\\max}$ 以库仑每平方米 (C/m$^2$) 表示。\n\n使用真空介电常数 $\\varepsilon_0 = 8.854187817 \\times 10^{-12}$ F/m，并以相量意义处理复数值介电常数和电势。在计算复数量的跳变幅值时，使用复模数。\n\n您的程序必须实现这种离散化和评估，并为以下测试套件生成结果。所有测试的几何形状和边界值均相同：\n\n- 几何与网格：\n    - $W = 1.0 \\times 10^{-2}$ m,\n    - $H = 1.0 \\times 10^{-2}$ m,\n    - $N_x = 64$,\n    - $N_y = 64$.\n\n- 边界条件（狄利克雷）：\n    - $V_{\\mathrm{left}} = 0.5$ V,\n    - $V_{\\mathrm{right}} = 0.0$ V,\n    - $V_{\\mathrm{bottom}} = 0.0$ V,\n    - $V_{\\mathrm{top}} = 1.0$ V.\n\n- 测试用例（材料张量）：\n    1. 各向同性，实数：\n        - 左侧：$\\boldsymbol{\\varepsilon}^{(L)} = \\mathrm{diag}(2\\,\\varepsilon_0,\\,2\\,\\varepsilon_0)$\n        - 右侧：$\\boldsymbol{\\varepsilon}^{(R)} = \\mathrm{diag}(5\\,\\varepsilon_0,\\,5\\,\\varepsilon_0)$\n    2. 各向异性，实数（对角反差）：\n        - 左侧：$\\boldsymbol{\\varepsilon}^{(L)} = \\mathrm{diag}(1\\,\\varepsilon_0,\\,10\\,\\varepsilon_0)$\n        - 右侧：$\\boldsymbol{\\varepsilon}^{(R)} = \\mathrm{diag}(10\\,\\varepsilon_0,\\,1\\,\\varepsilon_0)$\n    3. 各向异性，复数（对角）：\n        - 左侧：$\\boldsymbol{\\varepsilon}^{(L)} = \\mathrm{diag}\\big((2 + 0.5\\,\\mathrm{i})\\,\\varepsilon_0,\\,(3 + 0.2\\,\\mathrm{i})\\,\\varepsilon_0\\big)$\n        - 右侧：$\\boldsymbol{\\varepsilon}^{(R)} = \\mathrm{diag}\\big((5 + 1.0\\,\\mathrm{i})\\,\\varepsilon_0,\\,(1 + 0.1\\,\\mathrm{i})\\,\\varepsilon_0\\big)$\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个包含两个浮点数的列表 $[\\Delta E_{\\mathrm{t},\\max}, \\Delta D_{\\mathrm{n},\\max}]$，单位如上所述，在复数情况下使用复模数计算幅值。例如，输出格式必须类似于\n$$\n[\\,[\\Delta E_{\\mathrm{t},\\max}^{(1)},\\Delta D_{\\mathrm{n},\\max}^{(1)}],\\,[\\Delta E_{\\mathrm{t},\\max}^{(2)},\\Delta D_{\\mathrm{n},\\max}^{(2)}],\\,[\\Delta E_{\\mathrm{t},\\max}^{(3)},\\Delta D_{\\mathrm{n},\\max}^{(3)}]\\,].\n$$",
            "solution": "静电边值问题源于基本原理。从没有自由电荷时的高斯定律 $\\nabla \\cdot \\mathbf{D} = 0$ 和本构关系 $\\mathbf{D} = \\boldsymbol{\\varepsilon}\\,\\mathbf{E}$ 开始，其中电场 $\\mathbf{E} = -\\nabla \\phi$。代入后得到二阶椭圆方程\n$$\n\\nabla \\cdot \\left( \\boldsymbol{\\varepsilon}(x,y)\\,\\nabla \\phi(x,y) \\right) = 0,\n$$\n其中 $\\boldsymbol{\\varepsilon}(x,y)$ 在每个子域内是分段常数和对角的。在没有自由表面电荷和表面电流的材料界面上，电势 $\\phi$ 是连续的，电场 $\\mathbf{E}$ 的切向分量是连续的，电通量密度 $\\mathbf{D}$ 的法向分量是连续的。在外边界上，施加狄利克雷条件 $\\phi = V$，确保得到一个适定的线性系统。\n\n为在均匀网格上离散化该方程，采用保守有限体积法 (FVM)，该方法与散度形式一致，并能保证局部通量守恒。设网格在 $x$ 方向有 $N_x$ 个点，在 $y$ 方向有 $N_y$ 个点，间距分别为 $\\Delta x = W/(N_x - 1)$ 和 $\\Delta y = H/(N_y - 1)$。将节点 $(i,j)$ 处的离散电势记为 $\\phi_{i,j}$。对于对角介电常数张量 $\\boldsymbol{\\varepsilon} = \\mathrm{diag}(\\varepsilon_x, \\varepsilon_y)$，通过单元面的通量近似为\n$$\nF_x\\big|_{i+\\frac{1}{2},j} \\approx \\varepsilon_{x,i+\\frac{1}{2},j}\\,\\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x},\n\\quad\nF_y\\big|_{i,j+\\frac{1}{2}} \\approx \\varepsilon_{y,i,j+\\frac{1}{2}}\\,\\frac{\\phi_{i,j+1} - \\phi_{i,j}}{\\Delta y},\n$$\n其中，面心系数通过调和平均计算，以确保跨越材料属性跳变处的通量连续性：\n$$\n\\varepsilon_{x,i+\\frac{1}{2},j} = \\frac{2\\,\\varepsilon_{x,i,j}\\,\\varepsilon_{x,i+1,j}}{\\varepsilon_{x,i,j} + \\varepsilon_{x,i+1,j}},\n\\quad\n\\varepsilon_{y,i,j+\\frac{1}{2}} = \\frac{2\\,\\varepsilon_{y,i,j}\\,\\varepsilon_{y,i,j+1}}{\\varepsilon_{y,i,j} + \\varepsilon_{y,i,j+1}}.\n$$\n对每个控制体应用离散散度，得到五点模板\n$$\n- \\left( a_E + a_W + a_N + a_S \\right)\\,\\phi_{i,j}\n+ a_E\\,\\phi_{i+1,j} + a_W\\,\\phi_{i-1,j} + a_N\\,\\phi_{i,j+1} + a_S\\,\\phi_{i,j-1} = 0,\n$$\n系数为\n$$\na_E = \\frac{\\varepsilon_{x,i+\\frac{1}{2},j}}{\\Delta x^2},\\quad\na_W = \\frac{\\varepsilon_{x,i-\\frac{1}{2},j}}{\\Delta x^2},\\quad\na_N = \\frac{\\varepsilon_{y,i,j+\\frac{1}{2}}}{\\Delta y^2},\\quad\na_S = \\frac{\\varepsilon_{y,i,j-\\frac{1}{2}}}{\\Delta y^2}.\n$$\n对于外边界上的节点，通过设置 $\\phi_{i,j} = V_{\\mathrm{boundary}}$ 并用一个单位行替换相应的方程来直接施加狄利克雷条件。\n\n得到的线性系统 $A\\,\\boldsymbol{\\phi} = \\mathbf{b}$ 以稀疏格式组装，并使用鲁棒的稀疏直接求解器求解。该系统支持复数值系数和未知数，将 $\\boldsymbol{\\varepsilon}$ 和 $\\phi$ 解释为相量，因此解与由复介电常数表示的静电准静态传导损耗保持一致。\n\n为验证界面连续性，选择位于列 $i_{\\mathrm{L}}$ 和 $i_{\\mathrm{R}} = i_{\\mathrm{L}} + 1$ 之间的垂直界面，其中 $i_{\\mathrm{L}} = \\lfloor N_x/2 \\rfloor - 1$。沿该界面的切向是 $y$ 方向，法向是 $x$ 方向。通过离散微分计算电场分量：\n\n- 最左侧列和最右侧第一列的切向电场通过 $y$ 方向的中心差分计算（不包括顶部和底部边界，以避免单边差分）：\n$$\nE_y^{(L)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{L}},\\,j+1} - \\phi_{i_{\\mathrm{L}},\\,j-1}}{2\\,\\Delta y},\\quad\nE_y^{(R)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{R}},\\,j+1} - \\phi_{i_{\\mathrm{R}},\\,j-1}}{2\\,\\Delta y}.\n$$\n使用复模数来量化差异并定义\n$$\n\\Delta E_{\\mathrm{t},\\max} = \\max_{j=1,\\ldots,N_y-2} \\left| E_y^{(L)}(j) - E_y^{(R)}(j) \\right|,\n$$\n单位为伏特每米 (V/m)。\n\n- 两侧的电通量密度法向分量通过 $x$ 方向的单边差分计算：\n$$\nE_x^{(L)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{L}},\\,j} - \\phi_{i_{\\mathrm{L}}-1,\\,j}}{\\Delta x},\\quad\nE_x^{(R)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{R}},\\,j} - \\phi_{i_{\\mathrm{R}}-1,\\,j}}{\\Delta x},\n$$\n然后\n$$\nD_x^{(L)}(j) = \\varepsilon_{x}^{(L)}\\,E_x^{(L)}(j),\\quad\nD_x^{(R)}(j) = \\varepsilon_{x}^{(R)}\\,E_x^{(R)}(j).\n$$\n定义跳变度量\n$$\n\\Delta D_{\\mathrm{n},\\max} = \\max_{j=1,\\ldots,N_y-2} \\left| D_x^{(L)}(j) - D_x^{(R)}(j) \\right|,\n$$\n单位为库仑每平方米 (C/m$^2$)。对于复数值场，使用复模数计算幅值。\n\n此过程在混合狄利克雷边界条件下，同时评估了材料界面上切向 $\\mathbf{E}$ 和法向 $\\mathbf{D}$ 的连续性，为各向同性、各向异性及复数值介电常数张量提供了一个严格的测试。最终程序使用调和面系数组装稀疏系统，求解 $\\phi$，为每个测试用例计算界面度量 $\\Delta E_{\\mathrm{t},\\max}$ 和 $\\Delta D_{\\mathrm{n},\\max}$，并打印一行包含整个测试套件的配对列表 $[\\Delta E_{\\mathrm{t},\\max}, \\Delta D_{\\mathrm{n},\\max}]$，单位如指定。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef harmonic_average(a, b):\n    # Handles complex values; avoid division by zero by small regularization if needed\n    return (2.0 * a * b) / (a + b)\n\ndef assemble_and_solve(W, H, Nx, Ny, eps_left, eps_right, V_left, V_right, V_bottom, V_top):\n    # Grid spacings\n    dx = W / (Nx - 1)\n    dy = H / (Ny - 1)\n\n    # Material property arrays (diagonal tensors: eps_x, eps_y)\n    eps_x = np.empty((Nx, Ny), dtype=np.complex128)\n    eps_y = np.empty((Nx, Ny), dtype=np.complex128)\n\n    # Interface column index: last left column and first right column\n    iL = (Nx // 2) - 1\n    iR = iL + 1\n\n    # Fill material tensors: left side columns [0..iL], right side [iR..Nx-1]\n    eps_x[:iR, :] = eps_left[0]\n    eps_y[:iR, :] = eps_left[1]\n    eps_x[iR:, :] = eps_right[0]\n    eps_y[iR:, :] = eps_right[1]\n\n    N = Nx * Ny\n    A = lil_matrix((N, N), dtype=np.complex128)\n    b = np.zeros(N, dtype=np.complex128)\n\n    def idx(i, j):\n        return i + Nx * j\n\n    # Assemble matrix\n    for j in range(Ny):\n        for i in range(Nx):\n            p = idx(i, j)\n            # Boundary Dirichlet conditions\n            on_left = (i == 0)\n            on_right = (i == Nx - 1)\n            on_bottom = (j == 0)\n            on_top = (j == Ny - 1)\n\n            if on_left or on_right or on_bottom or on_top:\n                # Dirichlet: set identity row\n                A[p, p] = 1.0 + 0.0j\n                # Determine boundary potential\n                if on_left:\n                    b[p] = V_left\n                if on_right:\n                    b[p] = V_right\n                if on_bottom:\n                    b[p] = V_bottom\n                if on_top:\n                    b[p] = V_top\n                continue\n\n            # Interior node: compute face coefficients via harmonic average\n            # East\n            kxe = harmonic_average(eps_x[i, j], eps_x[i + 1, j])\n            ae = kxe / (dx * dx)\n            # West\n            kxw = harmonic_average(eps_x[i, j], eps_x[i - 1, j])\n            aw = kxw / (dx * dx)\n            # North\n            kyn = harmonic_average(eps_y[i, j], eps_y[i, j + 1])\n            an = kyn / (dy * dy)\n            # South\n            kys = harmonic_average(eps_y[i, j], eps_y[i, j - 1])\n            a_s = kys / (dy * dy)\n\n            # Center coefficient\n            ap = -(ae + aw + an + a_s)\n\n            # Fill matrix\n            A[p, p] = ap\n            A[p, idx(i + 1, j)] = ae\n            A[p, idx(i - 1, j)] = aw\n            A[p, idx(i, j + 1)] = an\n            A[p, idx(i, j - 1)] = a_s\n            # RHS is zero for interior nodes\n\n    # Solve\n    A_csr = csr_matrix(A)\n    phi = spsolve(A_csr, b)  # complex solution\n\n    # Compute interface continuity metrics\n    # Tangential E along vertical interface is Ey; use centered differences in y\n    Ey_left = []\n    Ey_right = []\n    # Avoid top/bottom boundaries for centered difference\n    for j in range(1, Ny - 1):\n        pL_up = idx(iL, j + 1)\n        pL_dn = idx(iL, j - 1)\n        pR_up = idx(iR, j + 1)\n        pR_dn = idx(iR, j - 1)\n        EyL = -(phi[pL_up] - phi[pL_dn]) / (2.0 * dy)\n        EyR = -(phi[pR_up] - phi[pR_dn]) / (2.0 * dy)\n        Ey_left.append(EyL)\n        Ey_right.append(EyR)\n    Ey_left = np.array(Ey_left, dtype=np.complex128)\n    Ey_right = np.array(Ey_right, dtype=np.complex128)\n    dEt = np.abs(Ey_left - Ey_right)\n    delta_Et_max = float(np.max(dEt))  # in V/m\n\n    # Normal D across vertical interface is Dx; use one-sided differences in x\n    Dx_left = []\n    Dx_right = []\n    for j in range(1, Ny - 1):\n        pL = idx(iL, j)\n        pLm1 = idx(iL - 1, j)\n        pR = idx(iR, j)\n        pRm1 = idx(iR - 1, j)\n        ExL = -(phi[pL] - phi[pLm1]) / dx\n        ExR = -(phi[pR] - phi[pRm1]) / dx\n        # eps_x left/right at this row (constant per side)\n        epsxL = eps_x[iL, j]\n        epsxR = eps_x[iR, j]\n        DxL = epsxL * ExL\n        DxR = epsxR * ExR\n        Dx_left.append(DxL)\n        Dx_right.append(DxR)\n    Dx_left = np.array(Dx_left, dtype=np.complex128)\n    Dx_right = np.array(Dx_right, dtype=np.complex128)\n    dDn = np.abs(Dx_left - Dx_right)\n    delta_Dn_max = float(np.max(dDn))  # in C/m^2\n\n    return delta_Et_max, delta_Dn_max\n\ndef solve():\n    # Define constants and test cases from the problem statement.\n    eps0 = 8.854187817e-12  # F/m\n    W = 1.0e-2  # m\n    H = 1.0e-2  # m\n    Nx = 64\n    Ny = 64\n\n    V_left = 0.5 + 0.0j  # V\n    V_right = 0.0 + 0.0j  # V\n    V_bottom = 0.0 + 0.0j  # V\n    V_top = 1.0 + 0.0j  # V\n\n    test_cases = [\n        # (eps_left (eps_x, eps_y), eps_right (eps_x, eps_y))\n        ((2.0 * eps0 + 0.0j, 2.0 * eps0 + 0.0j), (5.0 * eps0 + 0.0j, 5.0 * eps0 + 0.0j)),\n        ((1.0 * eps0 + 0.0j, 10.0 * eps0 + 0.0j), (10.0 * eps0 + 0.0j, 1.0 * eps0 + 0.0j)),\n        (((2.0 + 0.5j) * eps0, (3.0 + 0.2j) * eps0), ((5.0 + 1.0j) * eps0, (1.0 + 0.1j) * eps0)),\n    ]\n\n    results = []\n    for eps_left, eps_right in test_cases:\n        delta_Et_max, delta_Dn_max = assemble_and_solve(\n            W, H, Nx, Ny,\n            eps_left=eps_left,\n            eps_right=eps_right,\n            V_left=V_left, V_right=V_right, V_bottom=V_bottom, V_top=V_top\n        )\n        results.append([delta_Et_max, delta_Dn_max])\n\n    # Final print statement in the exact required format.\n    # Ensure pure float rendering without additional text.\n    print(f\"[{','.join('[' + ','.join(str(v) for v in pair) + ']' for pair in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从静电学过渡到含时场，一个关键的领域是准静态近似。本练习将探讨磁准静态（MQS）近似的有效性，这是在低频激励下分析导体中涡流的常用方法。通过将MQS解与完整的麦克斯韦方程解进行比较 ，您将学习如何量化近似误差并判断何时可以忽略位移电流，这是多物理场耦合仿真中模型简化的核心能力。",
            "id": "3514073",
            "problem": "考虑一个占据 $x \\ge 0$ 区域的无限、均匀、各向同性的导电半空间，其电导率 $\\sigma$（单位：$\\mathrm{S/m}$）、磁导率 $\\mu$（单位：$\\mathrm{H/m}$）和介电常数 $\\varepsilon$（单位：$\\mathrm{F/m}$）均为常数。一个复振幅为 $H_0$（单位：$\\mathrm{A/m}$）的时谐切向磁场施加在该表面上：总磁场为 $H_z(x,t) = \\Re\\{ \\tilde{H}_z(x) e^{j \\omega t} \\}$，边界条件为 $\\tilde{H}_z(0) = H_0$，角频率为 $\\omega = 2 \\pi f$（其中 $f$ 的单位为 $\\mathrm{Hz}$）。假设场仅沿法向 $x$ 发生一维变化，而在切向上是均匀的，只有场分量 $\\tilde{E}_y(x)$ 和 $\\tilde{H}_z(x)$ 不为零。\n\n从国际单位制 (SI) 中的 Maxwell 方程组和本构关系出发，\n- Faraday 定律：$\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$，\n- Ampère-Maxwell 定律：$\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$，\n- Ohm 定律：$\\tilde{J} = \\sigma \\tilde{E}$，\n- 电位移：$\\tilde{D} = \\varepsilon \\tilde{E}$，\n- 磁通量：$\\tilde{B} = \\mu \\tilde{H}$，\n在给定的对称性和时谐约定 $e^{j \\omega t}$ 下，推导 $\\tilde{E}_y(x)$ 和 $\\tilde{H}_z(x)$ 的一维控制方程。\n\n然后：\n- 推导包含位移电流的涡流密度 $\\tilde{J}_y(x)$ 的完整解（完整 Maxwell 解）。\n- 通过忽略位移电流（即在 Ampère-Maxwell 定律中省略 $j \\omega \\varepsilon \\tilde{E}$ 项）推导磁准静态 (MQS) 解，并获得相应的涡流密度 $\\tilde{J}_y^{\\mathrm{MQS}}(x)$。\n- 对于下面的每个测试用例，定义一个评估区间 $x \\in [0, L]$，其中 $L$ 等于 MQS 解的特征穿透深度（通常称为 MQS 解的趋肤深度）的 5 倍。所有距离单位必须是 $\\mathrm{m}$。\n- 在此区间上，计算 MQS 和完整 Maxwell 涡流密度之间的相对 $L^2$ 误差：\n$$\n\\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}}.\n$$\n此处 $\\left| \\cdot \\right|$ 表示复数模。误差 $\\mathcal{E}$ 是无量纲的，并且必须以浮点数形式报告。\n\n您的实现必须在跨越 $[0, L]$ 且至少有 $1000$ 个点的均匀网格上使用数值积分来近似这些积分。所有输入参数必须以国际单位制（SI）单位解释：$\\sigma$ 的单位是 $\\mathrm{S/m}$，$\\mu$ 的单位是 $\\mathrm{H/m}$，$\\varepsilon$ 的单位是 $\\mathrm{F/m}$，$f$ 的单位是 $\\mathrm{Hz}$，$H_0$ 的单位是 $\\mathrm{A/m}$，$L$ 的单位是 $\\mathrm{m}$。\n\n测试套件：\n使用以下四组科学上一致的参数集；对于每个用例，将 $L$ 设置为如上所述的 MQS 穿透深度的 5 倍。\n\n- 用例 1（良导体，低频，非磁性）：\n  - $\\sigma = 5.8 \\times 10^{7} \\ \\mathrm{S/m}$，\n  - $\\mu = \\mu_0$，其中 $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$，\n  - $\\varepsilon = \\varepsilon_0$，其中 $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$，\n  - $f = 60 \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n- 用例 2（磁性材料，中等电导率，低频）：\n  - $\\sigma = 1 \\times 10^{6} \\ \\mathrm{S/m}$，\n  - $\\mu = 100 \\, \\mu_0$，\n  - $\\varepsilon = \\varepsilon_0$，\n  - $f = 100 \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n- 用例 3（不良导体，高介电常数，高频；位移电流显著）：\n  - $\\sigma = 1 \\times 10^{-6} \\ \\mathrm{S/m}$，\n  - $\\mu = \\mu_0$，\n  - $\\varepsilon = 4 \\, \\varepsilon_0$，\n  - $f = 10^{6} \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n- 用例 4（中等电导率，较高频率；过渡区域）：\n  - $\\sigma = 1 \\times 10^{3} \\ \\mathrm{S/m}$，\n  - $\\mu = \\mu_0$，\n  - $\\varepsilon = \\varepsilon_0$，\n  - $f = 10^{5} \\ \\mathrm{Hz}$，\n  - $H_0 = 1 \\ \\mathrm{A/m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含 4 个测试用例的相对 $L^2$ 误差，格式为逗号分隔的列表，并用方括号括起来，例如 $\\left[ e_1, e_2, e_3, e_4 \\right]$，其中每个 $e_i$ 都是一个浮点数。该行必须严格遵循 $\\left[ e_1,e_2,e_3,e_4 \\right]$ 的格式，值之间用逗号分隔，且没有额外的空格。",
            "solution": "该问题是适定的，有科学依据，并为获得唯一解提供了足够的信息。我们继续进行推导和计算求解。\n\n分析始于线性、各向同性、均匀介质中 Maxwell 方程组的时谐形式，使用 $e^{j \\omega t}$ 约定：\n1.  Faraday 定律：$\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$\n2.  Ampère-Maxwell 定律：$\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$\n\n本构关系为：\n3.  Ohm 定律：$\\tilde{J} = \\sigma \\tilde{E}$\n4.  电位移：$\\tilde{D} = \\varepsilon \\tilde{E}$\n5.  磁通密度：$\\tilde{B} = \\mu \\tilde{H}$\n\n将本构关系 3、4 和 5 代入 1 和 2，得到：\n$$ \\nabla \\times \\tilde{E} = - j \\omega \\mu \\tilde{H} $$\n$$ \\nabla \\times \\tilde{H} = \\sigma \\tilde{E} + j \\omega \\varepsilon \\tilde{E} = (\\sigma + j \\omega \\varepsilon) \\tilde{E} $$\n\n问题陈述，场仅在 $x$ 方向变化，并且只有特定的分量：$\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$ 和 $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$。在这些条件下，笛卡尔坐标系中的旋度算子简化为：\n$$ \\nabla \\times \\tilde{E} = - \\frac{d\\tilde{E}_y(x)}{dx} \\hat{z} $$\n$$ \\nabla \\times \\tilde{H} = \\frac{d\\tilde{H}_z(x)}{dx} \\hat{y} $$\n\n将这些简化的旋度代入 Maxwell 方程组，得到一个一维常微分方程组：\n$$ - \\frac{d\\tilde{E}_y}{dx} \\hat{z} = -j \\omega \\mu \\tilde{H}_z \\hat{z} \\implies \\frac{d\\tilde{E}_y}{dx} = j \\omega \\mu \\tilde{H}_z \\quad (I) $$\n$$ \\frac{d\\tilde{H}_z}{dx} \\hat{y} = (\\sigma + j \\omega \\varepsilon) \\tilde{E}_y \\hat{y} \\implies \\frac{d\\tilde{H}_z}{dx} = (\\sigma + j \\omega \\varepsilon) \\tilde{E}_y \\quad (II) $$\n\n为了获得 $\\tilde{H}_z$ 的控制方程，我们将方程 $(II)$ 对 $x$ 求导，并代入方程 $(I)$：\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} = (\\sigma + j \\omega \\varepsilon) \\frac{d\\tilde{E}_y}{dx} = (\\sigma + j \\omega \\varepsilon) (j \\omega \\mu \\tilde{H}_z) $$\n这就是 $\\tilde{H}_z(x)$ 的 Helmholtz 方程：\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} - \\gamma^2 \\tilde{H}_z = 0 $$\n其中 $\\gamma$ 是复传播常数，定义为 $\\gamma^2 = j \\omega \\mu (\\sigma + j \\omega \\varepsilon)$。\n\n通解为 $\\tilde{H}_z(x) = A e^{-\\gamma x} + C e^{\\gamma x}$。对于半空间 $x \\ge 0$ 中物理上合理的解，场必须在 $x \\to \\infty$ 时衰减。我们必须选择 $\\gamma$ 的根，使其满足实部 $\\Re\\{\\gamma\\} > 0$。这迫使增长指数项的系数为零，即 $C=0$。表面的边界条件是 $\\tilde{H}_z(0) = H_0$，这给出 $A=H_0$。因此，磁场的完整 Maxwell 解为：\n$$ \\tilde{H}_z(x) = H_0 e^{-\\gamma x} $$\n\n根据方程 $(II)$，我们可以求出电场 $\\tilde{E}_y(x)$:\n$$ \\tilde{E}_y(x) = \\frac{1}{\\sigma + j \\omega \\varepsilon} \\frac{d\\tilde{H}_z}{dx} = \\frac{1}{\\sigma + j \\omega \\varepsilon} (- \\gamma H_0 e^{-\\gamma x}) = - \\frac{\\gamma}{\\sigma + j \\omega \\varepsilon} H_0 e^{-\\gamma x} $$\n涡流密度为 $\\tilde{J}_y(x) = \\sigma \\tilde{E}_y(x)$。因此，涡流密度的完整解为：\n$$ \\tilde{J}_y(x) = - \\frac{\\sigma \\gamma}{\\sigma + j \\omega \\varepsilon} H_0 e^{-\\gamma x} \\quad (\\text{完整 Maxwell 解}) $$\n其中 $\\gamma = \\sqrt{j \\omega \\mu (\\sigma + j \\omega \\varepsilon)}$。\n\n接下来，我们推导磁准静态 (MQS) 解。MQS 近似忽略了位移电流，这等效于设置 $\\varepsilon = 0$，或者更正式地说，舍去 $j \\omega \\varepsilon \\tilde{E}$ 项。Ampère-Maxwell 定律变为 $\\nabla \\times \\tilde{H} = \\tilde{J} = \\sigma \\tilde{E}$。\n方程 $(II)$ 简化为 $\\frac{d\\tilde{H}_z}{dx} = \\sigma \\tilde{E}_y$。$\\tilde{H}_z$ 的 Helmholtz 方程变为：\n$$ \\frac{d^2\\tilde{H}_z^{\\mathrm{MQS}}}{dx^2} - (\\gamma^{\\mathrm{MQS}})^2 \\tilde{H}_z^{\\mathrm{MQS}} = 0 $$\n其中 MQS 传播常数为 $(\\gamma^{\\mathrm{MQS}})^2 = j \\omega \\mu \\sigma$。\n应用相同的边界条件，磁场的解为：\n$$ \\tilde{H}_z^{\\mathrm{MQS}}(x) = H_0 e^{-\\gamma^{\\mathrm{MQS}} x} $$\n根据简化后的 Ampère 定律，$\\tilde{E}_y^{\\mathrm{MQS}}(x) = \\frac{1}{\\sigma} \\frac{d\\tilde{H}_z^{\\mathrm{MQS}}}{dx} = -\\frac{\\gamma^{\\mathrm{MQS}}}{\\sigma} H_0 e^{-\\gamma^{\\mathrm{MQS}} x}$。\n相应的 MQS 涡流密度为 $\\tilde{J}_y^{\\mathrm{MQS}}(x) = \\sigma \\tilde{E}_y^{\\mathrm{MQS}}(x)$:\n$$ \\tilde{J}_y^{\\mathrm{MQS}}(x) = - \\gamma^{\\mathrm{MQS}} H_0 e^{-\\gamma^{\\mathrm{MQS}} x} \\quad (\\text{MQS 解}) $$\n其中 $\\gamma^{\\mathrm{MQS}} = \\sqrt{j \\omega \\mu \\sigma}$。\n\nMQS 传播常数可以表示为 $\\gamma^{\\mathrm{MQS}} = \\sqrt{j} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\sqrt{2}} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\delta}$，其中 $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$ 是经典趋肤深度。问题将积分区间定义为 $x \\in [0, L]$，其中 $L = 5\\delta$。\n\nMQS 解与完整 Maxwell 解之间的相对 $L^2$ 误差为：\n$$ \\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}} $$\n为计算 $\\mathcal{E}$，我们将使用数值积分。我们在区间 $[0, L]$ 上建立一个包含 $N \\ge 1000$ 个点的均匀网格。对于网格上的每个点 $x_i$，我们使用推导出的表达式计算 $\\tilde{J}_y(x_i)$ 和 $\\tilde{J}_y^{\\mathrm{MQS}}(x_i)$ 的复数值。然后，我们计算它们差值的模的平方作为分子的被积函数，以及完整解的模的平方作为分母的被积函数。积分通过数值积分法则（例如 Simpson 法则，一种在均匀网格上积分的标准方法）进行近似。最后，误差 $\\mathcal{E}$ 通过这些积分的比值计算得出。参数 $H_0$ 是所有电流密度中的一个公共乘法因子，因此在最终的误差计算中被消去。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetism problem for the given test cases.\n    It calculates the relative L2 error between the full Maxwell and MQS\n    solutions for eddy current density.\n    \"\"\"\n    \n    # Physical constants in SI units\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    EPSILON_0 = 8.854187817e-12  # Permittivity of free space (F/m)\n\n    test_cases = [\n        # Case 1: good conductor, low frequency, non-magnetic\n        # sigma (S/m), mu_r, epsilon_r, f (Hz), H0 (A/m)\n        (5.8e7, 1.0, 1.0, 60, 1.0),\n        # Case 2: magnetic material, moderate conductivity, low frequency\n        (1.0e6, 100.0, 1.0, 100, 1.0),\n        # Case 3: poor conductor, high permittivity, high frequency\n        (1.0e-6, 1.0, 4.0, 1.0e6, 1.0),\n        # Case 4: intermediate conductivity, higher frequency\n        (1.0e3, 1.0, 1.0, 1.0e5, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sigma, mu_r, epsilon_r, f, H0 = case\n        \n        # Absolute material properties\n        mu = mu_r * MU_0\n        epsilon = epsilon_r * EPSILON_0\n        omega = 2 * np.pi * f\n        \n        # --- MQS Solution ---\n        # MQS propagation constant\n        gamma_mqs = np.sqrt(1j * omega * mu * sigma)\n        \n        # Classical skin depth for MQS solution\n        # This defines the integration domain length L\n        if omega * mu * sigma > 0:\n            skin_depth_mqs = np.sqrt(2 / (omega * mu * sigma))\n        else:\n            # Handle cases with zero sigma or omega to avoid division by zero.\n            skin_depth_mqs = np.inf\n\n        L = 5 * skin_depth_mqs\n        \n        if np.isinf(L):\n           L = 1.0 # Fallback for non-conducting case.\n\n        # --- Full Maxwell Solution ---\n        # Full propagation constant\n        complex_permittivity = sigma + 1j * omega * epsilon\n        # The principal root of np.sqrt for a complex number with positive\n        # imaginary part (as is the case here) will have a positive real part.\n        gamma_full = np.sqrt(1j * omega * mu * complex_permittivity)\n        \n        # --- Numerical Integration Setup ---\n        # Create a uniform grid with N > 1000 points\n        N = 2000\n        x = np.linspace(0, L, N)\n\n        # --- Calculate Current Densities on the Grid ---\n        # The constant H0 cancels in the relative error formula.\n        \n        # Prefactor for full Maxwell current density\n        C_full = -H0 * sigma * gamma_full / complex_permittivity\n        \n        # Prefactor for MQS current density\n        C_mqs = -H0 * gamma_mqs\n        \n        # Evaluate current densities on the grid\n        J_full_vals = C_full * np.exp(-gamma_full * x)\n        J_mqs_vals = C_mqs * np.exp(-gamma_mqs * x)\n        \n        # --- Compute L2 Norms using Simpson's Rule ---\n        # The integrands are the squared magnitudes\n        integrand_num = np.abs(J_full_vals - J_mqs_vals)**2\n        integrand_den = np.abs(J_full_vals)**2\n\n        # Integrate using scipy.integrate.simpson\n        integral_num = simpson(y=integrand_num, x=x)\n        integral_den = simpson(y=integrand_den, x=x)\n        \n        # --- Calculate Relative Error ---\n        # Guard against division by zero if the true solution is identically zero\n        if integral_den == 0:\n            error = 0.0 if integral_num == 0 else np.inf\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        results.append(error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将探讨麦克斯韦方程组所描述的最引人入胜的现象之一：电磁波的辐射。本练习要求您从基本原理出发，计算由局部时谐源产生的远场辐射图样 。通过这个实践，您将掌握从电磁势推导远场区电场和磁场的方法，并理解天线阵列等实际系统中干涉和方向性的物理基础。",
            "id": "3514117",
            "problem": "考虑一个置于真空中的局域时谐电磁源，其时间依赖性由复数约定 $\\mathrm{e}^{- \\mathrm{i} \\omega t}$ 定义，其中 $\\omega$ 是角频率。电磁场遵循真空中的 Maxwell 方程组，\n$$\\nabla \\cdot \\mathbf{E} = \\frac{\\rho}{\\varepsilon_0}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}, \\quad \\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t},$$\n其中电磁势定义为 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 和 $\\mathbf{E} = - \\nabla \\Phi - \\frac{\\partial \\mathbf{A}}{\\partial t}$，并满足 Lorenz 规范条件 $\\nabla \\cdot \\mathbf{A} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\Phi}{\\partial t} = 0$。你将仅从这些基本定律和定义出发，通过计算辐射区中的矢量势 $\\mathbf{A}$ 并从中提取 $\\mathbf{E}$ 和 $\\mathbf{B}$，来计算产生的远场辐射图样。将介质视为真空，光速为 $c$，本构参数 $\\varepsilon_0$ 和 $\\mu_0$ 采用国际单位制 (SI)。\n\n使用针对局域源的辐射区近似，来获得在固定的大观测距离 $r$ 处场的角向依赖关系。设观测方向由球面角 $(\\theta,\\phi)$（以弧度为单位）参数化，单位矢量 $\\mathbf{n} = (\\sin\\theta \\cos\\phi, \\sin\\theta \\sin\\phi, \\cos\\theta)$ 从源指向观测点。目标是计算下方测试套件中指定角度处的电场强度大小 $\\lVert \\mathbf{E} \\rVert$，单位为伏特/米。\n\n将源建模为一系列点电偶极子之和，这些偶极子具有复振幅 $\\mathbf{p}_m$，位于位置 $\\mathbf{r}_m$（以米表示），且与时谐源的电荷连续性方程一致。假设真空值为 $c = 299792458\\,\\mathrm{m/s}$ 和 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$，且 $\\varepsilon_0 = 1/(\\mu_0 c^2)\\,\\mathrm{F/m}$。对于以下所有情况，使用观测距离 $r = 1000\\,\\mathrm{m}$。\n\n你的程序必须计算辐射区矢量势，并使用 Maxwell 方程组和 Lorenz 规范从势中推导出横向电场，然后计算每个所列角度处的电场强度大小 $\\lVert \\mathbf{E} \\rVert$。角度以弧度为单位。所有 $\\lVert \\mathbf{E} \\rVert$ 的输出均以 $\\mathrm{V/m}$ 表示。\n\n测试套件：\n1. 情况 $1$（一般情况）：位于原点的单个电偶极子，其偶极矩为 $\\mathbf{p} = (0,0,p_0)$，其中 $p_0 = 1 \\times 10^{-10}\\,\\mathrm{C \\cdot m}$，频率为 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$，因此 $\\omega = 2 \\pi f$。计算在角度 $(\\theta,\\phi)$ 等于 $(0,0)$、$(\\pi/4,0)$ 和 $(\\pi/2,0)$ 处的 $\\lVert \\mathbf{E} \\rVert$。\n2. 情况 $2$（低频边界）：与情况 1 相同的偶极子，但频率为 $f = 3 \\times 10^{6}\\,\\mathrm{Hz}$，即 $\\omega = 2 \\pi f$。计算在 $(0,0)$、$(\\pi/4,0)$ 和 $(\\pi/2,0)$ 处的 $\\lVert \\mathbf{E} \\rVert$。\n3. 情况 $3$（干涉与对称性）：两个电偶极子，位于 $\\mathbf{r}_1 = (d/2,0,0)$ 和 $\\mathbf{r}_2 = (-d/2,0,0)$，其中 $d = 0.5\\,\\mathrm{m}$，其偶极矩分别为 $\\mathbf{p}_1 = (0,0,p_0)$ 和 $\\mathbf{p}_2 = (0,0,-p_0)$，频率为 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$。计算在 $(\\pi/2,0)$、$(\\pi/2,\\pi/2)$、$(0,0)$ 和 $(\\pi/4,0)$ 处的 $\\lVert \\mathbf{E} \\rVert$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。该列表应按顺序包含情况 1 的所有角度的 $\\lVert \\mathbf{E} \\rVert$ 值（单位 V/m），然后是情况 2，最后是按上述顺序排列的情况 3。数值输出必须是标准浮点数。",
            "solution": "问题根据规定的标准进行验证。\n\n### 步骤 1：提取给定条件\n- **控制方程**：真空中的 Maxwell 方程组：\n  - $\\nabla \\cdot \\mathbf{E} = \\frac{\\rho}{\\varepsilon_0}$\n  - $\\nabla \\cdot \\mathbf{B} = 0$\n  - $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$\n  - $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$\n- **时间依赖性**：$\\mathrm{e}^{- \\mathrm{i} \\omega t}$，其中 $\\omega$ 是角频率。\n- **势定义**：\n  - $\\mathbf{B} = \\nabla \\times \\mathbf{A}$\n  - $\\mathbf{E} = - \\nabla \\Phi - \\frac{\\partial \\mathbf{A}}{\\partial t}$\n- **规范条件**：Lorenz 规范，$\\nabla \\cdot \\mathbf{A} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\Phi}{\\partial t} = 0$。\n- **介质**：真空。\n- **常数**：\n  - $c = 299792458\\,\\mathrm{m/s}$\n  - $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n  - $\\varepsilon_0 = 1/(\\mu_0 c^2)\\,\\mathrm{F/m}$\n- **源模型**：一系列点电偶极子之和，其复振幅为 $\\mathbf{p}_m$，位于位置 $\\mathbf{r}_m$。\n- **观测参数**：\n  - 距离：$r = 1000\\,\\mathrm{m}$（辐射区）。\n  - 方向：由球面角 $(\\theta,\\phi)$（以弧度为单位）参数化，单位矢量为 $\\mathbf{n} = (\\sin\\theta \\cos\\phi, \\sin\\theta \\sin\\phi, \\cos\\theta)$。\n- **目标**：计算电场强度大小 $\\lVert \\mathbf{E} \\rVert$，单位为 $\\mathrm{V/m}$。\n- **测试套件**：\n  - **情况 1**：单个偶极子 $\\mathbf{p} = (0,0,10^{-10})\\,\\mathrm{C \\cdot m}$ 位于 $\\mathbf{r}=(0,0,0)$。频率 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$。角度 $(\\theta,\\phi)$：$(0,0)$, $(\\pi/4,0)$, $(\\pi/2,0)$。\n  - **情况 2**：与情况 1 相同，但 $f = 3 \\times 10^{6}\\,\\mathrm{Hz}$。角度 $(\\theta,\\phi)$：$(0,0)$, $(\\pi/4,0)$, $(\\pi/2,0)$。\n  - **情况 3**：两个偶极子，频率 $f = 300 \\times 10^{6}\\,\\mathrm{Hz}$。$\\mathbf{p}_1 = (0,0,10^{-10})\\,\\mathrm{C \\cdot m}$ 位于 $\\mathbf{r}_1=(0.25,0,0)\\,\\mathrm{m}$。$\\mathbf{p}_2 = (0,0,-10^{-10})\\,\\mathrm{C \\cdot m}$ 位于 $\\mathbf{r}_2=(-0.25,0,0)\\,\\mathrm{m}$（因为 $d=0.5\\,\\mathrm{m}$）。角度 $(\\theta,\\phi)$：$(\\pi/2,0)$、$(\\pi/2,\\pi/2)$、$(0,0)$、$(\\pi/4,0)$。\n\n### 步骤 2：使用提取的给定条件进行验证\n- **科学依据**：该问题基于 Maxwell 方程组、电磁势以及已建立的局域源辐射理论。这些是经典电动力学的基石原理。所有常数和关系都是标准且正确的。该问题在科学上是合理的。\n- **适定性**：该问题指定了源和观测点，对此存在唯一的电磁场解。这是一个适定的边值问题。\n- **目标**：该问题使用精确、无歧义的科学语言陈述，没有主观因素。\n- **缺陷分析**：该问题没有列举的缺陷。它是自洽的、科学上一致的、物理上合理的，并且需要对电磁理论进行实质性应用，而不是琐碎或同义反复的。\n\n### 步骤 3：结论与行动\n问题陈述有效。将提供一个完整且合理的解。\n\n### 解答推导\n目标是计算由一组局域时谐电偶极子产生的远区电场大小 $\\lVert \\mathbf{E} \\rVert$。推导从所提供的基本方程开始。\n\n对于 $\\mathrm{e}^{-\\mathrm{i}\\omega t}$ 的时谐依赖关系，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为 $-\\mathrm{i}\\omega$。势定义和 Lorenz 规范变为：\n$\\mathbf{E} = -\\nabla\\Phi + \\mathrm{i}\\omega\\mathbf{A}$\n$\\nabla\\cdot\\mathbf{A} - \\mathrm{i}\\omega\\mu_0\\varepsilon_0\\Phi = 0$\n\n根据 Lorenz 规范，我们用矢量势 $\\mathbf{A}$ 来表示标量势 $\\Phi$。使用 $\\mu_0\\varepsilon_0 = 1/c^2$，我们有 $\\Phi = \\frac{c^2}{\\mathrm{i}\\omega}\\nabla\\cdot\\mathbf{A}$。\n\n将 $\\Phi$ 代入 $\\mathbf{E}$ 的表达式中，得到：\n$\\mathbf{E} = -\\nabla\\left(\\frac{c^2}{\\mathrm{i}\\omega}\\nabla\\cdot\\mathbf{A}\\right) + \\mathrm{i}\\omega\\mathbf{A}$\n\n由时谐电流分布 $\\mathbf{J}(\\mathbf{r}')$ 产生的矢量势 $\\mathbf{A}$ 是非齐次 Helmholtz 方程的解，由推迟势积分给出：\n$$ \\mathbf{A}(\\mathbf{r}) = \\frac{\\mu_0}{4\\pi} \\int \\frac{\\mathbf{J}(\\mathbf{r}') e^{\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}'|}}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}' $$\n其中 $k = \\omega/c$ 是波数。\n\n位于位置 $\\mathbf{r}_m$、偶极矩为 $\\mathbf{p}_m e^{-\\mathrm{i}\\omega t}$ 的点电偶极子对应于复振幅为 $\\mathbf{J}(\\mathbf{r}') = -\\mathrm{i}\\omega\\mathbf{p}_m\\delta(\\mathbf{r}'-\\mathbf{r}_m)$ 的电流密度。对于这样一组偶极子，矢量势为：\n$$ \\mathbf{A}(\\mathbf{r}) = \\sum_m \\frac{\\mu_0}{4\\pi} \\int \\frac{(-\\mathrm{i}\\omega\\mathbf{p}_m)\\delta(\\mathbf{r}'-\\mathbf{r}_m) e^{\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}_m|}}{|\\mathbf{r}-\\mathbf{r}_m|} d^3\\mathbf{r}' = \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\sum_m \\mathbf{p}_m \\frac{e^{\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}_m|}}{|\\mathbf{r}-\\mathbf{r}_m|} $$\n\n在远场（辐射区）中，观测距离 $r=|\\mathbf{r}|$ 远大于源的尺寸（$r \\gg |\\mathbf{r}_m|$）和波长（$r \\gg \\lambda=2\\pi/k$），我们应用以下近似：\n1. 振幅项：$|\\mathbf{r}-\\mathbf{r}_m| \\approx r$。\n2. 相位项：$|\\mathbf{r}-\\mathbf{r}_m| \\approx r - \\mathbf{n}\\cdot\\mathbf{r}_m$，其中 $\\mathbf{n}=\\mathbf{r}/r$ 是观测方向的单位矢量。\n\n因此，远场中的矢量势简化为：\n$$ \\mathbf{A}(\\mathbf{r}) \\approx \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\frac{e^{\\mathrm{i}kr}}{r} \\sum_m \\mathbf{p}_m e^{-\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{r}_m} $$\n让我们将矢量结构因子 $\\mathbf{F}(\\mathbf{n})$ 定义为对所有源的求和：\n$$ \\mathbf{F}(\\mathbf{n}) = \\sum_m \\mathbf{p}_m e^{-\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{r}_m} $$\n则，$\\mathbf{A}(\\mathbf{r}) \\approx \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\frac{e^{\\mathrm{i}kr}}{r} \\mathbf{F}(\\mathbf{n})$。\n\n为了求电场 $\\mathbf{E}$，我们注意到在远场中，空间导数主要由相位项 $e^{\\mathrm{i}kr}$ 的梯度决定，因此 $\\nabla \\approx \\mathrm{i}k\\mathbf{n}$。将此应用于势之间的关系：\n$\\nabla\\cdot\\mathbf{A} \\approx \\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{A}$。\n$\\Phi = \\frac{c^2}{\\mathrm{i}\\omega}(\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{A}) = \\frac{c^2 k}{\\omega}(\\mathbf{n}\\cdot\\mathbf{A}) = c(\\mathbf{n}\\cdot\\mathbf{A})$。\n则 $\\mathbf{E} = -\\nabla\\Phi + \\mathrm{i}\\omega\\mathbf{A} \\approx -\\mathrm{i}k\\mathbf{n}(c(\\mathbf{n}\\cdot\\mathbf{A})) + \\mathrm{i}\\omega\\mathbf{A} = -\\mathrm{i}\\omega\\mathbf{n}(\\mathbf{n}\\cdot\\mathbf{A}) + \\mathrm{i}\\omega\\mathbf{A}$。\n提出因子 $\\mathrm{i}\\omega$ 得：\n$$ \\mathbf{E}(\\mathbf{r}) \\approx \\mathrm{i}\\omega[\\mathbf{A} - \\mathbf{n}(\\mathbf{n}\\cdot\\mathbf{A})] = -\\mathrm{i}\\omega[\\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{A})] $$\n这明确地表明远区电场与传播方向 $\\mathbf{n}$ 横向。\n\n代入 $\\mathbf{A}$ 的远场表达式：\n$$ \\mathbf{E}(\\mathbf{r}) \\approx -\\mathrm{i}\\omega \\left[ \\mathbf{n} \\times \\left( \\mathbf{n} \\times \\left( \\frac{-\\mathrm{i}\\omega\\mu_0}{4\\pi} \\frac{e^{\\mathrm{i}kr}}{r} \\mathbf{F}(\\mathbf{n}) \\right) \\right) \\right] = \\frac{-\\omega^2\\mu_0}{4\\pi r} e^{\\mathrm{i}kr} \\left[\\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{F}(\\mathbf{n}))\\right] $$\n\n我们要求解的是复矢量电场的大小 $\\lVert \\mathbf{E} \\rVert$。项 $e^{\\mathrm{i}kr}$ 的大小为 $1$。\n$$ \\lVert \\mathbf{E} \\rVert = \\frac{\\omega^2\\mu_0}{4\\pi r} \\lVert \\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{F}(\\mathbf{n})) \\rVert $$\n由于 $\\mathbf{n}$ 是单位矢量且 $\\mathbf{n}\\times\\mathbf{F}$ 与其垂直，矢量三重积的大小简化为：$\\lVert \\mathbf{n}\\times(\\mathbf{n}\\times\\mathbf{F}) \\rVert = \\lVert \\mathbf{n}\\times\\mathbf{F} \\rVert$。\n需要实现的最终表达式是：\n$$ \\lVert \\mathbf{E}(\\mathbf{r}) \\rVert = \\frac{\\omega^2\\mu_0}{4\\pi r} \\left\\lVert \\mathbf{n} \\times \\left( \\sum_m \\mathbf{p}_m e^{-\\mathrm{i}k\\mathbf{n}\\cdot\\mathbf{r}_m} \\right) \\right\\rVert $$\n该公式将应用于每个测试用例。对于给定的频率 $f$ 和偶极子集合 $\\{\\mathbf{p}_m, \\mathbf{r}_m\\}$，我们对每个指定的观测方向 $\\mathbf{n}(\\theta, \\phi)$ 计算此表达式。叉积的复数结果的大小计算为 $\\sqrt{\\mathbf{v} \\cdot \\mathbf{v}^*}$，其中 $\\mathbf{v}^*$ 是 $\\mathbf{v}$ 的复共轭。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetic radiation problem for the given test cases.\n    \"\"\"\n    # Define physical constants\n    C_LIGHT = 299792458.0  # Speed of light in m/s\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space in H/m\n    R_OBS = 1000.0  # Observation distance in m\n\n    def compute_e_field_magnitude(sources, freq, theta, phi):\n        \"\"\"\n        Computes the magnitude of the far-zone electric field.\n\n        Args:\n            sources (list): A list of tuples, where each tuple contains\n                            a dipole moment vector (numpy array) and a\n                            position vector (numpy array).\n            freq (float): The frequency of the source in Hz.\n            theta (float): The polar angle of observation in radians.\n            phi (float): The azimuthal angle of observation in radians.\n\n        Returns:\n            float: The magnitude of the electric field in V/m.\n        \"\"\"\n        # Calculate derived physical parameters\n        omega = 2 * np.pi * freq\n        k = omega / C_LIGHT\n\n        # Observation direction unit vector\n        n_hat = np.array([\n            np.sin(theta) * np.cos(phi),\n            np.sin(theta) * np.sin(phi),\n            np.cos(theta)\n        ])\n\n        # Calculate the vector structure factor F(n)\n        # F(n) = sum over m [p_m * exp(-i*k*n.r_m)]\n        F_vec = np.zeros(3, dtype=complex)\n        for p_m, r_m in sources:\n            phase_factor = np.exp(-1j * k * np.dot(n_hat, r_m))\n            F_vec += p_m * phase_factor\n\n        # The term inside the norm is n x F(n)\n        cross_product_vec = np.cross(n_hat, F_vec)\n        \n        # Calculate the magnitude of the complex vector\n        # ||v|| = sqrt(v . v*) = sqrt(sum |v_i|^2)\n        norm_cross_product = np.linalg.norm(cross_product_vec)\n\n        # Prefactor K = omega^2 * mu_0 / (4*pi*r)\n        prefactor = (omega**2 * MU_0) / (4 * np.pi * R_OBS)\n\n        # Final E-field magnitude\n        e_mag = prefactor * norm_cross_product\n        return e_mag\n\n    # Define the test cases from the problem statement\n    p0 = 1e-10  # C.m\n\n    # Case 1: Single dipole at origin, f = 300 MHz\n    case1_sources = [(np.array([0.0, 0.0, p0]), np.array([0.0, 0.0, 0.0]))]\n    case1_freq = 300e6\n    case1_angles = [\n        (0.0, 0.0),\n        (np.pi / 4, 0.0),\n        (np.pi / 2, 0.0),\n    ]\n\n    # Case 2: Single dipole at origin, f = 3 MHz\n    case2_sources = case1_sources\n    case2_freq = 3e6\n    case2_angles = case1_angles\n\n    # Case 3: Two-dipole array, f = 300 MHz\n    d = 0.5 # m\n    case3_sources = [\n        (np.array([0.0, 0.0, p0]), np.array([d / 2, 0.0, 0.0])),\n        (np.array([0.0, 0.0, -p0]), np.array([-d / 2, 0.0, 0.0])),\n    ]\n    case3_freq = 300e6\n    case3_angles = [\n        (np.pi / 2, 0.0),\n        (np.pi / 2, np.pi / 2),\n        (0.0, 0.0),\n        (np.pi / 4, 0.0),\n    ]\n    \n    test_suite = [\n        (case1_sources, case1_freq, case1_angles),\n        (case2_sources, case2_freq, case2_angles),\n        (case3_sources, case3_freq, case3_angles),\n    ]\n    \n    results = []\n    \n    for sources, freq, angles in test_suite:\n        for theta, phi in angles:\n            result = compute_e_field_magnitude(sources, freq, theta, phi)\n            results.append(result)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}