{
    "hands_on_practices": [
        {
            "introduction": "While introductory texts often treat thermal conductivity $k$ as a simple scalar, many real-world materials such as wood, composites, and crystalline solids exhibit direction-dependent heat flow. This practice challenges you to move beyond the isotropic assumption by representing thermal conductivity as a second-order tensor. Starting from the fundamental laws of thermodynamics, you will derive the component form of Fourier's law for an anisotropic material and explore how the conductivity tensor transforms between different coordinate systems, a foundational skill in continuum mechanics .",
            "id": "3508533",
            "problem": "Consider a crystalline solid that exhibits orthotropic symmetry in thermal conduction, meaning there exist three mutually orthogonal crystal directions along which heat conduction is decoupled. Let the crystal frame be defined by the orthonormal basis $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$, in which the thermal conductivity tensor is diagonal with principal conductivities $k_{1}$, $k_{2}$, and $k_{3}$. Let the laboratory frame be defined by the orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$, related to the crystal frame by a proper orthogonal rotation matrix $\\mathbf{R}$, with components $R_{ij} = \\mathbf{e}_{i} \\cdot \\mathbf{E}_{j}$, satisfying $\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ and $\\det(\\mathbf{R}) = 1$. Assume steady-state heat conduction in the absence of advection and radiation, with a volumetric heat source $\\dot{q}(\\mathbf{x})$.\n\nStarting from the First Law of Thermodynamics (energy conservation) in local differential form and the requirement from the Second Law of Thermodynamics (Clausius–Duhem inequality) that the linear conductive mapping is dissipative, derive the component form of Fourier’s law in the laboratory frame and determine how the principal conductivities transform under the rotation $\\mathbf{R}$. Your derivation should explicitly use the tensorial nature of the conductivity and the transformation properties of vectors and second-order tensors under rotations.\n\nExpress your final answer as a single row matrix containing:\n- the component form of Fourier’s law in the laboratory frame, and\n- the component expression for the transformed conductivity tensor components in terms of $R_{ij}$ and the principal conductivities $k_{1}$, $k_{2}$, and $k_{3}$.\n\nNo numerical evaluation is required. Provide your final expressions symbolically. If you introduce any auxiliary definitions or operators (such as the gradient), define them clearly. Round-off instructions are not applicable because no numerical computation is requested.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- A crystalline solid with orthotropic symmetry in thermal conduction.\n- Crystal frame basis: $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$, orthonormal.\n- Thermal conductivity tensor in the crystal frame is diagonal, with principal conductivities $k_{1}$, $k_{2}$, and $k_{3}$.\n- Laboratory frame basis: $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$, orthonormal.\n- Rotation matrix $\\mathbf{R}$ relates the frames, with components $R_{ij} = \\mathbf{e}_{i} \\cdot \\mathbf{E}_{j}$.\n- Properties of $\\mathbf{R}$: proper orthogonal, i.e., $\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ and $\\det(\\mathbf{R}) = 1$.\n- Physical conditions: steady-state heat conduction, no advection, no radiation.\n- A volumetric heat source $\\dot{q}(\\mathbf{x})$ is present.\n- Starting principles: First Law of Thermodynamics (energy conservation) and Second Law of Thermodynamics (Clausius–Duhem inequality, expressed as dissipation).\n- Task: Derive the component form of Fourier’s law in the laboratory frame.\n- Task: Derive the component expression for the transformed conductivity tensor components in terms of $R_{ij}$ and principal conductivities $k_{1}, k_{2}, k_{3}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on fundamental principles of continuum mechanics, thermodynamics, and tensor analysis as applied to heat transfer in anisotropic materials. These concepts are standard in physics and engineering.\n- **Well-Posed**: The problem is clearly specified. It asks for the derivation of standard results in the field, with all necessary information provided. A unique analytical solution exists.\n- **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n- **Flaw Checklist**: The problem does not violate any of the specified flaw criteria. It is scientifically sound, formalizable, complete, realistic, well-posed, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Derivation\nThe derivation begins with the fundamental laws of thermodynamics. Throughout this derivation, the Einstein summation convention is assumed for repeated indices, unless a summation symbol is explicitly written. We denote vectors and tensors with boldface type.\n\nThe First Law of Thermodynamics, representing the conservation of energy, for a control volume at steady state and in the absence of mechanical work or advection, states that the net rate of heat entering the volume must be balanced by the rate of heat generated within it. In local differential form, this is expressed as:\n$$ \\nabla \\cdot \\mathbf{q} = \\dot{q}(\\mathbf{x}) $$\nwhere $\\mathbf{q}$ is the heat flux vector, $\\dot{q}$ is the volumetric heat source, and $\\nabla \\cdot$ is the divergence operator.\n\nThe Second Law of Thermodynamics, in the form of the Clausius–Duhem inequality, requires that the rate of local entropy production must be non-negative. For a process of pure heat conduction, this inequality reduces to:\n$$ -\\frac{1}{T^2} (\\mathbf{q} \\cdot \\nabla T) \\ge 0 $$\nwhere $T$ is the absolute temperature. As the temperature must be positive, $T>0$, this simplifies to the dissipation inequality:\n$$ -\\mathbf{q} \\cdot \\nabla T \\ge 0 $$\nThis fundamental constraint dictates that heat cannot flow from a colder region to a hotter region. To satisfy this for any possible temperature gradient, a linear constitutive model relating the heat flux $\\mathbf{q}$ and the temperature gradient $\\nabla T$ must be of the form:\n$$ \\mathbf{q} = -\\mathbf{K} \\nabla T $$\nwhere $\\mathbf{K}$ is the second-order thermal conductivity tensor. The dissipation inequality requires that the tensor $\\mathbf{K}$ be positive-definite.\n\nWe now express this relationship in the laboratory frame, which has the orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$. The components of a vector $\\mathbf{v}$ are $v_i = \\mathbf{v} \\cdot \\mathbf{e}_i$, and the components of a second-order tensor $\\mathbf{T}$ are $T_{ij} = \\mathbf{e}_i \\cdot (\\mathbf{T} \\mathbf{e}_j)$.\nThe components of the heat flux vector $\\mathbf{q}$ are $q_i$.\nThe components of the temperature gradient vector $\\nabla T$ are $(\\nabla T)_j = \\frac{\\partial T}{\\partial x_j}$, where $x_j$ are the coordinates in the laboratory frame.\nThe components of the thermal conductivity tensor $\\mathbf{K}$ in this frame are $K_{ij}$.\n\nWriting the vector equation $\\mathbf{q} = -\\mathbf{K} \\nabla T$ in component form, we get:\n$$ q_i = -K_{ij} \\frac{\\partial T}{\\partial x_j} $$\nThis is the component form of Fourier's law in the laboratory frame, which is the first required expression. The summation over the index $j$ from $1$ to $3$ is implied.\n\nNext, we must find the expression for the components $K_{ij}$ in terms of the principal conductivities $k_1, k_2, k_3$ and the rotation matrix $\\mathbf{R}$.\nThe problem states that in the crystal frame, with orthonormal basis $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$, the conductivity tensor is diagonal. This means that the basis vectors of the crystal frame are the eigenvectors of the tensor $\\mathbf{K}$. We can write the tensor $\\mathbf{K}$ in its spectral decomposition form:\n$$ \\mathbf{K} = k_1 \\mathbf{E}_1 \\otimes \\mathbf{E}_1 + k_2 \\mathbf{E}_2 \\otimes \\mathbf{E}_2 + k_3 \\mathbf{E}_3 \\otimes \\mathbf{E}_3 $$\nThe components of $\\mathbf{K}$ in the crystal frame, denoted $K'_{mn} = \\mathbf{E}_m \\cdot (\\mathbf{K} \\mathbf{E}_n)$, are therefore given by a diagonal matrix:\n$$ K'_{mn} = \\begin{pmatrix} k_1 & 0 & 0 \\\\ 0 & k_2 & 0 \\\\ 0 & 0 & k_3 \\end{pmatrix} $$\nThis can be written compactly using the Kronecker delta as $K'_{mn} = k_m \\delta_{mn}$, where no summation over $m$ is implied.\n\nThe components of a second-order tensor transform from one orthonormal basis to another according to the following transformation law:\n$$ K_{ij} = R_{im} R_{jn} K'_{mn} $$\nHere, $R_{im} = \\mathbf{e}_i \\cdot \\mathbf{E}_m$ are the components of the rotation matrix $\\mathbf{R}$ that maps components from the crystal frame to the laboratory frame. The indices $m$ and $n$ are summed from $1$ to $3$.\n\nWe substitute the component form of the tensor in the crystal frame, $K'_{mn} = k_m \\delta_{mn}$, into the transformation law:\n$$ K_{ij} = \\sum_{m=1}^{3} \\sum_{n=1}^{3} R_{im} R_{jn} (k_m \\delta_{mn}) $$\nThe Kronecker delta $\\delta_{mn}$ is only non-zero when $m=n$, which collapses one of the summations (over $n$):\n$$ K_{ij} = \\sum_{m=1}^{3} R_{im} R_{jm} k_m $$\nThis equation can be expanded to show the contribution of each principal conductivity:\n$$ K_{ij} = k_1 R_{i1} R_{j1} + k_2 R_{i2} R_{j2} + k_3 R_{i3} R_{j3} $$\nThis is the component expression for the transformed conductivity tensor in the laboratory frame, which is the second required expression. The resulting tensor $\\mathbf{K}$ with components $K_{ij}$ is symmetric ($K_{ij} = K_{ji}$) because the product $R_{im}R_{jm}$ is symmetric in $i$ and $j$. Since the principal conductivities $k_m$ are positive, and $\\mathbf{R}$ is a rotation, the tensor $\\mathbf{K}$ remains positive-definite, as required by the Second Law.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nq_i = -K_{ij} \\frac{\\partial T}{\\partial x_j} & K_{ij} = \\sum_{m=1}^{3} k_{m} R_{im} R_{jm}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Multiphysics problems frequently involve geometries with disparate length scales, such as thin coatings or interphase layers, which are computationally prohibitive to resolve directly. This practice introduces a powerful modeling technique to address this challenge: asymptotic analysis. By analyzing the heat equation in the limit of a very thin layer, you will derive an effective thermal resistance that captures the layer's impact as a simple jump condition, a key skill for simplifying complex models without sacrificing physical accuracy .",
            "id": "3508541",
            "problem": "Consider two homogeneous, isotropic solids occupying the regions $x<0$ and $x>\\delta$, with constant thermal conductivities $k_{1}$ and $k_{2}$, respectively. They are separated by a thin interphase layer occupying $0<x<\\delta$ of uniform thermal conductivity $k_{\\ell}$ and uniform volumetric heat generation rate $\\dot{q}_{\\ell}$ (positive for heat production). Assume steady heat conduction with no convection and no radiation, and let $\\boldsymbol{n}$ denote the unit normal pointing from the $x<0$ solid to the $x>\\delta$ solid. The temperature fields in the adjoining solids vary over a macroscopic length scale $L$ that is large compared to $\\delta$, i.e., $\\delta/L \\ll 1$, and all material properties are independent of temperature. The governing equations are local energy conservation and Fourier’s law: in each region,\n$$\n\\nabla \\cdot \\boldsymbol{q} + \\dot{q} = 0, \\quad \\boldsymbol{q} = -k \\nabla T,\n$$\nwith $\\dot{q} = \\dot{q}_{\\ell}$ in the interphase and $\\dot{q} = 0$ in the adjoining solids. In the interphase, denote the normal coordinate by $n$ measured along $\\boldsymbol{n}$ and the tangential coordinates by $\\boldsymbol{t}$ along the interface.\n\nStarting from these principles, derive an asymptotic reduction of the thin interphase to an effective transmission boundary condition at $x=0$ that relates the leading-order temperature jump across the interphase to the normal heat flux through it and the internal heat generation. Your derivation must:\n- Introduce an appropriate stretched normal coordinate and perform a leading-order balance in the limit $\\delta/L \\to 0$ to justify a one-dimensional description through the interphase.\n- Integrate the resulting leading-order equations through the interphase thickness to obtain a closed-form expression for the temperature jump across the interphase in terms of the normal heat flux and $\\dot{q}_{\\ell}$.\n- Identify the conditions under which the asymptotic reduction is valid, including requirements on $\\delta/L$, curvature of the interface, and the relative magnitude of the internal generation compared to the transmitted heat flux.\n\nReport the effective thermal resistance $R_{\\mathrm{eff}}$ of the interphase, defined so that the leading-order temperature drop from the $x<0$ side to the $x>\\delta$ side due solely to conduction in the interphase (with $\\dot{q}_{\\ell}=0$) equals $R_{\\mathrm{eff}}$ times the normal heat flux transmitted through the interphase. Express the final resistance in Kelvin meter squared per Watt. The final answer must be a single closed-form analytical expression.",
            "solution": "The problem requires the derivation of an effective transmission boundary condition for a thin interphase layer separating two solids, based on an asymptotic analysis in the limit of a thin layer. We must also determine the effective thermal resistance of this layer.\n\n**Problem Validation**\n\nThe problem statement is scientifically grounded in the principles of steady-state heat conduction (Fourier's law and energy conservation). The posed task, deriving effective boundary conditions via an asymptotic reduction, is a standard and well-posed technique in transport phenomena and applied mathematics. The problem's language is objective and all parameters are clearly defined. The assumptions, such as constant material properties and $\\delta/L \\ll 1$, are appropriate for the formulation. The problem is valid.\n\n**Derivation**\n\nLet $T_1(x)$, $T_\\ell(x)$, and $T_2(x)$ be the temperature fields in the solid at $x<0$, the interphase layer at $0<x<\\delta$, and the solid at $x>\\delta$, respectively. The problem statement implies a one-dimensional geometry for the heat flow analysis, although it mentions tangential coordinates and curvature, which we will address in the discussion of validity conditions.\n\n**Step 1: Asymptotic Analysis and 1D Justification**\n\nIn the interphase layer ($0<x<\\delta$), the governing equation is the steady-state heat equation with a source term:\n$$\nk_{\\ell} \\nabla^2 T_{\\ell} + \\dot{q}_{\\ell} = 0\n$$\nLet's analyze the Laplacian operator, $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\nabla_t^2$, where $x$ is the normal coordinate and $\\nabla_t^2$ is the tangential part of the Laplacian. The temperature field varies over a macroscopic length scale $L$ in the tangential directions, so the tangential derivatives are of the order $\\nabla_t^2 T_\\ell \\sim \\frac{\\Delta T}{L^2}$, where $\\Delta T$ is a characteristic temperature difference. In the normal direction, the temperature varies over the much smaller length scale $\\delta$, so $\\frac{\\partial^2 T_\\ell}{\\partial x^2} \\sim \\frac{\\Delta T}{\\delta^2}$.\n\nThe ratio of the tangential conduction term to the normal conduction term is:\n$$\n\\frac{k_{\\ell} \\nabla_t^2 T_\\ell}{k_{\\ell} \\frac{\\partial^2 T_\\ell}{\\partial x^2}} \\sim \\frac{\\Delta T/L^2}{\\Delta T/\\delta^2} = \\left(\\frac{\\delta}{L}\\right)^2\n$$\nGiven the condition $\\delta/L \\ll 1$, this ratio is very small. Therefore, to leading order, we can neglect the heat conduction in the tangential directions within the thin layer. This reduces the governing equation to a one-dimensional ordinary differential equation:\n$$\nk_{\\ell} \\frac{d^2 T_{\\ell}}{dx^2} + \\dot{q}_{\\ell} = 0, \\quad \\text{for } x \\in (0, \\delta)\n$$\nThis simplification is valid under the assumption that the interface is locally planar, meaning its radius of curvature $R_c$ is much larger than the layer thickness $\\delta$ (i.e., $\\delta/R_c \\ll 1$).\n\n**Step 2: Integration Through the Interphase Layer**\n\nWe now solve the one-dimensional heat equation for $T_\\ell(x)$. Integrating once with respect to $x$ gives:\n$$\nk_{\\ell} \\frac{d T_{\\ell}}{dx} + \\dot{q}_{\\ell} x = C_1\n$$\nThe normal heat flux is $q_x(x) = -k_{\\ell} \\frac{dT_{\\ell}}{dx}$. So, $-q_x(x) + \\dot{q}_{\\ell} x = C_1$.\nLet $q_n \\equiv q_x(0)$ be the normal heat flux entering the layer at $x=0$. Evaluating at $x=0$, we find $C_1 = -q_n$. The heat flux within the layer is thus:\n$$\nq_x(x) = q_n + \\dot{q}_{\\ell} x\n$$\nIntegrating the equation for the temperature gradient gives the temperature profile:\n$$\nk_{\\ell} T_{\\ell}(x) + \\frac{\\dot{q}_{\\ell} x^2}{2} = -q_n x + C_2\n$$\nLet $T_\\ell(0)$ be the temperature at $x=0$. We find $C_2 = k_\\ell T_\\ell(0)$. The temperature profile in the layer is:\n$$\nT_{\\ell}(x) = T_{\\ell}(0) - \\frac{q_n}{k_{\\ell}} x - \\frac{\\dot{q}_{\\ell}}{2k_{\\ell}} x^2\n$$\nTo find the temperature jump across the layer, we evaluate $T_\\ell(x)$ at $x=\\delta$:\n$$\nT_{\\ell}(\\delta) = T_{\\ell}(0) - \\frac{q_n \\delta}{k_{\\ell}} - \\frac{\\dot{q}_{\\ell} \\delta^2}{2k_{\\ell}}\n$$\nRearranging gives the temperature difference across the physical layer:\n$$\nT_{\\ell}(0) - T_{\\ell}(\\delta) = \\frac{q_n \\delta}{k_{\\ell}} + \\frac{\\dot{q}_{\\ell} \\delta^2}{2k_{\\ell}}\n$$\n\n**Step 3: Effective Transmission Boundary Conditions at $x=0$**\n\nWe now seek effective boundary conditions that relate the \"outer\" solutions $T_1(x)$ (for $x<0$) and $T_2(x)$ (for $x>0$) at the effective interface plane $x=0$.\n\n*   **Heat Flux Jump Condition:**\n    The heat flux must be continuous at the physical boundaries $x=0$ and $x=\\delta$.\n    At $x=0$: $q_1(0^-) = -k_1 \\frac{dT_1}{dx}|_{x=0^-} = q_x(0) = q_n$.\n    At $x=\\delta$: $q_2(\\delta^+) = -k_2 \\frac{dT_2}{dx}|_{x=\\delta^+} = q_x(\\delta) = q_n + \\dot{q}_\\ell\\delta$.\n    For the effective interface at $x=0$, the outgoing flux $q_2(0^+)$ must approximate the physical outgoing flux $q_2(\\delta^+)$. Since $T_2$ is an outer solution varying over scale $L \\gg \\delta$, its derivative is approximately constant over the thickness $\\delta$, so $\\frac{dT_2}{dx}|_{x=0^+} \\approx \\frac{dT_2}{dx}|_{x=\\delta^+}$. This implies $q_2(0^+) \\approx q_2(\\delta^+)$.\n    The jump in heat flux across the effective interface at $x=0$ is therefore:\n    $$\n    q_2(0^+) - q_1(0^-) \\approx q_2(\\delta^+) - q_1(0^-) = (q_n + \\dot{q}_\\ell\\delta) - q_n = \\dot{q}_\\ell\\delta\n    $$\n    This is the first effective boundary condition, representing a surface heat source of strength $\\dot{q}_\\ell\\delta$.\n\n*   **Temperature Jump Condition:**\n    Temperature is continuous at the physical boundaries: $T_1(0^-) = T_\\ell(0)$ and $T_2(\\delta^+) = T_\\ell(\\delta)$.\n    The effective temperature jump is $[[T]] = T_1(0^-) - T_2(0^+)$.\n    To leading order, the outer solution $T_2(x)$ varies negligibly across the small distance $\\delta$. So, we make the approximation $T_2(0^+) \\approx T_2(\\delta^+) = T_\\ell(\\delta)$.\n    With this approximation, the jump for the effective interface becomes the physical temperature drop across the layer:\n    $$\n    T_1(0^-) - T_2(0^+) \\approx T_\\ell(0) - T_\\ell(\\delta) = \\frac{q_n \\delta}{k_{\\ell}} + \\frac{\\dot{q}_{\\ell} \\delta^2}{2k_{\\ell}}\n    $$\n    Using $q_n = q_1(0^-)$, we get the second effective boundary condition relating the temperature jump to the incoming flux and the source term. This is the desired leading-order transmission condition.\n\n**Step 4: Conditions for Validity**\n\nThe asymptotic reduction is valid under the following conditions:\n1.  **Thin Layer:** $\\delta/L \\ll 1$, where $L$ is the macroscopic length scale of temperature variation parallel to the interface.\n2.  **Small Curvature:** $\\delta/R_c \\ll 1$, where $R_c$ is the principal radius of curvature of the interface. This ensures the local one-dimensional approximation holds.\n3.  **Magnitude of Generation:** The derivation holds for any magnitude of $\\dot{q}_\\ell$. However, the physical assumption that material properties are constant requires that the temperature change across the layer, $\\Delta T_\\ell = |T_\\ell(0)-T_\\ell(\\delta)|$, is not large enough to cause significant changes in $k_1, k_2, k_\\ell$. This imposes an implicit limit on the magnitude of both the transmitted flux $q_n$ and the internal generation term $\\dot{q}_\\ell\\delta$.\n\n**Step 5: Effective Thermal Resistance**\n\nThe problem defines the effective thermal resistance $R_{\\mathrm{eff}}$ such that the temperature drop across the interphase for the case of pure conduction ($\\dot{q}_\\ell=0$) is $R_{\\mathrm{eff}}$ times the transmitted normal heat flux. The temperature drop is specified \"from the $x<0$ side to the $x>\\delta$ side,\" which corresponds to $T_1(0^-) - T_2(\\delta^+)$.\n\nUsing the interface continuity conditions $T_1(0^-)=T_\\ell(0)$ and $T_2(\\delta^+)=T_\\ell(\\delta)$, this drop is precisely the physical temperature difference across the layer, $T_\\ell(0) - T_\\ell(\\delta)$.\nFrom the general result derived in Step 2, setting $\\dot{q}_{\\ell}=0$:\n$$\nT_\\ell(0) - T_\\ell(\\delta) = \\frac{q_n \\delta}{k_{\\ell}}\n$$\nAccording to the definition provided:\n$$\nT_1(0^-) - T_2(\\delta^+) = R_{\\mathrm{eff}} q_n\n$$\nComparing the two equations, we identify the effective thermal resistance as:\n$$\nR_{\\mathrm{eff}} = \\frac{\\delta}{k_{\\ell}}\n$$\nThe units of $R_{\\mathrm{eff}}$ are meters divided by Watts per meter-Kelvin, which simplifies to Kelvin meter-squared per Watt (K$\\cdot$m$^2$/W), as required. This represents a thermal resistance per unit area.",
            "answer": "$$\\boxed{\\frac{\\delta}{k_{\\ell}}}$$"
        },
        {
            "introduction": "Solving coupled multiphysics problems often involves operator splitting, where different physical fields are updated sequentially in time. While computationally efficient, this partitioning introduces a numerical error that can impact the simulation's accuracy. This practice delves into the analysis of such schemes for a coupled induction heating problem, using modified equation analysis to quantify the leading-order splitting error. By identifying the conditions under which this error vanishes, you will gain deep insight into the stability and accuracy of partitioned solvers, a crucial topic in computational multiphysics .",
            "id": "3508515",
            "problem": "Consider a reduced-order, spatially lumped model of induction heating that couples an electromagnetic relaxation with a thermal energy balance. Let $T(t)$ denote the spatially uniform temperature and let $E(t)$ denote a representative magnitude of the electric field driving Joule heating. The electrical conductivity is temperature-dependent via the empirically grounded form $\\sigma(T) = \\sigma_0 \\exp(-\\beta\\,(T - T_a))$, where $\\sigma_0 > 0$ is the conductivity at ambient temperature $T_a$ and $\\beta \\ge 0$ parameterizes the sensitivity to temperature.\n\nStarting from the First Law of Thermodynamics (energy conservation for a control volume) and the Joule heating constitutive relation (Ohmic heating), the lumped thermal balance reads\n$$\nC\\,\\frac{dT}{dt} = \\sigma(T)\\,E^2 - h\\,(T - T_a),\n$$\nwhere $C > 0$ is the volumetric heat capacity and $h \\ge 0$ is a linearized heat transfer coefficient to the ambient $T_a$. Under the quasi-static eddy-current approximation with an impressed current density $J_0$, a reduced electromagnetic relaxation is modeled as\n$$\n\\frac{dE}{dt} = -\\frac{1}{\\tau_e}\\Big(E - \\bar{E}(\\sigma(T))\\Big),\n\\qquad\n\\bar{E}(\\sigma) = \\frac{J_0}{\\sigma},\n$$\nwhere $\\tau_e > 0$ is an effective electromagnetic relaxation time scale. The coupled system can be written as $y' = F(y)$ for $y = (E,T)$ with\n$$\nF(y) = F_{\\text{em}}(y) + F_{\\text{th}}(y),\n\\quad\nF_{\\text{em}}(E,T) = \\big(-\\tfrac{1}{\\tau_e}\\,(E - \\bar{E}(\\sigma(T))),\\,0\\big),\n\\quad\nF_{\\text{th}}(E,T) = \\big(0,\\,\\tfrac{1}{C}\\big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\big)\\big).\n$$\n\nDefine a sequential (Lie) partitioned time integrator over a single time step $\\Delta t > 0$ by first evolving $F_{\\text{em}}$ with $T$ frozen for time $\\Delta t$, followed by evolving $F_{\\text{th}}$ with $E$ frozen for time $\\Delta t$. Let the exact monolithic evolution over time $\\Delta t$ be the flow of $F$. Using formal composition analysis for smooth vector fields, the sequential integrator is first-order accurate in general, and admits a modified equation whose vector field is $F + \\tfrac{\\Delta t}{2}[F_{\\text{th}},F_{\\text{em}}] + \\mathcal{O}(\\Delta t^2)$, where $[G,H]$ denotes the Lie bracket $D H \\cdot G - D G \\cdot H$. Focusing on the temperature component, the modified temperature equation under sequential coupling can be written as\n$$\n\\frac{dT}{dt} = H(T,E) + \\frac{\\Delta t}{2}\\,\\Big(\\frac{\\partial H}{\\partial E}(T,E)\\cdot G(T,E)\\Big) + \\mathcal{O}(\\Delta t^2),\n$$\nwhere $H(T,E) = \\tfrac{1}{C}\\big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\big)$ and $G(T,E) = -\\tfrac{1}{\\tau_e}\\big(E - \\tfrac{J_0}{\\sigma(T)}\\big)$. The leading-order splitting error in the temperature dynamics is therefore governed by the scalar quantity $\\tfrac{1}{2}\\,\\tfrac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$.\n\nTasks:\n1. Starting from the stated fundamental laws, derive the sequential-coupling modified equation for $T(t)$ by computing the temperature component of the Lie bracket $[F_{\\text{th}},F_{\\text{em}}]$. Show that the leading correction is proportional to $\\tfrac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$ and precisely determine $\\tfrac{\\partial H}{\\partial E}$ and $G$ in terms of the model parameters $(\\sigma_0,\\beta,T_a,C,h,J_0,\\tau_e)$ and the state $(T,E)$.\n2. Identify mathematically precise conditions on $H$ and $G$ under which the leading-order correction term vanishes identically for all $(T,E)$, implying that the sequential coupling achieves second-order local accuracy in the temperature equation (that is, the local truncation error in $T$ scales as $\\mathcal{O}(\\Delta t^2)$ rather than $\\mathcal{O}(\\Delta t)$). Express these conditions as properties of the vector fields $F_{\\text{th}}$ and $F_{\\text{em}}$ (e.g., commutation or independence).\n3. Implement a program that, for a fixed list of parameter sets (the test suite below), determines whether the sequential coupling for the temperature equation is first-order ($\\mathcal{O}(\\Delta t)$) or second-order ($\\mathcal{O}(\\Delta t^2)$) with respect to the leading modified-equation correction. Your classification must be based on the vanishing of the scalar field $\\tfrac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$ identically for all $(T,E)$ in the model, not merely at a single initial state. Concretely, treat two special modeling flags per test case:\n   • If the electromagnetic subproblem is algebraic (meaning $E$ is instantaneously set to $\\bar{E}(\\sigma(T))$ with no dynamics), then $G \\equiv 0$ and the leading correction vanishes.\n   • If the Joule heating source uses a prescribed current model independent of $E$ (meaning $H(T,E) = \\tfrac{1}{C}\\big(\\tfrac{J_0^2}{\\sigma(T)} - h\\,(T - T_a)\\big)$), then $\\tfrac{\\partial H}{\\partial E} \\equiv 0$ and the leading correction vanishes.\n   In all other cases, classify as first-order.\n\nYour program should output a single line containing the classification results for all test cases as integers in a comma-separated list enclosed in square brackets, where the integer $1$ denotes $\\mathcal{O}(\\Delta t)$ and the integer $2$ denotes $\\mathcal{O}(\\Delta t^2)$.\n\nTest suite (each case lists $(\\sigma_0,\\beta,T_a,C,h,J_0,\\tau_e,T_0,E_0)$ and the two modeling flags):\nCase A (general induction heating, sequential coupling expected $\\mathcal{O}(\\Delta t)$):\n$\\sigma_0 = 6.0\\times 10^6$, $\\beta = 4.0\\times 10^{-3}$, $T_a = 300$, $C = 3.9\\times 10^6$, $h = 500$, $J_0 = 1.0\\times 10^7$, $\\tau_e = 1.0\\times 10^{-3}$, $T_0 = 300$, $E_0 = 0.5\\,J_0/\\sigma(T_0)$, electromagnetic algebraic flag $\\text{em\\_algebraic} = \\text{False}$, prescribed-current Joule heating flag $\\text{source\\_depends\\_on\\_E} = \\text{True}$.\n\nCase B (prescribed current source independent of $E$, sequential coupling achieves $\\mathcal{O}(\\Delta t^2)$ in $T$):\nSame parameters as Case A but with $\\text{source\\_depends\\_on\\_E} = \\text{False}$.\n\nCase C (algebraic electromagnetics, $G \\equiv 0$, sequential coupling achieves $\\mathcal{O}(\\Delta t^2)$ in $T$):\nSame as Case A but with $\\text{em\\_algebraic} = \\text{True}$.\n\nCase D (initially equilibrated field $E_0 = \\bar{E}(\\sigma(T_0))$ but dynamic electromagnetics and standard Joule heating, still first-order because the vanishing at one point does not imply identically zero):\nSame as Case A but with $E_0 = J_0/\\sigma(T_0)$ and flags $\\text{em\\_algebraic} = \\text{False}$, $\\text{source\\_depends\\_on\\_E} = \\text{True}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[1,2,2,1]\"). No physical units are required in the output; the answers are integers.",
            "solution": "The fundamental base consists of two laws: energy conservation for a control volume and Ohmic Joule heating in a conducting medium, as well as a quasi-static eddy-current relaxation toward an algebraic state. Energy conservation in the lumped model yields\n$$\nC\\,\\frac{dT}{dt} = q_{\\text{Joule}}(T,E) - q_{\\text{loss}}(T),\n$$\nwith $q_{\\text{Joule}}(T,E) = \\sigma(T)\\,E^2$ and $q_{\\text{loss}}(T) = h\\,(T - T_a)$. This gives the thermal vector field\n$$\nF_{\\text{th}}(E,T) = \\big(0,\\,H(T,E)\\big), \\quad H(T,E) = \\frac{1}{C}\\Big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\Big).\n$$\nIn induction heating with impressed current density $J_0$, the quasi-static electromagnetic steady field satisfies $\\bar{E}(\\sigma) = J_0/\\sigma$ under Ohm’s law $J = \\sigma E$ for a prescribed $J$. A simple dynamical relaxation model that respects the tendency toward this steady state is\n$$\n\\frac{dE}{dt} = -\\frac{1}{\\tau_e}\\Big(E - \\bar{E}(\\sigma(T))\\Big), \\quad \\bar{E}(\\sigma(T)) = \\frac{J_0}{\\sigma(T)},\n$$\nleading to the electromagnetic vector field\n$$\nF_{\\text{em}}(E,T) = \\big(G(T,E),\\,0\\big), \\quad G(T,E) = -\\frac{1}{\\tau_e}\\Big(E - \\frac{J_0}{\\sigma(T)}\\Big).\n$$\n\nWe analyze the sequential (Lie) coupling that over a time step $\\Delta t$ applies the flow generated by $F_{\\text{em}}$ (with $T$ frozen) followed by the flow generated by $F_{\\text{th}}$ (with $E$ frozen). For smooth vector fields $F_{\\text{em}}$ and $F_{\\text{th}}$, the Baker–Campbell–Hausdorff composition formula for flows implies that the combined sequential step is the exact flow of a modified vector field\n$$\nF_{\\text{mod}} = F_{\\text{em}} + F_{\\text{th}} + \\frac{\\Delta t}{2}\\,[F_{\\text{th}},F_{\\text{em}}] + \\mathcal{O}(\\Delta t^2),\n$$\nwhere the Lie bracket of vector fields is defined by $[A,B] = D B \\cdot A - D A \\cdot B$. Writing $y = (E,T)$, $F_{\\text{th}}(y) = (0,H(T,E))$ and $F_{\\text{em}}(y) = (G(T,E),0)$, we compute the bracket’s temperature component. The Jacobian of $F_{\\text{th}}$ acting on a perturbation $(\\delta E, \\delta T)$ is\n$$\nD F_{\\text{th}}(E,T)\\cdot(\\delta E,\\delta T) = \\big(0,\\,\\frac{\\partial H}{\\partial E}(T,E)\\,\\delta E + \\frac{\\partial H}{\\partial T}(T,E)\\,\\delta T\\big),\n$$\nwhile the Jacobian of $F_{\\text{em}}$ acting on $(\\delta E,\\delta T)$ is\n$$\nD F_{\\text{em}}(E,T)\\cdot(\\delta E,\\delta T) = \\big(\\frac{\\partial G}{\\partial E}(T,E)\\,\\delta E + \\frac{\\partial G}{\\partial T}(T,E)\\,\\delta T,\\,0\\big).\n$$\nBy definition,\n$$\n[F_{\\text{th}},F_{\\text{em}}](E,T) = D F_{\\text{em}}(E,T)\\cdot F_{\\text{th}}(E,T) - D F_{\\text{th}}(E,T)\\cdot F_{\\text{em}}(E,T).\n$$\nSubstituting $F_{\\text{th}}(E,T) = (0,H(T,E))$ and $F_{\\text{em}}(E,T) = (G(T,E),0)$,\nthe temperature component of $D F_{\\text{em}}(E,T)\\cdot F_{\\text{th}}(E,T)$ is zero, and the temperature component of $D F_{\\text{th}}(E,T)\\cdot F_{\\text{em}}(E,T)$ is $\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$. Therefore,\n$$\n\\big([F_{\\text{th}},F_{\\text{em}}](E,T)\\big)_T = -\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E).\n$$\nBecause in the Lie composition we apply first $F_{\\text{em}}$ then $F_{\\text{th}}$, the modified vector field correction is $\\tfrac{\\Delta t}{2}[F_{\\text{th}},F_{\\text{em}}]$, yielding the modified temperature equation\n$$\n\\frac{dT}{dt} = H(T,E) + \\frac{\\Delta t}{2}\\,\\Big(\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)\\Big) + \\mathcal{O}(\\Delta t^2).\n$$\n\nWe now compute the needed derivatives explicitly. With $\\sigma(T) = \\sigma_0 e^{-\\beta(T - T_a)}$, we have\n$$\nH(T,E) = \\frac{1}{C}\\big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\big), \\quad\n\\frac{\\partial H}{\\partial E}(T,E) = \\frac{1}{C}\\cdot 2\\,\\sigma(T)\\,E.\n$$\nFor the electromagnetic vector field,\n$$\nG(T,E) = -\\frac{1}{\\tau_e}\\left(E - \\frac{J_0}{\\sigma(T)}\\right).\n$$\nThus, the leading-order splitting correction in the temperature modified equation is\n$$\n\\frac{\\Delta t}{2}\\,\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)\n=\n\\frac{\\Delta t}{2}\\,\\left(\\frac{2\\,\\sigma(T)\\,E}{C}\\right)\\left(-\\frac{1}{\\tau_e}\\left(E - \\frac{J_0}{\\sigma(T)}\\right)\\right)\n=\n-\\Delta t\\,\\frac{\\sigma(T)\\,E}{C\\,\\tau_e}\\left(E - \\frac{J_0}{\\sigma(T)}\\right).\n$$\n\nThe sequential coupling is therefore generically first-order in $\\Delta t$ for the temperature equation, with a leading local error term linear in $\\Delta t$ proportional to the scalar $\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$. We now identify when this linear term vanishes identically for all states $(T,E)$, which is the necessary and sufficient condition for the local error to be at least $\\mathcal{O}(\\Delta t^2)$ in $T$ under sequential coupling.\n\nFrom the expression, the linear term vanishes identically if and only if either:\n1. $\\frac{\\partial H}{\\partial E}(T,E) \\equiv 0$ for all $(T,E)$, meaning the thermal source is independent of $E$. Physically, this corresponds to modeling Joule heating with a prescribed current density that does not include the dynamical electric field as a state; for example, using $H(T,E) = \\frac{1}{C}\\big(\\frac{J_0^2}{\\sigma(T)} - h\\,(T - T_a)\\big)$ makes $\\frac{\\partial H}{\\partial E} \\equiv 0$.\n2. $G(T,E) \\equiv 0$ for all $(T,E)$, meaning the electromagnetic subproblem is algebraic with no dynamics (instantaneous enforcement of $E = \\bar{E}(\\sigma(T))$). In this case, the electromagnetic vector field vanishes identically, so the commutator contribution is zero.\n\nNote that the condition $E = \\frac{J_0}{\\sigma(T)}$ at a single time or for particular initial data does not ensure the linear term vanishes along the entire trajectory unless $G \\equiv 0$; sequential coupling freezes $E$ during the thermal substep, so changes in $T$ render $E - \\frac{J_0}{\\sigma(T)}$ nonzero unless the electromagnetic relaxation is algebraic. Therefore, merely choosing initial data with $E_0 = \\bar{E}(\\sigma(T_0))$ does not elevate the order; the criterion must hold identically as a property of the vector fields.\n\nAlgorithmic design for the program:\nWe encode the two physically motivated flags that enforce the vanishing of the linear term as properties of the model:\n(i) source independent of $E$ (sets $\\frac{\\partial H}{\\partial E} \\equiv 0$),\n(ii) electromagnetic algebraic (sets $G \\equiv 0$).\nFor each test case, we classify as second-order if either flag is active; otherwise, we classify as first-order. This directly implements the mathematical conditions $\\frac{\\partial H}{\\partial E}\\equiv 0$ or $G\\equiv 0$. The program uses the provided parameter sets to define test cases and outputs the integer classification for each case in the required single-line format.\n\nApplied to the specified test suite:\nCase A has both flags inactive, so the leading correction is nonzero and the method is first-order, output $1$.\nCase B has source independent of $E$, so the leading correction vanishes and the method is second-order in $T$, output $2$.\nCase C has algebraic electromagnetics, so the leading correction vanishes and the method is second-order in $T$, output $2$.\nCase D has equilibrated initial data but neither flag active; the leading correction does not vanish identically as $T$ evolves, so the method remains first-order, output $1$.\n\nThe program returns the list of integers $[1,2,2,1]$ as the single-line output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the test cases from the problem statement as dictionaries.\n    # Each case includes parameters and two flags:\n    # - em_algebraic: if True, electromagnetic dynamics are algebraic (G ≡ 0).\n    # - source_depends_on_E: if True, Joule heating depends on E (∂H/∂E ≠ 0);\n    #                        if False, source independent of E (∂H/∂E ≡ 0).\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,  # computed below from J0/sigma(T0), then scaled\n            \"em_algebraic\": False,\n            \"source_depends_on_E\": True,\n            \"E0_scale\": 0.5,\n        },\n        {\n            \"name\": \"Case B\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,\n            \"em_algebraic\": False,\n            \"source_depends_on_E\": False,  # source independent of E\n            \"E0_scale\": 0.5,\n        },\n        {\n            \"name\": \"Case C\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,\n            \"em_algebraic\": True,          # electromagnetic algebraic\n            \"source_depends_on_E\": True,\n            \"E0_scale\": 0.5,\n        },\n        {\n            \"name\": \"Case D\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,  # set to equilibrium exactly\n            \"em_algebraic\": False,\n            \"source_depends_on_E\": True,\n            \"E0_scale\": 1.0,               # E0 = J0/sigma(T0)\n        },\n    ]\n\n    def sigma(T, sigma0, beta, Ta):\n        return sigma0 * np.exp(-beta * (T - Ta))\n\n    # Prepare initial E0 for each case based on equilibrium scaling.\n    for case in test_cases:\n        sig_T0 = sigma(case[\"T0\"], case[\"sigma0\"], case[\"beta\"], case[\"Ta\"])\n        e_eq = case[\"J0\"] / sig_T0\n        case[\"E0\"] = case[\"E0_scale\"] * e_eq\n\n    # Classification logic based on analytical conditions:\n    # If em_algebraic is True => G ≡ 0 => second-order (2).\n    # If source_depends_on_E is False => ∂H/∂E ≡ 0 => second-order (2).\n    # Else => first-order (1).\n    results = []\n    for case in test_cases:\n        if case[\"em_algebraic\"] or (not case[\"source_depends_on_E\"]):\n            results.append(2)\n        else:\n            results.append(1)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}