{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex coupled systems, it is essential to master the fundamentals of a single initial-boundary value problem (IBVP). This first practice explores the linear advection equation, a cornerstone of hyperbolic PDEs that models transport phenomena. By using energy methods and the method of characteristics, you will develop a deep, analytical understanding of well-posedness, learning how the physics of information flow dictates the correct placement of boundary conditions and how the solution evolves from initial and boundary data .",
            "id": "3510395",
            "problem": "Consider the linear one-dimensional transport of a scalar field $u(x,t)$ governed by the partial differential equation (PDE) $u_{t}+a\\,u_{x}=0$ on the spatial interval $(0,L)$ for times $t>0$, where $a>0$ is a constant. Assume $u$ is sufficiently smooth for the manipulations below to be justified.\n\nTasks:\n- Using only conservation considerations and integral identities, determine where on the boundary the value of $u$ must be prescribed in order for the initial–boundary value problem to be well-posed when $a>0$, and justify your choice by deriving an $L^{2}(0,L)$ energy balance that displays boundary fluxes.\n- Construct the solution using the Method of Characteristics (MOC), starting from the kinematic law for characteristic curves and the fact that $u$ is constant along them. Derive a representation formula for $u(x,t)$ at any interior point $(x,t)\\in(0,L)\\times(0,\\infty)$, expressed in terms of the initial condition $u(x,0)=u_{0}(x)$ and a single boundary inflow datum $u(0,t)=g(t)$. State the compatibility condition required at the corner $(x,t)=(0,0)$ for a classical solution.\n- Specialize to the case $L=2$, $a=3$, $u_{0}(x)=\\exp(-x)\\sin(\\pi x)$, and $g(t)=\\exp(-2t)\\sin(\\pi t)$ (these are dimensionless data). Using your representation formula, determine the value of $u(1,3/5)$. Express your final answer as an exact analytic expression with no rounding.",
            "solution": "The problem is valid as it is a standard, well-posed initial-boundary value problem from the theory of hyperbolic partial differential equations. It is scientifically grounded, self-contained, and objective.\n\nThe governing partial differential equation (PDE) is the linear advection equation:\n$$u_{t}+a\\,u_{x}=0$$\nfor $x \\in (0,L)$ and $t>0$, with a constant advection speed $a>0$.\n\n**Part 1: Boundary Condition Placement via Energy Balance**\n\nTo determine on which boundary the value of the scalar field $u$ must be prescribed, we analyze the evolution of the total \"energy\" of the solution within the spatial domain $[0,L]$. We define the $L^2$-energy at time $t$ as:\n$$E(t) = \\frac{1}{2} \\int_{0}^{L} u(x,t)^2 \\, dx$$\nAssuming $u$ is sufficiently smooth, we can differentiate $E(t)$ with respect to time $t$ by taking the derivative under the integral sign (Leibniz integral rule):\n$$\\frac{dE}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2} \\int_{0}^{L} u^2 \\, dx \\right) = \\int_{0}^{L} u \\frac{\\partial u}{\\partial t} \\, dx$$\nWe substitute for $u_t$ using the governing PDE, $u_t = -a u_x$:\n$$\\frac{dE}{dt} = \\int_{0}^{L} u (-a u_x) \\, dx = -a \\int_{0}^{L} u \\, u_x \\, dx$$\nThe integrand can be expressed as the derivative of $u^2/2$:\n$$u \\, u_x = \\frac{1}{2} \\frac{\\partial}{\\partial x}(u^2)$$\nSubstituting this into the integral and applying the Fundamental Theorem of Calculus:\n$$\\frac{dE}{dt} = -a \\int_{0}^{L} \\frac{1}{2} \\frac{\\partial}{\\partial x}(u^2) \\, dx = -\\frac{a}{2} \\left[ u(x,t)^2 \\right]_{x=0}^{x=L}$$\nEvaluating at the boundaries gives the energy balance equation:\n$$\\frac{dE}{dt} = -\\frac{a}{2} \\left( u(L,t)^2 - u(0,t)^2 \\right) = \\frac{a}{2} u(0,t)^2 - \\frac{a}{2} u(L,t)^2$$\nThis equation shows that the rate of change of energy within the domain $(0,L)$ is equal to the net flux of energy across the boundaries at $x=0$ and $x=L$.\nSince the constant $a$ is positive ($a>0$), the term $\\frac{a}{2} u(0,t)^2$ is non-negative and represents an energy flux *into* the domain at the boundary $x=0$.\nThe term $-\\frac{a}{2} u(L,t)^2$ is non-positive and represents an energy flux *out of* the domain at the boundary $x=L$.\nThis corresponds to the physical picture of advection: information propagates in the positive $x$-direction. Therefore, $x=0$ is the \"inflow\" boundary, and $x=L$ is the \"outflow\" boundary.\nFor a problem to be well-posed, we must control the information entering the domain. We must therefore prescribe the value of $u$ at the inflow boundary, $x=0$. The value of $u$ at the outflow boundary, $x=L$, is determined by the evolution of the initial data and the prescribed inflow data. Prescribing a condition at $x=L$ would overdetermine the problem, generally leading to non-existence or non-uniqueness of a solution.\nThus, for $a>0$, the boundary condition must be specified at $x=0$.\n\n**Part 2: Solution by the Method of Characteristics**\n\nThe PDE $u_t + a u_x = 0$ states that the directional derivative of $u$ along the vector $(a,1)$ in the $(x,t)$-plane is zero. This means $u$ is constant along characteristic curves defined by the ordinary differential equation (ODE):\n$$\\frac{dx}{dt} = a$$\nSolving this ODE gives the equation for the characteristic lines:\n$$x - at = C$$\nwhere $C$ is a constant. Each characteristic is a straight line in the $(x,t)$-plane along which the value of $u$ is constant.\n\nTo find the solution $u(x,t)$ at a point $(x,t)$ in the domain $(0,L)\\times(0,\\infty)$, we trace the characteristic curve passing through $(x,t)$ backwards in time until it intersects the boundary of the domain. The boundary consists of the initial line $\\{ (x,0) \\mid x \\in [0,L] \\}$ and the inflow boundary line $\\{ (0,t) \\mid t>0 \\}$.\n\nLet $(\\xi, \\tau)$ be a point on the characteristic that passes through $(x,t)$. Then $\\xi - a\\tau = x - at$.\nWe need to determine where this characteristic originates.\n\nCase 1: The characteristic originates from the initial line $t=0$.\nThe intersection occurs at time $\\tau=0$. The corresponding position is $\\xi = x - at$. For this point $(\\xi, 0)$ to be on the initial data interval, we must have $0  \\xi  L$, which implies $0  x - at  L$. This is equivalent to $at  x  L+at$. Since we are evaluating at a point $x \\in (0,L)$, this condition simplifies to $at  x  L$.\nIn this region, the value of $u$ is propagated from the initial condition $u_0(x)$:\n$$u(x,t) = u(\\xi, 0) = u_0(\\xi) = u_0(x-at) \\quad \\text{for } x > at$$\n\nCase 2: The characteristic originates from the boundary line $x=0$.\nThe intersection occurs at position $\\xi=0$. The corresponding time is found by solving $0 - a\\tau = x - at$, which gives $\\tau = t - x/a$. For this point $(0, \\tau)$ to be on the prescribed boundary data section, we must have $\\tau > 0$, which implies $t - x/a > 0$, or $x  at$.\nIn this region, the value of $u$ is propagated from the boundary condition $g(t)$:\n$$u(x,t) = u(0, \\tau) = g(\\tau) = g(t - x/a) \\quad \\text{for } x  at$$\n\nThe dividing line $x=at$ is the characteristic that passes through the corner $(0,0)$. Combining these two cases, the representation formula for the solution is:\n$$u(x,t) = \\begin{cases}\nu_0(x-at)  \\text{if } x > at \\\\\ng(t-x/a)  \\text{if } x  at\n\\end{cases}$$\nFor a classical solution to exist, it must be at least continuous. Continuity across the characteristic $x=at$ requires that the limits from both regions match. As a point $(x,t)$ approaches this line, we have:\n$$\\lim_{x \\to (at)^+} u(x,t) = \\lim_{x \\to (at)^+} u_0(x-at) = u_0(0)$$\n$$\\lim_{x \\to (at)^-} u(x,t) = \\lim_{x \\to (at)^-} g(t-x/a) = g(0)$$\nTherefore, the compatibility condition required at the corner $(x,t)=(0,0)$ for a continuous solution is $u_0(0) = g(0)$.\n\n**Part 3: Specific Case Evaluation**\n\nWe are given the parameters $L=2$ and $a=3$. The initial condition is $u_0(x) = \\exp(-x)\\sin(\\pi x)$ and the boundary condition is $g(t) = \\exp(-2t)\\sin(\\pi t)$. We need to find the value of $u(1, 3/5)$.\n\nFirst, we determine which region the point $(x,t) = (1, 3/5)$ belongs to. We compare $x$ with $at$:\n$$x = 1$$\n$$at = 3 \\times \\frac{3}{5} = \\frac{9}{5} = 1.8$$\nSince $1  1.8$, we have $x  at$. Therefore, the solution at this point is determined by the boundary data function $g(t)$. The formula to use is:\n$$u(x,t) = g(t - x/a)$$\nWe calculate the argument of $g$:\n$$t - \\frac{x}{a} = \\frac{3}{5} - \\frac{1}{3} = \\frac{3 \\times 3 - 1 \\times 5}{15} = \\frac{9-5}{15} = \\frac{4}{15}$$\nNow we evaluate the function $g$ at this argument value:\n$$u(1, 3/5) = g\\left(\\frac{4}{15}\\right)$$\nGiven $g(t) = \\exp(-2t)\\sin(\\pi t)$, we substitute $t=4/15$:\n$$u(1, 3/5) = \\exp\\left(-2 \\times \\frac{4}{15}\\right) \\sin\\left(\\pi \\times \\frac{4}{15}\\right)$$\n$$u(1, 3/5) = \\exp\\left(-\\frac{8}{15}\\right) \\sin\\left(\\frac{4\\pi}{15}\\right)$$\nThis is the exact analytic expression for the value of $u(1, 3/5)$.",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{8}{15}\\right) \\sin\\left(\\frac{4\\pi}{15}\\right)}$$"
        },
        {
            "introduction": "Many real-world multiphysics problems are governed by non-linear interactions where analytical solutions are no longer feasible. This exercise transitions from analytical methods to computational investigation by exploring thermal runaway in a reactive material, a classic example of a non-linear reaction-diffusion IBVP. You will implement a numerical solver to determine how small changes in initial and boundary conditions can lead to dramatically different outcomes, providing practical experience in using computation to map the stability boundaries of a complex system .",
            "id": "3510432",
            "problem": "Consider a one-dimensional reactive slab occupying the spatial domain $x \\in [0,L]$ with thickness $L$ measured in meters, with temperature field $T(x,t)$ measured in kelvin evolving over time $t$ measured in seconds. The slab is subject to exothermic heat generation following Arrhenius kinetics and convective cooling at both faces. The goal is to determine whether the initial and boundary value problem leads to quenching (temperature remains bounded and returns toward ambient) or thermal runaway (temperature grows above a critical threshold within a finite horizon) and to map how small changes in the initial temperature profile and the convective heat transfer coefficient change the outcome.\n\nFundamental base and governing equations:\n- Let $\\rho$ be the density in kilograms per cubic meter and $c$ be the specific heat capacity in joules per kilogram per kelvin. The volumetric heat capacity is $\\rho c$ in joules per cubic meter per kelvin. Let $k$ be the thermal conductivity in watts per meter per kelvin. The energy conservation law combined with Fourier’s law for heat conduction yields the heat equation with a volumetric source $q(T)$:\n$$\\rho c \\,\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k\\,\\frac{\\partial T}{\\partial x}\\right) + q(T).$$\n- The Arrhenius heat source follows\n$$q(T) = S_0 \\,\\exp\\!\\left(-\\frac{E_a}{R\\,T}\\right),$$\nwhere $S_0$ is a pre-exponential source factor in watts per cubic meter, $E_a$ is the activation energy in joules per mole, and $R$ is the Universal Gas Constant (UGC) in joules per mole per kelvin.\n- Mixed (Robin) boundary conditions model convective cooling at both faces with outward unit normal $\\boldsymbol{n}$:\n$$-k\\,\\nabla T \\cdot \\boldsymbol{n} = h\\,(T - T_\\infty),$$\nwhere $h$ is the convective heat transfer coefficient in watts per square meter per kelvin and $T_\\infty$ is the ambient temperature in kelvin. At $x=0$ with outward normal $\\boldsymbol{n}=-\\hat{\\boldsymbol{x}}$, this implies $k\\,\\frac{\\partial T}{\\partial x}(0,t)=h\\,(T(0,t)-T_\\infty)$, and at $x=L$ with $\\boldsymbol{n}=+\\hat{\\boldsymbol{x}}$, this implies $-k\\,\\frac{\\partial T}{\\partial x}(L,t)=h\\,(T(L,t)-T_\\infty)$.\n- The initial condition is $T(x,0)=T_0(x)$, chosen from parameterized profiles specified below.\n\nClassification criteria:\n- Define a critical runaway threshold temperature $T_{\\text{runaway}}$ in kelvin. The solution outcome is classified as \"blow-up\" if $\\max_{x \\in [0,L]} T(x,t)$ reaches or exceeds $T_{\\text{runaway}}$ before a fixed final time $t_{\\text{final}}$. Otherwise, the outcome is classified as \"quench\".\n\nNumerical method requirements:\n- Discretize the spatial domain using $N$ equally spaced grid points with spacing $\\Delta x = L/(N-1)$. Use the method of lines: second-order finite differences for the diffusion term and a pointwise evaluation of the Arrhenius source term to obtain a system of ordinary differential equations (ODEs) in time.\n- For interior points $i=1,\\dots,N-2$, approximate the Laplacian using\n$$\\frac{\\partial^2 T}{\\partial x^2}(x_i,t) \\approx \\frac{T_{i+1}(t) - 2\\,T_i(t) + T_{i-1}(t)}{\\Delta x^2}.$$\n- Enforce the Robin boundary conditions via ghost-point elimination to maintain second-order accuracy. At $x=0$,\n$$\\frac{\\partial T}{\\partial x}(0,t) = \\frac{T_1(t) - T_{-1}(t)}{2\\,\\Delta x} = \\frac{h}{k}\\,\\big(T_0(t) - T_\\infty\\big) \\quad \\Rightarrow \\quad T_{-1}(t) = T_1(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_0(t) - T_\\infty\\big),$$\nand at $x=L$,\n$$\\frac{\\partial T}{\\partial x}(L,t) = \\frac{T_{N}(t) - T_{N-2}(t)}{2\\,\\Delta x} = -\\frac{h}{k}\\,\\big(T_{N-1}(t) - T_\\infty\\big) \\quad \\Rightarrow \\quad T_{N}(t) = T_{N-2}(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_{N-1}(t) - T_\\infty\\big).$$\n- The resulting ODE system is\n$$\\frac{d T_i}{d t} = \\frac{k}{\\rho c}\\,\\left[\\frac{T_{i+1} - 2\\,T_i + T_{i-1}}{\\Delta x^2}\\right] + \\frac{S_0}{\\rho c}\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T_i}\\right), \\quad i = 1,\\dots,N-2,$$\nwith boundary point updates using ghost values $T_{-1}$ and $T_{N}$ substituted into the same second-order Laplacian form at $i=0$ and $i=N-1$.\n\nParameters to use (with physical units):\n- Slab thickness: $L = 0.01$ meters.\n- Thermal conductivity: $k = 0.3$ watts per meter per kelvin.\n- Density: $\\rho = 800$ kilograms per cubic meter.\n- Specific heat capacity: $c = 2000$ joules per kilogram per kelvin.\n- Volumetric heat capacity: $\\rho c = 1.6 \\times 10^6$ joules per cubic meter per kelvin.\n- Ambient temperature: $T_\\infty = 300$ kelvin.\n- Arrhenius pre-exponential source factor: $S_0 = 5\\times 10^{11}$ watts per cubic meter.\n- Activation energy: $E_a = 6.0\\times 10^4$ joules per mole.\n- Universal Gas Constant: $R = 8.314$ joules per mole per kelvin.\n- Critical runaway threshold: $T_{\\text{runaway}} = 800$ kelvin.\n- Final simulation time: $t_{\\text{final}} = 200$ seconds.\n- Number of grid points: $N = 30$.\n\nInitial condition parameterization:\n- Let $\\Delta T$ be an initial temperature amplitude in kelvin and let the shape be either \"sin\" (a sinusoidal hot spot) or \"uniform\" (a uniform elevation). The initial condition is\n$$T_0(x) = \\begin{cases}\nT_\\infty + \\Delta T \\,\\sin\\!\\left(\\pi\\,x/L\\right),  \\text{for shape = \"sin\"},\\\\\nT_\\infty + \\Delta T,  \\text{for shape = \"uniform\"}.\n\\end{cases}$$\n\nTest suite:\nEvaluate the following five cases, each specified by the pair $(h,\\Delta T,\\text{shape})$ where $h$ is in watts per square meter per kelvin and $\\Delta T$ is in kelvin:\n1. $(60,\\;50,\\;\\text{\"sin\"})$\n2. $(40,\\;50,\\;\\text{\"sin\"})$\n3. $(35,\\;100,\\;\\text{\"sin\"})$\n4. $(40,\\;150,\\;\\text{\"uniform\"})$\n5. $(80,\\;150,\\;\\text{\"sin\"})$\n\nRequired final output format:\n- For each case, return an integer where $1$ denotes \"blow-up\" and $0$ denotes \"quench\" according to the classification criteria above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\texttt{[1,0,1,0,0]}$.\n- All calculations and outputs are in the specified physical units; angles are not used; no percentages are required.",
            "solution": "The user has provided a valid problem statement. The problem describes a one-dimensional transient heat transfer scenario in a reactive slab, governed by a non-linear partial differential equation (PDE). The task is to classify the thermal behavior (quenching versus runaway) for a set of specified initial and boundary conditions. The problem is scientifically grounded, well-posed, and provides a complete set of parameters and a prescribed numerical method.\n\nThe governing equation for the temperature field $T(x,t)$ within the domain $x \\in [0,L]$ is the reaction-diffusion equation:\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial x^2} + S_0 \\,\\exp\\!\\left(-\\frac{E_a}{R\\,T}\\right)\n$$\nHere, we assume the thermal conductivity $k$, density $\\rho$, and specific heat capacity $c$ are constant. This equation models the balance between thermal energy storage (left-hand side), heat conduction (first term on the right), and internal heat generation from an exothermic reaction (second term on the right).\n\nThe problem will be solved using the Method of Lines (MOL). This semi-discretization technique transforms the PDE into a system of coupled ordinary differential equations (ODEs) by discretizing only the spatial dimensions. The spatial domain $x \\in [0, L]$ is discretized into $N = 30$ grid points $x_i = i\\,\\Delta x$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L/(N-1)$. Let $T_i(t) \\equiv T(x_i, t)$ be the temperature at grid point $i$.\n\nThe spatial second derivative (the Laplacian term) at interior grid points ($i=1, \\dots, N-2$) is approximated using a second-order central difference formula:\n$$\n\\frac{\\partial^2 T}{\\partial x^2}(x_i,t) \\approx \\frac{T_{i+1}(t) - 2\\,T_i(t) + T_{i-1}(t)}{\\Delta x^2}\n$$\nSubstituting this into the governing equation for the interior points yields a system of ODEs:\n$$\n\\frac{d T_i}{d t} = \\alpha\\,\\left(\\frac{T_{i+1} - 2\\,T_i + T_{i-1}}{\\Delta x^2}\\right) + \\frac{S_0}{\\rho c}\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T_i}\\right), \\quad i=1, \\dots, N-2\n$$\nwhere $\\alpha = k/(\\rho c)$ is the thermal diffusivity.\n\nThe Robin boundary conditions are incorporated by discretizing the gradient at the boundaries and using \"ghost points\" to maintain second-order accuracy.\nAt the left boundary $x_0=0$, the condition is $k\\,\\frac{\\partial T}{\\partial x}(0,t)=h\\,(T(0,t)-T_\\infty)$. Using a central difference for the gradient, $\\frac{\\partial T}{\\partial x}(0,t) \\approx \\frac{T_1(t) - T_{-1}(t)}{2\\,\\Delta x}$, we solve for the ghost point temperature $T_{-1}$:\n$$\nT_{-1}(t) = T_1(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_0(t) - T_\\infty\\big)\n$$\nSubstituting this into the standard Laplacian formula at $i=0$ gives the ODE for the first grid point:\n$$\n\\frac{d T_0}{d t} = \\alpha \\left(\\frac{T_1 - 2T_0 + T_{-1}}{\\Delta x^2}\\right) + \\frac{q(T_0)}{\\rho c} = \\alpha\\,\\left(\\frac{2T_1 - 2T_0}{\\Delta x^2}\\right) - \\frac{2 \\alpha h}{k \\Delta x}(T_0 - T_\\infty) + \\frac{q(T_0)}{\\rho c}\n$$\nAt the right boundary $x_{N-1}=L$, the condition is $-k\\,\\frac{\\partial T}{\\partial x}(L,t)=h\\,(T_{N-1}(t)-T_\\infty)$. A similar procedure yields the ghost point $T_N$:\n$$\nT_N(t) = T_{N-2}(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_{N-1}(t) - T_\\infty\\big)\n$$\nAnd the corresponding ODE for the last grid point $i=N-1$:\n$$\n\\frac{d T_{N-1}}{d t} = \\alpha \\left(\\frac{T_N - 2T_{N-1} + T_{N-2}}{\\Delta x^2}\\right) + \\frac{q(T_{N-1})}{\\rho c} = \\alpha\\,\\left(\\frac{2T_{N-2} - 2T_{N-1}}{\\Delta x^2}\\right) - \\frac{2 \\alpha h}{k \\Delta x}(T_{N-1} - T_\\infty) + \\frac{q(T_{N-1})}{\\rho c}\n$$\nwhere $q(T) = S_0 \\exp(-E_a/(RT))$.\n\nThis MOL formulation results in a system of $N$ coupled, first-order, non-linear ODEs for the temperature vector $\\boldsymbol{T}(t) = [T_0(t), T_1(t), ..., T_{N-1}(t)]^T$. This system is an initial value problem (IVP), starting from the specified initial condition $T(x,0) = T_0(x)$.\n\nThe Arrhenius source term's exponential dependence on temperature introduces stiffness into the ODE system, especially when runaway is approached. A stiff system is one where numerical stability, rather than accuracy, dictates the step size for explicit solvers, making them prohibitively slow. Therefore, an implicit solver suitable for stiff problems is required. The `scipy.integrate.solve_ivp` function with the `'Radau'` method, which is a high-order implicit Runge-Kutta method, is an appropriate choice.\n\nTo classify the outcome, we integrate the system over the time interval $t \\in [0, t_{\\text{final}}]$, where $t_{\\text{final}} = 200$ s. The classification depends on whether the maximum temperature anywhere in the slab reaches the critical threshold $T_{\\text{runaway}} = 800$ K. A computationally efficient method to detect this is to use an event-driven termination. We define an \"event function\" that monitors the value of $\\max_{i} T_i(t) - T_{\\text{runaway}}$. The ODE solver is instructed to stop integration if this value becomes zero. If the integration terminates due to this event, the outcome is \"blow-up\" (coded as $1$). If the integration completes to $t_{\\text{final}}$ without the event occurring, the outcome is \"quench\" (coded as $0$).\n\nThe implementation proceeds by first defining a function that computes the time-derivative vector $d\\boldsymbol{T}/dt$ given the current state $\\boldsymbol{T}$. Then, for each test case, the corresponding initial temperature vector is constructed. The `solve_ivp` function is called with the ODE system, time span, initial conditions, the event function, and the case-specific parameter $h$. The outcome is then determined from the solver's termination status.\n\nThe physical and numerical parameters are:\n$L = 0.01$ m, $k = 0.3$ W/(m·K), $\\rho = 800$ kg/m³, $c = 2000$ J/(kg·K), so $\\rho c = 1.6 \\times 10^6$ J/(m³·K).\n$T_\\infty = 300$ K, $S_0 = 5 \\times 10^{11}$ W/m³, $E_a = 6.0 \\times 10^4$ J/mol, $R = 8.314$ J/(mol·K).\n$T_{\\text{runaway}} = 800$ K, $t_{\\text{final}} = 200$ s, $N = 30$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the 1D reaction-diffusion problem for thermal runaway analysis.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement.\n    L = 0.01  # Slab thickness (m)\n    k = 0.3  # Thermal conductivity (W/m-K)\n    rho = 800  # Density (kg/m^3)\n    c = 2000  # Specific heat capacity (J/kg-K)\n    rho_c = rho * c  # Volumetric heat capacity (J/m^3-K)\n    T_inf = 300  # Ambient temperature (K)\n    S0 = 5e11  # Arrhenius pre-exponential factor (W/m^3)\n    Ea = 6.0e4  # Activation energy (J/mol)\n    R = 8.314  # Universal Gas Constant (J/mol-K)\n    T_runaway = 800  # Critical runaway threshold (K)\n    t_final = 200  # Final simulation time (s)\n    N = 30  # Number of grid points\n\n    # Discretization setup\n    dx = L / (N - 1)\n    x = np.linspace(0, L, N)\n    \n    # Pre-calculated constant for the ODE function\n    alpha = k / rho_c\n\n    def odesystem(t, T, h):\n        \"\"\"\n        Defines the system of ordinary differential equations (ODEs)\n        resulting from the method-of-lines discretization.\n        \"\"\"\n        dTdt = np.zeros_like(T)\n\n        # Arrhenius source term. Clip T to avoid potential numerical issues,\n        # although temperatures are expected to be positive.\n        T_safe = np.maximum(T, 1.0)\n        q_source = (S0 / rho_c) * np.exp(-Ea / (R * T_safe))\n\n        # Interior points (i = 1 to N-2)\n        laplacian_interior = (T[2:] - 2 * T[1:-1] + T[:-2]) / dx**2\n        dTdt[1:-1] = alpha * laplacian_interior + q_source[1:-1]\n        \n        # Boundary point at x=0 (i=0)\n        # Derived from ghost point method for Robin boundary condition\n        laplacian_bc0 = 2 * (T[1] - T[0]) / dx**2\n        convection_bc0 = (2 * alpha * h / k / dx) * (T[0] - T_inf)\n        dTdt[0] = alpha * laplacian_bc0 - convection_bc0 + q_source[0]\n\n        # Boundary point at x=L (i=N-1)\n        # Derived from ghost point method for Robin boundary condition\n        laplacian_bcN_1 = 2 * (T[N - 2] - T[N - 1]) / dx**2\n        convection_bcN_1 = (2 * alpha * h / k / dx) * (T[N-1] - T_inf)\n        dTdt[N - 1] = alpha * laplacian_bcN_1 - convection_bcN_1 + q_source[N-1]\n        \n        return dTdt\n\n    def runaway_event(t, T, h):\n        \"\"\"\n        Event function to detect when max(T) reaches T_runaway.\n        \"\"\"\n        return np.max(T) - T_runaway\n    \n    runaway_event.terminal = True  # Stop integration when event occurs\n    runaway_event.direction = 1    # Trigger when function goes from - to +\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (60, 50, \"sin\"),\n        (40, 50, \"sin\"),\n        (35, 100, \"sin\"),\n        (40, 150, \"uniform\"),\n        (80, 150, \"sin\"),\n    ]\n\n    results = []\n    for h, Delta_T, shape in test_cases:\n        # Generate initial condition T(x, 0)\n        if shape == \"sin\":\n            T0 = T_inf + Delta_T * np.sin(np.pi * x / L)\n        elif shape == \"uniform\":\n            T0 = np.full(N, T_inf + Delta_T)\n        else:\n            raise ValueError(f\"Unknown shape: {shape}\")\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=odesystem,\n            t_span=[0, t_final],\n            y0=T0,\n            method='Radau',  # Solver suitable for stiff ODEs\n            args=(h,),\n            events=runaway_event,\n            dense_output=False\n        )\n\n        # Classify the result\n        # sol.t_events is a list of arrays; check if the first event triggered\n        if sol.t_events[0].size > 0:\n            results.append(1)  # Blow-up\n        else:\n            results.append(0)  # Quench\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A central challenge in multiphysics simulation is efficiently coupling phenomena that evolve on vastly different time scales. This advanced practice addresses this issue directly by asking you to design a partitioned, multi-rate solver for a coupled slow-fast diffusion problem. You will learn to manage asynchronous time stepping and, critically, diagnose the consequences of initial condition incompatibilities, which can generate non-physical transients at the interface between subdomains .",
            "id": "3510382",
            "problem": "Consider a one-dimensional linear coupled parabolic system describing a slow thermal diffusion field and a fast fluid pressure diffusion field on adjacent domains with a shared interface. The thermal field $T(x,t)$ evolves on the solid subdomain $x \\in (0,1)$ and the pressure field $p(y,t)$ evolves on the fluid subdomain $y \\in (-1,0)$. The fields satisfy the following initial and boundary value problem (IBVP).\n\n- Governing equations (derived from conservation of energy and conservation of mass with Fickian diffusion closures):\n  - Solid (thermal diffusion): $\\dfrac{\\partial T}{\\partial t} = \\varepsilon \\dfrac{\\partial^2 T}{\\partial x^2}$ for $x \\in (0,1)$ and $t \\ge 0$, where $\\varepsilon \\in (0,1)$ is a nondimensional thermal diffusivity chosen so that heat evolves slowly when $\\varepsilon \\ll 1$.\n  - Fluid (pressure diffusion proxy): $\\dfrac{\\partial p}{\\partial t} = \\dfrac{\\partial^2 p}{\\partial y^2}$ for $y \\in (-1,0)$ and $t \\ge 0$.\n\n- Interface coupling at $x=0^+$ and $y=0^-$ (flux continuity via symmetric linear Robin conditions with coupling strength $\\gamma>0$):\n  - $-\\varepsilon \\dfrac{\\partial T}{\\partial x}(0^+,t) = \\gamma \\left(T(0,t) - p(0,t)\\right)$,\n  - $-\\dfrac{\\partial p}{\\partial y}(0^-,t) = \\gamma \\left(p(0,t) - T(0,t)\\right)$.\n\n- Outer boundary conditions (Dirichlet, for definiteness and well-posedness):\n  - $T(1,t) = 0$ for $t \\ge 0$,\n  - $p(-1,t) = 0$ for $t \\ge 0$.\n\n- Initial data:\n  - $T(x,0) = T_0(x)$ for $x \\in [0,1]$,\n  - $p(y,0) = p_0(y)$ for $y \\in [-1,0]$.\n\nAn IBVP for this coupled system is consistent at $t=0$ if the initial data satisfy all boundary and interface conditions at $t=0$, namely $T_0(1)=0$, $p_0(-1)=0$, and the interface conditions\n$$\n-\\varepsilon \\, \\dfrac{\\partial T_0}{\\partial x}(0^+) = \\gamma \\left(T_0(0)-p_0(0)\\right), \\quad -\\dfrac{\\partial p_0}{\\partial y}(0^-) = \\gamma \\left(p_0(0)-T_0(0)\\right).\n$$\nIf these equalities are not satisfied, then the IBVP has an initial incompatibility that generates transient layers localized near the interface. In a partitioned, multi-rate transient coupling in which the pressure subproblem is advanced with a small time step and the heat subproblem is advanced with a larger time step (subcycling), asynchronous initial starts $(T_0,p_0)$ may produce pronounced interface transients on the fast time scale of the pressure field.\n\nYour tasks:\n\n- Starting from conservation principles and the stated diffusion closures, argue why the above coupled system is a correct reduced model for a slow–fast thermal–pressure interface, and formalize the IBVP consistency conditions at $t=0$.\n- Design a partitioned, multi-rate explicit scheme that advances the pressure with time step $\\Delta t_p$ and the heat with time step $\\Delta t_T = M \\Delta t_p$ for some integer $M \\ge 1$ (subcycling), using a first-order explicit Euler method in time and centered finite differences in space on uniform meshes. Use a ghost-point elimination to impose the interface Robin conditions in each subproblem update, but evaluate the interface residuals using one-sided finite differences that do not enforce the Robin conditions by construction (so that residuals are diagnostic, not identically zero).\n- Define the interface residual vector at time $t^n$ by\n$$\nr_T^n = -\\varepsilon \\, \\frac{T_1^n - T_0^n}{\\Delta x} - \\gamma \\left(T_0^n - p_N^n\\right), \\quad\nr_p^n = -\\frac{p_N^n - p_{N-1}^n}{\\Delta y} - \\gamma \\left(p_N^n - T_0^n\\right),\n$$\nwhere $T_i^n$ approximates $T(x_i,t^n)$ on the solid grid with $\\Delta x = 1/N_x$, $x_i = i \\Delta x$, $i \\in \\{0,\\dots,N_x\\}$ and $p_j^n$ approximates $p(y_j,t^n)$ on the fluid grid with $\\Delta y = 1/N_y$, $y_j = -1 + j \\Delta y$, $j \\in \\{0,\\dots,N_y\\}$, with $y_{N_y}=0$. Here $N = N_y$. Use $T_{N_x}^n=0$ and $p_0^n=0$ to enforce the Dirichlet boundaries. Define the scalar diagnostic\n$$\n\\mathcal{R}_{\\infty} = \\max_{n} \\max\\left\\{\\, |r_T^n|,\\, |r_p^n| \\,\\right\\}\n$$\naccumulated over $t \\in [0,t_{\\mathrm{end}}]$.\n- Use the following multi-rate partitioned algorithm: during each macro-step, advance the pressure subproblem $M$ times with step $\\Delta t_p$ while holding the current interface temperature $T_0$ fixed, then advance the heat subproblem once with step $\\Delta t_T = M \\Delta t_p$ using the updated pressure trace at the interface. Choose $\\Delta t_p$ to satisfy explicit stability constraints for both subproblems.\n\nFor numerical assessment, implement the scheme and compute $\\mathcal{R}_{\\infty}$ for the test suite below. All quantities are nondimensional; do not attach physical units.\n\nTest suite parameters:\n\n- Domain discretization: $N_x = 50$, $N_y = 50$.\n- Coupling and scale separation: $\\varepsilon = 10^{-2}$, $\\gamma = 1$.\n- Multi-rate subcycling: $M = 10$.\n- Final time: $t_{\\mathrm{end}} = 2 \\cdot 10^{-2}$.\n- Initial data families (asynchronous starts controlled by a scalar amplitude $a$):\n  - Case $1$: $a = 0$, $T_0(x) \\equiv 0$ for $x \\in [0,1]$, $p_0(y) = a (1+y)$ for $y \\in [-1,0]$.\n  - Case $2$: $a = 10^{-3}$, same functional forms for $T_0$ and $p_0$.\n  - Case $3$: $a = 10^{-1}$, same functional forms for $T_0$ and $p_0$.\nThese choices ensure $T_0(1)=0$, $p_0(-1)=0$, but produce interface incompatibilities whenever $a \\ne 0$.\n\nYour program must:\n\n- Implement the described multi-rate partitioned solver with uniform grids and explicit Euler time stepping, enforcing interface Robin conditions via ghost-point elimination in the subproblem updates, and evaluating the residuals $r_T^n$ and $r_p^n$ using the one-sided finite differences given above.\n- Select $\\Delta t_p$ to satisfy explicit stability conditions for both subproblems: for pressure, $\\Delta t_p \\le \\frac{1}{2} \\Delta y^2$; for heat, $\\Delta t_T \\le \\frac{1}{2} \\Delta x^2 / \\varepsilon$. Use a safety factor strictly less than $1$.\n- For each case in the test suite, compute and return the diagnostic $\\mathcal{R}_{\\infty}$ over $t \\in [0,t_{\\mathrm{end}}]$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the three results $\\left[\\mathcal{R}_{\\infty}^{(1)},\\mathcal{R}_{\\infty}^{(2)},\\mathcal{R}_{\\infty}^{(3)}\\right]$ as a comma-separated Python list literal in the order of Cases $1$–$3$, where each entry is a floating-point number.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and provides a complete and consistent setup for a standard problem in the numerical analysis of coupled partial differential equations.\n\n### Part 1: Theoretical Formulation and Analysis\n\n#### 1.1 Physical Basis of the Model\n\nThe coupled system represents a simplified, one-dimensional model of heat and mass transfer between two adjacent media, a \"solid\" and a \"fluid\". The governing equations can be derived from fundamental conservation principles.\n\n-   **Thermal Field ($T$) in the Solid ($x \\in (0,1)$):** The governing equation, $\\frac{\\partial T}{\\partial t} = \\varepsilon \\frac{\\partial^2 T}{\\partial x^2}$, is the heat equation. It arises from the conservation of energy, which in a one-dimensional medium without heat sources is given by $\\rho c_p \\frac{\\partial T}{\\partial t} + \\frac{\\partial q_x}{\\partial x} = 0$, where $\\rho$ is density, $c_p$ is specific heat capacity, and $q_x$ is the heat flux. Assuming Fourier's law of heat conduction, $q_x = -k \\frac{\\partial T}{\\partial x}$ (where $k$ is thermal conductivity), and constant material properties, we obtain $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$, where $\\alpha = k/(\\rho c_p)$ is the thermal diffusivity. The given equation identifies this diffusivity with the non-dimensional parameter $\\varepsilon$.\n\n-   **Pressure Field ($p$) in the Fluid ($y \\in (-1,0)$):** The equation $\\frac{\\partial p}{\\partial t} = \\frac{\\partial^2 p}{\\partial y^2}$ is a standard diffusion equation. It serves as a model for pressure diffusion in a porous medium or concentration diffusion in a fluid. Its derivation follows from the conservation of mass, $\\frac{\\partial c}{\\partial t} + \\frac{\\partial j_y}{\\partial y} = 0$, where $c$ is concentration and $j_y$ is the mass flux. Assuming pressure $p$ is a proxy for concentration (e.g., via an equation of state) and Fick's first law of diffusion, $j_y = -D \\frac{\\partial p}{\\partial y}$ (where $D$ is a diffusion coefficient), we arrive at $\\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial y^2}$. The problem is non-dimensionalized such that $D=1$.\n\nThe system is a **slow-fast** model because the characteristic time scales of diffusion are different. The time scale for a diffusion process over a length $L$ with diffusivity $D$ is $\\tau \\sim L^2/D$. For the thermal field, $\\tau_T \\sim L_x^2/\\varepsilon$, and for the pressure field, $\\tau_p \\sim L_y^2/1$. Since the domain lengths are of order $1$, the ratio of time scales is $\\tau_p / \\tau_T \\sim \\varepsilon$. For $\\varepsilon \\ll 1$, the thermal process evolves much more slowly than the pressure process, justifying the \"slow heat\" and \"fast pressure\" description.\n\n-   **Interface Coupling:** The Robin-type conditions at the interface ($x=0, y=0$) model the transfer between the two fields. The conditions given are:\n    $$-\\varepsilon \\dfrac{\\partial T}{\\partial x}(0^+,t) = \\gamma \\left(T(0,t) - p(0,t)\\right)$$\n    $$-\\dfrac{\\partial p}{\\partial y}(0^-,t) = \\gamma \\left(p(0,t) - T(0,t)\\right)$$\n    Let the flux out of the solid domain at $x=0$ be $F_T$ and the flux out of the fluid domain at $y=0$ be $F_p$. The outward normal for the solid domain at $x=0$ is in the $-x$ direction, so $F_T = (-\\varepsilon \\frac{\\partial T}{\\partial x}) \\cdot (-1) = \\varepsilon \\frac{\\partial T}{\\partial x}$. The outward normal for the fluid domain at $y=0$ is in the $+y$ direction, so $F_p = (-\\frac{\\partial p}{\\partial y}) \\cdot (+1) = -\\frac{\\partial p}{\\partial y}$.\n    The second condition directly states that the flux out of the fluid, $F_p$, is equal to a transfer term $\\gamma(p(0,t) - T(0,t))$. If we sum the two given conditions, we find $-\\varepsilon \\frac{\\partial T}{\\partial x} - \\frac{\\partial p}{\\partial y} = 0$. This implies that the total flux across the interface is conserved, as required for a physically consistent model.\n\n#### 1.2 Initial Condition Consistency\n\nAn Initial-Boundary Value Problem (IBVP) is consistent at time $t=0$ if the provided initial data, $T(x,0)=T_0(x)$ and $p(y,0)=p_0(y)$, satisfy all boundary and interface conditions of the problem.\n1.  **Outer Boundary Conditions:**\n    -   At $x=1$: $T(1,t)=0 \\implies T_0(1)=0$.\n    -   At $y=-1$: $p(-1,t)=0 \\implies p_0(-1)=0$.\n2.  **Interface Conditions:**\n    -   At $x=0, y=0$: The two coupling conditions must hold for $T_0$ and $p_0$.\n    $$-\\varepsilon \\, \\dfrac{d T_0}{d x}(0^+) = \\gamma \\left(T_0(0)-p_0(0)\\right)$$\n    $$-\\dfrac{d p_0}{d y}(0^-) = \\gamma \\left(p_0(0)-T_0(0)\\right)$$\nIf these equalities are not met by the initial data, an \"initial-layer\" transient occurs, where the solution rapidly adjusts near the interface on the fast time scale to satisfy the conditions. The defined residuals, $r_T$ and $r_p$, measure the degree of this incompatibility.\n\n### Part 2: Numerical Scheme Design\n\nWe design a partitioned, multi-rate explicit scheme using finite differences.\n\n#### 2.1 Discretization\n-   **Solid Domain ($T$):** A uniform grid $x_i = i \\Delta x$ for $i \\in \\{0, 1, \\dots, N_x\\}$, with $\\Delta x = 1/N_x$. $T_i^n \\approx T(x_i, t^n)$.\n-   **Fluid Domain ($p$):** A uniform grid $y_j = -1 + j \\Delta y$ for $j \\in \\{0, 1, \\dots, N_y\\}$, with $\\Delta y = 1/N_y$. $p_j^n \\approx p(y_j, t^n)$. The interface corresponds to $x_0$ and $y_{N_y}$.\n-   **Time:** We use a macro-time step $\\Delta t_T$ for the slow field $T$ and a micro-time step $\\Delta t_p$ for the fast field $p$, such that $\\Delta t_T = M \\Delta t_p$ for an integer $M \\geq 1$. Time levels are $t^n = n \\Delta t_T$.\n\n#### 2.2 Finite Difference Equations\nUsing a first-order explicit Euler method in time and second-order centered differences in space, the governing equations are discretized.\n-   **Interior points:**\n    -   For $T$ ($i=1, \\dots, N_x-1$): $\\frac{T_i^{n+1} - T_i^n}{\\Delta t_T} = \\varepsilon \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2}$.\n    -   For $p$ ($j=1, \\dots, N_y-1$): $\\frac{p_j^{k+1} - p_j^k}{\\Delta t_p} = \\frac{p_{j+1}^k - 2p_j^k + p_{j-1}^k}{\\Delta y^2}$, where $k$ denotes the micro-step index.\n-   **Outer boundary points:**\n    -   $T_{N_x}^n = 0$ for all $n$.\n    -   $p_0^k = 0$ for all $k$.\n\n#### 2.3 Interface Conditions via Ghost-Point Elimination\nWe apply the PDEs at the interface nodes ($i=0$ and $j=N_y$) and use ghost points, which are then eliminated using the Robin conditions.\n-   **Pressure update at $y=0$ ($j=N_y$):**\n    The PDE is $\\frac{p_{N_y}^{k+1} - p_{N_y}^k}{\\Delta t_p} = \\frac{p_{N_y+1}^k - 2p_{N_y}^k + p_{N_y-1}^k}{\\Delta y^2}$. The Robin condition is $-\\frac{\\partial p}{\\partial y}(0,t) = \\gamma(p(0,t)-T(0,t))$. We discretize the derivative with a centered difference involving a ghost point $p_{N_y+1}^k$: $-\\frac{p_{N_y+1}^k - p_{N_y-1}^k}{2\\Delta y} = \\gamma(p_{N_y}^k - T_0^n)$, where $T_0^n$ is held constant during subcycling. Solving for the ghost point gives $p_{N_y+1}^k = p_{N_y-1}^k - 2\\Delta y \\gamma(p_{N_y}^k - T_0^n)$. Substituting into the PDE update yields:\n    $$p_{N_y}^{k+1} = p_{N_y}^k + \\frac{2\\Delta t_p}{\\Delta y^2}(p_{N_y-1}^k - p_{N_y}^k) - \\frac{2\\Delta t_p \\gamma}{\\Delta y}(p_{N_y}^k - T_0^n)$$\n-   **Temperature update at $x=0$ ($i=0$):**\n    The PDE is $\\frac{T_0^{n+1} - T_0^n}{\\Delta t_T} = \\varepsilon \\frac{T_1^n - 2T_0^n + T_{-1}^n}{\\Delta x^2}$. The Robin condition $-\\varepsilon \\frac{\\partial T}{\\partial x}(0,t) = \\gamma(T(0,t)-p(0,t))$ is discretized as $-\\varepsilon \\frac{T_1^n - T_{-1}^n}{2\\Delta x} = \\gamma(T_0^n - p_{N_y}^{n+1})$, using the newly computed pressure $p_{N_y}^{n+1}$. Solving for the ghost point gives $T_{-1}^n = T_1^n + \\frac{2\\Delta x \\gamma}{\\varepsilon}(p_{N_y}^{n+1} - T_0^n)$. Substituting into the PDE update gives:\n    $$T_0^{n+1} = T_0^n + \\frac{2\\varepsilon \\Delta t_T}{\\Delta x^2}(T_1^n-T_0^n) - \\frac{2\\gamma \\Delta t_T}{\\Delta x}(T_0^n - p_{N_y}^{n+1})$$\n\n#### 2.4 Stability and Time Step Selection\nFor an explicit Euler scheme, the time step must be limited for stability. For interior points, the constraints are $\\Delta t_T \\le \\frac{\\Delta x^2}{2\\varepsilon}$ and $\\Delta t_p \\le \\frac{\\Delta y^2}{2}$. The Robin boundary conditions impose stricter constraints. For stability, the coefficients of $T_i^n$ and $p_j^k$ in their own update equations must be non-negative.\n-   From the $p_{N_y}$ update: $1 - \\frac{2\\Delta t_p}{\\Delta y^2} - \\frac{2\\Delta t_p \\gamma}{\\Delta y} \\ge 0 \\implies \\Delta t_p \\le \\frac{\\Delta y^2}{2(1+\\gamma \\Delta y)}$.\n-   From the $T_0$ update: $1 - \\frac{2\\varepsilon \\Delta t_T}{\\Delta x^2} - \\frac{2\\gamma \\Delta t_T}{\\Delta x} \\ge 0 \\implies \\Delta t_T \\le \\frac{\\Delta x^2}{2(\\varepsilon+\\gamma \\Delta x)}$.\nCombining these with $\\Delta t_T = M \\Delta t_p$, the overall constraint on the micro-step $\\Delta t_p$ is:\n$$\\Delta t_p \\le \\min\\left( \\frac{\\Delta y^2}{2(1+\\gamma \\Delta y)}, \\frac{\\Delta x^2}{2M(\\varepsilon+\\gamma \\Delta x)} \\right)$$\nA safety factor below $1$ is applied to this limit to ensure stability.\n\n#### 2.5 Partitioned Multi-rate Algorithm\nFor each macro-step from $t^n$ to $t^{n+1} = t^n + \\Delta t_T$:\n1.  **Store Interface State:** Let $T_{int} = T_0^n$.\n2.  **Pressure Subcycling:** Starting with $p^{n,0} = p^n$, iterate $M$ times for $k = 0, \\dots, M-1$:\n    - Update interior points $p_j^{n,k+1}$ ($j=1,\\dots,N_y-1$).\n    - Update interface point $p_{N_y}^{n,k+1}$ using its specific update rule with the fixed value $T_{int}$.\n    - Note that $p_0^{n,k+1}=0$.\n    The result is $p^{n+1} = p^{n,M}$.\n3.  **Temperature Update:**\n    - Let $p_{int} = p_{N_y}^{n+1}$.\n    - Update interior points $T_i^{n+1}$ ($i=1,\\dots,N_x-1$).\n    - Update interface point $T_0^{n+1}$ using its specific update rule with the new value $p_{int}$.\n    - Note that $T_{N_x}^{n+1}=0$.\n4.  **Advance State:** The new state is $(T^{n+1}, p^{n+1})$.\n5.  **Diagnostic:** The interface residuals $r_T^{n+1}$ and $r_p^{n+1}$ are computed, and $\\mathcal{R}_{\\infty}$ is updated with the maximum observed value. This process is repeated until $t=t_{\\mathrm{end}}$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a partitioned, multi-rate explicit solver for a coupled\n    1D heat-pressure diffusion problem and computes the maximum interface residual.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    Nx = 50\n    Ny = 50\n    eps = 1e-2\n    gamma = 1.0\n    M = 10\n    t_end = 2e-2\n    safety_factor = 0.95\n\n    test_cases_a = [0.0, 1e-3, 1e-1]\n    results = []\n\n    # --- Grid Setup ---\n    dx = 1.0 / Nx\n    dy = 1.0 / Ny\n\n    # --- Time Step Calculation (including Robin BC stability) ---\n    # Constraint from pressure subproblem (interior and boundary)\n    dt_p_limit_interior = dy**2 / 2.0\n    dt_p_limit_boundary = dy**2 / (2.0 * (1.0 + gamma * dy))\n    dt_p_limit = min(dt_p_limit_interior, dt_p_limit_boundary)\n\n    # Constraint from temperature subproblem (interior and boundary)\n    dt_T_limit_interior = dx**2 / (2.0 * eps)\n    dt_T_limit_boundary = dx**2 / (2.0 * (eps + gamma * dx))\n    dt_T_limit = min(dt_T_limit_interior, dt_T_limit_boundary)\n\n    # Combined constraint for the multi-rate scheme\n    # M * dt_p must be = dt_T_limit => dt_p = dt_T_limit / M\n    final_dt_p_limit = min(dt_p_limit, dt_T_limit / M)\n    \n    dt_p = safety_factor * final_dt_p_limit\n    dt_T = M * dt_p\n    \n    num_macro_steps = int(t_end / dt_T)\n\n    for a in test_cases_a:\n        # --- Initial Conditions ---\n        # T field on x in [0, 1], size Nx+1\n        T = np.zeros(Nx + 1)\n        # p field on y in [-1, 0], size Ny+1\n        y_coords = np.linspace(-1.0, 0.0, Ny + 1)\n        p = a * (1.0 + y_coords)\n\n        # Ensure outer BCs are met by initial data\n        T[Nx] = 0.0\n        p[0] = 0.0\n\n        max_residual = 0.0\n        \n        # --- Time-stepping Loop ---\n        for n in range(num_macro_steps + 1):\n            \n            # --- Calculate and record diagnostic residuals ---\n            # Residuals are defined with one-sided differences\n            r_T = -eps * (T[1] - T[0]) / dx - gamma * (T[0] - p[Ny])\n            r_p = -(p[Ny] - p[Ny-1]) / dy - gamma * (p[Ny] - T[0])\n            max_residual = max(max_residual, abs(r_T), abs(r_p))\n\n            if n == num_macro_steps:\n                break\n\n            # --- Partitioned Algorithm ---\n            # Store current state for updates\n            T_old = T.copy()\n            p_old = p.copy()\n\n            # 1. Advance pressure subproblem (M micro-steps)\n            T_interface = T_old[0]\n            p_curr_micro = p_old.copy()\n            for _ in range(M):\n                p_next_micro = p_curr_micro.copy()\n                \n                # Interior points (j=1 to Ny-1)\n                p_next_micro[1:Ny] = p_curr_micro[1:Ny] + (dt_p / dy**2) * \\\n                    (p_curr_micro[2:] - 2 * p_curr_micro[1:Ny] + p_curr_micro[0:Ny-1])\n                \n                # Interface point (j=Ny) using ghost point elimination\n                p_next_micro[Ny] = p_curr_micro[Ny] \\\n                    + (2 * dt_p / dy**2) * (p_curr_micro[Ny-1] - p_curr_micro[Ny]) \\\n                    - (2 * dt_p * gamma / dy) * (p_curr_micro[Ny] - T_interface)\n                \n                # Dirichlet BC at j=0 is maintained as p_next_micro[0] remains 0\n                p_curr_micro = p_next_micro\n            \n            p_next_macro = p_curr_micro # Result after M steps\n\n            # 2. Advance temperature subproblem (1 macro-step)\n            p_interface = p_next_macro[Ny]\n            T_new = T_old.copy()\n            \n            # Interior points (i=1 to Nx-1)\n            T_new[1:Nx] = T_old[1:Nx] + eps * (dt_T / dx**2) * \\\n                (T_old[2:] - 2 * T_old[1:Nx] + T_old[0:Nx-1])\n\n            # Interface point (i=0) using ghost point elimination\n            T_new[0] = T_old[0] \\\n                + (2 * eps * dt_T / dx**2) * (T_old[1] - T_old[0]) \\\n                - (2 * gamma * dt_T / dx) * (T_old[0] - p_interface)\n            \n            # Dirichlet BC at i=Nx is maintained as T_new[Nx] remains 0\n            \n            # Update state for next macro-step\n            T = T_new\n            p = p_next_macro\n\n        results.append(max_residual)\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}