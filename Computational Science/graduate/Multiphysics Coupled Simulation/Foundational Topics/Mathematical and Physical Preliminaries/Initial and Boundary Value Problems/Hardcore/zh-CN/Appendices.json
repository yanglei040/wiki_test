{
    "hands_on_practices": [
        {
            "introduction": "线性平流方程是双曲守恒律的基本原型，描述了众多物理系统中的输运现象。在尝试求解一个初边值问题之前，我们必须首先通过正确指定边界条件来确保其是“适定的”。本练习  将指导您运用能量方法来确定恰当的边界条件，然后使用经典的特征线法构造精确解，从而将初始和边界数据与时空中任意点的解联系起来。",
            "id": "3510395",
            "problem": "考虑一个标量场 $u(x,t)$ 的线性一维输运，其由偏微分方程（PDE）$u_{t}+a\\,u_{x}=0$ 在空间区间 $(0,L)$ 上、时间 $t>0$ 内控制，其中 $a>0$ 是一个常数。假设 $u$ 足够光滑，以使下述操作合理。\n\n任务：\n- 仅使用守恒考虑和积分恒等式，确定为了使初边值问题在 $a>0$ 时是适定的，必须在边界的何处指定 $u$ 的值，并通过推导一个显示边界通量的 $L^{2}(0,L)$ 能量平衡来证明你的选择。\n- 使用特征线法（MOC）构造解，从特征曲线的运动学定律以及 $u$ 沿其为常数的事实出发。推导在任意内部点 $(x,t)\\in(0,L)\\times(0,\\infty)$ 处 $u(x,t)$ 的表示公式，用初始条件 $u(x,0)=u_{0}(x)$ 和单个边界入流数据 $u(0,t)=g(t)$ 来表示。陈述在角点 $(x,t)=(0,0)$ 处获得经典解所需的相容性条件。\n- 具体到 $L=2$, $a=3$, $u_{0}(x)=\\exp(-x)\\sin(\\pi x)$ 和 $g(t)=\\exp(-2t)\\sin(\\pi t)$ 的情况（这些是无量纲数据）。使用你的表示公式，确定 $u(1,3/5)$ 的值。将最终答案表示为没有舍入的精确解析表达式。",
            "solution": "该问题是有效的，因为它是双曲型偏微分方程理论中一个标准的、适定的初边值问题。它具有科学依据，内容自洽且客观。\n\n控制偏微分方程（PDE）是线性平流方程：\n$$u_{t}+a\\,u_{x}=0$$\n对于 $x \\in (0,L)$ 和 $t>0$，其中平流速度 $a>0$ 为常数。\n\n**第一部分：通过能量平衡确定边界条件位置**\n\n为了确定必须在哪个边界上规定标量场 $u$ 的值，我们分析解在空间域 $[0,L]$ 内总“能量”的演化。我们将时间 $t$ 的 $L^2$-能量定义为：\n$$E(t) = \\frac{1}{2} \\int_{0}^{L} u(x,t)^2 \\, dx$$\n假设 $u$ 足够光滑，我们可以通过在积分号下求导（莱布尼茨积分法则）来对 $E(t)$ 关于时间 $t$ 求导：\n$$\\frac{dE}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2} \\int_{0}^{L} u^2 \\, dx \\right) = \\int_{0}^{L} u \\frac{\\partial u}{\\partial t} \\, dx$$\n我们使用控制PDE $u_t = -a u_x$ 来替换 $u_t$：\n$$\\frac{dE}{dt} = \\int_{0}^{L} u (-a u_x) \\, dx = -a \\int_{0}^{L} u \\, u_x \\, dx$$\n被积函数可以表示为 $u^2/2$ 的导数：\n$$u \\, u_x = \\frac{1}{2} \\frac{\\partial}{\\partial x}(u^2)$$\n将此代入积分并应用微积分基本定理：\n$$\\frac{dE}{dt} = -a \\int_{0}^{L} \\frac{1}{2} \\frac{\\partial}{\\partial x}(u^2) \\, dx = -\\frac{a}{2} \\left[ u(x,t)^2 \\right]_{x=0}^{x=L}$$\n在边界上求值，得到能量平衡方程：\n$$\\frac{dE}{dt} = -\\frac{a}{2} \\left( u(L,t)^2 - u(0,t)^2 \\right) = \\frac{a}{2} u(0,t)^2 - \\frac{a}{2} u(L,t)^2$$\n此方程表明，区域 $(0,L)$ 内能量的变化率等于穿过边界 $x=0$ 和 $x=L$ 的能量净通量。\n由于常数 $a$ 是正的（$a>0$），项 $\\frac{a}{2} u(0,t)^2$ 是非负的，表示在边界 $x=0$ 处能量*流入*区域的通量。\n项 $-\\frac{a}{2} u(L,t)^2$ 是非正的，表示在边界 $x=L$ 处能量*流出*区域的通量。\n这对应于平流的物理图像：信息沿正 $x$ 方向传播。因此，$x=0$ 是“入流”边界，$x=L$ 是“出流”边界。\n为了使问题适定，我们必须控制进入区域的信息。因此，我们必须在入流边界 $x=0$ 处规定 $u$ 的值。出流边界 $x=L$ 处的 $u$ 值由初始数据和规定的入流数据的演化决定。在 $x=L$ 处规定条件会过定问题，通常导致解不存在或不唯一。\n因此，对于 $a>0$，边界条件必须在 $x=0$ 处指定。\n\n**第二部分：用特征线法求解**\n\nPDE $u_t + a u_x = 0$ 表明，$u$ 沿着 $(x,t)$-平面中向量 $(a,1)$ 的方向导数为零。这意味着 $u$ 沿着由常微分方程（ODE）定义的特征曲线为常数：\n$$\\frac{dx}{dt} = a$$\n求解此ODE，得到特征线的方程：\n$$x - at = C$$\n其中 $C$ 是一个常数。每条特征线是 $(x,t)$-平面中的一条直线，沿着该直线 $u$ 的值是恒定的。\n\n为了在区域 $(0,L)\\times(0,\\infty)$ 中的一个点 $(x,t)$ 找到解 $u(x,t)$，我们将穿过 $(x,t)$ 的特征曲线向后追溯时间，直到它与区域的边界相交。边界由初始线 $\\{ (x,0) \\mid x \\in [0,L] \\}$ 和入流边界线 $\\{ (0,t) \\mid t>0 \\}$ 组成。\n\n设 $(\\xi, \\tau)$ 是穿过 $(x,t)$ 的特征线上的一个点。那么 $\\xi - a\\tau = x - at$。\n我们需要确定这条特征线源于何处。\n\n情况1：特征线源于初始线 $t=0$。\n交点发生在时间 $\\tau=0$。相应的位置是 $\\xi = x - at$。为了让这个点 $(\\xi, 0)$ 在初始数据区间上，我们必须有 $0 \\le \\xi \\le L$，这意味着 $0 \\le x - at \\le L$。这等价于 $at \\le x \\le L+at$。由于我们是在点 $x \\in (0,L)$ 处求值，此条件简化为 $at \\le x  L$。\n在这个区域，$u$ 的值由初始条件 $u_0(x)$ 传播而来：\n$$u(x,t) = u(\\xi, 0) = u_0(\\xi) = u_0(x-at) \\quad \\text{对于 } x \\ge at$$\n\n情况2：特征线源于边界线 $x=0$。\n交点发生在位置 $\\xi=0$。相应的时间通过求解 $0 - a\\tau = x - at$ 得到，即 $\\tau = t - x/a$。为了让这个点 $(0, \\tau)$ 在规定的边界数据段上，我们必须有 $\\tau > 0$，这意味着 $t - x/a > 0$，或 $x  at$。\n在这个区域，$u$ 的值由边界条件 $g(t)$ 传播而来：\n$$u(x,t) = u(0, \\tau) = g(\\tau) = g(t - x/a) \\quad \\text{对于 } x  at$$\n\n分界线 $x=at$ 是穿过角点 $(0,0)$ 的特征线。结合这两种情况，解的表示公式为：\n$$u(x,t) = \\begin{cases}\nu_0(x-at)  \\text{若 } x \\ge at \\\\\ng(t-x/a)  \\text{若 } x  at\n\\end{cases}$$\n为了存在经典解，它至少必须是连续的。跨越特征线 $x=at$ 的连续性要求来自两个区域的极限相匹配。当一个点 $(x,t)$ 趋近这条线时，我们有：\n$$\\lim_{x \\to (at)^+} u(x,t) = \\lim_{x \\to (at)^+} u_0(x-at) = u_0(0)$$\n$$\\lim_{x \\to (at)^-} u(x,t) = \\lim_{x \\to (at)^-} g(t-x/a) = g(0)$$\n因此，为了得到连续解，在角点 $(x,t)=(0,0)$ 处所需的相容性条件是 $u_0(0) = g(0)$。\n\n**第三部分：具体情况计算**\n\n我们给定的参数是 $L=2$ 和 $a=3$。初始条件是 $u_0(x) = \\exp(-x)\\sin(\\pi x)$，边界条件是 $g(t) = \\exp(-2t)\\sin(\\pi t)$。我们需要求 $u(1, 3/5)$ 的值。\n\n首先，我们确定点 $(x,t) = (1, 3/5)$ 属于哪个区域。我们比较 $x$ 和 $at$：\n$$x = 1$$\n$$at = 3 \\times \\frac{3}{5} = \\frac{9}{5} = 1.8$$\n因为 $1  1.8$，所以我们有 $x  at$。因此，该点的解由边界数据函数 $g(t)$ 决定。使用的公式是：\n$$u(x,t) = g(t - x/a)$$\n我们计算 $g$ 的自变量：\n$$t - \\frac{x}{a} = \\frac{3}{5} - \\frac{1}{3} = \\frac{3 \\times 3 - 1 \\times 5}{15} = \\frac{9-5}{15} = \\frac{4}{15}$$\n现在我们在此自变量值处计算函数 $g$ 的值：\n$$u(1, 3/5) = g\\left(\\frac{4}{15}\\right)$$\n给定 $g(t) = \\exp(-2t)\\sin(\\pi t)$，我们代入 $t=4/15$：\n$$u(1, 3/5) = \\exp\\left(-2 \\times \\frac{4}{15}\\right) \\sin\\left(\\pi \\times \\frac{4}{15}\\right)$$\n$$u(1, 3/5) = \\exp\\left(-\\frac{8}{15}\\right) \\sin\\left(\\frac{4\\pi}{15}\\right)$$\n这是 $u(1, 3/5)$ 值的精确解析表达式。",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{8}{15}\\right) \\sin\\left(\\frac{4\\pi}{15}\\right)}$$"
        },
        {
            "introduction": "虽然线性模型提供了基础性理解，但许多现实世界中的现象是由非线性方程控制的，从而导致了如热失控等复杂行为。这类系统的稳定性可能对初始和边界条件表现出极其精细的敏感性。这个动手编程练习  要求您模拟一个非线性反应扩散问题，旨在提供离散化偏微分方程、处理刚性问题以及数值化描绘稳定（淬灭）与不稳定（爆燃）结果之间临界阈值的实践经验。",
            "id": "3510432",
            "problem": "考虑一个一维反应板，占据空间域 $x \\in [0,L]$，厚度为 $L$（单位：米），其温度场 $T(x,t)$（单位：开尔文）随时间 $t$（单位：秒）演变。该板受到遵循阿伦尼乌斯动力学的放热生成和两端的对流冷却的影响。目标是确定该初值和边值问题是导致淬熄（温度保持有界并趋向于环境温度）还是热失控（温度在有限时间内增长超过临界阈值），并描绘初始温度分布和对流传热系数的微小变化如何改变结果。\n\n基本和控制方程：\n- 设 $\\rho$ 为密度（单位：千克/立方米），$c$ 为比热容（单位：焦耳/千克·开尔文）。体积热容为 $\\rho c$（单位：焦耳/立方米·开尔文）。设 $k$ 为热导率（单位：瓦特/米·开尔文）。能量守恒定律结合傅里叶热传导定律，得到带有体积源 $q(T)$ 的热方程：\n$$\\rho c \\,\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k\\,\\frac{\\partial T}{\\partial x}\\right) + q(T).$$\n- 阿伦尼乌斯热源遵循以下公式：\n$$q(T) = S_0 \\,\\exp\\!\\left(-\\frac{E_a}{R\\,T}\\right),$$\n其中 $S_0$ 是指前源因子（单位：瓦特/立方米），$E_a$ 是活化能（单位：焦耳/摩尔），$R$ 是普适气体常数（UGC）（单位：焦耳/摩尔·开尔文）。\n- 混合（罗宾）边界条件模拟了两端的对流冷却，其外单位法向量为 $\\boldsymbol{n}$：\n$$-k\\,\\nabla T \\cdot \\boldsymbol{n} = h\\,(T - T_\\infty),$$\n其中 $h$ 是对流传热系数（单位：瓦特/平方米·开尔文），$T_\\infty$ 是环境温度（单位：开尔文）。在 $x=0$ 处，外法向量为 $\\boldsymbol{n}=-\\hat{\\boldsymbol{x}}$，这意味着 $k\\,\\frac{\\partial T}{\\partial x}(0,t)=h\\,(T(0,t)-T_\\infty)$；在 $x=L$ 处，$\\boldsymbol{n}=+\\hat{\\boldsymbol{x}}$，这意味着 $-k\\,\\frac{\\partial T}{\\partial x}(L,t)=h\\,(T(L,t)-T_\\infty)$。\n- 初始条件为 $T(x,0)=T_0(x)$，从下面指定的参数化分布中选择。\n\n分类标准：\n- 定义一个临界失控阈值温度 $T_{\\text{runaway}}$（单位：开尔文）。如果在固定的最终时间 $t_{\\text{final}}$ 之前，$\\max_{x \\in [0,L]} T(x,t)$ 达到或超过 $T_{\\text{runaway}}$，则解的结果分类为“爆燃”。否则，结果分类为“淬熄”。\n\n数值方法要求：\n- 使用 $N$ 个等间距网格点对空间域进行离散化，间距为 $\\Delta x = L/(N-1)$。使用线法：对扩散项使用二阶有限差分，对阿伦尼乌斯源项进行逐点评估，以获得关于时间的常微分方程（ODEs）组。\n- 对于内部点 $i=1,\\dots,N-2$，使用以下公式近似拉普拉斯算子：\n$$\\frac{\\partial^2 T}{\\partial x^2}(x_i,t) \\approx \\frac{T_{i+1}(t) - 2\\,T_i(t) + T_{i-1}(t)}{\\Delta x^2}.$$\n- 通过虚点消除法强制实施罗宾边界条件，以保持二阶精度。在 $x=0$ 处，\n$$\\frac{\\partial T}{\\partial x}(0,t) = \\frac{T_1(t) - T_{-1}(t)}{2\\,\\Delta x} = \\frac{h}{k}\\,\\big(T_0(t) - T_\\infty\\big) \\quad \\Rightarrow \\quad T_{-1}(t) = T_1(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_0(t) - T_\\infty\\big),$$\n在 $x=L$ 处，\n$$\\frac{\\partial T}{\\partial x}(L,t) = \\frac{T_{N}(t) - T_{N-2}(t)}{2\\,\\Delta x} = -\\frac{h}{k}\\,\\big(T_{N-1}(t) - T_\\infty\\big) \\quad \\Rightarrow \\quad T_{N}(t) = T_{N-2}(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_{N-1}(t) - T_\\infty\\big).$$\n- 得到的 ODE 系统为：\n$$\\frac{d T_i}{d t} = \\frac{k}{\\rho c}\\,\\left[\\frac{T_{i+1} - 2\\,T_i + T_{i-1}}{\\Delta x^2}\\right] + \\frac{S_0}{\\rho c}\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T_i}\\right), \\quad i = 1,\\dots,N-2,$$\n其中边界点的更新使用虚点值 $T_{-1}$ 和 $T_{N}$，在 $i=0$ 和 $i=N-1$ 处代入相同的二阶拉普拉斯形式。\n\n使用的参数（附物理单位）：\n- 板厚度：$L = 0.01$ 米。\n- 热导率：$k = 0.3$ 瓦特/米·开尔文。\n- 密度：$\\rho = 800$ 千克/立方米。\n- 比热容：$c = 2000$ 焦耳/千克·开尔文。\n- 体积热容：$\\rho c = 1.6 \\times 10^6$ 焦耳/立方米·开尔文。\n- 环境温度：$T_\\infty = 300$ 开尔文。\n- 阿伦尼乌斯指前源因子：$S_0 = 5\\times 10^{11}$ 瓦特/立方米。\n- 活化能：$E_a = 6.0\\times 10^4$ 焦耳/摩尔。\n- 普适气体常数：$R = 8.314$ 焦耳/摩尔·开尔文。\n- 临界失控阈值：$T_{\\text{runaway}} = 800$ 开尔文。\n- 最终模拟时间：$t_{\\text{final}} = 200$ 秒。\n- 网格点数：$N = 30$。\n\n初始条件参数化：\n- 设 $\\Delta T$ 为初始温度振幅（单位：开尔文），形状可以是“sin”（正弦热点）或“uniform”（均匀升高）。初始条件为：\n$$T_0(x) = \\begin{cases}\nT_\\infty + \\Delta T \\,\\sin\\!\\left(\\pi\\,x/L\\right),  \\text{对于形状 = \"sin\"},\\\\\nT_\\infty + \\Delta T,  \\text{对于形状 = \"uniform\"}.\n\\end{cases}$$\n\n测试套件：\n评估以下五个案例，每个案例由对 $(h,\\Delta T,\\text{shape})$ 指定，其中 $h$ 的单位是瓦特/平方米·开尔文，$\\Delta T$ 的单位是开尔文：\n1. (60, 50, \"sin\")\n2. (40, 50, \"sin\")\n3. (35, 100, \"sin\")\n4. (40, 150, \"uniform\")\n5. (80, 150, \"sin\")\n\n要求的最终输出格式：\n- 对于每个案例，根据上述分类标准返回一个整数，其中 $1$ 表示“爆燃”，$0$ 表示“淬熄”。您的程序应生成单行输出，包含方括号括起来的逗号分隔的结果列表，例如 $\\texttt{[1,0,1,0,0]}$。\n- 所有计算和输出均使用指定的物理单位；不使用角度；不需要百分比。",
            "solution": "用户提供了一个有效的问题陈述。该问题描述了一个反应板中的一维瞬态传热情景，由一个非线性偏微分方程（PDE）控制。任务是为一组指定的初始和边界条件对热行为（淬熄与热失控）进行分类。该问题具有科学依据，是适定的，并提供了一整套参数和规定的数值方法。\n\n温度场 $T(x,t)$ 在域 $x \\in [0,L]$ 内的控制方程是反应-扩散方程：\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial x^2} + S_0 \\,\\exp\\!\\left(-\\frac{E_a}{R\\,T}\\right)\n$$\n在此，我们假设热导率 $k$、密度 $\\rho$ 和比热容 $c$ 是常数。该方程模拟了热能储存（左侧）、热传导（右侧第一项）和放热反应产生的内部热量（右侧第二项）之间的平衡。\n\n该问题将使用线法（MOL）求解。这种半离散化技术通过仅对空间维度进行离散化，将偏微分方程转换为一个耦合的常微分方程（ODEs）系统。空间域 $x \\in [0, L]$ 被离散化为 $N = 30$ 个网格点 $x_i = i\\,\\Delta x$，$i = 0, 1, \\dots, N-1$，其中网格间距为 $\\Delta x = L/(N-1)$。设 $T_i(t) \\equiv T(x_i, t)$ 为网格点 $i$ 处的温度。\n\n在内部网格点（$i=1, \\dots, N-2$）处，空间二阶导数（拉普拉斯项）使用二阶中心差分公式近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2}(x_i,t) \\approx \\frac{T_{i+1}(t) - 2\\,T_i(t) + T_{i-1}(t)}{\\Delta x^2}\n$$\n将此代入内部点的控制方程，得到一个 ODEs 系统：\n$$\n\\frac{d T_i}{d t} = \\alpha\\,\\left(\\frac{T_{i+1} - 2\\,T_i + T_{i-1}}{\\Delta x^2}\\right) + \\frac{S_0}{\\rho c}\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T_i}\\right), \\quad i=1, \\dots, N-2\n$$\n其中 $\\alpha = k/(\\rho c)$ 是热扩散率。\n\n通过在边界处离散化梯度并使用“虚点”来合并罗宾边界条件，以保持二阶精度。\n在左边界 $x_0=0$ 处，条件为 $k\\,\\frac{\\partial T}{\\partial x}(0,t)=h\\,(T(0,t)-T_\\infty)$。使用中心差分计算梯度，$\\frac{\\partial T}{\\partial x}(0,t) \\approx \\frac{T_1(t) - T_{-1}(t)}{2\\,\\Delta x}$，我们求解虚点温度 $T_{-1}$：\n$$\nT_{-1}(t) = T_1(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_0(t) - T_\\infty\\big)\n$$\n将此代入 $i=0$ 处的标准拉普拉斯公式，得到第一个网格点的 ODE：\n$$\n\\frac{d T_0}{d t} = \\alpha \\left(\\frac{T_1 - 2T_0 + T_{-1}}{\\Delta x^2}\\right) + \\frac{q(T_0)}{\\rho c} = \\alpha\\,\\left(\\frac{2T_1 - 2T_0}{\\Delta x^2}\\right) - \\frac{2 \\alpha h}{k \\Delta x}(T_0 - T_\\infty) + \\frac{q(T_0)}{\\rho c}\n$$\n在右边界 $x_{N-1}=L$ 处，条件为 $-k\\,\\frac{\\partial T}{\\partial x}(L,t)=h\\,(T_{N-1}(t)-T_\\infty)$。类似的过程得到虚点 $T_N$：\n$$\nT_N(t) = T_{N-2}(t) - 2\\,\\Delta x\\,\\frac{h}{k}\\,\\big(T_{N-1}(t) - T_\\infty\\big)\n$$\n以及最后一个网格点 $i=N-1$ 对应的 ODE：\n$$\n\\frac{d T_{N-1}}{d t} = \\alpha \\left(\\frac{T_N - 2T_{N-1} + T_{N-2}}{\\Delta x^2}\\right) + \\frac{q(T_{N-1})}{\\rho c} = \\alpha\\,\\left(\\frac{2T_{N-2} - 2T_{N-1}}{\\Delta x^2}\\right) - \\frac{2 \\alpha h}{k \\Delta x}(T_{N-1} - T_\\infty) + \\frac{q(T_{N-1})}{\\rho c}\n$$\n其中 $q(T) = S_0 \\exp(-E_a/(RT))$。\n\n这种 MOL 公式化产生了一个关于温度向量 $\\boldsymbol{T}(t) = [T_0(t), T_1(t), ..., T_{N-1}(t)]^T$ 的 $N$ 个耦合、一阶、非线性 ODEs 系统。该系统是一个初值问题（IVP），从指定的初始条件 $T(x,0) = T_0(x)$ 开始。\n\n阿伦尼乌斯源项对温度的指数依赖性给 ODE 系统带来了刚性，尤其是在接近热失控时。刚性系统是指其数值稳定性而非精度决定了显式求解器的步长，从而使其变得极其缓慢。因此，需要一个适合刚性问题的隐式求解器。使用 `'Radau'` 方法的 `scipy.integrate.solve_ivp` 函数是一个合适的选择，该方法是一种高阶隐式 Runge-Kutta 方法。\n\n为了对结果进行分类，我们在时间间隔 $t \\in [0, t_{\\text{final}}]$（其中 $t_{\\text{final}} = 200$ s）上对系统进行积分。分类取决于板内任意位置的最高温度是否达到临界阈值 $T_{\\text{runaway}} = 800$ K。一种计算上高效的检测方法是使用事件驱动的终止。我们定义一个“事件函数”，用于监视 $\\max_{i} T_i(t) - T_{\\text{runaway}}$ 的值。如果该值变为零，ODE 求解器将被指示停止积分。如果积分因此事件而终止，则结果为“爆燃”（编码为 $1$）。如果积分完成到 $t_{\\text{final}}$ 而未发生事件，则结果为“淬熄”（编码为 $0$）。\n\n物理和数值参数如下：\n$L = 0.01$ m, $k = 0.3$ W/(m·K), $\\rho = 800$ kg/m³, $c = 2000$ J/(kg·K), 所以 $\\rho c = 1.6 \\times 10^6$ J/(m³·K)。\n$T_\\infty = 300$ K, $S_0 = 5 \\times 10^{11}$ W/m³, $E_a = 6.0 \\times 10^4$ J/mol, $R = 8.314$ J/(mol·K)。\n$T_{\\text{runaway}} = 800$ K, $t_{\\text{final}} = 200$ s, $N = 30$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the 1D reaction-diffusion problem for thermal runaway analysis.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement.\n    L = 0.01  # Slab thickness (m)\n    k = 0.3  # Thermal conductivity (W/m-K)\n    rho = 800  # Density (kg/m^3)\n    c = 2000  # Specific heat capacity (J/kg-K)\n    rho_c = rho * c  # Volumetric heat capacity (J/m^3-K)\n    T_inf = 300  # Ambient temperature (K)\n    S0 = 5e11  # Arrhenius pre-exponential factor (W/m^3)\n    Ea = 6.0e4  # Activation energy (J/mol)\n    R = 8.314  # Universal Gas Constant (J/mol-K)\n    T_runaway = 800  # Critical runaway threshold (K)\n    t_final = 200  # Final simulation time (s)\n    N = 30  # Number of grid points\n\n    # Discretization setup\n    dx = L / (N - 1)\n    x = np.linspace(0, L, N)\n    \n    # Pre-calculated constant for the ODE function\n    alpha = k / rho_c\n\n    def odesystem(t, T, h):\n        \"\"\"\n        Defines the system of ordinary differential equations (ODEs)\n        resulting from the method-of-lines discretization.\n        \"\"\"\n        dTdt = np.zeros_like(T)\n\n        # Arrhenius source term. Clip T to avoid potential numerical issues,\n        # although temperatures are expected to be positive.\n        T_safe = np.maximum(T, 1.0)\n        q_source = (S0 / rho_c) * np.exp(-Ea / (R * T_safe))\n\n        # Interior points (i = 1 to N-2)\n        laplacian_interior = (T[2:] - 2 * T[1:-1] + T[:-2]) / dx**2\n        dTdt[1:-1] = alpha * laplacian_interior + q_source[1:-1]\n        \n        # Boundary point at x=0 (i=0)\n        # Derived from ghost point method for Robin boundary condition\n        laplacian_bc0 = 2 * (T[1] - T[0]) / dx**2\n        convection_bc0 = (2 * h / (rho_c * dx)) * (T[0] - T_inf)\n        dTdt[0] = alpha * laplacian_bc0 - convection_bc0 + q_source[0]\n\n        # Boundary point at x=L (i=N-1)\n        # Derived from ghost point method for Robin boundary condition\n        laplacian_bcN_1 = 2 * (T[N - 2] - T[N - 1]) / dx**2\n        convection_bcN_1 = (2 * h / (rho_c * dx)) * (T[N-1] - T_inf)\n        dTdt[N - 1] = alpha * laplacian_bcN_1 - convection_bcN_1 + q_source[N-1]\n        \n        return dTdt\n\n    def runaway_event(t, T, h):\n        \"\"\"\n        Event function to detect when max(T) reaches T_runaway.\n        \"\"\"\n        return np.max(T) - T_runaway\n    \n    runaway_event.terminal = True  # Stop integration when event occurs\n    runaway_event.direction = 1    # Trigger when function goes from - to +\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (60, 50, \"sin\"),\n        (40, 50, \"sin\"),\n        (35, 100, \"sin\"),\n        (40, 150, \"uniform\"),\n        (80, 150, \"sin\"),\n    ]\n\n    results = []\n    for h, Delta_T, shape in test_cases:\n        # Generate initial condition T(x, 0)\n        if shape == \"sin\":\n            T0 = T_inf + Delta_T * np.sin(np.pi * x / L)\n        elif shape == \"uniform\":\n            T0 = np.full(N, T_inf + Delta_T)\n        else:\n            raise ValueError(f\"Unknown shape: {shape}\")\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=odesystem,\n            t_span=[0, t_final],\n            y0=T0,\n            method='Radau',  # Solver suitable for stiff ODEs\n            args=(h,),\n            events=runaway_event,\n            dense_output=False\n        )\n\n        # Classify the result\n        # sol.t_events is a list of arrays; check if the first event triggered\n        if sol.t_events[0].size > 0:\n            results.append(1)  # Blow-up\n        else:\n            results.append(0)  # Quench\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "先进的多物理场模拟需要在不同物理域之间进行耦合，而用于施加界面约束的方法对整个数值模型有着深远的影响。这一选择决定了半离散化系统的数学结构，并规定了对一致初始条件的关键要求。最后一个练习  将焦点从求解单个偏微分方程转移到对耦合策略的高层次分析，比较了拉格朗日乘子法和罚函数法，并探讨了它们对系统微分代数方程（DAE）指数的影响。",
            "id": "3510396",
            "problem": "考虑一个定义在固定有界域 $\\Omega$ 上的耦合扩散-力学初始和边界值问题 (IBVP)。该域被划分为两个子域 $\\Omega^{-}$ 和 $\\Omega^{+}$，它们之间的内部界面为 $\\Gamma = \\partial \\Omega^{-} \\cap \\partial \\Omega^{+}$。令 $\\boldsymbol u(\\boldsymbol x,t)$ 表示小应变位移，$c(\\boldsymbol x,t)$ 表示浓度。力学行为由线性动量守恒控制，扩散由质量守恒控制：\n- 线性动量守恒：在 $\\Omega \\times (0,T]$ 内，$\\rho \\ddot{\\boldsymbol u} - \\nabla \\cdot \\boldsymbol \\sigma(\\boldsymbol u,c) = \\boldsymbol f$，其中 $\\rho$ 是质量密度，$\\boldsymbol \\sigma$ 是 Cauchy 应力，$\\boldsymbol f$ 是体力密度。\n- 质量守恒（为明确起见，此处为 Fickian 扩散）：在 $\\Omega \\times (0,T]$ 内，$\\dot c - \\nabla \\cdot (D \\nabla c) = s$，其中 $D$ 是正定扩散张量，$s$ 是源项。\n\n假设在 $\\partial \\Omega$ 上设定了标准边界条件，并且在 $\\Gamma$ 上必须满足以下界面连续性约束：\n- 位移连续性：$\\llbracket \\boldsymbol u \\rrbracket_{\\Gamma} = \\boldsymbol 0$。\n- 化学势或浓度连续性（为简化起见，取浓度 $c$）：$\\llbracket c \\rrbracket_{\\Gamma} = 0$。\n\n在整体式有限元空间离散化中，这些界面约束可以通过 Lagrange 乘子或罚函数项来施加。应用直线法，得到一个半离散系统。引入节点未知量 $\\boldsymbol u(t)$、$\\boldsymbol v(t) = \\dot{\\boldsymbol u}(t)$、$c(t)$，以及（若适用）界面 Lagrange 乘子 $\\boldsymbol \\lambda_{u}(t)$ 和 $\\lambda_{c}(t)$。用 $M_{u}$ 和 $M_{c}$ 表示力学和扩散的对称正定质量矩阵，用 $K_{u}$ 和 $K_{c}$ 表示相应的类刚度矩阵，用 $g_{u}(\\boldsymbol u)$ 和 $g_{c}(c)$ 表示离散界面约束残差；它们相对于约束状态的雅可比矩阵为 $Dg_{u}(\\boldsymbol u)$ 和 $Dg_{c}(c)$。令 $B_{u}$ 和 $B_{c}$ 为界面乘子和体残差之间的离散耦合算子，与弱形式施加 $g_{u}(\\boldsymbol u)=\\boldsymbol 0$ 和 $g_{c}(c)=0$ 的方式一致。\n\n从上述基本定律以及完整约束和微分代数方程（DAE）的定义出发，论述 Lagrange 乘子法与罚函数法对半离散瞬态系统的 DAE 指数和初始条件要求的影响。特别地，要考虑到力学和扩散控制方程的不同时间阶数，以及界面约束是涉及主变量 $\\boldsymbol u$ 和 $c$ 的完整等式这一事实。\n\n假设为惯性力学（即 $\\rho \\neq 0$）和整体耦合，以下哪种陈述最能描述两种施加策略下半离散系统的 DAE 指数及相关的初始条件要求？\n\nA. 对于 Lagrange 乘子法，完整的位移连续性约束与二阶力学方程相结合，得到一个指数为 $3$ 的整体 DAE；而一阶扩散方程与完整的浓度连续性约束相结合，使得该子系统的指数为 $2$；耦合系统的指数为 $3$。为确保一致性，初始条件必须满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$、$Dg_{u}(\\boldsymbol u(0))\\,\\boldsymbol v(0)=\\boldsymbol 0$ 和 $g_{c}(c(0))=0$；然后由加速度水平的相容性确定 $\\boldsymbol \\lambda_{u}(0)$ 和 $\\lambda_{c}(0)$。对于罚函数法，约束表现为刚性恢复项，系统是纯微分的（指数为 $1$），并且不要求在 $t=0$ 时精确满足 $g_{u}$ 和 $g_{c}$，尽管其违背量会在由罚系数控制的快速时间尺度上松弛。\n\nB. Lagrange 乘子法将半离散系统降为指数 $1$，因为乘子无需微分即可直接求解约束，所以只需在 $t=0$ 时满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$。罚函数法由于刚度将指数增加到 $2$，因此为避免数值爆炸，需要同时满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$ 和 $Dg_{u}(\\boldsymbol u(0))\\,\\boldsymbol v(0)=\\boldsymbol 0$。\n\nC. Lagrange 乘子法产生一个指数为 $2$ 的 DAE，无论力学是惯性的还是准静态的，并且只需要满足 $g_{c}(c(0))=0$。罚函数法不改变指数，但强制在 $t=0$ 时精确满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$ 和 $g_{c}(c(0))=0$。\n\nD. 对于惯性力学，Lagrange 乘子法得到指数 $3$，但如果 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$ 成立，则不需要速度水平的一致性 $Dg_{u}(\\boldsymbol u(0))\\,\\boldsymbol v(0)=\\boldsymbol 0$；罚函数法将指数保持在 $2$，并要求在 $t=0$ 时满足加速度水平的一致性以避免冲量。",
            "solution": "问题陈述的有效性得到确认，因为它在计算多物理场领域提出了一个适定的、有科学依据的问题，没有歧义、矛盾或事实错误。微分代数方程（DAE）、完整约束、Lagrange 乘子和罚函数法等概念是该领域的标准内容。我们可以进行全面分析。\n\n该问题要求描述一个耦合扩散-力学问题的半离散系统的 DAE 指数和初始条件要求，该问题通过两种不同方法施加约束：Lagrange 乘子和罚函数项。DAE 指数表示为了获得一个关于所有变量的纯常微分方程（ODE），系统中的代数约束必须对时间求导的最小次数。\n\n让我们分别分析这两种施加策略。\n\n### 1. Lagrange 乘子法\n\n在这种方法中，界面连续性约束通过 Lagrange 乘子附加到方程组中，这些乘子作为代数变量，代表约束力/通量。\n\n**力学子系统：**\n带有完整约束 $g_u(\\boldsymbol u) = \\boldsymbol 0$ 的惯性力学半离散方程形式如下：\n$$\n\\begin{align*}\nM_u \\ddot{\\boldsymbol u}(t) + K_u(\\boldsymbol u, c) + B_u^T \\boldsymbol{\\lambda}_u(t) = \\boldsymbol f_u(t) \\quad (1) \\\\\ng_u(\\boldsymbol u(t)) = \\boldsymbol 0 \\quad (2)\n\\end{align*}\n$$\n此处，方程 $(1)$ 是关于状态变量 $\\boldsymbol u$ 的二阶微分方程，方程 $(2)$ 是一个纯代数约束。变量 $\\boldsymbol{\\lambda}_u$ 是代数变量。为确定 DAE 指数，我们对约束 $(2)$ 进行微分，直到可以解出 $\\boldsymbol{\\lambda}_u$。\n\n1.  **约束的第一次微分：**\n    $$ \\frac{d}{dt}g_u(\\boldsymbol u(t)) = \\frac{\\partial g_u}{\\partial \\boldsymbol u} \\dot{\\boldsymbol u}(t) = Dg_u(\\boldsymbol u) \\boldsymbol v(t) = \\boldsymbol 0 \\quad (3) $$\n    这产生了一个关于速度 $\\boldsymbol v = \\dot{\\boldsymbol u}$ 的新代数约束。它尚不能用于求解 $\\boldsymbol{\\lambda}_u$。\n\n2.  **约束的第二次微分：**\n    $$ \\frac{d}{dt}\\left( Dg_u(\\boldsymbol u) \\boldsymbol v(t) \\right) = \\dot{D}g_u(\\boldsymbol u, \\boldsymbol v)\\boldsymbol v(t) + Dg_u(\\boldsymbol u) \\dot{\\boldsymbol v}(t) = \\boldsymbol 0 \\quad (4) $$\n    其中 $\\dot{\\boldsymbol v} = \\ddot{\\boldsymbol u}$。我们现在可以从运动方程 $(1)$ 中代入 $\\ddot{\\boldsymbol u}$：\n    $$ \\ddot{\\boldsymbol u} = M_u^{-1} \\left( \\boldsymbol f_u - K_u(\\boldsymbol u, c) - B_u^T \\boldsymbol{\\lambda}_u \\right) $$\n    将此代入 $(4)$ 得到：\n    $$ \\dot{D}g_u(\\boldsymbol u, \\boldsymbol v)\\boldsymbol v + Dg_u(\\boldsymbol u) M_u^{-1} \\left( \\boldsymbol f_u - K_u(\\boldsymbol u, c) - B_u^T \\boldsymbol{\\lambda}_u \\right) = \\boldsymbol 0 $$\n    这个方程现在是一个可以求解 $\\boldsymbol{\\lambda}_u$ 的代数方程：\n    $$ \\left( Dg_u M_u^{-1} B_u^T \\right) \\boldsymbol{\\lambda}_u = Dg_u M_u^{-1} \\left( \\boldsymbol f_u - K_u(\\boldsymbol u, c) \\right) + \\dot{D}g_u(\\boldsymbol u, \\boldsymbol v)\\boldsymbol v $$\n    由于我们对原始约束 $g_u = \\boldsymbol 0$ 微分了两次，才为状态变量获得一个 ODE 并为代数变量获得一个表达式，因此力学子系统的指数为 $3$。\n\n**扩散子系统：**\n带有完整约束 $g_c(c) = 0$ 的扩散半离散方程为：\n$$\n\\begin{align*}\nM_c \\dot{c}(t) + K_c(c) + B_c^T \\lambda_c(t) = \\boldsymbol s_c(t) \\quad (5) \\\\\ng_c(c(t)) = 0 \\quad (6)\n\\end{align*}\n$$\n此处，方程 $(5)$ 是一个一阶微分方程。\n\n1.  **约束的第一次微分：**\n    $$ \\frac{d}{dt}g_c(c(t)) = \\frac{\\partial g_c}{\\partial c} \\dot{c}(t) = Dg_c(c) \\dot{c}(t) = 0 \\quad (7) $$\n    我们可以从控制方程 $(5)$ 中代入 $\\dot{c}$：\n    $$ \\dot{c} = M_c^{-1} \\left( \\boldsymbol s_c - K_c(c) - B_c^T \\lambda_c \\right) $$\n    将此代入 $(7)$ 得到：\n    $$ Dg_c(c) M_c^{-1} \\left( \\boldsymbol s_c - K_c(c) - B_c^T \\lambda_c \\right) = 0 $$\n    这个方程可以用来求解 $\\lambda_c$：\n    $$ \\left( Dg_c M_c^{-1} B_c^T \\right) \\lambda_c = Dg_c M_c^{-1} \\left( \\boldsymbol s_c - K_c(c) \\right) $$\n    由于我们对原始约束 $g_c=0$ 微分了一次来求解 $\\lambda_c$，因此扩散子系统的指数为 $2$。\n\n**耦合系统和初始条件：**\n对于一个整体系统，总的 DAE 指数是其相互作用的各分量指数的最大值。因此，耦合系统的指数为 $\\max(3, 2) = 3$。\n对于一个指数为 $3$ 的系统，一组一致的初始条件要求满足代数约束及其时间导数，直到它们变为微分形式。具体来说，在 $t=0$ 时：\n1.  必须满足力学的位置级约束：$g_u(\\boldsymbol u(0)) = \\boldsymbol 0$。\n2.  必须满足力学的速度级约束：$Dg_u(\\boldsymbol u(0)) \\boldsymbol v(0) = \\boldsymbol 0$。\n3.  必须满足扩散的浓度级约束：$g_c(c(0)) = 0$。\nLagrange 乘子的初始值 $\\boldsymbol \\lambda_u(0)$ 和 $\\lambda_c(0)$ 不是自由指定的，而是分别由力学的加速度级一致性条件和扩散的速率级一致性条件，利用初始状态 $(\\boldsymbol u(0), \\boldsymbol v(0), c(0))$ 来确定。\n\n### 2. 罚函数法\n\n在这种方法中，约束不是精确施加的。相反，它们通过罚函数项被并入力学系统的势能或作为扩散的恢复通量。控制方程变为：\n$$\n\\begin{align*}\nM_u \\ddot{\\boldsymbol u}(t) + K_u(\\boldsymbol u, c) + \\alpha_u B_u^T g_u(\\boldsymbol u) = \\boldsymbol f_u(t) \\\\\nM_c \\dot{c}(t) + K_c(c) + \\alpha_c B_c^T g_c(c) = \\boldsymbol s_c(t)\n\\end{align*}\n$$\n其中 $\\alpha_u \\gg 0$ 和 $\\alpha_c \\gg 0$ 是大的罚参数。Lagrange 乘子从系统中消除了。得到的系统是一组耦合的二阶和一阶 ODE。通过引入状态向量 $\\boldsymbol y = [\\boldsymbol u^T, \\boldsymbol v^T, c^T]^T$（其中 $\\boldsymbol v = \\dot{\\boldsymbol u}$），整个系统可以写成标准的一阶 ODE 形式 $\\dot{\\boldsymbol y} = F(\\boldsymbol y, t)$。根据定义，一个 ODE 系统是指数为 $1$ 的 DAE。\n大的罚参数使得系统在数值上是刚性的，这意味着通常需要使用隐式时间积分器来保证稳定性。\n对于一个 ODE 系统，对初始条件的唯一要求是指定初始状态，即 $\\boldsymbol u(0)$、$\\boldsymbol v(0)$ 和 $c(0)$。没有数学上的要求规定这些初始条件必须满足 $g_u(\\boldsymbol u(0))=\\boldsymbol 0$ 或 $g_c(c(0))=0$。任何对约束的初始违背都会导致来自罚函数项的巨大“恢复”力/通量，从而引起一个快速的瞬态过程，在由 $\\alpha_u$ 和 $\\alpha_c$ 决定的极短时间尺度上驱动解去满足约束。\n\n### 选项评估\n\n**A. 对于 Lagrange 乘子法，完整的位移连续性约束与二阶力学方程相结合，得到一个指数为 $3$ 的整体 DAE；而一阶扩散方程与完整的浓度连续性约束相结合，使得该子系统的指数为 $2$；耦合系统的指数为 $3$。为确保一致性，初始条件必须满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$、$Dg_{u}(\\boldsymbol u(0))\\,\\boldsymbol v(0)=\\boldsymbol 0$ 和 $g_{c}(c(0))=0$；然后由加速度水平的相容性确定 $\\boldsymbol \\lambda_{u}(0)$ 和 $\\lambda_{c}(0)$。对于罚函数法，约束表现为刚性恢复项，系统是纯微分的（指数为 $1$），并且不要求在 $t=0$ 时精确满足 $g_{u}$ 和 $g_{c}$，尽管其违背量会在由罚系数控制的快速时间尺度上松弛。**\n该陈述与我们的推导完全一致。它正确地指出了 DAE 指数（力学为 $3$，扩散为 $2$，Lagrange 乘子法下整体为 $3$），对状态变量的必要初始条件一致性要求，以及对罚函数法的正确定性，即其产生一个刚性的指数为 $1$ 的 ODE 系统，其中在数学上不要求满足初始约束。\n**结论：正确。**\n\n**B. Lagrange 乘子法将半离散系统降为指数 $1$，因为乘子无需微分即可直接求解约束，所以只需在 $t=0$ 时满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$。罚函数法由于刚度将指数增加到 $2$，因此为避免数值爆炸，需要同时满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$ 和 $Dg_{u}(\\boldsymbol u(0))\\,\\boldsymbol v(0)=\\boldsymbol 0$。**\n该陈述从根本上是错误的。将 Lagrange 乘子应用于带位置约束的二阶动力学系统会得到指数为 $3$ 的 DAE，而不是指数 $1$。必须对约束进行微分才能求解乘子。罚函数法将系统降至指数 $1$（一个 ODE），而不是增加指数。刚性是 ODE 的一个属性，不是导致更高指数的原因。\n**结论：错误。**\n\n**C. Lagrange 乘子法产生一个指数为 $2$ 的 DAE，无论力学是惯性的还是准静态的，并且只需要满足 $g_{c}(c(0))=0$。罚函数法不改变指数，但强制在 $t=0$ 时精确满足 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$ 和 $g_{c}(c(0))=0$。**\n该陈述是错误的。带位置约束的惯性力学的指数是 $3$，不是 $2$。虽然准静态力学可能导致不同的指数（通常是 $2$），但“无论如何”都是 $2$ 的说法是错误的。此外，初始条件的要求不完整，因为它忽略了力学约束的一致性。对罚函数法的描述也是错误的；它将指数从 $3$ 变为 $1$，并且不强制精确满足初始约束。\n**结论：错误。**\n\n**D. 对于惯性力学，Lagrange 乘子法得到指数 $3$，但如果 $g_{u}(\\boldsymbol u(0))=\\boldsymbol 0$ 成立，则不需要速度水平的一致性 $Dg_{u}(\\boldsymbol u(0))\\,\\boldsymbol v(0)=\\boldsymbol 0$；罚函数法将指数保持在 $2$，并要求在 $t=0$ 时满足加速度水平的一致性以避免冲量。**\n该陈述是错误的。它正确地指出 Lagrange 乘子法下的指数为 $3$，但错误地声称不需要速度级的一致性。这是对指数为 $3$ 的问题进行一致初始化的一个关键要求。忽略它将导致一个不一致的状态，该状态无法在时间上平滑地向前演化。罚函数法被错误地描述为指数 $2$；它实际上是指数 $1$。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}