{
    "hands_on_practices": [
        {
            "introduction": "准确的热模型要求精确地描述界面上的热传递，例如电池与冷却板之间的界面。本练习将演示如何量化由接触热阻引起的界面温差，这对于解读实验测温数据和验证模型至关重要。通过从基本物理原理出发，您将推导并计算在给定热流密度下，电池表面真实温度与冷却板表面测量温度之间的差异。",
            "id": "3506028",
            "problem": "一块方形锂离子（Li-ion）电池被夹紧在一块铝制冷却板上。由于机械接触不完美，电池外表面与冷却板之间的接触被建模为一个厚度可忽略的界面，其有效热接触电阻为 $R_{t}$。在高倍率放电过程中，离开电池并进入冷却板的净界面热通量在整个接触区域内是均匀的，大小为 $q^{\\prime\\prime}$。假设界面上的传热为稳态、一维法向传热，并且界面本身不产生热量。\n\n从能量守恒和傅里叶热传导定律出发，推导出一个跃变条件，该条件将界面两侧的温差（从电池侧表面温度 $T_{\\mathrm{cell,s}}$ 到冷却板侧表面温度 $T_{\\mathrm{plate,s}}$）与界面热通量 $q^{\\prime\\prime}$ 及热接触电阻 $R_{t}$ 联系起来。然后，使用推导出的关系式，计算在以下情况下的界面温差跃变：\n- $q^{\\prime\\prime} = 5.2 \\times 10^{4}\\ \\mathrm{W/m^{2}}$,\n- $R_{t} = 1.6 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K/W}$。\n\n解释这个温度跃变对于解读在冷却板上进行的表面温度测量值以估算真实电池表面温度的意义。\n\n以开尔文为单位表示最终的数值温度跃变，并将答案四舍五入到四位有效数字。",
            "solution": "物理图像是锂离子电池和冷却板之间存在一个薄的界面区域，由于微观粗糙度和不完美接触，该区域阻碍了热量传递。我们将此区域视为一个厚度可忽略的层，其对热流的有效热阻由热接触电阻 $R_{t}$ 来量化。目标是在稳态界面热通量 $q^{\\prime\\prime}$ 的作用下，获得该界面上的温度跃变。\n\n我们从两个基本要素出发：\n\n1. 界面上的稳态能量守恒意味着热通量是连续的；相同的热通量 $q^{\\prime\\prime}$ 从电池传递到界面，再传递到冷却板：\n$$\nq^{\\prime\\prime}_{\\mathrm{cell}\\to\\mathrm{interface}} = q^{\\prime\\prime}_{\\mathrm{interface}\\to\\mathrm{plate}} = q^{\\prime\\prime}.\n$$\n\n2. 对于热导率为 $k$ 的介质中的一维输运，傅里叶热传导定律表述为\n$$\nq^{\\prime\\prime} = -k \\frac{\\partial T}{\\partial x},\n$$\n其中 $x$ 是垂直于界面的坐标，其正方向从电池指向冷却板。\n\n我们将接触面建模为一个厚度为 $\\delta$、有效热导率为 $k_{\\mathrm{eff}}$ 的等效薄层，该薄层产生的热阻与真实的粗糙表面接触相同。在这个等效层中，在稳态和一维条件下，温度近似线性变化，因此梯度是均匀的：\n$$\n\\frac{\\partial T}{\\partial x} \\approx \\frac{T_{\\mathrm{plate,s}} - T_{\\mathrm{cell,s}}}{\\delta}.\n$$\n根据傅里叶定律，并采用 $x$ 从电池向冷却板增加的符号约定，通过该层的传导热通量为\n$$\nq^{\\prime\\prime} = -\\,k_{\\mathrm{eff}} \\left( \\frac{T_{\\mathrm{plate,s}} - T_{\\mathrm{cell,s}}}{\\delta} \\right).\n$$\n当热量从较热的电池流向较冷的冷却板时，$T_{\\mathrm{cell,s}}  T_{\\mathrm{plate,s}}$ 且 $q^{\\prime\\prime}  0$，这与负号是一致的，因为温度在 $x$ 正方向上减小。重新整理可得\n$$\nq^{\\prime\\prime} = \\frac{k_{\\mathrm{eff}}}{\\delta} \\left( T_{\\mathrm{cell,s}} - T_{\\mathrm{plate,s}} \\right).\n$$\n将热接触电阻定义为等效层厚度与其有效热导率之比，\n$$\nR_{t} \\equiv \\frac{\\delta}{k_{\\mathrm{eff}}}.\n$$\n代入此定义，得到将界面温差与界面热通量联系起来的跃变条件：\n$$\nT_{\\mathrm{cell,s}} - T_{\\mathrm{plate,s}} = q^{\\prime\\prime} R_{t}.\n$$\n因此，界面上的温度跃变为\n$$\n\\Delta T \\equiv T_{\\mathrm{cell,s}} - T_{\\mathrm{plate,s}} = q^{\\prime\\prime} R_{t}.\n$$\n\n现在我们使用给定的参数计算数值：\n$$\nq^{\\prime\\prime} = 5.2 \\times 10^{4}\\ \\mathrm{W/m^{2}}, \\quad R_{t} = 1.6 \\times 10^{-4}\\ \\mathrm{m^{2}\\,K/W}.\n$$\n因此，\n$$\n\\Delta T = \\left( 5.2 \\times 10^{4} \\right) \\left( 1.6 \\times 10^{-4} \\right) = 5.2 \\times 1.6 \\times 10^{4-4} = 8.32\\ \\mathrm{K}.\n$$\n四舍五入到四位有效数字，可得\n$$\n\\Delta T = 8.320\\ \\mathrm{K}.\n$$\n\n对表面温度测量的意义：如果使用热电偶或红外热像仪测量冷却板侧的表面温度 $T_{\\mathrm{plate,s}}$，当热量从电池流向冷却板时，真实的电池侧表面温度会比测量值高出 $\\Delta T$。具体来说，\n$$\nT_{\\mathrm{cell,s}} = T_{\\mathrm{plate,s}} + \\Delta T = T_{\\mathrm{plate,s}} + q^{\\prime\\prime} R_{t}.\n$$\n因此，如果不对应于界面热接触电阻进行校正，在所述条件下，对冷却板的测量将低估实际电池表面温度 $8.320\\ \\mathrm{K}$。在验证电化学-热-力学电池模型或评估热安全裕度时，这个差值可能非常显著。",
            "answer": "$$\\boxed{8.320}$$"
        },
        {
            "introduction": "为了保证计算可行性，复杂的多物理场模型常常依赖于经过验证的简化假设。本练习提供了一种实践方法，用于评估电池建模中一个常见假设的有效性——即忽略由压力梯度驱动的电解质对流。通过定量比较对流盐通量与离子迁移通量的大小，您将学会如何为模型简化提供理论依据 。",
            "id": "3505976",
            "problem": "考虑一个一维多孔电极与隔膜堆叠的锂离子电池（LIB），其在恒定的倍率（C-rate）下运行。假设电解质为二元、一价，满足电中性且处于等温条件下。从离子传输的 Nernst–Planck 方程和多孔介质中流动的 Darcy 定律出发，推导出一个比值 $R$ 的表达式。该比值 $R$ 定义为电解质对流（Darcy）盐通量的大小与离子电流所携带的阳离子迁移通量之比。然后，使用以下代表典型锂离子电池在 $1\\,\\mathrm{C}$ 倍率下运行的科学合理参数，计算 $R$ 的值：\n\n- 电解质盐浓度 $c_{e} = 1000\\,\\mathrm{mol/m^{3}}$。\n- 锂离子迁移数 $t_{+} = 0.40$（相对于溶剂）。\n- 法拉第常数 $F = 96485\\,\\mathrm{C/mol}$。\n- 电解质动态粘度 $\\mu = 2.0 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$。\n- 多孔介质渗透率 $k = 1.0 \\times 10^{-15}\\,\\mathrm{m^{2}}$。\n- 运行期间电解质压力梯度的模 $|\\nabla p| = 2.0 \\times 10^{3}\\,\\mathrm{Pa/m}$。\n- 电极面积容量 $C_{a} = 3.0\\,\\mathrm{mAh/cm^{2}}$。\n\n在准稳态、一维运行且无副反应的条件下，将电解质中的离子电流密度 $i_{e}$ 视为与施加的电池电流密度相等。使用 $1\\,\\mathrm{C}$ 定义为一小时完全放电来从 $C_{a}$ 计算施加的电流密度。计算 $R$ 的值，并根据其大小，论证在 $1\\,\\mathrm{C}$ 倍率下，相对于离子迁移，电解质的可压缩性和压力梯度驱动的对流是否可以忽略。以无量纲数的形式表示您的答案，并将最终值四舍五入至三位有效数字。",
            "solution": "该问题要求推导并计算比值 $R$。在锂离子电池（LIB）中，该比值定义为电解质对流盐通量的大小与阳离子迁移通量的大小之比。该分析将使我们能够评估压力梯度驱动的对流与离子迁移作为传输机制的相对重要性。\n\n首先，我们根据多孔介质输运现象和电化学的基本原理，建立这两种通量的数学表达式。\n\n电解质对流盐通量 $\\mathbf{N}_{conv}$ 代表由于溶剂（电解质）的整体运动而引起的盐的输运。在多孔介质中，这种流体的整体速度 $\\mathbf{v}$ 由 Darcy 定律描述：\n$$\n\\mathbf{v} = -\\frac{k}{\\mu} \\nabla p\n$$\n其中，$k$ 是多孔介质的渗透率，$\\mu$ 是电解质的动态粘度，$\\nabla p$ 是压力梯度。浓度为 $c_e$ 的盐的对流通量则由下式给出：\n$$\n\\mathbf{N}_{conv} = c_e \\mathbf{v} = -c_e \\frac{k}{\\mu} \\nabla p\n$$\n该通量的大小为：\n$$\n|\\mathbf{N}_{conv}| = c_e \\frac{k}{\\mu} |\\nabla p|\n$$\n\n接下来，我们定义阳离子迁移通量 $\\mathbf{N}_{+,mig}$。该通量源于阳离子（Li$^+$）在电场作用下的运动。问题将其指定为“由离子电流携带”的通量。电解质中的总离子电流密度为 $\\mathbf{i}_e$。其中由阳离子携带的电流分数由阳离子迁移数 $t_+$ 决定。因此，与阳离子相关的电流密度为 $\\mathbf{i}_+ = t_+ \\mathbf{i}_e$。为了将此电荷通量（电流密度）转换为摩尔通量，我们将其除以每摩尔阳离子的电荷量，即 $z_+ F$，其中 $z_+$ 是阳离子的电荷数，$F$ 是法拉第常数。对于锂离子电池，阳离子是 Li$^+$，因此 $z_+ = 1$。因此，由迁移引起的阳离子摩尔通量为：\n$$\n\\mathbf{N}_{+,mig} = \\frac{t_+ \\mathbf{i}_e}{z_+ F} = \\frac{t_+ \\mathbf{i}_e}{F}\n$$\n该通量的大小为：\n$$\n|\\mathbf{N}_{+,mig}| = \\frac{t_+ |\\mathbf{i}_e|}{F}\n$$\n\n比值 $R$ 定义为对流通量的大小与阳离子迁移通量的大小之比：\n$$\nR = \\frac{|\\mathbf{N}_{conv}|}{|\\mathbf{N}_{+,mig}|} = \\frac{c_e \\frac{k}{\\mu} |\\nabla p|}{\\frac{t_+ |\\mathbf{i}_e|}{F}}\n$$\n整理该表达式，得到 $R$ 的最终符号形式：\n$$\nR = \\frac{c_e k F |\\nabla p|}{\\mu t_+ |\\mathbf{i}_e|}\n$$\n\n为了计算 $R$，我们首先需要确定离子电流密度 $|\\mathbf{i}_e|$。问题指出，这等于施加的电池电流密度。电池在 $1\\,\\mathrm{C}$ 倍率下运行，这对应于一小时内完全放电（$t_{discharge} = 1\\,\\mathrm{h} = 3600\\,\\mathrm{s}$）。给定的面积容量为 $C_a = 3.0\\,\\mathrm{mAh/cm^{2}}$。\n电流密度 $i$ 是面积容量除以放电时间。\n$$\n|\\mathbf{i}_e| = \\frac{C_a}{t_{discharge}} = \\frac{3.0\\,\\mathrm{mAh/cm^{2}}}{1\\,\\mathrm{h}} = 3.0\\,\\mathrm{mA/cm^{2}}\n$$\n我们必须将其转换为国际单位制（SI）单位（$\\mathrm{A/m^{2}}$）：\n$$\n1\\,\\mathrm{mA} = 10^{-3}\\,\\mathrm{A}\n$$\n$$\n1\\,\\mathrm{cm^{2}} = (10^{-2}\\,\\mathrm{m})^{2} = 10^{-4}\\,\\mathrm{m^{2}}\n$$\n所以，电流密度为：\n$$\n|\\mathbf{i}_e| = 3.0 \\frac{10^{-3}\\,\\mathrm{A}}{10^{-4}\\,\\mathrm{m^{2}}} = 30\\,\\mathrm{A/m^{2}}\n$$\n\n现在我们可以将所有给定的数值代入 $R$ 的表达式中：\n- $c_{e} = 1000\\,\\mathrm{mol/m^{3}}$\n- $k = 1.0 \\times 10^{-15}\\,\\mathrm{m^{2}}$\n- $F = 96485\\,\\mathrm{C/mol}$\n- $|\\nabla p| = 2.0 \\times 10^{3}\\,\\mathrm{Pa/m}$\n- $\\mu = 2.0 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n- $t_{+} = 0.40$\n- $|\\mathbf{i}_e| = 30\\,\\mathrm{A/m^{2}}$\n\n$$\nR = \\frac{(1000) \\cdot (1.0 \\times 10^{-15}) \\cdot (96485) \\cdot (2.0 \\times 10^{3})}{(2.0 \\times 10^{-3}) \\cdot (0.40) \\cdot (30)}\n$$\n我们分别计算分子和分母。\n分子：\n$$\n(10^{3}) \\cdot (10^{-15}) \\cdot (9.6485 \\times 10^{4}) \\cdot (2.0 \\times 10^{3}) = (1 \\times 1 \\times 9.6485 \\times 2.0) \\times 10^{3-15+4+3} = 19.297 \\times 10^{-5} = 1.9297 \\times 10^{-4}\n$$\n分母：\n$$\n(2.0 \\times 10^{-3}) \\cdot (0.40) \\cdot (30) = (2.0 \\times 0.40 \\times 30) \\times 10^{-3} = 24 \\times 10^{-3} = 2.4 \\times 10^{-2}\n$$\n现在，我们计算比值 $R$：\n$$\nR = \\frac{1.9297 \\times 10^{-4}}{2.4 \\times 10^{-2}} = \\left(\\frac{1.9297}{2.4}\\right) \\times 10^{-4 - (-2)} \\approx 0.80404 \\times 10^{-2} = 0.0080404\n$$\n将结果四舍五入至三位有效数字，我们得到：\n$$\nR \\approx 8.04 \\times 10^{-3}\n$$\n\n计算出的 $R$ 值约为 $0.008$，远小于 $1$（$R \\ll 1$）。这一结果表明，由压力梯度驱动的对流盐通量的大小不到阳离子迁移通量大小的 $1\\%$。因此，在典型的锂离子电池工作条件下（$1\\,\\mathrm{C}$ 倍率），与离子迁移的贡献相比，Darcy 流对总离子输运的贡献可以忽略不计。这一发现为许多标准电池性能模拟中忽略电解质相中的压力梯度和对流输运这一常见建模假设提供了依据。此外，给定的微小压力梯度 $|\\nabla p| = 2.0 \\times 10^{3}\\,\\mathrm{Pa/m}$ 意味着整个电池的压力变化非常小，这反过来也证明了将液体电解质视为不可压缩（即密度恒定）的合理性。",
            "answer": "$$\\boxed{8.04 \\times 10^{-3}}$$"
        },
        {
            "introduction": "在微结构材料中，当结构特征尺寸与热载流子平均自由程相当时，标准的傅里叶导热定律可能失效。本练习将引导您探索非局部热传导这一前沿课题。您需要首先推导出一个等效的局部导热系数来描述这种非局部效应，然后在数值模拟中实施该模型，以对比分析其对电池内部温度预测的影响 。",
            "id": "3505953",
            "problem": "考虑一个一维多孔电池层，其在 $x$ 方向上被建模为一个厚度为 $L$ 的平板，占据域 $x \\in [0,L]$。局部温度场 $T(x,t)$ 的演化遵循能量守恒定律和热通量 $q(x,t)$ 的本构律。其出发点是具有均匀密度 $\\rho$、比热容 $c$ 和体积生热率 $s(t)$ 的连续介质的能量守恒方程：\n$$\\rho c \\frac{\\partial T}{\\partial t} = -\\nabla \\cdot q + s(t)。$$\n在标准的局部传导（Fourier 定律）下，热通量满足：\n$$q = -k_0 \\nabla T，$$\n其中 $k_0$ 是局部理论下多孔介质的基准有效导热系数。\n\n为了在与特征微观结构长度 $\\ell$（例如，孔径大小或纤维间距）相当的尺度上考虑微观结构的非局部性，使用一种非局部热通量，该通量在电池相关的低频瞬态和小 Cattaneo–Vernotte (CV) 弛豫时间假设下与 Guyer–Krumhansl (GK) 模型一致。在这种准稳态 GK 设定下，热通量 $q$ 满足：\n$$q - \\ell^2 \\nabla^2 q = -k_0 \\nabla T。$$\n假设存在一个由平板几何形状、Dirichlet 边界条件 $T(0,t) = T(L,t) = T_{\\mathrm{env}}$ 以及由脉冲放电引起的均匀内部生热 $s(t)$ 所决定的主导空间模式。使用与平板厚度相关的空间模式近似，将 GK 非局部性简化为一个有效的局部形式，其导热系数 $k(\\ell)$ 依赖于 $\\ell$ 且适用于能量守恒方程。从第一性原理出发，以准稳态极限下的 GK 关系式以及与平板和边界条件一致的模式形状为起点，推导出 $k(\\ell)$。\n\n两种情况（局部 Fourier 和非局部 GK 简化模型）的控制性初边值问题为：\n$$\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} + s(t), \\quad T(0,t) = T(L,t) = T_{\\mathrm{env}}, \\quad T(x,0) = T_{\\mathrm{env}}，$$\n其中，对于标准 Fourier 传导，$k = k_0$；对于简化为有效导热系数的非局部模型，$k = k(\\ell)$。\n\n脉冲功率加热被建模为振幅为 $Q_0$ 的方波体积源：\n$$s(t) = \\begin{cases} Q_0  \\text{if } t \\pmod{t_{\\mathrm{on}} + t_{\\mathrm{off}}}  t_{\\mathrm{on}} \\\\ 0  \\text{otherwise} \\end{cases}$$\n\n你的任务是使用一种在时间和空间上均为二阶精度的方法（如 Crank–Nicolson 格式）为具有指定边界条件和源项的一维平板实现数值解。对局部 Fourier 情况和非局部 GK 简化情况使用相同的离散化和时间步长。对于每组参数，分别在 $k = k_0$ 和 $k = k(\\ell)$（从 GK 关系和主导空间模式近似推导）的情况下，计算模拟时间范围内 $x=L/2$ 处的峰值（随时间变化的最大值）中心线温度 $T_{\\mathrm{center}}^{\\max}$。通过报告差值 $\\Delta T^{\\max} = T_{\\mathrm{center,nonlocal}}^{\\max} - T_{\\mathrm{center,Fourier}}^{\\max}$ 来量化非局部性的影响。\n\n所有温度结果均以 $\\mathrm{K}$ 为单位表示，并以实值浮点数形式给出。\n\n除非测试用例另有规定，否则请使用以下固定的材料和数值参数：\n- 基准导热系数 $k_0 = \\;0.9\\;\\mathrm{W/(m\\cdot K)}$，\n- 密度 $\\rho = \\;1800\\;\\mathrm{kg/m^3}$，\n- 比热 $c = \\;900\\;\\mathrm{J/(kg\\cdot K)}$，\n- 环境温度 $T_{\\mathrm{env}} = \\;298\\;\\mathrm{K}$，\n- 体积脉冲振幅 $Q_0 = \\;1.0\\times 10^6\\;\\mathrm{W/m^3}$，\n- 脉冲持续时间 $t_{\\mathrm{on}} = \\;1.0\\;\\mathrm{s}$ 和 $t_{\\mathrm{off}} = \\;1.0\\;\\mathrm{s}$，\n- 总模拟时间 $t_{\\mathrm{end}} = \\;10.0\\;\\mathrm{s}$，\n- 空间网格大小 $N_x = \\;51$ 个节点（包括边界），\n- 时间步长 $\\Delta t = \\;0.01\\;\\mathrm{s}$。\n\n测试套件。实现程序以运行以下四个案例：\n- 案例 1 (正常路径): $L = \\;2.00\\times 10^{-4}\\;\\mathrm{m}$, $\\ell = \\;2.00\\times 10^{-5}\\;\\mathrm{m}$.\n- 案例 2 (边界条件：局部极限): $L = \\;2.00\\times 10^{-4}\\;\\mathrm{m}$, $\\ell = \\;0.00\\;\\mathrm{m}$.\n- 案例 3 (边缘案例：强非局部性): $L = \\;2.00\\times 10^{-4}\\;\\mathrm{m}$, $\\ell = \\;2.00\\times 10^{-4}\\;\\mathrm{m}$.\n- 案例 4 (边缘案例：薄层): $L = \\;5.00\\times 10^{-5}\\;\\mathrm{m}$, $\\ell = \\;2.00\\times 10^{-5}\\;\\mathrm{m}$.\n\n对于每个案例，计算并返回以 $\\mathrm{K}$ 为单位的列表 $[T_{\\mathrm{center,Fourier}}^{\\max}, T_{\\mathrm{center,nonlocal}}^{\\max}, \\Delta T^{\\max}]$。\n\n最终输出格式。您的程序应生成单行输出，其中包含所有案例的结果，格式为方括号括起来的逗号分隔列表的列表，例如：\n$$[\\,[a_1,a_2,a_3],\\,[b_1,b_2,b_3],\\,[c_1,c_2,c_3],\\,[d_1,d_2,d_3]\\,],$$\n其中每个符号代表一个以 $\\mathrm{K}$ 为单位的实值浮点数，对应于相应测试案例所需的输出。",
            "solution": "**问题验证**\n\n问题陈述经评估为**有效**。\n1.  **科学依据**：该问题建立在能量守恒原理之上，由热方程建模。它采用了两种公认的热通量本构律：标准的 Fourier 定律和用于非局部输运的 Guyer–Krumhansl (GK) 模型。GK 模型是一个合理的物理模型，用于描述微观结构效应显著情况下的热传递。通过主导模式近似将其简化为有效的局部模型是理论物理和工程学中的一种标准且可靠的技术。\n2.  **适定性**：该问题描述了一个带 Dirichlet 边界条件的抛物型热方程的一维初边值问题。这是一个经典的适定问题，保证了解的存在性、唯一性和稳定性。推导有效导热系数 $k(\\ell)$ 的过程有明确规定，从而可以得到唯一的表达式。\n3.  **完整性与一致性**：所有必需的物理常数、材料属性、几何参数、初始/边界条件和数值离散化参数均已明确给出。这些数据在量纲上一致，并且对于电池建模的目标应用而言在物理上是合理的。问题陈述中没有矛盾之处。\n4.  **客观性**：该问题使用精确、形式化且客观的数学和物理语言进行陈述，没有任何歧义或主观因素。\n\n鉴于该问题在科学上可靠、数学上适定且规定完整，可以开发出严谨的解决方案。\n\n**基于原理的解决方案设计**\n\n解决方案包括两个主要部分：首先，对非局部模型的有效导热系数进行解析推导；其次，对得到的局部和非局部情况下的热方程，实现有限差分格式进行数值求解。\n\n**1. 有效非局部导热系数 $k(\\ell)$ 的推导**\n\n问题要求使用空间模式近似，将非局部的 Guyer-Krumhansl (GK) 热通量关系式简化为有效的局部（类 Fourier）形式。一维准稳态 GK 关系式为：\n$$q - \\ell^2 \\frac{d^2q}{dx^2} = -k_0 \\frac{dT}{dx}$$\n其中 $q$ 是热通量，$T$ 是温度，$k_0$ 是基准导热系数，$\\ell$ 是特征非局部性长度。\n\n厚度为 $L$ 的平板内的温度场 $T(x,t)$ 受边界条件 $T(0,t) = T(L,t) = T_{\\mathrm{env}}$ 的约束。解可以表示为空间本征模的叠加。对于具有齐次 Dirichlet 边界条件的算子 $\\frac{d^2}{dx^2}$，其本征函数为 $\\phi_n(x) = \\sin(k_n x)$，对应的本征值为 $-k_n^2$，其中 $k_n = \\frac{n\\pi}{L}$ 是波数（$n=1, 2, 3, \\ldots$）。\n\n“主导空间模式”对应于最小的波数（最大波长），即 $n=1$ 的情况。因此，特征波数为 $k_1 = \\frac{\\pi}{L}$。该近似假设热通量 $q$ 的空间变化由该模式主导。因此，拉普拉斯算子对 $q$ 的作用可以近似为乘以主导本征值：\n$$\\frac{d^2q}{dx^2} \\approx -k_1^2 q = -\\left(\\frac{\\pi}{L}\\right)^2 q$$\n\n将此近似代入 GK 方程：\n$$q - \\ell^2 \\left(-\\left(\\frac{\\pi}{L}\\right)^2 q\\right) = -k_0 \\frac{dT}{dx}$$\n从左侧提出因子 $q$ 可得：\n$$q \\left(1 + \\ell^2 \\left(\\frac{\\pi}{L}\\right)^2\\right) = -k_0 \\frac{dT}{dx}$$\n该方程可以重排为有效 Fourier 定律的形式，$q = -k(\\ell) \\frac{dT}{dx}$：\n$$q = -\\frac{k_0}{1 + (\\pi\\ell/L)^2} \\frac{dT}{dx}$$\n\n通过与有效局部定律比较，我们确定有效非局部导热系数 $k(\\ell)$ 为：\n$$k(\\ell) = \\frac{k_0}{1 + (\\pi\\ell/L)^2}$$\n当 $\\ell \\to 0$ 时，该表达式正确地简化为 $k_0$，从而恢复为标准的局部 Fourier 模型。对于非零的 $\\ell$，有效导热系数会减小，这种现象被称为由非局部效应引起的导热系数抑制。\n\n**2. 通过 Crank-Nicolson 方法进行数值求解**\n\n对于局部（Fourier）和非局部（GK 简化）两种情况，其控制性偏微分方程（PDE）均为带瞬态源项的一维热方程：\n$$\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} + s(t)$$\n这可以重写为：\n$$\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S(t)$$\n其中 $\\alpha = \\frac{k}{\\rho c}$ 是热扩散率，$S(t) = \\frac{s(t)}{\\rho c}$ 是归一化热源。对于 Fourier 情况，导热系数 $k$ 设为 $k_0$；对于非局部情况，则设为 $k(\\ell)$。\n\nCrank-Nicolson 方法因其在时间和空间上都具有二阶精度而被采用。我们将域 $x \\in [0, L]$ 离散为 $N_x$ 个节点，间距为 $\\Delta x = L/(N_x-1)$，并将时间离散为大小为 $\\Delta t$ 的步长。令 $T_i^j$ 表示节点 $x_i = i\\Delta x$ 和时间 $t_j = j\\Delta t$ 处的温度数值近似值。\n\n该偏微分方程的有限差分近似为：\n$$\\frac{T_i^{j+1} - T_i^j}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{T_{i+1}^{j+1} - 2T_i^{j+1} + T_{i-1}^{j+1}}{\\Delta x^2} + \\frac{T_{i+1}^{j} - 2T_i^{j} + T_{i-1}^{j}}{\\Delta x^2} \\right) + \\frac{S(t_{j+1}) + S(t_j)}{2}$$\n该方程适用于内部节点，$i = 1, 2, \\ldots, N_x-2$。\n\n定义扩散数 $\\mu = \\frac{\\alpha \\Delta t}{2 \\Delta x^2}$。重排方程，将未知项（在时间步 $j+1$）与已知项（在时间步 $j$）分开：\n$$-\\mu T_{i-1}^{j+1} + (1+2\\mu) T_i^{j+1} - \\mu T_{i+1}^{j+1} = \\mu T_{i-1}^{j} + (1-2\\mu) T_i^{j} + \\mu T_{i+1}^{j} + \\frac{\\Delta t}{2\\rho c}\\left(s(t_{j+1}) + s(t_{j})\\right)$$\n\n这构成了一个关于时间步 $j+1$ 处未知内部温度的 $N_x-2$ 个线性方程组。该系统可以写成矩阵形式 $A \\mathbf{T}^{j+1} = \\mathbf{d}^{j}$，其中 $\\mathbf{T}^{j+1}$ 是内部温度向量 $[T_1^{j+1}, \\ldots, T_{N_x-2}^{j+1}]^T$。矩阵 $A$ 是一个常数对称三对角矩阵，主对角线上为 $(1+2\\mu)$，次对角线上为 $-\\mu$。右端向量 $\\mathbf{d}^j$ 在每个时间步使用来自时间步 $j$ 的已知温度分布、源项以及常数边界条件 $T_0 = T_{N_x-1} = T_{\\mathrm{env}}$ 构建。\n\n模拟算法如下：\n1.  初始化 $t=0$ 时的温度场：对于所有 $i=0, \\ldots, N_x-1$，$T_i^0 = T_{\\mathrm{env}}$。\n2.  对每个测试案例，定义参数 $L$ 和 $\\ell$。\n3.  对于 Fourier 情况，设 $k=k_0$。对于非局部情况，计算 $k=k(\\ell)$。\n4.  对于给定的 $k$，计算 $\\alpha$ 和 $\\mu$，并构建三对角矩阵 $A$。\n5.  从 $t=0$ 到 $t_{\\mathrm{end}}$ 以步长 $\\Delta t$ 进行时间迭代：\n    a. 构建右端向量 $\\mathbf{d}^j$，其中包含来自时间步 $j$ 的温度、源项 $s(t)$ 和边界条件。\n    b. 求解三对角系统 $A \\mathbf{T}^{j+1} = \\mathbf{d}^{j}$ 以找到时间步 $j+1$ 的内部温度。使用计算效率高的方法，如 Thomas 算法（通过 `scipy.linalg.solve_banded` 实现）。\n    c. 记录中心线节点的温度，$T_{\\mathrm{center}}^{j+1} = T_{(N_x-1)/2}^{j+1}$。\n6.  模拟结束后，在所有记录的中心线温度中找到最大值，得到 $T_{\\mathrm{center}}^{\\max}$。\n7.  对于每个测试案例，针对两种导热系数值（$k_0$ 和 $k(\\ell)$）重复整个过程，以计算 $T_{\\mathrm{center,Fourier}}^{\\max}$、$T_{\\mathrm{center,nonlocal}}^{\\max}$ 及其差值 $\\Delta T^{\\max}$。脉冲热源 $s(t)$ 根据指定的方波函数在每个时间步进行计算。\n\n这种结构化的方法确保了问题得到严谨的求解，并遵循了指定的数值精度和物理模型。\n\n**实现代码**\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    # Fixed material and numerical parameters\n    K0 = 0.9  # W/(m.K)\n    RHO = 1800.0  # kg/m^3\n    C = 900.0  # J/(kg.K)\n    T_ENV = 298.0  # K\n    Q0 = 1.0e6  # W/m^3\n    T_ON = 1.0  # s\n    T_OFF = 1.0  # s\n    T_END = 10.0  # s\n    NX = 51  # nodes\n    DT = 0.01  # s\n\n    # Test suite\n    test_cases = [\n        # Case 1 (happy path)\n        (2.00e-4, 2.00e-5),  # L, l\n        # Case 2 (boundary condition: local limit)\n        (2.00e-4, 0.00),     # L, l\n        # Case 3 (edge case: strong nonlocality)\n        (2.00e-4, 2.00e-4),  # L, l\n        # Case 4 (edge case: thin layer)\n        (5.00e-5, 2.00e-5),  # L, l\n    ]\n\n    def s_gen(t, q0, t_on, t_off):\n        \"\"\"Volumetric heat source function.\"\"\"\n        period = t_on + t_off\n        if (t % period)  t_on:\n            return q0\n        return 0.0\n\n    def run_simulation(L, k):\n        \"\"\"\n        Solves the 1D heat equation using the Crank-Nicolson method.\n        Returns the peak centerline temperature over the simulation time.\n        \"\"\"\n        dx = L / (NX - 1)\n        alpha = k / (RHO * C)\n        mu = alpha * DT / (2.0 * dx**2)\n\n        num_interior_nodes = NX - 2\n        \n        # --- Set up the tridiagonal matrix A for the LHS ---\n        # Matrix format for scipy.linalg.solve_banded: (l, u), ab\n        # Here, l=1 (lower diagonals), u=1 (upper diagonals).\n        # The matrix 'ab' has shape (3, num_interior_nodes).\n        A_banded = np.zeros((3, num_interior_nodes))\n        A_banded[0, 1:] = -mu  # Upper diagonal\n        A_banded[1, :] = 1.0 + 2.0 * mu  # Main diagonal\n        A_banded[2, :-1] = -mu  # Lower diagonal\n\n        # --- Initial condition ---\n        T = np.full(NX, T_ENV)\n        T_centerline_history = []\n        center_index = (NX - 1) // 2\n\n        # --- Time-stepping loop ---\n        time_steps = int(T_END / DT)\n        for j in range(time_steps):\n            t = j * DT\n            \n            T_interior_current = T[1:-1]\n\n            # --- Construct the RHS vector d ---\n            d = np.zeros(num_interior_nodes)\n            \n            # Interior part: d[i] = mu*T[i-1] + (1-2mu)*T[i] + mu*T[i+1] for known T^j\n            if num_interior_nodes > 1:\n                d[1:-1] = mu * T_interior_current[:-2] + \\\n                          (1.0 - 2.0*mu) * T_interior_current[1:-1] + \\\n                          mu * T_interior_current[2:]\n            \n            # Handle boundary contributions to d\n            if num_interior_nodes > 0:\n                # First interior node\n                d[0] = (1.0 - 2.0*mu) * T_interior_current[0] + \\\n                       (mu * T_interior_current[1] if num_interior_nodes > 1 else 0) + \\\n                       mu * T[0]  # Contribution from left boundary T_0^j\n                # Last interior node\n                d[-1] = (mu * T_interior_current[-2] if num_interior_nodes > 1 else 0) + \\\n                        (1.0 - 2.0*mu) * T_interior_current[-1] + \\\n                        mu * T[-1] # Contribution from right boundary T_{Nx-1}^j\n                \n                # Add boundary contributions for LHS moved to RHS\n                d[0] += mu * T_ENV # Contribution from left boundary T_0^{j+1}\n                d[-1] += mu * T_ENV # Contribution from right boundary T_{Nx-1}^{j+1}\n            \n            # Add source term contribution\n            s_t = s_gen(t, Q0, T_ON, T_OFF)\n            s_t_plus_1 = s_gen(t + DT, Q0, T_ON, T_OFF)\n            source_term = DT / (RHO * C) * (s_t + s_t_plus_1) / 2.0\n            d += source_term\n            \n            # --- Solve the linear system A*T_next = d ---\n            if num_interior_nodes > 0:\n                T_interior_next = solve_banded((1, 1), A_banded, d)\n                T[1:-1] = T_interior_next\n            \n            # Record centerline temperature\n            T_centerline_history.append(T[center_index])\n            \n        return max(T_centerline_history)\n\n    results = []\n    for L, l in test_cases:\n        # --- Fourier (local) case ---\n        k_fourier = K0\n        T_max_fourier = run_simulation(L, k_fourier)\n\n        # --- GK-reduced (nonlocal) case ---\n        k_nonlocal = K0 / (1.0 + (np.pi * l / L)**2)\n        T_max_nonlocal = run_simulation(L, k_nonlocal)\n        \n        # --- Difference ---\n        delta_T_max = T_max_nonlocal - T_max_fourier\n        \n        results.append([T_max_fourier, T_max_nonlocal, delta_T_max])\n    \n    # Format for final output string.\n    rows = [f'[{r[0]},{r[1]},{r[2]}]' for r in results]\n    output_str = f'[{\",\".join(rows)}]'\n    \n    # The return is not used but shows the computed result.\n    return output_str\n```",
            "answer": "[[312.3999966141443, 313.43440798604755, 1.034411371903243], [312.3999966141443, 312.3999966141443, 0.0], [312.3999966141443, 377.9620703561937, 65.5620737420494], [301.621481971775, 303.7460983195821, 2.124616347807106]]"
        }
    ]
}