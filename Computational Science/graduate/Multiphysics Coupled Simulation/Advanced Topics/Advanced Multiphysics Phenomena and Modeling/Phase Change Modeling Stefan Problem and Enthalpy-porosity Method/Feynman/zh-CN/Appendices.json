{
    "hands_on_practices": [
        {
            "introduction": "要精确地为相变建模，我们必须从其核心的物理原理开始。第一个动手实践将带您回顾锐利界面模型的基础知识，通过推导和应用斯特凡（Stefan）边界条件，您将对控制相变界面移动的能量平衡建立坚实的理解。这个条件是所有更复杂的数值模型试图捕捉的核心物理现象，它直接关联了界面两侧的热流与界面的运动速度。",
            "id": "3521105",
            "problem": "一个经历一维熔化或凝固的纯物质，其固液界面被建模为一个清晰的平面。设单位法向量 $\\boldsymbol{n}$ 从固相指向液相。假设傅里叶热传导在两相中均适用，并忽略体积热源和动力学过冷。在界面处，固相和液相均处于相变温度。该物质的密度为 $\\rho$，单位质量的熔化潜热为 $L$。在固相侧，定义标量法向热通量 $q_s$ 为正，当热量从固相流向界面时（即与 $\\boldsymbol{n}$ 方向相反，流入界面）。在液相侧，定义标量法向热通量 $q_l$ 为正，当热量从界面流入液相时（即沿着 $\\boldsymbol{n}$ 方向，离开界面）。\n\n从局部能量守恒的陈述出发，考虑界面周围一个无限薄的扁平盒状控制体，推导法向界面速度 $V_n$ 关于 $q_s$、$q_l$、$\\rho$ 和 $L$ 的表达式。然后，对于一个水-冰系统，其参数为 $\\rho = 1000$ kg/m$^3$ 和 $L = 3.34 \\times 10^{5}$ J/kg，假设在稳态条件下，界面诊断报告 $q_s = 1.40 \\times 10^{5}$ W/m$^2$ 和 $q_l = 2.00 \\times 10^{4}$ W/m$^2$。计算 $V_n$ 的值，并在给定法向方向的背景下，解释其符号在熔化与凝固方面的意义。\n\n以米/秒为单位表示最终速度，并将答案四舍五入到四位有效数字。将所要求的文字解释与数值结果分开提供。",
            "solution": "该问题要求推导界面运动的斯特凡条件，并将其应用于一个特定的水-冰系统。验证过程确认了该问题在科学上是合理的、自洽的且提法恰当的。关于热通量定义的括号内短语中的模糊之处，可以通过遵循其主要定义和能量守恒原则来解决。\n\n推导始于考虑清晰的固液界面处的局部能量守恒陈述。我们分析一个面积为 $A$ 的无限薄控制体（一个“扁平盒”），它包围着一部分界面并随之移动。界面的法向速度为 $V_n$，当其沿着单位法向量 $\\boldsymbol{n}$（从固相指向液相）的方向移动时，取值为正。\n\n对于这个开放控制体，在没有体积热源且动能和势能变化可忽略的情况下，热力学第一定律指出，界面吸收能量的速率必须等于传入其中的净热传导速率。\n\n能量吸收的速率是由于相变引起的。当界面在时间 $dt$ 内移动了距离 $V_n dt$ 时，体积为 $A V_n dt$ 的固相被转化为液相。转化的质量为 $(\\rho A V_n dt)$，其中 $\\rho$ 是物质的密度（为简化起见，假设其在相变过程中保持不变，这在该模型中是标准做法）。此相变所需的能量是单位质量的熔化潜热 $L$。因此，界面吸收能量的速率是 $(\\rho A V_n) L$。单位面积的速率是 $\\rho L V_n$。\n\n传入界面的净热传导速率是，从固相侧流入的热量与流入液相侧的热量之差。问题对相关的标量热通量定义如下：\n1.  $q_s$：法向热通量，当热量*从固相流向界面*时为正。这代表从固相输入到界面的热量。从固相的总热量输入速率为 $q_s A$。\n2.  $q_l$：法向热通量，当热量*从界面流入液相*时为正。这代表从界面到液相的热量损失。到液相的总热量损失速率为 $q_l A$。\n\n因此，单位面积上流入界面的净热通量是流入和流出通量之差：$q_s - q_l$。\n\n将单位面积的能量吸收速率与单位面积的净热通量相等，得到界面处的能量平衡：\n$$\n\\rho L V_n = q_s - q_l\n$$\n这个方程被称为斯特凡条件。求解法向界面速度 $V_n$，我们得到所需的表达式：\n$$\nV_n = \\frac{q_s - q_l}{\\rho L}\n$$\n\n接下来，我们为指定的水-冰系统计算 $V_n$ 的值。给定参数如下：\n密度，$\\rho = 1000$ kg/m$^3$\n熔化潜热，$L = 3.34 \\times 10^{5}$ J/kg\n来自固相的热通量，$q_s = 1.40 \\times 10^{5}$ W/m$^2$\n流入液相的热通量，$q_l = 2.00 \\times 10^{4}$ W/m$^2$\n\n首先，我们计算界面处的净热通量，$q_s - q_l$：\n$$\nq_s - q_l = (1.40 \\times 10^{5} \\text{ W/m}^2) - (2.00 \\times 10^{4} \\text{ W/m}^2) = 1.20 \\times 10^{5} \\text{ W/m}^2\n$$\n正值结果表明有净能量流入界面。\n\n接下来，我们计算体积潜热，$\\rho L$：\n$$\n\\rho L = (1000 \\text{ kg/m}^3) \\times (3.34 \\times 10^{5} \\text{ J/kg}) = 3.34 \\times 10^{8} \\text{ J/m}^3\n$$\n\n现在，我们可以使用推导出的公式计算 $V_n$。注意到 $1 \\text{ W} = 1 \\text{ J/s}$，单位是一致的：$(\\text{J/s} \\cdot \\text{m}^{-2}) / (\\text{J} \\cdot \\text{m}^{-3}) = \\text{m/s}$。\n$$\nV_n = \\frac{1.20 \\times 10^{5} \\text{ J/(s}\\cdot\\text{m}^2)}{3.34 \\times 10^{8} \\text{ J/m}^3} \\approx 3.59281 \\times 10^{-4} \\text{ m/s}\n$$\n按照要求将结果四舍五入到四位有效数字：\n$$\nV_n \\approx 3.593 \\times 10^{-4} \\text{ m/s}\n$$\n\n最后，我们解释结果的符号。计算出的速度 $V_n$ 是正值。根据定义，单位法向量 $\\boldsymbol{n}$ 从固相指向液相。由于界面速度向量为 $\\boldsymbol{V} = V_n \\boldsymbol{n}$，一个正的 $V_n$ 表示界面正在沿着 $\\boldsymbol{n}$ 的方向移动。这意味着界面正在向固相占据的区域推进，将其转化为液相。因此，$V_n$ 的正号对应于**熔化**过程。负号则表示凝固（结冰）。这一物理释义与热通量是一致的：供应到界面的热量（$q_s$）大于从界面移走的热量（$q_l$），导致净能量增益，从而驱动吸热的熔化过程。",
            "answer": "$$\\boxed{3.593 \\times 10^{-4}}$$"
        },
        {
            "introduction": "尽管锐利界面模型在物理上很直观，但在处理复杂几何形状时，像焓-孔隙度法这样的固定网格方法通常更为实用。本实践要求您实现一个基于焓法的数值求解器，并对照经典的解析解进行验证，从而直接比较锐利界面和弥散界面两种方法的优劣。通过这个编码练习，您将掌握如何将相变潜热“平滑”地融入到能量方程中，并评估这种近似对解的准确性的影响。",
            "id": "3521150",
            "problem": "考虑在一个半无限介质中的一维熔化过程，其中没有流体流动且热物理性质为常数。其控制能量守恒定律指出，导热通量的散度等于显热和潜热的变化率。设密度为 $\\rho$，比热容为 $c_p$，热导率为 $k$，熔化潜热为 $L$。设熔化温度为 $T_m$。焓定义为 $h(T) = c_p (T - T_{\\mathrm{ref}}) + L f_\\ell(T)$，其中 $f_\\ell(T)$ 是液相分数，满足 $0 \\le f_\\ell \\le 1$。\n\n您将实现两种方法来确定在固定的最终时刻熔化前沿的位置。\n\n1) 一种基于经典 Stefan 公式的参考移动界面方法，该方法具有一个满足从能量守恒推导出的跳跃条件的等温界面。考虑一个初始为等温的固体，其温度在所有 $x \\ge 0$ 处为 $T(x,0) = T_m$，边界温度在 $t \\ge 0$ 时突然升高至 $T(0,t) = T_b$，其中 $T_b > T_m$。在性质恒定且无对流的情况下，经典的相似解给出的界面位置为 $s(t) = 2 \\lambda \\sqrt{\\alpha t}$（对于 $t > 0$），其中 $\\alpha = k/(\\rho c_p)$ 是热扩散系数，参数 $\\lambda$ 满足以下超越方程\n$$\n\\sqrt{\\pi}\\, \\lambda \\, e^{\\lambda^2} \\, \\mathrm{erf}(\\lambda) = \\mathrm{Ste},\n$$\n其中 $\\mathrm{Ste} = \\dfrac{c_p (T_b - T_m)}{L}$ 是 Stefan 数。此处 $\\mathrm{erf}(\\cdot)$ 表示误差函数。该解代表了具有等温界面和相应跳跃条件的移动网格解。\n\n2) 一种焓-孔隙度方法，其中等温相变约束通过类似相场的罚函数强制施加。在一维无流体流动的情况下，这简化为一种带有表观热容的焓法，并增加一个罚源项，该源项在糊状区内将温度松弛至 $T_m$。使用表观热容\n$$\nc_{\\mathrm{app}}(T) = c_p + \\frac{L}{\\Delta T} \\, \\chi_{\\mathrm{m}}(T),\n$$\n其中 $\\Delta T$ 是一个小的平滑宽度，当 $|T - T_m|  \\Delta T/2$ 时 $\\chi_{\\mathrm{m}}(T)$ 为 $1$，否则为 $0$。通过以下方程演化温度\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho \\, c_{\\mathrm{app}}(T)} \\frac{\\partial^2 T}{\\partial x^2} - \\beta \\, (T - T_m) \\, \\chi_{\\mathrm{m}}(T),\n$$\n其中 $\\beta \\ge 0$ 是一个罚系数，单位为时间的倒数。罚项仅在糊状区起作用，并在该区域强制执行等温约束 $T \\approx T_m$。初始条件为，在所有 $x \\in [0,L_x]$ 处，$T(x,0) = T_m$。边界条件为 $T(0,t) = T_b$ 以及在 $x = L_x$ 处热通量为零。\n\n您的任务是编写一个程序，该程序：\n\n- 使用物理上合理的常数：密度 $\\rho = 1000\\,\\mathrm{kg/m^3}$，比热容 $c_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$，热导率 $k = 0.6\\,\\mathrm{W/(m\\cdot K)}$，潜热 $L = 3.34\\times 10^5\\,\\mathrm{J/kg}$，熔化温度 $T_m = 0\\,^{\\circ}\\mathrm{C}$，边界温度 $T_b = 10\\,^{\\circ}\\mathrm{C}$。\n- 计算域长度 $L_x = 0.05\\,\\mathrm{m}$，最终时间 $t_{\\mathrm{end}} = 60\\,\\mathrm{s}$。\n- 通过数值求解给定超越方程中的 $\\lambda$，然后计算 $s(t)$，从而从 Stefan 相似解中计算参考界面位置 $s_{\\mathrm{ref}}(t_{\\mathrm{end}})$。\n- 在均匀空间网格上，使用显式时间有限差分格式求解带罚项的焓-孔隙度温度方程，其中空间二阶导数由二阶中心差分近似，并遵循上述初始和边界条件。使用一个满足由热扩散项和罚松弛项导出的显式稳定性约束的时间步长。通过线性插值在网格点之间定位 $T = T_m$ 的穿越点，将界面位置 $s_{\\mathrm{num}}(t_{\\mathrm{end}})$ 估计为温度首次降至 $T_m$ 以下的位置。\n- 报告界面位置的绝对误差 $|s_{\\mathrm{num}}(t_{\\mathrm{end}}) - s_{\\mathrm{ref}}(t_{\\mathrm{end}})|$，单位为米。\n\n在以下参数三元组 $(N_x, \\Delta T, \\beta)$ 的测试集上实现并测试程序，其中 $N_x$ 是空间网格点数，$\\Delta T$ 是平滑宽度（单位为开尔文），$\\beta$ 是罚系数（单位为秒的倒数）：\n- 案例 1（理想情况，无罚项）：$(N_x,\\Delta T,\\beta) = (400, 1.0, 0.0)$。\n- 案例 2（中等罚项）：$(N_x,\\Delta T,\\beta) = (400, 1.0, 10.0)$。\n- 案例 3（窄糊状区，强罚项）：$(N_x,\\Delta T,\\beta) = (400, 0.2, 20.0)$。\n- 案例 4（较粗网格）：$(N_x,\\Delta T,\\beta) = (200, 1.0, 10.0)$。\n- 案例 5（较宽糊状区）：$(N_x,\\Delta T,\\beta) = (400, 2.0, 10.0)$。\n\n科学和数值要求：\n- 您的推导必须基于能量守恒、焓的定义、关系式 $\\alpha = k/(\\rho c_p)$ 和 Stefan 跳跃条件。除从这些原理推导出的公式外，不要使用任何快捷公式。\n- 离散化必须对拉普拉斯算子使用中心差分，并采用显式时间步进。通过选择满足 $\\Delta t \\le C \\, \\Delta x^2/\\alpha_{\\max}$ 的时间步长 $\\Delta t$ 来确保稳定性，其中类 Courant 常数 $C$ 严格小于 $1$，$\\alpha_{\\max} = k/(\\rho c_{\\min})$ 且 $c_{\\min} = c_p$。当 $\\beta  0$ 时，还需满足 $\\Delta t \\le \\theta/\\beta$，其中某个 $\\theta \\in (0,1)$。\n- 通过检测从 $x=0$ 开始移动时温度首次从上到下穿过 $T = T_m$ 的位置，并使用两个相邻网格点之间的线性插值来估计穿越位置，从而确定 $s_{\\mathrm{num}}(t_{\\mathrm{end}})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按测试集顺序排列的结果，格式为方括号括起来的逗号分隔列表，例如 `\"[r_1,r_2,r_3,r_4,r_5]\"`，其中每个 $r_i$ 是以米为单位的绝对误差 $|s_{\\mathrm{num}} - s_{\\mathrm{ref}}|$，表示为浮点数。",
            "solution": "所提出的问题要求分析半无限介质中的一维熔化过程，这是一个经典的 Stefan 问题。我们被要求使用两种不同的方法来确定在指定时间的熔化前沿位置：一种是经典的解析相似解，另一种是基于焓-孔隙度方法的数值有限差分格式。目标是对于给定的物理参数和数值离散化选择，量化数值近似解与精确解析结果之间的差异。\n\n**1. 物理系统与控制参数**\n\n该系统由带相变的一维热方程控制。材料属性提供如下：\n- 密度: $\\rho = 1000\\,\\mathrm{kg/m^3}$\n- 比热容（两相均为常数）: $c_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$\n- 热导率（两相均为常数）: $k = 0.6\\,\\mathrm{W/(m\\cdot K)}$\n- 熔化潜热: $L = 3.34\\times 10^5\\,\\mathrm{J/kg}$\n\n热学条件为：\n- 熔化温度: $T_m = 0\\,^{\\circ}\\mathrm{C}$\n- 固体初始温度: $T(x,0) = T_m = 0\\,^{\\circ}\\mathrm{C}$\n- x=0 处的边界温度: $T(0,t) = T_b = 10\\,^{\\circ}\\mathrm{C}$ for $t  0$\n- 关心的最终时间: $t_{\\mathrm{end}} = 60\\,\\mathrm{s}$\n\n由此，我们可以推导出两个重要参数。首先是热扩散系数 $\\alpha$，它表征了热量传输的速率：\n$$\n\\alpha = \\frac{k}{\\rho c_p} = \\frac{0.6\\,\\mathrm{W/(m\\cdot K)}}{(1000\\,\\mathrm{kg/m^3}) (4180\\,\\mathrm{J/(kg\\cdot K)})} \\approx 1.4354 \\times 10^{-7}\\,\\mathrm{m^2/s}\n$$\n其次是 Stefan 数 $\\mathrm{Ste}$，它是一个无量纲参数，表示显热与潜热之比：\n$$\n\\mathrm{Ste} = \\frac{c_p(T_b - T_m)}{L} = \\frac{(4180\\,\\mathrm{J/(kg\\cdot K)})(10\\,\\mathrm{K} - 0\\,\\mathrm{K})}{3.34\\times 10^5\\,\\mathrm{J/kg}} \\approx 0.12515\n$$\n\n**2. 参考解：经典 Stefan 问题**\n\n对于半无限域中给定的初始和边界条件，该问题存在相似解。温度场仅取决于相似性变量 $\\eta = x/(2\\sqrt{\\alpha t})$。移动熔化前沿的位置 $s(t)$ 由下式给出：\n$$\ns(t) = 2 \\lambda \\sqrt{\\alpha t}\n$$\n其中 $\\lambda$ 是一个无量纲常数。移动界面处的能量守恒（Stefan 条件）导出了关于 $\\lambda$ 的以下超越方程：\n$$\n\\sqrt{\\pi}\\, \\lambda \\, e^{\\lambda^2} \\, \\mathrm{erf}(\\lambda) = \\mathrm{Ste}\n$$\n此处，$\\mathrm{erf}(\\cdot)$ 是误差函数。为了找到参考界面位置 $s_{\\mathrm{ref}}(t_{\\mathrm{end}})$，我们必须首先数值求解该方程以得到 $\\lambda$。令 $f(\\lambda) = \\sqrt{\\pi}\\, \\lambda \\, e^{\\lambda^2} \\, \\mathrm{erf}(\\lambda) - \\mathrm{Ste}$。我们寻求 $f(\\lambda)=0$ 的根。对于 $\\mathrm{Ste} \\approx 0.12515$，使用数值求根算法（例如割线法或牛顿法）可得：\n$$\n\\lambda \\approx 0.24503\n$$\n使用这个值，我们可以计算出在 $t_{\\mathrm{end}} = 60\\,\\mathrm{s}$ 时的精确界面位置：\n$$\ns_{\\mathrm{ref}}(t_{\\mathrm{end}}) = 2 \\lambda \\sqrt{\\alpha t_{\\mathrm{end}}} \\approx 2 \\times 0.24503 \\times \\sqrt{(1.4354 \\times 10^{-7}\\,\\mathrm{m^2/s}) \\times (60\\,\\mathrm{s})} \\approx 0.0014382\\,\\mathrm{m}\n$$\n该值将作为基准，用于与数值结果进行比较。$s_{\\mathrm{ref}}$ 相对于数值计算域长度 $L_x = 0.05\\,\\mathrm{m}$ 的值很小，这验证了使用有限域来近似半无限介质的合理性。\n\n**3. 数值解：带罚项的焓-孔隙度方法**\n\n第二种方法是在有限域 $[0, L_x]$ 上对修正的热方程进行数值求解。相变过程通过表观热容法处理，并辅以一个罚项。控制偏微分方程为：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho \\, c_{\\mathrm{app}}(T)} \\frac{\\partial^2 T}{\\partial x^2} - \\beta \\, (T - T_m) \\, \\chi_{\\mathrm{m}}(T)\n$$\n表观热容 $c_{\\mathrm{app}}(T)$ 模拟了在 $T_m$ 附近的一个小温区 $\\Delta T$ 内潜热的吸收：\n$$\nc_{\\mathrm{app}}(T) = c_p + \\frac{L}{\\Delta T} \\, \\chi_{\\mathrm{m}}(T)\n$$\n其中糊状区指示函数 $\\chi_{\\mathrm{m}}(T)$ 定义为：\n$$\n\\chi_{\\mathrm{m}}(T) = \\begin{cases} 1  \\text{如果 } |T - T_m|  \\Delta T/2 \\\\ 0  \\text{否则} \\end{cases}\n$$\n罚项 $-\\beta (T - T_m) \\chi_{\\mathrm{m}}(T)$ 在糊状区内充当一个松弛源，将温度强制趋向 $T_m$，从而随着罚参数 $\\beta$ 的增大，更严格地施加等温相变条件。\n\n该方程在具有 $N_x$ 个点的均匀空间网格上进行离散化，网格间距为 $\\Delta x = L_x / (N_x - 1)$。我们对空间导数使用二阶中心差分，对时间积分使用显式向前欧拉法。网格点 $i$ 在时间步 $n+1$ 的温度（记为 $T_i^{n+1}$）根据时间步 $n$ 的值更新如下：\n$$\nT_i^{n+1} = T_i^n + \\Delta t \\left[ \\frac{k}{\\rho c_{\\mathrm{app}}(T_i^n)} \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2} \\right) - \\beta (T_i^n - T_m) \\chi_{\\mathrm{m}}(T_i^n) \\right]\n$$\n对于内部点 $i=1, 2, \\dots, N_x-2$。\n\n边界条件为：\n- 在 $x=0$ 处：Dirichlet 条件，$T_0^{n+1} = T_b$。\n- 在 $x=L_x$ 处：零通量 Neumann 条件，$\\frac{\\partial T}{\\partial x}|_{x=L_x}=0$。这通过二阶精度的“虚拟点”法实现。最右侧网格点 $i=N_x-1$ 的更新使用来自计算域外一个虚拟点的值 $T_{N_x}^n$。零通量条件的中心差分近似意味着 $T_{N_x}^n = T_{N_x-2}^n$，从而得到在 $i=N_x-1$ 处的专用更新规则：\n$$\nT_{N_x-1}^{n+1} = T_{N_x-1}^n + \\Delta t \\left[ \\frac{k}{\\rho c_{\\mathrm{app}}(T_{N_x-1}^n)} \\left( \\frac{2T_{N_x-2}^n - 2T_{N_x-1}^n}{\\Delta x^2} \\right) - \\beta (T_{N_x-1}^n - T_m) \\chi_{\\mathrm{m}}(T_{N_x-1}^n) \\right]\n$$\n\n显式格式是条件稳定的。时间步长 $\\Delta t$ 必须满足两个约束：一个来自扩散项，另一个来自罚项（反应项）。\n1. 扩散稳定性：$\\Delta t \\le C \\frac{\\Delta x^2}{D_{\\max}}$，其中 $D(T) = k/(\\rho c_{\\mathrm{app}}(T))$。最大扩散率 $D_{\\max}$ 出现在 $c_{\\mathrm{app}}(T)$ 最小处，即 $c_{\\mathrm{app}}=c_p$。因此，$D_{\\max} = \\alpha$，我们需要 $\\Delta t  \\frac{\\Delta x^2}{2\\alpha}$。我们选择一个保守因子 $C=0.4  0.5$。\n2. 罚项稳定性：对于松弛项，显式欧拉法的稳定性要求 $\\Delta t \\le 2/\\beta$。我们使用所提供的更保守的标准，$\\Delta t \\le \\theta/\\beta$，其中 $\\theta = 0.9$。\n\n最终的时间步长选择为 $\\Delta t = \\min(\\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{penalty}})$。\n\n在模拟运行至 $t = t_{\\mathrm{end}}$ 后，通过定位第一个温度降至 $T_m$ 以下的网格单元 $(x_{i-1}, x_{i})$（即 $T_{i-1} \\ge T_m$ 且 $T_i  T_m$）来找到数值界面位置 $s_{\\mathrm{num}}$。然后使用线性插值来找到精确位置：\n$$\ns_{\\mathrm{num}}(t_{\\mathrm{end}}) = x_{i-1} + \\Delta x \\frac{T_{i-1} - T_m}{T_{i-1} - T_i}\n$$\n程序将对每个指定的测试案例 $(N_x, \\Delta T, \\beta)$ 执行此过程，并报告绝对误差 $|s_{\\mathrm{num}}(t_{\\mathrm{end}}) - s_{\\mathrm{ref}}(t_{\\mathrm{end}})|$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the 1D melting problem using analytical and numerical methods\n    and reports the error for several test cases.\n    \"\"\"\n\n    # --- Physical and Domain Constants ---\n    rho = 1000.0  # Density (kg/m^3)\n    cp = 4180.0   # Specific heat capacity (J/kg.K)\n    k = 0.6       # Thermal conductivity (W/m.K)\n    L = 3.34e5    # Latent heat of fusion (J/kg)\n    T_m = 0.0     # Melting temperature (deg C)\n    T_b = 10.0    # Boundary temperature (deg C)\n    L_x = 0.05    # Domain length (m)\n    t_end = 60.0  # Final time (s)\n\n    # --- Derived constants ---\n    alpha = k / (rho * cp)  # Thermal diffusivity (m^2/s)\n    Ste = cp * (T_b - T_m) / L  # Stefan number (-)\n\n    def compute_s_ref():\n        \"\"\"\n        Calculates the reference interface position using the analytical\n        Stefan similarity solution.\n        \"\"\"\n        # Transcendental equation: f(lambda) = 0\n        def f(lam):\n            return np.sqrt(np.pi) * lam * np.exp(lam**2) * erf(lam) - Ste\n\n        # Solve for lambda using a root-finding algorithm\n        # Bracket [0.01, 1.0] is safe as lambda > 0 for Ste > 0\n        sol = root_scalar(f, bracket=[0.01, 1.0], method='brentq')\n        lam = sol.root\n\n        # Calculate interface position\n        s_ref = 2 * lam * np.sqrt(alpha * t_end)\n        return s_ref\n\n    def compute_s_num(Nx, dT_mushy, beta):\n        \"\"\"\n        Solves the penalized enthalpy-porosity PDE numerically.\n        \"\"\"\n        # --- Discretization ---\n        dx = L_x / (Nx - 1)\n        x = np.linspace(0, L_x, Nx)\n\n        # --- Stability and Time Stepping ---\n        # Diffusion stability constraint\n        dt_diff = 0.4 * dx**2 / alpha  # Using a safety factor C = 0.4  0.5\n\n        # Penalty term stability constraint\n        if beta > 0:\n            dt_penalty = 0.9 / beta # Using safety factor theta = 0.9  1.0\n            dt = min(dt_diff, dt_penalty)\n        else:\n            dt = dt_diff\n\n        num_steps = int(np.ceil(t_end / dt))\n        dt = t_end / num_steps # Adjust dt to hit t_end exactly\n\n        # --- Initialization ---\n        T = np.full(Nx, T_m, dtype=np.float64)\n\n        # --- Time Marching Loop ---\n        for _ in range(num_steps):\n            # Store previous time step's temperature\n            T_n = T.copy()\n\n            # Apply Dirichlet BC at x=0\n            T[0] = T_b\n\n            # --- Calculate temperature-dependent properties ---\n            # Mushy zone indicator chi_m(T)\n            mushy_mask = np.abs(T_n - T_m)  (dT_mushy / 2.0)\n            \n            # Apparent heat capacity c_app(T)\n            c_app = np.full(Nx, cp, dtype=np.float64)\n            if dT_mushy > 0:\n                c_app[mushy_mask] += L / dT_mushy\n\n            # --- Update interior points ---\n            # i = 1 to Nx-2\n            laplacian = (T_n[2:] - 2 * T_n[1:-1] + T_n[:-2]) / dx**2\n            diffusion_term = (k / (rho * c_app[1:-1])) * laplacian\n            \n            penalty_term = np.zeros(Nx - 2)\n            if beta > 0:\n                penalty_term[mushy_mask[1:-1]] = beta * (T_n[1:-1][mushy_mask[1:-1]] - T_m)\n\n            T[1:-1] = T_n[1:-1] + dt * (diffusion_term - penalty_term)\n\n            # --- Apply Neumann BC at x=L_x ---\n            # i = Nx-1\n            laplacian_end = (2 * T_n[Nx-2] - 2 * T_n[Nx-1]) / dx**2\n            diffusion_end = (k / (rho * c_app[Nx-1])) * laplacian_end\n\n            penalty_end = 0.0\n            if beta > 0 and mushy_mask[Nx-1]:\n                penalty_end = beta * (T_n[Nx-1] - T_m)\n\n            T[Nx-1] = T_n[Nx-1] + dt * (diffusion_end - penalty_end)\n\n        # --- Find Interface Position ---\n        # Find the first index 'i' where T drops below Tm\n        try:\n            idx = np.where(T  T_m)[0][0]\n            if idx == 0: # Should not happen with Tb > Tm\n                return 0.0\n            \n            # Linear interpolation between grid points T[idx-1] and T[idx]\n            T_prev = T[idx-1]\n            T_curr = T[idx]\n            x_prev = x[idx-1]\n\n            s_num = x_prev + dx * (T_prev - T_m) / (T_prev - T_curr)\n            return s_num\n        except IndexError:\n            # Interface did not enter the domain or passed the whole domain\n            # Passed domain is unlikely here, so assume it is at or beyond Lx\n            return L_x\n\n    # --- Main Execution ---\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (400, 1.0, 0.0),    # Case 1\n        (400, 1.0, 10.0),   # Case 2\n        (400, 0.2, 20.0),   # Case 3\n        (200, 1.0, 10.0),   # Case 4\n        (400, 2.0, 10.0),   # Case 5\n    ]\n\n    # Calculate the reference solution once\n    s_ref = compute_s_ref()\n\n    results = []\n    for case in test_cases:\n        Nx, dT_mushy, beta = case\n        s_num = compute_s_num(Nx, dT_mushy, beta)\n        error = np.abs(s_num - s_ref)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "焓-孔隙度方法的真正威力在于其模拟多物理场现象的能力，例如凝固过程中的熔体对流。这项高级实践将引导您使用达西-布林克曼（Darcy-Brinkman）模型，将能量方程与流体动力学耦合起来，并直面一个关键的数值挑战：由多孔介质拖曳项引入的数值刚性问题。完成这项练习后，您将深刻理解如何在一个统一的框架内处理相变和流体流动，以及如何通过分析数值稳定性来确保模拟的可靠性。",
            "id": "3521166",
            "problem": "考虑一个在焓-孔隙度（EP）框架和 Darcy–Brinkman（DB）动量描述下的耦合相变与流动问题的一维等温步骤。EP 方法通过将潜热嵌入焓变量并强制液相分数随温度变化来模拟相变，而 DB 公式则将粘性剪切扩展到多孔区域，并增加一个阻力项来抑制固相区和糊状区中的流动。当惩罚项变得刚性时，您必须推导出一个一致的耦合关系，然后为显式 Euler 时间积分设计并实现一个数值稳定性测试。\n\n物理设置为一个稳态温度场和一个速度场的显式 Euler 更新，空间为一维。域的长度为 $L = 0.01\\,\\mathrm{m}$，离散为 $N$ 个内部节点，节点间距均匀，为 $h = L/(N+1)$，并采用均匀 Dirichlet 边界条件 $u(0,t) = u(L,t) = 0$。液相分数是温度的函数 $f_l(T)$，满足在固相线温度 $T_s$ 以下时 $f_l(T) = 0$，在液相线温度 $T_l$ 以上时 $f_l(T) = 1$，在 $T_s  T  T_l$ 的糊状区间内 $0  f_l(T)  1$，并伴有平滑的单调过渡。使用以下物理上一致的分段线性孔隙度函数，并通过正则化避免阻力项中的奇异性：\n$$\nf_l(T) = \n\\begin{cases}\n0,  T \\le T_s,\\\\\n\\frac{T - T_s}{T_l - T_s},  T_s  T  T_l,\\\\\n1,  T \\ge T_l,\n\\end{cases}\n\\quad \\text{以及} \\quad \\tilde f_l(T) = \\max(f_l(T), \\varepsilon),\n$$\n其中 $T_s = 273.15\\,\\mathrm{K}$，$T_l = 273.65\\,\\mathrm{K}$，且 $\\varepsilon = 10^{-3}$。\n\n对于密度为 $\\rho$、动力粘度为 $\\mu$ 的 Newtonian 流体，DB 动量平衡模型为\n$$\n\\rho \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha(T)\\,\\mathbf{u},\n$$\n其中 $\\mathbf{u}$ 是速度，$\\alpha(T)$ 是由相变模型产生的 EP 阻力系数。在带惩罚的 EP 方法中，阻力系数表示为\n$$\n\\alpha(T) = A \\frac{(1 - \\tilde f_l(T))^2}{\\tilde f_l(T)^3},\n$$\n其中 $A$ 是一个控制固相/糊状区域流动抑制的大幅值。对于一维速度 $u(x,t)$ 和冻结温度场，半离散显式 Euler 更新可以写成以下形式：\n$$\n\\frac{d\\mathbf{u}}{dt} = -\\mathbf{M}\\,\\mathbf{u},\n$$\n其中 $\\mathbf{M}$ 是一个依赖于 $\\mu$、$\\rho$、离散拉普拉斯算子和随温度变化的阻力的正定矩阵。\n\n您的任务是：\n\n1.  从能量守恒和动量守恒，以及包含潜热的焓的定义出发，推导 EP 液相分数 $f_l(T)$ 和 DB 动量方程之间的一致耦合。形式化说明 EP 阻力系数 $\\alpha(T)$ 如何进入 DB 动量平衡，并指定在均匀 Dirichlet 边界条件、均匀网格间距和冻结温度场下的半离散算子 $\\mathbf{M}$。您的推导必须从能量和动量守恒定律开始，定义包含潜热的焓，并说明液相分数如何在动量方程中引出惩罚项 $-\\alpha(T)\\mathbf{u}$。您还必须说明在何种假设下，半离散算子 $\\mathbf{M}$ 是对称正定的。\n\n2.  对于通过显式 Euler 方法推进的线性常微分方程 $d\\mathbf{u}/dt = -\\mathbf{M}\\mathbf{u}$，推导一个用 $\\mathbf{M}$ 的特征值表示的线性稳定性条件，并得出一个防止离散 $L^2$ 能量增长的最大稳定时间步长 $\\,\\Delta t_{\\max}\\,$ 的公式。解释当 $\\tilde f_l(T)$ 接近零时需要进行的任何正则化。\n\n3.  实现一个程序，给定 $N$、$L$、$\\mu$、$\\rho$、$A$ 以及在内部节点上采样的指定温度场 $T(x)$，该程序会构建半离散算子 $\\mathbf{M}$ 并根据您的稳定性准则计算 $\\,\\Delta t_{\\max}\\,$。在所有测试中，使用 $N = 20$，$L = 0.01\\,\\mathrm{m}$，$\\mu = 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$ 和 $\\rho = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$。使用二阶中心差分在均匀 Dirichlet 边界条件下离散化一维拉普拉斯算子。\n\n4.  通过评估以下四种情况下 $\\,\\Delta t_{\\max}\\,$ 的值来测试刚性下的数值稳定性，每种情况都提供了内部节点的温度和一个指定的 $A$ 值：\n    -   情况 1（完全液相，理想情况）：$A = 10^{6}$，所有内部节点 $i$ 的温度为 $T_i = T_l + 1.0\\,\\mathrm{K}$。\n    -   情况 2（均匀糊状区）：$A = 10^{6}$，所有内部节点 $i$ 的温度为 $T_i = (T_s + T_l)/2$。\n    -   情况 3（接近固相，高度刚性）：$A = 10^{8}$，所有内部节点 $i$ 的温度为 $T_i = T_s + 0.05\\,(T_l - T_s)$。\n    -   情况 4（非均匀，混合刚性）：$A = 10^{7}$，内部节点 $i \\le N/2$ 的温度为 $T_i = T_s + 0.10\\,(T_l - T_s)$，内部节点 $i  N/2$ 的温度为 $T_i = T_l + 0.20\\,\\mathrm{K}$。\n\n所有表示时间的量必须以秒为单位。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\,[\\Delta t_{\\max,1},\\Delta t_{\\max,2},\\Delta t_{\\max,3},\\Delta t_{\\max,4}]\\,$），其中每个条目都是一个浮点数，代表相应情况下的 $\\,\\Delta t_{\\max}\\,$（以秒为单位）。输出必须采用上述确切的格式和顺序。\n\n在问题陈述中，除已写明的内容外，不提供任何中间提示。推导和算法步骤必须基于基本的守恒定律和定义，并且必须在科学上与相变建模和多孔流体力学一致。",
            "solution": "我们从基本原理出发。对于相变材料，能量守恒将焓的变化与热通量和热源联系起来。在焓-孔隙度（EP）方法中，比焓 $h(T)$ 被分解为显热和潜热两部分：\n$$\nh(T) = \\int_{T_0}^{T} c_p(\\theta)\\,d\\theta + L\\,f_l(T),\n$$\n其中 $c_p(T)$ 是比热容，$L$ 是熔化潜热，$f_l(T)$ 是液相分数。在没有对流和内部源的情况下，能量平衡方程为\n$$\n\\rho \\frac{\\partial h}{\\partial t} = \\nabla \\cdot \\left(k \\nabla T\\right),\n$$\n其中 $k$ 为导热系数。在 EP 方法中，相变通过允许 $f_l(T)$ 在糊状区间 $[T_s, T_l]$ 内从 $0$ 平滑变化到 $1$ 来体现，从而通过潜热的释放或吸收与能量守恒保持一致。\n\n在多孔介质中，Newtonian 流体的动量守恒由 Darcy–Brinkman（DB）方程给出，该方程通过一个 Darcy 阻力项扩展了 Stokes 流动。对于速度 $\\mathbf{u}$ 和压力 $p$，密度 $\\rho$ 和动力粘度 $\\mu$，有\n$$\n\\rho \\frac{\\partial \\mathbf{u}}{\\partial t} + \\rho (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha\\,\\mathbf{u}.\n$$\n对于当前的线性稳定性分析（小 Reynolds 数或对线性化稳定性的显式研究），我们忽略对流项，写为\n$$\n\\rho \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha(T)\\,\\mathbf{u}.\n$$\nEP 耦合提供了一个阻力系数，该系数在液相分数小的地方抑制流动，并在液相中消失：\n$$\n\\alpha(T) = A \\frac{(1 - \\tilde f_l(T))^2}{\\tilde f_l(T)^3}, \\quad \\tilde f_l(T) = \\max(f_l(T), \\varepsilon),\n$$\n其中 $A$ 是一个大幅值，$\\varepsilon$ 是一个小的正则化参数，用于防止当 $f_l \\to 0$ 时出现奇异性。这种正则化至关重要，因为当 $f_l \\to 0$ 时，$f_l^{-3}$ 发散，这反映了速度在固相中应为零的物理概念；在数值上，我们避免了除以零，同时仍能实现大的惩罚效果。\n\n我们关注具有均匀 Dirichlet 边界条件 $u(0,t) = u(L,t) = 0$ 的一维速度 $u(x,t)$。将空间域离散为 $N$ 个内部节点，间距为 $h = L/(N+1)$。在均匀 Dirichlet 边界条件下，二阶中心差分离散拉普拉斯算子产生离散正算子 $\\mathbf{L}$：\n$$\n\\mathbf{L} = \\frac{1}{h^2}\\begin{bmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\ddots  \\vdots \\\\\n0  -1  2  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{bmatrix},\n$$\n这对应于 $-\\partial_{xx}$ 并且是对称正定的。设 $\\boldsymbol{\\alpha}$ 为节点阻力系数向量 $\\alpha_i = \\alpha(T_i)$，$\\mathbf{D} = \\mathrm{diag}(\\alpha_i/\\rho)$ 为除以密度的对角阻力算子。对于冻结温度场，半离散动量方程（除以 $\\rho$）为\n$$\n\\frac{d\\mathbf{u}}{dt} = \\frac{\\mu}{\\rho} \\nabla^2 \\mathbf{u} - \\frac{\\boldsymbol{\\alpha}}{\\rho} \\odot \\mathbf{u},\n$$\n使用 $\\mathbf{L}$ 的算子形式为\n$$\n\\frac{d\\mathbf{u}}{dt} = -\\left( \\frac{\\mu}{\\rho}\\,\\mathbf{L} + \\mathbf{D} \\right)\\mathbf{u} = -\\mathbf{M}\\,\\mathbf{u}.\n$$\n这里，\n$$\n\\mathbf{M} = \\frac{\\mu}{\\rho}\\,\\mathbf{L} + \\mathbf{D},\n$$\n其中 $\\mathbf{L}$ 是对称正定的，$\\mathbf{D}$ 是对称半正定的（在 $\\alpha_i > 0$ 的地方是严格正定的）。因此，在均匀 Dirichlet 边界和非负阻力下，$\\mathbf{M}$ 是对称正定的，除非在所有 $i$ 处 $\\alpha_i = 0$ 的特殊情况下，此时由于拉普拉斯算子，$\\mathbf{M}$ 仍然是对称正定的；如果 $\\mathbf{D}$ 为零且使用均匀 Dirichlet 拉普拉斯算子，$\\mathbf{L}$ 保持正定性，$\\mathbf{M}$ 也是正定的。对称性和正定性确保了特征值为实数且为正。\n\n我们现在建立显式 Euler 稳定性准则。考虑线性常微分方程\n$$\n\\frac{d\\mathbf{u}}{dt} = -\\mathbf{M}\\,\\mathbf{u}.\n$$\n显式 Euler 更新为\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t\\,\\mathbf{M}\\,\\mathbf{u}^n = \\left(\\mathbf{I} - \\Delta t\\,\\mathbf{M}\\right)\\mathbf{u}^n.\n$$\n设 $\\lambda_j$ 表示 $\\mathbf{M}$ 的特征值，它们是实数且为正。在特征基中，每个模式的放大因子为 $g_j = 1 - \\Delta t\\,\\lambda_j$。为使离散 $L^2$ 能量不增加，我们要求对所有 $j$ 都有 $|g_j| \\le 1$，这意味着 $0 \\le \\Delta t\\,\\lambda_j \\le 2$。因此，\n$$\n\\Delta t \\le \\frac{2}{\\max_j \\lambda_j} = \\frac{2}{\\rho_{\\mathrm{spec}}(\\mathbf{M})},\n$$\n其中 $\\rho_{\\mathrm{spec}}(\\mathbf{M})$ 是 $\\mathbf{M}$ 的谱半径（最大特征值）。这得出了最大稳定时间步长\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(\\mathbf{M})}.\n$$\n当 $\\tilde f_l(T)$ 接近零时，EP 阻力系数 $\\alpha(T)$ 变得极大，增加了 $\\lambda_{\\max}(\\mathbf{M})$，从而使 $\\Delta t_{\\max}$ 变得极小。通过小的 $\\varepsilon$ 进行正则化 $\\tilde f_l(T) = \\max(f_l(T), \\varepsilon)$，可以保持有限但非常大的阻力，并在避免除以零的同时保留了质的刚性。\n\n计算 $\\Delta t_{\\max}$ 的算法设计如下：\n-   使用二阶中心差分和均匀 Dirichlet 边界条件构建离散拉普拉斯算子 $\\mathbf{L}$，得到一个对角元素为 $2/h^2$、次对角元素为 $-1/h^2$ 的对称三对角矩阵。\n-   使用带正则化的分段线性函数，将内部节点的温度场映射到 $\\tilde f_l(T_i)$。\n-   计算阻力 $\\alpha_i = A\\,\\frac{(1 - \\tilde f_l(T_i))^2}{\\tilde f_l(T_i)^3}$，并形成 $\\mathbf{D} = \\mathrm{diag}(\\alpha_i/\\rho)$。\n-   组装 $\\mathbf{M} = (\\mu/\\rho)\\,\\mathbf{L} + \\mathbf{D}$。\n-   使用对称特征值求解器计算 $\\mathbf{M}$ 的最大特征值 $\\lambda_{\\max}$。\n-   返回 $\\Delta t_{\\max} = 2/\\lambda_{\\max}$。\n\n现在我们将此应用于指定的测试，参数为 $N = 20$，$L = 0.01\\,\\mathrm{m}$，$\\mu = 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$，以及 $\\rho = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$。四个情况如下：\n-   情况 1：所有节点完全液相 $f_l = 1$，$A = 10^{6}$；$\\alpha = 0$ 且 $\\mathbf{M} = (\\mu/\\rho)\\,\\mathbf{L}$；时间步长受粘性扩散限制。\n-   情况 2：均匀糊状区 $f_l = 0.5$ 于所有节点，$A = 10^{6}$；$\\alpha = A\\,(1-0.5)^2/0.5^3 = A \\cdot 0.25 / 0.125 = 2A$；阻力占主导地位，并大幅减小 $\\Delta t_{\\max}$。\n-   情况 3：接近固相 $f_l = 0.05$ 于所有节点，$A = 10^{8}$；$\\alpha$ 极大，使得 $\\Delta t_{\\max}$ 极小（刚性状态）。\n-   情况 4：非均匀 $f_l$，左半部分 $f_l = 0.1$，右半部分 $f_l = 1$，$A = 10^{7}$；算子 $\\mathbf{M}$ 具有空间变化的对角贡献，稳定性由复合算子的最大特征值决定。\n\n实现过程计算每种情况下以秒为单位的 $\\Delta t_{\\max}$，并按要求的单行列表格式输出它们。通过使用物理上合理的值、一致的单位以及公认的 EP 和 DB 公式，保留了科学真实性。显式 Euler 稳定性准则是数值时间积分中针对耗散算子线性系统的标准、经过充分检验的事实。",
            "answer": "```python\n# Python 3.12, numpy 1.23.5\nimport numpy as np\n\ndef liquid_fraction(T, Ts, Tl, eps=1e-3):\n    \"\"\"\n    Piecewise-linear liquid fraction f_l(T) with regularization:\n    f_l = 0 for T = Ts\n    f_l = (T - Ts)/(Tl - Ts) for Ts  T  Tl\n    f_l = 1 for T >= Tl\n    Returns max(f_l, eps) to avoid singularity in penalization.\n    \"\"\"\n    if T = Ts:\n        f = 0.0\n    elif T >= Tl:\n        f = 1.0\n    else:\n        f = (T - Ts) / (Tl - Ts)\n    return max(f, eps)\n\ndef build_laplacian_dirichlet(N, h):\n    \"\"\"\n    Build 1D discrete positive Laplacian operator L = -d2/dx2\n    with homogeneous Dirichlet boundary conditions on N interior nodes.\n    \"\"\"\n    main = (2.0 / h**2) * np.ones(N)\n    off = (-1.0 / h**2) * np.ones(N - 1)\n    L = np.diag(main) + np.diag(off, 1) + np.diag(off, -1)\n    return L\n\ndef build_operator_M(N, Lx, mu, rho, A, T_nodes, Ts, Tl, eps=1e-3):\n    \"\"\"\n    Assemble the semi-discrete operator M = (mu/rho)*L + diag(alpha/rho)\n    where alpha = A * ((1 - f)^2)/(f^3) and f = liquid_fraction(T).\n    \"\"\"\n    h = Lx / (N + 1)\n    L = build_laplacian_dirichlet(N, h)\n    f = np.array([liquid_fraction(T, Ts, Tl, eps) for T in T_nodes])\n    alpha = A * ((1.0 - f)**2) / (f**3)\n    D = np.diag(alpha / rho)\n    M = (mu / rho) * L + D\n    return M\n\ndef dt_max_from_operator(M):\n    \"\"\"\n    For explicit Euler stability of du/dt = -M u, dt_max = 2 / lambda_max(M).\n    Uses eigvalsh since M is symmetric.\n    \"\"\"\n    eigs = np.linalg.eigvalsh(M)\n    lam_max = np.max(eigs)\n    # Guard against any numerical zero or negative eigenvalues (shouldn't occur for SPD),\n    # but ensure positive lam_max for meaningful dt.\n    if lam_max = 0.0:\n        return float('inf')\n    return 2.0 / lam_max\n\ndef solve():\n    # Physical and numerical parameters\n    N = 20\n    Lx = 0.01  # meters\n    mu = 1.0e-3  # Pa*s\n    rho = 1000.0  # kg/m^3\n    Ts = 273.15  # K\n    Tl = 273.65  # K\n    eps = 1.0e-3\n\n    # Generate interior node positions (not strictly needed for this test since T is uniform/piecewise)\n    # x_i = i*h for i=1..N with h = Lx/(N+1)\n    h = Lx / (N + 1)\n    x_nodes = np.arange(1, N + 1) * h\n\n    test_cases = []\n\n    # Case 1: fully liquid\n    A1 = 1.0e6\n    T1 = Tl + 1.0  # K\n    T_nodes_1 = np.full(N, T1)\n    test_cases.append((A1, T_nodes_1))\n\n    # Case 2: uniform mushy (midpoint)\n    A2 = 1.0e6\n    T2 = 0.5 * (Ts + Tl)\n    T_nodes_2 = np.full(N, T2)\n    test_cases.append((A2, T_nodes_2))\n\n    # Case 3: near-solid, highly stiff\n    A3 = 1.0e8\n    T3 = Ts + 0.05 * (Tl - Ts)\n    T_nodes_3 = np.full(N, T3)\n    test_cases.append((A3, T_nodes_3))\n\n    # Case 4: heterogeneous, mixed stiffness\n    A4 = 1.0e7\n    T_left = Ts + 0.10 * (Tl - Ts)\n    T_right = Tl + 0.20\n    T_nodes_4 = np.empty(N)\n    half = N // 2\n    T_nodes_4[:half] = T_left\n    T_nodes_4[half:] = T_right\n    test_cases.append((A4, T_nodes_4))\n\n    results = []\n    for A, T_nodes in test_cases:\n        M = build_operator_M(N, Lx, mu, rho, A, T_nodes, Ts, Tl, eps)\n        dt_max = dt_max_from_operator(M)\n        results.append(dt_max)\n\n    # Final print: single line, comma-separated list enclosed in square brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}