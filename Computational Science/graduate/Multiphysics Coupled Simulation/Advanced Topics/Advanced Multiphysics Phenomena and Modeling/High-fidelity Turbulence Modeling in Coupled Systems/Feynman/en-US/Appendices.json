{
    "hands_on_practices": [
        {
            "introduction": "High-fidelity simulations like Large Eddy Simulation (LES) often cannot afford to resolve the smallest turbulent scales near a solid boundary, a region where many critical phenomena occur. This exercise introduces the foundational concept of wall-modeling by tasking you with building a simple model from first principles. By applying the equilibrium boundary layer assumption and using data from the resolved flow field, you will derive the wall shear stress, providing a hands-on look at this essential technique in computational fluid dynamics. ",
            "id": "3509370",
            "problem": "A compressible fluid at uniform temperature is part of a conjugate heat transfer simulation, but over the time window of interest the temperature is effectively uniform so that the dynamic viscosity is constant and the flow can be modeled as incompressible with constant kinematic viscosity. Consider a statistically steady, fully developed turbulent boundary layer over a smooth, planar wall, computed using Large Eddy Simulation (LES). You will construct a near-wall equilibrium wall-stress model that returns a friction velocity $u_{\\tau}$ consistent with the resolved shear, using a reconstruction of the mean velocity over the first two off-wall cells.\n\nStarting from the filtered, incompressible Navier–Stokes equations, assume the following modeling and physical assumptions that are standard in near-wall equilibrium wall-stress modeling:\n- Statistical stationarity and negligible streamwise pressure gradient over the near-wall control layer, so that the wall-normal derivative of the total shear stress is approximately zero in the equilibrium layer adjacent to the wall.\n- The total mean shear stress at a wall-normal location $y$ can be represented as the sum of viscous and turbulent contributions, with the turbulent part modeled by an eddy viscosity closure.\n- The eddy viscosity is given by Prandtl’s mixing-length hypothesis with van Driest damping; for this problem, assume the damping is fully saturated over the first off-wall cell so that the damping factor is effectively unity. Thus, the mixing length reduces to $l_{m}=\\kappa y$, where $\\kappa$ is the von Kármán constant.\n\nTo make the model consistent with the resolved LES field, estimate the mean shear at the first off-wall location $y_{1}$ by a linear least-squares reconstruction of the mean velocity profile through the no-slip wall point using the first two off-wall cell-center values. Specifically, fit $U(y)\\approx a\\,y$ in a least-squares sense through the points $(0,0)$, $(y_{1},U_{1})$, and $(y_{2},U_{2})$, where $U(y)$ is the mean streamwise velocity. Use the resulting slope $a$ as the estimate of the mean shear $\\left.\\frac{dU}{dy}\\right|_{y_{1}}\\approx a$.\n\nUsing the above assumptions and the near-wall equilibrium momentum balance, derive an expression for the friction velocity $u_{\\tau}$ in terms of the reconstructed shear $a$, the kinematic viscosity $\\nu$, the von Kármán constant $\\kappa$, and $y_{1}$. Then evaluate $u_{\\tau}$ numerically for the following data:\n- $y_{1}=0.004\\ \\mathrm{m}$,\n- $y_{2}=0.012\\ \\mathrm{m}$,\n- $U_{1}=3.00\\ \\mathrm{m/s}$,\n- $U_{2}=5.50\\ \\mathrm{m/s}$,\n- $\\nu=1.5\\times 10^{-5}\\ \\mathrm{m^{2}/s}$,\n- $\\kappa=0.41$.\n\nExpress your final answer for the friction velocity in $\\mathrm{m/s}$ and round to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in established principles of turbulence modeling for Large Eddy Simulation (LES), is well-posed with sufficient and consistent data, and is formulated objectively. We can therefore proceed with the derivation and solution.\n\nThe goal is to find the friction velocity, $u_{\\tau}$, using a near-wall equilibrium model. The solution requires several steps: first, determining the mean velocity gradient from the given cell-centered velocities using a least-squares fit; second, formulating the equilibrium momentum balance including the specified turbulence model; and third, solving the resulting equation for $u_{\\tau}$.\n\nFirst, we determine the slope $a$ of the linear velocity profile, $U(y) = ay$, that provides a best fit in the least-squares sense to the data points $(y_i, U_i)$. The given points are $(0,0)$, $(y_{1}, U_{1})$, and $(y_{2}, U_{2})$. The sum of the squared errors, $S$, is given by:\n$$S(a) = \\sum_{i=0}^{2} (U_{i} - a y_{i})^{2} = (U_{0} - a y_{0})^{2} + (U_{1} - a y_{1})^{2} + (U_{2} - a y_{2})^{2}$$\nGiven that $(y_{0}, U_{0}) = (0,0)$, the expression simplifies to:\n$$S(a) = (U_{1} - a y_{1})^{2} + (U_{2} - a y_{2})^{2}$$\nTo minimize the error, we set the derivative of $S$ with respect to $a$ equal to zero:\n$$\\frac{dS}{da} = 2(U_{1} - a y_{1})(-y_{1}) + 2(U_{2} - a y_{2})(-y_{2}) = 0$$\n$$-U_{1}y_{1} + a y_{1}^{2} - U_{2}y_{2} + a y_{2}^{2} = 0$$\nSolving for $a$, we obtain the expression for the reconstructed mean velocity gradient:\n$$a(y_{1}^{2} + y_{2}^{2}) = U_{1}y_{1} + U_{2}y_{2}$$\n$$a = \\frac{U_{1}y_{1} + U_{2}y_{2}}{y_{1}^{2} + y_{2}^{2}}$$\nThis value of $a$ will be used as the estimate for the mean shear at the first off-wall location, i.e., $\\left.\\frac{dU}{dy}\\right|_{y_{1}} \\approx a$.\n\nNext, we establish the momentum balance in the near-wall equilibrium layer. The core assumption is that the total shear stress, $\\tau_{\\text{total}}$, is constant in the wall-normal direction and equal to the wall shear stress, $\\tau_{w}$.\n$$\\tau_{\\text{total}} = \\tau_{w}$$\nThe friction velocity $u_{\\tau}$ is defined by $\\tau_{w} = \\rho u_{\\tau}^{2}$, where $\\rho$ is the fluid density. Therefore:\n$$\\tau_{\\text{total}} = \\rho u_{\\tau}^{2}$$\nThe total shear stress is the sum of the viscous stress and the turbulent (Reynolds) stress, which is modeled using an eddy viscosity, $\\nu_{t}$:\n$$\\tau_{\\text{total}} = \\rho(\\nu + \\nu_{t}) \\frac{dU}{dy}$$\nwhere $\\nu$ is the kinematic viscosity. Equating the two expressions for $\\tau_{\\text{total}}$ and dividing by $\\rho$ gives:\n$$u_{\\tau}^{2} = (\\nu + \\nu_{t}) \\frac{dU}{dy}$$\nThe problem specifies using Prandtl's mixing-length model for the eddy viscosity, with the mixing length $l_{m} = \\kappa y$, where $\\kappa$ is the von Kármán constant. The eddy viscosity is thus:\n$$\\nu_{t} = l_{m}^{2} \\left| \\frac{dU}{dy} \\right| = (\\kappa y)^{2} \\frac{dU}{dy}$$\nWe assume $\\frac{dU}{dy} > 0$ for a boundary layer velocity profile.\n\nNow, we evaluate the equilibrium balance at the first off-wall location, $y=y_{1}$:\n$$u_{\\tau}^{2} = \\left(\\nu + \\nu_{t}|_{y_{1}}\\right) \\left.\\frac{dU}{dy}\\right|_{y_{1}}$$\nSubstituting the expressions for $\\nu_{t}|_{y_{1}}$ and $\\left.\\frac{dU}{dy}\\right|_{y_{1}} \\approx a$:\n$$\\nu_{t}|_{y_{1}} = (\\kappa y_{1})^{2} a$$\nThus, the equation for $u_{\\tau}^{2}$ becomes:\n$$u_{\\tau}^{2} = (\\nu + (\\kappa y_{1})^{2} a) a = \\nu a + (\\kappa y_{1} a)^{2}$$\nThis is the final symbolic expression for $u_{\\tau}^{2}$. The friction velocity is:\n$$u_{\\tau} = \\sqrt{\\nu a + (\\kappa y_{1} a)^{2}}$$\n\nWe now substitute the given numerical values to compute $u_{\\tau}$. The data are:\n$y_{1} = 0.004 \\ \\mathrm{m}$\n$y_{2} = 0.012 \\ \\mathrm{m}$\n$U_{1} = 3.00 \\ \\mathrm{m/s}$\n$U_{2} = 5.50 \\ \\mathrm{m/s}$\n$\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^{2}/s}$\n$\\kappa = 0.41$\n\nFirst, calculate the reconstructed shear, $a$:\n$$a = \\frac{(3.00)(0.004) + (5.50)(0.012)}{(0.004)^{2} + (0.012)^{2}} = \\frac{0.012 + 0.066}{0.000016 + 0.000144} = \\frac{0.078}{0.000160} = 487.5 \\ \\mathrm{s^{-1}}$$\nNow, calculate the two terms in the expression for $u_{\\tau}^{2}$:\nThe viscous contribution to the stress (scaled) is:\n$$\\nu a = (1.5 \\times 10^{-5}) (487.5) = 0.0073125 \\ \\mathrm{m^{2}/s^{2}}$$\nThe turbulent velocity scale is:\n$$\\kappa y_{1} a = (0.41)(0.004)(487.5) = 0.7995 \\ \\mathrm{m/s}$$\nThe turbulent contribution to the stress (scaled) is the square of this value:\n$$(\\kappa y_{1} a)^{2} = (0.7995)^{2} = 0.63920025 \\ \\mathrm{m^{2}/s^{2}}$$\nNow, we find $u_{\\tau}^{2}$ by summing the contributions:\n$$u_{\\tau}^{2} = 0.0073125 + 0.63920025 = 0.64651275 \\ \\mathrm{m^{2}/s^{2}}$$\nFinally, we take the square root to find $u_{\\tau}$:\n$$u_{\\tau} = \\sqrt{0.64651275} \\approx 0.80406016... \\ \\mathrm{m/s}$$\nRounding to four significant figures, as required by the problem statement:\n$$u_{\\tau} \\approx 0.8041 \\ \\mathrm{m/s}$$\nThis completes the solution.",
            "answer": "$$\\boxed{0.8041}$$"
        },
        {
            "introduction": "In multiphysics simulations, the numerical stability of the coupled system depends on the constraints of each individual physics solver, especially when using explicit time integration schemes. This practice problem places you in the role of an analyst determining the operational limits for a fluid-structure interaction (FSI) simulation. You will calculate and compare the stability limits from both the fluid (LES) and structural domains to find the critical time step for the entire system, a fundamental skill for any practitioner of coupled simulations. ",
            "id": "3509332",
            "problem": "A flexible, tensioned plate is immersed in an incompressible turbulent channel flow that is resolved using Large-Eddy Simulation (LES), within a multiphysics fluid–structure interaction framework. The coupling is performed by a loosely coupled partitioned algorithm with a single global time step. The fluid solver uses an explicit time integrator, and the structural solver uses explicit central differences on a membrane model for the plate. The density ratio is unity, that is, $\\rho_{s}/\\rho_{f} = 1$. The flow and structure are discretized with the following parameters:\n\n- Fluid side (LES): maximum resolved velocity $U_{\\max} = 12\\,\\mathrm{m/s}$, minimum grid spacing $\\Delta = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, and fluid Courant–Friedrichs–Lewy (CFL) limit $C_{\\mathrm{CFL},f} = 0.5$.\n- Structural side (membrane plate): in-plane tension per unit length $T = 1000\\,\\mathrm{N/m}$, plate thickness $t = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, mass density $\\rho_{f} = \\rho_{s} = 1000\\,\\mathrm{kg/m^{3}}$ (by the given ratio), structural element size $h_{s} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$, and structural Courant limit $C_{\\mathrm{Courant},s} = 0.9$.\n\nStarting from the incompressible Navier–Stokes equations and their explicit time-discrete stability requirement expressed by the fluid CFL condition, and from the membrane wave equation and its explicit stability expressed by the structural Courant condition, derive the critical global time step $\\Delta t_{\\mathrm{crit}}$ that ensures stability of both solvers under loose partitioned coupling. Compute its value using the data above.\n\nExpress the final time step in microseconds and round your answer to four significant figures.",
            "solution": "The problem requires finding the critical global time step, $\\Delta t_{\\mathrm{crit}}$, for a loosely coupled partitioned fluid-structure interaction (FSI) simulation. This critical time step is the maximum value that ensures numerical stability for both the fluid and the structural solvers, which are both using explicit time integration schemes. For such a setup with a single global time step, the overall stability is governed by the most restrictive (i.e., the smallest) time step limit of the individual sub-problems. Therefore, the critical global time step is given by the minimum of the maximum stable time step for the fluid solver, $\\Delta t_{f}$, and the maximum stable time step for the structural solver, $\\Delta t_{s}$.\n$$\n\\Delta t_{\\mathrm{crit}} = \\min(\\Delta t_{f}, \\Delta t_{s})\n$$\n\nFirst, we determine the stability limit for the fluid solver. The problem specifies that the fluid dynamics are resolved using Large-Eddy Simulation (LES) with an explicit time integrator. The stability of such a scheme is governed by the Courant–Friedrichs–Lewy (CFL) condition, which relates the time step $\\Delta t_{f}$, the fluid velocity $U$, and the grid spacing $\\Delta$. The condition is given by:\n$$\nC_{\\mathrm{CFL},f} = \\frac{U \\Delta t_{f}}{\\Delta}\n$$\nThe simulation is stable if $C_{\\mathrm{CFL},f}$ is below a certain limit, provided as $C_{\\mathrm{CFL},f} = 0.5$. To find the maximum allowable time step, we use the most restrictive case, which involves the maximum velocity, $U_{\\max}$, and the minimum grid spacing, $\\Delta$.\nThe given values for the fluid side are:\n- Maximum resolved velocity: $U_{\\max} = 12 \\, \\mathrm{m/s}$\n- Minimum grid spacing: $\\Delta = 1.0 \\times 10^{-3} \\, \\mathrm{m}$\n- Fluid CFL limit: $C_{\\mathrm{CFL},f} = 0.5$\n\nRearranging the CFL condition to solve for the maximum allowable time step for the fluid solver, $\\Delta t_{f}$:\n$$\n\\Delta t_{f} \\le \\frac{C_{\\mathrm{CFL},f} \\cdot \\Delta}{U_{\\max}}\n$$\nSubstituting the given values:\n$$\n\\Delta t_{f} \\le \\frac{0.5 \\cdot (1.0 \\times 10^{-3} \\, \\mathrm{m})}{12 \\, \\mathrm{m/s}} = \\frac{5.0 \\times 10^{-4}}{12} \\, \\mathrm{s} \\approx 4.1667 \\times 10^{-5} \\, \\mathrm{s}\n$$\nSo, the maximum stable time step for the fluid solver is $\\Delta t_{f} = 4.166\\overline{6} \\times 10^{-5} \\, \\mathrm{s}$.\n\nNext, we determine the stability limit for the structural solver. The structure is a flexible plate modeled as a membrane, and its dynamics are solved using an explicit central difference scheme. The governing equation for a tensioned membrane is the wave equation. The stability of an explicit scheme for the wave equation is determined by a Courant-type condition. The speed of wave propagation, $c_s$, in the membrane must first be calculated. It is given by the formula:\n$$\nc_s = \\sqrt{\\frac{T}{\\rho_s t}}\n$$\nwhere $T$ is the in-plane tension per unit length, $\\rho_s$ is the mass density of the plate material, and $t$ is the plate thickness. Note that the product $\\rho_s t$ represents the mass per unit area of the membrane.\nThe given values for the structural side are:\n- Tension per unit length: $T = 1000 \\, \\mathrm{N/m}$\n- Plate thickness: $t = 1.0 \\times 10^{-3} \\, \\mathrm{m}$\n- Mass density: $\\rho_s = 1000 \\, \\mathrm{kg/m^3}$\n- Structural element size: $h_s = 5.0 \\times 10^{-3} \\, \\mathrm{m}$\n- Structural Courant limit: $C_{\\mathrm{Courant},s} = 0.9$\n\nWe calculate the wave speed $c_s$:\n$$\nc_s = \\sqrt{\\frac{1000 \\, \\mathrm{N/m}}{(1000 \\, \\mathrm{kg/m^3}) \\cdot (1.0 \\times 10^{-3} \\, \\mathrm{m})}} = \\sqrt{\\frac{1000}{1}} \\, \\mathrm{m/s} = \\sqrt{1000} \\, \\mathrm{m/s}\n$$\n$c_s = 10\\sqrt{10} \\, \\mathrm{m/s} \\approx 31.6228 \\, \\mathrm{m/s}$.\n\nThe Courant condition for the structural solver is:\n$$\nC_{\\mathrm{Courant},s} = \\frac{c_s \\Delta t_{s}}{h_s}\n$$\nFor stability, this value must not exceed the given limit, $C_{\\mathrm{Courant},s} = 0.9$. We rearrange to find the maximum allowable time step for the structural solver, $\\Delta t_{s}$:\n$$\n\\Delta t_{s} \\le \\frac{C_{\\mathrm{Courant},s} \\cdot h_s}{c_s}\n$$\nSubstituting the values:\n$$\n\\Delta t_{s} \\le \\frac{0.9 \\cdot (5.0 \\times 10^{-3} \\, \\mathrm{m})}{\\sqrt{1000} \\, \\mathrm{m/s}} = \\frac{4.5 \\times 10^{-3}}{\\sqrt{1000}} \\, \\mathrm{s} \\approx 1.423 \\times 10^{-4} \\, \\mathrm{s}\n$$\nSo, the maximum stable time step for the structural solver is $\\Delta t_{s} \\approx 1.423 \\times 10^{-4} \\, \\mathrm{s}$.\n\nFinally, we determine the critical global time step $\\Delta t_{\\mathrm{crit}}$ for the coupled system. This is the minimum of the two individual time step limits:\n$$\n\\Delta t_{\\mathrm{crit}} = \\min(\\Delta t_{f}, \\Delta t_{s})\n$$\n$$\n\\Delta t_{\\mathrm{crit}} = \\min(4.166\\overline{6} \\times 10^{-5} \\, \\mathrm{s}, \\, 1.423 \\times 10^{-4} \\, \\mathrm{s})\n$$\nComparing the two values, it is clear that the fluid solver imposes the stricter constraint on the time step.\n$$\n\\Delta t_{\\mathrm{crit}} = \\Delta t_{f} = 4.166\\overline{6} \\times 10^{-5} \\, \\mathrm{s}\n$$\nThe problem asks for the result to be expressed in microseconds ($\\mu\\mathrm{s}$) and rounded to four significant figures. We convert the unit from seconds to microseconds ($1 \\, \\mathrm{s} = 10^6 \\, \\mu\\mathrm{s}$):\n$$\n\\Delta t_{\\mathrm{crit}} = (4.166\\overline{6} \\times 10^{-5}) \\times 10^6 \\, \\mu\\mathrm{s} = 41.66\\overline{6} \\, \\mu\\mathrm{s}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta t_{\\mathrm{crit}} = 41.67 \\, \\mu\\mathrm{s}\n$$\nThis is the critical global time step that ensures the stability of both solvers in the loosely coupled FSI simulation.",
            "answer": "$$\n\\boxed{41.67}\n$$"
        },
        {
            "introduction": "Verifying the correctness of a complex multiphysics code is a formidable challenge, particularly at the interface where different physics domains exchange energy. This exercise introduces the Method of Manufactured Solutions (MMS), a powerful technique for rigorous code verification, applied here to a compressible FSI problem. You will implement a test to quantify the \"energy drift\" produced by different numerical schemes for the interface coupling, gaining direct insight into what makes a multiphysics algorithm physically consistent and robust. ",
            "id": "3509286",
            "problem": "Design and implement a self-contained verification program for an energy-consistent interface treatment in Large Eddy Simulation (LES) of a one-dimensional compressible fluid-structure interaction (FSI) model using the method of manufactured solutions. The goal is to compute a discrete energy drift over a single time step for two interface quadrature schemes and multiple parameter sets. All quantities are nondimensional, and all angles are in radians.\n\nThe coupled system is defined on a one-dimensional fluid domain $x \\in [0,1]$ with an interface at $x=0$ attached to a single-degree-of-freedom linear solid (mass-spring-damper). Use the following manufactured fields for the fluid density, velocity, and temperature, and a kinematically consistent interface displacement:\n- Fluid fields:\n  - $ \\rho(x,t) = \\rho_0 + \\epsilon_\\rho \\cos(2\\pi x)\\,\\sin(\\omega t) $,\n  - $ u(x,t) = U_0 \\cos(2\\pi x + \\psi)\\,\\cos(\\omega t) $,\n  - $ T(x,t) = T_0 + \\epsilon_T \\cos(2\\pi x)\\,\\sin(\\omega t + \\phi_T) $.\n- Interface displacement and velocity (enforced kinematic continuity with the fluid):\n  - $ \\eta(t) = \\dfrac{U_0 \\cos(\\psi)}{\\omega} \\sin(\\omega t) $,\n  - $ v_I(t) = \\dot{\\eta}(t) = U_0 \\cos(\\psi)\\,\\cos(\\omega t) $.\n\nAssume a calorically perfect gas with specific heat ratio $ \\gamma $, gas constant chosen so that $ p(x,t) = (\\gamma - 1)\\,\\rho(x,t)\\,T(x,t) $, and specific internal energy per unit mass $ e(x,t) = T(x,t) $. The total fluid energy is\n$$ E_f(t) = \\int_0^1 \\rho(x,t)\\,\\left(T(x,t) + \\tfrac{1}{2} u(x,t)^2\\right)\\,dx. $$\nThe solid has mass $ m $, linear stiffness $ k_s $, and linear viscous damping $ c $. Its total energy is\n$$ E_s(t) = \\tfrac{1}{2} m\\,v_I(t)^2 + \\tfrac{1}{2} k_s\\,\\eta(t)^2. $$\n\nAt the interface $x=0$, define the fluid normal traction transmitted to the solid as\n$$ \\tau(t) = -p(0,t) + 2\\,\\mu_{\\text{eff}}(t)\\,\\partial_x u(0,t), $$\nwhere the effective viscosity $ \\mu_{\\text{eff}}(t) = \\mu + \\mu_t(t) $ with molecular viscosity $ \\mu $ and the subgrid-scale eddy viscosity from the Smagorinsky model\n$$ \\mu_t(t) = \\rho(0,t)\\,\\left(C_s\\,\\Delta\\right)^2\\,\\left|\\partial_x u(0,t)\\right|. $$\nHere $ C_s $ is the Smagorinsky constant and $ \\Delta $ is the LES filter length. Use $ \\partial_x u(0,t) $ from the manufactured $ u(x,t) $.\n\nDefine the composite energy $ E_{\\text{tot}}(t) = E_f(t) + E_s(t) $ and its exact time derivative $ \\dfrac{d}{dt} E_{\\text{tot}}(t) $ by differentiating the manufactured fields. Define the continuum source term\n$$ S_{\\text{tot}}(t) = \\dfrac{d}{dt} E_{\\text{tot}}(t) - \\tau(t)\\,v_I(t), $$\nwhich represents all non-interface contributions to the composite energy rate (including volumetric forcing required by the manufactured solution and internal solid damping if modeled through $ E_s'(t) $). Over a single time step $ [t^n, t^{n+1}] $ of size $ \\Delta t $, define the discrete energy drift for a given quadrature choice as\n$$ \\delta = \\left(E_{\\text{tot}}(t^{n+1}) - E_{\\text{tot}}(t^n)\\right) - \\Delta t \\left[ \\mathcal{Q}\\{\\tau\\,v_I\\} + \\mathcal{Q}\\{S_{\\text{tot}}\\} \\right], $$\nwhere $ \\mathcal{Q}\\{\\cdot\\} $ denotes a chosen temporal quadrature applied over $ [t^n,t^{n+1}] $.\n\nTwo interface quadrature schemes must be considered:\n- Energy-consistent midpoint scheme: $ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^{n+\\frac{1}{2}})\\,v_I(t^{n+\\frac{1}{2}}) $ and $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $, where $ t^{n+\\frac{1}{2}} = \\tfrac{1}{2}(t^n + t^{n+1}) $.\n- Energy-inconsistent lagged product: $ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^n)\\,v_I(t^{n+1}) $ while still taking $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $.\n\nImplement a program that:\n- Evaluates $ E_f(t) $ and $ \\dfrac{d}{dt}E_f(t) $ by numerical quadrature in space using a sufficiently fine uniform grid over $ x \\in [0,1] $, and $ E_s(t) $ and $ \\dfrac{d}{dt}E_s(t) $ analytically from the manufactured $ \\eta(t) $ and $ v_I(t) $.\n- Evaluates $ \\tau(t) $ using the LES effective viscosity $ \\mu_{\\text{eff}}(t) $ defined above.\n- Computes $ S_{\\text{tot}}(t) $ and the discrete energy drift $ \\delta $ for a single time step using each specified scheme.\n\nUse the fixed parameter values (all nondimensional):\n- $ \\gamma = 1.4 $, $ \\rho_0 = 1.0 $, $ \\epsilon_\\rho = 0.1 $, $ U_0 = 0.5 $, $ \\psi = \\pi/4 $, $ T_0 = 1.0 $, $ \\epsilon_T = 0.07 $, $ \\phi_T = \\pi/3 $, $ \\omega = 3.0 $, $ \\mu = 0.01 $, $ m = 1.0 $, $ k_s = 0.5 $, $ c = 0.02 $, spatial wavenumber $ 2\\pi $, domain length $ 1.0 $, interface area $ 1.0 $. The initial time is fixed to $ t^n = 0.37 $.\n\nProvide a test suite consisting of the following parameter sets for a single time step $ \\Delta t $, Smagorinsky constant $ C_s $, filter length $ \\Delta $, and scheme identifier, in this exact order:\n- Case $ 1 $ (happy path): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.01, 0.1, 0.1, \\text{\"consistent\"}) $.\n- Case $ 2 $ (contrast): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.01, 0.1, 0.1, \\text{\"inconsistent\"}) $.\n- Case $ 3 $ (refinement): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.005, 0.1, 0.1, \\text{\"consistent\"}) $.\n- Case $ 4 $ (edge, no subgrid): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.01, 0.0, 0.1, \\text{\"consistent\"}) $.\n- Case $ 5 $ (high subgrid): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.02, 0.25, 0.2, \\text{\"consistent\"}) $.\n- Case $ 6 $ (large step, inconsistent): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.05, 0.1, 0.1, \\text{\"inconsistent\"}) $.\n\nYour program must output a single line containing a list of $ 6 $ floating-point values equal to the absolute discrete energy drift $ |\\delta| $ for each case, in the same order, printed as a comma-separated list enclosed in square brackets. For example, the output format must be of the form $ [r_1,r_2,r_3,r_4,r_5,r_6] $ with each $ r_i $ a float.\n\nAll computations must be carried out in nondimensional units, and all angles are in radians. No external input is allowed; the program must be fully self-contained and deterministic. Ensure numerical spatial integration is sufficiently resolved to avoid aliasing errors relative to the specified manufactured fields.",
            "solution": "We construct a verifiable energy drift metric for a multiphysics coupled system using the method of manufactured solutions, ensuring scientific realism and a principle-based derivation. The foundation consists of the conservation of energy for a compressible fluid and a linear elastic solid, and the definition of an energy-consistent interface work discretization. The algorithm computes the discrete energy drift for specified quadratures and parameters without solving the governing equations; instead, it directly evaluates manufactured fields.\n\nStep $ 1 $: Fundamental energy identities and manufactured fields.\n- For the fluid, the specific internal energy is $ e(x,t) = T(x,t) $, the pressure is $ p(x,t) = (\\gamma - 1)\\,\\rho(x,t)\\,T(x,t) $, and the total energy density per unit volume (nondimensional) is $ \\rho(x,t)\\left(e(x,t) + \\tfrac{1}{2}u(x,t)^2\\right) = \\rho(x,t)\\left(T(x,t) + \\tfrac{1}{2}u(x,t)^2\\right) $. Thus, the total fluid energy is\n$$ E_f(t) = \\int_{0}^{1} \\rho(x,t)\\left(T(x,t) + \\tfrac{1}{2}u(x,t)^2\\right)\\,dx. $$\n- The solid is a single-degree-of-freedom mass-spring-damper with mass $ m $, stiffness $ k_s $, and viscous damping $ c $ and kinematics constrained to the interface. The solid energy is\n$$ E_s(t) = \\tfrac{1}{2}m\\,v_I(t)^2 + \\tfrac{1}{2}k_s\\,\\eta(t)^2, $$\nwith $ v_I(t) = \\dot{\\eta}(t) $.\n\n- The manufactured fields are prescribed as smooth trigonometric functions:\n  - $ \\rho(x,t) = \\rho_0 + \\epsilon_\\rho \\cos(2\\pi x)\\,\\sin(\\omega t) $,\n  - $ u(x,t) = U_0 \\cos(2\\pi x + \\psi)\\,\\cos(\\omega t) $,\n  - $ T(x,t) = T_0 + \\epsilon_T \\cos(2\\pi x)\\,\\sin(\\omega t + \\phi_T) $.\n  These are sufficiently smooth and periodic, enabling high-order numerical integration in space.\n\n- The interface kinematics is enforced by setting $ \\eta(t) = \\dfrac{U_0 \\cos(\\psi)}{\\omega}\\sin(\\omega t) $, giving $ v_I(t) = U_0 \\cos(\\psi)\\cos(\\omega t) $. This ensures kinematic continuity $ u(0,t) = v_I(t) $ because $ u(0,t) = U_0 \\cos(\\psi)\\cos(\\omega t) $.\n\nStep $ 2 $: Interface traction with Large Eddy Simulation closure.\n- The normal traction (positive into the solid) is modeled as the one-dimensional compressible normal stress\n$$ \\tau(t) = -p(0,t) + 2\\,\\mu_{\\text{eff}}(t)\\,\\partial_x u(0,t), $$\nwhere $ \\mu_{\\text{eff}}(t) = \\mu + \\mu_t(t) $, and the Smagorinsky eddy viscosity is\n$$ \\mu_t(t) = \\rho(0,t)\\,(C_s \\Delta)^2\\,\\left|\\partial_x u(0,t)\\right|. $$\n- Using the manufactured velocity, $ \\partial_x u(x,t) = -2\\pi U_0 \\sin(2\\pi x + \\psi)\\,\\cos(\\omega t) $, hence $ \\partial_x u(0,t) = -2\\pi U_0 \\sin(\\psi)\\,\\cos(\\omega t) $. The interface pressure is $ p(0,t) = (\\gamma-1)\\,\\rho(0,t)\\,T(0,t) $ with $ \\rho(0,t) = \\rho_0 + \\epsilon_\\rho \\sin(\\omega t) $ and $ T(0,t) = T_0 + \\epsilon_T \\sin(\\omega t + \\phi_T) $.\n\nStep $ 3 $: Composite energy rate and source decomposition.\n- The composite energy is $ E_{\\text{tot}}(t) = E_f(t) + E_s(t) $. Its time derivative is\n$$ \\dfrac{d}{dt}E_{\\text{tot}}(t) = \\dfrac{d}{dt}E_f(t) + \\dfrac{d}{dt}E_s(t). $$\n- For the fluid, differentiate under the integral using the chain rule:\n$$ \\dfrac{d}{dt}\\left[\\rho\\left(T + \\tfrac{1}{2}u^2\\right)\\right] = \\dot{\\rho}\\left(T + \\tfrac{1}{2}u^2\\right) + \\rho\\left(\\dot{T} + u\\,\\dot{u}\\right), $$\nwhere overdots denote $ \\partial/\\partial t $. Each time derivative is obtained analytically from the manufactured fields:\n  - $ \\dot{\\rho}(x,t) = \\epsilon_\\rho \\cos(2\\pi x)\\,\\omega\\cos(\\omega t) $,\n  - $ \\dot{u}(x,t) = -U_0 \\cos(2\\pi x + \\psi)\\,\\omega\\sin(\\omega t) $,\n  - $ \\dot{T}(x,t) = \\epsilon_T \\cos(2\\pi x)\\,\\omega\\cos(\\omega t + \\phi_T) $.\nHence,\n$$ \\dfrac{d}{dt}E_f(t) = \\int_0^1 \\left[ \\dot{\\rho}\\left(T + \\tfrac{1}{2}u^2\\right) + \\rho\\left(\\dot{T} + u\\,\\dot{u}\\right) \\right] dx. $$\nThis integral is evaluated numerically in space using a sufficiently fine uniform grid over $ x \\in [0,1] $ to ensure accurate quadrature of trigonometric products.\n\n- For the solid,\n$$ \\dfrac{d}{dt}E_s(t) = m\\,v_I(t)\\,\\dot{v}_I(t) + k_s\\,\\eta(t)\\,v_I(t), $$\nwith $ v_I(t) = U_0 \\cos(\\psi)\\cos(\\omega t) $ and $ \\dot{v}_I(t) = -U_0 \\cos(\\psi)\\,\\omega \\sin(\\omega t) $.\n\n- The continuum source aggregation is defined by\n$$ S_{\\text{tot}}(t) = \\dfrac{d}{dt}E_{\\text{tot}}(t) - \\tau(t)\\,v_I(t). $$\nBy construction, this exactly enforces the continuum identity\n$$ \\dfrac{d}{dt}E_{\\text{tot}}(t) = \\tau(t)\\,v_I(t) + S_{\\text{tot}}(t). $$\nThis $ S_{\\text{tot}}(t) $ absorbs all non-interface energetic contributions implied by the manufactured solution (e.g., volumetric forcing, model dissipation). Its explicit evaluation uses the previously computed $ \\dfrac{d}{dt}E_{\\text{tot}}(t) $ and $ \\tau(t)\\,v_I(t) $.\n\nStep $ 4 $: Discrete energy drift over a single time step.\n- For a time step $ [t^n, t^{n+1}] $ of size $ \\Delta t $, define the discrete drift\n$$ \\delta = \\left(E_{\\text{tot}}(t^{n+1}) - E_{\\text{tot}}(t^n)\\right) - \\Delta t \\left[ \\mathcal{Q}\\{\\tau\\,v_I\\} + \\mathcal{Q}\\{S_{\\text{tot}}\\} \\right]. $$\n- Two quadratures are evaluated:\n  - Energy-consistent midpoint: $ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^{n+\\frac{1}{2}})\\,v_I(t^{n+\\frac{1}{2}}) $ and $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $, with $ t^{n+\\frac{1}{2}} = \\tfrac{1}{2}(t^n + t^{n+1}) $. This choice is known to be energy-consistent because, for smooth data, the midpoint rule approximates the integral with an error $ \\mathcal{O}(\\Delta t^3) $.\n  - Energy-inconsistent lagged product: $ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^n)\\,v_I(t^{n+1}) $ while retaining $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $. The product mismatch introduces an $ \\mathcal{O}(\\Delta t) $ error in general, producing a comparatively larger drift.\n\nStep $ 5 $: Algorithmic design.\n- Fix all physical and geometric parameters, and the initial time $ t^n = 0.37 $.\n- For each test case specifying $ (\\Delta t, C_s, \\Delta, \\text{scheme}) $:\n  - Compute $ t^{n+1} = t^n + \\Delta t $ and $ t^{n+\\frac{1}{2}} $.\n  - Compute $ E_f(t^n) $, $ E_f(t^{n+1}) $ by spatial quadrature of $ \\rho(T + \\tfrac{1}{2}u^2) $ with a high-resolution grid over $ x \\in [0,1] $.\n  - Compute $ \\dfrac{d}{dt}E_f(t) $ at $ t^{n+\\frac{1}{2}} $ by spatial quadrature of the time-derivative integrand using the manufactured time derivatives.\n  - Compute $ E_s(t^n) $, $ E_s(t^{n+1}) $ and $ \\dfrac{d}{dt}E_s(t^{n+\\frac{1}{2}}) $ analytically from the manufactured $ \\eta(t) $ and $ v_I(t) $.\n  - Assemble $ \\dfrac{d}{dt}E_{\\text{tot}}(t^{n+\\frac{1}{2}}) = \\dfrac{d}{dt}E_f(t^{n+\\frac{1}{2}}) + \\dfrac{d}{dt}E_s(t^{n+\\frac{1}{2}}) $.\n  - Evaluate interface quantities $ \\rho(0,t) $, $ T(0,t) $, $ \\partial_x u(0,t) $, $ p(0,t) $, $ \\mu_t(t) $, $ \\mu_{\\text{eff}}(t) $, and thus $ \\tau(t) $ at $ t^n $, $ t^{n+1} $, and $ t^{n+\\frac{1}{2}} $.\n  - Form $ S_{\\text{tot}}(t^{n+\\frac{1}{2}}) = \\dfrac{d}{dt}E_{\\text{tot}}(t^{n+\\frac{1}{2}}) - \\tau(t^{n+\\frac{1}{2}})\\,v_I(t^{n+\\frac{1}{2}}) $.\n  - Compute the drift $ \\delta $ using either the consistent or inconsistent quadrature rule defined above.\n  - Report the absolute value $ |\\delta| $.\n\nStep $ 6 $: Test suite and expected behaviors.\n- The six prescribed cases vary $ \\Delta t $, $ C_s $, and $ \\Delta $ as follows (in order): $ (0.01,0.1,0.1,\\text{\"consistent\"}) $, $ (0.01,0.1,0.1,\\text{\"inconsistent\"}) $, $ (0.005,0.1,0.1,\\text{\"consistent\"}) $, $ (0.01,0.0,0.1,\\text{\"consistent\"}) $, $ (0.02,0.25,0.2,\\text{\"consistent\"}) $, $ (0.05,0.1,0.1,\\text{\"inconsistent\"}) $.\n- The energy-consistent midpoint cases should yield significantly smaller drifts and exhibit an approximate $ \\mathcal{O}(\\Delta t^3) $ dependence, evidenced by a notable reduction in $ |\\delta| $ when halving $ \\Delta t $. The energy-inconsistent cases should display much larger drifts, approximately scaling with $ \\mathcal{O}(\\Delta t^2) $.\n- Changing $ C_s $ and $ \\Delta $ alters $ \\mu_t(t) $ and thereby the interface traction magnitude $ \\tau(t) $, which proportionally affects the absolute interface power and thus the magnitude of any drift produced by a mismatched quadrature.\n\nThe complete Python program to perform this verification is as follows:\n```python\nimport numpy as np\n\n# All computations are nondimensional; angles in radians.\n\ndef manufactured_fields_params():\n    gamma = 1.4\n    rho0 = 1.0\n    eps_rho = 0.1\n    U0 = 0.5\n    psi = np.pi / 4.0\n    T0 = 1.0\n    eps_T = 0.07\n    phi_T = np.pi / 3.0\n    omega = 3.0\n    mu = 0.01\n    m = 1.0\n    k_s = 0.5\n    c_damp = 0.02  # damping is part of the solid model, but energy balance is via E_s' and tau*v + S_tot\n    L = 1.0\n    k_wave = 2.0 * np.pi  # spatial wave number\n    return {\n        \"gamma\": gamma, \"rho0\": rho0, \"eps_rho\": eps_rho, \"U0\": U0, \"psi\": psi,\n        \"T0\": T0, \"eps_T\": eps_T, \"phi_T\": phi_T, \"omega\": omega, \"mu\": mu,\n        \"m\": m, \"k_s\": k_s, \"c\": c_damp, \"L\": L, \"k_wave\": k_wave\n    }\n\ndef rho_xt(x, t, pars):\n    return pars[\"rho0\"] + pars[\"eps_rho\"] * np.cos(pars[\"k_wave\"] * x) * np.sin(pars[\"omega\"] * t)\n\ndef u_xt(x, t, pars):\n    return pars[\"U0\"] * np.cos(pars[\"k_wave\"] * x + pars[\"psi\"]) * np.cos(pars[\"omega\"] * t)\n\ndef T_xt(x, t, pars):\n    return pars[\"T0\"] + pars[\"eps_T\"] * np.cos(pars[\"k_wave\"] * x) * np.sin(pars[\"omega\"] * t + pars[\"phi_T\"])\n\ndef rho_t_xt(x, t, pars):\n    return pars[\"eps_rho\"] * np.cos(pars[\"k_wave\"] * x) * pars[\"omega\"] * np.cos(pars[\"omega\"] * t)\n\ndef u_t_xt(x, t, pars):\n    return -pars[\"U0\"] * np.cos(pars[\"k_wave\"] * x + pars[\"psi\"]) * pars[\"omega\"] * np.sin(pars[\"omega\"] * t)\n\ndef T_t_xt(x, t, pars):\n    return pars[\"eps_T\"] * np.cos(pars[\"k_wave\"] * x) * pars[\"omega\"] * np.cos(pars[\"omega\"] * t + pars[\"phi_T\"])\n\ndef eta_t(t, pars):\n    # v_I(t) = d eta / dt = U0 cos(psi) cos(omega t)\n    return pars[\"U0\"] * np.cos(pars[\"psi\"]) * np.cos(pars[\"omega\"] * t)\n\ndef eta_xt(t, pars):\n    # eta(t) = (U0 cos(psi) / omega) sin(omega t)\n    return (pars[\"U0\"] * np.cos(pars[\"psi\"]) / pars[\"omega\"]) * np.sin(pars[\"omega\"] * t)\n\ndef eta_tt(t, pars):\n    # d^2 eta / dt^2 = - U0 cos(psi) * omega * sin(omega t)\n    return -pars[\"U0\"] * np.cos(pars[\"psi\"]) * pars[\"omega\"] * np.sin(pars[\"omega\"] * t)\n\ndef dudx_at_interface(t, pars):\n    # du/dx at x=0\n    return -pars[\"k_wave\"] * pars[\"U0\"] * np.sin(pars[\"psi\"]) * np.cos(pars[\"omega\"] * t)\n\ndef p_at_interface(t, pars):\n    rho = rho_xt(0.0, t, pars)\n    T = T_xt(0.0, t, pars)\n    gamma = pars[\"gamma\"]\n    return (gamma - 1.0) * rho * T\n\ndef tau_at_interface(t, pars, Cs, Delta):\n    # Effective viscosity mu_eff = mu + mu_t, mu_t = rho * (Cs * Delta)^2 * |du/dx|\n    rho = rho_xt(0.0, t, pars)\n    dudx = dudx_at_interface(t, pars)\n    mu_t = rho * (Cs * Delta) ** 2 * abs(dudx)\n    mu_eff = pars[\"mu\"] + mu_t\n    return -p_at_interface(t, pars) + 2.0 * mu_eff * dudx\n\ndef v_interface(t, pars):\n    return eta_t(t, pars)\n\ndef Ef(t, pars, Nx=8192):\n    # Spatial quadrature over x in [0,1] using trapezoidal rule\n    x = np.linspace(0.0, 1.0, Nx, endpoint=True)\n    rho = rho_xt(x, t, pars)\n    u = u_xt(x, t, pars)\n    T = T_xt(x, t, pars)\n    integrand = rho * (T + 0.5 * u * u)\n    return np.trapz(integrand, x)\n\ndef Ef_prime(t, pars, Nx=8192):\n    x = np.linspace(0.0, 1.0, Nx, endpoint=True)\n    rho = rho_xt(x, t, pars)\n    u = u_xt(x, t, pars)\n    T = T_xt(x, t, pars)\n    rho_t = rho_t_xt(x, t, pars)\n    u_t = u_t_xt(x, t, pars)\n    T_t = T_t_xt(x, t, pars)\n    integrand_dt = rho_t * (T + 0.5 * u * u) + rho * (T_t + u * u_t)\n    return np.trapz(integrand_dt, x)\n\ndef Es(t, pars):\n    v = eta_t(t, pars)\n    eta = eta_xt(t, pars)\n    return 0.5 * pars[\"m\"] * v * v + 0.5 * pars[\"k_s\"] * eta * eta\n\ndef Es_prime(t, pars):\n    v = eta_t(t, pars)\n    a = eta_tt(t, pars)\n    eta = eta_xt(t, pars)\n    return pars[\"m\"] * v * a + pars[\"k_s\"] * eta * v\n\ndef E_total(t, pars, Nx=8192):\n    return Ef(t, pars, Nx=Nx) + Es(t, pars)\n\ndef E_total_prime(t, pars, Nx=8192):\n    return Ef_prime(t, pars, Nx=Nx) + Es_prime(t, pars)\n\ndef S_total(t, pars, Cs, Delta, Nx=8192):\n    # S_tot = dE_tot/dt - tau * v_I\n    return E_total_prime(t, pars, Nx=Nx) - tau_at_interface(t, pars, Cs, Delta) * v_interface(t, pars)\n\ndef discrete_energy_drift(dt, Cs, Delta, scheme, t_n, pars, Nx=8192):\n    t_np1 = t_n + dt\n    t_mid = t_n + 0.5 * dt\n    # Exact energy change from manufactured fields via spatial quadrature\n    dE = E_total(t_np1, pars, Nx=Nx) - E_total(t_n, pars, Nx=Nx)\n    # Quadrature for tau*v\n    if scheme == \"consistent\":\n        q_tau_v = tau_at_interface(t_mid, pars, Cs, Delta) * v_interface(t_mid, pars)\n    elif scheme == \"inconsistent\":\n        q_tau_v = tau_at_interface(t_n, pars, Cs, Delta) * v_interface(t_np1, pars)\n    else:\n        raise ValueError(\"Unknown scheme\")\n    # Quadrature for S_tot: always midpoint for this study\n    q_S = S_total(t_mid, pars, Cs, Delta, Nx=Nx)\n    drift = dE - dt * (q_tau_v + q_S)\n    return abs(drift)\n\ndef solve():\n    pars = manufactured_fields_params()\n    # Test suite as specified\n    t_n = 0.37\n    test_cases = [\n        (0.01, 0.1, 0.1, \"consistent\"),\n        (0.01, 0.1, 0.1, \"inconsistent\"),\n        (0.005, 0.1, 0.1, \"consistent\"),\n        (0.01, 0.0, 0.1, \"consistent\"),\n        (0.02, 0.25, 0.2, \"consistent\"),\n        (0.05, 0.1, 0.1, \"inconsistent\"),\n    ]\n    # High spatial resolution to accurately integrate trigonometric products\n    Nx = 8192\n    results = []\n    for dt, Cs, Delta, scheme in test_cases:\n        drift = discrete_energy_drift(dt, Cs, Delta, scheme, t_n, pars, Nx=Nx)\n        # Format as scientific string with sufficient significant figures\n        results.append(np.format_float_scientific(drift, precision=10, unique=False, exp_digits=2))\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```\nThe program must be fully self-contained and deterministic, which it is. Its execution yields the required list of 6 floating-point values for the absolute discrete energy drift $|\\delta|$.",
            "answer": "$$\\boxed{[1.6558485293e-08, 8.2770281206e-04, 2.0694856403e-09, 1.6111831826e-08, 7.3999948092e-08, 2.0692025178e-02]}$$"
        }
    ]
}