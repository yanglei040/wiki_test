{
    "hands_on_practices": [
        {
            "introduction": "在分区、显式多物理场仿真中，整体的数值稳定性取决于约束最严格的子问题。本练习提供了一个来自流固耦合（FSI）的具体例子，要求您基于流体Courant-Friedrichs-Lewy（CFL）条件和结构Courant条件计算全局时间步长。这是成功设置任何稳定耦合模拟的基本第一步。",
            "id": "3509332",
            "problem": "一块柔性张紧板浸没在不可压缩的湍流管道流中，该流动在多物理场流固耦合框架内使用大涡模拟 (LES) 进行解析。耦合通过采用单一全局时间步长的松耦合分区算法执行。流体求解器使用显式时间积分器，结构求解器对板的膜模型使用显式中心差分。密度比为1，即 $\\rho_{s}/\\rho_{f} = 1$。流动和结构采用以下参数进行离散化：\n\n- 流体侧 (LES)：最大解析速度 $U_{\\max} = 12\\,\\mathrm{m/s}$，最小网格间距 $\\Delta = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，以及流体 Courant–Friedrichs–Lewy (CFL) 极限 $C_{\\mathrm{CFL},f} = 0.5$。\n- 结构侧 (膜板)：单位长度的面内张力 $T = 1000\\,\\mathrm{N/m}$，板厚 $t = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，质量密度 $\\rho_{f} = \\rho_{s} = 1000\\,\\mathrm{kg/m^{3}}$ (根据给定比率)，结构单元尺寸 $h_{s} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$，以及结构 Courant 极限 $C_{\\mathrm{Courant},s} = 0.9$。\n\n从不可压缩 Navier–Stokes 方程及其由流体 CFL 条件表示的显式时间离散稳定性要求出发，并从膜波动方程及其由结构 Courant 条件表示的显式稳定性出发，推导出在松耦合分区下确保两个求解器稳定性的临界全局时间步长 $\\Delta t_{\\mathrm{crit}}$。使用上述数据计算其值。\n\n将最终时间步长以微秒表示，并将答案四舍五入到四位有效数字。",
            "solution": "问题要求为一个松耦合分区的流固耦合 (FSI) 模拟找到临界全局时间步长 $\\Delta t_{\\mathrm{crit}}$。这个临界时间步长是确保流体和结构两个求解器数值稳定性的最大值，这两个求解器都使用显式时间积分方案。对于这种采用单一全局时间步长的设置，整体稳定性由各个子问题中最严格（即最小）的时间步长限制决定。因此，临界全局时间步长由流体求解器的最大稳定时间步长 $\\Delta t_{f}$ 和结构求解器的最大稳定时间步长 $\\Delta t_{s}$ 的最小值给出。\n$$\n\\Delta t_{\\mathrm{crit}} = \\min(\\Delta t_{f}, \\Delta t_{s})\n$$\n\n首先，我们确定流体求解器的稳定性极限。问题指明流体动力学是使用大涡模拟 (LES) 和显式时间积分器来解析的。这种方案的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定，该条件关联了时间步长 $\\Delta t_{f}$、流体速度 $U$ 和网格间距 $\\Delta$。该条件由下式给出：\n$$\nC_{\\mathrm{CFL},f} = \\frac{U \\Delta t_{f}}{\\Delta}\n$$\n如果 $C_{\\mathrm{CFL},f}$ 低于给定的极限值 $C_{\\mathrm{CFL},f} = 0.5$，则模拟是稳定的。为了找到最大允许时间步长，我们使用最严格的情况，即涉及最大速度 $U_{\\max}$ 和最小网格间距 $\\Delta$。\n流体侧的给定值为：\n- 最大解析速度: $U_{\\max} = 12 \\, \\mathrm{m/s}$\n- 最小网格间距: $\\Delta = 1.0 \\times 10^{-3} \\, \\mathrm{m}$\n- 流体 CFL 极限: $C_{\\mathrm{CFL},f} = 0.5$\n\n重新整理 CFL 条件以求解流体求解器的最大允许时间步长 $\\Delta t_{f}$：\n$$\n\\Delta t_{f} \\le \\frac{C_{\\mathrm{CFL},f} \\cdot \\Delta}{U_{\\max}}\n$$\n代入给定值：\n$$\n\\Delta t_{f} \\le \\frac{0.5 \\cdot (1.0 \\times 10^{-3} \\, \\mathrm{m})}{12 \\, \\mathrm{m/s}} = \\frac{5.0 \\times 10^{-4}}{12} \\, \\mathrm{s} \\approx 4.1667 \\times 10^{-5} \\, \\mathrm{s}\n$$\n所以，流体求解器的最大稳定时间步长为 $\\Delta t_{f} = 4.166\\overline{6} \\times 10^{-5} \\, \\mathrm{s}$。\n\n接下来，我们确定结构求解器的稳定性极限。该结构是一个建模为膜的柔性板，其动力学通过显式中心差分方案求解。张紧膜的控制方程是波动方程。波动方程的显式方案的稳定性由一个 Courant 型条件确定。必须首先计算膜中的波速 $c_s$。它由以下公式给出：\n$$\nc_s = \\sqrt{\\frac{T}{\\rho_s t}}\n$$\n其中 $T$ 是单位长度的面内张力，$\\rho_s$ 是板材料的质量密度，而 $t$ 是板的厚度。注意，乘积 $\\rho_s t$ 代表膜的单位面积质量。\n结构侧的给定值为：\n- 单位长度张力: $T = 1000 \\, \\mathrm{N/m}$\n- 板厚: $t = 1.0 \\times 10^{-3} \\, \\mathrm{m}$\n- 质量密度: $\\rho_s = 1000 \\, \\mathrm{kg/m^3}$\n- 结构单元尺寸: $h_s = 5.0 \\times 10^{-3} \\, \\mathrm{m}$\n- 结构 Courant 极限: $C_{\\mathrm{Courant},s} = 0.9$\n\n我们计算波速 $c_s$：\n$$\nc_s = \\sqrt{\\frac{1000 \\, \\mathrm{N/m}}{(1000 \\, \\mathrm{kg/m^3}) \\cdot (1.0 \\times 10^{-3} \\, \\mathrm{m})}} = \\sqrt{\\frac{1000}{1}} \\, \\mathrm{m/s} = \\sqrt{1000} \\, \\mathrm{m/s}\n$$\n$c_s = 10\\sqrt{10} \\, \\mathrm{m/s} \\approx 31.6228 \\, \\mathrm{m/s}$。\n\n结构求解器的 Courant 条件是：\n$$\nC_{\\mathrm{Courant},s} = \\frac{c_s \\Delta t_{s}}{h_s}\n$$\n为保证稳定性，该值不得超过给定的极限 $C_{\\mathrm{Courant},s} = 0.9$。我们重新整理公式以求得结构求解器的最大允许时间步长 $\\Delta t_{s}$：\n$$\n\\Delta t_{s} \\le \\frac{C_{\\mathrm{Courant},s} \\cdot h_s}{c_s}\n$$\n代入数值：\n$$\n\\Delta t_{s} \\le \\frac{0.9 \\cdot (5.0 \\times 10^{-3} \\, \\mathrm{m})}{\\sqrt{1000} \\, \\mathrm{m/s}} = \\frac{4.5 \\times 10^{-3}}{\\sqrt{1000}} \\, \\mathrm{s} \\approx 1.423 \\times 10^{-4} \\, \\mathrm{s}\n$$\n因此，结构求解器的最大稳定时间步长为 $\\Delta t_{s} \\approx 1.423 \\times 10^{-4} \\, \\mathrm{s}$。\n\n最后，我们确定耦合系统的临界全局时间步长 $\\Delta t_{\\mathrm{crit}}$。这是两个独立时间步长限制的最小值：\n$$\n\\Delta t_{\\mathrm{crit}} = \\min(\\Delta t_{f}, \\Delta t_{s})\n$$\n$$\n\\Delta t_{\\mathrm{crit}} = \\min(4.166\\overline{6} \\times 10^{-5} \\, \\mathrm{s}, \\, 1.423 \\times 10^{-4} \\, \\mathrm{s})\n$$\n比较这两个值，很明显流体求解器对时间步长施加了更严格的约束。\n$$\n\\Delta t_{\\mathrm{crit}} = \\Delta t_{f} = 4.166\\overline{6} \\times 10^{-5} \\, \\mathrm{s}\n$$\n问题要求将结果以微秒 ($\\mu\\mathrm{s}$) 表示，并四舍五入到四位有效数字。我们将单位从秒转换为微秒 ($1 \\, \\mathrm{s} = 10^6 \\, \\mu\\mathrm{s}$):\n$$\n\\Delta t_{\\mathrm{crit}} = (4.166\\overline{6} \\times 10^{-5}) \\times 10^6 \\, \\mu\\mathrm{s} = 41.66\\overline{6} \\, \\mu\\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\mathrm{crit}} = 41.67 \\, \\mu\\mathrm{s}\n$$\n这就是在松耦合 FSI 模拟中确保两个求解器稳定性的临界全局时间步长。",
            "answer": "$$\n\\boxed{41.67}\n$$"
        },
        {
            "introduction": "高保真大涡模拟（LES）通常无法承担解析壁面附近所有微小尺度的计算成本，因此需要壁面模型。本练习将深入探讨近壁区域的物理学，指导您从第一性原理（动量平衡和混合长度理论）推导出一个壁面应力模型，并将其与已解析的LES数据联系起来，这揭示了物理建模和数值数据之间的关键相互作用。",
            "id": "3509370",
            "problem": "一种处于均匀温度下的可压缩流体是共轭传热模拟的一部分，但在所关注的时间窗口内，温度实际上是均匀的，因此动力粘度为常数，流动可以被建模为具有恒定运动粘度的不可压缩流。考虑一个光滑平直壁面上方统计定常、充分发展的湍流边界层，该边界层通过大涡模拟 (LES) 计算得出。你将构建一个近壁平衡壁面应力模型，该模型利用离壁最近两个网格单元上的平均速度重构，返回一个与解析出的剪切相符的摩擦速度 $u_{\\tau}$。\n\n从滤波后的不可压缩 Navier–Stokes 方程出发，假设以下在近壁平衡壁面应力建模中为标准的建模和物理假设：\n- 在近壁控制层内，流动是统计定常的，且流向压力梯度可忽略，因此在邻近壁面的平衡层中，总剪切应力的壁面法向导数近似为零。\n- 在壁面法向位置 $y$ 处的总平均剪切应力可以表示为粘性贡献和湍流贡献之和，其中湍流部分通过涡粘性封闭模型进行建模。\n- 涡粘性由带有 van Driest 阻尼的 Prandtl 混合长度假设给出；对于本问题，假设在离壁最近的第一个网格单元上阻尼完全饱和，因此阻尼因子实际上为 1。于是，混合长度简化为 $l_{m}=\\kappa y$，其中 $\\kappa$ 是 von Kármán 常数。\n\n为使模型与解析出的 LES 场一致，通过对穿过无滑移壁面点的平均速度剖面进行线性最小二乘重构，来估计离壁最近第一个位置 $y_1$ 处的平均剪切。具体来说，使用离壁最近的两个网格中心值，对点 $(0,0)$、$(y_{1},U_{1})$ 和 $(y_{2},U_{2})$ 以最小二乘法拟合 $U(y)\\approx a\\,y$，其中 $U(y)$ 是平均流向速度。使用得到的斜率 $a$ 作为平均剪切的估计值，即 $\\left.\\frac{dU}{dy}\\right|_{y_{1}}\\approx a$。\n\n使用上述假设和近壁平衡动量平衡，推导一个用重构剪切 $a$、运动粘度 $\\nu$、von Kármán 常数 $\\kappa$ 和 $y_{1}$ 表示的摩擦速度 $u_{\\tau}$ 的表达式。然后，使用以下数据对 $u_{\\tau}$ 进行数值计算：\n- $y_{1}=0.004\\ \\mathrm{m}$,\n- $y_{2}=0.012\\ \\mathrm{m}$,\n- $U_{1}=3.00\\ \\mathrm{m/s}$,\n- $U_{2}=5.50\\ \\mathrm{m/s}$,\n- $\\nu=1.5\\times 10^{-5}\\ \\mathrm{m^{2}/s}$,\n- $\\kappa=0.41$.\n\n将摩擦速度的最终答案以 $\\mathrm{m/s}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "目标是使用近壁平衡模型求出摩擦速度 $u_{\\tau}$。求解过程需要几个步骤：首先，使用最小二乘拟合根据给定的网格中心速度确定平均速度梯度；其次，建立包含指定湍流模型的平衡动量平衡方程；第三，求解得到的方程以获得 $u_{\\tau}$。\n\n首先，我们确定线性速度剖面 $U(y) = ay$ 的斜率 $a$，该剖面对数据点 $(y_i, U_i)$ 提供了最小二乘意义下的最佳拟合。给定的点是 $(0,0)$、$(y_{1}, U_{1})$ 和 $(y_{2}, U_{2})$。误差平方和 $S$ 由下式给出：\n$$S(a) = \\sum_{i=0}^{2} (U_{i} - a y_{i})^{2} = (U_{0} - a y_{0})^{2} + (U_{1} - a y_{1})^{2} + (U_{2} - a y_{2})^{2}$$\n鉴于 $(y_{0}, U_{0}) = (0,0)$，表达式简化为：\n$$S(a) = (U_{1} - a y_{1})^{2} + (U_{2} - a y_{2})^{2}$$\n为最小化误差，我们将 $S$ 对 $a$ 的导数设为零：\n$$\\frac{dS}{da} = 2(U_{1} - a y_{1})(-y_{1}) + 2(U_{2} - a y_{2})(-y_{2}) = 0$$\n$$-U_{1}y_{1} + a y_{1}^{2} - U_{2}y_{2} + a y_{2}^{2} = 0$$\n求解 $a$，我们得到重构的平均速度梯度的表达式：\n$$a(y_{1}^{2} + y_{2}^{2}) = U_{1}y_{1} + U_{2}y_{2}$$\n$$a = \\frac{U_{1}y_{1} + U_{2}y_{2}}{y_{1}^{2} + y_{2}^{2}}$$\n这个 $a$ 值将用作离壁最近第一个位置处平均剪切的估计值，即 $\\left.\\frac{dU}{dy}\\right|_{y_{1}} \\approx a$。\n\n接下来，我们在近壁平衡层中建立动量平衡。核心假设是总剪切应力 $\\tau_{\\text{total}}$ 在壁面法向方向上是恒定的，且等于壁面剪切应力 $\\tau_{w}$。\n$$\\tau_{\\text{total}} = \\tau_{w}$$\n摩擦速度 $u_{\\tau}$ 由 $\\tau_{w} = \\rho u_{\\tau}^{2}$ 定义，其中 $\\rho$ 是流体密度。因此：\n$$\\tau_{\\text{total}} = \\rho u_{\\tau}^{2}$$\n总剪切应力是粘性应力和湍流（雷诺）应力之和，后者使用涡粘性 $\\nu_{t}$ 进行建模：\n$$\\tau_{\\text{total}} = \\rho(\\nu + \\nu_{t}) \\frac{dU}{dy}$$\n其中 $\\nu$ 是运动粘度。将 $\\tau_{\\text{total}}$ 的两个表达式相等并除以 $\\rho$ 得到：\n$$u_{\\tau}^{2} = (\\nu + \\nu_{t}) \\frac{dU}{dy}$$\n问题指定使用 Prandtl 混合长度模型来计算涡粘性，混合长度为 $l_{m} = \\kappa y$，其中 $\\kappa$ 是 von Kármán 常数。因此，涡粘性为：\n$$\\nu_{t} = l_{m}^{2} \\left| \\frac{dU}{dy} \\right| = (\\kappa y)^{2} \\frac{dU}{dy}$$\n对于边界层速度剖面，我们假设 $\\frac{dU}{dy} > 0$。\n\n现在，我们在离壁最近的第一个位置 $y=y_1$ 处评估平衡关系：\n$$u_{\\tau}^{2} = \\left(\\nu + \\nu_{t}|_{y_{1}}\\right) \\left.\\frac{dU}{dy}\\right|_{y_{1}}$$\n代入 $\\nu_{t}|_{y_{1}}$ 和 $\\left.\\frac{dU}{dy}\\right|_{y_{1}} \\approx a$ 的表达式：\n$$\\nu_{t}|_{y_{1}} = (\\kappa y_{1})^{2} a$$\n因此，$u_{\\tau}^{2}$ 的方程变为：\n$$u_{\\tau}^{2} = (\\nu + (\\kappa y_{1})^{2} a) a = \\nu a + (\\kappa y_{1} a)^{2}$$\n这是 $u_{\\tau}^{2}$ 的最终符号表达式。摩擦速度为：\n$$u_{\\tau} = \\sqrt{\\nu a + (\\kappa y_{1} a)^{2}}$$\n\n我们现在代入给定的数值来计算 $u_{\\tau}$。数据如下：\n$y_{1} = 0.004 \\ \\mathrm{m}$\n$y_{2} = 0.012 \\ \\mathrm{m}$\n$U_{1} = 3.00 \\ \\mathrm{m/s}$\n$U_{2} = 5.50 \\ \\mathrm{m/s}$\n$\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^{2}/s}$\n$\\kappa = 0.41$\n\n首先，计算重构的剪切 $a$：\n$$a = \\frac{(3.00)(0.004) + (5.50)(0.012)}{(0.004)^{2} + (0.012)^{2}} = \\frac{0.012 + 0.066}{0.000016 + 0.000144} = \\frac{0.078}{0.000160} = 487.5 \\ \\mathrm{s^{-1}}$$\n现在，计算 $u_{\\tau}^{2}$ 表达式中的两项：\n对（缩放后的）应力的粘性贡献是：\n$$\\nu a = (1.5 \\times 10^{-5}) (487.5) = 0.0073125 \\ \\mathrm{m^{2}/s^{2}}$$\n湍流速度尺度是：\n$$\\kappa y_{1} a = (0.41)(0.004)(487.5) = 0.7995 \\ \\mathrm{m/s}$$\n对（缩放后的）应力的湍流贡献是该值的平方：\n$$(\\kappa y_{1} a)^{2} = (0.7995)^{2} = 0.63920025 \\ \\mathrm{m^{2}/s^{2}}$$\n现在，我们通过将各项贡献相加来求 $u_{\\tau}^{2}$：\n$$u_{\\tau}^{2} = 0.0073125 + 0.63920025 = 0.64651275 \\ \\mathrm{m^{2}/s^{2}}$$\n最后，我们取平方根来求 $u_{\\tau}$：\n$$u_{\\tau} = \\sqrt{0.64651275} \\approx 0.80406016... \\ \\mathrm{m/s}$$\n根据问题陈述的要求，四舍五入到四位有效数字：\n$$u_{\\tau} \\approx 0.8041 \\ \\mathrm{m/s}$$\n求解完毕。",
            "answer": "$$\\boxed{0.8041}$$"
        },
        {
            "introduction": "确保跨多物理场界面的能量守恒对于高保真模拟的长期准确性和稳定性至关重要。这个高级练习使用强大的制造解方法（MMS）为一个可压缩流固耦合问题创建了一个验证测试。通过比较不同界面功计算的数值格式，您将能够量化“能量漂移”，并理解为何特定的“能量一致性”格式是保证模拟物理真实性的关键。",
            "id": "3509286",
            "problem": "使用人工解方法，为一维可压缩流固耦合（FSI）模型的大涡模拟（LES）中的能量守恒界面处理方法，设计并实现一个自洽的验证程序。其目标是针对两种界面求积格式和多组参数集，计算单个时间步内的离散能量漂移。所有物理量均为无量纲，所有角度均以弧度为单位。\n\n该耦合系统定义在一个一维流体域 $x \\in [0,1]$ 上，在 $x=0$ 处有一个界面，该界面连接到一个单自由度线性固体（质量-弹簧-阻尼系统）。使用以下人工场来表示流体密度、速度、温度，以及一个运动学上一致的界面位移：\n- 流体场：\n  - $ \\rho(x,t) = \\rho_0 + \\epsilon_\\rho \\cos(2\\pi x)\\,\\sin(\\omega t) $,\n  - $ u(x,t) = U_0 \\cos(2\\pi x + \\psi)\\,\\cos(\\omega t) $,\n  - $ T(x,t) = T_0 + \\epsilon_T \\cos(2\\pi x)\\,\\sin(\\omega t + \\phi_T) $。\n- 界面位移和速度（与流体强制保持运动学连续性）：\n  - $ \\eta(t) = \\dfrac{U_0 \\cos(\\psi)}{\\omega} \\sin(\\omega t) $,\n  - $ v_I(t) = \\dot{\\eta}(t) = U_0 \\cos(\\psi)\\,\\cos(\\omega t) $。\n\n假设为量热完全气体，其比热比为 $ \\gamma $，气体常数的选取使得 $ p(x,t) = (\\gamma - 1)\\,\\rho(x,t)\\,T(x,t) $，单位质量的比内能为 $ e(x,t) = T(x,t) $。流体总能量为\n$$ E_f(t) = \\int_0^1 \\rho(x,t)\\,\\left(T(x,t) + \\tfrac{1}{2} u(x,t)^2\\right)\\,dx. $$\n固体质量为 $ m $，线性刚度为 $ k_s $，线性粘性阻尼为 $ c $。其总能量为\n$$ E_s(t) = \\tfrac{1}{2} m\\,v_I(t)^2 + \\tfrac{1}{2} k_s\\,\\eta(t)^2. $$\n\n在界面 $x=0$ 处，定义传递给固体的流体法向牵引力为\n$$ \\tau(t) = -p(0,t) + 2\\,\\mu_{\\text{eff}}(t)\\,\\partial_x u(0,t), $$\n其中有效粘度 $ \\mu_{\\text{eff}}(t) = \\mu + \\mu_t(t) $，包含分子粘度 $ \\mu $ 和来自 Smagorinsky 模型的亚格子尺度涡粘度\n$$ \\mu_t(t) = \\rho(0,t)\\,\\left(C_s\\,\\Delta\\right)^2\\,\\left|\\partial_x u(0,t)\\right|. $$\n此处 $ C_s $ 是 Smagorinsky 常数，$ \\Delta $ 是 LES 滤波长度。使用来自人工解 $ u(x,t) $ 的 $ \\partial_x u(0,t) $。\n\n通过对人工场求导，定义复合能量 $ E_{\\text{tot}}(t) = E_f(t) + E_s(t) $ 及其精确时间导数 $ \\dfrac{d}{dt} E_{\\text{tot}}(t) $。定义连续介质源项\n$$ S_{\\text{tot}}(t) = \\dfrac{d}{dt} E_{\\text{tot}}(t) - \\tau(t)\\,v_I(t), $$\n该项代表对复合能量变化率的所有非界面贡献（包括人工解所必需的体积力，以及如果通过 $ E_s'(t) $ 建模的内部固体阻尼）。在大小为 $ \\Delta t $ 的单个时间步 $ [t^n, t^{n+1}] $ 内，对于给定的求积选择，将离散能量漂移定义为\n$$ \\delta = \\left(E_{\\text{tot}}(t^{n+1}) - E_{\\text{tot}}(t^n)\\right) - \\Delta t \\left[ \\mathcal{Q}\\{\\tau\\,v_I\\} + \\mathcal{Q}\\{S_{\\text{tot}}\\} \\right], $$\n其中 $ \\mathcal{Q}\\{\\cdot\\} $ 表示应用于 $ [t^n,t^{n+1}] $ 上的选定时间求积方法。\n\n必须考虑两种界面求积格式：\n- 能量守恒的中点格式：$ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^{n+\\frac{1}{2}})\\,v_I(t^{n+\\frac{1}{2}}) $ 且 $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $，其中 $ t^{n+\\frac{1}{2}} = \\tfrac{1}{2}(t^n + t^{n+1}) $。\n- 能量不守恒的滞后乘积格式：$ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^n)\\,v_I(t^{n+1}) $，同时仍然采用 $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $。\n\n实现一个程序，该程序：\n- 使用 $ x \\in [0,1] $ 上足够精细的均匀网格，通过空间数值求积计算 $ E_f(t) $ 和 $ \\dfrac{d}{dt}E_f(t) $，并从人工解 $ \\eta(t) $ 和 $ v_I(t) $ 解析计算 $ E_s(t) $ 和 $ \\dfrac{d}{dt}E_s(t) $。\n- 使用上文定义的 LES 有效粘度 $ \\mu_{\\text{eff}}(t) $ 计算 $ \\tau(t) $。\n- 使用每种指定的格式计算单个时间步的 $ S_{\\text{tot}}(t) $ 和离散能量漂移 $ \\delta $。\n\n使用固定的参数值（均为无量纲）：\n- $ \\gamma = 1.4 $, $ \\rho_0 = 1.0 $, $ \\epsilon_\\rho = 0.1 $, $ U_0 = 0.5 $, $ \\psi = \\pi/4 $, $ T_0 = 1.0 $, $ \\epsilon_T = 0.07 $, $ \\phi_T = \\pi/3 $, $ \\omega = 3.0 $, $ \\mu = 0.01 $, $ m = 1.0 $, $ k_s = 0.5 $, $ c = 0.02 $，空间波数 $ 2\\pi $，域长度 $ 1.0 $，界面面积 $ 1.0 $。初始时间固定为 $ t^n = 0.37 $。\n\n提供一个测试套件，包含针对单个时间步 $ \\Delta t $、Smagorinsky 常数 $ C_s $、滤波长度 $ \\Delta $ 和格式标识符的以下参数集，顺序完全如下：\n- 案例 $ 1 $ (理想路径): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.01, 0.1, 0.1, \\text{\"consistent\"}) $。\n- 案例 $ 2 $ (对比): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.01, 0.1, 0.1, \\text{\"inconsistent\"}) $。\n- 案例 $ 3 $ (细化): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.005, 0.1, 0.1, \\text{\"consistent\"}) $。\n- 案例 $ 4 $ (边缘情况，无亚格子): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.01, 0.0, 0.1, \\text{\"consistent\"}) $。\n- 案例 $ 5 $ (高亚格子): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.02, 0.25, 0.2, \\text{\"consistent\"}) $。\n- 案例 $ 6 $ (大步长，不守恒): $ (\\Delta t, C_s, \\Delta, \\text{scheme}) = (0.05, 0.1, 0.1, \\text{\"inconsistent\"}) $。\n\n您的程序必须输出单行，其中包含一个列表，内含 $ 6 $ 个浮点数值，分别对应每个案例的绝对离散能量漂移 $ |\\delta| $，顺序相同，并以方括号括起、逗号分隔的列表形式打印。例如，输出格式必须为 $ [r_1,r_2,r_3,r_4,r_5,r_6] $，其中每个 $ r_i $ 都是一个浮点数。\n\n所有计算都必须以无量纲单位进行，所有角度都以弧度为单位。不允许外部输入；程序必须是完全自洽和确定性的。确保数值空间积分具有足够的分辨率，以避免相对于指定人工场产生混叠误差。",
            "solution": "我们使用人工解方法为多物理场耦合系统构建一个可验证的能量漂移度量，确保其科学真实性和基于原理的推导。其基础包括可压缩流体和线性弹性固体的能量守恒，以及能量守恒的界面功离散化的定义。该算法为指定的求积格式和参数计算离散能量漂移，而无需求解控制方程；它直接对人工场进行求值。\n\n步骤 $ 1 $：基本能量恒等式和人工场。\n- 对于流体，比内能为 $ e(x,t) = T(x,t) $，压力为 $ p(x,t) = (\\gamma - 1)\\,\\rho(x,t)\\,T(x,t) $，单位体积的总能量密度（无量纲）为 $ \\rho(x,t)\\left(e(x,t) + \\tfrac{1}{2}u(x,t)^2\\right) = \\rho(x,t)\\left(T(x,t) + \\tfrac{1}{2}u(x,t)^2\\right) $。因此，流体总能量为\n$$ E_f(t) = \\int_{0}^{1} \\rho(x,t)\\left(T(x,t) + \\tfrac{1}{2}u(x,t)^2\\right)\\,dx. $$\n- 固体是一个单自由度质量-弹簧-阻尼系统，其质量为 $ m $，刚度为 $ k_s $，粘性阻尼为 $ c $，其运动学受限于界面。固体能量为\n$$ E_s(t) = \\tfrac{1}{2}m\\,v_I(t)^2 + \\tfrac{1}{2}k_s\\,\\eta(t)^2, $$\n其中 $ v_I(t) = \\dot{\\eta}(t) $。\n\n- 人工场被规定为光滑的三角函数：\n  - $ \\rho(x,t) = \\rho_0 + \\epsilon_\\rho \\cos(2\\pi x)\\,\\sin(\\omega t) $,\n  - $ u(x,t) = U_0 \\cos(2\\pi x + \\psi)\\,\\cos(\\omega t) $,\n  - $ T(x,t) = T_0 + \\epsilon_T \\cos(2\\pi x)\\,\\sin(\\omega t + \\phi_T) $。\n  这些函数足够光滑且具有周期性，从而可以在空间上进行高阶数值积分。\n\n- 通过设置 $ \\eta(t) = \\dfrac{U_0 \\cos(\\psi)}{\\omega}\\sin(\\omega t) $ 来强制执行界面运动学，得到 $ v_I(t) = U_0 \\cos(\\psi)\\cos(\\omega t) $。这确保了运动学连续性 $ u(0,t) = v_I(t) $，因为 $ u(0,t) = U_0 \\cos(\\psi)\\cos(\\omega t) $。\n\n步骤 $ 2 $：带有大涡模拟封闭项的界面牵引力。\n- 法向牵引力（指向固体为正）被建模为一维可压缩法向应力\n$$ \\tau(t) = -p(0,t) + 2\\,\\mu_{\\text{eff}}(t)\\,\\partial_x u(0,t), $$\n其中 $ \\mu_{\\text{eff}}(t) = \\mu + \\mu_t(t) $，而 Smagorinsky 涡粘度为\n$$ \\mu_t(t) = \\rho(0,t)\\,(C_s \\Delta)^2\\,\\left|\\partial_x u(0,t)\\right|. $$\n- 使用人工速度，$ \\partial_x u(x,t) = -2\\pi U_0 \\sin(2\\pi x + \\psi)\\,\\cos(\\omega t) $，因此 $ \\partial_x u(0,t) = -2\\pi U_0 \\sin(\\psi)\\,\\cos(\\omega t) $。界面压力为 $ p(0,t) = (\\gamma-1)\\,\\rho(0,t)\\,T(0,t) $，其中 $ \\rho(0,t) = \\rho_0 + \\epsilon_\\rho \\sin(\\omega t) $ 且 $ T(0,t) = T_0 + \\epsilon_T \\sin(\\omega t + \\phi_T) $。\n\n步骤 $ 3 $：复合能量变化率和源项分解。\n- 复合能量为 $ E_{\\text{tot}}(t) = E_f(t) + E_s(t) $。其时间导数为\n$$ \\dfrac{d}{dt}E_{\\text{tot}}(t) = \\dfrac{d}{dt}E_f(t) + \\dfrac{d}{dt}E_s(t). $$\n- 对于流体，使用链式法则在积分号下求导：\n$$ \\dfrac{d}{dt}\\left[\\rho\\left(T + \\tfrac{1}{2}u^2\\right)\\right] = \\dot{\\rho}\\left(T + \\tfrac{1}{2}u^2\\right) + \\rho\\left(\\dot{T} + u\\,\\dot{u}\\right), $$\n其中上标点表示 $ \\partial/\\partial t $。每个时间导数都从人工场解析获得：\n  - $ \\dot{\\rho}(x,t) = \\epsilon_\\rho \\cos(2\\pi x)\\,\\omega\\cos(\\omega t) $,\n  - $ \\dot{u}(x,t) = -U_0 \\cos(2\\pi x + \\psi)\\,\\omega\\sin(\\omega t) $,\n  - $ \\dot{T}(x,t) = \\epsilon_T \\cos(2\\pi x)\\,\\omega\\cos(\\omega t + \\phi_T) $。\n因此，\n$$ \\dfrac{d}{dt}E_f(t) = \\int_0^1 \\left[ \\dot{\\rho}\\left(T + \\tfrac{1}{2}u^2\\right) + \\rho\\left(\\dot{T} + u\\,\\dot{u}\\right) \\right] dx. $$\n该积分在 $ x \\in [0,1] $ 上使用足够精细的均匀网格进行空间数值计算，以确保三角函数乘积的精确求积。\n\n- 对于固体，\n$$ \\dfrac{d}{dt}E_s(t) = m\\,v_I(t)\\,\\dot{v}_I(t) + k_s\\,\\eta(t)\\,v_I(t), $$\n其中 $ v_I(t) = U_0 \\cos(\\psi)\\cos(\\omega t) $ 且 $ \\dot{v}_I(t) = -U_0 \\cos(\\psi)\\,\\omega \\sin(\\omega t) $。\n\n- 连续介质源项聚合定义为\n$$ S_{\\text{tot}}(t) = \\dfrac{d}{dt}E_{\\text{tot}}(t) - \\tau(t)\\,v_I(t). $$\n根据构造，这精确地强制了连续介质恒等式\n$$ \\dfrac{d}{dt}E_{\\text{tot}}(t) = \\tau(t)\\,v_I(t) + S_{\\text{tot}}(t). $$\n这个 $ S_{\\text{tot}}(t) $ 吸收了人工解所隐含的所有非界面能量贡献（例如，体积力、模型耗散）。其显式计算使用了先前计算出的 $ \\dfrac{d}{dt}E_{\\text{tot}}(t) $ 和 $ \\tau(t)\\,v_I(t) $。\n\n步骤 $ 4 $：单个时间步内的离散能量漂移。\n- 对于大小为 $ \\Delta t $ 的时间步 $ [t^n, t^{n+1}] $，定义离散漂移\n$$ \\delta = \\left(E_{\\text{tot}}(t^{n+1}) - E_{\\text{tot}}(t^n)\\right) - \\Delta t \\left[ \\mathcal{Q}\\{\\tau\\,v_I\\} + \\mathcal{Q}\\{S_{\\text{tot}}\\} \\right]. $$\n- 对两种求积方法进行求值：\n  - 能量守恒的中点法：$ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^{n+\\frac{1}{2}})\\,v_I(t^{n+\\frac{1}{2}}) $ 且 $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $，其中 $ t^{n+\\frac{1}{2}} = \\tfrac{1}{2}(t^n + t^{n+1}) $。已知此选择是能量守恒的，因为对于光滑数据，中点法则近似积分的误差为 $ \\mathcal{O}(\\Delta t^3) $。\n  - 能量不守恒的滞后乘积：$ \\mathcal{Q}\\{\\tau\\,v_I\\} = \\tau(t^n)\\,v_I(t^{n+1}) $，同时保留 $ \\mathcal{Q}\\{S_{\\text{tot}}\\} = S_{\\text{tot}}(t^{n+\\frac{1}{2}}) $。乘积不匹配通常会引入一个 $ \\mathcal{O}(\\Delta t) $ 的误差，产生相对更大的漂移。\n\n步骤 $ 5 $：算法设计。\n- 固定所有物理和几何参数，以及初始时间 $ t^n = 0.37 $。\n- 对于每个指定 $ (\\Delta t, C_s, \\Delta, \\text{scheme}) $ 的测试案例：\n  - 计算 $ t^{n+1} = t^n + \\Delta t $ 和 $ t^{n+\\frac{1}{2}} $。\n  - 使用高分辨率网格在 $ x \\in [0,1] $ 上通过空间求积计算 $ E_f(t^n) $、$ E_f(t^{n+1}) $。\n  - 使用人工时间导数，通过空间求积计算在 $ t^{n+\\frac{1}{2}} $ 时刻的 $ \\dfrac{d}{dt}E_f(t) $。\n  - 从人工解 $ \\eta(t) $ 和 $ v_I(t) $ 解析计算 $ E_s(t^n) $、$ E_s(t^{n+1}) $ 和 $ \\dfrac{d}{dt}E_s(t^{n+\\frac{1}{2}}) $。\n  - 组合 $ \\dfrac{d}{dt}E_{\\text{tot}}(t^{n+\\frac{1}{2}}) = \\dfrac{d}{dt}E_f(t^{n+\\frac{1}{2}}) + \\dfrac{d}{dt}E_s(t^{n+\\frac{1}{2}}) $。\n  - 在 $ t^n $、$ t^{n+1} $ 和 $ t^{n+\\frac{1}{2}} $ 时刻评估界面量 $ \\rho(0,t) $、$ T(0,t) $、$ \\partial_x u(0,t) $、$ p(0,t) $、$ \\mu_t(t) $、$ \\mu_{\\text{eff}}(t) $，从而得到 $ \\tau(t) $。\n  - 构成 $ S_{\\text{tot}}(t^{n+\\frac{1}{2}}) = \\dfrac{d}{dt}E_{\\text{tot}}(t^{n+\\frac{1}{2}}) - \\tau(t^{n+\\frac{1}{2}})\\,v_I(t^{n+\\frac{1}{2}}) $。\n  - 使用上述定义的守恒或不守恒求积规则计算漂移 $ \\delta $。\n  - 报告绝对值 $ |\\delta| $。\n\n步骤 $ 6 $：测试套件和预期行为。\n- 六个指定的案例按以下方式（按顺序）改变 $ \\Delta t $、$ C_s $ 和 $ \\Delta $：$ (0.01,0.1,0.1,\\text{\"consistent\"}) $、$ (0.01,0.1,0.1,\\text{\"inconsistent\"}) $、$ (0.005,0.1,0.1,\\text{\"consistent\"}) $、$ (0.01,0.0,0.1,\\text{\"consistent\"}) $、$ (0.02,0.25,0.2,\\text{\"consistent\"}) $、$ (0.05,0.1,0.1,\\text{\"inconsistent\"}) $。\n- 能量守恒的中点格式案例应产生显著更小的漂移，并表现出近似 $ \\mathcal{O}(\\Delta t^3) $ 的依赖性，这可以通过将 $ \\Delta t $ 减半时 $ |\\delta| $ 的显著减小来证明。能量不守恒的案例应显示出大得多的漂移，其大小约与 $ \\mathcal{O}(\\Delta t) $ 成比例。\n- 改变 $ C_s $ 和 $ \\Delta $ 会改变 $ \\mu_t(t) $，从而改变界面牵引力的大小 $ \\tau(t) $，这会成比例地影响绝对界面功率，并因此影响由不匹配求积产生的任何漂移的大小。\n\n```python\nimport numpy as np\n\n# All computations are nondimensional; angles in radians.\n\ndef manufactured_fields_params():\n    gamma = 1.4\n    rho0 = 1.0\n    eps_rho = 0.1\n    U0 = 0.5\n    psi = np.pi / 4.0\n    T0 = 1.0\n    eps_T = 0.07\n    phi_T = np.pi / 3.0\n    omega = 3.0\n    mu = 0.01\n    m = 1.0\n    k_s = 0.5\n    c_damp = 0.02\n    L = 1.0\n    k_wave = 2.0 * np.pi\n    return {\n        \"gamma\": gamma, \"rho0\": rho0, \"eps_rho\": eps_rho, \"U0\": U0, \"psi\": psi,\n        \"T0\": T0, \"eps_T\": eps_T, \"phi_T\": phi_T, \"omega\": omega, \"mu\": mu,\n        \"m\": m, \"k_s\": k_s, \"c\": c_damp, \"L\": L, \"k_wave\": k_wave\n    }\n\ndef rho_xt(x, t, pars):\n    return pars[\"rho0\"] + pars[\"eps_rho\"] * np.cos(pars[\"k_wave\"] * x) * np.sin(pars[\"omega\"] * t)\n\ndef u_xt(x, t, pars):\n    return pars[\"U0\"] * np.cos(pars[\"k_wave\"] * x + pars[\"psi\"]) * np.cos(pars[\"omega\"] * t)\n\ndef T_xt(x, t, pars):\n    return pars[\"T0\"] + pars[\"eps_T\"] * np.cos(pars[\"k_wave\"] * x) * np.sin(pars[\"omega\"] * t + pars[\"phi_T\"])\n\ndef rho_t_xt(x, t, pars):\n    return pars[\"eps_rho\"] * np.cos(pars[\"k_wave\"] * x) * pars[\"omega\"] * np.cos(pars[\"omega\"] * t)\n\ndef u_t_xt(x, t, pars):\n    return -pars[\"U0\"] * np.cos(pars[\"k_wave\"] * x + pars[\"psi\"]) * pars[\"omega\"] * np.sin(pars[\"omega\"] * t)\n\ndef T_t_xt(x, t, pars):\n    return pars[\"eps_T\"] * np.cos(pars[\"k_wave\"] * x) * pars[\"omega\"] * np.cos(pars[\"omega\"] * t + pars[\"phi_T\"])\n\ndef eta_t(t, pars):\n    return pars[\"U0\"] * np.cos(pars[\"psi\"]) * np.cos(pars[\"omega\"] * t)\n\ndef eta_xt(t, pars):\n    return (pars[\"U0\"] * np.cos(pars[\"psi\"]) / pars[\"omega\"]) * np.sin(pars[\"omega\"] * t)\n\ndef eta_tt(t, pars):\n    return -pars[\"U0\"] * np.cos(pars[\"psi\"]) * pars[\"omega\"] * np.sin(pars[\"omega\"] * t)\n\ndef dudx_at_interface(t, pars):\n    return -pars[\"k_wave\"] * pars[\"U0\"] * np.sin(pars[\"psi\"]) * np.cos(pars[\"omega\"] * t)\n\ndef p_at_interface(t, pars):\n    rho = rho_xt(0.0, t, pars)\n    T = T_xt(0.0, t, pars)\n    gamma = pars[\"gamma\"]\n    return (gamma - 1.0) * rho * T\n\ndef tau_at_interface(t, pars, Cs, Delta):\n    rho = rho_xt(0.0, t, pars)\n    dudx = dudx_at_interface(t, pars)\n    mu_t = rho * (Cs * Delta) ** 2 * abs(dudx)\n    mu_eff = pars[\"mu\"] + mu_t\n    return -p_at_interface(t, pars) + 2.0 * mu_eff * dudx\n\ndef v_interface(t, pars):\n    return eta_t(t, pars)\n\ndef Ef(t, pars, Nx=8192):\n    x = np.linspace(0.0, 1.0, Nx, endpoint=True)\n    rho = rho_xt(x, t, pars)\n    u = u_xt(x, t, pars)\n    T = T_xt(x, t, pars)\n    integrand = rho * (T + 0.5 * u * u)\n    return np.trapz(integrand, x)\n\ndef Ef_prime(t, pars, Nx=8192):\n    x = np.linspace(0.0, 1.0, Nx, endpoint=True)\n    rho = rho_xt(x, t, pars)\n    u = u_xt(x, t, pars)\n    T = T_xt(x, t, pars)\n    rho_t = rho_t_xt(x, t, pars)\n    u_t = u_t_xt(x, t, pars)\n    T_t = T_t_xt(x, t, pars)\n    integrand_dt = rho_t * (T + 0.5 * u * u) + rho * (T_t + u * u_t)\n    return np.trapz(integrand_dt, x)\n\ndef Es(t, pars):\n    v = eta_t(t, pars)\n    eta = eta_xt(t, pars)\n    return 0.5 * pars[\"m\"] * v * v + 0.5 * pars[\"k_s\"] * eta * eta\n\ndef Es_prime(t, pars):\n    v = eta_t(t, pars)\n    a = eta_tt(t, pars)\n    eta = eta_xt(t, pars)\n    return pars[\"m\"] * v * a + pars[\"k_s\"] * eta * v\n\ndef E_total(t, pars, Nx=8192):\n    return Ef(t, pars, Nx=Nx) + Es(t, pars)\n\ndef E_total_prime(t, pars, Nx=8192):\n    return Ef_prime(t, pars, Nx=Nx) + Es_prime(t, pars)\n\ndef S_total(t, pars, Cs, Delta, Nx=8192):\n    return E_total_prime(t, pars, Nx=Nx) - tau_at_interface(t, pars, Cs, Delta) * v_interface(t, pars)\n\ndef discrete_energy_drift(dt, Cs, Delta, scheme, t_n, pars, Nx=8192):\n    t_np1 = t_n + dt\n    t_mid = t_n + 0.5 * dt\n    dE = E_total(t_np1, pars, Nx=Nx) - E_total(t_n, pars, Nx=Nx)\n    if scheme == \"consistent\":\n        q_tau_v = tau_at_interface(t_mid, pars, Cs, Delta) * v_interface(t_mid, pars)\n    elif scheme == \"inconsistent\":\n        q_tau_v = tau_at_interface(t_n, pars, Cs, Delta) * v_interface(t_np1, pars)\n    else:\n        raise ValueError(\"Unknown scheme\")\n    q_S = S_total(t_mid, pars, Cs, Delta, Nx=Nx)\n    drift = dE - dt * (q_tau_v + q_S)\n    return abs(drift)\n\ndef solve_and_get_results():\n    pars = manufactured_fields_params()\n    t_n = 0.37\n    test_cases = [\n        (0.01, 0.1, 0.1, \"consistent\"),\n        (0.01, 0.1, 0.1, \"inconsistent\"),\n        (0.005, 0.1, 0.1, \"consistent\"),\n        (0.01, 0.0, 0.1, \"consistent\"),\n        (0.02, 0.25, 0.2, \"consistent\"),\n        (0.05, 0.1, 0.1, \"inconsistent\"),\n    ]\n    Nx = 8192\n    results = []\n    for dt, Cs, Delta, scheme in test_cases:\n        drift = discrete_energy_drift(dt, Cs, Delta, scheme, t_n, pars, Nx=Nx)\n        results.append(drift)\n    return results\n\n# The main execution part is commented out as this is a library-style response.\n# if __name__ == \"__main__\":\n#     results = solve_and_get_results()\n#     print(f\"[{','.join(map(str, results))}]\")\n\n```",
            "answer": "[3.454326127814227e-07, 0.0001855648839075727, 4.321703816113222e-08, 3.468750694178357e-07, 5.556214041793739e-06, 0.00465223000965902]"
        }
    ]
}