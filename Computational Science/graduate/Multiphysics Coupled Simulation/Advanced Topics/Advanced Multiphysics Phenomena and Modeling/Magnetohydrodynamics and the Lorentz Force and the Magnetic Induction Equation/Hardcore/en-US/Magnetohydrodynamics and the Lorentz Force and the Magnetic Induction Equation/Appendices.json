{
    "hands_on_practices": [
        {
            "introduction": "A robust numerical simulation begins with a correct mathematical model, and for problems involving partial differential equations, this critically includes the boundary conditions. This exercise  challenges you to return to first principles—the integral form of Maxwell's equations—to derive the appropriate conditions at the interface between a magnetohydrodynamic (MHD) fluid and two common boundaries: a perfect conductor and a vacuum. Mastering this derivation is essential, as these conditions dictate how the plasma interacts with its surroundings and are fundamental to building stable and physically accurate MHD solvers.",
            "id": "3513657",
            "problem": "A non-relativistic, quasi-neutral magnetized fluid is modeled by magnetohydrodynamics (MHD) in a domain bounded on one side by a stationary, perfectly conducting solid wall and on another side by a sharp interface with vacuum. Assume isotropic permeability and permittivity equal to $\\mu_0$ and $\\epsilon_0$ in all media, negligible magnetic monopoles, and that the computational plasma region uses the resistive MHD Ohm’s law $\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B} = \\eta\\mathbf{J}$ with $\\eta \\ge 0$. Assume the wall has conductivity $\\sigma \\to \\infty$ and that at $t=0$ the magnetic field inside the wall is $\\mathbf{B}=\\mathbf{0}$. At the plasma–vacuum interface, assume there is no singular surface charge density and no singular surface current sheet. The interface unit normal $\\mathbf{n}$ points out of the plasma.\n\nStarting from the integral forms of Maxwell’s equations (Faraday’s law, Gauss’s law for magnetism, Ampère–Maxwell law, and Gauss’s law for electricity) and charge conservation, determine which option gives a set of boundary conditions for the plasma-side fields that is consistent with these first principles, including the role of possible surface currents at the conducting wall and the absence of conduction current in vacuum. Select the single best option.\n\nA. Perfectly conducting wall: $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ and, because the wall interior has $\\mathbf{E}=\\mathbf{0}$ and hence $\\partial_t \\mathbf{B}=\\mathbf{0}$ with $\\mathbf{B}=\\mathbf{0}$ initially, continuity of $\\mathbf{n}\\cdot\\mathbf{B}$ implies $\\mathbf{n}\\cdot\\mathbf{B} = 0$ on the plasma side; tangential $\\mathbf{B}$ may jump to support a wall surface current $\\mathbf{K}_s$ via $\\mathbf{n}\\times(\\mathbf{B}_{\\text{pl}}/\\mu_0 - \\mathbf{B}_{\\text{wall}}/\\mu_0)=\\mathbf{K}_s$, with $\\mathbf{B}_{\\text{wall}}=\\mathbf{0}$; electromagnetism alone does not impose a general constraint on $\\mathbf{n}\\cdot\\mathbf{J}$ at the wall. In resistive MHD with $\\mathbf{u}=\\mathbf{0}$ at the wall, $\\mathbf{n}\\times\\mathbf{E}=\\mathbf{0}$ implies $\\mathbf{J}_t=\\mathbf{0}$. Vacuum interface: $\\mathbf{n}\\times \\mathbf{E}$ and $\\mathbf{n}\\cdot \\mathbf{B}$ are continuous; with no surface sheet, $\\mathbf{n}\\times \\mathbf{B}$ is continuous; because vacuum carries no conduction current, $\\mathbf{J}=\\mathbf{0}$ in vacuum and therefore $\\mathbf{n}\\cdot \\mathbf{J} = 0$ on the plasma side of the interface.\n\nB. Perfectly conducting wall: $\\mathbf{n}\\cdot \\mathbf{E} = 0$, $\\mathbf{n}\\times \\mathbf{B}=\\mathbf{0}$, and $\\mathbf{n}\\cdot \\mathbf{J}=0$; vacuum interface: $\\mathbf{n}\\cdot \\mathbf{E}$ and $\\mathbf{n}\\times \\mathbf{B}$ are continuous, with no conditions on $\\mathbf{n}\\cdot \\mathbf{B}$ or $\\mathbf{n}\\times \\mathbf{E}$.\n\nC. Perfectly conducting wall: $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$ and $\\mathbf{n}\\times \\mathbf{B}=\\mathbf{0}$; vacuum interface: $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$ and $\\mathbf{n}\\cdot \\mathbf{B}=0$, with no additional constraints on $\\mathbf{J}$.\n\nD. Perfectly conducting wall: $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$, $\\mathbf{n}\\cdot \\mathbf{B}=0$, and $\\mathbf{n}\\cdot \\mathbf{J}=0$; vacuum interface: $\\mathbf{n}\\times \\mathbf{E}$ and $\\mathbf{n}\\cdot \\mathbf{B}$ are continuous, and $\\mathbf{n}\\times \\mathbf{B}$ is continuous.\n\nE. Perfectly conducting wall: only $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$ is required; vacuum interface: $\\mathbf{n}\\cdot \\mathbf{B}=0$ and $\\mathbf{J}=\\mathbf{0}$, with no conditions on $\\mathbf{n}\\times \\mathbf{E}$ or $\\mathbf{n}\\times \\mathbf{B}$.",
            "solution": "The problem statement is accepted as valid. It presents a standard, well-posed problem in magnetohydrodynamics based on established physical principles.\n\nThe derivation of the boundary conditions proceeds from the integral forms of Maxwell's equations. At a sharp interface between two media, labeled $1$ and $2$, with a unit normal vector $\\mathbf{n}$ pointing from medium $1$ into medium $2$, the general electromagnetic boundary conditions are:\n1.  $\\mathbf{n} \\times (\\mathbf{E}_2 - \\mathbf{E}_1) = \\mathbf{0}$ (from Faraday's law, continuity of tangential $\\mathbf{E}$)\n2.  $\\mathbf{n} \\cdot (\\mathbf{B}_2 - \\mathbf{B}_1) = 0$ (from Gauss's law for magnetism, continuity of normal $\\mathbf{B}$)\n3.  $\\mathbf{n} \\cdot (\\mathbf{D}_2 - \\mathbf{D}_1) = \\sigma_s$ (from Gauss's law for electricity, where $\\mathbf{D} = \\epsilon_0 \\mathbf{E}$ and $\\sigma_s$ is the surface charge density)\n4.  $\\mathbf{n} \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{K}_s$ (from Ampère-Maxwell law, where $\\mathbf{H} = \\mathbf{B}/\\mu_0$ and $\\mathbf{K}_s$ is the surface current density)\n5.  $\\mathbf{n} \\cdot (\\mathbf{J}_2 - \\mathbf{J}_1) = - \\frac{\\partial \\sigma_s}{\\partial t}$ (from charge conservation)\n\nThe problem defines the plasma region and two boundaries: a stationary, perfectly conducting solid wall and a sharp interface with vacuum. The unit normal $\\mathbf{n}$ points out of the plasma.\n\n### Analysis of the Plasma–Perfectly Conducting Wall Interface\nHere, the plasma is medium $1$ and the perfectly conducting wall is medium $2$. So, $\\mathbf{n}$ points from the plasma to the wall.\n\n- **Fields inside the wall:** A perfect conductor ($\\sigma \\to \\infty$) cannot sustain an electric field in its interior, as any finite current density $\\mathbf{J}$ would be driven by an infinitesimal field $\\mathbf{E} = \\mathbf{J}/\\sigma \\to \\mathbf{0}$. So, inside the wall, $\\mathbf{E}_{\\text{wall}} = \\mathbf{0}$.\n- From Faraday's law in differential form, $\\nabla \\times \\mathbf{E} = -\\partial_t \\mathbf{B}$. Since $\\mathbf{E}_{\\text{wall}} = \\mathbf{0}$, we have $\\partial_t \\mathbf{B}_{\\text{wall}} = \\mathbf{0}$.\n- The problem states that initially at $t=0$, the magnetic field inside the wall is $\\mathbf{B}_{\\text{wall}}=\\mathbf{0}$. Because its time derivative is zero for all time, $\\mathbf{B}_{\\text{wall}}$ remains zero for all $t \\ge 0$. So, $\\mathbf{E}_{\\text{wall}} = \\mathbf{0}$ and $\\mathbf{B}_{\\text{wall}} = \\mathbf{0}$ for $t \\ge 0$.\n\nNow we apply the general boundary conditions with fields on the plasma side denoted by subscript 'pl':\n1.  **Tangential E-field:** $\\mathbf{n} \\times (\\mathbf{E}_{\\text{wall}} - \\mathbf{E}_{\\text{pl}}) = \\mathbf{0}$. With $\\mathbf{E}_{\\text{wall}} = \\mathbf{0}$, this becomes $\\mathbf{n} \\times (-\\mathbf{E}_{\\text{pl}}) = \\mathbf{0}$, which simplifies to $\\mathbf{n} \\times \\mathbf{E}_{\\text{pl}} = \\mathbf{0}$. The tangential component of the electric field on the plasma side must be zero.\n2.  **Normal B-field:** $\\mathbf{n} \\cdot (\\mathbf{B}_{\\text{wall}} - \\mathbf{B}_{\\text{pl}}) = 0$. With $\\mathbf{B}_{\\text{wall}} = \\mathbf{0}$, this gives $\\mathbf{n} \\cdot (-\\mathbf{B}_{\\text{pl}}) = 0$, or $\\mathbf{n} \\cdot \\mathbf{B}_{\\text{pl}} = 0$. The normal component of the magnetic field on the plasma side must be zero.\n3.  **Tangential B-field:** $\\mathbf{n} \\times (\\mathbf{H}_{\\text{wall}} - \\mathbf{H}_{\\text{pl}}) = \\mathbf{K}_s$. Since $\\mathbf{H} = \\mathbf{B}/\\mu_0$ and $\\mathbf{B}_{\\text{wall}} = \\mathbf{0}$, this becomes $\\mathbf{n} \\times (-\\mathbf{B}_{\\text{pl}}/\\mu_0) = \\mathbf{K}_s$. This shows that a non-zero tangential magnetic field on the plasma side, $\\mathbf{B}_{t, \\text{pl}}$, is permissible and is supported by a surface current $\\mathbf{K}_s$ on the wall. The existence of $\\mathbf{K}_s$ is physically expected in a perfect conductor to shield its interior from external magnetic fields.\n4.  **Normal J-field:** From first principles of electromagnetism, specifically charge conservation $\\mathbf{n} \\cdot (\\mathbf{J}_{\\text{wall}} - \\mathbf{J}_{\\text{pl}}) = - \\partial_t \\sigma_s$, there is no general constraint forcing $\\mathbf{n} \\cdot \\mathbf{J}_{\\text{pl}}$ to be zero. Current can, in principle, flow from the plasma into the conducting wall, where it can be transported away. So, electromagnetism alone does not provide a condition on $\\mathbf{n} \\cdot \\mathbf{J}_{\\text{pl}}$.\nHowever, we can consider the MHD Ohm's law, $\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B} = \\eta\\,\\mathbf{J}$. The wall is stationary, so the plasma velocity at the wall is $\\mathbf{u}=\\mathbf{0}$. Ohm's law on the plasma side at the wall simplifies to $\\mathbf{E}_{\\text{pl}} = \\eta \\, \\mathbf{J}_{\\text{pl}}$. Since we found $\\mathbf{n} \\times \\mathbf{E}_{\\text{pl}} = \\mathbf{0}$, it follows that $\\mathbf{n} \\times (\\eta \\, \\mathbf{J}_{\\text{pl}}) = \\eta (\\mathbf{n} \\times \\mathbf{J}_{\\text{pl}}) = \\mathbf{0}$. For a resistive plasma ($\\eta > 0$), this implies $\\mathbf{n} \\times \\mathbf{J}_{\\text{pl}} = \\mathbf{0}$, which means the current density vector $\\mathbf{J}_{\\text{pl}}$ is parallel to the normal vector $\\mathbf{n}$. This is equivalent to stating that the tangential component of the current density, $\\mathbf{J}_t$, is zero at the wall. For the ideal case ($\\eta=0$), $\\mathbf{E}_{\\text{pl}}=\\mathbf{0}$ and this particular argument does not constrain $\\mathbf{J}_{\\text{pl}}$.\n\n### Analysis of the Plasma–Vacuum Interface\nHere, the plasma is medium $1$ and the vacuum is medium $2$. So, $\\mathbf{n}$ points from the plasma to the vacuum.\n\n- **Properties of vacuum:** Vacuum contains no conduction currents, so $\\mathbf{J}_{\\text{vac}} = \\mathbf{0}$.\n- **Interface properties:** The problem states there is no singular surface charge density ($\\sigma_s=0$) and no singular surface current sheet ($\\mathbf{K}_s=\\mathbf{0}$).\n\nApplying the general boundary conditions:\n1.  **Tangential E-field:** $\\mathbf{n} \\times (\\mathbf{E}_{\\text{vac}} - \\mathbf{E}_{\\text{pl}}) = \\mathbf{0}$. This means $\\mathbf{n} \\times \\mathbf{E}$ is continuous across the interface.\n2.  **Normal B-field:** $\\mathbf{n} \\cdot (\\mathbf{B}_{\\text{vac}} - \\mathbf{B}_{\\text{pl}}) = 0$. This means $\\mathbf{n} \\cdot \\mathbf{B}$ is continuous.\n3.  **Normal E-field:** With $\\sigma_s=0$, the condition $\\mathbf{n} \\cdot (\\mathbf{D}_{\\text{vac}} - \\mathbf{D}_{\\text{pl}}) = \\sigma_s$ implies $\\mathbf{n} \\cdot (\\epsilon_0\\mathbf{E}_{\\text{vac}} - \\epsilon_0\\mathbf{E}_{\\text{pl}}) = 0$, so $\\mathbf{n} \\cdot \\mathbf{E}$ is also continuous.\n4.  **Tangential B-field:** With $\\mathbf{K}_s=\\mathbf{0}$, the condition $\\mathbf{n} \\times (\\mathbf{H}_{\\text{vac}} - \\mathbf{H}_{\\text{pl}}) = \\mathbf{K}_s$ implies $\\mathbf{n} \\times (\\mathbf{B}_{\\text{vac}}/\\mu_0 - \\mathbf{B}_{\\text{pl}}/\\mu_0) = \\mathbf{0}$, a so $\\mathbf{n} \\times \\mathbf{B}$ is continuous.\n5.  **Normal J-field:** From charge conservation, $\\mathbf{n} \\cdot (\\mathbf{J}_{\\text{vac}} - \\mathbf{J}_{\\text{pl}}) = - \\partial_t \\sigma_s$. With $\\mathbf{J}_{\\text{vac}}=\\mathbf{0}$ and $\\sigma_s=0$, this gives $\\mathbf{n} \\cdot (-\\mathbf{J}_{\\text{pl}}) = 0$, or $\\mathbf{n} \\cdot \\mathbf{J}_{\\text{pl}} = 0$. The normal component of the current density must be zero on the plasma side, as charge cannot flow into the vacuum.\n\n### Evaluation of Options\n\n**A.**\n- **Perfectly conducting wall:** Correctly states $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$. Correctly derives $\\mathbf{n} \\cdot \\mathbf{B}=0$ from continuity of normal $\\mathbf{B}$ and the fact that $\\mathbf{B}_{\\text{wall}}=\\mathbf{0}$ due to the initial condition and $\\mathbf{E}_{\\text{wall}}=\\mathbf{0}$. Correctly identifies that a tangential $\\mathbf{B}$ jump is supported by a surface current $\\mathbf{K}_s$. The formula provided has a sign convention different from the standard one, but correctly expresses the physical relationship. Correctly states that EM alone does not impose a constraint on $\\mathbf{n} \\cdot \\mathbf{J}$. Correctly deduces that for resistive MHD with $\\mathbf{u}=\\mathbf{0}$, the condition $\\mathbf{n} \\times \\mathbf{E}=\\mathbf{0}$ implies $\\mathbf{J}_t=\\mathbf{0}$. This analysis is comprehensive and accurate.\n- **Vacuum interface:** Correctly states that $\\mathbf{n}\\times \\mathbf{E}$ and $\\mathbf{n}\\cdot \\mathbf{B}$ are continuous. Correctly states that with no surface current sheet, $\\mathbf{n}\\times \\mathbf{B}$ is continuous. Correctly derives $\\mathbf{n}\\cdot \\mathbf{J} = 0$ from the fact that no conduction current exists in vacuum. All points are correct.\n- **Verdict:** Correct.\n\n**B.**\n- **Perfectly conducting wall:** Claims $\\mathbf{n}\\cdot \\mathbf{E} = 0$, which is not generally true as a surface charge can exist. Claims $\\mathbf{n}\\times \\mathbf{B}=\\mathbf{0}$, which is incorrect as this would forbid surface currents. Claims $\\mathbf{n}\\cdot \\mathbf{J}=0$, which is not derivable from first principles.\n- **Vacuum interface:** Makes incorrect claims about which components are unconstrained.\n- **Verdict:** Incorrect.\n\n**C.**\n- **Perfectly conducting wall:** Claims $\\mathbf{n}\\times \\mathbf{B}=\\mathbf{0}$, which is incorrect.\n- **Vacuum interface:** Claims $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$ and $\\mathbf{n}\\cdot \\mathbf{B}=0$. These are incorrect; these components are continuous but not necessarily zero. It also fails to mention the constraint on $\\mathbf{n}\\cdot \\mathbf{J}$.\n- **Verdict:** Incorrect.\n\n**D.**\n- **Perfectly conducting wall:** Correctly states $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$ and $\\mathbf{n}\\cdot \\mathbf{B}=0$. However, it incorrectly asserts $\\mathbf{n}\\cdot \\mathbf{J}=0$ as a general condition. While used in many models, it is not derivable from the first principles specified in the problem, which is what is requested. Option A's more nuanced statement is superior.\n- **Vacuum interface:** The listed conditions are correct, but the set is incomplete as it misses the condition on $\\mathbf{n}\\cdot \\mathbf{J}$.\n- **Verdict:** Incorrect.\n\n**E.**\n- **Perfectly conducting wall:** Claiming \"only $\\mathbf{n}\\times \\mathbf{E}=\\mathbf{0}$ is required\" is incorrect, as $\\mathbf{n}\\cdot \\mathbf{B}=0$ is also a fundamental consequence.\n- **Vacuum interface:** Claims $\\mathbf{n}\\cdot \\mathbf{B}=0$, which is incorrect (it is continuous). Claims $\\mathbf{J}=\\mathbf{0}$, which is too strong (only $\\mathbf{n}\\cdot \\mathbf{J}=0$ is required). It also incorrectly states there are no conditions on tangential $\\mathbf{E}$ and $\\mathbf{B}$.\n- **Verdict:** Incorrect.\n\nBased on the rigorous derivation from first principles, Option A provides the most complete and accurate set of boundary conditions and their justifications.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While the governing equations of magnetohydrodynamics (MHD) are built on the solenoidal constraint $\\nabla \\cdot \\mathbf{B} = 0$, most numerical discretization schemes fail to preserve this condition exactly, leading to the accumulation of so-called 'divergence errors'. This practice  guides you through the derivation and analysis of a powerful remedy: the hyperbolic-parabolic divergence-cleaning method. You will not only augment the induction equation to actively transport and damp these errors but also analyze the system's behavior through a dispersion relation, providing deep insight into how numerical errors propagate and can be controlled in a computational setting.",
            "id": "3513686",
            "problem": "You are tasked with proposing, deriving, and numerically analyzing a divergence-cleaning mechanism for magnetohydrodynamics (MHD) within a multiphysics coupled simulation context. The mechanism should be of the hyperbolic–parabolic type and should address how divergence errors in the magnetic field arising from spatial discretization propagate and decay. Your derivation and computations must begin from a valid fundamental base consisting of core definitions and well-tested formulas, including the magnetic induction equation, the divergence-free constraint, the Lorentz force, and mathematically consistent augmentation for divergence cleaning. No shortcut formulas may appear in the problem statement; your reasoning must proceed from first principles.\n\nFundamental base to use:\n- Magnetohydrodynamics (MHD) couples the dynamics of a conducting fluid to electromagnetic fields. The magnetic induction equation arises from Faraday’s law and a constitutive relation for the electric field, while the momentum equation includes the Lorentz force as a source term. The divergence-free constraint imposes $\\nabla \\cdot \\mathbf{B} = 0$ for the magnetic field $\\mathbf{B}$.\n- Consider introducing a generalized Lagrange multiplier (GLM) scalar field $\\psi$ to augment the induction equation so that divergence errors $\\delta = \\nabla \\cdot \\mathbf{B}$ are both transported and damped in time. Work in a context where flow advection and resistive effects are neglected temporarily to isolate divergence-cleaning dynamics, but maintain scientific consistency with MHD.\n\nYour tasks:\n1. Propose a hyperbolic–parabolic divergence-cleaning augmentation that introduces a scalar field $\\psi$ so that divergence errors $\\delta = \\nabla \\cdot \\mathbf{B}$ are both transported and damped in time. The augmentation must be mathematically consistent with the induction equation and the divergence constraint and must be physically meaningful for a conducting fluid. Define the hyperbolic cleaning speed $c_h$ (in $\\text{m/s}$) and the parabolic damping coefficient $\\sigma$ (in $\\text{s}^{-1}$), and explain their roles.\n2. Starting from the augmented system and the divergence constraint, derive a closed-form evolution equation for the divergence error field $\\delta(\\mathbf{x},t)$ that demonstrates how divergence errors propagate and damp. Then argue for the existence of normal-mode solutions of the form $\\delta(x,t) = \\hat{\\delta}\\,e^{i k x}\\,e^{-\\omega t}$ on a one-dimensional domain, with wavenumber $k$ (in $\\text{rad/m}$) and complex rate $\\omega$ (in $\\text{s}^{-1}$). Use only the fundamental base and mathematically correct manipulations to arrive at the appropriate dispersion relation for $\\omega$ as a function of $k$, $c_h$, and $\\sigma$. Do not introduce shortcut formulas or results not derived from the base.\n3. Consider a second-order central-difference spatial discretization of the Laplacian on a uniform one-dimensional grid with spacing $\\Delta x$ (in $\\text{m}$) and periodic boundary conditions. Show how the discrete spatial operator modifies the wavenumber response of the divergence-error evolution compared to the continuous case, and derive the corresponding discrete dispersion relation for $\\omega$. All trigonometric arguments must use radians.\n4. Design and implement a program to compute, for each specified test case, the following quantities in $\\text{s}^{-1}$:\n   - The two branches of the continuous normal-mode rates $\\omega_-(k)$ and $\\omega_+(k)$, reported as their real and imaginary parts.\n   - The two branches of the discrete normal-mode rates $\\omega_-^{\\text{disc}}(k,\\Delta x)$ and $\\omega_+^{\\text{disc}}(k,\\Delta x)$, reported as their real and imaginary parts.\n   All angles are in radians, and all rates must be expressed in $\\text{s}^{-1}$. The imaginary part represents oscillation frequency, while the real part represents damping rate.\n5. Interpret, through the computed values, how discretization modifies propagation speed and damping relative to the continuous model, especially near the grid Nyquist wavenumber.\n\nTest suite:\nProvide computations for the following parameter sets, each given as a tuple $(c_h, \\sigma, \\Delta x, k)$, with $c_h$ in $\\text{m/s}$, $\\sigma$ in $\\text{s}^{-1}$, $\\Delta x$ in $\\text{m}$, and $k$ in $\\text{rad/m}$:\n- Case A (happy path, oscillatory regime): $(1.0 \\times 10^{3}, 5.0 \\times 10^{1}, 1.0 \\times 10^{-2}, 1.0 \\times 10^{2})$.\n- Case B (boundary condition, zero wavenumber): $(5.0 \\times 10^{2}, 2.0 \\times 10^{1}, 1.0 \\times 10^{-1}, 0)$.\n- Case C (critical damping in the continuous model): $(2, 4, 1.0 \\times 10^{-1}, 1)$.\n- Case D (edge case near the discrete Nyquist wavenumber): $(1.0 \\times 10^{1}, 3.0 \\times 10^{1}, 5.0 \\times 10^{-2}, \\pi / \\Delta x)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated Python-style list, where each element corresponds to one test case and is itself a list of eight floats in the following order:\n$\\left[\\Re\\omega_-, \\Im\\omega_-, \\Re\\omega_+, \\Im\\omega_+, \\Re\\omega_-^{\\text{disc}}, \\Im\\omega_-^{\\text{disc}}, \\Re\\omega_+^{\\text{disc}}, \\Im\\omega_+^{\\text{disc}}\\right]$.\nFor instance, the output should look like $\\left[\\left[\\dots\\right],\\left[\\dots\\right],\\left[\\dots\\right],\\left[\\dots\\right]\\right]$ with all numeric entries in $\\text{s}^{-1}$ and angles in radians.",
            "solution": "The user-provided problem statement is valid. It is scientifically grounded in the principles of computational magnetohydrodynamics (MHD), is well-posed with a clear objective and sufficient data, and is expressed in objective, formal language. The problem asks for the derivation and analysis of a standard hyperbolic-parabolic divergence-cleaning mechanism (the Generalized Lagrange Multiplier or GLM method), which is a canonical topic in the field. All conditions for a valid problem are met.\n\nHere is the complete, reasoned solution.\n\n### Part 1: Proposed Augmented System for Divergence Cleaning\n\nThe fundamental challenge in the numerical simulation of MHD is to maintain the divergence-free constraint, $\\nabla \\cdot \\mathbf{B} = 0$. Discretization errors inevitably introduce a non-zero divergence, $\\delta = \\nabla \\cdot \\mathbf{B} \\neq 0$, which can lead to unphysical forces and numerical instability. The hyperbolic-parabolic Generalized Lagrange Multiplier (GLM) method addresses this by augmenting the MHD equations. We introduce a scalar field $\\psi$ that couples to the divergence error.\n\nTo isolate the dynamics of the cleaning mechanism, we consider a simplified context where fluid velocity and magnetic resistivity are neglected. The standard induction equation, $\\partial \\mathbf{B} / \\partial t = \\mathbf{0}$, is augmented. The proposed system consists of a modified induction equation and a new evolution equation for $\\psi$:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} + \\nabla \\psi = \\mathbf{0}\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) = -\\sigma \\psi\n$$\nHere, $\\mathbf{B}(\\mathbf{x}, t)$ is the magnetic field, and $\\psi(\\mathbf{x}, t)$ is the auxiliary scalar field. The system introduces two parameters:\n1.  $c_h$: The hyperbolic cleaning speed, with units of $\\mathrm{m/s}$. This parameter determines the characteristic speed at which divergence errors $\\delta$ are propagated away from their source as waves. A larger $c_h$ leads to faster transport of these errors.\n2.  $\\sigma$: The parabolic damping coefficient, with units of $\\mathrm{s^{-1}}$. This parameter introduces a dissipative term, causing the amplitudes of both the divergence error $\\delta$ and the auxiliary field $\\psi$ to decay exponentially in time.\n\nThe combination of a hyperbolic transport term (involving $c_h$) and a parabolic damping term (involving $\\sigma$) ensures that divergence errors are actively removed from the computational domain.\n\n### Part 2: Derivation of the Continuous Divergence Error Evolution\n\nTo understand how the divergence error $\\delta = \\nabla \\cdot \\mathbf{B}$ evolves under this augmented system, we seek a single, closed-form equation for $\\delta$.\n\nFirst, take the divergence of the augmented induction equation:\n$$\n\\nabla \\cdot \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} \\right) + \\nabla \\cdot (\\nabla \\psi) = 0\n$$\nAssuming sufficient smoothness of $\\mathbf{B}$, we can commute the spatial and temporal derivatives. Also, by definition, $\\delta = \\nabla \\cdot \\mathbf{B}$ and $\\nabla \\cdot (\\nabla \\psi) = \\nabla^2 \\psi$. This gives:\n$$\n\\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} + \\nabla^2 \\psi = 0 \\implies \\frac{\\partial \\delta}{\\partial t} + \\nabla^2 \\psi = 0\n\\quad \\quad (1)\n$$\nNext, take the time derivative of the evolution equation for $\\psi$:\n$$\n\\frac{\\partial^2 \\psi}{\\partial t^2} + c_h^2 \\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} = -\\sigma \\frac{\\partial \\psi}{\\partial t}\n$$\nSubstituting $\\delta = \\nabla \\cdot \\mathbf{B}$, we get:\n$$\n\\frac{\\partial^2 \\psi}{\\partial t^2} + c_h^2 \\frac{\\partial \\delta}{\\partial t} = -\\sigma \\frac{\\partial \\psi}{\\partial t}\n\\quad \\quad (2)\n$$\nWe now have a system of two equations for $\\delta$ and $\\psi$. To eliminate $\\psi$, we can use equation (1) to express terms involving $\\psi$ in terms of $\\delta$. From (1), we have $\\nabla^2 \\psi = -\\partial \\delta / \\partial t$. Differentiating equation (1) with respect to time gives $\\partial^2 \\delta / \\partial t^2 = -\\nabla^2 (\\partial \\psi / \\partial t)$. To use this, we solve the original $\\psi$ evolution equation for $\\partial \\psi / \\partial t$: $\\partial \\psi / \\partial t = -c_h^2 \\delta - \\sigma \\psi$. However, it is more direct to operate on (2).\n\nApply the Laplacian operator $\\nabla^2$ to the original $\\psi$ evolution equation:\n$$\n\\nabla^2 \\left(\\frac{\\partial \\psi}{\\partial t}\\right) + c_h^2 \\nabla^2 \\delta = -\\sigma \\nabla^2 \\psi\n$$\nCommuting derivatives, this becomes:\n$$\n\\frac{\\partial}{\\partial t}(\\nabla^2 \\psi) + c_h^2 \\nabla^2 \\delta = -\\sigma \\nabla^2 \\psi\n$$\nNow, substitute $\\nabla^2 \\psi = -\\partial \\delta / \\partial t$ from equation (1) into this expression:\n$$\n\\frac{\\partial}{\\partial t}\\left(-\\frac{\\partial \\delta}{\\partial t}\\right) + c_h^2 \\nabla^2 \\delta = -\\sigma \\left(-\\frac{\\partial \\delta}{\\partial t}\\right)\n$$\nThis simplifies to the final evolution equation for the divergence error $\\delta$:\n$$\n\\frac{\\partial^2 \\delta}{\\partial t^2} + \\sigma \\frac{\\partial \\delta}{\\partial t} - c_h^2 \\nabla^2 \\delta = 0\n$$\nThis is a damped wave equation, also known as the telegrapher's equation. It shows that divergence errors propagate with speed $c_h$ while their amplitude is damped by the term proportional to $\\sigma$.\n\nTo find the dispersion relation, we analyze normal-mode solutions in one dimension, $\\delta(x, t) = \\hat{\\delta} e^{i k x} e^{-\\omega t}$, where $k$ is the wavenumber and $\\omega$ is the complex rate. Plugging this into the equation:\n- $\\partial^2 \\delta / \\partial t^2 = (-\\omega)^2 \\delta = \\omega^2 \\delta$\n- $\\partial \\delta / \\partial t = -\\omega \\delta$\n- $\\nabla^2 \\delta = \\partial^2 \\delta / \\partial x^2 = (ik)^2 \\delta = -k^2 \\delta$\n\nSubstituting these into the evolution equation yields:\n$$\n\\omega^2 \\delta - \\sigma \\omega \\delta - c_h^2 (-k^2 \\delta) = 0\n$$\nDividing by $\\delta$ (for a non-trivial solution), we obtain the algebraic equation for $\\omega$:\n$$\n\\omega^2 - \\sigma \\omega + c_h^2 k^2 = 0\n$$\nThis is a quadratic equation for $\\omega$. The roots, which form the continuous dispersion relation, are given by the quadratic formula:\n$$\n\\omega_{\\pm}(k) = \\frac{\\sigma \\pm \\sqrt{\\sigma^2 - 4 c_h^2 k^2}}{2}\n$$\nThe real part of $\\omega$ is the damping rate, and the imaginary part is the oscillation frequency.\n\n### Part 3: Derivation of the Discrete Dispersion Relation\n\nWhen the system is solved numerically on a uniform grid with spacing $\\Delta x$, the continuous spatial derivatives are replaced by finite difference approximations. The second-order central difference approximation for the 1D Laplacian $\\nabla^2 = \\partial^2/\\partial x^2$ is:\n$$\n\\nabla^2 \\delta(x) \\approx \\frac{\\delta(x+\\Delta x) - 2\\delta(x) + \\delta(x-\\Delta x)}{(\\Delta x)^2}\n$$\nApplying this discrete operator to the normal mode $e^{ikx}$ gives:\n$$\n\\frac{e^{ik(x+\\Delta x)} - 2e^{ikx} + e^{ik(x-\\Delta x)}}{(\\Delta x)^2} = \\frac{e^{ikx} (e^{ik\\Delta x} - 2 + e^{-ik\\Delta x})}{(\\Delta x)^2}\n$$\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, this becomes:\n$$\ne^{ikx} \\frac{2\\cos(k\\Delta x) - 2}{(\\Delta x)^2} = -e^{ikx} \\frac{2(1 - \\cos(k\\Delta x))}{(\\Delta x)^2}\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\n-e^{ikx} \\frac{4}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nThus, the discrete Laplacian operator acting on the mode $e^{ikx}$ is equivalent to multiplication by $-k_{\\mathrm{eff}}^2$, where the effective wavenumber squared is:\n$$\nk_{\\mathrm{eff}}^2 = \\frac{4}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nTo find the discrete dispersion relation, we replace $k^2$ in the continuous relation's quadratic equation with $k_{\\mathrm{eff}}^2$:\n$$\n\\omega^2 - \\sigma \\omega + c_h^2 k_{\\mathrm{eff}}^2 = 0\n$$\nThe roots give the discrete dispersion relation:\n$$\n\\omega_{\\pm}^{\\mathrm{disc}}(k, \\Delta x) = \\frac{\\sigma \\pm \\sqrt{\\sigma^2 - 4 c_h^2 k_{\\mathrm{eff}}^2}}{2} = \\frac{\\sigma \\pm \\sqrt{\\sigma^2 - 4 c_h^2 \\frac{4}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}}{2}\n$$\n\n### Part 5: Interpretation of Discretization Effects\n\nThe derived relations for $\\omega(k)$ and $\\omega^{\\mathrm{disc}}(k, \\Delta x)$ allow for a direct comparison between the continuous model and its discrete counterpart.\n\n1.  **Numerical Dispersion**: The phase velocity of the divergence waves is altered by discretization. For long wavelengths ($k\\Delta x \\ll 1$), we have $\\sin(k\\Delta x/2) \\approx k\\Delta x/2$, which makes $k_{\\mathrm{eff}}^2 \\approx k^2$. In this limit, the discrete model accurately reproduces the continuous behavior. However, for shorter wavelengths (larger $k$), $k_{\\mathrm{eff}}$ is always less than $k$. This phenomenon is known as numerical dispersion. The wave propagation speed in the discrete system, which is proportional to $k_{\\mathrm{eff}}$, is lower than in the continuous system. At the Nyquist wavenumber, $k = \\pi/\\Delta x$, the effective wavenumber is $k_{\\mathrm{eff}} = 2/\\Delta x = (2/\\pi)k$. The propagation speed is reduced to approximately $64\\%$ of the continuous speed.\n\n2.  **Damping Behavior**: Discretization can also alter the damping regime. The transition between oscillatory (complex $\\omega$) and overdamped (real $\\omega$) behavior occurs when the discriminant is zero. In the continuous case, this is $\\sigma^2 = 4c_h^2 k^2$. In the discrete case, it is $\\sigma^2 = 4c_h^2 k_{\\mathrm{eff}}^2$. Since $k_{\\mathrm{eff}}^2 \\le k^2$, a mode that is oscillatory in the continuous model might become overdamped or critically damped in the discrete model. For instance, if a mode is critically damped in the continuous model ($\\sigma^2=4c_h^2k^2$), its discrete counterpart will be overdamped, as $4c_h^2k_{\\mathrm{eff}}^2 < \\sigma^2$. This is observed in Test Case C. Conversely, in the oscillatory regime, the damping rate for both continuous and discrete models is $\\Re(\\omega) = \\sigma/2$, which is independent of the wavenumber, so the rate of amplitude decay is unaffected by the numerical dispersion as long as the system remains oscillatory.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the continuous and discrete normal-mode rates for the\n    hyperbolic-parabolic divergence-cleaning mechanism in MHD.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c_h, sigma, delta_x, k)\n    test_cases = [\n        # Case A: Happy path, oscillatory regime\n        (1.0e3, 5.0e1, 1.0e-2, 1.0e2),\n        # Case B: Boundary condition, zero wavenumber\n        (5.0e2, 2.0e1, 1.0e-1, 0.0),\n        # Case C: Critical damping in the continuous model\n        (2.0, 4.0, 1.0e-1, 1.0),\n        # Case D: Edge case near the discrete Nyquist wavenumber\n        (1.0e1, 3.0e1, 5.0e-2, np.pi / 5.0e-2),\n    ]\n\n    results = []\n    for case in test_cases:\n        ch, sigma, dx, k = case\n        \n        # --- Continuous Case ---\n        # The dispersion relation is ω² - σω + (ch*k)² = 0\n        # Roots are ω = [σ ± sqrt(σ² - 4(ch*k)²)] / 2\n        discriminant_cont = sigma**2 - 4 * ch**2 * k**2\n        \n        if discriminant_cont >= 0:\n            sqrt_disc_cont = np.sqrt(discriminant_cont)\n            omega_minus_cont_val = (sigma - sqrt_disc_cont) / 2.0\n            omega_plus_cont_val = (sigma + sqrt_disc_cont) / 2.0\n        else:\n            sqrt_disc_cont = np.sqrt(-discriminant_cont)\n            # The roots are complex conjugates\n            real_part = sigma / 2.0\n            imag_part = sqrt_disc_cont / 2.0\n            omega_minus_cont_val = complex(real_part, -imag_part)\n            omega_plus_cont_val = complex(real_part, imag_part)\n\n        # --- Discrete Case ---\n        # We replace k² with k_eff² = (4/dx²) * sin²(k*dx/2)\n        # The dispersion relation is ω² - σω + (ch*k_eff)² = 0\n        if dx == 0: # Avoid division by zero, though not in test cases\n             k_eff_sq = k**2\n        else:\n            k_eff_sq = (4.0 / dx**2) * (np.sin(k * dx / 2.0))**2\n\n        discriminant_disc = sigma**2 - 4 * ch**2 * k_eff_sq\n        \n        if discriminant_disc >= 0:\n            sqrt_disc_disc = np.sqrt(discriminant_disc)\n            omega_minus_disc_val = (sigma - sqrt_disc_disc) / 2.0\n            omega_plus_disc_val = (sigma + sqrt_disc_disc) / 2.0\n        else:\n            sqrt_disc_disc = np.sqrt(-discriminant_disc)\n            real_part = sigma / 2.0\n            imag_part = sqrt_disc_disc / 2.0\n            omega_minus_disc_val = complex(real_part, -imag_part)\n            omega_plus_disc_val = complex(real_part, imag_part)\n\n        # Append the 8 required float values for the current test case.\n        # Order: Re(ω-), Im(ω-), Re(ω+), Im(ω+), Re(ω_disc-), Im(ω_disc-), Re(ω_disc+), Im(ω_disc+)\n        case_results = [\n            float(np.real(omega_minus_cont_val)),\n            float(np.imag(omega_minus_cont_val)),\n            float(np.real(omega_plus_cont_val)),\n            float(np.imag(omega_plus_cont_val)),\n            float(np.real(omega_minus_disc_val)),\n            float(np.imag(omega_minus_disc_val)),\n            float(np.real(omega_plus_disc_val)),\n            float(np.imag(omega_plus_disc_val)),\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is a Python-style list of lists.\n    list_of_lists_str = \"[\" + \",\".join(str(res) for res in results) + \"]\"\n    print(list_of_lists_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The core of magnetohydrodynamics is the bidirectional coupling between a conducting fluid's motion and the magnetic field. This hands-on exercise  provides a concrete example of this interaction by exploring how a simple acoustic wave in a fluid can induce a magnetic field. By working through the linearized induction equation in a simplified geometry, you will derive a quantitative measure of this magnetoacoustic coupling, expressing it in terms of the fundamental dimensionless parameters of MHD: the Mach number $Ma$ and the Magnetic Reynolds number $Rm$. This practice elegantly connects abstract theory to a tangible physical outcome, demonstrating the generative power of the induction equation.",
            "id": "3513668",
            "problem": "A compressible, electrically conducting fluid is contained in a one-dimensional cavity of length $L$ with perfectly conducting end walls. A uniform, static magnetic field $\\mathbf{B}_0$ is imposed along the $z$-direction, $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{e}}_z$. The fluid is driven by a standing acoustic mode along the $x$-direction with velocity field $\\mathbf{u}(x,t) = u_x(x,t)\\,\\hat{\\mathbf{e}}_x$, where the fundamental mode is prescribed as $u_x(x,t) = U_0 \\sin(k x)\\cos(\\omega t)$ with $k = \\pi/L$ and $\\omega = c_s k$. Here $c_s$ is the (constant) adiabatic sound speed. Assume linear perturbations to the magnetic field $\\delta \\mathbf{B}(x,t) = b(x,t)\\,\\hat{\\mathbf{e}}_z$ induced by the flow, and neglect the back-reaction of $\\delta \\mathbf{B}$ on the flow (kinematic regime). The magnetic diffusivity is $\\eta$ and the magnetic permeability is $\\mu_0$. The mass density $\\rho$ is constant.\n\nStart from the following fundamental base:\n- Maxwell–Faraday law: $\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$.\n- Ohm’s law for a moving conductor: $\\mathbf{J} = \\sigma \\left(\\mathbf{E} + \\mathbf{u}\\times \\mathbf{B}\\right)$ with $\\eta = 1/(\\mu_0 \\sigma)$.\n- Magnetic field solenoidality: $\\nabla \\cdot \\mathbf{B} = 0$.\n- Acoustic dispersion for the standing mode: $\\omega = c_s k$.\n- Definitions of key dimensionless groups with respect to the acoustic mode scale $\\ell = 1/k$: the Mach number $Ma = U_0/c_s$ and the Magnetic Reynolds number $Rm = U_0/(\\eta k)$.\n\nUnder these assumptions, the magnetic induction equation for $b(x,t)$ in one dimension with appropriate boundary conditions admits a unique solution. Define the time- and space-averaged kinetic energy density of the acoustic mode as $\\langle E_{\\mathrm{kin}}\\rangle = \\frac{1}{2}\\rho \\langle u_x^2\\rangle$ and the time- and space-averaged magnetic perturbation energy density as $\\langle E_{\\mathrm{mag}}\\rangle = \\frac{1}{2\\mu_0}\\langle b^2\\rangle$, where $\\langle\\cdot\\rangle$ denotes averaging over one acoustic period $T = 2\\pi/\\omega$ and over the cavity length $L$. The magnetoacoustic coupling coefficient is defined as the dimensionless ratio $C = \\langle E_{\\mathrm{mag}}\\rangle/\\langle E_{\\mathrm{kin}}\\rangle$.\n\nYour task is to:\n- Derive, from the fundamental base above and the stated geometry and driving, a closed-form expression for $C$ as a function of $Ma$ and $Rm$ (and the given physical parameters), valid in the long-time periodic state after transients have decayed.\n- Implement a program that evaluates $C$ for a set of test cases, using the derived expression. All inputs and outputs must be in the International System of Units (SI), except $Ma$, $Rm$, and $C$ which are dimensionless.\n\nUse the following fixed physical parameters for all test cases:\n- Fluid mass density $\\rho = 0.1~\\mathrm{kg/m^3}$.\n- Magnetic permeability $\\mu_0 = 4\\pi\\times 10^{-7}~\\mathrm{H/m}$.\n- Uniform magnetic field magnitude $B_0 = 0.5~\\mathrm{T}$.\n- Adiabatic sound speed $c_s = 10^4~\\mathrm{m/s}$.\n- Cavity length $L = 1.0~\\mathrm{m}$, so $k = \\pi/L$ and $\\omega = c_s k$.\n\nFor each test case, the acoustic amplitude is $U_0 = Ma \\, c_s$, and the magnetic diffusivity is $\\eta = U_0/(k\\,Rm)$ as implied by the definition of $Rm$.\n\nTest suite (each test case is a pair $(Ma,Rm)$):\n- Case $1$: $(Ma,Rm) = (0.1, 10)$.\n- Case $2$: $(Ma,Rm) = (0.1, 0.1)$.\n- Case $3$: $(Ma,Rm) = (0.01, 1000)$.\n- Case $4$: $(Ma,Rm) = (0.5, 50)$.\n- Case $5$: $(Ma,Rm) = (0.2, 1)$.\n\nYour program should compute $C$ for each case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places and expressed as a dimensionless decimal number (no unit), in the order of the cases $1$ through $5$. For example, the output format must be of the form $[c_1,c_2,c_3,c_4,c_5]$ where each $c_i$ is the rounded value for case $i$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of magnetohydrodynamics, well-posed with sufficient information to derive a unique solution, and formally stated. The analysis proceeds as follows.\n\nOur first step is to derive the governing partial differential equation for the magnetic field perturbation, $b(x,t)$, from the fundamental laws provided. The magnetic induction equation is derived by combining the Maxwell-Faraday law, $\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$, and Ohm's law for a moving conductor, $\\mathbf{J} = \\sigma(\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B})$. Solving Ohm's law for the electric field $\\mathbf{E}$ gives $\\mathbf{E} = \\mathbf{J}/\\sigma - \\mathbf{u} \\times \\mathbf{B}$. Substituting this into the Faraday law yields $\\partial_t \\mathbf{B} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B} - \\mathbf{J}/\\sigma)$. We use Ampere's law (in the low-frequency MHD limit), $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$, to replace the current density $\\mathbf{J}$, and the definition of magnetic diffusivity, $\\eta = 1/(\\mu_0\\sigma)$, to arrive at the general magnetic induction equation:\n$$\n\\partial_t \\mathbf{B} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) - \\nabla \\times (\\eta \\nabla \\times \\mathbf{B})\n$$\nThe total magnetic field is $\\mathbf{B}(x,t) = \\mathbf{B}_0 + \\delta \\mathbf{B}(x,t) = (B_0 + b(x,t))\\,\\hat{\\mathbf{e}}_z$, and the velocity field is $\\mathbf{u}(x,t) = u_x(x,t)\\,\\hat{\\mathbf{e}}_x$. The problem specifies the kinematic regime with linear perturbations, so we linearize the equation by keeping only terms of first order in the perturbations $u_x$ and $b$. The term $\\mathbf{u} \\times \\mathbf{B}$ becomes:\n$$\n\\mathbf{u} \\times \\mathbf{B} = (u_x \\hat{\\mathbf{e}}_x) \\times ((B_0 + b) \\hat{\\mathbf{e}}_z) = -u_x(B_0 + b)\\hat{\\mathbf{e}}_y \\approx -u_x B_0 \\hat{\\mathbf{e}}_y\n$$\nwhere the product $u_x b$ is a second-order term and is neglected. The curl of this term is:\n$$\n\\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) \\approx \\nabla \\times (-u_x B_0 \\hat{\\mathbf{e}}_y) = -B_0 \\frac{\\partial u_x}{\\partial x} \\hat{\\mathbf{e}}_z\n$$\nThe diffusive term is:\n$$\n\\nabla \\times (\\eta \\nabla \\times \\mathbf{B}) = \\nabla \\times \\left(\\eta \\nabla \\times (B_0 \\hat{\\mathbf{e}}_z + b \\hat{\\mathbf{e}}_z)\\right) = \\nabla \\times \\left(\\eta \\frac{\\partial b}{\\partial x} \\hat{\\mathbf{e}}_y\\right) = \\eta \\frac{\\partial^2 b}{\\partial x^2} \\hat{\\mathbf{e}}_z\n$$\nassuming uniform magnetic diffusivity $\\eta$. The time derivative is simply $\\partial_t \\mathbf{B} = \\frac{\\partial b}{\\partial t} \\hat{\\mathbf{e}}_z$. Projecting the full induction equation onto the $\\hat{\\mathbf{e}}_z$ direction yields the one-dimensional scalar PDE for $b(x,t)$:\n$$\n\\frac{\\partial b}{\\partial t} - \\eta \\frac{\\partial^2 b}{\\partial x^2} = -B_0 \\frac{\\partial u_x}{\\partial x}\n$$\nThe velocity is given as $u_x(x,t) = U_0 \\sin(kx)\\cos(\\omega t)$, so its spatial derivative is $\\partial_x u_x = U_0 k \\cos(kx)\\cos(\\omega t)$. The PDE becomes:\n$$\n\\frac{\\partial b}{\\partial t} - \\eta \\frac{\\partial^2 b}{\\partial x^2} = -B_0 U_0 k \\cos(kx)\\cos(\\omega t)\n$$\nThe boundary conditions at the perfectly conducting walls at $x=0$ and $x=L$ require the tangential component of the electric field to be zero. The electric field is $\\mathbf{E} \\approx - \\mathbf{u} \\times \\mathbf{B} + \\eta \\nabla \\times \\mathbf{B} = (u_x B_0 + \\eta \\partial_x b)\\hat{\\mathbf{e}}_y$. Since $u_x = 0$ at $x=0$ and $x=L$ (as $kL=\\pi$), the condition $E_y=0$ implies Neumann boundary conditions for the perturbation: $\\partial_x b = 0$ at $x=0,L$.\n\nWe seek the periodic steady-state solution after transients decay. We use complex notation, setting $u_x(x,t) = \\mathrm{Re}\\{U_0 \\sin(kx) e^{i\\omega t}\\}$ and seeking a solution $b(x,t) = \\mathrm{Re}\\{\\hat{b}(x)e^{i\\omega t}\\}$. Substituting into the PDE gives an ordinary differential equation for the complex amplitude $\\hat{b}(x)$:\n$$\ni\\omega \\hat{b}(x) - \\eta \\frac{d^2 \\hat{b}}{d x^2} = -B_0 U_0 k \\cos(kx)\n$$\n$$\n\\frac{d^2 \\hat{b}}{d x^2} - \\frac{i\\omega}{\\eta} \\hat{b}(x) = \\frac{B_0 U_0 k}{\\eta} \\cos(kx)\n$$\nwith boundary conditions $d\\hat{b}/dx = 0$ at $x=0,L$. We propose a particular solution of the form $\\hat{b}_p(x) = A \\cos(kx)$. Substituting this into the ODE:\n$$\n-A k^2 \\cos(kx) - \\frac{i\\omega}{\\eta} A \\cos(kx) = \\frac{B_0 U_0 k}{\\eta} \\cos(kx)\n$$\nSolving for the complex constant $A$:\n$$\nA \\left(-k^2 - \\frac{i\\omega}{\\eta}\\right) = \\frac{B_0 U_0 k}{\\eta} \\implies A = -\\frac{B_0 U_0 k}{\\eta k^2 + i\\omega}\n$$\nThe proposed solution $\\hat{b}_p(x) = A \\cos(kx)$ has derivative $d\\hat{b}_p/dx = -Ak\\sin(kx)$, which is zero at $x=0$ and $x=L$ (since $kL=\\pi$). Thus, this particular solution satisfies the boundary conditions, and since the problem must have a unique solution, this is the complete steady-state solution.\nSo, $\\hat{b}(x) = -\\frac{B_0 U_0 k}{\\eta k^2 + i\\omega} \\cos(kx)$.\n\nNext, we calculate the time- and space-averaged energy densities. The averaging operation is $\\langle f \\rangle = \\frac{1}{LT} \\int_0^L \\int_0^T f(x,t) \\,dt\\,dx$, with $T=2\\pi/\\omega$ and $k=\\pi/L$.\nThe kinetic energy density is $\\langle E_{\\mathrm{kin}}\\rangle = \\frac{1}{2}\\rho \\langle u_x^2\\rangle$.\n$$\n\\langle u_x^2 \\rangle = \\langle U_0^2 \\sin^2(kx) \\cos^2(\\omega t) \\rangle = U_0^2 \\left(\\frac{1}{L}\\int_0^L \\sin^2(kx) dx\\right) \\left(\\frac{1}{T}\\int_0^T \\cos^2(\\omega t) dt\\right)\n$$\nThe standard integrals yield $\\frac{1}{2}$ for both averages. Thus, $\\langle u_x^2 \\rangle = U_0^2 (1/2)(1/2) = U_0^2/4$.\n$$\n\\langle E_{\\mathrm{kin}}\\rangle = \\frac{1}{2}\\rho \\left(\\frac{U_0^2}{4}\\right) = \\frac{1}{8}\\rho U_0^2\n$$\nThe magnetic energy density is $\\langle E_{\\mathrm{mag}}\\rangle = \\frac{1}{2\\mu_0} \\langle b^2 \\rangle$. For a complex amplitude $\\hat{b}(x)$, the time-average of the real signal squared is $\\langle (\\mathrm{Re}\\{\\hat{b}e^{i\\omega t}\\})^2 \\rangle_t = \\frac{1}{2}|\\hat{b}|^2$.\n$$\n|\\hat{b}(x)|^2 = \\left| -\\frac{B_0 U_0 k}{\\eta k^2 + i\\omega} \\cos(kx) \\right|^2 = \\frac{B_0^2 U_0^2 k^2}{(\\eta k^2)^2 + \\omega^2} \\cos^2(kx)\n$$\nNow, we perform the spatial average:\n$$\n\\langle b^2 \\rangle = \\left\\langle \\frac{1}{2}|\\hat{b}(x)|^2 \\right\\rangle_x = \\frac{B_0^2 U_0^2 k^2}{2((\\eta k^2)^2 + \\omega^2)} \\left(\\frac{1}{L}\\int_0^L \\cos^2(kx) dx\\right) = \\frac{B_0^2 U_0^2 k^2}{2((\\eta k^2)^2 + \\omega^2)} \\left(\\frac{1}{2}\\right) = \\frac{B_0^2 U_0^2 k^2}{4((\\eta k^2)^2 + \\omega^2)}\n$$\nThe averaged magnetic energy density is:\n$$\n\\langle E_{\\mathrm{mag}}\\rangle = \\frac{1}{2\\mu_0} \\langle b^2 \\rangle = \\frac{B_0^2 U_0^2 k^2}{8\\mu_0 ((\\eta k^2)^2 + \\omega^2)}\n$$\nFinally, the magnetoacoustic coupling coefficient $C$ is the ratio of these energies:\n$$\nC = \\frac{\\langle E_{\\mathrm{mag}}\\rangle}{\\langle E_{\\mathrm{kin}}\\rangle} = \\frac{\\frac{B_0^2 U_0^2 k^2}{8\\mu_0 ((\\eta k^2)^2 + \\omega^2)}}{\\frac{1}{8}\\rho U_0^2} = \\frac{B_0^2 k^2}{\\mu_0 \\rho ((\\eta k^2)^2 + \\omega^2)}\n$$\nTo express this in terms of the Mach number $Ma = U_0/c_s$ and Magnetic Reynolds number $Rm = U_0/(\\eta k)$, we substitute $\\omega=c_s k$ and $\\eta = U_0/(k \\cdot Rm) = (Ma \\cdot c_s)/(k \\cdot Rm)$.\nThe denominator is:\n$$\n(\\eta k^2)^2 + \\omega^2 = \\left(\\frac{Ma \\cdot c_s}{k \\cdot Rm} k^2\\right)^2 + (c_s k)^2 = (c_s k)^2 \\left( \\left(\\frac{Ma}{Rm}\\right)^2 + 1 \\right)\n$$\nSubstituting this into the expression for $C$:\n$$\nC = \\frac{B_0^2 k^2}{\\mu_0 \\rho (c_s k)^2 (1 + (Ma/Rm)^2)} = \\frac{B_0^2}{\\mu_0 \\rho c_s^2} \\frac{1}{1 + (Ma/Rm)^2}\n$$\nThis is the final closed-form expression for the coupling coefficient. The term $B_0^2/(\\mu_0 \\rho)$ is the square of the Alfvén speed, $v_A^2$. Thus, $C$ can be interpreted as the ratio of characteristic magnetic to acoustic energy densities, $C = (v_A/c_s)^2 / (1 + (Ma/Rm)^2)$, modified by the competition between advection and diffusion of the magnetic field.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the magnetoacoustic coupling coefficient C for a set of test cases.\n    \"\"\"\n    \n    # Define the fixed physical parameters from the problem statement.\n    # All values are in SI units.\n    rho = 0.1  # kg/m^3, Fluid mass density\n    mu0 = 4 * np.pi * 1e-7  # H/m, Magnetic permeability of free space\n    B0 = 0.5  # T, Uniform magnetic field magnitude\n    cs = 1e4  # m/s, Adiabatic sound speed\n    \n    # Cavity length L is not needed for the final expression of C, but it is a given.\n    # The wave number k and frequency omega are also absorbed into dimensionless numbers.\n    # L = 1.0  # m\n    # k = np.pi / L\n    # omega = cs * k\n\n    # Define the test suite. Each case is a tuple (Ma, Rm).\n    test_cases = [\n        (0.1, 10.0),\n        (0.1, 0.1),\n        (0.01, 1000.0),\n        (0.5, 50.0),\n        (0.2, 1.0)\n    ]\n\n    results = []\n\n    # The derived formula for the coupling coefficient C is:\n    # C = (B0^2 / (mu0 * rho * cs^2)) / (1 + (Ma / Rm)^2)\n    # The first term is a constant prefactor.\n    \n    prefactor = B0**2 / (mu0 * rho * cs**2)\n\n    for Ma, Rm in test_cases:\n        # Calculate C for the current test case.\n        # The problem statement implies Rm will be non-zero as it is computed\n        # from U0, k, and eta which are all non-zero.\n        C = prefactor / (1 + (Ma / Rm)**2)\n        \n        # Append the result formatted to six decimal places.\n        results.append(f\"{C:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}