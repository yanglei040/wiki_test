{
    "hands_on_practices": [
        {
            "introduction": "The heart of an Algebraic Multigrid (AMG) method is the construction of a coarse-grid operator that effectively represents the low-frequency behavior of the fine-grid system. This hands-on exercise demystifies this process by guiding you through a single step of unsmoothed aggregation for a small, coupled system . By manually computing the Galerkin coarse operator $A_c = P^T A P$, you will gain concrete insight into how interactions between different physical fields are captured and preserved on the coarse grid, a crucial element for designing efficient multigrid solvers for multiphysics problems.",
            "id": "3515974",
            "problem": "Consider a symmetric positive definite $6\\times 6$ block-coupled matrix $A$ arising from a two-field discretization on three spatial points, ordered as $\\{u_{1},u_{2},u_{3},v_{1},v_{2},v_{3}\\}$:\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  \\gamma  0  0\\\\\n-1  2  -1  0  \\gamma  0\\\\\n0  -1  2  0  0  \\gamma\\\\\n\\gamma  0  0  1.5  -0.5  0\\\\\n0  \\gamma  0  -0.5  1.5  -0.5\\\\\n0  0  \\gamma  0  -0.5  1.5\n\\end{pmatrix},\n$$\nwith coupling strength $\\gamma=0.5$. In an unsmoothed aggregation Algebraic Multigrid (AMG) setup, use three aggregates $\\mathcal{A}_{1}=\\{u_{1},v_{1}\\}$, $\\mathcal{A}_{2}=\\{u_{2},v_{2}\\}$, and $\\mathcal{A}_{3}=\\{u_{3},v_{3}\\}$, and define the piecewise-constant prolongation $P\\in\\mathbb{R}^{6\\times 3}$ by\n$$\nP \\;=\\; \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}, \\quad R \\;=\\; P^{T}.\n$$\nStarting from the Galerkin coarse-operator definition $A_{c} \\;=\\; R\\,A\\,P \\;=\\; P^{T} A P$, compute $A_{c}$ explicitly. Then, using the structure of $A$ and the chosen aggregates, explain qualitatively how the off-diagonal field coupling terms in $A$ are represented on the coarse level $A_{c}$ when aggregates mix both fields. Finally, provide the exact value of $\\det(A_{c})$ as a single scalar. Do not round; report the exact value.",
            "solution": "The problem statement will first be validated according to the specified criteria.\n\n### Step 1: Extract Givens\n- A symmetric positive definite $6 \\times 6$ block-coupled matrix $A$:\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  \\gamma  0  0\\\\\n-1  2  -1  0  \\gamma  0\\\\\n0  -1  2  0  0  \\gamma\\\\\n\\gamma  0  0  1.5  -0.5  0\\\\\n0  \\gamma  0  -0.5  1.5  -0.5\\\\\n0  0  \\gamma  0  -0.5  1.5\n\\end{pmatrix}\n$$\n- The variable ordering is $\\{u_{1},u_{2},u_{3},v_{1},v_{2},v_{3}\\}$.\n- The coupling strength is $\\gamma=0.5$.\n- Three aggregates are defined for an unsmoothed aggregation Algebraic Multigrid (AMG) setup: $\\mathcal{A}_{1}=\\{u_{1},v_{1}\\}$, $\\mathcal{A}_{2}=\\{u_{2},v_{2}\\}$, and $\\mathcal{A}_{3}=\\{u_{3},v_{3}\\}$.\n- The piecewise-constant prolongation operator $P\\in\\mathbb{R}^{6\\times 3}$ is defined as:\n$$\nP \\;=\\; \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}\n$$\n- The restriction operator $R$ is the transpose of $P$, i.e., $R = P^{T}$.\n- The Galerkin coarse-operator is defined as $A_{c} \\;=\\; R\\,A\\,P \\;=\\; P^{T} A P$.\n- The tasks are to:\n    1. Compute $A_{c}$ explicitly.\n    2. Qualitatively explain the representation of off-diagonal field coupling on the coarse level.\n    3. Provide the exact value of $\\det(A_{c})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation:\n- **Scientifically Grounded:** The problem is set within the standard mathematical framework of numerical linear algebra, specifically concerning AMG methods for solving systems of linear equations. All concepts used—symmetric positive definite matrices, block-coupled systems, aggregation, prolongation, restriction, and Galerkin coarsening—are well-established and fundamental to the field of scientific computing.\n- **Well-Posed:** The problem provides explicit definitions for all matrices ($A$, $P$) and constants ($\\gamma$) required for the calculation. The formula for the coarse-grid operator $A_c$ is standard and unambiguous. The calculation involves deterministic matrix multiplication and a determinant computation, which yield a unique result.\n- **Objective:** The problem is stated using precise mathematical terminology and is free from any subjective or ambiguous language.\n- **Completeness and Consistency:** All necessary information is provided. The dimensions of the matrices are consistent for the required operation $P^T A P$: $P^T$ is $3 \\times 6$, $A$ is $6 \\times 6$, and $P$ is $6 \\times 3$. The product results in a $3 \\times 3$ matrix, as expected for a coarse operator with three aggregates. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and self-contained. It is a standard exercise in multigrid methods. Therefore, the problem is deemed **valid**. The solution will now be derived.\n\nThe first step is to substitute the given value of the coupling strength $\\gamma=0.5$ into the matrix $A$:\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  0.5  0  0\\\\\n-1  2  -1  0  0.5  0\\\\\n0  -1  2  0  0  0.5\\\\\n0.5  0  0  1.5  -0.5  0\\\\\n0  0.5  0  -0.5  1.5  -0.5\\\\\n0  0  0.5  0  -0.5  1.5\n\\end{pmatrix}\n$$\nThe problem can be analyzed using a $2 \\times 2$ block structure based on the two fields, $u$ and $v$. Let $A$ be partitioned into $3 \\times 3$ blocks:\n$$\nA = \\begin{pmatrix} A_{uu}  A_{uv} \\\\ A_{vu}  A_{vv} \\end{pmatrix}\n$$\nwhere\n$$\nA_{uu} = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}, \\quad\nA_{uv} = \\begin{pmatrix} 0.5  0  0 \\\\ 0  0.5  0 \\\\ 0  0  0.5 \\end{pmatrix} = 0.5\\,I\n$$\n$$\nA_{vu} = \\begin{pmatrix} 0.5  0  0 \\\\ 0  0.5  0 \\\\ 0  0  0.5 \\end{pmatrix} = 0.5\\,I, \\quad\nA_{vv} = \\begin{pmatrix} 1.5  -0.5  0 \\\\ -0.5  1.5  -0.5 \\\\ 0  -0.5  1.5 \\end{pmatrix}\n$$\nHere, $I$ is the $3 \\times 3$ identity matrix. The prolongation operator $P$ and the restriction operator $R=P^T$ can also be written in block form:\n$$\nP = \\begin{pmatrix} I \\\\ I \\end{pmatrix}, \\quad R = P^T = \\begin{pmatrix} I  I \\end{pmatrix}\n$$\nThe coarse-grid operator $A_c$ is computed using the Galerkin product $A_c = P^T A P$:\n$$\nA_c = \\begin{pmatrix} I  I \\end{pmatrix} \\begin{pmatrix} A_{uu}  A_{uv} \\\\ A_{vu}  A_{vv} \\end{pmatrix} \\begin{pmatrix} I \\\\ I \\end{pmatrix}\n$$\nPerforming the block-matrix multiplication:\n$$\nA_c = \\begin{pmatrix} I  I \\end{pmatrix} \\begin{pmatrix} A_{uu}I + A_{uv}I \\\\ A_{vu}I + A_{vv}I \\end{pmatrix} = \\begin{pmatrix} I  I \\end{pmatrix} \\begin{pmatrix} A_{uu} + A_{uv} \\\\ A_{vu} + A_{vv} \\end{pmatrix}\n$$\n$$\nA_c = I(A_{uu} + A_{uv}) + I(A_{vu} + A_{vv}) = A_{uu} + A_{uv} + A_{vu} + A_{vv}\n$$\nSubstituting the block matrices:\n$$\nA_c = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix} + \\begin{pmatrix} 0.5  0  0 \\\\ 0  0.5  0 \\\\ 0  0  0.5 \\end{pmatrix} + \\begin{pmatrix} 0.5  0  0 \\\\ 0  0.5  0 \\\\ 0  0  0.5 \\end{pmatrix} + \\begin{pmatrix} 1.5  -0.5  0 \\\\ -0.5  1.5  -0.5 \\\\ 0  -0.5  1.5 \\end{pmatrix}\n$$\nSumming the matrices element-wise:\n$$\nA_c = \\begin{pmatrix} 2+0.5+0.5+1.5  -1+0+0-0.5  0+0+0+0 \\\\ -1+0+0-0.5  2+0.5+0.5+1.5  -1+0+0-0.5 \\\\ 0+0+0+0  -1+0+0-0.5  2+0.5+0.5+1.5 \\end{pmatrix}\n$$\n$$\nA_c = \\begin{pmatrix} 4.5  -1.5  0 \\\\ -1.5  4.5  -1.5 \\\\ 0  -1.5  4.5 \\end{pmatrix}\n$$\n\nNext, we provide a qualitative explanation of how the off-diagonal field coupling is represented on the coarse level.\nThe aggregation strategy groups the $i$-th degree of freedom (DOF) of the first field, $u_i$, with the $i$-th DOF of the second field, $v_i$, into a single coarse-level aggregate $\\mathcal{A}_{i} = \\{u_i, v_i\\}$. This is known as point-wise or field-mixed aggregation. The prolongation operator $P$ maps the $i$-th coarse DOF to a constant value of $1$ for both fine DOFs ($u_i$ and $v_i$) in the $i$-th aggregate.\n\nThe Galerkin operator $A_c = P^T A P$ creates coarse-level connections by summing up the fine-level connections. The entry $(A_c)_{ij}$ represents the total strength of connections between all fine DOFs in aggregate $\\mathcal{A}_i$ and all fine DOFs in aggregate $\\mathcal{A}_j$.\nThe calculation $A_c = A_{uu} + A_{uv} + A_{vu} + A_{vv}$ demonstrates this process mathematically. The coarse operator is a sum of all fine-level interaction blocks. The intra-field blocks, $A_{uu}$ and $A_{vv}$, describe interactions within the $u$ and $v$ fields, respectively. The inter-field (off-diagonal coupling) blocks, $A_{uv}$ and $A_{vu}$, describe interactions between the $u$ and $v$ fields.\nBy summing all these blocks, the inter-field coupling is not discarded; instead, its strength is absorbed directly into the entries of the coarse-level operator $A_c$. Specifically, the coupling term $\\gamma$ from blocks $A_{uv}$ and $A_{vu}$ contributes to the diagonal entries of $A_c$. This ensures that the strong coupling between fields at the same spatial point is properly represented on the coarse grid, which is crucial for the efficiency of the multigrid solver. The original $2 \\times 2$ block structure is collapsed into a scalar structure on the coarse level, where each coarse variable implicitly carries information from both original fields.\n\nFinally, we compute the determinant of $A_c$. To simplify the calculation and maintain exactness, we can factor out a common term from $A_c$:\n$$\nA_c = \\begin{pmatrix} \\frac{9}{2}  -\\frac{3}{2}  0 \\\\ -\\frac{3}{2}  \\frac{9}{2}  -\\frac{3}{2} \\\\ 0  -\\frac{3}{2}  \\frac{9}{2} \\end{pmatrix} = \\frac{3}{2} \\begin{pmatrix} 3  -1  0 \\\\ -1  3  -1 \\\\ 0  -1  3 \\end{pmatrix}\n$$\nUsing the property $\\det(kM) = k^n \\det(M)$ for an $n \\times n$ matrix $M$ and scalar $k$:\n$$\n\\det(A_c) = \\left(\\frac{3}{2}\\right)^3 \\det \\begin{pmatrix} 3  -1  0 \\\\ -1  3  -1 \\\\ 0  -1  3 \\end{pmatrix}\n$$\nThe determinant of the $3 \\times 3$ matrix is calculated using the cofactor expansion along the first row:\n$$\n\\det \\begin{pmatrix} 3  -1  0 \\\\ -1  3  -1 \\\\ 0  -1  3 \\end{pmatrix} = 3 \\begin{vmatrix} 3  -1 \\\\ -1  3 \\end{vmatrix} - (-1) \\begin{vmatrix} -1  -1 \\\\ 0  3 \\end{vmatrix} + 0\n$$\n$$\n= 3(3 \\cdot 3 - (-1) \\cdot (-1)) + 1((-1) \\cdot 3 - (-1) \\cdot 0)\n$$\n$$\n= 3(9 - 1) + 1(-3 - 0) = 3(8) - 3 = 24 - 3 = 21\n$$\nNow, we can find the determinant of $A_c$:\n$$\n\\det(A_c) = \\left(\\frac{3}{2}\\right)^3 \\times 21 = \\frac{27}{8} \\times 21 = \\frac{567}{8}\n$$\nThe exact value of the determinant is $\\frac{567}{8}$, which is $70.875$ in decimal form.",
            "answer": "$$\n\\boxed{\\frac{567}{8}}\n$$"
        },
        {
            "introduction": "While a well-constructed coarse operator is essential, a multigrid cycle's efficiency hinges equally on its smoother, which is responsible for damping high-frequency errors. To analyze and design effective smoothers, we turn to powerful analytical tools like Local Fourier Analysis (LFA). This practice introduces you to LFA by asking you to derive the smoothing factor for a block Jacobi smoother applied to a coupled reaction-diffusion problem . This analysis will reveal how effectively the smoother handles different error frequencies and how its performance is influenced by the physical coupling in the system.",
            "id": "3515964",
            "problem": "Consider a simplified one-dimensional, two-field linear reaction–diffusion coupling posed on an infinite, uniformly spaced grid with spacing $h$, where the two fields $u$ and $v$ are coupled through symmetric linear reaction terms. The standard second-order centered finite-difference approximation to the negative Laplacian $- \\partial_{xx}$ on this grid is defined by $(L u)_{j} = \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}$, so that the discrete operator $-L$ is symmetric positive definite. The resulting coupled algebraic system can be written in block form as\n$$\nA \\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix}\nD_{u}(-L) + c_{u} I + \\beta I  -\\beta I \\\\\n-\\beta I  D_{v}(-L) + c_{v} I + \\beta I\n\\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix} f \\\\ g \\end{pmatrix},\n$$\nwhere $D_{u}  0$ and $D_{v}  0$ are diffusion coefficients, $c_{u} \\ge 0$ and $c_{v} \\ge 0$ are linear reaction coefficients, and $\\beta  0$ is the symmetric coupling strength. Consider the block Jacobi smoother (with relaxation parameter equal to $1$) defined by $M = \\operatorname{diag}\\!\\big(A_{11}, A_{22}\\big)$ and the iteration $x^{(m+1)} = x^{(m)} + M^{-1} \\big(b - A x^{(m)}\\big)$, whose error-propagation operator is $S = I - M^{-1} A$. Using Local Fourier Analysis (LFA), defined here as the analysis of the behavior of $S$ on individual Fourier error modes of the form $e^{\\mathrm{i} \\theta j}$ with $\\theta \\in (-\\pi, \\pi]$, one can characterize the smoothing ability of $S$ on the high-frequency subspace.\n\nStarting from the definitions above and first principles of Fourier mode analysis on the infinite grid, derive the Fourier symbol $\\widehat{S}(\\theta)$, determine its eigenvalues for a given $\\theta$, and define the smoothing factor on the high-frequency set $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$ as the quantity\n$$\n\\mu = \\sup_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\rho\\!\\big(\\widehat{S}(\\theta)\\big),\n$$\nwhere $\\rho(\\cdot)$ denotes the spectral radius. For the parameter values $D_{u} = 0.9$, $D_{v} = 0.3$, $c_{u} = 0.15$, $c_{v} = 0.05$, $\\beta = 0.4$, and $h = 1$, compute the numerical value of the smoothing factor $\\mu$. Round your answer to four significant figures and provide a single real number with no units.",
            "solution": "The problem is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- Coupled algebraic system:\n$$\nA \\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix}\nD_{u}(-L) + c_{u} I + \\beta I  -\\beta I \\\\\n-\\beta I  D_{v}(-L) + c_{v} I + \\beta I\n\\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix} f \\\\ g \\end{pmatrix}\n$$\n- Discrete negative Laplacian on an infinite grid with spacing $h$: $(L u)_{j} = \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}$.\n- Coefficients: $D_{u}  0$, $D_{v}  0$, $c_{u} \\ge 0$, $c_{v} \\ge 0$, $\\beta  0$.\n- Block Jacobi smoother (relaxation parameter $1$): $M = \\operatorname{diag}\\!\\big(A_{11}, A_{22}\\big)$, where $A_{11} = D_{u}(-L) + c_{u} I + \\beta I$ and $A_{22} = D_{v}(-L) + c_{v} I + \\beta I$.\n- Error-propagation operator: $S = I - M^{-1} A$.\n- Analysis method: Local Fourier Analysis on modes $e^{\\mathrm{i} \\theta j}$ for $\\theta \\in (-\\pi, \\pi]$.\n- High-frequency set: $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$.\n- Smoothing factor definition: $\\mu = \\sup_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\rho\\!\\big(\\widehat{S}(\\theta)\\big)$, with $\\rho(\\cdot)$ as the spectral radius.\n- Specific parameter values: $D_{u} = 0.9$, $D_{v} = 0.3$, $c_{u} = 0.15$, $c_{v} = 0.05$, $\\beta = 0.4$, $h = 1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity:\n- **Scientifically Grounded:** Yes. The problem describes a standard reaction-diffusion system discretized by finite differences and analyzed using Local Fourier Analysis (LFA) for a block Jacobi smoother. These are all canonical topics in numerical analysis for partial differential equations and multigrid methods.\n- **Well-Posed:** Yes. The problem provides all necessary definitions, parameters, and a clear objective: compute a specific numerical value. The structure leads to a unique, meaningful solution.\n- **Objective:** Yes. The problem is stated in precise, mathematical language, free from any subjectivity or ambiguity.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, feasible, and well-posed.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The solution process will now proceed.\n\nThe objective is to compute the smoothing factor $\\mu$ for the given block Jacobi smoother. The procedure involves Local Fourier Analysis (LFA) to determine the spectral radius of the smoother's error-propagation operator as a function of the Fourier frequency $\\theta$.\n\nFirst, we determine the Fourier symbol of the discrete negative Laplacian operator, $-L$. The action of $L$ on a Fourier mode $\\phi_j(\\theta) = e^{\\mathrm{i}\\theta j}$ is\n$$\n(L \\phi(\\theta))_j = \\frac{e^{\\mathrm{i}\\theta(j+1)} - 2e^{\\mathrm{i}\\theta j} + e^{\\mathrm{i}\\theta(j-1)}}{h^2} = \\frac{e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta}}{h^2} e^{\\mathrm{i}\\theta j} = \\frac{2\\cos(\\theta) - 2}{h^2} e^{\\mathrm{i}\\theta j}.\n$$\nThe Fourier symbol of $L$ is thus $\\widehat{L}(\\theta) = \\frac{2(\\cos(\\theta) - 1)}{h^2} = -\\frac{4\\sin^2(\\theta/2)}{h^2}$. Consequently, the symbol of the negative Laplacian, which we denote $\\mathcal{L} = -L$, is\n$$\n\\widehat{\\mathcal{L}}(\\theta) = \\frac{4\\sin^2(\\theta/2)}{h^2}.\n$$\nThe system operator $A$ is a $2 \\times 2$ block matrix. Its Fourier symbol, $\\widehat{A}(\\theta)$, is a $2 \\times 2$ matrix obtained by replacing each operator in $A$ with its corresponding symbol.\n$$\n\\widehat{A}(\\theta) = \\begin{pmatrix} D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta  -\\beta \\\\ -\\beta  D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta \\end{pmatrix}.\n$$\nThe block Jacobi smoother is defined by $M = \\operatorname{diag}(A_{11}, A_{22})$. Its Fourier symbol is the diagonal part of $\\widehat{A}(\\theta)$:\n$$\n\\widehat{M}(\\theta) = \\begin{pmatrix} D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta  0 \\\\ 0  D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta \\end{pmatrix}.\n$$\nThe error-propagation operator is $S = I - M^{-1}A$. Its symbol is $\\widehat{S}(\\theta) = I_2 - \\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta)$, where $I_2$ is the $2 \\times 2$ identity matrix.\nFirst, we compute $\\widehat{M}(\\theta)^{-1}$:\n$$\n\\widehat{M}(\\theta)^{-1} = \\begin{pmatrix} \\frac{1}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta}  0 \\\\ 0  \\frac{1}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta} \\end{pmatrix}.\n$$\nThen, the product $\\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta)$ is\n$$\n\\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta) = \\begin{pmatrix} 1  \\frac{-\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta} \\\\ \\frac{-\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}  1 \\end{pmatrix}.\n$$\nFinally, we find the symbol for the error-propagation operator:\n$$\n\\widehat{S}(\\theta) = I_2 - \\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  \\frac{-\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta} \\\\ \\frac{-\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta} \\\\ \\frac{\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}  0 \\end{pmatrix}.\n$$\nTo find the spectral radius $\\rho(\\widehat{S}(\\theta))$, we compute the eigenvalues of $\\widehat{S}(\\theta)$. For a matrix of the form $\\begin{pmatrix} 0  a \\\\ b  0 \\end{pmatrix}$, the eigenvalues $\\lambda$ are given by $\\lambda^2 - ab = 0$, so $\\lambda = \\pm\\sqrt{ab}$. In our case, the eigenvalues are\n$$\n\\lambda(\\theta) = \\pm \\sqrt{\\left(\\frac{\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta}\\right) \\left(\\frac{\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}\\right)} = \\pm \\frac{\\beta}{\\sqrt{(D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta)(D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta)}}.\n$$\nThe spectral radius is the maximum of the absolute values of the eigenvalues. Since all parameters ($D_u, D_v, c_u, c_v, \\beta$) are non-negative (and most are strictly positive) and $\\widehat{\\mathcal{L}}(\\theta) \\ge 0$, the expression under the square root is positive.\n$$\n\\rho(\\widehat{S}(\\theta)) = \\frac{\\beta}{\\sqrt{(D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta)(D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta)}}.\n$$\nThe smoothing factor is defined as $\\mu = \\sup_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\rho(\\widehat{S}(\\theta))$, where $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$. We need to find the maximum of $\\rho(\\widehat{S}(\\theta))$ on this interval.\nLet us analyze the behavior of $\\rho(\\widehat{S}(\\theta))$ as a function of $\\theta$. The numerator $\\beta$ is a constant. The denominator depends on $\\theta$ through $\\widehat{\\mathcal{L}}(\\theta) = \\frac{4\\sin^2(\\theta/2)}{h^2}$.\nOn the interval $\\theta \\in [\\pi/2, \\pi]$, the argument $\\theta/2$ is in the interval $[\\pi/4, \\pi/2]$. In this interval, $\\sin(\\theta/2)$ is a positive and strictly increasing function of $\\theta$. Therefore, $\\sin^2(\\theta/2)$ is also strictly increasing. Since $h  0$, $\\widehat{\\mathcal{L}}(\\theta)$ is a strictly increasing function of $\\theta$ on $[\\pi/2, \\pi]$.\nThe two terms in the product in the denominator, $(D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta)$ and $(D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta)$, are both strictly increasing functions of $\\theta$ because $D_u  0$ and $D_v  0$. The product of two positive, strictly increasing functions is strictly increasing. The square root of a strictly increasing positive function is also strictly increasing.\nThus, the denominator of $\\rho(\\widehat{S}(\\theta))$ is a strictly increasing function of $\\theta$ on $[\\pi/2, \\pi]$. Consequently, $\\rho(\\widehat{S}(\\theta))$, being the reciprocal of such a function (times a positive constant), is a strictly decreasing function on $[\\pi/2, \\pi]$.\nThe supremum of a strictly decreasing function on a closed interval is attained at the left endpoint of the interval. Therefore,\n$$\n\\mu = \\sup_{\\theta \\in [\\pi/2, \\pi]} \\rho(\\widehat{S}(\\theta)) = \\rho(\\widehat{S}(\\pi/2)).\n$$\nWe now substitute the given numerical values: $D_{u} = 0.9$, $D_{v} = 0.3$, $c_{u} = 0.15$, $c_{v} = 0.05$, $\\beta = 0.4$, and $h = 1$.\nFirst, evaluate $\\widehat{\\mathcal{L}}(\\theta)$ at $\\theta = \\pi/2$:\n$$\n\\widehat{\\mathcal{L}}(\\pi/2) = \\frac{4\\sin^2((\\pi/2)/2)}{1^2} = 4\\sin^2(\\pi/4) = 4\\left(\\frac{\\sqrt{2}}{2}\\right)^2 = 4\\left(\\frac{2}{4}\\right) = 2.\n$$\nNext, calculate the terms in the denominator of $\\rho(\\widehat{S}(\\pi/2))$:\n$$\nD_{u}\\widehat{\\mathcal{L}}(\\pi/2) + c_{u} + \\beta = (0.9)(2) + 0.15 + 0.4 = 1.8 + 0.15 + 0.4 = 2.35.\n$$\n$$\nD_{v}\\widehat{\\mathcal{L}}(\\pi/2) + c_{v} + \\beta = (0.3)(2) + 0.05 + 0.4 = 0.6 + 0.05 + 0.4 = 1.05.\n$$\nNow, we compute $\\mu$:\n$$\n\\mu = \\rho(\\widehat{S}(\\pi/2)) = \\frac{0.4}{\\sqrt{(2.35)(1.05)}} = \\frac{0.4}{\\sqrt{2.4675}}.\n$$\nNumerically, $\\sqrt{2.4675} \\approx 1.57082779$.\n$$\n\\mu \\approx \\frac{0.4}{1.57082779} \\approx 0.25464903.\n$$\nRounding the result to four significant figures gives $0.2546$.",
            "answer": "$$\n\\boxed{0.2546}\n$$"
        },
        {
            "introduction": "Moving from theoretical analysis to computational practice, this exercise challenges you to implement a Fourier analysis for a more sophisticated block smoother used in complex simulations. For saddle-point problems, such as those arising in fluid dynamics, simple smoothers are often inadequate, necessitating advanced approaches like the Braess–Sarazin smoother. In this problem, you will write a program to computationally investigate the performance of this smoother, exploring how its parameters and different stabilization schemes affect its smoothing factor . This practice bridges the gap between theory and implementation, providing valuable experience in the computational assessment of numerical methods.",
            "id": "3515985",
            "problem": "Consider a one-dimensional periodic discretization with uniform grid spacing and discrete Fourier analysis of a saddle-point operator arising in multiphysics coupled simulation. The coupled system has the block structure $$A(k)=\\begin{bmatrix}F(k)  B(k)^{\\ast}\\\\ B(k)  -C(k)\\end{bmatrix},$$ where $k$ is the Fourier wavenumber in radians, $F(k)$ is the symbol of a symmetric positive definite elliptic operator (e.g., a discrete Laplacian scaled by viscosity), $B(k)$ is the symbol of a discrete first derivative (coupling operator), and $C(k)$ is a stabilization term in the pressure block. For a periodic grid and standard centered differences, take the following Fourier symbols as the context-appropriate fundamental base: $$F(k)=\\nu\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right),\\qquad B(k)=\\mathrm{i}\\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right),$$ with viscosity $\\nu$ set to $\\nu=1$ for non-dimensionalization. Consider three stabilization models for $C(k)$: no stabilization $C(k)=0$, Laplacian-like stabilization $C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$, and mass-like stabilization $C(k)=\\gamma$ with $\\beta0$ and $\\gamma0$ being scalar parameters.\n\nConstruct the Braess–Sarazin block smoother for this symbol, defined by the block matrix $$M(k)=\\begin{bmatrix}F(k)  B(k)^{\\ast}\\\\ B(k)  -\\alpha\\end{bmatrix},$$ where $\\alpha0$ is a scalar parameter that approximates the Schur complement scaling, and $\\omega0$ is the relaxation parameter. One smoothing step for the error $\\mathbf{e}$ in Fourier space is $$\\mathbf{e}^{\\,\\text{new}}(k)=\\left(I-\\omega\\,M(k)^{-1}A(k)\\right)\\mathbf{e}^{\\,\\text{old}}(k),$$ so the error-propagation matrix is $$E(k)=I-\\omega\\,M(k)^{-1}A(k).$$ The smoothing factor for a given choice of $(\\alpha,\\omega)$ and $C(k)$ is the supremum of the spectral radius of $E(k)$ over the high-frequency set $$\\mathcal{H}=\\left\\{k\\in\\mathbb{R}:\\frac{\\pi}{2}\\le k\\le \\pi\\right\\},$$ sampled uniformly at a specified number of points. Angles must be measured in radians.\n\nYour task is to write a complete, runnable program that:\n- Implements the Fourier symbols $F(k)$ and $B(k)$ as specified.\n- Implements the three stabilization models for $C(k)$: $C(k)=0$, $C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$, and $C(k)=\\gamma$.\n- Constructs the Braess–Sarazin block smoother $M(k)$ and computes the error-propagation matrix $E(k)$.\n- Computes, for each test case, the smoothing factor $\\mu=\\max_{k\\in\\mathcal{H}}\\rho\\!\\left(E(k)\\right)$, where $\\rho(\\cdot)$ denotes the spectral radius (maximum absolute value of the eigenvalues). Use a uniform sampling of $N_{k}$ points in $\\mathcal{H}$.\n- Produces a single line of output containing the smoothing factors for all test cases, as a comma-separated list enclosed in square brackets, with each value rounded to $6$ decimal places.\n\nDesign a test suite that covers multiple facets:\n- A general case with no stabilization $C(k)=0$.\n- Laplacian-like stabilization with moderate $\\beta$.\n- Mass-like stabilization with small and large $\\gamma$.\n- Edge cases with small and large $\\alpha$ and varied $\\omega$ to observe sensitivity.\n- Use $N_{k}=128$ uniform samples in $\\mathcal{H}$.\n\nUse the following specific test cases:\n- Test case $1$: $\\alpha=1.0$, $\\omega=1.0$, $C(k)=0$.\n- Test case $2$: $\\alpha=1.0$, $\\omega=1.0$, $C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$ with $\\beta=0.5$.\n- Test case $3$: $\\alpha=2.0$, $\\omega=1.2$, $C(k)=\\gamma$ with $\\gamma=0.1$.\n- Test case $4$: $\\alpha=4.0$, $\\omega=0.8$, $C(k)=\\gamma$ with $\\gamma=10.0$.\n- Test case $5$: $\\alpha=0.25$, $\\omega=1.5$, $C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$ with $\\beta=2.0$.\n- Test case $6$: $\\alpha=8.0$, $\\omega=0.6$, $C(k)=0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_{1},r_{2},r_{3},r_{4},r_{5},r_{6}]$), where each $r_{j}$ is the smoothing factor for test case $j$, rounded to $6$ decimal places. All angles must be in radians, and no physical units are involved.",
            "solution": "The objective is to analyze the performance of a Braess–Sarazin block smoother for a one-dimensional coupled saddle-point system by computing its smoothing factor using local Fourier analysis. The smoothing factor quantifies the smoother's ability to damp high-frequency error components, which is essential for the efficiency of a multigrid solver.\n\nThe analysis is performed in Fourier space, where differentiation operators become multiplications by their corresponding symbols. The coupled system is represented by the $2 \\times 2$ block matrix symbol:\n$$A(k)=\\begin{bmatrix}F(k)  B(k)^{\\ast}\\\\ B(k)  -C(k)\\end{bmatrix}$$\nwhere $k$ is the Fourier wavenumber in radians.\n\nThe symbols for the operators are given as:\n1.  $F(k) = \\nu \\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$: This is the Fourier symbol of a discrete Laplacian operator, representing a diffusion process. With the non-dimensional viscosity $\\nu=1$, we have $F(k) = 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$. This term is real and positive for $k \\in (0, 2\\pi)$.\n2.  $B(k) = \\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)$: This is the symbol for a discrete first-derivative coupling operator, typical of a staggered-grid discretization. This term is purely imaginary. Its conjugate transpose, $B(k)^{\\ast}$, is its complex conjugate since the symbol is a scalar: $B(k)^{\\ast} = \\overline{\\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)} = -\\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)$.\n3.  $C(k)$: This symbol represents a pressure stabilization term. The problem specifies three models:\n    - No stabilization: $C(k) = 0$.\n    - Laplacian-like stabilization: $C(k) = \\beta \\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$ for some scalar $\\beta  0$.\n    - Mass-like stabilization: $C(k) = \\gamma$ for some scalar $\\gamma  0$.\nAll specified $C(k)$ models are real-valued.\n\nThe Braess–Sarazin smoother is defined by the preconditioner matrix symbol:\n$$M(k)=\\begin{bmatrix}F(k)  B(k)^{\\ast}\\\\ B(k)  -\\alpha\\end{bmatrix}$$\nwhere $\\alpha0$ is a scalar parameter. For the smoother to be well-defined, $M(k)$ must be invertible. The determinant of $M(k)$ is:\n$$\\det(M(k)) = F(k)(-\\alpha) - B(k)^{\\ast}B(k) = -\\alpha F(k) - |B(k)|^2$$\nSubstituting the expressions for $F(k)$ and $B(k)$:\n$$|B(k)|^2 = \\left|\\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)\\right|^2 = 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$$\n$$\\det(M(k)) = -\\alpha \\left(4\\sin^2\\!\\left(\\frac{k}{2}\\right)\\right) - 4\\sin^2\\!\\left(\\frac{k}{2}\\right) = -(\\alpha+1) \\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$$\nThe high-frequency set is $\\mathcal{H} = \\{k \\in \\mathbb{R} : \\frac{\\pi}{2} \\le k \\le \\pi\\}$. For any $k \\in \\mathcal{H}$, $k/2 \\in [\\pi/4, \\pi/2]$, so $\\sin(k/2) \\in [1/\\sqrt{2}, 1]$ and is never zero. Since $\\alpha  0$, the determinant $\\det(M(k))$ is strictly negative on $\\mathcal{H}$, ensuring that $M(k)$ is invertible. The inverse is given by:\n$$M(k)^{-1} = \\frac{1}{\\det(M(k))} \\begin{bmatrix} -\\alpha  -B(k)^{\\ast} \\\\ -B(k)  F(k) \\end{bmatrix}$$\n\nA single smoothing step with relaxation parameter $\\omega0$ updates the error $\\mathbf{e}(k)$ according to the iteration matrix $E(k)$:\n$$E(k) = I - \\omega M(k)^{-1}A(k)$$\nwhere $I$ is the $2 \\times 2$ identity matrix. The effectiveness of the smoother is measured by the smoothing factor $\\mu$, which is the supremum of the spectral radius $\\rho(E(k))$ over the high-frequency set $\\mathcal{H}$:\n$$\\mu = \\max_{k \\in \\mathcal{H}} \\rho(E(k)) = \\max_{k \\in \\mathcal{H}} \\max_{j} |\\lambda_j(E(k))|$$\nwhere $\\lambda_j(E(k))$ are the eigenvalues of $E(k)$.\n\nThe computational procedure to find $\\mu$ for each specified test case is as follows:\n1.  Discretize the high-frequency domain $\\mathcal{H} = [\\pi/2, \\pi]$ into $N_k=128$ uniformly spaced points.\n2.  For each test case, defined by a set of parameters $(\\alpha, \\omega, C(k))$, initialize a variable for the maximum spectral radius, `max_rho`, to $0$.\n3.  Iterate through each discrete wavenumber $k$ in the discretized set:\n    a. Evaluate the symbols $F(k)$, $B(k)$, and $C(k)$ based on the current test case parameters.\n    b. Construct the $2 \\times 2$ complex-valued matrices $A(k)$ and $M(k)$.\n    c. Analytically or numerically compute the inverse $M(k)^{-1}$.\n    d. Form the iteration matrix $E(k) = I - \\omega M(k)^{-1}A(k)$.\n    e. Compute the eigenvalues of $E(k)$. For a $2 \\times 2$ matrix, this is straightforward.\n    f. Calculate the spectral radius $\\rho(E(k))$ by finding the maximum absolute value among the computed eigenvalues.\n    g. Update `max_rho = max(max_rho,` $\\rho(E(k)))$.\n4.  After iterating through all values of $k$, `max_rho` holds the smoothing factor $\\mu$ for the given test case.\n5.  The final output is a list of these smoothing factors for all test cases, formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Braess-Sarazin smoothing factor for several test cases\n    of a 1D coupled saddle-point problem using local Fourier analysis.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Structure: (alpha, omega, C_model, C_param)\n    # C_model can be 'none', 'laplacian', or 'mass'. C_param is beta or gamma.\n    test_cases = [\n        (1.0, 1.0, 'none', None),\n        (1.0, 1.0, 'laplacian', 0.5),\n        (2.0, 1.2, 'mass', 0.1),\n        (4.0, 0.8, 'mass', 10.0),\n        (0.25, 1.5, 'laplacian', 2.0),\n        (8.0, 0.6, 'none', None),\n    ]\n\n    N_k = 128\n    k_values = np.linspace(np.pi / 2, np.pi, N_k)\n    s_k_half_values = np.sin(k_values / 2.0)\n\n    results = []\n\n    for case in test_cases:\n        alpha, omega, c_model, c_param = case\n        max_rho = 0.0\n\n        for s_k_half in s_k_half_values:\n            # Evaluate symbols at the current wavenumber k\n            # F(k) = 4 * sin^2(k/2)\n            F_k = 4.0 * s_k_half**2\n            \n            # B(k) = i * 2 * sin(k/2)\n            B_k = 2.0j * s_k_half\n            B_k_conj = np.conj(B_k)\n\n            # C(k) depends on the stabilization model\n            if c_model == 'none':\n                C_k = 0.0\n            elif c_model == 'laplacian':\n                # C(k) = beta * 4 * sin^2(k/2)\n                beta = c_param\n                C_k = beta * F_k\n            elif c_model == 'mass':\n                # C(k) = gamma\n                gamma = c_param\n                C_k = gamma\n            else:\n                raise ValueError(\"Unknown C(k) model\")\n\n            # Construct the A(k) and M(k) matrices\n            A_k = np.array([[F_k, B_k_conj], \n                            [B_k, -C_k]], dtype=np.complex128)\n            \n            M_k = np.array([[F_k, B_k_conj], \n                            [B_k, -alpha]], dtype=np.complex128)\n\n            # Invert M(k) analytically\n            # det(M(k)) = -alpha * F_k - |B_k|^2\n            det_M_k = -alpha * F_k - (B_k_conj * B_k).real\n            \n            # Check for singularity, though analysis showed it's non-singular on H\n            if np.abs(det_M_k)  1e-15:\n                # This should not happen for k in the high-frequency set\n                # If it does, the spectral radius might be large; continue to next k\n                continue\n            \n            inv_M_k = (1.0 / det_M_k) * np.array([[-alpha, -B_k_conj], \n                                                  [-B_k, F_k]], dtype=np.complex128)\n\n            # Construct the error propagation matrix E(k) = I - omega * M(k)^-1 * A(k)\n            I = np.identity(2, dtype=np.complex128)\n            E_k = I - omega * (inv_M_k @ A_k)\n\n            # Compute spectral radius of E(k)\n            eigenvalues = np.linalg.eigvals(E_k)\n            rho_k = np.max(np.abs(eigenvalues))\n            \n            # Update the maximum spectral radius (smoothing factor)\n            if rho_k > max_rho:\n                max_rho = rho_k\n        \n        results.append(max_rho)\n\n    # Format the results for the final print statement\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}