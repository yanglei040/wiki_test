{
    "hands_on_practices": [
        {
            "introduction": "在代数多重网格（AMG）方法中，核心思想之一是通过伽辽金投影（Galerkin Projection）$A_c = R A P$来构建粗网格算子。这个练习旨在通过一个具体的、小规模的耦合系统来揭示这一过程的内在机制。通过亲手计算，您将理解点聚合（point-wise aggregation）策略如何处理不同物理场之间的耦合，以及这些耦合作用如何在粗网格上得到保留，这对于设计高效的多物理场求解器至关重要。",
            "id": "3515974",
            "problem": "考虑一个由三个空间点上的双场离散化产生的对称正定 $6\\times 6$ 块耦合矩阵 $A$，其变量排序为 $\\{u_{1},u_{2},u_{3},v_{1},v_{2},v_{3}\\}$：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  \\gamma  0  0\\\\\n-1  2  -1  0  \\gamma  0\\\\\n0  -1  2  0  0  \\gamma\\\\\n\\gamma  0  0  1.5  -0.5  0\\\\\n0  \\gamma  0  -0.5  1.5  -0.5\\\\\n0  0  \\gamma  0  -0.5  1.5\n\\end{pmatrix},\n$$\n其中耦合强度 $\\gamma=0.5$。在一个非光滑聚合代数多重网格 (AMG) 设置中，使用三个聚合 $\\mathcal{A}_{1}=\\{u_{1},v_{1}\\}$, $\\mathcal{A}_{2}=\\{u_{2},v_{2}\\}$ 和 $\\mathcal{A}_{3}=\\{u_{3},v_{3}\\}$，并定义分片常数延拓算子 $P\\in\\mathbb{R}^{6\\times 3}$ 如下：\n$$\nP \\;=\\; \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}, \\quad R \\;=\\; P^{T}.\n$$\n从伽辽金粗化算子定义 $A_{c} \\;=\\; R\\,A\\,P \\;=\\; P^{T} A P$ 出发，显式地计算 $A_{c}$。然后，利用 $A$ 的结构和所选的聚合，定性地解释当聚合混合两个场时，$A$ 中的非对角场耦合项是如何在粗糙层 $A_{c}$ 上表示的。最后，提供 $\\det(A_{c})$ 的精确标量值。不要四舍五入；报告精确值。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- 一个对称正定的 $6 \\times 6$ 块耦合矩阵 $A$：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  \\gamma  0  0\\\\\n-1  2  -1  0  \\gamma  0\\\\\n0  -1  2  0  0  \\gamma\\\\\n\\gamma  0  0  1.5  -0.5  0\\\\\n0  \\gamma  0  -0.5  1.5  -0.5\\\\\n0  0  \\gamma  0  -0.5  1.5\n\\end{pmatrix}\n$$\n- 变量排序为 $\\{u_{1},u_{2},u_{3},v_{1},v_{2},v_{3}\\}$。\n- 耦合强度为 $\\gamma=0.5$。\n- 为非光滑聚合代数多重网格 (AMG) 设置定义了三个聚合：$\\mathcal{A}_{1}=\\{u_{1},v_{1}\\}$, $\\mathcal{A}_{2}=\\{u_{2},v_{2}\\}$ 和 $\\mathcal{A}_{3}=\\{u_{3},v_{3}\\}$。\n- 分片常数延拓算子 $P\\in\\mathbb{R}^{6\\times 3}$ 定义为：\n$$\nP \\;=\\; \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}\n$$\n- 限制算子 $R$ 是 $P$ 的转置，即 $R = P^{T}$。\n- 伽辽金粗化算子定义为 $A_{c} \\;=\\; R\\,A\\,P \\;=\\; P^{T} A P$。\n- 任务是：\n    1. 显式计算 $A_{c}$。\n    2. 定性解释非对角场耦合在粗糙层上的表示。\n    3. 提供 $\\det(A_{c})$ 的精确值。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行验证：\n- **科学依据：** 该问题设置在数值线性代数的标准数学框架内，特别涉及求解线性方程组的 AMG 方法。使用的所有概念——对称正定矩阵、块耦合系统、聚合、延拓、限制和伽辽金粗化——在科学计算领域都是成熟且基础的。\n- **适定性：** 该问题为计算所需的所有矩阵（$A$、$P$）和常数（$\\gamma$）提供了明确的定义。粗网格算子 $A_c$ 的公式是标准的、无歧义的。计算涉及确定性的矩阵乘法和行列式计算，这些运算会产生唯一的结果。\n- **客观性：** 该问题使用精确的数学术语陈述，没有任何主观或模糊的语言。\n- **完备性和一致性：** 提供了所有必要的信息。矩阵的维度对于所需运算 $P^T A P$ 是一致的：$P^T$ 是 $3 \\times 6$，$A$ 是 $6 \\times 6$，$P$ 是 $6 \\times 3$。乘积结果是一个 $3 \\times 3$ 矩阵，这符合具有三个聚合的粗化算子的预期。没有矛盾之处。\n\n### 第 3 步：结论与行动\n该问题具有科学合理性、适定性和自洽性。这是多重网格方法中的一个标准练习。因此，该问题被判定为**有效**。现在推导解答。\n\n第一步是将给定的耦合强度值 $\\gamma=0.5$ 代入矩阵 $A$：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  0.5  0  0\\\\\n-1  2  -1  0  0.5  0\\\\\n0  -1  2  0  0  0.5\\\\\n0.5  0  0  1.5  -0.5  0\\\\\n0  0.5  0  -0.5  1.5  -0.5\\\\\n0  0  0.5  0  -0.5  1.5\n\\end{pmatrix}\n$$\n这个问题可以基于两个场 $u$ 和 $v$ 使用 $2 \\times 2$ 的分块结构进行分析。将 $A$ 划分为 $3 \\times 3$ 的块：\n$$\nA = \\begin{pmatrix} A_{uu} & A_{uv} \\\\ A_{vu} & A_{vv} \\end{pmatrix}\n$$\n其中\n$$\nA_{uu} = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}, \\quad\nA_{uv} = \\begin{pmatrix} 0.5 & 0 & 0 \\\\ 0 & 0.5 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} = 0.5\\,I\n$$\n$$\nA_{vu} = \\begin{pmatrix} 0.5 & 0 & 0 \\\\ 0 & 0.5 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} = 0.5\\,I, \\quad\nA_{vv} = \\begin{pmatrix} 1.5 & -0.5 & 0 \\\\ -0.5 & 1.5 & -0.5 \\\\ 0 & -0.5 & 1.5 \\end{pmatrix}\n$$\n此处，$I$ 是 $3 \\times 3$ 的单位矩阵。延拓算子 $P$ 和限制算子 $R=P^T$ 也可以写成分块形式：\n$$\nP = \\begin{pmatrix} I \\\\ I \\end{pmatrix}, \\quad R = P^T = \\begin{pmatrix} I & I \\end{pmatrix}\n$$\n粗网格算子 $A_c$ 通过伽辽金乘积 $A_c = P^T A P$ 计算：\n$$\nA_c = \\begin{pmatrix} I & I \\end{pmatrix} \\begin{pmatrix} A_{uu} & A_{uv} \\\\ A_{vu} & A_{vv} \\end{pmatrix} \\begin{pmatrix} I \\\\ I \\end{pmatrix}\n$$\n进行分块矩阵乘法：\n$$\nA_c = \\begin{pmatrix} I & I \\end{pmatrix} \\begin{pmatrix} A_{uu}I + A_{uv}I \\\\ A_{vu}I + A_{vv}I \\end{pmatrix} = \\begin{pmatrix} I & I \\end{pmatrix} \\begin{pmatrix} A_{uu} + A_{uv} \\\\ A_{vu} + A_{vv} \\end{pmatrix}\n$$\n$$\nA_c = I(A_{uu} + A_{uv}) + I(A_{vu} + A_{vv}) = A_{uu} + A_{uv} + A_{vu} + A_{vv}\n$$\n代入分块矩阵：\n$$\nA_c = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} + \\begin{pmatrix} 0.5 & 0 & 0 \\\\ 0 & 0.5 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} + \\begin{pmatrix} 0.5 & 0 & 0 \\\\ 0 & 0.5 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} + \\begin{pmatrix} 1.5 & -0.5 & 0 \\\\ -0.5 & 1.5 & -0.5 \\\\ 0 & -0.5 & 1.5 \\end{pmatrix}\n$$\n按元素相加矩阵：\n$$\nA_c = \\begin{pmatrix} 2+0.5+0.5+1.5 & -1+0+0-0.5 & 0+0+0+0 \\\\ -1+0+0-0.5 & 2+0.5+0.5+1.5 & -1+0+0-0.5 \\\\ 0+0+0+0 & -1+0+0-0.5 & 2+0.5+0.5+1.5 \\end{pmatrix}\n$$\n$$\nA_c = \\begin{pmatrix} 4.5 & -1.5 & 0 \\\\ -1.5 & 4.5 & -1.5 \\\\ 0 & -1.5 & 4.5 \\end{pmatrix}\n$$\n\n接下来，我们定性地解释非对角场耦合是如何在粗糙层上表示的。\n聚合策略将第一个场的第 $i$ 个自由度 (DOF) $u_i$ 与第二个场的第 $i$ 个自由度 $v_i$ 分组到一个单一的粗糙层聚合 $\\mathcal{A}_{i} = \\{u_i, v_i\\}$ 中。这被称为逐点聚合或场混合聚合。延拓算子 $P$ 将第 $i$ 个粗糙层自由度映射到第 $i$ 个聚合中两个细网格自由度（$u_i$ 和 $v_i$）上的常数值 $1$。\n\n伽辽金算子 $A_c = P^T A P$ 通过对细网格层连接求和来创建粗糙层连接。项 $(A_c)_{ij}$ 表示聚合 $\\mathcal{A}_i$ 中所有细网格自由度与聚合 $\\mathcal{A}_j$ 中所有细网格自由度之间连接的总强度。\n计算 $A_c = A_{uu} + A_{uv} + A_{vu} + A_{vv}$ 从数学上展示了这一过程。粗化算子是所有细网格层相互作用块的总和。场内块 $A_{uu}$ 和 $A_{vv}$ 分别描述了 $u$ 场和 $v$ 场内部的相互作用。场间（非对角耦合）块 $A_{uv}$ 和 $A_{vu}$ 描述了 $u$ 场和 $v$ 场之间的相互作用。\n通过对所有这些块求和，场间耦合并没有被丢弃；相反，其强度被直接吸收到粗糙层算子 $A_c$ 的元素中。具体来说，来自块 $A_{uv}$ 和 $A_{vu}$ 的耦合项 $\\gamma$贡献给了 $A_c$ 的对角线元素。这确保了在同一空间点上场之间的强耦合在粗网格上得到恰当的表示，这对于多重网格求解器的效率至关重要。原始的 $2 \\times 2$ 分块结构在粗糙层上被压缩成一个标量结构，其中每个粗变量都隐含地携带了来自两个原始场的信息。\n\n最后，我们计算 $A_c$ 的行列式。为简化计算并保持精确性，我们可以从 $A_c$ 中提取一个公因子：\n$$\nA_c = \\begin{pmatrix} \\frac{9}{2} & -\\frac{3}{2} & 0 \\\\ -\\frac{3}{2} & \\frac{9}{2} & -\\frac{3}{2} \\\\ 0 & -\\frac{3}{2} & \\frac{9}{2} \\end{pmatrix} = \\frac{3}{2} \\begin{pmatrix} 3 & -1 & 0 \\\\ -1 & 3 & -1 \\\\ 0 & -1 & 3 \\end{pmatrix}\n$$\n对于一个 $n \\times n$ 矩阵 $M$ 和标量 $k$，使用属性 $\\det(kM) = k^n \\det(M)$：\n$$\n\\det(A_c) = \\left(\\frac{3}{2}\\right)^3 \\det \\begin{pmatrix} 3 & -1 & 0 \\\\ -1 & 3 & -1 \\\\ 0 & -1 & 3 \\end{pmatrix}\n$$\n该 $3 \\times 3$ 矩阵的行列式可使用沿第一行的余子式展开计算：\n$$\n\\det \\begin{pmatrix} 3 & -1 & 0 \\\\ -1 & 3 & -1 \\\\ 0 & -1 & 3 \\end{pmatrix} = 3 \\begin{vmatrix} 3 & -1 \\\\ -1 & 3 \\end{vmatrix} - (-1) \\begin{vmatrix} -1 & -1 \\\\ 0 & 3 \\end{vmatrix} + 0\n$$\n$$\n= 3(3 \\cdot 3 - (-1) \\cdot (-1)) + 1((-1) \\cdot 3 - (-1) \\cdot 0)\n$$\n$$\n= 3(9 - 1) + 1(-3 - 0) = 3(8) - 3 = 24 - 3 = 21\n$$\n现在，我们可以求出 $A_c$ 的行列式：\n$$\n\\det(A_c) = \\left(\\frac{3}{2}\\right)^3 \\times 21 = \\frac{27}{8} \\times 21 = \\frac{567}{8}\n$$\n行列式的精确值为 $\\frac{567}{8}$，其小数形式为 $70.875$。",
            "answer": "$$\n\\boxed{\\frac{567}{8}}\n$$"
        },
        {
            "introduction": "多重网格方法的效率在很大程度上取决于平滑算子（smoother）有效衰减高频误差的能力。局部傅里叶分析（Local Fourier Analysis, LFA）是定量评估平滑器性能的基石。本练习将指导您从第一性原理出发，对一个耦合反应扩散系统的块雅可比平滑器（block Jacobi smoother）进行LFA分析，并推导出其平滑因子。通过这个过程，您将掌握连接算子理论与求解器性能评估的关键分析技术。",
            "id": "3515964",
            "problem": "考虑一个简化的一维双场线性反应扩散耦合问题，该问题设定在一个间距为 $h$ 的无限、均匀间隔的网格上，其中两个场 $u$ 和 $v$ 通过对称的线性反应项耦合。在此网格上，负拉普拉斯算子 $- \\partial_{xx}$ 的标准二阶中心有限差分近似定义为 $(L u)_{j} = \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}$，因此离散算子 $-L$ 是对称正定的。得到的耦合代数系统可以写成如下块形式：\n$$\nA \\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix}\nD_{u}(-L) + c_{u} I + \\beta I  &-\\beta I \\\\\n-\\beta I  & D_{v}(-L) + c_{v} I + \\beta I\n\\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix} f \\\\ g \\end{pmatrix},\n$$\n其中 $D_{u} > 0$ 和 $D_{v} > 0$ 是扩散系数，$c_{u} \\ge 0$ 和 $c_{v} \\ge 0$ 是线性反应系数，$\\beta > 0$ 是对称耦合强度。考虑由 $M = \\operatorname{diag}\\!\\big(A_{11}, A_{22}\\big)$ 定义的块 Jacobi 光滑子（松弛参数等于 $1$）以及迭代 $x^{(m+1)} = x^{(m)} + M^{-1} \\big(b - A x^{(m)}\\big)$，其误差传播算子为 $S = I - M^{-1} A$。使用局部傅里叶分析 (LFA)，此处定义为对 $S$ 在形如 $e^{\\mathrm{i} \\theta j}$（其中 $\\theta \\in (-\\pi, \\pi]$）的单个傅里叶误差模式上的行为进行分析，可以表征 $S$ 在高频子空间上的光滑能力。\n\n从以上定义和无限网格上傅里叶模式分析的基本原理出发，推导傅里叶符号 $\\widehat{S}(\\theta)$，确定其对于给定 $\\theta$ 的特征值，并将在高频集 $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$ 上的光滑因子定义为以下量：\n$$\n\\mu = \\sup_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\rho\\!\\big(\\widehat{S}(\\theta)\\big),\n$$\n其中 $\\rho(\\cdot)$ 表示谱半径。对于参数值 $D_{u} = 0.9$、$D_{v} = 0.3$、$c_{u} = 0.15$、$c_{v} = 0.05$、$\\beta = 0.4$ 和 $h = 1$，计算光滑因子 $\\mu$ 的数值。将答案四舍五入到四位有效数字，并提供一个不带单位的实数。",
            "solution": "首先根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 耦合代数系统：\n$$\nA \\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix}\nD_{u}(-L) + c_{u} I + \\beta I  &-\\beta I \\\\\n-\\beta I  & D_{v}(-L) + c_{v} I + \\beta I\n\\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\end{pmatrix}\n=\n\\begin{pmatrix} f \\\\ g \\end{pmatrix}\n$$\n- 在间距为 $h$ 的无限网格上的离散负拉普拉斯算子：$(L u)_{j} = \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}$。\n- 系数：$D_{u} > 0$、$D_{v} > 0$、$c_{u} \\ge 0$、$c_{v} \\ge 0$、$\\beta > 0$。\n- 块 Jacobi 光滑子（松弛参数为1）：$M = \\operatorname{diag}\\!\\big(A_{11}, A_{22}\\big)$，其中 $A_{11} = D_{u}(-L) + c_{u} I + \\beta I$ 且 $A_{22} = D_{v}(-L) + c_{v} I + \\beta I$。\n- 误差传播算子：$S = I - M^{-1} A$。\n- 分析方法：对模式 $e^{\\mathrm{i} \\theta j}$（其中 $\\theta \\in (-\\pi, \\pi]$）进行局部傅里叶分析。\n- 高频集：$\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$。\n- 光滑因子定义：$\\mu = \\sup_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\rho\\!\\big(\\widehat{S}(\\theta)\\big)$，其中 $\\rho(\\cdot)$ 为谱半径。\n- 具体参数值：$D_{u} = 0.9$、$D_{v} = 0.3$、$c_{u} = 0.15$、$c_{v} = 0.05$、$\\beta = 0.4$、$h = 1$。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据：** 是。该问题描述了一个标准的反应扩散系统，该系统通过有限差分法进行离散化，并使用局部傅里葉分析 (LFA) 对块 Jacobi 光滑子进行分析。这些都是偏微分方程数值分析和多重网格方法中的典型主题。\n- **适定性：** 是。该问题提供了所有必要的定义、参数和一个明确的目标：计算一个具体的数值。其结构导向一个唯一且有意义的解。\n- **客观性：** 是。该问题以精确的数学语言陈述，没有任何主观性或模糊性。\n\n该问题不违反任何无效标准。它在科学上是合理的、可形式化的、完整的、可行的和适定的。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。现在开始求解过程。\n\n目标是计算给定块 Jacobi 光滑子的光滑因子 $\\mu$。该过程涉及局部傅里叶分析 (LFA)，以确定光滑子的误差传播算子的谱半径，并将其作为傅里叶频率 $\\theta$ 的函数。\n\n首先，我们确定离散负拉普拉斯算子 $-L$ 的傅里叶符号。$L$ 作用于傅里叶模式 $\\phi_j(\\theta) = e^{\\mathrm{i}\\theta j}$ 的结果是\n$$\n(L \\phi(\\theta))_j = \\frac{e^{\\mathrm{i}\\theta(j+1)} - 2e^{\\mathrm{i}\\theta j} + e^{\\mathrm{i}\\theta(j-1)}}{h^2} = \\frac{e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta}}{h^2} e^{\\mathrm{i}\\theta j} = \\frac{2\\cos(\\theta) - 2}{h^2} e^{\\mathrm{i}\\theta j}.\n$$\n因此，$L$ 的傅里叶符号为 $\\widehat{L}(\\theta) = \\frac{2(\\cos(\\theta) - 1)}{h^2} = -\\frac{4\\sin^2(\\theta/2)}{h^2}$。因此，负拉普拉斯算子（我们记为 $\\mathcal{L} = -L$）的符号是\n$$\n\\widehat{\\mathcal{L}}(\\theta) = \\frac{4\\sin^2(\\theta/2)}{h^2}.\n$$\n系统算子 $A$ 是一个 $2 \\times 2$ 的块矩阵。其傅里叶符号 $\\widehat{A}(\\theta)$ 是一个 $2 \\times 2$ 的矩阵，通过将 $A$ 中的每个算子替换为其对应的符号而得到。\n$$\n\\widehat{A}(\\theta) = \\begin{pmatrix} D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta  &-\\beta \\\\ -\\beta  & D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta \\end{pmatrix}.\n$$\n块 Jacobi 光滑子定义为 $M = \\operatorname{diag}(A_{11}, A_{22})$。其傅里叶符号是 $\\widehat{A}(\\theta)$ 的对角部分：\n$$\n\\widehat{M}(\\theta) = \\begin{pmatrix} D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta  &0 \\\\ 0  & D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta \\end{pmatrix}.\n$$\n误差传播算子为 $S = I - M^{-1}A$。其符号为 $\\widehat{S}(\\theta) = I_2 - \\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta)$，其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵。\n首先，我们计算 $\\widehat{M}(\\theta)^{-1}$：\n$$\n\\widehat{M}(\\theta)^{-1} = \\begin{pmatrix} \\frac{1}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta}  &0 \\\\ 0  & \\frac{1}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta} \\end{pmatrix}.\n$$\n那么，乘积 $\\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta)$ 是\n$$\n\\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta) = \\begin{pmatrix} 1  &\\frac{-\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta} \\\\ \\frac{-\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}  &1 \\end{pmatrix}.\n$$\n最后，我们求出误差传播算子的符号：\n$$\n\\widehat{S}(\\theta) = I_2 - \\widehat{M}(\\theta)^{-1}\\widehat{A}(\\theta) = \\begin{pmatrix} 1  &0 \\\\ 0  &1 \\end{pmatrix} - \\begin{pmatrix} 1  &\\frac{-\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta} \\\\ \\frac{-\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}  &1 \\end{pmatrix} = \\begin{pmatrix} 0  &\\frac{\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta} \\\\ \\frac{\\beta}{D_{v}\\widehat{\\mathcal.L}}(\\theta) + c_{v} + \\beta}  &0 \\end{pmatrix}.\n$$\n为了求谱半径 $\\rho(\\widehat{S}(\\theta))$，我们计算 $\\widehat{S}(\\theta)$ 的特征值。对于形如 $\\begin{pmatrix} 0 & a \\\\ b & 0 \\end{pmatrix}$ 的矩阵，其特征值 $\\lambda$ 由 $\\lambda^2 - ab = 0$ 给出，因此 $\\lambda = \\pm\\sqrt{ab}$。在我们的例子中，特征值是\n$$\n\\lambda(\\theta) = \\pm \\sqrt{\\left(\\frac{\\beta}{D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta}\\right) \\left(\\frac{\\beta}{D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta}\\right)} = \\pm \\frac{\\beta}{\\sqrt{(D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta)(D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta)}}.\n$$\n谱半径是特征值绝对值的最大值。由于所有参数（$D_u, D_v, c_u, c_v, \\beta$）都是非负的（且大多数是严格正的），并且 $\\widehat{\\mathcal{L}}(\\theta) \\ge 0$，因此平方根下的表达式为正。\n$$\n\\rho(\\widehat{S}(\\theta)) = \\frac{\\beta}{\\sqrt{(D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta)(D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta)}}.\n$$\n光滑因子定义为 $\\mu = \\sup_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\rho(\\widehat{S}(\\theta))$，其中 $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$。我们需要在这个区间上找到 $\\rho(\\widehat{S}(\\theta))$ 的最大值。\n让我们分析 $\\rho(\\widehat{S}(\\theta))$ 作为 $\\theta$ 的函数的行为。分子 $\\beta$ 是一个常数。分母通过 $\\widehat{\\mathcal{L}}(\\theta) = \\frac{4\\sin^2(\\theta/2)}{h^2}$ 依赖于 $\\theta$。\n在区间 $\\theta \\in [\\pi/2, \\pi]$上，自变量 $\\theta/2$ 位于区间 $[\\pi/4, \\pi/2]$ 内。在此区间内，$\\sin(\\theta/2)$ 是一个关于 $\\theta$ 的正的严格递增函数。因此，$\\sin^2(\\theta/2)$ 也是严格递增的。由于 $h > 0$，$\\widehat{\\mathcal{L}}(\\theta)$ 是在 $[\\pi/2, \\pi]$ 上关于 $\\theta$ 的严格递增函数。\n分母中乘积的两个项 $(D_{u}\\widehat{\\mathcal{L}}(\\theta) + c_{u} + \\beta)$ 和 $(D_{v}\\widehat{\\mathcal{L}}(\\theta) + c_{v} + \\beta)$，因为 $D_u > 0$ 和 $D_v > 0$，所以它们都是关于 $\\theta$ 的严格递增函数。两个正的严格递增函数的乘积是严格递增的。一个严格递增的正函数的平方根也是严格递增的。\n因此，$\\rho(\\widehat{S}(\\theta))$ 的分母是在 $[\\pi/2, \\pi]$ 上关于 $\\theta$ 的严格递增函数。因此，$\\rho(\\widehat{S}(\\theta))$ 作为这样一个函数（乘以一个正常数）的倒数，是在 $[\\pi/2, \\pi]$ 上的严格递减函数。\n在闭区间上，一个严格递减函数的上确界在区间的左端点处取得。因此，\n$$\n\\mu = \\sup_{\\theta \\in [\\pi/2, \\pi]} \\rho(\\widehat{S}(\\theta)) = \\rho(\\widehat{S}(\\pi/2)).\n$$\n我们现在代入给定的数值：$D_{u} = 0.9$、$D_{v} = 0.3$、$c_{u} = 0.15$、$c_{v} = 0.05$、$\\beta = 0.4$ 和 $h = 1$。\n首先，计算在 $\\theta = \\pi/2$ 处的 $\\widehat{\\mathcal{L}}(\\theta)$：\n$$\n\\widehat{\\mathcal{L}}(\\pi/2) = \\frac{4\\sin^2((\\pi/2)/2)}{1^2} = 4\\sin^2(\\pi/4) = 4\\left(\\frac{\\sqrt{2}}{2}\\right)^2 = 4\\left(\\frac{2}{4}\\right) = 2.\n$$\n接下来，计算 $\\rho(\\widehat{S}(\\pi/2))$ 分母中的各项：\n$$\nD_{u}\\widehat{\\mathcal{L}}(\\pi/2) + c_{u} + \\beta = (0.9)(2) + 0.15 + 0.4 = 1.8 + 0.15 + 0.4 = 2.35.\n$$\n$$\nD_{v}\\widehat{\\mathcal{L}}(\\pi/2) + c_{v} + \\beta = (0.3)(2) + 0.05 + 0.4 = 0.6 + 0.05 + 0.4 = 1.05.\n$$\n现在，我们计算 $\\mu$：\n$$\n\\mu = \\rho(\\widehat{S}(\\pi/2)) = \\frac{0.4}{\\sqrt{(2.35)(1.05)}} = \\frac{0.4}{\\sqrt{2.4675}}.\n$$\n数值上，$\\sqrt{2.4675} \\approx 1.57082779$。\n$$\n\\mu \\approx \\frac{0.4}{1.57082779} \\approx 0.25464903.\n$$\n将结果四舍五入到四位有效数字，得到 $0.2546$。",
            "answer": "$$\n\\boxed{0.2546}\n$$"
        },
        {
            "introduction": "将理论分析转化为可执行的计算工具，是计算科学研究的核心环节。这个编程练习将前一个问题的局部傅里叶分析（LFA）理论付诸实践。您将为一个更复杂的鞍点问题（saddle-point problem）构建Braess–Sarazin块平滑器，并通过编写代码来计算其在不同参数下的平滑因子。通过这个练习，您不仅能加深对理论的理解，还将学会如何通过数值实验来探索和优化多重网格求解器的关键组件。",
            "id": "3515985",
            "problem": "考虑一个在多物理场耦合模拟中出现的鞍点算子，对其进行具有均匀网格间距的一维周期性离散化，并进行离散傅里叶分析。该耦合系统具有块结构 $$A(k)=\\begin{bmatrix}F(k) & B(k)^*\\\\ B(k) & -C(k)\\end{bmatrix},$$ 其中 $k$ 是傅里叶波数（以弧度为单位），$F(k)$ 是一个对称正定椭圆算子（例如，按粘度缩放的离散拉普拉斯算子）的符号，$B(k)$ 是一个离散一阶导数（耦合算子）的符号，而 $C(k)$ 是压力块中的一个稳定化项。对于周期性网格和标准中心差分，采用以下傅里叶符号作为与上下文相符的基本形式： $$F(k)=\\nu\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right),\\qquad B(k)=\\mathrm{i}\\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right),$$ 其中粘度 $\\nu$ 为进行无量纲化设为 $\\nu=1$。考虑 $C(k)$ 的三种稳定化模型：无稳定化 $C(k)=0$、类拉普拉斯稳定化 $C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$ 和类质量稳定化 $C(k)=\\gamma$，其中 $\\beta>0$ 和 $\\gamma>0$ 是标量参数。\n\n为此符号构建 Braess–Sarazin 块平滑子，由块矩阵定义：$$M(k)=\\begin{bmatrix}F(k) & B(k)^*\\\\ B(k) & -\\alpha\\end{bmatrix},$$ 其中 $\\alpha>0$ 是一个近似舒尔补缩放的标量参数，$\\omega>0$ 是松弛参数。在傅里叶空间中，误差 $\\mathbf{e}$ 的一个平滑步骤为 $$\\mathbf{e}^{\\,\\text{new}}(k)=\\left(I-\\omega\\,M(k)^{-1}A(k)\\right)\\mathbf{e}^{\\,\\text{old}}(k),$$ 因此误差传播矩阵为 $$E(k)=I-\\omega\\,M(k)^{-1}A(k).$$ 对于给定的 $(\\alpha,\\omega)$ 和 $C(k)$ 选择，平滑因子是 $E(k)$ 的谱半径在均匀采样于指定数量点上的高频集 $$\\mathcal{H}=\\left\\{k\\in\\mathbb{R}:\\frac{\\pi}{2}\\le k\\le \\pi\\right\\}$$ 上的上确界。角度必须以弧度为单位。\n\n你的任务是编写一个完整的、可运行的程序，该程序能够：\n- 实现指定的傅里叶符号 $F(k)$ 和 $B(k)$。\n- 实现 $C(k)$ 的三种稳定化模型：$C(k)=0$、$C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$ 和 $C(k)=\\gamma$。\n- 构建 Braess–Sarazin 块平滑子 $M(k)$ 并计算误差传播矩阵 $E(k)$。\n- 对每个测试用例，计算平滑因子 $\\mu=\\max_{k\\in\\mathcal{H}}\\rho\\!\\left(E(k)\\right)$，其中 $\\rho(\\cdot)$ 表示谱半径（特征值的最大绝对值）。在 $\\mathcal{H}$ 中使用 $N_{k}$ 个点的均匀采样。\n- 生成单行输出，其中包含所有测试用例的平滑因子，格式为方括号括起来的逗号分隔列表，每个值四舍五入到 $6$ 位小数。\n\n设计一个覆盖多个方面的测试套件：\n- 无稳定化 $C(k)=0$ 的一般情况。\n- 具有中等 $\\beta$ 值的类拉普拉斯稳定化。\n- 具有小 $\\gamma$ 值和大 $\\gamma$ 值的类质量稳定化。\n- 具有小 $\\alpha$ 值和大 $\\alpha$ 值以及变化的 $\\omega$ 以观察敏感性的边缘情况。\n- 在 $\\mathcal{H}$ 中使用 $N_{k}=128$ 个均匀样本。\n\n使用以下具体的测试用例：\n- 测试用例 $1$：$\\alpha=1.0$，$\\omega=1.0$，$C(k)=0$。\n- 测试用例 $2$：$\\alpha=1.0$，$\\omega=1.0$，$C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$，其中 $\\beta=0.5$。\n- 测试用例 $3$：$\\alpha=2.0$，$\\omega=1.2$，$C(k)=\\gamma$，其中 $\\gamma=0.1$。\n- 测试用例 $4$：$\\alpha=4.0$，$\\omega=0.8$，$C(k)=\\gamma$，其中 $\\gamma=10.0$。\n- 测试用例 $5$：$\\alpha=0.25$，$\\omega=1.5$，$C(k)=\\beta\\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$，其中 $\\beta=2.0$。\n- 测试用例 $6$：$\\alpha=8.0$，$\\omega=0.6$，$C(k)=0$。\n\n你的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3},r_{4},r_{5},r_{6}]$），其中每个 $r_{j}$ 是测试用例 $j$ 的平滑因子，四舍五入到 $6$ 位小数。所有角度必须以弧度为单位，且不涉及任何物理单位。",
            "solution": "目标是通过使用局部傅里叶分析计算其平滑因子，来分析 Braess–Sarazin 块平滑子在一维耦合鞍点系统中的性能。平滑因子量化了平滑子衰减高频误差分量的能力，这对多重网格求解器的效率至关重要。\n\n分析在傅里叶空间中进行，在该空间中，微分算子变为乘以其对应的符号。耦合系统由 $2 \\times 2$ 块矩阵符号表示：\n$$A(k)=\\begin{bmatrix}F(k) & B(k)^*\\\\ B(k) & -C(k)\\end{bmatrix}$$\n其中 $k$ 是以弧度为单位的傅里叶波数。\n\n算子的符号如下：\n1.  $F(k) = \\nu \\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$：这是离散拉普拉斯算子的傅里叶符号，代表一个扩散过程。当无量纲粘度 $\\nu=1$ 时，我们有 $F(k) = 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$。对于 $k \\in (0, 2\\pi)$，该项是实数且为正。\n2.  $B(k) = \\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)$：这是一个离散一阶导数耦合算子的符号，是交错网格离散化的典型特征。该项是纯虚数。其共轭转置 $B(k)^*$ 是其复共轭，因为该符号是标量：$B(k)^* = \\overline{\\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)} = -\\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)$。\n3.  $C(k)$：此符号代表压力稳定化项。问题指定了三种模型：\n    - 无稳定化：$C(k) = 0$。\n    - 类拉普拉斯稳定化：$C(k) = \\beta \\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$，对于某个标量 $\\beta > 0$。\n    - 类质量稳定化：$C(k) = \\gamma$，对于某个标量 $\\gamma > 0$。\n所有指定的 $C(k)$ 模型都是实值的。\n\nBraess–Sarazin 平滑子由预条件子矩阵符号定义：\n$$M(k)=\\begin{bmatrix}F(k) & B(k)^*\\\\ B(k) & -\\alpha\\end{bmatrix}$$\n其中 $\\alpha>0$ 是一个标量参数。为使平滑子有良好定义，$M(k)$ 必须是可逆的。$M(k)$ 的行列式为：\n$$\\det(M(k)) = F(k)(-\\alpha) - B(k)^*B(k) = -\\alpha F(k) - |B(k)|^2$$\n代入 $F(k)$ 和 $B(k)$ 的表达式：\n$$|B(k)|^2 = \\left|\\mathrm{i} \\cdot 2\\sin\\!\\left(\\frac{k}{2}\\right)\\right|^2 = 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$$\n$$\\det(M(k)) = -\\alpha \\left(4\\sin^2\\!\\left(\\frac{k}{2}\\right)\\right) - 4\\sin^2\\!\\left(\\frac{k}{2}\\right) = -(\\alpha+1) \\cdot 4\\sin^2\\!\\left(\\frac{k}{2}\\right)$$\n高频集为 $\\mathcal{H} = \\{k \\in \\mathbb{R} : \\frac{\\pi}{2} \\le k \\le \\pi\\}$。对于任何 $k \\in \\mathcal{H}$，$k/2 \\in [\\pi/4, \\pi/2]$，因此 $\\sin(k/2) \\in [1/\\sqrt{2}, 1]$ 且永不为零。由于 $\\alpha > 0$，行列式 $\\det(M(k))$ 在 $\\mathcal{H}$ 上严格为负，从而确保 $M(k)$ 是可逆的。其逆矩阵由下式给出：\n$$M(k)^{-1} = \\frac{1}{\\det(M(k))} \\begin{bmatrix} -\\alpha & -B(k)^* \\\\ -B(k) & F(k) \\end{bmatrix}$$\n\n使用松弛参数 $\\omega>0$ 的单个平滑步骤根据迭代矩阵 $E(k)$ 更新误差 $\\mathbf{e}(k)$：\n$$E(k) = I - \\omega M(k)^{-1}A(k)$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。平滑子的有效性由平滑因子 $\\mu$ 衡量，即谱半径 $\\rho(E(k))$ 在高频集 $\\mathcal{H}$ 上的上确界：\n$$\\mu = \\max_{k \\in \\mathcal{H}} \\rho(E(k)) = \\max_{k \\in \\mathcal{H}} \\max_{j} |\\lambda_j(E(k))|$$\n其中 $\\lambda_j(E(k))$ 是 $E(k)$ 的特征值。\n\n为每个指定的测试用例找到 $\\mu$ 的计算步骤如下：\n1.  将高频域 $\\mathcal{H} = [\\pi/2, \\pi]$ 离散化为 $N_k=128$ 个均匀间隔的点。\n2.  对于每个由一组参数 $(\\alpha, \\omega, C(k))$ 定义的测试用例，将用于存储最大谱半径的变量 `max_rho` 初始化为 $0$。\n3.  遍历离散化集合中的每个离散波数 $k$：\n    a. 根据当前测试用例的参数评估符号 $F(k)$、$B(k)$ 和 $C(k)$。\n    b. 构建 $2 \\times 2$ 复值矩阵 $A(k)$ 和 $M(k)$。\n    c. 解析地或数值地计算逆矩阵 $M(k)^{-1}$。\n    d. 构造迭代矩阵 $E(k) = I - \\omega M(k)^{-1}A(k)$。\n    e. 计算 $E(k)$ 的特征值。对于一个 $2 \\times 2$ 矩阵，这很简单。\n    f. 通过找到计算出的特征值中的最大绝对值来计算谱半径 $\\rho(E(k))$。\n    g. 更新 `max_rho = max(max_rho,` $\\rho(E(k)))$。\n4.  在遍历所有 $k$ 值之后，`max_rho` 保存了给定测试用例的平滑因子 $\\mu$。\n5.  最终输出是所有测试用例的这些平滑因子的列表，按指定格式格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Braess-Sarazin smoothing factor for several test cases\n    of a 1D coupled saddle-point problem using local Fourier analysis.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Structure: (alpha, omega, C_model, C_param)\n    # C_model can be 'none', 'laplacian', or 'mass'. C_param is beta or gamma.\n    test_cases = [\n        (1.0, 1.0, 'none', None),\n        (1.0, 1.0, 'laplacian', 0.5),\n        (2.0, 1.2, 'mass', 0.1),\n        (4.0, 0.8, 'mass', 10.0),\n        (0.25, 1.5, 'laplacian', 2.0),\n        (8.0, 0.6, 'none', None),\n    ]\n\n    N_k = 128\n    k_values = np.linspace(np.pi / 2, np.pi, N_k)\n    s_k_half_values = np.sin(k_values / 2.0)\n\n    results = []\n\n    for case in test_cases:\n        alpha, omega, c_model, c_param = case\n        max_rho = 0.0\n\n        for s_k_half in s_k_half_values:\n            # Evaluate symbols at the current wavenumber k\n            # F(k) = 4 * sin^2(k/2)\n            F_k = 4.0 * s_k_half**2\n            \n            # B(k) = i * 2 * sin(k/2)\n            B_k = 2.0j * s_k_half\n            B_k_conj = np.conj(B_k)\n\n            # C(k) depends on the stabilization model\n            if c_model == 'none':\n                C_k = 0.0\n            elif c_model == 'laplacian':\n                # C(k) = beta * 4 * sin^2(k/2)\n                beta = c_param\n                C_k = beta * F_k\n            elif c_model == 'mass':\n                # C(k) = gamma\n                gamma = c_param\n                C_k = gamma\n            else:\n                raise ValueError(\"Unknown C(k) model\")\n\n            # Construct the A(k) and M(k) matrices\n            A_k = np.array([[F_k, B_k_conj], \n                            [B_k, -C_k]], dtype=np.complex128)\n            \n            M_k = np.array([[F_k, B_k_conj], \n                            [B_k, -alpha]], dtype=np.complex128)\n\n            # Invert M(k) analytically\n            # det(M(k)) = -alpha * F_k - |B_k|^2\n            det_M_k = -alpha * F_k - (B_k_conj * B_k).real\n            \n            # Check for singularity, though analysis showed it's non-singular on H\n            if np.abs(det_M_k)  1e-15:\n                # This should not happen for k in the high-frequency set\n                # If it does, the spectral radius might be large; continue to next k\n                continue\n            \n            inv_M_k = (1.0 / det_M_k) * np.array([[-alpha, -B_k_conj], onylu\n                                                  [-B_k, F_k]], dtype=np.complex128)\n\n            # Construct the error propagation matrix E(k) = I - omega * M(k)^-1 * A(k)\n            I = np.identity(2, dtype=np.complex128)\n            E_k = I - omega * (inv_M_k @ A_k)\n\n            # Compute spectral radius of E(k)\n            eigenvalues = np.linalg.eigvals(E_k)\n            rho_k = np.max(np.abs(eigenvalues))\n            \n            # Update the maximum spectral radius (smoothing factor)\n            if rho_k > max_rho:\n                max_rho = rho_k\n        \n        results.append(max_rho)\n\n    # Format the results for the final print statement\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}