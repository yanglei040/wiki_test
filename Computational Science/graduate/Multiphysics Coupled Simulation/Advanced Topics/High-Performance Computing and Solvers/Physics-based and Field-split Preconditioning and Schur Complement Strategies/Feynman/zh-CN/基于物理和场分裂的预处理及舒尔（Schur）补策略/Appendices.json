{
    "hands_on_practices": [
        {
            "introduction": "本练习为理解场分离方法提供了一个具体的数值起点。通过为一个小的 $2 \\times 2$ 分块系统手动计算舒尔补，您将巩固对分块消元过程的掌握，该过程是许多高级预处理和求解策略的基础。",
            "id": "3522005",
            "problem": "考虑一个双场线性系统，该系统源于一个耦合多物理场问题的基于物理场的场分离方法，其中主场 $x_{1} \\in \\mathbb{R}^{2}$（例如，一个离散化的速度或温度向量）与次标量场 $x_{2} \\in \\mathbb{R}$（例如，一个离散化的压力或拉格朗日乘子）相耦合。该分块结构的离散系统为\n$$\n\\begin{pmatrix}\nA_{11} & A_{12} \\\\\nA_{21} & A_{22}\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1} \\\\\nx_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2}\n\\end{pmatrix},\n$$\n其中 $A_{11} \\in \\mathbb{R}^{2 \\times 2}$，$A_{12} \\in \\mathbb{R}^{2 \\times 1}$，$A_{21} \\in \\mathbb{R}^{1 \\times 2}$ 且 $A_{22} \\in \\mathbb{R}^{1 \\times 1}$。在一种利用场分离的基于物理场的预条件策略中，通过分块消元法消除主场来获得次场的降阶方程，从而产生一个表征耦合的标量降阶算子。对于给定的数值矩阵\n$$\nA_{11}=\\begin{pmatrix}2 & 0 \\\\ 0 & 3\\end{pmatrix},\\quad\nA_{12}=\\begin{pmatrix}1\\\\-1\\end{pmatrix},\\quad\nA_{21}=\\begin{pmatrix}4 & 2\\end{pmatrix},\\quad\nA_{22}=(5),\n$$\n和右端向量\n$$\nb_{1}=\\begin{pmatrix}7\\\\-1\\end{pmatrix},\\quad b_{2}=(6),\n$$\n执行消元以形成关于 $x_2$ 的标量降阶方程，计算相应的降阶算子（舒尔补），并求解 $x_2$。将最终答案表示为 $x_2$ 的精确值，不进行四舍五入，不带单位。",
            "solution": "该问题给出了一个分块形式的线性系统，这是耦合多物理场问题数值模拟中的一种常见结构。该系统由下式给出：\n$$\n\\begin{pmatrix}\nA_{11} & A_{12} \\\\\nA_{21} & A_{22}\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1} \\\\\nx_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2}\n\\end{pmatrix}\n$$\n这个分块矩阵方程对应于两个耦合方程：\n$$\nA_{11} x_{1} + A_{12} x_{2} = b_{1} \\quad (1)\n$$\n$$\nA_{21} x_{1} + A_{22} x_{2} = b_{2} \\quad (2)\n$$\n问题要求使用分块消元策略求解次场 $x_2$，这将导出舒尔补系统。这是场分离预条件中的一个标准步骤。第一步是从方程 $(1)$ 中形式上解出主场 $x_1$。这当且仅当矩阵块 $A_{11}$ 可逆时才可能。\n$$\nA_{11} x_{1} = b_{1} - A_{12} x_{2}\n$$\n$$\nx_{1} = A_{11}^{-1} (b_{1} - A_{12} x_{2}) \\quad (3)\n$$\n接下来，我们将 $x_1$ 的这个表达式代入方程 $(2)$：\n$$\nA_{21} \\left( A_{11}^{-1} (b_{1} - A_{12} x_{2}) \\right) + A_{22} x_{2} = b_{2}\n$$\n将项 $A_{21}A_{11}^{-1}$ 分配进去，得到：\n$$\nA_{21} A_{11}^{-1} b_{1} - A_{21} A_{11}^{-1} A_{12} x_{2} + A_{22} x_{2} = b_{2}\n$$\n然后我们重排此方程，将包含未知数 $x_2$ 的项分离到一边：\n$$\n(A_{22} - A_{21} A_{11}^{-1} A_{12}) x_{2} = b_{2} - A_{21} A_{11}^{-1} b_{1}\n$$\n这就是次场 $x_2$ 的降阶方程。左侧的算子是整个系统矩阵中块 $A_{11}$ 的舒尔补，记作 $S$：\n$$\nS = A_{22} - A_{21} A_{11}^{-1} A_{12}\n$$\n降阶方程的右侧是修正后的右端向量，$\\hat{b}_{2}$：\n$$\n\\hat{b}_{2} = b_{2} - A_{21} A_{11}^{-1} b_{1}\n$$\n因此，需要求解的降阶系统是 $S x_{2} = \\hat{b}_{2}$。\n\n现在，我们将此形式应用于给定的数值矩阵：\n$$\nA_{11}=\\begin{pmatrix}2 & 0 \\\\ 0 & 3\\end{pmatrix},\\quad\nA_{12}=\\begin{pmatrix}1\\\\-1\\end{pmatrix},\\quad\nA_{21}=\\begin{pmatrix}4 & 2\\end{pmatrix},\\quad\nA_{22}=(5)\n$$\n$$\nb_{1}=\\begin{pmatrix}7\\\\-1\\end{pmatrix},\\quad b_{2}=(6)\n$$\n首先，我们检查 $A_{11}$ 是否可逆。其行列式为 $\\det(A_{11}) = (2)(3) - (0)(0) = 6 \\neq 0$，所以逆矩阵存在。由于 $A_{11}$ 是一个对角矩阵，其逆矩阵可以通过取其对角元素的倒数轻易求得：\n$$\nA_{11}^{-1} = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{3} \\end{pmatrix}\n$$\n现在，我们计算舒尔补 $S$ 的分量。我们计算乘积 $A_{21} A_{11}^{-1}$：\n$$\nA_{21} A_{11}^{-1} = \\begin{pmatrix} 4 & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 4 \\cdot \\frac{1}{2} + 2 \\cdot 0 & 4 \\cdot 0 + 2 \\cdot \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 2 & \\frac{2}{3} \\end{pmatrix}\n$$\n接下来，我们计算项 $A_{21} A_{11}^{-1} A_{12}$：\n$$\nA_{21} A_{11}^{-1} A_{12} = \\begin{pmatrix} 2 & \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\left( 2 \\cdot 1 + \\left(\\frac{2}{3}\\right) \\cdot (-1) \\right) = 2 - \\frac{2}{3} = \\frac{6}{3} - \\frac{2}{3} = \\frac{4}{3}\n$$\n现在我们可以计算舒尔补算子 $S$：\n$$\nS = A_{22} - A_{21} A_{11}^{-1} A_{12} = (5) - \\left(\\frac{4}{3}\\right) = \\frac{15}{3} - \\frac{4}{3} = \\frac{11}{3}\n$$\n降阶算子是标量 $S = \\frac{11}{3}$。\n\n接下来，我们计算修正后的右端项 $\\hat{b}_{2}$。我们已经有了 $A_{21} A_{11}^{-1}$，所以我们计算乘积 $A_{21} A_{11}^{-1} b_{1}$：\n$$\nA_{21} A_{11}^{-1} b_{1} = \\begin{pmatrix} 2 & \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 7 \\\\ -1 \\end{pmatrix} = \\left( 2 \\cdot 7 + \\left(\\frac{2}{3}\\right) \\cdot (-1) \\right) = 14 - \\frac{2}{3} = \\frac{42}{3} - \\frac{2}{3} = \\frac{40}{3}\n$$\n现在我们可以计算 $\\hat{b}_{2}$：\n$$\n\\hat{b}_{2} = b_{2} - A_{21} A_{11}^{-1} b_{1} = (6) - \\left(\\frac{40}{3}\\right) = \\frac{18}{3} - \\frac{40}{3} = -\\frac{22}{3}\n$$\n因此，降阶标量方程 $S x_{2} = \\hat{b}_{2}$ 为：\n$$\n\\frac{11}{3} x_{2} = -\\frac{22}{3}\n$$\n求解 $x_{2}$，我们将两边同乘以 $3$ 得到 $11 x_{2} = -22$，从而得出：\n$$\nx_{2} = \\frac{-22}{11} = -2\n$$\n次场变量的值为 $x_{2} = -2$。",
            "answer": "$$\n\\boxed{-2}\n$$"
        },
        {
            "introduction": "在基础代数之上，本实践将分块求解器与一个真实世界的应用联系起来：不可压缩流动的有限元模拟。您将学习如何估计系统子块的大小，并分析不同场分离预处理器的计算成本，从而为设计高效的多物理场求解器建立关于实际权衡的直觉。",
            "id": "3521946",
            "problem": "考虑一个由二维域上的不可压缩斯托克斯流产生的、具有块结构的耦合鞍点系统的双场混合有限元离散化。该离散线性系统具有以下形式：\n$$\n\\begin{bmatrix}\nK & B^{\\top} \\\\\nB & -C\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf \\\\\ng\n\\end{bmatrix},\n$$\n其中 $K \\in \\mathbb{R}^{n_u \\times n_u}$ 是速度块，$B \\in \\mathbb{R}^{n_p \\times n_u}$ 是离散散度算子，$C \\in \\mathbb{R}^{n_p \\times n_p}$ 是一个稳定化或耦合块（对于不可压缩斯托克斯流，$C = 0$）。该离散问题建立在一个单位正方形的均匀结构化网格上，该网格被划分为 $N_x \\times N_y$ 个轴对齐的矩形，每个矩形通过一条一致的对角线被分割成两个三角形。设空间维度为 $d=2$。对于有限元空间，考虑 Taylor–Hood 单元对（速度 $P2$，压力 $P1$）或 MINI 单元（速度为每个三角形上增加一个气泡函数的 $P1$ 单元，压力为 $P1$ 单元）。假设压力被约束为零均值，这有效地将压力空间维度减少了 $1$。为进行自由度计数，忽略狄利克雷边界条件的强施加；也就是说，计算边界消除之前所有已组装的未知数。对于预处理，考虑在克雷洛夫方法内部应用三种场分裂策略，每种策略由预处理器应用如何使用子求解来定义：\n- 块对角 (BD)：每次迭代应用一次对 $K$ 的近似求解和一次对压力舒尔补近似 $\\tilde S$ 的求解。\n- 块下三角 (BT)：每次迭代应用一次对 $K$ 的近似求解和一次对 $\\tilde S$ 的求解。\n- 通过内部 $K$ 求解的舒尔补 (INNERS，参数为 $k$)：对速度块应用一次对 $K$ 的近似求解，并使用 $k$ 次近似 $K^{-1}$ 的应用来近似压力场的舒尔补作用，无直接压力求解。\n\n您的任务是，为每个指定的测试用例计算：\n- 未知数总数 $n = n_u + n_p$。\n- 比率 $r = n_u / n_p$，四舍五入到 $6$ 位小数。\n- 每个预处理克雷洛夫迭代中调用的 $K$ 块线性求解次数（整数）。\n- 每次迭代中调用的压力舒尔补求解次数（整数；根据定义，对于 INNERS 变体，此值为 $0$）。\n- 一个布尔值，指示 $K$ 块子求解在其约束子空间上是否为对称正定（SPD）（对于具有标准无滑移条件的扩散主导 $K$，假定为 $\\text{True}$）。\n- 一个布尔值，指示压力舒尔补子求解是否为 SPD（对于使用带零均值约束的压力泊松近似的 BD 和 BT，假定为 $\\text{True}$；对于 INNERS，由于未调用直接舒尔求解，假定为 $\\text{False}$）。\n\n基于以下关于矩形在一致分割下的单连通平面三角剖分的已充分检验的事实进行推导：\n- 顶点数为 $V = (N_x + 1)(N_y + 1)$。\n- 三角形数为 $T = 2 N_x N_y$。\n- 根据具有单个外表面的平面三角剖分的欧拉公式，$V - E + T = 1$，因此边数为 $E = V + T - 1$。\n- 对于连续标量 $P1$ 空间，自由度数为 $V$。\n- 对于三角形上的连续标量 $P2$ 空间，自由度数为 $V + E$。\n- 对于每个三角形增加一个气泡函数的标量 $P1$ (MINI) 空间，自由度数为 $V + T$。\n- 对于 $d = 2$ 维的矢量值速度，将标量计数乘以 $d$。\n- 施加零均值压力约束会使压力维度减少 $1$，因此 $n_p = V - 1$。\n\n使用以上信息推导每种预处理器下子块的相对大小和每次迭代的子求解次数。然后实现一个程序，为每个测试用例计算一个具有以下结构的结果列表：\n- $[n,\\ r,\\ n_K,\\ n_S,\\ \\text{isKSPD},\\ \\text{isSSPD}]$,\n其中 $n$ 是一个整数，$r$ 是一个四舍五入到 $6$ 位小数的浮点数，$n_K$ 和 $n_S$ 是整数，而 $\\text{isKSPD}$ 和 $\\text{isSSPD}$ 是布尔值。\n\n待评估的测试套件：\n- 用例 1：$N_x = 2$, $N_y = 2$，单元 $=$ Taylor–Hood ($P2$–$P1$)，预处理器 $=$ BD。\n- 用例 2：$N_x = 1$, $N_y = 1$，单元 $=$ MINI (速度为 $P1$ 加气泡函数；压力为 $P1$)，预处理器 $=$ BT。\n- 用例 3：$N_x = 3$, $N_y = 2$，单元 $=$ Taylor–Hood ($P2$–$P1$)，预处理器 $=$ INNERS，参数 $k = 2$。\n- 用例 4：$N_x = 5$, $N_y = 1$，单元 $=$ MINI (速度为 $P1$ 加气泡函数；压力为 $P1$)，预处理器 $=$ BD。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，其中每个条目对应一个测试用例，并且本身是一个严格按照 $[n,r,n_K,n_S,\\text{isKSPD},\\text{isSSPD}]$ 顺序排列的列表。例如，最后一行应类似于 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，不含任何额外文本。",
            "solution": "该问题陈述经过严格审查，被确定为**有效**。这是一个在计算流体动力学数值分析领域内自洽、有科学依据且适定的问题。所提供的定义、公式和假设是一致且充分的，足以推导出唯一解。因此，我们可以进行形式化的求解。\n\n该问题要求分析一个由不可压缩斯托克斯方程的混合有限元公式产生的离散线性系统。该系统由以下块矩阵方程给出：\n$$\n\\begin{bmatrix}\nK & B^{\\top} \\\\\nB & -C\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf \\\\\ng\n\\end{bmatrix}\n$$\n在这里，$K$ 代表速度-速度耦合（粘性项和对流项），$B$ 是离散散度算子（连续性方程），$C$ 是一个压力稳定项，对于此处考虑的标准公式，该项为空（$C=0$）。我们的任务是为几个由网格分辨率、单元选择和预处理器策略定义的配置，确定该系统的关键特性。\n\n我们的分析将分两个阶段进行。首先，我们将根据提供的网格和有限元空间定义，推导自由度（DoFs）数量的通用公式。其次，我们将为每种指定的预处理策略分析每次迭代的计算成本（以子求解次数计）。最后，我们将把这些推导出的公式应用于每个测试用例。\n\n**1. 自由度 ($n_u, n_p$) 的推导**\n\n未知数的总数是 $n = n_u + n_p$，其中 $n_u$ 是速度空间的维度，$n_p$ 是压力空间的维度。问题指定了一个二维域（$d=2$），离散为 $N_x \\times N_y$ 个矩形单元，每个单元被细分为两个三角形。\n\n用于自由度计数的基本量是网格中的顶点数（$V$）、边数（$E$）和三角形数（$T$）。根据问题陈述：\n- 顶点数：$V = (N_x + 1)(N_y + 1)$\n- 三角形数：$T = 2 N_x N_y$\n- 边数：$E = V + T - 1$\n\n两种单元对的压力空间都是连续分片线性空间（$P1$），并附加一个压力具有零均值的约束。\n- 标量连续 $P1$ 场的自由度数等于顶点数 $V$。\n- 零均值约束 $\\int p \\,d\\Omega = 0$ 移除了一个自由度。\n- 因此，压力自由度数为 $n_p = V - 1$。\n\n速度自由度数 $n_u$ 取决于所选的速度有限元空间。\n\n**情况 A：Taylor–Hood 单元（$P2$ 速度）**\n速度使用连续分片二次（$P2$）单元进行近似。\n- 三角形网格上标量 $P2$ 场的自由度数由 $V + E$ 给出。\n- 对于 $d=2$ 维中的矢量值速度场，我们将标量计数乘以 $d$。\n- 因此，$n_u = d \\times (V + E) = 2(V + E)$。\n- 代入给定的 $E$ 的表达式：\n  $$n_u = 2(V + (V + T - 1)) = 2(2V + T - 1)$$\n\n**情况 B：MINI 单元（$P1$ + 气泡速度）**\n速度使用每个单元上增加一个三次气泡函数（$P1_b$）的连续分片线性单元进行近似。\n- 标量 $P1_b$ 场的自由度数由 $V + T$ 给出。\n- 对于 $d=2$ 维中的矢量值速度场：\n- 因此，$n_u = d \\times (V + T) = 2(V + T)$。\n\n**2. 预处理器工作量分析**\n\n我们被要求确定预处理克雷洛夫方法每次迭代的 $K$ 块求解次数（$n_K$）和压力舒尔补求解次数（$n_S$）。压力舒尔补是 $S = B K^{-1} B^{\\top} + C$。当 $C=0$ 时，$S = B K^{-1} B^{\\top}$。预处理器使用近似 $\\tilde{K} \\approx K$ 和 $\\tilde{S} \\approx S$。\n\n- **块对角 (BD) 预处理器：**\n  预处理器为 $\\mathcal{P}_{BD} = \\text{diag}(\\tilde{K}, \\tilde{S})$。$\\mathcal{P}_{BD}^{-1}$ 的一次应用涉及求解一个含 $\\tilde{K}$ 的系统和一个含 $\\tilde{S}$ 的系统。\n  因此，$n_K = 1$ 且 $n_S = 1$。\n\n- **块下三角 (BT) 预处理器：**\n  预处理器为 $\\mathcal{P}_{BT} = \\begin{bmatrix} \\tilde{K} & 0 \\\\ B & -\\tilde{S} \\end{bmatrix}$。应用其逆需要一次块前向替换，这涉及一次对 $\\tilde{K}$ 的求解，然后一次对 $\\tilde{S}$ 的求解。\n  因此，$n_K = 1$ 且 $n_S = 1$。\n\n- **通过内部 $K$ 求解的舒尔补 (INNERS) 预处理器：**\n  该策略避免了构造和直接求逆近似 $\\tilde{S}$。而是使用内部迭代方法来近似 $S^{-1}$ 的作用。一个与问题描述一致的常用方法是使用块上三角预处理器 $\\mathcal{P}_{INNERS} = \\begin{bmatrix} \\tilde{K} & B^{\\top} \\\\ 0 & -\\tilde{S} \\end{bmatrix}$。应用其逆 $\\mathcal{P}_{INNERS}^{-1}$ 涉及一次块后向替换：\n  1. 从 $-\\tilde{S}w_p = r_p$ 求解压力分量 $w_p$。这是通过使用内部克雷洛夫求解器（例如，共轭梯度法）对 $(B \\tilde{K}^{-1} B^{\\top}) w_p \\approx -r_p$ 进行固定次数 $k$ 的迭代来完成的。每次迭代需要一次与算子 $B \\tilde{K}^{-1} B^{\\top}$ 的矩阵向量积，这需要一次对 $\\tilde{K}$ 的求解。因此，此步骤的成本为 $k$ 次对 $\\tilde{K}$ 的求解。\n  2. 从 $\\tilde{K} w_u = r_u - B^{\\top} w_p$ 求解速度分量 $w_u$。这需要一次对 $\\tilde{K}$ 的求解。\n  $\\tilde{K}$ 求解的总次数是两个步骤的总和。根据问题，没有发生对压力矩阵的直接求解。\n  因此，$n_K = k + 1$ 且 $n_S = 0$。\n\nSPD属性是作为假设给出的：`isKSPD` 始终为 `True`。`isSSPD` 对于BD和BT为 `True`，对于INNERS为 `False`。\n\n**3. 应用于测试用例**\n\n现在我们将这些公式应用于具体用例。\n\n**用例 1：$N_x = 2, N_y = 2$，Taylor–Hood，BD**\n- 网格：$N_x=2, N_y=2 \\implies V=(2+1)(2+1)=9, T=2(2)(2)=8, E=9+8-1=16$。\n- 自由度：\n  - $n_p = V - 1 = 9 - 1 = 8$。\n  - $n_u = 2(2V + T - 1) = 2(2(9) + 8 - 1) = 2(18+7) = 50$。\n  - $n = n_u + n_p = 50 + 8 = 58$。\n- 比率：$r = n_u / n_p = 50 / 8 = 6.25$。\n- 预处理器 (BD)：$n_K = 1, n_S = 1$。`isKSPD`=True, `isSSPD`=True。\n- 结果：$[58, 6.250000, 1, 1, \\text{True}, \\text{True}]$。\n\n**用例 2：$N_x = 1, N_y = 1$，MINI，BT**\n- 网格：$N_x=1, N_y=1 \\implies V=(1+1)(1+1)=4, T=2(1)(1)=2$。\n- 自由度：\n  - $n_p = V - 1 = 4 - 1 = 3$。\n  - $n_u = 2(V + T) = 2(4 + 2) = 12$。\n  - $n = n_u + n_p = 12 + 3 = 15$。\n- 比率：$r = n_u / n_p = 12 / 3 = 4.0$。\n- 预处理器 (BT)：$n_K = 1, n_S = 1$。`isKSPD`=True, `isSSPD`=True。\n- 结果：$[15, 4.000000, 1, 1, \\text{True}, \\text{True}]$。\n\n**用例 3：$N_x = 3, N_y = 2$，Taylor–Hood，INNERS ($k=2$)**\n- 网格：$N_x=3, N_y=2 \\implies V=(3+1)(2+1)=12, T=2(3)(2)=12, E=12+12-1=23$。\n- 自由度：\n  - $n_p = V - 1 = 12 - 1 = 11$。\n  - $n_u = 2(2V + T - 1) = 2(2(12) + 12 - 1) = 2(24 + 11) = 70$。\n  - $n = n_u + n_p = 70 + 11 = 81$。\n- 比率：$r = n_u / n_p = 70 / 11 \\approx 6.363636...$\n- 预处理器 (INNERS, $k=2$)：$n_K = k+1 = 3, n_S = 0$。`isKSPD`=True, `isSSPD`=False。\n- 结果：$[81, 6.363636, 3, 0, \\text{True}, \\text{False}]$。\n\n**用例 4：$N_x = 5, N_y = 1$，MINI，BD**\n- 网格：$N_x=5, N_y=1 \\implies V=(5+1)(1+1)=12, T=2(5)(1)=10$。\n- 自由度：\n  - $n_p = V - 1 = 12 - 1 = 11$。\n  - $n_u = 2(V + T) = 2(12 + 10) = 44$。\n  - $n = n_u + n_p = 44 + 11 = 55$。\n- 比率：$r = n_u / n_p = 44 / 11 = 4.0$。\n- 预处理器 (BD)：$n_K = 1, n_S = 1$。`isKSPD`=True, `isSSPD`=True。\n- 结果：$[55, 4.000000, 1, 1, \\text{True}, \\text{True}]$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes system properties for specified finite element discretizations\n    of the Stokes equations.\n    \"\"\"\n    test_cases = [\n        {'nx': 2, 'ny': 2, 'element': 'Taylor-Hood', 'precond': 'BD', 'k': None},\n        {'nx': 1, 'ny': 1, 'element': 'MINI', 'precond': 'BT', 'k': None},\n        {'nx': 3, 'ny': 2, 'element': 'Taylor-Hood', 'precond': 'INNERS', 'k': 2},\n        {'nx': 5, 'ny': 1, 'element': 'MINI', 'precond': 'BD', 'k': None},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        nx = case['nx']\n        ny = case['ny']\n        element = case['element']\n        precond = case['precond']\n        k = case['k']\n        \n        # d is the spatial dimension, fixed at 2\n        d = 2\n\n        # 1. Mesh property calculation\n        V = (nx + 1) * (ny + 1)  # Number of vertices\n        T = 2 * nx * ny          # Number of triangles\n\n        # 2. Degree-of-freedom (DoF) calculation\n        # Pressure DoFs (P1 elements with mean-zero constraint)\n        n_p = V - 1\n        \n        # Velocity DoFs depend on the element type\n        if element == 'Taylor-Hood': # P2 velocity\n            E = V + T - 1 # Number of edges\n            # Scalar P2 DoFs = V + E\n            # Vector velocity DoFs = d * (scalar DoFs)\n            n_u = d * (V + E)\n        elif element == 'MINI': # P1 + bubble velocity\n            # Scalar P1b DoFs = V + T\n            # Vector velocity DoFs = d * (scalar DoFs)\n            n_u = d * (V + T)\n        \n        n = n_u + n_p  # Total number of unknowns\n        \n        # Ensure n_p is not zero to avoid division by zero error\n        if n_p > 0:\n            r = n_u / n_p\n        else:\n            r = 0.0 # Or handle as an error case, though not expected here.\n\n        # 3. Preconditioner analysis\n        if precond == 'BD': # Block-diagonal\n            n_K = 1\n            n_S = 1\n            isSSPD = True\n        elif precond == 'BT': # Block lower-triangular\n            n_K = 1\n            n_S = 1\n            isSSPD = True\n        elif precond == 'INNERS': # Schur complement via inner K-solves\n            n_K = k + 1\n            n_S = 0\n            isSSPD = False\n        \n        isKSPD = True # Assumed True for all cases\n        \n        # 4. Assemble the result list\n        # We build the string representation manually to match the required format.\n        # Python's bool `True`/`False` string representation is correct.\n        # The float must be formatted to 6 decimal places.\n        result_str = f\"[{n},{r:.6f},{n_K},{n_S},{isKSPD},{isSSPD}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    # The requirement is [[..],[..]], so we join the pre-formatted strings\n    # and add the outer brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个有效的预处理器不仅要计算成本低，还必须数值稳定。这个高级练习探讨了混合方法中的一个经典失效模式，其中违反 inf-sup 稳定条件会导致奇异的舒尔补。通过一个精心构建的反例，您将诊断问题所在，并学习如何通过稳定化技术恢复预处理策略的鲁棒性。",
            "id": "3521944",
            "problem": "考虑一个多物理场耦合模拟中的一个不可压缩子问题的线性化、稳态、混合格式。其离散代数系统具有如下的 $2 \\times 2$ 分块结构\n$$\n\\begin{pmatrix}\nA & B^{\\top} \\\\\nB & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\np\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf \\\\\ng\n\\end{pmatrix},\n$$\n其中 $A \\in \\mathbb{R}^{m \\times m}$ 代表速度（或通量）分块，并且是对称正定 (SPD) 的；$B \\in \\mathbb{R}^{n \\times m}$ 是离散散度算子；$p \\in \\mathbb{R}^{n}$ 是压力向量。一种广泛使用的场分裂预处理器将作用于压力空间的（负）舒尔补 $S := - B A^{-1} B^{\\top}$ 替换为压力质量矩阵 $M_{p}$，即它使用 $M_{p}$ 作为 $-S$ 的一个基于物理的近似。\n\n当离散 inf-sup 条件被违反时，构造一个显式的有限维反例，以显示这种基于质量的压力预处理器的失效，然后提出一个能够恢复稳定性的最小增广。为此，考虑以下具体选择\n$$\nA := \\alpha \\in \\mathbb{R}, \\quad \\alpha > 0, \\qquad B := \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 1}, \\qquad M_{p} := I_{2} \\in \\mathbb{R}^{2 \\times 2}.\n$$\n请执行以下步骤：\n\n1. 从离散 inf-sup 条件关于 $B$ 的满射性定义出发，证明存在一个非零压力向量 $p \\in \\mathbb{R}^{2}$ 位于 $B^{\\top}$ 的核中，并解释为什么这表明对于给定的配对，离散 inf-sup 条件被违反。\n\n2. 使用舒尔补的定义，对于给定的 $A$、$B$ 和 $M_{p}$，推导质量预处理的负舒尔补 $M_{p}^{-1} \\left( B A^{-1} B^{\\top} \\right)$ 的特征值。解释为什么该结果说明了朴素的基于质量的压力预处理器的失效。\n\n3. 提出对鞍点系统 $(2,2)$ 分块的一个增广，方法是添加一个形如 $\\tau M_{p}$（其中 $\\tau > 0$）的稳定项，这对应于压力稳定化或人工可压缩性。推导增广的质量预处理的负舒尔补 $M_{p}^{-1} \\left( B A^{-1} B^{\\top} + \\tau M_{p} \\right)$ 的特征值，然后推导这个 $2 \\times 2$ 对称正定矩阵的谱条件数，作为 $\\alpha$ 和 $\\tau$ 的函数。\n\n你的最终答案必须是谱条件数作为 $\\alpha$ 和 $\\tau$ 的函数的单个闭式解析表达式。这是一个无量纲量；不要包含单位。无需进行四舍五入。",
            "solution": "我们从混合鞍点系统和舒尔补的定义开始。完整的块系统是\n$$\n\\begin{pmatrix}\nA & B^{\\top} \\\\\nB & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\np\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf \\\\\ng\n\\end{pmatrix},\n$$\n其中 $A$ 是对称正定 (SPD) 的。形式上消去 $u$ 会得到关于 $p$ 的舒尔补方程：\n$$\n- B A^{-1} B^{\\top} \\, p = g - B A^{-1} f,\n$$\n其中 $S := - B A^{-1} B^{\\top}$ 通常是对称半负定的。在场分裂预处理策略中，一个常见的基于物理的近似是将 $-S$ 替换为压力质量矩阵 $M_{p}$。\n\n步骤 1：我们分析对于以下具体选择的离散 inf-sup 稳定性\n$$\nA := \\alpha > 0, \\qquad B := \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 1}, \\qquad M_{p} := I_{2}.\n$$\n离散 inf-sup 条件，用满射性来表述，要求 $B$ 具有满行秩，对于 $B \\in \\mathbb{R}^{n \\times m}$ 来说，这意味着 $\\operatorname{rank}(B) = n$。等价地，不应存在非平凡向量 $p \\in \\mathbb{R}^{n}$ 使得 $B^{\\top} p = 0$。这里 $B^{\\top} \\in \\mathbb{R}^{1 \\times 2}$ 是\n$$\nB^{\\top} = \\begin{pmatrix} 1 & -1 \\end{pmatrix}.\n$$\n令 $p = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。则\n$$\nB^{\\top} p = \\begin{pmatrix} 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1 - 1 = 0.\n$$\n因此，在 $\\ker(B^{\\top})$ 中存在一个非零压力向量 $p \\neq 0$。这表明离散 inf-sup 条件被违反。物理上，$p = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 代表一种棋盘格式的压力模式，这种模式不会被离散散度算子所“看到”，这是不稳定的等阶离散化的一个标志。\n\n步骤 2：我们构建负舒尔补及其质量预处理。由于 $A = \\alpha$，我们有 $A^{-1} = \\alpha^{-1}$。乘积 $B A^{-1} B^{\\top}$ 是\n$$\nB A^{-1} B^{\\top} = \\alpha^{-1} \\, B B^{\\top} = \\alpha^{-1} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} 1 & -1 \\end{pmatrix} = \\alpha^{-1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}.\n$$\n定义 $2 \\times 2$ 矩阵\n$$\nL := \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}.\n$$\n众所周知，且易于验证，$L$ 的特征对 $(\\lambda, v)$ 由下式给出\n$$\n\\lambda_{1} = 0, \\quad v_{1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\qquad \\lambda_{2} = 2, \\quad v_{2} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n因此，$B A^{-1} B^{\\top}$ 的谱是 $\\{ 0, \\, 2 \\alpha^{-1} \\}$。使用基于质量的预处理器 $M_{p} = I_{2}$，预处理后的负舒尔补是\n$$\nM_{p}^{-1} \\left( B A^{-1} B^{\\top} \\right) = \\alpha^{-1} L,\n$$\n其特征值为 $\\{ 0, \\, 2 \\alpha^{-1} \\}$。零特征值的存在表明，基于质量的近似 $M_{p}$ 与此离散空间上的真实（负）舒尔补并非谱等价，因此该预处理器不是鲁棒的：谱接触到零，可能导致迭代方法停滞或任意慢的收敛，并在预处理的舒尔补求解中导致稳定性破坏。\n\n步骤 3：为了恢复稳定性，我们通过添加一个对应于压力惩罚（也可解释为人工可压缩性）的稳定项来增广 $(2,2)$ 分块，用 $- \\tau M_{p}$（其中 $\\tau > 0$）替换零分块。在舒尔补的层面上，这产生了增广的负舒尔算子\n$$\nB A^{-1} B^{\\top} + \\tau M_{p} = \\alpha^{-1} L + \\tau I_{2}.\n$$\n由于 $L$ 和 $I_{2}$ 可交换且共享特征向量，增广算子的特征值只是简单地平移了 $\\tau$：\n$$\n\\lambda_{1}^{\\mathrm{aug}} = \\tau + 0 = \\tau, \\qquad \\lambda_{2}^{\\mathrm{aug}} = \\tau + 2 \\alpha^{-1}.\n$$\n使用相同的质量预处理器 $M_{p} = I_{2}$，预处理的增广负舒尔补为 $M_{p}^{-1} \\left( B A^{-1} B^{\\top} + \\tau M_{p} \\right) = \\alpha^{-1} L + \\tau I_{2}$，对于任何 $\\tau > 0$ 它都是对称正定的。因此，其谱条件数（定义为最大特征值与最小特征值之比）为\n$$\n\\kappa(\\alpha, \\tau) = \\frac{\\tau + 2 \\alpha^{-1}}{\\tau}.\n$$\n这个闭式表达式表明，增广消除了零特征值并恢复了有限的条件数。此外，对于固定的 $\\alpha$，增加 $\\tau$ 会改善条件数；而对于固定的 $\\tau$，增加 $\\alpha$（即更强的 $A$）也会通过减小 $\\alpha^{-1}$ 来改善条件数。\n\n因此，该反例展示了在离散 inf-sup 条件被违反的情况下，朴素的基于质量的压力预处理器的失效，而所提出的通过 $\\tau M_{p}$ 进行的增广恢复了稳定性，其谱条件数如上所示。",
            "answer": "$$\\boxed{\\frac{\\tau + 2\\,\\alpha^{-1}}{\\tau}}$$"
        }
    ]
}