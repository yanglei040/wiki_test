{
    "hands_on_practices": [
        {
            "introduction": "异质多尺度方法 (HMM) 的核心在于利用微观尺度计算来为宏观模型提供本构关系。这个练习将带你动手实践 HMM 框架中的关键一步：宏观组装。通过一个具体的一维扩散问题，你将学习如何使用从微观问题中获得的有效电导率函数，来计算宏观有限元方程的残差，并验证跨单元界面的通量守恒性。",
            "id": "3508973",
            "problem": "考虑一个源于多物理场耦合微观结构的一维标量扩散过程，其中热传导受到电磁场的调制。在微观尺度上，传导系数依赖于一个快速振荡的场，并记为 $A(x/\\varepsilon)$，其中 $\\varepsilon$ 是一个小的无量纲尺度参数，代表特征微观结构长度。宏观场 $u^{H}(x)$ 是温度的有限元近似，并且在区域 $\\Omega = [0, 2]$ 的一个均匀剖分上是分段线性的，其单元为 $K_{1} = [0, 1]$ 和 $K_{2} = [1, 2]$。假设所有量均为无量纲。\n\n非均匀多尺度方法 (HMM) 使用局部微观尺度问题来计算宏观尺度上的有效数值通量。在单元内的每个求积点位置，求解一个局部微单元问题以获得均匀化传导系数 $\\hat{A}(x)$，相应的数值通量为 $q(x) = \\hat{A}(x)\\,\\nabla u^{H}(x)$。在一维情况下，梯度为 $\\nabla u^{H}(x) = \\frac{d u^{H}}{dx}$。\n\n假设在每个单元上，通过微观单元问题计算得到的有效传导系数和宏观梯度如下：\n- 在 $K_{1} = [0, 1]$ 上，$\\hat{A}(x) = 1 + x$ 且 $\\frac{d u^{H}}{dx} = g_{1} = 2$。\n- 在 $K_{2} = [1, 2]$ 上，$\\hat{A}(x) = 3 + x$ 且 $\\frac{d u^{H}}{dx} = g_{2} = 1$。\n\n令测试函数 $\\varphi$ 为与内部节点 $x = 1$ 相关联的标准连续帽子函数，定义为：当 $x \\in [0, 1]$ 时 $\\varphi(x) = x$，当 $x \\in [1, 2]$ 时 $\\varphi(x) = 2 - x$，在 $[0, 2]$ 之外 $\\varphi(x) = 0$。\n\n从守恒律及其针对具有非均匀系数的扩散算子的弱形式出发，使用非均匀多尺度方法 (HMM) 的宏观组装原理，通过在每个单元上对微观计算的通量 $q(x) = \\hat{A}(x)\\,\\frac{d u^{H}}{dx}$ 与 $\\nabla \\varphi$ 进行积分，来计算测试函数 $\\varphi$ 的宏观有限元残差。在一维情况下，在没有源项和齐次狄利克雷边界条件下，该残差由双线性形式 $\\sum_{K} \\int_{K} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$ 给出。\n\n此外，通过显式计算数值通量的跳跃 $[q] = q_{L}(1) - q_{R}(1)$ 来验证在界面 $x = 1$ 处的守恒性，其中 $q_{L}(1)$ 是 $q(x)$ 从 $K_{1}$ 内部趋近于 $x = 1$ 的极限，$q_{R}(1)$ 是从 $K_{2}$ 内部趋近于 $x = 1$ 的极限。\n\n计算 $\\varphi$ 的宏观有限元残差，并将其报告为单个实数。无需四舍五入。此外，在推导过程中说明计算出的通量跳跃 $[q]$，但您报告的最终数值答案必须仅为残差值。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取已知条件\n- **区域**：$\\Omega = [0, 2]$\n- **单元**：$K_{1} = [0, 1]$ 和 $K_{2} = [1, 2]$\n- **宏观场近似**：$u^{H}(x)$ 是分段线性的。\n- **在 $K_{1} = [0, 1]$ 上的微观计算有效传导系数和宏观梯度**：$\\hat{A}(x) = 1 + x$ 且 $\\frac{d u^{H}}{dx} = g_{1} = 2$。\n- **在 $K_{2} = [1, 2]$ 上的微观计算有效传导系数和宏观梯度**：$\\hat{A}(x) = 3 + x$ 且 $\\frac{d u^{H}}{dx} = g_{2} = 1$。\n- **测试函数**：当 $x \\in [0, 1]$ 时 $\\varphi(x) = x$，当 $x \\in [1, 2]$ 时 $\\varphi(x) = 2 - x$。在 $[0, 2]$ 之外 $\\varphi(x) = 0$。\n- **残差公式**：$\\sum_{K} \\int_{K} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$。\n- **数值通量定义**：$q(x) = \\hat{A}(x)\\,\\nabla u^{H}(x)$。\n- **通量跳跃定义**：$[q] = q_{L}(1) - q_{R}(1)$，其中 $q_{L}(1)$ 是从 $K_1$ 内部趋近的极限，$q_{R}(1)$ 是从 $K_2$ 内部趋近的极限。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性**：该问题描述了非均匀多尺度方法 (HMM) 在扩散问题上的一个简化一维应用。均匀化、宏观尺度有限元近似、微观尺度信息驱动的有效性质以及残差计算等概念在计算多尺度建模领域是标准的且科学合理的。没有违反任何科学定律。\n2.  **非形式化或不相关**：该问题与 HMM 主题直接相关，并以形式化的数学方式表达，可以进行严谨的求解。\n3.  **不完整或矛盾的设置**：所有必要的函数（$\\hat{A}(x)$、$\\frac{du^H}{dx}$、$\\varphi(x)$）和积分域都已明确定义。问题是自洽的，没有矛盾。\n4.  **不切实际或不可行**：所选的函数和数值是为了数学上的便利，但并非物理上不可能。使用无量纲量是标准做法。\n5.  **不适定或结构不良**：该问题是适定的。它要求计算特定的定积分和极限，存在唯一且稳定的结果。\n6.  **伪深刻、琐碎或同义反复**：该问题需要直接应用微积分和所提供的定义，旨在测试对 HMM 组装过程的理解。它既不琐碎，也非人为复杂。\n7.  **超出科学可验证性**：计算过程在数学上是可验证的。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供详细解答。\n\n主要目标是为给定的测试函数 $\\varphi$ 计算宏观有限元残差 $R$。该残差由与扩散算子相关的双线性形式定义，并在网格的所有单元 $K$ 上求和：\n$$R = \\sum_{K} \\int_{K} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$$\n求和是在测试函数支集为非零的单元上进行的，本例中即为 $K_1 = [0, 1]$ 和 $K_2 = [1, 2]$。\n$$R = \\int_{0}^{1} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx + \\int_{1}^{2} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$$\n\n首先，我们需要确定测试函数在每个单元上的导数 $\\frac{d \\varphi}{dx}$。\n- 对于 $x \\in K_1 = [0, 1]$，测试函数为 $\\varphi(x) = x$。其导数为 $\\frac{d \\varphi}{dx} = 1$。\n- 对于 $x \\in K_2 = [1, 2]$，测试函数为 $\\varphi(x) = 2 - x$。其导数为 $\\frac{d \\varphi}{dx} = -1$。\n\n现在，我们可以分别计算每个单元上的积分。\n\n对于第一个单元 $K_1 = [0, 1]$：\n已知 $\\hat{A}(x) = 1 + x$ 且 $\\frac{d u^{H}}{dx} = 2$。\n该单元上的积分为：\n$$I_1 = \\int_{0}^{1} (1 + x)\\,(2)\\,(1)\\,dx = 2 \\int_{0}^{1} (1 + x)\\,dx$$\n计算该积分：\n$$I_1 = 2 \\left[ x + \\frac{x^2}{2} \\right]_{0}^{1} = 2 \\left( \\left(1 + \\frac{1^2}{2}\\right) - \\left(0 + \\frac{0^2}{2}\\right) \\right) = 2 \\left( \\frac{3}{2} \\right) = 3$$\n\n对于第二个单元 $K_2 = [1, 2]$：\n已知 $\\hat{A}(x) = 3 + x$ 且 $\\frac{d u^{H}}{dx} = 1$。\n该单元上的积分为：\n$$I_2 = \\int_{1}^{2} (3 + x)\\,(1)\\,(-1)\\,dx = - \\int_{1}^{2} (3 + x)\\,dx$$\n计算该积分：\n$$I_2 = - \\left[ 3x + \\frac{x^2}{2} \\right]_{1}^{2} = - \\left( \\left(3(2) + \\frac{2^2}{2}\\right) - \\left(3(1) + \\frac{1^2}{2}\\right) \\right)$$\n$$I_2 = - \\left( (6 + 2) - \\left(3 + \\frac{1}{2}\\right) \\right) = - \\left( 8 - \\frac{7}{2} \\right) = - \\left( \\frac{16 - 7}{2} \\right) = -\\frac{9}{2}$$\n\n总残差 $R$ 是每个单元贡献的总和：\n$$R = I_1 + I_2 = 3 + \\left(-\\frac{9}{2}\\right) = \\frac{6}{2} - \\frac{9}{2} = -\\frac{3}{2}$$\n\n接下来，我们验证在界面 $x=1$ 处的通量守恒性。数值通量由 $q(x) = \\hat{A}(x)\\,\\frac{d u^{H}}{dx}$ 给出。我们需要计算跳跃 $[q] = q_{L}(1) - q_{R}(1)$。\n\n在界面的左侧（$K_1$ 内部），通量为：\n$$q_L(x) = (1+x)(2)$$\n从左侧趋近于 $x=1$ 的极限是：\n$$q_L(1) = \\lim_{x \\to 1^-} 2(1+x) = 2(1+1) = 4$$\n\n在界面的右侧（$K_2$ 内部），通量为：\n$$q_R(x) = (3+x)(1)$$\n从右侧趋近于 $x=1$ 的极限是：\n$$q_R(1) = \\lim_{x \\to 1^+} (3+x) = 3+1 = 4$$\n\n因此，在 $x=1$ 处的数值通量跳跃为：\n$$[q] = q_L(1) - q_R(1) = 4 - 4 = 0$$\n零通量跳跃表明数值通量在单元界面上是连续的，这是此 HMM 设置中守恒的一个条件。\n\n所要求的最终答案是宏观有限元残差的值。",
            "answer": "$$\\boxed{-\\frac{3}{2}}$$"
        },
        {
            "introduction": "在多尺度建模中，确保微观与宏观尺度之间的信息传递是一致且无伪影的至关重要。此练习将引导你为原子-连续介质耦合这一经典场景构建一对提升 (lifting) 和限制 (restriction) 算子。你将应用柯西-玻恩法则等基本原理，并证明你构建的算子能够通过“斑块测试” (patch test)，即在一个均匀应变状态下不会产生虚假的“鬼力” (ghost force)。",
            "id": "3508906",
            "problem": "考虑一个一维晶体链，其参考晶格间距为 $a>0$，在一个代表性体积单元 (RVE) 中有 $M \\in \\mathbb{N}$ 个原子。原子之间通过一个光滑的对势 $\\phi(r)$ 相互作用，该势仅取决于标量近邻间距 $r>0$。设 $X \\in [0,L]$ 表示宏观坐标， $u(X)$ 表示连续介质位移场。在非均匀多尺度方法 (HMM) 中，一个宏观点 $X_c$ 处的粗糙自由度由一对 $(\\epsilon_c, U_c)$ 表示，其中 $\\epsilon_c$ 是一个粗糙均匀应变（$u$ 相对于 $X$ 的导数，在 $X_c$ 的邻域内被视为常数），$U_c := u(X_c)$ 是 $X_c$ 处的粗糙位移。\n\n您将构建一个提升算子 $\\mathcal{L}$，它将粗糙变量 $(\\epsilon_c, U_c)$ 映射到以 $X_c$ 为中心并具有周期性边界条件的 RVE 中的一组原子位置 $\\{x_j\\}_{j=1}^{M}$；以及一个限制算子 $\\mathcal{R}$，它将原子位置映射回粗糙应变。此构建必须与 Cauchy–Born 法则一致，并且必须遵守刚性平移不变性。目标是确保通过元检验：在均匀应变状态下，粗糙节点残差（即所谓的伪力）为零。\n\n使用以下基本依据：\n- 对于近邻相互作用，RVE 中的总原子能量由 $E(\\{x_j\\}) = \\sum_{j=1}^{M} \\phi(|x_{j+1} - x_j|)$ 给出，其中周期性约定为 $x_{M+1} := x_1 + \\ell$，$\\ell$ 是变形构型中 RVE 的长度，且下标对 $M$ 取模。\n- 一维情况下的 Cauchy–Born 法则断言，均匀的宏观应变 $\\epsilon$ 会在微观晶格中产生均匀的近邻间距 $r = a(1+\\epsilon)$。\n- 力是能量相对于位移的负梯度，平移不变性意味着能量仅取决于距离，而不取决于绝对位置。\n\n任务：\n1. 构建一个提升算子 $\\mathcal{L}$，给定 $(\\epsilon_c, U_c)$，该算子能产生一个具有均匀近鄰间距 $a(1+\\epsilon_c)$ 的周期性原子构型 $\\{x_j\\}_{j=1}^{M}$，且其质心与 $X_c$ 处的 $U_c$ 对齐；除了刚性平移外，不要引入 $\\{x_j\\}$ 对 $U_c$ 的任何依赖性。\n2. 构建一个限制算子 $\\mathcal{R}$，它将一个周期性原子构型 $\\{x_j\\}_{j=1}^{M}$ 映射到一个粗糙应变，通过对相对于 $a$ 的近邻间距进行平均，即使用变形后的 RVE 长度 $\\ell$ 和参考长度 $M a$。\n3. 使用您的 $\\mathcal{L}$ 和 $\\mathcal{R}$，定义在均匀应变 $\\epsilon_c$ 下 RVE 中的能量，并计算在 $X_c$ 处的粗糙位移自由度 $U_c$ 上的伪力 $g_c$。$g_c$ 定义为 $g_c := -\\frac{\\partial}{\\partial U_c} E(\\mathcal{L}(\\epsilon_c, U_c))$ 在均匀应变状态下的求值。用牛顿表示伪力。\n\n您的最终答案必须是一个实数。如果需要任何数值近似，请四舍五入到四位有效数字。在此问题中，请提供精确值。",
            "solution": "该问题要求为一维非均匀多尺度方法 (HMM) 构建提升和限制算子，并随后计算粗糙自由度上的伪力。分析将按照问题陈述中概述的三个步骤进行。\n\n首先，我们处理任务1：构建提升算子 $\\mathcal{L}$。该算子将宏观点 $X_c$ 处的粗糙变量——应变 $\\epsilon_c$ 和位移 $U_c$——映射到代表性体积单元 (RVE) 中的一组原子位置 $\\{x_j\\}_{j=1}^{M}$。构建必须遵守几个约束条件：\n1.  该构型必须表现出与 Cauchy–Born 法则一致的均匀近邻间距，即对于宏观应变 $\\epsilon_c$，间距为 $r_c = a(1+\\epsilon_c)$。\n2.  该构型必须是周期性的。\n3.  原子的质心必须位于宏观点的变形后位置，即 $X_c + U_c$。\n4.  原子位置 $\\{x_j\\}$ 对粗糙位移 $U_c$ 的依赖性必须仅限于刚体平移，以保持势能的平移不变性。\n\n为了满足这些要求，我们可以相对于一个中心点定义原子位置，然后应用必要的平移。让我们定义一组以原点为中心的参考位置，例如，$y_j^0 = a(j - \\frac{M+1}{2})$，对于 $j=1, \\dots, M$。此参考构型的质心为 $\\frac{1}{M}\\sum_{j=1}^M y_j^0 = 0$。根据 Cauchy-Born 法则施加均匀应变 $\\epsilon_c$，相对位置变为 $y_j = y_j^0(1+\\epsilon_c) = a(1+\\epsilon_c)(j - \\frac{M+1}{2})$。最终的绝对位置 $x_j$ 是通过平移此构型得到的，使其质心位于 $X_c + U_c$。\n构型 $\\{y_j\\}$ 的质心仍为零。因此，通过量为 $X_c + U_c$ 的简单刚性平移即可按要求对齐质心。因此，提升算子 $\\mathcal{L}$ 由以下映射定义：\n$$ (\\epsilon_c, U_c) \\mapsto \\{x_j\\}_{j=1}^{M} $$\n其中\n$$ x_j = a(1+\\epsilon_c)\\left(j - \\frac{M+1}{2}\\right) + X_c + U_c $$\n此构建满足所有条件。对于 $j=1, \\dots, M-1$，近邻间距为 $x_{j+1} - x_j = a(1+\\epsilon_c)$。该构型是周期的，变形后 RVE 长度为 $\\ell = M a(1+\\epsilon_c)$，因为跨边界的间距为 $|x_{M+1} - x_M| = |(x_1+\\ell) - x_M| = a(1+\\epsilon_c)$。质心为 $\\frac{1}{M}\\sum_{j=1}^M x_j = X_c + U_c$。关键是，对 $U_c$ 的依赖是均匀的平移，满足了平移不变性的要求。\n\n其次，我们处理任务2：构建限制算子 $\\mathcal{R}$。该算子将原子构型 $\\{x_j\\}_{j=1}^{M}$ 映射回粗糙应变。问题规定，这应通过对相对于参考间距 $a$ 的近邻间距进行平均来完成，即使用变形后的 RVE 长度 $\\ell$ 和参考长度 $L_0 = M a$。宏观应变 $\\epsilon$ 定义为 $\\epsilon = (\\ell - L_0) / L_0$。在我們的一维周期性系统中，近邻键长之和等于 RVE 的总长度：$\\sum_{j=1}^{M} |x_{j+1} - x_j| = \\ell$，其中 $x_{M+1} = x_1 + \\ell$。因此，平均键长为 $r_{\\text{avg}} = \\frac{1}{M}\\sum_{j=1}^{M} |x_{j+1} - x_j| = \\frac{\\ell}{M}$。应变可以用这个平均间距表示为 $\\epsilon = \\frac{r_{\\text{avg}}}{a} - 1$。代入 $r_{\\text{avg}} = \\ell/M$ 得 $\\epsilon = \\frac{\\ell/M}{a} - 1 = \\frac{\\ell}{Ma} - 1$。\n因此，限制算子定义为：\n$$ \\mathcal{R}(\\{x_j\\}_{j=1}^{M}, \\ell) = \\frac{\\ell}{Ma} - 1 $$\n该算子与提升算子是一致的。将 $\\mathcal{R}$ 应用于由 $\\mathcal{L}(\\epsilon_c, U_c)$ 生成的状态，其中 $\\ell = M a(1+\\epsilon_c)$，得到 $\\mathcal{R}(\\mathcal{L}(\\epsilon_c, U_c)) = \\frac{M a(1+\\epsilon_c)}{Ma} - 1 = \\epsilon_c$。\n\n第三，我们处理任务3：计算伪力 $g_c$。粗糙位移自由度 $U_c$ 上的伪力定义为总原子能量相对于 $U_c$ 的负梯度，在均匀应变状态下求值：\n$$ g_c = -\\frac{\\partial}{\\partial U_c} E(\\mathcal{L}(\\epsilon_c, U_c)) $$\nRVE 的总原子能量由 $E(\\{x_j\\}) = \\sum_{j=1}^{M} \\phi(|x_{j+1} - x_j|)$ 给出，其中周期性边界条件为 $x_{M+1} := x_1 + \\ell$。让我们为我们的提升算子 $\\mathcal{L}(\\epsilon_c, U_c)$ 产生的构型 $\\{x_j\\}$ 计算能量。\n近邻间距对于 $j=1, \\dots, M-1$ 是 $|x_{j+1} - x_j|$，对于跨越周期性边界的键是 $|x_{M+1} - x_M|$。\n对于任意 $j \\in \\{1, \\dots, M-1\\}$，间距为：\n$$ x_{j+1} - x_j = \\left[a(1+\\epsilon_c)\\left(j+1 - \\frac{M+1}{2}\\right) + X_c + U_c\\right] - \\left[a(1+\\epsilon_c)\\left(j - \\frac{M+1}{2}\\right) + X_c + U_c\\right] = a(1+\\epsilon_c) $$\n注意，$X_c$ 和 $U_c$ 项相互抵消。间距与 $U_c$ 无关。\n对于周期性键，间距为 $|x_1 + \\ell - x_M|$。当 $\\ell = Ma(1+\\epsilon_c)$ 时，此间距为：\n$$ x_1 + \\ell - x_M = \\left[a(1+\\epsilon_c)\\left(1 - \\frac{M+1}{2}\\right) + X_c + U_c\\right] + Ma(1+\\epsilon_c) - \\left[a(1+\\epsilon_c)\\left(M - \\frac{M+1}{2}\\right) + X_c + U_c\\right] $$\n$X_c$ 和 $U_c$ 项再次抵消。间距简化为：\n$$ a(1+\\epsilon_c)\\left[1 - \\frac{M+1}{2} + M - \\left(M - \\frac{M+1}{2}\\right)\\right] = a(1+\\epsilon_c) $$\n由于 RVE 中所有 $M$ 个近邻间距都相同且等于 $r_c = a(1+\\epsilon_c)$，提升构型的总能量为：\n$$ E(\\mathcal{L}(\\epsilon_c, U_c)) = \\sum_{j=1}^{M} \\phi(a(1+\\epsilon_c)) = M \\phi(a(1+\\epsilon_c)) $$\n这个总能量的表达式依赖于粗糙应变 $\\epsilon_c$，但显然与粗糙位移 $U_c$ 无关。这是势能的平移不变性以及提升算子构建的直接结果，后者通过使 $U_c$ 仅对原子系统贡献刚体平移来正确实现这种不变性。\n伪力是此能量相对于 $U_c$ 的导数：\n$$ g_c = -\\frac{\\partial}{\\partial U_c} \\left[ M \\phi(a(1+\\epsilon_c)) \\right] $$\n由于导数内的表达式不包含 $U_c$，所以导数为零。\n$$ g_c = 0 $$\n伪力为 $0$ 牛顿。这个结果，在HMM中通常称为元检验，证实了微观和宏观尺度之间的耦合是一致的，并且在表示均匀变形状态时不会引入虚假力。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在实际应用 HMM 时，为每个宏观点实时求解微观问题通常计算成本过高。一个高效的策略是预先计算一系列宏观状态下的微观响应，并将其存储在缓存中。本练习将模拟这一过程，要求你基于一个给定的热弹性响应缓存数据，设计一个在物理上自洽的插值方案。这个方案必须保留亥姆霍兹自由能的凸性和应力-应变关系的单调性，这对于保证模型的稳定性和热力学一致性至关重要。",
            "id": "3508914",
            "problem": "考虑一个一维热弹性异质多尺度方法 (HMM) 耦合问题，其中一个宏观杆遵循小应变运动学，宏观应变表示为 $e \\in \\mathbb{R}$ (无量纲)，温度表示为 $T \\in \\mathbb{R}$ (开尔文)，宏观柯西应力表示为 $\\sigma(e,T)$ (兆帕, MPa)。在 HMM 中，微单元计算通过在宏观运动学约束下最小化微观场上的亥姆霍兹自由能密度 $\\psi(e,T)$ 来提供等效本构响应，而宏观应力是在固定温度下等效自由能对应变的导数，即 $\\sigma(e,T) = \\partial \\psi(e,T)/\\partial e$。\n\n您将获得以下从平衡后的微单元边值问题中得到的、在两种温度和三个应变水平下的微观解析应力值缓存数据：\n- 在 $T_0 = 300$ 开尔文时：\n  - $\\sigma(0,300) = -30$ MPa，\n  - $\\sigma(0.01,300) = 120$ MPa，\n  - $\\sigma(0.02,300) = 280$ MPa。\n- 在 $T_1 = 400$ 开尔文时：\n  - $\\sigma(0,400) = -50$ MPa，\n  - $\\sigma(0.01,400) = 100$ MPa，\n  - $\\sigma(0.02,400) = 250$ MPa。\n\n从等效亥姆霍兹自由能 $\\psi(e,T)$ 对于每个固定的 $T$ 都是 $e$ 的凸函数，且 $\\sigma(e,T) = \\partial \\psi(e,T)/\\partial e$ 这一热力学结构出发，设计一个基于给定缓存数据的严格由数据驱动的插值方案，该方案需满足：\n1. 对于每个固定的 $T \\in \\{T_0,T_1\\}$，生成的关于 $e$ 的插值函数与 $\\sigma(e,T)$ 是一个关于 $e$ 的凸函数的导数这一性质相容（从而使得得到的 $\\sigma(e,T)$ 是关于 $e$ 的单调不减函数）。\n2. 对于中间温度 $T \\in (T_0,T_1)$，生成的插值函数保持关于 $e$ 的凸性，并遵循在缓存应变点观测到的 $\\sigma(e,T)$ 关于温度的单调性。\n\n然后，使用您的方案，计算在查询点 $e^\\star = 0.015$ 和 $T^\\star = 350$ 开尔文处的插值宏观应力 $\\sigma(e^\\star,T^\\star)$。以 MPa 为单位表示最终应力，并将答案四舍五入到四位有效数字。不要假设任何参数化的本构定律；仅使用上述缓存数据和热力学结构。",
            "solution": "我们从支撑热弹性异质多尺度方法 (HMM) 的热力学和变分结构开始。微单元计算提供了一个作为宏观应变 $e$ 和温度 $T$ 的函数的等效亥姆霍兹自由能 $\\psi(e,T)$，而宏观柯西应力由热力学共轭关系给出\n$$\n\\sigma(e,T) = \\frac{\\partial \\psi(e,T)}{\\partial e}\\Big|_{T}.\n$$\n对于固定的 $T$，假设 $\\psi(\\cdot,T)$ 是关于 $e$ 的凸函数，那么它的导数 $\\sigma(\\cdot,T)$ 必须是关于 $e$ 的单调不减函数。我们的插值方案必须明确地遵循这一结构。\n\n步骤1：在固定温度下对应变进行插值。对于每个固定的 $T \\in \\{T_0,T_1\\}$，我们构建一个分段线性插值函数 $\\sigma_T(e)$，它连接数据点 $(e_i,\\sigma(e_i,T))$，其中 $e_0=0$, $e_1=0.01$, $e_2=0.02$。各段的斜率为\n$$\nm_{i}(T) = \\frac{\\sigma(e_{i+1},T) - \\sigma(e_i,T)}{e_{i+1}-e_i}, \\quad i=0,1.\n$$\n根据缓存数据：\n- 在 $T_0=300$ 时：\n  $$\n  m_0(T_0) = \\frac{120 - (-30)}{0.01 - 0} = \\frac{150}{0.01} = 15000 \\ \\text{MPa}, \\quad\n  m_1(T_0) = \\frac{280 - 120}{0.02 - 0.01} = \\frac{160}{0.01} = 16000 \\ \\text{MPa}.\n  $$\n- 在 $T_1=400$ 时：\n  $$\n  m_0(T_1) = \\frac{100 - (-50)}{0.01 - 0} = \\frac{150}{0.01} = 15000 \\ \\text{MPa}, \\quad\n  m_1(T_1) = \\frac{250 - 100}{0.02 - 0.01} = \\frac{150}{0.01} = 15000 \\ \\text{MPa}.\n  $$\n在每个固定的 $T$ 下，这些斜率随 $i$ 单调不减（在 $T_0$ 时 $15000 \\le 16000$；在 $T_1$ 时 $15000 = 15000$）。因此，分段线性的应力 $\\sigma_T(e)$ 是关于 $e$ 单调不减的。由于一维的单调不减函数是一个凸函数的导数，我们可以通过积分定义一个凸势函数 $\\psi_T(e)$：\n$$\n\\psi_T(e) = \\int_{0}^{e} \\sigma_T(s)\\, ds + \\psi_T(0),\n$$\n其中 $\\psi_T(0)$ 可任意选择（它不影响 $\\sigma_T$）。因为 $\\sigma_T$ 是分段线性和单调的，所以 $\\psi_T$ 是分段二次和凸的。\n\n步骤2：对温度进行插值。对于 $T \\in (T_0,T_1)$，我们对自由能进行线性温度插值：\n$$\n\\psi(e,T) = \\lambda(T)\\, \\psi_{T_0}(e) + \\big(1-\\lambda(T)\\big)\\, \\psi_{T_1}(e),\n$$\n其中\n$$\n\\lambda(T) = \\frac{T_1 - T}{T_1 - T_0}.\n$$\n凸函数的线性插值保持凸性，所以 $\\psi(\\cdot,T)$ 是关于 $e$ 的凸函数。在固定 $T$ 下对应变 $e$ 求导，得到应力插值函数\n$$\n\\sigma(e,T) = \\frac{\\partial \\psi(e,T)}{\\partial e} = \\lambda(T)\\, \\sigma_{T_0}(e) + \\big(1-\\lambda(T)\\big)\\, \\sigma_{T_1}(e).\n$$\n这是一个关于 $e$ 的单调不减函数的凸组合，因此它本身也是关于 $e$ 单调不减的。此外，由于在固定的 $e$ 下，缓存的应力值是关于 $T$ 单调的（对于每个 $e \\in \\{0,0.01,0.02\\}$，应力随 $T$ 升高而减小），因此在区间 $[T_0,T_1]$ 内，关于 $T$ 的线性插值保持了这种单调性。\n\n步骤3：计算在查询点 $(e^\\star,T^\\star) = (0.015,350)$ 处的插值应力。首先计算温度权重\n$$\n\\lambda(T^\\star) = \\frac{T_1 - T^\\star}{T_1 - T_0} = \\frac{400 - 350}{400 - 300} = \\frac{50}{100} = 0.5.\n$$\n接下来，在 $e^\\star$ 处计算分段线性应变插值函数的值。由于 $e^\\star \\in [e_1,e_2] = [0.01,0.02]$，我们使用该段的公式：\n- 在 $T_0=300$ 时：\n  $$\n  \\sigma_{T_0}(e^\\star) = \\sigma(0.01,300) + m_1(T_0)\\, (e^\\star - 0.01) = 120 + 16000 \\times (0.015 - 0.01).\n  $$\n  计算增量：\n  $$\n  16000 \\times 0.005 = 80,\n  $$\n  因此\n  $$\n  \\sigma_{T_0}(e^\\star) = 120 + 80 = 200.\n  $$\n- 在 $T_1=400$ 时：\n  $$\n  \\sigma_{T_1}(e^\\star) = \\sigma(0.01,400) + m_1(T_1)\\, (e^\\star - 0.01) = 100 + 15000 \\times (0.015 - 0.01).\n  $$\n  计算增量：\n  $$\n  15000 \\times 0.005 = 75,\n  $$\n  因此\n  $$\n  \\sigma_{T_1}(e^\\star) = 100 + 75 = 175.\n  $$\n最后，对温度进行组合：\n$$\n\\sigma(e^\\star,T^\\star) = \\lambda(T^\\star)\\, \\sigma_{T_0}(e^\\star) + \\big(1-\\lambda(T^\\star)\\big)\\, \\sigma_{T_1}(e^\\star) = 0.5 \\times 200 + 0.5 \\times 175 = \\frac{200 + 175}{2} = 187.5.\n$$\n因此，在 $e^\\star=0.015$ 和 $T^\\star=350$ 开尔文处的插值宏观应力为 $187.5$ MPa。以 MPa 为单位表示并四舍五入到四位有效数字，该值为 $187.5$ MPa（已是四位有效数字）。",
            "answer": "$$\\boxed{187.5}$$"
        }
    ]
}