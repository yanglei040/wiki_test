{
    "hands_on_practices": [
        {
            "introduction": "多尺度建模的一个基本挑战是如何从离散的原子相互作用中推导出连续介质力学本构关系。柯西-玻恩定则（Cauchy-Born rule）为这一挑战提供了理论基石，它假设晶格的宏观均匀变形直接对应于原子尺度的仿射变换。通过本练习，您将从一个简谐对势（harmonic pair potential）出发，利用柯西-玻恩定则推导出一个二维晶体的连续介质应变能密度和第一皮奥拉-基尔霍夫（Piola-Kirchhoff）应力，从而亲身体验微观作用如何决定宏观材料响应 。",
            "id": "3496677",
            "problem": "考虑一个二维晶体固体，其原胞中含单个原子，排列成三角形布拉维晶格（六重旋转对称性）。设参考构型中的六个最近邻键矢量表示为 $\\{\\mathbf{R}_b\\}_{b=1}^{6}$，每个键的长度为 $a_0$，其中 $\\mathbf{R}_b = a_0 \\mathbf{d}_b$，$\\mathbf{d}_b$ 是单位矢量，均匀分布在 $0$, $\\pi/3$, $2\\pi/3$, $\\pi$, $4\\pi/3$ 和 $5\\pi/3$ 的角度上。每个晶格点的面积为 $A_0 = \\sqrt{3} a_0^2/2$。假设原子间相互作用是中心力的，并由最近邻对势 $\\phi(r)$ 给出，其谐波形式为 $\\phi(r) = \\tfrac{1}{2} k (r - a_0)^2$，其中 $k$ 是一个正常数刚度参数，$r$ 是键长。物体经历由变形梯度 $\\mathbf{F}$ 表征的均匀变形，且柯西-玻恩假设成立，因此每个键 $\\mathbf{R}_b$ 映射为 $\\mathbf{F}\\mathbf{R}_b$，连续介质应变能密度 $W(\\mathbf{F})$ 由原子势导出。\n\n你的任务是：\n1. 从对势和柯西-玻恩假设出发，推导单位面积的连续介质应变能密度 $W(\\mathbf{F})$，注意仔细处理对的重复计数问题，并仅使用最近邻键。\n2. 通过对能量密度关于 $\\mathbf{F}$ 求导，推导第一皮奥拉-基尔霍夫应力 $\\mathbf{P} = \\partial W(\\mathbf{F})/\\partial \\mathbf{F}$。\n3. 利用三角晶格的对称性，解释对于中心力和高度对称的邻居集，$W(\\mathbf{F})$ 的依赖关系如何简化为右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^{\\top}\\mathbf{F}$ 的不变量的函数。\n4. 将你的表达式应用于各向同性拉伸 $\\mathbf{F} = \\lambda \\mathbf{I}$ 的情况，其中标量拉伸 $\\lambda > 0$。证明第一皮奥拉-基尔霍夫应力与单位矩阵成正比，即 $\\mathbf{P} = \\alpha(\\lambda)\\mathbf{I}$，并确定标量系数 $\\alpha(\\lambda)$ 为一个关于 $k$ 和 $\\lambda$ 的封闭形式解析表达式。\n\n将 $\\alpha(\\lambda)$ 的单一符号表达式作为你的最终答案。不需要进行数值代入，最终表达式中不应包含单位。",
            "solution": "该问题陈述经评估具有科学依据、问题明确、客观且自洽。所提供的数据和条件一致且足以得出一个唯一解。该问题是将柯西-玻恩法则应用于晶格的标准练习，并且可以进行完整求解。\n\n根据问题陈述的要求，解答分为四个部分呈现。\n\n**1. 连续介质应变能密度 $W(\\mathbf{F})$ 的推导**\n\n应变能密度 $W$ 是参考构型下单位面积的总势能。势能储存在原子间的键中。对于晶格点上的单个原子，其与最近邻的相互作用能是连接到它的所有键的势能之和。由于每个键由两个原子共享，我们将从一个参考原子发出的所有键的能量相加，然后除以2，得到每个原子的能量。\n\n单个键的势能由谐波势 $\\phi(r) = \\frac{1}{2} k (r - a_0)^2$ 给出，其中 $r$ 是变形构型中键的长度。根据柯西-玻恩假设，参考键矢量 $\\mathbf{R}_b$ 变形为 $\\mathbf{r}_b = \\mathbf{F}\\mathbf{R}_b$。变形后键的长度为 $r_b = \\|\\mathbf{r}_b\\| = \\|\\mathbf{F}\\mathbf{R}_b\\|$。\n\n因此，每个原子的总能量 $E_{\\text{atom}}$ 为：\n$$\nE_{\\text{atom}} = \\frac{1}{2} \\sum_{b=1}^{6} \\phi(\\|\\mathbf{F}\\mathbf{R}_b\\|) = \\frac{1}{2} \\sum_{b=1}^{6} \\left[ \\frac{1}{2} k \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2 \\right] = \\frac{1}{4} k \\sum_{b=1}^{6} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2\n$$\n应变能密度 $W(\\mathbf{F})$ 是这个能量除以参考构型中原胞的面积 $A_0 = \\frac{\\sqrt{3}}{2} a_0^2$。\n$$\nW(\\mathbf{F}) = \\frac{E_{\\text{atom}}}{A_0} = \\frac{\\frac{1}{4} k \\sum_{b=1}^{6} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2}{\\frac{\\sqrt{3}}{2} a_0^2} = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2\n$$\n我们可以用右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^{\\top}\\mathbf{F}$ 来表示变形后键的长度。\n$$\n\\|\\mathbf{F}\\mathbf{R}_b\\|^2 = (\\mathbf{F}\\mathbf{R}_b) \\cdot (\\mathbf{F}\\mathbf{R}_b) = \\mathbf{R}_b^{\\top} \\mathbf{F}^{\\top} \\mathbf{F} \\mathbf{R}_b = \\mathbf{R}_b^{\\top} \\mathbf{C} \\mathbf{R}_b\n$$\n代入 $\\mathbf{R}_b = a_0 \\mathbf{d}_b$，其中 $\\mathbf{d}_b$ 是单位矢量：\n$$\n\\|\\mathbf{F}\\mathbf{R}_b\\| = \\sqrt{(a_0 \\mathbf{d}_b)^{\\top} \\mathbf{C} (a_0 \\mathbf{d}_b)} = a_0 \\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{C} \\mathbf{d}_b}\n$$\n现在应变能密度可以写为：\n$$\nW(\\mathbf{F}) = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(a_0 \\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{C} \\mathbf{d}_b} - a_0\\right)^2 = \\frac{k a_0^2}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(\\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{C} \\mathbf{d}_b} - 1\\right)^2\n$$\n$$\nW(\\mathbf{F}) = \\frac{k}{2\\sqrt{3}} \\sum_{b=1}^{6} \\left(\\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{F}^{\\top}\\mathbf{F} \\mathbf{d}_b} - 1\\right)^2\n$$\n这就是连续介质应变能密度的最终表达式。\n\n**2. 第一皮奥拉-基尔霍夫应力 $\\mathbf{P}$ 的推导**\n\n第一皮奥拉-基尔霍夫应力张量 $\\mathbf{P}$ 是应变能密度 $W$ 关于变形梯度 $\\mathbf{F}$ 的导数，即 $P_{ij} = \\frac{\\partial W}{\\partial F_{ij}}$。我们可以使用链式法则来推导。连续介质力学中的一个标准结果将 $\\mathbf{P}$ 与 $W$ 对 $\\mathbf{C}$ 的导数联系起来：$\\mathbf{P} = \\mathbf{F} \\frac{\\partial W}{\\partial \\mathbf{C}_{sym}}$，其中对于对称张量 $\\mathbf{C}$，有 $\\frac{\\partial W}{\\partial \\mathbf{C}_{sym}} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}}$。或者，我们可以直接对 $W(\\mathbf{F})$ 求导。\n$$\n\\frac{\\partial W}{\\partial \\mathbf{F}} = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\frac{\\partial}{\\partial \\mathbf{F}} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2\n$$\n平方项的导数是：\n$$\n\\frac{\\partial}{\\partial \\mathbf{F}} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2 = 2\\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right) \\frac{\\partial \\|\\mathbf{F}\\mathbf{R}_b\\|}{\\partial \\mathbf{F}}\n$$\n使用恒等式 $\\frac{\\partial \\|\\mathbf{x}\\|}{\\partial \\mathbf{x}} = \\frac{\\mathbf{x}^{\\top}}{\\|\\mathbf{x}\\|}$ 和链式法则，我们有 $\\frac{\\partial \\|\\mathbf{F}\\mathbf{R}_b\\|}{\\partial \\mathbf{F}} = \\frac{(\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b}{\\|\\mathbf{F}\\mathbf{R}_b\\|}$。用指标记法表示，这是 $\\frac{F_{ik}R_{bk} R_{bj}}{\\|\\mathbf{F}\\mathbf{R}_b\\|}$。\n所以，\n$$\n\\mathbf{P} = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} 2\\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right) \\frac{(\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b}{\\|\\mathbf{F}\\mathbf{R}_b\\|}\n$$\n$$\n\\mathbf{P} = \\frac{k}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(1 - \\frac{a_0}{\\|\\mathbf{F}\\mathbf{R}_b\\|}\\right) ((\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b)\n$$\n其中 $(\\mathbf{u} \\otimes \\mathbf{v})$ 表示张量积，是一个分量为 $(u_i v_j)$ 的矩阵。\n\n**3. 由晶格对称性引起的 $W(\\mathbf{F})$ 的简化**\n\n应变能密度 $W$ 的依赖关系因两个主要原则而简化：材料客观性和材料对称性。\n\n首先，材料客观性（或框架无关性）要求能量函数在变形构型的刚体旋转下保持不变。如果我们对变形状态施加一个旋转 $\\mathbf{Q}$（满足 $\\mathbf{Q}^{\\top}\\mathbf{Q}=\\mathbf{I}$），新的变形梯度为 $\\mathbf{F}' = \\mathbf{Q}\\mathbf{F}$。能量必须满足 $W(\\mathbf{Q}\\mathbf{F}) = W(\\mathbf{F})$。从我们对 $W$ 的表达式中，我们观察到它仅通过 $\\mathbf{F}^{\\top}\\mathbf{F} = \\mathbf{C}$ 这一项依赖于 $\\mathbf{F}$。由于 $(\\mathbf{Q}\\mathbf{F})^{\\top}(\\mathbf{Q}\\mathbf{F}) = \\mathbf{F}^{\\top}\\mathbf{Q}^{\\top}\\mathbf{Q}\\mathbf{F} = \\mathbf{F}^{\\top}\\mathbf{F} = \\mathbf{C}$，我们推导出的 $W$ 是客观的，并且可以仅写为 $\\mathbf{C}$ 的函数，即 $W(\\mathbf{F}) = \\hat{W}(\\mathbf{C})$。\n\n其次，材料对称性要求能量函数在参考晶格的对称操作下保持不变。三角晶格具有六重旋转对称性（一个 $D_6$ 点群）。设 $\\mathbf{S}$ 为该群中的一个对称操作。对参考构型施加 $\\mathbf{S}$ 会将最近邻矢量集 $\\{\\mathbf{R}_b\\}$ 变换为其自身。材料对称性要求是 $\\hat{W}(\\mathbf{C}) = \\hat{W}(\\mathbf{S}^{\\top}\\mathbf{C}\\mathbf{S})$。$W$ 表达式中的求和是针对矢量集 $\\{\\mathbf{d}_b\\}$ 的。一个对称操作 $\\mathbf{S}$ 会置换这个集合，即对于某个 $b'$，有 $\\mathbf{S}\\mathbf{d}_b = \\mathbf{d}_{b'}$。因此，求和保持不变：\n$$\n\\sum_{b=1}^{6} \\left(\\sqrt{\\mathbf{d}_b^{\\top} (\\mathbf{S}^{\\top}\\mathbf{C}\\mathbf{S}) \\mathbf{d}_b} - 1\\right)^2 = \\sum_{b=1}^{6} \\left(\\sqrt{(\\mathbf{S}\\mathbf{d}_b)^{\\top} \\mathbf{C} (\\mathbf{S}\\mathbf{d}_b)} - 1\\right)^2 = \\sum_{b'=1}^{6} \\left(\\sqrt{\\mathbf{d}_{b'}^{\\top} \\mathbf{C} \\mathbf{d}_{b'}} - 1\\right)^2\n$$\n对于三角晶格的对称群，满足此条件的函数 $\\hat{W}(\\mathbf{C})$ 是一个各向同性张量函数。对于一个二维对称张量 $\\mathbf{C}$，任何关于 $\\mathbf{C}$ 的各向同性标量函数都可以表示为其两个主不变量 $I_1 = \\mathrm{tr}(\\mathbf{C})$ 和 $I_2 = \\det(\\mathbf{C})$ 的函数。因此，晶格的高度对称性，结合中心力的性质，将应变能简化为 $W(\\mathbf{F}) = f(I_1, I_2)$。\n\n**4. 应用于各向同性拉伸 $\\mathbf{F} = \\lambda \\mathbf{I}$ 的情况**\n\n对于各向同性拉伸，变形梯度为 $\\mathbf{F} = \\lambda\\mathbf{I}$，其中 $\\lambda > 0$ 是一个标量，$\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。我们将此代入PK1应力 $\\mathbf{P}$ 的表达式中。\n\n首先，注意到 $\\mathbf{F}\\mathbf{R}_b = (\\lambda\\mathbf{I})\\mathbf{R}_b = \\lambda\\mathbf{R}_b$。\n其范数为 $\\|\\mathbf{F}\\mathbf{R}_b\\| = \\|\\lambda\\mathbf{R}_b\\| = \\lambda\\|\\mathbf{R}_b\\| = \\lambda a_0$。\n项 $(\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b$ 变为 $(\\lambda\\mathbf{R}_b) \\otimes \\mathbf{R}_b = \\lambda(\\mathbf{R}_b \\otimes \\mathbf{R}_b)$。\n\n将这些代入 $\\mathbf{P}$ 的表达式中：\n$$\n\\mathbf{P} = \\frac{k}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(1 - \\frac{a_0}{\\lambda a_0}\\right) \\lambda(\\mathbf{R}_b \\otimes \\mathbf{R}_b) = \\frac{k}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(1 - \\frac{1}{\\lambda}\\right) \\lambda(\\mathbf{R}_b \\otimes \\mathbf{R}_b)\n$$\n标量项 $\\lambda(1 - 1/\\lambda) = \\lambda - 1$ 可以从求和中提取出来：\n$$\n\\mathbf{P} = \\frac{k(\\lambda - 1)}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} (\\mathbf{R}_b \\otimes \\mathbf{R}_b)\n$$\n求和是关于最近邻矢量的张量积。我们来计算这个和：$\\sum_{b=1}^{6} (\\mathbf{R}_b \\otimes \\mathbf{R}_b) = a_0^2 \\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b)$。\n单位矢量为 $\\mathbf{d}_b = (\\cos((b-1)\\pi/3), \\sin((b-1)\\pi/3))$。由于六重对称性，这个和必须是一个各向同性张量，即与单位矩阵 $\\mathbf{I}$ 成正比。设 $\\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b) = c\\mathbf{I}$。我们通过取迹来找到常数 $c$：\n$$\n\\mathrm{tr}(c\\mathbf{I}) = \\mathrm{tr}\\left(\\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b)\\right) = \\sum_{b=1}^{6} \\mathrm{tr}(\\mathbf{d}_b \\otimes \\mathbf{d}_b) = \\sum_{b=1}^{6} (\\mathbf{d}_b \\cdot \\mathbf{d}_b) = \\sum_{b=1}^{6} \\|\\mathbf{d}_b\\|^2 = \\sum_{b=1}^{6} 1 = 6\n$$\n由于在二维空间中 $\\mathrm{tr}(\\mathbf{I}) = 2$，我们有 $2c = 6$，得出 $c=3$。\n因此，$\\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b) = 3\\mathbf{I}$，且 $\\sum_{b=1}^{6} (\\mathbf{R}_b \\otimes \\mathbf{R}_b) = 3 a_0^2 \\mathbf{I}$。\n\n将此结果代回 $\\mathbf{P}$ 的表达式中：\n$$\n\\mathbf{P} = \\frac{k(\\lambda - 1)}{\\sqrt{3} a_0^2} (3 a_0^2 \\mathbf{I}) = \\frac{3k}{\\sqrt{3}}(\\lambda - 1) \\mathbf{I} = \\sqrt{3} k (\\lambda - 1) \\mathbf{I}\n$$\n这表明 $\\mathbf{P}$ 确实具有 $\\mathbf{P} = \\alpha(\\lambda)\\mathbf{I}$ 的形式，其标量系数由下式给出：\n$$\n\\alpha(\\lambda) = \\sqrt{3} k (\\lambda - 1)\n$$\n这就是所要求的封闭形式解析表达式。",
            "answer": "$$\\boxed{\\sqrt{3}k(\\lambda - 1)}$$"
        },
        {
            "introduction": "在建立原子-连续介质耦合模型后，下一个关键步骤是精确定义两个区域间的力传递机制。Irving–Kirkwood/Hardy 方法提供了一个从离散原子数据（位置、速度和力）出发，计算连续介质应力张量的严谨框架。本练习要求您通过一个高斯核函数实现该方法，计算作用在有限元界面上的牵引力矢量，这包括动能和势能两部分的贡献。这个实践将帮助您掌握力耦合或能量耦合方法的核心技术，即将原子区域的作用精确地传递给连续介质区域 。",
            "id": "3496654",
            "problem": "要求您使用 Irving–Kirkwood/Hardy 程序，在平面原子-连续介质界面上实现一个连续介质牵引力评估器。考虑在与有限元方法 (FEM) 离散化的平面界面相邻的重叠区域内，有一组原子，其位置为 $\\{ \\boldsymbol{x}_i \\in \\mathbb{R}^3 \\}$，速度为 $\\{ \\boldsymbol{v}_i \\in \\mathbb{R}^3 \\}$，质量为 $\\{ m_i \\in \\mathbb{R}_{+} \\}$。成对相互作用由一个对列表 $\\{ (i,j,\\boldsymbol{f}_{ij}) \\}$ 表示，其中 $\\boldsymbol{f}_{ij}$ 是原子 $j$ 对原子 $i$ 的作用力，并遵循牛顿第三定律 $\\boldsymbol{f}_{ji} = -\\boldsymbol{f}_{ij}$。设分子动力学 (MD) 到有限元方法 (FEM) 的界面为一个平面，该平面由通过参考点 $\\boldsymbol{y}_0 \\in \\mathbb{R}^3$ 的单位法向量 $\\boldsymbol{n} \\in \\mathbb{R}^3$ 定义。\n\n采用带有高斯核的 Irving–Kirkwood/Hardy 粗粒化方法。核函数定义为\n$$\n\\phi(\\boldsymbol{r}) = \\frac{1}{\\big(2\\pi\\sigma^2\\big)^{3/2}} \\exp\\!\\left( -\\frac{\\lVert \\boldsymbol{r} \\rVert^2}{2\\sigma^2} \\right),\n$$\n其中 $\\sigma \\in \\mathbb{R}_{+}$ 是核宽度。在 $\\boldsymbol{y}_0$ 处的粗粒化速度为\n$$\n\\boldsymbol{u}(\\boldsymbol{y}_0) = \\frac{\\sum_i m_i \\boldsymbol{v}_i \\, \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i)}{\\sum_i m_i \\, \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i)},\n$$\n约定如果分母为零，则 $\\boldsymbol{u}(\\boldsymbol{y}_0) = \\boldsymbol{0}$。在 $\\boldsymbol{y}_0$ 处的 Hardy 应力是动能部分和势能（相互作用）部分之和。动能部分使用原子本征速度 $\\boldsymbol{w}_i(\\boldsymbol{y}_0) = \\boldsymbol{v}_i - \\boldsymbol{u}(\\boldsymbol{y}_0)$，由下式给出\n$$\n\\boldsymbol{\\sigma}^{\\text{kin}}(\\boldsymbol{y}_0) = - \\sum_i m_i \\, \\boldsymbol{w}_i(\\boldsymbol{y}_0) \\otimes \\boldsymbol{w}_i(\\boldsymbol{y}_0) \\, \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i).\n$$\n势能部分使用成对力以及键函数\n$$\nB_{ij}(\\boldsymbol{y}_0) = \\int_0^1 \\phi\\!\\big(\\boldsymbol{y}_0 - \\boldsymbol{x}_i - s(\\boldsymbol{x}_j - \\boldsymbol{x}_i)\\big) \\, ds,\n$$\n由下式给出\n$$\n\\boldsymbol{\\sigma}^{\\text{pot}}(\\boldsymbol{y}_0) = - \\frac{1}{2} \\sum_{(i,j)} \\big(\\boldsymbol{x}_j - \\boldsymbol{x}_i\\big) \\otimes \\boldsymbol{f}_{ij} \\, B_{ij}(\\boldsymbol{y}_0),\n$$\n其中求和遍历所有 $i < j$ 的无序对。\n\n在 $\\boldsymbol{y}_0$ 处传递到 FEM 界面（单位法向量为 $\\boldsymbol{n}$）的牵引力向量为\n$$\n\\boldsymbol{t}(\\boldsymbol{y}_0) = \\boldsymbol{\\sigma}(\\boldsymbol{y}_0)\\, \\boldsymbol{n},\n$$\n其中 $\\boldsymbol{\\sigma}(\\boldsymbol{y}_0) = \\boldsymbol{\\sigma}^{\\text{kin}}(\\boldsymbol{y}_0) + \\boldsymbol{\\sigma}^{\\text{pot}}(\\boldsymbol{y}_0)$。\n\n仅从上述基本定义出发，推导一个数值稳定且高效的算法，用以计算高斯核下的 $\\boldsymbol{t}(\\boldsymbol{y}_0)$。您的算法必须是自包含的，能处理 $\\boldsymbol{u}(\\boldsymbol{y}_0)$ 的零密度极限，并能精确计算键函数 $B_{ij}(\\boldsymbol{y}_0)$。您可以使用解析计算来处理高斯键积分，或使用数值收敛的求积方案；请确保对极限情况 $\\lVert \\boldsymbol{x}_j - \\boldsymbol{x}_i \\rVert \\to 0$ 进行一致性处理。\n\n在整个计算过程中使用无量纲单位。将每个牵引力向量分量报告为实数（浮点数）。计算不涉及角度，因此无需指定角度单位。\n\n实现一个程序，为以下每个测试用例计算牵引力向量。对于所有测试用例，除非另有说明，界面点为 $\\boldsymbol{y}_0 = (0,0,0)$，最终输出必须是牵引力向量的列表，每个向量表示为包含三个浮点数的列表。将每个分量四舍五入到恰好 $6$ 位小数。要求的最终输出格式为单行，包含一个列表，其中按顺序包含所有测试用例的结果，例如 $[\\![\\dots], [\\dots], \\dots]$；使用标准的 Python 列表格式（嵌套列表），除典型列表格式外没有额外的空白字符约束。\n\n测试套件：\n\n- 测试 A (仅势能，法向对齐)：\n  - $\\sigma = 0.2$, $\\boldsymbol{n} = (0,0,1)$。\n  - 原子：两个原子\n    - $\\boldsymbol{x}_0 = (0,0,0.25)$，$\\boldsymbol{v}_0 = (0,0,0)$，$m_0 = 1$。\n    - $\\boldsymbol{x}_1 = (0,0,-0.25)$，$\\boldsymbol{v}_1 = (0,0,0)$，$m_1 = 1$。\n  - 对：一对 $(0,1,\\boldsymbol{f}_{01})$，其中 $\\boldsymbol{f}_{01} = (0,0,-2.0)$。\n\n- 测试 B (仅势能，切向对产生零牵引力)：\n  - $\\sigma = 0.2$, $\\boldsymbol{n} = (0,0,1)$。\n  - 原子：\n    - $\\boldsymbol{x}_0 = (0.25,0,0)$，$\\boldsymbol{v}_0 = (0,0,0)$，$m_0 = 1$。\n    - $\\boldsymbol{x}_1 = (-0.25,0,0)$，$\\boldsymbol{v}_1 = (0,0,0)$，$m_1 = 1$。\n  - 对：一对 $(0,1,\\boldsymbol{f}_{01})$，其中 $\\boldsymbol{f}_{01} = (2.0,0,0)$。\n\n- 测试 C (仅动能，沿法向对称相反速度)：\n  - $\\sigma = 0.3$, $\\boldsymbol{n} = (0,0,1)$。\n  - 原子：\n    - $\\boldsymbol{x}_0 = (0,0,0.2)$，$\\boldsymbol{v}_0 = (0,0,1.0)$，$m_0 = 1$。\n    - $\\boldsymbol{x}_1 = (0,0,-0.2)$，$\\boldsymbol{v}_1 = (0,0,-1.0)$，$m_1 = 1$。\n  - 对：无。\n\n- 测试 D (空重叠区域)：\n  - $\\sigma = 0.4$, $\\boldsymbol{n} = (0,0,1)$。\n  - 原子：无。\n  - 对：无。\n\n- 测试 E (动能和势能混合，旋转法向)：\n  - $\\sigma = 0.25$, $\\boldsymbol{n} = \\frac{1}{\\sqrt{3}}(1,1,1)$，$\\boldsymbol{y}_0 = (0,0,0)$。\n  - 原子：\n    - $\\boldsymbol{x}_0 = (0.2,0.0,0.0)$，$\\boldsymbol{v}_0 = (0.5,-0.2,0.1)$，$m_0 = 1$。\n    - $\\boldsymbol{x}_1 = (0.0,0.2,0.0)$，$\\boldsymbol{v}_1 = (-0.1,0.4,-0.3)$，$m_1 = 1$。\n    - $\\boldsymbol{x}_2 = (0.0,0.0,0.2)$，$\\boldsymbol{v}_2 = (0.0,-0.3,0.6)$，$m_2 = 1$。\n  - 对：两对\n    - $(0,1,\\boldsymbol{f}_{01})$，其中 $\\boldsymbol{f}_{01} = \\left(-\\frac{1.5}{\\sqrt{2}}, \\frac{1.5}{\\sqrt{2}}, 0\\right)$，\n    - $(1,2,\\boldsymbol{f}_{12})$，其中 $\\boldsymbol{f}_{12} = \\left(0, -\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right)$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表，该列表包含在方括号内的结果，每个条目是按测试顺序排列的含三个浮点数的列表，例如：$[[a_1,a_2,a_3],[b_1,b_2,b_3],\\dots]$。所有计算都是无量纲的；无需物理单位。在打印前，将每个分量四舍五入到恰好 $6$ 位小数。",
            "solution": "该问题要求实现一个算法，用以计算在参考点 $\\boldsymbol{y}_0$ 处、单位法向量为 $\\boldsymbol{n}$ 的平面界面上的连续介质牵引力向量 $\\boldsymbol{t}(\\boldsymbol{y}_0)$。该计算基于 Irving–Kirkwood/Hardy 粗粒化程序，适用于一组由其位置 $\\{ \\boldsymbol{x}_i \\}$、速度 $\\{ \\boldsymbol{v}_i \\}$ 和质量 $\\{ m_i \\}$ 描述的原子。相互作用力以对 $\\{ (i,j,\\boldsymbol{f}_{ij}) \\}$ 的形式给出。\n\n牵引力向量定义为 $\\boldsymbol{t}(\\boldsymbol{y}_0) = \\boldsymbol{\\sigma}(\\boldsymbol{y}_0)\\boldsymbol{n}$，其中 $\\boldsymbol{\\sigma}(\\boldsymbol{y}_0)$ 是 Hardy 应力张量。该应力张量由动能部分 $\\boldsymbol{\\sigma}^{\\text{kin}}(\\boldsymbol{y}_0)$ 和势能部分 $\\boldsymbol{\\sigma}^{\\text{pot}}(\\boldsymbol{y}_0)$ 组成。\n\n算法流程如下：\n\n1.  **高斯核函数计算**：粗粒化程序的基础是高斯核函数，\n    $$ \\phi(\\boldsymbol{r}) = \\frac{1}{\\big(2\\pi\\sigma^2\\big)^{3/2}} \\exp\\!\\left( -\\frac{\\lVert \\boldsymbol{r} \\rVert^2}{2\\sigma^2} \\right) $$\n    其中 $\\sigma$ 是核宽度。实现此函数以评估每个原子在界面点 $\\boldsymbol{y}_0$ 处的贡献权重。\n\n2.  **动能应力贡献**：应力的动能部分取决于原子的本征速度 $\\boldsymbol{w}_i(\\boldsymbol{y}_0) = \\boldsymbol{v}_i - \\boldsymbol{u}(\\boldsymbol{y}_0)$，即相对于局部粗粒化速度场 $\\boldsymbol{u}(\\boldsymbol{y}_0)$ 的速度。\n    \n    首先，计算粗粒化速度 $\\boldsymbol{u}(\\boldsymbol{y}_0)$，即粗粒化动量密度与粗粒化质量密度之比：\n    $$ \\boldsymbol{u}(\\boldsymbol{y}_0) = \\frac{\\sum_i m_i \\boldsymbol{v}_i \\, \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i)}{\\sum_i m_i \\, \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i)} $$\n    必须对分母进行检查。如果粗粒化质量密度为零（或数值上可忽略），这对应于一个空区域，则将粗粒化速度设为 $\\boldsymbol{u}(\\boldsymbol{y}_0) = \\boldsymbol{0}$。\n\n    确定本征速度后，通过求和计算动能应力张量：\n    $$ \\boldsymbol{\\sigma}^{\\text{kin}}(\\boldsymbol{y}_0) = - \\sum_i m_i \\, \\boldsymbol{w}_i(\\boldsymbol{y}_0) \\otimes \\boldsymbol{w}_i(\\boldsymbol{y}_0) \\, \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i) $$\n    其中 $\\otimes$ 表示外积。\n\n3.  **势能应力贡献**：势能应力源于成对相互作用力 $\\boldsymbol{f}_{ij}$。其计算涉及键函数 $B_{ij}(\\boldsymbol{y}_0)$，该函数定义为沿连接原子 $i$ 和 $j$ 的线段上的积分：\n    $$ B_{ij}(\\boldsymbol{y}_0) = \\int_0^1 \\phi\\!\\big(\\boldsymbol{y}_0 - \\boldsymbol{x}_i - s(\\boldsymbol{x}_j - \\boldsymbol{x}_i)\\big) \\, ds $$\n    对于高斯核，此积分可以解析求解。设 $\\boldsymbol{r}_{ij} = \\boldsymbol{x}_j - \\boldsymbol{x}_i$ 为长度为 $L = \\lVert \\boldsymbol{r}_{ij} \\rVert$ 的键向量。我们将从原子 $i$ 到界面点 $\\boldsymbol{y}_0$ 的向量 $\\boldsymbol{y}_0 - \\boldsymbol{x}_i$ 分解为平行于和垂直于键的两个分量：$\\boldsymbol{y}_0 - \\boldsymbol{x}_i = p \\hat{\\boldsymbol{r}}_{ij} + \\boldsymbol{q}$，其中 $p = (\\boldsymbol{y}_0 - \\boldsymbol{x}_i) \\cdot \\hat{\\boldsymbol{r}}_{ij}$，$\\boldsymbol{q}$ 是垂直分量。核函数指数中的范数平方变为 $\\lVert (p-sL)\\hat{\\boldsymbol{r}}_{ij} + \\boldsymbol{q} \\rVert^2 = (p-sL)^2 + \\lVert \\boldsymbol{q} \\rVert^2$。\n\n    然后，可以使用误差函数 $\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}}\\int_0^x e^{-t^2}dt$ 来求解该积分。键函数的解析表达式为：\n    $$ B_{ij}(\\boldsymbol{y}_0) = \\frac{e^{-\\lVert\\boldsymbol{q}\\rVert^2/(2\\sigma^2)}}{4\\pi \\sigma^2 L} \\left[ \\mathrm{erf}\\left(\\frac{p}{\\sqrt{2}\\sigma}\\right) - \\mathrm{erf}\\left(\\frac{p-L}{\\sqrt{2}\\sigma}\\right) \\right] $$\n    为了数值稳定性，必须处理键长 $L \\to 0$ 的极限情况。在此极限下，键函数收敛于核函数在原子位置处的值，即 $B_{ij}(\\boldsymbol{y}_0) \\to \\phi(\\boldsymbol{y}_0 - \\boldsymbol{x}_i)$。实现时，对于非常小的 $L$，会切换到此极限表达式，以避免除以零并保持精度。\n\n    然后，通过对所有唯一的相互作用对 $(i,j)$（其中 $i<j$）进行求和来计算势能应力张量：\n    $$ \\boldsymbol{\\sigma}^{\\text{pot}}(\\boldsymbol{y}_0) = - \\frac{1}{2} \\sum_{(i,j)} (\\boldsymbol{x}_j - \\boldsymbol{x}_i) \\otimes \\boldsymbol{f}_{ij} \\, B_{ij}(\\boldsymbol{y}_0) $$\n\n4.  **总应力与牵引力**：将动能和势能应力相加得到总应力张量 $\\boldsymbol{\\sigma}(\\boldsymbol{y}_0) = \\boldsymbol{\\sigma}^{\\text{kin}}(\\boldsymbol{y}_0) + \\boldsymbol{\\sigma}^{\\text{pot}}(\\boldsymbol{y}_0)$。最后，通过将应力张量与界面法向量相乘来计算牵引力向量：$\\boldsymbol{t}(\\boldsymbol{y}_0) = \\boldsymbol{\\sigma}(\\boldsymbol{y}_0)\\boldsymbol{n}$。\n\n此算法在所有提供的测试用例中都得到一致的应用，包括空原子集和复杂配置等情况。每一步都遵循所提供的定义，以确保计算结果的准确性和一致性。",
            "answer": "[[0.0, 0.0, -0.999741], [0.0, 0.0, 0.0], [0.0, 0.0, -2.842702], [0.0, 0.0, 0.0], [-0.472906, 0.300588, 0.35415]]"
        },
        {
            "introduction": "设计一个耦合方案只是第一步，验证其物理准确性，特别是动态响应的保真度，同样至关重要。一个理想的原子-连续介质界面应该对波的传播是“透明的”，以避免产生非物理的波反射。本练习将指导您进行一项标准的“波传递测试”（wave-passing test），通过在频域中分析不同波数的谐波穿过耦合界面的透射率，来量化耦合方案的质量。这项高阶练习将使您能够评估并优化耦合方法，确保其能够准确地模拟跨尺度的动力学现象 。",
            "id": "3496698",
            "problem": "考虑一个用于纵波的一维原子-连续介质耦合，该耦合使用一个桥接重叠区连接一个离散的分子动力学 (MD) 链和一个离散的有限元法 (FEM) 杆模型。MD 侧是一个最近邻线性质量-弹簧链，其晶格间距为 $a$，原子质量为 $M_{\\mathrm{md}}$，弹簧刚度为 $K_{\\mathrm{md}}$。FEM 侧被建模为一个粗化的离散链，其间距为 $h$，质量为 $M_{\\mathrm{fem}}$，刚度为 $K_{\\mathrm{fem}}$，这些参数的选择使得其长波波速与 MD 链的波速相等。这两个模型在一个长度为 $N_{\\mathrm{ov}}$ 个节点的重叠区域共存，在该区域中，它们通过刚度为 $K_{\\mathrm{pen}}$ 的罚函数弹簧耦合，这些弹簧连接着重合的 MD 和 FEM 自由度。在重叠区之外，只存在各自的模型。\n\n一个简谐位移从 MD 链的左边界注入，以产生一个形式为 $u(x,t)=A \\sin(k x - \\omega t)$ 的右行行波，其中 $A$ 是振幅，$k$ 是波数，$\\omega$ 是角频率。所有量都必须使用国际单位制 (SI) 处理：长度单位为米，时间单位为秒，波数单位为弧度/米，角频率单位为弧度/秒。假设 $A$ 的单位是米，$k$ 的单位是弧度/米。\n\n该问题的基本依据如下：\n\n- 应用于每个离散质量的牛顿第二定律：$M \\, \\ddot{u}_i = \\sum \\text{spring forces on node } i$。\n- 使用复振幅 $U_i$ 的简谐运动拟设：$u_i(t)=\\Re\\{U_i e^{-i \\omega t}\\}$。\n- 对于一个间距为 $a$、质量为 $M$、刚度为 $K$ 的最近邻链，小振幅纵向晶格色散关系可以从弹簧力和惯性力的平衡中得出：对于一个试探解 $U_i \\propto e^{i q i}$（其中 $q = k a$），可以得到\n$$\n\\omega^2 = \\frac{4K}{M} \\sin^2\\left(\\frac{q}{2}\\right).\n$$\n- 通过连接节点 $i$ 和 $i+1$ 的弹簧的时间平均能量通量，正比于简谐运动中力和速度的乘积。对于最近邻链上的行波 $U_i = A e^{i q i}$，该波携带的平均能量通量为\n$$\n\\mathcal{J} = \\omega K \\sin(q) \\, |A|^2,\n$$\n在计算比率时，一个两边共有的正常数因子会被消去。\n\n你必须按照以下规范实现一个频域散射计算：\n\n1. 构建一个包含 $N_{\\mathrm{md}}$ 个节点的离散 MD 链，其参数为 $(a, M_{\\mathrm{md}}, K_{\\mathrm{md}})$，以及一个包含 $N_{\\mathrm{fem}}$ 个节点的离散 FEM 链，其参数为 $(h, M_{\\mathrm{fem}}, K_{\\mathrm{fem}})$，使得它们的长波波速匹配，即 $h \\sqrt{K_{\\mathrm{fem}}/M_{\\mathrm{fem}}} = a \\sqrt{K_{\\mathrm{md}}/M_{\\mathrm{md}}}$。\n\n2. 让 MD 链从其纯 MD 段延伸 $N_{\\mathrm{ov}}$ 个节点进入重叠区，并让 FEM 链从其纯 FEM 段向左延伸 $N_{\\mathrm{ov}}$ 个节点进入重叠区。在重叠区中，通过刚度为 $K_{\\mathrm{pen}}$ 的罚函数弹簧耦合重合的 MD 和 FEM 节点，该弹簧对位移差异进行惩罚。\n\n3. 通过在左边界指定节点 $i=0$ 处的复振幅 $U_0=A$ 和节点 $i=1$ 处的复振幅 $U_1=A e^{i q_{\\mathrm{md}}}$（其中 $q_{\\mathrm{md}} = k a$）来施加一个右行 MD 行波。使用 MD 色散关系从 $q_{\\mathrm{md}}$ 计算 $\\omega$。将所有其他振幅视为未知数，并求解得到的线性代数系统。\n\n4. 通过施加 Bloch 关系 $U_{N_{\\mathrm{fem}}-1} = e^{i q_{\\mathrm{fem}}} U_{N_{\\mathrm{fem}}-2}$，在 FEM 链的右端强制施加一个出射波边界条件。其中，$q_{\\mathrm{fem}}$ 是通过反解 FEM 色散关系 $ \\omega^2 = \\frac{4 K_{\\mathrm{fem}}}{M_{\\mathrm{fem}}} \\sin^2(\\frac{q_{\\mathrm{fem}}}{2}) $ 计算得到的 FEM 晶格波数。如果反解的参数超过 1（即角频率位于 FEM 频带限制之上），则 FEM 无法在该频率下支持传播波，对于该 $k$ 值，透射必须视为零。\n\n5. 在求解所有复振幅后，从右行 FEM 场中提取 FEM 行波振幅 $A_{\\mathrm{tr}}$（例如，从 $U_{N_{\\mathrm{fem}}-2}$ 提取）。基于能量通量比计算透射系数\n$$\nT(k) = \\frac{\\mathcal{J}_{\\mathrm{fem}}}{\\mathcal{J}_{\\mathrm{md}}} = \\frac{ K_{\\mathrm{fem}} \\sin(q_{\\mathrm{fem}}) \\, |A_{\\mathrm{tr}}|^2 }{ K_{\\mathrm{md}} \\sin(q_{\\mathrm{md}}) \\, |A|^2 }.\n$$\n如果 $q_{\\mathrm{fem}}$ 不是实数或不传播，则设置 $T(k)=0$。\n\n6. 定义一个截止波数 $k_c$，并声明一个重叠配置“通过”的条件是当且仅当对于从一个小的正数下界到一个均匀网格上所有离散 $k$ 值（包括 $k_c$），都有 $T(k) \\geq T_{\\min}$，其中 $T_{\\min}$ 是一个指定的阈值。在整个计算中使用弧度/米作为 $k$ 的单位，弧度/秒作为 $\\omega$ 的单位，并取 $A$ 的单位为米。\n\n你必须实现一个完整的程序，该程序：\n\n- 使用 $a=1$ 米，$M_{\\mathrm{md}}=1$ 千克，和 $K_{\\mathrm{md}}=1$ 牛顿/米。使用 $h=2$ 米，$M_{\\mathrm{fem}}=1$ 千克，和 $K_{\\mathrm{fem}}=1/4$ 牛顿/米，以使两边的长波波速匹配。使用 $A=1$ 米。\n\n- 构建并求解上述频域线性系统，其中 MD 未知数是节点 $i=2,\\dots,N_{\\mathrm{md}}+N_{\\mathrm{ov}}-1$，FEM 未知数是节点 $j=-N_{\\mathrm{ov}},\\dots,N_{\\mathrm{fem}}-1$，并将节点 $j=N_{\\mathrm{fem}}-1$ 处的动力学方程替换为出射波 Bloch 约束。\n\n- 在 $N_k$ 个点的均匀网格上计算 $k \\in [k_{\\min}, k_c]$（其中 $k_{\\min}>0$，单位为弧度/米）的透射率 $T(k)$，如果整个网格上的最小透射率至少为 $T_{\\min}$，则为每个测试用例返回一个布尔值“通过”。\n\n测试套件：\n\n使用以下测试用例，每个用例由 $(N_{\\mathrm{md}}, N_{\\mathrm{fem}}, N_{\\mathrm{ov}}, K_{\\mathrm{pen}}, k_c, T_{\\min}, N_k, k_{\\min})$ 定义：\n\n- 案例 1 (基线重叠，预期会失败): $(20, 24, 1, 2.0, 0.8, 0.9, 32, 0.05)$。\n- 案例 2 (更大的重叠，预期在达到中等 $k_c$ 时会通过): $(20, 24, 6, 5.0, 0.8, 0.9, 32, 0.05)$。\n- 案例 3 (接近能带边缘，中等阈值): $(20, 24, 8, 8.0, 1.0, 0.8, 32, 0.05)$。\n- 案例 4 (截止波数高于 FEM 频带限制；根据定义应该会失败): $(20, 24, 8, 8.0, 1.2, 0.8, 32, 0.05)$。\n\n你的程序应该生成单行输出，其中包含按上述测试用例顺序排列的布尔结果，形式为方括号括起来的逗号分隔列表（例如，“[True,False,True,False]”）。",
            "solution": "用户提供了一个计算物理学中定义明确的问题，具体涉及一维原子-连续介质界面上波透射的模拟。该问题有科学依据，内部一致，并包含获得唯一解所需的所有必要信息。因此，它被认为是**有效的**。\n\n任务是对于几组参数，确定一个耦合的 MD-FEM 系统是否在一系列波数上允许简谐波的高透射。这涉及到为系统中每个节点的振荡复振幅构建和求解一个线性方程组，并遵循特定的边界条件。\n\n以下是求解该问题的有原则的分步方法：\n\n### 1. 系统和波的定义\n\n该系统由左侧的半无限分子动力学 (MD) 链和右侧的半无限有限元法 (FEM) 链组成，它们通过一个中间的重叠区域耦合。\n\n- **MD 链**：由质量为 $M_{\\mathrm{md}}$ 的质点通过刚度为 $K_{\\mathrm{md}}$ 的弹簧连接而成的离散链，其平衡间距为 $a$。其纵向色散关系由 $\\omega^2 = \\frac{4K_{\\mathrm{md}}}{M_{\\mathrm{md}}} \\sin^2\\left(\\frac{q_{\\mathrm{md}}}{2}\\right)$ 给出，其中 $q_{\\mathrm{md}}=ka$ 是无量纲波数。\n- **FEM 链**：一个粗粒化的离散链，其节点质量为 $M_{\\mathrm{fem}}$，单元刚度为 $K_{\\mathrm{fem}}$，间距为 $h$。其色散关系是类似的：$\\omega^2 = \\frac{4K_{\\mathrm{fem}}}{M_{\\mathrm{fem}}} \\sin^2\\left(\\frac{q_{\\mathrm{fem}}}{2}\\right)$，其中 $q_{\\mathrm{fem}}=kh$。\n- **耦合**：两条链重叠。在该区域，刚度为 $K_{\\mathrm{pen}}$ 的罚函数弹簧连接相应的 MD 和 FEM 节点，以惩罚它们位移的任何差异。\n\n一个波数为 $k$、振幅为 $A$ 的简谐波从左侧入射。其角频率 $\\omega$ 由 MD 色散关系确定。由于频率在界面上是守恒的，FEM 区域中的波必须具有相同的 $\\omega$。\n\n### 2. 频域公式\n\n我们使用简谐拟设 $u_n(t) = \\Re\\{U_n e^{-i\\omega t}\\}$，其中 $U_n$ 是节点 $n$ 的复振幅。牛顿第二定律 $M\\ddot{u}_n = \\sum F_n$ 变换为关于复振幅的代数方程：$-M\\omega^2 U_n = \\sum F_n^{\\mathrm{harmonic}}$。\n\n整个系统被建模为具有有限数量的自由度：\n- MD 节点: $i=0, 1, \\dots, N_{\\mathrm{md}}+N_{\\mathrm{ov}}-1$。\n- FEM 节点: $j=-N_{\\mathrm{ov}}, \\dots, N_{\\mathrm{fem}}-1$。\n\n这导出了一个形式为 $\\mathbf{M}\\mathbf{U} = \\mathbf{B}$ 的线性方程组，其中 $\\mathbf{U}$ 是所有未知复振幅的向量。\n\n### 3. 组装线性系统\n\n未知的振幅是 $U_2^{\\mathrm{md}}, \\dots, U_{N_{\\mathrm{md}}+N_{\\mathrm{ov}}-1}^{\\mathrm{md}}$ 和 $V_{-N_{\\mathrm{ov}}}^{\\mathrm{fem}}, \\dots, V_{N_{\\mathrm{fem}}-1}^{\\mathrm{fem}}$。每个节点的方程如下：\n\n- **内部 MD 节点 $i$ 的方程 ($2 \\le i < N_{\\mathrm{md}}$)**：该节点连接到 MD 邻居 $i-1$ 和 $i+1$。\n$$K_{\\mathrm{md}} U_{i-1}^{\\mathrm{md}} + (M_{\\mathrm{md}}\\omega^2 - 2K_{\\mathrm{md}})U_i^{\\mathrm{md}} + K_{\\mathrm{md}} U_{i+1}^{\\mathrm{md}} = 0$$\n\n- **重叠区中 MD 节点 $i$ 的方程 ($N_{\\mathrm{md}} \\le i < N_{\\mathrm{md}}+N_{\\mathrm{ov}}-1$)**：该节点连接到 MD 邻居和一个对应的 FEM 节点 $j = i - N_{\\mathrm{md}} - N_{\\mathrm{ov}}$。\n$$K_{\\mathrm{md}} U_{i-1}^{\\mathrm{md}} + (M_{\\mathrm{md}}\\omega^2 - 2K_{\\mathrm{md}} - K_{\\mathrm{pen}})U_i^{\\mathrm{md}} + K_{\\mathrm{md}} U_{i+1}^{\\mathrm{md}} + K_{\\mathrm{pen}} V_j^{\\mathrm{fem}} = 0$$\n对于最后一个 MD 节点 ($i = N_{\\mathrm{md}}+N_{\\mathrm{ov}}-1$)，它没有右侧的 MD 邻居，因此 $K_{\\mathrm{md}} U_{i+1}^{\\mathrm{md}}$ 项消失，中心系数变为 $(M_{\\mathrm{md}}\\omega^2 - K_{\\mathrm{md}} - K_{\\mathrm{pen}})$。\n\n- **重叠区中 FEM 节点 $j$ 的方程 ($-N_{\\mathrm{ov}} < j \\le -1$)**：该节点连接到 FEM 邻居和一个 MD 节点 $i = j + N_{\\mathrm{md}} + N_{\\mathrm{ov}}$。\n$$K_{\\mathrm{fem}} V_{j-1}^{\\mathrm{fem}} + (M_{\\mathrm{fem}}\\omega^2 - 2K_{\\mathrm{fem}} - K_{\\mathrm{pen}})V_j^{\\mathrm{fem}} + K_{\\mathrm{fem}} V_{j+1}^{\\mathrm{fem}} + K_{\\mathrm{pen}} U_i^{\\mathrm{md}} = 0$$\n对于第一个 FEM 节点 ($j = -N_{\\mathrm{ov}}$)，它没有左侧的 FEM 邻居，因此 $K_{\\mathrm{fem}} V_{j-1}^{\\mathrm{fem}}$ 项消失，中心系数变为 $(M_{\\mathrm{fem}}\\omega^2 - K_{\\mathrm{fem}} - K_{\\mathrm{pen}})$。\n\n- **内部 FEM 节点 $j$ 的方程 ($0 \\le j < N_{\\mathrm{fem}}-1$)**：该节点只连接到 FEM 邻居 $j-1$ 和 $j+1$。\n$$K_{\\mathrm{fem}} V_{j-1}^{\\mathrm{fem}} + (M_{\\mathrm{fem}}\\omega^2 - 2K_{\\mathrm{fem}})V_j^{\\mathrm{fem}} + K_{\\mathrm{fem}} V_{j+1}^{\\mathrm{fem}} = 0$$\n\n### 4. 边界条件\n\n- **左侧 (入射波)**：前两个 MD 节点的振幅被指定以模拟一个纯右行入射波：$U_0^{\\mathrm{md}} = A$ 和 $U_1^{\\mathrm{md}} = A e^{i q_{\\mathrm{md}}}$。为 $U_1^{\\mathrm{md}}$ 指定的值在节点 $U_2^{\\mathrm{md}}$ 的方程中产生一个非齐次项，该项被移到线性系统的右侧向量 $\\mathbf{B}$。\n\n- **右侧 (出射波)**：为防止来自截断的右边界的伪反射，施加了一个辐射边界条件。它在最后两个 FEM 节点之间强制一个行波关系：\n$$V_{N_{\\mathrm{fem}}-1}^{\\mathrm{fem}} = V_{N_{\\mathrm{fem}}-2}^{\\mathrm{fem}} e^{i q_{\\mathrm{fem}}}$$\n该方程替换了最终节点 $V_{N_{\\mathrm{fem}}-1}^{\\mathrm{fem}}$ 的动力学运动方程。波数 $q_{\\mathrm{fem}}$ 是通过对给定频率 $\\omega$ 反解 FEM 色散关系得到的。如果 $\\omega$ 超过 FEM 晶格可支持的最大频率 ($\\omega > \\sqrt{4K_{\\mathrm{fem}}/M_{\\mathrm{fem}}}$)，则波无法传播，透射为零。\n\n### 5. 透射计算\n\n在求解线性系统 $\\mathbf{M}\\mathbf{U} = \\mathbf{B}$ 以获得未知振幅向量 $\\mathbf{U}$ 后，我们计算能量透射系数 $T(k)$。\n\n1.  **提取透射振幅**：在纯 FEM 区域（远离界面），解是一个形式为 $V_j^{\\mathrm{fem}} = A_{\\mathrm{tr}} e^{ijq_{\\mathrm{fem}}}$ 的行波。复振幅 $A_{\\mathrm{tr}}$ 可以从该区域中某个节点 $j$（例如，$j=N_{\\mathrm{fem}}-2$）的计算解中提取：\n    $$A_{\\mathrm{tr}} = V_{N_{\\mathrm{fem}}-2}^{\\mathrm{fem}} e^{-i(N_{\\mathrm{fem}}-2)q_{\\mathrm{fem}}}$$\n2.  **计算能量通量比**：透射率是透射能量通量与入射能量通量之比。对于晶格波，时间平均能量通量 $\\mathcal{J}$ 正比于 $K \\sin(q) |A|^2$。频率 $\\omega$ 是共有的，在比率中被消去。\n    $$T(k) = \\frac{\\mathcal{J}_{\\mathrm{fem}}}{\\mathcal{J}_{\\mathrm{md}}} = \\frac{ K_{\\mathrm{fem}} \\sin(q_{\\mathrm{fem}}) |A_{\\mathrm{tr}}|^2 }{ K_{\\mathrm{md}} \\sin(q_{\\mathrm{md}}) |A|^2 }$$\n\n### 6. 通过/失败准则\n\n对于每个测试用例，在一个从 $k_{\\mathrm{min}}$ 到 $k_c$ 的离散波数网格上计算透射率 $T(k)$。只有当该范围内所有 $k$ 值的 $T(k) \\ge T_{\\min}$ 时，该配置才算“通过”。只要有一个 $k$ 产生的透射率低于阈值 $T_{\\min}$，该配置就“失败”。",
            "answer": "[False, True, True, False]"
        }
    ]
}