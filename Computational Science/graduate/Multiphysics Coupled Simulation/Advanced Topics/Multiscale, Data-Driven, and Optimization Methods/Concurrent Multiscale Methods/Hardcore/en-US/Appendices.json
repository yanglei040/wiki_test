{
    "hands_on_practices": [
        {
            "introduction": "To build a strong foundation in multiscale methods, we begin with a crucial verification exercise. This practice guides you through the process of deriving an effective material property for a simple heterogeneous system from first principles, a cornerstone of homogenization theory. By comparing the results of your simplified (homogenized) model against a high-fidelity Direct Numerical Simulation (DNS), you will gain direct, hands-on insight into the accuracy, and limitations, of the scale-separation assumption that underpins many multiscale approaches .",
            "id": "3498314",
            "problem": "Consider a one-dimensional small-strain, linear-elastic bar with spatially heterogeneous stiffness subjected to distributed body forces and end-displacement constraints. Let the spatial coordinate be $x \\in [0,L]$, cross-sectional area be $A$, displacement field be $u(x)$, strain be $\\varepsilon(x)$, and Cauchy stress be $\\sigma(x)$. Assume quasi-static equilibrium, no inertia, and no damping. The governing relations are: the balance of linear momentum $\\dfrac{\\mathrm{d}}{\\mathrm{d}x} \\left( A \\sigma(x) \\right) + b = 0$, the kinematic relation $\\varepsilon(x) = \\dfrac{\\mathrm{d}u}{\\mathrm{d}x}$, and the constitutive law of Hooke’s type $\\sigma(x) = E(x) \\varepsilon(x)$, where $E(x)$ is the spatially varying Young’s modulus. Let the boundary conditions be $u(0) = 0$ and $u(L) = U$, where $U$ is a prescribed end displacement. Let the body force density $b$ be constant along $x$.\n\nYou will design a verification benchmark to compare a concurrent multiscale Finite Element Squared (FE$^{2}$) approach against a Direct Numerical Simulation (DNS) on a fully resolved heterogeneous domain. In the FE$^{2}$ approach, the macroscopic problem is solved on a coarse mesh with an effective constitutive response obtained from an associated Representative Volume Element (RVE) of the microscopic heterogeneous medium. For this benchmark, consider a periodic two-phase microstructure along $x$ with period $p$, phase moduli $E_{1}$ and $E_{2}$, and phase fraction $f \\in (0,1)$ such that within each period, the interval of length $fp$ has modulus $E_{1}$ and the interval of length $(1-f)p$ has modulus $E_{2}$. The microscopic heterogeneity repeats over $[0,L]$.\n\nTasks:\n1. Starting solely from the balance law, the kinematic relation, and the constitutive law, formalize the homogenization concept appropriate for a one-dimensional periodic heterogeneous bar with scale separation. Derive the homogenized macroscopic constitutive relation with an effective modulus $E_{\\mathrm{eff}}$ for the bar under the stated conditions. Do not use any pre-stated homogenization formula; derive the form of $E_{\\mathrm{eff}}$ from first principles using the periodic microstructure and appropriate boundary conditions at the microscopic level that ensure energy consistency with the macroscopic field.\n2. Implement the DNS by discretizing the bar into $N$ uniform finite elements of length $h = L/N$, with $E(x)$ fully resolved as a piecewise constant function per element according to the periodic microstructure. Assemble the global stiffness matrix using linear finite elements and the constant body force density $b$ via the weak form. Enforce the Dirichlet boundary conditions $u(0) = 0$ and $u(L) = U$, solve for the nodal displacements, and compute the element-wise strains $\\varepsilon_{e}$, stresses $\\sigma_{e}$, and total strain energy $W_{\\mathrm{DNS}} = \\sum_{e} \\tfrac{1}{2} E_{e} A \\varepsilon_{e}^{2} h$.\n3. Implement the FE$^{2}$ macroscopic problem by discretizing the same bar into $M$ uniform finite elements, replacing $E(x)$ with the homogenized effective modulus $E_{\\mathrm{eff}}$ derived in Task 1. Assemble and solve the macroscopic finite element system under the same body force density $b$ and boundary conditions to obtain macroscopic nodal displacements $u_{\\mathrm{FE^{2}}}(x)$, element strains, stresses $\\sigma_{\\mathrm{FE^{2}}}(x)$, and total strain energy $W_{\\mathrm{FE^{2}}}$.\n4. Define quantitative error metrics to compare FE$^{2}$ with DNS:\n   - Stress error: the relative $L^{2}$ norm $e_{\\sigma} = \\dfrac{\\left\\| \\sigma_{\\mathrm{FE^{2}}} - \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}{\\left\\| \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}$, computed by sampling $\\sigma_{\\mathrm{FE^{2}}}(x)$ on the DNS element centers and using a composite rectangular rule with element width $h$.\n   - Displacement error: the relative $L^{2}$ norm $e_{u} = \\dfrac{\\left\\| u_{\\mathrm{FE^{2}}} - u_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}{\\left\\| u_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}$, computed by sampling both displacements at the DNS nodes and integrating with the composite trapezoidal rule.\n   - Energy error: the relative difference $e_{W} = \\dfrac{\\left| W_{\\mathrm{FE^{2}}} - W_{\\mathrm{DNS}} \\right|}{W_{\\mathrm{DNS}}}$.\nAll stresses must be computed in pascals, displacements in meters, and energies in joules. The error metrics must be expressed as decimals.\n\nYour program must implement the above and produce the error metrics for each parameter set in the following test suite. Use the following units consistently: $L$ in meters, $A$ in square meters, $U$ in meters, $b$ in newtons per meter, $E_{1}$ and $E_{2}$ in pascals, $p$ in meters.\n\nTest suite:\n- Case 1 (happy path): $L = 1.0$, $A = 1.0$, $U = 1.0 \\times 10^{-3}$, $b = 1000.0$, $E_{1} = 100.0 \\times 10^{9}$, $E_{2} = 50.0 \\times 10^{9}$, $f = 0.5$, $p = 0.02$, $M = 10$, $N = 500$.\n- Case 2 (near-homogeneous boundary case): $L = 1.0$, $A = 1.0$, $U = 1.0 \\times 10^{-3}$, $b = 1000.0$, $E_{1} = 80.0 \\times 10^{9}$, $E_{2} = 80.0 \\times 10^{9}$, $f = 0.5$, $p = 0.02$, $M = 10$, $N = 500$.\n- Case 3 (strong contrast): $L = 1.0$, $A = 1.0$, $U = 2.0 \\times 10^{-3}$, $b = 5000.0$, $E_{1} = 200.0 \\times 10^{9}$, $E_{2} = 10.0 \\times 10^{9}$, $f = 0.7$, $p = 0.05$, $M = 8$, $N = 800$.\n- Case 4 (poor scale separation): $L = 1.0$, $A = 1.0$, $U = 1.0 \\times 10^{-3}$, $b = 2000.0$, $E_{1} = 120.0 \\times 10^{9}$, $E_{2} = 30.0 \\times 10^{9}$, $f = 0.4$, $p = 0.25$, $M = 4$, $N = 400$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a three-element list $[e_{\\sigma}, e_{u}, e_{W}]$ for a test case, in the same order as the test suite (for example, $[[e_{\\sigma 1}, e_{u 1}, e_{W 1}],[e_{\\sigma 2}, e_{u 2}, e_{W 2}],\\dots]$).",
            "solution": "The problem proposed is a systematic verification benchmark for a one-dimensional (1D) multiscale Finite Element Squared (FE²) model against a high-fidelity Direct Numerical Simulation (DNS). The physical system is a linear-elastic bar with a periodic heterogeneous microstructure, subjected to a constant body force and prescribed end displacements. The problem is scientifically grounded, well-posed, and provides all necessary information for a unique numerical solution. It is therefore deemed a valid problem. The solution proceeds by first deriving the effective material property from first principles, then formulating the numerical models for both DNS and FE², and finally defining and computing the error metrics for comparison.\n\n### Task 1: Derivation of Homogenized Effective Modulus ($E_{\\mathrm{eff}}$)\n\nHomogenization theory allows for the replacement of a complex heterogeneous material with an equivalent homogeneous one, provided there is a clear separation of scales between the macroscopic structure and the microscopic heterogeneity. The effective properties of this equivalent medium are derived by analyzing the response of a Representative Volume Element (RVE). For the given 1D periodic microstructure, the RVE is a single period of length $p$.\n\nThe macroscopic stress $\\Sigma$ and strain $\\mathcal{E}$ are defined as the volume averages of their microscopic counterparts, $\\sigma(y)$ and $\\varepsilon(y)$, over the RVE, where $y \\in [0,p]$ is the microscopic coordinate:\n$$ \\Sigma = \\langle \\sigma \\rangle = \\frac{1}{p} \\int_0^p \\sigma(y) \\, dy $$\n$$ \\mathcal{E} = \\langle \\varepsilon \\rangle = \\frac{1}{p} \\int_0^p \\varepsilon(y) \\, dy $$\n\nAt the microscale, we assume the body force term is negligible compared to the stress gradients that balance the elastic forces. The balance of linear momentum within the RVE simplifies to:\n$$ \\frac{d\\sigma(y)}{dy} = 0 $$\nThis implies that the microscopic stress $\\sigma(y)$ must be constant throughout the RVE. This is the **iso-stress condition**. Let this constant stress be $\\sigma_0$. Therefore, $\\sigma(y) = \\sigma_0$.\n\nThe microscopic strain $\\varepsilon(y)$ is related to the stress via the spatially varying Young's modulus $E(y)$: $\\varepsilon(y) = \\sigma(y)/E(y) = \\sigma_0/E(y)$. The material consists of two phases:\n$$\n\\varepsilon(y) =\n\\begin{cases}\n    \\sigma_0/E_1 & \\text{for } y \\in [0, fp) \\\\\n    \\sigma_0/E_2 & \\text{for } y \\in [fp, p)\n\\end{cases}\n$$\n\nThe macroscopic strain $\\mathcal{E}$ is the average of the microscopic strain over the RVE:\n$$ \\mathcal{E} = \\frac{1}{p} \\int_0^p \\varepsilon(y) \\, dy = \\frac{1}{p} \\left[ \\int_0^{fp} \\frac{\\sigma_0}{E_1} \\, dy + \\int_{fp}^{p} \\frac{\\sigma_0}{E_2} \\, dy \\right] $$\n$$ \\mathcal{E} = \\frac{\\sigma_0}{p} \\left( \\frac{fp}{E_1} + \\frac{(p-fp)}{E_2} \\right) = \\sigma_0 \\left( \\frac{f}{E_1} + \\frac{1-f}{E_2} \\right) $$\n\nSince the microscopic stress is constant, the macroscopic stress $\\Sigma = \\langle \\sigma \\rangle = \\sigma_0$. Substituting $\\Sigma$ for $\\sigma_0$ gives the macroscopic strain-stress relationship:\n$$ \\mathcal{E} = \\Sigma \\left( \\frac{f}{E_1} + \\frac{1-f}{E_2} \\right) $$\n\nThe effective constitutive law is $\\Sigma = E_{\\mathrm{eff}} \\mathcal{E}$. By rearranging the above equation, we find the inverse of the effective modulus:\n$$ \\frac{1}{E_{\\mathrm{eff}}} = \\frac{\\mathcal{E}}{\\Sigma} = \\frac{f}{E_1} + \\frac{1-f}{E_2} $$\nThus, the effective modulus is the harmonic mean of the phase moduli, weighted by their respective volume fractions:\n$$ E_{\\mathrm{eff}} = \\left( \\frac{f}{E_1} + \\frac{1-f}{E_2} \\right)^{-1} $$\nThis result is characteristic of materials layered in series along the direction of loading.\n\n### Task 2 & 3: Finite Element Discretization\n\nThe governing strong form of the boundary value problem is obtained by substituting the kinematic and constitutive relations into the balance of momentum equation:\n$$ \\frac{d}{dx} \\left( A E(x) \\frac{du}{dx} \\right) + b = 0 \\quad \\text{for } x \\in (0,L) $$\nwith boundary conditions $u(0)=0$ and $u(L)=U$.\n\nThe weak form is derived by multiplying by a test function $v(x)$ (where $v(0)=v(L)=0$) and integrating over the domain. After integration by parts, we seek a displacement field $u(x)$ that satisfies the boundary conditions and the following equation for all valid test functions $v(x)$:\n$$ \\int_0^L A E(x) \\frac{du}{dx} \\frac{dv}{dx} \\, dx = \\int_0^L v(x) b \\, dx $$\n\nThis equation is discretized using the Finite Element Method (FEM). The domain is partitioned into elements, and within each element, the displacement field is approximated using linear shape functions. For a 1D linear element $e$ of length $h_e$ with constant properties $A_e$ and $E_e$, the element stiffness matrix $K_e$ and element body force vector $F_e$ are:\n$$ K_e = \\frac{A_e E_e}{h_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad F_e = \\frac{b h_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n\nThese element-level matrices and vectors are assembled into a global system of linear equations $\\mathbf{K}\\mathbf{u} = \\mathbf{F}$. After applying the Dirichlet boundary conditions $u(0)=0$ and $u(L)=U$, the system is solved for the vector of unknown nodal displacements $\\mathbf{u}$.\n\n**DNS Implementation (Task 2):**\nThe domain $[0,L]$ is discretized into $N$ fine elements. For each element $e$, the modulus $E_e$ is assigned the microscopic value ($E_1$ or $E_2$) corresponding to the material at the element's center. This creates a high-fidelity model that resolves the material heterogeneity.\n\n**FE² Macroscopic Implementation (Task 3):**\nThe domain $[0,L]$ is discretized into $M$ coarse elements ($M \\ll N$). For all elements, the modulus is set to the constant effective modulus $E_{\\mathrm{eff}}$ derived in Task 1. This model represents the homogenized, macroscopic behavior of the bar.\n\n### Task 4: Error Metrics Formulation\n\nTo quantify the accuracy of the FE² approximation, its solution is compared against the high-fidelity DNS solution.\n\n**Stress Error ($e_{\\sigma}$):** The FE² stress field $\\sigma_{\\mathrm{FE²}}$ is piecewise constant over the coarse mesh, while the DNS stress $\\sigma_{\\mathrm{DNS}}$ is piecewise constant over the fine mesh. To compare them, the FE² stress is sampled at the center of each DNS element. The relative $L^2$ error is then computed using the composite rectangular rule:\n$$ e_{\\sigma} = \\frac{\\left\\| \\sigma_{\\mathrm{FE^{2}}} - \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}}}{\\left\\| \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}}} \\approx \\sqrt{ \\frac{\\sum_{i=1}^N (\\sigma_{\\mathrm{FE²}}(x_{c,i}) - \\sigma_{\\mathrm{DNS},i})^2 h}{\\sum_{i=1}^N (\\sigma_{\\mathrm{DNS},i})^2 h} } = \\sqrt{ \\frac{\\sum_{i=1}^N (\\sigma_{\\mathrm{FE²}}(x_{c,i}) - \\sigma_{\\mathrm{DNS},i})^2}{\\sum_{i=1}^N (\\sigma_{\\mathrm{DNS},i})^2} } $$\nwhere $\\sigma_{\\mathrm{DNS},i}$ is the stress in DNS element $i$ and $x_{c,i}$ is its center.\n\n**Displacement Error ($e_{u}$):** The FE² nodal displacements are defined on the coarse mesh. A continuous, piecewise-linear displacement field $u_{\\mathrm{FE²}}(x)$ is obtained by linear interpolation. This field is then sampled at the DNS nodes. The relative $L^2$ error is computed using the composite trapezoidal rule:\n$$ e_{u} = \\frac{\\left\\| u_{\\mathrm{FE^{2}}} - u_{\\mathrm{DNS}} \\right\\|_{L^{2}}}{\\left\\| u_{\\mathrm{DNS}} \\right\\|_{L^{2}}} = \\sqrt{ \\frac{\\int_0^L (u_{\\mathrm{FE²}}(x) - u_{\\mathrm{DNS}}(x))^2 dx}{\\int_0^L (u_{\\mathrm{DNS}}(x))^2 dx} } $$\nwhere the integrals are evaluated numerically using the nodal values on the fine DNS mesh.\n\n**Energy Error ($e_{W}$):** The total strain energy for each model, $W_{\\mathrm{DNS}}$ and $W_{\\mathrm{FE²}}$, is calculated by summing the energy in each of their respective elements: $W = \\sum_{e} \\frac{1}{2} \\int_e A E_e \\varepsilon_e^2 dx = \\sum_e \\frac{1}{2} A_e E_e \\varepsilon_e^2 h_e$. The relative error is the absolute difference normalized by the DNS energy:\n$$ e_{W} = \\frac{\\left| W_{\\mathrm{FE^{2}}} - W_{\\mathrm{DNS}} \\right|}{W_{\\mathrm{DNS}}} $$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import trapezoid\n\ndef solve_fem(L, A, E_vals, n_elem, b, U_bc):\n    \"\"\"\n    Solves a 1D bar problem using the linear Finite Element Method.\n\n    Args:\n        L (float): Length of the bar.\n        A (float): Cross-sectional area.\n        E_vals (np.array): Array of Young's moduli for each element.\n        n_elem (int): Number of elements.\n        b (float): Constant body force density.\n        U_bc (float): Prescribed displacement at x=L.\n\n    Returns:\n        tuple: A tuple containing:\n            - u (np.array): Nodal displacements of size (n_elem + 1).\n            - sigma (np.array): Element-wise constant stresses of size (n_elem).\n            - W (float): Total strain energy.\n    \"\"\"\n    n_nodes = n_elem + 1\n    h = L / n_elem\n\n    K = np.zeros((n_nodes, n_nodes))\n    F = np.zeros(n_nodes)\n\n    for e in range(n_elem):\n        E_e = E_vals[e]\n        k_e = (A * E_e / h) * np.array([[1, -1], [-1, 1]])\n        f_e = (b * h / 2) * np.array([1, 1])\n        \n        nodes = np.array([e, e + 1])\n        K[np.ix_(nodes, nodes)] += k_e\n        F[nodes] += f_e\n\n    prescribed_dofs = [0, n_nodes - 1]\n    all_dofs = list(range(n_nodes))\n    free_dofs = [dof for dof in all_dofs if dof not in prescribed_dofs]\n    \n    u_bc_vals = np.array([0.0, U_bc])\n    \n    # K_fp @ U_p term\n    F_mod = K[np.ix_(free_dofs, prescribed_dofs)] @ u_bc_vals\n    F_reduced = F[free_dofs] - F_mod\n    K_reduced = K[np.ix_(free_dofs, free_dofs)]\n    \n    u_free = np.linalg.solve(K_reduced, F_reduced)\n    \n    u = np.zeros(n_nodes)\n    u[free_dofs] = u_free\n    u[prescribed_dofs] = u_bc_vals\n    \n    epsilon = (u[1:] - u[:-1]) / h\n    sigma = E_vals * epsilon\n    W = 0.5 * np.sum(A * E_vals * epsilon**2 * h)\n    \n    return u, sigma, W\n\ndef run_benchmark(params):\n    \"\"\"\n    Runs the DNS vs FE^2 benchmark for a given set of parameters.\n    \"\"\"\n    L, A, U, b, E1, E2, f, p, M, N = params\n    \n    # Task 1: Calculate effective modulus\n    if E1 == 0 or E2 == 0:\n        E_eff = 0\n    else:\n        E_eff = 1.0 / (f / E1 + (1 - f) / E2)\n    \n    # Task 2: Direct Numerical Simulation (DNS)\n    h_dns = L / N\n    E_dns = np.zeros(N)\n    for i in range(N):\n        x_center = (i + 0.5) * h_dns\n        if (x_center % p) < f * p:\n            E_dns[i] = E1\n        else:\n            E_dns[i] = E2\n            \n    u_dns, sigma_dns, W_dns = solve_fem(L, A, E_dns, N, b, U)\n\n    # Task 3: FE^2 Macroscopic Simulation\n    E_fe2 = np.full(M, E_eff)\n    u_fe2, sigma_fe2, W_fe2 = solve_fem(L, A, E_fe2, M, b, U)\n\n    # Task 4: Compute Error Metrics\n    h_fe2 = L / M\n\n    # Stress error e_sigma\n    sigma_fe2_sampled = np.zeros(N)\n    for i in range(N):\n        x_center = (i + 0.5) * h_dns\n        macro_elem_idx = min(int(x_center / h_fe2), M - 1)\n        sigma_fe2_sampled[i] = sigma_fe2[macro_elem_idx]\n    \n    num_sigma = np.sum((sigma_fe2_sampled - sigma_dns)**2)\n    den_sigma = np.sum(sigma_dns**2)\n    e_sigma = np.sqrt(num_sigma / den_sigma) if den_sigma > 1e-15 else 0.0\n\n    # Displacement error e_u\n    x_dns = np.linspace(0, L, N + 1)\n    x_fe2 = np.linspace(0, L, M + 1)\n    u_fe2_interp = np.interp(x_dns, x_fe2, u_fe2)\n    \n    num_u = trapezoid((u_fe2_interp - u_dns)**2, x_dns)\n    den_u = trapezoid(u_dns**2, x_dns)\n    e_u = np.sqrt(num_u / den_u) if den_u > 1e-15 else 0.0\n    \n    # Energy error e_W\n    e_W = np.abs(W_fe2 - W_dns) / W_dns if W_dns > 1e-15 else 0.0\n\n    return [e_sigma, e_u, e_W]\n\ndef solve():\n    \"\"\"Main function to run the test suite and print results.\"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        (1.0, 1.0, 1.0e-3, 1000.0, 100.0e9, 50.0e9, 0.5, 0.02, 10, 500),\n        # Case 2 (near-homogeneous boundary case)\n        (1.0, 1.0, 1.0e-3, 1000.0, 80.0e9, 80.0e9, 0.5, 0.02, 10, 500),\n        # Case 3 (strong contrast)\n        (1.0, 1.0, 2.0e-3, 5000.0, 200.0e9, 10.0e9, 0.7, 0.05, 8, 800),\n        # Case 4 (poor scale separation)\n        (1.0, 1.0, 1.0e-3, 2000.0, 120.0e9, 30.0e9, 0.4, 0.25, 4, 400),\n    ]\n\n    results = []\n    for params in test_cases:\n        errors = run_benchmark(params)\n        results.append(errors)\n\n    # Format output as a list of lists of decimals.\n    result_str = \",\".join([f\"[{','.join(map(str, err))}]\" for err in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world engineering materials rarely behave in a purely linear elastic fashion, making the treatment of nonlinearity a central theme in multiscale modeling. This exercise advances from elasticity to elastoplasticity, focusing on a critical numerical aspect: the consistent tangent modulus. You will derive how the iterative algorithm used to solve the microscopic plasticity problem directly informs the tangent stiffness of the macroscopic model, a key step for ensuring the quadratic convergence of the global Finite Element solver .",
            "id": "3498329",
            "problem": "Consider a two-scale small-strain elastoplastic problem solved by Finite Element squared (FE$^2$), where the macroscale problem uses homogenized constitutive response obtained by solving a microscale Representative Volume Element (RVE) boundary value problem at each macroscale integration point. Assume the following setting.\n\n- Macroscale kinematics are one-dimensional uniaxial small strain with macroscopic strain denoted by $\\varepsilon^{M}$ and macroscopic stress denoted by $\\sigma^{M}$.\n- The microscale RVE is homogeneous, one-dimensional, and obeys associated $J_{2}$-type plasticity specialized to one dimension (so that sign effects are captured by the absolute value in the yield function). The micro constitutive equations are:\n  - Kinematics: $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$, where $\\varepsilon$, $\\varepsilon^{e}$, and $\\varepsilon^{p}$ denote total, elastic, and plastic strain, respectively.\n  - Elastic law: $\\sigma = E\\,\\varepsilon^{e}$, where $E$ is the micro elastic modulus.\n  - Yield function: $f(\\sigma,\\alpha) = |\\sigma| - \\sigma_{y} - H\\,\\alpha$, where $\\sigma_{y}$ is the initial yield stress, $H$ is the (scalar) algorithmic plastic modulus associated with linear isotropic hardening, and $\\alpha$ is the equivalent plastic strain.\n  - Flow rule and hardening: $\\dot{\\varepsilon}^{p} = \\dot{\\lambda}\\,\\mathrm{sign}(\\sigma)$ and $\\dot{\\alpha} = \\dot{\\lambda}$, with $\\dot{\\lambda} \\ge 0$, $f \\le 0$, and $\\dot{\\lambda}\\,f = 0$.\n- The microscale problem is solved at each macroscale increment by a backward Euler return-mapping algorithm under kinematic uniform boundary conditions (so that the imposed boundary displacement field enforces a uniform microscopic strain equal to the macroscopic strain: $\\varepsilon = \\varepsilon^{M}$). The current state is in plastic loading with $\\sigma > 0$ (so that $\\mathrm{sign}(\\sigma) = +1$).\n\nStarting from these fundamentals, perform the following:\n1. Derive the scalar expression for the macroscopic consistent tangent modulus $E_{\\mathrm{M,alg}} = \\dfrac{\\partial \\sigma^{M}}{\\partial \\varepsilon^{M}}$ at the current integration point in terms of the micro elastic modulus $E$ and the micro algorithmic plastic modulus $H$, using the backward Euler return-mapping scheme applied at the microscale and homogenization via the volume average of the stress.\n2. Using your derived expression, evaluate $E_{\\mathrm{M,alg}}$ for $E = 210~\\mathrm{GPa}$ and $H = 1.5~\\mathrm{GPa}$. Round your final numerical value to four significant figures. Express the final answer in $\\mathrm{GPa}$.\n3. Based only on your derivation, explain how the algorithmic plastic modulus $H$ influences the convergence behavior of the macroscopic Newton iteration in FE$^2$ and identify limiting behaviors as $H \\to 0$ and as $H \\to \\infty$.\n\nYour final reported answer must be a single real number as specified in item 2. Do not include any intermediate quantities in the final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational plasticity and multiscale mechanics, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We can proceed with the solution.\n\nThe problem asks for three items: the derivation of the macroscopic consistent tangent modulus $E_{\\mathrm{M,alg}}$, its numerical evaluation, and an explanation of the influence of the hardening modulus $H$ on the convergence of the macroscopic solver.\n\n**1. Derivation of the Macroscopic Consistent Tangent Modulus $E_{\\mathrm{M,alg}}$**\n\nThe macroscopic consistent tangent modulus is defined as $E_{\\mathrm{M,alg}} = \\frac{\\partial \\sigma^{M}}{\\partial \\varepsilon^{M}}$. In the FE² framework with kinematic uniform boundary conditions (KUBC) on a homogeneous Representative Volume Element (RVE), the volume-averaged quantities at the macroscale are directly related to the uniform fields at the microscale. Specifically, the macroscopic strain $\\varepsilon^{M}$ is equal to the microscopic strain $\\varepsilon$, and the macroscopic stress $\\sigma^{M}$ is equal to the microscopic stress $\\sigma$. Thus, we need to derive the microscopic consistent tangent modulus $E_{\\mathrm{alg}} = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$.\n\nThe derivation starts from the discrete-in-time equations of the backward Euler return-mapping algorithm at a generic time step $n+1$. The state variables are updated from their known values at step $n$ to their unknown values at step $n+1$ for a given total strain increment.\nThe governing equations at step $n+1$ are:\n1.  Additive strain decomposition: $\\varepsilon_{n+1} = \\varepsilon_{n+1}^e + \\varepsilon_{n+1}^p$.\n2.  Elastic law: $\\sigma_{n+1} = E\\,\\varepsilon_{n+1}^e$.\n3.  Flow rule (backward Euler): $\\varepsilon_{n+1}^p = \\varepsilon_n^p + \\Delta\\lambda\\,\\mathrm{sign}(\\sigma_{n+1})$.\n4.  Hardening law (backward Euler): $\\alpha_{n+1} = \\alpha_n + \\Delta\\lambda$.\n5.  Yield condition at plastic loading: $f(\\sigma_{n+1}, \\alpha_{n+1}) = 0$.\n\nThe problem specifies that the current state is in plastic loading with $\\sigma > 0$. This implies $\\mathrm{sign}(\\sigma_{n+1}) = +1$ and the yield condition becomes $|\\sigma_{n+1}| - \\sigma_y - H\\alpha_{n+1} = \\sigma_{n+1} - \\sigma_y - H\\alpha_{n+1} = 0$.\n\nCombining these equations, we can express the final state $(\\sigma_{n+1}, \\varepsilon_{n+1}^p, \\alpha_{n+1})$ in terms of the total strain $\\varepsilon_{n+1}$ and the state at step $n$. To find the consistent tangent modulus, we take the derivative of these implicit relationships. The most direct method is to differentiate the system of equations with respect to the total strain $\\varepsilon_{n+1}$. Let $\\partial(\\cdot)$ denote the differential operator $\\partial(\\cdot)/\\partial\\varepsilon_{n+1}$.\n\nFrom the elastic law and strain decomposition:\n$\\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon_{n+1}^p)$\nDifferentiating with respect to $\\varepsilon_{n+1}$ yields:\n$\\partial\\sigma_{n+1} = E (1 - \\partial\\varepsilon_{n+1}^p)$\n\nFrom the flow rule, specialized for $\\sigma > 0$:\n$\\varepsilon_{n+1}^p = \\varepsilon_n^p + \\Delta\\lambda$\nDifferentiating with respect to $\\varepsilon_{n+1}$ (noting that $\\varepsilon_n^p$ is a constant from the previous step):\n$\\partial\\varepsilon_{n+1}^p = \\partial(\\Delta\\lambda)$\n\nFrom the yield condition, specialized for $\\sigma > 0$:\n$\\sigma_{n+1} - \\sigma_y - H\\alpha_{n+1} = 0$\nSubstituting the hardening law $\\alpha_{n+1} = \\alpha_n + \\Delta\\lambda$:\n$\\sigma_{n+1} - \\sigma_y - H(\\alpha_n + \\Delta\\lambda) = 0$\nDifferentiating with respect to $\\varepsilon_{n+1}$ (noting that $\\sigma_y$ and $\\alpha_n$ are constants):\n$\\partial\\sigma_{n+1} - H\\,\\partial(\\Delta\\lambda) = 0 \\implies \\partial\\sigma_{n+1} = H\\,\\partial(\\Delta\\lambda)$\n\nNow we have a system of three differential relations:\n(i) $\\partial\\sigma_{n+1} = E (1 - \\partial\\varepsilon_{n+1}^p)$\n(ii) $\\partial\\varepsilon_{n+1}^p = \\partial(\\Delta\\lambda)$\n(iii) $\\partial\\sigma_{n+1} = H\\,\\partial(\\Delta\\lambda)$\n\nFrom (ii) and (iii), we can relate the differential of plastic strain to the differential of stress:\n$\\partial\\varepsilon_{n+1}^p = \\frac{1}{H}\\partial\\sigma_{n+1}$\n\nSubstitute this into equation (i):\n$\\partial\\sigma_{n+1} = E \\left(1 - \\frac{1}{H}\\partial\\sigma_{n+1}\\right) = E - \\frac{E}{H}\\partial\\sigma_{n+1}$\n\nNow, we solve for $\\partial\\sigma_{n+1}$:\n$\\partial\\sigma_{n+1} + \\frac{E}{H}\\partial\\sigma_{n+1} = E$\n$\\partial\\sigma_{n+1} \\left(1 + \\frac{E}{H}\\right) = E$\n$\\partial\\sigma_{n+1} \\left(\\frac{H+E}{H}\\right) = E$\n$\\partial\\sigma_{n+1} = \\frac{EH}{E+H}$\n\nThe consistent tangent modulus is the ratio of the change in stress to the change in strain, which is exactly $\\partial\\sigma_{n+1}/\\partial\\varepsilon_{n+1}$.\nTherefore, the microscopic algorithmic tangent is $E_{\\mathrm{alg}} = \\frac{\\partial\\sigma_{n+1}}{\\partial\\varepsilon_{n+1}} = \\frac{EH}{E+H}$.\nDue to the homogenization rules for this simple problem ($\\sigma^M = \\sigma$, $\\varepsilon^M = \\varepsilon$), the macroscopic consistent tangent modulus is identical to the microscopic one:\n$E_{\\mathrm{M,alg}} = \\frac{EH}{E+H}$.\n\nThis expression is the harmonic mean of the elastic modulus $E$ and the algorithmic plastic modulus $H$.\n\n**2. Numerical Evaluation of $E_{\\mathrm{M,alg}}$**\n\nGiven the values $E = 210~\\mathrm{GPa}$ and $H = 1.5~\\mathrm{GPa}$, we substitute them into the derived expression:\n$$E_{\\mathrm{M,alg}} = \\frac{(210~\\mathrm{GPa})(1.5~\\mathrm{GPa})}{210~\\mathrm{GPa} + 1.5~\\mathrm{GPa}} = \\frac{315}{211.5}~\\mathrm{GPa}$$\n$$E_{\\mathrm{M,alg}} \\approx 1.4893617...~\\mathrm{GPa}$$\nRounding to four significant figures, we get:\n$$E_{\\mathrm{M,alg}} = 1.489~\\mathrm{GPa}$$\n\n**3. Influence of $H$ on Macroscopic Convergence**\n\nThe macroscopic finite element problem is a system of nonlinear algebraic equations, which is typically solved using the Newton-Raphson method. The convergence rate of this iterative method depends critically on the tangent stiffness matrix used. For quadratic convergence, this matrix must be constructed from the consistent tangent modulus, which is the exact derivative of the residual vector with respect to the nodal degrees of freedom. In this problem, $E_{\\mathrm{M,alg}} = \\frac{EH}{E+H}$ is precisely this consistent tangent modulus for the material point.\n\nThe algorithmic plastic modulus $H$ directly influences the value of $E_{\\mathrm{M,alg}}$ and therefore governs the macroscopic stiffness during plastic deformation. Its value is crucial for the numerical performance of the FE² simulation.\n\n- **Limiting behavior as $H \\to 0$ (perfect plasticity):**\nAs $H$ approaches $0$, the macroscopic tangent modulus becomes:\n$$\\lim_{H \\to 0} E_{\\mathrm{M,alg}} = \\lim_{H \\to 0} \\frac{EH}{E+H} = 0$$\nA zero tangent modulus means the macroscopic stiffness matrix becomes singular (or near-singular) at integration points that are undergoing plastic flow. This leads to severe numerical difficulties for the standard Newton-Raphson solver, which will fail to find a solution. This behavior corresponds to reaching a limit load, and specialized solvers (e.g., arc-length methods) are required to proceed.\n\n- **Limiting behavior as $H \\to \\infty$:**\nAs $H$ approaches infinity, the macroscopic tangent modulus becomes:\n$$\\lim_{H \\to \\infty} E_{\\mathrm{M,alg}} = \\lim_{H \\to \\infty} \\frac{EH}{E+H} = \\lim_{H \\to \\infty} \\frac{E}{\\frac{E}{H}+1} = \\frac{E}{0+1} = E$$\nAn infinite hardening modulus means that an infinite stress is required to cause further plastic straining. The material effectively behaves as if it were purely elastic. The macroscopic tangent modulus reverts to the elastic modulus $E$. The macroscopic problem becomes linear, and the Newton-Raphson solver converges in a single iteration.\n\nIn summary, the value of $H$ controls the material's post-yield stiffness. Using the correct, $H$-dependent $E_{\\mathrm{M,alg}}$ ensures the quadratic convergence of the macroscopic Newton iterations. The extreme cases of $H \\to 0$ and $H \\to \\infty$ lead to ill-conditioned (singular) and well-conditioned (linear elastic) problems, respectively.",
            "answer": "$$\\boxed{1.489}$$"
        },
        {
            "introduction": "Simulating material failure presents a significant challenge, as local softening can lead to strain localization and results that are pathologically dependent on the mesh discretization. This advanced practice explores how multiscale analysis provides a pathway to regularize these ill-posed problems. You will derive an 'apparent characteristic length' from the microscopic fracture energy and explore its role in a macroscopic nonlocal model, demonstrating how microstructural information can be used to establish a physically-based length scale for robust failure simulations .",
            "id": "3498292",
            "problem": "Consider a one-dimensional tensile bar modeled by a concurrent multiscale Finite Element squared (FE²) formulation, in which each macroscopic integration point is coupled to a microscopic Representative Volume Element (RVE) that exhibits isotropic scalar damage with linear softening in tension. The macroscopic constitutive behavior is regularized by a nonlocal integral averaging of the equivalent strain. The goal is to compute the apparent characteristic length emerging from the microscopic damage model and to quantify how this length influences macroscopic localization predictions in the nonlocal FE² formulation.\n\nMicroscale model assumptions and definitions:\n- The microscopic elastic modulus is $E$ (in $\\mathrm{Pa}$), the microscopic equivalent strain at damage initiation is $\\varepsilon_0$ (dimensionless), and the equivalent strain at complete failure is $\\varepsilon_f$ (dimensionless), with $\\varepsilon_f \\gt \\varepsilon_0$.\n- The microscopic tensile strength is $\\sigma_0 = E \\varepsilon_0$ (in $\\mathrm{Pa}$).\n- The microscopic fracture energy per unit area is $G_f$ (in $\\mathrm{N/m}$), defined as the energy required to fully develop a traction-free crack, integrated over the softening process.\n- After initiation, the microscopic stress undergoes linear softening to zero at $\\varepsilon_f$ under monotonic tensile loading.\n- Assume a localization band of uniform strain across its width at the microscale: inside the band the equivalent strain is $\\varepsilon_f$, and outside the band it remains at $\\varepsilon_0$.\n\nMacroscopic nonlocal regularization:\n- The macroscopic equivalent strain at position $x$, denoted $\\varepsilon_{\\mathrm{nl}}(x)$ (dimensionless), is defined by an integral average of the local equivalent strain field $\\varepsilon_{\\mathrm{loc}}(\\xi)$ using a normalized exponential kernel,\n$$\nw(r;\\ell) = \\frac{1}{2\\ell} \\exp\\left(-\\frac{|r|}{\\ell}\\right),\n$$\nwhere $r = x - \\xi$, and $\\ell$ is the macroscopic nonlocal kernel length (in $\\mathrm{m}$). The nonlocal equivalent strain is\n$$\n\\varepsilon_{\\mathrm{nl}}(x) = \\int_{-\\infty}^{\\infty} w(|x-\\xi|;\\ell)\\,\\varepsilon_{\\mathrm{loc}}(\\xi)\\, \\mathrm{d}\\xi.\n$$\n- In the FE² setting, the kernel length $\\ell$ may be linked to the microscale through an apparent characteristic length computed from the RVE damage response. In practice, $\\ell$ can be scaled relative to the apparent length by a dimensionless multiplier $c \\gt 0$, i.e., $\\ell = c\\,\\ell_{\\mathrm{app}}$.\n\nTasks:\n1. Starting from energy balance and the definitions above, derive the apparent characteristic length $\\ell_{\\mathrm{app}}$ (in $\\mathrm{m}$) that equates the microscopic fracture energy per unit area $G_f$ to the energy dissipated when a one-dimensional localization band of width $\\ell_{\\mathrm{app}}$ forms and fully softens from $\\varepsilon_0$ to $\\varepsilon_f$ under the assumed linear softening law. Your derivation must begin from the microscopic stress-strain characterization and the fracture energy definition, and must not assume any pre-existing formula for $\\ell_{\\mathrm{app}}$.\n2. Using the derived $\\ell_{\\mathrm{app}}$, consider a top-hat local equivalent strain field of width $\\ell_{\\mathrm{app}}$ centered at $x=0$ with $\\varepsilon_{\\mathrm{loc}}(x) = \\varepsilon_f$ for $|x| \\le \\ell_{\\mathrm{app}}/2$ and $\\varepsilon_{\\mathrm{loc}}(x) = \\varepsilon_0$ otherwise. Compute the nonlocal equivalent strain at the center, $\\varepsilon_{\\mathrm{nl}}(0)$, for the exponential kernel defined above with $\\ell = c\\,\\ell_{\\mathrm{app}}$. From this, derive a dimensionless influence metric\n$$\nr = \\frac{\\varepsilon_{\\mathrm{nl}}(0) - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0},\n$$\nwhich quantifies how strongly the nonlocal model weights the localized high-strain region (with $r \\in (0,1)$). Express $r$ in terms of the ratio between the nonlocal kernel length and the apparent characteristic length.\n\n3. Implement a complete, runnable program that, for each test case listed below, computes and returns the pair $\\left[\\ell_{\\mathrm{app}}, r\\right]$ as floating-point numbers. Use International System of Units (SI): report $\\ell_{\\mathrm{app}}$ in $\\mathrm{m}$ and $r$ as a decimal. Round both outputs to six decimal places.\n\nTest suite:\n- Case A (general case): $E = 50\\times 10^9\\,\\mathrm{Pa}$, $\\varepsilon_0 = 0.002$, $\\varepsilon_f = 0.02$, $G_f = 1200\\,\\mathrm{N/m}$, $c = 1.0$.\n- Case B (boundary: small kernel length relative to apparent length): $E = 70\\times 10^9\\,\\mathrm{Pa}$, $\\varepsilon_0 = 0.0015$, $\\varepsilon_f = 0.004$, $G_f = 250\\,\\mathrm{N/m}$, $c = 0.25$.\n- Case C (edge: narrow softening window): $E = 30\\times 10^9\\,\\mathrm{Pa}$, $\\varepsilon_0 = 0.002$, $\\varepsilon_f = 0.0024$, $G_f = 800\\,\\mathrm{N/m}$, $c = 1.5$.\n- Case D (general case with larger toughness and stronger smoothing): $E = 40\\times 10^9\\,\\mathrm{Pa}$, $\\varepsilon_0 = 0.0025$, $\\varepsilon_f = 0.015$, $G_f = 5000\\,\\mathrm{N/m}$, $c = 2.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of four items, one per test case, where each item is a two-element list in the form $\\left[\\ell_{\\mathrm{app}}, r\\right]$. For example:\n[[l_app_A,r_A],[l_app_B,r_B],[l_app_C,r_C],[l_app_D,r_D]]",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in the field of computational continuum mechanics, specifically focusing on the regularization techniques used in multiscale modeling of materials with strain-softening behavior. We will proceed with a full solution.\n\nThe primary objective is to derive two key quantities for a one-dimensional nonlocal damage model and then compute them for a given set of material parameters. The first quantity is the apparent characteristic length, $\\ell_{\\mathrm{app}}$, which links the microscopic fracture energy to the energy dissipated in a localization band. The second is a dimensionless influence metric, $r$, which quantifies the degree of nonlocal regularization.\n\nThe derivation proceeds in two parts as specified by the problem tasks.\n\n**Part 1: Derivation of the Apparent Characteristic Length, $\\ell_{\\mathrm{app}}$**\n\nThe apparent characteristic length, $\\ell_{\\mathrm{app}}$, is derived by postulating an energy equivalence. The phenomenological material property, fracture energy per unit area $G_f$, must be equal to the total energy dissipated per unit area within a localization band as it forms and fully softens. The width of this band is defined as $\\ell_{\\mathrm{app}}$.\n\nFirst, we characterize the energy dissipated per unit volume, which we denote as $g_f$. The problem states a linear softening law for the microscopic stress $\\sigma$ as a function of the equivalent strain $\\varepsilon$. The stress is linear elastic up to the peak stress $\\sigma_0 = E \\varepsilon_0$ at strain $\\varepsilon_0$. For strains $\\varepsilon$ between the initiation of damage $\\varepsilon_0$ and complete failure $\\varepsilon_f$, the stress decreases linearly to zero. The stress-strain relation during softening ($\\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f$) is given by:\n$$\n\\sigma(\\varepsilon) = \\sigma_0 \\frac{\\varepsilon_f - \\varepsilon}{\\varepsilon_f - \\varepsilon_0}\n$$\nThe energy dissipated per unit volume, $g_f$, during the softening process is the integral of stress over strain from $\\varepsilon_0$ to $\\varepsilon_f$. This corresponds to the area under the softening portion of the stress-strain curve.\n$$\ng_f = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon) \\, \\mathrm{d}\\varepsilon = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma_0 \\frac{\\varepsilon_f - \\varepsilon}{\\varepsilon_f - \\varepsilon_0} \\, \\mathrm{d}\\varepsilon\n$$\nWe can extract the constant terms from the integral:\n$$\ng_f = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\int_{\\varepsilon_0}^{\\varepsilon_f} (\\varepsilon_f - \\varepsilon) \\, \\mathrm{d}\\varepsilon\n$$\nEvaluating the integral gives:\n$$\ng_f = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\left[ \\varepsilon_f\\varepsilon - \\frac{\\varepsilon^2}{2} \\right]_{\\varepsilon_0}^{\\varepsilon_f} = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\left( \\left(\\varepsilon_f^2 - \\frac{\\varepsilon_f^2}{2}\\right) - \\left(\\varepsilon_f\\varepsilon_0 - \\frac{\\varepsilon_0^2}{2}\\right) \\right)\n$$\n$$\ng_f = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\left( \\frac{\\varepsilon_f^2}{2} - \\varepsilon_f\\varepsilon_0 + \\frac{\\varepsilon_0^2}{2} \\right) = \\frac{\\sigma_0}{2(\\varepsilon_f - \\varepsilon_0)} (\\varepsilon_f^2 - 2\\varepsilon_f\\varepsilon_0 + \\varepsilon_0^2) = \\frac{\\sigma_0}{2(\\varepsilon_f - \\varepsilon_0)} (\\varepsilon_f - \\varepsilon_0)^2\n$$\nThis simplifies to:\n$$\ng_f = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0)\n$$\nThis result is intuitive, as it represents the area of a right triangle with base $(\\varepsilon_f - \\varepsilon_0)$ and height $\\sigma_0$.\n\nNext, we formulate the energy balance. The total energy dissipated per unit cross-sectional area in a localization band of width $\\ell_{\\mathrm{app}}$ is the product of the energy density $g_f$ and the width $\\ell_{\\mathrm{app}}$. This quantity must equal the material fracture energy $G_f$.\n$$\nG_f = g_f \\cdot \\ell_{\\mathrm{app}}\n$$\nSubstituting the expression for $g_f$ and solving for $\\ell_{\\mathrm{app}}$:\n$$\nG_f = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) \\ell_{\\mathrm{app}} \\implies \\ell_{\\mathrm{app}} = \\frac{2 G_f}{\\sigma_0 (\\varepsilon_f - \\varepsilon_0)}\n$$\nUsing the given definition $\\sigma_0 = E \\varepsilon_0$, we arrive at the final expression for the apparent characteristic length:\n$$\n\\ell_{\\mathrm{app}} = \\frac{2 G_f}{E \\varepsilon_0 (\\varepsilon_f - \\varepsilon_0)}\n$$\n\n**Part 2: Derivation of the Influence Metric, $r$**\n\nThe second task is to quantify the regularizing effect of the nonlocal model by computing the dimensionless metric $r$. This requires calculating the nonlocal strain $\\varepsilon_{\\mathrm{nl}}(0)$ at the center of a specified local strain field.\n\nThe nonlocal strain $\\varepsilon_{\\mathrm{nl}}(x)$ is defined by the convolution of the local strain field $\\varepsilon_{\\mathrm{loc}}(\\xi)$ with the weighting kernel $w(|x - \\xi|; \\ell)$:\n$$\n\\varepsilon_{\\mathrm{nl}}(x) = \\int_{-\\infty}^{\\infty} w(|x-\\xi|;\\ell)\\,\\varepsilon_{\\mathrm{loc}}(\\xi)\\, \\mathrm{d}\\xi\n$$\nWe are given a top-hat local strain field centered at $x=0$ with width $\\ell_{\\mathrm{app}}$:\n$$\n\\varepsilon_{\\mathrm{loc}}(\\xi) = \\begin{cases} \\varepsilon_f & \\text{for } |\\xi| \\le \\ell_{\\mathrm{app}}/2 \\\\ \\varepsilon_0 & \\text{for } |\\xi| > \\ell_{\\mathrm{app}}/2 \\end{cases}\n$$\nWe compute the nonlocal strain at the center, $x=0$:\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\int_{-\\infty}^{\\infty} w(|\\xi|;\\ell)\\,\\varepsilon_{\\mathrm{loc}}(\\xi)\\, \\mathrm{d}\\xi\n$$\nWe can rewrite $\\varepsilon_{\\mathrm{loc}}(\\xi)$ as a constant baseline strain $\\varepsilon_0$ plus a perturbation $\\Delta\\varepsilon = \\varepsilon_f - \\varepsilon_0$ over the interval $[-\\ell_{\\mathrm{app}}/2, \\ell_{\\mathrm{app}}/2]$.\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\int_{-\\infty}^{\\infty} w(|\\xi|; \\ell) \\varepsilon_0 \\,d\\xi + \\int_{-\\ell_{\\mathrm{app}}/2}^{\\ell_{\\mathrm{app}}/2} w(|\\xi|; \\ell)(\\varepsilon_f - \\varepsilon_0) \\,d\\xi\n$$\nThe kernel $w(r;\\ell) = \\frac{1}{2\\ell} \\exp(-|r|/\\ell)$ is normalized, meaning $\\int_{-\\infty}^{\\infty} w(|\\xi|;\\ell) \\,d\\xi = 1$. Therefore, the first term evaluates to $\\varepsilon_0$.\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\varepsilon_0 + (\\varepsilon_f - \\varepsilon_0) \\int_{-\\ell_{\\mathrm{app}}/2}^{\\ell_{\\mathrm{app}}/2} \\frac{1}{2\\ell} \\exp\\left(-\\frac{|\\xi|}{\\ell}\\right) \\, \\mathrm{d}\\xi\n$$\nThe integrand is an even function, so we can simplify the integral:\n$$\n\\int_{-\\ell_{\\mathrm{app}}/2}^{\\ell_{\\mathrm{app}}/2} \\frac{1}{2\\ell} e^{-|\\xi|/\\ell} \\, \\mathrm{d}\\xi = 2 \\int_{0}^{\\ell_{\\mathrm{app}}/2} \\frac{1}{2\\ell} e^{-\\xi/\\ell} \\, \\mathrm{d}\\xi = \\frac{1}{\\ell} \\left[-\\ell e^{-\\xi/\\ell}\\right]_{0}^{\\ell_{\\mathrm{app}}/2}\n$$\n$$\n= -\\left(e^{-\\ell_{\\mathrm{app}}/(2\\ell)} - e^0\\right) = 1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\n$$\nSubstituting this back into the expression for $\\varepsilon_{\\mathrm{nl}}(0)$:\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\varepsilon_0 + (\\varepsilon_f - \\varepsilon_0) \\left(1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\\right)\n$$\nThe influence metric $r$ is defined as the normalized nonlocal strain increase at the center:\n$$\nr = \\frac{\\varepsilon_{\\mathrm{nl}}(0) - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0}\n$$\nSubstituting our result for $\\varepsilon_{\\mathrm{nl}}(0)$:\n$$\nr = \\frac{\\left[ \\varepsilon_0 + (\\varepsilon_f - \\varepsilon_0) \\left(1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\\right) \\right] - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} = 1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\n$$\nFinally, the problem states that the macroscopic kernel length $\\ell$ is related to the apparent characteristic length $\\ell_{\\mathrm{app}}$ by a scaling factor $c > 0$, such that $\\ell = c\\,\\ell_{\\mathrm{app}}$. Substituting this relation into the expression for $r$:\n$$\nr = 1 - \\exp\\left(-\\frac{\\ell_{\\mathrm{app}}}{2(c\\,\\ell_{\\mathrm{app}})}\\right) = 1 - e^{-1/(2c)}\n$$\nThis elegant result shows that the influence metric $r$ depends only on the dimensionless ratio $c$ of the two characteristic lengths.\n\n**Summary of Formulas for Implementation:**\nThe two final formulas to be implemented are:\n1.  Apparent characteristic length: $\\ell_{\\mathrm{app}} = \\frac{2 G_f}{E \\varepsilon_0 (\\varepsilon_f - \\varepsilon_0)}$\n2.  Influence metric: $r = 1 - e^{-1/(2c)}$\n\nThese formulas will be used to compute the required pairs $[\\ell_{\\mathrm{app}}, r]$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the apparent characteristic length (l_app) and a dimensionless\n    influence metric (r) for a nonlocal damage model based on several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E, eps0, epsf, Gf, c)\n    # E: Young's Modulus (Pa)\n    # eps0: Strain at damage initiation (dimensionless)\n    # epsf: Strain at complete failure (dimensionless)\n    # Gf: Fracture energy per unit area (N/m)\n    # c: Nonlocal length scale multiplier (dimensionless)\n    test_cases = [\n        # Case A\n        (50e9, 0.002, 0.02, 1200, 1.0),\n        # Case B\n        (70e9, 0.0015, 0.004, 250, 0.25),\n        # Case C\n        (30e9, 0.002, 0.0024, 800, 1.5),\n        # Case D\n        (40e9, 0.0025, 0.015, 5000, 2.0),\n    ]\n\n    results = []\n    for E, eps0, epsf, Gf, c in test_cases:\n        # Task 1: Calculate the apparent characteristic length, l_app.\n        # Formula: l_app = (2 * Gf) / (E * eps0 * (epsf - eps0))\n        # This is derived from equating the fracture energy Gf to the energy\n        # dissipated in a localization band of width l_app.\n        denominator_l_app = E * eps0 * (epsf - eps0)\n        if denominator_l_app == 0:\n            # Avoid division by zero, though problem constraints ensure epsf > eps0.\n            l_app = float('inf')\n        else:\n            l_app = (2 * Gf) / denominator_l_app\n\n        # Task 2: Calculate the dimensionless influence metric, r.\n        # Formula: r = 1 - exp(-1 / (2 * c))\n        # This metric quantifies the smoothing effect of the nonlocal kernel.\n        if c <= 0:\n            # Avoid division by zero and invalid input for c.\n            r = float('nan')\n        else:\n            r = 1 - np.exp(-1 / (2 * c))\n\n        # Round both results to six decimal places as required.\n        l_app_rounded = round(l_app, 6)\n        r_rounded = round(r, 6)\n\n        results.append([l_app_rounded, r_rounded])\n\n    # Final print statement in the exact required format.\n    # The format is [[l_app_A,r_A],[l_app_B,r_B],[l_app_C,r_C],[l_app_D,r_D]]\n    # Using str.replace to remove spaces for precise formatting.\n    # Example: str([[1.0, 2.0]]) becomes '[[1.0, 2.0]]'\n    # .replace(' ', '') makes it '[[1.0,2.0]]'\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}