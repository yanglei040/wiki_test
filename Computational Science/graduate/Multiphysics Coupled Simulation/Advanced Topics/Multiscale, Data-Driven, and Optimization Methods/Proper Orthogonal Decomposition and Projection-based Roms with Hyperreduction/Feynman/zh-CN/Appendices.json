{
    "hands_on_practices": [
        {
            "introduction": "在处理大规模多物理场问题时，通过对庞大的快照矩阵进行完全的奇异值分解（SVD）来计算POD基底往往是不可行的。随机算法为此提供了一种高效的替代方案。本练习  旨在引导您分析一种先进的、用于加权POD的随机化范围探测器（randomized range-finder）算法，重点是理解其在给定加权范数下的实现逻辑、误差界限和计算成本。",
            "id": "3524059",
            "problem": "在基于投影的多物理场降阶建模中，关于对称正定（SPD）质量矩阵的固有正交分解（POD）基底源自加权快照算子的左奇异向量。设空间质量矩阵为一个 SPD 矩阵 $M \\in \\mathbb{R}^{N \\times N}$，它定义了加权内积 $\\langle u, v \\rangle_M = u^{\\top} M v$ 和诱导范数 $\\|u\\|_M = \\sqrt{u^{\\top} M u}$。给定一个快照矩阵 $X \\in \\mathbb{R}^{N \\times S}$，该矩阵由一个具有 $N$ 个自由度的耦合多物理场模拟的 $S$ 个状态快照组成，维度为 $r$ 的 POD 子空间是在 $M$-范数下最小化 $X$ 的投影误差的 $M$-正交子空间。该最小化器可以通过 $A = M^{1/2} X \\in \\mathbb{R}^{N \\times S}$ 的左奇异向量来表征，其中 $M^{1/2}$ 表示 $M$ 的主平方根。\n\n考虑设计一个离线随机化值域探测器，用以逼近 $A = M^{1/2} X$ 的前 $r$ 个左奇异向量，并给出一个有理论依据的误差界，同时评估其离线计算成本关于 $N$、$S$ 以及目标秩和过采样参数的标度关系。请选择一个选项，该选项正确地概述了这样一种算法，陈述了关于 $A$ 的奇异值的有效非渐近谱范数误差界，并提供了在稀疏矩阵 $M$（其中 $\\mathrm{nnz}(M) = \\Theta(N)$）条件下主要离线成本的标度关系。\n\nA. 抽取一个过采样 $p \\ge 2$ 的高斯测试矩阵 $\\Omega \\in \\mathbb{R}^{S \\times (r+p)}$。构造 $Z = X \\Omega \\in \\mathbb{R}^{N \\times (r+p)}$。计算 $Z$ 的一个 $M$-加权瘦QR分解，得到 $Q \\in \\mathbb{R}^{N \\times (r+p)}$，满足 $Q^{\\top} M Q = I$ 和 $\\mathrm{range}(Q) = \\mathrm{range}(Z)$。构造 $B = Q^{\\top} M X \\in \\mathbb{R}^{(r+p) \\times S}$ 并计算其奇异值分解（SVD），$B = \\widehat{U} \\Sigma V^{\\top}$。$A$ 的前 $r$ 个左奇异向量的近似值是 $U_{\\mathrm{approx}} = Q \\widehat{U} \\in \\mathbb{R}^{N \\times (r+p)}$ 的前 $r$ 列，这些向量是 $M$-正交的。如果 $A = M^{1/2} X$ 的奇异值为 $\\{\\sigma_j(A)\\}_{j=1}^{\\min(N,S)}$，那么对于高斯矩阵 $\\Omega$ 和 $p \\ge 2$，值域探测器投影算子的期望谱范数误差满足\n$$\n\\mathbb{E} \\big\\| A - \\big(M^{1/2} Q Q^{\\top} M^{1/2}\\big) A \\big\\|_{2} \\;\\le\\; \\Big(1 + 4 \\sqrt{\\tfrac{r}{p-1}}\\Big)\\,\\sigma_{r+1}(A) \\;+\\; \\frac{e \\sqrt{r+p}}{p}\\,\\Big(\\sum_{j>r} \\sigma_j^2(A)\\Big)^{1/2}.\n$$\n主要离线成本的标度如下\n$$\n\\mathcal{O}\\big(N S (r+p)\\big) \\;+\\; \\mathcal{O}\\big(\\mathrm{nnz}(M)\\,(r+p)^2\\big) \\;+\\; \\mathcal{O}\\big(\\mathrm{nnz}(M)\\,S\\,(r+p)\\big) \\;+\\; \\mathcal{O}\\big(S\\,(r+p)^2\\big),\n$$\n因此，对于稀疏矩阵 $M$ 且 $\\mathrm{nnz}(M)=\\Theta(N)$，总的主导项是 $\\mathcal{O}\\big(N S (r+p)\\big)$。\n\nB. 抽取一个高斯测试矩阵 $\\Omega \\in \\mathbb{R}^{N \\times (r+p)}$ 并构造 $Y = \\Omega^{\\top} M^{1/2} X \\in \\mathbb{R}^{(r+p) \\times S}$。计算一个瘦QR分解 $Y = \\widetilde{Q} R$，满足 $\\widetilde{Q}^{\\top} \\widetilde{Q} = I$，然后将 $X$ 投影为 $X_{\\mathrm{proj}} = \\widetilde{Q}^{\\top} X$ 并计算其SVD以提取 $X$ 的 $r$ 个左奇异向量。谱范数误差满足 $\\|A - \\widetilde{Q} \\widetilde{Q}^{\\top} A\\|_{2} \\le \\sigma_r(A)$，其概率至少为 $1 - e^{-(r+p)}$。离线成本为 $\\mathcal{O}\\big(N (r+p) S\\big)$，且不额外依赖于 $M$。\n\nC. 抽取一个高斯测试矩阵 $\\Omega \\in \\mathbb{R}^{S \\times (r+p)}$，构造 $Z = X \\Omega$，计算一个非加权的瘦QR分解 $Z = Q R$，满足 $Q^{\\top} Q = I$，然后构造 $B = Q^{\\top} X$ 并计算其SVD以得到 $U_{\\mathrm{approx}} = Q \\widehat{U}_{[:,1:r]}$。该近似方法旨在求取 $X$ 的前导左奇异向量，对于任何SPD矩阵 $M$，这些向量都与 $M^{1/2} X$ 的左奇异向量重合。期望谱范数误差由 $\\sigma_{r+1}(X)$ 的一个倍数作为界，离线成本为 $\\mathcal{O}\\big(N S (r+p) + S (r+p)^2\\big)$。\n\nD. 使用幂迭代，通过构造 $Y = (X X^{\\top})^{q} X \\Omega$（其中 $q \\ge 1$ 为某个小整数），然后计算 $Y$ 的非加权QR分解得到 $Q$，接着继续计算 $B = Q^{\\top} X$ 及其SVD以获得 $U_{\\mathrm{approx}}$。谱范数误差几乎必然服从 $\\|A - Q Q^{\\top} A\\|_{2} \\le \\big(\\sigma_{r+1}(A)/\\sigma_{1}(A)\\big)^{2q+1}$。离线成本与不使用幂迭代时相同，因为 $(X X^{\\top})^{q}$ 可以在成本为 $\\mathcal{O}\\big(N^2\\big)$ 且与 $S$ 无关的情况下预计算一次并重复使用。",
            "solution": "用户要求对问题陈述进行严格验证，然后推导解决方案，并对所有提供的选项进行详细评估。\n\n### 步骤1：提取已知条件\n- **背景**：用于多物理场模拟的基于投影的降阶建模（ROM）。\n- **方法**：固有正交分解（POD）。\n- **质量矩阵**：$M \\in \\mathbb{R}^{N \\times N}$ 是一个对称正定（SPD）矩阵。\n- **加权内积**：$\\langle u, v \\rangle_M = u^{\\top} M v$。\n- **加权范数**：$\\|u\\|_M = \\sqrt{u^{\\top} M u}$。\n- **快照数据**：一个矩阵 $X \\in \\mathbb{R}^{N \\times S}$ 包含 $S$ 个状态快照，每个快照有 $N$ 个自由度。\n- **POD的目标**：找到一个维度为 $r$ 的 $M$-正交子空间，该子空间在 $M$-范数度量下最小化 $X$ 中快照的投影误差。\n- **理论基础**：这个最优子空间与加权快照算子 $A = M^{1/2} X \\in \\mathbb{R}^{N \\times S}$ 的前导左奇异向量相关，其中 $M^{1/2}$ 是 $M$ 的主平方根。\n- **任务**：选择一个选项，该选项正确描述了一种用于逼近 $A$ 的前 $r$ 个左奇异向量的随机化值域探测算法，提供了一个有效的误差界，并给出了在 $M$ 是稀疏矩阵且 $\\mathrm{nnz}(M) = \\Theta(N)$ 的假设下，正确的主要离线计算成本标度。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题在模型降阶理论中有坚实的基础。对有限元法离散化的系统，使用由质量矩阵定义的加权内积是标准做法。将POD问题表述为加权快照矩阵 $A = M^{1/2} X$ 的SVD是正确的。使用随机算法来逼近大规模问题的SVD是数值线性代数中的前沿技术。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。它要求从一组选项中识别出对一个算法、其误差界及其计算成本的正确描述。这是一个清晰且可回答的问题。\n3.  **客观性**：问题陈述使用了数值线性代数和模型降阶领域中精确、客观和标准的术语。没有主观或模棱两可的陈述。\n4.  **缺陷检查**：该问题未违反任何无效性标准。它在科学上是合理的、形式化的、完整的、现实的和适定的。数量 $N$、$S$、$r$ 和过采样参数 $p$ 在此背景下都是标准的。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。现在开始求解过程。\n\n### 基于原理的推导与选项分析\n\n核心任务是找到矩阵 $A = M^{1/2}X$ 的一个低秩近似。具体来说，我们想为一个子空间找到一个标准正交基，该子空间能捕捉到 $A$ 的大部分作用。对于一个矩阵 $A$，标准的随机化值域探测算法按以下步骤进行：\n1.  生成一个随机测试矩阵 $\\Omega \\in \\mathbb{R}^{S \\times (r+p)}$。\n2.  构造一个样本矩阵 $Y = A \\Omega = M^{1/2} X \\Omega$。$Y$ 的列是 $A$ 的值域中的随机样本。\n3.  为 $Y$ 的列所张成的子空间找到一个标准正交基。这通常通过计算 $Y$ 的瘦QR分解来完成，得到 $Y=QR$。$Q \\in \\mathbb{R}^{N \\times (r+p)}$ 的列构成了这个基。\n\n直接实现这个算法的计算成本很高，因为它需要计算 $M^{1/2}$，而 $M^{1/2}$ 通常是一个 $N \\times N$ 的稠密矩阵，计算成本（$\\mathcal{O}(N^3)$）和应用成本（$\\mathcal{O}(N^2)$）都很高。一个实用的算法必须避免构造或应用 $M^{1/2}$。\n\n一个高效算法的关键洞见在于，$\\mathrm{range}(M^{1/2}X\\Omega)$ 的一个标准正交基可以从 $\\mathrm{range}(X\\Omega)$ 的一个 $M$-正交基构造出来。设 $Z = X\\Omega$。如果我们找到一个矩阵 $Q \\in \\mathbb{R}^{N \\times (r+p)}$，其列构成了 $\\mathrm{range}(Z)$ 的一个 $M$-正交基（即 $Q^\\top M Q = I$），那么矩阵 $Q_{std} = M^{1/2}Q$ 将具有标准正交列，因为 $Q_{std}^\\top Q_{std} = (M^{1/2}Q)^\\top(M^{1/2}Q) = Q^\\top M Q = I$。此外，$Q_{std}$ 的值域是 $\\mathrm{range}(M^{1/2}Q) = \\mathrm{range}(M^{1/2}Z) = \\mathrm{range}(M^{1/2}X\\Omega)$，这正是我们寻求的采样子空间。一个 $M$-正交基可以通过使用内积 $\\langle u, v \\rangle_M = u^\\top M v$ 的修正格拉姆-施密特过程来高效计算，这只需要与 $M$ 进行稀疏矩阵-向量乘积。\n\n一旦找到基 $Q$（其列是 $M$-正交的），原始矩阵 $A = M^{1/2}X$ 就被投影到由 $M^{1/2}Q$ 的列张成的子空间上。投影后的矩阵是 $B = (M^{1/2}Q)^\\top (M^{1/2}X) = Q^\\top M X$。然后对这个较小的矩阵 $B$ 进行标准的SVD分解。如果 $B = \\widehat{U}\\Sigma V^\\top$，那么 $A$ 的近似左奇异向量由 $(M^{1/2}Q)\\widehat{U}$ 给出。相应的POD基向量是 $M$-正交的，即 $U_{\\text{approx}} = Q\\widehat{U}$。\n\n现在我们基于这一理解来评估每个选项。\n\n---\n**选项A评估**\n\n- **算法描述**：\n  1. `抽取一个高斯测试矩阵 Ω ∈ R^{S × (r+p)}`。正确。\n  2. `构造 Z = X Ω`。此步骤正确地避免了使用 $M^{1/2}$，并从 $X$ 的列空间中采样。\n  3. `计算 Z 的一个 M-加权瘦QR分解，得到 Q ∈ R^{N × (r+p)} 且 Qᵀ M Q = I 和 range(Q) = range(Z)`。这是找到采样子空间的 $M$-正交基的正确且高效的程序，如上所述。\n  4. `构造 B = Qᵀ M X`。这是将数据投影到降维基上的正确公式，对应于 $(M^{1/2}Q)^\\top (M^{1/2}X)$。\n  5. `计算其SVD，B = widehat{U} Σ Vᵀ`。正确。\n  6. `$U_{\\mathrm{approx}} = Q \\widehat{U}$... 是 $M$-正交的`。这正确地构造了近似的POD基向量。它们的 $M$-正交性源于 $(Q\\widehat{U})^\\top M (Q\\widehat{U}) = \\widehat{U}^\\top (Q^\\top M Q) \\widehat{U} = \\widehat{U}^\\top I \\widehat{U} = I$。\n  所描述的算法是正确的。\n\n- **误差界**：提供的界是\n  $$ \\mathbb{E} \\big\\| A - \\big(M^{1/2} Q Q^{\\top} M^{1/2}\\big) A \\big\\|_{2} \\;\\le\\; \\Big(1 + 4 \\sqrt{\\tfrac{r}{p-1}}\\Big)\\,\\sigma_{r+1}(A) \\;+\\; \\frac{e \\sqrt{r+p}}{p}\\,\\Big(\\sum_{j>r} \\sigma_j^2(A)\\Big)^{1/2}. $$\n  这是文献中（例如，Halko、Martinsson 和 Tropp 的研究）已确立的使用高斯测试矩阵的随机化值域探测器的一类已知误差界。投影算子是 $P = M^{1/2} Q Q^{\\top} M^{1/2}$，它投影到 $\\mathrm{range}(M^{1/2}Q)$ 上。该界正确地依赖于第一个被忽略的奇异值 $\\sigma_{r+1}(A)$ 和尾部奇异值 $\\sum_{j>r} \\sigma_j^2(A)$。常数以及对 $r$ 和 $p$ 的依赖关系都是标准的。所述的界是有效的。\n\n- **成本标度**：\n  1. $Z = X\\Omega$：成本为 $\\mathcal{O}(N S (r+p))$。\n  2. $Z$ 的 $M$-加权QR分解：修正格拉姆-施密特需要 $\\mathcal{O}((r+p)^2)$ 次 $M$-内积的应用。每个内积 $\\langle u,v \\rangle_M$ 的成本为 $\\mathcal{O}(\\mathrm{nnz}(M))$。总成本：$\\mathcal{O}(\\mathrm{nnz}(M)(r+p)^2)$。\n  3. $B=Q^\\top M X$：这可以计算为 $Q^\\top(MX)$。$MX$ 的成本为 $\\mathcal{O}(\\mathrm{nnz}(M)S)$。与 $Q^\\top$ 的乘法成本为 $\\mathcal{O}(N S(r+p))$。总成本由 $\\mathcal{O}(N S(r+p))$ 主导。\n  4. $B \\in \\mathbb{R}^{(r+p) \\times S}$ 的SVD分解：$\\mathcal{O}(S(r+p)^2 + S^2(r+p))$。\n  5. $U_{\\mathrm{approx}}=Q\\widehat{U}$：$\\mathcal{O}(N(r+p)^2)$。\n  假设 $N \\gg S \\ge r+p$，主导成本项是 $\\mathcal{O}(N S (r+p))$。该选项的最终结论，`总的主导项是 O(N S (r+p))`，是正确的。尽管总和中的具体分项表述得令人困惑，但最重要的组成部分和最终的主导标度是正确的。\n\n**结论**：**正确**。\n\n---\n**选项B评估**\n\n- **算法描述**：该算法构造 $Y=\\Omega^\\top M^{1/2}X$，其中 $\\Omega \\in \\mathbb{R}^{N \\times (r+p)}$。这需要应用 $M^{1/2}$，而这正是高效随机算法试图避免的。这使得该方法不切实际。此外，这种“行采样”方法通常用于逼近右奇异向量，而不是题目要求的左奇异向量。后续步骤在概念上是混乱的，将 $X$ 的投影与 $A$ 的性质混为一谈。\n- **误差界**：界 $\\|A - \\tilde{Q} \\tilde{Q}^{\\top} A\\|_{2} \\le \\sigma_r(A)$ 是不正确的。Eckart-Young 定理指出*最佳*秩-$r$ 近似的误差是 $\\sigma_{r+1}(A)$，而不是 $\\sigma_r(A)$。随机算法具有概率界，通常大于这个最优误差。\n- **成本标度**：声称的成本 $\\mathcal{O}(N (r+p) S)$ 完全忽略了构造或应用 $M^{1/2}$ 的主要成本，该成本至少为 $\\mathcal{O}(N^2 S)$。\n\n**结论**：**不正确**。\n\n---\n**选项C评估**\n\n- **算法描述**：该选项提出了一个`非加权的瘦QR分解`。这计算的是非加权问题（即 $M=I$）的基。\n- **科学前提**：陈述`该近似方法旨在求取 X 的前导左奇异向量，对于任何SPD矩阵 M，这些向量都与 M^{1/2} X 的左奇异向量重合`是根本错误的。$X$ 的左奇异向量是 $XX^\\top$ 的特征向量。$A=M^{1/2}X$ 的左奇异向量是 $AA^\\top = M^{1/2}XX^\\top M^{1/2}$ 的特征向量。只有当 $M$ 与 $XX^\\top$ 可交换时，这两者才相同，而这在一般情况下是不成立的。该选项的整个前提都基于一个科学谬误。\n- **误差界和成本**：由于该方法针对的是错误的目标，因此关于逼近 $A$ 的奇异向量的误差界和成本分析是无关紧要且不正确的。\n\n**结论**：**不正确**。\n\n---\n**选项D评估**\n\n- **算法描述**：该选项描述了幂迭代，一种通过放大奇异值衰减来提高准确性的方法。然而，它构造了 $Y = (XX^\\top)^q X \\Omega$，这是用于*非加权*问题（$M=I$）的幂迭代方案。对于 $A=M^{1/2}X$ 的正确方案应涉及 $A A^\\top = M^{1/2} X X^\\top M^{1/2}$，但这并非此处所用。该方法对于所述问题是不正确的。\n- **误差界**：该界是为矩阵 $A$ 给出的，但算法是为矩阵 $X$ 设计的。该界的格式也是一种过分简化，而不是一个严谨的陈述。\n- **成本标度**：声称` (X Xᵀ)q 可以在成本为 O(N²) 且与 S 无关的情况下预计算一次并重复使用`是严重错误的。矩阵乘积 $XX^\\top$ 的成本为 $\\mathcal{O}(N^2 S)$。将这个 $N \\times N$ 矩阵自乘 $q$ 次的成本为 $\\mathcal{O}(q N^3)$。这个成本是巨大的，并且依赖于 $S$。\n\n**结论**：**不正确**。\n\n---\n**最终结论**\n选项A正确地描述了用于计算加权POD的现代、计算高效的随机算法。它通过使用 $M$-加权正交化过程避免了构造矩阵平方根 $M^{1/2}$。误差界的形式与文献中发现的正确形式一致，并且对主要计算成本的分析也是正确的。选项B、C和D在其算法描述、科学推理或成本分析中包含根本性错误。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "获得降阶基底后，下一步是将高维控制方程投影到该基底上。存在多种投影方法，它们具有不同的稳定性和精度特性。本练习  提供了两种关键投影方法——经典的伽辽金（Galerkin）投影和最小二乘彼得罗夫-伽辽金（LSPG）方法——之间的直接动手比较，通过一个具体的计算来阐明它们的理论关系和实际差异。",
            "id": "3524021",
            "problem": "考虑一个通过耦合控制律的空间离散化得到的半离散多物理场系统，由 $M \\frac{d y}{d t} = f(y,t)$ 给出，其中 $y \\in \\mathbb{R}^{N}$ 是状态向量，$M \\in \\mathbb{R}^{N \\times N}$ 是一个对称正定质量矩阵，而 $f : \\mathbb{R}^{N} \\times \\mathbb{R} \\to \\mathbb{R}^{N}$ 是一个代表耦合物理场的充分光滑的右端项。设通过本征正交分解（Proper Orthogonal Decomposition, POD）构建一个降阶模型（reduced-order model, ROM），得到一个 $M$-正交标准试验基 $\\Phi \\in \\mathbb{R}^{N \\times r}$，满足 $\\Phi^{\\top} M \\Phi = I_{r}$，其中 $I_{r}$ 是 $r \\times r$ 的单位矩阵。ROM 状态参数化为 $y \\approx y_{\\mathrm{ref}} + \\Phi a$，其中 $a \\in \\mathbb{R}^{r}$ 是降阶坐标，$y_{\\mathrm{ref}}$ 是一个参考状态。\n\nGalerkin 投影强制要求连续残差与试验空间在 $M$-内积意义下正交，而最小二乘 Petrov-Galerkin (LSPG) 方法则在加权最小二乘意义下强制要求时间离散残差的最优性，可能通过一个采样和加权算子 $W \\in \\mathbb{R}^{s \\times N}$（其中 $s \\le N$）进行超简化。使用时间步长为 $\\Delta t$ 的后向欧拉法来定义在时间 $t_{n}$ 的离散残差 $r_{n}(y_{n}) = M (y_{n} - y_{n-1}) - \\Delta t\\, f(y_{n}, t_{n})$。\n\n任务：\n1) 从上述定义和投影的第一性原理出发，推导加权和雅可比矩阵需要满足的代数条件，使得 LSPG 方法的一阶最优性条件（使用后向欧拉法和超简化）能精确地退化为相同时间离散化下的 Galerkin 正交性条件。将该条件表示为一个包含 $W$、$M$、雅可比矩阵 $J_{f}(y_{n}) = \\frac{\\partial f}{\\partial y}(y_{n}, t_{n})$ 和试验基 $\\Phi$ 的单个矩阵等式。\n\n2) 构造一个具体例子，展示在相同的后向欧拉时间步长下，Galerkin 和 LSPG 方法之间的差异。设 $N = 2$, $M = I_{2}$, $f(y) = A y$ 其中 $A = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$, $\\Delta t = 1$, $y_{\\mathrm{ref}} = 0$, $y_{n-1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，以及 $\\Phi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。对于 LSPG，取 $W = I_{2}$（无超简化）。计算由 Galerkin 和 LSPG 生成的单步后向欧拉更新，然后计算在时间 $t_{n}$ 时这两个 ROM 更新之间差的欧几里得范数。\n\n答案规格：\n- 将最终答案表示为指定示例中 LSPG 和 Galerkin 单步更新之间差的精确欧几里得范数。\n- 无需四舍五入。\n- 最终答案必须是单个实数。",
            "solution": "此问题包含两部分。第一部分要求推导一个条件，在该条件下，最小二乘 Petrov-Galerkin (LSPG) 方法等价于 Galerkin 投影方法。第二部分要求使用两种方法计算特定系统的单步更新，并求其差的范数。\n\n第 1 部分：等价条件的推导\n\n在时间 $t_n$ 时，降阶模型 (ROM) 的状态近似为 $y_n = y_{\\mathrm{ref}} + \\Phi a_n$，其中 $a_n \\in \\mathbb{R}^r$ 是降阶坐标。控制方程 $M \\frac{dy}{dt} = f(y,t)$ 的后向欧拉时间离散化导致在步骤 $n$ 处的全阶离散残差的定义：\n$$\nr_n(y_n) = M (y_n - y_{n-1}) - \\Delta t\\, f(y_n, t_n)\n$$\nGalerkin 和 LSPG 方法都构建一个方程组来求解未知的降阶坐标 $a_n$。\n\nGalerkin 方法强制要求残差 $r_n(y_n)$ 在欧几里得内积下与试验子空间 $\\text{span}(\\Phi)$ 正交。这表示为：\n$$\n\\Phi^{\\top} r_n(y_n(a_n)) = 0\n$$\n这是一个关于 $a_n$ 的 $r$ 个分量的 $r$ 个非线性方程组。该条件由 $\\Phi^{\\top}[M(\\Phi a_n - \\Phi a_{n-1} + y_{\\mathrm{ref}} - y_{n-1}) - \\Delta t f(y_{\\mathrm{ref}}+\\Phi a_n, t_n)]=0$ 以及 $M$-正交标准性条件 $\\Phi^{\\top}M\\Phi = I_r$ 推导得出，后者将 $\\Phi^{\\top}M\\Phi(a_n-a_{n-1})$ 简化为 $a_n-a_{n-1}$。这回到了标准公式 $\\frac{a_n - a_{n-1}}{\\Delta t} = \\Phi^\\top f(y_n,t_n)$，它等价于 $\\Phi^\\top r_n(y_n)=0$。\n\nLSPG 方法旨在找到使残差的加权平方范数最小化的降阶坐标 $a_n$，可能带有超简化。目标函数是：\n$$\nJ_{\\text{LSPG}}(a_n) = \\frac{1}{2} \\| W r_n(y_n(a_n)) \\|_2^2 = \\frac{1}{2} r_n(y_n(a_n))^{\\top} W^{\\top} W r_n(y_n(a_n))\n$$\n一阶最优性条件是 $J_{\\text{LSPG}}$ 相对于 $a_n$ 的梯度为零：\n$$\n\\frac{\\partial J_{\\text{LSPG}}}{\\partial a_n} = 0\n$$\n使用链式法则，该梯度为：\n$$\n\\frac{\\partial J_{\\text{LSPG}}}{\\partial a_n} = \\left(\\frac{\\partial y_n}{\\partial a_n}\\right)^{\\top} \\left(\\frac{\\partial r_n}{\\partial y_n}\\right)^{\\top} W^{\\top} W r_n(y_n)\n$$\n我们有以下导数：\n$\\frac{\\partial y_n}{\\partial a_n} = \\Phi$\n$\\frac{\\partial r_n}{\\partial y_n} = M - \\Delta t \\frac{\\partial f}{\\partial y}(y_n, t_n) = M - \\Delta t J_f(y_n)$\n将这些代入最优性条件，得到 $a_n$ 的 LSPG 非线性系统：\n$$\n\\Phi^{\\top} (M - \\Delta t J_f(y_n))^{\\top} W^{\\top} W r_n(y_n(a_n)) = 0\n$$\n为了使 LSPG 的一阶最优性条件精确地退化为 Galerkin 的正交性条件，这两个方程组必须是等价的。也就是说，对于任何残差向量 $r_n$，以下等价关系必须成立：\n$$\n\\Phi^{\\top} (M - \\Delta t J_f)^{\\top} W^{\\top} W r_n = 0 \\iff \\Phi^{\\top} r_n = 0\n$$\n此等价性成立当且仅当左边算子的行空间与右边算子的行空间相同。这意味着必须存在一个可逆矩阵 $C \\in \\mathbb{R}^{r \\times r}$ 使得：\n$$\n\\Phi^{\\top} (M - \\Delta t J_f)^{\\top} W^{\\top} W = C \\Phi^{\\top}\n$$\n对两边进行转置（并注意 $W^{\\top}W$ 是对称的）得到：\n$$\n(W^{\\top} W (M - \\Delta t J_f) \\Phi)^{\\top} = (\\Phi C^{\\top})^{\\top}\n$$\n$$\nW^{\\top} W (M - \\Delta t J_f) \\Phi = \\Phi C^{\\top}\n$$\n令 $K = C^{\\top}$，它也是一个 $\\mathbb{R}^{r \\times r}$ 中的可逆矩阵。条件是存在一个可逆矩阵 $K$ 使得：\n$$\nW^{\\top} W (M - \\Delta t J_f) \\Phi = \\Phi K\n$$\n该方程表明，由 $\\Phi$ 的列向量张成的子空间，记为 $\\text{span}(\\Phi)$，必须是算子 $W^{\\top} W (M - \\Delta t J_f)$ 的一个不变子空间。$K$ 的可逆性确保了该映射不会压缩子空间的维度，从而保持方程组的等价性。\n\n第 2 部分：具体示例计算\n\n给定以下参数：\n$N=2$, $M=I_2$, $\\Delta t=1$, $y_{\\mathrm{ref}}=0$, $W=I_2$。\n$f(y) = Ay$ 其中 $A = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$。\n$y_{n-1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n$\\Phi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n由于 $r=1$，降阶坐标 $a_n$ 是一个标量。ROM 状态是 $y_n = \\Phi a_n = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} a_n = \\begin{pmatrix} a_n \\\\ 0 \\end{pmatrix}$。\n首先，我们计算残差 $r_n(y_n)$：\n$$\nr_n(a_n) = M(y_n - y_{n-1}) - \\Delta t f(y_n) = I_2 \\left( \\begin{pmatrix} a_n \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right) - (1) \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} a_n \\\\ 0 \\end{pmatrix}\n$$\n$$\nr_n(a_n) = \\begin{pmatrix} a_n \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ a_n \\end{pmatrix} = \\begin{pmatrix} a_n \\\\ -1-a_n \\end{pmatrix}\n$$\n\nGalerkin 更新：\nGalerkin 条件是 $\\Phi^{\\top} r_n = 0$：\n$$\n\\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} a_n \\\\ -1-a_n \\end{pmatrix} = 0 \\implies a_n^G = 0\n$$\nGalerkin 状态更新为 $y_n^G = \\Phi a_n^G = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (0) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\nLSPG 更新：\nLSPG 条件是 $\\Phi^{\\top} (M - \\Delta t J_f)^{\\top} W^{\\top} W r_n = 0$。\n由于 $f(y)=Ay$ 是线性的，雅可比矩阵是常数： $J_f = A = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$。\n在 $M=I_2$, $\\Delta t=1$ 和 $W=I_2$ 的情况下，条件变为 $\\Phi^{\\top} (I_2 - A)^{\\top} r_n = 0$。\n算子项是：\n$$\nI_2 - A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ -1  1 \\end{pmatrix}\n$$\n$$\n(I_2 - A)^{\\top} = \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix}\n$$\n作用于残差的完整 LSPG 算子是：\n$$\n\\Phi^{\\top} (I_2 - A)^{\\top} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  -1 \\end{pmatrix}\n$$\n因此 LSPG 方程为：\n$$\n\\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} a_n \\\\ -1-a_n \\end{pmatrix} = 0\n$$\n$$\na_n - (-1-a_n) = 0 \\implies a_n + 1 + a_n = 0 \\implies 2a_n = -1 \\implies a_n^L = -\\frac{1}{2}\n$$\nLSPG 状态更新为 $y_n^L = \\Phi a_n^L = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\left(-\\frac{1}{2}\\right) = \\begin{pmatrix} -1/2 \\\\ 0 \\end{pmatrix}$。\n\n更新之间的差异：\nLSPG 和 Galerkin 更新之间的差向量是：\n$$\ny_n^L - y_n^G = \\begin{pmatrix} -1/2 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 0 \\end{pmatrix}\n$$\n该差的欧几里得范数是：\n$$\n\\| y_n^L - y_n^G \\|_2 = \\sqrt{\\left(-\\frac{1}{2}\\right)^2 + 0^2} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2}\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "对于非线性问题，仅有投影不足以创建高效的降阶模型，因为非线性项的计算开销仍然依赖于全阶模型规模。超降阶是解决此瓶颈的关键步骤。本练习  提供了一个使用离散经验插值方法（DEIM）逐步推导超降阶残差的详细过程，从第一性原理出发构建最终公式，从而让您清晰地掌握其背后的力学机制。",
            "id": "3524024",
            "problem": "考虑一个半离散多物理场系统，该系统是通过将直线法应用于带有代数约束的耦合偏微分方程得到的。令状态为 $u(t) \\in \\mathbb{R}^{N}$ 并定义残差\n$$\nR(u,\\dot{u},t) := M(u)\\,\\dot{u} - f(u) - A\\,u - b(t),\n$$\n其中 $M(u) \\in \\mathbb{R}^{N \\times N}$ 是一个可能与状态相关的质量/电容/惯性算子，由耦合产生；$f(u) \\in \\mathbb{R}^{N}$ 是一个非线性的状态相关项，聚合了通量、反应和场间耦合效应；$A \\in \\mathbb{R}^{N \\times N}$ 是一个已知的线性算子；$b(t) \\in \\mathbb{R}^{N}$ 是一个已知的强迫项。令时间网格为 $t^{n} = t^{0} + n\\,\\Delta t$，时间步长 $\\Delta t > 0$ 为常数。\n\n令时间导数由 k 步后向差分格式 (BDF) 离散化，该格式将 $t^{n+1}$ 处的时间导数近似为\n$$\n\\dot{u}^{n+1} \\approx \\frac{1}{\\Delta t} \\sum_{j=0}^{k} \\alpha_{j}\\,u^{n+1-j},\n$$\n其中系数 $\\alpha_{j}$ 是标准的 k 步 BDF 系数，满足 $\\sum_{j=0}^{k} \\alpha_{j} = 0$ 和 $\\alpha_{0} > 0$。假设在 $t^{n+1}$ 处对状态相关算子进行隐式处理，以获得一个一致的全离散残差。\n\n引入一个本征正交分解 (POD) 试探基 $V \\in \\mathbb{R}^{N \\times r}$（其中 $r \\ll N$）和一个 Petrov-Galerkin 测试基 $W \\in \\mathbb{R}^{N \\times r}$，使得 $W^{T}V = I$。降阶模型 (ROM) 的未知数是降阶坐标 $q^{n} \\in \\mathbb{R}^{r}$，因此 $u^{n} \\approx V\\,q^{n}$。令 $b^{n+1} := b(t^{n+1})$。\n\n仅从这些定义出发（不引用任何目标公式），完成以下任务：\n- 根据 $u^{n+1}$ 和历史状态 $\\{u^{n},\\dots,u^{n+1-k}\\}$，推导在时间步 $n+1$ 处的一致的全离散全阶模型残差。\n- 应用 Petrov-Galerkin 投影，根据 $V$、$W$、$q^{n+1}$、历史状态 $\\{q^{n},\\dots,q^{n+1-k}\\}$ 以及上面定义的算子，获得 ROM 残差 $r^{n+1}(q^{n+1})$。\n- 仅使用基于 BDF 定义和 ROM ansatz 的代数操作，对 ROM 残差进行因式分解，以清晰地揭示哪些项在 $t^{n+1}$ 时是状态相关的，哪些是历史相关的。\n- 然后，使用针对向量值和矩阵值非线性项的插值超降阶原理，通过为 $f(V\\,q)$ 引入附属基 $U_{g} \\in \\mathbb{R}^{N \\times m_{g}}$ 和为 $M(V\\,q)\\,V$ 引入附属基 $U_{M} \\in \\mathbb{R}^{N \\times m_{M}}$，以及采样（行选择）矩阵 $P_{g} \\in \\mathbb{R}^{N \\times m_{g}}$ 和 $P_{M} \\in \\mathbb{R}^{N \\times m_{M}}$，构建一个离散经验插值法 (DEIM) 风格的超降阶 ROM 残差。您的构建过程必须直接遵循在采样行上强制插值并投影到附属基上的原则，而不假设任何预先给定的公式。\n\n作为您的最终答案，提供一个关于在时间步 $n+1$ 处的超降阶 ROM 残差的单一闭式解析表达式，该表达式用上面引入的符号表示。最终答案中不要包含任何解释性文字。最终答案必须是单个符号数学表达式。不需要单位。",
            "solution": "该问题要求从第一性原理出发，为一个一般多物理场系统推导超降阶模型 (ROM) 的残差。推导过程按照问题陈述中概述的四个连续步骤进行。\n\n### 步骤 1：问题验证\n\n首先，我将从问题陈述中逐字提取给定信息。\n- 系统状态：$u(t) \\in \\mathbb{R}^{N}$\n- 半离散残差：$R(u,\\dot{u},t) := M(u)\\,\\dot{u} - f(u) - A\\,u - b(t)$\n- 状态相关算子：$M(u) \\in \\mathbb{R}^{N \\times N}$\n- 非线性项：$f(u) \\in \\mathbb{R}^{N}$\n- 线性算子：$A \\in \\mathbb{R}^{N \\times N}$\n- 强迫项：$b(t) \\in \\mathbb{R}^{N}$\n- 时间离散化：$t^{n} = t^{0} + n\\,\\Delta t$，对于常数 $\\Delta t > 0$\n- k 步 BDF 近似：$\\dot{u}^{n+1} \\approx \\frac{1}{\\Delta t} \\sum_{j=0}^{k} \\alpha_{j}\\,u^{n+1-j}$\n- BDF 系数属性：$\\sum_{j=0}^{k} \\alpha_{j} = 0$ 和 $\\alpha_{0} > 0$\n- POD 试探基：$V \\in \\mathbb{R}^{N \\times r}$，其中 $r \\ll N$\n- Petrov-Galerkin 测试基：$W \\in \\mathbb{R}^{N \\times r}$\n- 正交归一化条件：$W^{T}V = I$，其中 $I$ 是 $r \\times r$ 单位矩阵。\n- ROM ansatz（假设）：$u^{n} \\approx V\\,q^{n}$，对于降阶坐标 $q^{n} \\in \\mathbb{R}^{r}$\n- 时间步 $n+1$ 处的强迫项：$b^{n+1} := b(t^{n+1})$\n- 用于 $f(Vq)$ 的 DEIM 基：$U_{g} \\in \\mathbb{R}^{N \\times m_{g}}$\n- 用于 $M(Vq)V$ 的 DEIM 基：$U_{M} \\in \\mathbb{R}^{N \\times m_{M}}$\n- 用于 $f(Vq)$ 的 DEIM 采样矩阵：$P_{g} \\in \\mathbb{R}^{N \\times m_{g}}$\n- 用于 $M(Vq)V$ 的 DEIM 采样矩阵：$P_{M} \\in \\mathbb{R}^{N \\times m_{M}}$\n\n接下来，我将根据所需标准验证问题陈述。\n- **科学基础：** 该问题牢固地植根于计算科学这一成熟领域，特别是在微分代数方程系统的模型降阶方面。本征正交分解 (POD)、Petrov-Galerkin 投影、后向差分格式 (BDF) 和离散经验插值法 (DEIM) 都是标准的、有详细文档记录的技术。该设置是在空间上离散化的大规模多物理场问题的典型表示。\n- **良构性：** 任务是进行数学推导。起点和目标（一个超降阶残差的公式）都已明确定义。步骤按逻辑顺序排列，导向一个唯一的解析表达式。\n- **客观性：** 问题使用精确的数学语言和符号陈述，没有任何主观性、模糊性或观点。\n\n该问题不违反任何无效标准。它在科学上是合理的、可形式化的、自洽的，并提出了应用数学中一个非平凡但可解的挑战。因此，该问题被视为**有效**的。\n\n### 步骤 2：ROM 和超降阶 ROM 残差的推导\n\n在此，我将按照指定的操作顺序推导所要求的表达式。\n\n**全离散全阶模型 (FOM) 残差的推导**\n半离散系统残差设为零：$R(u, \\dot{u}, t) = 0$。对于一个全隐式时间步进格式，我们在新的时间步 $t^{n+1}$ 评估所有项，令 $u^{j}$ 表示 $u(t^{j})$。\n$$\nM(u^{n+1})\\,\\dot{u}^{n+1} - f(u^{n+1}) - A\\,u^{n+1} - b^{n+1} = 0\n$$\n时间导数 $\\dot{u}^{n+1}$ 被其 k 步 BDF 近似所取代：\n$$\n\\dot{u}^{n+1} \\approx \\frac{1}{\\Delta t} \\sum_{j=0}^{k} \\alpha_{j}\\,u^{n+1-j}\n$$\n将此代入系统方程，得到全离散 FOM 残差 $R_{\\text{FOM}}^{n+1}$，对于解 $u^{n+1}$，该残差必须为零：\n$$\nR_{\\text{FOM}}^{n+1}(u^{n+1}) := M(u^{n+1})\\left(\\frac{1}{\\Delta t} \\sum_{j=0}^{k} \\alpha_{j}\\,u^{n+1-j}\\right) - f(u^{n+1}) - A\\,u^{n+1} - b^{n+1}\n$$\n此残差是未知状态 $u^{n+1}$ 和已知历史状态 $\\{u^{n}, \\dots, u^{n+1-k}\\}$ 的函数。\n\n**应用 Petrov-Galerkin 投影以获得 ROM 残差**\nROM 是通过将 ansatz $u^{n+1-j} \\approx V\\,q^{n+1-j}$（对于 $j=0, \\dots, k$）引入 FOM 残差并将其投影到测试基 $W$ 上来构建的。ROM 残差 $r^{n+1}(q^{n+1})$ 由 $W^{T}R_{\\text{FOM}}^{n+1}=0$ 给出。\n$$\nr^{n+1}(q^{n+1}) = W^{T} \\left[ M(Vq^{n+1})\\left(\\frac{1}{\\Delta t} \\sum_{j=0}^{k} \\alpha_{j}\\,Vq^{n+1-j}\\right) - f(Vq^{n+1}) - A Vq^{n+1} - b^{n+1} \\right]\n$$\n利用转置和投影的线性，我们可以将 $W^T$ 分配到每一项：\n$$\nr^{n+1}(q^{n+1}) = \\frac{1}{\\Delta t} W^{T}M(Vq^{n+1})V \\left(\\sum_{j=0}^{k} \\alpha_{j}\\,q^{n+1-j}\\right) - W^{T}f(Vq^{n+1}) - W^{T}AVq^{n+1} - W^{T}b^{n+1}\n$$\n\n**分解 ROM 残差**\n为了区分状态相关项和历史相关项，我们分离索引 $j$ 的求和：\n$$\n\\sum_{j=0}^{k} \\alpha_{j}\\,q^{n+1-j} = \\alpha_{0}\\,q^{n+1} + \\sum_{j=1}^{k} \\alpha_{j}\\,q^{n+1-j}\n$$\n然后 ROM 残差可以写为：\n$$\nr^{n+1}(q^{n+1}) = \\left(\\frac{\\alpha_0}{\\Delta t}W^T M(Vq^{n+1})V - W^TAV\\right)q^{n+1} - W^Tf(Vq^{n+1}) + \\frac{1}{\\Delta t}W^T M(Vq^{n+1})V\\left(\\sum_{j=1}^{k} \\alpha_{j}\\,q^{n+1-j}\\right) - W^T b^{n+1}\n$$\n涉及 $M(Vq^{n+1})$ 和 $f(Vq^{n+1})$ 的项是当前状态 $q^{n+1}$ 的非线性函数，并且计算成本高昂，因为它们依赖于全阶维度 $N$。求和项涉及历史状态 $\\{q^{n}, \\dots, q^{n+1-k}\\}$。\n\n**构建超降阶 ROM 残差**\n超降阶旨在近似计算成本高昂的非线性项。\n\n1.  **非线性函数 $f(Vq^{n+1})$ 的超降阶：**\n    向量值函数 $g(q) := f(Vq)$ 通过投影到附属基 $U_g$ 上来近似：$g(q^{n+1}) \\approx U_g c_g^{n+1}$。DEIM 原理通过在一组由矩阵 $P_g^T$ 选择的 $m_g$ 个“魔点”或行上强制相等来确定系数 $c_g^{n+1}$：\n    $P_g^T g(q^{n+1}) = P_g^T U_g c_g^{n+1} \\implies c_g^{n+1} = (P_g^T U_g)^{-1} P_g^T g(q^{n+1})$。\n    因此，$f(Vq^{n+1})$ 的 DEIM 近似为：\n    $$\n    f(Vq^{n+1}) \\approx U_g (P_g^T U_g)^{-1} P_g^T f(Vq^{n+1})\n    $$\n    残差中相应的投影项近似为：\n    $$\n    W^T f(Vq^{n+1}) \\approx W^T U_g (P_g^T U_g)^{-1} P_g^T f(Vq^{n+1})\n    $$\n    在线成本主要由评估 $P_g^T f(Vq^{n+1})$ 决定，这只需要计算非线性函数 $f$ 的 $m_g$ 个分量。\n\n2.  **矩阵相关项 $M(Vq^{n+1})V$ 的超降阶：**\n    问题为矩阵值函数 $\\mathcal{M}(q) := M(Vq)V \\in \\mathbb{R}^{N \\times r}$ 提供了一个基 $U_M$。我们近似这个矩阵的列空间：$\\mathcal{M}(q^{n+1}) \\approx U_M C_M^{n+1}$，其中 $C_M^{n+1} \\in \\mathbb{R}^{m_M \\times r}$。应用相同的 DEIM 逻辑，我们在采样行上强制相等：\n    $P_M^T \\mathcal{M}(q^{n+1}) = P_M^T U_M C_M^{n+1} \\implies C_M^{n+1} = (P_M^T U_M)^{-1} P_M^T \\mathcal{M}(q^{n+1})$。\n    $\\mathcal{M}(q^{n+1})$ 的近似为：\n    $$\n    M(Vq^{n+1})V \\approx U_M (P_M^T U_M)^{-1} P_M^T M(Vq^{n+1})V\n    $$\n    此近似可用于所有涉及矩阵乘积 $M(Vq^{n+1})V$ 的项。在代入之前，来自 BDF 离散化的完整项可以紧凑地写为：\n    $$\n    \\frac{1}{\\Delta t} W^{T}M(Vq^{n+1})V \\left(\\sum_{j=0}^{k} \\alpha_{j}\\,q^{n+1-j}\\right)\n    $$\n    应用超降阶近似得到：\n    $$\n    \\approx \\frac{1}{\\Delta t} W^{T} \\left( U_M (P_M^T U_M)^{-1} P_M^T M(Vq^{n+1})V \\right) \\left(\\sum_{j=0}^{k} \\alpha_{j}\\,q^{n+1-j}\\right)\n    $$\n    这里的在线成本在于评估 $m_M \\times r$ 矩阵 $P_M^T M(Vq^{n+1})V$。\n\n**超降阶 ROM 残差的最终表达式**\n将近似项与精确的线性和强迫项结合，超降阶残差 $r_H^{n+1}(q^{n+1})$ 为：\n$$\nr_H^{n+1}(q^{n+1}) = \\frac{1}{\\Delta t} W^T U_M (P_M^T U_M)^{-1} \\left(P_M^T M(Vq^{n+1})V\\right) \\left(\\sum_{j=0}^{k} \\alpha_{j} q^{n+1-j}\\right) - W^T U_g (P_g^T U_g)^{-1} P_g^T f(Vq^{n+1}) - W^T A V q^{n+1} - W^T b^{n+1}\n$$\n此表达式表示在每个时间步需求解 $q^{n+1}$ 的最终超降阶残差。",
            "answer": "$$\n\\boxed{\\frac{1}{\\Delta t} W^T U_M (P_M^T U_M)^{-1} \\left(P_M^T M(Vq^{n+1})V\\right) \\left(\\sum_{j=0}^{k} \\alpha_{j} q^{n+1-j}\\right) - W^T U_g (P_g^T U_g)^{-1} P_g^T f(Vq^{n+1}) - W^T A V q^{n+1} - W^T b^{n+1}}\n$$"
        }
    ]
}