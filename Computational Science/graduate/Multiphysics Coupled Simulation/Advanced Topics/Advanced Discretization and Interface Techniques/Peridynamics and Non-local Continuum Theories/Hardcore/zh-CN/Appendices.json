{
    "hands_on_practices": [
        {
            "introduction": "理解波在介质中的传播是任何连续介质理论的基石。本练习旨在探讨近场动力学的非局部性如何导致波的色散现象，这是其区别于经典弹性理论的一个关键特征。通过从近场动力学的运动方程出发推导色散关系 ，您将能直接观察到频率与波长的非线性依赖关系，并学会如何在长波极限下恢复经典理论中的声速，从而加深对非局部模型动态响应的理解。",
            "id": "3520663",
            "problem": "考虑一个由近场动力学（PD）描述的无限长一维均匀杆，其中近场动力学是一种非局部连续介质理论，在该理论中，物质点通过成对的键在有限的空间视域内相互作用。假设一个基于键的线性弹性近场动力学模型，其具有均匀视域 $\\,\\delta\\,$，对于长度 $\\,|\\xi|\\leq \\delta\\,$ 的键，其微观模量为常数 $\\,c\\,$，否则相互作用为零。设质量密度为 $\\,\\rho\\,$，并忽略外部体力。从牛顿第二定律和针对小纵向位移的基于键的近场动力学运动方程出发，考虑形式为 $\\,u(x,t)=U\\exp(i(kx - \\omega t))\\,$ 的小振幅平面波解，其中 $\\,k\\,$ 为实数波数，$\\,\\omega\\,$ 为角频率。推导 $\\,\\omega^{2}(k)\\,$ 关于 $\\,c\\,$, $\\,\\rho\\,$, $\\,\\delta\\,$ 和 $\\,k\\,$ 的精确色散关系的闭式解析表达式。然后，将您的结果按无量纲波数 $\\,k\\delta\\,$ 的幂次展开，以识别经典局部连续介质极限和相应的有效波速。将最终答案表示为 $\\,\\omega^{2}(k)\\,$ 关于 $\\,c\\,$, $\\,\\rho\\,$, $\\,\\delta\\,$ 和 $\\,k\\,$ 的精确闭式表达式。无需进行数值计算，最终表达式中不应包含任何单位。",
            "solution": "推导始于将牛顿第二定律应用于位置为 $\\,x\\,$、质量密度为 $\\,\\rho\\,$ 的物质点，并结合基于键的线性近场动力学运动方程。在一维情况下，对于视域为 $\\,\\delta\\,$ 且在 $\\,|\\xi|\\leq \\delta\\,$ 范围内微观模量为常数 $\\,c\\,$ 的模型，小纵向位移 $\\,u(x,t)\\,$ 的近场动力学运动方程为\n$$\n\\rho\\,\\ddot{u}(x,t) \\;=\\; \\int_{-\\delta}^{\\delta} c\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi,\n$$\n其中 $\\,\\xi\\,$ 表示一维中的相对位置矢量，$\\,\\ddot{u}\\,$ 是 $\\,u\\,$ 的二阶时间导数。此形式是牛顿第二定律以及针对一维运动学的基于键的近场动力学线性成对力函数的直接推论。\n\n我们寻求形式为\n$$\nu(x,t) \\;=\\; U\\,\\exp\\!\\big(i(kx-\\omega t)\\big),\n$$\n的平面波解，其中 $\\,U\\,$ 为振幅，$\\,k\\,$ 为实数波数，$\\,\\omega\\,$ 为角频率。将此拟设解代入运动方程，方程左侧变为\n$$\n\\rho\\,\\ddot{u}(x,t) \\;=\\; \\rho\\,(-\\omega^{2})\\,U\\,\\exp\\!\\big(i(kx-\\omega t)\\big).\n$$\n方程右侧变为\n$$\n\\int_{-\\delta}^{\\delta} c\\,\\big(U\\,\\exp\\!\\big(i(k(x+\\xi)-\\omega t)\\big) - U\\,\\exp\\!\\big(i(kx-\\omega t)\\big)\\big)\\,d\\xi\n\\;=\\; U\\,\\exp\\!\\big(i(kx-\\omega t)\\big)\\,\\int_{-\\delta}^{\\delta} c\\,\\big(\\exp(i k \\xi)-1\\big)\\,d\\xi.\n$$\n消去公因子 $\\,U\\,\\exp\\!\\big(i(kx-\\omega t)\\big)\\,$，得到隐式积分形式的色散关系：\n$$\n-\\rho\\,\\omega^{2} \\;=\\; \\int_{-\\delta}^{\\delta} c\\,\\big(\\exp(i k \\xi)-1\\big)\\,d\\xi.\n$$\n我们显式地计算该积分。$\\,\\exp(i k \\xi)\\,$ 在对称区间上的积分为\n$$\n\\int_{-\\delta}^{\\delta} \\exp(i k \\xi)\\,d\\xi \\;=\\; \\left.\\frac{\\exp(i k \\xi)}{i k}\\right|_{-\\delta}^{\\delta}\n\\;=\\; \\frac{\\exp(i k \\delta)-\\exp(-i k \\delta)}{i k}\n\\;=\\; \\frac{2\\,\\sin(k\\delta)}{k}.\n$$\n$\\,1\\,$ 在同一区间上的积分为 $\\,\\int_{-\\delta}^{\\delta} 1\\,d\\xi = 2\\delta\\,$。因此，\n$$\n\\int_{-\\delta}^{\\delta} c\\,\\big(\\exp(i k \\xi)-1\\big)\\,d\\xi\n\\;=\\; c\\left(\\frac{2\\,\\sin(k\\delta)}{k} \\;-\\; 2\\delta\\right).\n$$\n色散关系变为\n$$\n-\\rho\\,\\omega^{2} \\;=\\; c\\left(\\frac{2\\,\\sin(k\\delta)}{k} \\;-\\; 2\\delta\\right),\n$$\n或等价地\n$$\n\\omega^{2}(k) \\;=\\; \\frac{2c}{\\rho}\\left(\\delta \\;-\\; \\frac{\\sin(k\\delta)}{k}\\right).\n$$\n这便是在一个具有有限视域和恒定微观模量的无限长一维杆中，小振幅纵波的近场动力学色散关系的精确闭式解析表达式。\n\n为与经典局部连续介质极限建立联系，我们使用泰勒级数对小的无量纲波数 $\\,k\\delta\\ll 1\\,$ 进行展开\n$$\n\\sin(k\\delta) \\;=\\; k\\delta \\;-\\; \\frac{(k\\delta)^{3}}{6} \\;+\\; \\frac{(k\\delta)^{5}}{120} \\;-\\; \\cdots.\n$$\n于是\n$$\n\\delta \\;-\\; \\frac{\\sin(k\\delta)}{k}\n\\;=\\; \\delta \\;-\\; \\left(\\delta \\;-\\; \\frac{k^{2}\\delta^{3}}{6} \\;+\\; \\frac{k^{4}\\delta^{5}}{120} \\;-\\; \\cdots\\right)\n\\;=\\; \\frac{k^{2}\\delta^{3}}{6} \\;-\\; \\frac{k^{4}\\delta^{5}}{120} \\;+\\; \\cdots.\n$$\n因此，在主导阶上，\n$$\n\\omega^{2}(k) \\;\\approx\\; \\frac{2c}{\\rho}\\,\\frac{k^{2}\\delta^{3}}{6}\n\\;=\\; \\left(\\frac{c\\,\\delta^{3}}{3\\,\\rho}\\right)\\,k^{2}.\n$$\n在由 $\\,\\rho\\,\\ddot{u} = E\\,\\partial^{2}u/\\partial x^{2}\\,$ 描述的经典一维局部弹性连续介质中，平面波满足\n$$\n\\omega^{2}(k) \\;=\\; \\frac{E}{\\rho}\\,k^{2}.\n$$\n匹配主导阶行为可确定，在一维情况下，基于键的近场动力学模型的有效局部模量为 $\\,E_{\\mathrm{eff}} = c\\,\\delta^{3}/3\\,$，有效波速的平方为 $\\,E_{\\mathrm{eff}}/\\rho = c\\,\\delta^{3}/(3\\rho)\\,$。近场动力学色散关系中的高阶项引入了非局部色散，这使得在较大的 $\\,k\\delta\\,$ 值时理论结果偏离局部理论，而小的 $\\,k\\delta\\,$ 极限则再现了经典的线性色散关系 $\\,\\omega\\propto k\\,$。\n\n因此，所要求的精确色散关系的最终表达式为如下闭式\n$$\n\\omega^{2}(k) \\;=\\; \\frac{2c}{\\rho}\\left(\\delta \\;-\\; \\frac{\\sin(k\\delta)}{k}\\right).\n$$",
            "answer": "$$\\boxed{\\frac{2c}{\\rho}\\left(\\delta-\\frac{\\sin(k\\delta)}{k}\\right)}$$"
        },
        {
            "introduction": "在应用非局部模型时，一个核心的挑战是如何将其微观参数与宏观上可测量的材料属性（如弹性模量）联系起来。本练习  演示了一种标准的校准流程，即通过在均匀变形条件下，令近场动力学模型的应变能密度与经典弹性理论的应变能密度相等，来确定模型中的微观参数。掌握这项技能对于使用近场动力学来模拟具有已知力学性能的真实材料至关重要。",
            "id": "3520735",
            "problem": "考虑一个三维空间中的均匀微弹性、基于键的近场动力学固体，其有限作用范围的半径为 $\\delta$。两个材料点之间的参考键矢量为 $\\boldsymbol{\\xi}$，其长度为 $r=\\|\\boldsymbol{\\xi}\\|$。球对称微模量（也称为核函数）由下式给出\n$$\nc(r)=\\begin{cases}\nc_0\\left(1-\\dfrac{r}{\\delta}\\right),  0\\le r\\le \\delta \\\\\n0,  r>\\delta\n\\end{cases}\n$$\n其中 $c_0$ 是一个待定常数。假设为小变形和由无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 表征的均匀变形。在基于键的微弹性模型中，键伸长定义为 $s=\\hat{\\boldsymbol{\\xi}}\\cdot \\boldsymbol{\\varepsilon}\\,\\hat{\\boldsymbol{\\xi}}$，其中 $\\hat{\\boldsymbol{\\xi}}=\\boldsymbol{\\xi}/\\|\\boldsymbol{\\xi}}\\|$，某一点的近场动力学应变能密度为\n$$\nW_{\\mathrm{PD}}=\\dfrac{1}{4}\\int_{|\\boldsymbol{\\xi}|\\le \\delta} c(\\|\\boldsymbol{\\xi}\\|)\\,s^2\\,\\|\\boldsymbol{\\xi}\\|\\,\\mathrm{d}V',\n$$\n其中 $\\mathrm{d}V'$ 是点 $\\boldsymbol{x}'=\\boldsymbol{x}+\\boldsymbol{\\xi}$ 处的体积元。对于 $x_1$–$x_2$ 平面内剪切参数为 $\\gamma$ 的均匀纯剪切变形，$\\boldsymbol{\\varepsilon}$ 的非零分量为 $\\varepsilon_{12}=\\varepsilon_{21}=\\gamma/2$。在经典线弹性理论中，对于剪切模量为 $\\mu$ 的各向同性固体，这种纯剪切状态对应的应变能密度为\n$$\nW_{\\mathrm{cl}}=\\dfrac{1}{2}\\,\\mu\\,\\gamma^2.\n$$\n确定 $c_0$ 的值，其形式为 $\\mu$ 和 $\\delta$ 的闭式解析表达式，使得在均匀纯剪切变形下，当 $\\delta\\to 0$ 时，近场动力学模型恢复到经典响应，即对于此变形有 $W_{\\mathrm{PD}}=W_{\\mathrm{cl}}$。将最终答案表示为 $\\mu$ 和 $\\delta$ 的单个解析表达式。最终表达式中不包含单位。",
            "solution": "该问题要求针对给定的近场动力学微模量函数确定常数 $c_0$。这通过将均匀纯剪切状态下的近场动力学应变能密度 $W_{\\mathrm{PD}}$ 与经典线弹性应变能密度 $W_{\\mathrm{cl}}$ 相等来实现。这种方法是一个标准的校准程序，确保非局部的近场动力学模型能够再现经典局部模型在均匀变形下的行为。\n\n对于承受剪切参数为 $\\gamma$ 的纯剪切的各向同性固体，其经典应变能密度由下式给出：\n$$\nW_{\\mathrm{cl}} = \\frac{1}{2} \\mu \\gamma^2\n$$\n其中 $\\mu$ 是剪切模量。\n\n近场动力学应变能密度由下式给出：\n$$\nW_{\\mathrm{PD}} = \\frac{1}{4} \\int_{|\\boldsymbol{\\xi}| \\le \\delta} c(\\|\\boldsymbol{\\xi}\\|) s^2 \\|\\boldsymbol{\\xi}\\| \\, \\mathrm{d}V'\n$$\n我们必须首先计算指定变形下的键伸长 $s$。在 $x_1$-$x_2$ 平面内的纯剪切应变张量 $\\boldsymbol{\\varepsilon}$ 的非零分量为 $\\varepsilon_{12} = \\varepsilon_{21} = \\gamma/2$。所有其他分量均为零。键伸长 $s$ 定义为 $s = \\hat{\\boldsymbol{\\xi}} \\cdot \\boldsymbol{\\varepsilon} \\hat{\\boldsymbol{\\xi}}$，其中 $\\hat{\\boldsymbol{\\xi}} = \\boldsymbol{\\xi} / \\|\\boldsymbol{\\xi}\\| = (\\hat{\\xi}_1, \\hat{\\xi}_2, \\hat{\\xi}_3)^T$ 是沿键方向的单位矢量。\n\n我们来计算乘积 $\\boldsymbol{\\varepsilon} \\hat{\\boldsymbol{\\xi}}$：\n$$\n\\boldsymbol{\\varepsilon} \\hat{\\boldsymbol{\\xi}} = \\begin{pmatrix} 0  \\gamma/2  0 \\\\ \\gamma/2  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\hat{\\xi}_1 \\\\ \\hat{\\xi}_2 \\\\ \\hat{\\xi}_3 \\end{pmatrix} = \\begin{pmatrix} (\\gamma/2)\\hat{\\xi}_2 \\\\ (\\gamma/2)\\hat{\\xi}_1 \\\\ 0 \\end{pmatrix}\n$$\n现在，我们计算点积 $\\hat{\\boldsymbol{\\xi}} \\cdot (\\boldsymbol{\\varepsilon} \\hat{\\boldsymbol{\\xi}})$：\n$$\ns = \\hat{\\xi}_1 \\left(\\frac{\\gamma}{2}\\hat{\\xi}_2\\right) + \\hat{\\xi}_2 \\left(\\frac{\\gamma}{2}\\hat{\\xi}_1\\right) + \\hat{\\xi}_3(0) = \\gamma \\hat{\\xi}_1 \\hat{\\xi}_2\n$$\n因此，键伸长的平方为：\n$$\ns^2 = \\gamma^2 \\hat{\\xi}_1^2 \\hat{\\xi}_2^2\n$$\n现在我们将此结果和给定的微模量函数 $c(r)=c_0(1-r/\\delta)$ 代入 $W_{\\mathrm{PD}}$ 的表达式中。令 $r = \\|\\boldsymbol{\\xi}\\|$。积分是在半径为 $\\delta$ 的球体上进行的。\n$$\nW_{\\mathrm{PD}} = \\frac{1}{4} \\int_{|\\boldsymbol{\\xi}| \\le \\delta} c_0 \\left(1-\\frac{r}{\\delta}\\right) (\\gamma^2 \\hat{\\xi}_1^2 \\hat{\\xi}_2^2) r \\, \\mathrm{d}V'\n$$\n为计算此积分，我们转换到球坐标系。令 $\\boldsymbol{\\xi} = (r\\sin\\theta\\cos\\phi, r\\sin\\theta\\sin\\phi, r\\cos\\theta)$。单位矢量分量为 $\\hat{\\xi}_1 = \\sin\\theta\\cos\\phi$, $\\hat{\\xi}_2 = \\sin\\theta\\sin\\phi$, 和 $\\hat{\\xi}_3 = \\cos\\theta$。体积元为 $\\mathrm{d}V' = r^2 \\sin\\theta \\, \\mathrm{d}r \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi$。积分限为 $r \\in [0, \\delta]$, $\\theta \\in [0, \\pi]$ 和 $\\phi \\in [0, 2\\pi]$。\n\n将这些代入 $W_{\\mathrm{PD}}$ 的积分中：\n$$\nW_{\\mathrm{PD}} = \\frac{1}{4} \\int_0^{2\\pi} \\int_0^{\\pi} \\int_0^{\\delta} c_0 \\left(1-\\frac{r}{\\delta}\\right) \\gamma^2 (\\sin\\theta\\cos\\phi)^2 (\\sin\\theta\\sin\\phi)^2 r (r^2 \\sin\\theta) \\, \\mathrm{d}r \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n我们可以提出常数并将积分分离为径向和角向部分：\n$$\nW_{\\mathrm{PD}} = \\frac{c_0 \\gamma^2}{4} \\left[ \\int_0^{\\delta} r^3 \\left(1-\\frac{r}{\\delta}\\right) \\mathrm{d}r \\right] \\left[ \\int_0^{\\pi} \\sin^5\\theta \\, \\mathrm{d}\\theta \\right] \\left[ \\int_0^{2\\pi} \\cos^2\\phi \\sin^2\\phi \\, \\mathrm{d}\\phi \\right]\n$$\n我们来分别计算每个积分。\n\n径向积分 $I_r$：\n$$\nI_r = \\int_0^{\\delta} \\left(r^3 - \\frac{r^4}{\\delta}\\right) \\mathrm{d}r = \\left[ \\frac{r^4}{4} - \\frac{r^5}{5\\delta} \\right]_0^{\\delta} = \\frac{\\delta^4}{4} - \\frac{\\delta^5}{5\\delta} = \\frac{\\delta^4}{4} - \\frac{\\delta^4}{5} = \\frac{\\delta^4}{20}\n$$\n极角积分 $I_\\theta$：\n$$\nI_\\theta = \\int_0^{\\pi} \\sin^5\\theta \\, \\mathrm{d}\\theta = \\int_0^{\\pi} (\\sin^2\\theta)^2 \\sin\\theta \\, \\mathrm{d}\\theta = \\int_0^{\\pi} (1-\\cos^2\\theta)^2 \\sin\\theta \\, \\mathrm{d}\\theta\n$$\n使用换元法 $u = \\cos\\theta$, $\\mathrm{d}u = -\\sin\\theta \\, \\mathrm{d}\\theta$：\n$$\nI_\\theta = \\int_{1}^{-1} (1-u^2)^2 (-\\mathrm{d}u) = \\int_{-1}^{1} (1 - 2u^2 + u^4) \\mathrm{d}u = \\left[ u - \\frac{2u^3}{3} + \\frac{u^5}{5} \\right]_{-1}^{1} = 2 \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) = 2 \\left(\\frac{15-10+3}{15}\\right) = \\frac{16}{15}\n$$\n方位角积分 $I_\\phi$：\n$$\nI_\\phi = \\int_0^{2\\pi} \\cos^2\\phi \\sin^2\\phi \\, \\mathrm{d}\\phi = \\int_0^{2\\pi} \\left(\\frac{\\sin(2\\phi)}{2}\\right)^2 \\mathrm{d}\\phi = \\frac{1}{4} \\int_0^{2\\pi} \\sin^2(2\\phi) \\, \\mathrm{d}\\phi\n$$\n使用恒等式 $\\sin^2(x) = \\frac{1 - \\cos(2x)}{2}$：\n$$\nI_\\phi = \\frac{1}{4} \\int_0^{2\\pi} \\frac{1 - \\cos(4\\phi)}{2} \\mathrm{d}\\phi = \\frac{1}{8} \\left[ \\phi - \\frac{\\sin(4\\phi)}{4} \\right]_0^{2\\pi} = \\frac{1}{8} (2\\pi) = \\frac{\\pi}{4}\n$$\n现在，我们组合 $W_{\\mathrm{PD}}$ 的表达式：\n$$\nW_{\\mathrm{PD}} = \\frac{c_0 \\gamma^2}{4} \\cdot I_r \\cdot I_\\theta \\cdot I_\\phi = \\frac{c_0 \\gamma^2}{4} \\left(\\frac{\\delta^4}{20}\\right) \\left(\\frac{16}{15}\\right) \\left(\\frac{\\pi}{4}\\right)\n$$\n$$\nW_{\\mathrm{PD}} = c_0 \\gamma^2 \\frac{16 \\pi \\delta^4}{4 \\cdot 20 \\cdot 15 \\cdot 4} = c_0 \\gamma^2 \\frac{16 \\pi \\delta^4}{4800} = c_0 \\gamma^2 \\frac{\\pi \\delta^4}{300}\n$$\n为了求得 $c_0$，我们令近场动力学和经典应变能密度相等，$W_{\\mathrm{PD}} = W_{\\mathrm{cl}}$：\n$$\nc_0 \\gamma^2 \\frac{\\pi \\delta^4}{300} = \\frac{1}{2} \\mu \\gamma^2\n$$\n$\\gamma^2$ 项从两边消去，因为该等价关系必须对任何微小的剪切量都成立：\n$$\nc_0 \\frac{\\pi \\delta^4}{300} = \\frac{\\mu}{2}\n$$\n最后，我们解出 $c_0$：\n$$\nc_0 = \\frac{\\mu}{2} \\frac{300}{\\pi \\delta^4} = \\frac{150 \\mu}{\\pi \\delta^4}\n$$\n这就是所要求的用剪切模量 $\\mu$ 和视域半径 $\\delta$ 表示的 $c_0$ 的表达式。",
            "answer": "$$\n\\boxed{\\frac{150 \\mu}{\\pi \\delta^4}}\n$$"
        },
        {
            "introduction": "将连续介质理论应用于计算模拟，关键一步是对核心物理量进行离散化处理。本练习  提供了计算非局部变形梯度的动手实践，该梯度是基于状态的近场动力学中的一个核心概念。通过将该问题构建为对邻域内粒子相对位移的加权最小二乘拟合，您不仅能深入理解近场动力学模拟的数值基础，还能体会到在处理无序粒子集时可能遇到的数值稳定性等实际问题。",
            "id": "3520731",
            "problem": "要求您设计并实现一个程序，该程序为在受扰动粒子集上采样的指定仿射位移场计算近场动力学和非局部连续介质理论意义下的非局部变形梯度，并量化由此产生的近似误差。该程序必须从第一性原理出发，将估计量实现为在有限邻域（影响域）内对相对变形的线性映射的加权最小二乘最佳拟合。答案必须是可复现的，且不得需要任何外部输入。\n\n基本原理。从以下普遍接受的原则开始：\n- 物质点的变形映射在局部由一个仿射映射近似。给定一个正在运动的物体，设一个最初位于位置 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 的物质点映射到 $\\mathbf{y}(\\mathbf{x}) \\in \\mathbb{R}^{2}$。对于足够光滑的运动，在 $\\mathbf{x}_{0}$ 邻域内的最佳线性近似由变形梯度 $\\mathbf{F}(\\mathbf{x}_{0})$ 编码，在经典局部理论中定义为 $\\mathbf{F}(\\mathbf{x}_{0}) = \\nabla \\mathbf{y}(\\mathbf{x}_{0})$。\n- 在非局部设置中，一个最佳拟合线性映射可以被确定为在有限影响域上一个加权最小二乘泛函的最小化子。具体来说，对于给定的具有紧支集或快速衰减支集的对称非负权重（核函数）$\\omega(r)$ 和影响域半径 $\\delta$，定义相对向量 $\\boldsymbol{\\xi} = \\mathbf{x} - \\mathbf{x}_{0}$ 和 $\\boldsymbol{\\eta} = \\mathbf{y}(\\mathbf{x}) - \\mathbf{y}(\\mathbf{x}_{0})$。考虑泛函\n$$\n\\mathcal{J}(\\mathbf{F}) = \\int_{\\|\\boldsymbol{\\xi}\\| \\le \\delta} \\omega\\left(\\|\\boldsymbol{\\xi}\\|\\right)\\,\\left\\| \\mathbf{F}\\,\\boldsymbol{\\xi} - \\boldsymbol{\\eta} \\right\\|^{2}\\,\\mathrm{d}V,\n$$\n其最小化子提供了变形梯度的非局部估计 $\\widehat{\\mathbf{F}}(\\mathbf{x}_{0})$。该估计量基于线性回归和加权最小二乘法（LS）中经过充分检验的关系。\n- 仿射位移场 $\\mathbf{u}(\\mathbf{x})$ 被指定为 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}$，其中 $\\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$ 是常数矩阵，$\\mathbf{b} \\in \\mathbb{R}^{2}$ 是常数向量。运动则为 $\\mathbf{y}(\\mathbf{x}) = \\mathbf{x} + \\mathbf{u}(\\mathbf{x}) = (\\mathbf{I} + \\mathbf{A})\\,\\mathbf{x} + \\mathbf{b}$，其中 $\\mathbf{I}$ 是单位矩阵。精确变形梯度为 $\\mathbf{F}_{\\mathrm{exact}} = \\mathbf{I} + \\mathbf{A}$。\n- 积分的粒子离散化在半边长为 $L$ 的正方形域内，在一个间距为 $h$ 的名义方形晶格上进行，每个晶格点的每个坐标都受到均值为零、标准差为 $p\\,h$ 的独立高斯噪声的扰动。粒子被赋予相等的体积 $h^{2}$。\n\n任务。\n- 从泛函 $\\mathcal{J}(\\mathbf{F})$ 的一阶变分出发，推导非局部变形梯度估计量 $\\widehat{\\mathbf{F}}(\\mathbf{x}_{0})$ 的离散公式，该公式用影响域 $\\delta$ 内邻居上的加权和表示。您必须只使用上述原则；不要使用任何超出最小二乘最小化和基础微积分范畴的特殊公式。\n- 实现一个程序，该程序：\n  - 在晶格间距为 $h$ 的正方形域 $\\{ \\mathbf{x} \\in \\mathbb{R}^{2} : -L \\le x_{1} \\le L,\\,-L \\le x_{2} \\le L \\}$ 上生成粒子集，然后添加标准差为 $p\\,h$ 的高斯扰动。对每个测试用例使用一个带有固定种子的伪随机数生成器，以确保可复现性，具体如下文所述。\n  - 在评估点 $\\mathbf{x}_{0}$，收集所有满足 $0  \\|\\boldsymbol{\\xi}\\| \\le \\delta$ 的邻居，其中 $\\boldsymbol{\\xi} = \\mathbf{x} - \\mathbf{x}_{0}$。\n  - 使用高斯核函数 $\\omega(r) = \\exp\\!\\left( - (r/\\delta)^{2} \\right)$。\n  - 形成您推导出的离散加权最小二乘估计量，以计算 $\\widehat{\\mathbf{F}}(\\mathbf{x}_{0})$。如果离散法向矩阵是病态的或奇异的，请使用 Tikhonov 正则化 $\\lambda\\,\\mathbf{I}$，其中 $\\lambda  0$ 选择一个小的且量纲一致的值；报告您为 $\\lambda$ 选择的值及其原因，并一致地实现它。\n  - 计算相对 Frobenius 范数误差\n  $$\n  e = \\frac{\\left\\| \\widehat{\\mathbf{F}}(\\mathbf{x}_{0}) - \\mathbf{F}_{\\mathrm{exact}} \\right\\|_{F}}{\\left\\| \\mathbf{F}_{\\mathrm{exact}} \\right\\|_{F}}.\n  $$\n- 对于每个测试用例，输出必须是等于误差 $e$ 的单个浮点数，四舍五入到八位小数。\n\n测试套件。您的程序必须评估以下五个测试用例，并按下面指定的格式在一行中输出所有五个结果。在所有情况下，单位纯粹是数学上的且无量纲的。角度单位不适用。对于每个用例，列出 $(\\mathbf{A},\\mathbf{b},L,h,\\delta,p,\\mathbf{x}_{0},\\text{seed})$：\n- 用例 1：$\\mathbf{A} = \\begin{bmatrix} 0.1  0.2 \\\\ -0.05  0.15 \\end{bmatrix}$，$\\mathbf{b} = \\begin{bmatrix} 0.01 \\\\ -0.02 \\end{bmatrix}$，$L = 0.5$，$h = 0.05$，$\\delta = 0.2$，$p = 0.0$，$\\mathbf{x}_{0} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，种子 $= 1$。\n- 用例 2：与用例1相同的 $\\mathbf{A}$ 和 $\\mathbf{b}$，$L = 0.5$，$h = 0.05$，$\\delta = 0.2$，$p = 0.1$，$\\mathbf{x}_{0} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，种子 $= 2$。\n- 用例 3：与用例1相同的 $\\mathbf{A}$ 和 $\\mathbf{b}$，$L = 0.5$，$h = 0.05$，$\\delta = 0.12$，$p = 0.25$，$\\mathbf{x}_{0} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，种子 $= 3$。\n- 用例 4：$\\mathbf{A} = \\begin{bmatrix} 0.05  -0.3 \\\\ 0.3  -0.02 \\end{bmatrix}$，$\\mathbf{b} = \\begin{bmatrix} 0.03 \\\\ 0.02 \\end{bmatrix}$，$L = 0.5$，$h = 0.04$，$\\delta = 0.18$，$p = 0.15$，$\\mathbf{x}_{0} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，种子 $= 4$。\n- 用例 5：$\\mathbf{A} = \\begin{bmatrix} 0.12  0.0 \\\\ 0.0  -0.08 \\end{bmatrix}$，$\\mathbf{b} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，$L = 0.4$，$h = 0.04$，$\\delta = 0.2$，$p = 0.05$，$\\mathbf{x}_{0} = \\begin{bmatrix} 0.35 \\\\ 0.0 \\end{bmatrix}$，种子 $= 5$。\n\n最终输出格式。您的程序应生成单行输出，其中包含按用例1到5的顺序排列的结果，形式为方括号括起来的逗号分隔列表。每个误差必须以标准十进制表示法精确四舍五入到小数点后八位。例如，三个假设结果的输出将写为 $[\\;0.00012345,0.00123456,0.01234567\\;]$。\n\n注释和约束。\n- 您不得使用任何外部输入。所有参数都嵌入在程序中。\n- 如果对于任何测试用例，在影响域 $\\delta$ 内没有邻居，则返回编程语言定义的非数字（Not-a-Number）值。然而，根据上述参数，这种情况应该不会发生。\n- 在您的解决方案解释中报告并证明正则化参数 $\\lambda$ 的选择。实现的程序必须使用相同的选择。",
            "solution": "在尝试任何解决方案之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **域**：二维欧几里得空间, $\\mathbb{R}^{2}$。\n- **变形映射**：一个从初始位置 $\\mathbf{x}$ 到最终位置 $\\mathbf{y}$ 的映射 $\\mathbf{y}(\\mathbf{x})$。\n- **非局部泛函**：需要最小化的加权最小二乘泛函是 $\\mathcal{J}(\\mathbf{F}) = \\int_{\\|\\boldsymbol{\\xi}\\| \\le \\delta} \\omega\\left(\\|\\boldsymbol{\\xi}\\|\\right)\\,\\left\\| \\mathbf{F}\\,\\boldsymbol{\\xi} - \\boldsymbol{\\eta} \\right\\|^{2}\\,\\mathrm{d}V$。\n- **相对向量**：$\\boldsymbol{\\xi} = \\mathbf{x} - \\mathbf{x}_{0}$ 和 $\\boldsymbol{\\eta} = \\mathbf{y}(\\mathbf{x}) - \\mathbf{y}(\\mathbf{x}_{0})$。\n- **权重核函数**：一个对称、非负的权重函数 $\\omega(r)$，影响域半径为 $\\delta$。具体的核函数是高斯核：$\\omega(r) = \\exp\\!\\left( - (r/\\delta)^{2} \\right)$。\n- **仿射位移**：位移场由 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}$ 给出，其中 $\\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$ 和 $\\mathbf{b} \\in \\mathbb{R}^{2}$ 是常数。\n- **运动**：产生的运动是 $\\mathbf{y}(\\mathbf{x}) = \\mathbf{x} + \\mathbf{u}(\\mathbf{x}) = (\\mathbf{I} + \\mathbf{A})\\,\\mathbf{x} + \\mathbf{b}$，其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。\n- **精确变形梯度**：$\\mathbf{F}_{\\mathrm{exact}} = \\mathbf{I} + \\mathbf{A}$。\n- **离散化**：在域 $\\{ \\mathbf{x} \\in \\mathbb{R}^{2} : -L \\le x_{1} \\le L,\\,-L \\le x_{2} \\le L \\}$ 内，基于间距为 $h$ 的名义方形晶格的粒子方法。\n- **粒子扰动**：晶格点受到均值为 $0$、标准差为 $p\\,h$ 的独立同分布高斯噪声的扰动。\n- **粒子体积**：每个粒子代表一个体积元 $V_p = h^2$。\n- **邻居搜索**：邻居是满足 $0  \\|\\boldsymbol{\\xi}\\| \\le \\delta$ 的粒子。\n- **正则化**：如果离散系统是病态的，使用 Tikhonov 正则化 $\\lambda\\,\\mathbf{I}$，其中 $\\lambda  0$ 是一个小的、量纲一致的值。\n- **误差度量**：相对误差以 Frobenius 范数衡量：$e = \\frac{\\left\\| \\widehat{\\mathbf{F}}(\\mathbf{x}_{0}) - \\mathbf{F}_{\\mathrm{exact}} \\right\\|_{F}}{\\left\\| \\mathbf{F}_{\\mathrm{exact}} \\right\\|_{F}}$。\n- **测试套件**：提供了五个不同的测试用例，每个用例都有一整套参数 $(\\mathbf{A},\\mathbf{b},L,h,\\delta,p,\\mathbf{x}_{0},\\text{seed})$。\n- **输出**：一个单行的、以逗号分隔的五个误差值列表，每个值四舍五入到八位小数。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题在非局部连续介质力学和近场动力学的原理上有扎实的基础。将非局部变形梯度表述为加权最小二乘泛函的最小化子是该领域的一种标准且成熟的方法。\n- **适定性**：该问题定义了一个清晰的优化任务，其解（一个线性系统）通过建议使用的Tikhonov正则化保证是适定的。所有参数和函数都得到了明确定义。\n- **客观性**：该问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n- **缺陷分析**：\n    1.  **科学/事实不健全**：无。数学和物理框架是健全的。\n    2.  **不可形式化/不相关**：无。该问题是计算力学中一个形式化且相关的任务。\n    3.  **不完整/矛盾的设置**：无。所有必要的参数，包括用于可复现性的随机种子，都已提供。\n    4.  **不现实/不可行**：无。参数集描述了一个标准的数值实验。\n    5.  **病态/结构不良**：无。该问题被构建为从第一性原理到实现和测试的直接路径。\n    6.  **琐碎/同义反复**：虽然仿射场的解析结果是精确的，但该问题要求一个非平凡的实现来证明这一点，并测试在不同离散化和无序度条件下的数值稳定性，这是一个有意义的练习。\n    7.  **超出科学可验证范围**：无。该过程是确定性的，并且在计算上是可验证的。\n\n### 第3步：结论与行动\n该问题是 **有效的**，因为其科学上合理、适定、客观且完全指定。将提供一个解决方案。\n\n### 解决方案推导与算法设计\n\n非局部变形梯度 $\\widehat{\\mathbf{F}}$ 被定义为泛函的最小化子：\n$$\n\\mathcal{J}(\\mathbf{F}) = \\int_{\\mathcal{H}} \\omega(\\|\\boldsymbol{\\xi}\\|) \\left\\| \\mathbf{F}\\,\\boldsymbol{\\xi} - \\boldsymbol{\\eta} \\right\\|^{2}\\,\\mathrm{d}V\n$$\n其中 $\\mathcal{H}$ 是由 $\\|\\boldsymbol{\\xi}\\| \\le \\delta$ 定义的 $\\mathbf{x}_0$ 的邻域。最小值的必要条件是 $\\mathcal{J}$ 关于 $\\mathbf{F}$ 的一阶变分为零。范数内的项是一个向量，因此其平方范数为 $(\\mathbf{F}\\boldsymbol{\\xi} - \\boldsymbol{\\eta}) \\cdot (\\mathbf{F}\\boldsymbol{\\xi} - \\boldsymbol{\\eta})$。这个平方范数关于张量 $\\mathbf{F}$ 的梯度是 $2(\\mathbf{F}\\boldsymbol{\\xi}-\\boldsymbol{\\eta})\\boldsymbol{\\xi}^T$。因此，将整个泛函的梯度设为零张量，得到欧拉-拉格朗日方程：\n$$\n\\nabla_{\\mathbf{F}}\\mathcal{J} = \\int_{\\mathcal{H}} \\omega(\\|\\boldsymbol{\\xi}\\|) \\cdot 2 (\\widehat{\\mathbf{F}}\\boldsymbol{\\xi}-\\boldsymbol{\\eta})\\boldsymbol{\\xi}^T \\,\\mathrm{d}V = \\mathbf{0}\n$$\n展开各项并为 $\\widehat{\\mathbf{F}}$ 重新整理，得到正规方程：\n$$\n\\widehat{\\mathbf{F}} \\left( \\int_{\\mathcal{H}} \\omega(\\|\\boldsymbol{\\xi}\\|) (\\boldsymbol{\\xi} \\otimes \\boldsymbol{\\xi}) \\,\\mathrm{d}V \\right) = \\int_{\\mathcal{H}} \\omega(\\|\\boldsymbol{\\xi}\\|) (\\boldsymbol{\\eta} \\otimes \\boldsymbol{\\xi}) \\,\\mathrm{d}V\n$$\n其中 $\\otimes$ 表示张量积（或对应列向量的外积）。我们定义形状张量 $\\mathbf{K}$ 和混合二元张量 $\\mathbf{M}$ 为：\n$$\n\\mathbf{K} = \\int_{\\mathcal{H}} \\omega(\\|\\boldsymbol{\\xi}\\|) (\\boldsymbol{\\xi} \\otimes \\boldsymbol{\\xi}) \\,\\mathrm{d}V \\quad \\text{和} \\quad \\mathbf{M} = \\int_{\\mathcal{H}} \\omega(\\|\\boldsymbol{\\xi}\\|) (\\boldsymbol{\\eta} \\otimes \\boldsymbol{\\xi}) \\,\\mathrm{d}V\n$$\n于是正规方程为 $\\widehat{\\mathbf{F}} \\mathbf{K} = \\mathbf{M}$。只要 $\\mathbf{K}$ 可逆，解就是 $\\widehat{\\mathbf{F}} = \\mathbf{M} \\mathbf{K}^{-1}$。\n\n对于离散粒子系统，积分被替换为对评估点 $\\mathbf{x}_{0}$ 影响域 $\\delta$ 内的邻居粒子 $j$ 的求和。每个粒子 $j$ 都有一个关联的体积（二维中的面积）$V_j = h^2$。$\\mathbf{K}$ 和 $\\mathbf{M}$ 的离散形式是：\n$$\n\\mathbf{K} = \\sum_{j \\in \\mathcal{H}_{0}} \\omega(\\|\\boldsymbol{\\xi}_j\\|) (\\boldsymbol{\\xi}_j \\otimes \\boldsymbol{\\xi}_j) V_j \\quad \\text{和} \\quad \\mathbf{M} = \\sum_{j \\in \\mathcal{H}_{0}} \\omega(\\|\\boldsymbol{\\xi}_j\\|) (\\boldsymbol{\\eta}_j \\otimes \\boldsymbol{\\xi}_j) V_j\n$$\n其中 $\\boldsymbol{\\xi}_j = \\mathbf{x}_j - \\mathbf{x}_0$ 和 $\\boldsymbol{\\eta}_j = \\mathbf{y}(\\mathbf{x}_j) - \\mathbf{y}(\\mathbf{x}_0)$。求和遍及邻居集合 $\\mathcal{H}_0 = \\{j \\mid 0  \\|\\mathbf{x}_j - \\mathbf{x}_0\\| \\le \\delta\\}$。\n\n如果邻居粒子 $\\mathbf{x}_j$ 分布不佳（例如，共线或近乎共线），形状张量 $\\mathbf{K}$ 可能会是奇异或病态的。为确保解的稳定性，应用 Tikhonov 正则化，即向 $\\mathbf{K}$ 添加一个小的项 $\\lambda \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。正则化后的系统是 $\\widehat{\\mathbf{F}} (\\mathbf{K} + \\lambda \\mathbf{I}) = \\mathbf{M}$，其解为：\n$$\n\\widehat{\\mathbf{F}} = \\mathbf{M} (\\mathbf{K} + \\lambda \\mathbf{I})^{-1}\n$$\n正则化参数 $\\lambda$ 必须与 $\\mathbf{K}$ 的元素在量纲上保持一致，在此二维分析中其单位为 $[L]^4$（来自 $\\boldsymbol{\\xi}\\boldsymbol{\\xi}^T$ 的 $[L]^2$ 和 $V_j$ 的 $[L]^2$）。一个稳健的 $\\lambda$ 选择是使其与 $\\mathbf{K}$ 对角线元素的平均量级成正比。我们选择 $\\lambda = \\epsilon_{reg} \\cdot \\frac{1}{2}\\mathrm{tr}(\\mathbf{K})$，其中 $\\epsilon_{reg} = 10^{-9}$ 是一个小的无量纲常数。这确保正则化能够根据问题的特性（粒子间距和影响域大小）进行适当缩放，同时其值足够小，不会过度使解产生偏差。\n\n对于指定的仿射运动 $\\mathbf{y}(\\mathbf{x}) = (\\mathbf{I}+\\mathbf{A})\\mathbf{x} + \\mathbf{b} = \\mathbf{F}_{\\mathrm{exact}}\\mathbf{x} + \\mathbf{b}$，相对位移向量 $\\boldsymbol{\\eta}_j$ 是：\n$$\n\\boldsymbol{\\eta}_j = \\mathbf{y}(\\mathbf{x}_j) - \\mathbf{y}(\\mathbf{x}_0) = (\\mathbf{F}_{\\mathrm{exact}}\\mathbf{x}_j + \\mathbf{b}) - (\\mathbf{F}_{\\mathrm{exact}}\\mathbf{x}_0 + \\mathbf{b}) = \\mathbf{F}_{\\mathrm{exact}}(\\mathbf{x}_j - \\mathbf{x}_0) = \\mathbf{F}_{\\mathrm{exact}}\\boldsymbol{\\xi}_j\n$$\n将此代入 $\\mathbf{M}$ 的表达式中：\n$$\n\\mathbf{M} = \\sum_{j \\in \\mathcal{H}_{0}} \\omega_j (\\mathbf{F}_{\\mathrm{exact}}\\boldsymbol{\\xi}_j \\otimes \\boldsymbol{\\xi}_j) V_j = \\mathbf{F}_{\\mathrm{exact}} \\left( \\sum_{j \\in \\mathcal{H}_{0}} \\omega_j (\\boldsymbol{\\xi}_j \\otimes \\boldsymbol{\\xi}_j) V_j \\right) = \\mathbf{F}_{\\mathrm{exact}}\\mathbf{K}\n$$\n因此，在没有数值误差的情况下，估计量应该能精确恢复变形梯度：$\\widehat{\\mathbf{F}} = (\\mathbf{F}_{\\mathrm{exact}}\\mathbf{K})\\mathbf{K}^{-1} = \\mathbf{F}_{\\mathrm{exact}}$。这个性质无论粒子位置如何（规则或扰动）都成立。因此，计算出的误差 $e$ 仅因浮点运算限制而非零，其大小将反映实现在不同粒子无序度和邻域大小条件下的数值稳定性。\n\n算法流程如下：\n1.  对于每个测试用例，使用指定的参数和随机种子生成受扰动的粒子位置 $\\mathbf{x}_j$。\n2.  在评估点 $\\mathbf{x}_0$，识别影响域 $\\delta$ 内的所有邻居粒子。\n3.  通过对已识别的邻居求和，计算离散形状张量 $\\mathbf{K}$ 和混合张量 $\\mathbf{M}$。\n4.  从 $\\mathbf{K}$ 的迹计算正则化参数 $\\lambda$。\n5.  求解正则化线性系统，得到估计的变形梯度 $\\widehat{\\mathbf{F}} = \\mathbf{M} (\\mathbf{K} + \\lambda \\mathbf{I})^{-1}$。\n6.  计算精确变形梯度 $\\mathbf{F}_{\\mathrm{exact}} = \\mathbf{I} + \\mathbf{A}$。\n7.  使用 Frobenius 范数计算相对误差 $e$，并将其附加到结果列表中。\n8.  按规定格式化最终的误差列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: (A, b, L, h, delta, p, x0, seed) - No perturbation\n        {'A': np.array([[0.1, 0.2], [-0.05, 0.15]]), 'b': np.array([0.01, -0.02]),\n         'L': 0.5, 'h': 0.05, 'delta': 0.2, 'p': 0.0, 'x0': np.array([0.0, 0.0]), 'seed': 1},\n        # Case 2: Same as Case 1, but with perturbation\n        {'A': np.array([[0.1, 0.2], [-0.05, 0.15]]), 'b': np.array([0.01, -0.02]),\n         'L': 0.5, 'h': 0.05, 'delta': 0.2, 'p': 0.1, 'x0': np.array([0.0, 0.0]), 'seed': 2},\n        # Case 3: Smaller horizon, larger perturbation\n        {'A': np.array([[0.1, 0.2], [-0.05, 0.15]]), 'b': np.array([0.01, -0.02]),\n         'L': 0.5, 'h': 0.05, 'delta': 0.12, 'p': 0.25, 'x0': np.array([0.0, 0.0]), 'seed': 3},\n        # Case 4: Different material parameters and discretization\n        {'A': np.array([[0.05, -0.3], [0.3, -0.02]]), 'b': np.array([0.03, 0.02]),\n         'L': 0.5, 'h': 0.04, 'delta': 0.18, 'p': 0.15, 'x0': np.array([0.0, 0.0]), 'seed': 4},\n        # Case 5: Different material parameters, off-center evaluation point\n        {'A': np.array([[0.12, 0.0], [0.0, -0.08]]), 'b': np.array([0.0, 0.0]),\n         'L': 0.4, 'h': 0.04, 'delta': 0.2, 'p': 0.05, 'x0': np.array([0.35, 0.0]), 'seed': 5},\n    ]\n\n    results = []\n    for params in test_cases:\n        error = calculate_error_for_case(params)\n        results.append(f\"{error:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_error_for_case(params):\n    \"\"\"\n    Calculates the relative Frobenius norm error for a single test case.\n    \"\"\"\n    # Unpack parameters\n    A = params['A']\n    b = params['b']\n    L = params['L']\n    h = params['h']\n    delta = params['delta']\n    p = params['p']\n    x0 = params['x0']\n    seed = params['seed']\n    \n    # Initialize a pseudo-random number generator with a fixed seed for reproducibility.\n    rng = np.random.default_rng(seed)\n\n    # 1. Generate the particle set\n    # Create the nominal square lattice, ensuring endpoints are included.\n    grid_coords = np.arange(-L, L + h / 2, h)\n    xx, yy = np.meshgrid(grid_coords, grid_coords)\n    x_nominal = np.vstack([xx.ravel(), yy.ravel()]).T\n\n    # Add independent Gaussian perturbations to each coordinate.\n    perturbations = rng.normal(loc=0.0, scale=p * h, size=x_nominal.shape)\n    x_perturbed = x_nominal + perturbations\n    \n    # Each particle is assigned an equal volume V_p = h^2.\n    V_p = h**2\n\n    # 2. Identify neighbors of the evaluation point x0\n    neighbor_positions = []\n    for x_j in x_perturbed:\n        xi = x_j - x0\n        dist = np.linalg.norm(xi)\n        # Condition for neighbors: 0  ||xi|| = delta\n        if 0.0  dist = delta:\n            neighbor_positions.append(x_j)\n            \n    if not neighbor_positions:\n        return np.nan\n\n    neighbors = np.array(neighbor_positions)\n\n    # 3. Compute the discrete K (shape) and M (mixed) tensors.\n    K = np.zeros((2, 2))\n    M = np.zeros((2, 2))\n\n    # Define the affine motion for the evaluation point x0.\n    I = np.eye(2)\n    F_exact = I + A\n    y0 = F_exact @ x0 + b\n\n    # Gaussian weight kernel function.\n    def omega(r, delta_):\n        return np.exp(-(r / delta_)**2)\n\n    for x_j in neighbors:\n        # Relative position vector.\n        xi = x_j - x0\n        r = np.linalg.norm(xi)\n        w = omega(r, delta)\n\n        # Compute relative displacement vector eta.\n        y_j = F_exact @ x_j + b\n        eta = y_j - y0\n        \n        # Reshape for outer products.\n        xi_col = xi.reshape(2, 1)\n        eta_col = eta.reshape(2, 1)\n        \n        # Accumulate sums for K and M.\n        K += w * (xi_col @ xi_col.T) * V_p\n        M += w * (eta_col @ xi_col.T) * V_p\n        \n    # 4. Apply Tikhonov regularization and solve for the estimated deformation gradient F_hat.\n    # The regularization parameter lambda is chosen to be a small fraction of the\n    # average of the diagonal elements of K to ensure dimensional consistency and stability.\n    trace_K = np.trace(K)\n    epsilon_reg = 1e-9\n    lambda_reg = epsilon_reg * 0.5 * trace_K\n    \n    # Regularize the shape tensor K.\n    K_reg = K + lambda_reg * np.eye(2)\n    \n    # Solve for F_hat from F_hat * K_reg = M.\n    try:\n        F_hat = M @ np.linalg.inv(K_reg)\n    except np.linalg.LinAlgError:\n        # This is unlikely with regularization but is handled as a precaution.\n        return np.nan\n        \n    # 5. Compute the relative Frobenius norm error.\n    error = np.linalg.norm(F_hat - F_exact, 'fro') / np.linalg.norm(F_exact, 'fro')\n    \n    return error\n\n# Execute the solution process.\nsolve()\n\n```"
        }
    ]
}