{
    "hands_on_practices": [
        {
            "introduction": "时空有限元方法的核心思想是在一个统一的框架内同时离散时间和空间。本练习将引导你完成这一过程的第一步：为一个简单的抛物线型偏微分方程（热传导方程）推导基本的时空单元矩阵。通过这个实践，你将掌握如何利用张量积基函数将时空弱形式分解为独立的空间和时间积分，并确定精确计算这些积分所需的数值求积规则 。",
            "id": "3525793",
            "problem": "考虑热方程作为一维空间域中温度扩散与时间耦合的模型，该模型由偏微分方程 (PDE) $u_{t} - \\kappa u_{xx} = f$ 在 $\\Omega \\times (0,T)$ 上控制，其中 $\\Omega \\subset \\mathbb{R}$ 是一个区间，$\\kappa > 0$ 是热扩散系数，$f$ 是源项。使用有限元法 (FEM)，通过在张量积多项式试探空间中寻找解 $u_{h}(x,t)$ 并与相同次数的张量积多项式检验空间进行检验，建立在单个棱柱形单元 $K = [x_{e},x_{e+1}] \\times [t_{n},t_{n+1}]$ 上的时空离散化。设参考区间 $\\hat{x} \\in [-1,1]$ 上的空间基为 $\\{\\phi_{i}(\\hat{x})\\}_{i=0}^{p_{x}}$，参考区间 $\\hat{t} \\in [-1,1]$ 上的时间基为 $\\{\\psi_{j}(\\hat{t})\\}_{j=0}^{p_{t}}$。假设仿射映射为 $x = x_{c} + (h_{x}/2)\\hat{x}$ 和 $t = t_{c} + (h_{t}/2)\\hat{t}$，其中 $h_{x} = x_{e+1}-x_{e}$ 且 $h_{t} = t_{n+1}-t_{n}$。\n\n从对应于 PDE $u_{t} - \\kappa u_{xx} = f$ 的弱形式出发，且不对时间进行分部积分，推导 $K$ 上的局部单元双线性形式，并展示其如何分离为空间和时间的张量积贡献。计算进入此双线性形式的四个一维矩阵的表达式：空间质量矩阵、空间刚度矩阵、时间质量矩阵和时间导数耦合矩阵。然后，确定空间和时间上充分的张量积高斯-勒让德求积规则，以便对仿射映射和常系数情况下这些矩阵中出现的所有多项式项进行精确积分。\n\n将为达到精确性所需的空间和时间上的最少高斯-勒让德点数表示为多项式次数 $p_{x}$ 和 $p_{t}$ 的解析函数。作为最终答案，使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境将这两个数作为一个单行矩阵提供，矩阵元素按 $(n_{x}, n_{t})$ 顺序排列，其中 $n_{x}$ 是空间中所需的最少点数，$n_{t}$ 是时间中所需的最少点数。无需四舍五入，也无需报告单位。",
            "solution": "我们从热扩散的偏微分方程 (PDE) 开始：\n$$\nu_{t} - \\kappa u_{xx} = f\n$$\n为了在单个时空单元 $K = [x_e, x_{e+1}] \\times [t_n, t_{n+1}]$ 上推导弱形式，我们将偏微分方程乘以一个检验函数 $v(x,t)$ 并在 $K$ 上积分：\n$$\n\\int_{t_n}^{t_{n+1}} \\int_{x_e}^{x_{e+1}} (u_t - \\kappa u_{xx})v \\, dx \\, dt = \\int_{t_n}^{t_{n+1}} \\int_{x_e}^{x_{e+1}} f v \\, dx \\, dt\n$$\n对二阶空间导数项进行分部积分得到：\n$$\n\\int_{K} (u_t v + \\kappa u_x v_x) \\, d(x,t) - \\int_{t_n}^{t_{n+1}} [\\kappa u_x v]_{x_e}^{x_{e+1}} \\, dt = \\int_{K} f v \\, d(x,t)\n$$\n边界项 $\\int_{t_n}^{t_{n+1}} [\\kappa u_x v]_{x_e}^{x_{e+1}} \\, dt$ 在单元矩阵的全局组装过程中处理。局部单元双线性形式 $B_K(u,v)$ 是在单元内部积分的弱形式部分：\n$$\nB_K(u,v) = \\int_{K} (u_t v + \\kappa u_x v_x) \\, d(x,t)\n$$\n现在我们使用给定的仿射映射将此积分映射到参考单元 $\\hat{K} = [-1,1] \\times [-1,1]$ 上：\n$x(\\hat{x}) = x_c + \\frac{h_x}{2}\\hat{x}$ 和 $t(\\hat{t}) = t_c + \\frac{h_t}{2}\\hat{t}$。\n根据链式法则，导数变换如下：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial \\hat{u}}{\\partial \\hat{t}} \\frac{d\\hat{t}}{dt} = \\frac{2}{h_t} \\frac{\\partial \\hat{u}}{\\partial \\hat{t}}\n\\quad \\text{和} \\quad\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial \\hat{u}}{\\partial \\hat{x}} \\frac{d\\hat{x}}{dx} = \\frac{2}{h_x} \\frac{\\partial \\hat{u}}{\\partial \\hat{x}}\n$$\n微分元变换为 $d(x,t) = dx \\, dt = \\frac{h_x}{2} \\frac{h_t}{2} \\, d\\hat{x} \\, d\\hat{t}$。\n将这些代入双线性形式，我们得到：\n$$\nB_K(u,v) = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\left(\\frac{2}{h_t} \\frac{\\partial \\hat{u}}{\\partial \\hat{t}}\\right) \\hat{v} + \\kappa \\left(\\frac{2}{h_x} \\frac{\\partial \\hat{u}}{\\partial \\hat{x}}\\right) \\left(\\frac{2}{h_x} \\frac{\\partial \\hat{v}}{\\partial \\hat{x}}\\right) \\right) \\frac{h_x h_t}{4} \\, d\\hat{x} \\, d\\hat{t}\n$$\n$$\nB_K(u,v) = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{h_x}{2} \\frac{\\partial \\hat{u}}{\\partial \\hat{t}} \\hat{v} + \\kappa \\frac{h_t}{h_x} \\frac{\\partial \\hat{u}}{\\partial \\hat{x}} \\frac{\\partial \\hat{v}}{\\partial \\hat{x}} \\right) \\, d\\hat{x} \\, d\\hat{t}\n$$\n参考单元上的离散解 $\\hat{u}_h(\\hat{x},\\hat{t})$ 被近似为张量积基上的有限和：\n$$\n\\hat{u}_h(\\hat{x},\\hat{t}) = \\sum_{k=0}^{p_x} \\sum_{l=0}^{p_t} u_{kl} \\phi_k(\\hat{x}) \\psi_l(\\hat{t})\n$$\n检验函数 $v$ 选自相同的基，即 $\\hat{v}_h(\\hat{x},\\hat{t}) = \\phi_i(\\hat{x})\\psi_j(\\hat{t})$，其中 $i \\in \\{0, \\dots, p_x\\}$ 且 $j \\in \\{0, \\dots, p_t\\}$。将这些代入双线性形式，得到局部单元矩阵 $A$ 的各项：\n$$\nA_{(ij)(kl)} = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{h_x}{2} \\left[ \\phi_k \\frac{d\\psi_l}{d\\hat{t}} \\right] \\left[ \\phi_i \\psi_j \\right] + \\kappa \\frac{h_t}{h_x} \\left[ \\frac{d\\phi_k}{d\\hat{x}} \\psi_l \\right] \\left[ \\frac{d\\phi_i}{d\\hat{x}} \\psi_j \\right] \\right) \\, d\\hat{x} \\, d\\hat{t}\n$$\n由于基函数的张量积结构，积分可以分离：\n$$\nA_{(ij)(kl)} = \\frac{h_x}{2} \\left(\\int_{-1}^{1} \\phi_k(\\hat{x})\\phi_i(\\hat{x}) \\, d\\hat{x}\\right) \\left(\\int_{-1}^{1} \\psi_j(\\hat{t})\\frac{d\\psi_l}{d\\hat{t}} \\, d\\hat{t}\\right) + \\kappa \\frac{h_t}{h_x} \\left(\\int_{-1}^{1} \\frac{d\\phi_k}{d\\hat{x}}\\frac{d\\phi_i}{d\\hat{x}} \\, d\\hat{x}\\right) \\left(\\int_{-1}^{1} \\psi_l(\\hat{t})\\psi_j(\\hat{t}) \\, d\\hat{t}\\right)\n$$\n这个表达式展示了双线性形式如何分离为一维矩阵的张量积。我们现在可以确定这四个一维矩阵：\n\n1.  **空间质量矩阵 ($M^x$)：**\n    $$ M^x_{ik} = \\int_{-1}^{1} \\phi_i(\\hat{x})\\phi_k(\\hat{x}) \\, d\\hat{x} $$\n2.  **空间刚度矩阵 ($K^x$)：**\n    $$ K^x_{ik} = \\int_{-1}^{1} \\frac{d\\phi_i}{d\\hat{x}}\\frac{d\\phi_k}{d\\hat{x}} \\, d\\hat{x} $$\n3.  **时间质量矩阵 ($M^t$)：**\n    $$ M^t_{jl} = \\int_{-1}^{1} \\psi_j(\\hat{t})\\psi_l(\\hat{t}) \\, d\\hat{t} $$\n4.  **时间导数耦合矩阵 ($C^t$)：**\n    $$ C^t_{jl} = \\int_{-1}^{1} \\psi_j(\\hat{t})\\frac{d\\psi_l}{d\\hat{t}} \\, d\\hat{t} $$\n使用这些定义，矩阵项为 $A_{(ij)(kl)} = \\frac{h_x}{2} M^x_{ik} C^t_{jl} + \\kappa \\frac{h_t}{h_x} K^x_{ik} M^t_{jl}$。\n\n接下来，我们确定为精确积分这些矩阵所需的最少高斯-勒让德求积点数。一个有 $n$ 个点的高斯-勒让德求积规则对于次数最高为 $2n-1$ 的多项式是精确的。\n\n对于空间矩阵：\n- $M^x_{ik}$ 的被积函数 $\\phi_i(\\hat{x})\\phi_k(\\hat{x})$ 是一个次数最多为 $p_x + p_x = 2p_x$ 的多项式。为了精确积分，我们需要 $2n_x - 1 \\ge 2p_x$，这意味着 $n_x \\ge p_x + 1/2$。最小整数值为 $n_x = p_x + 1$。\n- 基函数 $\\phi_k(\\hat{x})$ 的次数最多为 $p_x$，所以其导数 $\\frac{d\\phi_k}{d\\hat{x}}$ 的次数最多为 $p_x - 1$。$K^x_{ik}$ 的被积函数 $\\frac{d\\phi_i}{d\\hat{x}}\\frac{d\\phi_k}{d\\hat{x}}$ 是一个次数最多为 $(p_x - 1) + (p_x - 1) = 2p_x - 2$ 的多项式。为了精确积分，我们需要 $2n_x - 1 \\ge 2p_x - 2$，这意味着 $n_x \\ge p_x - 1/2$。最小整数值为 $n_x = p_x$。\n\n为了精确积分所有空间项，我们必须满足更严格的条件，该条件来自质量矩阵。因此，空间高斯点的最少数目是 $n_x = p_x + 1$。\n\n对于时间矩阵：\n- $M^t_{jl}$ 的被积函数 $\\psi_j(\\hat{t})\\psi_l(\\hat{t})$ 是一个次数最多为 $p_t + p_t = 2p_t$ 的多项式。为了精确积分，我们需要 $2n_t - 1 \\ge 2p_t$，这意味着 $n_t \\ge p_t + 1/2$。最小整数值为 $n_t = p_t + 1$。\n- 基函数 $\\psi_j$ 和 $\\psi_l$ 的次数最多为 $p_t$。其导数 $\\frac{d\\psi_l}{d\\hat{t}}$ 的次数最多为 $p_t - 1$。$C^t_{jl}$ 的被积函数 $\\psi_j(\\hat{t})\\frac{d\\psi_l}{d\\hat{t}}$ 是一个次数最多为 $p_t + (p_t - 1) = 2p_t - 1$ 的多项式。为了精确积分，我们需要 $2n_t - 1 \\ge 2p_t - 1$，这意味着 $n_t \\ge p_t$。最小整数值为 $n_t = p_t$。\n\n为了精确积分所有时间项，我们必须满足更严格的条件，该条件来自时间质量矩阵。因此，时间高斯点的最少数目是 $n_t = p_t + 1$。\n\n为实现精确积分所需的空间最少高斯-勒让德点数为 $n_x = p_x + 1$，时间最少高斯-勒让德点数为 $n_t = p_t + 1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_{x} + 1 & p_{t} + 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推导出单元矩阵的解析表达式后，实际计算中需要依赖数值积分。本练习探讨了如何为线性和非线性项选择合适的时空求积规则，这对于保证计算结果的准确性至关重要。你将通过本练习理解欠积分（underintegration）如何导致被称为“混叠误差”（aliasing error）的数值不稳定现象，并分析其背后的机理，这是确保非线性问题数值解稳定性的关键一步 。",
            "id": "3525820",
            "problem": "考虑一个用于多物理场耦合模拟的时空有限元法 (ST-FEM)，该方法作用于形式为 $K \\times I$ 的单个时空单元上。其中，$K \\subset \\mathbb{R}^d$ 是参考空间超立方体 $[-1,1]^d$ 的一个仿射图像，$I \\subset \\mathbb{R}$ 是参考时间区间 $[-1,1]$ 的一个仿射图像。设试探空间和检验空间为张量积多项式空间，其空间次数为 $p_x \\in \\mathbb{N}$，时间次数为 $p_t \\in \\mathbb{N}$。也就是说，每个基函数都是一个多项式，其在每个空间坐标上的次数最多为 $p_x$，在时间上的次数最多为 $p_t$。假设几何映射是仿射的，因此雅可比行列式在 $K \\times I$ 上为常数。\n\n你需要设计在 $K \\times I$ 上的张量积求积法则，这些法则对于组装 ST-FEM 中出现的典型双线性和非线性形式是精确的。组装过程涉及形式为\n$$\n\\int_{K \\times I} \\phi_i(\\boldsymbol{x},t)\\,\\phi_j(\\boldsymbol{x},t)\\,\\mathrm{d}\\boldsymbol{x}\\,\\mathrm{d}t\n$$\n的质量项积分，以及在代表性的二次非线性项中，形式为\n$$\n\\int_{K \\times I} \\phi_i(\\boldsymbol{x},t)\\,\\phi_j(\\boldsymbol{x},t)\\,\\phi_k(\\boldsymbol{x},t)\\,\\mathrm{d}\\boldsymbol{x}\\,\\mathrm{d}t,\n$$\n的积分，其中 $\\phi_i$、$\\phi_j$ 和 $\\phi_k$ 是给定张量积空间中的基函数，在耦合系统中，被积函数按分量进行理解。\n\n你将选择由每个空间坐标和时间坐标上的一维法则通过张量积构造的求积法则。设具有 $n$ 个点的一维 Gauss–Legendre 法则表示为 $Q^{\\mathrm{GL}}_n$，它对 $[-1,1]$ 上次数最高为 $2n-1$ 的所有多项式都是精确的。设具有 $n$ 个点的一维 Gauss–Lobatto 法则表示为 $Q^{\\mathrm{GLo}}_n$，它对 $[-1,1]$ 上次数最高为 $2n-3$ 的所有多项式都是精确的。\n\n从多项式精确性的第一性原理出发，确定在空间和时间上所需的一维 Gauss–Legendre 点的最小数量，以使张量积求积对于质量项和代表性的二次非线性项是精确的。然后，如果使用积分不足，请推断其产生的混叠误差，并确定稳健的补救措施。假设变量系数最多是仿射的，因此它们不会将被积函数的次数增加到超出基函数所隐含的程度。\n\n选择所有正确的陈述：\n\nA. 对于张量积基次数为 $(p_x,p_t)$ 的 $K \\times I$ 上的双线性质量项，分别在空间和时间上使用 $(n_x,n_t) = (p_x+1,p_t+1)$ 个点的张量积 Gauss–Legendre 求积是精确的。\n\nB. 对于张量积基次数为 $(p_x,p_t)$ 的 $K \\times I$ 上的双线性质量项，在仿射单元上，分别在空间和时间上使用 $(n_x,n_t) = (p_x+1,p_t+1)$ 个点的张量积 Gauss–Lobatto 求积是精确的。\n\nC. 对于一个代表性的二次非线性项，其被积函数是三个空间次数为 $p_x$ 和三个时间次数为 $p_t$ 的基函数的乘积，如果 $(n_x,n_t)$ 满足 $2n_x - 1 \\ge 3p_x$ 和 $2n_t - 1 \\ge 3p_t$，即 $(n_x,n_t) \\ge \\left(\\left\\lceil \\frac{3p_x+1}{2} \\right\\rceil,\\left\\lceil \\frac{3p_t+1}{2} \\right\\rceil\\right)$，则张量积 Gauss–Legendre 求积是精确的。在这种情况下使用 $(n_x,n_t) = (p_x+1,p_t+1)$ 通常会产生混叠。\n\nD. 由非线性形式中的积分不足引入的混叠误差是良性的，并且在网格加密下会消失，而与非线性的多项式次数无关；因此，不需要特殊的补救措施。\n\nE. 在不改变求积或修改离散陈述的情况下，对非线性时空形式中的混叠的一个充分且精确的补救措施是仅对时空质量矩阵应用质量集中。\n\n给出你的选择，并从多项式精确性和张量积求积的第一性原理出发进行证明。同时，讨论当 $2n_x-1$ 或 $2n_t-1$ 小于被积函数的多项式次数时混叠的机制，并概述至少一种无需质量集中即可消除混叠的补救措施。",
            "solution": "### 解答与分析\n求积法则的分析在参考单元上进行，对于单个空间维度，该单元为 $\\hat{K} \\times \\hat{I} = [-1,1] \\times [-1,1]$。到物理单元 $K \\times I$ 的仿射映射涉及一个常数雅可比行列式，因此被积函数的多项式次数不变。如果一个张量积求积法则的每个一维分量法则对于通过对其他变量积分得到的一维多项式是精确的，那么该张量积求积法则对于一个多元多项式就是精确的。由于基和求积的张量积性质，这简化为要求每个坐标方向上的一维求积法则必须对该方向上被积函数的最大多项式次数是精确的。\n\n设 $\\hat{\\phi}(\\xi, \\tau)$ 是参考单元上的基函数，其中 $\\xi \\in [-1,1]$ 是空间坐标，$\\tau \\in [-1,1]$ 是时间坐标。$\\hat{\\phi}$ 在 $\\xi$ 上的次数最多为 $p_x$，在 $\\tau$ 上的次数最多为 $p_t$。通过独立考虑每个空间坐标方向，该分析可扩展到 $d$ 维空间。\n\n**1. 双线性质量项分析**\n质量项的被积函数是两个基函数的乘积，即 $\\phi_i \\phi_j$。在参考单元上，被积函数（忽略常数雅可比行列式）是 $\\hat{\\phi}_i(\\xi, \\tau) \\hat{\\phi}_j(\\xi, \\tau)$。\n- 被积函数在空间坐标 $\\xi$ 上的多项式次数最多为 $p_x + p_x = 2p_x$。\n- 被积函数在时间坐标 $\\tau$ 上的多项式次数最多为 $p_t + p_t = 2p_t$。\n\n为实现精确积分，所选的求积法则必须对这些次数的多项式精确。\n- 使用具有 $n$ 个点的一维 Gauss-Legendre 求积 ($Q^{\\mathrm{GL}}_n$)，它对次数最高为 $2n-1$ 的多项式精确：\n    - 在空间上：我们需要 $2n_x - 1 \\ge 2p_x \\implies n_x \\ge p_x + 1/2$。点的最小整数数量是 $n_x = p_x + 1$。\n    - 在时间上：我们需要 $2n_t - 1 \\ge 2p_t \\implies n_t \\ge p_t + 1/2$。点的最小整数数量是 $n_t = p_t + 1$。\n- 使用具有 $n$ 个点的一维 Gauss-Lobatto 求积 ($Q^{\\mathrm{GLo}}_n$)，它对次数最高为 $2n-3$ 的多项式精确：\n    - 在空间上：我们需要 $2n_x - 3 \\ge 2p_x \\implies n_x \\ge p_x + 3/2$。点的最小整数数量是 $n_x = p_x + 2$。\n    - 在时间上：我们需要 $2n_t - 3 \\ge 2p_t \\implies n_t \\ge p_t + 3/2$。点的最小整数数量是 $n_t = p_t + 2$。\n\n**2. 二次非线性项分析**\n代表性二次非线性项的被积函数是三个基函数的乘积，即 $\\phi_i \\phi_j \\phi_k$。在参考单元上，这是 $\\hat{\\phi}_i(\\xi, \\tau) \\hat{\\phi}_j(\\xi, \\tau) \\hat{\\phi}_k(\\xi, \\tau)$。\n- 被积函数在空间坐标 $\\xi$ 上的多项式次数最多为 $p_x + p_x + p_x = 3p_x$。\n- 被积函数在时间坐标 $\\tau$ 上的多项式次数最多为 $p_t + p_t + p_t = 3p_t$。\n\n为使用一维 Gauss-Legendre 求积 ($Q^{\\mathrm{GL}}_n$) 实现精确积分：\n- 在空间上：我们需要 $2n_x - 1 \\ge 3p_x \\implies n_x \\ge \\frac{3p_x + 1}{2}$。点的最小整数数量是 $n_x = \\lceil \\frac{3p_x+1}{2} \\rceil$。\n- 在时间上：我们需要 $2n_t - 1 \\ge 3p_t \\implies n_t \\ge \\frac{3p_t + 1}{2}$。点的最小整数数量是 $n_t = \\lceil \\frac{3p_t+1}{2} \\rceil$。\n\n### 逐项分析\n\n**A. 对于张量积基次数为 $(p_x,p_t)$ 的 $K \\times I$ 上的双线性质量项，分别在空间和时间上使用 $(n_x,n_t) = (p_x+1,p_t+1)$ 个点的张量积 Gauss–Legendre 求积是精确的。**\n如上所述，质量项被积函数在每个空间坐标上的多项式次数为 $2p_x$，在时间上的多项式次数为 $2p_t$。具有 $n=p+1$ 个点的 Gauss-Legendre 法则对次数最高为 $2(p+1)-1 = 2p+1$ 的多项式是精确的。\n- 对于空间：我们需要对次数 $2p_x$ 精确。具有 $n_x=p_x+1$ 个点的法则对次数最高为 $2p_x+1$ 的多项式精确。由于 $2p_x+1 \\ge 2p_x$，条件得到满足。\n- 对于时间：我们需要对次数 $2p_t$ 精确。具有 $n_t=p_t+1$ 个点的法则对次数最高为 $2p_t+1$ 的多项式精确。由于 $2p_t+1 \\ge 2p_t$，条件得到满足。\n因此，该求积法则是精确的。\n**结论：正确**\n\n**B. 对于张量积基次数为 $(p_x,p_t)$ 的 $K \\times I$ 上的双线性质量项，在仿射单元上，分别在空间和时间上使用 $(n_x,n_t) = (p_x+1,p_t+1)$ 个点的张量积 Gauss–Lobatto 求积是精确的。**\n被积函数在空间上的次数为 $2p_x$，在时间上的次数为 $2p_t$。具有 $n=p+1$ 个点的 Gauss-Lobatto 法则对次数最高为 $2(p+1)-3 = 2p-1$ 的多项式是精确的。\n- 对于空间：我们需要对次数 $2p_x$ 精确。该法则对次数最高为 $2p_x-1$ 的多项式精确。由于对于任何 $p_x \\in \\mathbb{N}$ 都有 $2p_x-1  2p_x$，该法则不精确。\n- 对于时间：类似地，该法则对次数最高为 $2p_t-1$ 的多项式精确，这小于所需的 $2p_t$。\n该法则不精确。\n**结论：错误**\n\n**C. 对于一个代表性的二次非线性项，其被积函数是三个空间次数为 $p_x$ 和三个时间次数为 $p_t$ 的基函数的乘积，如果 $(n_x,n_t)$ 满足 $2n_x - 1 \\ge 3p_x$ 和 $2n_t - 1 \\ge 3p_t$，即 $(n_x,n_t) \\ge \\left(\\left\\lceil \\frac{3p_x+1}{2} \\right\\rceil,\\left\\lceil \\frac{3p_t+1}{2} \\right\\rceil\\right)$，则张量积 Gauss–Legendre 求积是精确的。在这种情况下使用 $(n_x,n_t) = (p_x+1,p_t+1)$ 通常会产生混叠。**\n陈述的第一部分正确地指出了精确性的条件。被积函数在空间上的次数为 $3p_x$，在时间上的次数为 $3p_t$。要使具有 $n$ 个点（对次数最高为 $2n-1$ 的多项式精确）的 Gauss-Legendre 法则精确，我们必须有 $2n_x-1 \\ge 3p_x$ 和 $2n_t-1 \\ge 3p_t$。求解点的最小整数数量恰好得到陈述中的不等式。\n第二部分讨论了使用 $(n_x,n_t) = (p_x+1, p_t+1)$ 个点。该法则对空间次数最高为 $2p_x+1$、时间次数最高为 $2p_t+1$ 的多项式精确。如果被积函数的次数更高，即 $3p_x  2p_x+1$ 或 $3p_t  2p_t+1$，则会发生混叠误差。这些不等式简化为 $p_x  1$ 和 $p_t  1$。由于为了精度，$p_x, p_t$ 通常选择为2或更高，这种积分不足的法则将“通常产生混叠”。对于 $p_x=1$ 的特殊情况，我们有 $3p_x=3$ 和 $2p_x+1=3$，所以法则处于精确的临界点。对于 $p_x=0$（分段常数），$0 \\le 1$，法则精确。然而，“通常”一词正确地反映了对于大多数实际选择 $p_x, p_t  1$ 的情况。\n**结论：正确**\n\n**D. 由非线性形式中的积分不足引入的混叠误差是良性的，并且在网格加密下会消失，而与非线性的多项式次数无关；因此，不需要特殊的补救措施。**\n从数值稳定性的角度来看，这种说法在事实上是错误的并且是危险的。混叠误差的产生是因为求积法则无法区分高次多项式和某些低次多项式（它们在求积点上的值相同）。这种对非线性项的错误表示可能会在高空间/时间频率上引入能量，导致伪振荡，并可能引发灾难性的数值不稳定性。虽然对于某些特定的问题和公式，该方法可能仍然收敛，但这并非普遍原则。在许多情况下，特别是对于对流占优或强非线性问题，混叠会导致不收敛或不稳定的模拟。声称“不需要”补救措施是一种严重的过度简化。\n**结论：错误**\n\n**E. 在不改变求积或修改离散陈述的情况下，对非线性时空形式中的混叠的一个充分且精确的补救措施是仅对时空质量矩阵应用质量集中。**\n这个陈述混淆了两个不相关的概念。在此背景下，混叠是*非线性项*积分 $\\int \\phi_i \\phi_j \\phi_k$ 数值计算中的一个误差。质量集中是修改*质量矩阵*的过程，其矩阵项为 $\\int \\phi_i \\phi_j$，通常是为了使其对角化。改变质量矩阵对非线性项积分的计算方式没有任何影响。它不是对非线性形式中混叠的补救措施。\n**结论：错误**\n\n### 关于混叠和补救措施的讨论\n\n**混叠的机制：** 当一个次数为 $P$ 的多项式 $f(y)$ 使用一个具有 $n$ 个点、仅对次数最高为 $p_{ex}  P$ 的多项式精确的求积法则进行数值积分时，该求积法则计算的是一个唯一的、次数最多为 $n-1$（对于插值型法则）的多项式 $g(y)$ 的精确积分，该多项式在 $n$ 个求积点上与 $f(y)$ 重合。积分的误差 $\\int f(y) dy - \\sum w_k f(y_k)$ 为 $\\int (f(y) - g(y)) dy$。这种现象被称为混叠，因为 $f(y)$ 的高次部分的贡献被错误地表示为或“混叠为”一个低次多项式的贡献。在像 $u_h^2$ 这样的非线性项的背景下，这意味着数值解的高频分量可以相互作用产生低频误差，这会污染解并导致不稳定性。\n\n**混叠的补救措施：**\n问题要求一种不涉及质量集中（这是不相关的）且避免简单增加求积阶数的补救措施。一个主要方法是**通过投影去混叠**。\n问题在于基函数的乘积，例如 $\\phi_j \\phi_k$，创建了一个比原始基空间更高次的多项式。与其直接积分 $\\int \\phi_i (\\phi_j \\phi_k) dV$，可以先将乘积项投影回有限元空间。设 $\\mathcal{V}_h$ 是由 $\\{\\phi_i\\}$ 张成的有限元空间。非线性项可以计算为 $\\int \\phi_i \\mathcal{P}_h(u_h^2) dV$，其中 $u_h = \\sum_j u_j \\phi_j$ 是数值解，$\\mathcal{P}_h$ 是到 $\\mathcal{V}_h$ 上的投影算子（例如，$L^2$ 投影）。现在被积函数 $\\phi_i \\mathcal{P}_h(u_h^2)$ 是来自 $\\mathcal{V}_h$ 的两个函数的乘积。它在每个变量上的次数在空间上最多为 $2p_x$，在时间上最多为 $2p_t$。现在可以使用具有 $(p_x+1, p_t+1)$ 个点的标准 Gauss-Legendre 法则精确计算此积分。这个过程确保了非线性运算的结果在与检验函数作内积之前保持在可表示的多项式空间内，从而以计算投影为代价消除了混叠误差。这类似于谱方法中使用的“3/2法则”或去混淆技术。",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "在多物理场耦合仿真中，不同物理域的网格往往不匹配，这给界面耦合带来了挑战。本练习介绍了一种强大的处理非协调界面的技术——时空砂浆法（space-time mortar method），通过在时空界面上构造$L^2$投影来弱化连续性条件。通过亲手推导相关的质量和耦合矩阵，并分析所构造算子的条件数，你将深入理解该方法在处理复杂界面问题时的灵活性和稳定性要求 。",
            "id": "3525785",
            "problem": "考虑一个带时间的一维空间中的模型多物理场界面耦合，其中两个子域共享一个直的空间界面段 $\\gamma = [0, h_m]$，并在单个时空板 $\\Gamma = \\gamma \\times [0, \\Delta t_m]$ 上耦合。该耦合通过在 $\\Gamma$ 上的一个 $L^2$ 型 Mortar 投影来强制施加某个运动学量（例如，固-声相互作用中的位移迹）的弱连续性。$\\Gamma$ 上的主 (Mortar) 迹空间被选为由空间和时间上的典则线性（帽）基函数张成的双线性张量积空间：\n- 在空间上：$y \\in [0, h_m]$ 上的 $N_1(y) = 1 - \\frac{y}{h_m}$ 和 $N_2(y) = \\frac{y}{h_m}$。\n- 在时间上：$t \\in [0, \\Delta t_m]$ 上的 $T_1(t) = 1 - \\frac{t}{\\Delta t_m}$ 和 $T_2(t) = \\frac{t}{\\Delta t_m}$。\n\n因此，$\\Gamma$ 上的主基为 $\\{N_p(y) T_q(t)\\}_{p,q=1}^{2}$，有四个自由度。从迹空间取为在 $\\Gamma$ 的一个均匀剖分上的分片常数函数空间，该剖分在空间上分为 $r_h \\geq 2$ 个相等的子段，在时间上分为 $r_t \\geq 2$ 个相等的子区间，其中 $r_h$ 和 $r_t$ 均为整数。将从基记为 $\\{\\chi_{i}(y) \\eta_{j}(t)\\}$，其中 $\\chi_{i}$ 是长度为 $h_s = h_m / r_h$ 的第 $i$ 个空间子段的特征函数，$\\eta_{j}$ 是长度为 $\\Delta t_s = \\Delta t_m / r_t$ 的第 $j$ 个时间子区间的特征函数，这给出了 $r_h r_t$ 个从自由度。\n\n使用 $L^2(\\Gamma)$ 内积，定义主质量矩阵块 $M_{mm}$，其元素为\n$$\n(M_{mm})_{(p,q),(p',q')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, N_{p'}(y) T_{q'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t,\n$$\n从质量块 $M_{ss}$（对角阵），其元素为\n$$\n(M_{ss})_{(i,j),(i',j')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} \\chi_i(y) \\eta_j(t)\\, \\chi_{i'}(y) \\eta_{j'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t,\n$$\n以及交叉耦合块 $M_{ms}$，其元素为\n$$\n(M_{ms})_{(p,q),(i,j)} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, \\chi_i(y) \\eta_j(t)\\, \\mathrm{d}y\\, \\mathrm{d}t.\n$$\n\n从这些定义和 Mortar 投影原理（$L^2(\\Gamma)$ 中的最小二乘）出发，计算 $M_{mm}$、$M_{ss}$ 和 $M_{ms}$ 的显式形式，并构造 $4 \\times 4$ 的对称正定正规算子\n$$\nA = M_{mm}^{-1} \\, M_{ms} \\, M_{ss}^{-1} \\, M_{sm},\n$$\n其中 $M_{sm} = M_{ms}^{\\top}$。然后，使用第一性原理和精确积分，推导谱2-范数条件数 $\\kappa_2(A)$ 关于整数比 $r_h = h_m / h_s$ 和 $r_t = \\Delta t_m / \\Delta t_s$ 的闭式表达式。\n\n将最终的条件数表示为关于 $r_h$ 和 $r_t$ 的单个闭式解析表达式。不需要四舍五入，答案中不应包含物理单位。",
            "solution": "目标是求出 $4 \\times 4$ 矩阵 $A = M_{mm}^{-1} \\, M_{ms} \\, M_{ss}^{-1} \\, M_{sm}$ 的谱条件数 $\\kappa_2(A)$。解决这个问题的关键是识别并利用基函数和区域的张量积结构。\n\n$\\Gamma = [0, h_m] \\times [0, \\Delta t_m]$ 上的主基函数具有 $N_p(y)T_q(t)$ 的形式。定义矩阵元素的积分在空间变量 $y$ 和时间变量 $t$ 上是可分离的。\n\n首先，我们分析主质量矩阵 $M_{mm}$。其元素为：\n$$(M_{mm})_{(p,q),(p',q')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, N_{p'}(y) T_{q'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t$$\n$$= \\left( \\int_{0}^{h_m} N_p(y) N_{p'}(y) \\mathrm{d}y \\right) \\left( \\int_{0}^{\\Delta t_m} T_q(t) T_{q'}(t) \\mathrm{d}t \\right)$$\n我们为空间域和时间域定义 $2 \\times 2$ 的一维质量矩阵：\n$$(M_y)_{pp'} = \\int_{0}^{h_m} N_p(y) N_{p'}(y) \\mathrm{d}y, \\quad p, p' \\in \\{1, 2\\}$$\n$$(M_t)_{qq'} = \\int_{0}^{\\Delta t_m} T_q(t) T_{q'}(t) \\mathrm{d}t, \\quad q, q' \\in \\{1, 2\\}$$\n那么，$4 \\times 4$ 的主质量矩阵就是这两个矩阵的克罗内克积：$M_{mm} = M_y \\otimes M_t$。\n\n接下来，我们分析从质量矩阵 $M_{ss}$。从基函数 $\\{\\chi_i(y) \\eta_j(t)\\}$ 具有不相交的支集。\n$$(M_{ss})_{(i,j),(i',j')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} \\chi_i(y) \\eta_j(t)\\, \\chi_{i'}(y) \\eta_{j'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t = \\delta_{ii'} \\delta_{jj'} \\int_{(j-1)\\Delta t_s}^{j\\Delta t_s} \\int_{(i-1)h_s}^{ih_s} \\mathrm{d}y\\, \\mathrm{d}t$$\n该积分是从单元的面积，即 $h_s \\Delta t_s$。因此，$M_{ss}$ 是一个大小为 $(r_h r_t) \\times (r_h r_t)$ 的对角矩阵，所有对角元都等于 $h_s \\Delta t_s$。\n$$M_{ss} = (h_s \\Delta t_s) I_{r_h r_t}$$\n其中 $I_k$ 是 $k \\times k$ 的单位矩阵。其逆矩阵为 $M_{ss}^{-1} = \\frac{1}{h_s \\Delta t_s} I_{r_h r_t}$。\n\n现在，我们考虑交叉耦合矩阵 $M_{ms}$。其元素为：\n$$(M_{ms})_{(p,q),(i,j)} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, \\chi_i(y) \\eta_j(t)\\, \\mathrm{d}y\\, \\mathrm{d}t$$\n$$= \\left( \\int_{0}^{h_m} N_p(y) \\chi_i(y) \\mathrm{d}y \\right) \\left( \\int_{0}^{\\Delta t_m} T_q(t) \\eta_j(t) \\mathrm{d}t \\right) = \\left( \\int_{(i-1)h_s}^{ih_s} N_p(y) \\mathrm{d}y \\right) \\left( \\int_{(j-1)\\Delta t_s}^{j\\Delta t_s} T_q(t) \\mathrm{d}t \\right)$$\n我们定义 $2 \\times r_h$ 和 $2 \\times r_t$ 的一维耦合矩阵：\n$$(C_y)_{pi} = \\int_{(i-1)h_s}^{ih_s} N_p(y) \\mathrm{d}y, \\quad p \\in \\{1,2\\}, i \\in \\{1, \\dots, r_h\\}$$\n$$(C_t)_{qj} = \\int_{(j-1)\\Delta t_s}^{j\\Delta t_s} T_q(t) \\mathrm{d}t, \\quad q \\in \\{1,2\\}, j \\in \\{1, \\dots, r_t\\}$$\n交叉耦合矩阵 $M_{ms}$ 是一个 $4 \\times (r_h r_t)$ 矩阵，可以表示为克罗内克积 $M_{ms} = C_y \\otimes C_t$。\n\n现在我们构造算子 $A$。\n$$A = M_{mm}^{-1} \\, M_{ms} \\, M_{ss}^{-1} \\, M_{sm}$$\n使用克罗内克积的表示法和性质 $(B \\otimes C)^{-1} = B^{-1} \\otimes C^{-1}$ 和 $(B \\otimes C)^\\top = B^\\top \\otimes C^\\top$：\n$$A = (M_y \\otimes M_t)^{-1} (C_y \\otimes C_t) \\left( \\frac{1}{h_s \\Delta t_s} I_{r_h r_t} \\right) (C_y \\otimes C_t)^\\top$$\n$$A = (M_y^{-1} \\otimes M_t^{-1}) (C_y \\otimes C_t) \\frac{1}{h_s \\Delta t_s} (C_y^\\top \\otimes C_t^\\top)$$\n使用混合积性质 $(B_1 \\otimes C_1)(B_2 \\otimes C_2) = (B_1 B_2) \\otimes (C_1 C_2)$：\n$$A = \\frac{1}{h_s \\Delta t_s} (M_y^{-1} \\otimes M_t^{-1}) (C_y C_y^\\top \\otimes C_t C_t^\\top)$$\n$$A = \\frac{1}{h_s \\Delta t_s} (M_y^{-1} C_y C_y^\\top) \\otimes (M_t^{-1} C_t C_t^\\top)$$\n$$A = \\left( \\frac{1}{h_s} M_y^{-1} C_y C_y^\\top \\right) \\otimes \\left( \\frac{1}{\\Delta t_s} M_t^{-1} C_t C_t^\\top \\right)$$\n令 $A_y = \\frac{1}{h_s} M_y^{-1} C_y C_y^\\top$ 和 $A_t = \\frac{1}{\\Delta t_s} M_t^{-1} C_t C_t^\\top$。那么 $A = A_y \\otimes A_t$。\n克罗内克积的特征值是各因子矩阵特征值的乘积。由于 $A$ 是对称正定矩阵，其谱条件数是其最大特征值与最小特征值的比值。\n$$\\kappa_2(A) = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)} = \\frac{\\lambda_{\\max}(A_y) \\lambda_{\\max}(A_t)}{\\lambda_{\\min}(A_y) \\lambda_{\\min}(A_t)} = \\kappa_2(A_y) \\kappa_2(A_t)$$\n问题归结为求解一个通用的一维情况。让我们求解 $A_y$。\n\n空间基函数为 $N_1(y) = 1 - y/h_m$ 和 $N_2(y) = y/h_m$。\n一维质量矩阵 $M_y$ 为：\n$$(M_y)_{11} = \\int_0^{h_m} (1 - y/h_m)^2 \\mathrm{d}y = \\frac{h_m}{3}$$\n$$(M_y)_{22} = \\int_0^{h_m} (y/h_m)^2 \\mathrm{d}y = \\frac{h_m}{3}$$\n$$(M_y)_{12} = (M_y)_{21} = \\int_0^{h_m} (1 - y/h_m)(y/h_m) \\mathrm{d}y = \\frac{h_m}{6}$$\n所以，$M_y = \\frac{h_m}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$。其逆矩阵为 $M_y^{-1} = \\frac{2}{h_m} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$。\n\n一维耦合矩阵 $C_y$ 的元素为：\n$$(C_y)_{1i} = \\int_{(i-1)h_s}^{ih_s} (1 - y/h_m) \\mathrm{d}y = h_s\\left(1 - \\frac{2i-1}{2r_h}\\right)$$\n$$(C_y)_{2i} = \\int_{(i-1)h_s}^{ih_s} (y/h_m) \\mathrm{d}y = h_s\\frac{2i-1}{2r_h}$$\n我们需要计算 $G_y = C_y C_y^\\top$。这是一个 $2 \\times 2$ 矩阵，其元素为 $(G_y)_{pp'} = \\sum_{i=1}^{r_h} (C_y)_{pi} (C_y)_{p'i}$。利用求和法则 $\\sum_{i=1}^{n} (2i-1) = n^2$ 和 $\\sum_{i=1}^{n} (2i-1)^2 = \\frac{n(4n^2-1)}{3}$：\n$$(G_y)_{22} = \\sum_{i=1}^{r_h} \\left(h_s\\frac{2i-1}{2r_h}\\right)^2 = \\frac{h_s^2}{4r_h^2} \\sum_{i=1}^{r_h} (2i-1)^2 = \\frac{h_s^2}{4r_h^2} \\frac{r_h(4r_h^2-1)}{3} = \\frac{h_s^2(4r_h^2-1)}{12r_h}$$\n$$(G_y)_{11} = \\sum_{i=1}^{r_h} h_s^2 \\left(1 - \\frac{2i-1}{2r_h}\\right)^2 = h_s^2 \\sum_{i=1}^{r_h} \\left(1 - \\frac{2i-1}{r_h} + \\frac{(2i-1)^2}{4r_h^2}\\right) = h_s^2 \\left(r_h - \\frac{r_h^2}{r_h} + \\frac{r_h(4r_h^2-1)}{12r_h^2}\\right) = \\frac{h_s^2(4r_h^2-1)}{12r_h}$$\n$$(G_y)_{12} = \\sum_{i=1}^{r_h} h_s\\left(1 - \\frac{2i-1}{2r_h}\\right) h_s\\frac{2i-1}{2r_h} = \\frac{h_s^2}{2r_h}\\sum(2i-1) - \\frac{h_s^2}{4r_h^2}\\sum(2i-1)^2 = \\frac{h_s^2 r_h^2}{2r_h} - (G_y)_{22} = \\frac{h_s^2 r_h}{2} - \\frac{h_s^2(4r_h^2-1)}{12r_h} = \\frac{h_s^2(2r_h^2+1)}{12r_h}$$\n所以 $G_y = \\frac{h_s^2}{12r_h} \\begin{pmatrix} 4r_h^2-1  2r_h^2+1 \\\\ 2r_h^2+1  4r_h^2-1 \\end{pmatrix}$。\n\n现在，我们计算 $A_y = \\frac{1}{h_s} M_y^{-1} G_y$。使用 $h_m = r_h h_s$：\n$$A_y = \\frac{1}{h_s} \\left(\\frac{2}{r_h h_s} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\\right) \\left(\\frac{h_s^2}{12r_h} \\begin{pmatrix} 4r_h^2-1  2r_h^2+1 \\\\ 2r_h^2+1  4r_h^2-1 \\end{pmatrix}\\right)$$\n$$A_y = \\frac{1}{6r_h^2} \\begin{pmatrix} 2(4r_h^2-1)-(2r_h^2+1)  2(2r_h^2+1)-(4r_h^2-1) \\\\ -(4r_h^2-1)+2(2r_h^2+1)  -(2r_h^2+1)+2(4r_h^2-1) \\end{pmatrix}$$\n$$A_y = \\frac{1}{6r_h^2} \\begin{pmatrix} 6r_h^2-3  3 \\\\ 3  6r_h^2-3 \\end{pmatrix} = \\begin{pmatrix} 1-\\frac{1}{2r_h^2}  \\frac{1}{2r_h^2} \\\\ \\frac{1}{2r_h^2}  1-\\frac{1}{2r_h^2} \\end{pmatrix}$$\n一个形如 $\\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}$ 的 $2 \\times 2$ 矩阵的特征值 $\\lambda$ 为 $\\lambda_1 = a+b$ 和 $\\lambda_2 = a-b$。\n对于 $A_y$，$a = 1-\\frac{1}{2r_h^2}$ 且 $b = \\frac{1}{2r_h^2}$。\n特征值为 $\\lambda_{y,\\max} = a+b = 1$ 和 $\\lambda_{y,\\min} = a-b = 1-\\frac{1}{r_h^2}$。\n$A_y$ 的条件数为：\n$$\\kappa_2(A_y) = \\frac{\\lambda_{y,\\max}}{\\lambda_{y,\\min}} = \\frac{1}{1 - 1/r_h^2} = \\frac{r_h^2}{r_h^2-1}$$\n以此类推，对时间维度的分析是完全相同的，只需将 $h_m, h_s, r_h$ 替换为 $\\Delta t_m, \\Delta t_s, r_t$。\n$$\\kappa_2(A_t) = \\frac{r_t^2}{r_t^2-1}$$\n最后，完整算子 $A$ 的条件数是一维条件数的乘积：\n$$\\kappa_2(A) = \\kappa_2(A_y) \\kappa_2(A_t) = \\left(\\frac{r_h^2}{r_h^2-1}\\right) \\left(\\frac{r_t^2}{r_t^2-1}\\right) = \\frac{r_h^2 r_t^2}{(r_h^2-1)(r_t^2-1)}$$\n这就是谱条件数关于 $r_h$ 和 $r_t$ 的闭式表达式。",
            "answer": "$$\\boxed{\\frac{r_h^2 r_t^2}{(r_h^2-1)(r_t^2-1)}}$$"
        }
    ]
}