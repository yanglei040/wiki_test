{
    "hands_on_practices": [
        {
            "introduction": "在分析多物理场耦合时，第一步是从控制方程中识别和量化其强度。量纲分析是一种强大的工具，它能揭示问题的内在尺度和不同物理效应的相对重要性。本练习将引导您在一个经典的共轭传热问题中，从第一性原理出发，通过对控制方程进行无量纲化，推导出关键的无量纲数，从而展示耦合参数是如何从物理现象中自然产生的。",
            "id": "3502116",
            "problem": "一个平面共轭热流体系统由一种牛顿不可压缩液体组成，该液体在水力高度为 $L_{f}$ 的长直通道中稳定流动，通道下方由厚度为 $L_{s}$ 的固板界定。流体的密度为 $\\rho_{f}$，动力粘度为 $\\mu_{f}$，热导率为 $k_{f}$，定压比热容为 $c_{p,f}$。平均流向速度为 $U$。固体的热导率为 $k_{s}$。固体的外表面（远离流体的一侧）暴露在温度为 $T_{\\infty}$ 的环境中，其均匀对流换热系数为 $h_{\\infty}$。流体中的粘性耗散先验地不可忽略。假设系统处于稳态，两相中的体积热源可忽略不计，且无相变发生。设流动为层流，且在流体动力学上是完全发展的。\n\n从控制守恒定律（质量、动量和能量）和本构关系（牛顿应力和傅里叶热传导）出发，使用以下特征尺度对流固耦合问题进行无量纲化：流体中的长度尺度为 $L_{f}$，固体中的长度尺度为 $L_{s}$，速度尺度为 $U$，以及一个由代表性壁面温度与环境温度之差定义的特征温差 $\\Delta T \\equiv T_{\\text{wall,ref}} - T_{\\infty}$。通过这种第一性原理的无量纲化，确定：\n\n- 量化固体外表面上固体导热与外部对流之间界面耦合的毕渥数，\n- 量化流体能量输运中平流-扩散竞争的佩克莱数，\n- 量化流体能量方程中由粘性耗散引起的热-动量相互作用的交叉耦合数。\n\n用问题的有量纲参数明确表示这三个无量纲数群。\n\n然后，根据以下数据，数值计算这三个无量纲数，并按（毕渥数、佩克莱数、交叉耦合数）的顺序列出，结果为四舍五入到 $4$ 位有效数字的无量纲值：\n- $L_{f} = 2.0 \\times 10^{-3} \\text{ m}$, $L_{s} = 2.0 \\times 10^{-3} \\text{ m}$，\n- $U = 3.0 \\times 10^{-2} \\text{ m s}^{-1}$，\n- $\\rho_{f} = 1.000 \\times 10^{3} \\text{ kg m}^{-3}$, $\\mu_{f} = 1.0 \\times 10^{-3} \\text{ Pa s}$，\n- $k_{f} = 0.60 \\text{ W m}^{-1} \\text{ K}^{-1}$, $c_{p,f} = 4.180 \\times 10^{3} \\text{ J kg}^{-1} \\text{ K}^{-1}$，\n- $k_{s} = 15 \\text{ W m}^{-1} \\text{ K}^{-1}$, $h_{\\infty} = 5.00 \\times 10^{2} \\text{ W m}^{-2} \\text{ K}^{-1}$，\n- $\\Delta T = 5.0 \\text{ K}$。\n\n将你的最终答案表述为按指定顺序排列的一行三个数。四舍五入到 $4$ 位有效数字。在最终报告的行中不要包含单位；根据定义，这三个数都是无量纲的。",
            "solution": "该问题要求通过对共轭传热问题进行第一性原理无量纲化，来确定并计算三个特定的无量纲数。此过程始于流体域和固体域的控制守恒定律。\n\n设流向坐标为 $x$，横向坐标为 $y$。流体占据区域 $0 \\le y \\le L_{f}$，固体占据区域 $-L_{s} \\le y \\le 0$。\n\n**1. 控制方程和边界条件**\n\n对于流体域 ($0 \\le y \\le L_{f}$)，不可压缩牛顿液体的稳态控制方程为：\n- 质量守恒：$\\nabla \\cdot \\mathbf{u} = 0$\n- 动量守恒 (Navier-Stokes)：$\\rho_{f} (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = -\\nabla p + \\mu_{f} \\nabla^2 \\mathbf{u}$\n- 能量守恒：$\\rho_{f} c_{p,f} (\\mathbf{u} \\cdot \\nabla) T_{f} = k_{f} \\nabla^2 T_{f} + \\Phi_{v}$\n\n对于固体域 ($-L_{s} \\le y \\le 0$)，稳态能量守恒方程（热传导）为：\n- 能量守恒：$k_{s} \\nabla^2 T_{s} = 0$\n\n鉴于流动是流体动力学上完全发展的， $y$ 方向的速度分量为零 ($v=0$)，且流向速度 $u$ 仅依赖于 $y$，即 $u=u(y)$。流体 ($T_{f}$) 和固体 ($T_{s}$) 的能量方程得以简化。我们忽略流体中相对于对流的轴向导热，以及固体中相对于横向导热的轴向导热，这是长通道（高佩克莱数流动）的常见假设。\n\n简化的流体能量方程为：\n$$ \\rho_{f} c_{p,f} u(y) \\frac{\\partial T_{f}}{\\partial x} = k_{f} \\frac{\\partial^2 T_{f}}{\\partial y^2} + \\mu_{f} \\left(\\frac{du}{dy}\\right)^2 $$\n简化的固体能量方程为：\n$$ k_{s} \\frac{\\partial^2 T_{s}}{\\partial y^2} = 0 $$\n相关的边界条件位于固体的外表面 ($y = -L_{s}$):\n$$ -k_{s} \\frac{\\partial T_{s}}{\\partial y} \\bigg|_{y=-L_{s}} = h_{\\infty} \\left( T_{s}|_{y=-L_{s}} - T_{\\infty} \\right) $$\n\n**2. 无量纲化**\n\n我们按规定引入无量纲变量。\n- 流体域坐标：$y_{f}^{*} = y/L_{f}$\n- 固体域坐标：$y_{s}^{*} = y/L_{s}$\n- 速度：$u^{*} = u/U$\n- 温度（两域）：$\\theta = (T - T_{\\infty}) / \\Delta T$，其中 $\\Delta T = T_{\\text{wall,ref}} - T_{\\infty}$。\n$x$ 方向的特征长度尺度可取为 $L_{f}$，因此 $x^{*} = x/L_{f}$。\n\n首先，我们对流体能量方程进行无量纲化。代入无量纲变量：\n$$ \\rho_{f} c_{p,f} (U u^{*}) \\frac{\\partial (\\Delta T \\theta_{f} + T_{\\infty})}{\\partial (L_{f} x^{*})} = k_{f} \\frac{\\partial^2 (\\Delta T \\theta_{f} + T_{\\infty})}{\\partial (L_{f} y_{f}^{*})^2} + \\mu_{f} \\left(\\frac{d(U u^{*})}{d(L_{f} y_{f}^{*})}\\right)^2 $$\n$$ \\frac{\\rho_{f} c_{p,f} U \\Delta T}{L_{f}} u^{*} \\frac{\\partial \\theta_{f}}{\\partial x^{*}} = \\frac{k_{f} \\Delta T}{L_{f}^2} \\frac{\\partial^2 \\theta_{f}}{\\partial (y_{f}^{*})^2} + \\frac{\\mu_{f} U^2}{L_{f}^2} \\left(\\frac{du^{*}}{dy_{f}^{*}}\\right)^2 $$\n为使方程无量纲化，我们用扩散项的系数 $k_{f} \\Delta T / L_{f}^2$ 去除各项：\n$$ \\left(\\frac{\\rho_{f} c_{p,f} U L_{f}}{k_{f}}\\right) u^{*} \\frac{\\partial \\theta_{f}}{\\partial x^{*}} = \\frac{\\partial^2 \\theta_{f}}{\\partial (y_{f}^{*})^2} + \\left(\\frac{\\mu_{f} U^2}{k_{f} \\Delta T}\\right) \\left(\\frac{du^{*}}{dy_{f}^{*}}\\right)^2 $$\n\n从这个方程中，我们确定了两个无量纲数群：\n- 平流项的系数是**佩克莱数 (Pe)**，它量化了流体中平流与扩散传热之比。\n$$ \\text{Pe} = \\frac{\\rho_{f} c_{p,f} U L_{f}}{k_{f}} $$\n- 粘性耗散项的系数是连接动量和能量输运的**交叉耦合数**。这也被称为布林克曼数 (Br)。\n$$ \\text{Cross-coupling number (Br)} = \\frac{\\mu_{f} U^2}{k_{f} \\Delta T} $$\n\n接下来，我们对固体在 $y = -L_{s}$（对应于 $y_{s}^{*} = -1$）处的外边界条件进行无量纲化。\n$$ -k_{s} \\frac{\\partial (\\Delta T \\theta_{s} + T_{\\infty})}{\\partial (L_{s} y_{s}^{*})} \\bigg|_{y_{s}^{*}=-1} = h_{\\infty} \\left( (\\Delta T \\theta_{s} + T_{\\infty})|_{y_{s}^{*}=-1} - T_{\\infty} \\right) $$\n$$ -\\frac{k_{s} \\Delta T}{L_{s}} \\frac{\\partial \\theta_{s}}{\\partial y_{s}^{*}} \\bigg|_{y_{s}^{*}=-1} = h_{\\infty} \\Delta T \\theta_{s}|_{y_{s}^{*}=-1} $$\n用 $k_{s} \\Delta T / L_{s}$ 去除各项得到无量纲边界条件：\n$$ -\\frac{\\partial \\theta_{s}}{\\partial y_{s}^{*}} \\bigg|_{y_{s}^{*}=-1} = \\left(\\frac{h_{\\infty} L_{s}}{k_{s}}\\right) \\theta_{s}|_{y_{s}^{*}=-1} $$\n此表达式中的无量纲数群是**毕渥数 (Bi)**，它量化了固体内部的导热热阻与其表面的外部对流换热热阻之比。\n$$ \\text{Bi} = \\frac{h_{\\infty} L_{s}}{k_{s}} $$\n\n**3. 数值计算**\n\n给定以下数据：\n- $L_{f} = 2.0 \\times 10^{-3} \\text{ m}$, $L_{s} = 2.0 \\times 10^{-3} \\text{ m}$\n- $U = 3.0 \\times 10^{-2} \\text{ m s}^{-1}$\n- $\\rho_{f} = 1.000 \\times 10^{3} \\text{ kg m}^{-3}$\n- $\\mu_{f} = 1.0 \\times 10^{-3} \\text{ Pa s}$\n- $k_{f} = 0.60 \\text{ W m}^{-1} \\text{ K}^{-1}$\n- $c_{p,f} = 4.180 \\times 10^{3} \\text{ J kg}^{-1} \\text{ K}^{-1}$\n- $k_{s} = 15 \\text{ W m}^{-1} \\text{ K}^{-1}$\n- $h_{\\infty} = 5.00 \\times 10^{2} \\text{ W m}^{-2} \\text{ K}^{-1}$\n- $\\Delta T = 5.0 \\text{ K}$\n\n我们现在计算这三个无量纲数的值，并四舍五入到 $4$ 位有效数字。\n\n- **毕渥数 (Bi)**:\n$$ \\text{Bi} = \\frac{h_{\\infty} L_{s}}{k_{s}} = \\frac{(5.00 \\times 10^{2} \\text{ W m}^{-2} \\text{ K}^{-1}) (2.0 \\times 10^{-3} \\text{ m})}{15 \\text{ W m}^{-1} \\text{ K}^{-1}} = \\frac{1.0}{15} \\approx 0.066667 $$\n保留 $4$ 位有效数字，$\\text{Bi} = 0.06667$。\n\n- **佩克莱数 (Pe)**:\n$$ \\text{Pe} = \\frac{\\rho_{f} c_{p,f} U L_{f}}{k_{f}} = \\frac{(1.000 \\times 10^{3}) (4.180 \\times 10^{3}) (3.0 \\times 10^{-2}) (2.0 \\times 10^{-3})}{0.60} $$\n$$ \\text{Pe} = \\frac{250.8}{0.60} = 418.0 $$\n这个值是精确的，并且已经有 $4$ 位有效数字。\n\n- **交叉耦合数 (Br)**:\n$$ \\text{Br} = \\frac{\\mu_{f} U^2}{k_{f} \\Delta T} = \\frac{(1.0 \\times 10^{-3} \\text{ Pa s}) (3.0 \\times 10^{-2} \\text{ m s}^{-1})^2}{(0.60 \\text{ W m}^{-1} \\text{ K}^{-1}) (5.0 \\text{ K})} $$\n$$ \\text{Br} = \\frac{(1.0 \\times 10^{-3}) (9.0 \\times 10^{-4})}{3.0} = \\frac{9.0 \\times 10^{-7}}{3.0} = 3.0 \\times 10^{-7} $$\n保留 $4$ 位有效数字，$\\text{Br} = 3.000 \\times 10^{-7}$。\n\n这三个无量纲数按要求的顺序（毕渥数、佩克莱数、交叉耦合数）分别为 $0.06667$、$418.0$ 和 $3.000 \\times 10^{-7}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06667  418.0  3.000 \\times 10^{-7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "识别出物理耦合的存在后，下一个逻辑问题是：它如何影响我们的仿真策略？本练习将探讨在分区求解器（实现简单但稳定性较差）和整体式求解器（更稳健但更复杂）之间的经典权衡。通过分析一个通用的线性化多物理场模型，您将学习如何推导出一个定量的耦合强度指标，该指标能直接预测分区迭代格式的收敛性，从而为选择合适的数值算法提供理论依据。",
            "id": "3502166",
            "problem": "考虑一个通用的双场多物理场系统，其主要未知量为 $u$ 和 $v$（例如，一个热弹性对，其中 $u$ 代表温度场，$v$ 代表力学场）。在一个标称工作点附近，对平衡律进行一阶线性化，并在单个时间步上进行一阶隐式时间离散化，得到以下形式的单体残差：\n$$\nR_u(u,v) \\approx K_u\\,u - S_{uv}\\,v, \\qquad R_v(u,v) \\approx K_v\\,v - S_{vu}\\,u,\n$$\n其中 $K_u>0$ 和 $K_v>0$ 代表主要的自影响模量（例如，包括容量、刚度和隐式时间步的贡献），$S_{uv}$ 和 $S_{vu}$ 代表从线性化物理中获得的交叉影响模量（例如，热弹性膨胀、焦耳热敏感性或附加质量效应）。为了形成无量纲表示，分别为 $u$ 和 $v$ 引入特征尺度 $U_{\\ast}>0$ 和 $V_{\\ast}>0$，并定义缩放后的未知量 $\\hat{u} = u/U_{\\ast}$ 和 $\\hat{v} = v/V_{\\ast}$。\n\n在一个时间步内，标准的交错（块 Gauss–Seidel）分裂式外迭代首先根据最新的 $v$ 值更新 $u$，然后根据新的 $u$ 值更新 $v$。仅使用上面给出的信息以及基本的线性化和迭代原理，完成以下任务：\n\n1. 构建残差关于 $(\\hat{u},\\hat{v})$ 的无量纲块雅可比矩阵。\n2. 推导一次完整的分裂式外迭代（给定 $v$ 更新 $u$，然后给定 $u$ 更新 $v$）所对应的 $2\\times 2$ 线性误差传播算子。\n3. 从该算子中，定义一个标量、无量纲的耦合强度 $C$，该强度需与不动点收敛性分析相符，并量化在一次外迭代中传递的交叉影响与自影响之比的几何平均值。\n4. 使用数值\n$$\nK_u = 2.5 \\times 10^{6},\\quad K_v = 1.0 \\times 10^{6},\\quad S_{uv} = 1.5 \\times 10^{6},\\quad S_{vu} = 2.4 \\times 10^{6},\n$$\n和特征尺度\n$$\nU_{\\ast} = 2.0,\\qquad V_{\\ast} = 5.0,\n$$\n计算 $C$ 的数值。将最终的耦合强度表示为一个无量纲数，并将您的答案四舍五入到 $3$ 位有效数字。\n\n最后，根据 $C$ 的值，将耦合机制分类为弱耦合（$C \\ll 1$）、中等耦合（$C \\sim 1$）或强耦合（$C \\gg 1$），并简要评论分裂式不动点法与全耦合单体牛顿求解相比，预期的算法影响。您的分类和讨论应包含在解题过程中，而不是在最终的数值答案中。",
            "solution": "**求解推导**\n\n分析按照问题陈述的要求分四个部分进行。\n\n**1. 无量纲块雅可比矩阵**\n\n首先，我们用无量纲对应量 $\\hat{u}$ 和 $\\hat{v}$ 来表示未知量 $u$ 和 $v$：\n$$ u = U_{\\ast} \\hat{u} $$\n$$ v = V_{\\ast} \\hat{v} $$\n将这些代入线性化的残差表达式中，得到：\n$$ R_u = K_u (U_{\\ast} \\hat{u}) - S_{uv} (V_{\\ast} \\hat{v}) $$\n$$ R_v = K_v (V_{\\ast} \\hat{v}) - S_{vu} (U_{\\ast} \\hat{u}) $$\n为了形成一个无量纲系统，我们对残差方程进行缩放。对于 $R_u$ 和 $R_v$，一个自然的选择是分别使用缩放因子 $K_u U_{\\ast}$ 和 $K_v V_{\\ast}$。这产生了无量纲残差 $\\hat{R}_u$ 和 $\\hat{R}_v$：\n$$ \\hat{R}_u = \\frac{R_u}{K_u U_{\\ast}} = \\frac{K_u U_{\\ast} \\hat{u} - S_{uv} V_{\\ast} \\hat{v}}{K_u U_{\\ast}} = \\hat{u} - \\left(\\frac{S_{uv} V_{\\ast}}{K_u U_{\\ast}}\\right) \\hat{v} $$\n$$ \\hat{R}_v = \\frac{R_v}{K_v V_{\\ast}} = \\frac{K_v V_{\\ast} \\hat{v} - S_{vu} U_{\\ast} \\hat{u}}{K_v V_{\\ast}} = \\hat{v} - \\left(\\frac{S_{vu} U_{\\ast}}{K_v V_{\\ast}}\\right) \\hat{u} $$\n无量纲系统可以写成矩阵形式 $\\hat{J}_{\\text{dim}} \\begin{pmatrix} \\hat{u} \\\\ \\hat{v} \\end{pmatrix} = \\hat{f}$，其中 $\\hat{f}$ 代表无量纲源项。无量纲块雅可比矩阵 $\\hat{J}_{\\text{dim}}$ 是无量纲残差向量 $\\hat{R} = (\\hat{R}_u, \\hat{R}_v)^T$ 对无量纲状态向量 $\\hat{x} = (\\hat{u}, \\hat{v})^T$ 的偏导数矩阵：\n$$ \\hat{J}_{\\text{dim}} = \\frac{\\partial \\hat{R}}{\\partial \\hat{x}} = \\begin{pmatrix} \\frac{\\partial \\hat{R}_u}{\\partial \\hat{u}}  \\frac{\\partial \\hat{R}_u}{\\partial \\hat{v}} \\\\ \\frac{\\partial \\hat{R}_v}{\\partial \\hat{u}}  \\frac{\\partial \\hat{R}_v}{\\partial \\hat{v}} \\end{pmatrix} $$\n计算各分量：\n$$ \\frac{\\partial \\hat{R}_u}{\\partial \\hat{u}} = 1, \\qquad \\frac{\\partial \\hat{R}_u}{\\partial \\hat{v}} = -\\frac{S_{uv} V_{\\ast}}{K_u U_{\\ast}} $$\n$$ \\frac{\\partial \\hat{R}_v}{\\partial \\hat{u}} = -\\frac{S_{vu} U_{\\ast}}{K_v V_{\\ast}}, \\qquad \\frac{\\partial \\hat{R}_v}{\\partial \\hat{v}} = 1 $$\n因此，无量纲块雅可比矩阵为：\n$$ \\hat{J}_{\\text{dim}} = \\begin{pmatrix} 1  -\\frac{S_{uv} V_{\\ast}}{K_u U_{\\ast}} \\\\ -\\frac{S_{vu} U_{\\ast}}{K_v V_{\\ast}}  1 \\end{pmatrix} $$\n\n**2. 线性误差传播算子**\n\n为简洁起见，我们定义无量纲耦合系数：\n$$ C_{uv} = \\frac{S_{uv} V_{\\ast}}{K_u U_{\\ast}}, \\qquad C_{vu} = \\frac{S_{vu} U_{\\ast}}{K_v V_{\\ast}} $$\n待求解的系统是 $\\hat{u} - C_{uv} \\hat{v} = \\hat{f}_u$ 和 $-C_{vu} \\hat{u} + \\hat{v} = \\hat{f}_v$。块 Gauss-Seidel 迭代先更新 $\\hat{u}$，再更新 $\\hat{v}$。对于第 $k+1$ 次迭代，过程如下：\n$$ \\hat{u}^{k+1} = C_{uv} \\hat{v}^k + \\hat{f}_u $$\n$$ \\hat{v}^{k+1} = C_{vu} \\hat{u}^{k+1} + \\hat{f}_v $$\n精确解 $(\\hat{u}^*, \\hat{v}^*)$ 在稳态时满足相同的方程。将误差定义为 $e_u^k = \\hat{u}^k - \\hat{u}^*$ 和 $e_v^k = \\hat{v}^k - \\hat{v}^*$，我们从迭代方程中减去精确方程，以找到误差传播关系：\n$$ e_u^{k+1} = C_{uv} e_v^k $$\n$$ e_v^{k+1} = C_{vu} e_u^{k+1} $$\n为了找到将误差向量 $E^k = (e_u^k, e_v^k)^T$ 映射到 $E^{k+1} = (e_u^{k+1}, e_v^{k+1})^T$ 的算子 $G$，我们将第一个误差方程代入第二个：\n$$ e_v^{k+1} = C_{vu} (C_{uv} e_v^k) = (C_{uv} C_{vu}) e_v^k $$\n我们现在可以写出完整的映射 $E^{k+1} = G E^k$：\n$$ \\begin{pmatrix} e_u^{k+1} \\\\ e_v^{k+1} \\end{pmatrix} = \\begin{pmatrix} 0  C_{uv} \\\\ 0  C_{uv} C_{vu} \\end{pmatrix} \\begin{pmatrix} e_u^k \\\\ e_v^k \\end{pmatrix} $$\n因此，线性误差传播算子为：\n$$ G = \\begin{pmatrix} 0  C_{uv} \\\\ 0  C_{uv} C_{vu} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{S_{uv} V_{\\ast}}{K_u U_{\\ast}} \\\\ 0  \\frac{S_{uv} S_{vu}}{K_u K_v} \\end{pmatrix} $$\n\n**3. 无量纲耦合强度 $C$**\n\n不动点迭代的收敛性由谱半径 $\\rho(G)$ 决定，谱半径是算子 $G$ 的特征值绝对值的最大值。特征值 $\\lambda$ 是 $\\det(G - \\lambda I) = 0$ 的根：\n$$ \\det \\begin{pmatrix} -\\lambda  C_{uv} \\\\ 0  C_{uv} C_{vu} - \\lambda \\end{pmatrix} = (-\\lambda)(C_{uv} C_{vu} - \\lambda) = 0 $$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = C_{uv} C_{vu}$。谱半径为 $\\rho(G) = |\\lambda_2| = |C_{uv} C_{vu}|$。问题要求将耦合强度 $C$ 定义为交叉耦合系数 $C_{uv}$ 和 $C_{vu}$ 的几何平均值。该定义为：\n$$ C = \\sqrt{|C_{uv} C_{vu}|} $$\n这个定义与收敛性分析是一致的，因为 $\\rho(G) = C^2$，收敛条件是 $\\rho(G)  1$，这等价于 $C  1$（对于非负的 $C$）。代入 $C_{uv}$ 和 $C_{vu}$ 的表达式：\n$$ C = \\sqrt{\\left| \\left(\\frac{S_{uv} V_{\\ast}}{K_u U_{\\ast}}\\right) \\left(\\frac{S_{vu} U_{\\ast}}{K_v V_{\\ast}}\\right) \\right|} = \\sqrt{\\left|\\frac{S_{uv} S_{vu}}{K_u K_v}\\right|} $$\n值得注意的是，耦合强度 $C$ 与所选的特征尺度 $U_{\\ast}$ 和 $V_{\\ast}$ 无关，这使其成为物理系统的一个内在属性。\n\n**4. 数值计算与分类**\n\n使用提供的数值：\n$$ K_u = 2.5 \\times 10^{6}, \\quad K_v = 1.0 \\times 10^{6}, \\quad S_{uv} = 1.5 \\times 10^{6}, \\quad S_{vu} = 2.4 \\times 10^{6} $$\n由于所有给定值均为正数，绝对值是多余的。\n$$ C = \\sqrt{\\frac{(1.5 \\times 10^{6}) \\times (2.4 \\times 10^{6})}{(2.5 \\times 10^{6}) \\times (1.0 \\times 10^{6})}} = \\sqrt{\\frac{1.5 \\times 2.4}{2.5 \\times 1.0}} $$\n$$ C = \\sqrt{\\frac{3.6}{2.5}} = \\sqrt{1.44} = 1.2 $$\n四舍五入到 $3$ 位有效数字，耦合强度为 $1.20$。\n\n根据这个值，我们对耦合机制进行分类。由于 $C = 1.2$，大于 $1$，该系统处于**强耦合**状态。分裂式迭代的谱半径为 $\\rho(G) = C^2 = 1.2^2 = 1.44$。由于 $\\rho(G)  1$，所述的块 Gauss-Seidel 不动点迭代保证会发散。对于这样的系统，分裂式方法需要采用如欠松弛之类的稳定化技术。一个全耦合的单体求解器，在 Newton-Raphson 迭代的每一步中组装并求解完整的雅可比系统，将是一个更为鲁棒的算法选择，因为其收敛性不直接与分裂算子的谱半径相关。这种鲁棒性的代价通常是更高的实现复杂性以及每次迭代更大的内存和计算成本。",
            "answer": "$$\n\\boxed{1.20}\n$$"
        },
        {
            "introduction": "本练习介绍了一种更高级的、基于计算的耦合强度量化方法。许多分区求解算法的核心是算子分裂法，其精度与所涉及的物理算子是否对易（即它们的顺序是否重要）直接相关。本练习将算子理论与实践相结合，要求您设计一个计算实验，通过计算算子对易子（commutator）的范数来量化算子的非对易性。这提供了一个直接的、基于代码的“试金石”，用于分类耦合强度并从根本上理解分裂误差的来源。",
            "id": "3502203",
            "problem": "给定一个一维周期域上的无量纲线性演化问题，其中状态 $u(x,t)$ 在两个线性算子 $L_1$ 和 $L_2$ 的和的作用下演化，其形式为 $ \\partial_t u = (L_1 + L_2) u $。目标是设计一个计算实验，从第一性原理出发，通过量化 $L_1$ 和 $L_2$ 的非对易性（通过换位子范数）来估计 Lie–Trotter 算子分裂的分裂误差，并利用该估计将耦合分类为弱耦合或强耦合。\n\n使用以下基础框架：\n- 在标准的适定性假设下，演化方程 $ \\partial_t u = (L_1 + L_2) u $ 定义了一个线性半群。\n- Lie–Trotter 分裂通过依次应用子算子流来近似单步演化 $u(t+\\Delta t)$。\n- 换位子 $[L_1, L_2] = L_1 L_2 - L_2 L_1$ 用于衡量非对易性。\n- 谱范数（矩阵 $2$-范数）$ \\|A\\|_2 $ 在离散化空间上提供了一个算子范数。\n\n在周期性区间 $[0,1]$ 上，使用一个包含 $N$ 个节点的均匀网格构建离散算子，网格间距为 $h = 1/N$。使用中心差分来近似带有周期性边界条件的导数。定义算子如下：\n- $L_1 u = \\alpha \\,\\partial_{xx} u$ (类扩散)。\n- $L_2 u = \\beta\\, a(x)\\, \\partial_x u + \\gamma\\, u$ (类对流-反应)，其中 $a(x)$ 是一个空间依赖的对流系数。为明确起见，使用 $a(x) = A \\sin(2\\pi x)$，其中 $A$ 是一个指定的振幅。\n\n您的程序必须：\n- 构建离散矩阵 $D_1$ 和 $D_2$，它们使用中心差分和网格间距 $h$ 来近似具有周期性边界条件的 $\\partial_x$ 和 $\\partial_{xx}$。\n- 组装 $L_1 = \\alpha D_2$ 和 $L_2 = \\beta \\,\\mathrm{diag}(a) D_1 + \\gamma I$，其中 $I$ 是单位矩阵，$a$ 是在网格点上求值的 $a(x)$ 向量。\n- 计算谱范数 $ \\|L_1\\|_2 $、$ \\|L_2\\|_2 $ 和 $ \\|[L_1,L_2]\\|_2 $。\n- 定义基于换位子的无量纲耦合指标 $ \\kappa = \\dfrac{\\|[L_1,L_2]\\|_2}{\\|L_1\\|_2 \\,\\|L_2\\|_2} $。\n- 通过比较整体单步演化和分裂单步演化在一个确定性初始条件 $u_0(x) = \\sin(2\\pi x) + \\tfrac{1}{2}\\cos(4\\pi x)$ 上的结果，来估计单步分裂误差。两种演化都在时间步长 $\\Delta t$ 下进行评估。使用矩阵指数计算 $ \\exp(\\Delta t (L_1 + L_2)) $ 和 $ \\exp(\\Delta t L_1)\\exp(\\Delta t L_2) $ 应用于离散的 $u_0$ 向量，并报告相对误差 $E = \\dfrac{\\|u_{\\text{split}} - u_{\\text{mono}}\\|_2}{\\|u_{\\text{mono}}\\|_2}$。\n- 使用关于 $\\kappa$ 的阈值将耦合分类为弱或强：如果 $\\kappa \\le \\tau$ 则为弱耦合，否则为强耦合，其中 $\\tau$ 是一个指定的阈值。\n\n为探究换位子与观测误差之间的关系，还需计算代理量级 $P = \\Delta t^2 \\,\\|[L_1,L_2]\\|_2$，以验证观测到的 $E$ 与非对易性引起的误差缩放相符。此代理量级仅用于诊断目的；分类必须仅基于 $\\kappa$。\n\n实现程序以评估以下测试套件，每个测试用例由一个参数元组 $(N,\\alpha,\\beta,\\gamma,A, \\Delta t, \\tau, \\text{commute\\_override}, c)$ 指定，其中布尔值 $\\text{commute\\_override}$ 指示是否将 $L_2$ 覆盖为 $L_1$ 的标量倍数，即在该情况下设置 $L_2 = c L_1$：\n- 测试 1（一般情况，预期为弱耦合）：$(N=\\;64,\\;\\alpha=\\;1.0,\\;\\beta=\\;0.2,\\;\\gamma=\\;0.0,\\;A=\\;0.5,\\;\\Delta t=\\;10^{-2},\\;\\tau=\\;10^{-1},\\;\\text{commute\\_override}=\\;\\text{False},\\;c=\\;0.0)$。\n- 测试 2（强对流与反应，预期为强耦合）：$(N=\\;64,\\;\\alpha=\\;0.5,\\;\\beta=\\;3.0,\\;\\gamma=\\;10.0,\\;A=\\;2.0,\\;\\Delta t=\\;10^{-2},\\;\\tau=\\;10^{-1},\\;\\text{commute\\_override}=\\;\\text{False},\\;c=\\;0.0)$。\n- 测试 3（对易算子，预期为弱耦合）：$(N=\\;64,\\;\\alpha=\\;1.0,\\;\\beta=\\;0.0,\\;\\gamma=\\;0.0,\\;A=\\;0.0,\\;\\Delta t=\\;10^{-2},\\;\\tau=\\;10^{-1},\\;\\text{commute\\_override}=\\;\\text{True},\\;c=\\;0.75)$。\n- 测试 4（边界情况，时间步长极小，分类与 $\\Delta t$ 无关）：$(N=\\;64,\\;\\alpha=\\;1.0,\\;\\beta=\\;1.0,\\;\\gamma=\\;5.0,\\;A=\\;2.0,\\;\\Delta t=\\;10^{-4},\\;\\tau=\\;10^{-1},\\;\\text{commute\\_override}=\\;\\text{False},\\;c=\\;0.0)$。\n\n您的程序必须为每个测试用例计算整数分类值，其中 $0$ 表示弱耦合，$1$ 表示强耦合，规则如上文关于 $\\kappa$ 的规定。最终输出行必须是包含结果的单行，形式为用方括号括起来的逗号分隔列表，例如 $[0,1,0,1]$。不涉及物理单位；所有量均为无量纲。若有角度，必须以弧度为单位。所有类似百分比的量必须表示为小数。您的程序必须是自包含的，仅使用指定的运行环境，且不得要求任何用户输入或外部文件。",
            "solution": "该问题提出了一个计算科学领域中适定且具有科学依据的任务，具体涉及多物理场仿真分析。其目标是设计并实现一个计算实验，用于对由线性偏微分算子 $L_1$ 和 $L_2$ 建模的两个物理过程之间的耦合强度进行分类。该分类基于这些算子的非对易程度，这是决定算子分裂法准确性的一个基本原则。该问题是有效的，因为它是自包含的、数学上一致的，并且根植于成熟的数值分析理论。\n\n系统状态 $u(x,t)$ 的演化由以下线性偏微分方程控制：\n$$\n\\partial_t u = (L_1 + L_2) u\n$$\n其中 $L_1 = \\alpha \\,\\partial_{xx}$ 表示一个类扩散过程，$L_2 = \\beta\\, a(x)\\, \\partial_x + \\gamma$ 表示一个空间依赖的对流-反应过程。定义域是一个一维周期性区间 $[0,1]$。\n\n分析的核心在于 Lie-Trotter 算子分裂法。离散化系统 $\\dot{\\mathbf{u}} = (\\mathbf{L}_1 + \\mathbf{L}_2)\\mathbf{u}$ 在一个时间步长 $\\Delta t$ 上的精确解由矩阵指数给出：$\\mathbf{u}(\\Delta t) = \\exp(\\Delta t (\\mathbf{L}_1 + \\mathbf{L}_2)) \\mathbf{u}_0$。一阶分裂法，如 Lie-Trotter 方法，通过依次应用子系统的演化来近似该解：\n$$\n\\mathbf{u}_{\\text{split}}(\\Delta t) = \\exp(\\Delta t \\mathbf{L}_2)\\,\\exp(\\Delta t \\mathbf{L}_1) \\mathbf{u}_0\n$$\nBaker-Campbell-Hausdorff (BCH) 公式揭示了 $\\exp(X)\\exp(Y) = \\exp(X+Y + \\frac{1}{2}[X,Y] + \\dots)$。将此公式应用于我们的分裂方案，令 $X = \\Delta t \\mathbf{L}_2$ 和 $Y = \\Delta t \\mathbf{L}_1$，我们可以看到分裂解和整体解的差异主要源于换位子项。分裂的局部截断误差与 $\\Delta t^2 [\\mathbf{L}_2, \\mathbf{L}_1]$ 成正比。因此，换位子 $[\\mathbf{L}_1, \\mathbf{L}_2] = \\mathbf{L}_1 \\mathbf{L}_2 - \\mathbf{L}_2 \\mathbf{L}_1$ 的大小可作为直接度量，衡量以分离方式处理耦合算子所引入的误差。一个大的换位子范数意味着算子是强耦合的，因为它们的应用顺序至关重要。\n\n为了实现这一分析，我们首先在一个由 $N$ 个点 $x_j = j h$（$j=0, 1, \\dots, N-1$）组成的均匀网格上离散化算子，网格间距为 $h=1/N$。我们使用具有周期性边界条件的二阶中心差分。\n\n一阶导数算子 $\\partial_x$ 由一个循环矩阵 $\\mathbf{D}_1$ 近似。$\\mathbf{D}_1$ 作用于网格函数向量 $\\mathbf{u}$，将 $(\\partial_x u)_j$ 近似为 $(u_{j+1} - u_{j-1})/(2h)$。该矩阵在第一超对角线上的元素为 $1/(2h)$，在第一亚对角线上的元素为 $-1/(2h)$，并通过元素 $\\mathbf{D}_1(0, N-1) = -1/(2h)$ 和 $\\mathbf{D}_1(N-1, 0) = 1/(2h)$ 来体现周期性。\n\n二阶导数算子 $\\partial_{xx}$ 由一个循环矩阵 $\\mathbf{D}_2$ 近似。其作用将 $(\\partial_{xx} u)_j$ 近似为 $(u_{j+1} - 2u_j + u_{j-1})/h^2$。该矩阵在主对角线上的元素为 $-2/h^2$，在第一超、亚对角线上的元素为 $1/h^2$，并通过元素 $\\mathbf{D}_2(0, N-1) = \\mathbf{D}_2(N-1, 0) = 1/h^2$ 来体现周期性。\n\n然后，离散算子被构建为 $N \\times N$ 的矩阵：\n$$\n\\mathbf{L}_1 = \\alpha \\mathbf{D}_2\n$$\n$$\n\\mathbf{L}_2 = \\beta \\,\\mathrm{diag}(a(x_j)) \\mathbf{D}_1 + \\gamma \\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵，$\\mathrm{diag}(a(x_j))$ 是一个对角矩阵，其对角线元素为空间变化的对流系数 $a(x) = A \\sin(2\\pi x)$ 在网格上的值。\n\n非对易程度由归一化的无量纲指标 $\\kappa$ 来量化：\n$$\n\\kappa = \\frac{\\|[\\mathbf{L}_1, \\mathbf{L}_2]\\|_2}{\\|\\mathbf{L}_1\\|_2 \\,\\|\\mathbf{L}_2\\|_2}\n$$\n这里，$\\|\\cdot\\|_2$ 表示谱范数（矩阵的最大奇异值）。$\\kappa = 0$ 表示算子对易，意味着分裂是精确的。接近其理论最大值 $2$（对于非零算子）的值表示极端非对易性。我们根据给定的阈值 $\\tau$ 将耦合分类为“弱耦合”（如果 $\\kappa \\le \\tau$）或“强耦合”（如果 $\\kappa  \\tau$）。这提供了一种无需进行时间步进模拟即可先验洞察系统行为的方法。对于 $\\|\\mathbf{L}_1\\|_2 = 0$ 或 $\\|\\mathbf{L}_2\\|_2 = 0$ 的情况，算子平凡地对易，我们定义 $\\kappa = 0$。\n\n对于每个测试用例，算法按以下步骤进行：\n$1$. 给定参数 $(N,\\alpha,\\beta,\\gamma,A, \\Delta t, \\tau, \\text{commute\\_override}, c)$，构建网格。\n$2$. 构建周期性有限差分矩阵 $\\mathbf{D}_1$ 和 $\\mathbf{D}_2$。\n$3$. 构建算子矩阵 $\\mathbf{L}_1$ 和 $\\mathbf{L}_2$。如果 `commute_override` 为真，则将 $\\mathbf{L}_2$ 设置为 $c \\mathbf{L}_1$。在这种情况下，$[\\mathbf{L}_1, \\mathbf{L}_2] = [\\mathbf{L}_1, c \\mathbf{L}_1] = c(\\mathbf{L}_1\\mathbf{L}_1 - \\mathbf{L}_1\\mathbf{L}_1) = \\mathbf{0}$，确保 $\\kappa=0$。\n$4$. 计算换位子矩阵 $[\\mathbf{L}_1, \\mathbf{L}_2] = \\mathbf{L}_1 \\mathbf{L}_2 - \\mathbf{L}_2 \\mathbf{L}_1$。\n$5$. 计算谱范数 $\\|\\mathbf{L}_1\\|_2$、$\\|\\mathbf{L}_2\\|_2$ 和 $\\|[\\mathbf{L}_1, \\mathbf{L}_2]\\|_2$。\n$6$. 计算耦合指标 $\\kappa$。\n$7$. 将 $\\kappa$ 与阈值 $\\tau$ 进行比较以确定分类：弱耦合为 $0$（$\\kappa \\le \\tau$），强耦合为 $1$（$\\kappa  \\tau$）。\n\n此过程提供了一种基于控制算子的基本代数性质，对多物理场耦合强度进行分类的严格、定量的自动化方法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import circulant, norm\n\ndef solve():\n    \"\"\"\n    Solves the multiphysics coupling classification problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, alpha, beta, gamma, A, dt, tau, commute_override, c)\n        (64, 1.0, 0.2, 0.0, 0.5, 1e-2, 1e-1, False, 0.0),\n        (64, 0.5, 3.0, 10.0, 2.0, 1e-2, 1e-1, False, 0.0),\n        (64, 1.0, 0.0, 0.0, 0.0, 1e-2, 1e-1, True, 0.75),\n        (64, 1.0, 1.0, 5.0, 2.0, 1e-4, 1e-1, False, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, alpha, beta, gamma, A, _, tau, commute_override, c = case\n\n        # 1. Set up grid\n        h = 1.0 / N\n        x = np.linspace(0, 1.0, N, endpoint=False)\n\n        # 2. Construct periodic finite difference matrices D1 and D2 using circulant structure\n        # First derivative matrix D1 for d/dx\n        d1_col = np.zeros(N)\n        d1_col[1] = 1.0 / (2.0 * h)\n        d1_col[N - 1] = -1.0 / (2.0 * h)\n        D1 = circulant(d1_col)\n\n        # Second derivative matrix D2 for d^2/dx^2\n        d2_col = np.zeros(N)\n        d2_col[0] = -2.0 / (h * h)\n        d2_col[1] = 1.0 / (h * h)\n        d2_col[N - 1] = 1.0 / (h * h)\n        D2 = circulant(d2_col)\n\n        # 3. Construct operator matrices L1 and L2\n        L1 = alpha * D2\n\n        if commute_override:\n            L2 = c * L1\n        else:\n            a_vec = A * np.sin(2.0 * np.pi * x)\n            A_diag = np.diag(a_vec)\n            I = np.identity(N)\n            L2 = beta * (A_diag @ D1) + gamma * I\n\n        # 4. Compute the commutator\n        Commutator = L1 @ L2 - L2 @ L1\n\n        # 5. Compute spectral norms\n        l1_norm = norm(L1, 2)\n        l2_norm = norm(L2, 2)\n        comm_norm = norm(Commutator, 2)\n        \n        # 6. Calculate the coupling indicator kappa\n        denominator = l1_norm * l2_norm\n        if np.isclose(denominator, 0.0):\n            kappa = 0.0\n        else:\n            kappa = comm_norm / denominator\n            \n        # 7. Classify coupling based on kappa and tau\n        classification = 1 if kappa > tau else 0\n        results.append(classification)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}