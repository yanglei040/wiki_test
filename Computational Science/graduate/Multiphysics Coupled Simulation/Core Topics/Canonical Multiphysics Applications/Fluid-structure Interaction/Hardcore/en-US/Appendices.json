{
    "hands_on_practices": [
        {
            "introduction": "Before coupling fluid and structure, one must understand how fluid motion generates forces. This exercise provides foundational practice by analyzing the kinematics of a fluid element through the velocity gradient tensor, $\\mathbf{L} = \\nabla \\mathbf{v}$. By decomposing $\\mathbf{L}$ into its symmetric (rate-of-deformation) and antisymmetric (spin) parts, you will connect a given velocity field to the local stretching and rotation rates that are the ultimate source of viscous stresses acting on an immersed body .",
            "id": "3508120",
            "problem": "Consider a two-dimensional fluid flow within a deforming domain adjacent to a compliant wall in a Fluid-Structure Interaction (FSI) setting. The fluid velocity field is given by $\\mathbf{v}(\\mathbf{x}) = (a\\,x,\\, b\\,y,\\, 0)$ where $a$ and $b$ are constant parameters with units of $\\mathrm{s}^{-1}$. In continuum kinematics, the velocity gradient is defined as $\\mathbf{L} = \\nabla \\mathbf{v}$, with associated symmetric and antisymmetric parts defined as the rate-of-deformation tensor $\\mathbf{D}$ and the spin tensor $\\mathbf{W}$, respectively, such that $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$, $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$, and $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$.\n\nUsing fundamental definitions from continuum mechanics and without invoking any pre-derived shortcut formulas, compute the exact forms of $\\mathbf{D}$ and $\\mathbf{W}$ for the given $\\mathbf{v}(\\mathbf{x})$. Then, explain their physical meaning in the context of FSI, focusing on how $\\mathbf{D}$ and $\\mathbf{W}$ relate to local stretching/compression and rigid-body rotation of fluid elements near a compliant wall, and state the condition under which the flow is kinematically incompressible.\n\nExpress your final answer as the pair $(\\mathbf{D}, \\mathbf{W})$ written as two $3\\times 3$ matrices in a single row matrix using the $\\mathrm{pmatrix}$ environment. No rounding is needed and no units should be included in the final boxed expression.",
            "solution": "The problem is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n-   The setting is a two-dimensional fluid flow in a deforming domain adjacent to a compliant wall (Fluid-Structure Interaction).\n-   The fluid velocity field is $\\mathbf{v}(\\mathbf{x}) = (a\\,x,\\, b\\,y,\\, 0)$.\n-   $a$ and $b$ are constant parameters with units of $\\mathrm{s}^{-1}$.\n-   The velocity gradient tensor is defined as $\\mathbf{L} = \\nabla \\mathbf{v}$.\n-   The rate-of-deformation tensor $\\mathbf{D}$ is the symmetric part of $\\mathbf{L}$, such that $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$.\n-   The spin tensor $\\mathbf{W}$ is the antisymmetric part of $\\mathbf{L}$, such that $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$.\n-   The decomposition of the velocity gradient is $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$.\n-   The tasks are to:\n    1.  Compute the exact forms of $\\mathbf{D}$ and $\\mathbf{W}$ from fundamental definitions.\n    2.  Explain their physical meaning in the context of FSI.\n    3.  State the condition for kinematic incompressibility.\n-   The final answer format is specified as the pair $(\\mathbf{D}, \\mathbf{W})$ as two $3\\times 3$ matrices in a row matrix.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based on fundamental principles of continuum mechanics, specifically the kinematics of fluid flow. The definitions of the velocity gradient tensor, rate-of-deformation tensor, and spin tensor are standard. The given velocity field is a classic example of a linear flow. The context of FSI is appropriate as these kinematic quantities are essential for determining the fluid stresses that act upon the structure. The problem is scientifically sound.\n-   **Well-Posed:** All necessary information is provided. The velocity field is explicitly defined, and the tasks are clear and unambiguous. A unique solution for $\\mathbf{D}$, $\\mathbf{W}$, and the incompressibility condition exists based on the provided data and definitions.\n-   **Objective:** The problem is stated in precise, objective language without any subjective or speculative elements.\n-   **Completeness and Consistency:** The problem is self-contained. The representation of a two-dimensional flow using a three-component vector $\\mathbf{v} = (v_x, v_y, 0)$ is a standard and consistent practice, implying that the analysis is to be performed in a three-dimensional Cartesian coordinate system $(x,y,z)$ where the flow has no component or variation in the $z$-direction.\n-   **Realism and Feasibility:** The velocity field is a simplified but physically plausible representation of certain flow types, such as flow in a corner or a stretching flow. The units for the constants $a$ and $b$ are dimensionally correct for strain rates.\n-   **Conclusion:** The problem is valid, as it is scientifically grounded, well-posed, objective, complete, and contains no identifiable flaws.\n\n**Step 3: Verdict and Action**\n-   The problem is deemed **valid**. The solution process will proceed.\n\n**Solution Derivation**\n\nThe problem asks for the computation and interpretation of the rate-of-deformation tensor $\\mathbf{D}$ and the spin tensor $\\mathbf{W}$ for a given velocity field $\\mathbf{v}(\\mathbf{x})$.\n\nThe velocity field is given in Cartesian coordinates $\\mathbf{x} = (x, y, z)$ as $\\mathbf{v} = (v_x, v_y, v_z) = (a\\,x, b\\,y, 0)$. The parameters $a$ and $b$ are constants.\n\nThe first step is to compute the velocity gradient tensor, $\\mathbf{L}$, whose components are defined as $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$. We will represent this as a $3 \\times 3$ matrix.\n\nThe components are:\n$L_{11} = \\frac{\\partial v_x}{\\partial x} = \\frac{\\partial(a\\,x)}{\\partial x} = a$\n$L_{12} = \\frac{\\partial v_x}{\\partial y} = \\frac{\\partial(a\\,x)}{\\partial y} = 0$\n$L_{13} = \\frac{\\partial v_x}{\\partial z} = \\frac{\\partial(a\\,x)}{\\partial z} = 0$\n\n$L_{21} = \\frac{\\partial v_y}{\\partial x} = \\frac{\\partial(b\\,y)}{\\partial x} = 0$\n$L_{22} = \\frac{\\partial v_y}{\\partial y} = \\frac{\\partial(b\\,y)}{\\partial y} = b$\n$L_{23} = \\frac{\\partial v_y}{\\partial z} = \\frac{\\partial(b\\,y)}{\\partial z} = 0$\n\n$L_{31} = \\frac{\\partial v_z}{\\partial x} = \\frac{\\partial(0)}{\\partial x} = 0$\n$L_{32} = \\frac{\\partial v_z}{\\partial y} = \\frac{\\partial(0)}{\\partial y} = 0$\n$L_{33} = \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(0)}{\\partial z} = 0$\n\nAssembling these components into a matrix gives the velocity gradient tensor:\n$$\n\\mathbf{L} = \\nabla \\mathbf{v} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe transpose of $\\mathbf{L}$ is:\n$$\n\\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nIn this specific case, $\\mathbf{L}$ is a symmetric matrix, i.e., $\\mathbf{L} = \\mathbf{L}^{\\mathsf{T}}$.\n\nThe rate-of-deformation tensor, $\\mathbf{D}$, is the symmetric part of $\\mathbf{L}$, defined as $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$.\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 2a & 0 & 0 \\\\ 0 & 2b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nThe spin tensor, $\\mathbf{W}$, is the antisymmetric part of $\\mathbf{L}$, defined as $\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$.\n$$\n\\mathbf{W} = \\frac{1}{2} \\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe result $\\mathbf{W} = \\mathbf{0}$ is expected since $\\mathbf{L}$ was found to be symmetric. A flow for which the spin tensor is zero is known as an irrotational flow.\n\n**Physical Meaning in the Context of FSI**\n\n1.  **Rate-of-Deformation Tensor $\\mathbf{D}$**: This tensor describes the rate at which fluid elements are stretched, compressed, and sheared.\n    -   The diagonal components, $D_{11}=a$ and $D_{22}=b$, represent the rates of extensional strain (stretching or compression) along the $x$ and $y$ axes, respectively. If $a>0$, the fluid element is stretching in the $x$-direction; if $a<0$, it is compressing. The same applies to $b$ in the $y$-direction.\n    -   The off-diagonal components represent shearing strain rates. In this case, they are all zero, which means there is no angular distortion of fluid elements whose sides are initially aligned with the coordinate axes.\n    -   In an FSI problem, $\\mathbf{D}$ is fundamentally linked to the viscous stresses exerted by the fluid on the compliant wall. For a Newtonian fluid, the viscous stress tensor $\\boldsymbol{\\tau}$ is linearly proportional to $\\mathbf{D}$ (i.e., $\\boldsymbol{\\tau} = 2\\mu\\mathbf{D} + \\lambda(\\mathrm{tr}(\\mathbf{D}))\\mathbf{I}$, where $\\mu$ and $\\lambda$ are viscosity coefficients). Therefore, the extensional strains with rates $a$ and $b$ generate normal viscous stresses on the wall, contributing to the pressure and forces that cause the structure to deform. The absence of shear strain rates means there are no viscous shear stresses in the coordinate directions.\n\n2.  **Spin Tensor $\\mathbf{W}$**: This tensor describes the rate of rigid-body rotation of a fluid element. It is directly related to the vorticity of the flow, $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$.\n    -   In this case, $\\mathbf{W}$ is the zero matrix. This signifies that the flow is irrotational ($\\boldsymbol{\\omega} = \\mathbf{0}$). Fluid elements translate and deform, but they do not experience any local, rigid-body-like spinning.\n    -   In an FSI context, the absence of rotation simplifies the fluid-structure interaction. Rotational flows can induce complex unsteady loads and torques on flexible structures, potentially leading to phenomena like vortex-induced vibrations. For this particular flow field, such rotational effects are absent. The interaction is purely driven by pressure and the extensional viscous stresses.\n\n**Condition for Incompressibility**\n\nA flow is kinematically incompressible if the volume of any given fluid element remains constant as it moves and deforms. This mathematical condition is expressed as the divergence of the velocity field being zero everywhere.\n$$\n\\nabla \\cdot \\mathbf{v} = 0\n$$\nThis condition is also equivalent to the trace of the rate-of-deformation tensor being zero, $\\mathrm{tr}(\\mathbf{D}) = 0$, since $\\mathrm{tr}(\\mathbf{D}) = \\mathrm{tr}(\\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})) = \\mathrm{tr}(\\mathbf{L}) = \\nabla \\cdot \\mathbf{v}$.\n\nLet's compute the divergence for the given velocity field:\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(a\\,x)}{\\partial x} + \\frac{\\partial(b\\,y)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = a + b\n$$\nFor the flow to be incompressible, the divergence must be zero. Therefore, the condition is:\n$$\na + b = 0\n$$\nThis means that for the flow to be volume-preserving, any rate of stretching in one direction (e.g., $a$) must be exactly balanced by a rate of compression in the other direction ($b = -a$). This is a characteristic feature of incompressible two-dimensional flows undergoing pure strain.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} & \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the governing equations of FSI can be established, their numerical solution is fraught with challenges. This practice guides you through an analytical exploration of one of the most critical pitfalls in partitioned simulations: the added-mass instability. By deriving the stability limit for a simple 1D analogue, you will gain a profound, first-principles understanding of why simple, explicit coupling schemes can fail when the structural mass $m_s$ is not significantly larger than the fluid's added mass $m_a$ .",
            "id": "3508151",
            "problem": "A one-dimensional analogue of fluid–structure interaction (FSI) is a piston-like interface of displacement $x(t)$ driven by a linear spring of stiffness $k_s$ attached to a point mass $m_s$, moving a column of incompressible inviscid fluid. For small-amplitude motions, the fluid response can be modeled by an added mass $m_a$ acting at the interface. The semi-discrete ordinary differential equation (ODE) system obtained from Newton’s second law is\n- Structure: $m_s \\ddot{x}(t) + k_s x(t) = t_{f \\rightarrow s}(t)$,\n- Fluid traction on the structure: $t_{f \\rightarrow s}(t) = - m_a \\ddot{x}(t)$,\nso that the coupled monolithic equation is $(m_s + m_a)\\ddot{x}(t) + k_s x(t) = 0$.\n\nConsider a loosely coupled staggered scheme with constant time step $\\Delta t$ that advances the fluid and structure sequentially at each integer time level $t^n = n \\Delta t$ as follows:\n1) Fluid step (explicit in coupling): evaluate the fluid traction at time level $n$ using a second-order backward difference approximation of the interface acceleration based on past structural displacements,\n$$t_{f \\rightarrow s}^n \\equiv - m_a a^{n,*}, \\quad a^{n,*} := \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2}.$$\n2) Structure step (central-difference update): with $t_{f \\rightarrow s}^n$ held fixed over the interval $[t^n,t^{n+1}]$, advance the structure via\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = t_{f \\rightarrow s}^n.$$\n\nAssume $m_s > m_a > 0$ and $k_s > 0$. Starting from the above semi-discrete ODEs and the specified staggered scheme, derive the linear recurrence governing $\\{x^n\\}$ and perform a normal-mode analysis to determine the condition for linear stability in terms of $\\Delta t$. Then, express the maximum stable time step $\\Delta t_{\\max}$ as a closed-form analytic expression in seconds in terms of $m_s$, $m_a$, and $k_s$. No numerical evaluation is required. Provide your final answer as an analytic expression; do not round. The answer must be a single expression and not an inequality.",
            "solution": "The problem statement is a valid, well-posed problem in the numerical analysis of fluid-structure interaction (FSI). It asks for the stability analysis of a standard loosely coupled, explicit staggered scheme for a simplified one-dimensional FSI model. All parameters and governing equations are clearly defined and scientifically grounded.\n\nThe solution proceeds by first deriving the single linear recurrence relation that governs the discrete interface displacement, $x^n$. Subsequently, a normal-mode (or von Neumann) stability analysis is performed on this recurrence relation to determine the condition for which the numerical solution remains bounded. This condition yields the maximum permissible time step, $\\Delta t_{\\max}$.\n\nThe staggered scheme is defined by two equations at each time level $t^n = n \\Delta t$.\nThe first is the explicit evaluation of the fluid traction based on past structural displacements:\n$$t_{f \\rightarrow s}^n = - m_a a^{n,*} = - m_a \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2} \\quad (1)$$\nThe second is the semi-implicit update for the structure's displacement, using a central-difference approximation for acceleration:\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = t_{f \\rightarrow s}^n \\quad (2)$$\n\nTo derive the complete recurrence relation for the sequence of displacements $\\{x^n\\}$, we substitute the expression for the fluid traction, Equation $(1)$, into the structural dynamics equation, Equation $(2)$:\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = - m_a \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2}$$\nTo eliminate the fractions, we multiply the entire equation by $\\Delta t^2$:\n$$m_s (x^{n+1} - 2 x^n + x^{n-1}) + k_s \\Delta t^2 x^n = -m_a (x^n - 2 x^{n-1} + x^{n-2})$$\nNow, we collect all terms on the left-hand side and group them by their time-level indices ($n+1$, $n$, $n-1$, $n-2$):\n$$m_s x^{n+1} + (-2 m_s x^n + k_s \\Delta t^2 x^n + m_a x^n) + (m_s x^{n-1} - 2 m_a x^{n-1}) + m_a x^{n-2} = 0$$\nFactoring out the displacement terms gives the final third-order homogeneous linear recurrence relation:\n$$m_s x^{n+1} + (m_a - 2 m_s + k_s \\Delta t^2) x^n + (m_s - 2 m_a) x^{n-1} + m_a x^{n-2} = 0 \\quad (3)$$\n\nFor the normal-mode analysis, we assume a solution of the form $x^n = G^n \\hat{x}$, where $G$ is the complex amplification factor and $\\hat{x}$ is the initial amplitude. Substituting this ansatz into the recurrence relation (3):\n$$m_s G^{n+1} \\hat{x} + (m_a - 2 m_s + k_s \\Delta t^2) G^n \\hat{x} + (m_s - 2 m_a) G^{n-1} \\hat{x} + m_a G^{n-2} \\hat{x} = 0$$\nAssuming a non-trivial solution ($\\hat{x} \\neq 0$) and dividing by the common factor $G^{n-2} \\hat{x}$, we obtain the characteristic polynomial for the amplification factor $G$:\n$$P(G) = m_s G^3 + (m_a - 2 m_s + k_s \\Delta t^2) G^2 + (m_s - 2 m_a) G + m_a = 0$$\nFor the numerical scheme to be linearly stable, all roots $G_i$ of this polynomial must satisfy the condition $|G_i| \\leq 1$. If any root has a magnitude greater than $1$, the solution $x^n$ will grow unboundedly as $n \\rightarrow \\infty$, and the scheme is unstable.\n\nThe transition from stability to instability occurs when at least one root crosses the unit circle in the complex plane. For this type of explicit coupling scheme, the instability is typically a high-frequency numerical artifact manifested by a real root passing through $G = -1$. We can find the critical time step at the boundary of stability by setting $G = -1$ in the characteristic polynomial:\n$$P(-1) = m_s (-1)^3 + (m_a - 2 m_s + k_s \\Delta t^2) (-1)^2 + (m_s - 2 m_a) (-1) + m_a = 0$$\n$$m_s(-1) + (m_a - 2 m_s + k_s \\Delta t^2)(1) - (m_s - 2 m_a) + m_a = 0$$\n$$-m_s + m_a - 2 m_s + k_s \\Delta t^2 - m_s + 2 m_a + m_a = 0$$\nCombining the terms yields:\n$$k_s \\Delta t^2 - 4 m_s + 4 m_a = 0$$\nThis equation defines the stability boundary. We solve for $\\Delta t^2$:\n$$k_s \\Delta t^2 = 4 (m_s - m_a)$$\n$$\\Delta t^2 = \\frac{4 (m_s - m_a)}{k_s}$$\nThe condition for stability is that $\\Delta t$ must be less than or equal to the value that satisfies this equality. Therefore, the maximum stable time step, $\\Delta t_{\\max}$, is given by taking the positive square root:\n$$\\Delta t_{\\max} = \\sqrt{\\frac{4 (m_s - m_a)}{k_s}}$$\n$$\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_s - m_a}{k_s}}$$\nThe problem states that $m_s > m_a > 0$ and $k_s > 0$, which ensures that the argument of the square root is positive and a real-valued stable time step exists. This phenomenon is known as the \"added mass instability\" in partitioned FSI simulations, and the derived stability limit is a classic result for this model problem. The stability condition is $\\Delta t \\le \\Delta t_{\\max}$. The problem asks for the expression for $\\Delta t_{\\max}$ itself.",
            "answer": "$$\\boxed{2 \\sqrt{\\frac{m_s - m_a}{k_s}}}$$"
        },
        {
            "introduction": "Building upon the theoretical understanding of numerical instabilities, this practice shifts focus to the implementation and comparison of different coupling strategies. Through a hands-on coding exercise, you will contrast a computationally cheap, explicit staggered scheme with a more robust, implicit strong-coupling scheme . This exercise not only involves implementing these algorithms but also introduces the concept of phase error, a crucial metric for evaluating the accuracy of numerical methods for oscillatory FSI systems.",
            "id": "3508170",
            "problem": "Consider a reduced-order model for fluid-structure interaction (FSI) of a slender elastic structure oscillating in air at low Reynolds number (low $Re$). The structural dynamics are dominated by the first bending mode and the surrounding fluid response is modeled by a linear Stokes-type memory kernel with a single relaxation time. Let $x(t)$ denote the tip displacement of the structure (in $\\mathrm{m}$), $v(t) = \\dot{x}(t)$ its velocity (in $\\mathrm{m/s}$), and $y(t)$ a fluid-state variable (in $\\mathrm{m/s}$) representing the filtered wall velocity that determines the fluid traction. The structure of mass $m_s$ experiences internal viscous damping $c_s$ (in $\\mathrm{N \\cdot s/m}$), linear stiffness $k_s$ (in $\\mathrm{N/m}$), a harmonic external excitation $F(t) = F_0 \\sin(\\omega t)$ (with $F_0$ in $\\mathrm{N}$ and $\\omega$ in $\\mathrm{rad/s}$), and a fluid traction proportional to $y(t)$ with proportionality $c_f$ (in $\\mathrm{N \\cdot s/m}$). The fluid memory is modeled by a first-order relaxation with time constant $\\tau_f$ (in $\\mathrm{s}$). The coupled ordinary differential equations are\n$$\n\\dot{x}(t) = v(t),\n$$\n$$\nm_s \\dot{v}(t) = - c_s v(t) - k_s x(t) - c_f y(t) + F_0 \\sin(\\omega t),\n$$\n$$\n\\tau_f \\dot{y}(t) = v(t) - y(t).\n$$\nAssume initial conditions $x(0) = 0$, $v(0) = 0$, $y(0) = 0$.\n\nYour tasks are:\n- Starting from Newton’s second law and the linear Stokes flow assumption at low Reynolds number, derive the above reduced-order FSI model and present a first-order system form suitable for time integration.\n- Develop two partitioned time-integration schemes over a uniform time grid $t_n = n \\Delta t$ for $n = 0, 1, \\dots, N$ with $\\Delta t = T/N$:\n  1. An explicit staggered scheme (first-order, weak coupling) in which the structure is advanced using the previous-step fluid traction and the fluid state is advanced explicitly. Use the following discretization per step:\n     - Structure (semi-implicit/symplectic Euler for stability): \n       $$\n       v^{n+1} = v^n + \\Delta t \\,\\frac{- c_s v^n - k_s x^n - c_f y^n + F_0 \\sin(\\omega t^n)}{m_s}, \\quad x^{n+1} = x^n + \\Delta t\\, v^{n+1}.\n       $$\n     - Fluid (explicit relaxation using the updated velocity): \n       $$\n       y^{n+1} = y^n + \\Delta t \\,\\frac{v^{n+1} - y^n}{\\tau_f}.\n       $$\n  2. An implicit strong coupling scheme (first-order, fully coupled within each step) using backward Euler:\n     - Find $x^{n+1}$, $v^{n+1}$, and $y^{n+1}$ that satisfy\n       $$\n       x^{n+1} = x^n + \\Delta t\\, v^{n+1},\n       $$\n       $$\n       v^{n+1} = v^n + \\Delta t \\,\\frac{- c_s v^{n+1} - k_s x^{n+1} - c_f y^{n+1} + F_0 \\sin(\\omega t^{n+1})}{m_s},\n       $$\n       $$\n       y^{n+1} = y^n + \\Delta t \\,\\frac{v^{n+1} - y^{n+1}}{\\tau_f}.\n       $$\n     Represent this as a linear $3 \\times 3$ system at each step and solve it exactly.\n- For a reference “exact monolithic integration,” compute the numerical solution by integrating the coupled system as a single system of ordinary differential equations using a high-accuracy ordinary differential equation solver over the same time grid $t_n$, with tight tolerances so that the solver’s numerical error is negligible compared to the partitioned scheme errors. Evaluate the reference solution at the grid points $t_n$.\n- For each time-history $x(t_n)$ produced by the three approaches (explicit staggered, implicit strong coupling, and reference monolithic), compute the instantaneous phase $\\phi(t_n)$ (in $\\mathrm{rad}$) using the analytic signal obtained by the Hilbert transform. Unwrap the phases to remove $2\\pi$ discontinuities. To quantify the phase error of a partitioned scheme relative to the reference, first align phases by subtracting the initial offset at the first sample after a prescribed transient skip time $T_{\\mathrm{skip}}$; that is, if $\\phi_{\\mathrm{alg}}(t_n)$ and $\\phi_{\\mathrm{ref}}(t_n)$ denote the unwrapped phases, define $\\Delta \\phi_0 = \\phi_{\\mathrm{alg}}(t_{n_0}) - \\phi_{\\mathrm{ref}}(t_{n_0})$ where $t_{n_0} \\ge T_{\\mathrm{skip}}$ is the first grid time not less than $T_{\\mathrm{skip}}$, and then compute the mean absolute phase error\n$\\mathrm{MAE}_\\phi = \\frac{1}{M} \\sum_{j=0}^{M-1} \\left| \\left(\\phi_{\\mathrm{alg}}(t_{n_0+j}) - \\phi_{\\mathrm{ref}}(t_{n_0+j})\\right) - \\Delta \\phi_0 \\right|$,\nwhere $M = N - n_0 + 1$. All phase errors must be reported in $\\mathrm{rad}$ as floating-point numbers.\n\nUse the following test suite. For each case, simulate over $t \\in [0,T]$ with specified parameters and time step $\\Delta t$, and set $T_{\\mathrm{skip}}$ as indicated. Units are: mass in $\\mathrm{kg}$, stiffness in $\\mathrm{N/m}$, damping in $\\mathrm{N \\cdot s/m}$, time in $\\mathrm{s}$, force in $\\mathrm{N}$, and angular frequency in $\\mathrm{rad/s}$. The drive frequency $f$ in $\\mathrm{Hz}$ is converted to $\\omega = 2\\pi f$.\n- Case A (moderate coupling near resonance):\n  - $m_s = 1.0$, $c_s = 0.05$, $k_s = (2\\pi \\cdot 6.0)^2$, $c_f = 0.20$, $\\tau_f = 0.010$, $F_0 = 1.0$, $f = 6.0$ so $\\omega = 2\\pi \\cdot 6.0$.\n  - $T = 2.0$, $\\Delta t = 0.0005$, $T_{\\mathrm{skip}} = 0.5$.\n- Case B (weak coupling and off-resonance drive):\n  - $m_s = 1.0$, $c_s = 0.05$, $k_s = (2\\pi \\cdot 4.0)^2$, $c_f = 0.020$, $\\tau_f = 0.005$, $F_0 = 0.5$, $f = 5.0$ so $\\omega = 2\\pi \\cdot 5.0$.\n  - $T = 2.0$, $\\Delta t = 0.0005$, $T_{\\mathrm{skip}} = 0.5$.\n- Case C (strong coupling with slow fluid relaxation):\n  - $m_s = 1.0$, $c_s = 0.05$, $k_s = (2\\pi \\cdot 5.0)^2$, $c_f = 1.00$, $\\tau_f = 0.050$, $F_0 = 1.0$, $f = 5.0$ so $\\omega = 2\\pi \\cdot 5.0$.\n  - $T = 2.0$, $\\Delta t = 0.0002$, $T_{\\mathrm{skip}} = 0.5$.\n\nYour program must:\n- Implement the two partitioned schemes and the reference monolithic integration exactly as specified.\n- Compute, for each case, two numbers: the mean absolute phase error $\\mathrm{MAE}_\\phi$ in $\\mathrm{rad}$ of the explicit staggered scheme and the mean absolute phase error $\\mathrm{MAE}_\\phi$ in $\\mathrm{rad}$ of the implicit strong coupling scheme, both relative to the reference monolithic integration.\n- Produce a single line of output containing the results as a comma-separated list of lists in the order of cases A, B, C, where each inner list is of the form $[\\mathrm{MAE}_{\\phi,\\mathrm{explicit}}, \\mathrm{MAE}_{\\phi,\\mathrm{implicit}}]$. For example, the output format must be exactly like\n\"[ [a1,b1], [a2,b2], [a3,b3] ]\" but without spaces other than those shown by Python’s default list string representation; in particular, your program should print a single line like \"[[a1,b1],[a2,b2],[a3,b3]]\" where $a1$, $b1$, $a2$, $b2$, $a3$, $b3$ are floating-point numbers in $\\mathrm{rad}$.",
            "solution": "The problem is valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution.\n\n### Step 1: Derivation of the Reduced-Order Model and First-Order System Form\n\nThe problem asks for a derivation of the given system of ordinary differential equations (ODEs) for a slender elastic structure oscillating in a fluid. The structure is modeled as a single-degree-of-freedom system, with its state described by the tip displacement $x(t)$.\n\nNewton's second law for the structure's mass $m_s$ is given by:\n$$\nm_s \\ddot{x}(t) = \\sum F(t)\n$$\nwhere $\\sum F(t)$ is the sum of all forces acting on the mass. The forces are:\n1.  **Internal Spring Force**: Arising from the structure's stiffness $k_s$, this is a restoring force proportional to displacement, $F_{stiff} = -k_s x(t)$.\n2.  **Internal Damping Force**: Arising from the structure's internal viscous damping $c_s$, this force opposes motion and is proportional to velocity, $F_{damp} = -c_s \\dot{x}(t)$.\n3.  **External Excitation Force**: A prescribed harmonic forcing function, $F_{ext}(t) = F_0 \\sin(\\omega t)$.\n4.  **Fluid Force**: The force exerted by the surrounding fluid on the structure. The problem states this force is proportional to a fluid state variable $y(t)$ with a proportionality constant $c_f$. This force also acts to oppose the motion, so we write it as $F_{fluid}(t) = -c_f y(t)$. The constant $c_f$ has units of $\\mathrm{N \\cdot s/m}$, indicating it is a fluid damping coefficient.\n\nSumming these forces yields the equation of motion for the structure:\n$$\nm_s \\ddot{x}(t) = -k_s x(t) - c_s \\dot{x}(t) - c_f y(t) + F_0 \\sin(\\omega t)\n$$\nBy defining the velocity as $v(t) = \\dot{x}(t)$, we can write this as a system of two first-order equations:\n$$\n\\dot{x}(t) = v(t)\n$$\n$$\nm_s \\dot{v}(t) = -c_s v(t) - k_s x(t) - c_f y(t) + F_0 \\sin(\\omega t)\n$$\nThis matches the structural part of the model given in the problem statement.\n\nThe fluid model describes the evolution of the state variable $y(t)$. The equation is:\n$$\n\\tau_f \\dot{y}(t) = v(t) - y(t)\n$$\nThis is a first-order relaxation model. It states that the fluid state $y(t)$ relaxes towards the instantaneous structural velocity $v(t)$ with a characteristic time constant $\\tau_f$. A physical justification for this form arises from approximations of the unsteady Stokes equations. The fluid force on an oscillating body is not simply proportional to its instantaneous velocity but depends on the history of its acceleration (the Basset history force). A single-pole relaxation model is a common and simple approximation of this memory effect, where $y(t)$ represents a filtered version of the structural velocity. The solution to this ODE for $y(t)$ (assuming $y(-\\infty)=0$) is a convolution: $y(t) = \\int_{-\\infty}^{t} \\frac{1}{\\tau_f} e^{-(t-s)/\\tau_f} v(s) ds$. This shows that $y(t)$ is a weighted average of the past velocity, with an exponentially decaying memory kernel. Thus, the fluid force $-c_f y(t)$ depends on the entire history of motion, capturing the \"memory\" of the fluid.\n\nTo write the entire system in a first-order matrix form, we define a state vector $\\mathbf{z}(t) = [x(t), v(t), y(t)]^T$. The time derivative $\\dot{\\mathbf{z}}(t)$ is then:\n$$\n\\dot{\\mathbf{z}}(t) = \n\\begin{bmatrix} \\dot{x}(t) \\\\ \\dot{v}(t) \\\\ \\dot{y}(t) \\end{bmatrix}\n=\n\\begin{bmatrix}\nv(t) \\\\\n\\frac{1}{m_s} (-k_s x(t) - c_s v(t) - c_f y(t) + F_0 \\sin(\\omega t)) \\\\\n\\frac{1}{\\tau_f} (v(t) - y(t))\n\\end{bmatrix}\n$$\nThis can be expressed in the linear system form $\\dot{\\mathbf{z}}(t) = \\mathbf{A} \\mathbf{z}(t) + \\mathbf{b}(t)$:\n$$\n\\begin{bmatrix} \\dot{x} \\\\ \\dot{v} \\\\ \\dot{y} \\end{bmatrix} = \n\\begin{bmatrix} \n    0 & 1 & 0 \\\\\n    -k_s/m_s & -c_s/m_s & -c_f/m_s \\\\\n    0 & 1/\\tau_f & -1/\\tau_f \n\\end{bmatrix}\n\\begin{bmatrix} x \\\\ v \\\\ y \\end{bmatrix} +\n\\begin{bmatrix} 0 \\\\ \\frac{F_0}{m_s} \\sin(\\omega t) \\\\ 0 \\end{bmatrix}\n$$\nThis form is suitable for standard ODE integrators, which will serve as our monolithic reference solution.\n\n### Step 2: Partitioned Time-Integration Schemes\n\nWe discretize the time domain as $t_n = n \\Delta t$. Let $(x^n, v^n, y^n)$ be the state at time $t_n$.\n\n**1. Explicit Staggered Scheme (Weak Coupling)**\n\nThis scheme advances the structure and fluid equations sequentially, using known values from step $n$ or a mix of values from steps $n$ and $n+1$.\n- **Structure Sub-problem**: The structure is advanced using a semi-implicit Euler method. The fluid force is evaluated explicitly using the traction from the previous step, $y^n$.\n    $$\n    v^{n+1} = v^n + \\frac{\\Delta t}{m_s} \\left( -c_s v^n - k_s x^n - c_f y^n + F_0 \\sin(\\omega t_n) \\right)\n    $$\n    The new position is then updated using the new velocity, which is characteristic of a symplectic Euler scheme.\n    $$\n    x^{n+1} = x^n + \\Delta t v^{n+1}\n    $$\n- **Fluid Sub-problem**: The fluid state is updated using an explicit forward Euler method, but it uses the newly computed structural velocity $v^{n+1}$.\n    $$\n    y^{n+1} = y^n + \\frac{\\Delta t}{\\tau_f} \\left( v^{n+1} - y^n \\right)\n    $$\n    This can be rearranged as $y^{n+1} = (1 - \\Delta t/\\tau_f) y^n + (\\Delta t/\\tau_f) v^{n+1}$. The information flow is one-way within the time step ($y^n \\rightarrow v^{n+1} \\rightarrow y^{n+1}$), making it computationally inexpensive but potentially less stable or accurate than strongly coupled schemes.\n\n**2. Implicit Strong Coupling Scheme (Backward Euler)**\n\nThis scheme solves for all state variables $(x^{n+1}, v^{n+1}, y^{n+1})$ simultaneously by evaluating all terms at the new time step $t_{n+1}$.\nThe backward Euler discretization of the system is:\n$$\nx^{n+1} = x^n + \\Delta t v^{n+1}\n$$\n$$\nv^{n+1} = v^n + \\frac{\\Delta t}{m_s} \\left( -c_s v^{n+1} - k_s x^{n+1} - c_f y^{n+1} + F_0 \\sin(\\omega t_{n+1}) \\right)\n$$\n$$\ny^{n+1} = y^n + \\frac{\\Delta t}{\\tau_f} \\left( v^{n+1} - y^{n+1} \\right)\n$$\nTo solve for the unknowns $(x^{n+1}, v^{n+1}, y^{n+1})$, we rearrange these equations into a linear system of the form $\\mathbf{M} \\mathbf{z}^{n+1} = \\mathbf{r}^n$.\n1.  $1 \\cdot x^{n+1} - \\Delta t \\cdot v^{n+1} + 0 \\cdot y^{n+1} = x^n$\n2.  $\\left(\\frac{k_s \\Delta t}{m_s}\\right) x^{n+1} + \\left(1 + \\frac{c_s \\Delta t}{m_s}\\right) v^{n+1} + \\left(\\frac{c_f \\Delta t}{m_s}\\right) y^{n+1} = v^n + \\frac{\\Delta t}{m_s} F_0 \\sin(\\omega t_{n+1})$\n3.  $0 \\cdot x^{n+1} - \\left(\\frac{\\Delta t}{\\tau_f}\\right) v^{n+1} + \\left(1 + \\frac{\\Delta t}{\\tau_f}\\right) y^{n+1} = y^n$\n\nThis gives the $3 \\times 3$ linear system:\n$$\n\\begin{bmatrix}\n    1 & -\\Delta t & 0 \\\\\n    \\frac{\\Delta t k_s}{m_s} & 1 + \\frac{\\Delta t c_s}{m_s} & \\frac{\\Delta t c_f}{m_s} \\\\\n    0 & -\\frac{\\Delta t}{\\tau_f} & 1 + \\frac{\\Delta t}{\\tau_f}\n\\end{bmatrix}\n\\begin{bmatrix}\n    x^{n+1} \\\\ v^{n+1} \\\\ y^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n    x^n \\\\\n    v^n + \\frac{\\Delta t}{m_s} F_0 \\sin(\\omega t_{n+1}) \\\\\n    y^n\n\\end{bmatrix}\n$$\nAt each time step, this system is solved to find the state at $t_{n+1}$. This fully couples the physics within the step, leading to better stability and accuracy, especially for stiff problems or strong coupling, at the cost of solving a linear system.\n\n### Step 3: Reference Monolithic Integration and Phase Error Calculation\n\nA reference \"exact\" solution is computed by integrating the first-order system $\\dot{\\mathbf{z}}(t) = \\mathbf{A} \\mathbf{z}(t) + \\mathbf{b}(t)$ using a high-accuracy, adaptive ODE solver like `scipy.integrate.solve_ivp` with the `RK45` method and very stringent error tolerances (e.g., $10^{-12}$). This monolithic approach treats the coupled system as a single entity and serves as a benchmark against which the partitioned schemes are compared.\n\nThe phase error quantifies the temporal shift (lag or lead) introduced by a numerical scheme. It is calculated as follows:\n1.  For a given displacement time series $x(t_n)$, the analytic signal $z_a(t_n) = x(t_n) + i\\hat{x}(t_n)$ is computed, where $\\hat{x}(t_n)$ is the Hilbert transform of $x(t_n)$.\n2.  The instantaneous phase $\\phi(t_n)$ is the angle of the analytic signal, $\\phi(t_n) = \\arg(z_a(t_n))$.\n3.  The phase is unwrapped to remove jumps of $\\pm 2\\pi$, creating a continuous function of time.\n4.  The analysis is restricted to the post-transient part of the signal, for $t_n \\ge T_{\\mathrm{skip}}$. Let $t_{n_0}$ be the first time point satisfying this condition.\n5.  To compare the phase evolution rather than a constant offset, the phases of the partitioned scheme ($\\phi_{\\mathrm{alg}}$) and reference scheme ($\\phi_{\\mathrm{ref}}$) are aligned at $t_{n_0}$ by subtracting the initial difference $\\Delta \\phi_0 = \\phi_{\\mathrm{alg}}(t_{n_0}) - \\phi_{\\mathrm{ref}}(t_{n_0})$.\n6.  The Mean Absolute Phase Error ($\\mathrm{MAE}_\\phi$) is the average of the absolute differences of the aligned phases over the analysis window ($t \\ge T_{\\mathrm{skip}}$):\n    $$\n    \\mathrm{MAE}_\\phi = \\frac{1}{M} \\sum_{j=0}^{M-1} \\left| \\left(\\phi_{\\mathrm{alg}}(t_{n_0+j}) - \\phi_{\\mathrm{ref}}(t_{n_0+j})\\right) - \\Delta \\phi_0 \\right|\n    $$\n    where $M$ is the number of points in the analysis window. This metric isolates the accumulating phase error due to the numerical integration scheme itself.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.signal import hilbert\n\ndef solve():\n    \"\"\"\n    Main solver function to execute the FSI simulation and error analysis\n    for all test cases as specified in the problem statement.\n    \"\"\"\n    \n    # Test cases defined in the problem.\n    test_cases = [\n        # Case A: moderate coupling near resonance\n        {'m_s': 1.0, 'c_s': 0.05, 'k_s': (2 * np.pi * 6.0)**2, 'c_f': 0.20, \n         'tau_f': 0.010, 'F0': 1.0, 'f': 6.0, 'T': 2.0, 'dt': 0.0005, 'T_skip': 0.5},\n        # Case B: weak coupling and off-resonance drive\n        {'m_s': 1.0, 'c_s': 0.05, 'k_s': (2 * np.pi * 4.0)**2, 'c_f': 0.020, \n         'tau_f': 0.005, 'F0': 0.5, 'f': 5.0, 'T': 2.0, 'dt': 0.0005, 'T_skip': 0.5},\n        # Case C: strong coupling with slow fluid relaxation\n        {'m_s': 1.0, 'c_s': 0.05, 'k_s': (2 * np.pi * 5.0)**2, 'c_f': 1.00, \n         'tau_f': 0.050, 'F0': 1.0, 'f': 5.0, 'T': 2.0, 'dt': 0.0002, 'T_skip': 0.5},\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        m_s, c_s, k_s, c_f, tau_f, F0, f, T, dt, T_skip = (\n            params['m_s'], params['c_s'], params['k_s'], params['c_f'], \n            params['tau_f'], params['F0'], params['f'], params['T'],\n            params['dt'], params['T_skip']\n        )\n        omega = 2 * np.pi * f\n        \n        # Time grid\n        t_eval = np.arange(0, T + dt / 2, dt) # Use dt/2 to ensure T is included\n        N = len(t_eval) - 1\n\n        # --- Reference Monolithic Solution ---\n        def fsi_ode_system(t, z):\n            x, v, y = z\n            dxdt = v\n            dvdt = (-c_s * v - k_s * x - c_f * y + F0 * np.sin(omega * t)) / m_s\n            dydt = (v - y) / tau_f\n            return [dxdt, dvdt, dydt]\n\n        sol_ref = solve_ivp(\n            fsi_ode_system, \n            [0, T], \n            [0, 0, 0], \n            t_eval=t_eval, \n            rtol=1e-12, \n            atol=1e-12\n        )\n        x_ref = sol_ref.y[0]\n\n        # --- Explicit Staggered Scheme ---\n        x_exp, v_exp, y_exp = np.zeros(N + 1), np.zeros(N + 1), np.zeros(N + 1)\n        for n in range(N):\n            # Structure update\n            v_exp[n+1] = v_exp[n] + (dt / m_s) * (\n                -c_s * v_exp[n] - k_s * x_exp[n] - c_f * y_exp[n] + F0 * np.sin(omega * t_eval[n])\n            )\n            x_exp[n+1] = x_exp[n] + dt * v_exp[n+1]\n            \n            # Fluid update\n            y_exp[n+1] = y_exp[n] + (dt / tau_f) * (v_exp[n+1] - y_exp[n])\n        \n        # --- Implicit Strong Coupling Scheme ---\n        x_imp, v_imp, y_imp = np.zeros(N + 1), np.zeros(N + 1), np.zeros(N + 1)\n        \n        # Assemble the constant matrix M\n        M = np.array([\n            [1, -dt, 0],\n            [dt * k_s / m_s, 1 + dt * c_s / m_s, dt * c_f / m_s],\n            [0, -dt / tau_f, 1 + dt / tau_f]\n        ])\n        M_inv = np.linalg.inv(M)\n        \n        for n in range(N):\n            # Assemble the RHS vector\n            rhs = np.array([\n                x_imp[n],\n                v_imp[n] + (dt / m_s) * F0 * np.sin(omega * t_eval[n+1]),\n                y_imp[n]\n            ])\n            \n            # Solve the linear system\n            z_next = M_inv @ rhs\n            x_imp[n+1], v_imp[n+1], y_imp[n+1] = z_next\n\n        # --- Phase Error Calculation ---\n        def calculate_mae_phi(x_alg, x_ref, t, T_skip):\n            # Find index to start analysis\n            n0 = np.searchsorted(t, T_skip, side='left')\n            \n            # Compute analytic signal and unwrap phase\n            phi_alg = np.unwrap(np.angle(hilbert(x_alg)))\n            phi_ref = np.unwrap(np.angle(hilbert(x_ref)))\n            \n            # Use post-transient part of the signal\n            phi_alg_analysis = phi_alg[n0:]\n            phi_ref_analysis = phi_ref[n0:]\n            \n            # Align phases at the start of the analysis window\n            phase_diff = phi_alg_analysis - phi_ref_analysis\n            aligned_phase_diff = phase_diff - phase_diff[0]\n            \n            # Compute Mean Absolute Error\n            mae = np.mean(np.abs(aligned_phase_diff))\n            return mae\n        \n        mae_exp = calculate_mae_phi(x_exp, x_ref, t_eval, T_skip)\n        mae_imp = calculate_mae_phi(x_imp, x_ref, t_eval, T_skip)\n        \n        all_results.append([mae_exp, mae_imp])\n\n    # Final print statement in the exact required format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}