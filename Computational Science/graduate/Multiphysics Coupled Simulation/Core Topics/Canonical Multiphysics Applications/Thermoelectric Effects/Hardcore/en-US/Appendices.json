{
    "hands_on_practices": [
        {
            "introduction": "The thermoelectric effects—Seebeck, Peltier, and Thomson—are not isolated phenomena but are deeply interconnected through the laws of thermodynamics. The Kelvin relations provide the precise mathematical framework linking these effects, forming the cornerstone of thermoelectric theory. This first exercise provides essential practice in applying these fundamental principles, specifically using the second Kelvin relation, $\\tau(T) = T \\frac{dS(T)}{dT}$, to derive the Thomson coefficient from a known Seebeck coefficient . Mastering this relationship is the first step toward building comprehensive multiphysics models.",
            "id": "1196625",
            "problem": "In the study of thermoelectric phenomena, three primary effects are considered: the Seebeck, Peltier, and Thomson effects. These effects are interconnected through the Kelvin (or Onsager) relations, which are consequences of thermodynamic principles.\n\nThe Seebeck effect describes the generation of a voltage in a material subjected to a temperature gradient. The Seebeck coefficient, $S(T)$, quantifies this effect at a given absolute temperature $T$.\n\nThe Thomson effect describes the reversible heating or cooling that occurs when an electric current flows through a conductor that also has a temperature gradient. The Thomson coefficient, $\\tau(T)$, is defined as the heat absorbed or released per unit charge per unit temperature change.\n\nThe second Kelvin relation provides a direct link between the Seebeck coefficient and the Thomson coefficient:\n$$\n\\tau(T) = T \\frac{dS(T)}{dT}\n$$\n\nConsider a specific metal for which, at low temperatures, the Seebeck coefficient can be accurately described by the empirical formula:\n$$\nS(T) = aT + bT^3\n$$\nHere, $a$ and $b$ are material-specific constants. The linear term typically arises from the diffusion of charge carriers, while the cubic term is often associated with the phonon-drag effect.\n\nGiven this form of the Seebeck coefficient, determine the corresponding Thomson coefficient, $\\tau(T)$, for this metal.",
            "solution": "The problem asks for the Thomson coefficient, $\\tau(T)$, given the Seebeck coefficient, $S(T)$. The relationship between these two coefficients is given by the second Kelvin relation.\n\nThe starting point is the second Kelvin relation:\n$$\n\\tau(T) = T \\frac{dS(T)}{dT}\n$$\n\nThe Seebeck coefficient for the metal is given by:\n$$\nS(T) = aT + bT^3\n$$\nwhere $a$ and $b$ are constants.\n\nThe first step is to calculate the derivative of $S(T)$ with respect to the absolute temperature $T$. We use the power rule for differentiation, $\\frac{d}{dx}(cx^n) = cnx^{n-1}$.\n$$\n\\frac{dS}{dT} = \\frac{d}{dT}(aT + bT^3)\n$$\nApplying the rule to each term separately:\n$$\n\\frac{dS}{dT} = a \\frac{d}{dT}(T^1) + b \\frac{d}{dT}(T^3)\n$$\n$$\n\\frac{dS}{dT} = a(1 \\cdot T^{1-1}) + b(3 \\cdot T^{3-1})\n$$\n$$\n\\frac{dS}{dT} = a(T^0) + b(3T^2)\n$$\nSince $T^0 = 1$, the derivative simplifies to:\n$$\n\\frac{dS}{dT} = a + 3bT^2\n$$\n\nNow, we substitute this expression for the derivative back into the second Kelvin relation:\n$$\n\\tau(T) = T \\left( \\frac{dS}{dT} \\right)\n$$\n$$\n\\tau(T) = T (a + 3bT^2)\n$$\n\nFinally, we distribute the factor of $T$ to obtain the final expression for the Thomson coefficient:\n$$\n\\tau(T) = aT + 3bT^3\n$$\nThis expression gives the Thomson coefficient as a function of temperature for the given metal.",
            "answer": "$$\n\\boxed{aT + 3bT^3}\n$$"
        },
        {
            "introduction": "Moving from bulk material properties to the behavior of real devices requires a focus on interfaces, where dissimilar materials meet. At a metal-thermoelectric junction, a complex interplay of effects occurs, including Peltier heating/cooling, resistive Joule heating from contact resistance, and heat conduction. This practice challenges you to construct a model from first principles by applying an energy balance at the interface to predict the resulting temperature discontinuity . Accurately modeling such interfacial phenomena is critical for the design and simulation of efficient and reliable thermoelectric modules.",
            "id": "3529907",
            "problem": "Consider a one-dimensional, steady-state junction between a metal and a thermoelectric (TE) material, modeled as a vanishingly thin interface. The task is to derive, implement, and validate a physically consistent expression for the temperature discontinuity across the interface due to coupled thermoelectric effects and contact electrical and thermal resistances. The derivation must start from conservation of energy and standard thermoelectric definitions, and the implementation must be based on the derived relation without invoking any unmotivated shortcut formulas. All quantities must be handled with explicit units and scientific realism.\n\nFundamental base and definitions to be used:\n- Energy conservation at a vanishingly thin interface implies that the net interfacial heat generation per unit area equals the discontinuity of the normal heat flux across the interface. In steady state and one dimension, this balances an interfacial heat flow proportional to the temperature jump.\n- Fourier’s law of heat conduction relates heat flux to temperature gradient, but at a contact interface represented by an interfacial thermal conductance, the temperature jump is directly proportional to the interfacial heat flow.\n- The Seebeck effect states that a material with Seebeck coefficient $S$ develops an electromotive force proportional to temperature difference; the associated Peltier coefficient is related by $\\Pi = S T$, where $T$ is the absolute temperature.\n- The Peltier effect describes interfacial heating or cooling proportional to electric current and the Peltier coefficient.\n- Electric contact resistance at the interface produces Joule heating localized at the interface.\n- The Thomson effect is a distributed bulk effect proportional to $T \\,\\mathrm{d}S/\\mathrm{d}T$, and does not contribute as a singular source at an idealized, vanishingly thin interface; it is therefore excluded from the interfacial jump balance in this model.\n\nInterface model and variables:\n- Let $J$ be the electric current density in $\\mathrm{A/m^{2}}$ flowing from metal to TE.\n- Let $S_{c}$ be the effective contact Seebeck coefficient in $\\mathrm{V/K}$ that characterizes the metal/TE junction.\n- Let $\\Pi_{c}$ be the effective interfacial Peltier coefficient in $\\mathrm{V}$.\n- Let $R_{c}''$ be the electrical contact resistance per unit area in $\\Omega\\cdot \\mathrm{m^{2}}$.\n- Let $G_{c}$ be the interfacial thermal conductance in $\\mathrm{W/(m^{2}\\cdot K)}$.\n- Let $T_{0}$ be a known operating absolute temperature in $\\mathrm{K}$ near the interface.\n- Let $\\beta$ be a dimensionless partition factor in $(0,1)$ representing the fraction of the temperature jump contributing to the local interfacial temperature used to evaluate $\\Pi_{c}$, that is, an approximation $T_{\\mathrm{int}} \\approx T_{0} + \\beta\\,\\Delta T$ consistent with one-dimensional steady conduction into two adjacent media of comparable conductance.\n\nYour program must implement the following tasks derived from first principles:\n1. Starting from interfacial energy conservation and the definitions above, express the interfacial heat generation per unit area as the sum of interfacial Peltier heating and interfacial Joule heating, and then derive an algebraic relation that determines the temperature jump $\\Delta T$ across the interface in terms of $J$, $S_{c}$, $R_{c}''$, $G_{c}$, $T_{0}$, and $\\beta$.\n2. Evaluate the effective interfacial Peltier coefficient as $\\Pi_{c} = S_{c}\\,T_{\\mathrm{int}}$ with $T_{\\mathrm{int}} = T_{0} + \\beta\\,\\Delta T$ as specified.\n3. Solve the resulting algebraic relation for $\\Delta T$ in $\\mathrm{K}$.\n\nValidation requirement:\n- For each test case, compute the theoretical $\\Delta T$ predicted by your derived relation and compare it to a provided measured temperature jump $\\Delta T_{\\mathrm{meas}}$ in $\\mathrm{K}$.\n- Determine whether the prediction is consistent with measurement by checking if the absolute difference is less than or equal to a specified tolerance $\\varepsilon$ in $\\mathrm{K}$.\n- For each test case, output a boolean value: $\\,\\mathrm{True}$ if $|\\Delta T - \\Delta T_{\\mathrm{meas}}|\\le \\varepsilon$, and $\\,\\mathrm{False}$ otherwise.\n\nUnits:\n- $J$ in $\\mathrm{A/m^{2}}$,\n- $S_{c}$ in $\\mathrm{V/K}$,\n- $R_{c}''$ in $\\Omega\\cdot \\mathrm{m^{2}}$,\n- $G_{c}$ in $\\mathrm{W/(m^{2}\\cdot K)}$,\n- $T_{0}$ in $\\mathrm{K}$,\n- $\\Delta T$ and $\\Delta T_{\\mathrm{meas}}$ in $\\mathrm{K}$,\n- $\\varepsilon$ in $\\mathrm{K}$.\n\nTest suite:\n- Case $1$: $J = 2\\times 10^{6}\\,\\mathrm{A/m^{2}}$, $S_{c} = 5\\times 10^{-6}\\,\\mathrm{V/K}$, $R_{c}'' = 5\\times 10^{-9}\\,\\Omega\\cdot \\mathrm{m^{2}}$, $G_{c} = 2\\times 10^{7}\\,\\mathrm{W/(m^{2}\\cdot K)}$, $T_{0} = 300\\,\\mathrm{K}$, $\\beta = 0.5$, $\\Delta T_{\\mathrm{meas}} = 1.1508\\times 10^{-3}\\,\\mathrm{K}$, $\\varepsilon = 1\\times 10^{-5}\\,\\mathrm{K}$.\n- Case $2$: $J = 1\\times 10^{6}\\,\\mathrm{A/m^{2}}$, $S_{c} = 0\\,\\mathrm{V/K}$, $R_{c}'' = 1\\times 10^{-8}\\,\\Omega\\cdot \\mathrm{m^{2}}$, $G_{c} = 1\\times 10^{6}\\,\\mathrm{W/(m^{2}\\cdot K)}$, $T_{0} = 300\\,\\mathrm{K}$, $\\beta = 0.5$, $\\Delta T_{\\mathrm{meas}} = 1.01\\times 10^{-2}\\,\\mathrm{K}$, $\\varepsilon = 2\\times 10^{-4}\\,\\mathrm{K}$.\n- Case $3$: $J = 3\\times 10^{6}\\,\\mathrm{A/m^{2}}$, $S_{c} = -1\\times 10^{-5}\\,\\mathrm{V/K}$, $R_{c}'' = 0\\,\\Omega\\cdot \\mathrm{m^{2}}$, $G_{c} = 5\\times 10^{7}\\,\\mathrm{W/(m^{2}\\cdot K)}$, $T_{0} = 400\\,\\mathrm{K}$, $\\beta = 0.5$, $\\Delta T_{\\mathrm{meas}} = -2.40001\\times 10^{-4}\\,\\mathrm{K}$, $\\varepsilon = 5\\times 10^{-7}\\,\\mathrm{K}$.\n- Case $4$: $J = 0\\,\\mathrm{A/m^{2}}$, $S_{c} = 1\\times 10^{-5}\\,\\mathrm{V/K}$, $R_{c}'' = 1\\times 10^{-8}\\,\\Omega\\cdot \\mathrm{m^{2}}$, $G_{c} = 1\\times 10^{6}\\,\\mathrm{W/(m^{2}\\cdot K)}$, $T_{0} = 300\\,\\mathrm{K}$, $\\beta = 0.5$, $\\Delta T_{\\mathrm{meas}} = 0\\,\\mathrm{K}$, $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{K}$.\n- Case $5$: $J = 3\\times 10^{6}\\,\\mathrm{A/m^{2}}$, $S_{c} = 3\\times 10^{-5}\\,\\mathrm{V/K}$, $R_{c}'' = 1\\times 10^{-8}\\,\\Omega\\cdot \\mathrm{m^{2}}$, $G_{c} = 5\\times 10^{6}\\,\\mathrm{W/(m^{2}\\cdot K)}$, $T_{0} = 300\\,\\mathrm{K}$, $\\beta = 0.5$, $\\Delta T_{\\mathrm{meas}} = 2.341\\times 10^{-2}\\,\\mathrm{K}$, $\\varepsilon = 5\\times 10^{-4}\\,\\mathrm{K}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}]$. The list must contain one boolean per test case in the order listed above.",
            "solution": "The problem requires the derivation of an expression for the temperature jump, $\\Delta T$, across a metal-thermoelectric interface and its implementation to validate a set of test cases. The derivation must be founded on the principles of energy conservation and the provided definitions for thermoelectric phenomena.\n\nThe derivation proceeds in the following steps:\n\n1.  **Formulation of the Interfacial Energy Balance**\n    The problem states that the system is in a steady state. For a vanishingly thin interface, the principle of energy conservation dictates that the net rate of heat generated per unit area at the interface, $q''_{\\mathrm{gen}}$, must be equal to the rate of heat conducted away from the interface per unit area, $q''_{\\mathrm{removed}}$. This can be expressed as:\n    $$q''_{\\mathrm{gen}} = q''_{\\mathrm{removed}}$$\n\n2.  **Modeling the Interfacial Heat Generation, $q''_{\\mathrm{gen}}$**\n    According to the problem description, the interfacial heat generation is the sum of two components: Peltier heating and interfacial Joule heating.\n\n    *   **Peltier Heating ($q''_{\\mathrm{Peltier}}$)**: This effect describes heating or cooling at the junction of two dissimilar materials when an electric current passes through it. The problem defines this term as being proportional to the electric current density, $J$, and the effective interfacial Peltier coefficient, $\\Pi_c$. The heat generated per unit area is given as:\n        $$q''_{\\mathrm{Peltier}} = \\Pi_c J$$\n        It is important to note that this is an algebraic quantity; its sign determines whether heat is generated (heating) or absorbed (cooling).\n\n    *   **Joule Heating ($q''_{\\mathrm{Joule}}$)**: This is the resistive heating that occurs due to the electrical contact resistance per unit area, $R_c''$. This term is always a source of heat and is given by:\n        $$q''_{\\mathrm{Joule}} = J^2 R_c''$$\n\n    The total heat generated per unit area is the sum of these two terms, as instructed:\n    $$q''_{\\mathrm{gen}} = q''_{\\mathrm{Peltier}} + q''_{\\mathrm{Joule}} = \\Pi_c J + J^2 R_c''$$\n\n3.  **Modeling the Heat Removal, $q''_{\\mathrm{removed}}$**\n    The generated heat, $q''_{\\mathrm{gen}}$, creates a temperature discontinuity, or jump, $\\Delta T$, across the interface. This heat is conducted away into the adjoining bulk materials. The problem models this process using an interfacial thermal conductance, $G_c$, which relates the heat flux to the temperature jump:\n    $$q''_{\\mathrm{removed}} = G_c \\Delta T$$\n\n4.  **Assembling the Energy Balance Equation**\n    By equating the heat generation and heat removal terms, we obtain the steady-state energy balance equation for the interface:\n    $$G_c \\Delta T = \\Pi_c J + J^2 R_c''$$\n\n5.  **Incorporating the Temperature-Dependent Peltier Coefficient**\n    The problem specifies that the Peltier coefficient, $\\Pi_c$, is related to the effective contact Seebeck coefficient, $S_c$, and the absolute temperature at the interface, $T_{\\mathrm{int}}$, through the first Kelvin relation:\n    $$\\Pi_c = S_c T_{\\mathrm{int}}$$\n    Furthermore, the interface temperature, $T_{\\mathrm{int}}$, is to be approximated based on a known operating temperature near the interface, $T_0$, and the temperature jump, $\\Delta T$, itself. A dimensionless partition factor, $\\beta$, where $\\beta \\in (0,1)$, determines the contribution of the jump:\n    $$T_{\\mathrm{int}} = T_0 + \\beta \\Delta T$$\n    Substituting this approximation for $T_{\\mathrm{int}}$ into the expression for $\\Pi_c$ yields:\n    $$\\Pi_c = S_c (T_0 + \\beta \\Delta T)$$\n\n6.  **Derivation of the Final Algebraic Relation for $\\Delta T$**\n    We now substitute the temperature-dependent expression for $\\Pi_c$ back into the energy balance equation:\n    $$G_c \\Delta T = \\left[ S_c (T_0 + \\beta \\Delta T) \\right] J + J^2 R_c''$$\n    This is an algebraic equation that is linear in $\\Delta T$. To solve for $\\Delta T$, we first expand the terms on the right-hand side:\n    $$G_c \\Delta T = S_c T_0 J + S_c \\beta J \\Delta T + J^2 R_c''$$\n    Next, we collect all terms involving $\\Delta T$ on the left-hand side of the equation:\n    $$G_c \\Delta T - S_c \\beta J \\Delta T = S_c T_0 J + J^2 R_c''$$\n    Factoring out $\\Delta T$ yields:\n    $$\\Delta T (G_c - S_c \\beta J) = S_c T_0 J + J^2 R_c''$$\n    Finally, isolating $\\Delta T$ by dividing by the term in the parenthesis gives the definitive expression for the temperature jump:\n    $$\\Delta T = \\frac{S_c T_0 J + J^2 R_c''}{G_c - S_c \\beta J}$$\n    This equation provides the theoretical temperature jump, $\\Delta T$, as a function of the given material properties, geometric factors, and operating conditions.\n\n7.  **Algorithmic Implementation and Validation**\n    The implementation will directly compute $\\Delta T$ using the derived formula for each provided test case. The input parameters are $J$, $S_c$, $R_c''$, $G_c$, $T_0$, and $\\beta$. The calculated value, $\\Delta T$, is then compared against the provided measured value, $\\Delta T_{\\mathrm{meas}}$, using the specified tolerance, $\\varepsilon$. The validation condition is:\n    $$|\\Delta T - \\Delta T_{\\mathrm{meas}}| \\le \\varepsilon$$\n    A boolean result ($\\mathrm{True}$ or $\\mathrm{False}$) is determined for each test case based on this condition.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and validates a model for the temperature discontinuity\n    across a thermoelectric interface based on first principles.\n    \"\"\"\n    \n    # Test suite:\n    # (J, Sc, Rc'', Gc, T0, beta, dT_meas, epsilon)\n    # Units:\n    # J: A/m^2\n    # Sc: V/K\n    # Rc'': Ohm.m^2\n    # Gc: W/(m^2.K)\n    # T0: K\n    # beta: dimensionless\n    # dT_meas: K\n    # epsilon: K\n    test_cases = [\n        (2e6, 5e-6, 5e-9, 2e7, 300.0, 0.5, 1.1508e-3, 1e-5),\n        (1e6, 0.0, 1e-8, 1e6, 300.0, 0.5, 1.01e-2, 2e-4),\n        (3e6, -1e-5, 0.0, 5e7, 400.0, 0.5, -2.40001e-4, 5e-7),\n        (0.0, 1e-5, 1e-8, 1e6, 300.0, 0.5, 0.0, 1e-12),\n        (3e6, 3e-5, 1e-8, 5e6, 300.0, 0.5, 2.341e-2, 5e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        J, S_c, R_c_pp, G_c, T_0, beta, dT_meas, epsilon = case\n\n        # The derived algebraic relation for the temperature jump Delta_T is:\n        # Delta_T = (S_c * T_0 * J + J^2 * R_c'') / (G_c - S_c * beta * J)\n        \n        # Calculate the numerator of the expression\n        numerator = S_c * T_0 * J + J**2 * R_c_pp\n        \n        # Calculate the denominator of the expression\n        denominator = G_c - S_c * beta * J\n        \n        # Calculate the theoretical temperature jump Delta_T\n        # Handle the case where the denominator could be zero, though it's\n        # physically unlikely for the given parameter ranges.\n        if denominator == 0:\n            # This case would imply a thermal runaway, which is not expected\n            # under the problem's conditions. We can treat it as an error or\n            # infinite jump. For the purpose of this problem, we can assume\n            # it won't occur with the given test data.\n            dT_calc = np.inf\n        else:\n            dT_calc = numerator / denominator\n            \n        # Validate the prediction against the measured value within the tolerance\n        is_consistent = np.abs(dT_calc - dT_meas) = epsilon\n        results.append(is_consistent)\n\n    # Format the output as a comma-separated list of booleans in brackets\n    # Using map(str.lower, ...) to ensure lowercase 'true'/'false' if needed,\n    but Python's default str(True) is 'True'. The problem example shows True/False.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "At the nanoscale or during ultrafast processes, the classical Fourier's law of heat conduction can fail, necessitating more advanced models. This exercise introduces the Cattaneo-Vernotte equation, which accounts for a finite heat propagation speed and predicts wave-like thermal transport, a phenomenon known as hyperbolic heat transfer. You will derive and implement a numerical simulation that couples this non-Fourier heat flow with Peltier effects under a transient current pulse . This advanced practice provides a glimpse into the cutting-edge of thermal transport modeling, essential for understanding next-generation nanodevices.",
            "id": "3529954",
            "problem": "Consider a one-dimensional nanoscale wire of length $L$ with uniform cross-sectional area and homogeneous material properties. The wire is thermally isolated at both ends so that the heat flux vanishes at $x=0$ and $x=L$. The thermal dynamics are governed by local energy conservation and the Cattaneo–Vernotte law (also called the Maxwell–Cattaneo law) for heat flux relaxation. A uniform, time-dependent electrical current density $J(t)$ flows along the wire, producing thermoelectric coupling through the Peltier heat term. Let $T(x,t)$ denote the temperature field and $q(x,t)$ denote the heat flux field. The material density is $\\rho$, the specific heat capacity at constant pressure is $c$, the thermal conductivity is $k$, and the heat flux relaxation time is $\\tau_q$. The Seebeck coefficient is taken constant as $S_0$, so that the Peltier coefficient is $\\Pi(T)=S_0 T$. The initial temperature is uniform $T(x,0)=T_0$, and the initial heat flux satisfies the Cattaneo–Vernotte law consistently with $T(x,0)$.\n\nStarting from first principles:\n- Local energy conservation: the rate of change of internal energy density equals the negative divergence of heat flux plus volumetric source terms, and\n- The Cattaneo–Vernotte heat flux law: $q+\\tau_q \\partial_t q = -k \\nabla T$,\nderive the coupled evolution equations for $T(x,t)$ and $q(x,t)$ in one spatial dimension when the only thermoelectric source term is the Peltier heat $-\\nabla\\cdot(\\Pi J)$ with $J(t)$ uniform in space. Show how the Peltier term modifies the temperature evolution via spatial gradients of $T(x,t)$ when $J(t)$ is pulsed in time, and formulate boundary conditions consistent with vanishing heat flux at the ends of the wire.\n\nDesign a stable semi-discrete algorithm (space-discretized and time-stepped) that:\n- Uses a uniform spatial grid and consistent approximations for $\\partial_x T$ and $\\partial_x q$ with boundary conditions implemented at $x=0$ and $x=L$.\n- Advances $T$ and $q$ in time using an explicit method that respects the hyperbolic character imposed by the Cattaneo–Vernotte law. Determine a stability-limiting time step by estimating the characteristic propagation speed from material properties and $\\tau_q$, and ensure that the update remains stable for the range of parameters provided.\n\nFor each test case below, use a square current pulse $J(t)$ defined by $J(t)=J_0$ for $0\\le t\\le t_{\\mathrm{on}}$ and $J(t)=0$ for $tt_{\\mathrm{on}}$. Compute the temperature at the center of the wire $x=L/2$ at final time $t_{\\mathrm{end}}$. Express all temperature outputs in kelvin (K) and provide each result as a floating-point number. The final output must be a single line containing a comma-separated Python list of the four results in the order of the test cases.\n\nFundamental quantities and definitions to use in the derivation:\n- Energy conservation in one dimension: $\\rho c \\,\\partial_t T + \\partial_x q = \\text{source}$.\n- Cattaneo–Vernotte heat flux law: $q + \\tau_q \\,\\partial_t q = -k\\, \\partial_x T$.\n- Peltier volumetric source in one dimension: $-\\partial_x(\\Pi J)$ with $\\Pi=S_0 T$ and spatially uniform $J(t)$.\n\nBoundary conditions:\n- Vanishing heat flux at both ends: $q(0,t)=0$ and $q(L,t)=0$ for all $t\\ge 0$, and consistency of $\\partial_x T$ at the boundaries implied by the Cattaneo–Vernotte law.\n\nInitial conditions:\n- $T(x,0)=T_0$ for all $x\\in[0,L]$.\n- $q(x,0)$ consistent with $T(x,0)$ via the Cattaneo–Vernotte law.\n\nRequired unit specification:\n- Temperatures must be reported in kelvin (K).\n- Time is in seconds (s), length in meters (m), mass density in kilograms per cubic meter (kg/m$^3$), specific heat capacity in joules per kilogram-kelvin (J/(kg·K)), thermal conductivity in watts per meter-kelvin (W/(m·K)), heat flux relaxation time in seconds (s), Seebeck coefficient in volts per kelvin (V/K), and current density in amperes per square meter (A/m$^2$).\n\nTest suite:\n1. Baseline hyperbolic regime:\n   - $L=5\\times 10^{-6}\\,\\text{m}$, $N_x=101$, $\\rho=8000\\,\\text{kg/m}^3$, $c=400\\,\\text{J/(kg·K)}$, $k=100\\,\\text{W/(m·K)}$, $\\tau_q=10^{-9}\\,\\text{s}$, $S_0=10^{-4}\\,\\text{V/K}$, $J_0=10^{10}\\,\\text{A/m}^2$, $t_{\\mathrm{on}}=2.5\\times 10^{-8}\\,\\text{s}$, $t_{\\mathrm{end}}=5.0\\times 10^{-8}\\,\\text{s}$, $T_0=300\\,\\text{K}$.\n2. Near-Fourier limit (small relaxation time):\n   - Same as test case 1 except $\\tau_q=10^{-12}\\,\\text{s}$, $t_{\\mathrm{on}}=5.0\\times 10^{-9}\\,\\text{s}$, $t_{\\mathrm{end}}=2.0\\times 10^{-8}\\,\\text{s}$.\n3. Stronger thermoelectric coupling:\n   - Same as test case 1 except $S_0=3\\times 10^{-4}\\,\\text{V/K}$, $t_{\\mathrm{on}}=3.0\\times 10^{-8}\\,\\text{s}$, $t_{\\mathrm{end}}=6.0\\times 10^{-8}\\,\\text{s}$.\n4. Edge case with zero current:\n   - Same as test case 1 except $J_0=0\\,\\text{A/m}^2$, $t_{\\mathrm{on}}=2.5\\times 10^{-8}\\,\\text{s}$, $t_{\\mathrm{end}}=5.0\\times 10^{-8}\\,\\text{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be the temperature at $x=L/2$ at $t=t_{\\mathrm{end}}$ in kelvin, rounded to six decimal places.",
            "solution": "The problem requires the derivation of a system of equations for non-Fourier thermoelectric transport, the formulation of a numerical solution algorithm, and the implementation of this algorithm to solve for specific test cases.\n\n### Step 1: Derivation of the Governing Equations\n\nThe problem starts with two fundamental principles in one spatial dimension, $x$:\n1.  **Local energy conservation**: $\\rho c \\,\\partial_t T + \\partial_x q = \\text{source}$, where $\\rho$ is the material density, $c$ is the specific heat capacity, $T(x,t)$ is the temperature, and $q(x,t)$ is the heat flux.\n2.  **Cattaneo–Vernotte heat flux law**: $q + \\tau_q \\,\\partial_t q = -k\\, \\partial_x T$, which introduces a relaxation time $\\tau_q$ for the heat flux, in contrast to Fourier's law. Here, $k$ is the thermal conductivity.\n\nThe volumetric heat source is due to the Peltier effect, given as $-\\partial_x(\\Pi J)$. The Peltier coefficient $\\Pi$ is related to the Seebeck coefficient $S_0$ by $\\Pi(T) = S_0 T$. The electrical current density $J(t)$ is given as spatially uniform. Therefore, the source term is:\n$$\n\\text{source} = -\\partial_x(S_0 T(x,t) J(t)) = -S_0 J(t) \\partial_x T(x,t)\n$$\nSubstituting this into the energy conservation equation yields the first governing equation:\n$$\n\\rho c \\,\\partial_t T = - \\partial_x q - S_0 J(t) \\partial_x T\n$$\nIsolating the time derivative of temperature, we get:\n$$\n\\partial_t T = -\\frac{1}{\\rho c} \\partial_x q - \\frac{S_0 J(t)}{\\rho c} \\partial_x T \\quad \\quad (1)\n$$\nThe second governing equation is obtained by rearranging the Cattaneo–Vernotte law to express the time derivative of the heat flux:\n$$\n\\tau_q \\,\\partial_t q = -q - k \\partial_x T\n$$\n$$\n\\partial_t q = -\\frac{1}{\\tau_q} q - \\frac{k}{\\tau_q} \\partial_x T \\quad \\quad (2)\n$$\nEquations (1) and (2) form a coupled system of first-order partial differential equations for $T(x,t)$ and $q(x,t)$. This system is hyperbolic, meaning that thermal disturbances propagate at a finite speed, a key feature of the Cattaneo-Vernotte model.\n\nThe Peltier term, $-S_0 J(t) \\partial_x T$, modifies the temperature evolution by introducing a source or sink of heat that is proportional to both the applied current density $J(t)$ and the local temperature gradient $\\partial_x T$. This term can be interpreted as an advective transport of energy, with an effective velocity proportional to $J(t)$. When $J(t)$ is a pulse, this effect is switched on and off, which can launch thermal waves from regions with pre-existing or induced temperature gradients.\n\n### Step 2: Boundary and Initial Conditions\n\nThe wire is thermally isolated at its ends, $x=0$ and $x=L$. This is expressed as a vanishing heat flux:\n$$\nq(0, t) = 0 \\quad \\text{and} \\quad q(L, t) = 0 \\quad \\text{for all } t \\ge 0.\n$$\nThese boundary conditions for $q$ imply boundary conditions for $T$. Since $q$ is identically zero at the boundaries for all time, its time derivative must also be zero, i.e., $\\partial_t q(0,t) = 0$ and $\\partial_t q(L,t) = 0$. Substituting these into the Cattaneo-Vernotte equation at the boundaries:\nAt $x=0$: $q(0,t) + \\tau_q \\partial_t q(0,t) = -k \\partial_x T(0,t) \\implies 0 + \\tau_q (0) = -k \\partial_x T(0,t) \\implies \\partial_x T(0,t) = 0$.\nAt $x=L$: Similarly, $\\partial_x T(L,t) = 0$.\nSo, the thermal isolation implies zero-Neumann boundary conditions for the temperature field.\n\nThe initial conditions are given as:\n1.  A uniform initial temperature: $T(x,0) = T_0$.\n2.  An initial heat flux consistent with the initial temperature. Since $T(x,0)=T_0$ is uniform, its spatial gradient is zero: $\\partial_x T(x,0) = 0$. The Cattaneo–Vernotte equation at $t=0$ reads $q(x,0) + \\tau_q \\partial_t q(x,0)|_{t=0} = -k \\partial_x T(x,0) = 0$. Assuming the system is in a steady state just before $t=0$, we have $\\partial_t q = 0$, which leads to $q(x,0) = 0$. This is consistent with the boundary conditions.\n\n### Step 3: Semi-Discrete Numerical Algorithm\n\nWe will discretize the wire of length $L$ into $N_x$ grid points $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N_x-1$, where $\\Delta x = L/(N_x-1)$. The fields are approximated as $T_i(t) \\approx T(x_i, t)$ and $q_i(t) \\approx q(x_i, t)$.\n\n**Spatial Discretization:**\nWe use second-order central differences for spatial derivatives at interior points ($i=1, \\dots, N_x-2$):\n$$\n(\\partial_x f)_i \\approx \\frac{f_{i+1} - f_{i-1}}{2 \\Delta x}\n$$\nAt the boundaries, we must handle the derivatives consistent with the boundary conditions.\n- For $\\partial_x T$: The Neumann boundary conditions $\\partial_x T=0$ at $x=0,L$ are enforced by setting the discrete gradient to zero: $(\\partial_x T)_0 = 0$ and $(\\partial_x T)_{N_x-1} = 0$.\n- For $\\partial_x q$: We use first-order one-sided differences at the boundaries, which is a stable and straightforward approach.\n    - At $i=0$: $(\\partial_x q)_0 \\approx \\frac{q_1 - q_0}{\\Delta x} = \\frac{q_1}{\\Delta x}$ since $q_0=0$.\n    - At $i=N_x-1$: $(\\partial_x q)_{N_x-1} \\approx \\frac{q_{N_x-1} - q_{N_x-2}}{\\Delta x} = -\\frac{q_{N_x-2}}{\\Delta x}$ since $q_{N_x-1}=0$.\n\n**Time Integration:**\nWe use an explicit time-stepping scheme. Let the superscript $n$ denote the time level $t^n = n \\Delta t$.\nThe update for $T$ is based on the forward Euler method:\n$$\nT_i^{n+1} = T_i^n + \\Delta t \\left( -\\frac{1}{\\rho c} (\\partial_x q)_i^n - \\frac{S_0 J(t^n)}{\\rho c} (\\partial_x T)_i^n \\right)\n$$\nThe equation for $q$ contains a potentially stiff relaxation term $-q/\\tau_q$. A simple forward Euler step for this equation can be unstable if $\\Delta t  \\tau_q$. To overcome this, we use an exponential time differencing scheme (ETD1), which results from exact integration of the term linear in $q$, assuming the forcing term is constant over the time step $\\Delta t$:\n$$\nq_i^{n+1} = q_i^n e^{-\\Delta t/\\tau_q} - k (1 - e^{-\\Delta t/\\tau_q}) (\\partial_x T)_i^n\n$$\nThis scheme is stable for any $\\Delta t  0$ and correctly captures the physics in both the hyperbolic ($\\tau_q \\gg \\Delta t$) and parabolic ($\\tau_q \\ll \\Delta t$) limits.\n\n**Stability and Time Step:**\nThe system of PDEs is hyperbolic. The stability of the explicit scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition, $\\Delta t \\le C_{cfl} \\frac{\\Delta x}{v_{max}}$, where $C_{cfl} \\le 1$ is the Courant number and $v_{max}$ is the maximum characteristic propagation speed. The characteristic speeds $\\lambda$ are the eigenvalues of the matrix of coefficients of the spatial derivative terms:\n$$\n\\mathbf{A} = \\begin{pmatrix} \\frac{S_0 J}{\\rho c}  \\frac{1}{\\rho c} \\\\ \\frac{k}{\\tau_q}  0 \\end{pmatrix}\n$$\nThe eigenvalues are $\\lambda = \\frac{1}{2} \\left( \\frac{S_0 J}{\\rho c} \\pm \\sqrt{ (\\frac{S_0 J}{\\rho c})^2 + 4 \\frac{k}{\\rho c \\tau_q} } \\right)$.\nThe maximum speed is $v_{max} = |\\lambda|_{max}$. The term $\\frac{k}{\\rho c \\tau_q}$ is typically dominant. We can thus estimate the speed as $v_{max} \\approx \\sqrt{k/(\\rho c \\tau_q)}$. The CFL condition becomes:\n$$\n\\Delta t \\le C_{cfl} \\frac{\\Delta x}{\\sqrt{k/(\\rho c \\tau_q)}}\n$$\nWe choose a safe Courant number, e.g., $C_{cfl}=0.5$, to ensure stability.\n\n### Algorithm Summary\n1.  **Initialization**:\n    - Define grid parameters $L, N_x, \\Delta x = L/(N_x-1)$.\n    - Define material and problem parameters $\\rho, c, k, \\tau_q, S_0, J_0, T_0, t_{on}, t_{end}$.\n    - Calculate the characteristic speed $v_{max} = \\sqrt{k/(\\rho c \\tau_q)}$ and the stable time step $\\Delta t = C_{cfl} \\Delta x / v_{max}$.\n    - Initialize arrays $T_i^0 = T_0$ and $q_i^0 = 0$ for $i=0, \\dots, N_x-1$.\n2.  **Time Loop**: For $t = 0$ to $t_{end}$ with step $\\Delta t$:\n    - Determine current $J(t) = J_0$ if $t \\le t_{on}$, else $J(t)=0$.\n    - Create copies of current state: $T_{old} \\leftarrow T$, $q_{old} \\leftarrow q$.\n    - Compute spatial derivatives $(\\partial_x T)^n$ and $(\\partial_x q)^n$ from $T_{old}$ and $q_{old}$ using central/one-sided differences as described.\n    - Update $T$ for all $i$: $T_i \\leftarrow T_{old, i} + \\Delta t \\left( -\\frac{1}{\\rho c} (\\partial_x q)^n_i - \\frac{S_0 J(t)}{\\rho c} (\\partial_x T)^n_i \\right)$.\n    - Update $q$ for interior points $i=1, \\dots, N_x-2$: $q_i \\leftarrow q_{old, i} e^{-\\Delta t/\\tau_q} - k (1 - e^{-\\Delta t/\\tau_q}) (\\partial_x T)^n_i$.\n    - Enforce boundary conditions: $q_0=0, q_{N_x-1}=0$.\n3.  **Result**: After the loop finishes, the temperature at the center of the wire is $T_{(N_x-1)/2}$.\n\nThis procedure is implemented for each test case to find the required final temperature.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(L, Nx, rho, c, k, tau_q, S0, J0, t_on, t_end, T0):\n    \"\"\"\n    Solves the coupled T and q equations using a finite difference method.\n    \"\"\"\n    # Grid setup\n    dx = L / (Nx - 1)\n    x = np.linspace(0, L, Nx)\n    center_index = (Nx - 1) // 2\n\n    # Stability analysis and time step selection\n    # Characteristic speed approximation, ignoring the smaller advection term\n    v_max_squared = k / (rho * c * tau_q)\n    if v_max_squared = 0:\n        dt = 1e-12 # A small but reasonable dt if speed is imaginary or zero\n    else:\n        v_max = np.sqrt(v_max_squared)\n        # CFL condition for stability\n        cfl_number = 0.5  # Courant number (safety factor  1)\n        dt = cfl_number * dx / v_max\n    \n    # Initial conditions\n    T = np.full(Nx, T0, dtype=np.float64)\n    q = np.zeros(Nx, dtype=np.float64)\n\n    # Time-stepping loop\n    t = 0.0\n    while t  t_end:\n        # Adjust dt for the final step to land exactly on t_end\n        if t + dt > t_end:\n            dt = t_end - t\n\n        # Current density pulse\n        J = J0 if t = t_on else 0.0\n\n        T_old = np.copy(T)\n        q_old = np.copy(q)\n\n        # 1. Compute spatial derivatives from the state at time n\n        dTx = np.zeros_like(T_old)\n        dqx = np.zeros_like(q_old)\n\n        # Central differences for interior points\n        dTx[1:-1] = (T_old[2:] - T_old[:-2]) / (2 * dx)\n        dqx[1:-1] = (q_old[2:] - q_old[:-2]) / (2 * dx)\n        \n        # Boundary conditions for T: dT/dx = 0\n        # These are effectively handled by setting the derivative to zero\n        dTx[0] = 0.0\n        dTx[-1] = 0.0\n        \n        # One-sided differences for q derivative at boundaries\n        dqx[0] = (q_old[1] - q_old[0]) / dx  # Uses q[0]=0\n        dqx[-1] = (q_old[-1] - q_old[-2]) / dx # Uses q[-1]=0\n\n        # 2. Update T using Forward Euler\n        T = T_old - (dt / (rho * c)) * dqx - (dt * S0 * J / (rho * c)) * dTx\n        \n        # 3. Update q using Exponential Time Differencing (ETD1)\n        # This handles the stiff relaxation term robustly\n        exp_factor = np.exp(-dt / tau_q) if tau_q > 0 else 0.0\n        q = q_old * exp_factor - k * (1.0 - exp_factor) * dTx\n\n        # Enforce boundary conditions on q\n        q[0] = 0.0\n        q[-1] = 0.0\n        \n        t += dt\n\n    return T[center_index]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # (L, Nx, rho, c, k, tau_q, S0, J0, t_on, t_end, T0)\n    test_cases = [\n        # 1. Baseline hyperbolic regime\n        (5e-6, 101, 8000, 400, 100, 1e-9, 1e-4, 1e10, 2.5e-8, 5.0e-8, 300.0),\n        # 2. Near-Fourier limit (small relaxation time)\n        (5e-6, 101, 8000, 400, 100, 1e-12, 1e-4, 1e10, 5.0e-9, 2.0e-8, 300.0),\n        # 3. Stronger thermoelectric coupling\n        (5e-6, 101, 8000, 400, 100, 1e-9, 3e-4, 1e10, 3.0e-8, 6.0e-8, 300.0),\n        # 4. Edge case with zero current\n        (5e-6, 101, 8000, 400, 100, 1e-9, 1e-4, 0.0, 2.5e-8, 5.0e-8, 300.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(*params)\n        results.append(round(result, 6))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}