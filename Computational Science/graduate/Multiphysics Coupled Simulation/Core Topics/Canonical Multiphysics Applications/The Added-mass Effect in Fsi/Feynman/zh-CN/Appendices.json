{
    "hands_on_practices": [
        {
            "introduction": "第一个实践为理解附加质量效应的动力学后果奠定了基础。你将通过分析简单的振子系统，推导流体附加质量如何降低系统的固有频率，并探索在多自由度系统中，流体耦合如何从根本上改变振动模态，从而具体地理解流体载荷对结构动态特性的影响。",
            "id": "3527967",
            "problem": "一个执行一维运动的刚性结构浸没在不可压缩的无粘性流体中，流体施加的惯性反作用力可以用附加质量来表示。考虑两种情况。\n\n(a) 单自由度情况：一个结构质量为 $m_{s}$ 的质点连接到一个刚度为 $k$ 的线性弹簧上，在静止流体中以位移 $x(t)$ 运动。流体动力反作用力被建模为乘以结构加速度的附加质量 $m_{a}$。从 Newton 第二定律和线弹性力的定义出发，推导无阻尼自由振动运动方程，并求出固有频率作为 $m_{s}$、$m_{a}$ 和 $k$ 的函数。\n\n(b) 多自由度情况：两个共线质点的结构质量分别为 $m_{1}$ 和 $m_{2}$，通过线性弹簧连接，其中第一个质点通过刚度为 $k_{1}$ 的弹簧连接到地面，两个质点之间通过刚度为 $k_{2}$ 的弹簧连接。该系统在不可压缩的无粘性流体中进行小幅运动。流体引起的惯性由一个对称的附加质量矩阵表示。利用每个自由度的 Newton 第二定律并组合无阻尼自由振动方程，定性解释非比例附加质量矩阵的存在如何相对于真空中的系统改变振型和模态参与因子。\n\n然后，对于具体的参数值\n- $m_{1} = 10\\,\\mathrm{kg}$，$m_{2} = 10\\,\\mathrm{kg}$，\n- $k_{1} = 4000\\,\\mathrm{N/m}$，$k_{2} = 2000\\,\\mathrm{N/m}$，\n- 附加质量矩阵 $M_{a}$ 的元素为 $m_{a,11} = 5\\,\\mathrm{kg}$、$m_{a,22} = 5\\,\\mathrm{kg}$ 和 $m_{a,12} = m_{a,21} = 2\\,\\mathrm{kg}$，\n\n通过寻找非平凡谐波解，计算耦合流固系统的最低固有频率（单位为弧度/秒）。将您的答案四舍五入到四位有效数字，并以弧度/秒表示频率。",
            "solution": "该问题经检验具有科学依据、提法明确、客观且完整。它对结构动力学中单自由度（SDOF）和多自由度（MDOF）系统的附加质量效应进行了标准分析。所有提供的参数都符合物理实际且量纲一致。\n\n** (a)部分：单自由度系统**\n\n我们考虑一个质量为 $m_s$ 的质点连接到一个刚度为 $k$ 的弹簧上。质点的位移为 $x(t)$。该系统浸没在静止、不可压缩、无粘性的流体中。\n\n根据 Newton 第二定律，作用在质点上的外力之和等于其质量乘以其加速度。\n$$ \\sum F_{\\text{ext}} = m_s \\ddot{x}(t) $$\n外力包括弹簧恢复力 $F_k$ 和来自流体的流体动力 $F_f$。\n\n弹簧力由 Hooke 定律给出：\n$$ F_k = -k x(t) $$\n\n问题陈述，流体动力反作用力被建模为乘以结构加速度 $\\ddot{x}(t)$ 的附加质量 $m_a$。该力与物体相对于静止流体的加速度方向相反。因此，流体施加在结构上的力为：\n$$ F_f = -m_a \\ddot{x}(t) $$\n\n将外力代入 Newton 第二定律：\n$$ F_k + F_f = m_s \\ddot{x}(t) $$\n$$ -k x(t) - m_a \\ddot{x}(t) = m_s \\ddot{x}(t) $$\n\n重新排列各项，得到自由振动的标准运动方程：\n$$ m_s \\ddot{x}(t) + m_a \\ddot{x}(t) + k x(t) = 0 $$\n$$ (m_s + m_a) \\ddot{x}(t) + k x(t) = 0 $$\n\n这是无阻尼单自由度系统的运动方程。其形式为 $M_{\\text{eff}} \\ddot{x} + K_{\\text{eff}} x = 0$，其中有效质量为 $M_{\\text{eff}} = m_s + m_a$，有效刚度为 $K_{\\text{eff}} = k$。这样一个系统的固有频率 $\\omega_n$ 由下式给出：\n$$ \\omega_n = \\sqrt{\\frac{K_{\\text{eff}}}{M_{\\text{eff}}}} $$\n代入有效质量和有效刚度的表达式，我们得到流固系统的固有频率：\n$$ \\omega_n = \\sqrt{\\frac{k}{m_s + m_a}} $$\n\n** (b)部分：多自由度系统 - 定性解释**\n\n对于多自由度系统，无阻尼自由振动的矩阵形式运动方程为：\n$$ M \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\n其中 $\\mathbf{x} = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ 是位移向量，$M$ 是质量矩阵，$K$ 是刚度矩阵。\n\n对于真空中的系统，质量矩阵 $M_s$ 是对角的，仅包含结构质量：\n$$ M_s = \\begin{pmatrix} m_1 & 0 \\\\ 0 & m_2 \\end{pmatrix} $$\n刚度矩阵 $K$ 是从弹簧力推导出来的。作用在质量1上的力是 $-k_1 x_1 + k_2(x_2-x_1)$，作用在质量2上的力是 $-k_2(x_2-x_1)$。由此可得：\n$$ K = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} $$\n真空中的运动方程为 $M_s \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$。振型是广义特征值问题 $(K - \\omega^2 M_s) \\mathbf{\\phi} = \\mathbf{0}$ 的特征向量。\n\n当系统浸没在流体中时，总质量矩阵成为结构质量矩阵 $M_s$ 和附加质量矩阵 $M_a$ 的和：\n$$ M_{\\text{total}} = M_s + M_a $$\n附加质量矩阵 $M_a$ 是对称且非对角的：\n$$ M_a = \\begin{pmatrix} m_{a,11} & m_{a,12} \\\\ m_{a,21} & m_{a,22} \\end{pmatrix}, \\quad m_{a,12} = m_{a,21} \\neq 0 $$\n耦合系统的运动方程为：\n$$ (M_s + M_a) \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} \\quad \\implies \\quad M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\n由于非对角项 $m_{a,12}$ 和 $m_{a,21}$ 的存在，总质量矩阵 $M_{\\text{total}}$ 是非对角的。这些项代表流体动力（惯性）耦合：质量1的加速度会在质量2上引起惯性流体力，反之亦然。\n\n非比例附加质量矩阵的存在会如下修改系统的模态特性：\n1.  **振型**：耦合系统的振型是修正后的广义特征值问题 $(K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0}$ 的特征向量。由于总质量矩阵 $M_{\\text{total}}$ 与结构质量矩阵 $M_s$ 不成比例（即，对于任何标量 $c$，$M_{\\text{total}} \\neq c M_s$），耦合系统的特征向量将不同于真空中系统的特征向量（振型）。惯性耦合从根本上改变了自由度之间的动态关系，导致了不同的振动特征模式。新的振型相对于 $M_{\\text{total}}$ 和 $K$ 都是正交的，但通常不相对于原始结构质量矩阵 $M_s$ 正交。\n\n2.  **模态参与因子**：模态参与因子 $\\Gamma_i$ 量化了在给定的外部载荷模式下，每个模态对系统响应的贡献程度。对于载荷向量 $\\mathbf{f}(t) = \\mathbf{p} f(t)$，模态 $i$ 的参与因子为 $\\Gamma_i = \\mathbf{\\phi}_i^T M \\mathbf{p} / (\\mathbf{\\phi}_i^T M \\mathbf{\\phi}_i)$。振型 $\\mathbf{\\phi}_i$ 和质量矩阵 $M$（从 $M_s$ 变为 $M_{\\text{total}}$）都因流体而改变。因此，模态参与因子将会改变。流体动力耦合重新分配了系统的有效惯性，这反过来又改变了每个模态在响应外部载荷时的参与方式。\n\n** (c)部分：多自由度系统 - 数值计算**\n\n我们得到以下参数值：\n$m_1 = 10\\,\\mathrm{kg}$, $m_2 = 10\\,\\mathrm{kg}$\n$k_1 = 4000\\,\\mathrm{N/m}$, $k_2 = 2000\\,\\mathrm{N/m}$\n$M_a = \\begin{pmatrix} 5 & 2 \\\\ 2 & 5 \\end{pmatrix}\\,\\mathrm{kg}$\n\n首先，我们组装结构质量矩阵、总质量矩阵和刚度矩阵。\n结构质量矩阵为：\n$$ M_s = \\begin{pmatrix} 10 & 0 \\\\ 0 & 10 \\end{pmatrix}\\,\\mathrm{kg} $$\n总质量矩阵为：\n$$ M_{\\text{total}} = M_s + M_a = \\begin{pmatrix} 10 & 0 \\\\ 0 & 10 \\end{pmatrix} + \\begin{pmatrix} 5 & 2 \\\\ 2 & 5 \\end{pmatrix} = \\begin{pmatrix} 15 & 2 \\\\ 2 & 15 \\end{pmatrix}\\,\\mathrm{kg} $$\n刚度矩阵为：\n$$ K = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} = \\begin{pmatrix} 4000+2000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix} = \\begin{pmatrix} 6000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix}\\,\\mathrm{N/m} $$\n\n为了求固有频率，我们寻找 $\\mathbf{x}(t) = \\mathbf{\\phi} e^{i\\omega t}$ 形式的非平凡谐波解。将其代入运动方程 $M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$，得到广义特征值问题：\n$$ (K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0} $$\n这要求系数矩阵的行列式为零。令 $\\lambda = \\omega^2$。\n$$ \\det(K - \\lambda M_{\\text{total}}) = 0 $$\n$$ \\det\\left( \\begin{pmatrix} 6000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix} - \\lambda \\begin{pmatrix} 15 & 2 \\\\ 2 & 15 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\begin{pmatrix} 6000 - 15\\lambda & -2000 - 2\\lambda \\\\ -2000 - 2\\lambda & 2000 - 15\\lambda \\end{pmatrix} = 0 $$\n展开行列式得到特征方程：\n$$ (6000 - 15\\lambda)(2000 - 15\\lambda) - (-2000 - 2\\lambda)^2 = 0 $$\n$$ (12 \\times 10^6 - 90000\\lambda - 30000\\lambda + 225\\lambda^2) - (4 \\times 10^6 + 8000\\lambda + 4\\lambda^2) = 0 $$\n$$ 225\\lambda^2 - 120000\\lambda + 12 \\times 10^6 - 4\\lambda^2 - 8000\\lambda - 4 \\times 10^6 = 0 $$\n合并同类项，我们得到一个关于 $\\lambda$ 的二次方程：\n$$ 221\\lambda^2 - 128000\\lambda + 8 \\times 10^6 = 0 $$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\lambda$：\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{(-128000)^2 - 4(221)(8 \\times 10^6)}}{2(221)} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{16.384 \\times 10^9 - 7.072 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{9.312 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm 96498.7046...}{442} $$\n两个特征值 $\\lambda = \\omega^2$ 是：\n$$ \\lambda_1 = \\frac{128000 - 96498.7046...}{442} \\approx 71.2699... \\ (\\text{rad/s})^2 $$\n$$ \\lambda_2 = \\frac{128000 + 96498.7046...}{442} \\approx 507.9156... \\ (\\text{rad/s})^2 $$\n最低固有频率对应于较小的特征值 $\\lambda_1$。\n$$ \\omega_{lowest} = \\sqrt{\\lambda_1} \\approx \\sqrt{71.2699...} \\approx 8.442150... \\ \\text{rad/s} $$\n将结果四舍五入到四位有效数字，得到：\n$$ \\omega_{lowest} \\approx 8.442 \\ \\text{rad/s} $$",
            "answer": "$$ \\boxed{8.442} $$"
        },
        {
            "introduction": "了解附加质量如何影响动力学之后，一个关键的工程问题是：它的影响在何时才足够显著？本练习将指导你通过编程进行参数化研究，根据流固密度比对问题进行分类。这项实践将物理参数与数值模拟中的关键决策（如选择强耦合或弱耦合方案）直接联系起来，揭示理论与应用之间的桥梁。",
            "id": "3527931",
            "problem": "考虑一个浸没在无粘、不可压缩流体中的单自由度线性结构振子，这是一个用于评估附加质量效应的典型流固耦合（Fluid-Structure Interaction, FSI）设定。该结构被建模为一个连接到线性弹簧上的刚性质量，其运动方向垂直于流体。流体的特性仅由其附加质量来表征。设结构质量为 $m_s = \\rho_s V$，流体附加质量为 $m_a = C_a \\rho_f V$，其中 $\\rho_s$ 是结构密度，$\\rho_f$ 是流体密度，$V$ 是特征排开体积，$C_a$ 是由几何形状决定的无量纲附加质量系数。有效质量为 $m_{\\text{eff}} = m_s + m_a$。线性弹簧的刚度为 $k$。假设结构阻尼为零。\n\n你的任务是从 Newton 第二定律和有效惯性的定义出发，推导、实现并评估一个关于密度比 $\\beta = \\rho_s/\\rho_f$ 的参数化研究，以识别附加质量可忽略、与结构惯性相当或在结构惯性中占主导地位的区域，并为多物理场求解器中的数值耦合策略提取启示。\n\n使用以下基础建模假设和要求：\n- 基本依据：Newton 第二定律、线性振子动力学以及附加质量的定义。流体的贡献纯粹是惯性的：$m_a = C_a \\rho_f V$。\n- 干固有频率：$\\omega_{\\text{dry}} = \\sqrt{k/m_s}$。\n- 湿（耦合）固有频率：$\\omega = \\sqrt{k/(m_s + m_a)}$。\n- 质量比：$r = m_a/m_s = C_a/\\beta$。\n- 频率比：$\\omega/\\omega_{\\text{dry}} = \\sqrt{m_s/(m_s + m_a)} = 1/\\sqrt{1 + r}$。\n\n使用有原则的定量标准定义区域分类：\n- 附加质量可忽略（代码 $0$）：相对频率降低很小，即 $1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$，其中 $\\varepsilon_{\\text{negl}} = 0.05$。证明这对应于 $r \\le r_{\\text{negl}}$，其中 $r_{\\text{negl}} = \\dfrac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$。\n- 附加质量占主导（代码 $2$）：附加质量比结构质量大至少一个数量级，即 $r \\ge \\tau_{\\text{dom}}$，其中 $\\tau_{\\text{dom}} = 10$。\n- 附加质量相当（代码 $1$）：中间区域 $r_{\\text{negl}} < r < \\tau_{\\text{dom}}$。\n\n数值耦合启示（以布尔值计算和报告）：定义流体惯性分数 $\\gamma = \\dfrac{m_a}{m_s + m_a} = \\dfrac{r}{1 + r}$。如果 $\\gamma \\ge \\gamma_{\\text{crit}}$（其中 $\\gamma_{\\text{crit}} = 0.3$），则建议使用强（隐式）耦合。否则，弱（显式）耦合可能是可接受的。对于每个测试用例，必须计算此标准并以布尔值报告。\n\n此外，计算线性振子的显式中心差分稳定性时间步长限制，\n$$\\Delta t_{\\text{crit}} = \\dfrac{2}{\\omega},$$\n并以秒为单位报告。\n\n所有情况下使用以下固定参数：\n- 刚度 $k = 1.0 \\times 10^5\\,\\mathrm{N/m}$，\n- 体积 $V = 1.0\\,\\mathrm{m^3}$。\n\n测试套件：\n对于每个测试用例，输入为 $(\\rho_s,\\ \\rho_f,\\ C_a)$，单位分别为 $\\mathrm{kg/m^3}$ 和无量纲。\n\n- 案例 1：$(10.0,\\ 1000.0,\\ 1.0)$。\n- 案例 2：$(1000.0,\\ 1000.0,\\ 1.0)$。\n- 案例 3：$(10000.0,\\ 1000.0,\\ 1.0)$，对应于 $r = 0.1$。\n- 案例 4：$(8333.333333333333,\\ 1000.0,\\ 1.0)$，对应于 $r = 0.12$。\n- 案例 5：$(111.11111111111111,\\ 1000.0,\\ 1.0)$，对应于 $r = 9.0$。\n- 案例 6：$(50.0,\\ 1000.0,\\ 0.5)$，对应于 $r = 10.0$。\n- 案例 7：$(8000.0,\\ 1000.0,\\ 2.0)$，对应于 $r = 0.25$。\n\n对于每个测试用例，你的程序必须输出一个包含四个条目的列表：\n- 区域代码（整数）：$0$（可忽略），$1$（相当）或 $2$（占主导）。\n- 频率比 $\\omega/\\omega_{\\text{dry}}$（浮点数）。\n- 强耦合建议（布尔值），基于 $\\gamma \\ge \\gamma_{\\text{crit}}$。\n- 临界显式时间步长 $\\Delta t_{\\text{crit}}$（以秒为单位的浮点数）。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含所有七个案例的结果，形式为一个用方括号括起来的逗号分隔列表。每个元素本身必须是一个包含相应测试用例的四个值的列表，顺序如上所述。例如：\n$[\\,[\\text{code}_1,\\ \\text{fr}_1,\\ \\text{bool}_1,\\ \\Delta t_1],\\ [\\text{code}_2,\\ \\text{fr}_2,\\ \\text{bool}_2,\\ \\Delta t_2],\\ \\ldots\\,]$。",
            "solution": "问题陈述经评估是有效的。它在科学上基于经典力学和流体动力学的原理，特别是线性振子的建模和流固耦合（FSI）中的附加质量效应。该问题是适定的，所有必要的参数、定义和标准都已明确指定，确保可以确定一个唯一且有意义的解。整个设置是自洽且逻辑一致的。\n\n解决方案首先建立理论框架，然后将其应用于指定的测试用例。\n\n所考虑的系统是一个浸没在流体中的单自由度（SDOF）结构振子。结构的运动由 Newton 第二定律控制。在真空（或“干”条件）下，质量为 $m_s$、弹簧刚度为 $k$ 的无阻尼振子的运动方程为：\n$$m_s \\ddot{x} + kx = 0$$\n其中 $x$ 是位移，$\\ddot{x}$ 是加速度。这个“干”系统的固有频率由下式给出：\n$$\\omega_{\\text{dry}} = \\sqrt{\\frac{k}{m_s}}$$\n\n当振子浸没在流体中时，其运动会使周围的流体加速，而流体反过来又会对结构施加一个惯性力。对于无粘、不可压缩的流体，这种效应可以建模为“附加质量” $m_a$，概念上讲，这是一部分与结构一同运动的流体质量。系统的总有效质量变为结构质量和附加质量之和：\n$$m_{\\text{eff}} = m_s + m_a$$\n于是，“湿”系统的运动方程为：\n$$(m_s + m_a) \\ddot{x} + kx = 0$$\n这个耦合 FSI 系统（即“湿”系统）的固有频率为：\n$$\\omega = \\sqrt{\\frac{k}{m_s + m_a}}$$\n\n问题提供了以下定义：\n- 结构质量：$m_s = \\rho_s V$，其中 $\\rho_s$ 是结构密度，$V$ 是特征体积。\n- 附加质量：$m_a = C_a \\rho_f V$，其中 $\\rho_f$ 是流体密度，$C_a$ 是附加质量系数。\n\n控制系统行为的一个关键无量纲参数是质量比 $r$，定义为附加质量与结构质量之比：\n$$r = \\frac{m_a}{m_s} = \\frac{C_a \\rho_f V}{\\rho_s V} = \\frac{C_a \\rho_f}{\\rho_s}$$\n使用密度比的定义 $\\beta = \\rho_s/\\rho_f$，质量比可以表示为 $r = C_a/\\beta$。\n\n附加质量降低了系统的固有频率。这种降低的程度由频率比来量化：\n$$\\frac{\\omega}{\\omega_{\\text{dry}}} = \\frac{\\sqrt{k/(m_s + m_a)}}{\\sqrt{k/m_s}} = \\sqrt{\\frac{m_s}{m_s + m_a}} = \\sqrt{\\frac{1}{1 + m_a/m_s}} = \\frac{1}{\\sqrt{1 + r}}$$\n这个关系表明，频率比以及整个系统的动态行为都由质量比 $r$ 唯一确定。\n\n问题要求根据附加质量效应的显著性进行区域分类。该标准基于相对频率降低 $1 - \\omega/\\omega_{\\text{dry}}$。\n- **附加质量可忽略（代码 $0$）**：该区域由一个小的频率降低定义：$1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$，其中 $\\varepsilon_{\\text{negl}} = 0.05$。我们可以将其转化为关于 $r$ 的一个条件：\n$$1 - \\frac{1}{\\sqrt{1+r}} \\le \\varepsilon_{\\text{negl}} \\implies 1 - \\varepsilon_{\\text{negl}} \\le \\frac{1}{\\sqrt{1+r}} \\implies \\sqrt{1+r} \\le \\frac{1}{1 - \\varepsilon_{\\text{negl}}}$$\n$$1+r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} \\implies r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$$\n这定义了阈值 $r_{\\text{negl}}$。代入 $\\varepsilon_{\\text{negl}} = 0.05$：\n$$r_{\\text{negl}} = \\frac{1}{(1 - 0.05)^2} - 1 = \\frac{1}{0.95^2} - 1 = \\frac{1}{0.9025} - 1 \\approx 1.108033 - 1 = 0.108033$$\n因此，可忽略区域对应于 $r \\le 0.108033$。\n\n- **附加质量占主导（代码 $2$）**：该区域定义为附加质量显著大于结构质量，具体来说至少是其10倍。标准是 $r \\ge \\tau_{\\text{dom}}$，其中 $\\tau_{\\text{dom}} = 10$。\n\n- **附加质量相当（代码 $1$）**：该区域涵盖所有中间情况，即 $r_{\\text{negl}} < r < \\tau_{\\text{dom}}$。\n\n对于多物理场模拟，流体域和固体域之间的耦合强度至关重要。一个关键指标是流体惯性分数 $\\gamma$，它衡量流体贡献的总有效质量的比例：\n$$\\gamma = \\frac{m_a}{m_s + m_a} = \\frac{m_a/m_s}{1 + m_a/m_s} = \\frac{r}{1+r}$$\n问题陈述指出，如果流体惯性分数是显著的，即 $\\gamma \\ge \\gamma_{\\text{crit}}$（其中 $\\gamma_{\\text{crit}} = 0.3$），则推荐使用强（隐式）耦合。这个条件等价于：\n$$\\frac{r}{1+r} \\ge 0.3 \\implies r \\ge 0.3(1+r) \\implies 0.7r \\ge 0.3 \\implies r \\ge \\frac{3}{7} \\approx 0.42857$$\n一个布尔值（True/False）将代表此建议。\n\n最后，对于使用显式方法（如中心差分格式）进行的时域模拟，数值稳定性受系统最高频率的限制。线性振子的临界时间步长限制为：\n$$\\Delta t_{\\text{crit}} = \\frac{2}{\\omega}$$\n其中 $\\omega = \\sqrt{k/m_{\\text{eff}}}$。将为每个案例计算此值。\n\n对于每个测试用例 $(\\rho_s, \\rho_f, C_a)$，在固定参数 $k=1.0 \\times 10^5\\,\\mathrm{N/m}$ 和 $V=1.0\\,\\mathrm{m^3}$ 下的算法步骤如下：\n1. 计算质量比：$r = (C_a \\rho_f) / \\rho_s$。\n2. 确定区域代码：\n    - 如果 $r \\le r_{\\text{negl}} \\approx 0.108033$，代码为 $0$。\n    - 如果 $r \\ge \\tau_{\\text{dom}} = 10$，代码为 $2$。\n    - 否则，代码为 $1$。\n3. 计算频率比：$\\omega/\\omega_{\\text{dry}} = 1/\\sqrt{1+r}$。\n4. 确定强耦合建议：如果 $r \\ge 3/7$ 则为 True，否则为 False。\n5. 计算湿固有频率：$\\omega = \\sqrt{k / ((\\rho_s + C_a \\rho_f)V)}$。\n6. 计算临界时间步长：$\\Delta t_{\\text{crit}} = 2/\\omega$。\n7. 组合四个结果：[区域代码, 频率比, 耦合建议, 临界时间步长]。\n现在为所有指定的测试用例实施此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FSI added-mass problem for a set of test cases.\n    \"\"\"\n    \n    # Define fixed parameters and criteria from the problem statement.\n    k = 1.0e5  # Stiffness in N/m\n    V = 1.0    # Characteristic volume in m^3\n\n    epsilon_negl = 0.05\n    tau_dom = 10.0\n    gamma_crit = 0.3\n\n    # Calculate the threshold for the negligible regime.\n    r_negl = 1 / (1 - epsilon_negl)**2 - 1\n\n    # Calculate the mass ratio threshold for strong coupling.\n    # gamma = r / (1 + r) >= gamma_crit  => r >= gamma_crit / (1 - gamma_crit)\n    r_strong_coupling_threshold = gamma_crit / (1 - gamma_crit)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (rho_s, rho_f, C_a).\n    test_cases = [\n        (10.0, 1000.0, 1.0),                  # Case 1\n        (1000.0, 1000.0, 1.0),                # Case 2\n        (10000.0, 1000.0, 1.0),               # Case 3 (r=0.1)\n        (25000.0/3.0, 1000.0, 1.0),           # Case 4 (r=0.12)\n        (1000.0/9.0, 1000.0, 1.0),            # Case 5 (r=9.0)\n        (50.0, 1000.0, 0.5),                  # Case 6 (r=10.0)\n        (8000.0, 1000.0, 2.0),                # Case 7 (r=0.25)\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_s, rho_f, C_a = case\n\n        # 1. Calculate the mass ratio r.\n        # Ensure rho_s is not zero to avoid division errors, though not expected here.\n        if rho_s == 0:\n            # Handle theoretically infinite mass ratio\n            r = float('inf')\n        else:\n            r = (C_a * rho_f) / rho_s\n        \n        # 2. Determine the regime code.\n        if r = r_negl:\n            regime_code = 0  # Negligible\n        elif r >= tau_dom:\n            regime_code = 2  # Dominant\n        else:\n            regime_code = 1  # Comparable\n\n        # 3. Calculate the frequency ratio omega / omega_dry.\n        freq_ratio = 1 / np.sqrt(1 + r)\n\n        # 4. Determine the strong coupling recommendation.\n        # gamma = r / (1 + r)\n        # strong_coupling = gamma = gamma_crit\n        # Using the pre-calculated threshold on r is more direct.\n        strong_coupling = r >= r_strong_coupling_threshold\n\n        # 5. Calculate the effective mass and wet natural frequency.\n        m_s = rho_s * V\n        m_a = C_a * rho_f * V\n        m_eff = m_s + m_a\n        \n        # Check for m_eff = 0 to avoid domain errors in sqrt, though physically not expected.\n        if m_eff > 0:\n            omega = np.sqrt(k / m_eff)\n            # 6. Calculate the critical explicit time step.\n            dt_crit = 2 / omega\n        else:\n            omega = float('inf')\n            dt_crit = 0.0\n\n        # Assemble the results for the current case.\n        case_result = [regime_code, freq_ratio, strong_coupling, dt_crit]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the required format.\n    # Using \", \".join() to have spaces after commas between inner lists.\n    # Example format: [[c1, f1, b1, t1], [c2, f2, b2, t2], ...]\n    output_str = \"[\" + \", \".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "前面的练习指出了需要强耦合的场景，而这最后一个实践将向你展示如何构建这样一种方案。你将通过从第一性原理出发，推导并实现一个数值稳定的分区求解算法，从而解决FSI模拟中臭名昭著的“附加质量不稳定性”问题。这项实践将揭示，在流固界面上强制实施加速度连续性是获得稳定精确模拟的关键，尤其是在轻质结构与重流体相互作用的挑战性工况下。",
            "id": "3527976",
            "problem": "本题要求您在分区耦合方案中研究流固耦合（FSI）中的附加质量效应，并设计一种数值鲁棒的时间积分策略，通过在流固界面上施加离散加速度连续性条件来抑制附加质量不稳定性。请从第一性原理出发，依次进行建模、推导、离散化和实现。\n\n考虑一个长度为 $L$、横截面积为 $A$ 的一维不可压缩流体“段塞”在直通道中运动，并与一个柔性梁的梁尖相互作用。该梁简化为单一广义坐标 $x(t)$，代表梁的第一阶模态梁尖位移，单位为米。流体密度为 $\\rho_f$（单位 $\\mathrm{kg/m^3}$）。结构模型质量为 $m_s$（单位 $\\mathrm{kg}$），线性阻尼为 $c_s$（单位 $\\mathrm{N\\cdot s/m}$），刚度为 $k_s$（单位 $\\mathrm{N/m}$）。线性流体阻力由 $c_f$（单位 $\\mathrm{N\\cdot s/m}$）建模。流体与结构的界面位于梁尖；界面运动学强制流体段塞和梁共享相同的界面速度和加速度。流体在远端承受一个给定的出口压力 $p_{\\text{out}}(t)$。在数值测试中，您可以假设对于所有 $t$，$p_{\\text{out}}(t)=0$。\n\n仅使用基本定律和核心定义，推导并实现以下内容：\n\n1) 根据 Newton 第二定律推导控制方程：\n- 对于结构：\n  $$ m_s\\,\\ddot{x}(t) + c_s\\,\\dot{x}(t) + k_s\\,x(t) = A\\,p(t), $$\n  其中 $p(t)$ 是作用在结构面积 $A$ 上的界面压力。\n- 对于流体段塞（质量为 $m_f=\\rho_f A L$ 的控制体）：\n  $$ m_f\\,\\ddot{x}(t) = -A\\left(p(t)-p_{\\text{out}}(t)\\right) - c_f\\,\\dot{x}(t). $$\n\n2) 界面运动学和离散加速度连续性条件：\n- 界面运动学强制要求两个子系统共享相同的界面速度和加速度，即在所有时刻 $\\dot{x}_f(t)=\\dot{x}_s(t)=\\dot{x}(t)$ 和 $\\ddot{x}_f(t)=\\ddot{x}_s(t)=\\ddot{x}(t)$。在时间区间 $[t_n,t_{n+1}]$ 上，使用时间步长为 $\\Delta t$ 的后向欧拉离散化流体动量方程，将此运动学约束与流体动量方程结合，推导出一个离散的 Robin 型界面条件。该条件将新时刻的界面压力表示为新时刻界面加速度和速度的函数。您的推导必须从以下公式开始：\n  $$ m_f \\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t} = -A\\left(p_{n+1}-p_{\\text{out},n+1}\\right) - c_f\\,\\dot{x}_{n+1}, $$\n  并结合 $\\ddot{x}_{n+1}=\\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t}$，且不得假设任何预知的耦合公式。\n\n3) 时间离散化和预测-校正方案：\n- 使用参数 $\\beta=\\tfrac{1}{4}$ 和 $\\gamma=\\tfrac{1}{2}$ 的 Newmark 族方法对结构进行离散化，使得\n  $$ x_{n+1} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}, $$\n  $$ \\dot{x}_{n+1} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}. $$\n- 在每个时间步中形成一个预测-校正循环：\n  a) 预测步：计算运动学预测值\n     $$ x_{n+1}^{\\text{pred}} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n, \\quad \\dot{x}_{n+1}^{\\text{pred}} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n. $$\n  b) 校正步：在 $t_{n+1}$ 时刻施加结构平衡方程，并结合第 $2)$ 项中的离散界面条件以消去 $p_{n+1}$，从而直接求解 $\\ddot{x}_{n+1}$。然后从 Newmark 关系式中恢复 $x_{n+1}$ 和 $\\dot{x}_{n+1}$。请明确写出通过这些步骤得到的关于 $\\ddot{x}_{n+1}$ 的（标量）线性代数方程，该方程应以 $t_n$ 时刻的已知量和预测值为变量。\n  c) 可选地，您之后可以使用第 $2)$ 项中的离散界面关系式计算 $p_{n+1}$。\n\n4) 初始条件和单位：\n- 使用初始位移 $x(0)=x_0$（单位米），初始速度 $\\dot{x}(0)=0$（单位米/秒），并通过在 $t=0$ 时施加 $p_{\\text{out}}(0)=0$ 的耦合平衡条件来确定初始加速度 $\\ddot{x}(0)$。\n- 所有输入和输出必须使用国际单位制（SI）。所有要求的输出都以米为单位表示。\n\n5) 实现任务：\n- 为耦合的流固模型实现上述预测-校正时间积分器。您的实现必须是一个完整、可运行的程序。它应该使用均匀的时间步长 $\\Delta t$ 模拟到时间 $T$，并为每个测试用例返回最终位移 $x(T)$，单位为米，结果四舍五入到六位小数。\n\n6) 测试套件和要求的程序输出格式：\n- 使用以下四组测试用例，它们探测了不同的附加质量区域和数值条件。对于每个用例，定义 $m_f=\\rho_f A L$。\n  a) 用例 1（重结构，小时间步长）：\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=100$, $k_s=100000$, $c_s=100$, $c_f=50$, $\\Delta t=0.001$, $T=1.0$, $x_0=0.001$, $\\dot{x}_0=0$。\n  b) 用例 2（轻结构，小时间步长）：\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=1$, $k_s=100000$, $c_s=100$, $c_f=50$, $\\Delta t=0.001$, $T=1.0$, $x_0=0.001$, $\\dot{x}_0=0$。\n  c) 用例 3（结构无质量极限）：\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=0$, $k_s=100000$, $c_s=100$, $c_f=50$, $\\Delta t=0.001$, $T=1.0$, $x_0=0.001$, $\\dot{x}_0=0$。\n  d) 用例 4（大时间步长，轻阻尼，强附加质量）：\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=0.5$, $k_s=5000$, $c_s=0$, $c_f=0$, $\\Delta t=0.05$, $T=2.0$, $x_0=0.001$, $\\dot{x}_0=0$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是对应测试用例的最终位移 $x(T)$，单位为米，四舍五入到六位小数，顺序与上面列出的一致（例如，$[x_1,x_2,x_3,x_4]$）。\n\n您的推导必须基于基本原理，如 Newton 定律和标准的时间离散化公式，不得假设任何预先推导的 FSI 耦合关系。所有情景都应科学上合理且自洽。本问题描述中的变量符号、运算符和数字均为数学实体，因此需按此处所示以 LaTeX 表示法呈现。",
            "solution": "我们从耦合流固系统的第一性原理出发，推导出一个能够抑制附加质量不稳定性的离散、稳定的界面条件。\n\n控制方程。对于结构，包含线性阻尼和刚度的 Newton 第二定律得出\n$$ m_s\\,\\ddot{x}(t) + c_s\\,\\dot{x}(t) + k_s\\,x(t) = A\\,p(t). \\quad (1) $$\n对于质量为 $m_f=\\rho_f A L$ 的流体段塞，其控制体的一维动量平衡给出\n$$ m_f\\,\\ddot{x}(t) = -A\\left(p(t)-p_{\\text{out}}(t)\\right) - c_f\\,\\dot{x}(t). \\quad (2) $$\n界面运动学要求结构和流体在界面处共享相同的位移 $x(t)$、速度 $\\dot{x}(t)$ 和加速度 $\\ddot{x}(t)$。\n\n离散界面加速度连续性和 Robin 压力关系。我们现在在时间区间 $[t_n,t_{n+1}]$ 上，使用时间步长 $\\Delta t$ 的后向欧拉法对动量项进行离散化：\n$$ m_f \\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t} = -A\\left(p_{n+1}-p_{\\text{out},n+1}\\right) - c_f\\,\\dot{x}_{n+1}. \\quad (3) $$\n根据后向欧拉法下离散加速度的定义，\n$$ \\ddot{x}_{n+1} = \\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t}. \\quad (4) $$\n将方程 $(4)$ 代入 $(3)$ 得到\n$$ m_f \\ddot{x}_{n+1} = -A\\left(p_{n+1}-p_{\\text{out},n+1}\\right) - c_f\\,\\dot{x}_{n+1}. \\quad (5) $$\n对方程 $(5)$ 求解界面压力 $p_{n+1}$，得到离散的 Robin 型界面条件：\n$$ p_{n+1} = p_{\\text{out},n+1} - \\frac{m_f}{A}\\,\\ddot{x}_{n+1} - \\frac{c_f}{A}\\,\\dot{x}_{n+1}. \\quad (6) $$\n这就是以压力条件形式表达的离散界面加速度连续性条件：它强制要求新时刻的流体动量平衡使用与结构相同的界面加速度和速度，从而避免了子系统之间的显式时间延迟。关系式 $(6)$ 是在分区方案中抑制附加质量不稳定性的关键；它在时间层 $n+1$ 将压力与结构运动学隐式地耦合起来。\n\n结构的时间离散化和耦合消除。我们使用参数为 $\\beta=\\tfrac{1}{4}$ 和 $\\gamma=\\tfrac{1}{2}$ 的 Newmark 族方法。标准的 Newmark 运动学更新公式为\n$$ x_{n+1} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}, \\quad (7) $$\n$$ \\dot{x}_{n+1} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}. \\quad (8) $$\n定义运动学预测值\n$$ x_{n+1}^{\\text{pred}} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n, \\quad (9) $$\n$$ \\dot{x}_{n+1}^{\\text{pred}} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n. \\quad (10) $$\n则校正形式为\n$$ x_{n+1} = x_{n+1}^{\\text{pred}} + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}, \\quad (11) $$\n$$ \\dot{x}_{n+1} = \\dot{x}_{n+1}^{\\text{pred}} + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}. \\quad (12) $$\n\n在时刻 $t_{n+1}$，结构平衡方程 $(1)$ 写为\n$$ m_s\\,\\ddot{x}_{n+1} + c_s\\,\\dot{x}_{n+1} + k_s\\,x_{n+1} = A\\,p_{n+1}. \\quad (13) $$\n将 $(6)$ 代入 $p_{n+1}$，并将 $(11)$–$(12)$ 代入 $x_{n+1}$ 和 $\\dot{x}_{n+1}$。在 $p_{\\text{out},n+1}$ 为给定的情况下，这将得到一个关于未知数 $\\ddot{x}_{n+1}$ 的单一标量线性方程：\n$$ \\big(m_s + m_f\\big)\\ddot{x}_{n+1} + \\big(c_s + c_f\\big)\\left(\\dot{x}_{n+1}^{\\text{pred}} + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}\\right) + k_s\\left(x_{n+1}^{\\text{pred}} + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}\\right) = A\\,p_{\\text{out},n+1}. \\quad (14) $$\n将包含 $\\ddot{x}_{n+1}$ 的项收集到左侧，我们得到\n$$ \\left[\\big(m_s+m_f\\big) + \\gamma\\,\\Delta t\\,\\big(c_s+c_f\\big) + \\beta\\,\\Delta t^2\\,k_s\\right]\\ddot{x}_{n+1} = A\\,p_{\\text{out},n+1} - \\big(c_s+c_f\\big)\\dot{x}_{n+1}^{\\text{pred}} - k_s x_{n+1}^{\\text{pred}}. \\quad (15) $$\n这个显式公式表明，有效惯量增加了流体“附加质量” $m_f$，有效阻尼增加了 $c_f$。方程 $(15)$ 与 $(11)$–$(12)$ 一起完成了校正步骤。\n\n预测-校正循环。在每个时间步：\n\n- 预测步：通过方程 $(9)$–$(10)$ 计算 $x_{n+1}^{\\text{pred}}$ 和 $\\dot{x}_{n+1}^{\\text{pred}}$。\n\n- 校正步：从 $(15)$ 计算 $\\ddot{x}_{n+1}$，然后使用 $(11)$–$(12)$ 更新 $x_{n+1}$ 和 $\\dot{x}_{n+1}$。可选地，从 $(6)$ 恢复 $p_{n+1}$：\n  $$ p_{n+1} = p_{\\text{out},n+1} - \\frac{m_f}{A}\\,\\ddot{x}_{n+1} - \\frac{c_f}{A}\\,\\dot{x}_{n+1}. \\quad (16) $$\n\n初始条件。当 $x(0)=x_0$、$\\dot{x}(0)=0$ 且 $p_{\\text{out}}(0)=0$ 时，根据 $(1)$–$(2)$ 在 $t=0$ 的耦合平衡可得\n$$ \\big(m_s+m_f\\big)\\ddot{x}(0) + \\big(c_s+c_f\\big)\\dot{x}(0) + k_s x(0) = A\\,p_{\\text{out}}(0) = 0, $$\n因此\n$$ \\ddot{x}(0) = -\\frac{\\big(c_s+c_f\\big)\\dot{x}(0) + k_s x(0)}{m_s+m_f}. \\quad (17) $$\n\n稳定性 和附加质量不稳定性的抑制。离散界面关系式 $(6)$ 强制要求新时刻的流体压力取决于进入结构校正步的相同界面加速度和速度。这种时间上的隐式耦合防止了显式时间延迟，而这种延迟在轻结构/重流体工况下会导致分区 FSI 方案中经典的附加质量不稳定性。Newmark 平均加速度法的选择（$\\beta=\\tfrac{1}{4}$，$\\gamma=\\tfrac{1}{2}$）对于线性问题是无条件稳定的；与 $(6)$ 结合，即使对于 $m_s \\to 0$ 的情况，也能产生一个鲁棒的方案。\n\n测试套件和输出。对于每个指定的测试用例，我们计算最终位移 $x(T)$，单位为米，四舍五入到六位小数。程序将四个结果汇总成单行，格式为 $[x_1,x_2,x_3,x_4]$。\n\n实现细节。算法流程如下：\n- 对于每个用例，计算 $m_f=\\rho_f A L$ 并初始化 $x_0$、$\\dot{x}_0$，然后通过 $(17)$ 计算 $\\ddot{x}_0$。\n- 对于 $n=0,\\dots,N-1$，其中 $N=\\text{round}\\left(\\frac{T}{\\Delta t}\\right)$:\n  - 计算预测值 $(9)$–$(10)$。\n  - 在 $p_{\\text{out},n+1}=0$ 的条件下，由 $(15)$ 计算 $\\ddot{x}_{n+1}$。\n  - 通过 $(11)$–$(12)$ 更新 $(x_{n+1},\\dot{x}_{n+1})$。\n- 返回 $x_N$。\n\n推导中的所有变量和数字都以 LaTeX 格式给出。最终的代码逐字实现上述方程，并生成所要求的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_case(rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0, p_out_func=None):\n    \"\"\"\n    Simulate the coupled 1D fluid-structure system using:\n    - Newmark (beta=1/4, gamma=1/2) for the structure kinematics\n    - Discrete acceleration-continuity-based Robin interface condition\n      p_{n+1} = p_out - (m_f/A) * a_{n+1} - (c_f/A) * v_{n+1}\n    Returns final displacement x(T).\n    \"\"\"\n    beta = 1/4\n    gamma = 1/2\n\n    # Derived fluid mass\n    m_f = rho_f * A * L\n\n    # Time steps\n    n_steps = int(round(T / dt))\n\n    # Initial conditions\n    x_n = x0\n    v_n = v0\n    # p_out at initial time\n    p_out0 = 0.0 if p_out_func is None else p_out_func(0.0)\n    # Coupled initial acceleration from (m_s + m_f) * a0 + (c_s + c_f) * v0 + k_s * x0 = A * p_out0\n    a_n = (A * p_out0 - (c_s + c_f) * v_n - k_s * x_n) / (m_s + m_f)\n\n    # Time stepping\n    for i in range(n_steps):\n        t_np1 = (i + 1) * dt\n        p_out_np1 = 0.0 if p_out_func is None else p_out_func(t_np1)\n\n        # Predictors\n        x_pred = x_n + dt * v_n + dt * dt * (0.5 - beta) * a_n\n        v_pred = v_n + dt * (1 - gamma) * a_n\n\n        # Effective coefficients for acceleration solve:\n        # [(m_s + m_f) + gamma*dt*(c_s + c_f) + beta*dt^2*k_s] * a_{n+1} = A*p_out_np1 - (c_s + c_f)*v_pred - k_s*x_pred\n        lhs = (m_s + m_f) + gamma * dt * (c_s + c_f) + beta * dt * dt * k_s\n        rhs = A * p_out_np1 - (c_s + c_f) * v_pred - k_s * x_pred\n\n        a_np1 = rhs / lhs\n\n        # Corrector updates\n        v_np1 = v_pred + gamma * dt * a_np1\n        x_np1 = x_pred + beta * dt * dt * a_np1\n\n        # Advance state\n        x_n, v_n, a_n = x_np1, v_np1, a_np1\n\n    return x_n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0)\n    test_cases = [\n        # Case 1: heavy structure, fine dt\n        (1000.0, 0.01, 1.0, 100.0, 100000.0, 100.0, 50.0, 0.001, 1.0, 0.001, 0.0),\n        # Case 2: light structure, fine dt\n        (1000.0, 0.01, 1.0, 1.0, 100000.0, 100.0, 50.0, 0.001, 1.0, 0.001, 0.0),\n        # Case 3: massless structural limit\n        (1000.0, 0.01, 1.0, 0.0, 100000.0, 100.0, 50.0, 0.001, 1.0, 0.001, 0.0),\n        # Case 4: coarse dt, lightly damped, strong added mass\n        (1000.0, 0.01, 1.0, 0.5, 5000.0, 0.0, 0.0, 0.05, 2.0, 0.001, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0 = case\n        xT = simulate_case(rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0)\n        results.append(xT)\n\n    # Final print statement in the exact required format, rounded to six decimal places.\n    print(\"[\" + \",\".join(f\"{val:.6f}\" for val in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}