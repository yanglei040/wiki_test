{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will analyze a scenario common in many electronic and energy storage devices: a layered material stack. This practice focuses on applying the fundamental principles of current flow and heat generation to a heterogeneous system under steady-state direct current (DC) conditions. By determining how Joule heat is distributed between layers with different electrical and thermal properties, you will develop a core skill in identifying potential hotspots and understanding the electro-thermal behavior of composite structures .",
            "id": "3505292",
            "problem": "A two-layer planar stack occupies the region $0 \\le z \\le t_{1}+t_{2}$ with cross-sectional area $A$ in the $x$-$y$ plane. Layer $1$ occupies $0 \\le z \\le t_{1}$ and layer $2$ occupies $t_{1} \\le z \\le t_{1}+t_{2}$. Each layer is an electrically and thermally anisotropic homogeneous material with principal axes aligned to the coordinate axes. The electrical conductivity tensor in layer $i \\in \\{1,2\\}$ is $\\boldsymbol{\\sigma}_{i}=\\mathrm{diag}(\\sigma_{\\parallel,i},\\sigma_{\\parallel,i},\\sigma_{\\perp,i})$, and the thermal conductivity tensor is $\\mathbf{K}_{i}=\\mathrm{diag}(k_{\\parallel,i},k_{\\parallel,i},k_{\\perp,i})$. The stack is contacted by perfectly conducting electrodes at $z=0$ and $z=t_{1}+t_{2}$. A steady Direct Current (DC) of prescribed total magnitude $I$ is injected uniformly through the top electrode at $z=0$ and collected at the bottom electrode at $z=t_{1}+t_{2}$. Lateral heat and charge transport are negligible so that a one-dimensional description along $z$ is appropriate. The lateral sides are adiabatic and electrically insulating.\n\nStarting only from the charge conservation law $\\nabla \\cdot \\mathbf{J}=0$, Ohm’s law $\\mathbf{J}=\\boldsymbol{\\sigma}\\,\\mathbf{E}$, the electrostatic relation $\\mathbf{E}=-\\nabla \\phi$, and the steady thermal energy balance without volumetric sources other than Joule heating, $\\nabla \\cdot (\\mathbf{K}\\,\\nabla T)+q=0$, where $q$ is the volumetric Joule heating density, perform the following:\n\n1. Derive a one-dimensional coupled electro-thermal model for this stack. Your model must consist of ordinary differential equations for the electric potential $\\phi(z)$ and the temperature $T(z)$ in each layer, along with physically consistent interface and boundary conditions, expressed in terms of the layer properties $\\sigma_{\\perp,i}$ and $k_{\\perp,i}$ and the imposed current $I$ and cross-sectional area $A$.\n\n2. Under the imposed current $I$, obtain expressions for the electric field component $E_{z}$ and the volumetric Joule heating density $q$ in each layer in terms of $I$, $A$, and the cross-plane conductivities $\\sigma_{\\perp,i}$.\n\n3. For the specific parameter values\n- $t_{1}=1.0\\times 10^{-5}\\,\\mathrm{m}$, $t_{2}=4.0\\times 10^{-5}\\,\\mathrm{m}$,\n- $\\sigma_{\\perp,1}=1.0\\times 10^{5}\\,\\mathrm{S/m}$, $\\sigma_{\\perp,2}=2.5\\times 10^{4}\\,\\mathrm{S/m}$,\n- $k_{\\perp,1}=5.0\\,\\mathrm{W/(m\\cdot K)}$, $k_{\\perp,2}=1.0\\,\\mathrm{W/(m\\cdot K)}$,\n- $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$, $I=5.00\\,\\mathrm{A}$,\ncompute the dimensionless fraction of the total Joule heat generation that is produced within layer $1$, defined as the ratio of the Joule power generated in layer $1$ to the total Joule power generated in both layers. Express your final answer as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Geometry**: A two-layer planar stack in the region $0 \\le z \\le t_{1}+t_{2}$.\n- Layer $1$: Occupies $0 \\le z \\le t_{1}$.\n- Layer $2$: Occupies $t_{1} \\le z \\le t_{1}+t_{2}$.\n- Cross-sectional area: $A$.\n- **Material Properties**: Each layer $i \\in \\{1,2\\}$ is homogeneous and anisotropic.\n- Electrical conductivity tensor: $\\boldsymbol{\\sigma}_{i}=\\mathrm{diag}(\\sigma_{\\parallel,i},\\sigma_{\\parallel,i},\\sigma_{\\perp,i})$.\n- Thermal conductivity tensor: $\\mathbf{K}_{i}=\\mathrm{diag}(k_{\\parallel,i},k_{\\parallel,i},k_{\\perp,i})$.\n- **Boundary/Driving Conditions**:\n- Perfectly conducting electrodes at $z=0$ and $z=t_{1}+t_{2}$.\n- A steady Direct Current (DC) of total magnitude $I$ is injected uniformly at $z=0$ and collected at $z=t_{1}+t_{2}$.\n- Lateral sides are adiabatic and electrically insulating.\n- **Simplifying Assumptions**: Lateral heat and charge transport are negligible, justifying a one-dimensional ($1$D) description along the $z$-axis.\n- **Governing Equations**:\n- Charge conservation: $\\nabla \\cdot \\mathbf{J}=0$.\n- Ohm’s law: $\\mathbf{J}=\\boldsymbol{\\sigma}\\,\\mathbf{E}$.\n- Electrostatic relation: $\\mathbf{E}=-\\nabla \\phi$.\n- Steady thermal energy balance: $\\nabla \\cdot (\\mathbf{K}\\,\\nabla T)+q=0$, where $q$ is the volumetric Joule heating density.\n- **Numerical values for part 3**:\n- $t_{1}=1.0\\times 10^{-5}\\,\\mathrm{m}$, $t_{2}=4.0\\times 10^{-5}\\,\\mathrm{m}$\n- $\\sigma_{\\perp,1}=1.0\\times 10^{5}\\,\\mathrm{S/m}$, $\\sigma_{\\perp,2}=2.5\\times 10^{4}\\,\\mathrm{S/m}$\n- $k_{\\perp,1}=5.0\\,\\mathrm{W/(m\\cdot K)}$, $k_{\\perp,2}=1.0\\,\\mathrm{W/(m\\cdot K)}$\n- $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$, $I=5.00\\,\\mathrm{A}$\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is based on the fundamental and well-established principles of electrostatics (Ohm's law, charge conservation) and heat transfer (Fourier's law, energy balance with Joule heating). This is a standard problem in coupled multiphysics. The setup is physically realistic.\n- **Well-Posed**: The problem is well-posed. The geometry, material properties, and boundary/driving conditions are specified, allowing for the derivation of a unique solution for the electric field, current density, and heat generation. While the thermal boundary conditions at $z=0$ and $z=t_1+t_2$ are not numerically specified, part 1 only requires the formulation of the model with general boundary conditions, and part 3 requests a ratio of heat generation, which is independent of these boundary conditions.\n- **Objective**: The problem is stated in clear, objective, and quantitative language. There are no subjective or ambiguous terms.\n- The problem is self-contained, consistent, and does not violate any of the invalidity criteria. The provided data are dimensionally and physically consistent. The assumption of $1$D transport is explicitly stated and justified.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n***\n\n### Solution\n\n**1. Derivation of the 1D Coupled Electro-Thermal Model**\n\nThe problem states that a one-dimensional description along the $z$-axis is appropriate. This implies that all fields and potentials vary only with $z$. The electric potential is $\\phi(z)$, the temperature is $T(z)$, the electric field is $\\mathbf{E} = E_z(z)\\hat{\\mathbf{z}}$, and the current density is $\\mathbf{J} = J_z(z)\\hat{\\mathbf{z}}$. The gradient operator simplifies to $\\nabla = \\hat{\\mathbf{z}}\\frac{d}{dz}$.\n\n**Electrical Model:**\nThe charge conservation law is $\\nabla \\cdot \\mathbf{J} = 0$. In $1$D, this becomes $\\frac{dJ_z}{dz}=0$. This implies that the current density $J_z$ is constant throughout the entire stack.\nThe total current $I$ is given as uniformly injected over the area $A$. Assuming the current flows in the positive $z$-direction (from $z=0$ to $z=t_1+t_2$), the current density is $J_z = I/A$.\n\nOhm's law, $\\mathbf{J}=\\boldsymbol{\\sigma}\\mathbf{E}$, and the electrostatic relation, $\\mathbf{E} = -\\nabla\\phi$, are combined. For the anisotropic material in a $1$D model, only the cross-plane components are relevant. In layer $i \\in \\{1, 2\\}$:\n$$J_z = \\sigma_{\\perp,i} E_{z,i} = -\\sigma_{\\perp,i} \\frac{d\\phi_i}{dz}$$\nSince $J_z$ is constant and $\\sigma_{\\perp,i}$ is constant within each layer, we have:\n$$\\frac{d\\phi_i}{dz} = -\\frac{J_z}{\\sigma_{\\perp,i}} = -\\frac{I}{A\\sigma_{\\perp,i}}$$\nThis is a first-order ODE for $\\phi_i(z)$. Differentiating with respect to $z$ yields the second-order ODE for the potential in each layer:\n$$\\frac{d^2\\phi_i}{dz^2} = 0$$\n\n**Thermal Model:**\nThe steady thermal energy balance is $\\nabla \\cdot (\\mathbf{K}\\,\\nabla T)+q=0$. In $1$D, the heat flux along the $z$-axis is $q_{h,z} = -k_{\\perp}(z) \\frac{dT}{dz}$. The energy balance becomes:\n$$\\frac{d}{dz}\\left(-k_{\\perp}(z)\\frac{dT}{dz}\\right) + q(z) = 0$$\nWithin each layer $i$, $k_{\\perp,i}$ is constant, so the equation is:\n$$-k_{\\perp,i}\\frac{d^2T_i}{dz^2} + q_i = 0$$\nThe volumetric Joule heating density $q$ is given by $q=\\mathbf{J}\\cdot\\mathbf{E} = J_z E_z$. Using $E_z=J_z/\\sigma_{\\perp}$, we find that $q$ is also constant within each layer:\n$$q_i = \\frac{J_z^2}{\\sigma_{\\perp,i}} = \\frac{I^2}{A^2\\sigma_{\\perp,i}}$$\nSo the ODE for temperature in layer $i$ is:\n$$\\frac{d^2T_i}{dz^2} = -\\frac{q_i}{k_{\\perp,i}} = -\\frac{I^2}{A^2\\sigma_{\\perp,i}k_{\\perp,i}}$$\n\n**Interface and Boundary Conditions:**\n- **Interface at $z=t_1$**:\n  - Continuity of electric potential: $\\phi_1(t_1) = \\phi_2(t_1)$.\n  - Continuity of normal current density: $J_{z,1}(t_1) = J_{z,2}(t_1)$, which is already satisfied by $J_z=\\text{constant}$. This is equivalent to $-\\sigma_{\\perp,1}\\frac{d\\phi_1}{dz}\\big|_{z=t_1} = -\\sigma_{\\perp,2}\\frac{d\\phi_2}{dz}\\big|_{z=t_1}$.\n  - Continuity of temperature: $T_1(t_1) = T_2(t_1)$.\n  - Continuity of normal heat flux: $-k_{\\perp,1}\\frac{dT_1}{dz}\\big|_{z=t_1} = -k_{\\perp,2}\\frac{dT_2}{dz}\\big|_{z=t_1}$.\n\n- **Boundary Conditions**:\n  - Electrical: The problem is current-driven. The constant current density is $J_z = I/A$. To find a unique potential profile, we can set a reference potential, for example, $\\phi_2(t_1+t_2) = 0$.\n  - Thermal: The problem does not specify the thermal conditions at the outer boundaries $z=0$ and $z=t_1+t_2$. General Dirichlet boundary conditions would be $T_1(0) = T_A$ and $T_2(t_1+t_2) = T_B$, where $T_A$ and $T_B$ are prescribed temperatures.\n\n**2. Expressions for $E_z$ and $q$ in each layer**\n\nFrom the analysis in part 1, the current density $J_z$ is constant throughout the stack and is equal to $I/A$.\nThe electric field component $E_{z,i}$ in layer $i$ is obtained from Ohm's law, $J_z = \\sigma_{\\perp,i} E_{z,i}$.\n$$E_{z,i} = \\frac{J_z}{\\sigma_{\\perp,i}} = \\frac{I}{A\\sigma_{\\perp,i}}$$\nThe volumetric Joule heating density $q_i$ in layer $i$ is $q_i = J_z E_{z,i}$.\n$$q_i = J_z \\left(\\frac{I}{A\\sigma_{\\perp,i}}\\right) = \\frac{I}{A} \\left(\\frac{I}{A\\sigma_{\\perp,i}}\\right) = \\frac{I^2}{A^2\\sigma_{\\perp,i}}$$\nThese expressions are valid for $i=1,2$.\n\n**3. Calculation of the Dimensionless Heat Generation Fraction**\n\nThe total Joule power, $P_i$, generated in layer $i$ is the integral of the volumetric heating density $q_i$ over the volume of the layer, $V_i = A t_i$. Since $q_i$ is uniform within the layer:\n$$P_i = q_i V_i = q_i A t_i$$\nSubstituting the expression for $q_i$ from part 2:\n$$P_i = \\left(\\frac{I^2}{A^2\\sigma_{\\perp,i}}\\right) A t_i = \\frac{I^2 t_i}{A\\sigma_{\\perp,i}}$$\nThis is equivalent to $P_i = I^2 R_i$, where $R_i = t_i/(A\\sigma_{\\perp,i})$ is the electrical resistance of layer $i$.\n\nThe total Joule power generated in the stack is $P_{total} = P_1 + P_2$.\n$$P_{total} = \\frac{I^2 t_1}{A\\sigma_{\\perp,1}} + \\frac{I^2 t_2}{A\\sigma_{\\perp,2}} = \\frac{I^2}{A} \\left( \\frac{t_1}{\\sigma_{\\perp,1}} + \\frac{t_2}{\\sigma_{\\perp,2}} \\right)$$\n\nThe dimensionless fraction of the total Joule heat generation that is produced within layer $1$, denoted as $f_1$, is the ratio $P_1/P_{total}$.\n$$f_1 = \\frac{P_1}{P_1 + P_2} = \\frac{\\frac{I^2 t_1}{A\\sigma_{\\perp,1}}}{\\frac{I^2 t_1}{A\\sigma_{\\perp,1}} + \\frac{I^2 t_2}{A\\sigma_{\\perp,2}}}$$\nThe common factor $I^2/A$ cancels out:\n$$f_1 = \\frac{\\frac{t_1}{\\sigma_{\\perp,1}}}{\\frac{t_1}{\\sigma_{\\perp,1}} + \\frac{t_2}{\\sigma_{\\perp,2}}}$$\nNow, we substitute the given numerical values:\n- $t_{1}=1.0\\times 10^{-5}\\,\\mathrm{m}$\n- $t_{2}=4.0\\times 10^{-5}\\,\\mathrm{m}$\n- $\\sigma_{\\perp,1}=1.0\\times 10^{5}\\,\\mathrm{S/m}$\n- $\\sigma_{\\perp,2}=2.5\\times 10^{4}\\,\\mathrm{S/m}$\n\nFirst, calculate the terms in the expression for $f_1$:\nThe term for layer $1$ is:\n$$\\frac{t_1}{\\sigma_{\\perp,1}} = \\frac{1.0\\times 10^{-5}\\,\\mathrm{m}}{1.0\\times 10^{5}\\,\\mathrm{S/m}} = 1.0 \\times 10^{-10}\\,\\mathrm{\\Omega\\cdot m^2}$$\nThe term for layer $2$ is:\n$$\\frac{t_2}{\\sigma_{\\perp,2}} = \\frac{4.0\\times 10^{-5}\\,\\mathrm{m}}{2.5\\times 10^{4}\\,\\mathrm{S/m}} = 1.6 \\times 10^{-9}\\,\\mathrm{\\Omega\\cdot m^2}$$\nNow, compute the fraction $f_1$:\n$$f_1 = \\frac{1.0 \\times 10^{-10}}{1.0 \\times 10^{-10} + 1.6 \\times 10^{-9}} = \\frac{1.0 \\times 10^{-10}}{1.0 \\times 10^{-10} + 16.0 \\times 10^{-10}} = \\frac{1.0 \\times 10^{-10}}{17.0 \\times 10^{-10}} = \\frac{1}{17}$$\nAs a decimal, this is:\n$$f_1 = \\frac{1}{17} \\approx 0.058823529...$$\nRounding to four significant figures, the result is $0.05882$.",
            "answer": "$$\n\\boxed{0.05882}\n$$"
        },
        {
            "introduction": "Having established the principles of heat generation in a DC context, we now turn to dynamic systems subjected to periodic heating, which is characteristic of alternating current (AC) applications. This exercise explores how a material thermally responds to a time-varying heat flux at its surface. You will derive the concepts of \"thermal waves,\" phase lag, and the critical thermal penetration depth, $\\delta_T$, which defines the region significantly affected by high-frequency heating . Understanding these concepts is essential for designing devices that operate under AC or pulsed power, as it allows engineers to manage and confine thermal effects.",
            "id": "3505242",
            "problem": "A semi-infinite, homogeneous, isotropic solid occupying $x \\ge 0$ has constant thermal conductivity $k$, density $\\rho$, specific heat capacity $c$, and thermal diffusivity $\\alpha = k/(\\rho c)$. For $t \\ge 0$, its surface at $x=0$ is subjected to a spatially uniform, time-harmonic heat flux originating from periodically modulated Joule heating in a thin resistive film intimately bonded to the surface. This imposes the boundary condition $-k\\,\\partial T/\\partial x\\,(0,t) = q_{0}\\cos(\\omega t)$, where $q_{0} > 0$ is the flux amplitude and $\\omega > 0$ is the angular frequency. Assume no heat losses by convection or radiation, and neglect any coupling of the temperature field back onto the electrical excitation beyond setting $q_{0}$ and $\\omega$.\n\nStarting from local energy conservation and Fourier’s law of heat conduction, and assuming that the long-time response is time-periodic at angular frequency $\\omega$, derive the steady periodic temperature field $T(x,t)$ for $x \\ge 0$. Define the thermal penetration depth $\\delta_{T}$ as the length scale over which the amplitude of the temperature oscillation decays by a factor of $\\exp(-1)$ with depth. Also define the phase lag $\\phi(x)$ at depth $x$ as the positive time-phase delay such that the temperature oscillation at depth $x$ can be written in the form $A(x)\\cos(\\omega t - \\phi(x))$ relative to the applied cosine heat flux at the surface.\n\nProvide your final expressions for $\\delta_{T}$ and $\\phi(x)$ as a single row vector, in terms of $\\alpha$, $\\omega$, and $x$ only. Do not include any numerical evaluation. Express angles in radians. Your final answer must be a single closed-form analytic expression.",
            "solution": "The problem requires the derivation of the steady periodic temperature field in a semi-infinite solid subjected to a time-harmonic surface heat flux, and from this field, to extract the thermal penetration depth and phase lag.\n\nThe physical process is governed by the one-dimensional heat diffusion equation, which arises from coupling local energy conservation with Fourier's law of heat conduction. For a homogeneous material with no internal heat sources, this equation is:\n$$ \\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\nwhere $T(x,t)$ is the temperature, $\\rho$ is the density, $c$ is the specific heat capacity, and $k$ is the thermal conductivity. Dividing by $\\rho c$ and introducing the thermal diffusivity $\\alpha = k/(\\rho c)$, we obtain the standard form of the heat equation:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{for } x \\ge 0, t \\ge 0 $$\n\nThe problem specifies the boundary conditions. At the surface $x=0$, a heat flux is imposed:\n$$ -k \\frac{\\partial T}{\\partial x}(0,t) = q_{0}\\cos(\\omega t) $$\nThe second boundary condition arises from the semi-infinite nature of the domain. The temperature disturbance caused by the surface heating must decay and remain bounded as $x \\to \\infty$:\n$$ |T(x,t)| < \\infty \\quad \\text{as } x \\to \\infty $$\n\nWe are looking for the long-time, steady periodic solution. This allows us to use the complex variable method to simplify the solution process. We define a complex temperature field $\\tilde{T}(x,t)$ such that the real temperature is its real part, $T(x,t) = \\text{Re}[\\tilde{T}(x,t)]$. The boundary condition at $x=0$ is then represented as the real part of a complex flux:\n$$ -k \\frac{\\partial \\tilde{T}}{\\partial x}(0,t) = q_{0}e^{i\\omega t} $$\nThe governing equation for $\\tilde{T}(x,t)$ is identical in form to the real equation:\n$$ \\frac{\\partial \\tilde{T}}{\\partial t} = \\alpha \\frac{\\partial^2 \\tilde{T}}{\\partial x^2} $$\n\nTo find the steady periodic solution, we assume a solution of the form:\n$$ \\tilde{T}(x,t) = \\theta(x)e^{i\\omega t} $$\nwhere $\\theta(x)$ is the complex amplitude of the temperature oscillation at depth $x$. Substituting this ansatz into the heat equation yields an ordinary differential equation (ODE) for $\\theta(x)$:\n$$ i\\omega \\theta(x)e^{i\\omega t} = \\alpha \\frac{d^2\\theta}{dx^2}e^{i\\omega t} $$\n$$ \\frac{d^2\\theta}{dx^2} - \\frac{i\\omega}{\\alpha}\\theta = 0 $$\nThis is a second-order, linear, homogeneous ODE with constant coefficients. Let $\\lambda^2 = \\frac{i\\omega}{\\alpha}$. The general solution is:\n$$ \\theta(x) = C_1 e^{\\lambda x} + C_2 e^{-\\lambda x} $$\nTo evaluate $\\lambda$, we find the square root of the complex number $i$. In polar form, $i = e^{i\\pi/2}$. Therefore, its principal square root is $\\sqrt{i} = e^{i\\pi/4} = \\cos(\\pi/4) + i\\sin(\\pi/4) = \\frac{1+i}{\\sqrt{2}}$.\nSo, $\\lambda$ becomes:\n$$ \\lambda = \\sqrt{\\frac{\\omega}{\\alpha}}\\sqrt{i} = \\sqrt{\\frac{\\omega}{\\alpha}}\\frac{1+i}{\\sqrt{2}} = \\sqrt{\\frac{\\omega}{2\\alpha}}(1+i) $$\nThe general solution for the complex amplitude is:\n$$ \\theta(x) = C_1 \\exp\\left(\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)x\\right) + C_2 \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)x\\right) $$\n\nWe now apply the boundary conditions to determine the constants $C_1$ and $C_2$.\nThe first term, $\\exp\\left(\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)x\\right) = \\exp\\left(\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right)\\exp\\left(i\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right)$, has a magnitude that grows exponentially with $x$. To satisfy the boundedness condition $|T(x,t)| < \\infty$ as $x \\to \\infty$, we must set its coefficient $C_1$ to zero.\n$$ C_1 = 0 $$\nThe solution for the complex amplitude simplifies to:\n$$ \\theta(x) = C_2 \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)x\\right) $$\nNext, we apply the flux boundary condition at $x=0$. First, we compute the derivative of $\\tilde{T}(x,t)$:\n$$ \\frac{\\partial \\tilde{T}}{\\partial x}(x,t) = \\frac{d\\theta}{dx}e^{i\\omega t} = C_2 \\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)\\right) \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)x\\right) e^{i\\omega t} $$\nAt $x=0$, this becomes:\n$$ \\frac{\\partial \\tilde{T}}{\\partial x}(0,t) = -C_2 \\sqrt{\\frac{\\omega}{2\\alpha}}(1+i) e^{i\\omega t} = -C_2 \\lambda e^{i\\omega t} $$\nSubstituting this into the complex boundary condition equation:\n$$ -k \\left(-C_2 \\lambda e^{i\\omega t}\\right) = q_0 e^{i\\omega t} $$\n$$ kC_2\\lambda = q_0 \\implies C_2 = \\frac{q_0}{k\\lambda} $$\nSubstituting the expression for $\\lambda$:\n$$ C_2 = \\frac{q_0}{k\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)} $$\nThe full complex temperature field is thus:\n$$ \\tilde{T}(x,t) = \\frac{q_0}{k\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)} \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}(1+i)x\\right) e^{i\\omega t} $$\nTo find the real temperature field $T(x,t)$, we take the real part of $\\tilde{T}(x,t)$. It is convenient to express all complex numbers in polar form.\n$$ 1+i = \\sqrt{2}e^{i\\pi/4} $$\nSo the constant $C_2$ is:\n$$ C_2 = \\frac{q_0}{k\\sqrt{\\frac{\\omega}{2\\alpha}}\\sqrt{2}e^{i\\pi/4}} = \\frac{q_0}{k\\sqrt{\\frac{2\\omega}{\\alpha}}}e^{-i\\pi/4} $$\nThe complex temperature becomes:\n$$ \\tilde{T}(x,t) = \\frac{q_0}{k\\sqrt{\\frac{2\\omega}{\\alpha}}}e^{-i\\pi/4} \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right) \\exp\\left(-i\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right) e^{i\\omega t} $$\nCombining the exponential terms:\n$$ \\tilde{T}(x,t) = \\left[\\frac{q_0}{k\\sqrt{\\frac{2\\omega}{\\alpha}}} \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right)\\right] \\exp\\left(i\\left(\\omega t - \\sqrt{\\frac{\\omega}{2\\alpha}}x - \\frac{\\pi}{4}\\right)\\right) $$\nThe real temperature field is the real part of this expression:\n$$ T(x,t) = \\text{Re}[\\tilde{T}(x,t)] = \\frac{q_0}{k\\sqrt{\\frac{2\\omega}{\\alpha}}} \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right) \\cos\\left(\\omega t - \\sqrt{\\frac{\\omega}{2\\alpha}}x - \\frac{\\pi}{4}\\right) $$\nThis expression has the form $A(x)\\cos(\\omega t - \\phi(x))$, where the amplitude $A(x)$ is:\n$$ A(x) = \\frac{q_0}{k\\sqrt{\\frac{2\\omega}{\\alpha}}} \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right) $$\nand the phase lag $\\phi(x)$ is:\n$$ \\phi(x) = \\sqrt{\\frac{\\omega}{2\\alpha}}x + \\frac{\\pi}{4} $$\n\nThe thermal penetration depth, $\\delta_T$, is defined as the depth over which the temperature amplitude $A(x)$ decays by a factor of $\\exp(-1)$. The amplitude decay is governed by the term $\\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}x\\right)$. We can write this as $\\exp(-x/\\delta_T)$. By comparison:\n$$ \\frac{1}{\\delta_T} = \\sqrt{\\frac{\\omega}{2\\alpha}} $$\nSolving for $\\delta_T$:\n$$ \\delta_T = \\sqrt{\\frac{2\\alpha}{\\omega}} $$\n\nThe phase lag $\\phi(x)$ has already been identified from the argument of the cosine function. It represents the phase delay of the temperature oscillation at depth $x$ relative to the driving heat flux $\\cos(\\omega t)$ at the surface.\n$$ \\phi(x) = \\sqrt{\\frac{\\omega}{2\\alpha}}x + \\frac{\\pi}{4} $$\nThis shows a component that increases linearly with depth and a constant offset of $\\pi/4$ radians ($45^{\\circ}$) at the surface $x=0$.\n\nThe problem asks for the expressions for $\\delta_T$ and $\\phi(x)$. These are the derived expressions.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\sqrt{\\frac{2\\alpha}{\\omega}} & \\sqrt{\\frac{\\omega}{2\\alpha}}x + \\frac{\\pi}{4} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Our final practice bridges the gap between idealized models and real-world engineering by introducing computational methods to solve a complex electro-thermal problem. Real materials are rarely perfectly uniform; manufacturing variations or operational wear can lead to spatially dependent properties, creating non-obvious temperature profiles and hotspots. This problem challenges you to develop a numerical algorithm to calculate the temperature distribution in a conductor with spatially varying electrical conductivity . This exercise provides direct experience in translating fundamental physical laws into a robust computational tool, a cornerstone of modern multiphysics simulation.",
            "id": "3505229",
            "problem": "Consider a one-dimensional model of a lithium-ion (Li-ion) battery current collector foil of length $L$ bonded along its thickness to a porous electrode. We restrict attention to heat generated by electrical Joule heating within the foil and ignore chemical and convective effects in the electrode. The foil has constant cross-sectional area $A$, constant thermal conductivity $k$, and a spatially varying electrical conductivity $\\sigma(x)$ along the length due to manufacturing variability. A constant total current $I$ flows along the $x$-direction from $x=0$ to $x=L$. Both ends are maintained at specified temperatures, modeling isothermal tabs at the ends.\n\nStarting from the following fundamental bases:\n- Charge conservation in steady state (no accumulation), implying one-dimensional conservation of current density, $dJ_x/dx = 0$.\n- The constitutive relation between current density and electric field, $J_x = \\sigma(x)\\,E_x$, combined with the electrostatic relation $E_x = -d\\phi/dx$.\n- The definition of Joule heating, $\\dot{q}(x) = \\mathbf{J}\\cdot\\mathbf{E}$.\n- The steady-state heat conduction equation in one dimension for constant thermal conductivity, $-\\dfrac{d}{dx}\\left(k\\,\\dfrac{dT}{dx}\\right)=\\dot{q}(x)$.\n- Dirichlet boundary conditions $T(0)=T_{\\mathrm{left}}$ and $T(L)=T_{\\mathrm{right}}$.\n\nDerive, from first principles and without invoking pre-derived shortcut formulas, how to compute the temperature field $T(x)$ and the temperature gradient $dT/dx$ within the foil in terms of $I$, $A$, $k$, $\\sigma(x)$, and the boundary temperatures, using only the above foundational laws and definitions.\n\nYour program must implement a numerical method, applicable to arbitrary smooth $\\sigma(x)>0$, to compute for each specified test case:\n- The maximum temperature in the foil, $T_{\\max}$, in $\\mathrm{K}$.\n- The location of the maximum temperature, $x_{\\max}$, in $\\mathrm{m}$.\n- The temperature gradient at the left boundary, $\\left.\\dfrac{dT}{dx}\\right|_{x=0}$, in $\\mathrm{K/m}$.\n- The temperature gradient at the right boundary, $\\left.\\dfrac{dT}{dx}\\right|_{x=L}$, in $\\mathrm{K/m}$.\n\nAll outputs must be expressed in the International System of Units (SI). Report all floating-point results rounded to six decimal places.\n\nTest suite (four cases), each with a domain length $L$, cross-sectional area $A$, current $I$, thermal conductivity $k$, left and right temperatures $T_{\\mathrm{left}}$, $T_{\\mathrm{right}}$, and a spatially varying conductivity $\\sigma(x)$ as described. For each case, use the given parameters and definitions of $\\sigma(x)$:\n\n- Case $1$ (baseline, nearly uniform copper foil):\n  - $L = 0.1\\,\\mathrm{m}$, $A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$, $I = 10.0\\,\\mathrm{A}$, $k = 200.0\\,\\mathrm{W/(m\\,K)}$, $T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$, $T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$.\n  - $\\sigma(x) = \\sigma_0$ with $\\sigma_0 = 5.8\\times 10^{7}\\,\\mathrm{S/m}$.\n\n- Case $2$ (linear manufacturing gradient in conductivity):\n  - $L = 0.1\\,\\mathrm{m}$, $A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$, $I = 10.0\\,\\mathrm{A}$, $k = 200.0\\,\\mathrm{W/(m\\,K)}$, $T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$, $T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$.\n  - $\\sigma(x) = \\sigma_0 \\left(1 + \\alpha\\left(\\dfrac{2x}{L}-1\\right)\\right)$ with $\\sigma_0 = 5.8\\times 10^{7}\\,\\mathrm{S/m}$ and $\\alpha=0.2$.\n\n- Case $3$ (sinusoidal variability and lower thermal conductivity):\n  - $L = 0.1\\,\\mathrm{m}$, $A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$, $I = 15.0\\,\\mathrm{A}$, $k = 90.0\\,\\mathrm{W/(m\\,K)}$, $T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$, $T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$.\n  - $\\sigma(x) = \\sigma_0 \\left(1 + \\varepsilon \\sin\\left(\\dfrac{4\\pi x}{L}\\right)\\right)$ with $\\sigma_0 = 3.5\\times 10^{7}\\,\\mathrm{S/m}$ and $\\varepsilon=0.5$.\n\n- Case $4$ (localized conductivity defect modeled by a Gaussian reduction):\n  - $L = 0.05\\,\\mathrm{m}$, $A = 8.0\\times 10^{-6}\\,\\mathrm{m^2}$, $I = 8.0\\,\\mathrm{A}$, $k = 235.0\\,\\mathrm{W/(m\\,K)}$, $T_{\\mathrm{left}}=298.15\\,\\mathrm{K}$, $T_{\\mathrm{right}}=298.15\\,\\mathrm{K}$.\n  - $\\sigma(x) = \\dfrac{\\sigma_0}{1 + \\beta \\exp\\left(-\\dfrac{(x-x_0)^2}{2 w^2}\\right)}$ with $\\sigma_0 = 3.7\\times 10^{7}\\,\\mathrm{S/m}$, $\\beta=4.0$, $x_0 = \\dfrac{L}{2}$, and $w = 0.05L$.\n\nYour algorithm should be general and not rely on any closed-form primitive for $\\sigma(x)$. You may assume $\\sigma(x)$ is strictly positive and sufficiently smooth on $[0,L]$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case produces its own sublist in the order $[T_{\\max}, x_{\\max}, (dT/dx)|_{x=0}, (dT/dx)|_{x=L}]$. For example, the final output format must look like $[[v_{1,1},v_{1,2},v_{1,3},v_{1,4}],[v_{2,1},v_{2,2},v_{2,3},v_{2,4}],\\dots]$ with all values rounded to six decimal places.",
            "solution": "The problem requires the derivation of a method to compute the temperature distribution $T(x)$ in a one-dimensional foil subject to Joule heating, and its numerical implementation. The derivation will proceed from the provided fundamental principles.\n\n### Part 1: Derivation from First Principles\n\n**1. Heat Source Formulation**\n\nThe analysis begins by establishing the volumetric heat generation rate, $\\dot{q}(x)$, due to Joule heating.\n- **Charge Conservation:** In steady state, current is conserved. The problem states this as $\\dfrac{dJ_x}{dx} = 0$, where $J_x$ is the current density in the $x$-direction. This implies that $J_x$ is constant along the length of the foil.\n- **Current Density and Total Current:** The total current $I$ is related to the current density $J_x$ and the constant cross-sectional area $A$ by the relation $I = J_x A$. Thus, the constant current density is $J_x = \\dfrac{I}{A}$.\n- **Electric Field:** The constitutive relation (Ohm's Law) connects current density $J_x$ to the electric field $E_x$ via the spatially varying electrical conductivity $\\sigma(x)$: $J_x = \\sigma(x) E_x(x)$. Substituting the constant $J_x$, we can express the electric field as a function of position:\n$$E_x(x) = \\dfrac{J_x}{\\sigma(x)} = \\dfrac{I}{A \\sigma(x)}$$\n- **Joule Heating:** The volumetric heat generation rate, $\\dot{q}(x)$, is defined as the dot product of the current density vector and the electric field vector, $\\dot{q} = \\mathbf{J} \\cdot \\mathbf{E}$. In our one-dimensional case, this simplifies to $\\dot{q}(x) = J_x E_x(x)$. Substituting the expressions for $J_x$ and $E_x(x)$:\n$$\\dot{q}(x) = \\left(\\dfrac{I}{A}\\right) \\left(\\dfrac{I}{A \\sigma(x)}\\right) = \\dfrac{I^2}{A^2 \\sigma(x)}$$\nThis is the source term for the heat conduction equation.\n\n**2. Governing Equation for Temperature**\n\nThe steady-state heat conduction equation in one dimension with constant thermal conductivity $k$ and a heat source $\\dot{q}(x)$ is given as:\n$$-\\dfrac{d}{dx}\\left(k\\,\\dfrac{dT}{dx}\\right) = \\dot{q}(x)$$\nSince $k$ is constant, this becomes:\n$$-k \\dfrac{d^2T}{dx^2} = \\dot{q}(x)$$\nSubstituting the derived expression for $\\dot{q}(x)$, we obtain the governing second-order ordinary differential equation (ODE) for the temperature field $T(x)$:\n$$\\dfrac{d^2T}{dx^2} = -\\dfrac{I^2}{k A^2 \\sigma(x)}$$\nThis equation is subject to the Dirichlet boundary conditions $T(0) = T_{\\mathrm{left}}$ and $T(L) = T_{\\mathrm{right}}$. For convenience, we define a source function $S(x) = \\dfrac{I^2}{k A^2 \\sigma(x)}$, so the ODE is $\\dfrac{d^2T}{dx^2} = -S(x)$.\n\n**3. General Solution by Integration**\n\nWe solve the ODE by integrating twice with respect to $x$.\n- **First Integration:** Integrating $\\dfrac{d^2T}{dx^2}$ once gives the temperature gradient, $\\dfrac{dT}{dx}$:\n$$\\dfrac{dT}{dx}(x) = \\int_{0}^{x} (-S(\\xi)) d\\xi + C_1 = C_1 - \\int_{0}^{x} S(\\xi) d\\xi$$\nHere, $C_1$ is the constant of integration, which is equal to the temperature gradient at $x=0$, i.e., $C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0}$.\n\n- **Second Integration:** Integrating $\\dfrac{dT}{dx}(x)$ gives the temperature field, $T(x)$:\n$$T(x) = \\int_{0}^{x} \\left( C_1 - \\int_{0}^{\\eta} S(\\xi) d\\xi \\right) d\\eta + C_2 = C_2 + C_1 x - \\int_{0}^{x} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\nThe constant $C_2$ is determined by the boundary condition at $x=0$: $T(0) = C_2 = T_{\\mathrm{left}}$. Thus:\n$$T(x) = T_{\\mathrm{left}} + C_1 x - \\int_{0}^{x} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n\n- **Determining the Integration Constant $C_1$:** The constant $C_1$ is found by applying the second boundary condition at $x=L$:\n$$T(L) = T_{\\mathrm{right}} = T_{\\mathrm{left}} + C_1 L - \\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\nSolving for $C_1$:\n$$C_1 = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{1}{L} \\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\nThe double integral can be simplified using integration by parts, which yields $\\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta = \\int_{0}^{L} (L-x) S(x) dx$. Substituting this gives a single-integral expression for $C_1$:\n$$C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{1}{L} \\int_{0}^{L} (L-x) S(x) dx$$\nSubstituting back $S(x) = \\dfrac{I^2}{k A^2 \\sigma(x)}$:\n$$\\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{I^2}{k A^2 L} \\int_{0}^{L} \\dfrac{L-x}{\\sigma(x)} dx$$\n\n**4. Final Expressions for Calculation**\n\nWith $C_1$ determined, we have all the necessary components.\n- **Temperature Gradient at the Boundaries:**\n  - At $x=0$: This is simply $C_1$, as derived above.\n  - At $x=L$: We evaluate the gradient expression at $x=L$:\n  $$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = C_1 - \\int_{0}^{L} S(\\xi) d\\xi$$\n  Substituting the full expression for $C_1$ and simplifying leads to:\n  $$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} - \\dfrac{1}{L} \\int_{0}^{L} x S(x) dx = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} - \\dfrac{I^2}{k A^2 L} \\int_{0}^{L} \\dfrac{x}{\\sigma(x)} dx$$\n\n- **Maximum Temperature and its Location:**\nSince $T''(x) = -S(x) < 0$ (as $\\sigma(x)>0$ and all other parameters are positive), the temperature profile $T(x)$ is a strictly concave function. Its maximum on the interval $[0,L]$ occurs either at an interior point where $\\dfrac{dT}{dx}=0$, or at one of the boundaries.\nThe location of a potential interior maximum, $x_{\\max}$, is found by setting the gradient to zero:\n$$\\dfrac{dT}{dx}(x_{\\max}) = C_1 - \\int_{0}^{x_{\\max}} S(\\xi) d\\xi = 0 \\implies \\int_{0}^{x_{\\max}} S(\\xi) d\\xi = C_1$$\nThis is an implicit equation for $x_{\\max}$.\nThe algorithm to find the location $x_{\\max}$ and value $T_{\\max}$ is:\n1. Calculate $C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0}$ and $\\left.\\dfrac{dT}{dx}\\right|_{x=L}$.\n2. If $C_1 \\le 0$, the function is non-increasing. The maximum is at the left boundary: $x_{\\max}=0$, $T_{\\max}=T_{\\mathrm{left}}$.\n3. If $\\left.\\dfrac{dT}{dx}\\right|_{x=L} \\ge 0$, the function is non-decreasing. The maximum is at the right boundary: $x_{\\max}=L$, $T_{\\max}=T_{\\mathrm{right}}$.\n4. If $C_1 > 0$ and $\\left.\\dfrac{dT}{dx}\\right|_{x=L} < 0$, a unique interior maximum exists. The location $x_{\\max}$ is the root of the equation $\\int_{0}^{x} S(\\xi) d\\xi - C_1 = 0$ in the interval $(0,L)$.\n5. The maximum temperature $T_{\\max}$ is then $T(x_{\\max})$. The expression for $T(x)$ can be written as:\n$$T(x) = T_{\\mathrm{left}} + C_1 x - \\int_{0}^{x} (x-\\xi) S(\\xi) d\\xi$$\n$$T(x) = T_{\\mathrm{left}} + \\left(\\left.\\dfrac{dT}{dx}\\right|_{x=0}\\right) x - \\dfrac{I^2}{k A^2} \\int_{0}^{x} \\dfrac{x-\\xi}{\\sigma(\\xi)} d\\xi$$\n\n### Part 2: Numerical Algorithm Design\n\nThe derived analytical expressions involve integrals that, for an arbitrary $\\sigma(x)$, must be computed numerically. The algorithm proceeds as follows:\n\n1.  **Define Constants and Functions:** For each test case, define the physical constants ($L, A, I, k, T_{\\mathrm{left}}, T_{\\mathrm{right}}$) and the function $\\sigma(x)$. Pre-calculate the constant factor $C_S = \\dfrac{I^2}{k A^2}$.\n\n2.  **Calculate Boundary Gradients:**\n    - Compute the integral $I_1 = \\int_{0}^{L} \\dfrac{L-x}{\\sigma(x)} dx$ using a numerical quadrature method (e.g., `scipy.integrate.quad`).\n    - Calculate the gradient at the left boundary: $\\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{C_S}{L} I_1$.\n    - Compute the integral $I_2 = \\int_{0}^{L} \\dfrac{1}{\\sigma(x)} dx$ using numerical quadrature.\n    - Calculate the gradient at the right boundary: $\\left.\\dfrac{dT}{dx}\\right|_{x=L} = \\left.\\dfrac{dT}{dx}\\right|_{x=0} - C_S I_2$.\n\n3.  **Find Maximum Temperature and Location:**\n    - Examine the signs of the boundary gradients to determine if the maximum is at an endpoint, as described previously.\n    - If an interior maximum exists, solve for $x_{\\max}$ by finding the root of the function $f(x) = \\left(\\int_{0}^{x} \\dfrac{1}{\\sigma(\\xi)} d\\xi \\right) - \\dfrac{1}{C_S} \\left.\\dfrac{dT}{dx}\\right|_{x=0} = 0$. This can be done using a numerical root-finding algorithm (e.g., `scipy.optimize.brentq`) on the interval $(0,L)$. The integral within $f(x)$ is computed at each step using numerical quadrature.\n    - Once $x_{\\max}$ is found, calculate $T_{\\max} = T(x_{\\max})$ using the formula for $T(x)$. This requires computing one final integral $I_3 = \\int_{0}^{x_{\\max}} \\dfrac{x_{\\max}-\\xi}{\\sigma(\\xi)} d\\xi$ via numerical quadrature.\n\n4.  **Output Formatting:** Collate the four computed values ($T_{\\max}, x_{\\max}, \\left.\\dfrac{dT}{dx}\\right|_{x=0}, \\left.\\dfrac{dT}{dx}\\right|_{x=L}$), round them to six decimal places, and format them as specified. This process is repeated for each test case.\n\nThis methodology is general and relies on robust numerical library functions for integration and root-finding, making it applicable to any smooth, strictly positive conductivity function $\\sigma(x)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the electro-thermal problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: Baseline\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 10.0, \"k\": 200.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"],\n            \"sigma_params\": {\"sigma0\": 5.8e7}\n        },\n        # Case 2: Linear Gradient\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 10.0, \"k\": 200.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"] * (1 + p[\"alpha\"] * (2 * x / p[\"L\"] - 1)),\n            \"sigma_params\": {\"sigma0\": 5.8e7, \"alpha\": 0.2, \"L\": 0.1}\n        },\n        # Case 3: Sinusoidal Variability\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 15.0, \"k\": 90.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"] * (1 + p[\"epsilon\"] * np.sin(4 * np.pi * x / p[\"L\"])),\n            \"sigma_params\": {\"sigma0\": 3.5e7, \"epsilon\": 0.5, \"L\": 0.1}\n        },\n        # Case 4: Localized Defect\n        {\n            \"L\": 0.05, \"A\": 8.0e-6, \"I\": 8.0, \"k\": 235.0,\n            \"T_left\": 298.15, \"T_right\": 298.15,\n            \"sigma\": lambda x, p: p[\"sigma0\"] / (1 + p[\"beta\"] * np.exp(-(x - p[\"x0\"])**2 / (2 * p[\"w\"]**2))),\n            \"sigma_params\": {\n                \"sigma0\": 3.7e7, \"beta\": 4.0, \n                \"x0\": 0.05 / 2, \"w\": 0.05 * 0.05\n            }\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        all_results.append(result)\n\n    # Format the final output string as specified\n    str_cases = []\n    for case_res in all_results:\n        # Format each value to 6 decimal places\n        str_vals = [f\"{v:.6f}\" for v in case_res]\n        str_cases.append(f\"[{','.join(str_vals)}]\")\n    \n    print(f\"[{','.join(str_cases)}]\")\n\ndef process_case(params):\n    \"\"\"\n    Computes the required quantities for a single test case.\n    \"\"\"\n    L = params[\"L\"]\n    A = params[\"A\"]\n    I = params[\"I\"]\n    k = params[\"k\"]\n    T_left = params[\"T_left\"]\n    T_right = params[\"T_right\"]\n    \n    # Create a simple callable for sigma(x) for this case\n    sigma = lambda x: params[\"sigma\"](x, params[\"sigma_params\"])\n\n    # Constant factor for the source term S(x) = C_S / sigma(x)\n    C_S = I**2 / (k * A**2)\n\n    # Calculate grad_T_left (C1) = (T_right - T_left)/L + (C_S / L) * integral((L-x)/sigma(x), 0, L)\n    integrand_C1 = lambda x: (L - x) / sigma(x)\n    integral_val_C1, _ = quad(integrand_C1, 0, L, epsabs=1e-12, epsrel=1e-12)\n    grad_T_left = (T_right - T_left) / L + (C_S / L) * integral_val_C1\n\n    # Calculate grad_T_right = grad_T_left - C_S * integral(1/sigma(x), 0, L)\n    integrand_grad_R = lambda x: 1 / sigma(x)\n    integral_val_grad_R, _ = quad(integrand_grad_R, 0, L, epsabs=1e-12, epsrel=1e-12)\n    grad_T_right = grad_T_left - C_S * integral_val_grad_R\n    \n    # Determine the location and value of the maximum temperature\n    if grad_T_left = 0:\n        # Temperature is non-increasing, max is at the left boundary.\n        x_max = 0.0\n        T_max = T_left\n    elif grad_T_right >= 0:\n        # Temperature is non-decreasing, max is at the right boundary.\n        x_max = L\n        T_max = T_right\n    else:\n        # An interior maximum exists. Find its location x_max by solving a root problem.\n        # We need to find x where integral(S(xi), 0, x) = grad_T_left.\n        # This is equivalent to finding the root of:\n        # integral(1/sigma(xi), 0, x) - grad_T_left / C_S = 0\n        target_integral_val = grad_T_left / C_S\n        \n        def root_func(x):\n            val, _ = quad(lambda xi: 1 / sigma(xi), 0, x, epsabs=1e-12, epsrel=1e-12)\n            return val - target_integral_val\n\n        # Find the root x_max in the interval (0, L).\n        # brentq is a robust choice as we have a bracketed root.\n        x_max = brentq(root_func, 0, L)\n\n        # Calculate T_max = T(x_max) using the derived formula:\n        # T(x) = T_left + grad_T_left * x - C_S * integral((x-xi)/sigma(xi), 0, x)\n        integrand_T_max = lambda xi: (x_max - xi) / sigma(xi)\n        integral_val_T, _ = quad(integrand_T_max, 0, x_max, epsabs=1e-12, epsrel=1e-12)\n        T_max = T_left + grad_T_left * x_max - C_S * integral_val_T\n\n    return [T_max, x_max, grad_T_left, grad_T_right]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}