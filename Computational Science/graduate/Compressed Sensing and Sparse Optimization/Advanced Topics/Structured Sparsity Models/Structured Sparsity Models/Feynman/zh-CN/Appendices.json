{
    "hands_on_practices": [
        {
            "introduction": "组套索（Group Lasso）是结构化稀疏模型中的一个基本构建模块，它鼓励变量以预定义组的形式被选择或排除。要有效地求解和分析这类问题，理解其优化结构至关重要。本练习将通过具体计算，带你深入探讨组套索惩罚项的对偶范数及其在芬克尔对偶（Fenchel duality）框架下的应用，从而让你对检验解的最优性和理解对偶间隙有更扎实的把握。",
            "id": "3482827",
            "problem": "设 $\\mathcal{G}=\\{g_{1},g_{2}\\}$ 是索引集 $\\{1,2,3,4\\}$ 的一个划分，分为两个不相交的组 $g_{1}=\\{1,2\\}$ 和 $g_{2}=\\{3,4\\}$，其对应的正权重为 $w_{1}=1$ 和 $w_{2}=2$。定义在 $\\mathbb{R}^{4}$ 上的组套索惩罚项为\n$$\n\\Omega(x)\\;=\\;\\sum_{g\\in\\mathcal{G}} w_{g}\\,\\|x_{g}\\|_{2},\n$$\n及其对偶范数由支撑函数定义为\n$$\n\\Omega^{\\ast}(s)\\;=\\;\\sup\\{\\,s^{\\top}x:\\ \\Omega(x)\\leq 1\\,\\}\\;=\\;\\max_{g\\in\\mathcal{G}}\\frac{\\|s_{g}\\|_{2}}{w_{g}}.\n$$\n考虑凸复合优化问题\n$$\n\\min_{x\\in\\mathbb{R}^{4}}\\ \\frac{1}{2}\\|Ax-b\\|_{2}^{2}\\;+\\;\\lambda\\,\\Omega(x),\n$$\n其中 $A=I_{4}$，$b=\\begin{pmatrix}5\\\\0\\\\10\\\\0\\end{pmatrix}$，且 $\\lambda=1$。给定一个候选的原对偶对 $(\\tilde{x},\\tilde{u})$ 为\n$$\n\\tilde{x}=\\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix},\\qquad \\tilde{u}=A\\tilde{x}-b.\n$$\n任务：\n1) 仅使用对偶范数的支撑函数定义和欧几里得范数的基本性质，计算 $v=\\begin{pmatrix}3\\\\4\\\\6\\\\8\\end{pmatrix}$ 的 $\\Omega^{\\ast}(v)$。\n2) 从凸共轭和 Fenchel 对偶的定义出发，推导与给定原问题相关的对偶问题，并用 $\\Omega^{\\ast}(A^{\\top}u)$ 和 $\\lambda$ 明确地陈述相应的对偶可行性条件。验证 $\\tilde{u}$ 在此条件下是否是对偶可行的。\n3) 计算在 $\\tilde{x}$ 处的原目标函数值和在 $\\tilde{u}$ 处的对偶目标函数值，并计算对偶间隙，其定义为在 $\\tilde{x}$ 处的原目标函数值与在 $\\tilde{u}$ 处的对偶目标函数值之差。\n\n请将对偶间隙的值作为一个实数作为您的最终答案。无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观且自洽的。为给出严谨解法所需的所有必要定义和数据均已提供，不存在内部矛盾或逻辑缺陷。因此，我们可以开始求解。\n\n问题要求完成三项任务，最终要求计算给定原对偶对的对偶间隙。我们将按顺序完成每个任务。\n\n首先，我们总结一下给定的信息。组结构由索引集 $\\{1,2,3,4\\}$ 的划分 $\\mathcal{G}=\\{g_{1},g_{2}\\}$ 定义，其中 $g_{1}=\\{1,2\\}$ 且 $g_{2}=\\{3,4\\}$。对应的正权重为 $w_{1}=1$ 和 $w_{2}=2$。组套索惩罚项为 $\\Omega(x)\\;=\\;w_{1}\\|x_{g_{1}}\\|_{2} + w_{2}\\|x_{g_{2}}\\|_{2}$。其对偶范数由 $\\Omega^{\\ast}(s)\\;=\\;\\max\\left(\\frac{\\|s_{g_{1}}\\|_{2}}{w_{1}}, \\frac{\\|s_{g_{2}}\\|_{2}}{w_{2}}\\right)$ 给出。优化问题是\n$$\n\\min_{x\\in\\mathbb{R}^{4}}\\ P(x) = \\min_{x\\in\\mathbb{R}^{4}}\\ \\frac{1}{2}\\|Ax-b\\|_{2}^{2}\\;+\\;\\lambda\\,\\Omega(x)\n$$\n参数为 $A=I_{4}$（$4\\times 4$ 单位矩阵），$b=\\begin{pmatrix}5\\\\0\\\\10\\\\0\\end{pmatrix}$，且 $\\lambda=1$。候选的原点是 $\\tilde{x}=\\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix}$。\n\n**任务 1：计算 $\\Omega^{\\ast}(v)$**\n\n我们被要求计算向量 $v=\\begin{pmatrix}3\\\\4\\\\6\\\\8\\end{pmatrix}$ 的对偶范数 $\\Omega^{\\ast}(v)$。\n根据组划分 $\\mathcal{G}$，我们将向量 $v$ 分解为对应于组 $g_{1}$ 和 $g_{2}$ 的分量：\n$$\nv_{g_{1}} = \\begin{pmatrix}3\\\\4\\end{pmatrix}, \\qquad v_{g_{2}} = \\begin{pmatrix}6\\\\8\\end{pmatrix}.\n$$\n接下来，我们计算每个子向量的欧几里得范数（$\\ell_{2}$-范数）：\n$$\n\\|v_{g_{1}}\\|_{2} = \\sqrt{3^{2} + 4^{2}} = \\sqrt{9+16} = \\sqrt{25} = 5.\n$$\n$$\n\\|v_{g_{2}}\\|_{2} = \\sqrt{6^{2} + 8^{2}} = \\sqrt{36+64} = \\sqrt{100} = 10.\n$$\n使用对偶范数的定义 $\\Omega^{\\ast}(s) = \\max_{g\\in\\mathcal{G}}\\frac{\\|s_{g}\\|_{2}}{w_{g}}$ 以及权重 $w_{1}=1$ 和 $w_{2}=2$，我们有：\n$$\n\\Omega^{\\ast}(v) = \\max\\left(\\frac{\\|v_{g_{1}}\\|_{2}}{w_{1}}, \\frac{\\|v_{g_{2}}\\|_{2}}{w_{2}}\\right) = \\max\\left(\\frac{5}{1}, \\frac{10}{2}\\right) = \\max(5, 5) = 5.\n$$\n\n**任务 2：推导对偶问题并验证对偶可行性**\n\n原问题的形式为 $\\min_{x} f(Ax) + g(x)$，其中 $f(z) = \\frac{1}{2}\\|z-b\\|_{2}^{2}$ 且 $g(x) = \\lambda\\Omega(x)$。根据 Fenchel-Rockafellar 对偶理论，对偶问题由下式给出\n$$\n\\max_{u} -f^{\\ast}(u) - g^{\\ast}(-A^{\\top}u),\n$$\n其中 $f^{\\ast}$ 和 $g^{\\ast}$ 分别是 $f$ 和 $g$ 的凸共轭。\n\n首先，我们计算 $f(z) = \\frac{1}{2}\\|z-b\\|_{2}^{2}$ 的共轭：\n$$\nf^{\\ast}(u) = \\sup_{z\\in\\mathbb{R}^{4}} \\left(u^{\\top}z - \\frac{1}{2}\\|z-b\\|_{2}^{2}\\right).\n$$\n通过将关于 $z$ 的梯度设为零来找到最大化点：$u - (z-b) = 0$，这得到 $z = u+b$。将其代回表达式中，得到\n$$\nf^{\\ast}(u) = u^{\\top}(u+b) - \\frac{1}{2}\\|(u+b)-b\\|_{2}^{2} = \\|u\\|_{2}^{2} + u^{\\top}b - \\frac{1}{2}\\|u\\|_{2}^{2} = \\frac{1}{2}\\|u\\|_{2}^{2} + b^{\\top}u.\n$$\n接下来，我们计算 $g(x) = \\lambda\\Omega(x)$ 的共轭：\n$$\ng^{\\ast}(s) = \\sup_{x\\in\\mathbb{R}^{4}} \\left(s^{\\top}x - \\lambda\\Omega(x)\\right).\n$$\n根据凸共轭的定义和对偶范数的性质（$s^\\top x \\le \\Omega^*(s) \\Omega(x)$），我们分析两种情况：\n- 如果 $\\Omega^{\\ast}(s) > \\lambda$，那么我们可以找到一个 $x_0$ 使得 $s^\\top x_0 > \\lambda \\Omega(x_0)$。考虑 $x = c x_0$，$c \\to \\infty$，则 $s^\\top (c x_0) - \\lambda \\Omega(c x_0) = c(s^\\top x_0 - \\lambda \\Omega(x_0))$ 会趋向于 $+\\infty$。因此 $g^*(s) = +\\infty$。\n- 如果 $\\Omega^{\\ast}(s) \\le \\lambda$，那么对于所有 $x$ 都有 $s^\\top x \\le \\Omega^*(s)\\Omega(x) \\le \\lambda\\Omega(x)$。因此 $s^\\top x - \\lambda \\Omega(x) \\le 0$。这个表达式的最大值在 $x=0$ 时取到，为0。因此 $g^*(s) = 0$。\n综上所述，$g^*(s)$ 是集合 $\\{s \\in \\mathbb{R}^{4} \\mid \\Omega^{\\ast}(s) \\leq \\lambda\\}$ 的指示函数。\n\n将这些共轭代入对偶问题公式中，我们得到：\n$$\n\\max_{u} -\\left(\\frac{1}{2}\\|u\\|_{2}^{2} + b^{\\top}u\\right) - g^{\\ast}(-A^{\\top}u).\n$$\n项 $-g^{\\ast}(-A^{\\top}u)$ 施加了一个约束。为了使目标函数值为有限，我们必须有 $g^{\\ast}(-A^{\\top}u) = 0$，这意味着 $\\Omega^{\\ast}(-A^{\\top}u) \\leq \\lambda$。由于 $\\Omega^{\\ast}$ 是一个范数，$\\Omega^{\\ast}(-v) = \\Omega^{\\ast}(v)$，因此条件变为 $\\Omega^{\\ast}(A^{\\top}u) \\leq \\lambda$。\n因此对偶问题是\n$$\n\\max_{u\\in\\mathbb{R}^{4}} \\ D(u) = \\max_{u\\in\\mathbb{R}^{4}} \\ -\\frac{1}{2}\\|u\\|_{2}^{2} - b^{\\top}u \\quad \\text{subject to} \\quad \\Omega^{\\ast}(A^{\\top}u) \\leq \\lambda.\n$$\n对偶可行性条件明确为 $\\Omega^{\\ast}(A^{\\top}u) \\leq \\lambda$。\n\n现在，我们验证候选对偶变量 $\\tilde{u}$ 是否是对偶可行的。首先，我们根据其定义计算 $\\tilde{u}$：\n$$\n\\tilde{u} = A\\tilde{x} - b = I_{4}\\tilde{x} - b = \\tilde{x} - b = \\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix} - \\begin{pmatrix}5\\\\0\\\\10\\\\0\\end{pmatrix} = \\begin{pmatrix}0\\\\0\\\\-2\\\\0\\end{pmatrix}.\n$$\n我们必须检查是否 $\\Omega^{\\ast}(A^{\\top}\\tilde{u}) \\leq \\lambda$。由于 $A=I_{4}$ 且 $\\lambda=1$，这简化为 $\\Omega^{\\ast}(\\tilde{u}) \\leq 1$。\n我们将 $\\tilde{u}$ 分解为其组分量：\n$$\n\\tilde{u}_{g_{1}} = \\begin{pmatrix}0\\\\0\\end{pmatrix}, \\qquad \\tilde{u}_{g_{2}} = \\begin{pmatrix}-2\\\\0\\end{pmatrix}.\n$$\n相应的欧几里得范数是：\n$$\n\\|\\tilde{u}_{g_{1}}\\|_{2} = \\sqrt{0^{2}+0^{2}} = 0.\n$$\n$$\n\\|\\tilde{u}_{g_{2}}\\|_{2} = \\sqrt{(-2)^{2}+0^{2}} = \\sqrt{4} = 2.\n$$\n现在我们计算对偶范数 $\\Omega^{\\ast}(\\tilde{u})$：\n$$\n\\Omega^{\\ast}(\\tilde{u}) = \\max\\left(\\frac{\\|\\tilde{u}_{g_{1}}\\|_{2}}{w_{1}}, \\frac{\\|\\tilde{u}_{g_{2}}\\|_{2}}{w_{2}}\\right) = \\max\\left(\\frac{0}{1}, \\frac{2}{2}\\right) = \\max(0, 1) = 1.\n$$\n可行性条件是 $1 \\leq 1$，这是成立的。因此，$\\tilde{u}$ 是一个对偶可行点。\n\n**任务 3：计算原目标函数值、对偶目标函数值和对偶间隙**\n\n我们计算在 $x=\\tilde{x}$ 处的原目标函数 $P(x)$ 和在 $u=\\tilde{u}$ 处的对偶目标函数 $D(u)$。\n原目标函数值为 $P(\\tilde{x}) = \\frac{1}{2}\\|A\\tilde{x}-b\\|_{2}^{2} + \\lambda\\Omega(\\tilde{x})$。\n当 $A=I_{4}$ 且 $\\lambda=1$ 时：\n$$\nP(\\tilde{x}) = \\frac{1}{2}\\|\\tilde{x}-b\\|_{2}^{2} + \\Omega(\\tilde{x}).\n$$\n第一项是 $\\frac{1}{2}\\|\\tilde{u}\\|_{2}^{2} = \\frac{1}{2}(0^{2}+0^{2}+(-2)^{2}+0^{2}) = \\frac{4}{2} = 2$。\n对于第二项 $\\Omega(\\tilde{x})$，我们计算 $\\tilde{x}=\\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix}$ 的子向量的范数：\n$$\n\\tilde{x}_{g_{1}} = \\begin{pmatrix}5\\\\0\\end{pmatrix} \\implies \\|\\tilde{x}_{g_{1}}\\|_{2} = \\sqrt{5^{2}+0^{2}} = 5.\n$$\n$$\n\\tilde{x}_{g_{2}} = \\begin{pmatrix}8\\\\0\\end{pmatrix} \\implies \\|\\tilde{x}_{g_{2}}\\|_{2} = \\sqrt{8^{2}+0^{2}} = 8.\n$$\n所以，$\\Omega(\\tilde{x}) = w_{1}\\|\\tilde{x}_{g_{1}}\\|_{2} + w_{2}\\|\\tilde{x}_{g_{2}}\\|_{2} = (1)(5) + (2)(8) = 5+16 = 21$。\n原目标函数值为 $P(\\tilde{x}) = 2 + 21 = 23$。\n\n在可行点 $\\tilde{u}$ 处的对偶目标函数值为 $D(\\tilde{u}) = -\\frac{1}{2}\\|\\tilde{u}\\|_{2}^{2} - b^{\\top}\\tilde{u}$。\n第一项是 $-\\frac{1}{2}\\|\\tilde{u}\\|_{2}^{2} = -2$。\n第二项是 $-b^{\\top}\\tilde{u}$：\n$$\n-b^{\\top}\\tilde{u} = -\\begin{pmatrix}5  0  10  0\\end{pmatrix} \\begin{pmatrix}0\\\\0\\\\-2\\\\0\\end{pmatrix} = -((5)(0) + (0)(0) + (10)(-2) + (0)(0)) = -(-20) = 20.\n$$\n对偶目标函数值为 $D(\\tilde{u}) = -2 + 20 = 18$。\n\n最后，对偶间隙定义为在 $\\tilde{x}$ 处的原目标函数值与在 $\\tilde{u}$ 处的对偶目标函数值之差。\n$$\n\\text{对偶间隙} = P(\\tilde{x}) - D(\\tilde{u}) = 23 - 18 = 5.\n$$\n这个间隙是一个非负值，这是由弱对偶性保证的。由于间隙不为零，该对 $(\\tilde{x}, \\tilde{u})$ 不是最优的，尽管它是原对偶可行的。",
            "answer": "$$\n\\boxed{5}\n$$"
        },
        {
            "introduction": "许多实际应用中的稀疏模式具有重叠结构，例如在基因通路或视频处理中。处理这类问题的一种有效方法是使用潜变量（latent-variable）公式，它将问题分解为具有非重叠组的更简单形式。本练习将指导你对一个重叠组稀疏问题，执行一步核心的近端梯度（proximal-gradient）更新，让你亲身体验该算法的计算流程，并加深对块软阈值化（block soft-thresholding）算子的理解。",
            "id": "3482843",
            "problem": "考虑一个维度为 $n=5$ 的信号，其潜变量表述中使用了重叠组稀疏正则化，其中组为 $\\mathcal{G}_{1}=\\{1,2,3\\}$ 和 $\\mathcal{G}_{2}=\\{3,4,5\\}$。设潜变量为 $\\{v^{(1)},v^{(2)}\\}$，其中 $v^{(1)} \\in \\mathbb{R}^{3}$ 支撑于 $\\mathcal{G}_{1}$，$v^{(2)} \\in \\mathbb{R}^{3}$ 支撑于 $\\mathcal{G}_{2}$。记 $E_{1}:\\mathbb{R}^{3}\\to\\mathbb{R}^{5}$ 和 $E_{2}:\\mathbb{R}^{3}\\to\\mathbb{R}^{5}$ 为嵌入算子，它们分别将一个 $3$-维向量置于 $\\mathcal{G}_{1}$ 和 $\\mathcal{G}_{2}$ 的坐标位置上，其余位置为零。考虑关于潜变量的复合最小化问题\n$$\n\\min_{v^{(1)},v^{(2)}}\\; \\frac{1}{2}\\left\\|E_{1}v^{(1)}+E_{2}v^{(2)}-y\\right\\|_{2}^{2} \\;+\\; \\lambda\\left(\\|v^{(1)}\\|_{2}+\\|v^{(2)}\\|_{2}\\right),\n$$\n其中数据 $y \\in \\mathbb{R}^{5}$ 由 $y=\\begin{pmatrix}3 \\\\ 0 \\\\ 4 \\\\ 0 \\\\ 0\\end{pmatrix}$ 给出，正则化参数为 $\\lambda=2$。从 $v^{(1)}_{0}=0$ 和 $v^{(2)}_{0}=0$ 开始初始化。执行一步近端梯度法，步长为 $t=1/L$，其中 $L$ 是光滑项 $f(v^{(1)},v^{(2)})=\\frac{1}{2}\\|E_{1}v^{(1)}+E_{2}v^{(2)}-y\\|_{2}^{2}$ 梯度的利普希茨常数。设此单步更新后的潜变量为 $v^{(1)}_{1}$ 和 $v^{(2)}_{1}$，并定义相应的原始迭代变量 $x^{(1)}=E_{1}v^{(1)}_{1}+E_{2}v^{(2)}_{1}\\in\\mathbb{R}^{5}$。计算第三个坐标 $x^{(1)}_{3}$ 的值。以精确实数形式给出最终结果。无需四舍五入。",
            "solution": "用户希望找到经过一步近端梯度算法后信号估计的第三个坐标的值。该信号使用重叠组稀疏先验进行建模。\n\n问题是为以下最小化问题执行一步近端梯度法：\n$$\n\\min_{v^{(1)} \\in \\mathbb{R}^{3}, v^{(2)} \\in \\mathbb{R}^{3}} \\; \\frac{1}{2}\\left\\|E_{1}v^{(1)}+E_{2}v^{(2)}-y\\right\\|_{2}^{2} \\;+\\; \\lambda\\left(\\|v^{(1)}\\|_{2}+\\|v^{(2)}\\|_{2}\\right)\n$$\n该问题形式为 $\\min_{v} F(v) = f(v) + g(v)$，其中 $v = \\begin{pmatrix} v^{(1)} \\\\ v^{(2)} \\end{pmatrix} \\in \\mathbb{R}^{6}$。\n\n目标函数的光滑部分是 $f(v) = \\frac{1}{2}\\|E_{1}v^{(1)}+E_{2}v^{(2)}-y\\|_{2}^{2}$。\n非光滑部分是 $g(v) = \\lambda(\\|v^{(1)}\\|_{2}+\\|v^{(2)}\\|_{2})$。\n\n从步骤 $k$ 到 $k+1$ 的近端梯度更新法则是：\n$$\nv_{k+1} = \\text{prox}_{t g}(v_k - t \\nabla f(v_k))\n$$\n其中 $t$ 是步长，$\\text{prox}_{t g}(\\cdot)$ 是函数 $t g$ 的近端算子。我们需要从初始点 $v_0 = \\begin{pmatrix} v^{(1)}_{0} \\\\ v^{(2)}_{0} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始执行一步。\n\n首先，我们将算子 $E_1$ 和 $E_2$ 定义为矩阵。组 $\\mathcal{G}_{1}=\\{1,2,3\\}$ 意味着 $E_1$ 将 $\\mathbb{R}^3$ 中的向量映射到 $\\mathbb{R}^5$ 中向量的前三个坐标。组 $\\mathcal{G}_{2}=\\{3,4,5\\}$ 意味着 $E_2$ 将 $\\mathbb{R}^3$ 中的向量映射到 $\\mathbb{R}^5$ 中向量的第 $3, 4, 5$ 个坐标。\n表达式 $E_{1}v^{(1)}+E_{2}v^{(2)}$ 可以写成 $Ev$，其中 $E = \\begin{pmatrix} E_1  E_2 \\end{pmatrix}$ 是一个 $5 \\times 6$ 的矩阵，它将一个 $\\mathbb{R}^6$ 向量 $v = (v^{(1)T}, v^{(2)T})^T$ 映射到 $\\mathbb{R}^5$：\n$$\nE = \\begin{pmatrix}\n1  0  0  0  0  0 \\\\\n0  1  0  0  0  0 \\\\\n0  0  1  1  0  0 \\\\\n0  0  0  0  1  0 \\\\\n0  0  0  0  0  1\n\\end{pmatrix}\n$$\n光滑项是 $f(v) = \\frac{1}{2}\\|Ev - y\\|_{2}^{2}$。其梯度为 $\\nabla f(v) = E^T(Ev - y)$。\n我们在初始点 $v_0=0$ 处计算梯度：\n$$\n\\nabla f(v_0) = E^T(E \\cdot 0 - y) = -E^T y\n$$\n使用 $y=\\begin{pmatrix}3 \\\\ 0 \\\\ 4 \\\\ 0 \\\\ 0\\end{pmatrix}$，我们计算：\n$$\n\\nabla f(v_0) = - \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{pmatrix} \\begin{pmatrix}3 \\\\ 0 \\\\ 4 \\\\ 0 \\\\ 0\\end{pmatrix} = -\\begin{pmatrix}3 \\\\ 0 \\\\ 4 \\\\ 4 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-3 \\\\ 0 \\\\ -4 \\\\ -4 \\\\ 0 \\\\ 0\\end{pmatrix}\n$$\n这个梯度可以分解为对应于 $v^{(1)}$ 和 $v^{(2)}$ 的分量：\n$$\n\\nabla_{v^{(1)}} f(v_0) = \\begin{pmatrix}-3 \\\\ 0 \\\\ -4\\end{pmatrix}, \\quad \\nabla_{v^{(2)}} f(v_0) = \\begin{pmatrix}-4 \\\\ 0 \\\\ 0\\end{pmatrix}\n$$\n接下来，我们确定步长 $t = 1/L$，其中 $L$ 是 $\\nabla f(v)$ 的利普希茨常数。这是 Hessian 矩阵 $\\nabla^2 f(v) = E^T E$ 的最大特征值。\n$$\nE^T E = \\begin{pmatrix}\n1  0  0  0  0  0 \\\\\n0  1  0  0  0  0 \\\\\n0  0  1  1  0  0 \\\\\n0  0  1  1  0  0 \\\\\n0  0  0  0  1  0 \\\\\n0  0  0  0  0  1\n\\end{pmatrix}\n$$\n这个块对角矩阵的特征值可以通过检查其块来找到。特征值为来自左上角 $2 \\times 2$ 单位块的 $\\{1, 1\\}$，来自右下角 $2 \\times 2$ 单位块的 $\\{1, 1\\}$，以及中心 $2 \\times 2$ 块 $\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$ 的特征值。该块的特征方程为 $(1-\\mu)^2 - 1 = 0$，解得 $\\mu=0$ 和 $\\mu=2$。\n$E^T E$ 的特征值集合是 $\\{1, 1, 1, 1, 0, 2\\}$。最大特征值是 $\\lambda_{\\max}(E^T E) = 2$。\n因此，利普希茨常数为 $L=2$，步长为 $t = 1/L = 1/2$。\n\n近端梯度算法的第一步是：\n$$\nv_1 = \\text{prox}_{t g}(v_0 - t \\nabla f(v_0)) = \\text{prox}_{g/2}(0 - \\frac{1}{2} \\nabla f(v_0))\n$$\n设 $z = -\\frac{1}{2}\\nabla f(v_0) = \\frac{1}{2} E^T y = \\frac{1}{2}\\begin{pmatrix}3 \\\\ 0 \\\\ 4 \\\\ 4 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}3/2 \\\\ 0 \\\\ 2 \\\\ 2 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n我们将 $z$ 分解为 $z^{(1)}$ 和 $z^{(2)}$：\n$z^{(1)} = \\begin{pmatrix}3/2 \\\\ 0 \\\\ 2\\end{pmatrix}$ 和 $z^{(2)} = \\begin{pmatrix}2 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n\n非光滑项 $g(v) = \\lambda(\\|v^{(1)}\\|_2 + \\|v^{(2)}\\|_2)$ 在两个组之间是可分的。近端算子 $\\text{prox}_{t g}$ 可以分别应用于每个组分量。当 $\\lambda = 2$ 且 $t=1/2$ 时，近端算子的参数为 $t\\lambda = (1/2) \\times 2 = 1$。\n缩放 $\\ell_2$-范数（组 LASSO）的近端算子是块软阈值：\n$$\n\\text{prox}_{\\alpha \\|\\cdot\\|_2}(u) = \\left(1 - \\frac{\\alpha}{\\|u\\|_2}\\right)_+ u = \\max\\left(0, 1 - \\frac{\\alpha}{\\|u\\|_2}\\right) u\n$$\n对于第一组，$\\alpha=1$：\n$$\n\\|z^{(1)}\\|_2 = \\sqrt{\\left(\\frac{3}{2}\\right)^2 + 0^2 + 2^2} = \\sqrt{\\frac{9}{4} + 4} = \\sqrt{\\frac{25}{4}} = \\frac{5}{2}\n$$\n因为 $\\|z^{(1)}\\|_2 = 5/2  \\alpha=1$，所以结果非零。\n$$\nv^{(1)}_1 = \\left(1 - \\frac{1}{5/2}\\right) z^{(1)} = \\left(1 - \\frac{2}{5}\\right) z^{(1)} = \\frac{3}{5} \\begin{pmatrix}3/2 \\\\ 0 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}9/10 \\\\ 0 \\\\ 6/5\\end{pmatrix}\n$$\n对于第二组，$\\alpha=1$：\n$$\n\\|z^{(2)}\\|_2 = \\sqrt{2^2 + 0^2 + 0^2} = 2\n$$\n因为 $\\|z^{(2)}\\|_2 = 2  \\alpha=1$，所以结果非零。\n$$\nv^{(2)}_1 = \\left(1 - \\frac{1}{2}\\right) z^{(2)} = \\frac{1}{2} z^{(2)} = \\frac{1}{2} \\begin{pmatrix}2 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}1 \\\\ 0 \\\\ 0\\end{pmatrix}\n$$\n更新后的潜变量是 $v_1 = (v^{(1)T}_1, v^{(2)T}_1)^T = (9/10, 0, 6/5, 1, 0, 0)^T$。\n\n最后，我们计算原始迭代变量 $x^{(1)} = E_{1}v^{(1)}_{1}+E_{2}v^{(2)}_{1}$。$x^{(1)}$ 的坐标由下式给出：\n$x_1^{(1)} = (v_1^{(1)})_1 = 9/10$\n$x_2^{(1)} = (v_1^{(1)})_2 = 0$\n$x_3^{(1)} = (v_1^{(1)})_3 + (v_1^{(2)})_1 = 6/5 + 1$\n$x_4^{(1)} = (v_1^{(2)})_2 = 0$\n$x_5^{(1)} = (v_1^{(2)})_3 = 0$\n\n问题要求计算第三个坐标 $x^{(1)}_{3}$ 的值。\n$$\nx^{(1)}_3 = \\frac{6}{5} + 1 = \\frac{6}{5} + \\frac{5}{5} = \\frac{11}{5}\n$$",
            "answer": "$$\n\\boxed{\\frac{11}{5}}\n$$"
        },
        {
            "introduction": "全变分（Total Variation, TV）是另一个至关重要的结构化稀疏模型，特别适用于促进信号或图像的分段常数特性。在许多基于TV的算法中，其近端算子（proximal operator）的计算是一个关键的子程序。本练习不仅将引导你推导该算子的最优性条件（KKT条件），还将揭示一个优美且高效的几何解释——“拉紧绳”（taut-string）算法，它使得我们可以在线性时间内精确求解这个问题。",
            "id": "3482835",
            "problem": "考虑一维全变分正则化器作为一种典型的结构化稀疏模型。令 $D \\in \\mathbb{R}^{(n-1) \\times n}$ 表示一阶前向差分算子，定义为 $(D x)_{i} = x_{i+1} - x_{i}$，其中 $i \\in \\{1,\\dots,n-1\\}$。对于给定的观测值 $y \\in \\mathbb{R}^{n}$ 和正则化参数 $\\lambda  0$，考虑凸函数 $x \\mapsto \\lambda \\lVert D x \\rVert_{1}$ 在平方欧几里得度量下的近端算子，即：\n$$\n\\operatorname{prox}_{\\lambda \\lVert D \\cdot \\rVert_{1}}(y) \\in \\arg\\min_{x \\in \\mathbb{R}^{n}} \\left\\{ \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert D x \\rVert_{1} \\right\\}.\n$$\n任务：\n1) 仅从近端算子的定义和 $\\ell_{1}$ 范数的次微分出发，使用辅助变量 $u=Dx$ 的分裂方法来写出一个约束凸优化问题，并推导原始-对偶最优性的 Karush-Kuhn-Tucker (KKT) 条件。您的推导必须明确指出伴随算子 $D^{\\top}$ 和用 $\\ell_{\\infty}$ 范数表示的对偶可行域，并且必须表达连接 $x$、$y$ 和对偶变量的平稳性条件。\n2) 消去辅助变量，以获得耦合原始变量 $x$ 和对偶变量 $z \\in \\mathbb{R}^{n-1}$ 的充分必要最优性关系。然后，通过对平稳性条件逐分量求和，推导出将对偶变量刻画为残差部分和的累积和可行性约束。请仅使用 $y$、$x$ 和 $\\lambda$ 仔细表达这些约束，并证明它们与 $\\lVert D x \\rVert_{1}$ 的次微分关系等价。\n3) 解释拉紧弦解释：说明累积和约束如何在 $y$ 的累积和周围定义一个半径为 $\\lambda$ 的管道，最优的 $x$ 的累积和如何是连接端点且在该管道内的最短路径，并解释为何这种构造能导出一个具有线性时间复杂度 $\\mathcal{O}(n)$ 的算法。\n4) 对于 $n = 3$、$\\lambda = 1$ 和 $y = (0, 3, 0)^{\\top}$ 的实例，显式计算 $\\operatorname{prox}_{\\lambda \\lVert D \\cdot \\rVert_{1}}(y)$。请使用 $\\mathrm{pmatrix}$ 环境将您的最终答案表示为单个行向量。不需要四舍五入，也没有单位。",
            "solution": "该问题要求对一维全变分 (TV) 正则化器的近端算子进行多部分分析，并最终对一个给定实例进行显式计算。\n\n问题陈述在凸优化和信号处理领域具有科学依据。一维全变分正则化器、其近端算子、Karush-Kuhn-Tucker (KKT) 条件以及拉紧弦算法都是标准的、定义明确的概念。该问题是自包含的，所有必要的数据和定义都已提供。它是适定的，因为目标函数是一个严格凸函数和一个凸函数的和，这保证了存在唯一的最小化子。所有任务都是可形式化的，并导向一个唯一的、可验证的解。因此，该问题是有效的。\n\n**1) Karush-Kuhn-Tucker (KKT) 条件的推导**\n\n问题在于找到目标函数的最小化子：\n$$ \\arg\\min_{x \\in \\mathbb{R}^{n}} \\left\\{ \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert D x \\rVert_{1} \\right\\} $$\n我们引入一个辅助变量 $u \\in \\mathbb{R}^{n-1}$，使得 $u = Dx$。该问题可以重写为一个约束优化问题：\n$$ \\min_{x \\in \\mathbb{R}^{n}, u \\in \\mathbb{R}^{n-1}} \\left\\{ \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert u \\rVert_{1} \\right\\} \\quad \\text{subject to} \\quad Dx - u = 0 $$\n为了找到 KKT 条件，我们为等式约束引入一个对偶变量（拉格朗日乘子）$z \\in \\mathbb{R}^{n-1}$，从而构造拉格朗日函数：\n$$ \\mathcal{L}(x, u, z) = \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert u \\rVert_{1} + z^{\\top}(Dx - u) $$\n最优性的 KKT 条件是原始可行性、对偶可行性以及拉格朗日函数相对于原始变量的平稳性。\n\n首先，我们求伴随算子 $D^{\\top}$。对于任意 $x \\in \\mathbb{R}^{n}$ 和 $z \\in \\mathbb{R}^{n-1}$，伴随算子 $D^{\\top}$ 由关系 $\\langle z, Dx \\rangle = \\langle D^{\\top}z, x \\rangle$ 定义。\n$$ \\langle z, Dx \\rangle = \\sum_{i=1}^{n-1} z_i (Dx)_i = \\sum_{i=1}^{n-1} z_i (x_{i+1} - x_i) = \\sum_{i=1}^{n-1} z_i x_{i+1} - \\sum_{i=1}^{n-1} z_i x_i $$\n通过重新索引求和项以按 $x_i$ 分组，我们得到：\n$$ \\langle z, Dx \\rangle = -z_1 x_1 + \\sum_{i=2}^{n-1} (z_{i-1} - z_i)x_i + z_{n-1}x_n $$\n这揭示了 $D^{\\top}z$ 的分量：\n$$ (D^{\\top}z)_1 = -z_1 $$\n$$ (D^{\\top}z)_i = z_{i-1} - z_i \\quad \\text{for } i \\in \\{2, \\dots, n-1\\} $$\n$$ (D^{\\top}z)_n = z_{n-1} $$\n这对应于一个具有特定边界条件的后向差分算子。\n\nKKT 条件是：\ni. **关于 $x$ 的平稳性**：拉格朗日函数关于 $x$ 的梯度必须为零。\n$$ \\nabla_x \\mathcal{L}(x, u, z) = (x - y) + D^{\\top}z = 0 $$\n这给出了连接原始变量 $x$、数据 $y$ 和对偶变量 $z$ 的平稳性条件：\n$$ x - y + D^{\\top}z = 0 \\quad \\text{or} \\quad x + D^{\\top}z = y $$\nii. **关于 $u$ 的平稳性**：零向量必须在拉格朗日函数关于 $u$ 的次微分中。\n$$ 0 \\in \\partial_u \\mathcal{L}(x, u, z) = \\lambda \\partial \\lVert u \\rVert_{1} - z $$\n这得到了关系 $z \\in \\lambda \\partial \\lVert u \\rVert_{1}$。$\\ell_1$ 范数的次微分 $\\partial \\lVert u \\rVert_{1}$ 是向量 $v$ 的集合，其中如果 $u_i \\neq 0$ 则 $v_i = \\operatorname{sgn}(u_i)$，如果 $u_i = 0$ 则 $v_i \\in [-1, 1]$。这个条件可以写成 $\\lVert v \\rVert_{\\infty} \\le 1$。\n关系 $z \\in \\lambda \\partial \\lVert u \\rVert_{1}$ 意味着 $z/\\lambda \\in \\partial \\lVert u \\rVert_{1}$。因此，我们必须有 $\\lVert z/\\lambda \\rVert_{\\infty} \\le 1$，这简化为**对偶可行性条件**：\n$$ \\lVert z \\rVert_{\\infty} \\le \\lambda $$\niii. **原始可行性**：原始约束必须成立：\n$$ Dx - u = 0 $$\n\n总结来说，KKT 条件包括：\n- 原始可行性：$u = Dx$\n- 对偶可行性：$\\lVert z \\rVert_{\\infty} \\le \\lambda$\n- 平稳性：$x - y + D^{\\top}z = 0$\n- 互补松弛性（嵌入在关于 $u$ 的平稳性条件中）：对所有 $i$ 有 $z_i u_i = \\lambda |u_i|$，这意味着如果 $|z_i|  \\lambda$，则 $u_i = (Dx)_i = 0$。\n\n**2) 累积和可行性约束的推导**\n\n我们消去辅助变量 $u$，并使用耦合 $x$ 和 $z$ 的关系。主要条件是 $y - x = D^{\\top}z$ 和 $\\lVert z \\rVert_{\\infty} \\le \\lambda$。让我们逐分量写出平稳性条件：\n$$ y_1 - x_1 = -z_1 $$\n$$ y_i - x_i = z_{i-1} - z_i \\quad \\text{for } i \\in \\{2, \\dots, n-1\\} $$\n$$ y_n - x_n = z_{n-1} $$\n现在，我们对前 $k$ 个方程求和，其中 $k \\in \\{1, \\dots, n-1\\}$：\n对于 $k=1$：$\\sum_{i=1}^{1} (y_i - x_i) = y_1 - x_1 = -z_1$。\n对于 $k=2$：$\\sum_{i=1}^{2} (y_i - x_i) = (y_1 - x_1) + (y_2 - x_2) = -z_1 + (z_1 - z_2) = -z_2$。\n通过归纳法，对于任意 $k \\in \\{1, \\dots, n-1\\}$：\n$$ \\sum_{i=1}^{k} (y_i - x_i) = -z_k $$\n对偶可行性条件 $\\lVert z \\rVert_{\\infty} \\le \\lambda$ 意味着对所有 $k \\in \\{1, \\dots, n-1\\}$ 都有 $|z_k| \\le \\lambda$。代入 $z_k$ 的表达式，我们得到累积和约束：\n$$ \\left| \\sum_{i=1}^{k} (y_i - x_i) \\right| \\le \\lambda \\quad \\text{for } k \\in \\{1, \\dots, n-1\\} $$\n此外，对平稳性条件的所有 $n$ 个分量求和可得：\n$$ \\sum_{i=1}^{n} (y_i - x_i) = -z_1 + \\sum_{i=2}^{n-1} (z_{i-1} - z_i) + z_{n-1} = 0 $$\n这个和是伸缩和，结果为零。这意味着最优解 $x$ 的总和（或均值）等于观测值 $y$ 的总和：$\\sum_{i=1}^n x_i = \\sum_{i=1}^n y_i$。\n\n这些充分必要的最优性关系与原问题的次微分关系是等价的。对于 $\\min_x F(x) = \\frac{1}{2}\\lVert x - y \\rVert_2^2 + \\lambda \\lVert Dx \\rVert_1$ 的最优性条件是 $0 \\in \\partial F(x)$。\n使用次微分的求和法则和链式法则：\n$$ 0 \\in \\nabla \\left(\\frac{1}{2}\\lVert x-y \\rVert_2^2\\right) + \\partial(\\lambda \\lVert Dx \\rVert_1) = (x-y) + \\lambda D^{\\top} (\\partial \\lVert Dx \\rVert_1) $$\n这意味着存在一个向量 $v \\in \\partial \\lVert Dx \\rVert_1$ 使得 $y - x = \\lambda D^{\\top}v$。通过将对偶变量定义为 $z = \\lambda v$，我们得到 $y - x = D^{\\top}z$。条件 $v \\in \\partial \\lVert Dx \\rVert_1$ 意味着 $\\lVert v \\rVert_{\\infty} \\le 1$，这等价于 $\\lVert z / \\lambda \\rVert_{\\infty} \\le 1$，即 $\\lVert z \\rVert_{\\infty} \\le \\lambda$。我们的推导精确地表明，这个次微分包含关系与累积和约束集是等价的。\n\n**3) 拉紧弦解释**\n\n累积和约束提供了一个强大的几何解释。让我们定义观测值 $y$ 和解 $x$ 的累积和，分别为 $Y_k = \\sum_{i=1}^k y_i$ 和 $X_k = \\sum_{i=1}^k x_i$，其中 $k \\in \\{1, \\dots, n\\}$，且 $Y_0 = X_0 = 0$。\n在第 2 部分中推导的约束可以用这些累积和重写：\n1. 对 $k \\in \\{1, \\dots, n-1\\}$，有 $|\\sum_{i=1}^k (y_i - x_i)| = |Y_k - X_k| \\le \\lambda$。这等价于 $Y_k - \\lambda \\le X_k \\le Y_k + \\lambda$。\n2. $\\sum_{i=1}^n (y_i - x_i) = Y_n - X_n = 0$，这意味着 $X_n = Y_n$。\n\n这些条件描述了一个几何问题：\n- 解的累积和路径，由点集 $\\{(k, X_k)\\}_{k=0}^n$ 定义，必须从 $(0,0)$ 开始，到 $(n, Y_n)$ 结束。\n- 对于所有中间点 $k \\in \\{1, \\dots, n-1\\}$，$X_k$ 的值必须位于围绕 $y$ 的累积和 $Y_k$ 的一个**半径为 $\\lambda$ 的管道**内。该管道的边界由路径 $\\{(k, Y_k - \\lambda)\\}_{k=0}^n$ 和 $\\{(k, Y_k + \\lambda)\\}_{k=0}^n$ 给出。\n\n最优解 $x$ 对应于一条在管道内保持“最平坦”或“最规则”的累积和路径 $X$。这对应于**拉紧弦**的概念。如果将管道边界想象成物理约束，并将一根弦从 $(0,0)$ 穿过此管道拉到 $(n, Y_n)$，拉紧后得到的路径是一系列线段。这条路径正是最优的累积和路径 $X$。\n\n最优路径 $X$ 呈线性（即斜率恒定）的区域对应于解 $x$ 为常数的片段。这是互补松弛性的直接结果：如果在索引 $k$ 处路径 $X$ 严格位于管道内部（即 $|Y_k - X_k|  \\lambda$），则 $|z_k|  \\lambda$，这意味着 $(Dx)_k = x_{k+1} - x_k = 0$。路径 $X$ 仅在接触到管道边界的点上改变斜率。\n\n这种几何解释在算法上非常强大。寻找这条拉紧弦路径的问题等价于寻找管道边界的最大凸下界和最小凹上界。这个问题可以非常高效地解决。诸如池旁违者算法 (PAVA) 或其他专门的活动集方法等算法可以计算出解路径。这些算法平均处理每个点常数次，从而得到**$\\mathcal{O}(n)$ 的线性时间复杂度**。\n\n**4) 显式计算**\n\n给定 $n = 3$、$\\lambda = 1$ 和 $y = (0, 3, 0)^{\\top}$。我们需要计算 $x = \\operatorname{prox}_{\\lambda \\lVert D \\cdot \\rVert_{1}}(y)$。我们寻求 $x = (x_1, x_2, x_3)^{\\top}$ 以最小化：\n$$ \\frac{1}{2}(x_1^2 + (x_2-3)^2 + x_3^2) + 1 \\cdot (|x_2-x_1| + |x_3-x_2|) $$\n我们使用前面推导的 KKT 条件，以及对偶变量 $z = (z_1, z_2)^{\\top}$。\n平稳性条件 $y-x=D^\\top z$ 给出：\n$$ 0 - x_1 = -z_1 \\implies x_1 = z_1 $$\n$$ 3 - x_2 = z_1 - z_2 \\implies x_2 = 3 - z_1 + z_2 $$\n$$ 0 - x_3 = z_2 \\implies x_3 = -z_2 $$\n对偶可行性条件是 $\\lVert z \\rVert_{\\infty} \\le \\lambda = 1$，即 $|z_1| \\le 1$ 且 $|z_2| \\le 1$。\n\n互补松弛性条件是：\n- 如果 $|z_1|  1$，则 $x_2 - x_1 = 0$。\n- 如果 $|z_2|  1$，则 $x_3 - x_2 = 0$。\n\n让我们测试解为常数的可能性，即 $x_1 = x_2 = x_3 = c$。这将使 $\\ell_1$ 项最小化为 $0$。问题简化为最小化二次项：\n$$ \\min_{c} \\frac{1}{2}(c^2 + (c-3)^2 + c^2) = \\min_{c} \\frac{1}{2}(3c^2 - 6c + 9) $$\n对 $c$ 求导并令其为零，得到 $3c - 3 = 0$，所以 $c = 1$。\n这给出了一个候选解 $x = (1, 1, 1)^{\\top}$。\n我们来检查是否能找到满足 KKT 条件的相应对偶变量 $z_1, z_2$。\n由 $x_1 = z_1$ 得 $z_1 = 1$。\n由 $x_3 = -z_2$ 得 $1 = -z_2$，所以 $z_2 = -1$。\n我们来检验与 $x_2$ 方程的一致性：$x_2 = 3 - z_1 + z_2 = 3 - 1 + (-1) = 1$。这与我们的候选解一致。\n最后，我们检查 $z=(1, -1)^{\\top}$ 的对偶可行性：$|z_1| = 1 \\le 1$ 且 $|z_2| = 1 \\le 1$。该条件得到满足。\n条件 $x_2-x_1=0$ 和 $x_3-x_2=0$ 对应于 $\\ell_1$ 范数的次微分是完整区间 $[-1, 1]$ 的情况，因此 $|z_1|$ 和 $|z_2|$ 被允许等于 $1$。因此，该解是有效的。\n由于目标函数是严格凸的，解是唯一的。\n\n解为 $x = (1, 1, 1)^{\\top}$。表示为行向量，即为 $(1 \\ 1 \\ 1)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1  1  1 \\end{pmatrix} } $$"
        }
    ]
}