{
    "hands_on_practices": [
        {
            "introduction": "理解结构化稀疏模型的核心在于掌握其正则化项的性质，尤其是范数与其对偶范数之间的关系。这个练习提供了一个具体的计算机会，让您亲手计算组套索（Group Lasso）惩罚项的对偶范数，并评估一个候选解的对偶间隙。通过这个过程，您将加深对芬克尔对偶性（Fenchel duality）和最优化条件在结构化稀疏问题中如何应用的理解。",
            "id": "3482827",
            "problem": "设 $\\mathcal{G}=\\{g_{1},g_{2}\\}$ 是索引集 $\\{1,2,3,4\\}$ 的一个划分，分为两个不相交的组 $g_{1}=\\{1,2\\}$ 和 $g_{2}=\\{3,4\\}$，其正常数权重分别为 $w_{1}=1$ 和 $w_{2}=2$。在 $\\mathbb{R}^{4}$ 上定义组 Lasso 惩罚项为\n$$\n\\Omega(x)\\;=\\;\\sum_{g\\in\\mathcal{G}} w_{g}\\,\\|x_{g}\\|_{2},\n$$\n及其对偶范数由支撑函数定义为\n$$\n\\Omega^{\\ast}(s)\\;=\\;\\sup\\{\\,s^{\\top}x:\\ \\Omega(x)\\leq 1\\,\\}\\;=\\;\\max_{g\\in\\mathcal{G}}\\frac{\\|s_{g}\\|_{2}}{w_{g}}.\n$$\n考虑凸复合优化问题\n$$\n\\min_{x\\in\\mathbb{R}^{4}}\\ \\frac{1}{2}\\|Ax-b\\|_{2}^{2}\\;+\\;\\lambda\\,\\Omega(x),\n$$\n其中 $A=I_{4}$，$b=\\begin{pmatrix}5\\\\0\\\\10\\\\0\\end{pmatrix}$，且 $\\lambda=1$。给定一个候选原始-对偶对 $(\\tilde{x},\\tilde{u})$，其中\n$$\n\\tilde{x}=\\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix},\\qquad \\tilde{u}=A\\tilde{x}-b.\n$$\n任务：\n1) 仅使用对偶范数的支撑函数定义和欧几里得范数的基本性质，计算 $v=\\begin{pmatrix}3\\\\4\\\\6\\\\8\\end{pmatrix}$ 的 $\\Omega^{\\ast}(v)$。\n2) 从凸共轭和 Fenchel 对偶的定义出发，推导与给定原始问题相关的对偶问题，并用 $\\Omega^{\\ast}(A^{\\top}u)$ 和 $\\lambda$ 明确陈述相应的对偶可行性条件。验证 $\\tilde{u}$ 在此条件下是否为对偶可行的。\n3) 评估在 $\\tilde{x}$ 处的原始目标函数值和在 $\\tilde{u}$ 处的对偶目标函数值，并计算对偶间隙，其定义为在 $\\tilde{x}$ 处的原始目标函数值与在 $\\tilde{u}$ 处的对偶目标函数值之差。\n\n给出对偶间隙的值作为最终答案，形式为单个实数。无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、良定、客观且自洽的。为得出严谨解所需的所有必要定义和数据均已提供，不存在内部矛盾或逻辑缺陷。因此，我们可以开始求解。\n\n该问题要求完成三项任务，最终计算给定原始-对偶对的对偶间隙。我们将按顺序处理每项任务。\n\n首先，我们总结一下给定的信息。组结构由划分 $\\mathcal{G}=\\{g_{1},g_{2}\\}$ 定义，其中 $g_{1}=\\{1,2\\}$ 和 $g_{2}=\\{3,4\\}$ 是索引集 $\\{1,2,3,4\\}$ 的划分。相应的正常数权重为 $w_{1}=1$ 和 $w_{2}=2$。组 Lasso 惩罚项为 $\\Omega(x)\\;=\\;w_{1}\\|x_{g_{1}}\\|_{2} + w_{2}\\|x_{g_{2}}\\|_{2}$。其对偶范数由 $\\Omega^{\\ast}(s)\\;=\\;\\max\\left(\\frac{\\|s_{g_{1}}\\|_{2}}{w_{1}}, \\frac{\\|s_{g_{2}}\\|_{2}}{w_{2}}\\right)$ 给出。优化问题是\n$$\n\\min_{x\\in\\mathbb{R}^{4}}\\ P(x) = \\operatorname{arg\\,min}_{x\\in\\mathbb{R}^{4}}\\ \\frac{1}{2}\\|Ax-b\\|_{2}^{2}\\;+\\;\\lambda\\,\\Omega(x)\n$$\n参数为 $A=I_{4}$（$4\\times 4$ 单位矩阵），$b=\\begin{pmatrix}5\\\\0\\\\10\\\\0\\end{pmatrix}$，且 $\\lambda=1$。候选原始点是 $\\tilde{x}=\\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix}$。\n\n**任务1：计算 $\\Omega^{\\ast}(v)$**\n\n我们被要求计算向量 $v=\\begin{pmatrix}3\\\\4\\\\6\\\\8\\end{pmatrix}$ 的对偶范数 $\\Omega^{\\ast}(v)$。\n根据组划分 $\\mathcal{G}$，我们将向量 $v$ 分解为对应于组 $g_{1}$ 和 $g_{2}$ 的分量：\n$$\nv_{g_{1}} = \\begin{pmatrix}3\\\\4\\end{pmatrix}, \\qquad v_{g_{2}} = \\begin{pmatrix}6\\\\8\\end{pmatrix}.\n$$\n接下来，我们计算每个子向量的欧几里得范数（$\\ell_{2}$-范数）：\n$$\n\\|v_{g_{1}}\\|_{2} = \\sqrt{3^{2} + 4^{2}} = \\sqrt{9+16} = \\sqrt{25} = 5.\n$$\n$$\n\\|v_{g_{2}}\\|_{2} = \\sqrt{6^{2} + 8^{2}} = \\sqrt{36+64} = \\sqrt{100} = 10.\n$$\n使用对偶范数的定义 $\\Omega^{\\ast}(s) = \\max_{g\\in\\mathcal{G}}\\frac{\\|s_{g}\\|_{2}}{w_{g}}$ 以及权重 $w_{1}=1$ 和 $w_{2}=2$，我们有：\n$$\n\\Omega^{\\ast}(v) = \\max\\left(\\frac{\\|v_{g_{1}}\\|_{2}}{w_{1}}, \\frac{\\|v_{g_{2}}\\|_{2}}{w_{2}}\\right) = \\max\\left(\\frac{5}{1}, \\frac{10}{2}\\right) = \\max(5, 5) = 5.\n$$\n\n**任务2：推导对偶问题并验证对偶可行性**\n\n原始问题的形式为 $\\min_{x} f(Ax) + g(x)$，其中 $f(z) = \\frac{1}{2}\\|z-b\\|_{2}^{2}$ 和 $g(x) = \\lambda\\Omega(x)$。根据 Fenchel-Rockafellar 对偶理论，对偶问题由下式给出：\n$$\n\\max_{u} -f^{\\ast}(u) - g^{\\ast}(-A^{\\top}u),\n$$\n其中 $f^{\\ast}$ 和 $g^{\\ast}$ 分别是 $f$ 和 $g$ 的凸共轭。\n\n首先，我们计算 $f(z) = \\frac{1}{2}\\|z-b\\|_{2}^{2}$ 的共轭：\n$$\nf^{\\ast}(u) = \\sup_{z\\in\\mathbb{R}^{4}} \\left(u^{\\top}z - \\frac{1}{2}\\|z-b\\|_{2}^{2}\\right).\n$$\n通过将关于 $z$ 的梯度设为零来找到最大化点：$u - (z-b) = 0$，这得出 $z = u+b$。将此代回表达式中，得到\n$$\nf^{\\ast}(u) = u^{\\top}(u+b) - \\frac{1}{2}\\|(u+b)-b\\|_{2}^{2} = \\|u\\|_{2}^{2} + u^{\\top}b - \\frac{1}{2}\\|u\\|_{2}^{2} = \\frac{1}{2}\\|u\\|_{2}^{2} + b^{\\top}u.\n$$\n接下来，我们计算 $g(x) = \\lambda\\Omega(x)$ 的共轭：\n$$\ng^{\\ast}(s) = \\sup_{x\\in\\mathbb{R}^{4}} \\left(s^{\\top}x - \\lambda\\Omega(x)\\right).\n$$\n$g^{\\ast}(s)$ 是集合 $\\{s \\in \\mathbb{R}^{4} \\mid \\Omega^{\\ast}(s) \\leq \\lambda\\}$ 的指示函数，即当 $\\Omega^{\\ast}(s) \\leq \\lambda$ 时其值为0，否则为 $+\\infty$。\n\n将这些共轭代入对偶问题公式中，我们得到：\n$$\n\\max_{u} -\\left(\\frac{1}{2}\\|u\\|_{2}^{2} + b^{\\top}u\\right) - g^{\\ast}(-A^{\\top}u).\n$$\n项 $-g^{\\ast}(-A^{\\top}u)$ 施加了一个约束。为使目标函数值为有限，我们必须有 $g^{\\ast}(-A^{\\top}u) = 0$，这意味着 $\\Omega^{\\ast}(-A^{\\top}u) \\leq \\lambda$。由于 $\\Omega^{\\ast}$ 是一个范数，$\\Omega^{\\ast}(-v) = \\Omega^{\\ast}(v)$，因此条件变为 $\\Omega^{\\ast}(A^{\\top}u) \\leq \\lambda$。\n因此，对偶问题是\n$$\n\\max_{u\\in\\mathbb{R}^{4}} \\ D(u) = \\max_{u\\in\\mathbb{R}^{4}} \\ -\\frac{1}{2}\\|u\\|_{2}^{2} - b^{\\top}u \\quad \\text{subject to} \\quad \\Omega^{\\ast}(A^{\\top}u) \\leq \\lambda.\n$$\n对偶可行性条件明确为 $\\Omega^{\\ast}(A^{\\top}u) \\leq \\lambda$。\n\n现在，我们验证候选对偶变量 $\\tilde{u}$ 是否为对偶可行的。首先，我们根据其定义计算 $\\tilde{u}$：\n$$\n\\tilde{u} = A\\tilde{x} - b = I_{4}\\tilde{x} - b = \\tilde{x} - b = \\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix} - \\begin{pmatrix}5\\\\0\\\\10\\\\0\\end{pmatrix} = \\begin{pmatrix}0\\\\0\\\\-2\\\\0\\end{pmatrix}.\n$$\n我们必须检查是否 $\\Omega^{\\ast}(A^{\\top}\\tilde{u}) \\leq \\lambda$。当 $A=I_{4}$ 且 $\\lambda=1$ 时，这简化为 $\\Omega^{\\ast}(\\tilde{u}) \\leq 1$。\n我们将 $\\tilde{u}$ 划分到其组分量中：\n$$\n\\tilde{u}_{g_{1}} = \\begin{pmatrix}0\\\\0\\end{pmatrix}, \\qquad \\tilde{u}_{g_{2}} = \\begin{pmatrix}-2\\\\0\\end{pmatrix}.\n$$\n相应的欧几里得范数为：\n$$\n\\|\\tilde{u}_{g_{1}}\\|_{2} = \\sqrt{0^{2}+0^{2}} = 0.\n$$\n$$\n\\|\\tilde{u}_{g_{2}}\\|_{2} = \\sqrt{(-2)^{2}+0^{2}} = \\sqrt{4} = 2.\n$$\n现在我们计算对偶范数 $\\Omega^{\\ast}(\\tilde{u})$：\n$$\n\\Omega^{\\ast}(\\tilde{u}) = \\max\\left(\\frac{\\|\\tilde{u}_{g_{1}}\\|_{2}}{w_{1}}, \\frac{\\|\\tilde{u}_{g_{2}}\\|_{2}}{w_{2}}\\right) = \\max\\left(\\frac{0}{1}, \\frac{2}{2}\\right) = \\max(0, 1) = 1.\n$$\n可行性条件是 $1 \\leq 1$，这是成立的。因此，$\\tilde{u}$ 是一个对偶可行点。\n\n**任务3：计算原始和对偶目标函数值及对偶间隙**\n\n我们计算在 $x=\\tilde{x}$ 处的原始目标函数 $P(x)$ 和在 $u=\\tilde{u}$ 处的对偶目标函数 $D(u)$ 的值。\n原始目标函数值为 $P(\\tilde{x}) = \\frac{1}{2}\\|A\\tilde{x}-b\\|_{2}^{2} + \\lambda\\Omega(\\tilde{x})$。\n当 $A=I_{4}$ 且 $\\lambda=1$ 时：\n$$\nP(\\tilde{x}) = \\frac{1}{2}\\|\\tilde{x}-b\\|_{2}^{2} + \\Omega(\\tilde{x}).\n$$\n第一项是 $\\frac{1}{2}\\|\\tilde{u}\\|_{2}^{2} = \\frac{1}{2}(0^{2}+0^{2}+(-2)^{2}+0^{2}) = \\frac{4}{2} = 2$。\n对于第二项 $\\Omega(\\tilde{x})$，我们计算 $\\tilde{x}=\\begin{pmatrix}5\\\\0\\\\8\\\\0\\end{pmatrix}$ 的子向量的范数：\n$$\n\\tilde{x}_{g_{1}} = \\begin{pmatrix}5\\\\0\\end{pmatrix} \\implies \\|\\tilde{x}_{g_{1}}\\|_{2} = \\sqrt{5^{2}+0^{2}} = 5.\n$$\n$$\n\\tilde{x}_{g_{2}} = \\begin{pmatrix}8\\\\0\\end{pmatrix} \\implies \\|\\tilde{x}_{g_{2}}\\|_{2} = \\sqrt{8^{2}+0^{2}} = 8.\n$$\n所以，$\\Omega(\\tilde{x}) = w_{1}\\|\\tilde{x}_{g_{1}}\\|_{2} + w_{2}\\|\\tilde{x}_{g_{2}}\\|_{2} = (1)(5) + (2)(8) = 5+16 = 21$。\n原始目标函数值为 $P(\\tilde{x}) = 2 + 21 = 23$。\n\n在可行点 $\\tilde{u}$ 处的对偶目标函数值为 $D(\\tilde{u}) = -\\frac{1}{2}\\|\\tilde{u}\\|_{2}^{2} - b^{\\top}\\tilde{u}$。\n第一项是 $-\\frac{1}{2}\\|\\tilde{u}\\|_{2}^{2} = -2$。\n第二项是 $-b^{\\top}\\tilde{u}$：\n$$\n-b^{\\top}\\tilde{u} = -\\begin{pmatrix}5 & 0 & 10 & 0\\end{pmatrix} \\begin{pmatrix}0\\\\0\\\\-2\\\\0\\end{pmatrix} = -((5)(0) + (0)(0) + (10)(-2) + (0)(0)) = -(-20) = 20.\n$$\n对偶目标函数值为 $D(\\tilde{u}) = -2 + 20 = 18$。\n\n最后，对偶间隙定义为在 $\\tilde{x}$ 处的原始目标函数值与在 $\\tilde{u}$ 处的对偶目标函数值之差。\n$$\n\\text{对偶间隙} = P(\\tilde{x}) - D(\\tilde{u}) = 23 - 18 = 5.\n$$\n这个间隙是一个非负值，这是由弱对偶性保证的。由于间隙不为零，该对 $(\\tilde{x}, \\tilde{u})$ 不是最优的，尽管它是原始-对偶可行的。",
            "answer": "$$\n\\boxed{5}\n$$"
        },
        {
            "introduction": "全变分（Total Variation, TV）是信号与图像处理中应用最广泛的结构化稀疏模型之一。求解TV正则化问题的关键在于高效地计算其近端算子（proximal operator）。这个练习将引导您推导该算子的卡罗需-库恩-塔克（KKT）条件，并揭示其背后优美的“拉紧绳子”（taut-string）几何解释。掌握这一过程不仅能让您求解一维TV问题，更能为您理解更复杂的结构化模型提供深刻的洞察力。",
            "id": "3482835",
            "problem": "将一维全变分正则化器视为一个典型的结构化稀疏模型。令 $D \\in \\mathbb{R}^{(n-1) \\times n}$ 表示一阶前向差分算子，其定义为 $(D x)_{i} = x_{i+1} - x_{i}$，其中 $i \\in \\{1,\\dots,n-1\\}$。对于给定的观测值 $y \\in \\mathbb{R}^{n}$ 和正则化参数 $\\lambda > 0$，考虑凸函数 $x \\mapsto \\lambda \\lVert D x \\rVert_{1}$ 在平方欧几里得度量下的近端算子，即：\n$$\n\\operatorname{prox}_{\\lambda \\lVert D \\cdot \\rVert_{1}}(y) \\in \\operatorname{arg\\,min}_{x \\in \\mathbb{R}^{n}} \\left\\{ \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert D x \\rVert_{1} \\right\\}.\n$$\n任务：\n1) 仅从近端算子的定义和 $\\ell_{1}$ 范数的次微分出发，使用一个辅助变量 $u = D x$ 进行分裂，写出一个约束凸优化问题，并推导原始-对偶最优性的 Karush-Kuhn-Tucker (KKT) 条件。您的推导必须明确指出伴随算子 $D^{\\top}$ 和以 $\\ell_{\\infty}$ 范数表示的对偶可行域，并且必须表达连接 $x$、$y$ 和对偶变量的平稳性条件。\n2) 消去辅助变量，以获得耦合原始变量 $x$ 和对偶变量 $z \\in \\mathbb{R}^{n-1}$ 的充分必要最优性关系。然后，通过对平稳性条件进行分量求和，推导出将对偶变量刻画为残差部分和的累积和可行性约束。请仅使用 $y$、$x$ 和 $\\lambda$ 仔细地表达这些约束，并证明它们等价于 $\\lVert D x \\rVert_{1}$ 的次微分关系。\n3) 解释拉紧绳索（taut-string）解释：说明累积和约束如何在 $y$ 的累积和周围定义一个半径为 $\\lambda$ 的管道，最优的 $x$ 的累积和是如何成为连接端点且在此管道内的最短路径，并解释为何这种构造能推导出一个具有线性时间复杂度 $\\mathcal{O}(n)$ 的算法。\n4) 对于 $n = 3$，$\\lambda = 1$ 和 $y = \\begin{pmatrix}0, 3, 0\\end{pmatrix}^{\\top}$ 的实例，显式计算 $\\operatorname{prox}_{\\lambda \\lVert D \\cdot \\rVert_{1}}(y)$。请使用 pmatrix 环境将您的最终答案表示为单个行向量。不需要四舍五入，也没有单位。",
            "solution": "该问题要求对一维全变分（TV）正则化器的近端算子进行多部分分析，并最终对一个给定实例进行显式计算。\n\n问题陈述在凸优化和信号处理领域具有科学依据。一维全变分正则化器、其近端算子、Karush-Kuhn-Tucker (KKT) 条件以及拉紧绳索算法都是标准的、定义明确的概念。问题是自洽的，所有必要的数据和定义都已提供。该问题是适定的，因为目标函数是一个严格凸函数和一个凸函数之和，这保证了唯一最小化子的存在。所有任务都是可形式化的，并导向一个唯一的、可验证的解。因此，该问题是有效的。\n\n**1) Karush-Kuhn-Tucker (KKT) 条件的推导**\n\n问题是找到目标函数的最小化子：\n$$ \\operatorname{arg\\,min}_{x \\in \\mathbb{R}^{n}} \\left\\{ \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert D x \\rVert_{1} \\right\\} $$\n我们引入一个辅助变量 $u \\in \\mathbb{R}^{n-1}$，使得 $u = Dx$。该问题可以重写为一个约束优化问题：\n$$ \\min_{x \\in \\mathbb{R}^{n}, u \\in \\mathbb{R}^{n-1}} \\left\\{ \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert u \\rVert_{1} \\right\\} \\quad \\text{subject to} \\quad Dx - u = 0 $$\n为了找到 KKT 条件，我们通过为等式约束引入一个对偶变量（拉格朗日乘子）$z \\in \\mathbb{R}^{n-1}$ 来构造拉格朗日函数：\n$$ \\mathcal{L}(x, u, z) = \\frac{1}{2} \\lVert x - y \\rVert_{2}^{2} + \\lambda \\lVert u \\rVert_{1} + z^{\\top}(Dx - u) $$\n最优性的 KKT 条件包括原始可行性、对偶可行性以及拉格朗日函数相对于原始变量的平稳性。\n\n首先，我们求伴随算子 $D^{\\top}$。对于任意 $x \\in \\mathbb{R}^{n}$ 和 $z \\in \\mathbb{R}^{n-1}$，伴随算子 $D^{\\top}$ 由关系 $\\langle z, Dx \\rangle = \\langle D^{\\top}z, x \\rangle$ 定义。\n$$ \\langle z, Dx \\rangle = \\sum_{i=1}^{n-1} z_i (Dx)_i = \\sum_{i=1}^{n-1} z_i (x_{i+1} - x_i) = \\sum_{i=1}^{n-1} z_i x_{i+1} - \\sum_{i=1}^{n-1} z_i x_i $$\n通过重新索引求和以按 $x_i$ 对各项进行分组，我们得到：\n$$ \\langle z, Dx \\rangle = -z_1 x_1 + \\sum_{i=2}^{n-1} (z_{i-1} - z_i)x_i + z_{n-1}x_n $$\n这揭示了 $D^{\\top}z$ 的分量：\n$$ (D^{\\top}z)_1 = -z_1 $$\n$$ (D^{\\top}z)_i = z_{i-1} - z_i \\quad \\text{for } i \\in \\{2, \\dots, n-1\\} $$\n$$ (D^{\\top}z)_n = z_{n-1} $$\n这对应于一个具有特定边界条件的后向差分算子。\n\nKKT 条件是：\ni. **关于 $x$ 的平稳性**：拉格朗日函数关于 $x$ 的梯度必须为零。\n$$ \\nabla_x \\mathcal{L}(x, u, z) = (x - y) + D^{\\top}z = 0 $$\n这给出了连接原始变量 $x$、数据 $y$ 和对偶变量 $z$ 的平稳性条件：\n$$ x - y + D^{\\top}z = 0 \\quad \\text{or} \\quad x + D^{\\top}z = y $$\nii. **关于 $u$ 的平稳性**：零向量必须在拉格朗日函数关于 $u$ 的次微分中。\n$$ 0 \\in \\partial_u \\mathcal{L}(x, u, z) = \\lambda \\partial \\lVert u \\rVert_{1} - z $$\n这得出了关系 $z \\in \\lambda \\partial \\lVert u \\rVert_{1}$。$\\ell_1$ 范数的次微分 $\\partial \\lVert u \\rVert_{1}$ 是向量 $v$ 的集合，其中如果 $u_i \\neq 0$，则 $v_i = \\operatorname{sgn}(u_i)$；如果 $u_i = 0$，则 $v_i \\in [-1, 1]$。这个条件可以写成 $\\lVert v \\rVert_{\\infty} \\le 1$。\n关系 $z \\in \\lambda \\partial \\lVert u \\rVert_{1}$ 意味着 $z/\\lambda \\in \\partial \\lVert u \\rVert_{1}$。因此，我们必须有 $\\lVert z/\\lambda \\rVert_{\\infty} \\le 1$，这简化为**对偶可行性条件**：\n$$ \\lVert z \\rVert_{\\infty} \\le \\lambda $$\niii. **原始可行性**：原始约束必须成立：\n$$ Dx - u = 0 $$\n\n总而言之，KKT 条件包括：\n- 原始可行性：$u = Dx$\n- 对偶可行性：$\\lVert z \\rVert_{\\infty} \\le \\lambda$\n- 平稳性：$x - y + D^{\\top}z = 0$\n- 互补松弛性（嵌入在关于 $u$ 的平稳性条件中）：对所有 $i$，$z_i u_i = \\lambda |u_i|$，这意味着如果 $|z_i| < \\lambda$，则 $u_i = (Dx)_i = 0$。\n\n**2) 累积和可行性约束的推导**\n\n我们消去辅助变量 $u$，并使用耦合 $x$ 和 $z$ 的关系。主要条件是 $y - x = D^{\\top}z$ 和 $\\lVert z \\rVert_{\\infty} \\le \\lambda$。让我们分量地写出平稳性条件：\n$$ y_1 - x_1 = -z_1 $$\n$$ y_i - x_i = z_{i-1} - z_i \\quad \\text{for } i \\in \\{2, \\dots, n-1\\} $$\n$$ y_n - x_n = z_{n-1} $$\n现在，我们将这些方程的前 $k$ 个相加，其中 $k \\in \\{1, \\dots, n-1\\}$：\n对于 $k=1$：$\\sum_{i=1}^{1} (y_i - x_i) = y_1 - x_1 = -z_1$。\n对于 $k=2$：$\\sum_{i=1}^{2} (y_i - x_i) = (y_1 - x_1) + (y_2 - x_2) = -z_1 + (z_1 - z_2) = -z_2$。\n通过归纳法，对于任何 $k \\in \\{1, \\dots, n-1\\}$：\n$$ \\sum_{i=1}^{k} (y_i - x_i) = -z_k $$\n对偶可行性条件 $\\lVert z \\rVert_{\\infty} \\le \\lambda$ 意味着对于所有 $k \\in \\{1, \\dots, n-1\\}$， $|z_k| \\le \\lambda$。代入 $z_k$ 的表达式，我们得到累积和约束：\n$$ \\left| \\sum_{i=1}^{k} (y_i - x_i) \\right| \\le \\lambda \\quad \\text{for } k \\in \\{1, \\dots, n-1\\} $$\n此外，将平稳性条件的所有 $n$ 个分量相加可得：\n$$ \\sum_{i=1}^{n} (y_i - x_i) = -z_1 + \\sum_{i=2}^{n-1} (z_{i-1} - z_i) + z_{n-1} = 0 $$\n该和式伸缩为零。这意味着最优解 $x$ 的总和（或均值）等于观测值 $y$ 的总和：$\\sum_{i=1}^n x_i = \\sum_{i=1}^n y_i$。\n\n这些充分必要最优性关系等价于原始问题的次微分关系。对于 $\\min_x F(x) = \\frac{1}{2}\\lVert x - y \\rVert_2^2 + \\lambda \\lVert Dx \\rVert_1$，其最优性条件是 $0 \\in \\partial F(x)$。\n使用次微分的求和法则和链式法则：\n$$ 0 \\in \\nabla \\left(\\frac{1}{2}\\lVert x-y \\rVert_2^2\\right) + \\partial(\\lambda \\lVert Dx \\rVert_1) = (x-y) + \\lambda D^{\\top} (\\partial \\lVert Dx \\rVert_1) $$\n这意味着存在一个向量 $v \\in \\partial \\lVert Dx \\rVert_1$，使得 $y - x = \\lambda D^{\\top}v$。通过将对偶变量定义为 $z = \\lambda v$，我们得到 $y - x = D^{\\top}z$。条件 $v \\in \\partial \\lVert Dx \\rVert_1$ 意味着 $\\lVert v \\rVert_{\\infty} \\le 1$，这等价于 $\\lVert z / \\lambda \\rVert_{\\infty} \\le 1$，即 $\\lVert z \\rVert_{\\infty} \\le \\lambda$。我们的推导精确地表明，这个次微分包含关系等价于累积和约束集。\n\n**3) 拉紧绳索（Taut-String）解释**\n\n累积和约束提供了一个强大的几何解释。让我们将观测值 $y$ 和解 $x$ 的累积和分别定义为 $Y_k = \\sum_{i=1}^k y_i$ 和 $X_k = \\sum_{i=1}^k x_i$，其中 $k \\in \\{1, \\dots, n\\}$，且 $Y_0 = X_0 = 0$。\n在第 2 部分中推导的约束可以使用这些累积和重写：\n1. 对 $k \\in \\{1, \\dots, n-1\\}$，$|\\sum_{i=1}^k (y_i - x_i)| = |Y_k - X_k| \\le \\lambda$。这等价于 $Y_k - \\lambda \\le X_k \\le Y_k + \\lambda$。\n2. $\\sum_{i=1}^n (y_i - x_i) = Y_n - X_n = 0$，这意味着 $X_n = Y_n$。\n\n这些条件描述了一个几何问题：\n- 解的累积和路径，由点集 $\\{(k, X_k)\\}_{k=0}^n$ 定义，必须从 $(0,0)$ 开始，到 $(n, Y_n)$ 结束。\n- 对于所有中间点 $k \\in \\{1, \\dots, n-1\\}$，$X_k$ 的值必须位于围绕 $y$ 的累积和 $Y_k$ 的一个**半径为 $\\lambda$ 的管道**内。该管道的边界由路径 $\\{(k, Y_k - \\lambda)\\}_{k=0}^n$ 和 $\\{(k, Y_k + \\lambda)\\}_{k=0}^n$ 给出。\n\n最优解 $x$ 对应于一个累积和路径 $X$，该路径是在管道内保持“最平坦”或“最规则”的可能路径。这对应于**拉紧绳索**的概念。如果将管道边界想象为物理约束，并将一根绳索从 $(0,0)$ 穿过该管道到 $(n, Y_n)$，拉紧绳索会得到一条由线段序列组成的路径。这条路径正是最优的累积和路径 $X$。\n\n最优路径 $X$ 呈线性（即斜率恒定）的区域对应于解 $x$ 为常数的片段。这是互补性条件的直接结果：如果路径 $X$ 在索引 $k$ 处严格位于管道内部（即 $|Y_k - X_k| < \\lambda$），那么 $|z_k| < \\lambda$，这意味着 $(Dx)_k = x_{k+1} - x_k = 0$。路径 $X$ 仅在接触到管道边界的点处改变斜率。\n\n这种几何解释在算法上非常强大。找到这条拉紧绳索路径的问题等价于找到管道边界的最大凸子函数和最小凹母函数。这个问题可以非常高效地解决。诸如 Pool Adjacent Violators Algorithm (PAVA) 或其他专门的主动集方法等算法可以计算出解路径。这些算法平均对每个点处理常数次，从而得到**$\\mathcal{O}(n)$ 的整体线性时间复杂度**。\n\n**4) 显式计算**\n\n给定 $n = 3$，$\\lambda = 1$ 和 $y = (0, 3, 0)^{\\top}$。我们需要计算 $x = \\operatorname{prox}_{\\lambda \\lVert D \\cdot \\rVert_{1}}(y)$。我们寻求 $x = (x_1, x_2, x_3)^{\\top}$ 来最小化：\n$$ \\frac{1}{2}(x_1^2 + (x_2-3)^2 + x_3^2) + 1 \\cdot (|x_2-x_1| + |x_3-x_2|) $$\n我们使用前面推导的 KKT 条件，以及对偶变量 $z = (z_1, z_2)^{\\top}$。\n平稳性条件 $y-x=D^\\top z$ 给出：\n$$ 0 - x_1 = -z_1 \\implies x_1 = z_1 $$\n$$ 3 - x_2 = z_1 - z_2 \\implies x_2 = 3 - z_1 + z_2 $$\n$$ 0 - x_3 = z_2 \\implies x_3 = -z_2 $$\n对偶可行性条件是 $\\lVert z \\rVert_{\\infty} \\le \\lambda = 1$，意味着 $|z_1| \\le 1$ 和 $|z_2| \\le 1$。\n\n互补松弛性条件是：\n- 如果 $|z_1| < 1$，则 $x_2 - x_1 = 0$。\n- 如果 $|z_2| < 1$，则 $x_3 - x_2 = 0$。\n\n让我们测试解为常数的可能性，即 $x_1 = x_2 = x_3 = c$。这将使 $\\ell_1$ 项最小化为 $0$。问题简化为最小化二次项：\n$$ \\min_{c} \\frac{1}{2}(c^2 + (c-3)^2 + c^2) = \\min_{c} \\frac{1}{2}(3c^2 - 6c + 9) $$\n对 $c$ 求导并令其为零，得到 $3c - 3 = 0$，所以 $c = 1$。\n这给出了一个候选解 $x = (1, 1, 1)^{\\top}$。\n我们来检查是否能找到满足 KKT 条件的相应对偶变量 $z_1, z_2$。\n从 $x_1 = z_1$，我们有 $z_1 = 1$。\n从 $x_3 = -z_2$，我们有 $1 = -z_2$，所以 $z_2 = -1$。\n我们来检查与 $x_2$ 方程的一致性：\n$x_2 = 3 - z_1 + z_2 = 3 - 1 + (-1) = 1$。这与我们的候选解一致。\n最后，我们检查 $z=(1, -1)^{\\top}$ 的对偶可行性：\n$|z_1| = 1 \\le 1$ 并且 $|z_2| = 1 \\le 1$。此条件满足。\n条件 $x_2-x_1=0$ 和 $x_3-x_2=0$ 对应于 $\\ell_1$ 范数的次微分是完整区间 $[-1, 1]$ 的情况，因此 $|z_1|$ 和 $|z_2|$ 允许为 $1$。因此，该解是有效的。\n由于目标函数是严格凸的，所以解是唯一的。\n\n解是 $x = (1, 1, 1)^{\\top}$。表示为行向量，即 $(1 \\ 1 \\ 1)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix} } $$"
        }
    ]
}