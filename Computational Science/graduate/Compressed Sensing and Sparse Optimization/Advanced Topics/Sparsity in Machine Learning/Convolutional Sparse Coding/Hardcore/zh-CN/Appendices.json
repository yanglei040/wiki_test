{
    "hands_on_practices": [
        {
            "introduction": "在卷积稀疏编码中，一个核心的子问题是当字典 $\\{d_k\\}$ 固定时，求解稀疏激活图 $\\{z_k\\}$。这个问题通常通过近端梯度方法来解决，例如迭代收缩阈值算法（ISTA）或其加速版本（FISTA）。为了确保这些算法的收敛性，一个关键步骤是确定一个合适的步长，这直接依赖于损失函数梯度 $\\nabla f$ 的Lipschitz常数 $L$。本练习将引导你推导这个关键参数，通过利用傅里叶变换的性质，将复杂的卷积运算转化为频域上简单的乘积，从而揭示如何为高效的稀疏编码算法设定理论上稳健的步长 ()。",
            "id": "3440981",
            "problem": "设一维周期信号 $x \\in \\mathbb{R}^{N}$ 由卷积稀疏编码 (CSC) 建模，其数据项为 $f(\\{z_{k}\\}) = \\frac{1}{2} \\left\\| x - \\sum_{k=1}^{K} d_{k} * z_{k} \\right\\|_{2}^{2}$，其中卷积 $*$ 为循环卷积，滤波器 $\\{d_{k}\\}_{k=1}^{K}$ 和编码 $\\{z_{k}\\}_{k=1}^{K}$ 是长度为 $N$ 的实值序列。定义线性算子 $\\mathcal{D}$，它将堆叠编码向量 $z = (z_{1},\\dots,z_{K})$ 映射到合成信号 $\\sum_{k=1}^{K} d_{k} * z_{k}$。$f$ 关于堆叠编码的梯度为 $\\nabla f(z) = \\mathcal{D}^{\\top}(\\mathcal{D}z - x)$。考虑具有酉归一化的离散傅里叶变换 (DFT)（因此对每个 $u \\in \\mathbb{R}^{N}$，Parseval 恒等式 $\\sum_{n=0}^{N-1} |u[n]|^{2} = \\sum_{i=0}^{N-1} |U[\\omega_{i}]|^{2}$ 成立，其中 $U$ 是 $u$ 的 DFT，$\\{\\omega_{i}\\}_{i=0}^{N-1}$ 是频率点）。令 $D_{k}[\\omega_{i}]$ 表示 $d_{k}$ 在频率 $\\omega_{i}$ 处的 DFT。\n\n从梯度映射的利普希茨连续性定义以及循环卷积的 DFT 酉性质出发，推导出一个关于堆叠编码上的欧几里得范数的 $\\nabla f$ 的有效全局利普希茨常数 $L$，并用傅里叶幅值 $\\{|D_{k}[\\omega_{i}]|\\}_{k,i}$ 表示。然后，推导一个仅依赖于滤波器能量 $\\sum_{k=1}^{K} \\|d_{k}\\|_{2}^{2}$ 的关于 $L$ 的简单、可计算的上界。根据光滑加非光滑凸目标函数的标准收敛性保证，使用常数 $L$ 为迭代收缩阈值算法 (ISTA) 和快速迭代收缩阈值算法 (FISTA) 设置一个固定的步长 $\\alpha$。以行矩阵 $\\begin{pmatrix} L  \\alpha \\end{pmatrix}$ 的形式报告你的最终答案，其中 $L$ 使用精确的傅里叶幅值表达式，并采用标准选择 $\\alpha = 1/L$。不需要数值近似，也不涉及单位。",
            "solution": "我们考虑定义在堆叠编码向量 $z = (z_{1},\\dots,z_{K}) \\in \\mathbb{R}^{KN}$ 上的光滑凸函数 $f(z) = \\frac{1}{2} \\|\\mathcal{D}z - x\\|_{2}^{2}$。梯度映射为\n$$\n\\nabla f(z) = \\mathcal{D}^{\\top}(\\mathcal{D}z - x).\n$$\n关于欧几里得范数的 $\\nabla f$ 的全局利普希茨常数 $L$ 是任何满足以下条件的常数 $L \\ge 0$：\n$$\n\\|\\nabla f(z) - \\nabla f(z')\\|_{2} \\le L \\|z - z'\\|_{2} \\quad \\text{对于所有 } z, z' \\in \\mathbb{R}^{KN}.\n$$\n根据线性性质，\n$$\n\\nabla f(z) - \\nabla f(z') = \\mathcal{D}^{\\top}\\mathcal{D}(z - z'),\n$$\n因此，最紧的全局利普希茨常数等于线性算子 $\\mathcal{D}^{\\top}\\mathcal{D}$ 关于欧几里得范数的谱范数：\n$$\nL = \\|\\mathcal{D}^{\\top}\\mathcal{D}\\|_{2}.\n$$\n因为 $\\mathcal{D}^{\\top}\\mathcal{D}$ 是对称正半定的，所以 $\\|\\mathcal{D}^{\\top}\\mathcal{D}\\|_{2} = \\lambda_{\\max}(\\mathcal{D}^{\\top}\\mathcal{D}) = \\|\\mathcal{D}\\|_{2}^{2}$，其中 $\\|\\mathcal{D}\\|_{2}$ 是 $\\mathcal{D}$ 的算子范数（最大奇异值）。\n\n现在我们使用酉离散傅里叶变换 (DFT) 和循环卷积的结构来计算 $\\|\\mathcal{D}\\|_{2}$。在循环边界条件下，每个与 $d_{k}$ 的卷积都由一个循环矩阵 $C_{d_{k}}$ 表示，合成算子为\n$$\n\\mathcal{D} = \\begin{bmatrix} C_{d_{1}}  C_{d_{2}}  \\cdots  C_{d_{K}} \\end{bmatrix},\n$$\n将 $z = (z_{1},\\dots,z_{K})$ 映射到 $\\sum_{k} C_{d_{k}} z_{k}$。DFT 将每个循环矩阵对角化：存在一个酉 DFT 矩阵 $F$，使得 $C_{d_{k}} = F^{\\ast} \\Lambda_{k} F$，其中 $\\Lambda_{k}$ 是对角矩阵，其对角线元素为在频率点上求值的 $d_{k}$ 的 DFT $\\{D_{k}[\\omega_{i}]\\}_{i=0}^{N-1}$。在频域中，$\\mathcal{D}$ 对 $z$ 的作用在各个频率上是解耦的：\n$$\n\\widehat{y}[\\omega_{i}] = \\sum_{k=1}^{K} D_{k}[\\omega_{i}] \\, \\widehat{z}_{k}[\\omega_{i}], \\quad i = 0,\\dots,N-1,\n$$\n其中 $\\widehat{y} = F(\\mathcal{D}z)$ 且 $\\widehat{z}_{k} = F z_{k}$。对于每个固定的频率 $\\omega_{i}$，这是一个从 $K$ 维向量 $(\\widehat{z}_{1}[\\omega_{i}],\\dots,\\widehat{z}_{K}[\\omega_{i}])$ 到标量 $\\widehat{y}[\\omega_{i}]$ 的线性映射，其算子范数等于系数向量 $\\big(D_{1}[\\omega_{i}],\\dots,D_{K}[\\omega_{i}]\\big)$ 的欧几里得范数。因此，$\\mathcal{D}$ 的奇异值由这些逐频率的范数给出，最大奇异值为\n$$\n\\|\\mathcal{D}\\|_{2} = \\max_{i \\in \\{0,\\dots,N-1\\}} \\left( \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2} \\right)^{1/2}.\n$$\n因此，\n$$\nL = \\|\\mathcal{D}\\|_{2}^{2} = \\max_{i \\in \\{0,\\dots,N-1\\}} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2}.\n$$\n\n我们现在推导一个仅依赖于滤波器能量 $\\sum_{k=1}^{K} \\|d_{k}\\|_{2}^{2}$ 的关于 $L$ 的简单上界。使用 DFT 的酉归一化和 Parseval 恒等式，对每个 $k$ 我们有：\n$$\n\\sum_{i=0}^{N-1} |D_{k}[\\omega_{i}]|^{2} = \\|d_{k}\\|_{2}^{2}.\n$$\n因此，\n$$\n\\max_{i} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2} \\le \\sum_{i=0}^{N-1} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2} = \\sum_{k=1}^{K} \\|d_{k}\\|_{2}^{2}.\n$$\n这表明一个有效的全局利普希茨常数由 $$ L = \\max_{i} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2} $$ 精确给出，并且它的上界是 $\\sum_{k=1}^{K} \\|d_{k}\\|_{2}^{2}$，当只有时域能量可用时可以使用该上界。\n\n对于迭代收缩阈值算法 (ISTA) 和快速迭代收缩阈值算法 (FISTA)，具有光滑部分 $f$ 的复合凸目标函数的标准收敛性保证要求步长 $\\alpha$ 满足 $0  \\alpha \\le 1/L$。一个标准的选择是 $\\alpha = 1/L$。使用 $L$ 的精确表达式，可得\n$$\n\\alpha = \\frac{1}{\\max_{i} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2}}.\n$$\n\n根据报告要求，我们返回由 $L$ 的精确傅里叶幅值表达式和相应的标准步长 $\\alpha = 1/L$ 构成的行矩阵 $\\begin{pmatrix} L  \\alpha \\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\displaystyle \\max_{i} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2}  \\displaystyle \\frac{1}{\\max_{i} \\sum_{k=1}^{K} |D_{k}[\\omega_{i}]|^{2}}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "学习卷积字典 $\\{d_k\\}$ 是卷积稀疏编码的另一个核心环节，通常与稀疏编码步骤交替进行。当稀疏码 $\\{z_k\\}$ 固定时，更新字典本身就变成了一个最小二乘问题。本练习将探讨如何在傅里叶域中高效地解决这个字典更新问题，其中每个频率分量都可以被独立处理 ()。通过求解这个带正则化的最小二乘问题并施加范数约束，你将掌握构建完整卷积字典学习算法的关键一步。",
            "id": "3440972",
            "problem": "考虑对长度为 $N \\in \\mathbb{N}$ 的信号进行具有循环边界条件的一维卷积稀疏编码。令 $x \\in \\mathbb{R}^{N}$ 为一个固定信号，$\\{z_{k}\\}_{k=1}^{K} \\subset \\mathbb{R}^{N}$ 为固定的系数图。我们寻求滤波器 $\\{d_{k}\\}_{k=1}^{K} \\subset \\mathbb{R}^{N}$，使其在空间域中最小化带罚项的最小二乘目标\n$$\n\\min_{\\{d_{k}\\}} \\;\\; \\frac{1}{2}\\left\\|x - \\sum_{k=1}^{K} d_{k} * z_{k}\\right\\|_{2}^{2} \\;+\\; \\frac{\\alpha}{2} \\sum_{k=1}^{K} \\|d_{k}\\|_{2}^{2}\n\\quad \\text{服从约束} \\quad \\|d_{k}\\|_{2} = 1 \\;\\; \\text{对所有 } k \\in \\{1,\\dots,K\\},\n$$\n其中 $*$ 表示循环卷积，且给定 $\\alpha>0$。令 $\\mathcal{F}$ 表示由下式定义的酉N点离散傅里叶变换 (DFT)\n$$\n\\hat{s}(\\omega) = \\frac{1}{\\sqrt{N}} \\sum_{n=0}^{N-1} s[n] \\exp\\!\\left(-\\mathrm{i}\\,\\frac{2\\pi \\omega n}{N}\\right),\n\\quad\ns[n] = \\frac{1}{\\sqrt{N}} \\sum_{\\omega=0}^{N-1} \\hat{s}(\\omega) \\exp\\!\\left(\\mathrm{i}\\,\\frac{2\\pi \\omega n}{N}\\right),\n$$\n使得Parseval恒等式 $\\|s\\|_{2}^{2} = \\sum_{\\omega=0}^{N-1} |\\hat{s}(\\omega)|^{2}$ 精确成立，并且循环卷积在傅里叶域中变为逐点相乘。\n\n仅使用所述的变换性质、循环卷积在酉离散傅里叶变换 (DFT) 下对角化的事实，以及带有 $\\ell_{2}$ Tikhonov罚项的最小二乘法的基本原理，推导滤波器在傅里叶域中的闭式更新。具体来说，通过将问题变换到傅里叶域并求解解耦的逐频率带罚项最小二乘子问题，然后通过一个对酉DFT有效的精确归一化步骤来施加空间单位范数约束，从而获得更新后的傅里葉域滤波器 $\\{\\hat{d}_{k}^{\\mathrm{new}}(\\omega)\\}$ 关于 $\\hat{x}(\\omega)$、$\\{\\hat{z}_{k}(\\omega)\\}$ 和 $\\alpha$ 的单个解析表达式。\n\n将您的最终答案表示为 $\\hat{d}_{k}^{\\mathrm{new}}(\\omega)$ 的单个闭式表达式，该表达式仅依赖于 $\\hat{x}$、$\\{\\hat{z}_{k}\\}$ 和 $\\alpha$。不需要数值计算，也不涉及单位。",
            "solution": "该问题要求为一组滤波器 $\\{d_{k}\\}_{k=1}^{K}$ 推导闭式更新规则，这组滤波器在每个滤波器都受单位范数约束的条件下，最小化一个带罚项的最小二乘目标函数。问题陈述将Tikhonov正则化项 $\\frac{\\alpha}{2} \\sum_{k=1}^{K} \\|d_{k}\\|_{2}^{2}$ 与硬约束 $\\|d_{k}\\|_{2} = 1$ 结合起来。当硬约束有效时，正则化项变为常数 $\\frac{\\alpha K}{2}$，不影响优化过程。然而，题目指定了一个步骤：先求解带罚项的最小二乘问题，然后通过归一化施加单位范数约束。这意味着一个两步过程：首先，找到最小化无约束带罚项目标的滤波器 $\\{\\tilde{d}_{k}\\}$，其次，对这些滤波器进行归一化以获得最终结果。\n\n令无约束的滤波器表示为 $\\{\\tilde{d}_{k}\\}$。要最小化的目标函数为：\n$$ L(\\{\\tilde{d}_{k}\\}) = \\frac{1}{2}\\left\\|x - \\sum_{k=1}^{K} \\tilde{d}_{k} * z_{k}\\right\\|_{2}^{2} + \\frac{\\alpha}{2} \\sum_{k=1}^{K} \\|\\tilde{d}_{k}\\|_{2}^{2} $$\n我们将在傅里叶域中解决这个优化问题。令 $\\hat{s} = \\mathcal{F}(s)$ 表示信号 $s$ 的酉离散傅里叶变换。所提供的DFT是酉变换，因此Parseval恒等式成立：$\\|s\\|_{2}^{2} = \\|\\hat{s}\\|_{2}^{2} = \\sum_{\\omega=0}^{N-1} |\\hat{s}(\\omega)|^{2}$。该酉DFT的卷积定理是 $\\mathcal{F}(a*b)(\\omega) = \\sqrt{N}\\hat{a}(\\omega)\\hat{b}(\\omega)$。\n\n将DFT应用于目标函数，我们变换每一项。残差的 $\\ell_2$ 范数平方变为：\n$$ \\left\\|x - \\sum_{k=1}^{K} \\tilde{d}_{k} * z_{k}\\right\\|_{2}^{2} = \\left\\|\\hat{x} - \\sum_{k=1}^{K} \\sqrt{N} (\\hat{\\tilde{d}}_{k} \\odot \\hat{z}_{k})\\right\\|_{2}^{2} = \\sum_{\\omega=0}^{N-1} \\left|\\hat{x}(\\omega) - \\sqrt{N} \\sum_{k=1}^{K} \\hat{\\tilde{d}}_{k}(\\omega) \\hat{z}_{k}(\\omega)\\right|^{2} $$\n正则化项变为：\n$$ \\sum_{k=1}^{K} \\|\\tilde{d}_{k}\\|_{2}^{2} = \\sum_{k=1}^{K} \\|\\hat{\\tilde{d}}_{k}\\|_{2}^{2} = \\sum_{k=1}^{K} \\sum_{\\omega=0}^{N-1} |\\hat{\\tilde{d}}_{k}(\\omega)|^{2} $$\n结合这些，傅里叶域中的目标函数为：\n$$ L(\\{\\hat{\\tilde{d}}_{k}\\}) = \\frac{1}{2}\\sum_{\\omega=0}^{N-1} \\left|\\hat{x}(\\omega) - \\sqrt{N} \\sum_{k=1}^{K} \\hat{\\tilde{d}}_{k}(\\omega) \\hat{z}_{k}(\\omega)\\right|^{2} + \\frac{\\alpha}{2} \\sum_{k=1}^{K} \\sum_{\\omega=0}^{N-1} |\\hat{\\tilde{d}}_{k}(\\omega)|^{2} $$\n我们可以交换求和顺序，并按频率 $\\omega$ 对各项进行分组：\n$$ L(\\{\\hat{\\tilde{d}}_{k}\\}) = \\sum_{\\omega=0}^{N-1} \\left( \\frac{1}{2}\\left|\\hat{x}(\\omega) - \\sqrt{N} \\sum_{k=1}^{K} \\hat{\\tilde{d}}_{k}(\\omega) \\hat{z}_{k}(\\omega)\\right|^{2} + \\frac{\\alpha}{2} \\sum_{k=1}^{K} |\\hat{\\tilde{d}}_{k}(\\omega)|^{2} \\right) $$\n总目标函数是各个独立项的总和，每个频率 $\\omega$ 对应一项。我们可以通过相对于变量集 $\\{\\hat{\\tilde{d}}_{k}(\\omega)\\}_{k=1}^{K}$ 独立地最小化每一项 $L_{\\omega}$ 来最小化 $L$。\n对于单个频率 $\\omega$ 的目标是：\n$$ L_{\\omega}(\\{\\hat{\\tilde{d}}_{k}(\\omega)\\}) = \\frac{1}{2}\\left|\\hat{x}(\\omega) - \\sqrt{N} \\sum_{j=1}^{K} \\hat{\\tilde{d}}_{j}(\\omega) \\hat{z}_{j}(\\omega)\\right|^{2} + \\frac{\\alpha}{2} \\sum_{j=1}^{K} |\\hat{\\tilde{d}}_{j}(\\omega)|^{2} $$\n为了找到最小值，我们计算 $L_{\\omega}$ 关于 $\\overline{\\hat{\\tilde{d}}_{k}(\\omega)}$ （即 $\\hat{\\tilde{d}}_{k}(\\omega)$ 的复共轭）的复梯度，并对每个 $k \\in \\{1,\\dots,K\\}$ 将其设为零。\n使用Wirtinger微积分，$\\frac{\\partial}{\\partial z^{*}} |f(z)|^2 = f(z)\\frac{\\partial f(z)^{*}}{\\partial z^{*}}$ 以及 $\\frac{\\partial}{\\partial z^{*}} |z|^2 = z$。\n$$ \\frac{\\partial L_{\\omega}}{\\partial \\overline{\\hat{\\tilde{d}}_{k}(\\omega)}} = \\frac{1}{2} \\left( \\hat{x}(\\omega) - \\sqrt{N} \\sum_{j=1}^{K} \\hat{\\tilde{d}}_{j}(\\omega) \\hat{z}_{j}(\\omega) \\right) (-\\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)}) + \\frac{\\alpha}{2} \\hat{\\tilde{d}}_{k}(\\omega) = 0 $$\n乘以 $2$ 并重新整理得到：\n$$ \\alpha \\hat{\\tilde{d}}_{k}(\\omega) - \\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\left( \\hat{x}(\\omega) - \\sqrt{N} \\sum_{j=1}^{K} \\hat{\\tilde{d}}_{j}(\\omega) \\hat{z}_{j}(\\omega) \\right) = 0 $$\n$$ \\alpha \\hat{\\tilde{d}}_{k}(\\omega) + N \\overline{\\hat{z}_{k}(\\omega)} \\sum_{j=1}^{K} \\hat{\\tilde{d}}_{j}(\\omega) \\hat{z}_{j}(\\omega) = \\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega) $$\n这是一个关于 $K$ 个变量 $\\{\\hat{\\tilde{d}}_{k}(\\omega)\\}$ 的 $K$ 个线性方程组。令 $S(\\omega) = \\sum_{j=1}^{K} \\hat{\\tilde{d}}_{j}(\\omega) \\hat{z}_{j}(\\omega)$。关于 $\\hat{\\tilde{d}}_{k}(\\omega)$ 的方程变为：\n$$ \\alpha \\hat{\\tilde{d}}_{k}(\\omega) + N \\overline{\\hat{z}_{k}(\\omega)} S(\\omega) = \\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega) $$\n我们可以分离出 $\\hat{\\tilde{d}}_{k}(\\omega)$：\n$$ \\hat{\\tilde{d}}_{k}(\\omega) = \\frac{1}{\\alpha} \\left( \\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega) - N \\overline{\\hat{z}_{k}(\\omega)} S(\\omega) \\right) = \\frac{\\overline{\\hat{z}_{k}(\\omega)}}{\\alpha} (\\sqrt{N}\\hat{x}(\\omega) - N S(\\omega)) $$\n为了求出 $S(\\omega)$，我们将此表达式代回其定义中：\n$$ S(\\omega) = \\sum_{k=1}^{K} \\left( \\frac{\\overline{\\hat{z}_{k}(\\omega)}}{\\alpha} (\\sqrt{N}\\hat{x}(\\omega) - N S(\\omega)) \\right) \\hat{z}_{k}(\\omega) $$\n$$ S(\\omega) = \\frac{1}{\\alpha} (\\sqrt{N}\\hat{x}(\\omega) - N S(\\omega)) \\sum_{k=1}^{K} |\\hat{z}_{k}(\\omega)|^{2} $$\n令 $\\Sigma_{z}(\\omega) = \\sum_{j=1}^{K} |\\hat{z}_{j}(\\omega)|^{2}$。方程变为：\n$$ \\alpha S(\\omega) = (\\sqrt{N}\\hat{x}(\\omega) - N S(\\omega)) \\Sigma_{z}(\\omega) $$\n$$ (\\alpha + N \\Sigma_{z}(\\omega)) S(\\omega) = \\sqrt{N}\\hat{x}(\\omega)\\Sigma_{z}(\\omega) $$\n$$ S(\\omega) = \\frac{\\sqrt{N}\\hat{x}(\\omega)\\Sigma_{z}(\\omega)}{\\alpha + N \\Sigma_{z}(\\omega)} $$\n现在，我们将其代回到 $\\hat{\\tilde{d}}_{k}(\\omega)$ 的表达式中：\n$$ \\hat{\\tilde{d}}_{k}(\\omega) = \\frac{\\overline{\\hat{z}_{k}(\\omega)}}{\\alpha} \\left( \\sqrt{N}\\hat{x}(\\omega) - N \\frac{\\sqrt{N}\\hat{x}(\\omega)\\Sigma_{z}(\\omega)}{\\alpha + N \\Sigma_{z}(\\omega)} \\right) $$\n$$ \\hat{\\tilde{d}}_{k}(\\omega) = \\frac{\\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega)}{\\alpha} \\left( 1 - \\frac{N \\Sigma_{z}(\\omega)}{\\alpha + N \\Sigma_{z}(\\omega)} \\right) $$\n简化括号中的项：\n$$ 1 - \\frac{N \\Sigma_{z}(\\omega)}{\\alpha + N \\Sigma_{z}(\\omega)} = \\frac{\\alpha + N \\Sigma_{z}(\\omega) - N \\Sigma_{z}(\\omega)}{\\alpha + N \\Sigma_{z}(\\omega)} = \\frac{\\alpha}{\\alpha + N \\Sigma_{z}(\\omega)} $$\n因此，无约束滤波器系数的解为：\n$$ \\hat{\\tilde{d}}_{k}(\\omega) = \\frac{\\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega)}{\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\omega)|^{2}} $$\n第二步是通过对无约束解 $\\tilde{d}_{k}$ 进行归一化来施加单位范数约束 $\\|d_{k}\\|_{2} = 1$。更新后的滤波器 $d_{k}^{\\mathrm{new}}$ 由下式给出：\n$$ d_{k}^{\\mathrm{new}} = \\frac{\\tilde{d}_{k}}{\\|\\tilde{d}_{k}\\|_{2}} $$\n在傅里叶域中，这对应于：\n$$ \\hat{d}_{k}^{\\mathrm{new}}(\\omega) = \\frac{\\hat{\\tilde{d}}_{k}(\\omega)}{\\|\\tilde{d}_{k}\\|_{2}} $$\n使用Parseval恒等式，范数 $\\|\\tilde{d}_{k}\\|_{2}$ 可以从傅里叶系数计算得出：\n$$ \\|\\tilde{d}_{k}\\|_{2} = \\left( \\sum_{\\nu=0}^{N-1} |\\hat{\\tilde{d}}_{k}(\\nu)|^{2} \\right)^{1/2} $$\n代入 $\\hat{\\tilde{d}}_{k}(\\nu)$ 的表达式：\n$$ |\\hat{\\tilde{d}}_{k}(\\nu)|^{2} = \\frac{N |\\overline{\\hat{z}_{k}(\\nu)}|^{2} |\\hat{x}(\\nu)|^{2}}{(\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\nu)|^{2})^{2}} = \\frac{N |\\hat{z}_{k}(\\nu)|^{2} |\\hat{x}(\\nu)|^{2}}{(\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\nu)|^{2})^{2}} $$\n因此，范数为：\n$$ \\|\\tilde{d}_{k}\\|_{2} = \\left( \\sum_{\\nu=0}^{N-1} \\frac{N |\\hat{z}_{k}(\\nu)|^{2} |\\hat{x}(\\nu)|^{2}}{(\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\nu)|^{2})^{2}} \\right)^{1/2} $$\n最后，归一化滤波器更新 $\\hat{d}_{k}^{\\mathrm{new}}(\\omega)$ 的表达式是 $\\hat{\\tilde{d}}_{k}(\\omega)$ 与 $\\|\\tilde{d}_{k}\\|_{2}$ 的比值：\n$$ \\hat{d}_{k}^{\\mathrm{new}}(\\omega) = \\frac{\\frac{\\sqrt{N} \\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega)}{\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\omega)|^{2}}}{\\left( \\sum_{\\nu=0}^{N-1} \\frac{N |\\hat{z}_{k}(\\nu)|^{2} |\\hat{x}(\\nu)|^{2}}{(\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\nu)|^{2})^{2}} \\right)^{1/2}} $$\n分子和分母中的因子 $\\sqrt{N}$可以消去：\n$$ \\hat{d}_{k}^{\\mathrm{new}}(\\omega) = \\frac{\\frac{\\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega)}{\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\omega)|^{2}}}{\\left( \\sum_{\\nu=0}^{N-1} \\frac{|\\hat{z}_{k}(\\nu)|^{2} |\\hat{x}(\\nu)|^{2}}{(\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\nu)|^{2})^{2}} \\right)^{1/2}} $$\n这就是更新后的滤波器在傅里叶域中的最终闭式表达式。",
            "answer": "$$ \\boxed{ \\frac{ \\frac{\\overline{\\hat{z}_{k}(\\omega)} \\hat{x}(\\omega)}{\\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\omega)|^{2}} }{ \\left( \\sum_{\\nu=0}^{N-1} \\frac{|\\hat{z}_{k}(\\nu)|^2 |\\hat{x}(\\nu)|^2}{ \\left( \\alpha + N \\sum_{j=1}^{K} |\\hat{z}_{j}(\\nu)|^2 \\right)^2 } \\right)^{1/2} } } $$"
        },
        {
            "introduction": "理论与实践之间的一个重要差异在于如何处理信号的边界。卷积稀疏编码模型通常采用循环卷积，因为它在傅里叶域中具有优美的数学性质，但真实世界中的信号通常具有有限的、非循环的边界。本练习通过一个精心设计的思想实验，旨在量化这两种不同边界条件（循环卷积与有效卷积）所导致的稀疏编码解 $z^{\\text{circ}}$ 和 $z^{\\text{valid}}$ 之间的差异 ()。请注意，为了清晰地揭示边界效应的根本原理，该问题建立在一些理想化的假设之上；其目的不在于精确模拟真实场景，而在于通过推导误差界，让你更深刻地理解边界效应的来源及其对模型精度的影响。",
            "id": "3440968",
            "problem": "考虑一维卷积稀疏编码 (CSC) 在两种卷积边界条件下的情况：循环卷积和零填充卷积（有效卷积）。设有 $K$ 个滤波器 $\\{d_k\\}_{k=1}^{K}$，每个滤波器的长度为 $m \\in \\mathbb{N}$，且 $\\|d_k\\|_{2} = 1$，抽头上的能量呈均匀分布，具体而言：对于任意 $r \\in \\{1,\\dots,m-1\\}$ 以及任意 $r$ 个连续抽头的索引子集，该子向量的 $\\ell_{2}$ 范数等于 $\\sqrt{r/m}$。假设信号 $x \\in \\mathbb{R}^{N}$ 是由这些滤波器与稀疏编码 $\\{z_k^{\\star}\\}_{k=1}^{K}$ 进行零填充卷积而无噪声地生成的：\n$$\nx = \\sum_{k=1}^{K} d_k * z_k^{\\star},\n$$\n其中 $*$ 表示零填充（有效）卷积。稀疏编码的支撑集在索引 $\\{1,\\dots,N\\}$ 内，并满足一个分离条件：在每个滤波器索引 $k$ 内，$z_k^{\\star}$ 的非零项之间至少相隔 $m$ 个索引（因此它们生成的响应不重叠），且不同滤波器之间的支撑集在它们生成的响应中也不重叠。令 $S_{e,k} \\subset \\{1,\\dots,N\\}$ 为第 $k$ 个编码中，与任一边界相距 $m-1$ 个样本以内的索引子集（即索引在 $\\{1,\\dots,m-1\\} \\cup \\{N-m+2,\\dots,N\\}$ 中），并令 $s_{e,k} = |S_{e,k}|$。假设存在一个振幅界 $A_{\\max} = \\max_{k \\in \\{1,\\dots,K\\}} \\max_{i \\in S_{e,k}} |z_{k,i}^{\\star}|  \\infty$。\n\n定义在共同正则化参数 $\\lambda > 0$ 下的 CSC 优化问题为最小化以下凸目标函数\n$$\n\\min_{\\{z_k\\}} \\;\\frac{1}{2}\\left\\| x - \\sum_{k=1}^{K} d_k \\star z_k \\right\\|_{2}^{2} + \\lambda \\sum_{k=1}^{K} \\|z_k\\|_{1},\n$$\n其中 $\\star$ 表示所选的卷积边界条件。令 $\\{z_k^{\\text{valid}}\\}_{k=1}^{K}$ 为在零填充（有效）卷积下的最优编码集，$\\{z_k^{\\text{circ}}\\}_{k=1}^{K}$ 为在循环卷积下的最优编码集，两者均通过上述优化问题在同一信号 $x$、同一组滤波器和同一正则化参数 $\\lambda$下获得。令 $z^{\\text{valid}}$ 和 $z^{\\text{circ}}$ 表示将所有滤波器的编码串联成 $\\mathbb{R}^{KN}$ 中的单个向量。\n\n从卷积的定义、CSC 目标函数和分离假设出发，并且仅使用凸优化和 $\\ell_{1}$ 正则化最小二乘的次梯度的公认性质，推导欧几里得范数差 $\\|z^{\\text{circ}} - z^{\\text{valid}}\\|_{2}$ 的一个闭式解析上界，该上界仅依赖于滤波器长度 $m$、边界稀疏度计数 $\\{s_{e,k}\\}_{k=1}^{K}$ 和边界振幅界 $A_{\\max}$。请将您的最终界表示为关于 $m$、$\\{s_{e,k}\\}_{k=1}^{K}$ 和 $A_{\\max}$ 的单个解析表达式。不需要进行数值计算。最终答案必须是单个表达式；不要以不等式形式呈现。无需四舍五入。",
            "solution": "用户希望我推导一个闭式上界，该上界用于约束卷积稀疏编码 (CSC) 问题的两个解之间差值的欧几里得范数，这两个解是使用不同卷积边界条件得到的。\n\n### 步骤 1：形式化与设定\n\n让我们将一维卷积表示为矩阵-向量乘积。对于每个滤波器 $d_k \\in \\mathbb{R}^m$，我们可以构造一个卷积矩阵。\n令 $D_k^{\\text{valid}}$ 为零填充（有效）卷积的 $N \\times N$ 托普利兹 (Toeplitz) 矩阵。其第 $(i,j)$ 个元素为 $(D_k^{\\text{valid}})_{i,j} = d_k(i-j+1)$，当 $1 \\le i-j+1 \\le m$ 时，否则为 0。\n令 $D_k^{\\text{circ}}$ 为循环卷积的 $N \\times N$ 循环矩阵。其第 $(i,j)$ 个元素为 $(D_k^{\\text{circ}})_{i,j} = d_k(((i-j) \\pmod N)+1)$，假设 $d_k$ 和信号使用基于 1 的索引。\n\n令 $D^{\\text{valid}} = [D_1^{\\text{valid}}, \\dots, D_K^{\\text{valid}}]$ 和 $D^{\\text{circ}} = [D_1^{\\text{circ}}, \\dots, D_K^{\\text{circ}}]$ 为 $N \\times KN$ 的串联字典矩阵。令 $z = [z_1^T, \\dots, z_K^T]^T \\in \\mathbb{R}^{KN}$ 为稀疏编码的串联向量。\n\n信号是无噪声地生成的，即 $x = \\sum_{k=1}^{K} d_k * z_k^{\\star} = D^{\\text{valid}} z^{\\star}$，其中 $*$ 表示有效卷积。\n\n这两个优化问题是：\n1.  有效卷积：$\\{z_k^{\\text{valid}}\\}$ 是 $\\min_{z} \\frac{1}{2}\\|x - D^{\\text{valid}}z\\|_2^2 + \\lambda\\|z\\|_1$ 的一个解。\n2.  循环卷积：$\\{z_k^{\\text{circ}}\\}$ 是 $\\min_{z} \\frac{1}{2}\\|x - D^{\\text{circ}}z\\|_2^2 + \\lambda\\|z\\|_1$ 的一个解。\n\n令 $z^{\\text{valid}}$ 和 $z^{\\text{circ}}$ 分别为串联的解向量。我们想要找到 $\\|z^{\\text{circ}} - z^{\\text{valid}}\\|_2$ 的一个上界。\n\n### 步骤 2：字典和信号结构分析\n\n问题陈述了滤波器的“能量均匀分布”：任意 $r$ 个连续抽头的 $\\ell_2$ 范数为 $\\sqrt{r/m}$。当 $r=1$ 时，这意味着每个抽头 $d_{k,j}$ 的大小为 $|d_{k,j}| = \\sqrt{1/m} = 1/\\sqrt{m}$。这与归一化条件 $\\|d_k\\|_2 = 1$ 一致，因为 $\\sum_{j=1}^m |d_{k,j}|^2 = m \\cdot (1/m) = 1$。\n\n真实稀疏编码 $\\{z_k^{\\star}\\}$ 上的“分离条件”至关重要。它指出生成的滤波器响应不重叠。来自系数 $z_{k,i}^{\\star}$ 的响应是滤波器 $d_k$ 平移到位置 $i$，占据了信号索引 $[i, i+m-1]$。分离条件意味着对于任意两个非零系数 $z_{k,i}^{\\star}$ 和 $z_{k',j}^{\\star}$（其中 $(k,i) \\neq (k',j)$），其响应的支撑集是不相交的：$[i, i+m-1] \\cap [j, j+m-1] = \\emptyset$。一个直接的推论是，$D^{\\text{valid}}$ 中对应于 $z^{\\star}$ 支撑集的列是相互正交的。由于每个滤波器都已归一化（$\\|d_k\\|_2=1$），这些列是标准正交的。\n\n这种正交性简化了“有效”问题。由于 $x = D^{\\text{valid}}z^{\\star}$ 并且 $D^{\\text{valid}}$ 中对应于 $z^{\\star}$ 支撑集的列是标准正交的，因此有效 CSC 问题的一个解是 $z^{\\text{valid}} = z^{\\star}$，前提是 $\\lambda$ 足够小且不相干性条件成立。问题要求一个独立于 $\\lambda$ 的界，这强烈暗示我们应该在一个解很简单的区域内分析该系统。假设 $z^{\\text{valid}} = z^{\\star}$ 是最合理的简化，它允许得到一个不依赖于 $\\lambda$ 的界。这是合理的，因为 $z^{\\star}$ 是生成数据 $x$ 的真实值，并且使用了与“有效”优化问题*相同*的前向模型。\n\n在此假设下，任务简化为对 $\\|z^{\\text{circ}} - z^{\\star}\\|_2$ 进行界定。\n\n### 步骤 3：循环卷积问题分析\n\n解 $z^{\\text{circ}}$ 最小化目标函数 $J^{\\text{circ}}(z) = \\frac{1}{2}\\|x - D^{\\text{circ}}z\\|_2^2 + \\lambda\\|z\\|_1$。由于 $z^{\\text{circ}}$ 是最小化者，其目标函数值小于或等于任何其他向量的目标函数值，包括 $z^{\\star}$：\n$$J^{\\text{circ}}(z^{\\text{circ}}) \\le J^{\\text{circ}}(z^{\\star})$$\n让我们评估 $J^{\\text{circ}}(z^{\\star})$：\n$$J^{\\text{circ}}(z^{\\star}) = \\frac{1}{2}\\|x - D^{\\text{circ}}z^{\\star}\\|_2^2 + \\lambda\\|z^{\\star}\\|_1$$\n代入 $x = D^{\\text{valid}}z^{\\star}$：\n$$J^{\\text{circ}}(z^{\\star}) = \\frac{1}{2}\\|D^{\\text{valid}}z^{\\star} - D^{\\text{circ}}z^{\\star}\\|_2^2 + \\lambda\\|z^{\\star}\\|_1 = \\frac{1}{2}\\|(D^{\\text{valid}} - D^{\\text{circ}})z^{\\star}\\|_2^2 + \\lambda\\|z^{\\star}\\|_1$$\n令 $\\Delta D = D^{\\text{circ}} - D^{\\text{valid}}$。那么 $J^{\\text{circ}}(z^{\\star}) = \\frac{1}{2}\\|\\Delta D z^{\\star}\\|_2^2 + \\lambda\\|z^{\\star}\\|_1$。\n\n循环卷积矩阵和有效卷积矩阵之差 $\\Delta D$ 仅在对应于信号边界的行和列上非零。如果滤波器 $d_k$ 平移 $j-1$ 后的支撑集完全包含在 $[1, N]$ 内，则 $D_k^{\\text{valid}}$ 和 $D_k^{\\text{circ}}$ 的第 $j$ 列是相同的。这对于 $j \\in \\{m, \\dots, N-m+1\\}$ 成立。因此，$\\Delta D z^{\\star}$ 仅取决于 $z^{\\star}$ 在边界索引处的分量。对于编码 $z_k$，这些“边界有效”索引的集合是 $S_{e,k}$。\n\n扰动项 $\\Delta D z^{\\star}$ 是 $z^{\\text{circ}}$ 和 $z^{\\star}$ 之间差异的来源。在许多稳定性分析中，解的误差范数与扰动范数在同一数量级。因此，我们将通过界定扰动项的范数 $\\|\\Delta D z^{\\star}\\|_2$ 来建立 $\\|z^{\\text{circ}} - z^{\\star}\\|_2$ 的上界。\n\n### 步骤 4：界定扰动范数\n\n总扰动是来自每个滤波器的扰动之和：$\\Delta D z^{\\star} = \\sum_{k=1}^K \\Delta D_k z_k^{\\star}$。由于响应支撑集的分离性，对于不同的 $k$，向量 $\\Delta D_k z_k^{\\star}$ 具有不相交的支撑集。因此，和的平方范数等于平方范数之和：\n$$\\|\\Delta D z^{\\star}\\|_2^2 = \\sum_{k=1}^K \\|\\Delta D_k z_k^{\\star}\\|_2^2$$\n让我们分析单个滤波器 $k$ 的项：$\\|\\Delta D_k z_k^{\\star}\\|_2^2$。向量 $\\delta_k = \\Delta D_k z_k^{\\star}$ 仅在信号边界附近具有非零项，即索引 $i \\in \\{1,\\dots,m-1\\}$ 和 $i \\in \\{N-m+2,\\dots,N\\}$。\n让我们分析“头部”部分，对于 $i \\in \\{1, \\dots, m-1\\}$。$\\delta_k$ 的第 $i$ 个分量是由 $z_k^{\\star}$ 右边界的环绕效应引起的：\n$$(\\delta_k)_i = \\sum_{j=1}^N (\\Delta D_k)_{i,j} z_{k,j}^{\\star} = \\sum_{j=N-m+2}^N (D_k^{\\text{circ}})_{i,j} z_{k,j}^{\\star}$$\n令 $S_{e,k,R}^{\\star}$ 为 $z_k^{\\star}$ 在右边界索引 $\\{N-m+2, \\dots, N\\}$ 上的支撑集，其基数为 $s_{e,k,R} = |S_{e,k,R}^{\\star}|$。令 $S_{e,k,L}^{\\star}$ 为在左边界索引 $\\{1, \\dots, m-1\\}$ 上的支撑集，其基数为 $s_{e,k,L} = |S_{e,k,L}^{\\star}|$。我们有 $s_{e,k,L} + s_{e,k,R} \\le s_{e,k}$。\n令 $v_{k,j}$ 为 $\\Delta D_k$ 的第 $j$ 列。那么 $\\delta_k = \\sum_{j \\in \\text{supp}(z_k^\\star)} z_{k,j}^\\star v_{k,j}$。\n向量 $\\delta_k$ 可以分为头部（支撑于 $i \\in \\{1, \\dots, m-1\\}$）和尾部（支撑于 $i \\in \\{N-m+2, \\dots, N\\}$）。\n让我们界定头部部分的范数。根据三角不等式和范数的性质：\n$$\\|\\delta_{k, \\text{head}}\\|_2 = \\left\\| \\sum_{j \\in S_{e,k,R}^\\star} z_{k,j}^{\\star} (v_{k,j})_{\\text{head}} \\right\\|_2 \\le \\sum_{j \\in S_{e,k,R}^\\star} |z_{k,j}^{\\star}| \\|(v_{k,j})_{\\text{head}}\\|_2$$\n使用给定的振幅界，对于 $j \\in S_{e,k}$ 有 $|z_{k,j}^{\\star}| \\le A_{\\max}$。\n$$\\|\\delta_{k, \\text{head}}\\|_2 \\le A_{\\max} \\sum_{j \\in S_{e,k,R}^\\star} \\|(v_{k,j})_{\\text{head}}\\|_2$$\n向量 $(v_{k,j})_{\\text{head}}$ 是 $\\Delta D_k$ 第 $j$ 列中对应于第 1 行到第 $m-1$ 行的部分。其元素为 $i=1,\\dots,m-1$ 时的 $(D_k^{\\text{circ}})_{i,j}$。对于靠近右边界的 $j$，比如 $j=N-p$（其中 $p=0, \\dots, m-2$），该向量的非零项是 $d_k$ 的一个子向量（或其反转）。$d_k$ 的这个子向量的范数最多是 $d_k$ 本身的范数，即 1。一个更紧的界来自问题的能量分布特性。$D_k^{\\text{circ}}$ 的第 $j$ 列是 $d_k$ 的一个移位版本。“环绕”的部分由 $d_k$ 的抽头组成。$(v_{k,j})_{\\text{head}}$ 的平方范数是 $d_k$ 某些抽头的平方和。它最多是 $m-1$ 个抽头的平方范数，即 $\\frac{m-1}{m}$。因此，$\\|(v_{k,j})_{\\text{head}}\\|_2 \\le \\sqrt{\\frac{m-1}{m}}$。\n\n对每一列使用这个统一的界：\n$$\\|\\delta_{k, \\text{head}}\\|_2 \\le A_{\\max} \\, s_{e,k,R} \\sqrt{\\frac{m-1}{m}}$$\n类似地，对于依赖于左边界上 $z_k^\\star$ 的尾部：\n$$\\|\\delta_{k, \\text{tail}}\\|_2 \\le A_{\\max} \\, s_{e,k,L} \\sqrt{\\frac{m-1}{m}}$$\n由于头部和尾部具有不相交的支撑集：\n$$\\|\\Delta D_k z_k^{\\star}\\|_2^2 = \\|\\delta_{k, \\text{head}}\\|_2^2 + \\|\\delta_{k, \\text{tail}}\\|_2^2 \\le A_{\\max}^2 \\frac{m-1}{m} (s_{e,k,R}^2 + s_{e,k,L}^2)$$\n我们已知 $s_{e,k}$，它是 $s_{e,k,R} + s_{e,k,L}$ 的一个上界。我们知道对于非负数，$a^2+b^2 \\le (a+b)^2$。因此，$s_{e,k,R}^2 + s_{e,k,L}^2 \\le (s_{e,k,R} + s_{e,k,L})^2 \\le s_{e,k}^2$。\n$$\\|\\Delta D_k z_k^{\\star}\\|_2^2 \\le A_{\\max}^2 s_{e,k}^2 \\frac{m-1}{m}$$\n对所有滤波器 $k$ 求和：\n$$\\|\\Delta D z^{\\star}\\|_2^2 = \\sum_{k=1}^K \\|\\Delta D_k z_k^{\\star}\\|_2^2 \\le A_{\\max}^2 \\frac{m-1}{m} \\sum_{k=1}^K s_{e,k}^2$$\n取平方根得到扰动范数的界：\n$$\\|\\Delta D z^{\\star}\\|_2 \\le A_{\\max} \\sqrt{\\frac{m-1}{m} \\sum_{k=1}^K s_{e,k}^2}$$\n基于误差范数 $\\|z^{\\text{circ}} - z^{\\text{valid}}\\|_2$ 受扰动范数界定的推理，我们采用此式作为我们的最终上界。该表达式仅依赖于 $m$, $A_{\\max}$ 和 $\\{s_{e,k}\\}_{k=1}^K$，符合要求。\n\n$\\|z^{\\text{circ}} - z^{\\text{valid}}\\|_{2}$ 的上界的最终表达式为：\n$$A_{\\max} \\sqrt{\\frac{m-1}{m} \\sum_{k=1}^{K} s_{e,k}^{2}}$$",
            "answer": "$$\n\\boxed{A_{\\max} \\sqrt{\\frac{m-1}{m} \\sum_{k=1}^{K} s_{e,k}^{2}}}\n$$"
        }
    ]
}