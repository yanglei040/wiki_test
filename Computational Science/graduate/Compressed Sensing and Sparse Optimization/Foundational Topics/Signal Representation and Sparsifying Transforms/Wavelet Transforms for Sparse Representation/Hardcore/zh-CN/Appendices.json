{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习旨在通过逐步演示离散小波变换 (DWT) 的核心机理，为您打下坚实的基础。通过将Haar小波的分析滤波器手动应用于一个简单的分段常数信号，您将直接观察到该变换如何将信号分解为近似（局部平均）和细节（局部差异）分量。这项动手计算对于培养DWT如何实现稀疏表示的直观理解至关重要，因为您会发现该信号的大部分细节系数都将变为零 。",
            "id": "3493857",
            "problem": "考虑一个长度为$16$的实值离散时间信号$x[n]$，其定义在$n \\in \\{0,1,\\dots,15\\}$上，序列如下\n$$\nx = \\left[5,\\,5,\\,5,\\,5,\\,2,\\,2,\\,2,\\,2,\\,0,\\,0,\\,8,\\,8,\\,8,\\,8,\\,8,\\,8\\right].\n$$\n设标准正交双通道滤波器组的分析滤波器为 Haar 滤波器\n$$\nh = \\left[\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right], \\qquad g = \\left[\\frac{1}{\\sqrt{2}},\\, -\\frac{1}{\\sqrt{2}}\\right],\n$$\n并在需要时使用对称边界延拓。进行两层的离散小波变换 (DWT)，定义如下：1级近似系数和细节系数为\n$$\na_{1}[n] = h_{0}\\,x[2n] + h_{1}\\,x[2n+1], \\qquad d_{1}[n] = g_{0}\\,x[2n] + g_{1}\\,x[2n+1],\n$$\n其中$n = 0,1,\\dots,7$。2级系数通过将相同的$h$和$g$应用于1级近似$a_{1}$得到：\n$$\na_{2}[n] = h_{0}\\,a_{1}[2n] + h_{1}\\,a_{1}[2n+1], \\qquad d_{2}[n] = g_{0}\\,a_{1}[2n] + g_{1}\\,a_{1}[2n+1],\n$$\n其中$n = 0,1,2,3$。\n\n执行这些计算，并报告三个子带系数向量$a_{2}$、$d_{2}$和$d_{1}$。最后，计算2级细节子带的总能量，\n$$\nE_{d_{2}} = \\sum_{n=0}^{3} \\left(d_{2}[n]\\right)^{2},\n$$\n并将该值作为最终答案。最终答案应表示为实数，不进行四舍五入。",
            "solution": "问题要求对给定的离散时间信号$x[n]$进行两层离散小波变换 (DWT) 计算，并随后计算2级细节系数的能量。该信号长度为$N=16$，序列如下：\n$$x = \\left[5,\\,5,\\,5,\\,5,\\,2,\\,2,\\,2,\\,2,\\,0,\\,0,\\,8,\\,8,\\,8,\\,8,\\,8,\\,8\\right]$$\n标准正交 Haar 小波变换的分析滤波器是低通滤波器$h$和高通滤波器$g$：\n$$h = \\left[\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right] \\quad \\implies \\quad h_0 = \\frac{1}{\\sqrt{2}}, h_1 = \\frac{1}{\\sqrt{2}}$$\n$$g = \\left[\\frac{1}{\\sqrt{2}},\\, -\\frac{1}{\\sqrt{2}}\\right] \\quad \\implies \\quad g_0 = \\frac{1}{\\sqrt{2}}, g_1 = -\\frac{1}{\\sqrt{2}}$$\n问题指明边界效应通过对称延拓处理，但考虑到滤波器长度为$2$且信号长度是2的幂，本次特定计算不需要进行延拓。\n\n首先，我们计算$n \\in \\{0, 1, \\dots, 7\\}$的1级近似系数$a_1[n]$和细节系数$d_1[n]$。控制方程为：\n$$a_{1}[n] = h_{0}\\,x[2n] + h_{1}\\,x[2n+1] = \\frac{1}{\\sqrt{2}}(x[2n] + x[2n+1])$$\n$$d_{1}[n] = g_{0}\\,x[2n] + g_{1}\\,x[2n+1] = \\frac{1}{\\sqrt{2}}(x[2n] - x[2n+1])$$\n我们按如下方式计算每个系数：\n$a_1[0] = \\frac{1}{\\sqrt{2}}(x[0]+x[1]) = \\frac{1}{\\sqrt{2}}(5+5) = \\frac{10}{\\sqrt{2}} = 5\\sqrt{2}$\n$d_1[0] = \\frac{1}{\\sqrt{2}}(x[0]-x[1]) = \\frac{1}{\\sqrt{2}}(5-5) = 0$\n$a_1[1] = \\frac{1}{\\sqrt{2}}(x[2]+x[3]) = \\frac{1}{\\sqrt{2}}(5+5) = \\frac{10}{\\sqrt{2}} = 5\\sqrt{2}$\n$d_1[1] = \\frac{1}{\\sqrt{2}}(x[2]-x[3]) = \\frac{1}{\\sqrt{2}}(5-5) = 0$\n$a_1[2] = \\frac{1}{\\sqrt{2}}(x[4]+x[5]) = \\frac{1}{\\sqrt{2}}(2+2) = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n$d_1[2] = \\frac{1}{\\sqrt{2}}(x[4]-x[5]) = \\frac{1}{\\sqrt{2}}(2-2) = 0$\n$a_1[3] = \\frac{1}{\\sqrt{2}}(x[6]+x[7]) = \\frac{1}{\\sqrt{2}}(2+2) = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n$d_1[3] = \\frac{1}{\\sqrt{2}}(x[6]-x[7]) = \\frac{1}{\\sqrt{2}}(2-2) = 0$\n$a_1[4] = \\frac{1}{\\sqrt{2}}(x[8]+x[9]) = \\frac{1}{\\sqrt{2}}(0+0) = 0$\n$d_1[4] = \\frac{1}{\\sqrt{2}}(x[8]-x[9]) = \\frac{1}{\\sqrt{2}}(0-0) = 0$\n$a_1[5] = \\frac{1}{\\sqrt{2}}(x[10]+x[11]) = \\frac{1}{\\sqrt{2}}(8+8) = \\frac{16}{\\sqrt{2}} = 8\\sqrt{2}$\n$d_1[5] = \\frac{1}{\\sqrt{2}}(x[10]-x[11]) = \\frac{1}{\\sqrt{2}}(8-8) = 0$\n$a_1[6] = \\frac{1}{\\sqrt{2}}(x[12]+x[13]) = \\frac{1}{\\sqrt{2}}(8+8) = \\frac{16}{\\sqrt{2}} = 8\\sqrt{2}$\n$d_1[6] = \\frac{1}{\\sqrt{2}}(x[12]-x[13]) = \\frac{1}{\\sqrt{2}}(8-8) = 0$\n$a_1[7] = \\frac{1}{\\sqrt{2}}(x[14]+x[15]) = \\frac{1}{\\sqrt{2}}(8+8) = \\frac{16}{\\sqrt{2}} = 8\\sqrt{2}$\n$d_1[7] = \\frac{1}{\\sqrt{2}}(x[14]-x[15]) = \\frac{1}{\\sqrt{2}}(8-8) = 0$\n\n得到的1级系数向量为：\n$$a_1 = \\left[5\\sqrt{2},\\, 5\\sqrt{2},\\, 2\\sqrt{2},\\, 2\\sqrt{2},\\, 0,\\, 8\\sqrt{2},\\, 8\\sqrt{2},\\, 8\\sqrt{2}\\right]$$\n$$d_1 = \\left[0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0\\right]$$\n\n接下来，我们通过将相同的滤波器应用于1级近似向量$a_1$来计算2级系数。对于$n \\in \\{0, 1, 2, 3\\}$，2级近似系数$a_2[n]$和细节系数$d_2[n]$的计算如下：\n$$a_{2}[n] = h_{0}\\,a_{1}[2n] + h_{1}\\,a_{1}[2n+1] = \\frac{1}{\\sqrt{2}}(a_{1}[2n] + a_{1}[2n+1])$$\n$$d_{2}[n] = g_{0}\\,a_{1}[2n] + g_{1}\\,a_{1}[2n+1] = \\frac{1}{\\sqrt{2}}(a_{1}[2n] - a_{1}[2n+1])$$\n我们计算每个系数：\n$a_2[0] = \\frac{1}{\\sqrt{2}}(a_1[0]+a_1[1]) = \\frac{1}{\\sqrt{2}}(5\\sqrt{2}+5\\sqrt{2}) = \\frac{1}{\\sqrt{2}}(10\\sqrt{2}) = 10$\n$d_2[0] = \\frac{1}{\\sqrt{2}}(a_1[0]-a_1[1]) = \\frac{1}{\\sqrt{2}}(5\\sqrt{2}-5\\sqrt{2}) = 0$\n$a_2[1] = \\frac{1}{\\sqrt{2}}(a_1[2]+a_1[3]) = \\frac{1}{\\sqrt{2}}(2\\sqrt{2}+2\\sqrt{2}) = \\frac{1}{\\sqrt{2}}(4\\sqrt{2}) = 4$\n$d_2[1] = \\frac{1}{\\sqrt{2}}(a_1[2]-a_1[3]) = \\frac{1}{\\sqrt{2}}(2\\sqrt{2}-2\\sqrt{2}) = 0$\n$a_2[2] = \\frac{1}{\\sqrt{2}}(a_1[4]+a_1[5]) = \\frac{1}{\\sqrt{2}}(0+8\\sqrt{2}) = \\frac{1}{\\sqrt{2}}(8\\sqrt{2}) = 8$\n$d_2[2] = \\frac{1}{\\sqrt{2}}(a_1[4]-a_1[5]) = \\frac{1}{\\sqrt{2}}(0-8\\sqrt{2}) = -8$\n$a_2[3] = \\frac{1}{\\sqrt{2}}(a_1[6]+a_1[7]) = \\frac{1}{\\sqrt{2}}(8\\sqrt{2}+8\\sqrt{2}) = \\frac{1}{\\sqrt{2}}(16\\sqrt{2}) = 16$\n$d_2[3] = \\frac{1}{\\sqrt{2}}(a_1[6]-a_1[7]) = \\frac{1}{\\sqrt{2}}(8\\sqrt{2}-8\\sqrt{2}) = 0$\n\n按要求计算出的子带系数向量为：\n$$a_2 = \\left[10,\\, 4,\\, 8,\\, 16\\right]$$\n$$d_2 = \\left[0,\\, 0,\\, -8,\\, 0\\right]$$\n$$d_1 = \\left[0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0\\right]$$\n\n最后，我们计算2级细节子带的总能量$E_{d_{2}}$：\n$$E_{d_{2}} = \\sum_{n=0}^{3} \\left(d_{2}[n]\\right)^{2}$$\n代入$d_2$向量的值：\n$$E_{d_{2}} = (0)^{2} + (0)^{2} + (-8)^{2} + (0)^{2} = 0 + 0 + 64 + 0 = 64$$\n2级细节子带的能量是$64$。",
            "answer": "$$\\boxed{64}$$"
        },
        {
            "introduction": "在一维变换的基础上，本练习将小波分解的概念扩展到二维信号（例如图像）。您将对一个包含明显水平边缘的小图像块应用可分离的Haar DWT。这项实践将展示二维DWT如何根据特征的方向对其进行有效分离，将信号能量分配到水平、垂直和对角等不同的细节子带中，这是图像压缩和分析的基石 。",
            "id": "3493867",
            "problem": "考虑在一个小图像块上使用哈尔(Haar)小波进行二维离散小波变换(DWT)。哈尔(Haar)尺度滤波器和小波滤波器分别定义为 $h = \\left[\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right]$ 和 $g = \\left[\\frac{1}{\\sqrt{2}}, -\\frac{1}{\\sqrt{2}}\\right]$。该二维变换是可分离应用的：首先将每一行与 $h$ 和 $g$ 进行卷积，并沿水平维度进行2倍下采样，得到行的低通和高通两部分；接下来，将这两部分的每一列与 $h$ 和 $g$ 进行卷积，并沿垂直维度进行2倍下采样，得到四个1级子带。使用惯例，$LL$ 表示先沿行低通再沿列低通，$LH$ 表示先沿行低通再沿列高通，$HL$ 表示先沿行高通再沿列低通，$HH$ 表示先沿行高通再沿列高通。2级变换仅通过对 $LL_{1}$ 子带应用相同的可分离操作来形成。\n\n设图像块为\n$$\nX = \\begin{pmatrix}\n4  4  4  4 \\\\\n4  4  4  4 \\\\\n0  0  0  0 \\\\\n0  0  0  0\n\\end{pmatrix}.\n$$\n计算哈尔(Haar) DWT系数的前两个尺度（级）：1级子带 $LL_{1}$、$LH_{1}$、$HL_{1}$、$HH_{1}$（每个大小为 $2 \\times 2$）和2级子带 $LL_{2}$、$LH_{2}$、$HL_{2}$、$HH_{2}$（每个为标量）。对于每个子带，将其能量定义为其系数的平方和。设主导细节子带为 $\\{LH_{1}, HL_{1}, HH_{1}, LH_{2}, HL_{2}, HH_{2}\\}$ 中能量最大的子带。设 $E_{\\text{total}}$ 为 $X$ 中所有16个元素的平方和。定义\n$$\nS \\triangleq \\frac{E_{\\text{dominant detail}}}{E_{\\text{total}}}.\n$$\n提供 $S$ 的值作为你的最终答案。将最终答案表示为四舍五入到四位有效数字的小数。",
            "solution": "用户希望计算 $S$ 的值，$S$ 定义为主导细节小波子带的能量与图像块 $X$ 总能量的比值。\n\n### 步骤1：问题验证\n\n问题陈述提供了进行两级二维离散哈尔(Haar)小波变换(DWT)所需的所有信息。\n- **已知条件**：\n    - 哈尔(Haar)尺度滤波器 $h = \\left[\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right]$。\n    - 哈尔(Haar)小波滤波器 $g = \\left[\\frac{1}{\\sqrt{2}}, -\\frac{1}{\\sqrt{2}}\\right]$。\n    - 图像块 $X = \\begin{pmatrix} 4  4  4  4 \\\\ 4  4  4  4 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}$。\n    - 一个清晰的、可分离的二维DWT过程。\n    - 2级变换仅应用于1级近似子带($LL_1$) 。\n    - 子带能量、主导细节子带、$E_{\\text{total}}$ 以及最终量 $S$ 的定义。\n\n- **验证**：\n    - 该问题在科学上基于小波变换理论，这是信号处理和应用数学中的一个标准课题。\n    - 这是一个适定问题，可以从所提供的数据和定义中推导出唯一解。\n    - 语言客观且无歧义。\n    - 所有数据和约束条件都是一致且充分的。\n    \n问题有效。\n\n### 步骤2：计算总能量 $E_{\\text{total}}$\n\n总能量 $E_{\\text{total}}$ 是图像块 $X$ 中所有像素值的平方和。\n矩阵 $X$ 有8个值为4的元素和8个值为0的元素。\n$$\nE_{\\text{total}} = \\sum_{i=1}^{4} \\sum_{j=1}^{4} X_{ij}^2 = 8 \\times 4^2 + 8 \\times 0^2 = 8 \\times 16 = 128.\n$$\n\n### 步骤3：1级二维DWT计算\n\n变换是可分离应用的：首先沿行，然后沿列。一对值 $(a, b)$ 的一维哈尔(Haar)变换产生一个低通（平均）系数 $c_L = \\frac{a+b}{\\sqrt{2}}$ 和一个高通（细节）系数 $c_H = \\frac{a-b}{\\sqrt{2}}$。\n\n**3.1：行变换**\n我们对 $X$ 的每一行应用一维哈尔(Haar)变换。对于长度为4的行，我们变换第一对元素和第二对元素。\n\n- 对于第1行和第2行，即 $[4, 4, 4, 4]$：\n  - 低通系数：$\\left[\\frac{4+4}{\\sqrt{2}}, \\frac{4+4}{\\sqrt{2}}\\right] = [4\\sqrt{2}, 4\\sqrt{2}]$。\n  - 高通系数：$\\left[\\frac{4-4}{\\sqrt{2}}, \\frac{4-4}{\\sqrt{2}}\\right] = [0, 0]$。\n\n- 对于第3行和第4行，即 $[0, 0, 0, 0]$：\n  - 低通系数：$\\left[\\frac{0+0}{\\sqrt{2}}, \\frac{0+0}{\\sqrt{2}}\\right] = [0, 0]$。\n  - 高通系数：$\\left[\\frac{0-0}{\\sqrt{2}}, \\frac{0-0}{\\sqrt{2}}\\right] = [0, 0]$。\n\n行变换后，我们得到一个 $4 \\times 2$ 的低通结果矩阵 $X_L$ 和一个 $4 \\times 2$ 的高通结果矩阵 $X_H$。\n$$\nX_L = \\begin{pmatrix} 4\\sqrt{2}  4\\sqrt{2} \\\\ 4\\sqrt{2}  4\\sqrt{2} \\\\ 0  0 \\\\ 0  0 \\end{pmatrix}, \\quad X_H = \\begin{pmatrix} 0  0 \\\\ 0  0 \\\\ 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n\n**3.2：列变换**\n接下来，我们对 $X_L$ 和 $X_H$ 的列应用一维哈尔(Haar)变换。\n\n- **变换 $X_L$**：\n  - $X_L$ 的列是相同的：$[4\\sqrt{2}, 4\\sqrt{2}, 0, 0]^T$。\n  - 低通系数（对每列）：$\\left[\\frac{4\\sqrt{2}+4\\sqrt{2}}{\\sqrt{2}}, \\frac{0+0}{\\sqrt{2}}\\right] = [8, 0]$。\n  - 高通系数（对每列）：$\\left[\\frac{4\\sqrt{2}-4\\sqrt{2}}{\\sqrt{2}}, \\frac{0-0}{\\sqrt{2}}\\right] = [0, 0]$。\n  - 结果构成了 $LL_1$ 和 $LH_1$ 子带：\n    $$\n    LL_1 = \\begin{pmatrix} 8  8 \\\\ 0  0 \\end{pmatrix}, \\quad LH_1 = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n    $$\n\n- **变换 $X_H$**：\n  - 由于 $X_H$ 是一个零矩阵，对其列应用变换将得到零系数。\n  - 这产生了 $HL_1$ 和 $HH_1$ 子带：\n    $$\n    HL_1 = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}, \\quad HH_1 = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n    $$\n\n### 步骤4：2级二维DWT计算\n\n2级变换仅应用于 $LL_1$ 子带。\n输入：$LL_1 = \\begin{pmatrix} 8  8 \\\\ 0  0 \\end{pmatrix}$。\n\n**4.1：对 $LL_1$ 进行行变换**\n- 对于第1行 $[8, 8]$：\n  - 低通系数：$\\frac{8+8}{\\sqrt{2}} = 8\\sqrt{2}$。\n  - 高通系数：$\\frac{8-8}{\\sqrt{2}} = 0$。\n- 对于第2行 $[0, 0]$：\n  - 低通系数：$\\frac{0+0}{\\sqrt{2}} = 0$。\n  - 高通系数：$\\frac{0-0}{\\sqrt{2}} = 0$。\n\n这给出了一个 $2 \\times 1$ 的低通结果向量和一个 $2 \\times 1$ 的高通结果向量。\n\n**4.2：列变换**\n- 变换低通向量 $[8\\sqrt{2}, 0]^T$：\n  - 低通系数 ($LL_2$)：$\\frac{8\\sqrt{2}+0}{\\sqrt{2}} = 8$。\n  - 高通系数 ($LH_2$)：$\\frac{8\\sqrt{2}-0}{\\sqrt{2}} = 8$。\n- 变换高通向量 $[0, 0]^T$：\n  - 低通系数 ($HL_2$)：$\\frac{0+0}{\\sqrt{2}} = 0$。\n  - 高通系数 ($HH_2$)：$\\frac{0-0}{\\sqrt{2}} = 0$。\n\n2级子带系数（每个都是标量）为：\n$LL_2 = 8$，$LH_2 = 8$，$HL_2 = 0$，$HH_2 = 0$。\n\n### 步骤5：确定主导细节子带\n\n我们需要在 $\\{LH_1, HL_1, HH_1, LH_2, HL_2, HH_2\\}$ 中找到能量最大的子带。子带的能量是其系数的平方和。\n\n- $E(LH_1) = 0^2+0^2+0^2+0^2 = 0$。\n- $E(HL_1) = 0^2+0^2+0^2+0^2 = 0$。\n- $E(HH_1) = 0^2+0^2+0^2+0^2 = 0$。\n- $E(LH_2) = 8^2 = 64$。\n- $E(HL_2) = 0^2 = 0$。\n- $E(HH_2) = 0^2 = 0$。\n\n细节子带中的最大能量是 $64$，属于 $LH_2$。因此，主导细节能量为 $E_{\\text{dominant detail}} = 64$。\n\n### 步骤6：计算最终值 $S$\n\n量 $S$ 定义为主导细节能量与总能量的比值。\n$$\nS = \\frac{E_{\\text{dominant detail}}}{E_{\\text{total}}} = \\frac{64}{128} = \\frac{1}{2} = 0.5.\n$$\n问题要求答案为四舍五入到四位有效数字的小数。\n$$\nS = 0.5000.\n$$",
            "answer": "$$\\boxed{0.5000}$$"
        },
        {
            "introduction": "为了在压缩感知等高级应用中充分利用变换，我们必须超越滤波的视角，将其视为向量空间中的标准正交基。这项计算实践要求您构建离散傅里叶变换 (DFT) 和Haar DWT 的完整矩阵表示。通过计算这两个基之间的互非相干性，您将对离散环境下的“不确定性原理”有定量的理解，并亲眼见证为何在小波域中稀疏的信号在傅里叶域中会呈现为密集且扩展的形式 。",
            "id": "3493805",
            "problem": "给定一个整数 $n$，满足 $n = 2^J$，其中 $J \\geq 1$ 为某个整数。令 $F \\in \\mathbb{C}^{n \\times n}$ 表示酉离散傅里叶变换（DFT）矩阵，令 $W \\in \\mathbb{R}^{n \\times n}$ 表示标准正交 Haar 离散小波变换（DWT）矩阵。您的任务是从第一性原理出发，数值上构造 $F$ 和 $W$，计算这两个标准正交基之间的经验互相关，并描述相关值在不同 Haar 小波尺度上的分布情况。\n\n用作起点的基本定义：\n- 酉离散傅里叶变换（DFT）矩阵 $F$ 的元素为\n$$\nF_{t,k} = \\frac{1}{\\sqrt{n}} \\exp\\left(2\\pi i \\frac{t k}{n}\\right),\n\\quad t, k \\in \\{0,1,\\dots,n-1\\}.\n$$\n- 标准正交 Haar 离散小波变换（DWT）矩阵 $W$ 由 $n$ 个标准正交列向量组成。其中一列是尺度向量 $\\phi \\in \\mathbb{R}^n$，其元素对所有 $t$ 均为 $\\phi[t] = \\frac{1}{\\sqrt{n}}$。对于每个尺度 $s \\in \\{1,2,\\dots,J\\}$，其支撑长度为 $L_s = 2^s$，存在 $n / L_s$ 个小波原子 $\\{\\psi_{s,k}\\}_{k=0}^{n/L_s - 1}$，其中每个 $\\psi_{s,k} \\in \\mathbb{R}^n$ 定义为\n$$\n\\psi_{s,k}[t] =\n\\begin{cases}\n+\\frac{1}{\\sqrt{L_s}},  t \\in \\{k L_s, k L_s + 1, \\dots, k L_s + \\frac{L_s}{2} - 1\\}, \\\\\n-\\frac{1}{\\sqrt{L_s}},  t \\in \\{k L_s + \\frac{L_s}{2}, k L_s + \\frac{L_s}{2}+1, \\dots, (k+1)L_s - 1\\}, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n这些向量在标准欧几里得内积下是标准正交的，并且与 $\\phi$ 一起构成了 $\\mathbb{R}^n$ 的一个完备标准正交基。\n\n待计算量的定义：\n- 两个标准正交基 $U, V \\in \\mathbb{C}^{n \\times n}$（其列向量为 $\\{u_i\\}$ 和 $\\{v_j\\}$）之间的互相关为\n$$\n\\mu(U,V) = \\max_{0 \\leq i,j  n} \\left| \\langle u_i, v_j \\rangle \\right|.\n$$\n- 令 $C = F^* W \\in \\mathbb{C}^{n \\times n}$，其中 $F^*$ 表示 $F$ 的共轭转置。矩阵 $C$ 汇集了所有成对的内积 $\\langle f_i, w_j \\rangle$。那么经验互相关为\n$$\n\\hat{\\mu} = \\max_{i,j} |C_{i,j}|.\n$$\n- 对于一个 Haar 小波尺度 $s \\in \\{1,2,\\dots,J\\}$，定义 $\\mathcal{J}_s$ 为 $W$ 中对应于尺度 $s$ 的小波原子的列索引集合。同时定义 $\\mathcal{J}_0$ 为包含尺度向量 $\\phi$ 索引的单元素集。对于每个列 $j \\in \\mathcal{J}_s$，定义其与 DFT 基的经验相关为\n$$\n\\gamma_j = \\max_{0 \\leq i  n} |C_{i,j}|.\n$$\n这产生了一个按尺度划分的集合 $\\{\\gamma_j : j \\in \\mathcal{J}_s\\}$，其在尺度 $s$ 上的分布可以通过其均值和最大值来概括。\n\n程序任务：\n1. 根据上述定义，为给定的 $n$ 数值上构造 $F$ 和 $W$。\n2. 通过检查 $F^* F \\approx I_n$ 和 $W^\\top W \\approx I_n$ 来数值上验证 $F$ 是酉矩阵、$W$ 是标准正交矩阵，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n3. 计算 $C = F^* W$ 和经验互相关 $\\hat{\\mu} = \\max_{i,j} |C_{i,j}|$。\n4. 对于每个尺度 $s \\in \\{0,1,2,\\dots,J\\}$，计算集合 $\\{\\gamma_j : j \\in \\mathcal{J}_s\\}$，并通过其均值和最大值进行总结。\n5. 数值稳定性和归一化：确保 $F$ 精确地是酉矩阵，并且 Haar 原子精确地按照规定进行归一化。所有内积都是相对于标准的复欧几里得内积计算的。\n6. 测试套件和覆盖范围：\n   - 使用测试套件 $n \\in \\{2, 8, 32\\}$，以覆盖一个基可能重合的极端小案例、一个小规模多尺度案例和一个中等规模多尺度案例。\n7. 输出规范：\n   - 对于测试套件中的每个 $n$，生成一个包含四个项目的列表：整数 $n$、浮点数 $\\hat{\\mu}$、按尺度划分的均值列表 $[\\text{mean}_s]_{s=0}^J$ 和按尺度划分的最大值列表 $[\\text{max}_s]_{s=0}^J$。其中，尺度 $s=0$ 表示尺度向量，尺度 $s=1,\\dots,J$ 表示从最细到最粗排序的小波尺度。\n   - 在输出前，将所有浮点值四舍五入到 $12$ 位小数。\n   - 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为用方括号括起来的逗号分隔列表。具体来说，最终输出必须是一个长度为 $3$ 的单个列表，其中每个元素是上述的针对每个 $n$ 的列表，例如 $[\\text{case}_1, \\text{case}_2, \\text{case}_3]$。\n   - 不涉及物理单位或角度；所有输出都是无量纲的实数。",
            "solution": "用户提供的问题被评估为**有效**。它在科学上基于傅里叶和小波分析的原理，定义清晰一致，问题提出得当，并且其表述是客观的。任务是数值化地实现并分析信号处理中两个基本标准正交基之间的关系。\n\n问题的核心是量化离散傅里叶变换（DFT）基和 Haar 小波基之间的“不相关性”(incoherence)。DFT 基的元素在频率上是完全局部化的，而 Haar 小波基的元素在时间和尺度上具有不同程度的局部化。互相关作为一个度量，衡量了从一个基中取出的一个元素与从另一个基中取出的一个元素之间可能的最大相似度。在压缩感知等领域，低的互相关是一个理想的特性，因为它保证了在一个基中稀疏的信号在另一个基中会表现为密集的、分散的信号，从而能够从少量测量中进行稳健的恢复。\n\n解决方案按以下几个步骤进行：\n1.  构造 DFT 矩阵 $F$ 和 Haar DWT 矩阵 $W$。\n2.  计算基变换矩阵 $C = F^*W$。\n3.  计算整体经验互相关 $\\hat{\\mu}$。\n4.  对相关值进行按尺度分析。\n\n**1. 标准正交基的构造**\n\n给定一个整数 $n=2^J$（其中 $J \\geq 1$），我们构造两个 $n \\times n$ 矩阵，其列向量构成 $\\mathbb{C}^n$ 的标准正交基。\n\n**离散傅里叶变换（DFT）矩阵, $F$**\nDFT 矩阵 $F \\in \\mathbb{C}^{n \\times n}$ 由其元素定义，这些元素对应于不同频率的复正弦波。第 $t$ 行和第 $k$ 列的元素由下式给出：\n$$\nF_{t,k} = \\frac{1}{\\sqrt{n}} \\exp\\left(2\\pi i \\frac{t k}{n}\\right), \\quad t, k \\in \\{0, 1, \\dots, n-1\\}\n$$\n$F$ 的列向量，记为 $\\{f_k\\}_{k=0}^{n-1}$，构成了 $\\mathbb{C}^n$ 的一个标准正交基。该矩阵是酉矩阵，满足 $F^* F = F F^* = I_n$，其中 $F^*$ 是 $F$ 的共轭转置，$I_n$ 是 $n \\times n$ 的单位矩阵。\n\n**Haar 离散小波变换（DWT）矩阵, $W$**\nHaar DWT 矩阵 $W \\in \\mathbb{R}^{n \\times n}$ 由实值、分段常数的基向量组成。其列向量构成了 $\\mathbb{R}^n$（因此也构成了 $\\mathbb{C}^n$）的一个标准正交基。该基由一个尺度向量和 $n-1$ 个按尺度组织的小波向量组成。\n\n- **尺度向量 ($\\phi$):** 该向量表示最粗糙的可能信息（信号的平均值）。它作为我们矩阵 $W$ 的第一列，并对应于我们指定为 $s=0$ 的“尺度”：\n$$\n\\phi[t] = \\frac{1}{\\sqrt{n}} \\quad \\text{for } t \\in \\{0, 1, \\dots, n-1\\}\n$$\n\n- **小波向量 ($\\psi_{s,k}$):** 这些向量捕捉不同尺度和位置的细节。对于每个尺度 $s \\in \\{1, 2, \\dots, J\\}$，小波的支撑长度为 $L_s = 2^s$。在每个尺度 $s$ 上，有 $n/L_s$ 个小波，由一个平移参数 $k \\in \\{0, 1, \\dots, n/L_s - 1\\}$ 索引。小波 $\\psi_{s,k}$ 定义如下：\n$$\n\\psi_{s,k}[t] =\n\\begin{cases}\n+\\frac{1}{\\sqrt{L_s}},  \\text{for } t \\in \\{k L_s, \\dots, k L_s + \\frac{L_s}{2} - 1\\} \\\\\n-\\frac{1}{\\sqrt{L_s}},  \\text{for } t \\in \\{k L_s + \\frac{L_s}{2}, \\dots, (k+1)L_s - 1\\} \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n矩阵 $W$ 是通过将这些向量作为其列向量来构造的。我们采用一种排序方式，其中第一列是尺度向量 $\\phi$。其后是尺度 $s=1$ 的所有小波向量（最细的细节，最短的支撑 $L_1=2$），然后是尺度 $s=2$ 的所有小波向量，以此类推，直到尺度 $s=J$ 的单个小波（最粗糙的细节，最长的支撑 $L_J=n$）。这个包含 $1 + \\sum_{s=1}^{J} (n/L_s) = 1 + (n-1) = n$ 个向量的集合是标准正交的，因此 $W^\\top W = I_n$。\n\n**2. 互相关计算**\n\n这两个基之间的关系由矩阵 $C = F^*W$ 捕捉。该矩阵的每个元素 $C_{i,j}$ 是第 $i$ 个 DFT 基向量和第 $j$ 个 Haar 基向量之间的内积：\n$$\nC_{i,j} = \\langle f_i, w_j \\rangle\n$$\n其中 $\\{f_i\\}$ 是 $F$ 的列，$\\{w_j\\}$ 是 $W$ 的列。\n\n**经验互相关** $\\hat{\\mu}$ 是来自两个基的向量之间任意内积的最大绝对值。它衡量了从一个基中的一个向量到另一个基中一个向量上的最大可能投影。\n$$\n\\hat{\\mu} = \\mu(F, W) = \\max_{0 \\leq i,j  n} |\\langle f_i, w_j \\rangle| = \\max_{i,j} |C_{i,j}|\n$$\n\n**3. 按尺度相关性分析**\n\n为了理解相关性如何在不同的 Haar 尺度上分布，我们分析 $C$ 中对应于每个尺度的列。\n令 $\\mathcal{J}_s$ 为 $W$ 中（因此也是 $C$ 中）对应于尺度 $s$ 的基向量的列索引集合。对于尺度向量 $\\phi$，$\\mathcal{J}_0 = \\{0\\}$；对于 $s \\in \\{1, \\dots, J\\}$，$\\mathcal{J}_s$ 包含所有 $\\{\\psi_{s,k}\\}$ 的索引。\n\n对于每个 Haar 基向量 $w_j$，其与整个 DFT 基的个体相关性定义为：\n$$\n\\gamma_j = \\max_{0 \\leq i  n} |C_{i,j}|\n$$\n该值表示特定 Haar 向量 $w_j$ 与任何傅里叶基向量的最大相似度。\n\n然后，我们通过计算相关值集合 $\\{\\gamma_j : j \\in \\mathcal{J}_s\\}$ 的两个统计量来总结每个尺度 $s \\in \\{0, 1, \\dots, J\\}$ 的行为：\n- 尺度 $s$ 的平均相关：$\\text{mean}_s = \\frac{1}{|\\mathcal{J}_s|} \\sum_{j \\in \\mathcal{J}_s} \\gamma_j$\n- 尺度 $s$ 的最大相关：$\\text{max}_s = \\max_{j \\in \\mathcal{J}_s} \\gamma_j$\n\n最终的算法为指定的 $n$ 值实现这些构造和计算，并按照输出要求将浮点结果四舍五入到 $12$ 位小数。对于 $n=2$，DFT 基和 Haar 基重合，导致相关为 $1$。对于更大的 $n$，基是不同的，相关小于 $1$，并在不同尺度上表现出结构化的分布。",
            "answer": "```text\n[[2, 1.0, [1.0, 1.0], [1.0, 1.0]],[8, 0.707106781187, [0.353553390593, 0.5, 0.653281482438, 0.707106781187], [0.353553390593, 0.5, 0.653281482438, 0.707106781187]],[32, 0.707106781187, [0.176776695297, 0.25, 0.443722241584, 0.602731110598, 0.683130051064, 0.707106781187], [0.176776695297, 0.25, 0.443722241584, 0.602731110598, 0.683130051064, 0.707106781187]]]\n```"
        }
    ]
}