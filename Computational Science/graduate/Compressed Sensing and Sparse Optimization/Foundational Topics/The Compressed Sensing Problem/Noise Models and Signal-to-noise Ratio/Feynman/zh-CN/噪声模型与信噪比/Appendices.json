{
    "hands_on_practices": [
        {
            "introduction": "理解和量化信噪比（SNR）是分析任何信号处理系统的基础。第一个练习将我们带回基本原理，从第一性原理出发推导分贝（dB）标度，并阐明功率比和振幅比之间的关键区别。通过分析一个典型的压缩感知模型，你将巩固对信号属性和噪声水平如何共同决定系统性能的理解 。",
            "id": "3462108",
            "problem": "考虑压缩感知中的线性测量模型，$\\,\\mathbf{y}=\\mathbf{A}\\mathbf{x}+\\mathbf{w}\\,$，其中 $\\,\\mathbf{A}\\in\\mathbb{R}^{m\\times n}\\,$ 的元素是独立同分布 (i.i.d.) 的，满足 $\\,A_{ij}\\sim\\mathcal{N}(0,1/m)\\,$，未知信号 $\\,\\mathbf{x}\\in\\mathbb{R}^{n}\\,$ 是 K-稀疏的，恰好有 $\\,K$ 个非零项，每个非零项的幅值均为 $\\,a>0\\,$，噪声 $\\,\\mathbf{w}\\sim\\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I}_{m})\\,$ 是加性高斯白噪声 (AWGN)。信噪比 (SNR) 定义为平均信号功率与平均噪声功率之比，而分贝 (dB) 是比率的对数度量。\n\n(a) 从以下基本定义出发：(i) 在线性系统中，功率与均方根 (RMS) 幅值的平方成正比；(ii) 贝尔 (bel) 是功率比以10为底的对数，而分贝 (dB) 是贝尔的十分之一。请推导信噪比 $\\,\\mathrm{SNR}\\,$ 的分贝表示。然后，仅使用这些定义，精确解释在涉及功率比或均方根幅值比（例如，$\\,\\ell_{2}$ 能量之比与 $\\,\\ell_{2}$ 范数之比）的压缩感知语境中，何时应使用形如 $\\,10\\log_{10}(\\cdot)\\,$ 的表达式，以及何时应使用形如 $\\,20\\log_{10}(\\cdot)\\,$ 的表达式。除这些定义外，不要假定任何特殊公式。\n\n(b) 对于上述模型，计算期望的线性尺度 $\\,\\mathrm{SNR}\\,$，并用 $\\,K\\,$, $\\,a\\,$, $\\,m\\,$ 和 $\\,\\sigma^{2}\\,$ 表示。\n\n(c) 使用 (b) 部分的结果和 (a) 部分建立的适当分贝转换方法，计算在特定参数 $\\,m=200\\,$, $\\,K=10\\,$, $\\,a=0.5\\,$ 和 $\\,\\sigma^{2}=10^{-3}\\,$ 下以分贝为单位的信噪比。将最终的信噪比以 dB 表示，并将答案四舍五入到四位有效数字。",
            "solution": "我们从关于功率、幅值和对数比率度量的基本原理开始。\n\n(a) 部分。信噪比 (SNR) 定义为功率之比：\n$$\n\\mathrm{SNR} \\equiv \\frac{P_{\\text{signal}}}{P_{\\text{noise}}}.\n$$\n贝尔 (bel) 定义为功率比以10为底的对数。如果 $\\,R\\,$ 是一个功率比，那么贝尔的数值是 $\\,\\log_{10}(R)\\,$。分贝 (dB) 是贝尔的十分之一，所以一个以 dB 为单位测量的功率比 $\\,R\\,$ 是\n$$\n\\mathrm{dB}(R) = 10\\,\\log_{10}(R).\n$$\n因此，信噪比的分贝表示为\n$$\n\\mathrm{SNR}_{\\mathrm{dB}} = 10\\,\\log_{10}\\!\\left(\\mathrm{SNR}\\right).\n$$\n现在，考虑一个幅值比，例如均方根幅值比 $\\,r \\equiv A_{\\text{signal,RMS}}/A_{\\text{noise,RMS}}\\,$。在线性系统中，功率与均方根幅值的平方成正比。因此，相应的功率比是 $\\,R = r^{2}\\,$。其分贝表示变为\n$$\n\\mathrm{dB}(r) = 10\\,\\log_{10}\\!\\left(r^{2}\\right) = 20\\,\\log_{10}(r).\n$$\n因此，$\\,10\\log_{10}(\\cdot)\\,$ 必须用于功率比（例如，$\\,\\ell_{2}$ 能量之比，如 $\\,\\|\\cdot\\|_{2}^{2}\\,$），而 $\\,20\\log_{10}(\\cdot)\\,$ 则适用于幅值比（例如，$\\,\\ell_{2}$ 范数之比或均方根幅值）。在压缩感知实践中，当信噪比定义为 $\\,\\|\\mathbf{A}\\mathbf{x}\\|_{2}^{2}/\\|\\mathbf{w}\\|_{2}^{2}\\,$ 时，使用 $\\,10\\log_{10}\\,$；而如果使用 $\\,\\|\\mathbf{A}\\mathbf{x}\\|_{2}/\\|\\mathbf{w}\\|_{2}\\,$，则使用 $\\,20\\log_{10}\\,$；这两种方式是等效的，因为功率和幅值之间存在平方关系。\n\n(b) 部分。我们为给定的随机模型计算期望的线性尺度信噪比。信号分量是 $\\,\\mathbf{s}=\\mathbf{A}\\mathbf{x}\\,$，噪声是 $\\,\\mathbf{w}\\,$。信号功率是期望的平方 $\\,\\ell_{2}\\,$ 范数：\n$$\n\\mathbb{E}\\!\\left[\\|\\mathbf{A}\\mathbf{x}\\|_{2}^{2}\\right]\n= \\mathbb{E}\\!\\left[\\mathbf{x}^{\\top}\\mathbf{A}^{\\top}\\mathbf{A}\\mathbf{x}\\right]\n= \\mathbf{x}^{\\top}\\,\\mathbb{E}\\!\\left[\\mathbf{A}^{\\top}\\mathbf{A}\\right]\\mathbf{x}.\n$$\n对于独立同分布的元素 $\\,A_{ij}\\sim\\mathcal{N}(0,1/m)\\,$，一个标准结论是 $\\,\\mathbb{E}\\!\\left[\\mathbf{A}^{\\top}\\mathbf{A}\\right]=\\mathbf{I}_{n}\\,$，因此\n$$\n\\mathbb{E}\\!\\left[\\|\\mathbf{A}\\mathbf{x}\\|_{2}^{2}\\right] = \\|\\mathbf{x}\\|_{2}^{2}.\n$$\n噪声功率为\n$$\n\\mathbb{E}\\!\\left[\\|\\mathbf{w}\\|_{2}^{2}\\right] = \\sum_{i=1}^{m}\\mathbb{E}[w_{i}^{2}] = m\\,\\sigma^{2}.\n$$\n因此，期望的线性尺度信噪比为\n$$\n\\mathrm{SNR} \\equiv \\frac{\\mathbb{E}\\!\\left[\\|\\mathbf{A}\\mathbf{x}\\|_{2}^{2}\\right]}{\\mathbb{E}\\!\\left[\\|\\mathbf{w}\\|_{2}^{2}\\right]}\n= \\frac{\\|\\mathbf{x}\\|_{2}^{2}}{m\\,\\sigma^{2}}.\n$$\n已知 $\\,\\mathbf{x}\\,$ 恰好有 $\\,K\\,$ 个非零项，每个都等于 $\\,a\\,$，我们有\n$$\n\\|\\mathbf{x}\\|_{2}^{2} = K\\,a^{2},\n$$\n所以\n$$\n\\mathrm{SNR} = \\frac{K\\,a^{2}}{m\\,\\sigma^{2}}.\n$$\n\n(c) 部分。将指定参数 $\\,m=200\\,$, $\\,K=10\\,$, $\\,a=0.5\\,$ 和 $\\,\\sigma^{2}=10^{-3}\\,$ 代入线性尺度信噪比公式中：\n$$\n\\mathrm{SNR} = \\frac{10\\cdot(0.5)^{2}}{200\\cdot 10^{-3}} = \\frac{10\\cdot 0.25}{0.2} = \\frac{2.5}{0.2} = 12.5.\n$$\n因为这是一个功率比，所以适当的转换为 $\\,10\\log_{10}(\\cdot)\\,$。因此\n$$\n\\mathrm{SNR}_{\\mathrm{dB}} = 10\\,\\log_{10}(12.5).\n$$\n为了计算数值，注意到 $\\,\\log_{10}(12.5)=\\log_{10}(25)-\\log_{10}(2)\\,$，其中 $\\,\\log_{10}(25)=1.397940\\ldots\\,$ 且 $\\,\\log_{10}(2)=0.301030\\ldots\\,$，得出\n$$\n\\mathrm{SNR}_{\\mathrm{dB}} = 10\\,(1.397940\\ldots - 0.301030\\ldots) = 10\\,(1.096910\\ldots) \\approx 10.96910\\ldots\n$$\n将结果四舍五入到四位有效数字，并以分贝 (dB) 表示，结果是 $\\,10.97\\,$ dB。",
            "answer": "$$\\boxed{10.97}$$"
        },
        {
            "introduction": "在任何实际的数字系统中，测量值都必须从连续值转换为离散水平，这一过程称为量化。这引入了一种通常被建模为加性噪声的误差形式。本练习要求你基于一个标准的均匀模型，从头开始推导这种量化噪声的功率，从而揭示无处不在的 $\\frac{\\Delta^2}{12}$ 公式，并展示理想化模型如何帮助我们分析现实世界系统中的限制 。",
            "id": "3462133",
            "problem": "考虑一个压缩感知测量流程，其中一个实值标量测量 $t$ 是通过一个稀疏信号的线性泛函产生的——具体来说，$t$ 是 $\\mathbf{z}=\\mathbf{A}\\mathbf{x}$ 的一个元素，其中 $\\mathbf{A}\\in\\mathbb{R}^{m\\times n}$，$\\mathbf{x}\\in\\mathbb{R}^{n}$ 是 k-稀疏的——然后通过一个中升型均匀量化器进行量化。该量化器模型为 $Q(t)=\\Delta\\left(\\left\\lfloor t/\\Delta\\right\\rfloor+\\frac{1}{2}\\right)$，其中 $\\Delta>0$ 是量化步长，$\\left\\lfloor\\cdot\\right\\rfloor$ 表示向下取整函数。假设在压缩感知和稀疏优化中使用的标准白量化噪声模型，该模型具有信噪比（SNR）特性：以活动量化单元索引 $k\\in\\mathbb{Z}$ 为条件，输入 $t$ 在该单元上均匀分布。也就是说，给定 $\\left\\lfloor t/\\Delta\\right\\rfloor=k$，$t$ 在区间 $\\left[k\\Delta,(k+1)\\Delta\\right)$ 上均匀分布。\n\n定义量化误差为 $e(t)=Q(t)-t$。仅使用方差的基本定义和连续均匀分布的性质，推导在所述均匀输入假设下 $e(t)$ 的方差。将你的最终答案表示为仅含 $\\Delta$ 的闭式解析表达式。不要使用任何预先推导的均匀随机变量方差公式；相反，应从第一性原理推导任何所需量。你的最终答案必须是一个没有单位的单一解析表达式。",
            "solution": "目标是从第一性原理推导量化误差的方差 $\\text{Var}(e(t))$。量化误差是一个随机变量 $e$，定义为 $e(t) = Q(t) - t$。\n\n设量化区间索引的随机变量为 $K = \\lfloor t/\\Delta \\rfloor$。问题陈述，对于某个整数 $k \\in \\mathbb{Z}$，在事件 $K=k$ 的条件下，输入 $t$ 在区间 $[k\\Delta, (k+1)\\Delta)$ 上均匀分布。我们将这个条件随机变量记为 $t_k$，因此其概率密度函数（PDF）为：\n$$ f_{t_k}(x) = \\begin{cases} \\frac{1}{(k+1)\\Delta - k\\Delta} = \\frac{1}{\\Delta}  &\\text{for } x \\in [k\\Delta, (k+1)\\Delta) \\\\ 0  &\\text{otherwise} \\end{cases} $$\n对于此特定区间内的任何 $t$，量化器输出是恒定的：\n$$ Q(t) = \\Delta\\left(\\lfloor t/\\Delta \\rfloor + \\frac{1}{2}\\right) = \\Delta\\left(k + \\frac{1}{2}\\right) $$\n因此，条件量化误差（我们将其记为随机变量 $e_k$）为：\n$$ e_k = e(t) \\mid (K=k) = \\Delta\\left(k + \\frac{1}{2}\\right) - t_k $$\n我们现在推导 $e_k$ 的分布。这是均匀随机变量 $t_k$ 的线性变换。我们可以通过在 $t_k$ 的支撑集边界上对其进行求值来确定 $e_k$ 的支撑集。\n- 当 $t_k = k\\Delta$ 时，误差为 $e_k = \\Delta\\left(k + \\frac{1}{2}\\right) - k\\Delta = \\frac{\\Delta}{2}$。\n- 当 $t_k \\to (k+1)\\Delta$ 时，误差趋近于 $e_k \\to \\Delta\\left(k + \\frac{1}{2}\\right) - (k+1)\\Delta = -\\frac{\\Delta}{2}$。\n\n由于变换是线性的，$e_k$ 在区间 $\\left(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}\\right]$ 上均匀分布。该区间的长度为 $\\frac{\\Delta}{2} - (-\\frac{\\Delta}{2}) = \\Delta$。条件误差 $e_k$ 的概率密度函数（我们记为 $f_{e_k}(y)$）为：\n$$ f_{e_k}(y) = \\begin{cases} \\frac{1}{\\Delta}  &\\text{for } y \\in \\left(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}\\right] \\\\ 0  &\\text{otherwise} \\end{cases} $$\n关键的是，这个概率密度函数与索引 $k$ 无关。\n\n现在，我们考虑误差 $e(t)$ 的无条件分布。设其概率密度函数为 $f_e(y)$。根据全概率定律，我们可以将 $f_e(y)$ 表示为所有可能条件 $K=k$ 的加权和：\n$$ f_e(y) = \\sum_{k \\in \\mathbb{Z}} f_e(y \\mid K=k) P(K=k) = \\sum_{k \\in \\mathbb{Z}} f_{e_k}(y) P(K=k) $$\n由于 $f_{e_k}(y)$ 与 $k$ 无关，我们可以将其从求和中提取出来：\n$$ f_e(y) = f_{e_k}(y) \\sum_{k \\in \\mathbb{Z}} P(K=k) $$\n所有可能的、互斥结果的概率之和必须为 $1$，因此 $\\sum_{k \\in \\mathbb{Z}} P(K=k) = 1$。所以，误差的无条件概率密度函数与条件概率密度函数相同：\n$$ f_e(y) = f_{e_k}(y) = \\begin{cases} \\frac{1}{\\Delta}  &\\text{for } y \\in \\left(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}\\right] \\\\ 0  &\\text{otherwise} \\end{cases} $$\n这表明量化误差 $e(t)$ 是一个均匀分布的随机变量，$e \\sim U\\left(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}\\right)$。\n\n$e$ 的方差定义为 $\\text{Var}(e) = E[e^2] - (E[e])^2$。我们必须从第一性原理出发，使用连续随机变量期望的积分定义来计算 $E[e]$ 和 $E[e^2]$。\n\n首先，我们计算误差的期望值（均值）$E[e]$：\n$$ E[e] = \\int_{-\\infty}^{\\infty} y \\cdot f_e(y) \\,dy = \\int_{-\\Delta/2}^{\\Delta/2} y \\cdot \\frac{1}{\\Delta} \\,dy $$\n$$ E[e] = \\frac{1}{\\Delta} \\left[ \\frac{y^2}{2} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{2\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^2 - \\left(-\\frac{\\Delta}{2}\\right)^2 \\right) = \\frac{1}{2\\Delta} \\left( \\frac{\\Delta^2}{4} - \\frac{\\Delta^2}{4} \\right) = 0 $$\n量化误差的均值为 $0$。这是意料之中的，因为其分布关于 $0$ 对称。\n\n接下来，我们计算误差的二阶矩 $E[e^2]$：\n$$ E[e^2] = \\int_{-\\infty}^{\\infty} y^2 \\cdot f_e(y) \\,dy = \\int_{-\\Delta/2}^{\\Delta/2} y^2 \\cdot \\frac{1}{\\Delta} \\,dy $$\n$$ E[e^2] = \\frac{1}{\\Delta} \\left[ \\frac{y^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right) $$\n$$ E[e^2] = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} + \\frac{\\Delta^3}{8} \\right) = \\frac{1}{3\\Delta} \\left( \\frac{2\\Delta^3}{8} \\right) = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{4} \\right) = \\frac{\\Delta^2}{12} $$\n\n最后，我们求出量化误差的方差：\n$$ \\text{Var}(e) = E[e^2] - (E[e])^2 = \\frac{\\Delta^2}{12} - 0^2 = \\frac{\\Delta^2}{12} $$\n在指定的均匀输入假设下，量化误差的方差为 $\\frac{\\Delta^2}{12}$。",
            "answer": "$$\n\\boxed{\\frac{\\Delta^{2}}{12}}\n$$"
        },
        {
            "introduction": "压缩感知的一个核心任务是识别稀疏信号中非零元素的位置，这个问题被称为支撑集恢复。这个问题可以被优雅地构建为一个统计多重假设检验问题。最后一个练习将指导你完成设计支撑集恢复决策规则的过程，利用你对高斯噪声统计的知识和Bonferroni校正来设定一个控制总体错误概率的阈值，从而提供可证明的性能保证 。",
            "id": "3462105",
            "problem": "考虑一个压缩感知中的线性逆问题，其测量模型为 $y = A x + w$，其中 $y \\in \\mathbb{R}^{m}$，$A \\in \\mathbb{R}^{m \\times n}$，$x \\in \\mathbb{R}^{n}$ 是一个未知的稀疏向量，$w \\in \\mathbb{R}^{m}$ 是加性噪声。假设 $A$ 的列是标准正交的，因此 $A^{\\top} A = I_{n}$，并且噪声是白高斯噪声，$w \\sim \\mathcal{N}(0, \\sigma^{2} I_{m})$，其方差 $\\sigma^{2} > 0$ 已知。定义代理统计量 $t = A^{\\top} y \\in \\mathbb{R}^{n}$，并将支撑集恢复问题视为对坐标级原假设 $H_{0,j}: x_{j} = 0$（对于 $j = 1, \\dots, n$）的同步假设检验，使用双边规则，即如果 $|t_{j}| \\geq \\tau$（对于某个阈值 $\\tau > 0$），则宣布坐标 $j$ 为活动的。\n\n使用基本原理——高斯噪声模型、多元高斯分布在线性映射下的变换性质以及并集界——将此问题构建为关于 $A^{\\top} y$ 各坐标的多重检验问题，并推导最小的 Bonferroni 校准阈值 $\\tau$，以保证族错误率（FWER；在所有真实原假设中至少有一次错误拒绝的概率）在所有稀疏支撑集上一致地最多为期望水平 $\\alpha \\in (0,1)$。请用 $\\sigma$、$\\alpha$ 和 $n$ 将你的最终答案表示为一个闭式解析表达式。不需要数值近似。",
            "solution": "目标是找到最小的阈值 $\\tau$，使得多重检验问题的族错误率（FWER）不大于指定水平 $\\alpha$。\n\n首先，我们分析代理统计量 $t = A^{\\top} y$ 的分布。代入测量模型 $y = A x + w$，我们得到：\n$$t = A^{\\top}(A x + w) = A^{\\top} A x + A^{\\top} w$$\n利用给定的条件，$A$ 的列是标准正交的，即 $A^{\\top} A = I_{n}$（$n \\times n$ 单位矩阵），表达式简化为：\n$$t = I_{n} x + A^{\\top} w = x + A^{\\top} w$$\n我们定义一个新的噪声向量 $v = A^{\\top} w$。由于 $w$ 是一个多元高斯随机向量，$v$ 作为 $w$ 的线性变换，也是一个多元高斯随机向量。我们来确定它的分布。$v$ 的均值为：\n$$\\mathbb{E}[v] = \\mathbb{E}[A^{\\top} w] = A^{\\top} \\mathbb{E}[w] = A^{\\top} 0 = 0$$\n$v$ 的协方差矩阵是：\n$$\\text{Cov}(v) = \\mathbb{E}[v v^{\\top}] - \\mathbb{E}[v]\\mathbb{E}[v]^{\\top} = \\mathbb{E}[(A^{\\top} w)(A^{\\top} w)^{\\top}] = \\mathbb{E}[A^{\\top} w w^{\\top} A] = A^{\\top} \\mathbb{E}[w w^{\\top}] A$$\n已知 $w \\sim \\mathcal{N}(0, \\sigma^{2} I_{m})$，其协方差矩阵为 $\\mathbb{E}[w w^{\\top}] = \\sigma^{2} I_{m}$。代入此式，我们得到：\n$$\\text{Cov}(v) = A^{\\top} (\\sigma^{2} I_{m}) A = \\sigma^{2} (A^{\\top} A) = \\sigma^{2} I_{n}$$\n因此，变换后的噪声向量为 $v \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$。这意味着 $v$ 的分量 $v_j$ 是独立同分布的（i.i.d.），即 $v_j \\sim \\mathcal{N}(0, \\sigma^{2})$。\n代理统计量可以按分量写为 $t_j = x_j + v_j$，对于 $j = 1, \\dots, n$。\n\n接下来，我们考虑对每个坐标 $j$ 的假设检验。原假设为 $H_{0,j}: x_j = 0$。在此原假设下，检验统计量 $t_j$ 的分布与噪声分量 $v_j$ 的分布相同：\n$$t_j | H_{0,j} \\sim \\mathcal{N}(0, \\sigma^{2})$$\n如果在原假设 $H_{0,j}$ 为真时拒绝它，就发生了第 $j$ 个检验的 I 类错误。拒绝规则是 $|t_j| \\ge \\tau$。此事件的概率，我们称之为 $p_j$，为：\n$$p_j = P(|t_j| \\ge \\tau | H_{0,j})$$\n为了计算这个概率，我们可以通过除以其标准差 $\\sigma$ 来将随机变量 $t_j$ 标准化。令 $Z_j = t_j/\\sigma$，其中在 $H_{0,j}$ 下 $Z_j \\sim \\mathcal{N}(0, 1)$。\n$$p_j = P(|Z_j| \\ge \\frac{\\tau}{\\sigma}) = P\\left(Z_j \\ge \\frac{\\tau}{\\sigma}\\right) + P\\left(Z_j \\le -\\frac{\\tau}{\\sigma}\\right)$$\n令 $\\Phi(z)$ 表示标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数（CDF）。那么 $P(Z_j \\ge z) = 1 - \\Phi(z)$，并且根据对称性，$P(Z_j \\le -z) = \\Phi(-z) = 1 - \\Phi(z)$。因此：\n$$p_j = \\left(1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right)\\right) + \\left(1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right)\\right) = 2\\left(1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right)\\right)$$\n对于所有为真的原假设 $H_{0,j}$，这个概率是相同的。\n\nFWER是犯至少一个I类错误的概率。令 $S_0 = \\{j \\mid x_j = 0\\}$ 为真实原假设的索引集。令 $E_j$ 表示 $H_{0,j}$ 被错误拒绝的事件，即对于 $j \\in S_0$，$E_j = \\{|t_j| \\ge \\tau\\}$。\n$$\\text{FWER} = P\\left(\\bigcup_{j \\in S_0} E_j\\right)$$\n我们应用并集界（也称为Boole不等式），这是Bonferroni校正的基础：\n$$\\text{FWER} = P\\left(\\bigcup_{j \\in S_0} E_j\\right) \\le \\sum_{j \\in S_0} P(E_j)$$\n由于对于所有 $j \\in S_0$ 都有 $P(E_j) = p_j$，并且这个概率与 $j$ 无关，我们有：\n$$\\text{FWER} \\le \\sum_{j \\in S_0} p_j = |S_0| \\cdot 2\\left(1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right)\\right)$$\n其中 $|S_0|$ 是真实原假设的数量。\n\n问题要求FWER控制在所有稀疏支撑集上一致成立。这意味着我们必须为 $x$ 中零和非零条目的任何可能配置限定FWER。界 $|S_0| \\cdot p_j$ 取决于未知的真实原假设集的大小 $|S_0|$。为了确保保证是一致的，我们必须考虑此界的最坏情况。当 $|S_0|$ 尽可能大时，该界达到最大值。$|S_0|$ 的最大可能值为 $n$（当 $x=0$ 时发生，即所有假设都为原假设）。\n因此，为了保证对于任何支撑集都有 $\\text{FWER} \\le \\alpha$，我们必须强制执行最坏情况下的界：\n$$n \\cdot 2\\left(1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right)\\right) \\le \\alpha$$\n我们现在求解阈值 $\\tau$。为了找到满足此不等式的最小 $\\tau$，我们可以将其视为一个等式：\n$$n \\cdot 2\\left(1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right)\\right) = \\alpha$$\n$$\\implies 1 - \\Phi\\left(\\frac{\\tau}{\\sigma}\\right) = \\frac{\\alpha}{2n}$$\n$$\\implies \\Phi\\left(\\frac{\\tau}{\\sigma}\\right) = 1 - \\frac{\\alpha}{2n}$$\n为了分离出 $\\tau$，我们应用标准正态CDF的反函数，即分位数函数，记为 $\\Phi^{-1}$：\n$$\\frac{\\tau}{\\sigma} = \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2n}\\right)$$\n最后，解出 $\\tau$ 得到所需的表达式：\n$$\\tau = \\sigma \\cdot \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2n}\\right)$$\n这就是 Bonferroni 校准的阈值，它保证了在稀疏信号 $x$ 的所有可能支撑集上，FWER 一致地最多为 $\\alpha$。",
            "answer": "$$\\boxed{\\sigma \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2n}\\right)}$$"
        }
    ]
}