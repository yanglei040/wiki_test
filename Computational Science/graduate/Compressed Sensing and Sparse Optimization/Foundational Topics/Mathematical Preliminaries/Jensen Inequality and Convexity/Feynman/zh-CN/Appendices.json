{
    "hands_on_practices": [
        {
            "introduction": "在稀疏优化等许多领域中，理想的模型（例如使用 $\\ell_0$ “范数”的模型）往往是非凸的，这给分析和求解带来了巨大挑战。本练习通过考察一个简单的几何集合，将抽象的凸性定义具体化 。通过为 $\\ell_0$ “范数”计算其 Jensen 差值，你将亲手诊断凸性的失效，并直观地理解为何这类重要的非凸函数会使优化问题变得困难。",
            "id": "3455578",
            "problem": "在稀疏建模和压缩感知中，$k$-稀疏向量的集合是一个核心但非凸的模型集。在简单的环境空间 $\\mathbb{R}^2$ 中，当 $k=1$ 时，$k$-稀疏模型的一个类似物是坐标轴的并集。请仅使用星形性、凸性和琴生不等式的基本定义，构建并分析一个捕捉此几何特性及其对非凸惩罚项影响的具体例子。\n\n定义子集 $C \\subset \\mathbb{R}^2$ 如下：\n$$\nC \\triangleq \\{(x_1,x_2) \\in \\mathbb{R}^2 : x_2=0,\\ |x_1|\\leq 1\\}\\ \\cup\\ \\{(x_1,x_2) \\in \\mathbb{R}^2 : x_1=0,\\ |x_2|\\leq 1\\}.\n$$\n该集合代表以原点为中心、长度为2的两条坐标轴线段的并集，是在稀疏优化思想实验中常用的$1$-稀疏模型的代理。\n\n任务：\n- 仅使用星形性和凸性的定义，验证 $C$ 是关于原点的星形集但不是凸集。特别地，明确选择 $x \\in C$，$y \\in C$ 和 $t \\in (0,1)$，使得 $t x + (1-t) y \\notin C$。\n- 令 $\\|\\cdot\\|_0$ 表示计算向量中非零元素个数的零“范数”。回顾对于凸函数 $f$，琴生不等式表述为对于所有的 $x,y$ 和所有的 $t \\in [0,1]$，都有 $f(t x + (1-t) y) \\le t f(x) + (1-t) f(y)$。对于你明确选择的 $x,y$ 和 $t=\\tfrac{1}{2}$，计算琴生间隙\n$$\n\\Delta \\triangleq \\|t x + (1-t) y\\|_0 - \\big(t \\|x\\|_0 + (1-t) \\|y\\|_0\\big),\n$$\n并解释其符号如何诊断 $\\|\\cdot\\|_0$ 在 $C$ 上凸性的失效。\n\n对于你明确选择的 $x,y$ 和 $t=\\tfrac{1}{2}$，给出 $\\Delta$ 的数值作为最终答案。无需四舍五入。",
            "solution": "该问题要求基于基本定义，对集合 $C \\subset \\mathbb{R}^2$ 和零“范数” $\\|\\cdot\\|_0$ 进行三部分分析。该集合定义为沿坐标轴的两条线段的并集：\n$$\nC \\triangleq \\{(x_1,x_2) \\in \\mathbb{R}^2 : x_2=0,\\ |x_1|\\leq 1\\}\\ \\cup\\ \\{(x_1,x_2) \\in \\mathbb{R}^2 : x_1=0,\\ |x_2|\\leq 1\\}\n$$\n\n首先，我们验证 $C$ 的几何性质。我们使用星形性和凸性的形式化定义。\n如果对于集合 $S \\subseteq \\mathbb{R}^n$ 中的每个点 $x \\in S$ 和每个标量 $t \\in [0,1]$，点 $tx$ 也属于 $S$，那么该集合 **关于原点是星形的**。\n如果对于集合 $S \\subseteq \\mathbb{R}^n$ 中的每对点 $x, y \\in S$ 和每个标量 $t \\in [0,1]$，代表其凸组合的点 $tx + (1-t)y$ 也属于 $S$，那么该集合是 **凸的**。\n\n为验证 $C$ 关于原点是星形的，我们取任意一点 $x \\in C$ 和一个标量 $t \\in [0,1]$。根据 $C$ 的定义，$x$ 必须是 $|x_1| \\leq 1$ 的 $(x_1, 0)$ 形式，或者是 $|x_2| \\leq 1$ 的 $(0, x_2)$ 形式。\n情况1：$x = (x_1, 0)$ 且 $|x_1| \\leq 1$。缩放后的点是 $tx = (tx_1, 0)$。第二个分量是 $0$。对于第一个分量，因为 $t \\geq 0$，我们有 $|tx_1| = |t||x_1| = t|x_1|$。由于 $t \\in [0,1]$ 且 $|x_1| \\leq 1$，因此 $t|x_1| \\leq 1 \\cdot 1 = 1$。所以，$tx \\in C$。\n情况2：$x = (0, x_2)$ 且 $|x_2| \\leq 1$。缩放后的点是 $tx = (0, tx_2)$。第一个分量是 $0$。对于第二个分量，我们有 $|tx_2| = t|x_2| \\leq 1$。所以，$tx \\in C$。\n在两种可能的情况下，$tx$ 都在 $C$ 中。因此，集合 $C$ 是关于原点的星形集。\n\n为证明 $C$ 不是凸集，我们必须提供一个反例：一对点 $x, y \\in C$ 和一个标量 $t \\in (0,1)$，使得它们的凸组合 $z \\triangleq t x + (1-t) y$ 落在 $C$ 之外。我们从每条坐标轴线段上选择一个点。一个典型的选择是 $x \\triangleq (1,0)$ 和 $y \\triangleq (0,1)$。这两个点都在 $C$ 中，因为对于 $x$，我们有 $x_2=0$ 和 $|x_1|=1 \\leq 1$；对于 $y$，我们有 $y_1=0$ 和 $|y_2|=1 \\leq 1$。\n我们选择标量 $t = \\frac{1}{2}$，它在 $(0,1)$ 区间内。凸组合是：\n$$\nz \\triangleq \\frac{1}{2}x + \\left(1-\\frac{1}{2}\\right)y = \\frac{1}{2}(1,0) + \\frac{1}{2}(0,1) = \\left(\\frac{1}{2}, \\frac{1}{2}\\right)\n$$\n为了使点 $z = (z_1, z_2) = (\\frac{1}{2}, \\frac{1}{2})$ 属于 $C$，它需要满足 $z_1=0$ 或 $z_2=0$。然而，两个坐标都非零。因此，$z \\notin C$。这个反例证明了集合 $C$ 不是凸集。\n\n其次，我们计算零“范数” $f(\\cdot) \\triangleq \\|\\cdot\\|_0$ 的琴生间隙 $\\Delta$。这个函数计算向量中非零元素的个数。琴生间隙定义为：\n$$\n\\Delta \\triangleq f(t x + (1-t) y) - \\big(t f(x) + (1-t) f(y)\\big)\n$$\n我们使用非凸性论证中相同的点 $x = (1,0)$、$y = (0,1)$ 和标量 $t = \\frac{1}{2}$。\n我们首先计算 $x$ 和 $y$ 的 $\\|\\cdot\\|_0$ 值：\n$\\|x\\|_0 = \\|(1,0)\\|_0 = 1$ (因为只有第一个元素非零)。\n$\\|y\\|_0 = \\|(0,1)\\|_0 = 1$ (因为只有第二个元素非零)。\n函数值的凸组合是：\n$$\nt \\|x\\|_0 + (1-t) \\|y\\|_0 = \\frac{1}{2}(1) + \\frac{1}{2}(1) = 1\n$$\n接下来，我们计算向量的凸组合 $z = (\\frac{1}{2}, \\frac{1}{2})$ 的 $\\|\\cdot\\|_0$ 值：\n$$\n\\|t x + (1-t) y\\|_0 = \\left\\|\\left(\\frac{1}{2}, \\frac{1}{2}\\right)\\right\\|_0 = 2\n$$\n(因为两个元素都非零)。\n现在我们可以计算琴生间隙 $\\Delta$：\n$$\n\\Delta = 2 - 1 = 1\n$$\n\n第三，我们解释 $\\Delta$ 符号的意义。一个函数 $f$ 在一个凸集 $S$ 上是凸函数的充要条件是，对于所有的 $x,y \\in S$ 和所有的 $t \\in [0,1]$，琴生不等式 $f(t x + (1-t) y) \\le t f(x) + (1-t) f(y)$ 均成立。这个不等式等价于琴生间隙 $\\Delta$ 是非正的，即 $\\Delta \\leq 0$。\n我们对函数 $f(\\cdot) = \\|\\cdot\\|_0$ 和集合 $C$ 中的点进行的计算得出的琴生间隙为 $\\Delta = 1$。由于 $\\Delta > 0$，琴生不等式被违反了：\n$$\n\\|t x + (1-t) y\\|_0 = 2 > 1 = t \\|x\\|_0 + (1-t) \\|y\\|_0\n$$\n琴生间隙的正号为凸性的失效提供了直接而具体的诊断。这一个反例的存在足以证明零“范数” $\\|\\cdot\\|_0$ 在集合 $C$ 上（或在 $\\mathbb{R}^2$ 上）不是一个凸函数。这种非凸性是涉及 $\\|\\cdot\\|_0$ 的稀疏优化问题在计算上十分困难的一个根本原因。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在探究了凸性失效的后果之后，我们现在来探讨同样重要的凹性概念。本练习将展示 Jensen 不等式的“反转”形式，这是凹函数的一个标志性特征 。通过一个简单的概率例子，你将看到一个函数的期望值如何可能小于其期望值的函数值，这一原理对于理解和设计信号处理与机器学习中的凹惩罚项至关重要。",
            "id": "3455580",
            "problem": "考虑在压缩感知中一个随机测量残差能量的定义如下。假设一个传感矩阵作用于一个稀疏信号，且一个算法产生了一个残差向量，其欧几里得范数的平方由一个非负随机变量 $X$ 建模。映射 $f(x) = \\sqrt{x}$ 用于将能量的平方转换为能量（欧几里得范数），并且已知该函数在 $x \\ge 0$ 上是凹函数。\n\n从凹性的定义出发，推导对于一个两点分布，关联 $f(\\mathbb{E}[X])$ 和 $\\mathbb{E}[f(X)]$ 的不等式。然后，为了具体说明该不等式相对于凸函数情况是如何反转的，考虑一个两点模型，其中残差能量 $X$ 以概率 $\\theta = \\frac{1}{4}$ 取值 $x_{1} = 0$（精确拟合事件），并以概率 $1 - \\theta = \\frac{3}{4}$ 取值 $x_{2} = 1$（不匹配事件）。计算量 $\\mathbb{E}[f(X)]$ 和 $f(\\mathbb{E}[X])$，并报告其差值\n$$\\Delta = f(\\mathbb{E}[X]) - \\mathbb{E}[f(X)]\\text{。}$$\n请以单一闭式解析表达式的形式提供您的最终答案。无需四舍五入，最终表达式中不包含单位。",
            "solution": "该问题需要一个分两部分的解答：首先，推导凹函数在两点分布下的琴生不等式；其次，根据给定的例子计算一个具体的值。\n\n**第一部分：不等式的推导**\n\n区间 $I$ 上的凹函数 $f$ 的定义是：对于任意两点 $x_1, x_2 \\in I$ 和任意 $\\lambda \\in [0, 1]$，以下不等式成立：\n$$f(\\lambda x_1 + (1-\\lambda) x_2) \\ge \\lambda f(x_1) + (1-\\lambda) f(x_2)$$\n这表明，函数在两点加权平均值处的取值大于或等于在这些点处函数取值的加权平均值。\n\n现在，考虑一个离散随机变量 $X$，它以概率 $P(X=x_1) = \\theta$ 和 $P(X=x_2) = 1-\\theta$ 分别取两个值 $x_1$ 和 $x_2$，其中 $\\theta \\in [0, 1]$。\n$X$ 的期望值定义为：\n$$\\mathbb{E}[X] = \\theta x_1 + (1-\\theta) x_2$$\n变换后的随机变量 $f(X)$ 的期望值为：\n$$\\mathbb{E}[f(X)] = \\theta f(x_1) + (1-\\theta) f(x_2)$$\n通过在凹性的定义中令 $\\lambda = \\theta$，我们可以直接关联这两个期望。项 $\\lambda x_1 + (1-\\lambda) x_2$ 变为 $\\theta x_1 + (1-\\theta) x_2$，这正是 $\\mathbb{E}[X]$。项 $\\lambda f(x_1) + (1-\\lambda) f(x_2)$ 变为 $\\theta f(x_1) + (1-\\theta) f(x_2)$，这正是 $\\mathbb{E}[f(X)]$。\n\n将这些代入凹性的定义，得到凹函数在两点分布下的琴生不等式：\n$$f(\\mathbb{E}[X]) \\ge \\mathbb{E}[f(X)]$$\n正如问题陈述中正确指出的，这个不等式与凸函数的情况相比是反向的。\n\n**第二部分：具体计算**\n\n我们已知凹函数 $f(x) = \\sqrt{x}$ 和一个具有以下两点分布的随机变量 $X$：\n- $X$ 以概率 $\\theta = \\frac{1}{4}$ 取值 $x_1 = 0$。\n- $X$ 以概率 $1 - \\theta = 1 - \\frac{1}{4} = \\frac{3}{4}$ 取值 $x_2 = 1$。\n\n首先，我们计算 $X$ 的期望值 $\\mathbb{E}[X]$。\n$$\\mathbb{E}[X] = \\theta x_1 + (1-\\theta) x_2 = \\left(\\frac{1}{4}\\right)(0) + \\left(\\frac{3}{4}\\right)(1) = 0 + \\frac{3}{4} = \\frac{3}{4}$$\n\n接下来，我们计算 $f(\\mathbb{E}[X])$。这是在 $X$ 的期望值处求函数 $f$ 的值。\n$$f(\\mathbb{E}[X]) = f\\left(\\frac{3}{4}\\right) = \\sqrt{\\frac{3}{4}} = \\frac{\\sqrt{3}}{\\sqrt{4}} = \\frac{\\sqrt{3}}{2}$$\n\n然后，我们计算 $f(X)$ 的期望值 $\\mathbb{E}[f(X)]$。\n$$\\mathbb{E}[f(X)] = \\theta f(x_1) + (1-\\theta) f(x_2)$$\n我们在每个点上计算函数值：\n$$f(x_1) = f(0) = \\sqrt{0} = 0$$\n$$f(x_2) = f(1) = \\sqrt{1} = 1$$\n现在，我们可以计算期望值：\n$$\\mathbb{E}[f(X)] = \\left(\\frac{1}{4}\\right)(0) + \\left(\\frac{3}{4}\\right)(1) = 0 + \\frac{3}{4} = \\frac{3}{4}$$\n\n最后，我们计算所要求的差值 $\\Delta$。\n$$\\Delta = f(\\mathbb{E}[X]) - \\mathbb{E}[f(X)]$$\n代入计算出的值：\n$$\\Delta = \\frac{\\sqrt{3}}{2} - \\frac{3}{4}$$\n这就是差值的最终闭式解析表达式。正如从凹函数的琴生不等式所预期的那样，这个差值是非负的，因为 $\\frac{\\sqrt{3}}{2} \\approx \\frac{1.732}{2} = 0.866$ 并且 $\\frac{3}{4} = 0.75$。",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2} - \\frac{3}{4}}$$"
        },
        {
            "introduction": "理论性质在能够用于解决实际问题时才最强大。这最后一个练习展示了如何直接利用凹函数的性质来设计有效的优化算法 。你将推导主化-最小化 (majorization-minimization) 方法中的关键一步，通过构造一个紧密的上界，将一个复杂的非凸惩罚项问题转化为一系列更易于求解的加权 $\\ell_1$ 范数最小化问题，这在现代计算科学中是一项广泛应用的核心技术。",
            "id": "3455581",
            "problem": "考虑一个线性逆问题，其测量值建模为 $y = A x$，其中 $A \\in \\mathbb{R}^{m \\times n}$，$x \\in \\mathbb{R}^{n}$，且 $y \\in \\mathbb{R}^{m}$。在压缩感知中，一种常见的非凸稀疏性促进惩罚项是基于函数 $g(t)$ 构建的，其定义为 $g(t) = \\ln(1 + t)$（对于 $t \\ge 0$）。假设我们的目标是使用“主化-最小化”(majorization-minimization)策略来最小化正则化目标函数 $\\frac{1}{2}\\|A x - y\\|_{2}^{2} + \\lambda \\sum_{i=1}^{n} g(|x_{i}|)$，其中 $\\lambda > 0$。在当前迭代点 $x^{(k)}$ 处，对每个坐标 $i$，令 $t_{0} = |x_{i}^{(k)}|$。仅从凹性的定义和 Jensen 不等式出发，为一维惩罚函数 $g(t)$ 构建一个仿射上界，该上界在 $t = t_{0}$ 处是精确的。然后，使用此上界推导出第 $k$ 次迭代时的代理正则化项，其形式为加权 $\\ell_{1}$ 惩罚 $\\sum_{i=1}^{n} w_{i}^{(k)} |x_{i}|$。\n\n你的任务是确定由此构造产生的标量权重 $w(t_{0})$ 的显式闭式解析表达式，该表达式仅用 $t_{0}$ 表示。请以单个解析表达式的形式给出最终答案。无需四舍五入，也不涉及单位。",
            "solution": "我们从函数 $g(t) = \\ln(1 + t)$（定义于 $t \\ge 0$）开始。我们的目标是构建一个在给定展开点 $t_{0} \\ge 0$ 处精确的仿射上界，并完全依赖于凹性和 Jensen 不等式的基本性质。\n\n首先，我们确定 $g$ 的凹性。计算其一阶和二阶导数：\n$$\ng'(t) = \\frac{1}{1 + t}, \\quad g''(t) = -\\frac{1}{(1 + t)^{2}}.\n$$\n对所有 $t \\ge 0$，我们有 $g''(t) \\le 0$，这意味着 $g$ 在 $[0, \\infty)$ 上是凹函数。一个一维的二阶连续可微凹函数在每一点都存在一个全局支撑超平面，这意味着它的一阶泰勒展开式是一个仿射上界。这可以从带有拉格朗日余项的泰勒定理得出：对于任意 $s$ 和凹函数 $g$，\n$$\ng(s) = g(t_{0}) + g'(t_{0})(s - t_{0}) + \\frac{1}{2} g''(\\xi) (s - t_{0})^{2}\n$$\n其中 $\\xi$ 位于 $s$ 和 $t_{0}$ 之间。由于 $g''(\\xi) \\le 0$，余项为非正值，从而得到\n$$\ng(s) \\le g(t_{0}) + g'(t_{0})(s - t_{0}).\n$$\n因此，仿射函数\n$$\nM(s; t_{0}) = g(t_{0}) + g'(t_{0})(s - t_{0})\n$$\n是 $g$ 的一个全局主化函数（majorizer），它在 $s = t_{0}$ 处是精确的。\n\n为了将此构造与 Jensen 不等式和压缩感知背景联系起来，我们回忆一下，对于任何凹函数 $g$ 和任何随机变量 $T$，Jensen 不等式表明 $g(\\mathbb{E}[T]) \\ge \\mathbb{E}[g(T)]$。切线仿射形式 $M(\\cdot; t_{0})$ 是线性的，因此满足 $\\mathbb{E}[M(T; t_{0})] = M(\\mathbb{E}[T]; t_{0})$。由于 $g(T) \\le M(T; t_{0})$ 逐点成立，对其取期望可得 $\\mathbb{E}[g(T)] \\le \\mathbb{E}[M(T; t_{0})] = M(\\mathbb{E}[T]; t_{0})$，这与凹性相符，并支持在基于期望或确定性的代理构造中使用线性主化函数。\n\n在针对正则化目标函数 $\\frac{1}{2}\\|A x - y\\|_{2}^{2} + \\lambda \\sum_{i=1}^{n} g(|x_{i}|)$ 的“主化-最小化”过程中，我们在 $t_{0} = |x_{i}^{(k)}|$ 处用 $M(|x_{i}|; t_{0})$ 对每个 $g(|x_{i}|)$ 进行主化。对 $i$ 求和，正则化项变为\n$$\n\\sum_{i=1}^{n} g(|x_{i}|) \\le \\sum_{i=1}^{n} \\left[g(t_{0}) + g'(t_{0})(|x_{i}| - t_{0})\\right] = \\sum_{i=1}^{n} g(t_{0}) - \\sum_{i=1}^{n} g'(t_{0}) t_{0} + \\sum_{i=1}^{n} g'(t_{0}) |x_{i}|.\n$$\n在第 $k$ 次迭代中，前两项求和对于 $x$ 是常数，因此在第 $k$ 次迭代时需要对 $x$ 最小化的代理目标函数可简化为\n$$\n\\frac{1}{2}\\|A x - y\\|_{2}^{2} + \\lambda \\sum_{i=1}^{n} w_{i}^{(k)} |x_{i}|,\n$$\n其中权重由下式给出\n$$\nw_{i}^{(k)} = g'\\big(|x_{i}^{(k)}|\\big).\n$$\n由于 $g'(t) = \\frac{1}{1 + t}$，我们得到显式的闭式表达式\n$$\nw(t_{0}) = \\frac{1}{1 + t_{0}}.\n$$\n这就是作为局部展开点 $t_{0} = |x_{i}^{(k)}|$ 函数的权重，它产生一个重加权 $\\ell_{1}$ 步骤，其中具有较大 $|x_{i}^{(k)}|$ 的坐标会获得较小的权重，这与通过 $g$ 的凹性来促进非凸稀疏性的思想相符。该表达式是闭式的，并且是直接从基于凹性的主化推导出来的，除了上述已建立的基本性质外，没有借助任何其他技巧。",
            "answer": "$$\\boxed{\\frac{1}{1+t_{0}}}$$"
        }
    ]
}