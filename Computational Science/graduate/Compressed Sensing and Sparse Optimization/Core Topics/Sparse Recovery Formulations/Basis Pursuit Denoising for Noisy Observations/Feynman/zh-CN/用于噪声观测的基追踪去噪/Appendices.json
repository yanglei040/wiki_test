{
    "hands_on_practices": [
        {
            "introduction": "为了对基追踪降噪（Basis Pursuit Denoising, BPDN）建立扎实的直观理解，从第一性原理出发解决一个小规模问题是非常有价值的。本练习将引导你通过考虑稀疏度递增的支撑集来探索解空间，从而直接体会 $\\ell_2$ 范数约束下的 $\\ell_1$ 范数最小化问题的几何特性。通过这种方式，你将对 BPDN 解的结构和可行集边界的性质有更深刻的认识。 ",
            "id": "3433445",
            "problem": "考虑基追踪降噪 (Basis Pursuit Denoising, BPDN) 问题，其定义为在二次数据保真度约束下最小化系数向量的 $\\ell_{1}$-范数。具体而言，给定一个传感矩阵 $A \\in \\mathbb{R}^{3 \\times 5}$，一个观测向量 $y \\in \\mathbb{R}^{3}$，以及一个噪声容限 $\\epsilon > 0$，BPDN 问题为\n$$\n\\min_{x \\in \\mathbb{R}^{5}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - y\\|_{2} \\leq \\epsilon.\n$$\n令\n$$\nA = \\begin{pmatrix}\n1  0  0  1  0 \\\\\n0  1  0  1  1 \\\\\n0  0  1  0  1\n\\end{pmatrix}, \\quad\ny = \\begin{pmatrix}\n1 \\\\ 0.01 \\\\ 0\n\\end{pmatrix}, \\quad \\epsilon = 0.02.\n$$\n使用基本原理——即 BPDN 可行集的定义、候选支撑集（$\\{1,2,3,4,5\\}$ 的子集）的枚举，以及基于凸性和次梯度最优性的严格可行性与最优性检验——来确定此实例的最优目标值 $\\min \\|x\\|_{1}$。您不得使用任何现成的求解器或快捷公式；相反，您必须从 BPDN 的公式、矩阵 $A$ 的结构以及残差约束 $\\|A x - y\\|_{2} \\leq \\epsilon$ 出发进行推理。\n\n报告 BPDN 目标 $\\min \\|x\\|_{1}$ 的最优值，它是一个实数。无需四舍五入；请以精确形式表示您的最终答案。",
            "solution": "该问题是基追踪降噪 (BPDN) 的一个实例，这是一个凸优化问题，其公式为：\n$$\n\\min_{x \\in \\mathbb{R}^{5}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - y\\|_{2} \\leq \\epsilon\n$$\n给定的数据为：\n$$\nA = \\begin{pmatrix}\n1  0  0  1  0 \\\\\n0  1  0  1  1 \\\\\n0  0  1  0  1\n\\end{pmatrix}, \\quad\ny = \\begin{pmatrix}\n1 \\\\ 0.01 \\\\ 0\n\\end{pmatrix}, \\quad \\epsilon = 0.02\n$$\n$A$ 的列向量为 $a_1, a_2, a_3, a_4, a_5 \\in \\mathbb{R}^3$。向量 $y$ 可以表示为 $y = a_1 + 0.01 a_2$。问题旨在寻找一个稀疏的 $x$ 来很好地近似 $y$。我们通过检查稀疏度（非零项的数量，记为 $k=\\|x\\|_0$）递增的候选解来逐步求解。\n\n**情况 $k=0$：**\n如果 $x=0$，残差为 $\\|A \\cdot 0 - y\\|_{2} = \\|y\\|_{2} = \\sqrt{1^2 + 0.01^2 + 0^2} = \\sqrt{1.0001}$。\n约束条件为 $\\|y\\|_2 \\leq \\epsilon$，即 $\\sqrt{1.0001} \\leq 0.02$。这等价于 $1.0001 \\leq 0.02^2 = 0.0004$，此式不成立。因此，$x=0$ 不是一个可行解。\n\n**情况 $k=1$：**\n让我们假设解 $x$ 只有一个非零分量 $x_i$，其支撑集为 $S=\\{i\\}$。我们需要在 $\\|x_i a_i - y\\|_2 \\leq \\epsilon$ 的约束下找到 $\\min |x_i|$。如果由 $a_i$ 张成的直线与以 $y$ 为中心、半径为 $\\epsilon$ 的 $\\ell_2$ 球相交，则存在解。这等价于 $y$ 在该直线上的正交投影 $\\text{proj}_{a_i}(y)$ 满足 $\\|y - \\text{proj}_{a_i}(y)\\|_2 \\leq \\epsilon$。\n\n让我们对每一列 $a_i$ 进行检查：\n- 对于 $i=1$：$a_1=(1,0,0)^T$。$a_1^T a_1=1$，$a_1^T y = 1$。$\\text{proj}_{a_1}(y) = \\frac{1}{1}a_1 = (1,0,0)^T$。\n距离为 $\\|y - \\text{proj}_{a_1}(y)\\|_2 = \\|(0, 0.01, 0)^T\\|_2 = 0.01$。由于 $0.01 \\leq \\epsilon=0.02$，解是存在的。\n约束变为 $\\|(x_1-1, -0.01, 0)\\|_2^2 \\leq 0.02^2$，即 $(x_1-1)^2 + 0.0001 \\leq 0.0004$，或 $(x_1-1)^2 \\leq 0.0003$。\n这得出 $1-\\sqrt{0.0003} \\leq x_1 \\leq 1+\\sqrt{0.0003}$。由于两个界都为正，所以 $|x_1|$ 的最小值为 $1-\\sqrt{0.0003}$。\n\n- 对于 $i=2$：$a_2=(0,1,0)^T$。$a_2^T a_2=1$，$a_2^T y = 0.01$。$\\text{proj}_{a_2}(y) = 0.01 a_2$。\n距离为 $\\|y - \\text{proj}_{a_2}(y)\\|_2 = \\|(1,0,0)^T\\|_2=1$。$1 > 0.02$，所以在此支撑集上没有可行解。\n\n- 对于 $i=3$：$a_3=(0,0,1)^T$。$a_3^T y=0$。距离为 $\\|y\\|_2=\\sqrt{1.0001} > 0.02$。没有可行解。\n\n- 对于 $i=4$：$a_4=(1,1,0)^T$。$a_4^T a_4=2$，$a_4^T y=1.01$。$\\text{proj}_{a_4}(y) = \\frac{1.01}{2}a_4$。\n距离为 $\\|y - \\frac{1.01}{2}a_4\\|_2 = \\|(1-0.505, 0.01-0.505, 0)\\|_2 = \\|(0.495, -0.495, 0)\\|_2 = \\sqrt{2 \\cdot 0.495^2} = 0.495\\sqrt{2} > 0.02$。没有可行解。\n\n- 对于 $i=5$：$a_5=(0,1,1)^T$。$a_5^T y=0.01$。距离为 $\\sqrt{1^2+0.005^2+(-0.005)^2} = \\sqrt{1.00005} > 0.02$。没有可行解。\n\n唯一的可行 1-稀疏解在支撑集 $\\{1\\}$ 上，其目标值为 $1-\\sqrt{0.0003}$。\n$\\sqrt{0.0003}=\\sqrt{3 \\times 10^{-4}} = 10^{-2}\\sqrt{3} \\approx 0.01732$。所以，目标值约为 $1-0.01732 = 0.98268$。\n\n**情况 $k=2$：**\n让我们分析大小为 2 的有希望的支撑集。一个好的支撑集 $S=\\{i,j\\}$ 对应于一个“接近” $y$ 的子空间 $\\text{span}(a_i, a_j)$。向量 $y=(1, 0.01, 0)^T$ 位于由 $\\{a_1, a_2\\}$ 张成的 $xy$-平面内。注意到 $a_4=a_1+a_2$，所以 $\\text{span}(a_1, a_4) = \\text{span}(a_1, a_2)$。让我们分析支撑集 $S=\\{1,4\\}$。\n令 $x=(x_1, 0, 0, x_4, 0)^T$。约束为 $\\|x_1 a_1 + x_4 a_4 - y\\|_2 \\leq \\epsilon$。\n$x_1 a_1 + x_4 a_4 = x_1(1,0,0)^T + x_4(1,1,0)^T = (x_1+x_4, x_4, 0)^T$。\n约束变为 $\\|(x_1+x_4 - 1, x_4 - 0.01, 0)\\|_2 \\leq 0.02$，可以简化为 $(x_1+x_4 - 1)^2 + (x_4 - 0.01)^2 \\leq 0.02^2 = 0.0004$。\n我们想在这一约束下最小化 $\\|x\\|_1 = |x_1|+|x_4|$。\n令 $z_1 = x_1+x_4$ 和 $z_2 = x_4$。则 $x_1 = z_1 - z_2$。\n问题转化为在 $(z_1-1)^2 + (z_2-0.01)^2 \\leq 0.0004$ 的约束下最小化 $|z_1-z_2|+|z_2|$。\n在 $(z_1, z_2)$ 平面上的可行域是一个以 $(1, 0.01)$ 为中心、半径为 $0.02$ 的圆盘。\n对于此圆盘中的任意一点，$z_1 \\in [1-0.02, 1+0.02] = [0.98, 1.02]$ 且 $z_2 \\in [0.01-0.02, 0.01+0.02] = [-0.01, 0.03]$。\n项 $z_1-z_2$ 的最小值为 $z_{1, \\min} - z_{2, \\max} = 0.98 - 0.03 = 0.95$，该值为正。所以 $|z_1-z_2|=z_1-z_2$。\n目标函数为 $z_1-z_2+|z_2|$。\n我们根据 $z_2$ 的符号分析两种子情况：\n1. 如果 $z_2 \\geq 0$：目标函数为 $z_1-z_2+z_2=z_1$。为了在可行域中最小化 $z_1$，我们取其可能的最小值，即 $0.98$。这在点 $(z_1, z_2) = (0.98, 0.01)$ 处取得。该点在可行域内且满足 $z_2 \\geq 0$。目标值为 $0.98$。\n2. 如果 $z_2  0$：目标函数为 $z_1-z_2-z_2=z_1-2z_2$。这是一个线性函数。它在圆盘中 $z_2  0$ 部分的最小值必然在边界上取得。边界由一段圆弧和 $z_1$ 轴上的一段线段（$z_2=0$）组成。$z_1-2z_2$ 在圆弧上的最小值可以用微积分求得，但可以证明，在整个 $z_2  0$ 区域内的最小值在 $z_2=0$ 的线段上取得。在该线段上，目标函数为 $z_1$，且从 $(z_1-1)^2 \\le 0.0003$ 可知，$z_1$ 的最小值为 $1-\\sqrt{0.0003}$。\n\n比较两种情况下的最小值：$0.98$ 和 $1-\\sqrt{0.0003} \\approx 0.98268$。较小的值是 $0.98$。\n这个最小值在 $(z_1, z_2) = (0.98, 0.01)$ 处达到。\n这对应于 $x_4=z_2=0.01$ 和 $x_1=z_1-z_2=0.98-0.01=0.97$。\n候选解为 $x^*=(0.97, 0, 0, 0.01, 0)^T$。\n目标值为 $\\|x^*\\|_1 = |0.97|+|0.01| = 0.98$。\n我们来检验可行性：$Ax^* = 0.97 a_1 + 0.01 a_4 = (0.97,0,0)^T + (0.01,0.01,0)^T = (0.98, 0.01, 0)^T$。\n$\\|Ax^*-y\\|_2 = \\|(0.98-1, 0.01-0.01, 0-0)\\|_2 = \\|(-0.02, 0, 0)\\|_2 = 0.02$。\n约束 $\\|Ax^*-y\\|_2 \\leq 0.02$ 被满足。\n目标值 $0.98$ 小于 $1-\\sqrt{0.0003} \\approx 0.98268$。所以这个 2-稀疏解优于 1-稀疏解。\n\n**最优性检验：**\n对于像 BPDN 这样的凸问题，Karush-Kuhn-Tucker (KKT) 条件是最优性的充分条件。如果存在一个对偶向量 $\\nu \\in \\mathbb{R}^3$ 使得 $A^T\\nu$ 是 $\\ell_1$-范数在 $x^*$ 处的次梯度，即 $A^T\\nu \\in \\partial\\|x^*\\|_1$，并且对于某个常数 $c  0$（因为约束是激活的），有 $\\nu = c(y-Ax^*)$，那么解 $x^*$ 就是最优的。\n对于我们的候选解 $x^*=(0.97, 0, 0, 0.01, 0)^T$，支撑集是 $S=\\{1,4\\}$。\n残差是 $r = y - Ax^* = (1, 0.01, 0)^T - (0.98, 0.01, 0)^T = (0.02, 0, 0)^T$。\n让我们选择 $\\nu = c r = c(0.02, 0, 0)^T$。\n次梯度候选者是 $s = A^T\\nu$：\n$$ s = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\ 1  1  0 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 0.02c \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.02c \\\\ 0 \\\\ 0 \\\\ 0.02c \\\\ 0 \\end{pmatrix} $$\n次梯度条件是：\n- 对于 $i \\in S$，$s_i = \\text{sgn}(x_i^*)$。\n  - $s_1 = \\text{sgn}(0.97) = 1 \\implies 0.02c = 1 \\implies c=50$。\n  - $s_4 = \\text{sgn}(0.01) = 1 \\implies 0.02c = 1 \\implies c=50$。\n- 对于 $i \\notin S$，$|s_i| \\leq 1$。\n  - $|s_2|=0 \\leq 1$。（成立）\n  - $|s_3|=0 \\leq 1$。（成立）\n  - $|s_5|=0 \\leq 1$。（成立）\n所有条件在 $c=50  0$ 时都满足。因此，$x^*=(0.97, 0, 0, 0.01, 0)^T$ 是最优解。\n最优目标值为 $\\|x^*\\|_1 = 0.98$。\n用精确分数形式表示，即为 $\\frac{98}{100} = \\frac{49}{50}$。\n\n找到的目标值的最终比较：\n- 在 $\\{1\\}$ 上的 1-稀疏解：$1-\\sqrt{0.0003} \\approx 0.98268$\n- 在 $\\{1,4\\}$ 上的 2-稀疏解：$0.98$\n\n最小值为 $0.98$。\n进一步检查大小为 $k \\ge 3$ 的支撑集不会得到更好的结果，这一点已由 KKT 条件证实。例如，考虑基 $S=\\{1,2,3\\}$ 会导致一个关于 $y$ 的软阈值问题，其结果与前面找到的 1-稀疏解相同。\n因此，最优目标值为 $0.98$。\n最终答案必须是精确形式。\n$0.98 = \\frac{98}{100} = \\frac{49}{50}$。",
            "answer": "$$\\boxed{\\frac{49}{50}}$$"
        },
        {
            "introduction": "虽然穷举法可以找到小规模问题的解，但要验证一个解的最优性，我们需要一个更强大的理论工具。本练习介绍了 Karush-Kuhn-Tucker (KKT) 条件，这是验证像 BPDN 这样的凸问题最优性的严格方法。通过为给定的候选解和对偶变量验证 KKT 条件，你将学会如何确认一个解确实是全局最优解，这是连接优化理论与实际应用的关键一步。 ",
            "id": "3433457",
            "problem": "考虑带有噪声观测的基追踪降噪（Basis Pursuit Denoising, BPDN）问题，其形式为在二阶锥约束下最小化凸泛函：\n$$\n\\min_{x \\in \\mathbb{R}^{3}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - y\\|_{2} \\leq \\varepsilon,\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 3}$，$y \\in \\mathbb{R}^{2}$，且 $\\varepsilon \\in \\mathbb{R}_{+}$。设数据为\n$$\nA \\,=\\, \\begin{pmatrix} 1  0  -1 \\\\ 0  1  0 \\end{pmatrix}, \\quad\ny \\,=\\, \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}, \\quad \\varepsilon \\,=\\, 1,\n$$\n并考虑候选原始点和对偶向量\n$$\n\\hat{x} \\,=\\, \\begin{pmatrix} 2 \\\\ 0 \\\\ -1 \\end{pmatrix}, \\qquad\n\\hat{z} \\,=\\, \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n利用凸分析的基本原理（次微分和法锥），验证该 BPDN 问题的 Karush–Kuhn–Tucker (KKT) 条件——即原始可行性、对偶可行性、平稳性和互补松弛性。推断出 $\\hat{x}$ 是最优解。然后计算最优目标值 $\\|\\hat{x}\\|_{1}$。最终结果请提供一个精确的实数（不要四舍五入）。",
            "solution": "本题要求通过检验 Karush–Kuhn–Tucker (KKT) 条件来验证候选点 $\\hat{x}$ 是基追踪降噪 (BPDN) 问题的最优解。BPDN 问题是一个凸优化问题，其形式为：\n$$\n\\min_{x \\in \\mathbb{R}^{3}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - y\\|_{2} \\leq \\varepsilon\n$$\n目标函数 $f(x) = \\|x\\|_{1}$ 是凸的，可行集 $C = \\{x \\in \\mathbb{R}^{3} \\mid \\|A x - y\\|_{2} \\leq \\varepsilon\\}$ 是一个凸集。对于凸优化问题，KKT 条件是全局最优性的充分条件。\n\n我们将问题定义为标准形式 $\\min_{x} f(x)$，约束为 $g(x) \\leq 0$，其中 $f(x) = \\|x\\|_{1}$ 且 $g(x) = \\|A x - y\\|_{2} - \\varepsilon$。\n根据凸分析的基本原理，一个点 $\\hat{x} \\in C$ 是最优的，当且仅当它满足条件 $0 \\in \\partial f(\\hat{x}) + N_C(\\hat{x})$，其中 $\\partial f(\\hat{x})$ 是 $f$ 在 $\\hat{x}$ 处的次微分，而 $N_C(\\hat{x})$ 是可行集 $C$ 在 $\\hat{x}$ 处的法锥。\n\n法锥 $N_C(\\hat{x})$ 取决于约束在 $\\hat{x}$ 处是否是激活的：\n- 如果 $g(\\hat{x})  0$，则 $\\hat{x}$ 位于 $C$ 的内部，且 $N_C(\\hat{x}) = \\{0\\}$。\n- 如果 $g(\\hat{x}) = 0$，则 $\\hat{x}$ 位于 $C$ 的边界上，且 $N_C(\\hat{x}) = \\{ \\lambda v \\mid \\lambda \\geq 0, v \\in \\partial g(\\hat{x}) \\}$。\n\n根据链式法则，$g(x)$ 在 $\\hat{x}$ 处的次微分为 $\\partial g(\\hat{x}) = A^T \\partial_u(\\|u\\|_2)|_{u=A\\hat{x}-y}$。\n\n我们首先验证候选点 $\\hat{x} = \\begin{pmatrix} 2 \\\\ 0 \\\\ -1 \\end{pmatrix}$ 的原始可行性。\n给定的数据是 $A = \\begin{pmatrix} 1  0  -1 \\\\ 0  1  0 \\end{pmatrix}$，$y = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}$，以及 $\\varepsilon = 1$。\n残差向量计算如下：\n$$\nA\\hat{x} - y = \\begin{pmatrix} 1  0  -1 \\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 0 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1)(2) + (0)(0) + (-1)(-1) \\\\ (0)(2) + (1)(0) + (0)(-1) \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n残差的 $\\ell_2$-范数为：\n$$\n\\|A\\hat{x} - y\\|_{2} = \\left\\| \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{(-1)^{2} + 0^{2}} = 1\n$$\n原始可行性条件为 $\\|A\\hat{x} - y\\|_{2} \\leq \\varepsilon$，即 $1 \\leq 1$。该条件成立，因此 $\\hat{x}$ 是一个可行点。\n此外，由于 $\\|A\\hat{x} - y\\|_{2} = \\varepsilon$，约束是激活的。这意味着 $\\hat{x}$ 位于可行集的边界上，法锥 $N_C(\\hat{x})$ 是非平凡的。\n\n由于残差 $A\\hat{x}-y \\neq 0$，$\\|u\\|_2$ 在 $u=A\\hat{x}-y$ 处的次微分是唯一的向量 $\\frac{A\\hat{x}-y}{\\|A\\hat{x}-y\\|_2}$。\n因此，$\\partial g(\\hat{x})$ 是包含以下向量的单点集：\n$$\nA^T \\frac{A\\hat{x}-y}{\\|A\\hat{x}-y\\|_2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ -1  0 \\end{pmatrix} \\frac{\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}}{1} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n在 $\\hat{x}$ 处的法锥为 $N_C(\\hat{x}) = \\left\\{ \\lambda \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix} \\mid \\lambda \\geq 0 \\right\\}$。\n最优性条件 $0 \\in \\partial f(\\hat{x}) + N_C(\\hat{x})$ 变为：必须存在一个 $\\lambda \\geq 0$ 使得\n$$\n-\\lambda \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix} \\in \\partial \\|\\hat{x}\\|_1\n$$\n我们定义一个对偶变量 $\\hat{z} = \\lambda \\frac{y-A\\hat{x}}{\\|y-A\\hat{x}\\|_2}$。通过这个定义，最优性条件可以用原始-对偶对 $(\\hat{x}, \\hat{z})$ 来表述：\n1.  **原始可行性**：$\\|A\\hat{x} - y\\|_2 \\leq \\varepsilon$。\n2.  **平稳性**：$A^T \\hat{z} \\in \\partial \\|\\hat{x}\\|_1$。\n3.  **互补松弛性**：$\\langle \\hat{z}, y-A\\hat{x} \\rangle = \\varepsilon \\|\\hat{z}\\|_2$。\n\n我们继续对给定的 $\\hat{x} = \\begin{pmatrix} 2 \\\\ 0 \\\\ -1 \\end{pmatrix}$ 和 $\\hat{z} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 验证这三个条件。\n\n**1. 原始可行性：**\n如前计算，$\\|A\\hat{x} - y\\|_2 = 1$ 且 $\\varepsilon = 1$。$1 \\leq 1$ 条件得到满足。\n\n**2. 平稳性：**\n我们检查 $A^T \\hat{z}$ 是否是 $\\|x\\|_1$ 在 $\\hat{x}$ 处的次微分的一个元素。\n首先，我们计算向量 $A^T \\hat{z}$：\n$$\nA^T \\hat{z} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n接下来，我们确定次微分 $\\partial \\|\\hat{x}\\|_1$。对于一个向量 $s = (s_1, s_2, s_3)^T$ 要属于 $\\partial \\|\\hat{x}\\|_1$，其分量必须满足：若 $\\hat{x}_i \\neq 0$，则 $s_i = \\text{sign}(\\hat{x}_i)$；若 $\\hat{x}_i = 0$，则 $s_i \\in [-1, 1]$。\n对于 $\\hat{x} = (2, 0, -1)^T$：\n- $s_1 = \\text{sign}(2) = 1$。\n- $s_2 \\in [-1, 1]$。\n- $s_3 = \\text{sign}(-1) = -1$。\n向量 $A^T \\hat{z} = (1, 0, -1)^T$ 满足这些条件：其第一个分量是 $1$，其第二个分量 $0$ 在区间 $[-1, 1]$ 内，其第三个分量是 $-1$。\n因此，$A^T \\hat{z} \\in \\partial \\|\\hat{x}\\|_1$，平稳性条件得到满足。\n\n**3. 互补松弛性：**\n我们必须检查是否 $\\langle \\hat{z}, y - A\\hat{x} \\rangle = \\varepsilon \\|\\hat{z}\\|_2$。\n向量 $y - A\\hat{x} = -(A\\hat{x} - y) = - \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n等式左边为：\n$$\n\\langle \\hat{z}, y - A\\hat{x} \\rangle = \\left\\langle \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\rangle = (1)(1) + (0)(0) = 1\n$$\n等式右边为：\n$$\n\\varepsilon \\|\\hat{z}\\|_2 = 1 \\cdot \\left\\| \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\|_2 = 1 \\cdot \\sqrt{1^2 + 0^2} = 1\n$$\n由于两边都等于 $1$，互补松弛性条件得到满足。\n\n对于给定的原始点 $\\hat{x}$ 和对偶向量 $\\hat{z}$，所有三个 KKT 条件都得到满足。由于 BPDN 问题是凸的，满足 KKT 条件是证明最优性的充分条件。我们得出结论，$\\hat{x}$ 是一个最优解。\n\n最后，我们计算最优目标值，即 $\\|\\hat{x}\\|_1$：\n$$\n\\|\\hat{x}\\|_1 = \\|(2, 0, -1)^T\\|_1 = |2| + |0| + |-1| = 2 + 0 + 1 = 3\n$$\n目标函数的最优值为 $3$。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "在实际应用中，我们依赖于高效的迭代算法来解决 BPDN 问题。本练习让你亲手实践快速迭代收缩阈值算法（Fast Iterative Shrinkage-Thresholding Algorithm, FISTA）——一种求解 BPDN 的常用方法。通过执行单次 FISTA 迭代并分析其收敛性的一个关键理论层面，你将深入理解像 FISTA 这样的加速近端梯度算法是如何工作的。 ",
            "id": "3433513",
            "problem": "考虑带有平方误差数据保真项和 $\\ell_{1}$ 惩罚项的基追踪降噪 (BPDN) 问题：对 $x \\in \\mathbb{R}^{4}$ 最小化复合目标函数 $F(x) \\equiv f(x) + g(x)$，其中 $f(x) = \\tfrac{1}{2}\\|A x - y\\|_{2}^{2}$，$g(x) = \\lambda \\|x\\|_{1}$。设传感矩阵为\n$$\nA = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \n\\end{pmatrix},\n$$\n观测向量为 $y = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\tfrac{1}{2} \\end{pmatrix}$，正则化权重为 $\\lambda = \\tfrac{3}{4}$。使用 $x^{0} = 0 \\in \\mathbb{R}^{4}$、$z^{0} = x^{0}$ 和 $t_{0} = 1$ 启动快速迭代收缩阈值算法 (FISTA)。使用标准的 FISTA 步长选择，即 $L$ 等于 $\\nabla f$ 的 Lipschitz 常数，并精确执行一次完整的 FISTA 迭代。\n\n任务：\n- 从第一性原理确定 $L$ 并将其用作步长。\n- 明确写出此实例的动量更新和近端步骤，并计算 $x^{1}$。\n- 提供一个简洁的、基于第一性原理的解释，说明为什么 FISTA 中的加速不改变此 BPDN 问题中底层近端梯度算子的不动点集。\n\n答案格式：\n- 以 $1 \\times 4$ 行向量的形式报告迭代结果 $x^{1}$，使用精确值（在适当情况下使用分数）。不要四舍五入。",
            "solution": "该问题要求对基追踪降噪 (BPDN) 问题执行一次快速迭代收缩阈值算法 (FISTA) 的迭代，并提供关于其不动点的理论解释。需要最小化的目标函数是 $F(x) = f(x) + g(x)$，其中 $f(x) = \\frac{1}{2}\\|A x - y\\|_{2}^{2}$ 是光滑的数据保真项，$g(x) = \\lambda \\|x\\|_{1}$ 是非光滑的正则化项。\n\n首先，我们确定步长，其设置为 $\\gamma = \\frac{1}{L}$，其中 $L$ 是 $f(x)$ 的梯度（表示为 $\\nabla f(x)$）的 Lipschitz 常数。$f(x)$ 的梯度是：\n$$\n\\nabla f(x) = A^{T}(A x - y)\n$$\n$\\nabla f(x)$ 的 Lipschitz 常数 $L$ 是其 Hessian 矩阵 $\\nabla^2 f(x)$ 的谱范数。由于梯度是 $x$ 的仿射函数，Hessian 矩阵是常数：\n$$\n\\nabla^{2} f(x) = A^{T}A\n$$\n因此，$L = \\|A^{T}A\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 表示谱范数（最大奇异值）。对于像 $A^{T}A$ 这样的半正定矩阵，这就是其最大特征值。给定：\n$$\nA = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \n\\end{pmatrix}\n$$\n其转置为：\n$$\nA^{T} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n于是 Hessian 矩阵为：\n$$\nA^{T}A = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \n\\end{pmatrix} = \n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  0 \n\\end{pmatrix}\n$$\n这是一个对角矩阵。其特征值为对角线上的元素：$1$、$1$、$1$ 和 $0$。最大特征值为 $1$。因此，Lipschitz 常数是 $L = 1$，步长是 $\\gamma = \\frac{1}{L} = 1$。\n\n接下来，我们执行一次 FISTA 迭代。算法的更新步骤如下：\n1. $x^{k+1} = \\text{prox}_{\\gamma g}(z^k - \\gamma \\nabla f(z^k))$\n2. $t_{k+1} = \\frac{1 + \\sqrt{1 + 4t_k^2}}{2}$\n3. $z^{k+1} = x^{k+1} + \\frac{t_k - 1}{t_{k+1}}(x^{k+1} - x^k)$\n\n初始条件给定为 $x^{0} = \\mathbf{0} \\in \\mathbb{R}^{4}$，$z^{0} = x^{0} = \\mathbf{0}$ 和 $t_{0} = 1$。我们计算第一次迭代的结果 $x^{1}$（对于 $k=0$）：\n$$\nx^{1} = \\text{prox}_{\\gamma g}(z^0 - \\gamma \\nabla f(z^0))\n$$\n当 $z^{0} = \\mathbf{0}$ 且 $\\gamma = 1$ 时，近端算子的参数为：\n$$\nv = z^0 - \\gamma \\nabla f(z^0) = \\mathbf{0} - 1 \\cdot A^{T}(A\\mathbf{0} - y) = -A^{T}(-y) = A^{T}y\n$$\n给定 $y = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\frac{1}{2} \\end{pmatrix}$。我们计算 $v$：\n$$\nv = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n\\begin{pmatrix} 3 \\\\ -1 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n对于 $g(x) = \\lambda \\|x\\|_{1}$，其近端算子是软阈值算子 $\\text{Shrink}(v, \\tau)$，它逐元素地作用为 $\\text{Shrink}(v_i, \\tau) = \\text{sign}(v_i) \\max(|v_i| - \\tau, 0)$。阈值为 $\\tau = \\gamma \\lambda = 1 \\cdot \\frac{3}{4} = \\frac{3}{4}$。\n\n我们将此算子应用于 $v$ 的每个分量：\n$$\nx_1^1 = \\text{Shrink}\\left(3, \\frac{3}{4}\\right) = \\text{sign}(3) \\max\\left(|3| - \\frac{3}{4}, 0\\right) = 1 \\cdot \\left(3 - \\frac{3}{4}\\right) = \\frac{12-3}{4} = \\frac{9}{4}\n$$\n$$\nx_2^1 = \\text{Shrink}\\left(-1, \\frac{3}{4}\\right) = \\text{sign}(-1) \\max\\left(|-1| - \\frac{3}{4}, 0\\right) = -1 \\cdot \\left(1 - \\frac{3}{4}\\right) = -\\frac{1}{4}\n$$\n$$\nx_3^1 = \\text{Shrink}\\left(\\frac{1}{2}, \\frac{3}{4}\\right) = \\text{sign}\\left(\\frac{1}{2}\\right) \\max\\left(\\left|\\frac{1}{2}\\right| - \\frac{3}{4}, 0\\right) = 1 \\cdot \\max\\left(-\\frac{1}{4}, 0\\right) = 0\n$$\n$$\nx_4^1 = \\text{Shrink}\\left(0, \\frac{3}{4}\\right) = \\text{sign}(0) \\max\\left(|0| - \\frac{3}{4}, 0\\right) = 0\n$$\n因此，第一次迭代的结果是 $x^{1} = \\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{1}{4} \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n最后，我们解释为什么 FISTA 中的加速不改变不动点集。\n一个点 $x^*$ 是复合目标函数 $F(x)=f(x)+g(x)$ 的一个最小化点，当且仅当它满足一阶最优性条件：\n$$\n\\mathbf{0} \\in \\nabla f(x^*) + \\partial g(x^*)\n$$\n其中 $\\partial g(x^*)$ 是 $g$ 在 $x^*$ 处的次微分。该条件等价于近端梯度算子 $T(z) = \\text{prox}_{\\gamma g}(z - \\gamma \\nabla f(z))$ 的不动点方程：\n$$\nx^* = T(x^*) = \\text{prox}_{\\gamma g}(x^* - \\gamma \\nabla f(x^*))\n$$\n因此，$F(x)$ 的最小化点集恰好是算子 $T$ 的不动点集。\n\n现在，考虑 FISTA 算法。FISTA 迭代的一个不动点是一个点 $(x^*, z^*)$，使得如果 $x^k = x^{k-1} = x^*$，那么 $x^{k+1} = x^*$ 并且 $z^{k+1} = z^k = z^*$。\n$z$ 的更新公式为 $z^{k+1} = x^{k+1} + \\frac{t_k - 1}{t_{k+1}}(x^{k+1} - x^k)$。在一个不动点处，$x^{k+1} = x^k = x^*$，所以第二项消失，得到 $z^{k+1} = x^{k+1}$。这意味着在算法的任何不动点处，我们必须有 $z^* = x^*$。\n\n$x$ 的更新公式为 $x^{k+1} = T(z^k)$。在不动点 $(x^*, z^*)$ 处，这变为 $x^* = T(z^*)$。\n将条件 $z^* = x^*$ 代入此方程，我们得到：\n$$\nx^* = T(x^*)\n$$\n这与标准（非加速）近端梯度法的不动点条件完全相同。因此，FISTA 和近端梯度法共享相同的不动点集。FISTA 中的加速方案，即在某个外推点 $z^k$ 而不是 $x^k$ 处评估梯度，改变了迭代序列走向解的路径，但并未改变可能的解集（即不动点集）。\n\n问题要求将迭代结果 $x^1$ 表示为行向量。\n$x^{1} = \\begin{pmatrix} \\frac{9}{4}  -\\frac{1}{4}  0  0 \\end{pmatrix}$。\n*关于计算的说明：* prox 算子的参数是 $z^0 - \\gamma \\nabla f(z^0)$。当 $z^0=0$ 时，$\\nabla f(0) = A^T(A \\cdot 0 - y) = -A^T y$。参数是 $-A^T(0-y) = A^T y$。我的计算使用了 $A^T y$。一个常见的错误是使用 $-A^T y$。\n$v = A^T y = \\begin{pmatrix} 3 \\\\ -1 \\\\ 1/2 \\\\ 0 \\end{pmatrix}$。\n软阈值计算为：\n$x_1^1 = Shrink(3, 3/4) = 9/4$。\n$x_2^1 = Shrink(-1, 3/4) = -1/4$。\n$x_3^1 = Shrink(1/2, 3/4) = 0$。\n$x_4^1 = Shrink(0, 3/4) = 0$。\n结果是正确的。等等，让我重新验证梯度计算。\n$\\nabla f(x) = A^T(Ax - y)$。$\\nabla f(z^0) = \\nabla f(\\mathbf{0}) = A^T (A\\mathbf{0} - y) = -A^T y$。\nprox 的参数是 $v = z^0 - \\gamma \\nabla f(z^0) = \\mathbf{0} - \\gamma(-A^T y) = \\gamma A^T y$。\n我的计算是 $v=A^T y$ 且 $\\gamma=1$。这是正确的。\n问题陈述中有 $y = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\tfrac{1}{2} \\end{pmatrix}$，$Ay = \\begin{pmatrix} 3  -1  1/2  0 \\end{pmatrix}^T$，不对，是 $A^T y$。\n$A^T y = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -1 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\\\ 1/2 \\\\ 0 \\end{pmatrix}$。\n这是正确的。\n$x_1^1 = Shrink(3, 3/4) = 3-3/4 = 9/4$。正确。\n$x_2^1 = Shrink(-1, 3/4) = -(|-1|-3/4) = -(1-3/4) = -1/4$。正确。\n$x_3^1 = Shrink(1/2, 3/4) = 0$。正确。\n$x_4^1 = Shrink(0, 3/4) = 0$。正确。\n结果是 $x^1 = \\begin{pmatrix} 9/4  -1/4  0  0 \\end{pmatrix}$。\n啊，我最初的计算有误。\n$z^k - \\gamma \\nabla f(z^k)$。\n$z^0 - \\gamma \\nabla f(z^0) = 0 - (1) \\cdot A^T(A \\cdot 0 - y) = -A^T(-y) = A^T y$。\n计算是正确的。没有错误。\n我之前的草稿是 $v = z^0 - \\gamma \\nabla f(z^0)$。\n$\\nabla f(z^0) = \\nabla f(0) = A^T(A(0)-y) = -A^T y$。\n所以 $v = 0 - (1)(-A^T y) = A^T y$。好的，我的检查是多余的并且让我困惑，但结果保持不变。\n$x^1 = \\text{Shrink}(A^T y, \\lambda)$。\n最终答案是 $\\begin{pmatrix} 9/4  -1/4  0  0 \\end{pmatrix}$。\n问题要求 $x^1$ 是一个 $1 \\times 4$ 的行向量。我将按照指示使用 `pmatrix` 环境。\n\n我再仔细检查一下问题陈述。\n$y = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\tfrac{1}{2} \\end{pmatrix}$。\n$\\lambda = \\frac{3}{4}$。\n$A = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix}$。\n所有值都正确。\n$A^T y = [3, -1, 1/2, 0]^T$。\n$x^1_1 = S_{3/4}(3) = 3 - 3/4 = 9/4$。\n$x^1_2 = S_{3/4}(-1) = -1(1 - 3/4) = -1/4$。\n$x^1_3 = S_{3/4}(1/2)=0$。\n$x^1_4 = S_{3/4}(0)=0$。\n结果是正确的。\n\n最后检查问题陈述：“最小化复合目标函数 $F(x) \\equiv f(x) + g(x)$，其中 $f(x) = \\tfrac{1}{2}\\|A x - y\\|_{2}^{2}$，$g(x) = \\lambda \\|x\\|_{1}$，变量为 $x \\in \\mathbb{R}^{4}$”。\n我的推导是正确的。我对结果有信心。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{9}{4}  -\\frac{1}{4}  0  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}