{
    "hands_on_practices": [
        {
            "introduction": "这个练习将引导你为一个简单的小矩阵手动计算其受限等距常数（Restricted Isometry Constant, RIC）$ \\delta_k $。通过这种亲身实践 ，你将揭开抽象定义的神秘面紗，并清晰地看到 $ \\delta_k $ 是如何与特定子矩阵的格拉姆（Gram）矩阵的特征值直接关联的，从而为后续更深入的理解奠定坚实基础。",
            "id": "3474584",
            "problem": "设 $A \\in \\mathbb{R}^{2 \\times 3}$ 是一个传感矩阵，其列为单位范数向量，具体表示为\n$$\nA \\;=\\; \\begin{bmatrix}\n1  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\\n0  \\tfrac{\\sqrt{3}}{2}  -\\tfrac{\\sqrt{3}}{2}\n\\end{bmatrix}.\n$$\n考虑压缩感知中的受限等距性质 (RIP)，它通过受限等距常数 (RIC) $\\delta_k$ 定义。$\\delta_k$ 是满足以下条件的最小非负数 $\\delta \\geq 0$：对于所有支撑集 $S \\subset \\{1,2,3\\}$ (其中 $|S| \\leq k$) 和所有向量 $x \\in \\mathbb{R}^{|S|}$，\n$$\n(1 - \\delta)\\,\\|x\\|_{2}^{2} \\;\\leq\\; \\|A_{S} x\\|_{2}^{2} \\;\\leq\\; (1 + \\delta)\\,\\|x\\|_{2}^{2}.\n$$\n此处，$A_{S}$ 表示由 $A$ 中索引集 $S$ 对应的列构成的子矩阵。请仅根据此定义以及关于对称矩阵的奇异值和特征值的基本事实，通过显式地枚举所有满足 $|S| \\leq 2$ 的支撑集 $S$ 以及 $A_{S}$ 的极值奇异值，来计算给定矩阵的精确受限等距常数 $\\delta_{1}$ 和 $\\delta_{2}$。请以有序对 $(\\delta_{1}, \\delta_{2})$ 的形式提供您的最终答案。要求给出精确值，无需四舍五入。",
            "solution": "用户需要计算给定矩阵 $A \\in \\mathbb{R}^{2 \\times 3}$ 的受限等距常数 (RIC) $\\delta_{1}$ 和 $\\delta_{2}$。\n\n这个问题是有效的。它在科学上是合理的、适定的和客观的。它提供了清晰的定义和所有必要的数据来计算一个唯一的、可验证的答案。矩阵已给出，其性质（单位范数列）被正确陈述，任务是受限等距性质 (RIP) 定义的直接应用。\n\n受限等距性质由不等式\n$$ (1 - \\delta_k) \\|x\\|_2^2 \\leq \\|A_S x\\|_2^2 \\leq (1 + \\delta_k) \\|x\\|_2^2 $$\n定义，该不等式必须对所有基数 $|S| \\leq k$ 的支撑集 $S \\subset \\{1, 2, 3\\}$ 和所有向量 $x \\in \\mathbb{R}^{|S|}$ 成立。常数 $\\delta_k$ 是使此不等式成立的最小非负数。\n\n我们可以将表达式 $\\|A_S x\\|_2^2$ 重写为 $x^T A_S^T A_S x$。矩阵 $A_S^T A_S$ 是一个对称的格拉姆矩阵。该不等式可以用瑞利商来表示：\n$$ 1 - \\delta_k \\leq \\frac{x^T A_S^T A_S x}{x^T x} \\leq 1 + \\delta_k $$\n根据 Rayleigh-Ritz 定理，对于给定的 $S$，该商的最小值和最大值分别是矩阵 $A_S^T A_S$ 的最小和最大特征值，分别记为 $\\lambda_{\\min}(A_S^T A_S)$ 和 $\\lambda_{\\max}(A_S^T A_S)$。这些特征值是 $A_S$ 的奇异值的平方。\n\n为使 RIP 不等式对所有 $|S| \\leq k$ 的支撑集 $S$ 成立，其界限必须能容纳所有这些支撑集上最极端的特征值。令\n$$ \\lambda_{\\min}^{(k)} = \\min_{S: |S| \\leq k} \\lambda_{\\min}(A_S^T A_S) $$\n$$ \\lambda_{\\max}^{(k)} = \\max_{S: |S| \\leq k} \\lambda_{\\max}(A_S^T A_S) $$\nRIP 常数 $\\delta_k$ 则由两个与 1 的偏差中较大的一个确定：\n$$ \\delta_k = \\max\\left(1 - \\lambda_{\\min}^{(k)}, \\lambda_{\\max}^{(k)} - 1\\right) $$\n\n设 $A$ 的列为 $a_1, a_2, a_3$：\n$$ a_1 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad a_2 = \\begin{bmatrix} \\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2} \\end{bmatrix}, \\quad a_3 = \\begin{bmatrix} \\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2} \\end{bmatrix} $$\n对于任何子矩阵 $A_S$，其格拉姆矩阵的元素为 $(A_S^T A_S)_{ij} = a_{s_i}^T a_{s_j}$。由于所有列都是单位范数，所有这些格拉姆矩阵的对角线元素都将是 1。\n\n**$\\delta_1$ 的计算**\n\n对于 $k=1$，我们考虑所有 $|S| \\leq 1$ 的支撑集 $S$。我们只需要考虑非空支撑集，因此我们分析 $|S|=1$ 的情况。可能的支撑集是 $S_1 = \\{1\\}$，$S_2 = \\{2\\}$ 和 $S_3 = \\{3\\}$。\n\n对于任何支撑集 $S_i = \\{i\\}$，子矩阵 $A_{S_i}$ 就是列向量 $a_i$。相应的格拉姆矩阵是一个 $1 \\times 1$ 的矩阵：\n$$ A_{S_i}^T A_{S_i} = [a_i^T a_i] = [\\|a_i\\|_2^2] $$\n如问题中所述（并已验证），$A$ 的列具有单位范数，因此对于 $i=1,2,3$，$\\|a_i\\|_2^2 = 1$。因此，对于所有大小为 1 的三个支撑集，格拉姆矩阵都是 $[1]$，它有一个唯一的特征值 $\\lambda=1$。\n\n因此，对于 $k=1$：\n$$ \\lambda_{\\min}^{(1)} = \\min(1, 1, 1) = 1 $$\n$$ \\lambda_{\\max}^{(1)} = \\max(1, 1, 1) = 1 $$\nRIC $\\delta_1$ 则为：\n$$ \\delta_1 = \\max(1 - 1, 1 - 1) = 0 $$\n\n**$\\delta_2$ 的计算**\n\n对于 $k=2$，我们必须考虑所有 $|S| \\leq 2$ 的支撑集 $S$。这包括大小为 1 的支撑集（我们已经知道其特征值均为 1）和大小为 2 的支撑集。大小为 2 的支撑集是 $S_{12} = \\{1,2\\}$、$S_{13} = \\{1,3\\}$ 和 $S_{23} = \\{2,3\\}$。我们必须求出这些支撑集对应的格拉姆矩阵的特征值。\n\n首先，我们计算所需的非对角线元素（内积）：\n$$ a_1^T a_2 = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} \\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2} \\end{bmatrix} = \\frac{1}{2} $$\n$$ a_1^T a_3 = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} \\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2} \\end{bmatrix} = \\frac{1}{2} $$\n$$ a_2^T a_3 = \\begin{bmatrix} \\tfrac{1}{2}  \\tfrac{\\sqrt{3}}{2} \\end{bmatrix} \\begin{bmatrix} \\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2} \\end{bmatrix} = \\frac{1}{4} - \\frac{3}{4} = -\\frac{1}{2} $$\n\n情况 1: $S = S_{12} = \\{1,2\\}$\n格拉姆矩阵为 $G_{12} = A_{S_{12}}^T A_{S_{12}} = \\begin{bmatrix} a_1^T a_1  a_1^T a_2 \\\\ a_2^T a_1  a_2^T a_2 \\end{bmatrix} = \\begin{bmatrix} 1  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  1 \\end{bmatrix}$。\n特征方程为 $\\det(G_{12} - \\lambda I) = 0$：\n$$ \\det\\begin{pmatrix} 1-\\lambda  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  1-\\lambda \\end{pmatrix} = (1-\\lambda)^2 - \\left(\\frac{1}{2}\\right)^2 = 0 $$\n$$ (1-\\lambda)^2 = \\frac{1}{4} \\implies 1-\\lambda = \\pm \\frac{1}{2} \\implies \\lambda = 1 \\mp \\frac{1}{2} $$\n特征值为 $\\lambda_{min} = \\frac{1}{2}$ 和 $\\lambda_{max} = \\frac{3}{2}$。\n\n情况 2: $S = S_{13} = \\{1,3\\}$\n格拉姆矩阵为 $G_{13} = A_{S_{13}}^T A_{S_{13}} = \\begin{bmatrix} a_1^T a_1  a_1^T a_3 \\\\ a_3^T a_1  a_3^T a_3 \\end{bmatrix} = \\begin{bmatrix} 1  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  1 \\end{bmatrix}$。\n这与 $G_{12}$ 相同，因此特征值也为 $\\frac{1}{2}$ 和 $\\frac{3}{2}$。\n\n情况 3: $S = S_{23} = \\{2,3\\}$\n格拉姆矩阵为 $G_{23} = A_{S_{23}}^T A_{S_{23}} = \\begin{bmatrix} a_2^T a_2  a_2^T a_3 \\\\ a_3^T a_2  a_3^T a_3 \\end{bmatrix} = \\begin{bmatrix} 1  -\\tfrac{1}{2} \\\\ -\\tfrac{1}{2}  1 \\end{bmatrix}$。\n特征方程为 $\\det(G_{23} - \\lambda I) = 0$：\n$$ \\det\\begin{pmatrix} 1-\\lambda  -\\tfrac{1}{2} \\\\ -\\tfrac{1}{2}  1-\\lambda \\end{pmatrix} = (1-\\lambda)^2 - \\left(-\\frac{1}{2}\\right)^2 = 0 $$\n$$ (1-\\lambda)^2 = \\frac{1}{4} \\implies 1-\\lambda = \\pm \\frac{1}{2} \\implies \\lambda = 1 \\mp \\frac{1}{2} $$\n特征值同样为 $\\lambda_{min} = \\frac{1}{2}$ 和 $\\lambda_{max} = \\frac{3}{2}$。\n\n现在，我们必须找到在所有 $|S| \\leq 2$ 的支撑集 $S$ 上的总的最小和最大特征值。\n对于 $|S|=1$ 的特征值集合是 $\\{1\\}$。\n对于 $|S|=2$ 的特征值集合是 $\\{\\frac{1}{2}, \\frac{3}{2}\\}$。\n结合这些，对于 $k=2$ 需要考虑的全部特征值集合是 $\\{ \\frac{1}{2}, 1, \\frac{3}{2} \\}$。\n全局最小值和最大值是：\n$$ \\lambda_{\\min}^{(2)} = \\min \\left\\{ \\frac{1}{2}, 1, \\frac{3}{2} \\right\\} = \\frac{1}{2} $$\n$$ \\lambda_{\\max}^{(2)} = \\max \\left\\{ \\frac{1}{2}, 1, \\frac{3}{2} \\right\\} = \\frac{3}{2} $$\nRIC $\\delta_2$ 则为：\n$$ \\delta_2 = \\max\\left(1 - \\lambda_{\\min}^{(2)}, \\lambda_{\\max}^{(2)} - 1\\right) = \\max\\left(1 - \\frac{1}{2}, \\frac{3}{2} - 1\\right) = \\max\\left(\\frac{1}{2}, \\frac{1}{2}\\right) = \\frac{1}{2} $$\n\n计算出的受限等距常数为 $\\delta_1 = 0$ 和 $\\delta_2 = \\frac{1}{2}$。问题要求提供有序对 $(\\delta_1, \\delta_2)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在手动计算的基础上，这个练习要求你将计算过程自动化，以处理一个稍大的矩阵。通过编写一个算法来穷举检查所有相关的子矩阵，你将把 $ \\delta_2 $ 的数学定义转化为一个具体的计算程序 。这个练习不仅能巩固你对受限等距性质（RIP）的理解，还能让你直观地感受到验证RIP的组合复杂性，从而理解在实际中发展理论界的必要性。",
            "id": "3474609",
            "problem": "你的任务是推导并实现一个精确计算方法，用于计算一个具有 $n=6$ 列的小型矩阵的 $2$ 阶受限等距性质（RIP）常数。阶数为 $k$ 的受限等距性质（RIP）常数，记作 $\\delta_k$，定义为满足以下条件的最小非负实数 $\\delta$：对于每个 $k$-稀疏向量 $x \\in \\mathbb{R}^n$，\n$$(1 - \\delta)\\,\\|x\\|_2^2 \\le \\|A x\\|_2^2 \\le (1 + \\delta)\\,\\|x\\|_2^2,$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 是一个实数矩阵，$\\|\\cdot\\|_2$ 表示欧几里得范数，一个 $k$-稀疏向量最多有 $k$ 个非零项。受限等距性质（RIP）是压缩感知和稀疏优化中的一个核心概念，因为它量化了线性映射 $A$ 在限制于稀疏向量时与等距变换的接近程度。特别地，$\\delta_k$ 控制着恢复过程中的稳定性和唯一性，并通过子矩阵格拉姆矩阵的特征值界限，直接关系到精确恢复的保证。\n\n从上述定义以及关于格拉姆矩阵、奇异值和特征值的基本线性代数事实出发，推导一个精确计算 $\\delta_2$ 的过程，该过程通过检查所有大小为 $2$ 的支撑集以及相应格拉姆矩阵的极值特征值来实现。具体来说，对于每个 $|S|=2$ 的子集 $S \\subset \\{1,2,\\dots,6\\}$，令 $A_S$ 表示由 $S$ 索引的列组成的 $A$ 的子矩阵。利用对称半正定格拉姆矩阵 $G_S = A_S^\\top A_S$ 的谱性质，对每个 $S$ 确定最小的 $\\delta$，使得\n$$(1 - \\delta)\\,\\|x\\|_2^2 \\le \\|A_S x\\|_2^2 \\le (1 + \\delta)\\,\\|x\\|_2^2 \\quad \\text{for all } x \\in \\mathbb{R}^2.$$\n将所有 $\\binom{6}{2}$ 个支撑集的结果汇总，以获得给定 $A$ 的精确 $\\delta_2$。\n\n你的程序必须：\n- 枚举 $\\{1,2,\\dots,6\\}$ 中所有包含 $2$ 个元素的支撑集 $S$。\n- 对每个支撑集 $S$，构造 $A_S$，计算 $G_S = A_S^\\top A_S$，并找到 $G_S$ 的极值特征值。\n- 对每个 $S$，计算其与等距变换的偏差，即 $G_S$ 的特征值与 $1$ 之间的最大绝对差。\n- 返回在所有大小为 $2$ 的支撑集 $S$ 上的这些偏差的最大值作为 $\\delta_2$。\n\n测试套件：\n为以下每个矩阵计算 $\\delta_2$，所有矩阵均有 $n=6$ 列：\n\n- 情况 1 (理想情况，精确等距)：$A_1 \\in \\mathbb{R}^{6 \\times 6}$ 定义为 $A_1 = I_6$，即 $6 \\times 6$ 的单位矩阵。\n\n- 情况 2 (边界条件，重复列导致边界值 $\\delta_2 = 1$)：$A_2 \\in \\mathbb{R}^{6 \\times 6}$ 的列为 $[e_1, e_1, e_2, e_3, e_4, e_5]$，其中 $e_i \\in \\mathbb{R}^6$ 是第 $i$ 个标准基向量。\n\n- 情况 3 (单位范数列，带有一个受控相关性)：$A_3 \\in \\mathbb{R}^{6 \\times 6}$ 的列为 $[e_1, c_2, e_3, e_4, e_5, e_6]$，其中 $c_2 = 0.4\\,e_1 + \\sqrt{1 - 0.16}\\,e_2$，$e_i \\in \\mathbb{R}^6$ 是标准基向量。注意 $c_2$ 是单位范数向量，且与 $e_1$ 的内积为 $0.4$。\n\n- 情况 4 (非归一化列，对角缩放)：$A_4 \\in \\mathbb{R}^{6 \\times 6}$ 定义为 $A_4 = \\operatorname{diag}(1.2, 0.9, 1.0, 1.0, 1.0, 1.0)$。\n\n- 情况 5 (具有多重相关性的通用高矩阵)：$A_5 \\in \\mathbb{R}^{4 \\times 6}$ 的列为\n$$\nc_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix},\\quad\nc_2 = \\begin{bmatrix} 0.6 \\\\ 0.8 \\\\ 0 \\\\ 0 \\end{bmatrix},\\quad\nc_3 = \\begin{bmatrix} 0 \\\\ 0.3 \\\\ \\sqrt{1 - 0.09} \\\\ 0 \\end{bmatrix},\\quad\nc_4 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0.4 \\\\ \\sqrt{1 - 0.16} \\end{bmatrix},\\quad\nc_5 = \\begin{bmatrix} 0.2 \\\\ 0.1 \\\\ 0.2 \\\\ \\sqrt{1 - 0.04 - 0.01 - 0.04} \\end{bmatrix},\\quad\nc_6 = \\begin{bmatrix} 0.1 \\\\ 0.2 \\\\ 0.1 \\\\ -\\sqrt{1 - 0.01 - 0.04 - 0.01} \\end{bmatrix}.\n$$\n根据构造，$A_5$ 的所有列都是单位范数，且 $A_5 = [c_1\\, c_2\\, c_3\\, c_4\\, c_5\\, c_6]$。\n\n答案规格：\n- 对于每个矩阵 $A_i$，计算出的 $\\delta_2$ 必须以实数（浮点数）形式返回。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中 $r_i$ 是 $A_i$ 的 $\\delta_2$ 值。\n\n此问题不涉及物理单位或角度单位。请确保数值计算是稳定的，并使用对所有大小为 $2$ 的支撑集进行精确枚举的方法，以保证对 $n=6$ 的正确性。",
            "solution": "该问题提法清晰，具有科学依据，并包含足够的信息以获得唯一解。这是受限等距性质（RIP）常数定义的直接应用，而 RIP 常数是压缩感知中的一个基本概念。\n\n对于一个矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其 $k$ 阶受限等距性质（RIP）常数（记作 $\\delta_k$）是使得不等式\n$$ (1 - \\delta_k) \\|x\\|_2^2 \\le \\|Ax\\|_2^2 \\le (1 + \\delta_k) \\|x\\|_2^2 $$\n对所有 $k$-稀疏向量 $x \\in \\mathbb{R}^n$ 成立的最小非负数 $\\delta_k$。如果一个向量 $x$ 最多有 $k$ 个非零项，则称其为 $k$-稀疏向量。\n\n为了计算 $2$ 阶 RIP 常数 $\\delta_2$，我们必须考虑所有 $2$-稀疏向量 $x$。一个 $2$-稀疏向量 $x$ 的非零项位于与一个大小为 $|S|=2$ 的支撑集 $S \\subset \\{1, 2, \\dots, n\\}$ 相对应的索引处。令 $S = \\{i, j\\}$ 且 $i \\neq j$。令 $x_S \\in \\mathbb{R}^2$ 是包含 $x$ 的两个非零项的向量，令 $A_S \\in \\mathbb{R}^{m \\times 2}$ 是由 $A$ 的第 $i$ 列和第 $j$ 列组成的子矩阵。乘积 $Ax$可以写成 $A_S x_S$，并且由于 $x$ 的其他项为零，所以 $\\|x\\|_2^2 = \\|x_S\\|_2^2$。\n\n对于这个特定的支撑集 $S$，RIP 不等式为\n$$ (1 - \\delta) \\|x_S\\|_2^2 \\le \\|A_S x_S\\|_2^2 \\le (1 + \\delta) \\|x_S\\|_2^2 $$\n对所有 $x_S \\in \\mathbb{R}^2$ 成立。当 $x_S \\neq 0$ 时，两边同除以 $\\|x_S\\|_2^2$，我们得到\n$$ 1 - \\delta \\le \\frac{\\|A_S x_S\\|_2^2}{\\|x_S\\|_2^2} \\le 1 + \\delta $$\n中间的表达式是与向量 $x_S$ 相关的格拉姆矩阵 $G_S = A_S^\\top A_S$ 的瑞利商。矩阵 $G_S$ 是一个 $2 \\times 2$ 的对称半正定矩阵。瑞利-里兹定理指出，该商的最小值和最大值分别是 $G_S$ 的最小和最大特征值，我们分别记作 $\\lambda_{\\min}(G_S)$ 和 $\\lambda_{\\max}(G_S)$。\n\n因此，为了使该不等式对所有非零 $x_S \\in \\mathbb{R}^2$ 成立，我们必须满足\n$$ 1 - \\delta \\le \\lambda_{\\min}(G_S) \\quad \\text{and} \\quad \\lambda_{\\max}(G_S) \\le 1 + \\delta $$\n这些条件可以重新整理，以找到适用于支撑集 $S$ 的最小非负 $\\delta$，我们将其记为 $\\delta_S$：\n$$ \\delta \\ge 1 - \\lambda_{\\min}(G_S) \\quad \\text{and} \\quad \\delta \\ge \\lambda_{\\max}(G_S) - 1 $$\n因此，对于给定的支撑集 $S$，最小的有效 $\\delta_S$ 是\n$$ \\delta_S = \\max(1 - \\lambda_{\\min}(G_S), \\lambda_{\\max}(G_S) - 1) $$\n这个值代表了 $G_S$ 的特征值与 $1$ 的最大偏差。\n\n整体的 RIP 常数 $\\delta_2$ 必须满足所有可能的 $2$-稀疏向量的条件，这意味着它必须对所有大小为 $2$ 的可能支撑集 $S$ 都成立。因此，$\\delta_2$ 是所有此类 $\\delta_S$ 的最大值：\n$$ \\delta_2 = \\max_{S \\subset \\{1, \\dots, n\\}, |S|=2} \\delta_S $$\n\n对于给定的 $n=6$ 的问题，步骤如下：\n1.  枚举出 $\\{1, 2, 3, 4, 5, 6\\}$ 中所有 $\\binom{6}{2} = 15$ 个唯一的列索引对 $\\{i, j\\}$。每对构成一个支撑集 $S$。\n2.  对每个支撑集 $S=\\{i, j\\}$，使用 $A$ 的第 $i$ 列和第 $j$ 列构造子矩阵 $A_S$。\n3.  计算 $2 \\times 2$ 的格拉姆矩阵 $G_S = A_S^\\top A_S$。\n4.  计算 $G_S$ 的两个特征值，$\\lambda_{\\min}(G_S)$ 和 $\\lambda_{\\max}(G_S)$。\n5.  计算该支撑集的偏差：$\\delta_S = \\max( \\lambda_{\\max}(G_S) - 1, 1 - \\lambda_{\\min}(G_S) )$。\n6.  RIP 常数 $\\delta_2$ 是在所有 $15$ 个支撑集中找到的 $\\delta_S$ 的最大值。\n\n这种精确枚举的方法保证了对给定矩阵 $\\delta_2$ 计算的正确性。实现将对提供的每个测试案例遵循此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef compute_delta2(A):\n    \"\"\"\n    Computes the order-2 Restricted Isometry Property (RIP) constant delta_2 for a given matrix A.\n\n    Args:\n        A (np.ndarray): The matrix A of size m x n.\n\n    Returns:\n        float: The RIP constant delta_2.\n    \"\"\"\n    m, n = A.shape\n    if n < 2:\n        return 0.0\n\n    max_deviation = 0.0\n\n    # Enumerate all 2-element supports S from {0, 1, ..., n-1}\n    # Note: indices are 0-based\n    for s_indices in itertools.combinations(range(n), 2):\n        # Construct the submatrix A_S\n        A_S = A[:, s_indices]\n\n        # Compute the Gram matrix G_S = A_S^T * A_S\n        G_S = A_S.T @ A_S\n\n        # Find the eigenvalues of the 2x2 symmetric matrix G_S.\n        # np.linalg.eigvalsh is efficient and numerically stable for Hermitian (or real symmetric) matrices.\n        eigenvalues = np.linalg.eigvalsh(G_S)\n        lambda_min = eigenvalues[0]\n        lambda_max = eigenvalues[1]\n\n        # Compute the deviation from isometry for this support\n        deviation_S = max(lambda_max - 1, 1 - lambda_min)\n\n        # Update the overall maximum deviation\n        if deviation_S > max_deviation:\n            max_deviation = deviation_S\n            \n    return max_deviation\n\ndef solve():\n    \"\"\"\n    Solves the problem by computing delta_2 for each test case matrix.\n    \"\"\"\n    # Case 1: A1 = I_6, the 6x6 identity matrix.\n    A1 = np.identity(6)\n\n    # Case 2: A2 with columns [e1, e1, e2, e3, e4, e5].\n    A2 = np.zeros((6, 6))\n    A2[:, 0] = np.array([1, 0, 0, 0, 0, 0])\n    A2[:, 1] = np.array([1, 0, 0, 0, 0, 0])\n    A2[:, 2] = np.array([0, 1, 0, 0, 0, 0])\n    A2[:, 3] = np.array([0, 0, 1, 0, 0, 0])\n    A2[:, 4] = np.array([0, 0, 0, 1, 0, 0])\n    A2[:, 5] = np.array([0, 0, 0, 0, 1, 0])\n    \n    # Case 3: A3 with columns [e1, c2, e3, e4, e5, e6]\n    A3 = np.zeros((6, 6))\n    e1, e2, e3, e4, e5, e6 = np.identity(6)\n    c2 = 0.4 * e1 + np.sqrt(1 - 0.16) * e2\n    A3[:, 0] = e1\n    A3[:, 1] = c2\n    A3[:, 2] = e3\n    A3[:, 3] = e4\n    A3[:, 4] = e5\n    A3[:, 5] = e6\n\n    # Case 4: A4 = diag(1.2, 0.9, 1.0, 1.0, 1.0, 1.0)\n    A4 = np.diag([1.2, 0.9, 1.0, 1.0, 1.0, 1.0])\n\n    # Case 5: A5, a general 4x6 matrix\n    A5 = np.zeros((4, 6))\n    c1 = np.array([1, 0, 0, 0])\n    c2 = np.array([0.6, 0.8, 0, 0])\n    c3 = np.array([0, 0.3, np.sqrt(1 - 0.09), 0])\n    c4 = np.array([0, 0, 0.4, np.sqrt(1 - 0.16)])\n    c5 = np.array([0.2, 0.1, 0.2, np.sqrt(1 - 0.04 - 0.01 - 0.04)])\n    c6 = np.array([0.1, 0.2, 0.1, -np.sqrt(1 - 0.01 - 0.04 - 0.01)])\n    A5 = np.column_stack([c1, c2, c3, c4, c5, c6])\n\n    test_cases = [A1, A2, A3, A4, A5]\n    results = []\n    \n    for A in test_cases:\n        delta_2 = compute_delta2(A)\n        results.append(delta_2)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际应用中，传感矩阵通常不是随机的，而是具有特定结构以便于高效实现。本练习聚焦于部分傅里叶矩阵，这是信号处理和成像领域中压缩感知的基石 。通过为不同的频率选择模式数值计算 $ \\delta_k $，你将获得关于矩阵结构如何影响其等距性质，并进而影响其稀疏恢复性能的直观认识。",
            "id": "3474598",
            "problem": "给定一个由离散傅里叶变换 (DFT) 的部分行构成的结构化感知矩阵族。对于一个正整数 $n$，令 $n \\times n$ 的 DFT 矩阵 $F$ 的元素为 $F_{f,c} = \\exp(-2\\pi i f c / n)$，其中 $f \\in \\{0,1,\\dots,n-1\\}$ 是频率索引，$c \\in \\{0,1,\\dots,n-1\\}$ 是规范坐标基的索引。对于频率索引的子集 $\\Omega \\subset \\{0,1,\\dots,n-1\\}$，其基数为 $m = |\\Omega|$，通过选取由 $\\Omega$ 索引的 $F$ 的行，并将每列归一化为单位欧几里得范数，来定义 $m \\times n$ 的部分傅里叶矩阵 $A$。具体而言，$A$ 的元素为 $A_{r,c} = \\exp(-2\\pi i f_r c / n) / \\sqrt{m}$，其中 $(f_r)_{r=0}^{m-1}$ 枚举了 $\\Omega$ 中的元素。\n\n如果一个向量 $x \\in \\mathbb{C}^n$ 最多有 $k$ 个非零项，则称其为 $k$-稀疏的。限制等距性质 (Restricted Isometry Property, RIP) 要求感知矩阵在所有 $k$-稀疏向量上近似地充当一个等距变换。对于给定的 $k$，限制等距常数 $\\delta_k$ 被定义为满足以下条件的最小非负实数：对于所有 $k$-稀疏向量 $x \\in \\mathbb{C}^n$，都有\n$$(1 - \\delta_k)\\,\\|x\\|_2^2 \\le \\|A x\\|_2^2 \\le (1 + \\delta_k)\\,\\|x\\|_2^2.$$\n\n您的任务是实现一个程序，对于每个指定的测试用例 $(n,\\Omega,k)$，通过对所有大小为 $k$ 的支撑集以及这些支撑集上的极值畸变进行穷举搜索，来精确地数值估计 $\\delta_k$。您必须：\n- 根据上述 $(n,\\Omega)$ 构造 $A$，确保其列为单位范数。\n- 对于每个 $|S| = k$ 的支撑集 $S \\subset \\{0,\\dots,n-1\\}$，考虑支撑在 $S$ 上的 $k$-维向量子空间，并确定在该子空间中，经过线性映射 $A$ 后收缩最强和扩张最强的单位向量。利用这些极值来计算 $S$ 的畸变因子，并取所有此类 $S$ 中的最坏情况以得出 $\\delta_k$。\n\n除了计算 $\\delta_k$，此数值研究还应旨在揭示频率选择模式 $\\Omega$ 以及由此产生的列间相关性如何影响等距常数。使用以下中等规模的测试套件以确保可计算性并探测不同的结构机制：\n- 测试用例 $\\mathbf{1}$ (在素数长度上分布的频率): $n = 17$, $\\Omega = \\{0,2,4,6,8,10,12,14\\}$, $k = 2$。\n- 测试用例 $\\mathbf{2}$ (在偶数长度上的连续低频): $n = 16$, $\\Omega = \\{0,1,2,3,4,5,6,7\\}$, $k = 2$。\n- 测试用例 $\\mathbf{3}$ (边界情况): $n = 16$, $\\Omega = \\{0,1,2,3,4,5,6,7\\}$, $k = 1$。\n- 测试用例 $\\mathbf{4}$ (导致列在周期性上相同的混叠选择): $n = 21$, $\\Omega = \\{0,3,6,9,12,15,18\\}$, $k = 3$。\n- 测试用例 $\\mathbf{5}$ (相对于 $m$ 较大的 $k$): $n = 12$, $\\Omega = \\{0,1,2,3,4,5\\}$, $k = 5$。\n\n所有角度都是通过复指数测量的无量纲相位，单位为弧度；本问题中没有物理单位。\n\n您的程序必须：\n- 通过所述的穷举评估，为每个测试用例精确计算 $\\delta_k$，并对每个支撑集上的极值畸变使用数值稳定的线性代数方法。\n- 生成单行输出，包含测试用例 $\\mathbf{1}$ 到 $\\mathbf{5}$ 的结果，按顺序排列，形式为用方括号括起来的逗号分隔列表，每个值四舍五入到6位小数（例如，$[0.123456,0.000000,0.314159,0.500000,0.271828]$）。每个测试用例的答案必须是单个浮点数。\n\n注意：\n- 从限制等距性质的形式化定义，以及将固定支撑集上的极值畸变解释为由限制在该支撑集上的感知矩阵所诱导的极值二次型出发，来设计您的实现。\n- 通过严格遵循 $A$ 的构造方法，并对给定的适中参数使用精确的穷举支撑集搜索，来确保科学真实性。",
            "solution": "我们从限制等距性质 (RIP) 的定义开始。对于一个矩阵 $A \\in \\mathbb{C}^{m \\times n}$ 和一个稀疏度 $k$， $k$-限制等距常数 $\\delta_k$ 是满足以下条件的最小 $\\delta \\ge 0$：对于所有 $k$-稀疏向量 $x \\in \\mathbb{C}^n$，都有\n$$(1 - \\delta)\\,\\|x\\|_2^2 \\le \\|A x\\|_2^2 \\le (1 + \\delta)\\,\\|x\\|_2^2.$$\n为了对一个固定的有限矩阵 $A$ 精确计算 $\\delta_k$，我们将问题简化为检验 $k$-维坐标子空间。设 $S \\subset \\{0,1,\\dots,n-1\\}$ 是一个基数为 $|S| = k$ 的索引集，并令 $A_S \\in \\mathbb{C}^{m \\times k}$ 表示由 $A$ 中索引为 $S$ 的列构成的子矩阵。任何支撑在 $S$ 上的 $k$-稀疏向量都可以写成 $x = z$ 的形式，其中 $z \\in \\mathbb{C}^k$ 被嵌入到 $S$ 坐标中。于是\n$$\\|A x\\|_2^2 = \\|A_S z\\|_2^2 = z^* (A_S^* A_S)\\, z.$$\n量 $A_S^* A_S$ 是所选列的 $k \\times k$ 格拉姆矩阵，并且是埃尔米特半正定的。对于单位向量 $z$（$\\|z\\|_2 = 1$），二次型 $z^* (A_S^* A_S) z$ 的最小值和最大值分别是 $A_S^* A_S$ 的最小和最大特征值。因此，对于一个固定的 $S$，最紧的双边不等式常数由极值特征值 $\\lambda_{\\min}(A_S^* A_S)$ 和 $\\lambda_{\\max}(A_S^* A_S)$ 决定，而相对于精确等距变换的畸变则由\n$$\\max\\big(1 - \\lambda_{\\min}(A_S^* A_S),\\ \\lambda_{\\max}(A_S^* A_S) - 1\\big)$$\n捕获。取遍所有 $|S|=k$ 的支撑集 $S$ 的最坏情况，得到\n$$\\delta_k = \\max_{S:\\ |S|=k} \\max\\big(1 - \\lambda_{\\min}(A_S^* A_S),\\ \\lambda_{\\max}(A_S^* A_S) - 1\\big).$$\n这直接源于 RIP 的定义以及有限维内积空间中单位球面上极值二次型的谱表征。\n\n对于本问题中的矩阵，$A$ 是一个列归一化的部分傅里叶矩阵。具体来说，对于给定的 $n$ 和频率索引集 $\\Omega = \\{f_0,\\dots,f_{m-1}\\}$，我们定义 $A \\in \\mathbb{C}^{m \\times n}$ 为\n$$A_{r,c} = \\frac{1}{\\sqrt{m}} \\exp\\!\\left(-\\frac{2\\pi i}{n}\\, f_r\\, c\\right),\\quad r \\in \\{0,\\dots,m-1\\},\\ c \\in \\{0,\\dots,n-1\\}.$$\n每列有 $m$ 个单位模的元素，并按 $1/\\sqrt{m}$ 缩放，因此具有单位欧几里得范数，这意味着 $\\delta_1 = 0$，因为任何单列在映射后都能精确保持其范数。$A^* A$ 的非对角元素是编码列之间相关性的归一化复指数和。选择模式 $\\Omega$ 通过类似于狄利克雷核的离散和来确定这些相关性；聚集的低频会产生相对于列索引差异缓慢衰减的相关性，而当步长和 $n$ 共享非平凡的模结构时，某些等差数列会引起精确混叠（相同的列）。\n\n算法设计：\n- 对于每个测试用例 $(n,\\Omega,k)$，使用上述公式构造 $A$。\n- 枚举所有 $\\binom{n}{k}$ 个大小为 $k$ 的索引集 $S$（对于所提供的小 $n$ 和 $k$ 是可行的）。\n- 对于每个 $S$，构建 $G_S = A_S^* A_S$ 并使用埃尔米特求解器计算其特征值。\n- 计算支撑集畸变 $\\max(1 - \\lambda_{\\min}(G_S),\\ \\lambda_{\\max}(G_S) - 1)$。\n- 取所有 $S$ 上的最大值得到 $\\delta_k$。\n- 对所有测试用例重复此过程，并输出四舍五入到6位小数的值。\n\n关于频率选择和列相关的解释：\n- 对于 $k = 1$，列归一化强制 $\\delta_1 = 0$，因为 $G_S = [1]$ 且两个极值特征值都等于 $1$。\n- 当 $\\Omega$ 由偶数长度 $n$ 上的连续低频组成时，由于离散低通核的形状，不同列之间的相关性可能相当大，从而增加了 $\\delta_2$。\n- 当 $\\Omega$ 是一个等差数列，其步长与 $n$ 共享一个非平凡因子时，存在相差特定周期的列索引对，在所选频率下它们变得相同。在这种情况下，对于包含此类列对的支撑集，$G_S$ 的非对角元素等于 $1$，产生重复或高度共线的列，将 $\\lambda_{\\max}$ 推高至远大于 $1$，并对合适的 $k$ 产生 $\\delta_k \\ge 1$。\n- 当 $n$ 为素数且 $\\Omega$ 是分布的（例如，步长模 $n$ 可逆的等差数列），则可以避免精确混叠，非对角相关的离散和在单位圆上分布得更均匀，通常会减小非对角格拉姆矩阵元素的幅值，从而相对于聚集选择降低 $\\delta_2$。尽管如此，在没有随机性的情况下，确定性分布模式仍然表现出结构化相关性；数值结果反映了这种结构。\n\n该实现严格遵循这些原则，使用穷举和谱计算来为每个测试用例提供精确的 $\\delta_k$，这直接量化了频率选择、诱导的列相关性以及由此产生的限制等距行为之间的相互作用。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import combinations\n\ndef partial_fourier_matrix(n, omega):\n    \"\"\"\n    Construct an m x n partial Fourier matrix with unit-norm columns.\n    Entries: A[r, c] = exp(-2π i * f_r * c / n) / sqrt(m), where f_r in omega.\n    \"\"\"\n    m = len(omega)\n    # Create a grid of shape (m, n) for frequencies and column indices\n    freqs = np.array(omega, dtype=np.float64).reshape(-1, 1)  # (m, 1)\n    cols = np.arange(n, dtype=np.float64).reshape(1, -1)      # (1, n)\n    phases = -2.0 * np.pi * freqs * cols / float(n)           # (m, n)\n    A = np.exp(1j * phases) / np.sqrt(m)                      # (m, n), complex\n    return A\n\ndef delta_k_exact(A, k):\n    \"\"\"\n    Compute the exact restricted isometry constant δ_k for matrix A\n    by exhaustive enumeration of all supports of size k.\n    A is m x n with unit-norm columns assumed.\n    \"\"\"\n    m, n = A.shape\n    if k == 0:\n        return 0.0\n    # Precompute list of all combinations of column indices of size k\n    max_delta = 0.0\n    # For numerical stability when comparing, ensure real parts are used for eigenvalues\n    for S in combinations(range(n), k):\n        AS = A[:, S]  # m x k\n        G = (AS.conj().T) @ AS  # k x k Hermitian Gram matrix\n        # Use Hermitian eigenvalue solver\n        eigvals = np.linalg.eigvalsh(G)\n        # Numerical guard: project tiny imaginary parts away and clip tiny negatives due to rounding\n        eigvals = np.real(eigvals)\n        # Compute distortion for this support\n        local_delta = max(abs(1.0 - eigvals.min()), abs(eigvals.max() - 1.0))\n        if local_delta > max_delta:\n            max_delta = local_delta\n    return float(max_delta)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (n, omega_list, k)\n    test_cases = [\n        (17, [0,2,4,6,8,10,12,14], 2),            # Case 1: spread frequencies on prime n\n        (16, [0,1,2,3,4,5,6,7], 2),               # Case 2: consecutive low freqs on even n\n        (16, [0,1,2,3,4,5,6,7], 1),               # Case 3: boundary k=1\n        (21, [0,3,6,9,12,15,18], 3),              # Case 4: aliased selection (step 3) on n=21\n        (12, [0,1,2,3,4,5], 5),                   # Case 5: large k relative to m\n    ]\n\n    results = []\n    for n, omega, k in test_cases:\n        A = partial_fourier_matrix(n, omega)\n        delta = delta_k_exact(A, k)\n        results.append(f\"{delta:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}