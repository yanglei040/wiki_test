{
    "hands_on_practices": [
        {
            "introduction": "要掌握正交匹配追踪（OMP），首先必须深刻理解其迭代核心：找出与信号（或残差）最相关的字典原子，并将信号投影到该原子上。第一个练习  提供了一个使用标准Walsh-Hadamard基的具体计算，让您能够从头开始追踪原子选择和残差计算的基本机理。",
            "id": "1108855",
            "problem": "考虑一个信号向量 $x \\in \\mathbb{R}^N$，其中 $N=2^n$，$n \\geq 1$ 为某个整数。$\\mathbb{R}^N$ 的沃尔什-哈达玛基是一组由 $N$ 个正交向量构成的集合，这些向量是归一化哈达玛矩阵 $\\Psi = \\frac{1}{\\sqrt{N}} H_n$ 的列。哈达玛矩阵 $H_n$ 是一个 $2^n \\times 2^n$ 的矩阵，其递归定义如下：\n$$\nH_0 = (1), \\quad H_k = \\begin{pmatrix} H_{k-1}  H_{k-1} \\\\ H_{k-1}  -H_{k-1} \\end{pmatrix} \\text{ for } k \\ge 1.\n$$\n$\\Psi$ 的列，记为 $\\{\\psi_0, \\psi_1, \\dots, \\psi_{N-1}\\}$，构成了 $\\mathbb{R}^N$ 的一个标准正交基。\n\n正交匹配追踪（OMP）是一种贪心算法，用于使用原子字典（在本例中为沃尔什-哈达玛基）来寻找信号 $x$ 的稀疏近似。该算法迭代进行。\n\n**OMP 算法（第一次迭代）：**\n1.  **初始化：** 初始残差为信号本身，$r_0 = x$。\n2.  **匹配：** 找到与当前残差最相关的基向量 $\\psi_{j_1}$。索引 $j_1$ 的选择方式如下：\n    $$\n    j_1 = \\arg\\max_{j \\in \\{0, \\dots, N-1\\}} |\\langle r_0, \\psi_j \\rangle|\n    $$\n    其中 $\\langle \\cdot, \\cdot \\rangle$ 表示标准的欧几里得内积。如果最大值存在并列，可以选择任何一个使之最大化的索引。\n3.  **投影与残差更新：** 将信号 $x$ 投影到所选基向量 $\\psi_{j_1}$ 的生成空间上，形成第一次近似 $\\hat{x}_1 = \\text{proj}_{\\text{span}(\\psi_{j_1})} x$。然后计算新的残差 $r_1 = x - \\hat{x}_1$。\n\n**问题：**\n对于信号向量 $x = (1, 1, 1, 1, 0, 0, 0, 0)^T \\in \\mathbb{R}^8$，在使用 $N=8$ 的沃尔什-哈达玛基进行单次迭代的正交匹配追踪（OMP）算法后，求残差向量 $r_1$ 的欧几里得范数（$L_2$ 范数）的精确值。",
            "solution": "1. 相关方程  \n   OMP 第一次迭代的残差 $r_1$ 满足\n   $$\n   r_1 \\;=\\; x - \\proj_{\\psi_{j_1}}x,\n   $$\n   且由于 $\\psi_{j_1}$ 是单位向量，\n   $$\n   \\|r_1\\|_2^2 \\;=\\;\\|x\\|_2^2 - |\\langle x,\\psi_{j_1}\\rangle|^2.\n   $$\n\n2. 计算 $\\|x\\|_2^2$  \n   $$\n   x = (1,1,1,1,0,0,0,0)^T \n   \\quad\\Longrightarrow\\quad\n   \\|x\\|_2^2 = 1^2+1^2+1^2+1^2 = 4.\n   $$\n\n3. 计算最大相关性  \n   沃尔什-哈达玛基向量为 $\\psi_j=\\tfrac1{\\sqrt8}h_j$，其中 $h_j\\in\\{\\pm1\\}^8$ 是 $H_3$ 的第 $j$ 列。由于 $x$ 仅在前四个坐标处有非零项，对于每个 $j$  \n   $$\n   \\langle x,\\psi_j\\rangle\n   = \\frac1{\\sqrt8}\\sum_{i=0}^3 h_{i,j}.\n   $$\n   可以验证，当 $j\\equiv0\\pmod4$ 时，$h_j$ 的前四项之和的绝对值最大，得到\n   $$\n   \\max_j|\\langle x,\\psi_j\\rangle|\n   = \\frac1{\\sqrt8}(4) = \\frac{4}{2\\sqrt2} = \\sqrt2.\n   $$\n\n4. 残差范数  \n   $$\n   \\|r_1\\|_2\n   = \\sqrt{\\|x\\|_2^2 - \\bigl(\\max_j|\\langle x,\\psi_j\\rangle|\\bigr)^2}\n   = \\sqrt{4 - (\\sqrt2)^2}\n   = \\sqrt{2}.\n   $$",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "虽然OMP的贪婪策略很直观，但它并非万无一失。其性能严重依赖于字典的几何结构，特别是其互相关性（mutual coherence）。本练习  构建了一个引人注目的场景，其中两个原子高度相关，导致OMP在第一步就做出错误的选择。通过这个例子，您将深刻理解为何贪婪方法会失败，并体会到字典设计在稀疏恢复中的重要性。",
            "id": "3387250",
            "problem": "考虑稀疏数据同化中使用的线性逆模型 $y = A x$，其中 $A \\in \\mathbb{R}^{2 \\times 3}$ 是一个具有单位范数列的字典，$x \\in \\mathbb{R}^{3}$ 是一个稀疏系数向量。贪婪恢复算法正交匹配追踪 (Orthogonal Matching Pursuit, OMP)，其定义为在第一次迭代时选择与残差（初始化为 $r^{(0)} = y$）具有最大绝对相关性的 $A$ 的列（原子），在字典包含高度相干的原子时可能会失败。\n\n构建以下具有单位范数原子的字典：\n- $a_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，\n- $a_{2} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$，其中 $\\theta = \\arccos(0.99)$，\n- $a_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n设真实的稀疏信号由原子 $a_{2}$ 和 $a_{3}$ 支撑，其系数为\n- $x_{2}^{\\star} = 1$，\n- $x_{3}^{\\star} = -\\sin\\theta$，\n且 $x_{1}^{\\star} = 0$。因此，观测数据为 $y = A x^{\\star} = a_{2} x_{2}^{\\star} + a_{3} x_{3}^{\\star}$。\n\n计算决定 OMP 首次选择的三个绝对相关性\n$$c_{i} = \\left| \\langle a_{i}, y \\rangle \\right|, \\quad i \\in \\{1,2,3\\},$$\n从而证明 $a_{1}$ 和 $a_{2}$ 之间的高度相干性所产生的误导效应。提供这三个相关性的数值。无需四舍五入；使用由 $\\cos\\theta = 0.99$ 和 $\\sin\\theta = \\sqrt{1 - 0.99^{2}}$ 所隐含的精确值。",
            "solution": "该问题要求在一个特定的稀疏恢复设置下，计算 $i \\in \\{1,2,3\\}$ 的绝对相关性 $c_{i} = \\left| \\langle a_{i}, y \\rangle \\right|$。正交匹配追踪 (OMP) 算法在其第一步中，选择与测量向量 $y$ 具有最大绝对相关性的原子（字典 $A$ 的列）。真实的稀疏信号 $x^{\\star}$ 由原子 $a_{2}$ 和 $a_{3}$ 支撑，这意味着这些是“正确”的原子。\n\n第一步是计算测量向量 $y$。模型由 $y = A x^{\\star}$ 给出。由于真实信号是稀疏的，其非零系数为 $x_2^{\\star}$ 和 $x_3^{\\star}$，因此测量向量 $y$ 是相应原子 $a_{2}$ 和 $a_{3}$ 的线性组合。\n\n给定的原子是：\n$$a_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad a_{2} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad a_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n给定 $\\cos\\theta = 0.99$。由于 $\\theta = \\arccos(0.99)$ 是反余弦函数的主值，$\\theta \\in [0, \\pi]$，这保证了 $\\sin\\theta = \\sqrt{1 - \\cos^2\\theta} \\ge 0$。\n\n真实的系数是 $x_{1}^{\\star} = 0$，$x_{2}^{\\star} = 1$ 和 $x_{3}^{\\star} = -\\sin\\theta$。\n因此，测量向量 $y$ 是：\n$$y = a_{2} x_{2}^{\\star} + a_{3} x_{3}^{\\star} = a_{2}(1) + a_{3}(-\\sin\\theta)$$\n代入向量定义：\n$$y = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} - \\sin\\theta \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta - \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta \\\\ 0 \\end{pmatrix}$$\n\n现在，我们可以计算三个绝对相关性 $c_{1}$、$c_{2}$ 和 $c_{3}$。内积 $\\langle u, v \\rangle$ 定义为标准点积 $u^T v$。\n\n1.  计算 $c_{1} = |\\langle a_{1}, y \\rangle|$：\n    $$\\langle a_{1}, y \\rangle = a_{1}^T y = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ 0 \\end{pmatrix} = (1)(\\cos\\theta) + (0)(0) = \\cos\\theta$$\n    给定 $\\cos\\theta = 0.99$，其为正数，绝对值为：\n    $$c_{1} = |\\cos\\theta| = 0.99$$\n\n2.  计算 $c_{2} = |\\langle a_{2}, y \\rangle|$：\n    $$\\langle a_{2}, y \\rangle = a_{2}^T y = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ 0 \\end{pmatrix} = (\\cos\\theta)(\\cos\\theta) + (\\sin\\theta)(0) = \\cos^2\\theta$$\n    由于 $\\cos^2\\theta$ 是非负的，绝对值为：\n    $$c_{2} = |\\cos^2\\theta| = \\cos^2\\theta = (0.99)^2 = 0.9801$$\n\n3.  计算 $c_{3} = |\\langle a_{3}, y \\rangle|$：\n    $$\\langle a_{3}, y \\rangle = a_{3}^T y = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ 0 \\end{pmatrix} = (0)(\\cos\\theta) + (1)(0) = 0$$\n    绝对值为：\n    $$c_{3} = |0| = 0$$\n\n这三个相关性是 $c_1 = 0.99$，$c_2 = 0.9801$ 和 $c_3 = 0$。\nOMP 算法选择与最大相关性对应的原子 $a_k$，即 $k = \\arg\\max_i c_i$。在这种情况下，由于 $0.99 > 0.9801 > 0$，我们有 $c_1 > c_2 > c_3$。因此，OMP 在其第一次迭代中选择了原子 $a_1$。\n这证明了 OMP 在这个特定案例中的失败。真实信号由原子 $a_2$ 和 $a_3$ 组成，但算法错误地选择了原子 $a_1$。这是原子 $a_1$ 和 $a_2$ 之间的高度相干性（其中 $\\langle a_1, a_2 \\rangle = \\cos\\theta = 0.99$）以及信号系数的特定构造直接导致的结果。\n\n所需的三个相关性的数值为：\n$$c_{1} = 0.99$$\n$$c_{2} = 0.9801$$\n$$c_{3} = 0$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0.99  0.9801  0 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了像互相关性这样的理论限制外，实际执行中的细节也可能使OMP失效。一个微妙但关键的要点是，算法的许多理论保证都假设所有字典原子具有相同的能量（即单位范数）。本练习  精确地量化了当字典列未被归一化时引入的偏差，揭示了范数较大的原子如何可能被错误地选中，即使它在归一化意义上与信号的相关性较小。这凸显了在算法应用中进行适当数据预处理的必要性。",
            "id": "3464862",
            "problem": "考虑一个压缩感知中的测量模型，其中测量矩阵 $A \\in \\mathbb{R}^{m \\times 3}$ 的列 $a_{1}$、$a_{2}$ 和 $a_{3}$ 由 $a_{j} = c_{j} u_{j}$ 给出，其中 $u_{j} \\in \\mathbb{R}^{m}$ 是单位范数向量，而 $c_{j} = \\|a_{j}\\|_{2}$ 是正缩放因子。这些单位范数向量满足内积关系 $\\langle u_{1}, u_{2} \\rangle = 0$、$\\langle u_{1}, u_{3} \\rangle = \\frac{1}{2}$ 和 $\\langle u_{2}, u_{3} \\rangle = \\frac{1}{4}$。这些选择与一个正定格拉姆矩阵 (Gram matrix) 相符，因此定义了一个科学上有效的字典几何结构。\n\n设未知的稀疏系数向量为 $x^{\\star} = (\\beta_{1}, \\beta_{2}, 0)^{\\top}$，其中 $\\beta_{1} = 1$ 且 $\\beta_{2} = 0.4$，并考虑无噪声测量 $y = A x^{\\star}$。在第一次迭代中，正交匹配追踪 (Orthogonal Matching Pursuit, OMP) 算法将选择使与初始残差 $r^{(0)} = y$ 的内积绝对值 $|\\langle a_{j}, r^{(0)} \\rangle|$ 最大化的列索引 $j$，即选择使 $|\\langle a_{j}, y \\rangle|$ 最大化的索引。当列未被归一化时，此规则可能会引入一种偏向于范数较大列的系统性偏差。\n\n为揭示并量化此偏差，固定 $c_{1} = 1$，$c_{2} = 0.8$，并令 $c_{3}  0$ 为一个自由参数。定义一个归一化评分规则，该规则在列被预先归一化的情况下使用，即使用 $\\tilde{a}_{j} = a_{j} / \\|a_{j}\\|_{2}$，因此归一化评分为 $|\\langle \\tilde{a}_{j}, y \\rangle| = |\\langle a_{j}, y \\rangle| / \\|a_{j}\\|_{2}$。在此设定下，计算最小值 $c_{3}^{\\star}$，使得在第一次迭代中，未归一化的 OMP 规则选择索引 $j = 3$ 而非 $j = 1$，而归一化规则仍然偏好 $j = 1$。将 $c_{3}^{\\star}$ 解释为，在未归一化 OMP 下导致错误选择所需的、由列范数引起的偏差的精确解析量化。请以单一封闭形式表达式给出 $c_{3}^{\\star}$ 的精确值。无需四舍五入。",
            "solution": "此题要求找到列范数缩放因子 $c_3^{\\star}$ 的最小值，该值导致未归一化的正交匹配追踪 (OMP) 算法错误地选择一个字典列，而该算法的归一化版本仍会做出正确的选择。\n\n### 第一步：提取已知条件\n- 测量矩阵 $A \\in \\mathbb{R}^{m \\times 3}$，其列为 $a_1, a_2, a_3$。\n- 列结构：$a_j = c_j u_j$，其中 $u_j \\in \\mathbb{R}^m$ 是单位范数向量（$\\|u_j\\|_2 = 1$），$c_j = \\|a_j\\|_2  0$ 是缩放因子。\n- 单位向量的内积：$\\langle u_1, u_2 \\rangle = 0$，$\\langle u_1, u_3 \\rangle = \\frac{1}{2}$，以及 $\\langle u_2, u_3 \\rangle = \\frac{1}{4}$。\n- 真实稀疏系数向量：$x^{\\star} = (\\beta_1, \\beta_2, 0)^{\\top}$，其中 $\\beta_1 = 1$ 且 $\\beta_2 = 0.4$。\n- 无噪声测量向量：$y = A x^{\\star}$。\n- 第一轮 OMP 选择规则：\n    - 未归一化：选择使 $|\\langle a_j, y \\rangle|$ 最大化的 $j$。\n    - 归一化：选择使 $\\frac{|\\langle a_j, y \\rangle|}{\\|a_j\\|_2}$ 最大化的 $j$。\n- 给定的缩放因子：$c_1 = 1$，$c_2 = 0.8$。$c_3  0$ 是一个变量。\n\n### 第二步：使用提取的已知条件进行验证\n根据所需标准对问题进行验证。\n- **科学依据**：该问题设置在压缩感知和稀疏近似的标准框架内，具体分析了 OMP 算法的行为。字典列的几何构型由构成的单位向量的内积定义。这些向量的格拉姆矩阵 (Gram matrix) $G$ 由 $G_{ij} = \\langle u_i, u_j \\rangle$ 给出。\n$$ G = \\begin{pmatrix} 1  0  \\frac{1}{2} \\\\ 0  1  \\frac{1}{4} \\\\ \\frac{1}{2}  \\frac{1}{4}  1 \\end{pmatrix} $$\n$G$ 的顺序主子式为 $M_1=1  0$，$M_2 = \\det \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = 1  0$，以及 $M_3 = \\det(G) = 1(1 - (\\frac{1}{4})^2) - 0 + \\frac{1}{2}(0 - \\frac{1}{2}) = 1 - \\frac{1}{16} - \\frac{1}{4} = \\frac{11}{16}  0$。根据西尔维斯特准则 (Sylvester's criterion)，$G$ 是正定的，这证实了这样一组向量 $\\{u_1, u_2, u_3\\}$ 在 $\\mathbb{R}^m$ (对于 $m \\ge 3$) 中是几何上可实现的。因此，该问题在科学上是合理的。\n- **适定且客观**：问题要求一个特定的量 $c_3^{\\star}$，该量从一组清晰明确的数学条件中导出。问题陈述客观，没有主观语言。\n- **完整且一致**：所有必要的参数和条件都已提供，并且没有内部矛盾。\n\n该问题被认为是**有效的**。\n\n### 第三步：推导解答\n求解过程首先计算测量向量 $y$，然后计算未归一化和归一化 OMP 的选择得分，最后求解 $c_3$ 的临界值。\n\n首先，我们用给定的量表示测量向量 $y$。\n$y = A x^{\\star} = \\sum_{j=1}^{3} a_j x^{\\star}_j = a_1\\beta_1 + a_2\\beta_2$。\n代入 $a_j = c_j u_j$ 以及给定的系数和缩放因子值：\n$\\beta_1 = 1$，$\\beta_2 = 0.4 = \\frac{4}{10} = \\frac{2}{5}$。\n$c_1 = 1$，$c_2 = 0.8 = \\frac{8}{10} = \\frac{4}{5}$。\n$y = (c_1 u_1)\\beta_1 + (c_2 u_2)\\beta_2 = (1 \\cdot u_1)(1) + (\\frac{4}{5} \\cdot u_2)(\\frac{2}{5}) = u_1 + \\frac{8}{25} u_2$。\n\n接下来，我们计算未归一化 OMP 选择规则的得分，即对于 $j \\in \\{1, 2, 3\\}$ 的内积绝对值 $|\\langle a_j, y \\rangle|$。初始残差为 $r^{(0)} = y$。\n\n对于索引 $j=1$：\n$$ |\\langle a_1, y \\rangle| = |\\langle c_1 u_1, u_1 + \\frac{8}{25} u_2 \\rangle| = c_1 \\left| \\langle u_1, u_1 \\rangle + \\frac{8}{25} \\langle u_1, u_2 \\rangle \\right| $$\n使用 $c_1=1$，$\\langle u_1, u_1 \\rangle = \\|u_1\\|_2^2 = 1$，以及 $\\langle u_1, u_2 \\rangle = 0$：\n$$ |\\langle a_1, y \\rangle| = 1 \\cdot \\left| 1 + \\frac{8}{25} \\cdot 0 \\right| = 1 $$\n\n对于索引 $j=3$：\n$$ |\\langle a_3, y \\rangle| = |\\langle c_3 u_3, u_1 + \\frac{8}{25} u_2 \\rangle| = c_3 \\left| \\langle u_3, u_1 \\rangle + \\frac{8}{25} \\langle u_3, u_2 \\rangle \\right| $$\n使用给定的内积 $\\langle u_1, u_3 \\rangle = \\frac{1}{2}$ 和 $\\langle u_2, u_3 \\rangle = \\frac{1}{4}$：\n$$ |\\langle a_3, y \\rangle| = c_3 \\left| \\frac{1}{2} + \\frac{8}{25} \\cdot \\frac{1}{4} \\right| = c_3 \\left| \\frac{1}{2} + \\frac{2}{25} \\right| = c_3 \\left| \\frac{25}{50} + \\frac{4}{50} \\right| = c_3 \\frac{29}{50} $$\n\n现在，考虑问题中指定的两个条件。\n1. 未归一化的 OMP 规则选择索引 $j=3$ 而非 $j=1$。这要求严格不等式 $|\\langle a_3, y \\rangle|  |\\langle a_1, y \\rangle|$。\n问题要求的是发生这种情况的*最小*值 $c_3^{\\star}$。该值对应于满足此不等式的 $c_3$ 值集合的下确界。此下确界在边界处取得，即得分相等时：\n$$ |\\langle a_3, y \\rangle| = |\\langle a_1, y \\rangle| \\implies c_3^{\\star} \\frac{29}{50} = 1 $$\n解出 $c_3^{\\star}$：\n$$ c_3^{\\star} = \\frac{50}{29} $$\n对于任何 $c_3  c_3^{\\star}$，未归一化的 OMP 规则将选择索引 3 而非索引 1。\n\n2. 归一化的 OMP 规则仍然偏好 $j=1$。这意味着 $j=1$ 的归一化得分必须大于 $j=3$ 的归一化得分。索引 $j$ 的归一化得分为 $\\frac{|\\langle a_j, y \\rangle|}{\\|a_j\\|_2} = \\frac{|\\langle a_j, y \\rangle|}{c_j}$。\n\n对于索引 $j=1$：\n$$ \\frac{|\\langle a_1, y \\rangle|}{c_1} = \\frac{1}{1} = 1 $$\n对于索引 $j=3$：\n$$ \\frac{|\\langle a_3, y \\rangle|}{c_3} = \\frac{c_3 \\frac{29}{50}}{c_3} = \\frac{29}{50} $$\n归一化规则偏好 $j=1$ 而非 $j=3$ 的条件是：\n$$ \\frac{|\\langle a_1, y \\rangle|}{c_1}  \\frac{|\\langle a_3, y \\rangle|}{c_3} \\implies 1  \\frac{29}{50} $$\n这个不等式是成立的，因为 $1  0.58$。此条件独立于 $c_3$ 的值成立，因此对于阈值 $c_3^{\\star}$ 和任何 $c_3  c_3^{\\star}$ 都成立。\n\n因此，标志着未归一化 OMP 算法开始出现错误选择的最小值 $c_3^{\\star}$ 是 $\\frac{50}{29}$。这个值量化了偏差：列 $a_3$ 的范数必须相对于列 $a_1$ 的范数被放大至少 $\\frac{50}{29} \\approx 1.724$ 倍，以补偿其与信号 $y$ 较弱的相关性（归一化相关性为 $\\frac{29}{50}$ 对比 $1$），从而导致未归一化的算法错误地选择它。",
            "answer": "$$\\boxed{\\frac{50}{29}}$$"
        }
    ]
}