{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的算法之前，建立对基追踪问题的几何直观至关重要。这个练习  使用一个简单的二维例子，直观地揭示了基追踪问题何时会产生唯一的稀疏解，以及何时会产生无穷多个最优解。通过将代数约束 $Ax=b$ 视为一个仿射子空间，并考察其与 $\\ell_1$ 单位球的交集，我们可以深刻理解解的结构及其唯一性条件。",
            "id": "3458047",
            "problem": "考虑基追踪（Basis Pursuit, BP）问题，即在满足线性等式约束的条件下最小化 $\\ell_{1}$ 范数。设 $A \\in \\mathbb{R}^{1 \\times 2}$ 和 $b \\in \\mathbb{R}^{1}$ 由 $A = \\begin{pmatrix} 1  1 \\end{pmatrix}$ 和 $b = 1$ 指定。BP 问题是在 $Ax = b$ 的约束下，对所有 $x \\in \\mathbb{R}^{2}$ 最小化 $\\|x\\|_{1}$。您的任务如下：\n\n- 从 $\\ell_{1}$ 范数和线性等式约束的定义出发，通过引入代表 $x$ 正部和负部的非负变量，将 BP 问题写成一个线性规划（linear program, LP）。\n\n- 仅使用绝对值和凸几何的基本性质，确定此 BP 实例的最优解全集，并证明存在无穷多个最优解。\n\n- 计算所有最优解集合（视为 $\\mathbb{R}^{2}$ 的一个子集）的欧几里得长度。\n\n- 从 $\\ell_{1}$ 球的一个面与仿射集 $\\{x \\in \\mathbb{R}^{2} : Ax = b\\}$ 的交集的角度，解释非唯一性的几何原因。\n\n作为最终答案，请提供最优解集欧几里得长度的单个精确表达式。请勿对答案进行四舍五入。",
            "solution": "该问题是基追踪（Basis Pursuit, BP）的一个实例，它是一种形式如下的优化问题：\n$$ \\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad Ax = b $$\n这里，给定 $n=2$，矩阵 $A \\in \\mathbb{R}^{1 \\times 2}$ 为 $A = \\begin{pmatrix} 1  1 \\end{pmatrix}$，向量 $b \\in \\mathbb{R}^{1}$ 为 $b = 1$。变量为 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathbb{R}^{2}$。因此，问题是：\n$$ \\min_{x_1, x_2} (|x_1| + |x_2|) \\quad \\text{subject to} \\quad x_1 + x_2 = 1 $$\n\n首先，我们将此问题表述为一个线性规划（LP）。对于任意实变量 $z$，我们可以将其写成两个非负变量的差，即 $z = u - v$，其中 $u \\ge 0$ 且 $v \\ge 0$。一种常见的方法是令 $u = \\max(0, z)$ 和 $v = \\max(0, -z)$。通过这种选择，绝对值由 $|z| = u + v$ 给出。我们将此分解应用于 $x$ 的两个分量：\n令 $x_1 = u_1 - v_1$ 和 $x_2 = u_2 - v_2$，其中 $u_1, u_2, v_1, v_2 \\ge 0$。\n目标函数 $\\|x\\|_1 = |x_1| + |x_2|$ 需要被最小化。为确保线性，我们用 $u_i + v_i$ 替换 $|x_i|$。LP 的目标函数变为 $\\min (u_1 + v_1 + u_2 + v_2)$。最小化过程本身确保了在最优解处，我们有 $u_i v_i = 0$，这意味着 $|x_i| = u_i + v_i$。\n等式约束 $Ax = b$ 变为：\n$$ \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} u_1 - v_1 \\\\ u_2 - v_2 \\end{pmatrix} = 1 $$\n$$ (u_1 - v_1) + (u_2 - v_2) = 1 $$\n因此，该 BP 问题可以写成以下 LP：\n$$ \\text{最小化} \\quad u_1 + v_1 + u_2 + v_2 $$\n$$ \\text{约束条件} \\quad u_1 - v_1 + u_2 - v_2 = 1 $$\n$$ u_1, v_1, u_2, v_2 \\ge 0 $$\n\n接下来，我们确定所有最优解的集合。我们直接分析原始问题陈述。约束条件是 $x_1 + x_2 = 1$。目标是最小化 $f(x_1, x_2) = |x_1| + |x_2|$。\n根据三角不等式，对于任意实数 $x_1$ 和 $x_2$，我们有：\n$$ |x_1| + |x_2| \\ge |x_1 + x_2| $$\n使用约束条件 $x_1 + x_2 = 1$，我们可以为目标函数建立一个下界：\n$$ |x_1| + |x_2| \\ge |1| = 1 $$\n这表明目标函数的最小可能值至少为 $1$。现在我们需要确定这个值是否可以达到。\n三角不等式中的等号成立条件，即 $|a| + |b| = |a+b|$，当且仅当 $a$ 和 $b$ 同号（即 $ab \\ge 0$），这意味着 $a,b \\ge 0$ 或 $a,b \\le 0$。\n因此，我们寻找满足约束条件 $x_1 + x_2 = 1$ 和条件 $x_1 x_2 \\ge 0$ 的解 $(x_1, x_2)$。\n我们来考察 $x_1 x_2 \\ge 0$ 的两种情况：\n1.  情况 $x_1 \\ge 0$ 且 $x_2 \\ge 0$：约束条件是 $x_1 + x_2 = 1$。在这种情况下，目标函数变为 $|x_1| + |x_2| = x_1 + x_2$。由于约束条件，目标函数值恰好为 $1$。因此，任何满足 $x_1 \\ge 0$，$x_2 \\ge 0$ 和 $x_1+x_2=1$ 的点 $(x_1, x_2)$ 都是一个最优解。这组点在笛卡尔平面的第一象限构成一个线段，其端点为 $(1,0)$ 和 $(0,1)$。\n2.  情况 $x_1 \\le 0$ 且 $x_2 \\le 0$：两个非正数的和必须是非正数。因此，$x_1 + x_2$ 不可能等于 $1$。在这种情况下没有解。\n\n通过以上分析，目标函数的最小值确实是 $1$。最优解的全集，我们记为 $S_{opt}$，由下式给出：\n$$ S_{opt} = \\{ (x_1, x_2) \\in \\mathbb{R}^2 \\mid x_1 + x_2 = 1, x_1 \\ge 0, x_2 \\ge 0 \\} $$\n由于该集合是一个线段，它包含无穷多个点。例如，$(\\frac{1}{2}, \\frac{1}{2})$、$(\\frac{1}{3}, \\frac{2}{3})$ 和 $(\\frac{1}{4}, \\frac{3}{4})$ 都是最优解。\n\n第三个任务是计算这个最优解集合的欧几里得长度。集合 $S_{opt}$ 是连接点 $P_1 = (1, 0)$ 和点 $P_2 = (0, 1)$ 的线段。该线段的欧几里得长度 $L$ 是 $P_1$ 和 $P_2$ 之间的距离：\n$$ L = \\sqrt{(1-0)^2 + (0-1)^2} = \\sqrt{1^2 + (-1)^2} = \\sqrt{1+1} = \\sqrt{2} $$\n\n最后，我们解释非唯一性的几何原因。该问题等价于在仿射集 $\\mathcal{A} = \\{x \\in \\mathbb{R}^2 \\mid Ax=b\\}$ 中找到一个具有最小 $\\ell_1$-范数的点。从几何上看，这意味着找到最小的半径 $c$，使得 $\\ell_1$-球 $B_1(c) = \\{ x \\in \\mathbb{R}^2 \\mid \\|x\\|_1 \\le c \\}$ 与仿射集 $\\mathcal{A}$ 相交。\n在 $\\mathbb{R}^2$ 中，水平集 $\\|x\\|_1 = c$ 是旋转了 $45^\\circ$ 的正方形，其顶点位于 $(c, 0)$、$(-c, 0)$、$(0, c)$ 和 $(0, -c)$。仿射集 $\\mathcal{A}$ 是由方程 $x_1 + x_2 = 1$ 定义的直线。\n我们实际上是在“膨胀”一个以原点为中心的 $\\ell_1$-球，直到它首次接触到直线 $x_1 + x_2 = 1$。满足条件的最小球对应于 $c=1$。这个球的边界 $\\|x\\|_1 = 1$ 由 $|x_1|+|x_2|=1$ 给出。\n直线 $x_1+x_2=1$ 与这个 $\\ell_1$-球相交。我们来分析一下交集。这个 $\\ell_1$-球在第一象限（$x_1 \\ge 0, x_2 \\ge 0$）的面由方程 $x_1+x_2=1$ 描述。这恰好是定义仿射约束集 $\\mathcal{A}$ 的直线的一部分。\n因此，与仿射集相交的最小 $\\ell_1$-球的交集不是一个单点（一个顶点），而是 $\\ell_1$-球的一个完整的面（一条边）。这个交集就是最优解的集合。因为交集是一条线段，所以存在无穷多个最优解。非唯一性的产生是因为仿射超平面 $Ax=b$ 与多面体 $\\ell_1$-球的一个面平行。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "掌握了几何直观后，下一个核心实践步骤是将非线性的 $\\ell_1$ 范数目标函数转化为标准线性规划（LP）求解器能够处理的形式。这个练习  引导我们通过两种不同的变量替换技巧来完成这一转换：变量拆分法与引入边界和松弛变量法。通过比较这两种等价形式下约束矩阵的稀疏性，我们能更好地理解不同数学表述在计算效率上的优劣，这对于在实际中高效求解大规模稀疏恢复问题至关重要。",
            "id": "3458102",
            "problem": "考虑由一范数最小化定义的基追踪问题\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad A x = b,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 是行满秩矩阵，$b \\in \\mathbb{R}^{m}$，一范数定义为 $\\|x\\|_{1} = \\sum_{i=1}^{n} |x_{i}|$。令 $s$ 表示 $A$ 中非零元素的数量，即 $s = \\operatorname{nnz}(A)$。你需要将这个基追踪问题转换成标准的线性规划（LP）形式，该形式定义为在等式约束和非负约束下最小化一个线性目标，并采用两种不同的方法：\n\n1. 使用分裂变量，将一个自由变量表示为两个非负变量的差。\n2. 使用显式的绝对值界限变量，并结合松弛变量将不等式转换为等式，同时使用分裂变量来确保任何引入的自由变量的非负性。\n\n仅从一范数、绝对值和标准LP形式的核心定义出发，推导这两种标准形式的LP。对于每个推导出的LP，构建相应的等式约束系数矩阵，并用 $n$、$m$ 和 $s$ 精确地计算其非零元素的数量。最后，将 $R(s,n)$ 定义为第二种形式的等式约束矩阵中非零元素的数量与第一种形式的比值，并给出 $R(s,n)$ 的简化、闭式解析表达式。\n\n你的最终答案必须是 $R(s,n)$ 的闭式表达式。",
            "solution": "问题陈述在凸优化领域内是内部一致、有科学依据且格式规范的。解决问题所需的所有定义和条件都已提供。因此，该问题被认为是有效的。我们开始进行推导。\n\n基追踪问题由以下优化程序给出：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad A x = b\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 是行满秩矩阵，$b \\in \\mathbb{R}^{m}$，$\\|x\\|_{1} = \\sum_{i=1}^{n} |x_{i}|$，且 $s = \\operatorname{nnz}(A)$ 是 $A$ 中非零元素的数量。一个标准的线性规划（LP）问题定义为：\n$$\n\\min_{z} c^{T}z \\quad \\text{subject to} \\quad Gz = h, \\quad z \\ge 0\n$$\n其中向量不等式 $z \\ge 0$ 表示 $z$ 的每个分量都是非负的。\n\n### 形式一：使用分裂变量\n\n这种方法直接处理非线性目标函数和自由变量 $x_i$（其可为正、可为负、也可为零）。\n\n首先，我们将每个自由变量 $x_i$ 表示为两个非负变量 $u_i$ 和 $v_i$ 的差：\n$$\nx_i = u_i - v_i, \\quad \\text{with } u_i \\ge 0, v_i \\ge 0.\n$$\n用向量形式表示，即 $x = u - v$，其中 $u, v \\in \\mathbb{R}^{n}$，$u \\ge 0$ 且 $v \\ge 0$。\n\n接着，我们处理一范数目标函数 $\\|x\\|_1 = \\sum_{i=1}^{n} |x_i|$。对于任何一对满足 $x_i = u_i - v_i$ 的非负数 $u_i, v_i$，绝对值 $|x_i|$ 的下界为 $|u_i - v_i| \\le u_i + v_i$。等式 $|x_i| = u_i + v_i$ 成立的充要条件是 $u_i$ 或 $v_i$ 中至少有一个为零。这个条件 $u_i v_i = 0$ 被称为互补性。\n\n最小化 $\\sum_{i=1}^{n} (u_i + v_i)$ 会自然地强制满足这种互补性。如果某个解存在 $u_i  0$ 和 $v_i  0$，我们可以定义 $\\delta = \\min(u_i, v_i)  0$，并设 $u'_i = u_i - \\delta$ 和 $v'_i = v_i - \\delta$。这样 $x_i = u'_i - v'_i$ 保持不变，满足约束 $Ax=b$。然而，目标函数项 $u_i + v_i$ 将被替换为 $u'_i + v'_i = u_i + v_i - 2\\delta$，这是一个更小的值。因此，任何最优解都必须对所有 $i$ 满足 $\\min(u_i, v_i) = 0$。因此，我们可以将目标 $\\min \\|x\\|_1$ 替换为 $\\min \\sum_{i=1}^{n} (u_i + v_i)$。\n\n综合这些步骤，基追踪问题等价于以下LP：\n$$\n\\min_{u, v} \\sum_{i=1}^{n} (u_i + v_i) \\quad \\text{subject to} \\quad A(u - v) = b, \\quad u \\ge 0, \\quad v \\ge 0.\n$$\n这是标准LP形式。优化变量是 $z_1 = \\begin{pmatrix} u \\\\ v \\end{pmatrix} \\in \\mathbb{R}^{2n}$。线性目标是 $c_1^T z_1$，其中 $c_1$ 是一个包含 $2n$ 个1的向量。等式约束是 $Au - Av = b$，可以写成：\n$$\n\\begin{pmatrix} A  -A \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\end{pmatrix} = b.\n$$\n第一种形式的等式约束系数矩阵，我们记为 $A_1$，是：\n$$\nA_1 = \\begin{pmatrix} A  -A \\end{pmatrix}.\n$$\n这个矩阵的维度是 $m \\times 2n$。$A_1$ 中非零元素的数量，记为 $N_1$，是其各块中非零元素数量之和：\n$$\nN_1 = \\operatorname{nnz}(A_1) = \\operatorname{nnz}(A) + \\operatorname{nnz}(-A).\n$$\n由于将一个矩阵乘以一个非零标量（此处为-1）不会改变其非零元素的数量，因此 $\\operatorname{nnz}(-A) = \\operatorname{nnz}(A) = s$。所以，\n$$\nN_1 = s + s = 2s.\n$$\n\n### 形式二：使用界限变量和松弛变量\n\n这种方法首先重新构造目标函数。问题 $\\min \\|x\\|_1$ 等价于引入一个新的变量向量 $t \\in \\mathbb{R}^n$ 并求解：\n$$\n\\min_{x, t} \\sum_{i=1}^{n} t_i \\quad \\text{subject to} \\quad Ax = b, \\quad t_i \\ge |x_i| \\text{ for } i=1, \\dots, n.\n$$\n不等式 $t_i \\ge |x_i|$ 等价于一对线性不等式 $-t_i \\le x_i \\le t_i$。这给出了一个中间问题：\n$$\n\\min_{x, t} \\sum_{i=1}^{n} t_i \\quad \\text{subject to} \\quad Ax = b, \\quad x - t \\le 0, \\quad -x - t \\le 0.\n$$\n为了将其转换为标准LP形式，我们执行以下步骤：\n1.  变量 $x_i$ 是自由的。我们像之前一样将其分裂：$x = u - v$，其中 $u, v \\ge 0$。\n2.  变量 $t_i$ 受到 $t_i \\ge |x_i| \\ge 0$ 的约束，因此它们本身就是非负的。我们可以直接施加约束 $t \\ge 0$。\n3.  通过引入非负松弛变量 $s \\in \\mathbb{R}^n$ 和 $q \\in \\mathbb{R}^n$，将两组 $n$ 个不等式转换为等式：\n    - $x - t \\le 0 \\implies x - t + s = 0$，其中 $s \\ge 0$。\n    - $-x - t \\le 0 \\implies -x - t + q = 0$，其中 $q \\ge 0$。\n\n代入 $x=u-v$，我们得到完整的标准形式LP。优化变量是 $z_2 = \\begin{pmatrix} u^T  v^T  t^T  s^T  q^T \\end{pmatrix}^T \\in \\mathbb{R}^{5n}$。$z_2$ 的所有分量都是非负的。约束条件是：\n\\begin{align*}\nA(u - v) = b \\\\\n(u - v) - t + s = 0 \\\\\n-(u - v) - t + q = 0\n\\end{align*}\n目标函数是最小化 $\\sum t_i$，它是 $z_2$ 的一个线性函数。以矩阵形式表示，等式系统为 $A_2 z_2 = b_2$：\n$$\n\\begin{pmatrix}\nA  -A  0_{m \\times n}  0_{m \\times n}  0_{m \\times n} \\\\\nI_n  -I_n  -I_n  I_n  0_{n \\times n} \\\\\n-I_n  I_n  -I_n  0_{n \\times n}  I_n\n\\end{pmatrix}\n\\begin{pmatrix} u \\\\ v \\\\ t \\\\ s \\\\ q \\end{pmatrix}\n=\n\\begin{pmatrix} b \\\\ 0_n \\\\ 0_n \\end{pmatrix}\n$$\n其中 $I_n$ 是 $n \\times n$ 的单位矩阵，$0_{k \\times l}$ 表示大小为 $k \\times l$ 的零矩阵。\n\n第二种形式的等式约束系数矩阵是：\n$$\nA_2 = \\begin{pmatrix}\nA  -A  0_{m \\times n}  0_{m \\times n}  0_{m \\times n} \\\\\nI_n  -I_n  -I_n  I_n  0_{n \\times n} \\\\\n-I_n  I_n  -I_n  0_{n \\times n}  I_n\n\\end{pmatrix}\n$$\n这是一个大小为 $(m+2n) \\times 5n$ 的矩阵。我们通过对它的三个分块行中的非零元素进行求和来计算其非零元素的数量 $N_2 = \\operatorname{nnz}(A_2)$：\n-   **第一分块行：** $\\operatorname{nnz}(\\begin{pmatrix} A  -A  0  0  0 \\end{pmatrix}) = \\operatorname{nnz}(A) + \\operatorname{nnz}(-A) = s + s = 2s$。\n-   **第二分块行：** $\\operatorname{nnz}(\\begin{pmatrix} I_n  -I_n  -I_n  I_n  0 \\end{pmatrix}) = \\operatorname{nnz}(I_n) + \\operatorname{nnz}(-I_n) + \\operatorname{nnz}(-I_n) + \\operatorname{nnz}(I_n) = n + n + n + n = 4n$。\n-   **第三分块行：** $\\operatorname{nnz}(\\begin{pmatrix} -I_n  I_n  -I_n  0  I_n \\end{pmatrix}) = \\operatorname{nnz}(-I_n) + \\operatorname{nnz}(I_n) + \\operatorname{nnz}(-I_n) + \\operatorname{nnz}(I_n) = n + n + n + n = 4n$。\n\n将这些计数相加，得到 $A_2$ 中非零元素的总数：\n$$\nN_2 = 2s + 4n + 4n = 2s + 8n.\n$$\n\n### 比率计算\n\n问题将 $R(s,n)$ 定义为第二种形式矩阵中非零元素的数量与第一种形式的比值。\n$$\nR(s,n) = \\frac{N_2}{N_1}\n$$\n代入 $N_1$ 和 $N_2$ 的表达式：\n$$\nR(s,n) = \\frac{2s + 8n}{2s}\n$$\n简化此表达式得到最终的闭式结果：\n$$\nR(s,n) = \\frac{2s}{2s} + \\frac{8n}{2s} = 1 + \\frac{4n}{s}.\n$$",
            "answer": "$$\n\\boxed{1 + \\frac{4n}{s}}\n$$"
        },
        {
            "introduction": "实际问题常常会遇到简并性（degeneracy），这可能导致我们第一个练习中观察到的解不唯一的情况。这个高级练习  深入探讨了一个简并的基追踪实例，要求我们运用强大的线性规划对偶理论来验证解的最优性。此外，它还引入了一个合理的择优规则（tie-breaking rule），从无穷多个最优解中挑选出具有特定性质（如最小无穷范数）的唯一解，这展示了处理解不唯一性并获得确定性结果的完整分析流程。",
            "id": "3458070",
            "problem": "考虑基追踪（Basis Pursuit, BP），它通过求解凸优化问题来恢复稀疏向量\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad A x = b,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 且 $b \\in \\mathbb{R}^{m}$。通过引入辅助变量以线性化绝对值，基追踪可以被表述为一个线性规划（Linear Programming, LP）问题。\n\n要求你针对具有特定数据的BP问题，分析其退化性和打破僵局（tie-breaking）的方法\n$$\nA = \\begin{pmatrix} 1  1  0  0 \\\\ 0  0  1  1 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 4}$ 且 $b \\in \\mathbb{R}^{2}$。\n\n任务：\n1. 从 $\\ell_{1}$ 范数和绝对值的定义出发，通过引入辅助变量 $t \\in \\mathbb{R}^{4}$，推导BP问题的线性规划（LP）形式，并仅使用线性等式和不等式约束来写出该问题。不要调用任何预先推导的LP模板；从第一性原理出发进行推导。\n2. 仅使用广为接受的事实（例如，三角不等式 $|x_{1}| + |x_{2}| \\geq |x_{1} + x_{2}|$），刻画给定 $A$ 和 $b$ 的BP问题最小化子的完整集合。在你的刻画中，指明在最优解处哪些原始不等式是活跃的，并精确解释为什么这在LP中构成了退化（在最优点同时有多个约束是活跃的）。\n3. 使用标准的拉格朗日对偶性，从任务1中的LP推导出其对偶问题，并给出一个对偶证书，以证明你在任务2中对原始问题最小化子集的刻画是最优的。解释互补松弛性如何揭示在解处哪些原始约束是紧的。\n4. 对BP最小化子集施加以下打破僵局规则：在所有 $\\|x\\|_{1}$ 的最小化子中，选择使无穷范数 $\\|x\\|_{\\infty}$ 最小的那个；如果多个向量具有相同的无穷范数，则选择字典序最小的向量（在 $\\mathbb{R}^{4}$ 上的标准字典序中）。计算这个唯一选定的解 $x^{\\star}$。\n\n使用 pmatrix 环境，将你的最终答案表示为单行向量 $x^{\\star}$。无需四舍五入，不涉及单位。",
            "solution": "问题陈述已经过验证，被认为是可靠、适定、客观且在凸优化和线性规划领域内有科学依据的。所有需要的数据和定义均已提供，各项任务逻辑上是连续且可解的。\n\n### 任务1：线性规划表述\n\n基追踪（BP）问题由下式给出\n$$ \\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad A x = b $$\n其中 $\\|x\\|_{1} = \\sum_{i=1}^{n} |x_i|$。由于绝对值函数，目标函数是非线性的。为了将其表述为线性规划（LP）问题，我们对目标函数进行线性化。对于向量 $x \\in \\mathbb{R}^{4}$ 的每个分量 $x_i$，我们引入一个辅助变量 $t_i \\in \\mathbb{R}$。核心思想是在目标函数中用 $t_i$ 替换 $|x_i|$，并附加约束 $t_i \\ge |x_i|$。最小化 $\\sum t_i$ 将确保在最优解处，我们有 $t_i = |x_i|$。\n\n不等式 $t_i \\ge |x_i|$ 等价于以下一对线性不等式：\n$$ x_i \\le t_i \\quad \\text{and} \\quad -x_i \\le t_i $$\n这些可以重写为：\n$$ x_i - t_i \\le 0 $$\n$$ -x_i - t_i \\le 0 $$\n引入向量 $t = (t_1, t_2, t_3, t_4)^T \\in \\mathbb{R}^{4}$，BP问题等价于以下LP：\n$$ \\min_{x \\in \\mathbb{R}^{4}, t \\in \\mathbb{R}^{4}} \\sum_{i=1}^{4} t_i $$\n约束条件如下：\n1. $A x = b$\n2. $x_i - t_i \\le 0$ 对于 $i=1, 2, 3, 4$\n3. $-x_i - t_i \\le 0$ 对于 $i=1, 2, 3, 4$\n\n这是一个关于8个变量 $(x_1, x_2, x_3, x_4, t_1, t_2, t_3, t_4)$ 的线性规划。目标函数是 $1^T t$（其中 $1$ 是全一向量），且约束都是线性等式或不等式。\n\n### 任务2：最小化子的刻画与退化性\n\n我们给定的具体数据为：\n$$ A = \\begin{pmatrix} 1  1  0  0 \\\\ 0  0  1  1 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n约束 $Ax = b$ 展开为两个线性方程：\n1. $x_1 + x_2 = 1$\n2. $x_3 + x_4 = 0$\n\n从第二个方程，我们得到 $x_4 = -x_3$。目标是最小化 $\\|x\\|_1 = |x_1| + |x_2| + |x_3| + |x_4|$。代入约束条件：\n$$ \\|x\\|_1 = |x_1| + |1-x_1| + |x_3| + |-x_3| = |x_1| + |1-x_1| + 2|x_3| $$\n为了最小化这个和，我们可以独立地最小化它的各个部分。\n- 对于项 $2|x_3|$，其最小值为 $0$，在 $x_3 = 0$ 时取得。这意味着 $x_4 = -x_3 = 0$。\n- 对于项 $|x_1| + |1-x_1|$，我们使用三角不等式：$|a| + |b| \\ge |a+b|$。这里，令 $a=x_1$ 且 $b=1-x_1$。那么 $|x_1| + |1-x_1| \\ge |x_1 + (1-x_1)| = |1| = 1$。等号成立当且仅当 $x_1$ 和 $1-x_1$ 同号或其中一个为零。此条件为 $x_1 \\ge 0$ 且 $1-x_1 \\ge 0$，可简化为 $0 \\le x_1 \\le 1$。\n\n综合这些发现，$\\|x\\|_1$ 的最小值为 $1+0=1$。这个最小值对于任何形如下式的向量 $x$ 都可达到：\n$$ x = (\\alpha, 1-\\alpha, 0, 0)^T \\quad \\text{for any } \\alpha \\in [0, 1] $$\n所有BP最小化子的集合是 $S = \\{ (\\alpha, 1-\\alpha, 0, 0)^T \\mid \\alpha \\in [0, 1] \\}$。\n\n在LP表述的背景下，这种情况构成了退化。如果一个基本可行解（可行多面体的一个顶点）具有超过标准数量的活跃约束，则该LP是退化的。我们的LP有8个变量 $(x, t)$。一个非退化的顶点将由恰好8个活跃的、线性无关的约束确定。\n最优解集 $S$ 是一个线段，其端点为 $x^{(0)} = (0, 1, 0, 0)^T$（对应 $\\alpha=0$）和 $x^{(1)} = (1, 0, 0, 0)^T$（对应 $\\alpha=1$）。我们来分析对应于 $x^{(1)}$ 的顶点：\n原始LP变量为 $(x_1, x_2, x_3, x_4, t_1, t_2, t_3, t_4) = (1, 0, 0, 0, 1, 0, 0, 0)$。\n在该点的活跃约束为：\n1. $x_1 + x_2 = 1$ (等式约束，始终活跃)\n2. $x_3 + x_4 = 0$ (等式约束，始终活跃)\n3. $x_1 - t_1 = 1 - 1 = 0$ (活跃)\n4. $x_2 - t_2 = 0 - 0 = 0$ (活跃)\n5. $-x_2 - t_2 = 0 - 0 = 0$ (活跃)\n6. $x_3 - t_3 = 0 - 0 = 0$ (活跃)\n7. $-x_3 - t_3 = 0 - 0 = 0$ (活跃)\n8. $x_4 - t_4 = 0 - 0 = 0$ (活跃)\n9. $-x_4 - t_4 = 0 - 0 = 0$ (活跃)\n对于一个8变量问题，存在9个活跃约束。对 $x^{(0)}$ 进行类似分析也显示有9个活跃约束。这种对顶点的过度确定是原始退化的定义。非唯一最优解集（线段 $S$）的存在是这种退化的直接后果。\n\n### 任务3：对偶问题与证书\n\n我们使用拉格朗日对偶性从任务1中的LP推导出对偶问题。\n原始LP：\n$$ \\min_{x,t} \\sum_{i=1}^{4} t_i \\quad \\text{s.t.} \\quad Ax=b, \\quad x-t \\le 0, \\quad -x-t \\le 0. $$\n拉格朗日函数为：\n$$ L(x, t, \\nu, \\mu_1, \\mu_2) = \\sum_{i=1}^{4} t_i + \\nu^T(Ax - b) + \\mu_1^T(x-t) + \\mu_2^T(-x-t) $$\n其中 $\\nu \\in \\mathbb{R}^2$ 是对应于 $Ax=b$ 的对偶变量，$\\mu_1, \\mu_2 \\in \\mathbb{R}^4$ 是对应于不等式约束的非负对偶变量。\n按 $x$ 和 $t$ 分组各项：\n$$ L = (A^T\\nu + \\mu_1 - \\mu_2)^T x + (1 - \\mu_1 - \\mu_2)^T t - b^T\\nu $$\n对偶函数 $g(\\nu, \\mu_1, \\mu_2) = \\inf_{x,t} L$ 仅在 $x$ 和 $t$ 的系数为零时才是有限的：\n1. $A^T\\nu + \\mu_1 - \\mu_2 = 0 \\implies A^T\\nu = \\mu_2 - \\mu_1$\n2. $1 - \\mu_1 - \\mu_2 = 0 \\implies \\mu_1 + \\mu_2 = 1$ (分量形式)\n\n当这些条件成立时，$L$ 简化为 $-b^T\\nu$。对偶问题是最大化这个值：\n$$ \\max_{\\nu, \\mu_1, \\mu_2} -b^T\\nu \\quad \\text{s.t.} \\quad A^T\\nu = \\mu_2 - \\mu_1, \\quad \\mu_1 + \\mu_2 = 1, \\quad \\mu_1 \\ge 0, \\quad \\mu_2 \\ge 0 $$\n我们可以消去 $\\mu_1, \\mu_2$。令 $z = A^T\\nu$。对每个分量 $i$，$z_i=\\mu_{2i}-\\mu_{1i}$ 且 $1=\\mu_{1i}+\\mu_{2i}$。解出 $\\mu_{1i}, \\mu_{2i}$ 得到 $\\mu_{1i}=(1-z_i)/2$ 和 $\\mu_{2i}=(1+z_i)/2$。非负性约束 $\\mu_{1i} \\ge 0, \\mu_{2i} \\ge 0$ 意味着 $|z_i| \\le 1$。因此，对偶问题简化为：\n$$ \\max_{\\nu \\in \\mathbb{R}^2} -b^T\\nu \\quad \\text{s.t.} \\quad \\|A^T\\nu\\|_{\\infty} \\le 1 $$\n原始最优值为 $p^* = 1$。根据强对偶性，对偶最优值必须是 $d^*=1$。对于 $b=(1, 0)^T$，对偶目标函数是 $-b^T\\nu = -\\nu_1$。所以我们必须有 $-\\nu_1 = 1$，这意味着 $\\nu_1 = -1$。\n对偶可行性约束是 $\\|A^T\\nu\\|_{\\infty} \\le 1$：\n$$ A^T\\nu = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 0  1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ \\nu_2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ \\nu_2 \\\\ \\nu_2 \\end{pmatrix} $$\n无穷范数约束要求 $|-1| \\le 1$ 和 $|\\nu_2| \\le 1$。第一个条件成立，所以我们只需要 $\\nu_2 \\in [-1, 1]$。\n一个有效的对偶证书是任何形如 $\\nu = (-1, \\nu_2)^T$ 的向量，其中 $\\nu_2 \\in [-1, 1]$。例如，我们选择 $\\nu_c = (-1, 0)^T$。这个向量证明了集合 $S$ 中任何原始解的最优性。\n\n互补松弛性条件指出，对于一个最优的原始-对偶对，松弛变量与其对应的对偶变量的乘积必须为零。对于我们的LP，这意味着：\n$\\mu_{1i}(x_i-t_i) = 0$ 和 $\\mu_{2i}(-x_i-t_i) = 0$ 对于 $i=1,..,4$。\n使用对偶证书 $\\nu_c = (-1, 0)^T$，我们得到 $A^T\\nu_c = (-1, -1, 0, 0)^T$。相应的对偶变量是：\n$\\mu_1 = (1 - A^T\\nu_c)/2 = (1, 1, 1/2, 1/2)^T$\n$\\mu_2 = (1 + A^T\\nu_c)/2 = (0, 0, 1/2, 1/2)^T$\n互补松弛性（CS）条件是：\n- 对于 $i=1$：$\\mu_{11}=1 \\implies x_1-t_1=0 \\implies x_1=t_1$。因为 $t_1=|x_1|$，这意味着 $x_1 \\ge 0$。由于 $\\mu_{21}=0$，第二个CS条件被平凡满足。\n- 对于 $i=2$：$\\mu_{12}=1 \\implies x_2-t_2=0 \\implies x_2 \\ge 0$。$\\mu_{22}=0$。\n- 对于 $i=3$：$\\mu_{13}=1/2 \\implies x_3-t_3=0$。同时，$\\mu_{23}=1/2 \\implies -x_3-t_3=0$。这两个条件共同迫使 $x_3=0$ 且 $t_3=0$。\n- 对于 $i=4$：类似地，$\\mu_{14}=1/2$ 和 $\\mu_{24}=1/2$ 迫使 $x_4=0$ 且 $t_4=0$。\n这些从CS推导出的条件（$x_1 \\ge 0, x_2 \\ge 0, x_3=0, x_4=0$）与原始可行性约束 $x_1+x_2=1$ 相结合，完美地描述了最优集 $S = \\{(\\alpha, 1-\\alpha, 0, 0)^T \\mid \\alpha \\in [0, 1]\\}$。\n\n### 任务4：打破僵局规则\n\n我们必须通过应用打破僵局规则，从BP最优化子集 $S$ 中选择一个唯一的解 $x^{\\star}$。该集合是 $S = \\{ x(\\alpha) = (\\alpha, 1-\\alpha, 0, 0)^T \\mid \\alpha \\in [0, 1] \\}$。\n\n首先，我们在此集合上最小化无穷范数 $\\|x\\|_{\\infty}$。\n对于 $x(\\alpha) \\in S$，无穷范数为：\n$$ \\|x(\\alpha)\\|_{\\infty} = \\max(|\\alpha|, |1-\\alpha|, |0|, |0|) $$\n由于 $\\alpha \\in [0, 1]$，$\\alpha$ 和 $1-\\alpha$ 都是非负的，所以：\n$$ \\|x(\\alpha)\\|_{\\infty} = \\max(\\alpha, 1-\\alpha) $$\n我们想要求解 $\\arg\\min_{\\alpha \\in [0, 1]} \\max(\\alpha, 1-\\alpha)$。函数 $g(\\alpha) = \\max(\\alpha, 1-\\alpha)$ 在其两个参数相等时取最小值，即 $\\alpha = 1-\\alpha$。这得到 $2\\alpha=1$，所以 $\\alpha = 1/2$。\n当 $\\alpha=1/2$ 时，无穷范数是 $\\max(1/2, 1/2) = 1/2$。对于任何其他 $\\alpha \\in [0,1]$，$\\alpha$ 或 $1-\\alpha$ 中的一个将大于 $1/2$。例如，如果 $\\alpha=0.6$，则 $\\|x\\|_{\\infty}=0.6  0.5$。如果 $\\alpha=0.4$，则 $\\|x\\|_{\\infty}=0.6  0.5$。\n因此，集合 $S$ 上的最小无穷范数是 $1/2$，并且它在 $\\alpha=1/2$ 处唯一地达到。\n\n由于第一个打破僵局规则（最小化 $\\|x\\|_{\\infty}$）产生了一个唯一的解，我们不需要应用第二个规则（字典序排序）。\n唯一选定的解 $x^{\\star}$ 对应于 $\\alpha = 1/2$：\n$$ x^{\\star} = \\left(\\frac{1}{2}, \\frac{1}{2}, 0, 0\\right)^T = \\left(\\frac{1}{2}, \\frac{1}{2}, 0, 0\\right)^T $$",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2}  0  0 \\end{pmatrix}} $$"
        }
    ]
}