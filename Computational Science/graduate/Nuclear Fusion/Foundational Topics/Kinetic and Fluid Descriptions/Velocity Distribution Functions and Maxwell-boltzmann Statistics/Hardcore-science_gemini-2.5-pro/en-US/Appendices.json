{
    "hands_on_practices": [
        {
            "introduction": "The Maxwell-Boltzmann distribution is a cornerstone of classical statistical mechanics, but its application to a plasma, which is composed of quantum particles, requires justification. This exercise explores the boundary between classical and quantum regimes by tasking you with deriving the thermal de Broglie wavelength, $\\lambda_{\\mathrm{th}}$. By calculating the degeneracy parameter $n\\lambda_{\\mathrm{th}}^3$ for a realistic fusion plasma, you will verify why classical statistics provide an exceptionally accurate description in this high-temperature, moderate-density environment .",
            "id": "3725143",
            "problem": "In a fully ionized deuterium–tritium plasma typical of magnetic-confinement fusion, determine whether the ion populations can be described by Maxwell–Boltzmann (MB) statistics by deriving and evaluating the appropriate quantum-classical crossover parameter. Start from the classical translational partition function for a single nonrelativistic particle of mass $m$ at temperature $T$, constructed by integrating the Boltzmann factor over momentum space with quantum phase-space cells of volume $h^{3}$, where $h$ is Planck’s constant. Define the thermal de Broglie wavelength $\\lambda_{\\mathrm{th}}$ so that the one-particle partition function takes the form $Z_{1}=V/\\lambda_{\\mathrm{th}}^{3}$, and use this to obtain the classicality criterion in terms of the number density $n$.\n\nThen, for singly charged deuterium and tritium ions at temperature $T=10\\ \\mathrm{keV}$, compute $\\lambda_{\\mathrm{th}}$ for each ion species using the ion rest masses given below, and evaluate the degeneracy parameter $g \\equiv n\\,\\lambda_{\\mathrm{th}}^{3}$ at a representative core plasma density $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$. Based on your derivation, explain why $g \\ll 1$ implies the validity of MB statistics for the ions. Use the following constants:\n- Planck’s constant $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$,\n- Elementary charge $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$ (so that $1\\ \\mathrm{eV}=e\\ \\mathrm{J}$),\n- Deuteron mass $m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$,\n- Triton mass $m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$.\n\nTreat ions as nonrelativistic and neglect quantum statistics of electrons. Express intermediate wavelengths in meters. For the final reported result, provide the numerical value of the larger of the two ion degeneracy parameters $g=n\\,\\lambda_{\\mathrm{th}}^{3}$ (i.e., for the ion species with the larger $\\lambda_{\\mathrm{th}}$). Round this final reported value to four significant figures and express it as a pure number (dimensionless).",
            "solution": "The problem is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Plasma Composition**: Fully ionized deuterium–tritium plasma.\n- **Physical Context**: Magnetic-confinement fusion.\n- **Task**: Determine if ion populations can be described by Maxwell–Boltzmann (MB) statistics.\n- **Methodology**: Derive and evaluate a quantum-classical crossover parameter.\n- **Starting Point**: The classical translational partition function for a single nonrelativistic particle of mass $m$ at temperature $T$, constructed by integrating the Boltzmann factor over momentum space with quantum phase-space cells of volume $h^{3}$.\n- **Definition 1**: Thermal de Broglie wavelength $\\lambda_{\\mathrm{th}}$ is defined such that the one-particle partition function has the form $Z_{1}=V/\\lambda_{\\mathrm{th}}^{3}$.\n- **Objective 1**: Obtain the classicality criterion in terms of the number density $n$.\n- **Calculation Parameters**:\n  - Ion species: Singly charged deuterium and tritium.\n  - Temperature: $T=10\\ \\mathrm{keV}$.\n  - Number density: $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$.\n- **Definition 2**: Degeneracy parameter $g \\equiv n\\,\\lambda_{\\mathrm{th}}^{3}$.\n- **Objective 2**: Compute $\\lambda_{\\mathrm{th}}$ for each ion species.\n- **Objective 3**: Evaluate the degeneracy parameter $g$ at the given density $n$.\n- **Objective 4**: Explain why $g \\ll 1$ implies the validity of MB statistics.\n- **Constants**:\n  - Planck’s constant: $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$.\n  - Elementary charge: $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n  - Deuteron mass: $m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$.\n  - Triton mass: $m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$.\n- **Assumptions**: Ions are nonrelativistic; neglect quantum statistics of electrons.\n- **Final Result Specification**: Provide the numerical value of the larger of the two ion degeneracy parameters, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in standard statistical mechanics and plasma physics. The concepts of the partition function, thermal de Broglie wavelength, and the degeneracy parameter are fundamental tools for assessing quantum effects in a many-body system. The physical context (fusion plasma) and the provided parameters ($T$, $n$, ion masses) are realistic.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information, definitions, and constants to perform the required derivation and calculations. The objectives are clear, and the path to the solution is logically structured. A unique, meaningful solution exists.\n- **Objectivity**: The problem is stated in precise, objective, and scientific language, free of any subjective or ambiguous terms.\n- **Completeness and Consistency**: The problem is self-contained. The provided constants and parameters are sufficient. The anachronistic but common practice in plasma physics of specifying temperature in units of energy (electronvolts) is implicitly defined via the elementary charge $e$, where the thermal energy is $k_B T = 10\\ \\mathrm{keV}$. This is a standard convention and does not render the problem incomplete. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid** as it is scientifically sound, well-posed, and complete. We may proceed to the solution.\n\n### Derivation of the Classicality Criterion\nThe classical translational partition function, $Z_1$, for a single nonrelativistic particle of mass $m$ in a volume $V$ at temperature $T$ is given by the integral over all possible positions and momenta. To account for the quantization of phase space, this integral is divided by $h^3$, where $h$ is Planck's constant.\nThe energy of a nonrelativistic particle is purely kinetic, $E=p^{2}/(2m)$. The partition function is:\n$$ Z_1 = \\frac{1}{h^3} \\int \\exp\\left(-\\frac{E}{k_B T}\\right) d^3x d^3p = \\frac{1}{h^3} \\int d^3x \\int d^3p \\, \\exp\\left(-\\frac{p^2}{2mk_B T}\\right) $$\nThe integral over the spatial coordinates $d^3x$ yields the volume $V$.\n$$ Z_1 = \\frac{V}{h^3} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{p_x^2 + p_y^2 + p_z^2}{2mk_B T}\\right) dp_x dp_y dp_z $$\nThis is a product of three identical Gaussian integrals of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$. With $a = 1/(2mk_B T)$, each integral yields $\\sqrt{2\\pi mk_B T}$.\n$$ Z_1 = \\frac{V}{h^3} \\left(\\sqrt{2\\pi mk_B T}\\right)^3 = \\frac{V}{h^3} (2\\pi mk_B T)^{3/2} $$\nThe problem defines the thermal de Broglie wavelength, $\\lambda_{\\mathrm{th}}$, via the relation $Z_1 = V/\\lambda_{\\mathrm{th}}^3$. Equating the two expressions for $Z_1$:\n$$ \\frac{V}{\\lambda_{\\mathrm{th}}^3} = \\frac{V (2\\pi mk_B T)^{3/2}}{h^3} $$\nSolving for $\\lambda_{\\mathrm{th}}$ gives:\n$$ \\lambda_{\\mathrm{th}} = \\frac{h}{\\sqrt{2\\pi mk_B T}} $$\nThis wavelength, $\\lambda_{\\mathrm{th}}$, represents the characteristic de Broglie wavelength of a particle in a thermal ensemble at temperature $T$.\n\nMaxwell-Boltzmann statistics are applicable when the quantum nature of particles can be ignored. This occurs when the particles are, on average, far enough apart that their quantum wave packets do not significantly overlap. The average volume per particle in a system with number density $n$ is $1/n$. The characteristic interparticle separation distance is thus $d \\sim n^{-1/3}$. Quantum effects become non-negligible when $\\lambda_{\\mathrm{th}}$ becomes comparable to or larger than $d$. Therefore, the classical (non-quantum) regime, where MB statistics are valid, corresponds to the condition:\n$$ \\lambda_{\\mathrm{th}} \\ll n^{-1/3} $$\nCubing both sides gives $\\lambda_{\\mathrm{th}}^3 \\ll 1/n$, which can be rearranged to define the classicality criterion:\n$$ n \\lambda_{\\mathrm{th}}^3 \\ll 1 $$\nThe quantity $g \\equiv n \\lambda_{\\mathrm{th}}^3$ is the degeneracy parameter. The condition $g \\ll 1$ signifies that the system is non-degenerate or \"classical,\" and thus its constituent particles can be described by Maxwell-Boltzmann statistics.\n\n### Numerical Evaluation for Deuterium-Tritium Plasma\nFirst, we convert the given temperature into thermal energy in SI units.\n$$ k_B T = 10\\ \\mathrm{keV} = 10 \\times 10^3 \\ \\mathrm{eV} = 10^4 \\times (1.602176634\\times 10^{-19}\\ \\mathrm{J}) = 1.602176634\\times 10^{-15}\\ \\mathrm{J} $$\nNow we compute the thermal de Broglie wavelength for both deuteron and triton ions using the formula $\\lambda_{\\mathrm{th}} = h/\\sqrt{2\\pi m k_B T}$.\n\nFor a deuteron ($D^{+}$):\n$m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$.\n$$ \\lambda_{\\mathrm{th, D}} = \\frac{6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}}{\\sqrt{2\\pi (3.343583719\\times 10^{-27}\\ \\mathrm{kg})(1.602176634\\times 10^{-15}\\ \\mathrm{J})}} $$\n$$ \\lambda_{\\mathrm{th, D}} = \\frac{6.62607015\\times 10^{-34}}{\\sqrt{3.3644919 \\times 10^{-41}}} \\ \\mathrm{m} = \\frac{6.62607015\\times 10^{-34}}{5.8004240\\times 10^{-21}}\\ \\mathrm{m} $$\n$$ \\lambda_{\\mathrm{th, D}} \\approx 1.1423447\\times 10^{-13}\\ \\mathrm{m} $$\n\nFor a triton ($T^{+}$):\n$m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$.\n$$ \\lambda_{\\mathrm{th, T}} = \\frac{6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}}{\\sqrt{2\\pi (5.0073567446\\times 10^{-27}\\ \\mathrm{kg})(1.602176634\\times 10^{-15}\\ \\mathrm{J})}} $$\n$$ \\lambda_{\\mathrm{th, T}} = \\frac{6.62607015\\times 10^{-34}}{\\sqrt{5.0388610 \\times 10^{-41}}} \\ \\mathrm{m} = \\frac{6.62607015\\times 10^{-34}}{7.1009584\\times 10^{-21}}\\ \\mathrm{m} $$\n$$ \\lambda_{\\mathrm{th, T}} \\approx 9.331323\\times 10^{-14}\\ \\mathrm{m} $$\n\nThe problem asks for the larger of the two ion degeneracy parameters. Since $g = n \\lambda_{\\mathrm{th}}^3$ and $\\lambda_{\\mathrm{th}} \\propto m^{-1/2}$, the lighter particle (the deuteron) will have the larger $\\lambda_{\\mathrm{th}}$ and consequently the larger degeneracy parameter $g$.\n\nWe calculate $g_{\\mathrm{D}}$ for the deuteron using $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$.\n$$ g_{\\mathrm{D}} = n \\lambda_{\\mathrm{th, D}}^3 = (1.0\\times 10^{20}\\ \\mathrm{m}^{-3}) \\times (1.1423447\\times 10^{-13}\\ \\mathrm{m})^3 $$\n$$ g_{\\mathrm{D}} = (1.0\\times 10^{20}) \\times (1.490793 \\times 10^{-39})\\ \\mathrm{m^3 \\cdot m^{-3}} $$\n$$ g_{\\mathrm{D}} \\approx 1.490793 \\times 10^{-19} $$\nThe value of $g_{\\mathrm{D}}$ is extremely small, $g_{\\mathrm{D}} \\ll 1$. This confirms that the classicality condition is overwhelmingly satisfied. Therefore, the deuterium and tritium ion populations in the fusion plasma can be accurately described by Maxwell-Boltzmann statistics.\n\nRounding the result to four significant figures gives $1.491 \\times 10^{-19}$.",
            "answer": "$$\n\\boxed{1.491 \\times 10^{-19}}\n$$"
        },
        {
            "introduction": "Once the use of the Maxwellian distribution is justified, proficiency in its mathematical manipulation is essential for theoretical analysis. This practice guides you through the fundamental derivation of the Maxwellian speed distribution $f_v(v)$ from the three-dimensional velocity distribution and then challenges you to develop a general, powerful formula for any arbitrary speed moment $\\langle v^k \\rangle$. This result is indispensable for calculating reaction rates, transport coefficients, and other macroscopic plasma properties from first principles .",
            "id": "3725128",
            "problem": "Consider a non-relativistic, isotropic, single-species ion population in a magnetically confined nuclear fusion plasma, idealized as a classical ideal gas in thermal equilibrium at temperature $T$. Let the ion mass be $m$. The equilibrium velocity distribution arises from the canonical ensemble and depends on the kinetic energy $K = \\frac{1}{2} m v^{2}$, where $v = |\\mathbf{v}|$ is the speed and $\\mathbf{v}$ is the velocity vector. \n\nStarting from first principles:\n- Use the canonical ensemble for a classical ideal gas to construct the probability density function (PDF) over three-dimensional velocity space, $f_{\\mathbf{v}}(\\mathbf{v})$, and determine its normalization constant by enforcing $\\int_{\\mathbb{R}^{3}} f_{\\mathbf{v}}(\\mathbf{v})\\,d^{3}v = 1$.\n- From $f_{\\mathbf{v}}(\\mathbf{v})$, derive the speed distribution $f_{v}(v)$ for $v \\ge 0$ by invoking isotropy and the measure in spherical velocity coordinates.\n- Evaluate the Gaussian-type integral\n$$\n\\int_{0}^{\\infty} v^{n} \\exp\\!\\left(-a v^{2}\\right)\\,dv\n$$\nfor integer $n \\ge 0$ and parameter $a > 0$ using only transformations and definitions that reduce it to standard special functions. Provide a closed form and identify any recursion that follows for successive integers $n$.\n- Apply your result to compute the general $k$-th speed moment\n$$\n\\langle v^{k} \\rangle \\equiv \\int_{0}^{\\infty} v^{k}\\, f_{v}(v)\\,dv\n$$\nfor integer $k \\ge 0$ in terms of $k$, the Boltzmann constant $k_{B}$, the temperature $T$, and the mass $m$.\n\nExpress the final result for $\\langle v^{k} \\rangle$ as a single closed-form analytic expression. Do not provide a numerical value. Do not include units in your final expression.",
            "solution": "The problem is scientifically well-posed and self-contained. We shall proceed with a rigorous derivation following the specified steps.\n\nFirst, we construct the velocity probability density function (PDF), $f_{\\mathbf{v}}(\\mathbf{v})$, for a single-species ion population in thermal equilibrium. The system is modeled as a classical ideal gas, for which the canonical ensemble is appropriate. In the canonical ensemble, the probability of a microstate with energy $E$ is proportional to the Boltzmann factor, $\\exp(-E / (k_B T))$, where $k_B$ is the Boltzmann constant and $T$ is the temperature. For a non-relativistic particle of mass $m$ in an ideal gas, the energy is purely kinetic, $E = K = \\frac{1}{2}m|\\mathbf{v}|^{2}$, where $\\mathbf{v} = (v_x, v_y, v_z)$ is the velocity vector.\n\nThe velocity PDF, $f_{\\mathbf{v}}(\\mathbf{v})$, is therefore proportional to this Boltzmann factor:\n$$\nf_{\\mathbf{v}}(\\mathbf{v}) = C \\exp\\left(-\\frac{\\frac{1}{2}m|\\mathbf{v}|^{2}}{k_B T}\\right) = C \\exp\\left(-\\frac{m(v_x^{2} + v_y^{2} + v_z^{2})}{2k_B T}\\right)\n$$\nwhere $C$ is a normalization constant. This constant is determined by the condition that the total probability over all possible velocities is unity:\n$$\n\\int_{\\mathbb{R}^{3}} f_{\\mathbf{v}}(\\mathbf{v})\\,d^{3}v = 1\n$$\nSubstituting the expression for $f_{\\mathbf{v}}(\\mathbf{v})$ and noting that the integral separates over the three Cartesian components of velocity:\n$$\nC \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_x^{2}}{2k_B T}\\right)dv_x \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_y^{2}}{2k_B T}\\right)dv_y \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_z^{2}}{2k_B T}\\right)dv_z = 1\n$$\nEach of these integrals is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$. In our case, the parameter $a$ is $a = \\frac{m}{2k_B T}$.\nTherefore, each integral evaluates to $\\sqrt{\\frac{\\pi}{m/(2k_B T)}} = \\sqrt{\\frac{2\\pi k_B T}{m}}$. The normalization condition becomes:\n$$\nC \\left(\\sqrt{\\frac{2\\pi k_B T}{m}}\\right)^{3} = C \\left(\\frac{2\\pi k_B T}{m}\\right)^{3/2} = 1\n$$\nSolving for $C$, we find the normalization constant:\n$$\nC = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2}\n$$\nThe fully normalized three-dimensional velocity distribution is thus:\n$$\nf_{\\mathbf{v}}(\\mathbf{v}) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{v}|^{2}}{2k_B T}\\right)\n$$\nThis is the Maxwell-Boltzmann velocity distribution.\n\nNext, we derive the speed distribution, $f_{v}(v)$, for $v \\ge 0$. The assumption of isotropy implies that $f_{\\mathbf{v}}(\\mathbf{v})$ depends only on the magnitude of the velocity, $v = |\\mathbf{v}|$, which our derived form confirms. To find the probability of a particle having a speed in the interval $[v, v+dv]$, we integrate the velocity PDF over the volume of a spherical shell in velocity space with radius $v$ and thickness $dv$. The volume element in spherical velocity coordinates is $d^{3}v = v^{2}\\sin\\theta\\,dv\\,d\\theta\\,d\\phi$.\nThe probability $f_v(v)dv$ is given by:\n$$\nf_v(v)dv = \\left( \\int_{0}^{2\\pi} \\int_{0}^{\\pi} f_{\\mathbf{v}}(v,\\theta,\\phi) v^{2}\\sin\\theta\\,d\\theta\\,d\\phi \\right) dv\n$$\nSince $f_{\\mathbf{v}}$ depends only on $v$, we can factor it out of the angular integral:\n$$\nf_v(v)dv = f_{\\mathbf{v}}(v) v^{2} \\left( \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta\\,d\\theta \\right) dv\n$$\nThe angular integral evaluates to $2\\pi [-\\cos\\theta]_{0}^{\\pi} = 2\\pi(1 - (-1)) = 4\\pi$. Thus, the volume of the spherical shell is $4\\pi v^{2}dv$. The speed distribution is:\n$$\nf_v(v) = 4\\pi v^{2} f_{\\mathbf{v}}(v) = 4\\pi v^{2} \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{mv^{2}}{2k_B T}\\right)\n$$\nThis is the Maxwell-Boltzmann speed distribution.\n\nWe now address the evaluation of the general integral $I_{n} = \\int_{0}^{\\infty} v^{n} \\exp(-av^{2})\\,dv$ for integer $n \\ge 0$ and $a > 0$. We use the substitution $x = av^{2}$. This implies $v = \\sqrt{x/a} = a^{-1/2}x^{1/2}$, and the differential becomes $dv = \\frac{1}{2}a^{-1/2}x^{-1/2}dx$. The integration limits remain from $0$ to $\\infty$.\nSubstituting these into the integral:\n$$\nI_{n} = \\int_{0}^{\\infty} (a^{-1/2}x^{1/2})^{n} \\exp(-x) \\left(\\frac{1}{2}a^{-1/2}x^{-1/2}\\right) dx\n$$\n$$\nI_{n} = \\frac{1}{2}a^{-n/2}a^{-1/2} \\int_{0}^{\\infty} x^{n/2}x^{-1/2} \\exp(-x) dx = \\frac{1}{2}a^{-(n+1)/2} \\int_{0}^{\\infty} x^{(n-1)/2} \\exp(-x) dx\n$$\nThe integral on the right is the definition of the Euler Gamma function, $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1}\\exp(-t)dt$. Here, the argument is $z = \\frac{n-1}{2} + 1 = \\frac{n+1}{2}$.\nThus, the closed form for the integral is:\n$$\nI_n = \\int_{0}^{\\infty} v^{n} \\exp(-av^{2})\\,dv = \\frac{1}{2} a^{-(n+1)/2} \\Gamma\\left(\\frac{n+1}{2}\\right)\n$$\nA recursion relation can be found using integration by parts, for $n \\ge 2$:\n$$\nI_{n} = \\int_{0}^{\\infty} v^{n-1} (v \\exp(-av^{2}))\\,dv = \\left[v^{n-1}\\left(-\\frac{1}{2a}\\exp(-av^{2})\\right)\\right]_{0}^{\\infty} + \\frac{n-1}{2a} \\int_{0}^{\\infty} v^{n-2} \\exp(-av^{2}) \\,dv\n$$\nThe boundary term vanishes, leading to the recursion $I_{n} = \\frac{n-1}{2a}I_{n-2}$.\n\nFinally, we apply this result to compute the general $k$-th speed moment, $\\langle v^{k} \\rangle$, defined as:\n$$\n\\langle v^{k} \\rangle = \\int_{0}^{\\infty} v^{k} f_{v}(v) dv\n$$\nSubstituting the expression for $f_v(v)$:\n$$\n\\langle v^{k} \\rangle = \\int_{0}^{\\infty} v^{k} \\left[4\\pi v^{2} \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{mv^{2}}{2k_B T}\\right)\\right] dv\n$$\nCombining terms and extracting constants from the integral:\n$$\n\\langle v^{k} \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\int_{0}^{\\infty} v^{k+2} \\exp\\left(-\\frac{mv^{2}}{2k_B T}\\right) dv\n$$\nThis integral is of the form $I_{n}$ with $n = k+2$ and $a = \\frac{m}{2k_B T}$. Using our derived formula for $I_n$:\n$$\n\\int_{0}^{\\infty} v^{k+2} \\exp\\left(-\\frac{mv^{2}}{2k_B T}\\right)dv = \\frac{1}{2} \\left(\\frac{m}{2k_B T}\\right)^{-(k+2+1)/2} \\Gamma\\left(\\frac{k+2+1}{2}\\right)\n$$\n$$\n= \\frac{1}{2} \\left(\\frac{m}{2k_B T}\\right)^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\nNow, substitute this back into the expression for $\\langle v^{k} \\rangle$:\n$$\n\\langle v^{k} \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left[\\frac{1}{2} \\left(\\frac{m}{2k_B T}\\right)^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\\right]\n$$\nLet's simplify the expression. Let $\\beta = \\frac{m}{2k_B T}$ for clarity.\n$$\n\\langle v^{k} \\rangle = 4\\pi \\left(\\frac{\\beta}{\\pi}\\right)^{3/2} \\frac{1}{2} \\beta^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right) = 2\\pi \\frac{\\beta^{3/2}}{\\pi^{3/2}} \\beta^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\n$$\n\\langle v^{k} \\rangle = \\frac{2}{\\sqrt{\\pi}} \\beta^{3/2 - (k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right) = \\frac{2}{\\sqrt{\\pi}} \\beta^{-k/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\nSubstituting back $\\beta = \\frac{m}{2k_B T}$:\n$$\n\\langle v^{k} \\rangle = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{m}{2k_B T}\\right)^{-k/2} \\Gamma\\left(\\frac{k+3}{2}\\right) = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2k_B T}{m}\\right)^{k/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\nThis is the final closed-form expression for the $k$-th moment of the speed for a Maxwell-Boltzmann distribution.",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2 k_B T}{m}\\right)^{k/2} \\Gamma\\left(\\frac{k+3}{2}\\right)}\n$$"
        },
        {
            "introduction": "Bridging the gap between analytical theory and modern research, this exercise focuses on the computational application of the Maxwell-Boltzmann distribution. You are tasked with designing and implementing a Monte Carlo algorithm to generate particle velocities, a core component of powerful simulation techniques like Particle-In-Cell (PIC) codes. This hands-on problem culminates in the statistical verification of your sampled data against the exact analytical moments, reinforcing the connection between theoretical predictions and computational practice .",
            "id": "3725144",
            "problem": "Design and implement a complete Monte Carlo (MC) algorithm to sample three-dimensional particle velocities from a thermal equilibrium (Maxwell-Boltzmann) distribution for use in Particle-In-Cell (PIC) simulations, and verify that the sampled statistical moments agree with the analytically derived values from the canonical ensemble. The setting is nuclear fusion plasmas and must be expressed in the Standard International (SI) unit system.\n\nBegin from the following foundations and core definitions only, without presupposing or citing any final target formulas:\n- The canonical ensemble with Hamiltonian $H = \\sum_{i=1}^{3} \\dfrac{p_i^2}{2 m}$ for a single particle of mass $m$, where $p_i$ are the momentum components.\n- The Boltzmann factor for the canonical ensemble, $\\exp\\!\\left(- H / (k_B T)\\right)$, where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n- The definition of velocity as $v_i = p_i / m$, and Galilean shift by a uniform drift velocity $\\boldsymbol{u}$ to model a drifting equilibrium.\n- The definition of number density $n$ and kinetic energy density $\\mathcal{E} = \\dfrac{1}{2} m n \\,\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$.\n- The Gaussian limit theorem as justification for generating normal random variates.\n- The statistical definitions of sample mean, unbiased sample variance, and the standard error of the mean.\n\nYour tasks are:\n1. From the canonical-ensemble base, derive the sampling distribution for the three Cartesian velocity components of a particle in thermal equilibrium at temperature $T$ with uniform drift $\\boldsymbol{u}$, and specify an algorithm to generate MC samples of $\\boldsymbol{v} \\in \\mathbb{R}^3$. Your algorithm must be implementable using independent standard normal variates and affine transformations only. Express all symbolic results using $m$, $T$, $k_B$, and $\\boldsymbol{u}$.\n2. Derive analytic expressions, in closed form, for the following equilibrium moments in terms of $m$, $T$, $k_B$, and $\\boldsymbol{u}$:\n   - The mean velocity vector $\\mathbb{E}[\\boldsymbol{v}]$.\n   - The per-component variance $\\mathrm{Var}(v_i)$.\n   - The mean squared speed $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$.\n   - The variance of the squared speed, $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$, needed to quantify the sampling uncertainty of the Monte Carlo estimator of $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$.\n   - The kinetic energy density $\\mathcal{E}$.\n3. Implement a program that:\n   - Generates $N$ independent and identically distributed samples $\\{\\boldsymbol{v}^{(j)}\\}_{j=1}^N$ from the derived distribution for each test case below, using a pseudorandom number generator with a fixed seed to ensure reproducibility.\n   - Computes the empirical mean vector $\\widehat{\\boldsymbol{v}} = \\dfrac{1}{N} \\sum_{j=1}^N \\boldsymbol{v}^{(j)}$.\n   - Computes the unbiased per-component sample variance $\\widehat{\\sigma}_i^2 = \\dfrac{1}{N-1} \\sum_{j=1}^N \\left(v_i^{(j)} - \\widehat{v}_i\\right)^2$ for $i \\in \\{x,y,z\\}$.\n   - Computes the empirical mean squared speed $\\widehat{S}_2 = \\dfrac{1}{N} \\sum_{j=1}^N \\lVert \\boldsymbol{v}^{(j)} \\rVert^2$.\n   - Computes the empirical kinetic energy density $\\widehat{\\mathcal{E}} = \\dfrac{1}{2} m n \\widehat{S}_2$.\n   - Quantifies agreement using standardized discrepancies (z-scores) based on the sampling distributions you derive:\n     - For each component $i$, test $\\left|\\widehat{v}_i - u_i\\right| \\leq z_{\\star} \\sqrt{\\mathrm{Var}(v_i)/N}$.\n     - For each component $i$, test $\\left|\\widehat{\\sigma}_i^2 - \\mathrm{Var}(v_i)\\right| \\leq z_{\\star} \\,\\sqrt{\\mathrm{Var}(\\widehat{\\sigma}_i^2)}$ using the exact variance of the unbiased sample variance for a normal distribution.\n     - Test $\\left|\\widehat{S}_2 - \\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]\\right| \\leq z_{\\star} \\sqrt{\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)/N}$.\n     - Test $\\left|\\widehat{\\mathcal{E}} - \\mathcal{E}\\right| \\leq z_{\\star} \\,\\sqrt{\\mathrm{Var}\\!\\left(\\widehat{\\mathcal{E}}\\right)}$ using propagation from $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$.\n   - Use the standardized threshold $z_{\\star} = 5$.\n   - All velocities must be in $\\mathrm{m/s}$, masses in $\\mathrm{kg}$, temperatures in electron-volts converted to joules via $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$, number density in $\\mathrm{m^{-3}}$, energy density in $\\mathrm{J/m^3}$.\n   - Set the pseudorandom seed to $s = 123456789$.\n4. For each test case, produce a list of four booleans indicating whether each of the four checks passed, in the following fixed order:\n   - Mean vector check.\n   - Per-component variance check (all three components must pass).\n   - Mean squared speed check.\n   - Kinetic energy density check.\n   Aggregate all test-case results into a single list of lists.\n\nTest Suite:\n- Test case A (electrons, zero drift, moderate temperature):\n  - Species mass $m = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n  - Temperature $T = 100\\,\\mathrm{eV}$.\n  - Number density $n = 1.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (0,0,0)\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n- Test case B (deuterons, finite drift, high temperature):\n  - Species mass $m = 3.343583719 \\times 10^{-27}\\,\\mathrm{kg}$.\n  - Temperature $T = 10000\\,\\mathrm{eV}$.\n  - Number density $n = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (10^{5},0,0)\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n- Test case C (tritons, zero drift, low temperature):\n  - Species mass $m = 5.007356665 \\times 10^{-27}\\,\\mathrm{kg}$.\n  - Temperature $T = 1\\,\\mathrm{eV}$.\n  - Number density $n = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (0,0,0)\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n- Test case D (electrons, multi-axis drift, higher temperature):\n  - Species mass $m = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n  - Temperature $T = 1000\\,\\mathrm{eV}$.\n  - Number density $n = 1.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (2.0 \\times 10^{6}, -2.0 \\times 10^{6}, 1.0 \\times 10^{6})\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to a test case and is itself a list of four booleans in the order specified above. For example, a valid output structure is $[ [b_{A1}, b_{A2}, b_{A3}, b_{A4}], [b_{B1}, b_{B2}, b_{B3}, b_{B4}], [b_{C1}, b_{C2}, b_{C3}, b_{C4}], [b_{D1}, b_{D2}, b_{D3}, b_{D4}] ]$, where each $b_{\\cdot}$ is either $\\mathrm{True}$ or $\\mathrm{False}$.",
            "solution": "The problem requires the derivation and implementation of a Monte Carlo sampling algorithm for a Maxwell-Boltzmann velocity distribution, followed by statistical verification of the sampled moments against their analytically derived counterparts.\n\n### 1. Derivation of the Sampling Algorithm\n\nThe problem starts from the canonical ensemble for a single particle with mass $m$ and Hamiltonian $H = \\sum_{i=1}^{3} p_i^2 / (2m)$, where $\\boldsymbol{p} = (p_x, p_y, p_z)$ is the particle's momentum. The probability of finding the particle in a microstate with momentum $\\boldsymbol{p}$ is proportional to the Boltzmann factor, $f(\\boldsymbol{p}) \\propto \\exp(-H / (k_B T))$. Here, $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. The energy scale $k_B T$ is given in terms of a temperature in electron-volts, $T_{\\text{eV}}$, which is converted to Joules, so we replace $k_B T$ with $T_{\\text{J}} = T_{\\text{eV}} \\times e$, where $e$ is the elementary charge.\n\nSubstituting the Hamiltonian, the probability density function (PDF) for the momentum vector $\\boldsymbol{p}$ is:\n$$\nf(\\boldsymbol{p}) \\propto \\exp\\left(-\\frac{p_x^2 + p_y^2 + p_z^2}{2m (k_B T)}\\right) = \\exp\\left(-\\frac{p_x^2}{2m k_B T}\\right) \\exp\\left(-\\frac{p_y^2}{2m k_B T}\\right) \\exp\\left(-\\frac{p_z^2}{2m k_B T}\\right)\n$$\nThis shows that the momentum components $p_x$, $p_y$, and $p_z$ are statistically independent. The PDF for each component $p_i$ is of the form $f(p_i) \\propto \\exp(-p_i^2 / (2\\sigma_p^2))$, which is a Gaussian (normal) distribution with mean $0$ and variance $\\sigma_p^2 = m k_B T$.\n\nThe velocity components $v_i$ are related to the momentum components by $v_i = p_i / m$. Since $p_i$ is a normally distributed random variable, $v_i$ is also normally distributed. The mean of $v_i$ is $\\mathbb{E}[v_i] = \\mathbb{E}[p_i/m] = 0/m = 0$. The variance of $v_i$ is $\\mathrm{Var}(v_i) = \\mathrm{Var}(p_i/m) = \\mathrm{Var}(p_i)/m^2 = (m k_B T)/m^2 = k_B T / m$. Let us define this variance as $\\sigma_v^2 \\equiv k_B T / m$.\n\nThis describes the thermal velocity distribution in the particle's rest frame. To account for a bulk fluid motion, we perform a Galilean shift by a uniform drift velocity $\\boldsymbol{u} = (u_x, u_y, u_z)$. The velocity $\\boldsymbol{v}$ in the laboratory frame is the sum of the thermal velocity $\\boldsymbol{v}'$ and the drift velocity $\\boldsymbol{u}$: $\\boldsymbol{v} = \\boldsymbol{v}' + \\boldsymbol{u}$.\nThe components of the laboratory-frame velocity are $v_i = v_i' + u_i$. Since $v_i' \\sim \\mathcal{N}(0, \\sigma_v^2)$, each component $v_i$ follows a normal distribution:\n$$\nv_i \\sim \\mathcal{N}(u_i, \\sigma_v^2) = \\mathcal{N}\\left(u_i, \\frac{k_B T}{m}\\right)\n$$\nTo generate samples from this distribution, we can use an affine transformation of standard normal variates. Let $Z_i \\sim \\mathcal{N}(0,1)$ be three independent standard normal random variables. We can generate each velocity component $v_i$ as:\n$$\nv_i = u_i + \\sqrt{\\frac{k_B T}{m}} Z_i\n$$\nThis provides the complete algorithm for sampling a velocity vector $\\boldsymbol{v}$:\n1. Calculate the thermal speed parameter (standard deviation of thermal velocity components), $v_{\\text{th}} = \\sqrt{k_B T / m}$.\n2. Generate three independent random numbers $Z_x, Z_y, Z_z$ from the standard normal distribution $\\mathcal{N}(0,1)$.\n3. Construct the velocity vector $\\boldsymbol{v} = (v_x, v_y, v_z)$ as:\n   $v_x = u_x + v_{\\text{th}} Z_x$\n   $v_y = u_y + v_{\\text{th}} Z_y$\n   $v_z = u_z + v_{\\text{th}} Z_z$\n\n### 2. Derivation of Analytical Moments\n\nWe derive the required analytical moments for verification. Let $\\sigma^2 = k_B T / m$. The velocity components are $v_i \\sim \\mathcal{N}(u_i, \\sigma^2)$ and are independent.\n\n- **Mean velocity vector $\\mathbb{E}[\\boldsymbol{v}]$**:\nThe expectation of each component is $\\mathbb{E}[v_i] = u_i$. Therefore, the mean velocity vector is simply the drift velocity:\n$$\n\\mathbb{E}[\\boldsymbol{v}] = \\boldsymbol{u}\n$$\n\n- **Per-component variance $\\mathrm{Var}(v_i)$**:\nThe variance of each component is by definition the variance of the normal distribution from which it is drawn:\n$$\n\\mathrm{Var}(v_i) = \\sigma^2 = \\frac{k_B T}{m} \\quad \\text{for } i \\in \\{x,y,z\\}\n$$\n\n- **Mean squared speed $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$**:\nThe squared speed is $\\lVert \\boldsymbol{v} \\rVert^2 = v_x^2 + v_y^2 + v_z^2$. By linearity of expectation, $\\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2] = \\sum_{i=x,y,z} \\mathbb{E}[v_i^2]$.\nUsing the relation $\\mathbb{E}[X^2] = \\mathrm{Var}(X) + (\\mathbb{E}[X])^2$, we have $\\mathbb{E}[v_i^2] = \\mathrm{Var}(v_i) + (\\mathbb{E}[v_i])^2 = \\sigma^2 + u_i^2$.\nSumming over the components:\n$$\n\\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2] = (\\sigma^2 + u_x^2) + (\\sigma^2 + u_y^2) + (\\sigma^2 + u_z^2) = 3\\sigma^2 + \\lVert \\boldsymbol{u} \\rVert^2 = 3\\frac{k_B T}{m} + \\lVert \\boldsymbol{u} \\rVert^2\n$$\n\n- **Kinetic energy density $\\mathcal{E}$**:\nUsing its definition $\\mathcal{E} = \\frac{1}{2} m n \\,\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$, we substitute the above result:\n$$\n\\mathcal{E} = \\frac{1}{2} m n \\left(3\\frac{k_B T}{m} + \\lVert \\boldsymbol{u} \\rVert^2\\right) = \\frac{3}{2} n k_B T + \\frac{1}{2} m n \\lVert \\boldsymbol{u} \\rVert^2\n$$\n\n- **Variance of the squared speed $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$**:\nLet $S_2 = \\lVert \\boldsymbol{v} \\rVert^2 = \\sum_i v_i^2$. We need $\\mathrm{Var}(S_2)$. Since the components $v_i$ are independent, the variance of their sum is the sum of their variances: $\\mathrm{Var}(S_2) = \\sum_i \\mathrm{Var}(v_i^2)$.\nWe need $\\mathrm{Var}(v_i^2) = \\mathbb{E}[v_i^4] - (\\mathbb{E}[v_i^2])^2$.\nFor a normal variable $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$, the central moments are $\\mathbb{E}[(X-\\mu)^2] = \\sigma^2$ and $\\mathbb{E}[(X-\\mu)^4] = 3\\sigma^4$.\nWe expand $v_i = u_i + v_i'$, where $v_i' \\sim \\mathcal{N}(0, \\sigma^2)$.\n$\\mathbb{E}[v_i^4] = \\mathbb{E}[(u_i + v_i')^4] = u_i^4 + 6u_i^2\\mathbb{E}[(v_i')^2] + \\mathbb{E}[(v_i')^4] = u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4$.\nWe already know $\\mathbb{E}[v_i^2] = u_i^2 + \\sigma^2$.\nSo, $\\mathrm{Var}(v_i^2) = (u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4) - (u_i^2 + \\sigma^2)^2 = (u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4) - (u_i^4 + 2u_i^2\\sigma^2 + \\sigma^4) = 4u_i^2\\sigma^2 + 2\\sigma^4$.\nSumming over $i=x,y,z$:\n$$\n\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2) = \\sum_i (4u_i^2\\sigma^2 + 2\\sigma^4) = 4\\sigma^2 \\sum_i u_i^2 + \\sum_i 2\\sigma^4 = 4\\sigma^2 \\lVert \\boldsymbol{u} \\rVert^2 + 6\\sigma^4\n$$\nSubstituting $\\sigma^2 = k_B T / m$:\n$$\n\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2) = 4\\frac{k_B T}{m} \\lVert \\boldsymbol{u} \\rVert^2 + 6\\left(\\frac{k_B T}{m}\\right)^2\n$$\n\n### 3. Statistical Verification\n\nThe Monte Carlo simulation generates a sample of $N$ velocities $\\{\\boldsymbol{v}^{(j)}\\}_{j=1}^N$. We compute empirical estimates of the moments and test if they fall within a statistically expected range of the analytical values. The tests are based on the Central Limit Theorem, forming z-scores with a threshold of $z_{\\star} = 5$.\n\n1.  **Mean Velocity**: The empirical mean is $\\widehat{v}_i = \\frac{1}{N}\\sum_j v_i^{(j)}$. The standard error of the mean is $\\sqrt{\\mathrm{Var}(v_i)/N}$. The test for each component is $|\\widehat{v}_i - u_i| \\le z_{\\star} \\sqrt{\\mathrm{Var}(v_i)/N}$.\n\n2.  **Per-component Variance**: The unbiased sample variance is $\\widehat{\\sigma}_i^2 = \\frac{1}{N-1}\\sum_j (v_i^{(j)} - \\widehat{v}_i)^2$. For samples from a normal distribution $\\mathcal{N}(\\mu, \\sigma^2)$, the variance of the sample variance is $\\mathrm{Var}(\\widehat{\\sigma}_i^2) = \\frac{2(\\mathrm{Var}(v_i))^2}{N-1}$. The test is $|\\widehat{\\sigma}_i^2 - \\mathrm{Var}(v_i)| \\le z_{\\star} \\sqrt{2(\\mathrm{Var}(v_i))^2 / (N-1)}$.\n\n3.  **Mean Squared Speed**: The empirical mean is $\\widehat{S}_2 = \\frac{1}{N}\\sum_j \\lVert \\boldsymbol{v}^{(j)} \\rVert^2$. The standard error of this mean is $\\sqrt{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)/N}$. The test is $|\\widehat{S}_2 - \\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2]| \\le z_{\\star} \\sqrt{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)/N}$.\n\n4.  **Kinetic Energy Density**: The empirical estimate is $\\widehat{\\mathcal{E}} = \\frac{1}{2} m n \\widehat{S}_2$. Being a linear scaling of $\\widehat{S}_2$, its test is equivalent to that for the mean squared speed. The variance of the estimator is $\\mathrm{Var}(\\widehat{\\mathcal{E}}) = \\mathrm{Var}(\\frac{1}{2} m n \\widehat{S}_2) = (\\frac{1}{2} m n)^2 \\mathrm{Var}(\\widehat{S}_2) = (\\frac{1}{2} m n)^2 \\frac{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)}{N}$. The test $|\\widehat{\\mathcal{E}} - \\mathcal{E}| \\le z_{\\star}\\sqrt{\\mathrm{Var}(\\widehat{\\mathcal{E}})}$ simplifies to the test for $\\widehat{S}_2$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the particle velocity sampling and verification problem.\n    \"\"\"\n    # Define constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    SEED = 123456789\n    Z_STAR = 5.0\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"m\": 9.1093837015e-31,  # Electron mass (kg)\n            \"T_eV\": 100.0,\n            \"n\": 1.0e19,\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"B\",\n            \"m\": 3.343583719e-27,   # Deuteron mass (kg)\n            \"T_eV\": 10000.0,\n            \"n\": 1.0e20,\n            \"u\": np.array([1.0e5, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"C\",\n            \"m\": 5.007356665e-27,   # Triton mass (kg)\n            \"T_eV\": 1.0,\n            \"n\": 5.0e20,\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"D\",\n            \"m\": 9.1093837015e-31,  # Electron mass (kg)\n            \"T_eV\": 1000.0,\n            \"n\": 1.0e19,\n            \"u\": np.array([2.0e6, -2.0e6, 1.0e6]),\n            \"N\": 200000\n        }\n    ]\n\n    # Initialize a pseudorandom number generator with a fixed seed\n    rng = np.random.default_rng(SEED)\n    \n    results = []\n\n    for case in test_cases:\n        m, T_eV, n, u, N = case[\"m\"], case[\"T_eV\"], case[\"n\"], case[\"u\"], case[\"N\"]\n\n        # --- 1. Analytical Moment Calculations ---\n        k_B_T = T_eV * E_CHARGE\n        \n        # Per-component variance\n        var_v_analytic = k_B_T / m\n        \n        # Mean velocity vector (is just u)\n        mean_v_analytic = u\n        \n        # Mean squared speed\n        u_sq_norm = np.sum(u**2)\n        mean_sq_speed_analytic = 3 * var_v_analytic + u_sq_norm\n        \n        # Variance of squared speed\n        var_sq_speed_analytic = 4 * var_v_analytic * u_sq_norm + 6 * var_v_analytic**2\n        \n        # Kinetic energy density\n        energy_density_analytic = 0.5 * m * n * mean_sq_speed_analytic\n\n        # --- 2. Monte Carlo Sampling ---\n        v_th = np.sqrt(var_v_analytic)\n        thermal_velocities = v_th * rng.standard_normal(size=(N, 3))\n        velocities = u + thermal_velocities\n\n        # --- 3. Empirical Moment Calculations ---\n        # Empirical mean vector\n        mean_v_empirical = np.mean(velocities, axis=0)\n        \n        # Empirical per-component variance (unbiased)\n        var_v_empirical = np.var(velocities, axis=0, ddof=1)\n        \n        # Empirical mean squared speed\n        sq_speeds = np.sum(velocities**2, axis=1)\n        mean_sq_speed_empirical = np.mean(sq_speeds)\n\n        # Empirical kinetic energy density\n        energy_density_empirical = 0.5 * m * n * mean_sq_speed_empirical\n\n        # --- 4. Statistical Verification Checks ---\n        \n        # Check 1: Mean vector\n        std_err_mean_v = np.sqrt(var_v_analytic / N)\n        # Avoid division by zero if std_err is zero (e.g., T=0)\n        z_scores_mean = np.zeros(3)\n        if std_err_mean_v > 0:\n            z_scores_mean = np.abs(mean_v_empirical - mean_v_analytic) / std_err_mean_v\n        check_mean_vector = np.all(z_scores_mean <= Z_STAR)\n\n        # Check 2: Per-component variance\n        var_of_sample_var = 2 * var_v_analytic**2 / (N - 1)\n        std_err_var_v = np.sqrt(var_of_sample_var)\n        z_scores_var = np.zeros(3)\n        if std_err_var_v > 0:\n             z_scores_var = np.abs(var_v_empirical - var_v_analytic) / std_err_var_v\n        check_variance = np.all(z_scores_var <= Z_STAR)\n\n        # Check 3: Mean squared speed\n        std_err_mean_sq_speed = np.sqrt(var_sq_speed_analytic / N)\n        z_score_sq_speed = 0.0\n        if std_err_mean_sq_speed > 0:\n            z_score_sq_speed = np.abs(mean_sq_speed_empirical - mean_sq_speed_analytic) / std_err_mean_sq_speed\n        check_mean_sq_speed = z_score_sq_speed <= Z_STAR\n        \n        # Check 4: Kinetic energy density\n        var_of_E_hat = (0.5 * m * n)**2 * var_sq_speed_analytic / N\n        std_err_E = np.sqrt(var_of_E_hat)\n        z_score_E = 0.0\n        if std_err_E > 0:\n            z_score_E = np.abs(energy_density_empirical - energy_density_analytic) / std_err_E\n        check_energy_density = z_score_E <= Z_STAR\n        \n        results.append([\n            bool(check_mean_vector),\n            bool(check_variance),\n            bool(check_mean_sq_speed),\n            bool(check_energy_density)\n        ])\n\n    # Final print statement in the exact required format.\n    # The format [ [b1, b2, ...], [b1, b2, ...] ] requires spaces after commas.\n    # The str() representation of a list of lists matches this format.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```"
        }
    ]
}