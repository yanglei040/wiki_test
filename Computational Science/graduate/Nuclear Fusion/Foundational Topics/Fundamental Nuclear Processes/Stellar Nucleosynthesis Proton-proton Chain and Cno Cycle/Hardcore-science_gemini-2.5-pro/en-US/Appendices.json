{
    "hands_on_practices": [
        {
            "introduction": "The net result of both the proton-proton (pp) chain and the CNO cycle is the fusion of four protons into a helium nucleus. While the total mass-energy released, $Q_{\\text{net}}$, is identical, the energy that actually contributes to a star's luminosity is not. This practice focuses on a crucial aspect of stellar energy accounting: the energy lost to neutrinos . By calculating the effective energy yield for each pathway, you will quantify a key difference between them and understand why the CNO cycle is slightly less efficient at heating the star, despite its importance in massive stars.",
            "id": "2921678",
            "problem": "In hydrogen burning, two distinct pathways convert four protons into one alpha particle: the proton–proton chain (pp-chain) and the carbon–nitrogen–oxygen (CNO) cycle. Both pathways have the same net stoichiometry for the nuclear transmutation, differing only in intermediate steps and the neutrino energy spectra. Treat the following as given data and assumptions:\n\n- The net reaction in both pathways is effectively \n$$4\\,^{1}\\mathrm{H} \\rightarrow\\, ^{4}\\mathrm{He} + 2\\,e^{+} + 2\\,\\nu_{e},$$ \nso that the total mass-energy release (the reaction $Q$-value) is determined by the mass difference between four hydrogen atoms and one helium atom. Using atomic masses, the total $Q$-value is \n$$Q_{\\text{net}} = 26.731\\ \\text{MeV}.$$\n- By definition, the reaction $Q$-value is \n$$Q = \\left(\\sum_{\\text{initial}} m_{i} - \\sum_{\\text{final}} m_{f}\\right)c^{2},$$ \nand, in a stellar plasma, all positrons rapidly annihilate with ambient electrons, depositing their rest-mass energy locally as photons. Neutrinos, however, escape without depositing energy, so their energies are effectively lost from the standpoint of the stellar energy budget.\n- For the pp-chain, consider specifically the ppI branch in which both neutrinos are the low-energy proton–proton neutrinos with average energy \n$$\\langle E_{\\nu}^{\\text{pp}}\\rangle = 0.265\\ \\text{MeV}.$$\nThus, in ppI there are two such neutrinos per $^{4}\\mathrm{He}$ produced.\n- For the CNO cycle, consider the CN-I subcycle, in which two beta decays occur: \n$$^{13}\\mathrm{N} \\rightarrow\\, ^{13}\\mathrm{C} + e^{+} + \\nu_{e},\\quad ^{15}\\mathrm{O} \\rightarrow\\, ^{15}\\mathrm{N} + e^{+} + \\nu_{e}.$$\nThe average neutrino energies from these decays are \n$$\\langle E_{\\nu}^{^{13}\\mathrm{N}}\\rangle = 0.706\\ \\text{MeV},\\quad \\langle E_{\\nu}^{^{15}\\mathrm{O}}\\rangle = 0.996\\ \\text{MeV}.$$\n\nStarting only from conservation of energy–mass ($E=mc^{2}$), the definition of the $Q$-value, and the fact that neutrino energies escape the stellar plasma, derive expressions and compute numerically for each pathway:\n1) the net energy deposited in the stellar plasma per $^{4}\\mathrm{He}$ produced, \n$$E_{\\star} = Q_{\\text{net}} - \\sum E_{\\nu},$$ \nand\n2) the fraction of the total $Q$-value lost to neutrinos, \n$$f_{\\nu} = \\frac{\\sum E_{\\nu}}{Q_{\\text{net}}}.$$\n\nReport your final numerical results as a single row matrix \n$$(E_{\\star}^{\\text{ppI}},\\ f_{\\nu}^{\\text{ppI}},\\ E_{\\star}^{\\text{CNO}},\\ f_{\\nu}^{\\text{CNO}}).$$ \nExpress energies in $\\text{MeV}$ and neutrino-loss fractions as pure decimals (no percent sign). Round all reported numbers to four significant figures.",
            "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- Net reaction: $4\\,^{1}\\mathrm{H} \\rightarrow\\, ^{4}\\mathrm{He} + 2\\,e^{+} + 2\\,\\nu_{e}$\n- Total mass-energy release (Q-value): $Q_{\\text{net}} = 26.731\\ \\text{MeV}$\n- Positron annihilation energy is deposited locally and is included in $Q_{\\text{net}}$.\n- Neutrino energy is lost from the star.\n- For the ppI chain, two neutrinos are produced with an average energy of $\\langle E_{\\nu}^{\\text{pp}}\\rangle = 0.265\\ \\text{MeV}$ each.\n- For the CNO cycle, one neutrino is produced from $^{13}\\mathrm{N}$ decay with average energy $\\langle E_{\\nu}^{^{13}\\mathrm{N}}\\rangle = 0.706\\ \\text{MeV}$, and one from $^{15}\\mathrm{O}$ decay with average energy $\\langle E_{\\nu}^{^{15}\\mathrm{O}}\\rangle = 0.996\\ \\text{MeV}$.\n- Energy deposited in the star: $E_{\\star} = Q_{\\text{net}} - \\sum E_{\\nu}$\n- Fraction of energy lost to neutrinos: $f_{\\nu} = \\frac{\\sum E_{\\nu}}{Q_{\\text{net}}}$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem deals with stellar nucleosynthesis (pp-chain and CNO cycle), which are fundamental, well-established processes in astrophysics. The provided Q-value and neutrino energies are consistent with accepted nuclear physics data.\n- **Well-Posed:** All necessary information, including definitions and constants, is provided for the calculation. The objectives are clear and lead to a unique solution.\n- **Objective:** The problem is stated using precise scientific language without any subjective or ambiguous terms.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, self-contained, and well-posed. It is therefore valid. A solution will be derived.\n\nThe fundamental principle governing this problem is the conservation of energy. The total energy released in the nuclear transmutation, the $Q$-value, is distributed among the reaction products. The problem specifies that the total energy release per formation of one helium-$4$ nucleus is $Q_{\\text{net}} = 26.731\\ \\text{MeV}$. This energy accounts for the mass difference between four hydrogen atoms and one helium atom, which implicitly includes the energy from the annihilation of the two positrons with two electrons ($4 m_e c^2$).\n\nThe energy deposited into the stellar plasma, which contributes to the star's luminosity, is this total energy release minus any energy that escapes the star. According to the problem statement, only neutrinos escape without interaction. Therefore, the net energy deposited in the star, $E_{\\star}$, is given by the provided relation:\n$$E_{\\star} = Q_{\\text{net}} - \\sum E_{\\nu}$$\nHere, $\\sum E_{\\nu}$ is the total energy carried away by all neutrinos produced in the reaction pathway.\n\nThe fraction of the total energy lost to neutrinos, $f_{\\nu}$, is the ratio of the total neutrino energy to the total energy release:\n$$f_{\\nu} = \\frac{\\sum E_{\\nu}}{Q_{\\text{net}}}$$\nWe will now apply these principles to each specified pathway.\n\n**Proton-Proton Chain (ppI branch)**\n\nIn the ppI branch, the formation of one $^{4}\\mathrm{He}$ nucleus involves the production of two low-energy neutrinos. The problem provides the average energy for each of these neutrinos as $\\langle E_{\\nu}^{\\text{pp}}\\rangle = 0.265\\ \\text{MeV}$. The total energy lost to neutrinos is therefore:\n$$\\sum E_{\\nu}^{\\text{ppI}} = 2 \\times \\langle E_{\\nu}^{\\text{pp}}\\rangle = 2 \\times 0.265\\ \\text{MeV} = 0.530\\ \\text{MeV}$$\nThe net energy deposited in the star for the ppI chain, $E_{\\star}^{\\text{ppI}}$, is:\n$$E_{\\star}^{\\text{ppI}} = Q_{\\text{net}} - \\sum E_{\\nu}^{\\text{ppI}} = 26.731\\ \\text{MeV} - 0.530\\ \\text{MeV} = 26.201\\ \\text{MeV}$$\nThe fraction of energy lost to neutrinos, $f_{\\nu}^{\\text{ppI}}$, is:\n$$f_{\\nu}^{\\text{ppI}} = \\frac{\\sum E_{\\nu}^{\\text{ppI}}}{Q_{\\text{net}}} = \\frac{0.530\\ \\text{MeV}}{26.731\\ \\text{MeV}} \\approx 0.019827167$$\nRounding to four significant figures, we get $E_{\\star}^{\\text{ppI}} = 26.20\\ \\text{MeV}$ and $f_{\\nu}^{\\text{ppI}} = 0.01983$.\n\n**Carbon-Nitrogen-Oxygen (CNO) Cycle**\n\nIn the CNO cycle, the formation of one $^{4}\\mathrm{He}$ nucleus also involves the production of two neutrinos, but from different beta decays: one from $^{13}\\mathrm{N}$ and one from $^{15}\\mathrm{O}$. The problem provides the average energies for these neutrinos as $\\langle E_{\\nu}^{^{13}\\mathrm{N}}\\rangle = 0.706\\ \\text{MeV}$ and $\\langle E_{\\nu}^{^{15}\\mathrm{O}}\\rangle = 0.996\\ \\text{MeV}$. The total energy lost to neutrinos in this cycle is the sum of these two energies:\n$$\\sum E_{\\nu}^{\\text{CNO}} = \\langle E_{\\nu}^{^{13}\\mathrm{N}}\\rangle + \\langle E_{\\nu}^{^{15}\\mathrm{O}}\\rangle = 0.706\\ \\text{MeV} + 0.996\\ \\text{MeV} = 1.702\\ \\text{MeV}$$\nThe net energy deposited in the star for the CNO cycle, $E_{\\star}^{\\text{CNO}}$, is:\n$$E_{\\star}^{\\text{CNO}} = Q_{\\text{net}} - \\sum E_{\\nu}^{\\text{CNO}} = 26.731\\ \\text{MeV} - 1.702\\ \\text{MeV} = 25.029\\ \\text{MeV}$$\nThe fraction of energy lost to neutrinos, $f_{\\nu}^{\\text{CNO}}$, is:\n$$f_{\\nu}^{\\text{CNO}} = \\frac{\\sum E_{\\nu}^{\\text{CNO}}}{Q_{\\text{net}}} = \\frac{1.702\\ \\text{MeV}}{26.731\\ \\text{MeV}} \\approx 0.063671355$$\nRounding to four significant figures, we get $E_{\\star}^{\\text{CNO}} = 25.03\\ \\text{MeV}$ and $f_{\\nu}^{\\text{CNO}} = 0.06367$.\n\n**Final Results**\n\nThe requested quantities, rounded to four significant figures, are:\n- For the ppI chain: $E_{\\star}^{\\text{ppI}} = 26.20\\ \\text{MeV}$ and $f_{\\nu}^{\\text{ppI}} = 0.01983$.\n- For the CNO cycle: $E_{\\star}^{\\text{CNO}} = 25.03\\ \\text{MeV}$ and $f_{\\nu}^{\\text{CNO}} = 0.06367$.\n\nThese four values are to be presented in a single row matrix $(E_{\\star}^{\\text{ppI}},\\ f_{\\nu}^{\\text{ppI}},\\ E_{\\star}^{\\text{CNO}},\\ f_{\\nu}^{\\text{CNO}})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n26.20 & 0.01983 & 25.03 & 0.06367\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building upon the static energy budget, this advanced practice delves into the kinetics of nucleosynthesis, which govern the actual rate of energy production in a star. You will implement a simplified reaction network to calculate the energy generation rates per unit mass, $\\varepsilon_{\\text{pp}}$ and $\\varepsilon_{\\text{CNO}}$, as a function of temperature, density, and composition . This exercise introduces the fundamental concept of steady-state for intermediate nuclei and provides a taste of the computational methods at the core of modern stellar evolution models.",
            "id": "3719529",
            "problem": "Consider a reduced reaction network for stellar nucleosynthesis that captures the dominant structure of the proton-proton chain and the Carbon-Nitrogen-Oxygen (CNO) cycle under conditions of constant temperature and density. Work entirely in terms of mass fractions and number densities so that the formulation is universal across programming languages. You are given a scientifically plausible, nonresonant parametrization of the Maxwellian-averaged cross section for each reaction, a set of net energy release values per completed cycle, and a small test suite of thermodynamic states. Your task is to model the network, enforce steady-state conditions for intermediates, and compute energy generation rates and selected steady-state abundances.\n\nFoundational definitions and laws to be used:\n- The number density of species $i$ is $n_i = \\dfrac{\\rho X_i}{A_i m_u}$, where $\\rho$ is the mass density, $X_i$ is the mass fraction of species $i$, $A_i$ is the mass number of species $i$, and $m_u$ is the atomic mass unit.\n- For a two-body reaction $i + j \\rightarrow \\cdots$ with Maxwellian-averaged cross section $\\langle \\sigma v \\rangle_{ij}$, the per-mass reaction event rate is\n$$\nr_{ij} = \\dfrac{n_i n_j \\langle \\sigma v \\rangle_{ij}}{\\rho (1 + \\delta_{ij})} = \\dfrac{\\rho X_i X_j \\langle \\sigma v \\rangle_{ij}}{A_i A_j m_u^2 (1 + \\delta_{ij})},\n$$\nwhere $\\delta_{ij} = 1$ for identical reactants and $\\delta_{ij} = 0$ otherwise.\n- The steady-state of a linear catalytic cycle $S_1 \\xrightarrow{\\lambda_1} S_2 \\xrightarrow{\\lambda_2} \\cdots \\xrightarrow{\\lambda_k} S_1$ with per-nucleus transition rates $\\lambda_\\ell$ and total catalyst number per mass $N_{\\mathrm{tot}}$ is characterized by a constant cycle flux per mass $J$ satisfying\n$$\nJ = \\dfrac{N_{\\mathrm{tot}}}{\\sum_{\\ell=1}^{k} \\lambda_\\ell^{-1}}, \\quad \\text{and} \\quad N_\\ell = \\dfrac{J}{\\lambda_\\ell}, \\quad f_\\ell = \\dfrac{N_\\ell}{N_{\\mathrm{tot}}} = \\dfrac{\\lambda_\\ell^{-1}}{\\sum_{m=1}^{k} \\lambda_m^{-1}},\n$$\nwhere $N_\\ell$ is the steady-state number per mass of $S_\\ell$ and $f_\\ell$ is its steady-state number fraction among catalysts.\n\nNetwork specification and assumptions:\n- Proton-proton chain (minimal closure):\n  - Reactions included: $p + p \\rightarrow d + e^+ + \\nu_e$, $p + d \\rightarrow {}^3\\mathrm{He} + \\gamma$, ${}^3\\mathrm{He} + {}^3\\mathrm{He} \\rightarrow {}^4\\mathrm{He} + 2p$.\n  - Assume $p + d \\rightarrow {}^3\\mathrm{He} + \\gamma$ is sufficiently rapid that the production rate of ${}^3\\mathrm{He}$ equals the $p+p$ event rate.\n  - Steady-state condition for ${}^3\\mathrm{He}$ number: its production rate equals its destruction rate (noting that ${}^3\\mathrm{He} + {}^3\\mathrm{He}$ consumes two ${}^3\\mathrm{He}$ nuclei per event).\n  - Net energy release per completed proton-proton cycle (four protons to one ${}^4\\mathrm{He}$, excluding neutrino losses): $Q_{\\mathrm{pp}} = 26.20\\,\\mathrm{MeV}$.\n- Carbon-Nitrogen-Oxygen (CNO) cycle (reduced catalytic loop):\n  - Steps modeled as proton captures on the catalytic nuclei: ${}^{12}\\mathrm{C}(p,\\gamma){}^{13}\\mathrm{N}$, ${}^{13}\\mathrm{C}(p,\\gamma){}^{14}\\mathrm{N}$, ${}^{14}\\mathrm{N}(p,\\gamma){}^{15}\\mathrm{O}$, ${}^{15}\\mathrm{N}(p,\\alpha){}^{12}\\mathrm{C}$.\n  - Treat beta decays (${}^{13}\\mathrm{N} \\rightarrow {}^{13}\\mathrm{C}$, ${}^{15}\\mathrm{O} \\rightarrow {}^{15}\\mathrm{N}$) as instantaneous relative to proton captures, so the catalytic loop is closed by the four proton-capture steps.\n  - Per-nucleus capture rates are $\\lambda_i = n_p \\langle \\sigma v \\rangle_i$, where $n_p$ is the proton number density.\n  - The total catalyst number per mass $N_{\\mathrm{tot}}$ is fixed by the initial catalyst number fractions $Y_{\\mathrm{cat,tot}} = \\sum_i X_i / A_i$ via $N_{\\mathrm{tot}} = Y_{\\mathrm{cat,tot}}/m_u$.\n  - Net energy release per completed CNO cycle (excluding neutrino losses): $Q_{\\mathrm{CNO}} = 25.00\\,\\mathrm{MeV}$.\n\nMaxwellian-averaged cross section (nonresonant fit) for temperature $T_9 = T/(10^9\\,\\mathrm{K})$:\n$$\n\\langle \\sigma v \\rangle_{ij}(T_9) = C_{ij}\\, T_9^{\\nu_{ij}} \\exp\\!\\left(- b_{ij} T_9^{-1/3}\\right),\n$$\nwith constants (units of $C_{ij}$ are $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$):\n- $p+p$: $C_{pp} = 4.01\\times 10^{-43}$, $\\nu_{pp} = 2.0$, $b_{pp} = 3.380$.\n- $p+d$: $C_{pd} = 3.90\\times 10^{-17}$, $\\nu_{pd} = 1.0$, $b_{pd} = 1.000$.\n- ${}^3\\mathrm{He}+{}^3\\mathrm{He}$: $C_{33} = 5.00\\times 10^{-20}$, $\\nu_{33} = -\\tfrac{2}{3}$, $b_{33} = 12.25$.\n- ${}^{12}\\mathrm{C}+p$: $C_{12p} = 1.20\\times 10^{-22}$, $\\nu_{12p} = -\\tfrac{2}{3}$, $b_{12p} = 15.23$.\n- ${}^{13}\\mathrm{C}+p$: $C_{13p} = 2.00\\times 10^{-22}$, $\\nu_{13p} = -\\tfrac{2}{3}$, $b_{13p} = 14.58$.\n- ${}^{14}\\mathrm{N}+p$: $C_{14p} = 1.00\\times 10^{-25}$, $\\nu_{14p} = -\\tfrac{2}{3}$, $b_{14p} = 15.70$.\n- ${}^{15}\\mathrm{N}+p$: $C_{15p} = 2.20\\times 10^{-22}$, $\\nu_{15p} = -\\tfrac{2}{3}$, $b_{15p} = 14.79$.\n\nUniversal constants to be used:\n- Atomic mass unit $m_u = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- Joule per mega-electron-volt conversion $E_{\\mathrm{MeV}} = 1.602176634\\times 10^{-13}\\,\\mathrm{J/MeV}$.\n\nTasks for each test case:\n1. Compute the steady-state mass fraction $X_3$ of ${}^3\\mathrm{He}$ in the minimal proton-proton chain by enforcing the equality of ${}^3\\mathrm{He}$ production and destruction rates as defined above.\n2. Compute the steady-state catalyst number-fraction distribution $f_i$ across $\\{ {}^{12}\\mathrm{C}, {}^{13}\\mathrm{C}, {}^{14}\\mathrm{N}, {}^{15}\\mathrm{N} \\}$ in the reduced CNO loop using the linear chain steady-state. Report $f_{14}$, the number fraction in ${}^{14}\\mathrm{N}$.\n3. Compute the energy generation rates per mass from the proton-proton chain and the CNO cycle, denoted $\\varepsilon_{\\mathrm{pp}}$ and $\\varepsilon_{\\mathrm{CNO}}$, using $\\varepsilon_{\\mathrm{pp}} = J_{\\mathrm{pp}} Q_{\\mathrm{pp}} E_{\\mathrm{MeV}}$ and $\\varepsilon_{\\mathrm{CNO}} = J_{\\mathrm{CNO}} Q_{\\mathrm{CNO}} E_{\\mathrm{MeV}}$, where $J_{\\mathrm{pp}}$ is the number of completed proton-proton cycles per unit mass per unit time (equal to the per-mass event rate of ${}^3\\mathrm{He}+{}^3\\mathrm{He}$) and $J_{\\mathrm{CNO}}$ is the cycle flux per unit mass computed from the catalytic steady-state.\n4. Express $\\varepsilon_{\\mathrm{pp}}$ and $\\varepsilon_{\\mathrm{CNO}}$ in $\\mathrm{W\\,kg^{-1}}$ and the fractions $X_3$ and $f_{14}$ as decimals.\n\nTest suite:\n- Case $1$: $T_9 = 0.015$, $\\rho = 1.50\\times 10^{5}\\,\\mathrm{kg\\,m^{-3}}$, $X_{\\mathrm{H}} = 0.34$, $X_{{}^{12}\\mathrm{C}} = 1.00\\times 10^{-3}$, $X_{{}^{14}\\mathrm{N}} = 1.00\\times 10^{-3}$.\n- Case $2$: $T_9 = 0.050$, $\\rho = 1.50\\times 10^{5}\\,\\mathrm{kg\\,m^{-3}}$, $X_{\\mathrm{H}} = 0.70$, $X_{{}^{12}\\mathrm{C}} = 2.00\\times 10^{-3}$, $X_{{}^{14}\\mathrm{N}} = 3.00\\times 10^{-3}$.\n- Case $3$: $T_9 = 0.005$, $\\rho = 1.00\\times 10^{5}\\,\\mathrm{kg\\,m^{-3}}$, $X_{\\mathrm{H}} = 0.70$, $X_{{}^{12}\\mathrm{C}} = 1.00\\times 10^{-5}$, $X_{{}^{14}\\mathrm{N}} = 1.00\\times 10^{-5}$.\n- Case $4$: $T_9 = 0.015$, $\\rho = 5.00\\times 10^{4}\\,\\mathrm{kg\\,m^{-3}}$, $X_{\\mathrm{H}} = 0.50$, $X_{{}^{12}\\mathrm{C}} = 1.00\\times 10^{-3}$, $X_{{}^{14}\\mathrm{N}} = 5.00\\times 10^{-4}$.\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated list of numerical results enclosed in square brackets. For each test case, append in order the four results $[\\varepsilon_{\\mathrm{pp}}, \\varepsilon_{\\mathrm{CNO}}, X_3, f_{14}]$ to form one flattened list across all cases. For example, the output must look like $[r_1,r_2,r_3,r_4,r_5,r_6,\\dots]$, where $r_k$ are the floats computed for the test suite in the order specified.",
            "solution": "The user-provided problem is a well-posed, scientifically-grounded exercise in nuclear astrophysics. It requires the calculation of reaction rates and steady-state abundances for simplified proton-proton (pp) and Carbon-Nitrogen-Oxygen (CNO) nucleosynthesis networks. The problem provides all necessary physical laws, network assumptions, reaction cross-section parametrizations, and physical constants. It is self-contained, internally consistent, and requires the application of standard principles in the field. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe solution proceeds by first deriving the general symbolic expressions for the four requested quantities: the steady-state mass fraction of Helium-3 ($X_3$), the steady-state number fraction of Nitrogen-14 in the CNO cycle ($f_{14}$), and the energy generation rates for the pp-chain ($\\varepsilon_{\\mathrm{pp}}$) and the CNO cycle ($\\varepsilon_{\\mathrm{CNO}}$). These expressions are then implemented computationally for each test case.\n\nThe foundational equations provided are the number density of a species $i$, $n_i = \\dfrac{\\rho X_i}{A_i m_u}$, and the per-mass reaction rate between species $i$ and $j$, $r_{ij} = \\dfrac{\\rho X_i X_j \\langle \\sigma v \\rangle_{ij}}{A_i A_j m_u^2 (1 + \\delta_{ij})}$. The temperature dependence of the Maxwellian-averaged cross section is given by $\\langle \\sigma v \\rangle_{ij}(T_9) = C_{ij}\\, T_9^{\\nu_{ij}} \\exp\\!\\left(- b_{ij} T_9^{-1/3}\\right)$.\n\n**1. Proton-Proton Chain Calculations**\n\nThe minimal pp-chain considered is:\n$p + p \\rightarrow d + e^+ + \\nu_e$\n$p + d \\rightarrow {}^3\\mathrm{He} + \\gamma$\n${}^3\\mathrm{He} + {}^3\\mathrm{He} \\rightarrow {}^4\\mathrm{He} + 2p$\n\nWe apply the steady-state assumption for the intermediate nucleus ${}^3\\mathrm{He}$. Its production rate per unit mass must equal its destruction rate per unit mass.\n\nThe production of ${}^3\\mathrm{He}$ is governed by the $p+p$ reaction, as the subsequent $p+d$ reaction is assumed to be very fast. The rate of $p+p$ reactions per unit mass is:\n$$\nr_{pp} = \\dfrac{\\rho X_p^2 \\langle \\sigma v \\rangle_{pp}}{A_p^2 m_u^2 (1 + \\delta_{pp})} = \\dfrac{\\rho X_{\\mathrm{H}}^2 \\langle \\sigma v \\rangle_{pp}}{2 m_u^2}\n$$\nHere, $X_p = X_{\\mathrm{H}}$ is the hydrogen mass fraction, $A_p=1$, and $\\delta_{pp}=1$ as the reactants are identical. Each $p+p$ event leads to one ${}^3\\mathrm{He}$ nucleus. Thus, the number of ${}^3\\mathrm{He}$ nuclei produced per unit mass per unit time is $(\\frac{dN_3}{dt})_{\\mathrm{prod}} = r_{pp}$.\n\nThe destruction of ${}^3\\mathrm{He}$ occurs via the ${}^3\\mathrm{He}+{}^3\\mathrm{He}$ reaction. The rate of these reaction events per unit mass is:\n$$\nr_{33} = \\dfrac{\\rho X_3^2 \\langle \\sigma v \\rangle_{33}}{A_3^2 m_u^2 (1 + \\delta_{33})} = \\dfrac{\\rho X_3^2 \\langle \\sigma v \\rangle_{33}}{18 m_u^2}\n$$\nwhere $X_3$ is the mass fraction of ${}^3\\mathrm{He}$, $A_3=3$, and $\\delta_{33}=1$. Each such reaction consumes two ${}^3\\mathrm{He}$ nuclei. So, the number of ${}^3\\mathrm{He}$ nuclei destroyed per unit mass per unit time is $(\\frac{dN_3}{dt})_{\\mathrm{dest}} = 2 r_{33}$.\n\nIn steady state, $(\\frac{dN_3}{dt})_{\\mathrm{prod}} = (\\frac{dN_3}{dt})_{\\mathrm{dest}}$, which implies $r_{pp} = 2 r_{33}$.\n$$\n\\dfrac{\\rho X_{\\mathrm{H}}^2 \\langle \\sigma v \\rangle_{pp}}{2 m_u^2} = 2 \\left( \\dfrac{\\rho X_3^2 \\langle \\sigma v \\rangle_{33}}{18 m_u^2} \\right) = \\dfrac{\\rho X_3^2 \\langle \\sigma v \\rangle_{33}}{9 m_u^2}\n$$\nSolving for the steady-state mass fraction $X_3$:\n$$\nX_3^2 = \\dfrac{9}{2} \\dfrac{\\langle \\sigma v \\rangle_{pp}}{\\langle \\sigma v \\rangle_{33}} X_{\\mathrm{H}}^2 \\implies X_3 = X_{\\mathrm{H}} \\sqrt{\\dfrac{9}{2} \\dfrac{\\langle \\sigma v \\rangle_{pp}}{\\langle \\sigma v \\rangle_{33}}}\n$$\n\nThe energy generation rate, $\\varepsilon_{\\mathrm{pp}}$, is the number of completed cycles per mass per time, $J_{\\mathrm{pp}}$, multiplied by the energy release per cycle, $Q_{\\mathrm{pp}}$. A completed cycle corresponds to one ${}^3\\mathrm{He}+{}^3\\mathrm{He}$ reaction. Therefore, $J_{\\mathrm{pp}} = r_{33}$. Using the steady-state condition, $r_{33} = r_{pp}/2$.\n$$\nJ_{\\mathrm{pp}} = \\dfrac{1}{2} r_{pp} = \\dfrac{\\rho X_{\\mathrm{H}}^2 \\langle \\sigma v \\rangle_{pp}}{4 m_u^2}\n$$\nThe energy generation rate is then:\n$$\n\\varepsilon_{\\mathrm{pp}} = J_{\\mathrm{pp}} Q_{\\mathrm{pp}} E_{\\mathrm{MeV}} = \\dfrac{\\rho X_{\\mathrm{H}}^2 \\langle \\sigma v \\rangle_{pp}}{4 m_u^2} Q_{\\mathrm{pp}} E_{\\mathrm{MeV}}\n$$\nwhere $E_{\\mathrm{MeV}}$ is the conversion factor from MeV to Joules.\n\n**2. Carbon-Nitrogen-Oxygen (CNO) Cycle Calculations**\n\nThe CNO cycle is treated as a linear catalytic cycle with four steps, where beta decays are instantaneous. The catalysts are ${}^{12}\\mathrm{C}$, ${}^{13}\\mathrm{C}$, ${}^{14}\\mathrm{N}$, and ${}^{15}\\mathrm{N}$. The per-nucleus transition rate for a proton capture on catalyst $i$ is $\\lambda_i = n_p \\langle \\sigma v \\rangle_{ip}$, where $n_p = \\rho X_{\\mathrm{H}} / m_u$ is the proton number density. The inverse of this rate, $\\tau_i = \\lambda_i^{-1}$, represents the mean lifetime of nucleus $i$ against proton capture.\n\nThe steady-state number fraction, $f_i$, of each catalyst nucleus is given by the ratio of its lifetime to the sum of all lifetimes in the cycle:\n$$\nf_i = \\dfrac{\\tau_i}{\\sum_j \\tau_j} = \\dfrac{\\lambda_i^{-1}}{\\sum_j \\lambda_j^{-1}} = \\dfrac{(n_p \\langle \\sigma v \\rangle_{ip})^{-1}}{\\sum_j (n_p \\langle \\sigma v \\rangle_{jp})^{-1}}\n$$\nThe factor $n_p$ cancels, simplifying the expression to depend only on the cross sections:\n$$\nf_i = \\dfrac{\\langle \\sigma v \\rangle_{ip}^{-1}}{\\sum_j \\langle \\sigma v \\rangle_{jp}^{-1}}\n$$\nWe are asked to compute $f_{14}$, the number fraction of ${}^{14}\\mathrm{N}$. The indices $j$ run over the four CNO catalysts: ${}^{12}\\mathrm{C}$, ${}^{13}\\mathrm{C}$, ${}^{14}\\mathrm{N}$, ${}^{15}\\mathrm{N}$.\n$$\nf_{14} = \\dfrac{\\langle \\sigma v \\rangle_{14p}^{-1}}{\\langle \\sigma v \\rangle_{12p}^{-1} + \\langle \\sigma v \\rangle_{13p}^{-1} + \\langle \\sigma v \\rangle_{14p}^{-1} + \\langle \\sigma v \\rangle_{15p}^{-1}}\n$$\n\nThe energy generation rate, $\\varepsilon_{\\mathrm{CNO}}$, is the CNO cycle flux per mass, $J_{\\mathrm{CNO}}$, multiplied by the energy release per cycle, $Q_{\\mathrm{CNO}}$. The flux is given by $J_{\\mathrm{CNO}} = N_{\\mathrm{tot}} / \\sum_j \\tau_j$.\nThe total number of catalyst nuclei per unit mass, $N_{\\mathrm{tot}}$, is fixed by the initial mass fractions of the CNO elements. It is given as $N_{\\mathrm{tot}} = Y_{\\mathrm{cat,tot}} / m_u$, where $Y_{\\mathrm{cat,tot}} = \\sum_i X_i / A_i$. In this problem, initial mass fractions are provided only for ${}^{12}\\mathrm{C}$ and ${}^{14}\\mathrm{N}$, so we take $Y_{\\mathrm{cat,tot}} = X_{{}^{12}\\mathrm{C}}/A_{12} + X_{{}^{14}\\mathrm{N}}/A_{14}$. The sum of lifetimes is $\\sum_j \\tau_j = \\sum_j (n_p \\langle \\sigma v \\rangle_{jp})^{-1} = (\\rho X_{\\mathrm{H}} / m_u)^{-1} \\sum_j \\langle \\sigma v \\rangle_{jp}^{-1}$.\nCombining these:\n$$\nJ_{\\mathrm{CNO}} = \\dfrac{Y_{\\mathrm{cat,tot}}/m_u}{(\\rho X_{\\mathrm{H}} / m_u)^{-1} \\sum_j \\langle \\sigma v \\rangle_{jp}^{-1}} = \\dfrac{Y_{\\mathrm{cat,tot}} \\rho X_{\\mathrm{H}}}{m_u^2 \\sum_j \\langle \\sigma v \\rangle_{jp}^{-1}}\n$$\nThe energy generation rate is then:\n$$\n\\varepsilon_{\\mathrm{CNO}} = J_{\\mathrm{CNO}} Q_{\\mathrm{CNO}} E_{\\mathrm{MeV}} = \\dfrac{(X_{{}^{12}\\mathrm{C}}/12 + X_{{}^{14}\\mathrm{N}}/14) \\rho X_{\\mathrm{H}}}{m_u^2 \\sum_j \\langle \\sigma v \\rangle_{jp}^{-1}} Q_{\\mathrm{CNO}} E_{\\mathrm{MeV}}\n$$\n\nThese derived formulae are implemented for each test case to obtain the numerical results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the stellar nucleosynthesis problem for the given test cases.\n    \"\"\"\n\n    # Universal constants\n    M_U = 1.66053906660e-27  # kg\n    E_MEV = 1.602176634e-13  # J/MeV\n\n    # Energy release per cycle\n    Q_PP = 26.20  # MeV\n    Q_CNO = 25.00 # MeV\n\n    # Maxwellian-averaged cross section parameters (C, nu, b)\n    # C in m^3/s, nu is dimensionless, b is dimensionless\n    REACTION_PARAMS = {\n        'pp':  (4.01e-43, 2.0, 3.380),\n        '33':  (5.00e-20, -2/3, 12.25),\n        '12p': (1.20e-22, -2/3, 15.23),\n        '13p': (2.00e-22, -2/3, 14.58),\n        '14p': (1.00e-25, -2/3, 15.70),\n        '15p': (2.20e-22, -2/3, 14.79),\n    }\n\n    # Test suite: (T9, rho, X_H, X_C12, X_N14)\n    # T9 in 10^9 K, rho in kg/m^3, X_i are mass fractions\n    test_cases = [\n        (0.015, 1.50e5, 0.34, 1.00e-3, 1.00e-3),\n        (0.050, 1.50e5, 0.70, 2.00e-3, 3.00e-3),\n        (0.005, 1.00e5, 0.70, 1.00e-5, 1.00e-5),\n        (0.015, 5.00e4, 0.50, 1.00e-3, 5.00e-4),\n    ]\n\n    def calc_sigma_v(params, T9):\n        \"\"\"\n        Calculates the Maxwellian-averaged cross section <sigma v>.\n        \"\"\"\n        C, nu, b = params\n        return C * T9**nu * np.exp(-b * T9**(-1/3))\n\n    def solve_case(T9, rho, X_H, X_C12, X_N14):\n        \"\"\"\n        Computes the required quantities for a single test case.\n        \"\"\"\n        # Calculate all required <sigma v> values\n        sv = {key: calc_sigma_v(params, T9) for key, params in REACTION_PARAMS.items()}\n\n        # 1. Proton-Proton Chain Calculations\n        \n        # Steady-state mass fraction of 3He\n        X3 = X_H * np.sqrt(4.5 * sv['pp'] / sv['33'])\n\n        # Energy generation rate from pp-chain (in W/kg)\n        eps_pp = (rho * X_H**2 * sv['pp'] / (4 * M_U**2)) * Q_PP * E_MEV\n\n        # 2. CNO Cycle Calculations\n        \n        # Inverse rates for CNO catalysts\n        tau_inv_12p = 1 / sv['12p']\n        tau_inv_13p = 1 / sv['13p']\n        tau_inv_14p = 1 / sv['14p']\n        tau_inv_15p = 1 / sv['15p']\n        \n        # Sum of inverse rates\n        tau_inv_sum = tau_inv_12p + tau_inv_13p + tau_inv_14p + tau_inv_15p\n        \n        # Steady-state number fraction of 14N\n        f14 = tau_inv_14p / tau_inv_sum\n\n        # Total initial catalyst abundance Y_cat,tot = sum(X_i/A_i)\n        Y_cat_tot = X_C12 / 12.0 + X_N14 / 14.0\n\n        # CNO cycle flux per mass J_CNO\n        J_CNO = (Y_cat_tot * rho * X_H) / (M_U**2 * tau_inv_sum)\n\n        # Energy generation rate from CNO cycle (in W/kg)\n        eps_cno = J_CNO * Q_CNO * E_MEV\n\n        return eps_pp, eps_cno, X3, f14\n    \n    results = []\n    for case in test_cases:\n        T9, rho, X_H, X_C12, X_N14 = case\n        res_tuple = solve_case(T9, rho, X_H, X_C12, X_N14)\n        results.extend(res_tuple)\n    \n    # Format output as a single comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}