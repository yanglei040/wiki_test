{
    "hands_on_practices": [
        {
            "introduction": "在深入研究量子隧穿的复杂性之前，理解原子核必须克服的经典障碍至关重要。本练习将引导你完成一个基础性的“信封背面”计算，以估算氘-氚（D-T）聚变反应的库仑势垒高度。通过这个实践，你将对核聚变所涉及的巨大能量尺度建立起物理直觉，并为理解为何量子力学在其中扮演了不可或缺的角色奠定基础。",
            "id": "3701134",
            "problem": "在氘氚聚变中，决定所谓伽莫夫峰位置并因此强烈影响麦克斯韦平均反应率的势垒穿透概率，在短程范围内由两个原子核之间的静电排斥力所控制。将两个原子核均视为点电荷，并使用库仑定律估算在特征核间距下的库仑势垒高度的数量级。从两个相距为 $r$ 的点电荷 $q_1$ 和 $q_2$ 之间的静电势能出发，其中对于氘和氚，$q_i = Z_i e$ 且 $Z_1 = Z_2 = 1$，推导在 $r \\approx 5\\,\\mathrm{fm}$ 时的势垒高度。使用国际单位制(SI)从第一性原理进行计算，其中 $k_{\\mathrm{e}} = 1/(4\\pi \\varepsilon_0)$，$k_{\\mathrm{e}}$ 是库仑常数，并将结果以兆电子伏特 (MeV) 表示。使用以下常数进行单位换算：$k_{\\mathrm{e}} = 8.9875517923 \\times 10^{9}\\,\\mathrm{N\\,m^{2}/C^{2}}$，$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$，以及 $1\\,\\mathrm{fm} = 10^{-15}\\,\\mathrm{m}$。\n\n以 $\\mathrm{MeV}$ 为单位表示最终能量，并将答案四舍五入到两位有效数字。",
            "solution": "库仑势垒高度 $U$ 表示在短程强核力占主导地位之前，两个带正电的原子核在最近点处的静电势能。对于相距为 $r$ 的两个点电荷 $q_1$ 和 $q_2$，其静电势能由库仑定律给出：\n$$U = k_{\\mathrm{e}} \\frac{q_1 q_2}{r}$$\n其中 $k_{\\mathrm{e}}$ 是库仑常数。\n\n氘 ($Z_1=1$) 和氚 ($Z_2=1$) 原子核的电荷分别为 $q_1 = Z_1 e = 1 \\cdot e = e$ 和 $q_2 = Z_2 e = 1 \\cdot e = e$。将这些代入势能公式可得：\n$$U = k_{\\mathrm{e}} \\frac{e^2}{r}$$\n\n题目要求使用国际单位制进行计算。我们已知以下数值：\n- $k_{\\mathrm{e}} = 8.9875517923 \\times 10^{9}\\,\\mathrm{N\\,m^{2}/C^{2}}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- $r = 5\\,\\mathrm{fm} = 5 \\times 10^{-15}\\,\\mathrm{m}$\n\n将这些值代入 $U$ 的表达式中，得到以焦耳 ($J$) 为单位的能量：\n$$U = (8.9875517923 \\times 10^{9}\\,\\mathrm{N\\,m^{2}/C^{2}}) \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}{5 \\times 10^{-15}\\,\\mathrm{m}}$$\n$$U = (8.9875517923 \\times 10^{9}) \\frac{2.56696996 \\times 10^{-38}}{5 \\times 10^{-15}}\\,\\mathrm{J}$$\n$$U = \\frac{2.3070775 \\times 10^{-28}}{5 \\times 10^{-15}}\\,\\mathrm{J}$$\n$$U = 4.614155 \\times 10^{-14}\\,\\mathrm{J}$$\n\n接下来，必须将这个能量从焦耳 ($J$) 换算为兆电子伏特 (MeV)。我们使用给定的换算因子：\n$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$\n$1\\,\\mathrm{MeV} = 10^6\\,\\mathrm{eV}$\n\n因此，从焦耳到兆电子伏特的换算是：\n$$1\\,\\mathrm{J} = \\frac{1}{1.602176634 \\times 10^{-19}}\\,\\mathrm{eV} = \\frac{1}{1.602176634 \\times 10^{-19} \\times 10^6}\\,\\mathrm{MeV} = \\frac{1}{1.602176634 \\times 10^{-13}}\\,\\mathrm{MeV}$$\n\n将此换算应用于我们计算出的能量 $U$：\n$$U(\\text{in MeV}) = (4.614155 \\times 10^{-14}\\,\\mathrm{J}) \\times \\left(\\frac{1\\,\\mathrm{MeV}}{1.602176634 \\times 10^{-13}\\,\\mathrm{J}}\\right)$$\n$$U(\\text{in MeV}) = \\frac{4.614155 \\times 10^{-14}}{1.602176634 \\times 10^{-13}}\\,\\mathrm{MeV}$$\n$$U \\approx 0.28799\\,\\mathrm{MeV}$$\n\n题目要求最终答案四舍五入到两位有效数字。前两位有效数字是 $2$ 和 $8$。第三位数字是 $7$，大于或等于 $5$，所以我们将第二位有效数字向上取整。\n$$U \\approx 0.29\\,\\mathrm{MeV}$$\n这是在 $5\\,\\mathrm{fm}$ 间距下，D-T聚变的库仑势垒的估算高度。",
            "answer": "$$\\boxed{0.29}$$"
        },
        {
            "introduction": "等离子体中的聚变反应并非发生在单一能量点，而是分布在一个能量区间内。伽莫夫峰描述了聚变反应最有效的能量窗口，它是在高能粒子数目的减少与隧穿概率的增加之间取得的平衡。本练习旨在探索该峰的精细结构。通过计算峰值能量 $E_0$ 和宽度 $\\Delta$，并量化高能尾部对总反应率的贡献，你将对聚变反应率为何对温度如此敏感获得深刻的定量理解 。",
            "id": "3701149",
            "problem": "考虑氘和氚 (DT) 之间的非共振带电粒子核聚变。令反应核的电荷为 $Z_1 = 1$ 和 $Z_2 = 1$，约化质量为 $\\mu = m_\\mathrm{D} m_\\mathrm{T} / (m_\\mathrm{D} + m_\\mathrm{T})$，其中 $m_\\mathrm{D}$ 和 $m_\\mathrm{T}$ 分别是氘核和氚核的质量。在计算中使用以下物理常数和参数：光速 $c$、精细结构常数 $\\alpha$、元电荷 $e$ 以及原子质量单位 $u$。取 $m_\\mathrm{D} = 2.013553212745\\,u$，$m_\\mathrm{T} = 3.01550071632\\,u$，$u = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$，$c = 2.99792458\\times 10^{8}\\,\\mathrm{m/s}$，以及 $\\alpha = 7.2973525693\\times 10^{-3}$。\n\n聚变反应率是反应截面与相对速度之积的麦克斯韦平均值。对于非共振带电粒子反应，通过天体物理 $S$ 因子 $S(E)$ 对能量依赖截面 $\\sigma(E)$ 进行建模，其形式为 $\\sigma(E) = S(E)\\,E^{-1}\\,\\exp\\!\\left(-\\sqrt{E_\\mathrm{G}/E}\\right)$，其中 $E$ 是质心动能，而 $E_\\mathrm{G}$ 是伽莫夫能量，定义为 $E_\\mathrm{G} = 2\\,\\mu\\,c^{2}\\,(\\pi\\,\\alpha\\,Z_1 Z_2)^{2}$。麦克斯韦平均反应率 $\\langle \\sigma v \\rangle$ 与以下积分成正比：\n$$\n\\int_{0}^{\\infty} S(E)\\,\\exp\\!\\left(-\\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} - \\sqrt{\\frac{E_\\mathrm{G}}{E}}\\right)\\,\\mathrm{d}E,\n$$\n其中 $k_\\mathrm{B} T_\\mathrm{eff}$ 表示热能标度。在聚变等离子体实践中，通常直接用能量单位表示温度，因此您必须将 $k_\\mathrm{B} T_\\mathrm{eff}$ 视为给定的热能。在本问题中，所有能量 $E$ 和 $k_\\mathrm{B} T_\\mathrm{eff}$ 都必须以焦耳为单位处理。\n\n定义指数函数 $\\phi(E) = \\dfrac{E}{k_\\mathrm{B} T_\\mathrm{eff}} + \\sqrt{E_\\mathrm{G}/E}$。伽莫夫峰能量 $E_0$ 是使 $\\phi(E)$ 达到其最小值的能量。令 $\\Delta$ 为由 $\\phi(E)$ 在 $E_0$ 附近二阶展开定义的高斯半宽：如果 $\\phi(E) \\approx \\phi(E_0) + \\dfrac{1}{2}\\phi''(E_0)(E-E_0)^2$，则 $\\Delta$ 由 e 分之一倍条件 $\\dfrac{1}{2}\\,\\phi''(E_0)\\,\\Delta^2 = 1$ 确定。考虑能量高于 $E_0 + 2\\Delta$ 的高能尾部对麦克斯韦平均反应率的贡献，该贡献由以下分数来量化：\n$$\nF_\\mathrm{tail} = \\frac{\\displaystyle \\int_{E_0+2\\Delta}^{\\infty} S(E)\\,\\exp\\!\\left(-\\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} - \\sqrt{\\frac{E_\\mathrm{G}}{E}}\\right)\\,\\mathrm{d}E}{\\displaystyle \\int_{0}^{\\infty} S(E)\\,\\exp\\!\\left(-\\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} - \\sqrt{\\frac{E_\\mathrm{G}}{E}}\\right)\\,\\mathrm{d}E}.\n$$\n\n您的任务是实现一个程序，该程序：\n- 仅使用所提供的定义和基础微积分，通过 $\\phi(E)$ 的驻点条件推导出 $E_0$，并通过上述高斯半宽定义根据 $\\phi''(E_0)$ 计算 $\\Delta$。\n- 通过计算分子和分母的积分，对每个指定的测试用例进行 $F_\\mathrm{tail}$ 的数值评估。您必须以焦耳为单位执行所有计算，并以十进制数形式输出无量纲分数。\n\n在测试套件中，对天体物理 $S$ 因子使用以下函数形式：\n- 情况 A（缓变近似）：$S(E) = S_0$，其中 $S_0$ 是一个常数，在分数中被消去。\n- 情况 B（弱线性能量依赖）：$S(E) = S_0\\left(1 + a\\,E/E_0\\right)$，其中 $a$ 是一个无量纲小量。\n\n您必须对以下热能 $k_\\mathrm{B} T_\\mathrm{eff}$ 和 $S(E)$ 模型的测试套件，评估氘-氚（DT）聚变反应的 $F_\\mathrm{tail}$：\n1. $k_\\mathrm{B} T_\\mathrm{eff} = 10\\,\\mathrm{keV}$，$S(E) = S_0$，尾部阈值 $E_0 + 2\\Delta$。\n2. $k_\\mathrm{B} T_\\mathrm{eff} = 10\\,\\mathrm{keV}$，$S(E) = S_0(1 + a\\,E/E_0)$，其中 $a = 0.1$，尾部阈值 $E_0 + 2\\Delta$。\n3. $k_\\mathrm{B} T_\\mathrm{eff} = 2\\,\\mathrm{keV}$，$S(E) = S_0$，尾部阈值 $E_0 + 2\\Delta$。\n4. $k_\\mathrm{B} T_\\mathrm{eff} = 50\\,\\mathrm{keV}$，$S(E) = S_0$，尾部阈值 $E_0 + 2\\Delta$。\n5. $k_\\mathrm{B} T_\\mathrm{eff} = 10\\,\\mathrm{keV}$，$S(E) = S_0$，尾部阈值 $E_0 + 3\\Delta$（用于探究对截断值敏感性的边界情况）。\n\n所有以千电子伏为单位给出的温度必须通过 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 转换为焦耳。将所有输出值表示为无量纲的十进制分数。您的程序应生成单行输出，其中包含用方括号括起来并以逗号分隔的结果列表（例如，$\\texttt{[result1,result2,result3,result4,result5]}$）。",
            "solution": "该问题要求计算对于非共振带电粒子反应（特别是氘-氚（DT）聚变），高能尾部对总聚变反应率的贡献。此贡献由分数 $F_\\mathrm{tail}$ 量化，它是高能尾部上的反应率积分与全能量范围上的总反应率积分之比。问题的核心在于伽莫夫峰现象，该现象源于粒子能量的麦克斯韦-玻尔兹曼分布与通过库仑势垒的量子力学隧穿概率之间的相互作用。\n\n解决方案主要分两个阶段进行。首先，我们根据问题陈述中的定义，对伽莫夫峰能量 $E_0$ 和高斯半宽 $\\Delta$ 进行解析推导。其次，我们建立一个数值程序，为指定的测试用例计算所需的积分和分数 $F_\\mathrm{tail}$。所有计算都将在国际单位制（SI units）下进行（能量单位为焦耳）。\n\n反应率积分的被积函数与 $S(E)\\,\\exp[-\\phi(E)]$ 成正比，其中 $S(E)$ 是天体物理 S 因子，$\\phi(E)$ 是由下式给出的指数函数：\n$$\n\\phi(E) = \\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} + \\sqrt{\\frac{E_\\mathrm{G}}{E}}\n$$\n此处，$k_\\mathrm{B} T_\\mathrm{eff}$ 是有效热能，$E_\\mathrm{G}$ 是伽莫夫能量，定义为：\n$$\nE_\\mathrm{G} = 2\\,\\mu\\,c^{2}\\,(\\pi\\,\\alpha\\,Z_1 Z_2)^{2}\n$$\nDT 反应的约化质量为 $\\mu = \\frac{m_\\mathrm{D} m_\\mathrm{T}}{m_\\mathrm{D} + m_\\mathrm{T}}$。氘核质量 $m_\\mathrm{D}$、氚核质量 $m_\\mathrm{T}$、光速 $c$、精细结构常数 $\\alpha$ 以及电荷 $Z_1=1, Z_2=1$ 的值均已提供。\n\n**1. 伽莫夫峰能量 ($E_0$) 和宽度 ($\\Delta$) 的解析推导**\n\n伽莫夫峰能量 $E_0$ 是反应速率最大化时的能量。这对应于指数 $\\phi(E)$ 的最小值，因为被积函数主要由指数项决定，该指数项在其自变量最小处达到峰值。为了找到这个最小值，我们计算 $\\phi(E)$ 对能量 $E$ 的一阶导数，并令其为零。\n\n一阶导数为：\n$$\n\\phi'(E) = \\frac{\\mathrm{d}}{\\mathrm{d}E} \\left( \\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} + E_\\mathrm{G}^{1/2}E^{-1/2} \\right) = \\frac{1}{k_\\mathrm{B} T_\\mathrm{eff}} - \\frac{1}{2}E_\\mathrm{G}^{1/2}E^{-3/2}\n$$\n令 $\\phi'(E_0) = 0$ 得到极值点的位置：\n$$\n\\frac{1}{k_\\mathrm{B} T_\\mathrm{eff}} = \\frac{1}{2} E_\\mathrm{G}^{1/2} E_0^{-3/2}\n$$\n求解 $E_0$：\n$$\nE_0^{3/2} = \\frac{1}{2} E_\\mathrm{G}^{1/2} (k_\\mathrm{B} T_\\mathrm{eff})\n$$\n$$\nE_0 = \\left( \\frac{\\sqrt{E_\\mathrm{G}} \\, k_\\mathrm{B} T_\\mathrm{eff}}{2} \\right)^{2/3}\n$$\n该表达式给出了作为伽莫夫能量 $E_G$ 和热能 $k_\\mathrm{B} T_\\mathrm{eff}$ 函数的伽莫夫峰能量。\n\n接下来，我们推导高斯半宽 $\\Delta$。该参数表征伽莫夫峰的宽度，并由 $\\phi(E)$ 在 $E_0$ 处的曲率定义。我们首先计算 $\\phi(E)$ 的二阶导数：\n$$\n\\phi''(E) = \\frac{\\mathrm{d}}{\\mathrm{d}E} \\left( \\frac{1}{k_\\mathrm{B} T_\\mathrm{eff}} - \\frac{1}{2}E_\\mathrm{G}^{1/2}E^{-3/2} \\right) = - \\frac{1}{2}E_\\mathrm{G}^{1/2} \\left( -\\frac{3}{2} \\right) E^{-5/2} = \\frac{3}{4}E_\\mathrm{G}^{1/2}E^{-5/2}\n$$\n我们在 $E=E_0$ 处计算该导数的值。方便起见，首先代入从 $E_0$ 的条件中得到的关系式 $E_\\mathrm{G}^{1/2} = 2 E_0^{3/2} / (k_\\mathrm{B} T_\\mathrm{eff})$：\n$$\n\\phi''(E_0) = \\frac{3}{4} \\left( \\frac{2 E_0^{3/2}}{k_\\mathrm{B} T_\\mathrm{eff}} \\right) E_0^{-5/2} = \\frac{3}{2} \\frac{1}{E_0 k_\\mathrm{B} T_\\mathrm{eff}}\n$$\n问题通过关系式 $\\frac{1}{2}\\phi''(E_0)\\Delta^2 = 1$ 来定义 $\\Delta$。求解 $\\Delta$：\n$$\n\\Delta^2 = \\frac{2}{\\phi''(E_0)} = \\frac{2}{\\frac{3}{2 E_0 k_\\mathrm{B} T_\\mathrm{eff}}} = \\frac{4}{3} E_0 k_\\mathrm{B} T_\\mathrm{eff}\n$$\n$$\n\\Delta = \\sqrt{\\frac{4 E_0 k_\\mathrm{B} T_\\mathrm{eff}}{3}} = \\frac{2}{\\sqrt{3}} \\sqrt{E_0 k_\\mathrm{B} T_\\mathrm{eff}}\n$$\n有了 $E_0$ 和 $\\Delta$ 的这些解析表达式，我们就可以进行数值评估了。\n\n**2. 尾部分数 $F_\\mathrm{tail}$ 的数值评估**\n\n分数 $F_\\mathrm{tail}$ 定义为：\n$$\nF_\\mathrm{tail} = \\frac{\\displaystyle \\int_{E_\\mathrm{cut}}^{\\infty} S(E)\\,\\exp\\!\\left(-\\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} - \\sqrt{\\frac{E_\\mathrm{G}}{E}}\\right)\\,\\mathrm{d}E}{\\displaystyle \\int_{0}^{\\infty} S(E)\\,\\exp\\!\\left(-\\frac{E}{k_\\mathrm{B} T_\\mathrm{eff}} - \\sqrt{\\frac{E_\\mathrm{G}}{E}}\\right)\\,\\mathrm{d}E}\n$$\n其中截断能量为 $E_\\mathrm{cut} = E_0 + n\\Delta$，$n$ 是每个测试用例中指定的乘数（$n=2$ 或 $n=3$）。\n\n每个测试用例的步骤如下：\n1. 以国际单位制（SI units）定义所有物理常数。使用提供的转换因子 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 将给定的热能 $k_\\mathrm{B} T_\\mathrm{eff}$ 从 $\\mathrm{keV}$ 转换为焦耳。\n2. 计算 DT 反应的约化质量 $\\mu$ 和伽莫夫能量 $E_\\mathrm{G}$。这些对所有测试用例都是常数。\n3. 对于测试用例的特定 $k_\\mathrm{B} T_\\mathrm{eff}$，使用推导出的公式计算伽莫夫峰能量 $E_0$ 和宽度 $\\Delta$。\n4. 定义被积函数。对于测试用例，S 因子 $S(E)$ 要么是一个常数 $S_0$，要么具有弱线性能量依赖性 $S(E) = S_0(1 + a\\,E/E_0)$。由于 $S_0$ 是分子和分母积分中的公共乘法常数，它会被消掉。因此，用于数值计算的有效被积函数是：\n    - 情况 A: $I(E) = \\exp\\!\\left(-\\phi(E)\\right)$\n    - 情况 B: $I(E) = (1 + a\\,E/E_0) \\exp\\!\\left(-\\phi(E)\\right)$\n5. 使用数值积分程序（例如 `scipy.integrate.quad`）来计算两个积分：\n    - 分母积分，$I_\\mathrm{total} = \\int_0^\\infty I(E) \\,\\mathrm{d}E$。\n    - 分子积分，$I_\\mathrm{tail} = \\int_{E_0+n\\Delta}^\\infty I(E) \\,\\mathrm{d}E$。\n    由于 $\\exp(-\\sqrt{E_G/E})$ 项，当 $E \\to 0^+$ 时，被积函数非常快地趋近于零，因此 $E=0$ 处的潜在奇异点不会对数值积分构成问题。\n6. 计算最终分数 $F_\\mathrm{tail} = I_\\mathrm{tail} / I_\\mathrm{total}$。\n\n对问题描述中提供的五个测试用例中的每一个都实施此程序，从而产生五个无量纲的十进制分数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the high-energy tail contribution to fusion reactivity for DT reactions.\n    \"\"\"\n\n    # --- Physical Constants (in SI units) ---\n    # Atomic mass unit in kg\n    U = 1.66053906660e-27\n    # Speed of light in m/s\n    C = 2.99792458e8\n    # Fine-structure constant (dimensionless)\n    ALPHA = 7.2973525693e-3\n    # Elementary charge in Coulombs, also the eV to Joule conversion factor\n    EV_TO_J = 1.602176634e-19\n\n    # --- Particle Properties ---\n    # Deuteron and Triton masses in kg\n    M_D = 2.013553212745 * U\n    M_T = 3.01550071632 * U\n    \n    # Reacting nuclei charges (dimensionless) for DT fusion\n    Z1 = 1.0\n    Z2 = 1.0\n\n    # --- Derived Constants for DT fusion ---\n    # Reduced mass in kg\n    mu = (M_D * M_T) / (M_D + M_T)\n    # Gamow energy in Joules, based on the problem's definition\n    E_G = 2 * mu * C**2 * (np.pi * ALPHA * Z1 * Z2)**2\n\n    # --- Test Cases ---\n    # Each case: (k_B * T_eff in keV, S-factor model, 'a' parameter, tail threshold multiplier 'n')\n    test_cases = [\n        (10.0, 'A', 0.0, 2.0),\n        (10.0, 'B', 0.1, 2.0),\n        (2.0,  'A', 0.0, 2.0),\n        (50.0, 'A', 0.0, 2.0),\n        (10.0, 'A', 0.0, 3.0),\n    ]\n\n    results = []\n\n    # --- Integrand Function Definition ---\n    def integrand(E, kBT_J, E_G_loc, s_case, a_param, E0_loc):\n        \"\"\"\n        Computes the value of the integrand for numerical integration.\n        The S0 factor is omitted as it cancels in the final fraction.\n        \"\"\"\n        # Avoid division by zero at E=0; exp term will handle it.\n        if E = 0:\n            return 0.0\n        \n        # Exponent from Maxwell-Boltzmann and Gamow factor\n        phi = (E / kBT_J) + np.sqrt(E_G_loc / E)\n        \n        # S-factor relative contribution\n        if s_case == 'B':\n            s_factor_term = 1.0 + a_param * E / E0_loc\n        else: # Case 'A'\n            s_factor_term = 1.0\n            \n        return s_factor_term * np.exp(-phi)\n\n    # --- Main Calculation Loop ---\n    for kBT_keV, s_factor_model, a, n_delta in test_cases:\n        # 1. Convert thermal energy to Joules\n        kBT_J = kBT_keV * 1e3 * EV_TO_J\n\n        # 2. Calculate Gamow peak energy (E0) and width (Delta)\n        # E0 = ( (E_G^0.5 * kBT_J) / 2 )^(2/3)\n        E0 = ((np.sqrt(E_G) * kBT_J) / 2)**(2.0/3.0)\n        # Delta = (2 / sqrt(3)) * sqrt(E0 * kBT_J)\n        Delta = (2.0 / np.sqrt(3.0)) * np.sqrt(E0 * kBT_J)\n\n        # 3. Define arguments for the integrator\n        integration_args = (kBT_J, E_G, s_factor_model, a, E0)\n\n        # 4. Numerically compute the denominator integral (total reactivity)\n        # The integral is from 0 to infinity.\n        total_integral, _ = quad(integrand, 0, np.inf, args=integration_args)\n        \n        # 5. Numerically compute the numerator integral (tail reactivity)\n        # The lower bound of the integral is the tail threshold.\n        tail_lower_bound = E0 + n_delta * Delta\n        tail_integral, _ = quad(integrand, tail_lower_bound, np.inf, args=integration_args)\n\n        # 6. Calculate the tail fraction\n        if total_integral == 0:\n            F_tail = 0.0\n        else:\n            F_tail = tail_integral / total_integral\n        \n        results.append(F_tail)\n\n    # --- Final Output ---\n    # Format the results as requested: [result1,result2,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际研究中，天体物理S因子（$S$-factor）是通过实验和数据拟合确定的，这必然会引入不确定性。本练习将理论与应用相结合，要求你计算这些不确定性如何传播到最终的麦克斯韦平均反应率中。这项高级练习介绍了一项在科学建模中至关重要的技能：不确定性量化（uncertainty quantification），展示了如何将实验数据（及其误差）与理论预测联系起来，从而为计算出的聚变率提供一个置信度度量 。",
            "id": "3701113",
            "problem": "给定一个非共振带电粒子聚变情景，其中反应截面使用天体物理$S$因子进行建模。目标是使用一阶线性误差分析，将$S(E)$拟合多项式系数的不确定性传播到指定温度下麦克斯韦平均反应率的不确定性中。所有计算均在国际单位制（SI）中进行。所有能量单位必须是焦耳，温度单位是开尔文，质量单位是千克，最终的麦克斯韦平均反应率必须以$\\mathrm{m^3/s}$为单位报告。\n\n假设以下基本基础：\n- 温度为$\\,T\\,$、折合质量为$\\,\\mu\\,$的两个粒子的相对速度的Maxwell–Boltzmann分布。\n- 非共振带电粒子聚变截面$\\sigma(E)$的表示，用天体物理$S$因子$S(E)$和通过Sommerfeld参数及Gamow能量表示的库仑穿透率来表达。\n- 麦克斯韦平均反应率定义为$\\sigma v$在相对速度分布上的热平均值。\n\n定义和建模假设：\n1. 设$\\,m_1\\,$和$\\,m_2\\,$为反应物原子核质量，折合质量为$\\,\\mu = \\frac{m_1 m_2}{m_1 + m_2}\\,$.\n2. 设$\\,Z_1\\,$和$\\,Z_2\\,$为以基本电荷为单位的反应物电荷。\n3. Sommerfeld参数$\\,\\eta\\,$满足$\\,\\eta = Z_1 Z_2 \\alpha \\frac{c}{v}\\,$，其中$\\,\\alpha\\,$是精细结构常数，$\\,c\\,$是光速，$\\,v\\,$是对应于能量$\\,E = \\frac{1}{2}\\mu v^2\\,$的相对速度。\n4. Gamow能量$\\,E_G\\,$由$\\,\\exp(-2\\pi \\eta) = \\exp\\!\\left(-\\sqrt{\\frac{E_G}{E}}\\right)\\,$定义，其中\n$$\nE_G \\;=\\; 2\\,\\mu\\,c^2\\,(\\pi\\,\\alpha\\,Z_1 Z_2)^2.\n$$\n5. 天体物理$S$因子建模为多项式\n$$\nS(E) \\;=\\; \\sum_{i=0}^{N} a_i\\,E^i,\n$$\n其系数向量为$\\,\\mathbf{a} = (a_0,a_1,\\dots,a_N)^\\top\\,$，协方差矩阵为$\\,\\mathbf{C}\\,$（单位需保持一致，使得$S(E)$的单位为$\\mathrm{J\\cdot m^2}$，从而$\\sigma(E)$的单位为$\\mathrm{m^2}$）。\n6. 非共振截面$\\sigma(E)$与$S(E)$的关系为\n$$\n\\sigma(E) \\;=\\; \\frac{S(E)}{E}\\,\\exp\\!\\Big(-\\sqrt{\\tfrac{E_G}{E}}\\Big).\n$$\n7. 麦克斯韦平均反应率$\\,\\langle \\sigma v \\rangle(T)\\,$定义为$\\,\\sigma(E)\\,v(E)\\,$在Maxwell–Boltzmann相对速度（等效于能量）分布上的热平均值。在此定义中不要引入任何特别的近似；直接从第一性原理进行平均。\n\n不确定性传播：\n- 对于具有协方差$\\,\\mathbf{C}\\,$的函数$\\,f(\\mathbf{a})\\,$，使用一阶线性误差分析：$\\,\\mathrm{Var}[f] \\approx \\mathbf{J}^\\top \\mathbf{C}\\,\\mathbf{J}\\,$，其中$\\,\\mathbf{J} = \\nabla_{\\mathbf{a}} f\\,$是$\\,f\\,$关于$\\,\\mathbf{a}\\,$的梯度，在最佳拟合系数处求值。\n- 将此方法应用于$\\,f(\\mathbf{a}) = \\langle \\sigma v \\rangle(T)\\,$，并报告单标准差不确定性$\\,\\sigma_f = \\sqrt{\\mathrm{Var}[f]}\\,$以及对称置信区间$\\,f \\pm \\sigma_f\\,$（置信度为$68\\%$）和$\\,f \\pm 1.96\\,\\sigma_f\\,$（置信度为$95\\%$）。所有反应率和区间端点均以$\\mathrm{m^3/s}$表示。\n\n算法要求：\n- 从Maxwell–Boltzmann速度分布和给定的$\\,\\sigma(E)\\,$形式，使用$\\,E = \\frac{1}{2}\\mu v^2\\,$并相应地变换变量，推导出$\\,\\langle \\sigma v \\rangle(T)\\,$的能量积分表示。对所需的积分进行数值计算。\n- 梯度分量$\\,\\frac{\\partial}{\\partial a_i}\\langle \\sigma v \\rangle(T)\\,$必须表示为包含由$\\,S(E)\\,$所隐含的基函数的能量积分，并进行数值计算。\n- 使用科学上真实的常数（Boltzmann常数$\\,k_\\mathrm{B}\\,$、基本电荷$\\,e\\,$、真空介电常数$\\,\\varepsilon_0\\,$、约化Planck常数$\\,\\hbar\\,$、光速$\\,c\\,$、由这些常数计算出的精细结构常数$\\,\\alpha\\,$）。\n- 假设为氘-氚聚变，$\\,Z_1=1\\,$, $\\,Z_2=1\\,$。使用$\\,m_\\mathrm{D} = 3.343583719\\times 10^{-27}\\,\\mathrm{kg}\\,$和$\\,m_\\mathrm{T} = 5.0073567446\\times 10^{-27}\\,\\mathrm{kg}\\,$来计算$\\,\\mu\\,$。\n\n测试套件：\n对于下面的每个测试用例，计算平均值$\\,\\langle \\sigma v \\rangle(T)\\,$、其通过线性传播得到的标准差，以及对称的$68\\%$和$95\\%$置信区间的端点。所有结果必须以$\\mathrm{m^3/s}$为单位的浮点数表示。\n\n- 测试用例 1 (正常路径):\n  - 温度 $\\,T = 1.5\\times 10^8\\,\\mathrm{K}$。\n  - 系数 $\\,\\mathbf{a} = [\\,2.0\\times 10^{-41},\\,1.0\\times 10^{-26},\\,1.0\\times 10^{-11}\\,]$，单位分别为 $[\\,\\mathrm{J\\cdot m^2},\\,\\mathrm{m^2},\\,\\mathrm{m^2/J}\\,]$。\n  - 标准差 $\\,\\boldsymbol{\\sigma} = [\\,0.3\\times 10^{-41},\\,0.2\\times 10^{-26},\\,0.5\\times 10^{-11}\\,]$。\n  - 相关矩阵\n    $$\n    \\mathbf{R} \\;=\\;\n    \\begin{bmatrix}\n    1.0  0.3  -0.1\\\\\n    0.3  1.0  0.2\\\\\n    -0.1  0.2  1.0\n    \\end{bmatrix}.\n    $$\n    使用$\\,\\mathbf{C} = \\mathrm{diag}(\\boldsymbol{\\sigma})\\,\\mathbf{R}\\,\\mathrm{diag}(\\boldsymbol{\\sigma})\\,$。\n\n- 测试用例 2 (低温边界):\n  - 温度 $\\,T = 5.0\\times 10^6\\,\\mathrm{K}$。\n  - 系数 $\\,\\mathbf{a} = [\\,1.0\\times 10^{-41},\\,5.0\\times 10^{-27}\\,]$，单位为 $[\\,\\mathrm{J\\cdot m^2},\\,\\mathrm{m^2}\\,]$。\n  - 标准差 $\\,\\boldsymbol{\\sigma} = [\\,0.1\\times 10^{-41},\\,0.3\\times 10^{-27}\\,]$。\n  - 相关矩阵\n    $$\n    \\mathbf{R} \\;=\\;\n    \\begin{bmatrix}\n    1.0  -0.6\\\\\n    -0.6  1.0\n    \\end{bmatrix}.\n    $$\n    使用$\\,\\mathbf{C} = \\mathrm{diag}(\\boldsymbol{\\sigma})\\,\\mathbf{R}\\,\\mathrm{diag}(\\boldsymbol{\\sigma})\\,$。\n\n- 测试用例 3 (高温，高阶多项式):\n  - 温度 $\\,T = 1.0\\times 10^9\\,\\mathrm{K}$。\n  - 系数 $\\,\\mathbf{a} = [\\,2.5\\times 10^{-41},\\,1.5\\times 10^{-26},\\,8.0\\times 10^{-12},\\,1.0\\times 10^{-3}\\,]$，单位为 $[\\,\\mathrm{J\\cdot m^2},\\,\\mathrm{m^2},\\,\\mathrm{m^2/J},\\,\\mathrm{m^2/J^2}\\,]$。\n  - 标准差 $\\,\\boldsymbol{\\sigma} = [\\,0.25\\times 10^{-41},\\,0.15\\times 10^{-26},\\,0.5\\times 10^{-12},\\,0.2\\times 10^{-3}\\,]$。\n  - 相关矩阵\n    $$\n    \\mathbf{R} \\;=\\;\n    \\begin{bmatrix}\n    1.0  0.2  0.0  0.0\\\\\n    0.2  1.0  0.25  -0.1\\\\\n    0.0  0.25  1.0  0.3\\\\\n    0.0  -0.1  0.3  1.0\n    \\end{bmatrix}.\n    $$\n    使用$\\,\\mathbf{C} = \\mathrm{diag}(\\boldsymbol{\\sigma})\\,\\mathbf{R}\\,\\mathrm{diag}(\\boldsymbol{\\sigma})\\,$。\n\n- 测试用例 4 (参数中存在近似共线性):\n  - 温度 $\\,T = 2.0\\times 10^7\\,\\mathrm{K}$。\n  - 系数 $\\,\\mathbf{a} = [\\,1.2\\times 10^{-41},\\,9.0\\times 10^{-27},\\,3.0\\times 10^{-12}\\,]$，单位为 $[\\,\\mathrm{J\\cdot m^2},\\,\\mathrm{m^2},\\,\\mathrm{m^2/J}\\,]$。\n  - 标准差 $\\,\\boldsymbol{\\sigma} = [\\,0.01\\times 10^{-41},\\,0.05\\times 10^{-27},\\,0.02\\times 10^{-12}\\,]$。\n  - 相关矩阵\n    $$\n    \\mathbf{R} \\;=\\;\n    \\begin{bmatrix}\n    1.0  0.99  0.95\\\\\n    0.99  1.0  0.97\\\\\n    0.95  0.97  1.0\n    \\end{bmatrix}.\n    $$\n    使用$\\,\\mathbf{C} = \\mathrm{diag}(\\boldsymbol{\\sigma})\\,\\mathbf{R}\\,\\mathrm{diag}(\\boldsymbol{\\sigma})\\,$。\n\n输出规格：\n- 对于每个测试用例，计算并报告六个浮点数：平均值$\\,\\langle \\sigma v \\rangle\\,$、其标准差$\\,\\sigma_f\\,$、对称$68\\%$置信区间的下限和上限端点，以及对称$95\\%$置信区间的下限和上限端点。所有值必须以$\\mathrm{m^3/s}$为单位。\n- 您的程序应生成单行输出，其中包含所有测试用例的串联结果，格式为方括号内以逗号分隔的列表，按测试用例的顺序排列，每个测试用例的六个数字序列为$[\\,\\text{平均值},\\,\\sigma_f,\\,\\text{CI68}_\\text{低},\\,\\text{CI68}_\\text{高},\\,\\text{CI95}_\\text{低},\\,\\text{CI95}_\\text{高}\\,]$。",
            "solution": "该问题经评估为有效。它在科学上基于核聚变原理，特别是将反应截面与麦克斯韦平均反应率联系起来。该问题是适定的，为获得唯一解提供了所有必要的定义、模型、常数和数据。其语言客观，设置内部一致。\n\n解决方案分为四个主要阶段：\n1.  从第一性原理推导麦克斯韦平均反应率$\\langle \\sigma v \\rangle$的积分表达式。\n2.  推导反应率相对于天体物理$S$因子多项式系数$\\mathbf{a}$的梯度。\n3.  使用推导出的梯度和给定的协方差矩阵，构建不确定性传播的公式。\n4.  数值实现，以计算每个测试用例所需的量。\n\n所有计算均以SI单位进行。\n\n**1. 麦克斯韦平均反应率的推导**\n\n麦克斯韦平均反应率$\\langle \\sigma v \\rangle$是在温度为$T$、折合质量为$\\mu$的双粒子系统中，聚变截面$\\sigma$和相对速度$v$的乘积在Maxwell-Boltzmann相对速度分布上的热平均值。相对速度$v$的概率分布由下式给出：\n$$\nP(v)dv = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) dv,\n$$\n其中$k_B$是Boltzmann常数。反应率则为：\n$$\n\\langle \\sigma v \\rangle(T) = \\int_0^\\infty \\sigma(v) v \\, P(v) \\, dv = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma(v) v^3 \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) dv.\n$$\n为了计算这个积分，我们将积分变量从速度$v$更改为质心能量$E = \\frac{1}{2}\\mu v^2$。微分关系为$dE = \\mu v dv$，这给出$v dv = \\frac{1}{\\mu} dE$。我们可以将项$v^3 dv$表示为$v^2 (v dv) = \\left(\\frac{2E}{\\mu}\\right) \\left(\\frac{1}{\\mu} dE\\right) = \\frac{2E}{\\mu^2} dE$。截面$\\sigma(v)$变为$\\sigma(E)$。将这些代入积分中得到：\n$$\n\\langle \\sigma v \\rangle(T) = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma(E) \\frac{2E}{\\mu^2} \\exp\\left(-\\frac{E}{k_B T}\\right) dE.\n$$\n简化前置因子：\n$$\n4\\pi \\left(\\frac{\\mu^{3/2}}{(2\\pi)^{3/2} (k_B T)^{3/2}}\\right) \\frac{2}{\\mu^2} = \\frac{8\\pi}{(2\\pi)^{3/2} \\mu^{1/2} (k_B T)^{3/2}} = \\frac{8\\pi}{2\\pi\\sqrt{2\\pi}\\sqrt{\\mu}(k_B T)^{3/2}} = \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2}.\n$$\n因此，作为能量积分的麦克斯韦平均反应率为：\n$$\n\\langle \\sigma v \\rangle(T) = \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2} \\int_0^\\infty E \\, \\sigma(E) \\, \\exp\\left(-\\frac{E}{k_B T}\\right) dE.\n$$\n\n**2. 截面模型的代入与梯度推导**\n\n问题指定了一个非共振截面模型：\n$$\n\\sigma(E) = \\frac{S(E)}{E} \\exp\\left(-\\sqrt{\\frac{E_G}{E}}\\right),\n$$\n其中$S(E)$是天体物理$S$因子，$E_G$是Gamow能量，定义为$E_G = 2\\mu c^2 (\\pi \\alpha Z_1 Z_2)^2$。将此代入反应率表达式中得到：\n$$\n\\langle \\sigma v \\rangle(T) = \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2} \\int_0^\\infty E \\left( \\frac{S(E)}{E} \\exp\\left(-\\sqrt{\\frac{E_G}{E}}\\right) \\right) \\exp\\left(-\\frac{E}{k_B T}\\right) dE.\n$$\n$E$因子被消去，积分简化为：\n$$\n\\langle \\sigma v \\rangle(T) = C_T \\int_0^\\infty S(E) \\exp\\left(-\\sqrt{\\frac{E_G}{E}} - \\frac{E}{k_B T}\\right) dE,\n$$\n其中我们定义了与温度相关的常数$C_T = \\sqrt{\\frac{8}{\\pi\\mu}} \\left(\\frac{1}{k_B T}\\right)^{3/2}$。$S$因子被建模为多项式$S(E) = \\sum_{i=0}^{N} a_i E^i$。将此代入反应率方程：\n$$\n\\langle \\sigma v \\rangle(T) = C_T \\int_0^\\infty \\left( \\sum_{i=0}^{N} a_i E^i \\right) \\exp\\left(-\\sqrt{\\frac{E_G}{E}} - \\frac{E}{k_B T}\\right) dE.\n$$\n由于积分和求和是线性运算，我们可以交换它们的顺序：\n$$\n\\langle \\sigma v \\rangle(T) = \\sum_{i=0}^{N} a_i \\left[ C_T \\int_0^\\infty E^i \\exp\\left(-\\sqrt{\\frac{E_G}{E}} - \\frac{E}{k_B T}\\right) dE \\right].\n$$\n这表明$\\langle \\sigma v \\rangle$是系数$a_i$的线性函数。梯度向量$\\mathbf{J} = \\nabla_{\\mathbf{a}} \\langle \\sigma v \\rangle$的分量为$J_i = \\frac{\\partial \\langle \\sigma v \\rangle}{\\partial a_i}$。从上面的表达式，我们可以直接找到每个分量：\n$$\nJ_i = \\frac{\\partial \\langle \\sigma v \\rangle}{\\partial a_i} = C_T \\int_0^\\infty E^i \\exp\\left(-\\sqrt{\\frac{E_G}{E}} - \\frac{E}{k_B T}\\right) dE.\n$$\n因此，平均反应率可以紧凑地写成点积形式：$\\langle \\sigma v \\rangle = \\mathbf{J}^\\top \\mathbf{a}$。\n\n**3. 不确定性传播**\n\n问题要求使用一阶线性误差传播来从系数$\\mathbf{a}$的不确定性中找到反应率的不确定性$\\sigma_f$。函数$f(\\mathbf{a})$的方差由下式给出：\n$$\n\\mathrm{Var}[f] \\approx \\mathbf{J}^\\top \\mathbf{C} \\mathbf{J},\n$$\n其中$f(\\mathbf{a}) = \\langle \\sigma v \\rangle(\\mathbf{a})$，$\\mathbf{J}$是上面推导出的梯度（雅可比）向量，$\\mathbf{C}$是系数$\\mathbf{a}$的协方差矩阵。问题提供了系数的标准差$\\boldsymbol{\\sigma} = (\\sigma_0, \\sigma_1, \\dots, \\sigma_N)^\\top$及其相关矩阵$\\mathbf{R}$。协方差矩阵构造如下：\n$$\n\\mathbf{C} = \\mathrm{diag}(\\boldsymbol{\\sigma}) \\, \\mathbf{R} \\, \\mathrm{diag}(\\boldsymbol{\\sigma}).\n$$\n反应率的单标准差不确定性为$\\sigma_f = \\sqrt{\\mathrm{Var}[\\langle \\sigma v \\rangle]}$。然后，对称的$68\\%$和$95\\%$置信区间分别计算为$\\langle \\sigma v \\rangle \\pm \\sigma_f$和$\\langle \\sigma v \\rangle \\pm 1.96\\,\\sigma_f$。\n\n**4. 数值计算**\n\n每个测试用例的计算过程如下：\n1.  以SI单位计算所需的物理常数：从给定的氘和氚的质量计算折合质量$\\mu$，精细结构常数$\\alpha = \\frac{e^2}{4\\pi\\varepsilon_0 \\hbar c}$，以及Gamow能量$E_G$。\n2.  对于给定的温度$T$，计算热能标度$k_B T$和前置因子$C_T$。\n3.  对于每个系数$a_i$（从$i=0$到$N$），数值计算相应的积分以找到梯度分量$J_i$。这可以使用标准的数值积分程序（如`scipy.integrate.quad`）在积分范围$E \\in [0, \\infty)$上完成。被积函数由基函数$E^i$和特征Gamow峰项$\\exp(-\\sqrt{E_G/E} - E/k_B T)$组成，该函数在$E$较大时表现良好并收敛。\n4.  组装梯度向量$\\mathbf{J}$。\n5.  计算平均反应率$\\langle \\sigma v \\rangle = \\mathbf{J}^\\top \\mathbf{a}$。\n6.  根据给定的$\\boldsymbol{\\sigma}$和$\\mathbf{R}$构造协方差矩阵$\\mathbf{C}$。\n7.  计算方差$\\sigma_f^2 = \\mathbf{J}^\\top \\mathbf{C} \\mathbf{J}$和标准差$\\sigma_f$。\n8.  计算$68\\%$和$95\\%$置信区间的端点。\n对问题陈述中提供的所有测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.constants import k, e, epsilon_0, hbar, c\n\ndef solve():\n    \"\"\"\n    Solves the problem of propagating uncertainties from S-factor coefficients\n    to the Maxwellian-averaged reactivity for D-T fusion.\n    \"\"\"\n    # 1. Define physical constants and derived quantities in SI units.\n    # Fine-structure constant\n    alpha = e**2 / (4 * np.pi * epsilon_0 * hbar * c)\n\n    # Given reactant masses for D-T fusion\n    m_D = 3.343583719e-27  # Deuterium mass in kg\n    m_T = 5.0073567446e-27 # Tritium mass in kg\n    mu = (m_D * m_T) / (m_D + m_T) # Reduced mass in kg\n\n    # Reactant charges\n    Z1 = 1.0 # Charge number of Deuterium\n    Z2 = 1.0 # Charge number of Tritium\n\n    # Gamow energy, E_G, as defined in the problem statement\n    EG = 2 * mu * c**2 * (np.pi * alpha * Z1 * Z2)**2\n\n    def integrand_func(E, i, local_EG, local_kBT):\n        \"\"\"\n        Computes the integrand for the i-th basis integral: E^i * exp(-sqrt(EG/E) - E/kBT).\n        This function is designed to be used with scipy.integrate.quad.\n        \"\"\"\n        if E = 0:\n            return 0.0\n        \n        # The exponential term dominates and ensures the integrand goes to zero\n        # at both E->0 and E->inf, forming the Gamow peak.\n        # Numerical stability is handled by Python's floating point precision.\n        return (E**i) * np.exp(-np.sqrt(local_EG / E) - E / local_kBT)\n\n    def calculate_reactivity_and_uncertainty(T, a, sigmas, R):\n        \"\"\"\n        Calculates the mean reactivity, standard deviation, and confidence intervals for a given case.\n        \"\"\"\n        # Thermal energy scale\n        kBT = k * T\n        \n        # Polynomial order\n        N = len(a) - 1\n\n        # Reactivity pre-factor constant C_T\n        C_T = np.sqrt(8.0 / (np.pi * mu)) * (1.0 / kBT)**1.5\n\n        # 2. Calculate the gradient vector J, where J_i is the integral for the i-th coefficient.\n        J = np.zeros(N + 1)\n        for i in range(N + 1):\n            integral_val, _ = quad(integrand_func, 0, np.inf, args=(i, EG, kBT), epsabs=1.0e-40, epsrel=1.0e-12)\n            J[i] = C_T * integral_val\n\n        # 3. Calculate the mean reactivity\n        mean_reactivity = np.dot(J, a)\n\n        # 4. Construct the covariance matrix C\n        Sigma_diag = np.diag(sigmas)\n        C = Sigma_diag @ R @ Sigma_diag\n\n        # 5. Calculate the variance and standard deviation\n        variance = J.T @ C @ J\n        std_dev = np.sqrt(variance)\n\n        # 6. Calculate confidence intervals\n        ci68_low = mean_reactivity - std_dev\n        ci68_high = mean_reactivity + std_dev\n        ci95_low = mean_reactivity - 1.96 * std_dev\n        ci95_high = mean_reactivity + 1.96 * std_dev\n\n        return [mean_reactivity, std_dev, ci68_low, ci68_high, ci95_low, ci95_high]\n    \n    # Define test cases as per the problem description\n    test_cases = [\n        # Test Case 1\n        (1.5e8, np.array([2.0e-41, 1.0e-26, 1.0e-11]), np.array([0.3e-41, 0.2e-26, 0.5e-11]), \n         np.array([[1.0, 0.3, -0.1], [0.3, 1.0, 0.2], [-0.1, 0.2, 1.0]])),\n        # Test Case 2\n        (5.0e6, np.array([1.0e-41, 5.0e-27]), np.array([0.1e-41, 0.3e-27]), \n         np.array([[1.0, -0.6], [-0.6, 1.0]])),\n        # Test Case 3\n        (1.0e9, np.array([2.5e-41, 1.5e-26, 8.0e-12, 1.0e-3]), np.array([0.25e-41, 0.15e-26, 0.5e-12, 0.2e-3]), \n         np.array([[1.0, 0.2, 0.0, 0.0], [0.2, 1.0, 0.25, -0.1], [0.0, 0.25, 1.0, 0.3], [0.0, -0.1, 0.3, 1.0]])),\n        # Test Case 4\n        (2.0e7, np.array([1.2e-41, 9.0e-27, 3.0e-12]), np.array([0.01e-41, 0.05e-27, 0.02e-12]), \n         np.array([[1.0, 0.99, 0.95], [0.99, 1.0, 0.97], [0.95, 0.97, 1.0]]))\n    ]\n    \n    all_results = []\n    for T_case, a_case, sigmas_case, R_case in test_cases:\n        results_list = calculate_reactivity_and_uncertainty(T_case, a_case, sigmas_case, R_case)\n        all_results.extend(results_list)\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}