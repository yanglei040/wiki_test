{
    "hands_on_practices": [
        {
            "introduction": "在深入研究电气击穿的复杂过程之前，我们必须首先掌握气体中粒子相互作用的基本物理图像。本练习将引导你回到第一性原理，从理想气体定律出发，推导中性粒子在发生电离前的弹性碰撞平均自由程。通过计算平均自由程$ \\lambda $并分析其与气体压力$ p $和温度$ T $的定量关系，你将为理解帕邢定律中为何压力与电极间距的乘积$ pd $是决定击穿电压的关键参数奠定坚实的物理基础。",
            "id": "3696889",
            "problem": "在中性氢填充用于启动磁约束聚变装置中的电气击穿。在电离之前，气体可被视为理想气体。从理想气体定律 $p = n k_{B} T$ 出发，其中 $p$ 是压强，$n$ 是数密度，$k_{B}$ 是玻尔兹曼常数，$T$ 是温度，推导弹性平均自由程 $\\lambda$ 的闭合表达式，其定义为 $\\lambda = \\frac{1}{n \\sigma}$，其中 $\\sigma$ 是热平均的中性-中性弹性碰撞截面。假设在所关注的温度范围内，$\\sigma$ 与温度无关。\n\n然后，对于压强 $p = 1.0$ $\\mathrm{Pa}$、温度 $T = 300$ $\\mathrm{K}$、有效弹性截面 $\\sigma = 2.0 \\times 10^{-19}$ $\\mathrm{m}^{2}$ 的氢气，计算平均自由程 $\\lambda$。将您的数值答案四舍五入到四位有效数字。用米表示平均自由程。\n\n最后，利用您推导的表达式，定性讨论在与类帕邢行为相关的预击穿状态下，氢气的 $\\lambda$ 如何随 $p$ 和 $T$ 变化，并注意当 $\\sigma$ 具有温度依赖性时的任何警示说明。\n\n只提供 $\\lambda$ 的数值（以米为单位）作为最终答案。",
            "solution": "该问题陈述经评估具有科学依据、提法明确、客观且完整。它提出了一个等离子体物理学和动力学理论中的标准问题，基于基本原理和现实的物理参数。不存在矛盾、歧义或不合理的假设。因此，将提供一个解答。\n\n该问题要求推导弹性平均自由程 $\\lambda$ 的表达式，在特定条件下对其进行数值计算，并定性讨论其标度性质。\n\n首先，我们推导平均自由程 $\\lambda$ 的表达式。我们已知两个基本方程：\n理想气体定律：\n$$p = n k_{B} T$$\n其中 $p$ 是压强，$n$ 是数密度，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n平均自由程的定义：\n$$\\lambda = \\frac{1}{n \\sigma}$$\n其中 $\\sigma$ 是碰撞截面，假定为常数。\n\n我们的目标是找到一个用 $p$ 和 $T$ 表示 $\\lambda$ 的表达式。为实现此目标，我们必须从方程中消去数密度 $n$。根据理想气体定律，我们可以将 $n$ 表示为：\n$$n = \\frac{p}{k_{B} T}$$\n将这个 $n$ 的表达式代入 $\\lambda$ 的方程中，我们得到：\n$$\\lambda = \\frac{1}{\\left(\\frac{p}{k_{B} T}\\right) \\sigma}$$\n简化此表达式可得到所需的闭合形式关系：\n$$\\lambda = \\frac{k_{B} T}{p \\sigma}$$\n\n接下来，我们使用给定的氢气数值来计算 $\\lambda$：\n压强，$p = 1.0 \\, \\mathrm{Pa}$\n温度，$T = 300 \\, \\mathrm{K}$\n弹性截面，$\\sigma = 2.0 \\times 10^{-19} \\, \\mathrm{m}^{2}$\n\n玻尔兹曼常数的值为 $k_{B} \\approx 1.380649 \\times 10^{-23} \\, \\mathrm{J} \\cdot \\mathrm{K}^{-1}$。\n\n将这些值代入推导出的 $\\lambda$ 表达式中：\n$$\\lambda = \\frac{(1.380649 \\times 10^{-23} \\, \\mathrm{J} \\cdot \\mathrm{K}^{-1}) (300 \\, \\mathrm{K})}{(1.0 \\, \\mathrm{Pa}) (2.0 \\times 10^{-19} \\, \\mathrm{m}^{2})}$$\n单位是一致的，因为 $1 \\, \\mathrm{J} = 1 \\, \\mathrm{N} \\cdot \\mathrm{m}$ 且 $1 \\, \\mathrm{Pa} = 1 \\, \\mathrm{N} \\cdot \\mathrm{m}^{-2}$。因此，最终的单位是：\n$$\\frac{(\\mathrm{N} \\cdot \\mathrm{m} \\cdot \\mathrm{K}^{-1}) (\\mathrm{K})}{(\\mathrm{N} \\cdot \\mathrm{m}^{-2}) (\\mathrm{m}^{2})} = \\mathrm{m}$$\n进行计算：\n$$\\lambda = \\frac{4.141947 \\times 10^{-21} \\, \\mathrm{J}}{2.0 \\times 10^{-19} \\, \\mathrm{Pa} \\cdot \\mathrm{m}^{2}} = 2.0709735 \\times 10^{-2} \\, \\mathrm{m}$$\n问题要求将数值答案四舍五入到四位有效数字。\n$$\\lambda \\approx 0.02071 \\, \\mathrm{m}$$\n\n最后，我们讨论在预击穿状态下 $\\lambda$ 的定性标度关系。推导出的表达式为 $\\lambda = \\frac{k_{B} T}{p \\sigma}$。\n1.  **随压强 ($p$) 的标度关系**：在恒定温度 $T$ 下，平均自由程与压强成反比，即 $\\lambda \\propto \\frac{1}{p}$。这是因为在恒定 $T$ 下，压强增加对应于气体粒子数密度 $n$ 的增加，导致更频繁的碰撞，从而缩短了它们之间的路径。\n2.  **随温度 ($T$) 的标度关系**：在恒定压强 $p$ 下，平均自由程与温度成正比，即 $\\lambda \\propto T$。这可能看起来有悖直觉，因为更高的温度意味着更高的粒子速度。然而，为了在温度升高时保持压强恒定，数密度必须降低 ($n = p/(k_{B}T)$)。这种密度降低是主导效应，增加了粒子在碰撞前行进的平均距离。\n\n这种标度关系与 Paschen 定律直接相关，该定律描述了击穿电压 $V_{B}$ 作为乘积 $pd$ 的函数，其中 $d$ 是电极间隙距离。电气击穿通过电子雪崩（Townsend 放电）发生，其中被电场加速的电子必须在两次碰撞之间获得足够的能量以电离中性原子。电子穿过间隙时发生的平均碰撞次数与比率 $\\frac{d}{\\lambda}$ 成正比。由于 $\\lambda \\propto \\frac{1}{p}$，这个比率与乘积 $pd$ 成正比。因此，乘积 $pd$ 是可用于电离的平均碰撞次数的度量，这也是 Paschen 定律的物理基础。\n\n需要注意的是，此分析假设截面 $\\sigma$ 与温度无关。实际上，$\\sigma$ 是相对碰撞能量的函数，因此也是气体温度的函数，即 $\\sigma = \\sigma(T)$。如果 $\\sigma$ 具有温度依赖性，则标度关系变为 $\\lambda \\propto \\frac{T}{\\sigma(T)}$，这可能偏离与 $T$ 的简单线性正比关系。例如，如果 $\\sigma$ 随 $T$ 增加，则 $\\lambda$ 随温度的增加将不如线性情况那样显著。",
            "answer": "$$\\boxed{0.02071}$$"
        },
        {
            "introduction": "掌握了平均自由程的概念后，我们便可以开始对引发击穿的核心机制——汤森雪崩——进行定量分析。本练习模拟了在磁约束聚变装置的极低压环境中，评估击穿是否可能发生的真实问题。通过构建一个简化的电子准弹道运动模型，你将推导关键的汤森第一电离系数的路径积分$ \\alpha d $，并利用完整的汤森击穿判据来检验自持放电条件能否被满足。这个过程将让你深刻理解在帕邢曲线左侧（低$ pd $值）区域，为何实现击穿是如此困难。",
            "id": "3696881",
            "problem": "考虑在磁约束核聚变装置中进行的一次预电离尝试，其中一个带偏压的诊断馈通在等离子体击穿前，在一个小的真空间隙上产生均匀电场。一对间距为 $d = 1.0 \\times 10^{-3}\\ \\mathrm{m}$ 的平板阴阳极浸入在压强为 $p = 1.0 \\times 10^{-3}\\ \\mathrm{Pa}$、温度为 $T = 300\\ \\mathrm{K}$ 的残余氘气中。在间隙两端施加 $V = 1.0 \\times 10^{3}\\ \\mathrm{V}$ 的电压，产生一个均匀电场。假设气体为氘分子，并按如下方式对电子碰撞电离进行建模：一个从阴极发射的电子初始动能可忽略不计，在运动过程中从电场获得能量，一旦其动能超过电离阈值 $\\varepsilon_{i} = 15.4\\ \\mathrm{eV}$，就能产生电离碰撞。对于电子能量 $\\varepsilon \\ge \\varepsilon_{i}$，取有效电离截面为常数 $\\sigma_{i} = 5.0 \\times 10^{-21}\\ \\mathrm{m}^{2}$；对于 $\\varepsilon  \\varepsilon_{i}$，取电离截面为零。电子进行准弹道式运动，中性粒子密度在空间上是均匀的。阴极的二次电子发射系数 (SEEC) 为 $\\gamma = 0.010$。\n\n仅从理想气体定律和均匀电场中带电粒子的基本动力学出发，推导整个间隙上空间积分的第一汤森电离系数 $\\alpha d$ 的表达式，并根据给定参数计算其值。然后，评估用 $\\alpha d$ 和 $\\gamma$ 表示的汤森击穿判据在这些条件下是否能够满足。你必须：\n\n1. 使用理想气体定律，根据 $p$ 和 $T$ 计算残余中性粒子数密度 $n$。\n2. 将电子动能建模为位置的函数，确定首次超过电离阈值的位置，并在运动学上允许电离的区域内对单位长度的电离概率进行积分，以获得 $\\alpha d$。\n3. 将你计算出的 $\\alpha d$ 与汤森击穿判据中涉及 $\\gamma$ 的表达式进行比较，并陈述其含义。\n\n将 $\\alpha d$ 的最终数值表示为一个无量纲数，并四舍五入至四位有效数字。在最终报告的值中不要包含任何单位。在你的推导中，在进行最终数值计算之前，保持物理常数为符号形式。象征性地使用玻尔兹曼常数 $k_{B}$，仅在最后需要时才代入其值。",
            "solution": "该问题要求计算低压氘气间隙中电子雪崩的空间积分第一汤森电离系数（记为 $\\alpha d$），并评估汤森击穿判据。解题过程按要求分为三部分执行。\n\n### 第1部分：中性气体密度的计算\n\n第一步是确定残余氘气的数密度 $n$。假设气体行为符合理想气体模型，我们可以使用理想气体定律的形式 $pV_{gas} = N k_B T$，其中 $p$是压强，$V_{gas}$是体积，$N$是粒子数，$k_B$是玻尔兹曼常数，$T$是绝对温度。数密度 $n$ 定义为 $n = N/V_{gas}$。\n\n根据理想气体定律，数密度由下式给出：\n$$n = \\frac{p}{k_B T}$$\n问题提供了以下数值：\n- 压强，$p = 1.0 \\times 10^{-3}\\ \\mathrm{Pa}$\n- 温度，$T = 300\\ \\mathrm{K}$\n- 玻尔兹曼常数，$k_B \\approx 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$\n\n代入这些值，我们计算出中性气体密度：\n$$n = \\frac{1.0 \\times 10^{-3}\\ \\mathrm{Pa}}{(1.380649 \\times 10^{-23}\\ \\mathrm{J/K})(300\\ \\mathrm{K})} \\approx 2.4143 \\times 10^{17}\\ \\mathrm{m}^{-3}$$\n假设此密度在整个间隙内是均匀的。\n\n### 第2部分：积分电离系数 $\\alpha d$ 的推导\n\n我们对一个从阴极位置 $x=0$ 发射、初始动能可忽略的电子的运动进行建模。阳极位于 $x=d$。间隙中存在一个均匀电场 $E$，其大小为 $E = V/d$。电子受到的力为 $F = eE$，方向从阴极指向阳极。\n\n当电子从阴极移动距离 $x$ 时，电场对其做的功为 $W(x) = Fx = (eE)x$。根据动能定理，这个功转化为动能 $\\varepsilon(x)$。\n$$\\varepsilon(x) = eEx = \\frac{eV}{d}x$$\n这种准弹道模型是合理的，因为电离平均自由程 $\\lambda_i = 1/(n\\sigma_i)$ 比间隙距离 $d$ 大几个数量级，表明碰撞非常不频繁。\n\n只有当电子的动能 $\\varepsilon(x)$ 超过电离阈值 $\\varepsilon_i = 15.4\\ \\mathrm{eV}$ 时，才会发生电离。设 $x_i$ 为电子首次达到该能量的位置：\n$$\\varepsilon(x_i) = \\varepsilon_i \\implies \\frac{eV}{d}x_i = \\varepsilon_i$$\n求解 $x_i$：\n$$x_i = \\frac{\\varepsilon_i d}{eV}$$\n这意味着只有在区域 $x_i \\le x \\le d$ 内才可能发生电离。\n\n第一汤森系数 $\\alpha(x)$ 表示一个原初电子每行进单位长度所产生的新电子（或离子-电子对）的数量。它由中性气体密度 $n$ 和电离截面 $\\sigma_i(\\varepsilon(x))$ 的乘积给出。\n$$\\alpha(x) = n \\sigma_i(\\varepsilon(x))$$\n问题为截面指定了一个简化的阶跃函数模型：\n$$\n\\sigma_i(\\varepsilon) =\n\\begin{cases}\n0   \\text{for } \\varepsilon  \\varepsilon_i \\\\\n\\sigma_{const}   \\text{for } \\varepsilon \\ge \\varepsilon_i\n\\end{cases}\n$$\n其中 $\\sigma_{const} = 5.0 \\times 10^{-21}\\ \\mathrm{m}^2$。用位置 $x$ 表示，这变为：\n$$\n\\sigma_i(x) =\n\\begin{cases}\n0   \\text{for } x  x_i \\\\\n\\sigma_{const}   \\text{for } x \\ge x_i\n\\end{cases}\n$$\n问题要求计算“空间积分的第一汤森电离系数 $\\alpha d$”。这个量代表单个原初电子从 $x=0$ 穿过整个间隙到 $x=d$ 时产生的电离总数。我们通过对 $\\alpha(x)$ 在间隙距离上积分来计算它：\n$$\\text{Total Ionizations} = \\int_{0}^{d} \\alpha(x) dx = \\int_{0}^{d} n \\sigma_i(x) dx$$\n我们将此积分记为 $(\\alpha d)_{eff}$，以区别于常数 $\\alpha$ 与 $d$ 的乘积。然而，遵循问题的符号表示，我们将其称为 $\\alpha d$。\n$$\\alpha d = \\int_{0}^{x_i} n \\sigma_i(x) dx + \\int_{x_i}^{d} n \\sigma_i(x) dx$$\n使用 $\\sigma_i(x)$ 的阶跃函数，第一个积分为零：\n$$\\alpha d = 0 + \\int_{x_i}^{d} n \\sigma_{const} dx$$\n由于 $n$ 和 $\\sigma_{const}$ 是常数，我们可以将它们移出积分：\n$$\\alpha d = n \\sigma_{const} \\int_{x_i}^{d} dx = n \\sigma_{const} (d - x_i)$$\n代入 $x_i$ 的表达式：\n$$\\alpha d = n \\sigma_{const} \\left(d - \\frac{\\varepsilon_i d}{eV}\\right) = n \\sigma_{const} d \\left(1 - \\frac{\\varepsilon_i}{eV}\\right)$$\n这就是积分电离系数的最终符号表达式。项 $\\varepsilon_i/(eV)$ 代表电离阈值能量与电子在间隙中可能获得的最大能量之比。\n\n### 第3部分：数值计算与击穿评估\n\n我们现在将给定的数值代入推导出的 $\\alpha d$ 表达式中。\n- $n \\approx 2.4143 \\times 10^{17}\\ \\mathrm{m}^{-3}$\n- $\\sigma_{const} = 5.0 \\times 10^{-21}\\ \\mathrm{m}^2$\n- $d = 1.0 \\times 10^{-3}\\ \\mathrm{m}$\n- $\\varepsilon_i = 15.4\\ \\mathrm{eV}$\n- $V = 1.0 \\times 10^3\\ \\mathrm{V}$，这意味着最大能量增益为 $eV = 1.0 \\times 10^3\\ \\mathrm{eV}$。\n\n比率 $\\varepsilon_i/(eV)$ 是无量纲的：\n$$\\frac{\\varepsilon_i}{eV} = \\frac{15.4\\ \\mathrm{eV}}{1000\\ \\mathrm{eV}} = 0.0154$$\n现在，我们计算 $\\alpha d$：\n$$\\alpha d = (2.4143 \\times 10^{17}\\ \\mathrm{m}^{-3})(5.0 \\times 10^{-21}\\ \\mathrm{m}^2)(1.0 \\times 10^{-3}\\ \\mathrm{m})(1 - 0.0154)$$\n$$\\alpha d = (1.20715 \\times 10^{-6})(0.9846)$$\n$$\\alpha d \\approx 1.1884 \\times 10^{-6}$$\n按要求四舍五入到四位有效数字，$\\alpha d = 1.188 \\times 10^{-6}$。\n\n最后，我们评估汤森击穿判据，该判据描述了自持放电的条件：\n$$\\gamma (\\exp(\\alpha d) - 1) \\ge 1$$\n此处，$\\gamma$ 是二次电子发射系数，给定为 $\\gamma = 0.010$。项 $\\exp(\\alpha d) - 1$ 代表由初始电子产生的离子-电子对的数量。\n由于计算出的 $\\alpha d \\approx 1.188 \\times 10^{-6}$ 非常小（$\\alpha d \\ll 1$），我们可以对 $x \\ll 1$ 使用一阶泰勒近似 $\\exp(x) \\approx 1 + x$。因此，$\\exp(\\alpha d) - 1 \\approx \\alpha d$。\n击穿判据简化为：\n$$\\gamma (\\alpha d) \\ge 1$$\n让我们用我们的数值计算左侧的值：\n$$\\gamma (\\alpha d) \\approx (0.010)(1.188 \\times 10^{-6}) = 1.188 \\times 10^{-8}$$\n结果是：\n$$1.188 \\times 10^{-8} \\ll 1$$\n自持汤森放电的条件未被满足。产生的二次电子数量太少，少了许多个数量级，无法维持放电。这意味着，在指定的极低压强和小间隙条件下，不会发生汤森击穿。这与工作点 $(p, d)$ 在氘气的帕邢曲线上位于帕邢最小值左侧很远的位置是一致的。",
            "answer": "$$\\boxed{1.188 \\times 10^{-6}}$$"
        },
        {
            "introduction": "前面的练习建立在理想化的均匀环境中，然而在真实的聚变装置中，气体压力和电场分布往往是不均匀的。本练习是一个综合性的计算实践，旨在让你直面这一复杂性，并揭示其对击穿电压预测的深刻影响。你将通过编写程序来对比两种模型：一种是精确地沿路径积分局部变化的电离系数，另一种则是采用“全局平均”参数的简化模型。这个对比将清晰地展示，由于电离过程的高度非线性，对参数进行简单平均会导致预测偏差，从而强调了在解决实际工程问题时，理解和处理非均匀性的重要性。",
            "id": "3696903",
            "problem": "考虑在核聚变真空室内对氘气进行一维预充，该过程被建模为长度为 $d$、施加电压为 $V$ 的平行板电极间隙，且在击穿前空间电荷可忽略不计。在这些假设下，击穿前的轴向电场 $\\mathcal{E}(z)$ 会通过一个随空间变化的场增强因子 $\\beta(z)$ 而被局部微观几何结构所修正，因此 $\\mathcal{E}(z) = \\beta(z) \\, V / d$。沿间隙的气体压力是非均匀的，由空间分布 $p(z)$ 给出。假设电子雪崩遵循汤森模型，其第一汤森电离系数 $\\alpha(z)$ 服从经过充分检验的经验标度关系 $\\alpha(z) = A \\, p(z) \\, \\exp\\!\\left(-B \\, \\frac{p(z)}{\\mathcal{E}(z)}\\right)$，其中 $A$ 和 $B$ 是室温下氘气的相关常数。汤森击穿判据指出，当路径积分电离等于等效二次发射阈值时，发生击穿，即\n$$\n\\int_{0}^{d} \\alpha(z) \\, \\mathrm{d}z \\;=\\; \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right),\n$$\n其中 $\\gamma$ 是阴极的等效二次电子发射系数。在 $p(z)$ 和 $\\beta(z)$ 非均匀的情况下，可以定义局部等效路径长度为 $d_{\\mathrm{eff}}(z) = d / \\beta(z)$，因此局部折合场强由 $\\mathcal{E}(z) = V / d_{\\mathrm{eff}}(z)$ 设定，且局部乘积 $p(z) \\, d_{\\mathrm{eff}}(z)$ 沿间隙变化。一个受均匀帕邢框架启发的常见全局期望通过使用平均得到的均匀有效参数来评估击穿，具体为 $p_{\\mathrm{avg}} = \\frac{1}{d} \\int_{0}^{d} p(z) \\, \\mathrm{d}z$ 和 $d_{\\mathrm{eff,avg}} = \\frac{1}{d} \\int_{0}^{d} d_{\\mathrm{eff}}(z) \\, \\mathrm{d}z = \\frac{1}{d} \\int_{0}^{d} \\frac{d}{\\beta(z)} \\, \\mathrm{d}z$。这种全局期望将空间变异性压缩为单个 $p_{\\mathrm{avg}} d_{\\mathrm{eff,avg}}$，并通过求解相同的汤森击穿判据来预测击穿电压，但其中 $p(z) \\equiv p_{\\mathrm{avg}}$ 且 $\\beta(z) \\equiv \\beta_{\\mathrm{avg}}$（等效于 $d_{\\mathrm{eff}}(z) \\equiv d_{\\mathrm{eff,avg}}$）。\n\n仅从上述基本陈述出发，您必须：\n- 推导 $p(z)$ 和 $\\beta(z)$ 的空间变异性如何通过 $\\alpha(z)$ 的积分进入击穿判据，以及使用全局平均值如何产生与积分局部物理量不同的预测。\n- 实现一个完整的、可运行的程序，该程序：\n  1. 定义压力分布 $p(z) = p_0 \\left[1 + \\epsilon \\cos\\!\\left(\\pi z / d\\right)\\right]$ 和场增强 $\\beta(z) = 1 + k \\, \\exp\\!\\left( -\\frac{(z - z_0)^2}{2 \\sigma^2} \\right)$。\n  2. 沿间隙 $z \\in [0, d]$ 使用汤森系数 $\\alpha(z) = A \\, p(z) \\, \\exp\\!\\left( -B \\, \\frac{p(z) \\, d}{\\beta(z) \\, V} \\right)$。\n  3. 通过数值求解积分方程 $\\int_{0}^{d} \\alpha(z) \\, \\mathrm{d}z = \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right)$，并使用给定的 $p(z)$ 和 $\\beta(z)$ 来计算实际击穿电压 $V_{\\mathrm{actual}}$。\n  4. 通过求解相同的击穿判据，但使用均匀的 $p(z) \\equiv p_{\\mathrm{avg}}$ 和均匀的 $\\beta(z) \\equiv \\beta_{\\mathrm{avg}} = \\frac{1}{d} \\int_{0}^{d} \\beta(z) \\, \\mathrm{d}z$（即将间隙视为具有平均等效路径长度的均匀间隙），来计算全局帕邢期望击穿电压 $V_{\\mathrm{global}}$。\n  5. 对每个测试用例，返回三个浮点数：$V_{\\mathrm{actual}}$（单位：伏特），$V_{\\mathrm{global}}$（单位：伏特），以及畸变因子 $\\rho = V_{\\mathrm{actual}} / V_{\\mathrm{global}}$。\n\n使用以下常数和单位：\n- $A = 1.0$，单位为 $\\mathrm{(Pa \\cdot m)^{-1}}$。\n- $B = 200.0$，单位为 $\\mathrm{V \\cdot m^{-1} \\cdot Pa^{-1}}$。\n- 电压必须以 $\\mathrm{V}$（伏特）表示。\n- 畸变因子 $\\rho$ 是无量纲的。\n- 所有打印的浮点数四舍五入到六位小数。\n\n您必须实现一个稳健的数值方法，通过对函数\n$$\nF(V) \\;=\\; \\int_{0}^{d} \\alpha(z;V) \\, \\mathrm{d}z \\;-\\; \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right)\n$$\n应用区间求根算法来求解 $V$。$V$ 的搜索范围应在一个物理上合理的区间内，以使 $F(V)$ 穿过零点。积分的计算应具有足够的精度以确保收敛。\n\n测试套件：\n- 用例 $1$（正常情况，均匀介质）：$p_0 = 500$ $\\mathrm{Pa}$，$d = 0.01$ $\\mathrm{m}$，$\\epsilon = 0$，$k = 0$，$\\gamma = 0.05$，$z_0 = 0.002$ $\\mathrm{m}$，$\\sigma = 0.002$ $\\mathrm{m}$。\n- 用例 $2$（仅压力非均匀）：$p_0 = 500$ $\\mathrm{Pa}$，$d = 0.01$ $\\mathrm{m}$，$\\epsilon = 0.4$，$k = 0$，$\\gamma = 0.05$，$z_0 = 0.002$ $\\mathrm{m}$，$\\sigma = 0.002$ $\\mathrm{m}$。\n- 用例 $3$（压力非均匀且在阴极附近有局部场增强）：$p_0 = 500$ $\\mathrm{Pa}$，$d = 0.01$ $\\mathrm{m}$，$\\epsilon = 0.4$，$k = 0.5$，$\\gamma = 0.05$，$z_0 = 0.001$ $\\mathrm{m}$，$\\sigma = 0.0015$ $\\mathrm{m}$。\n- 用例 $4$（强非均匀性和更强增强，边界压力测试）：$p_0 = 500$ $\\mathrm{Pa}$，$d = 0.01$ $\\mathrm{m}$，$\\epsilon = 0.9$，$k = 0.9$，$\\gamma = 0.02$，$z_0 = 0.0005$ $\\mathrm{m}$，$\\sigma = 0.001$ $\\mathrm{m}$。\n\n对于每个用例，您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起，结果顺序为 $[V_{\\mathrm{actual,1}}, V_{\\mathrm{global,1}}, \\rho_1, V_{\\mathrm{actual,2}}, V_{\\mathrm{global,2}}, \\rho_2, V_{\\mathrm{actual,3}}, V_{\\mathrm{global,3}}, \\rho_3, V_{\\mathrm{actual,4}}, V_{\\mathrm{global,4}}, \\rho_4]$，所有电压单位为 $\\mathrm{V}$，所有浮点数四舍五入到六位小数。",
            "solution": "该问题要求分析非均匀条件下氘气的电击穿过程，并比较详细的“局部物理”模型与简化的“全局平均”模型。这既涉及理论推导，也涉及数值实现。\n\n### 理论推导与基于原理的算法设计\n\n问题的基础是气体电击穿的汤森理论。该理论的核心是击穿判据，它指出当电子雪崩在沿路径电离产生的新电子数等于每次初始电离碰撞产生的二次电子数的倒数时，雪崩变得自持并导致击穿。其数学表达式为：\n$$\n\\int_{0}^{d} \\alpha(z) \\, \\mathrm{d}z = \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right)\n$$\n其中 $\\alpha(z)$ 是第一汤森电离系数（单位长度的电离次数），$d$ 是间隙距离，$\\gamma$ 是二次电子发射系数。\n\n第一汤森系数 $\\alpha$ 不是一个基本常数，而是强烈依赖于局部条件，特别是气体类型、压力 $p$ 和电场强度 $\\mathcal{E}$。问题给出了标准的经验形式：\n$$\n\\alpha(z) = A \\, p(z) \\, \\exp\\!\\left(-B \\, \\frac{p(z)}{\\mathcal{E}(z)}\\right)\n$$\n这里，$A$ 和 $B$ 是氘气的经验常数。空间依赖性 $p(z)$ 和 $\\mathcal{E}(z)$ 是这个问题的关键特征。\n\n**1. “实际”模型：积分局部物理量**\n\n在现实场景中，气体压力和电场都可能是非均匀的。\n压力分布由 $p(z) = p_0 \\left[1 + \\epsilon \\cos\\!\\left(\\pi z / d\\right)\\right]$ 给出。\n电场被局部微观几何结构修正，由场增强因子 $\\beta(z)$ 捕捉，使得 $\\mathcal{E}(z) = \\beta(z) V/d$。具体形式为 $\\beta(z) = 1 + k \\, \\exp\\!\\left( -\\frac{(z - z_0)^2}{2 \\sigma^2} \\right)$。\n\n将这些代入 $\\alpha(z)$ 的表达式，得到其完整的空间和电压依赖关系：\n$$\n\\alpha(z; V) = A \\, p(z) \\, \\exp\\!\\left(-B \\, \\frac{p(z) d}{\\beta(z) V}\\right)\n$$\n实际击穿电压 $V_{\\mathrm{actual}}$ 是满足使用此完整 $\\alpha(z;V)$ 表达式的积分击穿判据的 $V$ 值：\n$$\n\\int_{0}^{d} A \\, p_0 \\left[1 + \\epsilon \\cos\\!\\left(\\frac{\\pi z}{d}\\right)\\right] \\exp\\!\\left(-B \\frac{p_0 \\left[1 + \\epsilon \\cos\\!\\left(\\frac{\\pi z}{d}\\right)\\right] d}{\\left(1 + k e^{-\\frac{(z-z_0)^2}{2\\sigma^2}}\\right) V_{\\mathrm{actual}}}\\right) \\, \\mathrm{d}z = \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right)\n$$\n这个方程是关于 $V_{\\mathrm{actual}}$ 的一个隐式方程。由于其复杂性，左侧的积分无法解析求解。因此，需要采用数值方法。\n\n**$V_{\\mathrm{actual}}$ 的算法设计**：\n问题被重新表述为寻找函数 $F(V) = \\int_{0}^{d} \\alpha(z; V) \\, \\mathrm{d}z - \\ln(1 + 1/\\gamma)$ 的根。\n- **数值积分**：对于任何给定的电压 $V$，将使用稳健的数值求积方法计算积分。`scipy.integrate.quad` 是一个极佳的选择，因为它对于良态被积函数是自适应且准确的。\n- **求根**：函数 $F(V)$ 随 $V$ 单调递增。这保证了如果根存在，则根是唯一的。如问题所述，区间法对于此类函数是理想的。`scipy.optimize.brentq` 是一个高度可靠且高效的区间求根器。我们必须为其提供一个电压区间 $[V_{\\mathrm{low}}, V_{\\mathrm{high}}]$，其中 $F(V_{\\mathrm{low}})$ 和 $F(V_{\\mathrm{high}})$ 符号相反。当 $V \\to 0$ 时，$\\alpha \\to 0$，所以 $F(V)  0$。对于大的 $V$，$\\alpha$ 接近 $A p(z)$，积分项将超过常数 $\\ln(1+1/\\gamma)$，使得 $F(V)  0$。一个物理上合理的区间，如 $[1, 10^6]$ 伏特，是绰绰有余的。\n\n**2. “全局”模型：先平均后评估**\n\n这个简化模型旨在通过用其平均值替换空间变化的函数，来使用经典的均匀场帕邢定律框架。\n平均压力为 $p_{\\mathrm{avg}} = \\frac{1}{d} \\int_{0}^{d} p(z) \\, \\mathrm{d}z$。对于给定的 $p(z)$，该积分的计算结果为 $p_{\\mathrm{avg}} = p_0$。\n平均场增强为 $\\beta_{\\mathrm{avg}} = \\frac{1}{d} \\int_{0}^{d} \\beta(z) \\, \\mathrm{d}z$。\n\n使用这些平均值，系统被视为均匀的，具有一个恒定的汤森系数 $\\alpha_{\\mathrm{global}}$：\n$$\n\\alpha_{\\mathrm{global}}(V) = A \\, p_{\\mathrm{avg}} \\, \\exp\\!\\left(-B \\, \\frac{p_{\\mathrm{avg}} d}{\\beta_{\\mathrm{avg}} V}\\right)\n$$\n击穿判据简化为 $\\alpha_{\\mathrm{global}}(V) \\cdot d = \\ln(1 + 1/\\gamma)$。代入并求解电压，得到 $V_{\\mathrm{global}}$ 的显式公式：\n$$\nV_{\\mathrm{global}} = \\frac{B \\, p_{\\mathrm{avg}} \\, d}{\\beta_{\\mathrm{avg}} \\, \\ln\\left(\\frac{A \\, p_{\\mathrm{avg}} \\, d}{\\ln(1 + 1/\\gamma)}\\right)}\n$$\n\n**$V_{\\mathrm{global}}$ 的算法设计**：\n- **平均值计算**：虽然 $p_{\\mathrm{avg}}$ 是解析的，但 $\\beta_{\\mathrm{avg}}$ 需要对一个类高斯函数进行积分。为了保持一致性和稳健性，最好使用 `scipy.integrate.quad` 进行数值计算。\n- **直接计算**：一旦知道了 $p_{\\mathrm{avg}}$ 和 $\\beta_{\\mathrm{avg}}$，就可以使用推导出的公式直接计算 $V_{\\mathrm{global}}$。\n\n**3. 差异：非线性与平均**\n\n$V_{\\mathrm{actual}}$ 和 $V_{\\mathrm{global}}$ 之间的差异源于电离系数 $\\alpha$ 与物理参数 $p$ 和 $\\beta$ 之间的高度非线性关系。对于任何非线性函数 $f(x)$，函数的平均值通常不等于平均值的函数：$\\langle f(x) \\rangle \\neq f(\\langle x \\rangle)$。\n“实际”模型正确地计算了电离系数的平均值，$\\langle \\alpha \\rangle = \\frac{1}{d} \\int \\alpha(p(z), \\beta(z)) dz$。“全局”模型则错误地通过在平均值处计算系数来近似此值，即 $\\alpha(\\langle p \\rangle, \\langle \\beta \\rangle)$。由于指数项的存在，比率 $p(z)/\\beta(z)$ 局部较小的区域对总电离的贡献不成比例地大。平均过程平滑了这些关键区域，导致了不同的、通常不太准确的预测。畸变因子 $\\rho = V_{\\mathrm{actual}} / V_{\\mathrm{global}}$ 量化了这种差异。\n\n因此，实现将包含一个遍历测试用例的主循环。在每次迭代中，它将首先计算平均值和 $V_{\\mathrm{global}}$，然后设置数值积分和求根过程来求解 $V_{\\mathrm{actual}}$，最后计算比率 $\\rho$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Solves for the actual and globally-averaged breakdown voltages for a series of test cases.\n    \"\"\"\n    # Define physical constants\n    A = 1.0  # Unit: (Pa * m)^-1\n    B = 200.0  # Unit: V * m^-1 * Pa^-1\n\n    # Define the test cases from the problem statement.\n    # Format: (p0, d, epsilon, k, gamma, z0, sigma)\n    test_cases = [\n        # Case 1 (happy path, uniform medium)\n        (500.0, 0.01, 0.0, 0.0, 0.05, 0.002, 0.002),\n        # Case 2 (pressure nonuniformity only)\n        (500.0, 0.01, 0.4, 0.0, 0.05, 0.002, 0.002),\n        # Case 3 (pressure nonuniformity with localized field enhancement)\n        (500.0, 0.01, 0.4, 0.5, 0.05, 0.001, 0.0015),\n        # Case 4 (strong nonuniformity and stronger enhancement, boundary stress test)\n        (500.0, 0.01, 0.9, 0.9, 0.02, 0.0005, 0.001),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p0, d, epsilon, k, gamma, z0, sigma = case\n\n        # Define spatially varying functions for pressure and field enhancement\n        p_func = lambda z: p0 * (1.0 + epsilon * np.cos(np.pi * z / d))\n        beta_func = lambda z: 1.0 + k * np.exp(-((z - z0)**2) / (2.0 * sigma**2))\n\n        # --- 1. Global Paschen Expectation Calculation ---\n\n        # The average pressure over the gap is analytically p0\n        p_avg = p0\n        \n        # The average field enhancement requires numerical integration\n        beta_avg_integral, _ = integrate.quad(beta_func, 0, d)\n        beta_avg = beta_avg_integral / d\n\n        # The right-hand side of the breakdown criterion is constant\n        gamma_term = np.log(1.0 + 1.0 / gamma)\n\n        # Calculate V_global using the derived analytical formula\n        # This formula is derived from alpha_global * d = gamma_term\n        log_argument = (A * p_avg * d) / gamma_term\n        \n        # Breakdown is only possible if log_argument > 1\n        if log_argument = 1.0:\n            V_global = np.inf\n        else:\n            V_global = (B * p_avg * d) / (beta_avg * np.log(log_argument))\n\n        # --- 2. Actual Breakdown Voltage Calculation ---\n\n        # Define the integrand for the integral breakdown criterion\n        # alpha(z;V) = A * p(z) * exp(-B * p(z) * d / (beta(z) * V))\n        alpha_integrand = lambda z, V: A * p_func(z) * np.exp(-B * p_func(z) * d / (beta_func(z) * V))\n\n        # Define the function F(V) whose root is the breakdown voltage\n        # F(V) = integral(alpha(z;V), 0, d) - gamma_term\n        def F(V):\n            if V = 0:\n                # Physically, voltage must be positive. Integral is zero, so F is negative.\n                return -gamma_term\n            integral_val, _ = integrate.quad(alpha_integrand, 0, d, args=(V,), limit=100)\n            return integral_val - gamma_term\n\n        # Find the root V_actual using a bracketing root-finder (Brent's method)\n        # The bracket [1, 1e6] is chosen as a safe range for these problems.\n        # F(V->0)  0 and F(V->inf) > 0, so a root exists and is bracketed.\n        try:\n            V_actual = optimize.brentq(F, 1.0, 1e6)\n        except ValueError:\n            # Should not happen with the chosen wide bracket\n            V_actual = np.nan\n\n        # --- 3. Compute Distortion Factor ---\n        if np.isfinite(V_global) and V_global != 0:\n            rho = V_actual / V_global\n        else:\n            rho = np.nan\n        \n        results.extend([V_actual, V_global, rho])\n\n    # Format the results for printing as specified\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}