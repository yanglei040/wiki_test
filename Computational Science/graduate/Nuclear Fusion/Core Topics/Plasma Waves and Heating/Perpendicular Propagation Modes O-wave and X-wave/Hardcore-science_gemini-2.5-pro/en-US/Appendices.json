{
    "hands_on_practices": [
        {
            "introduction": "Understanding wave propagation in magnetized plasma begins with a firm grasp of its fundamental modes. This exercise guides you through the essential derivation of the dispersion relations for waves traveling perpendicular to the magnetic field. By starting from the wave equation and the cold-plasma dielectric tensor, you will mathematically uncover how the plasma's anisotropic response splits the wave into the Ordinary (O-mode) and Extraordinary (X-mode), each with a unique polarization and refractive index. Mastering this derivation is a cornerstone for analyzing virtually all high-frequency wave phenomena in fusion plasmas .",
            "id": "3712630",
            "problem": "Consider a uniform, collisionless, cold magnetized plasma representative of a magnetic-confinement nuclear fusion device, composed of electrons and a single ion species. The static magnetic field is $\\boldsymbol{B}_{0} = B_{0}\\,\\hat{\\boldsymbol{z}}$. A monochromatic plane wave of angular frequency $\\omega$ propagates perpendicular to $\\boldsymbol{B}_{0}$ with wavevector $\\boldsymbol{k} = k\\,\\hat{\\boldsymbol{x}}$. Let the refractive index be $n \\equiv c k/\\omega$. In the cold-plasma approximation, the electromagnetic wave equation in Fourier space can be written as\n$$\n\\boldsymbol{k} \\times \\left( \\boldsymbol{k} \\times \\boldsymbol{E} \\right) + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{\\varepsilon}$ is the cold-plasma dielectric tensor. In the Stix parameterization, for $\\boldsymbol{B}_{0} \\parallel \\hat{\\boldsymbol{z}}$, the dielectric tensor is\n$$\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\nS  -\\,i D  0 \\\\\ni D  S  0 \\\\\n0  0  P\n\\end{pmatrix},\n$$\nwith the Stix parameters defined by\n$$\nS \\equiv 1 - \\sum_{s}\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}}, \\quad\nD \\equiv \\sum_{s}\\frac{\\Omega_{s}}{\\omega}\\,\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}}, \\quad\nP \\equiv 1 - \\sum_{s}\\frac{\\omega_{ps}^{2}}{\\omega^{2}},\n$$\nwhere the sum is over plasma species $s$ (electrons and ions), $\\omega_{ps}^{2} \\equiv n_{s} q_{s}^{2}/(\\varepsilon_{0} m_{s})$ is the species plasma frequency, and $\\Omega_{s} \\equiv q_{s} B_{0}/m_{s}$ is the species cyclotron frequency.\n\nStarting only from the plane-wave Maxwell equations and the above cold-plasma tensor structure, derive the dispersion relations for perpendicular propagation modes. Identify the two decoupled polarizations (ordinary mode and extraordinary mode) and obtain the closed-form expressions for the squared refractive index $n^{2}$ for each mode, expressed only in terms of the Stix parameters $S$, $D$, and $P$ (do not introduce additional parameters in the final expressions).\n\nYour final answer must be the analytical expressions for $n^{2}$ for the ordinary mode and the extraordinary mode, respectively. No numerical evaluation is required.",
            "solution": "The starting point for this derivation is the wave equation for an electromagnetic wave in a medium, given in Fourier space as:\n$$\n\\boldsymbol{k} \\times \\left( \\boldsymbol{k} \\times \\boldsymbol{E} \\right) + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\nHere, $\\boldsymbol{k}$ is the wavevector, $\\boldsymbol{E}$ is the electric field vector, $\\omega$ is the angular frequency, $c$ is the speed of light in vacuum, and $\\boldsymbol{\\varepsilon}$ is the dielectric tensor of the plasma.\n\nWe can expand the double cross product using the vector identity $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = (\\boldsymbol{A} \\cdot \\boldsymbol{C})\\boldsymbol{B} - (\\boldsymbol{A} \\cdot \\boldsymbol{B})\\boldsymbol{C}$. Setting $\\boldsymbol{A} = \\boldsymbol{k}$, $\\boldsymbol{B} = \\boldsymbol{k}$, and $\\boldsymbol{C} = \\boldsymbol{E}$, the wave equation becomes:\n$$\n(\\boldsymbol{k} \\cdot \\boldsymbol{E})\\boldsymbol{k} - (\\boldsymbol{k} \\cdot \\boldsymbol{k})\\boldsymbol{E} + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\nThe problem specifies perpendicular propagation, with the static magnetic field $\\boldsymbol{B}_{0} = B_{0}\\,\\hat{\\boldsymbol{z}}$ and the wavevector $\\boldsymbol{k} = k\\,\\hat{\\boldsymbol{x}}$. Therefore, we have $\\boldsymbol{k} \\cdot \\boldsymbol{k} = k^{2}$ and $\\boldsymbol{k} \\cdot \\boldsymbol{E} = k E_{x}$. Substituting these into the wave equation yields:\n$$\n(k E_{x}) (k \\hat{\\boldsymbol{x}}) - k^{2}\\boldsymbol{E} + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\nWe introduce the refractive index $n$, defined by $n^{2} \\equiv c^{2}k^{2}/\\omega^{2}$. Multiplying the entire equation by $c^{2}/\\omega^{2}$ gives:\n$$\n\\frac{c^{2}}{\\omega^{2}} k^{2} E_{x} \\hat{\\boldsymbol{x}} - \\frac{c^{2}k^{2}}{\\omega^{2}}\\boldsymbol{E} + \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n$$\nn^{2} E_{x} \\hat{\\boldsymbol{x}} - n^{2}\\boldsymbol{E} + \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\nThis vector equation can be expressed in matrix form. The term $n^{2} E_{x} \\hat{\\boldsymbol{x}}$ can be written as $n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) \\cdot \\boldsymbol{E}$, where $\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}$ is a dyadic product represented by a matrix with a $1$ in the $(1,1)$ position and zeros elsewhere. The term $n^{2}\\boldsymbol{E}$ corresponds to $n^{2}\\boldsymbol{I} \\cdot \\boldsymbol{E}$, where $\\boldsymbol{I}$ is the identity matrix. The equation becomes:\n$$\n\\left[ \\boldsymbol{\\varepsilon} - n^{2}\\boldsymbol{I} + n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) \\right] \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\nLet's construct the matrix within the brackets. We are given the dielectric tensor in the Stix parameterization:\n$$\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\nS  -i D  0 \\\\\ni D  S  0 \\\\\n0  0  P\n\\end{pmatrix}\n$$\nThe other matrices are:\n$$\nn^{2}\\boldsymbol{I} = \\begin{pmatrix} n^{2}  0  0 \\\\ 0  n^{2}  0 \\\\ 0  0  n^{2} \\end{pmatrix}, \\quad n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) = \\begin{pmatrix} n^{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nCombining these terms, the matrix in the wave equation, let's call it $\\boldsymbol{M}$, is:\n$$\n\\boldsymbol{M} = \\begin{pmatrix} S  -i D  0 \\\\ i D  S  0 \\\\ 0  0  P \\end{pmatrix} - \\begin{pmatrix} n^{2}  0  0 \\\\ 0  n^{2}  0 \\\\ 0  0  n^{2} \\end{pmatrix} + \\begin{pmatrix} n^{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} S  -i D  0 \\\\ i D  S-n^{2}  0 \\\\ 0  0  P-n^{2} \\end{pmatrix}\n$$\nThe homogeneous system of linear equations $\\boldsymbol{M} \\cdot \\boldsymbol{E} = \\boldsymbol{0}$ has a non-trivial solution for the electric field $\\boldsymbol{E}$ if and only if the determinant of the matrix $\\boldsymbol{M}$ is zero:\n$$\n\\det(\\boldsymbol{M}) = 0\n$$\n$$\n\\det \\begin{pmatrix} S  -i D  0 \\\\ i D  S-n^{2}  0 \\\\ 0  0  P-n^{2} \\end{pmatrix} = 0\n$$\nExpanding the determinant along the third row yields:\n$$\n(P - n^{2}) \\det \\begin{pmatrix} S  -i D \\\\ i D  S-n^{2} \\end{pmatrix} = 0\n$$\n$$\n(P - n^{2}) \\left[ S(S-n^{2}) - (-i D)(i D) \\right] = 0\n$$\n$$\n(P - n^{2}) (S^{2} - S n^{2} - D^{2}) = 0\n$$\nThis general dispersion relation for perpendicular propagation factors into two independent conditions, corresponding to two distinct wave modes.\n\nMode $1$: The first possibility is that the first factor is zero:\n$$\nP - n^{2} = 0 \\implies n^{2} = P\n$$\nTo understand the nature of this mode, we examine the polarization of the electric field by substituting $n^{2} = P$ back into the matrix equation $\\boldsymbol{M} \\cdot \\boldsymbol{E} = \\boldsymbol{0}$:\n$$\n\\begin{pmatrix} S  -i D  0 \\\\ i D  S-P  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} E_{x} \\\\ E_{y} \\\\ E_{z} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe third row implies $0 \\cdot E_{z} = 0$, which allows for a non-zero $E_{z}$. The upper $2 \\times 2$ block gives a system of equations for $E_{x}$ and $E_{y}$. The determinant of this sub-matrix is $S(S-P) - (-i D)(i D) = S(S-P) - D^{2}$. Assuming this is non-zero (which it generally is), the only solution for the subsystem is $E_{x} = 0$ and $E_{y} = 0$. Thus, the electric field vector for this mode is $\\boldsymbol{E} = (0, 0, E_{z})$, which is parallel to the background magnetic field $\\boldsymbol{B}_{0}$. This mode is, by definition, the **ordinary mode (O-mode)**. Its refractive index is determined solely by the Stix parameter $P$.\n\nMode $2$: The second possibility is that the second factor is zero:\n$$\nS^{2} - S n^{2} - D^{2} = 0\n$$\nSolving for $n^{2}$ gives:\n$$\nS n^{2} = S^{2} - D^{2} \\implies n^{2} = \\frac{S^{2} - D^{2}}{S}\n$$\nTo find the polarization, we again examine the matrix equation, assuming this mode is distinct from the first (i.e., $P-n^{2} \\neq 0$). The equation $(P-n^{2})E_{z} = 0$ now requires $E_{z}=0$. This means the electric field is confined to the plane perpendicular to $\\boldsymbol{B}_{0}$, so $\\boldsymbol{E} \\perp \\boldsymbol{B}_{0}$. The electric field vector is $\\boldsymbol{E} = (E_{x}, E_{y}, 0)$. The upper $2 \\times 2$ block of equations is:\n$$\nS E_{x} - i D E_{y} = 0\n$$\n$$\ni D E_{x} + (S-n^{2}) E_{y} = 0\n$$\nSince the determinant of this $2 \\times 2$ system is zero by the condition for this mode, the two equations are linearly dependent. We can use the first to find the polarization ratio relating the components of the electric field: $E_{y} = \\frac{S}{iD} E_{x} = -i \\frac{S}{D} E_{x}$. The electric field is elliptically polarized in the plane perpendicular to $\\boldsymbol{B}_0$. This mode is, by definition, the **extraordinary mode (X-mode)**. Its refractive index depends on the Stix parameters $S$ and $D$.\n\nIn summary, the two perpendicular propagation modes and their squared refractive indices are:\n$1$. Ordinary mode (O-mode):\n   $$ n^{2}_{\\text{O}} = P $$\n$2$. Extraordinary mode (X-mode):\n   $$ n^{2}_{\\text{X}} = \\frac{S^{2} - D^{2}}{S} $$\nThese are the requested closed-form expressions in terms of the Stix parameters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP  \\frac{S^{2} - D^{2}}{S}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having established the distinct properties of the O- and X-modes, a crucial practical question arises: how can we selectively launch one of these modes into a plasma? This problem explores the fundamental principle of polarization matching at the vacuum-plasma interface. While employing a simplified model for the mode polarizations at the boundary to clearly illustrate the core concept, this exercise demonstrates that the efficiency of power coupling is determined by the geometric alignment between the polarization of the incident wave and that of the desired plasma mode. This principle is vital for designing effective antennas for plasma heating and diagnostic systems .",
            "id": "324569",
            "problem": "In a reflectometry experiment, a microwave beam is launched from a vacuum region ($z0$) into a cold, uniform, magnetized plasma occupying the half-space $z \\ge 0$. The microwave beam propagates along the z-axis ($\\boldsymbol{k} = k\\hat{z}$). The static, uniform magnetic field $\\boldsymbol{B}_0$ is oriented perpendicular to the direction of propagation, lying entirely in the x-y plane at an angle $\\phi_B$ with respect to the x-axis.\n\nThe incident microwave beam is linearly polarized. Its electric field vector $\\boldsymbol{E}_{inc}$ also lies in the x-y plane, making an angle $\\alpha$ with the x-axis.\n\nAt the vacuum-plasma interface ($z=0$), the incident wave power is coupled into the two fundamental electromagnetic modes for perpendicular propagation: the Ordinary (O-mode) and the Extraordinary (X-mode). For this configuration:\n1.  The O-mode is linearly polarized with its electric field vector parallel to the background magnetic field $\\boldsymbol{B}_0$.\n2.  The X-mode is also linearly polarized at the interface, with its electric field vector perpendicular to both the background magnetic field $\\boldsymbol{B}_0$ and the direction of propagation $\\boldsymbol{k}$.\n\nAssuming conditions are such that the X-mode propagates into the plasma (i.e., the launch frequency is above the relevant cutoff frequency), derive an expression for the fraction of the incident wave power that is coupled into the X-mode. Express your answer in terms of the angles $\\alpha$ and $\\phi_B$.",
            "solution": "1. The incident electric field in the $xy$–plane at angle $\\alpha$ is  \n   $$\\boldsymbol{E}_{inc}=E_0(\\cos\\alpha\\,\\hat x+\\sin\\alpha\\,\\hat y)\\,. $$\n2. The background field unit vector at angle $\\phi_B$ is  \n   $$\\hat B_0=\\cos\\phi_B\\,\\hat x+\\sin\\phi_B\\,\\hat y\\,. $$\n3. For perpendicular propagation ($\\boldsymbol{k}=k\\hat z$) the X–mode polarization is  \n   $$\\hat e_X=\\frac{\\hat k\\times\\hat B_0}{|\\hat k\\times\\hat B_0|}\n             =\\frac{\\hat{z}\\times(\\cos\\phi_B\\,\\hat{x}+\\sin\\phi_B\\,\\hat{y})}\n                   {\\sqrt{\\cos^2\\phi_B+\\sin^2\\phi_B}}\n             =-\\,\\sin\\phi_B\\,\\hat x+\\cos\\phi_B\\,\\hat y\\,. $$\n4. Project $\\boldsymbol{E}_{inc}$ onto $\\hat e_X$:  \n   $$\\boldsymbol{E}_{inc}\\cdot\\hat e_X\n     =E_0\\bigl(-\\sin\\phi_B\\cos\\alpha+\\cos\\phi_B\\sin\\alpha\\bigr)\n     =E_0\\sin(\\alpha-\\phi_B)\\,. $$\n5. The fraction of power in the X–mode is the squared projection normalized by $E_0^2$:  \n   $$\\frac{P_X}{P_{inc}}\n     =\\frac{|\\boldsymbol{E}_{inc}\\cdot\\hat e_X|^2}{|\\boldsymbol{E}_{inc}|^2}\n     =\\sin^2(\\alpha-\\phi_B)\\,. $$",
            "answer": "$$\\boxed{\\sin^2(\\alpha-\\phi_B)}$$"
        },
        {
            "introduction": "The linear cold-plasma model provides an excellent foundation, but real-world applications, such as high-power electron cyclotron resonance heating (ECRH), often involve wave electric fields strong enough to modify the plasma's properties. This exercise moves beyond the basic model to explore such nonlinear interactions through a weakly relativistic correction, where the electron mass increases due to its high-speed quiver motion in the wave field. You will derive how this effective mass change alters the characteristic plasma frequencies and, consequently, the positions of cutoffs and resonances. This practice bridges the gap between idealized theory and the computational modeling required to understand and predict the behavior of high-power waves in fusion devices .",
            "id": "3712635",
            "problem": "Consider electromagnetic wave propagation perpendicular to a uniform, static magnetic field in a magnetized plasma relevant to nuclear fusion. Assume a homogeneous plasma with electrons and a single ion species (deuterium), characterized by number density $n_e = n_i$, charge $q_e = -e$, $q_i = +e$, electron rest mass $m_e$, ion mass $m_i = 2 m_p$, speed of light $c$, vacuum permittivity $\\varepsilon_0$, and uniform magnetic field magnitude $B_0$. The wave propagates with angular frequency $\\omega$ and has an electric field amplitude $E_0$.\n\nStarting from the fundamental base of Maxwell's equations and the cold-fluid model (linearized Lorentz force and continuity equations) for multiple species in a uniform magnetized plasma, do the following:\n\n- Derive the polarization and dielectric response for perpendicular propagation ($\\mathbf{k} \\perp \\mathbf{B}_0$). Introduce a weakly relativistic, high-power correction by treating the electron mass as an effective mass $m_e' = \\gamma m_e$ with a constant Lorentz factor $\\gamma$ due to quiver motion in the wave, where $\\gamma = \\sqrt{1 + a_0^2}$ and $a_0 = \\dfrac{|q_e| E_0}{m_e c \\, \\omega}$. Assume the ion mass remains nonrelativistic.\n- Using the cold plasma dielectric tensor, express the mode refractive indices for perpendicular propagation. Define the species plasma frequencies and cyclotron frequencies as\n$$\\omega_{ps}^2 = \\dfrac{n_s q_s^2}{\\varepsilon_0 m_s'}, \\quad \\Omega_s = \\dfrac{q_s B_0}{m_s'},$$\nwith $m_e' = \\gamma m_e$ for electrons and $m_i' = m_i$ for ions. Define the Stix parameters\n$$R = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)},$$\n$$S = \\dfrac{R + L}{2}, \\quad P = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega^2}.$$\nShow that the ordinary mode (O-wave) and extraordinary mode (X-wave) perpendicular propagation refractive indices $N^2 = \\dfrac{c^2 k^2}{\\omega^2}$ satisfy\n$$N_\\mathrm{O}^2 = P, \\quad N_\\mathrm{X}^2 = \\dfrac{R L}{S}.$$\nExplain physically how the high-power correction (through $\\gamma$) modifies the cutoffs and resonance positions via $m_e'$, hence shifting $\\omega_{pe}$ and $\\Omega_e$.\n\nYour program must implement these formulas and compute both $N_\\mathrm{O}^2$ and $N_\\mathrm{X}^2$ for a specified test suite. Use the International System of Units (SI) for all inputs. The outputs must be dimensionless and reported as floating-point numbers.\n\nTest suite parameter sets, each a tuple $(n_e, B_0, \\omega, E_0)$, are:\n\n1. General propagation case: $n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 1.10 \\times 10^{12} \\, \\mathrm{rad/s}$, $E_0 = 1.0 \\times 10^{6} \\, \\mathrm{V/m}$.\n2. Near ordinary-mode cutoff (electron-only nominal value; two-species cold-plasma model used in computation): $n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 3.984 \\times 10^{11} \\, \\mathrm{rad/s}$, $E_0 = 0 \\, \\mathrm{V/m}$.\n3. Near upper-hybrid resonance (avoid exact resonance): $n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 1.125 \\times 10^{12} \\, \\mathrm{rad/s}$, $E_0 = 0 \\, \\mathrm{V/m}$.\n4. Weakly relativistic amplitude case: $n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 1.20 \\times 10^{12} \\, \\mathrm{rad/s}$, $E_0 = 5.0 \\times 10^{6} \\, \\mathrm{V/m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the values ordered as\n$$[N_\\mathrm{O}^{2,(1)}, N_\\mathrm{X}^{2,(1)}, N_\\mathrm{O}^{2,(2)}, N_\\mathrm{X}^{2,(2)}, N_\\mathrm{O}^{2,(3)}, N_\\mathrm{X}^{2,(3)}, N_\\mathrm{O}^{2,(4)}, N_\\mathrm{X}^{2,(4)}],$$\nwhere the superscripts refer to the test case index. Report all outputs as dimensionless floats.",
            "solution": "The problem requires the derivation of the refractive indices for ordinary (O-wave) and extraordinary (X-wave) modes propagating perpendicular to a static magnetic field in a cold, magnetized plasma, including a weakly relativistic high-power correction. We will then implement these formulas to compute the refractive indices for a given set of parameters.\n\nThe analysis begins with the fundamental equations governing the system: Maxwell's equations and the linearized equation of motion for a cold plasma fluid.\n\nIn a source-free medium, Maxwell's curl equations are:\n$$\n\\nabla \\times \\mathbf{E} = - \\dfrac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\dfrac{\\partial \\mathbf{E}}{\\partial t}\n$$\nThe plasma consists of electrons (species $s=e$) and deuterium ions (species $s=i$). The response of each species to the electromagnetic fields is described by the linearized Lorentz force equation for a cold plasma (zero initial thermal velocity):\n$$\nm_s' \\frac{\\partial \\mathbf{v}_{s1}}{\\partial t} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times \\mathbf{B}_0)\n$$\nHere, $\\mathbf{v}_{s1}$ and $\\mathbf{E}_1$ are the first-order perturbed fluid velocity and electric field, respectively, and $\\mathbf{B}_0$ is the uniform, static background magnetic field. The mass $m_s'$ is the effective mass for each species. As specified, we include a high-power correction for electrons by setting their mass to $m_e' = \\gamma m_e$, where $\\gamma = \\sqrt{1 + a_0^2}$ and $a_0 = |q_e| E_0 / (m_e c \\omega)$. For ions, we assume the non-relativistic limit, so $m_i' = m_i$.\n\nWe assume all first-order quantities vary as plane waves of the form $e^{i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t)}$. This allows us to make the substitutions $\\partial/\\partial t \\to -i\\omega$ and $\\nabla \\to i\\mathbf{k}$. The equation of motion becomes:\n$$\n-i\\omega m_s' \\mathbf{v}_{s1} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times \\mathbf{B}_0)\n$$\nThis equation can be solved for the velocity perturbation $\\mathbf{v}_{s1}$ in terms of the electric field $\\mathbf{E}_1$. The total plasma current density is the sum of the contributions from each species: $\\mathbf{J}_1 = \\sum_s n_s q_s \\mathbf{v}_{s1}$. This defines the plasma conductivity tensor $\\boldsymbol{\\sigma}$ via the relation $\\mathbf{J}_1 = \\boldsymbol{\\sigma} \\cdot \\mathbf{E}_1$. The dielectric tensor $\\boldsymbol{\\epsilon}$ is then given by:\n$$\n\\boldsymbol{\\epsilon} = \\varepsilon_0 \\mathbf{I} + \\frac{i}{\\omega} \\boldsymbol{\\sigma}\n$$\nWithout loss of generality, let the static magnetic field be along the z-axis, $\\mathbf{B}_0 = B_0 \\hat{z}$. The dielectric tensor takes the form:\n$$\n\\boldsymbol{\\epsilon} = \\varepsilon_0 \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\nThe components $S$, $D$, and $P$ are expressed in terms of the plasma parameters. Conventionally, they are defined as $S = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}$, $D = \\sum_s \\frac{\\Omega_s \\omega_{ps}^2}{\\omega(\\omega^2 - \\Omega_s^2)}$, and $P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}$. The problem defines the Stix parameters $R$ and $L$ as:\n$$\nR = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)}\n$$\nwhere the species plasma frequency squared is $\\omega_{ps}^2 = n_s q_s^2 / (\\varepsilon_0 m_s')$ and the species cyclotron frequency is $\\Omega_s = q_s B_0 / m_s'$. The parameters are related by $S = (R+L)/2$ and $D = (R-L)/2$.\n\nNow, we formulate the wave equation. Substituting the plane wave forms into Maxwell's equations yields:\n$$\ni \\mathbf{k} \\times \\mathbf{E}_1 = i\\omega \\mathbf{B}_1\n$$\n$$\ni \\mathbf{k} \\times \\mathbf{B}_1 = \\mu_0 \\mathbf{J}_1 - i\\omega \\mu_0 \\varepsilon_0 \\mathbf{E}_1 = -i\\omega \\mu_0 \\left( \\frac{i}{\\omega} \\boldsymbol{\\sigma} + \\varepsilon_0 \\mathbf{I} \\right) \\cdot \\mathbf{E}_1 = -i\\frac{\\omega}{c^2 \\varepsilon_0} \\boldsymbol{\\epsilon} \\cdot \\mathbf{E}_1\n$$\nCombining these two equations gives the general wave equation:\n$$\n\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}_1) + \\frac{\\omega^2}{c^2} \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0} \\cdot \\mathbf{E}_1 = 0\n$$\nWe consider perpendicular propagation, so $\\mathbf{k} \\perp \\mathbf{B}_0$. We choose the coordinate system such that $\\mathbf{k} = k \\hat{x}$ and $\\mathbf{B}_0 = B_0 \\hat{z}$. The wave equation can be written in matrix form. Let $N = ck/\\omega$ be the refractive index. The tensor operator $\\mathbf{k} \\times (\\mathbf{k} \\times \\cdot)$ becomes $\\mathbf{k}(\\mathbf{k} \\cdot \\cdot) - k^2 \\mathbf{I}$. The wave equation is $(\\frac{\\omega^2}{c^2} \\mathbf{N}\\mathbf{N} - N^2 \\frac{\\omega^2}{c^2} \\mathbf{I} + \\frac{\\omega^2}{c^2} \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0}) \\cdot \\mathbf{E}_1 = 0$, which simplifies to:\n$$\n\\left( \\mathbf{N}\\mathbf{N} - N^2 \\mathbf{I} + \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0} \\right) \\cdot \\mathbf{E}_1 = 0\n$$\nWith $\\mathbf{k} = k \\hat{x}$, the tensor $\\mathbf{N}\\mathbf{N}$ has only one non-zero component, $N_x N_x = N^2$. The matrix equation becomes:\n$$\n\\begin{pmatrix} S  -iD  0 \\\\ iD  S - N^2  0 \\\\ 0  0  P - N^2 \\end{pmatrix}\n\\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = 0\n$$\nFor a non-trivial solution to exist, the determinant of the matrix must be zero:\n$$\n\\det \\begin{pmatrix} S  -iD  0 \\\\ iD  S - N^2  0 \\\\ 0  0  P - N^2 \\end{pmatrix} = (P - N^2) \\left[ S(S - N^2) - (-iD)(iD) \\right] = 0\n$$\n$$\n(P - N^2) [S(S - N^2) - D^2] = 0\n$$\nThis equation decouples into two independent modes:\n\n1.  **Ordinary Mode (O-wave):** The first solution is given by the first factor:\n    $$ P - N^2 = 0 \\implies N_\\mathrm{O}^2 = P $$\n    For this mode, the matrix equation implies that $E_x = E_y = 0$, while $E_z$ can be non-zero. The electric field of the wave is polarized parallel to the background magnetic field $\\mathbf{B}_0$. Consequently, the Lorentz force term $\\mathbf{v}_{s1} \\times \\mathbf{B}_0$ does not affect the electron motion along $\\mathbf{B}_0$, and the wave behaves as if it were in an unmagnetized plasma.\n\n2.  **Extraordinary Mode (X-wave):** The second solution is given by the second factor:\n    $$ S(S - N^2) - D^2 = 0 $$\n    $$ S N^2 = S^2 - D^2 = (S-D)(S+D) $$\n    Using the relations $R = S+D$ and $L = S-D$, we find:\n    $$ S N^2 = LR \\implies N_\\mathrm{X}^2 = \\frac{RL}{S} $$\n    For this mode, $E_z=0$, and the electric field is polarized in the plane perpendicular to $\\mathbf{B}_0$. This wave's propagation is strongly affected by the magnetic field.\n\n**Physical Effect of High-Power Correction:**\nThe relativistic mass correction $m_e' = \\gamma m_e$ directly modifies the electron plasma frequency and electron cyclotron frequency:\n$$\n\\omega_{pe}'^2 = \\frac{n_e e^2}{\\varepsilon_0 m_e'} = \\frac{1}{\\gamma} \\frac{n_e e^2}{\\varepsilon_0 m_e} = \\frac{\\omega_{pe}^2}{\\gamma}\n$$\n$$\n\\Omega_e' = \\frac{-e B_0}{m_e'} = \\frac{1}{\\gamma} \\frac{-e B_0}{m_e} = \\frac{\\Omega_e}{\\gamma}\n$$\nSince $\\gamma = \\sqrt{1 + a_0^2} \\ge 1$, the effective electron mass increases with wave power ($E_0^2$). This increased inertia causes the electrons to respond more sluggishly to the wave fields. As a result, both their natural plasma oscillation frequency ($\\omega_{pe}'$) and their gyration frequency in the magnetic field ($|\\Omega_e'|$) are reduced.\n\nCutoffs (where $N^2=0$) and resonances (where $N^2 \\to \\infty$) are critical features of wave propagation. They are determined by the characteristic frequencies $\\omega_{pe}'$ and $\\Omega_e'$.\n-   **O-mode cutoff:** Occurs at $N_\\mathrm{O}^2 = P = 0$. Ignoring the small ion contribution, this is $1 - \\omega_{pe}'^2/\\omega^2 = 0 \\implies \\omega = \\omega_{pe}' = \\omega_{pe}/\\sqrt{\\gamma}$. A high-power wave (larger $\\gamma$) lowers the O-mode cutoff frequency.\n-   **X-mode resonance (Upper Hybrid Resonance):** Occurs at $N_\\mathrm{X}^2 \\to \\infty$, which happens when $S=0$. Ignoring ions, the condition $S = 1 - \\frac{\\omega_{pe}'^2}{\\omega^2 - \\Omega_e'^2} = 0$ gives the upper hybrid frequency $\\omega_{UH}^2 = \\omega_{pe}'^2 + \\Omega_e'^2$. Substituting the relativistic corrections, we get $\\omega_{UH}^2 = \\frac{\\omega_{pe}^2}{\\gamma} + \\frac{\\Omega_e^2}{\\gamma^2}$. The resonance frequency is shifted downwards by the high-power effect.\n-   **X-mode cutoffs:** Occur at $N_\\mathrm{X}^2 = 0$, which implies $R=0$ or $L=0$. The frequencies at which these conditions are met, $\\omega_R$ and $\\omega_L$, also depend on $\\omega_{pe}'$ and $\\Omega_e'$, and are thus shifted to lower values by the relativistic mass increase.\n\nIn summary, the high-power relativistic correction makes electrons effectively heavier, reducing their characteristic frequencies and shifting the wave cutoffs and resonances to lower frequencies. This is a crucial nonlinear effect in high-power plasma heating schemes like Electron Cyclotron Resonance Heating (ECRH).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ordinary and extraordinary mode refractive indices for perpendicular\n    propagation in a magnetized plasma, including a weakly relativistic correction.\n    \"\"\"\n    # Physical Constants in SI units\n    e = 1.602176634e-19  # Elementary charge (C)\n    m_e = 9.1093837015e-31 # Electron rest mass (kg)\n    m_p = 1.67262192369e-27 # Proton mass (kg)\n    c = 299792458.0      # Speed of light (m/s)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    \n    # Ion properties (Deuterium)\n    q_i = e\n    m_i = 2 * m_p\n\n    # Test cases: (n_e [m^-3], B_0 [T], omega [rad/s], E_0 [V/m])\n    test_cases = [\n        (5.0e19, 6.0, 1.10e12, 1.0e6),\n        (5.0e19, 6.0, 3.984e11, 0.0),\n        (5.0e19, 6.0, 1.125e12, 0.0),\n        (5.0e19, 6.0, 1.20e12, 5.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        n_e, B0, w, E0 = case\n        \n        # Plasma density is the same for electrons and ions\n        n_i = n_e\n\n        # --- High-Power Correction ---\n        # Calculate normalized vector potential a0 and Lorentz factor gamma\n        if E0 == 0.0:\n            gamma = 1.0\n        else:\n            # a0 = |q_e| * E0 / (m_e * c * w)\n            a0 = (e * E0) / (m_e * c * w)\n            gamma = np.sqrt(1 + a0**2)\n            \n        # Effective electron mass\n        me_eff = gamma * m_e\n        # Ion mass remains non-relativistic\n        mi_eff = m_i\n\n        # --- Plasma Species Definition ---\n        # List of dicts to hold species properties\n        species_list = [\n            {'q': -e, 'm': me_eff, 'n': n_e, 'name': 'electron'},\n            {'q': q_i, 'm': mi_eff, 'n': n_i, 'name': 'ion'}\n        ]\n\n        # --- Stix Parameter Calculation ---\n        # Initialize sums for R, L, P\n        sum_R = 0.0\n        sum_L = 0.0\n        sum_P = 0.0\n\n        for s in species_list:\n            # Species plasma frequency squared: w_ps^2 = n*q^2 / (eps0 * m)\n            w_ps2 = (s['n'] * s['q']**2) / (eps0 * s['m'])\n\n            # Species cyclotron frequency: Omega_s = q*B0 / m\n            Omega_s = (s['q'] * B0) / s['m']\n\n            # Accumulate terms for Stix parameters\n            # Check for resonance conditions to avoid division by zero, though problem inputs avoid this.\n            if w - Omega_s == 0 or w + Omega_s == 0:\n                # This case indicates a resonance not handled by cold plasma theory\n                # We can set results to NaN or handle as per a more advanced model.\n                # For this problem, inputs are chosen to avoid this.\n                sum_L = np.nan\n                sum_R = np.nan\n                break\n\n            sum_R += w_ps2 / (w * (w + Omega_s))\n            sum_L += w_ps2 / (w * (w - Omega_s))\n            sum_P += w_ps2 / (w**2)\n        \n        # Final Stix parameters\n        R = 1.0 - sum_R\n        L = 1.0 - sum_L\n        P = 1.0 - sum_P\n        S = (R + L) / 2.0\n\n        # --- Refractive Index Calculation ---\n        # Ordinary mode refractive index squared\n        # N_O^2 = P\n        N2_O = P\n\n        # Extraordinary mode refractive index squared\n        # N_X^2 = R*L / S\n        # Check for upper hybrid resonance where S=0\n        if S == 0.0:\n            N2_X = np.inf\n        else:\n            N2_X = (R * L) / S\n\n        results.extend([N2_O, N2_X])\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}