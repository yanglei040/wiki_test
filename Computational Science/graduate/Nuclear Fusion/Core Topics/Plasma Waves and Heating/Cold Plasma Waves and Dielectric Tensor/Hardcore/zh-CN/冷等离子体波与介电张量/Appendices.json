{
    "hands_on_practices": [
        {
            "introduction": "介电张量 $\\boldsymbol{\\varepsilon}$ 是描述等离子体中波传播的核心。然而，其标准形式通常是在与磁场对齐的坐标系中给出的。本练习  对于培养将此张量转换到任意实验室坐标系下的数学能力至关重要。在真实的实验装置中，磁场方向往往与坐标轴不一致，因此掌握这种张量旋转是正确模拟波物理的基础。",
            "id": "3693388",
            "problem": "考虑在磁约束核聚变装置中遇到的均匀、磁化的冷电子-离子等离子体，其背景磁场 $\\mathbf{B}_{0}$ 为常数。在冷等离子体近似下，单一角频率 $\\omega$ 下的线性响应通过本构关系 $\\mathbf{D} = \\varepsilon_{0}\\,\\boldsymbol{\\varepsilon}\\cdot\\mathbf{E}$ 将电位移 $\\mathbf{D}$ 与电场 $\\mathbf{E}$ 联系起来，其中 $\\varepsilon_{0}$ 是真空介电常数，$\\boldsymbol{\\varepsilon}$ 是无量纲的相对介电张量。在与背景磁场对齐的笛卡尔坐标系（磁场对齐基）中，对于具有笔直、均匀磁场 $\\mathbf{B}_{0}$ 的均匀等离子体，其冷等离子体介电张量具有标准形式\n$$\n\\boldsymbol{\\varepsilon}_{B} \\equiv\n\\begin{pmatrix}\nS  &-iD  &0 \\\\\niD  &S  &0 \\\\\n0  &0  &P\n\\end{pmatrix},\n$$\n其中 $S$、$D$ 和 $P$ 是等离子体参数的实值、频率依赖函数（即所谓的 Stix 参数），$i$ 是虚数单位。\n\n假设实验室坐标系通过一次正常旋转与磁场对齐基相关联，该旋转将 $\\mathbf{B}_{0}$ 置于实验室的 $x$–$z$ 平面内，使其与实验室 $z$ 轴形成极角 $\\theta$，并保持实验室 $y$ 轴不变。这是一个绕实验室 $y$ 轴的右手旋转，旋转角度为 $\\theta$，它将磁场对齐基的 $\\hat{\\mathbf{z}}$ 映射到实验室单位矢量 $\\hat{\\mathbf{b}} = (\\sin\\theta,\\,0,\\,\\cos\\theta)$。\n\n从旋转下的矢量变换性质和本构关系 $\\mathbf{D} = \\varepsilon_{0}\\,\\boldsymbol{\\varepsilon}\\cdot\\mathbf{E}$ 出发，推导介电张量分量在磁场对齐基和实验室基之间的变换法则。然后，利用此变换，计算实验室坐标系下的介电张量分量 $\\varepsilon_{xx}$，并将其表示为关于 $S$、$D$、$P$ 和 $\\theta$ 的显式符号表达式。\n\n将您的最终答案表示为单个简化的解析表达式。由于介电张量分量是无量纲的，因此最终答案不需要单位。",
            "solution": "出发点是冷等离子体的线性本构关系，\n$$\n\\mathbf{D} = \\varepsilon_{0}\\,\\boldsymbol{\\varepsilon}\\cdot\\mathbf{E},\n$$\n它在任何笛卡尔坐标基中都有效。为了联系由旋转关联的两个基中的分量，我们使用矢量和二阶张量在正常正交旋转下的标准变换性质。\n\n令磁场对齐基的分量用撇号表示，实验室基的分量不用撇号表示。令 $\\mathbf{R}$ 为 $3\\times 3$ 的正常正交旋转矩阵（$\\mathbf{R}^{-1}=\\mathbf{R}^{\\mathsf{T}}$），它将分量矢量从磁场对齐基映射到实验室基：\n$$\n\\mathbf{E} = \\mathbf{R}\\,\\mathbf{E}',\\qquad \\mathbf{D} = \\mathbf{R}\\,\\mathbf{D}'.\n$$\n在磁场对齊基中的本构关系是\n$$\n\\mathbf{D}' = \\varepsilon_{0}\\,\\boldsymbol{\\varepsilon}_{B}\\cdot\\mathbf{E}'.\n$$\n将这些与矢量变换相结合，得到\n$$\n\\mathbf{D} = \\mathbf{R}\\,\\mathbf{D}' = \\mathbf{R}\\left(\\varepsilon_{0}\\,\\boldsymbol{\\varepsilon}_{B}\\cdot\\mathbf{E}'\\right) = \\varepsilon_{0}\\,\\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{B}\\,\\mathbf{E}'.\n$$\n我们还有 $\\mathbf{E}' = \\mathbf{R}^{\\mathsf{T}}\\,\\mathbf{E}$（因为 $\\mathbf{R}$ 是正交的）。将 $\\mathbf{E}'$ 代入上一个方程，\n$$\n\\mathbf{D} = \\varepsilon_{0}\\,\\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{B}\\,\\mathbf{R}^{\\mathsf{T}}\\,\\mathbf{E}.\n$$\n通过与 $\\mathbf{D} = \\varepsilon_{0}\\,\\boldsymbol{\\varepsilon}_{\\text{lab}}\\cdot\\mathbf{E}$ 比较，我们确定实验室坐标系下的介电张量为\n$$\n\\boldsymbol{\\varepsilon}_{\\text{lab}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{B}\\,\\mathbf{R}^{\\mathsf{T}}.\n$$\n\n接下来，我们构造旋转矩阵 $\\mathbf{R}$，它对应于绕实验室 $y$ 轴右手旋转角度 $\\theta$ 的变换，该变换将磁场对齐基的单位矢量 $\\hat{\\mathbf{z}}'$ 映射到 $\\hat{\\mathbf{b}}=(\\sin\\theta,\\,0,\\,\\cos\\theta)$。绕 $y$ 轴的旋转矩阵的标准形式是\n$$\n\\mathbf{R}_{y}(\\theta) =\n\\begin{pmatrix}\n\\cos\\theta  &0  &\\sin\\theta \\\\\n0  &1  &0 \\\\\n-\\sin\\theta  &0  &\\cos\\theta\n\\end{pmatrix}.\n$$\n可以验证 $\\mathbf{R}_{y}(\\theta)\\,(0,0,1)^{\\mathsf{T}} = (\\sin\\theta,\\,0,\\,\\cos\\theta)^{\\mathsf{T}}$，这符合要求。取 $\\mathbf{R}=\\mathbf{R}_{y}(\\theta)$，我们计算\n$$\n\\boldsymbol{\\varepsilon}_{\\text{lab}} = \\mathbf{R}_{y}(\\theta)\\,\\boldsymbol{\\varepsilon}_{B}\\,\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}}.\n$$\n\n我们需要求解的是实验室坐标系下的分量 $\\varepsilon_{xx}$，即 $\\boldsymbol{\\varepsilon}_{\\text{lab}}$ 的 $(1,1)$ 元素。为了计算该元素，方便的做法是先计算中间矩阵 $\\mathbf{A} \\equiv \\mathbf{R}_{y}(\\theta)\\,\\boldsymbol{\\varepsilon}_{B}$，然后计算 $\\boldsymbol{\\varepsilon}_{\\text{lab}} = \\mathbf{A}\\,\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}}$。为简洁起见，令 $c\\equiv\\cos\\theta$，$s\\equiv\\sin\\theta$。\n\n磁场对齐介电张量为\n$$\n\\boldsymbol{\\varepsilon}_{B} =\n\\begin{pmatrix}\nS  &-iD  &0 \\\\\niD  &S  &0 \\\\\n0  &0  &P\n\\end{pmatrix}.\n$$\n旋转矩阵为\n$$\n\\mathbf{R}_{y}(\\theta) =\n\\begin{pmatrix}\nc  &0  &s \\\\\n0  &1  &0 \\\\\n-\\,s  &0  &c\n\\end{pmatrix},\\qquad\n\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}} =\n\\begin{pmatrix}\nc  &0  &-\\,s \\\\\n0  &1  &0 \\\\\ns  &0  &c\n\\end{pmatrix}.\n$$\n通过行列相乘计算 $\\mathbf{A}=\\mathbf{R}_{y}(\\theta)\\,\\boldsymbol{\\varepsilon}_{B}$：\n\\begin{align*}\nA_{11} = c\\,S + s\\cdot 0 = c\\,S, \\\\\nA_{12} = c\\,(-iD) + s\\cdot 0 = -\\,i\\,c\\,D, \\\\\nA_{13} = c\\cdot 0 + s\\,P = s\\,P, \\\\\nA_{21} = 0\\cdot S + 1\\cdot iD + 0\\cdot 0 = iD, \\\\\nA_{22} = 0\\cdot (-iD) + 1\\cdot S + 0\\cdot 0 = S, \\\\\nA_{23} = 0\\cdot 0 + 1\\cdot 0 + 0\\cdot P = 0, \\\\\nA_{31} = (-s)\\,S + c\\cdot 0 = -\\,s\\,S, \\\\\nA_{32} = (-s)\\,(-iD) + c\\cdot 0 = i\\,s\\,D, \\\\\nA_{33} = (-s)\\cdot 0 + c\\,P = c\\,P.\n\\end{align*}\n现在，$\\varepsilon_{xx}$ 是 $(\\boldsymbol{\\varepsilon}_{\\text{lab}})_{11} = \\sum_{k=1}^{3} A_{1k}\\,(\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}})_{k1}$。从 $\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}}$ 可知 $(\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}})_{11} = c$、$(\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}})_{21} = 0$、$(\\mathbf{R}_{y}(\\theta)^{\\mathsf{T}})_{31} = s$。因此，\n\\begin{align*}\n\\varepsilon_{xx}\n= A_{11}\\,c + A_{12}\\cdot 0 + A_{13}\\,s \\\\\n= (c\\,S)\\,c + (s\\,P)\\,s \\\\\n= c^{2}\\,S + s^{2}\\,P.\n\\end{align*}\n恢复 $c=\\cos\\theta$ 和 $s=\\sin\\theta$，实验室坐标系下的介电张量分量为\n$$\n\\varepsilon_{xx} = S\\,\\cos^{2}\\theta + P\\,\\sin^{2}\\theta.\n$$\n该表达式是无量纲的，符合相对介电张量元素的预期，并且已经是关于 $S$、$P$ 和 $\\theta$ 的简化解析形式。注意，$D$ 并未出现在 $\\varepsilon_{xx}$ 的表达式中，这是因为对于这个特定的旋转和分量，$xy$ 平面内由 $D$ 控制的旋向性（gyrotropy）产生非对角耦合，在绕 $y$ 轴纯旋转后投影到 $x$ 上时，对 $(1,1)$ 元素没有贡献。",
            "answer": "$$\\boxed{S\\,\\cos^{2}\\theta + P\\,\\sin^{2}\\theta}$$"
        },
        {
            "introduction": "在掌握了介电张量的数学性质之后，我们现在应用它来揭示一个核心的物理现象：波的截止。本练习  将引导你从第一性原理出发，推导电磁波无法在等离子体中传播并转为倏逝波的条件。通过计算穿透深度，你将得到一个描述此效应的具体物理量，从而在抽象的色散关系和可测量的物理结果之間建立起一座桥梁。",
            "id": "3693391",
            "problem": "一个冷的、均匀的、磁化的电子-离子等离子体占据着半空间 $x \\ge 0$。存在一个均匀背景磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，其中 $B_0 = 2.0$ $\\mathrm{T}$。离子提供一个静止的中性化背景，且碰撞可以忽略不计。一束角频率为 $\\omega$ 的单色平面电磁波从真空 ($x  0$) 入射到位于 $x=0$ 的平面界面上，其波矢 $\\mathbf{k}$ 沿着 $+\\hat{\\mathbf{x}}$ 方向，电场极化方向平行于背景磁场，即 $\\mathbf{E} \\parallel \\mathbf{B}_0$。这是垂直入射的寻常（O）模几何构型。\n\n从麦克斯韦方程组和线性化的冷电子流体方程出发，从第一性原理推导波在等离子体中变为非传播波的条件，以及表征等离子体内部 ($x > 0$) 电场振幅空间衰减的相应倏逝衰减常数 $\\kappa$。然后，对于电子数密度 $n_e = 1.0 \\times 10^{19}$ $\\mathrm{m}^{-3}$ 和波频率 $f = 10.0$ $\\mathrm{GHz}$（因此 $\\omega = 2\\pi f$），计算倏逝场的穿透深度 $\\delta = 1/\\kappa$。将 $\\delta$ 的最终数值答案以毫米为单位表示，并四舍五入到四位有效数字。\n\n使用基本常数：电子电荷 $e$、电子质量 $m_e$、真空介电常数 $\\epsilon_0$ 和光速 $c$。",
            "solution": "问题要求推导在冷等离子体中垂直于磁场传播的寻常（O）模发生倏逝的条件及相应的衰减常数，然后对穿透深度进行数值计算。\n\n分析从麦克斯韦方程组和冷无碰撞等离子体中电子的线性化运动方程开始。\n\n控制方程如下：\n1.  麦克斯韦方程组（假设没有背景自由电荷，$\\rho=0$）：\n    $$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n    $$ \\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n2.  线性化的冷电子流体运动方程：\n    $$ m_e \\frac{\\partial \\mathbf{v}_1}{\\partial t} = -e(\\mathbf{E}_1 + \\mathbf{v}_1 \\times \\mathbf{B}_0) $$\n此处，$\\mathbf{E}_1$ 和 $\\mathbf{v}_1$ 分别是一阶微扰电场和电子流体速度。$\\mathbf{B}_0$ 是均匀背景磁场。背景等离子体是静止的，因此零阶速度 $\\mathbf{v}_0 = 0$。离子被假定为静止的中性化背景。忽略了碰撞效应和热压力。等离子体电流密度由 $\\mathbf{J}_1 = -n_e e \\mathbf{v}_1$ 给出，其中 $n_e$ 是电子数密度。\n\n我们假设所有微扰量都以平面波形式谐波变化：$\\mathbf{F}(\\mathbf{x}, t) = \\mathbf{F}_0 \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))$。这个拟设允许将微分算子替换为代数因子：$\\frac{\\partial}{\\partial t} \\to -i\\omega$ 和 $\\nabla \\to i\\mathbf{k}$。\n\n运动方程变为：\n$$ -i\\omega m_e \\mathbf{v}_1 = -e(\\mathbf{E}_1 + \\mathbf{v}_1 \\times \\mathbf{B}_0) $$\n问题指定了垂直入射的寻常（O）模的几何构型：\n-   背景磁场：$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。\n-   波传播矢量：$\\mathbf{k} = k \\hat{\\mathbf{x}}$。\n-   波电场极化：$\\mathbf{E}_1 \\parallel \\mathbf{B}_0$，因此 $\\mathbf{E}_1 = E_z \\hat{\\mathbf{z}}$。\n\n将此极化代入运动方程，我们分析电子速度 $\\mathbf{v}_1 = v_x \\hat{\\mathbf{x}} + v_y \\hat{\\mathbf{y}} + v_z \\hat{\\mathbf{z}}$ 的各个分量：\n$$ -i\\omega m_e (v_x \\hat{\\mathbf{x}} + v_y \\hat{\\mathbf{y}} + v_z \\hat{\\mathbf{z}}) = -e(E_z \\hat{\\mathbf{z}} + (v_x \\hat{\\mathbf{x}} + v_y \\hat{\\mathbf{y}} + v_z \\hat{\\mathbf{z}}) \\times B_0 \\hat{\\mathbf{z}}) $$\n$$ -i\\omega m_e (v_x \\hat{\\mathbf{x}} + v_y \\hat{\\mathbf{y}} + v_z \\hat{\\mathbf{z}}) = -e(E_z \\hat{\\mathbf{z}} - v_y B_0 \\hat{\\mathbf{x}} + v_x B_0 \\hat{\\mathbf{y}}) $$\n令各分量相等：\n-   z分量：$-i\\omega m_e v_z = -eE_z \\implies v_z = \\frac{i e}{\\omega m_e} E_z$。\n-   x分量：$-i\\omega m_e v_x = e v_y B_0$。\n-   y分量：$-i\\omega m_e v_y = -e v_x B_0$。\n\nx和y分量方程构成了一个关于 $v_x$ 和 $v_y$ 的齐次方程组。只有当系数行列式为零时，它才有非平庸解，这发生在电子回旋频率 $\\omega = \\omega_{ce} = eB_0/m_e$ 处。对于 $\\omega \\neq \\omega_{ce}$，唯一的解是平庸解：$v_x=0$ 和 $v_y=0$。因此，电子流体速度完全平行于磁场：\n$$ \\mathbf{v}_1 = v_z \\hat{\\mathbf{z}} = \\frac{i e}{\\omega m_e} E_z \\hat{\\mathbf{z}} $$\n这表明对于O模，电子的运动不受背景磁场的影响。\n\n于是等离子体电流密度为：\n$$ \\mathbf{J}_1 = -n_e e \\mathbf{v}_1 = -n_e e \\left(\\frac{i e}{\\omega m_e} E_z\\right) \\hat{\\mathbf{z}} = -\\frac{i n_e e^2}{\\omega m_e} \\mathbf{E}_1 $$\n现在我们推导波动方程。对法拉第定律取旋度，并代入安培定律：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}_1) = -\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{B}_1) = -\\frac{\\partial}{\\partial t}\\left(\\mu_0 \\mathbf{J}_1 + \\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}_1}{\\partial t}\\right) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}_1) = \\nabla(\\nabla \\cdot \\mathbf{E}_1) - \\nabla^2 \\mathbf{E}_1$。对于横波，$\\nabla \\cdot \\mathbf{E}_1 = i\\mathbf{k} \\cdot \\mathbf{E}_1 = i(k\\hat{\\mathbf{x}}) \\cdot (E_z \\hat{\\mathbf{z}}) = 0$。因此波动方程简化为：\n$$ -\\nabla^2 \\mathbf{E}_1 = -\\mu_0 \\frac{\\partial \\mathbf{J}_1}{\\partial t} - \\mu_0 \\epsilon_0 \\frac{\\partial^2 \\mathbf{E}_1}{\\partial t^2} $$\n应用平面波拟设（$\\nabla \\to i\\mathbf{k}$，$\\partial / \\partial t \\to -i\\omega$）：\n$$ - (i\\mathbf{k})^2 \\mathbf{E}_1 = - (i\\mathbf{k}) \\cdot (i\\mathbf{k}) \\mathbf{E}_1 = k^2 \\mathbf{E}_1 $$\n$$ k^2 \\mathbf{E}_1 = -\\mu_0(-i\\omega) \\mathbf{J}_1 - \\mu_0 \\epsilon_0 (-i\\omega)^2 \\mathbf{E}_1 $$\n代入 $\\mathbf{J}_1$ 的表达式：\n$$ k^2 \\mathbf{E}_1 = i\\omega \\mu_0 \\left(-\\frac{i n_e e^2}{\\omega m_e} \\mathbf{E}_1\\right) + \\omega^2 \\mu_0 \\epsilon_0 \\mathbf{E}_1 $$\n$$ k^2 \\mathbf{E}_1 = \\left( \\frac{\\mu_0 n_e e^2}{m_e} + \\omega^2 \\mu_0 \\epsilon_0 \\right) \\mathbf{E}_1 $$\n两边同除以 $\\mathbf{E}_1$ 并使用 $c^2 = 1/(\\mu_0 \\epsilon_0)$：\n$$ k^2 = \\omega^2 \\mu_0 \\epsilon_0 + \\frac{\\mu_0 n_e e^2}{m_e} = \\frac{\\omega^2}{c^2} + \\frac{1}{\\epsilon_0 c^2} \\frac{n_e e^2}{m_e} $$\n定义电子等离子体频率的平方为 $\\omega_p^2 = \\frac{n_e e^2}{\\epsilon_0 m_e}$：\n$$ k^2 = \\frac{\\omega^2}{c^2} - \\frac{\\omega_p^2}{c^2} = \\frac{\\omega^2}{c^2} \\left(1 - \\frac{\\omega_p^2}{\\omega^2}\\right) $$\n这就是寻常模的色散关系。\n\n传播波需要波数 $k$ 为实数，这意味着 $k^2 > 0$。如果 $1 - \\frac{\\omega_p^2}{\\omega^2} > 0$ 或 $\\omega > \\omega_p$，则此条件满足。当 $k^2  0$ 时，波变为非传播（倏逝）波。\n因此，非传播的条件是：\n$$ \\omega  \\omega_p $$\n在此条件下，波数 $k$ 是纯虚数。我们通过 $k = i\\kappa$ 定义倏逝衰减常数 $\\kappa$，其中 $\\kappa$ 是实数且为正。\n将 $k = i\\kappa$ 代入色散关系：\n$$ (i\\kappa)^2 = \\frac{\\omega^2}{c^2} \\left(1 - \\frac{\\omega_p^2}{\\omega^2}\\right) $$\n$$ -\\kappa^2 = -\\frac{\\omega^2}{c^2} \\left(\\frac{\\omega_p^2}{\\omega^2} - 1\\right) $$\n$$ \\kappa^2 = \\frac{\\omega^2}{c^2} \\left(\\frac{\\omega_p^2}{\\omega^2} - 1\\right) $$\n倏逝衰减常数为：\n$$ \\kappa = \\frac{\\omega}{c} \\sqrt{\\frac{\\omega_p^2}{\\omega^2} - 1} $$\n等离子体内部 ($x>0$) 的电场振幅按 $E(x) = E(0) \\exp(-\\kappa x)$ 衰减。\n\n现在，我们进行数值计算。\n已知数据：\n-   电子密度，$n_e = 1.0 \\times 10^{19}$ $\\mathrm{m}^{-3}$。\n-   波频率，$f = 10.0$ $\\mathrm{GHz} = 1.0 \\times 10^{10}$ $\\mathrm{Hz}$。\n\n基本常数：\n-   电子电荷，$e \\approx 1.602 \\times 10^{-19}$ $\\mathrm{C}$。\n-   电子质量，$m_e \\approx 9.109 \\times 10^{-31}$ $\\mathrm{kg}$。\n-   真空介电常数，$\\epsilon_0 \\approx 8.854 \\times 10^{-12}$ $\\mathrm{F/m}$。\n-   光速，$c \\approx 2.998 \\times 10^8$ $\\mathrm{m/s}$。\n\n首先，计算角频率 $\\omega$：\n$$ \\omega = 2\\pi f = 2\\pi (1.0 \\times 10^{10} \\ \\mathrm{s}^{-1}) \\approx 6.2832 \\times 10^{10} \\ \\mathrm{rad/s} $$\n接下来，计算电子等离子体频率的平方 $\\omega_p^2$：\n$$ \\omega_p^2 = \\frac{n_e e^2}{\\epsilon_0 m_e} = \\frac{(1.0 \\times 10^{19} \\ \\mathrm{m}^{-3})(1.602 \\times 10^{-19} \\ \\mathrm{C})^2}{(8.854 \\times 10^{-12} \\ \\mathrm{F/m})(9.109 \\times 10^{-31} \\ \\mathrm{kg})} \\approx 3.1834 \\times 10^{22} \\ \\mathrm{s}^{-2} $$\n等离子体频率为 $\\omega_p = \\sqrt{\\omega_p^2} \\approx 1.7842 \\times 10^{11}$ $\\mathrm{rad/s}$。\n我们验证倏逝条件：$\\omega \\approx 6.283 \\times 10^{10} \\ \\mathrm{rad/s}$ 确实小于 $\\omega_p \\approx 1.784 \\times 10^{11} \\ \\mathrm{rad/s}$。\n\n现在我们计算衰减常数 $\\kappa$：\n$$ \\frac{\\omega_p^2}{\\omega^2} = \\frac{3.1834 \\times 10^{22} \\ \\mathrm{s}^{-2}}{(2\\pi \\times 10^{10} \\ \\mathrm{s}^{-1})^2} \\approx \\frac{3.1834 \\times 10^{22}}{3.9478 \\times 10^{21}} \\approx 8.0637 $$\n$$ \\kappa = \\frac{\\omega}{c} \\sqrt{\\frac{\\omega_p^2}{\\omega^2} - 1} = \\frac{2\\pi \\times 10^{10} \\ \\mathrm{s}^{-1}}{2.998 \\times 10^8 \\ \\mathrm{m/s}} \\sqrt{8.0637 - 1} $$\n$$ \\kappa \\approx (209.58 \\ \\mathrm{m}^{-1}) \\sqrt{7.0637} \\approx (209.58 \\ \\mathrm{m}^{-1})(2.6578) \\approx 557.15 \\ \\mathrm{m}^{-1} $$\n穿透深度 $\\delta$ 是衰减常数的倒数：\n$$ \\delta = \\frac{1}{\\kappa} \\approx \\frac{1}{557.15 \\ \\mathrm{m}^{-1}} \\approx 0.0017949 \\ \\mathrm{m} $$\n为将结果以毫米表示，我们乘以 $1000$：\n$$ \\delta \\approx 0.0017949 \\ \\mathrm{m} \\times 1000 \\ \\mathrm{mm/m} = 1.7949 \\ \\mathrm{mm} $$\n四舍五入到四位有效数字，穿透深度为 $1.795$ $\\mathrm{mm}$。使用更精确的常数（$e=1.6021766 \\times 10^{-19}$ C, $m_e=9.1093837 \\times 10^{-31}$ kg, $\\epsilon_0=8.8541878 \\times 10^{-12}$ F/m, $c=2.99792458 \\times 10^8$ m/s）也得到 $\\delta=1.795$ mm。",
            "answer": "$$\\boxed{1.795}$$"
        },
        {
            "introduction": "尽管解析解对于建立物理直觉十分强大，但大多数真实的等离子体问题都需要依赖数值方法。这最后一个练习  旨在通过实现并比较两种不同的数值求解器来解决完整的冷等离子体色散关系，从而挑战你连接理论与计算的能力。本练习不仅能鞏固你对底层物理的理解，还能让你掌握计算科学中的关键技能，包括对数值稳定性和算法性能的认识。",
            "id": "3693378",
            "problem": "考虑一个由多种粒子组成的均匀、无碰撞、磁化的冷等离子体，其背景数密度、电荷、质量恒定，并处于静态、均匀的磁场中。平面电磁波以角频率 $\\omega$ 和波矢量 $\\mathbf{k}$ 传播，波矢量与磁场成 $\\theta$ 角。折射率的平方定义为 $a = n^2 = c^2 k^2 / \\omega^2$，其中 $c$ 是光速。从线性化的冷等离子体运动方程和麦克斯韦方程组出发，已知色散关系可以根据在给定波频率、磁场强度和传播角下计算的介电张量来重构。\n\n您的任务是编写一个完整的程序，对色散关系进行数值评估，并评价两种计算色散关系物理根 $a$（无量纲）的求解器的稳定性。这两种求解器是：\n- 一种基于多项式的求解器，它利用了将色散关系行列式化简为关于 $a$ 的二次方程的特性。\n- 一种 Newton–Raphson 求解器，它使用导数的有限差分近似，直接最小化色散矩阵关于 $a$ 的行列式。\n\n对于每个测试用例，程序必须实现以下步骤：\n1. 对于每种粒子 $s$，从第一性原理计算冷等离子体介电响应量，即粒子等离子体频率和回旋频率，然后在给定的 $\\omega$ 和磁场强度下构建介电张量分量。仅使用基本物理定律和定义；不要引入经验性的简化方法。\n2. 利用介电张量和由 $\\theta$ 定义的几何结构，构建斜向传播的色散关系行列式，然后将其化简为关于 $a$ 的多项式并求解其正实数根 $a$（基于多项式的求解器）。只保留 $a$ 为实数且 $a > 0$ 的物理上传播的解。\n3. 实现一个 Newton–Raphson 求解器，将行列式视为函数 $f(a)$，并使用中心有限差分近似计算 $f'(a)$，步长根据 $a$ 自适应选择。最多使用 $50$ 次迭代，当 $a$ 的相对更新量小于 $10^{-9}$ 时终止；如果收敛失败，则报告该测试用例失败。\n4. 计算基于多项式的求解器找到的根集与 Newton–Raphson 求解器找到的根集之间的最大相对差异。如果两种求解器产生的物理有效根数量不同，或者如果 Newton–Raphson 方法未能收敛，则将该测试用例的误差度量设置为 $10^9$。\n5. 计算一个定义为 $1 / \\min |f'(a_r)|$ 的稳定性风险度量，该度量在多项式根 $a_r$ 处求值，其中 $f'(a)$ 是从同一色散关系一致地获得的行列式关于 $a$ 的导数。较大的值表示在这些根附近具有更高的灵敏度和潜在的数值不稳定性。\n\n全程使用的物理单位和常数：\n- 数密度单位为 $\\mathrm{m^{-3}}$。\n- 磁场强度单位为 $\\mathrm{T}$。\n- 角频率单位为 $\\mathrm{rad/s}$。\n- 角度 $\\theta$ 单位为弧度。\n- 所有常数均使用国际单位制（SI）。\n\n所有测试用例中使用的粒子种类：\n- 电子：电荷 $-e$，质量 $m_e$。\n- 氘核：电荷 $+e$，质量 $m_D$。\n假设准中性，因此在每个测试用例中，氘核数密度等于电子数密度。\n\n数值参数：\n- Newton–Raphson 相对更新量的容差等于 $10^{-9}$。\n- 最大迭代次数等于 $50$。\n- 有限差分导数步长选择为 $h = \\max(10^{-12}, 10^{-6} \\lvert a \\rvert + 10^{-12})$。\n- 在评估多项式根时，如果判别式因舍入误差而略为负，但其绝对值小于线性系数平方的 $10^{-12}$ 倍，则将其视为零。如果多项式首项系数的绝对值小于 $10^{-14}$，则将该多项式视为线性。\n\n测试套件：\n- 案例 1（远离强共振的一般斜向传播）：电子数密度 $1.0 \\times 10^{20}$ $\\mathrm{m^{-3}}$，磁场 $5.0$ $\\mathrm{T}$，角频率 $4.0 \\times 10^{11}$ $\\mathrm{rad/s}$，角度 $\\theta = \\pi/4$ 弧度。\n- 案例 2（接近上混合波条件）：电子数密度 $1.0 \\times 10^{20}$ $\\mathrm{m^{-3}}$，磁场 $5.0$ $\\mathrm{T}$，角频率 $1.05 \\times 10^{12}$ $\\mathrm{rad/s}$，角度 $\\theta = \\pi/3$ 弧度。\n- 案例 3（接近垂直传播且磁场较弱）：电子数密度 $1.0 \\times 10^{20}$ $\\mathrm{m^{-3}}$，磁场 $0.5$ $\\mathrm{T}$，角频率 $5.64 \\times 10^{11}$ $\\mathrm{rad/s}$，角度 $\\theta = 0.999 \\times \\pi/2$ 弧度。\n\n最终输出格式：\n- 对于每个测试用例，计算一对浮点数 $[E, R]$，其中 $E$ 是基于多项式的根与 Newton–Raphson 根之间的最大相对差异（无量纲），$R$ 是稳定性风险度量（无量纲）。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表由这些数对组成，并用方括号括起来，例如 `[[E1,R1],[E2,R2],[E3,R3]]`。\n\n所有数值输出均为无量纲浮点数。不应打印其他任何文本。",
            "solution": "该问题被评估为有效。它在科学上基于成熟的冷等离子体物理学，问题定义明确，有清晰的目标和充足的数据，并以精确、客观的语言表述。所有参数和常数都已提供，且场景在物理上是现实的。\n\n任务是数值求解双组分（电子-氘核）等离子体的冷等离子体色散关系，并比较两种不同数值求解器的性能。解决方案涉及从第一性原理推导必要的方程，然后实现求解器和指定的评估指标。\n\n### 1. 理论框架：冷等离子体介电张量与色散关系\n\n在介质中，角频率为 $\\omega$、波矢量为 $\\mathbf{k}$ 的电磁平面波的传播由从麦克斯韦方程组推导出的波动方程决定：\n$$\n\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0\n$$\n其中 $\\mathbf{E}$ 是电场矢量， $c$ 是光速，$\\mathbf{K}$ 是介质的介电张量。为了使 $\\mathbf{E}$ 存在非平庸解，系数矩阵的行列式必须为零。我们定义折射率为 $n = \\frac{ck}{\\omega}$，折射率矢量为 $\\mathbf{n} = \\frac{c}{\\omega}\\mathbf{k}$。波动方程可以写成：\n$$\n\\mathbf{n} \\times (\\mathbf{n} \\times \\mathbf{E}) + \\mathbf{K} \\cdot \\mathbf{E} = 0 \\implies (\\mathbf{n}\\mathbf{n} - n^2 \\mathbf{I} + \\mathbf{K}) \\cdot \\mathbf{E} = 0\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。通过将张量算符的行列式设为零，可以得到色散关系。令 $a=n^2$ 为折射率平方。色散关系为：\n$$\n\\det\\left( a \\frac{\\mathbf{k}\\mathbf{k}}{k^2} - a \\mathbf{I} + \\mathbf{K} \\right) = 0\n$$\n我们建立一个坐标系，其中静态磁场 $\\mathbf{B}_0$ 沿 z 轴方向，$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，波矢量 $\\mathbf{k}$ 位于 x-z 平面内，与 $\\mathbf{B}_0$ 成 $\\theta$ 角，因此 $\\mathbf{k} = k(\\sin\\theta \\hat{\\mathbf{x}} + \\cos\\theta \\hat{\\mathbf{z}})$。矩阵 $\\frac{\\mathbf{k}\\mathbf{k}}{k^2} - \\mathbf{I}$ 变为：\n$$\n\\begin{pmatrix}\n-\\cos^2\\theta  0  \\sin\\theta\\cos\\theta \\\\\n0  -1  0 \\\\\n\\sin\\theta\\cos\\theta  0  -\\sin^2\\theta\n\\end{pmatrix}\n$$\n对于冷、磁化、多组分等离子体，介电张量 $\\mathbf{K}$ 由下式给出：\n$$\n\\mathbf{K} = \\begin{pmatrix}\nS  -iD  0 \\\\\niD  S  0 \\\\\n0  0  P\n\\end{pmatrix}\n$$\n$P$、$S$ 和 $D$ 分量是 $\\omega$ 的函数，并由 Stix 参数 $P$、$R$ 和 $L$ 推导得出：\n$$\nS = \\frac{1}{2}(R+L), \\quad D = \\frac{1}{2}(R-L)\n$$\nStix 参数是所有等离子体粒子种类 $s$ 的总和：\n$$\nP = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}\n$$\n$$\nR = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2} \\frac{\\omega}{\\omega + \\Omega_{cs}}\n$$\n$$\nL = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2} \\frac{\\omega}{\\omega - \\Omega_{cs}}\n$$\n此处，$\\omega_{ps}$ 是等离子体频率，$\\Omega_{cs}$ 是回旋频率，对应于电荷为 $q_s$、质量为 $m_s$、数密度为 $n_s$ 的粒子种类 $s$：\n$$\n\\omega_{ps}^2 = \\frac{n_s q_s^2}{\\epsilon_0 m_s}, \\quad \\Omega_{cs} = \\frac{q_s B_0}{m_s}\n$$\n将矩阵代入行列式形式，得到色散矩阵 $\\mathbf{M}$：\n$$\n\\mathbf{M} = \\begin{pmatrix}\nS - a\\cos^2\\theta  -iD  a\\sin\\theta\\cos\\theta \\\\\niD  S - a  0 \\\\\na\\sin\\theta\\cos\\theta  0  P - a\\sin^2\\theta\n\\end{pmatrix}\n$$\n色散关系 $\\det(\\mathbf{M})=0$ 展开后是一个关于 $a=n^2$ 的二次方程。\n\n### 2. 基于多项式的求解器\n\n计算 $\\mathbf{M}$ 的行列式得到一个关于 $a$ 的多项式：\n$$\n\\det(\\mathbf{M}) = (S - a\\cos^2\\theta)[(S-a)(P-a\\sin^2\\theta)] + D^2(P-a\\sin^2\\theta) - (a\\sin\\theta\\cos\\theta)^2(S-a) = 0\n$$\n按 $a$ 的幂次对各项进行分组，得到标准形式 $A a^2 + B a + C = 0$，其中系数为：\n$$\nA = S\\sin^2\\theta + P\\cos^2\\theta\n$$\n$$\nB = -RL\\sin^2\\theta - PS(1+\\cos^2\\theta)\n$$\n$$\nC = PRL\n$$\n这个二次方程可以使用标准公式 $a = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解 $a$。为了数值稳定性，特别是当 $4AC$ 相对于 $B^2$ 很小时，会使用一种改进的形式。我们只保留正实数根（$a > 0$），这些根对应于物理上传播的波。对于首项系数 $A$ 接近于零（方程降为线性）和判别式因浮点误差而略为负值的情况，将实施特殊的数值处理。\n\n### 3. Newton–Raphson 求解器\n\nNewton-Raphson 方法是一种寻根算法，它通过迭代来优化对函数 $f(x)$ 根的猜测值。色散关系可以看作是 $a$ 的函数 $f(a) = A a^2 + B a + C$。迭代更新规则为：\n$$\na_{k+1} = a_k - \\frac{f(a_k)}{f'(a_k)}\n$$\n根据要求，导数 $f'(a_k)$ 使用中心有限差分格式进行数值近似，步长 $h$ 是自适应的：\n$$\nf'(a_k) \\approx \\frac{f(a_k+h) - f(a_k-h)}{2h}, \\quad \\text{其中 } h = \\max(10^{-12}, 10^{-6} |a_k| + 10^{-12})\n$$\n迭代从一个初始猜测值 $a_0$ 开始，最多进行 50 次，或者直到 $a$ 的相对变化量低于 $10^{-9}$ 的容差为止。为了找到所有可能的根，对一组跨越几个数量级的不同初始猜测值重复此过程。收集找到的唯一的正根。\n\n### 4. 评估指标\n\n计算两个指标来比较求解器并评估数值稳定性。\n\n**最大相对差异 ($E$)：** 该指标量化了多项式求解器找到的根集 ($P_r$) 与 Newton-Raphson 求解器找到的根集 ($N_r$) 之间的一致性。如果两个求解器找到的物理根数量相同，则最大相对差异计算如下：\n$$\nE = \\max_{i} \\left| \\frac{P_{r,i} - N_{r,i}}{P_{r,i}} \\right|\n$$\n如果求解器找到的根数量不同，或者 Newton-Raphson 方法未能产生一致的根集，则将 $E$ 设置为 $10^9$ 以表示存在重大差异。\n\n**稳定性风险度量 ($R$)：** 该指标表示色散关系在其根附近的数值敏感性。它定义为：\n$$\nR = \\frac{1}{\\min_{r} |f'(a_r)|}\n$$\n其中 $a_r$ 是多项式求解器找到的根，而 $f'(a) = 2Aa + B$ 是行列式函数 $f(a)$ 的解析导数。根处导数的微小值（平缓的斜率）意味着函数系数的微小扰动可能导致根位置的巨大偏移，这表明存在潜在的数值不稳定性。因此，较大的 $R$ 值预示着更高的风险。\n\n实现过程首先根据提供的测试用例参数计算电子和氘核的等离子体频率和回旋频率。这些值用于计算 Stix 参数以及随后的系数 $A$、$B$ 和 $C$。然后运行两种求解器以找到根，并从中计算出指标 $E$ 和 $R$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the cold plasma dispersion relation for multiple test cases,\n    compares polynomial and Newton-Raphson solvers, and computes\n    error and stability metrics.\n    \"\"\"\n    \n    # Physical Constants (SI units)\n    C = 2.99792458e8  # Speed of light in vacuum\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity\n    Q_E = 1.602176634e-19  # Elementary charge\n    M_E = 9.1093837015e-31  # Electron mass\n    M_D = 3.3435837724e-27  # Deuteron mass (CODATA 2018)\n\n    # Numerical Parameters from problem statement\n    NEWTON_TOL = 1e-9\n    NEWTON_MAX_ITER = 50\n    POLY_DISC_TOL = 1e-12\n    POLY_A_TOL = 1e-14\n    NR_ROOT_UNIQUENESS_TOL = 1e-6\n\n    # Test suite\n    test_cases = [\n        # (n_e [m^-3], B [T], omega [rad/s], theta [rad])\n        (1.0e20, 5.0, 4.0e11, np.pi / 4),\n        (1.0e20, 5.0, 1.05e12, np.pi / 3),\n        (1.0e20, 0.5, 5.64e11, 0.999 * np.pi / 2),\n    ]\n\n    # Set of initial guesses for Newton-Raphson to find multiple roots\n    NR_INITIAL_GUESSES = [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0]\n\n    def calculate_metrics(n_e, B, omega, theta):\n        \"\"\"\n        Performs the full calculation for a single test case.\n        \"\"\"\n        # Define species properties for electrons and deuterons\n        species = [\n            {'q': -Q_E, 'm': M_E, 'n': n_e},  # Electrons\n            {'q': Q_E, 'm': M_D, 'n': n_e}    # Deuterons (quasi-neutrality)\n        ]\n\n        # Step 1: Compute dielectric tensor components (P, R, L, S)\n        w_ps_sq_sum_w2 = 0\n        term_R = 0\n        term_L = 0\n\n        for s in species:\n            w_ps_sq = s['n'] * s['q']**2 / (EPSILON_0 * s['m'])\n            Omega_cs = s['q'] * B / s['m']\n\n            w_ps_sq_sum_w2 += w_ps_sq / omega**2\n            \n            # Prevent division by zero at resonances\n            if abs(omega + Omega_cs)  1e-15 or abs(omega - Omega_cs)  1e-15:\n                return [1e9, 1e9] \n\n            term_R += w_ps_sq / (omega * (omega + Omega_cs))\n            term_L += w_ps_sq / (omega * (omega - Omega_cs))\n\n        P = 1.0 - w_ps_sq_sum_w2\n        R_stix = 1.0 - term_R\n        L_stix = 1.0 - term_L\n        S = (R_stix + L_stix) / 2.0\n\n        # Step 2: Polynomial-based solver\n        sT2 = np.sin(theta)**2\n        cT2 = np.cos(theta)**2\n\n        A = S * sT2 + P * cT2\n        B_coeff = -R_stix * L_stix * sT2 - P * S * (1 + cT2)\n        C_coeff = P * R_stix * L_stix\n\n        poly_roots = []\n        if abs(A)  POLY_A_TOL:\n            if abs(B_coeff)  1e-15:\n                a = -C_coeff / B_coeff\n                if a  0:\n                    poly_roots.append(a)\n        else:\n            discriminant = B_coeff**2 - 4 * A * C_coeff\n            if discriminant  0 and abs(discriminant)  POLY_DISC_TOL * B_coeff**2:\n                discriminant = 0.0\n            \n            if discriminant = 0:\n                sqrt_disc = np.sqrt(discriminant)\n                \n                # Use numerically stable quadratic formula\n                if B_coeff = 0:\n                    a1 = (-B_coeff - sqrt_disc) / (2 * A)\n                    denom = -B_coeff - sqrt_disc\n                    a2 = (2 * C_coeff) / denom if abs(denom)  1e-20 else a1\n                else:\n                    a1 = (-B_coeff + sqrt_disc) / (2 * A)\n                    denom = -B_coeff + sqrt_disc\n                    a2 = (2 * C_coeff) / denom if abs(denom)  1e-20 else a1\n\n                if a1  0: poly_roots.append(a1)\n                if a2  0: poly_roots.append(a2)\n        \n        poly_roots = sorted(list(set(poly_roots)))\n\n        # Step 3: Newton-Raphson solver\n        def f(a_val):\n            return A * a_val**2 + B_coeff * a_val + C_coeff\n\n        nr_roots = []\n        for a_init in NR_INITIAL_GUESSES:\n            a_k = a_init\n            converged = False\n            for _ in range(NEWTON_MAX_ITER):\n                h = max(1e-12, 1e-6 * abs(a_k) + 1e-12)\n                f_prime = (f(a_k + h) - f(a_k - h)) / (2 * h)\n\n                if abs(f_prime)  1e-25: break  # Derivative too small\n                \n                a_k_plus_1 = a_k - f(a_k) / f_prime\n\n                if abs(a_k_plus_1 - a_k)  NEWTON_TOL * (abs(a_k) + 1e-12):\n                    a_k = a_k_plus_1\n                    converged = True\n                    break\n                a_k = a_k_plus_1\n\n            if converged and a_k  0:\n                is_new = all(abs(root - a_k) = NR_ROOT_UNIQUENESS_TOL * (abs(root) + 1e-12) for root in nr_roots)\n                if is_new:\n                    nr_roots.append(a_k)\n\n        nr_roots.sort()\n\n        # Step 4: Compute the maximum relative difference E\n        if len(poly_roots) != len(nr_roots):\n            E = 1e9\n        elif not poly_roots:\n            E = 0.0\n        else:\n            relative_diffs = [abs(p - n) / p for p, n in zip(poly_roots, nr_roots)]\n            E = max(relative_diffs) if relative_diffs else 0.0\n\n        # Step 5: Compute the stability risk metric R\n        def f_prime_analytic(a_val):\n            return 2 * A * a_val + B_coeff\n\n        if not poly_roots:\n            R = 0.0\n        else:\n            derivatives_at_roots = [abs(f_prime_analytic(r)) for r in poly_roots]\n            min_abs_deriv = min(derivatives_at_roots)\n            R = 1.0 / min_abs_deriv if min_abs_deriv  0 else float('inf')\n\n        return [E, R]\n\n    results = [calculate_metrics(*case) for case in test_cases]\n    \n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}