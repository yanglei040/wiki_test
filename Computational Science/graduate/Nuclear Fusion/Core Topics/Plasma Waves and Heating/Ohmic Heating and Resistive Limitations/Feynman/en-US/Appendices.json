{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our understanding of resistive phenomena in fundamental plasma physics. By starting from Maxwell's equations and a simplified Ohm's law, you will derive the governing equation for the diffusion of current in a cylindrical plasma column. This exercise is essential for identifying and calculating the characteristic resistive relaxation time, $\\tau_R$, a crucial parameter that determines how quickly the current profile can evolve and underpins the separation of timescales used throughout transport modeling .",
            "id": "3711919",
            "problem": "A large-aspect-ratio tokamak may be approximated as a straight, axisymmetric cylinder of minor radius $a$ whose toroidal current density $J_{\\phi}(r,t)$ evolves resistively according to classical resistive magnetohydrodynamics (MHD), with uniform scalar resistivity $\\eta$ and no macroscopic flow. Assume International System of Units (SI), neglect displacement current and turbulence, and take the boundary at $r=a$ to be perfectly conducting. Starting from Maxwell’s equations, specifically Faraday’s law $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$ and Ampère’s law $\\nabla \\times \\mathbf{B} = \\mu_{0}\\mathbf{J}$, together with the resistive Ohm’s law $\\mathbf{E}_{\\parallel} = \\eta \\mathbf{J}$ for the toroidal electric field and current, derive the governing radial diffusion form for the slow evolution of the axisymmetric current profile and identify the characteristic resistive relaxation time $\\tau_{R}$ in terms of $a$, $\\eta$, and $\\mu_{0}$. Then, using $a = 0.5\\,\\mathrm{m}$ and $\\eta = 10^{-7}\\,\\Omega\\,\\mathrm{m}$, compute the numerical value of $\\tau_{R}$, and compare its magnitude to the given energy confinement time $\\tau_{E} = 0.1\\,\\mathrm{s}$ to justify whether quasi-steady current profiles are valid during energy transport evolution. Express the final value of $\\tau_{R}$ in seconds, and round your answer to three significant figures.",
            "solution": "The problem asks for the derivation of the governing equation for resistive evolution of the toroidal current profile in a simplified tokamak model, the identification and calculation of the characteristic resistive time $\\tau_{R}$, and a comparison with the energy confinement time $\\tau_{E}$.\n\n### Step 1: Derivation of the Current Diffusion Equation\n\nWe begin with the provided fundamental equations from classical resistive magnetohydrodynamics (MHD) in SI units:\n1.  Faraday's Law of Induction: $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$\n2.  Ampère's Law (neglecting displacement current): $\\nabla \\times \\mathbf{B} = \\mu_{0}\\mathbf{J}$\n3.  Resistive Ohm's Law (for a plasma with no flow, considering only the component parallel to the magnetic field, which in this high-field context is the toroidal component): $E_{\\phi} = \\eta J_{\\phi}$\n\nThe system is a large-aspect-ratio tokamak, approximated as a straight, axisymmetric cylinder of minor radius $a$. We use cylindrical coordinates $(r, \\theta, \\phi)$, where $r$ is the radial coordinate, $\\theta$ is the poloidal (azimuthal) angle, and $\\phi$ corresponds to the toroidal (axial) direction. Axisymmetry implies that all quantities are independent of the poloidal angle $\\theta$, i.e., $\\frac{\\partial}{\\partial \\theta} = 0$. For a straight cylinder representing a large-aspect-ratio torus, variations along the axial direction are much slower than radial variations, so we can also take $\\frac{\\partial}{\\partial \\phi} \\approx 0$ for the equilibrium structure.\n\nThe problem specifies a toroidal current density $\\mathbf{J} = J_{\\phi}(r,t)\\hat{\\phi}$ and a corresponding toroidal electric field $\\mathbf{E} = E_{\\phi}(r,t)\\hat{\\phi}$.\n\nLet's apply Faraday's law to our electric field $\\mathbf{E} = E_{\\phi}(r,t)\\hat{\\phi}$. In cylindrical coordinates, the curl of a vector field $\\mathbf{A} = A_r\\hat{r} + A_{\\theta}\\hat{\\theta} + A_{\\phi}\\hat{\\phi}$ is:\n$$ \\nabla \\times \\mathbf{A} = \\left(\\frac{1}{r}\\frac{\\partial A_{\\phi}}{\\partial \\theta} - \\frac{\\partial A_{\\theta}}{\\partial \\phi}\\right)\\hat{r} + \\left(\\frac{\\partial A_r}{\\partial \\phi} - \\frac{\\partial A_{\\phi}}{\\partial r}\\right) \\hat{\\theta} + \\frac{1}{r}\\left(\\frac{\\partial(r A_{\\theta})}{\\partial r} - \\frac{\\partial A_r}{\\partial \\theta}\\right)\\hat{\\phi} $$\nFor $\\mathbf{E} = E_{\\phi}(r,t)\\hat{\\phi}$, with axisymmetry ($\\frac{\\partial}{\\partial \\theta}=0$) and the straight cylinder approximation ($\\frac{\\partial}{\\partial \\phi}=0$), this simplifies to:\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial E_{\\phi}}{\\partial r} \\hat{\\theta} $$\nSubstituting this into Faraday's law:\n$$ -\\frac{\\partial E_{\\phi}}{\\partial r} \\hat{\\theta} = -\\frac{\\partial \\mathbf{B}}{\\partial t} \\implies \\frac{\\partial \\mathbf{B}}{\\partial t} = \\frac{\\partial E_{\\phi}}{\\partial r} \\hat{\\theta} $$\nThis indicates that the changing electric field induces a time-varying poloidal magnetic field, $\\mathbf{B} = B_{\\theta}(r,t)\\hat{\\theta}$, which is consistent with the physics of a toroidal current.\n\nNext, we apply Ampère's law to the magnetic field $\\mathbf{B} = B_{\\theta}(r,t)\\hat{\\theta}$. The curl is:\n$$ \\nabla \\times \\mathbf{B} = \\frac{1}{r}\\frac{\\partial(r B_{\\theta})}{\\partial r} \\hat{\\phi} $$\nSubstituting this into Ampère's law, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$:\n$$ \\frac{1}{r}\\frac{\\partial(r B_{\\theta})}{\\partial r} \\hat{\\phi} = \\mu_0 J_{\\phi} \\hat{\\phi} \\implies \\frac{1}{r}\\frac{\\partial(r B_{\\theta})}{\\partial r} = \\mu_0 J_{\\phi} $$\n\nWe now have a system of two coupled partial differential equations linking $E_{\\phi}$, $B_{\\theta}$, and $J_{\\phi}$:\n(i) $\\frac{\\partial B_{\\theta}}{\\partial t} = \\frac{\\partial E_{\\phi}}{\\partial r}$\n(ii) $\\frac{1}{r}\\frac{\\partial(r B_{\\theta})}{\\partial r} = \\mu_0 J_{\\phi}$\n\nWe use Ohm's law, $E_{\\phi} = \\eta J_{\\phi}$, to eliminate $E_{\\phi}$. Since resistivity $\\eta$ is uniform:\n$$ \\frac{\\partial E_{\\phi}}{\\partial r} = \\frac{\\partial (\\eta J_{\\phi})}{\\partial r} = \\eta \\frac{\\partial J_{\\phi}}{\\partial r} $$\nSubstituting this into equation (i):\n(iii) $\\frac{\\partial B_{\\theta}}{\\partial t} = \\eta \\frac{\\partial J_{\\phi}}{\\partial r}$\n\nTo obtain a single equation for $J_{\\phi}$, we can eliminate $B_{\\theta}$. We take the time derivative of equation (ii) and the spatial operator $\\frac{1}{r}\\frac{\\partial}{\\partial r}(r \\cdot)$ of equation (iii), and then equate them.\nFrom (ii), taking $\\frac{\\partial}{\\partial t}$:\n$$ \\frac{\\partial}{\\partial t}\\left(\\frac{1}{r}\\frac{\\partial(r B_{\\theta})}{\\partial r}\\right) = \\mu_0 \\frac{\\partial J_{\\phi}}{\\partial t} $$\nAssuming sufficient smoothness, we can swap the order of differentiation on the left-hand side:\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial B_{\\theta}}{\\partial t}\\right) = \\mu_0 \\frac{\\partial J_{\\phi}}{\\partial t} $$\nNow, substitute $\\frac{\\partial B_{\\theta}}{\\partial t}$ from equation (iii):\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\eta \\frac{\\partial J_{\\phi}}{\\partial r}\\right) = \\mu_0 \\frac{\\partial J_{\\phi}}{\\partial t} $$\nSince $\\eta$ is a uniform constant, it can be pulled out of the derivative:\n$$ \\frac{\\eta}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial J_{\\phi}}{\\partial r}\\right) = \\mu_0 \\frac{\\partial J_{\\phi}}{\\partial t} $$\nRearranging gives the governing radial diffusion equation for the toroidal current profile $J_{\\phi}(r,t)$:\n$$ \\frac{\\partial J_{\\phi}}{\\partial t} = \\frac{\\eta}{\\mu_0} \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial J_{\\phi}}{\\partial r}\\right) $$\n\n### Step 2: Identification of the Resistive Relaxation Time $\\tau_{R}$\n\nThe derived equation is a form of the diffusion equation, $\\frac{\\partial f}{\\partial t} = D \\nabla^2 f$, where the magnetic diffusivity is $D = \\frac{\\eta}{\\mu_0}$. The characteristic time $\\tau$ for a diffusion process to occur over a characteristic length scale $L$ is given by dimensional analysis as $\\tau \\sim \\frac{L^2}{D}$.\nIn our problem, the diffusion process for the current profile occurs over the minor radius of the plasma column. Thus, the characteristic length scale is $L=a$. The resistive relaxation time $\\tau_{R}$ is therefore:\n$$ \\tau_{R} = \\frac{a^2}{D} = \\frac{\\mu_0 a^2}{\\eta} $$\n\n### Step 3: Numerical Calculation of $\\tau_{R}$\n\nWe are given the following values:\n- Minor radius: $a = 0.5\\,\\mathrm{m}$\n- Resistivity: $\\eta = 10^{-7}\\,\\Omega\\,\\mathrm{m}$\n- The vacuum permeability is a physical constant: $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$.\n\nSubstituting these values into the expression for $\\tau_{R}$:\n$$ \\tau_{R} = \\frac{(4\\pi \\times 10^{-7}\\,\\mathrm{H/m}) (0.5\\,\\mathrm{m})^2}{10^{-7}\\,\\Omega\\,\\mathrm{m}} $$\n$$ \\tau_{R} = \\frac{4\\pi \\times 10^{-7} \\times 0.25}{10^{-7}} \\,\\mathrm{s} $$\n$$ \\tau_{R} = 4\\pi \\times 0.25 \\,\\mathrm{s} = \\pi \\,\\mathrm{s} $$\nRounding to three significant figures:\n$$ \\tau_{R} \\approx 3.14\\,\\mathrm{s} $$\n\n### Step 4: Comparison and Justification\n\nWe are asked to compare the calculated resistive time $\\tau_R$ with the given energy confinement time $\\tau_{E} = 0.1\\,\\mathrm{s}$.\n- Resistive time: $\\tau_R \\approx 3.14\\,\\mathrm{s}$\n- Energy confinement time: $\\tau_E = 0.1\\,\\mathrm{s}$\n\nThe comparison shows that $\\tau_{R} \\gg \\tau_{E}$. Specifically, $\\tau_{R}$ is more than $30$ times larger than $\\tau_{E}$.\n\nThe physical meaning of this inequality is that the characteristic time scale for the evolution of the plasma current profile due to resistivity is much longer than the characteristic time scale for the evolution of the plasma's thermal energy (i.e., its temperature and density profiles). Therefore, when studying phenomena that occur on the energy transport timescale (like heat loss from the plasma core), the current profile can be assumed to be stationary or \"frozen\" in place. This justifies the use of a quasi-steady current profile in energy transport simulations and analysis, which is a standard and crucial simplification in fusion plasma physics.",
            "answer": "$$\\boxed{3.14}$$"
        },
        {
            "introduction": "Ohmic heating effectively transfers energy to a plasma as long as collisions can thermalize the accelerated electrons. This practice delves into a critical kinetic limitation of this process, exploring what happens when the accelerating force from the electric field begins to overwhelm the collisional drag. By deriving the Dreicer field from first principles, you will quantify the threshold for the generation of \"runaway\" electrons, a phenomenon that constrains tokamak operation and highlights the limits of a purely fluid description of plasma resistivity .",
            "id": "3711994",
            "problem": "A stationary, uniform, fully ionized deuterium plasma in a tokamak is driven by a toroidal loop voltage that produces a parallel electric field component $E_{\\parallel}$. The plasma electron density is $n_{e}=3\\times 10^{19}\\,\\mathrm{m^{-3}}$, the electron temperature is $T_{e}=1\\,\\mathrm{keV}$, and the Coulomb logarithm is $\\ln\\Lambda=15$. In the collisional (ohmic) regime, electrons experience small-angle Coulomb scattering that produces a velocity-space friction opposing acceleration by the electric field. The onset of primary (Dreicer) runaway production is governed by whether the electric force can overcome the collisional friction at the characteristic thermal speed. \n\nStarting from first principles of Coulomb collisional drag and using the thermal speed scale defined by equipartition, derive the expression for the Dreicer field $E_{D}$ by balancing the electric force with the collisional friction at the thermal speed. Then, evaluate $E_{D}$ for the given plasma parameters and form the dimensionless ratio\n$X=\\frac{E_{\\parallel}}{E_{D}}$\nfor a typical ohmic field $E_{\\parallel}=0.2\\,\\mathrm{V/m}$. Report the single quantity $X$. Round your final answer for $X$ to three significant figures. No other quantities should be reported. The intermediate Dreicer field $E_{D}$ may be computed in $\\mathrm{V/m}$ during your derivation but should not be part of the reported final answer.",
            "solution": "The problem requires the derivation of the Dreicer field, $E_D$, and the subsequent calculation of a dimensionless ratio, $X$. The derivation is to be based on a first-principles force balance for electrons in a plasma.\n\nThe physical principle stipulated is the balance between the accelerating force from a parallel electric field and the collisional friction (drag) force. The onset of primary runaway generation, which the Dreicer field characterizes, occurs when the electric force is sufficient to overcome the collisional drag on electrons. The problem specifies that this balance should be considered for electrons moving at the characteristic thermal speed.\n\nFirst, let us define the forces involved. An electron with elementary charge $-e$ in a parallel electric field $E_{\\parallel}$ experiences an electric force of magnitude:\n$$F_E = e E_{\\parallel}$$\n\nNext, we establish the collisional friction force, $F_{coll}$, experienced by an electron moving through the plasma. This force arises from the cumulative effect of small-angle Coulomb collisions with background electrons and ions. For an electron moving at a speed $v$ significantly greater than the thermal speed of the ions ($v \\gg v_{th,i}$) but comparable to the thermal speed of the electrons ($v \\sim v_{th,e}$), the friction force is the sum of drag from collisions with ions and with other electrons. A standard model for the drag force on a fast test particle in a plasma is given by:\n$$F_{coll}(v) = F_{e/i}(v) + F_{e/e}(v)$$\nFor a fully ionized deuterium plasma, the ions are deuterons (D$^+$), with charge number $Z_i = 1$. As the plasma is stationary and quasineutral, the ion density $n_i$ is equal to the electron density $n_e$. The drag force from ions on an electron moving at speed $v$ is:\n$$F_{e/i}(v) = \\frac{n_i Z_i^2 e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v^2} = \\frac{n_e e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v^2}$$\nThe drag force from the background electrons is of a similar form when $v$ is much larger than the thermal speed of the background electrons. While a more precise treatment involves the Chandrasekhar function to account for the velocity distribution of the background electrons, the problem's directive to use \"first principles\" and evaluate at the thermal speed suggests a simplified, yet physically motivated, model. We use the high-velocity approximation for the drag force, which is dominated by momentum exchange with stationary-like target particles. In this limit:\n$$F_{e/e}(v) \\approx \\frac{n_e e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v^2}$$\nThe total collisional drag force is the sum of these two contributions:\n$$F_{coll}(v) = F_{e/i}(v) + F_{e/e}(v) \\approx \\frac{2 n_e e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v^2} = \\frac{n_e e^4 \\ln\\Lambda}{2\\pi\\epsilon_0^2 m_e v^2}$$\nThis expression for drag, while derived from a high-velocity approximation, is to be evaluated at the electron thermal speed, $v_{th,e}$, as per the problem's instruction. The thermal speed is defined from the principle of equipartition of energy:\n$$\\frac{1}{2} m_e v_{th,e}^2 = k_B T_e$$\nwhere $m_e$ is the electron mass, $k_B$ is the Boltzmann constant, and $T_e$ is the electron temperature. This gives $v_{th,e}^2 = \\frac{2 k_B T_e}{m_e}$.\n\nSubstituting this into the expression for the drag force gives the friction at the thermal speed:\n$$F_{coll}(v_{th,e}) = \\frac{n_e e^4 \\ln\\Lambda}{2\\pi\\epsilon_0^2 m_e \\left(\\frac{2 k_B T_e}{m_e}\\right)} = \\frac{n_e e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 k_B T_e}$$\nThe Dreicer field, $E_D$, is the electric field for which the electric force precisely balances this collisional friction:\n$$e E_D = F_{coll}(v_{th,e})$$\nSolving for $E_D$ yields the expression:\n$$E_D = \\frac{n_e e^3 \\ln\\Lambda}{4\\pi\\epsilon_0^2 k_B T_e}$$\nThis is the standard expression for the Dreicer field.\n\nNow, we evaluate $E_D$ using the provided parameters:\n- Electron density, $n_e = 3 \\times 10^{19} \\, \\mathrm{m^{-3}}$\n- Electron temperature, $T_e = 1 \\, \\mathrm{keV}$. We must convert this to Joules. $1 \\, \\mathrm{eV} = 1.602177 \\times 10^{-19} \\, \\mathrm{J}$, so $T_e = 1000 \\, \\mathrm{eV} = 1.602177 \\times 10^{-16} \\, \\mathrm{J}$. This quantity is equivalent to $k_B T_e$ in the formula.\n- Coulomb logarithm, $\\ln\\Lambda = 15$\n\nWe also use the fundamental physical constants:\n- Elementary charge, $e = 1.602177 \\times 10^{-19} \\, \\mathrm{C}$\n- Permittivity of free space, $\\epsilon_0 = 8.854188 \\times 10^{-12} \\, \\mathrm{F/m}$\n\nSubstituting these values into the expression for $E_D$:\n$$E_D = \\frac{(3 \\times 10^{19} \\, \\mathrm{m^{-3}}) (1.602177 \\times 10^{-19} \\, \\mathrm{C})^3 (15)}{4\\pi (8.854188 \\times 10^{-12} \\, \\mathrm{F/m})^2 (1.602177 \\times 10^{-16} \\, \\mathrm{J})}$$\n$$E_D = \\frac{(3 \\times 10^{19}) (4.11231 \\times 10^{-57}) (15)}{4\\pi (7.83965 \\times 10^{-23}) (1.602177 \\times 10^{-16})} \\, \\mathrm{V/m}$$\n$$E_D = \\frac{1.85054 \\times 10^{-36}}{1.57833 \\times 10^{-37}} \\, \\mathrm{V/m} \\approx 11.7246 \\, \\mathrm{V/m}$$\n\nThe problem requires the calculation of the dimensionless ratio $X = \\frac{E_{\\parallel}}{E_D}$, given a typical ohmic field $E_{\\parallel} = 0.2 \\, \\mathrm{V/m}$.\n$$X = \\frac{0.2 \\, \\mathrm{V/m}}{11.7246 \\, \\mathrm{V/m}} \\approx 0.017058$$\nRounding this result to three significant figures, we get $X = 0.0171$. This can also be expressed in scientific notation.\n\n$$X = 1.71 \\times 10^{-2}$$\nThe small value of $X$ indicates that the applied ohmic field is much smaller than the Dreicer field, meaning that only electrons in the far tail of the Maxwellian distribution have a chance to become runaways under these conditions.",
            "answer": "$$\\boxed{1.71 \\times 10^{-2}}$$"
        },
        {
            "introduction": "In a real plasma, resistivity is not a given constant but depends sensitively on the electron temperature, which is itself determined by the ohmic heating power $P_\\Omega = \\eta J^2$. This practice challenges you to tackle this powerful nonlinear feedback loop, where current density and temperature profiles evolve in a tightly coupled manner. By constructing a numerical simulation to solve the coupled diffusion equations for heat and current, you will gain hands-on experience with the computational methods required to model one of the most fundamental processes governing the behavior of ohmically heated plasmas .",
            "id": "3711989",
            "problem": "A cylindrical, axisymmetric plasma column of minor radius $a$ carries a toroidal current density $J(r,t)$ and has electron temperature $T_e(r,t)$, both depending only on the minor-radius coordinate $r \\in [0,a]$ and time $t \\ge 0$. Consider the following fundamental base and modeling assumptions:\n\n- Fundamental base:\n  - Maxwell–Faraday law and Ampère's law with the Ohm's law in resistive magnetohydrodynamics: $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$, and $\\mathbf{E} = \\eta(T_e)\\,\\mathbf{J}$, where $\\mu_0$ is the magnetic permeability of free space and $\\eta$ is the electrical resistivity.\n  - Electron energy conservation: $(3/2)\\,n_e k_B\\,\\partial T_e/\\partial t = \\nabla \\cdot (\\kappa_e \\nabla T_e) + P_\\Omega$, where $n_e$ is the electron number density (assumed constant), $k_B$ is the Boltzmann constant, $\\kappa_e = n_e k_B \\chi_e$ is the electron heat conductivity with electron thermal diffusivity $\\chi_e$ (assumed constant), and $P_\\Omega = \\eta(T_e)\\,J^2$ is the volumetric Ohmic heating.\n  - Temperature-dependent Spitzer resistivity (hydrogenic plasma with effective charge $Z_\\text{eff}$ and Coulomb logarithm $\\ln \\Lambda$) taken as a well-tested formula: $\\eta(T_e) = C_\\eta\\,Z_\\text{eff}\\,\\ln \\Lambda\\,T_{\\text{keV}}^{-3/2}$, with $C_\\eta = 1.65 \\times 10^{-9}$ in $\\mathrm{\\Omega \\, m}$, and $T_{\\text{keV}}$ is the electron temperature measured in kiloelectron-volts.\n\n- Modeling in one-dimensional minor-radius geometry with axisymmetry:\n  - Approximate the resistive current diffusion by a scalar diffusion in $r$ with magnetic diffusivity $\\nu_m(T_e) = \\eta(T_e)/\\mu_0$ so that the evolution of $J(r,t)$ is governed by a diffusion operator in cylindrical coordinates.\n  - The electron temperature evolves by radial diffusion with diffusivity $\\chi_e$ plus Ohmic heating $P_\\Omega(r,t) = \\eta(T_e)\\,J^2$.\n\n- Boundary and initial conditions:\n  - Symmetry at the magnetic axis: $\\partial J/\\partial r|_{r=0} = 0$ and $\\partial T_e/\\partial r|_{r=0} = 0$.\n  - Edge constraints at the plasma boundary: $J(a,t) = 0$ and $T_e(a,t) = T_\\text{edge}$ (Dirichlet boundary).\n  - Initial conditions: $J(r,0) = J_0 \\,\\bigl(1 - (r/a)^2\\bigr)$ and $T_e(r,0) = T_0$.\n\nTasks:\n\n1) Show, starting from the fundamental base above, why a temperature-dependent resistivity $\\eta(T_e)$ causes the current diffusion equation to be nonlinear, and why the electron heat equation is also nonlinearly coupled to $J(r,t)$ through $P_\\Omega(r,t)$.\n\n2) Propose and implement a numerically stable, fully implicit, fixed-point iterative coupling within each time step (for example, Picard iteration) to advance from time $t^n$ to $t^{n+1}$, solving sequentially for $J^{n+1}(r)$ given the current estimate of $T_e^{n+1}(r)$, and then for $T_e^{n+1}(r)$ given the updated $J^{n+1}(r)$, until convergence. Use the following discretization requirements to make the results comparable across implementations:\n   - Spatial discretization: radius-only finite-volume scheme on a uniform grid with $N$ control volumes, with cell centers at $r_i = (i+1/2)\\,\\Delta r$, where $\\Delta r = a/N$ and $i \\in \\{0,1,\\dots,N-1\\}$; cell faces at $r_{i+1/2} = (i+1)\\,\\Delta r$ including $r_{-1/2} = 0$ and $r_{N+1/2} = a$.\n   - Time discretization: fully implicit Euler with time step $\\Delta t$.\n   - For a scalar field $u(r,t)$ obeying $\\partial_t u = \\frac{1}{r}\\partial_r\\bigl(r\\,D\\,\\partial_r u\\bigr) + S$, discretize the diffusion term by finite volumes using face fluxes $F_{i+1/2} = r_{i+1/2}\\,D_{i+1/2}\\,(u_{i+1}-u_i)/\\Delta r$, with the divergence approximated by $\\bigl(F_{i+1/2} - F_{i-1/2}\\bigr)/(r_i\\,\\Delta r)$. At $r=0$, the inner face contribution vanishes because $r_{-1/2} = 0$. At the outer boundary, use a Dirichlet condition $u(r_{N+1/2}) = u_\\text{b}$ by replacing the unknown outside value with the prescribed boundary value in the outer face flux. For variable coefficients $D$, use a harmonic face average $D_{i+1/2} = 2/(1/D_i + 1/D_{i+1})$ for $i \\in \\{0,\\dots,N-2\\}$, and for the outer boundary face use $D_{N-1}$.\n   - Nonlinear coupling: in each time step, iterate the following until convergence to a specified tolerance:\n     - Given the current iterate $T_e^{(k)}$, compute $\\eta^{(k)} = \\eta\\bigl(T_e^{(k)}\\bigr)$ and $D_J^{(k)} = \\eta^{(k)}/\\mu_0$. Solve implicitly for $J^{(k+1)}$ with diffusion coefficient $D_J^{(k)}$ and boundary conditions as specified.\n     - Compute Ohmic power $P_\\Omega^{(k+1)} = \\eta^{(k)} \\bigl(J^{(k+1)}\\bigr)^2$.\n     - Solve implicitly for $T_e^{(k+1)}$ with diffusion coefficient $\\chi_e$ and source $S_T^{(k+1)} = \\frac{2}{3 n_e k_B} P_\\Omega^{(k+1)}$, using the boundary condition $T_e(a,t) = T_\\text{edge}$.\n     - Stop when the maximum relative change across the grid in both $J$ and $T_e$ is less than a specified tolerance, or when a maximum number of inner iterations is reached. If the maximum is reached without meeting the tolerance, record that the step did not converge.\n\n3) Use the physical constants and conversions:\n   - $\\mu_0 = 4\\pi \\times 10^{-7}$ in $\\mathrm{H/m}$,\n   - $k_B = 1.380649 \\times 10^{-23}$ in $\\mathrm{J/K}$,\n   - $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}$ in $\\mathrm{J}$, hence $1\\,\\mathrm{keV} = 10^3\\,\\mathrm{eV} = 1.602176634 \\times 10^{-16}$ in $\\mathrm{J}$.\n   - Use $C_\\eta = 1.65 \\times 10^{-9}$ in $\\mathrm{\\Omega\\, m}$ in the Spitzer scaling $\\eta(T_e) = C_\\eta\\,Z_\\text{eff}\\,\\ln \\Lambda\\,T_{\\text{keV}}^{-3/2}$ with $T_{\\text{keV}} = k_B T_e / (1\\,\\mathrm{keV})$. To avoid singular behavior at very low temperature, regularize using $T_{\\text{keV,eff}} = \\max(T_{\\text{keV}}, 10^{-3})$ in the formula.\n\n4) Implement the algorithm as a complete program that solves the coupled system for the following test suite. For each case, report at final time $t = T_f$:\n   - The on-axis electron temperature $T_e(r=0,T_f)$ expressed in $\\mathrm{keV}$, rounded to six decimal places.\n   - The total plasma current $I_p(T_f) = \\int_0^a J(r,T_f)\\,2\\pi r\\,dr$ expressed in $\\mathrm{A}$, rounded to the nearest integer.\n   - A boolean indicating whether all time steps converged within the specified iteration limit and tolerance.\n\nTest suite (each tuple is ($a, N, \\Delta t, T_f, n_e, \\chi_e, Z_\\text{eff}, \\ln \\Lambda, J_0, T_0, T_\\text{edge}$)):\n- Case $1$: ($a=1.0\\,\\mathrm{m}$, $N=64$, $\\Delta t=0.002\\,\\mathrm{s}$, $T_f=0.2\\,\\mathrm{s}$, $n_e=5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$, $\\chi_e=1.0\\,\\mathrm{m^2/s}$, $Z_\\text{eff}=1.5$, $\\ln \\Lambda=17.0$, $J_0=1.0 \\times 10^{6}\\,\\mathrm{A/m^2}$, $T_0=1.0 \\times 10^{7}\\,\\mathrm{K}$, $T_\\text{edge}=1.0 \\times 10^{7}\\,\\mathrm{K}$).\n- Case $2$: ($a=1.0\\,\\mathrm{m}$, $N=64$, $\\Delta t=0.002\\,\\mathrm{s}$, $T_f=0.2\\,\\mathrm{s}$, $n_e=5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$, $\\chi_e=1.0\\,\\mathrm{m^2/s}$, $Z_\\text{eff}=2.0$, $\\ln \\Lambda=17.0$, $J_0=1.0 \\times 10^{6}\\,\\mathrm{A/m^2}$, $T_0=2.0 \\times 10^{6}\\,\\mathrm{K}$, $T_\\text{edge}=1.5 \\times 10^{6}\\,\\mathrm{K}$).\n- Case $3$: ($a=1.0\\,\\mathrm{m}$, $N=64$, $\\Delta t=0.002\\,\\mathrm{s}$, $T_f=0.05\\,\\mathrm{s}$, $n_e=5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$, $\\chi_e=1.0\\,\\mathrm{m^2/s}$, $Z_\\text{eff}=1.5$, $\\ln \\Lambda=17.0$, $J_0=1.0 \\times 10^{6}\\,\\mathrm{A/m^2}$, $T_0=1.0 \\times 10^{6}\\,\\mathrm{K}$, $T_\\text{edge}=1.0 \\times 10^{6}\\,\\mathrm{K}$).\n\nNumerical details:\n- Use a fixed-point tolerance of $10^{-6}$ on the maximum relative change applied to both $J$ and $T_e$ within each time step, and at most $50$ inner iterations per time step. Treat the failure to meet the tolerance within the iteration cap as non-convergence for that step.\n- Spatial integration for the total current should be performed using the finite-volume ring areas $2\\pi r_i \\Delta r$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three-element lists, each inner list corresponding to one test case in the order given above, with entries $[T_{\\text{center,keV}}, I_p, \\text{converged}]$. For example, a valid output string is of the form: $[[0.123456,123456,True],[\\dots],[\\dots]]$.",
            "solution": "The problem requires a two-part response: a theoretical explanation of the nonlinear coupling in the given plasma physics model, and the development of a numerical code to solve the system for specified test cases. The problem is deemed valid as it is scientifically grounded in resistive magnetohydrodynamics, well-posed with sufficient initial and boundary conditions, and provides a clear, objective set of tasks and parameters.\n\n### Part 1: Nonlinearity and Coupling of the Governing Equations\n\nThe evolution of the system is described by two coupled partial differential equations for the toroidal current density $J(r,t)$ and the electron temperature $T_e(r,t)$. We will analyze each equation to demonstrate the nature of the nonlinear coupling.\n\n**1. The Current Diffusion Equation**\n\nThe problem starts from fundamental laws: Faraday's law ($\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$), Ampère's law ($\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$), and Ohm's law ($\\mathbf{E} = \\eta(T_e)\\,\\mathbf{J}$). In an axisymmetric cylindrical geometry, we consider fields of the form $\\mathbf{J} = J(r,t)\\hat{\\mathbf{z}}$, $\\mathbf{E} = E_z(r,t)\\hat{\\mathbf{z}}$, and $\\mathbf{B} = B_\\theta(r,t)\\hat{\\boldsymbol{\\theta}}$.\n\nCombining these laws yields the magnetic field evolution:\n1.  From Faraday's law: $\\frac{\\partial E_z}{\\partial r} = \\frac{\\partial B_\\theta}{\\partial t}$.\n2.  From Ampère's law: $\\frac{1}{r}\\frac{\\partial (rB_\\theta)}{\\partial r} = \\mu_0 J$.\n3.  Taking the time derivative of Ampère's law and substituting Faraday's law gives: $\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial E_z}{\\partial r}\\right) = \\mu_0 \\frac{\\partial J}{\\partial t}$.\n4.  Substituting Ohm's law, $E_z = \\eta(T_e) J$, we obtain the full equation for current density evolution:\n    $$ \\mu_0 \\frac{\\partial J}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial}{\\partial r}(\\eta(T_e) J)\\right) $$\n    This equation can be expanded as $\\mu_0 \\frac{\\partial J}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\eta(T_e) \\frac{\\partial J}{\\partial r} + r J \\frac{\\partial \\eta(T_e)}{\\partial r}\\right)$.\n\nThe problem introduces a simplifying modeling assumption, reducing this to a standard diffusion form:\n$$ \\frac{\\partial J}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\nu_m(T_e) \\frac{\\partial J}{\\partial r}\\right) $$\nwhere $\\nu_m(T_e) = \\eta(T_e)/\\mu_0$ is the magnetic diffusivity.\n\nThe nonlinearity in this equation arises because the diffusion coefficient, $\\nu_m$, is not a constant but a function of the electron temperature, $\\nu_m(T_e)$. The Spitzer resistivity is given by $\\eta(T_e) \\propto T_e^{-3/2}$, so $\\nu_m(T_e) \\propto T_e^{-3/2}$. Since $T_e(r,t)$ is itself a solution to the second PDE in the system, the equation for $J$ is coupled to the equation for $T_e$. This dependence of a coefficient in one PDE on the solution of another PDE renders the system nonlinearly coupled.\n\n**2. The Electron Heat Equation**\n\nThe electron energy conservation equation is given as:\n$$ \\frac{3}{2}n_e k_B\\,\\frac{\\partial T_e}{\\partial t} = \\nabla \\cdot (\\kappa_e \\nabla T_e) + P_\\Omega $$\nWith constant electron thermal diffusivity $\\chi_e$, the electron heat conductivity is $\\kappa_e = n_e k_B \\chi_e$. In one-dimensional cylindrical coordinates, and rearranging for $\\partial T_e/\\partial t$, the equation becomes:\n$$ \\frac{\\partial T_e}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\chi_e \\frac{\\partial T_e}{\\partial r}\\right) + \\frac{2}{3 n_e k_B} P_\\Omega $$\nThe Ohmic heating source term is $P_\\Omega = \\eta(T_e)\\,J^2$.\n\nThis equation exhibits two forms of nonlinear coupling:\n1.  **Coupling to Current Density:** The source term is proportional to $J^2$. Since $J(r,t)$ is the solution of the current diffusion equation, the heat equation is explicitly coupled to it. Any change in the current profile directly impacts the heat source.\n2.  **Inherent Nonlinearity:** The source term also depends on the resistivity, $\\eta(T_e)$, which is a function of the temperature $T_e$ itself. The source term can be written as $S_T = \\frac{2}{3 n_e k_B}\\eta(T_e)J^2$. Since $\\eta(T_e) \\propto T_e^{-3/2}$, the equation takes the form $\\frac{\\partial T_e}{\\partial t} = \\dots + C(r,t) T_e^{-3/2}$, where $C(r,t)$ depends on $J^2$. The dependence of the source term on the solution variable $T_e$ makes the equation itself nonlinear, even if $J$ were a fixed profile.\n\nIn summary, the system consists of two parabolic PDEs where the diffusivity of one equation depends on the solution of the second, and the source term of the second equation depends on its own solution and the solution of the first. This constitutes a strongly, nonlinearly coupled system.\n\n### Part 2: Numerical Solution Strategy\n\nTo solve this coupled system, we implement the specified fully implicit, finite-volume scheme with a Picard iterative method for handling the nonlinearity within each time step.\n\n**Discretization**\nWe discretize the generic diffusion equation $\\frac{\\partial u}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r D \\frac{\\partial u}{\\partial r}\\right) + S$ on a uniform grid with $N$ cells. For cell $i$ (centered at $r_i$), the implicit Euler time-discretization combined with a finite-volume spatial discretization leads to a system of linear equations for the solution $u^{n+1}$ at the new time step. For each cell $i \\in \\{0, \\dots, N-1\\}$, the equation is:\n$$ \\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{1}{r_i \\Delta r} \\left( F_{i+1/2}^{n+1} - F_{i-1/2}^{n+1} \\right) + S_i^{n+1} $$\nwhere $F_{i+1/2} = r_{i+1/2} D_{i+1/2} \\frac{u_{i+1}-u_i}{\\Delta r}$ is the flux at the face between cells $i$ and $i+1$. This formulation results in a tridiagonal matrix system for the vector of unknowns $u_i^{n+1}$. Boundary conditions are incorporated as follows:\n-   **Center ($r=0$):** The zero-flux Neumann condition ($\\partial u/\\partial r = 0$) is naturally satisfied as the inner face radius $r_{-1/2}=0$, making the flux $F_{-1/2}$ vanish.\n-   **Edge ($r=a$):** The Dirichlet condition ($u(a,t)=u_b$) is imposed by modifying the equation for the last cell ($i=N-1$). The flux at the outer face $r_{N-1/2}=a$ is computed using the boundary value $u_b$, which contributes a known term to the right-hand side of the linear system.\n\n**Picard Iteration**\nWithin each time step from $t^n$ to $t^{n+1}$, we iterate to find self-consistent profiles for $J^{n+1}$ and $T_e^{n+1}$. Let $k$ be the iteration index.\n1.  Initialize with $J^{(0)} = J^n$ and $T_e^{(0)} = T_e^n$.\n2.  For $k=0, 1, 2, \\dots$ up to a maximum number of iterations:\n    a.  **Solve for $J^{(k+1)}$:** Calculate the magnetic diffusivity profile $D_J^{(k)} = \\eta(T_e^{(k)})/\\mu_0$. The face diffusivities $D_{J,i+1/2}^{(k)}$ are computed using the harmonic mean. Assemble and solve the tridiagonal system for $J^{(k+1)}$ using $D_J^{(k)}$.\n    b.  **Solve for $T_e^{(k+1)}$:** Compute the Ohmic heating source term $S_T^{(k+1)} = \\frac{2}{3n_e k_B} \\eta(T_e^{(k)}) (J^{(k+1)})^2$. The thermal diffusivity $\\chi_e$ is constant. Assemble and solve the tridiagonal system for $T_e^{(k+1)}$ with the source term $S_T^{(k+1)}$.\n    c.  **Check Convergence:** Compare the newly computed profiles $J^{(k+1)}$ and $T_e^{(k+1)}$ with the previous ones ($J^{(k)}$, $T_e^{(k)}$). If the maximum relative change for both fields across the grid is below a tolerance ($10^{-6}$), the iteration has converged for this time step.\n3.  If the iteration converges, we accept the solutions as $J^{n+1}$ and $T_e^{n+1}$ and advance to the next time step. If it fails to converge within the maximum iterations, we flag the time step as non-convergent.\n\nThis entire procedure is implemented in the Python code provided in the final answer, which simulates the plasma evolution for the three specified test cases and formats the output as required.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to solve the plasma diffusion problem for a suite of test cases.\n    \"\"\"\n    # Physical constants\n    MU_0 = 4.0 * np.pi * 1e-7  # H/m\n    K_B = 1.380649e-23  # J/K\n    KEV_IN_J = 1000.0 * 1.602176634e-19  # J\n    C_ETA = 1.65e-9  # Ohm.m for Spitzer resistivity\n\n    # Numerical parameters\n    TOL = 1e-6\n    MAX_ITER = 50\n\n    # Test suite\n    test_cases = [\n        # (a, N, dt, Tf, n_e, chi_e, Z_eff, ln_Lambda, J0, T0, T_edge)\n        (1.0, 64, 0.002, 0.2, 5.0e19, 1.0, 1.5, 17.0, 1.0e6, 1.0e7, 1.0e7),\n        (1.0, 64, 0.002, 0.2, 5.0e19, 1.0, 2.0, 17.0, 1.0e6, 2.0e6, 1.5e6),\n        (1.0, 64, 0.002, 0.05, 5.0e19, 1.0, 1.5, 17.0, 1.0e6, 1.0e6, 1.0e6),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(case, MU_0, K_B, KEV_IN_J, C_ETA, TOL, MAX_ITER)\n        results.append(result)\n\n    # Format output as specified\n    output_str = \"[\" + \",\".join([f\"[{res[0]:.6f},{int(round(res[1]))},{res[2]}]\" for res in results]) + \"]\"\n    print(output_str)\n\ndef run_simulation(params, mu_0, k_b, kev_in_j, c_eta, tol, max_iter):\n    \"\"\"\n    Runs a single simulation case.\n    \"\"\"\n    a, N, dt, Tf, n_e, chi_e, Z_eff, ln_Lambda, J0, T0, T_edge = params\n\n    # Grid setup\n    dr = a / N\n    r_centers = (np.arange(N) + 0.5) * dr\n    r_faces = (np.arange(N + 1)) * dr\n\n    # Initial conditions\n    J = J0 * (1 - (r_centers / a)**2)\n    T = np.full(N, T0, dtype=float)\n\n    # Time evolution loop\n    t = 0.0\n    all_steps_converged = True\n    num_steps = int(round(Tf / dt))\n\n    for _ in range(num_steps):\n        J_prev_t = J.copy()\n        T_prev_t = T.copy()\n        \n        # Picard iteration loop\n        converged = False\n        for k in range(max_iter):\n            J_prev_k = J.copy()\n            T_prev_k = T.copy()\n\n            # --- Solve for J^{k+1} ---\n            T_kev = T_prev_k * k_b / kev_in_j\n            T_kev_eff = np.maximum(T_kev, 1e-3)\n            eta_k = c_eta * Z_eff * ln_Lambda * T_kev_eff**(-1.5)\n            D_J_k = eta_k / mu_0\n            \n            # Harmonic mean for face diffusivities\n            D_J_faces = np.zeros(N)\n            D_J_faces[1:N] = 2.0 / (1.0/D_J_k[1:N] + 1.0/D_J_k[0:N-1])\n            D_J_faces[0] = D_J_k[0] # Not used due to r_face=0\n            # According to problem statement, D_N-1/2 = D_N-1\n            D_J_face_edge = D_J_k[N-1]\n\n            # Assemble tridiagonal system for J\n            A_J = np.zeros((3, N))\n            b_J = J_prev_t.copy()\n\n            # Lower diag (c_i)\n            A_J[2, 0:N-1] = - (dt / dr**2) * (r_faces[1:N] * D_J_faces[1:N] / r_centers[1:N])\n            # Upper diag (b_i)\n            A_J[0, 1:N] = - (dt / dr**2) * (r_faces[1:N] * D_J_faces[1:N] / r_centers[0:N-1])\n            \n            # Main diag (a_i)\n            main_diag_J = np.ones(N)\n            main_diag_J[0:N-1] += (dt / dr**2) * (r_faces[1:N] * D_J_faces[1:N] / r_centers[0:N-1])\n            main_diag_J[1:N] += (dt / dr**2) * (r_faces[1:N] * D_J_faces[1:N] / r_centers[1:N])\n            \n            # Boundary condition J(a)=0\n            main_diag_J[N-1] += (dt / dr**2) * (r_faces[N] * D_J_face_edge / r_centers[N-1])\n            # The RHS for J boundary is 0 because J_b=0.\n            A_J[1,:] = main_diag_J\n\n            J = solve_banded((1, 1), A_J, b_J)\n            \n            # --- Solve for T^{k+1} ---\n            P_ohm = eta_k * J**2\n            S_T = (2.0 / 3.0) / (n_e * k_b) * P_ohm\n\n            # Assemble tridiagonal system for T\n            A_T = np.zeros((3, N))\n            b_T = T_prev_t + dt * S_T\n\n            # Face diffusivity is constant chi_e\n            # Lower diag\n            A_T[2, 0:N-1] = - (dt / dr**2) * (r_faces[1:N] * chi_e / r_centers[1:N])\n            # Upper diag\n            A_T[0, 1:N] = - (dt / dr**2) * (r_faces[1:N] * chi_e / r_centers[0:N-1])\n            \n            # Main diag\n            main_diag_T = np.ones(N)\n            main_diag_T[0:N-1] += (dt / dr**2) * (r_faces[1:N] * chi_e / r_centers[0:N-1])\n            main_diag_T[1:N] += (dt / dr**2) * (r_faces[1:N] * chi_e / r_centers[1:N])\n            \n            # Boundary condition T(a)=T_edge\n            main_diag_T[N-1] += (dt / dr**2) * (r_faces[N] * chi_e / r_centers[N-1])\n            b_T[N-1] += (dt / dr**2) * (r_faces[N] * chi_e / r_centers[N-1]) * T_edge\n\n            A_T[1,:] = main_diag_T\n            \n            T = solve_banded((1, 1), A_T, b_T)\n\n            # Check convergence\n            # Add small epsilon to denominator to avoid division by zero\n            eps = 1e-12 \n            err_J = np.max(np.abs(J - J_prev_k) / (np.abs(J_prev_k) + eps))\n            err_T = np.max(np.abs(T - T_prev_k) / (np.abs(T_prev_k) + eps))\n\n            if err_J < tol and err_T < tol:\n                converged = True\n                break\n        \n        if not converged:\n            all_steps_converged = False\n        \n        t += dt\n\n    # Calculate final results\n    T_center_keV = T[0] * k_b / kev_in_j\n    Ip = np.sum(J * 2.0 * np.pi * r_centers * dr)\n    \n    return T_center_keV, Ip, all_steps_converged\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}