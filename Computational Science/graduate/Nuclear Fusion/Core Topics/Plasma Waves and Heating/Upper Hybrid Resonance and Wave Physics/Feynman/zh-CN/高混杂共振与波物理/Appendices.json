{
    "hands_on_practices": [
        {
            "introduction": "理解任何共振现象的第一步都是从基本原理出发推导出其存在的条件。第一个实践练习将挑战你从麦克斯韦方程组和冷等离子体模型出发，推导出上混杂共振的条件，在此条件下，垂直传播的非寻常波的折射率会发散。这个基础性的练习将巩固你对整个现象的理论基础的理解。",
            "id": "3724694",
            "problem": "考虑一个适用于磁约束聚变（MCF）的磁场中的均匀、无碰撞的冷电子-离子等离子体，其中静磁场 $\\mathbf{B}_{0}$ 沿 $\\hat{\\mathbf{z}}$ 轴方向，电子数密度 $n_{e}$ 在空间上均匀。设一个角频率为 $\\omega$ 的单色平面电磁波以波矢 $\\mathbf{k}$ 垂直于 $\\mathbf{B}_{0}$ 的方向传播，即 $\\mathbf{k} \\parallel \\hat{\\mathbf{x}}$。在冷等离子体、线性、傅里叶谐波机制下进行研究，时间依赖性为 $\\exp(-\\mathrm{i}\\,\\omega t)$，空间依赖性为 $\\exp(\\mathrm{i}\\,\\mathbf{k}\\cdot\\mathbf{r})$，忽略碰撞和热效应。定义电子等离子体频率 $\\omega_{pe}$ 和电子回旋频率 $\\omega_{ce}$ 分别为 $\\omega_{pe}^{2} = n_{e} e^{2}/(\\varepsilon_{0} m_{e})$ 和 $\\omega_{ce} = -e B_{0}/m_{e}$，其中 $e$ 是元电荷，$m_{e}$ 是电子质量，$\\varepsilon_{0}$ 是真空介电常数。假设存在单电荷的静止离子，其回旋频率 $\\omega_{ci}$ 满足 $\\omega_{ci} \\ll \\omega$。\n\n从麦克斯韦方程组和冷等离子体本构关系 $\\mathbf{J} = -\\mathrm{i}\\,\\omega \\varepsilon_{0}(\\boldsymbol{\\varepsilon}-\\mathbf{I})\\cdot\\mathbf{E}$ 出发，其中 $\\boldsymbol{\\varepsilon}$ 是磁化等离子体的冷等离子体介电张量，$\\mathbf{I}$ 是单位张量，使用平面波波动方程，求出非寻常模（X模）在垂直传播情况下的色散关系，并用Stix参数 $S$、$D$、$R$、$L$ 和 $P$ 表示。然后，确定该X模的折射率平方 $n^{2} \\equiv c^{2}k^{2}/\\omega^{2}$ 发散的条件，并找出相应的共振频率，即上混杂共振（UHR）。将你的最终答案表示为共振频率关于 $\\omega_{pe}$ 和 $\\omega_{ce}$ 的单个闭式解析表达式。不要进行数值计算。",
            "solution": "本问题要求推导在冷均匀等离子体中，垂直于静磁场传播的非寻常模（X模）的上混杂共振（UHR）频率。推导从麦克斯韦方程组和冷等离子体本构关系开始。\n\n在无源介质中，麦克斯韦旋度方程为：\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\varepsilon_0 \\mu_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\n$$\n假设时间依赖性为 $\\exp(-\\mathrm{i}\\,\\omega t)$ 的谐波形式，这些方程变为：\n$$\n\\nabla \\times \\mathbf{E} = \\mathrm{i}\\,\\omega \\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - \\mathrm{i}\\,\\omega \\varepsilon_0 \\mu_0 \\mathbf{E}\n$$\n使用本构关系 $\\mathbf{J} = -\\mathrm{i}\\,\\omega \\varepsilon_{0}(\\boldsymbol{\\varepsilon}-\\mathbf{I})\\cdot\\mathbf{E}$，其中 $\\boldsymbol{\\varepsilon}$ 是介电张量，$\\mathbf{I}$ 是单位张量，第二个方程变为：\n$$\n\\nabla \\times \\mathbf{B} = -\\mathrm{i}\\,\\omega \\varepsilon_0 \\mu_0 (\\boldsymbol{\\varepsilon}-\\mathbf{I})\\cdot\\mathbf{E} - \\mathrm{i}\\,\\omega \\varepsilon_0 \\mu_0 \\mathbf{E} = -\\mathrm{i}\\,\\omega \\varepsilon_0 \\mu_0 \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E}\n$$\n对第一个方程取旋度并代入第二个方程，我们得到电场 $\\mathbf{E}$ 的波动方程：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\mathrm{i}\\,\\omega (\\nabla \\times \\mathbf{B}) = \\mathrm{i}\\,\\omega (-\\mathrm{i}\\,\\omega \\varepsilon_0 \\mu_0 \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E}) = \\omega^2 \\varepsilon_0 \\mu_0 \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E}\n$$\n使用真空光速 $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$，上式为：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) - \\frac{\\omega^2}{c^2} \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E} = 0\n$$\n假设平面波解的形式为 $\\exp(\\mathrm{i}\\,\\mathbf{k}\\cdot\\mathbf{r})$，则del算符可替换为 $\\nabla \\rightarrow \\mathrm{i}\\,\\mathbf{k}$。波动方程变为一个代数方程：\n$$\n\\mathrm{i}\\,\\mathbf{k} \\times (\\mathrm{i}\\,\\mathbf{k} \\times \\mathbf{E}) - \\frac{\\omega^2}{c^2} \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E} = 0\n$$\n$$\n-\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) - \\frac{\\omega^2}{c^2} \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E} = 0\n$$\n使用矢量恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C}) - \\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$，我们有 $\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) = \\mathbf{k}(\\mathbf{k}\\cdot\\mathbf{E}) - k^2\\mathbf{E}$。波动方程为：\n$$\nk^2\\mathbf{E} - \\mathbf{k}(\\mathbf{k}\\cdot\\mathbf{E}) - \\frac{\\omega^2}{c^2} \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E} = 0\n$$\n两边同除以 $\\omega^2/c^2$ 并定义折射率 $n^2 = c^2k^2/\\omega^2$，我们得到：\n$$\nn^2\\mathbf{E} - \\frac{c^2}{\\omega^2}\\mathbf{k}(\\mathbf{k}\\cdot\\mathbf{E}) - \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E} = 0\n$$\n我们定义一个折射率矢量 $\\mathbf{n} = c\\mathbf{k}/\\omega$，因此 $n^2 = |\\mathbf{n}|^2$。方程变为：\n$$\nn^2\\mathbf{E} - \\mathbf{n}(\\mathbf{n}\\cdot\\mathbf{E}) - \\boldsymbol{\\varepsilon}\\cdot\\mathbf{E} = 0\n$$\n这可以写成一个矩阵方程：\n$$\n(\\boldsymbol{\\varepsilon} - n^2\\mathbf{I} + \\mathbf{n}\\mathbf{n}^T) \\cdot \\mathbf{E} = 0\n$$\n问题指定静磁场 $\\mathbf{B}_{0}$ 沿 $\\hat{\\mathbf{z}}$ 轴。对于由电子和静止离子组成的冷等离子体，介电张量 $\\boldsymbol{\\varepsilon}$ 由下式给出：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} S  -\\mathrm{i} D  0 \\\\ \\mathrm{i} D  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\nStix参数 $S$、$D$ 和 $P$ 用电子等离子体频率 $\\omega_{pe}$ 和电子回旋频率 $\\omega_{ce}$ 定义如下：\n$$\nS = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} \\quad , \\quad D = \\frac{\\omega_{ce}}{\\omega} \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} \\quad , \\quad P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2}\n$$\n波的传播方向垂直于 $\\mathbf{B}_{0}$，且 $\\mathbf{k} \\parallel \\hat{\\mathbf{x}}$。因此，$\\mathbf{k} = (k, 0, 0)$，折射率矢量为 $\\mathbf{n} = (n, 0, 0)$。项 $\\mathbf{n}\\mathbf{n}^T$ 变为：\n$$\n\\mathbf{n}\\mathbf{n}^T = \\begin{pmatrix} n \\\\ 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} n  0  0 \\end{pmatrix} = \\begin{pmatrix} n^2  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n将此式和 $\\boldsymbol{\\varepsilon}$ 代入波动方程矩阵，得到：\n$$\n\\left( \\begin{pmatrix} S  -\\mathrm{i} D  0 \\\\ \\mathrm{i} D  S  0 \\\\ 0  0  P \\end{pmatrix} - \\begin{pmatrix} n^2  0  0 \\\\ 0  n^2  0 \\\\ 0  0  n^2 \\end{pmatrix} + \\begin{pmatrix} n^2  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) \\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} S  -\\mathrm{i} D  0 \\\\ \\mathrm{i} D  S-n^2  0 \\\\ 0  0  P-n^2 \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n为使电场分量 $(E_x, E_y, E_z)$ 有非平庸解，该矩阵的行列式必须为零。\n$$\n\\det\\begin{pmatrix} S  -\\mathrm{i} D  0 \\\\ \\mathrm{i} D  S-n^2  0 \\\\ 0  0  P-n^2 \\end{pmatrix} = (P-n^2) [S(S-n^2) - (-\\mathrm{i}D)(\\mathrm{i}D)] = 0\n$$\n$$\n(P-n^2)(S(S-n^2) - D^2) = 0\n$$\n该方程为垂直于磁场传播的两个独立模式提供了两种色散关系。\n1.  寻常模（O模）：$P-n^2=0$，这给出 $n^2=P$。在此模式下，$E_z \\neq 0$ 而 $E_x=E_y=0$。电场平行于 $\\mathbf{B}_0$。\n2.  非寻常模（X模）：$S(S-n^2)-D^2=0$。在此模式下，$E_z=0$。电场垂直于 $\\mathbf{B}_0$。\n\n问题要求的是X模的色散关系。我们解出 $n^2$：\n$$\nS^2 - S n^2 - D^2 = 0 \\implies S n^2 = S^2 - D^2\n$$\n$$\nn^2 = \\frac{S^2 - D^2}{S}\n$$\n使用Stix参数 $R=S+D$ 和 $L=S-D$，分子可以写成 $S^2-D^2=(S+D)(S-D) = RL$。因此，X模的色散关系为：\n$$\nn^2 = \\frac{RL}{S}\n$$\n这就是用Stix参数表示的所需色散关系。\n\n共振定义为折射率 $n$ 趋于无穷大 ($n \\to \\infty$) 的条件，这意味着 $n^2 \\to \\infty$。从X模的色散关系 $n^2=(S^2-D^2)/S$ 来看，这种情况发生在分母趋于零时，前提是分子不同时趋于零。\n因此，共振条件为 $S=0$。\n我们必须验证当 $S=0$ 时，分子 $S^2-D^2$ 不为零。如果 $S=0$，分子变为 $-D^2$。$D$ 的表达式为 $D = \\frac{\\omega_{ce}}{\\omega} \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2}$。条件 $S=0$ 给出 $1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} = 0$，或 $\\omega^2 - \\omega_{ce}^2 = \\omega_{pe}^2$。将此代入 $D$ 的表达式中：\n$$\nD = \\frac{\\omega_{ce}}{\\omega} \\frac{\\omega_{pe}^2}{\\omega_{pe}^2} = \\frac{\\omega_{ce}}{\\omega}\n$$\n由于在磁化等离子体中 $\\omega_{ce}$ 通常不为零，所以 $D \\neq 0$。因此，分子 $-D^2$ 不为零，条件 $S=0$ 正确地确定了一个共振。\n\n我们现在求解共振条件 $S=0$ 以得到共振频率 $\\omega$。\n$$\nS = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} = 0\n$$\n$$\n1 = \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2}\n$$\n整理各项，我们得到：\n$$\n\\omega^2 - \\omega_{ce}^2 = \\omega_{pe}^2\n$$\n$$\n\\omega^2 = \\omega_{pe}^2 + \\omega_{ce}^2\n$$\n这个频率被称为上混杂共振（UHR）频率，通常表示为 $\\omega_{UH}$。我们取正根作为物理频率：\n$$\n\\omega = \\sqrt{\\omega_{pe}^2 + \\omega_{ce}^2}\n$$\n这是UHR频率的最终表达式。",
            "answer": "$$\\boxed{\\sqrt{\\omega_{pe}^{2} + \\omega_{ce}^{2}}}$$"
        },
        {
            "introduction": "在冷、无碰撞模型中推导出的理想共振是一个数学上的奇点。本实践将我们向物理现实更近一步，要求你量化在真实托卡马克边缘等离子体中展宽该共振的两个主要机制：碰撞和热运动。通过比较碰撞展宽和多普勒展宽的空间宽度，你将对在典型聚变相关场景中哪种物理效应占主导地位形成直观认识。",
            "id": "3724691",
            "problem": "一束冷非寻常模波被注入到托卡马克的边缘等离子体中，用于在高混杂共振（UHR）附近实现电子伯恩斯坦波的模式转换。假设边缘为平板几何，具有单调的电子密度梯度和可忽略的磁剪切。UHR由波频率与高混杂频率匹配的共振条件定义。考虑在UHR位置处的以下边缘参数：\n- 磁场 $B=2.5\\,\\mathrm{T}$（假设在共振层上为常数），\n- 电子密度 $n_e=3.0\\times 10^{19}\\,\\mathrm{m^{-3}}$，\n- 电子温度 $T_e=50\\,\\mathrm{eV}$（麦克斯韦电子），\n- UHR处的密度梯度长度 $L_n=\\left|\\dfrac{n_e}{dn_e/dx}\\right|=0.02\\,\\mathrm{m}$，\n- 库仑对数 $\\ln\\Lambda=15$，\n- 有效离子电荷态 $Z_{\\mathrm{eff}}=1$，\n- 忽略电子-中性粒子碰撞和整体等离子体流动；假设离子仅为高频响应提供准中性。\n\n假设入射波频率等于局域UHR频率，并用真空值 $k\\approx \\omega/c$ 来近似UHR附近的波数大小（这为多普勒展宽提供了一个保守估计，因为UHR附近的准静电特性会增大 $k$）。使用定义式 $\\omega_{pe}=\\sqrt{n_e e^2/(\\epsilon_0 m_e)}$、$\\omega_{ce}=eB/m_e$ 和 $\\omega_{UH}=\\sqrt{\\omega_{pe}^2+\\omega_{ce}^2}$。通过电子-离子碰撞频率处理碰撞展宽，通过电子速度沿波矢量方向的热展宽（即多普勒频移）处理多普勒展宽。通过在UHR位置附近对共振条件进行空间线性化，将频率宽度 $\\Delta\\omega$ 映射为UHR层的空间厚度 $\\Delta x$。\n\n常数：基本电荷 $e=1.602\\times 10^{-19}\\,\\mathrm{C}$，电子质量 $m_e=9.109\\times 10^{-31}\\,\\mathrm{kg}$，真空介电常数 $\\epsilon_0=8.854\\times 10^{-12}\\,\\mathrm{F/m}$，光速 $c=2.998\\times 10^{8}\\,\\mathrm{m/s}$，以及 $1\\,\\mathrm{eV}=1.602\\times 10^{-19}\\,\\mathrm{J}$。\n\n在这些条件下，哪个选项最能确定主导的展宽机制，并给出由此产生的UHR层厚度 $\\Delta x_c$（碰撞）和 $\\Delta x_D$（多普勒）的一致数量级值？\n\nA. 碰撞展宽占主导；$\\Delta x_c\\sim 1\\text{ 到 }2\\,\\mathrm{mm}$ 而 $\\Delta x_D\\sim 1\\,\\mu\\mathrm{m}$。\n\nB. 多普勒展宽占主导；$\\Delta x_D\\sim 1\\text{ 到 }2\\,\\mathrm{mm}$ 而 $\\Delta x_c\\sim 1\\,\\mu\\mathrm{m}$，且 $\\Delta x_D/\\Delta x_c\\sim 10^3$。\n\nC. 两种机制相当；$\\Delta x_c\\sim \\Delta x_D\\sim 0.1\\,\\mathrm{mm}$。\n\nD. 多普勒展宽占主导，但产生的层比碰撞展宽薄得多；$\\Delta x_D\\sim 10\\,\\mu\\mathrm{m}$ 而 $\\Delta x_c\\sim 1\\,\\mathrm{mm}$。",
            "solution": "首先验证问题陈述的科学合理性、清晰度和完整性。\n\n### 第1步：提取已知条件\n\n-   **物理参数：**\n    -   磁场：$B=2.5\\,\\mathrm{T}$\n    -   UHR处的电子密度：$n_e=3.0\\times 10^{19}\\,\\mathrm{m^{-3}}$\n    -   电子温度：$T_e=50\\,\\mathrm{eV}$\n    -   UHR处的密度梯度长度：$L_n=\\left|\\dfrac{n_e}{dn_e/dx}\\right|=0.02\\,\\mathrm{m}$\n    -   库仑对数：$\\ln\\Lambda=15$\n    -   有效离子电荷态：$Z_{\\mathrm{eff}}=1$\n-   **定义与近似：**\n    -   电子等离子体频率：$\\omega_{pe}=\\sqrt{n_e e^2/(\\epsilon_0 m_e)}$\n    -   电子回旋频率：$\\omega_{ce}=eB/m_e$\n    -   高混杂频率：$\\omega_{UH}=\\sqrt{\\omega_{pe}^2+\\omega_{ce}^2}$\n    -   入射波频率 $\\omega$ 等于局域UHR频率 $\\omega_{UH}$。\n    -   波数大小近似：$k\\approx \\omega/c$\n-   **假设：**\n    -   为实现模式转换而注入冷非寻常模波。\n    -   平板边缘几何，具有单调的电子密度梯度和可忽略的磁剪切。\n    -   离子提供准中性。\n    -   电子-中性粒子碰撞和整体等离子体流动可忽略。\n-   **常数：**\n    -   基本电荷：$e=1.602\\times 10^{-19}\\,\\mathrm{C}$\n    -   电子质量：$m_e=9.109\\times 10^{-31}\\,\\mathrm{kg}$\n    -   真空介电常数：$\\epsilon_0=8.854\\times 10^{-12}\\,\\mathrm{F/m}$\n    -   光速：$c=2.998\\times 10^{8}\\,\\mathrm{m/s}$\n    -   能量转换：$1\\,\\mathrm{eV}=1.602\\times 10^{-19}\\,\\mathrm{J}$\n-   **任务：**\n    -   通过电子-离子碰撞频率 $\\nu_{ei}$ 处理碰撞展宽。\n    -   通过电子速度的热展宽（即多普勒频移）处理多普勒展宽。\n    -   通过线性化共振条件，将频率宽度 $\\Delta\\omega$ 映射为空间厚度 $\\Delta x$。\n    -   确定主导的展宽机制，并估计由此产生的UHR层厚度 $\\Delta x_c$（碰撞）和 $\\Delta x_D$（多普勒）。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学基础：** 该问题植根于成熟的等离子体波理论，特别是关于与核聚变研究相关的磁化等离子体中波的传播和吸收。高混杂共振、碰撞阻尼和多普勒展宽的概念是该领域的基本原理。所提供的参数对于托卡马克边缘等离子体是符合实际的。\n-   **适定性：** 问题定义明确。它提供了所有必要的数据和常数，清楚地说明了所需的计算，并指定了要使用的模型和近似（例如，$k \\approx \\omega/c$，共振条件的线性化）。这种结构能够导出一个唯一且有意义的定量解。\n-   **客观性：** 问题陈述使用精确、定量和客观的科学语言表达，没有歧义或主观看法。\n\n### 第3步：结论与行动\n\n问题陈述是**有效**的，因为它是科学合理的、适定的和客观的。可以根据所提供的信息推导出解决方案。\n\n### 解题推导\n\n解决方案需要比较由碰撞展宽（$\\Delta x_c$）和多普勒展宽（$\\Delta x_D$）引起的高混杂共振（UHR）层的空间厚度。这涉及三个主要步骤：\n1.  计算每种展宽机制的特征频率宽度 $\\Delta\\omega_c$ 和 $\\Delta\\omega_D$。\n2.  根据共振条件建立频率宽度 $\\Delta\\omega$ 和空间宽度 $\\Delta x$ 之间的映射关系。\n3.  计算并比较 $\\Delta x_c$ 和 $\\Delta x_D$。\n\n**1. 基本等离子体频率的计算**\n首先，我们使用给定参数计算UHR位置的相关等离子体频率。\n电子回旋频率为：\n$$ \\omega_{ce} = \\frac{eB}{m_e} = \\frac{(1.602\\times 10^{-19}\\,\\mathrm{C})(2.5\\,\\mathrm{T})}{9.109\\times 10^{-31}\\,\\mathrm{kg}} \\approx 4.397\\times 10^{11}\\,\\mathrm{rad/s} $$\n电子等离子体频率的平方为：\n$$ \\omega_{pe}^2 = \\frac{n_e e^2}{\\epsilon_0 m_e} = \\frac{(3.0\\times 10^{19}\\,\\mathrm{m^{-3}})(1.602\\times 10^{-19}\\,\\mathrm{C})^2}{(8.854\\times 10^{-12}\\,\\mathrm{F/m})(9.109\\times 10^{-31}\\,\\mathrm{kg})} \\approx 9.513\\times 10^{22}\\,\\mathrm{rad^2/s^2} $$\n高混杂频率，等于波频率 $\\omega$，为：\n$$ \\omega = \\omega_{UH} = \\sqrt{\\omega_{pe}^2 + \\omega_{ce}^2} = \\sqrt{9.513\\times 10^{22} + (4.397\\times 10^{11})^2} = \\sqrt{9.513\\times 10^{22} + 1.933\\times 10^{23}} $$\n$$ \\omega = \\sqrt{2.884\\times 10^{23}}\\,\\mathrm{rad^2/s^2} \\approx 5.371\\times 10^{11}\\,\\mathrm{rad/s} $$\n\n**2. 展宽频率宽度的计算**\n\n**碰撞展宽（$\\Delta\\omega_c$）**\n碰撞展宽由电子-离子碰撞频率 $\\nu_{ei}$ 给出。对于 $Z_{\\mathrm{eff}}=1$ 的等离子体，使用标准公式：\n$$ \\nu_{ei} \\approx 2.91 \\times 10^{-12} \\frac{n_e [\\mathrm{m^{-3}}] Z_{\\mathrm{eff}} \\ln\\Lambda}{(T_e [\\mathrm{eV}])^{3/2}} \\,\\mathrm{s^{-1}} $$\n代入给定值：\n$$ \\Delta\\omega_c = \\nu_{ei} \\approx 2.91 \\times 10^{-12} \\frac{(3.0\\times 10^{19})(1)(15)}{(50)^{3/2}} = \\frac{1.3095 \\times 10^9}{50\\sqrt{50}} \\approx \\frac{1.3095 \\times 10^9}{353.55} $$\n$$ \\Delta\\omega_c \\approx 3.70 \\times 10^6 \\,\\mathrm{rad/s} $$\n\n**多普勒展宽（$\\Delta\\omega_D$）**\n多普勒展宽由 $\\Delta\\omega_D \\approx k v_{th,e}$ 给出，其中 $v_{th,e}$ 是电子热速度。\n电子热速度为：\n$$ v_{th,e} = \\sqrt{\\frac{k_B T_e}{m_e}} = \\sqrt{\\frac{(50\\,\\mathrm{eV}) \\times (1.602\\times 10^{-19}\\,\\mathrm{J/eV})}{9.109\\times 10^{-31}\\,\\mathrm{kg}}} = \\sqrt{\\frac{8.01\\times 10^{-18}\\,\\mathrm{J}}{9.109\\times 10^{-31}\\,\\mathrm{kg}}} \\approx 2.965\\times 10^6\\,\\mathrm{m/s} $$\n按照指示，波数 $k$ 用真空值近似：\n$$ k \\approx \\frac{\\omega}{c} = \\frac{5.371\\times 10^{11}\\,\\mathrm{rad/s}}{2.998\\times 10^8\\,\\mathrm{m/s}} \\approx 1791.5\\,\\mathrm{m^{-1}} $$\n那么，多普勒频率宽度为：\n$$ \\Delta\\omega_D \\approx k v_{th,e} \\approx (1791.5\\,\\mathrm{m^{-1}})(2.965\\times 10^6\\,\\mathrm{m/s}) \\approx 5.31 \\times 10^9\\,\\mathrm{rad/s} $$\n\n**展宽机制的比较**\n比较两个频率宽度：\n$$ \\frac{\\Delta\\omega_D}{\\Delta\\omega_c} = \\frac{5.31 \\times 10^9 \\,\\mathrm{rad/s}}{3.70 \\times 10^6 \\,\\mathrm{rad/s}} \\approx 1435 $$\n多普勒展宽比碰撞展宽大三个数量级以上。因此，**多普勒展宽是主导机制**。\n\n**3. 将频率宽度映射到空间宽度**\n\n共振条件为 $\\omega = \\omega_{UH}(x)$。由于只有密度 $n_e(x)$ 随位置 $x$ 显著变化（磁剪切可忽略），我们对 $\\omega_{UH}^2(x) = \\omega_{pe}^2(x) + \\omega_{ce}^2$ 对 $x$ 求导：\n$$ 2\\omega_{UH}\\frac{d\\omega_{UH}}{dx} = \\frac{d(\\omega_{pe}^2)}{dx} = \\frac{d}{dx}\\left(\\frac{n_e(x) e^2}{\\epsilon_0 m_e}\\right) = \\frac{\\omega_{pe}^2}{n_e}\\frac{dn_e}{dx} $$\n对应于频率宽度 $\\Delta\\omega$ 的空间宽度 $\\Delta x$ 通过线性化找到：$\\Delta\\omega \\approx \\left|\\frac{d\\omega_{UH}}{dx}\\right| \\Delta x$。\n$$ \\Delta x = \\Delta\\omega \\left/ \\left|\\frac{d\\omega_{UH}}{dx}\\right| \\right. = \\Delta\\omega \\left/ \\left| \\frac{\\omega_{pe}^2}{2\\omega_{UH}n_e}\\frac{dn_e}{dx} \\right| \\right. $$\n使用密度梯度长度的定义，$L_n = \\left|\\frac{n_e}{dn_e/dx}\\right|$：\n$$ \\Delta x = \\Delta\\omega \\frac{2\\omega_{UH}L_n}{\\omega_{pe}^2} $$\n让我们计算映射因子：\n$$ \\frac{2\\omega_{UH}L_n}{\\omega_{pe}^2} = \\frac{2(5.371\\times 10^{11}\\,\\mathrm{rad/s})(0.02\\,\\mathrm{m})}{9.513\\times 10^{22}\\,\\mathrm{rad^2/s^2}} \\approx 2.258\\times 10^{-13}\\,\\mathrm{s \\cdot m} $$\n现在我们可以求出空间宽度：\n碰撞空间宽度：\n$$ \\Delta x_c = \\Delta\\omega_c \\times (2.258\\times 10^{-13}\\,\\mathrm{s \\cdot m}) = (3.70 \\times 10^6\\,\\mathrm{rad/s}) \\times (2.258\\times 10^{-13}\\,\\mathrm{s \\cdot m}) $$\n$$ \\Delta x_c \\approx 8.35\\times 10^{-7}\\,\\mathrm{m} \\approx 0.84\\,\\mu\\mathrm{m} $$\n这在 $1\\,\\mu\\mathrm{m}$ 的数量级。\n\n多普勒空间宽度：\n$$ \\Delta x_D = \\Delta\\omega_D \\times (2.258\\times 10^{-13}\\,\\mathrm{s \\cdot m}) = (5.31 \\times 10^9\\,\\mathrm{rad/s}) \\times (2.258\\times 10^{-13}\\,\\mathrm{s \\cdot m}) $$\n$$ \\Delta x_D \\approx 1.20\\times 10^{-3}\\,\\mathrm{m} = 1.2\\,\\mathrm{mm} $$\n这在 $1\\text{ 到 }2\\,\\mathrm{mm}$ 的范围内。\n\n**结果总结：**\n-   **主导机制：** 多普勒展宽（$\\Delta\\omega_D \\gg \\Delta\\omega_c$）。\n-   **碰撞厚度：** $\\Delta x_c \\approx 0.84\\,\\mu\\mathrm{m}$（$1\\,\\mu\\mathrm{m}$ 的数量级）。\n-   **多普勒厚度：** $\\Delta x_D \\approx 1.2\\,\\mathrm{mm}$（$1\\text{ 到 }2\\,\\mathrm{mm}$ 的数量级）。\n-   **比率：** $\\Delta x_D / \\Delta x_c \\approx 1435 \\sim 10^3$。\n\n### 逐项分析选项\n\n**A. 碰撞展宽占主导；$\\Delta x_c\\sim 1\\text{ 到 }2\\,\\mathrm{mm}$ 而 $\\Delta x_D\\sim 1\\,\\mu\\mathrm{m}$。**\n该陈述错误地认定碰撞展宽为主导。它还交换了层厚度的计算值。\n**结论：错误。**\n\n**B. 多普勒展宽占主导；$\\Delta x_D\\sim 1\\text{ 到 }2\\,\\mathrm{mm}$ 而 $\\Delta x_c\\sim 1\\,\\mu\\mathrm{m}$，且 $\\Delta x_D/\\Delta x_c\\sim 10^3$。**\n该陈述正确地认定多普勒展宽是主导机制。计算出的多普勒厚度 $\\Delta x_D \\approx 1.2\\,\\mathrm{mm}$ 落在 $1\\text{ 到 }2\\,\\mathrm{mm}$ 范围内。计算出的碰撞厚度 $\\Delta x_c \\approx 0.84\\,\\mu\\mathrm{m}$ 在 $1\\,\\mu\\mathrm{m}$ 的数量级上。计算出的比率 $\\Delta x_D/\\Delta x_c \\approx 1435$ 在 $10^3$ 的数量级上。该陈述的所有部分都与推导一致。\n**结论：正确。**\n\n**C. 两种机制相当；$\\Delta x_c\\sim \\Delta x_D\\sim 0.1\\,\\mathrm{mm}$。**\n该陈述不正确。计算表明，多普勒展宽比碰撞展宽强约三个数量级，因此它们不具可比性。此外，$\\sim 0.1\\,\\mathrm{mm}$ 的估计厚度与任一计算值都不匹配。\n**结论：错误。**\n\n**D. 多普勒展宽占主导，但产生的层比碰撞展宽薄得多；$\\Delta x_D\\sim 10\\,\\mu\\mathrm{m}$ 而 $\\Delta x_c\\sim 1\\,\\mathrm{mm}$。**\n该陈述的第一部分是矛盾的。如果一个机制“占主导”，它会产生一个*更宽*的共振层，而不是更薄的。数值也与计算不一致，并且似乎被错误估计和交换了。\n**结论：错误。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "上混杂共振不仅是一个理论上有趣的课题，它更是一种强大的等离子体诊断工具。最后一个实践模拟了一个真实世界的应用场景，其中上混杂共振被用于反射计技术，这是一种测量电子密度分布的方法。你将开发一个完整的反演算法，从正向模型到不确定性量化，将共振的物理原理转化为一种实用的测量手段。",
            "id": "3724633",
            "problem": "在托卡马克边缘区域进行多频扫描以探测高混杂共振（UHR）。发射一束近乎垂直于磁场的电磁波，该波在满足UHR条件的径向位置发生反射。目标是利用测得的反射半径和频率重建边缘区域的电子密度剖面 $n_e(r)$，并量化由测量误差引起的不确定度传播。推导和算法必须从基本定律和经过充分检验的公式开始，不依赖于目标量的简化表达式。\n\n使用以下基本原理：\n- 物质中的麦克斯韦方程组以及磁化电子等离子体的冷等离子体介电张量。\n- 电子回旋频率 $\\omega_{ce} = e B / m_e$，其中 $e$ 是元电荷，$B$ 是磁场强度大小，$m_e$ 是电子质量。\n- 电子等离子体频率 $\\omega_{pe} = \\sqrt{n_e e^2 / (\\epsilon_0 m_e)}$，其中 $\\epsilon_0$ 是真空介电常数。\n- 对于在冷磁化等离子体中垂直于磁场传播的波，非寻常模（X模）色散关系涉及介电张量元素，当垂直折射率发散时，发生共振反射。\n\n假设托卡马克中平面上的磁场遵循 $B(r) = B_0 R_0 / r$（大半径标度），其中 $B_0$ 是磁轴大半径 $R_0$ 处的磁场，$r$ 是外侧中平面处的大半径。\n\n任务：\n1. 从冷等离子体介电响应出发，推导X模垂直传播的共振条件，并获得将波的角频率 $\\omega = 2\\pi f$ 和半径 $r$ 与局部电子密度 $n_e(r)$ 联系起来的正向模型。所有关系式均以国际单位制（SI）表示。\n2. 推导 $n_e(r)$ 的一阶不确定度传播，作为 $f$、$B_0$ 和 $r$ 中独立测量不确定度的函数。使用线性化和对 $\\omega$、$B_0$ 和 $r$ 的偏导数，将它们视为具有给定标准差的独立随机变量。\n3. 设计并实现一个正则化反演方案，以在指定的径向网格 $r_{\\text{grid}}$ 上重建平滑的 $n_e(r)$。对逐点估计值 $n_e(r_i)$ 使用加权最小二乘拟合，权重等于第2部分得到的方差的倒数，并对一阶差分施加吉洪诺夫（Tikhonov）二次平滑度惩罚。设正则化强度为一个无量纲因子 $\\lambda'$，并通过数据的总权重来缩放有效惩罚，以保持量纲一致性。\n4. 使用通过估计量的线性化传播计算重建剖面的后验协方差，并报告网格点处的一倍标准差不确定度。\n\n物理单位和输出：\n- 频率 $f$ 以 $\\text{Hz}$ 为单位提供。\n- 半径 $r$ 以 $\\text{m}$ 为单位提供。\n- 磁场参数以 $\\text{T}$ 为单位提供。\n- 重建的密度必须以 $\\text{m}^{-3}$ 为单位报告，并四舍五入到三位有效数字。\n- 不确定度必须以 $\\text{m}^{-3}$ 为单位报告，并四舍五入到三位有效数字。\n\n测试套件：\n为以下三组参数的测试案例提供结果。在每个案例中，使用给定的测量反射半径和频率、磁场参数以及不确定度。重建网格已指定，正则化因子以 $\\lambda'$ 形式给出。\n\n- 案例A（理想情况）：\n  - $B_0 = 2.1\\ \\text{T}$，$R_0 = 1.7\\ \\text{m}$。\n  - 测量的半径 $r_i$（单位：$\\text{m}$）：$[1.80, 1.85, 1.90, 1.95, 2.00]$。\n  - 测量的频率 $f_i$（单位：$\\text{Hz}$）：$[7.835\\times 10^{10}, 7.156\\times 10^{10}, 6.586\\times 10^{10}, 6.129\\times 10^{10}, 5.746\\times 10^{10}]$。\n  - 标准差：$\\sigma_f = 5.0\\times 10^{7}\\ \\text{Hz}$，$\\sigma_r = 2.0\\times 10^{-3}\\ \\text{m}$，$\\sigma_{B_0} = 1.0\\times 10^{-2}\\ \\text{T}$。\n  - 正则化因子：$\\lambda' = 0.01$。\n  - 重建网格 $r_{\\text{grid}}$（单位：$\\text{m}$）：$[1.80, 1.85, 1.90, 1.95, 2.00]$。\n\n- 案例B（边界主导，靠近 $f \\approx f_{ce}$ 的低密度区）：\n  - $B_0 = 2.3\\ \\text{T}$，$R_0 = 1.6\\ \\text{m}$。\n  - 测量的半径 $r_i$（单位：$\\text{m}$）：$[2.10, 2.15, 2.20]$。\n  - 测量的频率 $f_i$（单位：$\\text{Hz}$）：$[5.918\\times 10^{10}, 5.447\\times 10^{10}, 5.096\\times 10^{10}]$。\n  - 标准差：$\\sigma_f = 1.0\\times 10^{8}\\ \\text{Hz}$，$\\sigma_r = 3.0\\times 10^{-3}\\ \\text{m}$，$\\sigma_{B_0} = 1.5\\times 10^{-2}\\ \\text{T}$。\n  - 正则化因子：$\\lambda' = 0.05$。\n  - 重建网格 $r_{\\text{grid}}$（单位：$\\text{m}$）：$[2.10, 2.15, 2.20]$。\n\n- 案例C（数据稀疏，噪声较高）：\n  - $B_0 = 1.9\\ \\text{T}$，$R_0 = 1.9\\ \\text{m}$。\n  - 测量的半径 $r_i$（单位：$\\text{m}$）：$[1.95, 2.00]$。\n  - 测量的频率 $f_i$（单位：$\\text{Hz}$）：$[6.308\\times 10^{10}, 5.938\\times 10^{10}]$。\n  - 标准差：$\\sigma_f = 2.0\\times 10^{8}\\ \\text{Hz}$，$\\sigma_r = 5.0\\times 10^{-3}\\ \\text{m}$，$\\sigma_{B_0} = 2.0\\times 10^{-2}\\ \\text{T}$。\n  - 正则化因子：$\\lambda' = 0.20$。\n  - 重建网格 $r_{\\text{grid}}$（单位：$\\text{m}$）：$[1.95, 2.00]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例的结果本身必须是一个包含两个子列表的列表：第一个子列表包含在 $r_{\\text{grid}}$ 上重建的 $n_e$ 值（单位：$\\text{m}^{-3}$），四舍五入到三位有效数字；第二个子列表包含相应的一倍标准差不确定度（单位：$\\text{m}^{-3}$），四舍五入到三位有效数字。例如：$[[[n_1,n_2,\\ldots],[\\sigma_1,\\sigma_2,\\ldots]],[[\\ldots],[\\ldots]],[[\\ldots],[\\ldots]]]$。",
            "solution": "从高混杂共振（UHR）反射重建电子密度剖面 $n_e(r)$ 的过程，可从冷磁化等离子体中波传播的基本原理推导得出，适用于近乎垂直于磁场发射的波。\n\n从麦克斯韦方程组和磁化电子等离子体的冷等离子体介电响应开始。在均匀磁场 $\\mathbf{B}$ 中，冷等离子体介电张量可以用标准元素 $S$、$D$ 和 $P$ 来表示。对于垂直于 $\\mathbf{B}$ 的传播，非寻常模（X模）的色散关系可以用右旋和左旋响应函数 $R$ 和 $L$ 以及对称分量 $S$ 来表示。一个经过充分检验的表述是，X模的折射率 $n_\\perp^2$ 满足\n$$\nn_\\perp^2 = \\frac{RL}{S},\n$$\n其中\n$$\nR = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + \\omega_{ce})}, \\quad\nL = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega - \\omega_{ce})}, \\quad\nS = \\frac{R+L}{2}.\n$$\n反射性源于垂直折射率发散的共振层，这发生在分母 $S$ 为零时。对于垂直传播，令 $S=0$ 可得\n$$\n1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} = 0,\n$$\n这意味着高混杂共振条件\n$$\n\\omega^2 = \\omega_{pe}^2 + \\omega_{ce}^2.\n$$\n该条件是确定冷磁化等离子体中角频率为 $\\omega = 2\\pi f$ 的波的反射位置的物理机制。\n\n给定在托卡马克外侧中平面上由以下模型描述的磁场剖面\n$$\nB(r) = \\frac{B_0 R_0}{r},\n$$\n电子回旋频率为\n$$\n\\omega_{ce}(r) = \\frac{e B(r)}{m_e} = \\frac{e B_0 R_0}{m_e r},\n$$\n而电子等离子体频率与局部密度的关系为\n$$\n\\omega_{pe}(r) = \\sqrt{\\frac{n_e(r) e^2}{\\epsilon_0 m_e}}.\n$$\n将这些表达式与UHR条件结合，得到将测量的波频率 $f$ 和反射半径 $r$ 映射到局部电子密度的正向模型：\n$$\nn_e(r) = \\frac{\\epsilon_0 m_e}{e^2} \\left[(2\\pi f)^2 - \\omega_{ce}(r)^2\\right] = \\frac{\\epsilon_0 m_e}{e^2} \\left[(2\\pi f)^2 - \\left(\\frac{e B_0 R_0}{m_e r}\\right)^2\\right].\n$$\n该关系式完全以国际单位制（SI）表示，$f$ 的单位是 $\\text{Hz}$，$r$ 是 $\\text{m}$，$B_0$ 是 $\\text{T}$，$n_e$ 是 $\\text{m}^{-3}$。\n\n对于不确定度传播，将 $f$、$B_0$ 和 $r$ 视为具有给定标准差 $\\sigma_f$、$\\sigma_{B_0}$ 和 $\\sigma_r$ 的独立随机变量。定义常数\n$$\nK \\equiv \\frac{\\epsilon_0 m_e}{e^2},\n$$\n并记 $\\omega = 2\\pi f$ 和 $\\Omega_{ce}(r) = \\omega_{ce}(r) = \\frac{e B_0 R_0}{m_e r}$。函数为\n$$\nn_e(r) = K\\left(\\omega^2 - \\Omega_{ce}^2(r)\\right).\n$$\n计算线性不确定度传播所需的偏导数：\n$$\n\\frac{\\partial n_e}{\\partial \\omega} = 2 K \\omega,\n$$\n$$\n\\frac{\\partial n_e}{\\partial B_0} = -2 K \\left(\\frac{e}{m_e}\\right)^2 B(r) \\frac{R_0}{r} = -2 K \\left(\\frac{e}{m_e}\\right)^2 \\frac{B_0 R_0^2}{r^2},\n$$\n其中 $B(r) = \\frac{B_0 R_0}{r}$，以及\n$$\n\\frac{\\partial n_e}{\\partial r} = -2 K \\left(\\frac{e}{m_e}\\right)^2 B(r) \\frac{\\partial B(r)}{\\partial r} \\left/\\frac{\\partial B(r)}{\\partial B}\\right. = 2 K \\left(\\frac{e}{m_e}\\right)^2 \\frac{(B_0 R_0)^2}{r^3}.\n$$\n一个更直接的计算来自于对 $-K \\left(\\frac{e}{m_e}\\right)^2 B(r)^2$ 关于 $r$ 求导，其中 $B(r) = \\frac{B_0 R_0}{r}$ 得到 $\\partial B/\\partial r = -\\frac{B_0 R_0}{r^2}$ 且 $\\partial n_e/\\partial r = 2 K \\left(\\frac{e}{m_e}\\right)^2 \\frac{(B_0 R_0)^2}{r^3}$。在测量点 $(f, r)$ 处 $n_e$ 的标准差则为\n$$\n\\sigma_{n_e} = \\sqrt{\\left(\\frac{\\partial n_e}{\\partial \\omega}\\right)^2 (2\\pi \\sigma_f)^2 + \\left(\\frac{\\partial n_e}{\\partial B_0}\\right)^2 \\sigma_{B_0}^2 + \\left(\\frac{\\partial n_e}{\\partial r}\\right)^2 \\sigma_r^2 }.\n$$\n\n为了在网格 $r_{\\text{grid}}$ 上重建平滑的剖面 $n_e(r)$，使用带有一阶差分吉洪诺夫（Tikhonov）正则化的加权最小二乘拟合。设 $y_i$ 是在测量半径 $r_i$ 处由正向模型计算的逐点密度估计值，$\\sigma_i$ 是由上述传播公式计算得到的标准差。构建一个线性插值算子 $A$，它通过在相邻网格点之间进行局部线性插值，将网格值 $x = [n_e(r_{g,1}), \\ldots, n_e(r_{g,M})]^T$ 映射到测量位置 $r_i$，$A x \\approx n_e(r_i)$。设 $W = \\mathrm{diag}(w_i)$ 是对角权重矩阵，其中 $w_i = 1/\\sigma_i^2$。设 $L$ 是一个尺寸为 $(M-1)\\times M$ 的一阶差分算子，其行实现 $x_{j+1}-x_j$ 以惩罚粗糙度。构建正规方程\n$$\nM = A^T W A + \\lambda_{\\mathrm{eff}} L^T L, \\quad b = A^T W y,\n$$\n其中无量纲正则化因子 $\\lambda'$ 通过数据权重进行缩放\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda' \\sum_i w_i.\n$$\n求解 $M x = b$ 以获得重建的剖面 $x$。对于重建剖面的不确定度，使用线性化估计量\n$$\nx = \\left(A^T W A + \\lambda_{\\mathrm{eff}} L^T L\\right)^{-1} A^T W y,\n$$\n其相对于数据 $y$ 的雅可比矩阵为\n$$\nJ = \\left(A^T W A + \\lambda_{\\mathrm{eff}} L^T L\\right)^{-1} A^T W.\n$$\n由于 $\\mathrm{Cov}(y) = \\mathrm{diag}(\\sigma_i^2)$，$x$ 的协方差为\n$$\n\\mathrm{Cov}(x) = J\\, \\mathrm{Cov}(y)\\, J^T,\n$$\n网格点处的一倍标准差不确定度为 $\\sigma_{x_j} = \\sqrt{\\left[\\mathrm{Cov}(x)\\right]_{jj}}$。\n\n各案例的算法摘要：\n- 计算 $B(r_i) = B_0 R_0 / r_i$，然后计算 $n_e(r_i) = K[(2\\pi f_i)^2 - (e B(r_i)/m_e)^2]$。\n- 使用偏导数和给定的测量不确定度计算 $\\sigma_{n_e}(r_i)$。\n- 通过从 $r_{\\text{grid}}$ 到 $r_i$ 的线性插值构建 $A$；如果 $r_i$ 与 $r_{\\text{grid}}$ 重合，则 $A$ 是单位矩阵。\n- 用 $\\lambda_{\\mathrm{eff}} = \\lambda' \\sum_i w_i$ 从正规方程中计算 $x$。\n- 通过雅可比矩阵 $J$ 计算 $\\mathrm{Cov}(x)$ 并报告 $\\sigma_{x_j}$。\n- 将 $x_j$ 和 $\\sigma_{x_j}$ 四舍五入到三位有效数字，并按指定输出格式报告。\n\n程序将为提供的三个测试案例实施上述步骤。它将生成单行输出，包含一个含三个条目（每个案例一个）的列表，其中每个条目是一个含两个子列表的列表：在 $r_{\\text{grid}}$ 上重建的密度（单位：$\\text{m}^{-3}$），四舍五入到三位有效数字；以及相应的一倍标准差不确定度（单位：$\\text{m}^{-3}$），四舍五入到三位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nEPS0 = 8.854187817e-12   # vacuum permittivity (F/m)\nME = 9.1093837015e-31    # electron mass (kg)\nE = 1.602176634e-19      # elementary charge (C)\nTWO_PI = 2.0 * np.pi\nK_CONST = EPS0 * ME / (E**2)  # K = eps0 * me / e^2\n\ndef magnetic_field(r, B0, R0):\n    \"\"\"Magnetic field at radius r in tokamak midplane with 1/R scaling.\"\"\"\n    return B0 * R0 / r\n\ndef ne_from_freq(f_hz, r, B0, R0):\n    \"\"\"Compute local electron density from UHR condition: ne = K[(2πf)^2 - (eB/me)^2].\"\"\"\n    omega = TWO_PI * f_hz\n    B = magnetic_field(r, B0, R0)\n    omega_ce = E * B / ME\n    ne = K_CONST * (omega**2 - omega_ce**2)\n    # Physical non-negativity clamp (in case of slight measurement-induced negative)\n    return max(ne, 0.0)\n\ndef sigma_ne(f_hz, r, B0, R0, sigma_f_hz, sigma_r, sigma_B0):\n    \"\"\"Linear uncertainty propagation for ne with respect to omega, r, and B0.\"\"\"\n    omega = TWO_PI * f_hz\n    sigma_omega = TWO_PI * sigma_f_hz\n    # Derivatives\n    dne_domega = 2.0 * K_CONST * omega\n    # B(r) and derivative contributions\n    # ∂ne/∂B0 = -2 K (e/m_e)^2 * B(r) * (R0/r) = -2 K (e/m_e)^2 * B0 * R0^2 / r^2\n    dne_dB0 = -2.0 * K_CONST * (E / ME)**2 * (B0 * (R0**2) / (r**2))\n    # ∂ne/∂r = 2 K (e/m_e)^2 (B0 R0)^2 / r^3\n    dne_dr = 2.0 * K_CONST * (E / ME)**2 * ((B0 * R0)**2) / (r**3)\n    var = (dne_domega**2) * (sigma_omega**2) + (dne_dB0**2) * (sigma_B0**2) + (dne_dr**2) * (sigma_r**2)\n    return np.sqrt(var)\n\ndef build_interpolation_matrix(r_meas, r_grid):\n    \"\"\"\n    Build linear interpolation matrix A such that A x ≈ n(r_meas),\n    where x are values on r_grid. If r_meas coincide with grid points,\n    A becomes an identity selector.\n    \"\"\"\n    r_meas = np.asarray(r_meas)\n    r_grid = np.asarray(r_grid)\n    N = r_meas.size\n    M = r_grid.size\n    A = np.zeros((N, M))\n    # For each measurement radius, find bracketing grid points\n    for i, r in enumerate(r_meas):\n        # If exactly equals to a grid point\n        idx_exact = np.where(np.isclose(r_grid, r, rtol=0, atol=1e-12))[0]\n        if idx_exact.size > 0:\n            A[i, idx_exact[0]] = 1.0\n            continue\n        # Find interval\n        if r = r_grid[0]:\n            # Extrapolate at lower end: clamp to first grid point\n            A[i, 0] = 1.0\n            continue\n        if r >= r_grid[-1]:\n            # Extrapolate at upper end: clamp to last grid point\n            A[i, -1] = 1.0\n            continue\n        # Find j such that r_grid[j]  r  r_grid[j+1]\n        j = np.searchsorted(r_grid, r) - 1\n        r0 = r_grid[j]\n        r1 = r_grid[j+1]\n        w1 = (r - r0) / (r1 - r0)\n        w0 = 1.0 - w1\n        A[i, j] = w0\n        A[i, j + 1] = w1\n    return A\n\ndef first_difference_matrix(M):\n    \"\"\"Build first-difference operator L of size (M-1) x M such that (L x)_j = x_{j+1} - x_j.\"\"\"\n    L = np.zeros((M - 1, M))\n    for j in range(M - 1):\n        L[j, j] = -1.0\n        L[j, j + 1] = 1.0\n    return L\n\ndef solve_regularized(A, y, sigma, lambda_prime):\n    \"\"\"\n    Solve weighted least squares with Tikhonov first-difference regularization.\n    Returns reconstructed x and covariance Cov(x).\n    \"\"\"\n    # Weights\n    w = 1.0 / (sigma**2)\n    W = np.diag(w)\n    L = first_difference_matrix(A.shape[1])\n    # Scale lambda_eff by the total weight to keep relative magnitude\n    lambda_eff = lambda_prime * np.sum(w)\n    # Normal equations\n    ATA = A.T @ W @ A\n    LTL = L.T @ L\n    M = ATA + lambda_eff * LTL\n    b = A.T @ W @ y\n    # Solve for x\n    x = np.linalg.solve(M, b)\n    # Jacobian J = M^{-1} A^T W\n    J = np.linalg.solve(M, A.T @ W)\n    # Cov(y) is diagonal diag(sigma^2)\n    Cov_y = np.diag(sigma**2)\n    Cov_x = J @ Cov_y @ J.T\n    return x, Cov_x\n\ndef round_sigfig(x, sigfigs=3):\n    \"\"\"Round a float to a given number of significant figures and return float.\"\"\"\n    if x == 0 or not np.isfinite(x):\n        return float(x)\n    # Determine decimal places\n    mags = np.floor(np.log10(abs(x)))\n    decimals = int(sigfigs - 1 - mags)\n    # Use numpy rounding; convert back to float\n    return float(np.round(x, decimals))\n\ndef process_case(B0, R0, r_meas, f_meas, sigma_f, sigma_r, sigma_B0, lambda_prime, r_grid):\n    \"\"\"\n    Process one test case: compute pointwise ne and sigma, perform regularized inversion,\n    and return rounded reconstructed profile and uncertainties on r_grid.\n    \"\"\"\n    r_meas = np.array(r_meas, dtype=float)\n    f_meas = np.array(f_meas, dtype=float)\n    r_grid = np.array(r_grid, dtype=float)\n    # Compute pointwise ne and sigma at measurement radii\n    y = np.array([ne_from_freq(f, r, B0, R0) for f, r in zip(f_meas, r_meas)], dtype=float)\n    sigma = np.array([sigma_ne(f, r, B0, R0, sigma_f, sigma_r, sigma_B0) for f, r in zip(f_meas, r_meas)], dtype=float)\n    # Build interpolation matrix\n    A = build_interpolation_matrix(r_meas, r_grid)\n    # Solve with regularization\n    x, Cov_x = solve_regularized(A, y, sigma, lambda_prime)\n    # Extract uncertainties\n    sigma_x = np.sqrt(np.clip(np.diag(Cov_x), 0.0, np.inf))\n    # Round to three significant figures\n    x_rounded = [round_sigfig(val, 3) for val in x]\n    sig_rounded = [round_sigfig(val, 3) for val in sigma_x]\n    return x_rounded, sig_rounded\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"B0\": 2.1,\n            \"R0\": 1.7,\n            \"r_meas\": [1.80, 1.85, 1.90, 1.95, 2.00],\n            \"f_meas\": [7.835e10, 7.156e10, 6.586e10, 6.129e10, 5.746e10],\n            \"sigma_f\": 5.0e7,\n            \"sigma_r\": 2.0e-3,\n            \"sigma_B0\": 1.0e-2,\n            \"lambda_prime\": 0.01,\n            \"r_grid\": [1.80, 1.85, 1.90, 1.95, 2.00],\n        },\n        # Case B\n        {\n            \"B0\": 2.3,\n            \"R0\": 1.6,\n            \"r_meas\": [2.10, 2.15, 2.20],\n            \"f_meas\": [5.918e10, 5.447e10, 5.096e10],\n            \"sigma_f\": 1.0e8,\n            \"sigma_r\": 3.0e-3,\n            \"sigma_B0\": 1.5e-2,\n            \"lambda_prime\": 0.05,\n            \"r_grid\": [2.10, 2.15, 2.20],\n        },\n        # Case C\n        {\n            \"B0\": 1.9,\n            \"R0\": 1.9,\n            \"r_meas\": [1.95, 2.00],\n            \"f_meas\": [6.308e10, 5.938e10],\n            \"sigma_f\": 2.0e8,\n            \"sigma_r\": 5.0e-3,\n            \"sigma_B0\": 2.0e-2,\n            \"lambda_prime\": 0.20,\n            \"r_grid\": [1.95, 2.00],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        x_rounded, sig_rounded = process_case(\n            case[\"B0\"], case[\"R0\"],\n            case[\"r_meas\"], case[\"f_meas\"],\n            case[\"sigma_f\"], case[\"sigma_r\"], case[\"sigma_B0\"],\n            case[\"lambda_prime\"], case[\"r_grid\"]\n        )\n        results.append([x_rounded, sig_rounded])\n\n    # Final print statement in the exact required format.\n    # Ensure only the required single line is printed.\n    print(f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}]]\".replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}