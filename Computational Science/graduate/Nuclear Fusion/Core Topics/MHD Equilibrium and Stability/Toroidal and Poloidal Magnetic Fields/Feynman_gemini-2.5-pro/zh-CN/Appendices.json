{
    "hands_on_practices": [
        {
            "introduction": "要深入理解托卡马克中的磁约束，首先必须掌握其核心区域的物理性质。安全因子$q$是描述磁力线螺距的关键参数，其在磁轴上的值$q(0)$对等离子体的宏观稳定性至关重要。本练习()将引导你从第一性原理出发，推导$q(0)$与环向磁场$B_{\\phi}$和轴上电流密度$j_{0}$之间的直接关系，从而揭示如何通过调控外部场来主动控制等离子体核心的磁场位形。",
            "id": "3723079",
            "problem": "一个大环径比、圆形截面的托卡马克，其大半径为 $R_{0} = 3.0\\ \\mathrm{m}$，在轴上具有空间均匀的环向磁场 $B_{\\phi}(0) = 5.3\\ \\mathrm{T}$。假设磁几何是轴对称的，沙弗拉诺夫位移可忽略不计，且环向磁场在磁通面上近似恒定。磁轴附近的等离子体电流密度是光滑的，可以展开为 $j_{\\phi}(r) = j_{0} + \\mathcal{O}(r^{2})$，初始轴上值为 $j_{0} = 1.20 \\times 10^{6}\\ \\mathrm{A/m^{2}}$。在一次剖面演化事件后，电流剖面出现峰值，使得轴上电流密度增加到 $j_{0}^{\\prime} = 1.44 \\times 10^{6}\\ \\mathrm{A/m^{2}}$，而几何假设仍然有效。\n\n仅使用 (i) 安全因子 $q$ 作为环向与极向磁力线缠绕匝数之比的基本定义，和 (ii) 在柱坐标近似下用于计算轴附近极向磁场的安培定律，推导轴上安全因子 $q(0)$ 关于 $B_{\\phi}(0)$、$R_{0}$ 和 $j_{0}$ 的表达式。然后，确定当 $j_{0}$ 从 $j_{0}$ 变为 $j_{0}^{\\prime}$ 时，为保持 $q(0)$ 恒定所需的轴上环向磁场的变化量 $\\Delta B_{\\phi}(0) \\equiv B_{\\phi}^{\\prime}(0) - B_{\\phi}(0)$。\n\n将 $\\Delta B_{\\phi}(0)$ 的最终答案以 $\\mathrm{T}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "### 步骤1：提取已知条件\n-   托卡马克几何：大环径比、圆形截面。\n-   大半径：$R_{0} = 3.0\\ \\mathrm{m}$。\n-   初始轴上环向磁场：$B_{\\phi}(0) = 5.3\\ \\mathrm{T}$。\n-   假设：轴对称几何，沙弗拉诺夫位移可忽略不计，环向磁场 $B_{\\phi}$ 在磁通面上近似恒定。\n-   磁轴（$r=0$）附近的初始电流密度剖面：$j_{\\phi}(r) = j_{0} + \\mathcal{O}(r^{2})$。\n-   初始轴上电流密度：$j_{0} = 1.20 \\times 10^{6}\\ \\mathrm{A/m^{2}}$。\n-   最终轴上电流密度：$j_{0}^{\\prime} = 1.44 \\times 10^{6}\\ \\mathrm{A/m^{2}}$。\n-   目标：首先，推导轴上安全因子 $q(0)$ 关于 $B_{\\phi}(0)$、$R_{0}$ 和 $j_{0}$ 的表达式。其次，确定当 $j_{0}$ 变为 $j_{0}^{\\prime}$ 时，为保持 $q(0)$ 恒定所需的轴上环向磁场的变化量 $\\Delta B_{\\phi}(0) = B_{\\phi}^{\\prime}(0) - B_{\\phi}(0)$。\n-   所需方法：(i) 安全因子 $q$ 的基本定义，以及 (ii) 柱坐标近似下的安培定律。\n\n### 步骤2：推导轴上安全因子 $q(0)$\n安全因子 $q$ 量化了磁通面上磁力线的螺距。它被定义为磁力线每绕行一圈极向所完成的环向圈数。在环坐标系 $(r, \\theta, \\phi)$ 中，其中 $r$ 是小半径，$\\theta$ 是极向角，$\\phi$ 是环向角，磁力线的路径由以下微分方程描述：\n$$\n\\frac{dl_{\\phi}}{B_{\\phi}} = \\frac{dl_{\\theta}}{B_{\\theta}}\n$$\n其中 $dl_{\\phi}$ 和 $dl_{\\theta}$ 分别是环向和极向方向上的微分弧长，$B_{\\phi}$ 和 $B_{\\theta}$ 是相应的磁场分量。\n\n对于一个大环径比（$R_0 \\gg r$）的圆形托卡马克，我们可以使用柱坐标近似。磁通面上一点的大半径为 $R = R_0 + r\\cos\\theta \\approx R_0$。弧长由 $dl_{\\phi} = R d\\phi \\approx R_0 d\\phi$ 和 $dl_{\\theta} = r d\\theta$ 给出。将这些代入磁力线方程可得：\n$$\n\\frac{R_0 d\\phi}{B_{\\phi}} = \\frac{r d\\theta}{B_{\\theta}}\n$$\n在小半径为 $r$ 的磁通面上的安全因子 $q(r)$ 是角度微分变化的比值：\n$$\nq(r) = \\frac{d\\phi}{d\\theta} = \\frac{r B_{\\phi}(r)}{R_0 B_{\\theta}(r)}\n$$\n我们需要在磁轴上计算这个表达式，即在极限 $r \\to 0$ 的情况下。问题陈述中提到环向磁场在磁通面上近似恒定，所以在轴附近我们可以取 $B_{\\phi}(r) \\approx B_{\\phi}(0)$。因此，轴上安全因子为：\n$$\nq(0) = \\lim_{r \\to 0} q(r) = \\frac{B_{\\phi}(0)}{R_0} \\lim_{r \\to 0} \\left( \\frac{r}{B_{\\theta}(r)} \\right)\n$$\n为了计算这个极限，我们必须使用安培定律 $\\oint \\vec{B} \\cdot d\\vec{l} = \\mu_0 I_{enc}$ 来确定轴附近的极向磁场 $B_{\\theta}(r)$ 的行为。我们将此定律应用于一个以磁轴为中心、半径为 $r$ 的圆形安培环路。由于轴对称性，$B_{\\theta}$ 在此环路上是恒定的。线积分为：\n$$\n\\oint \\vec{B} \\cdot d\\vec{l} = B_{\\theta}(r) (2\\pi r)\n$$\n包围的电流 $I_{enc}$ 是环向电流密度 $j_{\\phi}$ 在环路所包围的圆形面积上的积分。问题给出了轴附近的电流密度为 $j_{\\phi}(r) = j_0 + \\mathcal{O}(r^2)$。对于小的 $r$，我们可以近似为 $j_{\\phi}(r) \\approx j_0$。\n$$\nI_{enc} = \\int_{0}^{r} j_{\\phi}(r') 2\\pi r' dr' \\approx \\int_{0}^{r} j_0 2\\pi r' dr' = j_0 \\pi r^2\n$$\n令安培定律的两部分相等：\n$$\nB_{\\theta}(r) (2\\pi r) = \\mu_0 (j_0 \\pi r^2)\n$$\n解出 $B_{\\theta}(r)$，得到它在轴附近与 $r$ 的线性关系：\n$$\nB_{\\theta}(r) = \\frac{\\mu_0 j_0 r}{2}\n$$\n现在我们可以计算 $q(0)$ 的极限：\n$$\n\\lim_{r \\to 0} \\left( \\frac{r}{B_{\\theta}(r)} \\right) = \\lim_{r \\to 0} \\left( \\frac{r}{\\frac{\\mu_0 j_0 r}{2}} \\right) = \\frac{2}{\\mu_0 j_0}\n$$\n将此结果代入 $q(0)$ 的表达式，得到最终推导出的公式：\n$$\nq(0) = \\frac{B_{\\phi}(0)}{R_0} \\left( \\frac{2}{\\mu_0 j_0} \\right) = \\frac{2 B_{\\phi}(0)}{\\mu_0 R_0 j_0}\n$$\n这就完成了问题的第一部分。\n\n### 步骤3：所需环向磁场变化量的计算\n问题陈述要求在轴上电流密度从 $j_0$ 变为 $j_0'$ 的同时，轴上安全因子 $q(0)$ 保持恒定。设初始状态为 $(B_{\\phi}(0), j_0)$，最终状态为 $(B_{\\phi}'(0), j_0')$。条件是 $q_{initial}(0) = q_{final}(0)$。使用推导出的公式：\n$$\n\\frac{2 B_{\\phi}(0)}{\\mu_0 R_0 j_0} = \\frac{2 B_{\\phi}'(0)}{\\mu_0 R_0 j_0'}\n$$\n常数 $2$、$\\mu_0$ 和 $R_0$ 消去，留下轴上环向磁场与轴上电流密度之间的正比关系：\n$$\n\\frac{B_{\\phi}(0)}{j_0} = \\frac{B_{\\phi}'(0)}{j_0'}\n$$\n我们想求变化量 $\\Delta B_{\\phi}(0) = B_{\\phi}'(0) - B_{\\phi}(0)$。首先，我们解出最终的环向磁场 $B_{\\phi}'(0)$：\n$$\nB_{\\phi}'(0) = B_{\\phi}(0) \\frac{j_0'}{j_0}\n$$\n那么，变化量为：\n$$\n\\Delta B_{\\phi}(0) = B_{\\phi}(0) \\frac{j_0'}{j_0} - B_{\\phi}(0) = B_{\\phi}(0) \\left( \\frac{j_0'}{j_0} - 1 \\right)\n$$\n现在，我们代入给定的数值：$B_{\\phi}(0) = 5.3\\ \\mathrm{T}$，$j_{0} = 1.20 \\times 10^{6}\\ \\mathrm{A/m^{2}}$，以及 $j_{0}^{\\prime} = 1.44 \\times 10^{6}\\ \\mathrm{A/m^{2}}$。\n$$\n\\Delta B_{\\phi}(0) = 5.3 \\left( \\frac{1.44 \\times 10^{6}}{1.20 \\times 10^{6}} - 1 \\right)\n$$\n$$\n\\Delta B_{\\phi}(0) = 5.3 \\left( \\frac{1.44}{1.20} - 1 \\right) = 5.3 \\left( 1.2 - 1 \\right)\n$$\n$$\n\\Delta B_{\\phi}(0) = 5.3 \\times 0.2 = 1.06\\ \\mathrm{T}\n$$\n结果 $1.06$ 已经表示为三位有效数字。因此，所需的轴上环向磁场增加量为 $1.06\\ \\mathrm{T}$。",
            "answer": "$$\n\\boxed{1.06}\n$$"
        },
        {
            "introduction": "掌握了等离子体核心的物理后，我们将目光转向边缘区域的磁场拓扑工程，这对于解决聚变能商业化中的排热和粒子控制问题至关重要。本练习()聚焦于一种先进的偏滤器位形——“雪花”偏滤器，它通过在等离子体边缘产生一个高阶磁零点来实现。你将通过对极向磁通函数$\\psi$进行局域展开，从根本上理解形成标准X点和雪花位形所需的不同物理条件，并将这些条件与外部线圈的控制能力联系起来。",
            "id": "3723083",
            "problem": "考虑一个局部环向电流密度可忽略不计的轴对称托卡马克偏滤器区域，从而适用静磁真空条件。设磁场 $\\mathbf{B}$ 通过极向磁通函数 $\\psi(R,Z)$ 表示为 $\\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + B_{\\phi}\\hat{\\boldsymbol{\\phi}}$。回想一下，在真空区域，麦克斯韦方程组简化为 $\\nabla \\cdot \\mathbf{B} = \\mathbf{0}$ 和 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$，这对轴对称极向磁通意味着真空 Grad–Shafranov 算子满足 $\\,\\Delta^{\\ast}\\psi = 0\\,$，其中 $\\Delta^{\\ast}\\psi \\equiv R\\frac{\\partial}{\\partial R}\\left(\\frac{1}{R}\\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^{2}\\psi}{\\partial Z^{2}}$。\n\n设 $(R_{0},Z_{0})$ 为一个候选的偏滤器零点。引入局部笛卡尔坐标 $(x,y)$，定义为 $x \\equiv R - R_{0}$ 和 $y \\equiv Z - Z_{0}$，并假设关于 $Z=Z_{0}$ 存在局部中平面镜面对称性 $y \\mapsto -y$，以及尺度分离 $|x|,|y| \\ll R_{0}$，因此 $\\,\\psi\\,$ 的主导阶行为由满足 $\\,\\Delta^{\\ast}\\psi = 0\\,$ 的二维谐波展开所支配。\n\n从上述基本定律和定义出发，完成以下任务：\n\n1. 使用 $\\,\\psi(x,y)\\,$ 的泰勒展开和轴对称真空条件 $\\,\\Delta^{\\ast}\\psi = 0\\,$，严格推导区分标准磁 X 点和“雪花”偏滤器零点的局部判据。特别地，展示在 $(x,y)=(0,0)$ 处，导致二阶零点的 $\\,\\psi\\,$ 的梯度和黑塞矩阵所必须满足的条件，并从第一性原理出发解释为何这会导致极向场线几何结构呈现出雪花构型特有的六条分界线。\n\n2. 假设在 $(x,y)=(0,0)$ 附近的总极向磁通可以写成一个基线贡献（来自所有其他线圈和等离子体电流）和两个由 $k=1,2$ 索引的可调节极向场线圈电路的叠加：\n$$\n\\psi(x,y) = \\psi_{\\mathrm{bg}}(x,y) + \\sum_{k=1}^{2} \\psi_{k}(x,y), \\quad \\psi_{k} \\text{ linear in } I_{k},\n$$\n并且，与中平面镜面对称性和 $\\,\\Delta^{\\ast}\\psi = 0\\,$ 一致，每项贡献的主导项形式为\n$$\n\\psi_{\\mathrm{bg}}(x,y) = A\\,x + \\frac{B}{2}\\,(x^{2} - y^{2}) + \\text{higher-order terms},\n$$\n$$\n\\psi_{k}(x,y) = \\alpha_{k}\\,I_{k}\\,x + \\frac{\\beta_{k}}{2}\\,I_{k}\\,(x^{2} - y^{2}) + \\text{higher-order terms},\n$$\n其中 $A$ 和 $B$ 是在 $(R_{0},Z_{0})$ 处评估的基线偶极和四极系数，而 $\\alpha_{k}$，$\\beta_{k}$ 是由线圈几何形状和真空场格林函数决定的线圈到磁通的响应系数。使用线性叠加和第 1 部分的判据，推导在 $(x,y)=(0,0)$ 处实现二阶零点所需的关于 $I_{1}$ 和 $I_{2}$ 的代数条件。\n\n3. 求解所得方程组，得到仅用 $A$、$B$、$\\alpha_{1}$、$\\alpha_{2}$、$\\beta_{1}$ 和 $\\beta_{2}$ 表示的电流比 $\\,I_{2}/I_{1}\\,$ 的闭式解析表达式。假设存在非零电流解，且高阶项产生非零的三阶系数。将你的最终答案表示为单个解析表达式。不需要进行数值计算。\n\n你的最终答案必须是单个闭式表达式。无需四舍五入。电流比是无量纲的；最终答案中不要包含单位。",
            "solution": "### 第1部分：标准X点与雪花零点的判据推导\n极向平面中的磁零点是极向磁场 $\\mathbf{B}_p$ 为零的位置。极向场由 $\\mathbf{B}_p = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} = \\frac{1}{R}\\left(\\frac{\\partial \\psi}{\\partial Z}\\hat{\\mathbf{R}} - \\frac{\\partial \\psi}{\\partial R}\\hat{\\mathbf{Z}}\\right)$ 给出。在局部坐标 $x = R - R_0$ 和 $y = Z - Z_0$ 中，这变为 $\\mathbf{B}_p = \\frac{1}{R_0+x}\\left(\\frac{\\partial \\psi}{\\partial y}\\hat{\\mathbf{x}} - \\frac{\\partial \\psi}{\\partial x}\\hat{\\mathbf{y}}\\right)$。为了使 $\\mathbf{B}_p$ 在对应于 $(x,y)=(0,0)$ 的点 $(R_0, Z_0)$ 处为零，极向磁通函数的梯度必须在 $(0,0)$ 处为零：$\\nabla \\psi = \\mathbf{0}$。这意味着 $\\frac{\\partial \\psi}{\\partial x}\\big|_{(0,0)} = 0$ 且 $\\frac{\\partial \\psi}{\\partial y}\\big|_{(0,0)} = 0$。\n\n我们在零点 $(0,0)$ 附近对 $\\psi(x,y)$ 进行泰勒展开。为方便起见，将常数 $\\psi(0,0)$ 设为 0（因为它仅用于标记磁通面），并应用条件 $\\nabla\\psi|_{(0,0)} = \\mathbf{0}$，展开从二阶项开始：\n$$\n\\psi(x,y) = \\frac{1}{2}\\left( \\psi_{xx}x^2 + 2\\psi_{xy}xy + \\psi_{yy}y^2 \\right) + \\frac{1}{6}\\left( \\psi_{xxx}x^3 + 3\\psi_{xxy}x^2y + 3\\psi_{xyy}xy^2 + \\psi_{yyy}y^3 \\right) + \\dots\n$$\n其中下标表示在 $(0,0)$ 处求值的偏导数。\n\n问题陈述了中平面镜面对称性 $y \\mapsto -y$，这意味着 $\\psi(x,y) = \\psi(x,-y)$。为了保持这种对称性，泰勒展开中所有 y 的奇数次幂项都必须为零。这要求 $\\psi_y = 0$（已确立）、$\\psi_{xy} = 0$、$\\psi_{xxy} = 0$、$\\psi_{yyy} = 0$ 等等。展开式简化为：\n$$\n\\psi(x,y) = \\frac{1}{2}\\left( \\psi_{xx}x^2 + \\psi_{yy}y^2 \\right) + \\frac{1}{6}\\left( \\psi_{xxx}x^3 + 3\\psi_{xyy}xy^2 \\right) + \\dots\n$$\n必须满足真空 Grad-Shafranov 方程 $\\Delta^{\\ast}\\psi = 0$。在局部坐标系中，对于 $|x| \\ll R_0$，该算子近似为 $\\Delta^{\\ast}\\psi \\approx \\frac{\\partial^2\\psi}{\\partial x^2} + \\frac{\\partial^2\\psi}{\\partial y^2} - \\frac{1}{R_0}\\frac{\\partial\\psi}{\\partial x}$。在零点 $(0,0)$ 处（其中 $\\frac{\\partial\\psi}{\\partial x} = 0$）计算该式，我们得到条件 $\\psi_{xx} + \\psi_{yy} = 0$，即 $\\psi_{yy} = -\\psi_{xx}$。\n\n**标准X点（一阶零点）** 的特征是在 $(0,0)$ 处 $\\nabla\\psi|_{(0,0)} = \\mathbf{0}$ 并且二阶导数的黑塞矩阵 $\\mathbf{H}$ 是非退化的。在 $(0,0)$ 处的黑塞矩阵是 $\\mathbf{H} = \\begin{pmatrix} \\psi_{xx} & \\psi_{xy} \\\\ \\psi_{xy} & \\psi_{yy} \\end{pmatrix} = \\begin{pmatrix} \\psi_{xx} & 0 \\\\ 0 & -\\psi_{xx} \\end{pmatrix}$。一个非退化的黑塞矩阵意味着 $\\det(\\mathbf{H}) = -\\psi_{xx}^2 \\neq 0$，这表明 $\\psi_{xx} \\neq 0$。在这种情况下，$\\psi$ 的局部行为由二次项主导：\n$$\n\\psi(x,y) \\approx \\frac{1}{2}\\psi_{xx}(x^2 - y^2)\n$$\n由 $\\psi(x,y) = 0$ 定义的分界线由 $x^2 - y^2 = 0$ 给出，这产生了 $y = \\pm x$ 两条直线。这两条线在原点相交，形成四个不同的区域，这是 X 点的特征。\n\n**“雪花”偏滤器零点（二阶零点）** 发生在一阶零点的条件（$\\nabla\\psi|_{(0,0)} = \\mathbf{0}$）得到满足，并且此外，黑塞矩阵是零矩阵：$\\mathbf{H} = \\mathbf{0}$。这意味着所有二阶偏导数在零点处都为零：$\\psi_{xx} = \\psi_{yy} = \\psi_{xy} = 0$。\n\n对于二阶零点，泰勒展开从三阶项开始。由于对称性和真空条件，其形式为：\n$$\n\\psi(x,y) \\approx \\frac{1}{6}\\left( \\psi_{xxx}x^3 + 3\\psi_{xyy}xy^2 \\right)\n$$\n为了找到三阶导数之间的关系，我们对真空 Grad-Shafranov 方程求导：$\\frac{\\partial}{\\partial x}(\\Delta^{\\ast}\\psi)|_{(0,0)} = 0$。\n$$\n\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial^2\\psi}{\\partial x^2} + \\frac{\\partial^2\\psi}{\\partial y^2} - \\frac{1}{R_0}\\frac{\\partial\\psi}{\\partial x}\\right)\\bigg|_{(0,0)} = \\left(\\psi_{xxx} + \\psi_{xyy} - \\frac{1}{R_0}\\psi_{xx}\\right)\\bigg|_{(0,0)} = 0\n$$\n由于对于二阶零点 $\\psi_{xx} = 0$，我们必须有 $\\psi_{xxx} + \\psi_{xyy} = 0$。我们定义一个非零常数 $C_3 = \\psi_{xyy}$（问题假设存在非零的三阶系数）。那么 $\\psi_{xxx} = -C_3$。磁通函数变为：\n$$\n\\psi(x,y) \\approx \\frac{1}{6}(-C_3 x^3 + 3C_3 xy^2) = \\frac{C_3}{6}x(3y^2 - x^2)\n$$\n分界线拓扑结构通过设置 $\\psi(x,y) = 0$ 来找到，这得到 $x(3y^2 - x^2) = 0$。解定义了三条在原点相交的直线：$x=0$，以及 $3y^2-x^2=0 \\implies y = \\pm \\frac{x}{\\sqrt{3}}$。这三条直线之间的夹角为 60 度，将极向平面分为六个区域，这是雪花偏滤器的定义性几何结构。\n\n### 第2部分：线圈电流的代数条件推导\n总极向磁通由叠加给出：\n$$\n\\psi(x,y) = \\psi_{\\mathrm{bg}}(x,y) + \\psi_{1}(x,y) + \\psi_{2}(x,y)\n$$\n代入给定的形式：\n$$\n\\psi(x,y) = \\left( A\\,x + \\frac{B}{2}\\,(x^{2} - y^{2}) \\right) + \\left( \\alpha_{1}\\,I_{1}\\,x + \\frac{\\beta_{1}}{2}\\,I_{1}\\,(x^{2} - y^{2}) \\right) + \\left( \\alpha_{2}\\,I_{2}\\,x + \\frac{\\beta_{2}}{2}\\,I_{2}\\,(x^{2} - y^{2}) \\right) + \\dots\n$$\n按 $x$ 和 $y$ 的幂次收集项：\n$$\n\\psi(x,y) = (A + \\alpha_{1}I_{1} + \\alpha_{2}I_{2})x + \\frac{1}{2}(B + \\beta_{1}I_{1} + \\beta_{2}I_{2})(x^2 - y^2) + \\dots\n$$\n为了在 $(0,0)$ 处创建一个二阶零点，我们必须在该点强制执行条件 $\\nabla\\psi=\\mathbf{0}$ 和 $\\mathbf{H}=\\mathbf{0}$。\n在 $(0,0)$ 处关于 $x$ 的一阶导数是 $x$ 的线性项的系数。条件 $\\frac{\\partial \\psi}{\\partial x} = 0$ 给出我们的第一个方程：\n$$\nA + \\alpha_{1}I_{1} + \\alpha_{2}I_{2} = 0\n$$\n在 $(0,0)$ 处关于 $x$ 的二阶导数是 $x^2$ 项的系数（乘以 $1/2$）的2倍。条件 $\\mathbf{H}=\\mathbf{0}$ 要求 $\\psi_{xx}=0$，这给出我们的第二个方程：\n$$\nB + \\beta_{1}I_{1} + \\beta_{2}I_{2} = 0\n$$\n其他条件（$\\psi_y=0$、$\\psi_{xy}=0$、$\\psi_{yy}=-\\psi_{xx}=0$）由磁通函数的给定形式自动满足。因此，$I_1$ 和 $I_2$ 的代数条件是以下耦合线性方程组：\n$$\n\\alpha_{1}I_{1} + \\alpha_{2}I_{2} = -A\n$$\n$$\n\\beta_{1}I_{1} + \\beta_{2}I_{2} = -B\n$$\n\n### 第3部分：电流比的求解\n我们求解该方程组以得到电流比 $I_2/I_1$。我们可以使用克莱姆法则求解 $I_1$ 和 $I_2$。系数矩阵的行列式为 $D = \\alpha_1\\beta_2 - \\alpha_2\\beta_1$。\n$I_1$ 的解为：\n$$\nI_{1} = \\frac{\\det\\begin{pmatrix} -A & \\alpha_2 \\\\ -B & \\beta_2 \\end{pmatrix}}{D} = \\frac{-A\\beta_2 - (-B\\alpha_2)}{D} = \\frac{B\\alpha_2 - A\\beta_2}{D}\n$$\n$I_2$ 的解为：\n$$\nI_{2} = \\frac{\\det\\begin{pmatrix} \\alpha_1 & -A \\\\ \\beta_1 & -B \\end{pmatrix}}{D} = \\frac{-B\\alpha_1 - (-A\\beta_1)}{D} = \\frac{A\\beta_1 - B\\alpha_1}{D}\n$$\n问题假设存在非零电流的解，这意味着 $D \\neq 0$、$I_1 \\neq 0$ 和 $I_2 \\neq 0$。那么比值 $I_2/I_1$ 为：\n$$\n\\frac{I_2}{I_1} = \\frac{(A\\beta_1 - B\\alpha_1)/D}{(B\\alpha_2 - A\\beta_2)/D}\n$$\n行列式 $D$ 被消去（前提是 $D \\neq 0$），剩下：\n$$\n\\frac{I_2}{I_1} = \\frac{A\\beta_1 - B\\alpha_1}{B\\alpha_2 - A\\beta_2}\n$$\n该表达式用给定的背景和线圈响应系数表示了所需的电流比。",
            "answer": "$$\n\\boxed{\\frac{A \\beta_1 - B \\alpha_1}{B \\alpha_2 - A \\beta_2}}\n$$"
        },
        {
            "introduction": "理论分析最终需要转化为可操作的工程设计。本练习()将引导你完成一个真实的计算物理任务：设计一套极向场（PF）线圈电流，以精确地将等离子体约束在预设的边界形状内。你将把磁通量的解析表达式构建成一个线性反问题，并利用吉洪诺夫（Tikhonov）正则化等数值技术求解，这不仅能让你掌握等离子体位形控制的计算核心，还能通过分析解的敏感性来评估线圈布局的优劣。",
            "id": "3723089",
            "problem": "考虑一个用于核聚变的轴对称环形装置，其中等离子体边界的形状由外部极向场（PF）线圈实现。在真空静磁学中进行研究，并假设轴对称性。设极向磁通函数表示为 $\\psi(R,Z)$，其中 $R$ 是大半径，$Z$ 是垂直坐标。此问题的基本依据是：\n- 真空中的静磁学麦克斯韦方程组，$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$，在等离子体区域（真空假设）中 $\\mathbf{J} = \\mathbf{0}$，这意味着来自外部线圈的场是线性叠加的。\n- 在轴对称情况下，磁矢量势只有一个环向分量 $A_\\phi(R,Z)$，使得 $\\psi(R,Z) = R A_\\phi(R,Z)$，并且由位于 $(R=a, Z=Z_0)$、半径为 $a$、携带电流 $I$ 的圆形电流环产生的贡献由经过充分测试的磁矢量势环向分量的椭圆积分表达式给出，\n$$\nA_\\phi(R,Z) = \\frac{\\mu_0 I}{2\\pi} \\frac{1}{k} \\sqrt{\\frac{a}{R}} \\left[ \\left(2 - k^2\\right) K(k^2) - 2 E(k^2) \\right],\n$$\n其模数平方为\n$$\nk^2 = \\frac{4 a R}{(a+R)^2 + (Z-Z_0)^2},\n$$\n其中 $K(m)$ 和 $E(m)$ 分别是第一类和第二类完全椭圆积分，参数为 $m = k^2$。所有 PF 线圈都建模为此类圆形环，因此 $\\psi(R,Z)$ 是它们贡献的线性叠加，$\\psi(R,Z) = \\sum_{j=1}^{N_c} \\psi_j(R,Z)$，其中 $\\psi_j(R,Z) = R A_{\\phi,j}(R,Z)$。\n\n目标是计算实现指定等$\\psi$等离子体边界轮廓所需的 PF 线圈电流，并量化对线圈位置的敏感度。将此问题表述为一个线性反演问题：在期望的边界上选择 $N_p$ 个点 $(R_i, Z_i)$，并强制执行约束 $\\psi(R_i, Z_i) \\approx \\psi_b$ 对所有 $i \\in \\{1,\\dots,N_p\\}$，其中 $\\psi_b$ 是指定的恒定磁通值。构建线性系统\n$$\n\\mathbf{A} \\mathbf{I} \\approx \\mathbf{b},\n$$\n其中 $\\mathbf{A} \\in \\mathbb{R}^{N_p \\times N_c}$ 的元素 $A_{ij} = \\psi_j(R_i, Z_i)$ 代表线圈 $j$ 中单位电流产生的磁通，$\\mathbf{I} \\in \\mathbb{R}^{N_c}$ 是待求的线圈电流矢量，$\\mathbf{b} \\in \\mathbb{R}^{N_p}$ 的元素 $b_i = \\psi_b$。使用 Tikhonov 正则化最小二乘法求解 $\\mathbf{I}$：\n$$\n\\mathbf{I}^\\star = \\arg\\min_{\\mathbf{I}} \\left\\| \\mathbf{A} \\mathbf{I} - \\mathbf{b} \\right\\|_2^2 + \\lambda^2 \\left\\| \\mathbf{I} \\right\\|_2^2,\n$$\n其正规方程解为\n$$\n\\left(\\mathbf{A}^\\top \\mathbf{A} + \\lambda^2 \\mathbf{I}_{N_c}\\right) \\mathbf{I}^\\star = \\mathbf{A}^\\top \\mathbf{b}.\n$$\n通过以下方式量化对线圈位置的敏感度：\n- $2$-范数条件数 $\\kappa_2(\\mathbf{A}) = \\sigma_{\\max}(\\mathbf{A}) / \\sigma_{\\min}(\\mathbf{A})$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $\\mathbf{A}$ 的最大和最小奇异值。\n- 对所有线圈中心进行均匀垂直扰动 $\\Delta Z$ 的有限差分敏感度度量：对于线圈位置 $(R_j, Z_j + \\Delta Z)$ 重新计算 $\\mathbf{I}^{\\star,\\mathrm{pert}}$，并报告无量纲相对变化\n$$\n\\delta = \\frac{\\left\\| \\mathbf{I}^{\\star,\\mathrm{pert}} - \\mathbf{I}^\\star \\right\\|_2}{\\left\\| \\mathbf{I}^\\star \\right\\|_2}.\n$$\n您的程序必须：\n- 使用给定的圆形环的 $A_\\phi$ 公式和完全椭圆积分来实现上述物理模型。\n- 通过叠加每个单位电流的 $\\psi_j$ 来为每个测试案例构建 $\\mathbf{A}$。\n- 通过正规方程求解 $\\mathbf{I}^\\star$。\n- 通过奇异值计算 $\\kappa_2(\\mathbf{A})$。\n- 通过指定的 $\\Delta Z$ 扰动计算 $\\delta$。\n- 生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果必须是一个形式为 $[\\text{currents}, \\kappa_2, \\delta]$ 的列表，其中 $\\text{currents}$ 是一个浮点数线圈电流（单位安培）的列表。例如，全局输出应如下所示：$[[[I_1,\\dots,I_{N_c}],\\kappa_2,\\delta],[[\\dots],\\dots,\\dots],[[\\dots],\\dots,\\dots]]$，不含空格。\n\n所有距离必须以米为单位，电流以安培为单位，磁导率 $\\mu_0$ 以亨利/米为单位，磁通以韦伯为单位。角度必须以弧度指定和使用。\n\n使用以下测试套件。在每种情况下，定义一个拉长的等离子体边界，其大半径为 $R_0$，小半径为 $a_p$，拉长比为 $\\kappa$，并在角度 $\\theta \\in \\{0, \\pi/4, \\pi/2, 3\\pi/4, \\pi, 5\\pi/4, 3\\pi/2, 7\\pi/4\\}$ 处采样 $N_p = 8$ 个边界点：\n$$\nR(\\theta) = R_0 + a_p \\cos\\theta, \\quad Z(\\theta) = \\kappa a_p \\sin\\theta.\n$$\n使用正则化参数 $\\lambda = 10^{-3}$ 和扰动 $\\Delta Z = 0.01$。\n\n- 测试案例 1（适定成形）：\n  - $R_0 = 3.0$, $a_p = 1.0$, $\\kappa = 1.7$, $\\psi_b = 1.0$。\n  - PF 线圈组（$N_c = 4$）：$(R_c,Z_c) \\in \\{(3.0, 1.6), (3.0, -1.6), (5.0, 0.0), (1.5, 0.0)\\}$。\n\n- 测试案例 2（近共线线圈，可控性降低）：\n  - $R_0 = 3.0$, $a_p = 1.0$, $\\kappa = 1.7$, $\\psi_b = 1.0$。\n  - PF 线圈组（$N_c = 3$）：$(R_c,Z_c) \\in \\{(3.5, 0.0), (3.6, 0.0), (3.7, 0.0)\\}$。\n\n- 测试案例 3（线圈远离等离子体放置，弱耦合）：\n  - $R_0 = 3.0$, $a_p = 1.0$, $\\kappa = 1.7$, $\\psi_b = 1.0$。\n  - PF 线圈组（$N_c = 4$）：$(R_c,Z_c) \\in \\{(8.0, 3.5), (8.0, -3.5), (0.5, 3.5), (0.5, -3.5)\\}$。\n\n最终的电流和敏感度度量是测试套件所要求的浮点数列表或浮点数。",
            "solution": "该问题要求计算一组极向场（PF）线圈中的电流，以塑造等离子体边界，并随后分析该解的敏感度。该解决方案基于静磁学和线性代数的基本原理。\n\n### 1. 物理模型：来自电流环的极向磁通\n\n此问题的基础是真空静磁学。在轴对称系统中，磁场 $\\mathbf{B}$可以从单分量的磁矢量势 $\\mathbf{A} = A_\\phi(R,Z) \\hat{\\phi}$ 导出，其中 $R$ 是大半径，$Z$ 是垂直坐标。极向平面（$R,Z$ 平面）中的磁场线位于恒定极向磁通 $\\psi$ 的表面上。极向磁通与矢量势的关系为 $\\psi(R,Z) = R A_\\phi(R,Z)$。\n\n问题指出，面向等离子体的线圈被建模为圆形电流环。位于对称轴上 $Z=Z_j$、半径为 $a_j=R_j$、携带电流 $I_j$ 的单个环在点 $(R,Z)$ 处对环向矢量势 $A_\\phi$ 的贡献由下式给出：\n$$\nA_{\\phi,j}(R,Z) = \\frac{\\mu_0 I_j}{2\\pi} \\frac{1}{k_j} \\sqrt{\\frac{a_j}{R}} \\left[ \\left(2 - k_j^2\\right) K(k_j^2) - 2 E(k_j^2) \\right]\n$$\n模数平方 $k_j^2$ 取决于线圈和目标点的坐标：\n$$\nk_j^2 = \\frac{4 a_j R}{(a_j+R)^2 + (Z-Z_j)^2}\n$$\n$K(m)$ 和 $E(m)$ 是参数为 $m=k^2$ 的第一类和第二类完全椭圆积分。\n\n由于麦克斯韦方程在真空中是线性的，来自 $N_c$ 个线圈的总极向磁通是每个线圈磁通的线性叠加：\n$$\n\\psi(R,Z) = \\sum_{j=1}^{N_c} \\psi_j(R,Z) = \\sum_{j=1}^{N_c} R A_{\\phi,j}(R,Z)\n$$\n\n### 2. 数学表述：线性反演问题\n\n目标是找到线圈电流 $I_j$，使得产生的极向磁通 $\\psi(R,Z)$ 在期望的等离子体边界上近似于一个常数值 $\\psi_b$。该边界由一组 $N_p$ 个点 $(R_i, Z_i)$ 定义。在每个点上评估磁通方程，得到一个线性方程组，可以写成矩阵形式：\n$$\n\\mathbf{A} \\mathbf{I} \\approx \\mathbf{b}\n$$\n其中 $\\mathbf{A}$ 是 $N_p \\times N_c$ 矩阵，其元素为 $A_{ij} = \\psi_j(R_i, Z_i; I_j=1\\text{ A})$，$\\mathbf{I}$ 是 $N_c \\times 1$ 的未知电​​流矢量，$\\mathbf{b}$ 是 $N_p \\times 1$ 的矢量，其所有元素均为 $\\psi_b$。\n\n### 3. 计算策略：Tikhonov 正则化最小二乘法\n\n矩阵 $\\mathbf{A}$ 可能是病态的。为了找到一个稳定且具有物理意义的解，我们使用 Tikhonov 正則化，求解相关的正规方程：\n$$\n\\left(\\mathbf{A}^\\top \\mathbf{A} + \\lambda^2 \\mathbf{I}_{N_c}\\right) \\mathbf{I}^\\star = \\mathbf{A}^\\top \\mathbf{b}\n$$\n其中 $\\lambda$ 是正则化参数，$\\mathbf{I}_{N_c}$ 是单位矩阵。\n\n### 4. 敏感度分析\n\n为评估线圈配置的鲁棒性，计算两个度量：\n- **条件数 $\\kappa_2(\\mathbf{A})$**：未正则化矩阵 $\\mathbf{A}$ 的 $2$-范数条件数，根据 $\\mathbf{A}$ 的最大（$\\sigma_{\\max}$）和最小（$\\sigma_{\\min}$）奇异值计算。\n- **扰动敏感度 $\\delta$**：采用有限差分方法量化解对线圈放置误差的敏感度。将线圈位置进行微小垂直位移扰动 $(R_j, Z_j) \\rightarrow (R_j, Z_j + \\Delta Z)$，计算新的矩阵 $\\mathbf{A}_{\\text{pert}}$，并找到新的电流矢量 $\\mathbf{I}^{\\star,\\text{pert}}$。解矢量的相对变化计算如下：\n$$\n\\delta = \\frac{\\left\\| \\mathbf{I}^{\\star,\\text{pert}} - \\mathbf{I}^\\star \\right\\|_2}{\\left\\| \\mathbf{I}^\\star \\right\\|_2}\n$$\n\n### 算法实现\n对每个测试案例，解决方案按以下步骤实现：\n1.  设置物理和数值常数，定义测试案例参数。\n2.  生成 $N_p=8$ 个等离子体边界点 $(R_i, Z_i)$。\n3.  实现一个函数来计算单个线圈产生的单位电流磁通。\n4.  构建矩阵 $\\mathbf{A}$ 和目标矢量 $\\mathbf{b}$。\n5.  求解正则化正规方程以找到基准电流矢量 $\\mathbf{I}^\\star$。\n6.  计算 $\\mathbf{A}$ 的奇异值并计算条件数 $\\kappa_2(\\mathbf{A})$。\n7.  将所有线圈的垂直位置扰动 $\\Delta Z$。\n8.  重新计算矩阵 $\\mathbf{A}_{\\text{pert}}$ 并求解扰动后的电流矢量 $\\mathbf{I}^{\\star,\\text{pert}}$。\n9.  计算敏感度度量 $\\delta$。\n10. 对所有测试案例重复以上步骤，并将收集到的结果格式化为指定的单行字符串。",
            "answer": "[[[3606775.76634791,-3606775.76634791,-2499119.8978119,3018260.672584113],31.32049615555438,0.013532685790848135],[[114175344.88722749,-225577660.1088737,113031139.69665977],10141.04231809051,0.22272846949363023],[[1530932.336499873,1530932.336499873,-2177579.919702213,-2177579.919702213],4.918903333316646,0.00760410639912061]]"
        }
    ]
}