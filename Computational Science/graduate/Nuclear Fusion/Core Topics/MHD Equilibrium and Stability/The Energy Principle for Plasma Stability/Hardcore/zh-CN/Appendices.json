{
    "hands_on_practices": [
        {
            "introduction": "能量原理的威力在于其变分性质，但这要求我们审慎地选择试函数。本练习  旨在探讨任何位移场都必须满足的关键物理约束，即理想磁流体动力学中的磁冻结条件以及在理想导体壁上的边界条件。通过在一个简化的板状几何中应用这些规则，您将理解它们如何筛选出具有物理意义的扰动，并避免得出错误的稳定性结论。",
            "id": "3721115",
            "problem": "考虑一个静态、均匀的平衡等离子体，它被限制在沿 $x$ 方向厚度为 $a$ 的平板中，并在 $y$ 和 $z$ 方向上具有较大的周期性延伸。平衡磁场为 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$，质量密度为 $\\rho$（常数），平衡压力为 $p$（常数）。等离子体在 $x=0$ 和 $x=a$ 处由理想导电的刚性壁界定。\n\n从麦克斯韦方程组的感应方程和磁流体动力学（MHD）（此处定义为 Magnetohydrodynamics）的理想欧姆定律出发，构建任何容许的线性拉格朗日位移场 $\\boldsymbol{\\xi}(\\mathbf{r})$ 必须满足的约束条件，以确保不违反理想 MHD 的磁冻结条件。特别地，推导磁扰动 $\\delta \\mathbf{B}$ 与 $\\boldsymbol{\\xi}$ 之间的关系，并确定在理想导电固定壁上的边界约束。\n\n然后，将注意力限制在一类形式为 $\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$ 且不依赖于 $y$ 和 $z$ 的试探位移上，并利用理想 MHD 能量原理，写出适用于此均匀平衡的二阶势能变化泛函 $\\delta W$。施加您推导出的具有物理依据的约束，以排除那些会违反磁通量冻结或壁条件的非物理试探位移。\n\n在这些约束条件下，对函数 $f(x)$ 最小化 $\\delta W$，并满足归一化条件\n$$\nI \\equiv \\int_{0}^{a} \\rho\\,|f(x)|^{2}\\,dx\n$$\n定义为 $y$–$z$ 平面内的单位面积上的值。计算这类位移下，归一化势能变化的约束最小值 $\\delta W_{\\min}/I$。为了检验约束的影响，简要说明如果允许 $f(x)$ 为常数并将 $\\delta \\mathbf{B}$ 视为独立于 $\\boldsymbol{\\xi}$，无约束最小化会错误地预测出什么结果。\n\n将您最终的归一化最小值 $\\delta W_{\\min}/I$ 以 $\\mathrm{s}^{-2}$ 为单位表示。无需四舍五入。除了给定的符号 $B_{0}$、$\\mu_{0}$、$\\gamma$、$p$、$\\rho$ 和 $a$ 之外，不要包含任何额外的数值数据。",
            "solution": "首先对问题进行严格的验证过程。\n\n**步骤 1：提取已知条件**\n- **平衡态**：静态、均匀的等离子体。\n- **几何构型**：沿 $x$ 方向厚度为 $a$ 的平板，在 $x=0$ 和 $x=a$ 处有壁面。在 $y$ 和 $z$ 方向上具有周期性。\n- **平衡场和参数**：\n    - 磁场：$\\mathbf{B} = \\mathbf{B}_0 = B_{0}\\,\\hat{\\mathbf{z}}$。\n    - 质量密度：$\\rho$（常数）。\n    - 压力：$p$（常数）。\n- **边界**：在 $x=0$ 和 $x=a$ 处为理想导电的刚性壁。\n- **物理模型**：理想磁流体动力学（MHD），特别是感应方程和理想欧姆定律。\n- **扰动**：\n    - 拉格朗日位移场：$\\boldsymbol{\\xi}(\\mathbf{r})$。\n    - 特定试探位移：$\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$。\n- **归一化**：\n    $$I \\equiv \\int_{0}^{a} \\rho\\,|f(x)|^{2}\\,dx$$\n- **任务**：\n    1. 推导磁扰动 $\\delta \\mathbf{B}$ 与 $\\boldsymbol{\\xi}$ 之间的关系。\n    2. 确定在理想导电固定壁上的边界约束。\n    3. 写出给定试探位移的势能变化泛函 $\\delta W$。\n    4. 在推导出的约束下，最小化归一化势能变化 $\\delta W/I$。\n    5. 与“无约束”最小化进行比较。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是理想 MHD 稳定性理论中的一个标准练习，基于等离子体物理学和电磁学的基本原理。该设置虽然简化（均匀平板），但是研究波传播和稳定性（例如，磁声波）的一个有效且常见的模型。\n- **适定性**：该问题是适定的。它涉及在一个函数空间上对一个明确定义的泛函（势能）在清晰的物理边界条件下进行最小化，这将导致一个唯一且稳定的解（最低本征模）。\n- **客观性**：该问题使用等离子体物理学中精确、客观和标准的术语来陈述。没有主观或含糊的陈述。\n- **完整性与一致性**：提供了所有必要信息（$\\mathbf{B}_0$、$\\rho$、$p$、几何构型、边界条件）。设置中没有矛盾。\n\n**步骤 3：结论与行动**\n该问题是有效的。这是一个在理论等离子体物理学中科学合理、适定且客观的问题。我现在将着手解答。\n\n理想 MHD 模型由一组流体方程和麦克斯韦方程组控制。对于此问题，关键关系是感应方程和理想欧姆定律。\n\n首先，我们推导一阶磁场扰动 $\\delta\\mathbf{B}$ 和拉格朗日位移矢量 $\\boldsymbol{\\xi}$ 之间的关系。感应方程为\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\n理想欧姆定律指出，在等离子体参考系中，电场为零。在实验室参考系中，这给出\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = 0 \\implies \\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\n我们围绕静态（$\\mathbf{v}_0=0$）平衡对这些方程进行小扰动线性化：$\\mathbf{B} = \\mathbf{B}_0 + \\delta\\mathbf{B}$，$\\mathbf{v} = \\delta\\mathbf{v} = \\frac{\\partial\\boldsymbol{\\xi}}{\\partial t}$，以及 $\\mathbf{E} = \\delta\\mathbf{E}$。线性化的感应方程变为\n$$\n\\frac{\\partial (\\mathbf{B}_0 + \\delta\\mathbf{B})}{\\partial t} = -\\nabla \\times \\delta\\mathbf{E}\n$$\n由于 $\\mathbf{B}_0$ 不随时间变化，因此这是 $\\frac{\\partial \\delta\\mathbf{B}}{\\partial t} = -\\nabla \\times \\delta\\mathbf{E}$。线性化的欧姆定律为 $\\delta\\mathbf{E} = -\\frac{\\partial\\boldsymbol{\\xi}}{\\partial t} \\times \\mathbf{B}_0$。将其代入感应方程，得到\n$$\n\\frac{\\partial \\delta\\mathbf{B}}{\\partial t} = -\\nabla \\times \\left(-\\frac{\\partial\\boldsymbol{\\xi}}{\\partial t} \\times \\mathbf{B}_0\\right) = \\nabla \\times \\left(\\frac{\\partial\\boldsymbol{\\xi}}{\\partial t} \\times \\mathbf{B}_0\\right)\n$$\n由于 $\\mathbf{B}_0$ 在空间上均匀且不随时间变化，我们可以交换时间导数和旋度算子：\n$$\n\\frac{\\partial \\delta\\mathbf{B}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)\\right)\n$$\n从一个未受扰动的状态（$\\boldsymbol{\\xi}=0, \\delta\\mathbf{B}=0$）开始对时间积分，得到磁通量冻结的基本关系：\n$$\n\\delta \\mathbf{B} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)\n$$\n接下来，我们确定在 $x=0$ 和 $x=a$ 处的理想导电刚性壁上的约束条件。\n1.  **刚性壁**：刚性壁是不可穿透的，因此等离子体位移垂直于壁的分量必须为零。设 $\\hat{\\mathbf{n}}$ 为壁的单位法向量。这给出了在壁上的约束条件 $\\boldsymbol{\\xi} \\cdot \\hat{\\mathbf{n}} = 0$。\n2.  **理想导电壁**：在理想导体的表面，电场的切向分量必须为零。根据欧姆定律，$\\mathbf{E}_t = (-\\mathbf{v} \\times \\mathbf{B})_t = 0$。此外，磁通量不能穿透理想导体。这意味着在壁上总磁场的法向分量必须在所有时间都为零：$(\\mathbf{B}_0 + \\delta\\mathbf{B}) \\cdot \\hat{\\mathbf{n}} = 0$。在我们的平衡态中，$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 且壁法向量为 $\\hat{\\mathbf{n}} = \\pm\\hat{\\mathbf{x}}$。因此，$\\mathbf{B}_0 \\cdot \\hat{\\mathbf{n}} = 0$。该条件简化为在壁上有 $\\delta\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$。\n\n现在我们针对给定的均匀平衡和试探位移 $\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$ 进行专门化处理。\n对于具有恒定压力 $p$ 和均匀磁场 $\\mathbf{B}_0$（意味着平衡电流 $\\mathbf{j}_0 = \\frac{1}{\\mu_0}\\nabla\\times\\mathbf{B}_0=0$ 且压力梯度 $\\nabla p=0$）的平衡态，理想 MHD 的势能变化泛函 $\\delta W$ 简化为\n$$\n\\delta W = \\frac{1}{2}\\int_V \\left( \\frac{|\\delta\\mathbf{B}|^2}{\\mu_0} + \\gamma p |\\nabla \\cdot \\boldsymbol{\\xi}|^2 \\right) dV\n$$\n其中 $\\gamma$ 是比热比。我们为我们特定的 $\\boldsymbol{\\xi}$ 计算各项：\n- 位移的散度：$\\nabla \\cdot \\boldsymbol{\\xi} = \\frac{\\partial \\xi_x}{\\partial x} = \\frac{d f(x)}{dx} = f'(x)$。\n- 扰动磁场：\n$$\n\\boldsymbol{\\xi} \\times \\mathbf{B}_0 = (f(x)\\,\\hat{\\mathbf{x}}) \\times (B_0\\,\\hat{\\mathbf{z}}) = f(x)B_0(\\hat{\\mathbf{x}}\\times\\hat{\\mathbf{z}}) = -f(x)B_0\\,\\hat{\\mathbf{y}}\n$$\n$$\n\\delta\\mathbf{B} = \\nabla \\times (-f(x)B_0\\,\\hat{\\mathbf{y}}) = \\hat{\\mathbf{z}}\\,\\frac{\\partial}{\\partial x}(-f(x)B_0) = -B_0f'(x)\\,\\hat{\\mathbf{z}}\n$$\n这里有些不对劲。我们重新计算旋度。\n$\\nabla \\times (V_y \\hat{\\mathbf{y}}) = \\frac{\\partial V_y}{\\partial z}\\hat{\\mathbf{x}} - \\frac{\\partial V_y}{\\partial x}\\hat{\\mathbf{z}}$。\n这里 $V_y = -f(x)B_0$。所以 $\\frac{\\partial V_y}{\\partial z}=0$。\n$$\n\\delta\\mathbf{B} = - \\frac{\\partial}{\\partial x}(-f(x)B_0) \\hat{\\mathbf{z}} = B_0 f'(x) \\hat{\\mathbf{z}}\n$$\n现在，将这些代入 $\\delta W$ 的表达式中。题目要求的是 $y$-$z$ 平面内单位面积上的结果，所以我们对 $x$ 从 $0$ 到 $a$ 积分，并假设对 $y$ 和 $z$ 的积分因子为 1。\n$$\n\\delta W = \\frac{1}{2} \\int_0^a \\left( \\frac{(B_0 f'(x))^2}{\\mu_0} + \\gamma p (f'(x))^2 \\right) dx = \\frac{1}{2} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\int_0^a (f'(x))^2 dx\n$$\n$f(x)$ 的约束条件是：\n1.  $\\boldsymbol{\\xi} \\cdot \\hat{\\mathbf{n}} = 0$：在 $x=0$ 和 $x=a$ 处，法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$，所以 $\\xi_x = f(x)$ 必须为零。这给出了边界条件 $f(0)=0$ 和 $f(a)=0$。\n2.  $\\delta\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$：这里 $\\delta\\mathbf{B} = B_0 f'(x)\\,\\hat{\\mathbf{z}}$，所以 $\\delta\\mathbf{B}\\cdot\\hat{\\mathbf{x}} = 0$ 在任何地方都自动成立。对于这类位移，该约束是自然满足的。\n\n我们需要在 $f(0)=0$ 和 $f(a)=0$ 的条件下最小化 $\\delta W/I$。需要最小化的量是瑞利商：\n$$\n\\frac{\\delta W}{I} = \\frac{\\frac{1}{2} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\int_0^a (f'(x))^2 dx}{\\rho \\int_0^a (f(x))^2 dx} = \\frac{1}{2\\rho} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\frac{\\int_0^a (f'(x))^2 dx}{\\int_0^a (f(x))^2 dx}\n$$\n这是一个变分法中的标准问题。在边界条件 $f(0)=f(a)=0$ 下，商 $\\int (f')^2 dx / \\int f^2 dx$ 的最小值由Sturm-Liouville问题 $f''(x) + k^2 f(x) = 0$ 的最低特征值给出。解为 $f(x) = A\\sin(kx)+C\\cos(kx)$。\n$f(0)=0 \\implies C=0$。\n$f(a)=0 \\implies A\\sin(ka)=0$。对于非平凡解（$A \\neq 0$），我们需要 $ka = n\\pi$，其中整数 $n \\geq 1$。\n$k$ 的最低非零值对应于 $n=1$，因此 $k=\\pi/a$。使之最小化的函数是 $f(x) = A\\sin(\\pi x/a)$。该商的最小值（即最低特征值 $k^2$）是 $(\\pi/a)^2$。\n因此，$\\delta W/I$ 的最小值为：\n$$\n\\frac{\\delta W_{\\min}}{I} = \\frac{1}{2\\rho} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\left(\\frac{\\pi}{a}\\right)^2 = \\frac{\\pi^2}{2a^2\\rho} \\left( \\gamma p + \\frac{B_0^2}{\\mu_0} \\right)\n$$\n这个量的单位是 (压力/密度) $\\times$ (长度)$^{-2}$，即 $((\\text{m}^2/\\text{s}^2))/\\text{m}^2 = \\text{s}^{-2}$，符合要求。注意，这个量在物理上与最低稳定振荡频率的平方有关，即 $\\omega^2 = 2 \\delta W_{\\min}/I$。\n\n最后，我们考虑“无约束”最小化。问题建议“允许 $f(x)$ 为常数并将 $\\delta \\mathbf{B}$ 视为独立于 $\\boldsymbol{\\xi}$”。这意味着我们抛弃了两个关键的物理约束：(1) 边界条件 $f(0)=f(a)=0$，以及 (2) 磁冻结定律 $\\delta\\mathbf{B}=\\nabla\\times(\\boldsymbol{\\xi}\\times\\mathbf{B}_0)$。\n需要最小化的泛函是 $\\delta W = \\frac{1}{2} \\int_0^a \\left( \\frac{|\\delta\\mathbf{B}|^2}{\\mu_0} + \\gamma p (f'(x))^2 \\right) dx$。\n如果我们被允许选择 $f(x)$ 为一个常数，比如 $f(x)=c_0$，那么 $f'(x)=0$。包含 $\\gamma p$ 的项就消失了。\n如果我们将 $\\delta\\mathbf{B}$ 视为一个独立的试探函数，那么通过选择 $\\delta\\mathbf{B}=0$ 可以使其对 $\\delta W$ 的贡献最小化。\n在这些非物理的假设下，最小势能为 $\\delta W_{\\min}=0$。\n对于一个非平凡的位移 $f(x)=c_0\\neq 0$，归一化为 $I = \\int_0^a \\rho c_0^2 dx = \\rho c_0^2 a > 0$。\n对归一化最小能量的错误预测将是 $\\delta W_{\\min}/I = 0$。这个结果是不正确的，因为试探函数 $f(x)=c_0$ 违反了位移在刚性壁处必须为零的物理边界条件。抛弃这个约束会允许一个对应于等离子体平板刚性平移的平凡能量状态，这在一个无限系统中不消耗能量，但在有界区域中不是一个有效的扰动。",
            "answer": "$$\n\\boxed{\\frac{\\pi^{2}}{2 a^{2} \\rho} \\left( \\gamma p + \\frac{B_{0}^{2}}{\\mu_{0}} \\right)}\n$$"
        },
        {
            "introduction": "在掌握了基本约束之后，我们现在将能量原理应用于一种最基本的宏观不稳定性——外部扭曲模。本练习  将引导您计算等离子体周围真空区域的磁能变化。这项计算是理解“壁稳定”效应的关键，它清晰地展示了为何一个邻近的导体边界能够有力地稳定这种危险的不稳定性。",
            "id": "3721145",
            "problem": "考虑一半径为 $a$ 的无限长、笔直的圆柱形等离子体，该等离子体处于真空中。等离子体中通有均匀的轴向电流密度，产生一个角向平衡磁场 $B_{\\theta 0}(r)$。该磁场在等离子体内部随 $r$ 线性变化，在真空中随 $1/r$ 衰减：当 $0 \\le r \\le a$ 时，$B_{\\theta 0}(r) = B_{a}\\, r/a$；当 $r \\ge a$ 时，$B_{\\theta 0}(r) = B_{a}\\, a/r$。其中 $B_{a} \\equiv B_{\\theta 0}(a)$。在半径 $b > a$ 处，有一个理想导电的圆柱形壁。\n\n在理想磁流体力学（MHD）的框架内，使用麦克斯韦方程组的静磁形式和理想磁通冻结约束，确定与 $m=1$ 扭曲位移相关的真空磁场扰动。该位移使等离子体边界发生刚性平移。具体来说，考虑一个没有轴向变化的单螺旋度扰动（即轴向波数 $k=0$），其等离子体边界位移为 $\\xi_{r}(a,\\theta) = \\xi_{0}\\cos\\theta$，其中 $\\xi_{0}$ 是一个常实数振幅。假设真空磁扰动可以由一个二维标量磁通函数 $\\psi(r,\\theta)$ 表示，该函数在真空区域 $a  r  b$ 满足拉普拉斯方程。并施加由 $r=a$ 处的磁通冻结和 $r=b$ 处的理想导电性所决定的物理上合适的边界条件。\n\n从基本定律（麦克斯韦方程组和理想MHD约束）出发，不使用任何预先推导的稳定性公式，计算单位轴向长度上真空磁场能量对此 $m=1$ 扭曲的势能变化 $\\delta W$ 的贡献。给出单位轴向长度的真空贡献 $\\delta W_{\\text{vac}}$ 的最终表达式，用 $a$、$b$、$B_{a}$、$\\mu_{0}$ 和 $\\xi_{0}$ 表示，其中 $\\mu_{0}$ 是真空磁导率。然后简要描述该贡献如何依赖于壁半径 $b$。\n\n以焦耳/米为单位表示单位轴向长度的 $\\delta W_{\\text{vac}}$ 的最终答案。不需要进行数值计算。",
            "solution": "用户希望计算对于一个圆柱形等离子体的 $m=1, k=0$ 扭曲位移，真空磁场能量对势能变化 $\\delta W_{\\text{vac}}$ 的贡献。\n\n### 步骤1：提取已知条件\n-   等离子体：无限长、笔直、圆柱形，半径为 $a$。\n-   等离子体电流：均匀的轴向电流密度。\n-   平衡磁场：角向场 $B_{\\theta 0}(r)$。\n    -   等离子体内部 ($0 \\le r \\le a$): $B_{\\theta 0}(r) = B_{a} \\frac{r}{a}$。\n    -   真空中 ($r \\ge a$): $B_{\\theta 0}(r) = B_{a} \\frac{a}{r}$。\n    -   $B_{a} \\equiv B_{\\theta 0}(a)$ 是等离子体边界处的场强。\n-   边界：位于半径 $b > a$ 处的理想导电圆柱壁。\n-   框架：理想磁流体动力学（MHD）。\n-   扰动：刚性的 $m=1$ 扭曲位移，无轴向变化 ($k=0$)。\n    -   等离子体边界位移：$\\xi_{r}(a,\\theta) = \\xi_{0}\\cos\\theta$。\n    -   $\\xi_{0}$ 是一个常实数振幅。\n-   真空扰动：扰动磁场 $\\mathbf{B}_1$ 可由一个标量磁通函数 $\\psi(r, \\theta)$ 表示，该函数在真空区域 $a  r  b$ 满足拉普拉斯方程 $\\nabla^2\\psi = 0$。\n-   任务：\n    1.  计算单位轴向长度上真空对势能变化 $\\delta W_{\\text{vac}}$ 的贡献。\n    2.  用 $a$、$b$、$B_{a}$、$\\mu_{0}$ 和 $\\xi_{0}$ 表示结果，其中 $\\mu_{0}$ 是真空磁导率。\n    3.  描述 $\\delta W_{\\text{vac}}$ 对壁半径 $b$ 的依赖关系。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学性：**该问题描述了一种Z箍缩位形，这是等离子体物理学中用于研究MHD稳定性的一个基本模型。平衡场分布与等离子体内部的均匀电流密度一致。使用理想MHD、磁通冻结和导电壁是分析此类位形稳定性的标准且适当的方法。所描述的扰动是经典的 $m=1$ 外部扭曲模。该问题牢固地建立在公认的等离子体物理学原理之上。\n2.  **适定性：**该问题提供了一套完整的物理条件和边界约束（等离子体-真空界面、导电壁），这些条件对于唯一确定真空磁场扰动是必要的。计算真空能量贡献的目标是MHD稳定性理论中一个明确定义的任务。\n3.  **客观性：**该问题使用等离子体物理学和数学的精确、标准术语进行陈述。没有主观或基于意见的陈述。\n4.  **其他缺陷：**该问题不是不可形式化、不完整、矛盾、不切实际、不适定、微不足道或超出科学可验证范围的。这是MHD理论中的一个典型计算。\n\n### 步骤3：结论与行动\n问题有效。我将继续进行求解。\n\n真空区域中单位轴向长度的势能变化 $\\delta W_{\\text{vac}}$ 由扰动磁场能量密度在单位长度的真空体积上的积分给出。\n$$\n\\delta W_{\\text{vac}} = \\frac{1}{2\\mu_0} \\int_{0}^{2\\pi} \\int_{a}^{b} |\\mathbf{B}_1|^2 r \\, dr \\, d\\theta\n$$\n这里，$\\mathbf{B}_1$ 是真空区域 $a  r  b$ 中磁场的一阶扰动。由于真空中没有电流，安培定律给出 $\\nabla \\times \\mathbf{B}_1 = 0$。这与 $\\nabla \\cdot \\mathbf{B}_1 = 0$ 相结合，使我们可以用一个标量势来描述 $\\mathbf{B}_1$。问题指定使用一个磁通函数 $\\psi(r, \\theta)$，这对于二维问题（$k=0$）是合适的。磁场扰动与 $\\psi$ 的关系如下：\n$$\n\\mathbf{B}_1 = \\nabla \\times (\\psi \\hat{\\mathbf{z}}) = \\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} \\hat{\\mathbf{r}} - \\frac{\\partial \\psi}{\\partial r} \\hat{\\mathbf{\\theta}}\n$$\n条件 $\\nabla \\times \\mathbf{B}_1 = 0$ 意味着 $\\psi$ 必须在真空区域满足拉普拉斯方程：\n$$\n\\nabla^2 \\psi = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial \\psi}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 \\psi}{\\partial \\theta^2} = 0\n$$\n我们必须在两个边界条件下求解这个方程。\n\n首先，在 $r=b$ 处的理想导电壁上，磁场必须是切向的。平衡场 $\\mathbf{B}_0$ 已经是切向的。因此，扰动场的法向分量 $B_{1r}$ 必须在壁上为零。\n$$\nB_{1r}(b, \\theta) = \\frac{1}{b} \\left( \\frac{\\partial \\psi}{\\partial \\theta} \\right)_{r=b} = 0\n$$\n这意味着 $\\psi(b, \\theta)$ 必须与 $\\theta$ 无关。由于势的绝对值是任意的，为简单起见，我们可以将此常数值设为零：\n$$\n\\psi(b, \\theta) = 0\n$$\n其次，在扰动后的等离子体-真空界面处，理想MHD磁通冻结约束要求总磁场与表面相切。设扰动后的表面为 $r_p(\\theta) = a + \\xi_r(a, \\theta) = a + \\xi_{0}\\cos\\theta$。该表面的一个法向量是 $\\mathbf{n} = \\nabla(r - r_p) = \\hat{\\mathbf{r}} - \\frac{1}{r}\\frac{\\partial r_p}{\\partial\\theta}\\hat{\\mathbf{\\theta}} = \\hat{\\mathbf{r}} + \\frac{\\xi_0}{r}\\sin\\theta \\hat{\\mathbf{\\theta}}$。条件是在 $r=r_p$ 处 $\\mathbf{B} \\cdot \\mathbf{n} = 0$。总场为 $\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_1$。我们对该条件进行线性化。\n$$\n(\\mathbf{B}_0(r_p) + \\mathbf{B}_1(r_p)) \\cdot \\mathbf{n}(r_p) = 0\n$$\n对 $\\xi_0$ 和 $\\mathbf{B}_1$ 取一阶近似：\n$\\mathbf{B}_0(r_p) \\approx \\mathbf{B}_0(a) + (\\boldsymbol{\\xi} \\cdot \\nabla)\\mathbf{B}_0|_{r=a} = B_a \\frac{a}{a}\\hat{\\mathbf{\\theta}} + (\\xi_r \\frac{\\partial}{\\partial r})(B_a a/r)\\hat{\\mathbf{\\theta}}|_{r=a} = B_a\\hat{\\mathbf{\\theta}} - \\frac{B_a}{a}\\xi_r \\hat{\\mathbf{\\theta}}$。\n$\\mathbf{B}_1(r_p) \\approx \\mathbf{B}_1(a)$。\n$\\mathbf{n}(r_p) \\approx \\hat{\\mathbf{r}} + \\frac{\\xi_0}{a}\\sin\\theta\\hat{\\mathbf{\\theta}}$。\n点积变为：\n$$\n(B_{1r}(a)\\hat{\\mathbf{r}} + \\dots) \\cdot \\hat{\\mathbf{r}} + (B_a\\hat{\\mathbf{\\theta}}) \\cdot (\\frac{\\xi_0}{a}\\sin\\theta\\hat{\\mathbf{\\theta}}) + \\mathcal{O}(\\xi_0^2, B_1\\xi_0) = 0\n$$\n$$\nB_{1r}(a, \\theta) + \\frac{B_a \\xi_0}{a} \\sin\\theta = 0 \\implies B_{1r}(a, \\theta) = -\\frac{B_a \\xi_0}{a} \\sin\\theta\n$$\n我们用 $\\psi$ 来表示这个条件：\n$$\n\\frac{1}{a} \\left(\\frac{\\partial \\psi}{\\partial \\theta}\\right)_{r=a} = -\\frac{B_a \\xi_0}{a} \\sin\\theta \\implies \\frac{\\partial \\psi}{\\partial \\theta}(a, \\theta) = -B_a \\xi_0 \\sin\\theta\n$$\n对 $\\theta$ 积分，得到 $\\psi$ 在 $r=a$ 处的边界条件：\n$$\n\\psi(a, \\theta) = B_a \\xi_0 \\cos\\theta\n$$\n问题简化为求解 $m=1$ 模的拉普拉斯方程。具有 $\\cos\\theta$ 依赖性的通解形式为 $\\psi(r, \\theta) = R(r)\\cos\\theta$。代入拉普拉斯方程得到欧拉方程 $r^2 R'' + rR' - R = 0$，其通解为 $R(r) = C_1 r + C_2 r^{-1}$。因此，\n$$\n\\psi(r, \\theta) = (C_1 r + C_2 r^{-1}) \\cos\\theta\n$$\n应用边界条件求常数 $C_1$ 和 $C_2$：\n在 $r=b$ 处：$\\psi(b, \\theta) = (C_1 b + C_2 b^{-1})\\cos\\theta = 0 \\implies C_1 b + C_2 b^{-1} = 0 \\implies C_2 = -C_1 b^2$。\n在 $r=a$ 处：$\\psi(a, \\theta) = (C_1 a + C_2 a^{-1})\\cos\\theta = B_a\\xi_0\\cos\\theta \\implies C_1 a + C_2 a^{-1} = B_a\\xi_0$。\n将 $C_2$ 代入第二个方程：\n$C_1 a - (C_1 b^2) a^{-1} = B_a\\xi_0 \\implies C_1 (a - b^2/a) = B_a\\xi_0 \\implies C_1 \\frac{a^2-b^2}{a} = B_a\\xi_0$。\n$$\nC_1 = \\frac{a B_a \\xi_0}{a^2 - b^2}, \\quad C_2 = -b^2 C_1 = -\\frac{a b^2 B_a \\xi_0}{a^2 - b^2}\n$$\n磁通函数为：\n$$\n\\psi(r, \\theta) = \\frac{a B_a \\xi_0}{a^2 - b^2} \\left( r - \\frac{b^2}{r} \\right) \\cos\\theta\n$$\n接下来，我们求扰动磁场的分量：\n$$\nB_{1r}(r, \\theta) = \\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} = \\frac{1}{r} \\frac{a B_a \\xi_0}{a^2 - b^2} \\left( r - \\frac{b^2}{r} \\right) (-\\sin\\theta) = \\frac{a B_a \\xi_0}{b^2 - a^2} \\left( 1 - \\frac{b^2}{r^2} \\right) \\sin\\theta\n$$\n$$\nB_{1\\theta}(r, \\theta) = -\\frac{\\partial \\psi}{\\partial r} = -\\frac{a B_a \\xi_0}{a^2 - b^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\cos\\theta = \\frac{a B_a \\xi_0}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\cos\\theta\n$$\n现在我们计算 $\\delta W_{\\text{vac}}$ 的能量积分。\n$$\n|\\mathbf{B}_1|^2 = B_{1r}^2 + B_{1\\theta}^2 = \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 \\sin^2\\theta + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\cos^2\\theta \\right]\n$$\n对 $\\theta$ 的积分为：\n$\\int_0^{2\\pi} |\\mathbf{B}_1|^2 d\\theta = \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 \\int_0^{2\\pi}\\sin^2\\theta d\\theta + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\int_0^{2\\pi}\\cos^2\\theta d\\theta \\right]$。\n使用 $\\int_0^{2\\pi}\\sin^2\\theta d\\theta = \\int_0^{2\\pi}\\cos^2\\theta d\\theta = \\pi$：\n$\\int_0^{2\\pi} |\\mathbf{B}_1|^2 d\\theta = \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\right]$。\n方括号中的项简化为 $(1 - \\frac{2b^2}{r^2} + \\frac{b^4}{r^4}) + (1 + \\frac{2b^2}{r^2} + \\frac{b^4}{r^4}) = 2 + \\frac{2b^4}{r^4} = 2(1 + \\frac{b^4}{r^4})$。\n所以，$\\delta W_{\\text{vac}} = \\frac{1}{2\\mu_0} \\int_a^b \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 2\\left(1 + \\frac{b^4}{r^4}\\right) r \\, dr$。\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi}{\\mu_0} \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\int_a^b \\left(r + \\frac{b^4}{r^3}\\right) dr\n$$\n剩下对 $r$ 的积分为：\n$\\int_a^b \\left(r + b^4 r^{-3}\\right) dr = \\left[ \\frac{r^2}{2} + b^4 \\frac{r^{-2}}{-2} \\right]_a^b = \\left[ \\frac{r^2}{2} - \\frac{b^4}{2r^2} \\right]_a^b$。\n$= \\left( \\frac{b^2}{2} - \\frac{b^4}{2b^2} \\right) - \\left( \\frac{a^2}{2} - \\frac{b^4}{2a^2} \\right) = \\left( \\frac{b^2}{2} - \\frac{b^2}{2} \\right) - \\frac{a^2}{2} + \\frac{b^4}{2a^2} = \\frac{b^4-a^4}{2a^2} = \\frac{(b^2-a^2)(b^2+a^2)}{2a^2}$。\n将此结果代回 $\\delta W_{\\text{vac}}$ 的表达式：\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi}{\\mu_0} \\frac{a^2 B_a^2 \\xi_0^2}{(b^2 - a^2)^2} \\frac{(b^2-a^2)(b^2+a^2)}{2a^2}\n$$\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi B_a^2 \\xi_0^2}{2\\mu_0} \\frac{b^2+a^2}{b^2-a^2}\n$$\n这就是单位轴向长度的真空能量贡献。\n\n对壁半径 $b$ 的依赖性包含在因子 $\\frac{b^2+a^2}{b^2-a^2}$ 中。我们可以将其重写为 $1 + \\frac{2a^2}{b^2-a^2}$。由于 $b>a$，该项总是正的。因此，真空能量贡献 $\\delta W_{\\text{vac}}$ 总是正的，这意味着真空场对该扰动起稳定作用。\n-   当壁靠近等离子体时（$b \\to a^+$），项 $\\frac{2a^2}{b^2-a^2} \\to \\infty$。因此，$\\delta W_{\\text{vac}} \\to \\infty$。这表明紧贴的壁具有非常强的稳定作用，因为产生给定的位移 $\\xi_0$ 需要无限大的能量。\n-   当壁移至无穷远时（$b \\to \\infty$），项 $\\frac{2a^2}{b^2-a^2} \\to 0$。在这种情况下，$\\delta W_{\\text{vac}}$ 趋近其最小值：$\\delta W_{\\text{vac}}(b \\to \\infty) = \\frac{\\pi B_a^2 \\xi_0^2}{2\\mu_0}$。\n总之，对于 $b>a$，$\\delta W_{\\text{vac}}$ 是壁半径 $b$ 的单调递减函数。导电壁的稳定作用在靠近等离子体时最强，远离时最弱。",
            "answer": "$$\n\\boxed{\\frac{\\pi B_{a}^{2} \\xi_{0}^{2}}{2 \\mu_{0}} \\frac{b^{2}+a^{2}}{b^{2}-a^{2}}}\n$$"
        },
        {
            "introduction": "对于复杂构型，解析求解最小化位移几乎是不可能的，这使得数值方法成为必需。本练习  介绍了瑞利-里兹方法，这是一种通过将最小化问题转化为矩阵方程来近似求解稳定性本征值 $\\lambda$ 的强大技术。您将亲手实现一个求解器，并对照著名的 Kruskal–Shafranov 稳定性判据进行验证，从而将计算方法与基础解析理论直接联系起来。",
            "id": "3721123",
            "problem": "要求您从第一性原理出发，实现一个瑞利-里兹（Rayleigh–Ritz）求解器，用于计算一个半径为 $a$、具有磁场 $B_{\\theta}(r)=\\mu\\,r$ 和 $B_{z}=\\text{constant}$ 的直、周期性、圆柱形等离子体柱中 $m=1$ 扭曲模的理想磁流体动力学（MHD）能量泛函的最小本征值。目标是数值近似与势能泛函 $\\delta W[\\xi]$ 相关的瑞利商 $\\lambda[\\xi]$ 的下确界，并根据解析的圆柱扭曲阈值验证数值结果。您必须生成一个单一、完整、可运行的程序，该程序实现此数值方法并按规定格式打印其结果。\n\n从理想磁流体动力学（MHD）能量原理出发，该原理指出，对于小的、无散度的位移 $\\boldsymbol{\\xi}$，势能的二阶变分 $\\delta W$ 决定了稳定性：如果对于所有容许的 $\\boldsymbol{\\xi}$ 都有 $\\delta W[\\boldsymbol{\\xi}] \\ge 0$，则模式是理想稳定的；如果存在一个容许的 $\\boldsymbol{\\xi}$ 使得 $\\delta W[\\boldsymbol{\\xi}]  0$，则模式是理想不稳定的。在圆柱几何中，对于低压（冷等离子体）柱和具有傅里叶依赖关系 $\\exp\\{i(m\\theta + kz)\\}$ 的不可压缩微扰，在薄真空壁近似下，$\\delta W$ 的主要线弯曲贡献可以由一个关于 $m=1$ 扭曲模的径向位移 $\\xi(r)$ 的简化一维泛函来捕捉。在此简化模型中，能量泛函为\n$$\n\\delta W[\\xi] \\;=\\; \\int_{0}^{a} r \\,\\mathrm{d}r \\left[ B_{z}^{2}\\,\\left|\\frac{\\mathrm{d}\\xi}{\\mathrm{d}r}\\right|^{2} \\;+\\; k^{2} B_{z}^{2}\\,|\\xi|^{2} \\right] \\;-\\; \\frac{B_{\\theta}(a)^{2}}{a^{2}} \\int_{0}^{a} r \\,|\\xi|^{2}\\,\\mathrm{d}r,\n$$\n该泛函对 $m=1$ 和所述平衡有效，其中负项表示与角向场相关的外部（真空）磁能的非稳定化贡献。对于 $B_{\\theta}(r) = \\mu\\, r$，有 $\\frac{B_{\\theta}(a)}{a} = \\mu$。用于定义广义本征值问题的相关瑞利商是\n$$\n\\lambda[\\xi] \\;=\\; \\frac{\\delta W[\\xi]}{\\displaystyle \\int_{0}^{a} r\\,|\\xi|^{2}\\,\\mathrm{d}r}.\n$$\n$m=1$ 的解析圆柱扭曲阈值可以写为 Kruskal–Shafranov 条件，此处表示为轴向波数为 $k$ 的周期性圆柱体，\n$$\nk\\,B_{z} \\;\\gtrless\\; \\frac{B_{\\theta}(a)}{a} \\quad\\Longleftrightarrow\\quad k^{2} B_{z}^{2} \\;\\gtrless\\; \\left(\\frac{B_{\\theta}(a)}{a}\\right)^{2},\n$$\n因此，简化模型对临界稳定点的预测对应于 $\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2} = 0$。\n\n使用由 $\\phi_{n}(r) = r^{n}$ 定义的多项式基 $\\{\\phi_{n}(r)\\}_{n=0}^{N-1}$ 实现瑞利-里兹方法，该基函数在 $r=0$ 处满足正则性。在此基下，构建对称刚度矩阵 $W$ 和质量矩阵 $M$：\n$$\nW_{ij} \\;=\\; \\int_{0}^{a} r\\,\\mathrm{d}r\\left[ B_{z}^{2} \\,\\frac{\\mathrm{d}\\phi_{i}}{\\mathrm{d}r} \\,\\frac{\\mathrm{d}\\phi_{j}}{\\mathrm{d}r} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\phi_{i}\\,\\phi_{j} \\right], \\qquad\nM_{ij} \\;=\\; \\int_{0}^{a} r\\,\\phi_{i}\\,\\phi_{j}\\,\\mathrm{d}r,\n$$\n并求解广义对称定本征值问题\n$$\nW\\,\\boldsymbol{c} \\;=\\; \\lambda\\, M\\,\\boldsymbol{c},\n$$\n以获得最小本征值 $\\lambda_{\\min}$，该值通过将 $\\xi$ 限制在所选基的张成空间内来近似 $\\inf_{\\xi}\\lambda[\\xi]$。在此简化模型中，常数基函数 $\\phi_{0}(r)=1$ 产生的瑞利商等于 $\\lambda_{\\text{analytic}} = k^{2}B_{z}^{2} - \\mu^{2}$，因此当基函数包含 $\\phi_{0}$ 时，瑞利-里兹近似应能精确再现解析阈值。\n\n对于 $\\phi_{n}(r) = r^{n}$，矩阵元素的数值积分可以以闭合形式完成：\n$$\nM_{ij} \\;=\\; \\int_{0}^{a} r^{i+j+1}\\,\\mathrm{d}r \\;=\\; \\frac{a^{i+j+2}}{i+j+2},\n$$\n$$\nW_{ij} \\;=\\; B_{z}^{2}\\,i\\,j\\,\\int_{0}^{a} r^{i+j-1}\\,\\mathrm{d}r \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,M_{ij} \\;=\\; B_{z}^{2}\\,i\\,j\\,\\frac{a^{i+j}}{i+j} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\frac{a^{i+j+2}}{i+j+2},\n$$\n需要理解的是，由于因子 $i$ 和 $j$，当 $i=0$ 或 $j=0$ 时，导数项消失。\n\n您的程序必须：\n- 实现上述定义的瑞利-里兹方法。\n- 对于每个提供的测试用例，计算最小本征值 $\\lambda_{\\min}$，并通过检查符号分类（如果 $\\lambda_{\\min} > 0$ 则稳定，如果 $\\lambda_{\\min}  0$ 则不稳定，如果 $|\\lambda_{\\min}|$ 在数值公差范围内则为临界稳定）是否与从 Kruskal–Shafranov 条件导出的解析分类相匹配，将其与解析预测 $\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2}$ 进行比较。\n- 将 $\\lambda_{\\min}$ 以浮点数形式表示，单位为 $\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$（特斯拉平方/米平方）。\n- 使用 $10^{-8}$ 的数值公差来将一个值分类为临界零。\n\n测试套件：\n使用以下测试用例，每个用例指定为元组 $(a, B_{z}, k, \\mu, N)$，其中 $a$ 的单位是米， $B_{z}$ 的单位是特斯拉， $k$ 的单位是米^-1， $\\mu$ 的单位是特斯拉/米， $N$ 是基函数的数量：\n1. $(1.0,\\, 1.0,\\, 1.0,\\, 0.8,\\, 6)$。\n2. $(0.5,\\, 1.5,\\, 2.0,\\, 3.0,\\, 5)$。\n3. $(1.0,\\, 0.5,\\, 0.5,\\, 0.4,\\, 8)$。\n4. $(2.0,\\, 0.8,\\, 0.25,\\, 0.1,\\, 4)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，对于每个测试用例，您需要输出最小本征值，后跟一个布尔值，指示数值符号分类是否与解析扭曲阈值分类匹配。具体而言，输出必须采用以下格式\n$[\\lambda_{1},\\,\\texttt{match}_{1},\\,\\lambda_{2},\\,\\texttt{match}_{2},\\,\\lambda_{3},\\,\\texttt{match}_{3},\\,\\lambda_{4},\\,\\texttt{match}_{4}]$，\n其中所有 $\\lambda_{i}$ 的单位为 $\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$。",
            "solution": "我们从理想磁流体动力学（MHD）能量原理出发，该原理指出，在理想极限下，等离子体的稳定性由在动力学可及的微扰 $\\boldsymbol{\\xi}$ 下势能的二阶变分 $\\delta W[\\boldsymbol{\\xi}]$ 的符号决定。对于满足 $\\nabla\\cdot \\boldsymbol{\\xi} = 0$ 的不可压缩位移场，在压力效应可忽略不计的低压等离子体中，$\\delta W$ 的主要贡献来自磁力线弯曲以及与外部真空的相互作用。\n\n在圆柱几何中，对于平衡磁场 $\\boldsymbol{B}(r)=B_{z}\\,\\hat{\\boldsymbol{z}} + B_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}}$ 和非旋转的低压平衡，考虑具有角向模数 $m$ 和轴向波数 $k$ 的傅里叶微扰，即对于 $m=1$ 扭曲模附近的主要径向分量，有 $\\boldsymbol{\\xi}(r,\\theta,z) = \\xi_{r}(r)\\,\\hat{\\boldsymbol{r}}\\,\\exp\\{i(m\\theta + kz)\\}$。对于 $m=1$，该模式类似于等离子体柱的刚性横向位移。在冷等离子体极限和不可压缩位移的情况下，理想 MHD 能量原理得出的磁能变化主要由线弯曲主导，\n$$\n\\delta W_{\\text{bend}} \\sim \\frac{1}{2\\mu_{0}} \\int \\mathrm{d}V\\, \\left|\\boldsymbol{B}\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}\\right|^{2},\n$$\n其中 $\\boldsymbol{\\xi}_{\\perp}$ 是横向位移。对于所述的傅里叶依赖关系和给定的平衡，沿磁力线的纵向导数贡献一个与 $k^{2}B_{z}^{2}|\\xi|^{2}$ 成正比的项，而径向剪切贡献 $B_{z}^{2}|\\mathrm{d}\\xi/\\mathrm{d}r|^{2}$。此外，外部真空磁场会响应边界位移而发生微扰，从而产生一个非稳定化的贡献。在薄真空壁近似下，该贡献可以表示为一个有效的负项，其大小与边界角向场平方 $B_{\\theta}(a)^{2}$ 乘以边界位移平方成正比。在 $m=1$ 刚性位移近似下，边界位移代表了内部位移的振幅，因此真空贡献可以建模为一个与 $\\int r|\\xi|^{2}\\,\\mathrm{d}r$ 成正比的均匀负项。将这些部分汇总起来，我们得到 $m=1$ 模式的简化一维能量泛函，\n$$\n\\delta W[\\xi] \\;=\\; \\int_{0}^{a} r \\,\\mathrm{d}r \\left[ B_{z}^{2}\\,\\left|\\frac{\\mathrm{d}\\xi}{\\mathrm{d}r}\\right|^{2} \\;+\\; k^{2} B_{z}^{2}\\,|\\xi|^{2} \\right] \\;-\\; \\frac{B_{\\theta}(a)^{2}}{a^{2}} \\int_{0}^{a} r \\,|\\xi|^{2}\\,\\mathrm{d}r.\n$$\n对于平衡 $B_{\\theta}(r) = \\mu\\,r$，我们有 $\\frac{B_{\\theta}(a)}{a}= \\mu$，其中 $\\mu$ 的单位是特斯拉/米。该模型根据 Kruskal–Shafranov 条件，捕捉了扭曲稳定性阈值对轴向场强和边界角向场的基本依赖关系。\n\n为了计算瑞利商\n$$\n\\lambda[\\xi] \\;=\\; \\frac{\\delta W[\\xi]}{\\displaystyle \\int_{0}^{a} r\\,|\\xi|^{2}\\,\\mathrm{d}r},\n$$\n的最小值，我们使用瑞利-里兹方法，该方法通过一个有限基将无限维最小化问题简化为广义矩阵本征值问题。选择多项式基 $\\phi_{n}(r)=r^{n}$，其中 $n=0,1,\\dots,N-1$。该基在 $r=0$ 处是正则的，并通过 $\\phi_{0}(r)=1$ 包含了物理上相关的刚性位移分量。\n\n使用这个基，限制在 $\\{\\phi_{n}\\}$ 张成空间内的瑞利商等价于广义对称定本征问题\n$$\nW\\,\\boldsymbol{c} \\;=\\; \\lambda\\, M\\,\\boldsymbol{c},\n$$\n的最小本征值，其中刚度矩阵 $W$ 和质量矩阵 $M$ 的元素为\n$$\nM_{ij} \\;=\\; \\int_{0}^{a} r\\,\\phi_{i}\\,\\phi_{j}\\,\\mathrm{d}r \\;=\\; \\int_{0}^{a} r^{i+j+1}\\,\\mathrm{d}r \\;=\\; \\frac{a^{i+j+2}}{i+j+2},\n$$\n$$\nW_{ij} \\;=\\; \\int_{0}^{a} r\\,\\left[ B_{z}^{2} \\,\\frac{\\mathrm{d}\\phi_{i}}{\\mathrm{d}r} \\,\\frac{\\mathrm{d}\\phi_{j}}{\\mathrm{d}r} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\phi_{i}\\,\\phi_{j} \\right] \\mathrm{d}r \\;=\\; B_{z}^{2}\\,i\\,j\\,\\frac{a^{i+j}}{i+j} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\frac{a^{i+j+2}}{i+j+2},\n$$\n需要理解的是，由于前置因子 $i\\,j$，当 $i=0$ 或 $j=0$ 时，导数贡献消失。这些积分是精确的，并产生对称的实数矩阵。对于所选的基，矩阵 $M$ 是正定的，而 $W$ 是对称的，因此广义本征值是实数，可以使用针对对称定矩阵对的鲁棒求解器进行计算。\n\n从此广义本征问题获得的最小本征值 $\\lambda_{\\min}$ 近似了在该基所张成的函数空间上瑞利商的下确界。由于该基包含 $\\phi_{0}$，在 $\\phi_{0}$ 上计算的瑞利商恰好是\n$$\n\\lambda[\\phi_{0}] \\;=\\; \\frac{\\left(k^{2} B_{z}^{2} - \\mu^{2}\\right) \\int_{0}^{a} r\\,\\mathrm{d}r}{\\int_{0}^{a} r\\,\\mathrm{d}r} \\;=\\; k^{2} B_{z}^{2} - \\mu^{2},\n$$\n因为对于常数函数，导数项为零。因此，当 $\\phi_{0}$ 存在时，瑞利-里兹方法精确地再现了简化模型对临界稳定点的解析预测。这为与 Kruskal–Shafranov 条件相关的圆柱扭曲阈值提供了一个直接的数值验证，此处用 $k$、$B_{z}$ 和 $B_{\\theta}(a)/a=\\mu$ 来表示。\n\n算法步骤：\n1. 对于每个测试用例 $(a, B_{z}, k, \\mu, N)$，使用上述闭合形式积分为基大小 $N$ 构建矩阵 $W$ 和 $M$。\n2. 使用保留对称性的广义本征值求解器（例如，专门用于对称定问题的函数）求解 $W\\,\\boldsymbol{c} = \\lambda\\, M\\,\\boldsymbol{c}$ 以得到 $\\lambda$。\n3. 提取最小本征值 $\\lambda_{\\min}$ 并将其分类：如果 $\\lambda_{\\min} > \\varepsilon$ 则稳定，如果 $\\lambda_{\\min}  -\\varepsilon$ 则不稳定，如果 $|\\lambda_{\\min}| \\le \\varepsilon$ 则临界稳定，其中 $\\varepsilon$ 是一个小的公差（使用 $\\varepsilon=10^{-8}$）。\n4. 使用相同的公差，根据 $\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2}$ 的符号计算解析分类。\n5. 对于每个用例，报告数值 $\\lambda_{\\min}$（单位为 $\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$）和一个布尔值，指示数值分类是否与解析分类匹配。\n\n该测试套件包括四个用例，用于探测：\n- 一个 $\\lambda_{\\text{analytic}} > 0$ 的常规稳定区域。\n- 一个 $\\lambda_{\\text{analytic}} = 0$ 的临界区域。\n- 一个 $\\lambda_{\\text{analytic}}  0$ 的不稳定区域。\n- 一个具有不同 $a$ 和较小基大小的用例，以检查方法的鲁棒性。\n\n最终程序为每个测试用例构建并求解广义本征问题，并按照规定，打印一个包含每个用例的最小本征值和验证布尔值的聚合列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef assemble_matrices(N, a, Bz, k, mu):\n    \"\"\"\n    Assemble stiffness matrix W and mass matrix M for the Rayleigh–Ritz method\n    using polynomial basis phi_n(r) = r^n, n=0..N-1.\n\n    W_ij = Bz^2 * i * j * a^(i+j) / (i + j) + (k^2 * Bz^2 - mu^2) * a^(i+j+2) / (i + j + 2)\n    M_ij = a^(i+j+2) / (i + j + 2)\n    with the convention that the derivative contribution vanishes for i=0 or j=0.\n    \"\"\"\n    W = np.zeros((N, N), dtype=float)\n    M = np.zeros((N, N), dtype=float)\n    # Precompute powers of a for efficiency\n    # Max power needed is i+j+2 for M and i+j for derivative term\n    # We'll compute on the fly using pow to avoid large arrays\n    for i in range(N):\n        for j in range(N):\n            # Mass matrix element\n            denom_m = i + j + 2\n            M_ij = (a ** (i + j + 2)) / denom_m\n            M[i, j] = M_ij\n            # Stiffness matrix element\n            # Derivative term\n            deriv_term = 0.0\n            if i > 0 and j > 0:\n                denom_w = i + j\n                deriv_term = (Bz ** 2) * i * j * (a ** (i + j)) / denom_w\n            W[i, j] = deriv_term + (k ** 2 * Bz ** 2 - mu ** 2) * M_ij\n    return W, M\n\ndef smallest_generalized_eigenvalue(W, M):\n    \"\"\"\n    Solve the generalized symmetric definite eigenproblem W x = lambda M x\n    and return the smallest eigenvalue.\n    \"\"\"\n    # eigh solves for symmetric (Hermitian) matrices and supports generalized problems.\n    # We request only eigenvalues for efficiency and sort ascending.\n    evals = eigh(W, M, eigvals_only=True)\n    # eigh returns sorted eigenvalues in ascending order by default for Hermitian problems\n    lam_min = float(evals[0])\n    return lam_min\n\ndef classify(value, tol=1e-8):\n    \"\"\"\n    Classify a float value with tolerance:\n    +1 for positive (> tol), -1 for negative ( -tol), 0 for near-zero (abs = tol).\n    \"\"\"\n    if value > tol:\n        return 1\n    elif value  -tol:\n        return -1\n    else:\n        return 0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (a [m], Bz [T], k [1/m], mu [T/m], N [basis size])\n    test_cases = [\n        (1.0, 1.0, 1.0, 0.8, 6),    # Stable: k^2 Bz^2 - mu^2 = 1 - 0.64 = 0.36\n        (0.5, 1.5, 2.0, 3.0, 5),    # Marginal: k^2 Bz^2 - mu^2 = 9 - 9 = 0\n        (1.0, 0.5, 0.5, 0.4, 8),    # Unstable: k^2 Bz^2 - mu^2 = 0.0625 - 0.16 = -0.0975\n        (2.0, 0.8, 0.25, 0.1, 4),   # Stable: k^2 Bz^2 - mu^2 = 0.04 - 0.01 = 0.03\n    ]\n\n    results = []\n    tol = 1e-8\n    for a, Bz, k, mu, N in test_cases:\n        W, M = assemble_matrices(N, a, Bz, k, mu)\n        lam_min = smallest_generalized_eigenvalue(W, M)\n        # Analytic prediction from reduced model: lambda_analytic = k^2 Bz^2 - mu^2\n        lam_analytic = k**2 * Bz**2 - mu**2\n        # Compare sign classifications with tolerance\n        cls_num = classify(lam_min, tol=tol)\n        cls_ana = classify(lam_analytic, tol=tol)\n        match = (cls_num == cls_ana)\n        results.append(lam_min)\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}