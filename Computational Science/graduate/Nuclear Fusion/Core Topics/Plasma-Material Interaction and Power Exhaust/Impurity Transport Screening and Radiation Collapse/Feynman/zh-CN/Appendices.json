{
    "hands_on_practices": [
        {
            "introduction": "在高温聚变等离子体中，杂质原子的电荷态不是单一的，而是遵循一个由碰撞过程决定的分布。这个练习将带你通过一个简化但核心的模型——“电晕平衡”模型，来理解这一分布是如何形成的。通过平衡电子碰撞电离和复合这两个关键的原子过程，你将能估算出杂质的平均电荷态，这是评估其辐射能力和对等离子体影响的基础。",
            "id": "3703796",
            "problem": "在电晕极限下，磁约束聚变等离子体中存在痕量的高$Z$杂质，其中稳态电荷态布居由向前的碰撞电离和向后的复合之间的平衡决定。设电子温度 $T_{e}$ 在千电子伏（keV）范围内，并将碰撞电离速率系数记为 $S_{i}(T_{e})$，双电子复合速率系数记为 $\\alpha_{i}^{\\mathrm{DR}}(T_{e})$。假设：\n- $S_{i}(T_{e})$ 的标度关系为 $S_{*}\\,(T_{e}/T_{*})^{1/2}$，\n- $\\alpha_{i}^{\\mathrm{DR}}(T_{e})$ 的标度关系为 $\\alpha_{*}\\,(T_{e}/T_{*})^{-3/2}\\,\\exp(-E_{c}/T_{e})$，\n其中 $S_{*}$ 和 $\\alpha_{*}$ 是在 $T_{*}$ 处的参考系数，$E_{c}$ 是双电子复合过程中的芯激发能。在电晕稳态下，布居数最多的电荷态 $Z^{\\star}$ 由该阶段的向前和向后速率近似相等来决定。\n\n要估算平均电荷 $\\langle Z \\rangle$，请按以下步骤进行：\n1. 使用稳态条件和上述标度关系，用 $T_{e}$、$S_{*}$、$\\alpha_{*}$ 和 $T_{*}$ 来表示 $E_{c}$（在峰值阶段）的值。\n2. 在高电荷、弱屏蔽极限下，用类氢标度关系 $E_{c}(Z) \\approx \\epsilon_{0}\\,Z^{2}$ 来模拟双电子复合的芯激发能，其中 $\\epsilon_{0}$ 由价壳层的有效主量子数设定。对于镍杂质（核电荷数 $Z_{0}=28$），取 $\\epsilon_{0} = (13.6\\,\\mathrm{eV})/n_{\\mathrm{eff}}^{2}$，其中 $n_{\\mathrm{eff}}=3$，并以 keV 为单位表示。\n3. 将步骤1的结果与步骤2的标度关系结合使用，估算 $Z^{\\star}$，并取 $\\langle Z \\rangle \\approx Z^{\\star}$。\n\n给定数值 $T_{e} = 1.0\\,\\mathrm{keV}$，$T_{*} = 1.0\\,\\mathrm{keV}$，$S_{*} = 5.0 \\times 10^{-11}\\,\\mathrm{cm^{3}\\,s^{-1}}$，$\\alpha_{*} = 1.0 \\times 10^{-10}\\,\\mathrm{cm^{3}\\,s^{-1}}$，以及 $\\epsilon_{0} = 0.0136/9\\,\\mathrm{keV}$，计算平均电荷 $\\langle Z \\rangle$ 的估算值。将 $\\langle Z \\rangle$ 的最终值四舍五入到三位有效数字。将 $\\langle Z \\rangle$ 表示为一个没有单位的纯数。\n\n最后，根据给定的温度标度关系，指出在 keV 范围内的 $T_{e}$ 下，哪种复合通道预计会占主导地位，并简要说明你的结论。",
            "solution": "电晕稳态使得从电荷态 $Z$ 到 $Z+1$ 的向前电离通量与从 $Z+1$ 到 $Z$ 的向后复合通量相等。对于相邻的阶段，电荷态分布峰值（布居数最多的阶段）的条件是该阶段的有效电离速率系数和有效复合速率系数相当。使用给定的标度关系，我们写出\n$$\nS_{i}(T_{e}) = S_{*}\\left(\\frac{T_{e}}{T_{*}}\\right)^{1/2}, \\qquad\n\\alpha_{i}^{\\mathrm{DR}}(T_{e}) = \\alpha_{*}\\left(\\frac{T_{e}}{T_{*}}\\right)^{-3/2}\\exp\\!\\left(-\\frac{E_{c}}{T_{e}}\\right).\n$$\n在峰值阶段，我们令 $S_{i}(T_{e}) \\approx \\alpha_{i}^{\\mathrm{DR}}(T_{e})$ 来确定所需的芯激发能 $E_{c}$：\n$$\nS_{*}\\left(\\frac{T_{e}}{T_{*}}\\right)^{1/2} \\approx \\alpha_{*}\\left(\\frac{T_{e}}{T_{*}}\\right)^{-3/2}\\exp\\!\\left(-\\frac{E_{c}}{T_{e}}\\right).\n$$\n求解 $E_{c}$，\n\\begin{align*}\n\\exp\\!\\left(-\\frac{E_{c}}{T_{e}}\\right) \\approx \\frac{S_{*}}{\\alpha_{*}}\\left(\\frac{T_{e}}{T_{*}}\\right)^{2}, \\\\\n-\\frac{E_{c}}{T_{e}} \\approx \\ln\\!\\left(\\frac{S_{*}}{\\alpha_{*}}\\right) + 2\\ln\\!\\left(\\frac{T_{e}}{T_{*}}\\right), \\\\\nE_{c} \\approx -\\,T_{e}\\,\\Bigg[\\,\\ln\\!\\left(\\frac{S_{*}}{\\alpha_{*}}\\right) + 2\\ln\\!\\left(\\frac{T_{e}}{T_{*}}\\right)\\,\\Bigg].\n\\end{align*}\n这个关系式将温度和速率系数前置因子的比值与最有效地平衡电离和双电子复合的芯激发能联系起来。\n\n接下来，为了将 $E_{c}$ 与电荷态联系起来，我们对双电子复合中起主导作用的芯激发使用高电荷、弱屏蔽的类氢标度关系：\n$$\nE_{c}(Z) \\approx \\epsilon_{0}\\,Z^{2},\n$$\n其中 $\\epsilon_{0} = (13.6\\,\\mathrm{eV})/n_{\\mathrm{eff}}^{2}$ 以 $\\mathrm{keV}$ 为单位表示。对于镍，我们取 $n_{\\mathrm{eff}}=3$，所以\n$$\n\\epsilon_{0} = \\frac{13.6}{9}\\,\\mathrm{eV} = \\frac{13.6}{9}\\times 10^{-3}\\,\\mathrm{keV} \\approx 0.001511\\,\\mathrm{keV}.\n$$\n令峰值阶段的两个 $E_{c}$ 表达式相等，可得\n$$\n\\epsilon_{0}\\,Z^{2} \\approx -\\,T_{e}\\,\\Bigg[\\,\\ln\\!\\left(\\frac{S_{*}}{\\alpha_{*}}\\right) + 2\\ln\\!\\left(\\frac{T_{e}}{T_{*}}\\right)\\,\\Bigg],\n$$\n因此\n$$\nZ^{\\star} \\approx \\left\\{ -\\,\\frac{T_{e}}{\\epsilon_{0}}\\,\\Bigg[\\,\\ln\\!\\left(\\frac{S_{*}}{\\alpha_{*}}\\right) + 2\\ln\\!\\left(\\frac{T_{e}}{T_{*}}\\right)\\,\\Bigg] \\right\\}^{1/2}.\n$$\n对于在其最大值附近呈尖峰状的电晕分布，平均电荷可以很好地用布居数最多的电荷态来近似，所以我们取 $\\langle Z \\rangle \\approx Z^{\\star}$。\n\n现在我们代入给定的数值。当 $T_{e} = T_{*} = 1.0\\,\\mathrm{keV}$ 时，温度比为1，对数项简化为：\n$$\n\\ln\\!\\left(\\frac{S_{*}}{\\alpha_{*}}\\right) = \\ln\\!\\left(\\frac{5.0 \\times 10^{-11}}{1.0 \\times 10^{-10}}\\right) = \\ln(0.5) = -\\ln(2) \\approx -0.693147.\n$$\n因此\n$$\nE_{c} \\approx -\\,T_{e}\\,\\ln\\!\\left(\\frac{S_{*}}{\\alpha_{*}}\\right) = (1.0\\,\\mathrm{keV})\\times 0.693147 \\approx 0.693147\\,\\mathrm{keV}.\n$$\n使用 $\\epsilon_{0} \\approx 0.001511\\,\\mathrm{keV}$，\n\\begin{align*}\nZ^{\\star} \\approx \\left(\\frac{E_{c}}{\\epsilon_{0}}\\right)^{1/2} \\approx \\left(\\frac{0.693147}{0.001511}\\right)^{1/2}.\n\\end{align*}\n计算比值：\n$$\n\\frac{0.693147}{0.001511} \\approx 458.5,\n$$\n然后取平方根：\n$$\nZ^{\\star} \\approx \\sqrt{458.5} \\approx 21.4.\n$$\n因此，估算的平均电荷为 $\\langle Z \\rangle \\approx 21.4$。四舍五入到三位有效数字，结果仍为 $21.4$。\n\n最后，关于在 keV 范围内的 $T_{e}$ 下占主导地位的复合通道：双电子复合（DR）的标度关系为 $\\alpha_{i}^{\\mathrm{DR}} \\propto T_{e}^{-3/2}\\exp(-E_{c}/T_{e})$，而辐射复合（RR）的标度关系近似为 $\\alpha_{i}^{\\mathrm{RR}} \\propto T_{e}^{-3/2}$，没有共振指数因子。对于高$Z$离子，存在许多间距很近的芯激发，其 $E_{c}$ 在亚keV到keV范围内；在 $T_{e}\\sim 1\\,\\mathrm{keV}$ 时，$\\exp(-E_{c}/T_{e})$ 没有很强的抑制作用，并且由于共振俘获，DR 的前置因子很大。因此，在 keV 区，对于高$Z$杂质，DR 通常主导于 RR，从而决定了复合平衡并因此决定了平均电荷。",
            "answer": "$$\\boxed{21.4}$$"
        },
        {
            "introduction": "知道了杂质的电荷态特性后，下一个关键问题是它们在等离子体中如何分布。这个实践练习将引导你使用对流-扩散方程，这是描述粒子输运的基本模型，来求解杂质在等离子体中的稳态密度分布。通过求解这个问题，你将深入理解扩散和对流（包括所谓的“杂质屏蔽”效应）如何共同作用，并掌握计算“峰化因子”这一衡量杂质芯部聚集程度的关键参数。",
            "id": "3703817",
            "problem": "考虑一个环形聚变等离子体，其中电荷态为 $z$ 的杂质粒子，其磁通面平均密度 $n_z(\\psi)$ 在闭合磁通面上仅取决于极向磁通坐标 $\\psi$，其中 $0 \\leq \\psi \\leq \\psi_a$，$\\psi_a$ 标记最后一个闭合磁通面（分界面）。假设杂质的径向粒子通量可以很好地用一个常系数的对流-扩散闭合关系来描述，\n$$\\Gamma_z(\\psi) = - D_z \\,\\frac{d n_z}{d \\psi} + V_z \\, n_z,$$\n其中 $D_z  0$ 是粒子扩散系数，$V_z  0$ 是模拟杂质屏蔽效应的向外对流速度。在稳态下，连续性方程简化为通量平衡，\n$$\\frac{d \\Gamma_z}{d \\psi} = S_z(\\psi),$$\n其中 $S_z(\\psi)$ 是一个局域在分界面附近的源。将边缘局域的注入建模为一个狄拉克δ函数源\n$$S_z(\\psi) = S_0 \\,\\delta(\\psi - \\psi_s),$$\n其中 $0  \\psi_s  \\psi_a$，$S_0  0$ 是一个常数。施加以下具有物理动机的边界条件：\n- 在磁轴（$\\psi = 0$）处，对称性和内部无源的条件意味着没有净杂质通量，因此 $\\Gamma_z(0) = 0$。\n- 在分界面（$\\psi = \\psi_a$）处，进入刮削层（SOL）的平行出流提供了一种排气机制，该机制被建模为一个线性损失条件 $\\Gamma_z(\\psi_a) = \\Lambda \\, n_z(\\psi_a)$，其中 $\\Lambda  0$ 是一个常数。\n\n仅从上述输运闭合关系、稳态连续性方程和边界条件出发，推导在 $0 \\leq \\psi \\leq \\psi_a$ 范围内的稳态杂质密度分布 $n_z(\\psi)$ 的闭合形式解，然后计算峰化因子\n$$P \\equiv \\frac{n_z(0)}{n_z(\\psi_a)}.$$\n将 $P$ 的最终答案表示为包含 $D_z$、$V_z$、$\\Lambda$、$\\psi_s$ 和 $\\psi_a$ 的单一解析表达式。峰化因子是无量纲的；不要包含单位。不需要进行数值近似或四舍五入。",
            "solution": "问题要求解出稳态杂质密度分布 $n_z(\\psi)$ 和相应的峰化因子 $P \\equiv n_z(0)/n_z(\\psi_a)$。该求解过程由环形等离子体中的对流-扩散输运模型所控制。\n\n首先，我们建立杂质密度 $n_z(\\psi)$ 的控制微分方程。杂质径向通量由下式给出\n$$ \\Gamma_z(\\psi) = - D_z \\frac{d n_z}{d \\psi} + V_z n_z $$\n在稳态下，连续性方程为\n$$ \\frac{d \\Gamma_z}{d \\psi} = S_z(\\psi) $$\n其中源是一个狄拉克δ函数 $S_z(\\psi) = S_0 \\delta(\\psi - \\psi_s)$。将通量表达式代入连续性方程，得到关于 $n_z(\\psi)$ 的二阶常微分方程：\n$$ \\frac{d}{d\\psi}\\left(- D_z \\frac{d n_z}{d \\psi} + V_z n_z\\right) = S_0 \\delta(\\psi - \\psi_s) $$\n假设系数 $D_z$ 和 $V_z$ 为常数，方程变为\n$$ -D_z \\frac{d^2 n_z}{d \\psi^2} + V_z \\frac{d n_z}{d \\psi} = S_0 \\delta(\\psi - \\psi_s) $$\n我们可以通过从一个任意起点积分连续性方程来直接分析通量 $\\Gamma_z(\\psi)$。从 $\\psi=0$ 积分到任意 $\\psi$ 可得：\n$$ \\int_{0}^{\\psi} \\frac{d \\Gamma_z}{d \\psi'} d\\psi' = \\int_{0}^{\\psi} S_0 \\delta(\\psi' - \\psi_s) d\\psi' $$\n$$ \\Gamma_z(\\psi) - \\Gamma_z(0) = S_0 \\int_{0}^{\\psi} \\delta(\\psi' - \\psi_s) d\\psi' $$\n磁轴处的边界条件是 $\\Gamma_z(0) = 0$。δ函数的积分是赫维赛德阶跃函数 $H(\\psi - \\psi_s)$。因此，通量分布为\n$$ \\Gamma_z(\\psi) = S_0 H(\\psi - \\psi_s) $$\n这意味着在核心区通量为零，而在 $\\psi  \\psi_s$ 的区域为常数：\n- 对于 $0 \\leq \\psi  \\psi_s$：$\\Gamma_z(\\psi) = 0$。\n- 对于 $\\psi_s  \\psi \\leq \\psi_a$：$\\Gamma_z(\\psi) = S_0$。\n\n在已知通量分布的情况下，我们可以在两个独立的区域求解密度分布 $n_z(\\psi)$。我们将在内部区域（$0 \\leq \\psi \\leq \\psi_s$）的密度定义为 $n_1(\\psi)$，在外部区域（$\\psi_s \\leq \\psi \\leq \\psi_a$）的密度定义为 $n_2(\\psi)$。\n\n区域 1：$0 \\leq \\psi \\leq \\psi_s$\n在此区域，$\\Gamma_z(\\psi) = 0$。输运方程变为\n$$ - D_z \\frac{d n_1}{d \\psi} + V_z n_1 = 0 \\implies \\frac{d n_1}{d \\psi} = \\frac{V_z}{D_z} n_1 $$\n我们定义逆尺度长度 $k \\equiv V_z/D_z  0$。方程为 $\\frac{d n_1}{d \\psi} = k n_1$。这是一个一阶可分离常微分方程，其通解为：\n$$ n_1(\\psi) = C_1 \\exp(k\\psi) $$\n其中 $C_1$ 是一个积分常数。\n\n区域 2：$\\psi_s \\leq \\psi \\leq \\psi_a$\n在此区域，$\\Gamma_z(\\psi) = S_0$。输运方程为\n$$ - D_z \\frac{d n_2}{d \\psi} + V_z n_2 = S_0 \\implies \\frac{d n_2}{d \\psi} - k n_2 = -\\frac{S_0}{D_z} $$\n这是一个一阶线性非齐次常微分方程。通解是齐次解 $C_2 \\exp(k\\psi)$ 与一个特解之和。一个常数特解 $n_{2,p} = S_0/V_z$ 满足该方程。因此，通解为：\n$$ n_2(\\psi) = \\frac{S_0}{V_z} + C_2 \\exp(k\\psi) $$\n其中 $C_2$ 是另一个积分常数。\n\n现在，我们必须应用余下的边界条件和在源位置处的密度连续性条件来确定常数 $C_1$ 和 $C_2$。\n密度分布在 $\\psi = \\psi_s$ 处必须是连续的：\n$$ n_1(\\psi_s) = n_2(\\psi_s) $$\n$$ C_1 \\exp(k\\psi_s) = \\frac{S_0}{V_z} + C_2 \\exp(k\\psi_s) $$\n（方程 1）\n\n在分界面（$\\psi = \\psi_a$）处的边界条件是 $\\Gamma_z(\\psi_a) = \\Lambda n_z(\\psi_a)$。在此区域，$\\Gamma_z(\\psi_a) = S_0$。因此：\n$$ S_0 = \\Lambda n_z(\\psi_a) \\implies n_z(\\psi_a) = \\frac{S_0}{\\Lambda} $$\n由于 $\\psi_a$ 位于区域 2，我们有 $n_z(\\psi_a) = n_2(\\psi_a)$：\n$$ \\frac{S_0}{\\Lambda} = \\frac{S_0}{V_z} + C_2 \\exp(k\\psi_a) $$\n我们可以由此解出 $C_2$：\n$$ C_2 \\exp(k\\psi_a) = \\frac{S_0}{\\Lambda} - \\frac{S_0}{V_z} = S_0 \\left(\\frac{1}{\\Lambda} - \\frac{1}{V_z}\\right) $$\n$$ C_2 = S_0 \\left(\\frac{1}{\\Lambda} - \\frac{1}{V_z}\\right) \\exp(-k\\psi_a) $$\n\n现在，将 $C_2$ 代回方程 1 以求出 $C_1$：\n$$ C_1 \\exp(k\\psi_s) = \\frac{S_0}{V_z} + \\left[S_0 \\left(\\frac{1}{\\Lambda} - \\frac{1}{V_z}\\right) \\exp(-k\\psi_a)\\right] \\exp(k\\psi_s) $$\n两边同除以 $\\exp(k\\psi_s)$：\n$$ C_1 = \\frac{S_0}{V_z} \\exp(-k\\psi_s) + S_0 \\left(\\frac{1}{\\Lambda} - \\frac{1}{V_z}\\right) \\exp(-k\\psi_a) $$\n这确定了在所有 $\\psi \\in [0, \\psi_a]$ 上的密度分布。磁轴（$\\psi=0$）处的密度为\n$$ n_z(0) = n_1(0) = C_1 \\exp(0) = C_1 $$\n$$ n_z(0) = S_0 \\left[ \\frac{\\exp(-k\\psi_s)}{V_z} + \\left(\\frac{1}{\\Lambda} - \\frac{1}{V_z}\\right) \\exp(-k\\psi_a) \\right] $$\n分界面（$\\psi=\\psi_a$）处的密度为\n$$ n_z(\\psi_a) = \\frac{S_0}{\\Lambda} $$\n峰化因子 $P$ 是这两个密度的比值：\n$$ P = \\frac{n_z(0)}{n_z(\\psi_a)} = \\frac{S_0 \\left[ \\frac{\\exp(-k\\psi_s)}{V_z} + \\left(\\frac{1}{\\Lambda} - \\frac{1}{V_z}\\right) \\exp(-k\\psi_a) \\right]}{S_0/\\Lambda} $$\n源强度 $S_0$ 被消掉：\n$$ P = \\Lambda \\left[ \\frac{\\exp(-k\\psi_s)}{V_z} + \\frac{\\exp(-k\\psi_a)}{\\Lambda} - \\frac{\\exp(-k\\psi_a)}{V_z} \\right] $$\n$$ P = \\frac{\\Lambda}{V_z} \\exp(-k\\psi_s) + \\exp(-k\\psi_a) - \\frac{\\Lambda}{V_z} \\exp(-k\\psi_a) $$\n整理各项：\n$$ P = \\left(1 - \\frac{\\Lambda}{V_z}\\right) \\exp(-k\\psi_a) + \\frac{\\Lambda}{V_z} \\exp(-k\\psi_s) $$\n最后，代回 $k = V_z/D_z$：\n$$ P = \\left(1 - \\frac{\\Lambda}{V_z}\\right) \\exp\\left(-\\frac{V_z}{D_z}\\psi_a\\right) + \\frac{\\Lambda}{V_z} \\exp\\left(-\\frac{V_z}{D_z}\\psi_s\\right) $$\n这就是用给定参数表示的杂质峰化因子的最终表达式。",
            "answer": "$$\\boxed{\\left(1 - \\frac{\\Lambda}{V_z}\\right) \\exp\\left(-\\frac{V_z \\psi_a}{D_z}\\right) + \\frac{\\Lambda}{V_z} \\exp\\left(-\\frac{V_z \\psi_s}{D_z}\\right)}$$"
        },
        {
            "introduction": "当杂质在芯部的辐射功率超过加热功率时，会引发一种灾难性的“辐射坍塌”现象。这个综合性练习将理论与计算相结合，让你亲手模拟这一过程的关键动力学——辐射前沿的移动。通过将杂质输运方程与辐射功率平衡联系起来，你将推导出辐射前沿的传播速度，并对其进行数值计算，从而直观地理解杂质积累如何驱动等离子体发生热不稳定性。",
            "id": "3703780",
            "problem": "考虑一个用于描述磁约束等离子体中杂质输运和辐射的一维平板模型，其类径向坐标 $x \\in [0,a]$ 从核心 $x=0$ 处向外增加至边界 $x=a$ 处。设 $n_z(x,t)$ 为总杂质密度，$n_e(x)$ 为电子密度，$T_e(x,t)$ 为电子温度，$L_z(T_e)$ 为杂质辐射冷却系数（单位为 $\\mathrm{W\\, m^3}$）。杂质粒子通量由带有对流箍缩的菲克定律定义：\n$$\nJ_z(x,t) \\equiv - D_z \\,\\frac{\\partial n_z}{\\partial x}(x,t) + V_z \\, n_z(x,t),\n$$\n其中 $D_z$ 是杂质扩散系数，$V_z$ 是杂质对流速度（向外为正）。\n\n假设一维杂质连续性方程为：\n$$\n\\frac{\\partial n_z}{\\partial t} + \\frac{\\partial J_z}{\\partial x} = 0,\n$$\n并将局域体积辐射功率密度定义为：\n$$\nP_{\\mathrm{rad}}(x,t) \\equiv n_e(x)\\, n_z(x,t)\\, L_z\\!\\left(T_e(x,t)\\right).\n$$\n设 $P_h(x)$ 是给定的体积加热功率密度分布。\n\n将辐射前沿位置 $r_f(t)$ 隐式地定义为以下方程的唯一解：\n$$\nR\\big(r_f(t),t\\big) \\equiv n_e\\!\\big(r_f(t)\\big)\\,L_z\\!\\left(T_e\\!\\big(r_f(t),t\\big)\\right)\\,n_z\\!\\big(r_f(t),t\\big) - P_h\\!\\big(r_f(t)\\big) = 0,\n$$\n即局域辐射损失与局域加热相平衡的半径。在杂质输运时间尺度上的“冻结温度”极限下进行研究，其中 $T_e(x,t)$ 可由给定的背景分布 $T_b(x)$ 近似，因此在前沿因 $n_z(x,t)$ 演化而移动期间，$L_z\\!\\left(T_e(x,t)\\right) \\approx L_z\\!\\left(T_b(x)\\right)$。\n\n任务A（推导）：从上述定义出发，使用 $r_f(t)$ 的隐函数定义和基本微积分（链式法则），结合杂质连续性定律，推导辐射前沿速度 $v_f \\equiv \\frac{dr_f}{dt}$ 的一个通用表达式，该表达式用 $D_z$、$V_z$、$L_z(T_b)$ 以及在 $x=r_f(t)$ 处计算的局域空间导数来表示。您的推导必须只使用 $n_e(x)$、$P_h(x)$、$T_b(x)$、$L_z(T)$ 以及 $n_z(x,t)$ 在前沿处的一阶和二阶空间导数来表达 $v_f$。当 $n_e$ 和 $P_h$ 缓慢变化时，明确指出要使前沿向内移动（即 $v_f  0$）所需满足的关于 $D_z$、$V_z$ 和局域杂质分布的数学条件。\n\n任务B（数值计算）：对于以下测试组，将 $T_e(x,t)\\equiv T_b(x)$ 处理，取 $D_z$ 和 $V_z$ 为常数，并假设评估时刻的杂质密度分布为\n$$\nn_z(x) = n_{\\mathrm{edge}}\\,\\exp\\!\\left(-\\frac{a-x}{L_n}\\right),\n$$\n其中 $n_{\\mathrm{edge}}$ 为常数，杂质标长 $L_n0$。这意味着\n$$\n\\frac{\\partial n_z}{\\partial x} = \\frac{n_z}{L_n},\\qquad \\frac{\\partial^2 n_z}{\\partial x^2} = \\frac{n_z}{L_n^2}.\n$$\n对于每个测试用例，计算瞬时前沿位置 $r_f$ 作为\n$$\nR(x) = n_e(x)\\,L_z\\!\\left(T_b(x)\\right)\\,n_z(x) - P_h(x)\n$$\n在 $x\\in(0,a)$ 内的唯一根，然后在 $x=r_f$ 处评估您推导出的速度 $v_f$。使用以下函数形式和参数值；所有物理量均采用国际单位制（SI），除非另有说明，温度单位为电子伏特（eV）：\n\n- 冷却系数模型：\n$$\nL_z(T) = L_0 \\left(\\frac{T}{T_p}\\right)\\exp\\!\\left(-\\frac{T}{T_p}\\right).\n$$\n\n- 背景电子温度：\n$$\nT_b(x) = T_{\\mathrm{edge}} + \\big(T_0 - T_{\\mathrm{edge}}\\big)\\,\\Big(1 - (x/a)^2\\Big).\n$$\n\n测试用例1（正常情况）：\n- $a = 1.0$ (m), $D_z = 0.5$ (m$^2$/s), $V_z = -0.2$ (m/s), $n_0 = 5.0\\times 10^{19}$ (m$^{-3}$),\n- $n_e(x) = n_0$,\n- $P_h(x) = P_0\\big(1 - (x/a)^2\\big)$，其中 $P_0 = 1.0\\times 10^{5}$,\n- $T_0 = 3000$ (eV), $T_{\\mathrm{edge}} = 100$ (eV), $L_0 = 5.0\\times 10^{-31}$ (W m$^3$), $T_p = 2000$ (eV),\n- $n_{\\mathrm{edge}} = 8.0\\times 10^{16}$ (m$^{-3}$), $L_n = 0.2$ (m).\n\n测试用例2（扩散主导）：\n- 与测试用例1相同，除了 $D_z = 2.0$ (m$^2$/s), $V_z = 0.0$ (m/s)。\n\n测试用例3（非均匀密度和加热）：\n- $a = 1.0$ (m), $D_z = 0.3$ (m$^2$/s), $V_z = -0.05$ (m/s), $n_0 = 6.0\\times 10^{19}$ (m$^{-3}$),\n- $n_e(x) = n_0\\left[1 + 0.4\\left(1 - x/a\\right)\\right]$,\n- $P_h(x) = P_0\\left(1 - (x/a)^3\\right)$，其中 $P_0 = 1.5\\times 10^{5}$,\n- $T_0 = 2500$ (eV), $T_{\\mathrm{edge}} = 100$ (eV), $L_0 = 5.0\\times 10^{-31}$ (W m$^3$), $T_p = 2000$ (eV),\n- $n_{\\mathrm{edge}} = 6.0\\times 10^{16}$ (m$^{-3}$), $L_n = 0.3$ (m).\n\n测试用例4（向外对流主导和缓加热梯度）：\n- $a = 1.0$ (m), $D_z = 0.1$ (m$^2$/s), $V_z = 0.5$ (m/s), $n_0 = 4.0\\times 10^{19}$ (m$^{-3}$),\n- $n_e(x) = n_0$,\n- $P_h(x) = P_0\\left(1 - 0.5\\,x/a\\right)$，其中 $P_0 = 7.0\\times 10^{4}$,\n- $T_0 = 3500$ (eV), $T_{\\mathrm{edge}} = 150$ (eV), $L_0 = 6.0\\times 10^{-31}$ (W m$^3$), $T_p = 2500$ (eV),\n- $n_{\\mathrm{edge}} = 5.0\\times 10^{16}$ (m$^{-3}$), $L_n = 0.15$ (m).\n\n编程要求：\n- 实现一个程序，对于每个测试用例，在开区间 $(0,a)$ 内数值求解 $r_f$，并使用您推导的表达式计算 $v_f$（单位为 $\\mathrm{m/s}$）。\n- 使用有限差分法在 $x=r_f$ 处计算 $n_e(x)$、$P_h(x)$ 和 $T_b(x)$ 的必要空间导数，并使用一个小的温度增量来计算在 $T_b(r_f)$ 处的 $\\frac{dL_z}{dT}$。\n- 您的程序应生成一行输出，其中包含四个速度，形式为一个逗号分隔的列表，并用方括号括起来，例如 `[v_1,v_2,v_3,v_4]`，其中每个 $v_i$ 是一个以 $\\mathrm{m/s}$ 为单位的浮点数。\n\n答案单位：\n- 以 $\\mathrm{m/s}$ 表示前沿速度。\n\n最终输出格式：\n- 您的程序应只产生一行输出：一个包含四个浮点数的 Python 列表字面量，按上述测试用例的顺序排列，例如 `[0.123456,-0.234567,0.345678,-0.456789]`。",
            "solution": "经评估，该问题是有效的。它在科学上基于等离子体输运物理原理，问题定义良好、客观，并包含求解所需的所有信息。\n\n### 任务A：辐射前沿速度的推导\n\n辐射前沿的位置 $r_f(t)$ 被隐式定义为局域辐射损失与局域加热相平衡的位置。在冻结温度近似下，即 $T_e(x,t) \\approx T_b(x)$，这由方程 $R(r_f(t), t) = 0$ 给出，其中函数 $R(x, t)$ 定义为：\n$$\nR(x, t) = n_e(x) L_z(T_b(x)) n_z(x, t) - P_h(x)\n$$\n由于此关系对所有时间 $t$ 均成立，其全时间导数必须为零：\n$$\n\\frac{d}{dt} R(r_f(t), t) = 0\n$$\n将多元链式法则应用于沿路径 $x=r_f(t)$ 求值的函数 $R(x,t)$：\n$$\n\\frac{\\partial R}{\\partial x}\\bigg|_{x=r_f} \\frac{dr_f}{dt} + \\frac{\\partial R}{\\partial t}\\bigg|_{x=r_f} = 0\n$$\n辐射前沿速度为 $v_f \\equiv \\frac{dr_f}{dt}$。求解 $v_f$ 可得：\n$$\nv_f = - \\frac{\\partial R / \\partial t}{\\partial R / \\partial x} \\bigg|_{x=r_f}\n$$\n该表达式有效的前提是分母 $\\frac{\\partial R}{\\partial x}$ 在前沿处不为零。\n\n接下来，我们计算这两个偏导数。关于时间的偏导数 $\\frac{\\partial R}{\\partial t}$ 只作用于杂质密度 $n_z(x,t)$：\n$$\n\\frac{\\partial R}{\\partial t} = n_e(x) L_z(T_b(x)) \\frac{\\partial n_z}{\\partial t}\n$$\n杂质连续性方程为 $\\frac{\\partial n_z}{\\partial t} + \\frac{\\partial J_z}{\\partial x} = 0$，通量为 $J_z = -D_z \\frac{\\partial n_z}{\\partial x} + V_z n_z$。假设扩散系数 $D_z$ 和对流速度 $V_z$ 在空间上是常数，我们有：\n$$\n\\frac{\\partial n_z}{\\partial t} = - \\frac{\\partial J_z}{\\partial x} = - \\frac{\\partial}{\\partial x} \\left(-D_z \\frac{\\partial n_z}{\\partial x} + V_z n_z\\right) = D_z \\frac{\\partial^2 n_z}{\\partial x^2} - V_z \\frac{\\partial n_z}{\\partial x}\n$$\n将此式代入 $\\frac{\\partial R}{\\partial t}$ 的表达式中，得到 $v_f$ 的分子：\n$$\n\\frac{\\partial R}{\\partial t} = n_e(x) L_z(T_b(x)) \\left( D_z \\frac{\\partial^2 n_z}{\\partial x^2} - V_z \\frac{\\partial n_z}{\\partial x} \\right)\n$$\n关于空间的偏导数 $\\frac{\\partial R}{\\partial x}$ 构成 分母。应用乘积法则：\n$$\n\\frac{\\partial R}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ n_e(x) L_z(T_b(x)) n_z(x, t) \\right] - \\frac{d P_h}{d x}\n$$\n$$\n\\frac{\\partial R}{\\partial x} = \\frac{d n_e}{dx} L_z(T_b) n_z + n_e \\frac{d(L_z(T_b))}{dx} n_z + n_e L_z(T_b) \\frac{\\partial n_z}{\\partial x} - \\frac{d P_h}{dx}\n$$\n其中 $\\frac{d(L_z(T_b))}{dx} = \\frac{dL_z}{dT_b} \\frac{dT_b}{dx}$。\n\n综合这些结果，辐射前沿速度 $v_f$ 的通用表达式（在 $x = r_f(t)$ 处求值）为：\n$$\nv_f = - \\frac{n_e L_z(T_b) \\left( D_z \\frac{\\partial^2 n_z}{\\partial x^2} - V_z \\frac{\\partial n_z}{\\partial x} \\right)}{\\frac{d n_e}{dx} L_z(T_b) n_z + n_e \\frac{dL_z}{dT_b}\\frac{dT_b}{dx} n_z + n_e L_z(T_b) \\frac{\\partial n_z}{\\partial x} - \\frac{d P_h}{dx}}\n$$\n此表达式仅依赖于指定的背景分布、它们的导数，以及杂质分布 $n_z$ 在前沿位置的一阶和二阶空间导数。\n\n为使前沿向内移动（$v_f  0$），表达式的符号必须为负。对于一个物理上稳定的辐射前沿，扰动应当被衰减。这通常要求分母 $\\frac{\\partial R}{\\partial x}$ 为负。在此稳定性条件下，$v_f$ 的符号与分子相同。分子与 $\\frac{\\partial n_z}{\\partial t}$ 成正比。因此，对于向内移动，我们需要局域杂质密度减小，即 $\\frac{\\partial n_z}{\\partial t}  0$。这导出的条件是：\n$$\nD_z \\frac{\\partial^2 n_z}{\\partial x^2} - V_z \\frac{\\partial n_z}{\\partial x}  0\n$$\n这是在假设前沿稳定的情况下，为使前沿向内移动，对 $D_z$、$V_z$ 和局域杂质分布形状（通过其一阶和二阶导数）所要求的数学条件。关于“缓慢变化”的 $n_e$ 和 $P_h$ 的陈述，强化了前沿动力学主要由杂质输运和辐射层的内在稳定性主导的观点，使得稳定性假设 $\\frac{\\partial R}{\\partial x}  0$ 变得合理。\n\n### 任务B：数值实现策略\n\n数值任务对每个测试用例包含两个主要步骤：\n1.  **找到前沿位置 $r_f$**：在 $x \\in (0, a)$ 区间内数值求解非线性代数方程 $R(x) = 0$。函数 $R(x)$ 由 $R(x) = n_e(x)\\,L_z(T_b(x))\\,n_z(x) - P_h(x)$ 给出。将采用一个稳健的求根算法，例如 Brent 方法。这需要一个区间 $[x_1, x_2]$，使得 $R(x_1)$ 和 $R(x_2)$ 异号。定义域边界 $x \\to 0$ 和 $x \\to a$ 是检查符号变化的合适候选位置。\n\n2.  **评估前沿速度 $v_f$**：一旦确定了 $r_f$，就计算推导出的 $v_f$ 表达式。所有函数（$n_e$, $n_z$, $T_b$, $L_z$, $P_h$）都在 $x=r_f$ 处计算。特定的杂质分布 $n_z(x) = n_{\\mathrm{edge}}\\,\\exp\\!\\left(-(a-x)/L_n\\right)$ 允许其导数的解析计算：$\\frac{\\partial n_z}{\\partial x} = n_z / L_n$ 和 $\\frac{\\partial^2 n_z}{\\partial x^2} = n_z / L_n^2$。根据问题要求，其他所需导数将使用二阶中心有限差分格式以一个小的步长 $h$ 进行数值计算：\n    - $\\frac{df}{dx}(x) \\approx \\frac{f(x+h) - f(x-h)}{2h}$，其中 $f$ 为 $n_e(x)$、$P_h(x)$ 和 $T_b(x)$。\n    - 冷却系数的导数 $\\frac{dL_z}{dT}$ 也将通过中心差分计算：$\\frac{dL_z}{dT}(T) \\approx \\frac{L_z(T+\\Delta T) - L_z(T-\\Delta T)}{2\\Delta T}$，使用一个小的温度增量 $\\Delta T$。\n\n然后由这些分量组装成 $v_f$ 表达式的分子和分母，并计算出最终速度。对四个测试用例中的每一个重复此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the radiation front speed for four test cases\n    based on a 1D plasma impurity transport model.\n    \"\"\"\n\n    test_cases = [\n        {\n            # Case 1: happy path\n            'a': 1.0, 'Dz': 0.5, 'Vz': -0.2, 'n0': 5.0e19,\n            'ne_func': lambda x, p: p['n0'],\n            'Ph_func': lambda x, p: p['P0'] * (1 - (x / p['a'])**2), 'P0': 1.0e5,\n            'T0': 3000.0, 'Tedge': 100.0, 'L0': 5.0e-31, 'Tp': 2000.0,\n            'n_edge': 8.0e16, 'Ln': 0.2\n        },\n        {\n            # Case 2: diffusion-dominated\n            'a': 1.0, 'Dz': 2.0, 'Vz': 0.0, 'n0': 5.0e19,\n            'ne_func': lambda x, p: p['n0'],\n            'Ph_func': lambda x, p: p['P0'] * (1 - (x / p['a'])**2), 'P0': 1.0e5,\n            'T0': 3000.0, 'Tedge': 100.0, 'L0': 5.0e-31, 'Tp': 2000.0,\n            'n_edge': 8.0e16, 'Ln': 0.2\n        },\n        {\n            # Case 3: non-uniform density and heating\n            'a': 1.0, 'Dz': 0.3, 'Vz': -0.05, 'n0': 6.0e19,\n            'ne_func': lambda x, p: p['n0'] * (1 + 0.4 * (1 - x / p['a'])),\n            'Ph_func': lambda x, p: p['P0'] * (1 - (x / p['a'])**3), 'P0': 1.5e5,\n            'T0': 2500.0, 'Tedge': 100.0, 'L0': 5.0e-31, 'Tp': 2000.0,\n            'n_edge': 6.0e16, 'Ln': 0.3\n        },\n        {\n            # Case 4: outward-dominated convection and shallow heating gradient\n            'a': 1.0, 'Dz': 0.1, 'Vz': 0.5, 'n0': 4.0e19,\n            'ne_func': lambda x, p: p['n0'],\n            'Ph_func': lambda x, p: p['P0'] * (1 - 0.5 * x / p['a']), 'P0': 7.0e4,\n            'T0': 3500.0, 'Tedge': 150.0, 'L0': 6.0e-31, 'Tp': 2500.0,\n            'n_edge': 5.0e16, 'Ln': 0.15\n        }\n    ]\n\n    results = []\n    \n    # Finite difference parameters\n    h = 1e-6  # Spatial step\n    delta_T = 1e-3 # Temperature step\n\n    for params in test_cases:\n        a = params['a']\n\n        # Define physics functions for the current case\n        def Tb(x):\n            return params['Tedge'] + (params['T0'] - params['Tedge']) * (1 - (x / a)**2)\n\n        def Lz(T):\n            if T == 0: return 0.0\n            return params['L0'] * (T / params['Tp']) * np.exp(-T / params['Tp'])\n\n        def nz(x):\n            return params['n_edge'] * np.exp(-(a - x) / params['Ln'])\n        \n        def ne(x):\n            return params['ne_func'](x, params)\n            \n        def Ph(x):\n            return params['Ph_func'](x, params)\n        \n        # Function to find the root of\n        def R(x):\n            return ne(x) * Lz(Tb(x)) * nz(x) - Ph(x)\n\n        # Find the radiation front location rf\n        # Use a small epsilon to avoid boundaries in brentq\n        epsilon = 1e-9\n        rf = brentq(R, epsilon, a - epsilon)\n\n        # Evaluate quantities at the front location rf\n        ne_rf = ne(rf)\n        nz_rf = nz(rf)\n        Tb_rf = Tb(rf)\n        Lz_rf = Lz(Tb_rf)\n        \n        # Derivatives of nz are analytical\n        dnz_dx_rf = nz_rf / params['Ln']\n        d2nz_dx2_rf = nz_rf / (params['Ln']**2)\n\n        # Numerator of vf\n        num_vf_term = params['Dz'] * d2nz_dx2_rf - params['Vz'] * dnz_dx_rf\n        numerator_vf = ne_rf * Lz_rf * num_vf_term\n\n        # Denominator of vf using finite differences\n        dne_dx = (ne(rf + h) - ne(rf - h)) / (2 * h)\n        dPh_dx = (Ph(rf + h) - Ph(rf - h)) / (2 * h)\n        dTb_dx = (Tb(rf + h) - Tb(rf - h)) / (2 * h)\n        dLz_dT = (Lz(Tb_rf + delta_T) - Lz(Tb_rf - delta_T)) / (2 * delta_T)\n        \n        den_term1 = dne_dx * Lz_rf * nz_rf\n        den_term2 = ne_rf * (dLz_dT * dTb_dx) * nz_rf\n        den_term3 = ne_rf * Lz_rf * dnz_dx_rf\n        \n        denominator_vf = den_term1 + den_term2 + den_term3 - dPh_dx\n        \n        # Calculate front speed\n        vf = -numerator_vf / denominator_vf\n        results.append(vf)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}