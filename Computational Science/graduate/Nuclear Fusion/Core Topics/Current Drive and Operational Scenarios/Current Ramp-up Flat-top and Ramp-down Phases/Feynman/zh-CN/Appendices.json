{
    "hands_on_practices": [
        {
            "introduction": "本实践将聚焦于电流爬升阶段。我们将探讨控制等离子体电流建立速率的基本物理原理。通过应用一个简化的 $L-R$ 电路模型，你将推导出电流爬升时间与装置尺寸的标度关系，这是设计和比较未来托卡马克装置的一个关键因素。",
            "id": "3694082",
            "problem": "一个圆形截面的托卡马克等离子体在电流演化过程中可以被建模为一个均匀的圆柱形导体，其小半径为 $a$，大半径为 $R$，具有均匀的电流密度 $j(t)$、均匀的标量电阻率 $\\eta$ 和电导率 $\\sigma=1/\\eta$。环向回路电压 $V_{\\text{loop}}(t)$ 由一个变压器施加，其环向电场 $E_{\\phi}(t)$ 通过关系式 $\\oint E_{\\phi}\\,\\mathrm{d}l=V_{\\text{loop}}$ 给出，电流的演化由电磁感应和电阻耗散共同决定。在受控的电流爬升期间，一个严格的工程约束将环向电场的大小限制在 $E_{\\max}$ 以内，以避免产生逃逸电子，因此在任何时候都有 $|E_{\\phi}(t)|\\leq E_{\\max}$。假设控制器总是使用 $E_{\\phi}(t)=E_{\\max}$ 以最小化爬升时间。在平顶阶段，目标工作点是一个预设的空间均匀的平均电流密度 $j_{\\text{avg}}$。\n\n考虑在氘中运行的两个装置，它们具有相同的有效电荷和碰撞率：\n- 装置A：大半径 $R_{A}=1.8\\,\\mathrm{m}$，小半径 $a_{A}=0.60\\,\\mathrm{m}$。\n- 装置B：大半径 $R_{B}=6.0\\,\\mathrm{m}$，小半径 $a_{B}=2.0\\,\\mathrm{m}$。\n\n两个装置都满足：\n- 在电流爬升期间，通过辅助加热，电子温度在空间上保持均匀且恒定在 $T_{e}=3.0\\,\\mathrm{keV}$，电子-离子库仑对数为 $\\ln\\Lambda=17$，有效电荷为 $Z_{\\text{eff}}=1.2$。\n- 目标平顶平均电流密度为 $j_{\\text{avg}}=5.0\\times 10^{5}\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n- 最大环向电场为 $E_{\\max}=0.20\\,\\mathrm{V}\\,\\mathrm{m}^{-1}$。\n\n仅从法拉第定律、欧姆定律和磁扩散方程出发（即，不能先验地调用专门的托卡马克公式），按以下步骤进行：\n1. 推导电流演化的零维 $L\\text{-}R$ 形式，确定等效等离子体电阻 $R_{p}$ 和电感时间尺度（电阻扩散时间）$\\tau_{R}$。你可以假设一个均匀的圆柱体和最慢的磁扩散本征模，因此 $\\tau_{R}$ 的标度关系为 $\\tau_{R}\\propto \\mu_{0}a^{2}/\\eta$，其中 $\\mu_{0}$ 是自由空间磁导率，并且任何量级为1的几何因子在装置间的比率中会抵消。\n2. 使用 $V_{\\text{loop}}=2\\pi R E_{\\max}$，$R_{p}=\\eta\\,\\ell/A$（其中 $\\ell=2\\pi R$ 和 $A=\\pi a^{2}$）以及目标平顶电流 $I_{f}=j_{\\text{avg}}A$，推导在恒定 $E_{\\max}$ 驱动下达到 $I_{f}$ 所需的最小时间 $t_{\\text{ramp}}$。明确展示 $t_{\\text{ramp}}$ 如何依赖于 $a$、$R$、$\\eta$、$j_{\\text{avg}}$ 和 $E_{\\max}$，并找出任何与尺寸无关的组合。\n3. 使用完全电离等离子体的斯皮策电阻率的标准动理学理论表达式，确认在给定参数下，达到 $I_{f}$ 所需的无量纲驱动比在 $E_{\\max}$ 下小于1，从而确保目标可在有限时间内达到。你可以采用斯皮策电阻率随电子温度的标度关系为 $\\eta\\propto Z_{\\text{eff}}\\ln\\Lambda\\,T_{e}^{-3/2}$，其数值系数与国际单位制 (SI) 一致。\n4. 最后，在上述假设下，推导并计算两个装置的最小爬升时间之比 $t_{\\text{ramp},B}/t_{\\text{ramp},A}$。将你最终的数值比率四舍五入到三位有效数字。将最终比率表示为无量纲数。",
            "solution": "该问题要求分析两个几何相似的托卡马克中的电流爬升阶段，最终计算出它们的最小爬升时间之比。解题过程如问题陈述中所述，分四个阶段进行。\n\n首先，我们验证问题陈述的有效性。\n**第1步：提取已知条件**\n- 模型：均匀圆柱形等离子体导体。\n- 装置A：$R_A = 1.8\\,\\mathrm{m}$，$a_A = 0.60\\,\\mathrm{m}$。环径比 $A_A = R_A/a_A = 3$。\n- 装置B：$R_B = 6.0\\,\\mathrm{m}$，$a_B = 2.0\\,\\mathrm{m}$。环径比 $A_B = R_B/a_B = 3$。\n- 共同的等离子体参数：氘，$Z_{\\text{eff}} = 1.2$，$\\ln\\Lambda = 17$，恒定的爬升期温度 $T_e = 3.0\\,\\mathrm{keV}$。\n- 共同的运行参数：目标电流密度 $j_{\\text{avg}} = 5.0 \\times 10^5\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$，最大电场 $E_{\\max} = 0.20\\,\\mathrm{V}\\,\\mathrm{m}^{-1}$。\n- 物理与模型说明：从法拉第定律和欧姆定律出发。使用给定的公式 $V_{\\text{loop}} = 2\\pi R E_{\\phi}$、等离子体电阻 $R_p = \\eta \\ell / A$（其中 $\\ell = 2\\pi R$ 和 $A = \\pi a^2$）以及目标电流 $I_f = j_{\\text{avg}} A$。电阻时间尺度的标度关系给定为 $\\tau_R \\propto \\mu_0 a^2 / \\eta$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在科学上基于磁流体动力学（MHD）和等离子体物理学的原理，使用了与托卡马克运行相关的标准模型（零维L-R电路）和概念（斯皮策电阻率、磁扩散）。所提供的参数对于聚变装置是现实的。该问题提法恰当，提供了一条从基本定律到具体、可计算结果的清晰路径，并包含了所有必要的数据和约束。语言客观、精确。因此，该问题被认为是**有效的**。\n\n**第3步：结论与行动**\n问题有效。我们继续进行求解。\n\n**1. 零维L-R电路模型的推导**\n我们从应用于大半径 $R$ 处环绕环体的回路的积分形式的法拉第电磁感应定律开始：\n$$ \\oint \\mathbf{E}_{\\text{total}} \\cdot d\\mathbf{l} = -\\frac{d\\Phi_B}{dt} $$\n等离子体内部的总电场 $\\mathbf{E}_{\\text{total}}$ 是来自变压器的外部施加场 $\\mathbf{E}_{\\phi}$ 和等离子体电阻场之和。根据静态等离子体的欧姆定律，驱动电流密度 $\\mathbf{j}$ 以克服电阻率 $\\eta$ 所需的电场为 $\\mathbf{E}_{\\text{res}} = \\eta \\mathbf{j}$。在我们的模型中，两个场都沿环向（$\\phi$）方向。总电场通过欧姆定律与电流密度相关联：$E_{\\text{total}} = \\eta j$。\n\n总电场沿长度为 $\\ell = 2\\pi R$ 的圆形轴线的环路积分为：\n$$ \\oint \\mathbf{E}_{\\text{total}} \\cdot d\\mathbf{l} = E_{\\text{total}} (2\\pi R) = (\\eta j) (2\\pi R) $$\n总等离子体电流为 $I = jA$，其中 $A=\\pi a^2$ 是等离子体截面积。因此，$j=I/(\\pi a^2)$。该积分变为：\n$$ \\oint \\mathbf{E}_{\\text{total}} \\cdot d\\mathbf{l} = \\eta \\frac{I}{\\pi a^2} (2\\pi R) = I \\left( \\frac{2\\eta R}{a^2} \\right) $$\n我们将在括号中的项识别为问题中指定的等效等离子体电阻 $R_p$：\n$$ R_p = \\frac{\\eta (2\\pi R)}{\\pi a^2} = \\frac{2\\eta R}{a^2} $$\n穿过回路的磁通量 $\\Phi_B$ 由等离子体电流自身产生。它通过总等离子体电感 $L$ 与电流相关，即 $\\Phi_B = LI$。因此，磁通量的变化率为 $\\frac{d\\Phi_B}{dt} = L \\frac{dI}{dt}$。\n\n来自变压器的外部施加电压，即回路电压 $V_{\\text{loop}}$，是驱动系统的动力。它被定义为施加电场的等高线积分：$V_{\\text{loop}} = \\oint \\mathbf{E}_{\\phi} \\cdot d\\mathbf{l} = E_{\\phi} (2\\pi R)$。\n总电路方程平衡了施加电压、电阻电压降和感应反电动势。形式上，我们可以将总电场写成一个非保守的施加部分 $\\mathbf{E}_{\\text{app}}$ 和一个保守的感应部分 $\\mathbf{E}_{\\text{ind}}$ 的和，其中 $\\nabla \\times \\mathbf{E}_{\\text{ind}} = -\\partial\\mathbf{B}/\\partial t$。我们有 $\\oint \\mathbf{E}_{\\text{app}} \\cdot d\\mathbf{l} = V_{\\text{loop}}$ 和 $\\oint \\mathbf{E}_{\\text{ind}} \\cdot d\\mathbf{l} = -d\\Phi_B/dt = -L(dI/dt)$。欧姆定律 $\\eta \\mathbf{j} = \\mathbf{E}_{\\text{app}} + \\mathbf{E}_{\\text{ind}}$ 沿回路积分得到 $\\oint \\eta \\mathbf{j} \\cdot d\\mathbf{l} = \\oint \\mathbf{E}_{\\text{app}} \\cdot d\\mathbf{l} + \\oint \\mathbf{E}_{\\text{ind}} \\cdot d\\mathbf{l}$。这得出 $I R_p = V_{\\text{loop}} - L\\frac{dI}{dt}$，重新整理为标准的L-R电路形式：\n$$ V_{\\text{loop}} = L \\frac{dI}{dt} + R_p I $$\n该电路的特征时间常数为 $\\tau_L = L/R_p$。问题要求将其等同于电阻扩散时间 $\\tau_R$，并为此提供了标度关系 $\\tau_R \\propto \\mu_0 a^2 / \\eta$。这在物理上是一致的，因为 $L \\propto \\mu_0 R \\times (\\text{几何因子})$ 且 $R_p \\propto \\eta R / a^2$，所以 $\\tau_L = L/R_p \\propto (\\mu_0 R) / (\\eta R/a^2) = \\mu_0 a^2/\\eta$，其中几何因子被吸收到一个比例常数中。我们定义 $\\tau_R \\equiv L/R_p = C \\frac{\\mu_0 a^2}{\\eta}$，其中 $C$ 是一个无量纲的几何因子。\n\n**2. 最小爬升时间 $t_{\\text{ramp}}$ 的推导**\n为了最小化爬升时间，控制器施加最大可能的电场，$E_{\\phi}(t) = E_{\\max}$。这导致一个恒定的回路电压 $V_{\\text{loop}} = 2\\pi R E_{\\max}$。控制方程是：\n$$ L \\frac{dI}{dt} + R_p I = 2\\pi R E_{\\max} $$\n这是一个具有初始条件 $I(0)=0$ 的一阶线性常微分方程。其解为：\n$$ I(t) = I_{\\text{ss}} \\left( 1 - \\exp\\left(-\\frac{t}{L/R_p}\\right) \\right) $$\n其中 $I_{\\text{ss}}$ 是当 $t \\to \\infty$ 时达到的稳态电流，由 $R_p I_{\\text{ss}} = 2\\pi R E_{\\max}$ 给出，所以 $I_{\\text{ss}} = \\frac{2\\pi R E_{\\max}}{R_p}$。\n当电流在时间 $t=t_{\\text{ramp}}$ 达到目标平顶值 $I_f = j_{\\text{avg}} (\\pi a^2)$ 时，爬升阶段结束。\n$$ I_f = I_{\\text{ss}} \\left( 1 - \\exp\\left(-\\frac{t_{\\text{ramp}}}{L/R_p}\\right) \\right) $$\n求解 $t_{\\text{ramp}}$：\n$$ \\frac{I_f}{I_{\\text{ss}}} = 1 - \\exp\\left(-\\frac{t_{\\text{ramp}}}{L/R_p}\\right) $$\n$$ \\exp\\left(-\\frac{t_{\\text{ramp}}}{L/R_p}\\right) = 1 - \\frac{I_f}{I_{\\text{ss}}} $$\n$$ t_{\\text{ramp}} = -\\frac{L}{R_p} \\ln\\left(1 - \\frac{I_f}{I_{\\text{ss}}}\\right) = -\\tau_R \\ln\\left(1 - \\frac{I_f R_p}{2\\pi R E_{\\max}}\\right) $$\n我们代入 $I_f$ 和 $R_p$ 的表达式：\n$$ \\frac{I_f R_p}{2\\pi R E_{\\max}} = \\frac{(j_{\\text{avg}} \\pi a^2) \\left(\\frac{2\\eta R}{a^2}\\right)}{2\\pi R E_{\\max}} = \\frac{j_{\\text{avg}} \\pi a^2 2\\eta R}{a^2 2\\pi R E_{\\max}} = \\frac{\\eta j_{\\text{avg}}}{E_{\\max}} $$\n这个无量纲比率，我们称之为 $K = \\eta j_{\\text{avg}} / E_{\\max}$，表示达到目标电流密度所需的电阻电场与最大可用驱动电场之比。这是一个与尺寸无关的组合，因为 $\\eta$、$j_{\\text{avg}}$ 和 $E_{\\max}$ 被指定为与装置尺寸无关。\n爬升时间的最终表达式为：\n$$ t_{\\text{ramp}} = -\\tau_R \\ln\\left(1 - \\frac{\\eta j_{\\text{avg}}}{E_{\\max}}\\right) = -C \\frac{\\mu_0 a^2}{\\eta} \\ln\\left(1 - \\frac{\\eta j_{\\text{avg}}}{E_{\\max}}\\right) $$\n该表达式显示了对 $a$、$\\eta$、$j_{\\text{avg}}$ 和 $E_{\\max}$ 的依赖关系。对 $R$ 的依赖关系包含在几何因子 $C$ 中，它取决于环径比 $R/a$。由于两个装置的 $R/a=3$，所以它们的 $C$ 是相同的。\n\n**3. 驱动比的验证**\n为了使 $t_{\\text{ramp}}$ 是一个实数、正数，对数的参数必须在0和1之间。这要求 $0  K  1$。我们必须使用给定的参数来验证这个条件。斯皮策电阻率 $\\eta$ 由标度关系 $\\eta \\propto Z_{\\text{eff}} \\ln\\Lambda T_e^{-3/2}$ 给出。国际单位制中平行电阻率的一个标准公式是 $\\eta \\approx 1.65 \\times 10^{-9} \\frac{Z_{\\text{eff}} \\ln\\Lambda (\\text{修正项})}{T_e[\\mathrm{keV}]^{3/2}}$。我们将使用一个相当精确的系数进行计算。使用 $\\eta \\approx 5.3 \\times 10^{-8} \\frac{Z_{\\text{eff}} \\ln \\Lambda}{T_e[\\mathrm{eV}]^{3/2}}\\Omega \\cdot \\mathrm{m}$，其中 $T_e = 3.0\\,\\mathrm{keV} = 3000\\,\\mathrm{eV}$：\n$$ \\eta \\approx 5.3 \\times 10^{-8} \\frac{(1.2)(17)}{(3000)^{3/2}} = 5.3 \\times 10^{-8} \\frac{20.4}{1.643 \\times 10^5} \\approx 6.58 \\times 10^{-9}\\,\\Omega \\cdot \\mathrm{m} $$\n现在我们计算驱动比 $K$：\n$$ K = \\frac{\\eta j_{\\text{avg}}}{E_{\\max}} = \\frac{(6.58 \\times 10^{-9}\\,\\Omega \\cdot \\mathrm{m})(5.0 \\times 10^5\\,\\mathrm{A}\\,\\mathrm{m}^{-2})}{0.20\\,\\mathrm{V}\\,\\mathrm{m}^{-1}} $$\n$$ K = \\frac{3.29 \\times 10^{-3}\\,\\mathrm{V}\\,\\mathrm{m}^{-1}}{0.20\\,\\mathrm{V}\\,\\mathrm{m}^{-1}} \\approx 0.01645 $$\n由于 $K \\approx 0.016 \\ll 1$，条件得到满足，目标电流可以在有限时间内达到。\n\n**4. 最小爬升时间之比**\n我们需要计算比率 $t_{\\text{ramp},B} / t_{\\text{ramp},A}$。使用推导出的 $t_{\\text{ramp}}$ 表达式：\n$$ \\frac{t_{\\text{ramp},B}}{t_{\\text{ramp},A}} = \\frac{-\\tau_{R,B} \\ln\\left(1 - \\frac{\\eta_B j_{\\text{avg}}}{E_{\\max}}\\right)}{-\\tau_{R,A} \\ln\\left(1 - \\frac{\\eta_A j_{\\text{avg}}}{E_{\\max}}\\right)} $$\n决定电阻率的条件（$T_e$、$Z_{\\text{eff}}$、$\\ln\\Lambda$）对于两个装置都是相同的，因此 $\\eta_A = \\eta_B = \\eta$。运行参数 $j_{\\text{avg}}$ 和 $E_{\\max}$ 也相同。因此，对数的参数对于两个装置是相同的，对数项相互抵消：\n$$ \\frac{t_{\\text{ramp},B}}{t_{\\text{ramp},A}} = \\frac{\\tau_{R,B}}{\\tau_{R,A}} $$\n代入电阻时间的标度关系，$\\tau_R = C \\frac{\\mu_0 a^2}{\\eta}$：\n$$ \\frac{t_{\\text{ramp},B}}{t_{\\text{ramp},A}} = \\frac{C_B \\frac{\\mu_0 a_B^2}{\\eta_B}}{C_A \\frac{\\mu_0 a_A^2}{\\eta_A}} $$\n如前所述，$\\eta_A = \\eta_B$。问题陈述中提到，量级为1的几何因子会抵消。这在物理上是合理的，因为两个装置具有相同的环径比 $R/a=3$，意味着它们是几何自相似的，因此因子 $C$ 对两者是相同的（$C_A=C_B$）。比率简化为：\n$$ \\frac{t_{\\text{ramp},B}}{t_{\\text{ramp},A}} = \\frac{a_B^2}{a_A^2} = \\left(\\frac{a_B}{a_A}\\right)^2 $$\n代入小半径的给定值，$a_A = 0.60\\,\\mathrm{m}$ 和 $a_B = 2.0\\,\\mathrm{m}$：\n$$ \\frac{t_{\\text{ramp},B}}{t_{\\text{ramp},A}} = \\left(\\frac{2.0}{0.60}\\right)^2 = \\left(\\frac{10}{3}\\right)^2 = \\frac{100}{9} \\approx 11.111... $$\n将结果四舍五入到三位有效数字，我们得到 $11.1$。",
            "answer": "$$\n\\boxed{11.1}\n$$"
        },
        {
            "introduction": "一旦达到目标电流，我们就进入了平顶阶段，其目标是维持高温、高密度的等离子体。本练习深入探讨了该准稳态阶段的能量平衡问题。你需要计算等离子体自身电阻产生的加热功率（欧姆加热），并将其与补偿能量损失所需的功率进行比较，从而揭示为何辅助加热对于高性能托卡马克至关重要。",
            "id": "3694061",
            "problem": "一个大环径比托卡马克等离子体在其平顶阶段由环向电流和电阻（欧姆）加热维持。假设其具有圆形截面和轴对称性。该环体的大半径为 $R_0=3.0\\,\\text{m}$，小半径为 $a=0.80\\,\\text{m}$。总等离子体电流为 $I_p=4.5\\,\\text{MA}$。测得的电子温度在空间上是均匀的，为 $T_e=3.0\\,\\text{keV}$，测得的有效离子电荷为 $Z_{\\text{eff}}=1.8$。库仑对数为 $\\ln\\Lambda=17$。电子密度是均匀的，为 $n_e=1.2\\times 10^{20}\\,\\text{m}^{-3}$。假设主要离子种类是单电荷的氘-氚，因此准电中性条件给出 $n_i\\approx n_e$，并取离子温度为均匀的，且等于电子温度，即 $T_i=3.0\\,\\text{keV}$。\n\n在平顶阶段，测得环向电流密度分布为抛物线型，\n$$\nj_\\phi(r)=j_0\\left(1-\\frac{r^2}{a^2}\\right),\n$$\n对于 $0\\le r\\le a$，$j_0$ 由约束条件 $\\int j_\\phi\\,dA = I_p$ 决定，其中 $dA$ 是截面面积元。将电阻率视为标量，并将等离子体视为处于由 Spitzer 电子-离子电阻率决定的碰撞、经典机制中。欧姆（电阻）加热功率为\n$$\nP_\\Omega=\\int \\eta\\, j_\\phi^2\\, dV,\n$$\n其中 $dV$ 是环体的体积元。总热能含量为\n$$\nW=\\frac{3}{2}\\int \\left(n_e k_B T_e + n_i k_B T_i\\right)\\, dV,\n$$\n维持平顶阶段所需的稳态加热功率为 $P_{\\text{req}}=W/\\tau_E$，能量约束时间为 $\\tau_E=0.50\\,\\text{s}$。\n\n仅从基本输运定义和经典电子-离子碰撞物理（碰撞极限下的 Spitzer 电阻率）出发，并利用给定的测量值和几何形状，推导并计算无量纲余量\n$$\n\\mathcal{R}=\\frac{P_\\Omega}{P_{\\text{req}}}.\n$$\n将你的 $\\mathcal{R}$ 最终值四舍五入到三位有效数字。最终报告的量 $\\mathcal{R}$ 是无量纲的；在最终答案中不要包含任何单位。",
            "solution": "该问题经评估具有科学依据，提法明确，客观且自洽。这是一个基于等离子体物理和托卡马克运行标准原理的有效物理问题。我们开始求解。\n\n问题要求计算无量纲余量 $\\mathcal{R}$，其定义为欧姆加热功率 $P_\\Omega$ 与维持等离子体热能含量以抵抗能量损失所需的加热功率 $P_{\\text{req}}$ 之比。\n$$\n\\mathcal{R}=\\frac{P_\\Omega}{P_{\\text{req}}}\n$$\n我们将分别计算 $P_{\\text{req}}$ 和 $P_\\Omega$。\n\n首先，我们计算所需功率 $P_{\\text{req}} = W/\\tau_E$。这需要先求出总热能含量 $W$。$W$ 的表达式为：\n$$\nW=\\frac{3}{2}\\int \\left(n_e k_B T_e + n_i k_B T_i\\right)\\, dV\n$$\n问题陈述电子密度 $n_e$、电子温度 $T_e$ 和离子温度 $T_i$ 都是均匀的。还给出了 $T_i = T_e$ 且准电中性意味着 $n_i \\approx n_e$。因此，被积函数是常数，可以从积分中提出。\n$$\nW=\\frac{3}{2}\\left(n_e k_B T_e + n_e k_B T_e\\right) \\int dV = 3 n_e k_B T_e V\n$$\n这里，$V$ 是等离子体环体的总体积。对于一个大半径为 $R_0$、小半径为 $a$ 的大环径比托卡马克（$R_0 \\gg a$），其体积可近似为：\n$$\nV = (2\\pi R_0) \\times (\\pi a^2) = 2\\pi^2 R_0 a^2\n$$\n将此代入 $W$ 的表达式中：\n$$\nW = 3 n_e (k_B T_e) (2\\pi^2 R_0 a^2) = 6\\pi^2 R_0 a^2 n_e (k_B T_e)\n$$\n项 $k_B T_e$ 代表每个粒子的热能，给定 $T_e = 3.0\\,\\text{keV}$。我们使用元电荷 $e \\approx 1.602 \\times 10^{-19}\\,\\text{C}$ 将其转换为焦耳。\n$$\nk_B T_e = 3.0\\,\\text{keV} = 3.0 \\times 10^3\\,\\text{eV} \\times (1.602177 \\times 10^{-19}\\,\\text{J/eV}) = 4.80653 \\times 10^{-16}\\,\\text{J}\n$$\n现在，我们代入给定的数值：$R_0=3.0\\,\\text{m}$，$a=0.80\\,\\text{m}$ 和 $n_e=1.2\\times 10^{20}\\,\\text{m}^{-3}$。\n$$\nW = 6\\pi^2 (3.0)(0.80)^2(1.2\\times 10^{20})(4.80653 \\times 10^{-16}) \\approx 6.549 \\times 10^6\\,\\text{J}\n$$\n在能量约束时间为 $\\tau_E=0.50\\,\\text{s}$ 的情况下，维持此能量含量所需的功率为：\n$$\nP_{\\text{req}} = \\frac{W}{\\tau_E} = \\frac{6.549 \\times 10^6\\,\\text{J}}{0.50\\,\\text{s}} \\approx 1.310 \\times 10^7\\,\\text{W}\n$$\n\n接下来，我们计算欧姆加热功率 $P_\\Omega = \\int \\eta j_\\phi^2 dV$。体积元为 $dV = (2\\pi R_0) dA = (2\\pi R_0)(2\\pi r dr) = 4\\pi^2 R_0 r dr$。\n电流密度分布由 $j_\\phi(r)=j_0\\left(1-\\frac{r^2}{a^2}\\right)$ 给出。中心电流密度 $j_0$ 由总等离子体电流 $I_p=4.5\\,\\text{MA}$ 决定。\n$$\nI_p = \\int_0^a j_\\phi(r) dA = \\int_0^a j_0\\left(1-\\frac{r^2}{a^2}\\right) 2\\pi r dr = 2\\pi j_0 \\left[\\frac{r^2}{2} - \\frac{r^4}{4a^2}\\right]_0^a = 2\\pi j_0 \\left(\\frac{a^2}{2}-\\frac{a^2}{4}\\right) = \\frac{\\pi a^2 j_0}{2}\n$$\n求解 $j_0$：\n$$\nj_0 = \\frac{2 I_p}{\\pi a^2}\n$$\n电阻率 $\\eta$ 被规定为 Spitzer 电阻率。在托卡马克中，环向电流主要沿磁场平行流动，因此我们必须使用平行 Spitzer 电阻率 $\\eta_\\|$。根据经典输运理论（例如 Braginskii），在国际单位制（$\\Omega \\cdot m$）中，温度单位为 eV 时，$\\eta_\\|$ 的标准公式为：\n$$\n\\eta_\\| \\approx 5.2 \\times 10^{-5} \\frac{Z_{\\text{eff}}\\ln\\Lambda}{(T_e[\\text{eV}])^{3/2}}\n$$\n这个公式考虑了电子-电子碰撞。由于 $T_e$ 是均匀的，$\\eta_\\|$ 在整个等离子体体积内是恒定的。给定 $Z_{\\text{eff}}=1.8$，$\\ln\\Lambda=17$ 和 $T_e = 3.0\\,\\text{keV} = 3000\\,\\text{eV}$：\n$$\n\\eta_\\| \\approx 5.2 \\times 10^{-5} \\frac{1.8 \\times 17}{(3000)^{3/2}} \\approx 5.2 \\times 10^{-5} \\frac{30.6}{1.643 \\times 10^5} \\approx 9.685 \\times 10^{-9}\\,\\Omega\\cdot\\text{m}\n$$\n现在我们可以计算 $P_\\Omega$。由于 $\\eta_\\|$ 是恒定的，我们可以写出：\n$$\nP_\\Omega = \\eta_\\| \\int j_\\phi^2 dV = \\eta_\\| \\int_0^a \\left(j_0\\left(1-\\frac{r^2}{a^2}\\right)\\right)^2 (4\\pi^2 R_0 r) dr = 4\\pi^2 R_0 \\eta_\\| j_0^2 \\int_0^a \\left(1-\\frac{2r^2}{a^2}+\\frac{r^4}{a^4}\\right)r dr\n$$\n$$\nP_\\Omega = 4\\pi^2 R_0 \\eta_\\| j_0^2 \\left[\\frac{r^2}{2} - \\frac{2r^4}{4a^2} + \\frac{r^6}{6a^4}\\right]_0^a = 4\\pi^2 R_0 \\eta_\\| j_0^2 \\left(\\frac{a^2}{2} - \\frac{a^2}{2} + \\frac{a^2}{6}\\right) = \\frac{2\\pi^2 R_0 a^2 \\eta_\\| j_0^2}{3}\n$$\n代入 $j_0$ 的表达式：\n$$\nP_\\Omega = \\frac{2\\pi^2 R_0 a^2 \\eta_\\|}{3} \\left(\\frac{2I_p}{\\pi a^2}\\right)^2 = \\frac{2\\pi^2 R_0 a^2 \\eta_\\|}{3} \\frac{4I_p^2}{\\pi^2 a^4} = \\frac{8 R_0 \\eta_\\| I_p^2}{3 a^2}\n$$\n代入数值：$I_p=4.5\\times 10^6\\,\\text{A}$，$R_0 = 3.0\\,\\text{m}$，$a=0.80\\,\\text{m}$。\n$$\nP_\\Omega = \\frac{8 (3.0) (9.685 \\times 10^{-9}) (4.5 \\times 10^6)^2}{3 (0.80)^2} = \\frac{8 (9.685 \\times 10^{-9}) (2.025 \\times 10^{13})}{0.64} \\approx 2.452 \\times 10^6\\,\\text{W}\n$$\n最后，我们计算比值 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{P_\\Omega}{P_{\\text{req}}} = \\frac{2.452 \\times 10^6\\,\\text{W}}{1.310 \\times 10^7\\,\\text{W}} \\approx 0.18718\n$$\n四舍五入到三位有效数字，我们得到 $\\mathcal{R} = 0.187$。结果 $\\mathcal{R}  1$ 表明，单独的欧姆加热不足以在输运损失的情况下将等离子体维持在指定温度，这是高温托卡马克的典型情况，需要辅助加热。",
            "answer": "$$\\boxed{0.187}$$"
        },
        {
            "introduction": "虽然分析单个阶段至关重要，但一次成功的托卡马克放电需要在从电流爬升到下降的整个演化过程中确保稳定性。这项计算练习要求你构建一个工具，用于追踪整个运行场景中的安全因子（$q$）剖面。通过对照关键的磁流体动力学（MHD）稳定性极限进行检查，本实践将物理理论与运行安全之间的鸿沟联系起来。",
            "id": "3694023",
            "problem": "考虑一个大纵横比、圆形截面的托卡马克，其具有恒定的环向磁场$B_t$、大半径$R$和小半径$a$。等离子体电流$I_p(t)$经历三个阶段的演变：电流爬升、平顶和电流下降。这些阶段由分段线性段定义：在持续时间$T_\\mathrm{up}$内从$I_\\mathrm{start}$到$I_\\mathrm{flat}$，然后在持续时间$T_\\mathrm{flat}$内保持在$I_\\mathrm{flat}$不变，最后在持续时间$T_\\mathrm{down}$内从$I_\\mathrm{flat}$到$I_\\mathrm{end}$。时间以$\\Delta t$的分辨率进行离散化。\n\n使用以下适用于大纵横比圆形托卡马克的基要定义和近似：\n- 在小半径$r$处的安全因子$q(r,t)$定义为环向场线圈数与极向场线圈数之比。在大纵横比圆形几何中，它可以近似为\n$$\nq(r,t) \\approx \\frac{r\\,B_t}{R\\,B_p(r,t)},\n$$\n其中$B_p(r,t)$是极向磁场。\n- 半径$r$处的极向磁场可以近似为\n$$\nB_p(r,t) \\approx \\frac{\\mu_0\\,I_\\mathrm{enc}(r,t)}{2\\pi r},\n$$\n其中$\\mu_0$是真空磁导率，$I_\\mathrm{enc}(r,t)$是半径为$r$的圆所包围的环向电流。\n- 为了模拟$95\\%$极向磁通面上的安全因子，引入一个无量纲形状因子$\\xi$，它捕捉了几何形状和磁通面效应。近似为\n$$\nq_{95}(t) \\approx \\xi\\,\\frac{2\\pi\\,(0.95\\,a)^2\\,B_t}{\\mu_0\\,R\\,I_p(t)}.\n$$\n- 通过与$q_{95}$的固定比率$\\sigma$来模拟轴上安全因子，\n$$\nq_0(t) = \\sigma\\,q_{95}(t),\n$$\n其中$0  \\sigma  1$。\n- 通过以下公式模拟$0 \\le r \\le 0.95\\,a$范围内的单调安全因子径向剖面\n$$\nq(r,t) = q_0(t) + \\big(q_{95}(t) - q_0(t)\\big)\\left(\\frac{r}{0.95\\,a}\\right)^\\lambda,\n$$\n其中$\\lambda  0$是一个剖面形状指数。\n\n磁流体力学（MHD）运行约束要求：\n1. 边缘安全因子必须保持在一个包络线内，\n$$\nq_{95,\\min} \\le q_{95}(t) \\le q_{95,\\max},\n$$\n对于场景中的所有时间$t$。\n2. 轴上安全因子必须满足\n$$\nq_{0}(t) \\ge q_{0,\\min},\n$$\n对于所有时间。\n3. 在电流演变过程中避免穿越危险的有理面，意味着必须不存在半径$r \\in [0,\\,0.95\\,a]$和时间$t$使得\n$$\nq(r,t) \\in \\mathcal{D},\n$$\n其中$\\mathcal{D}$是一个指定的危险有理值集合（例如，易产生撕裂模的有理面，如$q=1$、$q=3/2$、$q=2$）。对于上述的单调剖面，存在一个半径$r$使得$q(r,t)=q_d \\in \\mathcal{D}$，等价于$q_d$位于$q_0(t)$和$q_{95}(t)$之间，对应的半径是\n$$\nr(q_d,t) = 0.95\\,a \\left(\\frac{q_d - q_0(t)}{q_{95}(t) - q_0(t)}\\right)^{1/\\lambda},\n$$\n如果$q_d$在$q_0(t)$和$q_{95}(t)$之间的闭区间内，这个半径在物理上是有效的。\n\n你的任务是编写一个程序，对每个测试用例，评估所有三个阶段的整个时间轨迹，并返回一个布尔值，指示是否在所有时间点都满足上述所有约束。时间离散化应包括每个阶段的端点，并在每个阶段内以步长$\\Delta t$均匀分布。\n\n使用的物理单位：\n- 大半径$R$单位为米（$\\mathrm{m}$）。\n- 小半径$a$单位为米（$\\mathrm{m}$）。\n- 环向磁场$B_t$单位为特斯拉（$\\mathrm{T}$）。\n- 等离子体电流$I_p$单位为安培（$\\mathrm{A}$）。\n- 持续时间$T_\\mathrm{up}$、$T_\\mathrm{flat}$、$T_\\mathrm{down}$和$\\Delta t$单位为秒（$\\mathrm{s}$）。\n\n请严格按照以下方式实施检查：\n- 使用带有$\\xi$的公式计算$q_{95}(t)$。\n- 使用$\\sigma$计算$q_0(t)$。\n- 对所有$t$，强制$q_{95,\\min} \\le q_{95}(t) \\le q_{95,\\max}$。\n- 对所有$t$，强制$q_0(t) \\ge q_{0,\\min}$。\n- 对于每个$q_d \\in \\mathcal{D}$，如果在任何$t$时刻，$q_d$位于$q_0(t)$和$q_{95}(t)$之间的闭区间内，则标记一次违规（这意味着对于给定的剖面，在$r \\in [0,\\,0.95\\,a]$内存在有理面）。\n\n测试套件（每个案例是一个参数元组，顺序为：$(R, a, B_t, \\xi, \\sigma, \\lambda, I_\\mathrm{start}, I_\\mathrm{flat}, I_\\mathrm{end}, T_\\mathrm{up}, T_\\mathrm{flat}, T_\\mathrm{down}, \\Delta t, q_{95,\\min}, q_{95,\\max}, q_{0,\\min}, \\mathcal{D})$），其中$\\mathcal{D}$以列表形式提供：\n- 案例1（理想情况）：($R=3.0\\,\\mathrm{m},\\, a=1.0\\,\\mathrm{m},\\, B_t=5.0\\,\\mathrm{T},\\, \\xi=1.2,\\, \\sigma=0.9,\\, \\lambda=2.0,\\, I_\\mathrm{start}=2.6\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{flat}=2.8\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{end}=2.6\\times 10^6\\,\\mathrm{A},\\, T_\\mathrm{up}=1.0\\,\\mathrm{s},\\, T_\\mathrm{flat}=0.5\\,\\mathrm{s},\\, T_\\mathrm{down}=1.0\\,\\mathrm{s},\\, \\Delta t=0.01\\,\\mathrm{s},\\, q_{95,\\min}=3.0,\\, q_{95,\\max}=3.6,\\, q_{0,\\min}=1.2,\\, \\mathcal{D}=[1.0,\\, 1.5,\\, 2.0]$)\n- 案例2（因穿越$q=2$和某些时刻$q_0$过低而违规）：($R=3.0\\,\\mathrm{m},\\, a=1.0\\,\\mathrm{m},\\, B_t=5.0\\,\\mathrm{T},\\, \\xi=1.0,\\, \\sigma=0.5,\\, \\lambda=2.0,\\, I_\\mathrm{start}=3.2\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{flat}=3.8\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{end}=3.2\\times 10^6\\,\\mathrm{A},\\, T_\\mathrm{up}=1.0\\,\\mathrm{s},\\, T_\\mathrm{flat}=0.5\\,\\mathrm{s},\\, T_\\mathrm{down}=1.0\\,\\mathrm{s},\\, \\Delta t=0.01\\,\\mathrm{s},\\, q_{95,\\min}=2.5,\\, q_{95,\\max}=3.5,\\, q_{0,\\min}=1.1,\\, \\mathcal{D}=[1.0,\\, 1.5,\\, 2.0]$)\n- 案例3（边界情况，在平顶时恰好触及$q_{95,\\min}$，但在其他时候在包络线内）：($R=3.0\\,\\mathrm{m},\\, a=1.0\\,\\mathrm{m},\\, B_t=5.0\\,\\mathrm{T},\\, \\xi=1.2,\\, \\sigma=0.85,\\, \\lambda=2.0,\\, I_\\mathrm{start}=2.9\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{flat}=3.0\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{end}=2.9\\times 10^6\\,\\mathrm{A},\\, T_\\mathrm{up}=1.0\\,\\mathrm{s},\\, T_\\mathrm{flat}=0.5\\,\\mathrm{s},\\, T_\\mathrm{down}=1.0\\,\\mathrm{s},\\, \\Delta t=0.01\\,\\mathrm{s},\\, q_{95,\\min}=3.0,\\, q_{95,\\max}=3.4,\\, q_{0,\\min}=1.2,\\, \\mathcal{D}=[1.0,\\, 1.5,\\, 2.0]$)\n- 案例4（尽管$q_{95}$可接受，但因$q_0$过低而违规）：($R=3.0\\,\\mathrm{m},\\, a=1.0\\,\\mathrm{m},\\, B_t=5.0\\,\\mathrm{T},\\, \\xi=1.2,\\, \\sigma=0.3,\\, \\lambda=2.0,\\, I_\\mathrm{start}=2.8\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{flat}=2.8\\times 10^6\\,\\mathrm{A},\\, I_\\mathrm{end}=2.8\\times 10^6\\,\\mathrm{A},\\, T_\\mathrm{up}=1.0\\,\\mathrm{s},\\, T_\\mathrm{flat}=0.5\\,\\mathrm{s},\\, T_\\mathrm{down}=1.0\\,\\mathrm{s},\\, \\Delta t=0.01\\,\\mathrm{s},\\, q_{95,\\min}=3.0,\\, q_{95,\\max}=3.6,\\, q_{0,\\min}=1.0,\\, \\mathcal{D}=[1.0,\\, 1.5,\\, 2.0]$)\n\n你的程序应生成一行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[\\,\\text{result1},\\text{result2},\\text{result3},\\text{result4}\\,]$），其中每个结果都是一个布尔值，指示该场景是否在整个时间演变过程中满足所有约束。",
            "solution": "该问题要求根据一组磁流体力学（MHD）稳定性约束来评估一个托卡马克等离子体放电场景。该场景由一个时变等离子体电流$I_p(t)$定义，它经过电流爬升、平顶和下降阶段。约束与安全因子剖面$q(r,t)$有关。该问题将通过离散化总时间演化、在每个时间步计算相关物理量，并验证所有约束在整个持续时间内都得到满足来解决。\n\n首先，我们确认给定的物理常数和参数。真空磁导率$\\mu_0$是一个基本常数，取为$\\mu_0 = 4\\pi \\times 10^{-7} \\, \\mathrm{T \\cdot m / A}$。其他参数，如大半径$R$、小半径$a$、环向场$B_t$以及各种模型系数，均在每个测试用例中提供。\n\n总体算法如下：\n1.  构建时间网格。\n2.  在每个时间点计算等离子体电流$I_p(t)$。\n3.  在每个时间点计算安全因子$q_{95}(t)$和$q_0(t)$。\n4.  在所有时间点上验证三个MHD约束。\n\n**步骤1：时间离散化**\n\n等离子体放电的总持续时间是$T_\\mathrm{total} = T_\\mathrm{up} + T_\\mathrm{flat} + T_\\mathrm{down}$。时间演化必须以$\\Delta t$的分辨率进行离散化，确保包含每个阶段的端点（$0$、$T_\\mathrm{up}$、$T_\\mathrm{up}+T_\\mathrm{flat}$和$T_\\mathrm{up}+T_\\mathrm{flat}+T_\\mathrm{down}$）。生成时间向量$t$的一个稳健方法是为每个阶段创建均匀间隔的点，然后将它们组合起来，移除在边界处出现的任何重复点。\n\n对于持续时间为$T_\\mathrm{up}$的爬升阶段，时间点从$t=0$生成到$t=T_\\mathrm{up}$。\n对于持续时间为$T_\\mathrm{flat}$的平顶阶段，时间点从$t=T_\\mathrm{up}$到$t=T_\\mathrm{up} + T_\\mathrm{flat}$。\n对于持续时间为$T_\\mathrm{down}$的下降阶段，时间点从$t=T_\\mathrm{up} + T_\\mathrm{flat}$到$t=T_\\mathrm{up} + T_\\mathrm{flat} + T_\\mathrm{down}$。\n\n持续时间为$T$的阶段中的区间数为$N = \\mathrm{round}(T/\\Delta t)$，因此点数为$N+1$。这确保了步长尽可能接近$\\Delta t$，同时包含区间的两个端点。\n\n**步骤2：等离子体电流演化**\n\n等离子体电流$I_p(t)$遵循分段线性轨迹：\n-   **爬升**（$0 \\le t \\le T_\\mathrm{up}$）：$I_p(t)$从$I_\\mathrm{start}$线性增加到$I_\\mathrm{flat}$。\n    $$ I_p(t) = I_\\mathrm{start} + (I_\\mathrm{flat} - I_\\mathrm{start}) \\frac{t}{T_\\mathrm{up}} $$\n-   **平顶**（$T_\\mathrm{up}  t \\le T_\\mathrm{up} + T_\\mathrm{flat}$）：$I_p(t)$是恒定的。\n    $$ I_p(t) = I_\\mathrm{flat} $$\n-   **下降**（$T_\\mathrm{up} + T_\\mathrm{flat}  t \\le T_\\mathrm{up} + T_\\mathrm{flat} + T_\\mathrm{down}$）：$I_p(t)$从$I_\\mathrm{flat}$线性减小到$I_\\mathrm{end}$。\n    $$ I_p(t) = I_\\mathrm{flat} + (I_\\mathrm{end} - I_\\mathrm{flat}) \\frac{t - (T_\\mathrm{up} + T_\\mathrm{flat})}{T_\\mathrm{down}} $$\n这个分段函数可以使用对指定时间点和电流值的线性插值来高效实现。\n\n**步骤3：安全因子计算**\n\n在每个时间点$t$，我们计算等离子体电流$I_p(t)$，然后用它来找到边缘和轴上安全因子。\n\n$95\\%$磁通面上的安全因子$q_{95}(t)$由以下近似公式给出：\n$$ q_{95}(t) \\approx \\xi\\,\\frac{2\\pi\\,(0.95\\,a)^2\\,B_t}{\\mu_0\\,R\\,I_p(t)} $$\n这可以写成$q_{95}(t) = C/I_p(t)$，其中$C$对于给定的设备和场景配置是一个常数：\n$$ C = \\xi\\,\\frac{2\\pi\\,(0.95\\,a)^2\\,B_t}{\\mu_0\\,R} $$\n轴上安全因子$q_0(t)$被建模为$q_{95}(t)$的固定比率：\n$$ q_0(t) = \\sigma\\,q_{95}(t) $$\n其中$0  \\sigma  1$。\n\n**步骤4：约束验证**\n\n为了使场景有效，所有三个MHD约束必须在我们离散化网格的所有时间点$t$上都得到满足。\n\n1.  **边缘安全因子包络**：$q_{95}(t)$的值必须保持在指定的操作范围内。\n    $$ q_{95,\\min} \\le q_{95}(t) \\le q_{95,\\max} $$\n2.  **轴上安全因子限制**：$q_0(t)$的值必须保持在最小阈值以上，这通常是为了避免锯齿不稳定性。\n    $$ q_{0}(t) \\ge q_{0,\\min} $$\n3.  **避免危险有理面**：如果$q_d$位于轴上值$q_0(t)$和边缘值$q_{95}(t)$之间，则在等离子体芯部（对于$0 \\le r \\le 0.95a$）存在一个安全因子为$q_d$的有理磁面。给定模型$q_0(t) = \\sigma q_{95}(t)$且$0  \\sigma  1$，我们有$q_0(t)  q_{95}(t)$（对于正的$q_{95}$）。约束是对于给定的危险有理值集合$\\mathcal{D}$，任何$q_d \\in \\mathcal{D}$都不应出现在芯部剖面中。这通过验证对每个$t$和每个$q_d \\in \\mathcal{D}$是否满足以下条件来检查：\n    $$ q_d \\notin [q_0(t), q_{95}(t)] $$\n    如果在任何时间$t$，存在一个$q_d \\in \\mathcal{D}$使得$q_0(t) \\le q_d \\le q_{95}(t)$，则发生违规。\n\n实现将计算$q_{95}(t)$和$q_0(t)$的整个时间轨迹作为向量，然后向量化地应用约束检查。如果任何检查在任何时间点失败，则整个场景无效。对每个提供的测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    # Physical constant\n    MU0 = 4 * np.pi * 1e-7  # Vacuum permeability in T*m/A\n\n    # Test suite from the problem description\n    test_cases = [\n        # Case 1 (happy path)\n        (3.0, 1.0, 5.0, 1.2, 0.9, 2.0, 2.6e6, 2.8e6, 2.6e6, 1.0, 0.5, 1.0, 0.01, 3.0, 3.6, 1.2, [1.0, 1.5, 2.0]),\n        # Case 2 (violation due to crossing q=2 and low q0)\n        (3.0, 1.0, 5.0, 1.0, 0.5, 2.0, 3.2e6, 3.8e6, 3.2e6, 1.0, 0.5, 1.0, 0.01, 2.5, 3.5, 1.1, [1.0, 1.5, 2.0]),\n        # Case 3 (boundary case)\n        (3.0, 1.0, 5.0, 1.2, 0.85, 2.0, 2.9e6, 3.0e6, 2.9e6, 1.0, 0.5, 1.0, 0.01, 3.0, 3.4, 1.2, [1.0, 1.5, 2.0]),\n        # Case 4 (violation due to low q0)\n        (3.0, 1.0, 5.0, 1.2, 0.3, 2.0, 2.8e6, 2.8e6, 2.8e6, 1.0, 0.5, 1.0, 0.01, 3.0, 3.6, 1.0, [1.0, 1.5, 2.0]),\n    ]\n\n    results = []\n\n    def check_scenario(params):\n        \"\"\"\n        Evaluates a single tokamak scenario against MHD constraints.\n\n        Args:\n            params (tuple): A tuple containing all parameters for the scenario.\n\n        Returns:\n            bool: True if the scenario is valid, False otherwise.\n        \"\"\"\n        (R, a, Bt, xi, sigma, _, I_start, I_flat, I_end, T_up, T_flat, T_down,\n         dt, q95_min, q95_max, q0_min, D_dangerous) = params\n\n        # 1. Generate time vector, ensuring endpoints of each phase are included\n        time_points = []\n        if T_up >= 0:\n            time_points.append(np.linspace(0, T_up, round(T_up / dt) + 1 if dt > 0 else 1))\n        \n        if T_flat > 0:\n            time_points.append(np.linspace(T_up, T_up + T_flat, round(T_flat / dt) + 1 if dt > 0 else 1))\n\n        if T_down > 0:\n            time_points.append(np.linspace(T_up + T_flat, T_up + T_flat + T_down, round(T_down / dt) + 1 if dt > 0 else 1))\n\n        if not time_points:\n            # Handle case with all zero durations\n            times = np.array([0.0])\n        else:\n            times = np.unique(np.concatenate(time_points))\n\n        # 2. Calculate plasma current I_p(t) using linear interpolation\n        time_nodes = [0, T_up, T_up + T_flat, T_up + T_flat + T_down]\n        current_nodes = [I_start, I_flat, I_flat, I_end]\n        I_p_t = np.interp(times, time_nodes, current_nodes)\n        \n        # Guard against non-positive current, which would make q undefined or negative\n        if np.any(I_p_t = 0):\n            return False\n\n        # 3. Calculate q95(t) and q0(t)\n        q95_constant = xi * (2 * np.pi * (0.95 * a)**2 * Bt) / (MU0 * R)\n        q95_t = q95_constant / I_p_t\n        q0_t = sigma * q95_t\n\n        # 4. Verify constraints for all time points\n\n        # Constraint 1: Edge safety factor envelope\n        is_q95_in_envelope = np.all((q95_t >= q95_min)  (q95_t = q95_max))\n        if not is_q95_in_envelope:\n            return False\n\n        # Constraint 2: On-axis safety factor limit\n        is_q0_above_min = np.all(q0_t >= q0_min)\n        if not is_q0_above_min:\n            return False\n\n        # Constraint 3: Avoidance of dangerous rational surfaces\n        for q_d in D_dangerous:\n            # Check if q_d exists in the plasma core profile at any time\n            # This is equivalent to q_d being between q0(t) and q95(t)\n            is_surface_crossed = np.any((q0_t = q_d)  (q_d = q95_t))\n            if is_surface_crossed:\n                return False\n\n        # If all checks pass for all time points, the scenario is valid\n        return True\n\n    for case in test_cases:\n        results.append(check_scenario(case))\n    \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}