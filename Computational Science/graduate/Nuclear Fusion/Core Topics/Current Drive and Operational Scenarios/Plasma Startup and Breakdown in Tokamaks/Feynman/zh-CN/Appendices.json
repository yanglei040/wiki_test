{
    "hands_on_practices": [
        {
            "introduction": "成功的等离子体击穿始于对初始中性气体压力的精确控制。这个实践练习将引导你探索击穿所需电场与气体压力之间的微妙平衡，这与著名的帕邢定律 (Paschen's Law) 在气体放电中的原理类似。通过基于汤森雪崩模型进行数值优化，你将找到最小化击穿所需环向电压的中性气体压力，从而为设计更高效的托卡马克启动方案提供理论依据。",
            "id": "3714787",
            "problem": "你的任务是设计一个完整、可运行的程序，该程序使用第一性原理模型，通过汤森击穿框架将所需的环路电压与中性气体压强联系起来，从而计算托卡马克中等离子体击穿期间初始电子雪崩的最佳预充中性气体压强。目标是基于基本的粒子倍增和壁损失物理学，确定能够最小化引发击穿所需环路电压的中性气体压强，而不假设任何预先推导的最优性条件。程序必须评估指定的测试套件，并生成一个汇总结果的单行输出。\n\n基本模型必须从公认的原理出发：\n- 理想气体定律将中性粒子密度与压强联系起来：$n_{\\mathrm{n}} = p / (k_{\\mathrm{B}} T_{\\mathrm{n}})$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T_{\\mathrm{n}}$ 是中性粒子温度。\n- 电子雪崩（汤森）模型通过经验关系式描述了第一电离系数 $\\alpha$：$\\alpha / p = A \\exp\\!\\left(- B p / E \\right)$，其中 $A$ 和 $B$ 是与气体相关的常数，$p$ 是中性气体压强，$E$ 是沿电子运动方向的电场强度。\n- 托卡马克环路电压 $V_{\\mathrm{loop}}$ 产生一个环向电场 $E = V_{\\mathrm{loop}}/(2 \\pi R)$，其中 $R$ 是托卡马克大半径。\n- 沿着有效连接长度 $L_{\\mathrm{eff}}$ 的汤森击穿条件由二次发射定律 $\\gamma$ 规定：$\\exp(\\alpha L_{\\mathrm{eff}}) (1 - \\gamma) = 1$，等效于 $\\alpha L_{\\mathrm{eff}} = \\ln(1 + 1/\\gamma)$。\n\n在这些假设下，只有当环路电压足够大，使得电场满足汤森击穿判据时，才可能发生击穿。通过组合这些表达式，可以通过求解以下方程中的 $E$ 来获得在给定压强 $p$ 和几何结构下击穿所需的电场 $E$\n$$\n\\alpha(p, E) L_{\\mathrm{eff}} = \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right),\n$$\n其中 $\\alpha(p,E) = A p \\exp\\!\\left(- \\frac{B p}{E} \\right)$。从这个等式中，刚好满足击穿所需的最小电场强度为\n$$\nE_{\\mathrm{req}}(p) = - \\frac{B p}{\\ln\\!\\left( \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}} \\right)},\n$$\n该表达式仅在 $0  \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}}  1$ 时为实数且为正，即当 $A p L_{\\mathrm{eff}} > \\ln(1 + 1/\\gamma)$ 时。相应的所需环路电压为 $V_{\\mathrm{req}}(p) = 2 \\pi R E_{\\mathrm{req}}(p)$。因此，对于给定的装置和气体常数，优化问题是在一个有界区间内找到能够最小化 $V_{\\mathrm{req}}(p)$ 的压强 $p$，并受到可行性约束 $A p L_{\\mathrm{eff}} > \\ln(1 + 1/\\gamma)$ 的限制。\n\n你的程序必须实现以下逻辑：\n1. 对于每个测试用例，在有界区间 $[p_{\\min}, p_{\\max}]$ 上计算函数 $V_{\\mathrm{req}}(p)$，其中 $p$ 以帕斯卡为单位。\n2. 强制执行击穿可行性约束 $A p L_{\\mathrm{eff}} > \\ln(1 + 1/\\gamma)$。如果区间内没有 $p$ 满足可行性，则该测试用例的结果必须是 $-1.0$。\n3. 否则，在区间的可行子集上对 $V_{\\mathrm{req}}(p)$ 进行数值最小化。返回值必须是使所需环路电压最小化的压强 $p_{\\star}$（单位为帕斯卡），并四舍五入到三位小数。\n\n物理单位要求：\n- 所有压强必须以帕斯卡（Pa）表示。\n- 所有长度必须以米（m）表示。\n- 所有电压必须以伏特（V）表示。\n- 每个测试用例的输出是最佳压强，以帕斯卡（Pa）为单位，并四舍五入到三位小数。\n- 此问题中不涉及角度。\n\n测试套件：\n使用以下测试用例，每个用例以参数元组 $(R, L_{\\mathrm{eff}}, A, B, \\gamma, T_{\\mathrm{n}}, p_{\\min}, p_{\\max})$ 的形式提供：\n- 测试用例 1（一般情况）：$(R = 1.5\\,\\mathrm{m}, L_{\\mathrm{eff}} = 250\\,\\mathrm{m}, A = 0.05\\,\\mathrm{m^{-1}\\,Pa^{-1}}, B = 3\\,\\mathrm{V\\,m^{-1}\\,Pa^{-1}}, \\gamma = 0.02, T_{\\mathrm{n}} = 300\\,\\mathrm{K}, p_{\\min} = 0.01\\,\\mathrm{Pa}, p_{\\max} = 10\\,\\mathrm{Pa})$。\n- 测试用例 2（在边界内不可行击穿）：$(R = 1.5\\,\\mathrm{m}, L_{\\mathrm{eff}} = 10\\,\\mathrm{m}, A = 0.02\\,\\mathrm{m^{-1}\\,Pa^{-1}}, B = 3\\,\\mathrm{V\\,m^{-1}\\,Pa^{-1}}, \\gamma = 0.02, T_{\\mathrm{n}} = 300\\,\\mathrm{K}, p_{\\min} = 0.01\\,\\mathrm{Pa}, p_{\\max} = 0.5\\,\\mathrm{Pa})$。\n- 测试用例 3（更高的二次发射，更长的连接长度）：$(R = 1.5\\,\\mathrm{m}, L_{\\mathrm{eff}} = 300\\,\\mathrm{m}, A = 0.05\\,\\mathrm{m^{-1}\\,Pa^{-1}}, B = 3\\,\\mathrm{V\\,m^{-1}\\,Pa^{-1}}, \\gamma = 0.05, T_{\\mathrm{n}} = 300\\,\\mathrm{K}, p_{\\min} = 0.01\\,\\mathrm{Pa}, p_{\\max} = 10\\,\\mathrm{Pa})$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。该列表必须按测试套件的相同顺序包含最佳压强（单位为帕斯卡），并四舍五入到三位小数。对于不可行的情况，在该测试用例的列表中包含 $-1.0$。例如，输出可能看起来像 $[0.856,-1.0,0.552]$。",
            "solution": "该问题已经过验证，被认为是合理的。它提出了一个适定的优化问题，该问题基于等离子体物理学中已确立但简化的原理，特别是托卡马克中气体击穿的汤森模型。所有提供的参数和方程都是自洽的，足以构建一个可解问题。中性粒子温度 $T_{\\mathrm{n}}$ 作为一个输入参数出现，虽然在推导所需环路电压 $V_{\\mathrm{req}}(p)$ 的最终方程中并未使用，但这是一个无关紧要的细节，不会使所述问题的核心逻辑失效。任务是实现指定的模型，为此，所有必要的信息都已提供。因此，我们可以开始求解。\n\n问题要求我们找到能够最小化引发等离子体击穿所需环路电压 $V_{\\mathrm{req}}$ 的中性气体压强 $p$。所提供的模型通过一系列物理关系将环路电压与压强联系起来。\n\n首先，环路电压 $V_{\\mathrm{loop}}$ 产生一个环向电场 $E$，由下式给出\n$$E = \\frac{V_{\\mathrm{loop}}}{2 \\pi R}$$\n其中 $R$ 是托卡马克的大半径。\n\n其次，电子雪崩的增长由第一汤森电离系数 $\\alpha$ 描述，其经验形式为：\n$$\\frac{\\alpha}{p} = A \\exp\\left(-\\frac{B p}{E}\\right)$$\n这里，$A$ 和 $B$ 是特定于气体的常数，$p$ 是中性气体压强。这个方程可以写成 $\\alpha(p, E) = A p \\exp\\left(-\\frac{B p}{E}\\right)$。\n\n第三，发生击穿的条件是，在有效连接长度 $L_{\\mathrm{eff}}$ 上的电子倍增必须足以自我维持，同时要考虑电子在壁上的损失和壁的二次电子发射（由系数 $\\gamma$ 表征）。该条件由下式给出：\n$$\\alpha L_{\\mathrm{eff}} = \\ln\\left(1 + \\frac{1}{\\gamma}\\right)$$\n\n将 $\\alpha(p, E)$ 的表达式代入击穿条件，我们可以求解在给定压强 $p$ 下所需的电场 $E_{\\mathrm{req}}$：\n$$A p \\exp\\left(-\\frac{B p}{E_{\\mathrm{req}}}\\right) L_{\\mathrm{eff}} = \\ln\\left(1 + \\frac{1}{\\gamma}\\right)$$\n$$\\exp\\left(-\\frac{B p}{E_{\\mathrm{req}}}\\right) = \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}}$$\n对两边取自然对数并整理得到 $E_{\\mathrm{req}}$，即可得出问题陈述中提供的表达式：\n$$E_{\\mathrm{req}}(p) = - \\frac{B p}{\\ln\\left( \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}} \\right)}$$\n\n为了使 $E_{\\mathrm{req}}(p)$ 是一个实数、正的物理量，分母中对数的参数（我们称之为 $x = \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}}$）必须满足 $0  x  1$。对于有效的物理参数（$A>0$，$L_{\\mathrm{eff}}>0$，$\\gamma>0$），$x>0$ 部分总是满足的。约束 $x  1$ 导出了击穿的可行性条件：\n$$\\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}}  1 \\implies p > \\frac{\\ln(1 + 1/\\gamma)}{A L_{\\mathrm{eff}}}$$\n让我们将可行性的最小压强定义为 $p_{\\mathrm{feas\\_min}} = \\frac{\\ln(1 + 1/\\gamma)}{A L_{\\mathrm{eff}}}$。任何压强 $p \\le p_{\\mathrm{feas\\_min}}$ 都不能导致击穿，因为所需的电场将是无限大或非物理的。\n\n所需的环路电压为 $V_{\\mathrm{req}}(p) = 2 \\pi R E_{\\mathrm{req}}(p)$。我们的目标是找到使该函数最小化的压强 $p_{\\star}$，并满足两个约束条件：\n1. 压强必须在指定的搜索区间内：$p \\in [p_{\\min}, p_{\\max}]$。\n2. 压强必须满足物理可行性条件：$p > p_{\\mathrm{feas\\_min}}$。\n\n综合这些，对最佳压强 $p_{\\star}$ 的搜索必须在压强的可行集上进行，该可行集是区间 $(\\max(p_{\\min}, p_{\\mathrm{feas\\_min}}), p_{\\max}]$。\n\n任务是在这个可行集上“数值最小化”$V_{\\mathrm{req}}(p)$。为此，我们将使用数值优化算法。`scipy.optimize.minimize_scalar` 函数是解决此一维优化问题的合适工具。我们将使用其 `bounded` 方法，该方法设计用于在闭区间上进行优化。\n\n每个测试用例的算法如下：\n1. 给定参数 $(R, L_{\\mathrm{eff}}, A, B, \\gamma, T_{\\mathrm{n}}, p_{\\min}, p_{\\max})$，首先计算最小可行压强 $p_{\\mathrm{feas\\_min}} = \\ln(1 + 1/\\gamma) / (A L_{\\mathrm{eff}})$。\n2. 确定优化的搜索区间。搜索的下界是 $p_{\\mathrm{lower}} = \\max(p_{\\min}, p_{\\mathrm{feas\\_min}})$。上界是 $p_{\\mathrm{upper}} = p_{\\max}$。\n3. 检查可行集是否为空。如果 $p_{\\mathrm{lower}} \\ge p_{\\mathrm{upper}}$，则可行集为空。在这种情况下，给定范围内不存在解，结果定义为 $-1.0$。\n4. 如果可行集非空，我们定义目标函数 $f(p) = V_{\\mathrm{req}}(p)$。我们必须注意，对于 $p \\le p_{\\mathrm{feas\\_min}}$，$V_{\\mathrm{req}}(p)$ 是未定义的。\n5. 然后我们使用目标函数 $f(p)$ 和边界 $[p_{\\mathrm{lower}}, p_{\\mathrm{upper}}]$ 调用 `scipy.optimize.minimize_scalar`。优化器将在此区间内找到使函数最小化的压强 $p_{\\star}$。如果 $p_{\\mathrm{lower}} = p_{\\mathrm{feas\\_min}}$，优化器应该能够稳健地处理函数在下边界处趋于无穷大的情况。\n6. 优化器找到的最佳压强 $p_{\\star}$ 按要求四舍五入到三位小数。\n\n这种方法论为问题的要求提供了一个稳健而直接的实现，正确处理了物理约束并提供了指定的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Computes the optimal prefill neutral gas pressure for plasma breakdown in a tokamak\n    by numerically minimizing the required loop voltage.\n    \"\"\"\n\n    # Test suite: (R, Leff, A, B, gamma, Tn, p_min, p_max)\n    # Units: R(m), Leff(m), A(m^-1 Pa^-1), B(V m^-1 Pa^-1), gamma(dimensionless),\n    #        Tn(K), p_min(Pa), p_max(Pa)\n    test_cases = [\n        # Test Case 1 (general case)\n        (1.5, 250, 0.05, 3, 0.02, 300, 0.01, 10),\n        # Test Case 2 (infeasible breakdown within bounds)\n        (1.5, 10, 0.02, 3, 0.02, 300, 0.01, 0.5),\n        # Test Case 3 (higher secondary emission, longer connection length)\n        (1.5, 300, 0.05, 3, 0.05, 300, 0.01, 10),\n    ]\n\n    results = []\n    \n    # A small constant to slightly shift the lower bound away from the singularity\n    # if it coincides with the physical feasibility limit.\n    # The bounded optimizer should handle infinities, but this adds robustness.\n    epsilon = 1e-12\n\n    for case in test_cases:\n        R, L_eff, A, B, gamma, T_n, p_min, p_max = case\n\n        # The term ln(1 + 1/gamma) appears frequently\n        try:\n            c_gamma = np.log(1 + 1/gamma)\n        except (ValueError, ZeroDivisionError):\n            # Handles cases like gamma = 0 or gamma -> infinity\n            results.append(-1.0)\n            continue\n        \n        # Calculate the minimum pressure required for breakdown feasibility\n        if A == 0 or L_eff == 0:\n            results.append(-1.0)\n            continue\n        p_feas_min = c_gamma / (A * L_eff)\n\n        # Determine the effective search interval [p_lower, p_upper]\n        p_lower = max(p_min, p_feas_min)\n        p_upper = p_max\n\n        # Check if a feasible pressure range exists\n        if p_lower >= p_upper:\n            results.append(-1.0)\n            continue\n\n        # Define the objective function to minimize: V_req(p)\n        # We can minimize E_req(p) as V_req is proportional to it.\n        def objective_function(p, B_val, A_val, L_eff_val, c_gamma_val):\n            # This function calculates E_req(p)\n            arg = c_gamma_val / (A_val * p * L_eff_val)\n            # The condition p > p_feas_min ensures arg  1.\n            # Due to floating point arithmetic, shield against arg >= 1\n            if arg >= 1.0:\n                return np.inf  # Return infinity for non-physical region\n            \n            log_arg = np.log(arg)\n            if log_arg == 0:\n                return np.inf # Singularity at the boundary\n                \n            return -B_val * p / log_arg\n\n        # The bounded search interval needs to be strictly within the feasible domain.\n        # If p_lower is at the singularity, we add a small epsilon.\n        opt_bounds = (p_lower + epsilon if p_lower == p_feas_min else p_lower, p_upper)\n        \n        # Numerically find the pressure that minimizes the function\n        res = minimize_scalar(\n            objective_function,\n            bounds=opt_bounds,\n            args=(B, A, L_eff, c_gamma),\n            method='bounded'\n        )\n\n        optimal_pressure = res.x\n        results.append(round(optimal_pressure, 3))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在确定了理想的气体压力条件后，工程师面临的下一个实际挑战是如何有效地将所需的电场施加到气体中。托卡马克的导电真空室会像一个电磁屏蔽层，其上感应出的涡流会抵消由中心螺线管产生的环向电压。本练习将使用集总参数电路模型——一种在托卡马克工程中广泛应用的强大分析工具——来量化这些涡流如何在启动瞬间削弱用于击穿的有效电场。",
            "id": "3714794",
            "problem": "一个圆柱形托卡马克在预填充和击穿阶段被建模为一个轴对称系统，其中中心螺线管（CS）提供一个预设的电流斜坡，导电真空室中则承载环向涡流。用于评估环路电压的目标大半径为 $R = 3.000\\,\\text{m}$。假设极向磁通链遵循以下线性集总参数耦合模型：\n- 链接等离子体轮廓的极向磁通为 $\\psi_{p} = M_{cp}\\,i_{c} + M_{vp}\\,i_{v}$，其中 $i_{c}$ 是CS电流，$i_{v}$ 是真空室中的环向涡流。常数 $M_{cp}$ 和 $M_{vp}$ 是互感，被视为给定的几何系数。\n- 真空室被近似为一个单匝导电环，其自感为 $L_{v}$，电阻为 $R_{v}$，其环向涡流 $i_{v}$ 遵循电路定律 $L_{v}\\,\\frac{d i_{v}}{d t} + R_{v}\\,i_{v} = -\\,M_{cv}\\,\\frac{d i_{c}}{d t}$，其中 $M_{cv}$ 是CS与真空室环路之间的互感。\n\n设CS电流斜坡在 $t=0$ 时刻启动，使得对于 $t \\ge 0$，$\\frac{d i_{c}}{d t} = \\dot{I}_{c}$ 是一个常数，并假设初始涡流为零，$i_{v}(0) = 0$。根据法拉第定律，围绕等离子体轮廓的环路电压为 $V_{\\text{loop}} = -\\,\\frac{d \\psi_{p}}{d t}$，在轴对称条件下，半径 $R$ 处的环向电场大小为 $E_{\\varphi} = \\frac{|V_{\\text{loop}}|}{2\\pi R}$。\n\n仅使用麦克斯韦-法拉第定律和给定的线性电路关系，推导电流斜坡刚开始后初始环向电场大小 $E_{\\varphi}(0^{+})$ 的表达式，然后对以下数值进行计算：\n$M_{cp} = 4.0 \\times 10^{-5}\\,\\text{H}$，$M_{vp} = 3.0 \\times 10^{-5}\\,\\text{H}$，$M_{cv} = 5.0 \\times 10^{-5}\\,\\text{H}$，$L_{v} = 5.0 \\times 10^{-3}\\,\\text{H}$，$R_{v} = 7.50 \\times 10^{-4}\\,\\Omega$，以及 $\\dot{I}_{c} = 5.00 \\times 10^{5}\\,\\text{A/s}$。\n\n将 $E_{\\varphi}(0^{+})$ 的最终数值答案四舍五入到四位有效数字，并以 $\\text{V/m}$ 为单位表示。最终答案必须是一个实数值。",
            "solution": "对所述问题进行形式化有效性分析。\n\n### 步骤1：提取已知条件\n- 目标大半径：$R = 3.000\\,\\text{m}$。\n- 链接等离子体轮廓的极向磁通：$\\psi_{p} = M_{cp}\\,i_{c} + M_{vp}\\,i_{v}$。\n- 真空室电路定律：$L_{v}\\,\\frac{d i_{v}}{d t} + R_{v}\\,i_{v} = -\\,M_{cv}\\,\\frac{d i_{c}}{d t}$。\n- $t \\ge 0$ 时的中心螺线管（CS）电流斜坡：$\\frac{d i_{c}}{d t} = \\dot{I}_{c} = \\text{常数}$。\n- 涡流的初始条件：$i_{v}(0) = 0$。\n- 环路电压定义：$V_{\\text{loop}} = -\\,\\frac{d \\psi_{p}}{d t}$。\n- 环向电场定义：$E_{\\varphi} = \\frac{|V_{\\text{loop}}|}{2\\pi R}$。\n- 数值常数：\n  - $M_{cp} = 4.0 \\times 10^{-5}\\,\\text{H}$\n  - $M_{vp} = 3.0 \\times 10^{-5}\\,\\text{H}$\n  - $M_{cv} = 5.0 \\times 10^{-5}\\,\\text{H}$\n  - $L_{v} = 5.0 \\times 10^{-3}\\,\\text{H}$\n  - $R_{v} = 7.50 \\times 10^{-4}\\,\\Omega$\n  - $\\dot{I}_{c} = 5.00 \\times 10^{5}\\,\\text{A/s}$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了托卡马克感应击穿的标准且成熟的集总参数电路模型，该模型源自麦克斯韦方程组。问题是适定的，提供了一整套线性微分方程、初始条件和常数参数，确保了唯一解的存在。语言客观、精确。该问题未违反任何无效性标准。这是一个可形式化的物理问题，与核聚变中的等离子体启动主题直接相关。所提供的参数在此类设备的实际范围内。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n目标是确定在 $t=0$ 时CS电流斜坡开始后，初始环向电场的大小 $E_{\\varphi}(0^{+})$。\n\n环向电场 $E_{\\varphi}$ 与环路电压 $V_{\\text{loop}}$ 的关系由给定表达式给出：\n$$E_{\\varphi}(t) = \\frac{|V_{\\text{loop}}(t)|}{2\\pi R}$$\n环路电压由应用于等离子体轮廓的法拉第感应定律定义：\n$$V_{\\text{loop}}(t) = -\\frac{d\\psi_p}{dt}$$\n链接等离子体轮廓的极向磁通 $\\psi_p$ 由CS电流 $i_c$ 和真空室涡流 $i_v$ 产生的磁通线性组合给出：\n$$\\psi_p(t) = M_{cp}\\,i_c(t) + M_{vp}\\,i_v(t)$$\n为求得环路电压，我们必须对 $\\psi_p$ 求时间导数：\n$$\\frac{d\\psi_p}{dt} = M_{cp}\\frac{di_c}{dt} + M_{vp}\\frac{di_v}{dt}$$\n因此，环路电压为：\n$$V_{\\text{loop}}(t) = -\\left( M_{cp}\\frac{di_c}{dt} + M_{vp}\\frac{di_v}{dt} \\right)$$\n我们关心的是这些量在 $t=0^{+}$ 时的值。题目给出对于 $t \\ge 0$，CS电流斜坡是恒定的：\n$$\\frac{di_c}{dt} = \\dot{I}_{c}$$\n因此，$\\frac{di_c}{dt}\\big|_{t=0^+} = \\dot{I}_c$。\n\n为了求得 $V_{\\text{loop}}(0^{+})$，我们必须首先确定在 $t=0^{+}$ 时真空室电流的变化率 $\\frac{di_v}{dt}$。这可以通过分析真空室的电路方程得到：\n$$L_{v}\\frac{di_v}{dt} + R_{v}\\,i_v = -M_{cv}\\frac{di_c}{dt}$$\n我们在 $t=0^{+}$ 时刻计算此方程：\n$$L_{v}\\frac{di_v}{dt}\\bigg|_{t=0^+} + R_{v}\\,i_v(0^+) = -M_{cv}\\frac{di_c}{dt}\\bigg|_{t=0^+}$$\n问题给出了初始条件 $i_v(0) = 0$。通过电感器（$L_v$）的电流必须是时间的连续函数，因为不连续的跳变将意味着无穷大的电压，这在物理上是不可能的。因此，$i_v(0^+) = i_v(0) = 0$。将此条件和恒定的CS电流斜坡代入真空室方程，得到：\n$$L_{v}\\frac{di_v}{dt}\\bigg|_{t=0^+} + R_{v}(0) = -M_{cv}\\dot{I}_c$$\n$$L_{v}\\frac{di_v}{dt}\\bigg|_{t=0^+} = -M_{cv}\\dot{I}_c$$\n解出真空室电流的初始变化率：\n$$\\frac{di_v}{dt}\\bigg|_{t=0^+} = -\\frac{M_{cv}}{L_v}\\dot{I}_c$$\n此结果表明，在斜坡刚开始时，真空室的电阻 $R_v$ 无关紧要；感应电动势完全由真空室的感性响应来平衡。\n\n现在我们可以通过将导数代入其表达式来计算 $t=0^{+}$ 时的环路电压：\n$$V_{\\text{loop}}(0^{+}) = -\\left( M_{cp}\\frac{di_c}{dt}\\bigg|_{t=0^+} + M_{vp}\\frac{di_v}{dt}\\bigg|_{t=0^+} \\right)$$\n$$V_{\\text{loop}}(0^{+}) = -\\left( M_{cp}\\dot{I}_c + M_{vp}\\left(-\\frac{M_{cv}}{L_v}\\dot{I}_c\\right) \\right)$$\n提出因子 $\\dot{I}_c$：\n$$V_{\\text{loop}}(0^{+}) = -\\dot{I}_c \\left( M_{cp} - \\frac{M_{vp}M_{cv}}{L_v} \\right)$$\n$$V_{\\text{loop}}(0^{+}) = \\dot{I}_c \\left( \\frac{M_{vp}M_{cv}}{L_v} - M_{cp} \\right)$$\n最后，初始环向电场的大小由下式给出：\n$$E_{\\varphi}(0^+) = \\frac{|V_{\\text{loop}}(0^+)|}{2\\pi R} = \\frac{1}{2\\pi R} \\left| \\dot{I}_c \\left( \\frac{M_{vp}M_{cv}}{L_v} - M_{cp} \\right) \\right|$$\n因为 $\\dot{I}_c$ 是一个正常数，这可以简化为：\n$$E_{\\varphi}(0^+) = \\frac{\\dot{I}_c}{2\\pi R} \\left| \\frac{M_{vp}M_{cv}}{L_v} - M_{cp} \\right|$$\n这是最终的符号表达式。现在，我们代入给定的数值：\n$M_{cp} = 4.0 \\times 10^{-5}\\,\\text{H}$\n$M_{vp} = 3.0 \\times 10^{-5}\\,\\text{H}$\n$M_{cv} = 5.0 \\times 10^{-5}\\,\\text{H}$\n$L_{v} = 5.0 \\times 10^{-3}\\,\\text{H}$\n$R = 3.000\\,\\text{m}$\n$\\dot{I}_{c} = 5.00 \\times 10^{5}\\,\\text{A/s}$\n\n首先，我们计算绝对值内的项：\n$$\\frac{M_{vp}M_{cv}}{L_v} - M_{cp} = \\frac{(3.0 \\times 10^{-5})(5.0 \\times 10^{-5})}{5.0 \\times 10^{-3}} - (4.0 \\times 10^{-5})$$\n$$\\frac{M_{vp}M_{cv}}{L_v} = \\frac{15.0 \\times 10^{-10}}{5.0 \\times 10^{-3}} = 3.0 \\times 10^{-7}\\,\\text{H}$$\n$$\\frac{M_{vp}M_{cv}}{L_v} - M_{cp} = (3.0 \\times 10^{-7}) - (4.0 \\times 10^{-5}) = (0.03 \\times 10^{-5}) - (4.0 \\times 10^{-5}) = -3.97 \\times 10^{-5}\\,\\text{H}$$\n现在我们计算电场：\n$$E_{\\varphi}(0^+) = \\frac{5.00 \\times 10^5}{2\\pi (3.000)} \\left| -3.97 \\times 10^{-5} \\right|$$\n$$E_{\\varphi}(0^+) = \\frac{5.00 \\times 10^5 \\times 3.97 \\times 10^{-5}}{6.000 \\pi}$$\n$$E_{\\varphi}(0^+) = \\frac{5.00 \\times 3.97}{6.000 \\pi} = \\frac{19.85}{6.000 \\pi}$$\n$$E_{\\varphi}(0^+) \\approx \\frac{19.85}{18.8495559...} \\approx 1.053075\\,\\text{V/m}$$\n根据要求将结果四舍五入到四位有效数字：\n$$E_{\\varphi}(0^+) \\approx 1.053\\,\\text{V/m}$$",
            "answer": "$$\\boxed{1.053}$$"
        },
        {
            "introduction": "在掌握了击穿的静态条件和初始瞬态效应后，这最后一个实践将所有物理过程综合到一个动态仿真中。我们将构建一个“零维”模型，用于追踪电子密度和电子温度随时间的演化。这个练习要求你求解一个耦合速率方程组，该方程组包含了欧姆加热、电离、复合以及能量和粒子损失等多个关键物理过程，从而让你对从初始种子电子到完全击穿的整个雪崩过程获得一个全面的、动态的认识。",
            "id": "3714780",
            "problem": "考虑在Tokamak（一种用于核聚变的环形磁约束装置）中的初始等离子体启动和击穿过程。该过程被建模为一个零维（0D）系统，其中电子群体在空间上被视为均匀分布。您需要从基本定律和经过充分检验的公式出发，推导一组关于电子数密度和电子能量的耦合速率方程，然后实现一个数值模拟来确定击穿时间。击穿时间定义为电子数密度首次达到或超过指定阈值的时刻。您的程序的最终输出必须是单行，包含一个方括号括起来的逗号分隔列表，其中每个元素是对应测试用例的击穿时间（以秒为单位），或者如果击穿在指定的模拟时间窗口内没有发生，则为值$-1.0$。\n\n您必须从以下基础出发：\n- 电子的粒子数连续性：电子数密度的时间变化率等于源项减去汇项，$dn_e/dt = S - L$。\n- 电子能量平衡：电子能量密度的时间变化率等于输入功率减去功率损失，$dW/dt = P_{\\mathrm{in}} - P_{\\mathrm{loss}}$，其中 $W$ 是电子能量密度。\n- 中性气体的理想气体定律：$p = n_n k_B T_g$，其中 $p$ 是中性气体压强，$n_n$ 是中性粒子数密度，$k_B$ 是玻尔兹曼常数，$T_g$ 是中性气体温度。\n- 源自 Drude 模型的广义电导率：$\\sigma = \\dfrac{e^2 n_e}{m_e \\nu_e}$，其中 $e$ 是元电荷，$m_e$ 是电子质量，$\\nu_e$ 是有效电子碰撞频率。\n- 电子-中性粒子碰撞频率：$\\nu_{en} = n_n \\sigma_{en} v_{th}$，当电子温度 $T_e$ 以电子伏特为单位时，热速度为 $v_{th} = \\sqrt{\\dfrac{8 e T_e}{\\pi m_e}}$。\n- 电子-离子（库仑）碰撞频率近似：$\\nu_{ei} = C_{ei} n_e \\ln\\Lambda \\, T_e^{-3/2}$，其中 $C_{ei}$ 是一个已知的数值系数，$\\ln\\Lambda$ 是库仑对数。\n- 欧姆加热功率密度：对于电场强度大小 $E$，有 $p_{\\mathrm{ohm}} = \\sigma E^2$。\n- 电离源由电子碰撞速率系数 $k_{\\mathrm{ion}}(T_e)$ 建模，使得 $S_{\\mathrm{ion}} = n_e n_n k_{\\mathrm{ion}}(T_e)$。\n- 辐射复合损失由 $\\alpha_r(T_e)$ 建模，使得 $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e^2$。\n- 粒子损失建模为一阶线性项 $L_{\\mathrm{wall}} = n_e/\\tau_p$，其中 $\\tau_p$ 是粒子约束时间。\n- 能量损失通道包括电离能量汇和一个能量约束项 $W/\\tau_E$，为简化起见，在启动期间取 $\\tau_E$ 等于 $\\tau_p$。\n- 在相关时间尺度上，对于电子-离子复合项，准中性成立。\n\n您必须推导 $n_e(t)$ 和电子能量密度 $W(t)$ 的闭合方程。在任意时刻，通过热能和密度之间的关系定义 $T_e(t)$，$W(t) = \\dfrac{3}{2} n_e(t) e T_e(t)$，其中 $T_e$ 以电子伏特为单位， $e$ 是从电子伏特到焦耳的转换因子。使用 $T_e(t) = \\max\\{T_{\\mathrm{floor}}, \\dfrac{2 W(t)}{3 e n_e(t)}\\}$ 来确保数值稳健性，其中 $T_{\\mathrm{floor}}$ 是一个小的正数下限。\n\n在您的推导和模拟中使用的本构模型和常数：\n- 元电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，电子质量 $m_e = 9.10938356\\times 10^{-31}\\,\\mathrm{kg}$，玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n- 中性气体温度 $T_g = 300\\,\\mathrm{K}$。\n- 电子-中性粒子动量传递截面 $\\sigma_{en} = 2.0\\times 10^{-19}\\,\\mathrm{m^2}$。\n- 库仑碰撞系数 $C_{ei} = 2.91\\times 10^{-6}\\,\\mathrm{m^3\\,s^{-1}\\,eV^{3/2}}$ 和库仑对数 $\\ln\\Lambda = 12$。\n- 每个电子-离子对的电离能 $U_{\\mathrm{ion}} = 15.4\\,\\mathrm{eV}$。\n- 电子碰撞电离速率系数模型 $k_{\\mathrm{ion}}(T_e) = C_{\\mathrm{ion}} \\sqrt{T_e}\\, \\exp\\!\\left(-\\dfrac{U_{\\mathrm{ion}}}{T_e}\\right)$，其中 $C_{\\mathrm{ion}} = 1.0\\times 10^{-17}\\,\\mathrm{m^3\\,s^{-1}\\,eV^{-1/2}}$。\n- 辐射复合系数 $\\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}$，其中 $\\alpha_0 = 1.0\\times 10^{-19}\\,\\mathrm{m^3/s}$。\n- 能量约束时间 $\\tau_E = \\tau_p$。\n- 电子温度下限 $T_{\\mathrm{floor}} = 0.1\\,\\mathrm{eV}$。\n- 初始电子数密度 $n_e(0) = n_{e0} = 1.0\\times 10^{12}\\,\\mathrm{m^{-3}}$。\n- 初始电子温度 $T_e(0) = T_{e0} = 2.0\\,\\mathrm{eV}$，因此 $W(0) = \\dfrac{3}{2} n_{e0} e T_{e0}$。\n- 击穿阈值 $n_* = 1.0\\times 10^{19}\\,\\mathrm{m^{-3}}$；击穿时间是满足 $n_e(t) \\ge n_*$ 的最早时间 $t$。\n- 对于数值积分，请使用能处理刚性问题的常微分方程求解器，并在 $n_e(t)$ 从下方穿过 $n_*$ 时通过事件停止；否则，在最大模拟时间处停止。\n\n您必须基于您的推导，通过求解 $n_e(t)$ 和 $W(t)$ 的耦合常微分方程来实现数值模拟，并使用以下测试套件。每个测试用例是一个元组 $(E, p, \\tau_p, t_{\\max})$，其中 $E$ 是电场强度大小（单位 $\\mathrm{V/m}$），$p$ 是中性气体压强（单位 $\\mathrm{Pa}$），$\\tau_p$ 是粒子约束时间（单位 $\\mathrm{s}$），$t_{\\max}$ 是最大模拟时间（单位 $\\mathrm{s}$）。对于每个测试用例，输出以秒为单位的击穿时间（作为浮点数），按默认浮点表示法取整，或者如果对于所有 $t \\in [0, t_{\\max}]$ 都有 $n_e(t)  n_*$，则输出 $-1.0$。\n\n使用以下测试套件：\n- 测试用例 $1$：$(E, p, \\tau_p, t_{\\max}) = (20.0, 0.05, 0.005, 0.05)$。\n- 测试用例 $2$：$(E, p, \\tau_p, t_{\\max}) = (8.0, 0.05, 0.005, 0.05)$。\n- 测试用例 $3$：$(E, p, \\tau_p, t_{\\max}) = (30.0, 0.05, 0.005, 0.05)$。\n- 测试用例 $4$：$(E, p, \\tau_p, t_{\\max}) = (20.0, 0.01, 0.005, 0.05)$。\n- 测试用例 $5$：$(E, p, \\tau_p, t_{\\max}) = (20.0, 0.10, 0.005, 0.05)$。\n- 测试用例 $6$：$(E, p, \\tau_p, t_{\\max}) = (20.0, 0.05, 0.002, 0.05)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含所有六个测试用例的结果，格式为方括号括起来的逗号分隔列表，例如 $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5,\\mathrm{result}_6\\right]$，其中每个 $\\mathrm{result}_i$ 是一个以秒为单位的浮点数，或者如果未发生击穿，则为浮点数 $-1.0$。\n\n所有物理单位必须一致处理，所有数值答案必须以秒表示。不使用角度。输出的任何地方都不得使用百分比；任何分数量必须以小数形式表示。",
            "solution": "## 问题验证\n\n### 第1步：提取已知条件\n该问题为零维（0D）Tokamak等离子体击穿模拟提供了以下数据、定义和模型：\n\n**基本方程：**\n- 电子连续性：$\\dfrac{dn_e}{dt} = S - L$\n- 电子能量平衡：$\\dfrac{dW}{dt} = P_{\\mathrm{in}} - P_{\\mathrm{loss}}$\n- 中性气体的理想气体定律：$p = n_n k_B T_g$\n- 电子能量密度与温度的关系：$W(t) = \\dfrac{3}{2} n_e(t) e T_e(t)$，其中 $T_e$ 以电子伏特（eV）为单位。\n- 温度的数值下限：$T_e(t) = \\max\\{T_{\\mathrm{floor}}, \\dfrac{2 W(t)}{3 e n_e(t)}\\}$\n\n**本构模型和系数：**\n- Drude电导率：$\\sigma = \\dfrac{e^2 n_e}{m_e \\nu_e}$\n- 电子-中性粒子碰撞频率：$\\nu_{en} = n_n \\sigma_{en} v_{th}$\n- 电子热速度：$v_{th} = \\sqrt{\\dfrac{8 e T_e}{\\pi m_e}}$（对于以eV为单位的$T_e$）\n- 电子-离子碰撞频率：$\\nu_{ei} = C_{ei} n_e \\ln\\Lambda \\, T_e^{-3/2}$\n- 有效碰撞频率：$\\nu_e = \\nu_{en} + \\nu_{ei}$\n- 欧姆加热功率密度：$p_{\\mathrm{ohm}} = \\sigma E^2$\n- 电离源：$S_{\\mathrm{ion}} = n_e n_n k_{\\mathrm{ion}}(T_e)$\n- 电离速率系数：$k_{\\mathrm{ion}}(T_e) = C_{\\mathrm{ion}} \\sqrt{T_e}\\, \\exp\\!\\left(-\\dfrac{U_{\\mathrm{ion}}}{T_e}\\right)$\n- 辐射复合损失：$L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e^2$\n- 复合系数：$\\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}$\n- 粒子壁损失：$L_{\\mathrm{wall}} = n_e/\\tau_p$\n- 电离引起的能量损失：与电离速率 $S_{\\mathrm{ion}}$ 和电离能 $U_{\\mathrm{ion}}$ 成正比。\n- 约束引起的能量损失：$W/\\tau_E$\n- 约束时间假设：$\\tau_E = \\tau_p$\n- 准中性：假定对于复合项成立（$n_i \\approx n_e$）。\n\n**常数和固定参数：**\n- 元电荷：$e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n- 电子质量：$m_e = 9.10938356\\times 10^{-31}\\,\\mathrm{kg}$\n- 玻尔兹曼常数：$k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$\n- 中性气体温度：$T_g = 300\\,\\mathrm{K}$\n- 电子-中性粒子截面：$\\sigma_{en} = 2.0\\times 10^{-19}\\,\\mathrm{m^2}$\n- 库仑碰撞系数：$C_{ei} = 2.91\\times 10^{-6}\\,\\mathrm{m^3\\,s^{-1}\\,eV^{3/2}}$\n- 库仑对数：$\\ln\\Lambda = 12$\n- 电离能：$U_{\\mathrm{ion}} = 15.4\\,\\mathrm{eV}$\n- 电离系数常数：$C_{\\mathrm{ion}} = 1.0\\times 10^{-17}\\,\\mathrm{m^3\\,s^{-1}\\,eV^{-1/2}}$\n- 复合系数常数：$\\alpha_0 = 1.0\\times 10^{-19}\\,\\mathrm{m^3/s}$\n- 温度下限：$T_{\\mathrm{floor}} = 0.1\\,\\mathrm{eV}$\n\n**初始和边界条件：**\n- 初始电子密度：$n_e(0) = n_{e0} = 1.0\\times 10^{12}\\,\\mathrm{m^{-3}}$\n- 初始电子温度：$T_e(0) = T_{e0} = 2.0\\,\\mathrm{eV}$\n- 初始能量密度：$W(0) = \\dfrac{3}{2} n_{e0} e T_{e0}$\n- 击穿阈值：$n_* = 1.0\\times 10^{19}\\,\\mathrm{m^{-3}}$\n- 击穿时间的定义：$n_e(t) \\ge n_*$ 的首次时刻 $t$。\n\n**测试用例：**\n一套包含六个测试用例的测试套件，每个测试用例由元组 $(E, p, \\tau_p, t_{\\max})$ 定义。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据充分**：是。该问题基于一个标准的、尽管简化的等离子体动力学0D模型。粒子连续性、能量平衡、欧姆加热、碰撞频率和原子过程（电离、复合）的方程都植根于已建立的等离子体物理学原理（例如，Drude模型、Spitzer碰撞理论、速率方程）。\n- **适定性**：是。该问题要求推导并数值求解一个具有明确初始条件的耦合一阶常微分方程组（ODE）。这种结构通常在给定的时间区间内有唯一且稳定的解。目标明确：找到达到特定密度阈值的时间。\n- **客观性**：是。该问题以精确、定量的术语陈述。所有常数、公式和参数都已明确给出。没有主观或基于意见的陈述。\n- **一致性与完整性**：该问题提供了一套自洽的方程、常数和初始条件。\n    - $\\alpha_0$ 的单位存在一个明显的模糊之处，它源于公式 $\\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}$。要使 $\\alpha_r$ 具有速率系数的标准单位（$\\mathrm{m^3/s}$），$\\alpha_0$ 的单位必须隐含为 $\\mathrm{m^3 s^{-1} eV^{0.7}}$。这是物理学文献中一种常见的符号简写，应如此理解，而非视为矛盾。\n    - 所有其他公式和常数在量纲上都是一致的，并且对于Tokamak启动的背景来说是物理上合理的。\n- **可行性**：指定的条件和参数对于聚变研究中的实验场景是现实的。所要求的数值任务可以使用推荐的标准刚性ODE求解器来解决。\n\n### 第3步：结论与行动\n该问题是**有效的**。这是一个在计算等离子体物理学中定义明确、科学合理的问题。所要求的推导和模拟是适当且可行的。\n\n## 0D模型的推导\n目标是为电子数密度 $n_e(t)$ 和电子能量密度 $W(t)$ 推导一个闭合的耦合常微分方程组。系统在任意时刻 $t$ 的状态由向量 $\\vec{y}(t) = [n_e(t), W(t)]^T$ 描述。\n\n### 电子密度速率方程\n电子数密度 $n_e$ 的演化由粒子连续性方程控制：\n$$\n\\frac{dn_e}{dt} = S - L\n$$\n其中 $S$ 代表粒子源项速率，$L$ 代表粒子损失（汇项）速率。\n\n- **源项 ($S$)**：击穿期间电子的主要来源是中性气体的电子碰撞电离。该速率由 $S_{\\mathrm{ion}} = n_e n_n k_{\\mathrm{ion}}(T_e)$ 给出，其中 $n_n$ 是中性气体密度，$k_{\\mathrm{ion}}(T_e)$ 是与温度相关的电离速率系数。\n\n- **损失项 ($L$)**：指定了两种损失机制：\n    1.  **辐射复合**：电子和离子复合，形成一个中性原子并发射一个光子。速率为 $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e n_i$。假设准中性（$n_i \\approx n_e$），这变为 $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e^2$。\n    2.  **器壁损失**：电子通过输运过程损失到Tokamak真空室壁上。这被建模为一个一阶衰减项 $L_{\\mathrm{wall}} = n_e / \\tau_p$，其中 $\\tau_p$ 是粒子约束时间。\n\n结合这些项，电子密度的完整速率方程为：\n$$\n\\frac{dn_e}{dt} = n_e n_n k_{\\mathrm{ion}}(T_e) - \\alpha_r(T_e) n_e^2 - \\frac{n_e}{\\tau_p}\n$$\n\n### 电子能量密度速率方程\n电子能量密度 $W$（单位 $\\mathrm{J/m^3}$）的演化由能量平衡方程控制：\n$$\n\\frac{dW}{dt} = P_{\\mathrm{in}} - P_{\\mathrm{loss}}\n$$\n其中 $P_{\\mathrm{in}}$ 是输入功率密度，$P_{\\mathrm{loss}}$ 是损失功率密度。\n\n- **输入功率 ($P_{\\mathrm{in}}$)**：指定的唯一加热机制是来自环向电场 $E$ 的欧姆（或焦耳）加热。功率密度为 $P_{\\mathrm{ohm}} = j E = \\sigma E^2$，其中 $\\sigma$ 是等离子体的电导率。\n\n- **损失功率 ($P_{\\mathrm{loss}}$)**：包括两个能量损失通道：\n    1.  **电离能量成本**：每次电离事件消耗一定量的能量 $U_{\\mathrm{ion}}$（单位 eV），用于释放电子。因电离而损失的功率密度是电离事件的速率乘以每次事件的能量成本（以焦耳为单位）。这得到 $P_{\\mathrm{ion}} = S_{\\mathrm{ion}} \\cdot (e U_{\\mathrm{ion}}) = n_e n_n k_{\\mathrm{ion}}(T_e) e U_{\\mathrm{ion}}$，其中 $e$ 是每eV对应的焦耳数，即元电荷。\n    2.  **能量约束损失**：与粒子损失类似，能量从等离子体中输运到器壁。这被建模为 $P_{\\mathrm{conf}} = W / \\tau_E$。问题指定使用 $\\tau_E = \\tau_p$。\n\n结合这些项，电子能量密度的完整速率方程为：\n$$\n\\frac{dW}{dt} = \\sigma E^2 - n_e n_n k_{\\mathrm{ion}}(T_e) e U_{\\mathrm{ion}} - \\frac{W}{\\tau_p}\n$$\n\n### 闭合关系\n为了求解该方程组，常微分方程右侧的所有项都必须表示为状态变量 $n_e$ 和 $W$ 以及输入参数的函数。\n\n1.  **电子温度 ($T_e$)**：通过 $W = \\frac{3}{2} n_e e T_e$ 与能量密度和数密度相关，其中 $T_e$ 的单位是eV。反转此关系并包含数值下限，我们得到：\n    $$\n    T_e = \\max\\left(T_{\\mathrm{floor}}, \\frac{2W}{3 n_e e}\\right)\n    $$\n\n2.  **中性粒子密度 ($n_n$)**：根据理想气体定律，使用给定的背景压强 $p$ 和温度 $T_g$ 计算：\n    $$\n    n_n = \\frac{p}{k_B T_g}\n    $$\n\n3.  **速率系数 ($k_{\\mathrm{ion}}, \\alpha_r$)**：这些是 $T_e$ 的显式函数：\n    $$\n    k_{\\mathrm{ion}}(T_e) = C_{\\mathrm{ion}} \\sqrt{T_e}\\, \\exp\\left(-\\frac{U_{\\mathrm{ion}}}{T_e}\\right)\n    $$\n    $$\n    \\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}\n    $$\n\n4.  **电导率 ($\\sigma$)**：取决于有效电子碰撞频率 $\\nu_e = \\nu_{en} + \\nu_{ei}$。\n    - 电子-中性粒子频率 $\\nu_{en}$ 通过热速度 $v_{th}$ 依赖于 $T_e$：\n      $$ \\nu_{en} = n_n \\sigma_{en} \\sqrt{\\frac{8 e T_e}{\\pi m_e}} $$\n    - 电子-离子频率 $\\nu_{ei}$ 依赖于 $n_e$ 和 $T_e$：\n      $$ \\nu_{ei} = C_{ei} n_e \\ln\\Lambda \\, T_e^{-3/2} $$\n    - 电导率 $\\sigma$ 则为：\n      $$ \\sigma = \\frac{e^2 n_e}{m_e (\\nu_{en} + \\nu_{ei})} $$\n\n### 最终的常微分方程组\n定义了所有项之后，我们得到了状态向量 $\\vec{y}(t) = [n_e(t), W(t)]^T$ 的最终耦合、非线性、一阶常微分方程组：\n\n$$\n\\frac{d}{dt} \\begin{pmatrix} n_e \\\\ W \\end{pmatrix} = \\begin{pmatrix} n_e n_n k_{\\mathrm{ion}}(T_e) - \\alpha_r(T_e) n_e^2 - \\dfrac{n_e}{\\tau_p} \\\\ \\\\ \\sigma(n_e, T_e) E^2 - n_e n_n k_{\\mathrm{ion}}(T_e) e U_{\\mathrm{ion}} - \\dfrac{W}{\\tau_p} \\end{pmatrix}\n$$\n\n其中 $T_e$, $n_n$, $k_{\\mathrm{ion}}$, $\\alpha_r$ 和 $\\sigma$ 是如上定义的 $n_e$、$W$ 和固定参数的函数。该方程组连同初始条件 $n_e(0) = n_{e0}$ 和 $W(0) = \\frac{3}{2} n_{e0} e T_{e0}$，可以通过数值方法求解，以找到等离子体的时间演化并确定击穿时间。方程的刚性源于时间尺度的巨大差异，从快速的碰撞过程到较慢的约束损失，以及电离对温度的高度非线性和指数依赖性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves a 0D model for tokamak plasma breakdown.\n    The model consists of two coupled ODEs for electron density (n_e)\n    and electron energy density (W).\n    \"\"\"\n\n    # --- Constants and Fixed Parameters ---\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs (and J/eV)\n    M_E = 9.10938356e-31       # Electron mass in kg\n    K_B = 1.380649e-23         # Boltzmann constant in J/K\n    T_G = 300.0                # Neutral gas temperature in K\n    SIGMA_EN = 2.0e-19         # Electron-neutral momentum-transfer cross-section in m^2\n    C_EI = 2.91e-6             # Coefficient for electron-ion collisions in m^3 s^-1 eV^(3/2)\n    LN_LAMBDA = 12.0           # Coulomb logarithm\n    U_ION = 15.4               # Ionization energy in eV\n    C_ION = 1.0e-17            # Coefficient for ionization rate in m^3 s^-1 eV^(-1/2)\n    ALPHA_0 = 1.0e-19          # Coefficient for recombination rate (units m^3/s * eV^0.7)\n    T_FLOOR = 0.1              # Electron temperature floor in eV\n    \n    # --- Initial and Boundary Conditions ---\n    N_E0 = 1.0e12              # Initial electron number density in m^-3\n    T_E0 = 2.0                 # Initial electron temperature in eV\n    N_STAR = 1.0e19            # Breakdown threshold for electron density in m^-3\n    \n    # --- Initial energy density (J/m^3) ---\n    W0 = 1.5 * N_E0 * E_CHARGE * T_E0\n\n    def solve_case(E, p, tau_p, t_max):\n        \"\"\"\n        Solves the ODE system for a single test case.\n        \n        Args:\n            E (float): Electric field magnitude (V/m)\n            p (float): Neutral gas pressure (Pa)\n            tau_p (float): Particle confinement time (s)\n            t_max (float): Maximum simulation time (s)\n            \n        Returns:\n            float: Breakdown time in seconds, or -1.0 if no breakdown.\n        \"\"\"\n        # Calculate constant neutral density from pressure\n        n_n = p / (K_B * T_G)\n\n        def ode_system(t, y):\n            n_e, W = y\n            \n            # Prevent numerical instability for non-physical values\n            if n_e = 0:\n                return [0.0, 0.0]\n\n            # Calculate electron temperature (eV) from state variables\n            # Includes a floor for numerical stability\n            T_e = max(T_FLOOR, (2.0 * W) / (3.0 * n_e * E_CHARGE))\n            \n            # --- Calculate Temperature-Dependent Coefficients ---\n            \n            # Ionization rate coefficient (m^3/s)\n            k_ion = C_ION * np.sqrt(T_e) * np.exp(-U_ION / T_e)\n            \n            # Recombination rate coefficient (m^3/s)\n            alpha_r = ALPHA_0 * T_e**(-0.7)\n            \n            # --- Calculate Collision Frequencies (s^-1) ---\n            \n            # Electron thermal speed (m/s)\n            v_th = np.sqrt(8.0 * E_CHARGE * T_e / (np.pi * M_E))\n            \n            # Electron-neutral collision frequency\n            nu_en = n_n * SIGMA_EN * v_th\n            \n            # Electron-ion collision frequency\n            nu_ei = C_EI * n_e * LN_LAMBDA * T_e**(-1.5)\n            \n            # Total effective collision frequency\n            nu_e = nu_en + nu_ei\n            \n            # --- Calculate Plasma Conductivity (S/m) ---\n            sigma = (E_CHARGE**2 * n_e) / (M_E * nu_e) if nu_e > 0 else 0.0\n            \n            # --- Assemble the ODEs ---\n            \n            # 1. Rate of change for electron density (dn_e/dt)\n            source_ion = n_e * n_n * k_ion\n            loss_rec = alpha_r * n_e**2\n            loss_wall = n_e / tau_p\n            dn_e_dt = source_ion - loss_rec - loss_wall\n            \n            # 2. Rate of change for electron energy density (dW/dt)\n            power_in_ohm = sigma * E**2\n            power_loss_ion = source_ion * (U_ION * E_CHARGE)\n            power_loss_conf = W / tau_p\n            dW_dt = power_in_ohm - power_loss_ion - power_loss_conf\n            \n            return [dn_e_dt, dW_dt]\n\n        # Define the event to detect breakdown\n        def breakdown_event(t, y):\n            return y[0] - N_STAR\n        \n        breakdown_event.terminal = True  # Stop integration when event occurs\n        \n        # Set initial conditions\n        y0 = [N_E0, W0]\n        \n        # Solve the ODE system using a stiff solver\n        sol = solve_ivp(\n            ode_system, \n            [0, t_max], \n            y0, \n            method='Radau', \n            events=breakdown_event,\n            dense_output=True\n        )\n        \n        # Check if the breakdown event was triggered\n        if sol.status == 1 and sol.t_events[0].size > 0:\n            return sol.t_events[0][0]\n        else:\n            return -1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E, p, tau_p, t_max)\n        (20.0, 0.05, 0.005, 0.05),\n        (8.0, 0.05, 0.005, 0.05),\n        (30.0, 0.05, 0.005, 0.05),\n        (20.0, 0.01, 0.005, 0.05),\n        (20.0, 0.10, 0.005, 0.05),\n        (20.0, 0.05, 0.002, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, p, tau_p, t_max = case\n        result = solve_case(E, p, tau_p, t_max)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}