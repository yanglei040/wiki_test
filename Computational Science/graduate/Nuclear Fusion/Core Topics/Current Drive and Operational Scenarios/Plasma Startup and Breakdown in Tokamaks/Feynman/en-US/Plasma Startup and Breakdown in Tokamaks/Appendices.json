{
    "hands_on_practices": [
        {
            "introduction": "The success of plasma breakdown hinges on a delicate balance. Too little neutral gas and electrons travel too far without ionizing collisions; too much gas and they lose energy too quickly to reach the required ionization threshold. This exercise explores this fundamental trade-off, guiding you to find the optimal prefill pressure that minimizes the required loop voltage for breakdown, a concept central to the well-known Paschen's Law. By numerically optimizing the breakdown condition from first principles, you will gain a hands-on understanding of one of the most critical parameters in tokamak operation .",
            "id": "3714787",
            "problem": "You are tasked with designing a complete, runnable program that computes the optimal prefill neutral gas pressure for the initial electron avalanche during plasma breakdown in a tokamak, using a first-principles model that relates the required loop voltage to the neutral gas pressure through the Townsend breakdown framework. The aim is to determine the neutral pressure that minimizes the loop voltage necessary for initiating breakdown, based on fundamental particle multiplication and wall-loss physics, without assuming any pre-derived optimality condition. The program must evaluate the specified test suite and produce a single-line output aggregating the results.\n\nThe base model must begin from well-established principles:\n- The Ideal Gas Law relates neutral density to pressure: $n_{\\mathrm{n}} = p / (k_{\\mathrm{B}} T_{\\mathrm{n}})$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T_{\\mathrm{n}}$ is the neutral temperature.\n- The electron avalanche (Townsend) model describes the first ionization coefficient $\\alpha$ through the empirical relationship $\\alpha / p = A \\exp\\!\\left(- B p / E \\right)$, where $A$ and $B$ are gas-dependent constants, $p$ is the neutral pressure, and $E$ is the electric field magnitude along the direction of electron motion.\n- The tokamak loop voltage $V_{\\mathrm{loop}}$ creates a toroidal electric field $E = V_{\\mathrm{loop}}/(2 \\pi R)$, where $R$ is the tokamak major radius.\n- The Townsend breakdown condition along an effective connection length $L_{\\mathrm{eff}}$ is stipulated by the secondary emission law $\\gamma$: $\\exp(\\alpha L_{\\mathrm{eff}}) (1 - \\gamma) = 1$, equivalently $\\alpha L_{\\mathrm{eff}} = \\ln(1 + 1/\\gamma)$.\n\nUnder these assumptions, breakdown is possible only if the loop voltage is sufficiently large such that the electric field satisfies the Townsend breakdown criterion. By combining the expressions, the required electric field $E$ for breakdown at a given pressure $p$ and geometry is obtained by solving for $E$ in \n$$\n\\alpha(p, E) L_{\\mathrm{eff}} = \\ln\\!\\left(1 + \\frac{1}{\\gamma}\\right),\n$$\nwith $\\alpha(p,E) = A p \\exp\\!\\left(- \\frac{B p}{E} \\right)$. From this equality, the minimum electric field magnitude required to just satisfy breakdown is\n$$\nE_{\\mathrm{req}}(p) = - \\frac{B p}{\\ln\\!\\left( \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}} \\right)},\n$$\nwhich is real and positive only when $0 < \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}} < 1$, i.e., when $A p L_{\\mathrm{eff}} > \\ln(1 + 1/\\gamma)$. The corresponding required loop voltage is $V_{\\mathrm{req}}(p) = 2 \\pi R E_{\\mathrm{req}}(p)$. Therefore, for a given device and gas constants, the optimization problem is to find the pressure $p$ in a bounded interval that minimizes $V_{\\mathrm{req}}(p)$, subject to the feasibility constraint $A p L_{\\mathrm{eff}} > \\ln(1 + 1/\\gamma)$.\n\nYour program must implement the following logic:\n1. For each test case, compute the function $V_{\\mathrm{req}}(p)$ over a bounded interval $[p_{\\min}, p_{\\max}]$ where $p$ is expressed in Pascal.\n2. Enforce the breakdown feasibility constraint $A p L_{\\mathrm{eff}} > \\ln(1 + 1/\\gamma)$. If no $p$ in the interval satisfies feasibility, the result for that test case must be $-1.0$.\n3. Otherwise, numerically minimize $V_{\\mathrm{req}}(p)$ over the feasible subset of the interval. The returned value must be the pressure $p_{\\star}$ (in Pascal) that minimizes the required loop voltage, rounded to three decimal places.\n\nPhysical unit requirements:\n- All pressures must be expressed in Pascal (Pa).\n- All lengths must be expressed in meters (m).\n- All voltages must be expressed in Volts (V).\n- The output for each test case is the optimal pressure in Pascal (Pa), rounded to three decimal places.\n- There are no angles in this problem.\n\nTest suite:\nUse the following test cases, each provided as a tuple of parameters $(R, L_{\\mathrm{eff}}, A, B, \\gamma, T_{\\mathrm{n}}, p_{\\min}, p_{\\max})$:\n- Test Case $1$ (general case): $(R = 1.5$ m, $L_{\\mathrm{eff}} = 250$ m, $A = 0.05$ m$^{-1}$ Pa$^{-1}$, $B = 3$ V m$^{-1}$ Pa$^{-1}$, $\\gamma = 0.02, T_{\\mathrm{n}} = 300$ K, $p_{\\min} = 0.01$ Pa, $p_{\\max} = 10$ Pa).\n- Test Case $2$ (infeasible breakdown within bounds): $(R = 1.5$ m, $L_{\\mathrm{eff}} = 10$ m, $A = 0.02$ m$^{-1}$ Pa$^{-1}$, $B = 3$ V m$^{-1}$ Pa$^{-1}$, $\\gamma = 0.02, T_{\\mathrm{n}} = 300$ K, $p_{\\min} = 0.01$ Pa, $p_{\\max} = 0.5$ Pa).\n- Test Case $3$ (higher secondary emission, longer connection length): $(R = 1.5$ m, $L_{\\mathrm{eff}} = 300$ m, $A = 0.05$ m$^{-1}$ Pa$^{-1}$, $B = 3$ V m$^{-1}$ Pa$^{-1}$, $\\gamma = 0.05, T_{\\mathrm{n}} = 300$ K, $p_{\\min} = 0.01$ Pa, $p_{\\max} = 10$ Pa).\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the optimal pressures (in Pascal), rounded to three decimal places, in the same order as the test suite. For infeasible cases, include $-1.0$ in the list for that test case. For example, an output could look like $[0.856,-1.0,0.552]$.",
            "solution": "The problem has been validated and is deemed sound. It presents a well-posed optimization problem grounded in established, albeit simplified, principles of plasma physics, specifically the Townsend model for gas breakdown in a tokamak. All provided parameters and equations are self-consistent and sufficient to formulate a solvable problem. The presence of the neutral temperature $T_{\\mathrm{n}}$ as an input parameter, while not being used in the final derived equations for the required loop voltage $V_{\\mathrm{req}}(p)$, is an extraneous detail that does not invalidate the core logic of the problem as stated. The task is to implement the specified model, and for this, all necessary information is present. We may therefore proceed with the solution.\n\nThe problem requires us to find the neutral gas pressure $p$ that minimizes the loop voltage $V_{\\mathrm{req}}$ necessary to initiate plasma breakdown. The model provided relates the loop voltage to the pressure through a series of physical relationships.\n\nFirst, the loop voltage $V_{\\mathrm{loop}}$ generates a toroidal electric field $E$, given by\n$$E = \\frac{V_{\\mathrm{loop}}}{2 \\pi R}$$\nwhere $R$ is the major radius of the tokamak.\n\nSecond, the growth of an electron avalanche is described by the first Townsend ionization coefficient, $\\alpha$, with the empirical form:\n$$\\frac{\\alpha}{p} = A \\exp\\left(-\\frac{B p}{E}\\right)$$\nHere, $A$ and $B$ are constants specific to the gas, and $p$ is the neutral pressure. This equation can be written as $\\alpha(p, E) = A p \\exp\\left(-\\frac{B p}{E}\\right)$.\n\nThird, the condition for breakdown to occur is that the electron multiplication over an effective connection length, $L_{\\mathrm{eff}}$, must be sufficient to be self-sustaining, considering electron losses to the wall and secondary electron emission from the wall, characterized by the coefficient $\\gamma$. This condition is given by:\n$$\\alpha L_{\\mathrm{eff}} = \\ln\\left(1 + \\frac{1}{\\gamma}\\right)$$\n\nBy substituting the expression for $\\alpha(p, E)$ into the breakdown condition, we can solve for the required electric field $E_{\\mathrm{req}}$ at a given pressure $p$:\n$$A p \\exp\\left(-\\frac{B p}{E_{\\mathrm{req}}}\\right) L_{\\mathrm{eff}} = \\ln\\left(1 + \\frac{1}{\\gamma}\\right)$$\n$$\\exp\\left(-\\frac{B p}{E_{\\mathrm{req}}}\\right) = \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}}$$\nTaking the natural logarithm of both sides and rearranging for $E_{\\mathrm{req}}$ yields the expression provided in the problem statement:\n$$E_{\\mathrm{req}}(p) = - \\frac{B p}{\\ln\\left( \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}} \\right)}$$\n\nFor $E_{\\mathrm{req}}(p)$ to be a real, positive physical quantity, the argument of the logarithm in the denominator, let's call it $x = \\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}}$, must satisfy $0 < x < 1$. The part $x>0$ is always satisfied for valid physical parameters ($A>0$, $L_{\\mathrm{eff}}>0$, $\\gamma>0$). The constraint $x < 1$ leads to the feasibility condition for breakdown:\n$$\\frac{\\ln(1 + 1/\\gamma)}{A p L_{\\mathrm{eff}}} < 1 \\implies p > \\frac{\\ln(1 + 1/\\gamma)}{A L_{\\mathrm{eff}}}$$\nLet us define the minimum pressure for feasibility as $p_{\\mathrm{feas\\_min}} = \\frac{\\ln(1 + 1/\\gamma)}{A L_{\\mathrm{eff}}}$. Any pressure $p \\le p_{\\mathrm{feas\\_min}}$ cannot lead to breakdown, as the required electric field would be infinite or non-physical.\n\nThe required loop voltage is $V_{\\mathrm{req}}(p) = 2 \\pi R E_{\\mathrm{req}}(p)$. Our objective is to find the pressure $p_{\\star}$ that minimizes this function, subject to two constraints:\n1. The pressure must be within the specified search interval: $p \\in [p_{\\min}, p_{\\max}]$.\n2. The pressure must satisfy the physical feasibility condition: $p > p_{\\mathrm{feas\\_min}}$.\n\nCombining these, the search for the optimal pressure $p_{\\star}$ must be conducted over the feasible set of pressures, which is the interval $(\\max(p_{\\min}, p_{\\mathrm{feas\\_min}}), p_{\\max}]$.\n\nThe task is to \"numerically minimize\" $V_{\\mathrm{req}}(p)$ over this feasible set. For this purpose, we will use a numerical optimization algorithm. The `scipy.optimize.minimize_scalar` function is an appropriate tool for this one-dimensional optimization problem. We will use its `bounded` method, which is designed for optimization over a closed interval.\n\nThe algorithm for each test case is as follows:\n1.  Given the parameters $(R, L_{\\mathrm{eff}}, A, B, \\gamma, T_{\\mathrm{n}}, p_{\\min}, p_{\\max})$, first compute the minimum feasible pressure, $p_{\\mathrm{feas\\_min}} = \\ln(1 + 1/\\gamma) / (A L_{\\mathrm{eff}})$.\n2.  Determine the search interval for the optimization. The lower bound of the search is $p_{\\mathrm{lower}} = \\max(p_{\\min}, p_{\\mathrm{feas\\_min}})$. The upper bound is $p_{\\mathrm{upper}} = p_{\\max}$.\n3.  Check if the feasible set is empty. This occurs if $p_{\\mathrm{lower}} \\ge p_{\\mathrm{upper}}$. If so, no solution exists in the given range, and the result is defined as $-1.0$.\n4.  If the feasible set is non-empty, we define the objective function $f(p) = V_{\\mathrm{req}}(p)$. We must be careful as $V_{\\mathrm{req}}(p)$ is undefined for $p \\le p_{\\mathrm{feas\\_min}}$.\n5.  We then call `scipy.optimize.minimize_scalar` with the objective function $f(p)$ and the bounds $[p_{\\mathrm{lower}}, p_{\\mathrm{upper}}]$. The optimizer will find the pressure $p_{\\star}$ within this interval that minimizes the function. The optimizer is expected to be robust to the function approaching infinity at the lower boundary if $p_{\\mathrm{lower}} = p_{\\mathrm{feas\\_min}}$.\n6.  The optimal pressure $p_{\\star}$ found by the optimizer is rounded to three decimal places as required.\n\nThis methodology provides a robust and direct implementation of the problem's requirements, correctly handling the physical constraints and delivering the specified output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Computes the optimal prefill neutral gas pressure for plasma breakdown in a tokamak\n    by numerically minimizing the required loop voltage.\n    \"\"\"\n\n    # Test suite: (R, Leff, A, B, gamma, Tn, p_min, p_max)\n    # Units: R(m), Leff(m), A(m^-1 Pa^-1), B(V m^-1 Pa^-1), gamma(dimensionless),\n    #        Tn(K), p_min(Pa), p_max(Pa)\n    test_cases = [\n        # Test Case 1 (general case)\n        (1.5, 250, 0.05, 3, 0.02, 300, 0.01, 10),\n        # Test Case 2 (infeasible breakdown within bounds)\n        (1.5, 10, 0.02, 3, 0.02, 300, 0.01, 0.5),\n        # Test Case 3 (higher secondary emission, longer connection length)\n        (1.5, 300, 0.05, 3, 0.05, 300, 0.01, 10),\n    ]\n\n    results = []\n    \n    # A small constant to slightly shift the lower bound away from the singularity\n    # if it coincides with the physical feasibility limit.\n    # The bounded optimizer should handle infinities, but this adds robustness.\n    epsilon = 1e-12\n\n    for case in test_cases:\n        R, L_eff, A, B, gamma, T_n, p_min, p_max = case\n\n        # The term ln(1 + 1/gamma) appears frequently\n        try:\n            c_gamma = np.log(1 + 1/gamma)\n        except (ValueError, ZeroDivisionError):\n            # Handles cases like gamma <= 0 or gamma -> infinity\n            results.append(-1.0)\n            continue\n        \n        # Calculate the minimum pressure required for breakdown feasibility\n        if A <= 0 or L_eff <= 0:\n            results.append(-1.0)\n            continue\n        p_feas_min = c_gamma / (A * L_eff)\n\n        # Determine the effective search interval [p_lower, p_upper]\n        p_lower = max(p_min, p_feas_min)\n        p_upper = p_max\n\n        # Check if a feasible pressure range exists\n        if p_lower >= p_upper:\n            results.append(-1.0)\n            continue\n\n        # Define the objective function to minimize: V_req(p)\n        # We can minimize E_req(p) as V_req is proportional to it.\n        def objective_function(p, B_val, A_val, L_eff_val, c_gamma_val):\n            # This function calculates E_req(p)\n            arg = c_gamma_val / (A_val * p * L_eff_val)\n            # The condition p > p_feas_min ensures arg < 1.\n            # Due to floating point arithmetic, shield against arg >= 1\n            if arg >= 1.0:\n                return np.inf  # Return infinity for non-physical region\n            \n            log_arg = np.log(arg)\n            if log_arg == 0:\n                return np.inf # Singularity at the boundary\n                \n            return -B_val * p / log_arg\n\n        # The bounded search interval needs to be strictly within the feasible domain.\n        # If p_lower is at the singularity, we add a small epsilon.\n        opt_bounds = (p_lower + epsilon if p_lower == p_feas_min else p_lower, p_upper)\n        \n        # Numerically find the pressure that minimizes the function\n        res = minimize_scalar(\n            objective_function,\n            bounds=opt_bounds,\n            args=(B, A, L_eff, c_gamma),\n            method='bounded'\n        )\n\n        optimal_pressure = res.x\n        results.append(round(optimal_pressure, 3))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Generating the necessary toroidal electric field for breakdown is not as simple as just ramping the central solenoid current. The metallic vacuum vessel, a necessary component of the tokamak, acts as a secondary circuit that inductively opposes the change in magnetic flux. This practice delves into this critical engineering challenge, using a lumped-parameter circuit model to quantify the effect of these induced \"eddy currents\" on the available loop voltage . Solving this problem will highlight how the conductive structures of the machine itself must be carefully designed and accounted for to ensure a successful plasma start.",
            "id": "3714794",
            "problem": "A cylindrical tokamak is modeled during the prefill and breakdown phase as an axisymmetric system with a Central Solenoid (CS) supplying a prescribed current ramp and a conducting vacuum vessel that supports toroidal eddy currents. The major radius of interest for loop voltage evaluation is $R = 3.000 \\, \\text{m}$. Assume the following linear, lumped-parameter coupling model for poloidal flux linkages:\n- The poloidal magnetic flux linking the plasma contour is $\\psi_{p} = M_{cp}\\,i_{c} + M_{vp}\\,i_{v}$, where $i_{c}$ is the CS current and $i_{v}$ is the toroidal eddy current in the vessel. The constants $M_{cp}$ and $M_{vp}$ are mutual inductances treated as given geometric coefficients.\n- The vacuum vessel is approximated as a single-turn conducting torus with self-inductance $L_{v}$ and resistance $R_{v}$, and its toroidal eddy current $i_{v}$ obeys the circuit law $L_{v}\\,\\frac{d i_{v}}{d t} + R_{v}\\,i_{v} = -M_{cv}\\,\\frac{d i_{c}}{d t}$, where $M_{cv}$ is the mutual inductance between the CS and the vessel loop.\n\nLet the CS current ramp be initiated at $t=0$ such that $\\frac{d i_{c}}{d t} = \\dot{I}_{c}$ is a constant for $t \\ge 0$, and suppose the initial eddy current is zero, $i_{v}(0) = 0$. The loop voltage around the plasma contour is $V_{\\text{loop}} = -\\frac{d \\psi_{p}}{d t}$ by Faraday’s law, and the toroidal electric field magnitude at radius $R$ is $E_{\\varphi} = \\frac{|V_{\\text{loop}}|}{2\\pi R}$ under axisymmetry.\n\nUsing only Maxwell–Faraday law and the given linear circuit relations, derive the expression for the initial toroidal electric field magnitude $E_{\\varphi}(0^{+})$ immediately after the ramp begins, and then evaluate it numerically for\n$M_{cp} = 4.0 \\times 10^{-5} \\, \\text{H}$, $M_{vp} = 3.0 \\times 10^{-5} \\, \\text{H}$, $M_{cv} = 5.0 \\times 10^{-5} \\, \\text{H}$, $L_{v} = 5.0 \\times 10^{-3} \\, \\text{H}$, $R_{v} = 7.50 \\times 10^{-4} \\, \\Omega$, and $\\dot{I}_{c} = 5.00 \\times 10^{5} \\, \\text{A/s}$.\n\nRound your final numerical answer for $E_{\\varphi}(0^{+})$ to four significant figures and express it in $\\text{V/m}$. The final answer must be a single real-valued number.",
            "solution": "The problem as stated is formally analyzed for validity.\n\n### Step 1: Extract Givens\n- Major radius of interest: $R = 3.000$ m.\n- Poloidal magnetic flux linking the plasma contour: $\\psi_{p} = M_{cp}\\,i_{c} + M_{vp}\\,i_{v}$.\n- Vacuum vessel circuit law: $L_{v}\\,\\frac{d i_{v}}{d t} + R_{v}\\,i_{v} = -M_{cv}\\,\\frac{d i_{c}}{d t}$.\n- Central Solenoid (CS) current ramp for $t \\ge 0$: $\\frac{d i_{c}}{d t} = \\dot{I}_{c} = \\text{constant}$.\n- Initial condition for eddy current: $i_{v}(0) = 0$.\n- Loop voltage definition: $V_{\\text{loop}} = -\\frac{d \\psi_{p}}{d t}$.\n- Toroidal electric field definition: $E_{\\varphi} = \\frac{|V_{\\text{loop}}|}{2\\pi R}$.\n- Numerical constants:\n  - $M_{cp} = 4.0 \\times 10^{-5} \\, \\text{H}$\n  - $M_{vp} = 3.0 \\times 10^{-5} \\, \\text{H}$\n  - $M_{cv} = 5.0 \\times 10^{-5} \\, \\text{H}$\n  - $L_{v} = 5.0 \\times 10^{-3} \\, \\text{H}$\n  - $R_{v} = 7.50 \\times 10^{-4} \\, \\Omega$\n  - $\\dot{I}_{c} = 5.00 \\times 10^{5} \\, \\text{A/s}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing a standard and well-established lumped-parameter circuit model for inductive breakdown in a tokamak, which is derived from Maxwell's equations. It is well-posed, providing a complete set of linear differential equations, initial conditions, and constant parameters, ensuring a unique solution exists. The language is objective and precise. The problem does not violate any of the invalidity criteria. It is a formalizable physics problem that is directly relevant to the topic of plasma startup in nuclear fusion. The provided parameters are within a realistic range for such a device.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe objective is to determine the initial toroidal electric field magnitude, $E_{\\varphi}(0^{+})$, immediately after the CS current ramp begins at $t=0$.\n\nThe toroidal electric field $E_{\\varphi}$ is related to the loop voltage $V_{\\text{loop}}$ by the given expression:\n$$E_{\\varphi}(t) = \\frac{|V_{\\text{loop}}(t)|}{2\\pi R}$$\nThe loop voltage is defined by Faraday's law of induction applied to the plasma contour:\n$$V_{\\text{loop}}(t) = -\\frac{d\\psi_p}{dt}$$\nThe poloidal magnetic flux $\\psi_p$ linking the plasma contour is given as a linear combination of fluxes from the CS current $i_c$ and the vessel eddy current $i_v$:\n$$\\psi_p(t) = M_{cp}\\,i_c(t) + M_{vp}\\,i_v(t)$$\nTo find the loop voltage, we must differentiate $\\psi_p$ with respect to time:\n$$\\frac{d\\psi_p}{dt} = M_{cp}\\frac{di_c}{dt} + M_{vp}\\frac{di_v}{dt}$$\nThus, the loop voltage is:\n$$V_{\\text{loop}}(t) = -\\left( M_{cp}\\frac{di_c}{dt} + M_{vp}\\frac{di_v}{dt} \\right)$$\nWe are interested in the value of these quantities at $t=0^{+}$. We are given that for $t \\ge 0$, the CS current ramp is constant:\n$$\\frac{di_c}{dt} = \\dot{I}_{c}$$\nTherefore, $\\frac{di_c}{dt}\\big|_{t=0^+} = \\dot{I}_c$.\n\nTo find $V_{\\text{loop}}(0^{+})$, we must first determine the rate of change of the vessel current, $\\frac{di_v}{dt}$, at $t=0^{+}$. This is found by analyzing the circuit equation for the vacuum vessel:\n$$L_{v}\\frac{di_v}{dt} + R_{v}\\,i_v = -M_{cv}\\frac{di_c}{dt}$$\nWe evaluate this equation at the instant $t=0^{+}$:\n$$L_{v}\\frac{di_v}{dt}\\bigg|_{t=0^+} + R_{v}\\,i_v(0^+) = -M_{cv}\\frac{di_c}{dt}\\bigg|_{t=0^+}$$\nThe problem states the initial condition $i_v(0) = 0$. The current through an inductor ($L_v$) must be a continuous function of time, as a discontinuous jump would imply an infinite voltage, which is physically impossible. Therefore, $i_v(0^+) = i_v(0) = 0$. Substituting this and the constant CS current ramp into the vessel equation gives:\n$$L_{v}\\frac{di_v}{dt}\\bigg|_{t=0^+} + R_{v}(0) = -M_{cv}\\dot{I}_c$$\n$$L_{v}\\frac{di_v}{dt}\\bigg|_{t=0^+} = -M_{cv}\\dot{I}_c$$\nSolving for the initial rate of change of the vessel current:\n$$\\frac{di_v}{dt}\\bigg|_{t=0^+} = -\\frac{M_{cv}}{L_v}\\dot{I}_c$$\nThis result shows that at the very beginning of the ramp, the vessel's resistance $R_v$ is irrelevant; the induced EMF is balanced entirely by the inductive response of the vessel.\n\nNow we can calculate the loop voltage at $t=0^{+}$ by substituting the derivatives into its expression:\n$$V_{\\text{loop}}(0^{+}) = -\\left( M_{cp}\\frac{di_c}{dt}\\bigg|_{t=0^+} + M_{vp}\\frac{di_v}{dt}\\bigg|_{t=0^+} \\right)$$\n$$V_{\\text{loop}}(0^{+}) = -\\left( M_{cp}\\dot{I}_c + M_{vp}\\left(-\\frac{M_{cv}}{L_v}\\dot{I}_c\\right) \\right)$$\nFactoring out $\\dot{I}_c$:\n$$V_{\\text{loop}}(0^{+}) = -\\dot{I}_c \\left( M_{cp} - \\frac{M_{vp}M_{cv}}{L_v} \\right)$$\n$$V_{\\text{loop}}(0^{+}) = \\dot{I}_c \\left( \\frac{M_{vp}M_{cv}}{L_v} - M_{cp} \\right)$$\nFinally, the initial toroidal electric field magnitude is given by:\n$$E_{\\varphi}(0^+) = \\frac{|V_{\\text{loop}}(0^+)|}{2\\pi R} = \\frac{1}{2\\pi R} \\left| \\dot{I}_c \\left( \\frac{M_{vp}M_{cv}}{L_v} - M_{cp} \\right) \\right|$$\nSince $\\dot{I}_c$ is a positive constant, this simplifies to:\n$$E_{\\varphi}(0^+) = \\frac{\\dot{I}_c}{2\\pi R} \\left| \\frac{M_{vp}M_{cv}}{L_v} - M_{cp} \\right|$$\nThis is the final symbolic expression. Now, we substitute the given numerical values:\n$M_{cp} = 4.0 \\times 10^{-5} \\, \\text{H}$\n$M_{vp} = 3.0 \\times 10^{-5} \\, \\text{H}$\n$M_{cv} = 5.0 \\times 10^{-5} \\, \\text{H}$\n$L_{v} = 5.0 \\times 10^{-3} \\, \\text{H}$\n$R = 3.000 \\, \\text{m}$\n$\\dot{I}_{c} = 5.00 \\times 10^{5} \\, \\text{A/s}$\n\nFirst, we evaluate the term inside the absolute value:\n$$\\frac{M_{vp}M_{cv}}{L_v} - M_{cp} = \\frac{(3.0 \\times 10^{-5})(5.0 \\times 10^{-5})}{5.0 \\times 10^{-3}} - (4.0 \\times 10^{-5})$$\n$$\\frac{M_{vp}M_{cv}}{L_v} = \\frac{15.0 \\times 10^{-10}}{5.0 \\times 10^{-3}} = 3.0 \\times 10^{-7} \\, \\text{H}$$\n$$\\frac{M_{vp}M_{cv}}{L_v} - M_{cp} = (3.0 \\times 10^{-7}) - (4.0 \\times 10^{-5}) = (0.03 \\times 10^{-5}) - (4.0 \\times 10^{-5}) = -3.97 \\times 10^{-5} \\, \\text{H}$$\nNow we compute the electric field:\n$$E_{\\varphi}(0^+) = \\frac{5.00 \\times 10^5}{2\\pi (3.000)} \\left| -3.97 \\times 10^{-5} \\right|$$\n$$E_{\\varphi}(0^+) = \\frac{5.00 \\times 10^5 \\times 3.97 \\times 10^{-5}}{6.000 \\pi}$$\n$$E_{\\varphi}(0^+) = \\frac{5.00 \\times 3.97}{6.000 \\pi} = \\frac{19.85}{6.000 \\pi}$$\n$$E_{\\varphi}(0^+) \\approx \\frac{19.85}{18.8495559...} \\approx 1.053075 \\, \\text{V/m}$$\nRounding the result to four significant figures as requested:\n$$E_{\\varphi}(0^+) \\approx 1.053 \\, \\text{V/m}$$",
            "answer": "$$\\boxed{1.053}$$"
        },
        {
            "introduction": "Moving beyond static conditions and simplified circuits, this final practice invites you to build a dynamic simulation of the plasma breakdown process from the ground up. You will implement a zero-dimensional (0D) model, developing coupled rate equations for electron density and energy that account for Ohmic heating, collisional processes, ionization, and losses. By numerically solving these equations, you will trace the explosive growth of the electron population—the Townsend avalanche—in real-time, providing a comprehensive view of how a tenuous neutral gas transforms into a hot plasma .",
            "id": "3714780",
            "problem": "Consider the initial plasma startup and breakdown in a tokamak (a toroidal magnetic confinement device for nuclear fusion), modeled as a Zero-Dimensional (0D) system in which the electron population is treated as spatially uniform. Starting from fundamental laws and well-tested formulas, derive a set of coupled rate equations for the electron number density and electron energy, and then implement a numerical simulation to determine the breakdown time. The breakdown time is defined as the first time at which the electron number density reaches or exceeds a specified threshold. The final output of your program must be a single line containing a comma-separated list enclosed in square brackets, where each element is the breakdown time in seconds for a corresponding test case, or the value $-1.0$ if breakdown does not occur within the specified simulation time window.\n\nYou must begin from the following bases:\n- Particle continuity for electrons: the time rate of change of electron number density equals sources minus sinks, $dn_e/dt = S - L$.\n- Electron energy balance: the time rate of change of electron energy density equals power input minus power losses, $dW/dt = P_{\\mathrm{in}} - P_{\\mathrm{loss}}$, where $W$ is the electron energy density.\n- Ideal Gas Law for neutrals: $p = n_n k_B T_g$, where $p$ is neutral gas pressure, $n_n$ is neutral number density, $k_B$ is the Boltzmann constant, and $T_g$ is the neutral gas temperature.\n- Generalized conductivity from the Drude model: $\\sigma = \\dfrac{e^2 n_e}{m_e \\nu_e}$, where $e$ is the elementary charge, $m_e$ is the electron mass, and $\\nu_e$ is the effective electron collision frequency.\n- Electron-neutral collision frequency: $\\nu_{en} = n_n \\sigma_{en} v_{th}$, with thermal speed $v_{th} = \\sqrt{\\dfrac{8 e T_e}{\\pi m_e}}$ when electron temperature $T_e$ is in electron-volts.\n- Electron-ion (Coulomb) collision frequency approximation: $\\nu_{ei} = C_{ei} n_e \\ln\\Lambda \\, T_e^{-3/2}$, where $C_{ei}$ is a known numerical coefficient and $\\ln\\Lambda$ is the Coulomb logarithm.\n- Ohmic heating power density: $p_{\\mathrm{ohm}} = \\sigma E^2$ for electric field magnitude $E$.\n- Ionization source modeled by an electron impact rate coefficient $k_{\\mathrm{ion}}(T_e)$ such that $S_{\\mathrm{ion}} = n_e n_n k_{\\mathrm{ion}}(T_e)$.\n- Radiative recombination loss modeled by $\\alpha_r(T_e)$ such that $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e^2$.\n- Particle loss modeled as a first-order linear term $L_{\\mathrm{wall}} = n_e/\\tau_p$, with $\\tau_p$ the particle confinement time.\n- Energy loss channels include ionization energy sink and an energy confinement term $W/\\tau_E$, with $\\tau_E$ taken equal to $\\tau_p$ during startup for simplicity.\n- Quasineutrality holds for the electron-ion recombination term during the relevant timescale.\n\nYou must derive closed equations for $n_e(t)$ and the electron energy density $W(t)$. Define $T_e(t)$ at any time by the relation between thermal energy and density, $W(t) = \\dfrac{3}{2} n_e(t) e T_e(t)$, with $T_e$ in electron-volts and $e$ as the conversion factor from electron-volts to joules. Use $T_e(t) = \\max\\{T_{\\mathrm{floor}}, \\dfrac{2 W(t)}{3 e n_e(t)}\\}$ to ensure numerical robustness, where $T_{\\mathrm{floor}}$ is a small positive floor.\n\nConstitutive models and constants to use in your derivation and simulation:\n- Elementary charge $e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$, electron mass $m_e = 9.10938356 \\times 10^{-31} \\, \\mathrm{kg}$, Boltzmann constant $k_B = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$.\n- Neutral gas temperature $T_g = 300\\,\\mathrm{K}$.\n- Electron-neutral momentum-transfer cross section $\\sigma_{en} = 2.0 \\times 10^{-19} \\, \\mathrm{m^2}$.\n- Coulomb collision coefficient $C_{ei} = 2.91 \\times 10^{-6} \\, \\mathrm{m^3\\,s^{-1}\\,eV^{3/2}}$ and Coulomb logarithm $\\ln\\Lambda = 12$.\n- Ionization energy per electron-ion pair $U_{\\mathrm{ion}} = 15.4 \\, \\mathrm{eV}$.\n- Electron impact ionization rate coefficient model $k_{\\mathrm{ion}}(T_e) = C_{\\mathrm{ion}} \\sqrt{T_e}\\, \\exp\\!\\left(-\\dfrac{U_{\\mathrm{ion}}}{T_e}\\right)$ with $C_{\\mathrm{ion}} = 1.0 \\times 10^{-17} \\, \\mathrm{m^3\\,s^{-1}\\,eV^{-1/2}}$.\n- Radiative recombination coefficient $\\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}$ with $\\alpha_0 = 1.0 \\times 10^{-19} \\, \\mathrm{m^3/s}$.\n- Energy confinement time $\\tau_E = \\tau_p$.\n- Electron temperature floor $T_{\\mathrm{floor}} = 0.1 \\, \\mathrm{eV}$.\n- Initial electron number density $n_e(0) = n_{e0} = 1.0 \\times 10^{12} \\, \\mathrm{m^{-3}}$.\n- Initial electron temperature $T_e(0) = T_{e0} = 2.0 \\, \\mathrm{eV}$, hence $W(0) = \\dfrac{3}{2} n_{e0} e T_{e0}$.\n- Breakdown threshold $n_* = 1.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$; the breakdown time is the earliest $t$ such that $n_e(t) \\ge n_*$.\n- For numerical integration, use a stiff-capable ordinary differential equation solver and stop at an event when $n_e(t)$ crosses $n_*$ from below; otherwise, stop at the maximum simulation time.\n\nYou must implement the numerical simulation by solving the coupled ordinary differential equations for $n_e(t)$ and $W(t)$ based on your derivation, using the following test suite. Each test case is a tuple $(E, p, \\tau_p, t_{\\max})$, where $E$ is the electric field magnitude in $\\mathrm{V/m}$, $p$ is the neutral gas pressure in $\\mathrm{Pa}$, $\\tau_p$ is the particle confinement time in $\\mathrm{s}$, and $t_{\\max}$ is the maximum simulation time in $\\mathrm{s}$. For each test case, output the breakdown time in seconds (as a float) rounded by the default floating-point representation, or output $-1.0$ if $n_e(t) < n_*$ for all $t \\in [0, t_{\\max}]$.\n\nUse the following test suite:\n- Test case $1$: $(E, p, \\tau_p, t_{\\max}) = (20.0, 0.05, 0.005, 0.05)$.\n- Test case $2$: $(E, p, \\tau_p, t_{\\max}) = (8.0, 0.05, 0.005, 0.05)$.\n- Test case $3$: $(E, p, \\tau_p, t_{\\max}) = (30.0, 0.05, 0.005, 0.05)$.\n- Test case $4$: $(E, p, \\tau_p, t_{\\max}) = (20.0, 0.01, 0.005, 0.05)$.\n- Test case $5$: $(E, p, \\tau_p, t_{\\max}) = (20.0, 0.10, 0.005, 0.05)$.\n- Test case $6$: $(E, p, \\tau_p, t_{\\max}) = (20.0, 0.05, 0.002, 0.05)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for all six test cases as a comma-separated list enclosed in square brackets, for example, $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5,\\mathrm{result}_6\\right]$, with each $\\mathrm{result}_i$ a float in seconds or the float $-1.0$ if breakdown does not occur.\n\nAll physical units must be handled consistently, and all numerical answers must be expressed in seconds. Angles are not used. Percentages must not be used anywhere in the output; any fractional quantities must be expressed in decimal form.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\nThe problem provides the following data, definitions, and models for a Zero-Dimensional (0D) tokamak plasma breakdown simulation:\n\n**Fundamental Equations:**\n- Electron continuity: $\\dfrac{dn_e}{dt} = S - L$\n- Electron energy balance: $\\dfrac{dW}{dt} = P_{\\mathrm{in}} - P_{\\mathrm{loss}}$\n- Ideal Gas Law for neutrals: $p = n_n k_B T_g$\n- Electron energy density to temperature relation: $W(t) = \\dfrac{3}{2} n_e(t) e T_e(t)$, with $T_e$ in electron-volts (eV).\n- Numerical floor for temperature: $T_e(t) = \\max\\{T_{\\mathrm{floor}}, \\dfrac{2 W(t)}{3 e n_e(t)}\\}$\n\n**Constitutive Models and Coefficients:**\n- Drude conductivity: $\\sigma = \\dfrac{e^2 n_e}{m_e \\nu_e}$\n- Electron-neutral collision frequency: $\\nu_{en} = n_n \\sigma_{en} v_{th}$\n- Electron thermal speed: $v_{th} = \\sqrt{\\dfrac{8 e T_e}{\\pi m_e}}$ (for $T_e$ in eV)\n- Electron-ion collision frequency: $\\nu_{ei} = C_{ei} n_e \\ln\\Lambda \\, T_e^{-3/2}$\n- Effective collision frequency: $\\nu_e = \\nu_{en} + \\nu_{ei}$\n- Ohmic heating power density: $p_{\\mathrm{ohm}} = \\sigma E^2$\n- Ionization source: $S_{\\mathrm{ion}} = n_e n_n k_{\\mathrm{ion}}(T_e)$\n- Ionization rate coefficient: $k_{\\mathrm{ion}}(T_e) = C_{\\mathrm{ion}} \\sqrt{T_e}\\, \\exp\\!\\left(-\\dfrac{U_{\\mathrm{ion}}}{T_e}\\right)$\n- Radiative recombination loss: $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e^2$\n- Recombination coefficient: $\\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}$\n- Particle wall loss: $L_{\\mathrm{wall}} = n_e/\\tau_p$\n- Energy loss from ionization: Proportional to ionization rate $S_{\\mathrm{ion}}$ and ionization energy $U_{\\mathrm{ion}}$.\n- Energy loss from confinement: $W/\\tau_E$\n- Confinement time assumption: $\\tau_E = \\tau_p$\n- Quasineutrality: Assumed for the recombination term ($n_i \\approx n_e$).\n\n**Constants and Fixed Parameters:**\n- Elementary charge: $e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$\n- Electron mass: $m_e = 9.10938356 \\times 10^{-31} \\, \\mathrm{kg}$\n- Boltzmann constant: $k_B = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$\n- Neutral gas temperature: $T_g = 300 \\, \\mathrm{K}$\n- Electron-neutral cross section: $\\sigma_{en} = 2.0 \\times 10^{-19} \\, \\mathrm{m^2}$\n- Coulomb collision coefficient: $C_{ei} = 2.91 \\times 10^{-6} \\, \\mathrm{m^3\\,s^{-1}\\,eV^{3/2}}$\n- Coulomb logarithm: $\\ln\\Lambda = 12$\n- Ionization energy: $U_{\\mathrm{ion}} = 15.4 \\, \\mathrm{eV}$\n- Ionization coefficient constant: $C_{\\mathrm{ion}} = 1.0 \\times 10^{-17} \\, \\mathrm{m^3\\,s^{-1}\\,eV^{-1/2}}$\n- Recombination coefficient constant: $\\alpha_0 = 1.0 \\times 10^{-19} \\, \\mathrm{m^3/s}$\n- Temperature floor: $T_{\\mathrm{floor}} = 0.1 \\, \\mathrm{eV}$\n\n**Initial and Boundary Conditions:**\n- Initial electron density: $n_e(0) = n_{e0} = 1.0 \\times 10^{12} \\, \\mathrm{m^{-3}}$\n- Initial electron temperature: $T_e(0) = T_{e0} = 2.0 \\, \\mathrm{eV}$\n- Initial energy density: $W(0) = \\dfrac{3}{2} n_{e0} e T_{e0}$\n- Breakdown threshold: $n_* = 1.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$\n- Definition of breakdown time: The first time $t$ such that $n_e(t) \\ge n_*$.\n\n**Test Cases:**\nA suite of six test cases, each defined by a tuple $(E, p, \\tau_p, t_{\\max})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: Yes. The problem is based on a standard, albeit simplified, 0D model of plasma dynamics. The equations for particle continuity, energy balance, Ohmic heating, collision frequencies, and atomic processes (ionization, recombination) are rooted in established plasma physics principles (e.g., Drude model, Spitzer collision theory, rate equations).\n- **Well-Posed**: Yes. The problem asks for the derivation and numerical solution of a system of coupled first-order ordinary differential equations (ODEs) with well-defined initial conditions. This structure generally admits a unique and stable solution for a given time interval. The objective is clear: find the time to reach a specific density threshold.\n- **Objective**: Yes. The problem is stated in precise, quantitative terms. All constants, formulas, and parameters are explicitly given. There are no subjective or opinion-based statements.\n- **Consistency and Completeness**: The problem provides a self-contained set of equations, constants, and initial conditions.\n    - An apparent ambiguity in the units of $\\alpha_0$ arises from the formula $\\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}$. For $\\alpha_r$ to have the standard units of a rate coefficient ($\\mathrm{m^3/s}$), the units of $\\alpha_0$ must implicitly be $\\mathrm{m^3 s^{-1} eV^{0.7}}$. This is a common notational shortcut in physics literature and is interpreted as such, not as a contradiction.\n    - All other formulas and constants are dimensionally consistent and physically plausible for the context of tokamak startup.\n- **Feasibility**: The specified conditions and parameters are realistic for experimental scenarios in fusion research. The numerical task is solvable using standard stiff ODE solvers, as recommended.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-defined, scientifically sound problem in computational plasma physics. The requested derivation and simulation are appropriate and feasible.\n\n## Derivation of the 0D Model\nThe goal is to derive a closed system of coupled ordinary differential equations for the electron number density, $n_e(t)$, and the electron energy density, $W(t)$. The state of the system at any time $t$ is described by the vector $\\vec{y}(t) = [n_e(t), W(t)]$.\n\n### Electron Density Rate Equation\nThe evolution of the electron number density $n_e$ is governed by the particle continuity equation:\n$$\n\\frac{dn_e}{dt} = S - L\n$$\nwhere $S$ represents particle source rates and $L$ represents particle loss (sink) rates.\n\n- **Source Term ($S$)**: The primary source of electrons during breakdown is the electron-impact ionization of the neutral gas. This rate is given by $S_{\\mathrm{ion}} = n_e n_n k_{\\mathrm{ion}}(T_e)$, where $n_n$ is the neutral gas density and $k_{\\mathrm{ion}}(T_e)$ is the temperature-dependent ionization rate coefficient.\n\n- **Loss Terms ($L$)**: Two loss mechanisms are specified:\n    1.  **Radiative Recombination**: Electrons and ions recombine, forming a neutral atom and emitting a photon. The rate is $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e n_i$. Assuming quasineutrality ($n_i \\approx n_e$), this becomes $L_{\\mathrm{rec}} = \\alpha_r(T_e) n_e^2$.\n    2.  **Wall Losses**: Electrons are lost to the tokamak vessel walls through transport processes. This is modeled as a first-order decay term, $L_{\\mathrm{wall}} = n_e / \\tau_p$, where $\\tau_p$ is the particle confinement time.\n\nCombining these terms, the full rate equation for electron density is:\n$$\n\\frac{dn_e}{dt} = n_e n_n k_{\\mathrm{ion}}(T_e) - \\alpha_r(T_e) n_e^2 - \\frac{n_e}{\\tau_p}\n$$\n\n### Electron Energy Density Rate Equation\nThe evolution of the electron energy density $W$ (in $\\mathrm{J/m^3}$) is governed by the energy balance equation:\n$$\n\\frac{dW}{dt} = P_{\\mathrm{in}} - P_{\\mathrm{loss}}\n$$\nwhere $P_{\\mathrm{in}}$ is the power density input and $P_{\\mathrm{loss}}$ is the power density loss.\n\n- **Input Power ($P_{\\mathrm{in}}$)**: The sole heating mechanism specified is Ohmic (or Joule) heating from the toroidal electric field $E$. The power density is $P_{\\mathrm{ohm}} = j E = \\sigma E^2$, where $\\sigma$ is the plasma's electrical conductivity.\n\n- **Loss Power ($P_{\\mathrm{loss}}$)**: Two energy loss channels are included:\n    1.  **Ionization Energy Cost**: Each ionization event consumes a certain amount of energy, $U_{\\mathrm{ion}}$ (in eV), required to free the electron. The power density lost to ionization is the rate of ionization events multiplied by the energy cost per event in Joules. This gives $P_{\\mathrm{ion}} = S_{\\mathrm{ion}} \\cdot (e U_{\\mathrm{ion}}) = n_e n_n k_{\\mathrm{ion}}(T_e) e U_{\\mathrm{ion}}$, where $e$ is the elementary charge in Joules per eV.\n    2.  **Energy Confinement Loss**: Similar to particle loss, energy is transported out of the plasma to the walls. This is modeled as $P_{\\mathrm{conf}} = W / \\tau_E$. The problem specifies using $\\tau_E = \\tau_p$.\n\nCombining these terms, the full rate equation for electron energy density is:\n$$\n\\frac{dW}{dt} = \\sigma E^2 - n_e n_n k_{\\mathrm{ion}}(T_e) e U_{\\mathrm{ion}} - \\frac{W}{\\tau_p}\n$$\n\n### Closure Relations\nTo solve the system, all terms in the RHS of the ODEs must be expressed as functions of the state variables $n_e$ and $W$, and the input parameters.\n\n1.  **Electron Temperature ($T_e$)**: Related to energy density and number density by $W = \\frac{3}{2} n_e e T_e$, where $T_e$ is in eV. Inverting this and including the numerical floor gives:\n    $$\n    T_e = \\max\\left(T_{\\mathrm{floor}}, \\frac{2W}{3 n_e e}\\right)\n    $$\n\n2.  **Neutral Density ($n_n$)**: Calculated from the ideal gas law using the provided background pressure $p$ and temperature $T_g$:\n    $$\n    n_n = \\frac{p}{k_B T_g}\n    $$\n\n3.  **Rate Coefficients ($k_{\\mathrm{ion}}, \\alpha_r$)**: These are explicit functions of $T_e$:\n    $$\n    k_{\\mathrm{ion}}(T_e) = C_{\\mathrm{ion}} \\sqrt{T_e}\\, \\exp\\left(-\\frac{U_{\\mathrm{ion}}}{T_e}\\right)\n    $$\n    $$\n    \\alpha_r(T_e) = \\alpha_0\\, T_e^{-0.7}\n    $$\n\n4.  **Conductivity ($\\sigma$)**: Depends on the effective electron collision frequency $\\nu_e = \\nu_{en} + \\nu_{ei}$.\n    - The electron-neutral frequency $\\nu_{en}$ depends on $T_e$ through the thermal speed $v_{th}$:\n      $$ \\nu_{en} = n_n \\sigma_{en} \\sqrt{\\frac{8 e T_e}{\\pi m_e}} $$\n    - The electron-ion frequency $\\nu_{ei}$ depends on both $n_e$ and $T_e$:\n      $$ \\nu_{ei} = C_{ei} n_e \\ln\\Lambda \\, T_e^{-3/2} $$\n    - The conductivity $\\sigma$ is then:\n      $$ \\sigma = \\frac{e^2 n_e}{m_e (\\nu_{en} + \\nu_{ei})} $$\n\n### Final System of ODEs\nWith all terms defined, we have the final system of coupled, nonlinear, first-order ordinary differential equations for the state vector $\\vec{y}(t) = [n_e(t), W(t)]^T$:\n\n$$\n\\frac{d}{dt} \\begin{pmatrix} n_e \\\\ W \\end{pmatrix} = \\begin{pmatrix} n_e n_n k_{\\mathrm{ion}}(T_e) - \\alpha_r(T_e) n_e^2 - \\dfrac{n_e}{\\tau_p} \\\\ \\\\ \\sigma(n_e, T_e) E^2 - n_e n_n k_{\\mathrm{ion}}(T_e) e U_{\\mathrm{ion}} - \\dfrac{W}{\\tau_p} \\end{pmatrix}\n$$\n\nwhere $T_e$, $n_n$, $k_{\\mathrm{ion}}$, $\\alpha_r$, and $\\sigma$ are functions of $n_e$, $W$, and fixed parameters as defined above. This system, along with the initial conditions $n_e(0) = n_{e0}$ and $W(0) = \\frac{3}{2} n_{e0} e T_{e0}$, can be solved numerically to find the time evolution of the plasma and determine the breakdown time. The stiffness arises from the wide range of timescales, from fast collision processes to slower confinement losses, and the highly nonlinear, exponential dependence of ionization on temperature.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves a 0D model for tokamak plasma breakdown.\n    The model consists of two coupled ODEs for electron density (n_e)\n    and electron energy density (W).\n    \"\"\"\n\n    # --- Constants and Fixed Parameters ---\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs (and J/eV)\n    M_E = 9.10938356e-31       # Electron mass in kg\n    K_B = 1.380649e-23         # Boltzmann constant in J/K\n    T_G = 300.0                # Neutral gas temperature in K\n    SIGMA_EN = 2.0e-19         # Electron-neutral momentum-transfer cross-section in m^2\n    C_EI = 2.91e-6             # Coefficient for electron-ion collisions in m^3 s^-1 eV^(3/2)\n    LN_LAMBDA = 12.0           # Coulomb logarithm\n    U_ION = 15.4               # Ionization energy in eV\n    C_ION = 1.0e-17            # Coefficient for ionization rate in m^3 s^-1 eV^(-1/2)\n    ALPHA_0 = 1.0e-19          # Coefficient for recombination rate (units m^3/s * eV^0.7)\n    T_FLOOR = 0.1              # Electron temperature floor in eV\n    \n    # --- Initial and Boundary Conditions ---\n    N_E0 = 1.0e12              # Initial electron number density in m^-3\n    T_E0 = 2.0                 # Initial electron temperature in eV\n    N_STAR = 1.0e19            # Breakdown threshold for electron density in m^-3\n    \n    # --- Initial energy density (J/m^3) ---\n    W0 = 1.5 * N_E0 * E_CHARGE * T_E0\n\n    def solve_case(E, p, tau_p, t_max):\n        \"\"\"\n        Solves the ODE system for a single test case.\n        \n        Args:\n            E (float): Electric field magnitude (V/m)\n            p (float): Neutral gas pressure (Pa)\n            tau_p (float): Particle confinement time (s)\n            t_max (float): Maximum simulation time (s)\n            \n        Returns:\n            float: Breakdown time in seconds, or -1.0 if no breakdown.\n        \"\"\"\n        # Calculate constant neutral density from pressure\n        n_n = p / (K_B * T_G)\n\n        def ode_system(t, y):\n            n_e, W = y\n            \n            # Prevent numerical instability for non-physical values\n            if n_e <= 0:\n                return [0.0, 0.0]\n\n            # Calculate electron temperature (eV) from state variables\n            # Includes a floor for numerical stability\n            T_e = max(T_FLOOR, (2.0 * W) / (3.0 * n_e * E_CHARGE))\n            \n            # --- Calculate Temperature-Dependent Coefficients ---\n            \n            # Ionization rate coefficient (m^3/s)\n            k_ion = C_ION * np.sqrt(T_e) * np.exp(-U_ION / T_e)\n            \n            # Recombination rate coefficient (m^3/s)\n            alpha_r = ALPHA_0 * T_e**(-0.7)\n            \n            # --- Calculate Collision Frequencies (s^-1) ---\n            \n            # Electron thermal speed (m/s)\n            v_th = np.sqrt(8.0 * E_CHARGE * T_e / (np.pi * M_E))\n            \n            # Electron-neutral collision frequency\n            nu_en = n_n * SIGMA_EN * v_th\n            \n            # Electron-ion collision frequency\n            nu_ei = C_EI * n_e * LN_LAMBDA * T_e**(-1.5)\n            \n            # Total effective collision frequency\n            nu_e = nu_en + nu_ei\n            \n            # --- Calculate Plasma Conductivity (S/m) ---\n            sigma = (E_CHARGE**2 * n_e) / (M_E * nu_e) if nu_e > 0 else 0.0\n            \n            # --- Assemble the ODEs ---\n            \n            # 1. Rate of change for electron density (dn_e/dt)\n            source_ion = n_e * n_n * k_ion\n            loss_rec = alpha_r * n_e**2\n            loss_wall = n_e / tau_p\n            dn_e_dt = source_ion - loss_rec - loss_wall\n            \n            # 2. Rate of change for electron energy density (dW/dt)\n            power_in_ohm = sigma * E**2\n            power_loss_ion = source_ion * (U_ION * E_CHARGE)\n            power_loss_conf = W / tau_p\n            dW_dt = power_in_ohm - power_loss_ion - power_loss_conf\n            \n            return [dn_e_dt, dW_dt]\n\n        # Define the event to detect breakdown\n        def breakdown_event(t, y):\n            return y[0] - N_STAR\n        \n        breakdown_event.terminal = True  # Stop integration when event occurs\n        \n        # Set initial conditions\n        y0 = [N_E0, W0]\n        \n        # Solve the ODE system using a stiff solver\n        sol = solve_ivp(\n            ode_system, \n            [0, t_max], \n            y0, \n            method='Radau', \n            events=breakdown_event,\n            dense_output=True\n        )\n        \n        # Check if the breakdown event was triggered\n        if sol.status == 1 and sol.t_events[0].size > 0:\n            return sol.t_events[0][0]\n        else:\n            return -1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E, p, tau_p, t_max)\n        (20.0, 0.05, 0.005, 0.05),\n        (8.0, 0.05, 0.005, 0.05),\n        (30.0, 0.05, 0.005, 0.05),\n        (20.0, 0.01, 0.005, 0.05),\n        (20.0, 0.10, 0.005, 0.05),\n        (20.0, 0.05, 0.002, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, p, tau_p, t_max = case\n        result = solve_case(E, p, tau_p, t_max)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}