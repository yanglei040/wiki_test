{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将我们对快波电流驱动的理解建立在平行动量平衡的基本原理之上。通过分析一个简化的流体模型，您将计算在感应电场存在的情况下，射频波对总等离子体电流的贡献。这项练习对于定量区分非感应电流和欧姆电流至关重要，这是稳态托卡马克运行的一个基本概念 。",
            "id": "3699485",
            "problem": "一个均匀、轴对称的托卡马克等离子体由离子回旋频率范围（ICRF）内的快波（FW）维持，该快波通过电子朗道阻尼驱动电流，同时存在一个有限的感应环路电场。考虑沿磁场方向的电子流体的稳态平板模型。射频（RF）波的平行波数为 $k_{\\parallel}$，角频率为 $\\omega$，并向电子沉积功率密度 $P_{\\text{abs}}$。感应环路电场为 $E_{\\parallel}^{\\text{loop}}$。假设电子平行方向的动量平衡由环路电场、以电子-离子碰撞频率 $\\nu_{ei}$ 为特征的电子-离子碰撞摩擦力以及射频波沉积的平行方向动量密度 $S_{\\text{RF}}$ 共同决定。\n\n使用以下基本事实：\n- 稳态电子平行动量方程为 $0 = - e n_{e} E_{\\parallel}^{\\text{loop}} - m_{e} n_{e} \\nu_{ei} u_{e} + S_{\\text{RF}}$，其中 $u_{e}$ 是电子平行流动速度，$e$ 是元电荷，$m_{e}$ 是电子质量，$n_{e}$ 是电子数密度。\n- 总电流密度为 $J = - e n_{e} u_{e}$。\n- 在具有单电荷离子的完全电离等离子体中，电子-离子碰撞频率为 $\\nu_{ei} = \\dfrac{4 \\sqrt{2\\pi}\\, n_{e} e^{4} \\ln\\Lambda}{3 \\left(4\\pi \\epsilon_{0}\\right)^{2} m_{e}^{1/2} \\left(k_{B} T_{e}\\right)^{3/2}}$，其中 $\\epsilon_{0}$ 是真空介电常数，$k_{B}$ 是玻尔兹曼常数，$T_{e}$ 是电子温度，$\\ln\\Lambda$ 是库仑对数。\n- 射频波沉积的平行方向动量密度与吸收的功率密度之间的关系为 $S_{\\text{RF}} = \\dfrac{k_{\\parallel}}{\\omega} P_{\\text{abs}}$ （波量子携带的平行动量与能量之比）。\n\n将由射频动量沉积引起的非感应电流密度贡献定义为 $J_{\\text{RF}} \\equiv J\\big|_{E_{\\parallel}^{\\text{loop}}=0}$，总电流密度定义为 $J$。净非感应电流份额为 $f_{\\text{NI}} \\equiv \\dfrac{J_{\\text{RF}}}{J}$。使用以下数据，根据上述原理推导 $f_{\\text{NI}}$ 的解析表达式，并计算其数值。\n\n给定参数和常数：\n- $n_{e} = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$，$T_{e} = 5.0\\ \\text{keV}$，$\\ln\\Lambda = 17$，\n- $E_{\\parallel}^{\\text{loop}} = 0.050\\ \\text{V/m}$，\n- $P_{\\text{abs}} = 1.5 \\times 10^{6}\\ \\text{W/m}^{3}$，\n- $k_{\\parallel} = -25\\ \\text{m}^{-1}$，$\\omega = 2\\pi \\times 80\\ \\text{MHz}$，\n- $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$，$m_{e} = 9.109\\,383\\,56 \\times 10^{-31}\\ \\text{kg}$，\n- $\\epsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F/m}$，$k_{B} = 1.380\\,649 \\times 10^{-23}\\ \\text{J/K}$。\n\n将 $f_{\\text{NI}}$ 的最终答案表示为不带百分号的小数。将您的答案四舍五入到四位有效数字。",
            "solution": "题目要求推导净非感应电流份额 $f_{\\text{NI}}$ 的解析表达式，并计算其数值。题目给出的定义是 $f_{\\text{NI}} \\equiv \\dfrac{J_{\\text{RF}}}{J}$，其中 $J$ 是总平行电流密度，$J_{\\text{RF}}$ 是非感应电流密度。\n\n出发点是题目给出的平板模型中电子流体的稳态平行动量平衡方程：\n$$0 = - e n_{e} E_{\\parallel}^{\\text{loop}} - m_{e} n_{e} \\nu_{ei} u_{e} + S_{\\text{RF}}$$\n在该方程中，各项代表作用在电子流体上的力密度：第一项 $- e n_{e} E_{\\parallel}^{\\text{loop}}$ 是来自感应电场的力；第二项 $- m_{e} n_{e} \\nu_{ei} u_{e}$ 是来自离子的碰撞摩擦（拖拽）力，与电子平行流动速度 $u_{e}$ 方向相反；第三项 $S_{\\text{RF}}$ 是由射频（RF）波沉积的平行动量密度。变量包括元电荷 $e$、电子数密度 $n_{e}$、平行感应电场 $E_{\\parallel}^{\\text{loop}}$、电子质量 $m_{e}$ 和电子-离子碰撞频率 $\\nu_{ei}$。\n\n我们可以重新排列动量方程来求解电子流动速度 $u_{e}$：\n$$m_{e} n_{e} \\nu_{ei} u_{e} = S_{\\text{RF}} - e n_{e} E_{\\parallel}^{\\text{loop}}$$\n$$u_{e} = \\frac{S_{\\text{RF}} - e n_{e} E_{\\parallel}^{\\text{loop}}}{m_{e} n_{e} \\nu_{ei}}$$\n\n总平行电流密度 $J$ 由电子运动产生，定义为：\n$$J = - e n_{e} u_{e}$$\n将 $u_{e}$ 的表达式代入 $J$ 的定义中：\n$$J = - e n_{e} \\left( \\frac{S_{\\text{RF}} - e n_{e} E_{\\parallel}^{\\text{loop}}}{m_{e} n_{e} \\nu_{ei}} \\right)$$\n$$J = - \\frac{e S_{\\text{RF}} - e^2 n_{e} E_{\\parallel}^{\\text{loop}}}{m_{e} \\nu_{ei}} = \\frac{e^2 n_{e} E_{\\parallel}^{\\text{loop}} - e S_{\\text{RF}}}{m_{e} \\nu_{ei}}$$\n这个总电流密度 $J$ 的表达式是两个分量的和：由环路电场驱动的欧姆电流 $J_{\\text{OH}} = \\dfrac{e^2 n_{e} E_{\\parallel}^{\\text{loop}}}{m_{e} \\nu_{ei}}$，以及由射频波驱动的电流。\n\n题目将非感应电流密度 $J_{\\text{RF}}$ 定义为在没有感应电场时的总电流密度，即 $J_{\\text{RF}} \\equiv J\\big|_{E_{\\parallel}^{\\text{loop}}=0}$。将此定义应用于我们的 $J$ 表达式，令 $E_{\\parallel}^{\\text{loop}} = 0$：\n$$J_{\\text{RF}} = \\frac{e^2 n_{e} (0) - e S_{\\text{RF}}}{m_{e} \\nu_{ei}} = -\\frac{e S_{\\text{RF}}}{m_{e} \\nu_{ei}}$$\n有了它，总电流可以简洁地写为 $J = J_{\\text{OH}} + J_{\\text{RF}}$。\n\n现在我们推导净非感应电流份额 $f_{\\text{NI}}$ 的解析表达式：\n$$f_{\\text{NI}} = \\frac{J_{\\text{RF}}}{J}$$\n代入推导出的 $J$ 和 $J_{\\text{RF}}$ 的表达式：\n$$f_{\\text{NI}} = \\frac{-\\dfrac{e S_{\\text{RF}}}{m_{e} \\nu_{ei}}}{\\dfrac{e^2 n_{e} E_{\\parallel}^{\\text{loop}} - e S_{\\text{RF}}}{m_{e} \\nu_{ei}}}$$\n分子和分母的分母中的项 $m_{e} \\nu_{ei}$ 可以消去。这是一个重要的简化，因为它意味着确定分数 $f_{\\text{NI}}$ 不需要碰撞频率 $\\nu_{ei}$ 的详细表达式和值。\n$$f_{\\text{NI}} = \\frac{-e S_{\\text{RF}}}{e^2 n_{e} E_{\\parallel}^{\\text{loop}} - e S_{\\text{RF}}}$$\n分子分母同除以 $e$ 得到：\n$$f_{\\text{NI}} = \\frac{-S_{\\text{RF}}}{e n_{e} E_{\\parallel}^{\\text{loop}} - S_{\\text{RF}}}$$\n这就是所要求的 $f_{\\text{NI}}$ 的解析表达式。\n\n为了计算数值，我们首先使用给定的数据计算中间量 $S_{\\text{RF}}$ 和 $e n_{e} E_{\\parallel}^{\\text{loop}}$，确保所有值都使用国际单位制（SI units）。\n射频波沉积的平行方向动量密度 $S_{\\text{RF}}$ 与吸收的功率密度 $P_{\\text{abs}}$ 之间的关系为 $S_{\\text{RF}} = \\dfrac{k_{\\parallel}}{\\omega} P_{\\text{abs}}$。\n给定： $k_{\\parallel} = -25\\ \\text{m}^{-1}$，$\\omega = 2\\pi \\times 80\\ \\text{MHz} = 2\\pi \\times 80 \\times 10^6\\ \\text{s}^{-1}$，以及 $P_{\\text{abs}} = 1.5 \\times 10^{6}\\ \\text{W/m}^{3}$。\n$$S_{\\text{RF}} = \\frac{-25\\ \\text{m}^{-1}}{2\\pi \\times 80 \\times 10^6\\ \\text{s}^{-1}} (1.5 \\times 10^6\\ \\text{W/m}^3) = \\frac{-25 \\times 1.5}{160\\pi}\\ \\text{N/m}^3 \\approx -0.0746133\\ \\text{N/m}^3$$\n\n接下来，我们计算来自环路电场的力密度项 $e n_{e} E_{\\parallel}^{\\text{loop}}$。\n给定： $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$，$n_e = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$，以及 $E_{\\parallel}^{\\text{loop}} = 0.050\\ \\text{V/m}$。\n$$e n_{e} E_{\\parallel}^{\\text{loop}} = (1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}) (5.0 \\times 10^{19}\\ \\text{m}^{-3}) (0.050\\ \\text{V/m})$$\n$$e n_{e} E_{\\parallel}^{\\text{loop}} = (1.602\\,176\\,634 \\times 5.0 \\times 0.050)\\ \\text{N/m}^3 \\approx 0.4005442\\ \\text{N/m}^3$$\n\n现在，我们将这些数值代入 $f_{\\text{NI}}$ 的解析表达式中：\n$$f_{\\text{NI}} = \\frac{-S_{\\text{RF}}}{e n_{e} E_{\\parallel}^{\\text{loop}} - S_{\\text{RF}}} = \\frac{-(-0.0746133\\ \\text{N/m}^3)}{0.4005442\\ \\text{N/m}^3 - (-0.0746133\\ \\text{N/m}^3)}$$\n$$f_{\\text{NI}} = \\frac{0.0746133}{0.4005442 + 0.0746133} = \\frac{0.0746133}{0.4751575} \\approx 0.157028$$\n\n题目要求将最终答案四舍五入到四位有效数字。\n$$f_{\\text{NI}} \\approx 0.1570$$",
            "answer": "$$\\boxed{0.1570}$$"
        },
        {
            "introduction": "在托卡马克等离子体中，波的传播很少是直接了当的，理解模式转换等现象至关重要。这个动手数值练习模拟了快波（FW）和离子伯恩斯坦波（IBW）之间的相互作用，这是一种常见的模式转换情景。通过求解耦合模式方程，您将获得关于等离子体剖面（如磁剪切和密度梯度）如何决定波类型之间功率转换效率的实践见解 。",
            "id": "3699491",
            "problem": "考虑在具有磁剪切的磁化等离子体中，快波电流驱动过程中快波 (FW) 与离子伯恩斯坦波 (IBW) 之间的一维相互作用。使用源自麦克斯韦方程组和冷等离子体波理论的缓变包络近似，将 FW-IBW 相互作用建模为两个沿单一空间坐标 $x$ 演化的耦合复模幅。\n\n令 $a(x)$ 表示 FW 的复包络振幅，$b(x)$ 表示 IBW 的复包络振幅。假设在 $x=0$ 处存在一个单一的局域模式转换区，在该区域，两波的波数失配 $\\Delta(x)$ 线性地穿过零点。采用以下定义了一个最小且物理上自洽的耦合模框架的建模假设：\n\n1. FW 和 IBW 的包络遵循空间上的一阶耦合模方程：\n   $$\\frac{d}{dx}\\begin{pmatrix} a \\\\ b \\end{pmatrix} = i\\begin{pmatrix} \\frac{\\Delta(x)}{2}  C_0 \\\\ C_0  -\\frac{\\Delta(x)}{2} \\end{pmatrix}\\begin{pmatrix} a \\\\ b \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ \\gamma_b \\end{pmatrix} \\circ \\begin{pmatrix} a \\\\ b \\end{pmatrix},$$\n   其中 $\\gamma_b \\ge 0$ 是 IBW 的空间阻尼率，用于模拟耗散过程（例如，离子回旋阻尼），$\\circ$ 表示按分量相乘，因此阻尼仅适用于 $b(x)$。\n\n2. 转换区附近的波数失配 $\\Delta(x)$ 与 $x$ 呈线性关系：\n   $$\\Delta(x) = S_{\\Delta}\\,x,$$\n   其中斜率 $S_{\\Delta}$ 包含了磁剪切效应。通过长度标度 $L_s$（单位为米）对磁剪切进行参数化，并令\n   $$S_{\\Delta} = \\frac{S_s}{L_s^2},$$\n   其中 $S_s$ 是下文提供的无量纲常数。此选择确保了 $\\Delta(x)$ 具有正确的物理单位，即米的倒数。\n\n3. FW-IBW 耦合系数 $C_0$ 依赖于密度梯度标长 $L_n$（单位为米），其关系为\n   $$C_0 = \\frac{C_n}{L_n},$$\n   其中 $C_n$ 是下文提供的无量纲常数。这种标度关系反映了在冷等离子体理论中，更陡峭的密度梯度通常会加强局域模式耦合。\n\n4. 包络被归一化，使得与每个模式相关的功率流与其包络幅值的平方成正比，即 $\\mathcal{P}_{\\text{FW}} \\propto |a|^2$ 和 $\\mathcal{P}_{\\text{IBW}} \\propto |b|^2$。在此归一化下，无阻尼时，耦合模的演化是幺正的，它在 FW 和 IBW 之间重新分配功率，同时保持总功率守恒。当 $\\gamma_b > 0$ 时，IBW 的功率会沿 $x$ 耗散。\n\n边值问题设置：\n- 域：$x \\in [-X_{\\max}, X_{\\max}]$，其中 $X_{\\max} = 1.0$ 米。\n- 左边界的入射 FW：$a(-X_{\\max}) = 1$ 和 $b(-X_{\\max}) = 0$。\n- 效率定义：到 IBW 的模式转换效率为\n  $$\\eta = |b(X_{\\max})|^2,$$\n  其为无量纲。以浮点数形式报告 $\\eta$。\n\n常数：\n- $S_s = 0.5$ (无量纲),\n- $C_n = 0.02$ (无量纲).\n\n您的任务：\n- 通过将上述耦合模方程重铸为关于 $a(x)$ 和 $b(x)$ 的实部和虚部的实值形式，并从 $x=-X_{\\max}$ 积分到 $x=+X_{\\max}$，来实现一个数值求解器。\n- 使用一个具有适当容差的鲁棒常微分方程求解器，以在下述所有情况下获得数值稳定的结果。\n- 对于每个测试用例，计算 FW 到 IBW 的转换效率 $\\eta$，并返回一个单行，其中包含所有用例的结果，以逗号分隔的列表形式并用方括号括起来（例如，“[0.123,0.456]”）。\n\n单位：\n- 所有长度 $L_n$、$L_s$ 和 $X_{\\max}$ 的单位均为米。\n- 阻尼率 $\\gamma_b$ 的单位为米的倒数。\n- 效率 $\\eta$ 是无量纲的。\n\n测试套件：\n评估以下五个测试用例，这些用例探究了不同的磁剪切和密度梯度机制，包括有阻尼的情况：\n1. 用例 1 (中等剪切，陡峭密度梯度，无阻尼): $L_n = 0.05$, $L_s = 5.0$, $\\gamma_b = 0.0$.\n2. 用例 2 (强剪切，较平缓密度梯度，无阻尼): $L_n = 0.50$, $L_s = 0.20$, $\\gamma_b = 0.0$.\n3. 用例 3 (弱剪切，陡峭密度梯度，有阻尼): $L_n = 0.10$, $L_s = 10.0$, $\\gamma_b = 0.5$.\n4. 用例 4 (弱剪切，非常平缓的密度梯度，无阻尼): $L_n = 1.00$, $L_s = 10.0$, $\\gamma_b = 0.0$.\n5. 用例 5 (中等剪切，非常陡峭的密度梯度，无阻尼): $L_n = 0.02$, $L_s = 0.50$, $\\gamma_b = 0.0$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含五个效率值，以逗号分隔的列表形式并用方括号括起来，顺序与上述用例相同（例如，“[η1,η2,η3,η4,η5]”），其中每个 $\\eta$ 都是一个浮点数。",
            "solution": "所提出的问题在等离子体波物理学背景下是一个有效且适定的初值问题。它的科学基础是波相互作用的耦合模理论，这是用于描述诸如快波 (FW) 到离子伯恩斯坦波 (IBW) 模式转换等现象的标准模型。所有参数、常数、边界条件和目标都定义清晰且数学上一致。不存在矛盾、模糊或事实错误。因此，我们着手提供完整解答。\n\n问题的核心是求解关于波幅 $a(x)$ 和 $b(x)$ 的一个由两个耦合的一阶复常微分方程 (ODE) 组成的方程组：\n$$\n\\frac{d}{dx}\\begin{pmatrix} a \\\\ b \\end{pmatrix} = i\\begin{pmatrix} \\frac{\\Delta(x)}{2}  C_0 \\\\ C_0  -\\frac{\\Delta(x)}{2} \\end{pmatrix}\\begin{pmatrix} a \\\\ b \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ \\gamma_b \\end{pmatrix} \\circ \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\n由 $\\circ$ 表示的按分量相乘，将空间阻尼率 $\\gamma_b$ 仅应用于 IBW 振幅 $b(x)$。波数失配由 $\\Delta(x) = S_{\\Delta}x$ 给出，参数 $S_{\\Delta}$ 和 $C_0$ 由物理量定义：磁剪切长度 $L_s$、密度梯度标长 $L_n$ 以及无量纲常数 $S_s$ 和 $C_n$。目标是在给定初始条件 $a(-X_{\\max}) = 1$ 和 $b(-X_{\\max}) = 0$ 的情况下，求出模式转换效率 $\\eta = |b(X_{\\max})|^2$。\n\n标准的数值 ODE 求解器（例如 `scipy` 库中提供的那些）是为处理实值方程组而设计的。因此，第一步是将复数系统转换为等价的实数系统。我们将复振幅分解为其实部和虚部：\n$$ a(x) = a_r(x) + i a_i(x) $$\n$$ b(x) = b_r(x) + i b_i(x) $$\n将这些形式代入控制方程并分离实部和虚部，得到一个由 4 个耦合的一阶实常微分方程组成的系统。\n\n$a(x)$ 的方程为：\n$$ \\frac{d}{dx}(a_r + i a_i) = i \\frac{\\Delta(x)}{2} (a_r + i a_i) + i C_0 (b_r + i b_i) $$\n$$ \\frac{da_r}{dx} + i \\frac{da_i}{dx} = \\left(-\\frac{\\Delta(x)}{2} a_i - C_0 b_i\\right) + i \\left(\\frac{\\Delta(x)}{2} a_r + C_0 b_r\\right) $$\n令实部和虚部相等，得到：\n$$ \\frac{da_r}{dx} = -\\frac{\\Delta(x)}{2} a_i - C_0 b_i $$\n$$ \\frac{da_i}{dx} = \\frac{\\Delta(x)}{2} a_r + C_0 b_r $$\n\n$b(x)$ 的方程为：\n$$ \\frac{d}{dx}(b_r + i b_i) = i C_0 (a_r + i a_i) - i \\frac{\\Delta(x)}{2} (b_r + i b_i) - \\gamma_b (b_r + i b_i) $$\n$$ \\frac{db_r}{dx} + i \\frac{db_i}{dx} = \\left(-C_0 a_i + \\frac{\\Delta(x)}{2} b_i - \\gamma_b b_r\\right) + i \\left(C_0 a_r - \\frac{\\Delta(x)}{2} b_r - \\gamma_b b_i\\right) $$\n令实部和虚部相等，得到：\n$$ \\frac{db_r}{dx} = -C_0 a_i + \\frac{\\Delta(x)}{2} b_i - \\gamma_b b_r $$\n$$ \\frac{db_i}{dx} = C_0 a_r - \\frac{\\Delta(x)}{2} b_r - \\gamma_b b_i $$\n\n我们定义一个状态向量 $\\vec{y}(x) = [y_0(x), y_1(x), y_2(x), y_3(x)]^T = [a_r(x), a_i(x), b_r(x), b_i(x)]^T$。该方程组可以写成标准形式 $\\frac{d\\vec{y}}{dx} = \\vec{f}(x, \\vec{y})$。在 $x = -X_{\\max}$ 处的初始条件为 $a(-X_{\\max}) = 1 = 1 + 0i$ 和 $b(-X_{\\max}) = 0 = 0 + 0i$。这对应于初始状态向量：\n$$ \\vec{y}(-X_{\\max}) = [1, 0, 0, 0]^T $$\n问题现在简化为在域 $x \\in [-X_{\\max}, X_{\\max}]$ 上求解此初值问题。我们将采用一种鲁棒的数值积分方法，例如在 `scipy.integrate.solve_ivp` 中实现的自适应龙格-库塔方法，以求得积分域末端的状态向量 $\\vec{y}(X_{\\max})$。\n\n在求得 $x = X_{\\max}$ 处的解后，最终状态向量为 $\\vec{y}(X_{\\max}) = [a_r(X_{\\max}), a_i(X_{\\max}), b_r(X_{\\max}), b_i(X_{\\max})]^T$。此时 IBW 的复振幅为 $b(X_{\\max}) = b_r(X_{\\max}) + i b_i(X_{\\max})$。然后根据其定义计算模式转换效率 $\\eta$：\n$$ \\eta = |b(X_{\\max})|^2 = b_r(X_{\\max})^2 + b_i(X_{\\max})^2 $$\n\n实现过程将首先定义一个函数，该函数为给定状态计算导数 $\\vec{f}(x, \\vec{y})$，并由物理输入 $L_n$、$L_s$ 和 $\\gamma_b$ 参数化。对于每个测试用例，我们计算中间参数 $S_{\\Delta} = S_s/L_s^2$ 和 $C_0 = C_n/L_n$。然后，我们使用适当的初始条件和积分区间调用 ODE 求解器。最后，我们提取 $b_r$ 和 $b_i$ 的最终值以计算 $\\eta$，并将结果组装成所需的输出格式。",
            "answer": "[0.01570179927692257,0.0003998933446002935,3.990022416041764e-05,9.999750006249845e-06,0.2211992173321516]"
        },
        {
            "introduction": "为了更深入地理解电流驱动效率，我们必须从以波为中心的视角转向波-粒子相互作用的动理学描述。这个高级计算实践要求您求解一个简化的一维 Fokker-Planck 方程，以模拟电子分布函数如何被快波和低混杂波共同改变。这项练习将使您能够量化射频协同效应的概念，即组合使用不同波源可以产生比各部分之和更高的电流驱动效率 。",
            "id": "3699495",
            "problem": "您需要实现一个数值求解器，使用沿平行速度坐标的一维、稳态、准线性 Fokker–Planck 模型来量化快波电流驱动 (FWCD) 和低混杂波电流驱动 (LHCD) 之间的协同效应。您的任务是计算一个协同因子，该因子衡量当两种射频 (RF) 波共同施加时，相对于单独施加时，品质因数（即单位功率驱动的电流）的改善程度。\n\n模型假设与基本原理：\n- 从存在线性化库仑碰撞和准线性扩散的一维稳态动理学方程出发，描述电子分布函数 $f(u)$。其中，$u \\doteq v_{\\parallel}/v_{te}$ 是归一化的平行速度，$v_{te}$ 是电子热速度。归一化使得碰撞频率为常数 $\\nu = 1$ 且 $v_{te}^{2} = 1$。沿 $u$ 的稳态方程为\n$$\n\\frac{d}{du}\\left[\\nu\\,u\\,f(u) + \\left(\\nu + D(u)\\right)\\frac{df}{du}\\right] = 0,\n$$\n其中 $D(u)$ 是由射频波引起的非负准线性扩散系数。\n- 在边界 $u = \\pm u_{\\max}$ 处施加零通量条件，这意味着在 $u$ 空间中各处的总通量均为零，\n$$\n\\nu\\,u\\,f(u) + \\left(\\nu + D(u)\\right)\\frac{df}{du} = 0.\n$$\n在我们选择的归一化条件下 $\\nu = 1$，该方程简化为\n$$\n\\frac{df}{du} = -\\frac{u}{1 + D(u)} f(u).\n$$\n- 解可以写成求积形式\n$$\nf(u) = C\\,\\exp\\left(-\\int_{0}^{u} \\frac{s}{1 + D(s)}\\,ds\\right),\n$$\n其中归一化常数 $C$ 由 $\\int_{-u_{\\max}}^{u_{\\max}} f(u)\\,du = 1$ 确定，这在当前归一化单位下固定了电子密度。\n\n波模型与品质因数：\n- 将每种波的准线性扩散系数模型化为平行速度空间中的高斯函数，\n$$\nD_{\\mathrm{FW}}(u) = A_{\\mathrm{FW}}\\,\\exp\\left(-\\frac{(u - u_{\\mathrm{FW}})^{2}}{2 w_{\\mathrm{FW}}^{2}}\\right),\\quad\nD_{\\mathrm{LH}}(u) = A_{\\mathrm{LH}}\\,\\exp\\left(-\\frac{(u - u_{\\mathrm{LH}})^{2}}{2 w_{\\mathrm{LH}}^{2}}\\right),\n$$\n其中振幅 $A_{\\mathrm{FW}}, A_{\\mathrm{LH}} \\ge 0$，中心 $u_{\\mathrm{FW}}, u_{\\mathrm{LH}} \\ge 0$，宽度 $w_{\\mathrm{FW}}, w_{\\mathrm{LH}} > 0$。对于组合波，使用 $D_{\\mathrm{tot}}(u) = D_{\\mathrm{FW}}(u) + D_{\\mathrm{LH}}(u)$。\n- 定义无量纲驱动电流（单位密度和电荷，在与 $v_{te}=1$ 一致的归一化单位下）为\n$$\nJ[D] \\doteq \\int_{-u_{\\max}}^{u_{\\max}} u\\, f_{D}(u)\\,du,\n$$\n其中 $f_{D}(u)$ 是在给定 $D(u)$ 下得到的稳态解。\n- 对于作用在稳态分布 $f(u)$ 上的给定扩散剖面 $D_{w}(u)$，定义一个正定的无量纲吸收功率为\n$$\nP[D_{w}; f] \\doteq \\int_{-u_{\\max}}^{u_{\\max}} D_{w}(u)\\,\\left(\\frac{df}{du}\\right)^{2}\\,du.\n$$\n对于单波情况，使用 $P[D_{\\mathrm{FW}}; f_{\\mathrm{FW}}]$，其中 $f_{\\mathrm{FW}}$ 仅由 $D_{\\mathrm{FW}}$ 计算得出；$P[D_{\\mathrm{LH}}; f_{\\mathrm{LH}}]$ 也类似。对于组合情况，使用 $P[D_{\\mathrm{tot}}; f_{\\mathrm{tot}}]$，其中 $f_{\\mathrm{tot}}$ 由 $D_{\\mathrm{tot}}$ 计算得出。\n- 定义任何情况下的电流驱动品质因数为\n$$\n\\Phi[D] \\doteq \\frac{J[D]}{P[D; f_{D}]},\n$$\n并约定如果分母为零，则定义 $\\Phi[D]$ 为 $0$。\n- 定义协同因子为相对于两个单波品质因数中较优者的改善程度，\n$$\n\\mathcal{S} \\doteq \\frac{\\Phi[D_{\\mathrm{tot}}]}{\\max\\left(\\Phi[D_{\\mathrm{FW}}],\\,\\Phi[D_{\\mathrm{LH}}]\\right)}.\n$$\n根据此定义，$\\mathcal{S} > 1$ 表示有益的协同效应，$\\mathcal{S} = 1$ 表示相对于较优的单波情况无协同效应，$\\mathcal{S}  1$ 表示性能下降。在此归一化下，所有量均为无量纲，因此输出无需指定物理单位。\n\n离散化与数值约束：\n- 将 $u \\in [-u_{\\max}, u_{\\max}]$ 均匀离散化，点数为 $N_{u}$（奇数），包含 $u=0$。使用一致的二阶精度梯形法则计算指数中的积分，从而根据一阶常微分方程构建 $f(u)$。通过数值求积将 $f(u)$ 归一化，使得 $\\int f\\,du = 1$。使用内部点的二阶中心有限差分和端点的二阶单边差分计算 $df/du$。所有积分均通过梯形法则计算。\n- 所有情况均使用相同的网格和数值算子，以确保比率有意义。\n\n测试套件：\n对于每个测试用例，您将获得 $u_{\\max}$ 和 $N_{u}$，以及 FW 和 LH 的扩散参数 $\\{A_{\\mathrm{FW}}, u_{\\mathrm{FW}}, w_{\\mathrm{FW}}\\}$ 和 $\\{A_{\\mathrm{LH}}, u_{\\mathrm{LH}}, w_{\\mathrm{LH}}\\}$。您的程序必须为每个用例计算 $\\mathcal{S}$ 并汇总结果。请使用以下四个科学上合理的用例，它们探究了不同的物理机制：\n- 用例 #1 (共振区重叠，预期有协同效应)：$u_{\\max} = 6$, $N_{u} = 2001$, $A_{\\mathrm{FW}} = 0.6$, $u_{\\mathrm{FW}} = 3.0$, $w_{\\mathrm{FW}} = 0.6$, $A_{\\mathrm{LH}} = 0.4$, $u_{\\mathrm{LH}} = 2.0$, $w_{\\mathrm{LH}} = 0.5$。\n- 用例 #2 (共振区分离，协同效应弱)：$u_{\\max} = 6$, $N_{u} = 2001$, $A_{\\mathrm{FW}} = 0.6$, $u_{\\mathrm{FW}} = 5.0$, $w_{\\mathrm{FW}} = 0.6$, $A_{\\mathrm{LH}} = 0.4$, $u_{\\mathrm{LH}} = 1.5$, $w_{\\mathrm{LH}} = 0.4$。\n- 用例 #3 (仅 LH 波，边界情况)：$u_{\\max} = 6$, $N_{u} = 2001$, $A_{\\mathrm{FW}} = 0.0$, $u_{\\mathrm{FW}} = 3.0$, $w_{\\mathrm{FW}} = 0.6$, $A_{\\mathrm{LH}} = 0.5$, $u_{\\mathrm{LH}} = 2.2$, $w_{\\mathrm{LH}} = 0.5$。\n- 用例 #4 (FW 波主导，协同效应小)：$u_{\\max} = 6$, $N_{u} = 2001$, $A_{\\mathrm{FW}} = 1.0$, $u_{\\mathrm{FW}} = 3.5$, $w_{\\mathrm{FW}} = 0.7$, $A_{\\mathrm{LH}} = 0.2$, $u_{\\mathrm{LH}} = 2.0$, $w_{\\mathrm{LH}} = 0.5$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个用例的协同因子，形式为方括号括起来的逗号分隔列表（例如 $[s_1,s_2,s_3,s_4]$），其中每个 $s_i$ 是一个十进制表示的实数。",
            "solution": "该问题是有效的。它提出了一个有科学依据、良态且计算上易于处理的聚变等离子体中射频电流驱动协同效应模型。所有必要的方程、参数和数值方法都已提供，构成了一个完整且一致的数值求解规范。\n\n任务是针对涉及快波 (FW) 和低混杂波 (LH) 电流驱动的四种不同物理情景，计算协同因子 $\\mathcal{S}$。求解过程需要基于一维、稳态、准线性 Fokker-Planck 模型，对电子分布函数、驱动电流和吸收功率进行数值评估。\n\n模型的核心是关于归一化平行速度 $u$ 下电子分布函数 $f(u)$ 的常微分方程：\n$$\n\\frac{df}{du} = -\\frac{u}{1 + D(u)} f(u)\n$$\n其中 $D(u)$ 是由施加的射频波引起的准线性扩散系数。该方程的解通过求积得到：\n$$\nf(u) = C\\,\\exp\\left(-\\int_{0}^{u} \\frac{s}{1 + D(s)}\\,ds\\right)\n$$\n常数 $C$ 由归一化条件 $\\int_{-u_{\\max}}^{u_{\\max}} f(u)\\,du = 1$ 确定。单个波的扩散系数 $D_{\\mathrm{FW}}(u)$ 和 $D_{\\mathrm{LH}}(u)$ 以高斯函数形式给出。当两种波同时施加时，总扩散系数为 $D_{\\mathrm{tot}}(u) = D_{\\mathrm{FW}}(u) + D_{\\mathrm{LH}}(u)$。\n\n对于每种情况（仅 FW 波、仅 LH 波和组合波），数值实现按以下步骤进行：\n\n1.  **网格和扩散系数设置**：在定义域 $[-u_{\\max}, u_{\\max}]$上建立一个包含 $N_{u}$ 个点的均匀网格，用于表示归一化速度 $u$。网格间距为 $\\Delta u = 2u_{\\max}/(N_u-1)$。在此网格上计算扩散系数 $D_{\\mathrm{FW}}(u)$、$D_{\\mathrm{LH}}(u)$ 和 $D_{\\mathrm{tot}}(u)$，并将其存储为数组。\n\n2.  **分布函数计算**：对于给定的扩散系数 $D(u)$，计算分布函数 $f(u)$。\n    - 首先，在每个网格点上计算指数部分的被积函数 $g(s) = s / (1 + D(s))$。\n    - 对网格上所有的 $u$ 计算定积分 $I(u) = \\int_{0}^{u} g(s) ds$。这通过梯形法则完成，具体使用了 `scipy.integrate.cumulative_trapezoid`。由于网格的构建包含索引为 $i_{\\text{zero}}$ 的点 $u=0$，从 $0$ 到 $u_i$ 的积分可以通过计算整个网格的累积积分再减去在 $i_{\\text{zero}}$ 处的值得到。\n    - 接着，未归一化的分布函数为 $f_{\\text{un}}(u) = \\exp(-I(u))$。\n    - 通过使用梯形法则 (`numpy.trapz`) 计算 $f_{\\text{un}}(u)$ 在定义域 $[-u_{\\max}, u_{\\max}]$ 上的积分来找到归一化常数 $C$。最终归一化的分布函数为 $f(u) = f_{\\text{un}}(u) / \\int f_{\\text{un}}(u) du$。\n\n3.  **电流和功率计算**：\n    - 无量纲驱动电流 $J$ 通过在定义域上对 $u f(u)$ 进行梯形积分计算得出：\n      $$\n      J = \\int_{-u_{\\max}}^{u_{\\max}} u f(u) du\n      $$\n    - 分布函数的导数 $df/du$ 按规定进行数值计算。对内部网格点使用二阶中心有限差分格式，对边界点 $u = \\pm u_{\\max}$ 使用二阶单边格式。\n    - 无量纲吸收功率 $P$ 通过对 $D(u) (df/du)^2$ 进行梯形积分计算得出：\n      $$\n      P = \\int_{-u_{\\max}}^{u_{\\max}} D(u) \\left(\\frac{df}{du}\\right)^2 du\n      $$\n\n4.  **品质因数和协同因子**：\n    - 对每种情况（FW、LH、tot），品质因数计算为 $\\Phi = J/P$。如果 $P=0$，则定义 $\\Phi$ 为 $0$。此过程得到 $\\Phi_{\\mathrm{FW}}$、$\\Phi_{\\mathrm{LH}}$ 和 $\\Phi_{\\mathrm{tot}}$。\n    - 最终的协同因子 $\\mathcal{S}$ 计算为组合品质因数与两个单独品质因数中较优者的比值：\n      $$\n      \\mathcal{S} = \\frac{\\Phi_{\\mathrm{tot}}}{\\max(\\Phi_{\\mathrm{FW}}, \\Phi_{\\mathrm{LH}})}\n      $$\n    分母为零的特殊情况（即 $\\Phi_{\\mathrm{FW}}$ 和 $\\Phi_{\\mathrm{LH}}$ 均为零）通过定义 $\\mathcal{S}=1$ 来处理，尽管这种情况在提供的测试套件中不会发生。对于测试用例 #3，其中 $A_{\\mathrm{FW}}=0$，因此 $D_{\\mathrm{FW}}=0$ 且 $\\Phi_{\\mathrm{FW}}=0$。因为 $D_{\\mathrm{tot}} = D_{\\mathrm{LH}}$，所以必然有 $\\Phi_{\\mathrm{tot}} = \\Phi_{\\mathrm{LH}}$，从而正确地得到 $\\mathcal{S} = 1$。\n\n整个过程被封装在一个使用 `numpy` 和 `scipy` 库的 Python 脚本中。该脚本遍历四个指定的测试用例，为每个用例计算相应的协同因子。然后，结果被汇总并按要求的格式打印出来。",
            "answer": "[1.334758925565532,1.0526715003554045,1.0,1.034507000787031]"
        }
    ]
}