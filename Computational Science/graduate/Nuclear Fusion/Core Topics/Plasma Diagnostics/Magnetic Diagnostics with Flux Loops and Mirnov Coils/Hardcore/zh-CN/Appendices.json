{
    "hands_on_practices": [
        {
            "introduction": "本练习着重于磁诊断中的一项基础计算。为了解读来自磁通环的信号，我们必须首先理解等离子体电流和传感器之间的几何耦合关系。这种耦合由互感 $M$ 来量化。本练习  提供了将基本的毕奥-萨伐尔定律应用于一个简化但具有代表性的托卡马克几何结构中以推导这一关键参数的实践经验，从而将基础电磁理论与实际诊断设计联系起来。",
            "id": "3707844",
            "problem": "一个环形托卡马克等离子体柱可以局部近似为一个细环形电流丝。考虑一个半径为 $a$ 的细环形等离子体电流丝，位于 $x\\text{–}y$ 平面内，以原点为中心，载有稳恒的环向电流 $I_{\\mathrm{p}}$。一个用于磁诊断的矩形单匝磁通环路安装在真空室外部，以对称轴（$z$ 轴）为中心，其平面垂直于 $z$ 轴。该磁通环路的宽度为 $w$，高度为 $h$，因此其面积为 $A = w h$，其中心位于$z$轴上的$z=z_0$处。假设为自由空间磁导率，且磁通环路的尺寸相对于磁场的轴向变化长度尺度足够小，以至于轴向磁场在环路面积上可以近似为均匀的。\n\n使用 Biot–Savart 定律和互感 $M$（定义为单位电流的磁通匝链数）的定义，在所述假设下，推导环形等离子体电流丝和矩形磁通环路之间的 $M$ 的表达式，然后对 $a = 0.60\\,\\mathrm{m}$，$z_{0} = 1.50\\,\\mathrm{m}$，$w = 0.25\\,\\mathrm{m}$，$h = 0.10\\,\\mathrm{m}$ 和 $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$ 进行数值计算。\n将互感的最终答案以微亨（$\\mu\\mathrm{H}$）表示，并四舍五入到四位有效数字。使用国际单位制 (SI)。",
            "solution": "由稳恒电流分布产生的磁场可以通过 Biot–Savart 定律获得，\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi}\\,I_{\\mathrm{p}} \\oint \\frac{d\\boldsymbol{\\ell}' \\times \\hat{\\mathbf{R}}}{R^{2}} \\,,\n$$\n其中 $\\mathbf{R} = \\mathbf{r} - \\mathbf{r}'$ 是从电流丝上的源点 $\\mathbf{r}'$ 到场点 $\\mathbf{r}$ 的位移，$R = |\\mathbf{R}|$，且 $\\hat{\\mathbf{R}} = \\mathbf{R}/R$。对于位于 $x\\text{–}y$ 平面内、半径为 $a$ 的环形电流丝，我们将源点参数化为\n$$\n\\mathbf{r}'(\\phi) = a\\cos\\phi\\,\\hat{\\mathbf{x}} + a\\sin\\phi\\,\\hat{\\mathbf{y}} \\,,\n$$\n其线元为\n$$\nd\\boldsymbol{\\ell}' = \\frac{d\\mathbf{r}'}{d\\phi}\\,d\\phi = \\left(-a\\sin\\phi\\,\\hat{\\mathbf{x}} + a\\cos\\phi\\,\\hat{\\mathbf{y}}\\right)d\\phi \\,.\n$$\n我们求解沿轴线（$\\mathbf{r} = z\\,\\hat{\\mathbf{z}}$）的磁场。根据对称性，沿轴线的磁场指向 $\\hat{\\mathbf{z}}$ 方向，标准的计算（对 $\\phi$ 进行积分）可得出轴向分量\n$$\nB_{z}(z) = \\frac{\\mu_{0} I_{\\mathrm{p}} a^{2}}{2\\left(a^{2} + z^{2}\\right)^{3/2}} \\,.\n$$\n这个结果可以使用上述参数化直接从 Biot–Savart 积分推导出来，并注意到所有横向分量因对称性而抵消。\n\n穿过面积为 $A = w h$ 且法线方向为 $\\hat{\\mathbf{z}}$ 的矩形环路的磁通量为\n$$\n\\Phi = \\iint_{\\text{loop}} \\mathbf{B}\\cdot d\\mathbf{A} = \\iint_{\\text{loop}} B_{z}(z)\\,dA \\,.\n$$\n在所述假设下，即环路足够小以至于 $B_{z}$ 在其面积上近似均匀，且环路中心位于轴线上 $z=z_{0}$ 处，我们取其中心的 $B_{z}$ 值，得到\n$$\n\\Phi \\approx B_{z}(z_{0})\\,A = \\frac{\\mu_{0} I_{\\mathrm{p}} a^{2}}{2\\left(a^{2} + z_{0}^{2}\\right)^{3/2}}\\,A \\,.\n$$\n电流丝与环路之间的互感 $M$ 定义为单位电流的磁通匝链数，\n$$\nM \\equiv \\frac{\\Phi}{I_{\\mathrm{p}}} = \\frac{\\mu_{0} a^{2} A}{2\\left(a^{2} + z_{0}^{2}\\right)^{3/2}} \\,.\n$$\n\n现在我们对给定参数进行 $M$ 的数值计算。首先计算分母中的几何因子：\n$$\na^{2} + z_{0}^{2} = (0.60)^{2} + (1.50)^{2} = 0.36 + 2.25 = 2.61 \\,,\n$$\n所以\n$$\n\\left(a^{2} + z_{0}^{2}\\right)^{3/2} = \\left(2.61\\right)^{3/2} = 2.61\\,\\sqrt{2.61} \\approx 2.61 \\times 1.615549 \\approx 4.216583 \\,.\n$$\n环路面积为\n$$\nA = w h = 0.25 \\times 0.10 = 0.025 \\,.\n$$\n将所有数值代入互感公式：\n$$\nM = \\frac{\\left(4\\pi \\times 10^{-7}\\right)\\times (0.60)^{2} \\times 0.025}{2 \\times 4.216583} = \\frac{\\left(4\\pi \\times 10^{-7}\\right)\\times 0.36 \\times 0.025}{2 \\times 4.216583} \\,.\n$$\n计算分子因子：\n$$\n\\left(4\\pi \\times 10^{-7}\\right)\\times 0.36 \\times 0.025 = \\left(4\\pi \\times 10^{-7}\\right)\\times 0.009 = 3.6\\pi \\times 10^{-9} \\,,\n$$\n分母中的因子 $2$ 给出\n$$\n\\frac{3.6\\pi \\times 10^{-9}}{2} = 1.8\\pi \\times 10^{-9} \\,.\n$$\n因此，\n$$\nM = \\frac{1.8\\pi \\times 10^{-9}}{4.216583} \\,\\mathrm{H} \\approx 1.3411 \\times 10^{-9} \\,\\mathrm{H} \\,.\n$$\n使用 $1\\,\\mu\\mathrm{H} = 10^{-6}\\,\\mathrm{H}$ 转换为微亨：\n$$\nM \\approx 1.3411 \\times 10^{-9}\\,\\mathrm{H} = 1.3411 \\times 10^{-3}\\,\\mu\\mathrm{H} \\,.\n$$\n四舍五入到四位有效数字，\n$$\nM \\approx 1.341 \\times 10^{-3}\\,\\mu\\mathrm{H} \\,.\n$$\n\n关于环路面积上磁场均匀的假设：由于磁场是在对称轴上计算的，$B_{z}$ 的主阶径向变化因对称性而消失，第一个非零修正是离轴位移的二次方，其特征尺度为 $\\left(a^{2} + z_{0}^{2}\\right)$ 的量级。环路的半对角线约为 $\\approx \\frac{1}{2}\\sqrt{w^{2} + h^{2}} \\approx \\frac{1}{2}\\sqrt{0.25^{2} + 0.10^{2}} \\approx 0.141$，这个值远小于 $\\sqrt{a^{2} + z_{0}^{2}} \\approx 1.616$，使得环路上的分数非均匀性对于当前计算在所述精度水平下可以忽略不计。",
            "answer": "$$\\boxed{1.341 \\times 10^{-3}}$$"
        },
        {
            "introduction": "从理想物理学转向测量硬件的实际情况，本练习探讨了长脉冲聚变实验中的一个关键挑战。磁通环的信号正比于磁通量的时间导数 $\\frac{d\\Phi}{dt}$，必须通过积分来恢复总磁通量 $\\Phi(t)$。本练习  探讨了电子积分器中一个常见的非理想特性——输入偏置电流——如何导致测量磁通量随时间累积的误差，即“漂移”，从而证明了在数据分析中考虑硬件局限性的重要性。",
            "id": "3707854",
            "problem": "一个环形约束装置同时使用极向磁通环和磁拾取（Mirnov）线圈来重建长脉冲放电过程中演变的磁场。一个具有$N$匝的磁通环环绕着一个时变极向磁通量$\\Phi(t)$的区域，并根据法拉第定律产生感应电压。该磁环信号由一个运算放大器积分器进行处理，其输入通过一个阻值为$R$的电阻，反馈元件为一个容值为$C$的电容。该积分器的设计使其输出能在脉冲持续时间内直接估算极向磁通量$\\Phi(t)$。实际的运算放大器在求和节点处存在非零的输入偏置电流$I_b$，当该电流流过输入电阻时，会在积分器输入端产生一个直流偏置电压。长时间下来，这种偏置会导致推断出的磁通量出现基线漂移。\n\n从法拉第定律和理想运算放大器积分器方程出发，推导在输出等于磁通量的标定条件下，积分器输出与$\\Phi(t)$之间的关系。然后，将求和节点处的输入偏置电流$I_b$的影响建模为等效输入偏置，并确定由此产生的推断磁通量中随时间变化的误差。对于一个$N=20$匝的磁通环，积分器输入电阻$R=100~\\text{k}\\Omega$，放大器输入偏置电流$I_b=20~\\text{nA}$，计算放电持续时间$T=300~\\text{s}$后磁通量误差的大小。以韦伯（webers）为单位表示最终的磁通量误差，并将答案四舍五入到三位有效数字。假设积分器在其他方面是理想的，求和节点电位近似为零，并忽略任何并联泄漏路径或额外的补偿网络。",
            "solution": "本题要求推导由运放输入偏置电流引起的积分磁诊断信号中的磁通量误差表达式，并随后计算长脉冲放电中此误差的大小。解题过程分三步：首先，分析理想积分器电路；其次，引入误差源；第三，计算产生的误差。\n\n首先，我们分析理想系统。一个具有$N$匝的磁通环处在一个时变的极向磁通量$\\Phi(t)$中。根据法拉第感应定律，在磁环中感应的电压$V_{in}(t)$为：\n$$V_{in}(t) = -N \\frac{d\\Phi(t)}{dt}$$\n该电压作为运算放大器积分器的输入。在一个具有输入电阻$R$和反馈电容$C$的理想反相积分器电路中，输入电压$V_{in}(t)$和输出电压$V_{out}(t)$之间的关系是：\n$$V_{out}(t) = -\\frac{1}{RC} \\int_{0}^{t} V_{in}(t') dt'$$\n此处我们假设在$t=0$时积分器的输出为零。将法拉第定律中$V_{in}(t)$的表达式代入积分器方程，可得：\n$$V_{out}(t) = -\\frac{1}{RC} \\int_{0}^{t} \\left(-N \\frac{d\\Phi(t')}{dt'}\\right) dt' = \\frac{N}{RC} \\int_{0}^{t} \\frac{d\\Phi(t')}{dt'} dt'$$\n假设在$t=0$时磁通量为零，即$\\Phi(0)=0$，积分结果为：\n$$V_{out}(t) = \\frac{N}{RC} \\left[ \\Phi(t') \\right]_0^t = \\frac{N}{RC} \\Phi(t)$$\n题目指出，积分器经过标定，其输出可以直接估算磁通量。我们将其理解为以伏特为单位的输出电压数值等于以韦伯为单位的磁通量数值，这意味着比例因子为$1$。\n$$V_{out}(t) = \\Phi(t)$$\n为使此条件成立，前面的系数必须为1：\n$$\\frac{N}{RC} = 1 \\implies RC = N$$\n这个标定方程将积分器的时间常数$RC$与磁通环的匝数$N$联系起来。\n\n接下来，我们对输入偏置电流$I_b$的影响进行建模。该电流流入运算放大器的反相输入端。求和节点（反相输入端）是一个虚地，因此其电位近似为零。我们可以对求和节点应用Kirchhoff电流定律。来自输入源、流经电阻$R$的电流为$I_R = V_{in}(t)/R$。流经反馈电容的电流为$I_C = C \\frac{d(0 - V_{out})}{dt} = -C \\frac{dV_{out}}{dt}$。偏置电流$I_b$流入运放，因此相当于流出该节点。进入节点的电流总和为零：\n$$I_R - I_C - I_b = 0$$\n$$\\frac{V_{in}(t)}{R} - \\left(-C \\frac{dV_{out}(t)}{dt}\\right) - I_b = 0$$\n$$\\frac{V_{in}(t)}{R} + C \\frac{dV_{out}(t)}{dt} - I_b = 0$$\n整理后得到输出电压变化率的表达式：\n$$ \\frac{dV_{out}(t)}{dt} = -\\frac{1}{RC}V_{in}(t) + \\frac{I_b}{C}$$\n对时间从$0$到$t$积分，得到总输出电压$V_{out,total}(t)$：\n$$V_{out,total}(t) = \\int_0^t \\left(-\\frac{1}{RC}V_{in}(t') + \\frac{I_b}{C}\\right) dt' = \\left(-\\frac{1}{RC}\\int_0^t V_{in}(t') dt'\\right) + \\left(\\frac{I_b}{C}\\int_0^t dt'\\right)$$\n第一项是理想输出，根据我们的标定，它等于真实的磁通量$\\Phi(t)$。第二项是输出电压的误差，我们将其定义为推断磁通量的误差$\\Phi_{error}(t)$。\n$$\\Phi_{error}(t) = \\frac{I_b}{C} t$$\n这表明输入偏置电流导致积分信号随时间产生线性漂移。\n\n最后，我们计算这个磁通量误差的大小。为了从误差表达式中消去电容$C$，我们使用标定条件$RC = N$，这意味着$C = N/R$。将此代入误差方程：\n$$\\Phi_{error}(t) = \\frac{I_b}{N/R} t = \\frac{I_b R}{N} t$$\n题目要求我们计算放电持续时间$T = 300~\\text{s}$后这个误差的大小。给定的数值是：\n匝数，$N = 20$。\n输入电阻，$R = 100~\\text{k}\\Omega = 100 \\times 10^3~\\Omega = 10^5~\\Omega$。\n输入偏置電流，$I_b = 20~\\text{nA} = 20 \\times 10^{-9}~\\text{A}$。\n放电持续时间，$T = 300~\\text{s}$。\n\n磁通量误差的大小$|\\Phi_{error}(T)|$为：\n$$|\\Phi_{error}(T)| = \\left| \\frac{I_b R}{N} T \\right| = \\frac{(20 \\times 10^{-9}~\\text{A})(10^5~\\Omega)}{20} (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = \\frac{20 \\times 10^{-4}~\\text{V}}{20} (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = (1 \\times 10^{-4}~\\text{V}) (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = 300 \\times 10^{-4}~\\text{V} \\cdot \\text{s} = 0.03~\\text{V} \\cdot \\text{s}$$\n由于$1$韦伯（Wb）等于$1$伏特秒（$V \\cdot s$），所以误差为$0.03~\\text{Wb}$。\n题目要求答案保留三位有效数字。\n$$|\\Phi_{error}(T)| = 0.0300~\\text{Wb} = 3.00 \\times 10^{-2}~\\text{Wb}$$",
            "answer": "$$\\boxed{3.00 \\times 10^{-2}}$$"
        },
        {
            "introduction": "这最后一个练习是一个总结性的挑战，它将电磁耦合和系统响应的原理整合到一个综合的计算模型中。一个真实的托卡马克是一个复杂的系统，拥有众多相互作用的极向场线圈、等离子体电流和磁传感器。这个问题  要求你建立一个线性系统模型来预测整套诊断设备在各种等离子体和线圈电流情景下的电压响应，这为实时等离子体平衡重建和反馈控制等高级应用提供了至关重要的系统级理解。",
            "id": "3707797",
            "problem": "要求您使用基本电磁学原理为一个聚变装置的轴对称磁诊断系统建模，并实现一个程序来预测在指定电流斜坡下的诊断电压。该装置由极向场（PF）线圈、一组近似等离子体电流分布的环向等离子体电流丝以及两种类型的诊断设备组成：磁通环和米尔诺夫线圈。您必须从毕奥–萨伐尔定律和法拉第电磁感应定律出发，将诊断响应组装成一个线性系统。不允许未经证明就使用任何快捷公式；您使用的任何闭合形式表达式都必须能从所述定律推导出来（例如，对轴对称圆形回路使用完全椭圆积分是可以接受的，因为它们是通过计算相关积分得出的）。\n\n几何结构关于装置的垂直轴是轴对称的。所有源电流都建模为围绕对称轴的丝状圆形回路（环向电流方向）。诊断设备被建模为圆形回路（磁通环）或对局部磁场分量敏感的小面积线圈（米尔诺夫线圈）。整个过程必须使用国际单位制（SI）。\n\n基本原理：\n- 毕奥–萨伐尔定律（针对丝状电流元）：磁场微分贡献与电流成正比，与距离的平方成反比。在积分形式下，闭合回路电流产生的磁场可以通过沿回路使用右手定则进行积分得到。\n- 磁通量定义：通过一个表面的磁通量是磁场与表面法向量点乘的面积分。\n- 法拉第感应定律：感应电压等于穿过电路的磁通量对时间导数的负值。\n- 自由空间中静磁学的线性性质：磁场和磁通量与电流呈线性关系。\n\n基于以上原理，定义：\n- 对于一个被建模为圆形回路且有 $N$ 匝的磁通环诊断，其电压 $V$ 为 $V=-\\mathrm{d}\\Phi/\\mathrm{d}t$，其中 $\\Phi$ 是来自所有源的总匝链磁通。\n- 对于一个有 $N$ 匝、有效面积为 $A$、单位法向量为 $\\hat{\\mathbf{n}}$ 的小型米尔诺夫线圈，如果磁场 $\\mathbf{B}$ 在线圈面积上近似均匀，则其电压为$V=-N A\\, d(\\mathbf{B}\\cdot \\hat{\\mathbf{n}})/dt$。\n\n您必须构建：\n1. 每个诊断磁通环与每个源回路（包括PF线圈和等离子体电流丝）之间的互感矩阵，该矩阵需通过丝状回路间互感的诺伊曼公式严格获得（对于圆形共轴回路，这可以使用完全椭圆积分进行计算）。\n2. 每个米尔诺夫线圈对每个源回路的磁场灵敏度矩阵，通过计算线圈位置处单位源电流产生的磁场分量（对于法向为径向的线圈是 $B_R$，对于法向为垂直的线圈是 $B_Z$）得到（对于圆形回路磁场，这可以使用完全椭圆积分进行计算）。\n\n使用以下科学上一致且自洽的配置，所有距离单位均为米：\n- 磁常数：使用 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n- PF线圈（两个圆形丝状回路）：\n  - PF1：半径 $0.8\\,\\mathrm{m}$，轴向位置 $z=+0.6\\,\\mathrm{m}$。\n  - PF2：半径 $0.8\\,\\mathrm{m}$，轴向位置 $z=-0.6\\,\\mathrm{m}$。\n- 等离子体电流丝组（三个近似分布环向等离子体电流的圆形丝状回路），均位于 $z=0$：\n  - 半径：$1.0\\,\\mathrm{m}$、$1.2\\,\\mathrm{m}$、$1.4\\,\\mathrm{m}$。\n  - 每个等离子体电流丝根据权重 $[0.5,\\,0.3,\\,0.2]$（无量纲）承载总等离子体电流变化率的一部分，因此如果总等离子体电流斜坡为 $\\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t$，则电流丝斜坡率分别为 $0.5\\,\\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t$、$0.3\\,\\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t$ 和 $0.2\\,\\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t$。\n- 诊断设备：\n  - 磁通环（建模为有 $N$ 匝的圆形回路，每个测量匝链的极向磁通）：\n    - FL1：半径 $1.6\\,\\mathrm{m}$，位于 $z=0.0\\,\\mathrm{m}$，有 $N=40$ 匝。\n    - FL2：半径 $0.7\\,\\mathrm{m}$，位于 $z=0.45\\,\\mathrm{m}$，有 $N=20$ 匝。\n  - 米尔诺夫线圈（测量$-d(\\mathbf{B}\\cdot \\hat{\\mathbf{n}})/dt$乘以其有效面积匝数乘积的小型线圈）：\n    - MN1：位置 $(R=1.6\\,\\mathrm{m},\\,z=0.0\\,\\mathrm{m})$，法向沿 $+\\hat{\\mathbf{R}}$（径向），有 $N=200$ 匝，有效面积 $A=5\\times 10^{-4}\\,\\mathrm{m}^2$。\n    - MN2：位置 $(R=1.0\\,\\mathrm{m},\\,z=0.6\\,\\mathrm{m})$，法向沿 $+\\hat{\\mathbf{Z}}$（垂直），有 $N=200$ 匝，有效面积 $A=5\\times 10^{-4}\\,\\mathrm{m}^2$。\n\n您的程序必须：\n- 组装磁通环相对于五个源（两个PF线圈和三个等离子体电流丝）的互感矩阵，以及米尔诺夫线圈相对于同样五个源的磁场灵敏度矩阵。使用完全椭圆积分或毕奥–萨伐尔定律和诺伊曼公式所蕴含的等效精确方法来计算所需积分。\n- 不接受用户输入；而是为以下恒定电流斜坡测试套件计算诊断电压（因此电压不随时间变化）。对于每个测试用例，三个输入分别是PF1电流斜坡 $\\mathrm{d}I_{\\mathrm{PF1}}/\\mathrm{d}t$（单位 A/s）、PF2电流斜坡 $\\mathrm{d}I_{\\mathrm{PF2}}/\\mathrm{d}t$（单位 A/s）和总等离子体电流斜坡 $\\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t$（单位 A/s）。第四个值指定要报告的诊断设备（使用从零开始的索引对有序列表 $[\\mathrm{FL1},\\mathrm{FL2},\\mathrm{MN1},\\mathrm{MN2}]$ 进行索引）：\n  - 用例1: $\\left(5000,\\, -5000,\\, 10000,\\, 0\\right)$。\n  - 用例2: $\\left(0,\\, 10000,\\, 0,\\, 2\\right)$。\n  - 用例3: $\\left(20000,\\, 20000,\\, -10000,\\, 1\\right)$。\n  - 用例4: $\\left(0,\\, 0,\\, 0,\\, 3\\right)$。\n- 对于每个测试用例，使用法拉第定律和构建的耦合矩阵计算指定诊断设备的感应电压 $V$（单位为伏特）。将每个电压报告为浮点数值。\n\n角度单位：没有角度参数输入；完全椭圆积分应使用科学计算库提供的标准参数约定。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的四个电压（单位为伏特）结果，以逗号分隔的列表形式呈现，并用方括号括起来，每个值四舍五入到六位小数。例如，类似 $[0.123456,-0.000321, \\dots]$ 的输出是可以接受的。\n\n科学真实性要求：\n- 所有几何和电气参数必须完全按照给定值使用。\n- 始终使用 $\\mathrm{SI}$ 单位，并以 $\\mathrm{V}$ 为单位报告电压，四舍五入到六位小数。\n- 公式必须严格从毕奥–萨伐尔定律、法拉第定律和自由空间中的线性叠加原理推导得出。\n\n评分与覆盖范围：\n- 用例1混合了方向相反的PF斜坡和正向的等离子体斜坡，并报告一个磁通环电压。\n- 用例2仅驱动一个PF线圈，并报告一个对径向磁场分量敏感的米尔诺夫线圈电压。\n- 用例3使用大幅、同符号的PF斜坡和反向的等离子体斜坡，并报告靠近PF线圈平面的另一个磁通环电压。\n- 用例4是一个真正的零输入边界情况，对于一个米尔诺夫线圈电压，必须在数值精度范围内返回精确的零。\n\n您的解决方案必须实现所述物理过程并严格按照要求的格式生成输出。",
            "solution": "该问题要求计算在一个轴对称聚变装置中，由极向场（PF）线圈和等离子体电流丝系统中的时变电流在一组磁诊断设备（磁通环和米尔诺夫线圈）中引起的感应电压。该解决方案建立在电磁学原理之上，特别是在真空系统中的静磁近似下的法拉第感应定律和毕奥–萨伐尔定律。在此范畴内，麦克斯韦方程组的线性特性允许使用叠加原理，即一个诊断设备的总响应是其对每个独立电流源响应的总和。\n\n问题的核心是建立一个线性系统，将诊断电压与源电流的变化率联系起来。设源电流斜坡率向量为 $\\dot{\\mathbf{I}} = [\\mathrm{d}I_j/\\mathrm{d}t]$，诊断电压向量为 $\\mathbf{V} = [V_i]$。它们的关系形式为 $\\mathbf{V} = -\\mathbf{C} \\dot{\\mathbf{I}}$，其中 $\\mathbf{C}$ 是一个耦合矩阵，其元素取决于源和诊断设备的几何结构。负号源于法拉第感应定律中表达的楞次定律。\n\n源电流由两个PF线圈和三个同心等离子体电流丝提供。这五个源的总集合索引为 $j=1, \\dots, 5$。电流斜坡率为：\n$$\n\\dot{\\mathbf{I}} = \\begin{bmatrix}\n\\mathrm{d}I_{\\mathrm{PF1}}/\\mathrm{d}t \\\\\n\\mathrm{d}I_{\\mathrm{PF2}}/\\mathrm{d}t \\\\\n0.5 \\cdot \\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t \\\\\n0.3 \\cdot \\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t \\\\\n0.2 \\cdot \\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t\n\\end{bmatrix}\n$$\n诊断设备是两个磁通环和两个米尔诺夫线圈，索引为 $i=1, \\dots, 4$。任务是构建 $4 \\times 5$ 的耦合矩阵 $\\mathbf{C}$。\n\n**1. 磁通环响应与互感**\n一个有 $N_i$ 匝的磁通环 $i$ 测量穿过其表面的总磁通量 $\\Phi_i$。感应电压由法拉第定律给出：\n$$\nV_i = - \\frac{\\mathrm{d}\\Phi_{i,\\text{total}}}{\\mathrm{d}t} = -N_i \\frac{\\mathrm{d}\\Phi_i}{\\mathrm{d}t}\n$$\n磁通量 $\\Phi_i$ 是来自所有源电流 $I_j$ 的磁通量之和：$\\Phi_i = \\sum_j \\Phi_{ij}$。诊断回路 $i$ 和源回路 $j$ 之间的互感 $M_{ij}$ 定义为 $\\Phi_{ij} = M_{ij} I_j$。因此，电压为：\n$$\nV_i = -N_i \\sum_j M_{ij} \\frac{\\mathrm{d}I_j}{\\mathrm{d}t}\n$$\n对于磁通环诊断，耦合矩阵元素为 $C_{ij} = N_i M_{ij}$。对于两个共轴的圆形丝状回路，一个半径为 $R_j$、轴向位置为 $z_j$ 的源回路 $j$，和一个半径为 $R_i$、轴向位置为 $z_i$ 的诊断回路 $i$，其互感 $M_{ij}$ 从诺伊曼公式推导得出，并可使用第一类（$K$）和第二类（$E$）完全椭圆积分表示：\n$$\nM_{ij} = \\mu_0 \\sqrt{R_i R_j} \\left[ \\left(\\frac{2}{k} - k\\right) K(k) - \\frac{2}{k} E(k) \\right]\n$$\n其中 $\\mu_0 = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$ 是磁常数，参数 $k$ 由下式给出：\n$$\nk^2 = \\frac{4 R_i R_j}{(R_i + R_j)^2 + (z_i - z_j)^2}\n$$\n该公式用于计算诊断设备FL1（$i=1$）和FL2（$i=2$）的耦合。\n\n**2. 米尔诺夫线圈响应与磁场灵敏度**\n米尔诺夫线圈 $i$ 是一个有 $N_i$ 匝、有效面积为 $A_i$ 的小型线圈，其单位法向量为 $\\hat{\\mathbf{n}}_i$。它对平行于其法线的局部磁场分量敏感。感应电压为：\n$$\nV_i = -N_i A_i \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\mathbf{B} \\cdot \\hat{\\mathbf{n}}_i\\right)\n$$\n线圈位置处的总磁场 $\\mathbf{B}$ 是所有源产生磁场的叠加：$\\mathbf{B} = \\sum_j \\mathbf{B}_j$。由于 $\\mathbf{B}_j$ 与源电流 $I_j$ 成正比，我们写作 $\\mathbf{B}_j = \\mathbf{b}_j I_j$，其中 $\\mathbf{b}_j$ 是单位电流产生的磁场。电压变为：\n$$\nV_i = -N_i A_i \\sum_j \\left(\\mathbf{b}_j \\cdot \\hat{\\mathbf{n}}_i\\right) \\frac{\\mathrm{d}I_j}{\\mathrm{d}t}\n$$\n耦合矩阵元素为 $C_{ij} = N_i A_i (\\mathbf{b}_j \\cdot \\hat{\\mathbf{n}}_i)$。对于轴对称系统，磁场只有径向（$B_R$）和轴向（$B_Z$）分量。所需的磁场分量取决于线圈的朝向：\n- 对于MN1（$i=3$），$\\hat{\\mathbf{n}} = \\hat{\\mathbf{R}}$，因此需要 $b_{R,j}$。\n- 对于MN2（$i=4$），$\\hat{\\mathbf{n}} = \\hat{\\mathbf{Z}}$，因此需要 $b_{Z,j}$。\n\n位于点 $(R_d, z_d)$ 处，由一个半径为 $R_s$、位置为 $z_s$、电流为 $I_s$ 的源回路产生的磁场分量 $(B_R, B_Z)$，可从毕奥–萨伐尔定律推导得出：\n$$\nB_Z = \\frac{\\mu_0 I_s}{2\\pi} \\frac{1}{\\sqrt{(R_s+R_d)^2 + \\Delta z^2}} \\left[ K(k) + \\frac{R_s^2 - R_d^2 - \\Delta z^2}{(R_s - R_d)^2 + \\Delta z^2} E(k) \\right]\n$$\n$$\nB_R = \\frac{\\mu_0 I_s}{2\\pi R_d} \\frac{\\Delta z}{\\sqrt{(R_s+R_d)^2 + \\Delta z^2}} \\left[ -K(k) + \\frac{R_s^2 + R_d^2 + \\Delta z^2}{(R_s - R_d)^2 + \\Delta z^2} E(k) \\right]\n$$\n其中 $\\Delta z = z_d - z_s$，而 $k^2$ 与互感中的定义相同。我们计算单位电流（$I_s=1\\,\\mathrm{A}$）下的这些磁场分量以求得 $\\mathbf{b}_j$。\n\n**3. 系统组装与计算**\n算法流程如下：\n1.  定义五个源和四个诊断设备的几何与电气参数。\n2.  初始化一个 $4 \\times 5$ 的零矩阵 $\\mathbf{C}$ 用于存放耦合系数。\n3.  遍历每个诊断设备 $i \\in \\{1, \\dots, 4\\}$ 和每个源 $j \\in \\{1, \\dots, 5\\}$：\n    a. 如果诊断设备 $i$ 是一个磁通环，计算互感 $M_{ij}$ 并设置 $C_{ij} = N_i M_{ij}$。\n    b. 如果诊断设备 $i$ 是一个米尔诺夫线圈，计算单位电流所需的磁场分量（$b_{R,j}$ 或 $b_{Z,j}$）并设置 $C_{ij} = N_i A_i \\cdot (\\text{磁场分量})$。\n4.  对于四个测试用例中的每一个：\n    a. 使用给定的 $\\mathrm{d}I_{\\mathrm{PF1}}/\\mathrm{d}t$、$\\mathrm{d}I_{\\mathrm{PF2}}/\\mathrm{d}t$ 和 $\\mathrm{d}I_\\mathrm{p}/\\mathrm{d}t$ 值以及指定的等离子体电流权重，构建源电流斜坡向量 $\\dot{\\mathbf{I}}$。\n    b. 计算完整的诊断电压向量：$\\mathbf{V} = -\\mathbf{C} \\dot{\\mathbf{I}}$。\n    c. 选择与测试用例中指定的诊断索引相对应的电压 $V_i$。\n5.  收集四个结果电压并按指定格式进行格式化。椭圆积分 $K(k)$ 和 $E(k)$ 使用标准科学计算库函数进行数值计算，这些函数以 $m=k^2$ 作为参数。\n\n这个过程构成了一个完整的物理模型，完全由问题的给定条件和基本电磁定律确定。",
            "answer": "[-0.076632,0.016335,0.038450,0.000000]"
        }
    ]
}