{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of any magnetic measurement begins with the sensor itself. This first practice explores the fundamental relationship between the poloidal magnetic field $B_{\\theta}$ and the plasma current $I_{p}$, using Ampère's law to quantify how a small error in the physical placement of a flux loop can translate into a measurement error. By working through this sensitivity analysis , you will gain a crucial appreciation for the importance of precise engineering and calibration in magnetic diagnostics.",
            "id": "3707835",
            "problem": "Consider an axisymmetric toroidal fusion device in which the plasma carries a total toroidal current $I_{p}$. A flux loop consisting of $N$ turns and geometrical area $A$ is installed to measure the poloidal magnetic flux linking the loop. The loop is intended to be located at a nominal minor radius $r_{0}$, where it measures the local poloidal magnetic field $B_{\\theta}(r)$ and thus the instantaneous flux $\\Phi(r) = N \\int B_{\\theta}(r)\\,dS \\approx N A B_{\\theta}(r)$ under the assumption that $B_{\\theta}$ is approximately uniform across the loop’s area. The loop normal is oriented to measure the poloidal field. Assume the vacuum-field approximation outside the plasma boundary, axisymmetry, and that the device can be treated locally as a circular torus. Starting from the fundamental definition of magnetic flux $\\Phi = \\int \\mathbf{B}\\cdot d\\mathbf{S}$ and Ampère’s circuital law, derive the radial dependence of $B_{\\theta}(r)$ in terms of $I_{p}$ and use it to quantify the sensitivity of the measured flux to a small radial misplacement of the loop.\n\nThe loop is actually displaced radially by a small amount $\\Delta r$ from $r_{0}$, so that its actual radius is $r_{0} + \\Delta r$. Define the fractional error in the measured flux due to this misplacement as\n$$\n\\delta_{\\Phi} \\equiv \\frac{\\Phi(r_{0}+\\Delta r) - \\Phi(r_{0})}{\\Phi(r_{0})}.\n$$\nUnder the stated assumptions, compute $\\delta_{\\Phi}$ to leading order in the small parameter $\\Delta r / r_{0}$, and express your final answer as a closed-form analytic expression in terms of $r_{0}$ and $\\Delta r$ only. The answer is dimensionless. No numerical evaluation or rounding is required.",
            "solution": "The problem requires us to determine the fractional error in a magnetic flux measurement due to a small radial misplacement of a flux loop in an axisymmetric toroidal fusion device. The solution proceeds in three main steps: first, we derive the expression for the poloidal magnetic field $B_{\\theta}(r)$ using Ampère's circuital law; second, we express the measured magnetic flux $\\Phi(r)$ as a function of the minor radius $r$; and third, we compute the fractional error $\\delta_{\\Phi}$ to leading order by performing a Taylor expansion.\n\nStep 1: Derivation of the Poloidal Magnetic Field $B_{\\theta}(r)$\n\nWe begin with Ampère's circuital law, which states that the line integral of the magnetic field $\\mathbf{B}$ around a closed loop is proportional to the total current $I_{\\text{enc}}$ passing through the surface enclosed by the loop:\n$$\n\\oint \\mathbf{B} \\cdot \\mathrm{d}\\mathbf{l} = \\mu_0 I_{\\text{enc}}\n$$\nwhere $\\mu_0$ is the permeability of free space.\n\nThe problem specifies an axisymmetric toroidal device that can be treated locally as a circular torus. We choose an Amperian loop to be a circle of minor radius $r$ centered on the magnetic axis, located outside the plasma boundary. Due to axisymmetry, the poloidal component of the magnetic field, $B_{\\theta}$, has a constant magnitude at all points on this circular path. The magnetic field vector $\\mathbf{B}$ is tangential to this path, so the dot product $\\mathbf{B} \\cdot \\mathrm{d}\\mathbf{l}$ simplifies to $B_{\\theta} \\mathrm{d}l$.\n\nThe line integral becomes:\n$$\n\\oint \\mathbf{B} \\cdot \\mathrm{d}\\mathbf{l} = \\int_{0}^{2\\pi r} B_{\\theta} \\mathrm{d}l = B_{\\theta}(r) \\int_{0}^{2\\pi r} \\mathrm{d}l = B_{\\theta}(r) (2\\pi r)\n$$\nSince the flux loop is located outside the plasma, the Amperian loop at radius $r$ encloses the entirety of the plasma. Therefore, the total enclosed current $I_{\\text{enc}}$ is the total toroidal plasma current, $I_p$.\n\nSubstituting these results into Ampère's law gives:\n$$\nB_{\\theta}(r) (2\\pi r) = \\mu_0 I_p\n$$\nSolving for the poloidal magnetic field $B_{\\theta}(r)$ yields its radial dependence:\n$$\nB_{\\theta}(r) = \\frac{\\mu_0 I_p}{2\\pi r}\n$$\nThis expression shows that the poloidal magnetic field outside the plasma decreases inversely with the minor radius $r$.\n\nStep 2: Expression for the Measured Magnetic Flux $\\Phi(r)$\n\nThe problem states that the measured magnetic flux $\\Phi(r)$ by a loop of $N$ turns and area $A$ located at a minor radius $r$ is given by the approximation:\n$$\n\\Phi(r) \\approx N A B_{\\theta}(r)\n$$\nSubstituting the expression for $B_{\\theta}(r)$ derived in Step 1, we obtain the flux as a function of radius:\n$$\n\\Phi(r) = N A \\left( \\frac{\\mu_0 I_p}{2\\pi r} \\right) = \\frac{N A \\mu_0 I_p}{2\\pi} \\frac{1}{r}\n$$\nFor convenience, we can group the constant terms into a single constant $C = \\frac{N A \\mu_0 I_p}{2\\pi}$, so that the flux dependence on radius is expressed simply as:\n$$\n\\Phi(r) = \\frac{C}{r} = C r^{-1}\n$$\n\nStep 3: Calculation of the Fractional Error $\\delta_{\\Phi}$\n\nThe fractional error $\\delta_{\\Phi}$ due to a small radial misplacement $\\Delta r$ from the nominal position $r_0$ is defined as:\n$$\n\\delta_{\\Phi} \\equiv \\frac{\\Phi(r_{0}+\\Delta r) - \\Phi(r_{0})}{\\Phi(r_{0})}\n$$\nThe problem asks for this value to leading order in the small parameter $\\Delta r / r_{0}$. This suggests approximating the function $\\Phi(r)$ around $r = r_0$ using a first-order Taylor expansion. For a small displacement $\\Delta r$, we have:\n$$\n\\Phi(r_0 + \\Delta r) \\approx \\Phi(r_0) + \\left. \\frac{\\mathrm{d}\\Phi}{\\mathrm{d}r} \\right|_{r=r_0} \\Delta r\n$$\nSubstituting this approximation into the definition of $\\delta_{\\Phi}$:\n$$\n\\delta_{\\Phi} \\approx \\frac{\\left( \\Phi(r_0) + \\left. \\frac{\\mathrm{d}\\Phi}{\\mathrm{d}r} \\right|_{r=r_0} \\Delta r \\right) - \\Phi(r_0)}{\\Phi(r_0)} = \\frac{\\left. \\frac{\\mathrm{d}\\Phi}{\\mathrm{d}r} \\right|_{r=r_0} \\Delta r}{\\Phi(r_0)}\n$$\nNow, we must compute the derivative of $\\Phi(r)$ with respect to $r$:\n$$\n\\frac{\\mathrm{d}\\Phi}{\\mathrm{d}r} = \\frac{\\mathrm{d}}{\\mathrm{d}r} (C r^{-1}) = C (-1) r^{-2} = -\\frac{C}{r^2}\n$$\nEvaluating this derivative at the nominal radius $r = r_0$:\n$$\n\\left. \\frac{\\mathrm{d}\\Phi}{\\mathrm{d}r} \\right|_{r=r_0} = -\\frac{C}{r_0^2}\n$$\nWe also have the flux at the nominal radius, $\\Phi(r_0) = \\frac{C}{r_0}$. Substituting these into the expression for $\\delta_{\\Phi}$:\n$$\n\\delta_{\\Phi} \\approx \\frac{\\left(-\\frac{C}{r_0^2}\\right) \\Delta r}{\\frac{C}{r_0}}\n$$\nThe constant $C$ cancels out, and we can simplify the expression:\n$$\n\\delta_{\\Phi} \\approx \\left(-\\frac{1}{r_0^2}\\right) \\Delta r \\cdot r_0 = -\\frac{\\Delta r}{r_0}\n$$\nThis is the leading-order term for the fractional error. The result is a dimensionless quantity expressed solely in terms of the nominal radius $r_0$ and the misplacement $\\Delta r$, as required. The negative sign indicates that a small positive displacement $\\Delta r > 0$ (moving the loop outwards) results in a decrease in the measured flux, which is consistent with the $1/r$ dependence of the poloidal magnetic field.",
            "answer": "$$\n\\boxed{-\\frac{\\Delta r}{r_{0}}}\n$$"
        },
        {
            "introduction": "Magnetic coils naturally measure the time derivative of the magnetic flux, $\\frac{d\\Phi}{dt}$. To recover the flux $\\Phi(t)$ itself—a crucial quantity for plasma equilibrium reconstruction—we must integrate the coil's voltage signal over time. This practice  delves into a critical non-ideal behavior of analog integrators, showing how a tiny input bias current $I_b$ can cause a cumulative error, or 'drift', that becomes especially problematic in the long-duration discharges of modern fusion devices.",
            "id": "3707854",
            "problem": "A toroidal confinement device employs both poloidal flux loops and magnetic pickup (Mirnov) coils to reconstruct evolving magnetic fields during long-duration discharges. A flux loop with $N$ turns encircles a region of time-varying poloidal magnetic flux $\\Phi(t)$ and produces an induced voltage according to Faraday's law. The loop signal is processed by an operational-amplifier integrator whose input is through a resistor of resistance $R$ and whose feedback element is a capacitor of capacitance $C$. The integrator is designed so that its output directly estimates the poloidal magnetic flux $\\Phi(t)$ over the duration of the pulse. Real operational amplifiers have a nonzero input bias current $I_b$ at the summing node, which, when flowing through the input resistor, produces a direct-current offset voltage at the integrator input. Over long times, this offset leads to a baseline drift in the inferred flux.\n\nStarting from Faraday's law and the ideal operational-amplifier integrator equation, derive the relationship between the integrator output and $\\Phi(t)$ under the calibration that the output equals the flux. Then, model the effect of the input bias current $I_b$ at the summing node as an equivalent input offset and determine the resulting time-dependent error in the inferred flux. For a flux loop with $N=20$ turns, an integrator input resistor $R=100~\\text{k}\\Omega$, and an amplifier input bias current $I_b=20~\\text{nA}$, compute the magnitude of the flux error after a discharge duration of $T=300~\\text{s}$. Express the final flux error in webers and round your answer to three significant figures. Assume the integrator is otherwise ideal, the summing node potential is approximately zero, and neglect any parallel leakage paths or additional compensation networks.",
            "solution": "The problem requires the derivation of an expression for the flux error in an integrated magnetic diagnostic signal due to op-amp input bias current, and a subsequent calculation of this error for a long-duration discharge. The solution proceeds in three stages: first, an analysis of the ideal integrator circuit; second, the introduction of the error source; and third, the calculation of the resulting error.\n\nFirst, we analyze the ideal system. A flux loop with $N$ turns is subject to a time-varying poloidal magnetic flux $\\Phi(t)$. According to Faraday's law of induction, the voltage $V_{in}(t)$ induced in the loop is given by:\n$$V_{in}(t) = -N \\frac{d\\Phi(t)}{dt}$$\nThis voltage serves as the input to an operational-amplifier integrator. In an ideal inverting integrator circuit with input resistor $R$ and feedback capacitor $C$, the relationship between the input voltage $V_{in}(t)$ and the output voltage $V_{out}(t)$ is:\n$$V_{out}(t) = -\\frac{1}{RC} \\int_{0}^{t} V_{in}(t') dt'$$\nwhere we assume the integrator output is zero at time $t=0$. Substituting the expression for $V_{in}(t)$ from Faraday's law into the integrator equation yields:\n$$V_{out}(t) = -\\frac{1}{RC} \\int_{0}^{t} \\left(-N \\frac{d\\Phi(t')}{dt'}\\right) dt' = \\frac{N}{RC} \\int_{0}^{t} \\frac{d\\Phi(t')}{dt'} dt'$$\nAssuming the magnetic flux is zero at $t=0$, i.e., $\\Phi(0)=0$, the integral evaluates to:\n$$V_{out}(t) = \\frac{N}{RC} \\left[ \\Phi(t') \\right]_0^t = \\frac{N}{RC} \\Phi(t)$$\nThe problem states that the integrator is calibrated such that its output directly estimates the flux. We interpret this to mean that the numerical value of the output voltage in volts is equal to the numerical value of the flux in webers, which implies a scaling factor of $1$.\n$$V_{out}(t) = \\Phi(t)$$\nFor this condition to hold, the pre-factor must be unity:\n$$\\frac{N}{RC} = 1 \\implies RC = N$$\nThis calibration equation relates the integrator's time constant $RC$ to the number of turns $N$ in the flux loop.\n\nNext, we model the effect of the input bias current $I_b$. This current flows into the inverting input terminal of the operational amplifier. The summing node (the inverting input) is a virtual ground, so its potential is approximately zero. We can write Kirchhoff's Current Law for the summing node. The current from the input source through resistor $R$ is $I_R = V_{in}(t)/R$. The current through the feedback capacitor is $I_C = C \\frac{d(0 - V_{out})}{dt} = -C \\frac{dV_{out}}{dt}$. The bias current $I_b$ flows into the op-amp, hence out of the node. The sum of currents entering the node is zero:\n$$I_R - I_C - I_b = 0$$\n$$\\frac{V_{in}(t)}{R} - \\left(-C \\frac{dV_{out}(t)}{dt}\\right) - I_b = 0$$\n$$\\frac{V_{in}(t)}{R} + C \\frac{dV_{out}(t)}{dt} - I_b = 0$$\nRearranging for the rate of change of the output voltage gives:\n$$ \\frac{dV_{out}(t)}{dt} = -\\frac{1}{RC}V_{in}(t) + \\frac{I_b}{C}$$\nIntegrating with respect to time from $0$ to $t$ yields the total output voltage, $V_{out,total}(t)$:\n$$V_{out,total}(t) = \\int_0^t \\left(-\\frac{1}{RC}V_{in}(t') + \\frac{I_b}{C}\\right) dt' = \\left(-\\frac{1}{RC}\\int_0^t V_{in}(t') dt'\\right) + \\left(\\frac{I_b}{C}\\int_0^t dt'\\right)$$\nThe first term is the ideal output, which under our calibration is equal to the true flux $\\Phi(t)$. The second term is the error in the output voltage, which we identify as the error in the inferred flux, $\\Phi_{error}(t)$.\n$$\\Phi_{error}(t) = \\frac{I_b}{C} t$$\nThis shows that the input bias current causes a linear drift in the integrated signal over time.\n\nFinally, we compute the magnitude of this flux error. To eliminate the capacitance $C$ from the error expression, we use the calibration condition $RC = N$, which implies $C = N/R$. Substituting this into the error equation:\n$$\\Phi_{error}(t) = \\frac{I_b}{N/R} t = \\frac{I_b R}{N} t$$\nWe are asked to compute the magnitude of this error after a discharge duration of $T = 300~\\text{s}$. The given values are:\nNumber of turns, $N = 20$.\nInput resistance, $R = 100~\\text{k}\\Omega = 100 \\times 10^3~\\Omega = 10^5~\\Omega$.\nInput bias current, $I_b = 20~\\text{nA} = 20 \\times 10^{-9}~\\text{A}$.\nDischarge duration, $T = 300~\\text{s}$.\n\nThe magnitude of the flux error, $|\\Phi_{error}(T)|$, is:\n$$|\\Phi_{error}(T)| = \\left| \\frac{I_b R}{N} T \\right| = \\frac{(20 \\times 10^{-9}~\\text{A})(10^5~\\Omega)}{20} (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = \\frac{20 \\times 10^{-4}~\\text{V}}{20} (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = (1 \\times 10^{-4}~\\text{V}) (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = 300 \\times 10^{-4}~\\text{V} \\cdot \\text{s} = 0.03~\\text{V} \\cdot \\text{s}$$\nSince $1$ Weber ($Wb$) is equal to $1$ Volt-second ($V \\cdot s$), the error is $0.03~\\text{Wb}$.\nThe problem requires the answer to be rounded to three significant figures.\n$$|\\Phi_{error}(T)| = 0.0300~\\text{Wb} = 3.00 \\times 10^{-2}~\\text{Wb}$$",
            "answer": "$$\\boxed{3.00 \\times 10^{-2}}$$"
        },
        {
            "introduction": "The final step in the measurement chain is converting the conditioned analog signal into a digital format for storage, analysis, and feedback control. This process is susceptible to aliasing, where high-frequency noise can masquerade as lower-frequency physical phenomena, corrupting the data. This exercise  guides you through the design of an essential component—an anti-aliasing filter—to ensure the integrity of the sampled data, a cornerstone of reliable magnetohydrodynamic (MHD) mode analysis.",
            "id": "3707806",
            "problem": "A toroidal array of Mirnov coils and a poloidal flux loop on a medium-sized tokamak are used to monitor magnetic fluctuations and slow equilibrium evolution. Each Mirnov coil produces a voltage proportional to the time derivative of the magnetic field by Faraday’s law, and a low-noise analog integrator is used to reconstruct the magnetic field prior to digitization. To prevent high-frequency noise and out-of-band magnet power supply harmonics from aliasing into the sampled bandwidth, the signals are passed through an analog anti-aliasing low-pass filter before the analog-to-digital converter (ADC).\n\nAssume the following design constraints and choices:\n- The useful magnetohydrodynamic (MHD) fluctuation content is negligible above $f_{\\text{use}} = 20\\,\\text{kHz}$.\n- The sampling rate is $f_{s} = 400\\,\\text{kHz}$.\n- To preserve the passband while providing margin to the MHD spectral edge, the anti-aliasing filter cutoff is chosen as $f_{c} = 2 f_{\\text{use}}$ and the filter is selected to be a $n=5$ order maximally flat (Butterworth) analog low-pass with its cutoff defined at the $-3\\,\\text{dB}$ point.\n- The data acquisition (DAQ) chain requires attenuation of out-of-band components at least at the Nyquist frequency $f_{s}/2$ to limit aliasing.\n\nStarting only from fundamental principles of sampling (Nyquist-Shannon sampling theorem), linear time-invariant filter theory, and standard properties of maximally flat (Butterworth) low-pass filters, derive an expression for the magnitude attenuation at the Nyquist frequency and evaluate it numerically for the specified design. Compute the attenuation at $f_{s}/2$ relative to the passband in decibels, i.e., compute $A = 20 \\log_{10} |H(j 2\\pi f_{s}/2)|$ for the chosen $f_{c}$ and $n$.\n\nExpress your final answer in decibels (dB) and round to four significant figures.",
            "solution": "The problem requires us to calculate the attenuation of an $n=5$ order Butterworth low-pass filter at the Nyquist frequency. The solution involves defining the filter's frequency response, calculating the specific frequencies of interest, and then evaluating the attenuation formula.\n\n### Step 1: Butterworth Filter Frequency Response\n\nThe fundamental principle governing the behavior of an $n$-th order maximally flat (Butterworth) low-pass filter is its magnitude-squared frequency response, given by:\n$$|H(j\\omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2n}}$$\nwhere $\\omega$ is the angular frequency, $\\omega_c$ is the cutoff angular frequency (at which the power is attenuated by a factor of $1/2$, or $-3\\,\\text{dB}$), and $n$ is the order of the filter.\n\nThe attenuation in decibels, $A$, as a function of frequency is defined as:\n$$A(\\omega) = 20 \\log_{10}(|H(j\\omega)|)$$\nThis can be expressed in terms of the magnitude-squared response:\n$$A(\\omega) = 10 \\log_{10}(|H(j\\omega)|^2)$$\nSubstituting the Butterworth response into this expression yields:\n$$A(\\omega) = 10 \\log_{10}\\left(\\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2n}}\\right) = -10 \\log_{10}\\left(1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2n}\\right)$$\nSince the frequencies in the problem are given in Hertz ($f$), we use the relationship $\\omega = 2\\pi f$. The expression for attenuation in terms of frequency $f$ is:\n$$A(f) = -10 \\log_{10}\\left(1 + \\left(\\frac{f}{f_c}\\right)^{2n}\\right)$$\n\n### Step 2: Calculate Frequencies of Interest\n\nThe problem provides the following parameters:\n-   Order of the filter, $n = 5$.\n-   Sampling frequency, $f_s = 400\\,\\text{kHz} = 4 \\times 10^5\\,\\text{Hz}$.\n-   Useful signal frequency upper limit, $f_{\\text{use}} = 20\\,\\text{kHz} = 2 \\times 10^4\\,\\text{Hz}$.\n\nFirst, we calculate the filter's cutoff frequency, $f_c$, which is defined at the $-3\\,\\text{dB}$ point:\n$$f_c = 2 f_{\\text{use}} = 2 \\times (20\\,\\text{kHz}) = 40\\,\\text{kHz} = 4 \\times 10^4\\,\\text{Hz}$$\nNext, we calculate the Nyquist frequency, which is the frequency at which we need to determine the attenuation. According to the Nyquist-Shannon sampling theorem, this is half the sampling rate:\n$$f_{Nyquist} = \\frac{f_s}{2} = \\frac{400\\,\\text{kHz}}{2} = 200\\,\\text{kHz} = 2 \\times 10^5\\,\\text{Hz}$$\n\n### Step 3: Evaluate Attenuation at Nyquist Frequency\n\nWe can now compute the ratio of the Nyquist frequency to the cutoff frequency:\n$$\\frac{f_{Nyquist}}{f_c} = \\frac{200\\,\\text{kHz}}{40\\,\\text{kHz}} = 5$$\nWe substitute this ratio and the filter order $n=5$ into the attenuation formula:\n$$A(f_{Nyquist}) = -10 \\log_{10}\\left(1 + (5)^{2 \\times 5}\\right)$$\n$$A = -10 \\log_{10}\\left(1 + 5^{10}\\right)$$\nWe evaluate the term $5^{10}$:\n$$5^{10} = 9,765,625$$\nSubstituting this value back into the expression for $A$:\n$$A = -10 \\log_{10}(1 + 9,765,625) = -10 \\log_{10}(9,765,626)$$\nUsing a calculator for the base-10 logarithm:\n$$\\log_{10}(9,765,626) \\approx 6.98970004$$\nTherefore, the attenuation is:\n$$A \\approx -10 \\times 6.98970004 \\approx -69.8970004\\,\\text{dB}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$A \\approx -69.90\\,\\text{dB}$$\nThis shows that at the Nyquist frequency, the filter provides approximately $69.90\\,\\text{dB}$ of attenuation, which is a substantial reduction of signal amplitude, effectively preventing aliasing from components at this frequency.",
            "answer": "$$\\boxed{-69.90}$$"
        }
    ]
}