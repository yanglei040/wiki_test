{
    "hands_on_practices": [
        {
            "introduction": "要掌握微波反射计，首要任务是理解其作为一种测距工具的基本原理。本练习  将引导你从第一性原理出发，推导调频连续波（FMCW）反射计的一个核心关系：空间分辨率与所用微波的扫频带宽之间的联系。通过这个练习，你将深入理解信号处理中的时间-带宽原理如何直接转化为等离子体诊断中的空间分辨能力。",
            "id": "3709454",
            "problem": "考虑在径向坐标为 $r$ 的冷磁化等离子体中的一维寻常模（O模）微波反射计，其中电子密度剖面 $n_{e}(r)$ 产生的局域电子等离子体频率为 $\\omega_{\\mathrm{pe}}(r) = \\sqrt{n_{e}(r) e^{2}/(\\epsilon_{0} m_{e})}$。对于垂直于截止层传播的O模，冷等离子体色散关系为 $k^{2} c^{2} = \\omega^{2} - \\omega_{\\mathrm{pe}}^{2}(r)$，群速度为 $v_{g}(\\omega,r) = \\partial \\omega / \\partial k$。一个调频连续波（FMCW）反射计发射一个线性啁啾信号 $s(t)$，其瞬时频率在持续时间 $T$ 内围绕某个中心频率在总带宽 $B$ 上单调扫描。由于到局域截止层并返回的双程传播，接收到的场是发射场的延迟版本。假设：\n\n- 几何光学极限有效，且反射发生在局域截止层，其中 $\\omega = \\omega_{\\mathrm{pe}}(r_{\\mathrm{c}})$。\n- 在截止层附近感兴趣的小径向区间内，群速度可以近似为一个常数 $v_{g} \\approx c/n_{g}$，其中 $n_{g}$ 是在截止层处计算的局域群折射率。\n- 匹配滤波（或去啁啾加频谱估计）处理可以建模为在扫描带宽 $B$ 上对信号的瞬时频率内容进行积分。\n\n从O模的色散关系和群速度的定义出发，并使用有限带宽信号傅里叶分析的基本原理，推导两个相邻截止层之间的最小可分辨径向距离 $\\Delta r$ 的闭式解析表达式，该表达式用啁啾带宽 $B$、光速 $c$ 和群折射率 $n_{g}$ 表示。您的推导必须从信号的有限带宽来证明时间延迟分辨率，而不能引用任何已知的雷达快捷公式。清晰地陈述您使用的任何中间关系，并将最终的 $\\Delta r$ 表示为包含 $B$、$c$ 和 $n_{g}$ 的单个解析表达式。无需进行数值计算。仅以解析表达式的形式表达您的最终结果。",
            "solution": "该问题要求使用O模微波反射计，计算等离子体中两个相邻截止层之间的最小可分辨径向距离 $\\Delta r$。推导将基于波传播和傅里叶分析的基本原理，并给定一组物理模型和假设。\n\n将径向距离与测量联系起来的基本关系是微波信号的飞行时间。信号从天线传播，在截止层反射，然后返回天线。在径向位置 $r_c$ 处反射的总往返时延 $\\tau$ 由群速度 $v_g$ 的倒数在双程路径上的积分给出：\n$$\n\\tau(r_c) = 2 \\int_{r_{\\text{antenna}}}^{r_c} \\frac{dr}{v_g(r)}\n$$\n问题陈述了我们可以做一个重要的简化：对于感兴趣的小径向区间，群速度可以近似为一个常数 $v_g \\approx c/n_g$，其中 $c$ 是真空中的光速，$n_g$ 是一个常数局域群折射率。在此假设下，传播介质实际上是无色散的，到位置 $r$（从天线处测量，$r_{\\text{antenna}}=0$）的层的往返时延简化为：\n$$\n\\tau(r) = \\frac{2r}{v_g} = \\frac{2r}{c/n_g} = \\frac{2 n_g r}{c}\n$$\n现在，考虑位于径向位置 $r_1$ 和 $r_2$ 的两个不同且相邻的截止层。设这些层之间的距离为 $\\Delta r = r_2 - r_1$。从这两层反射的信号的往返时延分别为 $\\tau_1 = 2 n_g r_1 / c$ 和 $\\tau_2 = 2 n_g r_2 / c$。时延的差值为：\n$$\n\\Delta \\tau = \\tau_2 - \\tau_1 = \\frac{2 n_g r_2}{c} - \\frac{2 n_g r_1}{c} = \\frac{2 n_g (r_2 - r_1)}{c} = \\frac{2 n_g \\Delta r}{c}\n$$\n根据这个关系，我们可以用时延差 $\\Delta \\tau$ 来表示径向距离 $\\Delta r$：\n$$\n\\Delta r = \\frac{c \\Delta \\tau}{2 n_g}\n$$\n问题现在简化为求最小可分辨时延 $\\Delta \\tau_{\\mathrm{min}}$。这个最小时间分辨率由探测信号的特性决定，特别是其带宽 $B$。根据要求，推导必须源于傅里叶分析的基本原理。\n\n信号处理的一个基本原理（源于傅里叶变换的性质）是，在时域中分辨特征的能力与信号在频域中的带宽成反比。为了将其形式化，我们考虑一个理想信号，其频谱内容在带宽 $B$（单位为赫兹）上均匀分布，而在其他地方为零。这种信号具有矩形频谱。对于基带信号，频谱 $S(f)$ 可以写成：\n$$\nS(f) = \\begin{cases} 1  |f| \\leq B/2 \\\\ 0  |f|  B/2 \\end{cases}\n$$\n相应的时域信号 $s(t)$ 由 $S(f)$ 的傅里叶逆变换给出：\n$$\ns(t) = \\int_{-\\infty}^{\\infty} S(f) \\exp(i 2 \\pi f t) df = \\int_{-B/2}^{B/2} \\exp(i 2 \\pi f t) df\n$$\n计算该积分得到：\n$$\ns(t) = \\left[ \\frac{\\exp(i 2 \\pi f t)}{i 2 \\pi t} \\right]_{-B/2}^{B/2} = \\frac{\\exp(i \\pi B t) - \\exp(-i \\pi B t)}{i 2 \\pi t} = \\frac{2i \\sin(\\pi B t)}{i 2 \\pi t} = B \\frac{\\sin(\\pi B t)}{\\pi B t}\n$$\n这个函数被称为sinc函数。由带宽 $B$ 所能形成的最短脉冲的时间形状是一个sinc脉冲。\n\n为了确定两个反射脉冲之间的最小可分辨时间间隔，我们应用瑞利判据。该判据指出，当一个脉冲的峰值与另一个脉冲的第一个零点（最小值）重合时，两个相同的脉冲恰好被分辨。脉冲 $s(t) \\propto \\sin(\\pi B t)/(\\pi B t)$ 的主峰出现在 $t=0$。当正弦函数的参数等于 $\\pm \\pi$ 时，出现第一个零点。因此，$\\pi B t = \\pm \\pi$，得到 $t = \\pm 1/B$。因此，从sinc脉冲的峰值到其第一个零点的时域距离是 $1/B$。\n\n根据瑞利判据，如果两个相隔时延 $\\Delta \\tau$ 的此类脉冲的间隔等于从峰值到第一个零点的距离，则它们是最小可分辨的。因此，最小可分辨时延为：\n$$\n\\Delta \\tau_{\\mathrm{min}} = \\frac{1}{B}\n$$\n这个结果 $\\Delta \\tau_{\\mathrm{min}} B = 1$ 是时间-带宽不确定性原理的一种体现。\n\n最后，我们将这个最小可分辨时延的表达式代入我们的径向距离方程中。从而得到最小可分辨径向距离 $\\Delta r$ 为：\n$$\n\\Delta r = \\frac{c \\Delta \\tau_{\\mathrm{min}}}{2 n_g} = \\frac{c}{2 n_g B}\n$$\n该表达式按要求从基本原理推导得出，提供了反射计空间分辨率与信号带宽 $B$、光速 $c$ 以及等离子体介质的有效群折射率 $n_g$ 之间的关系。",
            "answer": "$$\\boxed{\\frac{c}{2 n_{g} B}}$$"
        },
        {
            "introduction": "虽然简单的模型将反射视为一个瞬时事件，但波在截止点（或称转折点）的物理过程更为精细，它会引入一个关键的相移。本练习  要求你通过对比简化的WKB近似与更精确的基于艾里函数的全波分析，来量化这个相移。完成这个推导将让你深刻理解为什么在从测量的群延迟重建密度剖面时，必须考虑这个额外的 $\\pi/2$ 相移。",
            "id": "3709516",
            "problem": "一个一维垂直入射的寻常模 (O-模) 微波反射计探测一个磁化等离子体，其电子密度分布沿坐标 $x$ 单调递增，其中 $x=0$ 表示角频率为 $\\omega$ 的截止位置。将等离子体视为冷且无碰撞的，因此横向电场 $E(x)$ 满足从冷等离子体中的 Maxwell 方程组推导出的标量波动方程：\n$$\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0,$$\n其中\n$$k^{2}(x) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega_{p}^{2}(x)}{\\omega^{2}}\\right),\\quad \\omega_{p}^{2}(x) = \\frac{n_{e}(x)e^{2}}{\\varepsilon_{0} m_{e}},$$\n这里 $c$ 是光速，$e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数，$m_{e}$ 是电子质量。假设在截止点附近，等离子体频率的平方是局部线性的，\n$$\\omega_{p}^{2}(x) \\approx \\omega^{2} + \\frac{\\omega^{2}}{L_{n}}\\,x,$$\n密度标长 $L_{n}0$ 为常数，因此转折点位于 $x=0$ 处，振荡区为 $x0$，倏逝区为 $x0$。\n\n将振荡区中的前向和后向 Wentzel–Kramers–Brillouin (WKB) 波定义为\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\,\\exp\\!\\left(i\\int_{x}^{0}\\!k(s)\\,ds\\right) + A_{r}\\,\\exp\\!\\left(-i\\int_{x}^{0}\\!k(s)\\,ds\\right)\\right],$$\n指数相位中不包含额外的恒定相位偏移。复反射系数定义为 $R \\equiv A_{r}/A_{i}$。\n\n仅使用基本的波传播原理和单个转折点附近的渐近匹配：\n- 在一个实值、无损的转折点施加单位反射率且没有任何转折点相位偏移的假设下，推导反射系数 $R_{\\text{WKB}}$ 的领先阶 WKB 预测。\n- 独立地进行全波分析：通过适当的尺度变换将 $x=0$ 附近的局域波动方程简化为 Airy 方程，对 $x0$ 施加物理衰减条件，并使用大负自变量的渐近性与 $x0$ 的振荡 WKB 形式进行匹配。提取相应的全波反射系数 $R_{\\text{Airy}}$，其相位归一化方式与上述相同。\n- 对于中等梯度（有限的 $L_{n}$），通过计算振幅差 $\\Delta|R| \\equiv |R_{\\text{Airy}}| - |R_{\\text{WKB}}|$ 和相位差 $\\Delta\\phi \\equiv \\arg(R_{\\text{Airy}}) - \\arg(R_{\\text{WKB}})$ 来量化两种方法之间的差异。\n\n将最终答案表示为一个二分量行向量 $\\big[\\Delta|R|,\\ \\Delta\\phi\\big]$，其中 $\\Delta|R|$ 是无量纲的，$\\Delta\\phi$ 以弧度为单位。无需四舍五入；请提供精确结果。",
            "solution": "问题陈述已被验证，并被认为是波物理学中一个有效的、自洽的且有科学依据的问题。尽管描述性文本中关于“前向”和“后向”波的记法存在微小的模糊之处，但所提供的数学定义是明确且充分的，足以得出唯一解。我们将严格遵守所提供的数学定义。\n\n该问题要求在简化的 Wentzel–Kramers–Brillouin (WKB) 反射模型和使用 Airy 方程的全波分析之间进行比较。目标是计算从这两种方法推导出的反射系数在振幅和相位上的差异。\n\n首先，我们澄清反射系数的记法。问题将振荡区 ($x  0$) 中的 WKB 解定义为：\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\,\\exp\\!\\left(i\\int_{x}^{0}\\!k(s)\\,ds\\right) + A_{r}\\,\\exp\\!\\left(-i\\int_{x}^{0}\\!k(s)\\,ds\\right)\\right]$$\n为了确定哪一项对应入射波，哪一项对应反射波，我们分析相传播的方向。假设时间依赖关系为 $\\exp(-i\\omega t)$，则每一项的总相位为：\n1.  含有 $A_{i}$ 的项：相位是 $\\phi_{i}(x,t) = \\int_{x}^{0} k(s)\\,ds - \\omega t$。相速度为 $v_{p} = -\\frac{\\partial \\phi_{i}/\\partial t}{\\partial \\phi_{i}/\\partial x} = -\\frac{-\\omega}{-k(x)} = -\\frac{\\omega}{k(x)}$。由于当 $x  0$ 时 $k(x)0$，所以 $v_{p}0$。该波沿 $-x$ 方向传播，远离位于 $x=0$ 的截止点，因此是**反射波**。\n2.  含有 $A_{r}$ 的项：相位是 $\\phi_{r}(x,t) = -\\int_{x}^{0} k(s)\\,ds - \\omega t$。相速度为 $v_{p} = -\\frac{\\partial \\phi_{r}/\\partial t}{\\partial \\phi_{r}/\\partial x} = -\\frac{-\\omega}{k(x)} = \\frac{\\omega}{k(x)}$。由于当 $x  0$ 时 $k(x)0$，所以 $v_{p}0$。该波沿 $+x$ 方向传播，朝向位于 $x=0$ 的截止点，因此是**入射波**。\n\n因此，$A_{i}$ 是反射波的复振幅，$A_{r}$ 是入射波的复振幅。反射系数定义为 $R \\equiv A_{r}/A_{i}$。这是入射波振幅与反射波振幅之比，是标准反射系数定义的倒数。我们将按照问题给出的明确定义进行计算。\n\n**第 1 部分：WKB 预测 ($R_{\\text{WKB}}$)**\n\n问题指明了一个简化的 WKB 模型，其特征为“单位反射率且没有任何转折点相位偏移”。\n- “单位反射率”意味着入射波和反射波的振幅大小相等。用标准术语来说，即 $|A_{\\text{reflected}}|/|A_{\\text{incident}}| = 1$。在问题的记法中，这表示为 $|A_{i}|/|A_{r}| = 1$，这意味着 $|R_{\\text{WKB}}| = |A_{r}/A_{i}| = 1$。\n- “没有任何转折点相位偏移”被解释为反射过程在入射波和反射波之间不引入相位移动。在标准定义下，这意味着 $\\arg(A_{\\text{reflected}}/A_{\\text{incident}}) = 0$。在问题的记法中，这意味着 $\\arg(A_{i}/A_{r}) = 0$，所以 $\\arg(R_{\\text{WKB}}^{-1}) = 0$。这又意味着 $\\arg(R_{\\text{WKB}}) = 0$。\n\n结合这两个假设，我们得到：\n$$R_{\\text{WKB}} = |R_{\\text{WKB}}|\\exp(i \\arg(R_{\\text{WKB}})) = 1 \\cdot \\exp(i \\cdot 0) = 1$$\n因此，有 $|R_{\\text{WKB}}| = 1$ 且 $\\arg(R_{\\text{WKB}}) = 0$。\n\n**第 2 部分：全波分析 ($R_{\\text{Airy}}$)**\n\n我们现在在截止点 $x=0$ 附近进行全波分析。波动方程为 $\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0$。在 $x=0$ 附近，使用给定的 $\\omega_{p}^{2}(x)$ 线性分布来近似波数的平方 $k^{2}(x)$：\n$$k^{2}(x) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega_{p}^{2}(x)}{\\omega^{2}}\\right) \\approx \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega^{2} + \\frac{\\omega^{2}}{L_{n}}x}{\\omega^{2}}\\right) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - 1 - \\frac{x}{L_{n}}\\right) = -\\frac{\\omega^{2}}{c^{2}L_{n}}x$$\n波动方程变为：\n$$\\frac{d^{2}E}{dx^{2}} - \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)x E = 0$$\n这是 Airy 方程的一种形式。为了将其化为标准形式 $y''(z) - z y(z) = 0$，我们引入变量替换 $z = \\alpha x$。导数变换为 $\\frac{d}{dx} = \\alpha\\frac{d}{dz}$ 和 $\\frac{d^{2}}{dx^{2}} = \\alpha^{2}\\frac{d^{2}}{dz^{2}}$。代入波动方程得到：\n$$\\alpha^{2}\\frac{d^{2}E}{dz^{2}} - \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)\\frac{z}{\\alpha} E = 0 \\implies \\frac{d^{2}E}{dz^{2}} - \\left(\\frac{\\omega^{2}}{\\alpha^{3}c^{2}L_{n}}\\right)z E = 0$$\n我们要求 $zE$ 项的系数为 1，因此 $\\frac{\\omega^{2}}{\\alpha^{3}c^{2}L_{n}} = 1$，从而得出尺度因子：\n$$\\alpha = \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)^{1/3}$$\nAiry 方程的通解是第一类和第二类 Airy 函数 $Ai(z)$ 和 $Bi(z)$ 的线性组合。对于 $x0$，我们有 $z0$。物理条件是波在倏逝区 ($x0$) 必须衰减。由于当 $z \\to \\infty$ 时，$Ai(z)$ 指数衰减，而 $Bi(z)$ 指数增长，因此物理上合理的解必须与 $Ai(z)$ 成正比。\n$$E(x) = C \\cdot Ai(z) = C \\cdot Ai\\left( \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)^{1/3} x \\right)$$\n为了求得反射系数，我们将此解在大负自变量 ($z \\to -\\infty$，对应于 $x  0$) 下的渐近形式与 WKB 形式进行匹配。当 $z  0$ 时，$Ai(z)$ 的渐近展开式为：\n$$Ai(z) \\sim \\frac{1}{\\sqrt{\\pi}(-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right)$$\n我们现在用 WKB 相位积分 $\\Phi(x) = \\int_{x}^{0} k(s)\\,ds$ 来表示正弦函数的自变量。对于 $x  0$，$k(s) = \\sqrt{-\\frac{\\omega^{2}}{c^{2}L_{n}}s} = \\alpha^{3/2}\\sqrt{-s}$。\n$$\\Phi(x) = \\int_{x}^{0} \\alpha^{3/2}\\sqrt{-s}\\,ds = \\alpha^{3/2} \\left[-\\frac{2}{3}(-s)^{3/2}\\right]_{x}^{0} = \\frac{2}{3}\\alpha^{3/2}(-x)^{3/2} = \\frac{2}{3}(-\\alpha x)^{3/2} = \\frac{2}{3}(-z)^{3/2}$$\nWKB 解中的振幅因子 $1/\\sqrt{k(x)}$ 也可以与 $z$ 关联：$\\sqrt{k(x)} = (\\alpha^{3/2}\\sqrt{-x})^{1/2} = \\alpha^{3/4}(-x)^{1/4} = \\alpha^{1/2}(-\\alpha x)^{1/4} = \\alpha^{1/2}(-z)^{1/4}$。 因此，$1/\\sqrt{k(x)} \\propto 1/(-z)^{1/4}$。振幅依赖关系相匹配。\n我们现在使用复指数重写正弦函数，以匹配 WKB 形式：\n$$\\sin\\left(\\Phi(x) + \\frac{\\pi}{4}\\right) = \\frac{1}{2i}\\left[\\exp\\left(i\\Phi(x) + i\\frac{\\pi}{4}\\right) - \\exp\\left(-i\\Phi(x) - i\\frac{\\pi}{4}\\right)\\right]$$\n$$= \\frac{1}{2i}\\left[e^{i\\pi/4}\\exp(i\\Phi(x)) - e^{-i\\pi/4}\\exp(-i\\Phi(x))\\right]$$\n因此，$E(x)$ 的渐近解与以下表达式成正比：\n$$E(x) \\propto \\frac{1}{\\sqrt{k(x)}} \\left[ e^{i\\pi/4}\\exp\\left(i\\int_{x}^{0}k(s)ds\\right) - e^{-i\\pi/4}\\exp\\left(-i\\int_{x}^{0}k(s)ds\\right) \\right]$$\n我们将其与问题给出的 WKB 形式进行匹配：\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\exp\\left(i\\int_{x}^{0}k(s)ds\\right) + A_{r}\\exp\\left(-i\\int_{x}^{0}k(s)ds\\right) \\right]$$\n通过比较相应指数项的系数，我们发现：\n$$A_{i} \\propto e^{i\\pi/4}$$\n$$A_{r} \\propto -e^{-i\\pi/4}$$\n全波反射系数 $R_{\\text{Airy}}$ 是 $A_{r}/A_{i}$ 之比：\n$$R_{\\text{Airy}} = \\frac{-e^{-i\\pi/4}}{e^{i\\pi/4}} = -e^{-i\\pi/2} = -(-i) = i$$\n所以，从全波分析中，我们得到 $R_{\\text{Airy}} = i$。其模和相位为：\n$$|R_{\\text{Airy}}| = |i| = 1$$\n$$\\arg(R_{\\text{Airy}}) = \\arg(i) = \\frac{\\pi}{2}$$\n这个结果表明，从线性密度分布反射会在标准反射系数中引入 $\\pi/2$ 的相移，这对应于非标准定义的系数 $R$ 的相位为 $\\pi/2$。\n\n**第 3 部分：量化差异**\n\n最后，我们计算全波 (Airy) 结果与简化 WKB 结果之间所要求的差异。\n振幅差为：\n$$\\Delta|R| = |R_{\\text{Airy}}| - |R_{\\text{WKB}}| = 1 - 1 = 0$$\n相位差为：\n$$\\Delta\\phi = \\arg(R_{\\text{Airy}}) - \\arg(R_{\\text{WKB}}) = \\frac{\\pi}{2} - 0 = \\frac{\\pi}{2}$$\n差异完全在于相位。简化的 WKB 模型未能捕捉到从连续势垒反射时发生的 $\\pi/2$ 相移，这是 WKB 连接公式的一个众所周知的结果。\n\n最终答案表示为二分量行向量 $[\\Delta|R|, \\Delta\\phi]$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论知识最终要应用于解决实际问题。这个计算练习  将理论付诸实践，要求你为一个具有真实感剖面的托卡马克等离子体编写程序，计算X模微波的截止位置。你不仅需要应用截止条件公式，还将通过计算发现并分析由磁场空间变化引起的非单调截止频率剖面——这是在实际反射计数据反演中必须面对的一个重要复杂情况。",
            "id": "3709550",
            "problem": "给定一个磁化的环形约束等离子体，要求计算从入射微波频率到垂直入射的非寻常模 (X-mode) 截止位置的径向映射关系，并从第一性原理出发，论证空间变化的电子回旋角频率如何在该映射关系中引入非单调行为。该任务必须根据冷等离子体波传播理论进行形式化，并以一个完整的、可运行的程序执行。\n\n等离子体、几何形状和剖面参数指定如下：\n- 小半径为 $a = 0.6$ 米。\n- 大半径为 $R_0 = 1.7$ 米。\n- 环向磁场强度剖面为 $B(r) = B_0 \\, \\dfrac{R_0}{R_0 + r}$，其中 $B_0 = 5.0$ 特斯拉，且 $r \\in [0,a]$ 单位为米。\n- 电子数密度剖面为 $n_e(r) = n_{\\text{edge}} + \\left(n_0 - n_{\\text{edge}}\\right) \\left(1 - \\left(\\dfrac{r}{a}\\right)^2\\right)^{\\alpha}$，其中 $n_0 = 2.0 \\times 10^{20}$ $\\text{m}^{-3}$，$n_{\\text{edge}} = 0.2 \\times 10^{20}$ $\\text{m}^{-3}$，且 $\\alpha = 1.5$。\n\n所有波均严格垂直于磁场入射和传播。分析必须从线性介质中的麦克斯韦方程组，结合磁化电子流体的冷等离子体介电响应开始。定义并使用电子等离子体角频率 $\\omega_{pe}(r) = \\sqrt{\\dfrac{n_e(r) e^2}{\\varepsilon_0 m_e}}$ 和电子回旋角频率 $\\omega_{ce}(r) = \\dfrac{e B(r)}{m_e}$，其中 $e$ 是基本电荷，$m_e$ 是电子质量，$\\varepsilon_0$ 是真空介电常数。您必须从这些基本原理和适用于垂直传播的非寻常模色散关系出发，推导出决定给定入射角频率 $\\omega = 2\\pi f$ 下径向截止位置的条件。然后，使用推导出的条件，计算映射关系 $f \\mapsto r_c(f)$，其中 $r_c(f)$ 表示 X 模发生截止的半径集合。如果存在多个分支或多个解，您必须包含所有截止半径。\n\n您的推导过程不得依赖于预先给出的非寻常模截止的最终公式。请从第一性原理推导色散关系和截止条件。您需要明确指出 $\\omega_{ce}(r)$ 的空间变化如何能够在映射 $f \\mapsto r_c(f)$ 中产生非单调行为，包括该映射可能失去单调性或产生模糊反演结果的条件。\n\n使用的常量（国际单位制）如下：$e = 1.602176634 \\times 10^{-19}$ 库仑，$m_e = 9.1093837015 \\times 10^{-31}$ 千克，以及 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}$ 法拉每米。\n\n实现一个算法，对于每个指定频率，在 $r \\in [0,a]$ 范围内搜索所有满足 X 模截止条件的半径。可以使用数值求根方法，且该方法必须对零解、单解或多解的情况具有鲁棒性。将所有返回的截止半径以米为单位表示，并四舍五入到四位小数。\n\n测试套件：\n- 频率（单位赫兹）：$f \\in \\{40 \\times 10^{9},\\, 55 \\times 10^{9},\\, 80 \\times 10^{9},\\, 150 \\times 10^{9},\\, 220 \\times 10^{9}\\}$。\n- 选择这些测试用例是为了包含：一个低频情况，其截止可能需要高密度；一个近边界情况，其中较低的非寻常分支可能随频率表现出非单调行为；一个较高非寻常分支密度要求的临界情况；以及较高非寻常分支占主导地位的较高频率情况。\n\n您的程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个元素对应一个测试频率（按上述顺序），且必须是该频率下的截止半径列表（以米为单位，四舍五入到四位小数），该列表合并了所有存在的 X 模分支并按升序排序。例如，正确格式的输出形如 $[[r_{1,1}, r_{1,2}, \\dots],[r_{2,1},\\dots],\\dots]$。如果给定频率不存在截止，则为该频率输出一个空列表。半径的最终输出单位必须是米，并四舍五入到四位小数。",
            "solution": "经评估，此问题是有效的，因为其科学基础扎根于冷等离子体物理学，定义了所有必要参数，问题提法是适定的，且其表述客观。它代表了磁化等离子体中波传播研究领域一个标准的、尽管不平凡的问题。\n\n### 从第一性原理推导\n\n分析始于线性、无源介质中的麦克斯韦方程组，假设所有场都具有 $e^{-i\\omega t}$ 形式的谐波时间依赖性。等离子体中电场 $\\mathbf{E}$ 的波动方程推导如下：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E}\n$$\n其中 $\\omega$ 是波的角频率，$c$ 是真空中的光速，$\\mathbf{K}$ 是等离子体的相对介电张量。假设一个 $\\mathbf{E} \\propto e^{i\\mathbf{k} \\cdot \\mathbf{r}}$ 形式的平面波解，其中 $\\mathbf{k}$ 是波矢，波动方程变为一个代数方程：\n$$\n\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0\n$$\n引入折射率 $N = kc/\\omega$，上式简化为：\n$$\n\\left( \\mathbf{K} - N^2 \\mathbf{I} + N^2 \\frac{\\mathbf{k}\\mathbf{k}}{k^2} \\right) \\cdot \\mathbf{E} = 0\n$$\n为使 $\\mathbf{E}$ 存在非平庸解，该矩阵的行列式必须为零。此条件给出了等离子体中波的色散关系。\n\n对于背景磁场 $\\mathbf{B}$ 与 z 轴平行的冷磁化等离子体，其介电张量 $\\mathbf{K}$ 由下式给出：\n$$\n\\mathbf{K} = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\n分量 $S$、$D$ 和 $P$ 是 Stix 参数，由电子等离子体频率 $\\omega_{pe}(r) = \\sqrt{n_e(r) e^2 / (\\varepsilon_0 m_e)}$ 和电子回旋频率 $\\omega_{ce}(r) = e B(r) / m_e$ 定义：\n$$\nS = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} \\quad, \\quad D = \\frac{\\omega_{ce}\\omega_{pe}^2}{\\omega(\\omega^2 - \\omega_{ce}^2)} \\quad, \\quad P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2}\n$$\n问题指定传播严格垂直于磁场。我们可以将 $\\mathbf{k}$ 设在 x 轴方向，即 $\\mathbf{k} = k\\mathbf{\\hat{x}}$。波动方程的行列式条件分裂成两种独立的模式。一种是寻常模 (O-mode)，其色散关系为 $N^2 = P$，这不是我们在此关注的。另一种是非寻常模 (X-mode)，其色散关系为：\n$$\nN_X^2 = \\frac{S^2 - D^2}{S}\n$$\n波的截止定义为折射率 $N$ 变为零的位置，此时波被反射。对于 X 模，$N_X^2 = 0$ 意味着分子 $S^2-D^2$ 必须为零（假设 $S \\neq 0$，这对应于一个共振）。\n将分子因式分解为 $(S-D)(S+D) = 0$，我们得到两个不同的截止条件：\n1.  **右旋 (R) 截止：** $S-D = 0 \\implies 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega - \\omega_{ce})} = 0$。重新整理得到 $\\omega^2 - \\omega \\omega_{ce}(r_c) - \\omega_{pe}^2(r_c) = 0$。这对应于入射频率 $\\omega$ 等于局域“右旋”截止频率 $\\omega_R(r_c) = \\frac{1}{2}\\left(\\omega_{ce}(r_c) + \\sqrt{\\omega_{ce}(r_c)^2 + 4\\omega_{pe}^2(r_c)}\\right)$。\n2.  **左旋 (L) 截止：** $S+D = 0 \\implies 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + \\omega_{ce})} = 0$。重新整理得到 $\\omega^2 + \\omega \\omega_{ce}(r_c) - \\omega_{pe}^2(r_c) = 0$。这对应于 $\\omega$ 等于局域“左旋”截止频率 $\\omega_L(r_c) = \\frac{1}{2}\\left(-\\omega_{ce}(r_c) + \\sqrt{\\omega_{ce}(r_c)^2 + 4\\omega_{pe}^2(r_c)}\\right)$。\n\n### 非单调性分析\n\n问题要求解释从频率到截止半径的映射 $f \\mapsto r_c(f)$ 如何变得非单调。此行为由截止频率 $\\omega_L(r)$ 和 $\\omega_R(r)$ 的空间剖面决定。\n\n关键等离子体参数，即磁场 $B(r)$ 和电子密度 $n_e(r)$，在 $r \\in [0, a]$ 范围内都是小半径 $r$ 的单调递减函数。因此，它们对应的特征频率 $\\omega_{ce}(r)$ 和 $\\omega_{pe}(r)$ 也随 $r$ 单调递减。\n\n右旋截止频率 $\\omega_R(r)$ 是各项之和，而这些项都随 $r$ 单调递减，因此它本身也是一个单调递减函数。因此，对于在 $\\omega_R(r)$ 范围内的任何给定入射频率 $\\omega$，该分支将恰好有一个截止半径 $r_c$。\n\n左旋截止频率 $\\omega_L(r)$ 包含一个差值。它关于 $r$ 的导数是：\n$$\n\\frac{d\\omega_L}{dr} = \\frac{1}{2} \\left( -\\frac{d\\omega_{ce}}{dr} + \\frac{\\omega_{ce}\\frac{d\\omega_{ce}}{dr} + 2\\frac{d(\\omega_{pe}^2)}{dr}}{\\sqrt{\\omega_{ce}^2 + 4\\omega_{pe}^2}} \\right)\n$$\n由于 $\\frac{d\\omega_{ce}}{dr}  0$ 和 $\\frac{d(\\omega_{pe}^2)}{dr}  0$，$-\\frac{d\\omega_{ce}}{dr}$ 项为正，而分数项为负。$\\frac{d\\omega_L}{dr}$ 的符号取决于这两项之间的竞争。正项源于磁场的衰减，而负项由密度和磁场的共同衰减驱动。这种竞争可能导致 $\\omega_L(r)$ 剖面非单调；它可能有一个局域极大值。如果一个入射频率 $\\omega$ 低于此最大值但高于边界处（$r=0$ 或 $r=a$）的值，就可能存在两个不同的径向位置使得 $\\omega = \\omega_L(r)$，从而导致两个截止点。这使得 L 分支的反演 $f \\mapsto r_c(f)$ 变得模糊不清，这对于旨在测量密度剖面的反射计诊断来说是一个关键特征。\n\n### 算法设计\n\n为计算映射 $f \\mapsto r_c(f)$，我们必须为每个给定频率 $f$ 求解两个截止条件方程的根：\n$G_R(r, \\omega) = \\omega^2 - \\omega \\omega_{ce}(r) - \\omega_{pe}^2(r) = 0$\n$G_L(r, \\omega) = \\omega^2 + \\omega \\omega_{ce}(r) - \\omega_{pe}^2(r) = 0$\n其中 $\\omega = 2\\pi f$。\n\n算法如下：\n1.  对于每个输入频率 $f_{test}$，计算对应的角频率 $\\omega$。\n2.  为了在定义域 $r \\in [0, a]$ 内鲁棒地找到所有根，我们将此区间离散化为大量子区间。\n3.  对于每个子区间，我们检查 $G_R(r, \\omega)$ 和 $G_L(r, \\omega)$ 是否存在符号变化。\n4.  如果在子区间 $[r_i, r_{i+1}]$ 内检测到符号变化，则在该区间上使用数值求根算法（例如 Brent 方法）来找到精确的根。\n5.  收集找到的所有 $G_R$ 和 $G_L$ 的根。\n6.  将收集到的根列表按升序排序并四舍五入到指定精度。这就得出了给定频率的所有截止半径集合。\n对所有测试频率重复此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\nfrom scipy.constants import e, m_e, epsilon_0, pi\n\ndef solve():\n    \"\"\"\n    Computes the extraordinary mode (X-mode) cutoff radii for given microwave\n    frequencies in a model tokamak plasma.\n    \"\"\"\n    \n    # Define plasma and geometry parameters from the problem statement\n    a = 0.6  # Minor radius in meters\n    R0 = 1.7  # Major radius in meters\n    B0 = 5.0  # Magnetic field on-axis in Tesla\n    n0 = 2.0e20  # Central electron density in m^-3\n    n_edge = 0.2e20  # Edge electron density in m^-3\n    alpha = 1.5  # Density profile shape parameter\n\n    # Define the test frequencies in Hertz\n    test_cases = [40e9, 55e9, 80e9, 150e9, 220e9]\n    \n    # Pre-calculate physical constant ratios for efficiency\n    e_over_me = e / m_e\n    e2_over_eps0_me = e**2 / (epsilon_0 * m_e)\n\n    def B_field(r):\n        \"\"\"Calculates the toroidal magnetic field strength at minor radius r.\"\"\"\n        return B0 * R0 / (R0 + r)\n\n    def n_electron(r):\n        \"\"\"Calculates the electron number density at minor radius r.\"\"\"\n        # This vectorized version handles both scalar and array inputs for r\n        # and correctly handles r > a by clipping the base of the power.\n        term_base = 1 - (np.asanyarray(r) / a)**2\n        if isinstance(term_base, np.ndarray):\n            term_base[term_base  0] = 0\n        elif term_base  0:\n            term_base = 0\n            \n        return n_edge + (n0 - n_edge) * term_base**alpha\n\n    def omega_ce(r):\n        \"\"\"Calculates the electron cyclotron angular frequency.\"\"\"\n        return e_over_me * B_field(r)\n\n    def omega_pe_sq(r):\n        \"\"\"Calculates the square of the electron plasma angular frequency.\"\"\"\n        return e2_over_eps0_me * n_electron(r)\n\n    # --- Cutoff condition functions G(r) = 0 ---\n    # G_R corresponds to the Right-hand cutoff (upper branch): w^2 - w*w_ce - w_pe^2 = 0\n    def G_R(r, omega):\n        return omega**2 - omega * omega_ce(r) - omega_pe_sq(r)\n\n    # G_L corresponds to the Left-hand cutoff (lower branch): w^2 + w*w_ce - w_pe^2 = 0\n    def G_L(r, omega):\n        return omega**2 + omega * omega_ce(r) - omega_pe_sq(r)\n\n    def find_all_roots(func, omega, r_min=0., r_max=a, num_points=10000):\n        \"\"\"\n        Finds all roots of `func(r, omega) = 0` in the interval [r_min, r_max].\n        \"\"\"\n        r_grid = np.linspace(r_min, r_max, num_points)\n        f_vals = func(r_grid, omega)\n        \n        roots = []\n        for i in range(num_points - 1):\n            # A root exists if the function crosses the axis\n            if np.sign(f_vals[i]) != np.sign(f_vals[i+1]):\n                try:\n                    root = optimize.brentq(func, r_grid[i], r_grid[i+1], args=(omega,))\n                    roots.append(root)\n                except ValueError:\n                    # This should not be reached due to the np.sign check,\n                    # but serves as a safeguard.\n                    pass\n        \n        # Check if a root is exactly at a grid point (can be missed by sign change)\n        # We only need to check at the start of intervals, as the end is the next start\n        if np.isclose(f_vals[0], 0):\n            roots.append(r_grid[0])\n        # And finally check the last point of the domain\n        if np.isclose(f_vals[-1], 0):\n            roots.append(r_grid[-1])\n\n        # Return a sorted list of unique roots\n        return sorted(list(set(roots)))\n\n    results = []\n    for f_hz in test_cases:\n        omega_val = 2 * pi * f_hz\n        \n        # Find roots for both R and L cutoff branches\n        roots_R_branch = find_all_roots(G_R, omega_val)\n        roots_L_branch = find_all_roots(G_L, omega_val)\n        \n        all_roots = sorted(roots_R_branch + roots_L_branch)\n        \n        # Round roots to four decimal places as required\n        rounded_roots = [round(r, 4) for r in all_roots]\n        \n        results.append(rounded_roots)\n\n    # Format the final output string to exactly match the problem specification\n    # e.g., [[r1.1,r1.2],[r2.1],[],...]\n    inner_parts = []\n    for r_list in results:\n        inner_parts.append(f\"[{','.join(map(str, r_list))}]\")\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}