{
    "hands_on_practices": [
        {
            "introduction": "The performance of any soft X-ray diagnostic critically depends on the transmission characteristics of its filters. In practice, these filters are not ideal and can degrade over time due to surface contamination, such as the formation of native oxide layers. This practice  guides you through modeling this degradation, showing how contaminant absorption edges can introduce unwanted features into your instrument's response function and reduce overall throughput.",
            "id": "3719085",
            "problem": "Soft X-ray (SXR) diagnostics for magnetically confined nuclear fusion plasmas commonly use thin-film aluminum filters to transmit photons in the band $E \\sim 0.3$–$0.6\\,\\mathrm{keV}$ while blocking longer-wavelength light. Realistic filters are subject to surface contamination by carbonaceous films and to native oxidation forming aluminum oxide. Starting from first principles, derive how contamination layers of carbon and oxygen alter the filter transmission near the carbon and oxygen K-edges, and then estimate the performance degradation at the oxygen K-edge caused by a native oxide layer.\n\nBegin with the Beer–Lambert law for photon attenuation in matter. Treat the filter stack as a sequence of homogeneous layers and neglect scattering, interference, and reflection, so that the total transmission $T(E)$ at photon energy $E$ is given by the product of transmissions of each layer. Define the performance degradation factor $\\mathcal{D}(E)$ to be the ratio of the filter transmission with contamination to the transmission of the bare aluminum substrate, i.e., $\\mathcal{D}(E) = T_{\\mathrm{with\\,contamination}}(E)/T_{\\mathrm{bare\\,Al}}(E)$.\n\nDerive an analytic expression for $\\mathcal{D}(E)$ for a layered system comprising a carbon contamination film of thickness $t_{\\mathrm{C}}$ and a native aluminum oxide overlayer of thickness $t_{\\mathrm{ox}}$. Use the rule for mixtures that the mass attenuation coefficient of aluminum oxide satisfies $(\\mu/\\rho)_{\\mathrm{Al_2O_3}}(E) = w_{\\mathrm{Al}}\\,(\\mu/\\rho)_{\\mathrm{Al}}(E) + w_{\\mathrm{O}}\\,(\\mu/\\rho)_{\\mathrm{O}}(E)$, where $w_{\\mathrm{Al}}$ and $w_{\\mathrm{O}}$ are the respective mass fractions in $\\mathrm{Al_2O_3}$. Show how the presence of carbon and oxygen overlayers produces transmission edge features at the carbon K-edge, $E_{\\mathrm{C}} \\approx 0.284\\,\\mathrm{keV}$, and the oxygen K-edge, $E_{\\mathrm{O}} \\approx 0.532\\,\\mathrm{keV}$.\n\nThen, estimate the performance degradation at $E = 0.53\\,\\mathrm{keV}$ due to a native oxide layer of thickness $t_{\\mathrm{ox}} = 10\\,\\mathrm{nm}$ on aluminum, assuming no carbon contamination (i.e., set $t_{\\mathrm{C}} = 0$ for the numerical estimate). Use the following data, representative of the oxygen K-edge region:\n- Aluminum atomic mass $M_{\\mathrm{Al}} = 27$, oxygen atomic mass $M_{\\mathrm{O}} = 16$, aluminum oxide density $\\rho_{\\mathrm{Al_2O_3}} = 3.95\\,\\mathrm{g\\,cm^{-3}}$.\n- Mass attenuation coefficients at $E = 0.53\\,\\mathrm{keV}$: $(\\mu/\\rho)_{\\mathrm{Al}}(0.53\\,\\mathrm{keV}) = 2.0 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}$, $(\\mu/\\rho)_{\\mathrm{O}}(0.53\\,\\mathrm{keV}) = 3.5 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}$.\n- For context in the derivation, a representative value near the carbon K-edge is $(\\mu/\\rho)_{\\mathrm{C}}(0.30\\,\\mathrm{keV}) = 6.0 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}$.\n\nExpress $\\mathcal{D}(0.53\\,\\mathrm{keV})$ as a unitless decimal fraction and round your final numerical result to three significant figures.",
            "solution": "The problem requires the derivation of a performance degradation factor for a soft X-ray filter and a subsequent numerical estimation. The derivation begins from the Beer–Lambert law, which describes the attenuation of light passing through a medium.\n\nThe Beer–Lambert law states that the transmission $T$ of photons of energy $E$ through a homogeneous layer of thickness $t$ is given by $T(E) = \\exp(-\\mu(E) t)$, where $\\mu(E)$ is the linear attenuation coefficient. This coefficient is related to the material's density $\\rho$ and its mass attenuation coefficient $(\\mu/\\rho)(E)$ by $\\mu(E) = (\\mu/\\rho)(E) \\rho$. Thus, the transmission can be written as:\n$$T(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)(E) \\rho t \\right)$$\n\nFirst, we consider the ideal case of a bare aluminum filter of thickness $t_{\\mathrm{Al}}$. Its transmission, $T_{\\mathrm{bare\\,Al}}(E)$, is:\n$$T_{\\mathrm{bare\\,Al}}(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} \\right)$$\n\nNext, we model the contaminated filter. It consists of the aluminum substrate of thickness $t_{\\mathrm{Al}}$, an overlayer of aluminum oxide ($\\mathrm{Al_2O_3}$) of thickness $t_{\\mathrm{ox}}$, and a surface contamination layer of carbon (C) of thickness $t_{\\mathrm{C}}$. The problem states to neglect scattering, interference, and reflection, so the total transmission is the product of the transmissions through each layer:\n$$T_{\\mathrm{with\\,contamination}}(E) = T_{\\mathrm{C}}(E) \\cdot T_{\\mathrm{Al_2O_3}}(E) \\cdot T_{\\mathrm{Al}}(E)$$\nThe individual transmission terms are:\n$$T_{\\mathrm{C}}(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{C}}(E) \\rho_{\\mathrm{C}} t_{\\mathrm{C}} \\right)$$\n$$T_{\\mathrm{Al_2O_3}}(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}}(E) \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}} \\right)$$\n$$T_{\\mathrm{Al}}(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} \\right)$$\nCombining these, the total transmission for the contaminated filter is:\n$$T_{\\mathrm{with\\,contamination}}(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{C}}(E) \\rho_{\\mathrm{C}} t_{\\mathrm{C}} \\right) \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}}(E) \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}} \\right) \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} \\right)$$\n\nThe performance degradation factor $\\mathcal{D}(E)$ is defined as the ratio of the transmission with contamination to the transmission of the bare aluminum substrate:\n$$\\mathcal{D}(E) = \\frac{T_{\\mathrm{with\\,contamination}}(E)}{T_{\\mathrm{bare\\,Al}}(E)}$$\nSubstituting the expressions derived above:\n$$\\mathcal{D}(E) = \\frac{\\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{C}}(E) \\rho_{\\mathrm{C}} t_{\\mathrm{C}} - \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}}(E) \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}} - \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} \\right)}{\\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} \\right)}$$\nThe term corresponding to the aluminum substrate cancels, yielding a general expression for the degradation factor that depends only on the properties of the contaminant layers:\n$$\\mathcal{D}(E) = \\exp\\left( -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{C}}(E) \\rho_{\\mathrm{C}} t_{\\mathrm{C}} - \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}}(E) \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}} \\right)$$\n\nThe problem provides a mixture rule for the mass attenuation coefficient of aluminum oxide:\n$$\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}}(E) = w_{\\mathrm{Al}}\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) + w_{\\mathrm{O}}\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{O}}(E)$$\nwhere $w_{\\mathrm{Al}}$ and $w_{\\mathrm{O}}$ are the mass fractions of aluminum and oxygen in $\\mathrm{Al_2O_3}$. Substituting this into the expression for $\\mathcal{D}(E)$ gives the full requested analytical expression:\n$$\\mathcal{D}(E) = \\exp\\left[ -\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{C}}(E) \\rho_{\\mathrm{C}} t_{\\mathrm{C}} - \\left( w_{\\mathrm{Al}}\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) + w_{\\mathrm{O}}\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{O}}(E) \\right) \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}} \\right]$$\n\nThe presence of carbon and oxygen overlayers produces transmission edge features. The mass attenuation coefficient of an element, e.g., $(\\mu/\\rho)_{\\mathrm{X}}(E)$, increases abruptly as the photon energy $E$ crosses an absorption edge energy, such as a K-edge $E_{\\mathrm{K}}$.\n- At the carbon K-edge ($E_{\\mathrm{C}} \\approx 0.284\\,\\mathrm{keV}$), $(\\mu/\\rho)_{\\mathrm{C}}(E)$ jumps to a much higher value. This causes the exponent in the expression for $\\mathcal{D}(E)$ to become more negative, resulting in a sudden drop in transmission. This feature is present only if $t_{\\mathrm{C}} > 0$.\n- Similarly, at the oxygen K-edge ($E_{\\mathrm{O}} \\approx 0.532\\,\\mathrm{keV}$), $(\\mu/\\rho)_{\\mathrm{O}}(E)$ jumps. This increases the magnitude of the term $-w_{\\mathrm{O}}(\\mu/\\rho)_{\\mathrm{O}}(E)\\rho_{\\mathrm{Al_2O_3}}t_{\\mathrm{ox}}$ in the exponent, causing another sudden drop in transmission. This feature is present if $t_{\\mathrm{ox}} > 0$. Thus, the contamination layers introduce their own characteristic absorption edges into the filter's transmission profile.\n\nNow, we estimate the performance degradation at $E = 0.53\\,\\mathrm{keV}$ due to a native oxide layer of thickness $t_{\\mathrm{ox}} = 10\\,\\mathrm{nm}$, with no carbon contamination ($t_{\\mathrm{C}} = 0$).\nWith $t_{\\mathrm{C}} = 0$, the degradation factor simplifies to:\n$$\\mathcal{D}(E) = \\exp\\left[ - \\left( w_{\\mathrm{Al}}\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) + w_{\\mathrm{O}}\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{O}}(E) \\right) \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}} \\right]$$\n\nFirst, we calculate the mass fractions $w_{\\mathrm{Al}}$ and $w_{\\mathrm{O}}$ in $\\mathrm{Al_2O_3}$. Using the given atomic masses $M_{\\mathrm{Al}} = 27$ and $M_{\\mathrm{O}} = 16$:\nMolar mass of $\\mathrm{Al_2O_3}$ is $M_{\\mathrm{Al_2O_3}} = 2 \\times M_{\\mathrm{Al}} + 3 \\times M_{\\mathrm{O}} = 2 \\times 27 + 3 \\times 16 = 54 + 48 = 102$.\n$$w_{\\mathrm{Al}} = \\frac{2 M_{\\mathrm{Al}}}{M_{\\mathrm{Al_2O_3}}} = \\frac{54}{102}$$\n$$w_{\\mathrm{O}} = \\frac{3 M_{\\mathrm{O}}}{M_{\\mathrm{Al_2O_3}}} = \\frac{48}{102}$$\n\nNext, we calculate the effective mass attenuation coefficient of $\\mathrm{Al_2O_3}$ at $E = 0.53\\,\\mathrm{keV}$ using the provided data: $(\\mu/\\rho)_{\\mathrm{Al}}(0.53\\,\\mathrm{keV}) = 2.0 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}$ and $(\\mu/\\rho)_{\\mathrm{O}}(0.53\\,\\mathrm{keV}) = 3.5 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}$.\n$$\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}} = \\left(\\frac{54}{102}\\right)(2.0 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}) + \\left(\\frac{48}{102}\\right)(3.5 \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}})$$\n$$\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}} = \\frac{1}{102} \\left[ (54 \\times 2.0) + (48 \\times 3.5) \\right] \\times 10^{4} \\,\\mathrm{cm^{2}\\,g^{-1}}$$\n$$\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al_2O_3}} = \\frac{108 + 168}{102} \\times 10^{4} \\,\\mathrm{cm^{2}\\,g^{-1}} = \\frac{276}{102} \\times 10^{4} \\,\\mathrm{cm^{2}\\,g^{-1}}$$\nNumerically, $\\frac{276}{102} \\approx 2.70588$.\n\nThe argument of the exponential, which we denote as $X$, is $-(\\mu/\\rho)_{\\mathrm{Al_2O_3}} \\rho_{\\mathrm{Al_2O_3}} t_{\\mathrm{ox}}$. We use the given values $\\rho_{\\mathrm{Al_2O_3}} = 3.95\\,\\mathrm{g\\,cm^{-3}}$ and $t_{\\mathrm{ox}} = 10\\,\\mathrm{nm} = 10 \\times 10^{-7}\\,\\mathrm{cm} = 1.0 \\times 10^{-6}\\,\\mathrm{cm}$.\n$$X = - \\left(\\frac{276}{102} \\times 10^{4}\\,\\mathrm{cm^{2}\\,g^{-1}}\\right) (3.95\\,\\mathrm{g\\,cm^{-3}}) (1.0 \\times 10^{-6}\\,\\mathrm{cm})$$\nUnits check: $(\\mathrm{cm^{2}\\,g^{-1}}) \\times (\\mathrm{g\\,cm^{-3}}) \\times (\\mathrm{cm}) = \\mathrm{dimensionless}$. Correct.\n$$X = - \\frac{276 \\times 3.95}{102} \\times 10^{4} \\times 10^{-6} = - \\frac{1090.2}{102} \\times 10^{-2}$$\n$$X \\approx -10.6882 \\times 10^{-2} \\approx -0.106882$$\n\nFinally, we compute the degradation factor:\n$$\\mathcal{D}(0.53\\,\\mathrm{keV}) = \\exp(X) = \\exp(-0.106882) \\approx 0.89862$$\nRounding the result to three significant figures, we get $0.899$. This means the native oxide layer reduces the transmission at this energy by approximately $10.1\\,\\%$.",
            "answer": "$$ \\boxed{0.899} $$"
        },
        {
            "introduction": "Once a photon has traversed the filter stack, its detection is not guaranteed. The probability of detection, known as Quantum Efficiency ($QE$), is a critical parameter determined by the detector's internal structure and material properties. This exercise  challenges you to build a model for the $QE$ of a back-illuminated CCD from first principles, accounting for losses due to surface reflection and absorption in inactive layers, thereby connecting fundamental attenuation physics to a key performance metric of the diagnostic system.",
            "id": "3719080",
            "problem": "A soft X-ray imaging diagnostic for a tokamak uses a back-illuminated Charge-Coupled Device (CCD) operated in the photon-counting regime to record emission near the wavelength $\\lambda=2\\,\\mathrm{nm}$. The CCD is back-illuminated through vacuum and has a uniform silicon dioxide ($\\mathrm{SiO}_{2}$) passivation layer of thickness $t_{\\mathrm{ox}}=100\\,\\mathrm{nm}$ on the back surface. The depletion (active) silicon thickness is $t_{\\mathrm{dep}}=30\\,\\mathrm{\\mu m}$. Assume normal incidence, a backside reflectance at $\\lambda=2\\,\\mathrm{nm}$ of $R_{\\mathrm{b}}=0.05$, and that each absorbed soft X-ray photon produces a detectable event with probability $1$ in the photon-counting regime (no pile-up or dead-time losses). The CCD has an active area $A_{\\mathrm{det}}=1.00\\,\\mathrm{cm^{2}}$. The linear attenuation coefficients at $\\lambda=2\\,\\mathrm{nm}$ are $\\mu_{\\mathrm{Si}}=3.3\\times 10^{4}\\,\\mathrm{cm^{-1}}$ for silicon and $\\mu_{\\mathrm{SiO_{2}}}=4.0\\times 10^{4}\\,\\mathrm{cm^{-1}}$ for silicon dioxide. A collimated, uniform photon flux $\\Phi=1.0\\times 10^{6}\\,\\mathrm{photons\\,cm^{-2}\\,s^{-1}}$ is incident on the detector.\n\nUsing basic definitions and the Beer–Lambert law, construct from first principles a symbolic expression for the wavelength-dependent quantum efficiency $QE(\\lambda)$ of this back-illuminated CCD that accounts for transmission through the $\\mathrm{SiO}_{2}$ passivation layer, reflection losses at the backside surface, and absorption in the depletion region of silicon. Evaluate your expression at $\\lambda=2\\,\\mathrm{nm}$ using the given parameters. Then, compute the expected detected count rate for the given photon flux.\n\nRound your final numerical count rate to three significant figures and express it in $\\mathrm{s^{-1}}$.",
            "solution": "The problem requires the derivation of a symbolic expression for the quantum efficiency ($QE$) of a back-illuminated CCD and its numerical evaluation, followed by the calculation of the total detected count rate. The problem is physically well-posed and contains all necessary parameters for its solution.\n\nFirst, we construct the symbolic expression for the quantum efficiency, $QE(\\lambda)$, from first principles. The $QE$ represents the probability that an incident photon will be absorbed within the active (depletion) region of the detector, leading to a detectable event. This process can be modeled as a sequence of independent probabilistic events.\n\n1.  **Reflection Loss**: A collimated photon flux is incident on the back surface of the detector. A fraction of this flux, given by the reflectance $R_{\\mathrm{b}}(\\lambda)$, is reflected and does not enter the device. The fraction that is transmitted into the device is $(1 - R_{\\mathrm{b}}(\\lambda))$.\n\n2.  **Transmission through Passivation Layer**: The transmitted photons must first traverse the silicon dioxide ($\\mathrm{SiO}_{2}$) passivation layer of thickness $t_{\\mathrm{ox}}$. According to the Beer-Lambert law, the intensity of radiation decreases exponentially as it passes through an absorbing medium. The fraction of photons that successfully pass through this layer without being absorbed is given by the transmission factor $T_{\\mathrm{ox}}(\\lambda) = \\exp(-\\mu_{\\mathrm{SiO_{2}}}(\\lambda) t_{\\mathrm{ox}})$, where $\\mu_{\\mathrm{SiO_{2}}}(\\lambda)$ is the linear attenuation coefficient of $\\mathrm{SiO}_{2}$ at wavelength $\\lambda$.\n\n3.  **Absorption in Depletion Region**: Photons that emerge from the passivation layer enter the active silicon depletion region of thickness $t_{\\mathrm{dep}}$. A photon is detected if it is absorbed within this region. The fraction of photons entering the silicon that are then absorbed within the depth $t_{\\mathrm{dep}}$ is given by $(1 - T_{\\mathrm{dep}}(\\lambda))$, where $T_{\\mathrm{dep}}(\\lambda) = \\exp(-\\mu_{\\mathrm{Si}}(\\lambda) t_{\\mathrm{dep}})$ is the fraction that would pass through the depletion region unabsorbed. Here, $\\mu_{\\mathrm{Si}}(\\lambda)$ is the linear attenuation coefficient of silicon.\n\nThe total quantum efficiency is the product of the probabilities of these sequential events: the photon must enter the device, pass through the passivation layer, and then be absorbed in the depletion region. Therefore, the symbolic expression for the wavelength-dependent quantum efficiency is:\n$$QE(\\lambda) = (1 - R_{\\mathrm{b}}(\\lambda)) \\exp(-\\mu_{\\mathrm{SiO_{2}}}(\\lambda) t_{\\mathrm{ox}}) (1 - \\exp(-\\mu_{\\mathrm{Si}}(\\lambda) t_{\\mathrm{dep}}))$$\nThis is the required expression derived from first principles.\n\nNext, we evaluate this expression at the given wavelength $\\lambda=2\\,\\mathrm{nm}$ using the provided parameters. We must first ensure all units are consistent. The attenuation coefficients are in $\\mathrm{cm^{-1}}$, so all thicknesses must be converted to $\\mathrm{cm}$.\nGiven thicknesses:\n$t_{\\mathrm{ox}} = 100\\,\\mathrm{nm} = 100 \\times 10^{-7}\\,\\mathrm{cm} = 1.0 \\times 10^{-5}\\,\\mathrm{cm}$\n$t_{\\mathrm{dep}} = 30\\,\\mathrm{\\mu m} = 30 \\times 10^{-4}\\,\\mathrm{cm} = 3.0 \\times 10^{-3}\\,\\mathrm{cm}$\n\nGiven parameters at $\\lambda=2\\,\\mathrm{nm}$:\nReflectance: $R_{\\mathrm{b}} = 0.05$\nAttenuation coefficient for $\\mathrm{SiO_{2}}$: $\\mu_{\\mathrm{SiO_{2}}} = 4.0 \\times 10^{4}\\,\\mathrm{cm^{-1}}$\nAttenuation coefficient for $\\mathrm{Si}$: $\\mu_{\\mathrm{Si}} = 3.3 \\times 10^{4}\\,\\mathrm{cm^{-1}}$\n\nWe calculate the dimensionless optical depths (the arguments of the exponential functions):\nFor the passivation layer: $\\tau_{\\mathrm{ox}} = \\mu_{\\mathrm{SiO_{2}}} t_{\\mathrm{ox}} = (4.0 \\times 10^{4}\\,\\mathrm{cm^{-1}}) \\times (1.0 \\times 10^{-5}\\,\\mathrm{cm}) = 0.40$\nFor the depletion region: $\\tau_{\\mathrm{dep}} = \\mu_{\\mathrm{Si}} t_{\\mathrm{dep}} = (3.3 \\times 10^{4}\\,\\mathrm{cm^{-1}}) \\times (3.0 \\times 10^{-3}\\,\\mathrm{cm}) = 99$\n\nNow, we substitute these values into the $QE$ expression:\n$$QE(2\\,\\mathrm{nm}) = (1 - 0.05) \\times \\exp(-0.40) \\times (1 - \\exp(-99))$$\nThe term $\\exp(-99)$ is exceedingly small, approximately $1.01 \\times 10^{-43}$. Thus, the factor $(1 - \\exp(-99))$ is effectively $1$. This indicates that the depletion layer is optically thick, and essentially all soft X-ray photons that enter it are absorbed.\n$$QE(2\\,\\mathrm{nm}) \\approx (0.95) \\times \\exp(-0.40) \\times 1$$\n$$QE(2\\,\\mathrm{nm}) \\approx 0.95 \\times 0.670320... \\approx 0.636804$$\n\nFinally, we compute the expected detected count rate, $C$. The count rate is the product of the incident photon flux $\\Phi$, the detector's active area $A_{\\mathrm{det}}$, and the quantum efficiency $QE$. The problem states that every absorbed photon in the depletion region is detected.\n$$C = \\Phi \\times A_{\\mathrm{det}} \\times QE$$\nUsing the given values:\n$\\Phi = 1.0 \\times 10^{6}\\,\\mathrm{photons\\,cm^{-2}\\,s^{-1}}$\n$A_{\\mathrm{det}} = 1.00\\,\\mathrm{cm^{2}}$\n$$C = (1.0 \\times 10^{6}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (1.00\\,\\mathrm{cm^{2}}) \\times (0.636804)$$\n$$C \\approx 6.36804 \\times 10^{5}\\,\\mathrm{s^{-1}}$$\nThe problem requires the final numerical count rate to be rounded to three significant figures.\n$$C \\approx 6.37 \\times 10^{5}\\,\\mathrm{s^{-1}}$$",
            "answer": "$$\\boxed{6.37 \\times 10^{5}}$$"
        },
        {
            "introduction": "Soft X-ray imaging diagnostics provide line-integrated measurements of plasma emission, but the ultimate physics goal is to determine the local emissivity profile within the plasma. This requires solving a challenging inverse problem known as tomographic reconstruction, which is notoriously sensitive to measurement noise. This hands-on computational exercise  guides you through the implementation of a Tikhonov-regularized inversion, a powerful technique to obtain stable, physically plausible emissivity profiles, and introduces the L-curve criterion for systematically optimizing the reconstruction.",
            "id": "3719091",
            "problem": "You are given a simplified axisymmetric model for Soft X-Ray (SXR) spectroscopy and imaging in a magnetic confinement fusion device. The plasma cross-section is approximated as a circle of minor radius $a$, and the SXR signal from each chord is modeled as a line integral of the local emissivity along the line-of-sight. This model reduces the inversion to recovering a radial emissivity profile from line-integrated measurements under the assumption of axisymmetry.\n\nStarting from Radiative Transfer in the optically thin limit and the Geometric Line-Integral definition:\n- The SXR signal along a straight chord at impact parameter $p$ (distance from the center) is $s(p) = \\int_{\\text{chord}} \\varepsilon(r) \\, ds$, where $\\varepsilon(r)$ is the emissivity as a function of radius $r$ and $ds$ is the path length element.\n- For a circular cross-section and axisymmetry, discretize the radius into $N$ concentric shells with boundaries $0 = r_0 < r_1 < \\cdots < r_N = a$, and approximate $\\varepsilon(r)$ as piecewise constant in each shell, with unknown constants $x_j$ for shell $j$.\n- The geometry matrix $A \\in \\mathbb{R}^{M \\times N}$ maps the shell emissivities to $M$ chord signals. For a chord at impact parameter $p_i$ and a shell bounded by $[r_{j-1}, r_j]$, the path length through that shell is given by the well-tested geometric relation $2 \\left( \\sqrt{\\max(r_j^2 - p_i^2, 0)} - \\sqrt{\\max(r_{j-1}^2 - p_i^2, 0)} \\right)$, which yields the element $A_{ij}$.\n\nGiven noisy measurements $\\mathbf{b} \\in \\mathbb{R}^M$ generated by a known synthetic emissivity profile, formulate a regularized least-squares inversion with Tikhonov smoothing:\n- Minimize $J(\\mathbf{x}; \\lambda) = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2 + \\lambda^2 \\lVert L \\mathbf{x} \\rVert_2^2$, where $L$ is a discrete second-derivative operator approximating curvature smoothing in radius, scaled appropriately by the shell spacing to reflect physical dimensions, and $\\lambda > 0$ is the regularization parameter.\n\nSelect the regularization parameter $\\lambda$ using the L-curve criterion:\n- Consider the parametric curve $(\\log_{10} \\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2, \\log_{10} \\lVert L \\mathbf{x}_\\lambda \\rVert_2)$ as $\\lambda$ varies over a logarithmic grid.\n- Define the curvature $\\kappa$ of a parametric curve $(x(t), y(t))$ with parameter $t$ by $\\kappa(t) = \\dfrac{\\lvert x'(t) y''(t) - y'(t) x''(t) \\rvert}{\\left( x'(t)^2 + y'(t)^2 \\right)^{3/2}}$. Use $t = \\log_{10}(\\lambda)$ and approximate derivatives with central differences on the discrete grid to find the index of the maximum curvature and select the corresponding $\\lambda$.\n\nImplement the program to:\n1. Construct the geometry matrix $A$ from chord impact parameters and shell boundaries.\n2. Build the Tikhonov operator $L$ as the discrete second derivative on the shells with uniform spacing $\\Delta r = a/N$, i.e., $[L \\mathbf{x}]_k \\approx \\dfrac{x_k - 2 x_{k+1} + x_{k+2}}{(\\Delta r)^2}$ for $k = 0, \\dots, N-3$.\n3. For a logarithmically spaced set of $\\lambda$ values, compute the regularized solutions $\\mathbf{x}_\\lambda$ and the corresponding residual norms $\\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2$ and roughness norms $\\lVert L \\mathbf{x}_\\lambda \\rVert_2$.\n4. Use the L-curve curvature to select $\\lambda$, then report the normalized root-mean-square error (RMSE) between the reconstructed $\\mathbf{x}_\\lambda$ and the true synthetic $\\mathbf{x}_{\\text{true}}$ as $\\sqrt{\\dfrac{\\frac{1}{N} \\sum_{j=1}^N (x_{\\lambda,j} - x_{\\text{true},j})^2}{\\frac{1}{N} \\sum_{j=1}^N x_{\\text{true},j}^2}}$, which is dimensionless.\n\nSynthetic emissivity for all test cases should be generated from a smooth, physically plausible profile combining a core-peaked component and an edge feature, evaluated at shell midpoints $r_{j-1/2} = \\dfrac{r_{j-1} + r_j}{2}$:\n- $\\varepsilon_{\\text{true}}(r) = \\exp\\!\\left( -\\left( \\dfrac{r}{0.4 a} \\right)^2 \\right) + 0.2 \\exp\\!\\left( -\\left( \\dfrac{r - 0.8 a}{0.05 a} \\right)^2 \\right)$.\n\nNo physical units are required in the final output because the reported quantities (regularization parameter and normalized RMSE) are dimensionless.\n\nYour program must implement the above steps and produce results for the following test suite. For each case, synthesize $\\mathbf{b}$ by computing $A \\mathbf{x}_{\\text{true}}$ and adding independent and identically distributed Gaussian noise with standard deviation equal to the specified fraction of $\\max_i \\lvert (A \\mathbf{x}_{\\text{true}})_i \\rvert$, using the given random seed.\n\nTest Suite:\n- Case $1$: $a = 0.5$, $N = 32$, $M = 25$, chord impact parameters $p_i$ uniformly spaced in $[0, 0.95 a]$, noise fraction $0.01$, random seed $123$.\n- Case $2$: $a = 0.5$, $N = 32$, $M = 25$, chord impact parameters $p_i$ uniformly spaced in $[0, 0.95 a]$, noise fraction $0.05$, random seed $456$.\n- Case $3$: $a = 0.5$, $N = 25$, $M = 8$, chord impact parameters $p_i$ uniformly spaced in $[0, 0.95 a]$, noise fraction $0.03$, random seed $789$.\n\nAlgorithmic Requirements:\n- Construct $A$ using the shell path length formula.\n- Construct $L$ as described and include the $(\\Delta r)^{-2}$ scaling.\n- Solve the regularized least-squares problems for a grid of $\\lambda$ values (e.g., $60$ points spaced logarithmically from $10^{-6}$ to $10^{2}$).\n- Compute the discrete curvature on the L-curve using central differences with respect to $t = \\log_{10}(\\lambda)$, select $\\lambda$ with maximum curvature, reconstruct $\\mathbf{x}_\\lambda$, and compute the normalized RMSE.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\lambda_1, \\text{rmse}_1, \\lambda_2, \\text{rmse}_2, \\lambda_3, \\text{rmse}_3]$, where $\\lambda_k$ is the selected regularization parameter for case $k$, and $\\text{rmse}_k$ is the corresponding normalized RMSE. All outputs are dimensionless floats.",
            "solution": "The problem as stated constitutes a valid, well-posed exercise in numerical methods applied to inverse problems, specifically tomographic reconstruction in plasma physics. It is scientifically grounded, free of contradictions, and contains all necessary information to proceed with a solution. The task involves reconstructing a radial emissivity profile from a set of line-integrated measurements, a classic ill-posed problem for which Tikhonov regularization is a standard and appropriate solution method. The L-curve criterion is a widely used heuristic for selecting the regularization parameter.\n\nThe solution proceeds by implementing the specified algorithm in a step-by-step manner.\n\n1.  **System Modeling and Discretization**\n\nThe continuous physical model for the chord-integrated signal, $s(p) = \\int \\varepsilon(r) \\, ds$, is discretized to form a linear algebraic system. The plasma's circular cross-section of radius $a$ is divided into $N$ concentric annular shells of uniform width $\\Delta r = a/N$. The radial emissivity profile $\\varepsilon(r)$ is assumed to be constant within each shell $j$ (for $j=1, \\dots, N$), with value $x_j$. The set of all shell emissivities forms the unknown vector $\\mathbf{x} \\in \\mathbb{R}^N$.\n\nA set of $M$ measurements, $\\mathbf{b} \\in \\mathbb{R}^M$, are taken along chords, each defined by an impact parameter $p_i$ (for $i=1, \\dots, M$). The problem is to find $\\mathbf{x}$ given $\\mathbf{b}$. The linear relationship is given by $\\mathbf{b} \\approx A \\mathbf{x}$, where $A \\in \\mathbb{R}^{M \\times N}$ is the geometry matrix. Each element $A_{ij}$ represents the path length of the $i$-th chord through the $j$-th shell. Based on the geometry of a line intersecting an annulus, this path length is given by the specified formula:\n$$\nA_{ij} = 2 \\left( \\sqrt{\\max(r_j^2 - p_i^2, 0)} - \\sqrt{\\max(r_{j-1}^2 - p_i^2, 0)} \\right)\n$$\nwhere $r_j$ and $r_{j-1}$ are the outer and inner radii of the $j$-th shell, respectively.\n\n2.  **Tikhonov Regularization**\n\nTomographic inversion is typically an ill-posed problem, meaning small amounts of noise in the measurement vector $\\mathbf{b}$ can lead to large, unphysical oscillations in the solution vector $\\mathbf{x}$. Tikhonov regularization addresses this by adding a penalty term to the standard least-squares objective function. This penalty discourages solutions with undesirable properties, such as excessive roughness.\n\nThe objective is to find the emissivity profile $\\mathbf{x}$ that minimizes the Tikhonov functional:\n$$\nJ(\\mathbf{x}; \\lambda) = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2 + \\lambda^2 \\lVert L \\mathbf{x} \\rVert_2^2\n$$\nHere, the first term, $\\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2$, is the residual norm (or data fidelity term), which measures how well the solution fits the measurements. The second term, $\\lVert L \\mathbf{x} \\rVert_2^2$, is the regularization term (or penalty term), which measures the \"roughness\" of the solution. The regularization parameter, $\\lambda > 0$, controls the trade-off between fitting the data and maintaining a smooth solution.\n\nThe operator $L$ is chosen to approximate the second derivative of the emissivity profile with respect to radius. This choice enforces smoothness in the solution. For shells of uniform spacing $\\Delta r$, the discrete second derivative operator is constructed as a matrix of size $(N-2) \\times N$ whose application to $\\mathbf{x}$ yields a vector with elements:\n$$\n[L \\mathbf{x}]_k = \\frac{x_k - 2x_{k+1} + x_{k+2}}{(\\Delta r)^2} \\quad \\text{for } k=0, \\dots, N-3\n$$\nThe scaling factor $(\\Delta r)^{-2}$ ensures the operator is a consistent approximation of the continuous second derivative.\n\n3.  **Solving the Regularized System**\n\nThe vector $\\mathbf{x}_\\lambda$ that minimizes $J(\\mathbf{x}; \\lambda)$ is found by setting the gradient of $J$ with respect to $\\mathbf{x}$ to zero, which yields the normal equations for the regularized least-squares problem:\n$$\n(A^T A + \\lambda^2 L^T L) \\mathbf{x}_\\lambda = A^T \\mathbf{b}\n$$\nThis is a linear system of equations of size $N \\times N$. For any $\\lambda > 0$, the matrix $(A^T A + \\lambda^2 L^T L)$ is generally positive definite and thus invertible, leading to a unique solution $\\mathbf{x}_\\lambda$ for each value of $\\lambda$. The solution is computed by solving this system numerically.\n\n4.  **Optimal Regularization Parameter via the L-Curve Criterion**\n\nThe choice of $\\lambda$ is critical. The L-curve criterion is a heuristic method for making this selection. The L-curve is a parametric plot of the solution seminorm $\\log_{10} (\\lVert L \\mathbf{x}_\\lambda \\rVert_2)$ versus the residual norm $\\log_{10} (\\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2)$ for a range of $\\lambda$ values. The curve typically has a characteristic 'L' shape. The corner of the 'L' is considered to represent an optimal balance between data fidelity (small residual norm) and solution smoothness (small solution seminorm).\n\nThis corner corresponds to the point of maximum curvature on the L-curve. To find this point, we parameterize the curve $(x(t), y(t))$ by $t = \\log_{10}(\\lambda)$, where $x(t) = \\log_{10}(\\lVert A \\mathbf{x}_{\\lambda(t)} - \\mathbf{b} \\rVert_2)$ and $y(t) = \\log_{10}(\\lVert L \\mathbf{x}_{\\lambda(t)} \\rVert_2)$. The curvature $\\kappa$ is given by:\n$$\n\\kappa(t) = \\frac{\\lvert x'(t) y''(t) - y'(t) x''(t) \\rvert}{\\left( x'(t)^2 + y'(t)^2 \\right)^{3/2}}\n$$\nNumerically, the points $(x,y)$ are computed for a discrete logarithmic grid of $\\lambda$ values. The first and second derivatives ($x'$, $y'$, $x''$, $y''$) are then approximated using central differences with respect to the parameter $t$. The value of $\\lambda$ that maximizes $\\kappa(t)$ is selected as the optimal regularization parameter, $\\lambda_{\\text{opt}}$.\n\n5.  **Evaluation**\n\nOnce $\\lambda_{\\text{opt}}$ is determined, the final reconstructed profile $\\mathbf{x}_{\\lambda_{\\text{opt}}}$ is calculated. Its accuracy is quantified by comparing it to the known synthetic \"true\" profile, $\\mathbf{x}_{\\text{true}}$. The normalized root-mean-square error (RMSE) is used for this purpose:\n$$\n\\text{RMSE}_{\\text{norm}} = \\sqrt{\\frac{\\sum_{j=1}^N (x_{\\lambda_{\\text{opt}},j} - x_{\\text{true},j})^2}{\\sum_{j=1}^N x_{\\text{true},j}^2}} = \\frac{\\lVert \\mathbf{x}_{\\lambda_{\\text{opt}}} - \\mathbf{x}_{\\text{true}} \\rVert_2}{\\lVert \\mathbf{x}_{\\text{true}} \\rVert_2}\n$$\nThis dimensionless metric provides a measure of the relative error in the reconstruction.\n\nThe implementation proceeds by first generating the synthetic ground truth $\\mathbf{x}_{\\text{true}}$ and the noisy measurement vector $\\mathbf{b}$ for each test case. Then, for a grid of $\\lambda$ values, the corresponding $\\mathbf{x}_\\lambda$ is found and the L-curve coordinates are computed. Finally, the curvature is calculated to identify $\\lambda_{\\text{opt}}$, and the final RMSE is evaluated using this optimal parameter.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(a, N, M, p_max_frac, noise_fraction, seed):\n    \"\"\"\n    Implements the full tomographic inversion, L-curve analysis, and error\n    calculation for a single test case as specified in the problem statement.\n\n    Args:\n        a (float): Minor radius of the plasma.\n        N (int): Number of concentric shells for emissivity profile.\n        M (int): Number of measurement chords.\n        p_max_frac (float): Fraction of 'a' for the maximum impact parameter.\n        noise_fraction (float): Noise level as a fraction of the max signal.\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        tuple[float, float]: A tuple containing the optimal lambda and the\n                             normalized RMSE of the reconstruction.\n    \"\"\"\n    # 1. Define Grids and Parameters\n    # Shells\n    delta_r = a / N\n    r_boundaries = np.linspace(0, a, N + 1)\n    r_midpoints = (r_boundaries[:-1] + r_boundaries[1:]) / 2\n\n    # Chords\n    p_params = np.linspace(0, p_max_frac * a, M)\n\n    # 2. Generate True Emissivity Profile (x_true)\n    x_true = np.exp(-(r_midpoints / (0.4 * a))**2) + \\\n             0.2 * np.exp(-((r_midpoints - 0.8 * a) / (0.05 * a))**2)\n\n    # 3. Construct Geometry Matrix A\n    A = np.zeros((M, N))\n    for i in range(M):  # Loop over chords\n        p_i_sq = p_params[i]**2\n        for j in range(N):  # Loop over shells\n            r_j_sq = r_boundaries[j+1]**2\n            r_jm1_sq = r_boundaries[j]**2\n            \n            term1 = r_j_sq - p_i_sq\n            term2 = r_jm1_sq - p_i_sq\n\n            sqrt_term1 = np.sqrt(term1) if term1 > 0 else 0.0\n            sqrt_term2 = np.sqrt(term2) if term2 > 0 else 0.0\n            \n            A[i, j] = 2 * (sqrt_term1 - sqrt_term2)\n\n    # 4. Synthesize Measurements b (with noise)\n    b_clean = A @ x_true\n    noise_std = noise_fraction * np.max(np.abs(b_clean))\n    rng = np.random.default_rng(seed)\n    noise = rng.normal(loc=0.0, scale=noise_std, size=M)\n    b = b_clean + noise\n\n    # 5. Construct Tikhonov Operator L\n    L = np.zeros((N - 2, N))\n    # Fill the bands for the [1, -2, 1] stencil\n    for k in range(N - 2):\n        L[k, k] = 1.0\n        L[k, k+1] = -2.0\n        L[k, k+2] = 1.0\n    L /= (delta_r**2)\n\n    # 6. L-curve Analysis\n    lambdas = np.logspace(-6, 2, 60)\n    residual_norms = []\n    roughness_norms = []\n\n    ATA = A.T @ A\n    ATb = A.T @ b\n    LTL = L.T @ L\n\n    for lam in lambdas:\n        # Solve (A^T A + lambda^2 L^T L) x = A^T b\n        matrix_to_solve = ATA + lam**2 * LTL\n        x_lambda = np.linalg.solve(matrix_to_solve, ATb)\n\n        # Calculate norms for the L-curve\n        residual_norms.append(np.linalg.norm(A @ x_lambda - b))\n        roughness_norms.append(np.linalg.norm(L @ x_lambda))\n\n    # 7. Find Optimal Lambda via Curvature\n    residual_norms = np.array(residual_norms)\n    roughness_norms = np.array(roughness_norms)\n\n    # The L-curve is plotted on a log-log scale. Use a small epsilon to avoid log(0).\n    epsilon = 1e-16\n    log_res_norm = np.log10(residual_norms + epsilon)\n    log_rough_norm = np.log10(roughness_norms + epsilon)\n    log_lambdas = np.log10(lambdas)\n    \n    # Calculate derivatives wrt t = log10(lambda)\n    dx_dt = np.gradient(log_res_norm, log_lambdas)\n    dy_dt = np.gradient(log_rough_norm, log_lambdas)\n    \n    d2x_dt2 = np.gradient(dx_dt, log_lambdas)\n    d2y_dt2 = np.gradient(dy_dt, log_lambdas)\n\n    # Curvature formula for parametric curve (x(t), y(t))\n    numerator = np.abs(dx_dt * d2y_dt2 - dy_dt * d2x_dt2)\n    denominator = (dx_dt**2 + dy_dt**2)**1.5\n    \n    kappa = np.zeros_like(numerator)\n    # Only calculate curvature where denominator is non-negligible\n    valid_indices = denominator > epsilon\n    kappa[valid_indices] = numerator[valid_indices] / denominator[valid_indices]\n\n    # Optimal lambda corresponds to maximum curvature\n    opt_idx = np.argmax(kappa)\n    opt_lambda = lambdas[opt_idx]\n\n    # 8. Calculate Final Solution and Error\n    final_matrix_to_solve = ATA + opt_lambda**2 * LTL\n    x_opt = np.linalg.solve(final_matrix_to_solve, ATb)\n    \n    # Calculate Normalized RMSE\n    n_rmse = np.linalg.norm(x_opt - x_true) / np.linalg.norm(x_true)\n    \n    return opt_lambda, n_rmse\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, N, M, p_max_frac, noise_fraction, seed)\n        (0.5, 32, 25, 0.95, 0.01, 123),\n        (0.5, 32, 25, 0.95, 0.05, 456),\n        (0.5, 25, 8,  0.95, 0.03, 789),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, N, M, p_max_frac, noise_frac, seed = case\n        opt_lambda, n_rmse = process_case(a, N, M, p_max_frac, noise_frac, seed)\n        results.append(opt_lambda)\n        results.append(n_rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}