{
    "hands_on_practices": [
        {
            "introduction": "软X射线诊断通常需要将感兴趣的杂质谱线与等离子体的连续辐射分离开。本练习将指导你如何应用比尔-朗伯定律 (Beer-Lambert law) 设计一个多层薄膜滤光片，以创建一个特定的透射通带 。通过这个实践，你将学会如何根据材料的光子吸收特性来选择和优化滤光片组合，以满足仪器设计的具体要求。",
            "id": "3719136",
            "problem": "一台用于诊断磁约束聚变等离子体中软X射线发射的针孔相机，必须在抑制通带外的连续谱和线发射的同时，隔离出 $1.0\\,\\mathrm{keV}$ 附近杂质线系周围的一个通带。该仪器使用一个由铍 (Be)、铝 (Al) 和聚酰亚胺机械支撑膜组成的透射式前端滤光片堆叠。感兴趣的光子能量范围是 $E \\in [0.5,2.0]\\,\\mathrm{keV}$，所需通带是 $E \\in [0.9,1.2]\\,\\mathrm{keV}$。堆叠顺序（从等离子体到探测器）是 铍/铝/聚酰亚胺。\n\n假设在此能量范围内，每种材料的质量衰减系数都可以用光子能量 $E$（以 $\\mathrm{keV}$ 表示）的幂律很好地近似，并在适用情况下在K吸收边处有阶跃变化。具体来说，使用以下分段近似（单位为 $\\mathrm{cm^2\\,g^{-1}}$）来表示质量衰减系数：\n- 对于铍：$(\\mu/\\rho)_{\\mathrm{Be}}(E) = 1.0\\times 10^{4}\\,E^{-3}$，适用于 $E \\in [0.5,2.0]$。\n- 对于铝：$(\\mu/\\rho)_{\\mathrm{Al}}(E) = \\begin{cases} 5.0\\times 10^{4}\\,E^{-3}  \\text{适用于 } E  1.56 \\\\ 1.5\\times 10^{5}\\,E^{-3}  \\text{适用于 } E \\ge 1.56 \\end{cases}$。\n- 对于聚酰亚胺：$(\\mu/\\rho)_{\\mathrm{PI}}(E) = 2.0\\times 10^{4}\\,E^{-3}$，适用于 $E \\in [0.5,2.0]$。\n\n使用以下材料密度：$\\rho_{\\mathrm{Be}} = 1.85\\,\\mathrm{g\\,cm^{-3}}$，$\\rho_{\\mathrm{Al}} = 2.70\\,\\mathrm{g\\,cm^{-3}}$，以及 $\\rho_{\\mathrm{PI}} = 1.43\\,\\mathrm{g\\,cm^{-3}}$。聚酰亚胺膜必须满足机械强度要求，其厚度固定为 $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m}$。铝层具有静电屏蔽和针孔缓解功能，其厚度固定为 $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m}$。铍的厚度 $t_{\\mathrm{Be}}$ 待定。\n\n从均匀介质中衰减的一维光子数守恒定律以及用质量衰减系数和密度定义线性衰减系数出发，完成以下任务：\n\n1) 推导每个单独滤光片 $i \\in \\{\\mathrm{Be},\\mathrm{Al},\\mathrm{PI}\\}$ 在 $E \\in [0.5,2.0]$ 范围内的光谱透射率 $T_{i}(E)$ 的表达式。\n\n2) 推导 铍/铝/聚酰亚胺 序列的堆叠透射率 $T_{\\mathrm{stack}}(E)$ 的表达式。\n\n3) 为了在保持机械强度的同时优化通带，选择 $t_{\\mathrm{Be}}$ 以最小化带外吞吐量，并满足约束条件：在通带中心 $E_{m} = 1.0\\,\\mathrm{keV}$ 处的轴上堆叠透射率等于目标值 $\\tau_{\\ast} = 0.20$。将最优的 $t_{\\mathrm{Be}}$ 表示为一个以 $\\mu\\mathrm{m}$ 为单位的数值。\n\n将你对 $t_{\\mathrm{Be}}$ 的最终数值答案四舍五入到三位有效数字。厚度以 $\\mu\\mathrm{m}$ 为单位表示。角度单位不适用。",
            "solution": "该问题要求计算用于软X射线诊断的多层堆叠中铍滤光片的最优厚度。我们必须首先验证问题陈述。\n\n**问题验证**\n\n**步骤1：提取的已知条件**\n- **材料与几何结构**：一个按 铍/铝/聚酰亚胺 顺序排列的透射式滤光片堆叠。\n- **感兴趣的能量范围**：$E \\in [0.5, 2.0]\\,\\mathrm{keV}$。\n- **所需通带**：$E \\in [0.9, 1.2]\\,\\mathrm{keV}$。\n- **约束条件的通带中心**：$E_{m} = 1.0\\,\\mathrm{keV}$。\n- **材料密度**：\n  - $\\rho_{\\mathrm{Be}} = 1.85\\,\\mathrm{g\\,cm^{-3}}$\n  - $\\rho_{\\mathrm{Al}} = 2.70\\,\\mathrm{g\\,cm^{-3}}$\n  - $\\rho_{\\mathrm{PI}} = 1.43\\,\\mathrm{g\\,cm^{-3}}$\n- **固定厚度**：\n  - $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m}$\n  - $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m}$\n- **质量衰减系数近似**（$E$ 单位为 $\\mathrm{keV}$，$(\\mu/\\rho)$ 单位为 $\\mathrm{cm^2\\,g^{-1}}$）：\n  - $(\\mu/\\rho)_{\\mathrm{Be}}(E) = 1.0\\times 10^{4}\\,E^{-3}$ for $E \\in [0.5, 2.0]$。\n  - $(\\mu/\\rho)_{\\mathrm{Al}}(E) = \\begin{cases} 5.0\\times 10^{4}\\,E^{-3}  \\text{对于 } E  1.56\\,\\mathrm{keV} \\\\ 1.5\\times 10^{5}\\,E^{-3}  \\text{对于 } E \\ge 1.56\\,\\mathrm{keV} \\end{cases}$\n  - $(\\mu/\\rho)_{\\mathrm{PI}}(E) = 2.0\\times 10^{4}\\,E^{-3}$ for $E \\in [0.5, 2.0]$。\n- **优化目标**：“最小化带外吞吐量”。\n- **约束条件**：在 $E_m=1.0\\,\\mathrm{keV}$ 处的堆叠透射率必须为 $\\tau_{\\ast} = 0.20$。\n- **变量**：铍厚度 $t_{\\mathrm{Be}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于光子衰减原理（比尔-朗伯定律），与等离子体诊断领域相关。所提供的数据在物理上是一致的，并且足以进行计算。然而，问题表述存在一个结构性问题。它被表述为一个优化问题：“选择 $t_{\\mathrm{Be}}$ 以最小化带外吞吐量，并满足约束条件...”。我们来分析一下。\n对于任何给定的能量 $E$，总透射率 $T_{\\mathrm{stack}}(E, t_{\\mathrm{Be}})$ 是 $t_{\\mathrm{Be}}$ 的一个单调递减函数。因此，$T_{\\mathrm{stack}}$ 在某个能量范围内的任何积分（例如“带外吞吐量”）也将是 $t_{\\mathrm{Be}}$ 的一个单调递减函数。要最小化这样的函数，需要使 $t_{\\mathrm{Be}}$ 尽可能大。\n然而，问题施加了一个严格的等式约束：$T_{\\mathrm{stack}}(E_m, t_{\\mathrm{Be}}) = \\tau_{\\ast}$。这个关于单个未知变量 $t_{\\mathrm{Be}}$ 的单一方程有唯一解。因此，$t_{\\mathrm{Be}}$ 的允许值集合只包含一个点。这个优化问题是退化的；任何目标函数在这个唯一的允许点上都能平凡地达到最小值。“最小化带外吞吐量”的指令是多余的。问题简化为求解满足约束条件的 $t_{\\mathrm{Be}}$ 值。\n\n**步骤3：结论与行动**\n该问题作为一个优化问题的结构不良，但包含一个适定且可解的物理计算。认识到“优化”是对直接计算的用词不当后，该问题被认为是有效的，可以求解。\n\n**解答**\n\n**1) 单个滤光片透射率 $T_i(E)$ 的推导**\n\n对于一个通量 $I(x)$ 沿 $x$ 方向穿过具有线性衰减系数 $\\mu$ 的均匀介质，其一维光子数守恒定律由以下微分方程给出：\n$$\n\\frac{dI}{dx} = -\\mu I(x)\n$$\n分离变量并从前表面（$x=0$，通量 $I_0$）积分到深度 $x=t$（通量 $I(t)$）得到：\n$$\n\\int_{I_0}^{I(t)} \\frac{dI}{I} = \\int_0^t -\\mu dx \\implies \\ln\\left(\\frac{I(t)}{I_0}\\right) = -\\mu t\n$$\n光谱透射率 $T$ 定义为透射通量与入射通量之比，$T = I(t)/I_0$。因此：\n$$\nT(E) = \\exp(-\\mu(E) t)\n$$\n线性衰减系数 $\\mu$ 取决于光子能量 $E$。它通过以下关系与质量衰减系数 $(\\mu/\\rho)$ 和材料密度 $\\rho$ 相关联：\n$$\n\\mu(E) = \\left(\\frac{\\mu}{\\rho}\\right)(E) \\cdot \\rho\n$$\n因此，厚度为 $t_i$ 的单个滤光片层 $i$ 的透射率为：\n$$\nT_i(E) = \\exp\\left(-\\left(\\frac{\\mu}{\\rho}\\right)_i(E) \\rho_i t_i\\right)\n$$\n使用 $E \\in [0.5, 2.0]\\,\\mathrm{keV}$ 范围内的给定近似值：\n\n- 对于铍 (Be)：\n$$\nT_{\\mathrm{Be}}(E) = \\exp\\left(-(1.0\\times 10^{4}\\,E^{-3}) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}}\\right)\n$$\n\n- 对于铝 (Al)，其厚度 $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m}$：\n$$\nT_{\\mathrm{Al}}(E) = \\begin{cases} \\exp\\left(-(5.0\\times 10^{4}\\,E^{-3}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}}\\right)  \\text{对于 } E  1.56\\,\\mathrm{keV} \\\\ \\exp\\left(-(1.5\\times 10^{5}\\,E^{-3}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}}\\right)  \\text{对于 } E \\ge 1.56\\,\\mathrm{keV} \\end{cases}\n$$\n\n- 对于聚酰亚胺 (PI)，其厚度 $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m}$：\n$$\nT_{\\mathrm{PI}}(E) = \\exp\\left(-(2.0\\times 10^{4}\\,E^{-3}) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}}\\right)\n$$\n\n**2) 堆叠透射率 $T_{\\mathrm{stack}}(E)$ 的推导**\n\n对于一个干涉效应可以忽略不计（对于X射线这是一个有效的假设）的滤光片堆叠，总透射率是各个透射率的乘积：\n$$\nT_{\\mathrm{stack}}(E) = T_{\\mathrm{Be}}(E) \\cdot T_{\\mathrm{Al}}(E) \\cdot T_{\\mathrm{PI}}(E)\n$$\n这可以写成：\n$$\nT_{\\mathrm{stack}}(E) = \\exp\\left(-\\sum_{i \\in \\{\\mathrm{Be,Al,PI}\\}} \\left(\\frac{\\mu}{\\rho}\\right)_i(E) \\rho_i t_i\\right)\n$$\n代入第1部分的表达式，可以得到堆叠透射率的完整表达式。由于铝的K吸收边，该表达式是分段的：\n对于 $E  1.56\\,\\mathrm{keV}$：\n$$\nT_{\\mathrm{stack}}(E) = \\exp\\left( -E^{-3} \\left[ (1.0\\times 10^{4}) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}} + (5.0\\times 10^{4}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + (2.0\\times 10^{4}) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} \\right] \\right)\n$$\n对于 $E \\ge 1.56\\,\\mathrm{keV}$：\n$$\nT_{\\mathrm{stack}}(E) = \\exp\\left( -E^{-3} \\left[ (1.0\\times 10^{4}) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}} + (1.5\\times 10^{5}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + (2.0\\times 10^{4}) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} \\right] \\right)\n$$\n其中能量 $E$ 的单位是 $\\mathrm{keV}$，密度 $\\rho_i$ 的单位是 $\\mathrm{g\\,cm^{-3}}$，厚度 $t_i$ 的单位是 $\\mathrm{cm}$。\n\n**3) 铍厚度 $t_{\\mathrm{Be}}$ 的计算**\n\n如前所述，问题简化为使用约束条件 $T_{\\mathrm{stack}}(E_m) = \\tau_{\\ast}$ 求解 $t_{\\mathrm{Be}}$，其中 $E_m = 1.0\\,\\mathrm{keV}$ 且 $\\tau_{\\ast} = 0.20$。由于 $E_m = 1.0\\,\\mathrm{keV}  1.56\\,\\mathrm{keV}$，我们使用 $T_{\\mathrm{stack}}(E)$ 的第一个表达式。\n$$\n\\tau_{\\ast} = \\exp\\left(-\\sum_{i} \\left(\\frac{\\mu}{\\rho}\\right)_i(E_m) \\rho_i t_i\\right)\n$$\n对两边取自然对数：\n$$\n\\ln(\\tau_{\\ast}) = -\\sum_{i} \\left(\\frac{\\mu}{\\rho}\\right)_i(E_m) \\rho_i t_i\n$$\n$$\n-\\ln(\\tau_{\\ast}) = \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Be}}(E_m) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E_m) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{PI}}(E_m) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}}\n$$\n现在我们可以求解 $t_{\\mathrm{Be}}$：\n$$\nt_{\\mathrm{Be}} = \\frac{-\\ln(\\tau_{\\ast}) - \\left[ \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E_m) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{PI}}(E_m) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} \\right]}{\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Be}}(E_m) \\rho_{\\mathrm{Be}}}\n$$\n首先，我们计算在 $E_m = 1.0\\,\\mathrm{keV}$ 处的质量衰减系数：\n- $(\\mu/\\rho)_{\\mathrm{Be}}(1.0) = 1.0\\times 10^{4} \\cdot (1.0)^{-3} = 1.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}$\n- $(\\mu/\\rho)_{\\mathrm{Al}}(1.0) = 5.0\\times 10^{4} \\cdot (1.0)^{-3} = 5.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}$\n- $(\\mu/\\rho)_{\\mathrm{PI}}(1.0) = 2.0\\times 10^{4} \\cdot (1.0)^{-3} = 2.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}$\n\n接下来，我们计算固定厚度膜层的无量纲指数，确保单位一致。我们将厚度单位从 $\\mu\\mathrm{m}$ 转换为 $\\mathrm{cm}$（$1\\,\\mu\\mathrm{m} = 10^{-4}\\,\\mathrm{cm}$）。\n- $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m} = 5.0 \\times 10^{-6}\\,\\mathrm{cm}$\n- $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m} = 2.0 \\times 10^{-5}\\,\\mathrm{cm}$\n\n铝的指数项：\n$$\n\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(1.0) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} = (5.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}) \\cdot (2.70\\,\\mathrm{g\\,cm^{-3}}) \\cdot (5.0 \\times 10^{-6}\\,\\mathrm{cm}) = 0.675\n$$\n聚酰亚胺的指数项：\n$$\n\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{PI}}(1.0) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} = (2.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}) \\cdot (1.43\\,\\mathrm{g\\,cm^{-3}}) \\cdot (2.0 \\times 10^{-5}\\,\\mathrm{cm}) = 0.572\n$$\n$t_{\\mathrm{Be}}$ 表达式中的分母项是：\n$$\n\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Be}}(1.0) \\rho_{\\mathrm{Be}} = (1.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}) \\cdot (1.85\\,\\mathrm{g\\,cm^{-3}}) = 1.85 \\times 10^{4}\\,\\mathrm{cm^{-1}}\n$$\n现在，将这些值代入 $t_{\\mathrm{Be}}$ 的方程中：\n$$\nt_{\\mathrm{Be}} = \\frac{-\\ln(0.20) - [0.675 + 0.572]}{1.85 \\times 10^{4}\\,\\mathrm{cm^{-1}}}\n$$\n$$\nt_{\\mathrm{Be}} = \\frac{\\ln(5) - 1.247}{1.85 \\times 10^{4}}\\,\\mathrm{cm}\n$$\n使用 $\\ln(5) \\approx 1.609438$：\n$$\nt_{\\mathrm{Be}} = \\frac{1.609438 - 1.247}{1.85 \\times 10^{4}}\\,\\mathrm{cm} = \\frac{0.362438}{1.85 \\times 10^{4}}\\,\\mathrm{cm} \\approx 1.9591 \\times 10^{-5}\\,\\mathrm{cm}\n$$\n问题要求答案以微米（$\\mu\\mathrm{m}$）为单位。\n$$\nt_{\\mathrm{Be}} = 1.9591 \\times 10^{-5}\\,\\mathrm{cm} \\times \\frac{1\\,\\mu\\mathrm{m}}{10^{-4}\\,\\mathrm{cm}} = 0.19591\\,\\mu\\mathrm{m}\n$$\n四舍五入到三位有效数字，我们得到：\n$$\nt_{\\mathrm{Be}} \\approx 0.196\\,\\mu\\mathrm{m}\n$$",
            "answer": "$$\\boxed{0.196}$$"
        },
        {
            "introduction": "光子穿过滤光片后，必须被探测器有效捕获才能形成信号。这个练习从第一性原理出发，构建了一个典型的软X射线探测器——背照式CCD——的量子效率 (Quantum Efficiency, $QE$) 模型 。理解并能计算$QE$对于将原始探测器计数准确转换为绝对光子通量至关重要，这是进行定量物理分析的基础。",
            "id": "3719080",
            "problem": "用于托卡马克的软X射线成像诊断系统采用一个在光子计数模式下工作的背照式电荷耦合器件(CCD)，记录波长$\\lambda=2\\,\\mathrm{nm}$附近的辐射。该CCD通过真空进行背向照明，其背表面上有一层厚度为 $t_{\\mathrm{ox}}=100\\,\\mathrm{nm}$ 的均匀二氧化硅($\\mathrm{SiO}_{2}$)钝化层。耗尽（有效）硅层厚度为 $t_{\\mathrm{dep}}=30\\,\\mathrm{\\mu m}$。假设正入射，在波长$\\lambda=2\\,\\mathrm{nm}$处的背面反射率为$R_{\\mathrm{b}}=0.05$，并且在光子计数模式下，每个被吸收的软X射线光子都以概率1产生一个可探测事件（无堆积或死时间损失）。该CCD的有效面积为$A_{\\mathrm{det}}=1.00\\,\\mathrm{cm^{2}}$。在波长$\\lambda=2\\,\\mathrm{nm}$处，硅的线性衰减系数为$\\mu_{\\mathrm{Si}}=3.3\\times 10^{4}\\,\\mathrm{cm^{-1}}$，二氧化硅的线性衰减系数为$\\mu_{\\mathrm{SiO_{2}}}=4.0\\times 10^{4}\\,\\mathrm{cm^{-1}}$。一束准直、均匀的光子通量$\\Phi=1.0\\times 10^{6}\\,\\mathrm{photons\\,cm^{-2}\\,s^{-1}}$入射到探测器上。\n\n使用基本定义和比尔-朗伯定律，从第一性原理出发，为该背照式CCD构建一个随波长变化的量子效率$QE(\\lambda)$的符号表达式，该表达式需考虑穿过$\\mathrm{SiO}_{2}$钝化层的透射、背面反射损失以及硅耗尽区内的吸收。使用给定参数，在$\\lambda=2\\,\\mathrm{nm}$处计算您的表达式的值。然后，计算对于给定光子通量的预期探测计数率。\n\n将最终的数值计数率四舍五入到三位有效数字，并以$\\mathrm{s^{-1}}$为单位表示。",
            "solution": "该问题要求推导背照式CCD的量子效率($QE$)的符号表达式并进行数值计算，然后计算总探测计数率。该问题在物理上是适定的，并包含了求解所需的所有参数。\n\n首先，我们从第一性原理出发构建量子效率$QE(\\lambda)$的符号表达式。$QE$表示一个入射光子在探测器的有效（耗尽）区域内被吸收，从而产生一个可探测事件的概率。这个过程可以建模为一系列独立的概率事件。\n\n1.  **反射损失**：一束准直光子通量入射到探测器的背表面。由反射率$R_{\\mathrm{b}}(\\lambda)$给出的该通量的一部分被反射，不会进入器件。透射进入器件的部分是$(1 - R_{\\mathrm{b}}(\\lambda))$。\n\n2.  **穿过钝化层的透射**：透射的光子必须首先穿过厚度为$t_{\\mathrm{ox}}$的二氧化硅($\\mathrm{SiO}_{2}$)钝化层。根据比尔-朗伯定律，辐射在穿过吸收介质时强度呈指数衰减。成功穿过此层而未被吸收的光子比例由透射因子$T_{\\mathrm{ox}}(\\lambda) = \\exp(-\\mu_{\\mathrm{SiO_{2}}}(\\lambda) t_{\\mathrm{ox}})$给出，其中$\\mu_{\\mathrm{SiO_{2}}}(\\lambda)$是$\\mathrm{SiO}_{2}$在波长$\\lambda$处的线性衰减系数。\n\n3.  **在耗尽区内的吸收**：从钝化层出来的光子进入厚度为$t_{\\mathrm{dep}}$的有效硅耗尽区。如果光子在此区域内被吸收，它就会被探测到。进入硅层后在深度$t_{\\mathrm{dep}}$内被吸收的光子比例由$(1 - T_{\\mathrm{dep}}(\\lambda))$给出，其中$T_{\\mathrm{dep}}(\\lambda) = \\exp(-\\mu_{\\mathrm{Si}}(\\lambda) t_{\\mathrm{dep}})$是将会穿过耗尽区而未被吸收的比例。这里，$\\mu_{\\mathrm{Si}}(\\lambda)$是硅的线性衰减系数。\n\n总量子效率是这些连续事件概率的乘积：光子必须进入器件，穿过钝化层，然后在耗尽区内被吸收。因此，随波长变化的量子效率的符号表达式为：\n$$QE(\\lambda) = (1 - R_{\\mathrm{b}}(\\lambda)) \\exp(-\\mu_{\\mathrm{SiO_{2}}}(\\lambda) t_{\\mathrm{ox}}) (1 - \\exp(-\\mu_{\\mathrm{Si}}(\\lambda) t_{\\mathrm{dep}}))$$\n这就是从第一性原理推导出的所求表达式。\n\n接下来，我们使用所提供的参数在给定波长$\\lambda=2\\,\\mathrm{nm}$处计算该表达式的值。我们必须首先确保所有单位一致。衰减系数的单位是$\\mathrm{cm^{-1}}$，所以所有厚度都必须转换为$\\mathrm{cm}$。\n给定厚度：\n$t_{\\mathrm{ox}} = 100\\,\\mathrm{nm} = 100 \\times 10^{-7}\\,\\mathrm{cm} = 1.0 \\times 10^{-5}\\,\\mathrm{cm}$\n$t_{\\mathrm{dep}} = 30\\,\\mathrm{\\mu m} = 30 \\times 10^{-4}\\,\\mathrm{cm} = 3.0 \\times 10^{-3}\\,\\mathrm{cm}$\n\n在$\\lambda=2\\,\\mathrm{nm}$处的给定参数：\n反射率：$R_{\\mathrm{b}} = 0.05$\n$\\mathrm{SiO_{2}}$的衰减系数：$\\mu_{\\mathrm{SiO_{2}}} = 4.0 \\times 10^{4}\\,\\mathrm{cm^{-1}}$\n$\\mathrm{Si}$的衰减系数：$\\mu_{\\mathrm{Si}} = 3.3 \\times 10^{4}\\,\\mathrm{cm^{-1}}$\n\n我们计算无量纲的光学深度（指数函数的参数）：\n对于钝化层：$\\tau_{\\mathrm{ox}} = \\mu_{\\mathrm{SiO_{2}}} t_{\\mathrm{ox}} = (4.0 \\times 10^{4}\\,\\mathrm{cm^{-1}}) \\times (1.0 \\times 10^{-5}\\,\\mathrm{cm}) = 0.40$\n对于耗尽区：$\\tau_{\\mathrm{dep}} = \\mu_{\\mathrm{Si}} t_{\\mathrm{dep}} = (3.3 \\times 10^{4}\\,\\mathrm{cm^{-1}}) \\times (3.0 \\times 10^{-3}\\,\\mathrm{cm}) = 99$\n\n现在，我们将这些值代入$QE$表达式中：\n$$QE(2\\,\\mathrm{nm}) = (1 - 0.05) \\times \\exp(-0.40) \\times (1 - \\exp(-99))$$\n项$\\exp(-99)$非常小，约为$1.01 \\times 10^{-43}$。因此，因子$(1 - \\exp(-99))$实际上等于1。这表明耗尽层是光学厚的，并且基本上所有进入它的软X射线光子都会被吸收。\n$$QE(2\\,\\mathrm{nm}) \\approx (0.95) \\times \\exp(-0.40) \\times 1$$\n$$QE(2\\,\\mathrm{nm}) \\approx 0.95 \\times 0.670320... \\approx 0.636804$$\n\n最后，我们计算预期的探测计数率$C$。计数率是入射光子通量$\\Phi$、探测器有效面积$A_{\\mathrm{det}}$和量子效率$QE$的乘积。问题说明，每个在耗尽区被吸收的光子都会被探测到。\n$$C = \\Phi \\times A_{\\mathrm{det}} \\times QE$$\n使用给定值：\n$\\Phi = 1.0 \\times 10^{6}\\,\\mathrm{photons\\,cm^{-2}\\,s^{-1}}$\n$A_{\\mathrm{det}} = 1.00\\,\\mathrm{cm^{2}}$\n$$C = (1.0 \\times 10^{6}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (1.00\\,\\mathrm{cm^{2}}) \\times (0.636804)$$\n$$C \\approx 6.36804 \\times 10^{5}\\,\\mathrm{s^{-1}}$$\n问题要求将最终的数值计数率四舍五入到三位有效数字。\n$$C \\approx 6.37 \\times 10^{5}\\,\\mathrm{s^{-1}}$$",
            "answer": "$$\\boxed{6.37 \\times 10^{5}}$$"
        },
        {
            "introduction": "软X射线成像系统通常测量的是沿多条弦向视线的线积分信号。这个高级练习将深入探讨一个核心的计算挑战：如何从这些间接的测量中重建局域的等离子体发射率分布，这是一个典型的反问题 。你将学习并实现吉洪诺夫正则化 (Tikhonov regularization) 和L曲线判据 (L-curve criterion)，这些都是从含噪声的间接数据中获得物理上可信结果的关键技术。",
            "id": "3719091",
            "problem": "给定一个用于磁约束聚变装置中软X射线（SXR）光谱学与成像的简化轴对称模型。等离子体截面近似为小半径为 $a$ 的圆形，来自每根弦的SXR信号被建模为局部发射率沿视线路径的线积分。该模型将反演问题简化为在轴对称的假设下，从线积分测量中恢复径向发射率剖面。\n\n从光学薄极限下的辐射传输和几何线积分定义出发：\n- 沿碰撞参数为 $p$（距中心的距离）的直弦的SXR信号为 $s(p) = \\int_{\\text{chord}} \\varepsilon(r) \\, ds$，其中 $\\varepsilon(r)$ 是作为半径 $r$ 函数的发射率，$ds$ 是路径长度元。\n- 对于圆形截面和轴对称性，将半径离散为 $N$ 个同心壳层，其边界为 $0 = r_0  r_1  \\cdots  r_N = a$，并在每个壳层内将 $\\varepsilon(r)$ 近似为分段常数，其中壳层 $j$ 的未知常数为 $x_j$。\n- 几何矩阵 $A \\in \\mathbb{R}^{M \\times N}$ 将壳层发射率映射到 $M$ 个弦信号。对于碰撞参数为 $p_i$ 的弦和边界为 $[r_{j-1}, r_j]$ 的壳层，穿过该壳层的路径长度由经过充分检验的几何关系 $2 \\left( \\sqrt{\\max(r_j^2 - p_i^2, 0)} - \\sqrt{\\max(r_{j-1}^2 - p_i^2, 0)} \\right)$ 给出，由此得到元素 $A_{ij}$。\n\n给定由已知合成发射率剖面生成的含噪声测量值 $\\mathbf{b} \\in \\mathbb{R}^M$，构建一个带Tikhonov平滑的正则化最小二乘反演：\n- 最小化 $J(\\mathbf{x}; \\lambda) = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2 + \\lambda^2 \\lVert L \\mathbf{x} \\rVert_2^2$，其中 $L$ 是一个离散二阶导数算子，用于近似径向上的曲率平滑，并已通过壳层间距进行了适当缩放以反映物理尺寸，而 $\\lambda > 0$ 是正则化参数。\n\n使用L曲线准则选择正则化参数 $\\lambda$：\n- 考虑当 $\\lambda$ 在一个对数网格上变化时，参数曲线 $(\\log_{10} \\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2, \\log_{10} \\lVert L \\mathbf{x}_\\lambda \\rVert_2)$。\n- 将参数为 $t$ 的参数曲线 $(x(t), y(t))$ 的曲率 $\\kappa$ 定义为 $\\kappa(t) = \\dfrac{\\lvert x'(t) y''(t) - y'(t) x''(t) \\rvert}{\\left( x'(t)^2 + y'(t)^2 \\right)^{3/2}}$。使用 $t = \\log_{10}(\\lambda)$ 并在离散网格上使用中心差分来近似导数，以找到最大曲率的索引并选择相应的 $\\lambda$。\n\n实现程序以完成以下任务：\n1. 根据弦的碰撞参数和壳层边界构建几何矩阵 $A$。\n2. 将Tikhonov算子 $L$ 构建为在均匀间距 $\\Delta r = a/N$ 的壳层上的离散二阶导数，即对于 $k = 0, \\dots, N-3$ 有 $[L \\mathbf{x}]_k \\approx \\dfrac{x_k - 2 x_{k+1} + x_{k+2}}{(\\Delta r)^2}$。\n3. 对于一组对数间隔的 $\\lambda$ 值，计算正则化解 $\\mathbf{x}_\\lambda$以及相应的残差范数 $\\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2$ 和粗糙度范数 $\\lVert L \\mathbf{x}_\\lambda \\rVert_2$。\n4. 使用L曲线曲率选择 $\\lambda$，然后报告重建的 $\\mathbf{x}_\\lambda$ 与真实的合成 $\\mathbf{x}_{\\text{true}}$ 之间的归一化均方根误差（RMSE），其形式为 $\\sqrt{\\dfrac{\\frac{1}{N} \\sum_{j=1}^N (x_{\\lambda,j} - x_{\\text{true},j})^2}{\\frac{1}{N} \\sum_{j=1}^N x_{\\text{true},j}^2}}$，该值为无量纲。\n\n所有测试案例的合成发射率应通过一个光滑且物理上合理的剖面生成，该剖面结合了芯部峰化分量和边界特征，并在壳层中点 $r_{j-1/2} = \\dfrac{r_{j-1} + r_j}{2}$ 处进行求值：\n- $\\varepsilon_{\\text{true}}(r) = \\exp\\!\\left( -\\left( \\dfrac{r}{0.4 a} \\right)^2 \\right) + 0.2 \\exp\\!\\left( -\\left( \\dfrac{r - 0.8 a}{0.05 a} \\right)^2 \\right)$。\n\n最终输出中无需物理单位，因为报告的量（正则化参数和归一化RMSE）是无量纲的。\n\n您的程序必须实现上述步骤，并为以下测试套件生成结果。对于每个案例，通过计算 $A \\mathbf{x}_{\\text{true}}$ 并添加独立同分布的高斯噪声来合成 $\\mathbf{b}$，该噪声的标准差等于 $\\max_i \\lvert (A \\mathbf{x}_{\\text{true}})_i \\rvert$ 的指定分数，并使用给定的随机种子。\n\n测试套件：\n- 案例1：$a = 0.5$, $N = 32$, $M = 25$，弦碰撞参数 $p_i$ 在 $[0, 0.95 a]$ 上均匀分布，噪声分数为 $0.01$，随机种子为 $123$。\n- 案例2：$a = 0.5$, $N = 32$, $M = 25$，弦碰撞参数 $p_i$ 在 $[0, 0.95 a]$ 上均匀分布，噪声分数为 $0.05$，随机种子为 $456$。\n- 案例3：$a = 0.5$, $N = 25$, $M = 8$，弦碰撞参数 $p_i$ 在 $[0, 0.95 a]$ 上均匀分布，噪声分数为 $0.03$，随机种子为 $789$。\n\n算法要求：\n- 使用壳层路径长度公式构建 $A$。\n- 按所述构建 $L$，并包括 $(\\Delta r)^{-2}$ 缩放因子。\n- 为一个 $\\lambda$ 值的网格（例如，从 $10^{-6}$ 到 $10^{2}$ 对数间隔的 $60$ 个点）求解正则化最小二乘问题。\n- 使用关于 $t = \\log_{10}(\\lambda)$ 的中心差分计算L曲线上的离散曲率，选择具有最大曲率的 $\\lambda$，重建 $\\mathbf{x}_\\lambda$，并计算归一化RMSE。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\lambda_1, \\text{rmse}_1, \\lambda_2, \\text{rmse}_2, \\lambda_3, \\text{rmse}_3]$，其中 $\\lambda_k$ 是为案例 $k$ 选择的正则化参数，$\\text{rmse}_k$ 是相应的归一化RMSE。所有输出均为无量纲浮点数。",
            "solution": "所述问题构成了应用于反问题的数值方法中的一个有效且适定的练习，具体来说是等离子体物理中的层析成像重建。它具有科学依据，没有矛盾，并包含进行求解所需的所有必要信息。该任务涉及从一组线积分测量中重建径向发射率剖面，这是一个经典的病态问题，而Tikhonov正则化是一种标准且合适的解决方法。L曲线准则是选择正则化参数的一种广泛使用的启发式方法。\n\n求解过程通过逐步实现指定的算法来进行。\n\n1.  **系统建模与离散化**\n\n弦积分信号的连续物理模型 $s(p) = \\int \\varepsilon(r) \\, ds$ 被离散化以形成一个线性代数系统。半径为 $a$ 的等离子体圆形截面被划分为 $N$ 个宽度均匀的同心环形壳层，宽度为 $\\Delta r = a/N$。径向发射率剖面 $\\varepsilon(r)$ 在每个壳层 $j$（对于 $j=1, \\dots, N$）内被假设为常数，其值为 $x_j$。所有壳层发射率的集合构成了未知向量 $\\mathbf{x} \\in \\mathbb{R}^N$。\n\n沿着由碰撞参数 $p_i$（对于 $i=1, \\dots, M$）定义的弦，进行一组 $M$ 次测量，得到 $\\mathbf{b} \\in \\mathbb{R}^M$。问题是在给定 $\\mathbf{b}$ 的情况下求出 $\\mathbf{x}$。其线性关系由 $\\mathbf{b} \\approx A \\mathbf{x}$ 给出，其中 $A \\in \\mathbb{R}^{M \\times N}$ 是几何矩阵。每个元素 $A_{ij}$ 代表第 $i$ 根弦穿过第 $j$ 个壳层的路径长度。基于直线与环形相交的几何关系，该路径长度由指定公式给出：\n$$\nA_{ij} = 2 \\left( \\sqrt{\\max(r_j^2 - p_i^2, 0)} - \\sqrt{\\max(r_{j-1}^2 - p_i^2, 0)} \\right)\n$$\n其中 $r_j$ 和 $r_{j-1}$ 分别是第 $j$ 个壳层的外半径和内半径。\n\n2.  **Tikhonov正则化**\n\n层析反演通常是一个病态问题，这意味着测量向量 $\\mathbf{b}$ 中的微小噪声可能导致解向量 $\\mathbf{x}$ 中出现大的、不符合物理规律的振荡。Tikhonov正则化通过在标准最小二乘目标函数中添加一个惩罚项来解决此问题。该惩罚项会抑制具有不良属性（如过度粗糙）的解。\n\n目标是找到能最小化Tikhonov泛函的发射率剖面 $\\mathbf{x}$：\n$$\nJ(\\mathbf{x}; \\lambda) = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2 + \\lambda^2 \\lVert L \\mathbf{x} \\rVert_2^2\n$$\n此处，第一项 $\\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2$ 是残差范数（或数据保真项），它衡量解与测量值的拟合程度。第二项 $\\lVert L \\mathbf{x} \\rVert_2^2$ 是正则化项（或惩罚项），它衡量解的“粗糙度”。正则化参数 $\\lambda  0$ 控制着拟合数据与保持解的光滑性之间的权衡。\n\n算子 $L$ 被选择来近似发射率剖面关于半径的二阶导数。这一选择强制解具有光滑性。对于间距均匀的壳层 $\\Delta r$，离散二阶导数算子被构建为一个大小为 $(N-2) \\times N$ 的矩阵，其作用于 $\\mathbf{x}$ 产生一个向量，其元素为：\n$$\n[L \\mathbf{x}]_k = \\frac{x_k - 2x_{k+1} + x_{k+2}}{(\\Delta r)^2} \\quad \\text{for } k=0, \\dots, N-3\n$$\n缩放因子 $(\\Delta r)^{-2}$ 确保该算子是连续二阶导数的一致近似。\n\n3.  **求解正则化系统**\n\n最小化 $J(\\mathbf{x}; \\lambda)$ 的向量 $\\mathbf{x}_\\lambda$ 是通过将 $J$ 关于 $\\mathbf{x}$ 的梯度设为零来找到的，这会产生正则化最小二乘问题的正规方程组：\n$$\n(A^T A + \\lambda^2 L^T L) \\mathbf{x}_\\lambda = A^T \\mathbf{b}\n$$\n这是一个大小为 $N \\times N$ 的线性方程组。对于任何 $\\lambda  0$，矩阵 $(A^T A + \\lambda^2 L^T L)$ 通常是正定的，因此是可逆的，从而为每个 $\\lambda$ 值带来一个唯一的解 $\\mathbf{x}_\\lambda$。该解通过对此系统进行数值求解来计算。\n\n4.  **通过L曲线准则选择最优正则化参数**\n\n$\\lambda$ 的选择至关重要。L曲线准则是进行此选择的一种启发式方法。L曲线是对于一系列 $\\lambda$ 值，解的半范数 $\\log_{10} (\\lVert L \\mathbf{x}_\\lambda \\rVert_2)$ 相对于残差范数 $\\log_{10} (\\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2)$ 的参数图。该曲线通常具有特征性的“L”形状。“L”形的拐角被认为代表了数据保真度（小残差范数）和解的光滑度（小解半范数）之间的最佳平衡。\n\n这个拐角对应于L曲线上的最大曲率点。为了找到这一点，我们通过 $t = \\log_{10}(\\lambda)$ 将曲线参数化为 $(x(t), y(t))$，其中 $x(t) = \\log_{10}(\\lVert A \\mathbf{x}_{\\lambda(t)} - \\mathbf{b} \\rVert_2)$ 且 $y(t) = \\log_{10}(\\lVert L \\mathbf{x}_{\\lambda(t)} \\rVert_2)$。曲率 $\\kappa$ 由以下公式给出：\n$$\n\\kappa(t) = \\frac{\\lvert x'(t) y''(t) - y'(t) x''(t) \\rvert}{\\left( x'(t)^2 + y'(t)^2 \\right)^{3/2}}\n$$\n在数值上，对于一个离散的 $\\lambda$ 值对数网格，计算点 $(x,y)$。然后使用关于参数 $t$ 的中心差分来近似一阶和二阶导数（$x'$, $y'$, $x''$, $y''$）。最大化 $\\kappa(t)$ 的 $\\lambda$ 值被选为最优正则化参数 $\\lambda_{\\text{opt}}$。\n\n5.  **评估**\n\n一旦确定了 $\\lambda_{\\text{opt}}$，就计算最终的重建剖面 $\\mathbf{x}_{\\lambda_{\\text{opt}}}$。其准确性通过与已知的合成“真实”剖面 $\\mathbf{x}_{\\text{true}}$进行比较来量化。为此，使用归一化均方根误差（RMSE）：\n$$\n\\text{RMSE}_{\\text{norm}} = \\sqrt{\\frac{\\sum_{j=1}^N (x_{\\lambda_{\\text{opt}},j} - x_{\\text{true},j})^2}{\\sum_{j=1}^N x_{\\text{true},j}^2}} = \\frac{\\lVert \\mathbf{x}_{\\lambda_{\\text{opt}}} - \\mathbf{x}_{\\text{true}} \\rVert_2}{\\lVert \\mathbf{x}_{\\text{true}} \\rVert_2}\n$$\n这个无量纲度量提供了重建中相对误差的度量。\n\n实现过程首先为每个测试案例生成合成的基准真相 $\\mathbf{x}_{\\text{true}}$ 和含噪声的测量向量 $\\mathbf{b}$。然后，对于一个 $\\lambda$ 值的网格，找到相应的 $\\mathbf{x}_\\lambda$ 并计算L曲线坐标。最后，计算曲率以确定 $\\lambda_{\\text{opt}}$，并使用此最优参数评估最终的RMSE。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(a, N, M, p_max_frac, noise_fraction, seed):\n    \"\"\"\n    Implements the full tomographic inversion, L-curve analysis, and error\n    calculation for a single test case as specified in the problem statement.\n\n    Args:\n        a (float): Minor radius of the plasma.\n        N (int): Number of concentric shells for emissivity profile.\n        M (int): Number of measurement chords.\n        p_max_frac (float): Fraction of 'a' for the maximum impact parameter.\n        noise_fraction (float): Noise level as a fraction of the max signal.\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        tuple[float, float]: A tuple containing the optimal lambda and the\n                             normalized RMSE of the reconstruction.\n    \"\"\"\n    # 1. Define Grids and Parameters\n    # Shells\n    delta_r = a / N\n    r_boundaries = np.linspace(0, a, N + 1)\n    r_midpoints = (r_boundaries[:-1] + r_boundaries[1:]) / 2\n\n    # Chords\n    p_params = np.linspace(0, p_max_frac * a, M)\n\n    # 2. Generate True Emissivity Profile (x_true)\n    x_true = np.exp(-(r_midpoints / (0.4 * a))**2) + \\\n             0.2 * np.exp(-((r_midpoints - 0.8 * a) / (0.05 * a))**2)\n\n    # 3. Construct Geometry Matrix A\n    A = np.zeros((M, N))\n    for i in range(M):  # Loop over chords\n        p_i_sq = p_params[i]**2\n        for j in range(N):  # Loop over shells\n            r_j_sq = r_boundaries[j+1]**2\n            r_jm1_sq = r_boundaries[j]**2\n            \n            term1 = r_j_sq - p_i_sq\n            term2 = r_jm1_sq - p_i_sq\n\n            sqrt_term1 = np.sqrt(term1) if term1  0 else 0.0\n            sqrt_term2 = np.sqrt(term2) if term2  0 else 0.0\n            \n            A[i, j] = 2 * (sqrt_term1 - sqrt_term2)\n\n    # 4. Synthesize Measurements b (with noise)\n    b_clean = A @ x_true\n    noise_std = noise_fraction * np.max(np.abs(b_clean))\n    rng = np.random.default_rng(seed)\n    noise = rng.normal(loc=0.0, scale=noise_std, size=M)\n    b = b_clean + noise\n\n    # 5. Construct Tikhonov Operator L\n    L = np.zeros((N - 2, N))\n    # Fill the bands for the [1, -2, 1] stencil\n    for k in range(N - 2):\n        L[k, k] = 1.0\n        L[k, k+1] = -2.0\n        L[k, k+2] = 1.0\n    L /= (delta_r**2)\n\n    # 6. L-curve Analysis\n    lambdas = np.logspace(-6, 2, 60)\n    residual_norms = []\n    roughness_norms = []\n\n    ATA = A.T @ A\n    ATb = A.T @ b\n    LTL = L.T @ L\n\n    for lam in lambdas:\n        # Solve (A^T A + lambda^2 L^T L) x = A^T b\n        matrix_to_solve = ATA + lam**2 * LTL\n        x_lambda = np.linalg.solve(matrix_to_solve, ATb)\n\n        # Calculate norms for the L-curve\n        residual_norms.append(np.linalg.norm(A @ x_lambda - b))\n        roughness_norms.append(np.linalg.norm(L @ x_lambda))\n\n    # 7. Find Optimal Lambda via Curvature\n    residual_norms = np.array(residual_norms)\n    roughness_norms = np.array(roughness_norms)\n\n    # The L-curve is plotted on a log-log scale. Use a small epsilon to avoid log(0).\n    epsilon = 1e-16\n    log_res_norm = np.log10(residual_norms + epsilon)\n    log_rough_norm = np.log10(roughness_norms + epsilon)\n    log_lambdas = np.log10(lambdas)\n    \n    # Calculate derivatives wrt t = log10(lambda)\n    dx_dt = np.gradient(log_res_norm, log_lambdas)\n    dy_dt = np.gradient(log_rough_norm, log_lambdas)\n    \n    d2x_dt2 = np.gradient(dx_dt, log_lambdas)\n    d2y_dt2 = np.gradient(dy_dt, log_lambdas)\n\n    # Curvature formula for parametric curve (x(t), y(t))\n    numerator = np.abs(dx_dt * d2y_dt2 - dy_dt * d2x_dt2)\n    denominator = (dx_dt**2 + dy_dt**2)**1.5\n    \n    kappa = np.zeros_like(numerator)\n    # Only calculate curvature where denominator is non-negligible\n    valid_indices = denominator  epsilon\n    kappa[valid_indices] = numerator[valid_indices] / denominator[valid_indices]\n\n    # Optimal lambda corresponds to maximum curvature\n    opt_idx = np.argmax(kappa)\n    opt_lambda = lambdas[opt_idx]\n\n    # 8. Calculate Final Solution and Error\n    final_matrix_to_solve = ATA + opt_lambda**2 * LTL\n    x_opt = np.linalg.solve(final_matrix_to_solve, ATb)\n    \n    # Calculate Normalized RMSE\n    n_rmse = np.linalg.norm(x_opt - x_true) / np.linalg.norm(x_true)\n    \n    return opt_lambda, n_rmse\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, N, M, p_max_frac, noise_fraction, seed)\n        (0.5, 32, 25, 0.95, 0.01, 123),\n        (0.5, 32, 25, 0.95, 0.05, 456),\n        (0.5, 25, 8,  0.95, 0.03, 789),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, N, M, p_max_frac, noise_frac, seed = case\n        opt_lambda, n_rmse = process_case(a, N, M, p_max_frac, noise_frac, seed)\n        results.append(opt_lambda)\n        results.append(n_rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}