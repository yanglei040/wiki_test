{
    "hands_on_practices": [
        {
            "introduction": "Soft X-ray diagnostics often need to isolate a narrow energy band to study specific impurity line radiation, which is achieved using transmissive filter stacks. In this practice , you will apply the Beer-Lambert law, $T(E) = \\exp(-\\mu(E) t)$, to a multi-layer filter to determine the material thickness required to achieve a desired spectral response. This exercise demonstrates a fundamental calculation in the design and calibration of SXR instruments, where shaping the photon throughput is critical for the measurement.",
            "id": "3719136",
            "problem": "A pinhole camera for diagnosing soft x-ray emission in a magnetically confined fusion plasma must isolate a passband around the impurity-line complex near $1.0\\,\\mathrm{keV}$ while suppressing continuum and line emission outside that band. The instrument uses a transmissive front-end filter stack composed of beryllium (Be), aluminum (Al), and a polyimide mechanical support film. The photon energy range of interest is $E \\in [0.5,2.0]\\,\\mathrm{keV}$, and the desired passband is $E \\in [0.9,1.2]\\,\\mathrm{keV}$. The stack order (from plasma to detector) is Be/Al/polyimide.\n\nAssume that in this energy range each material’s mass attenuation coefficient is well-approximated by a power law in photon energy $E$ (expressed in $\\mathrm{keV}$) with a step change at the K-edge where applicable. Specifically, use the following piecewise approximations (in $\\mathrm{cm^2\\,g^{-1}}$) for the mass attenuation coefficients:\n- For beryllium: $(\\mu/\\rho)_{\\mathrm{Be}}(E) = 1.0\\times 10^{4}\\,E^{-3}$ for $E \\in [0.5,2.0]$.\n- For aluminum: $(\\mu/\\rho)_{\\mathrm{Al}}(E) = 5.0\\times 10^{4}\\,E^{-3}$ for $E < 1.56$ and $(\\mu/\\rho)_{\\mathrm{Al}}(E) = 1.5\\times 10^{5}\\,E^{-3}$ for $E \\ge 1.56$.\n- For polyimide: $(\\mu/\\rho)_{\\mathrm{PI}}(E) = 2.0\\times 10^{4}\\,E^{-3}$ for $E \\in [0.5,2.0]$.\n\nUse the following material densities: $\\rho_{\\mathrm{Be}} = 1.85\\,\\mathrm{g\\,cm^{-3}}$, $\\rho_{\\mathrm{Al}} = 2.70\\,\\mathrm{g\\,cm^{-3}}$, and $\\rho_{\\mathrm{PI}} = 1.43\\,\\mathrm{g\\,cm^{-3}}$. The polyimide film must satisfy mechanical robustness and is fixed at thickness $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m}$. The aluminum layer serves electrostatic and pinhole mitigation functions and is fixed at $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m}$. The beryllium thickness $t_{\\mathrm{Be}}$ is to be chosen.\n\nStarting from the one-dimensional photon number conservation law for attenuation through a uniform medium and the definition of linear attenuation coefficient in terms of mass attenuation coefficient and density, do the following:\n\n1) Derive an expression for the spectral transmission $T_{i}(E)$ of each individual filter $i \\in \\{\\mathrm{Be},\\mathrm{Al},\\mathrm{PI}\\}$ over $E \\in [0.5, 2.0]$.\n\n2) Derive the expression for the stack transmission $T_{\\mathrm{stack}}(E)$ for the Be/Al/polyimide sequence.\n\n3) To optimize the bandpass while maintaining mechanical robustness, choose $t_{\\mathrm{Be}}$ to minimize the out-of-band throughput subject to the constraint that the on-axis stack transmission at the band center $E_{m} = 1.0\\,\\mathrm{keV}$ equals a target $\\tau_{\\ast} = 0.20$. Express the optimal $t_{\\mathrm{Be}}$ as a single number in $\\mu\\mathrm{m}$.\n\nRound your final numerical answer for $t_{\\mathrm{Be}}$ to three significant figures. Express the thickness in $\\mu\\mathrm{m}$. Angle units are not applicable.",
            "solution": "The problem requires the calculation of an optimal thickness for a beryllium filter in a multi-layer stack for soft x-ray diagnostics. We must first validate the problem statement.\n\n**Problem Validation**\n\n**Step 1: Extracted Givens**\n- **Materials and Geometry**: A transmissive filter stack ordered Be/Al/polyimide.\n- **Energy Range of Interest**: $E \\in [0.5, 2.0]\\,\\mathrm{keV}$.\n- **Desired Passband**: $E \\in [0.9, 1.2]\\,\\mathrm{keV}$.\n- **Band Center for Constraint**: $E_{m} = 1.0\\,\\mathrm{keV}$.\n- **Material Densities**:\n  - $\\rho_{\\mathrm{Be}} = 1.85\\,\\mathrm{g\\,cm^{-3}}$\n  - $\\rho_{\\mathrm{Al}} = 2.70\\,\\mathrm{g\\,cm^{-3}}$\n  - $\\rho_{\\mathrm{PI}} = 1.43\\,\\mathrm{g\\,cm^{-3}}$\n- **Fixed Thicknesses**:\n  - $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m}$\n  - $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m}$\n- **Mass Attenuation Coefficient Approximations** ($E$ in $\\mathrm{keV}$, $(\\mu/\\rho)$ in $\\mathrm{cm^2\\,g^{-1}}$):\n  - $(\\mu/\\rho)_{\\mathrm{Be}}(E) = 1.0\\times 10^{4}\\,E^{-3}$ for $E \\in [0.5, 2.0]$.\n  - $(\\mu/\\rho)_{\\mathrm{Al}}(E) = \\begin{cases} 5.0\\times 10^{4}\\,E^{-3} & E < 1.56\\,\\mathrm{keV} \\\\ 1.5\\times 10^{5}\\,E^{-3} & E \\ge 1.56\\,\\mathrm{keV} \\end{cases}$\n  - $(\\mu/\\rho)_{\\mathrm{PI}}(E) = 2.0\\times 10^{4}\\,E^{-3}$ for $E \\in [0.5, 2.0]$.\n- **Optimization Objective**: \"minimize the out-of-band throughput\".\n- **Constraint**: The stack transmission at $E_m=1.0\\,\\mathrm{keV}$ must be $\\tau_{\\ast} = 0.20$.\n- **Variable**: The beryllium thickness $t_{\\mathrm{Be}}$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded in the principles of photon attenuation (Beer-Lambert law) and is relevant to the field of plasma diagnostics. The data provided are physically consistent and sufficient for calculation. However, the problem formulation presents a structural issue. It is posed as an optimization problem: \"choose $t_{\\mathrm{Be}}$ to minimize the out-of-band throughput subject to the constraint...\". Let's analyze this.\nThe total transmission $T_{\\mathrm{stack}}(E, t_{\\mathrm{Be}})$ is a monotonically decreasing function of $t_{\\mathrm{Be}}$ for any given energy $E$. Consequently, any integral of $T_{\\mathrm{stack}}$ over an energy range, such as the \"out-of-band throughput,\" will also be a monotonically decreasing function of $t_{\\mathrm{Be}}$. To minimize such a function, one would make $t_{\\mathrm{Be}}$ as large as possible.\nThe problem, however, imposes a strict equality constraint: $T_{\\mathrm{stack}}(E_m, t_{\\mathrm{Be}}) = \\tau_{\\ast}$. This single equation for the single unknown variable $t_{\\mathrm{Be}}$ has a unique solution. Therefore, the set of allowed values for $t_{\\mathrm{Be}}$ consists of only one point. The optimization problem is degenerate; any objective function is trivially minimized at this single allowed point. The instruction to \"minimize the out-of-band throughput\" is superfluous. The problem reduces to finding the value of $t_{\\mathrm{Be}}$ that satisfies the constraint.\n\n**Step 3: Verdict and Action**\nThe problem is poorly structured as an optimization but contains a well-posed and solvable physical calculation. Recognizing that the \"optimization\" is a misnomer for a direct calculation, the problem is deemed valid for solution.\n\n**Solution**\n\n**1) Derivation of Individual Filter Transmission $T_i(E)$**\n\nThe one-dimensional photon number conservation law for a flux $I(x)$ traveling in the $x$-direction through a uniform medium with linear attenuation coefficient $\\mu$ is given by the differential equation:\n$$\n\\frac{dI}{dx} = -\\mu I(x)\n$$\nSeparating variables and integrating from the front surface ($x=0$, flux $I_0$) to a depth $x=t$ (flux $I(t)$) yields:\n$$\n\\int_{I_0}^{I(t)} \\frac{dI}{I} = \\int_0^t -\\mu dx \\implies \\ln\\left(\\frac{I(t)}{I_0}\\right) = -\\mu t\n$$\nThe spectral transmission $T$ is defined as the ratio of transmitted flux to incident flux, $T = I(t)/I_0$. Thus:\n$$\nT(E) = \\exp(-\\mu(E) t)\n$$\nThe linear attenuation coefficient $\\mu$ depends on the photon energy $E$. It is related to the mass attenuation coefficient $(\\mu/\\rho)$ and the material density $\\rho$ by:\n$$\n\\mu(E) = \\left(\\frac{\\mu}{\\rho}\\right)(E) \\cdot \\rho\n$$\nTherefore, the transmission of a single filter layer $i$ with thickness $t_i$ is:\n$$\nT_i(E) = \\exp\\left(-\\left(\\frac{\\mu}{\\rho}\\right)_i(E) \\rho_i t_i\\right)\n$$\nUsing the provided approximations for $E \\in [0.5, 2.0]\\,\\mathrm{keV}$:\n\n- For beryllium (Be):\n$$\nT_{\\mathrm{Be}}(E) = \\exp\\left(-(1.0\\times 10^{4}\\,E^{-3}) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}}\\right)\n$$\n\n- For aluminum (Al), with $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m}$:\n$$\nT_{\\mathrm{Al}}(E) = \\begin{cases} \\exp\\left(-(5.0\\times 10^{4}\\,E^{-3}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}}\\right) & E < 1.56\\,\\mathrm{keV} \\\\ \\exp\\left(-(1.5\\times 10^{5}\\,E^{-3}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}}\\right) & E \\ge 1.56\\,\\mathrm{keV} \\end{cases}\n$$\n\n- For polyimide (PI), with $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m}$:\n$$\nT_{\\mathrm{PI}}(E) = \\exp\\left(-(2.0\\times 10^{4}\\,E^{-3}) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}}\\right)\n$$\n\n**2) Derivation of Stack Transmission $T_{\\mathrm{stack}}(E)$**\n\nFor a stack of filters where interference effects are negligible (a valid assumption for x-rays), the total transmission is the product of the individual transmissions:\n$$\nT_{\\mathrm{stack}}(E) = T_{\\mathrm{Be}}(E) \\cdot T_{\\mathrm{Al}}(E) \\cdot T_{\\mathrm{PI}}(E)\n$$\nThis can be written as:\n$$\nT_{\\mathrm{stack}}(E) = \\exp\\left(-\\sum_{i \\in \\{\\mathrm{Be,Al,PI}\\}} \\left(\\frac{\\mu}{\\rho}\\right)_i(E) \\rho_i t_i\\right)\n$$\nSubstituting the expressions from Part 1 gives the full expression for the stack transmission. Due to the K-edge of aluminum, the expression is piecewise:\nFor $E < 1.56\\,\\mathrm{keV}$:\n$$\nT_{\\mathrm{stack}}(E) = \\exp\\left( -E^{-3} \\left[ (1.0\\times 10^{4}) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}} + (5.0\\times 10^{4}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + (2.0\\times 10^{4}) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} \\right] \\right)\n$$\nFor $E \\ge 1.56\\,\\mathrm{keV}$:\n$$\nT_{\\mathrm{stack}}(E) = \\exp\\left( -E^{-3} \\left[ (1.0\\times 10^{4}) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}} + (1.5\\times 10^{5}) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + (2.0\\times 10^{4}) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} \\right] \\right)\n$$\nwhere energies $E$ are in $\\mathrm{keV}$, densities $\\rho_i$ are in $\\mathrm{g\\,cm^{-3}}$, and thicknesses $t_i$ are in $\\mathrm{cm}$.\n\n**3) Calculation of Beryllium Thickness $t_{\\mathrm{Be}}$**\n\nAs established, the problem reduces to solving for $t_{\\mathrm{Be}}$ using the constraint $T_{\\mathrm{stack}}(E_m) = \\tau_{\\ast}$, where $E_m = 1.0\\,\\mathrm{keV}$ and $\\tau_{\\ast} = 0.20$. Since $E_m = 1.0\\,\\mathrm{keV} < 1.56\\,\\mathrm{keV}$, we use the first expression for $T_{\\mathrm{stack}}(E)$.\n$$\n\\tau_{\\ast} = \\exp\\left(-\\sum_{i} \\left(\\frac{\\mu}{\\rho}\\right)_i(E_m) \\rho_i t_i\\right)\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln(\\tau_{\\ast}) = -\\sum_{i} \\left(\\frac{\\mu}{\\rho}\\right)_i(E_m) \\rho_i t_i\n$$\n$$\n-\\ln(\\tau_{\\ast}) = \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Be}}(E_m) \\rho_{\\mathrm{Be}} t_{\\mathrm{Be}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E_m) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{PI}}(E_m) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}}\n$$\nWe can now solve for $t_{\\mathrm{Be}}$:\n$$\nt_{\\mathrm{Be}} = \\frac{-\\ln(\\tau_{\\ast}) - \\left[ \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E_m) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{PI}}(E_m) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} \\right]}{\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Be}}(E_m) \\rho_{\\mathrm{Be}}}\n$$\nFirst, we evaluate the mass attenuation coefficients at $E_m = 1.0\\,\\mathrm{keV}$:\n- $(\\mu/\\rho)_{\\mathrm{Be}}(1.0) = 1.0\\times 10^{4} \\cdot (1.0)^{-3} = 1.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}$\n- $(\\mu/\\rho)_{\\mathrm{Al}}(1.0) = 5.0\\times 10^{4} \\cdot (1.0)^{-3} = 5.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}$\n- $(\\mu/\\rho)_{\\mathrm{PI}}(1.0) = 2.0\\times 10^{4} \\cdot (1.0)^{-3} = 2.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}$\n\nNext, we calculate the dimensionless exponents for the fixed-thickness layers, ensuring consistent units. We convert thicknesses from $\\mu\\mathrm{m}$ to $\\mathrm{cm}$ ($1\\,\\mu\\mathrm{m} = 10^{-4}\\,\\mathrm{cm}$).\n- $t_{\\mathrm{Al}} = 0.050\\,\\mu\\mathrm{m} = 5.0 \\times 10^{-6}\\,\\mathrm{cm}$\n- $t_{\\mathrm{PI}} = 0.20\\,\\mu\\mathrm{m} = 2.0 \\times 10^{-5}\\,\\mathrm{cm}$\n\nExponent for Al:\n$$\n\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(1.0) \\rho_{\\mathrm{Al}} t_{\\mathrm{Al}} = (5.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}) \\cdot (2.70\\,\\mathrm{g\\,cm^{-3}}) \\cdot (5.0 \\times 10^{-6}\\,\\mathrm{cm}) = 0.675\n$$\nExponent for PI:\n$$\n\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{PI}}(1.0) \\rho_{\\mathrm{PI}} t_{\\mathrm{PI}} = (2.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}) \\cdot (1.43\\,\\mathrm{g\\,cm^{-3}}) \\cdot (2.0 \\times 10^{-5}\\,\\mathrm{cm}) = 0.572\n$$\nThe denominator term for the $t_{\\mathrm{Be}}$ expression is:\n$$\n\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Be}}(1.0) \\rho_{\\mathrm{Be}} = (1.0\\times 10^{4}\\,\\mathrm{cm^2\\,g^{-1}}) \\cdot (1.85\\,\\mathrm{g\\,cm^{-3}}) = 1.85 \\times 10^{4}\\,\\mathrm{cm^{-1}}\n$$\nNow, substitute these values into the equation for $t_{\\mathrm{Be}}$:\n$$\nt_{\\mathrm{Be}} = \\frac{-\\ln(0.20) - [0.675 + 0.572]}{1.85 \\times 10^{4}\\,\\mathrm{cm^{-1}}}\n$$\n$$\nt_{\\mathrm{Be}} = \\frac{\\ln(5) - 1.247}{1.85 \\times 10^{4}}\\,\\mathrm{cm}\n$$\nUsing $\\ln(5) \\approx 1.609438$:\n$$\nt_{\\mathrm{Be}} = \\frac{1.609438 - 1.247}{1.85 \\times 10^{4}}\\,\\mathrm{cm} = \\frac{0.362438}{1.85 \\times 10^{4}}\\,\\mathrm{cm} \\approx 1.9591 \\times 10^{-5}\\,\\mathrm{cm}\n$$\nThe problem requires the answer in units of micrometers ($\\mu\\mathrm{m}$).\n$$\nt_{\\mathrm{Be}} = 1.9591 \\times 10^{-5}\\,\\mathrm{cm} \\times \\frac{1\\,\\mu\\mathrm{m}}{10^{-4}\\,\\mathrm{cm}} = 0.19591\\,\\mu\\mathrm{m}\n$$\nRounding to three significant figures, we get:\n$$\nt_{\\mathrm{Be}} \\approx 0.196\\,\\mu\\mathrm{m}\n$$",
            "answer": "$$\\boxed{0.196}$$"
        },
        {
            "introduction": "After passing through filters, soft X-ray photons must be efficiently converted into a measurable signal. The key performance metric for this process is the quantum efficiency ($QE$), which quantifies the probability of a photon being detected. This exercise  guides you through constructing a $QE$ model for a back-illuminated CCD from first principles, accounting for realistic loss mechanisms like surface reflection and absorption in inactive layers. Understanding these factors is essential for accurately interpreting detector signals and selecting appropriate hardware for soft X-ray applications.",
            "id": "3719080",
            "problem": "A soft X-ray imaging diagnostic for a tokamak uses a back-illuminated Charge-Coupled Device (CCD) operated in the photon-counting regime to record emission near the wavelength $\\lambda=2\\,\\mathrm{nm}$. The CCD is back-illuminated through vacuum and has a uniform silicon dioxide ($\\text{SiO}_2$) passivation layer of thickness $t_{\\mathrm{ox}}=100\\,\\mathrm{nm}$ on the back surface. The depletion (active) silicon thickness is $t_{\\mathrm{dep}}=30\\,\\mathrm{\\mu m}$. Assume normal incidence, a backside reflectance at $\\lambda=2\\,\\mathrm{nm}$ of $R_{\\mathrm{b}}=0.05$, and that each absorbed soft X-ray photon produces a detectable event with probability $1$ in the photon-counting regime (no pile-up or dead-time losses). The CCD has an active area $A_{\\mathrm{det}}=1.00\\,\\mathrm{cm^{2}}$. The linear attenuation coefficients at $\\lambda=2\\,\\mathrm{nm}$ are $\\mu_{\\mathrm{Si}}=3.3\\times 10^{4}\\,\\mathrm{cm^{-1}}$ for silicon and $\\mu_{\\text{SiO}_2}=4.0\\times 10^{4}\\,\\mathrm{cm^{-1}}$ for silicon dioxide. A collimated, uniform photon flux $\\Phi=1.0\\times 10^{6}\\,\\mathrm{photons\\,cm^{-2}\\,s^{-1}}$ is incident on the detector.\n\nUsing basic definitions and the Beer–Lambert law, construct from first principles a symbolic expression for the wavelength-dependent quantum efficiency $QE(\\lambda)$ of this back-illuminated CCD that accounts for transmission through the $\\text{SiO}_2$ passivation layer, reflection losses at the backside surface, and absorption in the depletion region of silicon. Evaluate your expression at $\\lambda=2\\,\\mathrm{nm}$ using the given parameters. Then, compute the expected detected count rate for the given photon flux.\n\nRound your final numerical count rate to three significant figures and express it in $\\mathrm{s^{-1}}$.",
            "solution": "The problem requires the derivation of a symbolic expression for the quantum efficiency ($QE$) of a back-illuminated CCD and its numerical evaluation, followed by the calculation of the total detected count rate. The problem is physically well-posed and contains all necessary parameters for its solution.\n\nFirst, we construct the symbolic expression for the quantum efficiency, $QE(\\lambda)$, from first principles. The $QE$ represents the probability that an incident photon will be absorbed within the active (depletion) region of the detector, leading to a detectable event. This process can be modeled as a sequence of independent probabilistic events.\n\n1.  **Reflection Loss**: A collimated photon flux is incident on the back surface of the detector. A fraction of this flux, given by the reflectance $R_{\\mathrm{b}}(\\lambda)$, is reflected and does not enter the device. The fraction that is transmitted into the device is $(1 - R_{\\mathrm{b}}(\\lambda))$.\n\n2.  **Transmission through Passivation Layer**: The transmitted photons must first traverse the silicon dioxide ($\\text{SiO}_2$) passivation layer of thickness $t_{\\mathrm{ox}}$. According to the Beer-Lambert law, the intensity of radiation decreases exponentially as it passes through an absorbing medium. The fraction of photons that successfully pass through this layer without being absorbed is given by the transmission factor $T_{\\mathrm{ox}}(\\lambda) = \\exp(-\\mu_{\\text{SiO}_2}(\\lambda) t_{\\mathrm{ox}})$, where $\\mu_{\\text{SiO}_2}(\\lambda)$ is the linear attenuation coefficient of $\\text{SiO}_2$ at wavelength $\\lambda$.\n\n3.  **Absorption in Depletion Region**: Photons that emerge from the passivation layer enter the active silicon depletion region of thickness $t_{\\mathrm{dep}}$. A photon is detected if it is absorbed within this region. The fraction of photons entering the silicon that are then absorbed within the depth $t_{\\mathrm{dep}}$ is given by $(1 - T_{\\mathrm{dep}}(\\lambda))$, where $T_{\\mathrm{dep}}(\\lambda) = \\exp(-\\mu_{\\mathrm{Si}}(\\lambda) t_{\\mathrm{dep}})$ is the fraction that would pass through the depletion region unabsorbed. Here, $\\mu_{\\mathrm{Si}}(\\lambda)$ is the linear attenuation coefficient of silicon.\n\nThe total quantum efficiency is the product of the probabilities of these sequential events: the photon must enter the device, pass through the passivation layer, and then be absorbed in the depletion region. Therefore, the symbolic expression for the wavelength-dependent quantum efficiency is:\n$$QE(\\lambda) = (1 - R_{\\mathrm{b}}(\\lambda)) \\exp(-\\mu_{\\text{SiO}_2}(\\lambda) t_{\\mathrm{ox}}) (1 - \\exp(-\\mu_{\\mathrm{Si}}(\\lambda) t_{\\mathrm{dep}}))$$\nThis is the required expression derived from first principles.\n\nNext, we evaluate this expression at the given wavelength $\\lambda=2\\,\\mathrm{nm}$ using the provided parameters. We must first ensure all units are consistent. The attenuation coefficients are in $\\mathrm{cm^{-1}}$, so all thicknesses must be converted to $\\mathrm{cm}$.\nGiven thicknesses:\n$t_{\\mathrm{ox}} = 100\\,\\mathrm{nm} = 100 \\times 10^{-7}\\,\\mathrm{cm} = 1.0 \\times 10^{-5}\\,\\mathrm{cm}$\n$t_{\\mathrm{dep}} = 30\\,\\mathrm{\\mu m} = 30 \\times 10^{-4}\\,\\mathrm{cm} = 3.0 \\times 10^{-3}\\,\\mathrm{cm}$\n\nGiven parameters at $\\lambda=2\\,\\mathrm{nm}$:\nReflectance: $R_{\\mathrm{b}} = 0.05$\nAttenuation coefficient for $\\text{SiO}_2$: $\\mu_{\\text{SiO}_2} = 4.0 \\times 10^{4}\\,\\mathrm{cm^{-1}}$\nAttenuation coefficient for $\\mathrm{Si}$: $\\mu_{\\mathrm{Si}} = 3.3 \\times 10^{4}\\,\\mathrm{cm^{-1}}$\n\nWe calculate the dimensionless optical depths (the arguments of the exponential functions):\nFor the passivation layer: $\\tau_{\\mathrm{ox}} = \\mu_{\\text{SiO}_2} t_{\\mathrm{ox}} = (4.0 \\times 10^{4}\\,\\mathrm{cm^{-1}}) \\times (1.0 \\times 10^{-5}\\,\\mathrm{cm}) = 0.40$\nFor the depletion region: $\\tau_{\\mathrm{dep}} = \\mu_{\\mathrm{Si}} t_{\\mathrm{dep}} = (3.3 \\times 10^{4}\\,\\mathrm{cm^{-1}}) \\times (3.0 \\times 10^{-3}\\,\\mathrm{cm}) = 99$\n\nNow, we substitute these values into the $QE$ expression:\n$$QE(2\\,\\mathrm{nm}) = (1 - 0.05) \\times \\exp(-0.40) \\times (1 - \\exp(-99))$$\nThe term $\\exp(-99)$ is exceedingly small, approximately $1.01 \\times 10^{-43}$. Thus, the factor $(1 - \\exp(-99))$ is effectively $1$. This indicates that the depletion layer is optically thick, and essentially all soft X-ray photons that enter it are absorbed.\n$$QE(2\\,\\mathrm{nm}) \\approx (0.95) \\times \\exp(-0.40) \\times 1$$\n$$QE(2\\,\\mathrm{nm}) \\approx 0.95 \\times 0.670320... \\approx 0.636804$$\n\nFinally, we compute the expected detected count rate, $C$. The count rate is the product of the incident photon flux $\\Phi$, the detector's active area $A_{\\mathrm{det}}$, and the quantum efficiency $QE$. The problem states that every absorbed photon in the depletion region is detected.\n$$C = \\Phi \\times A_{\\mathrm{det}} \\times QE$$\nUsing the given values:\n$\\Phi = 1.0 \\times 10^{6}\\,\\mathrm{photons\\,cm^{-2}\\,s^{-1}}$\n$A_{\\mathrm{det}} = 1.00\\,\\mathrm{cm^{2}}$\n$$C = (1.0 \\times 10^{6}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (1.00\\,\\mathrm{cm^{2}}) \\times (0.636804)$$\n$$C \\approx 6.36804 \\times 10^{5}\\,\\mathrm{s^{-1}}$$\nThe problem requires the final numerical count rate to be rounded to three significant figures.\n$$C \\approx 6.37 \\times 10^{5}\\,\\mathrm{s^{-1}}$$",
            "answer": "$$\\boxed{6.37 \\times 10^{5}}$$"
        },
        {
            "introduction": "Most soft X-ray imaging systems measure line-integrated signals along various chords viewing the plasma. To extract the physically meaningful local emissivity profile, $\\varepsilon(r)$, one must solve a tomographic inverse problem, which is notoriously ill-posed and sensitive to measurement noise. This computational practice  introduces Tikhonov regularization as a powerful method to obtain stable and physically plausible solutions. You will implement the inversion and use the L-curve criterion to find the optimal balance between fitting the data and enforcing solution smoothness, a cornerstone technique in modern diagnostic data analysis.",
            "id": "3719091",
            "problem": "You are given a simplified axisymmetric model for Soft X-Ray (SXR) spectroscopy and imaging in a magnetic confinement fusion device. The plasma cross-section is approximated as a circle of minor radius $a$, and the SXR signal from each chord is modeled as a line integral of the local emissivity along the line-of-sight. This model reduces the inversion to recovering a radial emissivity profile from line-integrated measurements under the assumption of axisymmetry.\n\nStarting from Radiative Transfer in the optically thin limit and the Geometric Line-Integral definition:\n- The SXR signal along a straight chord at impact parameter $p$ (distance from the center) is $s(p) = \\int_{\\text{chord}} \\varepsilon(r) \\, ds$, where $\\varepsilon(r)$ is the emissivity as a function of radius $r$ and $ds$ is the path length element.\n- For a circular cross-section and axisymmetry, discretize the radius into $N$ concentric shells with boundaries $0 = r_0 < r_1 < \\cdots < r_N = a$, and approximate $\\varepsilon(r)$ as piecewise constant in each shell, with unknown constants $x_j$ for shell $j$.\n- The geometry matrix $A \\in \\mathbb{R}^{M \\times N}$ maps the shell emissivities to $M$ chord signals. For a chord at impact parameter $p_i$ and a shell bounded by $[r_{j-1}, r_j]$, the path length through that shell is given by the well-tested geometric relation $2 \\left( \\sqrt{\\max(r_j^2 - p_i^2, 0)} - \\sqrt{\\max(r_{j-1}^2 - p_i^2, 0)} \\right)$, which yields the element $A_{ij}$.\n\nGiven noisy measurements $\\mathbf{b} \\in \\mathbb{R}^M$ generated by a known synthetic emissivity profile, formulate a regularized least-squares inversion with Tikhonov smoothing:\n- Minimize $J(\\mathbf{x}; \\lambda) = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2 + \\lambda^2 \\lVert L \\mathbf{x} \\rVert_2^2$, where $L$ is a discrete second-derivative operator approximating curvature smoothing in radius, scaled appropriately by the shell spacing to reflect physical dimensions, and $\\lambda > 0$ is the regularization parameter.\n\nSelect the regularization parameter $\\lambda$ using the L-curve criterion:\n- Consider the parametric curve $(\\log_{10} \\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2, \\log_{10} \\lVert L \\mathbf{x}_\\lambda \\rVert_2)$ as $\\lambda$ varies over a logarithmic grid.\n- Define the curvature $\\kappa$ of a parametric curve $(x(t), y(t))$ with parameter $t$ by $\\kappa(t) = \\dfrac{\\lvert x'(t) y''(t) - y'(t) x''(t) \\rvert}{\\left( x'(t)^2 + y'(t)^2 \\right)^{3/2}}$. Use $t = \\log_{10}(\\lambda)$ and approximate derivatives with central differences on the discrete grid to find the index of the maximum curvature and select the corresponding $\\lambda$.\n\nImplement the program to:\n1. Construct the geometry matrix $A$ from chord impact parameters and shell boundaries.\n2. Build the Tikhonov operator $L$ as the discrete second derivative on the shells with uniform spacing $\\Delta r = a/N$, i.e., $$[L \\mathbf{x}]_k \\approx \\dfrac{x_k - 2 x_{k+1} + x_{k+2}}{(\\Delta r)^2}$$ for $k = 0, \\dots, N-3$.\n3. For a logarithmically spaced set of $\\lambda$ values, compute the regularized solutions $\\mathbf{x}_\\lambda$ and the corresponding residual norms $\\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2$ and roughness norms $\\lVert L \\mathbf{x}_\\lambda \\rVert_2$.\n4. Use the L-curve curvature to select $\\lambda$, then report the normalized root-mean-square error (RMSE) between the reconstructed $\\mathbf{x}_\\lambda$ and the true synthetic $\\mathbf{x}_{\\text{true}}$ as $\\sqrt{\\dfrac{\\frac{1}{N} \\sum_{j=1}^N (x_{\\lambda,j} - x_{\\text{true},j})^2}{\\frac{1}{N} \\sum_{j=1}^N x_{\\text{true},j}^2}}$, which is dimensionless.\n\nSynthetic emissivity for all test cases should be generated from a smooth, physically plausible profile combining a core-peaked component and an edge feature, evaluated at shell midpoints $r_{j-1/2} = \\dfrac{r_{j-1} + r_j}{2}$:\n$$ \\varepsilon_{\\text{true}}(r) = \\exp\\!\\left( -\\left( \\dfrac{r}{0.4 a} \\right)^2 \\right) + 0.2 \\exp\\!\\left( -\\left( \\dfrac{r - 0.8 a}{0.05 a} \\right)^2 \\right) $$\n\nNo physical units are required in the final output because the reported quantities (regularization parameter and normalized RMSE) are dimensionless.\n\nYour program must implement the above steps and produce results for the following test suite. For each case, synthesize $\\mathbf{b}$ by computing $A \\mathbf{x}_{\\text{true}}$ and adding independent and identically distributed Gaussian noise with standard deviation equal to the specified fraction of $\\max_i \\lvert (A \\mathbf{x}_{\\text{true}})_i \\rvert$, using the given random seed.\n\nTest Suite:\n- Case $1$: $a = 0.5$, $N = 32$, $M = 25$, chord impact parameters $p_i$ uniformly spaced in $[0, 0.95 a]$, noise fraction $0.01$, random seed $123$.\n- Case $2$: $a = 0.5$, $N = 32$, $M = 25$, chord impact parameters $p_i$ uniformly spaced in $[0, 0.95 a]$, noise fraction $0.05$, random seed $456$.\n- Case $3$: $a = 0.5$, $N = 25$, $M = 8$, chord impact parameters $p_i$ uniformly spaced in $[0, 0.95 a]$, noise fraction $0.03$, random seed $789$.\n\nAlgorithmic Requirements:\n- Construct $A$ using the shell path length formula.\n- Construct $L$ as described and include the $(\\Delta r)^{-2}$ scaling.\n- Solve the regularized least-squares problems for a grid of $\\lambda$ values (e.g., $60$ points spaced logarithmically from $10^{-6}$ to $10^{2}$).\n- Compute the discrete curvature on the L-curve using central differences with respect to $t = \\log_{10}(\\lambda)$, select $\\lambda$ with maximum curvature, reconstruct $\\mathbf{x}_\\lambda$, and compute the normalized RMSE.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\lambda_1, \\text{rmse}_1, \\lambda_2, \\text{rmse}_2, \\lambda_3, \\text{rmse}_3]$, where $\\lambda_k$ is the selected regularization parameter for case $k$, and $\\text{rmse}_k$ is the corresponding normalized RMSE. All outputs are dimensionless floats.",
            "solution": "The problem as stated constitutes a valid, well-posed exercise in numerical methods applied to inverse problems, specifically tomographic reconstruction in plasma physics. It is scientifically grounded, free of contradictions, and contains all necessary information to proceed with a solution. The task involves reconstructing a radial emissivity profile from a set of line-integrated measurements, a classic ill-posed problem for which Tikhonov regularization is a standard and appropriate solution method. The L-curve criterion is a widely used heuristic for selecting the regularization parameter.\n\nThe solution proceeds by implementing the specified algorithm in a step-by-step manner.\n\n1.  **System Modeling and Discretization**\n\nThe continuous physical model for the chord-integrated signal, $s(p) = \\int \\varepsilon(r) \\, ds$, is discretized to form a linear algebraic system. The plasma's circular cross-section of radius $a$ is divided into $N$ concentric annular shells of uniform width $\\Delta r = a/N$. The radial emissivity profile $\\varepsilon(r)$ is assumed to be constant within each shell $j$ (for $j=1, \\dots, N$), with value $x_j$. The set of all shell emissivities forms the unknown vector $\\mathbf{x} \\in \\mathbb{R}^N$.\n\nA set of $M$ measurements, $\\mathbf{b} \\in \\mathbb{R}^M$, are taken along chords, each defined by an impact parameter $p_i$ (for $i=1, \\dots, M$). The problem is to find $\\mathbf{x}$ given $\\mathbf{b}$. The linear relationship is given by $\\mathbf{b} \\approx A \\mathbf{x}$, where $A \\in \\mathbb{R}^{M \\times N}$ is the geometry matrix. Each element $A_{ij}$ represents the path length of the $i$-th chord through the $j$-th shell. Based on the geometry of a line intersecting an annulus, this path length is given by the specified formula:\n$$\nA_{ij} = 2 \\left( \\sqrt{\\max(r_j^2 - p_i^2, 0)} - \\sqrt{\\max(r_{j-1}^2 - p_i^2, 0)} \\right)\n$$\nwhere $r_j$ and $r_{j-1}$ are the outer and inner radii of the $j$-th shell, respectively.\n\n2.  **Tikhonov Regularization**\n\nTomographic inversion is typically an ill-posed problem, meaning small amounts of noise in the measurement vector $\\mathbf{b}$ can lead to large, unphysical oscillations in the solution vector $\\mathbf{x}$. Tikhonov regularization addresses this by adding a penalty term to the standard least-squares objective function. This penalty discourages solutions with undesirable properties, such as excessive roughness.\n\nThe objective is to find the emissivity profile $\\mathbf{x}$ that minimizes the Tikhonov functional:\n$$\nJ(\\mathbf{x}; \\lambda) = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2 + \\lambda^2 \\lVert L \\mathbf{x} \\rVert_2^2\n$$\nHere, the first term, $\\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2^2$, is the residual norm (or data fidelity term), which measures how well the solution fits the measurements. The second term, $\\lVert L \\mathbf{x} \\rVert_2^2$, is the regularization term (or penalty term), which measures the \"roughness\" of the solution. The regularization parameter, $\\lambda > 0$, controls the trade-off between fitting the data and maintaining a smooth solution.\n\nThe operator $L$ is chosen to approximate the second derivative of the emissivity profile with respect to radius. This choice enforces smoothness in the solution. For shells of uniform spacing $\\Delta r$, the discrete second derivative operator is constructed as a matrix of size $(N-2) \\times N$ whose application to $\\mathbf{x}$ yields a vector with elements:\n$$\n[L \\mathbf{x}]_k = \\frac{x_k - 2x_{k+1} + x_{k+2}}{(\\Delta r)^2} \\quad \\text{for } k=0, \\dots, N-3\n$$\nThe scaling factor $(\\Delta r)^{-2}$ ensures the operator is a consistent approximation of the continuous second derivative.\n\n3.  **Solving the Regularized System**\n\nThe vector $\\mathbf{x}_\\lambda$ that minimizes $J(\\mathbf{x}; \\lambda)$ is found by setting the gradient of $J$ with respect to $\\mathbf{x}$ to zero, which yields the normal equations for the regularized least-squares problem:\n$$\n(A^T A + \\lambda^2 L^T L) \\mathbf{x}_\\lambda = A^T \\mathbf{b}\n$$\nThis is a linear system of equations of size $N \\times N$. For any $\\lambda > 0$, the matrix $(A^T A + \\lambda^2 L^T L)$ is generally positive definite and thus invertible, leading to a unique solution $\\mathbf{x}_\\lambda$ for each value of $\\lambda$. The solution is computed by solving this system numerically.\n\n4.  **Optimal Regularization Parameter via the L-Curve Criterion**\n\nThe choice of $\\lambda$ is critical. The L-curve criterion is a heuristic method for making this selection. The L-curve is a parametric plot of the solution seminorm $\\log_{10} (\\lVert L \\mathbf{x}_\\lambda \\rVert_2)$ versus the residual norm $\\log_{10} (\\lVert A \\mathbf{x}_\\lambda - \\mathbf{b} \\rVert_2)$ for a range of $\\lambda$ values. The curve typically has a characteristic 'L' shape. The corner of the 'L' is considered to represent an optimal balance between data fidelity (small residual norm) and solution smoothness (small solution seminorm).\n\nThis corner corresponds to the point of maximum curvature on the L-curve. To find this point, we parameterize the curve $(x(t), y(t))$ by $t = \\log_{10}(\\lambda)$, where $x(t) = \\log_{10}(\\lVert A \\mathbf{x}_{\\lambda(t)} - \\mathbf{b} \\rVert_2)$ and $y(t) = \\log_{10}(\\lVert L \\mathbf{x}_{\\lambda(t)} \\rVert_2)$. The curvature $\\kappa$ is given by:\n$$\n\\kappa(t) = \\frac{\\lvert x'(t) y''(t) - y'(t) x''(t) \\rvert}{\\left( x'(t)^2 + y'(t)^2 \\right)^{3/2}}\n$$\nNumerically, the points $(x,y)$ are computed for a discrete logarithmic grid of $\\lambda$ values. The first and second derivatives ($x'$, $y'$, $x''$, $y''$) are then approximated using central differences with respect to the parameter $t$. The value of $\\lambda$ that maximizes $\\kappa(t)$ is selected as the optimal regularization parameter, $\\lambda_{\\text{opt}}$.\n\n5.  **Evaluation**\n\nOnce $\\lambda_{\\text{opt}}$ is determined, the final reconstructed profile $\\mathbf{x}_{\\lambda_{\\text{opt}}}$ is calculated. Its accuracy is quantified by comparing it to the known synthetic \"true\" profile, $\\mathbf{x}_{\\text{true}}$. The normalized root-mean-square error (RMSE) is used for this purpose:\n$$\n\\text{RMSE}_{\\text{norm}} = \\sqrt{\\frac{\\sum_{j=1}^N (x_{\\lambda_{\\text{opt}},j} - x_{\\text{true},j})^2}{\\sum_{j=1}^N x_{\\text{true},j}^2}} = \\frac{\\lVert \\mathbf{x}_{\\lambda_{\\text{opt}}} - \\mathbf{x}_{\\text{true}} \\rVert_2}{\\lVert \\mathbf{x}_{\\text{true}} \\rVert_2}\n$$\nThis dimensionless metric provides a measure of the relative error in the reconstruction.\n\nThe implementation proceeds by first generating the synthetic ground truth $\\mathbf{x}_{\\text{true}}$ and the noisy measurement vector $\\mathbf{b}$ for each test case. Then, for a grid of $\\lambda$ values, the corresponding $\\mathbf{x}_\\lambda$ is found and the L-curve coordinates are computed. Finally, the curvature is calculated to identify $\\lambda_{\\text{opt}}$, and the final RMSE is evaluated using this optimal parameter.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(a, N, M, p_max_frac, noise_fraction, seed):\n    \"\"\"\n    Implements the full tomographic inversion, L-curve analysis, and error\n    calculation for a single test case as specified in the problem statement.\n\n    Args:\n        a (float): Minor radius of the plasma.\n        N (int): Number of concentric shells for emissivity profile.\n        M (int): Number of measurement chords.\n        p_max_frac (float): Fraction of 'a' for the maximum impact parameter.\n        noise_fraction (float): Noise level as a fraction of the max signal.\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        tuple[float, float]: A tuple containing the optimal lambda and the\n                             normalized RMSE of the reconstruction.\n    \"\"\"\n    # 1. Define Grids and Parameters\n    # Shells\n    delta_r = a / N\n    r_boundaries = np.linspace(0, a, N + 1)\n    r_midpoints = (r_boundaries[:-1] + r_boundaries[1:]) / 2\n\n    # Chords\n    p_params = np.linspace(0, p_max_frac * a, M)\n\n    # 2. Generate True Emissivity Profile (x_true)\n    x_true = np.exp(-(r_midpoints / (0.4 * a))**2) + \\\n             0.2 * np.exp(-((r_midpoints - 0.8 * a) / (0.05 * a))**2)\n\n    # 3. Construct Geometry Matrix A\n    A = np.zeros((M, N))\n    for i in range(M):  # Loop over chords\n        p_i_sq = p_params[i]**2\n        for j in range(N):  # Loop over shells\n            r_j_sq = r_boundaries[j+1]**2\n            r_jm1_sq = r_boundaries[j]**2\n            \n            term1 = r_j_sq - p_i_sq\n            term2 = r_jm1_sq - p_i_sq\n\n            sqrt_term1 = np.sqrt(term1) if term1 > 0 else 0.0\n            sqrt_term2 = np.sqrt(term2) if term2 > 0 else 0.0\n            \n            A[i, j] = 2 * (sqrt_term1 - sqrt_term2)\n\n    # 4. Synthesize Measurements b (with noise)\n    b_clean = A @ x_true\n    noise_std = noise_fraction * np.max(np.abs(b_clean))\n    rng = np.random.default_rng(seed)\n    noise = rng.normal(loc=0.0, scale=noise_std, size=M)\n    b = b_clean + noise\n\n    # 5. Construct Tikhonov Operator L\n    L = np.zeros((N - 2, N))\n    # Fill the bands for the [1, -2, 1] stencil\n    for k in range(N - 2):\n        L[k, k] = 1.0\n        L[k, k+1] = -2.0\n        L[k, k+2] = 1.0\n    L /= (delta_r**2)\n\n    # 6. L-curve Analysis\n    lambdas = np.logspace(-6, 2, 60)\n    residual_norms = []\n    roughness_norms = []\n\n    ATA = A.T @ A\n    ATb = A.T @ b\n    LTL = L.T @ L\n\n    for lam in lambdas:\n        # Solve (A^T A + lambda^2 L^T L) x = A^T b\n        matrix_to_solve = ATA + lam**2 * LTL\n        x_lambda = np.linalg.solve(matrix_to_solve, ATb)\n\n        # Calculate norms for the L-curve\n        residual_norms.append(np.linalg.norm(A @ x_lambda - b))\n        roughness_norms.append(np.linalg.norm(L @ x_lambda))\n\n    # 7. Find Optimal Lambda via Curvature\n    residual_norms = np.array(residual_norms)\n    roughness_norms = np.array(roughness_norms)\n\n    # The L-curve is plotted on a log-log scale. Use a small epsilon to avoid log(0).\n    epsilon = 1e-16\n    log_res_norm = np.log10(residual_norms + epsilon)\n    log_rough_norm = np.log10(roughness_norms + epsilon)\n    log_lambdas = np.log10(lambdas)\n    \n    # Calculate derivatives wrt t = log10(lambda)\n    dx_dt = np.gradient(log_res_norm, log_lambdas)\n    dy_dt = np.gradient(log_rough_norm, log_lambdas)\n    \n    d2x_dt2 = np.gradient(dx_dt, log_lambdas)\n    d2y_dt2 = np.gradient(dy_dt, log_lambdas)\n\n    # Curvature formula for parametric curve (x(t), y(t))\n    numerator = np.abs(dx_dt * d2y_dt2 - dy_dt * d2x_dt2)\n    denominator = (dx_dt**2 + dy_dt**2)**1.5\n    \n    kappa = np.zeros_like(numerator)\n    # Only calculate curvature where denominator is non-negligible\n    valid_indices = denominator > epsilon\n    kappa[valid_indices] = numerator[valid_indices] / denominator[valid_indices]\n\n    # Optimal lambda corresponds to maximum curvature\n    opt_idx = np.argmax(kappa)\n    opt_lambda = lambdas[opt_idx]\n\n    # 8. Calculate Final Solution and Error\n    final_matrix_to_solve = ATA + opt_lambda**2 * LTL\n    x_opt = np.linalg.solve(final_matrix_to_solve, ATb)\n    \n    # Calculate Normalized RMSE\n    n_rmse = np.linalg.norm(x_opt - x_true) / np.linalg.norm(x_true)\n    \n    return opt_lambda, n_rmse\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, N, M, p_max_frac, noise_fraction, seed)\n        (0.5, 32, 25, 0.95, 0.01, 123),\n        (0.5, 32, 25, 0.95, 0.05, 456),\n        (0.5, 25, 8,  0.95, 0.03, 789),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, N, M, p_max_frac, noise_frac, seed = case\n        opt_lambda, n_rmse = process_case(a, N, M, p_max_frac, noise_frac, seed)\n        results.append(opt_lambda)\n        results.append(n_rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}