{
    "hands_on_practices": [
        {
            "introduction": "理解了正向问题后，下一步是解决逆问题：如何利用多条弦路的积分测量数据来重建等离子体参数（如电子密度 $n_e$）的二维空间分布。本练习介绍使用吉洪诺夫正则化（Tikhonov regularization）进行层析成像反演，这是一种功能强大且广泛应用的技术，用于解决等离子体诊断中常见的病态问题。",
            "id": "3704205",
            "problem": "您的任务是为通过干涉测量法和偏振测量法测得的非轴对称等离子体可观测量，构建并实现一种离散化层析成像反演方法。从等离子体视线诊断的基本物理关系和核心定义出发，推导经Tikhonov正则化后的最小二乘最小化器必须满足的条件。然后，实现所得到的正规方程，以从合成多弦数据中恢复体素化场。所有量都必须使用国际单位制（SI）处理。\n\n本问题的基础是以下广为接受的事实：\n- 对于穿过电子数密度为 $n_e(\\mathbf{r})$、磁场为 $\\mathbf{B}(\\mathbf{r})$ 的磁化等离子体的电磁波，沿弦线的干涉相移（在长波长极限下）可以很好地近似为 $n_e$ 的线积分乘以一个已知的比例常数。我们将此常数吸收到一个缩放因子中，从而得到单位为 $\\mathrm{m}^{-2}$ 的有效线积分电子柱密度。\n- 沿弦线的法拉第偏振旋转（单位为弧度）可以很好地近似为（同样在长波长极限下）乘积 $n_e B_{\\parallel}$ 的线积分乘以一个已知的比例常数。我们将此常数吸收到一个缩放因子中，从而得到单位为 $\\mathrm{T}\\cdot\\mathrm{m}^{-2}$ 的有效线积分 $n_e B_{\\parallel}$。角度请使用弧度。\n\n将一个二维横截面离散化为具有分段常数未知数的矩形体素。对于每条弦线 $m$，测量值被建模为体素值的加权和，权重等于每条弦线在每个体素中的路径长度，从而产生线性模型 $A x \\approx y$，其中：\n- $A \\in \\mathbb{R}^{M \\times N}$ 是路径长度的几何矩阵（单位为 $\\mathrm{m}$），\n- $x \\in \\mathbb{R}^{N}$ 是未知体素值的向量（$n_e$ 的单位为 $\\mathrm{m}^{-3}$ 或 $n_e B_{\\parallel}$ 的单位为 $\\mathrm{T}\\cdot\\mathrm{m}^{-3}$），\n- $y \\in \\mathbb{R}^{M}$ 是有效线积分测量的向量（单位为 $\\mathrm{m}^{-2}$ 或 $\\mathrm{T}\\cdot\\mathrm{m}^{-2}$）。\n\n为了稳定非轴对称和可能欠定的几何结构的反演，使用Tikhonov正则化，其正则化算子为 $L \\in \\mathbb{R}^{P \\times N}$（例如，用于促进平滑度的一阶有限差分，或用于岭回归的单位矩阵），以及一个先验 $x_0 \\in \\mathbb{R}^{N}$。\n\n任务1（推导）：\n- 从最小二乘优化的第一性原理出发，且不使用任何快捷公式，推导在最小化由数据失配项和对 $L(x - x_0)$ 的二次惩罚项（在欧几里得范数下）构成的目标函数时，Tikhonov正则化问题的最小化器必须满足的正规方程。清晰地陈述所有假设并展示每个逻辑步骤。\n\n任务2（实现）：\n- 实现一个程序，对下述每个测试用例，构建矩阵和向量，求解推导出的正规方程以获得 $x$，并输出恢复的体素值。您的求解器必须能够处理通用的矩形 $L$ 和通用的 $A$，并且除了指定的库之外，不得依赖任何外部库。\n- 恢复的电子密度以 $\\mathrm{m}^{-3}$ 表示，恢复的 $n_e B_{\\parallel}$ 以 $\\mathrm{T}\\cdot\\mathrm{m}^{-3}$ 表示。\n- 对于所有输出，数值需四舍五入至三位有效数字。\n- 角度（在与基础物理相关时）必须以弧度处理。\n\n测试套件：\n所有矩阵和向量都已明确给出；每个数值都以国际单位制（SI）单位提供。每个测试用例指定一个几何矩阵 $A$、一个正则化算子 $L$、一个正则化强度 $\\lambda$（单位为 $\\mathrm{m}$）、一个先验 $x_0$（在所有情况下均为零）和一个测量向量 $y$。\n\n对于测试用例1和2，体素排序的索引约定是在一个 $3\\times 3$ 网格中采用行主序：\n$$\n\\begin{bmatrix}\n0  1  2 \\\\\n3  4  5 \\\\\n6  7  8\n\\end{bmatrix}\n$$，\n对于测试用例3和4，则在一个 $2\\times 2$ 网格中采用行主序：\n$$\n\\begin{bmatrix}\n0  1 \\\\\n2  3\n\\end{bmatrix}\n$$。\n\n- 测试用例1（干涉测量，非轴对称，平滑度正则化）：\n  - 几何矩阵 $A \\in \\mathbb{R}^{6 \\times 9}$，行代表弦线：\n    1. 中部水平弦线，穿过体素 $[3,4,5]$，长度为 $[0.01,0.01,0.01]$ $\\mathrm{m}$。\n    2. 右侧垂直弦线，穿过体素 $[2,5,8]$，长度为 $[0.01,0.01,0.01]$ $\\mathrm{m}$。\n    3. 左上到右下对角弦线，穿过体素 $[0,4,8]$，长度为 $[0.01414,0.01414,0.01414]$ $\\mathrm{m}$。\n    4. 右上到左下对角弦线，穿过体素 $[2,4,6]$，长度为 $[0.01414,0.01414,0.01414]$ $\\mathrm{m}$。\n    5. 顶部水平弦线，穿过体素 $[0,1,2]$，长度为 $[0.01,0.01,0.01]$ $\\mathrm{m}$。\n    6. 中部垂直弦线，穿过体素 $[1,4,7]$，长度为 $[0.01,0.01,0.01]$ $\\mathrm{m}$。\n    明确地表示为：\n    $$\n    A = \\begin{bmatrix}\n    0  0  0  0.01  0.01  0.01  0  0  0 \\\\\n    0  0  0.01  0  0  0.01  0  0  0.01 \\\\\n    0.01414  0  0  0  0.01414  0  0  0  0.01414 \\\\\n    0  0  0.01414  0  0.01414  0  0.01414  0  0 \\\\\n    0.01  0.01  0.01  0  0  0  0  0  0 \\\\\n    0  0.01  0  0  0.01  0  0.01  0  0\n    \\end{bmatrix}.\n    $$\n  - 正则化算子 $L \\in \\mathbb{R}^{12 \\times 9}$，为 $3\\times 3$ 网格上的一阶差分，其行向量为：\n    水平差分：\n    $\n    [1,-1,0,0,0,0,0,0,0],\\ [0,1,-1,0,0,0,0,0,0],\\\n    [0,0,0,1,-1,0,0,0,0],\\ [0,0,0,0,1,-1,0,0,0],\\\n    [0,0,0,0,0,0,1,-1,0],\\ [0,0,0,0,0,0,0,1,-1]\n    $，\n    垂直差分：\n    $\n    [1,0,0,-1,0,0,0,0,0],\\ [0,1,0,0,-1,0,0,0,0],\\\n    [0,0,1,0,0,-1,0,0,0],\\ [0,0,0,1,0,0,-1,0,0],\\\n    [0,0,0,0,1,0,0,-1,0],\\ [0,0,0,0,0,1,0,0,-1].\n    $\n  - 正则化强度 $\\lambda = 0.02$ $\\mathrm{m}$，先验 $x_0 = \\mathbf{0}$。\n  - 测量向量 $y$，单位 $\\mathrm{m}^{-2}$：\n    $\n    y = [4.5\\times 10^{17},\\ 2.5\\times 10^{17},\\ 5.656\\times 10^{17},\\ 6.0802\\times 10^{17},\\ 3.2\\times 10^{17},\\ 4.8\\times 10^{17}].\n    $\n\n  恢复的 $x$ 单位必须是 $\\mathrm{m}^{-3}$。\n\n- 测试用例2（偏振测量，非轴对称，单位矩阵正则化）：\n  - 几何矩阵 $A \\in \\mathbb{R}^{6 \\times 9}$ 与测试用例1相同。\n  - 正则化算子 $L = I_{9}$ (单位矩阵)，$\\lambda = 0.03$ $\\mathrm{m}$，先验 $x_0 = \\mathbf{0}$。\n  - 测量向量 $y$ 是有效线积分 $n_e B_{\\parallel}$，单位为 $\\mathrm{T}\\cdot\\mathrm{m}^{-2}$：\n    $\n    y = [7.5\\times 10^{17},\\ 5.2\\times 10^{17},\\ 1.15948\\times 10^{18},\\ 9.898\\times 10^{17},\\ 6.5\\times 10^{17},\\ 8.5\\times 10^{17}].\n    $\n  恢复的 $x$ 必须是 $n_e B_{\\parallel}$，单位为 $\\mathrm{T}\\cdot\\mathrm{m}^{-3}$。\n\n- 测试用例3（干涉测量，欠定 $2\\times 2$ 网格，单位矩阵正则化）：\n  - 几何矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$：\n    $$\n    A = \\begin{bmatrix}\n    0.01  0.01  0  0 \\\\\n    0.01  0  0.01  0 \\\\\n    0.01414  0  0  0.01414\n    \\end{bmatrix}.\n    $$\n  - 正则化算子 $L = I_{4}$，$\\lambda = 0.005$ $\\mathrm{m}$，先验 $x_0 = \\mathbf{0}$。\n  - 测量向量 $y$，单位 $\\mathrm{m}^{-2}$：\n    $\n    y = [2.7\\times 10^{17},\\ 3.2\\times 10^{17},\\ 3.535\\times 10^{17}].\n    $\n  恢复的 $x$ 单位必须是 $\\mathrm{m}^{-3}$。\n\n- 测试用例4（干涉测量，与测试用例3相同，但使用强正则化）：\n  - 几何矩阵 $A$ 和算子 $L$ 与测试用例3相同。\n  - $\\lambda = 1.0$ $\\mathrm{m}$，先验 $x_0 = \\mathbf{0}$。\n  - 测量向量 $y$ 与测试用例3相同。\n  恢复的 $x$ 单位必须是 $\\mathrm{m}^{-3}$。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身也是一个逗号分隔的列表，包含恢复的体素值。这些值需四舍五入到三位有效数字并以科学记数法格式化。输出中不得包含任何空格。例如：$[ [\\dots], [\\dots], [\\dots], [\\dots] ]$，但无空格： \"[[case1_values],[case2_values],[case3_values],[case4_values]]\"。",
            "solution": "该问题要求推导并实现一个Tikhonov正则化线性反问题的解，这是等离子体物理中层析成像重建的标准方法。该过程分为两个任务：首先，从第一性原理推导正规方程；其次，根据提供的测试用例实现这些方程的数值求解器。\n\n### 任务1：正规方程的推导\n\n问题在于，给定一组线积分测量值 $y \\in \\mathbb{R}^{M}$，找到一个体素值向量 $x \\in \\mathbb{R}^{N}$，以最佳地表示等离子体的状态。未知数与测量值之间的关系由线性系统 $Ax \\approx y$ 建模，其中 $A \\in \\mathbb{R}^{M \\times N}$ 是包含测量弦线穿过每个体素的路径长度的几何矩阵。\n\n由于许多层析成像问题具有不适定性（例如，问题是欠定的或矩阵 $A$ 是病态的），我们引入Tikhonov正则化来稳定解。目标是找到向量 $x$，使包含数据保真项和正则化项的复合目标函数 $J(x)$ 最小化。\n\n目标函数 $J(x)$ 定义为数据失配的欧几里得范数平方与正则化项的欧几里得范数平方之和：\n$$ J(x) = \\|Ax - y\\|_2^2 + \\alpha \\|L(x - x_0)\\|_2^2 $$\n在这里，$L \\in \\mathbb{R}^{P \\times N}$ 是正则化算子，$x_0 \\in \\mathbb{R}^{N}$ 是解的先验估计，$\\alpha$ 是一个平衡这两项的标量正则化参数。\n\n问题指定了一个正则化强度 $\\lambda$，其单位为长度（米，$\\mathrm{m}$）。为确保目标函数的量纲一致性，我们必须恰当地设置参数 $\\alpha$。让我们分析一下干涉测量情况下的单位：\n- 测量向量 $y$ 的单位是 $\\mathrm{m}^{-2}$。因此，数据失配项 $\\|Ax - y\\|_2^2$ 的单位是 $(\\mathrm{m}^{-2})^2 = \\mathrm{m}^{-4}$。\n- 未知向量 $x$ 的单位是 $\\mathrm{m}^{-3}$。如果正则化算子 $L$ 是无量纲的（如单位矩阵或有限差分算子），则正则化项 $\\|L(x - x_0)\\|_2^2$ 的单位是 $(\\mathrm{m}^{-3})^2 = \\mathrm{m}^{-6}$。\n\n为了使两项可以相加，$\\alpha$ 的单位必须是 $\\mathrm{m}^2$。给定 $\\lambda$ 的单位是米，一个自然且常见的选择是 $\\alpha = \\lambda^2$。因此，目标函数为：\n$$ J(x) = \\|Ax - y\\|_2^2 + \\lambda^2 \\|L(x - x_0)\\|_2^2 $$\n\n为了找到最小化此函数的向量 $x$，我们必须找到 $J(x)$ 相对于 $x$ 的梯度为零向量的位置。首先，我们使用转置表示法将范数的平方表示为点积，对于向量 $v$，有 $\\|v\\|_2^2 = v^T v$：\n$$ J(x) = (Ax - y)^T(Ax - y) + \\lambda^2 (L(x - x_0))^T(L(x - x_0)) $$\n\n展开这些项：\n$$ J(x) = (x^T A^T - y^T)(Ax - y) + \\lambda^2 (x - x_0)^T L^T L (x - x_0) $$\n$$ J(x) = (x^T A^T Ax - x^T A^T y - y^T A x + y^T y) + \\lambda^2 (x^T L^T L x - x^T L^T L x_0 - x_0^T L^T L x + x_0^T L^T L x_0) $$\n\n注意到标量项 $y^T A x$ 和 $x_0^T L^T L x$ 分别等于它们的转置 $x^T A^T y$ 和 $x^T L^T L x_0$，我们可以简化表达式：\n$$ J(x) = x^T (A^T A) x - 2 y^T A x + y^T y + \\lambda^2 [x^T (L^T L) x - 2 x_0^T L^T L x + x_0^T L^T L x_0] $$\n\n现在，我们使用标准的矩阵微积分恒等式来计算梯度 $\\nabla_x J(x) = \\frac{\\partial J(x)}{\\partial x}$：$\\frac{\\partial}{\\partial x} (c^T x) = c$ 和 $\\frac{\\partial}{\\partial x} (x^T M x) = (M + M^T)x$。由于 $A^T A$ 和 $L^T L$ 都是对称矩阵，二次项的导数简化为 $2(A^T A)x$ 和 $2(L^T L)x$。\n\n对 $J(x)$ 中的每一项关于 $x$ 求导：\n- $\\frac{\\partial}{\\partial x} (x^T (A^T A) x) = 2(A^T A)x$\n- $\\frac{\\partial}{\\partial x} (-2 y^T A x) = -2 A^T y$\n- $\\frac{\\partial}{\\partial x} (y^T y) = 0$ (相对于 $x$ 是常数)\n- $\\frac{\\partial}{\\partial x} (\\lambda^2 x^T (L^T L) x) = 2 \\lambda^2 (L^T L)x$\n- $\\frac{\\partial}{\\partial x} (-2 \\lambda^2 x_0^T L^T L x) = -2 \\lambda^2 (L^T L)x_0$\n- $\\frac{\\partial}{\\partial x} (\\lambda^2 x_0^T L^T L x_0) = 0$ (相对于 $x$ 是常数)\n\n将这些导数相加得到 $J(x)$ 的梯度：\n$$ \\nabla_x J(x) = 2(A^T A)x - 2 A^T y + 2 \\lambda^2 (L^T L)x - 2 \\lambda^2 (L^T L)x_0 $$\n\n我们通过将其梯度设为零向量来找到 $J(x)$ 的最小值：\n$$ 2(A^T A)x - 2 A^T y + 2 \\lambda^2 (L^T L)x - 2 \\lambda^2 (L^T L)x_0 = \\mathbf{0} $$\n\n除以 $2$ 并重新整理各项以分离 $x$：\n$$ (A^T A)x + \\lambda^2 (L^T L)x = A^T y + \\lambda^2 (L^T L)x_0 $$\n$$ (A^T A + \\lambda^2 L^T L)x = A^T y + \\lambda^2 L^T L x_0 $$\n\n这就是Tikhonov正则化的正规方程的一般形式。对于本问题中的具体情况，先验给定为 $x_0 = \\mathbf{0}$。这简化了方程的右侧：\n$$ (A^T A + \\lambda^2 L^T L)x = A^T y $$\n\n这是一个形式为 $M_{sys} x = b_{sys}$ 的线性系统，其中系统矩阵 $M_{sys} = A^T A + \\lambda^2 L^T L$，右侧向量 $b_{sys} = A^T y$。解 $x$ 可以使用标准的线性代数求解器找到。只要 $A$ 和 $L$ 的零空间没有非平凡的交集，对于 $\\lambda > 0$，矩阵 $M_{sys}$ 就保证是可逆的，这个问题中使用的正则化算子满足该条件。\n\n### 任务2：实现\n\n实现直接遵循推导出的正规方程。对于每个测试用例，一个Python脚本执行以下步骤：\n1.  使用`numpy`数组定义矩阵 $A$ 和 $L$、测量向量 $y$、先验向量 $x_0$ 和正则化参数 $\\lambda$，这些数据均来自问题陈述。\n2.  构建系统矩阵 $M_{sys} = A^T A + \\lambda^2 L^T L$。矩阵转置和乘法使用`numpy`的`.T`属性和`@`运算符执行。\n3.  构建右侧向量 $b_{sys} = A^T y$（因为所有测试用例中 $x_0=\\mathbf{0}$）。\n4.  使用函数`np.linalg.solve()`求解线性系统 $M_{sys} x = b_{sys}$ 以得到未知向量 $x$。\n5.  将得到的解向量 $x$ 的元素格式化为表示三位有效数字的科学记数法字符串（例如 `1.23e+19`）。\n6.  将所有测试用例的格式化字符串连接成符合指定格式 `[[case1_results],[case2_results],...]` 的单行输出，不含任何空白字符。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Tikhonov-regularized tomographic inversion problem for the given test cases.\n    \"\"\"\n\n    def format_vector(x_vec):\n        \"\"\"\n        Formats a vector into a comma-separated string of values in scientific\n        notation with three significant figures.\n        \"\"\"\n        return ','.join([f\"{val:.2e}\" for val in x_vec])\n\n    def solve_tikhonov(A, L, lambd, x0, y):\n        \"\"\"\n        Solves the Tikhonov-regularized system (A^T A + lambda^2 L^T L)x = A^T y + lambda^2 L^T L x0.\n        \"\"\"\n        lambda_sq = lambd**2\n        \n        # Construct the system matrix M = A^T A + lambda^2 L^T L\n        M_sys = A.T @ A + lambda_sq * (L.T @ L)\n        \n        # Construct the right-hand-side vector b = A^T y + lambda^2 L^T L x0\n        # Since x0 is zero in all test cases, this simplifies to b = A^T y\n        b_sys = A.T @ y + lambda_sq * (L.T @ L) @ x0\n\n        # Solve the linear system Mx = b for x\n        x_recovered = np.linalg.solve(M_sys, b_sys)\n        \n        return x_recovered\n\n    # --- Test Case 1: Interferometry, smoothness regularization ---\n    A1 = np.array([\n        [0, 0, 0, 0.01, 0.01, 0.01, 0, 0, 0],\n        [0, 0, 0.01, 0, 0, 0.01, 0, 0, 0.01],\n        [0.01414, 0, 0, 0, 0.01414, 0, 0, 0, 0.01414],\n        [0, 0, 0.01414, 0, 0.01414, 0, 0.01414, 0, 0],\n        [0.01, 0.01, 0.01, 0, 0, 0, 0, 0, 0],\n        [0, 0.01, 0, 0, 0.01, 0, 0.01, 0, 0]\n    ])\n    L1 = np.array([\n        # Horizontal differences\n        [1, -1, 0, 0, 0, 0, 0, 0, 0], [0, 1, -1, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 1, -1, 0, 0, 0, 0], [0, 0, 0, 0, 1, -1, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 1, -1, 0], [0, 0, 0, 0, 0, 0, 0, 1, -1],\n        # Vertical differences\n        [1, 0, 0, -1, 0, 0, 0, 0, 0], [0, 1, 0, 0, -1, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0, -1, 0, 0, 0], [0, 0, 0, 1, 0, 0, -1, 0, 0],\n        [0, 0, 0, 0, 1, 0, 0, -1, 0], [0, 0, 0, 0, 0, 1, 0, 0, -1]\n    ])\n    lambda1 = 0.02\n    x0_1 = np.zeros(9)\n    y1 = np.array([4.5e17, 2.5e17, 5.656e17, 6.0802e17, 3.2e17, 4.8e17])\n    \n    # --- Test Case 2: Polarimetry, identity regularization ---\n    A2 = A1  # Same geometry as Case 1\n    L2 = np.identity(9)\n    lambda2 = 0.03\n    x0_2 = np.zeros(9)\n    y2 = np.array([7.5e17, 5.2e17, 1.15948e18, 9.898e17, 6.5e17, 8.5e17])\n\n    # --- Test Case 3: Interferometry, underdetermined, identity regularization ---\n    A3 = np.array([\n        [0.01, 0.01, 0, 0],\n        [0.01, 0, 0.01, 0],\n        [0.01414, 0, 0, 0.01414]\n    ])\n    L3 = np.identity(4)\n    lambda3 = 0.005\n    x0_3 = np.zeros(4)\n    y3 = np.array([2.7e17, 3.2e17, 3.535e17])\n\n    # --- Test Case 4: Interferometry, strong regularization ---\n    A4 = A3  # Same geometry as Case 3\n    L4 = L3  # Same regularization operator as Case 3\n    lambda4 = 1.0\n    x0_4 = x0_3 # Same prior\n    y4 = y3  # Same measurements\n\n    # Consolidate test cases\n    test_cases = [\n        (A1, L1, lambda1, x0_1, y1),\n        (A2, L2, lambda2, x0_2, y2),\n        (A3, L3, lambda3, x0_3, y3),\n        (A4, L4, lambda4, x0_4, y4),\n    ]\n\n    # Process all test cases and collect results\n    results_list = []\n    for A, L, lambd, x0, y in test_cases:\n        x_recovered = solve_tikhonov(A, L, lambd, x0, y)\n        results_list.append(f\"[{format_vector(x_recovered)}]\")\n\n    # Print final output in the required format\n    print(f\"[{','.join(results_list)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实世界的测量总是会受到噪声的影响，尤其是在高时间分辨率下。本练习聚焦于外差干涉仪数据处理的一个关键方面：通过相干平均提高信噪比 $SNR$。它将量化降噪效果与解析快速等离子体波动能力之间的基本权衡，这是在实验数据分析中必须做出的一个核心考量。",
            "id": "3704245",
            "problem": "用于核聚变等离子体诊断的微波外差干涉仪通过测量探测光束的相位来确定线积分电子密度。该相位是通过将探测光束与一个失谐的本振信号混频得到的，混频后产生一个频率为 $f_b$ 的拍频信号。解调后的复信号建模为 $x(t) = \\phi(t) + w(t)$，其中 $\\phi(t)$ 是真实的等离子体相位，而 $w(t)$ 是加性高斯白噪声 (Additive White Gaussian Noise (AWGN))。该噪声是零均值的，在连续的拍频周期内统计独立，并且在平均区间内是平稳的。为了提高信噪比 (Signal-to-Noise Ratio, SNR)，数据处理过程对 $N$ 个连续拍频周期内的解调复数样本进行相干平均，这等效于一个时长为 $T_{\\text{avg}} = N/f_b$ 的矩形移动平均。\n\n假设线平均电子密度在一个缓慢变化的背景上叠加了一个小的正弦波动，因此相位可以写为 $\\phi(t) = \\phi_0 + \\Delta \\phi \\cos(2\\pi f_{\\text{var}} t)$，其中波动频率为 $f_{\\text{var}}$。$\\phi(t)$ 的估计量是移动平均的输出 $y(t) = \\frac{1}{T_{\\text{avg}}} \\int_{t - T_{\\text{avg}}}^{t} x(\\tau)\\, d\\tau$。\n\n给定 $f_b = 2.0 \\times 10^{6}$ Hz，$N = 100$，以及 $f_{\\text{var}} = 1.0 \\times 10^{4}$ Hz：\n\n- 在 $w(t)$ 于各拍频周期内独立的假设下，计算通过相干平均相对于未经平均的估计量所实现的信噪比改善因子（以功率计）。\n- 通过计算平均窗口对频率为 $f_{\\text{var}}$ 的正弦波动所引入的幅度衰减，来量化在时间分辨率上的权衡。该幅度衰减即为滤波器在角频率 $\\omega_{\\text{var}} = 2\\pi f_{\\text{var}}$ 处的频率响应的幅度。\n\n将最终答案表示为一个行矩阵，其中包含两个无量纲数，顺序为 [信噪比改善因子, 幅度衰减]。将答案四舍五入至四位有效数字。幅度衰减是一个幅度比（无量纲）。信噪比改善因子是无量纲的。",
            "solution": "这个问题提法明确且有科学依据。它要求将信号处理的基本原理应用于等离子体诊断中的一个现实场景。我们将按顺序解决问题的两个部分。\n\n第一部分：信噪比改善因子\n\n功率信噪比 (SNR) 定义为信号功率与噪声功率之比。改善因子是平均后的信噪比与平均前的信噪比之比。\n设解调信号为 $x(t) = \\phi(t) + w(t)$，其中 $\\phi(t)$ 是所需信号（等离子体相位），$w(t)$ 是加性高斯白噪声 (AWGN)。\n\n“未经平均的估计量”可以被看作是在一个拍频周期内对带噪信号的单次采样。设此单一样本的噪声分量的方差为 $\\sigma_w^2$。这对应于输入噪声功率，$P_{n, \\text{in}} = \\sigma_w^2$。设信号功率为 $P_{s, \\text{in}}$。输入信噪比为 $SNR_{\\text{in}} = P_{s, \\text{in}} / P_{n, \\text{in}}$。\n\n题目指出，对 $N$ 个连续的拍频周期进行相干平均。噪声 $w(t)$ 被指定为“在连续的拍频周期内统计独立”。这使我们可以将 $N$ 个连续样本的噪声分量 $w_1, w_2, \\dots, w_N$ 建模为独立同分布 (i.i.d.) 的随机变量，每个变量的均值为零，方差为 $\\sigma_w^2$。\n\n平均过程计算这 $N$ 个样本的算术平均值。得到的噪声分量为 $w_{\\text{avg}} = \\frac{1}{N} \\sum_{i=1}^{N} w_i$。这个平均后噪声的方差即为输出噪声功率 $P_{n, \\text{out}}$。由于样本是独立的：\n$$P_{n, \\text{out}} = \\text{Var}(w_{\\text{avg}}) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} w_i\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\text{Var}(w_i) = \\frac{1}{N^2} (N \\sigma_w^2) = \\frac{\\sigma_w^2}{N}$$\n所以，噪声功率降低了 $N$ 倍：\n$$P_{n, \\text{out}} = \\frac{P_{n, \\text{in}}}{N}$$\n“相干平均”意味着与拍频相比变化缓慢的信号分量会相干叠加。对于在平均周期 $T_{\\text{avg}}$ 内几乎恒定的信号，平均过程会保持信号的幅度。因此，输出信号功率 $P_{s, \\text{out}}$ 约等于输入信号功率 $P_{s, \\text{in}}$。\n\n输出信噪比为 $SNR_{\\text{out}} = P_{s, \\text{out}} / P_{n, \\text{out}}$。信噪比改善因子 $I_{SNR}$ 为：\n$$I_{SNR} = \\frac{SNR_{\\text{out}}}{SNR_{\\text{in}}} = \\frac{P_{s, \\text{out}}/P_{n, \\text{out}}}{P_{s, \\text{in}}/P_{n, \\text{in}}} = \\left(\\frac{P_{s, \\text{out}}}{P_{s, \\text{in}}}\\right) \\left(\\frac{P_{n, \\text{in}}}{P_{n, \\text{out}}}\\right)$$\n代入功率之间的关系，我们得到：\n$$I_{SNR} \\approx (1) \\left(\\frac{P_{n, \\text{in}}}{P_{n, \\text{in}}/N}\\right) = N$$\n给定 $N=100$，信噪比改善因子恰好为 $100$。表示为四位有效数字，即为 $100.0$。\n\n第二部分：幅度衰减\n\n估计量被定义为一个移动平均滤波器：\n$$y(t) = \\frac{1}{T_{\\text{avg}}} \\int_{t - T_{\\text{avg}}}^{t} x(\\tau)\\, d\\tau$$\n这个操作是输入信号 $x(t)$ 与一个矩形冲激响应 $h(t)$ 的卷积，其中：\n$$h(t) = \\begin{cases} 1/T_{\\text{avg}}  \\text{if } 0 \\le t \\le T_{\\text{avg}} \\\\ 0  \\text{otherwise} \\end{cases}$$\n正弦分量的幅度衰减由滤波器在正弦波频率处的频率响应 $H(\\omega) = \\mathcal{F}\\{h(t)\\}$ 的幅度给出。频率响应是冲激响应的傅里叶变换：\n$$H(\\omega) = \\int_{-\\infty}^{\\infty} h(t) \\exp(-i\\omega t) \\,dt = \\frac{1}{T_{\\text{avg}}} \\int_{0}^{T_{\\text{avg}}} \\exp(-i\\omega t) \\,dt$$\n$$H(\\omega) = \\frac{1}{T_{\\text{avg}}} \\left[ \\frac{\\exp(-i\\omega t)}{-i\\omega} \\right]_{0}^{T_{\\text{avg}}} = \\frac{1}{T_{\\text{avg}}} \\frac{\\exp(-i\\omega T_{\\text{avg}}) - 1}{-i\\omega}$$\n为了求其幅度，我们可以重写这个表达式：\n$$H(\\omega) = \\frac{\\exp(-i\\omega T_{\\text{avg}}/2)}{-i\\omega T_{\\text{avg}}} \\left( \\exp(-i\\omega T_{\\text{avg}}/2) - \\exp(i\\omega T_{\\text{avg}}/2) \\right)$$\n$$H(\\omega) = \\frac{\\exp(-i\\omega T_{\\text{avg}}/2)}{-i\\omega T_{\\text{avg}}} \\left( -2i \\sin(\\omega T_{\\text{avg}}/2) \\right) = \\exp(-i\\omega T_{\\text{avg}}/2) \\frac{\\sin(\\omega T_{\\text{avg}}/2)}{\\omega T_{\\text{avg}}/2}$$\n幅度衰减是这个复函数的模：\n$$|H(\\omega)| = \\left| \\exp(-i\\omega T_{\\text{avg}}/2) \\right| \\left| \\frac{\\sin(\\omega T_{\\text{avg}}/2)}{\\omega T_{\\text{avg}}/2} \\right| = \\left| \\frac{\\sin(\\omega T_{\\text{avg}}/2)}{\\omega T_{\\text{avg}}/2} \\right|$$\n这是归一化sinc函数的幅度。我们需要在波动的角频率 $\\omega_{\\text{var}} = 2\\pi f_{\\text{var}}$ 处对此进行求值。平均时间为 $T_{\\text{avg}} = N/f_b$。\n函数的自变量变为：\n$$\\frac{\\omega_{\\text{var}} T_{\\text{avg}}}{2} = \\frac{(2\\pi f_{\\text{var}})(N/f_b)}{2} = \\frac{\\pi N f_{\\text{var}}}{f_b}$$\n代入给定值：\n$N = 100$，$f_{\\text{var}} = 1.0 \\times 10^4$ Hz，以及 $f_b = 2.0 \\times 10^6$ Hz。\n$$\\frac{\\pi N f_{\\text{var}}}{f_b} = \\frac{\\pi \\times 100 \\times (1.0 \\times 10^4)}{2.0 \\times 10^6} = \\frac{\\pi \\times 10^2 \\times 10^4}{2 \\times 10^6} = \\frac{\\pi \\times 10^6}{2 \\times 10^6} = \\frac{\\pi}{2}$$\n因此，幅度衰减为：\n$$|H(\\omega_{\\text{var}})| = \\left| \\frac{\\sin(\\pi/2)}{\\pi/2} \\right| = \\frac{1}{\\pi/2} = \\frac{2}{\\pi}$$\n现在，我们计算其数值并四舍五入到四位有效数字：\n$$\\frac{2}{\\pi} \\approx 0.63661977...$$\n精确到四位有效数字，幅度衰减为 $0.6366$。\n\n最终答案是一个包含信噪比改善因子 ($100.0$) 和幅度衰减 ($0.6366$) 的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n100.0  0.6366\n\\end{pmatrix}\n}\n$$"
        }
    ]
}