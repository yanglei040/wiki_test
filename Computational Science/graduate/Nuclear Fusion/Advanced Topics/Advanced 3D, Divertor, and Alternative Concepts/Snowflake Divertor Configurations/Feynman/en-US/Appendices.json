{
    "hands_on_practices": [
        {
            "introduction": "The unique properties of a snowflake divertor originate from its specific magnetic topology. This exercise guides you through a first-principles derivation of the local magnetic structure near a second-order null point. By applying a Taylor expansion to the poloidal flux function $\\psi$ and using the vacuum Grad-Shafranov equation, you will uncover the characteristic cubic dependence that gives the snowflake configuration its name and its favorable heat-handling properties . This practice is essential for understanding the fundamental magnetohydrodynamic basis of advanced divertor concepts.",
            "id": "3718892",
            "problem": "Consider an axisymmetric toroidal plasma equilibrium in a region near a poloidal magnetic field null point at cylindrical coordinates $(R,Z) = (R_{0},Z_{0})$, where the poloidal magnetic flux function $\\psi(R,Z)$ is smooth. In the neighborhood of the null, introduce local Cartesian coordinates $x = R - R_{0}$ and $y = Z - Z_{0}$, and assume the vacuum approximation holds so that the local equilibrium is governed by the homogeneous axisymmetric operator acting on the poloidal flux function. The equilibrium condition is that $\\psi(R,Z)$ satisfies the magnetostatic Grad–Shafranov operator in vacuum, which in local coordinates reduces to a second-order, linear, elliptic partial differential equation. A snowflake divertor corresponds to a second-order null of the poloidal magnetic field, meaning that both the first derivatives and the second derivatives of $\\psi$ vanish at $(R_{0},Z_{0})$.\n\nUsing only fundamental magnetostatic equilibrium principles and well-tested local modeling assumptions for axisymmetric toroidal systems:\n- Derive the leading-order local partial differential equation for $\\psi(x,y)$ near $(R_{0},Z_{0})$, and justify a consistent dominant-balance reduction to the two-dimensional Laplace equation for the leading nonvanishing term in the Taylor expansion of $\\psi$ under the snowflake conditions.\n- Impose the snowflake conditions at the null and obtain the most general analytic cubic-order solution for the leading nonzero term $\\psi(x,y) - \\psi(R_{0},Z_{0})$ that is consistent with the reduced equation. Express this solution in polar form $(x,y) = (r\\cos\\theta, r\\sin\\theta)$ and identify the angular dependence explicitly.\n- From your derived leading-order expression, determine the angular directions $\\theta$ (measured from the $+x$ axis in the poloidal plane) along which the level set $\\psi(x,y) = \\psi(R_{0},Z_{0})$ emanates from the null. Then, for the specific case where the cubic-order angular dependence is characterized by constants $A$ and $B$ such that the leading-order expansion has the form\n$$\n\\psi(x,y) - \\psi(R_{0},Z_{0}) = \\text{(constant)} \\times r^{3}\\,\\big[A\\cos(3\\theta) + B\\sin(3\\theta)\\big] + \\text{higher-order terms},\n$$\nwith $A = 3.0 \\times 10^{-3}$ and $B = 4.0 \\times 10^{-3}$ (both in units of Weber per meter cubed), compute the smallest positive angle $\\theta$ (in radians) at which $\\psi(x,y) = \\psi(R_{0},Z_{0})$ holds to leading order.\n\nRound your final numerical answer for $\\theta$ to four significant figures and express it in radians.",
            "solution": "The problem is first validated by extracting the given information and assessing its scientific soundness, consistency, and completeness.\n\n**Step 1: Extraction of Givens**\n-   The system is an axisymmetric toroidal plasma equilibrium.\n-   The region of interest is near a poloidal magnetic field null at $(R,Z) = (R_{0},Z_{0})$.\n-   The poloidal magnetic flux function is $\\psi(R,Z)$ and is smooth.\n-   Local Cartesian coordinates are defined as $x = R - R_{0}$ and $y = Z - Z_{0}$.\n-   The vacuum approximation is assumed to hold locally.\n-   The governing equation is the homogeneous axisymmetric Grad–Shafranov operator in vacuum, which reduces to a second-order, linear, elliptic PDE in local coordinates.\n-   A snowflake divertor condition is imposed, defined as a second-order null of the poloidal magnetic field, meaning the first and second derivatives of $\\psi$ vanish at $(R_{0},Z_{0})$.\n-   The leading-order expansion for a specific case is given as $\\psi(x,y) - \\psi(R_{0},Z_{0}) = \\text{(constant)} \\times r^{3}\\,\\big[A\\cos(3\\theta) + B\\sin(3\\theta)\\big] + \\text{higher-order terms}$.\n-   The constants are given as $A = 3.0 \\times 10^{-3} \\, \\text{Wb/m}^3$ and $B = 4.0 \\times 10^{-3} \\, \\text{Wb/m}^3$.\n-   The final numerical answer for an angle $\\theta$ must be in radians and rounded to four significant figures.\n\n**Step 2: Validation**\nThe problem is scientifically grounded in the principles of magnetohydrodynamics (MHD) as applied to magnetic confinement fusion. The Grad-Shafranov equation is the fundamental equation for axisymmetric MHD equilibrium. The concept of a magnetic null, higher-order nulls, and the \"snowflake\" configuration are standard and critical topics in modern tokamak divertor physics. The use of a local Taylor expansion and dominant balance analysis is a standard mathematical physics technique. The problem is well-posed, with sufficient information to derive the requested expressions and calculate the final value. The language is objective and precise. The problem is self-contained and free of contradictions.\n\n**Verdict**\nThe problem is deemed valid.\n\n**Derivation and Solution**\n\nThe analysis begins with the Grad-Shafranov equation for an axisymmetric equilibrium in a vacuum. In cylindrical coordinates $(R, \\phi, Z)$, this equation for the poloidal magnetic flux $\\psi(R,Z)$ is given by:\n$$ \\Delta^* \\psi \\equiv R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R}\\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial Z^2} = 0 $$\nwhere $\\Delta^*$ is the Grad-Shafranov operator in vacuum.\n\nWe introduce local Cartesian coordinates $(x,y)$ centered at the null point $(R_0, Z_0)$, such that $R = R_0 + x$ and $Z = Z_0 + y$. The derivatives transform as $\\frac{\\partial}{\\partial R} = \\frac{\\partial}{\\partial x}$ and $\\frac{\\partial}{\\partial Z} = \\frac{\\partial}{\\partial y}$. Substituting these into the Grad-Shafranov equation gives the local PDE:\n$$ (R_0 + x) \\frac{\\partial}{\\partial x}\\left(\\frac{1}{R_0 + x}\\frac{\\partial \\psi}{\\partial x}\\right) + \\frac{\\partial^2 \\psi}{\\partial y^2} = 0 $$\nExpanding the first term, we obtain:\n$$ \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} - \\frac{1}{R_0 + x} \\frac{\\partial \\psi}{\\partial x} = 0 $$\nThis is the general local equation for the flux function $\\psi(x,y)$ near the null.\n\nThe problem states that the null is of second-order (a \"snowflake\" condition). This means that all first and second partial derivatives of $\\psi$ with respect to $R$ and $Z$ (and thus $x$ and $y$) vanish at the null point $(x,y)=(0,0)$.\nLet's expand $\\psi(x,y)$ in a Taylor series around the null point, with $\\psi_0 = \\psi(R_0, Z_0)$:\n$$ \\psi(x,y) - \\psi_0 = \\sum_{n=1}^\\infty \\frac{1}{n!} \\left( x \\frac{\\partial}{\\partial x} + y \\frac{\\partial}{\\partial y} \\right)^n \\psi \\bigg|_{(0,0)} $$\nThe snowflake conditions are:\n$$ \\frac{\\partial \\psi}{\\partial x}\\bigg|_{(0,0)} = \\frac{\\partial \\psi}{\\partial y}\\bigg|_{(0,0)} = 0 $$\n$$ \\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{(0,0)} = \\frac{\\partial^2 \\psi}{\\partial y^2}\\bigg|_{(0,0)} = \\frac{\\partial^2 \\psi}{\\partial x \\partial y}\\bigg|_{(0,0)} = 0 $$\nConsequently, the Taylor series for $\\psi(x,y) - \\psi_0$ has no linear or quadratic terms. The leading non-vanishing term is of cubic order. Let us denote this leading-order part of the flux function as $\\psi_3(x,y)$, which is a homogeneous polynomial of degree $3$.\n$$ \\psi(x,y) - \\psi_0 \\approx \\psi_3(x,y) = \\frac{1}{3!} \\left( \\frac{\\partial^3 \\psi}{\\partial x^3} x^3 + 3\\frac{\\partial^3 \\psi}{\\partial x^2 \\partial y} x^2 y + 3\\frac{\\partial^3 \\psi}{\\partial x \\partial y^2} x y^2 + \\frac{\\partial^3 \\psi}{\\partial y^3} y^3 \\right) \\bigg|_{(0,0)} $$\nWe substitute $\\psi = \\psi_0 + \\psi_3$ into the local PDE and perform a dominant balance analysis.\n$$ \\nabla^2 (\\psi_0 + \\psi_3) - \\frac{1}{R_0 + x} \\frac{\\partial (\\psi_0 + \\psi_3)}{\\partial x} = 0 $$\n$$ \\nabla^2 \\psi_3 - \\frac{1}{R_0 + x} \\frac{\\partial \\psi_3}{\\partial x} = 0 $$\nThe term $\\psi_3$ is of order $r^3$ where $r = \\sqrt{x^2+y^2}$.\nThen $\\nabla^2 \\psi_3$ is of order $r$, because differentiating a homogeneous polynomial of degree $k$ twice yields a homogeneous polynomial of degree $k-2$.\nThe term $\\frac{\\partial \\psi_3}{\\partial x}$ is of order $r^2$.\nThe term $\\frac{1}{R_0 + x} \\approx \\frac{1}{R_0}$ for $x \\ll R_0$. So, the second term $\\frac{1}{R_0+x}\\frac{\\partial\\psi_3}{\\partial x}$ is of order $r^2/R_0$.\nThe equation is $\\mathcal{O}(r) + \\mathcal{O}(r^2/R_0) = 0$. In the limit $r \\to 0$, the $\\mathcal{O}(r)$ term dominates. For the equation to hold for all small $r$, the dominant term must vanish independently. This is the justification for the reduction to the two-dimensional Laplace equation for the leading-order term:\n$$ \\nabla^2 \\psi_3 = 0 $$\nThis is the required leading-order local PDE.\n\nNext, we find the most general cubic polynomial solution to $\\nabla^2\\psi_3=0$. Let $\\psi_3(x,y) = c_1 x^3 + c_2 x^2 y + c_3 x y^2 + c_4 y^3$.\n$$ \\frac{\\partial^2 \\psi_3}{\\partial x^2} = 6 c_1 x + 2 c_2 y $$\n$$ \\frac{\\partial^2 \\psi_3}{\\partial y^2} = 2 c_3 x + 6 c_4 y $$\nThe condition $\\nabla^2\\psi_3=0$ implies $(6c_1 + 2c_3)x + (2c_2 + 6c_4)y = 0$ for all $(x,y)$. This requires the coefficients to be zero:\n$c_3 = -3c_1$ and $c_2 = -3c_4$.\nSubstituting these back, the general solution is:\n$$ \\psi_3(x,y) = c_1 x^3 - 3c_4 x^2 y - 3c_1 x y^2 + c_4 y^3 = c_1(x^3 - 3xy^2) + c_4(y^3 - 3x^2y) $$\nTo express this in polar coordinates, we use $x = r\\cos\\theta$ and $y = r\\sin\\theta$. From trigonometric identities:\n$x^3 - 3xy^2 = r^3(\\cos^3\\theta - 3\\cos\\theta\\sin^2\\theta) = r^3\\cos(3\\theta)$.\n$y^3 - 3x^2y = r^3(\\sin^3\\theta - 3\\cos^2\\theta\\sin\\theta) = -r^3(3\\cos^2\\theta\\sin\\theta - \\sin^3\\theta) = -r^3\\sin(3\\theta)$.\nSo, the general cubic harmonic solution is:\n$$ \\psi_3(r,\\theta) = c_1 r^3 \\cos(3\\theta) - c_4 r^3 \\sin(3\\theta) $$\nRelabeling the arbitrary constants $c_1$ and $-c_4$ as generic constants, the solution has the form:\n$$ \\psi_3(r,\\theta) = r^3 \\big( K_1 \\cos(3\\theta) + K_2 \\sin(3\\theta) \\big) $$\nThis confirms the form given in the problem statement. The angular dependence is a linear combination of $\\cos(3\\theta)$ and $\\sin(3\\theta)$.\n\nThe angular directions along which the level set $\\psi(x,y) = \\psi(R_{0},Z_{0})$ emanates from the null are found by setting the leading-order term to zero: $\\psi_3(x,y) = 0$. For $r \\neq 0$:\n$$ K_1 \\cos(3\\theta) + K_2 \\sin(3\\theta) = 0 $$\nThis equation defines the angles $\\theta$ of the separatrices. For a non-trivial solution ($K_1, K_2$ not both zero), there are typically $6$ solutions for $\\theta$ in $[0, 2\\pi)$, separated by $\\pi/3$, corresponding to the six \"legs\" of the snowflake separatrix.\n\nFinally, we consider the specific case provided:\n$$ \\psi(x,y) - \\psi(R_{0},Z_{0}) \\propto r^{3}\\,\\big[A\\cos(3\\theta) + B\\sin(3\\theta)\\big] $$\nwith $A = 3.0 \\times 10^{-3}$ and $B = 4.0 \\times 10^{-3}$.\nThe condition $\\psi(x,y) = \\psi(R_{0},Z_{0})$ becomes, to leading order:\n$$ A\\cos(3\\theta) + B\\sin(3\\theta) = 0 $$\nSubstituting the values of $A$ and $B$:\n$$ (3.0 \\times 10^{-3}) \\cos(3\\theta) + (4.0 \\times 10^{-3}) \\sin(3\\theta) = 0 $$\nAssuming $\\cos(3\\theta) \\neq 0$, we can divide by it and by $10^{-3}$:\n$$ 3.0 + 4.0 \\tan(3\\theta) = 0 $$\n$$ \\tan(3\\theta) = -\\frac{3.0}{4.0} = -0.75 $$\nWe need to find the smallest positive angle $\\theta$. Let $\\alpha = \\arctan(-0.75)$. The range of the $\\arctan$ function is $(-\\pi/2, \\pi/2)$. Since the argument is negative, $\\alpha$ is in $(-\\pi/2, 0)$.\nNumerically, $\\alpha \\approx -0.6435011$ radians.\nThe general solution for $3\\theta$ is given by $3\\theta = \\alpha + k\\pi$, where $k$ is an integer.\n$$ \\theta = \\frac{\\alpha + k\\pi}{3} = \\frac{-0.6435011 + k\\pi}{3} $$\nWe seek the smallest integer $k$ that results in $\\theta > 0$.\n-   For $k=0$, $\\theta = -0.6435011 / 3 < 0$.\n-   For $k=1$, $\\theta = \\frac{-0.6435011 + \\pi}{3} = \\frac{2.4980915...}{3} \\approx 0.83269718...$ radians.\nThis is the smallest positive solution.\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\theta \\approx 0.8327 \\, \\text{radians} $$",
            "answer": "$$\\boxed{0.8327}$$"
        },
        {
            "introduction": "A key motivation for developing the snowflake divertor is its superior ability to spread heat flux over a larger area on the target plates, thereby reducing potentially damaging peak heat loads. This problem directly demonstrates this benefit by comparing the peak heat flux in a snowflake configuration to that in a conventional single-null setup. By applying the principles of energy conservation along a magnetic flux tube and the relationship between heat flux and magnetic field geometry, you will quantitatively derive the reduction in target heat flux achieved by the snowflake's unique magnetic field structure .",
            "id": "3718874",
            "problem": "A large-aspect-ratio, axisymmetric tokamak operates in two magnetic equilibria with identical upstream conditions but different divertor geometries: a conventional single-null and a second-order snowflake-null. In both cases, the outboard midplane upstream poloidal magnetic field is $B_{p,u} = 0.60\\ \\mathrm{T}$, the toroidal magnetic field is approximately spatially constant with magnitude $B_{t} = 3.0\\ \\mathrm{T}$, and the major radii at the outboard midplane and at the target strike point are $R_{u} = 1.7\\ \\mathrm{m}$ and $R_{t} = 1.9\\ \\mathrm{m}$, respectively. The upstream parallel heat flux $q_{\\parallel,u}(\\psi)$ is localized in a narrow band across the separatrix, and you may treat it as locally uniform over an upstream cross-field interval $dy$ that is small enough for local linearization.\n\nAssume the following near-null scalings of the poloidal magnetic field magnitude at the target strike point, measured a distance $r$ along the divertor plate from the magnetic null projected onto the plate:\n- Conventional single-null: $B_{p,t}^{(\\mathrm{std})}(r) \\approx a\\,r$, with $a = 12\\ \\mathrm{T/m}$.\n- Snowflake null (second-order): $B_{p,t}^{(\\mathrm{sf})}(r) \\approx b\\,r^{2}$, with $b = 300\\ \\mathrm{T/m^{2}}$.\n\nIn both equilibria, the separatrix intersects the plate at the same distance from the null, $r = \\delta = 3.0\\ \\mathrm{cm}$.\n\nWorking from first principles, use the following base assumptions and laws:\n- Steady state with negligible volumetric power losses between the upstream midplane and the divertor target along a given narrow flux tube.\n- Conservation of energy carried along a narrow band of field lines between two neighboring poloidal flux surfaces.\n- Axisymmetry and the definition of poloidal flux differential across neighboring flux surfaces: $d\\psi = R\\,B_{p}\\,dl_{\\perp}$, where $dl_{\\perp}$ is the physical displacement normal to the flux surfaces in the poloidal plane, $R$ is the major radius, and $B_{p}$ is the poloidal field magnitude.\n- Small incidence angle at the target and strong toroidal-field ordering so that $\\sin\\alpha \\approx B_{p,t}/B$, with $B \\approx B_{t}$ near the target.\n\nDerive, from these bases and without invoking any specialized target-profile fitting formulas, an expression for the ratio of the peak normal heat flux at the target in the snowflake case to that in the conventional single-null case, $q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}/q_{n,\\mathrm{peak}}^{(\\mathrm{std})}$, evaluated at the separatrix strike point. Then compute this ratio numerically using the parameters given above. Round your answer to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and all necessary information is provided.\n\n### Step 1: Extract Givens\n- **Tokamak parameters:** Large-aspect-ratio, axisymmetric.\n- **Configurations:** Conventional single-null (std) and second-order snowflake-null (sf).\n- **Upstream conditions:** Identical for both cases.\n  - Upstream poloidal magnetic field: $B_{p,u} = 0.60\\ \\mathrm{T}$\n  - Toroidal magnetic field: $B_{t} = 3.0\\ \\mathrm{T}$ (spatially constant)\n  - Upstream major radius: $R_{u} = 1.7\\ \\mathrm{m}$\n  - Upstream parallel heat flux: $q_{\\parallel,u}(\\psi)$ is locally uniform.\n- **Target parameters:**\n  - Target major radius: $R_{t} = 1.9\\ \\mathrm{m}$\n  - Poloidal field scalings near the null, as a function of distance $r$ along the divertor plate:\n    - Conventional: $B_{p,t}^{(\\mathrm{std})}(r) \\approx a\\,r$, with $a = 12\\ \\mathrm{T/m}$.\n    - Snowflake: $B_{p,t}^{(\\mathrm{sf})}(r) \\approx b\\,r^{2}$, with $b = 300\\ \\mathrm{T/m^{2}}$.\n  - Separatrix strike point location: $r = \\delta = 3.0\\ \\mathrm{cm} = 0.030\\ \\mathrm{m}$.\n- **Base Assumptions and Laws:**\n  1.  Steady state with negligible volumetric power losses.\n  2.  Conservation of energy along a narrow flux tube between neighboring flux surfaces.\n  3.  Axisymmetry and poloidal flux differential: $d\\psi = R\\,B_{p}\\,dl_{\\perp}$.\n  4.  Small incidence angle approximation: $\\sin\\alpha \\approx B_{p,t}/B$, with total field $B \\approx B_{t}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established principles of plasma physics and magnetic confinement fusion, specifically concerning heat exhaust in tokamaks. The concepts of poloidal flux, magnetic flux expansion, and divertor configurations (including the advanced snowflake geometry) are central to the field. The provided parameters and field scalings are physically realistic and consistent with theoretical models of magnetic nulls. The problem is well-posed, providing all necessary laws and data to derive the requested ratio. The language is objective and precise. Therefore, the problem is deemed valid.\n\n### Step 3: Derivation\nThe objective is to find the ratio of the peak normal heat flux at the target for the snowflake configuration to that of the conventional single-null configuration, $q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}/q_{n,\\mathrm{peak}}^{(\\mathrm{std})}$.\n\nLet us begin from the principle of energy conservation along a magnetic flux tube. The power, $dP$, flowing through an infinitesimal flux tube is constant between the upstream midplane (subscript $u$) and the divertor target (subscript $t$). This power is given by the product of the parallel heat flux, $q_{\\parallel}$, and the area element perpendicular to the magnetic field, $dA_{\\perp}$:\n$$ dP = q_{\\parallel} dA_{\\perp} $$\nIn an axisymmetric system, the area element $dA_{\\perp}$ for a flux tube of width $dl_{\\perp}$ in the poloidal plane is $dA_{\\perp} = 2\\pi R dl_{\\perp}$, where $R$ is the major radius.\n$$ dP = q_{\\parallel} (2\\pi R dl_{\\perp}) $$\nThe differential of poloidal flux, $d\\psi$, across this width $dl_{\\perp}$ is given as $d\\psi = R B_p dl_{\\perp}$, where $B_p$ is the poloidal magnetic field magnitude. We can express $dl_{\\perp}$ as $dl_{\\perp} = \\frac{d\\psi}{R B_p}$. Substituting this into the power equation:\n$$ dP = q_{\\parallel} \\left(2\\pi R \\frac{d\\psi}{R B_p}\\right) = \\frac{2\\pi q_{\\parallel}}{B_p} d\\psi $$\nThis gives the power per unit poloidal flux, which must be conserved along the flux tube from upstream to target:\n$$ \\frac{dP}{d\\psi}\\bigg|_{u} = \\frac{dP}{d\\psi}\\bigg|_{t} $$\n$$ \\frac{2\\pi q_{\\parallel,u}}{B_{p,u}} = \\frac{2\\pi q_{\\parallel,t}}{B_{p,t}} $$\nThis yields a fundamental relationship for the parallel heat flux at the target, $q_{\\parallel,t}$, as a function of the upstream parallel heat flux, $q_{\\parallel,u}$, and the local poloidal magnetic fields:\n$$ q_{\\parallel,t} = q_{\\parallel,u} \\frac{B_{p,t}}{B_{p,u}} $$\nNext, we relate the parallel heat flux at the target to the normal heat flux on the target surface, $q_{n,t}$. The normal heat flux is the component of the heat flux vector, which is directed along the magnetic field, projected onto the target surface normal. This is given by $q_{n,t} = q_{\\parallel,t} \\sin\\alpha$, where $\\alpha$ is the incidence angle of the magnetic field line with respect to the target surface.\nThe problem provides the approximation for small incidence angles and strong toroidal field ($B_t \\gg B_p$):\n$$ \\sin\\alpha \\approx \\frac{B_{p,t}}{B} \\approx \\frac{B_{p,t}}{B_t} $$\nwhere $B$ is the total magnetic field strength. Combining these, we find the normal heat flux at the target:\n$$ q_{n,t} = q_{\\parallel,t} \\sin\\alpha \\approx q_{\\parallel,t} \\frac{B_{p,t}}{B_t} $$\nNow, we substitute the expression for $q_{\\parallel,t}$:\n$$ q_{n,t} \\approx \\left( q_{\\parallel,u} \\frac{B_{p,t}}{B_{p,u}} \\right) \\frac{B_{p,t}}{B_t} = q_{\\parallel,u} \\frac{B_{p,t}^2}{B_{p,u} B_t} $$\nThis expression gives the normal heat flux profile on the target. The problem states that the upstream conditions are identical for both configurations, meaning $q_{\\parallel,u}$ and $B_{p,u}$ are the same for the standard and snowflake cases at any given flux surface. The toroidal field $B_t$ is also the same. The peak heat flux is evaluated at the separatrix strike point, which is located at $r=\\delta$ for both cases.\nWe can now form the ratio of the peak normal heat fluxes for the snowflake (sf) and standard (std) cases:\n$$ \\frac{q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}}{q_{n,\\mathrm{peak}}^{(\\mathrm{std})}} = \\frac{q_{n,t}^{(\\mathrm{sf})}(r=\\delta)}{q_{n,t}^{(\\mathrm{std})}(r=\\delta)} = \\frac{ q_{\\parallel,u} \\frac{(B_{p,t}^{(\\mathrm{sf})}(\\delta))^2}{B_{p,u} B_t} }{ q_{\\parallel,u} \\frac{(B_{p,t}^{(\\mathrm{std})}(\\delta))^2}{B_{p,u} B_t} } $$\nThe common terms $q_{\\parallel,u}$, $B_{p,u}$, and $B_t$ cancel out, leaving:\n$$ \\frac{q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}}{q_{n,\\mathrm{peak}}^{(\\mathrm{std})}} = \\left( \\frac{B_{p,t}^{(\\mathrm{sf})}(\\delta)}{B_{p,t}^{(\\mathrm{std})}(\\delta)} \\right)^2 $$\nWe are given the near-null scalings for the poloidal magnetic field at the target:\n- $B_{p,t}^{(\\mathrm{std})}(r) = a\\,r$\n- $B_{p,t}^{(\\mathrm{sf})}(r) = b\\,r^2$\nEvaluating these at the separatrix strike point, $r=\\delta$:\n- $B_{p,t}^{(\\mathrm{std})}(\\delta) = a\\,\\delta$\n- $B_{p,t}^{(\\mathrm{sf})}(\\delta) = b\\,\\delta^2$\nSubstituting these into the ratio expression gives the final analytical result:\n$$ \\frac{q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}}{q_{n,\\mathrm{peak}}^{(\\mathrm{std})}} = \\left( \\frac{b\\,\\delta^2}{a\\,\\delta} \\right)^2 = \\left( \\frac{b\\,\\delta}{a} \\right)^2 $$\nNote that the parameters $R_u$ and $R_t$ were not required for this ratio, as their effects are implicitly contained within the measured field scalings and conserved quantities.\n\n### Step 4: Numerical Calculation\nWe now substitute the given numerical values into the derived expression.\n- $a = 12\\ \\mathrm{T/m}$\n- $b = 300\\ \\mathrm{T/m^2}$\n- $\\delta = 3.0\\ \\mathrm{cm} = 0.030\\ \\mathrm{m}$\n\nThe ratio is:\n$$ \\frac{q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}}{q_{n,\\mathrm{peak}}^{(\\mathrm{std})}} = \\left( \\frac{(300\\ \\mathrm{T/m^2}) \\cdot (0.030\\ \\mathrm{m})}{12\\ \\mathrm{T/m}} \\right)^2 = \\left( \\frac{9}{12} \\right)^2 = \\left( \\frac{3}{4} \\right)^2 = (0.75)^2 $$\n$$ \\frac{q_{n,\\mathrm{peak}}^{(\\mathrm{sf})}}{q_{n,\\mathrm{peak}}^{(\\mathrm{std})}} = 0.5625 $$\nThis value is exact and has four significant figures, as requested. This result demonstrates that for the given parameters, the snowflake divertor configuration reduces the peak heat flux at the separatrix to $56.25\\%$ of the value in the conventional single-null case.",
            "answer": "$$\n\\boxed{0.5625}\n$$"
        },
        {
            "introduction": "To bridge the gap between theoretical concepts and practical application, plasma physicists use computational models to predict divertor performance. This exercise challenges you to construct a simplified, first-principles-based model that synthesizes several key physical processes governing heat transport in the scrape-off layer. You will combine the Spitzer-Härm model for parallel heat conduction with the principles of geometric flux expansion to build a tool that predicts target heat flux, similar in spirit to sophisticated edge codes like SOLPS-ITER . This hands-on modeling practice solidifies your understanding of how different physical effects are integrated to analyze and design effective divertor solutions.",
            "id": "3718890",
            "problem": "You are asked to formalize a simplified, first-principles-based model that captures how geometric flux expansion in a snowflake divertor configuration modifies the heat flux density arriving at the divertor target. Your implementation should be guided only by fundamental conservation laws and constitutive relations, and must not rely on problem-specific shortcut formulas. The objective is to compute, for a given set of physically plausible parameters, the peak target heat flux density due to parallel electron conduction in the scrape-off layer (SOL) and geometric mapping of a flux tube. This exercise reflects modeling considerations relevant to Scrape-Off Layer Plasma Simulation (SOLPS) and the University of California edge code (UEDGE), but is framed in universally applicable mathematical terms.\n\nStart from the following assumptions and core physical principles:\n\n1. Steady-state energy conservation along a magnetic field line in the SOL with no volumetric sources or sinks between the upstream location and the target. The one-dimensional parallel conduction of electron heat flux is modeled with the Spitzer–Härm relation, where the constitutive law for parallel electron heat flux is of the form $q_{\\parallel} = -\\kappa_{0} T^{5/2} \\frac{dT}{ds}$, with $T$ the electron temperature and $s$ the coordinate along the magnetic field line. Assume the conduction-limited regime with negligible target electron temperature, and derive the expression for the constant parallel heat flux $q_{\\parallel}$ in terms of the upstream temperature, parallel connection length, and $\\kappa_{0}$.\n\n2. Conservation of power in a thin magnetic flux tube implies that the product of parallel heat flux and the cross-sectional area transverse to the magnetic field is invariant along the field line. Use this invariance together with the fact that the cross-sectional area of a flux tube scales inversely with the magnetic field magnitude to obtain the geometric factor that maps the parallel heat flux density to the heat flux density on the material target surface. In the divertor, use the poloidal-field-dominated flux expansion scaling relating upstream and target locations. Include an adjustable toroidal radius ratio factor to account for large-aspect-ratio geometry.\n\n3. Near an $X$-point (first-order null) or snowflake (second-order null), approximate the poloidal magnetic field magnitude in the vicinity of the null by the lowest-order Taylor expansion in the distance $r$ from the null in the poloidal plane, $B_{p}(r) \\approx a_{1} r + a_{2} r^{2}$. Evaluate this at the target strike-point distance $r = r_{t}$. Because a perfect null would imply a vanishing field and infinite flux expansion, regularize the target poloidal field by enforcing a strictly positive lower bound $B_{\\mathrm{floor}}$, i.e., $B_{p,\\mathrm{t,eff}} = \\max\\left(\\left|a_{1} r_{t} + a_{2} r_{t}^{2}\\right|, B_{\\mathrm{floor}}\\right)$.\n\n4. Combine the above to obtain the target heat flux density $q_{\\mathrm{t}}$ as a function of the upstream parameters and the geometric factors. Express the final results in megawatts per square meter. Angles do not appear in this problem; no angle unit is required.\n\nYour program must implement the above logic and compute the target heat flux density $q_{\\mathrm{t}}$ for each of the following test cases. For each case, use the specified input parameters:\n- Upstream electron temperature $T_{\\mathrm{u}}$ in electronvolts, positive real number.\n- Parallel connection length $L_{\\parallel}$ in meters, positive real number.\n- Spitzer–Härm coefficient $\\kappa_{0}$ in $\\mathrm{W\\,m^{-1}\\,eV^{-7/2}}$, positive real number.\n- Upstream poloidal magnetic field $B_{p,\\mathrm{u}}$ in tesla, positive real number.\n- Taylor coefficients $a_{1}$ in $\\mathrm{T\\,m^{-1}}$ and $a_{2}$ in $\\mathrm{T\\,m^{-2}}$ for the near-null expansion of $B_{p}(r)$.\n- Target distance from the null $r_{t}$ in meters, nonnegative real number.\n- Toroidal radius ratio factor $f_{R}$, dimensionless, positive real number.\n- Regularization lower bound $B_{\\mathrm{floor}}$ in tesla, strictly positive real number.\n\nDefine the geometric expansion factor $f_{\\mathrm{geo}}$ as the product of the flux expansion and the toroidal radius ratio, $f_{\\mathrm{geo}} = f_{R} \\times \\left(\\frac{B_{p,\\mathrm{u}}}{B_{p,\\mathrm{t,eff}}}\\right)$, and map the parallel heat flux to the target by dividing by $f_{\\mathrm{geo}}$. In the conduction-limited regime with negligible target temperature, derive $q_{\\parallel}$ from the Spitzer–Härm law and use it in the mapping.\n\nTest suite (all quantities in the units stated above):\n1. Case A (conventional single-null, moderate flux expansion):\n   - $T_{\\mathrm{u}} = 80$, $L_{\\parallel} = 25$, $\\kappa_{0} = 2000$, $B_{p,\\mathrm{u}} = 0.1$, $a_{1} = 0.5$, $a_{2} = 0$, $r_{t} = 0.02$, $f_{R} = 1.2$, $B_{\\mathrm{floor}} = 5\\times 10^{-4}$.\n2. Case B (snowflake-minus, enhanced expansion with first- and second-order terms):\n   - $T_{\\mathrm{u}} = 80$, $L_{\\parallel} = 35$, $\\kappa_{0} = 2000$, $B_{p,\\mathrm{u}} = 0.1$, $a_{1} = 0.05$, $a_{2} = 4.0$, $r_{t} = 0.01$, $f_{R} = 1.3$, $B_{\\mathrm{floor}} = 5\\times 10^{-4}$.\n3. Case C (near-exact snowflake, second-order dominant with floor regularization active):\n   - $T_{\\mathrm{u}} = 80$, $L_{\\parallel} = 40$, $\\kappa_{0} = 2000$, $B_{p,\\mathrm{u}} = 0.1$, $a_{1} = 0.0$, $a_{2} = 2.5$, $r_{t} = 0.008$, $f_{R} = 1.3$, $B_{\\mathrm{floor}} = 5\\times 10^{-4}$.\n4. Case D (shorter $L_{\\parallel}$, lower upstream temperature, conventional null):\n   - $T_{\\mathrm{u}} = 40$, $L_{\\parallel} = 15$, $\\kappa_{0} = 2000$, $B_{p,\\mathrm{u}} = 0.08$, $a_{1} = 0.4$, $a_{2} = 0.0$, $r_{t} = 0.015$, $f_{R} = 0.9$, $B_{\\mathrm{floor}} = 5\\times 10^{-4}$.\n\nRequired outputs:\n- For each test case, compute the target heat flux density $q_{\\mathrm{t}}$ in $\\mathrm{MW\\,m^{-2}}$, expressed as a floating-point number.\n- Your program should produce a single line of output containing the four results in the order A, B, C, D as a comma-separated list enclosed in square brackets, for example, $[x_{A},x_{B},x_{C},x_{D}]$.\n- Round each entry to exactly six digits after the decimal point, in units of $\\mathrm{MW\\,m^{-2}}$.\n\nNo user input is required; all parameters are embedded in the program. The final program must implement the derivation and compute the requested outputs exactly for the provided test suite. The final answer must be code only.",
            "solution": "The problem is deemed valid as it is scientifically grounded in established principles of plasma physics, is mathematically well-posed, objective, and contains all necessary information for a unique solution. The model, while simplified, captures the essential physics of heat transport in a tokamak scrape-off layer and its mitigation via magnetic geometry in a divertor.\n\nThe objective is to compute the peak heat flux density at the divertor target, $q_{\\mathrm{t}}$, based on a first-principles model. This involves several steps: determining the parallel heat flux, modeling the magnetic field geometry near the target, and mapping the parallel heat flux onto the target surface.\n\nFirst, we derive the expression for the parallel heat flux, $q_{\\parallel}$. The problem states that the heat flow is governed by the one-dimensional, steady-state Spitzer–Härm law for electron heat conduction, with no volumetric sources or sinks. The constitutive relation is:\n$$q_{\\parallel} = -\\kappa_{0} T^{5/2} \\frac{dT}{ds}$$\nwhere $T$ is the electron temperature, $s$ is the coordinate along the magnetic field line, and $\\kappa_{0}$ is the Spitzer–Härm coefficient. In a steady-state, source-free medium, the divergence of the heat flux is zero. In one dimension, this implies $\\frac{d q_{\\parallel}}{ds} = 0$, meaning $q_{\\parallel}$ is constant along the field line. We can separate variables and integrate this equation along the magnetic field line from the upstream location (denoted by subscript $u$, at $s=0$) to the divertor target (denoted by subscript $t$, at $s=L_{\\parallel}$), where $L_{\\parallel}$ is the parallel connection length.\n$$\\int_{0}^{L_{\\parallel}} q_{\\parallel} ds = \\int_{T_{\\mathrm{u}}}^{T_{\\mathrm{t}}} -\\kappa_{0} T^{5/2} dT$$\nAs $q_{\\parallel}$ is constant, the left side integrates to $q_{\\parallel} L_{\\parallel}$. The right side integrates to:\n$$q_{\\parallel} L_{\\parallel} = -\\kappa_{0} \\left[ \\frac{T^{7/2}}{7/2} \\right]_{T_{\\mathrm{u}}}^{T_{\\mathrm{t}}} = -\\frac{2}{7}\\kappa_{0} \\left( T_{\\mathrm{t}}^{7/2} - T_{\\mathrm{u}}^{7/2} \\right)$$\nThe problem specifies the conduction-limited regime with negligible target temperature, which corresponds to the boundary condition $T_{\\mathrm{t}} \\approx 0$. Applying this condition simplifies the expression:\n$$q_{\\parallel} L_{\\parallel} = -\\frac{2}{7}\\kappa_{0} \\left( 0 - T_{\\mathrm{u}}^{7/2} \\right) = \\frac{2}{7}\\kappa_{0} T_{\\mathrm{u}}^{7/2}$$\nSolving for the parallel heat flux density yields:\n$$q_{\\parallel} = \\frac{2}{7} \\frac{\\kappa_{0} T_{\\mathrm{u}}^{7/2}}{L_{\\parallel}}$$\nThe units are consistent, as $[\\kappa_0] \\cdot [T]^{7/2} / [L] = (\\mathrm{W\\,m^{-1}\\,eV^{-7/2}}) \\cdot (\\mathrm{eV}^{7/2}) / (\\mathrm{m}) = \\mathrm{W\\,m^{-2}}$.\n\nSecond, we determine the geometric factor that maps the parallel heat flux to the target. This factor accounts for the expansion of magnetic flux surfaces near the target. The problem defines this geometric expansion factor, $f_{\\mathrm{geo}}$, as:\n$$f_{\\mathrm{geo}} = f_{R} \\times \\left(\\frac{B_{p,\\mathrm{u}}}{B_{p,\\mathrm{t,eff}}}\\right)$$\nHere, $f_{R}$ is the toroidal radius ratio factor, $B_{p,\\mathrm{u}}$ is the upstream poloidal magnetic field, and $B_{p,\\mathrm{t,eff}}$ is the effective poloidal magnetic field at the target. A larger $f_{\\mathrm{geo}}$ corresponds to greater expansion of the flux tube area at the target, which spreads the power over a larger surface.\n\nThe effective target poloidal field, $B_{p,\\mathrm{t,eff}}$, is calculated from a Taylor expansion of the poloidal field $B_p$ near a magnetic null as a function of the poloidal-plane distance $r$ from the null:\n$$B_{p}(r) \\approx a_{1} r + a_{2} r^{2}$$\nThis is evaluated at the target strike-point distance, $r = r_{t}$. To avoid the unphysical singularity of an infinite flux expansion at a perfect null ($B_p=0$), a regularization is applied using a minimum field value, $B_{\\mathrm{floor}}$:\n$$B_{p,\\mathrm{t,eff}} = \\max\\left(\\left|a_{1} r_{t} + a_{2} r_{t}^{2}\\right|, B_{\\mathrm{floor}}\\right)$$\nThe absolute value ensures the field magnitude is positive, and the $\\max$ function enforces the lower bound. A non-zero $a_1$ with $a_2=0$ models a standard X-point divertor, while a dominant $a_2$ term models a higher-order null, characteristic of a snowflake divertor configuration.\n\nFinally, the heat flux density perpendicular to the target surface, $q_{\\mathrm{t}}$, is obtained by dividing the parallel heat flux by the geometric expansion factor, as specified:\n$$q_{\\mathrm{t}} = \\frac{q_{\\parallel}}{f_{\\mathrm{geo}}}$$\nSubstituting the expressions for $q_{\\parallel}$ and $f_{\\mathrm{geo}}$ gives the complete formula:\n$$q_{\\mathrm{t}} = \\left( \\frac{2}{7} \\frac{\\kappa_{0} T_{\\mathrm{u}}^{7/2}}{L_{\\parallel}} \\right) \\bigg/ \\left( f_{R} \\frac{B_{p,\\mathrm{u}}}{B_{p,\\mathrm{t,eff}}} \\right)$$\nThe calculation will be performed in SI base units (except for temperature in eV, which is consistent with the units of $\\kappa_0$), yielding $q_{\\mathrm{t}}$ in $\\mathrm{W\\,m^{-2}}$. The final result must be converted to megawatts per square meter ($\\mathrm{MW\\,m^{-2}}$) by dividing by $10^6$.\n\nThe computational procedure for each test case is as follows:\n1.  Calculate $q_{\\parallel}$ using the given $T_{\\mathrm{u}}$, $L_{\\parallel}$, and $\\kappa_{0}$.\n2.  Calculate the magnitude of the target poloidal field, $|a_{1} r_{t} + a_{2} r_{t}^{2}|$, using the given $a_1$, $a_2$, and $r_t$.\n3.  Determine $B_{p,\\mathrm{t,eff}}$ by taking the maximum of the value from step 2 and the given $B_{\\mathrm{floor}}$.\n4.  Calculate the geometric expansion factor $f_{\\mathrm{geo}}$ using the given $f_R$, $B_{p,\\mathrm{u}}$, and the calculated $B_{p,\\mathrm{t,eff}}$.\n5.  Calculate the target heat flux $q_{\\mathrm{t}} = q_{\\parallel} / f_{\\mathrm{geo}}$.\n6.  Convert $q_{\\mathrm{t}}$ from $\\mathrm{W\\,m^{-2}}$ to $\\mathrm{MW\\,m^{-2}}$ and round to six decimal places.\nThis procedure will now be implemented to solve for the four specified cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the target heat flux density for given scrape-off layer parameters.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (T_u, L_parallel, kappa_0, B_p_u, a1, a2, r_t, f_R, B_floor)\n    test_cases = [\n        # Case A (conventional single-null)\n        (80.0, 25.0, 2000.0, 0.1, 0.5, 0.0, 0.02, 1.2, 5e-4),\n        # Case B (snowflake-minus)\n        (80.0, 35.0, 2000.0, 0.1, 0.05, 4.0, 0.01, 1.3, 5e-4),\n        # Case C (near-exact snowflake)\n        (80.0, 40.0, 2000.0, 0.1, 0.0, 2.5, 0.008, 1.3, 5e-4),\n        # Case D (shorter L_parallel, lower upstream temperature, conventional null)\n        (40.0, 15.0, 2000.0, 0.08, 0.4, 0.0, 0.015, 0.9, 5e-4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T_u, L_parallel, kappa_0, B_p_u, a1, a2, r_t, f_R, B_floor = case\n\n        # 1. Derive the parallel heat flux q_parallel from the Spitzer-Härm model.\n        # q_parallel = (2/7) * kappa_0 * T_u^(7/2) / L_parallel\n        q_parallel = (2.0 / 7.0) * kappa_0 * (T_u**3.5) / L_parallel\n\n        # 2. Compute the effective poloidal magnetic field at the target, B_p_t_eff.\n        # B_p(r) approx a1*r + a2*r^2\n        B_p_t_unreg = abs(a1 * r_t + a2 * r_t**2)\n        \n        # Regularize by enforcing a minimum floor value.\n        B_p_t_eff = max(B_p_t_unreg, B_floor)\n\n        # 3. Compute the geometric expansion factor f_geo.\n        # f_geo = f_R * (B_p_u / B_p_t_eff)\n        # Check for B_p_t_eff being zero to avoid division by zero, though the floor\n        # value B_floor is strictly positive, making this redundant but safe.\n        if B_p_t_eff == 0:\n            # This case is physically unrealistic (infinite flux expansion)\n            # and should not happen with a positive B_floor.\n            # Assigning a large number for q_t to indicate a breakdown.\n            # However, for this problem, we can just let it fail or handle gracefully.\n            # With B_floor > 0, this path is not taken.\n            f_geo = float('inf')\n        else:\n             f_geo = f_R * (B_p_u / B_p_t_eff)\n\n        # 4. Map the parallel heat flux to the target heat flux q_t.\n        # q_t = q_parallel / f_geo\n        if f_geo == 0:\n            # Physically means infinite flux compression, not expected here.\n             q_t_W_m2 = float('inf')\n        else:\n            q_t_W_m2 = q_parallel / f_geo\n\n        # 5. Convert the result from W/m^2 to MW/m^2.\n        q_t_MW_m2 = q_t_W_m2 / 1e6\n        \n        results.append(q_t_MW_m2)\n\n    # Final print statement in the exact required format.\n    # The output format string f'{r:.6f}' rounds each result to 6 decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}