{
    "hands_on_practices": [
        {
            "introduction": "在磁约束聚变研究中，一项关键技能是从实验数据中推断出等离子体内部的物理参数。本练习将引导你完成一个典型的逆向工程问题：如何从一个关键的实验观测——偏滤器靶板上热通量足迹的分裂——来反推磁岛的基本属性，如其宽度和产生该磁岛的磁扰动强度。这个过程巧妙地结合了磁通扩展、磁场几何映射以及磁岛宽度的经典摆模型，是连接理论与实际诊断分析的重要实践。",
            "id": "3705598",
            "problem": "一台单零托卡马克利用外部施加的共振磁扰动（RMP）通过岛状偏滤器拓扑来控制边界热通量。外部偏滤器靶板上的一个热通量成像诊断系统测量到一次主足迹分裂：沿打击线坐标的两个主要峰值之间的弧长间隔为 $\\Delta s = 0.180~\\text{m}$。磁力线在靶板上的局部磁入射角为 $\\beta = 5.0^\\circ$。在外侧中平面的极向磁场大小为 $B_{p}^{\\mathrm{mid}} = 0.12~\\text{T}$，在偏滤器靶板打击区域的极向磁场大小为 $B_{p}^{\\mathrm{div}} = 0.020~\\text{T}$。\n\n在共振面附近，边界磁力线动力学可以在一个直磁力线平板模型中用笛卡尔坐标 $(x,y,z)$ 来建模，其中 $x$ 是类径向坐标，有理面位于 $x=0$ 处；$y$ 是副法线坐标；$z$ 是沿平衡磁力线方向的坐标。平衡平行场呈线性变化 $B_{z}(x) \\approx B_{z}'\\,x$，一个 $m$-极向模的螺旋扰动产生一个径向场分量 $b_{x}(x,y,z) = b_{r} \\sin(k_{y} y - k_{z} z)$，其中 $k_{y} = m/r_{s}$。此处 $m=27$，共振面的大半径为 $r_{s} = 0.85~\\text{m}$。有效线性平行场梯度为 $B_{z}' = 3.2~\\text{T/m}$。假设共振条件得到满足，因此在 $x=0$ 附近磁力线方程简化为标准的单摆形式。\n\n从适用于磁化等离子体和磁力线映射的第一性原理出发，完成以下任务：\n\n1. 利用薄磁通管的磁通量守恒和在偏滤器靶板上的几何投影，推导外侧中平面上的微小径向位移 $\\delta r$ 与偏滤器上沿打击线的相应弧长位移 $\\delta s$ 之间的关系。证明这隐含了一个用磁通扩展和入射角表示的映射关系 $ds/dr$。\n\n2. 将测得的分裂 $\\Delta s$ 解释为映射后的磁岛全宽，并求出共振面处的岛宽 $w$。\n\n3. 从有理面附近的平板模型磁力线方程和单谐波扰动出发，推导磁岛宽度与扰动幅度 $b_{r}$、副法向波数 $k_{y}$ 和平行场梯度 $B_{z}'$ 之间的关系。反转此关系，利用你推断出的 $w$ 计算 $b_{r}$。\n\n在代入给定数值之前，进行完整的符号推导。将最终数值结果四舍五入至四位有效数字。$b_{r}$ 以 $\\text{T}$ 为单位，$w$ 以 $\\text{m}$ 为单位。以有序对 $\\left(b_{r},\\,w\\right)$ 的形式给出你的最终答案。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第 1 步：提取已知条件\n问题陈述中提供了以下数据和定义：\n- 主要热通量峰值之间的弧长间隔：$\\Delta s = 0.180~\\text{m}$\n- 偏滤器靶板上的局部磁入射角：$\\beta = 5.0^\\circ$\n- 外侧中平面的极向磁场大小：$B_{p}^{\\mathrm{mid}} = 0.12~\\text{T}$\n- 偏滤器靶板的极向磁场大小：$B_{p}^{\\mathrm{div}} = 0.020~\\text{T}$\n- 平板坐标：$(x,y,z)$ 分别代表类径向、副法向和平行方向。\n- 共振面（$x=0$）附近的平衡平行场变化：$B_{z}(x) \\approx B_{z}'\\,x$\n- 径向磁场扰动：$b_{x}(x,y,z) = b_{r} \\sin(k_{y} y - k_{z} z)$\n- 副法向波数：$k_{y} = m/r_{s}$\n- 极向模数：$m=27$\n- 共振面的大半径：$r_{s} = 0.85~\\text{m}$\n- 有效线性平行场梯度：$B_{z}' = 3.2~\\text{T/m}$\n- 共振条件得到满足。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据既定标准对问题进行评估。\n- **科学依据：**该问题基于等离子体物理学和磁约束聚变的既定标准原理。共振磁扰动（RMP）、岛状偏滤器、磁通量守恒、磁通扩展、磁剪切以及用于磁岛形成的单摆模型等概念都是托卡马克物理领域的核心。所提供的数值对于中型托卡马克来说是物理上合理的。\n- **良态问题：**问题结构清晰，分为三个不同部分，指导推导和计算。它提供了一套完整的参数，足以求得所要求量（磁岛宽度 $w$ 和扰动幅度 $b_{r}$）的唯一解。\n- **客观性：**问题以精确、定量和客观的科学语言陈述，不含任何主观或不可形式化的内容。\n\n### 第 3 步：结论与行动\n此问题科学上合理、自洽且良态。未发现任何缺陷。因此，问题被判定为**有效**，并将提供完整解答。\n\n### 解答推导\n\n解答将按照问题陈述的要求分为三部分进行。\n\n**第 1 部分：中平面到偏滤器映射的推导**\n\n我们首先考虑连接外侧中平面与偏滤器靶板的薄磁通管的磁通量守恒。在托卡马克中，极向磁通量 $\\Psi_p$ 沿磁通管守恒。对于一个由中平面上两个相邻磁面界定的窄管，其径向距离为 $\\delta r$，所包含的极向磁通量近似为：\n$$ \\delta\\Psi_p \\approx B_{p}^{\\mathrm{mid}} \\delta A_{\\perp, \\mathrm{mid}} $$\n其中 $\\delta A_{\\perp, \\mathrm{mid}}$ 是垂直于极向磁场的磁通管横截面积。假设环向长度为 $L_T$，则此面积为 $\\delta A_{\\perp, \\mathrm{mid}} = L_T \\delta r$。\n\n在偏滤器处，相同的两个磁面的打击点之间包含着等量的极向磁通量 $\\delta\\Psi_p$。在这里，极向场为 $B_{p}^{\\mathrm{div}}$，磁面的垂直间距为 $\\delta r_{\\mathrm{div}}$。相应的面积为 $\\delta A_{\\perp, \\mathrm{div}} = L_T \\delta r_{\\mathrm{div}}$。\n极向磁通量 $\\delta\\Psi_p$ 的守恒意味着：\n$$ B_{p}^{\\mathrm{mid}} (L_T \\delta r) = B_{p}^{\\mathrm{div}} (L_T \\delta r_{\\mathrm{div}}) $$\n$$ B_{p}^{\\mathrm{mid}} \\delta r = B_{p}^{\\mathrm{div}} \\delta r_{\\mathrm{div}} $$\n这给出了从中平面上的径向间距到偏滤器上垂直间距的映射关系：\n$$ \\delta r_{\\mathrm{div}} = \\left(\\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}}\\right) \\delta r $$\n术语 $f_{exp} = B_{p}^{\\mathrm{mid}}/B_{p}^{\\mathrm{div}}$ 被称为磁通扩展因子。\n\n量 $\\delta r_{\\mathrm{div}}$ 是在偏滤器处极向平面内垂直于极向场方向的磁力线间距。问题要求的是沿偏滤器靶板表面的位移 $\\delta s$。磁力线以一个很小的入射角 $\\beta$ 打击到靶板上。垂直间距 $\\delta r_{\\mathrm{div}}$ 和沿靶板表面的弧长间隔 $\\delta s$ 之间的关系由简单的三角学给出：\n$$ \\sin(\\beta) = \\frac{\\delta r_{\\mathrm{div}}}{\\delta s} $$\n$$ \\delta s = \\frac{\\delta r_{\\mathrm{div}}}{\\sin(\\beta)} $$\n代入 $\\delta r_{\\mathrm{div}}$ 的表达式：\n$$ \\delta s = \\frac{1}{\\sin(\\beta)} \\left(\\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}}\\right) \\delta r $$\n这就得到了所求的、中平面上微小径向位移 $\\delta r$ 与偏滤器上相应弧长位移 $\\delta s$ 之间的关系。其映射微分为：\n$$ \\frac{ds}{dr} = \\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}} \\sin(\\beta)} $$\n\n**第 2 部分：磁岛宽度 $w$ 的计算**\n\n在偏滤器上测得的两个主要热通量峰值之间的分裂 $\\Delta s$ 被解释为从中平面附近的共振面映射过来的磁岛全径向宽度 $w$。因此，我们将 $\\delta r = w$ 和 $\\delta s = \\Delta s$ 代入第 1 部分推导出的关系式中：\n$$ \\Delta s = \\frac{w}{\\sin(\\beta)} \\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}} $$\n解出岛宽 $w$：\n$$ w = \\Delta s \\left(\\frac{B_{p}^{\\mathrm{div}}}{B_{p}^{\\mathrm{mid}}}\\right) \\sin(\\beta) $$\n代入给定的数值：\n$ \\Delta s = 0.180~\\text{m} $, $ B_{p}^{\\mathrm{div}} = 0.020~\\text{T} $, $ B_{p}^{\\mathrm{mid}} = 0.12~\\text{T} $ 及 $ \\beta = 5.0^\\circ $。\n$$ w = (0.180~\\text{m}) \\left(\\frac{0.020~\\text{T}}{0.12~\\text{T}}\\right) \\sin(5.0^\\circ) $$\n$$ w = (0.030~\\text{m}) \\sin(5.0^\\circ) \\approx 0.00261467~\\text{m} $$\n四舍五入到四位有效数字，岛宽为 $w \\approx 0.002615~\\text{m}$。\n\n**第 3 部分：扰动幅度 $b_r$ 的推导与计算**\n\n我们在指定的平板模型中推导磁岛宽度。磁岛的形成由一个描述磁力线轨迹的哈密顿系统控制。在有理面附近，磁力线方程可以写成类单摆形式。磁力线的运动常数，或哈密顿量，可以写作：\n$$ H(x, \\alpha) = \\frac{1}{2} k_y B_z' x^2 + b_r \\cos(\\alpha) $$\n其中 $\\alpha = k_y y - k_z z$ 是螺旋相位角，$x$ 是距共振面的径向坐标，$B_z'$ 是磁剪切参数（以平行场梯度形式给出），$k_y$ 是副法向波数，$b_r$ 是径向磁场扰动的幅度。\n\n磁面是 $H$ 的等值线。岛的分界线是穿过X点（不稳定不动点）的特殊等值线。不动点出现在“力”为零的地方，这对应于哈密顿量的驻点。这些点位于 $x=0$ 处，此时 $\\partial H / \\partial x = 0$。X点对应于势能项的最大值，即在 $\\cos(\\alpha)=1$ 时，所以 $\\alpha=0, 2\\pi, ...$。因此，分界线上的哈密顿值为：\n$$ H_{\\mathrm{sep}} = H(x=0, \\alpha=0) = \\frac{1}{2} k_y B_z' (0)^2 + b_r \\cos(0) = b_r $$\n岛的全宽 $w$ 是分界线的最大径向间隔，即最大径向范围 $x_{\\mathrm{max}}$ 的 $2$ 倍。这个最大范围出现在O点（稳定不动点）的相位上，此时 $\\cos(\\alpha)=-1$，所以 $\\alpha=\\pi, 3\\pi, ...$。将此轨迹上的哈密顿量设为等于 $H_{\\mathrm{sep}}$：\n$$ H(x_{\\mathrm{max}}, \\alpha=\\pi) = \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 + b_r \\cos(\\pi) = H_{\\mathrm{sep}} $$\n$$ \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 - b_r = b_r $$\n$$ \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 = 2 b_r $$\n$$ x_{\\mathrm{max}}^2 = \\frac{4 b_r}{k_y B_z'} \\implies x_{\\mathrm{max}} = 2\\sqrt{\\frac{b_r}{k_y B_z'}} $$\n岛的全宽 $w$ 是半宽 $x_{\\mathrm{max}}$ 的两倍：\n$$ w = 2 x_{\\mathrm{max}} = 4\\sqrt{\\frac{b_r}{k_y B_z'}} $$\n这就是所求的岛宽表达式。为了求出扰动幅度 $b_r$，我们反转这个关系：\n$$ w^2 = 16 \\frac{b_r}{k_y B_z'} $$\n$$ b_r = \\frac{w^2 k_y B_z'}{16} $$\n现在我们代入数值。首先，我们计算副法向波数 $k_y$：\n$ m=27 $ 及 $ r_s = 0.85~\\text{m} $。\n$$ k_y = \\frac{m}{r_s} = \\frac{27}{0.85~\\text{m}} \\approx 31.7647~\\text{m}^{-1} $$\n使用未舍入的 $w \\approx 0.00261467~\\text{m}$ 和给定的 $B_z' = 3.2~\\text{T/m}$：\n$$ b_r = \\frac{(0.00261467~\\text{m})^2 (31.7647~\\text{m}^{-1}) (3.2~\\text{T/m})}{16} $$\n$$ b_r \\approx \\frac{(6.8365 \\times 10^{-6}~\\text{m}^2) (31.7647~\\text{m}^{-1}) (3.2~\\text{T/m})}{16} \\approx \\frac{6.9508 \\times 10^{-4}~\\text{T}}{16} $$\n$$ b_r \\approx 4.34427 \\times 10^{-5}~\\text{T} $$\n四舍五入到四位有效数字，所需的扰动幅度为 $b_r \\approx 4.344 \\times 10^{-5}~\\text{T}$。\n\n### 最终数值结果\n- 扰动幅度：$b_r = 4.344 \\times 10^{-5}~\\text{T}$\n- 岛宽：$w = 0.002615~\\text{m}$\n最终答案以有序对 $(b_r, w)$ 的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.344 \\times 10^{-5}  0.002615 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在了解如何诊断现有磁岛的属性后，我们转向一个更具前瞻性的控制问题。本练习探讨了主动控制磁岛宽度如何直接影响我们关键的工程目标——降低峰值热通量。通过一个简化的经验模型，你将量化磁岛宽度与峰值热通量之间的关系，并深入探讨一个在岛偏滤器操作中至关重要的权衡：即在保护偏滤器部件和维持核心等离子体约束性能之间做出抉择。",
            "id": "3705584",
            "problem": "一台配备有岛状偏滤器（ID）的托卡马克，在等离子体边界处利用饱和磁岛进行运行，以展宽偏滤器靶板上的热通量足迹。在稳态下，假设靶板峰值热通量由能量守恒以及功率在湿润面积上的几何展宽决定。设进入刮削层（SOL）的功率为 $P_{\\mathrm{sep}}$，流向单个外偏滤器靶板的功率份额为 $f_{\\mathrm{div}}$，因此靶板功率为 $P_{t} = f_{\\mathrm{div}} P_{\\mathrm{sep}}$。对于大半径为 $R$ 的圆截面托卡马克，将有效湿潤面积建模为 $A_{\\mathrm{eff}} = 2 \\pi R \\lambda_{q,\\mathrm{eff}}$，其中 $\\lambda_{q,\\mathrm{eff}}$ 是靶板上的有效热通量宽度。在存在宽度为 $w$ 的饱和磁岛时，采用经验支持的展宽模型\n$$\n\\lambda_{q,\\mathrm{eff}} = \\lambda_{q0} + \\beta w ,\n$$\n其中 $\\lambda_{q0}$ 是没有磁岛时的基线热通量宽度，$\\beta$ 是一个代表磁力线穿过磁岛展宽效应的几何/映射系数。\n\n从能量守恒和这些定义出发，推导靶板峰值热通量 $q_{t}$ 对 $w$ 的依赖关系。然后，对于以下参数：\n- $P_{\\mathrm{sep}} = 20 \\,\\mathrm{MW}$，\n- $f_{\\mathrm{div}} = 0.5$,\n- $R = 3.0 \\,\\mathrm{m}$,\n- $\\lambda_{q0} = 0.020 \\,\\mathrm{m}$,\n- $\\beta = 0.50$,\n- $w_{0} = 0.060 \\,\\mathrm{m}$,\n\n计算当磁岛宽度从 $w_{0}$ 翻倍到 $2 w_{0}$ 时，下式的相对变化量\n$$\n\\delta = \\frac{q_{t}(2 w_{0}) - q_{t}(w_{0})}{q_{t}(w_{0})}\n$$\n将 $\\delta$ 表示为小数（无单位），并将最终答案四舍五入到四位有效数字。\n\n最后，从输运和约束的第一性原理出发，通过讨论通过增加 $w$ 来降低 $q_{t}$ 与其对芯部能量约束的影响之间的权衡，来解释这个结果。",
            "solution": "问题陈述已通过验证，并被认为是合理的。它在科学上基于等离子体物理和托卡马克中的热输运原理，问题提法适定，信息充分，可得出唯一解，且表述客观。我们可以开始求解。\n\n问题要求分三部分作答：首先，推导靶板峰值热通量 $q_{t}$ 对磁岛宽度 $w$ 的依赖关系；其次，计算当磁岛宽度翻倍时 $q_t$ 的相对变化量；第三，对所涉及的权衡提供物理解释。\n\n首先，我们推导 $q_t(w)$ 的表达式。靶板峰值热通量由能量守恒定义，即到达靶板的功率 $P_t$分布在一个有效面积 $A_{\\mathrm{eff}}$ 上。\n$$\nq_{t} = \\frac{P_{t}}{A_{\\mathrm{eff}}}\n$$\n问题给出了 $P_t$ 和 $A_{\\mathrm{eff}}$ 的表达式。到达靶板的功率是穿过分界面的总功率 $P_{\\mathrm{sep}}$ 的一部分，份额为 $f_{\\mathrm{div}}$：\n$$\nP_{t} = f_{\\mathrm{div}} P_{\\mathrm{sep}}\n$$\n对于大半径为 $R$ 的圆截面托卡马克，有效湿润面积由下式给出：\n$$\nA_{\\mathrm{eff}} = 2 \\pi R \\lambda_{q,\\mathrm{eff}}\n$$\n其中 $\\lambda_{q,\\mathrm{eff}}$ 是有效热通量宽度。由于宽度为 $w$ 的磁岛的存在，该宽度展宽的模型由以下经验关系式给出：\n$$\n\\lambda_{q,\\mathrm{eff}} = \\lambda_{q0} + \\beta w\n$$\n此处，$\\lambda_{q0}$ 是没有磁岛时的固有热通量宽度，$\\beta$ 是一个量化磁岛展宽热通量有效性的系数。\n\n将这些表达式代入 $q_t$ 的方程，我们得到靶板峰值热通量对磁岛宽度 $w$ 的依赖关系：\n$$\nq_{t}(w) = \\frac{f_{\\mathrm{div}} P_{\\mathrm{sep}}}{2 \\pi R (\\lambda_{q0} + \\beta w)}\n$$\n该表达式表明，$q_t$与 $w$ 的一个线性函数成反比。随着磁岛宽度 $w$ 的增加，分母增大，因此峰值热通量 $q_t$ 减小，这正是岛状偏滤器的预期目的。\n\n接下来，我们计算当磁岛宽度从初始值 $w_{0}$ 翻倍到 $2w_{0}$ 时的相对变化量 $\\delta$。$\\delta$ 的定义是：\n$$\n\\delta = \\frac{q_{t}(2 w_{0}) - q_{t}(w_{0})}{q_{t}(w_{0})} = \\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} - 1\n$$\n使用我们推导出的 $q_t(w)$ 表达式，我们可以构建比率：\n$$\n\\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} = \\frac{\\frac{f_{\\mathrm{div}} P_{\\mathrm{sep}}}{2 \\pi R (\\lambda_{q0} + \\beta (2w_{0}))}}{\\frac{f_{\\mathrm{div}} P_{\\mathrm{sep}}}{2 \\pi R (\\lambda_{q0} + \\beta w_{0})}}\n$$\n常数项 $f_{\\mathrm{div}}$, $P_{\\mathrm{sep}}$, $2$, $\\pi$, 和 $R$ 相互抵消，剩下：\n$$\n\\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} = \\frac{\\lambda_{q0} + \\beta w_{0}}{\\lambda_{q0} + 2\\beta w_{0}}\n$$\n将此式代回 $\\delta$ 的表达式中：\n$$\n\\delta = \\frac{\\lambda_{q0} + \\beta w_{0}}{\\lambda_{q0} + 2\\beta w_{0}} - 1\n$$\n给定以下数值：$\\lambda_{q0} = 0.020 \\,\\mathrm{m}$，$\\beta = 0.50$，以及 $w_{0} = 0.060 \\,\\mathrm{m}$。我们将这些数值代入 $\\delta$ 的表达式中。\n首先，我们计算 $\\beta w_0$ 项：\n$$\n\\beta w_0 = (0.50)(0.060 \\,\\mathrm{m}) = 0.030 \\,\\mathrm{m}\n$$\n现在，我们可以计算分数的分子和分母：\n$$\n\\lambda_{q0} + \\beta w_0 = 0.020 \\,\\mathrm{m} + 0.030 \\,\\mathrm{m} = 0.050 \\,\\mathrm{m}\n$$\n$$\n\\lambda_{q0} + 2\\beta w_0 = 0.020 \\,\\mathrm{m} + 2(0.030 \\,\\mathrm{m}) = 0.020 \\,\\mathrm{m} + 0.060 \\,\\mathrm{m} = 0.080 \\,\\mathrm{m}\n$$\n因此，该比率为：\n$$\n\\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} = \\frac{0.050}{0.080} = \\frac{5}{8} = 0.625\n$$\n最后，我们计算 $\\delta$：\n$$\n\\delta = 0.625 - 1 = -0.375\n$$\n按照要求四舍五入到四位有效数字，我们得到 $\\delta = -0.3750$。这表示当磁岛宽度翻倍时，靶板峰值热通量减少了 $37.5\\%$。\n\n最后，我们讨论降低 $q_t$ 与其对芯部能量约束影响之间的物理权衡。计算结果 $\\delta  0$ 证实了增加磁岛宽度能有效降低偏滤器上的峰值热通量。其背后的物理机制是等离子体边界处磁场拓扑的改变。磁岛是一个磁通量面破裂并重构成新的、孤立的岛状拓扑的区域。这种结构与刮削层的开放磁力线相交，有效地将它们“编织”在一起，并引导外流的等离子体和热量流向靶板上一个大得多的区域。这种展宽直接增加了 $\\lambda_{q,\\mathrm{eff}}$ 并降低了 $q_t$。\n\n然而，这种好处是以牺牲芯部等离子体性能为代价的。标准托卡马克位形中嵌套的同心磁通量面对提供热绝缘至关重要，从而约束高温的芯部等离子体。磁岛本质上是这种理想绝缘结构中的一种微扰——一个“空洞”。热量和粒子沿着磁力线的输运速度极快，而垂直于磁力线的输运则慢得多。在磁岛内部，磁力线结构为跨越磁岛径向范围的输运提供了“短路”，导致局部温度和密度剖面变得平坦。\n\n当在等离子体边界处感应出一个大磁岛时，它会降低高约束模式（H模）运行特征的边界输运垒（即“台基”）中的陡峭压强梯度。这种增强的边界输运意味着更多能量和粒子从主等离子体中泄漏出来。因此，全局能量约束时间 $\\tau_E$（定义为总储能与总加热功率之比）会减小。较低的 $\\tau_E$ 意味着在给定的加热功率下，只能维持较低的芯部温度和压强，这对于聚变装置的整体性能及其实现净能量增益的前景是不利的。\n\n总之，这种权衡是根本性的：增加磁岛宽度 $w$ 有利于降低偏滤器峰值热通量 $q_t$ 以保护材料部件，但同时它通过增加等离子体边界的输运而恶化了能量约束。岛状偏滤器托卡马克的优化运行需要在两者之间找到一个精妙的平衡：磁岛要足够大以将 $q_t$ 控制在材料极限之内，但又要足够小以免过度损害高效聚变功率产生所需的芯部约束。",
            "answer": "$$\n\\boxed{-0.3750}\n$$"
        },
        {
            "introduction": "为了更接近真实物理情景，我们必须考虑等离子体自身对外加磁场的响应。实践中，由外部线圈施加的磁场会被导电的等离子体“屏蔽”，从而减弱其在共振面上的强度。本计算练习将深入探讨这一关键的等离子体屏蔽效应。你将模拟等离子体电阻率和磁场旋转频率如何共同决定最终的磁岛大小，并最终评估其对热通量控制的实际效果，从而让你对岛偏滤器的控制获得更深层次的理解。",
            "id": "3705560",
            "problem": "考虑核聚变装置中岛状偏滤器位形下的剪切平板边缘模型。其目的是量化外部施加的线圈谱如何被等离子体屏蔽，所产生的磁岛如何形成，以及这些磁岛如何改变偏滤器靶板上的热通量密度。使用以下基于物理的近似，这些近似从电阻磁流体动力学（MHD）、法拉第定律、安培定律和欧姆定律出发，并采用局部剪切平板近似来描述场线几何。\n\n基本依据：\n- 法拉第定律：$\\nabla \\times \\mathbf{E} = - \\partial \\mathbf{B}/\\partial t$。\n- 安培定律（用于扰动电流密度的静磁形式）：$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$。\n- 等离子体中的电阻欧姆定律：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$，其中 $\\eta$ 是 Spitzer 电阻率。\n- 在均匀导体中，当受到角频率为 $\\omega$ 的谐波磁扰动（表示场相对于等离子体的旋转）时，电磁扩散会产生一个趋肤深度 $\\delta = \\sqrt{2 \\eta / (\\mu_0 \\omega)}$，该深度控制着扰动振幅随深度呈指数衰减。\n\n几何与磁岛形成模型：\n- 采用局部剪切平板模型，其引导场为 $\\mathbf{B}_0 = B_0 \\hat{z}$，磁剪切 $s$ 为常数，使得场线具有由 $s$ 表征的局部螺距变化。\n- 一个外部施加的、具有极向波数 $k_y$ 的共振径向场谐波会产生一个扰动磁通函数 $\\tilde{\\psi}$，其通过 $b_r \\approx k_y \\tilde{\\psi}$ 与径向场振幅 $b_r$ 相关联。\n- 在有理面附近，场线哈密顿量简化为类摆形式，从而得到标准的剪切平板磁岛半宽 $w = 4 \\sqrt{|\\tilde{\\psi}|/(|B_0 s|)}$。利用 $b_r \\approx k_y \\tilde{\\psi}$ 消去 $\\tilde{\\psi}$，可得\n$$\nw = 4 \\sqrt{\\frac{|b_r|}{|k_y| B_0 s}} .\n$$\n\n屏蔽与热通量模型：\n- 设等离子体边界处的一个谐波具有边缘振幅 $b_{r,\\mathrm{edge}}$ 和角频率 $\\omega$。从边界到有理面的距离为 $L$。等离子体屏蔽（趋肤效应）得出有理面处的屏蔽后振幅为：\n$$\nb_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}} \\exp\\!\\left(-\\frac{L}{\\delta}\\right), \\quad \\delta = \\begin{cases}\n\\sqrt{\\dfrac{2 \\eta}{\\mu_0 \\omega}},  \\omega  0, \\\\\n\\infty,  \\omega = 0,\n\\end{cases}\n$$\n因此，在此近似下，静态扰动（$\\omega = 0$）不会被屏蔽。\n- 对于一个极向模数为 $m$、有理面半径为 $r_s$ 的谐波，取 $k_y = m/r_s$。\n- 对于多个谐波，假设偏滤器热通量宽度的展宽是可加的，其值为几何映射因子 $\\gamma$ 乘以磁岛半宽之和，从而得到有效靶板宽度\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda_q + \\gamma \\sum_h w_h ,\n$$\n其中 $\\lambda_q$ 是没有磁岛时的基准热通量宽度，$w_h$ 是谐波 $h$ 的半宽。\n- 偏滤器靶板热通量密度被建模为轴对称输入功率 $P_{\\mathrm{in}}$ 分布在有效面积 $2 \\pi R \\lambda_{\\mathrm{eff}}$ 上，得出\n$$\nq_t = \\frac{P_{\\mathrm{in}}}{2 \\pi R \\lambda_{\\mathrm{eff}}} .\n$$\n\n任务：\n- 实现一个程序，针对下面描述的每个测试用例，为每个谐波计算等离子体屏蔽后的 $b_{r,\\mathrm{scr}}$、磁岛半宽 $w_h$，然后计算有效宽度 $\\lambda_{\\mathrm{eff}}$ 和靶板热通量 $q_t$。\n- 使用 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n- $q_t$ 的最终数值答案必须以 $\\mathrm{W/m^2}$ 为单位表示。\n- 角度单位不出现；不要引入角度。\n- 你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\mathrm{[result1,result2,result3]}$），结果的顺序应与下面的测试用例一致。\n\n测试套件：\n- 测试用例 #1（一般情况，中等屏蔽）：\n  - 线圈谐波：$\\{(m = 8,\\ b_{r,\\mathrm{edge}} = 3.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 800\\,\\mathrm{s^{-1}}),\\ (m = 10,\\ b_{r,\\mathrm{edge}} = 2.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 1200\\,\\mathrm{s^{-1}})\\}$。\n  - 等离子体与几何参数：$\\eta = 1.2 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.15\\,\\mathrm{m}$, $r_s = 1.05\\,\\mathrm{m}$, $B_0 = 2.5\\,\\mathrm{T}$, $s = 3.5\\,\\mathrm{m^{-1}}$, $\\gamma = 1.8$, $\\lambda_q = 6.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.2\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 6.5 \\times 10^{6}\\,\\mathrm{W}$。\n- 测试用例 #2（高频，强屏蔽）：\n  - 线圈谐波：$\\{(m = 9,\\ b_{r,\\mathrm{edge}} = 2.5 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 6000\\,\\mathrm{s^{-1}}),\\ (m = 12,\\ b_{r,\\mathrm{edge}} = 1.5 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 9000\\,\\mathrm{s^{-1}})\\}$。\n  - 等离子体与几何参数：$\\eta = 8.0 \\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.20\\,\\mathrm{m}$, $r_s = 1.00\\,\\mathrm{m}$, $B_0 = 3.0\\,\\mathrm{T}$, $s = 4.0\\,\\mathrm{m^{-1}}$, $\\gamma = 2.0$, $\\lambda_q = 5.0 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.0\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 5.5 \\times 10^{6}\\,\\mathrm{W}$。\n- 测试用例 #3（静态扰动，无屏蔽）：\n  - 线圈谐波：$\\{(m = 7,\\ b_{r,\\mathrm{edge}} = 4.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 0\\,\\mathrm{s^{-1}})\\}$。\n  - 等离子体与几何参数：$\\eta = 1.0 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.12\\,\\mathrm{m}$, $r_s = 0.95\\,\\mathrm{m}$, $B_0 = 2.2\\,\\mathrm{T}$, $s = 3.0\\,\\mathrm{m^{-1}}$, $\\gamma = 1.5$, $\\lambda_q = 7.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 2.8\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 4.8 \\times 10^{6}\\,\\mathrm{W}$。\n- 测试用例 #4（穿透距离短，弱屏蔽）：\n  - 线圈谐波：$\\{(m = 10,\\ b_{r,\\mathrm{edge}} = 5.0 \\times 10^{-5}\\,\\mathrm{T},\\ \\omega = 400\\,\\mathrm{s^{-1}})\\}`。\n  - 等离子体与几何参数：$\\eta = 2.0 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.03\\,\\mathrm{m}$, $r_s = 1.10\\,\\mathrm{m}$, $B_0 = 2.7\\,\\mathrm{T}$, $s = 2.5\\,\\mathrm{m^{-1}}$, $\\gamma = 1.7$, $\\lambda_q = 4.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.1\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 7.0 \\times 10^{6}\\,\\mathrm{W}$。\n\n你的程序应该按照上面定义的计算方法准确实现，并输出单行，其中包含一个 Python 风格的列表，按给定顺序包含四个测试用例的 $q_t$ 值（单位为 $\\mathrm{W/m^2}$），无任何附加文本。",
            "solution": "该问题是有效的，因为它科学地基于已建立的等离子体物理原理（电阻性磁流体动力学、磁岛理论），给出了所有必要数据使其成为一个适定问题，并且表述客观。所提供的参数在核聚变装置的物理合理范围内。\n\n任务是计算偏滤器靶板上的峰值热通量密度 $q_t$，同时考虑由外部共振磁扰动（RMPs）引起的磁岛展宽效应。计算过程通过应用一系列基于物理的模型来进行，这些模型分别描述等离子体屏蔽、磁岛形成和热通量沉积。该过程针对每个测试用例执行，每个用例可能涉及一个或多个RMP谐波。\n\n控制时变磁场穿透导电等离子体的核心物理原理是趋肤效应。相对于等离子体，一个角频率为 $\\omega$ 的外部磁扰动在穿透过程中会被衰减。这种衰减的特征长度尺度是电磁趋肤深度 $\\delta$。对于电阻率为 $\\eta$、真空磁导率为 $\\mu_0$ 的等离子体，趋肤深度由下式给出\n$$\n\\delta = \\sqrt{\\frac{2 \\eta}{\\mu_0 \\omega}}\n$$\n该公式适用于非静态扰动，即 $\\omega  0$。对于静态扰动，$\\omega = 0$，趋膚深度实际上是无限的，即 $\\delta \\to \\infty$，这意味着场不会通过此机制被屏蔽。在等离子体边缘处，一个振幅为 $b_{r,\\mathrm{edge}}$ 的谐波，其位置距离共振有理面为 $L$，它在有理面处的振幅将被屏蔽为 $b_{r,\\mathrm{scr}}$，其关系如下：\n$$\nb_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}} \\exp\\left(-\\frac{L}{\\delta}\\right)\n$$\n对于静态情况（$\\omega=0$），指数项变为 $\\exp(0) = 1$，因此 $b_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}}$。\n\n一旦有理面上的屏蔽后径向磁场振幅 $b_{r,\\mathrm{scr}}$ 已知，就可以计算出所形成磁岛的大小。在具有均匀引导场 $B_0$ 和恒定磁剪切 $s$ 的剪切平板几何中，单个谐波的磁岛半宽 $w$ 由下式给出：\n$$\nw = 4 \\sqrt{\\frac{|b_{r,\\mathrm{scr}}|}{|k_y| B_0 s}}\n$$\n这里，$k_y$ 是扰动的极向波数。对于有理面半径为 $r_s$ 处极向模数为 $m$ 的谐波，波数近似为 $k_y = m/r_s$。\n\n这些磁岛的存在改变了向偏滤器靶板的热输运。该模型假设固有的热通量宽度 $\\lambda_q$ 会因磁岛而展宽。总有效热通量宽度 $\\lambda_{\\mathrm{eff}}$ 是通过对所有施加的谐波 $h$ 的贡献求和来计算的：\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda_q + \\gamma \\sum_h w_h\n$$\n其中 $w_h$ 是由谐波 $h$ 产生的磁岛半宽，而 $\\gamma$ 是一个几何映射因子，它将等离子体芯部的磁岛宽度与其在偏滤器靶板上的足迹联系起来。\n\n最后，靶板上的峰值热通量密度 $q_t$ 是通过假设总输入功率 $P_{\\mathrm{in}}$ 分布在由大半径 $R$ 和有效宽度 $\\lambda_{\\mathrm{eff}}$ 定义的有效面积上来确定的。这得出了以下表达式：\n$$\nq_t = \\frac{P_{\\mathrm{in}}}{2 \\pi R \\lambda_{\\mathrm{eff}}}\n$$\n\n每个测试用例的计算步骤如下：\n1.  初始化一个变量用于记录总磁岛宽度贡献，$\\sum_h w_h = 0$。\n2.  对于测试用例中指定的每个谐波 $h$：\n    a.  获取谐波的参数：模数 $m$、边缘振幅 $b_{r,\\mathrm{edge}}$ 和角频率 $\\omega$。\n    b.  如果 $\\omega  0$，使用等离子体电阻率 $\\eta$ 和 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$ 计算趋肤深度 $\\delta$。然后，使用穿透深度 $L$ 计算屏蔽后的振幅 $b_{r,\\mathrm{scr}}$。\n    c.  如果 $\\omega = 0$，则设置 $b_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}}$。\n    d.  计算极向波数 $k_y = m/r_s$。\n    e.  使用 $b_{r,\\mathrm{scr}}$、$k_y$、引导场 $B_0$ 和磁剪切 $s$ 计算磁岛半宽 $w_h$。\n    f.  将 $w_h$ 加到运行总和 $\\sum_h w_h$ 中。\n3.  遍历所有谐波后，使用基准宽度 $\\lambda_q$ 和几何因子 $\\gamma$ 计算有效热通量宽度 $\\lambda_{\\mathrm{eff}}$。\n4.  使用输入功率 $P_{\\mathrm{in}}$ 和大半径 $R$ 计算最终的靶板热通量密度 $q_t$。\n5.  这个 $q_t$ 值就是该测试用例的结果。对所有提供的测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the island divertor heat flux problem for all test cases.\n    \"\"\"\n    \n    # Define the constant mu_0\n    MU_0 = 4 * np.pi * 1e-7\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case #1 (general, moderate screening)\n        {\n            \"harmonics\": [\n                {\"m\": 8, \"b_r_edge\": 3.0e-4, \"omega\": 800},\n                {\"m\": 10, \"b_r_edge\": 2.0e-4, \"omega\": 1200},\n            ],\n            \"params\": {\n                \"eta\": 1.2e-6, \"L\": 0.15, \"r_s\": 1.05, \"B0\": 2.5, \"s\": 3.5,\n                \"gamma\": 1.8, \"lambda_q\": 6.5e-3, \"R\": 3.2, \"P_in\": 6.5e6,\n            }\n        },\n        # Test case #2 (high-frequency, strong screening)\n        {\n            \"harmonics\": [\n                {\"m\": 9, \"b_r_edge\": 2.5e-4, \"omega\": 6000},\n                {\"m\": 12, \"b_r_edge\": 1.5e-4, \"omega\": 9000},\n            ],\n            \"params\": {\n                \"eta\": 8.0e-7, \"L\": 0.20, \"r_s\": 1.00, \"B0\": 3.0, \"s\": 4.0,\n                \"gamma\": 2.0, \"lambda_q\": 5.0e-3, \"R\": 3.0, \"P_in\": 5.5e6,\n            }\n        },\n        # Test case #3 (static perturbation, no screening)\n        {\n            \"harmonics\": [\n                {\"m\": 7, \"b_r_edge\": 4.0e-4, \"omega\": 0},\n            ],\n            \"params\": {\n                \"eta\": 1.0e-6, \"L\": 0.12, \"r_s\": 0.95, \"B0\": 2.2, \"s\": 3.0,\n                \"gamma\": 1.5, \"lambda_q\": 7.5e-3, \"R\": 2.8, \"P_in\": 4.8e6,\n            }\n        },\n        # Test case #4 (short penetration distance, weak screening)\n        {\n            \"harmonics\": [\n                {\"m\": 10, \"b_r_edge\": 5.0e-5, \"omega\": 400},\n            ],\n            \"params\": {\n                \"eta\": 2.0e-6, \"L\": 0.03, \"r_s\": 1.10, \"B0\": 2.7, \"s\": 2.5,\n                \"gamma\": 1.7, \"lambda_q\": 4.5e-3, \"R\": 3.1, \"P_in\": 7.0e6,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        harmonics = case[\"harmonics\"]\n        params = case[\"params\"]\n\n        # Unpack parameters for clarity\n        eta = params[\"eta\"]\n        L = params[\"L\"]\n        r_s = params[\"r_s\"]\n        B0 = params[\"B0\"]\n        s = params[\"s\"]\n        gamma = params[\"gamma\"]\n        lambda_q = params[\"lambda_q\"]\n        R = params[\"R\"]\n        P_in = params[\"P_in\"]\n        \n        total_island_width = 0.0\n\n        for h in harmonics:\n            m = h[\"m\"]\n            b_r_edge = h[\"b_r_edge\"]\n            omega = h[\"omega\"]\n\n            # Step 1: Calculate the plasma-screened radial field amplitude b_r_scr\n            if omega == 0:\n                # Static case: no screening by this mechanism\n                b_r_scr = b_r_edge\n            else:\n                # Skin depth delta\n                delta = np.sqrt(2 * eta / (MU_0 * omega))\n                # Screened field amplitude\n                b_r_scr = b_r_edge * np.exp(-L / delta)\n\n            # Step 2: Calculate the island half-width w_h\n            # Poloidal wavenumber k_y\n            k_y = m / r_s\n            \n            # Island half-width\n            numerator = np.abs(b_r_scr)\n            denominator = np.abs(k_y) * B0 * s\n            \n            if denominator == 0:\n                 w_h = 0.0\n            else:\n                 w_h = 4 * np.sqrt(numerator / denominator)\n\n            total_island_width += w_h\n\n        # Step 3: Calculate the effective target width lambda_eff\n        lambda_eff = lambda_q + gamma * total_island_width\n\n        # Step 4: Calculate the target heat flux q_t\n        q_t = P_in / (2 * np.pi * R * lambda_eff)\n        \n        results.append(q_t)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}