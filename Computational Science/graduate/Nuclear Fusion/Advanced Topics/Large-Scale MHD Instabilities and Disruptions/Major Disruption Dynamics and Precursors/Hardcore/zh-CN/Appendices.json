{
    "hands_on_practices": [
        {
            "introduction": "许多大破裂始于等离子体核心区域的小尺度不稳定性。由 $m=n=1$ 内扭曲模驱动的锯齿振荡便是一个典型的例子。本练习将引导你从理想磁流体力学（MHD）能量原理出发，推导该模式的不稳定判据，并估算其崩潰的特征时间，从而对MHD不穩定性的時間尺度建立具體的認識。",
            "id": "3708729",
            "problem": "考虑一个大环径比、圆形截面的托卡马克，其大半径为 $R_0$，小半径为 $a$，安全因子剖面 $q(r)$ 单调，满足 $q(0)=q_0$ 且在半径 $r_1$ 处 $q(r_1)=1$。假设一个平衡态，其中环向磁场 $B_{\\phi}$占主导地位，极向磁场 $B_{\\theta}(r)$ 通过 $q(r)=r B_{\\phi}/\\left(R_0 B_{\\theta}(r)\\right)$ 与安全因子相关。压强剖面 $p(r)$ 是光滑的，且平衡态处于低等离子体比压极限下，因此磁力线的弯曲效应主导了可压缩性。使用理想磁流体力学（MHD）能量原理，取一个局域在 $q=1$ 面的螺旋状试探位移，其形式为 $\\boldsymbol{\\xi}(r,\\theta,\\phi)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{r}\\,\\cos(\\theta-\\phi)$，极向模数为 $m=1$，环向模数为 $n=1$，且 $\\xi(r)$ 在 $r=r_1$ 附近有尖峰。从理想 MHD 能量原理出发，并一致地应用大环径比近似，推导在此 $m=n=1$ 内扭曲模扰动下，势能变化 $\\delta W$ 变为负值的条件。用 $q_0$ 和 $r=r_1$ 处的局域性质来表述所得的锯齿崩塌判据，并明确指出决定 $\\delta W$ 符号的物理机制。\n\n接下来，在电阻磁流体力学（MHD）中估算锯齿崩塌的重联时间，将重联过程建模为在 $q=1$ 有理面上的 Sweet–Parker 型过程。使用 $r=r_1$ 处的极向场 $B_{\\theta}(r_1)$ 作为重联磁场，并取特征电流片长度为极向周长 $L=2\\pi r_1$。基于重联场定义阿尔芬速度为 $v_{A\\theta}=B_{\\theta}(r_1)/\\sqrt{\\mu_0 \\rho}$，其中质量密度 $\\rho=n_i m_i$。重联时间可以用阿尔芬时间 $\\tau_A=L/v_{A\\theta}$ 和伦奎斯特数 $S=\\mu_0 L v_{A\\theta}/\\eta$ 来表示，其中 $\\eta$ 是电阻率。对于以下典型的托卡马克参数：\n- $R_0=1.7 \\ \\mathrm{m}$,\n- $a=0.6 \\ \\mathrm{m}$,\n- $r_1=0.30 \\ \\mathrm{m}$,\n- $B_{\\phi}=3.0 \\ \\mathrm{T}$,\n- $q(r_1)=1$,\n- 离子数密度 $n_i=5.0\\times 10^{19} \\ \\mathrm{m}^{-3}$,\n- 离子质量 $m_i=2 m_p$ 其中质子质量 $m_p=1.6726\\times 10^{-27} \\ \\mathrm{kg}$,\n- 磁导率 $\\mu_0=4\\pi\\times 10^{-7} \\ \\mathrm{H/m}$,\n- 电阻率 $\\eta=1.0\\times 10^{-6} \\ \\Omega \\cdot \\mathrm{m}$,\n使用 Sweet–Parker 标度律计算重联时间 $t_{\\mathrm{rec}}$，并以毫秒（ms）为单位表示最终数值答案。将您的答案四舍五入到三位有效数字。最终答案必须是一个实数值。",
            "solution": "该问题包含两个不同的部分：首先，推导触发锯齿崩塌的 $m=n=1$ 内扭曲模的理想磁流体力学（MHD）不稳定性判据；其次，使用 Sweet 和 Parker 的电阻 MHD 模型计算崩塌阶段的重联时间。该问题具有科学依据，提法明确，并为完整解答提供了所有必要的参数。\n\n**第一部分：锯齿崩塌的理想 MHD 不稳定性判据**\n\n等离子体对理想 MHD 扰动 $\\boldsymbol{\\xi}$ 的稳定性由势能变化 $\\delta W$ 的符号决定。如果存在一个物理上允许的位移使得 $\\delta W  0$，则系统是不稳定的。$\\delta W$ 的一般表达式为：\n$$ \\delta W = \\frac{1}{2} \\int \\left[ \\frac{|\\delta \\boldsymbol{B}|^2}{\\mu_0} - \\boldsymbol{J}_0 \\cdot (\\boldsymbol{\\xi} \\times \\delta \\boldsymbol{B}) + (\\boldsymbol{\\xi} \\cdot \\nabla p_0) (\\nabla \\cdot \\boldsymbol{\\xi}) + \\gamma p_0 (\\nabla \\cdot \\boldsymbol{\\xi})^2 \\right] dV $$\n其中 $\\delta \\boldsymbol{B} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\boldsymbol{B}_0)$，下标 $0$ 表示平衡量。\n\n对于形式为 $\\boldsymbol{\\xi} \\propto \\exp(i(m\\theta - n\\phi))$ 的螺旋扰动，扰动磁场包含一个平行波矢分量 $k_{||} \\propto (m - nq(r))$。对 $\\delta W$ 的主要贡献通常来自磁力线弯曲项 $|\\delta \\boldsymbol{B}|^2$，其大小与 $k_{||}^2$ 成正比。对于 $m=n=1$ 内扭曲模，该项在有理面 $r=r_1$ 处最小化，因为此处 $q(r_1)=1$，使得 $k_{||}=0$。这允许以相对较小的能量代价产生大幅度的扰动。\n\n为推导不稳定性判据，我们分析了指定试探函数 $\\boldsymbol{\\xi}(r,\\theta,\\phi)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{r}\\,\\cos(\\theta-\\phi)$（局域于 $q=1$ 面）下的 $\\delta W$。在大环径比、圆形截面近似下，对 $\\delta W$ 的分析表明，能量变化可以分解为来自核心区（$r  r_1$）和外部区域（$r > r_1$）的贡献。外部区域的等离子体对此模式是稳定的，因此那里的任何位移都会耗费大量能量。因此，理想模式被限制在 $r \\le r_1$ 区域内，并取 $r>r_1$ 时的位移为零。\n\n在核心区（$r  r_1$）内，使能量最小化的位移是整个等离子体柱的准刚性“平顶帽”式运动，即 $\\xi(r)$ 在 $r  r_1$ 区域内近似为常数，并在 $r=r_1$ 处急剧降至零。对于这样的位移，$\\delta W$ 由两个主要的竞争项组成：\n1.  一个稳定的磁能项，它是正的，并且取决于核心区内安全因子与 1 的偏离程度。该项正比于在 $r  r_1$ 体积内对 $(1-1/q)^2$ 的积分。\n2.  一个不稳定的压强梯度项，它是负的（因为 $dp/dr  0$），源于等离子体核心移动并膨胀到环向磁场较弱的区域时释放的热能。\n\n当不稳定的压强项超过稳定的磁能项时，不稳定性发生。一个关键的观察是，稳定项对 $q$ 剖面的形状高度敏感。如果 $q(0)=q_0$ 非常接近 1，那么在整个核心区 $r  r_1$ 内 $q(r)$ 剖面相对平坦，磁能稳定项就会非常小。在这种情况下，即使是很小的压强梯度也能驱动不稳定性。因此，一个简化的理想 MHD 锯齿崩塌判据是 $q_0$ 降至略低于 1。更精确的判据（如 Bussac 判据）表明，不稳定性在 $q_0$ 达到某个低于 1 的阈值时被触发，该阈值取决于压强剖面和 $q$ 剖面的形状。\n\n**第二部分：Sweet-Parker 重联时间计算**\n\nSweet-Parker 模型描述了电阻 MHD 中的磁重联，并预测了一个特征重联时间 $t_{\\mathrm{rec}}$。这个时间是阿尔芬时间 $\\tau_A$ 和伦奎斯特数 $S$ 的几何平均：\n$$ t_{\\mathrm{rec}} = \\sqrt{\\tau_A S} = \\tau_A \\sqrt{S} $$\n\n我们需要计算 $\\tau_A$ 和 $S$。\n1.  **计算重联磁场** $B_{\\theta}(r_1)$:\n    由安全因子定义 $q(r) = r B_{\\phi} / (R_0 B_{\\theta}(r))$，我们可以在 $r=r_1$ 处求解 $B_{\\theta}(r_1)$，因为 $q(r_1)=1$：\n    $1 = r_1 B_{\\phi} / (R_0 B_{\\theta}(r_1)) \\implies B_{\\theta}(r_1) = \\frac{r_1 B_{\\phi}}{R_0}$\n    $B_{\\theta}(r_1) = \\frac{(0.30 \\, \\mathrm{m})(3.0 \\, \\mathrm{T})}{1.7 \\, \\mathrm{m}} \\approx 0.5294 \\, \\mathrm{T}$\n\n2.  **计算质量密度** $\\rho$:\n    $\\rho = n_i m_i = (5.0 \\times 10^{19} \\, \\mathrm{m}^{-3}) \\times (2 \\times 1.6726 \\times 10^{-27} \\, \\mathrm{kg}) \\approx 1.6726 \\times 10^{-7} \\, \\mathrm{kg/m}^3$\n\n3.  **计算极向阿尔芬速度** $v_{A\\theta}$:\n    $v_{A\\theta} = \\frac{B_{\\theta}(r_1)}{\\sqrt{\\mu_0 \\rho}} = \\frac{0.5294 \\, \\mathrm{T}}{\\sqrt{(4\\pi \\times 10^{-7} \\, \\mathrm{H/m}) \\times (1.6726 \\times 10^{-7} \\, \\mathrm{kg/m}^3)}} \\approx \\frac{0.5294}{\\sqrt{2.1018 \\times 10^{-13}}} \\approx \\frac{0.5294}{4.5845 \\times 10^{-7}} \\approx 1.1548 \\times 10^6 \\, \\mathrm{m/s}$\n\n4.  **计算阿尔芬时间** $\\tau_A$:\n    特征长度是极向周长 $L = 2\\pi r_1 = 2\\pi (0.30 \\, \\mathrm{m}) \\approx 1.885 \\, \\mathrm{m}$。\n    $\\tau_A = \\frac{L}{v_{A\\theta}} = \\frac{1.885 \\, \\mathrm{m}}{1.1548 \\times 10^6 \\, \\mathrm{m/s}} \\approx 1.632 \\times 10^{-6} \\, \\mathrm{s}$\n\n5.  **计算伦奎斯特数** $S$:\n    $S = \\frac{\\mu_0 L v_{A\\theta}}{\\eta} = \\frac{(4\\pi \\times 10^{-7} \\, \\mathrm{H/m})(1.885 \\, \\mathrm{m})(1.1548 \\times 10^6 \\, \\mathrm{m/s})}{1.0 \\times 10^{-6} \\, \\Omega \\cdot \\mathrm{m}} \\approx 2.735 \\times 10^6$\n    注意 $S$ 是无量纲的。\n\n6.  **计算重联时间** $t_{\\mathrm{rec}}$:\n    $t_{\\mathrm{rec}} = \\tau_A \\sqrt{S} = (1.632 \\times 10^{-6} \\, \\mathrm{s}) \\sqrt{2.735 \\times 10^6} \\approx (1.632 \\times 10^{-6}) \\times 1653.8 \\approx 0.002699 \\, \\mathrm{s}$\n\n7.  **转换为毫秒并四舍五入**:\n    $t_{\\mathrm{rec}} \\approx 2.699 \\, \\mathrm{ms}$\n    四舍五入到三位有效数字，结果是 $2.70 \\, \\mathrm{ms}$。\n\n最终答案是一个实数值。",
            "answer": "$$\\boxed{2.70}$$"
        },
        {
            "introduction": "并非所有的大破裂都纯粹源于磁场不稳定性。等离子体热能的快速损失，即热淬灭，同样可以触发等离子体崩潰。本练习将通过数值建模，探讨杂质辐射如何压倒外部加热功率，从而导致灾难性的冷却事件，这是许多大破裂的一个关键前兆。",
            "id": "3708706",
            "problem": "一个程序必须根据能量平衡和碰撞-辐射冷却的第一性原理，计算环形磁约束装置中的堆芯杂质辐射是否能达到引发热坍缩的水平。考虑一个大半径为 $R_0$、小半径为 $a$、具有柱对称性的圆形截面环体。在小半径 $r$ 处的一个薄环的环体体积元为 $dV = 4 \\pi^2 R_0 r \\, dr$。目标是根据杂质辐射函数 $L_Z(T)$，计算由指定杂质种类引起的堆芯辐射功率，并确定在该堆芯辐射超过输入加热功率指定比例时的堆芯温度范围。\n\n使用以下物理基础：\n- 能量平衡为 $dW/dt = P_{\\text{in}} - P_{\\text{loss}}$，其中 $P_{\\text{loss}}$ 包括辐射。堆芯即将发生热坍缩的一个充分条件是 $P_{\\text{rad, core}} \\ge \\beta P_{\\text{in}}$，其中 $\\beta$ 是一个预定比例，$P_{\\text{in}}$ 是总加热功率（假设为常数），而 $P_{\\text{rad, core}}$ 是杂质堆芯辐射功率。\n- 由杂质种类 $Z$ 引起的局部辐射功率密度为 $p_{\\text{rad}}(r) = n_e(r)\\, n_Z(r)\\, L_Z\\!\\left(T_e(r)\\right)$，其中 $n_e$ 为电子密度，$n_Z$ 为杂质密度，$L_Z(T)$ 为日冕平衡下的杂质辐射函数（冷却率系数），单位为 $\\text{W}\\cdot\\text{m}^3$。\n- 堆芯区域定义为 $r \\in [0, r_c]$，其中 $r_c = \\gamma a$，$\\gamma$ 是小半径的一个给定比例。对于给定的中心温度 $T_0$，堆芯辐射功率为 $P_{\\text{rad, core}}(T_0) = \\displaystyle \\int_0^{r_c} n_e(r)\\, n_Z(r)\\, L_Z\\!\\left(T_e(r)\\right)\\, 4 \\pi^2 R_0 r \\, dr$。\n\n剖面和单位：\n- 电子密度剖面：$n_e(r) = n_0 \\left[1 - \\left(\\dfrac{r}{a}\\right)^2\\right]^{s_n}$，其中 $n_0$ 的单位是 $\\text{m}^{-3}$，$s_n \\ge 0$ 是无量纲的。\n- 杂质分数剖面：$f_Z(r) = f_{Z,\\text{edge}} + \\left(f_{Z,0} - f_{Z,\\text{edge}}\\right) \\left[1 - \\left(\\dfrac{r}{a}\\right)^{p_f}\\right]$，其中 $f_{Z,0}$ 和 $f_{Z,\\text{edge}}$ 是无量纲的；杂质密度为 $n_Z(r) = f_Z(r)\\, n_e(r)$。\n- 电子温度剖面：$T_e(r) = T_{\\text{edge}} + \\left(T_0 - T_{\\text{edge}}\\right) \\left[1 - \\left(\\dfrac{r}{a}\\right)^{\\alpha_T}\\right]$，其中 $T$ 的单位是 $\\text{keV}$。辐射函数 $L_Z$ 在 $T_e$ 处求值，通过 $T[\\text{eV}] = 1000\\, T[\\text{keV}]$ 将温度转换为 $\\text{eV}$。\n- 坍缩判据：$P_{\\text{rad, core}}(T_0) \\ge \\beta P_{\\text{in}}$。\n- 要求的输出单位：温度 $T$ 值以 $\\text{keV}$ 为单位，功率以 $\\text{MW}$ 为单位报告。\n\n待使用的杂质辐射函数 $L_Z(T)$（在 $T$ 的单位为 $\\text{eV}$ 时，以 $\\text{W}\\cdot\\text{m}^3$ 为单位的合理解析近似）：\n- 氖 ($Z=\\text{Ne}$): $L_{\\text{Ne}}(T) = 3.0\\times 10^{-31} \\left(\\dfrac{T}{150.0}\\right)^{0.2} \\exp\\!\\left(-\\dfrac{T}{250.0}\\right) + 1.0\\times 10^{-32} \\left(\\dfrac{T}{1000.0}\\right)^{0.5} \\exp\\!\\left(-\\dfrac{T}{5000.0}\\right)$。\n- 氩 ($Z=\\text{Ar}$): $L_{\\text{Ar}}(T) = 1.5\\times 10^{-31} \\left(\\dfrac{T}{1500.0}\\right)^{0.4} \\exp\\!\\left(-\\dfrac{T}{2200.0}\\right) + 3.0\\times 10^{-32} \\left(\\dfrac{T}{6000.0}\\right)^{0.5} \\exp\\!\\left(-\\dfrac{T}{8000.0}\\right)$。\n\n算法任务：\n对于每个测试用例，在指定区间 $[T_{\\min}, T_{\\max}]$ 内以 $N_T$ 个均匀间隔的样本点扫描中心温度 $T_0$。对于每个 $T_0$，计算 $P_{\\text{rad, core}}(T_0)$；确定：\n- 在扫描过程中 $P_{\\text{rad, core}}$ 达到其最大值时的温度 $T_{\\text{pk}}$，以及相应的峰值堆芯辐射功率 $P_{\\text{pk}}$。\n- 坍缩判据成立的 $T_0$ 值区间，由扫描中满足 $P_{\\text{rad, core}}(T_0) \\ge \\beta P_{\\text{in}}$ 的最小和最大 $T_0$ 值来概括。如果没有 $T_0$ 满足该判据，则报告 $T_{\\min}^{\\text{collapse}} = 0.0$ 和 $T_{\\max}^{\\text{collapse}} = 0.0$。\n\n测试套件：\n提供以下四个测试用例，每个用例由一组参数元组 $(\\text{species}, R_0, a, n_0, s_n, f_{Z,0}, f_{Z,\\text{edge}}, p_f, T_{\\text{edge}}, \\alpha_T, \\gamma, P_{\\text{in}}, \\beta, T_{\\min}, T_{\\max}, N_T)$ 定义，单位如上所述：\n- 用例 1（正常路径，氖，中等装置和掺杂）：$(\\text{\"Ne\"},\\, 1.7,\\, 0.5,\\, 8.0\\times 10^{19},\\, 1.0,\\, 5.0\\times 10^{-3},\\, 2.0\\times 10^{-3},\\, 1.0,\\, 0.1,\\, 2.0,\\, 0.3,\\, 8.0\\times 10^{6},\\, 0.3,\\, 0.5,\\, 5.0,\\, 120)$。\n- 用例 2（高加热，氩，低掺杂，可能无坍缩）：$(\\text{\"Ar\"},\\, 1.7,\\, 0.5,\\, 8.0\\times 10^{19},\\, 1.0,\\, 1.0\\times 10^{-3},\\, 5.0\\times 10^{-4},\\, 1.0,\\, 0.5,\\, 2.0,\\, 0.3,\\, 2.5\\times 10^{7},\\, 0.3,\\, 1.0,\\, 10.0,\\, 120)$。\n- 用例 3（强氖掺杂，较低加热，易于坍缩）：$(\\text{\"Ne\"},\\, 1.7,\\, 0.5,\\, 8.0\\times 10^{19},\\, 1.0,\\, 1.0\\times 10^{-2},\\, 5.0\\times 10^{-3},\\, 1.0,\\, 0.1,\\, 2.0,\\, 0.3,\\, 6.0\\times 10^{6},\\, 0.3,\\, 0.3,\\, 3.0,\\, 120)$。\n- 用例 4（较小装置，氩，中等掺杂，适度加热）：$(\\text{\"Ar\"},\\, 1.0,\\, 0.4,\\, 6.0\\times 10^{19},\\, 1.0,\\, 3.0\\times 10^{-3},\\, 1.0\\times 10^{-3},\\, 1.0,\\, 0.2,\\, 2.0,\\, 0.3,\\, 5.0\\times 10^{6},\\, 0.3,\\, 0.5,\\, 5.0,\\, 120)$。\n\n最终输出格式：\n你的程序应产生单行输出，包含一个由四个子列表组成的列表，每个测试用例一个子列表，每个子列表的形式为 $[T_{\\text{pk}}, P_{\\text{pk}}, T_{\\min}^{\\text{collapse}}, T_{\\max}^{\\text{collapse}}]$，其中 $T_{\\text{pk}}$、$T_{\\min}^{\\text{collapse}}$ 和 $T_{\\max}^{\\text{collapse}}$ 的单位是 $\\text{keV}$，$P_{\\text{pk}}$ 的单位是 $\\text{MW}$。该单行必须是一个用方括号括起来的逗号分隔列表，其中的数值在打印输出时四舍五入到六位小数，例如 $[[0.750000,1.234567,0.300000,1.200000],[\\dots]]$。",
            "solution": "该问题是有效的，因为它科学上基于等离子体物理的既定原理，数学上是适定的，并提供了一套完整且一致的数据和定义。任务是计算环形聚变等离子体堆芯中杂质的辐射功率，并基于此辐射评估热坍缩的风险。\n\n问题的核心是计算等离子体堆芯内（定义为区域 $r \\in [0, r_c]$，其中 $r_c = \\gamma a$）由指定杂质种类产生的总辐射功率。总堆芯辐射功率 $P_{\\text{rad, core}}$ 作为中心电子温度 $T_0$ 的函数，由局部辐射功率密度 $p_{\\text{rad}}(r)$ 的体积积分给出。\n\n局部辐射功率密度由下式给出：\n$$p_{\\text{rad}}(r) = n_e(r) \\, n_Z(r) \\, L_Z(T_e(r))$$\n其中 $n_e(r)$ 是电子密度剖面，$n_Z(r)$ 是杂质密度剖面，而 $L_Z(T_e(r))$ 是在局部电子温度 $T_e(r)$ 处求值的杂质辐射函数（冷却率系数）。对于 $L_Z$ 函数，温度单位必须是 $\\text{eV}$，而剖面是以 $\\text{keV}$ 定义的，因此需要转换 $T[\\text{eV}] = 1000 \\cdot T[\\text{keV}]$。\n\n杂质密度 $n_Z(r)$ 通过杂质分数剖面 $f_Z(r)$ 与电子密度 $n_e(r)$ 相关：\n$$n_Z(r) = f_Z(r) \\, n_e(r)$$\n将此代入功率密度表达式得到：\n$$p_{\\text{rad}}(r) = n_e(r)^2 \\, f_Z(r) \\, L_Z(T_e(r))$$\n\n总功率是通过将此功率密度在堆芯体积上积分得到的。使用所提供的薄环环体体积元 $dV = 4 \\pi^2 R_0 r \\, dr$，堆芯辐射功率的积分变为：\n$$P_{\\text{rad, core}}(T_0) = \\int_0^{r_c} p_{\\text{rad}}(r) \\, dV = \\int_0^{r_c} n_e(r)^2 \\, f_Z(r) \\, L_Z(T_e(r)) \\, 4 \\pi^2 R_0 r \\, dr$$\n\n电子密度 $n_e(r)$、杂质分数 $f_Z(r)$ 和电子温度 $T_e(r)$ 的剖面如下所示：\n1.  电子密度剖面：\n    $$n_e(r) = n_0 \\left[1 - \\left(\\frac{r}{a}\\right)^2\\right]^{s_n}$$\n2.  杂质分数剖面：\n    $$f_Z(r) = f_{Z,\\text{edge}} + (f_{Z,0} - f_{Z,\\text{edge}}) \\left[1 - \\left(\\frac{r}{a}\\right)^{p_f}\\right]$$\n3.  电子温度剖面（依赖于中心温度 $T_0$）：\n    $$T_e(r) = T_{\\text{edge}} + (T_0 - T_{\\text{edge}}) \\left[1 - \\left(\\frac{r}{a}\\right)^{\\alpha_T}\\right]$$\n\n也提供了氖（$Z=\\text{Ne}$）和氩（$Z=\\text{Ar}$）的杂质辐射函数 $L_Z(T)$ 的解析形式，其中温度 $T$ 的单位是 $\\text{eV}$。\n\n由于被积函数的复杂性（该被积函数涉及径向相关项的幂函数和指数函数的乘积），$P_{\\text{rad, core}}(T_0)$ 的积分无法求得解析解。因此，需要采用数值方法。\n\n算法流程如下：\n1.  定义一组离散的中心温度 $T_0$ 进行评估，这些点跨越区间 $[T_{\\min}, T_{\\max}]$，共 $N_T$ 个点。这通过线性间距实现：$T_{0,i} = T_{\\min} + i \\cdot \\frac{T_{\\max} - T_{\\min}}{N_T - 1}$，其中 $i=0, 1, \\dots, N_T-1$。\n2.  对于扫描中的每个 $T_{0,i}$ 值：\n    a.  构建完整的被积函数，$I(r, T_{0,i}) = n_e(r)^2 \\, f_Z(r) \\, L_Z(1000 \\cdot T_e(r, T_{0,i})) \\, 4 \\pi^2 R_0 r$。\n    b.  将 $I(r, T_{0,i})$ 对小半径 $r$ 从 $0$ 到堆芯半径 $r_c = \\gamma a$ 进行数值积分。一个稳健的数值求积方法，如 `scipy.integrate.quad` 提供的，适合此任务。如果所有输入参数均为国际单位制（SI）单位，则此积分的结果是 $P_{\\text{rad, core}}(T_{0,i})$，单位为瓦特。\n3.  在计算出扫描中所有 $T_0$ 对应的 $P_{\\text{rad, core}}$ 值数组后，分析结果：\n    a.  找出堆芯辐射功率的最大值，$P_{\\text{pk}} = \\max(P_{\\text{rad, core}}(T_{0,i}))$。对应的中心温度是 $T_{\\text{pk}}$。功率单位必须从瓦特（W）转换为兆瓦（MW）（$1 \\, \\text{MW} = 10^6 \\, \\text{W}$）。\n    b.  确定热坍缩条件。如果 $P_{\\text{rad, core}}(T_0) \\ge \\beta P_{\\text{in}}$，则认为坍缩即将发生。对于给定的测试用例，阈值功率 $P_{\\text{threshold}} = \\beta P_{\\text{in}}$ 是一个常数。\n    c.  识别扫描中所有满足此坍缩判据的温度 $T_0$。要求的输出是这些温度中的最小值和最大值，记为 $T_{\\min}^{\\text{collapse}}$ 和 $T_{\\max}^{\\text{collapse}}$。如果扫描中没有温度满足该条件，则两个值都报告为 $0.0 \\, \\text{keV}$。\n\n将此过程系统地应用于问题陈述中提供的每个测试用例。最终输出是一个格式化的列表，总结了每个用例的结果（$T_{\\text{pk}}$, $P_{\\text{pk}}$, $T_{\\min}^{\\text{collapse}}$, $T_{\\max}^{\\text{collapse}}$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes core impurity radiation and assesses thermal collapse risk in a tokamak.\n    \"\"\"\n\n    # Test cases defined by the tuple:\n    # (species, R0, a, n0, sn, f_Z0, f_Z_edge, pf, T_edge, alpha_T, gamma, P_in, beta, T_min, T_max, N_T)\n    test_cases = [\n        (\"Ne\", 1.7, 0.5, 8.0e19, 1.0, 5.0e-3, 2.0e-3, 1.0, 0.1, 2.0, 0.3, 8.0e6, 0.3, 0.5, 5.0, 120),\n        (\"Ar\", 1.7, 0.5, 8.0e19, 1.0, 1.0e-3, 5.0e-4, 1.0, 0.5, 2.0, 0.3, 2.5e7, 0.3, 1.0, 10.0, 120),\n        (\"Ne\", 1.7, 0.5, 8.0e19, 1.0, 1.0e-2, 5.0e-3, 1.0, 0.1, 2.0, 0.3, 6.0e6, 0.3, 0.3, 3.0, 120),\n        (\"Ar\", 1.0, 0.4, 6.0e19, 1.0, 3.0e-3, 1.0e-3, 1.0, 0.2, 2.0, 0.3, 5.0e6, 0.3, 0.5, 5.0, 120),\n    ]\n\n    # Impurity radiation functions L_Z(T) in W.m^3, with T in eV.\n    def L_Ne(T_ev):\n        # A simple check to prevent math domain errors for T_ev = 0\n        if T_ev == 0:\n            return 0.0\n        term1 = 3.0e-31 * (T_ev / 150.0)**0.2 * np.exp(-T_ev / 250.0)\n        term2 = 1.0e-32 * (T_ev / 1000.0)**0.5 * np.exp(-T_ev / 5000.0)\n        return term1 + term2\n\n    def L_Ar(T_ev):\n        # A simple check to prevent math domain errors for T_ev = 0\n        if T_ev == 0:\n            return 0.0\n        term1 = 1.5e-31 * (T_ev / 1500.0)**0.4 * np.exp(-T_ev / 2200.0)\n        term2 = 3.0e-32 * (T_ev / 6000.0)**0.5 * np.exp(-T_ev / 8000.0)\n        return term1 + term2\n\n    L_Z_funcs = {\"Ne\": L_Ne, \"Ar\": L_Ar}\n    \n    all_results = []\n    \n    for case in test_cases:\n        species, R0, a, n0, sn, f_Z0, f_Z_edge, pf, T_edge, alpha_T, gamma, P_in, beta, T_min, T_max, N_T = case\n        \n        l_z_func = L_Z_funcs[species]\n        r_c = gamma * a\n        \n        # Define profile functions based on problem statement\n        def n_e(r):\n            return n0 * (1 - (r / a)**2)**sn\n\n        def f_z(r):\n            return f_Z_edge + (f_Z0 - f_Z_edge) * (1 - (r / a)**pf)\n\n        def T_e_kev(r, T0_kev):\n            return T_edge + (T0_kev - T_edge) * (1 - (r / a)**alpha_T)\n\n        # Define the integrand for numerical integration\n        def integrand(r, T0_kev):\n            t_e_val_kev = T_e_kev(r, T0_kev)\n            \n            # Radiation function expects temperature in eV\n            t_e_val_ev = 1000.0 * t_e_val_kev\n            \n            # The radiation functions L_Z are defined piecewise implicitly\n            if t_e_val_ev == 0:\n                l_z_val = 0.0\n            else:\n                l_z_val = l_z_func(t_e_val_ev)\n            \n            n_e_val = n_e(r)\n            f_z_val = f_z(r)\n            \n            # Power density p_rad = n_e^2 * f_Z * L_Z\n            p_rad = n_e_val**2 * f_z_val * l_z_val\n            \n            # Power in a volume element dV = 4 * pi^2 * R0 * r * dr\n            return p_rad * 4 * np.pi**2 * R0 * r\n\n        # Scan over the central temperature T0\n        T0_scan = np.linspace(T_min, T_max, N_T)\n        P_rad_core_scan = []\n\n        for T0 in T0_scan:\n            power_watts, _ = quad(integrand, 0, r_c, args=(T0,))\n            P_rad_core_scan.append(power_watts)\n        \n        P_rad_core_scan = np.array(P_rad_core_scan)\n        \n        # Analyze results\n        # Find peak radiated power and corresponding temperature\n        P_pk_watts = np.max(P_rad_core_scan)\n        P_pk_mw = P_pk_watts / 1e6\n        T_pk = T0_scan[np.argmax(P_rad_core_scan)]\n        \n        # Determine collapse interval\n        P_threshold_watts = beta * P_in\n        collapse_indices = np.where(P_rad_core_scan = P_threshold_watts)[0]\n        \n        if len(collapse_indices)  0:\n            T_min_collapse = T0_scan[collapse_indices[0]]\n            T_max_collapse = T0_scan[collapse_indices[-1]]\n        else:\n            T_min_collapse = 0.0\n            T_max_collapse = 0.0\n            \n        all_results.append([T_pk, P_pk_mw, T_min_collapse, T_max_collapse])\n\n    # Format output string\n    result_str = \",\".join(\n        f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f},{r[3]:.6f}]\" for r in all_results\n    )\n    \n    # Final print statement in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "一旦像撕裂模这样的MHD不稳定性形成，其旋转对于维持等离子体的稳定性至关重要。如果该模式停止旋转并“锁定”到某个静态磁场上，它可能会不受控制地增长，最终导致破坏。本练习深入探讨了这一锁定过程的物理机制，通过计算相关的电磁转矩，来确定如何优化施加外部磁场以控制该过程。",
            "id": "3708780",
            "problem": "考虑一个大环径比托卡马克，其中存在一个极向/环向模数为 $m/n$ 的单共振磁面，该磁面与一个静态内禀误差场和一个单螺旋度外部共振磁扰动 (Resonant Magnetic Perturbation, RMP) 相互作用。设由内禀误差在有理面上感应的复共振径向场为 $\\tilde{b}_{i} = b_{i} \\exp(i \\phi_{i})$，其中 $b_{i}  0$，$\\phi_{i}$ 为内禀场相位。外部 RMP 线圈产生一个真空场，其实振幅为 $b_{c}  0$，线圈相位为 $\\phi_{c}$。共振磁面处的线性等离子体响应由一个复传递函数 $H(\\omega_{0}) = |H| \\exp(i \\phi_{H})$ 建模，该函数在锁定前旋转频率 $\\omega_{0}$ 处取值，因此 RMP 对共振场的贡献为 $\\tilde{b}_{\\mathrm{RMP}} = H(\\omega_{0})\\, b_{c} \\exp(i \\phi_{c})$。因此，磁面上的总复共振场为 $\\tilde{b}_{r} = \\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}}$。\n\n设 $\\delta$ 表示撕裂层相对于固定参考系的螺旋相位，并假设撕裂层与共振场之间的电磁相互作用能可写作 $U(\\delta) = -K\\, \\mathrm{Re}\\left\\{\\tilde{b}_{r} \\exp(-i \\delta)\\right\\}$，其中正常数 $K$ 由撕裂层几何形状和电流通道决定。作用在撕裂层上的相应电磁力矩为 $T_{\\mathrm{EM}}(\\delta) = -\\partial U/\\partial \\delta$。背景旋转由一个恒定的驱动力矩 $T_{\\mathrm{rot}} = D \\,\\omega_{0}$ 维持，其中 $D  0$。如果电磁力矩在整个螺旋相位上的最大值能够平衡驱动力矩，即如果 $\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| \\ge T_{\\mathrm{rot}}$，则会发生穿透和锁定。\n\n(a) 从第一性原理和上述定义出发，推导相位相关的电磁力矩 $T_{\\mathrm{EM}}(\\delta)$，用 $b_{i}$、$\\phi_{i}$、$b_{c}$、$\\phi_{c}$、|H| 和 $\\phi_{H}$ 表示。\n\n(b) 通过施加锁定阈值条件 $\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| = T_{\\mathrm{rot}}$，将临界线圈振幅 $b_{c,\\mathrm{crit}}(\\phi_{c})$ 表示为线圈相位 $\\phi_{c}$ 以及参数 $b_{i}$、|H|、$K$、$D$ 和 $\\omega_{0}$ 的函数。您可以定义 $B_{c} \\equiv T_{\\mathrm{rot}}/K$ 以简化符号。\n\n(c) 确定使 $b_{c,\\mathrm{crit}}(\\phi_{c})$ 最小化的线圈相位 $\\phi_{\\mathrm{opt}}$，并仅用 $\\phi_{i}$ 和 $\\phi_{H}$ 给出 $\\phi_{\\mathrm{opt}}$ 的单个闭合形式表达式（以弧度为单位）。您最终方框内的答案必须只包含这个 $\\phi_{\\mathrm{opt}}$ 的表达式。",
            "solution": "该问题陈述经评估有效。它在科学上基于应用于托卡马克等离子体的磁流体动力学（MHD）原理，特别是磁岛锁定理论。该问题是良定的、客观的、自洽的，并且所有术语都有形式化定义。问题从推导到优化逻辑递进，并且在问题背景所隐含的合理物理推断下，存在唯一且有意义的解。\n\n(a) 电磁力矩 $T_{\\mathrm{EM}}(\\delta)$ 的推导。\n\n电磁相互作用能由 $U(\\delta) = -K\\, \\mathrm{Re}\\left\\{\\tilde{b}_{r} \\exp(-i \\delta)\\right\\}$ 给出，其中 $K$ 是一个正常数，$\\tilde{b}_{r}$ 是总复共振场，$\\delta$ 是撕裂层的螺旋相位。\n\n作用在撕裂层上的相应电磁力矩定义为 $T_{\\mathrm{EM}}(\\delta) = -\\partial U/\\partial \\delta$。\n设 $\\tilde{b}_{r} = |\\tilde{b}_{r}| \\exp(i \\phi_{r})$，其中 $|\\tilde{b}_{r}|$ 和 $\\phi_{r}$ 分别是总共振场的大小和相位。\n那么，能量可以写成：\n$$U(\\delta) = -K\\, \\mathrm{Re}\\left\\{|\\tilde{b}_{r}| \\exp(i \\phi_{r}) \\exp(-i \\delta)\\right\\} = -K |\\tilde{b}_{r}| \\mathrm{Re}\\left\\{\\exp(i (\\phi_{r} - \\delta))\\right\\}$$\n$$U(\\delta) = -K |\\tilde{b}_{r}| \\cos(\\phi_{r} - \\delta)$$\n对 $\\delta$ 求导以求得力矩：\n$$T_{\\mathrm{EM}}(\\delta) = -\\frac{\\partial}{\\partial \\delta} \\left[-K |\\tilde{b}_{r}| \\cos(\\phi_{r} - \\delta)\\right] = K |\\tilde{b}_{r}| \\frac{\\partial}{\\partial \\delta} \\cos(\\phi_{r} - \\delta)$$\n$$T_{\\mathrm{EM}}(\\delta) = K |\\tilde{b}_{r}| \\left[-\\sin(\\phi_{r} - \\delta) \\cdot (-1)\\right] = K |\\tilde{b}_{r}| \\sin(\\phi_{r} - \\delta)$$\n这可以用复指数的虚部来表示：\n$$T_{\\mathrm{EM}}(\\delta) = K |\\tilde{b}_{r}| \\mathrm{Im}\\left\\{\\exp(i(\\phi_{r} - \\delta))\\right\\} = K \\mathrm{Im}\\left\\{|\\tilde{b}_{r}|\\exp(i\\phi_{r}) \\exp(-i \\delta)\\right\\} = K \\mathrm{Im}\\left\\{\\tilde{b}_{r} \\exp(-i \\delta)\\right\\}$$\n现在，我们代入总场表达式 $\\tilde{b}_{r} = \\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}}$。\n内禀误差场为 $\\tilde{b}_{i} = b_{i} \\exp(i \\phi_{i})$。\nRMP 贡献为 $\\tilde{b}_{\\mathrm{RMP}} = H(\\omega_{0}) b_{c} \\exp(i \\phi_{c}) = |H| \\exp(i \\phi_{H}) b_{c} \\exp(i \\phi_{c}) = |H| b_{c} \\exp(i(\\phi_{c} + \\phi_{H}))$。\n因此，力矩变为：\n$$T_{\\mathrm{EM}}(\\delta) = K \\mathrm{Im}\\left\\{\\left(b_{i} \\exp(i \\phi_{i}) + |H| b_{c} \\exp(i(\\phi_{c} + \\phi_{H}))\\right) \\exp(-i \\delta)\\right\\}$$\n$$T_{\\mathrm{EM}}(\\delta) = K \\mathrm{Im}\\left\\{b_{i} \\exp(i(\\phi_{i} - \\delta)) + |H| b_{c} \\exp(i(\\phi_{c} + \\phi_{H} - \\delta))\\right\\}$$\n利用性质 $\\mathrm{Im}(z_1 + z_2) = \\mathrm{Im}(z_1) + \\mathrm{Im}(z_2)$，我们得到用给定参数表示的力矩最终表达式：\n$$T_{\\mathrm{EM}}(\\delta) = K \\left[b_{i} \\sin(\\phi_{i} - \\delta) + |H| b_{c} \\sin(\\phi_{c} + \\phi_{H} - \\delta)\\right]$$\n\n(b) 临界线圈振幅 $b_{c,\\mathrm{crit}}(\\phi_{c})$ 的推导。\n\n锁定阈值由条件 $\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| = T_{\\mathrm{rot}}$ 给出。\n从中间表达式 $T_{\\mathrm{EM}}(\\delta) = K |\\tilde{b}_{r}| \\sin(\\phi_{r} - \\delta)$ 可知，当 $|\\sin(\\phi_{r} - \\delta)| = 1$ 时，其绝对值达到最大。因此：\n$$\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| = K |\\tilde{b}_{r}|$$\n锁定条件变为 $K |\\tilde{b}_{r}| = T_{\\mathrm{rot}}$。使用给定的定义 $B_{c} \\equiv T_{\\mathrm{rot}}/K$，这简化为：\n$$|\\tilde{b}_{r}| = B_{c}$$\n我们需要从此方程中解出线圈振幅 $b_{c}$。让我们展开 $|\\tilde{b}_{r}|^2$：\n$$|\\tilde{b}_{r}|^2 = |\\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}}|^2 = (\\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}})(\\tilde{b}_{i}^* + \\tilde{b}_{\\mathrm{RMP}}^*)$$\n$$|\\tilde{b}_{r}|^2 = |\\tilde{b}_{i}|^2 + |\\tilde{b}_{\\mathrm{RMP}}|^2 + 2\\,\\mathrm{Re}\\{\\tilde{b}_{i} \\tilde{b}_{\\mathrm{RMP}}^*\\}$$\n代入定义：\n$|\\tilde{b}_{i}|^2 = b_{i}^2$\n$|\\tilde{b}_{\\mathrm{RMP}}|^2 = (|H| b_{c})^2$\n$\\tilde{b}_{i} \\tilde{b}_{\\mathrm{RMP}}^* = b_{i} \\exp(i\\phi_{i}) \\cdot |H| b_{c} \\exp(-i(\\phi_{c} + \\phi_{H})) = b_{i} |H| b_{c} \\exp(i(\\phi_{i} - \\phi_{c} - \\phi_{H}))$\n所以，$2\\,\\mathrm{Re}\\{\\tilde{b}_{i} \\tilde{b}_{\\mathrm{RMP}}^*\\} = 2 b_{i} |H| b_{c} \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c})$。\n锁定条件 $|\\tilde{b}_{r}|^2 = B_{c}^2$ 产生一个关于 $b_{c}$ 的二次方程：\n$$B_{c}^2 = b_{i}^2 + |H|^2 b_{c}^2 + 2 b_{i} |H| b_{c} \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c})$$\n$$|H|^2 b_{c}^2 + \\left(2 b_{i} |H| \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c})\\right) b_{c} + (b_{i}^2 - B_{c}^2) = 0$$\n用二次公式求解 $b_{c}$，并要求 $b_{c} > 0$ 以选择正根：\n$$b_{c,\\mathrm{crit}}(\\phi_{c}) = \\frac{-2 b_{i} |H| \\cos(\\theta) + \\sqrt{(2 b_{i} |H| \\cos(\\theta))^2 - 4 |H|^2 (b_{i}^2 - B_{c}^2)}}{2|H|^2}$$\n其中 $\\theta = \\phi_{i} - \\phi_{H} - \\phi_{c}$。\n$$b_{c,\\mathrm{crit}}(\\phi_{c}) = \\frac{-b_{i} \\cos(\\theta) + \\sqrt{b_{i}^2 \\cos^2(\\theta) - (b_{i}^2 - B_{c}^2)}}{|H|}$$\n$$b_{c,\\mathrm{crit}}(\\phi_{c}) = \\frac{-b_{i} \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c}) + \\sqrt{B_{c}^2 - b_{i}^2 \\sin^2(\\phi_{i} - \\phi_{H} - \\phi_{c})}}{|H|}$$\n\n(c) 最佳线圈相位 $\\phi_{\\mathrm{opt}}$ 的确定。\n\n目标是找到使所需线圈振幅 $b_{c,\\mathrm{crit}}$ 最小化的线圈相位 $\\phi_{c}$。这是一个几何优化问题。我们寻求通过将 RMP 感应场 $\\tilde{b}_{\\mathrm{RMP}}$ 加到内禀场 $\\tilde{b}_{i}$ 上，使总共振场 $\\tilde{b}_{r}$ 的大小达到 $B_{c}$，同时使用最小可能的 RMP 振幅，这意味着最小化 $|\\tilde{b}_{\\mathrm{RMP}}|=|H| b_{c}$。\n矢量关系为 $\\tilde{b}_{\\mathrm{RMP}} = \\tilde{b}_{r} - \\tilde{b}_{i}$。我们希望最小化 $|\\tilde{b}_{\\mathrm{RMP}}|$。\n在这里，$\\tilde{b}_{i}$ 是复平面中的一个固定矢量，而 $\\tilde{b}_{r}$ 可以是任何其尖端位于以原点为中心、半径为 $B_{c}$ 的圆上的矢量。我们想找到这个圆上离矢量 $\\tilde{b}_{i}$ 尖端最近的点。\n点与圆之间的最小距离出现在连接该点与圆心的直线上。因此， $|\\tilde{b}_{r} - \\tilde{b}_{i}|$ 的最小值为 $||\\tilde{b}_{r}| - |\\tilde{b}_{i}|| = |B_{c} - b_{i}|$。\n当 $\\tilde{b}_{r}$ 和 $\\tilde{b}_{i}$ 共线时，达到这个最小值。所需的 $\\tilde{b}_{\\mathrm{RMP}}$ 矢量的相位决定了最佳线圈相位。\n\n问题陈述中提到等离子体有一个锁定前的旋转频率 $\\omega_{0}$。这意味着内禀误差场 $\\tilde{b}_{i}$ 本身不足以引起模式锁定。仅由内禀场产生的最大力矩是 $K|\\tilde{b}_{i}| = K b_{i}$。为使模式保持未锁定状态，该力矩必须小于驱动力矩 $T_{\\mathrm{rot}}$。\n$$K b_{i}  T_{\\mathrm{rot}}$$\n使用定义 $B_{c} = T_{\\mathrm{rot}}/K$，这意味着：\n$$K b_{i}  K B_{c} \\implies b_{i}  B_{c}$$\n这个物理约束是至关重要的。由于 $b_{i}  B_{c}$，内禀场的大小小于锁定的目标大小。为了最小化施加场振幅 $|\\tilde{b}_{\\mathrm{RMP}}|$，我们必须施加一个“相长”的场，即与内禀误差场对齐，以便最有效地增加总场的大小。\n所需的最小 $|\\tilde{b}_{\\mathrm{RMP}}|$ 为 $|B_{c} - b_{i}| = B_{c} - b_{i}$。这在 $\\tilde{b}_{r}$ 和 $\\tilde{b}_{i}$ 共线且指向相同方向时发生。\n在这种最佳情况下，$\\tilde{b}_{\\mathrm{RMP}} = \\tilde{b}_{r} - \\tilde{b}_{i}$ 的相位必须与 $\\tildeb_{i}$ 的相位相同。\n$$\\mathrm{phase}(\\tilde{b}_{\\mathrm{RMP}}) = \\mathrm{phase}(\\tilde{b}_{i})$$\nRMP 贡献的相位由 $\\phi_{c} + \\phi_{H}$ 给出，内禀场的相位是 $\\phi_{i}$。对于最佳设置，$\\phi_{c} = \\phi_{\\mathrm{opt}}$：\n$$\\phi_{\\mathrm{opt}} + \\phi_{H} = \\phi_{i}$$\n求解最佳线圈相位，得到最终答案：\n$$\\phi_{\\mathrm{opt}} = \\phi_{i} - \\phi_{H}$$\n这对应于误差场*放大*，其中施加的 RMP 的相位被设置为匹配等离子体对内禀误差场本身放大后的响应相位，从而加强它以越过锁定阈值。",
            "answer": "$$\n\\boxed{\\phi_i - \\phi_H}\n$$"
        }
    ]
}