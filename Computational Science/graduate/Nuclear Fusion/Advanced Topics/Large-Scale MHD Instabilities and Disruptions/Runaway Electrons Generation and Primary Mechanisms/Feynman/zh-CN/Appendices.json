{
    "hands_on_practices": [
        {
            "introduction": "逃逸电子的产生源于一个基本概念：当电场的加速作用超过等离子体中碰撞产生的阻力时，电子将持续获得能量。本练习旨在通过推导相对论性碰撞阻力并计算特定电场下的“临界动量”，来巩固对这一力平衡条件的理解。这是一个理解逃逸阈值的基本计算，为更复杂的模型奠定了基础。",
            "id": "3717557",
            "problem": "考虑一种与磁约束核聚变相关的均匀、完全电离的等离子体，其电子数密度为 $n_{e}$，有效离子电荷为 $Z_{\\mathrm{eff}}$，库仑对数（库仑碰撞中最大与最小碰撞参数之比的自然对数，记为 $\\ln\\Lambda$）。一个测试电子与背景电子发生小角度二元库仑碰撞，从而产生相对论性平行阻力。从标准的减速模型出发，其中碰撞减速频率的标度关系为 $\\nu_{s}\\propto n_{e}e^{4}\\ln\\Lambda/\\left(4\\pi\\epsilon_{0}^{2}m_{e}^{2}v^{3}\\right)$，并利用 $F_{\\parallel}^{\\mathrm{coll}}(v)=m_{e}v\\,\\nu_{s}$，推导速度为 $v$ 的相对论性测试电子所受的、依赖于动量的平行碰撞阻力 $F_{\\parallel}^{\\mathrm{coll}}(v)$，并用 $v\\rightarrow c$ 时的渐近平衡来表示。将 Connor–Hastie 临界电场 $E_{c}$ 定义为这样一个恒定的平行电场，在该电场下，电场力 $eE_{c}$ 等于渐近（$v\\rightarrow c$）碰撞阻力。然后，对于给定的平行电场 $E_{\\parallel}$，通过力平衡条件 $eE_{\\parallel}=F_{\\parallel}^{\\mathrm{coll}}(p_{c})$ 来定义临界动量 $p_{c}$。\n\n假设辐射反作用力（例如，同步辐射和韧致辐射）可以忽略不计，并且能量阻力主要由电子-电子碰撞主导。对于 $E_{\\parallel}=2E_{c}$ 的特定情况，计算 $p_{c}$，并以国际单位制 (SI) $\\mathrm{kg\\,m\\,s^{-1}}$ 表示其最终数值，四舍五入到四位有效数字。最后，在所采用的模型框架内，讨论 $p_{c}$ 对 $Z_{\\mathrm{eff}}$ 和 $\\ln\\Lambda$ 变化的敏感性。",
            "solution": "该问题要求推导相对论性平行碰撞阻力，计算在特定电场下的临界动量 $p_c$，并讨论结果对等离子体参数的敏感性。\n\n首先，我们验证问题陈述的有效性。\n已知条件是：一个均匀、完全电离的等离子体，其电子数密度为 $n_e$，有效离子电荷为 $Z_{\\mathrm{eff}}$，库仑对数为 $\\ln\\Lambda$。给定的非相对论性碰撞减速频率的标度关系为 $\\nu_{s}\\propto n_{e}e^{4}\\ln\\Lambda/\\left(4\\pi\\epsilon_{0}^{2}m_{e}^{2}v^{3}\\right)$，相关的阻力为 $F_{\\parallel}^{\\mathrm{coll}}(v)=m_{e}v\\,\\nu_{s}$。Connor-Hastie 临界电场 $E_c$ 由电场力 $eE_c$ 与 $v\\rightarrow c$ 时的渐近碰撞阻力之间的平衡来定义。对于给定的平行电场 $E_{\\parallel}$，临界动量 $p_c$ 由力平衡条件 $eE_{\\parallel}=F_{\\parallel}^{\\mathrm{coll}}(p_{c})$ 定义。辐射效应被认为可以忽略。需要分析的具体情况是 $E_{\\parallel}=2E_{c}$。\n\n该问题在科学上基于聚变等离子体中碰撞输运和逃逸电子动力学的既定理论。该问题是适定的，因为定义精确，并且计算数值答案所需的参数会相互抵消，使其自洽。语言是客观的，并且所做的假设在此背景下是标准的简化。因此，该问题被认为是有效的。\n\n我们首先将平行碰撞阻力 $F_{\\parallel}^{\\mathrm{coll}}$ 形式化。问题给出了非相对论性标度关系 $\\nu_{s} \\propto v^{-3}$，这导致力 $F_{\\parallel}^{\\mathrm{coll}} \\propto v^{-2}$。这可作为低能极限。对于一个动量为 $p$、洛伦兹因子为 $\\gamma = \\sqrt{1 + p^2/(m_e^2 c^2)}$ 的测试电子，在含有背景电子和离子的等离子体中所受平行碰撞阻力大小的正确相对论推广，由福克-普朗克碰撞算子的适当极限给出：\n$$\n|F_{\\parallel}^{\\mathrm{coll}}(p)| = \\frac{n_{e}e^{4}\\ln\\Lambda}{4\\pi\\epsilon_{0}^{2}m_{e}c^{2}} (1+Z_{\\mathrm{eff}}) \\frac{\\gamma^2}{\\gamma^2-1}\n$$\n在这里，括号 $(1+Z_{\\mathrm{eff}})$ 内与 $1$ 成正比的项代表与背景电子的碰撞，与 $Z_{\\mathrm{eff}}$ 成正比的项代表与背景离子的碰撞。\n\n第一个任务是用 $v \\rightarrow c$ 时的渐近值来表示这个力。当 $v \\rightarrow c$ 时，动量 $p \\rightarrow \\infty$，洛伦兹因子 $\\gamma \\rightarrow \\infty$。在此极限下，项 $\\gamma^2/(\\gamma^2-1)$ 趋近于 $1$。因此，我们记为 $F_{\\mathrm{asym}}$ 的渐近阻力为：\n$$\nF_{\\mathrm{asym}} = \\lim_{p\\to\\infty} |F_{\\parallel}^{\\mathrm{coll}}(p)| = \\frac{n_{e}e^{4}\\ln\\Lambda}{4\\pi\\epsilon_{0}^{2}m_{e}c^{2}} (1+Z_{\\mathrm{eff}})\n$$\n现在，我们可以用 $F_{\\mathrm{asym}}$ 来表示依赖于动量的阻力。使用相对论关系式 $p^2 = (\\gamma^2 - 1)m_e^2 c^2$，我们可以用动量 $p$ 来表示因子 $\\gamma^2/(\\gamma^2-1)$：\n$$\n\\frac{\\gamma^2}{\\gamma^2-1} = \\frac{1 + p^2/(m_e^2 c^2)}{p^2/(m_e^2 c^2)} = 1 + \\frac{m_e^2 c^2}{p^2}\n$$\n将此代回阻力的表达式，我们得到所需的形式：\n$$\n|F_{\\parallel}^{\\mathrm{coll}}(p)| = F_{\\mathrm{asym}} \\left(1 + \\frac{m_e^2 c^2}{p^2}\\right)\n$$\n该表达式显示了阻力如何从 $p=0$ 时的无穷大值，随着 $p \\rightarrow \\infty$ 而减小，并趋向于其恒定的渐近值 $F_{\\mathrm{asym}}$。\n\n接下来，我们使用问题中对临界电场 $E_c$ 的定义。它由电场力 $eE_c$ 与渐近碰撞阻力平衡的条件定义：\n$$\neE_c = F_{\\mathrm{asym}}\n$$\n问题接着要求在施加的平行电场为 $E_{\\parallel} = 2E_c$ 时，求出临界动量 $p_c$。临界动量 $p_c$ 由加速电场和碰撞阻力之间的力平衡确定：\n$$\neE_{\\parallel} = |F_{\\parallel}^{\\mathrm{coll}}(p_c)|\n$$\n将 $E_{\\parallel} = 2E_c$ 代入平衡方程：\n$$\ne(2E_c) = |F_{\\parallel}^{\\mathrm{coll}}(p_c)|\n$$\n现在我们将 $|F_{\\parallel}^{\\mathrm{coll}}(p_c)|$ 替换为其用 $F_{\\mathrm{asym}}$ 和 $p_c$ 表示的推导表达式：\n$$\n2(eE_c) = F_{\\mathrm{asym}} \\left(1 + \\frac{m_e^2 c^2}{p_c^2}\\right)\n$$\n使用定义 $eE_c = F_{\\mathrm{asym}}$，方程显著简化：\n$$\n2F_{\\mathrm{asym}} = F_{\\mathrm{asym}} \\left(1 + \\frac{m_e^2 c^2}{p_c^2}\\right)\n$$\n由于 $F_{\\mathrm{asym}}$ 不为零，我们可以将其从等式两边除掉：\n$$\n2 = 1 + \\frac{m_e^2 c^2}{p_c^2}\n$$\n求解 $p_c$：\n$$\n1 = \\frac{m_e^2 c^2}{p_c^2} \\implies p_c^2 = m_e^2 c^2 \\implies p_c = m_e c\n$$\n临界动量就是电子静止质量与光速的乘积。\n\n为了求出数值，我们使用 CODATA 推荐的电子静止质量值，$m_e = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$，以及真空中的光速值，$c = 299792458\\,\\mathrm{m\\,s^{-1}}$。\n$$\np_c = (9.1093837 \\times 10^{-31}\\,\\mathrm{kg}) \\times (299792458\\,\\mathrm{m\\,s^{-1}}) \\approx 2.7309245 \\times 10^{-22}\\,\\mathrm{kg\\,m\\,s^{-1}}\n$$\n按要求四舍五入到四位有效数字：\n$$\np_c \\approx 2.731 \\times 10^{-22}\\,\\mathrm{kg\\,m\\,s^{-1}}\n$$\n\n最后，我们讨论 $p_c$ 对 $Z_{\\mathrm{eff}}$ 和 $\\ln\\Lambda$ 变化的敏感性。在我们的推导中，确定 $p_c$ 的方程是 $2 = 1 + m_e^2 c^2 / p_c^2$。表征等离子体的参数——$n_e$，$Z_{\\mathrm{eff}}$ 和 $\\ln\\Lambda$——都包含在 $F_{\\mathrm{asym}}$ 这一项中。因为 $F_{\\mathrm{asym}}$ 作为公因子出现在力平衡方程的两边，所以它被消掉了。因此，$p_c = m_e c$ 的值完全独立于 $n_e$，$Z_{\\mathrm{eff}}$ 和 $\\ln\\Lambda$。在所采用的模型中，$p_c$ 对 $Z_{\\mathrm{eff}}$ 和 $\\ln\\Lambda$ 变化的敏感度恰好为零。这是将临界动量相对于渐近阻力来定义的结果，而渐近阻力本身也由相同的等离子体参数来定标。",
            "answer": "$$\\boxed{2.731 \\times 10^{-22}}$$"
        },
        {
            "introduction": "一旦存在初始逃逸电子，它们可以通过“雪崩”机制指数级增长，形成大规模的逃逸电子束。然而，这种增长会受到输运过程的抑制，后者会将电子带出等离子体核心。本练习模拟了这种增长与损失之间的竞争，要求学生计算抑制雪崩增长所需的临界扩散系数，从而将动力学理论（$ \\Gamma_{\\mathrm{av}} $）与宏观输运和等离子体稳定性联系起来。",
            "id": "3717558",
            "problem": "一个大环径比、圆形截面的轴对称等离子体柱，其小半径为 $a$，经历了一次破裂驱动的热猝灭，产生了一个均匀的环向电场。在猝灭后阶段，逃逸电子数密度 $n_{\\mathrm{RE}}(r,t)$ 在雪崩倍增和跨场湍流扩散的共同作用下演化。假设如下：\n\n- 雪崩源在空间上是均匀的，具有恒定的指数增长率 $\\Gamma_{\\mathrm{av}}$，因此在没有损失的情况下，$n_{\\mathrm{RE}} \\propto \\exp(\\Gamma_{\\mathrm{av}} t)$。\n- 跨场输运可以建模为普通扩散，其扩散系数 $D$ 恒定且空间均匀，径向扩散通量由菲克定律给出。\n- 等离子体占据一个柱形区域 $0 \\le r \\le a$，在 $r=a$ 处对逃逸电子有吸收边界（理想化的完美导电壁），并在 $r=0$ 处满足正则性条件。\n- 逃逸电子群足够稀疏，以至于不会改变背景场（线性区）。\n\n从粒子连续性方程和菲克定律出发，推导扩散系数 $D$ 需要满足的条件，以防止形成约束的逃逸束。该条件可解释为要求 $n_{\\mathrm{RE}}$ 的主导空间模式不随时间增长。利用以下事实：在柱体内，对于在 $r=a$ 处具有狄利克雷边界条件的拉普拉斯算子，其最慢衰减的本征模式的径向结构由贝塞尔函数 $J_0$ 给出，并满足 $J_0(k a)=0$，其中最小正根为 $k a = j_{0,1}$，且 $j_{0,1} \\approx 2.404825558$。\n\n对于一个小半径 $a = 0.60\\,\\mathrm{m}$、推断的猝灭后雪崩增长率 $\\Gamma_{\\mathrm{av}} = 3.20 \\times 10^{2}\\,\\mathrm{s^{-1}}$ 的装置，计算恰好抑制主导模式净增长的最小扩散系数 $D_{\\mathrm{crit}}$。将你的答案四舍五入到四位有效数字，并以 $\\mathrm{m^{2}\\,s^{-1}}$ 为单位表示。",
            "solution": "## 问题验证\n\n### 第1步：提取已知条件\n- 几何形状：大环径比、圆形截面的轴对称等离子体柱。\n- 小半径：$a$。\n- 环向电场：均匀，由破裂驱动的热猝灭产生。\n- 逃逸电子数密度：$n_{\\mathrm{RE}}(r,t)$。\n- 雪崩源：空间均匀，具有恒定的指数增长率 $\\Gamma_{\\mathrm{av}}$。在没有损失的情况下，$n_{\\mathrm{RE}} \\propto \\exp(\\Gamma_{\\mathrm{av}} t)$。\n- 输运模型：跨场普通扩散，扩散系数 $D$ 恒定且空间均匀。\n- 径向扩散通量：菲克定律。\n- 区域：柱形，$0 \\le r \\le a$。\n- 边界条件：\n    - 在 $r=a$ 处的吸收边界：$n_{\\mathrm{RE}}(a,t) = 0$。\n    - 在 $r=0$ 处的正则性条件。\n- 区域：线性区，逃逸电子群不改变背景场。\n- 目标：推导扩散系数 $D$ 需满足的条件，以防止 $n_{\\mathrm{RE}}$ 的主导空间模式增长。\n- 提供的数学事实：在柱体内，对于在 $r=a$ 处具有狄利克雷边界条件的拉普拉斯算子，其最慢衰减的本征模式具有径向结构 $J_0(kr)$，其中 $J_0(ka)=0$，且最小正根为 $ka = j_{0,1} \\approx 2.404825558$。\n- 数值：\n    - $a = 0.60\\,\\mathrm{m}$\n    - $\\Gamma_{\\mathrm{av}} = 3.20 \\times 10^{2}\\,\\mathrm{s^{-1}}$\n    - $j_{0,1} \\approx 2.404825558$\n- 要求输出：最小扩散系数 $D_{\\mathrm{crit}}$，单位为 $\\mathrm{m^{2}\\,s^{-1}}$，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据。其物理模型是一个反应-扩散方程，这是一个标准且成熟的框架，用于描述粒子密度在局域源（反应）和空间输运（扩散）影响下的演化。该模型常用于等离子体物理学中，以研究托卡马克中的逃逸电子动力学。在一个简化的柱形几何中，假设雪崩率 $\\Gamma_{\\mathrm{av}}$ 和扩散系数 $D$ 均匀，是创建易于处理的解析模型的标准近似方法。\n\n该问题是适定的。它提供了一个明确定义的偏微分方程、区域和边界条件。目标是找到系统主导本征模式的稳定性阈值，这是线性偏微分方程分析中的一个标准程序。所有必要的参数和常数均已提供。\n\n该问题是客观的。其语言精确，没有主观或基于观点的陈述。给定的数值对于一个中型托卡马克在破裂后的情况是物理上合理的。\n\n该问题是可形式化的，并且与逃逸电子产生这一指定主题相关。它不包含说明中列出的任何使其无效的缺陷。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n## 解答\n\n逃逸电子数密度 $n_{\\mathrm{RE}}(r,t)$ 的演化由粒子连续性方程决定：\n$$ \\frac{\\partial n_{\\mathrm{RE}}}{\\partial t} + \\nabla \\cdot \\mathbf{\\Gamma} = S $$\n其中 $S$ 是源项，$\\mathbf{\\Gamma}$ 是粒子通量。\n\n源项来自雪崩倍增，该过程具有恒定的指数增长率 $\\Gamma_{\\mathrm{av}}$。这意味着源项与局域密度成正比：\n$$ S = \\Gamma_{\\mathrm{av}} n_{\\mathrm{RE}}(r,t) $$\n\n粒子通量 $\\mathbf{\\Gamma}$ 是由跨场湍流扩散引起的，并由菲克定律描述，其中扩散系数 $D$ 为常数：\n$$ \\mathbf{\\Gamma} = -D \\nabla n_{\\mathrm{RE}}(r,t) $$\n\n将源项和通量代入连续性方程，我们得到控制逃逸电子密度的偏微分方程（PDE）：\n$$ \\frac{\\partial n_{\\mathrm{RE}}}{\\partial t} + \\nabla \\cdot (-D \\nabla n_{\\mathrm{RE}}) = \\Gamma_{\\mathrm{av}} n_{\\mathrm{RE}} $$\n由于 $D$ 是常数，方程简化为反应-扩散方程：\n$$ \\frac{\\partial n_{\\mathrm{RE}}}{\\partial t} = D \\nabla^2 n_{\\mathrm{RE}} + \\Gamma_{\\mathrm{av}} n_{\\mathrm{RE}} $$\n\n对于沿柱轴性质均匀的轴对称系统，在柱坐标 $(r, \\phi, z)$ 中，拉普拉斯算子 $\\nabla^2$ 只依赖于径向坐标 $r$：\n$$ \\nabla^2 = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left(r \\frac{\\partial}{\\partial r}\\right) $$\n该偏微分方程变为：\n$$ \\frac{\\partial n_{\\mathrm{RE}}(r,t)}{\\partial t} = D \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial n_{\\mathrm{RE}}(r,t)}{\\partial r} \\right) \\right] + \\Gamma_{\\mathrm{av}} n_{\\mathrm{RE}}(r,t) $$\n\n我们使用分离变量法求解这个线性偏微分方程。设 $n_{\\mathrm{RE}}(r,t) = R(r)T(t)$。将其代入偏微分方程得到：\n$$ R(r) \\frac{dT(t)}{dt} = D T(t) \\left[ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dR(r)}{dr} \\right) \\right] + \\Gamma_{\\mathrm{av}} R(r) T(t) $$\n两边同除以 $n_{\\mathrm{RE}}(r,t) = R(r)T(t)$ 以分离变量：\n$$ \\frac{1}{T(t)}\\frac{dT(t)}{dt} = \\frac{D}{R(r)} \\left[ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dR(r)}{dr} \\right) \\right] + \\Gamma_{\\mathrm{av}} $$\n由于方程左边只依赖于 $t$，右边只依赖于 $r$，因此两边都必须等于一个常数，我们记为 $\\gamma$。这个常数 $\\gamma$ 代表该模式的净增长率。\n\n时间方程为：\n$$ \\frac{1}{T(t)}\\frac{dT(t)}{dt} = \\gamma \\implies T(t) = T(0) \\exp(\\gamma t) $$\n\n空间方程为：\n$$ \\frac{D}{R(r)} \\left[ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dR(r)}{dr} \\right) \\right] + \\Gamma_{\\mathrm{av}} = \\gamma $$\n重新整理后得到一个标准的斯特姆-刘维尔问题：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dR}{dr} \\right) + \\frac{\\Gamma_{\\mathrm{av}} - \\gamma}{D} R = 0 $$\n我们定义常数 $k^2 = \\frac{\\Gamma_{\\mathrm{av}} - \\gamma}{D}$。空间方程变为：\n$$ \\frac{d^2 R}{dr^2} + \\frac{1}{r} \\frac{dR}{dr} + k^2 R = 0 $$\n这是0阶贝塞尔微分方程。其通解是第一类贝塞尔函数 $J_0(kr)$ 和第二类贝塞尔函数 $Y_0(kr)$ 的线性组合。\n\n我们应用边界条件来寻找物理上可接受的解。\n1. 在等离子体中心 $r=0$ 处的正则性条件要求解是有限的。由于当 $x \\to 0$ 时 $Y_0(x) \\to -\\infty$，因此其系数必须为零。所以，径向解必须具有以下形式：\n$$ R(r) = C J_0(kr) $$\n其中 $C$ 是一个常数。\n2. 在等离子体边缘 $r=a$ 处的吸收边界条件要求 $n_{\\mathrm{RE}}(a,t) = 0$，这意味着 $R(a)=0$。对于一个非平凡解（$C \\neq 0$），这意味着：\n$$ J_0(ka) = 0 $$\n这个条件量化了 $k$ 的可能取值。允许值（记为 $k_n$）由 $J_0$ 贝塞尔函数的正根（记为 $j_{0,n}$）确定。\n$$ k_n a = j_{0,n} \\implies k_n = \\frac{j_{0,n}}{a} \\quad \\text{for } n = 1, 2, 3, \\ldots $$\n\n每个值 $k_n$ 对应一个空间本征模式 $R_n(r) = C_n J_0(k_n r)$，及其相应的增长率 $\\gamma_n$。根据 $k^2$ 的定义，我们可以解出 $\\gamma_n$：\n$$ k_n^2 = \\frac{\\Gamma_{\\mathrm{av}} - \\gamma_n}{D} \\implies \\gamma_n = \\Gamma_{\\mathrm{av}} - D k_n^2 $$\n代入 $k_n$ 的表达式：\n$$ \\gamma_n = \\Gamma_{\\mathrm{av}} - D \\left(\\frac{j_{0,n}}{a}\\right)^2 $$\n\n完整解是所有这些本征模式的叠加：\n$$ n_{\\mathrm{RE}}(r,t) = \\sum_{n=1}^{\\infty} C_n J_0\\left(\\frac{j_{0,n} r}{a}\\right) \\exp(\\gamma_n t) $$\n解的长期行为由具有最大（最不负）增长率 $\\gamma_n$ 的模式主导。根 $j_{0,n}$ 构成一个递增序列：$j_{0,1}  j_{0,2}  j_{0,3}  \\ldots$。增长率 $\\gamma_n$ 是 $j_{0,n}$ 的递减函数。因此，最大的增长率对应于最小的根 $j_{0,1}$。这就是问题中提到的“主导空间模式”。其增长率为：\n$$ \\gamma_1 = \\Gamma_{\\mathrm{av}} - D \\left(\\frac{j_{0,1}}{a}\\right)^2 $$\n\n为防止形成约束的逃逸束，必须抑制该主导模式的净增长，即其数量不应随时间增长。这要求其增长率为非正：\n$$ \\gamma_1 \\le 0 $$\n$$ \\Gamma_{\\mathrm{av}} - D \\left(\\frac{j_{0,1}}{a}\\right)^2 \\le 0 $$\n解出扩散系数 $D$ 得到抑制条件：\n$$ D \\ge \\Gamma_{\\mathrm{av}} \\left(\\frac{a}{j_{0,1}}\\right)^2 $$\n\n恰好抑制增长的最小扩散系数 $D_{\\mathrm{crit}}$ 对应于等号成立的情况，此时主导模式的增长率恰好为零（$\\gamma_1=0$）：\n$$ D_{\\mathrm{crit}} = \\Gamma_{\\mathrm{av}} \\left(\\frac{a}{j_{0,1}}\\right)^2 $$\n\n现在，我们代入提供的数值：\n$a = 0.60\\,\\mathrm{m}$\n$\\Gamma_{\\mathrm{av}} = 3.20 \\times 10^{2}\\,\\mathrm{s^{-1}}$\n$j_{0,1} = 2.404825558$\n\n$$ D_{\\mathrm{crit}} = (3.20 \\times 10^{2}\\,\\mathrm{s}^{-1}) \\left(\\frac{0.60\\,\\mathrm{m}}{2.404825558}\\right)^2 $$\n$$ D_{\\mathrm{crit}} \\approx (3.20 \\times 10^{2}) \\times (0.24949503)^2 \\,\\mathrm{m^2\\,s^{-1}} $$\n$$ D_{\\mathrm{crit}} \\approx (3.20 \\times 10^{2}) \\times (0.062247766) \\,\\mathrm{m^2\\,s^{-1}} $$\n$$ D_{\\mathrm{crit}} \\approx 19.919285 \\,\\mathrm{m^2\\,s^{-1}} $$\n\n按要求将结果四舍五入到四位有效数字：\n$$ D_{\\mathrm{crit}} = 19.92\\,\\mathrm{m^2\\,s^{-1}} $$",
            "answer": "$$\n\\boxed{19.92}\n$$"
        },
        {
            "introduction": "在真实的托卡马克破裂过程中，电场并非恒定不变，而是随着等离子体总电流和电阻的演化而动态变化。本练习将引导学生进入一个更高级的自洽模型，通过编写程序将逃逸电子动力学与等离子体的 $L-R$ 电路模型耦合起来。这个实践展示了逃逸电子的演化如何与等离子体的电磁响应紧密耦合，这是现代破裂建模中的一个核心问题。",
            "id": "3717577",
            "problem": "您必须设计并实现一个自洽的时间积分方案，该方案将逃逸电子电流的简化动理学模型与等离子体的集总参数电感-电阻 ($L\\!-\\!R$) 电路模型耦合，以计算类破裂瞬态期间的平行电场 $E_{\\parallel}(t)$。该建模必须基于以下基本原理构建，不得调用任何预设了所需结果的捷径公式。\n\n基本原理与定义：\n- 麦克斯韦-法拉第定律（积分形式）：电场 $E_{\\parallel}$ 沿等离子体环路的环路积分与磁通量的变化率及任何施加的变压器驱动相关。在集总参数表示中，这导出了当总等离子体电流 $I_{\\mathrm{tot}}(t)$ 由自感 $L$ 和随时间变化的有效热阻 $R_{\\mathrm{th}}(t)$ 表示时，所遵循的标准 $L\\!-\\!R$ 电路方程。\n- 总等离子体电流分解：$I_{\\mathrm{tot}}(t) = I_{\\mathrm{th}}(t) + I_{\\mathrm{re}}(t)$，其中 $I_{\\mathrm{th}}(t)$ 是碰撞热电子电流，$I_{\\mathrm{re}}(t)$ 是逃逸电子电流。\n- 带有变压器驱动 $V_{\\mathrm{tr}}(t)$ 的电路动力学：\n  $$ L \\, \\frac{d I_{\\mathrm{tot}}}{d t} + R_{\\mathrm{th}}(t) \\, I_{\\mathrm{th}}(t) = V_{\\mathrm{tr}}(t). $$\n- 主体（碰撞）电子感受到的平行电场的定义：\n  $$ E_{\\parallel}(t) = \\frac{R_{\\mathrm{th}}(t)}{\\ell} \\, I_{\\mathrm{th}}(t), $$\n  其中 $\\ell$ 是计算平行电场的有效环向环路长度，对于此零维模型，假定该电场是空间均匀的。\n- 简化动理学逃逸电子电流模型（福克-普朗克图像的零阶矩闭合）：逃逸电子电流根据一个由平行电场驱动的源-增长模型演化，\n  $$ \\frac{d I_{\\mathrm{re}}}{d t} = \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}\\right) \\, I_{\\mathrm{re}} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}\\right), $$\n  其中雪崩增长率建模为\n  $$ \\gamma_{\\mathrm{ava}}(E_{\\parallel}) = \\frac{1}{\\tau_{\\mathrm{ava}}} \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right), $$\n  而初级（种子）源建模为\n  $$ S_{\\mathrm{pri}}(E_{\\parallel}) = S_0 \\, \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right). $$\n  此处 $E_{\\mathrm{c}}$ 是临界电场，$\\tau_{\\mathrm{ava}}$ 和 $S_0$ 是模型参数。\n\n设计一个在 $t \\in [0, T_{\\text{end}}]$ 上的数值稳定、自洽的时间步进方案，该方案能同时更新 $I_{\\mathrm{re}}$、$I_{\\mathrm{tot}}$ 和 $E_{\\parallel}$。您的方案必须：\n- 在每一步中使用电路方程隐式更新 $I_{\\mathrm{tot}}$，以避免 $L\\!-\\!R$ 项带来的刚性问题，同时在该步中使用最新更新的 $I_{\\mathrm{re}}$。\n- 在同一时间步内，使用前一个子步的平行电场，通过动理学方程更新 $I_{\\mathrm{re}}$，以保持因果性和单调稳定性。\n- 在每个子步中，通过计算 $I_{\\mathrm{th}} = I_{\\mathrm{tot}} - I_{\\mathrm{re}}$，然后计算 $E_{\\parallel} = \\left(R_{\\mathrm{th}}/\\ell\\right) I_{\\mathrm{th}}$ 来闭合系统，并将结果反馈回动理学计算。\n\n因此，从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个时间步必须按以下顺序进行：\n1. 计算 $E_{\\parallel}^{(n)} = \\left(R_{\\mathrm{th}}^{(n)}/\\ell \\right) \\left(I_{\\mathrm{tot}}^{(n)} - I_{\\mathrm{re}}^{(n)}\\right)$。\n2. 使用 $E_{\\parallel}^{(n)}$ 显式更新 $I_{\\mathrm{re}}$：\n   $$ I_{\\mathrm{re}}^{(n+1)} = I_{\\mathrm{re}}^{(n)} + \\Delta t \\left[ \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}^{(n)}\\right) I_{\\mathrm{re}}^{(n)} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}^{(n)}\\right) \\right]. $$\n3. 使用后向欧拉法对电路进行隐式更新 $I_{\\mathrm{tot}}$：\n   $$ I_{\\mathrm{tot}}^{(n+1)} = \\frac{ I_{\\mathrm{tot}}^{(n)} + \\frac{\\Delta t}{L} \\left( V_{\\mathrm{tr}}^{(n+1)} + R_{\\mathrm{th}}^{(n+1)} I_{\\mathrm{re}}^{(n+1)} \\right)}{ 1 + \\frac{\\Delta t}{L} R_{\\mathrm{th}}^{(n+1)} }. $$\n4. 计算 $I_{\\mathrm{th}}^{(n+1)} = I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}$ 和 $E_{\\parallel}^{(n+1)} = \\left(R_{\\mathrm{th}}^{(n+1)}/\\ell\\right) I_{\\mathrm{th}}^{(n+1)}$。\n\n所有物理量必须使用国际单位制。角度不会出现。如果要求任何可能为百分比的比率，请以小数形式表示。\n\n将上述方案实现为一个完整的、可运行的程序，该程序为一组指定的有限测试用例计算演化过程，每个用例由参数 $\\{L, \\ell, R_{\\mathrm{th}}(t), V_{\\mathrm{tr}}(t), E_{\\mathrm{c}}, \\tau_{\\mathrm{ava}}, S_0, I_{\\mathrm{tot}}(0), I_{\\mathrm{re}}(0), T_{\\text{end}}, \\Delta t\\}$ 定义。\n\n用于覆盖不同行为的测试套件：\n- 案例 A（亚阈值衰减，无雪崩）：$L = 10^{-3}\\,\\mathrm{H}$，$\\ell = 2 \\pi \\times 3\\,\\mathrm{m}$，$R_{\\mathrm{th}}(t) = 10^{-5}\\,\\Omega$ (对所有 $t$)，$V_{\\mathrm{tr}}(t) = 0\\,\\mathrm{V}$，$E_{\\mathrm{c}} = 0.05\\,\\mathrm{V/m}$，$\\tau_{\\mathrm{ava}} = 0.01\\,\\mathrm{s}$，$S_0 = 100\\,\\mathrm{A/s}$，$I_{\\mathrm{tot}}(0) = 5 \\times 10^{4}\\,\\mathrm{A}$，$I_{\\mathrm{re}}(0) = 0\\,\\mathrm{A}$，$T_{\\text{end}} = 0.02\\,\\mathrm{s}$，$\\Delta t = 10^{-5}\\,\\mathrm{s}$。\n- 案例 B（轻度超临界，弱雪崩）：$L = 10^{-3}\\,\\mathrm{H}$，$\\ell = 2 \\pi \\times 3\\,\\mathrm{m}$，$R_{\\mathrm{th}}(t) = 10^{-5}\\,\\Omega$ (对所有 $t$)，$V_{\\mathrm{tr}}(t) = 0\\,\\mathrm{V}$，$E_{\\mathrm{c}} = 0.05\\,\\mathrm{V/m}$，$\\tau_{\\mathrm{ava}} = 0.01\\,\\mathrm{s}$，$S_0 = 200\\,\\mathrm{A/s}$，$I_{\\mathrm{tot}}(0) = 10^{5}\\,\\mathrm{A}$，$I_{\\mathrm{re}}(0) = 1\\,\\mathrm{A}$，$T_{\\text{end}} = 0.02\\,\\mathrm{s}$，$\\Delta t = 10^{-5}\\,\\mathrm{s}$。\n- 案例 C（电阻热淬灭跳变，强雪崩）：$L = 10^{-3}\\,\\mathrm{H}$，$\\ell = 2 \\pi \\times 3\\,\\mathrm{m}$，当 $t  10^{-3}\\,\\mathrm{s}$ 时 $R_{\\mathrm{th}}(t) = 10^{-5}\\,\\Omega$，当 $t \\ge 10^{-3}\\,\\mathrm{s}$ 时 $R_{\\mathrm{th}}(t) = 5\\times 10^{-4}\\,\\Omega$，$V_{\\mathrm{tr}}(t) = 0\\,\\mathrm{V}$，$E_{\\mathrm{c}} = 0.05\\,\\mathrm{V/m}$，$\\tau_{\\mathrm{ava}} = 5\\times 10^{-3}\\,\\mathrm{s}$，$S_0 = 500\\,\\mathrm{A/s}$，$I_{\\mathrm{tot}}(0) = 8 \\times 10^{4}\\,\\mathrm{A}$，$I_{\\mathrm{re}}(0) = 0\\,\\mathrm{A}$，$T_{\\text{end}} = 0.005\\,\\mathrm{s}$，$\\Delta t = 10^{-6}\\,\\mathrm{s}$。\n\n所需输出：\n- 对于每个案例，在 $t = T_{\\text{end}}$ 时，报告三元组 $[E_{\\parallel}(T_{\\text{end}}), I_{\\mathrm{re}}(T_{\\text{end}}), I_{\\mathrm{tot}}(T_{\\text{end}})]$，其中 $E_{\\parallel}$ 以 $\\mathrm{V/m}$ 为单位，电流以 $\\mathrm{A}$ 为单位。\n- 将 $E_{\\parallel}(T_{\\text{end}})$ 四舍五入到小数点后六位。将 $I_{\\mathrm{re}}(T_{\\text{end}})$ 和 $I_{\\mathrm{tot}}(T_{\\text{end}})$ 四舍五入到最近的整数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例对应一个三元组，例如：$[[e_1,i_{\\mathrm{re},1},i_{\\mathrm{tot},1}],[e_2,i_{\\mathrm{re},2},i_{\\mathrm{tot},2}],\\ldots]$，其中每一项都是如上所述的数字。",
            "solution": "用户要求设计并实现一个时间积分方案，用以模拟托卡马克等离子体破裂期间逃逸电子电流的演化。该模型将逃逸电流的零维动理学描述与总等离子体电流的集总参数 L-R 电路模型相结合。此问题是适定的，其科学基础根植于已建立的等离子体物理模型，并提供了所有必需的参数以及一个待实现的具体数值算法。\n\n**1. 物理与数学模型**\n\n该系统的动力学由一组耦合的微分代数方程组控制。\n\n**a. 电路动力学：**\n等离子体被建模为一个具有自感 $L$ 和时变热阻 $R_{\\mathrm{th}}(t)$ 的环形导体。总等离子体电流 $I_{\\mathrm{tot}}(t)$ 的演化由 $L-R$ 电路方程描述，该方程是麦克斯韦-法拉第感应定律的结果：\n$$\nL \\, \\frac{d I_{\\mathrm{tot}}}{d t} + R_{\\mathrm{th}}(t) \\, I_{\\mathrm{th}}(t) = V_{\\mathrm{tr}}(t)\n$$\n此处，$V_{\\mathrm{tr}}(t)$ 是来自托卡马克中心螺线管（变压器）的外部施加电压。总电流 $I_{\\mathrm{tot}}(t)$ 是由碰撞热电子承载的电流 $I_{\\mathrm{th}}(t)$ 与由相对论性逃逸电子承载的电流 $I_{\\mathrm{re}}(t)$ 之和：\n$$\nI_{\\mathrm{tot}}(t) = I_{\\mathrm{th}}(t) + I_{\\mathrm{re}}(t)\n$$\n加速电子的平行电场 $E_{\\parallel}(t)$ 被假定为空间均匀的，并通过欧姆定律与热电流相关：\n$$\nE_{\\parallel}(t) = \\frac{R_{\\mathrm{th}}(t)}{\\ell} \\, I_{\\mathrm{th}}(t)\n$$\n其中 $\\ell$ 是有效环向路径长度。\n\n**b. 逃逸电子动理学：**\n逃逸电子电流根据一个简化的动理学模型演化，该模型考虑了两种主要的产生机制：初级（或 Dreicer）产生和次级（或雪崩）产生。逃逸电流的变化率由下式给出：\n$$\n\\frac{d I_{\\mathrm{re}}}{d t} = \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}\\right) \\, I_{\\mathrm{re}} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}\\right)\n$$\n这是逃逸电子的福克-普朗克方程的零阶矩。雪崩增长率 $\\gamma_{\\mathrm{ava}}$ 和初级源项 $S_{\\mathrm{pri}}$ 仅在平行电场 $E_{\\parallel}$ 超过临界电场 $E_{\\mathrm{c}}$ 时才被激活。所使用的简化模型如下：\n$$\n\\gamma_{\\mathrm{ava}}(E_{\\parallel}) = \\frac{1}{\\tau_{\\mathrm{ava}}} \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right)\n$$\n$$\nS_{\\mathrm{pri}}(E_{\\parallel}) = S_0 \\, \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right)\n$$\n其中 $\\tau_{\\mathrm{ava}}$ 是特征雪崩时间尺度，$S_0$ 是初级源强度系数。\n\n**2. 数值积分方案**\n\n为了求解这组关于状态变量 $I_{\\mathrm{tot}}(t)$ 和 $I_{\\mathrm{re}}(t)$ 的耦合方程，我们采用一种半隐式时间步进方案。这种方法由问题陈述指定，并且适合处理由较小的 $L/R_{\\mathrm{th}}$ 时间常数引起的潜在刚性问题。时间域 $[0, T_{\\text{end}}]$ 被离散化为大小为 $\\Delta t$ 的步长。从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单步计算过程如下，其中上标 $(n)$ 表示在时间 $t_n$ 的量值：\n\n**步骤 1：计算 $t_n$ 时刻的状态。**\n首先，我们使用时间步开始时已知的电流值计算平行电场 $E_{\\parallel}^{(n)}$：\n$$\nI_{\\mathrm{th}}^{(n)} = I_{\\mathrm{tot}}^{(n)} - I_{\\mathrm{re}}^{(n)}\n$$\n$$\nE_{\\parallel}^{(n)} = \\frac{R_{\\mathrm{th}}^{(n)}}{\\ell} \\, I_{\\mathrm{th}}^{(n)}\n$$\n其中 $R_{\\mathrm{th}}^{(n)} = R_{\\mathrm{th}}(t_n)$。\n\n**步骤 2：对逃逸电流进行显式更新。**\n使用显式（前向欧拉）方法对逃逸电子动理学方程进行前向积分。源项和增长率使用上一步的电场 $E_{\\parallel}^{(n)}$ 计算，以保证因果性。只要 $\\Delta t$ 相对于物理时间尺度（例如 $1/\\gamma_{\\mathrm{ava}}$）足够小，这种显式处理就是稳定的。\n$$\nI_{\\mathrm{re}}^{(n+1)} = I_{\\mathrm{re}}^{(n)} + \\Delta t \\left[ \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}^{(n)}\\right) I_{\\mathrm{re}}^{(n)} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}^{(n)}\\right) \\right]\n$$\n\n**步骤 3：对总电流进行隐式更新。**\n电路方程使用隐式（后向欧拉）方法进行离散化，以确保对于可能存在的快速电阻衰减过程的数值稳定性。方程为：\n$$\nL \\, \\frac{I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{tot}}^{(n)}}{\\Delta t} + R_{\\mathrm{th}}^{(n+1)} \\, I_{\\mathrm{th}}^{(n+1)} = V_{\\mathrm{tr}}^{(n+1)}\n$$\n代入 $I_{\\mathrm{th}}^{(n+1)} = I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}$ 并整理得到关于 $I_{\\mathrm{tot}}^{(n+1)}$ 的表达式，即为更新规则。注意，我们使用了步骤 2 中刚刚计算出的值 $I_{\\mathrm{re}}^{(n+1)}$。\n$$\nL \\, \\left(I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{tot}}^{(n)}\\right) + \\Delta t \\, R_{\\mathrm{th}}^{(n+1)} \\, \\left(I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}\\right) = \\Delta t \\, V_{\\mathrm{tr}}^{(n+1)}\n$$\n求解 $I_{\\mathrm{tot}}^{(n+1)}$ 可得指定的公式：\n$$\nI_{\\mathrm{tot}}^{(n+1)} = \\frac{ I_{\\mathrm{tot}}^{(n)} + \\frac{\\Delta t}{L} \\left( V_{\\mathrm{tr}}^{(n+1)} + R_{\\mathrm{th}}^{(n+1)} I_{\\mathrm{re}}^{(n+1)} \\right)}{ 1 + \\frac{\\Delta t}{L} R_{\\mathrm{th}}^{(n+1)} }\n$$\n其中 $R_{\\mathrm{th}}^{(n+1)} = R_{\\mathrm{th}}(t_{n+1})$ 且 $V_{\\mathrm{tr}}^{(n+1)} = V_{\\mathrm{tr}}(t_{n+1})$。\n\n**步骤 4：闭合系统。**\n利用更新后的电流 $I_{\\mathrm{re}}^{(n+1)}$ 和 $I_{\\mathrm{tot}}^{(n+1)}$，可以求出 $t_{n+1}$ 时刻的其余量，从而为下一个时间步做好状态准备。\n$$\nI_{\\mathrm{th}}^{(n+1)} = I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}\n$$\n$$\nE_{\\parallel}^{(n+1)} = \\frac{R_{\\mathrm{th}}^{(n+1)}}{\\ell} \\, I_{\\mathrm{th}}^{(n+1)}\n$$\n重复此操作序列，直至达到所需的时间步数且 $t = T_{\\text{end}}$。然后报告 $E_{\\parallel}$、$I_{\\mathrm{re}}$ 和 $I_{\\mathrm{tot}}$ 的最终值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            'name': 'A',\n            'params': {\n                'L': 1e-3,\n                'ell': 2 * np.pi * 3,\n                'R_th_func': lambda t: 1e-5,\n                'V_tr_func': lambda t: 0.0,\n                'Ec': 0.05,\n                'tau_ava': 0.01,\n                'S0': 100,\n                'I_tot_0': 5e4,\n                'I_re_0': 0.0,\n                'T_end': 0.02,\n                'dt': 1e-5,\n            }\n        },\n        {\n            'name': 'B',\n            'params': {\n                'L': 1e-3,\n                'ell': 2 * np.pi * 3,\n                'R_th_func': lambda t: 1e-5,\n                'V_tr_func': lambda t: 0.0,\n                'Ec': 0.05,\n                'tau_ava': 0.01,\n                'S0': 200,\n                'I_tot_0': 1e5,\n                'I_re_0': 1.0,\n                'T_end': 0.02,\n                'dt': 1e-5,\n            }\n        },\n        {\n            'name': 'C',\n            'params': {\n                'L': 1e-3,\n                'ell': 2 * np.pi * 3,\n                'R_th_func': lambda t: 1e-5 if t  1e-3 else 5e-4,\n                'V_tr_func': lambda t: 0.0,\n                'Ec': 0.05,\n                'tau_ava': 5e-3,\n                'S0': 500,\n                'I_tot_0': 8e4,\n                'I_re_0': 0.0,\n                'T_end': 0.005,\n                'dt': 1e-6,\n            }\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result_tuple = run_simulation(**case['params'])\n        results.append(result_tuple)\n\n    # Format the results for the final output string\n    output_parts = []\n    for E_p, I_re, I_tot in results:\n        e_str = f\"{E_p:.6f}\"\n        ire_str = str(int(round(I_re)))\n        itot_str = str(int(round(I_tot)))\n        output_parts.append(f\"[{e_str},{ire_str},{itot_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\n\ndef run_simulation(L, ell, R_th_func, V_tr_func, Ec, tau_ava, S0, I_tot_0, I_re_0, T_end, dt):\n    \"\"\"\n    Executes the time-integration for a single set of parameters.\n\n    Args:\n        L (float): Plasma inductance (H).\n        ell (float): Effective toroidal loop length (m).\n        R_th_func (callable): Function R_th(t) for thermal resistance (Ohm).\n        V_tr_func (callable): Function V_tr(t) for transformer voltage (V).\n        Ec (float): Critical electric field (V/m).\n        tau_ava (float): Avalanche timescale (s).\n        S0 (float): Primary runaway source coefficient (A/s).\n        I_tot_0 (float): Initial total current (A).\n        I_re_0 (float): Initial runaway current (A).\n        T_end (float): Simulation end time (s).\n        dt (float): Time step (s).\n\n    Returns:\n        tuple: A tuple containing (E_parallel, I_re, I_tot) at T_end.\n    \"\"\"\n    \n    num_steps = int(round(T_end / dt))\n    \n    # Initialize state variables\n    I_tot = I_tot_0\n    I_re = I_re_0\n\n    for n in range(num_steps):\n        t_n = n * dt\n\n        # Step 1: Evaluate E_parallel at t_n\n        R_th_n = R_th_func(t_n)\n        I_th_n = I_tot - I_re\n        E_parallel_n = (R_th_n / ell) * I_th_n\n\n        # Evaluate runaway source terms based on E_parallel_n\n        E_ratio_minus_1 = E_parallel_n / Ec - 1.0\n        if E_ratio_minus_1 > 0:\n            gamma_ava = (1.0 / tau_ava) * E_ratio_minus_1\n            S_pri = S0 * E_ratio_minus_1\n        else:\n            gamma_ava = 0.0\n            S_pri = 0.0\n\n        # Step 2: Update I_re to t_{n+1} using explicit Euler\n        I_re_np1 = I_re + dt * (gamma_ava * I_re + S_pri)\n        \n        # Step 3: Update I_tot to t_{n+1} using implicit Euler\n        t_np1 = (n + 1) * dt\n        V_tr_np1 = V_tr_func(t_np1)\n        R_th_np1 = R_th_func(t_np1)\n        \n        dt_over_L = dt / L\n        numerator = I_tot + dt_over_L * (V_tr_np1 + R_th_np1 * I_re_np1)\n        denominator = 1.0 + dt_over_L * R_th_np1\n        I_tot_np1 = numerator / denominator\n\n        # Update state for the next iteration\n        I_tot = I_tot_np1\n        I_re = I_re_np1\n\n    # After the loop, calculate the final E_parallel at T_end\n    t_final = num_steps * dt\n    R_th_final = R_th_func(t_final)\n    I_th_final = I_tot - I_re\n    E_parallel_final = (R_th_final / ell) * I_th_final\n\n    return E_parallel_final, I_re, I_tot\n\nsolve()\n```"
        }
    ]
}