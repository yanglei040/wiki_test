{
    "hands_on_practices": [
        {
            "introduction": "The $m=1$ tearing mode is a foundational instability in tokamak plasmas, often responsible for the sawtooth phenomenon that can degrade core confinement. This exercise provides fundamental practice in identifying the location of this instability by calculating the position of the $q=1$ rational surface from a given plasma current profile. By grounding the abstract concept of a rational surface in a concrete calculation, you will build a stronger intuition for the relationship between plasma current, magnetic topology, and MHD stability .",
            "id": "3720911",
            "problem": "A large-aspect-ratio, circular-cross-section tokamak has major radius $R_0 = 3.0\\,\\mathrm{m}$, minor radius $a = 0.75\\,\\mathrm{m}$, externally applied toroidal magnetic field $B_{\\phi} = 5.0\\,\\mathrm{T}$ that is approximately uniform across the minor radius, and a toroidal plasma current density profile $J_{\\phi}(r) = J_0 \\left(1 - \\frac{r^2}{a^2}\\right)$ for $0 \\le r \\le a$. The total plasma current is measured to be $I_p = 3.0 \\times 10^6\\,\\mathrm{A}$. Assume the large-aspect-ratio limit and ignore Shafranov shift and pressure effects. Use Maxwell–Ampère law and the geometric definition of the safety factor to derive an expression for $q(r)$ in terms of $R_0$, $B_{\\phi}$, $I_p$, and $a$. Then, using the resonance condition for the poloidal mode number $m$ and toroidal mode number $n$, identify the rational surface $r_s$ at which the $m=1$, $n=1$ tearing mode can resonate, i.e., where $q(r_s) = 1$. Compute $r_s$ and round your final numeric value to four significant figures. Express $r_s$ in meters.\n\nIn addition, starting from the resistive Magnetohydrodynamics (MHD) framework and the core definitions of magnetic field-line topology, explain succinctly why finite magnetic shear at $q=1$ and a peaked core current profile provide the free energy and topology needed to trigger the resistive $m=1$ tearing instability that forms a magnetic island. In your explanation, use the core definition of magnetic shear $\\hat{s}(r) \\equiv \\frac{r}{q(r)} \\frac{dq}{dr}$, but do not invoke any pre-derived stability criteria; base your reasoning on how shear sets the local field-line pitch variation and how current gradients couple to resistive reconnection.",
            "solution": "The problem is divided into two parts: a quantitative calculation of the radial location of the $m=1, n=1$ rational surface, and a qualitative explanation of the physical mechanism driving the resistive $m=1$ tearing mode.\n\nFirst, we perform the quantitative calculation. The goal is to find the radius $r_s$ where the safety factor $q(r_s) = 1$. This requires deriving the expression for the safety factor profile $q(r)$.\n\nThe safety factor in a large-aspect-ratio, circular-cross-section tokamak is defined as:\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)}$$\nHere, $r$ is the minor radial coordinate, $R_0$ is the major radius, $B_{\\phi}$ is the toroidal magnetic field, and $B_{\\theta}(r)$ is the poloidal magnetic field. $B_{\\phi}$ and $R_0$ are given constants. We must determine $B_{\\theta}(r)$ from the given toroidal current density profile, $J_{\\phi}(r)$.\n\nThe current density is given as $J_{\\phi}(r) = J_0 \\left(1 - \\frac{r^2}{a^2}\\right)$, where $a$ is the minor radius. The constant $J_0$ is related to the total plasma current, $I_p$. We find this relationship by integrating $J_{\\phi}(r)$ over the plasma cross-section:\n$$I_p = \\int_0^a J_{\\phi}(r) \\, 2\\pi r \\, dr = \\int_0^a J_0 \\left(1 - \\frac{r^2}{a^2}\\right) 2\\pi r \\, dr$$\n$$I_p = 2\\pi J_0 \\int_0^a \\left(r - \\frac{r^3}{a^2}\\right) dr = 2\\pi J_0 \\left[ \\frac{r^2}{2} - \\frac{r^4}{4a^2} \\right]_0^a$$\n$$I_p = 2\\pi J_0 \\left( \\frac{a^2}{2} - \\frac{a^4}{4a^2} \\right) = 2\\pi J_0 \\left( \\frac{a^2}{4} \\right) = \\frac{\\pi J_0 a^2}{2}$$\nSolving for $J_0$, we get:\n$$J_0 = \\frac{2 I_p}{\\pi a^2}$$\n\nNext, we find the poloidal magnetic field $B_{\\theta}(r)$ using the integral form of the Maxwell-Ampère law, $\\oint \\vec{B} \\cdot d\\vec{l} = \\mu_0 I_{enc}$, where $I_{enc}$ is the current enclosed by the Amperian loop of radius $r$:\n$$B_{\\theta}(r) \\cdot 2\\pi r = \\mu_0 \\int_0^r J_{\\phi}(r') \\, 2\\pi r' \\, dr'$$\nThe enclosed current $I_{enc}(r)$ is:\n$$I_{enc}(r) = 2\\pi J_0 \\int_0^r \\left(r' - \\frac{r'^3}{a^2}\\right) dr' = 2\\pi J_0 \\left[ \\frac{r'^2}{2} - \\frac{r'^4}{4a^2} \\right]_0^r = 2\\pi J_0 \\left( \\frac{r^2}{2} - \\frac{r^4}{4a^2} \\right)$$\nSubstituting the expression for $J_0$:\n$$I_{enc}(r) = 2\\pi \\left(\\frac{2 I_p}{\\pi a^2}\\right) r^2 \\left( \\frac{1}{2} - \\frac{r^2}{4a^2} \\right) = \\frac{4 I_p r^2}{a^2} \\left( \\frac{2a^2 - r^2}{4a^2} \\right) = \\frac{I_p r^2}{a^4} (2a^2 - r^2)$$\nAn alternative form is $I_{enc}(r) = \\frac{2 I_p r^2}{a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right)$.\nNow, we find $B_{\\theta}(r)$:\n$$B_{\\theta}(r) = \\frac{\\mu_0 I_{enc}(r)}{2\\pi r} = \\frac{\\mu_0}{2\\pi r} \\left[ \\frac{2 I_p r^2}{a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right) \\right] = \\frac{\\mu_0 I_p r}{\\pi a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right)$$\n\nWe now have all the components to write the expression for $q(r)$:\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)} = \\frac{r B_{\\phi}}{R_0 \\left[ \\frac{\\mu_0 I_p r}{\\pi a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right) \\right]}$$\n$$q(r) = \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} \\frac{1}{1 - \\frac{r^2}{2a^2}}$$\nThis is the required expression for $q(r)$.\n\nThe $m=1, n=1$ tearing mode resonates at the rational surface $r_s$ where $q(r_s) = m/n = 1/1 = 1$. We set $q(r_s)=1$ and solve for $r_s$:\n$$1 = \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p \\left( 1 - \\frac{r_s^2}{2a^2} \\right)}$$\n$$1 - \\frac{r_s^2}{2a^2} = \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p}$$\n$$\\frac{r_s^2}{2a^2} = 1 - \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p}$$\n$$r_s^2 = 2a^2 \\left( 1 - \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} \\right)$$\n$$r_s = a \\sqrt{2 \\left( 1 - \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} \\right)}$$\n\nNow, we substitute the given numerical values: $R_0 = 3.0\\,\\mathrm{m}$, $a = 0.75\\,\\mathrm{m}$, $B_{\\phi} = 5.0\\,\\mathrm{T}$, $I_p = 3.0 \\times 10^6\\,\\mathrm{A}$, and the permeability of free space $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{T \\cdot m / A}$.\nLet's compute the dimensionless term in the parentheses:\n$$\\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} = \\frac{\\pi (0.75)^2 (5.0)}{(4\\pi \\times 10^{-7}) (3.0) (3.0 \\times 10^6)} = \\frac{(0.75)^2 \\times 5.0}{4 \\times 10^{-7} \\times 9.0 \\times 10^6} = \\frac{0.5625 \\times 5.0}{3.6} = \\frac{2.8125}{3.6} = 0.78125$$\nThis term represents the on-axis safety factor, $q(0)$. Since $q(0)  1$, a $q=1$ surface must exist if $q$ increases with radius, which it does for this profile.\nNow we can compute $r_s$:\n$$r_s = 0.75 \\sqrt{2 (1 - 0.78125)} = 0.75 \\sqrt{2 (0.21875)} = 0.75 \\sqrt{0.4375}$$\n$$r_s \\approx 0.75 \\times 0.6614378 \\approx 0.49607835\\,\\mathrm{m}$$\nRounding to four significant figures, we get $r_s = 0.4961\\,\\mathrm{m}$.\n\nFor the second part of the problem, we explain the physics of the resistive $m=1$ tearing instability.\n\nIn a tokamak, a peaked current profile, where the current density $J_{\\phi}$ is highest on the magnetic axis ($r=0$) and decreases with radius, is a state that contains free magnetic energy compared to a state with a flatter current profile. An instability is a mechanism through which the plasma can transition to a lower energy state by rearranging its current and magnetic field structure.\n\nThe magnetic field topology is characterized by the safety factor, $q(r)$, which measures the number of toroidal turns a magnetic field line makes for one poloidal turn. A surface where $q(r_s) = m/n$ for integers $m$ and $n$ is called a rational surface. On such a surface, field lines are resonant; they close back on themselves after $n$ poloidal and $m$ toroidal circuits. For the $m=1, n=1$ mode, this occurs where $q=1$.\n\nMagnetic shear, defined as $\\hat{s}(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$, measures the radial rate of change of the field line pitch. A non-zero shear signifies that field lines on adjacent flux surfaces are not parallel; their pitch angle changes with radius. This property imparts a 'stiffness' to the magnetic field. In ideal Magnetohydrodynamics (MHD), where plasma conductivity is infinite, any perturbation that attempts to cross-connect field lines from different radii is strongly suppressed by this shear, as it would require an infinite amount of energy to bend the 'frozen-in' field lines.\n\nHowever, any real plasma has finite resistivity, $\\eta$. While resistivity is typically very small and its effects negligible in most of the plasma volume, it becomes critically important in a very thin layer around a rational surface. Consider a small, initial helical perturbation of the plasma with mode numbers $m=1, n=1$. Due to magnetic shear, this displacement brings field lines from inside the $q=1$ surface (where $q1$) into close proximity with field lines from outside (where $q>1$). These field lines have different pitches and are thus misaligned. This misalignment creates a singular, intense sheet of current localized at the $r=r_s$ rational surface.\n\nWithin this thin resistive layer, Ohm's law in its resistive form, $\\vec{E} + \\vec{v} \\times \\vec{B} = \\eta \\vec{J}$, shows that the electric field is no longer required to be zero in the frame of the plasma. The finite resistivity allows magnetic flux to diffuse across the plasma, breaking the frozen-in law of ideal MHD. The misaligned magnetic field lines can 'cut' and 'reconnect', changing the magnetic topology.\n\nThis process of reconnection is driven by the free energy available from the peaked current profile. The system can release energy by flattening the current gradient, particularly by removing the region where $q1$. The $m=1$ tearing instability accomplishes this by forming a magnetic island at the $q=1$ surface. The island grows, and in the \"sawtooth\" phenomenon, the original magnetic axis is expelled and becomes an X-point of the island, while the island's O-point becomes the new center. This violent rearrangement rapidly transports the hot, high-current plasma from the core outwards, flattening the current and temperature profiles inside the original $q=1$ radius and releasing magnetic energy. Thus, the combination of a resonant rational surface ($q=1$), the free energy source from a peaked current gradient, and the enabling mechanism of finite resistivity within a shear-localized layer provides the necessary conditions to trigger the resistive $m=1$ tearing instability.",
            "answer": "$$\\boxed{0.4961}$$"
        },
        {
            "introduction": "Understanding instabilities is only half the battle; controlling them is a central goal of fusion research. This problem explores one of the most powerful passive stabilization mechanisms: sheared plasma flow. Using a first-principles phase-coherence argument, you will derive the critical flow shear required to tear apart a growing tearing mode, providing insight into how plasma dynamics can be used to maintain stability .",
            "id": "3720894",
            "problem": "Consider a cylindrical magnetically confined plasma in the resistive magnetohydrodynamics (MHD) regime, with equilibrium magnetic field $\\mathbf{B}_{0} = B_{z0}\\,\\hat{\\mathbf{z}} + B_{\\theta 0}(r)\\,\\hat{\\boldsymbol{\\theta}}$ and a poloidal equilibrium flow $\\mathbf{V}_{0}(r) = V_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}}$. A linearly unstable tearing mode exists at a rational surface $r = r_{s}$, with poloidal mode number $m$, poloidal wavenumber $k_{\\theta} = m/r_{s}$ evaluated at $r_{s}$, and real linear growth rate $\\gamma$ in the absence of flow shear. Near $r_{s}$ the mode has a finite radial coherence width $w$ (assumed small compared to $r_{s}$), within which the eigenfunction is appreciable.\n\nStarting from the resistive MHD induction equation $\\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\mathbf{V} \\times \\mathbf{B}) - \\nabla \\times (\\eta\\,\\mathbf{J})$ and the associated advection of the perturbed magnetic flux by the equilibrium flow, analyze how a local flow shear $s_{V} \\equiv dV_{\\theta}/dr|_{r_{s}}$ modifies the phase of the tearing perturbation across the width $w$ and thereby induces phase mixing. Using a first-principles phase coherence argument based on the convective term, derive the criterion for suppression of linear tearing growth by flow shear and compute the critical flow shear $s_{V}^{\\mathrm{crit}}$ required to suppress the mode in terms of the given parameters $\\gamma$, $w$, and $k_{\\theta}$.\n\nExpress your final answer as a single closed-form analytical expression for $s_{V}^{\\mathrm{crit}}$. This quantity has physical units of inverse seconds; do not include units in the final boxed answer.",
            "solution": "The suppression of a tearing mode by a sheared equilibrium flow is a consequence of phase mixing. The flow advects the tearing perturbation, and if the flow velocity varies across the radial structure of the mode, different parts of the mode are advected at different rates. This differential advection tears the coherent structure of the mode apart. The mode is suppressed if this shearing process occurs on a timescale shorter than the mode's intrinsic growth time. We are asked to derive this criterion from a phase coherence argument.\n\nWe begin with the linearized resistive MHD induction equation. Let the magnetic field be $\\mathbf{B} = \\mathbf{B}_{0} + \\mathbf{b}$ and the velocity be $\\mathbf{V} = \\mathbf{V}_{0} + \\mathbf{v}$, where $\\mathbf{b}$ and $\\mathbf{v}$ are small perturbations. The problem specifically directs our attention to the effect of the equilibrium flow $\\mathbf{V}_{0}$ on the perturbed field $\\mathbf{b}$. The relevant term in the linearized induction equation governing the advection of the perturbation by the equilibrium flow is the convective derivative part, which can be extracted from the $\\nabla \\times (\\mathbf{V} \\times \\mathbf{B})$ term.\n\nThe time evolution of the perturbed magnetic field $\\mathbf{b}$ includes the term $\\nabla \\times (\\mathbf{V}_{0} \\times \\mathbf{b})$. Using the vector identity $\\nabla \\times (\\mathbf{A} \\times \\mathbf{C}) = (\\mathbf{C} \\cdot \\nabla)\\mathbf{A} - (\\mathbf{A} \\cdot \\nabla)\\mathbf{C} + \\mathbf{A}(\\nabla \\cdot \\mathbf{C}) - \\mathbf{C}(\\nabla \\cdot \\mathbf{A})$, and noting that for the magnetic field $\\nabla \\cdot \\mathbf{b} = 0$ and for the specified flow $\\mathbf{V}_{0} = V_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}}$, we have $\\nabla \\cdot \\mathbf{V}_{0} = \\frac{1}{r}\\frac{\\partial V_{\\theta}}{\\partial\\theta}=0$, this term simplifies. The dominant advective effect on the perturbation $\\mathbf{b}$ is described by the operator $(\\mathbf{V}_{0} \\cdot \\nabla)\\mathbf{b}$.\n\nThe tearing mode perturbation is localized near the rational surface $r=r_s$ and has a harmonic dependence on the poloidal angle $\\theta$ of the form $\\exp(im\\theta)$. The operator $(\\mathbf{V}_{0} \\cdot \\nabla)$ acting on such a perturbation is:\n$$\n(\\mathbf{V}_{0} \\cdot \\nabla) \\mathbf{b} = \\left(V_{\\theta}(r)\\hat{\\boldsymbol{\\theta}}\\right) \\cdot \\left(\\frac{1}{r}\\frac{\\partial}{\\partial\\theta}\\hat{\\boldsymbol{\\theta}}\\right) \\mathbf{b} = \\frac{V_{\\theta}(r)}{r} \\frac{\\partial \\mathbf{b}}{\\partial\\theta}\n$$\nSince $\\mathbf{b} \\propto \\exp(im\\theta)$, we have $\\frac{\\partial \\mathbf{b}}{\\partial\\theta} = im\\mathbf{b}$. The effect of the advection is thus to add a term to the time derivative:\n$$\n(\\mathbf{V}_{0} \\cdot \\nabla) \\mathbf{b} = i \\frac{m V_{\\theta}(r)}{r} \\mathbf{b}\n$$\nThis term represents a local, radius-dependent Doppler shift to the mode's frequency. The local angular frequency of the mode due to this advection is $\\Omega_{\\mathrm{adv}}(r) = \\frac{m V_{\\theta}(r)}{r}$. Using the definition of the poloidal wavenumber $k_{\\theta}(r) = m/r$, this can be written as $\\Omega_{\\mathrm{adv}}(r) = k_{\\theta}(r) V_{\\theta}(r)$.\n\nThe phase mixing arises not from the bulk flow, but from the shear of the flow. We analyze the variation of this advection frequency across the radial width $w$ of the mode, centered at $r=r_s$. We are interested in the frequency spread, which is caused by the radial gradient of $\\Omega_{\\mathrm{adv}}(r)$ at $r=r_s$.\n$$\n\\frac{d\\Omega_{\\mathrm{adv}}}{dr} \\bigg|_{r_s} = \\frac{d}{dr} \\left( \\frac{m V_{\\theta}(r)}{r} \\right) \\bigg|_{r_s} = m \\left( \\frac{1}{r} \\frac{dV_{\\theta}}{dr} - \\frac{V_{\\theta}}{r^2} \\right) \\bigg|_{r_s} = \\frac{m s_V}{r_s} - \\frac{m V_{\\theta}(r_s)}{r_s^2}\n$$\nUsing the definition $k_{\\theta} = m/r_s$ at the rational surface, this becomes:\n$$\n\\frac{d\\Omega_{\\mathrm{adv}}}{dr} \\bigg|_{r_s} = k_{\\theta} s_V - k_{\\theta} \\frac{V_{\\theta}(r_s)}{r_s}\n$$\nThe first term, $k_{\\theta} s_V$, is due to the flow shear $s_V$. The second term, $-k_{\\theta} V_{\\theta}(r_s)/r_s$, is associated with the radial variation of the geometric factor $1/r$. The term proportional to $V_{\\theta}(r_s)$ corresponds to a uniform rotation of the mode pattern with a slight radial dependence. However, the dominant effect responsible for tearing the mode structure apart is the differential rotation introduced by the velocity shear $s_V$. In a local analysis, and for the purpose of a phase coherence argument focused on the shear, we identify the shearing rate of the frequency with the term containing $s_V$. More formally, one can move to a frame rotating with the local plasma velocity at $r_s$, in which only the differential rotation remains. Therefore, the relevant frequency gradient is approximately $k_{\\theta} s_V$.\n\nThe tearing mode perturbation is coherent over a radial width $w$. The spread in advection frequencies across this width is:\n$$\n\\Delta\\Omega_{\\mathrm{shear}} \\approx \\left| \\frac{d\\Omega_{\\mathrm{adv}}}{dr} \\right| \\times w \\approx |k_{\\theta} s_V| w\n$$\nThis frequency spread $\\Delta\\Omega_{\\mathrm{shear}}$ represents the rate at which the phase coherence of the mode is destroyed by the sheared flow. It can be interpreted as an inverse timescale, $\\tau_{\\mathrm{shear}}^{-1}$, where $\\tau_{\\mathrm{shear}} = 1/\\Delta\\Omega_{\\mathrm{shear}}$ is the characteristic time for phase mixing.\n\nThe tearing mode is linearly unstable with a growth rate $\\gamma$ in the absence of flow shear. This means the mode amplitude grows on a timescale $\\tau_{\\mathrm{growth}} = 1/\\gamma$.\n\nThe phase coherence argument for suppression is a comparison of these two timescales.\n- If the growth time is much shorter than the shearing time ($\\tau_{\\mathrm{growth}} \\ll \\tau_{\\mathrm{shear}}$), the mode grows to a significant amplitude before its structure is disrupted. The mode is unstable.\n- If the shearing time is much shorter than the growth time ($\\tau_{\\mathrm{shear}} \\ll \\tau_{\\mathrm{growth}}$), the flow shear tears the mode apart faster than it can grow. The mode is suppressed.\n\nThe critical condition for suppression is when these two timescales are comparable:\n$$\n\\tau_{\\mathrm{growth}} \\approx \\tau_{\\mathrm{shear}} \\implies \\frac{1}{\\gamma} \\approx \\frac{1}{|k_{\\theta} s_V| w}\n$$\nThis gives the criterion for the critical flow shear, $s_V^{\\mathrm{crit}}$. It is the value of the flow shear for which the shearing rate equals the growth rate:\n$$\n\\gamma = |k_{\\theta} s_{V}^{\\mathrm{crit}}| w\n$$\nThe problem defines $\\gamma$, $k_{\\theta}$, and $w$ as positive real parameters. The critical shear $s_V^{\\mathrm{crit}}$ is the magnitude of the shear required for suppression. We can therefore solve for its magnitude:\n$$\n|s_{V}^{\\mathrm{crit}}| = \\frac{\\gamma}{k_{\\theta} w}\n$$\nSince the problem asks for the single value of the critical flow shear, we provide the positive value.\n$$\ns_{V}^{\\mathrm{crit}} = \\frac{\\gamma}{k_{\\theta} w}\n$$\nThis expression represents the critical flow shear required to suppress a tearing mode with growth rate $\\gamma$ and radial structure of width $w$.",
            "answer": "$$\\boxed{\\frac{\\gamma}{k_{\\theta} w}}$$"
        },
        {
            "introduction": "While analytical models provide crucial insights, assessing the stability of realistic fusion plasmas requires numerical computation. This exercise guides you through the process of building a numerical tool to calculate the tearing stability parameter, $\\Delta'$, for a more general magnetic equilibrium. By implementing a shooting method to solve the ideal MHD outer equation, you will gain practical experience in the computational techniques that bridge MHD theory and experimental analysis .",
            "id": "3720941",
            "problem": "You are given a one-dimensional flux-aligned formulation of the outer-region ideal Magnetohydrodynamics (MHD) matching problem for a tearing mode in a slab Grad–Shafranov equilibrium. The aim is to compute the classical tearing stability parameter $\\Delta'$ numerically, using flux coordinates and a convergent definition at a rational surface. Work in a nondimensionalized system where lengths are measured in units of $1/k_y$ and fields are scaled by a uniform guide field so that the parallel wavenumber is dimensionless.\n\nFundamental base: the outer-region equation for the perturbed helical flux $\\tilde{\\psi}(x)$ in a sheared slab equilibrium follows from linearized ideal Magnetohydrodynamics (MHD) and flux freezing (derived from Faraday’s law, Ampère’s law, and the ideal Ohm’s law of ideal MHD, $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$). In reduced Magnetohydrodynamics (RMHD) ordering with a strong, uniform guide field and static perturbations, the outer-region equation in the flux coordinate $x$ reduces to a Newcomb-type ordinary differential equation,\n$$\n\\frac{d}{dx}\\left(\\frac{1}{k_{\\parallel}^2(x)}\\frac{d\\tilde{\\psi}}{dx}\\right) - \\tilde{\\psi} = 0,\n$$\nwhere $k_{\\parallel}(x)$ is the parallel wavenumber defined by the projection of the perturbation wavevector along the equilibrium magnetic field. The rational surface location $x_s$ is determined by $k_{\\parallel}(x_s) = 0$; the coefficient has a first-order pole there. The stability parameter $\\Delta'$ is defined as the jump in the logarithmic derivative across the rational surface,\n$$\n\\Delta' \\equiv \\left[\\frac{d}{dx}\\ln \\tilde{\\psi}(x)\\right]_{x \\to x_s^+} - \\left[\\frac{d}{dx}\\ln \\tilde{\\psi}(x)\\right]_{x \\to x_s^-} = \\lim_{\\epsilon \\to 0^+} \\left( \\frac{\\tilde{\\psi}'(x_s + \\epsilon)}{\\tilde{\\psi}(x_s + \\epsilon)} - \\frac{\\tilde{\\psi}'(x_s - \\epsilon)}{\\tilde{\\psi}(x_s - \\epsilon)} \\right).\n$$\n\nYou will compute $\\Delta'$ by integrating the outer-region equation from both sides of the rational surface using boundary conditions that enforce decay away from the rational surface. Specifically:\n\n- Model the equilibrium and perturbation geometry with a dimensionless parallel wavenumber profile\n$$\nk_{\\parallel}(x) = \\kappa_0 + s\\,x + c\\,x^3,\n$$\nwhere $s$ and $c$ are dimensionless shear parameters, and $\\kappa_0$ is a dimensionless offset controlling the rational surface location. For all test cases below, the domain is $x \\in [-L, L]$ with $L  0$. Assume there is exactly one rational surface $x_s \\in (-L, L)$ such that $k_{\\parallel}(x_s) = 0$.\n\n- Impose decaying outer-region boundary conditions at $x = -L$ and $x = +L$ using the local constant-coefficient asymptotics of the differential equation:\nfor large $|x|$, where $k_{\\parallel}(x)$ varies slowly, the equation reduces to $\\tilde{\\psi}'' - k_{\\parallel}^2(x) \\tilde{\\psi} \\approx 0$, so the decaying solutions satisfy\n$$\n\\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=+L} = -|k_{\\parallel}(+L)|\\,\\tilde{\\psi}(+L), \\quad \\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=-L} = +|k_{\\parallel}(-L)|\\,\\tilde{\\psi}(-L).\n$$\nNormalize each side independently with $\\tilde{\\psi}(\\pm L) = 1$; normalization cancels in the ratio that defines $\\Delta'$.\n\n- Integrate the first-order system equivalent to the second-order equation,\n$$\n\\frac{d}{dx}\n\\begin{pmatrix}\n\\tilde{\\psi} \\\\\n\\tilde{\\psi}'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tilde{\\psi}' \\\\\n2 \\frac{k_{\\parallel}'(x)}{k_{\\parallel}(x)} \\tilde{\\psi}' + k_{\\parallel}^2(x)\\, \\tilde{\\psi}\n\\end{pmatrix},\n$$\nfrom $x=+L$ towards $x_s + \\epsilon$ and from $x=-L$ towards $x_s - \\epsilon$, where $\\epsilon$ is a small positive cutoff that prevents integration into the singularity. Use $\\epsilon = 10^{-4}$. Then compute\n$$\n\\Delta'(\\epsilon) = \\left.\\frac{\\tilde{\\psi}'}{\\tilde{\\psi}}\\right|_{x=x_s+\\epsilon} - \\left.\\frac{\\tilde{\\psi}'}{\\tilde{\\psi}}\\right|_{x=x_s-\\epsilon}\n$$\nwhich converges to the desired $\\Delta'$ as $\\epsilon \\to 0^+$.\n\n- Express all final answers as dimensionless decimal floating-point numbers with no units.\n\nImplement a program that:\n- Locates $x_s$ by solving $k_{\\parallel}(x_s) = 0$ within the given interval.\n- Integrates the system from both sides with the boundary conditions above and $\\epsilon = 10^{-4}$.\n- Computes $\\Delta'$ as defined.\n\nTest Suite:\nProvide outputs for the following parameter sets $(L, s, \\kappa_0, c)$:\n- Case A (happy path, linear shear, centered resonance): $(L, s, \\kappa_0, c) = (5, 1, 0, 0)$.\n- Case B (weak shear, centered resonance): $(L, s, \\kappa_0, c) = (5, 0.2, 0, 0)$.\n- Case C (resonance near boundary): $(L, s, \\kappa_0, c) = (5, 1, -4.5, 0)$.\n- Case D (nonlinear shear with cubic term, centered resonance): $(L, s, \\kappa_0, c) = (4, 1, 0, 0.1)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\Delta'_A, \\Delta'_B, \\Delta'_C, \\Delta'_D]$ corresponding to Cases A–D. For example: \"[0.1234,0.5678,0.9101,1.1121]\". No additional text should be printed.",
            "solution": "The problem requires the computation of the tearing mode stability parameter, denoted as $\\Delta'$, for a given one-dimensional slab model in magnetohydrodynamics (MHD). The solution methodology involves numerically solving the ideal MHD outer-region equation, which is a second-order ordinary differential equation (ODE), and matching the solutions across a rational surface where the equation is singular.\n\nThe fundamental physical principle is that a tearing instability can develop in a plasma at a \"rational surface\" where the magnetic field lines close back on themselves after a finite number of turns. In our slab model, this corresponds to the location $x_s$ where the parallel wavenumber $k_{\\parallel}(x_s)$ vanishes. Away from this surface, in the \"outer region,\" the plasma is treated as a perfect conductor (ideal MHD), and its dynamics are governed by the equation for the perturbed helical magnetic flux, $\\tilde{\\psi}(x)$:\n$$\n\\frac{d}{dx}\\left(\\frac{1}{k_{\\parallel}^2(x)}\\frac{d\\tilde{\\psi}}{dx}\\right) - \\tilde{\\psi} = 0\n$$\nThis equation becomes singular at $x=x_s$, where $k_{\\parallel}(x_s)=0$. Tearing mode theory shows that the solution $\\tilde{\\psi}(x)$ is continuous across this surface, but its derivative $\\tilde{\\psi}'(x)$ can be discontinuous. The stability parameter $\\Delta'$ is defined as this jump in the logarithmic derivative:\n$$\n\\Delta' \\equiv \\lim_{\\epsilon \\to 0^+} \\left( \\frac{\\tilde{\\psi}'(x_s + \\epsilon)}{\\tilde{\\psi}(x_s + \\epsilon)} - \\frac{\\tilde{\\psi}'(x_s - \\epsilon)}{\\tilde{\\psi}(x_s - \\epsilon)} \\right)\n$$\nA positive $\\Delta'$ typically indicates that the plasma configuration is unstable to the tearing mode.\n\nThe algorithmic design directly follows from these principles. The procedure is to solve the ODE in the two separate outer regions, $( -L, x_s)$ and $(x_s, L)$, and then use the solutions to compute $\\Delta'$.\n\nFirst, the ODE is rearranged into a standard first-order system suitable for numerical solvers. By applying the product rule to the governing equation and isolating the second derivative $\\tilde{\\psi}''$, we obtain the system:\n$$\n\\frac{d}{dx}\n\\begin{pmatrix}\n\\tilde{\\psi} \\\\\n\\tilde{\\psi}'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tilde{\\psi}' \\\\\n2 \\frac{k_{\\parallel}'(x)}{k_{\\parallel}(x)} \\tilde{\\psi}' + k_{\\parallel}^2(x)\\, \\tilde{\\psi}\n\\end{pmatrix}\n$$\nwhere $k_{\\parallel}(x) = \\kappa_0 + s\\,x + c\\,x^3$ and its derivative is $k_{\\parallel}'(x) = s + 3cx^2$.\n\nThe rational surface location $x_s$ is found by solving the algebraic equation $k_{\\parallel}(x_s) = 0$, which is a cubic equation for the given form of $k_{\\parallel}(x)$. The problem guarantees a unique root exists within the domain $x \\in (-L, L)$. This root is found numerically using a standard polynomial root-finding algorithm.\n\nThe ODE must be supplemented with boundary conditions. Tearing modes are physically localized around the rational surface; hence, the perturbation $\\tilde{\\psi}(x)$ must decay far from $x_s$. This decay condition is approximated at the finite boundaries $x=\\pm L$. For large $|x|$, the ODE approximates to $\\tilde{\\psi}'' \\approx k_{\\parallel}^2(x) \\tilde{\\psi}$, which has exponentially growing and decaying solutions $\\tilde{\\psi} \\sim \\exp(\\pm \\int |k_{\\parallel}| dx)$. The decaying solution is selected by imposing Robin boundary conditions:\n$$\n\\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=+L} = -|k_{\\parallel}(+L)|\\,\\tilde{\\psi}(+L) \\quad \\text{and} \\quad \\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=-L} = +|k_{\\parallel}(-L)|\\,\\tilde{\\psi}(-L)\n$$\nSince the definition of $\\Delta'$ involves ratios, the overall normalization of $\\tilde{\\psi}$ is arbitrary. We set $\\tilde{\\psi}(\\pm L) = 1$ for convenience. This fully specifies the initial conditions for a \"shooting\" method.\n\nThe numerical algorithm is implemented as follows:\n$1$. For a given parameter set $(L, s, \\kappa_0, c)$, find the unique rational surface $x_s \\in (-L, L)$ by solving $c\\,x_s^3 + s\\,x_s + \\kappa_0 = 0$.\n$2$. Define the small matching distance $\\epsilon = 10^{-4}$.\n$3$. **Right-side integration:** The first-order system is integrated from $x = L$ down to $x = x_s + \\epsilon$. The initial conditions at $x=L$ are $(\\tilde{\\psi}(L), \\tilde{\\psi}'(L)) = (1, -|k_{\\parallel}(L)|)$. A standard numerical ODE solver, such as a Runge-Kutta method provided by `scipy.integrate.solve_ivp`, is used. The solution vector $(\\tilde{\\psi}(x_s+\\epsilon), \\tilde{\\psi}'(x_s+\\epsilon))$ is obtained.\n$4$. **Left-side integration:** The system is integrated from $x = -L$ up to $x = x_s - \\epsilon$. The initial conditions at $x=-L$ are $(\\tilde{\\psi}(-L), \\tilde{\\psi}'(-L)) = (1, |k_{\\parallel}(-L)|)$. The solution vector $(\\tilde{\\psi}(x_s-\\epsilon), \\tilde{\\psi}'(x_s-\\epsilon))$ is obtained.\n$5$. The stability parameter is then calculated using the numerically determined values at the matching points:\n$$\n\\Delta' \\approx \\frac{\\tilde{\\psi}'(x_s+\\epsilon)}{\\tilde{\\psi}(x_s+\\epsilon)} - \\frac{\\tilde{\\psi}'(x_s-\\epsilon)}{\\tilde{\\psi}(x_s-\\epsilon)}\n$$\nThis procedure is repeated for each of the four test cases specified in the problem statement. The code encapsulates this logic in a reusable function, iterates through the test suite, and formats the results into a single comma-separated list.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef calculate_delta_prime(L, s, kappa0, c):\n    \"\"\"\n    Calculates the tearing stability parameter Delta' for a given slab equilibrium.\n\n    Args:\n        L (float): Half-width of the domain.\n        s (float): Linear shear parameter.\n        kappa0 (float): Offset for the parallel wavenumber.\n        c (float): Cubic shear parameter.\n\n    Returns:\n        float: The calculated Delta' value.\n    \"\"\"\n    # Define the parallel wavenumber and its derivative as functions of x\n    k_par = lambda x: c * x**3 + s * x + kappa0\n    k_par_prime = lambda x: 3 * c * x**2 + s\n\n    # Find the rational surface location xs by finding the roots of the cubic polynomial.\n    # The problem guarantees a single real root exists within the domain (-L, L).\n    coeffs = [c, 0, s, kappa0]\n    roots = np.roots(coeffs)\n    real_roots_in_domain = [\n        r.real for r in roots if abs(r.imag)  1e-9 and -L  r.real  L\n    ]\n    \n    if not real_roots_in_domain:\n        # This should not happen based on the problem statement.\n        raise ValueError(\"No rational surface found in the specified domain.\")\n        \n    xs = real_roots_in_domain[0]\n    \n    epsilon = 1e-4\n\n    # Define the first-order ODE system d/dx(y) = f(x, y) where y = [psi, psi'].\n    def dydx(x, y):\n        psi, psi_prime = y\n        k_val = k_par(x)\n        \n        # A safeguard for division by zero if an integration step lands too close to xs.\n        # The integration limits are designed to avoid xs, but this adds robustness.\n        if abs(k_val)  1e-14:\n            k_val = np.sign(k_val) * 1e-14 if k_val != 0 else 1e-14\n\n        k_prime_val = k_par_prime(x)\n        \n        psi_double_prime = 2 * (k_prime_val / k_val) * psi_prime + k_val**2 * psi\n        return [psi_prime, psi_double_prime]\n\n    # --- Right-hand side integration (from +L down to xs + epsilon) ---\n    x_start_R = float(L)\n    x_end_R = xs + epsilon\n    \n    # Boundary condition at x = +L\n    psi0_R = 1.0\n    psi_prime0_R = -abs(k_par(x_start_R))\n    y0_R = [psi0_R, psi_prime0_R]\n    \n    # solve_ivp handles backward integration (t_span[0] > t_span[1]) automatically.\n    # t_eval forces the solver to return the solution at the specified point.\n    sol_R = solve_ivp(dydx, [x_start_R, x_end_R], y0_R, method='RK45', t_eval=[x_end_R])\n    y_end_R = sol_R.y[:, 0]\n    log_deriv_R = y_end_R[1] / y_end_R[0]\n\n    # --- Left-hand side integration (from -L up to xs - epsilon) ---\n    x_start_L = -float(L)\n    x_end_L = xs - epsilon\n    \n    # Boundary condition at x = -L\n    psi0_L = 1.0\n    psi_prime0_L = abs(k_par(x_start_L))\n    y0_L = [psi0_L, psi_prime0_L]\n    \n    sol_L = solve_ivp(dydx, [x_start_L, x_end_L], y0_L, method='RK45', t_eval=[x_end_L])\n    y_end_L = sol_L.y[:, 0]\n    log_deriv_L = y_end_L[1] / y_end_L[0]\n\n    # Calculate Delta' from the jump in the logarithmic derivative\n    delta_prime = log_deriv_R - log_deriv_L\n    return delta_prime\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement: (L, s, kappa0, c)\n    test_cases = [\n        (5.0, 1.0, 0.0, 0.0),      # Case A\n        (5.0, 0.2, 0.0, 0.0),      # Case B\n        (5.0, 1.0, -4.5, 0.0),     # Case C\n        (4.0, 1.0, 0.0, 0.1),      # Case D\n    ]\n\n    results = []\n    for params in test_cases:\n        delta_prime_result = calculate_delta_prime(*params)\n        results.append(delta_prime_result)\n\n    # Final print statement in the exact required format.\n    # The example output uses 4 decimal places, which we will replicate.\n    print(f\"[{','.join(f'{r:.4f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}