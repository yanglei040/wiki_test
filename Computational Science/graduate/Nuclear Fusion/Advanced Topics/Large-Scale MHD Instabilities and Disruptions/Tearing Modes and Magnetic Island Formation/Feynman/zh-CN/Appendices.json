{
    "hands_on_practices": [
        {
            "introduction": "在分析任何不稳定性时，第一步是确定它可能在何处发生。本练习聚焦于托卡马克芯部至关重要的 $m=1$ 撕裂模。通过将安全因子剖面 $q(r)$ 与等离子体电流分布联系起来，您将计算出 $q=1$ 有理面的位置——这是该模式的滋生地。这个练习还将强化一个物理直觉，即为什么峰化的电流剖面能够为不稳定性提供自由能。",
            "id": "3720911",
            "problem": "一个大环径比、圆形截面的托卡马克，其大半径为 $R_0 = 3.0\\,\\mathrm{m}$，小半径为 $a = 0.75\\,\\mathrm{m}$，外部施加的环向磁场为 $B_{\\phi} = 5.0\\,\\mathrm{T}$ 且在小半径范围内近似均匀，环向等离子体电流密度分布为 $J_{\\phi}(r) = J_0 \\left(1 - \\frac{r^2}{a^2}\\right)$，其中 $0 \\le r \\le a$。测得总等离子体电流为 $I_p = 3.0 \\times 10^6\\,\\mathrm{A}$。假设在大环径比极限下，并忽略Shafranov位移和压强效应。使用麦克斯韦-安培定律和安全因子的几何定义，推导出一个用 $R_0$、$B_{\\phi}$、$I_p$ 和 $a$ 表示的 $q(r)$ 表达式。然后，利用极向模数 $m$ 和环向模数 $n$ 的共振条件，确定 $m=1, n=1$ 撕裂模可以共振的有理面 $r_s$，即满足 $q(r_s) = 1$ 的位置。计算 $r_s$ 的值，并将最终数值结果四舍五入到四位有效数字。用米作单位表示 $r_s$。\n\n此外，从电阻磁流体力学（MHD）框架和磁力线拓扑的核心定义出发，简洁地解释为什么在 $q=1$ 处的有限磁剪切和芯部集中的电流分布能提供触发形成磁岛的电阻性 $m=1$ 撕裂不稳定性所需的自由能和拓扑结构。在你的解释中，使用磁剪切的核心定义 $\\hat{s}(r) \\equiv \\frac{r}{q(r)} \\frac{dq}{dr}$，但不要援引任何预先推导的稳定性判据；你的论证应基于磁剪切如何决定局部磁力线螺距的变化，以及电流梯度如何与电阻性重联耦合。",
            "solution": "该问题分为两部分：一是定量计算 $m=1, n=1$ 有理面的径向位置，二是定性解释驱动电阻性 $m=1$ 撕裂模的物理机制。\n\n首先，我们进行定量计算。目标是找到安全因子 $q(r_s) = 1$ 时的半径 $r_s$。这需要推导安全因子分布 $q(r)$ 的表达式。\n\n在大环径比、圆形截面的托卡马克中，安全因子定义为：\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)}$$\n此处，$r$ 是小径向坐标，$R_0$ 是大半径，$B_{\\phi}$ 是环向磁场，$B_{\\theta}(r)$ 是极向磁场。$B_{\\phi}$ 和 $R_0$ 是给定的常数。我们必须根据给定的环向电流密度分布 $J_{\\phi}(r)$ 来确定 $B_{\\theta}(r)$。\n\n电流密度由 $J_{\\phi}(r) = J_0 \\left(1 - \\frac{r^2}{a^2}\\right)$ 给出，其中 $a$ 是小半径。常数 $J_0$ 与总等离子体电流 $I_p$ 相关。我们通过对 $J_{\\phi}(r)$ 在等离子体截面上积分来找到这个关系：\n$$I_p = \\int_0^a J_{\\phi}(r) \\, 2\\pi r \\, dr = \\int_0^a J_0 \\left(1 - \\frac{r^2}{a^2}\\right) 2\\pi r \\, dr$$\n$$I_p = 2\\pi J_0 \\int_0^a \\left(r - \\frac{r^3}{a^2}\\right) dr = 2\\pi J_0 \\left[ \\frac{r^2}{2} - \\frac{r^4}{4a^2} \\right]_0^a$$\n$$I_p = 2\\pi J_0 \\left( \\frac{a^2}{2} - \\frac{a^4}{4a^2} \\right) = 2\\pi J_0 \\left( \\frac{a^2}{4} \\right) = \\frac{\\pi J_0 a^2}{2}$$\n解出 $J_0$，我们得到：\n$$J_0 = \\frac{2 I_p}{\\pi a^2}$$\n\n接下来，我们使用麦克斯韦-安培定律的积分形式 $\\oint \\vec{B} \\cdot d\\vec{l} = \\mu_0 I_{enc}$ 来求极向磁场 $B_{\\theta}(r)$，其中 $I_{enc}$ 是被半径为 $r$ 的安培环路所包围的电流：\n$$B_{\\theta}(r) \\cdot 2\\pi r = \\mu_0 \\int_0^r J_{\\phi}(r') \\, 2\\pi r' \\, dr'$$\n包围的电流 $I_{enc}(r)$ 是：\n$$I_{enc}(r) = 2\\pi J_0 \\int_0^r \\left(r' - \\frac{r'^3}{a^2}\\right) dr' = 2\\pi J_0 \\left[ \\frac{r'^2}{2} - \\frac{r'^4}{4a^2} \\right]_0^r = 2\\pi J_0 \\left( \\frac{r^2}{2} - \\frac{r^4}{4a^2} \\right)$$\n代入 $J_0$ 的表达式：\n$$I_{enc}(r) = 2\\pi \\left(\\frac{2 I_p}{\\pi a^2}\\right) r^2 \\left( \\frac{1}{2} - \\frac{r^2}{4a^2} \\right) = \\frac{4 I_p r^2}{a^2} \\left( \\frac{2a^2 - r^2}{4a^2} \\right) = \\frac{I_p r^2}{a^4} (2a^2 - r^2)$$\n另一种形式是 $I_{enc}(r) = \\frac{2 I_p r^2}{a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right)$。\n现在，我们求 $B_{\\theta}(r)$：\n$$B_{\\theta}(r) = \\frac{\\mu_0 I_{enc}(r)}{2\\pi r} = \\frac{\\mu_0}{2\\pi r} \\left[ \\frac{2 I_p r^2}{a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right) \\right] = \\frac{\\mu_0 I_p r}{\\pi a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right)$$\n\n现在我们有了写出 $q(r)$ 表达式的所有组成部分：\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)} = \\frac{r B_{\\phi}}{R_0 \\left[ \\frac{\\mu_0 I_p r}{\\pi a^2} \\left( 1 - \\frac{r^2}{2a^2} \\right) \\right]}$$\n$$q(r) = \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} \\frac{1}{1 - \\frac{r^2}{2a^2}}$$\n这就是所要求的 $q(r)$ 的表达式。\n\n$m=1, n=1$ 撕裂模在有理面 $r_s$ 处共振，该处 $q(r_s) = m/n = 1/1 = 1$。我们令 $q(r_s)=1$ 并求解 $r_s$：\n$$1 = \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p \\left( 1 - \\frac{r_s^2}{2a^2} \\right)}$$\n$$1 - \\frac{r_s^2}{2a^2} = \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p}$$\n$$\\frac{r_s^2}{2a^2} = 1 - \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p}$$\n$$r_s^2 = 2a^2 \\left( 1 - \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} \\right)$$\n$$r_s = a \\sqrt{2 \\left( 1 - \\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} \\right)}$$\n\n现在，我们代入给定的数值：$R_0 = 3.0\\,\\mathrm{m}$，$a = 0.75\\,\\mathrm{m}$，$B_{\\phi} = 5.0\\,\\mathrm{T}$，$I_p = 3.0 \\times 10^6\\,\\mathrm{A}$，以及真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{T \\cdot m / A}$。\n让我们计算括号中的无量纲项：\n$$\\frac{\\pi a^2 B_{\\phi}}{\\mu_0 R_0 I_p} = \\frac{\\pi (0.75)^2 (5.0)}{(4\\pi \\times 10^{-7}) (3.0) (3.0 \\times 10^6)} = \\frac{(0.75)^2 \\times 5.0}{4 \\times 10^{-7} \\times 9.0 \\times 10^6} = \\frac{0.5625 \\times 5.0}{3.6} = \\frac{2.8125}{3.6} = 0.78125$$\n该项代表轴上安全因子 $q(0)$。由于 $q(0)  1$，如果 $q$ 随半径增加（对此分布而言确实如此），则必然存在一个 $q=1$ 的磁面。\n现在我们可以计算 $r_s$：\n$$r_s = 0.75 \\sqrt{2 (1 - 0.78125)} = 0.75 \\sqrt{2 (0.21875)} = 0.75 \\sqrt{0.4375}$$\n$$r_s \\approx 0.75 \\times 0.6614378 \\approx 0.49607835\\,\\mathrm{m}$$\n四舍五入到四位有效数字，我们得到 $r_s = 0.4961\\,\\mathrm{m}$。\n\n对于问题的第二部分，我们解释电阻性 $m=1$ 撕裂不稳定性的物理原理。\n\n在托卡马克中，一个集中的电流分布（即电流密度 $J_{\\phi}$ 在磁轴（$r=0$）处最高并随半径减小）与一个更平坦的电流分布状态相比，包含了自由磁能。不稳定性是等离子体通过重新排列其电流和磁场结构向较低能量状态过渡的一种机制。\n\n磁场拓扑由安全因子 $q(r)$ 表征，它衡量磁力线绕极向一圈时所绕的环向圈数。当整数 $m$ 和 $n$ 满足 $q(r_s) = m/n$ 时，该磁面被称为有理面。在这样的磁面上，磁力线是共振的；它们在绕行 $n$ 圈极向和 $m$ 圈环向后会闭合。对于 $m=1, n=1$ 模，这发生在 $q=1$ 的地方。\n\n磁剪切定义为 $\\hat{s}(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$，它衡量磁力线螺距的径向变化率。非零的磁剪切意味着相邻磁通面上的磁力线不平行；它们的螺距角随半径变化。此特性赋予磁场一种“刚度”。在理想磁流体力学（MHD）中，等离子体电导率为无穷大，任何试图交叉连接不同半径磁力线的扰动都会被这种剪切强烈抑制，因为理想的磁冻结效应禁止了磁力线的断开和重联。\n\n然而，任何真实的等离子体都具有有限的电阻率 $\\eta$。虽然电阻率通常很小，其影响在大部分等离子体体积中可以忽略不计，但在有理面周围的一个非常薄的层内，它变得至关重要。考虑一个具有模数 $m=1, n=1$ 的小的初始螺旋扰动。由于磁剪切，这种位移将 $q=1$ 磁面内部（此处 $q1$）的磁力线与外部（此处 $q>1$）的磁力线带到非常近的位置。这些磁力线具有不同的螺距，因此是未对准的。这种未对准在 $r=r_s$ 有理面上产生了一个奇异的、局域化的强电流片。\n\n在这个薄的电阻层内，电阻性欧姆定律 $\\vec{E} + \\vec{v} \\times \\vec{B} = \\eta \\vec{J}$ 表明，在等离子体参考系中，电场不再必须为零。有限的电阻率允许磁通在等离子体中扩散，打破了理想MHD的冻结定律。未对准的磁力线可以“剪切”和“重联”，从而改变磁拓扑结构。\n\n这种重联过程由集中的电流分布提供的自由能驱动。系统可以通过使电流梯度平坦化来释放能量，特别是通过移除 $q1$ 的区域。$m=1$ 撕裂不稳定性通过在 $q=1$ 磁面上形成一个磁岛来完成这一过程。磁岛生长，在“锯齿”现象中，原来的磁轴被排出，成为磁岛的X点，而磁岛的O点成为新的中心。这种剧烈的重排将核心处的热、高电流等离子体迅速向外输运，使原 $q=1$ 半径内的电流和温度分布平坦化，并释放磁能。因此，一个共振有理面（$q=1$）、来自集中电流梯度的自由能源，以及在一个磁剪切局域化薄层内有限电阻率的使能机制，这三者的结合为触发电阻性 $m=1$ 撕裂不稳定性提供了必要条件。",
            "answer": "$$\\boxed{0.4961}$$"
        },
        {
            "introduction": "仅仅找到有理面是不够的；我们还需要确定撕裂模是否会真实地增长。稳定性参数 $\\Delta'$ 是决定这一过程的关键。本练习将引导您超越解析近似，提供一个通过求解有理面周围“外部区域”的理想磁流体动力学（MHD）方程来数值计算 $\\Delta'$ 的实用指南。这是一项进行稳定性分析的核心技能。",
            "id": "3720941",
            "problem": "给定一个用于板状 Grad–Shafranov 平衡中撕裂模的外区理想磁流体力学（MHD）匹配问题的一维磁通对齐公式。目标是使用磁通坐标和在有理面处的收敛定义，数值计算经典的撕裂不稳定性参数 $\\Delta'$。在一个无量纲化系统中进行计算，其中长度单位为 $1/k_y$，场由一个均匀的引导场进行缩放，以使平行波数无量纲。\n\n基本基础：在剪切板状平衡中，扰动螺旋磁通 $\\tilde{\\psi}(x)$ 的外区方程源于线性化的理想磁流体力学（MHD）和磁通冻结（由法拉第定律、安培定律和理想 MHD 的理想欧姆定律 $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$ 导出）。在具有强而均匀的引导场和静态扰动的简化磁流体力学（RMHD）量级下，以磁通坐标 $x$ 表示的外区方程简化为一个 Newcomb 型常微分方程，\n$$\n\\frac{d}{dx}\\left(\\frac{1}{k_{\\parallel}^2(x)}\\frac{d\\tilde{\\psi}}{dx}\\right) - \\tilde{\\psi} = 0,\n$$\n其中 $k_{\\parallel}(x)$ 是由扰动波矢量沿平衡磁场的投影定义的平行波数。有理面的位置 $x_s$ 由 $k_{\\parallel}(x_s) = 0$ 确定；系数在此处有一个一阶极点。不稳定性参数 $\\Delta'$ 定义为对数导数跨越有理面的跳变，\n$$\n\\Delta' \\equiv \\left[\\frac{d}{dx}\\ln \\tilde{\\psi}(x)\\right]_{x \\to x_s^+} - \\left[\\frac{d}{dx}\\ln \\tilde{\\psi}(x)\\right]_{x \\to x_s^-} = \\lim_{\\epsilon \\to 0^+} \\left( \\frac{\\tilde{\\psi}'(x_s + \\epsilon)}{\\tilde{\\psi}(x_s + \\epsilon)} - \\frac{\\tilde{\\psi}'(x_s - \\epsilon)}{\\tilde{\\psi}(x_s - \\epsilon)} \\right).\n$$\n\n您将通过从有理面的两侧积分外区方程来计算 $\\Delta'$，并使用强制远离有理面衰减的边界条件。具体而言：\n\n- 用无量纲的平行波数剖面来模拟平衡和扰动几何\n$$\nk_{\\parallel}(x) = \\kappa_0 + s\\,x + c\\,x^3,\n$$\n其中 $s$ 和 $c$ 是无量纲剪切参数，$\\kappa_0$ 是一个控制有理面位置的无量纲偏移量。对于以下所有测试用例，域为 $x \\in [-L, L]$ 且 $L > 0$。假设在 $(-L, L)$ 内存在唯一一个有理面 $x_s$ 使得 $k_{\\parallel}(x_s) = 0$。\n\n- 在 $x = -L$ 和 $x = +L$ 处施加衰减的外区边界条件，使用微分方程的局部常系数渐近行为：\n对于大的 $|x|$，当 $k_{\\parallel}(x)$ 变化缓慢时，方程简化为 $\\tilde{\\psi}'' - k_{\\parallel}^2(x) \\tilde{\\psi} \\approx 0$，因此衰减解满足\n$$\n\\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=+L} = -|k_{\\parallel}(+L)|\\,\\tilde{\\psi}(+L), \\quad \\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=-L} = +|k_{\\parallel}(-L)|\\,\\tilde{\\psi}(-L).\n$$\n用 $\\tilde{\\psi}(\\pm L) = 1$ 对每一侧进行独立归一化；归一化在定义 $\\Delta'$ 的比率中被抵消。\n\n- 积分与二阶方程等价的一阶系统，\n$$\n\\frac{d}{dx}\n\\begin{pmatrix}\n\\tilde{\\psi} \\\\\n\\tilde{\\psi}'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tilde{\\psi}' \\\\\n2 \\frac{k_{\\parallel}'(x)}{k_{\\parallel}(x)} \\tilde{\\psi}' + k_{\\parallel}^2(x)\\, \\tilde{\\psi}\n\\end{pmatrix},\n$$\n从 $x=+L$ 积分到 $x_s + \\epsilon$，以及从 $x=-L$ 积分到 $x_s - \\epsilon$，其中 $\\epsilon$ 是一个小的正截断值，以防止积分进入奇点。使用 $\\epsilon = 10^{-4}$。然后计算\n$$\n\\Delta'(\\epsilon) = \\left.\\frac{\\tilde{\\psi}'}{\\tilde{\\psi}}\\right|_{x=x_s+\\epsilon} - \\left.\\frac{\\tilde{\\psi}'}{\\tilde{\\psi}}\\right|_{x=x_s-\\epsilon},\n$$\n当 $\\epsilon \\to 0^+$ 时，该值收敛到所需的 $\\Delta'$。\n\n- 将所有最终答案表示为无单位的无量纲十进制浮点数。\n\n实现一个程序，该程序：\n- 通过在给定区间内求解 $k_{\\parallel}(x_s) = 0$ 来定位 $x_s$。\n- 使用上述边界条件和 $\\epsilon = 10^{-4}$ 从两侧积分系统。\n- 计算所定义的 $\\Delta'$。\n\n测试套件：\n为以下参数集 $(L, s, \\kappa_0, c)$ 提供输出：\n- 情况 A（理想情况，线性剪切，中心共振）：$(L, s, \\kappa_0, c) = (5, 1, 0, 0)$。\n- 情况 B（弱剪切，中心共振）：$(L, s, \\kappa_0, c) = (5, 0.2, 0, 0)$。\n- 情况 C（边界附近的共振）：$(L, s, \\kappa_0, c) = (5, 1, -4.5, 0)$。\n- 情况 D（带三次项的非线性剪切，中心共振）：$(L, s, \\kappa_0, c) = (4, 1, 0, 0.1)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，按 $[\\Delta'_A, \\Delta'_B, \\Delta'_C, \\Delta'_D]$ 的顺序对应于情况 A–D。例如：\"[0.1234,0.5678,0.9101,1.1121]\"。不应打印任何其他文本。",
            "solution": "该问题要求计算在给定的磁流体力学（MHD）一维板状模型中，撕裂模的不稳定性参数，记为 $\\Delta'$。解决方法涉及数值求解理想 MHD 外区方程（一个二阶常微分方程），并在方程奇异的有理面上匹配解。\n\n其基本物理原理是，撕裂不稳定性可以在等离子体中的“有理面”处发展，在这些面上，磁力线经过有限圈数后会重新闭合。在我们的板状模型中，这对应于平行波数 $k_{\\parallel}(x_s)$ 为零的位置 $x_s$。远离这个面，在“外区”，等离子体被视为理想导体（理想 MHD），其动力学由扰动螺旋磁通 $\\tilde{\\psi}(x)$ 的方程控制：\n$$\n\\frac{d}{dx}\\left(\\frac{1}{k_{\\parallel}^2(x)}\\frac{d\\tilde{\\psi}}{dx}\\right) - \\tilde{\\psi} = 0\n$$\n该方程在 $x=x_s$ 处是奇异的，因为 $k_{\\parallel}(x_s)=0$。撕裂模理论表明，解 $\\tilde{\\psi}(x)$ 在该面上是连续的，但其导数 $\\tilde{\\psi}'(x)$ 可能不连续。不稳定性参数 $\\Delta'$ 定义为对数导数在该处的跳变：\n$$\n\\Delta' \\equiv \\lim_{\\epsilon \\to 0^+} \\left( \\frac{\\tilde{\\psi}'(x_s + \\epsilon)}{\\tilde{\\psi}(x_s + \\epsilon)} - \\frac{\\tilde{\\psi}'(x_s - \\epsilon)}{\\tilde{\\psi}(x_s - \\epsilon)} \\right)\n$$\n正的 $\\Delta'$ 通常表示等离子体构型对撕裂模不稳定。\n\n算法设计直接遵循这些原理。流程是在两个独立的外区 $( -L, x_s)$ 和 $(x_s, L)$ 中求解常微分方程，然后使用这些解来计算 $\\Delta'$。\n\n首先，将常微分方程重排为适合数值求解器的标准一阶系统。对控制方程应用乘法法则并分离出二阶导数 $\\tilde{\\psi}''$，我们得到系统：\n$$\n\\frac{d}{dx}\n\\begin{pmatrix}\n\\tilde{\\psi} \\\\\n\\tilde{\\psi}'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tilde{\\psi}' \\\\\n2 \\frac{k_{\\parallel}'(x)}{k_{\\parallel}(x)} \\tilde{\\psi}' + k_{\\parallel}^2(x)\\, \\tilde{\\psi}\n\\end{pmatrix}\n$$\n其中 $k_{\\parallel}(x) = \\kappa_0 + s\\,x + c\\,x^3$ 且其导数为 $k_{\\parallel}'(x) = s + 3cx^2$。\n\n有理面位置 $x_s$ 通过求解代数方程 $k_{\\parallel}(x_s) = 0$ 来找到，对于给定形式的 $k_{\\parallel}(x)$，这是一个三次方程。问题保证在域 $x \\in (-L, L)$ 内存在唯一根。该根通过标准的多项式求根算法进行数值求解。\n\n常微分方程必须辅以边界条件。撕裂模在物理上局限于有理面周围；因此，扰动 $\\tilde{\\psi}(x)$ 必须在远离 $x_s$ 的地方衰减。这个衰减条件在有限边界 $x=\\pm L$ 处进行近似。对于大的 $|x|$，常微分方程近似为 $\\tilde{\\psi}'' \\approx k_{\\parallel}^2(x) \\tilde{\\psi}$，它具有指数增长和衰减的解 $\\tilde{\\psi} \\sim \\exp(\\pm \\int |k_{\\parallel}| dx)$。通过施加 Robin 边界条件来选择衰减解：\n$$\n\\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=+L} = -|k_{\\parallel}(+L)|\\,\\tilde{\\psi}(+L) \\quad \\text{和} \\quad \\left.\\frac{d\\tilde{\\psi}}{dx}\\right|_{x=-L} = +|k_{\\parallel}(-L)|\\,\\tilde{\\psi}(-L)\n$$\n由于 $\\Delta'$ 的定义涉及比率，$\\tilde{\\psi}$ 的整体归一化是任意的。为方便起见，我们设置 $\\tilde{\\psi}(\\pm L) = 1$。这完全指定了“打靶法”的初始条件。\n\n数值算法实现如下：\n1. 对于给定的参数集 $(L, s, \\kappa_0, c)$，通过求解 $c\\,x_s^3 + s\\,x_s + \\kappa_0 = 0$ 来找到在 $(-L, L)$ 内的唯一有理面 $x_s$。\n2. 定义小的匹配距离 $\\epsilon = 10^{-4}$。\n3. **右侧积分：** 将一阶系统从 $x = L$ 向下积分到 $x = x_s + \\epsilon$。在 $x=L$ 处的初始条件是 $(\\tilde{\\psi}(L), \\tilde{\\psi}'(L)) = (1, -|k_{\\parallel}(L)|)$。使用标准的数值常微分方程求解器，例如 `scipy.integrate.solve_ivp` 提供的 Runge-Kutta 方法。得到解向量 $(\\tilde{\\psi}(x_s+\\epsilon), \\tilde{\\psi}'(x_s+\\epsilon))$。\n4. **左侧积分：** 将系统从 $x = -L$ 向上积分到 $x = x_s - \\epsilon$。在 $x=-L$ 处的初始条件是 $(\\tilde{\\psi}(-L), \\tilde{\\psi}'(-L)) = (1, |k_{\\parallel}(-L)|)$。得到解向量 $(\\tilde{\\psi}(x_s-\\epsilon), \\tilde{\\psi}'(x_s-\\epsilon))$。\n5. 然后使用在匹配点处数值确定的值计算不稳定性参数：\n$$\n\\Delta' \\approx \\frac{\\tilde{\\psi}'(x_s+\\epsilon)}{\\tilde{\\psi}(x_s+\\epsilon)} - \\frac{\\tilde{\\psi}'(x_s-\\epsilon)}{\\tilde{\\psi}(x_s-\\epsilon)}\n$$\n对问题陈述中指定的四个测试用例中的每一个重复此过程。代码将此逻辑封装在一个可重用的函数中，遍历测试套件，并将结果格式化为单个逗号分隔的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef calculate_delta_prime(L, s, kappa0, c):\n    \"\"\"\n    Calculates the tearing stability parameter Delta' for a given slab equilibrium.\n\n    Args:\n        L (float): Half-width of the domain.\n        s (float): Linear shear parameter.\n        kappa0 (float): Offset for the parallel wavenumber.\n        c (float): Cubic shear parameter.\n\n    Returns:\n        float: The calculated Delta' value.\n    \"\"\"\n    # Define the parallel wavenumber and its derivative as functions of x\n    k_par = lambda x: c * x**3 + s * x + kappa0\n    k_par_prime = lambda x: 3 * c * x**2 + s\n\n    # Find the rational surface location xs by finding the roots of the cubic polynomial.\n    # The problem guarantees a single real root exists within the domain (-L, L).\n    coeffs = [c, 0, s, kappa0]\n    roots = np.roots(coeffs)\n    real_roots_in_domain = [\n        r.real for r in roots if abs(r.imag)  1e-9 and -L  r.real  L\n    ]\n    \n    if not real_roots_in_domain:\n        # This should not happen based on the problem statement.\n        raise ValueError(\"No rational surface found in the specified domain.\")\n        \n    xs = real_roots_in_domain[0]\n    \n    epsilon = 1e-4\n\n    # Define the first-order ODE system d/dx(y) = f(x, y) where y = [psi, psi'].\n    def dydx(x, y):\n        psi, psi_prime = y\n        k_val = k_par(x)\n        \n        # A safeguard for division by zero if an integration step lands too close to xs.\n        # The integration limits are designed to avoid xs, but this adds robustness.\n        if abs(k_val)  1e-14:\n            k_val = np.sign(k_val) * 1e-14 if k_val != 0 else 1e-14\n\n        k_prime_val = k_par_prime(x)\n        \n        psi_double_prime = 2 * (k_prime_val / k_val) * psi_prime + k_val**2 * psi\n        return [psi_prime, psi_double_prime]\n\n    # --- Right-hand side integration (from +L down to xs + epsilon) ---\n    x_start_R = float(L)\n    x_end_R = xs + epsilon\n    \n    # Boundary condition at x = +L\n    psi0_R = 1.0\n    psi_prime0_R = -abs(k_par(x_start_R))\n    y0_R = [psi0_R, psi_prime0_R]\n    \n    # solve_ivp handles backward integration (t_span[0] > t_span[1]) automatically.\n    # t_eval forces the solver to return the solution at the specified point.\n    sol_R = solve_ivp(dydx, [x_start_R, x_end_R], y0_R, method='RK45', t_eval=[x_end_R])\n    y_end_R = sol_R.y[:, 0]\n    log_deriv_R = y_end_R[1] / y_end_R[0]\n\n    # --- Left-hand side integration (from -L up to xs - epsilon) ---\n    x_start_L = -float(L)\n    x_end_L = xs - epsilon\n    \n    # Boundary condition at x = -L\n    psi0_L = 1.0\n    psi_prime0_L = abs(k_par(x_start_L))\n    y0_L = [psi0_L, psi_prime0_L]\n    \n    sol_L = solve_ivp(dydx, [x_start_L, x_end_L], y0_L, method='RK45', t_eval=[x_end_L])\n    y_end_L = sol_L.y[:, 0]\n    log_deriv_L = y_end_L[1] / y_end_L[0]\n\n    # Calculate Delta' from the jump in the logarithmic derivative\n    delta_prime = log_deriv_R - log_deriv_L\n    return delta_prime\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement: (L, s, kappa0, c)\n    test_cases = [\n        (5.0, 1.0, 0.0, 0.0),      # Case A\n        (5.0, 0.2, 0.0, 0.0),      # Case B\n        (5.0, 1.0, -4.5, 0.0),     # Case C\n        (4.0, 1.0, 0.0, 0.1),      # Case D\n    ]\n\n    results = []\n    for params in test_cases:\n        delta_prime_result = calculate_delta_prime(*params)\n        results.append(delta_prime_result)\n\n    # Final print statement in the exact required format.\n    # The example output uses 4 decimal places, which we will replicate.\n    print(f\"[{','.join(f'{r:.4f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "撕裂模的稳定性（由 $\\Delta'$ 量化）不仅是等离子体的内在属性，也受其周围环境的影响。本练习探讨了导电真空室所起的关键作用。您将推导有限电阻壁如何改变等离子体边界处的磁场边界条件，从而改变 $\\Delta'$ 值并影响模式的增长。这展示了一种被动控制机制，并突出了等离子体与其工程环境之间的相互作用。",
            "id": "3720985",
            "problem": "考虑一个半径为 $a$ 的直、圆形、低贝塔等离子体柱，其被真空包围，并带有一个内半径为 $b$（其中 $b > a$）、厚度为 $d_w \\ll b$、均匀电导率为 $\\sigma_w$ 的薄圆柱形导电壁。设扰动磁场由一个轴对称矢量势分量 $A_z$ 表示，该分量具有单一的螺旋傅里叶谐波，\n$$\nA_z(r,\\theta,z,t) \\equiv \\psi(r)\\,\\exp\\!\\big(\\gamma t + i m \\theta - i n z/R\\big),\n$$\n其中 $m \\in \\mathbb{Z}^+$ 是角向模数，$n \\in \\mathbb{Z}$ 是环向模数，$R$ 是大半径（假设 $R \\gg a$，因此柱坐标几何是合适的），$\\gamma$ 是一个实数增长率。假设在等离子体外部（对于 $r \\ge a$）没有平衡电流，也没有等离子体，因此该外部区域的扰动磁场由真空麦克斯韦方程组确定。在库仑规范下工作，并选择静电势，使得在真空和壁中的扰动 $\\phi = 0$，因此电场由 $\\mathbf{E} = -\\partial \\mathbf{A}/\\partial t$ 给出。\n\n在外部真空区域，螺旋相关性使得标量流函数 $\\psi(r)$ 成为极坐标下二维拉普拉斯方程的一个解，因此在任何真空子区间上，它都可以写成幂律 $r^{m}$ 和 $r^{-m}$ 的线性组合。相关的磁场分量由 $\\mathbf{B} = \\nabla \\times (A_z \\hat{\\mathbf{z}})$ 得出，特别是，角向磁场为 $B_\\theta = -\\partial_r A_z = -\\psi'(r)$，径向磁场为 $B_r = \\frac{i m}{r}\\,\\psi(r)$。\n\n在薄壁中，使用静止导体的欧姆定律 $J_z = \\sigma_w E_z$，并通过 $K_z = d_w J_z$ 将表面电流 $K_z$ 与电场联系起来。麦克斯韦-安培定律意味着穿过壁的角向磁场跳变等于 $\\mu_0$ 乘以表面电流：$B_\\theta(b^+) - B_\\theta(b^-) = \\mu_0 K_z$。定义电阻壁时间\n$$\n\\tau_w \\equiv \\mu_0 \\sigma_w d_w b.\n$$\n\n假设对于 $r > b$，真空解在无穷远处衰减，因此在壁外只存在 $r^{-m}$ 行为。将等离子体内部（$r  a$）视为不受外部和壁物理性质的影响，因此壁对撕裂模不稳定性匹配参数 $\\Delta'$ 的影响仅通过 $r=a$ 处的外部-真空对数导数进入。\n\n使用上述基本定律和定义，推导由有限电阻率壁所隐含的在 $r=b$ 处 $\\psi(r)$ 的修正磁边界条件，求解外部真空问题以表示等离子体表面的对数导数，然后计算仅由外部区域引起的匹配参数的变化，\n$$\n\\delta \\Delta' \\equiv \\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{with wall}} - \\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{no wall}}.\n$$\n将您的最终答案表示为关于 $m$、$a$、$b$、$\\gamma$ 和 $\\tau_w$ 的单一闭合形式解析表达式。不需要进行数值计算。最终表达式中不要包含任何单位。答案必须是单一的解析表达式。",
            "solution": "该问题要求计算由于在 $r=b$ 处存在电阻壁，导致等离子体表面 $r=a$ 处螺旋磁通函数 $\\psi(r)$ 的外部对数导数的变化。这个变化表示为 $\\delta \\Delta'$。\n\n我们将外部区域分为三部分：\n1.  真空区域 I：$a \\le r  b$（等离子体与壁之间）\n2.  位于 $r=b$ 处的薄电阻壁\n3.  真空区域 II：$r > b$（壁外）\n\n在真空区域，螺旋磁通函数 $\\psi(r)$ 满足方程 $\\nabla^2 A_z = 0$，对于单一的 $(m,n)$ 谐波，在柱坐标系下该方程简化为关于 $\\psi(r)$ 的欧拉型常微分方程。其通解是 $r^m$ 和 $r^{-m}$ 的线性组合。\n\n在真空区域 I（$a \\le r  b$），解是这两项的组合：\n$$\n\\psi_I(r) = C_1 r^m + C_2 r^{-m}\n$$\n其中 $C_1$ 和 $C_2$ 是常数。\n\n在真空区域 II（$r > b$），解必须在 $r \\to \\infty$ 时衰减。因此，我们必须舍弃 $r^m$ 项：\n$$\n\\psi_{II}(r) = C_3 r^{-m}\n$$\n其中 $C_3$ 是常数。\n\n在 $r=b$ 处的电阻壁的物理条件提供了连接这些解所必需的边界条件。\n首先，径向磁场 $B_r = \\frac{1}{r} \\frac{\\partial A_z}{\\partial \\theta} = \\frac{im}{r} \\psi(r) \\exp(\\dots)$ 必须在壁的两侧是连续的。这意味着 $\\psi(r)$ 在 $r=b$ 处必须是连续的：\n$$\n\\psi_I(b) = \\psi_{II}(b) \\equiv \\psi(b)\n$$\n这给出了系数之间的一个关系：\n$$\nC_1 b^m + C_2 b^{-m} = C_3 b^{-m} \\implies C_3 = C_1 b^{2m} + C_2\n$$\n\n其次，我们使用穿过壁的角向磁场 $B_\\theta$ 的跳变条件，该条件由安培定律给出。在薄壁近似下，此条件为 $B_\\theta(b^+) - B_\\theta(b^-) = \\mu_0 K_z$，其中 $K_z$ 是壁中的表面电流密度。角向场为 $B_\\theta = -\\partial_r A_z = -\\psi'(r)\\exp(\\dots)$。因此，我们有：\n$$\n(-\\psi'_{II}(b)) - (-\\psi'_I(b)) = \\mu_0 K_z \\implies \\psi'_I(b) - \\psi'_{II}(b) = \\mu_0 K_z\n$$\n表面电流 $K_z$ 可通过壁中的欧姆定律求得。问题陈述我们可以忽略静电势，因此电场为 $\\mathbf{E} = -\\partial \\mathbf{A}/\\partial t$。对于给定的扰动形式 $A_z(r, \\theta, z, t) = \\psi(r) \\exp(\\gamma t + i m \\theta - i n z/R)$，壁处的轴向电场为 $E_z = -\\gamma A_z(b) = -\\gamma \\psi(b) \\exp(\\dots)$。\n体电流密度为 $J_z = \\sigma_w E_z = -\\sigma_w \\gamma \\psi(b) \\exp(\\dots)$。\n表面电流为 $K_z = d_w J_z = -d_w \\sigma_w \\gamma \\psi(b) \\exp(\\dots)$。\n将此代入 $\\psi'$ 的跳变条件并消去指数因子，得到：\n$$\n\\psi'_I(b) - \\psi'_{II}(b) = -\\mu_0 d_w \\sigma_w \\gamma \\psi(b)\n$$\n使用电阻壁时间的定义 $\\tau_w \\equiv \\mu_0 \\sigma_w d_w b$，我们可以写出 $\\mu_0 d_w \\sigma_w = \\tau_w/b$。跳变条件变为：\n$$\n\\psi'_I(b) - \\psi'_{II}(b) = -\\frac{\\gamma \\tau_w}{b} \\psi(b)\n$$\n我们可以通过除以 $\\psi(b) = \\psi_I(b) = \\psi_{II}(b)$ 将其表示为对数导数的形式：\n$$\n\\frac{\\psi'_I(b)}{\\psi_I(b)} - \\frac{\\psi'_{II}(b)}{\\psi_{II}(b)} = -\\frac{\\gamma \\tau_w}{b}\n$$\n对于外部真空解 $\\psi_{II}(r) = C_3 r^{-m}$，对数导数为 $\\psi'_{II}(r)/\\psi_{II}(r) = -m/r$。在 $r=b$ 处，其值为 $-m/b$。将此代入跳变条件，得到内层真空解在壁处的边界条件：\n$$\n\\frac{\\psi'_I(b)}{\\psi_I(b)} - \\left(-\\frac{m}{b}\\right) = -\\frac{\\gamma \\tau_w}{b} \\implies \\frac{\\psi'_I(b)}{\\psi_I(b)} = -\\frac{m + \\gamma \\tau_w}{b}\n$$\n现在，我们将 $r=b$ 处的这个条件与 $r=a$ 处所需量联系起来。对于内层真空解 $\\psi_I(r) = C_1 r^m + C_2 r^{-m}$，其对数导数为：\n$$\n\\frac{\\psi'_I(r)}{\\psi_I(r)} = \\frac{m C_1 r^{m-1} - m C_2 r^{-m-1}}{C_1 r^m + C_2 r^{-m}} = \\frac{m}{r} \\frac{(C_1/C_2)r^{2m} - 1}{(C_1/C_2)r^{2m} + 1}\n$$\n我们定义一个量 $X(r) = (C_1/C_2)r^{2m}$。在 $r=b$ 处，我们有：\n$$\n-\\frac{m+\\gamma\\tau_w}{b} = \\frac{m}{b} \\frac{X(b) - 1}{X(b) + 1}\n$$\n求解 $X(b)$：\n$$\n-(m+\\gamma\\tau_w)(X(b)+1) = m(X(b)-1)\n$$\n$$\n-m X(b) - m - \\gamma\\tau_w X(b) - \\gamma\\tau_w = m X(b) - m\n$$\n$$\n- (2m + \\gamma\\tau_w) X(b) = \\gamma\\tau_w \\implies X(b) = -\\frac{\\gamma\\tau_w}{2m + \\gamma\\tau_w}\n$$\n我们需要 $r=a$ 处的对数导数，它依赖于 $X(a)$。我们通过将其与 $X(b)$ 关联来找到 $X(a)$：\n$$\nX(a) = \\frac{C_1}{C_2} a^{2m} = \\left(\\frac{C_1}{C_2} b^{2m}\\right) \\left(\\frac{a}{b}\\right)^{2m} = X(b) \\left(\\frac{a}{b}\\right)^{2m}\n$$\n所以，$X(a) = -\\frac{\\gamma\\tau_w}{2m + \\gamma\\tau_w} \\left(\\frac{a}{b}\\right)^{2m}$。\n\n有壁情况下，等离子体表面的对数导数为：\n$$\n\\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{with wall}} = \\frac{\\psi'_I(a)}{\\psi_I(a)} = \\frac{m}{a} \\frac{X(a)-1}{X(a)+1}\n$$\n代入 $X(a)$ 的表达式：\n$$\n\\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{with wall}} = \\frac{m}{a} \\frac{-\\frac{\\gamma\\tau_w}{2m + \\gamma\\tau_w}\\left(\\frac{a}{b}\\right)^{2m} - 1}{-\\frac{\\gamma\\tau_w}{2m + \\gamma\\tau_w}\\left(\\frac{a}{b}\\right)^{2m} + 1} = \\frac{m}{a} \\frac{-\\gamma\\tau_w(a/b)^{2m} - (2m + \\gamma\\tau_w)}{-\\gamma\\tau_w(a/b)^{2m} + (2m + \\gamma\\tau_w)}\n$$\n$$\n= \\frac{m}{a} \\frac{-2m - \\gamma\\tau_w\\left[1 + (a/b)^{2m}\\right]}{2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]} = -\\frac{m}{a} \\frac{2m + \\gamma\\tau_w\\left[1 + (a/b)^{2m}\\right]}{2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]}\n$$\n接下来，我们确定“无壁”情况下的对数导数。这对应于所有 $r>a$ 的区域都是真空。解必须在无穷远处衰减，因此必须有 $C_1=0$。解为 $\\psi(r) = C_2 r^{-m}$ (对于 $r \\ge a$)。对数导数为：\n$$\n\\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{no wall}} = \\frac{-m C_2 a^{-m-1}}{C_2 a^{-m}} = -\\frac{m}{a}\n$$\n最后，我们计算变化量 $\\delta \\Delta'$：\n$$\n\\delta \\Delta' = \\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{with wall}} - \\left[\\frac{\\psi'(a)}{\\psi(a)}\\right]_{\\text{no wall}}\n$$\n$$\n\\delta \\Delta' = \\left(-\\frac{m}{a} \\frac{2m + \\gamma\\tau_w\\left[1 + (a/b)^{2m}\\right]}{2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]}\\right) - \\left(-\\frac{m}{a}\\right)\n$$\n$$\n\\delta \\Delta' = \\frac{m}{a} \\left(1 - \\frac{2m + \\gamma\\tau_w\\left[1 + (a/b)^{2m}\\right]}{2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]}\\right)\n$$\n将所有项通分：\n$$\n\\delta \\Delta' = \\frac{m}{a} \\frac{\\left(2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]\\right) - \\left(2m + \\gamma\\tau_w\\left[1 + (a/b)^{2m}\\right]\\right)}{2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]}\n$$\n分子简化为：\n$$\n(2m + \\gamma\\tau_w - \\gamma\\tau_w(a/b)^{2m}) - (2m + \\gamma\\tau_w + \\gamma\\tau_w(a/b)^{2m}) = -2\\gamma\\tau_w(a/b)^{2m}\n$$\n因此，$\\delta \\Delta'$ 的最终表达式为：\n$$\n\\delta \\Delta' = \\frac{m}{a} \\frac{-2\\gamma\\tau_w(a/b)^{2m}}{2m + \\gamma\\tau_w\\left[1 - (a/b)^{2m}\\right]} = -\\frac{2m\\gamma\\tau_w}{a} \\frac{(a/b)^{2m}}{2m + \\gamma\\tau_w(1 - (a/b)^{2m})}\n$$",
            "answer": "$$\n\\boxed{-\\frac{2m\\gamma\\tau_w}{a} \\frac{\\left(\\frac{a}{b}\\right)^{2m}}{2m + \\gamma\\tau_w\\left(1 - \\left(\\frac{a}{b}\\right)^{2m}\\right)}}\n$$"
        }
    ]
}