{
    "hands_on_practices": [
        {
            "introduction": "Before a pellet can mitigate a disruption, it must be shattered into a cloud of small fragments. This first exercise explores the fundamental mechanics of this process, a critical first step in the Shattered Pellet Injection (SPI) sequence. By applying principles of momentum and energy conservation, you will derive the statistical properties of the resulting fragment cloud, providing a foundational understanding of the initial conditions for material assimilation into the plasma .",
            "id": "3694990",
            "problem": "A deuterium pellet used for Shattered Pellet Injection (SPI) in disruption mitigation in a tokamak travels with speed $v$ along the normal to a rigid, anchored shatter plate. The pellet has mass $m$ and breaks into a very large number $N$ of fragments upon impact. Assume the following idealizations grounded in first principles:\n\n- Conservation of linear momentum applies to the pellet–plate–fragment system. Because the shatter plate is rigid and anchored, it can absorb net momentum, so the ensemble of fragments does not need to carry the incident momentum.\n- Define the fragmentation efficiency $\\eta \\in (0,1)$ as the fraction of the incident pellet kinetic energy that ends up as translational kinetic energy of the fragments; the remainder is dissipated into plate deformation, thermal energy, and internal fragment excitation.\n- The fragment velocities are isotropically dispersed and can be modeled as independent, identically distributed random vectors with zero ensemble mean and equal variance $\\sigma^{2}$ in each Cartesian component. Let the incident direction be the $+x$ axis.\n\nStarting only from conservation of linear momentum, the definition of kinetic energy, and the stated modeling assumptions, derive analytic expressions for the mean and the variance of the $x$-component of the fragment velocity distribution. Provide your final answer as a row matrix with two entries, $\\big[$mean, variance$\\big]$. Express the mean in $\\mathrm{m/s}$ and the variance in $(\\mathrm{m/s})^{2}$. No numerical values are required; give your answer in closed form in terms of $v$ and $\\eta$.",
            "solution": "Let the velocity of a fragment be the random vector $\\vec{v} = (v_x, v_y, v_z)$. The problem states that the fragment velocities are isotropically dispersed with a zero ensemble mean. The mean of any component, such as the $x$-component $\\langle v_x \\rangle$, must therefore be zero.\n$$ \\langle v_x \\rangle = 0 $$\nThe variance of the $x$-component is defined as $\\sigma_x^2 = \\langle (v_x - \\langle v_x \\rangle)^2 \\rangle$. Since the mean is zero, this simplifies to the mean of the squared velocity component:\n$$ \\sigma_x^2 = \\langle v_x^2 \\rangle $$\nDue to the isotropic distribution, the variances along each Cartesian axis are equal: $\\sigma_x^2 = \\sigma_y^2 = \\sigma_z^2$. This means $\\langle v_x^2 \\rangle = \\langle v_y^2 \\rangle = \\langle v_z^2 \\rangle$.\nThe mean squared speed of the fragments is the sum of the mean squared components:\n$$ \\langle |\\vec{v}|^2 \\rangle = \\langle v_x^2 + v_y^2 + v_z^2 \\rangle = \\langle v_x^2 \\rangle + \\langle v_y^2 \\rangle + \\langle v_z^2 \\rangle = 3 \\langle v_x^2 \\rangle = 3 \\sigma_x^2 $$\nNext, we apply energy conservation. The incident kinetic energy of the pellet of mass $m$ and speed $v$ is $K_{in} = \\frac{1}{2} m v^2$. A fraction $\\eta$ of this energy is converted into the translational kinetic energy of the fragments, $K_f$.\n$$ K_f = \\eta K_{in} = \\frac{1}{2} \\eta m v^2 $$\nThe total kinetic energy of the fragments is also given by the total mass $m$ times the average kinetic energy per unit mass, which is $\\frac{1}{2} \\langle |\\vec{v}|^2 \\rangle$:\n$$ K_f = \\frac{1}{2} m \\langle |\\vec{v}|^2 \\rangle $$\nEquating the two expressions for $K_f$:\n$$ \\frac{1}{2} m \\langle |\\vec{v}|^2 \\rangle = \\frac{1}{2} \\eta m v^2 $$\nThis gives the mean squared speed of the fragments:\n$$ \\langle |\\vec{v}|^2 \\rangle = \\eta v^2 $$\nFinally, we substitute this into our earlier relation for the variance:\n$$ 3\\sigma_x^2 = \\eta v^2 $$\nSolving for the variance of the $x$-component yields:\n$$ \\sigma_x^2 = \\frac{\\eta v^2}{3} $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\eta v^2}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once created, fragments travel into the hot plasma and begin to ablate, releasing their material to cool the plasma and prevent damage. This exercise delves into the core process of ablation, challenging you to model how a fragment's size evolves under a time-varying plasma heat flux. Solving this problem is key to predicting penetration depth and the spatial distribution of the mitigating impurities, which are crucial factors for successful disruption mitigation .",
            "id": "3695001",
            "problem": "Consider a fragment produced by Shattered Pellet Injection (SPI) moving radially inward in a magnetically confined plasma. The fragment is modeled as a uniform-density sphere of radius $r(t)$ and solid mass density $\\rho_{s}$. The fragment ablates due to an incident time-dependent electron heat flux $q(t)$ deposited onto its surface. Assume that the deposited thermal power is locally absorbed by the fragment and entirely consumed to remove mass at an effective specific ablation enthalpy $h_{a}$, which accounts for heating from the initial temperature to the ablation temperature, phase change, and ionization. Neglect radiative losses from the fragment itself and any re-deposition. The fragment’s radial speed $v_{r}$ is assumed constant during the ablation process.\n\nStarting from conservation of energy and mass, derive the governing equation for the fragment radius $r(t)$ during ablation, and integrate it to find the time $t_{a}$ at which $r(t_{a})=0$. Then, compute the radial penetration distance $x_{a}=\\int_{0}^{t_{a}} v_{r}\\,\\mathrm{d}t$.\n\nTo make the time dependence explicit, take the incident heat flux to be\n$$\nq(t)=q_{0}\\left(1+\\frac{t}{\\tau}\\right)^{-\\gamma},\n$$\nwith constants $q_{0}0$, $\\tau0$, and $0\\gamma1$ representing a physically plausible decay of the heat flux due to the growth of a shielding cloud and global cooling during mitigation. The fragment enters the plasma at $t=0$ with initial radius $r(0)=r_{0}0$. Express your final answers $t_{a}$ and $x_{a}$ in closed form in terms of $r_{0}$, $\\rho_{s}$, $h_{a}$, $q_{0}$, $\\tau$, $\\gamma$, and $v_{r}$. Your final answers must be analytical expressions. Do not include any numerical approximations.",
            "solution": "Let $m(t)$ be the mass of the spherical fragment at time $t$. The mass is related to the radius $r(t)$ and the constant solid density $\\rho_s$ by:\n$$ m(t) = \\rho_s V(t) = \\rho_s \\frac{4}{3}\\pi [r(t)]^3 $$\nThe rate of change of mass is found by differentiating with respect to time:\n$$ \\frac{dm}{dt} = \\frac{d}{dt} \\left( \\rho_s \\frac{4}{3}\\pi [r(t)]^3 \\right) = \\rho_s \\frac{4}{3}\\pi \\cdot 3[r(t)]^2 \\frac{dr}{dt} = 4\\pi \\rho_s [r(t)]^2 \\frac{dr}{dt} $$\nThe rate of energy deposition (power) onto the fragment's surface, $P_{dep}$, is the product of the incident heat flux $q(t)$ and the surface area of the sphere, $A(t) = 4\\pi [r(t)]^2$:\n$$ P_{dep}(t) = q(t) A(t) = 4\\pi [r(t)]^2 q(t) $$\nThis deposited power is entirely consumed by the ablation process. The power required for ablation, $P_{abl}$, is the product of the specific ablation enthalpy $h_a$ and the mass ablation rate, which is $-\\frac{dm}{dt}$ (since mass is decreasing, $\\frac{dm}{dt}$ is negative).\n$$ P_{abl}(t) = -h_a \\frac{dm}{dt} $$\nThe principle of energy conservation states that $P_{dep}(t) = P_{abl}(t)$:\n$$ 4\\pi [r(t)]^2 q(t) = -h_a \\frac{dm}{dt} $$\nSubstituting the expression for $\\frac{dm}{dt}$:\n$$ 4\\pi [r(t)]^2 q(t) = -h_a \\left( 4\\pi \\rho_s [r(t)]^2 \\frac{dr}{dt} \\right) $$\nFor $r(t)  0$, we can divide both sides by $4\\pi [r(t)]^2$, which yields the governing ordinary differential equation for the fragment radius:\n$$ q(t) = -\\rho_s h_a \\frac{dr}{dt} $$\n$$ \\frac{dr}{dt} = -\\frac{q(t)}{\\rho_s h_a} $$\nNow, we substitute the given functional form for the heat flux, $q(t)=q_{0}\\left(1+\\frac{t}{\\tau}\\right)^{-\\gamma}$:\n$$ \\frac{dr}{dt} = -\\frac{q_{0}}{\\rho_s h_a} \\left(1+\\frac{t}{\\tau}\\right)^{-\\gamma} $$\nThis is a separable first-order differential equation. We can solve for the total ablation time $t_a$ by integrating from the initial state ($t=0$, $r=r_0$) to the final state where the fragment is fully ablated ($t=t_a$, $r=0$).\n$$ \\int_{r(0)}^{r(t_a)} dr = \\int_{0}^{t_a} -\\frac{q_{0}}{\\rho_s h_a} \\left(1+\\frac{t'}{\\tau}\\right)^{-\\gamma} dt' $$\nPlugging in the boundary conditions for the radius, $r(0)=r_0$ and $r(t_a)=0$:\n$$ \\int_{r_{0}}^{0} dr = -\\frac{q_{0}}{\\rho_s h_a} \\int_{0}^{t_a} \\left(1+\\frac{t'}{\\tau}\\right)^{-\\gamma} dt' $$\nThe left-hand side evaluates to:\n$$ [r]_{r_{0}}^{0} = 0 - r_0 = -r_0 $$\nThe integral on the right-hand side is:\n$$ \\int_{0}^{t_a} \\left(1+\\frac{t'}{\\tau}\\right)^{-\\gamma} dt' = \\left[ \\frac{\\tau}{1-\\gamma} \\left(1+\\frac{t'}{\\tau}\\right)^{1-\\gamma} \\right]_{0}^{t_a} $$\nThe condition $0  \\gamma  1$ ensures that the denominator $1-\\gamma$ is not zero. Evaluating the integral at the limits:\n$$ = \\frac{\\tau}{1-\\gamma} \\left[ \\left(1+\\frac{t_a}{\\tau}\\right)^{1-\\gamma} - \\left(1+\\frac{0}{\\tau}\\right)^{1-\\gamma} \\right] = \\frac{\\tau}{1-\\gamma} \\left[ \\left(1+\\frac{t_a}{\\tau}\\right)^{1-\\gamma} - 1 \\right] $$\nSubstituting these results back into the integrated equation:\n$$ -r_0 = -\\frac{q_{0}}{\\rho_s h_a} \\cdot \\frac{\\tau}{1-\\gamma} \\left[ \\left(1+\\frac{t_a}{\\tau}\\right)^{1-\\gamma} - 1 \\right] $$\nWe now solve for $t_a$. First, cancel the negative signs and rearrange the terms:\n$$ r_0 = \\frac{q_{0} \\tau}{\\rho_s h_a (1-\\gamma)} \\left[ \\left(1+\\frac{t_a}{\\tau}\\right)^{1-\\gamma} - 1 \\right] $$\n$$ \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau} = \\left(1+\\frac{t_a}{\\tau}\\right)^{1-\\gamma} - 1 $$\n$$ 1 + \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau} = \\left(1+\\frac{t_a}{\\tau}\\right)^{1-\\gamma} $$\nTo isolate $t_a$, we raise both sides to the power of $\\frac{1}{1-\\gamma}$:\n$$ \\left[1 + \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau}\\right]^{\\frac{1}{1-\\gamma}} = 1+\\frac{t_a}{\\tau} $$\nFinally, solving for the ablation time $t_a$:\n$$ t_a = \\tau \\left( \\left[1 + \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau}\\right]^{\\frac{1}{1-\\gamma}} - 1 \\right) $$\nThe radial penetration distance $x_a$ is the distance traveled by the fragment at a constant radial speed $v_r$ during the ablation time $t_a$:\n$$ x_a = \\int_{0}^{t_a} v_r dt = v_r t_a $$\nSubstituting the expression for $t_a$:\n$$ x_a = v_r \\tau \\left( \\left[1 + \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau}\\right]^{\\frac{1}{1-\\gamma}} - 1 \\right) $$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\tau \\left( \\left(1 + \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau}\\right)^{\\frac{1}{1-\\gamma}} - 1 \\right)  v_r \\tau \\left( \\left(1 + \\frac{r_0 \\rho_s h_a (1-\\gamma)}{q_0 \\tau}\\right)^{\\frac{1}{1-\\gamma}} - 1 \\right) \\end{pmatrix}}$$"
        },
        {
            "introduction": "The final practice integrates the preceding physical concepts into a coherent, system-level model for designing a real-world disruption mitigation system. This exercise asks you to implement a zero-dimensional (0D) model to estimate the required impurity mass for a large tokamak like ITER. You will navigate the critical engineering trade-off between radiating sufficient energy to cool the plasma and raising the electron density to suppress runaway electrons, offering a practical perspective on the design of fusion safety systems .",
            "id": "3695067",
            "problem": "Implement a zero-dimensional (0D) disruption mitigation model for impurity shattered pellet injection (SPI) in the International Thermonuclear Experimental Reactor (ITER). The goal is to compute the minimum injected impurity mass that simultaneously satisfies a target radiated energy fraction during the thermal quench and a target post-thermal-quench free-electron density, and to compare this model-based mass to a simple current-device linear scaling of injected mass with thermal energy.\n\nAssumptions and foundational principles that must be used:\n- Use first-principles energy accounting and optically thin plasma radiation. Model the total plasma thermal energy as $W_{\\text{th}}$ under the simplifying assumption $T_{\\text{e},0} \\approx T_{\\text{i},0} \\equiv T_0$ and singly charged main ions, so that quasineutrality implies $n_{\\text{i},0} \\approx n_{\\text{e},0}$. A consistent approximation is therefore\n$$\nW_{\\text{th}} \\approx 3\\, n_{\\text{e},0}\\, T_0\\, V,\n$$\nwhere $T_0$ is in joules.\n- The target radiated energy is $E_{\\text{rad,target}} = f_{\\text{rad}}\\, W_{\\text{th}}$, with $f_{\\text{rad}} \\in (0,1)$.\n- The optically thin impurity line radiation power density is $P_{\\text{rad}}/V = n_{\\text{e}}\\, n_z \\, \\overline{L}_z$, using an effective, quench-averaged cooling coefficient $\\overline{L}_z$ with units of watts-meter-cubed.\n- Use a single assimilation efficiency $0 \\le \\eta \\le 1$ for injected material into the radiating, current-carrying plasma volume, so that the assimilated impurity particle number is $\\eta\\, N_{\\text{inj}}$.\n- Adopt a single effective ionization degree for the impurity during the relevant phase, $\\overline{Z}_{\\text{ion}}$, so that free-electron density contributed by impurities is $\\Delta n_{\\text{e}} \\approx \\eta\\, N_{\\text{inj}} \\, \\overline{Z}_{\\text{ion}}/V$.\n- Assume a characteristic thermal-quench time $ \\tau_{\\text{TQ}}$ over which radiation acts with a representative electron density $n_{\\text{e,avg}}$ appropriate to the mitigation target.\n\nRequired derivation targets, from the above base only (do not use any pre-baked engineering correlations not stated above):\n- From $P_{\\text{rad}} = n_{\\text{e}}\\, n_z \\, \\overline{L}_z \\, V$ and the assimilation model, derive a radiative constraint on $N_{\\text{inj}}$ by equating the time-integrated radiated energy to $E_{\\text{rad,target}}$. Your final expression must be in terms of $f_{\\text{rad}}$, $W_{\\text{th}}$, $\\eta$, $\\overline{L}_z$, $n_{\\text{e,avg}}$, and $\\tau_{\\text{TQ}}$.\n- From the free-electron density requirement $n_{\\text{e,post}} \\ge n_{\\text{e},0} + \\Delta n_{\\text{e}}$, derive a density constraint on $N_{\\text{inj}}$ in terms of $n_{\\text{e,post}}$, $n_{\\text{e},0}$, $V$, $\\eta$, and $\\overline{Z}_{\\text{ion}}$.\n- The required injected particle number is the maximum of the radiative and density requirements. Convert this to a mass using the impurity atomic mass $m_{\\text{atom}}$.\n\nComparison to current-device scaling:\n- Define a simple current-device linear scaling for required mass, $M_{\\text{scaled}}$, by normalizing to a reference dataset characterized by $(W_{\\text{ref}}, M_{\\text{ref}}, f_{\\text{rad,ref}})$:\n$$\nM_{\\text{scaled}} = M_{\\text{ref}} \\times \\frac{W_{\\text{th}}}{W_{\\text{ref}}} \\times \\frac{f_{\\text{rad}}}{f_{\\text{rad,ref}}}.\n$$\n- Compute the dimensionless ratio $r \\equiv M_{\\text{model}}/M_{\\text{scaled}}$.\n\nImplementation instructions:\n- Implement a program that, for each test case in the suite below, computes $W_{\\text{th}}$ in joules using $T_0$ given in electron-volts via the conversion $1\\,\\text{eV} = e\\,\\text{J}$, where $e = 1.602176634\\times 10^{-19}\\,\\text{J/eV}$. Then compute:\n    - $M_{\\text{model}}$ in grams, from the maximum of the radiative and density constraints.\n    - $M_{\\text{scaled}}$ in grams, from the reference scaling.\n    - $r = M_{\\text{model}}/M_{\\text{scaled}}$.\n- For numerical evaluation, use $n_{\\text{e,avg}} = n_{\\text{e,post}}$.\n\nUnits and output requirements:\n- Express $M_{\\text{model}}$ in grams, $M_{\\text{scaled}}$ in grams, and $r$ as a dimensionless float. Round all outputs to three significant figures.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is a list of three floats in the order $[M_{\\text{model}}\\ \\text{(g)}, M_{\\text{scaled}}\\ \\text{(g)}, r]$.\n\nTest suite (each case is a tuple of parameters in the order: impurity mass $m_{\\text{atom}}$ (kg), effective ionization $\\overline{Z}_{\\text{ion}}$ (dimensionless), $\\overline{L}_z$ (W m$^3$), assimilation $\\eta$ (dimensionless), initial electron density $n_{\\text{e},0}$ (m$^{-3}$), initial temperature $T_0$ (eV), volume $V$ (m$^3$), target radiated fraction $f_{\\text{rad}}$ (dimensionless), post-quench density target $n_{\\text{e,post}}$ (m$^{-3}$), thermal quench time $\\tau_{\\text{TQ}}$ (s), reference $W_{\\text{ref}}$ (J), reference $M_{\\text{ref}}$ (g), reference $f_{\\text{rad,ref}}$ (dimensionless)):\n- Case A (Neon-like, ITER baseline):\n    - $m_{\\text{atom}} = 3.321\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 8$,\n    - $\\overline{L}_z = 1.0\\times 10^{-32}$,\n    - $\\eta = 0.3$,\n    - $n_{\\text{e},0} = 8.0\\times 10^{19}$,\n    - $T_0 = 1.2000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.9$,\n    - $n_{\\text{e,post}} = 5.0\\times 10^{20}$,\n    - $\\tau_{\\text{TQ}} = 3.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 2.0\\times 10^{6}$,\n    - $M_{\\text{ref}} = 20.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n- Case B (Argon-like, moderate mitigation, radiation-dominated):\n    - $m_{\\text{atom}} = 6.6335\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 10$,\n    - $\\overline{L}_z = 3.0\\times 10^{-32}$,\n    - $\\eta = 0.3$,\n    - $n_{\\text{e},0} = 8.0\\times 10^{19}$,\n    - $T_0 = 1.0000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.7$,\n    - $n_{\\text{e,post}} = 1.0\\times 10^{20}$,\n    - $\\tau_{\\text{TQ}} = 5.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 1.5\\times 10^{6}$,\n    - $M_{\\text{ref}} = 15.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n- Case C (Neon-like, density-dominated with high $n_{\\text{e,post}}$ and lower assimilation):\n    - $m_{\\text{atom}} = 3.321\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 8$,\n    - $\\overline{L}_z = 1.0\\times 10^{-32}$,\n    - $\\eta = 0.2$,\n    - $n_{\\text{e},0} = 6.0\\times 10^{19}$,\n    - $T_0 = 1.5000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.6$,\n    - $n_{\\text{e,post}} = 1.5\\times 10^{21}$,\n    - $\\tau_{\\text{TQ}} = 2.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 2.0\\times 10^{6}$,\n    - $M_{\\text{ref}} = 20.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n\nAngle units do not apply. There are no percentages in the output. Ensure that the final printed line strictly matches the required format: a single list containing one sub-list per test case, in the order described, with each float rounded to three significant figures and with $M_{\\text{model}}$ and $M_{\\text{scaled}}$ in grams.",
            "solution": "**1. Plasma Thermal Energy**\nThe initial plasma thermal energy, $W_{\\text{th}}$, is given by $W_{\\text{th}} \\approx 3 n_{\\text{e},0} T_0 V$, where the temperature $T_0$ must be in Joules. The given temperature is in electron-volts ($\\text{eV}$) and must be converted using the elementary charge $e \\approx 1.602176634 \\times 10^{-19} \\, \\text{J/eV}$.\n$$ W_{\\text{th}} = 3 \\, n_{\\text{e},0} \\, (T_0[\\text{eV}] \\times e) \\, V $$\n\n**2. Radiative Constraint on Injected Particle Number**\nThe total energy to be radiated is $E_{\\text{rad,target}} = f_{\\text{rad}} W_{\\text{th}}$. This energy is radiated over the thermal quench time $\\tau_{\\text{TQ}}$ with a power $P_{\\text{rad}} = n_{\\text{e,avg}} \\, n_z \\, \\overline{L}_z \\, V$. The impurity density is $n_z = \\eta N_{\\text{inj}} / V$, where $\\eta$ is the assimilation efficiency and $N_{\\text{inj}}$ is the number of injected particles. The total radiated energy is $E_{\\text{rad}} = P_{\\text{rad}} \\times \\tau_{\\text{TQ}}$. Equating this to the target:\n$$ f_{\\text{rad}} W_{\\text{th}} = \\left(n_{\\text{e,avg}} \\frac{\\eta N_{\\text{inj,rad}}}{V} \\overline{L}_z V\\right) \\tau_{\\text{TQ}} = n_{\\text{e,avg}} \\, \\eta \\, N_{\\text{inj,rad}} \\, \\overline{L}_z \\, \\tau_{\\text{TQ}} $$\nUsing the given prescription $n_{\\text{e,avg}} = n_{\\text{e,post}}$, we solve for the number of particles required for the radiative constraint, $N_{\\text{inj,rad}}$:\n$$ N_{\\text{inj,rad}} = \\frac{f_{\\text{rad}} W_{\\text{th}}}{\\eta \\, n_{\\text{e,post}} \\, \\overline{L}_z \\, \\tau_{\\text{TQ}}} $$\n\n**3. Density Constraint on Injected Particle Number**\nThe post-quench electron density $n_{\\text{e,post}}$ must be achieved. It is the sum of the initial density $n_{\\text{e},0}$ and the density added by the ionized impurities, $\\Delta n_{\\text{e}} = \\eta N_{\\text{inj}} \\overline{Z}_{\\text{ion}} / V$. The constraint is:\n$$ n_{\\text{e,post}} \\ge n_{\\text{e},0} + \\frac{\\eta N_{\\text{inj,dens}} \\overline{Z}_{\\text{ion}}}{V} $$\nSolving for the minimum number of injected particles to meet this density requirement, $N_{\\text{inj,dens}}$:\n$$ N_{\\text{inj,dens}} = \\frac{(n_{\\text{e,post}} - n_{\\text{e},0}) V}{\\eta \\overline{Z}_{\\text{ion}}} $$\n\n**4. Model-Based Injected Mass, $M_{\\text{model}}$**\nThe required number of injected particles, $N_{\\text{inj}}$, is the maximum of the two constraints to satisfy both:\n$$ N_{\\text{inj}} = \\max(N_{\\text{inj,rad}}, N_{\\text{inj,dens}}) $$\nThe corresponding model-predicted mass, $M_{\\text{model}}$, is found by multiplying by the atomic mass, $m_{\\text{atom}}$, and converting to grams:\n$$ M_{\\text{model}} \\, [\\text{g}] = (N_{\\text{inj}} \\times m_{\\text{atom}} \\, [\\text{kg}]) \\times 1000 $$\n\n**5. Scaled Injected Mass, $M_{\\text{scaled}}$, and Ratio $r$**\nThe mass from the simple linear scaling law is:\n$$ M_{\\text{scaled}} = M_{\\text{ref}} \\times \\frac{W_{\\text{th}}}{W_{\\text{ref}}} \\times \\frac{f_{\\text{rad}}}{f_{\\text{rad,ref}}} $$\nThe dimensionless ratio $r$ is:\n$$ r = \\frac{M_{\\text{model}}}{M_{\\text{scaled}}} $$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes a 0D model for shattered pellet injection in ITER,\n    compares it to a linear scaling, and formats the output.\n    \"\"\"\n\n    # Elementary charge in J/eV\n    e_charge = 1.602176634e-19\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case A (Neon-like, ITER baseline)\n        {\n            \"m_atom\": 3.321e-26,       # kg\n            \"Z_ion\": 8,                # dimensionless\n            \"L_z\": 1.0e-32,            # W m^3\n            \"eta\": 0.3,                # dimensionless\n            \"n_e0\": 8.0e19,            # m^-3\n            \"T0\": 1.2000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.9,              # dimensionless\n            \"n_epost\": 5.0e20,         # m^-3\n            \"tau_TQ\": 3.0e-3,          # s\n            \"W_ref\": 2.0e6,            # J\n            \"M_ref\": 20.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        },\n        # Case B (Argon-like, moderate mitigation, radiation-dominated)\n        {\n            \"m_atom\": 6.6335e-26,      # kg\n            \"Z_ion\": 10,               # dimensionless\n            \"L_z\": 3.0e-32,            # W m^3\n            \"eta\": 0.3,                # dimensionless\n            \"n_e0\": 8.0e19,            # m^-3\n            \"T0\": 1.0000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.7,              # dimensionless\n            \"n_epost\": 1.0e20,         # m^-3\n            \"tau_TQ\": 5.0e-3,          # s\n            \"W_ref\": 1.5e6,            # J\n            \"M_ref\": 15.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        },\n        # Case C (Neon-like, density-dominated with high n_epost and lower assimilation)\n        {\n            \"m_atom\": 3.321e-26,       # kg\n            \"Z_ion\": 8,                # dimensionless\n            \"L_z\": 1.0e-32,            # W m^3\n            \"eta\": 0.2,                # dimensionless\n            \"n_e0\": 6.0e19,            # m^-3\n            \"T0\": 1.5000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.6,              # dimensionless\n            \"n_epost\": 1.5e21,         # m^-3\n            \"tau_TQ\": 2.0e-3,          # s\n            \"W_ref\": 2.0e6,            # J\n            \"M_ref\": 20.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        }\n    ]\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number x to sf significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, sf - 1 - int(math.floor(math.log10(abs(x)))))\n\n    all_results = []\n    \n    for case in test_cases:\n        # Step 1: Calculate plasma thermal energy in Joules\n        T0_J = case[\"T0\"] * e_charge\n        W_th = 3 * case[\"n_e0\"] * T0_J * case[\"V\"]\n\n        # Step 2: Calculate the number of particles for the radiative constraint\n        N_inj_rad_denom = case[\"eta\"] * case[\"n_epost\"] * case[\"L_z\"] * case[\"tau_TQ\"]\n        N_inj_rad = (case[\"f_rad\"] * W_th) / N_inj_rad_denom\n\n        # Step 3: Calculate the number of particles for the density constraint\n        delta_n_e = case[\"n_epost\"] - case[\"n_e0\"]\n        if delta_n_e > 0:\n             N_inj_dens = (delta_n_e * case[\"V\"]) / (case[\"eta\"] * case[\"Z_ion\"])\n        else:\n            N_inj_dens = 0\n\n        # Step 4: Determine the required number of particles and the model mass\n        N_inj = max(N_inj_rad, N_inj_dens)\n        M_model_kg = N_inj * case[\"m_atom\"]\n        M_model_g = M_model_kg * 1000\n\n        # Step 5: Calculate the mass from the simple scaling law\n        M_scaled_g = case[\"M_ref\"] * (W_th / case[\"W_ref\"]) * (case[\"f_rad\"] / case[\"f_rad_ref\"])\n\n        # Step 6: Calculate the ratio\n        r = M_model_g / M_scaled_g\n\n        # Round results to three significant figures\n        M_model_rounded = round_to_sf(M_model_g, 3)\n        M_scaled_rounded = round_to_sf(M_scaled_g, 3)\n        r_rounded = round_to_sf(r, 3)\n\n        all_results.append([M_model_rounded, M_scaled_rounded, r_rounded])\n\n    # Format the final output string as requested\n    # e.g., [[val,val,val],[val,val,val]]\n    result_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}