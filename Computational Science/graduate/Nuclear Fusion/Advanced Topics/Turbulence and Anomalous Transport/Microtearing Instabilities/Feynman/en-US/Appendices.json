{
    "hands_on_practices": [
        {
            "introduction": "To truly understand microtearing instabilities, we must first appreciate their fundamental structure. In the ballooning formalism, which is a powerful tool for analyzing instabilities in sheared magnetic fields, the spatial structure of fluctuating fields along a magnetic field line can be characterized by their parity. This exercise  delves into the core symmetries of the governing gyrokinetic-Maxwell equations to determine the parity of the electrostatic potential ($\\phi$) and the parallel vector potential ($A_{\\parallel}$). By establishing these properties, you will uncover the defining structural difference between electromagnetic microtearing modes and their electrostatic counterparts, such as Ion Temperature Gradient (ITG) modes.",
            "id": "3709295",
            "problem": "Consider a magnetized plasma in a sheared slab geometry relevant to nuclear fusion devices, with Cartesian coordinates $(x,y,z)$ and a uniform background magnetic field $\\mathbf{B}_{0} = B_{0} \\hat{z}$. Adopt the ballooning representation for linear microinstabilities, where the coordinate along the field line is the ballooning angle $\\theta$ (with $\\theta \\propto z$), and the perpendicular wavenumber has the standard sheared form $k_{\\perp}^{2}(\\theta) = k_{y}^{2} \\left(1 + \\hat{s}^{2} \\theta^{2}\\right)$, with $k_{y} > 0$ the binormal wavenumber and $\\hat{s} > 0$ the magnetic shear. Let the fluctuating electrostatic potential be $\\phi(\\theta)$ and the fluctuating parallel component of the vector potential be $A_{\\parallel}(\\theta)$, both localized near $\\theta = 0$ and decaying as $|\\theta| \\to \\infty$.\n\nStarting from the linearized gyrokinetic-Maxwell system and symmetry considerations in this sheared slab:\n- Use the parallel electric field definition $E_{\\parallel}(\\theta) = -\\partial_{t} A_{\\parallel}(\\theta) - \\nabla_{\\parallel} \\phi(\\theta)$, and the parallel component of Ampère’s law, together with quasineutrality, as the fundamental base.\n- Exploit the evenness of $k_{\\perp}^{2}(\\theta)$ in $\\theta$, the decay boundary conditions, and the parity properties of derivatives, to construct the parity constraints (even or odd in $\\theta$) that must be satisfied by $\\phi(\\theta)$ and $A_{\\parallel}(\\theta)$ for microtearing modes driven by an electron temperature gradient, and for the drift-wave branch comprising Ion Temperature Gradient (ITG) and Trapped Electron Mode (TEM) instabilities.\n\nDefine the parity indices\n$$\nC_{\\phi} \\equiv \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} \\phi(\\theta)\\,\\phi(-\\theta)\\,d\\theta}{\\displaystyle \\int_{-\\infty}^{\\infty} \\left[\\phi(\\theta)\\right]^{2}\\,d\\theta}, \\qquad\nC_{A} \\equiv \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} A_{\\parallel}(\\theta)\\,A_{\\parallel}(-\\theta)\\,d\\theta}{\\displaystyle \\int_{-\\infty}^{\\infty} \\left[A_{\\parallel}(\\theta)\\right]^{2}\\,d\\theta}.\n$$\nFor functions of pure parity, $C_{\\phi} = +1$ if $\\phi(\\theta)$ is even and $C_{\\phi} = -1$ if $\\phi(\\theta)$ is odd; similarly for $C_{A}$.\n\nUsing only these principles, determine and then compute the ordered quadruple $\\left(C_{\\phi}^{\\mathrm{MT}},\\, C_{A}^{\\mathrm{MT}},\\, C_{\\phi}^{\\mathrm{DW}},\\, C_{A}^{\\mathrm{DW}}\\right)$, where the superscripts $\\mathrm{MT}$ and $\\mathrm{DW}$ refer to microtearing and drift-wave (ITG/TEM) parity, respectively. Express your final answer as a single row matrix. This is a dimensionless calculation; no rounding is required.",
            "solution": "The problem requires the determination of the parity of the fluctuating electrostatic potential $\\phi(\\theta)$ and the parallel vector potential $A_{\\parallel}(\\theta)$ for two classes of microinstabilities: microtearing (MT) modes and drift-wave (DW) modes, in a sheared slab geometry using the ballooning representation. The parity is to be quantified by the indices $C_{\\phi}$ and $C_{A}$.\n\nThe foundation of the analysis lies in the symmetry properties of the linearized gyrokinetic-Maxwell system of equations, which are quasineutrality and the parallel component of Ampère's law. The system is described in the ballooning coordinate $\\theta$, where the perpendicular wavenumber squared, $k_{\\perp}^{2}(\\theta) = k_{y}^{2}(1 + \\hat{s}^{2}\\theta^{2})$, is an even function of $\\theta$. The boundary conditions are $\\phi(\\theta) \\to 0$ and $A_{\\parallel}(\\theta) \\to 0$ as $|\\theta| \\to \\infty$.\n\nThe governing equations couple $\\phi$ and $A_{\\parallel}$ through the perturbed particle distribution functions, $\\delta f_s$. The parity properties of the eigenmodes $(\\phi, A_{\\parallel})$ are determined by the parity of the operators in these equations. The key operators are functions of $k_{\\perp}^{2}(\\theta)$ (an even function) and the parallel gradient $\\nabla_{\\parallel}$, which in the ballooning formalism acts as a derivative with respect to $\\theta$, i.e., $\\nabla_{\\parallel} \\propto \\partial/\\partial\\theta$. The operator $\\partial/\\partial\\theta$ is odd with respect to the transformation $\\theta \\to -\\theta$.\n\nA powerful method to analyze the parity is to consider the symmetries of the underlying Vlasov equation. The linearized gyrokinetic equation possesses a fundamental symmetry under the combined transformation $(\\theta, v_{\\parallel}) \\to (-\\theta, -v_{\\parallel})$, where $v_{\\parallel}$ is the velocity component parallel to the magnetic field. The operator $v_{\\parallel}\\nabla_{\\parallel} \\propto v_{\\parallel}\\partial/\\partial\\theta$ is invariant (even) under this transformation: $(-v_{\\parallel})\\frac{\\partial}{\\partial(-\\theta)} = (-v_{\\parallel})(-\\frac{\\partial}{\\partial\\theta}) = v_{\\parallel}\\frac{\\partial}{\\partial\\theta}$. Let us define a function $g(\\theta, v_{\\parallel})$ to be \"even\" if $g(-\\theta, -v_{\\parallel}) = g(\\theta, v_{\\parallel})$ and \"odd\" if $g(-\\theta, -v_{\\parallel}) = -g(\\theta, v_{\\parallel})$.\n\nThe non-adiabatic part of the perturbed distribution function, $\\delta g_s$, satisfies the linearized gyrokinetic equation, which can be schematically written as:\n$$\n(-i\\omega + v_{\\parallel} \\nabla_{\\parallel}) \\delta g_s = S_s(\\phi, A_{\\parallel})\n$$\nThe operator on the left, $(-i\\omega + v_{\\parallel} \\nabla_{\\parallel})$, is \"even\" under the combined $(\\theta, v_{\\parallel})$ symmetry. Therefore, the solution $\\delta g_s$ must have the same combined parity as the source term $S_s$. The source term is driven by the potentials and is proportional to $J_0(k_{\\perp}\\rho_s)(\\phi - v_{\\parallel} A_{\\parallel})$, where $J_0$ is the zeroth-order Bessel function, and $\\rho_s$ is the species gyroradius. Since $k_{\\perp}(\\theta)$ is even in $\\theta$, $J_0(k_{\\perp}(\\theta)\\rho_s)$ is also even in $\\theta$.\n\nWe analyze two possible fundamental parity assignments for the eigenfunctions $(\\phi(\\theta), A_{\\parallel}(\\theta))$:\n1.  **Drift-Wave (or Interchange) Parity**: $\\phi(\\theta)$ is even and $A_{\\parallel}(\\theta)$ is odd.\n2.  **Tearing Parity**: $\\phi(\\theta)$ is odd and $A_{\\parallel}(\\theta)$ is even.\n\nLet's test these assignments. We consider the potentials $\\phi$ and $A_{\\parallel}$ to be functions of $\\theta$ only, so they are even in $v_{\\parallel}$.\n\n**Case A: Drift-Wave (ITG/TEM) Modes**\n\nDrift-wave instabilities are fundamentally electrostatic, driven by pressure gradients. The primary potential describing the mode is $\\phi$. For the most unstable mode, which is the ground state of the corresponding eigenproblem, we expect a nodeless structure. In a symmetric potential well, which is the case here as the operator coefficients are even in $\\theta$, the ground state eigenfunction must be even. Thus, we postulate that for drift waves, $\\phi(\\theta)$ is **even**. This corresponds to $C_{\\phi}^{\\mathrm{DW}} = +1$.\n\nLet's assume the eigenmode possesses drift-wave parity: $\\phi(\\theta)$ is even, $A_{\\parallel}(\\theta)$ is odd.\nLet's determine the combined parity of the source term $S_s \\propto J_0(\\phi - v_{\\parallel} A_{\\parallel})$. Under $(\\theta, v_{\\parallel}) \\to (-\\theta, -v_{\\parallel})$:\n$S_s \\to J_0(\\phi(-\\theta) - (-v_{\\parallel}) A_{\\parallel}(-\\theta)) = J_0(\\phi(\\theta) + v_{\\parallel} (-A_{\\parallel}(\\theta))) = J_0(\\phi(\\theta) - v_{\\parallel} A_{\\parallel}) = S_s$.\nThe source $S_s$ is \"even\". Consequently, the response $\\delta g_s$ must also be \"even\": $\\delta g_s(-\\theta, -v_{\\parallel}) = \\delta g_s(\\theta, v_{\\parallel})$.\n\nNow, we check for consistency using the two governing equations.\n1.  **Parallel Ampère's Law**: $-k_{\\perp}^{2}(\\theta) A_{\\parallel}(\\theta) = \\mu_0 j_{\\parallel}(\\theta)$.\n    The parallel current is a velocity moment of the distribution function: $j_{\\parallel}(\\theta) = \\sum_s e_s \\int v_{\\parallel} \\delta f_s \\, d^3v$. The dominant contribution comes from the non-adiabatic part, $j_{\\parallel}(\\theta) \\approx \\sum_s e_s \\int v_{\\parallel} J_0 \\delta g_s \\, d^3v$.\n    Let's find the parity of $j_{\\parallel}(\\theta)$:\n    $j_{\\parallel}(-\\theta) = \\sum_s e_s \\int v_{\\parallel} J_0(-\\theta) \\delta g_s(-\\theta, v_{\\parallel}) \\, d^3v$. Let $v'_{\\parallel} = -v_{\\parallel}$.\n    $j_{\\parallel}(-\\theta) = \\sum_s e_s \\int (-v'_{\\parallel}) J_0(\\theta) \\delta g_s(-\\theta, -v'_{\\parallel}) \\, d^3v'$.\n    Since $\\delta g_s$ is \"even\", $\\delta g_s(-\\theta, -v'_{\\parallel}) = \\delta g_s(\\theta, v'_{\\parallel})$.\n    $j_{\\parallel}(-\\theta) = \\sum_s e_s \\int (-v'_{\\parallel}) J_0(\\theta) \\delta g_s(\\theta, v'_{\\parallel}) \\, d^3v' = -j_{\\parallel}(\\theta)$.\n    So, $j_{\\parallel}(\\theta)$ is an **odd** function of $\\theta$.\n    Ampère's law becomes: $-(\\text{even}) A_{\\parallel} = (\\text{odd})$. This requires $A_{\\parallel}(\\theta)$ to be **odd**. This is consistent with our initial assumption. Thus, $C_{A}^{\\mathrm{DW}} = -1$.\n\n2.  **Quasineutrality**: $\\sum_s e_s \\delta n_s = 0$.\n    The perturbed density $\\delta n_s = -\\frac{e_s n_{0s}}{T_s}\\phi + \\int J_0 \\delta g_s d^3 v$. The first term is even since $\\phi$ is assumed even. The second term gives the non-adiabatic density response, let's call it $\\delta n_{s,NA}$. As $\\delta g_s$ is \"even\" and $J_0$ is even, the integral $\\int J_0 \\delta g_s d^3v$ results in an even function of $\\theta$. Thus, the quasineutrality equation is a sum of even functions, which is consistent.\n\nThe assignment $(\\phi, A_{\\parallel}) = (\\text{even, odd})$ is self-consistent for the drift-wave branch.\n\n**Case B: Microtearing (MT) Modes**\n\nMicrotearing modes are fundamentally electromagnetic, driven by the electron temperature gradient. They require magnetic reconnection, which is facilitated by a parallel current sheet localized at the resonant surface ($\\theta=0$). The primary potential is $A_{\\parallel}$. The simplest mode structure corresponding to reconnection involves an even profile for $A_{\\parallel}(\\theta)$ and the parallel current $j_{\\parallel}(\\theta)$. Thus, we postulate that for microtearing modes, $A_{\\parallel}(\\theta)$ is **even**. This implies $C_{A}^{\\mathrm{MT}} = +1$.\n\nLet's assume the eigenmode possesses tearing parity: $\\phi(\\theta)$ is odd, $A_{\\parallel}(\\theta)$ is even.\nLet's determine the combined parity of the source term $S_s \\propto J_0(\\phi - v_{\\parallel} A_{\\parallel})$. Under $(\\theta, v_{\\parallel}) \\to (-\\theta, -v_{\\parallel})$:\n$S_s \\to J_0(\\phi(-\\theta) - (-v_{\\parallel}) A_{\\parallel}(-\\theta)) = J_0(-\\phi(\\theta) + v_{\\parallel} A_{\\parallel}(\\theta)) = -S_s$.\nThe source $S_s$ is \"odd\". Consequently, the response $\\delta g_s$ must also be \"odd\": $\\delta g_s(-\\theta, -v_{\\parallel}) = -\\delta g_s(\\theta, v_{\\parallel})$.\n\nNow, we check for consistency.\n1.  **Parallel Ampère's Law**: $-k_{\\perp}^{2}(\\theta) A_{\\parallel}(\\theta) = \\mu_0 j_{\\parallel}(\\theta)$.\n    We find the parity of $j_{\\parallel}(\\theta) = \\sum_s e_s \\int v_{\\parallel} J_0 \\delta g_s \\, d^3v$.\n    $j_{\\parallel}(-\\theta) = \\sum_s e_s \\int (-v'_{\\parallel}) J_0(\\theta) \\delta g_s(-\\theta, -v'_{\\parallel}) \\, d^3v'$.\n    Since $\\delta g_s$ is \"odd\", $\\delta g_s(-\\theta, -v'_{\\parallel}) = -\\delta g_s(\\theta, v'_{\\parallel})$.\n    $j_{\\parallel}(-\\theta) = \\sum_s e_s \\int (-v'_{\\parallel}) J_0(\\theta) [-\\delta g_s(\\theta, v'_{\\parallel})] \\, d^3v' = j_{\\parallel}(\\theta)$.\n    So, $j_{\\parallel}(\\theta)$ is an **even** function of $\\theta$.\n    Ampère's law becomes: $-(\\text{even}) A_{\\parallel} = (\\text{even})$. This requires $A_{\\parallel}(\\theta)$ to be **even**. This is consistent with our initial assumption.\n\n2.  **Quasineutrality**: $\\sum_s e_s \\delta n_s = 0$.\n    The non-adiabatic density response $\\delta n_{s,NA} = \\int J_0 \\delta g_s d^3v$ has a parity determined by the \"odd\" nature of $\\delta g_s$. This integral is an odd function of $\\theta$. The electrostatic term is proportional to $\\phi$. For the equation to hold, $\\phi$ must also be **odd** to match the parity of the non-adiabatic response. This is consistent with our initial assumption. Thus, $C_{\\phi}^{\\mathrm{MT}} = -1$.\n\nThe assignment $(\\phi, A_{\\parallel}) = (\\text{odd, even})$ is self-consistent for the microtearing branch.\n\n**Conclusion**\n\nBased on the symmetry analysis of the governing gyrokinetic-Maxwell equations, we have determined the parities:\n-   For Microtearing (MT) modes: $\\phi(\\theta)$ is odd ($C_{\\phi}^{\\mathrm{MT}} = -1$) and $A_{\\parallel}(\\theta)$ is even ($C_{A}^{\\mathrm{MT}} = +1$).\n-   For Drift-Wave (DW) modes: $\\phi(\\theta)$ is even ($C_{\\phi}^{\\mathrm{DW}} = +1$) and $A_{\\parallel}(\\theta)$ is odd ($C_{A}^{\\mathrm{DW}} = -1$).\n\nThe requested ordered quadruple is $(C_{\\phi}^{\\mathrm{MT}},\\, C_{A}^{\\mathrm{MT}},\\, C_{\\phi}^{\\mathrm{DW}},\\, C_{A}^{\\mathrm{DW}})$. Substituting the values: $(-1, 1, 1, -1)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1 & 1 & 1 & -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While microtearing instabilities are driven by kinetic effects within a narrow \"inner\" layer around a resonant magnetic surface, the larger-scale magnetic configuration plays a critical role. The tearing stability parameter, typically denoted as $\\Delta'$, quantifies the \"free energy\" available from the outer, ideal magnetohydrodynamic (MHD) region to fuel magnetic reconnection. This practice  guides you through the process of defining and calculating $\\Delta'$ for a model magnetic perturbation. Understanding the sign and magnitude of $\\Delta'$ is crucial, as it determines whether the background magnetic field acts to amplify (positive $\\Delta'$) or suppress (negative $\\Delta'$) the tearing instability.",
            "id": "3709217",
            "problem": "Consider a slab model of a magnetized plasma representative of the edge of a tokamak, with an equilibrium magnetic field $\\mathbf{B}_{0} = B_{0} \\hat{z} + x B' \\hat{y}$ that produces magnetic shear and a resonant surface at $x=0$. Assume perturbations of the magnetic flux function (parallel vector potential) $\\psi(x)$ varying as $\\exp(i k_{y} y - i \\omega t)$ in the ignorable direction. In the outer region away from the resonant layer, assume ideal Magnetohydrodynamics (MHD) applies so that magnetic flux is frozen into the fluid and the parallel electric field vanishes to leading order. Starting from Faraday's law, Ampère's law, and ideal Ohm's law for ideal MHD, derive the linear outer-region differential equation governing the radial structure of the tearing-parity flux function $\\psi(x)$, and use this to define the tearing stability parameter $\\Delta'$ as the quantity that measures the jump of the logarithmic radial derivative of $\\psi(x)$ across the resonant layer at $x=0$. \n\nNow, consider a physically consistent outer-region eigenfunction chosen to satisfy decay away from the resonant surface,\n$$\n\\psi(x) = \\psi_{0} \\exp\\!\\big(-k\\,|x|\\big),\n$$\nwith $k>0$ a constant radial decay rate determined by the outer-region equation and matching to boundary conditions at large $|x|$. Compute the corresponding tearing stability parameter $\\Delta'$ for this eigenfunction by evaluating its definition in the limit $x \\to 0^{\\pm}$. \n\nFinally, explain, based on asymptotic matching arguments between the ideal outer region and the kinetic inner layer appropriate for microtearing, how the sign and magnitude of $\\Delta'$ influence the microtearing growth rate driven by electron temperature gradients, without invoking any pre-derived dispersion relations. Your final answer must be the closed-form analytic expression for $\\Delta'$ in terms of $k$ only. Do not approximate $k$ numerically.",
            "solution": "The slab equilibrium $\\mathbf{B}_{0} = B_{0} \\hat{z} + x B' \\hat{y}$ introduces magnetic shear and defines a rational (resonant) surface at $x=0$ where $k_{\\parallel} = \\mathbf{k} \\cdot \\mathbf{B}_{0} / |\\mathbf{B}_{0}|$ vanishes to leading order for perturbations with wave vector $\\mathbf{k} = k_{y} \\hat{y}$. The tearing-parity perturbation is characterized by an even magnetic flux function $\\psi(x)$ and an odd radial magnetic field perturbation.\n\nWe start from Maxwell’s equations and ideal Magnetohydrodynamics (MHD). Faraday’s law is\n$$\n\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t},\n$$\nAmpère’s law (neglecting displacement current) is\n$$\n\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J},\n$$\nand ideal Ohm’s law is\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}.\n$$\nIn the outer region where resistive and kinetic effects are negligible and the parallel electric field is small, the flux function $\\psi(x)$, defined via the parallel component of the vector potential $\\delta A_{\\parallel}$ such that the perturbed magnetic field $\\delta \\mathbf{B} = \\nabla \\times (\\psi \\hat{z})$ for a guide field along $\\hat{z}$, satisfies a standard ideal MHD outer-region equation. For perturbations varying as $\\exp(i k_{y} y - i \\omega t)$ and for low-$\\beta$ ordering with negligible pressure coupling in the outer region, the linearized force balance and induction constraints reduce to an equation of the form\n$$\n\\frac{d^{2} \\psi}{d x^{2}} - k_{y}^{2} \\psi = 0,\n$$\naway from the singular resonant layer at $x=0$. This equation enforces exponential decay of $\\psi(x)$ for $|x| \\to \\infty$.\n\nThe tearing stability parameter $\\Delta'$ is defined through the outer ideal solution as the jump in the logarithmic radial derivative of the flux function across the infinitesimally thin inner layer at the resonant surface:\n$$\n\\Delta' \\equiv \\left.\\frac{d}{d x} \\ln \\psi(x)\\right|_{x \\to 0^{+}} - \\left.\\frac{d}{d x} \\ln \\psi(x)\\right|_{x \\to 0^{-}} \\, .\n$$\nEquivalently,\n$$\n\\Delta' = \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)} \\, ,\n$$\nwhere primes denote derivatives with respect to $x$, and $\\psi(0)$ is the common value of the continuous flux function at $x=0$.\n\nWe are given an outer-region eigenfunction\n$$\n\\psi(x) = \\psi_{0} \\exp\\!\\big(-k\\,|x|\\big),\n$$\nwith $k>0$ a constant radial decay rate. We first compute the limits of the derivative as $x \\to 0^{\\pm}$. For $x>0$,\n$$\n\\psi(x) = \\psi_{0} \\exp(-k x), \\quad \\psi'(x) = -k \\psi_{0} \\exp(-k x) \\implies \\psi'(0^{+}) = -k \\psi_{0}.\n$$\nFor $x<0$,\n$$\n\\psi(x) = \\psi_{0} \\exp(+k x), \\quad \\psi'(x) = +k \\psi_{0} \\exp(+k x) \\implies \\psi'(0^{-}) = +k \\psi_{0}.\n$$\nThe value at the resonant surface is\n$$\n\\psi(0) = \\psi_{0}.\n$$\nThus,\n$$\n\\Delta' = \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)} = \\frac{(-k \\psi_{0}) - (+k \\psi_{0})}{\\psi_{0}} = -2 k.\n$$\n\nWe now argue how the sign and magnitude of $\\Delta'$ influence the microtearing growth rate. In tearing theory, the outer ideal solution provides a boundary condition for the inner kinetic layer, where electron dynamics, collisions, and temperature gradients enter. Asymptotic matching yields a dispersion relation in which the inner-layer response produces a complex relation between the layer current and the imposed outer-field gradient, while the outer region contributes through $\\Delta'$. To leading order, the growth rate inherits a proportional dependence on $\\Delta'$ multiplied by inner-layer transport coefficients and drive terms (for microtearing, the electron temperature gradient and finite electron conductivity set the drive). \n\nThe sign of $\\Delta'$ determines whether the outer solution promotes or suppresses reconnection: a positive $\\Delta'$ corresponds to a net focusing of field lines that tends to amplify the reconnecting perturbation, whereas a negative $\\Delta'$ corresponds to defocusing and tends to inhibit reconnection. Consequently, for microtearing driven by electron temperature gradients, a larger positive $\\Delta'$ lowers the threshold and increases the growth rate. If $\\Delta'$ is negative, as in the present eigenfunction with $\\Delta' = -2 k$, the outer-region matching is stabilizing; microtearing can still occur only if the inner-layer kinetic drive is sufficiently strong to overcome this stabilizing outer contribution. The magnitude $|\\Delta'|$ scales the strength of this outer-region effect linearly to leading order, so increasing $|\\Delta'|$ strengthens either the stabilizing or destabilizing influence depending on its sign.\n\nIn summary, the requested analytic expression for the tearing stability parameter associated with the given eigenfunction is\n$$\n\\Delta' = -2 k.\n$$\nThis expression encapsulates the outer-region contribution that, when fed into the inner-layer microtearing physics, sets the sign and scale of the growth-rate modification due to tearing stability.",
            "answer": "$$\\boxed{-2 k}$$"
        },
        {
            "introduction": "The previous exercises explored the fundamental structure and large-scale energetics of microtearing modes. We now zoom into the heart of the instability: the kinetic inner layer where magnetic field lines break and reconnect. The physics within this layer, such as the effective resistivity and resulting layer width, is not a simple constant but emerges from the complex interplay of particle motion and collisions, as described by the drift-kinetic equation. This advanced computational practice  provides a hands-on opportunity to calculate these microscopic properties from first principles. By numerically solving for the plasma's parallel conductivity, you will not only quantify a key parameter of the inner layer but also learn the essential skill of performing a numerical convergence test to ensure the accuracy of your results.",
            "id": "3709264",
            "problem": "Design and implement a convergence test for the inner-layer width associated with Microtearing Instabilities (MTI) in nuclear fusion plasmas by systematically refining the velocity-space resolution and verifying that the computed inner-layer width $\\delta$ is numerically converged relative to the electron gyroradius $\\rho_e$. The test must be based on first principles and a physically sound kinetic closure.\n\nStart from the linearized drift-kinetic equation for electrons in a slab geometry with a single parallel wavenumber $k_{\\parallel}$, a real oscillation frequency $\\omega$, and a linear growth rate $\\gamma$:\n$$\n\\left(-i\\omega + i k_{\\parallel} v_{\\parallel} + \\nu_e\\right) f_1(v_{\\parallel}) = \\frac{e E_{\\parallel}}{T_e} v_{\\parallel} f_0(v_{\\parallel}),\n$$\nwhere $f_0(v_{\\parallel})$ is a one-dimensional Maxwellian, $f_1(v_{\\parallel})$ is the perturbed distribution, $E_{\\parallel}$ is the parallel electric field, $e$ is the elementary charge, $T_e$ is the electron temperature, and $\\nu_e$ is an effective electron collision frequency modeled as a simple Krook operator. The parallel electron current density is defined by\n$$\nJ_{\\parallel} = -e \\int_{-\\infty}^{\\infty} v_{\\parallel} f_1(v_{\\parallel}) \\, dv_{\\parallel},\n$$\nand the effective parallel conductivity is\n$$\n\\sigma_{\\parallel} \\equiv -\\frac{J_{\\parallel}}{E_{\\parallel}}.\n$$\n\nUsing $f_0(v_{\\parallel}) = \\dfrac{n_e}{\\sqrt{\\pi} v_{\\mathrm{th}}} \\exp\\!\\left(-\\dfrac{v_{\\parallel}^2}{v_{\\mathrm{th}}^2}\\right)$ with electron thermal speed $v_{\\mathrm{th}} = \\sqrt{\\dfrac{2 T_e}{m_e}}$, show that $\\sigma_{\\parallel}$ can be expressed as a velocity-space integral that depends on $k_{\\parallel}$, $\\omega$, $\\nu_e$, $n_e$, and $T_e$. Compute this integral numerically via Gauss–Hermite quadrature with $N_v$ nodes to approximate $\\int_{-\\infty}^{\\infty} e^{-x^2} g(x)\\, dx$, where $x = v_{\\parallel}/v_{\\mathrm{th}}$ and $g(x)$ is a rational function determined by the drift-kinetic response.\n\nUse the effective parallel resistivity $\\eta_{\\mathrm{eff}} \\equiv \\Re\\!\\left(1/\\sigma_{\\parallel}\\right)$ together with the magnetic diffusion relation for a tearing-type inner layer to define the inner-layer width\n$$\n\\delta = \\sqrt{\\frac{\\eta_{\\mathrm{eff}}}{\\mu_0 |\\gamma|}},\n$$\nwhere $\\mu_0$ is the vacuum permeability and $|\\gamma|$ is the magnitude of the linear growth rate. Define the electron gyroradius\n$$\n\\rho_e = \\frac{v_{\\mathrm{th}}}{\\Omega_e}, \\quad \\Omega_e = \\frac{e B}{m_e},\n$$\nwith magnetic field $B$.\n\nYour program must:\n- Implement the Gauss–Hermite quadrature with $N_v$ nodes to compute $\\sigma_{\\parallel}$ and then $\\delta$ and the ratio $R \\equiv \\delta/\\rho_e$.\n- For each test case, evaluate $R(N_v)$ on a specified sequence of $N_v$ values. Let $R_{\\mathrm{ref}}$ be the value at the largest $N_v$ in the sequence.\n- Define the convergence metric as the maximum relative deviation from $R_{\\mathrm{ref}}$ across the sequence:\n$$\n\\varepsilon = \\max_{N_v \\ \\text{in sequence}} \\left|\\frac{R(N_v) - R_{\\mathrm{ref}}}{R_{\\mathrm{ref}}}\\right|.\n$$\n- For each test case, return a boolean indicating whether $\\varepsilon \\le \\tau$, where $\\tau$ is a specified tolerance for that test case.\n\nPhysical units and constants:\n- Use the International System of Units (SI).\n- Electron temperature $T_e$ is specified in electronvolts; convert it to joules using $1 \\ \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$.\n- Electron mass $m_e = 9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}$.\n- Elementary charge $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$.\n- Vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7} \\ \\mathrm{H/m}$.\n\nYour algorithm must be fully self-contained and must not rely on any external input. The final output format must be a single line containing a comma-separated list of the boolean results enclosed in square brackets, such as $[\\mathrm{True},\\mathrm{False},\\dots]$.\n\nTest suite (each tuple lists $\\left(n_e, T_e, B, k_{\\parallel}, \\omega, \\nu_e, \\gamma, \\{N_v\\ \\text{sequence}\\}, \\tau\\right)$):\n- Case $1$: $\\left(6\\times 10^{19} \\ \\mathrm{m}^{-3}, \\ 1000 \\ \\mathrm{eV}, \\ 2.5 \\ \\mathrm{T}, \\ 0.5 \\ \\mathrm{m}^{-1}, \\ 1.0\\times 10^{5} \\ \\mathrm{rad/s}, \\ 2.0\\times 10^{5} \\ \\mathrm{s}^{-1}, \\ 5.0\\times 10^{4} \\ \\mathrm{s}^{-1}, \\ \\{16,32,64,128\\}, \\ 0.05\\right)$.\n- Case $2$: $\\left(5\\times 10^{19} \\ \\mathrm{m}^{-3}, \\ 2000 \\ \\mathrm{eV}, \\ 3.0 \\ \\mathrm{T}, \\ 0.3 \\ \\mathrm{m}^{-1}, \\ 5.0\\times 10^{5} \\ \\mathrm{rad/s}, \\ 1.0\\times 10^{3} \\ \\mathrm{s}^{-1}, \\ 2.0\\times 10^{5} \\ \\mathrm{s}^{-1}, \\ \\{32,64,128,256\\}, \\ 0.05\\right)$.\n- Case $3$: $\\left(1\\times 10^{20} \\ \\mathrm{m}^{-3}, \\ 500 \\ \\mathrm{eV}, \\ 5.0 \\ \\mathrm{T}, \\ 0.8 \\ \\mathrm{m}^{-1}, \\ 1.0\\times 10^{4} \\ \\mathrm{rad/s}, \\ 5.0\\times 10^{6} \\ \\mathrm{s}^{-1}, \\ 1.0\\times 10^{4} \\ \\mathrm{s}^{-1}, \\ \\{8,16,32,64\\}, \\ 0.05\\right)$.\n- Case $4$: $\\left(4\\times 10^{19} \\ \\mathrm{m}^{-3}, \\ 1500 \\ \\mathrm{eV}, \\ 2.0 \\ \\mathrm{T}, \\ 0.05 \\ \\mathrm{m}^{-1}, \\ 1.0\\times 10^{4} \\ \\mathrm{rad/s}, \\ 1.0\\times 10^{4} \\ \\mathrm{s}^{-1}, \\ 3.0\\times 10^{4} \\ \\mathrm{s}^{-1}, \\ \\{16,32,64,128\\}, \\ 0.05\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}]$).",
            "solution": "The problem requires designing and implementing a numerical convergence test for the inner-layer width, $\\delta$, associated with microtearing instabilities (MTI). The test verifies that the calculated ratio of the inner-layer width to the electron gyroradius, $R = \\delta / \\rho_e$, converges as the velocity-space resolution, represented by the number of quadrature points $N_v$, is refined. The entire procedure is derived from first principles, starting with the linearized electron drift-kinetic equation.\n\nFirst, we derive the expression for the parallel electron conductivity, $\\sigma_{\\parallel}$. The provided linearized drift-kinetic equation in a slab geometry is:\n$$\n\\left(-i\\omega + i k_{\\parallel} v_{\\parallel} + \\nu_e\\right) f_1(v_{\\parallel}) = \\frac{e E_{\\parallel}}{T_e} v_{\\parallel} f_0(v_{\\parallel})\n$$\nwhere $f_1(v_{\\parallel})$ is the perturbed electron distribution function, $f_0(v_{\\parallel})$ is the equilibrium Maxwellian distribution, $\\omega$ is the mode frequency, $\\gamma$ is the growth rate, $k_{\\parallel}$ is the parallel wavenumber, $v_{\\parallel}$ is the parallel velocity, $\\nu_e$ is an effective electron collision frequency, $E_{\\parallel}$ is the parallel electric field, $e$ is the elementary charge, and $T_e$ is the electron temperature in Joules. Note that the full complex frequency $\\tilde{\\omega} = \\omega + i\\gamma$ would typically appear in the equation, but following the problem statement, we use the specified form where the time-derivative operator is taken as $-i\\omega$.\n\nSolving for the perturbed distribution $f_1(v_{\\parallel})$ gives:\n$$\nf_1(v_{\\parallel}) = \\frac{e E_{\\parallel}}{T_e} \\frac{v_{\\parallel} f_0(v_{\\parallel})}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\parallel}}\n$$\nThe parallel electron current density, $J_{\\parallel}$, is defined as the first velocity moment of the perturbed distribution function:\n$$\nJ_{\\parallel} = -e \\int_{-\\infty}^{\\infty} v_{\\parallel} f_1(v_{\\parallel}) \\, dv_{\\parallel}\n$$\nSubstituting the expression for $f_1(v_{\\parallel})$ into the definition of $J_{\\parallel}$ yields:\n$$\nJ_{\\parallel} = -e \\int_{-\\infty}^{\\infty} v_{\\parallel} \\left( \\frac{e E_{\\parallel}}{T_e} \\frac{v_{\\parallel} f_0(v_{\\parallel})}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\parallel}} \\right) \\, dv_{\\parallel} = -\\frac{e^2 E_{\\parallel}}{T_e} \\int_{-\\infty}^{\\infty} \\frac{v_{\\parallel}^2 f_0(v_{\\parallel})}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\parallel}} \\, dv_{\\parallel}\n$$\nThe parallel conductivity, $\\sigma_{\\parallel}$, is defined by the relation $J_{\\parallel} = \\sigma_{\\parallel} E_{\\parallel}$ in the problem's context (note the sign convention $\\sigma_{\\parallel} \\equiv -J_{\\parallel}/E_{\\parallel}$), which gives:\n$$\n\\sigma_{\\parallel} = \\frac{e^2}{T_e} \\int_{-\\infty}^{\\infty} \\frac{v_{\\parallel}^2 f_0(v_{\\parallel})}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\parallel}} \\, dv_{\\parallel}\n$$\nTo evaluate this integral numerically, we first substitute the one-dimensional Maxwellian distribution, $f_0(v_{\\parallel}) = \\dfrac{n_e}{\\sqrt{\\pi} v_{\\mathrm{th}}} \\exp\\!\\left(-v_{\\parallel}^2/v_{\\mathrm{th}}^2\\right)$, where $n_e$ is the electron density and $v_{\\mathrm{th}} = \\sqrt{2T_e/m_e}$ is the electron thermal speed.\n$$\n\\sigma_{\\parallel} = \\frac{e^2}{T_e} \\frac{n_e}{\\sqrt{\\pi} v_{\\mathrm{th}}} \\int_{-\\infty}^{\\infty} \\frac{v_{\\parallel}^2 \\exp(-v_{\\parallel}^2/v_{\\mathrm{th}}^2)}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\parallel}} \\, dv_{\\parallel}\n$$\nWe perform a change of variables to a dimensionless velocity $x = v_{\\parallel}/v_{\\mathrm{th}}$, which implies $v_{\\parallel} = x v_{\\mathrm{th}}$ and $dv_{\\parallel} = v_{\\mathrm{th}} dx$.\n$$\n\\sigma_{\\parallel} = \\frac{n_e e^2}{T_e \\sqrt{\\pi} v_{\\mathrm{th}}} \\int_{-\\infty}^{\\infty} \\frac{(x v_{\\mathrm{th}})^2 e^{-x^2}}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\mathrm{th}} x} \\, v_{\\mathrm{th}} dx = \\frac{n_e e^2 v_{\\mathrm{th}}^2}{T_e \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} \\frac{x^2 e^{-x^2}}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\mathrm{th}} x} dx\n$$\nUsing the relation $v_{\\mathrm{th}}^2 = 2T_e/m_e$, the prefactor simplifies:\n$$\n\\sigma_{\\parallel} = \\frac{n_e e^2}{T_e \\sqrt{\\pi}} \\left(\\frac{2T_e}{m_e}\\right) \\int_{-\\infty}^{\\infty} \\frac{x^2 e^{-x^2}}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\mathrm{th}} x} dx = \\frac{2 n_e e^2}{m_e \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-x^2} g(x) \\, dx\n$$\nwhere the function $g(x)$ is given by:\n$$\ng(x) = \\frac{x^2}{\\nu_e - i\\omega + i k_{\\parallel} v_{\\mathrm{th}} x}\n$$\nThe integral is of the form $\\int_{-\\infty}^{\\infty} e^{-x^2} g(x) dx$, which is suitable for Gauss-Hermite quadrature. The integral is approximated as a weighted sum over $N_v$ nodes:\n$$\n\\int_{-\\infty}^{\\infty} e^{-x^2} g(x) \\, dx \\approx \\sum_{j=1}^{N_v} w_j g(x_j)\n$$\nwhere $x_j$ are the roots of the Hermite polynomial of degree $N_v$, $H_{N_v}(x)$, and $w_j$ are the corresponding weights. This numerical value is a complex number.\n\nWith $\\sigma_{\\parallel}$ computed, we proceed to calculate the quantities required for the convergence test. The effective parallel resistivity, $\\eta_{\\mathrm{eff}}$, is defined as the real part of the inverse conductivity:\n$$\n\\eta_{\\mathrm{eff}} = \\Re\\left(\\frac{1}{\\sigma_{\\parallel}}\\right)\n$$\nThe inner-layer width $\\delta$ is then given by the tearing mode relation:\n$$\n\\delta = \\sqrt{\\frac{\\eta_{\\mathrm{eff}}}{\\mu_0 |\\gamma|}}\n$$\nwhere $\\mu_0$ is the vacuum permeability and $|\\gamma|$ is the magnitude of the linear growth rate. This width is compared to the electron gyroradius, $\\rho_e$:\n$$\n\\rho_e = \\frac{v_{\\mathrm{th}}}{\\Omega_e}, \\quad \\text{with} \\quad \\Omega_e = \\frac{e B}{m_e}\n$$\nThe ratio $R(N_v) = \\delta(N_v)/\\rho_e$ is computed for each value of $N_v$ in the specified sequence.\n\nThe convergence test is performed as follows. Let the sequence of velocity-space grid points be $\\{N_{v,1}, N_{v,2}, \\dots, N_{v,k}\\}$. For each $N_{v,i}$, we compute the ratio $R(N_{v,i})$. The reference value, $R_{\\mathrm{ref}}$, is taken to be the result from the most resolved grid, i.e., $R_{\\mathrm{ref}} = R(N_{v,k})$ where $N_{v,k}$ is the largest value in the sequence. The convergence metric, $\\varepsilon$, is the maximum relative deviation from this reference value across the entire sequence:\n$$\n\\varepsilon = \\max_{i=1,\\dots,k} \\left|\\frac{R(N_{v,i}) - R_{\\mathrm{ref}}}{R_{\\mathrm{ref}}}\\right|\n$$\nFinally, the calculation is deemed converged if this metric is less than or equal to a specified tolerance, $\\tau$. The algorithm returns a boolean value indicating whether $\\varepsilon \\le \\tau$. This procedure is repeated for each test case provided. All calculations must use SI units, with the electron temperature $T_e$ converted from electronvolts ($eV$) to Joules ($J$) using the elementary charge as the conversion factor.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_hermite\n\ndef solve():\n    \"\"\"\n    Main function to run the convergence test for all specified cases.\n    \"\"\"\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kg\n    MU0 = 4 * np.pi * 1e-7      # Vacuum permeability in H/m\n    EV_TO_J = E_CHARGE          # Conversion factor from eV to Joules\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (n_e, T_e_eV, B, k_parallel, omega, nu_e, gamma, Nv_sequence, tolerance)\n        (6e19, 1000, 2.5, 0.5, 1.0e5, 2.0e5, 5.0e4, [16, 32, 64, 128], 0.05),\n        (5e19, 2000, 3.0, 0.3, 5.0e5, 1.0e3, 2.0e5, [32, 64, 128, 256], 0.05),\n        (1e20, 500, 5.0, 0.8, 1.0e4, 5.0e6, 1.0e4, [8, 16, 32, 64], 0.05),\n        (4e19, 1500, 2.0, 0.05, 1.0e4, 1.0e4, 3.0e4, [16, 32, 64, 128], 0.05)\n    ]\n\n    results = []\n    for case in test_cases:\n        converged = run_convergence_test(case, E_CHARGE, M_ELECTRON, MU0, EV_TO_J)\n        results.append(converged)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_ratio(params, Nv, constants):\n    \"\"\"\n    Calculates the ratio R = delta / rho_e for a given set of parameters and Nv.\n    \n    Args:\n        params (tuple): A tuple of physical parameters for the simulation.\n        Nv (int): The number of Gauss-Hermite quadrature nodes.\n        constants (tuple): A tuple of physical constants.\n        \n    Returns:\n        float: The calculated dimensionless ratio R.\n    \"\"\"\n    n_e, T_e_eV, B, k_parallel, omega, nu_e, gamma = params\n    E_CHARGE, M_ELECTRON, MU0, EV_TO_J = constants\n\n    # Convert temperature to Joules\n    T_e_J = T_e_eV * EV_TO_J\n\n    # Calculate derived physical quantities\n    v_th = np.sqrt(2 * T_e_J / M_ELECTRON)\n    Omega_e = E_CHARGE * B / M_ELECTRON\n    rho_e = v_th / Omega_e\n\n    # Get Gauss-Hermite quadrature nodes (x_j) and weights (w_j)\n    nodes, weights = roots_hermite(Nv)\n\n    # Numerically integrate to find sigma_parallel\n    # The integrand is g(x) = x^2 / (nu_e - i*omega + i*k_parallel*v_th*x)\n    # The integral is sum(w_j * g(x_j))\n    # We use complex numbers for the calculation\n    denominator = (nu_e - 1j * omega) + 1j * k_parallel * v_th * nodes\n    numerator = nodes**2\n    \n    # The quadrature evaluates the integral I = integral(e^(-x^2) * g(x) dx)\n    integral_val = np.sum(weights * (numerator / denominator))\n    \n    # Calculate parallel conductivity sigma_parallel\n    prefactor = (2 * n_e * E_CHARGE**2) / (M_ELECTRON * np.sqrt(np.pi))\n    sigma_parallel = prefactor * integral_val\n\n    if sigma_parallel == 0:\n        # Avoid division by zero, though physically unlikely\n        return np.nan\n\n    # Calculate effective resistivity eta_eff\n    eta_eff = np.real(1.0 / sigma_parallel)\n    \n    if eta_eff  0:\n        # The layer width is not well-defined for negative resistivity\n        return np.nan\n\n    # Calculate inner-layer width delta\n    delta = np.sqrt(eta_eff / (MU0 * np.abs(gamma)))\n\n    # Calculate the final ratio R\n    R = delta / rho_e\n    \n    return R\n\ndef run_convergence_test(case_data, E_CHARGE, M_ELECTRON, MU0, EV_TO_J):\n    \"\"\"\n    Runs the convergence test for a single case.\n    \n    Args:\n        case_data (tuple): Contains all parameters for a single test case.\n        E_CHARGE, M_ELECTRON, MU0, EV_TO_J: Physical constants.\n        \n    Returns:\n        bool: True if converged within tolerance, False otherwise.\n    \"\"\"\n    n_e, T_e_eV, B, k_parallel, omega, nu_e, gamma, Nv_sequence, tolerance = case_data\n    params = (n_e, T_e_eV, B, k_parallel, omega, nu_e, gamma)\n    constants = (E_CHARGE, M_ELECTRON, MU0, EV_TO_J)\n    \n    R_values = []\n    for Nv in Nv_sequence:\n        R = calculate_ratio(params, Nv, constants)\n        R_values.append(R)\n        \n    # The reference value is from the run with the highest resolution (last in sequence)\n    R_ref = R_values[-1]\n    \n    if R_ref == 0 or np.isnan(R_ref):\n        # If reference is zero or invalid, convergence cannot be determined\n        return False\n\n    # Calculate the maximum relative deviation\n    max_rel_dev = 0.0\n    for R_val in R_values:\n        if np.isnan(R_val):\n            # If any value is invalid, treat as non-converged\n            return False\n        rel_dev = np.abs((R_val - R_ref) / R_ref)\n        if rel_dev > max_rel_dev:\n            max_rel_dev = rel_dev\n            \n    # Check if the max deviation is within the specified tolerance\n    return max_rel_dev = tolerance\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}