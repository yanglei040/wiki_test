{
    "hands_on_practices": [
        {
            "introduction": "雪崩输运的一个决定性特征是其快速的、非局域的传播特性，这与标准的、缓慢的扩散过程形成鲜明对比。本练习旨在通过一个思想实验，帮助你掌握区分这两种基本输运机制的定量方法。你将推导并计算一个热脉冲在纯粹扩散和纯粹弹道（类雪崩）传播模式下的到达时间，并利用一个判别指数来判断一个“观测”事件更接近哪种物理图像，从而深化对非局域输运行为的理解。",
            "id": "3691401",
            "problem": "在 $t=0$ 时刻，一个磁约束聚变等离子体的磁轴处触发了一个小的、局域化的热脉冲。沿小半径方向，在半径 $r$ 处观测到随之产生的热输运，并提出了两种相互竞争的机制假说：(i) 由恒定热扩散系数 $D$ 控制的扩散输运，以及 (ii) 以恒定前沿速度 $v_{\\text{front}}$ 为特征的类弹道雪崩输运。为便于分析，假设输运为一维径向输运。\n\n仅使用基本定律和核心定义：\n- 对于扩散假说，从一维热方程 $\\partial T/\\partial t = D\\, \\partial^{2}T/\\partial r^{2}$ 出发，其在 $t=0$ 时 $r=0$ 处具有冲激初始条件。将扩散到达时间 $t_{\\text{diff}}(r)$ 定义为半径 $r$ 处的局域温度扰动达到其最大值的时间。\n- 对于弹道假说，使用运动学来定义以恒定速度 $v_{\\text{front}}$ 传播的前沿的弹道到达时间 $t_{\\text{bal}}(r)$。\n\n然后，定义一个无量纲判别指数\n$$\nS(r) \\equiv \\frac{\\left|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)\\right|}{\\left|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)\\right|},\n$$\n其中 $t_{\\text{obs}}(r)$ 是在半径 $r$ 处实验观测到的到达时间。若 $S(r)  1$，表示观测结果更接近弹道预测；若 $S(r) > 1$，表示观测结果更接近扩散预测。取\n- $r = 0.28\\,\\text{m}$,\n- $D = 1.1\\,\\text{m}^{2}\\,\\text{s}^{-1}$,\n- $v_{\\text{front}} = 2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$,\n- $t_{\\text{obs}}(r) = 1.90 \\times 10^{-4}\\,\\text{s}$.\n\n计算 $S(r)$。最终答案以无量纲数表示，并四舍五入到三位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题明确，且客观。所有计算唯一解所需的数据和定义均已提供。因此，我们可以开始求解。\n\n目标是计算无量纲判别指数 $S(r)$，其定义为：\n$$\nS(r) \\equiv \\frac{\\left|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)\\right|}{\\left|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)\\right|}\n$$\n这需要使用所提供的模型和参数来计算弹道到达时间 $t_{\\text{bal}}(r)$ 和扩散到达时间 $t_{\\text{diff}}(r)$。观测到达时间 $t_{\\text{obs}}(r)$ 是已知的。\n\n首先，我们计算弹道到达时间 $t_{\\text{bal}}(r)$。弹道假说假设一个输运前沿以恒定速度 $v_{\\text{front}}$ 从磁轴（$r=0$）径向向外传播。根据基本运动学，该前沿传播距离 $r$ 所需的时间为：\n$$\nt_{\\text{bal}}(r) = \\frac{r}{v_{\\text{front}}}\n$$\n使用给定值 $r = 0.28\\,\\text{m}$ 和 $v_{\\text{front}} = 2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$：\n$$\nt_{\\text{bal}}(r) = \\frac{0.28\\,\\text{m}}{2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}} = \\frac{0.28}{2400}\\,\\text{s} \\approx 1.1667 \\times 10^{-4}\\,\\text{s}\n$$\n\n接下来，我们计算扩散到达时间 $t_{\\text{diff}}(r)$。它被定义为在半径 $r$ 处的温度扰动达到其最大值的时间。该输运由具有恒定热扩散系数 $D$ 的一维热方程控制：\n$$\n\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial r^2}\n$$\n初始条件是在 $t=0$ 时刻磁轴（$r=0$）处的一个局域化热脉冲。这可以被建模为一个狄拉克δ函数初始条件，$T(r, t=0) = E_0\\delta(r)$，其中 $E_0$ 是一个常数，表示单位面积上脉冲的总能量。这个初值问题的解，即一维热方程的基本解或格林函数，是一个高斯函数：\n$$\nT(r, t) = \\frac{E_0}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{r^2}{4 D t}\\right)\n$$\n为了找到对于固定的半径 $r > 0$，温度 $T$ 达到最大值的时间 $t_{\\text{diff}}(r)$，我们必须找到 $T(r,t)$ 关于时间 $t$ 的极值。我们计算其偏导数 $\\frac{\\partial T}{\\partial t}$ 并令其为零：\n$$\n\\frac{\\partial T(r, t)}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{E_0}{\\sqrt{4 \\pi D}} t^{-1/2} \\exp\\left(-\\frac{r^2}{4 D}t^{-1}\\right) \\right] = 0\n$$\n应用乘法法则和链式法则进行微分：\n$$\n\\frac{E_0}{\\sqrt{4 \\pi D}} \\left[ \\left(-\\frac{1}{2} t^{-3/2}\\right) \\exp\\left(-\\frac{r^2}{4 D t}\\right) + t^{-1/2} \\exp\\left(-\\frac{r^2}{4 D t}\\right) \\left(-\\frac{r^2}{4 D}\\right)\\left(-t^{-2}\\right) \\right] = 0\n$$\n对于 $t > 0$，提出非零的公因式：\n$$\n\\exp\\left(-\\frac{r^2}{4 D t}\\right) t^{-3/2} \\left[ -\\frac{1}{2} + \\frac{r^2}{4 D t} \\right] = 0\n$$\n该方程成立的条件是方括号内的项为零：\n$$\n-\\frac{1}{2} + \\frac{r^2}{4 D t} = 0\n$$\n解出 $t$ 即可得到扩散到达时间：\n$$\nt = \\frac{r^2}{2 D}\n$$\n因此，$t_{\\text{diff}}(r) = \\frac{r^2}{2 D}$。使用给定值 $r = 0.28\\,\\text{m}$ 和 $D = 1.1\\,\\text{m}^{2}\\,\\text{s}^{-1}$：\n$$\nt_{\\text{diff}}(r) = \\frac{(0.28\\,\\text{m})^2}{2 \\times (1.1\\,\\text{m}^{2}\\,\\text{s}^{-1})} = \\frac{0.0784}{2.2}\\,\\text{s} \\approx 3.5636 \\times 10^{-2}\\,\\text{s}\n$$\n\n现在我们有了计算 $S(r)$ 所需的所有分量。给定值为：\n- $t_{\\text{obs}}(r) = 1.90 \\times 10^{-4}\\,\\text{s}$\n- $t_{\\text{bal}}(r) \\approx 1.1667 \\times 10^{-4}\\,\\text{s}$\n- $t_{\\text{diff}}(r) \\approx 3.5636 \\times 10^{-2}\\,\\text{s}$\n\n我们计算 $S(r)$ 的分子：\n$$\n|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)| = |1.90 \\times 10^{-4} - 1.1667 \\times 10^{-4}|\\,\\text{s} = 0.7333 \\times 10^{-4}\\,\\text{s}\n$$\n接下来，我们计算 $S(r)$ 的分母：\n$$\n|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)| = |1.90 \\times 10^{-4} - 3.5636 \\times 10^{-2}|\\,\\text{s} = |0.000190 - 0.035636|\\,\\text{s} = |-0.035446|\\,\\text{s} = 3.5446 \\times 10^{-2}\\,\\text{s}\n$$\n最后，我们计算该比值：\n$$\nS(r) = \\frac{0.7333 \\times 10^{-4}\\,\\text{s}}{3.5446 \\times 10^{-2}\\,\\text{s}} \\approx 0.0020688\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nS(r) \\approx 0.00207\n$$\n该值也可以用科学记数法表示为 $2.07 \\times 10^{-3}$。由于 $S(r) \\ll 1$，这个结果表明观测到的到达时间明显更接近弹道预测，而不是扩散预测。",
            "answer": "$$\\boxed{2.07 \\times 10^{-3}}$$"
        },
        {
            "introduction": "理解了雪崩的传播特征后，我们进一步探究其背后的物理驱动机制。在托卡马克等离子体中，湍流输运通常受到一个“临界梯度”阈值的控制，这是理解输运“刚性”和雪崩现象的关键。本练习将引导你基于标准的湍流模型，推导当温度梯度瞬时超过临界值时，热通量会如何急剧增强。通过这个分析，你将亲手揭示输运刚性（stiffness）的非线性本质，即驱动（梯度）的微小增加如何导致输运（通量）的巨大响应。",
            "id": "3691357",
            "problem": "在托卡马克中，一个磁约束的氘等离子体表现出由离子温度梯度驱动的雪崩。考虑雪崩起源点附近的一个狭窄径向区域，在该区域，归一化温度梯度 $G \\equiv R/L_{T}$ 短暂地陡峭化，超过了临界稳定性阈值 $G_{c} \\equiv R/L_{T,\\text{crit}}$。假设以下具有物理动机且被广泛使用的基本关系：\n- 湍流离子热通量为 $Q_{i} \\sim n_{i} T_{i} \\chi_{i} |\\partial \\ln T_{i} / \\partial r|$，其中 $n_{i}$ 是离子密度，$T_{i}$ 是离子温度，而 $\\chi_{i}$ 是湍流离子热扩散系数。\n- 混合长度估计给出 $\\chi_{i} \\sim \\gamma_{\\text{lin}}/k_{\\perp}^{2}$，其中 $\\gamma_{\\text{lin}}$ 是主导模的线性增长率，$k_{\\perp}$ 是湍流的主导垂直波数。\n- 在临界稳定性附近，离子温度梯度模的线性增长率与过剩驱动的平方根成正比：$\\gamma_{\\text{lin}} \\propto \\omega_{*i} \\sqrt{G/G_{c} - 1}$，其中 $\\omega_{*i}$ 是离子逆磁频率，并且在同一半径处，基线条件和雪崩峰值条件之间的所有比例前因子都近似不变。\n\n设基线状态的梯度为 $G_{0}$，在雪崩起源处的瞬时峰值梯度为 $G_{A}$。你可以假设 $k_{\\perp}$、$\\omega_{*i}$ 以及 $Q_{i}$ 和 $\\gamma_{\\text{lin}}$ 中的前因子在这两种状态之间不发生变化。\n\n1. 仅使用上述关系和 $L_{T}^{-1} = G/R$，推导峰值通量增强因子 $F \\equiv Q_{i}(G_{A})/Q_{i}(G_{0})$ 的表达式，用 $G_{A}$、$G_{0}$ 和 $G_{c}$ 表示。然后将 $F$ 完全用在基线（$x_{0}$）和雪崩起源（$x_{A}$）处计算的过剩梯度 $x \\equiv G/G_{c} - 1$ 来重写，明确说明该增强与超出 $R/L_{T,\\text{crit}}$ 的过剩量有何关系。\n2. 对 $G_{c} = 5.0$，$G_{0} = 5.5$ 和 $G_{A} = 7.0$ 计算 $F$ 的值。\n\n将最终答案表示为无量纲比率，并将数值结果四舍五入到三位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于已建立的聚变等离子体湍流输运模型，是适定的，有足够的信息得到唯一解，并且用客观、正式的语言表述。我们可以开始解题。\n\n目标是推导峰值通量增强因子 $F \\equiv Q_{i}(G_{A})/Q_{i}(G_{0})$ 的表达式，首先用归一化温度梯度 $G_{A}$、$G_{0}$ 和临界梯度 $G_{c}$ 表示，然后用过剩梯度 $x_{A}$ 和 $x_{0}$ 表示。最后，我们将为给定的数值计算 $F$。\n\n我们首先构建离子热通量 $Q_i$ 关于归一化梯度 $G$ 的函数形式。问题提供了一组比例关系。我们引入比例常数 $C_1$、$C_2$ 和 $C_3$ 将它们写成方程。\n\n湍流离子热通量由下式给出：\n$$Q_{i} \\sim n_{i} T_{i} \\chi_{i} \\left|\\frac{\\partial \\ln T_{i}}{\\partial r}\\right|$$\n根据问题陈述，我们有关系式 $L_{T}^{-1} = G/R$，其中 $L_{T}^{-1} \\equiv |\\partial \\ln T_{i}/\\partial r|$。因此，我们可以写出：\n$$Q_{i} = C_1 n_{i} T_{i} \\chi_{i} \\frac{G}{R}$$\n\n离子热扩散系数 $\\chi_{i}$ 由混合长度估计给出：\n$$\\chi_{i} \\sim \\frac{\\gamma_{\\text{lin}}}{k_{\\perp}^{2}}$$\n这可以写成：\n$$\\chi_{i} = C_2 \\frac{\\gamma_{\\text{lin}}}{k_{\\perp}^{2}}$$\n\n在临界点附近，离子温度梯度（ITG）模的线性增长率 $\\gamma_{\\text{lin}}$ 为：\n$$\\gamma_{\\text{lin}} \\propto \\omega_{*i} \\sqrt{\\frac{G}{G_{c}} - 1}$$\n这可以写成：\n$$\\gamma_{\\text{lin}} = C_3 \\omega_{*i} \\sqrt{\\frac{G}{G_{c}} - 1}$$\n这个表达式在 $G > G_c$ 时有效。\n\n现在，我们组合这些表达式。将 $\\gamma_{\\text{lin}}$ 的方程代入 $\\chi_{i}$ 的方程中：\n$$\\chi_{i} = C_2 \\frac{1}{k_{\\perp}^{2}} \\left( C_3 \\omega_{*i} \\sqrt{\\frac{G}{G_{c}} - 1} \\right) = C_2 C_3 \\frac{\\omega_{*i}}{k_{\\perp}^{2}} \\sqrt{\\frac{G}{G_{c}} - 1}$$\n\n接下来，将这个组合后的 $\\chi_{i}$ 表达式代入 $Q_{i}$ 的方程中：\n$$Q_{i} = C_1 n_{i} T_{i} \\left( C_2 C_3 \\frac{\\omega_{*i}}{k_{\\perp}^{2}} \\sqrt{\\frac{G}{G_{c}} - 1} \\right) \\frac{G}{R}$$\n\n我们可以将各项分为一个常数前因子和依赖于 $G$ 的项：\n$$Q_{i}(G) = \\left( C_1 C_2 C_3 \\frac{n_{i} T_{i} \\omega_{*i}}{R k_{\\perp}^{2}} \\right) G \\sqrt{\\frac{G}{G_{c}} - 1}$$\n\n问题陈述中指出，$n_{i}$、$T_{i}$、$\\omega_{*i}$、$k_{\\perp}$ 以及所有比例前因子在基线和雪崩峰值状态之间是恒定的。大半径 $R$ 也是一个常数。因此，括号中的整个项是一个常数，我们将其记为 $K$。\n$$K = C_1 C_2 C_3 \\frac{n_{i} T_{i} \\omega_{*i}}{R k_{\\perp}^{2}}$$\n所以，离子热通量对归一化梯度 $G$ 的依赖关系是：\n$$Q_{i}(G) = K G \\sqrt{\\frac{G}{G_{c}} - 1}$$\n\n现在我们可以计算通量增强因子 $F$：\n$$F = \\frac{Q_{i}(G_{A})}{Q_{i}(G_{0})} = \\frac{K G_{A} \\sqrt{\\frac{G_{A}}{G_{c}} - 1}}{K G_{0} \\sqrt{\\frac{G_{0}}{G_{c}} - 1}}$$\n常数 $K$ 被消去，得到第一个要求的表达式：\n$$F = \\frac{G_{A}}{G_{0}} \\sqrt{\\frac{\\frac{G_{A}}{G_{c}} - 1}{\\frac{G_{0}}{G_{c}} - 1}}$$\n\n对于推导的第二部分，我们用过剩梯度 $x \\equiv G/G_{c} - 1$ 来重写 $F$。\n基线和雪崩峰值的过剩梯度分别是 $x_0 = G_0/G_c - 1$ 和 $x_A = G_A/G_c - 1$。\n$F$ 表达式中平方根下的项直接就是 $\\sqrt{x_{A}/x_{0}}$。\n我们还必须重新表示比率 $G_A/G_0$。根据 $x$ 的定义，我们有 $G = G_c(x+1)$。因此，该比率为：\n$$\\frac{G_{A}}{G_{0}} = \\frac{G_{c}(x_{A}+1)}{G_{c}(x_{0}+1)} = \\frac{x_{A}+1}{x_{0}+1}$$\n将这些代回 $F$ 的表达式中，我们得到第二个要求的表达式：\n$$F = \\left(\\frac{x_{A}+1}{x_{0}+1}\\right) \\sqrt{\\frac{x_{A}}{x_{0}}}$$\n\n现在，我们开始使用给定的数值计算 $F$：$G_{c} = 5.0$，$G_{0} = 5.5$ 和 $G_{A} = 7.0$。我们可以使用任一个推导出的 $F$ 的公式。使用第一个公式：\n$$F = \\frac{7.0}{5.5} \\sqrt{\\frac{\\frac{7.0}{5.0} - 1}{\\frac{5.5}{5.0} - 1}}$$\n首先，我们计算平方根内部的项：\n$$\\frac{G_{A}}{G_{c}} - 1 = \\frac{7.0}{5.0} - 1 = 1.4 - 1 = 0.4$$\n$$\\frac{G_{0}}{G_{c}} - 1 = \\frac{5.5}{5.0} - 1 = 1.1 - 1 = 0.1$$\n将这些值代回 $F$ 的表达式中：\n$$F = \\frac{7.0}{5.5} \\sqrt{\\frac{0.4}{0.1}} = \\frac{70}{55} \\sqrt{4} = \\frac{14}{11} \\times 2 = \\frac{28}{11}$$\n为了得到最终的数值结果，我们计算该分式的值并四舍五入到三位有效数字：\n$$F = \\frac{28}{11} \\approx 2.545454...$$\n四舍五入到三位有效数字得到 $2.55$。\n通量增强因子是一个无量纲比率，正如预期。\n最终结果约等于 $2.55$。",
            "answer": "$$\\boxed{2.55}$$"
        },
        {
            "introduction": "前面的练习建立了雪崩现象的理论基础。现在，我们将理论付诸实践，学习如何从（模拟的）实验数据中识别和量化这些现象。由于雪崩表现出“超扩散”行为，其传播标度律介于弹道传播和经典扩散之间，可以用分数阶输运模型来描述。本计算练习要求你编写一个程序，将热脉冲传播的分数阶标度律 $t \\propto r^{\\alpha}$ 拟合到合成数据上，通过寻找最佳指数 $\\alpha$ 来量化事件的超扩散特性，并以此证明该模型相比于经典扩散模型在描述雪崩事件上的优越性。",
            "id": "3691311",
            "problem": "考虑在磁约束核聚变等离子体中的热脉冲传播，其中间歇性雪崩输运现象会产生非局域的、超扩散性的热能展宽。从能量守恒出发，它通过 $ \\partial_t T = -\\nabla \\cdot \\mathbf{q} + S $ 约束了温度标量场 $T(\\mathbf{x},t)$ 的演化，其中 $\\mathbf{q}$ 是热通量，$S$ 是外部施加的源。在局域菲克扩散中，$\\mathbf{q} = -\\chi \\nabla T$，这导出了经典扩散方程。在存在雪崩的情况下，非局域输运可以通过一个空间分数阶闭包 $\\mathbf{q} \\propto - \\nabla^{\\alpha} T$ 来建模，该闭包基于一个阶数为 $\\alpha$（其中 $1  \\alpha \\leq 2$）的 Riesz 分数阶导数，它概括了由集体事件产生的类Lévy飞行的步长。在此类一维空间分数阶动力学中，对于一个脉冲式局域热源，与守恒和非局域通量闭包一致的标度律论证表明，特征位移尺度遵循 $ \\ell(t) \\propto t^{1/\\alpha} $，因此在径向位置 $r$ 处的最早到达时间 $ t_{\\mathrm{arr}}(r) $ 的标度关系为 $ t_{\\mathrm{arr}}(r) \\propto r^{\\alpha} $。这种超扩散标度律（对于 $1  \\alpha  2$）不同于局域扩散情况，后者实际上由 $\\alpha=2$ 决定。\n\n您的任务是实现一个完整、可运行的程序，该程序将分数阶输运标度律拟合到为多个测试用例生成的热脉冲到达时间数据，通过最小二乘法确定最佳拟合的 $\\alpha$，并将残差与局域扩散拟合进行比较。对于一个固定的 $\\alpha$，定义模型 $ t_i \\approx \\kappa \\, r_i^{\\alpha} $，其中 $t_i$ 是以秒为单位的观测到的最早到达时间，$r_i$ 是以米为单位的径向位置，而 $\\kappa$ 是一个正常数比例常数，其单位为秒乘以米的 $-\\alpha$ 次方。对于每个测试用例：\n\n- 通过在 $1  \\alpha \\leq 2$ 和 $\\kappa > 0$ 的范围内最小化残差平方和 $ \\sum_i \\left( t_i - \\kappa r_i^{\\alpha} \\right)^2 $ 来估计参数对 $(\\alpha, \\kappa)$，使用以下两步法：\n  1. 对于给定的 $\\alpha$，以闭式解形式计算最小二乘最优的 $ \\kappa(\\alpha) $。\n  2. 在区间 $(1,2]$ 上的一个密集网格上搜索 $\\alpha$，以找到残差平方和的最小值点。\n- 通过固定 $\\alpha=2$ 并仅优化 $\\kappa$ 来计算局域扩散拟合。\n- 报告由 $ I = \\mathrm{RSS}_{\\mathrm{local}} / \\mathrm{RSS}_{\\mathrm{frac}} $ 定义的改进因子，其中 $\\mathrm{RSS}_{\\mathrm{local}}$ 是局域扩散拟合的残差平方和，而 $\\mathrm{RSS}_{\\mathrm{frac}}$ 是最佳分数阶拟合的残差平方和。$I>1$ 的值表示分数阶模型比局域扩散模型提供了更好的拟合。\n\n物理和数值单位：\n- 在整个问题中，$r$ 使用米（$\\mathrm{m}$），$t$ 使用秒（$\\mathrm{s}$）。参数 $\\kappa$ 的单位是 $\\mathrm{s}\\,\\mathrm{m}^{-\\alpha}$，而 $\\alpha$ 是无量纲的。\n- 所有可能出现的角度都应以弧度处理，尽管这里不需要。\n\n为确保科学真实性，您将把模型拟合到以下合成数据集测试套件，这些数据集是通过标度律加上加性高斯测量噪声生成的。在所有情况下，使用指定的参数和固定的随机种子确定性地生成 $t_i$，以确保可复现性。具体来说，对于每种情况，使用 $ t_i = \\kappa_{\\mathrm{true}} \\, r_i^{\\alpha_{\\mathrm{true}}} + \\varepsilon_i $，其中 $ \\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2) $，独立样本由一个以 $42$ 为种子的伪随机数生成器产生。生成 $t_i$ 后，如果任何样本由于噪声而变为非正数，则将其裁剪到 $10^{-6}\\,\\mathrm{s}$ 的一个小的正数下限，以保持物理真实性。在一种情况下，引入一个确定性的早到离群值来模拟一次强雪崩。\n\n测试套件：\n- 情况 1（超扩散，典型）：$ \\alpha_{\\mathrm{true}} = 1.3 $，$ \\kappa_{\\mathrm{true}} = 0.015\\,\\mathrm{s}\\,\\mathrm{m}^{-1.3} $，半径 $ r = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0]\\,\\mathrm{m} $，噪声标准差 $ \\sigma = 0.0008\\,\\mathrm{s} $。\n- 情况 2（近扩散）：$ \\alpha_{\\mathrm{true}} = 1.95 $，$ \\kappa_{\\mathrm{true}} = 0.02\\,\\mathrm{s}\\,\\mathrm{m}^{-1.95} $，半径 $ r = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0]\\,\\mathrm{m} $，噪声标准差 $ \\sigma = 0.0005\\,\\mathrm{s} $。\n- 情况 3（精确扩散边界）：$ \\alpha_{\\mathrm{true}} = 2.0 $，$ \\kappa_{\\mathrm{true}} = 0.018\\,\\mathrm{s}\\,\\mathrm{m}^{-2.0} $，半径 $ r = [0.15, 0.25, 0.4, 0.6, 0.9]\\,\\mathrm{m} $，噪声标准差 $ \\sigma = 0.0003\\,\\mathrm{s} $。\n- 情况 4（稀疏，强超扩散）：$ \\alpha_{\\mathrm{true}} = 1.2 $，$ \\kappa_{\\mathrm{true}} = 0.012\\,\\mathrm{s}\\,\\mathrm{m}^{-1.2} $，半径 $ r = [0.2, 0.8]\\,\\mathrm{m} $，噪声标准差 $ \\sigma = 0.0010\\,\\mathrm{s} $。\n- 情况 5（带有早到离群值的超扩散）：$ \\alpha_{\\mathrm{true}} = 1.4 $，$ \\kappa_{\\mathrm{true}} = 0.013\\,\\mathrm{s}\\,\\mathrm{m}^{-1.4} $，半径 $ r = [0.1, 0.3, 0.6, 0.9]\\,\\mathrm{m} $，噪声标准差 $ \\sigma = 0.0005\\,\\mathrm{s} $。生成含噪声的 $t_i$ 后，仅从最大半径的测量值（即 $ r=0.9\\,\\mathrm{m} $ 处的样本）中减去一个确定性爆发偏移量 $ \\delta = 0.004\\,\\mathrm{s} $，然后如有必要则裁剪到正数下限。\n\n算法规范：\n- 在 $ (1, 2] $ 上使用步长为 $ 0.001 $ 的密集均匀 $\\alpha$ 值网格。\n- 对于网格上的每个候选 $\\alpha$，计算 $ \\kappa(\\alpha) = \\dfrac{\\sum_i t_i r_i^{\\alpha}}{\\sum_i r_i^{2\\alpha}} $ 及其残差平方和 $ \\mathrm{RSS}(\\alpha) = \\sum_i \\left( t_i - \\kappa(\\alpha) r_i^{\\alpha} \\right)^2 $。\n- 选择具有最小 $ \\mathrm{RSS}(\\alpha) $ 的 $\\alpha$；这决定了 $ \\alpha_{\\mathrm{best}} $ 和 $ \\kappa_{\\mathrm{best}} $。\n- 对于局域扩散模型，固定 $ \\alpha=2 $ 并计算 $ \\kappa_{\\mathrm{local}} = \\dfrac{\\sum_i t_i r_i^{2}}{\\sum_i r_i^{4}} $。类似地计算 $ \\mathrm{RSS}_{\\mathrm{local}} $。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含所有五个测试用例的串联结果，形式为包含在方括号中的逗号分隔列表。对于每个用例，输出两个浮点数：最佳拟合的 $ \\alpha_{\\mathrm{best}} $ 和改进因子 $ I $。将每个浮点数四舍五入到 $6$ 位小数。因此，最终输出的格式应为 $ [\\alpha_1, I_1, \\alpha_2, I_2, \\alpha_3, I_3, \\alpha_4, I_4, \\alpha_5, I_5] $，不含空格。\n\n不允许用户输入或外部文件；所有数据必须由程序根据上述规范在内部生成。逻辑必须完全确定性和可复现，使用指定的随机种子 $42$ 生成噪声。",
            "solution": "该问题要求实现一个数据分析程序，将分数阶输运模型拟合到代表聚变等离子体中热脉冲传播的合成数据。核心任务是确定标度律 $t_{\\mathrm{arr}} \\propto r^{\\alpha}$ 中的指数 $\\alpha$（其中 $t_{\\mathrm{arr}}$ 是在半径 $r$ 处的到达时间），并比较此分数阶模型（$1  \\alpha \\leq 2$）与经典扩散模型（$\\alpha=2$）的拟合优度。\n\n首先，我们将拟合过程形式化。关联径向位置 $r_i$ 处的观测到达时间 $t_i$ 的模型由下式给出：\n$$t_i \\approx \\kappa r_i^{\\alpha}$$\n其中 $\\kappa$ 是一个比例常数，$\\alpha$ 是分数阶指数。参数 $(\\alpha, \\kappa)$ 通过最小化残差平方和（RSS）来估计，其定义为：\n$$ \\mathrm{RSS}(\\alpha, \\kappa) = \\sum_{i} \\left( t_i - \\kappa r_i^{\\alpha} \\right)^2 $$\n最小化被约束在域 $1  \\alpha \\leq 2$ 和 $\\kappa > 0$ 上。\n\n问题指定了一个两步优化过程。\n首先，对于指数 $\\alpha$ 的一个固定值，关于 $\\kappa$ 最小化 $\\mathrm{RSS}$ 的问题是一个线性最小二乘问题。通过将 $\\mathrm{RSS}$ 关于 $\\kappa$ 的偏导数设为零来找到最优的 $\\kappa$：\n$$ \\frac{\\partial \\mathrm{RSS}}{\\partial \\kappa} = \\frac{\\partial}{\\partial \\kappa} \\sum_{i} \\left( t_i^2 - 2 \\kappa t_i r_i^{\\alpha} + \\kappa^2 r_i^{2\\alpha} \\right) = \\sum_{i} \\left( -2 t_i r_i^{\\alpha} + 2 \\kappa r_i^{2\\alpha} \\right) = 0 $$\n求解 $\\kappa$ 得到最优值，记作 $\\kappa(\\alpha)$：\n$$ \\kappa \\sum_{i} r_i^{2\\alpha} = \\sum_{i} t_i r_i^{\\alpha} $$\n$$ \\kappa(\\alpha) = \\frac{\\sum_{i} t_i r_i^{\\alpha}}{\\sum_{i} r_i^{2\\alpha}} $$\n该表达式保证为正，因为物理约束确保 $r_i > 0$，且带裁剪的数据生成过程确保 $t_i > 0$。\n\n其次，我们将这个最优的 $\\kappa(\\alpha)$ 代回 RSS 表达式中，以获得一个仅关于 $\\alpha$ 的函数：\n$$ \\mathrm{RSS}(\\alpha) = \\sum_{i} \\left( t_i - \\kappa(\\alpha) r_i^{\\alpha} \\right)^2 $$\n为了找到最佳拟合指数 $\\alpha_{\\mathrm{best}}$，我们在指定区间 $\\alpha \\in (1, 2]$ 上执行网格搜索。问题指定了一个步长为 $0.001$ 的均匀网格。对于每个网格点 $\\alpha_j$，我们计算 $\\kappa(\\alpha_j)$，然后计算 $\\mathrm{RSS}(\\alpha_j)$。值 $\\alpha_{\\mathrm{best}}$ 是产生最小 RSS 值的网格点。我们将此最小值记为 $\\mathrm{RSS}_{\\mathrm{frac}}$。\n\n为了进行比较，我们评估了标准的局域扩散模型，这对应于将指数固定为 $\\alpha=2$。相应的比例常数 $\\kappa_{\\mathrm{local}}$ 使用 $\\alpha=2$ 的推导公式计算：\n$$ \\kappa_{\\mathrm{local}} = \\kappa(\\alpha=2) = \\frac{\\sum_{i} t_i r_i^{2}}{\\sum_{i} r_i^{4}} $$\n此局域模型的残差平方和 $\\mathrm{RSS}_{\\mathrm{local}}$ 为：\n$$ \\mathrm{RSS}_{\\mathrm{local}} = \\sum_{i} \\left( t_i - \\kappa_{\\mathrm{local}} r_i^{2} \\right)^2 $$\n\n最后，我们使用改进因子 $I$ 来量化分数阶模型相对于局域扩散模型的性能：\n$$ I = \\frac{\\mathrm{RSS}_{\\mathrm{local}}}{\\mathrm{RSS}_{\\mathrm{frac}}} $$\n改进因子 $I > 1$ 表明，具有优化指数 $\\alpha_{\\mathrm{best}}$ 的分数阶模型比经典扩散模型能更好地拟合数据。\n\n实现将首先按照规定为五个测试用例生成合成数据集。对于每个用例，我们将生成理想时间数据 $t_i^{\\mathrm{ideal}} = \\kappa_{\\mathrm{true}} r_i^{\\alpha_{\\mathrm{true}}}$，使用以 $42$ 为种子的随机数生成器添加高斯噪声 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 以确保可复现性，然后应用任何指定的修改（如情况 5 中的离群值）以及对非正值的裁剪（下限为 $10^{-6}\\,\\mathrm{s}$）。在数据生成之后，我们将执行上述两步拟合算法以确定 $\\alpha_{\\mathrm{best}}$ 和 $\\mathrm{RSS}_{\\mathrm{frac}}$。然后，我们将计算 $\\mathrm{RSS}_{\\mathrm{local}}$ 和改进因子 $I$。所有用例的结果将被收集并格式化为所要求的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Per problem specification, no other libraries are permitted.\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the fractional transport model fitting problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1 (superdiffusive, typical)\",\n            \"alpha_true\": 1.3,\n            \"kappa_true\": 0.015,\n            \"r\": np.array([0.1, 0.2, 0.3, 0.5, 0.8, 1.0]),\n            \"sigma\": 0.0008,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 2 (near-diffusive)\",\n            \"alpha_true\": 1.95,\n            \"kappa_true\": 0.02,\n            \"r\": np.array([0.1, 0.2, 0.3, 0.5, 0.8, 1.0]),\n            \"sigma\": 0.0005,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 3 (exactly diffusive boundary)\",\n            \"alpha_true\": 2.0,\n            \"kappa_true\": 0.018,\n            \"r\": np.array([0.15, 0.25, 0.4, 0.6, 0.9]),\n            \"sigma\": 0.0003,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 4 (sparse, strong superdiffusion)\",\n            \"alpha_true\": 1.2,\n            \"kappa_true\": 0.012,\n            \"r\": np.array([0.2, 0.8]),\n            \"sigma\": 0.0010,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 5 (superdiffusive with an early-arrival outlier)\",\n            \"alpha_true\": 1.4,\n            \"kappa_true\": 0.013,\n            \"r\": np.array([0.1, 0.3, 0.6, 0.9]),\n            \"sigma\": 0.0005,\n            \"outlier_mod\": {\"index\": -1, \"delta\": -0.004} # Subtract from last element\n        }\n    ]\n\n    results = []\n    \n    # Use a single random number generator for all cases, seeded as specified.\n    # numpy version 1.23.5 is specified, which supports this.\n    rng = np.random.default_rng(42)\n\n    # Define the alpha grid for the search\n    # Grid is on (1, 2] with step 0.001\n    alpha_grid = np.arange(1.001, 2.001, 0.001)\n\n    def calculate_rss(t_obs, r_obs, alpha):\n        \"\"\"\n        Calculates the Residual Sum of Squares (RSS) for a given alpha.\n        This function implicitly computes the optimal kappa for the given alpha.\n        \"\"\"\n        r_pow_alpha = r_obs ** alpha\n        # Calculate optimal kappa for this alpha\n        kappa_opt = np.sum(t_obs * r_pow_alpha) / np.sum(r_pow_alpha**2)\n        # Calculate predicted t values\n        t_pred = kappa_opt * r_pow_alpha\n        # Calculate RSS\n        rss = np.sum((t_obs - t_pred)**2)\n        return rss\n\n    for case in test_cases:\n        # 1. Generate synthetic data for the current case\n        r_obs = case[\"r\"]\n        t_ideal = case[\"kappa_true\"] * (r_obs ** case[\"alpha_true\"])\n        \n        # Add Gaussian noise\n        noise = rng.normal(loc=0.0, scale=case[\"sigma\"], size=len(r_obs))\n        t_obs = t_ideal + noise\n\n        # Apply outlier modification if specified\n        if case[\"outlier_mod\"]:\n            idx = case[\"outlier_mod\"][\"index\"]\n            delta = case[\"outlier_mod\"][\"delta\"]\n            t_obs[idx] += delta\n            \n        # Clip any non-positive values to the specified floor\n        clip_floor = 1e-6\n        t_obs[t_obs = 0] = clip_floor\n\n        # 2. Perform the fitting procedure for the fractional model\n        rss_values = [calculate_rss(t_obs, r_obs, alpha) for alpha in alpha_grid]\n        \n        # Find the best alpha that minimizes RSS\n        min_rss_index = np.argmin(rss_values)\n        alpha_best = alpha_grid[min_rss_index]\n        rss_frac = rss_values[min_rss_index]\n        \n        # 3. Calculate the fit for the local diffusion model (alpha=2)\n        rss_local = calculate_rss(t_obs, r_obs, 2.0)\n        \n        # 4. Compute the improvement factor\n        # Handle potential division by zero, although unlikely with real data\n        if rss_frac > 0:\n            improvement_factor = rss_local / rss_frac\n        else:\n            # If rss_frac is zero (perfect fit), improvement is infinite or undefined.\n            # Set to a large number or handle as per context. Here, we assume it won't happen.\n            improvement_factor = np.inf \n\n        # 5. Store results rounded to 6 decimal places for final formatting\n        results.append(round(alpha_best, 6))\n        results.append(round(improvement_factor, 6))\n\n    # Final print statement in the exact required format\n    formatted_results = [f\"{v:.6f}\" for v in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}