{
    "hands_on_practices": [
        {
            "introduction": "A central consequence of avalanche transport is the phenomenon of \"profile stiffness,\" where the plasma temperature profile resists steepening beyond a critical gradient value, $\\kappa_c$. This exercise allows you to derive the steady-state temperature profile $T(r)$ from first principles in a system governed by such a thresholded transport model. By solving this problem , you will gain a concrete understanding of how the microscopic rules of turbulence self-organize to establish a global, macroscopic plasma profile.",
            "id": "3691380",
            "problem": "Consider a large aspect-ratio, axisymmetric, cylindrical fusion plasma of minor radius $a$, with radial coordinate $r \\in [0,a]$ measured from the magnetic axis. Let $T(r)$ denote the ion temperature profile in steady state. Assume radial heat transport is governed by energy conservation and a thresholded transport response associated with avalanche phenomena:\n- Energy conservation (steady state) requires the radial heat flux $q(r)$ to satisfy $\\frac{1}{r}\\frac{d}{dr}\\big(r\\,q(r)\\big) = S(r)$, where $S(r)$ is the volumetric heating density.\n- Below a critical temperature gradient magnitude $\\kappa_c$ (critical gradient threshold), local transport follows a Fourier-like constitutive relation $q(r) = -K_L\\,\\frac{dT}{dr}$, where $K_L$ is a constant effective thermal conductivity (units $\\mathrm{W/(m\\cdot keV)}$).\n- If the magnitude of the local gradient $|\\frac{dT}{dr}|$ would exceed the threshold $\\kappa_c$, avalanche transport self-organizes to clamp the gradient at $|\\frac{dT}{dr}|=\\kappa_c$ by increasing the effective transport intensity as needed to maintain that bound. In other words, the profile is stiff: wherever the drive would otherwise exceed $\\kappa_c$, the realized steady-state gradient takes the value $\\frac{dT}{dr}=-\\kappa_c$ (negative sign for outwardly decreasing $T$).\n\nAssume a localized core heating region of radius $r_0$ with constant source $S(r)=S_0$ for $0\\le r\\le r_0$ and $S(r)=0$ for $r_0r\\le a$, with $S_00$. Impose the boundary conditions $\\frac{dT}{dr}\\big|_{r=0}=0$ (symmetry at the axis) and $T(a)=T_a$ (fixed edge temperature), with $T_a$ a given constant. Consider the parameter regime in which the unsaturated, low-transport solution would reach the threshold within the source region, i.e., $0\\frac{2K_L\\kappa_c}{S_0}r_0a$.\n\nStarting only from the above statements of energy conservation and the thresholded transport response, derive the steady-state temperature profile $T(r)$. Your final answer must be a single closed-form analytic expression for $T(r)$ valid on $[0,a]$, in terms of $r$, $a$, $r_0$, $S_0$, $K_L$, $\\kappa_c$, and $T_a$. Express the temperature in kiloelectronvolts (keV). No rounding is required.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Governing Equation (Energy Conservation)**: $\\frac{1}{r}\\frac{d}{dr}\\big(r\\,q(r)\\big) = S(r)$ for the radial heat flux $q(r)$ in a cylindrical plasma of radius $a$.\n- **Heating Source Density**: $S(r) = S_0$ for $0 \\le r \\le r_0$ and $S(r)=0$ for $r_0  r \\le a$, with $S_00$.\n- **Boundary Conditions**: $\\frac{dT}{dr}\\big|_{r=0}=0$ (symmetry) and $T(a)=T_a$ (fixed edge temperature).\n- **Transport Model**:\n    1. A critical temperature gradient magnitude, $\\kappa_c  0$.\n    2. For $|\\frac{dT}{dr}|  \\kappa_c$, the transport is linear: $q(r) = -K_L \\frac{dT}{dr}$, where $K_L$ is a constant thermal conductivity.\n    3. If the gradient magnitude driven by the local heat flux were to exceed $\\kappa_c$, transport self-organizes to clamp the gradient at this threshold value. Since heat flows outward, $T(r)$ is a decreasing function of $r$, so $\\frac{dT}{dr} = -\\kappa_c$.\n- **Parameter Regime**: The constants satisfy the inequality $0  \\frac{2K_L\\kappa_c}{S_0}  r_0  a$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The model is a well-established simplified paradigm in fusion plasma physics used to study \"stiff\" transport profiles arising from microturbulence that is stabilized below a critical gradient threshold. The energy conservation equation is fundamental. The problem is scientifically sound.\n2.  **Well-Posed**: The problem consists of a differential equation for temperature, derived from energy conservation and a constitutive relation for heat flux, supplemented with well-defined boundary conditions. The provided parameter regime inequality ensures a non-trivial interaction between the different transport laws, indicating a structured problem likely to have a unique and stable solution. The problem is well-posed.\n3.  **Objective**: The problem is stated in precise, mathematical language with no subjective or ambiguous terms. It is objective.\n4.  **Completeness and Consistency**: All necessary parameters ($a, r_0, S_0, K_L, \\kappa_c, T_a$) and physical laws are provided. The boundary conditions are consistent with the cylindrical geometry and a fixed-temperature boundary. The setup is complete and consistent.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and internally consistent. I will proceed with the derivation of the solution.\n\n### Solution Derivation\nThe derivation of the steady-state temperature profile $T(r)$ proceeds in three main stages: first, determining the heat flux $q(r)$ from energy conservation; second, establishing the radial profile of the temperature gradient $\\frac{dT}{dr}$ based on the thresholded transport model; and third, integrating the gradient profile subject to the boundary conditions to obtain $T(r)$.\n\n**1. Radial Heat Flux Profile, $q(r)$**\nThe steady-state energy conservation equation is $\\frac{d}{dr}(r\\,q(r)) = r S(r)$. Integrating from the magnetic axis ($r=0$) to an arbitrary radius $r$ yields:\n$$r\\,q(r) - 0 \\cdot q(0) = \\int_0^r r' S(r') dr'$$\nAssuming the flux $q(0)$ is finite, the boundary term at $r=0$ vanishes. The flux is thus $q(r) = \\frac{1}{r} \\int_0^r r' S(r') dr'$.\nWe evaluate this integral for the two regions defined by the heating profile:\n-   For $0 \\le r \\le r_0$: $S(r')=S_0$.\n    $$q(r) = \\frac{1}{r} \\int_0^r r' S_0 dr' = \\frac{S_0}{r} \\left[\\frac{r'^2}{2}\\right]_0^r = \\frac{S_0 r}{2}$$\n-   For $r_0  r \\le a$: $S(r')$ is non-zero only up to $r_0$.\n    $$q(r) = \\frac{1}{r} \\left( \\int_0^{r_0} r' S_0 dr' + \\int_{r_0}^r r' \\cdot 0 \\cdot dr' \\right) = \\frac{1}{r} \\left( S_0 \\frac{r_0^2}{2} \\right) = \\frac{S_0 r_0^2}{2r}$$\nThe resulting heat flux profile is continuous at $r=r_0$ and is given by:\n$$q(r) = \\begin{cases} \\frac{S_0 r}{2}  \\text{for } 0 \\le r \\le r_0 \\\\ \\frac{S_0 r_0^2}{2r}  \\text{for } r_0  r \\le a \\end{cases}$$\n\n**2. Temperature Gradient Profile, $\\frac{dT}{dr}$**\nThe temperature gradient is determined by the transport law. The local gradient magnitude $|\\frac{dT}{dr}|$ is set by the smaller of the critical threshold $\\kappa_c$ and the magnitude required by the low-transport law, which is $\\frac{q(r)}{K_L}$. Since temperature decreases outward, $\\frac{dT}{dr} \\le 0$.\n$$\\frac{dT}{dr} = - \\min\\left(\\frac{q(r)}{K_L}, \\kappa_c\\right)$$\nWe must identify the regions where the system is in the low-transport (sub-critical) or avalanche (critical) state by comparing $\\frac{q(r)}{K_L}$ to $\\kappa_c$.\n-   For $0 \\le r \\le r_0$: The condition for being at or above critical is $\\frac{q(r)}{K_L} \\ge \\kappa_c$, which translates to $\\frac{S_0 r}{2K_L} \\ge \\kappa_c$, or $r \\ge \\frac{2K_L\\kappa_c}{S_0}$. Let us define the critical radius $r_c = \\frac{2K_L\\kappa_c}{S_0}$. The problem states $0  r_c  r_0$, so the gradient is clamped at $-\\kappa_c$ for $r \\in [r_c, r_0]$. For $r \\in [0, r_c)$, the gradient is $-\\frac{S_0 r}{2K_L}$.\n-   For $r_0  r \\le a$: The condition for being at or above critical is $\\frac{q(r)}{K_L} \\ge \\kappa_c$, which translates to $\\frac{S_0 r_0^2}{2K_L r} \\ge \\kappa_c$, or $r \\le \\frac{S_0 r_0^2}{2K_L\\kappa_c}$. Let us define this second critical radius $r_s = \\frac{S_0 r_0^2}{2K_L\\kappa_c}$. Note that $r_s = \\frac{r_0^2}{r_c}$. Since $r_0  r_c$, it follows that $r_s  r_0$. The gradient is clamped at $-\\kappa_c$ for $r \\in (r_0, r_s]$. For $r  r_s$, the gradient is $-\\frac{S_0 r_0^2}{2K_L r}$.\n\nCombining these findings, the full avalanche-dominated (clamped) region is $[r_c, r_s]$. However, the plasma only extends to $r=a$. Thus, the effective clamped region is $[r_c, r_s^*]$, where $r_s^* = \\min(r_s, a)$. The full radial profile of the temperature gradient is:\n$$\\frac{dT}{dr}(r) = \\begin{cases} -\\frac{S_0 r}{2K_L}  \\text{for } 0 \\le r  r_c \\\\ -\\kappa_c  \\text{for } r_c \\le r \\le r_s^* \\\\ -\\frac{S_0 r_0^2}{2K_L r}  \\text{for } r_s^*  r \\le a \\end{cases}$$\nThe third region exists only if $r_s^*  a$, which is equivalent to $r_s  a$.\n\n**3. Temperature Profile, $T(r)$**\nWe find the temperature profile by integrating $\\frac{dT}{dr}$ inward from the edge boundary condition $T(a)=T_a$.\n$$T(r) = T(a) - \\int_r^a \\frac{dT}{dr'} dr' = T_a + \\int_r^a \\left(-\\frac{dT}{dr'}\\right) dr'$$\nWe evaluate this integral piecewise for the different regions of $r$.\n\n-   **Case 1: $r_s^*  r \\le a$** (This is the outermost, sub-critical region, existing only if $r_s  a$)\n    In this region, the integral is simple:\n    $$T(r) = T_a + \\int_r^a \\frac{S_0 r_0^2}{2K_L r'} dr' = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r}\\right)$$\n\n-   **Case 2: $r_c  r \\le r_s^*$** (This is the critical/clamped region)\n    The integral must be split at $r_s^*$:\n    $$T(r) = T_a + \\int_r^{r_s^*} \\kappa_c dr' + \\int_{r_s^*}^a \\left(-\\frac{dT}{dr'}\\right) dr'$$\n    The second integral corresponds to the temperature rise from $a$ to $r_s^*$, which is $T(r_s^*) - T_a$. From Case 1 (or by direct integration if $r_s^*=a$), $T(r_s^*) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right)$ (note this term is zero if $r_s^*=a$).\n    So, $T(r) = T(r_s^*) + \\kappa_c (r_s^*-r) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^* - r)$.\n\n-   **Case 3: $0 \\le r \\le r_c$** (This is the innermost, sub-critical region)\n    The integral is split at $r_c$ and $r_s^*$:\n    $$T(r) = T_a + \\int_r^{r_c} \\frac{S_0 r'}{2K_L} dr' + \\int_{r_c}^{r_s^*} \\kappa_c dr' + \\int_{r_s^*}^a \\left(-\\frac{dT}{dr'}\\right) dr'$$\n    The last two terms constitute the temperature rise from $a$ to $r_c$, which is $T(r_c) - T_a$. From Case 2, this is $T(r_c) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^* - r_c)$.\n    The first integral is $\\frac{S_0}{2K_L} \\int_r^{r_c} r' dr' = \\frac{S_0}{4K_L}(r_c^2 - r^2)$.\n    Combining these gives:\n    $$T(r) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^* - r_c) + \\frac{S_0}{4K_L}(r_c^2 - r^2)$$\n\nThese three expressions form a single, continuous function for $T(r)$ across the domain $[0, a]$. This is the complete solution.",
            "answer": "$$\n\\boxed{\nT(r) = T_a + \\begin{cases} \\frac{S_0 r_0^2}{2K_L}\\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^*-r_c) + \\frac{S_0}{4K_L}(r_c^2-r^2)  \\text{for } 0 \\le r \\le r_c \\\\ \\frac{S_0 r_0^2}{2K_L}\\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^*-r)  \\text{for } r_c  r \\le r_s^* \\\\ \\frac{S_0 r_0^2}{2K_L}\\ln\\left(\\frac{a}{r}\\right)  \\text{for } r_s^*  r \\le a \\end{cases} \\quad \\text{where } r_c = \\frac{2K_L\\kappa_c}{S_0}, \\ r_s = \\frac{r_0^2}{r_c}, \\text{ and } r_s^* = \\min(r_s, a)\n}\n$$"
        },
        {
            "introduction": "While profile stiffness describes the time-averaged state, the underlying transport events are dynamic. This practice problem focuses on the fundamental signature of an avalanche: its rapid, ballistic-like propagation, which contrasts sharply with slow, classical diffusion. You will develop a quantitative framework  to distinguish these two regimes by deriving their characteristic propagation time scalings, $t_{\\text{bal}} \\propto r$ versus $t_{\\text{diff}} \\propto r^2$, and applying them to classify a transport event.",
            "id": "3691401",
            "problem": "A small, localized heat pulse is triggered at the magnetic axis of a magnetically confined fusion plasma at time $t=0$. Along the minor radius, the ensuing heat transport is observed at a radius $r$, and two competing mechanisms are hypothesized: (i) diffusive transport governed by a constant thermal diffusivity $D$, and (ii) ballistic-like avalanche transport characterized by a constant front speed $v_{\\text{front}}$. Assume one-dimensional radial transport for the purpose of this analysis.\n\nUsing only fundamental laws and core definitions:\n- For the diffusive hypothesis, start from the one-dimensional heat equation $\\partial T/\\partial t = D\\, \\partial^{2}T/\\partial r^{2}$ with an impulsive initial condition at $r=0$ at $t=0$. Define the diffusive arrival time $t_{\\text{diff}}(r)$ as the time at which the local temperature perturbation at radius $r$ attains its maximum value.\n- For the ballistic hypothesis, use kinematics to define the ballistic arrival time $t_{\\text{bal}}(r)$ for a front propagating at constant speed $v_{\\text{front}}$.\n\nThen, define a dimensionless discrimination index\n$$\nS(r) \\equiv \\frac{\\left|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)\\right|}{\\left|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)\\right|},\n$$\nwhere $t_{\\text{obs}}(r)$ is the experimentally observed arrival time at radius $r$. A value $S(r)  1$ indicates that the observation is closer to the ballistic prediction, while $S(r)  1$ indicates that it is closer to the diffusive prediction. Take\n- $r = 0.28\\,\\text{m}$,\n- $D = 1.1\\,\\text{m}^{2}\\,\\text{s}^{-1}$,\n- $v_{\\text{front}} = 2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$,\n- $t_{\\text{obs}}(r) = 1.90 \\times 10^{-4}\\,\\text{s}$.\n\nCompute $S(r)$. Express the final answer as a dimensionless number rounded to three significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective. All necessary data and definitions are provided to compute a unique solution. We may therefore proceed with the solution.\n\nThe objective is to compute the dimensionless discrimination index $S(r)$, defined as:\n$$\nS(r) \\equiv \\frac{\\left|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)\\right|}{\\left|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)\\right|}\n$$\nThis requires the calculation of the ballistic arrival time, $t_{\\text{bal}}(r)$, and the diffusive arrival time, $t_{\\text{diff}}(r)$, using the provided models and parameters. The observed arrival time, $t_{\\text{obs}}(r)$, is given.\n\nFirst, we calculate the ballistic arrival time, $t_{\\text{bal}}(r)$. The ballistic hypothesis posits that a transport front propagates radially outward from the magnetic axis ($r=0$) at a constant speed, $v_{\\text{front}}$. The time required for this front to travel a distance $r$ is given by elementary kinematics:\n$$\nt_{\\text{bal}}(r) = \\frac{r}{v_{\\text{front}}}\n$$\nUsing the given values $r = 0.28\\,\\text{m}$ and $v_{\\text{front}} = 2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$:\n$$\nt_{\\text{bal}}(r) = \\frac{0.28\\,\\text{m}}{2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}} = \\frac{0.28}{2400}\\,\\text{s} \\approx 1.1667 \\times 10^{-4}\\,\\text{s}\n$$\n\nNext, we calculate the diffusive arrival time, $t_{\\text{diff}}(r)$. This is defined as the time at which the temperature perturbation at radius $r$ reaches its maximum value. The transport is governed by the one-dimensional heat equation with constant thermal diffusivity $D$:\n$$\n\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial r^2}\n$$\nThe initial condition is a localized heat pulse at the magnetic axis ($r=0$) at time $t=0$. This can be modeled as a Dirac delta function initial condition, $T(r, t=0) = E_0\\delta(r)$, where $E_0$ is a constant representing the total energy of the pulse per unit area. The solution to this initial value problem, known as the fundamental solution or Green's function for the heat equation in one dimension, is a Gaussian function:\n$$\nT(r, t) = \\frac{E_0}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{r^2}{4 D t}\\right)\n$$\nTo find the time $t_{\\text{diff}}(r)$ at which the temperature $T$ is maximum for a fixed radius $r > 0$, we must find the extremum of $T(r,t)$ with respect to time $t$. We calculate the partial derivative $\\frac{\\partial T}{\\partial t}$ and set it to zero:\n$$\n\\frac{\\partial T(r, t)}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{E_0}{\\sqrt{4 \\pi D}} t^{-1/2} \\exp\\left(-\\frac{r^2}{4 D}t^{-1}\\right) \\right] = 0\n$$\nApplying the product and chain rules for differentiation:\n$$\n\\frac{E_0}{\\sqrt{4 \\pi D}} \\left[ \\left(-\\frac{1}{2} t^{-3/2}\\right) \\exp\\left(-\\frac{r^2}{4 D t}\\right) + t^{-1/2} \\exp\\left(-\\frac{r^2}{4 D t}\\right) \\left(-\\frac{r^2}{4 D}\\right)\\left(-t^{-2}\\right) \\right] = 0\n$$\nFactoring out the common terms, which are non-zero for $t > 0$:\n$$\n\\exp\\left(-\\frac{r^2}{4 D t}\\right) t^{-3/2} \\left[ -\\frac{1}{2} + \\frac{r^2}{4 D t} \\right] = 0\n$$\nThis equation holds if the term in the brackets is zero:\n$$\n-\\frac{1}{2} + \\frac{r^2}{4 D t} = 0\n$$\nSolving for $t$ gives the diffusive arrival time:\n$$\nt = \\frac{r^2}{2 D}\n$$\nThus, $t_{\\text{diff}}(r) = \\frac{r^2}{2 D}$. Using the given values $r = 0.28\\,\\text{m}$ and $D = 1.1\\,\\text{m}^{2}\\,\\text{s}^{-1}$:\n$$\nt_{\\text{diff}}(r) = \\frac{(0.28\\,\\text{m})^2}{2 \\times (1.1\\,\\text{m}^{2}\\,\\text{s}^{-1})} = \\frac{0.0784}{2.2}\\,\\text{s} \\approx 3.5636 \\times 10^{-2}\\,\\text{s}\n$$\n\nWe now have all the necessary components to calculate $S(r)$. The given values are:\n- $t_{\\text{obs}}(r) = 1.90 \\times 10^{-4}\\,\\text{s}$\n- $t_{\\text{bal}}(r) \\approx 1.1667 \\times 10^{-4}\\,\\text{s}$\n- $t_{\\text{diff}}(r) \\approx 3.5636 \\times 10^{-2}\\,\\text{s}$\n\nWe compute the numerator of $S(r)$:\n$$\n|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)| = |1.90 \\times 10^{-4} - 1.1667 \\times 10^{-4}|\\,\\text{s} = 0.7333 \\times 10^{-4}\\,\\text{s}\n$$\nNext, we compute the denominator of $S(r)$:\n$$\n|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)| = |1.90 \\times 10^{-4} - 3.5636 \\times 10^{-2}|\\,\\text{s} = |0.000190 - 0.035636|\\,\\text{s} = |-0.035446|\\,\\text{s} = 3.5446 \\times 10^{-2}\\,\\text{s}\n$$\nFinally, we compute the ratio:\n$$\nS(r) = \\frac{0.7333 \\times 10^{-4}\\,\\text{s}}{3.5446 \\times 10^{-2}\\,\\text{s}} \\approx 0.020688\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\nS(r) \\approx 0.00207\n$$\nThis value can also be expressed in scientific notation as $2.07 \\times 10^{-3}$. Since $S(r) \\ll 1$, this result indicates that the observed arrival time is significantly closer to the ballistic prediction than to the diffusive prediction.",
            "answer": "$$\\boxed{2.07 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Bridging theory and experimental analysis requires robust quantitative models. Since avalanche transport is often \"superdiffusive\"—faster than diffusion but not purely ballistic—it can be described by fractional transport models where arrival time scales as $t \\propto r^{\\delta}$ with $1 \\lt \\delta \\lt 2$. This computational exercise  guides you through fitting this scaling law to synthetic data, a crucial skill for interpreting experimental results and determining the nature of the underlying transport physics.",
            "id": "3691311",
            "problem": "Consider heat pulse propagation in a magnetically confined nuclear fusion plasma where intermittent avalanche transport phenomena produce nonlocal, superdiffusive spreading of thermal energy. Begin from energy conservation, which constrains the evolution of temperature as a scalar field $T(\\mathbf{x},t)$ via $ \\partial_t T = -\\nabla \\cdot \\mathbf{q} + S $, with $\\mathbf{q}$ the heat flux and $S$ an externally applied source. In local Fickian diffusion, $\\mathbf{q} = -\\chi \\nabla T$, leading to the classical diffusion equation. In the presence of avalanching, nonlocal transport can be modeled by a space-fractional closure $\\mathbf{q} \\propto - \\nabla^{\\beta} T$ based on a Riesz fractional derivative of order $\\beta$, which encapsulates Lévy-flight-like step lengths arising from collective events. Under such space-fractional dynamics in one dimension with an impulsive localized heat source, scaling arguments consistent with conservation and the nonlocal flux closure imply that the characteristic displacement scale obeys $ \\ell(t) \\propto t^{1/\\delta} $, so that the earliest-arrival time at a radial location $r$ scales as $ t_{\\mathrm{arr}}(r) \\propto r^{\\delta} $. This superdiffusive scaling (for $1\\delta2$) differs from the local diffusive case, which is effectively determined by $\\delta=2$.\n\nYour task is to implement a complete, runnable program that fits the fractional transport scaling law to heat pulse arrival-time data generated for several test cases, determines the best-fit $\\delta$ by least squares, and compares residuals to a local diffusion fit. For a fixed $\\delta$, define the model $ t_i \\approx \\kappa \\, r_i^{\\delta} $, where $t_i$ are observed earliest-arrival times in seconds and $r_i$ are radial positions in meters, and $\\kappa$ is a positive proportionality constant with units of seconds times meters to the power $-\\delta$. For each test case:\n\n- Estimate the pair $(\\delta, \\kappa)$ by minimizing the sum of squared residuals $ \\sum_i \\left( t_i - \\kappa r_i^{\\delta} \\right)^2 $ over $1  \\delta \\leq 2$ and $\\kappa  0$, using the following two-step approach:\n  1. For a given $\\delta$, compute the least-squares optimal $ \\kappa(\\delta) $ in closed form.\n  2. Search $\\delta$ on a dense grid over the interval $(1,2]$ to find the minimizer of the residual sum of squares.\n- Compute the locally diffusive fit by fixing $\\delta=2$ and optimizing only $\\kappa$.\n- Report the improvement factor defined by $ I = \\mathrm{RSS}_{\\mathrm{local}} / \\mathrm{RSS}_{\\mathrm{frac}} $, where $\\mathrm{RSS}_{\\mathrm{local}}$ is the residual sum of squares for the local diffusive fit, and $\\mathrm{RSS}_{\\mathrm{frac}}$ is the residual sum of squares for the best fractional fit. Values $I1$ indicate that the fractional model provides a better fit than the local diffusion model.\n\nPhysical and numerical units:\n- Use meters ($\\mathrm{m}$) for $r$ and seconds ($\\mathrm{s}$) for $t$ throughout. The parameter $\\kappa$ has units $\\mathrm{s}\\,\\mathrm{m}^{-\\delta}$, and $\\delta$ is dimensionless.\n- All angles, if any arise, are to be treated in radians, although none are needed here.\n\nTo ensure scientific realism, you will fit the model to the following test suite of synthetic datasets, generated by the scaling law with additive Gaussian measurement noise. In all cases, generate $t_i$ deterministically using the specified parameters and a fixed random seed to ensure reproducibility. Specifically, for each case, use $ t_i = \\kappa_{\\mathrm{true}} \\, r_i^{\\delta_{\\mathrm{true}}} + \\varepsilon_i $, where $ \\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2) $, with independent samples produced by a pseudorandom number generator seeded with $42$. After generating $t_i$, if any sample is nonpositive due to noise, clip it to a small positive floor at $10^{-6}\\,\\mathrm{s}$ to maintain physical realism. In one case, introduce a deterministic early-arrival outlier to emulate a strong avalanche.\n\nTest suite:\n- Case $1$ (superdiffusive, typical): $ \\delta_{\\mathrm{true}} = 1.3 $, $ \\kappa_{\\mathrm{true}} = 0.015\\,\\mathrm{s}\\,\\mathrm{m}^{-1.3} $, radii $ r = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0]\\,\\mathrm{m} $, noise standard deviation $ \\sigma = 0.0008\\,\\mathrm{s} $.\n- Case $2$ (near-diffusive): $ \\delta_{\\mathrm{true}} = 1.95 $, $ \\kappa_{\\mathrm{true}} = 0.02\\,\\mathrm{s}\\,\\mathrm{m}^{-1.95} $, radii $ r = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0]\\,\\mathrm{m} $, noise standard deviation $ \\sigma = 0.0005\\,\\mathrm{s} $.\n- Case $3$ (exactly diffusive boundary): $ \\delta_{\\mathrm{true}} = 2.0 $, $ \\kappa_{\\mathrm{true}} = 0.018\\,\\mathrm{s}\\,\\mathrm{m}^{-2.0} $, radii $ r = [0.15, 0.25, 0.4, 0.6, 0.9]\\,\\mathrm{m} $, noise standard deviation $ \\sigma = 0.0003\\,\\mathrm{s} $.\n- Case $4$ (sparse, strong superdiffusion): $ \\delta_{\\mathrm{true}} = 1.2 $, $ \\kappa_{\\mathrm{true}} = 0.012\\,\\mathrm{s}\\,\\mathrm{m}^{-1.2} $, radii $ r = [0.2, 0.8]\\,\\mathrm{m} $, noise standard deviation $ \\sigma = 0.0010\\,\\mathrm{s} $.\n- Case $5$ (superdiffusive with an early-arrival outlier): $ \\delta_{\\mathrm{true}} = 1.4 $, $ \\kappa_{\\mathrm{true}} = 0.013\\,\\mathrm{s}\\,\\mathrm{m}^{-1.4} $, radii $ r = [0.1, 0.3, 0.6, 0.9]\\,\\mathrm{m} $, noise standard deviation $ \\sigma = 0.0005\\,\\mathrm{s} $. After generating the noisy $t_i$, subtract a deterministic burst offset $ \\delta_{burst} = 0.004\\,\\mathrm{s} $ from the largest-radius measurement only (i.e., the sample at $ r=0.9\\,\\mathrm{m} $), and then clip to the positive floor if necessary.\n\nAlgorithmic specification:\n- Use a dense uniform grid of $ \\delta $ values over $ (1, 2] $ with step $ 0.001 $.\n- For each candidate $ \\delta $ on the grid, compute $ \\kappa(\\delta) = \\dfrac{\\sum_i t_i r_i^{\\delta}}{\\sum_i r_i^{2\\delta}} $ and its residual sum of squares $ \\mathrm{RSS}(\\delta) = \\sum_i \\left( t_i - \\kappa(\\delta) r_i^{\\delta} \\right)^2 $.\n- Select the $ \\delta $ with minimal $ \\mathrm{RSS}(\\delta) $; this determines $ \\delta_{\\mathrm{best}} $ and $ \\kappa_{\\mathrm{best}} $.\n- For the local diffusion model, fix $ \\delta=2 $ and compute $ \\kappa_{\\mathrm{local}} = \\dfrac{\\sum_i t_i r_i^{2}}{\\sum_i r_i^{4}} $. Compute $ \\mathrm{RSS}_{\\mathrm{local}} $ analogously.\n\nFinal output format:\n- Your program should produce a single line of output containing the concatenated results for all five test cases as a comma-separated list enclosed in square brackets. For each case, output two floats: the best-fit $ \\delta_{\\mathrm{best}} $ and the improvement factor $ I $. Round each float to $6$ decimal places. The final output should thus have the form $ [\\delta_1, I_1, \\delta_2, I_2, \\delta_3, I_3, \\delta_4, I_4, \\delta_5, I_5] $ with no spaces.\n\nNo user input or external files are permitted; all data must be generated internally by the program according to the specifications above. The logic must be fully deterministic and reproducible, using the specified random seed $42$ for noise generation.",
            "solution": "The problem requires the implementation of a data analysis procedure to fit a fractional transport model to synthetic data representing heat pulse propagation in a fusion plasma. The core task is to determine the exponent $\\delta$ in the scaling law $t_{\\mathrm{arr}} \\propto r^{\\delta}$, where $t_{\\mathrm{arr}}$ is the arrival time at radius $r$, and to compare the goodness-of-fit of this fractional model ($1  \\delta \\leq 2$) with the classical diffusion model ($\\delta=2$).\n\nFirst, we formalize the fitting procedure. The model relating the observed arrival times $t_i$ at radial positions $r_i$ is given by\n$$t_i \\approx \\kappa r_i^{\\delta}$$\nwhere $\\kappa$ is a proportionality constant and $\\delta$ is the fractional exponent. The parameters $(\\delta, \\kappa)$ are to be estimated by minimizing the sum of squared residuals (RSS), defined as:\n$$ \\mathrm{RSS}(\\delta, \\kappa) = \\sum_{i} \\left( t_i - \\kappa r_i^{\\delta} \\right)^2 $$\nThe minimization is constrained to the domain $1  \\delta \\leq 2$ and $\\kappa  0$.\n\nThe problem specifies a two-step optimization process.\nFirst, for a fixed value of the exponent $\\delta$, the problem of minimizing $\\mathrm{RSS}$ with respect to $\\kappa$ is a linear least-squares problem. The optimal $\\kappa$ is found by setting the partial derivative of $\\mathrm{RSS}$ with respect to $\\kappa$ to zero:\n$$ \\frac{\\partial \\mathrm{RSS}}{\\partial \\kappa} = \\frac{\\partial}{\\partial \\kappa} \\sum_{i} \\left( t_i^2 - 2 \\kappa t_i r_i^{\\delta} + \\kappa^2 r_i^{2\\delta} \\right) = \\sum_{i} \\left( -2 t_i r_i^{\\delta} + 2 \\kappa r_i^{2\\delta} \\right) = 0 $$\nSolving for $\\kappa$ yields the optimal value, denoted $\\kappa(\\delta)$:\n$$ \\kappa \\sum_{i} r_i^{2\\delta} = \\sum_{i} t_i r_i^{\\delta} $$\n$$ \\kappa(\\delta) = \\frac{\\sum_{i} t_i r_i^{\\delta}}{\\sum_{i} r_i^{2\\delta}} $$\nThis expression is guaranteed to be positive since physical constraints ensure $r_i  0$ and the data generation process with clipping ensures $t_i  0$.\n\nSecond, we substitute this optimal $\\kappa(\\delta)$ back into the RSS expression to obtain a function of $\\delta$ alone:\n$$ \\mathrm{RSS}(\\delta) = \\sum_{i} \\left( t_i - \\kappa(\\delta) r_i^{\\delta} \\right)^2 $$\nTo find the best-fit exponent, $\\delta_{\\mathrm{best}}$, we perform a grid search over the specified interval $\\delta \\in (1, 2]$. The problem specifies a uniform grid with a step of $0.001$. For each grid point $\\delta_j$, we compute $\\kappa(\\delta_j)$ and then $\\mathrm{RSS}(\\delta_j)$. The value $\\delta_{\\mathrm{best}}$ is the grid point that yields the minimum RSS value. We denote this minimum as $\\mathrm{RSS}_{\\mathrm{frac}}$.\n\nFor comparison, we evaluate the standard local diffusion model, which corresponds to fixing the exponent at $\\delta=2$. The corresponding proportionality constant, $\\kappa_{\\mathrm{local}}$, is calculated using the derived formula with $\\delta=2$:\n$$ \\kappa_{\\mathrm{local}} = \\kappa(\\delta=2) = \\frac{\\sum_{i} t_i r_i^{2}}{\\sum_{i} r_i^{4}} $$\nThe residual sum of squares for this local model, $\\mathrm{RSS}_{\\mathrm{local}}$, is:\n$$ \\mathrm{RSS}_{\\mathrm{local}} = \\sum_{i} \\left( t_i - \\kappa_{\\mathrm{local}} r_i^{2} \\right)^2 $$\n\nFinally, we quantify the relative performance of the fractional model compared to the local diffusive model using the improvement factor $I$:\n$$ I = \\frac{\\mathrm{RSS}_{\\mathrm{local}}}{\\mathrm{RSS}_{\\mathrm{frac}}} $$\nAn improvement factor $I  1$ indicates that the fractional model with the optimized exponent $\\delta_{\\mathrm{best}}$ provides a better fit to the data than the classical diffusion model.\n\nThe implementation will proceed by first generating the synthetic datasets for the five test cases as specified. For each case, we will generate the ideal time data $t_i^{\\mathrm{ideal}} = \\kappa_{\\mathrm{true}} r_i^{\\delta_{\\mathrm{true}}}$, add Gaussian noise $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ using a random number generator seeded with $42$ for reproducibility, and then apply any specified modifications (like the outlier in Case $5$) and the non-positivity clipping to a floor of $10^{-6}\\,\\mathrm{s}$. Following data generation, we will execute the two-step fitting algorithm described above to determine $\\delta_{\\mathrm{best}}$ and $\\mathrm{RSS}_{\\mathrm{frac}}$. We will then compute $\\mathrm{RSS}_{\\mathrm{local}}$ and the improvement factor $I$. The results for all cases will be collected and formatted into the required output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Per problem specification, no other libraries are permitted.\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the fractional transport model fitting problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1 (superdiffusive, typical)\",\n            \"delta_true\": 1.3,\n            \"kappa_true\": 0.015,\n            \"r\": np.array([0.1, 0.2, 0.3, 0.5, 0.8, 1.0]),\n            \"sigma\": 0.0008,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 2 (near-diffusive)\",\n            \"delta_true\": 1.95,\n            \"kappa_true\": 0.02,\n            \"r\": np.array([0.1, 0.2, 0.3, 0.5, 0.8, 1.0]),\n            \"sigma\": 0.0005,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 3 (exactly diffusive boundary)\",\n            \"delta_true\": 2.0,\n            \"kappa_true\": 0.018,\n            \"r\": np.array([0.15, 0.25, 0.4, 0.6, 0.9]),\n            \"sigma\": 0.0003,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 4 (sparse, strong superdiffusion)\",\n            \"delta_true\": 1.2,\n            \"kappa_true\": 0.012,\n            \"r\": np.array([0.2, 0.8]),\n            \"sigma\": 0.0010,\n            \"outlier_mod\": None\n        },\n        {\n            \"name\": \"Case 5 (superdiffusive with an early-arrival outlier)\",\n            \"delta_true\": 1.4,\n            \"kappa_true\": 0.013,\n            \"r\": np.array([0.1, 0.3, 0.6, 0.9]),\n            \"sigma\": 0.0005,\n            # In problem text, this was 'delta'. Renamed to avoid confusion with the exponent.\n            \"outlier_mod\": {\"index\": -1, \"offset\": -0.004} \n        }\n    ]\n\n    results = []\n    \n    # Use a single random number generator for all cases, seeded as specified.\n    rng = np.random.default_rng(42)\n\n    # Define the delta grid for the search\n    delta_grid = np.arange(1.001, 2.001, 0.001)\n\n    def calculate_rss(t_obs, r_obs, delta):\n        \"\"\"\n        Calculates the Residual Sum of Squares (RSS) for a given delta.\n        This function implicitly computes the optimal kappa for the given delta.\n        \"\"\"\n        r_pow_delta = r_obs ** delta\n        # Calculate optimal kappa for this delta\n        kappa_opt = np.sum(t_obs * r_pow_delta) / np.sum(r_pow_delta**2)\n        # Calculate predicted t values\n        t_pred = kappa_opt * r_pow_delta\n        # Calculate RSS\n        rss = np.sum((t_obs - t_pred)**2)\n        return rss\n\n    for case in test_cases:\n        # 1. Generate synthetic data for the current case\n        r_obs = case[\"r\"]\n        t_ideal = case[\"kappa_true\"] * (r_obs ** case[\"delta_true\"])\n        \n        # Add Gaussian noise\n        noise = rng.normal(loc=0.0, scale=case[\"sigma\"], size=len(r_obs))\n        t_obs = t_ideal + noise\n\n        # Apply outlier modification if specified\n        if case[\"outlier_mod\"]:\n            idx = case[\"outlier_mod\"][\"index\"]\n            offset = case[\"outlier_mod\"][\"offset\"]\n            t_obs[idx] += offset\n            \n        # Clip any non-positive values to the specified floor\n        clip_floor = 1e-6\n        t_obs[t_obs = 0] = clip_floor\n\n        # 2. Perform the fitting procedure for the fractional model\n        rss_values = [calculate_rss(t_obs, r_obs, delta) for delta in delta_grid]\n        \n        # Find the best delta that minimizes RSS\n        min_rss_index = np.argmin(rss_values)\n        delta_best = delta_grid[min_rss_index]\n        rss_frac = rss_values[min_rss_index]\n        \n        # 3. Calculate the fit for the local diffusion model (delta=2)\n        rss_local = calculate_rss(t_obs, r_obs, 2.0)\n        \n        # 4. Compute the improvement factor\n        if rss_frac > 0:\n            improvement_factor = rss_local / rss_frac\n        else:\n            improvement_factor = np.inf \n\n        # 5. Store results rounded to 6 decimal places for final formatting\n        results.append(round(delta_best, 6))\n        results.append(round(improvement_factor, 6))\n\n    # Final print statement in the exact required format\n    formatted_results = [f\"{v:.6f}\" for v in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}