{
    "hands_on_practices": [
        {
            "introduction": "雪崩的一个关键特征是其快速的、非局域的传播特性，这与标准的扩散输运形成鲜明对比。本练习旨在通过分析热脉冲的到达时间，提供一种定量区分这两种输运机制的方法，这是输运实验中的一个基本概念。通过计算和比较弹道式传播和扩散式传播的特征时间，你将能够掌握识别雪崩类事件的核心判据。",
            "id": "3691401",
            "problem": "在 $t=0$ 时刻，一个磁约束聚变等离子体的磁轴处触发了一个小的、局域的热脉冲。沿小半径方向，在半径 $r$ 处观测到随之产生的热输运，并提出了两种相互竞争的机制假说：(i) 由恒定的热扩散系数 $D$ 控制的扩散输运，以及 (ii) 以恒定的前沿速度 $v_{\\text{front}}$ 为特征的类弹道雪崩输运。为进行此分析，假设输运是一维径向的。\n\n仅使用基本定律和核心定义：\n- 对于扩散假说，从一维热方程 $\\partial T/\\partial t = D\\, \\partial^{2}T/\\partial r^{2}$ 出发，初始条件为 $t=0$ 时在 $r=0$ 处的脉冲。将扩散到达时间 $t_{\\text{diff}}(r)$ 定义为半径 $r$ 处的局域温度扰动达到其最大值的时间。\n- 对于弹道假说，使用运动学来定义一个以前沿速度 $v_{\\text{front}}$ 传播的前沿的弹道到达时间 $t_{\\text{bal}}(r)$。\n\n然后，定义一个无量纲的判别指数\n$$\nS(r) \\equiv \\frac{\\left|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)\\right|}{\\left|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)\\right|},\n$$\n其中 $t_{\\text{obs}}(r)$ 是在半径 $r$ 处实验观测到的到达时间。若 $S(r) \\ll 1$，表示观测结果更接近弹道预测；若 $S(r) \\gg 1$，则表示其更接近扩散预测。取值如下：\n- $r = 0.28\\,\\text{m}$，\n- $D = 1.1\\,\\text{m}^{2}\\,\\text{s}^{-1}$，\n- $v_{\\text{front}} = 2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$，\n- $t_{\\text{obs}}(r) = 1.90 \\times 10^{-4}\\,\\text{s}$。\n\n计算 $S(r)$。最终答案表示为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，提法明确且客观。所有计算唯一解所需的数据和定义均已提供。因此，我们可以开始求解。\n\n目标是计算无量纲判别指数 $S(r)$，其定义为：\n$$\nS(r) \\equiv \\frac{\\left|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)\\right|}{\\left|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)\\right|}\n$$\n这需要使用所提供的模型和参数，计算弹道到达时间 $t_{\\text{bal}}(r)$ 和扩散到达时间 $t_{\\text{diff}}(r)$。观测到达时间 $t_{\\text{obs}}(r)$ 是已知的。\n\n首先，我们计算弹道到达时间 $t_{\\text{bal}}(r)$。弹道假说假定一个输运前沿从磁轴（$r=0$）以恒定速度 $v_{\\text{front}}$ 径向向外传播。根据基本运动学，该前沿行进距离 $r$ 所需的时间为：\n$$\nt_{\\text{bal}}(r) = \\frac{r}{v_{\\text{front}}}\n$$\n使用给定值 $r = 0.28\\,\\text{m}$ 和 $v_{\\text{front}} = 2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$：\n$$\nt_{\\text{bal}}(r) = \\frac{0.28\\,\\text{m}}{2.4 \\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}} = \\frac{0.28}{2400}\\,\\text{s} \\approx 1.1667 \\times 10^{-4}\\,\\text{s}\n$$\n\n接下来，我们计算扩散到达时间 $t_{\\text{diff}}(r)$。它被定义为在半径 $r$ 处的温度扰动达到其最大值的时间。输运由具有恒定热扩散系数 $D$ 的一维热方程控制：\n$$\n\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial r^2}\n$$\n初始条件是在时间 $t=0$ 时位于磁轴（$r=0$）处的局域热脉冲。这可以建模为一个狄拉克δ函数初始条件，$T(r, t=0) = E_0\\delta(r)$，其中 $E_0$ 是一个常数，代表单位面积上脉冲的总能量。这个初值问题的解，被称为一维热方程的基本解或格林函数，是一个高斯函数：\n$$\nT(r, t) = \\frac{E_0}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{r^2}{4 D t}\\right)\n$$\n为了找到对于固定的半径 $r > 0$，温度 $T$ 达到最大值的时间 $t_{\\text{diff}}(r)$，我们必须求出 $T(r,t)$ 相对于时间 $t$ 的极值。我们计算偏导数 $\\frac{\\partial T}{\\partial t}$ 并将其设为零：\n$$\n\\frac{\\partial T(r, t)}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\frac{E_0}{\\sqrt{4 \\pi D}} t^{-1/2} \\exp\\left(-\\frac{r^2}{4 D}t^{-1}\\right) \\right] = 0\n$$\n应用乘法法则和链式法则进行微分：\n$$\n\\frac{E_0}{\\sqrt{4 \\pi D}} \\left[ \\left(-\\frac{1}{2} t^{-3/2}\\right) \\exp\\left(-\\frac{r^2}{4 D t}\\right) + t^{-1/2} \\exp\\left(-\\frac{r^2}{4 D t}\\right) \\left(-\\frac{r^2}{4 D}\\right)\\left(-t^{-2}\\right) \\right] = 0\n$$\n将对于 $t > 0$ 非零的公因子提取出来：\n$$\n\\exp\\left(-\\frac{r^2}{4 D t}\\right) t^{-3/2} \\left[ -\\frac{1}{2} + \\frac{r^2}{4 D t} \\right] = 0\n$$\n如果括号中的项为零，则该方程成立：\n$$\n-\\frac{1}{2} + \\frac{r^2}{4 D t} = 0\n$$\n解出 $t$ 即可得到扩散到达时间：\n$$\nt = \\frac{r^2}{2 D}\n$$\n因此，$t_{\\text{diff}}(r) = \\frac{r^2}{2 D}$。使用给定值 $r = 0.28\\,\\text{m}$ 和 $D = 1.1\\,\\text{m}^{2}\\,\\text{s}^{-1}$：\n$$\nt_{\\text{diff}}(r) = \\frac{(0.28\\,\\text{m})^2}{2 \\times (1.1\\,\\text{m}^{2}\\,\\text{s}^{-1})} = \\frac{0.0784}{2.2}\\,\\text{s} \\approx 3.5636 \\times 10^{-2}\\,\\text{s}\n$$\n\n现在我们有了计算 $S(r)$ 所需的所有部分。给定值为：\n- $t_{\\text{obs}}(r) = 1.90 \\times 10^{-4}\\,\\text{s}$\n- $t_{\\text{bal}}(r) \\approx 1.1667 \\times 10^{-4}\\,\\text{s}$\n- $t_{\\text{diff}}(r) \\approx 3.5636 \\times 10^{-2}\\,\\text{s}$\n\n我们计算 $S(r)$ 的分子：\n$$\n|t_{\\text{obs}}(r) - t_{\\text{bal}}(r)| = |1.90 \\times 10^{-4} - 1.1667 \\times 10^{-4}|\\,\\text{s} = 0.7333 \\times 10^{-4}\\,\\text{s}\n$$\n接下来，我们计算 $S(r)$ 的分母：\n$$\n|t_{\\text{obs}}(r) - t_{\\text{diff}}(r)| = |1.90 \\times 10^{-4} - 3.5636 \\times 10^{-2}|\\,\\text{s} = |0.000190 - 0.035636|\\,\\text{s} = |-0.035446|\\,\\text{s} = 3.5446 \\times 10^{-2}\\,\\text{s}\n$$\n最后，我们计算比值：\n$$\nS(r) = \\frac{0.7333 \\times 10^{-4}\\,\\text{s}}{3.5446 \\times 10^{-2}\\,\\text{s}} \\approx 0.020688\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nS(r) \\approx 0.00207\n$$\n这个值也可以用科学记数法表示为 $2.07 \\times 10^{-3}$。由于 $S(r) \\ll 1$，这个结果表明观测到的到达时间明显更接近弹道预测，而不是扩散预测。",
            "answer": "$$\\boxed{2.07 \\times 10^{-3}}$$"
        },
        {
            "introduction": "理解了雪崩的传播特征后，我们进一步探讨其对整个等离子体系统的影响。雪崩输运常常与“剖面刚性”这一概念联系在一起，即温度梯度在临界阈值附近被“钳制”。本练习要求你推导在这种刚性输运模型下的稳态温度剖面，从而揭示局域加热如何通过雪崩机制导致全局剖面的自组织。",
            "id": "3691380",
            "problem": "考虑一个大纵横比、轴对称的柱形聚变等离子体，其小半径为 $a$，径向坐标 $r \\in [0,a]$ 从磁轴量起。设 $T(r)$ 表示稳态下的离子温度分布。假设径向热输运由能量守恒和一个与雪崩现象相关的阈值输运响应控制：\n- 能量守恒（稳态）要求径向热通量 $q(r)$ 满足 $\\frac{1}{r}\\frac{d}{dr}\\big(r\\,q(r)\\big) = S(r)$，其中 $S(r)$ 是体加热密度。\n- 当温度梯度幅值低于临界值 $\\kappa_c$（临界梯度阈值）时，局域输运遵循类傅里叶本构关系 $q(r) = -K_L\\,\\frac{dT}{dr}$，其中 $K_L$ 是一个常数，表示有效热导率（单位为 $\\mathrm{W/(m\\cdot keV)}$）。\n- 如果局域梯度幅值 $|\\frac{dT}{dr}|$ 将要超过阈值 $\\kappa_c$，雪崩输运会自组织地将梯度钳制在 $|\\frac{dT}{dr}|=\\kappa_c$，通过按需增加有效输运强度来维持该界限。换言之，温度分布是刚性的：在驱动本会超过 $\\kappa_c$ 的任何地方，实现的稳态梯度都取值为 $\\frac{dT}{dr}=-\\kappa_c$（负号表示 $T$ 向外递减）。\n\n假设存在一个半径为 $r_0$ 的局域芯部加热区，当 $0 \\le r \\le r_0$ 时热源为常数 $S(r)=S_0$，当 $r_0  r \\le a$ 时 $S(r)=0$。各参数均为正实数，且满足不等式 $0  \\frac{2K_L\\kappa_c}{S_0}  r_0  a$。\n\n在给定的边界条件 $\\frac{dT}{dr}\\big|_{r=0}=0$（对称性）和 $T(a)=T_a$（边缘温度固定）下，推导出稳态温度剖面 $T(r)$。将您的最终答案表示为一个在域 $r \\in [0,a]$ 上分段定义的函数。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤1：提取已知条件\n- **控制方程（能量守恒）**：对于半径为 $a$ 的柱形等离子体中的径向热通量 $q(r)$，有 $\\frac{1}{r}\\frac{d}{dr}\\big(r\\,q(r)\\big) = S(r)$。\n- **加热源密度**：当 $0 \\le r \\le r_0$ 时，$S(r) = S_0$；当 $r_0  r \\le a$ 时，$S(r)=0$，其中 $S_0 > 0$。\n- **边界条件**：$\\frac{dT}{dr}\\big|_{r=0}=0$（对称性）和 $T(a)=T_a$（边缘温度固定）。\n- **输运模型**：\n    1. 一个临界温度梯度幅值 $\\kappa_c > 0$。\n    2. 对于 $|\\frac{dT}{dr}|  \\kappa_c$，输运是线性的：$q(r) = -K_L \\frac{dT}{dr}$，其中 $K_L$ 是常数热导率。\n    3. 如果由局域热通量驱动的梯度幅值将要超过 $\\kappa_c$，输运会自组织地将梯度钳制在该阈值。由于热量向外流动，$T(r)$ 是 $r$ 的递减函数，因此 $\\frac{dT}{dr} = -\\kappa_c$。\n- **参数区间**：各常数满足不等式 $0  \\frac{2K_L\\kappa_c}{S_0}  r_0  a$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该模型是聚变等离子体物理学中一个公认的简化范式，用于研究由低于临界梯度阈值时被稳定的微观湍流引起的“刚性”输运分布。能量守恒方程是基础。该问题具有科学合理性。\n2.  **适定性**：该问题由一个温度微分方程（从能量守恒和热通量本构关系推导）以及明确的边界条件组成。给定的参数区间不等式确保了不同输运定律之间的非平凡相互作用，表明这是一个结构化的问题，很可能具有唯一且稳定的解。该问题是适定的。\n3.  **客观性**：问题以精确的数学语言陈述，没有主观或模糊的术语。它是客观的。\n4.  **完整性与一致性**：所有必要的参数（$a, r_0, S_0, K_L, \\kappa_c, T_a$）和物理定律都已提供。边界条件与柱形几何和固定温度边界相一致。该设置是完整且一致的。\n\n### 步骤3：结论与行动\n该问题具有科学有效性、适定性且内部一致。我将继续推导解答。\n\n### 解的推导\n稳态温度分布 $T(r)$ 的推导分三个主要阶段进行：首先，根据能量守恒确定热通量 $q(r)$；其次，基于阈值输运模型建立温度梯度 $\\frac{dT}{dr}$ 的径向分布；第三，对梯度分布施加边界条件进行积分，以获得 $T(r)$。\n\n**1. 径向热通量分布, $q(r)$**\n稳态能量守恒方程为 $\\frac{d}{dr}(r\\,q(r)) = r S(r)$。从磁轴（$r=0$）积分到任意半径 $r$ 可得：\n$$r\\,q(r) - 0 \\cdot q(0) = \\int_0^r r' S(r') dr'$$\n假设通量 $q(0)$ 是有限的，则 $r=0$ 处的边界项为零。因此，通量为 $q(r) = \\frac{1}{r} \\int_0^r r' S(r') dr'$。\n我们根据加热分布定义的两个区域来计算该积分：\n-   对于 $0 \\le r \\le r_0$：$S(r')=S_0$。\n    $$q(r) = \\frac{1}{r} \\int_0^r r' S_0 dr' = \\frac{S_0}{r} \\left[\\frac{r'^2}{2}\\right]_0^r = \\frac{S_0 r}{2}$$\n-   对于 $r_0  r \\le a$：$S(r')$ 仅在 $r_0$ 以内非零。\n    $$q(r) = \\frac{1}{r} \\left( \\int_0^{r_0} r' S_0 dr' + \\int_{r_0}^r r' \\cdot 0 \\cdot dr' \\right) = \\frac{1}{r} \\left( S_0 \\frac{r_0^2}{2} \\right) = \\frac{S_0 r_0^2}{2r}$$\n得到的热通量分布在 $r=r_0$ 处是连续的，由下式给出：\n$$q(r) = \\begin{cases} \\frac{S_0 r}{2},  \\text{对于 } 0 \\le r \\le r_0 \\\\ \\frac{S_0 r_0^2}{2r},  \\text{对于 } r_0  r \\le a \\end{cases}$$\n\n**2. 温度梯度分布, $\\frac{dT}{dr}$**\n温度梯度由输运定律决定。局域梯度幅值 $|\\frac{dT}{dr}|$ 由临界阈值 $\\kappa_c$ 和低输运定律所要求的幅值 $\\frac{q(r)}{K_L}$ 中的较小者设定。由于温度向外降低，$\\frac{dT}{dr} \\le 0$。\n$$\\frac{dT}{dr} = - \\min\\left(\\frac{q(r)}{K_L}, \\kappa_c\\right)$$\n我们必须通过比较 $\\frac{q(r)}{K_L}$ 和 $\\kappa_c$ 来确定系统处于低输运（亚临界）状态还是雪崩（临界）状态的区域。\n-   对于 $0 \\le r \\le r_0$：达到或超过临界状态的条件是 $\\frac{q(r)}{K_L} \\ge \\kappa_c$，即 $\\frac{S_0 r}{2K_L} \\ge \\kappa_c$，或 $r \\ge \\frac{2K_L\\kappa_c}{S_0}$。我们定义临界半径 $r_c = \\frac{2K_L\\kappa_c}{S_0}$。问题陈述 $0  r_c  r_0$，因此对于 $r \\in [r_c, r_0]$，梯度被钳制在 $-\\kappa_c$。对于 $r \\in [0, r_c)$，梯度为 $-\\frac{S_0 r}{2K_L}$。\n-   对于 $r_0  r \\le a$：达到或超过临界状态的条件是 $\\frac{q(r)}{K_L} \\ge \\kappa_c$，即 $\\frac{S_0 r_0^2}{2K_L r} \\ge \\kappa_c$，或 $r \\le \\frac{S_0 r_0^2}{2K_L\\kappa_c}$。我们定义这第二个临界半径 $r_s = \\frac{S_0 r_0^2}{2K_L\\kappa_c}$。注意 $r_s = \\frac{r_0^2}{r_c}$。由于 $r_0 > r_c$，因此 $r_s > r_0$。对于 $r \\in (r_0, r_s]$，梯度被钳制在 $-\\kappa_c$。对于 $r > r_s$，梯度为 $-\\frac{S_0 r_0^2}{2K_L r}$。\n\n综合这些发现，完全由雪崩主导（钳制）的区域是 $[r_c, r_s]$。然而，等离子体仅延伸到 $r=a$。因此，有效的钳制区域是 $[r_c, r_s^*]$，其中 $r_s^* = \\min(r_s, a)$。温度梯度的完整径向分布为：\n$$\\frac{dT}{dr}(r) = \\begin{cases} -\\frac{S_0 r}{2K_L},  \\text{对于 } 0 \\le r  r_c \\\\ -\\kappa_c,  \\text{对于 } r_c \\le r \\le r_s^* \\\\ -\\frac{S_0 r_0^2}{2K_L r},  \\text{对于 } r_s^*  r \\le a \\end{cases}$$\n第三个区域仅在 $r_s^*  a$ 时存在，这等价于 $r_s  a$。\n\n**3. 温度分布, $T(r)$**\n我们通过从边缘边界条件 $T(a)=T_a$ 向内积分 $\\frac{dT}{dr}$ 来求得温度分布。\n$$T(r) = T(a) - \\int_r^a \\frac{dT}{dr'} dr' = T_a + \\int_r^a \\left(-\\frac{dT}{dr'}\\right) dr'$$\n我们对 $r$ 的不同区域分段计算该积分。\n\n-   **情况1：$r_s^* \\le r \\le a$** （这是最外层的亚临界区域，仅在 $r_s  a$ 时存在）\n    在此区域，积分为：\n    $$T(r) = T_a + \\int_r^a \\frac{S_0 r_0^2}{2K_L r'} dr' = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r}\\right)$$\n\n-   **情况2：$r_c \\le r \\le r_s^*$** （这是临界/钳制区域）\n    积分必须在 $r_s^*$ 处分段：\n    $$T(r) = T(a) + \\int_r^{r_s^*} \\kappa_c dr' + \\int_{r_s^*}^a \\left(-\\frac{dT}{dr'}\\right) dr'$$\n    第二个积分对应于从 $a$ 到 $r_s^*$ 的温度升高量，即 $T(r_s^*) - T_a$。根据情况1（或如果 $r_s^*=a$ 则通过直接积分），$T(r_s^*) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right)$（注意如果 $r_s^*=a$，此项为零）。\n    所以，$T(r) = T(r_s^*) + \\kappa_c (r_s^*-r) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^* - r)$。\n\n-   **情况3：$0 \\le r \\le r_c$** （这是最内层的亚临界区域）\n    积分在 $r_c$ 和 $r_s^*$ 处分段：\n    $$T(r) = T(a) + \\int_r^{r_c} \\frac{S_0 r'}{2K_L} dr' + \\int_{r_c}^{r_s^*} \\kappa_c dr' + \\int_{r_s^*}^a \\left(-\\frac{dT}{dr'}\\right) dr'$$\n    后两项构成了从 $a$ 到 $r_c$ 的温度升高量，即 $T(r_c) - T_a$。根据情况2，这等于 $T(r_c) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^* - r_c)$。\n    第一个积分为 $\\frac{S_0}{2K_L} \\int_r^{r_c} r' dr' = \\frac{S_0}{4K_L}(r_c^2 - r^2)$。\n    将这些结合起来得到：\n    $$T(r) = T_a + \\frac{S_0 r_0^2}{2K_L} \\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^* - r_c) + \\frac{S_0}{4K_L}(r_c^2 - r^2)$$\n\n这三个表达式构成了在定义域 $[0, a]$ 上的一个单一、连续的函数 $T(r)$。这是完整的解。",
            "answer": "$$\n\\boxed{\nT(r) = T_a + \\begin{cases} \\frac{S_0 r_0^2}{2K_L}\\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^*-r_c) + \\frac{S_0}{4K_L}(r_c^2-r^2)  \\text{for } 0 \\le r \\le r_c \\\\ \\frac{S_0 r_0^2}{2K_L}\\ln\\left(\\frac{a}{r_s^*}\\right) + \\kappa_c(r_s^*-r)  \\text{for } r_c  r \\le r_s^* \\\\ \\frac{S_0 r_0^2}{2K_L}\\ln\\left(\\frac{a}{r}\\right)  \\text{for } r_s^*  r \\le a \\end{cases} \\quad \\text{where } r_c = \\frac{2K_L\\kappa_c}{S_0}, \\ r_s = \\frac{r_0^2}{r_c}, \\text{ and } r_s^* = \\min(r_s, a)\n}\n$$"
        },
        {
            "introduction": "最后，我们将面临一个源于实验的真实挑战：在复杂的信号中区分雪崩和其他瞬态事件。这项高级计算练习要求你设计并实现一个算法，通过综合分析径向传播特征和磁扰动信号，来区分雪崩和锯齿振荡。这项实践将理论知识与实验等离子体物理中至关重要的数据分析技能联系起来，帮助你应对实际研究中的问题。",
            "id": "3691414",
            "problem": "您面临一个关于核聚变等离子体物理领域中雪崩输运现象的概念和计算挑战。您的任务是设计并实现一个可完整运行的程序，通过系统地结合径向局域化、传播特征和磁时间标记，来区分岩芯分辨信号中的雪崩输运事件和锯齿崩塌事件。该程序必须能端到端执行，根据指定的参数集生成合成但科学上合理的信号，并根据源于输运和磁流体动力学第一性原理的原则性算法对每种情况进行分类。\n\n物理场景为一个环形等离子体，其小半径为 $a$，归一化径向坐标为 $r \\in [0,1]$，其中 $r=0$ 是磁轴。您拥有径向分辨的软X射线（SXR）发射率信号 $S(r,t)$，该信号相对于电子温度 $T_e(r,t)$ 是单调的；以及一个磁时间标记 $M(t)$，它代表一个米尔诺夫线圈通道，该通道对磁流体动力学（MHD）活动敏感，包括与锯齿崩塌相关的 $m=1$ 前兆。\n\n您的算法必须建立在以下基本基础上：\n- 圆柱环内的能量守恒意味着径向热通量 $q_r$ 受输运控制，在扩散机制下，其模型为 $q_r = - \\chi \\, \\partial T_e / \\partial r$，其中 $\\chi$ 是有效热扩散系数。雪崩事件是快速的非局域输运响应，产生具有有限径向速度 $v_{\\text{prop}}$ 的传播前沿，以及随 $r$ 增大的向外时间延迟 $t(r)$。锯齿崩塌是在安全因子 $q=1$ 处的拓扑重联事件，在反转半径 $r_{\\text{inv}}$ 内产生近乎同步的 $T_e$ 崩塌，通常在崩塌时间前不久在 $M(t)$ 中伴有 $m=1$ MHD前兆。\n- 对信号 $S(r,t)$ 的稳健事件检测使用时间导数 $\\partial S/\\partial t$ 来识别核心半径处最强的负向偏移（崩塌起始），然后跟踪跨半径的延迟。径向传播特征通过线性回归估计的斜率 $\\mathrm{d}t/\\mathrm{d}r$ 来量化，由此计算出前沿速度 $v_{\\text{prop}} = a / (\\mathrm{d}t/\\mathrm{d}r)$，单位为 $\\text{m/s}$。\n- 磁时间标记通过事件前短窗口与基线区间的振幅比来量化：如果 $M(t)$ 在事件时间附近表现出显著的前兆，其振幅超过基线标准差的阈值倍数，则表明存在锯齿活动。\n\n您将根据四个代表不同场景的参数集（测试套件）生成合成信号 $S(r,t)$ 和 $M(t)$。每个场景都指定了时间、径向位置、小半径、事件时间和振幅的采样。信号必须通过平滑过渡来合成，以模拟真实的诊断。请使用以下建模选择来生成数据：\n\n- 时间网格：$N_t = 2000$ 个样本，时间 $t \\in [0,1]$ 秒，均匀间隔 $\\Delta t = 0.0005$ 秒。\n- 径向网格：$r_i$ 对于 $i=0,\\dots,12$，其中 $r_i = 0.05 \\times i$（即 $r \\in \\{0.00, 0.05, 0.10, \\dots, 0.60\\}$）。\n- 小半径：$a = 0.8$ 米。\n- SXR合成信号：对于每个半径 $r$，通过一个以事件时间 $t_{\\text{ev}}(r)$ 为中心、宽度为 $\\delta$ 的S型跃迁来定义一个平滑的下降：\n$$\nS(r,t) = S_0 - A(r) \\cdot \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{t - t_{\\text{ev}}(r)}{\\delta}\\right)\\right) + \\eta(r,t),\n$$\n其中 $S_0 = 1.0$，$\\delta = 0.001$ 秒，$A(r)$ 是一个依赖于半径的振幅，$\\eta(r,t)$ 是具有指定标准差的零均值高斯噪声。这种构造使得 $\\partial S/\\partial t$ 在 $t_{\\text{ev}}(r)$ 附近为负。\n- 磁标记合成信号：\n$$\nM(t) = \\xi(t) + A_M \\cdot \\exp\\left( - \\frac{(t - (t_0 - \\Delta_{\\text{pre}}))^2}{2 \\sigma_M^2} \\right),\n$$\n其中 $\\xi(t)$ 是零均值高斯噪声，$A_M$ 是前兆振幅，$t_0$ 是核心事件时间，$\\Delta_{\\text{pre}} = 0.01$ 秒，$\\sigma_M = 0.003$ 秒。\n\n事件时间模板 $t_{\\text{ev}}(r)$ 和振幅 $A(r)$ 必须按场景设置如下：\n- 雪崩：以米每秒为单位的有限速度 $v$ 向外传播，因此\n$$\nt_{\\text{ev}}(r) = t_0 + \\frac{a \\, r}{v}, \\quad A(r) = A_0 \\, \\exp\\left(-\\frac{r}{0.5}\\right).\n$$\n- 锯齿：在反转半径 $r_{\\text{inv}}$ 内近乎同时崩塌，外部响应微弱，因此\n$$\nt_{\\text{ev}}(r) = \\begin{cases} t_0,  r \\le r_{\\text{inv}}, \\\\ t_0 + 0.10 + 0.05 \\, r,  r > r_{\\text{inv}}, \\end{cases}\n\\quad\nA(r) = \\begin{cases} A_0 \\left(1 - \\left(\\frac{r}{r_{\\text{inv}}}\\right)^2\\right),  r \\le r_{\\text{inv}}, \\\\ 0.05 \\, A_0,  r > r_{\\text{inv}}. \\end{cases}\n$$\n\n您的分类算法必须实现以下步骤：\n1. 对每个半径的 $S(r,t)$ 进行轻微的时间平滑处理，以稳定导数（例如，与一个短的高斯核进行卷积）。\n2. 通过在最小半径 $r \\approx 0$ 处 $\\partial S/\\partial t$ 达到其最负值的时间 $t$ 来检测核心事件时间 $t_0$。\n3. 对于一组内半径 $r \\le 0.50$，在 $t_0$ 周围的搜索窗口内，将局部事件时间 $t_i$ 估计为 $\\partial S/\\partial t$ 最负值的时间。仅保留那些最小导数幅值超过核心最小导数幅值一定比例的半径，以确保相关性。\n4. 通过对 $t_i$ 与 $r_i$ 进行线性回归来估计斜率 $\\mathrm{d}t/\\mathrm{d}r$，并计算传播速度\n$$\nv_{\\text{prop}} = \\frac{a}{\\mathrm{d}t/\\mathrm{d}r} \\quad \\text{单位为 } \\text{m/s}。\n$$\n5. 通过计算比率来量化磁时间标记\n$$\nR_M = \\frac{\\max_{t \\in [t_0 - 0.02, t_0 + 0.005]} |M(t)|}{\\sigma_{\\text{base}}},\n$$\n其中 $\\sigma_{\\text{base}}$ 是 $M(t)$ 在基线窗口 $t \\in [0, \\max(t_0 - 0.05, 0.05)]$ 内的标准差。\n6. 通过检查 $t_i$ 随 $r_i$ 的单调性来检验径向局域化和传播相干性，具体方法是计算所选内半径上 $t_i$ 与 $r_i$ 的皮尔逊相关系数 $C_{tr}$。\n7. 决策逻辑：如果磁标记很强（$R_M$ 高于阈值），或传播可忽略（$\\mathrm{d}t/\\mathrm{d}r$ 很小、速度非正或 $C_{tr}$ 低），则声明为锯齿崩塌。如果 $R_M$ 弱，$v_{\\text{prop}}$ 是有限的且低于指定的上限，并且 $C_{tr}$ 表明相干地向外传播，则声明为雪崩。\n\n在您的算法中实现以下阈值：\n- 磁比率阈值：$R_M^{\\star} = 3.0$（无量纲）。\n- 雪崩的传播速度上限：$v_{\\max} = 300.0$，单位为 $\\text{m/s}$。\n- 相干向外传播的最小相关性：$C_{tr}^{\\star} = 0.7$（无量纲）。\n- 导数相关性分数：$\\alpha = 0.2$（无量纲）。\n\n测试套件规范：您的程序必须为以下四个参数集生成信号。在每种情况下，为保证可复现性，请唯一地设置随机种子。\n\n- 情况 $1$（雪崩，弱磁标记）：$t_0 = 0.30$ 秒，$v = 40.0$ $\\text{m/s}$，$A_0 = 0.25$，SXR噪声标准差 $\\sigma_S = 0.002$，磁振幅 $A_M = 0.20$，磁噪声标准差 $\\sigma_M^{\\text{noise}} = 0.10$，随机种子 $123$。\n- 情况 $2$（锯齿，强前兆）：$t_0 = 0.25$ 秒，$r_{\\text{inv}} = 0.35$，$A_0 = 0.30$，$\\sigma_S = 0.003$，$A_M = 0.80$，$\\sigma_M^{\\text{noise}} = 0.10$，随机种子 $456$。\n- 情况 $3$（雪崩速度临界，标记微弱）：$t_0 = 0.50$ 秒，$v = 200.0$ $\\text{m/s}$，$A_0 = 0.20$，$\\sigma_S = 0.002$，$A_M = 0.25$，$\\sigma_M^{\\text{noise}} = 0.10$，随机种子 $789$。\n- 情况 $4$（高SXR噪声下的锯齿）：$t_0 = 0.60$ 秒，$r_{\\text{inv}} = 0.25$，$A_0 = 0.35$，$\\sigma_S = 0.010$，$A_M = 1.00$，$\\sigma_M^{\\text{noise}} = 0.10$，随机种子 $101112$。\n\n分类输出规范：\n- 对于每种情况，输出一个整数分类：雪崩 $= 1$，锯齿 $= 0$。\n- 您的程序应生成单行输出，其中包含按情况1到4的顺序排列的结果，形式为逗号分隔的列表，并用方括号括起来（例如，$[1,0,1,0]$）。\n\n在您的计算中，所有需要单位的物理量都必须使用正确的单位进行处理：速度单位为 $\\text{m/s}$，时间单位为秒，半径为归一化的 $r \\in [0,1]$。不涉及角度。算法的实现必须无需外部输入，并且在给定指定种子的情况下必须是确定性的。程序必须遵守指定的执行环境，并且最终的分类列表必须是唯一的打印输出行。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上植根于等离子体输运和磁流体动力学的原理，问题设定良好，具有完整且一致的参数集，并且其表述是客观的。任务是构建一个计算程序，该程序基于第一性原理算法，合成并分类等离子体湍流事件——区分雪崩输运和锯齿崩塌。\n\n解决方案首先生成模拟实验测量的合成数据，然后应用一个基于信号处理和源于底层物理的模式识别技术的严格分类算法。\n\n### 1. 合成信号的生成\n\n分析是在两种信号上进行的：径向分辨的软X射线（SXR）发射率信号 $S(r,t)$ 和磁活动标记 $M(t)$。这些信号是为四种不同的物理场景合成的。\n\n**时间和空间网格：**\n模拟域由均匀的时间网格 $t$ 和离散的径向网格 $r$ 定义。\n- 时间网格：$t \\in [0, 1]$ 秒，有 $N_t = 2000$ 个样本，时间步长为 $\\Delta t = 0.0005$ 秒。\n- 径向网格：对于 $i=0, \\dots, 12$ 的 $r_i$ 是归一化半径，定义为 $r_i = 0.05 \\times i$，范围从磁轴（$r=0$）到 $r=0.60$。等离子体小半径给定为 $a=0.8$ 米。\n\n**SXR信号模型, $S(r,t)$:**\nSXR信号是电子温度 $T_e(r,t)$ 的代理，它模拟了发射率的快速下降。其函数形式由下式给出：\n$$\nS(r,t) = S_0 - A(r) \\cdot \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{t - t_{\\text{ev}}(r)}{\\delta}\\right)\\right) + \\eta(r,t)\n$$\n其中 $S_0=1.0$ 是基线发射率，$A(r)$ 是依赖于半径的下降幅度，$t_{\\text{ev}}(r)$ 是依赖于半径的事件时间，$\\delta=0.001$ 秒是下降的特征时间，$\\eta(r,t)$ 是具有指定标准差 $\\sigma_S$ 的高斯噪声。\n\n**磁标记信号模型, $M(t)$:**\n磁信号模拟了某些磁流体动力学（MHD）事件特有的前兆振荡。它定义为：\n$$\nM(t) = \\xi(t) + A_M \\cdot \\exp\\left( - \\frac{(t - (t_0 - \\Delta_{\\text{pre}}))^2}{2 \\sigma_M^2} \\right)\n$$\n其中 $\\xi(t)$ 是标准差为 $\\sigma_M^{\\text{noise}}$ 的高斯噪声，$A_M$ 是前兆振幅，$t_0$ 是核心事件时间，$\\Delta_{\\text{pre}} = 0.01$ 秒是前兆提前时间，$\\sigma_M = 0.003$ 秒是前兆持续时间。\n\n**事件模板：**\n$t_{\\text{ev}}(r)$ 和 $A(r)$ 的具体形式定义了事件类型：\n- **雪崩：** 特征是以外向有限速度 $v$ 传播。\n  $$\n  t_{\\text{ev}}(r) = t_0 + \\frac{a \\, r}{v}, \\quad A(r) = A_0 \\, \\exp\\left(-\\frac{r}{0.5}\\right)\n  $$\n- **锯齿：** 特征是在反转半径 $r_{\\text{inv}}$ 内近乎瞬时的崩塌。\n  $$\n  t_{\\text{ev}}(r) = \\begin{cases} t_0,  r \\le r_{\\text{inv}} \\\\ t_0 + 0.10 + 0.05 \\, r,  r > r_{\\text{inv}} \\end{cases}, \\quad\n  A(r) = \\begin{cases} A_0 \\left(1 - \\left(\\frac{r}{r_{\\text{inv}}}\\right)^2\\right),  r \\le r_{\\text{inv}} \\\\ 0.05 \\, A_0,  r > r_{\\text{inv}} \\end{cases}\n  $$\n\n### 2. 分类算法\n\n该算法系统地从合成信号中提取区分性特征，以对每个事件进行分类。\n\n**步骤 1：信号预处理**\n为了确保导数的稳健计算，SXR信号 $S(r,t)$ 的每个径向通道都在时间上进行平滑处理。这是通过将信号与高斯核进行卷积来实现的。选择核的标准差为 $2\\Delta t = 0.001$ 秒，这与事件跃迁宽度 $\\delta$ 相当，能有效减少噪声而不过度模糊物理事件结构。\n\n**步骤 2：核心事件时间检测**\n事件的起始在等离子体核心（$r=0$）处观察得最清楚。核心事件时间 $t_0^{\\text{est}}$ 被确定为核心SXR信号的时间导数 $\\partial S(r=0,t)/\\partial t$ 达到其最负值的时刻。\n\n**步骤 3：局部事件时间估计**\n对于一组内半径 $r_i \\le 0.50$，局部事件时间 $t_i$ 是通过在 $t_0^{\\text{est}}$ 周围的搜索窗口内找到 $\\partial S(r_i,t)/\\partial t$ 最负值的时刻来确定的。使用 $t_0^{\\text{est}} \\pm 0.02$ 秒的窗口。为确保只考虑显著的崩塌特征，仅当通道的最小导数幅值超过相关性阈值时，才将其纳入后续分析：$|\\min(\\partial S(r_i,t)/\\partial t)| \\ge \\alpha |\\min(\\partial S(r=0,t)/\\partial t)|$，其中分数 $\\alpha = 0.2$。\n\n**步骤 4：传播速度估计**\n有效局部事件时间集合 $\\{t_i\\}$ 及其对应的半径 $\\{r_i\\}$ 用于量化传播。对 $t_i$ 与 $r_i$ 进行线性回归，以找到斜率 $m_{tr} = \\mathrm{d}t/\\mathrm{d}r$。然后根据其定义计算传播速度：\n$$\nv_{\\text{prop}} = \\frac{a}{m_{tr}}\n$$\n正斜率 $m_{tr}$ 对应于向外传播。接近零的斜率意味着近乎同时传播（无限速度），这是锯齿的特征。\n\n**步骤 5：磁标记量化**\n锯齿前兆的存在通过比率 $R_M$ 来量化：\n$$\nR_M = \\frac{\\max_{t \\in [t_0^{\\text{est}} - 0.02, t_0^{\\text{est}} + 0.005]} |M(t)|}{\\sigma_{\\text{base}}}\n$$\n其中 $\\sigma_{\\text{base}}$ 是 $M(t)$ 在一个安静的基线窗口内的标准差，定义为 $t \\in [0, \\max(t_0^{\\text{est}} - 0.05, 0.05)]$。大的 $R_M$ 值表示相对于背景噪声有显著的磁前兆。\n\n**步骤 6：传播相干性**\n向外传播的相干性由皮尔逊相关系数 $C_{tr}$ 测量，它是向量 $\\{t_i\\}$ 和 $\\{r_i\\}$ 之间的相关性，可直接从线性回归分析中获得。接近1的 $C_{tr}$ 值表示高度线性、相干的传播前沿。\n\n**步骤 7：决策逻辑**\n最终分类是使用一套基于提取的特征和预定义阈值的分层规则进行的：\n- $R_M^{\\star} = 3.0$（磁比率阈值）\n- $C_{tr}^{\\star} = 0.7$（相关性阈值）\n- $v_{\\max} = 300.0$ m/s（最大雪崩速度）\n\n分类过程如下：\n1.  如果磁标记强（$R_M > R_M^{\\star}$），则该事件被分类为 **锯齿 ($0$)**。\n2.  否则，如果传播不是相干地向外（$C_{tr}  C_{tr}^{\\star}$ 或 $m_{tr} \\le 0$），则该事件被分类为 **锯齿 ($0$)**。\n3.  否则（即，如果标记弱且传播是相干地向外），则检查传播速度 $v_{\\text{prop}}$。\n    - 如果 $0  v_{\\text{prop}} \\le v_{\\max}$，则该事件是 **雪崩 ($1$)**。\n    - 如果 $v_{\\text{prop}} > v_{\\max}$，则传播速度太快，不可能是物理上的雪崩，被认为是类似锯齿的。该事件被分类为 **锯齿 ($0$)**。\n\n这种结构化的、基于物理的算法允许对合成事件进行稳健且可复现的分类，这在提供的Python代码中通过使用`numpy`和`scipy`库得以实现。",
            "answer": "```python\nimport numpy as np\nfrom scipy.ndimage import gaussian_filter1d\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the final result.\n    \"\"\"\n    # Test suite specification\n    test_cases = [\n        # Case 1: Avalanche, weak magnetic marker\n        {'type': 'avalanche', 't0': 0.30, 'v': 40.0, 'A0': 0.25, 'sigma_S': 0.002,\n         'A_M': 0.20, 'sigma_M_noise': 0.10, 'seed': 123},\n        # Case 2: Sawtooth, strong precursor\n        {'type': 'sawtooth', 't0': 0.25, 'r_inv': 0.35, 'A0': 0.30, 'sigma_S': 0.003,\n         'A_M': 0.80, 'sigma_M_noise': 0.10, 'seed': 456},\n        # Case 3: Avalanche borderline speed, faint marker\n        {'type': 'avalanche', 't0': 0.50, 'v': 200.0, 'A0': 0.20, 'sigma_S': 0.002,\n         'A_M': 0.25, 'sigma_M_noise': 0.10, 'seed': 789},\n        # Case 4: Sawtooth with high SXR noise\n        {'type': 'sawtooth', 't0': 0.60, 'r_inv': 0.25, 'A0': 0.35, 'sigma_S': 0.010,\n         'A_M': 1.00, 'sigma_M_noise': 0.10, 'seed': 101112},\n    ]\n\n    results = []\n    for params in test_cases:\n        classification = run_case(params)\n        results.append(classification)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_case(params):\n    \"\"\"\n    Generates signals for a single case and applies the classification algorithm.\n    \"\"\"\n    # Set seed for reproducibility\n    np.random.seed(params['seed'])\n\n    # --- Global Parameters ---\n    a = 0.8  # meters\n    dt = 0.0005  # seconds\n    t = np.arange(0, 1.0, dt)\n    r_grid = np.arange(0, 0.61, 0.05)\n    \n    # --- Generate Signals ---\n    S = generate_sxr_signal(params, t, r_grid)\n    M = generate_magnetic_signal(params, t)\n\n    # --- Classification ---\n    classification = classify_event(S, M, t, r_grid, a, dt)\n    return classification\n\ndef generate_sxr_signal(params, t, r_grid):\n    \"\"\"Generates the synthetic SXR signal S(r, t).\"\"\"\n    S0 = 1.0\n    delta = 0.001\n    Nt = len(t)\n    Nr = len(r_grid)\n    S = np.zeros((Nr, Nt))\n    \n    rng = np.random.default_rng(params['seed'])\n\n    for i, r in enumerate(r_grid):\n        A_r, t_ev_r = 0.0, 0.0\n        if params['type'] == 'avalanche':\n            t_ev_r = params['t0'] + (0.8 * r) / params['v']\n            A_r = params['A0'] * np.exp(-r / 0.5)\n        elif params['type'] == 'sawtooth':\n            r_inv = params['r_inv']\n            if r = r_inv:\n                t_ev_r = params['t0']\n                A_r = params['A0'] * (1 - (r / r_inv)**2)\n            else:\n                t_ev_r = params['t0'] + 0.10 + 0.05 * r\n                A_r = 0.05 * params['A0']\n\n        base_signal = S0 - A_r * 0.5 * (1 + np.tanh((t - t_ev_r) / delta))\n        noise = rng.normal(0, params['sigma_S'], size=Nt)\n        S[i, :] = base_signal + noise\n        \n    return S\n\ndef generate_magnetic_signal(params, t):\n    \"\"\"Generates the synthetic magnetic marker signal M(t).\"\"\"\n    t0 = params['t0']\n    delta_pre = 0.01\n    sigma_M = 0.003\n    t_precursor = t0 - delta_pre\n    \n    precursor = params['A_M'] * np.exp(-((t - t_precursor)**2) / (2 * sigma_M**2))\n    \n    rng = np.random.default_rng(params['seed'])\n    noise = rng.normal(0, params['sigma_M_noise'], size=len(t))\n    \n    return precursor + noise\n\ndef classify_event(S, M, t, r_grid, a, dt):\n    \"\"\"\n    Implements the classification algorithm.\n    \"\"\"\n    # --- Algorithm Thresholds ---\n    R_M_star = 3.0\n    v_max = 300.0\n    C_tr_star = 0.7\n    alpha = 0.2\n\n    # Step 1: Preprocess S(r,t) with Gaussian smoothing\n    sigma_filter = 0.001 / dt  # sigma in units of array indices\n    S_smooth = gaussian_filter1d(S, sigma=sigma_filter, axis=1)\n\n    # Step 2: Detect core event time t0_est\n    dSdt_core = np.gradient(S_smooth[0, :], dt)\n    idx_t0 = np.argmin(dSdt_core)\n    t0_est = t[idx_t0]\n    min_deriv_core = dSdt_core[idx_t0]\n\n    # Step 3: Estimate local event times t_i\n    r_analysis_mask = r_grid = 0.50\n    analysis_radii_indices = np.where(r_analysis_mask)[0]\n    \n    t_search_window_indices = (t > t0_est - 0.02)  (t  t0_est + 0.02)\n\n    valid_r = []\n    valid_t = []\n\n    for i in analysis_radii_indices:\n        dSdt_local = np.gradient(S_smooth[i, :], dt)\n        \n        if np.any(t_search_window_indices):\n            windowed_deriv = dSdt_local[t_search_window_indices]\n            min_deriv_local = np.min(windowed_deriv)\n            idx_t_local_in_window = np.argmin(windowed_deriv)\n            \n            t_local = t[t_search_window_indices][idx_t_local_in_window]\n            \n            if abs(min_deriv_local) >= alpha * abs(min_deriv_core):\n                valid_r.append(r_grid[i])\n                valid_t.append(t_local)\n\n    # Step 4, 6: Estimate slope, v_prop, and coherence C_tr\n    m_tr, C_tr, v_prop = 0.0, 0.0, np.inf\n    if len(valid_r) >= 2:\n        res = linregress(valid_r, valid_t)\n        m_tr = res.slope\n        C_tr = res.rvalue\n        if m_tr > 1e-9:  # Avoid division by zero for near-simultaneous events\n            v_prop = a / m_tr\n\n    # Step 5: Quantify magnetic marker\n    t_base_end = max(t0_est - 0.05, 0.05)    \n    base_mask = t  t_base_end\n    if np.any(base_mask):\n        sigma_base = np.std(M[base_mask])\n    else:\n        sigma_base = np.std(M)\n\n    precursor_mask = (t >= t0_est - 0.02)  (t = t0_est + 0.005)\n    if np.any(precursor_mask):\n        max_M_precursor = np.max(np.abs(M[precursor_mask]))\n    else:\n        max_M_precursor = 0.0\n\n    R_M = max_M_precursor / sigma_base if sigma_base > 1e-9 else np.inf\n\n    # Step 7: Decision logic\n    classification = 0  # Default to sawtooth\n    \n    is_avalanche_candidate = (R_M = R_M_star) and (C_tr >= C_tr_star) and (m_tr > 0)\n    \n    if is_avalanche_candidate:\n        if 0  v_prop = v_max:\n            classification = 1\n    \n    return classification\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}