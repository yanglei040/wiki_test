{
    "hands_on_practices": [
        {
            "introduction": "This exercise forms the analytical bedrock for understanding profile stiffness. By solving a simplified 1D heat transport model, you will gain firsthand experience in deriving a steady-state temperature profile governed by a transport law that stiffens above a critical gradient. This practice is essential for building a fundamental intuition for how the interplay between heating and transport sculpts the plasma profiles.",
            "id": "3715651",
            "problem": "Consider a one-dimensional slab model of the core of a magnetically confined fusion plasma, where the stationary temperature profile depends on a flux-driven transport law that exhibits profile stiffness and resilience. Let the outward radial heat flux be denoted by $Q(r)$ and let the local stiffness control parameter be the gradient variable $\\kappa(r)$, defined by $\\kappa(r) = -\\frac{dT}{dr}$, so that larger $\\kappa(r)$ corresponds to steeper temperature gradients. Assume the slab spans $r \\in [0,a]$, with a fixed edge temperature $T(a) = T_a$ and a symmetry condition that sets the outward flux to zero at the center, $Q(0) = 0$.\n\nThe stationary energy balance for volumetric heating $S(r)$ is taken from conservation of energy in the form $\\nabla \\cdot \\mathbf{q} = S(r)$, where $\\mathbf{q}$ is the heat flux density. In this one-dimensional slab, this reduces to $\\frac{dQ}{dr} = S(r)$. The heating source is specified to be spatially uniform, $S(r) = S_0$, with $S_0 > 0$.\n\nProfile stiffness enters through a piecewise flux–gradient relation:\n- For $\\kappa  \\kappa_c$, the transport is baseline diffusive with $Q(\\kappa) = \\chi_0 \\kappa$.\n- For $\\kappa \\ge \\kappa_c$, the transport stiffens, modeled by $Q(\\kappa) = \\chi_0 \\kappa + \\alpha (\\kappa - \\kappa_c)^n$.\n\nTake the exponent $n$ to be $n = 2$ and parameters $\\chi_0 > 0$, $\\alpha > 0$, and $\\kappa_c > 0$. Assume $\\chi_0 \\kappa_c  S_0 a$, so that the heating drive is strong enough that the threshold is exceeded somewhere in $r \\in (0,a)$.\n\nStarting from the energy balance and the above flux–gradient relation, derive the stationary temperature profile and then compute the central temperature $T(0)$ in terms of $T_a$, $a$, $S_0$, $\\chi_0$, $\\alpha$, and $\\kappa_c$. Express your final answer as a single closed-form analytic expression. Do not approximate or round; no numerical evaluation is required and no units need be reported in the final expression.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of heat transport and energy conservation, mathematically well-posed with sufficient conditions for a unique solution, and objectively stated. The model of profile stiffness is a standard, albeit simplified, representation used in plasma physics. All parameters are clearly defined, and the constraints are self-consistent.\n\nThe starting point is the stationary energy balance equation in a one-dimensional slab, which is given as $\\frac{dQ(r)}{dr} = S(r)$. The volumetric heating source $S(r)$ is uniform, $S(r) = S_0$, where $S_0 > 0$. The equation is thus:\n$$\n\\frac{dQ}{dr} = S_0\n$$\nIntegrating with respect to the radial coordinate $r$ yields the heat flux profile:\n$$\nQ(r) = S_0 r + C\n$$\nwhere $C$ is a constant of integration. The symmetry condition at the center of the slab, $Q(0) = 0$, implies that $C=0$. Therefore, the heat flux is given by:\n$$\nQ(r) = S_0 r\n$$\nThe problem defines a piecewise flux-gradient relationship based on the temperature gradient $\\kappa(r) = -\\frac{dT}{dr}$. The transition between transport regimes occurs at a critical gradient, $\\kappa_c$. The transport law is continuous at this threshold:\n- For $\\kappa  \\kappa_c$: $Q(\\kappa) = \\chi_0 \\kappa$.\n- For $\\kappa \\ge \\kappa_c$: $Q(\\kappa) = \\chi_0 \\kappa + \\alpha (\\kappa - \\kappa_c)^2$.\n\nAt the transition point, $\\kappa = \\kappa_c$, the flux is $Q(\\kappa_c) = \\chi_0 \\kappa_c$. Since the flux $Q(r)$ increases with $r$, and the gradient $\\kappa(r)$ is a monotonically increasing function of $Q(r)$, $\\kappa(r)$ is also a monotonically increasing function of $r$. The plasma is in the baseline transport regime near the center where the flux is low, and enters the stiff transport regime at larger radii where the flux is high. The transition occurs at a specific radius, $r_c$, where $\\kappa(r_c) = \\kappa_c$. We can find $r_c$ by equating the flux expressions:\n$$\nQ(r_c) = S_0 r_c = \\chi_0 \\kappa_c\n$$\nSolving for $r_c$ gives:\n$$\nr_c = \\frac{\\chi_0 \\kappa_c}{S_0}\n$$\nThe problem provides the condition $\\chi_0 \\kappa_c  S_0 a$, which implies $r_c  a$. Since all parameters are positive, $r_c > 0$. This confirms that the transition occurs within the slab, defining two distinct regions:\n1.  Inner Region (baseline transport): $0 \\le r \\le r_c$, where $\\kappa(r) \\le \\kappa_c$.\n2.  Outer Region (stiff transport): $r_c  r \\le a$, where $\\kappa(r) > \\kappa_c$.\n\nTo find the central temperature $T(0)$, we integrate the temperature gradient $\\kappa(r) = -\\frac{dT}{dr}$ from the edge at $r=a$ to the center at $r=0$:\n$$\nT(0) - T(a) = \\int_{a}^{0} \\frac{dT}{dr} dr = \\int_{0}^{a} \\left(-\\frac{dT}{dr}\\right) dr = \\int_{0}^{a} \\kappa(r) dr\n$$\n$$\nT(0) = T_a + \\int_{0}^{a} \\kappa(r) dr\n$$\nThe integral is split across the two regions:\n$$\nT(0) = T_a + \\int_{0}^{r_c} \\kappa(r) dr + \\int_{r_c}^{a} \\kappa(r) dr\n$$\nFirst, we find $\\kappa(r)$ in each region by inverting the flux-gradient relation.\n\nIn the Inner Region ($0 \\le r \\le r_c$):\n$$\nQ(r) = \\chi_0 \\kappa(r) \\implies S_0 r = \\chi_0 \\kappa(r)\n$$\n$$\n\\kappa(r) = \\frac{S_0}{\\chi_0} r\n$$\nThe integral over this region is:\n$$\n\\int_{0}^{r_c} \\frac{S_0}{\\chi_0} r \\, dr = \\frac{S_0}{2\\chi_0} [r^2]_0^{r_c} = \\frac{S_0}{2\\chi_0} r_c^2 = \\frac{S_0}{2\\chi_0} \\left( \\frac{\\chi_0 \\kappa_c}{S_0} \\right)^2 = \\frac{\\chi_0 \\kappa_c^2}{2S_0}\n$$\nIn the Outer Region ($r_c  r \\le a$):\n$$\nQ(r) = S_0 r = \\chi_0 \\kappa(r) + \\alpha (\\kappa(r) - \\kappa_c)^2\n$$\nThis is a quadratic equation for $\\kappa(r)$. Let $y = \\kappa(r) - \\kappa_c$. The equation becomes $S_0 r = \\chi_0(y + \\kappa_c) + \\alpha y^2$, which rearranges to:\n$$\n\\alpha y^2 + \\chi_0 y + (\\chi_0 \\kappa_c - S_0 r) = 0\n$$\nSolving for $y$ using the quadratic formula:\n$$\ny = \\frac{-\\chi_0 \\pm \\sqrt{\\chi_0^2 - 4\\alpha(\\chi_0 \\kappa_c - S_0 r)}}{2\\alpha}\n$$\nIn this region, $\\kappa(r) > \\kappa_c$, so $y > 0$. For $r>r_c$, we have $S_0 r > S_0 r_c = \\chi_0 \\kappa_c$, which means $S_0 r - \\chi_0 \\kappa_c > 0$. The argument of the square root is $\\chi_0^2 - 4\\alpha\\chi_0\\kappa_c + 4\\alpha S_0 r > \\chi_0^2$. Thus $\\sqrt{\\dots} > \\chi_0$, so we must choose the `+` sign to ensure $y > 0$.\n$$\n\\kappa(r) - \\kappa_c = \\frac{-\\chi_0 + \\sqrt{\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 r}}{2\\alpha}\n$$\n$$\n\\kappa(r) = \\kappa_c - \\frac{\\chi_0}{2\\alpha} + \\frac{1}{2\\alpha}\\sqrt{\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 r}\n$$\nNow we compute the integral over this outer region:\n$$\n\\int_{r_c}^{a} \\kappa(r) dr = \\int_{r_c}^{a} \\left( \\kappa_c - \\frac{\\chi_0}{2\\alpha} \\right) dr + \\frac{1}{2\\alpha} \\int_{r_c}^{a} \\sqrt{\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 r} \\, dr\n$$\nThe first part is:\n$$\n\\left[ \\left( \\kappa_c - \\frac{\\chi_0}{2\\alpha} \\right) r \\right]_{r_c}^a = \\left( \\kappa_c - \\frac{\\chi_0}{2\\alpha} \\right) (a-r_c)\n$$\nFor the second part of the integral, let $u = \\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 r$, so $du = 4\\alpha S_0 dr$.\n$$\n\\frac{1}{2\\alpha} \\int \\sqrt{u} \\frac{du}{4\\alpha S_0} = \\frac{1}{8\\alpha^2 S_0} \\int u^{1/2} du = \\frac{1}{8\\alpha^2 S_0} \\frac{2}{3} u^{3/2} = \\frac{1}{12\\alpha^2 S_0} u^{3/2}\n$$\nEvaluating the definite integral from $r_c$ to $a$:\n$$\n\\frac{1}{12\\alpha^2 S_0} \\left[ (\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 r)^{3/2} \\right]_{r_c}^a\n$$\nThe lower limit evaluated at $r=r_c=\\frac{\\chi_0 \\kappa_c}{S_0}$ is:\n$$\n\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 \\left(\\frac{\\chi_0 \\kappa_c}{S_0}\\right) = \\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha\\chi_0 \\kappa_c = \\chi_0^2\n$$\nSo the second integral part is:\n$$\n\\frac{1}{12\\alpha^2 S_0} \\left[ (\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 a)^{3/2} - (\\chi_0^2)^{3/2} \\right] = \\frac{(\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 a)^{3/2} - \\chi_0^3}{12\\alpha^2 S_0}\n$$\nCombining all parts for $T(0)$:\n$$\nT(0) = T_a + \\frac{\\chi_0 \\kappa_c^2}{2S_0} + \\left( \\kappa_c - \\frac{\\chi_0}{2\\alpha} \\right) (a-r_c) + \\frac{(\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 a)^{3/2} - \\chi_0^3}{12\\alpha^2 S_0}\n$$\nSubstituting $r_c = \\frac{\\chi_0 \\kappa_c}{S_0}$:\n$$\nT(0) = T_a + \\frac{\\chi_0 \\kappa_c^2}{2S_0} + \\left( \\kappa_c - \\frac{\\chi_0}{2\\alpha} \\right) \\left(a-\\frac{\\chi_0 \\kappa_c}{S_0}\\right) + \\frac{(\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 a)^{3/2} - \\chi_0^3}{12\\alpha^2 S_0}\n$$\nExpanding the product term:\n$$\n\\left( \\kappa_c - \\frac{\\chi_0}{2\\alpha} \\right) \\left(a-\\frac{\\chi_0 \\kappa_c}{S_0}\\right) = a\\kappa_c - \\frac{\\chi_0 \\kappa_c^2}{S_0} - \\frac{a\\chi_0}{2\\alpha} + \\frac{\\chi_0^2 \\kappa_c}{2\\alpha S_0}\n$$\nAdding this to the result from the inner region:\n$$\n\\frac{\\chi_0 \\kappa_c^2}{2S_0} + a\\kappa_c - \\frac{\\chi_0 \\kappa_c^2}{S_0} - \\frac{a\\chi_0}{2\\alpha} + \\frac{\\chi_0^2 \\kappa_c}{2\\alpha S_0} = a\\kappa_c - \\frac{a\\chi_0}{2\\alpha} - \\frac{\\chi_0 \\kappa_c^2}{2S_0} + \\frac{\\chi_0^2 \\kappa_c}{2\\alpha S_0}\n$$\nSumming everything provides the final expression for the central temperature:\n$$\nT(0) = T_a + a\\kappa_c - \\frac{a\\chi_0}{2\\alpha} - \\frac{\\chi_0 \\kappa_c^2}{2S_0} + \\frac{\\chi_0^2 \\kappa_c}{2\\alpha S_0} + \\frac{(\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 a)^{3/2} - \\chi_0^3}{12\\alpha^2 S_0}\n$$\nThis is the complete and exact analytical solution.",
            "answer": "$$\n\\boxed{T_a + a\\kappa_c - \\frac{a\\chi_0}{2\\alpha} - \\frac{\\chi_0 \\kappa_c^2}{2S_0} + \\frac{\\chi_0^2 \\kappa_c}{2\\alpha S_0} + \\frac{(\\chi_0^2 - 4\\alpha\\chi_0 \\kappa_c + 4\\alpha S_0 a)^{3/2} - \\chi_0^3}{12\\alpha^2 S_0}}\n$$"
        },
        {
            "introduction": "Building upon the analytical foundation, this practice moves into the computational domain to demonstrate the consequences of stiffness in a more tangible way. You will implement a simple transport code surrogate to observe the phenomenon of \"profile pinning\" directly. This exercise highlights how, in a stiff system, increasing the heating power primarily raises the edge temperature pedestal rather than steepening the core gradient, a key feature of resilient plasma profiles. ",
            "id": "3715628",
            "problem": "Consider a one-dimensional slab surrogate for heat transport in a magnetically confined fusion plasma, intended to emulate profile resilience and stiffness in the core temperature gradient under flux-driven conditions. The spatial coordinate is $x \\in [0,L]$, with $x=0$ denoting the magnetic axis and $x=L$ denoting the plasma edge. The steady-state heat balance is defined by the conservation law $dq/dx = s(x)$, where $q(x)$ is the outward heat flux (in $\\mathrm{MW}/\\mathrm{m}^2$) and $s(x)$ is the volumetric heating source density (in $\\mathrm{MW}/\\mathrm{m}^3$). The core temperature profile $T(x)$ (in $\\mathrm{keV}$) is monotonic with $-dT/dx \\ge 0$. The edge is coupled to a sink via a linear heat exhaust boundary condition $q(L) = h \\left(T(L) - T_\\mathrm{wall}\\right)$, with $h$ the edge exhaust coefficient (in $\\mathrm{MW}/(\\mathrm{m}^2\\cdot\\mathrm{keV})$) and $T_\\mathrm{wall}$ the wall-referenced edge temperature (in $\\mathrm{keV}$).\n\nTo model turbulence-induced stiffness, adopt a piecewise-linear “critical gradient” surrogate for the local flux–gradient relation, representing the onset of strong turbulent transport once a critical gradient is exceeded. Define the local gradient magnitude $g(x) = -dT/dx \\ge 0$ (in $\\mathrm{keV}/\\mathrm{m}$). The flux–gradient relation is\n$$\nq\\big(g(x)\\big) = \n\\begin{cases}\n\\kappa_\\mathrm{low}\\,g(x),  g(x) \\le g_c,\\\\\n\\kappa_\\mathrm{low}\\,g_c + \\kappa_\\mathrm{high}\\,\\big(g(x) - g_c\\big),  g(x)  g_c,\n\\end{cases}\n$$\nwith $\\kappa_\\mathrm{low}$ and $\\kappa_\\mathrm{high}$ the low- and high-transport coefficients (in $\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})$), and $g_c$ the critical gradient (in $\\mathrm{keV}/\\mathrm{m}$). This surrogate enforces resilience: once $g(x)$ reaches $g_c$, further increases in heat flux are carried predominantly by a large $\\kappa_\\mathrm{high}$ rather than further increases in $g(x)$, thereby “pinning” the core gradient near $g_c$.\n\nAssume a uniform source $s(x) = s_0$ over $x \\in [0,L]$, with $s_0$ constant (in $\\mathrm{MW}/\\mathrm{m}^3$). Under $dq/dx = s_0$ and symmetry $q(0)=0$, the flux is $q(x) = s_0\\,x$, and the edge flux is $q(L) = s_0\\,L$. The edge temperature follows from the boundary condition as $T(L) = T_\\mathrm{wall} + q(L)/h$. The temperature profile is recovered by integrating $g(x)$ from the edge inward:\n$$\nT(x) = T(L) + \\int_x^L g(\\xi)\\,d\\xi.\n$$\nYour task is to implement this surrogate model to demonstrate that increasing input power modifies only the edge temperature while keeping the core gradient pinned near $g_c$, over a set of cases with increasing $s_0$, by computing the gradient at a representative core location $x_\\mathrm{core}$ and the resulting edge temperature.\n\nUse the following fixed parameters, which are scientifically plausible for a surrogate and self-consistent across units:\n- Domain length $L = 0.5\\,\\mathrm{m}$.\n- Edge exhaust coefficient $h = 40\\,\\mathrm{MW}/(\\mathrm{m}^2\\cdot\\mathrm{keV})$.\n- Wall-referenced edge temperature $T_\\mathrm{wall} = 0.1\\,\\mathrm{keV}$.\n- Low transport coefficient $\\kappa_\\mathrm{low} = 0.5\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})$.\n- High transport coefficient $\\kappa_\\mathrm{high} = 50\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})$.\n- Critical gradient $g_c = 5.0\\,\\mathrm{keV}/\\mathrm{m}$.\n- Core evaluation point $x_\\mathrm{core} = 0.25\\,\\mathrm{m}$.\n\nImplement a program that, for each test case, computes:\n- The core gradient magnitude $g(x_\\mathrm{core})$ in $\\mathrm{keV}/\\mathrm{m}$, rounded to $3$ decimal places.\n- The edge temperature $T(L)$ in $\\mathrm{keV}$, rounded to $3$ decimal places.\n\nDesign the program to evaluate the following test suite of source strengths $s_0$:\n- Case $1$: $s_0 = 2.0\\,\\mathrm{MW}/\\mathrm{m}^3$ (below-threshold near the core evaluation point).\n- Case $2$: $s_0 = 10.0\\,\\mathrm{MW}/\\mathrm{m}^3$ (around and slightly above the threshold).\n- Case $3$: $s_0 = 50.0\\,\\mathrm{MW}/\\mathrm{m}^3$ (well above the threshold).\n\nFor each case, compute $q(x) = s_0\\,x$, invert the flux–gradient relation to obtain $g(x_\\mathrm{core})$, compute $q(L) = s_0\\,L$, and then compute $T(L) = T_\\mathrm{wall} + q(L)/h$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one sublist per case in the form $[g(x_\\mathrm{core}),T(L)]$, for example $[[g_1,T_1],[g_2,T_2],[g_3,T_3]]$.",
            "solution": "The user has provided a valid problem statement. The problem is scientifically grounded in a simplified but standard model of plasma heat transport, is well-posed with a unique solution, and is expressed objectively with all necessary parameters defined. I will now provide a complete solution.\n\nThe problem asks us to compute the core temperature gradient magnitude $g(x_\\mathrm{core})$ and the edge temperature $T(L)$ for a one-dimensional plasma slab model. This model features a \"stiff\" transport characteristic, where the heat conductivity increases sharply above a critical temperature gradient $g_c$. We will evaluate these quantities for three different levels of uniform heating source strength, $s_0$.\n\nThe analysis begins with the provided governing equations and parameters.\nThe fixed parameters for the model are:\n- Domain length: $L = 0.5\\,\\mathrm{m}$\n- Edge exhaust coefficient: $h = 40\\,\\mathrm{MW}/(\\mathrm{m}^2\\cdot\\mathrm{keV})$\n- Wall-referenced edge temperature: $T_\\mathrm{wall} = 0.1\\,\\mathrm{keV}$\n- Low transport coefficient: $\\kappa_\\mathrm{low} = 0.5\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})$\n- High transport coefficient: $\\kappa_\\mathrm{high} = 50\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})$\n- Critical gradient: $g_c = 5.0\\,\\mathrm{keV}/\\mathrm{m}$\n- Core evaluation point: $x_\\mathrm{core} = 0.25\\,\\mathrm{m}$\n\nThe heat source is uniform, $s(x)=s_0$. Integrating the heat balance equation $dq/dx = s_0$ with the symmetry condition $q(0)=0$ yields the heat flux profile:\n$$q(x) = s_0 x$$\n\nThe required calculations for each test case of $s_0$ are:\n1.  The edge temperature, $T(L)$.\n2.  The core gradient magnitude, $g(x_\\mathrm{core}) = -dT/dx|_{x=x_\\mathrm{core}}$.\n\nFirst, we establish the formula for the edge temperature $T(L)$. It is determined by the heat exhaust boundary condition:\n$$q(L) = h \\left(T(L) - T_\\mathrm{wall}\\right)$$\nThe flux at the edge is $q(L) = s_0 L$. Substituting this into the boundary condition and solving for $T(L)$ gives:\n$$s_0 L = h \\left(T(L) - T_\\mathrm{wall}\\right)$$\n$$T(L) = T_\\mathrm{wall} + \\frac{s_0 L}{h}$$\nThis equation allows for a direct calculation of $T(L)$ for any given $s_0$.\n\nSecond, we determine the core gradient magnitude $g(x_\\mathrm{core})$. This requires using the piecewise flux-gradient relation:\n$$\nq(g) = \n\\begin{cases}\n\\kappa_\\mathrm{low}\\,g,  g \\le g_c, \\\\\n\\kappa_\\mathrm{low}\\,g_c + \\kappa_\\mathrm{high}\\,(g - g_c),  g  g_c.\n\\end{cases}\n$$\nTo find the gradient $g(x_\\mathrm{core})$ from the local heat flux $q(x_\\mathrm{core}) = s_0 x_\\mathrm{core}$, we must invert this relation to express $g$ as a function of $q$.\n\nLet's find the critical heat flux $q_c$ that corresponds to the critical gradient $g_c$. This is the flux value at the transition point between the low- and high-transport regimes:\n$$q_c = \\kappa_\\mathrm{low}\\,g_c$$\nFor the given parameters, $q_c = (0.5\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})) \\times (5.0\\,\\mathrm{keV}/\\mathrm{m}) = 2.5\\,\\mathrm{MW}/\\mathrm{m}^2$.\n\nNow we can write the inverse function $g(q)$:\n- If $q \\le q_c$, we are in the low-transport regime. We invert $q = \\kappa_\\mathrm{low}\\,g$:\n$$g(q) = \\frac{q}{\\kappa_\\mathrm{low}}$$\n- If $q  q_c$, we are in the high-transport (stiff) regime. We invert $q = \\kappa_\\mathrm{low}\\,g_c + \\kappa_\\mathrm{high}\\,(g - g_c)$:\n$$q - \\kappa_\\mathrm{low}\\,g_c = \\kappa_\\mathrm{high}\\,(g - g_c)$$\n$$\\frac{q - \\kappa_\\mathrm{low}\\,g_c}{\\kappa_\\mathrm{high}} = g - g_c$$\n$$g(q) = g_c + \\frac{q - \\kappa_\\mathrm{low}\\,g_c}{\\kappa_\\mathrm{high}}$$\nRecognizing that $\\kappa_\\mathrm{low}\\,g_c = q_c$, this simplifies to:\n$$g(q) = g_c + \\frac{q - q_c}{\\kappa_\\mathrm{high}}$$\nSo, the complete inverse relation is:\n$$\ng(q) = \n\\begin{cases}\nq/\\kappa_\\mathrm{low},  q \\le q_c, \\\\\ng_c + (q - q_c)/\\kappa_\\mathrm{high},  q  q_c.\n\\end{cases}\n$$\nWe will apply these formulae to the three test cases.\n\n**Case 1: $s_0 = 2.0\\,\\mathrm{MW}/\\mathrm{m}^3$**\n1.  Calculate heat fluxes:\n    - At the core: $q(x_\\mathrm{core}) = s_0 x_\\mathrm{core} = (2.0\\,\\mathrm{MW}/\\mathrm{m}^3) \\times (0.25\\,\\mathrm{m}) = 0.5\\,\\mathrm{MW}/\\mathrm{m}^2$.\n    - At the edge: $q(L) = s_0 L = (2.0\\,\\mathrm{MW}/\\mathrm{m}^3) \\times (0.5\\,\\mathrm{m}) = 1.0\\,\\mathrm{MW}/\\mathrm{m}^2$.\n2.  Calculate edge temperature $T(L)$:\n    - $T(L) = T_\\mathrm{wall} + \\frac{q(L)}{h} = 0.1\\,\\mathrm{keV} + \\frac{1.0\\,\\mathrm{MW}/\\mathrm{m}^2}{40\\,\\mathrm{MW}/(\\mathrm{m}^2\\cdot\\mathrm{keV})} = 0.1 + 0.025 = 0.125\\,\\mathrm{keV}$.\n3.  Calculate core gradient $g(x_\\mathrm{core})$:\n    - The core flux is $q(x_\\mathrm{core}) = 0.5\\,\\mathrm{MW}/\\mathrm{m}^2$, which is less than $q_c = 2.5\\,\\mathrm{MW}/\\mathrm{m}^2$. We use the low-transport formula.\n    - $g(x_\\mathrm{core}) = \\frac{q(x_\\mathrm{core})}{\\kappa_\\mathrm{low}} = \\frac{0.5\\,\\mathrm{MW}/\\mathrm{m}^2}{0.5\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})} = 1.0\\,\\mathrm{keV}/\\mathrm{m}$.\n4.  Result for Case 1: $[g(x_\\mathrm{core}), T(L)] = [1.000\\,\\mathrm{keV}/\\mathrm{m}, 0.125\\,\\mathrm{keV}]$.\n\n**Case 2: $s_0 = 10.0\\,\\mathrm{MW}/\\mathrm{m}^3$**\n1.  Calculate heat fluxes:\n    - At the core: $q(x_\\mathrm{core}) = s_0 x_\\mathrm{core} = (10.0\\,\\mathrm{MW}/\\mathrm{m}^3) \\times (0.25\\,\\mathrm{m}) = 2.5\\,\\mathrm{MW}/\\mathrm{m}^2$.\n    - At the edge: $q(L) = s_0 L = (10.0\\,\\mathrm{MW}/\\mathrm{m}^3) \\times (0.5\\,\\mathrm{m}) = 5.0\\,\\mathrm{MW}/\\mathrm{m}^2$.\n2.  Calculate edge temperature $T(L)$:\n    - $T(L) = T_\\mathrm{wall} + \\frac{q(L)}{h} = 0.1\\,\\mathrm{keV} + \\frac{5.0\\,\\mathrm{MW}/\\mathrm{m}^2}{40\\,\\mathrm{MW}/(\\mathrm{m}^2\\cdot\\mathrm{keV})} = 0.1 + 0.125 = 0.225\\,\\mathrm{keV}$.\n3.  Calculate core gradient $g(x_\\mathrm{core})$:\n    - The core flux is $q(x_\\mathrm{core}) = 2.5\\,\\mathrm{MW}/\\mathrm{m}^2$, which is exactly equal to $q_c$. We are at the threshold. Using the first formula:\n    - $g(x_\\mathrm{core}) = \\frac{q(x_\\mathrm{core})}{\\kappa_\\mathrm{low}} = \\frac{2.5\\,\\mathrm{MW}/\\mathrm{m}^2}{0.5\\,\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})} = 5.0\\,\\mathrm{keV}/\\mathrm{m}$, which is exactly $g_c$.\n4.  Result for Case 2: $[g(x_\\mathrm{core}), T(L)] = [5.000\\,\\mathrm{keV}/\\mathrm{m}, 0.225\\,\\mathrm{keV}]$.\n\n**Case 3: $s_0 = 50.0\\,\\mathrm{MW}/\\mathrm{m}^3$**\n1.  Calculate heat fluxes:\n    - At the core: $q(x_\\mathrm{core}) = s_0 x_\\mathrm{core} = (50.0\\,\\mathrm{MW}/\\mathrm{m}^3) \\times (0.25\\,\\mathrm{m}) = 12.5\\,\\mathrm{MW}/\\mathrm{m}^2$.\n    - At the edge: $q(L) = s_0 L = (50.0\\,\\mathrm{MW}/\\mathrm{m}^3) \\times (0.5\\,\\mathrm{m}) = 25.0\\,\\mathrm{MW}/\\mathrm{m}^2$.\n2.  Calculate edge temperature $T(L)$:\n    - $T(L) = T_\\mathrm{wall} + \\frac{q(L)}{h} = 0.1\\,\\mathrm{keV} + \\frac{25.0\\,\\mathrm{MW}/\\mathrm{m}^2}{40\\,\\mathrm{MW}/(\\mathrm{m}^2\\cdot\\mathrm{keV})} = 0.1 + 0.625 = 0.725\\,\\mathrm{keV}$.\n3.  Calculate core gradient $g(x_\\mathrm{core})$:\n    - The core flux is $q(x_\\mathrm{core}) = 12.5\\,\\mathrm{MW}/\\mathrm{m}^2$, which is greater than $q_c = 2.5\\,\\mathrm{MW}/\\mathrm{m}^2$. We use the high-transport formula.\n    - $g(x_\\mathrm{core}) = g_c + \\frac{q(x_\\mathrm{core}) - q_c}{\\kappa_\\mathrm{high}} = 5.0\\,\\mathrm{keV}/\\mathrm{m} + \\frac{12.5 - 2.5}{50} \\frac{\\mathrm{MW}/\\mathrm{m}^2}{\\mathrm{MW}/(\\mathrm{m}\\cdot\\mathrm{keV})} = 5.0 + \\frac{10.0}{50} = 5.0 + 0.2 = 5.2\\,\\mathrm{keV}/\\mathrm{m}$.\n4.  Result for Case 3: $[g(x_\\mathrm{core}), T(L)] = [5.200\\,\\mathrm{keV}/\\mathrm{m}, 0.725\\,\\mathrm{keV}]$.\n\nThe results demonstrate the phenomenon of profile stiffness. As the heating power $s_0$ increases five-fold from $10.0$ to $50.0\\,\\mathrm{MW}/\\mathrm{m}^3$, the core gradient $g(x_\\mathrm{core})$ increases by only a small amount, from $5.000\\,\\mathrm{keV}/\\mathrm{m}$ to $5.200\\,\\mathrm{keV}/\\mathrm{m}$, staying \"pinned\" near the critical value $g_c=5.0$. Most of the increased heating power is accommodated by a large rise in the edge temperature $T(L)$ from $0.225\\,\\mathrm{keV}$ to $0.725\\,\\mathrm{keV}$, rather than a steepening of the core temperature profile gradient.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the core gradient and edge temperature for a stiff heat transport\n    model in a fusion plasma surrogate.\n    \"\"\"\n    # Fixed parameters\n    L = 0.5            # Domain length [m]\n    h = 40.0           # Edge exhaust coefficient [MW/(m^2*keV)]\n    T_wall = 0.1       # Wall-referenced edge temperature [keV]\n    kappa_low = 0.5    # Low transport coefficient [MW/(m*keV)]\n    kappa_high = 50.0  # High transport coefficient [MW/(m*keV)]\n    g_c = 5.0          # Critical gradient [keV/m]\n    x_core = 0.25      # Core evaluation point [m]\n\n    # Test cases for source strength\n    test_cases = [\n        2.0,   # s0 [MW/m^3] - Case 1\n        10.0,  # s0 [MW/m^3] - Case 2\n        50.0   # s0 [MW/m^3] - Case 3\n    ]\n\n    results = []\n\n    # Calculate the critical heat flux q_c\n    q_c = kappa_low * g_c\n\n    for s0 in test_cases:\n        # 1. Calculate heat flux at core and edge\n        q_at_core = s0 * x_core\n        q_at_L = s0 * L\n\n        # 2. Calculate edge temperature T(L)\n        T_L = T_wall + q_at_L / h\n\n        # 3. Calculate core gradient g(x_core)\n        if q_at_core = q_c:\n            # Low-transport regime\n            g_at_core = q_at_core / kappa_low\n        else:\n            # High-transport (stiff) regime\n            g_at_core = g_c + (q_at_core - q_c) / kappa_high\n\n        # 4. Round results to 3 decimal places\n        g_rounded = round(g_at_core, 3)\n        T_L_rounded = round(T_L, 3)\n        \n        results.append((g_rounded, T_L_rounded))\n\n    # 5. Format the output string as specified\n    sublist_strings = [f\"[{g:.3f},{T:.3f}]\" for g, T in results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Our previous explorations relied on pre-defined transport coefficients. This advanced practice addresses a critical question in fusion research: how are the parameters of a transport model determined from experimental data? You will use Bayesian inference, a powerful statistical framework, to estimate the parameters of a stiffness model from synthetic measurements, providing insight into the real-world challenge of model validation and uncertainty quantification.  ",
            "id": "3715593",
            "problem": "Consider a simplified one-dimensional transport representation of profile resilience and stiffness in a magnetically confined fusion plasma, where the steady-state outward heat flux responds to the local normalized temperature gradient through a baseline diffusive channel and a stiffness augmentation when the gradient exceeds a critical threshold. Let the scalar observable for experiment index $i$ be the heat flux $ \\phi_i $, modeled as\n$$\n\\phi_i = D_0\\, g_i + K\\, \\max(0, g_i - g_c) + \\epsilon_i,\n$$\nwhere $ D_0 $ is the unknown baseline diffusivity parameter, $ K $ is the unknown stiffness amplitude parameter, $ g_i $ is the imposed normalized temperature gradient drive for experiment $ i $ (dimensionless), $ g_c $ is a known critical gradient (dimensionless), and $ \\epsilon_i $ is the measurement noise. Assume $ \\epsilon_i $ are Independent and Identically Distributed (IID) zero-mean Gaussian with variance $ \\sigma^2 $, so $ \\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2) $.\n\nIn nuclear fusion plasmas, turbulence exhibits resilience that tends to keep profiles near marginal stability; the augmentation term $ K\\, \\max(0, g_i - g_c) $ models transport stiffness that increases heat flux when the gradient exceeds the critical threshold $ g_c $. This stylized model is consistent with Fick’s law baseline scaling and with a critical-gradient-driven stiffness augmentation.\n\nYou are given synthetic datasets in which $ \\phi_i $ are generated from known ground-truth parameters $ (D_0^{\\star}, K^{\\star}) $ and known $ g_c $ with specified $ g_i $ and deterministic noise realizations. Treat $ \\phi_i $ as the measured observables for inference. Use Bayesian inference with independent Gamma priors for $ D_0 $ and $ K $, and a Gaussian likelihood implied by the noise model. Specifically, let\n- $ D_0 \\sim \\operatorname{Gamma}(k_D, \\theta_D) $,\n- $ K \\sim \\operatorname{Gamma}(k_K, \\theta_K) $,\nwhere the Gamma parameterization is shape $ k $ and scale $ \\theta $. The Probability Density Function (PDF) is $ f(x; k, \\theta) = \\frac{1}{\\Gamma(k)\\,\\theta^k} x^{k-1} e^{-x/\\theta} $ for $ x0 $.\n\nStarting from Bayes’ rule $ p(D_0,K \\mid \\{\\phi_i\\}) \\propto p(\\{\\phi_i\\} \\mid D_0,K)\\, p(D_0)\\, p(K) $, use a uniform rectangular grid in parameter space to numerically approximate the posterior. From the posterior, compute the marginal posterior means for $ D_0 $ and $ K $, and the equal-tailed $ 0.95 $ credible intervals for each parameter. Then evaluate identifiability using an explicit quantitative criterion based on posterior shrinkage and correlation:\n- Compute the prior $ 0.95 $ equal-tailed interval widths for $ D_0 $ and $ K $ from their Gamma priors.\n- Compute the posterior $ 0.95 $ equal-tailed interval widths from the marginal posteriors.\n- Define the shrinkage ratios $ S_{D_0} = \\frac{w_{D_0,\\text{post}}}{w_{D_0,\\text{prior}}} $ and $ S_{K} = \\frac{w_{K,\\text{post}}}{w_{K,\\text{prior}}} $, where $ w $ denotes interval width.\n- Compute the posterior correlation between $ D_0 $ and $ K $ from the normalized joint posterior as $ \\rho = \\frac{\\operatorname{Cov}(D_0,K)}{\\sqrt{\\operatorname{Var}(D_0)\\operatorname{Var}(K)}} $.\n- Declare the parameter set identifiable if $ S_{D_0}  0.6 $, $ S_{K}  0.6 $, and $ |\\rho|  0.95 $. Otherwise, declare it non-identifiable.\n\nAll quantities are dimensionless, so no physical units are required. Angles do not appear. Your algorithm must implement normalization of the posterior over the grid using numerical quadrature consistent with the rectangular grid spacing and must compute marginal densities by integrating out the other parameter. The credible intervals must be equal-tailed with total posterior mass $ 0.95 $.\n\nUse the following test suite of synthetic cases. In each case, $ \\phi_i $ is computed as $ \\phi_i = D_0^{\\star} g_i + K^{\\star} \\max(0, g_i - g_c) + \\eta_i $ with the given $ \\eta_i $, and the posterior uses the specified $ \\sigma $ for the Gaussian likelihood:\n- Case $ 1 $ (mixed gradients, informative):\n  - $ g_c = 3.5 $,\n  - $ g_i $ list: $ [2.0, 3.0, 3.5, 3.8, 4.2, 4.8, 3.2, 5.0] $,\n  - ground-truth $ (D_0^{\\star}, K^{\\star}) = (1.5, 4.0) $,\n  - noise realizations $ \\eta_i $ list: $ [0.05, -0.02, 0.03, -0.04, 0.00, 0.01, -0.03, 0.02] $,\n  - likelihood standard deviation $ \\sigma = 0.05 $.\n- Case $ 2 $ (all gradients below $ g_c $, stiffness unexcited):\n  - $ g_c = 3.5 $,\n  - $ g_i $ list: $ [2.0, 2.5, 3.0, 3.2, 3.4] $,\n  - ground-truth $ (D_0^{\\star}, K^{\\star}) = (1.5, 4.0) $,\n  - noise realizations $ \\eta_i $ list: $ [0.04, -0.03, 0.05, -0.02, 0.01] $,\n  - likelihood standard deviation $ \\sigma = 0.05 $.\n- Case $ 3 $ (high noise, stiffness partially excited):\n  - $ g_c = 3.5 $,\n  - $ g_i $ list: $ [4.0, 4.5, 5.0, 5.5, 6.0] $,\n  - ground-truth $ (D_0^{\\star}, K^{\\star}) = (1.5, 2.0) $,\n  - noise realizations $ \\eta_i $ list: $ [0.30, -0.25, 0.40, -0.35, 0.20] $,\n  - likelihood standard deviation $ \\sigma = 0.30 $.\n\nUse the same independent Gamma priors for all cases:\n- Prior for $ D_0 $: $ k_D = 3.0 $, $ \\theta_D = 0.8 $,\n- Prior for $ K $: $ k_K = 3.0 $, $ \\theta_K = 1.5 $.\n\nUse the following grid specifications common to all cases:\n- $ D_0 $ grid from $ 0.0 $ to $ 5.0 $ inclusive with uniform step $ 0.01 $,\n- $ K $ grid from $ 0.0 $ to $ 8.0 $ inclusive with uniform step $ 0.02 $.\n\nYour program must:\n- Generate $ \\phi_i $ for each case from the given $ g_i $, $ g_c $, ground-truth $ (D_0^{\\star}, K^{\\star}) $, and $ \\eta_i $.\n- Compute the normalized joint posterior on the rectangular grid.\n- Compute the marginal posterior means for $ D_0 $ and $ K $, and equal-tailed $ 0.95 $ credible intervals for each parameter.\n- Compute the prior equal-tailed $ 0.95 $ credible intervals for $ D_0 $ and $ K $ and the shrinkage ratios $ S_{D_0} $ and $ S_{K} $.\n- Compute the posterior correlation $ \\rho $.\n- Determine the identifiability boolean with the criterion specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of three lists, one for each case, where each case list contains seven entries in the following order: posterior mean of $ D_0 $, lower bound of the $ 0.95 $ credible interval for $ D_0 $, upper bound of the $ 0.95 $ credible interval for $ D_0 $, posterior mean of $ K $, lower bound of the $ 0.95 $ credible interval for $ K $, upper bound of the $ 0.95 $ credible interval for $ K $, and the identifiability boolean. All numeric entries must be decimal floats. For example, a valid output shape is $ [[d_1,\\ell_{d,1},u_{d,1},k_1,\\ell_{k,1},u_{k,1},b_1],[d_2,\\ell_{d,2},u_{d,2},k_2,\\ell_{k,2},u_{k,2},b_2],[d_3,\\ell_{d,3},u_{d,3},k_3,\\ell_{k,3},u_{k,3},b_3]] $.",
            "solution": "The user has provided a well-defined Bayesian inference problem concerning a simplified model of heat transport in a fusion plasma. The problem is scientifically grounded, mathematically consistent, and all necessary parameters, data, and criteria are explicitly stated. Therefore, the problem is deemed valid.\n\nThe solution proceeds by implementing the specified Bayesian analysis for each of the three test cases. The core of the method involves computing the joint posterior probability distribution for the parameters $D_0$ (baseline diffusivity) and $K$ (stiffness amplitude) on a discrete grid, and then deriving various statistical measures from this posterior.\n\nThe model for the measured heat flux $\\phi_i$ is given by:\n$$\n\\phi_i = D_0\\, g_i + K\\, \\max(0, g_i - g_c) + \\epsilon_i\n$$\nwhere $g_i$ is the temperature gradient, $g_c$ is the critical gradient, and $\\epsilon_i$ is Gaussian noise, $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$.\n\nAccording to Bayes' theorem, the posterior probability of the parameters $(D_0, K)$ given the data $\\{\\phi_i\\}$ is proportional to the product of the likelihood and the prior probability:\n$$\np(D_0, K \\mid \\{\\phi_i\\}) \\propto p(\\{\\phi_i\\} \\mid D_0, K) \\, p(D_0, K)\n$$\nGiven that the parameters are a priori independent, $p(D_0, K) = p(D_0) p(K)$.\n\n1.  **Prior Distributions**:\n    The priors for $D_0$ and $K$ are given as Gamma distributions:\n    $$\n    D_0 \\sim \\operatorname{Gamma}(k_D, \\theta_D) \\quad \\text{with } k_D=3.0, \\theta_D=0.8\n    $$\n    $$\n    K \\sim \\operatorname{Gamma}(k_K, \\theta_K) \\quad \\text{with } k_K=3.0, \\theta_K=1.5\n    $$\n    The probability density function (PDF) for a Gamma distribution with shape $k$ and scale $\\theta$ is $f(x; k, \\theta) = \\frac{1}{\\Gamma(k)\\theta^k} x^{k-1} e^{-x/\\theta}$. Since the grid includes $D_0=0$ and $K=0$, we note that the Gamma PDF is zero for $x \\le 0$, which will correctly yield a posterior probability of zero at these boundaries.\n\n2.  **Likelihood Function**:\n    The noise $\\epsilon_i$ is Independent and Identically Distributed (IID) from $\\mathcal{N}(0,\\sigma^2)$. The likelihood of observing the entire dataset $\\{\\phi_i\\}$ is the product of the probabilities of each individual observation:\n    $$\n    p(\\{\\phi_i\\} \\mid D_0, K) = \\prod_{i=1}^N \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(\\phi_i - \\mu_i(D_0, K))^2}{2\\sigma^2} \\right)\n    $$\n    where $\\mu_i(D_0, K) = D_0 g_i + K \\max(0, g_i - g_c)$. For numerical stability, we work with the log-likelihood:\n    $$\n    \\ln p(\\{\\phi_i\\} \\mid D_0, K) = -\\frac{N}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^N (\\phi_i - \\mu_i(D_0, K))^2\n    $$\n\n3.  **Numerical Computation of the Posterior**:\n    We discretize the parameter space $(D_0, K)$ into a uniform rectangular grid as specified.\n    - $D_0 \\in [0.0, 5.0]$ with step $\\Delta D_0 = 0.01$.\n    - $K \\in [0.0, 8.0]$ with step $\\Delta K = 0.02$.\n    \n    At each grid point $(D_{0,j}, K_l)$, we compute the unnormalized log-posterior:\n    $$\n    \\ln P_{\\text{un}}(D_{0,j}, K_l) = \\ln p(\\{\\phi_i\\} \\mid D_{0,j}, K_l) + \\ln p(D_{0,j}) + \\ln p(K_l)\n    $$\n    The unnormalized posterior is then $P_{\\text{un}}(D_{0,j}, K_l) = \\exp(\\ln P_{\\text{un}}(D_{0,j}, K_l))$. To avoid numerical underflow or overflow, we use the log-sum-exp trick for normalization. The normalization constant (evidence) is approximated by a Riemann sum over the grid:\n    $$\n    Z = \\iint P_{\\text{un}}(D_0, K) \\,dD_0 \\,dK \\approx \\sum_{j,l} P_{\\text{un}}(D_{0,j}, K_l) \\Delta D_0 \\Delta K\n    $$\n    The normalized posterior PDF on the grid is $P_{\\text{norm}}(D_{0,j}, K_l) = P_{\\text{un}}(D_{0,j}, K_l) / Z$.\n\n4.  **Posterior Statistics**:\n    - **Marginal Distributions**: The marginal PDFs are computed by integrating (summing) the joint posterior over the other parameter's domain:\n      $$\n      p(D_{0,j} \\mid \\{\\phi_i\\}) = \\sum_l P_{\\text{norm}}(D_{0,j}, K_l) \\Delta K\n      $$\n      $$\n      p(K_l \\mid \\{\\phi_i\\}) = \\sum_j P_{\\text{norm}}(D_{0,j}, K_l) \\Delta D_0\n      $$\n    - **Posterior Means**: The means are the expectation values calculated from the marginals:\n      $$\n      E[D_0] = \\sum_j D_{0,j} \\, p(D_{0,j} \\mid \\{\\phi_i\\}) \\, \\Delta D_0\n      $$\n      $$\n      E[K] = \\sum_l K_l \\, p(K_l \\mid \\{\\phi_i\\}) \\, \\Delta K\n      $$\n    - **Credible Intervals**: The equal-tailed $0.95$ credible interval for each parameter is found by identifying the $0.025$ and $0.975$ quantiles of its marginal posterior distribution. This is done by first computing the cumulative distribution function (CDF) from the marginal PDF and then using linear interpolation to find the parameter values corresponding to probabilities $0.025$ and $0.975$.\n\n5.  **Identifiability Analysis**:\n    - **Prior Interval Widths**: The $0.95$ equal-tailed credible intervals for the Gamma priors are calculated using the inverse CDF (percent-point function) of the theoretical Gamma distribution.\n    - **Shrinkage Ratios**: The shrinkage ratio for each parameter is the ratio of its posterior credible interval width to its prior credible interval width: $S = w_{\\text{post}} / w_{\\text{prior}}$.\n    - **Posterior Correlation**: The correlation coefficient $\\rho$ is computed from the normalized joint posterior:\n      $$\n      \\rho = \\frac{\\operatorname{Cov}(D_0, K)}{\\sqrt{\\operatorname{Var}(D_0)\\operatorname{Var}(K)}}\n      $$\n      where variances and the covariance are numerical calculated from the posterior distributions, e.g., $\\operatorname{Cov}(D_0,K) = E[D_0 K] - E[D_0]E[K]$.\n    - **Criterion**: The parameter set is 'identifiable' if $S_{D_0}  0.6$, $S_{K}  0.6$, and $|\\rho|  0.95$.\n\nFor each test case, we first generate the synthetic data $\\phi_i$ using the provided ground-truth parameters $(D_0^{\\star}, K^{\\star})$ and noise realizations $\\eta_i$. Then, the above procedure is executed to compute the required posterior statistics and determine identifiability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import gamma\nfrom scipy.special import logsumexp\n\ndef solve():\n    \"\"\"\n    Main function to run the Bayesian inference for all test cases.\n    \"\"\"\n    \n    # Define common priors and grid specifications for all cases.\n    priors = {\n        'D0': {'k': 3.0, 'theta': 0.8},\n        'K': {'k': 3.0, 'theta': 1.5}\n    }\n    \n    grid_spec = {\n        'D0': {'min': 0.0, 'max': 5.0, 'step': 0.01},\n        'K': {'min': 0.0, 'max': 8.0, 'step': 0.02}\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases_data = [\n        # Case 1 (mixed gradients, informative)\n        {\n            \"g_c\": 3.5,\n            \"g_i\": [2.0, 3.0, 3.5, 3.8, 4.2, 4.8, 3.2, 5.0],\n            \"ground_truth\": (1.5, 4.0),\n            \"eta_i\": [0.05, -0.02, 0.03, -0.04, 0.00, 0.01, -0.03, 0.02],\n            \"sigma\": 0.05\n        },\n        # Case 2 (all gradients below gc, stiffness unexcited)\n        {\n            \"g_c\": 3.5,\n            \"g_i\": [2.0, 2.5, 3.0, 3.2, 3.4],\n            \"ground_truth\": (1.5, 4.0),\n            \"eta_i\": [0.04, -0.03, 0.05, -0.02, 0.01],\n            \"sigma\": 0.05\n        },\n        # Case 3 (high noise, stiffness partially excited)\n        {\n            \"g_c\": 3.5,\n            \"g_i\": [4.0, 4.5, 5.0, 5.5, 6.0],\n            \"ground_truth\": (1.5, 2.0),\n            \"eta_i\": [0.30, -0.25, 0.40, -0.35, 0.20],\n            \"sigma\": 0.30\n        }\n    ]\n\n    all_results = []\n    for case_data in test_cases_data:\n        result = process_case(case_data, priors, grid_spec)\n        all_results.append(result)\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([\n        \"[\" + \",\".join(map(str, res)) + \"]\" for res in all_results\n    ]) + \"]\"\n    \n    print(output_str)\n\n\ndef process_case(case_data, priors, grid_spec):\n    \"\"\"\n    Performs the full Bayesian analysis for a single case.\n    \"\"\"\n    g_c = case_data[\"g_c\"]\n    g_i = np.array(case_data[\"g_i\"])\n    D0_star, K_star = case_data[\"ground_truth\"]\n    eta_i = np.array(case_data[\"eta_i\"])\n    sigma_like = case_data[\"sigma\"]\n    \n    # 1. Generate observable data phi_i\n    phi_i = D0_star * g_i + K_star * np.maximum(0, g_i - g_c) + eta_i\n    \n    # 2. Setup grid\n    num_D0 = int(round((grid_spec['D0']['max'] - grid_spec['D0']['min']) / grid_spec['D0']['step'])) + 1\n    num_K = int(round((grid_spec['K']['max'] - grid_spec['K']['min']) / grid_spec['K']['step'])) + 1\n    D0_grid = np.linspace(grid_spec['D0']['min'], grid_spec['D0']['max'], num_D0)\n    K_grid = np.linspace(grid_spec['K']['min'], grid_spec['K']['max'], num_K)\n    dD0 = D0_grid[1] - D0_grid[0]\n    dK = K_grid[1] - K_grid[0]\n    \n    # 3. Calculate posterior on the grid\n    D0_mesh, K_mesh = np.meshgrid(D0_grid, K_grid, indexing='ij')\n    \n    # Log-prior. scipy.stats.gamma.logpdf handles x=0 correctly (returns -inf)\n    log_prior_D0 = gamma.logpdf(D0_mesh, a=priors['D0']['k'], scale=priors['D0']['theta'])\n    log_prior_K = gamma.logpdf(K_mesh, a=priors['K']['k'], scale=priors['K']['theta'])\n    log_prior = log_prior_D0 + log_prior_K\n    \n    # Log-likelihood using broadcasting\n    model_phi = (D0_mesh[..., np.newaxis] * g_i +\n                 K_mesh[..., np.newaxis] * np.maximum(0, g_i - g_c))\n    residuals = phi_i - model_phi\n    sum_sq_residuals = np.sum(residuals**2, axis=2)\n    log_likelihood = -0.5 * sum_sq_residuals / (sigma_like**2)\n    \n    # Unnormalized log posterior\n    log_posterior_un = log_prior + log_likelihood\n    \n    # 4. Normalize posterior\n    log_norm_const = logsumexp(log_posterior_un) + np.log(dD0 * dK)\n    log_posterior_norm = log_posterior_un - log_norm_const\n    posterior_norm = np.exp(log_posterior_norm)\n    \n    # 5. Calculate Marginals\n    marginal_D0_pdf = np.sum(posterior_norm, axis=1) * dK\n    marginal_K_pdf = np.sum(posterior_norm, axis=0) * dD0\n    \n    # 6. Calculate Posterior Means\n    mean_D0 = np.sum(D0_grid * marginal_D0_pdf) * dD0\n    mean_K = np.sum(K_grid * marginal_K_pdf) * dK\n    \n    # 7. Calculate Posterior Credible Intervals\n    cdf_D0 = np.cumsum(marginal_D0_pdf * dD0)\n    cdf_D0[-1] = 1.0  # Ensure CDF ends at 1 to handle potential float precision issues\n    lower_D0 = np.interp(0.025, cdf_D0, D0_grid)\n    upper_D0 = np.interp(0.975, cdf_D0, D0_grid)\n    \n    cdf_K = np.cumsum(marginal_K_pdf * dK)\n    cdf_K[-1] = 1.0\n    lower_K = np.interp(0.025, cdf_K, K_grid)\n    upper_K = np.interp(0.975, cdf_K, K_grid)\n    \n    # 8. Calculate Prior Credible Intervals and Shrinkage\n    prior_lower_D0 = gamma.ppf(0.025, a=priors['D0']['k'], scale=priors['D0']['theta'])\n    prior_upper_D0 = gamma.ppf(0.975, a=priors['D0']['k'], scale=priors['D0']['theta'])\n    prior_width_D0 = prior_upper_D0 - prior_lower_D0\n    post_width_D0 = upper_D0 - lower_D0\n    S_D0 = post_width_D0 / prior_width_D0 if prior_width_D0 > 0 else np.inf\n    \n    prior_lower_K = gamma.ppf(0.025, a=priors['K']['k'], scale=priors['K']['theta'])\n    prior_upper_K = gamma.ppf(0.975, a=priors['K']['k'], scale=priors['K']['theta'])\n    prior_width_K = prior_upper_K - prior_lower_K\n    post_width_K = upper_K - lower_K\n    S_K = post_width_K / prior_width_K if prior_width_K > 0 else np.inf\n    \n    # 9. Calculate Posterior Correlation\n    mean_D0_sq = np.sum(D0_grid**2 * marginal_D0_pdf) * dD0\n    var_D0 = mean_D0_sq - mean_D0**2\n    mean_K_sq = np.sum(K_grid**2 * marginal_K_pdf) * dK\n    var_K = mean_K_sq - mean_K**2\n    \n    mean_D0K = np.sum(D0_mesh * K_mesh * posterior_norm) * dD0 * dK\n    cov_D0K = mean_D0K - mean_D0 * mean_K\n    \n    # Add epsilon to prevent division by zero for perfectly determined parameters (var=0)\n    rho = cov_D0K / (np.sqrt(var_D0 * var_K) + 1e-15)\n    \n    # 10. Determine Identifiability\n    identifiable = (S_D0  0.6) and (S_K  0.6) and (abs(rho)  0.95)\n    \n    return [\n        mean_D0, lower_D0, upper_D0,\n        mean_K, lower_K, upper_K,\n        identifiable\n    ]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}