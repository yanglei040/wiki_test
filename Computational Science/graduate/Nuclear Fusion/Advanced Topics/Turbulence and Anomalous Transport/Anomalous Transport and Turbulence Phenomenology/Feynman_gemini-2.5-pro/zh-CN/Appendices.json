{
    "hands_on_practices": [
        {
            "introduction": "在聚变等离子体研究中，一项核心技能是从实验测量中推断出反常输运的根本物理原因。这个实践练习提供了一个模拟的托卡马克实验场景，旨在训练这种物理推断能力。通过将一系列详细的（尽管是假设的）输运观测趋势与几种关键微观不稳定性的已知“指纹”进行匹配，你将能够练习识别主导湍流的驱动机制，这是连接实验现象学和第一性原理理论的关键一步 。",
            "id": "3691190",
            "problem": "一个中型托卡马克，其大半径 $R = 1.7\\,\\mathrm{m}$，小半径 $a = 0.5\\,\\mathrm{m}$，环向磁场 $B = 2.5\\,\\mathrm{T}$，安全因子 $q \\approx 2$，在稳态高约束模下运行。局域电荷平衡和准电中性条件成立，湍流输运是根据稳态功率平衡推断出来的，使用 $Q_\\alpha \\approx - n_\\alpha \\chi_\\alpha \\nabla T_\\alpha$（适用于粒子种类 $\\alpha \\in \\{e, i\\}$），其中 $Q_\\alpha$ 是热通量，$n_\\alpha$ 是密度，$\\chi_\\alpha$ 是热扩散系数，$T_\\alpha$ 是温度。在保持宏观平衡和几何位形近似固定的扫描实验中，于中间半径（$r/a \\approx 0.5$）处观测到以下稳健的实验趋势：\n\n- 在从 $\\beta \\approx 0.5\\%$到 $\\beta \\approx 2\\%$ 的低 $\\beta$ 范围内，电子热扩散系数 $\\chi_e$ 随归一化等离子体压强 $\\beta \\equiv 2 \\mu_0 p / B^2$ 显著增加，在此范围内近似呈线性正比关系 $\\chi_e \\propto \\beta$。离子热扩散系数 $\\chi_i$ 随 $\\beta$ 的变化很弱。\n- 在 $\\nu_* \\approx 0.02$ 到 $\\nu_* \\approx 0.3$ 的范围内，电子热扩散系数 $\\chi_e$ 随有效电子碰撞率 $\\nu_* \\equiv \\nu_{ei} q R / (\\epsilon^{3/2} v_{te})$ （其中反环径比 $\\epsilon \\equiv a/R$，电子热速度为 $v_{te}$）单调增加。在此碰撞率范围内，离子热扩散系数 $\\chi_i$ 大致保持不变。\n- 改变归一化电子温度梯度 $R/L_{T_e}$ 会产生一个明显的阈值，一旦 $R/L_{T_e}$ 超过临界值，$\\chi_e$ 会被强烈放大；而在固定的 $R/L_{T_e}$ 下改变离子温度梯度 $R/L_{T_i}$ 对 $\\chi_e$ 造成的变化可以忽略不计。\n- 当 $R/L_{T_e}$ 保持恒定时，改变归一化密度梯度 $R/L_n$ 对 $\\chi_e$ 的影响很小，而 $\\chi_e$ 对 $R/L_{T_e}$ 本身高度敏感。\n- 增加电场叉磁场（E×B）剪切率 $\\gamma_E$，一旦 $\\gamma_E$ 接近根据涨落退相干估计推断出的线性增长率，$\\chi_e$ 会被显著抑制。对 $\\chi_i$ 的抑制作用较小，因为在这些条件下 $\\chi_i \\ll \\chi_e$。\n- 磁涨落测量显示，在 $\\chi_e$ 达到峰值的同一径向区域，存在有限的垂直磁扰动，其大小为 $\\delta B_\\perp / B \\sim 10^{-4}$，而静电涨落水平与之相当或更小。热输运主要在电子通道中进行，即 $Q_e \\gg Q_i$。\n\n假设存在由平衡梯度提供的标准漂移波自由能来源，并且电磁效应通过平行矢量势涨落与 $\\beta$ 成比例。利用关于微观不稳定性的特征及其对 $\\beta$、碰撞率、驱动梯度、输运通道和剪切抑制的预期依赖关系的第一性原理推断，哪种微观不稳定性与上述趋势最为一致？\n\nA. 离子温度梯度（ITG）模\n\nB. 捕获电子模（TEM）\n\nC. 电子温度梯度（ETG）模\n\nD. 微撕裂模（MTM）\n\nE. 动理学气球模（KBM）",
            "solution": "用户要求根据托卡马克中的一组详细实验观测来确定一种等离子体微观不稳定性。该过程包括验证问题陈述的有效性，然后根据几种候选不稳定性的已知特性，对给定的趋势进行系统性分析。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- **装置参数：** 大半径 $R = 1.7\\,\\mathrm{m}$，小半径 $a = 0.5\\,\\mathrm{m}$，环向磁场 $B = 2.5\\,\\mathrm{T}$，安全因子 $q \\approx 2$。这意味着反环径比 $\\epsilon = a/R \\approx 0.294$。\n- **等离子体条件：** 稳态高约束模，中间半径（$r/a \\approx 0.5$），局域电荷平衡和准电中性。\n- **输运模型：** 热通量由 $Q_\\alpha \\approx - n_\\alpha \\chi_\\alpha \\nabla T_\\alpha$ 描述，适用于电子（$\\alpha=e$）和离子（$\\alpha=i$）。\n- **实验趋势1（$\\beta$ 依赖性）：** 电子热扩散系数 $\\chi_e$ 随归一化等离子体压强 $\\beta \\equiv 2 \\mu_0 p / B^2$ 显著增加，近似为 $\\chi_e \\propto \\beta$（在 $\\beta \\in [0.5\\%, 2\\%]$ 范围内）。离子热扩散系数 $\\chi_i$ 变化很小。\n- **实验趋势2（碰撞率依赖性）：** 在 $\\nu_* \\in [0.02, 0.3]$ 范围内，$\\chi_e$ 随有效电子碰撞率 $\\nu_* \\equiv \\nu_{ei} q R / (\\epsilon^{3/2} v_{te})$ 单调增加。$\\chi_i$ 大致保持不变。\n- **实验趋势3（温度梯度依赖性）：** $\\chi_e$ 在归一化电子温度梯度 $R/L_{T_e}$ 上表现出临界梯度阈值，并在超过该阈值后被强烈放大。改变离子温度梯度 $R/L_{T_i}$ 对 $\\chi_e$ 的影响可以忽略不计。\n- **实验趋势4（密度梯度依赖性）：** 与对 $R/L_{T_e}$ 的强敏感性相比，改变归一化密度梯度 $R/L_n$ 对 $\\chi_e$ 的影响很小。\n- **实验趋势5（剪切流抑制）：** 增加 $\\mathbf{E} \\times \\mathbf{B}$ 剪切率 $\\gamma_E$ 会强烈抑制 $\\chi_e$。\n- **实验趋势6（涨落特征）：** 湍流的特征是存在有限的垂直磁扰动（$\\delta B_\\perp / B \\sim 10^{-4}$），而静电涨落的幅度与之相当或更小。热输运主要在电子通道中（$Q_e \\gg Q_i$）。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述在科学上是合理的，并且对于一个基于物理的推断任务来说是适定的。\n- **科学依据：** 背景是托卡马克中的反常输运，这是聚变研究的核心课题。所有参数（$R, a, B, q, \\beta, \\nu_*$）对于中型装置都在实际范围内。定义是标准的。所描述的趋势，虽然是为提供区分度而精心挑选的，但在现象学上是真实的，并与已发表的实验结果一致。候选不稳定性是该领域研究的主要不稳定性。\n- **问题适定性：** 问题提供了一套全面的约束条件，并要求找出与这些条件*最为一致*的不稳定性。这是一种标准的科学推理方法。\n- **客观性：** 语言技术性强、精确，且没有主观性。\n\n问题没有违反任何指定的无效标准。参数是一致的，物理基础是确立的，问题清晰，可以通过物理推理来解决。\n\n### 步骤3：结论与行动\n问题有效。解决方案是系统地将每个候选不稳定性的属性与给定的实验证据进行比较。\n\n### 推导与选项评估\n\n目标是找到与观测到的电子热扩散系数 $\\chi_e$ 的所有六个实验趋势最匹配的微观不稳定性。\n\n**A. 离子温度梯度（ITG）模**\n- **驱动：** ITG模由陡峭的离子温度梯度 $R/L_{T_i}$ 驱动。观测到 $\\chi_e$ 对 $R/L_{T_i}$ 不敏感（趋势3），这与之一是直接矛盾的。\n- **输运通道：** ITG湍流主要驱动离子热输运（$Q_i$），而电子热输运是次要的。这与趋势6（$Q_e \\gg Q_i$）相矛盾。\n- **$\\beta$ 依赖性：** 纯ITG是静电模。在有限 $\\beta$ 值下，它会与剪切阿尔芬波耦合，但通常会随着 $\\beta$ 的增加而稳定（即“$\\beta$稳定”效应），这与趋势1（$\\chi_e \\propto \\beta$）相矛盾。\n- **碰撞率：** 增加离子-离子或电子-离子碰撞通常会削弱（阻尼）ITG模。这与趋势2（$\\chi_e$ 随 $\\nu_*$ 增加）相矛盾。\n- **结论：** ITG与至少四个关键趋势不一致。\n**结论：不正确**\n\n**B. 捕获电子模（TEM）**\n- **驱动：** TEM由电子密度梯度（$R/L_n$）和/或电子温度梯度（$R/L_{T_e}$）驱动。观测到 $\\chi_e$ 对 $R/L_n$ 的依赖性很弱（趋势4），这是反对常见的密度梯度驱动TEM的有力证据。虽然存在温度梯度驱动的TEM，但它通常也伴随着一定的密度梯度敏感性。\n- **碰撞率：** 最强的TEM是无碰撞的（$\\nu_* \\ll 1$）。它们会被电子碰撞所稳定，因为碰撞会使电子去捕获，从而破坏驱动机制。$\\chi_e$ 随 $\\nu_*$ 增加与无碰撞TEM的预期行为相反。虽然存在由碰撞驱动的*耗散*TEM（DTEM），但其输运贡献通常是次要的，并且无法解释其他趋势，特别是强的 $\\beta$ 标度关系。这与趋势2相矛盾。\n- **$\\beta$ 依赖性与涨落类型：** TEM主要是静电性的。虽然在有限 $\\beta$ 时它们有电磁分量，但这通常不会导致 $\\chi_e \\propto \\beta$ 的强线性标度关系，也不会导致磁涨落成为湍流的主要部分。这与趋势1和6相矛盾。\n- **结论：** TEM与观测到的碰撞率依赖性、密度梯度不敏感性以及电磁特性不一致。\n**结论：不正确**\n\n**C. 电子温度梯度（ETG）模**\n- **驱动：** ETG模由电子温度梯度 $R/L_{T_e}$ 驱动，对 $R/L_{T_i}$ 不敏感。这与趋势3一致。它们对 $R/L_n$ 的依赖性也较弱，与趋势4匹配。\n- **输运通道：** ETG湍流驱动电子热输运，与 $Q_e \\gg Q_i$（趋势6）一致。\n- **碰撞率：** 与TEM类似，ETG模因电子捕获而不稳定，并因抑制动理学共振的碰撞而稳定。输运随 $\\nu_*$ 增加与标准ETG模型直接矛盾。这与趋势2相矛盾。\n- **$\\beta$ 依赖性与涨落类型：** ETG模基本上是高波数（$k_\\perp \\rho_e \\sim 1$）、短波长的不稳定性，被认为是压倒性的静电模。输运源于静电的 $\\mathbf{E} \\times \\mathbf{B}$ 漂移。它们不会产生显著的磁颤振输运，并且预计不会表现出输运随 $\\beta$ 的强线性增长。这与趋势1和6相矛盾。\n- **结论：** ETG与观测到的碰撞率和 $\\beta$ 依赖性不一致。\n**结论：不正确**\n\n**D. 微撕裂模（MTM）**\n- **$\\beta$ 依赖性与涨落类型：** MTM是内在的电磁不稳定性，源于平行电子电流扰动与平行矢量势（$A_\\parallel$）的耦合。它们撕裂并重联磁力线，形成小磁岛。其增长率和由此产生的通过随机磁力线发生的热输运，都与 $\\beta$ 有很强的标度关系。近似线性的依赖关系 $\\chi_e \\propto \\beta$ 是一个经典特征。磁涨落（$\\delta B_\\perp$）占主导地位是其定义性特征。这完美地匹配了趋势1和6。\n- **碰撞率：** MTM是电阻性不稳定性。其机制依赖于电子惯性和电阻率（与电子-离子碰撞频率 $\\nu_{ei}$ 成正比）来打破磁冻结定律并允许磁力线重联。因此，在指定的低碰撞率区域（$\\nu_* \\ll 1$），它们的增长率和所引起的输运预计会随碰撞率的增加而增加。这完美地匹配了趋势2，并且是MTM的一个关键区分特征。\n- **驱动：** MTM的自由能由电子温度梯度 $\\nabla T_e$ 提供。因此，它们由 $R/L_{T_e}$ 驱动，并有一个临界梯度阈值。它们对 $\\nabla T_i$ 的依赖性极小。这完美地匹配了趋势3。\n- **密度梯度依赖性：** MTM对密度梯度的依赖性很弱，这与趋势4一致。\n- **剪切抑制：** 作为一种离子尺度模（$k_\\perp \\rho_i \\sim 1$），MTM的增长率可以与 $\\gamma_E$ 相媲美，并且已知它们会被 $\\mathbf{E} \\times \\mathbf{B}$ 剪切所抑制。这与趋势5匹配。\n- **结论：** MTM与提供的每一条实验趋势都一致。\n**结论：正确**\n\n**E. 动理学气球模（KBM）**\n- **驱动：** KBM是理想MHD气球模的动理学延伸，由总压强梯度 $\\nabla p = \\nabla p_e + \\nabla p_i$ 驱动。因此，它们对 $R/L_{T_e}$ 和 $R/L_{T_i}$（以及 $R/L_n$）都很敏感。观测到 $\\chi_e$ 对 $R/L_{T_i}$ 的变化不敏感，这是一个强烈的矛盾。这与趋势3相矛盾。\n- **输运通道：** 作为由总压强梯度驱动的离子尺度模，KBM预计会同时在离子和电子通道中驱动输运。观测到 $\\chi_i$ 很小且 $Q_e \\gg Q_i$ 与KBM是主导不稳定性不一致。这与趋势6及其中对 $\\chi_i$ 的描述不一致。\n- **碰撞率：** KBM通常在无碰撞极限下最不稳定，并会被电阻率（碰撞率）所稳定。输运随 $\\nu_*$ 增加是与预期行为相反的。这与趋势2相矛盾。\n- **$\\beta$ 依赖性：** KBM是电磁性的，在 $\\beta$ 上有一个阈值，超过阈值后输运随 $\\beta$ 增加。这方面与趋势1一致，但这单一点的一致性是不够的。\n- **结论：** KBM与观测到的驱动源、输运通道特性和碰撞率依赖性不一致。\n**结论：不正确**\n\n**总结**\n微撕裂模（MTM）是唯一能成功解释所有观测结果的候选者：其电磁性质和驱动机制解释了强的 $\\beta$ 标度关系和主导的磁涨落；其电阻性质解释了随碰撞率的增加；其自由能来源解释了对 $\\nabla T_e$ 的依赖性以及对 $\\nabla T_i$ 和 $\\nabla n$ 的不敏感性；其尺度使其易受 $\\mathbf{E} \\times \\mathbf{B}$ 剪切的影响。所有其他模式都在多个关键点上不符。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "在识别了湍流类型之后，理解其统计特性对于建立预测模型至关重要。这个练习深入探讨了湍流输运的非高斯特性，这种特性通常源于间歇性的、爆发式的输运事件，如雪崩或斑状结构。通过为一个描述这种行为的简化统计模型推导峰度（kurtosis），你将亲身体验用于量化湍流间歇性的关键分析工具，从而更深刻地理解湍流涨落的复杂本质 。",
            "id": "3691191",
            "problem": "在磁约束聚变等离子体（托卡马克）中，由湍流引起的瞬时径向热通量 $q_r(t)$ 在主导阶上可以表示为 $q_r(t) = - n_e k_B \\chi_t(t) \\partial_r T$，其中 $n_e$ 是电子密度，$k_B$ 是玻尔兹曼常数，$\\partial_r T$ 是径向温度梯度（在涨落的时间尺度上假定为静态），而 $\\chi_t(t)$ 是由电场叉乘磁场（$E \\times B$）漂移引起的平流和相关的热力学涨落产生的湍流热扩散系数。考虑一个由瞬时通量构成的无量纲涨落变量 $X$，它分离出湍流的统计特性，使得 $X$ 是两个统计上独立的贡献之和：\n- 一个背景贡献 $G$，代表许多弱相关涡流的聚合效应，建模为一个均值为零、方差为 $\\sigma^{2}$ 的高斯随机变量。\n- 一个间歇性贡献 $S$，代表产生单侧爆发性输运的相干结构（斑块/雪崩）的零星出现。随机变量 $S$ 以 $1-p$ 的概率等于 $0$，并以概率 $p$ 等于一个从均值为 $\\mu$ 的指数分布中抽取的正振幅 $A$，即其概率密度函数为 $f_A(a) = \\frac{1}{\\mu} \\exp\\!\\left(-\\frac{a}{\\mu}\\right)$（对于 $a \\ge 0$）。\n\n因此 $X = G + S$，其中 $G$、$S$ 和 $A$ 相互独立。从随机变量的矩和累积量的定义出发，仅使用独立和的累积量可加性，推导 $X$ 的峰度 $\\mathcal{K}$ 的闭式表达式，其定义为\n$$\n\\mathcal{K} \\equiv \\frac{\\langle (X - \\langle X \\rangle)^{4} \\rangle}{\\langle (X - \\langle X \\rangle)^{2} \\rangle^{2}} \\, .\n$$\n然后，对于 $p = 0.1$，$\\mu = 1$ 和 $\\sigma^{2} = 1$ 计算该表达式的值。将您的最终数值答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   瞬时径向热通量：$q_r(t) = - n_e k_B \\chi_t(t) \\partial_r T$。\n-   假定的静态项：$n_e$（电子密度），$k_B$（玻尔兹曼常数），$\\partial_r T$（径向温度梯度）。\n-   涨落项：$\\chi_t(t)$（湍流热扩散系数）。\n-   无量纲涨落变量：$X = G + S$。\n-   $G$ 是一个均值为 $\\langle G \\rangle = 0$、方差为 $\\text{Var}(G) = \\sigma^2$ 的高斯随机变量。\n-   $S$ 是一个间歇性随机变量，定义为：\n    -   $S = 0$，概率为 $1-p$。\n    -   $S = A$，概率为 $p$。\n-   $A$ 是一个服从均值为 $\\mu$ 的指数分布的随机变量。\n-   $A$ 的概率密度函数 (PDF) 为 $f_A(a) = \\frac{1}{\\mu} \\exp\\!\\left(-\\frac{a}{\\mu}\\right)$（对于 $a \\ge 0$）。\n-   $G$、$S$ 和 $A$ 是相互独立的随机变量。\n-   峰度的定义为 $\\mathcal{K} \\equiv \\frac{\\langle (X - \\langle X \\rangle)^{4} \\rangle}{\\langle (X - \\langle X \\rangle)^{2} \\rangle^{2}}$。\n-   要求的任务是推导 $\\mathcal{K}$ 的闭式表达式，然后用具体参数值 $p = 0.1$，$\\mu = 1$ 和 $\\sigma^2 = 1$ 进行计算。最终数值答案必须四舍五入到四位有效数字。\n-   推导必须使用独立和的累积量可加性。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在磁约束聚变等离子体中反常输运的现象学方面有充分的依据。将一个涨落量表示为一个连续高斯背景和一个零星的、单侧的间歇性分量之和，是描述表现出爆发性事件（例如雪崩或斑块）的湍流的标准且具有物理动机的模型。\n-   **适定性**：该问题在数学上是适定的。随机变量 $G$ 和 $S$ 的统计特性已完全指定，从而可以计算它们的和 $X$ 的矩和累积量。问题精确，并有唯一、稳定的解。\n-   **客观性**：问题以客观、正式的语言陈述。\n-   **未发现缺陷**：该问题不违反任何基本原理，不不完整或矛盾，其模型是一个有效的简化，并且是统计分析中一个非平凡但可解的问题。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**。将提供完整解答。\n\n### 解答推导\n峰度 $\\mathcal{K}$ 是根据中心矩 $\\mu_n = \\langle (X - \\langle X \\rangle)^n \\rangle$ 定义的，即 $\\mathcal{K}(X) = \\mu_4(X) / (\\mu_2(X))^2$。问题要求使用累积量 $\\kappa_n$。前四阶中心矩和累积量之间的关系是：\n$\\mu_1 = \\langle X \\rangle = \\kappa_1$\n$\\mu_2 = \\text{Var}(X) = \\kappa_2$\n$\\mu_3 = \\kappa_3$\n$\\mu_4 = \\kappa_4 + 3\\kappa_2^2$\n\n使用这些关系，峰度可以用累积量表示为：\n$$\n\\mathcal{K}(X) = \\frac{\\kappa_4(X) + 3(\\kappa_2(X))^2}{(\\kappa_2(X))^2} = 3 + \\frac{\\kappa_4(X)}{(\\kappa_2(X))^2}\n$$\n问题陈述 $X = G + S$，其中 $G$ 和 $S$ 是独立的随机变量。累积量的一个基本性质是它们对于独立随机变量之和的可加性：\n$$\n\\kappa_n(X) = \\kappa_n(G) + \\kappa_n(S)\n$$\n我们现在将分别计算 $G$ 和 $S$ 所需的累积量。\n\n**G 的累积量：**\n变量 $G$ 是一个均值为 $0$、方差为 $\\sigma^2$ 的高斯随机变量。高斯分布的累积量特别简单：\n-   $\\kappa_1(G) = \\langle G \\rangle = 0$\n-   $\\kappa_2(G) = \\text{Var}(G) = \\sigma^2$\n-   对于所有 $n  2$，$\\kappa_n(G) = 0$。\n因此，$\\kappa_3(G) = 0$ 且 $\\kappa_4(G) = 0$。\n\n**S 的累积量：**\n变量 $S$ 是一个混合随机变量。为了求其累积量，我们首先计算其原点矩，$\\mu_n'(S) = \\langle S^n \\rangle$。根据 $S$ 的定义：\n$$\n\\mu_n'(S) = \\langle S^n \\rangle = (1-p) \\cdot (0)^n + p \\cdot \\langle A^n \\rangle\n$$\n对于 $n \\ge 1$，这简化为 $\\mu_n'(S) = p \\langle A^n \\rangle$。我们需要具有概率密度函数 $f_A(a) = \\frac{1}{\\mu} \\exp(-a/\\mu)$ 的指数分布的原点矩。\n$$\n\\langle A^n \\rangle = \\int_0^\\infty a^n f_A(a) \\, da = \\frac{1}{\\mu} \\int_0^\\infty a^n \\exp(-a/\\mu) \\, da\n$$\n使用换元 $u = a/\\mu$，得到 $a=u\\mu$ 和 $da = \\mu du$：\n$$\n\\langle A^n \\rangle = \\frac{1}{\\mu} \\int_0^\\infty (u\\mu)^n \\exp(-u) (\\mu du) = \\mu^n \\int_0^\\infty u^n \\exp(-u) \\, du\n$$\n该积分是伽马函数 $\\Gamma(n+1)$，对于整数 $n$，其值等于 $n!$。\n$$\n\\langle A^n \\rangle = n! \\mu^n\n$$\n因此 $S$ 的前四阶原点矩是：\n-   $\\mu_1'(S) = p \\langle A \\rangle = p (1! \\mu^1) = p\\mu$\n-   $\\mu_2'(S) = p \\langle A^2 \\rangle = p (2! \\mu^2) = 2p\\mu^2$\n-   $\\mu_3'(S) = p \\langle A^3 \\rangle = p (3! \\mu^3) = 6p\\mu^3$\n-   $\\mu_4'(S) = p \\langle A^4 \\rangle = p (4! \\mu^4) = 24p\\mu^4$\n\n现在，我们将 $S$ 的这些原点矩转换成 $S$ 的累积量：\n-   $\\kappa_1(S) = \\mu_1'(S) = p\\mu$\n-   $\\kappa_2(S) = \\mu_2'(S) - (\\mu_1'(S))^2 = 2p\\mu^2 - (p\\mu)^2 = p\\mu^2 (2-p)$\n-   $\\kappa_3(S) = \\mu_3'(S) - 3\\mu_2'(S)\\mu_1'(S) + 2(\\mu_1'(S))^3 = 6p\\mu^3 - 3(2p\\mu^2)(p\\mu) + 2(p\\mu)^3 = p\\mu^3(6 - 6p + 2p^2)$\n-   $\\kappa_4(S) = \\mu_4'(S) - 4\\mu_3'(S)\\mu_1'(S) - 3(\\mu_2'(S))^2 + 12\\mu_2'(S)(\\mu_1'(S))^2 - 6(\\mu_1'(S))^4$\n$$\n\\kappa_4(S) = 24p\\mu^4 - 4(6p\\mu^3)(p\\mu) - 3(2p\\mu^2)^2 + 12(2p\\mu^2)(p\\mu)^2 - 6(p\\mu)^4\n$$\n$$\n\\kappa_4(S) = \\mu^4 [24p - 24p^2 - 3(4p^2) + 12(2p^3) - 6p^4]\n$$\n$$\n\\kappa_4(S) = \\mu^4 [24p - 24p^2 - 12p^2 + 24p^3 - 6p^4]\n$$\n$$\n\\kappa_4(S) = p\\mu^4 (24 - 36p + 24p^2 - 6p^3)\n$$\n\n**X 的累积量和峰度：**\n利用可加性，$X=G+S$ 的二阶和四阶累积量为：\n-   $\\kappa_2(X) = \\kappa_2(G) + \\kappa_2(S) = \\sigma^2 + p\\mu^2(2-p)$\n-   $\\kappa_4(X) = \\kappa_4(G) + \\kappa_4(S) = 0 + p\\mu^4(24 - 36p + 24p^2 - 6p^3) = p\\mu^4(24 - 36p + 24p^2 - 6p^3)$\n\n将这些代入峰度表达式，得到通用的闭式表达式：\n$$\n\\mathcal{K}(X) = 3 + \\frac{\\kappa_4(X)}{(\\kappa_2(X))^2} = 3 + \\frac{p\\mu^4(24 - 36p + 24p^2 - 6p^3)}{[\\sigma^2 + p\\mu^2(2-p)]^2}\n$$\n\n**数值计算：**\n我们给定的参数是 $p = 0.1$，$\\mu=1$ 和 $\\sigma^2=1$。\n首先，我们计算 $\\kappa_2(X)$ 和 $\\kappa_4(X)$：\n$$\n\\kappa_2(X) = 1 + (0.1)(1)^2(2-0.1) = 1 + 0.1(1.9) = 1 + 0.19 = 1.19\n$$\n$$\n\\kappa_4(X) = (0.1)(1)^4(24 - 36(0.1) + 24(0.1)^2 - 6(0.1)^3)\n$$\n$$\n\\kappa_4(X) = 0.1(24 - 3.6 + 24(0.01) - 6(0.001))\n$$\n$$\n\\kappa_4(X) = 0.1(24 - 3.6 + 0.24 - 0.006) = 0.1(20.4 + 0.234) = 0.1(20.634) = 2.0634\n$$\n现在我们计算峰度：\n$$\n\\mathcal{K} = 3 + \\frac{\\kappa_4(X)}{(\\kappa_2(X))^2} = 3 + \\frac{2.0634}{(1.19)^2} = 3 + \\frac{2.0634}{1.4161}\n$$\n$$\n\\mathcal{K} \\approx 3 + 1.45709907... = 4.45709907...\n$$\n将最终结果四舍五入到四位有效数字，得到 $4.457$。",
            "answer": "$$\\boxed{4.457}$$"
        },
        {
            "introduction": "大规模数值模拟是研究等离子体湍流不可或缺的工具，但其结果的可靠性取决于代码是否经过严格的验证。本练习提供了一个计算物理学的基础实践，引导你使用“人造解方法”（method of manufactured solutions）来验证一个简化的输运方程求解器。通过这个过程，你将获得评估数值耗散、检验能量守恒和分析收敛阶数的实践经验，这些都是任何使用或开发模拟代码的研究人员所必须掌握的基本技能 。",
            "id": "3691188",
            "problem": "您的任务是验证能量平衡闭合、估算数值耗散，并评估一个简化的二维静电湍流代理模型的空间收敛性。该模型模拟了与核聚变中反常输运和湍流现象相关的关键回旋动理学守恒特性。请在方形域上采用无量纲归一化单位和周期性边界条件进行工作。其物理基础是针对一个作为静电势相关量代理的被动标量所建立的平流-扩散守恒律，该守恒律的构造旨在共享回旋动理学系统的二次自由能守恒结构。所有推导和计算必须从该代理模型的基本守恒和输运定义出发。\n\n基本基础：\n- 考虑一个标量场 $\\,\\psi(x,y,t)\\,$，定义在周期性域 $\\,x\\in[0,L_x],\\,y\\in[0,L_y]\\,$ 上，该标量场被一个无散速度场 $\\,\\mathbf{v}(x,y)=\\left(v_x(x,y),v_y(x,y)\\right)\\,$ 平流，并受到系数为 $\\,\\nu\\,$ 的碰撞扩散和外部强迫 $\\,f(x,y,t)\\,$ 的影响。其控制方程为\n$$\n\\partial_t \\psi + \\mathbf{v}\\cdot\\nabla\\psi \\;=\\; \\nu\\,\\nabla^2 \\psi + f.\n$$\n- 定义二次自由能\n$$\nE(t) \\;=\\; \\frac{1}{2}\\int_{0}^{L_x}\\!\\!\\int_{0}^{L_y} \\psi^2(x,y,t)\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n- 利用不可压缩性 $\\,\\nabla\\cdot\\mathbf{v}=0\\,$ 和周期性边界，连续介质能量平衡方程为\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} \\;=\\; \\int \\psi f\\,\\mathrm{d}x\\,\\mathrm{d}y \\;-\\; \\nu \\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y,\n$$\n其中平流项积分为零。\n\n用于验证的构造解：\n- 取 $\\,L_x=L_y=2\\pi\\,$，$\\,\\psi(x,y,t)=\\sin(k_x x)\\,\\sin(k_y y)\\,\\cos(\\omega t)\\,$，其中 $\\,k_x,k_y\\,$ 为给定整数，$\\,\\omega\\,$ 为角频率。\n- 使用由流函数 $\\,\\chi(x,y)=\\sin(x)\\cos(y)\\,$ 导出的无散速度，因此\n$$\nv_x=\\partial_y\\chi=-\\sin(x)\\sin(y),\\qquad v_y=-\\partial_x\\chi=-\\cos(x)\\cos(y).\n$$\n- 选择 $\\,\\nu\\,$ 并定义 $\\,f\\,$，使得该偏微分方程在连续介质中精确成立，即\n$$\nf(x,y,t) \\;=\\; \\partial_t\\psi + \\mathbf{v}\\cdot\\nabla\\psi - \\nu\\,\\nabla^2\\psi,\n$$\n其中 $\\,\\partial_t\\psi=-\\omega\\sin(k_x x)\\sin(k_y y)\\sin(\\omega t)\\,$，$\\,\\nabla\\psi=(\\partial_x\\psi,\\partial_y\\psi)\\,$，其中 $\\,\\partial_x\\psi=k_x\\cos(k_x x)\\sin(k_y y)\\cos(\\omega t)\\,$，$\\,\\partial_y\\psi=k_y\\sin(k_x x)\\cos(k_y y)\\cos(\\omega t)\\,$，且 $\\,\\nabla^2\\psi=-(k_x^2+k_y^2)\\psi\\,$.\n\n需实现的离散验证和诊断：\n- 使用周期性梯形法则，在 $\\,N_x\\times N_y\\,$ 个点的均匀网格上近似空间积分，其中 $\\,\\Delta x=L_x/N_x\\,$ 且 $\\,\\Delta y=L_y/N_y\\,$.\n- 对于 $\\,\\lvert\\nabla\\psi\\rvert^2\\,$ 和碰撞耗散项中的拉普拉斯算子，使用带周期性边界条件的二阶中心差分来近似空间导数。仅使用解析表达式来构造 $\\,f\\,$.\n- 使用向前差分 $\\,\\left(E(t+\\Delta t)-E(t)\\right)/\\Delta t\\,$ 来近似能量的时间导数。\n- 定义离散能量平衡残差（数值耗散诊断量）\n$$\n\\mathcal{N} \\;=\\; \\frac{E(t+\\Delta t)-E(t)}{\\Delta t} \\;-\\; \\left(\\int \\psi f\\,\\mathrm{d}x\\,\\mathrm{d}y \\;-\\; \\nu \\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right),\n$$\n以及有效数值耗散系数\n$$\n\\nu_{\\mathrm{num}} \\;=\\; \\frac{\\mathcal{N}}{\\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y}.\n$$\n- 为进行空间收敛性评估，通过测量误差来评估离散闭合的阶数 $\\,p\\,$\n$$\n\\varepsilon(N_x) \\;=\\; \\left|\\,\\left(\\int \\psi f\\,\\mathrm{d}x\\,\\mathrm{d}y \\;-\\; \\nu \\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right) \\;-\\; \\int \\psi\\,\\partial_t\\psi\\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\right|,\n$$\n然后估算\n$$\np \\;\\approx\\; \\frac{\\log\\left(\\varepsilon(N_1)/\\varepsilon(N_2)\\right)}{\\log\\left((L_x/N_1)/(L_x/N_2)\\right)}\n$$\n该估算是基于从 $\\,N_1\\to N_2\\,$ 的连续网格加密得到的，最后对由三级加密得到的两个估算值进行平均。\n\n您的程序必须计算以下测试套件，并生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果：\n\n测试套件参数：\n1. 理想路径下的数值耗散系数：$\\,N_x=N_y=32\\,$, $\\,k_x=2\\,$, $\\,k_y=3\\,$, $\\,\\omega=0.7\\,$, $\\,\\nu=0.05\\,$, $\\,\\Delta t=10^{-3}\\,$, $\\,t_0=0.314\\,$. 输出浮点数 $\\,\\nu_{\\mathrm{num}}\\,$.\n2. 静态边界情况：$\\,N_x=N_y=32\\,$, $\\,k_x=1\\,$, $\\,k_y=1\\,$, $\\,\\omega=0\\,$, $\\,\\nu=0\\,$, $\\,\\Delta t=10^{-3}\\,$, $\\,t_0=0.0\\,$，并设置 $\\,\\mathbf{v}=\\mathbf{0}\\,$. 输出布尔值，指示 $\\,\\lvert\\mathcal{N}\\rvert  10^{-12}\\,$ 是否成立。\n3. 空间收敛阶：使用 $\\,N_x=N_y\\in\\{16,32,64\\}\\,$，参数为 $\\,k_x=2\\,$, $\\,k_y=3\\,$, $\\,\\omega=0.7\\,$, $\\,\\nu=0.05\\,$, $\\,\\Delta t=10^{-4}\\,$, $\\,t_0=0.314\\,$. 为每个网格计算 $\\,\\varepsilon(N_x)\\,$，并返回平均阶数 $\\,p\\,$ 作为浮点数。\n4. 高碰撞性边缘情况：$\\,N_x=N_y=32\\,$, $\\,k_x=2\\,$, $\\,k_y=3\\,$, $\\,\\omega=0.7\\,$, $\\,\\nu=0.5\\,$, $\\,\\Delta t=10^{-3}\\,$, $\\,t_0=0.314\\,$. 输出浮点数比率 $\\,\\mathcal{N}/\\left(\\nu\\int\\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right)\\,$.\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$）。所有量都是无量纲的，因此无需进行物理单位转换。",
            "solution": "该问题是有效的。它构成了一个关于偏微分方程数值方法验证的适定的、有科学依据的练习，这是计算科学中的标准实践，并与聚变研究中的湍流建模具体相关。所有必需的数据、定义和约束都已提供，不存在内部矛盾或违反物理原理之处。\n\n任务是实现并分析一个二维平流-扩散方程的数值格式，使用一个构造解来验证代码的正确性。这涉及离散化域和算子，计算能量平衡方程的各项，并评估用于衡量数值误差和收敛性的诊断量。\n\n标量场 $\\psi(x,y,t)$ 在周期性域 $[0, L_x] \\times [0, L_y]$ 上的控制方程是：\n$$\n\\partial_t \\psi + \\mathbf{v}\\cdot\\nabla\\psi = \\nu\\,\\nabla^2 \\psi + f\n$$\n这里，$\\mathbf{v}$ 是一个无散速度场，$\\nu$ 是扩散系数，而 $f$ 是一个源项。相关的二次自由能定义为：\n$$\nE(t) = \\frac{1}{2}\\int_{0}^{L_x}\\!\\!\\int_{0}^{L_y} \\psi^2(x,y,t)\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n对 $E(t)$ 求时间导数，并从控制方程中代入 $\\partial_t \\psi$，可得到连续介质能量平衡方程：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int \\psi f\\,\\mathrm{d}A - \\nu \\int |\\nabla\\psi|^2\\,\\mathrm{d}A\n$$\n其中 $\\mathrm{d}A = \\mathrm{d}x\\,\\mathrm{d}y$。由于 $\\mathbf{v}$ 的不可压缩性和周期性边界条件，平流项 $\\int \\psi (\\mathbf{v}\\cdot\\nabla\\psi)\\,\\mathrm{d}A$ 的积分为零。\n\n为验证数值实现，我们离散化这些方程，并用一个已知的构造解来对其求值。域被离散化为一个 $N_x \\times N_y$ 个点的均匀网格 $(x_i, y_j)$，其中 $x_i = i\\Delta x$（对于 $i \\in \\{0, \\dots, N_x-1\\}$）和 $y_j = j\\Delta y$（对于 $j \\in \\{0, \\dots, N_y-1\\}$）。网格间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。\n\n算子的数值近似定义如下：\n\n1.  **积分**：面积分使用周期性梯形法则进行近似，对于网格函数 $g_{i,j}$，这简化为对所有网格点的求和再乘以单元面积：\n    $$\n    \\int g(x,y)\\,\\mathrm{d}A \\approx \\Delta x \\Delta y \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} g_{i,j}\n    $$\n2.  **微分**：空间导数使用带周期性边界条件的二阶中心差分进行近似。对于网格函数 $\\psi_{i,j}$：\n    $$\n    (\\partial_x \\psi)_{i,j} \\approx \\frac{\\psi_{i+1, j} - \\psi_{i-1, j}}{2\\Delta x}, \\quad (\\partial_y \\psi)_{i,j} \\approx \\frac{\\psi_{i, j+1} - \\psi_{i, j-1}}{2\\Delta y}\n    $$\n    索引按周期性处理，例如 $\\psi_{N_x, j} = \\psi_{0, j}$ 和 $\\psi_{-1, j} = \\psi_{N_x-1, j}$。\n\n离散能量平衡方程是通过将连续方程中的每一项替换为其数值近似来构建的。能量的时间导数用向前差分近似：\n$$\n\\left(\\frac{\\mathrm{d}E}{\\mathrm{d}t}\\right)_h \\approx \\frac{E_h(t+\\Delta t) - E_h(t)}{\\Delta t}\n$$\n其中下标 $h$ 表示离散量。离散能量为 $E_h(t) = \\frac{1}{2}\\Delta x \\Delta y \\sum_{i,j} \\psi_{i,j}^2(t)$。能量平衡方程右侧的各项在时间 $t$ 计算。来自强迫的功率输入为：\n$$\nP_{f,h}(t) = \\Delta x \\Delta y \\sum_{i,j} \\psi_{i,j}(t) f_{i,j}(t)\n$$\n碰撞耗散项需要离散梯度：\n$$\nD_{\\nu,h}(t) = \\nu \\Delta x \\Delta y \\sum_{i,j} \\left[ \\left(\\frac{\\psi_{i+1, j} - \\psi_{i-1, j}}{2\\Delta x}\\right)^2 + \\left(\\frac{\\psi_{i, j+1} - \\psi_{i, j-1}}{2\\Delta y}\\right)^2 \\right]\n$$\n源项 $f$ 根据指定，使用从构造解导出的精确解析表达式进行求值。\n\n需要计算的诊断量是：\n\n-   **能量平衡残差 ($\\mathcal{N}$)**：这衡量数值格式未能精确守恒能量的程度。它在数值上等效于数值耗散。\n    $$\n    \\mathcal{N} = \\frac{E_h(t+\\Delta t) - E_h(t)}{\\Delta t} - \\left( P_{f,h}(t) - D_{\\nu,h}(t) \\right)\n    $$\n-   **有效数值耗散系数 ($\\nu_{\\mathrm{num}}$)**：这将残差通过类涡量拟能项 $\\int |\\nabla\\psi|^2\\,\\mathrm{d}A$ 进行归一化。\n    $$\n    \\nu_{\\mathrm{num}} = \\frac{\\mathcal{N}}{\\int_h |\\nabla_h\\psi(t)|^2\\,\\mathrm{d}A} = \\frac{\\mathcal{N}}{D_{\\nu,h}(t) / \\nu}\n    $$\n-   **空间收敛误差 ($\\varepsilon$)**：该误差衡量能量平衡方程中离散化的空间算子对其连续介质对应项的近似程度。它将数值计算的能量平衡右侧项 $P_{f,h} - D_{\\nu,h}$ 与能量的精确功率输入的离散积分 $\\int_h \\psi(\\partial_t\\psi)\\,\\mathrm{d}A$ 进行比较。\n    $$\n    \\varepsilon(N_x) = \\left| \\left( P_{f,h} - D_{\\nu,h} \\right) - \\left( \\Delta x \\Delta y \\sum_{i,j} \\psi_{i,j}(\\partial_t\\psi)_{i,j} \\right) \\right|\n    $$\n    此处，$(\\partial_t\\psi)_{i,j}$ 是解析给出的时间导数。\n-   **收敛阶 ($p$)**：对于一个误差为 $\\varepsilon \\propto (\\Delta x)^p$ 的格式，可以从两个不同分辨率 $N_1$ 和 $N_2$（网格间距为 $h_1 = L_x/N_1$ 和 $h_2 = L_x/N_2$）的结果中估算出阶数 $p$。\n    $$\n    p \\approx \\frac{\\log\\left(\\varepsilon(N_1)/\\varepsilon(N_2)\\right)}{\\log(h_1/h_2)} = \\frac{\\log\\left(\\varepsilon(N_1)/\\varepsilon(N_2)\\right)}{\\log(N_2/N_1)}\n    $$\n    最终结果通过对从 $16 \\to 32$ 和 $32 \\to 64$ 的加密序列计算出的阶数进行平均得到。\n\n实现将使用 `numpy` 进行高效的数组操作。使用 `numpy.linspace` 和 `numpy.meshgrid` 生成均匀网格。周期性有限差分通过 `numpy.roll` 高效实现。整体逻辑封装在一个函数中，该函数将物理和数值参数作为输入，并返回所要求的诊断量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_diagnostics(Nx, Ny, kx, ky, w, nu, t0, dt, v_is_zero=False):\n    \"\"\"\n    Computes all specified diagnostics for the given set of parameters.\n    \"\"\"\n    # 1. Grid setup\n    Lx, Ly = 2 * np.pi, 2 * np.pi\n    dx, dy = Lx / Nx, Ly / Ny\n    x = np.linspace(0, Lx, Nx, endpoint=False)\n    y = np.linspace(0, Ly, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # Helper function for numerical integration\n    def integrate(field):\n        return np.sum(field) * dx * dy\n\n    # 2. Evaluate fields and their analytic derivatives at t=t0\n    psi0 = np.sin(kx * xx) * np.sin(ky * yy) * np.cos(w * t0)\n\n    # Analytic forcing term f = ∂tψ + v⋅∇ψ - ν∇²ψ\n    dpsi_dt_analytic = -w * np.sin(kx * xx) * np.sin(ky * yy) * np.sin(w * t0)\n    dpsi_dx_analytic = kx * np.cos(kx * xx) * np.sin(ky * yy) * np.cos(w * t0)\n    dpsi_dy_analytic = ky * np.sin(kx * xx) * np.cos(ky * yy) * np.cos(w * t0)\n\n    if v_is_zero:\n        vx, vy = np.zeros_like(xx), np.zeros_like(yy)\n    else:\n        vx = -np.sin(xx) * np.sin(yy)\n        vy = -np.cos(xx) * np.cos(yy)\n        \n    advection_term = vx * dpsi_dx_analytic + vy * dpsi_dy_analytic\n    laplacian_psi_analytic_term = -nu * (-(kx**2 + ky**2) * psi0)\n\n    f0 = dpsi_dt_analytic + advection_term + laplacian_psi_analytic_term\n\n    # 3. Compute discrete RHS of energy balance at t=t0\n    # Power from forcing\n    Pf0 = integrate(psi0 * f0)\n    \n    # Dissipation from physical diffusion (using numerical derivatives)\n    dpsi_dx_numeric = (np.roll(psi0, -1, axis=0) - np.roll(psi0, 1, axis=0)) / (2 * dx)\n    dpsi_dy_numeric = (np.roll(psi0, -1, axis=1) - np.roll(psi0, 1, axis=1)) / (2 * dy)\n    \n    grad_psi_sq_numeric = dpsi_dx_numeric**2 + dpsi_dy_numeric**2\n    int_grad_psi_sq = integrate(grad_psi_sq_numeric)\n    D_nu0 = nu * int_grad_psi_sq\n    \n    RHS_balance = Pf0 - D_nu0\n    \n    # 4. Compute discrete LHS of energy balance\n    # Energy at t0 and t0+dt\n    psi_dt = np.sin(kx * xx) * np.sin(ky * yy) * np.cos(w * (t0 + dt))\n    E0 = 0.5 * integrate(psi0**2)\n    E_dt = 0.5 * integrate(psi_dt**2)\n    dE_dt_numeric = (E_dt - E0) / dt\n    \n    # 5. Compute final diagnostics\n    # Energy balance residual\n    N_residual = dE_dt_numeric - RHS_balance\n    \n    # Effective numerical dissipation coefficient\n    nu_num = N_residual / int_grad_psi_sq if int_grad_psi_sq != 0 else 0.0\n        \n    # Spatial convergence error epsilon\n    analytic_power_into_energy = integrate(psi0 * dpsi_dt_analytic)\n    epsilon = np.abs(RHS_balance - analytic_power_into_energy)\n\n    return {\n        'nu_num': nu_num,\n        'N_residual': N_residual,\n        'epsilon': epsilon,\n        'D_nu0': D_nu0,\n    }\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases_params = [\n        # Case 1: Happy-path numerical dissipation coefficient\n        {'type': 'nu_num', 'params': {'Nx': 32, 'Ny': 32, 'kx': 2, 'ky': 3, 'w': 0.7, 'nu': 0.05, 't0': 0.314, 'dt': 1e-3}},\n        # Case 2: Stationary boundary case\n        {'type': 'residual_check', 'params': {'Nx': 32, 'Ny': 32, 'kx': 1, 'ky': 1, 'w': 0, 'nu': 0, 't0': 0.0, 'dt': 1e-3, 'v_is_zero': True}},\n        # Case 3: Spatial convergence order\n        {'type': 'convergence', 'params': {'grids': [16, 32, 64], 'kx': 2, 'ky': 3, 'w': 0.7, 'nu': 0.05, 't0': 0.314, 'dt': 1e-4}},\n        # Case 4: High-collisional edge case\n        {'type': 'residual_ratio', 'params': {'Nx': 32, 'Ny': 32, 'kx': 2, 'ky': 3, 'w': 0.7, 'nu': 0.5, 't0': 0.314, 'dt': 1e-3}},\n    ]\n\n    results = []\n\n    for case in test_cases_params:\n        if case['type'] == 'nu_num':\n            diag = calculate_diagnostics(**case['params'])\n            results.append(diag['nu_num'])\n        \n        elif case['type'] == 'residual_check':\n            diag = calculate_diagnostics(**case['params'])\n            results.append(np.abs(diag['N_residual'])  1e-12)\n            \n        elif case['type'] == 'convergence':\n            grids = case['params']['grids']\n            base_params = {k: v for k, v in case['params'].items() if k != 'grids'}\n            epsilons = []\n            for N in grids:\n                p = base_params.copy()\n                p.update({'Nx': N, 'Ny': N})\n                diag = calculate_diagnostics(**p)\n                epsilons.append(diag['epsilon'])\n            \n            p12 = np.log(epsilons[0] / epsilons[1]) / np.log(grids[1] / grids[0])\n            p23 = np.log(epsilons[1] / epsilons[2]) / np.log(grids[2] / grids[1])\n            p_avg = (p12 + p23) / 2\n            results.append(p_avg)\n            \n        elif case['type'] == 'residual_ratio':\n            diag = calculate_diagnostics(**case['params'])\n            ratio = diag['N_residual'] / diag['D_nu0'] if diag['D_nu0'] != 0 else 0.0\n            results.append(ratio)\n    \n    # Format results for final output string.\n    def format_result(r):\n        if isinstance(r, (bool, np.bool_)):\n            return str(r).lower()\n        return f\"{r:.16g}\"\n\n    print(f\"[{','.join(map(format_result, results))}]\")\n\nsolve()\n```"
        }
    ]
}