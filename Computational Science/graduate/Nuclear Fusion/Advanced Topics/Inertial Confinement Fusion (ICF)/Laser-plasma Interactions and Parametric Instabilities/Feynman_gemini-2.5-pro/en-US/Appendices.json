{
    "hands_on_practices": [
        {
            "introduction": "Understanding laser-plasma instabilities begins with mastering the behavior of the constituent waves. This first practice focuses on the electron plasma wave, or Langmuir wave, which is the electrostatic backbone of instabilities like Stimulated Raman Scattering. By deriving its dispersion relation from fluid equations, you will uncover the crucial role of electron temperature in allowing these waves to propagate and transport energy, a distinction captured by the difference between their phase and group velocities .",
            "id": "3706889",
            "problem": "In the context of laser-driven parametric processes such as Stimulated Raman Scattering (SRS) in inertial confinement fusion, an incident Light Amplification by Stimulated Emission of Radiation (LASER) beam can parametrically excite an electron plasma wave (a Langmuir wave) in an underdense, collisionless plasma. Consider a one-dimensional, homogeneous, nonrelativistic electron fluid with equilibrium electron density $n_{0}$ and temperature $T_{e}$, with ions forming a fixed neutralizing background. Assume small-amplitude perturbations of the form $\\propto \\exp(i k x - i \\omega t)$, and use the warm-electron fluid model with an adiabatic electron pressure response. \n\nStarting only from the electron continuity equation, the electron momentum equation with an adiabatic pressure closure, and Poisson’s equation, carry out the linearization procedure to obtain the dispersion relation for the electron plasma (Langmuir) wave in the long-wavelength limit appropriate to $k \\lambda_{De} \\ll 1$, where the electron Debye length is $\\lambda_{De} = v_{te}/\\omega_{pe}$, the electron thermal speed is $v_{te}^{2} = k_{B} T_{e}/m_{e}$, and the electron plasma frequency is $\\omega_{pe}^{2} = n_{0} e^{2}/(\\varepsilon_{0} m_{e})$. Then:\n\n1. Using your dispersion relation, explain from first principles why the phase velocity $v_{p} = \\omega/k$ and the group velocity $v_{g} = \\partial \\omega / \\partial k$ differ for these dispersive plasma waves, and identify the physical role of finite electron temperature $T_{e}$ in this difference.\n\n2. Compute the group velocity $v_{g}$ of the Langmuir wave to leading order in the small parameter $(k \\lambda_{De})^{2}$ and express your final result symbolically in terms of $\\omega_{pe}$, $k$, and $v_{te}$. Express the answer in SI units (meters per second). Do not substitute numerical values. The final answer must be a single closed-form analytic expression.",
            "solution": "The problem statement is valid. It is scientifically grounded in the standard fluid theory of plasma waves, well-posed with sufficient information for a unique derivation, and objectively stated using standard terminology. The problem asks for the derivation of the Bohm-Gross dispersion relation for Langmuir waves and the calculation of their group velocity in a specific limit, which is a fundamental exercise in plasma physics.\n\nWe begin by stating the governing equations for a one-dimensional, nonrelativistic electron fluid: the continuity equation, the momentum equation, and Poisson's equation.\n\nThe electron continuity equation is:\n$$\n\\frac{\\partial n_e}{\\partial t} + \\frac{\\partial}{\\partial x}(n_e v_e) = 0\n$$\n\nThe electron momentum equation, including the electric field force and the pressure gradient force, is:\n$$\nm_e n_e \\left(\\frac{\\partial v_e}{\\partial t} + v_e \\frac{\\partial v_e}{\\partial x}\\right) = -e n_e E - \\frac{\\partial P_e}{\\partial x}\n$$\n\nPoisson's equation for the electric field $E$ is:\n$$\n\\frac{\\partial E}{\\partial x} = \\frac{e}{\\varepsilon_0}(n_i - n_e)\n$$\nHere, $n_e$, $v_e$, and $P_e$ are the electron number density, fluid velocity, and pressure, respectively. $m_e$ is the electron mass, $-e$ is the electron charge, and $\\varepsilon_0$ is the permittivity of free space. The ions are assumed to form a fixed, uniform neutralizing background with density $n_i = n_0$.\n\nWe linearize these equations by considering small perturbations about a stationary, uniform equilibrium. We decompose each variable into an equilibrium part (subscript $0$) and a small, first-order perturbation (subscript $1$):\n$$\nn_e(x, t) = n_0 + n_1(x, t) \\\\\nv_e(x, t) = 0 + v_1(x, t) \\\\\nE(x, t) = 0 + E_1(x, t) \\\\\nP_e(x, t) = P_0 + P_1(x, t)\n$$\nThe equilibrium fluid velocity and electric field are zero. Substituting these into the governing equations and retaining only terms linear in the perturbed quantities (first-order terms), we obtain the linearized equations.\n\nFrom the continuity equation, neglecting the second-order term $n_1 v_1$:\n$$\n\\frac{\\partial n_1}{\\partial t} + n_0 \\frac{\\partial v_1}{\\partial x} = 0 \\quad (1)\n$$\n\nFrom the momentum equation, neglecting the second-order convective term $v_1 (\\partial v_1 / \\partial x)$ and the term $n_1 (\\partial v_1 / \\partial t)$:\n$$\nm_e n_0 \\frac{\\partial v_1}{\\partial t} = -e n_0 E_1 - \\frac{\\partial P_1}{\\partial x} \\quad (2)\n$$\n\nFrom Poisson's equation, substituting $n_i = n_0$:\n$$\n\\frac{\\partial E_1}{\\partial x} = -\\frac{e}{\\varepsilon_0} n_1 \\quad (3)\n$$\n\nTo close this system of equations, we need a relationship between the pressure perturbation $P_1$ and the density perturbation $n_1$. The problem specifies an adiabatic response, governed by $P_e n_e^{-\\gamma} = \\text{constant}$, where $\\gamma$ is the adiabatic index. Linearizing this relation gives $\\delta P_e / P_0 = \\gamma (\\delta n_e / n_0)$, or $P_1/P_0 = \\gamma n_1/n_0$. With the ideal gas law for the equilibrium state, $P_0 = n_0 k_B T_e$, we have $P_1 = \\gamma n_1 k_B T_e$. For one-dimensional longitudinal compressions and rarefactions as in a Langmuir wave, kinetic theory shows that the appropriate fluid closure corresponds to an adiabatic index $\\gamma = 3$. Thus, the pressure perturbation is $P_1 = 3 n_1 k_B T_e$, and its gradient is $\\partial P_1 / \\partial x = 3 k_B T_e (\\partial n_1 / \\partial x)$.\n\nWe now assume all perturbed quantities have a sinusoidal form proportional to $\\exp(i k x - i \\omega t)$. Under this assumption, the differential operators transform to algebraic operators: $\\partial/\\partial t \\rightarrow -i\\omega$ and $\\partial/\\partial x \\rightarrow ik$. The linearized equations become:\n$$\n-i\\omega n_1 + i k n_0 v_1 = 0 \\implies \\omega n_1 = k n_0 v_1 \\quad (1')\n$$\n$$\n-i\\omega m_e v_1 = -e E_1 - i k (3 k_B T_e) \\frac{n_1}{n_0} \\quad (2')\n$$\n$$\ni k E_1 = -\\frac{e}{\\varepsilon_0} n_1 \\quad (3')\n$$\n\nWe can now solve this system to find the dispersion relation $\\omega(k)$. From $(1')$, we express $v_1$ in terms of $n_1$:\n$$\nv_1 = \\frac{\\omega}{k n_0} n_1\n$$\nFrom $(3')$, we express $E_1$ in terms of $n_1$:\n$$\nE_1 = i \\frac{e}{\\varepsilon_0 k} n_1\n$$\nSubstituting these expressions for $v_1$ and $E_1$ into the momentum equation $(2')$:\n$$\n-i\\omega m_e \\left(\\frac{\\omega}{k n_0} n_1\\right) = -e \\left(i \\frac{e}{\\varepsilon_0 k} n_1\\right) - i k \\frac{3 k_B T_e}{n_0} n_1\n$$\nFor a non-trivial solution ($n_1 \\ne 0$), we can divide the entire equation by $n_1$ and by $-i$:\n$$\n\\frac{m_e \\omega^2}{k n_0} = \\frac{e^2}{\\varepsilon_0 k} + \\frac{3 k^2 k_B T_e}{k n_0}\n$$\nMultiplying by $k n_0 / m_e$ gives:\n$$\n\\omega^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e} + \\frac{3 k^2 k_B T_e}{m_e}\n$$\nUsing the provided definitions for the electron plasma frequency, $\\omega_{pe}^2 = n_0 e^2 / (\\varepsilon_0 m_e)$, and the electron thermal speed, $v_{te}^2 = k_B T_e / m_e$, we arrive at the dispersion relation for Langmuir waves, known as the Bohm-Gross dispersion relation:\n$$\n\\omega^2(k) = \\omega_{pe}^2 + 3 k^2 v_{te}^2\n$$\n\n**1. Phase Velocity, Group Velocity, and the Role of Temperature**\n\nA wave is termed dispersive if its phase velocity depends on the wavenumber. The phase velocity $v_p$ is defined as $v_p = \\omega/k$, and the group velocity $v_g$ is defined as $v_g = \\partial\\omega/\\partial k$. Using our derived dispersion relation:\n$$\n\\omega(k) = \\sqrt{\\omega_{pe}^2 + 3 k^2 v_{te}^2}\n$$\nThe phase velocity is:\n$$\nv_p = \\frac{\\omega}{k} = \\frac{\\sqrt{\\omega_{pe}^2 + 3 k^2 v_{te}^2}}{k} = \\sqrt{\\frac{\\omega_{pe}^2}{k^2} + 3 v_{te}^2}\n$$\nThe group velocity is found by differentiating $\\omega(k)$ with respect to $k$:\n$$\nv_g = \\frac{\\partial \\omega}{\\partial k} = \\frac{1}{2\\sqrt{\\omega_{pe}^2 + 3 k^2 v_{te}^2}} (6 k v_{te}^2) = \\frac{3 k v_{te}^2}{\\omega}\n$$\nClearly, $v_p \\neq v_g$, and both depend on the wavenumber $k$. This dependence of velocity on $k$ is the definition of a dispersive wave.\n\nThe physical role of finite electron temperature $T_e$ is crucial. The term in the dispersion relation responsible for the $k$-dependence of $\\omega$ is $3 k^2 v_{te}^2$. This term originates from the pressure gradient force, $-\\partial P_e / \\partial x$, in the electron momentum equation. The pressure itself, $P_e$, is a manifestation of the random thermal motion of electrons, and thus is directly proportional to the temperature $T_e$. If the temperature were zero ($T_e=0$), then $v_{te}=0$ and the pressure term would vanish. The dispersion relation would simplify to $\\omega(k) = \\omega_{pe}$. In this \"cold plasma\" case, the frequency is independent of $k$, meaning the group velocity is zero ($v_g=0$). Perturbations do not propagate; they simply oscillate locally at the plasma frequency $\\omega_{pe}$.\n\nFinite temperature introduces an additional restoring force mechanism: pressure. When a density perturbation occurs (e.g., $n_1 > 0$), the pressure increases locally, and the resulting pressure gradient pushes electrons away, working to restore charge neutrality. This force is stronger for shorter wavelengths (larger $k$) because the spatial gradients are steeper. This $k$-dependent restoring force leads to a $k$-dependent oscillation frequency, which is the essence of dispersion. Therefore, the finite electron temperature, by enabling a pressure response, allows the wave to propagate and is the fundamental reason why Langmuir waves are dispersive and why their phase and group velocities differ.\n\n**2. Group Velocity in the Long-Wavelength Limit**\n\nWe are asked to compute the group velocity $v_g$ to leading order in the small parameter $(k \\lambda_{De})^2$, where $\\lambda_{De} = v_{te}/\\omega_{pe}$. This corresponds to the long-wavelength limit, $k\\lambda_{De} \\ll 1$.\n\nWe start from the exact expression for the group velocity:\n$$\nv_g = \\frac{3 k v_{te}^2}{\\omega}\n$$\nThe dispersion relation can be written as:\n$$\n\\omega(k) = \\sqrt{\\omega_{pe}^2 + 3 k^2 v_{te}^2} = \\omega_{pe} \\sqrt{1 + 3 \\frac{k^2 v_{te}^2}{\\omega_{pe}^2}} = \\omega_{pe} \\sqrt{1 + 3 (k \\lambda_{De})^2}\n$$\nIn the limit $k\\lambda_{De} \\ll 1$, we can expand the square root using the binomial approximation $\\sqrt{1+x} \\approx 1 + x/2$ for small $x$. Letting $x = 3 (k \\lambda_{De})^2$, we approximate $\\omega$ as:\n$$\n\\omega(k) \\approx \\omega_{pe} \\left(1 + \\frac{3}{2} (k \\lambda_{De})^2 \\right) = \\omega_{pe} + \\frac{3}{2} \\frac{k^2 v_{te}^2}{\\omega_{pe}}\n$$\nWe can find the leading-order group velocity by differentiating this approximate expression for $\\omega(k)$:\n$$\nv_g = \\frac{\\partial \\omega}{\\partial k} \\approx \\frac{\\partial}{\\partial k} \\left(\\omega_{pe} + \\frac{3}{2} \\frac{k^2 v_{te}^2}{\\omega_{pe}}\\right) = \\frac{3 k v_{te}^2}{\\omega_{pe}}\n$$\nAlternatively, we can substitute the leading-order approximation for $\\omega$ (which is $\\omega \\approx \\omega_{pe}$) into the denominator of the exact expression for $v_g$:\n$$\nv_g = \\frac{3 k v_{te}^2}{\\omega} \\approx \\frac{3 k v_{te}^2}{\\omega_{pe}}\n$$\nBoth methods yield the same result. This expression is the leading-order term for the group velocity in an expansion in powers of $k$. The units are $(m^{-1})(m/s)^2 / (s^{-1}) = m/s$, as required for a velocity.",
            "answer": "$$\\boxed{\\frac{3 k v_{te}^{2}}{\\omega_{pe}}}$$"
        },
        {
            "introduction": "While linear theory describes the onset of waves, real-world applications are governed by nonlinear effects that limit their growth. This exercise tackles one of the most fundamental saturation mechanisms: wavebreaking, where a Langmuir wave grows so large that it traps electrons and collapses. By calculating the maximum sustainable electric field, you will derive a crucial physical limit that determines the peak intensity of plasma waves excited during parametric instabilities .",
            "id": "3706880",
            "problem": "Langmuir waves excited during Light Amplification by Stimulated Emission of Radiation (LASER) interactions in a plasma can grow until they reach a wavebreaking limit, at which point the electron fluid trajectories intersect and the coherent wave collapses. Consider a one-dimensional, cold, unmagnetized, electrostatic electron plasma with immobile ions of uniform background density. A longitudinal electron plasma wave (Langmuir wave) with phase velocity $v_{\\mathrm{ph}}$ propagates through a plasma of unperturbed electron density $n_0$. Assume nonrelativistic electron motion and negligible temperature (cold-fluid limit). Starting only from the one-dimensional cold-fluid electron equations and Gauss’s law, namely\n- continuity:\n$$\\frac{\\partial n}{\\partial t} + \\frac{\\partial (n v)}{\\partial x} = 0$$\n- momentum:\n$$\\frac{\\partial v}{\\partial t} + v \\frac{\\partial v}{\\partial x} = -\\frac{e}{m_e} E$$\n- Gauss’s law:\n$$\\frac{\\partial E}{\\partial x} = \\frac{e}{\\varepsilon_0} (n - n_0)$$\nderive an analytic expression for the maximum sustainable electric field amplitude of the Langmuir wave before wavebreaking in terms of $m_e$, $e$, the plasma frequency $\\omega_p$, and the phase velocity $v_{\\mathrm{ph}}$. Here $\\omega_p$ is defined by $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$.\n\nThen, evaluate the maximum electric field amplitude numerically for a plasma relevant to inertial confinement fusion, with $n_0 = 1.0 \\times 10^{27} \\ \\mathrm{m^{-3}}$ and $v_{\\mathrm{ph}} = 0.10 \\, c$, where $c$ is the speed of light in vacuum. Use the following constants:\n- $m_e = 9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}$,\n- $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$,\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$,\n- $c = 2.99792458 \\times 10^8 \\ \\mathrm{m \\, s^{-1}}$.\n\nExpress the final electric field amplitude in $\\mathrm{GV \\, m^{-1}}$ and round your answer to three significant figures.",
            "solution": "The problem will first be validated for scientific soundness, consistency, and completeness. Upon confirmation of its validity, a complete solution will be derived.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\nThe problem provides the following governing equations for a one-dimensional, cold, unmagnetized, electrostatic electron plasma with immobile ions:\n- Continuity equation: $\\frac{\\partial n}{\\partial t} + \\frac{\\partial (n v)}{\\partial x} = 0$\n- Momentum equation: $\\frac{\\partial v}{\\partial t} + v \\frac{\\partial v}{\\partial x} = -\\frac{e}{m_e} E$\n- Gauss’s law: $\\frac{\\partial E}{\\partial x} = \\frac{e}{\\varepsilon_0} (n - n_0)$\n\nDefinitions and conditions:\n- The wave is a longitudinal electron plasma wave (Langmuir wave).\n- Wave phase velocity: $v_{\\mathrm{ph}}$\n- Unperturbed electron density: $n_0$\n- Background ions are immobile and have a uniform density.\n- Electron motion is nonrelativistic and the plasma is cold ($T_e \\to 0$).\n- The plasma frequency squared is defined as $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$.\n\nNumerical values for evaluation:\n- $n_0 = 1.0 \\times 10^{27} \\ \\mathrm{m^{-3}}$\n- $v_{\\mathrm{ph}} = 0.10 \\, c$\n- $m_e = 9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}$\n- $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$\n- $c = 2.99792458 \\times 10^8 \\ \\mathrm{m \\, s^{-1}}$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria:\n1.  **Scientifically Grounded**: The problem is based on the standard cold-fluid model of plasma physics, a cornerstone for describing collective electron behavior. The equations provided are the correct, well-established one-dimensional equations for this model. The concept of wavebreaking is a fundamental nonlinear process in plasma physics.\n2.  **Well-Posed**: The problem is well-posed. It asks for the derivation of a specific physical quantity, the maximum electric field of a Langmuir wave, from a given set of fundamental equations and clearly stated physical assumptions. The request for a subsequent numerical evaluation with given parameters is also well-defined.\n3.  **Objective**: The problem is stated in precise, objective scientific language, free of any subjective or ambiguous terminology.\n4.  **Complete and Consistent**: The problem is self-contained. All necessary equations, constants, and physical conditions are provided. There are no internal contradictions.\n5.  **Realistic**: The numerical values provided, such as $n_0 = 1.0 \\times 10^{27} \\ \\mathrm{m^{-3}}$, are characteristic of the high-density conditions found in inertial confinement fusion (ICF) targets, making the problem relevant to its stated context. The assumption of a cold, nonrelativistic plasma is a valid starting point for this analysis.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard, well-posed problem in plasma physics that requires a rigorous derivation from first principles. I will now proceed with the solution.\n\n**Derivation of the Maximum Electric Field**\n\nWe are seeking a stationary wave solution. It is convenient to transform to a reference frame moving with the wave's phase velocity, $v_{\\mathrm{ph}}$. Let the new coordinate be $\\xi = x - v_{\\mathrm{ph}} t$. In this frame, all quantities are functions of $\\xi$ only. The partial derivatives transform as:\n$\\frac{\\partial}{\\partial t} \\rightarrow -v_{\\mathrm{ph}} \\frac{d}{d\\xi}$\n$\\frac{\\partial}{\\partial x} \\rightarrow \\frac{d}{d\\xi}$\n\nApplying this transformation to the fluid equations:\n1.  **Continuity Equation**:\n    $-v_{\\mathrm{ph}} \\frac{dn}{d\\xi} + \\frac{d(nv)}{d\\xi} = 0 \\implies \\frac{d}{d\\xi} [n(v - v_{\\mathrm{ph}})] = 0$\n    Integrating with respect to $\\xi$ gives a constant of integration, which represents the conservation of particle flux in the wave frame. We evaluate this constant in the unperturbed region of the plasma, where $v=0$ and $n=n_0$.\n    $n(v - v_{\\mathrm{ph}}) = n_0(0 - v_{\\mathrm{ph}}) = -n_0 v_{\\mathrm{ph}}$\n    Solving for the electron density $n$ as a function of the fluid velocity $v$:\n    $$n = \\frac{n_0 v_{\\mathrm{ph}}}{v_{\\mathrm{ph}} - v}$$\n    This equation reveals that the density $n$ becomes singular as the fluid velocity $v$ approaches the phase velocity $v_{\\mathrm{ph}}$. This singularity defines the wavebreaking condition. Wavebreaking occurs when the fastest electrons in the wave are accelerated to the point where they are \"trapped\" and move with the wave, leading to a pile-up of charge and an infinite density in this cold-fluid model. Therefore, the maximum fluid velocity is limited by the phase velocity: $v_{\\mathrm{max}} = v_{\\mathrm{ph}}$.\n\n2.  **Momentum and Gauss's Law**:\n    The transformed momentum equation is:\n    $(v - v_{\\mathrm{ph}}) \\frac{dv}{d\\xi} = -\\frac{e}{m_e} E$\n    The transformed Gauss's law, with the expression for $n$ substituted, is:\n    $\\frac{dE}{d\\xi} = \\frac{e}{\\varepsilon_0}(n - n_0) = \\frac{e}{\\varepsilon_0} \\left( \\frac{n_0 v_{\\mathrm{ph}}}{v_{\\mathrm{ph}} - v} - n_0 \\right) = \\frac{n_0 e}{\\varepsilon_0} \\frac{v}{v_{\\mathrm{ph}} - v}$\n\n    We now have two coupled first-order differential equations for $E$ and $v$. To find a direct relationship between $E$ and $v$, we can eliminate the spatial variable $\\xi$ by taking the ratio $\\frac{dE}{dv}$:\n    $$\\frac{dE}{dv} = \\frac{dE/d\\xi}{dv/d\\xi} = \\frac{\\frac{n_0 e}{\\varepsilon_0} \\frac{v}{v_{\\mathrm{ph}} - v}}{(v - v_{\\mathrm{ph}}) \\frac{dv}{d\\xi} / (v - v_{\\mathrm{ph}})} = \\frac{\\frac{n_0 e}{\\varepsilon_0} \\frac{v}{v_{\\mathrm{ph}} - v}}{-\\frac{e E}{m_e (v - v_{\\mathrm{ph}})}}$$\n    Simplifying this expression:\n    $$\\frac{dE}{dv} = \\frac{n_0 e}{\\varepsilon_0} \\frac{v}{(v_{\\mathrm{ph}}-v)} \\left( -\\frac{m_e (v-v_{\\mathrm{ph}})}{eE} \\right) = -\\frac{m_e n_0}{\\varepsilon_0} \\frac{v}{E}$$\n    This separates into $E \\, dE = -\\frac{m_e n_0}{\\varepsilon_0} v \\, dv$. We integrate this equation:\n    $$\\int E \\, dE = -\\frac{m_e n_0}{\\varepsilon_0} \\int v \\, dv$$\n    $$\\frac{1}{2} E^2 = -\\frac{1}{2} \\frac{m_e n_0}{\\varepsilon_0} v^2 + C$$\n    where $C$ is the constant of integration. To determine $C$, we consider a point in the wave where the electric field reaches its maximum amplitude, $E=E_{\\mathrm{max}}$. At this extremum, its derivative $\\frac{dE}{d\\xi}$ must be zero. From Gauss's law, $\\frac{dE}{d\\xi}=0$ implies $v=0$. Thus, the maximum electric field occurs where the fluid velocity is zero.\n    Substituting $E=E_{\\mathrm{max}}$ and $v=0$ into the integrated equation:\n    $\\frac{1}{2} E_{\\mathrm{max}}^2 = -\\frac{1}{2} \\frac{m_e n_0}{\\varepsilon_0} (0)^2 + C \\implies C = \\frac{1}{2} E_{\\mathrm{max}}^2$\n    The relation between $E$ and $v$ is therefore:\n    $E^2 = E_{\\mathrm{max}}^2 - \\frac{m_e n_0}{\\varepsilon_0} v^2$\n    This equation shows that the field is zero ($E=0$) when the fluid velocity reaches its maximum magnitude, $|v| = v_{\\mathrm{max}}$. Setting $E=0$, we get:\n    $0 = E_{\\mathrm{max}}^2 - \\frac{m_e n_0}{\\varepsilon_0} v_{\\mathrm{max}}^2 \\implies E_{\\mathrm{max}}^2 = \\frac{m_e n_0}{\\varepsilon_0} v_{\\mathrm{max}}^2$\n\n    Now we apply the wavebreaking condition derived earlier, $v_{\\mathrm{max}} = v_{\\mathrm{ph}}$. This gives the maximum sustainable electric field amplitude before the wave breaks:\n    $E_{\\mathrm{max}}^2 = \\frac{m_e n_0}{\\varepsilon_0} v_{\\mathrm{ph}}^2$\n    Taking the square root for the amplitude:\n    $E_{\\mathrm{max}} = \\sqrt{\\frac{m_e n_0}{\\varepsilon_0}} v_{\\mathrm{ph}}$\n    Using the definition of the plasma frequency, $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$, we can rewrite the term under the square root: $\\frac{m_e n_0}{\\varepsilon_0} = \\frac{m_e^2 \\omega_p^2}{e^2}$.\n    Substituting this gives the final analytical expression:\n    $$E_{\\mathrm{max}} = \\frac{m_e \\omega_p v_{\\mathrm{ph}}}{e}$$\n\n**Numerical Evaluation**\n\nWe now evaluate this expression using the provided data.\n- $n_0 = 1.0 \\times 10^{27} \\ \\mathrm{m^{-3}}$\n- $v_{\\mathrm{ph}} = 0.10 \\, c = 0.10 \\times (2.99792458 \\times 10^8 \\ \\mathrm{m \\, s^{-1}}) = 2.99792458 \\times 10^7 \\ \\mathrm{m \\, s^{-1}}$\n- $m_e = 9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}$\n- $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$\n\nIt is computationally more direct to use the form $E_{\\mathrm{max}} = v_{\\mathrm{ph}} \\sqrt{\\frac{m_e n_0}{\\varepsilon_0}}$.\nFirst, calculate the term under the square root:\n$\\frac{m_e n_0}{\\varepsilon_0} = \\frac{(9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}) (1.0 \\times 10^{27} \\ \\mathrm{m^{-3}})}{8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}} \\approx 1.02882008 \\times 10^8 \\ \\mathrm{kg \\, m^{-3} \\, F^{-1}}$\nTaking the square root:\n$\\sqrt{\\frac{m_e n_0}{\\varepsilon_0}} \\approx \\sqrt{1.02882008 \\times 10^8} \\approx 1.01430768 \\times 10^4 \\ (\\mathrm{kg \\, m^{-3} \\, F^{-1}})^{1/2}$\nNow, multiply by the phase velocity:\n$E_{\\mathrm{max}} = (2.99792458 \\times 10^7 \\ \\mathrm{m \\, s^{-1}}) \\times (1.01430768 \\times 10^4 \\ (\\mathrm{kg \\, m^{-3} \\, F^{-1}})^{1/2})$\n$E_{\\mathrm{max}} \\approx 3.040810 \\times 10^{11} \\ \\mathrm{V \\, m^{-1}}$\n\nThe problem requires the answer in units of gigavolts per meter ($\\mathrm{GV \\, m^{-1}}$), where $1 \\ \\mathrm{GV} = 10^9 \\ \\mathrm{V}$.\n$E_{\\mathrm{max}} = \\frac{3.040810 \\times 10^{11}}{10^9} \\ \\mathrm{GV \\, m^{-1}} \\approx 304.0810 \\ \\mathrm{GV \\, m^{-1}}$\nRounding to three significant figures, we get:\n$E_{\\mathrm{max}} \\approx 304 \\ \\mathrm{GV \\, m^{-1}}$",
            "answer": "$$\\boxed{304}$$"
        },
        {
            "introduction": "Analytical theory provides essential insights, but fully capturing the complex, nonlinear dynamics of laser-plasma interactions often requires numerical simulation. This final practice bridges the gap between theory and computation by tasking you with designing a Particle-In-Cell (PIC) simulation, a workhorse of modern plasma physics. By deriving the necessary constraints on the simulation's grid spacing and time step from first principles, you will learn how to translate the physical scales of an instability like SRS into a stable and accurate numerical experiment .",
            "id": "3706863",
            "problem": "Construct a complete algorithmic specification for a one-dimensional electromagnetic Particle-In-Cell (PIC) simulation that can capture backward Stimulated Raman Scattering (SRS) in a homogeneous, singly ionized electron plasma with immobile ions. Your task is to derive, from first principles and well-tested physical facts, the numerical constraints on the spatial grid size and time step required to resolve the linear SRS interaction while ensuring numerical stability of the field solver and the particle advance. The derivation must begin from the following foundations: Maxwell's equations in vacuum and in a cold homogeneous plasma, the electron equation of motion, the concept of three-wave coupling in a resonant interaction, the sampling theorem for resolving waves on a discrete grid, and the stability conditions for explicit finite-difference time-domain field solvers and leapfrog time integration of a harmonic oscillator. Do not assume any additional formulas beyond these foundational bases in your derivation.\n\nDefine the following physical context and quantities:\n- A vacuum pump laser of vacuum wavelength $\\lambda_{0}$, frequency $\\omega_{0} = 2\\pi c/\\lambda_{0}$, and homogeneous plasma electron number density $n_{e}$ given as a fraction $f_{n}$ of the critical density $n_{\\mathrm{cr}}$ corresponding to $\\omega_{0}$. The critical density is defined by $\\omega_{pe}^{2} = n_{e} e^{2}/(\\varepsilon_{0} m_{e})$ and $n_{\\mathrm{cr}} = \\varepsilon_{0} m_{e} \\omega_{0}^{2}/e^{2}$ so that $n_{e} = f_{n} n_{\\mathrm{cr}}$ and $\\omega_{pe} = \\sqrt{f_{n}}\\omega_{0}$, where $\\varepsilon_{0}$ is the electric permittivity of free space, $m_{e}$ is the electron mass, $e$ is the elementary charge, and $c$ is the speed of light in vacuum.\n- The electron temperature $T_{e}$ (expressed in electronvolts) determines the electron thermal speed $v_{te} = \\sqrt{k_{B} T_{e}/m_{e}}$, where $k_{B}$ is Boltzmann's constant.\n- The pump wave number $k_{0}$ follows the electromagnetic dispersion relation in a homogeneous plasma and must be obtained from first principles.\n\nBackward SRS is the resonant three-wave parametric process involving the pump electromagnetic wave, a backward-scattered electromagnetic wave, and a forward electron plasma (Langmuir) wave. The resonance (frequency and wave-number matching) conditions must be deduced from conservation of energy and momentum, along with the respective linear dispersion relations for electromagnetic waves in a cold plasma and Langmuir waves with a first-order finite-temperature correction. Using only these bases and without shortcut formulas, derive a computational procedure to determine:\n- Whether backward SRS is kinematically allowed, that is, whether the scattered electromagnetic wave frequency exceeds the plasma cutoff, and thus is a propagating mode.\n- The largest wave number that must be representable on the grid to resolve all three participating waves in the SRS interaction, and hence the maximum admissible spatial grid size $\\Delta x_{\\max}$ from sampling considerations.\n- The maximum admissible time step $\\Delta t_{\\max}$ as the minimum of three constraints: the Courant-Friedrichs-Lewy (CFL) condition for a one-dimensional explicit finite-difference time-domain (FDTD) update of Maxwell's equations in vacuum, the stability condition for leapfrog integration of a harmonic oscillator representing plasma oscillations, and the temporal sampling condition required to resolve the fastest participating wave.\n\nYour program must implement the derived procedure and compute the following for each test case:\n- A viability indicator equal to $1$ if backward SRS is kinematically allowed and $0$ otherwise.\n- The maximum grid spacing $\\Delta x_{\\max}$ in meters.\n- The maximum time step $\\Delta t_{\\max}$ in seconds.\n\nExpress all physical outputs in the International System of Units (SI), specifically meters for spatial quantities and seconds for temporal quantities. Angles are not used. Do not use percentage symbols; all fractions must be represented as decimals.\n\nTest Suite:\nImplement your program to evaluate the following parameter sets, where $\\lambda_{0}$ is the vacuum laser wavelength in meters, $f_{n}$ is the density fraction relative to critical for that $\\lambda_{0}$, and $T_{e}$ is the electron temperature in electronvolts:\n- Case 1 (happy path): $\\lambda_{0} = 351 \\times 10^{-9} \\, \\mathrm{m}$, $f_{n} = 0.05$, $T_{e} = 2000 \\, \\mathrm{eV}$.\n- Case 2 (near the scattered-wave cutoff): $\\lambda_{0} = 351 \\times 10^{-9} \\, \\mathrm{m}$, $f_{n} = 0.24$, $T_{e} = 3000 \\, \\mathrm{eV}$.\n- Case 3 (different laser band): $\\lambda_{0} = 1053 \\times 10^{-9} \\, \\mathrm{m}$, $f_{n} = 0.01$, $T_{e} = 500 \\, \\mathrm{eV}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of the form $[v, \\Delta x_{\\max}, \\Delta t_{\\max}]$ with $v$ an integer viability indicator ($1$ or $0$), and $\\Delta x_{\\max}$ and $\\Delta t_{\\max}$ are floating-point numbers in SI units. For example, the output must look like $[[v_{1},\\Delta x_{1},\\Delta t_{1}],[v_{2},\\Delta x_{2},\\Delta t_{2}],[v_{3},\\Delta x_{3},\\Delta t_{3}]]$ with no additional text on the line.",
            "solution": "The problem requires the derivation of numerical constraints for a one-dimensional Particle-In-Cell (PIC) simulation of backward Stimulated Raman Scattering (SRS). The derivation must be founded on first principles of plasma physics and numerical methods. The objective is to determine the kinematic viability of backward SRS and to compute the maximum allowable spatial grid size, $\\Delta x_{\\max}$, and time step, $\\Delta t_{\\max}$, for a stable and accurate simulation.\n\nThe fundamental physical process is backward SRS, a three-wave parametric instability where a pump electromagnetic (EM) wave ($\\omega_0, k_0$) decays into a backward-propagating scattered EM wave ($\\omega_s, k_s$) and a forward-propagating electron plasma wave (EPW) or Langmuir wave ($\\omega_{epw}, k_{epw}$).\n\nThe derivation proceeds in three main stages:\n1.  Establishment of the physical model, including the dispersion relations for the participating waves and the resonance conditions for their interaction.\n2.  Derivation of the kinematic condition for the process to be allowed.\n3.  Derivation of the numerical constraints on the simulation grid ($\\Delta x_{\\max}$) and time step ($\\Delta t_{\\max}$).\n\nThe following physical constants are used: speed of light in vacuum $c$, elementary charge $e$, electron mass $m_e$, and vacuum permittivity $\\varepsilon_0$. The input parameters are the pump laser's vacuum wavelength $\\lambda_0$, the electron density fraction $f_n$, and the electron temperature $T_e$ in electronvolts.\n\nFrom the givens, we define the following primary quantities:\n- Pump laser frequency: $\\omega_0 = 2\\pi c / \\lambda_0$.\n- Electron plasma frequency: $\\omega_{pe} = \\sqrt{f_n} \\omega_0$, derived from its definition $\\omega_{pe}^2 = n_e e^2 / (\\varepsilon_0 m_e)$ and the definition of critical density, $n_e = f_n n_{cr} = f_n \\varepsilon_0 m_e \\omega_0^2 / e^2$.\n- Electron thermal velocity: $v_{te} = \\sqrt{k_B T_e / m_e}$, where the problem gives $T_e$ in electronvolts, which corresponds to the energy $k_B T_e$. Thus, we use $k_B T_e = T_e[\\text{eV}] \\times e$.\n\n**1. Dispersion Relations and Resonance Conditions**\n\nThe interaction is governed by wave dispersion and energy-momentum conservation.\n\n**Dispersion Relations:**\n-   **Electromagnetic (EM) Waves:** The dispersion relation for transverse EM waves in a cold, unmagnetized plasma is derived by finding plane-wave solutions to Maxwell's equations coupled with the linearized electron fluid momentum equation. This yields the relation:\n    $$ \\omega^2 = \\omega_{pe}^2 + c^2 k^2 $$\n    This relation applies to both the pump wave ($\\omega_0, k_0$) and the scattered wave ($\\omega_s, k_s$). A wave can only propagate if its frequency $\\omega$ is greater than the plasma cutoff frequency, $\\omega_{pe}$.\n\n-   **Electron Plasma Waves (EPW):** The dispersion relation for longitudinal electron plasma waves (Langmuir waves), including a first-order thermal correction, is derived from the linearized electron fluid equations (continuity and momentum, including a pressure term) and Poisson's equation. For one-dimensional oscillations (adiabatic index $\\gamma=3$), this gives the Bohm-Gross dispersion relation:\n    $$ \\omega_{epw}^2 = \\omega_{pe}^2 + 3 v_{te}^2 k_{epw}^2 $$\n\n**Resonance Conditions:**\nThe three-wave coupling in SRS must satisfy the conservation of energy and momentum, which quantum mechanically corresponds to frequency and wave-number matching conditions:\n-   Frequency matching: $\\omega_0 = \\omega_s + \\omega_{epw}$\n-   Wave-number matching: $\\mathbf{k}_0 = \\mathbf{k}_s + \\mathbf{k}_{epw}$\n\nFor one-dimensional backward scattering, the pump and scattered waves propagate in opposite directions. We take the pump to propagate in the $+x$ direction ($k_0 > 0$), so the scattered wave propagates in the $-x$ direction ($k_s  0$). The EPW must then propagate in the $+x$ direction ($k_{epw} > 0$) to satisfy momentum conservation. The scalar matching condition on wave numbers is:\n$k_{epw} = k_0 - k_s = k_0 + |k_s|$.\n\n**2. Kinematic Viability of Backward SRS**\n\nBackward SRS is kinematically allowed only if all three daughter waves are propagating modes. This primarily requires the scattered EM wave frequency $\\omega_s$ to be above the plasma cutoff, i.e., $\\omega_s > \\omega_{pe}$.\n\nWe can establish a condition for this by combining the resonance conditions and dispersion relations.\nFrom the dispersion relations, we have:\n$k_0 = \\frac{1}{c}\\sqrt{\\omega_0^2 - \\omega_{pe}^2}$ (assuming $f_n  1$)\n$|k_s| = \\frac{1}{c}\\sqrt{\\omega_s^2 - \\omega_{pe}^2}$\n\nSubstituting these and $\\omega_{epw} = \\omega_0 - \\omega_s$ into the EPW dispersion relation yields a single, albeit transcendental, equation for $\\omega_s$:\n$$ (\\omega_0 - \\omega_s)^2 = \\omega_{pe}^2 + 3 v_{te}^2 \\left( \\frac{\\sqrt{\\omega_0^2 - \\omega_{pe}^2}}{c} + \\frac{\\sqrt{\\omega_s^2 - \\omega_{pe}^2}}{c} \\right)^2 $$\nLet this equation be denoted $G(\\omega_s) = 0$. A physically meaningful solution for $\\omega_s$ must exist in the interval $(\\omega_{pe}, \\omega_0 - \\omega_{pe})$. The left bound ensures the scattered wave propagates, and the right bound ensures the plasma wave has a positive frequency.\n\nThe function $G(\\omega_s)$ is monotonically decreasing with $\\omega_s$ in this interval. Thus, a unique solution exists if and only if $G(\\omega_s) > 0$ at the lower bound $\\omega_s \\to \\omega_{pe}^+$. Let's evaluate this condition:\n$$ (\\omega_0 - \\omega_{pe})^2 > \\omega_{pe}^2 + 3 v_{te}^2 \\left( \\frac{\\sqrt{\\omega_0^2 - \\omega_{pe}^2}}{c} \\right)^2 $$\n$$ \\omega_0^2 - 2\\omega_0\\omega_{pe} > \\frac{3 v_{te}^2}{c^2}(\\omega_0^2 - \\omega_{pe}^2) $$\nDividing by $\\omega_0^2$ and substituting $\\omega_{pe} = \\sqrt{f_n}\\omega_0$:\n$$ 1 - 2\\sqrt{f_n} > \\frac{3 v_{te}^2}{c^2}(1 - f_n) $$\nThe viability indicator $v$ is $1$ if this inequality holds, and $0$ otherwise. This condition is stricter than the cold plasma limit ($f_n  0.25$), as the thermal motion provides an effective pressure that can inhibit the plasma wave formation.\n\n**3. Numerical Simulation Constraints**\n\nIf backward SRS is viable ($v=1$), we proceed to find the numerical constraints. This requires solving numerically for $\\omega_s$ and then determining the wave numbers.\n\n**Spatial Grid Constraint ($\\Delta x_{\\max}$):**\nTo avoid aliasing and accurately represent all waves, the grid spacing $\\Delta x$ must resolve the shortest wavelength $\\lambda_{min} = 2\\pi/k_{max}$, where $k_{max} = \\max(|k_0|, |k_s|, |k_{epw}|)$.\nTypically, $k_{epw} = k_0 + |k_s|$ is the largest wave number.\nThe Nyquist-Shannon sampling theorem dictates that the sampling rate must be more than twice the maximum frequency. In the spatial domain, this translates to $1/\\Delta x > 2 \\times (k_{max}/(2\\pi))$, which implies $\\Delta x  \\pi/k_{max}$. The maximum admissible grid spacing is therefore:\n$$ \\Delta x_{\\max} = \\frac{\\pi}{k_{max}} = \\frac{\\pi}{k_{epw}} $$\nIn practice, PIC simulations require much smaller grid cells (e.g., $10-20$ cells per $\\lambda_{min}$) for accuracy, but this represents the absolute theoretical upper limit.\n\n**Time Step Constraint ($\\Delta t_{\\max}$):**\nThe maximum time step $\\Delta t_{\\max}$ is determined by the most restrictive of three conditions:\n1.  **Courant-Friedrichs-Lewy (CFL) Condition:** For the stability of the explicit Finite-Difference Time-Domain (FDTD) solver for Maxwell's equations in one dimension, the numerical domain of dependence must contain the physical domain of dependence. This requires $c \\Delta t \\le \\Delta x$. To obtain a constraint on $\\Delta t$ independent of a specific choice of $\\Delta x$, we evaluate this at the limit of the spatial resolution:\n    $$ \\Delta t_{CFL} \\le \\frac{\\Delta x_{\\max}}{c} = \\frac{\\pi}{c k_{max}} $$\n\n2.  **Plasma Oscillation Stability:** The leapfrog algorithm, commonly used for advancing particle positions and velocities, is a second-order accurate integrator. When applied to a simple harmonic oscillator of frequency $\\omega$, leapfrog is stable only if $\\omega \\Delta t \\le 2$. The fastest intrinsic timescale for electron motion is the plasma oscillation period, corresponding to the frequency $\\omega_{pe}$. Applying the stability condition to these oscillations gives:\n    $$ \\Delta t_{plasma} \\le \\frac{2}{\\omega_{pe}} $$\n\n3.  **Temporal Sampling Condition:** Similar to the spatial domain, the time step must be small enough to resolve the highest frequency present in the system, which is that of the pump laser, $\\omega_0$. The temporal Nyquist criterion is $\\Delta t  \\pi/\\omega_{max}$:\n    $$ \\Delta t_{sample} \\le \\frac{\\pi}{\\omega_0} $$\n\nThe overall maximum time step is the minimum of these three upper bounds:\n$$ \\Delta t_{\\max} = \\min\\left( \\frac{\\pi}{c k_{max}}, \\frac{2}{\\omega_{pe}}, \\frac{\\pi}{\\omega_0} \\right) $$\n\n**Algorithmic Summary:**\nFor each test case $(\\lambda_0, f_n, T_e)$:\n1.  Calculate primary parameters $\\omega_0$, $\\omega_{pe}$, and $v_{te}$.\n2.  Evaluate the viability condition $1 - 2\\sqrt{f_n} - 3 (v_{te}/c)^2(1 - f_n) > 0$. If true, set $v=1$; otherwise, set $v=0$.\n3.  If $v=0$, the process is kinematically forbidden. The resulting constraints are not well-defined. We output $\\Delta x_{\\max} = 0$ and $\\Delta t_{\\max} = 0$.\n4.  If $v=1$:\n    a. Numerically solve the equation $G(\\omega_s) = 0$ for $\\omega_s$ in the interval $(\\omega_{pe}, \\omega_0-\\omega_{pe})$ using a root-finding algorithm.\n    b. Calculate the wave numbers $k_0 = \\frac{1}{c}\\sqrt{\\omega_0^2 - \\omega_{pe}^2}$ and $|k_s| = \\frac{1}{c}\\sqrt{\\omega_s^2 - \\omega_{pe}^2}$.\n    c. Determine the maximum wave number, $k_{max} = k_0 + |k_s|$.\n    d. Compute $\\Delta x_{\\max} = \\pi / k_{max}$.\n    e. Compute $\\Delta t_{\\max} = \\min(\\Delta x_{\\max} / c, 2 / \\omega_{pe}, \\pi / \\omega_0)$.\n5.  Store the triplet $[v, \\Delta x_{\\max}, \\Delta t_{\\max}]$.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Calculates numerical constraints for a 1D PIC simulation of backward SRS.\n    \"\"\"\n\n    # Physical Constants (SI units)\n    C = 299792458.0  # Speed of light in vacuum (m/s)\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    M_E = 9.1093837015e-31  # Electron mass (kg)\n    EPS0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n\n    # Test cases: (lambda0 [m], fn [dimensionless], Te [eV])\n    test_cases = [\n        (351e-9, 0.05, 2000.0),\n        (351e-9, 0.24, 3000.0),\n        (1053e-9, 0.01, 500.0),\n    ]\n\n    results = []\n\n    for lambda0, fn, Te_eV in test_cases:\n        # Step 1: Calculate basic plasma parameters\n        w0 = 2.0 * np.pi * C / lambda0\n        \n        if fn >= 1.0:\n            # Pump wave cannot propagate if density is above critical\n            results.append([0, 0.0, 0.0])\n            continue\n            \n        wpe = np.sqrt(fn) * w0\n        \n        # Convert electron temperature from eV to Joules\n        Te_J = Te_eV * E_CHARGE\n        v_te = np.sqrt(Te_J / M_E)\n\n        # Step 2: Check kinematic viability\n        v_te_c_sq = (v_te / C)**2\n        viability_metric = 1.0 - 2.0 * np.sqrt(fn) - 3.0 * v_te_c_sq * (1.0 - fn)\n        \n        is_viable = 1 if viability_metric > 0 else 0\n\n        if not is_viable:\n            results.append([0, 0.0, 0.0])\n            continue\n\n        # Step 3: If viable, solve for wave parameters\n        # Define the transcendental equation for the scattered frequency ws\n        # F(ws) = (w0 - ws)^2 - wpe^2 - 3*v_te^2/c^2 * (sqrt(w0^2-wpe^2) + sqrt(ws^2-wpe^2))^2 = 0\n        k0_term_sq = w0**2 - wpe**2\n        k0_term = np.sqrt(k0_term_sq)\n        \n        def srs_matching_func(ws):\n            if ws = wpe:\n                # Outside of valid domain\n                return np.inf\n            ks_term_sq = ws**2 - wpe**2\n            ks_term = np.sqrt(ks_term_sq)\n            \n            w_epw_sq = (w0 - ws)**2\n            k_epw_sq = ((k0_term + ks_term) / C)**2\n\n            return w_epw_sq - (wpe**2 + 3.0 * v_te**2 * k_epw_sq)\n\n        # Solve for ws using a robust root-finding algorithm\n        # The root must lie between wpe and w0 - wpe\n        # Add a small epsilon to avoid issues at the boundaries\n        eps = 1e-6 * wpe\n        try:\n            ws = optimize.brentq(srs_matching_func, wpe + eps, w0 - wpe - eps)\n        except ValueError:\n            # This can happen if the function does not cross zero in the interval,\n            # meaning viability check failed subtly or no solution exists.\n            results.append([0, 0.0, 0.0])\n            continue\n\n        # Step 4: Calculate numerical constraints\n        \n        # 4a. Calculate wave numbers\n        k0 = k0_term / C\n        ks_mag = np.sqrt(ws**2 - wpe**2) / C\n        k_epw = k0 + ks_mag\n        \n        # The largest wavenumber is k_epw\n        k_max = k_epw\n\n        # 4b. Calculate max grid spacing\n        # From Nyquist sampling theorem: dx  pi / k_max\n        dx_max = np.pi / k_max\n\n        # 4c. Calculate max time step\n        # CFL condition for 1D FDTD\n        dt_cfl = dx_max / C\n        \n        # Leapfrog stability for plasma oscillations\n        dt_plasma = 2.0 / wpe\n        \n        # Temporal sampling of the fastest wave (pump laser)\n        dt_sample = np.pi / w0\n        \n        dt_max = min(dt_cfl, dt_plasma, dt_sample)\n\n        results.append([is_viable, dx_max, dt_max])\n\n    # Final print statement must be in the exact format\n    # Example: [[v1,dx1,dt1],[v2,dx2,dt2],[v3,dx3,dt3]]\n    sub_results_str = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output_str = f\"[{','.join(sub_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}