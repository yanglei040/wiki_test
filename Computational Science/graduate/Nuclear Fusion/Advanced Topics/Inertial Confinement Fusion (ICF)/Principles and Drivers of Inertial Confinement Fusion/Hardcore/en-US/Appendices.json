{
    "hands_on_practices": [
        {
            "introduction": "The ultimate goal of inertial confinement fusion is to generate significant energy yield. This exercise provides a hands-on approach to understanding how the fusion yield is directly linked to the thermodynamic conditions achieved in the central hot spot at stagnation. By applying a physically-motivated scaling law, you will learn to predict changes in performance based on measurable quantities like pressure, radius, and burn duration, a fundamental skill for interpreting experimental data and guiding future designs.",
            "id": "3715341",
            "problem": "A deuterium–tritium (D–T) capsule driven at the National Ignition Facility (NIF) produces a central hot spot that is approximately uniform in pressure, size, and burn duration during peak fusion production. Starting from first principles of inertial confinement fusion, the fusion yield is expected to scale with hot-spot quantities through a power-law form in which the unknown proportionality constant encodes microphysical factors, while the exponents reflect macroscopic dependencies. Consider the following experimentally motivated scenario in which the fusion yield scales as a power law in hot-spot pressure, radius, and confinement time with exponents characteristic of near-optimal D–T burn conditions.\n\nA reference shot achieves a fusion energy yield of $Y_{\\mathrm{ref}}=1.9\\,\\mathrm{MJ}$ with hot-spot pressure $P_{\\mathrm{ref}}=1.6\\times 10^{14}\\,\\mathrm{Pa}$, hot-spot radius $R_{\\mathrm{ref}}=25\\,\\mu\\mathrm{m}$, and effective burn duration $\\tau_{\\mathrm{ref}}=120\\,\\mathrm{ps}$. A proposed scaling law for near-optimal D–T hot spots uses exponents $a=2$, $b=3$, and $c=1$ for the dependencies on hot-spot pressure $P_{\\mathrm{hs}}$, radius $R_{\\mathrm{hs}}$, and burn duration $\\tau$, respectively. Assume the deuterium–tritium ion temperature remains close to its optimal value across the shots so that the thermal reaction-rate factor in the proportionality constant is effectively unchanged.\n\nA new shot achieves $P_{\\mathrm{hs}}=2.1\\times 10^{14}\\,\\mathrm{Pa}$, $R_{\\mathrm{hs}}=30\\,\\mu\\mathrm{m}$, and $\\tau=150\\,\\mathrm{ps}$. Using the given exponents for the hot-spot scaling and calibrating the proportionality constant with the reference shot, compute the fusion energy yield $Y$ for the new shot.\n\nExpress the final energy in $\\mathrm{MJ}$. Round your answer to three significant figures.",
            "solution": "The problem asks for the prediction of fusion energy yield, $Y$, for a new inertial confinement fusion (ICF) shot, based on a reference shot and a given power-law scaling relationship. The scaling law postulates that the yield $Y$ is proportional to powers of the hot-spot pressure $P_{\\mathrm{hs}}$, radius $R_{\\mathrm{hs}}$, and burn duration $\\tau$:\n$$Y = k P_{\\mathrm{hs}}^a R_{\\mathrm{hs}}^b \\tau^c$$\nwhere $k$ is a constant of proportionality, and the exponents are given as $a=2$, $b=3$, and $c=1$.\n\nFirst, we will briefly establish the physical basis for these exponents, starting from first principles as suggested by the problem statement. The total fusion energy yield $Y$ is the product of the energy per fusion reaction, $E_{fus}$, and the total number of reactions, $N_{fus}$. The number of reactions is the integral of the reaction rate over the reacting volume and the burn duration. For a uniform hot spot, this is:\n$$Y = E_{fus} \\times (\\text{reaction rate density}) \\times (\\text{volume}) \\times (\\text{burn duration})$$\nThe reaction rate density for a deuterium-tritium (D-T) plasma with ion number densities $n_D$ and $n_T$ is given by $n_D n_T \\langle\\sigma v\\rangle$, where $\\langle\\sigma v\\rangle$ is the fusion reactivity, a function of ion temperature $T$. For an equimolar D-T mixture, $n_D = n_T = n_i/2$, where $n_i$ is the total D-T ion density. The rate density is thus $\\frac{1}{4}n_i^2 \\langle\\sigma v\\rangle$. The hot-spot volume is $V_{\\mathrm{hs}} = \\frac{4}{3}\\pi R_{\\mathrm{hs}}^3$. The yield is then:\n$$Y = E_{fus} \\left(\\frac{1}{4}n_i^2 \\langle\\sigma v\\rangle\\right) \\left(\\frac{4}{3}\\pi R_{\\mathrm{hs}}^3\\right) \\tau = \\frac{\\pi}{3} E_{fus} n_i^2 \\langle\\sigma v\\rangle R_{\\mathrm{hs}}^3 \\tau$$\nThe hot-spot pressure $P_{\\mathrm{hs}}$ is related to the particle densities and temperature through an equation of state. For an ideal gas plasma, $P_{\\mathrm{hs}} = (n_i + n_e) k_B T$, where $n_e$ is the electron density and $k_B$ is the Boltzmann constant. For a fully ionized D-T plasma, $n_e = n_D + n_T = n_i$. Thus, $P_{\\mathrm{hs}} = 2 n_i k_B T$, which implies $n_i = \\frac{P_{\\mathrm{hs}}}{2 k_B T}$. Substituting this into the yield expression:\n$$Y = \\frac{\\pi}{3} E_{fus} \\left(\\frac{P_{\\mathrm{hs}}}{2 k_B T}\\right)^2 \\langle\\sigma v\\rangle R_{\\mathrm{hs}}^3 \\tau = \\left(\\frac{\\pi E_{fus} \\langle\\sigma v\\rangle}{12 k_B^2 T^2}\\right) P_{\\mathrm{hs}}^2 R_{\\mathrm{hs}}^3 \\tau^1$$\nThe problem states that the ion temperature $T$ is constant and near its optimal value. Therefore, the entire term in parentheses, which depends on microphysical constants and temperature, can be treated as the constant of proportionality $k$. This confirms the scaling law $Y \\propto P_{\\mathrm{hs}}^2 R_{\\mathrm{hs}}^3 \\tau^1$, validating the given exponents $a=2$, $b=3$, and $c=1$.\n\nTo compute the yield for the new shot without explicitly calculating the constant $k$, we use a ratiometric approach. Let the new shot parameters be $Y$, $P_{\\mathrm{hs}}$, $R_{\\mathrm{hs}}$, and $\\tau$, and the reference shot parameters be $Y_{\\mathrm{ref}}$, $P_{\\mathrm{ref}}$, $R_{\\mathrm{ref}}$, and $\\tau_{\\mathrm{ref}}$. We can write the scaling law for both shots:\n$$Y = k P_{\\mathrm{hs}}^2 R_{\\mathrm{hs}}^3 \\tau^1$$\n$$Y_{\\mathrm{ref}} = k P_{\\mathrm{ref}}^2 R_{\\mathrm{ref}}^3 \\tau_{\\mathrm{ref}}^1$$\nDividing the first equation by the second eliminates the constant $k$:\n$$\\frac{Y}{Y_{\\mathrm{ref}}} = \\frac{k P_{\\mathrm{hs}}^2 R_{\\mathrm{hs}}^3 \\tau}{k P_{\\mathrm{ref}}^2 R_{\\mathrm{ref}}^3 \\tau_{\\mathrm{ref}}} = \\left(\\frac{P_{\\mathrm{hs}}}{P_{\\mathrm{ref}}}\\right)^2 \\left(\\frac{R_{\\mathrm{hs}}}{R_{\\mathrm{ref}}}\\right)^3 \\left(\\frac{\\tau}{\\tau_{\\mathrm{ref}}}\\right)^1$$\nWe can solve for the new yield, $Y$:\n$$Y = Y_{\\mathrm{ref}} \\left(\\frac{P_{\\mathrm{hs}}}{P_{\\mathrm{ref}}}\\right)^2 \\left(\\frac{R_{\\mathrm{hs}}}{R_{\\mathrm{ref}}}\\right)^3 \\left(\\frac{\\tau}{\\tau_{\\mathrm{ref}}}\\right)$$\nNow, we substitute the given values:\n- Reference shot: $Y_{\\mathrm{ref}}=1.9\\,\\mathrm{MJ}$, $P_{\\mathrm{ref}}=1.6\\times 10^{14}\\,\\mathrm{Pa}$, $R_{\\mathrm{ref}}=25\\,\\mu\\mathrm{m}$, $\\tau_{\\mathrm{ref}}=120\\,\\mathrm{ps}$.\n- New shot: $P_{\\mathrm{hs}}=2.1\\times 10^{14}\\,\\mathrm{Pa}$, $R_{\\mathrm{hs}}=30\\,\\mu\\mathrm{m}$, $\\tau=150\\,\\mathrm{ps}$.\n\nLet's calculate the ratios:\n$$ \\frac{P_{\\mathrm{hs}}}{P_{\\mathrm{ref}}} = \\frac{2.1\\times 10^{14}\\,\\mathrm{Pa}}{1.6\\times 10^{14}\\,\\mathrm{Pa}} = \\frac{2.1}{1.6} = 1.3125 $$\n$$ \\frac{R_{\\mathrm{hs}}}{R_{\\mathrm{ref}}} = \\frac{30\\,\\mu\\mathrm{m}}{25\\,\\mu\\mathrm{m}} = \\frac{30}{25} = 1.2 $$\n$$ \\frac{\\tau}{\\tau_{\\mathrm{ref}}} = \\frac{150\\,\\mathrm{ps}}{120\\,\\mathrm{ps}} = \\frac{150}{120} = 1.25 $$\nNow substitute these ratios into the equation for $Y$:\n$$ Y = (1.9\\,\\mathrm{MJ}) \\times (1.3125)^2 \\times (1.2)^3 \\times (1.25) $$\nWe calculate the value of each term:\n$$ (1.3125)^2 = 1.72265625 $$\n$$ (1.2)^3 = 1.728 $$\n$$ (1.25) = 1.25 $$\nMultiplying these together:\n$$ Y = (1.9) \\times (1.72265625) \\times (1.728) \\times (1.25) \\,\\mathrm{MJ} $$\n$$ Y = (1.9) \\times (1.72265625) \\times (2.16) \\,\\mathrm{MJ} $$\n$$ Y = (1.9) \\times (3.7209375) \\,\\mathrm{MJ} $$\n$$ Y = 7.06978125 \\,\\mathrm{MJ} $$\nThe problem requires the final answer to be rounded to three significant figures.\n$$ Y \\approx 7.07\\,\\mathrm{MJ} $$\nThe predicted fusion energy yield for the new shot is $7.07\\,\\mathrm{MJ}$.",
            "answer": "$$\n\\boxed{7.07}\n$$"
        },
        {
            "introduction": "Achieving the high pressures and temperatures necessary for ignition requires excellent thermal insulation of the hot spot. However, in the extreme gradients present in an ICF capsule, classical models of heat transport break down, making accurate modeling of energy losses a significant challenge. This practice delves into the physics of electron thermal conduction, demonstrating why the classical Spitzer-Härm theory can fail and motivating the use of a flux limiter, a crucial concept for understanding and simulating energy balance in ICF plasmas.",
            "id": "3715408",
            "problem": "In inertial confinement fusion (ICF), rapid electron heat transport from hot, low-density coronal plasma into colder, denser regions critically affects ablation dynamics and symmetry. Classical collisional transport predicts a conductive heat flux based on electron Coulomb collisions, while kinetic constraints impose an upper bound associated with free-streaming of energetic carriers.\n\nConsider a fully ionized, deuterium plasma in the ablation corona with electron temperature $T_{e} = 2.5\\ \\mathrm{keV}$, electron number density $n_{e} = 3.0 \\times 10^{26}\\ \\mathrm{m^{-3}}$, effective ionic charge state $Z = 1$, Coulomb logarithm $\\ln \\Lambda = 7.0$, and temperature scale length $L_{T} = 15\\ \\mathrm{\\mu m}$. The ion acoustic speed is taken as $c_{s} = \\sqrt{Z k_{B} T_{e} / m_{i}}$ with deuteron mass $m_{i} = 2 m_{p}$ and proton mass $m_{p}$. Treat the classical collisional electron heat flux in the Spitzer–Härm (classical) form $q_{\\mathrm{Spitzer}} = -\\kappa_{\\mathrm{SH}} \\nabla T_{e}$ with a conductivity consistent with Coulomb collisions, and treat the free-streaming bound as proportional to $n_{e} k_{B} T_{e} c_{s}$. Adopt a flux limiter that caps the conductive heat flux at a fraction $f = 0.06$ of this free-streaming bound whenever the classical prediction would exceed it. Use fundamental constants $k_{B}$ and $m_{p}$ in SI units.\n\nCompute the flux-limited electron heat flux $q_{e}$ in this scenario by comparing the classical collisional prediction to the flux-limited free-streaming bound and choosing the smaller value. Round your answer to three significant figures. Express the final heat flux in $\\mathrm{W\\,m^{-2}}$.",
            "solution": "The problem requires a comparison between the classical collisional prediction for electron heat flux and a kinetic flux-limited bound in a specified plasma environment. The physically realized heat flux is taken to be the lesser of these two values.\n\n**Theoretical Context**\nIn a hot plasma, heat is primarily transported by electrons due to their high mobility. Classical transport theory, developed by Spitzer and Härm, describes this process as a diffusive phenomenon driven by Coulomb collisions. The resulting heat flux, $q_{\\mathrm{Spitzer}}$, is proportional to the temperature gradient, $q_{\\mathrm{Spitzer}} = -\\kappa_{\\mathrm{SH}} \\nabla T_{e}$, where $\\kappa_{\\mathrm{SH}}$ is the classical thermal conductivity.\n\nThis classical model is derived under the assumption that the plasma is highly collisional. This assumption breaks down when the temperature gradient becomes very steep. A key parameter is the ratio of the electron mean free path, $\\lambda_{e}$, to the temperature scale length, $L_{T} = |T_{e}/\\nabla T_{e}|$. The electrons that dominate heat transport are in the high-energy tail of the distribution, and their mean free path scales strongly with energy (as $E^2$, or $v^4$). When $\\lambda_{e}$ for these energetic electrons becomes comparable to or larger than $L_{T}$, they can traverse the temperature gradient without undergoing enough collisions to locally deposit their energy. The fluid description fails, and the heat flux is no longer correctly described by the local temperature gradient.\n\nIn this \"non-local\" or kinetic regime, the heat flux saturates at a value determined by the rate at which electrons can physically \"free-stream\" across a surface. This gives rise to a kinetic heat flux limit, often called the free-streaming flux, $q_{\\mathrm{fs}}$. To bridge the collisional and kinetic regimes, a phenomenological flux limiter, $f$, is introduced. The magnitude of the heat flux, $q_e$, is then capped:\n$$q_{e} = \\min(|q_{\\mathrm{Spitzer}}|, f \\cdot q_{\\mathrm{fs}})$$\nHere, we will calculate both terms and determine the appropriate heat flux for the given conditions.\n\n**Step 1: Calculation of the Classical Spitzer-Härm Heat Flux, $|q_{\\mathrm{Spitzer}}|**$\nThe magnitude of the Spitzer-Härm heat flux is given by:\n$$|q_{\\mathrm{Spitzer}}| = \\kappa_{\\mathrm{SH}} |\\nabla T_{e}|$$\nThe temperature gradient magnitude is approximated using the temperature scale length, $L_{T}$:\n$$|\\nabla T_{e}| \\approx \\frac{T_{e}}{L_{T}}$$\nFor a fully ionized plasma with ionic charge $Z=1$, the standard Spitzer-Härm thermal conductivity is well-approximated by the formula:\n$$\\kappa_{\\mathrm{SH}} \\approx C_k \\frac{T_e^{5/2}}{\\ln \\Lambda}$$\nwhere $C_k \\approx 1.84 \\times 10^{-10} \\ \\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-7/2}$ and the electron temperature $T_e$ is in units of Kelvin.\n\nFirst, we convert the electron temperature from kilo-electron-volts to Kelvin.\n$T_{e} [\\mathrm{J}] = 2.5 \\ \\mathrm{keV} = 2.5 \\times 10^3 \\ \\mathrm{eV} \\times (1.602177 \\times 10^{-19} \\ \\mathrm{J/eV}) = 4.00544 \\times 10^{-16} \\ \\mathrm{J}$.\nUsing the Boltzmann constant $k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$:\n$$T_e [\\mathrm{K}] = \\frac{4.00544 \\times 10^{-16} \\ \\mathrm{J}}{1.380649 \\times 10^{-23} \\ \\mathrm{J/K}} \\approx 2.9012 \\times 10^7 \\ \\mathrm{K}$$\nNow, we calculate the conductivity $\\kappa_{\\mathrm{SH}}$:\n$$\\kappa_{\\mathrm{SH}} = (1.84 \\times 10^{-10}) \\frac{(2.9012 \\times 10^7)^{5/2}}{7.0} \\ \\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$$\n$$\\kappa_{\\mathrm{SH}} \\approx (1.84 \\times 10^{-10}) \\frac{4.432 \\times 10^{18}}{7.0} \\approx 1.166 \\times 10^8 \\ \\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$$\nNext, we calculate the magnitude of the classical heat flux:\n$$|q_{\\mathrm{Spitzer}}| = \\kappa_{\\mathrm{SH}} \\frac{T_{e}}{L_{T}} = (1.166 \\times 10^8 \\ \\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}) \\frac{2.9012 \\times 10^7 \\ \\mathrm{K}}{15 \\times 10^{-6} \\ \\mathrm{m}}$$\n$$|q_{\\mathrm{Spitzer}}| \\approx 2.256 \\times 10^{20} \\ \\mathrm{W \\cdot m^{-2}}$$\n\n**Step 2: Calculation of the Flux-Limited Bound, $q_{\\mathrm{lim}}$**\nThe problem specifies the flux-limited bound to be a fraction $f$ of a reference free-streaming flux, $q_{\\mathrm{fs}}$, which is taken to be proportional to $n_{e} k_{B} T_{e} c_{s}$. We assume a proportionality constant of unity.\n$$q_{\\mathrm{lim}} = f \\cdot q_{\\mathrm{fs}} = f \\cdot n_{e} (k_{B} T_{e}) c_{s}$$\nThe ion acoustic speed, $c_s$, is defined as:\n$$c_{s} = \\sqrt{\\frac{Z k_{B} T_{e}}{m_{i}}}$$\nGiven $Z = 1$ and $m_{i} = 2m_{p}$ with proton mass $m_{p} \\approx 1.67262 \\times 10^{-27} \\ \\mathrm{kg}$, we have $m_i \\approx 3.34524 \\times 10^{-27} \\ \\mathrm{kg}$. The thermal energy is $k_B T_e = 4.00544 \\times 10^{-16} \\ \\mathrm{J}$.\n$$c_{s} = \\sqrt{\\frac{1 \\cdot (4.00544 \\times 10^{-16} \\ \\mathrm{J})}{3.34524 \\times 10^{-27} \\ \\mathrm{kg}}} \\approx \\sqrt{1.19735 \\times 10^{11} \\ \\mathrm{m^2/s^2}} \\approx 3.460 \\times 10^5 \\ \\mathrm{m/s}$$\nNow we compute the flux-limited bound, $q_{\\mathrm{lim}}$, using the given values $f=0.06$ and $n_e = 3.0 \\times 10^{26} \\ \\mathrm{m^{-3}}$:\n$$q_{\\mathrm{lim}} = (0.06) \\cdot (3.0 \\times 10^{26} \\ \\mathrm{m^{-3}}) \\cdot (4.00544 \\times 10^{-16} \\ \\mathrm{J}) \\cdot (3.460 \\times 10^5 \\ \\mathrm{m/s})$$\n$$q_{\\mathrm{lim}} \\approx 2.495 \\times 10^{15} \\ \\mathrm{W \\cdot m^{-2}}$$\n\n**Step 3: Determination of the Flux-Limited Heat Flux, $q_e$**\nThe actual heat flux is the minimum of the classical prediction and the flux-limited bound:\n$$q_{e} = \\min(|q_{\\mathrm{Spitzer}}|, q_{\\mathrm{lim}})$$\nComparing the two calculated values:\n$$|q_{\\mathrm{Spitzer}}| \\approx 2.256 \\times 10^{20} \\ \\mathrm{W \\cdot m^{-2}}$$\n$$q_{\\mathrm{lim}} \\approx 2.495 \\times 10^{15} \\ \\mathrm{W \\cdot m^{-2}}$$\nIt is clear that $|q_{\\mathrm{Spitzer}}| \\gg q_{\\mathrm{lim}}$. The classical formula overestimates the heat flux by five orders of magnitude, confirming that the transport is deep in the flux-limited regime.\nTherefore, the effective heat flux is determined by the limit:\n$$q_{e} = q_{\\mathrm{lim}} \\approx 2.495 \\times 10^{15} \\ \\mathrm{W \\cdot m^{-2}}$$\nRounding the result to three significant figures as requested gives:\n$$q_{e} = 2.50 \\times 10^{15} \\ \\mathrm{W \\cdot m^{-2}}$$",
            "answer": "$$\\boxed{2.50 \\times 10^{15}}$$"
        },
        {
            "introduction": "Real-world ICF performance is a complex interplay of numerous physical processes, including hydrodynamic efficiency, fuel compressibility, and the growth of instabilities. To navigate this complexity, designers often rely on integrated \"surrogate\" models that capture the essential scaling of yield with key input parameters. This capstone exercise challenges you to build such a model and use it to perform a sensitivity analysis, providing a practical introduction to the methods used to identify the most critical factors that drive or limit fusion performance in a complex system.",
            "id": "3715367",
            "problem": "You are tasked with designing a numerical sensitivity study for Deuterium–Tritium (DT) capsule yield in Inertial Confinement Fusion (ICF). Your study must vary three parameters: implosion velocity $v_{\\mathrm{imp}}$ (in $\\mathrm{m/s}$), adiabat parameter $\\alpha$ (dimensionless), and the initial root-mean-square (RMS) fractional surface roughness amplitude $A_0$ (dimensionless). From first principles and well-tested relations, you must derive a simplified, self-consistent surrogate model for the fusion yield $Y$ as a function of these parameters and then compute numerical gradients of $Y$ with respect to each parameter using finite differences at specified operating points. All physical outputs must be provided in the requested units.\n\nDerive an explicit $Y(v_{\\mathrm{imp}},\\alpha,A_0)$ model starting from the following fundamental bases and physically motivated scalings. Do not shortcut to the final expression without demonstrating how the pieces connect:\n\n- Ram pressure scaling at stagnation: the stagnation pressure satisfies $p_{\\mathrm{stag}} \\propto \\rho_{\\mathrm{a}}\\, v_{\\mathrm{imp}}^2$, where $\\rho_{\\mathrm{a}}$ is a characteristic areal mass density. Ideal gas behavior relates hot-spot temperature to pressure via $p = n k_{\\mathrm{B}} T$, so, with appropriate closures, the hot-spot temperature inherits a quadratic dependence on $v_{\\mathrm{imp}}$. Higher adiabat $\\alpha$ reduces compressibility; a common proxy is a power-law penalty in $\\alpha$. Use the calibrated temperature scaling\n  $$T_{\\mathrm{hs}} = k_T\\, v_{\\mathrm{imp}}^2\\, \\alpha^{-1/2},$$\n  where $T_{\\mathrm{hs}}$ is measured in kilo-electronvolts (keV), $v_{\\mathrm{imp}}$ in $\\mathrm{m/s}$, and $k_T = 4.5\\times 10^{-11}\\ \\mathrm{keV}\\,\\mathrm{s}^2/\\mathrm{m}^2$.\n\n- Areal density scaling captures compressibility and in-flight convergence. Use\n  $$\\rho R = k_R \\left(\\frac{v_{\\mathrm{imp}}}{v_{\\mathrm{ref}}}\\right)^s \\alpha^{-1} \\max\\!\\left(0,\\,1-\\beta A_0\\right),$$\n  where $\\rho R$ is in $\\mathrm{kg/m^2}$, $k_R = 3.0\\ \\mathrm{kg/m^2}$, $v_{\\mathrm{ref}} = 3.0\\times 10^5\\ \\mathrm{m/s}$, $s=1$, and $\\beta=100$; the $\\max$ enforces non-negativity when roughness is severe.\n\n- The volumetric reactivity factor is modeled as a temperature power law over the relevant keV range:\n  $$g(T_{\\mathrm{hs}}) = \\left(\\frac{T_{\\mathrm{hs}}}{T_{\\mathrm{ref}}}\\right)^\\nu,\\quad T_{\\mathrm{ref}} = 5.0\\ \\mathrm{keV},\\ \\nu=4.$$\n\n- The burn fraction is modeled by an areal-density-limited law with temperature reactivity:\n  $$f_{\\mathrm{burn}} = 1 - \\exp\\!\\left(- C_b\\, g(T_{\\mathrm{hs}})\\, \\rho R \\right),\\quad C_b = 0.5\\ \\mathrm{m^2/kg}.$$\n\n- The fusion yield is proportional to the burned fuel fraction times the maximum chemical energy content of the fuel mass. Use a DT fuel mass of $0.20\\ \\mathrm{mg}$ and a specific DT fusion energy of $3.39\\times 10^{14}\\ \\mathrm{J/kg}$. Thus\n  $$Y = Y_{\\mathrm{scale}}\\, f_{\\mathrm{burn}},\\quad Y_{\\mathrm{scale}} = 6.78\\times 10^7\\ \\mathrm{J}.$$\n\nYour program must:\n- Implement the derived $Y(v_{\\mathrm{imp}},\\alpha,A_0)$ using the above bases and constants. All inputs must respect the physically meaningful domains: $v_{\\mathrm{imp}} > 0$ (in $\\mathrm{m/s}$), $\\alpha > 0$ (dimensionless), $A_0 \\in [0, A_{\\max})$ with $A_{\\max} = 0.01$ (dimensionless).\n- Compute the gradient of $Y$ with respect to $v_{\\mathrm{imp}}$, $\\alpha$, and $A_0$ at each test point using finite differences. Use a central difference\n  $$\\frac{\\partial Y}{\\partial p} \\approx \\frac{Y(p+h)-Y(p-h)}{2h}$$\n  with parameter-specific step sizes:\n  - For $v_{\\mathrm{imp}}$: $h_v = \\max\\!\\left(0.01\\, v_{\\mathrm{imp}},\\, 1.0\\times 10^3\\ \\mathrm{m/s}\\right)$.\n  - For $\\alpha$: $h_\\alpha = \\max\\!\\left(0.01\\, \\alpha,\\, 1.0\\times 10^{-3}\\right)$.\n  - For $A_0$: $h_A = \\max\\!\\left(0.1\\, A_0,\\, 1.0\\times 10^{-5}\\right)$.\n- If a central difference step would violate the domain (e.g., $A_0-h_A < 0$ or $A_0+h_A \\ge A_{\\max}$, or any step drives $\\alpha \\le 0$ or $v_{\\mathrm{imp}} \\le 0$), then automatically switch to a one-sided difference that respects the domain:\n  - Forward difference if the lower step is invalid:\n    $$\\frac{\\partial Y}{\\partial p} \\approx \\frac{Y(p+h)-Y(p)}{h}.$$\n  - Backward difference if the upper step is invalid:\n    $$\\frac{\\partial Y}{\\partial p} \\approx \\frac{Y(p)-Y(p-h)}{h}.$$\n\nTest suite:\n- Use the following five operating points $(v_{\\mathrm{imp}}, \\alpha, A_0)$:\n  1. $(4.0\\times 10^5\\ \\mathrm{m/s},\\ 2.0,\\ 1.0\\times 10^{-3})$\n  2. $(6.0\\times 10^5\\ \\mathrm{m/s},\\ 1.5,\\ 5.0\\times 10^{-4})$\n  3. $(2.0\\times 10^5\\ \\mathrm{m/s},\\ 3.5,\\ 2.0\\times 10^{-3})$\n  4. $(4.0\\times 10^5\\ \\mathrm{m/s},\\ 2.5,\\ 9.0\\times 10^{-3})$\n  5. $(3.5\\times 10^5\\ \\mathrm{m/s},\\ 2.0,\\ 0.0)$\n\nAnswer specification and units:\n- For each operating point, output a list of three floating-point numbers representing the gradient components\n  $$\\left[\\frac{\\partial Y}{\\partial v_{\\mathrm{imp}}},\\ \\frac{\\partial Y}{\\partial \\alpha},\\ \\frac{\\partial Y}{\\partial A_0}\\right],$$\n  with units $\\left[\\mathrm{J}\\cdot \\mathrm{s}/\\mathrm{m},\\ \\mathrm{J},\\ \\mathrm{J}\\right]$ respectively, since $\\alpha$ and $A_0$ are dimensionless. Express all values in $\\mathrm{J}$-based units as specified, in scientific notation with exactly six digits after the decimal point.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of the five gradient triples, each triple enclosed in square brackets, and the entire collection enclosed in square brackets. There must be no spaces anywhere in the output. Use scientific notation with six digits after the decimal point for each number. For example:\n  $$\\text{[[1.234567e+00,2.345678e+00,3.456789e+00],[...],...]}$$",
            "solution": "### 1. Derivation of the Fusion Yield Surrogate Model\n\nThe fusion yield $Y$ is a function of implosion velocity $v_{\\mathrm{imp}}$, adiabat $\\alpha$, and initial surface roughness $A_0$. The model is constructed by composing several physically motivated scaling relations.\n\nThe final yield $Y$ is given by the total available fusion energy $Y_{\\mathrm{scale}}$ multiplied by the burn fraction $f_{\\mathrm{burn}}$:\n$$Y = Y_{\\mathrm{scale}}\\, f_{\\mathrm{burn}}$$\nThe burn fraction $f_{\\mathrm{burn}}$ depends on the hot-spot reactivity, characterized by $g(T_{\\mathrm{hs}})$, and the confinement, captured by the areal density $\\rho R$:\n$$f_{\\mathrm{burn}} = 1 - \\exp\\!\\left(- C_b\\, g(T_{\\mathrm{hs}})\\, \\rho R \\right)$$\nwhere $C_b = 0.5\\ \\mathrm{m^2/kg}$ is a burn-up constant.\n\nThe reactivity factor $g(T_{\\mathrm{hs}})$ is a power-law approximation of the DT fusion cross-section over the relevant temperature range:\n$$g(T_{\\mathrm{hs}}) = \\left(\\frac{T_{\\mathrm{hs}}}{T_{\\mathrm{ref}}}\\right)^\\nu$$\nwith $T_{\\mathrm{ref}} = 5.0\\ \\mathrm{keV}$ and $\\nu=4$.\n\nThe hot-spot temperature $T_{\\mathrm{hs}}$ scales quadratically with implosion velocity and is penalized by the adiabat:\n$$T_{\\mathrm{hs}} = k_T\\, v_{\\mathrm{imp}}^2\\, \\alpha^{-1/2}$$\nwhere $k_T = 4.5\\times 10^{-11}\\ \\mathrm{keV}\\,\\mathrm{s}^2/\\mathrm{m}^2$. Substituting this into the reactivity expression gives $g$ as a function of the input parameters:\n$$g(v_{\\mathrm{imp}}, \\alpha) = \\left(\\frac{k_T\\, v_{\\mathrm{imp}}^2\\, \\alpha^{-1/2}}{T_{\\mathrm{ref}}}\\right)^\\nu = \\left(\\frac{k_T}{T_{\\mathrm{ref}}}\\right)^\\nu v_{\\mathrm{imp}}^{2\\nu} \\alpha^{-\\nu/2}$$\n\nThe compressed fuel areal density $\\rho R$ scales with implosion velocity, is inversely proportional to the adiabat, and is degraded by initial surface roughness $A_0$:\n$$\\rho R = k_R \\left(\\frac{v_{\\mathrm{imp}}}{v_{\\mathrm{ref}}}\\right)^s \\alpha^{-1} \\max\\!\\left(0,\\,1-\\beta A_0\\right)$$\nwhere $k_R = 3.0\\ \\mathrm{kg/m^2}$, $v_{\\mathrm{ref}} = 3.0\\times 10^5\\ \\mathrm{m/s}$, $s=1$, and $\\beta=100$. The $\\max$ function enforces that yield drops to zero if roughness is severe enough to disrupt the implosion ($A_0 \\ge 1/\\beta$).\n\nNow, we combine these expressions. Let the argument of the exponential in the burn fraction be $X$:\n$$X(v_{\\mathrm{imp}},\\alpha,A_0) = C_b\\, g(v_{\\mathrm{imp}}, \\alpha)\\, \\rho R(v_{\\mathrm{imp}},\\alpha,A_0)$$\nSubstituting the expressions for $g$ and $\\rho R$:\n$$X = C_b \\left[ \\left(\\frac{k_T}{T_{\\mathrm{ref}}}\\right)^\\nu v_{\\mathrm{imp}}^{2\\nu} \\alpha^{-\\nu/2} \\right] \\left[ k_R \\left(\\frac{v_{\\mathrm{imp}}}{v_{\\mathrm{ref}}}\\right)^s \\alpha^{-1} \\max\\!\\left(0,\\,1-\\beta A_0\\right) \\right]$$\nGrouping terms by parameter:\n$$X = \\left( C_b \\frac{k_R}{v_{\\mathrm{ref}}^s} \\left(\\frac{k_T}{T_{\\mathrm{ref}}}\\right)^\\nu \\right) \\cdot v_{\\mathrm{imp}}^{2\\nu+s} \\cdot \\alpha^{-(\\nu/2+1)} \\cdot \\max\\!\\left(0,\\,1-\\beta A_0\\right)$$\nWith the given constants $\\nu=4$ and $s=1$, the exponents become $2\\nu+s = 9$ and $-(\\nu/2+1) = -3$.\n\nThe final explicit form for the fusion yield is:\n$$Y(v_{\\mathrm{imp}},\\alpha,A_0) = Y_{\\mathrm{scale}} \\left( 1 - \\exp\\left( -X(v_{\\mathrm{imp}},\\alpha,A_0) \\right) \\right)$$\nwhere $Y_{\\mathrm{scale}} = 6.78\\times 10^7\\ \\mathrm{J}$.\n\n### 2. Numerical Gradient Calculation\n\nThe gradient of the yield, $\\nabla Y = \\left[\\frac{\\partial Y}{\\partial v_{\\mathrm{imp}}}, \\frac{\\partial Y}{\\partial \\alpha}, \\frac{\\partial Y}{\\partial A_0}\\right]$, is computed numerically at specified operating points $(v_{\\mathrm{imp}}, \\alpha, A_0)$. We use finite difference approximations for the partial derivatives.\n\nFor a generic parameter $p$, the default method is the second-order central difference:\n$$\\frac{\\partial Y}{\\partial p} \\approx \\frac{Y(p+h)-Y(p-h)}{2h}$$\nThe step size $h$ is parameter-dependent:\n- For $v_{\\mathrm{imp}}$: $h_v = \\max\\!\\left(0.01\\, v_{\\mathrm{imp}},\\, 1.0\\times 10^3\\ \\mathrm{m/s}\\right)$\n- For $\\alpha$: $h_\\alpha = \\max\\!\\left(0.01\\, \\alpha,\\, 1.0\\times 10^{-3}\\right)$\n- For $A_0$: $h_A = \\max\\!\\left(0.1\\, A_0,\\, 1.0\\times 10^{-5}\\right)$\n\nThe domains for the parameters are $v_{\\mathrm{imp}} \\in (0, \\infty)$, $\\alpha \\in (0, \\infty)$, and $A_0 \\in [0, 0.01)$. If a step $p \\pm h$ falls outside the valid domain, the method is adjusted to a first-order one-sided difference to ensure the function is only evaluated at valid points.\n\n- **Boundary Handling Logic:**\n  1.  If the lower point $p-h$ is outside the domain (i.e., $v_{\\mathrm{imp}}-h_v \\le 0$, $\\alpha-h_\\alpha \\le 0$, or $A_0-h_A < 0$), a forward difference is used:\n      $$\\frac{\\partial Y}{\\partial p} \\approx \\frac{Y(p+h)-Y(p)}{h}$$\n  2.  If the upper point $p+h$ is outside the domain (i.e., $A_0+h_A \\ge 0.01$), a backward difference is used:\n      $$\\frac{\\partial Y}{\\partial p} \\approx \\frac{Y(p)-Y(p-h)}{h}$$\n  3.  If both points are within the domain, the central difference is used. The case where both steps are invalid is assumed not to occur given the step size definitions.\n\nThis numerical scheme will be applied to each of the five test points to compute the required gradient vectors.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ICF yield sensitivity problem by implementing a surrogate model,\n    computing gradients via finite differences, and formatting the output.\n    \"\"\"\n\n    # --- Constants and Model Parameters ---\n    constants = {\n        'k_T': 4.5e-11,    # keV*s^2/m^2\n        'k_R': 3.0,        # kg/m^2\n        'v_ref': 3.0e5,    # m/s\n        's': 1.0,          # dimensionless\n        'beta': 100.0,     # dimensionless\n        'T_ref': 5.0,      # keV\n        'nu': 4.0,         # dimensionless\n        'C_b': 0.5,        # m^2/kg\n        'Y_scale': 6.78e7, # J\n        'A_max': 0.01      # dimensionless\n    }\n\n    def calculate_yield(v_imp, alpha, A0, consts):\n        \"\"\"\n        Calculates the fusion yield Y based on the surrogate model.\n        Args:\n            v_imp (float): Implosion velocity in m/s.\n            alpha (float): Adiabat parameter, dimensionless.\n            A0 (float): Initial RMS fractional surface roughness, dimensionless.\n            consts (dict): Dictionary of physical constants.\n        Returns:\n            float: Fusion yield in Joules.\n        \"\"\"\n        # --- Parameter Domain Enforcement ---\n        if v_imp <= 0 or alpha <= 0 or A0 < 0 or A0 >= consts['A_max']:\n            return 0.0\n\n        # --- Step 1: Hot-spot Temperature ---\n        T_hs = consts['k_T'] * (v_imp**2) * (alpha**(-0.5))\n\n        # --- Step 2: Areal Density ---\n        rho_R_factor = 1.0 - consts['beta'] * A0\n        rho_R = consts['k_R'] * (v_imp / consts['v_ref'])**consts['s'] * \\\n                alpha**(-1.0) * np.max([0.0, rho_R_factor])\n\n        # --- Step 3: Reactivity Factor ---\n        g_T_hs = (T_hs / consts['T_ref'])**consts['nu']\n\n        # --- Step 4: Burn Fraction ---\n        exponent_arg = consts['C_b'] * g_T_hs * rho_R\n        f_burn = 1.0 - np.exp(-exponent_arg)\n\n        # --- Step 5: Fusion Yield ---\n        yield_val = consts['Y_scale'] * f_burn\n        \n        return yield_val\n\n    # --- Test Suite ---\n    test_cases = [\n        (4.0e5, 2.0, 1.0e-3),\n        (6.0e5, 1.5, 5.0e-4),\n        (2.0e5, 3.5, 2.0e-3),\n        (4.0e5, 2.5, 9.0e-3),\n        (3.5e5, 2.0, 0.0)\n    ]\n    \n    results = []\n\n    for v_imp, alpha, A0 in test_cases:\n        grad_vector = []\n        Y_center = calculate_yield(v_imp, alpha, A0, constants)\n\n        # --- Partial derivative with respect to v_imp ---\n        h_v = np.max([0.01 * v_imp, 1.0e3])\n        v_minus = v_imp - h_v\n        v_plus = v_imp + h_v\n\n        if v_minus <= 0: # Forward difference\n            Y_plus = calculate_yield(v_plus, alpha, A0, constants)\n            dY_dv = (Y_plus - Y_center) / h_v\n        else: # Central difference (no upper bound for v_imp)\n            Y_minus = calculate_yield(v_minus, alpha, A0, constants)\n            Y_plus = calculate_yield(v_plus, alpha, A0, constants)\n            dY_dv = (Y_plus - Y_minus) / (2 * h_v)\n        grad_vector.append(dY_dv)\n        \n        # --- Partial derivative with respect to alpha ---\n        h_alpha = np.max([0.01 * alpha, 1.0e-3])\n        alpha_minus = alpha - h_alpha\n        alpha_plus = alpha + h_alpha\n        \n        if alpha_minus <= 0: # Forward difference\n            Y_plus = calculate_yield(v_imp, alpha_plus, A0, constants)\n            dY_dalpha = (Y_plus - Y_center) / h_alpha\n        else: # Central difference (no upper bound for alpha)\n            Y_minus = calculate_yield(v_imp, alpha_minus, A0, constants)\n            Y_plus = calculate_yield(v_imp, alpha_plus, A0, constants)\n            dY_dalpha = (Y_plus - Y_minus) / (2 * h_alpha)\n        grad_vector.append(dY_dalpha)\n\n        # --- Partial derivative with respect to A0 ---\n        h_A = np.max([0.1 * A0, 1.0e-5])\n        A0_minus = A0 - h_A\n        A0_plus = A0 + h_A\n        \n        lower_invalid = A0_minus < 0\n        upper_invalid = A0_plus >= constants['A_max']\n\n        if lower_invalid: # Forward difference\n            Y_plus = calculate_yield(v_imp, alpha, A0_plus, constants)\n            dY_dA0 = (Y_plus - Y_center) / h_A\n        elif upper_invalid: # Backward difference\n            Y_minus = calculate_yield(v_imp, alpha, A0_minus, constants)\n            dY_dA0 = (Y_center - Y_minus) / h_A\n        else: # Central difference\n            Y_minus = calculate_yield(v_imp, alpha, A0_minus, constants)\n            Y_plus = calculate_yield(v_imp, alpha, A0_plus, constants)\n            dY_dA0 = (Y_plus - Y_minus) / (2 * h_A)\n        grad_vector.append(dY_dA0)\n        \n        results.append(grad_vector)\n\n    # --- Format and Print Final Output ---\n    formatted_gradients = []\n    for grad in results:\n        formatted_vector = \",\".join([f\"{g:.6e}\" for g in grad])\n        formatted_gradients.append(f\"[{formatted_vector}]\")\n    \n    final_output = f\"[{','.join(formatted_gradients)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}