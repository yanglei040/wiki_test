{
    "hands_on_practices": [
        {
            "introduction": "For chirping to occur, energetic particles must remain coherently trapped in the wave's potential for multiple bounce periods. This practice explores the fundamental physics governing this trapping by deriving the bounce frequency from first principles. By comparing the bounce timescale to disruptive timescales, such as wave growth and collisional scattering, you will formulate a criterion to determine when coherent chirping is suppressed .",
            "id": "3698536",
            "problem": "Consider a simplified single-resonance model for energetic particle (EP) interaction with a single electrostatic mode in a magnetized fusion plasma. Assume the mode has electric field $E(x,t)=E_{0}\\sin(kx-\\omega t)$ and phase velocity $v_{\\mathrm{ph}}=\\omega/k$. A resonant EP with charge number $Z$ and mass $m$ interacts nonlinearly with the wave via the Lorentz force. The mode grows in time with linear growth rate $\\gamma$ (so that the mode envelope varies as $\\exp(\\gamma t)$), and the EPs experience an enhanced effective pitch-angle scattering rate $\\nu_{\\mathrm{eff}}$ due to microturbulence. Assume that near resonance the dynamics reduce to a one-degree-of-freedom pendulum in the wave frame.\n\nStarting from first principles, use the Lorentz force law and the definition of the wave phase $\\psi \\equiv kx-\\omega t$ to derive the nonlinear bounce frequency $\\omega_{B}$ for trapped resonant particles in terms of $Z$, $e$, $m$, $k$, and $E_{0}$. Then, using a timescale-based adiabaticity argument for the bounce action of trapped particles, formulate a conservative chirping-suppression criterion that combines the amplitude-evolution rate $\\gamma$ and the effective scattering rate $\\nu_{\\mathrm{eff}}$. Using that criterion, determine the minimum $\\nu_{\\mathrm{eff}}$ required to suppress chirping for the following parameters:\n- singly-charged EPs with $Z=1$ and $m=3.345\\times 10^{-27}\\ \\mathrm{kg}$,\n- wavenumber $k=30\\ \\mathrm{m}^{-1}$,\n- electric-field amplitude $E_{0}=50\\ \\mathrm{V/m}$,\n- linear growth rate $\\gamma=5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$,\n- elementary charge $e=1.602\\,176\\,634\\times 10^{-19}\\ \\mathrm{C}$.\n\nRound your final answer for the required $\\nu_{\\mathrm{eff}}$ to four significant figures. Express the final answer in $\\mathrm{s}^{-1}$.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of plasma physics and classical mechanics, specifically the theory of resonant wave-particle interactions. The problem is well-posed, providing all necessary definitions, variables, and constants for a unique, meaningful solution. The language is objective and the parameters are physically plausible for a fusion plasma environment.\n\nThe solution proceeds in three stages: first, the derivation of the nonlinear bounce frequency $\\omega_{B}$; second, the formulation of a chirping-suppression criterion; and third, the calculation of the minimum required effective scattering rate $\\nu_{\\mathrm{eff}}$.\n\nFirst, we derive the bounce frequency $\\omega_{B}$. The motion of an energetic particle (EP) with charge $q=Ze$ and mass $m$ in a one-dimensional electrostatic field $E(x,t)$ is governed by Newton's second law with the Lorentz force:\n$$m\\frac{d^2x}{dt^2} = F = (Ze)E(x,t)$$\nThe electric field of the mode is given as $E(x,t)=E_{0}\\sin(kx-\\omega t)$. The problem defines the wave phase as $\\psi \\equiv kx-\\omega t$. We seek an equation of motion for $\\psi$. Differentiating $\\psi$ twice with respect to time $t$ yields:\n$$\\frac{d\\psi}{dt} = k\\frac{dx}{dt} - \\omega$$\n$$\\frac{d^2\\psi}{dt^2} = k\\frac{d^2x}{dt^2}$$\nSubstituting the equation of motion for $\\ddot{x}$ into the equation for $\\ddot{\\psi}$:\n$$\\frac{d^2\\psi}{dt^2} = k \\left(\\frac{ZeE_0}{m}\\sin(kx-\\omega t)\\right) = \\frac{kZeE_0}{m}\\sin(\\psi)$$\nThis equation describes the dynamics of the phase $\\psi$ relative to the wave. For deeply trapped particles, their motion corresponds to small oscillations around the stable fixed points of this dynamical system. The fixed points occur where $\\ddot{\\psi}=0$, which implies $\\sin(\\psi)=0$, or $\\psi = n\\pi$ for any integer $n$.\n\nTo determine stability, we linearize the equation around these fixed points. Let $\\psi = n\\pi + \\delta\\psi$, where $\\delta\\psi$ is a small perturbation.\n$$\\frac{d^2(\\delta\\psi)}{dt^2} = \\frac{kZeE_0}{m}\\sin(n\\pi + \\delta\\psi) = \\frac{kZeE_0}{m}(\\sin(n\\pi)\\cos(\\delta\\psi) + \\cos(n\\pi)\\sin(\\delta\\psi))$$\nUsing $\\sin(n\\pi)=0$ and $\\cos(n\\pi)=(-1)^n$, and the small-angle approximation $\\sin(\\delta\\psi) \\approx \\delta\\psi$:\n$$\\frac{d^2(\\delta\\psi)}{dt^2} \\approx (-1)^n \\frac{kZeE_0}{m} \\delta\\psi$$\nFor stable oscillations, the right-hand side must provide a restoring force, meaning the coefficient of $\\delta\\psi$ must be negative. This occurs for odd integers $n$ (e.g., $n=1, 3, ...$), where $(-1)^n = -1$.\nThe equation for small oscillations around a stable equilibrium point (the bottom of the potential well) is:\n$$\\frac{d^2(\\delta\\psi)}{dt^2} = -\\left(\\frac{kZeE_0}{m}\\right)\\delta\\psi$$\nThis is the equation for a simple harmonic oscillator, $\\ddot{y} = -\\omega^2 y$, with an angular frequency that is defined as the bounce frequency $\\omega_B$. By comparison, we identify the square of the bounce frequency as:\n$$\\omega_B^2 = \\frac{kZeE_0}{m}$$\nTherefore, the nonlinear bounce frequency for deeply trapped particles is:\n$$\\omega_B = \\sqrt{\\frac{kZeE_0}{m}}$$\n\nSecond, we formulate a chirping-suppression criterion. Chirping is a coherent nonlinear phenomenon where particles remain trapped in the potential wells of the wave for many bounce periods. The characteristic timescale for this coherent motion is the bounce period, $T_B \\sim 1/\\omega_B$. Chirping is suppressed if this coherence is broken by processes that occur on a timescale comparable to or faster than the bounce period.\nThe problem provides two such processes:\n$1$. The wave amplitude grows at a linear rate $\\gamma$. This means the depth of the potential well, and thus the bounce frequency $\\omega_B$ itself, changes on a timescale of $1/\\gamma$. If this change is too rapid ($\\gamma \\gtrsim \\omega_B$), the particle motion can no longer be considered adiabatic, breaking the phase-locking required for chirping.\n$2$. Particles are scattered by microturbulence, with an effective rate $\\nu_{\\mathrm{eff}}$. This is a random process that diffuses particles in phase space, kicking them out of the trapping region. If the timescale for scattering, $1/\\nu_{\\mathrm{eff}}$, is shorter than the bounce period ($\\nu_{\\mathrm{eff}} \\gtrsim \\omega_B$), trapping is destroyed.\n\nA conservative, timescale-based criterion for the suppression of chirping is that the combined rate of these disruptive effects must equal or exceed the bounce frequency. We can express this threshold condition as:\n$$\\gamma + \\nu_{\\mathrm{eff}} \\geq \\omega_B$$\nThe problem asks for the minimum $\\nu_{\\mathrm{eff}}$ required to suppress chirping. This corresponds to the equality at the threshold:\n$$\\nu_{\\mathrm{eff, min}} = \\omega_B - \\gamma$$\nThis expression is valid if $\\omega_B > \\gamma$. If $\\omega_B \\leq \\gamma$, the rapid wave growth is sufficient on its own to disrupt the adiabatic trapping, so the minimum required scattering rate would be $\\nu_{\\mathrm{eff, min}}=0$. The full criterion is therefore $\\nu_{\\mathrm{eff, min}} = \\max(0, \\omega_B - \\gamma)$.\n\nThird, we calculate the minimum required $\\nu_{\\mathrm{eff}}$ using the given parameters:\n- Charge number: $Z=1$\n- Mass: $m=3.345\\times 10^{-27}\\ \\mathrm{kg}$\n- Wavenumber: $k=30\\ \\mathrm{m}^{-1}$\n- Electric-field amplitude: $E_{0}=50\\ \\mathrm{V/m}$\n- Elementary charge: $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$\n- Linear growth rate: $\\gamma=5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$\n\nFirst, we calculate the bounce frequency $\\omega_B$:\n$$\\omega_B = \\sqrt{\\frac{kZeE_0}{m}} = \\sqrt{\\frac{(30\\ \\mathrm{m}^{-1})(1)(1.602176634\\times 10^{-19}\\ \\mathrm{C})(50\\ \\mathrm{V/m})}{3.345\\times 10^{-27}\\ \\mathrm{kg}}}$$\nThe term in the numerator is $kZeE_0 = (30)(1)(1.602176634\\times 10^{-19})(50) \\approx 2.403265 \\times 10^{-16}\\ \\mathrm{N}$.\n$$\\omega_B^2 = \\frac{2.403265 \\times 10^{-16}\\ \\mathrm{N}}{3.345\\times 10^{-27}\\ \\mathrm{kg}} \\approx 7.18464858 \\times 10^{10}\\ \\mathrm{s}^{-2}$$\n$$\\omega_B = \\sqrt{7.18464858 \\times 10^{10}\\ \\mathrm{s}^{-2}} \\approx 2.68041948 \\times 10^5\\ \\mathrm{s}^{-1}$$\nNow we compare $\\omega_B$ with $\\gamma$:\n$\\omega_B \\approx 2.680 \\times 10^5\\ \\mathrm{s}^{-1}$ and $\\gamma = 5.0 \\times 10^4\\ \\mathrm{s}^{-1} = 0.5 \\times 10^5\\ \\mathrm{s}^{-1}$.\nSince $\\omega_B > \\gamma$, additional scattering is required for suppression. We use the formula $\\nu_{\\mathrm{eff, min}} = \\omega_B - \\gamma$:\n$$\\nu_{\\mathrm{eff, min}} \\approx (2.68041948 \\times 10^5\\ \\mathrm{s}^{-1}) - (5.0 \\times 10^4\\ \\mathrm{s}^{-1})$$\n$$\\nu_{\\mathrm{eff, min}} \\approx 2.18041948 \\times 10^5\\ \\mathrm{s}^{-1}$$\nRounding the result to four significant figures as requested:\n$$\\nu_{\\mathrm{eff, min}} \\approx 2.180 \\times 10^5\\ \\mathrm{s}^{-1}$$",
            "answer": "$$\\boxed{2.180 \\times 10^{5}}$$"
        },
        {
            "introduction": "When a wave's frequency chirps, it can effectively \"drag\" resonant particles across the plasma, a mechanism often likened to a conveyor belt. This computational exercise allows you to directly model this process by simulating the capture and adiabatic transport of particles by a moving resonance. By calculating the resulting particle loss fraction, you will gain a tangible understanding of how chirping dynamics can impact energetic particle confinement .",
            "id": "3698493",
            "problem": "Consider a large-aspect-ratio, axisymmetric tokamak in normalized, dimensionless units. Let the minor radius be normalized to unity so that the radial coordinate $r$ satisfies $r \\in [0,1]$. Consider a single shear Alfvén eigenmode (AE) interacting with energetic guiding-center particles. Assume a simplified large-aspect-ratio, bounce-averaged resonance condition in which the bounce-averaged precession frequency depends monotonically on radius as a linear function\n$$\n\\omega_{\\mathrm{res}}(r) = \\omega_{\\mathrm{base}} + \\beta r,\n$$\nwhere $\\omega_{\\mathrm{base}}$ and $\\beta$ are constants (dimensionless in the chosen normalization). The mode frequency $\\omega(t)$ chirps over a prescribed discrete sequence of times $\\{t_k\\}$, producing a sequence $\\{\\omega_k\\}$. For each discrete time, define the resonant center radius $r_{\\mathrm{c},k}$ implicitly by solving the resonance condition\n$$\n\\omega_{\\mathrm{res}}(r_{\\mathrm{c},k}) = \\omega_k,\n$$\nso that\n$$\nr_{\\mathrm{c},k} = \\frac{\\omega_k - \\omega_{\\mathrm{base}}}{\\beta}.\n$$\n\nNear resonance, model the interaction in action-angle variables with an effective pendulum Hamiltonian whose island half-width in the action coordinate, mapped here to the normalized radius $r$, scales as a function of the mode amplitude $A$ and the frequency shear $\\beta$. In the adopted normalization, treat the island half-width as\n$$\nw = 2\\sqrt{\\frac{A}{|\\beta|}}.\n$$\nAssume adiabatic chirping such that particles initially inside the island are transported with the island center as it moves in radius. Specifically, let $r_0$ be the initial radius of a guiding-center particle. If there exists an index $j$ at which the particle is inside the island, quantified by\n$$\n|r_0 - r_{\\mathrm{c},j}| \\leq w \\quad \\text{and} \\quad r_{\\mathrm{c},j} \\in [0,1],\n$$\nthen the particle is captured at step $j$ and, in the adiabatic limit, its final radius is\n$$\nr_{\\mathrm{final}} = r_0 + \\left(r_{\\mathrm{c},K} - r_{\\mathrm{c},j}\\right),\n$$\nwhere $K$ is the index of the last chirp step. If there is no such capture index $j$, take $r_{\\mathrm{final}} = r_0$.\n\nA particle is counted as lost if $r_{\\mathrm{final}} \\geq r_{\\mathrm{loss}}$, where the loss boundary is the plasma edge $r_{\\mathrm{loss}} = 1$. Consider a deterministic, evenly spaced initial set of $N$ particles with radii\n$$\nr_i = \\frac{i}{N-1}, \\quad i=0,1,\\dots,N-1,\n$$\nuniformly spanning $[0,1]$. The edge loss fraction is defined as\n$$\nf_{\\mathrm{loss}} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\mathbf{1}\\left(r_{\\mathrm{final},i} \\geq 1\\right),\n$$\nwhere $\\mathbf{1}(\\cdot)$ is the indicator function.\n\nStarting only from the above definitions and the fundamental resonance principle, derive the discrete mapping algorithm implied by the adiabatic trapping assumption and implement a program that computes the edge loss fraction $f_{\\mathrm{loss}}$ for each of the following test cases. All quantities are dimensionless in this problem. Express the final edge loss fractions as decimal numbers rounded to six decimal places.\n\nUse $N=101$ and $r_{\\mathrm{loss}}=1$ for all cases. The test suite is:\n\n- Case 1 (outward chirp, moderate amplitude):\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.2$\n  - Chirp sequence $\\{\\omega_k\\} = [0.4, 0.6, 0.8, 1.0]$\n  - $A = 0.04$\n\n- Case 2 (boundary-touching chirp, small amplitude):\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.0$\n  - Chirp sequence $\\{\\omega_k\\} = [0.4, 0.65, 0.95]$\n  - $A = 0.0025$\n\n- Case 3 (no chirp, finite amplitude):\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.2$\n  - Chirp sequence $\\{\\omega_k\\} = [0.6, 0.6, 0.6]$\n  - $A = 0.04$\n\n- Case 4 (final resonance beyond edge, modest amplitude near edge):\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.0$\n  - Chirp sequence $\\{\\omega_k\\} = [0.8, 1.05]$\n  - $A = 0.01$\n\nYour program should produce a single line of output containing the results as a comma-separated list of the four loss fractions enclosed in square brackets (for example, \"[0.123456,0.000000,0.010000,0.250000]\").",
            "solution": "The problem RCM-2023-010 is subjected to validation.\n\n### Step 1: Extract Givens\n\n- Normalization: Large-aspect-ratio, axisymmetric tokamak. Minor radius normalized to unity, $r \\in [0,1]$.\n- Resonance Condition: The bounce-averaged precession frequency is $\\omega_{\\mathrm{res}}(r) = \\omega_{\\mathrm{base}} + \\beta r$, where $\\omega_{\\mathrm{base}}$ and $\\beta$ are constants.\n- Mode Frequency: A discrete sequence of mode frequencies $\\{\\omega_k\\}$ at times $\\{t_k\\}$. The last index is denoted by $K$.\n- Resonant Center Radius: At each time step $k$, the resonant center $r_{\\mathrm{c},k}$ is defined by $\\omega_{\\mathrm{res}}(r_{\\mathrm{c},k}) = \\omega_k$, which gives $r_{\\mathrm{c},k} = \\frac{\\omega_k - \\omega_{\\mathrm{base}}}{\\beta}$.\n- Island Half-Width: $w = 2\\sqrt{\\frac{A}{|\\beta|}}$, where $A$ is the mode amplitude.\n- Particle Capture Condition: A particle at initial radius $r_0$ is captured at step $j$ if it is the first such step where $|r_0 - r_{\\mathrm{c},j}| \\leq w$ and the resonance is physically within the plasma, $r_{\\mathrm{c},j} \\in [0,1]$.\n- Adiabatic Transport Rule: If captured at step $j$, the particle's final radius is $r_{\\mathrm{final}} = r_0 + \\left(r_{\\mathrm{c},K} - r_{\\mathrm{c},j}\\right)$. If never captured, $r_{\\mathrm{final}} = r_0$. In the problem notation, $K$ is the index of the last chirp step. For a zero-indexed sequence of length $L$, $K = L-1$.\n- Particle Loss Condition: A particle is lost if $r_{\\mathrm{final}} \\geq r_{\\mathrm{loss}}$, with $r_{\\mathrm{loss}} = 1$.\n- Initial Particle Distribution: $N$ particles with initial radii $r_i = \\frac{i}{N-1}$ for $i=0,1,\\dots,N-1$.\n- Edge Loss Fraction: $f_{\\mathrm{loss}} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\mathbf{1}\\left(r_{\\mathrm{final},i} \\geq 1\\right)$.\n- Global Parameters: $N=101$, $r_{\\mathrm{loss}}=1$.\n- Test Cases:\n    1. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.2$, $\\{\\omega_k\\} = [0.4, 0.6, 0.8, 1.0]$, $A = 0.04$.\n    2. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.0$, $\\{\\omega_k\\} = [0.4, 0.65, 0.95]$, $A = 0.0025$.\n    3. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.2$, $\\{\\omega_k\\} = [0.6, 0.6, 0.6]$, $A = 0.04$.\n    4. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.0$, $\\{\\omega_k\\} = [0.8, 1.05]$, $A = 0.01$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is a well-defined computational physics exercise based on a simplified but standard model of wave-particle interaction in plasmas.\n- **Scientifically Grounded**: The concepts of Alfvén eigenmodes, frequency chirping, resonance conditions, island formation in phase space, and adiabatic transport are all cornerstone principles in the study of energetic particle confinement in tokamaks. The specific functional forms ($\\omega_{\\mathrm{res}}(r)$ as linear, $w \\propto \\sqrt{A}$) are valid simplifications commonly used in theoretical models. The problem is scientifically sound.\n- **Well-Posed**: All necessary parameters, initial conditions, and dynamic rules are explicitly provided. The rule for determining the final particle position is deterministic, ensuring a unique solution for the loss fraction exists. The \"first capture\" interpretation of the condition \"If there exists an index $j$\" is the only physically and logically sound one, as a particle, once trapped, remains trapped.\n- **Objective**: The problem is stated in precise, mathematical language, free from subjective or ambiguous terminology.\n\nNo flaws listed in the validation criteria are present. The problem is self-contained, consistent, and formalizable.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A solution will be developed.\n\n### Solution Derivation\n\nThe objective is to compute the edge loss fraction, $f_{\\mathrm{loss}}$, for a given set of initial particles subjected to the influence of a chirping Alfvén eigenmode. The solution is algorithmic, following the physical model described.\n\n**1. System Initialization**\nFor each test case, the physical system is defined by the parameters $\\beta$, $\\omega_{\\mathrm{base}}$, the mode frequency sequence $\\{\\omega_k\\}$, and the mode amplitude $A$. The simulation constants are $N=101$ particles and a loss boundary at $r_{\\mathrm{loss}}=1$. The initial particle distribution is a uniform grid of $N$ points on the interval $[0,1]$, given by $r_i = i/(N-1)$ for $i \\in \\{0, 1, \\dots, N-1\\}$.\n\n**2. Calculation of Mode Properties**\nThe algorithm requires two key properties of the mode at each discrete time step $k$.\n- **Resonant Center Radius ($r_{\\mathrm{c},k}$)**: The location in space where particles are resonant with the mode. It is calculated for each frequency $\\omega_k$ in the chirp sequence.\n  $$\n  r_{\\mathrm{c},k} = \\frac{\\omega_k - \\omega_{\\mathrm{base}}}{\\beta}\n  $$\n- **Island Half-Width ($w$)**: The radial extent of the trapping region around the resonant center. It depends on the mode amplitude $A$ and the shear $\\beta$, but is constant in time as $A$ and $\\beta$ are given as constants.\n  $$\n  w = 2\\sqrt{\\frac{A}{|\\beta|}}\n  $$\n\n**3. Adiabatic Transport Algorithm**\nFor each of the $N$ initial particles, we must determine its final radius, $r_{\\mathrm{final}}$. This involves iterating through the time sequence of the mode.\n\nLet $L$ be the number of elements in the frequency sequence $\\{\\omega_k\\}$. The indices run from $k=0$ to $k=L-1$. For each initial particle radius $r_0$ from the set $\\{r_i\\}$:\n- Initialize a capture index $j = -1$ (or any sentinel value indicating \"not captured\").\n- Iterate through the time steps $k = 0, 1, \\dots, L-1$.\n  - At each step $k$, calculate $r_{\\mathrm{c},k}$.\n  - Check the two conditions for particle capture:\n    1. The resonance must be within the plasma domain: $0 \\leq r_{\\mathrm{c},k} \\leq 1$.\n    2. The particle must be within the island: $|r_0 - r_{\\mathrm{c},k}| \\leq w$.\n  - If both conditions are met, the particle is captured at this step. We set $j=k$ and immediately exit this inner loop, as the problem specifies capture at the first such instance.\n- After checking all time steps, the particle's final radius $r_{\\mathrm{final}}$ is determined.\n  - If the particle was captured (i.e., $j \\neq -1$), it is transported adiabatically. Its final radius is its initial radius plus the total displacement of the resonant center from the point of capture to the final time. Let $r_{\\mathrm{c},j}$ be the resonant radius at capture and $r_{\\mathrm{c},L-1}$ be the resonant radius at the final step.\n    $$\n    r_{\\mathrm{final}} = r_0 + (r_{\\mathrm{c},L-1} - r_{\\mathrm{c},j})\n    $$\n  - If the particle was never captured (i.e., $j$ remains $-1$), its radius is unchanged.\n    $$\n    r_{\\mathrm{final}} = r_0\n    $$\n\n**4. Loss Fraction Calculation**\nAfter calculating the final radius $r_{\\mathrm{final},i}$ for every initial particle $r_i$, we count the number of lost particles.\n- Initialize `lost_particle_count` to $0$.\n- For each particle $i=0, \\dots, N-1$:\n  - If $r_{\\mathrm{final},i} \\geq r_{\\mathrm{loss}}$ (where $r_{\\mathrm{loss}}=1$), increment `lost_particle_count`.\n- The final edge loss fraction is the ratio of lost particles to the total number of particles.\n  $$\n  f_{\\mathrm{loss}} = \\frac{\\text{lost\\_particle\\_count}}{N}\n  $$\nThe result for each test case is this value, formatted as a decimal number rounded to six places. This procedure is deterministic and directly implements the physics specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the particle transport problem for all specified test cases and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (outward chirp, moderate amplitude)\n        {'beta': 1.0, 'omega_base': 0.2, 'omega_k': [0.4, 0.6, 0.8, 1.0], 'A': 0.04},\n        # Case 2 (boundary-touching chirp, small amplitude)\n        {'beta': 1.0, 'omega_base': 0.0, 'omega_k': [0.4, 0.65, 0.95], 'A': 0.0025},\n        # Case 3 (no chirp, finite amplitude)\n        {'beta': 1.0, 'omega_base': 0.2, 'omega_k': [0.6, 0.6, 0.6], 'A': 0.04},\n        # Case 4 (final resonance beyond edge, modest amplitude near edge)\n        {'beta': 1.0, 'omega_base': 0.0, 'omega_k': [0.8, 1.05], 'A': 0.01}\n    ]\n\n    # Global parameters for all cases\n    N = 101\n    r_loss = 1.0\n\n    # Generate the initial distribution of particle radii\n    initial_radii = np.linspace(0.0, 1.0, N)\n\n    results = []\n    for case in test_cases:\n        beta = case['beta']\n        omega_base = case['omega_base']\n        omega_k = np.array(case['omega_k'])\n        A = case['A']\n\n        # Calculate the island half-width (constant for the duration of the chirp)\n        w = 2.0 * np.sqrt(A / abs(beta))\n\n        # Calculate the sequence of resonant center radii\n        r_c_sequence = (omega_k - omega_base) / beta\n        \n        lost_particle_count = 0\n        \n        # Iterate over each particle\n        for r0 in initial_radii:\n            capture_index = -1\n            \n            # Check for capture at each time step\n            for k, r_c_k in enumerate(r_c_sequence):\n                # Capture condition: resonance must be inside the plasma\n                if 0.0 = r_c_k = 1.0:\n                    # Capture condition: particle must be within the island\n                    if abs(r0 - r_c_k) = w:\n                        capture_index = k\n                        break  # Particle is captured at the first available opportunity\n\n            # Determine the final radius of the particle\n            r_final = r0\n            if capture_index != -1:\n                r_c_capture = r_c_sequence[capture_index]\n                r_c_final = r_c_sequence[-1]\n                r_final = r0 + (r_c_final - r_c_capture)\n\n            # Check if the particle is lost\n            if r_final = r_loss:\n                lost_particle_count += 1\n        \n        # Calculate the edge loss fraction\n        f_loss = lost_particle_count / N\n        \n        # Format the result to six decimal places and append to the list\n        results.append(f\"{f_loss:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The interaction between waves and particles is self-regulating; as particles are trapped, they flatten the distribution function gradient that drives the wave. This exercise delves into this crucial feedback mechanism by modeling the formation of a \"plateau\" in phase space due to a resonant island. You will quantify both the immediate reduction in the instability drive and the characteristic time it takes for diffusion to restore the gradient after a chirp .",
            "id": "3698507",
            "problem": "Consider a single, coherent, shear-Alfvénic mode interacting resonantly with an energetic ion population in a toroidal fusion plasma. Use angle-action variables $(\\theta, I)$ for the resonant degree of freedom, where $I$ is a canonical action normalized to a dimensionless unit and $\\theta$ is the corresponding canonical angle. Let the unperturbed Hamiltonian be $H_{0}(I)$ with mode-particle resonance at $I = I_{r}$ and frequency $\\omega$, and suppose the perturbation is a single-harmonic mode described near resonance by $H_{1}(\\theta) = \\Phi \\cos\\theta$ with finite amplitude $\\Phi  0$. Assume that near $I = I_{r}$, the total Hamiltonian admits a quadratic expansion in the detuning, so that the resonant dynamics can be reduced to a pendulum-like Hamiltonian with curvature coefficient $\\alpha  0$ in frequency units, i.e., $H(I,\\theta) \\approx \\frac{1}{2}\\,\\alpha\\,(I - I_{r})^{2} + \\Phi \\cos\\theta$.\n\nLet the initial energetic ion distribution function near the resonance be locally linear in action:\n$$\nf_{0}(I) \\approx f_{r} + g_{0}\\,(I - I_{r}),\n$$\nwhere $g_{0} = \\left.\\frac{\\partial f}{\\partial I}\\right|_{I_{r}}$ is a constant gradient over a characteristic averaging window of width $L$ in action space. Assume that for the purpose of evaluating the net drive, the resonant particles effectively sample the distribution gradient averaged uniformly over a kernel of width $L$ centered at $I_{r}$, and that finite mode amplitude produces a well-defined separatrix region in action space within which the distribution rapidly flattens (plateau formation) relative to $f_{0}$.\n\nAfter a chirping event that sweeps the resonance through the local phase-space, assume the plateau of width equal to the separatrix width persists instantaneously and then relaxes by a diffusive process with a constant action-space diffusion coefficient $D_{I}$, governed by a one-dimensional Fokker–Planck equation (FP) with fixed boundary values at the edges of the averaging window. You may model the dominant relaxation of a localized plateau of width equal to the separatrix width by the lowest eigenmode of diffusion in that slab.\n\nUsing only first-principles reasoning from Hamiltonian resonance reduction and diffusion, determine:\n1. How the finite mode amplitude modifies the effective gradient seen by resonant particles, quantified by the ratio $g_{\\mathrm{eff}}/g_{0}$ immediately after plateau formation.\n2. The delay time $t_{0.95}$ required for the effective gradient to recover to $0.95\\,g_{0}$ after the chirp event, assuming exponential relaxation of the gradient deficit governed by the fundamental diffusive timescale of the plateau.\n\nUse the following scientifically consistent parameters:\n- Curvature coefficient: $\\alpha = 4.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$.\n- Mode amplitude: $\\Phi = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$.\n- Averaging window (kernel) width: $L = 1.0 \\times 10^{-3}$ (dimensionless action units).\n- Action-space diffusion coefficient: $D_{I} = 5.0 \\times 10^{-8}\\ (\\text{action})^{2}\\,\\mathrm{s}^{-1}$.\n\nRound both requested outputs to three significant figures. Express the delay time $t_{0.95}$ in seconds. Your final answer must be a two-entry row matrix containing, in order, the numerical value of $g_{\\mathrm{eff}}/g_{0}$ and the numerical value of $t_{0.95}$ in seconds.",
            "solution": "The interaction of a coherent wave with resonant particles can be reduced near resonance to a pendulum Hamiltonian. Starting from canonical Hamiltonian mechanics, we consider angle-action variables $(\\theta, I)$ and expand the unperturbed Hamiltonian $H_{0}(I)$ near the resonant action $I_{r}$ to second order. Including the single-harmonic perturbation $H_{1}(\\theta)=\\Phi\\cos\\theta$, the total Hamiltonian near resonance takes the standard form\n$$\nH(I,\\theta) \\approx \\frac{1}{2}\\,\\alpha\\,(I-I_{r})^{2} + \\Phi \\cos\\theta,\n$$\nwith $\\alpha0$ capturing the local curvature of the unperturbed dynamics in frequency units. This is the well-tested and widely used pendulum reduction for near-resonant wave–particle interactions.\n\nFrom the pendulum Hamiltonian, the nonlinear trapping (bounce) frequency of resonant particles inside the separatrix is\n$$\n\\omega_{b} = \\sqrt{\\alpha\\,\\Phi},\n$$\na standard result obtained by linearizing the motion near the bottom of the potential well. The separatrix half-width in action is given by the condition that the energy equals the separatrix energy, yielding\n$$\n\\frac{1}{2}\\,\\alpha\\,\\left(\\frac{\\Delta I}{2}\\right)^{2} = \\Phi \\quad \\Rightarrow \\quad \\frac{\\Delta I}{2} = 2\\sqrt{\\frac{\\Phi}{\\alpha}},\n$$\nso the full separatrix width in action space is\n$$\n\\delta I = 4\\sqrt{\\frac{\\Phi}{\\alpha}}.\n$$\n\nThe initial local distribution is $f_{0}(I) \\approx f_{r} + g_{0}(I - I_{r})$, with constant gradient $g_{0}$ over an averaging kernel of width $L$. We model the finite-amplitude effect as instantaneous flattening (plateau formation) within the separatrix region $\\delta I$ about $I_{r}$, consistent with rapid phase mixing inside the nonlinear island compared to slower collisional or diffusive processes. The effective gradient sampled by resonant particles is the uniform average over the kernel of width $L$, but the contribution from the plateau region is zero. Under these assumptions, the fraction of the kernel occupied by the flattened region is $\\delta I/L$ (for $\\delta I \\le L$), and the remainder contributes the original gradient. Therefore, the effective gradient immediately after plateau formation is\n$$\ng_{\\mathrm{eff}} = g_{0}\\left(1 - \\frac{\\delta I}{L}\\right), \\quad \\text{for } \\delta I \\le L,\n$$\nand $g_{\\mathrm{eff}}=0$ for $\\delta I \\ge L$. In our parameter regime, we will verify $\\delta I \\le L$.\n\nWe now compute $\\delta I$ using the provided parameters:\n$$\n\\delta I = 4\\sqrt{\\frac{\\Phi}{\\alpha}} = 4\\sqrt{\\frac{1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}}{4.0\\times 10^{4}\\ \\mathrm{s}^{-1}}}\n= 4\\sqrt{2.5\\times 10^{-9}}.\n$$\nEvaluating the square root,\n$$\n\\sqrt{2.5\\times 10^{-9}} = 5.0\\times 10^{-5},\n$$\nhence\n$$\n\\delta I = 4 \\times 5.0\\times 10^{-5} = 2.0\\times 10^{-4}.\n$$\nThe ratio $\\delta I/L$ is\n$$\n\\frac{\\delta I}{L} = \\frac{2.0\\times 10^{-4}}{1.0\\times 10^{-3}} = 0.2,\n$$\nwhich is less than $1$, so the partial-flattening model applies. Therefore,\n$$\n\\frac{g_{\\mathrm{eff}}}{g_{0}} = 1 - \\frac{\\delta I}{L} = 1 - 0.2 = 0.8.\n$$\n\nNext, we estimate the delay time for gradient recovery after a chirp event. The chirp sweeps the resonance, but we assume that immediately thereafter the plateau of width $\\delta I$ persists and then relaxes primarily by action-space diffusion with constant $D_{I}$. The one-dimensional Fokker–Planck equation (FP) for the distribution $f(I,t)$ is\n$$\n\\frac{\\partial f}{\\partial t} = D_{I}\\,\\frac{\\partial^{2} f}{\\partial I^{2}},\n$$\nwith fixed boundary values at the edges of the averaging kernel (Dirichlet-type conditions), which is a reasonable model for the local relaxation into the unperturbed gradient environment outside the kernel. The dominant relaxation of a localized plateau of width $\\delta I$ occurs on the timescale associated with the lowest eigenmode of diffusion in a slab of length $\\delta I$, namely\n$$\n\\tau_{D} = \\frac{\\delta I^{2}}{\\pi^{2}\\,D_{I}},\n$$\na standard result for diffusion with fixed boundary values (the fundamental mode has eigenvalue $\\pi^{2}D_{I}/\\delta I^{2}$). We model the recovery of the effective gradient deficit as an exponential decay governed by $\\tau_{D}$:\n$$\ng_{0} - g_{\\mathrm{eff}}(t) = \\left(g_{0} - g_{\\mathrm{eff}}(0)\\right)\\exp\\!\\left(-\\frac{t}{\\tau_{D}}\\right).\n$$\nImmediately after plateau formation, $g_{\\mathrm{eff}}(0) = g_{0}(1 - \\delta I/L)$, so the initial deficit is\n$$\ng_{0} - g_{\\mathrm{eff}}(0) = g_{0}\\,\\frac{\\delta I}{L}.\n$$\nWe seek $t_{0.95}$ such that $g_{\\mathrm{eff}}(t_{0.95}) = 0.95\\,g_{0}$. This implies a deficit of $g_{0} - g_{\\mathrm{eff}}(t_{0.95}) = 0.05\\,g_{0}$. Substituting into the exponential decay relation,\n$$\n0.05\\,g_{0} = g_{0}\\,\\frac{\\delta I}{L}\\,\\exp\\!\\left(-\\frac{t_{0.95}}{\\tau_{D}}\\right)\n\\quad \\Rightarrow \\quad\n\\exp\\!\\left(-\\frac{t_{0.95}}{\\tau_{D}}\\right) = \\frac{0.05}{\\delta I/L}.\n$$\nHence,\n$$\nt_{0.95} = \\tau_{D}\\,\\ln\\!\\left(\\frac{\\delta I/L}{0.05}\\right) = \\tau_{D}\\,\\ln\\!\\left(\\frac{0.2}{0.05}\\right) = \\tau_{D}\\,\\ln(4).\n$$\n\nWe now compute $\\tau_{D}$ using the given parameters:\n$$\n\\tau_{D} = \\frac{\\delta I^{2}}{\\pi^{2}\\,D_{I}} = \\frac{(2.0\\times 10^{-4})^{2}}{\\pi^{2}\\times 5.0\\times 10^{-8}\\ \\mathrm{(action)}^{2}\\,\\mathrm{s}^{-1}}.\n$$\nCompute the numerator:\n$$\n\\delta I^{2} = (2.0\\times 10^{-4})^{2} = 4.0\\times 10^{-8}.\n$$\nCompute the denominator using $\\pi^{2} \\approx 9.8696$:\n$$\n\\pi^{2}\\,D_{I} \\approx 9.8696 \\times 5.0\\times 10^{-8} = 4.9348\\times 10^{-7}.\n$$\nTherefore,\n$$\n\\tau_{D} \\approx \\frac{4.0\\times 10^{-8}}{4.9348\\times 10^{-7}} \\approx 8.1090\\times 10^{-2}\\ \\mathrm{s}.\n$$\nFinally,\n$$\nt_{0.95} = \\tau_{D}\\,\\ln(4) \\approx \\left(8.1090\\times 10^{-2}\\ \\mathrm{s}\\right)\\times 1.38629436 \\approx 1.12458\\times 10^{-1}\\ \\mathrm{s}.\n$$\n\nRounded to three significant figures, we have\n$$\n\\frac{g_{\\mathrm{eff}}}{g_{0}} = 0.800, \\qquad t_{0.95} = 0.112\\ \\mathrm{s}.\n$$\nThese results quantify the reduction of the effective drive due to finite amplitude via separatrix-induced flattening and the delay in gradient recovery driven by diffusive refilling after chirping.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.800  0.112\\end{pmatrix}}$$"
        }
    ]
}