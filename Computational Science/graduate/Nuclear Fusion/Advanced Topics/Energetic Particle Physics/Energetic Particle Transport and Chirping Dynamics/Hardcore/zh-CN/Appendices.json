{
    "hands_on_practices": [
        {
            "introduction": "这项实践通过探究粒子俘获的条件，深入到非线性波-粒子相互作用的核心。我们将从基本的洛伦兹力出发，推导 bounce 频率 $ \\omega_B $，该频率表征了被俘获在波势阱中粒子的相干振荡。通过将这个内禀的俘获时间尺度与外部的退相干时间尺度（例如由碰撞或波增长引起的时间尺度）进行比较，我们可以构建一个清晰的、基于物理的准则，用于判断频率啁啾是否会被抑制。",
            "id": "3698536",
            "problem": "考虑一个简化的单共振模型，用于描述高能粒子（EP）与磁化聚变等离子体中单个静电模式的相互作用。假设该模式的电场为 $E(x,t)=E_{0}\\sin(kx-\\omega t)$，相速度为 $v_{\\mathrm{ph}}=\\omega/k$。一个电荷数为 $Z$、质量为 $m$ 的共振高能粒子通过洛伦兹力与波发生非线性相互作用。该模式以线性增长率 $\\gamma$ 随时间增长（因此模式包络按 $\\exp(\\gamma t)$ 变化），并且由于微观湍流，高能粒子经历一个增强的有效螺距角散射率 $\\nu_{\\mathrm{eff}}$。假设在共振附近，动力学简化为波坐标系中的一个单自由度摆。\n\n从第一性原理出发，使用洛伦兹力定律和波相位 $\\psi \\equiv kx-\\omega t$ 的定义，推导捕获共振粒子的非线性弹跳频率 $\\omega_{B}$，用 $Z$、$e$、$m$、$k$ 和 $E_{0}$ 表示。然后，利用基于时间尺度的捕获粒子弹跳作用量的绝热性论证，建立一个保守的啁啾抑制判据，该判据结合了振幅演化率 $\\gamma$ 和有效散射率 $\\nu_{\\mathrm{eff}}$。使用该判据，确定抑制啁啾所需的最小 $\\nu_{\\mathrm{eff}}$，参数如下：\n- 单电荷高能粒子，$Z=1$，$m=3.345\\times 10^{-27}\\ \\mathrm{kg}$，\n- 波数 $k=30\\ \\mathrm{m}^{-1}$，\n- 电场振幅 $E_{0}=50\\ \\mathrm{V/m}$，\n- 线性增长率 $\\gamma=5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$，\n- 元电荷 $e=1.602\\,176\\,634\\times 10^{-19}\\ \\mathrm{C}$。\n\n将所需 $\\nu_{\\mathrm{eff}}$ 的最终答案四舍五入到四位有效数字。最终答案以 $\\mathrm{s}^{-1}$ 为单位表示。",
            "solution": "题目陈述经评估有效。其科学依据是等离子体物理学和经典力学的原理，特别是共振波粒相互作用理论。该问题提法恰当，为得到唯一且有意义的解提供了所有必要的定义、变量和常数。语言客观，参数对于聚变等离子体环境是物理上合理的。\n\n解题过程分为三个阶段：首先，推导非线性弹跳频率 $\\omega_{B}$；其次，建立啁啾抑制判据；第三，计算所需的最小有效散射率 $\\nu_{\\mathrm{eff}}$。\n\n首先，我们推导弹跳频率 $\\omega_{B}$。一个电荷为 $q=Ze$、质量为 $m$ 的高能粒子（EP）在一维静电场 $E(x,t)$ 中的运动由牛顿第二定律和洛伦兹力决定：\n$$m\\frac{d^2x}{dt^2} = F = (Ze)E(x,t)$$\n模式的电场为 $E(x,t)=E_{0}\\sin(kx-\\omega t)$。题目定义波相位为 $\\psi \\equiv kx-\\omega t$。我们寻求 $\\psi$ 的运动方程。将 $\\psi$ 对时间 $t$ 求二阶导数得到：\n$$\\frac{d\\psi}{dt} = k\\frac{dx}{dt} - \\omega$$\n$$\\frac{d^2\\psi}{dt^2} = k\\frac{d^2x}{dt^2}$$\n将 $\\ddot{x}$ 的运动方程代入 $\\ddot{\\psi}$ 的方程：\n$$\\frac{d^2\\psi}{dt^2} = k \\left(\\frac{ZeE_0}{m}\\sin(kx-\\omega t)\\right) = \\frac{kZeE_0}{m}\\sin(\\psi)$$\n该方程描述了相位 $\\psi$ 相对于波的动力学。对于深度捕获的粒子，其运动对应于围绕该动力学系统稳定不动点的小幅振荡。不动点出现在 $\\ddot{\\psi}=0$ 处，这意味着 $\\sin(\\psi)=0$，即 $\\psi = n\\pi$，其中 $n$ 为任意整数。\n\n为确定稳定性，我们围绕这些不动点对该方程进行线性化。令 $\\psi = n\\pi + \\delta\\psi$，其中 $\\delta\\psi$ 是一个小扰动。\n$$\\frac{d^2(\\delta\\psi)}{dt^2} = \\frac{kZeE_0}{m}\\sin(n\\pi + \\delta\\psi) = \\frac{kZeE_0}{m}(\\sin(n\\pi)\\cos(\\delta\\psi) + \\cos(n\\pi)\\sin(\\delta\\psi))$$\n使用 $\\sin(n\\pi)=0$ 和 $\\cos(n\\pi)=(-1)^n$，以及小角度近似 $\\sin(\\delta\\psi) \\approx \\delta\\psi$：\n$$\\frac{d^2(\\delta\\psi)}{dt^2} \\approx (-1)^n \\frac{kZeE_0}{m} \\delta\\psi$$\n对于稳定振荡，右侧必须提供一个回复力，这意味着 $\\delta\\psi$ 的系数必须为负。这发生在 $n$ 为奇数时（例如，$n=1, 3, ...$），此时 $(-1)^n = -1$。\n围绕稳定平衡点（势阱底部）的小幅振荡方程为：\n$$\\frac{d^2(\\delta\\psi)}{dt^2} = -\\left(\\frac{kZeE_0}{m}\\right)\\delta\\psi$$\n这是简谐振荡器的方程，$\\ddot{y} = -\\omega^2 y$，其角频率定义为弹跳频率 $\\omega_B$。通过比较，我们确定弹跳频率的平方为：\n$$\\omega_B^2 = \\frac{kZeE_0}{m}$$\n因此，深度捕获粒子的非线性弹跳频率为：\n$$\\omega_B = \\sqrt{\\frac{kZeE_0}{m}}$$\n\n其次，我们建立一个啁啾抑制判据。啁啾是一种相干的非线性现象，其中粒子在许多弹跳周期内保持被捕获在波的势阱中。这种相干运动的特征时间尺度是弹跳周期，$T_B \\sim 1/\\omega_B$。如果这种相干性被发生在与弹跳周期相当或更快的时间尺度上的过程所破坏，啁啾就会被抑制。\n题目提供了两种这样的过程：\n$1$. 波振幅以线性速率 $\\gamma$ 增长。这意味着势阱的深度，以及弹跳频率 $\\omega_B$ 本身，在 $1/\\gamma$ 的时间尺度上变化。如果这个变化太快（$\\gamma \\gtrsim \\omega_B$），粒子的运动就不再能被视为绝热的，从而破坏了啁啾所需的锁相。\n$2$. 粒子被微观湍流以有效速率 $\\nu_{\\mathrm{eff}}$ 散射。这是一个在相空间中扩散粒子并将其踢出捕获区的随机过程。如果散射的时间尺度 $1/\\nu_{\\mathrm{eff}}$ 比弹跳周期短（$\\nu_{\\mathrm{eff}} \\gtrsim \\omega_B$），捕获就会被破坏。\n\n一个保守的、基于时间尺度的啁啾抑制判据是，这些破坏性效应的总速率必须等于或超过弹跳频率。我们可以将此阈值条件表示为：\n$$\\gamma + \\nu_{\\mathrm{eff}} \\geq \\omega_B$$\n题目要求抑制啁啾所需的最小 $\\nu_{\\mathrm{eff}}$。这对应于阈值处的等式：\n$$\\nu_{\\mathrm{eff, min}} = \\omega_B - \\gamma$$\n这个表达式在 $\\omega_B > \\gamma$ 时有效。如果 $\\omega_B \\leq \\gamma$，波的快速增长本身就足以破坏绝热捕获，因此所需的最小散射率为 $\\nu_{\\mathrm{eff, min}}=0$。因此，完整的判据是 $\\nu_{\\mathrm{eff, min}} = \\max(0, \\omega_B - \\gamma)$。\n\n第三，我们使用给定的参数计算所需的最小 $\\nu_{\\mathrm{eff}}$：\n- 电荷数: $Z=1$\n- 质量: $m=3.345\\times 10^{-27}\\ \\mathrm{kg}$\n- 波数: $k=30\\ \\mathrm{m}^{-1}$\n- 电场振幅: $E_{0}=50\\ \\mathrm{V/m}$\n- 元电荷: $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$\n- 线性增长率: $\\gamma=5.0\\times 10^{4}\\ \\mathrm{s}^{-1}$\n\n首先，我们计算弹跳频率 $\\omega_B$：\n$$\\omega_B = \\sqrt{\\frac{kZeE_0}{m}} = \\sqrt{\\frac{(30\\ \\mathrm{m}^{-1})(1)(1.602176634\\times 10^{-19}\\ \\mathrm{C})(50\\ \\mathrm{V/m})}{3.345\\times 10^{-27}\\ \\mathrm{kg}}}$$\n分子中的项是 $kZeE_0 = (30)(1)(1.602176634\\times 10^{-19})(50) \\approx 2.403265 \\times 10^{-16}\\ \\mathrm{N}$。\n$$\\omega_B^2 = \\frac{2.403265 \\times 10^{-16}\\ \\mathrm{N}}{3.345\\times 10^{-27}\\ \\mathrm{kg}} \\approx 7.18464858 \\times 10^{10}\\ \\mathrm{s}^{-2}$$\n$$\\omega_B = \\sqrt{7.18464858 \\times 10^{10}\\ \\mathrm{s}^{-2}} \\approx 2.68041948 \\times 10^5\\ \\mathrm{s}^{-1}$$\n现在我们将 $\\omega_B$ 与 $\\gamma$ 进行比较：\n$\\omega_B \\approx 2.680 \\times 10^5\\ \\mathrm{s}^{-1}$ 且 $\\gamma = 5.0 \\times 10^4\\ \\mathrm{s}^{-1} = 0.5 \\times 10^5\\ \\mathrm{s}^{-1}$。\n由于 $\\omega_B > \\gamma$，需要额外的散射来抑制。我们使用公式 $\\nu_{\\mathrm{eff, min}} = \\omega_B - \\gamma$：\n$$\\nu_{\\mathrm{eff, min}} \\approx (2.68041948 \\times 10^5\\ \\mathrm{s}^{-1}) - (5.0 \\times 10^4\\ \\mathrm{s}^{-1})$$\n$$\\nu_{\\mathrm{eff, min}} \\approx 2.18041948 \\times 10^5\\ \\mathrm{s}^{-1}$$\n按照要求将结果四舍五入到四位有效数字：\n$$\\nu_{\\mathrm{eff, min}} \\approx 2.180 \\times 10^5\\ \\mathrm{s}^{-1}$$",
            "answer": "$$\\boxed{2.180 \\times 10^{5}}$$"
        },
        {
            "introduction": "在粒子俘获概念的基础上，本练习旨在检验其对高能粒子分布的直接后果。被俘获粒子的快速相干运动导致相混合，并在相空间分布函数中形成一个“平台”，这反过来又改变了不稳定性驱动。本问题将引导您在已建立的摆模型中量化此效应，并計算隨後的弛豫時間，从而阐明相干非线性结构与背景扩散过程之间的动态相互作用。",
            "id": "3698507",
            "problem": "考虑在环形聚变等离子体中，一个单一、相干的剪切阿尔芬模式与高能离子群发生共振相互作用。对共振自由度使用角-作用量变量 $(\\theta, I)$，其中 $I$ 是一个归一化为无量纲单位的正则作用量，$\\theta$ 是相应的正则角。设未扰动的哈密顿量为 $H_{0}(I)$，模-粒子共振发生在 $I = I_{r}$ 处，频率为 $\\omega$。假设扰动是一个单谐波模式，在共振点附近由 $H_{1}(\\theta) = \\Phi \\cos\\theta$ 描述，其振幅有限 $\\Phi  0$。假设在 $I = I_{r}$ 附近，总哈密顿量允许对失谐进行二次展开，因此共振动力学可以简化为一个类摆哈密顿量，其曲率系数（以频率为单位）为 $\\alpha  0$，即 $H(I,\\theta) \\approx \\frac{1}{2}\\,\\alpha\\,(I - I_{r})^{2} + \\Phi \\cos\\theta$。\n\n设共振点附近的初始高能离子分布函数在作用量上局部线性：\n$$\nf_{0}(I) \\approx f_{r} + g_{0}\\,(I - I_{r}),\n$$\n其中 $g_{0} = \\left.\\frac{\\partial f}{\\partial I}\\right|_{I_{r}}$ 是作用量空间中宽度为 $L$ 的特征平均窗口内的恒定梯度。假设为了评估净驱动，共振粒子有效地对以 $I_{r}$ 为中心、宽度为 $L$ 的核上均匀平均的分布梯度进行采样，并且有限的模振幅在作用量空间中产生一个明确的分界线区域，在该区域内分布相对于 $f_{0}$ 迅速平坦化（形成平台）。\n\n在一次扫频（chirping）事件使共振扫过局域相空间后，假设宽度等于分界线宽度的平台瞬时存在，然后通过一个扩散过程弛豫，该过程具有恒定的作用量空间扩散系数 $D_{I}$，并由一维福克-普朗克方程（FP）控制，在平均窗口的边界上具有固定的边界值。你可以用该平板中扩散的最低本征模来模拟宽度等于分界线宽度的局域平台的主要弛豫过程。\n\n仅使用基于哈密顿共振简化和扩散的第一性原理推导，确定：\n1. 有限模振幅如何改变共振粒子所感受到的有效梯度，用平台形成后瞬间的比值 $g_{\\mathrm{eff}}/g_{0}$ 来量化。\n2. 在扫频事件后，有效梯度恢复到 $0.95\\,g_{0}$ 所需的延迟时间 $t_{0.95}$，假设梯度亏损的弛豫由平台的基本扩散时间尺度控制，呈指数形式。\n\n使用以下科学上一致的参数：\n- 曲率系数：$\\alpha = 4.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$。\n- 模振幅：$\\Phi = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n- 平均窗口（核）宽度：$L = 1.0 \\times 10^{-3}$（无量纲作用量单位）。\n- 作用量空间扩散系数：$D_{I} = 5.0 \\times 10^{-8}\\ (\\text{action})^{2}\\,\\mathrm{s}^{-1}$。\n\n将两个所求的输出值四舍五入到三位有效数字。将延迟时间 $t_{0.95}$ 以秒为单位表示。你的最终答案必须是一个包含两个元素的行矩阵，按顺序分别为 $g_{\\mathrm{eff}}/g_{0}$ 的数值和 $t_{0.95}$ 的数值（以秒为单位）。",
            "solution": "相干波与共振粒子的相互作用在共振点附近可以简化为一个摆式哈密顿量。从正则哈密顿力学出发，我们考虑角-作用量变量 $(\\theta, I)$，并将未扰动哈密顿量 $H_{0}(I)$ 在共振作用量 $I_{r}$ 附近展开到二阶。包含单谐波扰动 $H_{1}(\\theta)=\\Phi\\cos\\theta$ 后，共振点附近的总哈密顿量具有标准形式\n$$\nH(I,\\theta) \\approx \\frac{1}{2}\\,\\alpha\\,(I-I_{r})^{2} + \\Phi \\cos\\theta,\n$$\n其中 $\\alpha0$ 捕捉了未扰动动力学在频率单位下的局域曲率。这是经过充分检验并广泛用于近共振波-粒子相互作用的摆式简化模型。\n\n从摆式哈密顿量可知，分界线内共振粒子的非线性囚禁（弹跳）频率为\n$$\n\\omega_{b} = \\sqrt{\\alpha\\,\\Phi},\n$$\n这是一个通过对势阱底部附近的运动进行线性化得到的标准结果。作用量空间中的分界线半宽由能量等于分界线能量的条件给出，得到\n$$\n\\frac{1}{2}\\,\\alpha\\,\\left(\\frac{\\Delta I}{2}\\right)^{2} = \\Phi \\quad \\Rightarrow \\quad \\frac{\\Delta I}{2} = 2\\sqrt{\\frac{\\Phi}{\\alpha}},\n$$\n因此，作用量空间中的完整分界线宽度为\n$$\n\\delta I = 4\\sqrt{\\frac{\\Phi}{\\alpha}}.\n$$\n\n初始局域分布为 $f_{0}(I) \\approx f_{r} + g_{0}(I - I_{r})$，在宽度为 $L$ 的平均核上具有恒定梯度 $g_{0}$。我们将有限振幅效应建模为在以 $I_{r}$ 为中心的分界线区域 $\\delta I$ 内的瞬时平坦化（平台形成），这与非线性岛内部的快速相混合（相对于较慢的碰撞或扩散过程）现象是一致的。共振粒子采样的有效梯度是在宽度为 $L$ 的核上的均匀平均值，但来自平台区域的贡献为零。在这些假设下，平坦化区域占据核的分数为 $\\delta I/L$（对于 $\\delta I \\le L$），剩余部分贡献原始梯度。因此，平台形成后瞬间的有效梯度为\n$$\ng_{\\mathrm{eff}} = g_{0}\\left(1 - \\frac{\\delta I}{L}\\right), \\quad \\text{for } \\delta I \\le L,\n$$\n而对于 $\\delta I \\ge L$，有 $g_{\\mathrm{eff}}=0$。在我们的参数范围内，我们将验证 $\\delta I \\le L$。\n\n现在我们使用给定的参数计算 $\\delta I$：\n$$\n\\delta I = 4\\sqrt{\\frac{\\Phi}{\\alpha}} = 4\\sqrt{\\frac{1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}}{4.0\\times 10^{4}\\ \\mathrm{s}^{-1}}}\n= 4\\sqrt{2.5\\times 10^{-9}}.\n$$\n计算平方根，\n$$\n\\sqrt{2.5\\times 10^{-9}} = 5.0\\times 10^{-5},\n$$\n因此\n$$\n\\delta I = 4 \\times 5.0\\times 10^{-5} = 2.0\\times 10^{-4}.\n$$\n比值 $\\delta I/L$ 为\n$$\n\\frac{\\delta I}{L} = \\frac{2.0\\times 10^{-4}}{1.0\\times 10^{-3}} = 0.2,\n$$\n该值小于1，因此部分平坦化模型适用。因此，\n$$\n\\frac{g_{\\mathrm{eff}}}{g_{0}} = 1 - \\frac{\\delta I}{L} = 1 - 0.2 = 0.8.\n$$\n\n接下来，我们估计扫频事件后梯度恢复的延迟时间。扫频会扫过共振区，但我们假设扫频后宽度为 $\\delta I$ 的平台会立即存在，然后主要通过作用量空间扩散进行弛豫，扩散系数 $D_{I}$ 为常数。分布函数 $f(I,t)$ 的一维福克-普朗克方程（FP）为\n$$\n\\frac{\\partial f}{\\partial t} = D_{I}\\,\\frac{\\partial^{2} f}{\\partial I^{2}},\n$$\n在平均核的边界处具有固定边界值（狄利克雷型条件），这是对局域弛豫过程（即弛豫到核外的未扰动梯度环境）的一个合理模型。宽度为 $\\delta I$ 的局域平台的主要弛豫发生在与长度为 $\\delta I$ 的平板中扩散的最低本征模相关的时间尺度上，即\n$$\n\\tau_{D} = \\frac{\\delta I^{2}}{\\pi^{2}\\,D_{I}},\n$$\n这是一个固定边界值扩散的标准结果（基模的本征值为 $\\pi^{2}D_{I}/\\delta I^{2}$）。我们将有效梯度亏损的恢复建模为由 $\\tau_{D}$ 控制的指数衰减：\n$$\ng_{0} - g_{\\mathrm{eff}}(t) = \\left(g_{0} - g_{\\mathrm{eff}}(0)\\right)\\exp\\!\\left(-\\frac{t}{\\tau_{D}}\\right).\n$$\n平台形成后瞬间，$g_{\\mathrm{eff}}(0) = g_{0}(1 - \\delta I/L)$，所以初始亏损为\n$$\ng_{0} - g_{\\mathrm{eff}}(0) = g_{0}\\,\\frac{\\delta I}{L}.\n$$\n我们寻求 $t_{0.95}$ 使得 $g_{\\mathrm{eff}}(t_{0.95}) = 0.95\\,g_{0}$。这意味着亏损为 $g_{0} - g_{\\mathrm{eff}}(t_{0.95}) = 0.05\\,g_{0}$。代入指数衰减关系式，\n$$\n0.05\\,g_{0} = g_{0}\\,\\frac{\\delta I}{L}\\,\\exp\\!\\left(-\\frac{t_{0.95}}{\\tau_{D}}\\right)\n\\quad \\Rightarrow \\quad\n\\exp\\!\\left(-\\frac{t_{0.95}}{\\tau_{D}}\\right) = \\frac{0.05}{\\delta I/L}.\n$$\n因此，\n$$\nt_{0.95} = \\tau_{D}\\,\\ln\\!\\left(\\frac{\\delta I/L}{0.05}\\right) = \\tau_{D}\\,\\ln\\!\\left(\\frac{0.2}{0.05}\\right) = \\tau_{D}\\,\\ln(4).\n$$\n\n我们现在使用给定的参数计算 $\\tau_{D}$：\n$$\n\\tau_{D} = \\frac{\\delta I^{2}}{\\pi^{2}\\,D_{I}} = \\frac{(2.0\\times 10^{-4})^{2}}{\\pi^{2}\\times 5.0\\times 10^{-8}\\ \\mathrm{(action)}^{2}\\,\\mathrm{s}^{-1}}.\n$$\n计算分子：\n$$\n\\delta I^{2} = (2.0\\times 10^{-4})^{2} = 4.0\\times 10^{-8}.\n$$\n使用 $\\pi^{2} \\approx 9.8696$ 计算分母：\n$$\n\\pi^{2}\\,D_{I} \\approx 9.8696 \\times 5.0\\times 10^{-8} = 4.9348\\times 10^{-7}.\n$$\n因此，\n$$\n\\tau_{D} \\approx \\frac{4.0\\times 10^{-8}}{4.9348\\times 10^{-7}} \\approx 8.1090\\times 10^{-2}\\ \\mathrm{s}.\n$$\n最后，\n$$\nt_{0.95} = \\tau_{D}\\,\\ln(4) \\approx \\left(8.1090\\times 10^{-2}\\ \\mathrm{s}\\right)\\times 1.38629436 \\approx 1.12458\\times 10^{-1}\\ \\mathrm{s}.\n$$\n\n四舍五入到三位有效数字，我们得到\n$$\n\\frac{g_{\\mathrm{eff}}}{g_{0}} = 0.800, \\qquad t_{0.95} = 0.112\\ \\mathrm{s}.\n$$\n这些结果量化了由有限振幅通过分界线诱导的平坦化所导致的有效驱动的减小，以及扫频后由扩散重新填充驱动的梯度恢复延迟。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.800  0.112\\end{pmatrix}}$$"
        },
        {
            "introduction": "前面的练习侧重于俘获和分布改变的局域物理。在这里，我们将尺度放大，研究其宏观后果：大尺度高能粒子输运。这项计算实践将啁啾模视为一个“护送者”或“桶”，它俘获粒子并将它们在等离子体半径方向上对流输运。您将实现一个简化但功能强大的模型来模拟这一过程，并计算由此产生的粒子损失份额，从而将共振的微观物理与等离子体约束的关键性能指标直接联系起来。",
            "id": "3698493",
            "problem": "考虑一个大环径比、轴对称的托卡马克，使用归一化、无量纲的单位。令小半径归一化为1，因此径向坐标 $r$ 满足 $r \\in [0,1]$。考虑单个剪切阿尔芬本征模 (AE) 与高能导心粒子相互作用。假设一个简化的、大环径比的、弹跳平均的共振条件，其中弹跳平均进动频率随半径单调地以线性函数形式变化\n$$\n\\omega_{\\mathrm{res}}(r) = \\omega_{\\mathrm{base}} + \\beta r,\n$$\n其中 $\\omega_{\\mathrm{base}}$ 和 $\\beta$ 是常数（在所选归一化中为无量纲）。模频率 $\\omega(t)$ 在一个预设的离散时间序列 $\\{t_k\\}$ 上发生啁啾，产生一个序列 $\\{\\omega_k\\}$。对于每个离散时间，通过求解共振条件隐式地定义共振中心半径 $r_{\\mathrm{c},k}$\n$$\n\\omega_{\\mathrm{res}}(r_{\\mathrm{c},k}) = \\omega_k,\n$$\n因此\n$$\nr_{\\mathrm{c},k} = \\frac{\\omega_k - \\omega_{\\mathrm{base}}}{\\beta}.\n$$\n\n在共振点附近，使用作用量-角度变量建立相互作用模型，其有效摆哈密顿量的岛半宽（在作用量坐标中，这里映射到归一化半径 $r$）是模振幅 $A$ 和频率剪切 $\\beta$ 的函数。在采用的归一化中，将岛半宽视为\n$$\nw = 2\\sqrt{\\frac{A}{|\\beta|}}.\n$$\n假设绝热啁啾，使得初始在岛内的粒子随着岛中心在半径上的移动而被输运。具体来说，令 $r_0$ 为一个导心粒子的初始半径。如果存在一个索引 $j$，在该索引处粒子位于岛内，量化为\n$$\n|r_0 - r_{\\mathrm{c},j}| \\leq w \\quad \\text{且} \\quad r_{\\mathrm{c},j} \\in [0,1],\n$$\n则该粒子在步骤 $j$ 被捕获，并且在绝热极限下，其最终半径为\n$$\nr_{\\mathrm{final}} = r_0 + \\left(r_{\\mathrm{c},K} - r_{\\mathrm{c},j}\\right),\n$$\n其中 $K$ 是最后一个啁啾步骤的索引。如果不存在这样的捕获索引 $j$，则取 $r_{\\mathrm{final}} = r_0$。\n\n如果 $r_{\\mathrm{final}} \\geq r_{\\mathrm{loss}}$，则认为粒子已损失，其中损失边界是等离子体边界 $r_{\\mathrm{loss}} = 1$。考虑一个确定性的、均匀分布的包含 $N$ 个粒子的初始集合，其半径为\n$$\nr_i = \\frac{i}{N-1}, \\quad i=0,1,\\dots,N-1,\n$$\n均匀地覆盖 $[0,1]$。边界损失份额定义为\n$$\nf_{\\mathrm{loss}} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\mathbf{1}\\left(r_{\\mathrm{final},i} \\geq 1\\right),\n$$\n其中 $\\mathbf{1}(\\cdot)$ 是指示函数。\n\n仅从上述定义和基本共振原理出发，推导由绝热俘获假设所隐含的离散映射算法，并实现一个程序，为以下每个测试用例计算边界损失份额 $f_{\\mathrm{loss}}$。在本问题中，所有量都是无量纲的。将最终的边界损失份额表示为四舍五入到六位小数的十进制数。\n\n所有用例均使用 $N=101$ 和 $r_{\\mathrm{loss}}=1$。测试套件如下：\n\n- 用例1（向外啁啾，中等振幅）：\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.2$\n  - 啁啾序列 $\\{\\omega_k\\} = [0.4, 0.6, 0.8, 1.0]$\n  - $A = 0.04$\n\n- 用例2（边界接触啁啾，小振幅）：\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.0$\n  - 啁啾序列 $\\{\\omega_k\\} = [0.4, 0.65, 0.95]$\n  - $A = 0.0025$\n\n- 用例3（无啁啾，有限振幅）：\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.2$\n  - 啁啾序列 $\\{\\omega_k\\} = [0.6, 0.6, 0.6]$\n  - $A = 0.04$\n\n- 用例4（最终共振超出边界，边界附近适度振幅）：\n  - $\\beta = 1.0$\n  - $\\omega_{\\mathrm{base}} = 0.0$\n  - 啁啾序列 $\\{\\omega_k\\} = [0.8, 1.05]$\n  - $A = 0.01$\n\n你的程序应该产生单行输出，其中包含一个用方括号括起来的、逗号分隔的四个损失份额的列表（例如，“[0.123456,0.000000,0.010000,0.250000]”）。",
            "solution": "对问题 RCM-2023-010 进行验证。\n\n### 步骤 1：提取已知条件\n\n- 归一化：大环径比、轴对称托卡马克。小半径归一化为1，$r \\in [0,1]$。\n- 共振条件：弹跳平均进动频率为 $\\omega_{\\mathrm{res}}(r) = \\omega_{\\mathrm{base}} + \\beta r$，其中 $\\omega_{\\mathrm{base}}$ 和 $\\beta$ 是常数。\n- 模频率：在时间 $\\{t_k\\}$ 处的离散模频率序列 $\\{\\omega_k\\}$。最后一个索引表示为 $K$。\n- 共振中心半径：在每个时间步 $k$，共振中心 $r_{\\mathrm{c},k}$ 由 $\\omega_{\\mathrm{res}}(r_{\\mathrm{c},k}) = \\omega_k$ 定义，这给出 $r_{\\mathrm{c},k} = \\frac{\\omega_k - \\omega_{\\mathrm{base}}}{\\beta}$。\n- 岛半宽：$w = 2\\sqrt{\\frac{A}{|\\beta|}}$，其中 $A$ 是模振幅。\n- 粒子捕获条件：一个初始半径为 $r_0$ 的粒子在步骤 $j$ 被捕获，如果这是第一个满足 $|r_0 - r_{\\mathrm{c},j}| \\leq w$ 且共振在等离子体内（即 $r_{\\mathrm{c},j} \\in [0,1]$）的步骤。\n- 绝热输运规则：如果在步骤 $j$ 被捕获，粒子的最终半径为 $r_{\\mathrm{final}} = r_0 + \\left(r_{\\mathrm{c},K} - r_{\\mathrm{c},j}\\right)$。如果从未被捕获，则 $r_{\\mathrm{final}} = r_0$。在问题的符号体系中，$K$ 是最后一个啁啾步骤的索引。对于一个长度为 $L$ 的零索引序列，$K = L-1$。\n- 粒子损失条件：如果 $r_{\\mathrm{final}} \\geq r_{\\mathrm{loss}}$，则粒子被视为损失，其中 $r_{\\mathrm{loss}} = 1$。\n- 初始粒子分布：$N$ 个粒子，初始半径为 $r_i = \\frac{i}{N-1}$，其中 $i=0,1,\\dots,N-1$。\n- 边界损失份额：$f_{\\mathrm{loss}} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\mathbf{1}\\left(r_{\\mathrm{final},i} \\geq 1\\right)$。\n- 全局参数：$N=101$, $r_{\\mathrm{loss}}=1$。\n- 测试用例：\n    1. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.2$, $\\{\\omega_k\\} = [0.4, 0.6, 0.8, 1.0]$, $A = 0.04$。\n    2. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.0$, $\\{\\omega_k\\} = [0.4, 0.65, 0.95]$, $A = 0.0025$。\n    3. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.2$, $\\{\\omega_k\\} = [0.6, 0.6, 0.6]$, $A = 0.04$。\n    4. $\\beta = 1.0$, $\\omega_{\\mathrm{base}} = 0.0$, $\\{\\omega_k\\} = [0.8, 1.05]$, $A = 0.01$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n该问题是一个定义明确的计算物理练习，基于一个简化但标准的等离子体中波-粒子相互作用模型。\n- **科学依据**：阿尔芬本征模、频率啁啾、共振条件、相空间中的岛形成以及绝热输运等概念，都是研究托卡马克中高能粒子约束的基石性原理。具体的函数形式（$\\omega_{\\mathrm{res}}(r)$ 为线性，$w \\propto \\sqrt{A}$）是理论模型中常用的有效简化。该问题在科学上是合理的。\n- **适定的**：所有必要的参数、初始条件和动力学规则都已明确给出。确定粒子最终位置的规则是确定性的，确保了损失份额存在唯一解。“首次捕获”对“如果存在一个索引 $j$”这一条件的解释是唯一在物理上和逻辑上都合理的，因为一个粒子一旦被俘获，就会保持被俘获的状态。\n- **客观性**：该问题以精确的数学语言陈述，没有主观或模糊的术语。\n\n验证标准中列出的缺陷均不存在。该问题是自洽、一致且可形式化的。\n\n### 步骤 3：结论与行动\n\n此问题是 **有效的**。将着手制定解决方案。\n\n### 求解推导\n\n目标是为一组给定的初始粒子计算其在啁啾阿尔芬本征模影响下的边界损失份额 $f_{\\mathrm{loss}}$。该解法是算法性的，遵循所描述的物理模型。\n\n**1. 系统初始化**\n对于每个测试用例，物理系统由参数 $\\beta$、$\\omega_{\\mathrm{base}}$、模频率序列 $\\{\\omega_k\\}$ 和模振幅 $A$ 定义。模拟常数为 $N=101$ 个粒子和损失边界 $r_{\\mathrm{loss}}=1$。初始粒子分布是在区间 $[0,1]$ 上的一个包含 $N$ 个点的均匀网格，由 $r_i = i/(N-1)$ 给出，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。\n\n**2. 模属性的计算**\n该算法需要在每个离散时间步 $k$ 计算模的两个关键属性。\n- **共振中心半径 ($r_{\\mathrm{c},k}$)**：粒子与模发生共振的空间位置。它为啁啾序列中的每个频率 $\\omega_k$ 计算。\n  $$\n  r_{\\mathrm{c},k} = \\frac{\\omega_k - \\omega_{\\mathrm{base}}}{\\beta}\n  $$\n- **岛半宽 ($w$)**：围绕共振中心的俘获区的径向范围。它取决于模振幅 $A$ 和剪切 $\\beta$，但在时间上是恒定的，因为 $A$ 和 $\\beta$ 被给定为常数。\n  $$\n  w = 2\\sqrt{\\frac{A}{|\\beta|}}\n  $$\n\n**3. 绝热输运算法**\n对于 $N$ 个初始粒子中的每一个，我们必须确定其最终半径 $r_{\\mathrm{final}}$。这涉及到遍历模的时间序列。\n\n令 $L$ 为频率序列 $\\{\\omega_k\\}$ 中的元素数量。索引从 $k=0$ 到 $k=L-1$。对于来自集合 $\\{r_i\\}$ 的每个初始粒子半径 $r_0$：\n- 初始化一个捕获索引 $j = -1$（或任何表示“未捕获”的哨兵值）。\n- 遍历时间步 $k = 0, 1, \\dots, L-1$。\n  - 在每个步骤 $k$，计算 $r_{\\mathrm{c},k}$。\n  - 检查粒子捕获的两个条件：\n    1. 共振必须在等离子体区域内：$0 \\leq r_{\\mathrm{c},k} \\leq 1$。\n    2. 粒子必须在岛内：$|r_0 - r_{\\mathrm{c},k}| \\leq w$。\n  - 如果两个条件都满足，则粒子在此步骤被捕获。我们设置 $j=k$ 并立即退出此内循环，因为问题规定在第一个这样的实例处捕获。\n- 在检查完所有时间步后，确定粒子的最终半径 $r_{\\mathrm{final}}$。\n  - 如果粒子被捕获（即 $j \\neq -1$），它将被绝热输运。其最终半径是其初始半径加上共振中心从捕获点到最终时刻的总位移。令 $r_{\\mathrm{c},j}$ 为捕获时的共振半径，$r_{\\mathrm{c},L-1}$ 为最后一步的共振半径。\n    $$\n    r_{\\mathrm{final}} = r_0 + (r_{\\mathrm{c},L-1} - r_{\\mathrm{c},j})\n    $$\n  - 如果粒子从未被捕获（即 $j$ 保持为 $-1$），其半径不变。\n    $$\n    r_{\\mathrm{final}} = r_0\n    $$\n\n**4. 损失份额计算**\n在为每个初始粒子 $r_i$ 计算出最终半径 $r_{\\mathrm{final},i}$ 后，我们统计损失的粒子数量。\n- 初始化 `lost_particle_count` 为 $0$。\n- 对于每个粒子 $i=0, \\dots, N-1$：\n  - 如果 $r_{\\mathrm{final},i} \\geq r_{\\mathrm{loss}}$（其中 $r_{\\mathrm{loss}}=1$），则增加 `lost_particle_count`。\n- 最终的边界损失份额是损失粒子数与总粒子数的比率。\n  $$\n  f_{\\mathrm{loss}} = \\frac{\\text{lost\\_particle\\_count}}{N}\n  $$\n每个测试用例的结果是该值，格式化为保留六位小数的十进制数。这个过程是确定性的，并直接实现了问题陈述中指定的物理过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the particle transport problem for all specified test cases and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (outward chirp, moderate amplitude)\n        {'beta': 1.0, 'omega_base': 0.2, 'omega_k': [0.4, 0.6, 0.8, 1.0], 'A': 0.04},\n        # Case 2 (boundary-touching chirp, small amplitude)\n        {'beta': 1.0, 'omega_base': 0.0, 'omega_k': [0.4, 0.65, 0.95], 'A': 0.0025},\n        # Case 3 (no chirp, finite amplitude)\n        {'beta': 1.0, 'omega_base': 0.2, 'omega_k': [0.6, 0.6, 0.6], 'A': 0.04},\n        # Case 4 (final resonance beyond edge, modest amplitude near edge)\n        {'beta': 1.0, 'omega_base': 0.0, 'omega_k': [0.8, 1.05], 'A': 0.01}\n    ]\n\n    # Global parameters for all cases\n    N = 101\n    r_loss = 1.0\n\n    # Generate the initial distribution of particle radii\n    initial_radii = np.linspace(0.0, 1.0, N)\n\n    results = []\n    for case in test_cases:\n        beta = case['beta']\n        omega_base = case['omega_base']\n        omega_k = np.array(case['omega_k'])\n        A = case['A']\n\n        # Calculate the island half-width (constant for the duration of the chirp)\n        w = 2.0 * np.sqrt(A / abs(beta))\n\n        # Calculate the sequence of resonant center radii\n        r_c_sequence = (omega_k - omega_base) / beta\n        \n        lost_particle_count = 0\n        \n        # Iterate over each particle\n        for r0 in initial_radii:\n            capture_index = -1\n            \n            # Check for capture at each time step\n            for k, r_c_k in enumerate(r_c_sequence):\n                # Capture condition: resonance must be inside the plasma\n                if 0.0 = r_c_k = 1.0:\n                    # Capture condition: particle must be within the island\n                    if abs(r0 - r_c_k) = w:\n                        capture_index = k\n                        break  # Particle is captured at the first available opportunity\n\n            # Determine the final radius of the particle\n            r_final = r0\n            if capture_index != -1:\n                r_c_capture = r_c_sequence[capture_index]\n                r_c_final = r_c_sequence[-1]\n                r_final = r0 + (r_c_final - r_c_capture)\n\n            # Check if the particle is lost\n            if r_final >= r_loss:\n                lost_particle_count += 1\n        \n        # Calculate the edge loss fraction\n        f_loss = lost_particle_count / N\n        \n        # Format the result to six decimal places and append to the list\n        results.append(f\"{f_loss:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}