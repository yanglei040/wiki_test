{
    "hands_on_practices": [
        {
            "introduction": "理解可观测性的第一步是掌握其数学基础：李导数和可观测性秩条件。第一个练习将通过一个协同调控系统模型，让你熟练应用这些核心工具。通过计算系统在一个特殊状态（其中一个物种浓度接近于零）下的可观测性矩阵，你将深入体会，即便初始测量似乎缺少直接信息，系统完整状态仍可能通过其动态过程被推断出来。",
            "id": "3334957",
            "problem": "考虑一个具有协同激活作用的双物种生物化学调控模块，其由以下非线性常微分方程建模\n$$\n\\dot{x}_1 \\;=\\; \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} \\;-\\; \\beta_1\\,x_1, \n\\qquad\n\\dot{x}_2 \\;=\\; \\alpha_2\\,\\frac{x_1^m}{K_2^m + x_1^m} \\;-\\; \\beta_2\\,x_2,\n$$\n其中 $x_1$ 和 $x_2$ 是浓度，$\\alpha_1, \\alpha_2, \\beta_1, \\beta_2, K_1, K_2$ 是严格正常数，而 $m \\geq 1$ 是一个整数希尔指数，用于表征 $x_1$ 在生成 $x_2$ 过程中的协同性。假设仅测量第一个物种，其输出为\n$$\nh(x) \\;=\\; x_1.\n$$\n使用标量函数 $h$ 沿矢量场 $f$ 的李导数定义，即 $L_f h(x) = \\nabla h(x)\\cdot f(x)$，及其递归式 $L_f^{k+1} h(x) = \\nabla \\big(L_f^k h(x)\\big)\\cdot f(x)$ (对于 $k \\geq 0$)。请显式计算 $h(x)$, $L_f h(x)$ 和 $L_f^2 h(x)$，以及它们的梯度 $\\nabla h(x)$, $\\nabla \\big(L_f h(x)\\big)$ 和 $\\nabla \\big(L_f^2 h(x)\\big)$。然后，构建可观测性矩阵 $\\mathcal{O}(x)$，其行向量为这些梯度，并计算其在状态点 $$ x^\\star \\;=\\; (K_2,\\,0) $$ 处的秩，该状态点代表第二个物种的浓度接近于零，而第一个物种的浓度处于非零基线水平。请提供 $\\mathcal{O}(x^\\star)$ 的秩的整数值作为您的最终答案。",
            "solution": "该问题要求分析一个非线性生物化学系统在状态空间中一个特定点的局部可观测性。该系统由状态向量 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 描述，其动态由矢量场 $f(x) = \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix}$ 决定，其中\n$$\nf_1(x) = \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1\n$$\n$$\nf_2(x) = \\alpha_2\\,\\frac{x_1^m}{K_2^m + x_1^m} - \\beta_2\\,x_2\n$$\n输出函数为 $h(x) = x_1$。\n\n可观测性通过可观测性矩阵 $\\mathcal{O}(x)$ 进行评估，该矩阵由输出函数 $h(x)$ 的逐次李导数的梯度构成。矩阵的行是梯度的转置。\n$$\n\\mathcal{O}(x) = \\begin{pmatrix} (\\nabla h(x))^T \\\\ (\\nabla (L_f h(x)))^T \\\\ \\vdots \\end{pmatrix}\n$$\n我们需要求解该矩阵在点 $x^\\star = (K_2, 0)$ 处的秩。\n\n首先，我们以符号形式计算所需的李导数及其梯度。\n\n**步骤1：零阶项，$h(x)$**\n\n输出函数为 $h(x) = x_1$。\n$h(x)$ 的梯度是一个常向量：\n$$\n\\nabla h(x) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1} \\\\ \\frac{\\partial h}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n可观测性矩阵的第一行是 $(\\nabla h(x))^T = \\begin{pmatrix} 1  0 \\end{pmatrix}$。该行为常数，因此在 $x^\\star$ 处的值也相同。\n\n**步骤2：一阶项，$L_f h(x)$**\n\n一阶李导数定义为 $L_f h(x) = \\nabla h(x) \\cdot f(x)$。\n$$\nL_f h(x) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix} = f_1(x) = \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1\n$$\n接下来，我们计算 $L_f h(x)$ 的梯度：\n$$\n\\frac{\\partial (L_f h)}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1 \\right) = -\\beta_1\n$$\n$$\n\\frac{\\partial (L_f h)}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} \\left( \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1 \\right) = \\alpha_1 \\frac{(2x_2)(K_1^2 + x_2^2) - x_2^2(2x_2)}{(K_1^2 + x_2^2)^2} = \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2}\n$$\n因此，梯度为 $\\nabla(L_f h(x)) = \\begin{pmatrix} -\\beta_1 \\\\ \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix}$。\n可观测性矩阵的第二行是 $(\\nabla (L_f h(x)))^T = \\begin{pmatrix} -\\beta_1  \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix}$。\n\n**步骤3：二阶项，$L_f^2 h(x)$**\n\n二阶李导数为 $L_f^2 h(x) = \\nabla(L_f h(x)) \\cdot f(x)$。\n$$\nL_f^2 h(x) = \\begin{pmatrix} -\\beta_1 \\\\ \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix} \\cdot \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix} = -\\beta_1 f_1(x) + \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} f_2(x)\n$$\n为了得到可观测性矩阵的第三行，我们需要计算梯度 $\\nabla(L_f^2 h(x))$。与其计算完整的符号表达式，不如直接在指定点 $x^\\star = (K_2, 0)$ 处计算梯度，这样效率更高。\n第三行为 $(\\nabla (L_f^2 h(x^\\star)))^T = \\begin{pmatrix} \\frac{\\partial (L_f^2 h)}{\\partial x_1}\\Big|_{x^\\star}  \\frac{\\partial (L_f^2 h)}{\\partial x_2}\\Big|_{x^\\star} \\end{pmatrix}$。\n\n我们记 $C(x_2) = \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2}$。因此 $L_f^2 h(x) = -\\beta_1 f_1(x) + C(x_2) f_2(x)$。\n那么 $\\nabla(L_f^2 h(x)) = -\\beta_1 \\nabla f_1(x) + \\nabla(C(x_2) f_2(x))$。\n使用梯度乘法法则，$\\nabla(C f_2) = C \\nabla f_2 + f_2 \\nabla C$。\n所以，$\\nabla(L_f^2 h(x)) = -\\beta_1 \\nabla f_1(x) + C(x_2) \\nabla f_2(x) + f_2(x) \\nabla C(x_2)$。\n\n我们在 $x^\\star = (K_2, 0)$ 处计算每一项：\n1. 在 $x_2=0$ 时，$C(0) = 0$。因此 $C(x_2) \\nabla f_2(x)$ 这一项在 $x^\\star$ 处为零。\n2. $\\nabla f_1(x)$ 就是 $\\nabla(L_f h(x))$。在 $x^\\star$ 处，$\\nabla f_1(x^\\star) = \\begin{pmatrix} -\\beta_1 \\\\ 0 \\end{pmatrix}$。所以，$-\\beta_1 \\nabla f_1(x^\\star) = \\begin{pmatrix} \\beta_1^2 \\\\ 0 \\end{pmatrix}$。\n3. 我们需要计算 $f_2(x^\\star)$ 和 $\\nabla C(x_2)|_{x^\\star}$。\n$$\nf_2(x^\\star) = \\alpha_2\\,\\frac{K_2^m}{K_2^m + K_2^m} - \\beta_2(0) = \\frac{\\alpha_2}{2}\n$$\n$C(x_2)$ 的梯度是 $\\nabla C(x_2) = \\begin{pmatrix} 0 \\\\ C'(x_2) \\end{pmatrix}$。\n$$\nC'(x_2) = \\frac{d}{d x_2} \\left( \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\right) = 2 \\alpha_1 K_1^2 \\frac{(K_1^2 + x_2^2)^2 - x_2 \\cdot 2(K_1^2+x_2^2)(2x_2)}{(K_1^2 + x_2^2)^4} = 2 \\alpha_1 K_1^2 \\frac{K_1^2 - 3x_2^2}{(K_1^2 + x_2^2)^3}\n$$\n在 $x_2=0$ 处求值：\n$$\nC'(0) = 2 \\alpha_1 K_1^2 \\frac{K_1^2}{(K_1^2)^3} = \\frac{2 \\alpha_1}{K_1^2}\n$$\n所以，$\\nabla C(x_2)|_{x^\\star} = \\begin{pmatrix} 0 \\\\ \\frac{2 \\alpha_1}{K_1^2} \\end{pmatrix}$。\n4. 最后一项变为 $f_2(x^\\star) \\nabla C(x_2)|_{x^\\star} = \\frac{\\alpha_2}{2} \\begin{pmatrix} 0 \\\\ \\frac{2 \\alpha_1}{K_1^2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$。\n\n综合各部分，二阶李导数在 $x^\\star$ 处的梯度为：\n$$\n\\nabla(L_f^2 h(x^\\star)) = \\begin{pmatrix} \\beta_1^2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix} = \\begin{pmatrix} \\beta_1^2 \\\\ \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}\n$$\n可观测性矩阵在 $x^\\star$ 处的第三行是 $\\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$。\n\n**步骤4：组装并计算 $\\mathcal{O}(x^\\star)$ 的秩**\n\n我们通过在 $x^\\star=(K_2, 0)$ 处计算每一行来组装可观测性矩阵：\n- 第1行: $\\begin{pmatrix} 1  0 \\end{pmatrix}$\n- 第2行: $\\begin{pmatrix} -\\beta_1  \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix}\\Big|_{x_2=0} = \\begin{pmatrix} -\\beta_1  0 \\end{pmatrix}$\n- 第3行: $\\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$\n\n该矩阵为：\n$$\n\\mathcal{O}(x^\\star) = \\begin{pmatrix} 1  0 \\\\ -\\beta_1  0 \\\\ \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}\n$$\n为了求这个 $3 \\times 2$ 矩阵的秩，我们检查其行向量的线性无关性。\n第二行是第一行的 $-\\beta_1$ 倍，所以它们是线性相关的。该矩阵的秩由第一行和第三行的张成空间决定。\n第一行是 $R_1 = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n第三行是 $R_3 = \\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$。\n\n这两行线性无关，当且仅当它们构成的矩阵的行列式不为零：\n$$\n\\det \\begin{pmatrix} 1  0 \\\\ \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix} = (1) \\left( \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\right) - (0) (\\beta_1^2) = \\frac{\\alpha_1 \\alpha_2}{K_1^2}\n$$\n根据题目陈述，参数 $\\alpha_1$、$\\alpha_2$ 和 $K_1$ 都是严格为正的。因此，它们的乘积和比值 $\\frac{\\alpha_1 \\alpha_2}{K_1^2}$ 也是严格为正且非零的。\n由于行列式非零，向量 $\\begin{pmatrix} 1  0 \\end{pmatrix}$ 和 $\\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$ 是线性无关的。\n$\\mathcal{O}(x^\\star)$ 的行空间由这两个向量张成，因此其维度为 $2$。\n因此，矩阵 $\\mathcal{O}(x^\\star)$ 的秩为 $2$。这意味着该系统在状态点 $x^\\star$ 是局部可观测的，尽管 $x_2$ 未被测量，并且在 $x_2=0$ 时其对测量导数 $\\dot{x}_1$ 的直接影响为零。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "可观测性秩条件虽然强大，但它仅保证了局部意义上的可观测性。本练习旨在探讨局部可观测性与全局可观测性之间关键而微妙的区别，这也是非线性系统的一个标志性特征。你将使用一个能够表现出双稳态的经典对称“拨动开关”基因调控模型，来证明两个不同的初始状态如何能够产生完全相同的输出轨迹，从而说明该系统尽管在结构上是可观测的，但并非全局可观测。",
            "id": "3334899",
            "problem": "考虑一个无外部输入的对称相互抑制基因触发开关模型，这是计算系统生物学中的一个标准模体，其状态向量 $x = (x_1, x_2)$ 代表两种相互抑制的转录因子的浓度。其动力学由下式给出：\n$$\n\\begin{aligned}\n\\dot{x}_1 = \\frac{\\alpha}{1 + \\left(\\frac{x_2}{K}\\right)^{n}} - \\delta\\, x_1,\\\\\n\\dot{x}_2 = \\frac{\\alpha}{1 + \\left(\\frac{x_1}{K}\\right)^{n}} - \\delta\\, x_2,\n\\end{aligned}\n$$\n其中 $\\alpha  0$ 是最大合成速率，$\\delta  0$ 是一阶降解/稀释速率，$K  0$ 是解离常数，$n \\ge 2$ 是描述协同性的希尔系数。假设参数选择在一个已知会产生双稳态的范围内（两个线性稳定的非对角线平衡点和一个在对角线上的不稳定平衡点），对于足够大的 $n$ 和 $\\alpha/\\delta$，这是此类触发开关一个有充分文献记载的特性。\n\n假设唯一的测量输出是总浓度：\n$$\ny = h(x) = x_1 + x_2.\n$$\n\n仅使用非线性系统理论的基本定义（基于李导数的局部可观测性秩条件，以及结构可观测性作为相对于参数的泛型性质的概念），完成以下任务：\n\n1. 在泛型状态 $x$ 处，通过堆叠 $h(x)$ 及其沿向量场 $f(x)$ 的一阶李导数的梯度，构建 $2 \\times 2$ 的局部可观测性矩阵，其中 $f(x)$ 表示状态方程的右侧。显式地计算该矩阵的行列式，作为 $x_1$, $x_2$, $\\alpha$, $\\delta$, $K$ 和 $n$ 的函数。\n\n2. 使用你的表达式，从第一性原理出发论证为什么该系统是结构可观测的，即，对于一个开稠密集的参数值，为什么局部可观测性秩条件在状态空间的一个全测度子集上成立。\n\n3. 利用交换对称性 $x_1 \\leftrightarrow x_2$ 和假设的双稳态，证明输入-输出映射 $x_0 \\mapsto y(t \\mid x_0)$ 不是全局单射的，因为存在不同的初始条件，它们对所有 $t \\ge 0$ 产生相同的输出轨迹，特别是，存在具有相同稳态输出的不同稳定稳态。定义 $m$ 为在给定输出 $h(x) = x_1 + x_2$ 下，产生相同输出轨迹 $y(t)$（对所有 $t \\ge 0$）的不可区分初始条件 $x_0$ 和 $x_0'$ 集合的泛型基数。\n\n将 $m$ 的值报告为一个无单位的单一数字。无需四舍五入。",
            "solution": "该问题要求分析对称基因触发开关模型的可观测性性质。分析的关键在于基于李导数的局部可观测性秩条件以及系统的内在交换对称性。\n\n设系统状态为 $x = (x_1, x_2)^T \\in \\mathbb{R}^2$，其中 $x_1 \\ge 0$ 且 $x_2 \\ge 0$。动力学由向量场 $f(x) = (f_1(x), f_2(x))^T$ 控制，其中\n$$\n\\begin{aligned}\nf_1(x) = \\frac{\\alpha}{1 + \\left(\\frac{x_2}{K}\\right)^{n}} - \\delta\\, x_1 \\\\\nf_2(x) = \\frac{\\alpha}{1 + \\left(\\frac{x_1}{K}\\right)^{n}} - \\delta\\, x_2\n\\end{aligned}\n$$\n输出由函数 $y = h(x) = x_1 + x_2$ 给出。\n\n非线性系统 $\\dot{x} = f(x)$, $y = h(x)$ 在点 $x$ 处的局部可观测性是通过可观测性矩阵 $\\mathcal{O}(x)$ 来评估的，该矩阵由输出函数 $h(x)$ 的连续李导数的梯度构成。对于一个二维系统，我们通常需要检查由 $h(x)$ 的梯度及其一阶李导数 $L_f h(x)$ 的梯度所形成的矩阵的秩。\n\n**1. 可观测性矩阵及其行列式的构建**\n\n$2 \\times 2$ 的局部可观测性矩阵由下式给出：\n$$\n\\mathcal{O}(x) = \\begin{pmatrix} \\nabla h(x) \\\\ \\nabla(L_f h(x)) \\end{pmatrix}\n$$\n首先，我们计算输出函数 $h(x) = x_1 + x_2$ 的梯度：\n$$\n\\nabla h(x) = \\begin{bmatrix} \\frac{\\partial h}{\\partial x_1}  \\frac{\\partial h}{\\partial x_2} \\end{bmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix}\n$$\n接下来，我们计算 $h(x)$ 沿向量场 $f(x)$ 的一阶李导数：\n$$\nL_f h(x) = \\nabla h(x) \\cdot f(x) = 1 \\cdot f_1(x) + 1 \\cdot f_2(x)\n$$\n$$\nL_f h(x) = \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_2}{K}\\right)^{n}} - \\delta\\, x_1 \\right) + \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_1}{K}\\right)^{n}} - \\delta\\, x_2 \\right) = \\frac{\\alpha}{1 + (x_2/K)^n} + \\frac{\\alpha}{1 + (x_1/K)^n} - \\delta(x_1 + x_2)\n$$\n现在，我们计算 $L_f h(x)$ 的梯度。我们求它关于 $x_1$ 和 $x_2$ 的偏导数：\n$$\n\\frac{\\partial}{\\partial x_1} (L_f h(x)) = \\frac{\\partial}{\\partial x_1} \\left( \\frac{\\alpha}{1 + (x_1/K)^n} - \\delta x_1 \\right) = \\alpha \\frac{-\\frac{n}{K} \\left(\\frac{x_1}{K}\\right)^{n-1}}{\\left(1 + (x_1/K)^n\\right)^2} - \\delta = -\\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} - \\delta\n$$\n$$\n\\frac{\\partial}{\\partial x_2} (L_f h(x)) = \\frac{\\partial}{\\partial x_2} \\left( \\frac{\\alpha}{1 + (x_2/K)^n} - \\delta x_2 \\right) = \\alpha \\frac{-\\frac{n}{K} \\left(\\frac{x_2}{K}\\right)^{n-1}}{\\left(1 + (x_2/K)^n\\right)^2} - \\delta = -\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta\n$$\n现在我们可以组装可观测性矩阵 $\\mathcal{O}(x)$：\n$$\n\\mathcal{O}(x) = \\begin{pmatrix} 1  1 \\\\ -\\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} - \\delta  -\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta \\end{pmatrix}\n$$\n该矩阵的行列式为：\n$$\n\\det(\\mathcal{O}(x)) = 1 \\cdot \\left(-\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta\\right) - 1 \\cdot \\left(-\\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} - \\delta\\right)\n$$\n$$\n\\det(\\mathcal{O}(x)) = -\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta + \\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} + \\delta\n$$\n$$\n\\det(\\mathcal{O}(x)) = \\alpha n K^n \\left( \\frac{x_1^{n-1}}{(K^n + x_1^n)^2} - \\frac{x_2^{n-1}}{(K^n + x_2^n)^2} \\right)\n$$\n\n**2. 结构可观测性的论证**\n\n如果可观测性矩阵 $\\mathcal{O}(x)$ 具有满秩，则系统在状态 $x$ 处是局部可观测的。对于这个二维系统，这意味着 $\\text{rank}(\\mathcal{O}(x)) = 2$，等价于 $\\det(\\mathcal{O}(x)) \\neq 0$。如果对于一个开稠密集的参数，秩条件失效的状态 $x$ 集合（即 $\\det(\\mathcal{O}(x)) = 0$）在状态空间中是一个零测度集，则该系统是结构可观测的。\n\n行列式为零当且仅当：\n$$\n\\frac{x_1^{n-1}}{(K^n + x_1^n)^2} = \\frac{x_2^{n-1}}{(K^n + x_2^n)^2}\n$$\n这个方程对于线 $x_1 = x_2$ 上的所有点都显然成立。这条线是二维状态空间中的一个一维子流形，因此具有零勒贝格测度。函数 $g(z) = \\frac{z^{n-1}}{(K^n + z^n)^2}$ 在 $z \\ge 0$ 上不是单调的，因此可能存在其他解的曲线，使得当 $x_1 \\neq x_2$ 时有 $g(x_1)=g(x_2)$。然而，所有这些点 $(x_1, x_2)$ 的集合在 $\\mathbb{R}^2$ 中形成一个低维代数簇。由于参数 $\\alpha, n, K, \\delta$ 均不为零，行列式是 $x_1$ 和 $x_2$ 的一个非平凡解析函数。因此，其零点集是一个零测度集。这满足了结构可观测性的条件。该系统对于几乎所有状态 $x$ 都是局部可观测的。\n\n**3. 全局非单射性与不可区分状态的基数**\n\n系统不是全局可观测的，这意味着从初始条件 $x_0$ 到整个输出轨迹 $y(t \\mid x_0)$ 的映射不是单射的。这是系统对称性的直接后果。\n\n设 $S$ 为交换算子：$S(x_1, x_2) = (x_2, x_1)$。向量场 $f(x)$ 关于 $S$ 是等变的。要看到这一点，令 $x' = S(x) = (x_2, x_1)$。\n$$f(x') = f(x_2, x_1) = \\begin{pmatrix} \\frac{\\alpha}{1 + (x_1/K)^n} - \\delta x_2 \\\\ \\frac{\\alpha}{1 + (x_2/K)^n} - \\delta x_1 \\end{pmatrix} = \\begin{pmatrix} f_2(x_1, x_2) \\\\ f_1(x_1, x_2) \\end{pmatrix} = S(f(x))$$\n输出函数 $h(x) = x_1 + x_2$ 在 $S$ 作用下是不变的：\n$$h(S(x)) = h(x_2, x_1) = x_2 + x_1 = x_1 + x_2 = h(x)$$\n现在，考虑从初始条件 $x_0$ 出发的解轨迹 $x(t)$，使得 $\\dot{x}(t) = f(x(t))$ 且 $x(0)=x_0$。我们定义一个新的轨迹 $z(t) = S(x(t))$。$z(t)$ 的初始条件是 $z(0) = S(x(0)) = S(x_0)$。$z(t)$ 的动力学由下式给出：\n$$\n\\dot{z}(t) = \\frac{d}{dt} S(x(t)) = S(\\dot{x}(t)) = S(f(x(t)))\n$$\n利用 $f$ 的等变性，我们有 $S(f(x(t))) = f(S(x(t))) = f(z(t))$。因此，$\\dot{z}(t) = f(z(t))$。这表明，如果 $x(t)$ 是从 $x_0$ 出发的一条有效轨迹，那么 $z(t) = S(x(t))$ 就是从不同的初始点 $S(x_0)$ 出发的一条有效轨迹（前提是 $x_0$ 不在对称线 $x_1=x_2$ 上）。\n\n让我们比较从初始条件 $x_0$ 和 $S(x_0)$ 生成的输出。从 $x_0$ 的输出是 $y(t) = h(x(t))$。从 $S(x_0)$ 的输出是 $y'(t) = h(z(t)) = h(S(x(t)))$。由于 $h$ 的不变性，我们有 $h(S(x(t))) = h(x(t))$。因此，对于所有 $t \\ge 0$，都有 $y'(t) = y(t)$。\n\n这证明了任何两个不同的初始条件 $x_0$ 和 $S(x_0)$（即 $x_0$ 不在直线 $x_1=x_2$ 上）从输出 $y(t)$ 来看是不可区分的。\n\n问题的双稳态假设提供了一个具体的例子。两个稳定稳态，称之为 $x_A^* = (x_{hi}, x_{lo})$ 和 $x_B^* = (x_{lo}, x_{hi})$，通过这种对称性相关联：$x_B^* = S(x_A^*)$。两者的稳态输出都是 $y^* = x_{hi} + x_{lo}$，这使得它们不可区分。在 $x_A^*$ 的初始条件会产生一个恒定的输出 $y^*$，在 $x_B^*$ 的初始条件也会产生恒定的输出 $y^*$。\n\n问题要求的是 $m$，即不可区分初始条件集合的泛型基数。一个“泛型”初始条件 $x_0$ 是指不位于任何特殊的、低维流形上的条件。在这种情况下，这意味着 $x_0$ 不在不可观测点集上，特别是不在对称线 $x_1=x_2$ 上。对于这样一个 $x_{1,0} \\neq x_{2,0}$ 的泛型初始条件 $x_0 = (x_{1,0}, x_{2,0})$，产生相同输出轨迹的初始条件集合是 $\\{x_0, S(x_0)\\} = \\{(x_{1,0}, x_{2,0}), (x_{2,0}, x_{1,0})\\}$。这个集合的基数是 2。因此，$m=2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "从理论分析转向实际计算，我们可以量化不同状态组合的可观测“程度”。本练习将介绍经验可观测性格拉姆矩阵（empirical observability Gramian），一个实现此目的的强大数值工具。你将模拟一个米氏动力学系统，通过输出敏感度计算该格拉姆矩阵，并分析其特征向量，以识别状态空间中“最可观测”和“最不可观测”的方向，这为实验设计提供了直接的洞见。",
            "id": "3334890",
            "problem": "给定一个非线性的两状态生化反应系统，它代表了在准稳态酶假设下的 Michaelis–Menten 机制，表示为状态变量 $x(t) = [s(t), c(t)]^\\top$ 的常微分方程（ODE），其中 $s(t)$ 表示底物浓度，$c(t)$ 表示酶-底物复合物浓度。总酶浓度 $E_{\\mathrm{tot}}$ 是恒定的，游离酶浓度为 $e(t) = E_{\\mathrm{tot}} - c(t)$，其动力学遵循质量作用动力学：\n$$\n\\frac{ds}{dt} = -k_1\\, e(t)\\, s(t) + k_{-1}\\, c(t), \\quad\n\\frac{dc}{dt} = k_1\\, e(t)\\, s(t) - \\left(k_{-1} + k_{\\mathrm{cat}}\\right) c(t).\n$$\n测量输出为标量，定义为 $y(t) = s(t)$。\n\n目标：基于输出对初始条件小扰动的灵敏度，计算该非线性系统的经验可观测性格拉姆矩阵，并将其特征向量解释为状态空间中最可观测和最不可观测的方向。\n\n使用的基本原理：\n- 质量作用动力学和上述 ODE 模型。\n- 对于具有输出 $y(t)$ 和初始条件 $x(0) = x_0$ 的非线性系统，定义输出相对于初始条件的灵敏度为向量\n$$\ng(t) = \\frac{\\partial y(t)}{\\partial x_0} \\in \\mathbb{R}^{2}.\n$$\n- 定义经验可观测性格拉姆矩阵为\n$$\nW_o = \\int_{0}^{T} g(t)\\, g(t)^\\top\\, dt \\in \\mathbb{R}^{2 \\times 2}.\n$$\n\n数值近似要求：\n- 使用大小为 $\\delta$ 的中心有限差分，沿标准基方向 $e_1 = [1,0]^\\top$ 和 $e_2 = [0,1]^\\top$ 来近似 $g(t)$：\n$$\ng_i(t) \\approx \\frac{y\\!\\left(t; x_0 + \\delta e_i\\right) - y\\!\\left(t; x_0 - \\delta e_i\\right)}{2 \\delta}, \\quad i \\in \\{1,2\\}.\n$$\n- 使用稳定的 ODE 求解器，在 $[0, T]$ 上的一个包含 $N$ 个点的均匀时间网格上，对每个受扰动的初始条件进行 ODE 的数值积分。使用复合梯形法则来近似时间积分：\n$$\nW_o \\approx \\sum_{k=0}^{N-2} \\frac{\\Delta t_k}{2}\\left(g(t_k) g(t_k)^\\top + g(t_{k+1}) g(t_{k+1})^\\top\\right),\n$$\n其中 $\\Delta t_k = t_{k+1} - t_k$，$t_0 = 0$，且 $t_{N-1} = T$。\n- 在 $[0, T]$ 上使用 $N = 2001$ 个均匀间隔的时间点。\n\n特征分解与解释：\n- 计算 $W_o$ 的特征值和特征向量。设 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 表示最小和最大的特征值，其对应的单位范数特征向量为 $v_{\\min}$ 和 $v_{\\max}$。\n- 将 $v_{\\max}$ 解释为状态空间中最可观测的方向，将 $v_{\\min}$ 解释为最不可观测的方向。\n- 为解决特征向量的符号不确定性，强制执行以下约定：对于每个特征向量 $v = [v_1, v_2]^\\top$，如果第一个非零分量为负，则将 $v$ 乘以 $-1$。\n\n数值公差：\n- 对于 ODE 求解器，使用绝对公差 $\\mathrm{atol} = 10^{-12}$ 和相对公差 $\\mathrm{rtol} = 10^{-9}$。\n\n测试套件：\n对于每个测试案例，参数为 $(k_1, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, s_0, c_0, T, \\delta)$，初始条件为 $x_0 = [s_0, c_0]^\\top$。使用以下四个案例：\n- 案例 1：$(k_1, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, s_0, c_0, T, \\delta) = (1.0, 0.5, 0.2, 1.0, 2.0, 0.05, 10.0, 10^{-4})$。\n- 案例 2：$(k_1, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, s_0, c_0, T, \\delta) = (3.0, 1.0, 1.5, 0.2, 5.0, 0.05, 5.0, 10^{-5})$。\n- 案例 3：$(k_1, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, s_0, c_0, T, \\delta) = (1.5, 0.1, 2.0, 0.05, 1.0, 0.01, 8.0, 10^{-5})$。\n- 案例 4：$(k_1, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, s_0, c_0, T, \\delta) = (0.05, 0.02, 0.01, 1.0, 0.2, 0.01, 20.0, 10^{-5})$。\n\n要求的输出：\n- 对于每个测试案例，计算并返回列表\n$$\n\\left[\\mathrm{round}\\left(\\lambda_{\\max}, 6\\right), \\ \\mathrm{round}\\left(\\lambda_{\\min}, 6\\right), \\ \\mathrm{round}\\left(v_{\\max,1}, 6\\right), \\ \\mathrm{round}\\left(v_{\\max,2}, 6\\right), \\ \\mathrm{round}\\left(v_{\\min,1}, 6\\right), \\ \\mathrm{round}\\left(v_{\\min,2}, 6\\right)\\right],\n$$\n其中 $v_{\\max,i}$ 和 $v_{\\min,i}$ 分别表示 $v_{\\max}$ 和 $v_{\\min}$ 的第 $i$ 个分量。所有舍入必须保留到小数点后 $6$ 位。\n- 最终的程序输出必须是单行，包含四个案例结果的列表，每个结果都按上述列表格式化，并连接成一个单一的列表之列表，使用逗号作为分隔符，不含空格。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个以逗号分隔的列表，该列表用方括号括起来（例如，$[[...],[...],[...],[...]]$）。不得打印任何额外文本。",
            "solution": "该问题要求计算并解释一个由 Michaelis-Menten 动力学描述的非线性生化系统的经验可观测性格拉姆矩阵。分析过程将首先验证问题陈述，然后详细阐述获得解决方案的数值方法。\n\n### 第1步：提取已知信息\n问题提供了以下信息：\n- **状态向量**：$x(t) = [s(t), c(t)]^\\top$，其中 $s(t)$ 是底物浓度，$c(t)$ 是酶-底物复合物浓度。\n- **系统动力学（ODE）**：\n$$\n\\frac{ds}{dt} = -k_1\\, e(t)\\, s(t) + k_{-1}\\, c(t) \\\\\n\\frac{dc}{dt} = k_1\\, e(t)\\, s(t) - \\left(k_{-1} + k_{\\mathrm{cat}}\\right) c(t)\n$$\n- **辅助关系**：游离酶浓度为 $e(t) = E_{\\mathrm{tot}} - c(t)$，其中 $E_{\\mathrm{tot}}$ 是恒定的总酶浓度。\n- **测量输出**：$y(t) = s(t)$。\n- **输出灵敏度**：输出对初始条件 $x_0$ 的灵敏度定义为 $g(t) = \\frac{\\partial y(t)}{\\partial x_0} \\in \\mathbb{R}^{2}$。\n- **经验可观测性格拉姆矩阵**：格拉姆矩阵由积分 $W_o = \\int_{0}^{T} g(t)\\, g(t)^\\top\\, dt \\in \\mathbb{R}^{2 \\times 2}$ 定义。\n- **灵敏度的数值近似**：灵敏度向量的分量 $g_i(t)$ 将使用中心有限差分进行近似：\n$$\ng_i(t) \\approx \\frac{y\\!\\left(t; x_0 + \\delta e_i\\right) - y\\!\\left(t; x_0 - \\delta e_i\\right)}{2 \\delta}, \\quad i \\in \\{1,2\\}\n$$\n其中 $e_1 = [1,0]^\\top$，$e_2 = [0,1]^\\top$。\n- **格拉姆矩阵的数值积分**：$W_o$ 的积分将使用复合梯形法则在均匀时间网格上进行近似。\n- **数值参数**：\n  - 时间网格：在 $[0, T]$ 上有 $N = 2001$ 个均匀间隔的点。\n  - ODE 求解器公差：绝对公差 $\\mathrm{atol} = 10^{-12}$，相对公差 $\\mathrm{rtol} = 10^{-9}$。\n- **特征分解**：将计算 $W_o$ 的特征值（$\\lambda_{\\min}, \\lambda_{\\max}$）和特征向量（$v_{\\min}, v_{\\max}$）。$v_{\\max}$ 对应最可观测方向，$v_{\\min}$ 对应最不可观测方向。\n- **特征向量符号约定**：对于每个特征向量，第一个非零分量必须为正。\n- **测试案例**：已提供四个案例。\n- **输出格式**：对于每个案例，输出一个包含六个舍入值的列表。\n\n### 第2步：使用提取的已知信息进行验证\n根据既定标准对问题进行评估：\n- **科学基础**：该问题基于 Michaelis-Menten 反应机理（生物化学中的一个基本概念），并采用标准的质量作用动力学。可观测性格拉姆矩阵的概念是控制理论的基石，其在系统生物学中的应用已得到广泛认可。所提议的数值方法是标准且恰当的。\n- **适定性**：问题被完全指定。它提供了控制 ODE、待计算量（$W_o$）的定义、要使用的数值方法、四个不同测试案例的所有必要参数和初始条件，以及精确的输出格式。可以确定一个唯一的数值结果。\n- **客观性**：问题以精确的数学语言陈述，没有任何主观性或歧义。\n- **缺陷检查表**：该问题不违反任何无效性标准。它科学合理、可形式化、完整、现实、适定且不平凡。提及“准稳态酶假设”是上下文背景，并未造成矛盾，因为已提供了要使用的完整显式 ODE。\n\n### 第3步：结论与行动\n该问题是**有效的**。将制定一个完整的解决方案。\n\n### 基于原理的解决方案设计\n这个问题的核心是评估系统的可观测性，即可否通过观测其输出来确定系统的内部状态。对于非线性系统，这通常是局部进行分析的。经验可观测性格拉姆矩阵 $W_o$ 为此属性提供了定量度量。$W_o$ 的大特征值表明，相应特征向量方向上的扰动在输出中高度可见，而小特征值则表明在该方向上的可观测性较差。\n\n解决此问题的算法如下：\n\n1.  **定义系统动力学**：必须将所提供的 ODE 系统形式化为一个适合数值求解器的函数。状态为 $x = [s, c]^\\top$。该 ODE 函数（我们称之为 `ode_func`）将以时间 $t$、状态 $x$ 以及参数 $(k_1, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}})$ 作为输入，并返回状态导数 $dx/dt = [\\dot{s}, \\dot{c}]^\\top$。\n\n2.  **生成受扰动轨迹**：为了通过有限差分计算输出灵敏度 $g(t) = \\partial y(t) / \\partial x_0$，我们必须模拟系统从受扰动的初始条件演化的过程。对于初始状态 $x_0 = [s_0, c_0]^\\top$ 的每个分量 $i$，我们定义两个受扰动的初始条件：\n    - $x_{0,i}^+ = x_0 + \\delta e_i$\n    - $x_{0,i}^- = x_0 - \\delta e_i$\n    其中 $e_1 = [1, 0]^\\top$，$e_2 = [0, 1]^\\top$。这导致需要模拟四个初始条件。使用高精度 ODE 求解器，在指定的公差下，在 $N=2001$ 个点的均匀时间网格上，对这些初始条件中的每一个从 $t=0$ 到 $t=T$ 进行积分。\n\n3.  **计算灵敏度向量**：从四个模拟轨迹中，我们提取输出 $y(t) = s(t)$。设 $y(t; x_{0,i}^{\\pm})$ 表示对应于初始条件 $x_{0,i}^{\\pm}$ 的输出轨迹。然后，对于网格中的每个时间点，计算灵敏度向量 $g(t) = [g_1(t), g_2(t)]^\\top$ 的两个分量：\n    $$\n    g_1(t) = \\frac{y(t; x_{0,1}^+) - y(t; x_{0,1}^-)}{2 \\delta} \\\\\n    g_2(t) = \\frac{y(t; x_{0,2}^+) - y(t; x_{0,2}^-)}{2 \\delta}\n    $$\n    这将产生两个时间序列向量，每个灵敏度分量一个。\n\n4.  **计算可观测性格拉姆矩阵**：格拉姆矩阵 $W_o$ 是外积 $g(t)g(t)^\\top$ 的时间积分。\n    $$\n    W_o = \\int_{0}^{T} \\begin{pmatrix} g_1(t)^2  g_1(t) g_2(t) \\\\ g_1(t) g_2(t)  g_2(t)^2 \\end{pmatrix} dt = \\begin{pmatrix} \\int_{0}^{T} g_1(t)^2 dt  \\int_{0}^{T} g_1(t) g_2(t) dt \\\\ \\int_{0}^{T} g_1(t) g_2(t) dt  \\int_{0}^{T} g_2(t)^2 dt \\end{pmatrix}\n    $$\n    每个积分都使用复合梯形法则进行数值计算。\n\n5.  **特征分解与解释**：一旦组装好 $2 \\times 2$ 对称矩阵 $W_o$，就使用标准线性代数例程计算其特征值和特征向量。因为 $W_o$ 是对称且至少是半正定的，所以其特征值将是实数且非负的。\n    - $\\lambda_{\\min}$ 是较小的特征值；其特征向量 $v_{\\min}$ 是最不可观测方向。\n    - $\\lambda_{\\max}$ 是较大的特征值；其特征向量 $v_{\\max}$ 是最可观测方向。\n\n6.  **最终确定与格式化**：计算出的特征向量必须进行调整以满足符号约定：第一个非零分量必须为正。这通过检查符号并在必要时将整个特征向量乘以 $-1$ 来完成。最后，将所需的六个值（$\\lambda_{\\max}, \\lambda_{\\min}, v_{\\max,1}, v_{\\max,2}, v_{\\min,1}, v_{\\min,2}$）舍入到小数点后 $6$ 位。\n\n对所提供的四个测试案例中的每一个重复此完整过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the empirical observability Gramian and its eigensystem for a \n    nonlinear biochemical reaction system for four given test cases.\n    \"\"\"\n\n    test_cases = [\n        # (k1, k_m1, k_cat, E_tot, s0, c0, T, delta)\n        (1.0, 0.5, 0.2, 1.0, 2.0, 0.05, 10.0, 1e-4),\n        (3.0, 1.0, 1.5, 0.2, 5.0, 0.05, 5.0, 1e-5),\n        (1.5, 0.1, 2.0, 0.05, 1.0, 0.01, 8.0, 1e-5),\n        (0.05, 0.02, 0.01, 1.0, 0.2, 0.01, 20.0, 1e-5),\n    ]\n\n    results = []\n\n    # ODE solver tolerances\n    atol = 1e-12\n    rtol = 1e-9\n    \n    # Number of time points\n    N = 2001\n\n    def ode_func(t, x, k1, k_m1, k_cat, E_tot):\n        \"\"\"\n        Defines the ODE system for the Michaelis-Menten kinetics.\n        x = [s, c]\n        \"\"\"\n        s, c = x\n        e = E_tot - c\n        ds_dt = -k1 * e * s + k_m1 * c\n        dc_dt = k1 * e * s - (k_m1 + k_cat) * c\n        return [ds_dt, dc_dt]\n\n    def fix_eigenvector_sign(v):\n        \"\"\"\n        Enforces a sign convention on an eigenvector: the first non-zero\n        component must be positive.\n        \"\"\"\n        for i in range(len(v)):\n            if not np.isclose(v[i], 0.0):\n                if v[i]  0:\n                    return -v\n                break\n        return v\n\n    for case in test_cases:\n        k1, k_m1, k_cat, E_tot, s0, c0, T, delta = case\n        \n        x0 = np.array([s0, c0])\n        t_span = (0, T)\n        t_eval = np.linspace(0, T, N)\n        \n        args = (k1, k_m1, k_cat, E_tot)\n\n        # Perturbations along a canonical basis direction e1 = [1, 0]\n        x0_s_p = x0 + np.array([delta, 0])\n        x0_s_m = x0 - np.array([delta, 0])\n        \n        sol_s_p = solve_ivp(ode_func, t_span, x0_s_p, args=args, t_eval=t_eval, rtol=rtol, atol=atol, method='RK45')\n        sol_s_m = solve_ivp(ode_func, t_span, x0_s_m, args=args, t_eval=t_eval, rtol=rtol, atol=atol, method='RK45')\n        \n        y_s_p = sol_s_p.y[0]\n        y_s_m = sol_s_m.y[0]\n\n        # Perturbations along a canonical basis direction e2 = [0, 1]\n        x0_c_p = x0 + np.array([0, delta])\n        x0_c_m = x0 - np.array([0, delta])\n\n        sol_c_p = solve_ivp(ode_func, t_span, x0_c_p, args=args, t_eval=t_eval, rtol=rtol, atol=atol, method='RK45')\n        sol_c_m = solve_ivp(ode_func, t_span, x0_c_m, args=args, t_eval=t_eval, rtol=rtol, atol=atol, method='RK45')\n        \n        y_c_p = sol_c_p.y[0]\n        y_c_m = sol_c_m.y[0]\n        \n        # Calculate sensitivity vectors g1(t) and g2(t) using central finite differences\n        g1_t = (y_s_p - y_s_m) / (2 * delta)\n        g2_t = (y_c_p - y_c_m) / (2 * delta)\n        \n        # Define the integrands for the Gramian matrix elements\n        integrand_11 = g1_t**2\n        integrand_12 = g1_t * g2_t\n        integrand_22 = g2_t**2\n        \n        # Integrate using the composite trapezoidal rule\n        W_o_11 = np.trapz(integrand_11, t_eval)\n        W_o_12 = np.trapz(integrand_12, t_eval)\n        W_o_22 = np.trapz(integrand_22, t_eval)\n        \n        # Assemble the observability Gramian\n        W_o = np.array([[W_o_11, W_o_12], [W_o_12, W_o_22]])\n        \n        # Compute eigenvalues and eigenvectors\n        # np.linalg.eigh returns eigenvalues in ascending order for symmetric matrices\n        eigvals, eigvecs = np.linalg.eigh(W_o)\n        \n        lambda_min, lambda_max = eigvals[0], eigvals[1]\n        v_min, v_max = eigvecs[:, 0], eigvecs[:, 1]\n        \n        # Enforce sign convention\n        v_min = fix_eigenvector_sign(v_min)\n        v_max = fix_eigenvector_sign(v_max)\n        \n        # Format results for the current case\n        case_result = [\n            round(lambda_max, 6),\n            round(lambda_min, 6),\n            round(v_max[0], 6),\n            round(v_max[1], 6),\n            round(v_min[0], 6),\n            round(v_min[1], 6),\n        ]\n        results.append(case_result)\n\n    # Print the final output in the required format\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}