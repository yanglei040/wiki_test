{
    "hands_on_practices": [
        {
            "introduction": "掌握非线性可观测性分析的第一步是熟练运用其核心数学工具。本练习旨在通过一个具有协同激活特性的双物种生化调控模块，为您提供直接的实践机会。您将亲手计算输出函数及其沿系统动力学的连续李导数，构建可观测性矩阵，并在一个特定状态点评估其秩，从而判断系统的局部可观测性 。",
            "id": "3334957",
            "problem": "考虑一个具有协同激活作用的双物种生物化学调控模块，其模型由以下非线性常微分方程组描述\n$$\n\\dot{x}_1 \\;=\\; \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} \\;-\\; \\beta_1\\,x_1, \n\\qquad\n\\dot{x}_2 \\;=\\; \\alpha_2\\,\\frac{x_1^m}{K_2^m + x_1^m} \\;-\\; \\beta_2\\,x_2,\n$$\n其中 $x_1$ 和 $x_2$ 是浓度，$\\alpha_1, \\alpha_2, \\beta_1, \\beta_2, K_1, K_2$ 是严格正数，而 $m \\geq 1$ 是一个整数希尔系数，用于捕捉 $x_1$ 对 $x_2$ 生成的协同性。假设只测量第一个物种，其输出为\n$$\nh(x) \\;=\\; x_1.\n$$\n使用标量函数 $h$ 沿向量场 $f$ 的李导数的定义，即 $L_f h(x) = \\nabla h(x)\\cdot f(x)$，及其递归式 $L_f^{k+1} h(x) = \\nabla \\big(L_f^k h(x)\\big)\\cdot f(x)$（对于 $k \\geq 0$）。明确计算 $h(x)$、$L_f h(x)$ 和 $L_f^2 h(x)$，以及它们的梯度 $\\nabla h(x)$、$\\nabla \\big(L_f h(x)\\big)$ 和 $\\nabla \\big(L_f^2 h(x)\\big)$。然后，构造一个可观测性矩阵 $\\mathcal{O}(x)$，其行是这些梯度，并计算其在以下状态下的秩\n$$\nx^\\star \\;=\\; (K_2,\\,0),\n$$\n该状态表示第二个物种浓度接近于零，而第一个物种处于一个非零的基线水平。请提供 $\\mathcal{O}(x^\\star)$ 的秩的整数值作为最终答案。",
            "solution": "该问题要求在状态空间的特定点上分析一个非线性生物化学系统的局部可观测性。该系统由状态向量 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 描述，其动力学由向量场 $f(x) = \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix}$ 控制，其中\n$$\nf_1(x) = \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1\n$$\n$$\nf_2(x) = \\alpha_2\\,\\frac{x_1^m}{K_2^m + x_1^m} - \\beta_2\\,x_2\n$$\n输出函数为 $h(x) = x_1$。\n\n可观测性使用可观测性矩阵 $\\mathcal{O}(x)$ 进行评估，该矩阵由输出函数 $h(x)$ 的连续李导数的梯度构成。矩阵的行是梯度的转置。\n$$\n\\mathcal{O}(x) = \\begin{pmatrix} (\\nabla h(x))^T \\\\ (\\nabla (L_f h(x)))^T \\\\ (\\nabla (L_f^2 h(x)))^T \\end{pmatrix}\n$$\n我们需要求出该矩阵在点 $x^\\star = (K_2, 0)$ 处的秩。\n\n首先，我们以符号形式计算所需的李导数及其梯度。\n\n**步骤 1：零阶项，$h(x)$**\n\n输出函数给定为 $h(x) = x_1$。\n$h(x)$ 的梯度是一个常数向量：\n$$\n\\nabla h(x) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1} \\\\ \\frac{\\partial h}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n可观测性矩阵的第一行是 $(\\nabla h(x))^T = \\begin{pmatrix} 1  0 \\end{pmatrix}$。这一行是常数，因此在 $x^\\star$ 处也相同。\n\n**步骤 2：一阶项，$L_f h(x)$**\n\n一阶李导数定义为 $L_f h(x) = \\nabla h(x) \\cdot f(x)$。\n$$\nL_f h(x) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix} = f_1(x) = \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1\n$$\n接下来，我们计算 $L_f h(x)$ 的梯度：\n$$\n\\frac{\\partial (L_f h)}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1 \\right) = -\\beta_1\n$$\n$$\n\\frac{\\partial (L_f h)}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} \\left( \\alpha_1\\,\\frac{x_2^2}{K_1^2 + x_2^2} - \\beta_1\\,x_1 \\right) = \\alpha_1 \\frac{(2x_2)(K_1^2 + x_2^2) - x_2^2(2x_2)}{(K_1^2 + x_2^2)^2} = \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2}\n$$\n所以，梯度是 $\\nabla(L_f h(x)) = \\begin{pmatrix} -\\beta_1 \\\\ \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix}$。\n可观测性矩阵的第二行是 $(\\nabla (L_f h(x)))^T = \\begin{pmatrix} -\\beta_1  \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix}$。\n\n**步骤 3：二阶项，$L_f^2 h(x)$**\n\n二阶李导数是 $L_f^2 h(x) = \\nabla(L_f h(x)) \\cdot f(x)$。\n$$\nL_f^2 h(x) = \\begin{pmatrix} -\\beta_1 \\\\ \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix} \\cdot \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix} = -\\beta_1 f_1(x) + \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} f_2(x)\n$$\n为了找到可观测性矩阵的第三行，我们需要计算梯度 $\\nabla(L_f^2 h(x))$。与其计算完整的符号表达式，不如在指定点 $x^\\star = (K_2, 0)$ 处计算梯度更有效率。\n第三行是 $(\\nabla (L_f^2 h(x^\\star)))^T = \\begin{pmatrix} \\frac{\\partial (L_f^2 h)}{\\partial x_1}\\Big|_{x^\\star}  \\frac{\\partial (L_f^2 h)}{\\partial x_2}\\Big|_{x^\\star} \\end{pmatrix}$。\n\n我们记 $C(x_2) = \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2}$。所以 $L_f^2 h(x) = -\\beta_1 f_1(x) + C(x_2) f_2(x)$。\n那么 $\\nabla(L_f^2 h(x)) = -\\beta_1 \\nabla f_1(x) + \\nabla(C(x_2) f_2(x))$。\n使用梯度的乘法法则，$\\nabla(C f_2) = C \\nabla f_2 + f_2 \\nabla C$。\n所以，$\\nabla(L_f^2 h(x)) = -\\beta_1 \\nabla f_1(x) + C(x_2) \\nabla f_2(x) + f_2(x) \\nabla C(x_2)$。\n\n我们在 $x^\\star = (K_2, 0)$ 处计算每一项：\n1. 在 $x_2=0$ 时，$C(0) = 0$。因此项 $C(x_2) \\nabla f_2(x)$ 在 $x^\\star$ 处为零。\n2. $\\nabla f_1(x)$ 就是 $\\nabla(L_f h(x))$。在 $x^\\star$ 处，$\\nabla f_1(x^\\star) = \\begin{pmatrix} -\\beta_1 \\\\ 0 \\end{pmatrix}$。所以，$-\\beta_1 \\nabla f_1(x^\\star) = \\begin{pmatrix} \\beta_1^2 \\\\ 0 \\end{pmatrix}$。\n3. 我们需要 $f_2(x^\\star)$ 和 $\\nabla C(x_2)|_{x^\\star}$。\n$$\nf_2(x^\\star) = \\alpha_2\\,\\frac{K_2^m}{K_2^m + K_2^m} - \\beta_2(0) = \\frac{\\alpha_2}{2}\n$$\n$C(x_2)$ 的梯度是 $\\nabla C(x_2) = \\begin{pmatrix} 0 \\\\ C'(x_2) \\end{pmatrix}$。\n$$\nC'(x_2) = \\frac{d}{d x_2} \\left( \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\right) = 2 \\alpha_1 K_1^2 \\frac{(K_1^2 + x_2^2)^2 - x_2 \\cdot 2(K_1^2+x_2^2)(2x_2)}{(K_1^2 + x_2^2)^4} = 2 \\alpha_1 K_1^2 \\frac{K_1^2 - 3x_2^2}{(K_1^2 + x_2^2)^3}\n$$\n在 $x_2=0$ 处计算：\n$$\nC'(0) = 2 \\alpha_1 K_1^2 \\frac{K_1^2}{(K_1^2)^3} = \\frac{2 \\alpha_1}{K_1^2}\n$$\n所以，$\\nabla C(x_2)|_{x^\\star} = \\begin{pmatrix} 0 \\\\ \\frac{2 \\alpha_1}{K_1^2} \\end{pmatrix}$。\n4. 最后一项变为 $f_2(x^\\star) \\nabla C(x_2)|_{x^\\star} = \\frac{\\alpha_2}{2} \\begin{pmatrix} 0 \\\\ \\frac{2 \\alpha_1}{K_1^2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$。\n\n将各部分组合起来，二阶李导数在 $x^\\star$ 处的梯度为：\n$$\n\\nabla(L_f^2 h(x^\\star)) = \\begin{pmatrix} \\beta_1^2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix} = \\begin{pmatrix} \\beta_1^2 \\\\ \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}\n$$\n可观测性矩阵在 $x^\\star$ 处的第三行是 $\\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$。\n\n**步骤 4：组装并计算 $\\mathcal{O}(x^\\star)$ 的秩**\n\n我们通过在 $x^\\star=(K_2, 0)$ 处计算每一行来组装可观测性矩阵：\n- 第 1 行：$\\begin{pmatrix} 1  0 \\end{pmatrix}$\n- 第 2 行：$\\begin{pmatrix} -\\beta_1  \\frac{2 \\alpha_1 K_1^2 x_2}{(K_1^2 + x_2^2)^2} \\end{pmatrix}\\Big|_{x_2=0} = \\begin{pmatrix} -\\beta_1  0 \\end{pmatrix}$\n- 第 3 行：$\\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$\n\n矩阵是：\n$$\n\\mathcal{O}(x^\\star) = \\begin{pmatrix} 1  0 \\\\ -\\beta_1  0 \\\\ \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}\n$$\n为了求这个 $3 \\times 2$ 矩阵的秩，我们检查其行的线性无关性。\n第二行是第一行的 $-\\beta_1$ 倍，所以它们是线性相关的。矩阵的秩由第一行和第三行的张成空间决定。\n第一行是 $R_1 = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n第三行是 $R_3 = \\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$。\n\n这两行线性无关当且仅当它们构成的矩阵的行列式非零：\n$$\n\\det \\begin{pmatrix} 1  0 \\\\ \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix} = (1) \\left( \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\right) - (0) (\\beta_1^2) = \\frac{\\alpha_1 \\alpha_2}{K_1^2}\n$$\n根据问题陈述，参数 $\\alpha_1$、$\\alpha_2$ 和 $K_1$ 都是严格正数。因此，它们的乘积和比率 $\\frac{\\alpha_1 \\alpha_2}{K_1^2}$ 是严格正数且非零。\n由于行列式非零，向量 $\\begin{pmatrix} 1  0 \\end{pmatrix}$ 和 $\\begin{pmatrix} \\beta_1^2  \\frac{\\alpha_1 \\alpha_2}{K_1^2} \\end{pmatrix}$ 是线性无关的。\n$\\mathcal{O}(x^\\star)$ 的行空间由这两个向量张成，因此其维数为 $2$。\n因此，矩阵 $\\mathcal{O}(x^\\star)$ 的秩为 $2$。这意味着系统在状态 $x^\\star$ 处是局部可观测的，尽管 $x_2$ 未被测量，并且其对测量导数 $\\dot{x}_1$ 的直接影响在 $x_2=0$ 时消失。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "可观测性分析不仅在于“检验”一个属性，更在于“利用”它来简化问题。如果一个系统是可观测的，我们常能通过坐标变换将其转化为“观测者标准型”，这对于设计状态观测器至关重要。本练习将引导您对一个经典的基因表达负反馈模型进行这种变换 ，您将推导出在新坐标系下的系统动力学，并揭示系统状态（如 mRNA 浓度）与可测量的输出（蛋白质浓度）及其变化率之间的深刻联系。",
            "id": "3334919",
            "problem": "考虑一个以信使核糖核酸（mRNA）和蛋白质为状态变量的非线性基因表达模块。设状态向量为 $x = (m, p)^{\\top}$，其中 $m$ 是 mRNA 浓度，$p$ 是蛋白质浓度。其动力学由以下方程给出\n$$\n\\frac{dm}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{p}{K}\\right)^{n}} \\;-\\; \\delta_{m}\\, m,\n\\qquad\n\\frac{dp}{dt} \\;=\\; \\beta\\, m \\;-\\; \\delta_{p}\\, p,\n$$\n其中参数 $\\alpha, K, n, \\delta_{m}, \\delta_{p}, \\beta$ 均为严格正值。测量输出为 $y = h(x) = p$。请完全基于李导数（Lie derivative）的定义和非线性系统的可观测性秩条件，从第一性原理出发进行推导。\n\n任务：\n- 仅使用输出函数 $h(x)$ 沿向量场 $f(x)$ 的李导数 $L_{f} h(x)$ 的定义，为该系统构建可观测性映射 $\\Phi(x) = \\big(h(x),\\, L_{f} h(x)\\big)$ 并计算其雅可比矩阵。通过符号化计算行列式，确定该映射成为局部微分同胚的条件。\n- 定义观测器规范坐标（也称为输出-导数坐标）$z_{1} = h(x)$ 和 $z_{2} = L_{f} h(x)$。从链式法则和高阶李导数的定义出发，推导在这些坐标下的动力学，其形式为\n$$\n\\dot{z}_{1} \\;=\\; z_{2}, \n\\qquad\n\\dot{z}_{2} \\;=\\; \\Psi(z_{1}, z_{2}),\n$$\n其中 $\\Psi$ 仅依赖于 $z_{1}, z_{2}$ 和正参数 $\\alpha, K, n, \\delta_{m}, \\delta_{p}, \\beta$，而不直接依赖于 $m$ 或 $p$。\n- 简要讨论坐标 $z_{1}$ 和 $z_{2}$ 在基因表达中可测量量和通量方面的生物学可解释性。\n\n答案要求：作为最终答案，提供 $\\Psi(z_{1}, z_{2})$ 的显式闭式解析表达式。无需进行数值计算。最终答案必须是单一的解析表达式。不包括单位，也不要四舍五入。",
            "solution": "该问题经验证是合理且适定的。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 状态向量：$x = (m, p)^{\\top}$，其中 $m$ 是 mRNA 浓度，$p$ 是蛋白质浓度。\n- 系统动力学（向量场 $f(x)$）：\n$$ \\dot{x} = f(x) = \\begin{pmatrix} \\frac{dm}{dt} \\\\ \\frac{dp}{dt} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\alpha}{1 + \\left(\\frac{p}{K}\\right)^{n}} - \\delta_{m}\\, m \\\\ \\beta\\, m - \\delta_{p}\\, p \\end{pmatrix} $$\n- 参数：$\\alpha, K, n, \\delta_{m}, \\delta_{p}, \\beta$ 均为严格正常数。\n- 输出函数：$y = h(x) = p$。\n- 任务：\n    1.  构建可观测性映射 $\\Phi(x) = (h(x), L_{f} h(x))$，计算其雅可比矩阵，并确定该映射成为局部微分同胚的条件。\n    2.  定义观测器规范坐标 $z_{1} = h(x)$ 和 $z_{2} = L_{f} h(x)$，并推导系统在这些坐标下的动力学，找到 $\\dot{z}_2 = \\Psi(z_1, z_2)$ 中 $\\Psi(z_1, z_2)$ 的显式表达式。\n    3.  讨论 $z_1$ 和 $z_2$ 的生物学可解释性。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用希尔函数（Hill function）描述了一个经典的负反馈基因调控模块，用于转录抑制。这是系统生物学中一个基础且被广泛研究的模型。其动力学代表了合成的标准质量作用动力学和一级衰变。该问题在科学上是合理的。\n- **适定性：** 该问题提供了所有必要信息（方程、定义、参数），并要求得到具体的、可推导的解析结果。这些任务是非线性可观测性分析中的标准程序。\n- **客观性：** 该问题使用精确的数学和科学语言陈述，没有歧义或主观内容。\n\n**步骤 3：结论与行动**\n- **结论：** 该问题有效。这是一个计算系统生物学中适定且有科学依据的问题。\n- **行动：** 继续进行求解。\n\n**详细解答**\n\n分析过程通过将李导数和坐标变换的定义应用于给定的非线性系统来进行。\n\n**第一部分：可观测性映射与局部微分同胚**\n\n状态向量为 $x = (m, p)^{\\top}$，向量场由下式给出\n$$ f(x) = \\begin{pmatrix} f_m(x) \\\\ f_p(x) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\alpha}{1 + \\left(\\frac{p}{K}\\right)^{n}} - \\delta_{m}\\, m \\\\ \\beta\\, m - \\delta_{p}\\, p \\end{pmatrix} $$\n输出函数为 $h(x) = p$。\n\n可观测性映射定义为 $\\Phi(x) = \\big( h(x), L_{f} h(x) \\big)^{\\top}$。\n第一个分量是 $h(x) = p$。\n第二个分量是 $h(x)$ 沿向量场 $f(x)$ 的李导数，定义为 $L_f h(x) = \\nabla h(x) \\cdot f(x)$。\n首先，我们计算 $h(x)$ 的梯度：\n$$ \\nabla h(x) = \\left( \\frac{\\partial h}{\\partial m}, \\frac{\\partial h}{\\partial p} \\right) = \\left( \\frac{\\partial p}{\\partial m}, \\frac{\\partial p}{\\partial p} \\right) = (0, 1) $$\n现在，我们计算李导数：\n$$ L_{f} h(x) = (0, 1) \\begin{pmatrix} \\frac{\\alpha}{1 + \\left(\\frac{p}{K}\\right)^{n}} - \\delta_{m}\\, m \\\\ \\beta\\, m - \\delta_{p}\\, p \\end{pmatrix} = \\beta m - \\delta_p p $$\n因此，可观测性映射 $\\Phi(x)$ 是：\n$$ \\Phi(x) = \\begin{pmatrix} h(x) \\\\ L_f h(x) \\end{pmatrix} = \\begin{pmatrix} p \\\\ \\beta m - \\delta_p p \\end{pmatrix} $$\n为了确定该映射成为局部微分同胚的条件，我们必须计算其雅可比矩阵 $J_{\\Phi}(x)$，并检查其行列式在何处非零。\n$$ J_{\\Phi}(x) = \\frac{\\partial \\Phi}{\\partial x} = \\begin{pmatrix} \\frac{\\partial}{\\partial m}(p)  \\frac{\\partial}{\\partial p}(p) \\\\ \\frac{\\partial}{\\partial m}(\\beta m - \\delta_p p)  \\frac{\\partial}{\\partial p}(\\beta m - \\delta_p p) \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ \\beta  -\\delta_p \\end{pmatrix} $$\n雅可比矩阵的行列式为：\n$$ \\det(J_{\\Phi}(x)) = (0)(-\\delta_p) - (1)(\\beta) = -\\beta $$\n要使映射 $\\Phi(x)$ 成为局部微分同胚，其雅可比矩阵必须是可逆的，这意味着其行列式必须非零。条件是 $\\det(J_{\\Phi}(x)) \\neq 0$，即 $-\\beta \\neq 0$。\n问题陈述指明所有参数（包括 $\\beta$）均为严格正值。因此，$\\beta > 0$，条件 $-\\beta \\neq 0$ 总是满足的。该映射是一个全局微分同胚，因为其雅可比矩阵是一个常数可逆矩阵，这意味着坐标变换是一个线性同构。\n\n**第二部分：观测器规范坐标下的动力学**\n\n我们定义新的坐标，也称为输出-导数坐标，如下：\n$$ z_1 = h(x) = p $$\n$$ z_2 = L_f h(x) = \\beta m - \\delta_p p $$\n我们的目标是找到用 $z_1$ 和 $z_2$ 表示的动力学 $\\dot{z}_1$ 和 $\\dot{z}_2$。\n\n首先，我们计算 $\\dot{z}_1$：\n$$ \\dot{z}_1 = \\frac{d z_1}{dt} = \\frac{d p}{dt} $$\n根据原始系统动力学，$\\frac{dp}{dt} = \\beta m - \\delta_p p$。根据 $z_2$ 的定义，这恰好是 $z_2$。\n$$ \\dot{z}_1 = z_2 $$\n接下来，我们计算 $\\dot{z}_2$。这对应于二阶李导数 $L_f^2 h(x)$。\n$$ \\dot{z}_2 = \\frac{d z_2}{dt} = \\frac{d}{dt} (\\beta m - \\delta_p p) = \\beta \\frac{dm}{dt} - \\delta_p \\frac{dp}{dt} $$\n将原始系统中 $\\frac{dm}{dt}$ 和 $\\frac{dp}{dt}$ 的表达式代入：\n$$ \\dot{z}_2 = \\beta \\left( \\frac{\\alpha}{1 + \\left(\\frac{p}{K}\\right)^{n}} - \\delta_{m}\\, m \\right) - \\delta_p \\left( \\beta\\, m - \\delta_{p}\\, p \\right) $$\n展开此表达式得到：\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{p}{K}\\right)^{n}} - \\beta\\delta_m m - \\beta\\delta_p m + \\delta_p^2 p $$\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{p}{K}\\right)^{n}} - (\\delta_m + \\delta_p)\\beta m + \\delta_p^2 p $$\n为了得到新坐标下的动力学，我们必须用 $z_1$ 和 $z_2$ 表示原始状态变量 $m$ 和 $p$。坐标变换为：\n$p = z_1$\n$z_2 = \\beta m - \\delta_p p \\implies z_2 = \\beta m - \\delta_p z_1 \\implies \\beta m = z_2 + \\delta_p z_1 \\implies m = \\frac{z_2 + \\delta_p z_1}{\\beta}$\n现在，将 $m$ 和 $p$ 的这些表达式代入 $\\dot{z}_2$ 的方程中：\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{z_1}{K}\\right)^{n}} - (\\delta_m + \\delta_p)\\beta \\left( \\frac{z_2 + \\delta_p z_1}{\\beta} \\right) + \\delta_p^2 z_1 $$\n参数 $\\beta$ 在第二项中消掉了：\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{z_1}{K}\\right)^{n}} - (\\delta_m + \\delta_p)(z_2 + \\delta_p z_1) + \\delta_p^2 z_1 $$\n展开并简化表达式：\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{z_1}{K}\\right)^{n}} - (\\delta_m + \\delta_p)z_2 - (\\delta_m + \\delta_p)\\delta_p z_1 + \\delta_p^2 z_1 $$\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{z_1}{K}\\right)^{n}} - (\\delta_m + \\delta_p)z_2 - \\delta_m\\delta_p z_1 - \\delta_p^2 z_1 + \\delta_p^2 z_1 $$\n$$ \\dot{z}_2 = \\frac{\\alpha\\beta}{1 + \\left(\\frac{z_1}{K}\\right)^{n}} - (\\delta_m + \\delta_p)z_2 - \\delta_m\\delta_p z_1 $$\n这就是所求的函数 $\\Psi(z_1, z_2)$。\n观测器规范形式下的完整动力学为：\n$$ \\dot{z}_1 = z_2 $$\n$$ \\dot{z}_2 = \\Psi(z_1, z_2) = \\frac{\\alpha\\beta}{1 + \\left(\\frac{z_1}{K}\\right)^{n}} - (\\delta_m + \\delta_p)z_2 - \\delta_m\\delta_p z_1 $$\n\n**第三部分：生物学解释**\n\n- **对 $z_1$ 的解释**：坐标 $z_1$ 定义为 $z_1 = p$。这是蛋白质的浓度。由于系统的输出为 $y=p$，因此 $z_1$ 是直接测量的量。它代表了基因表达过程最终产物的当前丰度。\n\n- **对 $z_2$ 的解释**：坐标 $z_2$ 定义为 $z_2 = L_f h(x)$。在变换后动力学的推导中已经表明，$\\dot{z}_1 = z_2$，这意味着 $z_2 = \\frac{dp}{dt}$。在生物学上，$\\frac{dp}{dt}$ 是蛋白质浓度的净变化率。该速率的原始方程是 $\\frac{dp}{dt} = \\beta m - \\delta_p p$，它代表了从 mRNA 合成蛋白质的总速率（翻译）$\\beta m$ 与蛋白质降解的总速率 $\\delta_p p$ 之间的平衡。因此，$z_2$ 是蛋白质池的净通量。正的 $z_2$ 表示蛋白质合成速率高于降解速率，导致蛋白质水平增加，而负的 $z_2$ 则表示相反情况。$z_2=0$ 表示合成和降解速率相等的动态平衡状态。因此，坐标对 $(z_1, z_2)$ 代表了蛋白质在其浓度和净变化率组成的相空间中的状态。系统在这些坐标下是可观测的，这一事实意味着通过测量蛋白质水平 ($z_1$) 及其变化率 ($z_2$)，可以唯一确定未测量的 mRNA 的浓度 $m$。",
            "answer": "$$\n\\boxed{\\frac{\\alpha \\beta}{1 + \\left(\\frac{z_{1}}{K}\\right)^{n}} - (\\delta_{m} + \\delta_{p}) z_{2} - \\delta_{m} \\delta_{p} z_{1}}\n$$"
        },
        {
            "introduction": "局部可观测性秩条件是强大的工具，但它并不能揭示全局动力学的全貌。本练习是一个关键的思想实验，旨在阐明局部性质与全局性质之间的差异。通过分析一个对称的基因触发开关模型 ，您将发现，即使系统在几乎所有点都满足局部可观测性条件（即结构可观测），其内在的对称性仍可能导致多个不同的系统状态（如两个稳定点）产生完全相同的输出轨迹，从而破坏全局可观测性。理解这一概念对于正确解读具有多稳态和对称性的生物系统至关重要。",
            "id": "3334899",
            "problem": "考虑一个无外部输入的对称相互抑制基因触发开关模型，这是计算系统生物学中的一个标准模体。其状态向量为 $x = (x_1, x_2)$，表示两种相互抑制的转录因子的浓度。其动力学由以下方程给出：\n$$\n\\begin{aligned}\n\\dot{x}_1 = \\frac{\\alpha}{1 + \\left(\\frac{x_2}{K}\\right)^{n}} - \\delta\\, x_1,\\\\\n\\dot{x}_2 = \\frac{\\alpha}{1 + \\left(\\frac{x_1}{K}\\right)^{n}} - \\delta\\, x_2,\n\\end{aligned}\n$$\n其中 $\\alpha > 0$ 是最大合成速率，$\\delta > 0$ 是一阶降解/稀释速率，$K > 0$ 是解离常数，$n \\ge 2$ 是描述协同性的希尔系数。假设参数选择在一个已知会产生双稳态（两个线性稳定的非对角平衡点和一个不稳定的对角平衡点）的区域，对于足够大的 $n$ 和 $\\alpha/\\delta$，这是此类触发开关的一个有充分文献记载的特性。\n\n假设唯一的测量输出是总浓度\n$$\ny = h(x) = x_1 + x_2.\n$$\n\n仅使用非线性系统理论的基本定义（基于李导数的局部可观测性秩条件，以及作为关于参数的泛型性质的结构可观测性概念），完成以下任务：\n\n1. 通过堆叠 $h(x)$ 及其沿向量场 $f(x)$ 的一阶李导数的梯度，在泛型状态 $x$ 处构建 $2 \\times 2$ 局部可观测性矩阵，其中 $f(x)$ 表示状态方程的右侧。显式地计算该矩阵的行列式，作为 $x_1$、$x_2$、$\\alpha$、$\\delta$、$K$ 和 $n$ 的函数。\n\n2. 使用你的表达式，从第一性原理出发，论证为什么该系统是结构可观测的，即为什么对于一个开放稠密的参数值集合，局部可观测性秩条件在状态空间的一个满测度子集上成立。\n\n3. 利用交换对称性 $x_1 \\leftrightarrow x_2$ 和假定的双稳态，证明输入-输出映射 $x_0 \\mapsto y(t \\mid x_0)$ 不是全局单射的，因为存在不同的初始条件，它们在所有 $t \\ge 0$ 时生成完全相同的输出轨迹，特别是，存在具有相同稳态输出的不同稳定稳态。定义 $m$ 为在给定输出 $h(x) = x_1 + x_2$ 的情况下，产生相同输出轨迹 $y(t)$（对于所有 $t \\ge 0$）的不可区分初始条件 $x_0$ 和 $x_0'$ 集合的泛型基数。\n\n报告 $m$ 的值，为一个没有单位的数字。不需要四舍五入。",
            "solution": "该问题要求分析对称基因触发开关模型的可观测性。分析的关键在于源自李导数的局部可观测性秩条件以及系统固有的交换对称性。\n\n设系统的状态为 $x = (x_1, x_2)^T \\in \\mathbb{R}^2$，其中 $x_1 \\ge 0$ 且 $x_2 \\ge 0$。动力学由向量场 $f(x) = (f_1(x), f_2(x))^T$ 控制，其中\n$$\n\\begin{aligned}\nf_1(x) = \\frac{\\alpha}{1 + \\left(\\frac{x_2}{K}\\right)^{n}} - \\delta\\, x_1 \\\\\nf_2(x) = \\frac{\\alpha}{1 + \\left(\\frac{x_1}{K}\\right)^{n}} - \\delta\\, x_2\n\\end{aligned}\n$$\n输出由函数 $y = h(x) = x_1 + x_2$ 给出。\n\n非线性系统 $\\dot{x} = f(x)$，$y = h(x)$ 在点 $x$ 的局部可观测性通过可观测性矩阵 $\\mathcal{O}(x)$ 来评估，该矩阵由输出函数 $h(x)$ 的逐次李导数的梯度构成。对于一个二维系统，我们通常需要检查由 $h(x)$ 的梯度及其一阶李导数 $L_f h(x)$ 的梯度所形成的矩阵的秩。\n\n**1. 可观测性矩阵及其行列式的构造**\n\n$2 \\times 2$ 的局部可观测性矩阵由下式给出：\n$$\n\\mathcal{O}(x) = \\begin{pmatrix} \\nabla h(x) \\\\ \\nabla(L_f h(x)) \\end{pmatrix}\n$$\n首先，我们计算输出函数 $h(x) = x_1 + x_2$ 的梯度：\n$$\n\\nabla h(x) = \\left[ \\frac{\\partial h}{\\partial x_1} \\quad \\frac{\\partial h}{\\partial x_2} \\right] = \\begin{pmatrix} 1  1 \\end{pmatrix}\n$$\n接下来，我们计算 $h(x)$ 沿向量场 $f(x)$ 的一阶李导数：\n$$\nL_f h(x) = \\nabla h(x) \\cdot f(x) = 1 \\cdot f_1(x) + 1 \\cdot f_2(x)\n$$\n$$\nL_f h(x) = \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_2}{K}\\right)^{n}} - \\delta\\, x_1 \\right) + \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_1}{K}\\right)^{n}} - \\delta\\, x_2 \\right) = \\frac{\\alpha}{1 + (x_2/K)^n} + \\frac{\\alpha}{1 + (x_1/K)^n} - \\delta(x_1 + x_2)\n$$\n现在，我们计算 $L_f h(x)$ 的梯度。我们求其关于 $x_1$ 和 $x_2$ 的偏导数：\n$$\n\\frac{\\partial}{\\partial x_1} (L_f h(x)) = \\frac{\\partial}{\\partial x_1} \\left( \\frac{\\alpha}{1 + (x_1/K)^n} - \\delta x_1 \\right) = \\alpha \\frac{-\\frac{n}{K} \\left(\\frac{x_1}{K}\\right)^{n-1}}{\\left(1 + (x_1/K)^n\\right)^2} - \\delta = -\\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} - \\delta\n$$\n$$\n\\frac{\\partial}{\\partial x_2} (L_f h(x)) = \\frac{\\partial}{\\partial x_2} \\left( \\frac{\\alpha}{1 + (x_2/K)^n} - \\delta x_2 \\right) = \\alpha \\frac{-\\frac{n}{K} \\left(\\frac{x_2}{K}\\right)^{n-1}}{\\left(1 + (x_2/K)^n\\right)^2} - \\delta = -\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta\n$$\n现在我们可以组装可观测性矩阵 $\\mathcal{O}(x)$：\n$$\n\\mathcal{O}(x) = \\begin{pmatrix} 1  1 \\\\ -\\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} - \\delta  -\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta \\end{pmatrix}\n$$\n该矩阵的行列式为：\n$$\n\\det(\\mathcal{O}(x)) = 1 \\cdot \\left(-\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta\\right) - 1 \\cdot \\left(-\\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} - \\delta\\right)\n$$\n$$\n\\det(\\mathcal{O}(x)) = -\\frac{\\alpha n K^n x_2^{n-1}}{(K^n + x_2^n)^2} - \\delta + \\frac{\\alpha n K^n x_1^{n-1}}{(K^n + x_1^n)^2} + \\delta\n$$\n$$\n\\det(\\mathcal{O}(x)) = \\alpha n K^n \\left( \\frac{x_1^{n-1}}{(K^n + x_1^n)^2} - \\frac{x_2^{n-1}}{(K^n + x_2^n)^2} \\right)\n$$\n\n**2. 关于结构可观测性的论证**\n\n如果可观测性矩阵 $\\mathcal{O}(x)$ 满秩，则系统在状态 $x$ 是局部可观测的。对于这个二维系统，这意味着 $\\text{rank}(\\mathcal{O}(x)) = 2$，等价于 $\\det(\\mathcal{O}(x)) \\neq 0$。如果对于一个开放稠密的参数集，秩条件失效的状态 $x$ 集合（即 $\\det(\\mathcal{O}(x)) = 0$）在状态空间中是一个零测度集，则系统是结构可观测的。\n\n行列式为零当且仅当：\n$$\n\\frac{x_1^{n-1}}{(K^n + x_1^n)^2} = \\frac{x_2^{n-1}}{(K^n + x_2^n)^2}\n$$\n这个方程对于直线 $x_1 = x_2$ 上的所有点都明显成立。这条直线是二维状态空间中的一维子流形，因此其勒贝格测度为零。函数 $g(z) = \\frac{z^{n-1}}{(K^n + z^n)^2}$ 对于 $z \\ge 0$ 并不是单调的，因此可能存在其他解曲线，使得当 $x_1 \\neq x_2$ 时有 $g(x_1)=g(x_2)$。然而，所有这些点 $(x_1, x_2)$ 的集合在 $\\mathbb{R}^2$ 中形成一个低维代数簇。由于参数 $\\alpha, n, K, \\delta$ 均非零，行列式是 $x_1$ 和 $x_2$ 的一个非平凡解析函数。因此，其零点集是一个零测度集。这满足了结构可观测性的条件。该系统对于几乎所有状态 $x$ 都是局部可观测的。\n\n**3. 全局非单射性与不可区分状态的基数**\n\n系统不是全局可观测的，这意味着从初始条件 $x_0$到整个输出轨迹 $y(t \\mid x_0)$ 的映射不是单射的。这是系统对称性的直接结果。\n\n令 $S$ 为交换算子：$S(x_1, x_2) = (x_2, x_1)$。\n向量场 $f(x)$ 对于 $S$ 是等变的。要证明这一点，令 $x' = S(x) = (x_2, x_1)$。\n$$\nf(x') = f(x_2, x_1) = \\begin{pmatrix} \\frac{\\alpha}{1 + (x_1/K)^n} - \\delta x_2 \\\\ \\frac{\\alpha}{1 + (x_2/K)^n} - \\delta x_1 \\end{pmatrix} = \\begin{pmatrix} f_2(x_1, x_2) \\\\ f_1(x_1, x_2) \\end{pmatrix} = S(f(x))\n$$\n输出函数 $h(x) = x_1 + x_2$ 在 $S$ 作用下是不变的：\n$$\nh(S(x)) = h(x_2, x_1) = x_2 + x_1 = x_1 + x_2 = h(x)\n$$\n现在，考虑从初始条件 $x_0$ 开始的一条解轨迹 $x(t)$，使得 $\\dot{x}(t) = f(x(t))$ 且 $x(0)=x_0$。我们定义一条新轨迹 $z(t) = S(x(t))$。$z(t)$ 的初始条件是 $z(0) = S(x(0)) = S(x_0)$。$z(t)$ 的动力学由以下给出：\n$$\n\\dot{z}(t) = \\frac{d}{dt} S(x(t)) = S(\\dot{x}(t)) = S(f(x(t)))\n$$\n利用 $f$ 的等变性，我们有 $S(f(x(t))) = f(S(x(t))) = f(z(t))$。因此，$\\dot{z}(t) = f(z(t))$。这表明，如果 $x(t)$ 是从 $x_0$ 开始的一条有效轨迹，那么 $z(t) = S(x(t))$ 就是从不同的初始点 $S(x_0)$ 开始的一条有效轨迹（前提是 $x_0$ 不在对称线 $x_1=x_2$ 上）。\n\n让我们比较从初始条件 $x_0$ 和 $S(x_0)$ 生成的输出。\n从 $x_0$ 开始的输出是 $y(t) = h(x(t))$。\n从 $S(x_0)$ 开始的输出是 $y'(t) = h(z(t)) = h(S(x(t)))$。\n由于 $h$ 的不变性，我们有 $h(S(x(t))) = h(x(t))$。\n因此，对于所有 $t \\ge 0$，$y'(t) = y(t)$。\n\n这证明了任何两个不同的初始条件 $x_0$ 和 $S(x_0)$（即 $x_0$ 不在直线 $x_1=x_2$ 上）从输出 $y(t)$ 来看是不可区分的。\n\n问题的双稳态假设提供了一个具体的例子。两个稳定稳态，记为 $x_A^* = (x_{hi}, x_{lo})$ 和 $x_B^* = (x_{lo}, x_{hi})$，通过这种对称性相关联：$x_B^* = S(x_A^*)$。两者的稳态输出都是 $y^* = x_{hi} + x_{lo}$，这使得它们不可区分。在 $x_A^*$ 的初始条件产生一个恒定的输出 $y^*$，在 $x_B^*$ 的初始条件也产生同样的恒定输出 $y^*$。\n\n问题要求的是 $m$，即不可区分初始条件集合的泛型基数。“泛型”初始条件 $x_0$ 是指不位于任何特殊的、低维流形上的点。在这种情况下，这意味着 $x_0$ 不在不可观测点集上，特别是不在对称线 $x_1=x_2$ 上。对于这样一个满足 $x_{1,0} \\neq x_{2,0}$ 的泛型 $x_0 = (x_{1,0}, x_{2,0})$，产生相同输出轨迹的初始条件集合是 $\\{x_0, S(x_0)\\} = \\{(x_{1,0}, x_{2,0}), (x_{2,0}, x_{1,0})\\}$。\n这个集合的基数是 $2$。\n因此，$m=2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}