{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，旨在掌握通量平衡分析（FBA）的核心原理。通过分析一个简单的线性代谢途径 ，我们将学习如何运用稳态质量平衡和通量容量约束来计算目标产物的最大理论生产速率。这个练习为后续更复杂的分析方法奠定了坚实的数学和概念基础。",
            "id": "3325736",
            "problem": "考虑一个计算系统生物学中用于代谢工程的最小路径优化场景，该场景使用通量平衡分析（FBA; Flux Balance Analysis）进行建模。一条路径涉及两种细胞内代谢物和三个串联排列的不可逆反应。该网络由一个化学计量矩阵 $S$ 表示，该矩阵编码了稳态下的质量守恒。通量向量为 $v \\in \\mathbb{R}^{3}$，其分量 $v_1$、$v_2$ 和 $v_3$ 对应于三个反应。系统在稳态下运行，因此代谢物积累为零，细胞内通量满足 $S v = 0$。\n\n给定化学计量矩阵\n$$\nS=\\begin{bmatrix}\n-1  1  0 \\\\\n0  -1  1\n\\end{bmatrix},\n$$\n每个 $i \\in \\{1,2,3\\}$ 的通量界限为 $0 \\leq v_i \\leq 10$，以及线性目标向量 $c=(0,0,1)$，该向量编码了最大化反应3通量的工程目标（例如，期望产物的合成或输出）。假设所有反应都是不可逆的（热力学上限制为非负通量），并且除了所述的界限和稳态质量平衡之外，没有其他额外的约束。\n\n建立并求解在 $S v = 0$ 和给定界限约束下最大化 $c^{\\top} v$ 的FBA优化问题。确定最优目标值 $\\max c^{\\top} v$。最终答案以 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ 为单位表示。无需四舍五入；报告精确值。",
            "solution": "所提出的问题是通量平衡分析（FBA）的一个标准应用，这是一种用于预测代谢通量分布的数学方法。该问题是一个线性规划问题，可以正式表述如下：\n\n最大化：\n$$z = c^{\\top} v$$\n约束条件：\n$$S v = 0$$\n$$v_{lb} \\leq v \\leq v_{ub}$$\n\n在这里，我们给出了这个问题的具体组成部分。通量向量为 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix}$。给定的化学计量矩阵为：\n$$\nS=\\begin{bmatrix}\n-1  1  0 \\\\\n0  -1  1\n\\end{bmatrix}\n$$\n目标向量是 $c = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$，这意味着要最大化的目标函数是 $z = c^{\\top} v = (0)v_1 + (0)v_2 + (1)v_3 = v_3$。\n\n每个通量 $v_i$（其中 $i \\in \\{1, 2, 3\\}$）的通量界限为 $0 \\leq v_i \\leq 10$。这可以写成下界 $v_{lb} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 和上界 $v_{ub} = \\begin{pmatrix} 10 \\\\ 10 \\\\ 10 \\end{pmatrix}$。\n\n首先，我们分析稳态质量平衡约束 $S v = 0$。这个矩阵方程展开为一个线性方程组：\n$$\n\\begin{bmatrix}\n-1  1  0 \\\\\n0  -1  1\n\\end{bmatrix}\n\\begin{pmatrix}\nv_1 \\\\\nv_2 \\\\\nv_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n这个系统对应于两个方程：\n方程1：$(-1)v_1 + (1)v_2 + (0)v_3 = 0 \\implies -v_1 + v_2 = 0 \\implies v_1 = v_2$。\n方程2：$(0)v_1 + (-1)v_2 + (1)v_3 = 0 \\implies -v_2 + v_3 = 0 \\implies v_2 = v_3$。\n\n结合这两个结果，我们发现稳态条件要求通量之间存在以下关系：\n$$v_1 = v_2 = v_3$$\n对于一个在稳态下运行的简单线性路径，这是一个预期的结果，其中通量必须在路径的每一步都保持守恒。我们定义一个公共通量变量 $v_c$，使得 $v_c = v_1 = v_2 = v_3$。\n\n现在我们可以用这个单一变量 $v_c$ 来重新表述优化问题。目标是最大化 $v_3$，这等同于最大化 $v_c$。\n对各个通量的约束都必须满足。我们将 $v_c$ 代入通量界限：\n1. 对于 $v_1$：$0 \\leq v_1 \\leq 10 \\implies 0 \\leq v_c \\leq 10$。\n2. 对于 $v_2$：$0 \\leq v_2 \\leq 10 \\implies 0 \\leq v_c \\leq 10$。\n3. 对于 $v_3$：$0 \\leq v_3 \\leq 10 \\implies 0 \\leq v_c \\leq 10$。\n\n所有三个约束都是相同的。因此，问题简化为找到满足条件 $0 \\leq v_c \\leq 10$ 的 $v_c$ 的最大值。\n优化问题简化为：\n最大化：$v_c$\n约束条件：$0 \\leq v_c \\leq 10$。\n\n满足这个不等式的 $v_c$ 的最大值显然是 $10$。\n最优目标值是 $z = v_3$ 的最大值。由于 $v_3 = v_c$，最大值为：\n$$\\max(z) = \\max(v_3) = \\max(v_c) = 10$$\n最优通量分布为 $v_{opt} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ 10 \\\\ 10 \\end{pmatrix}$。我们可以验证该解满足所有约束：\n$S v_{opt} = \\begin{bmatrix} -1  1  0 \\\\ 0  -1  1 \\end{bmatrix} \\begin{pmatrix} 10 \\\\ 10 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} -10+10 \\\\ -10+10 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。稳态条件得到满足。\n界限 $0 \\leq 10 \\leq 10$ 也得到满足。\n目标值为 $c^{\\top} v_{opt} = v_3 = 10$。\n\n问题表述要求答案以 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ 为单位。由于问题是用无量纲数定义的，我们假设通量值和界限是以这些单位给出的。因此，最优目标值在指定单位下是 $10$。",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "在FBA中，获得一个最优的目标值并不能完全描述网络的状态，因为多种不同的通量分布可能产生相同的结果。通量变异性分析（FVA）是探索这种解空间的关键计算方法。通过这个动手实践 ，你将学会如何确定在最优生长条件下每个反应通量的可行范围，从而揭示代谢网络的内在灵活性。",
            "id": "3325767",
            "problem": "考虑一个稳态代谢网络，它由一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$、一个通量向量 $v \\in \\mathbb{R}^n$ 以及反应通量的下限 $l \\in \\mathbb{R}^n$ 和上限 $u \\in \\mathbb{R}^n$ 表示。稳态假设施加了质量平衡约束 $S v = 0$。反应边界施加了约束 $l_i \\le v_i \\le u_i$（对于所有 $i \\in \\{1,\\dots,n\\}$）。通量平衡分析 (FBA) 旨在在这些约束下最大化一个线性目标函数 $c^\\top v$。最优值处的通量变异性分析 (FVA) 旨在当目标固定在其最优值时，通过求解两个线性规划问题来寻找每个反应通量的范围：一个最小化 $v_j$，另一个最大化 $v_j$，约束条件为 $S v = 0$、$l \\le v \\le u$ 和 $c^\\top v = c^\\top v^\\star$，其中 $v^\\star$ 是原始 FBA 问题的解。\n\n所有通量必须以毫摩尔每克干重每小时 (mmol gDW$^{-1}$ h$^{-1}$) 表示。您的程序必须为每个测试用例中的一个指定反应计算最优值处的 FVA 范围，并打印结果，四舍五入到三位小数，不打印单位符号。\n\n使用以下测试套件，该套件采用物理上合理、低维度的网络来测试不同方面，包括唯一最优解、引起变异性的替代平行通路以及受上限限制的最优解：\n\n- 测试用例 1 (唯一最优解)：$S = \\begin{bmatrix} -1  1  0 \\\\ -1  0  1 \\end{bmatrix}$，边界 $0 \\le v_i \\le 10$（对于所有 $i \\in \\{1,2,3\\}$），目标 $\\max v_3$（即 $c = (0,0,1)$），并计算 $v_2$ 在最优值处的 FVA 范围。\n- 测试用例 2 (平行通路引起变异性)：$S = \\begin{bmatrix} 1  -1  0  -1 \\\\ 0  1  -1  1 \\end{bmatrix}$，边界 $0 \\le v_i \\le 10$（对于所有 $i \\in \\{1,2,3,4\\}$），目标 $\\max v_3$（即 $c = (0,0,1,0)$），并计算 $v_2$ 在最优值处的 FVA 范围。\n- 测试用例 3 (受上限限制的最优解)：$S = \\begin{bmatrix} -1  1  0 \\\\ -1  0  1 \\end{bmatrix}$，边界 $0 \\le v_1 \\le 10$，$0 \\le v_2 \\le 10$，$0 \\le v_3 \\le 5$，目标 $\\max v_3$（即 $c = (0,0,1)$），并计算 $v_2$ 在最优值处的 FVA 范围。\n\n在所有情况下，将反应在规定边界内视为不可逆。明确地说，一般的 FBA 问题是：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  c^\\top v \\\\\n\\text{约束条件} \\quad  S v = 0, \\\\\n l \\le v \\le u.\n\\end{aligned}\n$$\n给定最优值 $c^\\top v^\\star$，索引为 $j$ 的 FVA 范围通过求解以下问题计算得出：\n$$\n\\begin{aligned}\n\\text{最小化} \\quad  v_j \\\\\n\\text{约束条件} \\quad  S v = 0, \\\\\n l \\le v \\le u, \\\\\n c^\\top v = c^\\top v^\\star,\n\\end{aligned}\n$$\n和\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  v_j \\\\\n\\text{约束条件} \\quad  S v = 0, \\\\\n l \\le v \\le u, \\\\\n c^\\top v = c^\\top v^\\star.\n\\end{aligned}\n$$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是对应测试用例的一个双元素列表 $[v_j^{\\min}, v_j^{\\max}]$。例如，输出格式必须与 $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$ 完全一样，其中每个 $a_k$ 和 $b_k$ 都是四舍五入到三位小数的浮点数，单位为 mmol gDW$^{-1}$ h$^{-1}$。",
            "solution": "在尝试给出解决方案之前，对问题陈述进行了严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- 一个稳态代谢网络由一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 和一个通量向量 $v \\in \\mathbb{R}^n$ 描述。\n- 质量平衡约束由 $S v = 0$ 给出。\n- 通量边界由 $l \\le v \\le u$ 给出，其中 $l, u \\in \\mathbb{R}^n$。\n- 通量平衡分析 (FBA) 定义为优化问题：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  c^\\top v \\\\\n\\text{约束条件} \\quad  S v = 0, \\\\\n l \\le v \\le u.\n\\end{aligned}\n$$\n- 通量 $v_j$ 在最优值处的通量变异性分析 (FVA) 定义为：在 FBA 约束的基础上，加上目标函数等于其最优值 $c^\\top v = c^\\top v^\\star$ 的额外约束，求 $v_j$ 的最小值和最大值。\n- 所有通量的单位为 mmol gDW$^{-1}$ h$^{-1}$。\n- 测试用例 1：$S = \\begin{bmatrix} -1  1  0 \\\\ -1  0  1 \\end{bmatrix}$，边界 $0 \\le v_i \\le 10$（对于 $i \\in \\{1,2,3\\}$），目标 $c = (0,0,1)^\\top$（最大化 $v_3$），$v_2$ 的 FVA。\n- 测试用例 2：$S = \\begin{bmatrix} 1  -1  0  -1 \\\\ 0  1  -1  1 \\end{bmatrix}$，边界 $0 \\le v_i \\le 10$（对于 $i \\in \\{1,2,3,4\\}$），目标 $c = (0,0,1,0)^\\top$（最大化 $v_3$），$v_2$ 的 FVA。\n- 测试用例 3：$S = \\begin{bmatrix} -1  1  0 \\\\ -1  0  1 \\end{bmatrix}$，边界 $0 \\le v_1 \\le 10$，$0 \\le v_2 \\le 10$，$0 \\le v_3 \\le 5$，目标 $c = (0,0,1)^\\top$（最大化 $v_3$），$v_2$ 的 FVA。\n- 输出格式被指定为包含逗号分隔的双元素列表的单行列表，例如 $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$，数字四舍五入到三位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于通量平衡分析和通量变异性分析，这些是计算系统生物学和代谢工程中标准、成熟的技术。其基本原理是稳态下生化反应网络中的质量守恒，这是物理化学和生物学中的一个基本概念。该问题具有科学合理性。\n- **适定性**：该问题需要求解一系列线性规划 (LP) 问题。对于给定的约束集，一个 LP 问题是适定的：它要么有最优解，要么是无界的，要么是不可行的。所提供的约束（有界通量变量）确保解空间是一个凸多胞体，从而保证目标函数将有有限的最优值。该问题是适定的。\n- **客观性**：该问题使用精确的数学形式和客观的语言进行陈述。所有术语（$S$、$v$、$l$、$u$、$c$）都有明确定义，优化问题也得到了明确的规定。\n- **完整性**：为每个测试用例提供了所有必要的数据（化学计量矩阵、边界、目标）。\n- **一致性**：每个测试用例的已知条件内部一致，不包含矛盾。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是一个定义明确的代谢工程计算问题，具有科学依据，数学上一致且完整。将提供一个解决方案。\n\n### 基于原理的解决方案\n\n任务是计算在最优目标值下特定反应通量的通量变异性分析 (FVA) 范围。对于每个测试用例，这是一个两阶段的过程，涉及求解线性规划 (LP) 问题。\n\n**阶段 1：通量平衡分析 (FBA)**\n首先，我们确定生物学目标函数的最大值。这通过求解 FBA 问题来实现，它是一个 LP 问题：\n$$\n\\begin{aligned}\nz^\\star = \\max_{v} \\quad  c^\\top v \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n l \\le v \\le u\n\\end{aligned}\n$$\n此优化的结果是最优目标值 $z^\\star$。\n\n**阶段 2：通量变异性分析 (FVA)**\n接下来，我们确定特定通量 $v_j$ 的可行范围 $[v_j^{\\min}, v_j^{\\max}]$，同时确保目标函数保持其最优值 $z^\\star$。这需要求解两个额外的 LP 问题。\n\n为了找到最小可能通量 $v_j^{\\min}$：\n$$\n\\begin{aligned}\nv_j^{\\min} = \\min_{v} \\quad  v_j \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n l \\le v \\le u \\\\\n c^\\top v = z^\\star\n\\end{aligned}\n$$\n为了找到最大可能通量 $v_j^{\\max}$：\n$$\n\\begin{aligned}\nv_j^{\\max} = \\max_{v} \\quad  v_j \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n l \\le v \\le u \\\\\n c^\\top v = z^\\star\n\\end{aligned}\n$$\n这些 LP 问题将使用 `scipy.optimize.linprog` 函数进行计算求解，该函数寻找目标函数的最小值。最大化问题通过最小化目标函数的负值来解决。\n\n**测试用例分析**\n\n**测试用例 1：唯一最优解**\n- $S = \\begin{bmatrix} -1  1  0 \\\\ -1  0  1 \\end{bmatrix}$，$l=(0,0,0)^\\top$，$u=(10,10,10)^\\top$，$c=(0,0,1)^\\top$，$v_2$ 的 FVA。\n- 稳态约束 $Sv=0$ 转换为：\n  $$-v_1 + v_2 = 0 \\implies v_1 = v_2$$\n  $$-v_1 + v_3 = 0 \\implies v_1 = v_3$$\n- 因此，我们必须有 $v_1 = v_2 = v_3$。\n- FBA 的目标是最大化 $v_3$。给定边界 $0 \\le v_i \\le 10$，$v_3$ 的最大值为 10。所以，$z^\\star = 10$。\n- 最优状态是唯一的：$v_1^\\star = v_2^\\star = v_3^\\star = 10$。\n- 对于 FVA，我们添加约束 $c^\\top v = v_3 = 10$。这与 $v_1 = v_2 = v_3$ 结合，迫使 $v_2$ 恰好为 10。\n- $v_2$ 的 FVA 范围是 $[10.0, 10.0]$。\n\n**测试用例 2：平行通路**\n- $S = \\begin{bmatrix} 1  -1  0  -1 \\\\ 0  1  -1  1 \\end{bmatrix}$，$l=(0,0,0,0)^\\top$，$u=(10,10,10,10)^\\top$，$c=(0,0,1,0)^\\top$，$v_2$ 的 FVA。\n- 约束 $Sv=0$ 转换为：\n  $$v_1 - v_2 - v_4 = 0 \\implies v_1 = v_2 + v_4$$\n  $$v_2 - v_3 + v_4 = 0 \\implies v_3 = v_2 + v_4$$\n- 这意味着 $v_1 = v_3$。\n- FBA 的目标是最大化 $v_3$。由于 $v_3 = v_1$ 且 $v_1$ 的边界为 $0 \\le v_1 \\le 10$，所以 $v_3$ 的最大值为 10。因此，$z^\\star = 10$。\n- 对于 FVA，我们添加约束 $c^\\top v = v_3 = 10$。这意味着 $v_1 = 10$。系统方程变为 $10 = v_2 + v_4$。\n- 我们需要找到 $v_2$ 在约束 $v_2 + v_4 = 10$ 和边界 $0 \\le v_2 \\le 10$ 及 $0 \\le v_4 \\le 10$ 下的范围。\n  - 为了最小化 $v_2$，我们最大化 $v_4$。$v_4$ 的最大值为 10，这使得 $v_2 = 10 - 10 = 0$。所以，$v_2^{\\min} = 0$。\n  - 为了最大化 $v_2$，我们最小化 $v_4$。$v_4$ 的最小值为 0，这使得 $v_2 = 10 - 0 = 10$。所以，$v_2^{\\max} = 10$。\n- $v_2$ 的 FVA 范围是 $[0.0, 10.0]$。\n\n**测试用例 3：受上限限制的最优解**\n- $S = \\begin{bmatrix} -1  1  0 \\\\ -1  0  1 \\end{bmatrix}$，$l=(0,0,0)^\\top$，$u=(10,10,5)^\\top$，$c=(0,0,1)^\\top$，$v_2$ 的 FVA。\n- 方程组与案例 1 相同：$v_1 = v_2 = v_3$。\n- FBA 的目标是最大化 $v_3$。边界为 $0 \\le v_1 \\le 10$，$0 \\le v_2 \\le 10$ 和 $0 \\le v_3 \\le 5$。\n- $v_3$ 的最大值直接受其上限 $u_3=5$ 的限制。所以，$z^\\star = 5$。\n- 最优状态是唯一的：$v_1^\\star = v_2^\\star = v_3^\\star = 5$。\n- 对于 FVA，我们添加约束 $c^\\top v = v_3 = 5$。这与 $v_1 = v_2 = v_3$ 结合，迫使 $v_2$ 恰好为 5。\n- $v_2$ 的 FVA 范围是 $[5.0, 5.0]$。\n\n**计算实现**\n实现了一个 Python 函数来自动化这个两阶段过程。该函数（`run_fva`）接受模型参数（$S, c, l, u$）和要分析的通量的索引。\n1. 它首先使用 `scipy.optimize.linprog` 设置并求解 FBA 问题。`linprog` 的目标向量是 $-c$ 以执行最大化。等式约束为 $A_{eq}=S$ 和 $b_{eq}=0$。\n2. 从结果中提取最优目标值 $z^\\star$。\n3. 对于 FVA 步骤，增强等式约束矩阵以包含新约束 $c^\\top v = z^\\star$。新矩阵为 $A'_{eq} = \\begin{bmatrix} S \\\\ c^\\top \\end{bmatrix}$，向量为 $b'_{eq} = \\begin{bmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ z^\\star \\end{bmatrix}$。\n4. 然后使用这些新约束求解两个 LP 问题。\n   - 为了找到 $v_j^{\\min}$，目标向量在索引 $j$ 处为 1，其他位置为 0。\n   - 为了找到 $v_j^{\\max}$，目标向量在索引 $j$ 处为 -1，其他位置为 0。然后对结果取反。\n收集所有测试用例的结果，进行四舍五入，并格式化为所需的输出字符串。",
            "answer": "[[10.000,10.000],[0.000,10.000],[5.000,5.000]]"
        },
        {
            "introduction": "接下来，我们将视角从“最优化”（细胞能达到的最佳状态是什么？）转向“预测”（细胞在受到扰动后会怎么做？）。“代谢调节最小化”（MOMA）假设为我们提供了一个有力的预测框架，它认为基因改造后的细胞会调整其通量，使其尽可能接近原始的野生型状态。本练习  将指导你如何应用这一原理来预测基因敲除菌株的代谢状态，这是代谢工程中的一项核心任务。",
            "id": "3325763",
            "problem": "考虑一个小型代谢网络，在通量平衡分析（FBA）的稳态假设下，其化学计量矩阵由单行矩阵给出\n$$\nS=\\begin{bmatrix}1  -1  -1\\end{bmatrix},\n$$\n通量向量为\n$$\nv=\\begin{bmatrix}v_1\\\\ v_2\\\\ v_3\\end{bmatrix}.\n$$\n稳态约束为\n$$\nS v = 0,\n$$\n所有通量的界限为\n$$\n0 \\le v_i \\le 10 \\quad \\text{for } i \\in \\{1,2,3\\}.\n$$\n基因敲除使反应 $2$ 失活，即\n$$\nv_2 = 0.\n$$\n使用代谢调整最小化（MOMA），通过求解以下凸优化问题来计算敲除后的通量向量\n$$\n\\min_{v \\in \\mathbb{R}^3} \\ \\|v - v^{wt}\\|_2^2 \\quad \\text{subject to} \\quad S v = 0, \\ v_2 = 0, \\ 0 \\le v_i \\le 10 \\ \\text{for } i \\in \\{1,2,3\\},\n$$\n其中 $v^{wt}$ 是野生型通量向量。将通量视为无单位的实数，并报告四舍五入到六位小数的数值。\n\n使用以下野生型通量向量测试套件：\n- 测试 $1$：$v^{wt} = (5,5,0)$。\n- 测试 $2$：$v^{wt} = (0,0,0)$。\n- 测试 $3$：$v^{wt} = (10,10,0)$。\n- 测试 $4$：$v^{wt} = (0,0,10)$。\n\n您的程序应为每个测试用例计算 MOMA 预测的敲除后通量向量 $v^\\star$。最终的程序输出必须是包含所有结果列表的单行，其中每个结果本身是对应于 $(v_1^\\star, v_2^\\star, v_3^\\star)$ 的三个浮点数的列表，四舍五入到六位小数。要求的格式是\n$$\n\\text{[ [v1\\_1,v2\\_1,v3\\_1], [v1\\_2,v2\\_2,v3\\_2], [v1\\_3,v2\\_3,v3\\_3], [v1\\_4,v2\\_4,v3\\_4] ]},\n$$\n除了标准的逗号和括号外，没有额外的字符或空格。例如，一个有效的输出形状如下\n$$\n\\text{[[a,b,c],[d,e,f],[g,h,i],[j,k,l]]}.\n$$",
            "solution": "该问题具有科学依据，定义明确，并包含找到唯一解所需的所有信息。这是一个植根于计算系统生物学原理的有效优化问题。\n\n问题要求找到敲除后的通量向量 $v^\\star = \\begin{bmatrix} v_1^\\star  v_2^\\star  v_3^\\star \\end{bmatrix}^T$，该向量与给定的野生型通量向量 $v^{wt}$ 之间的平方欧几里得距离最小。这是代谢调整最小化（MOMA）的核心原理。该优化问题被表述为：\n$$\n\\min_{v \\in \\mathbb{R}^3} \\ \\|v - v^{wt}\\|_2^2\n$$\n受以下约束条件限制：\n1. 稳态条件：$S v = 0$\n2. 基因敲除条件：$v_2 = 0$\n3. 通量界限：$0 \\le v_i \\le 10$ 对于 $i \\in \\{1,2,3\\}$\n\n设 $v = \\begin{bmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{bmatrix}$ 和 $v^{wt} = \\begin{bmatrix} v_1^{wt} \\\\ v_2^{wt} \\\\ v_3^{wt} \\end{bmatrix}$。要最小化的目标函数是：\n$$\nf(v_1, v_2, v_3) = (v_1 - v_1^{wt})^2 + (v_2 - v_2^{wt})^2 + (v_3 - v_3^{wt})^2\n$$\n约束条件可以简化。化学计量矩阵为 $S = \\begin{bmatrix} 1  -1  -1 \\end{bmatrix}$。因此，稳态约束 $S v = 0$ 转化为：\n$$\nv_1 - v_2 - v_3 = 0\n$$\n我们还给出了敲除约束 $v_2 = 0$。将其代入稳态方程得到：\n$$\nv_1 - 0 - v_3 = 0 \\implies v_1 = v_3\n$$\n因此，可行的通量向量必须是 $v = \\begin{bmatrix} v_1 \\\\ 0 \\\\ v_1 \\end{bmatrix}$ 的形式。通量的界限是 $0 \\le v_1 \\le 10$，$0 \\le v_2 \\le 10$，和 $0 \\le v_3 \\le 10$。由于 $v_2=0$ 和 $v_1=v_3$，有效的约束变为 $0 \\le v_1 \\le 10$。\n\n问题已简化为在由 $t \\in [0, 10]$ 的 $v = (t, 0, t)$ 定义的线段上找到离点 $v^{wt}$ 最近的点。\n我们可以将 $v$ 的约束形式代入目标函数。问题变为最小化单变量 $v_1$ 的函数：\n$$\ng(v_1) = (v_1 - v_1^{wt})^2 + (0 - v_2^{wt})^2 + (v_1 - v_3^{wt})^2\n$$\n约束条件为 $0 \\le v_1 \\le 10$。\n\n这是一个关于 $v_1$ 的二次函数，描述了一个开口向上的抛物线。为了找到无约束的最小值，我们对 $g(v_1)$ 关于 $v_1$ 求导并令其为零：\n$$\n\\frac{dg}{dv_1} = 2(v_1 - v_1^{wt}) + 2(v_1 - v_3^{wt}) = 4v_1 - 2(v_1^{wt} + v_3^{wt})\n$$\n令导数为零：\n$$\n4v_1 - 2(v_1^{wt} + v_3^{wt}) = 0\n$$\n$$\nv_1 = \\frac{v_1^{wt} + v_3^{wt}}{2}\n$$\n我们称这个无约束解为 $v_{1,unc}$。为了找到约束问题的解，我们必须将这个值投影到可行区间 $[0, 10]$ 上。这通过限制该值来实现：\n$$\nv_1^\\star = \\max(0, \\min(10, v_{1,unc}))\n$$\n最优的敲除后通量向量 $v^\\star$ 则由 $v^\\star = \\begin{bmatrix} v_1^\\star \\\\ 0 \\\\ v_1^\\star \\end{bmatrix}$ 给出。\n\n我们现在将此通用解应用于每个测试用例。\n\n**测试用例 1：** $v^{wt} = (5, 5, 0)$\n- $v_{1,unc} = \\frac{5 + 0}{2} = 2.5$\n- 由于 $0 \\le 2.5 \\le 10$，我们有 $v_1^\\star = 2.5$。\n- $v^\\star = (2.5, 0, 2.5)$\n\n**测试用例 2：** $v^{wt} = (0, 0, 0)$\n- $v_{1,unc} = \\frac{0 + 0}{2} = 0$\n- 由于 $0 \\le 0 \\le 10$，我们有 $v_1^\\star = 0$。\n- $v^\\star = (0, 0, 0)$\n\n**测试用例 3：** $v^{wt} = (10, 10, 0)$\n- $v_{1,unc} = \\frac{10 + 0}{2} = 5$\n- 由于 $0 \\le 5 \\le 10$，我们有 $v_1^\\star = 5$。\n- $v^\\star = (5, 0, 5)$\n\n**测试用例 4：** $v^{wt} = (0, 0, 10)$\n- $v_{1,unc} = \\frac{0 + 10}{2} = 5$\n- 由于 $0 \\le 5 \\le 10$，我们有 $v_1^\\star = 5$。\n- $v^\\star = (5, 0, 5)$\n\n现在结果已准备好，可以在最终答案中进行格式化和呈现。",
            "answer": "[[2.500000,0.000000,2.500000],[0.000000,0.000000,0.000000],[5.000000,0.000000,5.000000],[5.000000,0.000000,5.000000]]"
        }
    ]
}