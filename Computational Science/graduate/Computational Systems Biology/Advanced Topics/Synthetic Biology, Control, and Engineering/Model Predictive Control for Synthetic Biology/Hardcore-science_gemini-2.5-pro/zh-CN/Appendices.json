{
    "hands_on_practices": [
        {
            "introduction": "模型预测控制（MPC）的第一步是建立一个能准确描述系统行为的数学模型。本练习将引导你完成一个关键步骤：线性化，即将一个非线性的生物反应器模型（化学恒化器）转换为可在特定操作点附近使用的线性状态空间形式。通过这个实践，你将掌握如何从复杂的生物动力学中提取用于控制器设计的简化模型，这是应用线性MPC的基础。",
            "id": "3326409",
            "problem": "您正在为承载合成基因回路的连续搅拌釜生物反应器（恒化器）设计一种线性模型预测控制（MPC）策略。线性化必须在约束回路行为的宿主生物量和底物子动力学上进行。考虑用于微生物生长的经典恒化器模型，其采用 Monod 动力学：\n$$\n\\begin{aligned}\n\\frac{d x_1}{dt} = \\big(\\mu(x_2) - u\\big)\\,x_1, \\\\\n\\frac{d x_2}{dt} = u\\,(S_{\\mathrm{in}} - x_2) - \\frac{1}{Y}\\,\\mu(x_2)\\,x_1,\n\\end{aligned}\n$$\n其中 $x_1$ 是生物量浓度，$x_2$ 是限制性底物浓度，$u$ 是稀释率（操作输入），$S_{\\mathrm{in}}$ 是流入底物浓度，$Y$ 是产率系数，$\\mu(x_2)$ 是由 Monod 方程给出的比生长速率\n$$\n\\mu(x_2) = \\mu_{\\max}\\,\\frac{x_2}{K_S + x_2}.\n$$\n使用以下物理上一致的参数值：$\\mu_{\\max} = 0.6$ h$^{-1}$，$K_S = 0.1$ g L$^{-1}$，$Y = 0.5$ g g$^{-1}$，$S_{\\mathrm{in}} = 10$ g L$^{-1}$，以及标称稀释率 $u^{\\star} = 0.3$ h$^{-1}$。在与 $u^{\\star}$ 相关联的非冲刷稳态 $(x_1^{\\star}, x_2^{\\star})$ 下进行计算。\n\n任务：\n1) 计算与 $u^{\\star}$ 一致的正稳态 $(x_1^{\\star}, x_2^{\\star})$。\n2) 在 $(x_1^{\\star}, x_2^{\\star}, u^{\\star})$ 附近将动力学线性化，以获得连续时间状态空间线性模型\n$$\n\\delta \\dot{x} = A\\,\\delta x + B\\,\\delta u,\n$$\n并提供根据给定参数在稳态下求值的显式矩阵 $A$ 和 $B$。\n3) 使用带余项的泰勒定理，证明线性近似对于小偏差的有效性。特别地，通过计算右侧关于状态的二阶导数，证明被忽略的余项满足以下形式的二次界\n$$\n\\|\\mathcal{R}(\\delta x)\\|_2 \\le \\frac{1}{2}\\,L\\,\\|\\delta x\\|_2^2\n$$\n在稳态的邻域内，并解释当 $\\delta u = 0$ 时，对于足够小的 $\\|\\delta x\\|_2$，这样的界如何意味着线性化的局部有效性。\n4) 最后，计算给定稳态下线性化矩阵 $A$ 的谱半径 $\\rho(A)$。\n\n答案规格：仅报告谱半径 $\\rho(A)$ 的数值作为最终答案。结果以 h$^{-1}$ 为单位表示，并将您的答案四舍五入到四位有效数字。最终的方框答案中不要包含单位。",
            "solution": "问题经评估有效。它在科学上基于标准的生物过程工程原理（具有 Monod 动力学的恒化器动力学），提法恰当，所有必要参数均已提供，且表述客观。这些任务可以进行数学形式化并导出一个唯一的解。我们开始求解。\n\n恒化器的常微分方程组由下式给出：\n$$\n\\begin{aligned}\n\\frac{d x_1}{dt} = f_1(x_1, x_2, u) = \\big(\\mu(x_2) - u\\big)\\,x_1 \\\\\n\\frac{d x_2}{dt} = f_2(x_1, x_2, u) = u\\,(S_{\\mathrm{in}} - x_2) - \\frac{1}{Y}\\,\\mu(x_2)\\,x_1\n\\end{aligned}\n$$\n其中比生长速率 $\\mu(x_2)$ 由 Monod 方程给出：\n$$\n\\mu(x_2) = \\mu_{\\max}\\,\\frac{x_2}{K_S + x_2}\n$$\n提供的参数值为：$\\mu_{\\max} = 0.6$ h$^{-1}$，$K_S = 0.1$ g L$^{-1}$，$Y = 0.5$ g g$^{-1}$，$S_{\\mathrm{in}} = 10$ g L$^{-1}$。标称稀释率为 $u^{\\star} = 0.3$ h$^{-1}$。\n\n**1) 计算非冲刷稳态 $(x_1^{\\star}, x_2^{\\star})$**\n在稳态下，时间导数为零：\n$$\n\\begin{aligned}\n\\frac{d x_1}{dt} = 0 \\implies \\big(\\mu(x_2^{\\star}) - u^{\\star}\\big)\\,x_1^{\\star} = 0 \\\\\n\\frac{d x_2}{dt} = 0 \\implies u^{\\star}\\,(S_{\\mathrm{in}} - x_2^{\\star}) - \\frac{1}{Y}\\,\\mu(x_2^{\\star})\\,x_1^{\\star} = 0\n\\end{aligned}\n$$\n对于非冲刷稳态，我们必须有 $x_1^{\\star} > 0$。第一个方程则意味着：\n$$\n\\mu(x_2^{\\star}) - u^{\\star} = 0 \\implies \\mu(x_2^{\\star}) = u^{\\star}\n$$\n代入 Monod 表达式和给定参数：\n$$\n\\mu_{\\max}\\,\\frac{x_2^{\\star}}{K_S + x_2^{\\star}} = u^{\\star} \\implies 0.6\\,\\frac{x_2^{\\star}}{0.1 + x_2^{\\star}} = 0.3\n$$\n求解 $x_2^{\\star}$：\n$$\n\\frac{x_2^{\\star}}{0.1 + x_2^{\\star}} = \\frac{0.3}{0.6} = 0.5\n$$\n$$\nx_2^{\\star} = 0.5\\,(0.1 + x_2^{\\star}) = 0.05 + 0.5\\,x_2^{\\star}\n$$\n$$\n0.5\\,x_2^{\\star} = 0.05 \\implies x_2^{\\star} = 0.1 \\text{ g L}^{-1}\n$$\n现在，我们使用第二个稳态方程并代入 $\\mu(x_2^{\\star}) = u^{\\star}$：\n$$\nu^{\\star}\\,(S_{\\mathrm{in}} - x_2^{\\star}) - \\frac{1}{Y}\\,u^{\\star}\\,x_1^{\\star} = 0\n$$\n由于 $u^{\\star} = 0.3 \\neq 0$，我们可以除以 $u^{\\star}$：\n$$\n(S_{\\mathrm{in}} - x_2^{\\star}) - \\frac{1}{Y}\\,x_1^{\\star} = 0 \\implies x_1^{\\star} = Y\\,(S_{\\mathrm{in}} - x_2^{\\star})\n$$\n代入已知值：\n$$\nx_1^{\\star} = 0.5 \\times (10 - 0.1) = 0.5 \\times 9.9 = 4.95 \\text{ g L}^{-1}\n$$\n非冲刷稳态为 $(x_1^{\\star}, x_2^{\\star}) = (4.95, 0.1)$。\n\n**2) 动力学线性化**\n我们在稳态 $(x^{\\star}, u^{\\star})$ 附近将系统 $\\dot{x} = f(x, u)$ 线性化，其中 $x = [x_1, x_2]^T$ 且 $u$ 是标量输入。线性化模型为 $\\delta \\dot{x} = A\\,\\delta x + B\\,\\delta u$，其中矩阵 $A$（雅可比矩阵）和 $B$ 由下式给出：\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{\\star} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1} & \\frac{\\partial f_1}{\\partial x_2} \\\\ \\frac{\\partial f_2}{\\partial x_1} & \\frac{\\partial f_2}{\\partial x_2} \\end{pmatrix}\\bigg|_{\\star}, \\quad B = \\frac{\\partial f}{\\partial u}\\bigg|_{\\star} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u} \\\\ \\frac{\\partial f_2}{\\partial u} \\end{pmatrix}\\bigg|_{\\star}\n$$\n偏导数是：\n$\\frac{\\partial f_1}{\\partial x_1} = \\mu(x_2) - u$\n$\\frac{\\partial f_1}{\\partial x_2} = x_1 \\frac{d\\mu}{dx_2}$\n$\\frac{\\partial f_2}{\\partial x_1} = -\\frac{1}{Y}\\mu(x_2)$\n$\\frac{\\partial f_2}{\\partial x_2} = -u - \\frac{1}{Y}x_1\\frac{d\\mu}{dx_2}$\n$\\frac{\\partial f_1}{\\partial u} = -x_1$\n$\\frac{\\partial f_2}{\\partial u} = S_{\\mathrm{in}} - x_2$\n\nMonod 函数的导数是 $\\frac{d\\mu}{dx_2} = \\frac{\\mu_{\\max} K_S}{(K_S + x_2)^2}$。\n我们在稳态 $(x_1^{\\star}, x_2^{\\star}, u^{\\star}) = (4.95, 0.1, 0.3)$ 下计算这些导数的值。\n首先，我们计算在 $x_2^{\\star}=0.1$ 处的 $\\frac{d\\mu}{dx_2}$：\n$$\n\\frac{d\\mu}{dx_2}\\bigg|_{x_2^{\\star}} = \\frac{0.6 \\times 0.1}{(0.1 + 0.1)^2} = \\frac{0.06}{0.2^2} = \\frac{0.06}{0.04} = 1.5 \\text{ h}^{-1} (\\text{g L}^{-1})^{-1}\n$$\n现在我们计算矩阵 $A$ 的元素：\n$A_{11} = \\mu(x_2^{\\star}) - u^{\\star} = u^{\\star} - u^{\\star} = 0$\n$A_{12} = x_1^{\\star} \\frac{d\\mu}{dx_2}\\bigg|_{x_2^{\\star}} = 4.95 \\times 1.5 = 7.425$\n$A_{21} = -\\frac{1}{Y}\\mu(x_2^{\\star}) = -\\frac{u^{\\star}}{Y} = -\\frac{0.3}{0.5} = -0.6$\n$A_{22} = -u^{\\star} - \\frac{1}{Y}x_1^{\\star}\\frac{d\\mu}{dx_2}\\bigg|_{x_2^{\\star}} = -u^{\\star} - \\frac{1}{Y}A_{12} = -0.3 - \\frac{1}{0.5}(7.425) = -0.3 - 14.85 = -15.15$\n状态矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix} 0 & 7.425 \\\\ -0.6 & -15.15 \\end{pmatrix}\n$$\n现在我们计算矩阵 $B$ 的元素：\n$B_{1} = -x_1^{\\star} = -4.95$\n$B_{2} = S_{\\mathrm{in}} - x_2^{\\star} = 10 - 0.1 = 9.9$\n输入矩阵 $B$ 是：\n$$\nB = \\begin{pmatrix} -4.95 \\\\ 9.9 \\end{pmatrix}\n$$\n\n**3) 线性近似的合理性证明**\n令 $x = x^{\\star} + \\delta x$。对于自治情况（$\\delta u = 0$），动力学为 $\\dot{x} = f(x)$。向量函数 $f$ 在 $x^{\\star}$ 附近展开的带积分余项的泰勒定理为：\n$$\nf(x^{\\star} + \\delta x) = f(x^{\\star}) + \\frac{\\partial f}{\\partial x}\\bigg|_{x^{\\star}}\\delta x + \\mathcal{R}(\\delta x)\n$$\n其中 $\\mathcal{R}(\\delta x) = \\int_0^1 (1-s) H_f(x^{\\star}+s\\delta x)(\\delta x, \\delta x) ds$，其中 $H_f$ 是 $f$ 的二阶偏导数张量。由于 $\\dot{x} = \\delta \\dot{x}$ 且 $f(x^{\\star})=0$，我们有 $\\delta \\dot{x} = A \\delta x + \\mathcal{R}(\\delta x)$。\n线性近似 $\\delta \\dot{x} \\approx A \\delta x$ 的有效性取决于对于小的 $\\|\\delta x\\|_2$，余项 $\\mathcal{R}(\\delta x)$ 相对于线性项 $A \\delta x$ 是否可以忽略不计。\n如果 $f$ 的二阶偏导数在 $x^{\\star}$ 的邻域内有界，则余项的分量是二次有界的。我们通过计算它们来验证这一点：\n$\\frac{\\partial^2 f_1}{\\partial x_1^2} = 0$, $\\frac{\\partial^2 f_2}{\\partial x_1^2} = 0$\n$\\frac{\\partial^2 f_1}{\\partial x_1 \\partial x_2} = \\frac{d\\mu}{dx_2} = \\frac{\\mu_{\\max} K_S}{(K_S + x_2)^2}$\n$\\frac{\\partial^2 f_2}{\\partial x_1 \\partial x_2} = -\\frac{1}{Y}\\frac{d\\mu}{dx_2} = -\\frac{\\mu_{\\max} K_S}{Y(K_S + x_2)^2}$\n$\\frac{d^2\\mu}{dx_2^2} = \\frac{-2 \\mu_{\\max} K_S}{(K_S + x_2)^3}$\n$\\frac{\\partial^2 f_1}{\\partial x_2^2} = x_1 \\frac{d^2\\mu}{dx_2^2} = \\frac{-2 x_1 \\mu_{\\max} K_S}{(K_S + x_2)^3}$\n$\\frac{\\partial^2 f_2}{\\partial x_2^2} = -\\frac{1}{Y}x_1 \\frac{d^2\\mu}{dx_2^2} = \\frac{2 x_1 \\mu_{\\max} K_S}{Y(K_S + x_2)^3}$\n由于 $K_S > 0$ 并且我们考虑的是正稳态的一个邻域，其中 $x_1 > 0$ 且 $x_2 > 0$，所有分母都非零。二阶导数是关于 $x_1$ 和 $x_2$ 的连续有理函数。因此，在 $x^{\\star}$ 的任何紧（闭合且有界）邻域内，它们是有界的。这种有界性保证了存在一个常数 $L > 0$，使得整个余项满足 $\\|\\mathcal{R}(\\delta x)\\|_2 \\le \\frac{1}{2} L \\|\\delta x\\|_2^2$。\n线性近似对于小的 $\\|\\delta x\\|_2$ 是有效的，因为误差是 $O(\\|\\delta x\\|_2^2)$ 阶的，相对于 $O(\\|\\delta x\\|_2)$ 阶的线性项变得可以忽略。具体来说，范数之比 $\\frac{\\|\\mathcal{R}(\\delta x)\\|_2}{\\|A \\delta x\\|_2} \\le \\frac{\\frac{1}{2} L \\|\\delta x\\|_2^2}{\\sigma_{\\min}(A)\\|\\delta x\\|_2} = \\frac{L}{2\\sigma_{\\min}(A)}\\|\\delta x\\|_2$，当 $\\|\\delta x\\|_2 \\to 0$ 时趋向于 $0$（假设系统不是退化的，即 $\\sigma_{\\min}(A) > 0$）。这证实了线性化的局部有效性。\n\n**4) 计算谱半径 $\\rho(A)$**\n谱半径是矩阵 $A$ 的特征值绝对值的最大值。特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} 0-\\lambda & 7.425 \\\\ -0.6 & -15.15-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-15.15-\\lambda) - (7.425)(-0.6) = 0\n$$\n$$\n15.15\\lambda + \\lambda^2 + 4.455 = 0\n$$\n$$\n\\lambda^2 + 15.15\\lambda + 4.455 = 0\n$$\n我们求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-15.15 \\pm \\sqrt{15.15^2 - 4(1)(4.455)}}{2} = \\frac{-15.15 \\pm \\sqrt{229.5225 - 17.82}}{2}\n$$\n$$\n\\lambda = \\frac{-15.15 \\pm \\sqrt{211.7025}}{2} = \\frac{-15.15 \\pm 14.55}{2}\n$$\n两个特征值是：\n$$\n\\lambda_1 = \\frac{-15.15 + 14.55}{2} = \\frac{-0.6}{2} = -0.3\n$$\n$$\n\\lambda_2 = \\frac{-15.15 - 14.55}{2} = \\frac{-29.7}{2} = -14.85\n$$\n特征值为 $\\lambda_1 = -0.3$ h$^{-1}$ 和 $\\lambda_2 = -14.85$ h$^{-1}$。两者都是实数且为负，表明该稳态是一个稳定节点。\n谱半径 $\\rho(A)$ 是：\n$$\n\\rho(A) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|-0.3|, |-14.85|) = \\max(0.3, 14.85) = 14.85\n$$\n值 $14.85$ 已经按要求表示为四位有效数字。",
            "answer": "$$\\boxed{14.85}$$"
        },
        {
            "introduction": "拥有一个模型还不够；我们必须确保系统是可控的，并且其状态可以从测量中推断出来。本练习深入探讨了合成基因线路的可控性和可观测性这两个基本概念。通过分析一个简化的基因表达模块，你将学会如何评估一个系统是否能被有效调控，并理解设计选择（例如添加报告蛋白）如何影响我们监控和调节系统的能力。",
            "id": "3326458",
            "problem": "一个合成基因表达模块在模型预测控制（MPC）下运行，以调节微生物底盘中的蛋白质丰度。该模块在一个工作点附近被线性化，得到一个连续时间线性时不变（LTI）模型，该模型具有两个状态：信使核糖核酸（mRNA）浓度 $x_{1}$ 和蛋白质浓度 $x_{2}$。唯一的控制输入 $u$ 是影响转录的诱导剂水平，唯一的测量输出 $y$ 是蛋白质荧光。线性化后的动力学和测量由下式给出\n$$\n\\dot{x}_{1} = -\\gamma_{m} x_{1} + \\alpha u,\\quad \\dot{x}_{2} = k_{t} x_{1} - \\gamma_{p} x_{2},\\quad y = x_{2},\n$$\n参数值为 $\\gamma_{m} = 0.24\\,\\text{min}^{-1}$，$\\gamma_{p} = 0.06\\,\\text{min}^{-1}$，$k_{t} = 0.12\\,\\text{min}^{-1}$，以及 $\\alpha = 0.80\\,\\text{min}^{-1}$。\n\n为了提高检测稳定性，添加了一个与蛋白质成比例结合并自身会降解的报告分子。这引入了第三个状态 $x_{3}$ （报告分子浓度），其动力学和测量如下\n$$\n\\dot{x}_{3} = k_{r} x_{2} - \\gamma_{r} x_{3},\\quad y_{\\text{rep}} = x_{3},\n$$\n其中 $k_{r} = 0.50\\,\\text{min}^{-1}$ 且 $\\gamma_{r} = 0.02\\,\\text{min}^{-1}$。输入 $u$ 仍然是唯一的执行器，输出则变为唯一的报告分子荧光 $y_{\\text{rep}}$。\n\n从连续时间LTI系统的能控性和能观性的标准定义出发，计算：\n- 原始二状态系统的能控性矩阵和能观性矩阵，并确定它们的秩；\n- 增广的三状态报告分子系统的能观性矩阵，并确定其秩。\n\n判断在保持单一测量输出（现在是报告分子）的情况下，添加报告分子是否会相对于原始系统降低能观性。对于最终答案，将结果以行矩阵的形式报告\n$$\\begin{pmatrix} r_{c}^{(2)} & r_{o}^{(2)} & r_{o}^{(3)} & d \\end{pmatrix},$$\n其中 $r_{c}^{(2)}$ 是二状态能控性矩阵的秩，$r_{o}^{(2)}$ 是二状态能观性矩阵的秩，$r_{o}^{(3)}$ 是带有报告分子输出的三状态能观性矩阵的秩，如果添加报告分子降低了能观性，则 $d$ 等于 $1$，否则等于 $0$。将最终行矩阵的条目表示为无单位的整数。无需四舍五入。",
            "solution": "该问题要求分析源自合成基因表达模块的两个相关的线性时不变（LTI）系统的能控性和能观性。设连续时间LTI系统的一般形式为\n$$\n\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)\n$$\n$$\n\\mathbf{y}(t) = C\\mathbf{x}(t) + D\\mathbf{u}(t)\n$$\n其中 $\\mathbf{x}$ 是维度为 $n$ 的状态向量，$\\mathbf{u}$ 是输入向量，$\\mathbf{y}$ 是输出向量。对于本问题中的系统，前馈矩阵 $D$ 为零。\n\n对偶 $(A, B)$ 的能控性由能控性矩阵 $\\mathcal{C}$ 的秩确定。对于单输入系统，该矩阵由下式给出\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B & \\cdots & A^{n-1}B \\end{pmatrix}\n$$\n如果 $\\text{rank}(\\mathcal{C}) = n$，则系统完全能控。\n\n对偶 $(A, C)$ 的能观性由能观性矩阵 $\\mathcal{O}$ 的秩确定。对于单输出系统，该矩阵由下式给出\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix}\n$$\n如果 $\\text{rank}(\\mathcal{O}) = n$，则系统完全能观。\n\n首先，我们分析原始的二状态系统。状态向量为 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。动力学由 $\\dot{x}_{1} = -\\gamma_{m} x_{1} + \\alpha u$ 和 $\\dot{x}_{2} = k_{t} x_{1} - \\gamma_{p} x_{2}$ 给出，输出为 $y = x_2$。\n状态空间矩阵为：\n$$\nA^{(2)} = \\begin{pmatrix} -\\gamma_m & 0 \\\\ k_t & -\\gamma_p \\end{pmatrix}, \\quad B^{(2)} = \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}, \\quad C^{(2)} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}\n$$\n代入给定的参数值 $\\gamma_{m} = 0.24$，$\\gamma_{p} = 0.06$，$k_{t} = 0.12$，和 $\\alpha = 0.80$：\n$$\nA^{(2)} = \\begin{pmatrix} -0.24 & 0 \\\\ 0.12 & -0.06 \\end{pmatrix}, \\quad B^{(2)} = \\begin{pmatrix} 0.80 \\\\ 0 \\end{pmatrix}, \\quad C^{(2)} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}\n$$\n该系统的维度为 $n=2$。\n\n为了确定能控性，我们计算能控性矩阵 $\\mathcal{C}^{(2)} = \\begin{pmatrix} B^{(2)} & A^{(2)}B^{(2)} \\end{pmatrix}$。\n首先，我们计算乘积 $A^{(2)}B^{(2)}$：\n$$\nA^{(2)}B^{(2)} = \\begin{pmatrix} -0.24 & 0 \\\\ 0.12 & -0.06 \\end{pmatrix} \\begin{pmatrix} 0.80 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-0.24)(0.80) \\\\ (0.12)(0.80) \\end{pmatrix} = \\begin{pmatrix} -0.192 \\\\ 0.096 \\end{pmatrix}\n$$\n能控性矩阵为：\n$$\n\\mathcal{C}^{(2)} = \\begin{pmatrix} 0.80 & -0.192 \\\\ 0 & 0.096 \\end{pmatrix}\n$$\n通过计算其行列式来求 $\\mathcal{C}^{(2)}$ 的秩：\n$$\n\\det(\\mathcal{C}^{(2)}) = (0.80)(0.096) - (-0.192)(0) = 0.0768\n$$\n由于 $\\det(\\mathcal{C}^{(2)}) \\neq 0$，该矩阵是满秩的。能控性矩阵的秩为 $r_c^{(2)} = 2$。该系统完全能控。\n\n接下来，为了确定能观性，我们计算能观性矩阵 $\\mathcal{O}^{(2)} = \\begin{pmatrix} C^{(2)} \\\\ C^{(2)}A^{(2)} \\end{pmatrix}$。\n首先，我们计算乘积 $C^{(2)}A^{(2)}$：\n$$\nC^{(2)}A^{(2)} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} -0.24 & 0 \\\\ 0.12 & -0.06 \\end{pmatrix} = \\begin{pmatrix} 0.12 & -0.06 \\end{pmatrix}\n$$\n能观性矩阵为：\n$$\n\\mathcal{O}^{(2)} = \\begin{pmatrix} 0 & 1 \\\\ 0.12 & -0.06 \\end{pmatrix}\n$$\n通过计算其行列式来求 $\\mathcal{O}^{(2)}$ 的秩：\n$$\n\\det(\\mathcal{O}^{(2)}) = (0)(-0.06) - (1)(0.12) = -0.12\n$$\n由于 $\\det(\\mathcal{O}^{(2)}) \\neq 0$，该矩阵是满秩的。能观性矩阵的秩为 $r_o^{(2)} = 2$。该系统完全能观。\n\n现在，我们分析带有报告分子的增广三状态系统。状态向量为 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。动力学扩展为 $\\dot{x}_{3} = k_{r} x_{2} - \\gamma_{r} x_{3}$，输出变为 $y_{\\text{rep}} = x_3$。该系统的维度为 $n=3$。\n新的状态空间矩阵为：\n$$\nA^{(3)} = \\begin{pmatrix} -\\gamma_m & 0 & 0 \\\\ k_t & -\\gamma_p & 0 \\\\ 0 & k_r & -\\gamma_r \\end{pmatrix}, \\quad C^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}\n$$\n代入新的参数值 $k_r = 0.50$ 和 $\\gamma_r = 0.02$：\n$$\nA^{(3)} = \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix}, \\quad C^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}\n$$\n我们需要求能观性矩阵 $\\mathcal{O}^{(3)} = \\begin{pmatrix} C^{(3)} \\\\ C^{(3)}A^{(3)} \\\\ C^{(3)}(A^{(3)})^2 \\end{pmatrix}$ 的秩。\n我们计算 $\\mathcal{O}^{(3)}$ 的各行：\n第一行是 $C^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}$。\n第二行是 $C^{(3)}A^{(3)}$：\n$$\nC^{(3)}A^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix} = \\begin{pmatrix} 0 & 0.50 & -0.02 \\end{pmatrix}\n$$\n第三行是 $C^{(3)}(A^{(3)})^2$。首先我们计算 $(A^{(3)})^2$：\n$$\n(A^{(3)})^2 = \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix} \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.0576 & 0 & 0 \\\\ -0.036 & 0.0036 & 0 \\\\ 0.06 & -0.04 & 0.0004 \\end{pmatrix}\n$$\n然后，我们计算 $C^{(3)}(A^{(3)})^2$：\n$$\nC^{(3)}(A^{(3)})^2 = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.0576 & 0 & 0 \\\\ -0.036 & 0.0036 & 0 \\\\ 0.06 & -0.04 & 0.0004 \\end{pmatrix} = \\begin{pmatrix} 0.06 & -0.04 & 0.0004 \\end{pmatrix}\n$$\n三状态系统的能观性矩阵为：\n$$\n\\mathcal{O}^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 0.50 & -0.02 \\\\ 0.06 & -0.04 & 0.0004 \\end{pmatrix}\n$$\n为了求其秩，我们计算行列式：\n$$\n\\det(\\mathcal{O}^{(3)}) = 0 \\cdot \\det\\begin{pmatrix} 0.50 & -0.02 \\\\ -0.04 & 0.0004 \\end{pmatrix} - 0 \\cdot \\det\\begin{pmatrix} 0 & -0.02 \\\\ 0.06 & 0.0004 \\end{pmatrix} + 1 \\cdot \\det\\begin{pmatrix} 0 & 0.50 \\\\ 0.06 & -0.04 \\end{pmatrix}\n$$\n$$\n\\det(\\mathcal{O}^{(3)}) = 1 \\cdot ((0)(-0.04) - (0.50)(0.06)) = -0.03\n$$\n由于 $\\det(\\mathcal{O}^{(3)}) \\neq 0$，该矩阵是满秩的。三状态系统的能观性矩阵的秩为 $r_o^{(3)} = 3$。\n\n最后，我们必须判断能观性是否降低。原始的二状态系统是完全能观的，因为 $r_o^{(2)} = 2$，等于其状态数。增广的三状态系统也是完全能观的，因为 $r_o^{(3)} = 3$，等于其状态数。由于在添加报告分子和改变测量后，系统仍然是完全能观的，因此能观性没有在丢失的意义上降低。因此，降低指示符 $d$ 为 $0$。\n\n所需结果为：$r_c^{(2)} = 2$，$r_o^{(2)} = 2$，$r_o^{(3)} = 3$，以及 $d = 0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 2 & 3 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "真实的生物系统在施加控制作用和观察到其效果之间常常存在延迟。本练习通过构建和仿真一个增广状态空间模型，来解决常见的输入延迟问题。这项技术是MPC中的关键方法，用于在存在延迟的情况下保持预测的准确性和控制性能，对于将理论控制器应用于实际系统至关重要。",
            "id": "3326498",
            "problem": "考虑一个合成生物学中转录-翻译模块的线性化、离散时间、单输入单输出 (SISO) 模型，该模块由诱导剂输入控制，其中蛋白质浓度是测量输出。其离散时间动态被建模为一个线性时不变系统，具有 $d$ 步的整数值离散时间输入延迟。令 $x_k \\in \\mathbb{R}^n$ 表示第 $k$ 步的状态向量，$u_k \\in \\mathbb{R}$ 表示第 $k$ 步的标量诱导剂，$y_k \\in \\mathbb{R}$ 表示标量蛋白质读数。该系统遵循\n$$\nx_{k+1} = A_d x_k + B_d u_{k-d}, \\quad y_k = C x_k,\n$$\n其中 $A_d \\in \\mathbb{R}^{n \\times n}$、$B_d \\in \\mathbb{R}^{n \\times 1}$ 和 $C \\in \\mathbb{R}^{1 \\times n}$ 是给定的。所有状态和输入都是无量纲的。\n\n您的任务是构建模型预测控制 (MPC) 中使用的标准延迟补偿增广模型，并在有限时域内模拟向前 $d$ 步的预测。从离散时间线性系统的基本状态更新定律和整数输入延迟的定义出发，通过将过去输入的移位寄存器嵌入到状态中，系统地推导出可消除显式延迟的增广状态动态。除了基本的状态更新定律外，不要假定任何预先构建的公式。\n\n具体来说，请执行以下操作：\n- 通过将原始状态 $x_k$ 与表示延迟驱动为无延迟增广系统所需的有限、有序的过去输入记忆进行堆叠，构建增广状态 $z_k$。从第一性原理出发，为通用整数延迟 $d \\ge 0$ 和 SISO 输入推导增广状态转移矩阵 $A_{\\text{aug}}$、输入矩阵 $B_{\\text{aug}}$ 和输出矩阵 $C_{\\text{aug}}$。\n- 使用增广无延迟表示，在 $H$ 步的有限时域内模拟开环预测。给定初始状态 $x_k$、按时间顺序排列的最近 $d$ 个过去输入序列 $\\{u_{k-d}, u_{k-d+1}, \\dots, u_{k-1}\\}$，以及规划的未来输入序列 $\\{u_k, u_{k+1}, \\dots, u_{k+H-1}\\}$，计算预测输出序列 $\\{y_{k+1}, y_{k+2}, \\dots, y_{k+H}\\}$。您必须通过迭代无延迟增广模型来计算这些预测；不允许将延迟输入直接代入原始的延迟模型。\n- 确保您的算法在边界情况 $d=0$（无输入延迟）下也能工作，此时增广模型应简化为原始模型。\n\n使用以下固定的系统矩阵，其对应于一个双状态线性化基因表达模块 ($n=2$)：\n$$\nA_d = \\begin{bmatrix} 0.85 & 0.00 \\\\ 0.15 & 0.90 \\end{bmatrix}, \\quad B_d = \\begin{bmatrix} 0.10 \\\\ 0.02 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 0 & 1 \\end{bmatrix}.\n$$\n\n测试套件：\n对于每个测试用例，您将获得 $(d, H, x_k, \\{u_{k-d},\\dots,u_{k-1}\\}, \\{u_k,\\dots,u_{k+H-1}\\})$。所有向量均以标准欧几里得坐标给出，输入为标量。请完全按照下文指定的数据使用。\n\n- 测试用例 1 (一般正常路径)：\n  - $d = 2$, $H=5$\n  - $x_k = \\begin{bmatrix} 0.5 \\\\ 0.2 \\end{bmatrix}$\n  - 过去输入 $\\{u_{k-2}, u_{k-1}\\} = \\{0.0, 0.1\\}$\n  - 规划输入 $\\{u_k, u_{k+1}, u_{k+2}, u_{k+3}, u_{k+4}\\} = \\{0.2, 0.2, 0.1, 0.0, 0.0\\}$\n\n- 测试用例 2 (边界，无延迟)：\n  - $d = 0$, $H=4$\n  - $x_k = \\begin{bmatrix} 0.1 \\\\ 0.0 \\end{bmatrix}$\n  - 过去输入：空序列\n  - 规划输入 $\\{u_k, u_{k+1}, u_{k+2}, u_{k+3}\\} = \\{0.3, 0.0, 0.0, 0.0\\}$\n\n- 测试用例 3 (边缘，延迟主导时域)：\n  - $d = 3$, $H=3$\n  - $x_k = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$\n  - 过去输入 $\\{u_{k-3}, u_{k-2}, u_{k-1}\\} = \\{0.5, 0.5, 0.5\\}$\n  - 规划输入 $\\{u_k, u_{k+1}, u_{k+2}\\} = \\{0.0, 0.0, 0.0\\}$\n\n最终输出格式：\n- 对于每个测试用例，您的程序必须计算预测输出列表 $\\{y_{k+1}, \\dots, y_{k+H}\\}$，并四舍五入到 $6$ 位小数。\n- 所有状态和输入都是无量纲的；输出中不需要物理单位。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是对应于一个测试用例的浮点数列表，例如：$\\texttt{[[a\\_1,\\dots,a\\_H],[b\\_1,\\dots,b\\_H],[c\\_1,\\dots,c\\_H]]}$，每个 $a_i$、$b_i$、$c_i$ 都四舍五入到 $6$ 位小数。",
            "solution": "目标是为一个给定的、具有整数输入延迟 $d$ 的离散时间线性时不变 (LTI) 系统推导其延迟补偿增广状态空间模型，然后使用该模型在有限时域 $H$ 内预测未来输出。\n\n原始系统动态由下式给出：\n$$\nx_{k+1} = A_d x_k + B_d u_{k-d} \\quad (1)\n$$\n$$\ny_k = C x_k \\quad (2)\n$$\n其中 $x_k \\in \\mathbb{R}^n$ 是状态向量，$u_k \\in \\mathbb{R}$ 是标量输入，$y_k \\in \\mathbb{R}$ 是在时间步 $k$ 的标量输出。输入 $u_k$ 仅在 $d$ 个时间步的延迟后才影响状态 $x$。为了创建一个形如 $z_{k+1} = A_{\\text{aug}} z_k + B_{\\text{aug}} u_k$ 的标准无延迟模型，我们必须增广状态向量以包含过去 $d$ 个输入的记忆。\n\n### $d \\ge 1$ 时增广模型的推导\n\n让我们定义一个增广状态向量 $z_k \\in \\mathbb{R}^{n+d}$，它将原始状态 $x_k$ 与最近 $d$ 个已进入系统但其效果尚未完全传播到状态 $x_k$ 的输入序列拼接起来。我们按输入的时间顺序定义时间步 $k$ 的增广状态 $z_k$：\n$$\nz_k = \\begin{bmatrix}\nx_k \\\\\nu_{k-d} \\\\\nu_{k-d+1} \\\\\n\\vdots \\\\\nu_{k-1}\n\\end{bmatrix}\n$$\n$z_k$ 的维度是 $(n+d) \\times 1$。我们的目标是找到矩阵 $A_{\\text{aug}}$ 和 $B_{\\text{aug}}$，使得 $z_{k+1} = A_{\\text{aug}} z_k + B_{\\text{aug}} u_k$。\n\n首先，我们写出 $z_{k+1}$ 的表达式：\n$$\nz_{k+1} = \\begin{bmatrix}\nx_{k+1} \\\\\nu_{k+1-d} \\\\\nu_{k+2-d} \\\\\n\\vdots \\\\\nu_k\n\\end{bmatrix}\n$$\n现在，我们用 $z_k$ 的分量和当前输入 $u_k$ 来表示 $z_{k+1}$ 的每个分量。\n\n1.  **$x_{k+1}$ 的动态**：根据原始状态方程 (1)，我们有 $x_{k+1} = A_d x_k + B_d u_{k-d}$。$x_k$ 和 $u_{k-d}$ 都存在于我们的增广状态 $z_k$ 中。具体来说，$x_k$ 构成了 $z_k$ 的前 $n$ 个元素，而 $u_{k-d}$ 是第 $(n+1)$ 个元素（使用基于 1 的索引）。\n\n2.  **输入缓冲区的动态**：$z_{k+1}$ 的其余分量构成一个移位寄存器。在时间 $k+1$ 的输入 $u_{k+1-d}$ 就是在时间 $k$ 的输入 $u_{k-d+1}$。除最后一个外，所有缓冲的输入都遵循此规律。\n    -   $z_{k+1}$ 中的 $u_{k+1-d}$ 是来自 $z_k$ 的 $u_{k-d+1}$。\n    -   $z_{k+1}$ 中的 $u_{k+2-d}$ 是来自 $z_k$ 的 $u_{k-d+2}$。\n    -   ...\n    -   $z_{k+1}$ 中的 $u_{k-1}$ 是来自 $z_k$ 的 $u_{k-1}$。\n    -   最后一个分量，$z_{k+1}$ 中的 $u_k$，是在时间步 $k$ 施加的新控制输入。\n\n综合这些观察结果，我们可以将 $z_{k+1}$ 的状态更新写为：\n$$\nz_{k+1} = \\begin{bmatrix}\nA_d x_k + B_d u_{k-d} \\\\\nu_{k-d+1} \\\\\nu_{k-d+2} \\\\\n\\vdots \\\\\nu_{k-1} \\\\\nu_k\n\\end{bmatrix}\n$$\n我们现在可以将依赖于 $z_k$ 的项与依赖于新输入 $u_k$ 的项分开：\n$$\nz_{k+1} = \\begin{bmatrix}\nA_d x_k + B_d u_{k-d} \\\\\nu_{k-d+1} \\\\\n\\vdots \\\\\nu_{k-1} \\\\\n0\n\\end{bmatrix} + \\begin{bmatrix}\n\\mathbf{0}_{n \\times 1} \\\\\n0 \\\\\n\\vdots \\\\\n0 \\\\\n1\n\\end{bmatrix} u_k\n$$\n通过如下定义 $A_{\\text{aug}}$ 和 $B_{\\text{aug}}$，这可以表示为所期望的矩阵形式 $z_{k+1} = A_{\\text{aug}} z_k + B_{\\text{aug}} u_k$：\n\n$$\nA_{\\text{aug}} = \\begin{bmatrix}\nA_d & B_d & \\mathbf{0}_{n \\times 1} & \\cdots & \\mathbf{0}_{n \\times 1} \\\\\n\\mathbf{0}_{1 \\times n} & 0 & 1 & \\cdots & 0 \\\\\n\\mathbf{0}_{1 \\times n} & 0 & 0 & \\ddots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & 1 \\\\\n\\mathbf{0}_{1 \\times n} & 0 & 0 & \\cdots & 0\n\\end{bmatrix} \\in \\mathbb{R}^{(n+d) \\times (n+d)}\n$$\n\n$$\nB_{\\text{aug}} = \\begin{bmatrix} \\mathbf{0}_{n \\times 1} \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{bmatrix} \\in \\mathbb{R}^{(n+d) \\times 1}\n$$\n\n输出方程 $y_k = C x_k$ 也必须用增广状态 $z_k$ 来表示。由于 $y_k$ 仅依赖于 $x_k$，我们有：\n$$\ny_k = \\begin{bmatrix} C & \\mathbf{0}_{1 \\times d} \\end{bmatrix} z_k\n$$\n因此，增广输出矩阵是：\n$$\nC_{\\text{aug}} = \\begin{bmatrix} C & \\mathbf{0}_{1 \\times d} \\end{bmatrix} \\in \\mathbb{R}^{1 \\times (n+d)}\n$$\n\n### 边界情况：无延迟 ($d=0$)\n\n当 $d=0$ 时，输入延迟为零。原始系统方程变为：\n$$\nx_{k+1} = A_d x_k + B_d u_k, \\quad y_k = C x_k\n$$\n该系统已经处于标准的无延迟形式。无需进行状态增广。在这种情况下，“增广”系统与原始系统相同：\n-   $z_k = x_k$\n-   $A_{\\text{aug}} = A_d$\n-   $B_{\\text{aug}} = B_d$\n-   $C_{\\text{aug}} = C$\n\n### 开环预测的模拟程序\n\n给定初始状态 $x_k$、过去 $d$ 个输入的历史记录 $\\{u_{k-d}, \\dots, u_{k-1}\\}$，以及规划的未来输入序列 $\\{u_k, \\dots, u_{k+H-1}\\}$，我们可以通过迭代增广模型来预测未来的输出 $\\{y_{k+1}, \\dots, y_{k+H}\\}$。\n\n1.  **构建初始增广状态**：在时间 $k$，使用给定的 $x_k$ 和过去的输入来组装初始增广状态向量 $z_k$。\n    -   如果 $d \\ge 1$：$z_k = [x_k^T, u_{k-d}, \\dots, u_{k-1}]^T$。\n    -   如果 $d = 0$：$z_k = x_k$。\n\n2.  **迭代动态**：对于从 $0$ 到 $H-1$ 的 $j$，顺序计算未来的增广状态和输出。设当前增广状态为 $z_{\\text{curr}}$，当前输入为 $u_{\\text{curr}}$。\n    -   初始化：$z_{\\text{curr}} = z_k$。\n    -   对于 $j=0, 1, \\dots, H-1$：\n        a.  设置当前输入：$u_{\\text{curr}} = u_{k+j}$。\n        b.  计算下一个增广状态：$z_{\\text{next}} = A_{\\text{aug}} z_{\\text{curr}} + B_{\\text{aug}} u_{\\text{curr}}$。\n        c.  计算下一个时间步的预测输出：$y_{k+j+1} = C_{\\text{aug}} z_{\\text{next}}$。\n        d.  存储 $y_{k+j+1}$。\n        e.  为下一次迭代更新状态：$z_{\\text{curr}} = z_{\\text{next}}$。\n\n3.  **收集结果**：存储的输出序列 $\\{y_{k+1}, y_{k+2}, \\dots, y_{k+H}\\}$ 即为所求的预测结果。\n此程序通过在增广状态的移位寄存器中传播输入，正确地模拟了系统的演化，并考虑了输入延迟。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the model predictive control problem for synthetic biology as described.\n    It computes open-loop predictions for a linearized gene expression module\n    with input delay by deriving and iterating an augmented state-space model.\n    \"\"\"\n    \n    # Fixed system parameters as per the problem statement\n    A_d = np.array([[0.85, 0.00], [0.15, 0.90]])\n    B_d = np.array([[0.10], [0.02]])\n    C = np.array([[0, 1]])\n    n = A_d.shape[0]\n\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"d\": 2, \"H\": 5,\n            \"x_k\": np.array([[0.5], [0.2]]),\n            \"past_inputs\": [0.0, 0.1],\n            \"planned_inputs\": [0.2, 0.2, 0.1, 0.0, 0.0]\n        },\n        {\n            \"d\": 0, \"H\": 4,\n            \"x_k\": np.array([[0.1], [0.0]]),\n            \"past_inputs\": [],\n            \"planned_inputs\": [0.3, 0.0, 0.0, 0.0]\n        },\n        {\n            \"d\": 3, \"H\": 3,\n            \"x_k\": np.array([[0.0], [0.0]]),\n            \"past_inputs\": [0.5, 0.5, 0.5],\n            \"planned_inputs\": [0.0, 0.0, 0.0]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        d = case[\"d\"]\n        H = case[\"H\"]\n        x_k = case[\"x_k\"]\n        past_inputs = case[\"past_inputs\"]\n        planned_inputs = case[\"planned_inputs\"]\n\n        if d == 0:\n            # Boundary case: no delay, no augmentation needed.\n            A_aug = A_d\n            B_aug = B_d\n            C_aug = C\n            z_k = x_k\n        else:\n            # General case: d >= 1. Construct augmented system.\n            aug_dim = n + d\n            \n            # Construct A_aug\n            A_aug = np.zeros((aug_dim, aug_dim))\n            A_aug[0:n, 0:n] = A_d  # Top-left block is A_d\n            A_aug[0:n, n:n+1] = B_d  # Input u_{k-d} affects x\n            # Shift register part\n            for i in range(d - 1):\n                A_aug[n + i, n + i + 1] = 1.0\n\n            # Construct B_aug\n            B_aug = np.zeros((aug_dim, 1))\n            B_aug[aug_dim - 1, 0] = 1.0  # New input u_k enters at the end of the register\n\n            # Construct C_aug\n            C_aug = np.zeros((1, aug_dim))\n            C_aug[0, 0:n] = C  # Output depends only on original state x\n\n            # Construct initial augmented state z_k\n            past_inputs_col = np.array(past_inputs).reshape(-1, 1)\n            z_k = np.vstack((x_k, past_inputs_col))\n\n        # --- Simulation Loop ---\n        y_predictions = []\n        z_current = z_k\n        \n        for j in range(H):\n            u_current = planned_inputs[j]\n            \n            # Propagate the augmented state one step forward\n            z_next = A_aug @ z_current + B_aug * u_current\n            \n            # Calculate the predicted output\n            y_next = C_aug @ z_next\n            \n            y_predictions.append(round(y_next[0, 0], 6))\n            \n            # Update state for the next iteration\n            z_current = z_next\n            \n        all_results.append(y_predictions)\n\n    # Format the final output string as specified\n    # e.g., [[val1,val2],[val3,val4]]\n    # Using string replace is a simple way to match the no-space format\n    # without adding forbidden library dependencies like json.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}