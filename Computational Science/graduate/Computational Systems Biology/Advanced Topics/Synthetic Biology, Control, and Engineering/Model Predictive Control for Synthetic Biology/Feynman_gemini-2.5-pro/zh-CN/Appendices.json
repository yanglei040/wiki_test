{
    "hands_on_practices": [
        {
            "introduction": "许多强大的控制策略，包括线性模型预测控制（MPC），都建立在线性系统模型之上。本练习将提供控制设计中关键第一步的实践：将一个现实的、非线性的生物过程模型（在此案例中为具有Monod动力学的化学恒化器）在其操作点附近进行线性化 。掌握这项技能使您能够将庞大的线性控制理论工具箱应用于合成生物学这个复杂且非线性的领域。",
            "id": "3326409",
            "problem": "您正在为一个承载合成基因回路的连续搅拌釜生物反应器（恒化器）设计一种线性模型预测控制（MPC）策略。线性化必须在约束基因回路行为的宿主生物质和底物子动力学上进行。考虑经典的带有Monod动力学的恒化器模型，用于描述微生物生长：\n$$\n\\begin{aligned}\n\\frac{d x_1}{dt} = \\big(\\mu(x_2) - u\\big)\\,x_1, \\\\\n\\frac{d x_2}{dt} = u\\,(S_{\\mathrm{in}} - x_2) - \\frac{1}{Y}\\,\\mu(x_2)\\,x_1,\n\\end{aligned}\n$$\n其中，$x_1$ 是生物质浓度，$x_2$ 是限制性底物浓度，$u$ 是稀释率（操纵输入），$S_{\\mathrm{in}}$ 是流入底物浓度，$Y$ 是产率系数，$\\mu(x_2)$ 是由Monod关系式给出的比生长速率\n$$\n\\mu(x_2) = \\mu_{\\max}\\,\\frac{x_2}{K_S + x_2}.\n$$\n使用以下物理上一致的参数值：$\\mu_{\\max} = 0.6$ h$^{-1}$，$K_S = 0.1$ g L$^{-1}$，$Y = 0.5$ g g$^{-1}$，$S_{\\mathrm{in}} = 10$ g L$^{-1}$，以及一个标称稀释率 $u^{\\star} = 0.3$ h$^{-1}$。在与 $u^{\\star}$ 相关的非冲刷稳态 $(x_1^{\\star}, x_2^{\\star})$ 下进行计算。\n\n任务：\n1) 计算与 $u^{\\star}$ 一致的正稳态 $(x_1^{\\star}, x_2^{\\star})$。\n2) 在 $(x_1^{\\star}, x_2^{\\star}, u^{\\star})$ 周围对动力学进行线性化，以获得连续时间状态空间线性模型\n$$\n\\delta \\dot{x} = A\\,\\delta x + B\\,\\delta u,\n$$\n并提供在稳态下用给定参数评估的矩阵 $A$ 和 $B$ 的显式形式。\n3) 使用带余项的泰勒定理，证明线性近似对于小偏差的有效性。具体而言，通过计算右侧函数对状态的二阶导数，证明被忽略的余项满足以下形式的二次界\n$$\n\\|\\mathcal{R}(\\delta x)\\|_2 \\le \\frac{1}{2}\\,L\\,\\|\\delta x\\|_2^2\n$$\n在稳态的一个邻域内，并解释当 $\\delta u = 0$ 时，对于足够小的 $\\|\\delta x\\|_2$，这样的界如何意味着线性化的局部有效性。\n4) 最后，计算在给定稳态下线性化矩阵 $A$ 的谱半径 $\\rho(A)$。\n\n答案要求：最终答案仅报告谱半径 $\\rho(A)$ 的数值。结果以 h$^{-1}$ 为单位表示，并四舍五入到四位有效数字。最终的方框答案中不要包含单位。",
            "solution": "该问题经评估有效。它在科学上基于标准的生物过程工程原理（具有Monod动力学的恒化器动力学），问题设定良好，提供了所有必需的参数，且其表述是客观的。这些任务可以数学上形式化，并导向一个唯一解。我们开始进行求解。\n\n恒化器的常微分方程组由下式给出：\n$$\n\\begin{aligned}\n\\frac{d x_1}{dt} = f_1(x_1, x_2, u) = \\big(\\mu(x_2) - u\\big)\\,x_1 \\\\\n\\frac{d x_2}{dt} = f_2(x_1, x_2, u) = u\\,(S_{\\mathrm{in}} - x_2) - \\frac{1}{Y}\\,\\mu(x_2)\\,x_1\n\\end{aligned}\n$$\n其中比生长速率 $\\mu(x_2)$ 由Monod方程给出：\n$$\n\\mu(x_2) = \\mu_{\\max}\\,\\frac{x_2}{K_S + x_2}\n$$\n提供的参数值为：$\\mu_{\\max} = 0.6$ h$^{-1}$，$K_S = 0.1$ g L$^{-1}$，$Y = 0.5$ g g$^{-1}$，$S_{\\mathrm{in}} = 10$ g L$^{-1}$。标称稀释率为 $u^{\\star} = 0.3$ h$^{-1}$。\n\n**1) 计算非冲刷稳态 $(x_1^{\\star}, x_2^{\\star})$**\n在稳态下，时间导数为零：\n$$\n\\begin{aligned}\n\\frac{d x_1}{dt} = 0 \\implies \\big(\\mu(x_2^{\\star}) - u^{\\star}\\big)\\,x_1^{\\star} = 0 \\\\\n\\frac{d x_2}{dt} = 0 \\implies u^{\\star}\\,(S_{\\mathrm{in}} - x_2^{\\star}) - \\frac{1}{Y}\\,\\mu(x_2^{\\star})\\,x_1^{\\star} = 0\n\\end{aligned}\n$$\n对于非冲刷稳态，我们必须有 $x_1^{\\star} > 0$。第一个方程则意味着：\n$$\n\\mu(x_2^{\\star}) - u^{\\star} = 0 \\implies \\mu(x_2^{\\star}) = u^{\\star}\n$$\n代入Monod表达式和给定参数：\n$$\n\\mu_{\\max}\\,\\frac{x_2^{\\star}}{K_S + x_2^{\\star}} = u^{\\star} \\implies 0.6\\,\\frac{x_2^{\\star}}{0.1 + x_2^{\\star}} = 0.3\n$$\n求解 $x_2^{\\star}$：\n$$\n\\frac{x_2^{\\star}}{0.1 + x_2^{\\star}} = \\frac{0.3}{0.6} = 0.5\n$$\n$$\nx_2^{\\star} = 0.5\\,(0.1 + x_2^{\\star}) = 0.05 + 0.5\\,x_2^{\\star}\n$$\n$$\n0.5\\,x_2^{\\star} = 0.05 \\implies x_2^{\\star} = 0.1 \\text{ g L}^{-1}\n$$\n现在，我们使用第二个稳态方程并代入 $\\mu(x_2^{\\star}) = u^{\\star}$：\n$$\nu^{\\star}\\,(S_{\\mathrm{in}} - x_2^{\\star}) - \\frac{1}{Y}\\,u^{\\star}\\,x_1^{\\star} = 0\n$$\n由于 $u^{\\star} = 0.3 \\neq 0$，我们可以除以 $u^{\\star}$：\n$$\n(S_{\\mathrm{in}} - x_2^{\\star}) - \\frac{1}{Y}\\,x_1^{\\star} = 0 \\implies x_1^{\\star} = Y\\,(S_{\\mathrm{in}} - x_2^{\\star})\n$$\n代入已知值：\n$$\nx_1^{\\star} = 0.5 \\times (10 - 0.1) = 0.5 \\times 9.9 = 4.95 \\text{ g L}^{-1}\n$$\n非冲刷稳态为 $(x_1^{\\star}, x_2^{\\star}) = (4.95, 0.1)$。\n\n**2) 动力学线性化**\n我们在稳态 $(x^{\\star}, u^{\\star})$ 周围对系统 $\\dot{x} = f(x, u)$ 进行线性化，其中 $x = [x_1, x_2]^T$，$u$ 是标量输入。线性化模型为 $\\delta \\dot{x} = A\\,\\delta x + B\\,\\delta u$，其中矩阵 $A$（雅可比矩阵）和 $B$ 由下式给出：\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{\\star} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1} & \\frac{\\partial f_1}{\\partial x_2} \\\\ \\frac{\\partial f_2}{\\partial x_1} & \\frac{\\partial f_2}{\\partial x_2} \\end{pmatrix}\\bigg|_{\\star}, \\quad B = \\frac{\\partial f}{\\partial u}\\bigg|_{\\star} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u} \\\\ \\frac{\\partial f_2}{\\partial u} \\end{pmatrix}\\bigg|_{\\star}\n$$\n偏导数是：\n$\\frac{\\partial f_1}{\\partial x_1} = \\mu(x_2) - u$\n$\\frac{\\partial f_1}{\\partial x_2} = x_1 \\frac{d\\mu}{dx_2}$\n$\\frac{\\partial f_2}{\\partial x_1} = -\\frac{1}{Y}\\mu(x_2)$\n$\\frac{\\partial f_2}{\\partial x_2} = -u - \\frac{1}{Y}x_1\\frac{d\\mu}{dx_2}$\n$\\frac{\\partial f_1}{\\partial u} = -x_1$\n$\\frac{\\partial f_2}{\\partial u} = S_{\\mathrm{in}} - x_2$\n\nMonod函数的导数是 $\\frac{d\\mu}{dx_2} = \\frac{\\mu_{\\max} K_S}{(K_S + x_2)^2}$。\n我们在稳态 $(x_1^{\\star}, x_2^{\\star}, u^{\\star}) = (4.95, 0.1, 0.3)$ 下计算这些导数。\n首先，我们计算在 $x_2^{\\star}=0.1$ 处的 $\\frac{d\\mu}{dx_2}$：\n$$\n\\frac{d\\mu}{dx_2}\\bigg|_{x_2^{\\star}} = \\frac{0.6 \\times 0.1}{(0.1 + 0.1)^2} = \\frac{0.06}{0.2^2} = \\frac{0.06}{0.04} = 1.5 \\text{ h}^{-1} (\\text{g L}^{-1})^{-1}\n$$\n现在我们计算矩阵 $A$ 的元素：\n$A_{11} = \\mu(x_2^{\\star}) - u^{\\star} = u^{\\star} - u^{\\star} = 0$\n$A_{12} = x_1^{\\star} \\frac{d\\mu}{dx_2}\\bigg|_{x_2^{\\star}} = 4.95 \\times 1.5 = 7.425$\n$A_{21} = -\\frac{1}{Y}\\mu(x_2^{\\star}) = -\\frac{u^{\\star}}{Y} = -\\frac{0.3}{0.5} = -0.6$\n$A_{22} = -u^{\\star} - \\frac{1}{Y}x_1^{\\star}\\frac{d\\mu}{dx_2}\\bigg|_{x_2^{\\star}} = -u^{\\star} - \\frac{1}{Y}A_{12} = -0.3 - \\frac{1}{0.5}(7.425) = -0.3 - 14.85 = -15.15$\n状态矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix} 0 & 7.425 \\\\ -0.6 & -15.15 \\end{pmatrix}\n$$\n现在我们计算矩阵 $B$ 的元素：\n$B_{1} = -x_1^{\\star} = -4.95$\n$B_{2} = S_{\\mathrm{in}} - x_2^{\\star} = 10 - 0.1 = 9.9$\n输入矩阵 $B$ 是：\n$$\nB = \\begin{pmatrix} -4.95 \\\\ 9.9 \\end{pmatrix}\n$$\n\n**3) 线性近似的合理性证明**\n令 $x = x^{\\star} + \\delta x$。对于自治情况（$\\delta u = 0$），动力学为 $\\dot{x} = f(x)$。向量函数 $f$ 在 $x^{\\star}$ 附近展开的带积分余项的泰勒定理为：\n$$\nf(x^{\\star} + \\delta x) = f(x^{\\star}) + \\frac{\\partial f}{\\partial x}\\bigg|_{x^{\\star}}\\delta x + \\mathcal{R}(\\delta x)\n$$\n其中 $\\mathcal{R}(\\delta x) = \\int_0^1 (1-s) H_f(x^{\\star}+s\\delta x)(\\delta x, \\delta x) ds$，$H_f$ 是 $f$ 的二阶偏导数张量。由于 $\\dot{x} = \\delta \\dot{x}$ 且 $f(x^{\\star})=0$，我们有 $\\delta \\dot{x} = A \\delta x + \\mathcal{R}(\\delta x)$。\n线性近似 $\\delta \\dot{x} \\approx A \\delta x$ 的有效性取决于对于小的 $\\|\\delta x\\|_2$，余项 $\\mathcal{R}(\\delta x)$ 相对于线性项 $A \\delta x$ 是否可以忽略不计。\n如果 $f$ 的二阶偏导数在 $x^{\\star}$ 的一个邻域内有界，则余项的分量是二次有界的。我们通过计算它们来验证这一点：\n$\\frac{\\partial^2 f_1}{\\partial x_1^2} = 0$, $\\frac{\\partial^2 f_2}{\\partial x_1^2} = 0$\n$\\frac{\\partial^2 f_1}{\\partial x_1 \\partial x_2} = \\frac{d\\mu}{dx_2} = \\frac{\\mu_{\\max} K_S}{(K_S + x_2)^2}$\n$\\frac{\\partial^2 f_2}{\\partial x_1 \\partial x_2} = -\\frac{1}{Y}\\frac{d\\mu}{dx_2} = -\\frac{\\mu_{\\max} K_S}{Y(K_S + x_2)^2}$\n$\\frac{d^2\\mu}{dx_2^2} = \\frac{-2 \\mu_{\\max} K_S}{(K_S + x_2)^3}$\n$\\frac{\\partial^2 f_1}{\\partial x_2^2} = x_1 \\frac{d^2\\mu}{dx_2^2} = \\frac{-2 x_1 \\mu_{\\max} K_S}{(K_S + x_2)^3}$\n$\\frac{\\partial^2 f_2}{\\partial x_2^2} = -\\frac{1}{Y}x_1 \\frac{d^2\\mu}{dx_2^2} = \\frac{2 x_1 \\mu_{\\max} K_S}{Y(K_S + x_2)^3}$\n由于 $K_S > 0$，并且我们考虑的是正稳态的一个邻域，其中 $x_1 > 0$ 且 $x_2 > 0$，因此所有分母都不为零。这些二阶导数是关于 $x_1$ 和 $x_2$ 的连续有理函数。因此，在 $x^{\\star}$ 的任何紧（闭合且有界）邻域内，它们都是有界的。这种有界性保证了存在一个常数 $L > 0$，使得整个余项满足 $\\|\\mathcal{R}(\\delta x)\\|_2 \\le \\frac{1}{2} L \\|\\delta x\\|_2^2$。\n对于小的 $\\|\\delta x\\|_2$，线性近似是有效的，因为误差的阶数为 $O(\\|\\delta x\\|_2^2)$，相对于阶数为 $O(\\|\\delta x\\|_2)$ 的线性项而言可以忽略不计。具体来说，范数之比 $\\frac{\\|\\mathcal{R}(\\delta x)\\|_2}{\\|A \\delta x\\|_2} \\le \\frac{\\frac{1}{2} L \\|\\delta x\\|_2^2}{\\sigma_{\\min}(A)\\|\\delta x\\|_2} = \\frac{L}{2\\sigma_{\\min}(A)}\\|\\delta x\\|_2$，当 $\\|\\delta x\\|_2 \\to 0$ 时趋于 $0$（假设系统是非退化的，即 $\\sigma_{\\min}(A) > 0$）。这证实了线性化的局部有效性。\n\n**4) 谱半径 $\\rho(A)$ 的计算**\n谱半径是矩阵 $A$ 的特征值的最大绝对值。特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} 0-\\lambda & 7.425 \\\\ -0.6 & -15.15-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-15.15-\\lambda) - (7.425)(-0.6) = 0\n$$\n$$\n15.15\\lambda + \\lambda^2 + 4.455 = 0\n$$\n$$\n\\lambda^2 + 15.15\\lambda + 4.455 = 0\n$$\n我们求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-15.15 \\pm \\sqrt{15.15^2 - 4(1)(4.455)}}{2} = \\frac{-15.15 \\pm \\sqrt{229.5225 - 17.82}}{2}\n$$\n$$\n\\lambda = \\frac{-15.15 \\pm \\sqrt{211.7025}}{2} = \\frac{-15.15 \\pm 14.55}{2}\n$$\n两个特征值是：\n$$\n\\lambda_1 = \\frac{-15.15 + 14.55}{2} = \\frac{-0.6}{2} = -0.3\n$$\n$$\n\\lambda_2 = \\frac{-15.15 - 14.55}{2} = \\frac{-29.7}{2} = -14.85\n$$\n特征值为 $\\lambda_1 = -0.3$ h$^{-1}$ 和 $\\lambda_2 = -14.85$ h$^{-1}$。两者都是负实数，表明该稳态是一个稳定节点。\n谱半径 $\\rho(A)$ 是：\n$$\n\\rho(A) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|-0.3|, |-14.85|) = \\max(0.3, 14.85) = 14.85\n$$\n值 $14.85$ 已经按要求表示为四位有效数字。",
            "answer": "$$\\boxed{14.85}$$"
        },
        {
            "introduction": "在获得状态空间模型后，下一个关键步骤是分析其基本性质。本练习聚焦于控制理论中两个最重要的概念：能控性和能观性 。您将通过计算来判断一个合成基因回路的状态是否可以被输入完全操控（能控性），以及其内部状态是否可以从测量中完全推断（能观性），这为设计控制器之前提供了至关重要的洞见。",
            "id": "3326458",
            "problem": "一个合成基因表达模块在模型预测控制 (MPC) 下运行，以调节微生物底盘中的蛋白质丰度。该模块在工作点附近进行线性化，得到一个连续时间线性时不变 (LTI) 模型，该模型具有两个状态：信使核糖核酸 (mRNA) 浓度 $x_{1}$ 和蛋白质浓度 $x_{2}$。单个控制输入 $u$ 是影响转录的诱导剂水平，单个测量输出 $y$ 是蛋白质荧光。线性化后的动力学和测量由以下公式给出\n$$\n\\dot{x}_{1} = -\\gamma_{m} x_{1} + \\alpha u,\\quad \\dot{x}_{2} = k_{t} x_{1} - \\gamma_{p} x_{2},\\quad y = x_{2},\n$$\n参数值为 $\\gamma_{m} = 0.24\\,\\text{min}^{-1}$，$\\gamma_{p} = 0.06\\,\\text{min}^{-1}$，$k_{t} = 0.12\\,\\text{min}^{-1}$，以及 $\\alpha = 0.80\\,\\text{min}^{-1}$。\n\n为了提高检测稳定性，添加了一个报告基因，它与蛋白质成比例结合并有其自身的降解过程。这引入了第三个状态 $x_{3}$（报告基因浓度），其动力学和测量如下\n$$\n\\dot{x}_{3} = k_{r} x_{2} - \\gamma_{r} x_{3},\\quad y_{\\text{rep}} = x_{3},\n$$\n其中 $k_{r} = 0.50\\,\\text{min}^{-1}$ 且 $\\gamma_{r} = 0.02\\,\\text{min}^{-1}$。输入 $u$ 仍然是单个执行器，输出更改为单个报告基因荧光 $y_{\\text{rep}}$。\n\n从连续时间 LTI 系统的能控性和能观性的标准定义出发，计算：\n- 原始二状态系统的能控性矩阵和能观性矩阵，并确定它们的秩；\n- 增广的三状态报告基因系统的能观性矩阵，并确定其秩。\n\n判断在保持单个测量输出（现在是报告基因）的情况下，添加报告基因是否会相对于原始系统降低能观性。对于最终答案，将结果报告为行矩阵\n$$\\begin{pmatrix} r_{c}^{(2)} & r_{o}^{(2)} & r_{o}^{(3)} & d \\end{pmatrix},$$\n其中 $r_{c}^{(2)}$ 是二状态能控性矩阵的秩，$r_{o}^{(2)}$ 是二状态能观性矩阵的秩，$r_{o}^{(3)}$ 是带有报告基因输出的三状态能观性矩阵的秩，如果添加报告基因后能观性降低，则 $d$ 等于 $1$，否则为 $0$。将最终行矩阵的条目表示为无单位的整数。无需四舍五入。",
            "solution": "该问题要求分析源自合成基因表达模块的两个相关的线性时不变 (LTI) 系统的能控性和能观性。设连续时间 LTI 系统的一般形式为\n$$\n\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)\n$$\n$$\n\\mathbf{y}(t) = C\\mathbf{x}(t) + D\\mathbf{u}(t)\n$$\n其中 $\\mathbf{x}$ 是维度为 $n$ 的状态向量，$\\mathbf{u}$ 是输入向量，$\\mathbf{y}$ 是输出向量。对于本问题中的系统，前馈矩阵 $D$ 为零。\n\n系统对 $(A, B)$ 的能控性由能控性矩阵 $\\mathcal{C}$ 的秩决定。对于单输入系统，该矩阵由下式给出\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B & \\cdots & A^{n-1}B \\end{pmatrix}\n$$\n如果 $\\text{rank}(\\mathcal{C}) = n$，则系统完全能控。\n\n系统对 $(A, C)$ 的能观性由能观性矩阵 $\\mathcal{O}$ 的秩决定。对于单输出系统，该矩阵由下式给出\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix}\n$$\n如果 $\\text{rank}(\\mathcal{O}) = n$，则系统完全能观。\n\n首先，我们分析原始的二状态系统。状态向量为 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。动力学由 $\\dot{x}_{1} = -\\gamma_{m} x_{1} + \\alpha u$ 和 $\\dot{x}_{2} = k_{t} x_{1} - \\gamma_{p} x_{2}$ 给出，输出为 $y = x_2$。\n状态空间矩阵为：\n$$\nA^{(2)} = \\begin{pmatrix} -\\gamma_m & 0 \\\\ k_t & -\\gamma_p \\end{pmatrix}, \\quad B^{(2)} = \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}, \\quad C^{(2)} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}\n$$\n代入给定的参数值 $\\gamma_{m} = 0.24$，$\\gamma_{p} = 0.06$，$k_{t} = 0.12$，以及 $\\alpha = 0.80$：\n$$\nA^{(2)} = \\begin{pmatrix} -0.24 & 0 \\\\ 0.12 & -0.06 \\end{pmatrix}, \\quad B^{(2)} = \\begin{pmatrix} 0.80 \\\\ 0 \\end{pmatrix}, \\quad C^{(2)} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}\n$$\n该系统的维度为 $n=2$。\n\n为了确定能控性，我们计算能控性矩阵 $\\mathcal{C}^{(2)} = \\begin{pmatrix} B^{(2)} & A^{(2)}B^{(2)} \\end{pmatrix}$。\n首先，我们计算乘积 $A^{(2)}B^{(2)}$：\n$$\nA^{(2)}B^{(2)} = \\begin{pmatrix} -0.24 & 0 \\\\ 0.12 & -0.06 \\end{pmatrix} \\begin{pmatrix} 0.80 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-0.24)(0.80) \\\\ (0.12)(0.80) \\end{pmatrix} = \\begin{pmatrix} -0.192 \\\\ 0.096 \\end{pmatrix}\n$$\n能控性矩阵为：\n$$\n\\mathcal{C}^{(2)} = \\begin{pmatrix} 0.80 & -0.192 \\\\ 0 & 0.096 \\end{pmatrix}\n$$\n$\\mathcal{C}^{(2)}$ 的秩通过计算其行列式来求得：\n$$\n\\det(\\mathcal{C}^{(2)}) = (0.80)(0.096) - (-0.192)(0) = 0.0768\n$$\n由于 $\\det(\\mathcal{C}^{(2)}) \\neq 0$，该矩阵是满秩的。能控性矩阵的秩为 $r_c^{(2)} = 2$。该系统是完全能控的。\n\n接下来，为了确定能观性，我们计算能观性矩阵 $\\mathcal{O}^{(2)} = \\begin{pmatrix} C^{(2)} \\\\ C^{(2)}A^{(2)} \\end{pmatrix}$。\n首先，我们计算乘积 $C^{(2)}A^{(2)}$：\n$$\nC^{(2)}A^{(2)} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} -0.24 & 0 \\\\ 0.12 & -0.06 \\end{pmatrix} = \\begin{pmatrix} 0.12 & -0.06 \\end{pmatrix}\n$$\n能观性矩阵为：\n$$\n\\mathcal{O}^{(2)} = \\begin{pmatrix} 0 & 1 \\\\ 0.12 & -0.06 \\end{pmatrix}\n$$\n$\\mathcal{O}^{(2)}$ 的秩通过计算其行列式来求得：\n$$\n\\det(\\mathcal{O}^{(2)}) = (0)(-0.06) - (1)(0.12) = -0.12\n$$\n由于 $\\det(\\mathcal{O}^{(2)}) \\neq 0$，该矩阵是满秩的。能观性矩阵的秩为 $r_o^{(2)} = 2$。该系统是完全能观的。\n\n现在，我们分析带有报告基因的增广三状态系统。状态向量为 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。动力学扩展为 $\\dot{x}_{3} = k_{r} x_{2} - \\gamma_{r} x_{3}$，输出更改为 $y_{\\text{rep}} = x_3$。该系统的维度为 $n=3$。\n新的状态空间矩阵为：\n$$\nA^{(3)} = \\begin{pmatrix} -\\gamma_m & 0 & 0 \\\\ k_t & -\\gamma_p & 0 \\\\ 0 & k_r & -\\gamma_r \\end{pmatrix}, \\quad C^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}\n$$\n代入新的参数值 $k_r = 0.50$ 和 $\\gamma_r = 0.02$：\n$$\nA^{(3)} = \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix}, \\quad C^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}\n$$\n题目要求我们计算能观性矩阵 $\\mathcal{O}^{(3)} = \\begin{pmatrix} C^{(3)} \\\\ C^{(3)}A^{(3)} \\\\ C^{(3)}(A^{(3)})^2 \\end{pmatrix}$ 的秩。\n我们计算 $\\mathcal{O}^{(3)}$ 的各行：\n第一行是 $C^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}$。\n第二行是 $C^{(3)}A^{(3)}$：\n$$\nC^{(3)}A^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix} = \\begin{pmatrix} 0 & 0.50 & -0.02 \\end{pmatrix}\n$$\n第三行是 $C^{(3)}(A^{(3)})^2$。首先我们计算 $(A^{(3)})^2$：\n$$\n(A^{(3)})^2 = \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix} \\begin{pmatrix} -0.24 & 0 & 0 \\\\ 0.12 & -0.06 & 0 \\\\ 0 & 0.50 & -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.0576 & 0 & 0 \\\\ -0.036 & 0.0036 & 0 \\\\ 0.06 & -0.04 & 0.0004 \\end{pmatrix}\n$$\n然后，我们计算 $C^{(3)}(A^{(3)})^2$：\n$$\nC^{(3)}(A^{(3)})^2 = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.0576 & 0 & 0 \\\\ -0.036 & 0.0036 & 0 \\\\ 0.06 & -0.04 & 0.0004 \\end{pmatrix} = \\begin{pmatrix} 0.06 & -0.04 & 0.0004 \\end{pmatrix}\n$$\n三状态系统的能观性矩阵为：\n$$\n\\mathcal{O}^{(3)} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 0.50 & -0.02 \\\\ 0.06 & -0.04 & 0.0004 \\end{pmatrix}\n$$\n为了求其秩，我们计算行列式：\n$$\n\\det(\\mathcal{O}^{(3)}) = 0 \\cdot \\det\\begin{pmatrix} 0.50 & -0.02 \\\\ -0.04 & 0.0004 \\end{pmatrix} - 0 \\cdot \\det\\begin{pmatrix} 0 & -0.02 \\\\ 0.06 & 0.0004 \\end{pmatrix} + 1 \\cdot \\det\\begin{pmatrix} 0 & 0.50 \\\\ 0.06 & -0.04 \\end{pmatrix}\n$$\n$$\n\\det(\\mathcal{O}^{(3)}) = 1 \\cdot ((0)(-0.04) - (0.50)(0.06)) = -0.03\n$$\n由于 $\\det(\\mathcal{O}^{(3)}) \\neq 0$，该矩阵是满秩的。三状态系统的能观性矩阵的秩为 $r_o^{(3)} = 3$。\n\n最后，我们必须判断能观性是否降低。原始的二状态系统是完全能观的，因为 $r_o^{(2)} = 2$，等于其状态数。增广的三状态系统也是完全能观的，因为 $r_o^{(3)} = 3$，等于其状态数。由于在添加报告基因和改变测量后，系统仍然是完全能观的，因此能观性在“丢失”的意义上没有降低。因此，降低指示符 $d$ 为 $0$。\n\n所需的结果是：$r_c^{(2)} = 2$，$r_o^{(2)} = 2$，$r_o^{(3)} = 3$，以及 $d = 0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 2 & 3 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "模型预测控制的核心在于反复求解一个带约束的最优控制问题。这个高级练习将带您深入了解MPC优化器的“引擎盖之下” 。您需要将一个基因自抑制回路的控制问题构建为一个非线性规划，并应用强大的Karush-Kuhn-Tucker (KKT) 理论来推导其最优性条件，从而揭示MPC如何精确地权衡性能目标与系统约束来计算最优控制动作。",
            "id": "3326415",
            "problem": "考虑一个单基因负自动调节回路，其中归一化蛋白质浓度 $x(t)$ 通过一个希尔函数 (Hill function) 抑制其自身的产生。该蛋白质动力学被建模为常微分方程 (ODE)\n$$\n\\frac{dx(t)}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{x(t)}{K}\\right)^{n}} \\;-\\; \\beta\\,x(t) \\;+\\; u(t),\n$$\n其中 $\\alpha>0$ 是最大合成速率，$K>0$ 是解离常数，$n \\ge 1$ 是希尔系数，$\\beta>0$ 是有效一阶降解速率，而 $u(t)$ 是一个调节合成速率的外部驱动输入。所有变量都是无量纲的，时间以归一化单位表示。在一个模型预测控制 (Model Predictive Control, MPC) 的设定中，对于长度为 $N=1$、采样时间为 $h>0$ 的单步预测时域，我们使用前向欧拉法 (forward Euler scheme) 对 ODE 进行离散化，以获得一个适用于直接多重打靶法 (direct multiple shooting) 的离散时间模型。设决策变量为打靶节点状态 $z_0, z_1 \\in \\mathbb{R}$ 和输入 $u_0 \\in \\mathbb{R}$。测量的初始状态 $x_{\\mathrm{init}} \\in \\mathbb{R}$ 和参考值 $r \\in \\mathbb{R}$ 是给定的常数。阶段成本和终端成本是二次的，其正权重分别为 $Q>0$、$R>0$ 和 $P>0$。\n\n任务：\n1. 从 ODE 和前向欧拉离散化出发，写出单区间直接多重打靶法转录，包括：\n   - 连接 $z_0$、$u_0$ 和 $z_1$ 的离散动力学约束，以及\n   - 强制 $z_0 = x_{\\mathrm{init}}$ 的初始条件一致性约束，\n   以及成本函数\n   $$\n   J(z_0,u_0,z_1) \\;=\\; Q\\,(z_0 - r)^2 \\;+\\; R\\,u_0^2 \\;+\\; P\\,(z_1 - r)^2,\n   $$\n   并带有输入的箱式约束 $0 \\le u_0 \\le u_{\\max}$，其中 $u_{\\max}>0$。\n2. 通过为初始条件约束引入拉格朗日乘子 $\\mu \\in \\mathbb{R}$，为离散动力学约束引入 $\\lambda \\in \\mathbb{R}$，并为输入下界和上界分别引入非负乘子 $\\gamma_{\\ell} \\ge 0$ 和 $\\gamma_{u} \\ge 0$，为这个约束非线性规划构建拉格朗日函数。\n3. 以符号形式推导 Karush-Kuhn-Tucker (KKT) 条件，包括原始可行性、对偶可行性、平稳性和互补松弛性。\n4. 假设在最优点，输入是严格内部的，即 $0 < u_0^{\\star} < u_{\\max}$，因此不等式约束在最优解处是非激活的。使用 KKT 系统，消去乘子，以获得最优输入 $u_0^{\\star}$ 作为 $x_{\\mathrm{init}}$、$r$、$h$、$P$、$R$、$\\alpha$、$\\beta$、$K$ 和 $n$ 的函数的显式闭式表达式。你的最终答案必须是单个解析表达式。不要提供任何数值近似。",
            "solution": "解答过程遵循问题陈述中概述的四个任务。\n\n**任务 1：直接多重打靶法转录**\n首先，我们使用步长为 $h$ 的前向欧拉法对连续时间 ODE 进行离散化。时间 $t_{k+1}$ 的状态由时间 $t_k$ 的状态近似为 $x_{k+1} \\approx x_k + h \\cdot \\frac{dx}{dt}\\Big|_{t_k}$。\n在单步（$N=1$）直接多重打靶法框架中，我们有区间开始和结束时的状态决策变量 $z_0$ 和 $z_1$，以及该区间上的控制输入 $u_0$。\n\n离散时间动力学约束连接了这些变量：\n$$\nz_1 - z_0 - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{z_0}{K}\\right)^{n}} - \\beta z_0 + u_0 \\right) = 0\n$$\n初始条件一致性约束将第一个打靶节点状态 $z_0$ 与测量的初始状态 $x_{\\mathrm{init}}$ 联系起来：\n$$\nz_0 - x_{\\mathrm{init}} = 0\n$$\n要最小化的成本函数如下：\n$$\nJ(z_0,u_0,z_1) = Q\\,(z_0 - r)^2 + R\\,u_0^2 + P\\,(z_1 - r)^2\n$$\n输入的箱式约束写成两个不等式约束：\n$$\n-u_0 \\le 0 \\quad \\text{和} \\quad u_0 - u_{\\max} \\le 0\n$$\n这就完成了约束非线性规划的构建。\n\n**任务 2：拉格朗日函数构建**\n这个 NLP 的拉格朗日函数 $\\mathcal{L}$ 是通过将成本函数与每个约束乘以其对应的拉格朗日乘子后相加来构造的。\n$$\n\\begin{align*}\n\\mathcal{L}(z_0, u_0, z_1, \\mu, \\lambda, \\gamma_{\\ell}, \\gamma_{u}) =  Q\\,(z_0 - r)^2 + R\\,u_0^2 + P\\,(z_1 - r)^2 \\\\\n + \\mu(z_0 - x_{\\mathrm{init}}) \\\\\n + \\lambda \\left[ z_1 - z_0 - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{z_0}{K}\\right)^{n}} - \\beta z_0 + u_0 \\right) \\right] \\\\\n + \\gamma_{\\ell}(-u_0) + \\gamma_{u}(u_0 - u_{\\max})\n\\end{align*}\n$$\n这里，$\\mu$ 和 $\\lambda$ 是等式约束的乘子，$\\gamma_{\\ell}, \\gamma_{u}$ 是不等式约束的乘子，它们必须是非负的。\n\n**任务 3：Karush-Kuhn-Tucker (KKT) 条件**\nKKT 条件是最优性的必要条件。它们分为原始可行性、对偶可行性、互补松弛性和平稳性。设最优解表示为 $(z_0^{\\star}, u_0^{\\star}, z_1^{\\star})$。\n\n1.  **原始可行性：** 最优解必须满足所有约束。\n    -   $z_0^{\\star} - x_{\\mathrm{init}} = 0$\n    -   $z_1^{\\star} - z_0^{\\star} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{z_0^{\\star}}{K}\\right)^{n}} - \\beta z_0^{\\star} + u_0^{\\star} \\right) = 0$\n    -   $0 \\le u_0^{\\star} \\le u_{\\max}$\n\n2.  **对偶可行性：** 不等式约束的乘子必须是非负的。\n    -   $\\gamma_{\\ell} \\ge 0$\n    -   $\\gamma_{u} \\ge 0$\n\n3.  **互补松弛性：** 在最优点，不等式乘子与其对应约束值的乘积必须为零。\n    -   $\\gamma_{\\ell}(-u_0^{\\star}) = 0 \\implies \\gamma_{\\ell}u_0^{\\star} = 0$\n    -   $\\gamma_{u}(u_0^{\\star} - u_{\\max}) = 0$\n\n4.  **平稳性：** 拉格朗日函数相对于原始变量的梯度在最优点必须为零。\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial z_1} = 2P(z_1^{\\star} - r) + \\lambda = 0$\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial u_0} = 2Ru_0^{\\star} - \\lambda h - \\gamma_{\\ell} + \\gamma_{u} = 0$\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial z_0} = 2Q(z_0^{\\star} - r) + \\mu - \\lambda \\left[ 1 + h \\frac{\\partial}{\\partial z_0}\\left( \\frac{\\alpha}{1 + \\left(\\frac{z_0}{K}\\right)^{n}} - \\beta z_0 \\right) \\right]_{z_0=z_0^{\\star}} = 0$\n        我们来计算这个导数项：\n        $$\n        \\frac{\\partial}{\\partial z_0}\\left( \\frac{\\alpha}{1 + \\left(\\frac{z_0}{K}\\right)^{n}} - \\beta z_0 \\right) = -\\frac{\\alpha n z_0^{n-1}}{K^n \\left(1 + \\left(\\frac{z_0}{K}\\right)^n\\right)^2} - \\beta\n        $$\n        所以第三个平稳性条件是：\n        $$\n        2Q(z_0^{\\star} - r) + \\mu - \\lambda \\left[ 1 - h \\left( \\frac{\\alpha n (z_0^{\\star})^{n-1}}{K^n \\left(1 + \\left(\\frac{z_0^{\\star}}{K}\\right)^n\\right)^2} + \\beta \\right) \\right] = 0\n        $$\n\n**任务 4：最优输入 $u_0^{\\star}$ 的推导**\n我们给定的假设是最优输入 $u_0^{\\star}$ 严格在其边界内部，即 $0 < u_0^{\\star} < u_{\\max}$。\n\n根据互补松弛性条件：\n-   因为 $u_0^{\\star} > 0$，我们必须有 $\\gamma_{\\ell} = 0$。\n-   因为 $u_0^{\\star} < u_{\\max}$，我们有 $u_0^{\\star} - u_{\\max} < 0$，所以我们必须有 $\\gamma_{u} = 0$。\n\n当 $\\gamma_{\\ell}=0$ 且 $\\gamma_{u}=0$ 时，$u_0$ 的平稳性条件简化为：\n$$\n2Ru_0^{\\star} - \\lambda h = 0 \\implies u_0^{\\star} = \\frac{\\lambda h}{2R}\n$$\n从 $z_1$ 的平稳性条件，我们可以用 $z_1^{\\star}$ 表示 $\\lambda$：\n$$\n2P(z_1^{\\star} - r) + \\lambda = 0 \\implies \\lambda = -2P(z_1^{\\star} - r)\n$$\n将这个 $\\lambda$ 的表达式代入 $u_0^{\\star}$ 的方程中：\n$$\nu_0^{\\star} = \\frac{(-2P(z_1^{\\star} - r))h}{2R} = -\\frac{Ph(z_1^{\\star} - r)}{R} = \\frac{Ph(r - z_1^{\\star})}{R}\n$$\n现在我们使用原始可行性条件来消去 $z_1^{\\star}$。从初始条件约束可知，$z_0^{\\star} = x_{\\mathrm{init}}$。将其代入动力学约束中：\n$$\nz_1^{\\star} = x_{\\mathrm{init}} + h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} + u_0^{\\star} \\right)\n$$\n现在我们将这个 $z_1^{\\star}$ 的表达式代入我们关于 $u_0^{\\star}$ 的方程中：\n$$\nu_0^{\\star} = \\frac{Ph}{R} \\left( r - \\left[ x_{\\mathrm{init}} + h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} + u_0^{\\star} \\right) \\right] \\right)\n$$\n这个方程关于 $u_0^{\\star}$ 是线性的，可以求解。我们展开并合并包含 $u_0^{\\star}$ 的项：\n$$\nu_0^{\\star} = \\frac{Ph}{R} \\left( r - x_{\\mathrm{init}} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} \\right) \\right) - \\frac{Ph^2}{R} u_0^{\\star}\n$$\n$$\nu_0^{\\star} + \\frac{Ph^2}{R} u_0^{\\star} = \\frac{Ph}{R} \\left( r - x_{\\mathrm{init}} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} \\right) \\right)\n$$\n$$\nu_0^{\\star} \\left( 1 + \\frac{Ph^2}{R} \\right) = \\frac{Ph}{R} \\left( r - x_{\\mathrm{init}} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} \\right) \\right)\n$$\n$$\nu_0^{\\star} \\left( \\frac{R + Ph^2}{R} \\right) = \\frac{Ph}{R} \\left( r - x_{\\mathrm{init}} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} \\right) \\right)\n$$\n最后，通过两边乘以 $\\frac{R}{R+Ph^2}$ 来解出 $u_0^{\\star}$，得到显式闭式表达式：\n$$\nu_0^{\\star} = \\frac{Ph}{R+Ph^2} \\left( r - x_{\\mathrm{init}} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} \\right) \\right)\n$$\n该表达式仅依赖于给定的参数和初始状态，符合要求。关于 $z_0$ 的平稳性条件和乘子 $\\mu$ 在此推导中并非必需，因为变量 $z_0$ 已被硬约束固定为 $x_{\\mathrm{init}}$。",
            "answer": "$$\n\\boxed{\n\\frac{Ph}{R + Ph^2} \\left( r - x_{\\mathrm{init}} - h \\left( \\frac{\\alpha}{1 + \\left(\\frac{x_{\\mathrm{init}}}{K}\\right)^{n}} - \\beta x_{\\mathrm{init}} \\right) \\right)\n}\n$$"
        }
    ]
}