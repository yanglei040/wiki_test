{
    "hands_on_practices": [
        {
            "introduction": "要理解基因开关的核心功能，首先需要分析其在确定性框架下的基本动态行为。这个练习将引导你通过数值方法，探索一个理想化的基因双稳态开关如何响应外部控制参数，从而揭示其标志性的双稳态和迟滞现象。掌握这种分岔分析是理解和设计合成生物回路的一项基本技能 。",
            "id": "3328029",
            "problem": "考虑一个双基因互抑制拨动开关的确定性模型，其中每个基因产物通过协同结合机制抑制另一个基因的转录。从基于分子生物学中心法则（DNA到RNA到蛋白质）和标准化学动力学（用于合成和降解）的最小基因调控框架开始：基因产物浓度的时间演化由合成减去降解给出，转录抑制由一个递减的希尔函数表示，该函数源于具有 $n$ 个协同抑制子结合位点的启动子的平衡占有率。具体来说，推导两种基因产物浓度 $x$ 和 $y$ 的耦合常微分方程组，从科学角度证明选择希尔抑制函数的合理性，并定义一个控制参数 $u$，它以相反的方向偏置两个合成速率，同时保持所有速率为非负。使用这些方程计算稳态，通过雅可比矩阵评估其线性稳定性，并通过扫描控制参数 $u$ 构建分岔图。将滞后宽度量化为界定双稳态区域（由一个不稳定的稳态隔开的两个不同线性稳定稳态）的高控制参数值和低控制参数值之差。\n\n设 $x$ 和 $y$ 表示浓度，合成速率由一个使系统倾斜的控制参数 $u$ 调节：设 $\\alpha_{1}(u) = \\alpha\\,(1+u)$ 和 $\\alpha_{2}(u) = \\alpha\\,(1-u)$，其中 $u \\in [-u_{\\max}, u_{\\max}]$ 且对于所有允许的 $u$，都有 $0 \\le \\alpha_{i}(u)$。设降解是线性的，速率常数为 $\\delta > 0$。设抑制具有希尔形式的依赖关系，半饱和常数为 $K > 0$，希尔系数为 $n \\ge 1$。任务是实现以下系统\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}} - \\delta\\,x,\\qquad\n\\frac{dy}{dt} = \\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}} - \\delta\\,y,\n$$\n并对其进行严格分析。对于每个固定的 $u$，计算求解以下方程组的所有非负稳态 $(x^{\\ast}, y^{\\ast})$：\n$$\n0 = \\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}} - \\delta\\,x,\\qquad\n0 = \\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}} - \\delta\\,y.\n$$\n通过评估雅可比矩阵来确定线性稳定性\n$$\nJ(x,y;u) =\n\\begin{pmatrix}\n-\\delta & \\frac{\\partial}{\\partial y}\\left[\\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right] \\\\\n\\frac{\\partial}{\\partial x}\\left[\\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}}\\right] & -\\delta\n\\end{pmatrix},\n$$\n并确定 $J$ 在稳态下的特征值；当且仅当 $J$ 的所有特征值都具有严格为负的实部时，稳态是线性稳定的。通过在均匀网格上扫描 $u \\in [-u_{\\max}, u_{\\max}]$ 来构建分岔图，并为每个 $u$ 计算不同线性稳定稳态的数量。将滞后宽度 $W$ 定义为 $W = u_{\\text{high}} - u_{\\text{low}}$，其中 $u_{\\text{low}}$ 是系统表现出两个线性稳定稳态的最小 $u$ 值，而 $u_{\\text{high}}$ 是系统表现出两个线性稳定稳态的最大 $u$ 值。如果在扫描中的任何 $u$ 值下都不存在双稳态，则报告 $W = 0$ 并设置 $u_{\\text{low}} = 0$ 和 $u_{\\text{high}} = 0$。\n\n使用以下参数值测试套件，以确保覆盖不同机制：\n- 情况 1（强协同性，预期双稳态）：$\\alpha = 12$，$\\delta = 1$， $K = 1$， $n = 3$，$u_{\\max} = 0.9$。\n- 情况 2（无协同性，预期单稳态）：$\\alpha = 4$，$\\delta = 1$，$K = 1$，$n = 1$，$u_{\\max} = 0.9$。\n- 情况 3（中等协同性，接近边界）：$\\alpha = 8$，$\\delta = 1$，$K = 1$，$n = 2$，$u_{\\max} = 0.9$。\n\n对于每种情况，使用至少 $M = 161$ 个点的网格在区间 $[-u_{\\max}, u_{\\max}]$ 上均匀扫描 $u$。对于每个 $u$，计算所有不同的非负稳态，并根据线性稳定性对其进行分类。然后，为每种情况计算并返回一个包含四个值的列表：$[W, u_{\\text{low}}, u_{\\text{high}}, B]$，其中 $W$ 是滞后宽度（实数），$u_{\\text{low}}$ 和 $u_{\\text{high}}$ 是发现两个线性稳定稳态的最低和最高 $u$ 值（实数），$B$ 是一个布尔值，指示在扫描中是否发现双稳态。如果没有出现双稳态，则返回 $[0.0, 0.0, 0.0, \\text{False}]$。\n\n您的程序应生成单行输出，其中包含三个测试用例的结果，格式为逗号分隔的列表，用方括号括起来，并按情况 1、情况 2、情况 3 的顺序排列。例如，输出应如下所示：$[[W_{1},u_{\\text{low},1},u_{\\text{high},1},B_{1}],[W_{2},u_{\\text{low},2},u_{\\text{high},2},B_{2}],[W_{3},u_{\\text{low},3},u_{\\text{high},3},B_{3}]]$。不涉及物理单位；所有量均为无量纲实数。",
            "solution": "该问题提出了一个基因拨动开关的确定性模型，这是一个基础的合成生物学电路。任务是分析其动力学，特别是其稳态及其稳定性，作为控制参数 $u$ 的函数。分析首先论证了模型形式的合理性，然后介绍了确定双稳态区域和相关滞后宽度的计算过程。\n\n**1. 希尔抑制函数的科学论证**\n\n该模型采用希尔函数来描述转录抑制。这种函数形式不是任意的，而是源于转录因子与DNA结合的物理化学过程。考虑开关中的一个基因，例如产生蛋白质 $X$ 的基因，它被蛋白质 $Y$ 抑制。$X$ 的合成速率与其未被抑制蛋白 $Y$ 结合的启动子部分成正比。\n\n设 $P$ 为 $X$ 基因的启动子区域，设 $R$ 为抑制蛋白 $Y$。$n$ 个抑制子分子与启动子的结合通过一个协同反应发生：\n$$\nP + nR \\rightleftharpoons PR_n\n$$\n其中 $PR_n$ 是无活性的启动子-抑制子复合物。在化学平衡状态下，质量作用定律给出解离常数 $K_d$ 为：\n$$\nK_d = \\frac{[P][R]^n}{[PR_n]}\n$$\n这里，$[P]$ 是游离启动子的浓度，$[R]$ 是抑制子（在问题中用 $y$ 表示）的浓度，$[PR_n]$ 是结合复合物的浓度。启动子的总浓度 $[P]_{\\text{total}}$ 是游离启动子和结合启动子之和：$[P]_{\\text{total}} = [P] + [PR_n]$。\n\n假设转录速率与游离（活性）启动子的比例成正比，我们将其表示为 $\\theta_{\\text{active}}$：\n$$\n\\theta_{\\text{active}} = \\frac{[P]}{[P]_{\\text{total}}} = \\frac{[P]}{[P] + [PR_n]}\n$$\n通过重新排列平衡方程，我们得到 $[PR_n] = \\frac{[P][R]^n}{K_d}$。将其代入 $\\theta_{\\text{active}}$ 的表达式中，得到：\n$$\n\\theta_{\\text{active}} = \\frac{[P]}{[P] + \\frac{[P][R]^n}{K_d}} = \\frac{1}{1 + \\frac{[R]^n}{K_d}}\n$$\n通过定义一个常数 $K = K_d^{1/n}$，称为半饱和常数或希尔常数，该表达式呈现为经典的希尔形式：\n$$\n\\theta_{\\text{active}} = \\frac{1}{1 + \\left(\\frac{[R]}{K}\\right)^n}\n$$\n蛋白质 $X$ 的合成速率是最大合成速率 $\\alpha_1(u)$ 乘以这个活性启动子的比例。这为第一个微分方程中的合成项提供了依据。类似的论证也适用于蛋白质 $X$ 对基因 $Y$ 的抑制。整数 $n$ 是希尔系数，表示抑制子结合的协同程度。$n>1$ 的值表示协同结合，导致更陡峭的、类似开关的响应。\n\n**2. 稳态分析**\n\n系统的稳态 $(x^{\\ast}, y^{\\ast})$ 是时间导数为零的耦合代数方程的非负解：\n$$\n\\frac{dx}{dt} = 0 \\implies \\delta x^{\\ast} = \\frac{\\alpha_1(u)}{1 + (y^{\\ast}/K)^n}\n$$\n$$\n\\frac{dy}{dt} = 0 \\implies \\delta y^{\\ast} = \\frac{\\alpha_2(u)}{1 + (x^{\\ast}/K)^n}\n$$\n这些方程定义了系统的零斜线。稳态是这两条零斜线在 $x,y$ 平面上的交点。为了找到这些点，我们可以从一个方程中用另一个变量表示一个变量，然后将其代入第二个方程。从第二个方程中，我们求解 $y^{\\ast}$：\n$$\ny^{\\ast} = \\frac{\\alpha_2(u)/\\delta}{1 + (x^{\\ast}/K)^n}\n$$\n将此代入第一个方程，得到一个关于 $x^{\\ast}$ 的单一方程：\n$$\nx^{\\ast} = \\frac{\\alpha_1(u)/\\delta}{1 + \\left( \\frac{1}{K} \\left( \\frac{\\alpha_2(u)/\\delta}{1 + (x^{\\ast}/K)^n} \\right) \\right)^n}\n$$\n这是一个关于 $x^{\\ast}$ 的高度非线性方程。对于给定的参数集 $(u, \\alpha, \\delta, K, n)$，该方程的根对应于稳态的 $x$ 坐标。由于右侧作为 $x^{\\ast}$ 的函数具有S型特性，可能存在一个或三个正解，分别对应单稳态或双稳态。这些根通过数值方法找到。\n\n**3. 线性稳定性分析**\n\n为了确定每个稳态 $(x^{\\ast}, y^{\\ast})$ 的稳定性，我们通过在该状态下评估雅可比矩阵 $J$ 来线性化系统：\n$$\nJ(x^{\\ast}, y^{\\ast}) =\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x}(\\dot{x}) & \\frac{\\partial}{\\partial y}(\\dot{x}) \\\\\n\\frac{\\partial}{\\partial x}(\\dot{y}) & \\frac{\\partial}{\\partial y}(\\dot{y})\n\\end{pmatrix}_{(x^{\\ast}, y^{\\ast})}\n=\n\\begin{pmatrix}\n-\\delta & J_{12} \\\\\nJ_{21} & -\\delta\n\\end{pmatrix}\n$$\n非对角元素为：\n$$\nJ_{12} = \\frac{\\partial}{\\partial y}\\left[\\frac{\\alpha_{1}(u)}{1 + (y/K)^n}\\right]\\bigg|_{y=y^{\\ast}} = -\\frac{n \\alpha_{1}(u) (y^{\\ast})^{n-1}}{K^n (1 + (y^{\\ast}/K)^n)^2}\n$$\n$$\nJ_{21} = \\frac{\\partial}{\\partial x}\\left[\\frac{\\alpha_{2}(u)}{1 + (x/K)^n}\\right]\\bigg|_{x=x^{\\ast}} = -\\frac{n \\alpha_{2}(u) (x^{\\ast})^{n-1}}{K^n (1 + (x^{\\ast}/K)^n)^2}\n$$\n雅可比矩阵的特征值 $\\lambda$ 由特征方程 $\\det(J - \\lambda I) = 0$ 给出，该方程简化为 $(-\\delta - \\lambda)^2 - J_{12}J_{21} = 0$。解为 $\\lambda = -\\delta \\pm \\sqrt{J_{12}J_{21}}$。由于 $\\alpha_i(u) \\ge 0$, $n \\ge 1$ 且 $K > 0$，所以 $J_{12}$ 和 $J_{21}$ 都是非正的，使得它们的乘积 $J_{12}J_{21}$ 是非负的。因此，特征值总是实数。当且仅当所有特征值都具有严格为负的实部时，稳态是线性稳定的。特征值 $\\lambda_2 = -\\delta - \\sqrt{J_{12}J_{21}}$ 总是负的，因为 $\\delta > 0$。因此，稳定性由 $\\lambda_1 = -\\delta + \\sqrt{J_{12}J_{21}}$ 的符号决定。为了保证稳定性，我们需要 $\\lambda_1 < 0$，这意味着 $\\sqrt{J_{12}J_{21}} < \\delta$，或 $J_{12}J_{21} < \\delta^2$。\n\n这个条件可以被简化。使用稳态方程，雅可比矩阵的元素可以重写为：\n$$\nJ_{12} = -n \\frac{\\delta x^{\\ast}}{y^{\\ast}} \\frac{(y^{\\ast}/K)^n}{1+(y^{\\ast}/K)^n} \\quad \\text{和} \\quad J_{21} = -n \\frac{\\delta y^{\\ast}}{x^{\\ast}} \\frac{(x^{\\ast}/K)^n}{1+(x^{\\ast}/K)^n}\n$$\n它们的乘积是 $J_{12}J_{21} = n^2 \\delta^2 A_x A_y$，其中 $A_x = \\frac{(x^{\\ast}/K)^n}{1+(x^{\\ast}/K)^n}$ 且 $A_y = \\frac{(y^{\\ast}/K)^n}{1+(y^{\\ast}/K)^n}$。稳定性判据变为 $n^2 \\delta^2 A_x A_y < \\delta^2$，简化为：\n$$\nn^2 A_x A_y < 1\n$$\n这个简洁的条件，关联了希尔系数和抑制子的饱和水平，用于对每个稳态进行分类。\n\n**4. 滞后分析的数值算法**\n\n最终任务是为给定的参数集计算滞后宽度 $W$。这通过以下数值过程实现：\n1.  将控制参数范围 $[-u_{\\max}, u_{\\max}]$ 离散化为一个包含 $M \\ge 161$ 个点的均匀网格，记为 $\\{u_i\\}$。\n2.  对于网格中的每个值 $u_i$：\n    a.  数值求解稳态方程 $x - F(x; u_i) = 0$ 的所有非负根 $x^{\\ast}$，其中 $F(x; u_i) = \\frac{\\alpha_1(u_i)/\\delta}{1 + \\left( \\frac{\\alpha_2(u_i)/(\\delta K)}{1 + (x/K)^n} \\right)^n}$。这通过扫描一个精细的 $x$ 值网格以寻找 $x - F(x; u_i)$ 的符号变化来框定根的范围，然后对每个框定的区间使用像 Brent-Dekker 方法这样的精确求根算法来完成。\n    b.  对于每个根 $x^{\\ast}$，计算相应的 $y^{\\ast} = \\frac{\\alpha_2(u_i)/\\delta}{1+(x^{\\ast}/K)^n}$。\n    c.  使用条件 $n^2 A_x A_y < 1$ 评估每个稳态 $(x^{\\ast}, y^{\\ast})$ 的稳定性。\n    d.  计算不同线性稳定稳态的数量。\n3.  识别所有找到恰好两个稳定稳态的 $u_i$ 值集合。\n4.  如果此集合为空，则在扫描范围内不存在双稳态。报告 $W=0.0$，$u_{\\text{low}}=0.0$，$u_{\\text{high}}=0.0$，以及一个表示双稳态的布尔标志为 False。\n5.  如果集合非空，则确定 $u_{\\text{low}}$ 为集合中的最小值，$u_{\\text{high}}$ 为最大值。滞后宽度则为 $W = u_{\\text{high}} - u_{\\text{low}}$。报告 $[W, u_{\\text{low}}, u_{\\text{high}}, \\text{True}]$。\n该算法稳健地确定了双稳态区域并按要求量化了滞后宽度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef compute_hysteresis(alpha, delta, K, n, u_max):\n    \"\"\"\n    Computes the hysteresis width for the genetic toggle switch model.\n\n    Args:\n        alpha (float): Basal synthesis rate parameter.\n        delta (float): Degradation rate constant.\n        K (float): Half-saturation constant (Hill constant).\n        n (float): Hill coefficient.\n        u_max (float): Maximum value of the control parameter u.\n\n    Returns:\n        list: A list containing [W, u_low, u_high, B], where W is the\n              hysteresis width, u_low and u_high are the boundaries of the\n              bistable region, and B is a boolean indicating if bistability\n              was found.\n    \"\"\"\n    \n    # Define the steady state function whose roots we need to find.\n    # We solve x - F(x) = 0.\n    def F(x, u, alpha, delta, K, n):\n        alpha1_u = alpha * (1 + u)\n        alpha2_u = alpha * (1 - u)\n        \n        # Avoid invalid operations if x is negative.\n        # The search domain for x is non-negative, but this is a safeguard.\n        if x  0:\n            x = 0\n\n        y_val_term = (alpha2_u / delta) / (1 + (x / K)**n)\n        return (alpha1_u / delta) / (1 + (y_val_term / K)**n)\n\n    M = 161\n    u_grid = np.linspace(-u_max, u_max, M)\n    bistable_u_points = []\n\n    # Define a safe upper bound for the root search range of x.\n    # The max possible value of x is alpha * (1 + u_max) / delta. Add a margin.\n    x_search_max = alpha * (1 + u_max) / delta + 5.0\n    x_search_grid_size = 10000\n    x_grid = np.linspace(0, x_search_max, x_search_grid_size)\n\n    for u in u_grid:\n        \n        # Function for root finding: g(x) = x - F(x) = 0\n        g = lambda x: x - F(x, u, alpha, delta, K, n)\n        \n        roots = set()\n        \n        # Scan for sign changes to bracket roots\n        g_vals = g(x_grid)\n        for i in range(len(x_grid) - 1):\n            if np.sign(g_vals[i]) != np.sign(g_vals[i+1]):\n                try:\n                    root = brentq(g, x_grid[i], x_grid[i+1])\n                    # Add root rounded to a certain precision to avoid duplicates\n                    roots.add(round(root, 8)) \n                except (RuntimeError, ValueError):\n                    # brentq can fail if the signs are not different at endpoints,\n                    # which can happen with floating point inaccuracies.\n                    pass\n        \n        n_stable_states = 0\n        for x_star in roots:\n            if x_star  0: continue\n            \n            alpha2_u = alpha * (1 - u)\n            y_star = (alpha2_u / delta) / (1 + (x_star / K)**n)\n            \n            if y_star  0: continue\n\n            # Stability condition: n^2 * Ax * Ay  1\n            # Handle potential division by zero if K=0 (not in test cases) or x_star/y_star= -1 (not possible)\n            Ax_num = (x_star / K)**n\n            Ax = Ax_num / (1 + Ax_num)\n\n            Ay_num = (y_star / K)**n\n            Ay = Ay_num / (1 + Ay_num)\n            \n            if (n**2) * Ax * Ay  1:\n                n_stable_states += 1\n        \n        if n_stable_states == 2:\n            bistable_u_points.append(u)\n\n    if not bistable_u_points:\n        return [0.0, 0.0, 0.0, False]\n    else:\n        u_low = min(bistable_u_points)\n        u_high = max(bistable_u_points)\n        W = u_high - u_low\n        return [W, u_low, u_high, True]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (strong cooperativity, expected bistability)\n        (12.0, 1.0, 1.0, 3.0, 0.9),\n        # Case 2 (no cooperativity, expected monostability)\n        (4.0, 1.0, 1.0, 1.0, 0.9),\n        # Case 3 (moderate cooperativity, near boundary)\n        (8.0, 1.0, 1.0, 2.0, 0.9)\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = compute_hysteresis(*case_params)\n        results.append(result)\n\n    # Format output to be a single-line list of lists with no spaces\n    # e.g., [[W1,ulow1,uhigh1,B1],[W2,ulow2,uhigh2,B2],...]\n    result_strings = []\n    for res in results:\n        # Format boolean as required (True/False)\n        bool_str = str(res[3])\n        # Manually construct string for each inner list to control spacing\n        res_str = f\"[{res[0]},{res[1]},{res[2]},{bool_str}]\"\n        result_strings.append(res_str)\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在确认系统存在两个稳定状态（双稳态）后，一个自然而然的问题是：从任意初始状态出发，系统最终会进入哪个稳定状态？这个练习将带你从全局视角审视开关的动态，通过数值计算来描绘两个稳定状态的“吸引盆”。这项实践不仅将单调系统理论与量化电路鲁棒性的实用计算方法联系起来，还加深了对系统全局稳定性的理解 。",
            "id": "3328034",
            "problem": "您需要对一个对称的基因触发开关进行建模，其中两种阻遏蛋白相互抑制对方的表达。该动力学系统由两个基于希尔阻遏形式（用于转录调控）和线性一阶降解的常微分方程以无量纲形式表示。模型状态是蛋白质浓度对 $\\left(x(t), y(t)\\right)$，其中对于所有 $t \\ge 0$，有 $x(t) \\ge 0$ 和 $y(t) \\ge 0$。参数 $n$ 是希尔系数（协同性），$K$ 是阻遏阈值，而 $\\alpha$ 是最大无量纲生产速率（两个基因相同）。状态演化由以下公式给出：\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^{n}} \\;-\\; x, \n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^{n}} \\;-\\; y.\n$$\n右侧的生物学合理解释使用了两个经过充分检验的事实：转录阻遏可以用指数为 $n$、半效应浓度为 $K$ 的希尔函数来建模；而蛋白质降解/稀释在无量纲化后，通常可以很好地用一阶线性过程来近似。\n\n您的任务是计算双稳态基因触发开关中通常存在的两个不对称稳态（“$x$-高，$y$-低”和“$y$-高，$x$-低”）的吸引盆，量化目标状态的全局鲁棒性指标，并研究该指标如何随 $(n, K)$ 变化。设计和论证必须使用以下原则：\n- 从上述动力学模型和竞争系统的单调系统观点出发，论证不存在周期性或混沌吸引子；等价地，通过诉诸保序性质及由此产生的 $\\omega$-极限集的结构，证明几乎所有轨迹都收敛到平衡点。您可以使用一个类李雅普诺夫替代事实：对于此类系统，在有界性和紧的正不变集上具有内指向量场的条件下，$\\omega$-极限集由平衡点构成。\n- 以此证明，通过长时间积分对初始条件进行数值分类是近似吸引盆体积的有效方法，因为轨迹会收敛到平衡点，不会表现出持续振荡。\n\n为了定义一个可计算的无量纲全局鲁棒性指标，设目标为“$x$-高”吸引子。对于给定的参数对 $(n, K)$，将鲁棒性 $R(n, K)$ 定义为在一个紧凑域 $\\mathcal{D}$ 中，收敛到“$x$-高”吸引子的初始条件 $(x(0), y(0))$ 所占的比例（均匀网格上的面积度量）。由于系统是对称的且 $\\alpha$ 是固定的，选择方形域 $\\mathcal{D} = [0,\\alpha] \\times [0,\\alpha]$，该域包含了上述指定模型的所有平衡点。设 $\\alpha$ 固定为 $\\alpha = 10$。\n\n按如下方式数值近似 $R(n, K)$：\n- 在 $\\mathcal{D}$ 上使用一个 $M \\times M$ 的均匀网格初始条件，其中 $M = 25$。\n- 对每个初始条件，将系统从 $t = 0$ 积分到 $t = T_{\\max}$，其中 $T_{\\max} = 100$。数值积分使用相对容差 $\\mathrm{rtol} = 10^{-8}$ 和绝对容差 $\\mathrm{atol} = 10^{-10}$。\n- 如果一条轨迹在 $t = T_{\\max}$ 时的终端状态满足 $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$，则将其分类为收敛到“$x$-高”吸引子；如果满足 $y(T_{\\max}) - x(T_{\\max}) \\ge \\varepsilon$，则分类为收敛到“$y$-高”吸引子，其中 $\\varepsilon = 10^{-3}$。满足 $|x(T_{\\max}) - y(T_{\\max})|  \\varepsilon$ 的轨迹被认为收敛到对称平衡点，对 $R(n, K)$ 没有贡献。\n- $R(n, K)$ 的近似值即为被分类为“$x$-高”的初始条件数量除以 $M^2$。\n\n测试套件和要求的输出：\n- 固定 $\\alpha = 10$ 和 $M = 25$，$T_{\\max} = 100$，$\\varepsilon = 10^{-3}$，$\\mathrm{rtol} = 10^{-8}$，$\\mathrm{atol} = 10^{-10}$。\n- 计算以下 $(n, K)$ 测试用例的 $R(n, K)$：\n  1. $(n, K) = (1.0, 1.0)$，低协同性情况，预期为单稳态。\n  2. $(n, K) = (2.0, 10.0)$，弱阻遏（大 $K$），预期为单稳态。\n  3. $(n, K) = (3.5, 1.0)$，中等协同性与中等阈值，通常为双稳态。\n  4. $(n, K) = (4.0, 0.2)$，强协同性与低阈值，通常为双稳态。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序与上面相同，每个条目是小数形式的 $R(n, K)$，保留小数点后四位。例如，一个语法上有效的输出形式为 $[0.0000,0.0000,0.5000,0.5000]$（这只是一个例子，不一定是正确的值）。\n\n本问题陈述中所有数学符号和数字均以 LaTeX 符号表示。不涉及物理单位；所有量均为无量纲。不使用角度。百分比必须按规定以小数形式给出。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- **动力学系统模型**：一个对称的基因触发开关由以下关于蛋白质浓度 $x(t)$ 和 $y(t)$ 的常微分方程（ODE）描述：\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^{n}} \\;-\\; x\n$$\n$$\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^{n}} \\;-\\; y\n$$\n- **参数和状态变量**：\n  - $x(t), y(t)$：无量纲蛋白质浓度，满足 $x(t) \\ge 0$, $y(t) \\ge 0$。\n  - $n$：希尔系数（协同性）。\n  - $K$：阻遏阈值浓度。\n  - $\\alpha$：最大无量纲生产速率。\n- **模拟用的固定参数**：\n  - $\\alpha = 10$。\n  - 初始条件域：$\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha] = [0, 10] \\times [0, 10]$。\n  - 初始条件网格大小：$M \\times M$，其中 $M = 25$。\n  - 最大积分时间：$T_{\\max} = 100$。\n  - 积分容差：相对容差 $\\mathrm{rtol} = 10^{-8}$，绝对容差 $\\mathrm{atol} = 10^{-10}$。\n  - 分类阈值：$\\varepsilon = 10^{-3}$。\n- **任务定义**：计算一个全局鲁棒性指标 $R(n, K)$，定义为在域 $\\mathcal{D}$ 中收敛到“$x$-高”吸引子的初始条件所占的比例。收敛性在 $t=T_{\\max}$ 时确定。\n- **分类规则**：如果一个初始条件的轨迹终点 $(x(T_{\\max}), y(T_{\\max}))$ 满足 $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$，则该初始条件被分类为收敛到“$x$-高”吸引子。\n- **测试套件**：为以下参数对计算 $R(n, K)$：\n    1. $(n, K) = (1.0, 1.0)$\n    2. $(n, K) = (2.0, 10.0)$\n    3. $(n, K) = (3.5, 1.0)$\n    4. $(n, K) = (4.0, 0.2)$\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题具有科学合理性。该模型是基因触发开关的标准表示，基于已确立的生物化学动力学原理（希尔阻遏和一阶降解）。所引用的理论框架——竞争系统的单调系统理论——是分析此类模型定性动力学的正确且标准的方法。\n- **适定性**：该问题是适定的。常微分方程、参数、初始条件域和计算过程都得到了精确无误的规定。这确保了可以获得一个唯一的、有意义的数值结果。\n- **客观性**：该问题使用客观、形式化的数学语言陈述，不含主观或推测性内容。\n- **完整性和一致性**：该问题是自洽的。所有必要的值（$\\alpha$, $M$, $T_{\\max}$，容差，测试用例）都已提供。设置是内部一致的；例如，选择域 $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$ 是合理的，因为它是动力学的一个正不变集，确保了解保持有界。\n\n### 第3步：结论与行动\n问题陈述被判定为**有效**。它具有科学依据，是适定的，并且内部一致。可以继续进行求解过程。\n\n### 基于原理的解决方案\n任务是通过数值近似吸引盆的面积来计算基因触发开关模型的鲁棒性指标 $R(n, K)$。这种数值方法的有效性依赖于底层动力学系统的理论性质。\n\n**理论基础**\n\n系统由以下方程给出：\n$$\n\\frac{dx}{dt} = f_1(x, y) = \\frac{\\alpha}{1 + (y/K)^n} - x\n$$\n$$\n\\frac{dy}{dt} = f_2(x, y) = \\frac{\\alpha}{1 + (x/K)^n} - y\n$$\n该系统是一个**竞争动力学系统**。这可以通过检查向量场的雅可比矩阵 $J(x, y)$ 来正式确定：\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x}  \\frac{\\partial f_1}{\\partial y} \\\\ \\frac{\\partial f_2}{\\partial x}  \\frac{\\partial f_2}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\alpha n y^{n-1}}{K^n(1 + (y/K)^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{K^n(1 + (x/K)^n)^2}  -1 \\end{pmatrix}\n$$\n由于 $x, y \\ge 0$ 且所有参数均为正，对于域中所有的 $(x, y)$，非对角元素 $\\frac{\\partial f_1}{\\partial y}$ 和 $\\frac{\\partial f_2}{\\partial x}$ 均为非正。根据定义，一个雅可比矩阵具有非正非对角项的系统是竞争系统。\n\n对于此类系统，强大的理论结果限制了可能的长期行为。域 $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$ 是流的一个紧的正不变集。这是因为在其边界上，向量场指向内部或与边界相切。例如，如果 $x=0$，则 $\\frac{dx}{dt} = \\frac{\\alpha}{1+(y/K)^n}  0$。如果 $x=\\alpha$，则 $\\frac{dx}{dt} = \\frac{\\alpha}{1+(y/K)^n} - \\alpha \\le 0$。类似的逻辑也适用于边界 $y=0$ 和 $y=\\alpha$。\n\n根据单调动力学系统理论（特别是 M.W. Hirsch 的结果），对于一个在紧、凸、正不变集上的竞争系统，任何轨迹的 $\\omega$-极限集（累积点集）是简单的。它不能包含稳定的周期轨道或混沌吸引子。对于几乎所有的初始条件，轨迹都会收敛到一个稳定的平衡点（系统的稳态）。\n\n这一理论保证至关重要：它验证了所提出的数值方法的有效性。通过将常微分方程积分足够长的时间 $T_{\\max}$，我们可以确信系统的状态 $(x(T_{\\max}), y(T_{\\max}))$ 将任意接近其中一个稳定平衡点。因此，基于长时间积分后的最终状态对初始条件进行分类，是近似其吸引盆的可靠方法。指定的积分时间 $T_{\\max} = 100$ 远大于系统的特征时间尺度 $\\tau=1$（来自线性降解项），确保了收敛。\n\n**数值策略**\n\n鲁棒性指标 $R(n, K)$ 是域 $\\mathcal{D}$ 内“$x$-高”状态吸引盆的面积分数。我们使用基于网格的蒙特卡洛方法来近似它。\n\n1. **离散化域**：在域 $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$上构建一个 $M \\times M$ 的均匀网格初始条件 $(x_0, y_0)$，其中 $M=25$ 且 $\\alpha=10$。\n\n2. **数值积分**：对于网格上的每个初始条件 $(x_0, y_0)$，将常微分方程系统从 $t=0$ 数值积分到 $t=T_{\\max}=100$。我们使用高精度常微分方程求解器，并采用指定的相对容差 $\\mathrm{rtol}=10^{-8}$ 和绝对容差 $\\mathrm{atol}=10^{-10}$ 以确保准确性。\n\n3. **分类**：对每个轨迹的最终状态 $(x(T_{\\max}), y(T_{\\max}))$ 进行分类。如果 $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$（其中 $\\varepsilon=10^{-3}$），则认为该初始条件属于“$x$-高”吸引子的吸引盆。一个用于记录此类轨迹的计数器会递增。\n\n4. **鲁棒性计算**：在模拟完所有 $M^2$ 个初始条件后，鲁棒性 $R(n, K)$ 计算为收敛到“$x$-高”状态的轨迹数量与总初始条件数 $M^2$ 的比率。\n\n此过程被系统地应用于四个指定的 $(n, K)$ 测试用例，以分析协同性和阻遏强度如何影响系统的双稳态性及其吸引盆的大小。对于双稳态情况，系统的对称性意味着“$x$-高”和“$y$-高”状态的吸引盆大小应约相等，由不稳定的对称状态的吸引盆分隔。分界线应靠近对角线 $y=x$。给定一个 $25 \\times 25 = 625$ 个点的网格，其中 $25$ 个点在对角线上，每侧有 $300$ 个点。因此，对于强双稳态情况，我们预计 $R(n, K) \\approx 300 / 625 = 0.48$。对于仅存在对称平衡点的单稳态情况，我们预计 $R(n, K) = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Models a symmetric genetic toggle switch, computes a robustness metric for its\n    bistable behavior, and evaluates this metric for several parameter sets.\n    \"\"\"\n    \n    # Define the fixed parameters from the problem statement.\n    alpha = 10.0\n    M = 25\n    T_max = 100.0\n    epsilon = 1e-3\n    rtol = 1e-8\n    atol = 1e-10\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.0),   # Low cooperativity, expected monostable\n        (2.0, 10.0),  # Weak repression, expected monostable\n        (3.5, 1.0),   # Moderate cooperativity, expected bistable\n        (4.0, 0.2)    # Strong cooperativity, expected bistable\n    ]\n\n    def toggle_switch_ode(t, state, n, K):\n        \"\"\"\n        Defines the system of ordinary differential equations for the genetic toggle switch.\n        \n        Args:\n            t (float): Time (required by solve_ivp, but not used in this autonomous system).\n            state (list or np.ndarray): A list [x, y] representing the protein concentrations.\n            n (float): The Hill coefficient.\n            K (float): The repression threshold.\n        \n        Returns:\n            list: A list [dx/dt, dy/dt] of the rates of change.\n        \"\"\"\n        x, y = state\n        dx_dt = alpha / (1.0 + (y / K)**n) - x\n        dy_dt = alpha / (1.0 + (x / K)**n) - y\n        return [dx_dt, dy_dt]\n\n    results = []\n    \n    # Generate the grid of initial conditions over the domain D = [0, alpha] x [0, alpha]\n    initial_conditions_x = np.linspace(0, alpha, M)\n    initial_conditions_y = np.linspace(0, alpha, M)\n\n    # Iterate through each parameter set (n, K)\n    for n, K in test_cases:\n        x_high_count = 0\n        \n        # Iterate through each initial condition on the grid\n        for x0 in initial_conditions_x:\n            for y0 in initial_conditions_y:\n                # Numerically integrate the ODE from t=0 to t=T_max\n                solution = solve_ivp(\n                    toggle_switch_ode,\n                    [0, T_max],\n                    [x0, y0],\n                    args=(n, K),\n                    rtol=rtol,\n                    atol=atol,\n                    dense_output=False  # We only need the final point\n                )\n                \n                # Extract the final state at t=T_max\n                x_final, y_final = solution.y[:, -1]\n                \n                # Classify the trajectory based on the final state\n                # If it converges to the \"x-high\" attractor, increment the counter.\n                if x_final - y_final >= epsilon:\n                    x_high_count += 1\n        \n        # Calculate the robustness metric R(n, K)\n        total_points = M * M\n        robustness = x_high_count / total_points\n        \n        # Append the formatted result to the list\n        results.append(f\"{robustness:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们之前的模型为了简化，忽略了基因表达过程（转录和翻译）所需的时间。然而，在生物系统中，时间延迟是不可避免的。这个练习将一个关键的生物学细节——时间延迟——引入模型，你将通过解析分析来研究延迟如何破坏开关的稳定状态并引发振荡，这一现象被称为霍普夫分岔（Hopf bifurcation）。",
            "id": "3328017",
            "problem": "考虑一个具有显式转录-翻译延迟的经典相互抑制基因拨动开关。令 $x(t)$ 和 $y(t)$ 表示两种阻遏蛋白的浓度。假设每种蛋白质通过 Hill 型抑制函数抑制另一种蛋白质的合成，并以一级速率常数降解。该延迟动力学系统为\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{y(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\,x(t),\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\,y(t),\n$$\n其中 $\\beta$ 是最大合成速率，$K$ 是抑制阈值，$n$ 是 Hill 系数，$\\gamma$ 是降解速率常数，$\\tau$ 是捕获转录和翻译时间的有效延迟。\n\n假设参数使得系统存在一个对称稳态 $x^{*} = y^{*}  0$，其由以下方程隐式定义\n$$\n\\gamma\\,x^{*} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{x^{*}}{K}\\right)^{n}}.\n$$\n从以下基本事实出发：由于有限的转录和翻译时间，延迟会进入基因表达；在延迟系统中，负反馈可以产生复特征值；线性稳定性由线性化延迟系统的特征方程的根决定。请分析对称稳态 $x^{*}=y^{*}$ 的局部稳定性，将其作为延迟 $\\tau$ 的函数。特别地，确定增加 $\\tau$ 是否会使稳态失稳并产生振荡瞬态，并且，在发生振荡不稳定性的情况下，计算出现一对纯虚特征值时的最小正延迟 $\\tau_{c}$（Hopf 分岔的临界延迟）。将 $\\tau_{c}$ 的最终结果表示为关于 $\\gamma$ 和稳态下抑制性生产项的局部斜率 $b$ 的单个闭式解析表达式，其中\n$$\nb \\;=\\; -\\left.\\frac{d}{dy}\\left(\\frac{\\beta}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right)\\right|_{y = x^{*}}\n\\;=\\;\n\\frac{\\beta\\,n}{K}\\,\\frac{\\left(\\frac{x^{*}}{K}\\right)^{n-1}}{\\left(1 + \\left(\\frac{x^{*}}{K}\\right)^{n}\\right)^{2}}.\n$$\n不需要进行数值计算；仅在满足振荡不稳定性条件时，提供 $\\tau_{c}$ 的精确符号表达式。最终表达式中不需要单位，也无需四舍五入。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n从问题陈述中逐字提取的已知条件如下：\n- 阻遏蛋白浓度 $x(t)$ 和 $y(t)$ 的延迟微分方程组：\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{y(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\,x(t)\n$$\n$$\n\\frac{dy}{dt} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\,y(t)\n$$\n- 参数：$\\beta$（最大合成速率），$K$（抑制阈值），$n$（Hill 系数），$\\gamma$（降解速率常数），$\\tau$（有效延迟）。\n- 存在一个对称稳态 $x^{*} = y^{*}  0$，由以下方程隐式定义：\n$$\n\\gamma\\,x^{*} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{x^{*}}{K}\\right)^{n}}\n$$\n- 稳态下抑制性生产项的局部斜率 $b$ 定义为：\n$$\nb \\;=\\; -\\left.\\frac{d}{dy}\\left(\\frac{\\beta}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right)\\right|_{y = x^{*}}\n\\;=\\;\n\\frac{\\beta\\,n}{K}\\,\\frac{\\left(\\frac{x^{*}}{K}\\right)^{n-1}}{\\left(1 + \\left(\\frac{x^{*}}{K}\\right)^{n}\\right)^{2}}\n$$\n- 任务是分析此稳态的局部稳定性作为 $\\tau$ 的函数，确定增加 $\\tau$ 是否会导致振荡不稳定性，并计算 Hopf 分岔的最小正临界延迟 $\\tau_{c}$，用 $\\gamma$ 和 $b$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该模型是基因拨动开关的经典表示，是合成生物学和系统生物学中的一个基本模体。使用 Hill 函数对基因抑制进行建模，并使用一级动力学处理降解是标准做法。包含时间延迟以解释转录和翻译是研究此类系统动力学的一个成熟且必要的改进。通过线性化进行稳定性分析以及寻找由延迟引起的 Hopf 分岔是该领域的标准、严谨的数学技术。该问题在科学上是合理的，并基于既定原则。\n- **良定的：** 该问题定义清晰。它要求基于给定的数学模型推导一个特定的物理量，即临界延迟 $\\tau_c$。所有必要的方程、定义和变量都已提供。此分析的步骤是动力系统理论的标准部分。\n- **客观的：** 问题以精确、客观的数学语言陈述，没有任何主观性或模糊性。\n\n该问题不违反任何无效标准。它在科学上是合理的，形式上是明确的，完整的，并在计算系统生物学中提出了一个非平凡但可解的问题。\n\n**步骤 3：结论和行动**\n\n该问题是**有效的**。将提供完整的解答。\n\n### 解答\n\n为了分析对称稳态 $(x^{*}, y^{*})$ 的局部稳定性，我们对延迟微分方程组进行线性化。设 $u(t) = x(t) - x^{*}$ 和 $v(t) = y(t) - y^{*}$ 是对稳态的小扰动。线性化系统由下式给出：\n$$\n\\frac{d}{dt}\\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix} = J_0 \\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix} + J_{\\tau} \\begin{pmatrix} u(t-\\tau) \\\\ v(t-\\tau) \\end{pmatrix}\n$$\n其中 $J_0$ 和 $J_{\\tau}$ 分别是系统相对于非延迟变量和延迟变量的雅可比矩阵，在稳态 $(x^{*}, y^{*})$ 处求值。\n\n雅可比矩阵的分量为：\n$$\n\\left(J_0\\right)_{11} = \\left.\\frac{\\partial}{\\partial x}\\left( -\\gamma x \\right)\\right|_{x=x^{*}} = -\\gamma\n$$\n$$\n\\left(J_0\\right)_{22} = \\left.\\frac{\\partial}{\\partial y}\\left( -\\gamma y \\right)\\right|_{y=y^{*}} = -\\gamma\n$$\n$J_0$ 的非对角项为 $0$。对于延迟雅可比矩阵 $J_{\\tau}$：\n$$\n\\left(J_{\\tau}\\right)_{12} = \\left.\\frac{\\partial}{\\partial y(t-\\tau)}\\left( \\frac{\\beta}{1 + \\left(\\frac{y(t-\\tau)}{K}\\right)^{n}} \\right)\\right|_{y=y^{*}} = -b\n$$\n根据对称性，\n$$\n\\left(J_{\\tau}\\right)_{21} = \\left.\\frac{\\partial}{\\partial x(t-\\tau)}\\left( \\frac{\\beta}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} \\right)\\right|_{x=x^{*}} = -b\n$$\n$J_{\\tau}$ 的对角项为 $0$。因此，线性化系统为：\n$$\n\\frac{du}{dt} = -\\gamma u(t) - b v(t-\\tau)\n$$\n$$\n\\frac{dv}{dt} = -\\gamma v(t) - b u(t-\\tau)\n$$\n我们寻找形式为 $(u(t), v(t)) = (u_0, v_0) e^{\\lambda t}$ 的解。将此拟设代入线性化系统，得到特征值问题：\n$$\n\\lambda u_0 e^{\\lambda t} = -\\gamma u_0 e^{\\lambda t} - b v_0 e^{\\lambda (t-\\tau)}\n$$\n$$\n\\lambda v_0 e^{\\lambda t} = -\\gamma v_0 e^{\\lambda t} - b u_0 e^{\\lambda (t-\\tau)}\n$$\n两边同除以 $e^{\\lambda t}$，我们得到关于 $(u_0, v_0)$ 的线性系统：\n$$\n(\\lambda + \\gamma) u_0 + b e^{-\\lambda \\tau} v_0 = 0\n$$\n$$\nb e^{-\\lambda \\tau} u_0 + (\\lambda + \\gamma) v_0 = 0\n$$\n为使非平凡解存在，系数矩阵的行列式必须为零。这给出了特征值 $\\lambda$ 的特征方程：\n$$\n(\\lambda + \\gamma)^2 - (b e^{-\\lambda \\tau})^2 = 0\n$$\n$$\n(\\lambda + \\gamma)^2 - b^2 e^{-2\\lambda \\tau} = 0\n$$\n该方程可以分解为两个独立的超越方程：\n1. $\\lambda + \\gamma - b e^{-\\lambda \\tau} = 0$\n2. $\\lambda + \\gamma + b e^{-\\lambda \\tau} = 0$\n它们分别对应于反对称 ($u-v$) 和对称 ($u+v$) 扰动模式的特征方程。当一对共轭复特征值穿过虚轴时，发生 Hopf 分岔。我们寻找最小的正延迟 $\\tau = \\tau_c$，使得存在一个纯虚特征值 $\\lambda = i\\omega$（其中 $\\omega  0$）。\n\n情况 1：$\\lambda + \\gamma - b e^{-\\lambda \\tau} = 0$\n代入 $\\lambda = i\\omega$：\n$$\ni\\omega + \\gamma - b e^{-i\\omega \\tau} = 0 \\implies i\\omega + \\gamma = b(\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n分离实部和虚部：\n$$\n\\gamma = b \\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = \\frac{\\gamma}{b}\n$$\n$$\n\\omega = -b \\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = -\\frac{\\omega}{b}\n$$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$\n\\left(\\frac{\\gamma}{b}\\right)^2 + \\left(-\\frac{\\omega}{b}\\right)^2 = 1 \\implies \\frac{\\gamma^2 + \\omega^2}{b^2} = 1 \\implies \\omega^2 = b^2 - \\gamma^2\n$$\n为了存在实振荡频率 $\\omega  0$，我们必须有 $b^2  \\gamma^2$。由于 $b  0$ 且 $\\gamma  0$，这要求 $b  \\gamma$。在此条件下，$\\omega = \\sqrt{b^2 - \\gamma^2}$。\n为了 $\\tau$ 的解存在，我们需要 $\\cos(\\omega\\tau)  0$ 和 $\\sin(\\omega\\tau)  0$，这将角 $\\omega\\tau$ 置于第四象限。最小的正角由 $\\omega\\tau_k = 2\\pi - \\arccos(\\gamma/b) + 2k\\pi$，$k=0, 1, \\dots$。此分支的最小正延迟在 $k=0$ 时取得：\n$$\n\\tau_{c,1} = \\frac{1}{\\omega} \\left(2\\pi - \\arccos\\left(\\frac{\\gamma}{b}\\right)\\right)\n$$\n\n情况 2：$\\lambda + \\gamma + b e^{-\\lambda \\tau} = 0$\n代入 $\\lambda = i\\omega$：\n$$\ni\\omega + \\gamma + b e^{-i\\omega \\tau} = 0 \\implies i\\omega + \\gamma = -b(\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n分离实部和虚部：\n$$\n\\gamma = -b \\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = -\\frac{\\gamma}{b}\n$$\n$$\n\\omega = b \\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = \\frac{\\omega}{b}\n$$\n对 $\\omega$ 的条件是相同的：$\\omega^2 = b^2 - \\gamma^2$，要求 $b  \\gamma$。\n在这里，$\\cos(\\omega\\tau)  0$ 且 $\\sin(\\omega\\tau)  0$。这将角 $\\omega\\tau$ 置于第二象限。$\\omega\\tau$ 的解集是 $\\omega\\tau_k = \\arccos(-\\gamma/b) + 2k\\pi$，$k=0, 1, \\dots$。此分支的最小正延迟在 $k=0$ 时取得：\n$$\n\\tau_{c,2} = \\frac{1}{\\omega} \\arccos\\left(-\\frac{\\gamma}{b}\\right)\n$$\n总的临界延迟 $\\tau_c$ 是两种情况下最小正延迟中的最小值，即 $\\tau_c = \\min(\\tau_{c,1}, \\tau_{c,2})$。我们可以使用恒等式 $\\arccos(-z) = \\pi - \\arccos(z)$，其中 $z \\in [-1, 1]$。\n$$\n\\tau_{c,2} = \\frac{1}{\\omega} \\left(\\pi - \\arccos\\left(\\frac{\\gamma}{b}\\right)\\right)\n$$\n由于 $b  \\gamma  0$，所以 $0  \\gamma/b  1$，因此 $0  \\arccos(\\gamma/b)  \\pi/2$。\n因此，$\\pi - \\arccos(\\gamma/b)$ 位于 $(\\pi/2, \\pi)$ 区间，而 $2\\pi - \\arccos(\\gamma/b)$ 位于 $(3\\pi/2, 2\\pi)$ 区间。\n显然，$\\tau_{c,2}  \\tau_{c,1}$。\n因此，导致振荡不稳定性（Hopf 分岔）的最小正延迟是 $\\tau_c = \\tau_{c,2}$。代入 $\\omega = \\sqrt{b^2 - \\gamma^2}$，我们得到临界延迟的最终表达式。这种不稳定性是通过对称扰动模式发生的。\n\n将 $\\tau$ 从 0 开始增加确实可以使稳态失稳，前提是反馈足够强 ($b  \\gamma$)。失稳导致了振荡瞬态，这是 Hopf 分岔的特征。临界延迟 $\\tau_c$ 是这种不稳定性的阈值。\n结果是：\n$$\n\\tau_c = \\frac{1}{\\sqrt{b^2 - \\gamma^2}} \\arccos\\left(-\\frac{\\gamma}{b}\\right)\n$$",
            "answer": "$$\\boxed{\\frac{\\arccos\\left(-\\frac{\\gamma}{b}\\right)}{\\sqrt{b^{2} - \\gamma^{2}}}}$$"
        }
    ]
}