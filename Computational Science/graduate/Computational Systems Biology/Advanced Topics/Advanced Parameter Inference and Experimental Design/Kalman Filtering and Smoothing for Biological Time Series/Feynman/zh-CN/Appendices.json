{
    "hands_on_practices": [
        {
            "introduction": "在应用卡尔曼滤波器之前，我们必须回答一个基本问题：我们能否仅通过系统的输出来唯一地确定其内部状态？这个被称为“可观测性”的性质是成功进行状态估计的先决条件。本练习将通过一个简单的基因表达模型，引导您从第一性原理出发，构建可观测性矩阵，将这一抽象概念与具体计算联系起来()。",
            "id": "3322163",
            "problem": "一个双物种基因表达系统在一个固定的采样间隔上，通过一个离散时间线性时不变（LTI）状态空间模型进行建模，该模型旨在用于荧光时间序列的卡尔曼滤波与平滑。潜状态 $x_{t} \\in \\mathbb{R}^{2}$ 包含两个经过对数变换的浓度，观测值 $y_{t} \\in \\mathbb{R}$ 是一个单通道的荧光读数。动态方程和观测方程由下式给出\n$$\nx_{t+1} = A x_{t}, \\quad y_{t} = C x_{t} + v_{t},\n$$\n其中 $v_{t}$ 是零均值高斯测量噪声，矩阵为\n$$\nA = \\begin{bmatrix} 1  0 \\\\ 0  0.5 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1  1 \\end{bmatrix}.\n$$\n在可观测性基础上的无噪声思想实验中，不同的初始状态 $x_{0}$ 应产生不同的半无限输出序列 $\\{y_{t}\\}_{t=0}^{\\infty}$。\n\n严格地从“一个离散时间线性系统是可观测的，当且仅当从初始状态 $x_{0}$ 到有限时间输出堆栈的映射具有平凡零空间”这一定义出发，按以下步骤进行：\n- 将前两个输出 $y_{0}$ 和 $y_{1}$ 表示为初始状态 $x_{0}$ 的线性函数。\n- 构建从 $x_{0}$ 到堆叠输出 $\\begin{bmatrix} y_{0} \\\\ y_{1} \\end{bmatrix}$ 的相应线性映射，并确定其像的维度。\n- 根据此分析，计算相关可观测性映射的秩，并说明数对 $(A,C)$ 是否使状态 $x_{t}$ 完全可观测（即，不同的 $x_{0}$ 是否产生不同的输出序列）。\n\n将可观测性映射的秩作为你的最终数值答案。请将最终答案表示为无单位的整数。",
            "solution": "问题陈述经核实具有科学依据、提法恰当且客观。它提出了一个线性系统理论中的标准问题，涉及离散时间状态空间模型的可观测性，并为进行严谨分析提供了所有必需的矩阵和定义。\n\n对状态空间系统的可观测性分析，其前提是确定初始状态 $x_{0}$ 是否可以从观测序列 $\\{y_{t}\\}$ 中被唯一确定。按照标准实践，此性质在无噪声的背景下进行评估。因此，为了分析目的，我们将测量噪声项 $v_{t}$ 设为 0。系统的控制方程为：\n$$\nx_{t+1} = A x_{t}\n$$\n$$\ny_{t} = C x_{t}\n$$\n任意时刻 $t$ 的状态可以通过递归应用状态动态方程表示为初始状态 $x_{0}$ 的函数：\n$$\nx_{t} = A^{t} x_{0}\n$$\n将此代入观测方程，可得到时刻 $t$ 的输出作为初始状态的线性函数：\n$$\ny_{t} = C A^{t} x_{0}\n$$\n\n问题的第一个部分要求将前两个输出 $y_{0}$ 和 $y_{1}$ 表示为初始状态 $x_{0} \\in \\mathbb{R}^{2}$ 的线性函数。\n对于时间 $t=0$，输出 $y_{0}$ 与 $x_{0}$ 的关系为：\n$$\ny_{0} = C A^{0} x_{0} = C I x_{0} = C x_{0}\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。使用给定的观测矩阵 $C = \\begin{bmatrix} 1  1 \\end{bmatrix}$ 并将初始状态向量定义为 $x_{0} = \\begin{bmatrix} x_{0,1} \\\\ x_{0,2} \\end{bmatrix}$，$y_{0}$ 的表达式变为：\n$$\ny_{0} = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} x_{0,1} \\\\ x_{0,2} \\end{bmatrix} = x_{0,1} + x_{0,2}\n$$\n对于时间 $t=1$，输出 $y_{1}$ 与 $x_{0}$ 的关系为：\n$$\ny_{1} = C A^{1} x_{0} = C A x_{0}\n$$\n为继续进行，我们必须计算矩阵乘积 $CA$：\n$$\nCA = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  0.5 \\end{bmatrix} = \\begin{bmatrix} (1)(1) + (1)(0)  (1)(0) + (1)(0.5) \\end{bmatrix} = \\begin{bmatrix} 1  0.5 \\end{bmatrix}\n$$\n使用这个结果，我们可以将 $y_{1}$ 表示为 $x_{0}$ 的函数：\n$$\ny_{1} = \\begin{bmatrix} 1  0.5 \\end{bmatrix} \\begin{bmatrix} x_{0,1} \\\\ x_{0,2} \\end{bmatrix} = x_{0,1} + 0.5 x_{0,2}\n$$\n\n问题的第二部分涉及构建从 $x_{0}$ 到堆叠输出 $\\begin{bmatrix} y_{0} \\\\ y_{1} \\end{bmatrix}$ 的线性映射，并确定其像的维度。我们可以将这个堆叠的方程组写成矩阵形式：\n$$\n\\begin{bmatrix} y_{0} \\\\ y_{1} \\end{bmatrix} = \\begin{bmatrix} C x_{0} \\\\ C A x_{0} \\end{bmatrix} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix} x_{0}\n$$\n从初始状态 $x_{0}$ 到输出向量 $\\begin{bmatrix} y_{0} \\\\ y_{1} \\end{bmatrix}$ 的线性映射由矩阵 $\\mathcal{O}_{2} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}$ 表示。该矩阵是有限观测时域为 2 个时间步长（从 $t=0$ 到 $t=1$）的可观测性矩阵。代入先前计算的矩阵 $C$ 和 $CA$：\n$$\n\\mathcal{O}_{2} = \\begin{bmatrix} 1  1 \\\\ 1  0.5 \\end{bmatrix}\n$$\n该线性映射的像是矩阵 $\\mathcal{O}_{2}$ 的列空间。根据定义，像的维度就是矩阵的秩。对于方阵，可以通过计算其行列式来评估秩。\n$$\n\\det(\\mathcal{O}_{2}) = (1)(0.5) - (1)(1) = 0.5 - 1 = -0.5\n$$\n由于行列式非零（$\\det(\\mathcal{O}_{2}) \\neq 0$），该矩阵是可逆的，因此具有满秩。秩等于列数（或行数），即 2。因此，该映射的像的维度是 2。\n\n问题的最后一部分要求计算相关可观测性映射的秩，并就系统的可观测性得出结论。对于状态维度为 $n$ 的离散时间LTI系统，可观测性映射（或可观测性矩阵）$\\mathcal{O}$ 由卡尔曼可观测性判据定义为：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\\\ \\vdots \\\\ CA^{n-1} \\end{bmatrix}\n$$\n在本问题中，状态维度为 $n=2$。因此，可观测性映射为：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA^{2-1} \\end{bmatrix} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}\n$$\n这正是前一步中构建和分析的矩阵 $\\mathcal{O}_{2}$。因此，可观测性映射的秩为：\n$$\n\\text{rank}(\\mathcal{O}) = \\text{rank}(\\mathcal{O}_{2}) = 2\n$$\n一个系统被定义为完全可观测，当且仅当其可观测性映射 $\\mathcal{O}$ 具有满列秩，即 $\\text{rank}(\\mathcal{O}) = n$。在本例中，状态维度为 $n=2$，我们已经发现 $\\text{rank}(\\mathcal{O}) = 2$。条件 $\\text{rank}(\\mathcal{O}) = n$ 得到满足。因此，数对 $(A, C)$ 使状态 $x_{t}$ 完全可观测。这意味着 $\\mathcal{O}$ 的零空间是平凡的，只包含零向量。因此，如果对于两个初始状态有 $\\mathcal{O} x_{0,a} = \\mathcal{O} x_{0,b}$，那么必然有 $x_{0,a} = x_{0,b}$。不同的初始状态必然产生不同的输出序列，并且初始状态 $x_{0}$ 可以从前 $n=2$ 次测量中唯一确定。\n\n该问题明确要求可观测性映射的秩。根据正式计算，此秩为 2。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "卡尔曼滤波器的核心在于其更新步骤，即利用新的测量值来修正状态协方差。虽然标准更新公式形式优雅，但在实际的有限精度计算中可能导致数值不稳定，甚至使协方差矩阵失去其应有的对称性和半正定性。本练习将介绍协方差更新的“Joseph 型”()，这是一种数值上更稳定的形式，并要求您在一个生物传感场景中应用它，以保证计算的稳健性。",
            "id": "3322205",
            "problem": "一个二维潜在分子状态 $\\mathbf{x}_t = \\begin{bmatrix}x_{m,t} \\\\ x_{p,t}\\end{bmatrix}$ 在一个线性高斯状态空间模型中对一个随时间演化的基因表达模块中的信使核糖核酸 (mRNA) 和蛋白质丰度进行建模。在时间 $t$，纳入荧光测量值之前，先验（预测）协方差为\n$$\nP_{t\\mid t-1} \\;=\\; \\begin{bmatrix}1  0 \\\\ 0  0.5\\end{bmatrix}.\n$$\n荧光读数 $y_t$ 仅通过测量矩阵线性地感知 mRNA\n$$\nC \\;=\\; \\begin{bmatrix}1  0\\end{bmatrix},\n$$\n以及测量噪声方差\n$$\nR \\;=\\; \\begin{bmatrix}0.2\\end{bmatrix}.\n$$\n假设满足标准线性高斯假设：先验状态 $\\mathbf{x}_t \\mid y_{1:t-1}$ 是协方差为 $P_{t\\mid t-1}$ 的高斯分布，观测模型为 $y_t = C \\mathbf{x}_t + v_t$，其中 $v_t \\sim \\mathcal{N}(0,R)$ 且独立于 $\\mathbf{x}_t$，并且所有分布都是良定义的。\n\n仅使用多元高斯条件化和线性代数的基本性质，完成以下操作：\n\n1) 从 $(\\mathbf{x}_t, y_t)$ 的联合高斯性所蕴含的 $\\mathbf{x}_t \\mid y_t$ 协方差的块高斯条件化恒等式出发，推导在有限精度计算中能保持对称性和半正定性的稳定协方差更新（通常称为 Joseph 形式）。你的推导必须用先验协方差 $P_{t\\mid t-1}$、卡尔曼增益 $K_t$、测量矩阵 $C$ 和测量噪声协方差 $R$ 来明确表示此稳定更新，并且必须证明为什么所得表达式是对称和半正定的。\n\n2) 计算新息协方差 $S_t$、卡尔曼增益 $K_t$，然后应用第 1 部分中你得到的稳定协方差更新来获得后验协方差 $P_{t\\mid t}$。通过检查其特征值，数值验证 $P_{t\\mid t}$ 是对称和半正定的。\n\n3) 以精确分数形式报告 $P_{t\\mid t}$ 的最小特征值。最终答案中不要包含任何单位。",
            "solution": "我们从标准线性高斯状态-观测模型开始：状态 $\\mathbf{x}_t \\mid y_{1:t-1}$ 是均值（此处不需要）和协方差为 $P_{t\\mid t-1}$ 的高斯分布，观测模型为 $y_t = C \\mathbf{x}_t + v_t$，其中 $v_t \\sim \\mathcal{N}(0,R)$ 且独立于 $\\mathbf{x}_t$。在 $y_{1:t-1}$ 条件下，$(\\mathbf{x}_t, y_t)$ 的联合分布是高斯分布。一个关于块高斯条件化的经过充分检验的恒等式指出，对于一个划分为 $(\\mathbf{a},\\mathbf{b})$ 且协方差块为 $P_{\\mathbf{a}\\mathbf{a}}$、$P_{\\mathbf{a}\\mathbf{b}}$、$P_{\\mathbf{b}\\mathbf{b}}$ 的联合高斯向量，其条件协方差为\n$$\n\\operatorname{Cov}(\\mathbf{a}\\mid \\mathbf{b}) \\;=\\; P_{\\mathbf{a}\\mathbf{a}} \\;-\\; P_{\\mathbf{a}\\mathbf{b}}\\, P_{\\mathbf{b}\\mathbf{b}}^{-1} \\, P_{\\mathbf{b}\\mathbf{a}}.\n$$\n将此应用于 $\\mathbf{a}=\\mathbf{x}_t$ 和 $\\mathbf{b}=y_t$，我们得到\n$$\nP_{t\\mid t} \\;=\\; P_{t\\mid t-1} \\;-\\; P_{t\\mid t-1} C^{\\mathsf{T}} \\left(C P_{t\\mid t-1} C^{\\mathsf{T}} + R\\right)^{-1} C P_{t\\mid t-1}.\n$$\n定义新息协方差\n$$\nS_t \\;=\\; C P_{t\\mid t-1} C^{\\mathsf{T}} + R,\n$$\n和卡尔曼增益（卡尔曼滤波器 (KF) 增益）\n$$\nK_t \\;=\\; P_{t\\mid t-1} C^{\\mathsf{T}} S_t^{-1}.\n$$\n那么条件协方差可简化为\n$$\nP_{t\\mid t} \\;=\\; P_{t\\mid t-1} \\;-\\; K_t\\, C\\, P_{t\\mid t-1}.\n$$\n虽然这个表达式是精确的，但在有限精度计算中它可能会失去对称性。一种称为 Joseph 形式的数值稳定更新将同一协方差重写为\n$$\nP_{t\\mid t} \\;=\\; \\left(I - K_t C\\right) P_{t\\mid t-1} \\left(I - K_t C\\right)^{\\mathsf{T}} \\;+\\; K_t R K_t^{\\mathsf{T}}.\n$$\n为验证等价性，展开右侧：\n$$\n\\begin{aligned}\n\\left(I - K_t C\\right) P_{t\\mid t-1} \\left(I - K_t C\\right)^{\\mathsf{T}} + K_t R K_t^{\\mathsf{T}}\n= P_{t\\mid t-1} - K_t C P_{t\\mid t-1} - P_{t\\mid t-1} C^{\\mathsf{T}} K_t^{\\mathsf{T}} \\\\\n\\quad + K_t C P_{t\\mid t-1} C^{\\mathsf{T}} K_t^{\\mathsf{T}} + K_t R K_t^{\\mathsf{T}} \\\\\n= P_{t\\mid t-1} - K_t C P_{t\\mid t-1} - P_{t\\mid t-1} C^{\\mathsf{T}} K_t^{\\mathsf{T}} + K_t \\left(C P_{t\\mid t-1} C^{\\mathsf{T}} + R\\right) K_t^{\\mathsf{T}} \\\\\n= P_{t\\mid t-1} - K_t C P_{t\\mid t-1} - P_{t\\mid t-1} C^{\\mathsf{T}} K_t^{\\mathsf{T}} + K_t S_t K_t^{\\mathsf{T}}.\n\\end{aligned}\n$$\n使用 $K_t S_t = P_{t\\mid t-1} C^{\\mathsf{T}}$ 和 $S_t K_t^{\\mathsf{T}} = C P_{t\\mid t-1}$，我们有 $K_t S_t K_t^{\\mathsf{T}} = P_{t\\mid t-1} C^{\\mathsf{T}} K_t^{\\mathsf{T}} = K_t C P_{t\\mid t-1}$。代入后，\n$$\n\\left(I - K_t C\\right) P_{t\\mid t-1} \\left(I - K_t C\\right)^{\\mathsf{T}} + K_t R K_t^{\\mathsf{T}}\n= P_{t\\mid t-1} - K_t C P_{t\\mid t-1},\n$$\n这与上面的条件协方差表达式相匹配。Joseph 形式显然是对称的，因为它是对称矩阵之和；并且它是半正定的 (PSD)，因为它是半正定 (PSD) 矩阵的合同变换之和：只要 $P_{t\\mid t-1} \\succeq 0$，就有 $\\left(I - K_t C\\right) P_{t\\mid t-1} \\left(I - K_t C\\right)^{\\mathsf{T}} \\succeq 0$；只要 $R \\succeq 0$，就有 $K_t R K_t^{\\mathsf{T}} \\succeq 0$。\n\n我们现在将这些公式应用于给定的生物传感实例。给定的量为\n$$\nP_{t\\mid t-1} \\;=\\; \\begin{bmatrix}1  0 \\\\ 0  0.5\\end{bmatrix}, \\quad C \\;=\\; \\begin{bmatrix}1  0\\end{bmatrix}, \\quad R \\;=\\; \\begin{bmatrix}0.2\\end{bmatrix}.\n$$\n首先计算新息协方差：\n$$\nS_t \\;=\\; C P_{t\\mid t-1} C^{\\mathsf{T}} + R \\;=\\; \\begin{bmatrix}1  0\\end{bmatrix} \\begin{bmatrix}1  0 \\\\ 0  0.5\\end{bmatrix} \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} + \\begin{bmatrix}0.2\\end{bmatrix} \\;=\\; \\begin{bmatrix}1\\end{bmatrix} + \\begin{bmatrix}0.2\\end{bmatrix} \\;=\\; \\begin{bmatrix}1.2\\end{bmatrix}.\n$$\n等价地，$S_t = \\begin{bmatrix}\\frac{6}{5}\\end{bmatrix}$。\n\n接下来计算卡尔曼增益：\n$$\nK_t \\;=\\; P_{t\\mid t-1} C^{\\mathsf{T}} S_t^{-1} \\;=\\; \\begin{bmatrix}1  0 \\\\ 0  0.5\\end{bmatrix} \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} \\left(\\begin{bmatrix}1.2\\end{bmatrix}\\right)^{-1} \\;=\\; \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} \\cdot \\frac{1}{1.2} \\;=\\; \\begin{bmatrix}\\frac{5}{6} \\\\ 0\\end{bmatrix}.\n$$\n应用 Joseph 形式：\n$$\nP_{t\\mid t} \\;=\\; \\left(I - K_t C\\right) P_{t\\mid t-1} \\left(I - K_t C\\right)^{\\mathsf{T}} + K_t R K_t^{\\mathsf{T}}.\n$$\n计算 $I - K_t C$：\n$$\nK_t C \\;=\\; \\begin{bmatrix}\\frac{5}{6} \\\\ 0\\end{bmatrix} \\begin{bmatrix}1  0\\end{bmatrix} \\;=\\; \\begin{bmatrix}\\frac{5}{6}  0 \\\\ 0  0\\end{bmatrix}, \\quad\nI - K_t C \\;=\\; \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix} - \\begin{bmatrix}\\frac{5}{6}  0 \\\\ 0  0\\end{bmatrix} \\;=\\; \\begin{bmatrix}\\frac{1}{6}  0 \\\\ 0  1\\end{bmatrix}.\n$$\n于是\n$$\n\\left(I - K_t C\\right) P_{t\\mid t-1} \\left(I - K_t C\\right)^{\\mathsf{T}}\n= \\begin{bmatrix}\\frac{1}{6}  0 \\\\ 0  1\\end{bmatrix} \\begin{bmatrix}1  0 \\\\ 0  0.5\\end{bmatrix} \\begin{bmatrix}\\frac{1}{6}  0 \\\\ 0  1\\end{bmatrix}\n= \\begin{bmatrix}\\frac{1}{36}  0 \\\\ 0  \\frac{1}{2}\\end{bmatrix}.\n$$\n另外，\n$$\nK_t R K_t^{\\mathsf{T}} \\;=\\; \\begin{bmatrix}\\frac{5}{6} \\\\ 0\\end{bmatrix} \\begin{bmatrix}0.2\\end{bmatrix} \\begin{bmatrix}\\frac{5}{6}  0\\end{bmatrix}\n\\;=\\; \\begin{bmatrix}\\frac{1}{5}\\end{bmatrix} \\begin{bmatrix}\\frac{25}{36}  0 \\\\ 0  0\\end{bmatrix}\n\\;=\\; \\begin{bmatrix}\\frac{5}{36}  0 \\\\ 0  0\\end{bmatrix}.\n$$\n相加，\n$$\nP_{t\\mid t} \\;=\\; \\begin{bmatrix}\\frac{1}{36}  0 \\\\ 0  \\frac{1}{2}\\end{bmatrix} + \\begin{bmatrix}\\frac{5}{36}  0 \\\\ 0  0\\end{bmatrix}\n\\;=\\; \\begin{bmatrix}\\frac{1}{6}  0 \\\\ 0  \\frac{1}{2}\\end{bmatrix}.\n$$\n这个 $P_{t\\mid t}$ 是对称的。因为它是对角矩阵，其特征值即为对角线元素：\n$$\n\\lambda_1 \\;=\\; \\frac{1}{6}, \\qquad \\lambda_2 \\;=\\; \\frac{1}{2}.\n$$\n两个特征值都是非负的，因此 $P_{t\\mid t}$ 是半正定的（PSD, positive semidefinite）。最小的特征值是\n$$\n\\min\\!\\left\\{\\frac{1}{6}, \\frac{1}{2}\\right\\} \\;=\\; \\frac{1}{6}.\n$$\n按要求，我们以精确分数形式报告此值。",
            "answer": "$$\\boxed{\\frac{1}{6}}$$"
        },
        {
            "introduction": "卡尔曼滤波器提供了在给定截至当前时间的所有测量值的情况下，对当前状态的最佳估计。然而，如果我们能分析完整的时序数据，就可以获得更精确的结果。Rauch-Tung-Striebel (RTS) 平滑器正为此而生，它从最终的滤波估计开始向后递推，以修正所有先前的状态估计，从而得到给定整个数据集的最优状态轨迹()。本练习将让您亲手将 RTS 算法应用于一个 mRNA 和蛋白质动态模型。",
            "id": "3322157",
            "problem": "一个二维潜状态表示单个细胞中信使核糖核酸 (mRNA) 和蛋白质的对数丰度，记为向量 $x_t \\in \\mathbb{R}^2$，其分量为 $x_{t,1}$ (mRNA) 和 $x_{t,2}$ (蛋白质)。其动力学通过一个具有随机游走状态演化和直接带噪观测的线性高斯状态空间模型进行建模：\n$$\nx_{t+1} = A x_t + w_t, \\quad w_t \\sim \\mathcal{N}(0,Q), \\\\\ny_t = C x_t + v_t, \\quad v_t \\sim \\mathcal{N}(0,R),\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 2}$、$Q \\in \\mathbb{R}^{2 \\times 2}$、$C \\in \\mathbb{R}^{2 \\times 2}$ 和 $R \\in \\mathbb{R}^{2 \\times 2}$ 不随时间变化。考虑在时间 $t \\in \\{1,2,3\\}$ 处的一个三步序列，其中\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nQ = \\begin{pmatrix} 0.09  0 \\\\ 0  0.04 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nR = \\begin{pmatrix} 0.50  0 \\\\ 0  0.50 \\end{pmatrix}.\n$$\n根据已完成的卡尔曼滤波器前向过程，滤波后验均值和协方差如下所示：\n$$\nx_{1|1} = \\begin{pmatrix} 1.0 \\\\ 2.0 \\end{pmatrix}, \\quad\nP_{1|1} = \\begin{pmatrix} 0.25  0 \\\\ 0  0.16 \\end{pmatrix},\n$$\n$$\nx_{2|2} = \\begin{pmatrix} 1.2 \\\\ 1.8 \\end{pmatrix}, \\quad\nP_{2|2} = \\begin{pmatrix} 0.20  0 \\\\ 0  0.12 \\end{pmatrix},\n$$\n$$\nx_{3|3} = \\begin{pmatrix} 0.9 \\\\ 2.1 \\end{pmatrix}, \\quad\nP_{3|3} = \\begin{pmatrix} 0.15  0 \\\\ 0  0.10 \\end{pmatrix}.\n$$\n仅使用线性高斯状态空间模型的基本定义和联合高斯变量的性质，推导适用于此设置的 Rauch–Tung–Striebel (RTS) 平滑递归，并用它们计算在 $t \\in \\{1,2,3\\}$ 时的平滑后验均值 $x_{t|3}$ 和协方差 $P_{t|3}$。作为最终报告量，请提供时间 $t=1$ 时平滑协方差的第一个对角线元素，即标量 $(P_{1|3})_{11}$。请以精确值（无四舍五入）的形式表示您的最终答案。对数丰度变量是无量纲的；报告该标量时无需单位。",
            "solution": "该问题经评估有效，因其具有科学依据、问题明确、客观，并包含一套完整且一致的给定条件。它提出了一个计算系统生物学中涉及卡尔曼平滑的标准可解问题。\n\n该问题要求推导 Rauch–Tung–Striebel (RTS) 平滑递归，并将其应用于一个特定的线性高斯状态空间模型。该模型描述了在时间序列 $t \\in \\{1, 2, 3\\}$ 上 mRNA 和蛋白质对数丰度 $x_t = \\begin{pmatrix} x_{t,1} \\\\ x_{t,2} \\end{pmatrix}$ 的动力学。总时间步数为 $T=3$。平滑后验矩 $x_{t|T}$ 和 $P_{t|T}$ 是在给定所有测量值 $y_{1:T}$ 的条件下状态 $x_t$ 的均值和协方差，即 $p(x_t | y_1, \\dots, y_T)$。\n\n**RTS 平滑递归的推导**\n\n推导过程通过考虑在所有可用数据 $y_{1:T}$ 条件下状态 $x_t$ 和 $x_{t+1}$ 的联合分布来进行。根据条件概率法则，我们可以写出：\n$$p(x_t, x_{t+1} | y_{1:T}) = p(x_t | x_{t+1}, y_{1:T}) p(x_{t+1} | y_{1:T})$$\n由于状态空间模型的马尔可夫结构，在给定状态 $x_{t+1}$ 的条件下，状态 $x_t$ 与未来的测量值 $y_{t+1:T}$ 条件独立。因此，$p(x_t | x_{t+1}, y_{1:T}) = p(x_t | x_{t+1}, y_{1:t})$。\n\n我们的第一步是刻画联合分布 $p(x_t, x_{t+1} | y_{1:t})$。卡尔曼滤波器提供了滤波后验 $p(x_t | y_{1:t}) = \\mathcal{N}(x_t; x_{t|t}, P_{t|t})$。状态演化为 $x_{t+1} = A x_t + w_t$。由于 $x_t$（以 $y_{1:t}$ 为条件）和 $w_t$ 是独立的高斯变量，它们的线性组合 $x_{t+1}$ 也是高斯变量。因此，$(x_t, x_{t+1})$ 在 $y_{1:t}$ 条件下的联合分布是高斯的。其矩为：\n$$E\\begin{pmatrix} x_t \\\\ x_{t+1} \\end{pmatrix} | y_{1:t} = \\begin{pmatrix} E[x_t | y_{1:t}] \\\\ E[A x_t + w_t | y_{1:t}] \\end{pmatrix} = \\begin{pmatrix} x_{t|t} \\\\ A x_{t|t} \\end{pmatrix} = \\begin{pmatrix} x_{t|t} \\\\ x_{t+1|t} \\end{pmatrix}$$\n$$Cov\\begin{pmatrix} x_t \\\\ x_{t+1} \\end{pmatrix} | y_{1:t} = \\begin{pmatrix} Cov(x_t)  Cov(x_t, x_{t+1}) \\\\ Cov(x_{t+1}, x_t)  Cov(x_{t+1}) \\end{pmatrix}_{|y_{1:t}}$$\n对角块是滤波协方差和预测协方差：$Cov(x_t|y_{1:t}) = P_{t|t}$ 和 $Cov(x_{t+1}|y_{1:t}) = P_{t+1|t} = A P_{t|t} A^T + Q$。非对角块是 $Cov(x_t, x_{t+1} | y_{1:t}) = Cov(x_t, A x_t + w_t | y_{1:t}) = Cov(x_t, A x_t | y_{1:t}) = P_{t|t} A^T$。\n因此，我们有联合分布：\n$$p(x_t, x_{t+1} | y_{1:t}) = \\mathcal{N}\\left( \\begin{pmatrix} x_{t|t} \\\\ x_{t+1|t} \\end{pmatrix}, \\begin{pmatrix} P_{t|t}  P_{t|t}A^T \\\\ A P_{t|t}  P_{t+1|t} \\end{pmatrix} \\right)$$\n使用条件高斯分布的公式，我们发现 $p(x_t | x_{t+1}, y_{1:t})$ 是一个高斯分布，其均值和协方差为：\n$$ E[x_t | x_{t+1}, y_{1:t}] = x_{t|t} + P_{t|t} A^T P_{t+1|t}^{-1} (x_{t+1} - x_{t+1|t}) $$\n$$ Cov(x_t | x_{t+1}, y_{1:t}) = P_{t|t} - P_{t|t} A^T P_{t+1|t}^{-1} A P_{t|t} $$\n我们定义平滑器增益矩阵 $G_t = P_{t|t} A^T P_{t+1|t}^{-1}$。\n\n平滑均值 $x_{t|T}$ 通过全期望定律求得：\n$$x_{t|T} = E[x_t | y_{1:T}] = E_{x_{t+1}|y_{1:T}} \\left[ E[x_t | x_{t+1}, y_{1:T}] \\right]$$\n$$x_{t|T} = E_{x_{t+1}|y_{1:T}} \\left[ x_{t|t} + G_t (x_{t+1} - x_{t+1|t}) \\right]$$\n$$x_{t|T} = x_{t|t} + G_t (E[x_{t+1} | y_{1:T}] - x_{t+1|t}) = x_{t|t} + G_t (x_{t+1|T} - x_{t+1|t})$$\n这是平滑均值的反向递归。\n\n平滑协方差 $P_{t|T}$ 通过全协方差定律求得：\n$$P_{t|T} = Cov(x_t | y_{1:T}) = E_{x_{t+1}|y_{1:T}} \\left[ Cov(x_t | x_{t+1}, y_{1:T}) \\right] + Cov_{x_{t+1}|y_{1:T}} \\left( E[x_t | x_{t+1}, y_{1:T}] \\right)$$\n第一项不依赖于 $x_{t+1}$，因此期望是平凡的：\n$$E[\\dots] = P_{t|t} - G_t A P_{t|t} = P_{t|t} - G_t (P_{t|t} A^T)^T = P_{t|t} - G_t (G_t P_{t+1|t})^T = P_{t|t} - G_t P_{t+1|t} G_t^T$$\n第二项是：\n$$Cov(\\dots) = Cov(x_{t|t} + G_t (x_{t+1} - x_{t+1|t}) | y_{1:T}) = G_t Cov(x_{t+1} | y_{1:T}) G_t^T = G_t P_{t+1|T} G_t^T$$\n将这些项合并，得到平滑协方差的反向递归：\n$$P_{t|T} = (P_{t|t} - G_t P_{t+1|t} G_t^T) + G_t P_{t+1|T} G_t^T = P_{t|t} + G_t (P_{t+1|T} - P_{t+1|t}) G_t^T$$\n\n**在问题上的应用**\n\n在这个问题中，$A$ 是单位矩阵，并且所有协方差矩阵 $Q, R, P_{t|t}$ 都是对角的。这意味着两个状态变量 $x_{t,1}$ 和 $x_{t,2}$ 的动力学是解耦的。卡尔曼滤波和平滑可以对每个标量分量独立进行。我们被要求计算 $(P_{1|3})_{11}$，即第一个分量的方差。我们将第一个分量的标量方差表示为 $p_{t|s} = (P_{t|s})_{11}$，过程噪声方差表示为 $q = Q_{11} = 0.09$。对于这个标量分量，当 $A=1$ 时，递归公式为：\n$$ p_{t+1|t} = p_{t|t} + q $$\n$$ g_t = p_{t|t} / p_{t+1|t} $$\n$$ p_{t|T} = p_{t|t} + g_t^2 (p_{t+1|T} - p_{t+1|t}) $$\n平滑从 $t=T-1=2$ 反向执行到 $t=1$。初始化为 $p_{3|3} = (P_{3|3})_{11} = 0.15$。\n\n**$t=2$ 时的平滑方差**：\n首先，我们使用前向过程中得到的滤波方差 $p_{2|2} = (P_{2|2})_{11} = 0.20$ 来计算预测方差 $p_{3|2}$。\n$$p_{3|2} = p_{2|2} + q = 0.20 + 0.09 = 0.29$$\n接下来，我们计算平滑器增益 $g_2$：\n$$g_2 = \\frac{p_{2|2}}{p_{3|2}} = \\frac{0.20}{0.29} = \\frac{20}{29}$$\n现在我们计算平滑方差 $p_{2|3}$：\n$$p_{2|3} = p_{2|2} + g_2^2 (p_{3|3} - p_{3|2}) = 0.20 + \\left(\\frac{20}{29}\\right)^2 (0.15 - 0.29)$$\n$$p_{2|3} = \\frac{1}{5} + \\frac{400}{841}(-0.14) = \\frac{1}{5} - \\frac{400}{841} \\frac{14}{100} = \\frac{1}{5} - \\frac{56}{841}$$\n$$p_{2|3} = \\frac{841 - 5 \\times 56}{5 \\times 841} = \\frac{841-280}{4205} = \\frac{561}{4205}$$\n\n**$t=1$ 时的平滑方差**：\n我们对 $t=1$ 重复此过程。首先，我们使用滤波方variance $p_{1|1} = (P_{1|1})_{11} = 0.25$ 来计算预测方差 $p_{2|1}$。\n$$p_{2|1} = p_{1|1} + q = 0.25 + 0.09 = 0.34$$\n接下来，我们计算平滑器增益 $g_1$：\n$$g_1 = \\frac{p_{1|1}}{p_{2|1}} = \\frac{0.25}{0.34} = \\frac{25}{34}$$\n现在我们计算最终的平滑方差 $p_{1|3}$：\n$$p_{1|3} = p_{1|1} + g_1^2 (p_{2|3} - p_{2|1})$$\n$$p_{1|3} = 0.25 + \\left(\\frac{25}{34}\\right)^2 \\left(\\frac{561}{4205} - 0.34\\right)$$\n$$p_{1|3} = \\frac{1}{4} + \\frac{625}{1156} \\left(\\frac{561}{4205} - \\frac{34}{100}\\right) = \\frac{1}{4} + \\frac{625}{1156} \\left(\\frac{561}{4205} - \\frac{17}{50}\\right)$$\n括号中的项是：\n$$\\frac{561 \\times 50 - 17 \\times 4205}{4205 \\times 50} = \\frac{28050 - 71485}{210250} = \\frac{-43435}{210250} = -\\frac{8687}{42050}$$\n将其代回：\n$$p_{1|3} = \\frac{1}{4} + \\frac{625}{1156} \\left(-\\frac{8687}{42050}\\right) = \\frac{1}{4} - \\frac{12775}{114376}$$\n最后，我们计算 $p_{1|3}$：\n$$p_{1|3} = \\frac{1}{4} - \\frac{12775}{114376} = \\frac{28594}{114376} - \\frac{12775}{114376} = \\frac{15819}{114376}$$\n分子可分解为 $3 \\times 5273$，而分母的因子是 $2$、$17$ 和 $29$。该分式不可约。",
            "answer": "$$\\boxed{\\frac{15819}{114376}}$$"
        }
    ]
}