{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, our first practice focuses on the fundamental properties of the graph Laplacian, which governs heat diffusion. Before solving complex dynamics, it is crucial to understand the inherent conservation laws of the system. This exercise will guide you through constructing the core matrices of a network model and using them to prove, from first principles, why the total \"heat\" or signal is conserved over time in a closed system . This is a cornerstone concept that ensures the stability and predictability of diffusion models.",
            "id": "3332495",
            "problem": "Consider a weighted, undirected protein-protein interaction (PPI) network with node set $\\{p_{1}, p_{2}, p_{3}, p_{4}\\}$, where an edge between $p_{i}$ and $p_{j}$ carries a nonnegative weight $w_{ij}$ indicating interaction strength. Assume there are no self-loops. The nonzero interaction weights are:\n- $w_{12} = 0.7$,\n- $w_{13} = 0.1$,\n- $w_{23} = 0.4$,\n- $w_{24} = 0.5$,\n- $w_{34} = 0.2$.\n\nUsing the node ordering $(p_{1}, p_{2}, p_{3}, p_{4})$:\n1. Construct the adjacency matrix $A \\in \\mathbb{R}^{4 \\times 4}$, where $A_{ij} = w_{ij}$ for $i \\neq j$ if the edge exists and $A_{ii} = 0$.\n2. Construct the degree matrix $D \\in \\mathbb{R}^{4 \\times 4}$, which is diagonal with entries $D_{ii} = \\sum_{j=1}^{4} A_{ij}$, and the degree vector $d \\in \\mathbb{R}^{4}$ with entries $d_{i} = D_{ii}$.\n3. Verify explicitly for each $i \\in \\{1,2,3,4\\}$ that $\\sum_{j=1}^{4} A_{ij} = D_{ii}$.\n\nDefine the combinatorial graph Laplacian $L = D - A$. Consider continuous-time heat diffusion on this network governed by the ordinary differential equation\n$\\frac{d}{dt} x(t) = - L \\, x(t)$\nwith the initial condition\n$x(0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix}$.\nUsing only fundamental definitions of $A$, $D$, and $L$, and the dynamical equation above (do not use any pre-stated conservation laws), derive from first principles whether the total heat $S(t) = \\mathbf{1}^{\\top} x(t)$ is conserved in time, where $\\mathbf{1} \\in \\mathbb{R}^{4}$ is the vector of all ones. Then, compute the constant value of $S(t)$ implied by your derivation.\n\nGive your final answer as a single real number with no units. Do not round; provide the exact value implied by the data above.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, internally consistent, and relies on standard definitions and principles within computational systems biology and network theory.\n\nThe problem asks us to determine if the total heat $S(t)$ is conserved for a diffusion process on a given protein-protein interaction (PPI) network and to compute its value if it is constant.\n\nFirst, we construct the adjacency matrix $A$ and the degree matrix $D$ based on the provided interaction weights and node ordering $(p_{1}, p_{2}, p_{3}, p_{4})$. The network is undirected, which implies that the adjacency matrix $A$ is symmetric, i.e., $A_{ij} = A_{ji}$. The nonzero weights are given as $w_{12} = 0.7$, $w_{13} = 0.1$, $w_{23} = 0.4$, $w_{24} = 0.5$, and $w_{34} = 0.2$. All diagonal elements $A_{ii}$ are zero.\n\nThe adjacency matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0 & w_{12} & w_{13} & w_{14} \\\\\nw_{21} & 0 & w_{23} & w_{24} \\\\\nw_{31} & w_{32} & 0 & w_{34} \\\\\nw_{41} & w_{42} & w_{43} & 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0.7 & 0.1 & 0 \\\\\n0.7 & 0 & 0.4 & 0.5 \\\\\n0.1 & 0.4 & 0 & 0.2 \\\\\n0 & 0.5 & 0.2 & 0\n\\end{pmatrix}\n$$\nNext, we construct the degree matrix $D$, which is a diagonal matrix where each diagonal element $D_{ii}$ is the sum of the weights of all edges connected to node $i$. This is equivalent to the sum of the entries in the $i$-th row of $A$. The problem asks for explicit verification of this definition.\n\nFor node $p_1$: $D_{11} = \\sum_{j=1}^{4} A_{1j} = A_{11} + A_{12} + A_{13} + A_{14} = 0 + 0.7 + 0.1 + 0 = 0.8$.\nFor node $p_2$: $D_{22} = \\sum_{j=1}^{4} A_{2j} = A_{21} + A_{22} + A_{23} + A_{24} = 0.7 + 0 + 0.4 + 0.5 = 1.6$.\nFor node $p_3$: $D_{33} = \\sum_{j=1}^{4} A_{3j} = A_{31} + A_{32} + A_{33} + A_{34} = 0.1 + 0.4 + 0 + 0.2 = 0.7$.\nFor node $p_4$: $D_{44} = \\sum_{j=1}^{4} A_{4j} = A_{41} + A_{42} + A_{43} + A_{44} = 0 + 0.5 + 0.2 + 0 = 0.7$.\n\nThis verifies the condition $\\sum_{j=1}^{4} A_{ij} = D_{ii}$ for each $i \\in \\{1,2,3,4\\}$. The degree vector is $d = \\begin{pmatrix} 0.8 & 1.6 & 0.7 & 0.7 \\end{pmatrix}^{\\top}$. The degree matrix $D$ is:\n$$\nD = \\begin{pmatrix}\n0.8 & 0 & 0 & 0 \\\\\n0 & 1.6 & 0 & 0 \\\\\n0 & 0 & 0.7 & 0 \\\\\n0 & 0 & 0 & 0.7\n\\end{pmatrix}\n$$\nThe combinatorial graph Laplacian is defined as $L = D - A$.\n\nThe total heat in the system at time $t$ is given by $S(t) = \\mathbf{1}^{\\top} x(t)$, where $\\mathbf{1} = \\begin{pmatrix} 1 & 1 & 1 & 1 \\end{pmatrix}^{\\top}$ is the vector of all ones and $x(t)$ is the vector of heat at each node. To determine if $S(t)$ is conserved, we must evaluate its time derivative, $\\frac{d}{dt}S(t)$. If the derivative is zero, the quantity is conserved.\n\nWe start by differentiating $S(t)$ with respect to time $t$:\n$$\n\\frac{d S(t)}{dt} = \\frac{d}{dt} \\left( \\mathbf{1}^{\\top} x(t) \\right)\n$$\nSince $\\mathbf{1}$ is a constant vector, we can move the differentiation operator inside:\n$$\n\\frac{d S(t)}{dt} = \\mathbf{1}^{\\top} \\frac{d x(t)}{dt}\n$$\nThe problem provides the governing differential equation for heat diffusion: $\\frac{d x(t)}{dt} = -L x(t)$. Substituting this into our expression for the derivative of $S(t)$:\n$$\n\\frac{d S(t)}{dt} = \\mathbf{1}^{\\top} \\left( -L x(t) \\right) = - ( \\mathbf{1}^{\\top} L ) x(t)\n$$\nTo proceed, we must evaluate the term $\\mathbf{1}^{\\top} L$. This is a row vector whose $j$-th component is the sum of the elements in the $j$-th column of the Laplacian matrix $L$.\nLet's analyze the sum of an arbitrary column $j$ of $L$:\n$$\n\\sum_{i=1}^{4} L_{ij} = \\sum_{i=1}^{4} (D_{ij} - A_{ij}) = \\sum_{i=1}^{4} D_{ij} - \\sum_{i=1}^{4} A_{ij}\n$$\nThe matrix $D$ is diagonal, so the sum over its $j$-th column, $\\sum_{i=1}^{4} D_{ij}$, has only one non-zero term, which is $D_{jj}$. By definition, $D_{jj} = \\sum_{k=1}^{4} A_{jk}$, which is the degree of node $j$.\nThe second term, $\\sum_{i=1}^{4} A_{ij}$, is the sum of the elements in the $j$-th column of the adjacency matrix $A$. Since the network is undirected, $A$ is a symmetric matrix ($A = A^{\\top}$), meaning $A_{ij} = A_{ji}$. Therefore, the sum of the elements in column $j$ is equal to the sum of the elements in row $j$:\n$$\n\\sum_{i=1}^{4} A_{ij} = \\sum_{i=1}^{4} A_{ji}\n$$\nThe sum of the elements in row $j$, $\\sum_{i=1}^{4} A_{ji}$, is precisely the definition of the degree of node $j$, which is $D_{jj}$.\nSubstituting these results back into the expression for the column sum of $L$:\n$$\n\\sum_{i=1}^{4} L_{ij} = D_{jj} - D_{jj} = 0\n$$\nThis holds for every column $j \\in \\{1,2,3,4\\}$. Therefore, each entry in the row vector $\\mathbf{1}^{\\top}L$ is zero, which means $\\mathbf{1}^{\\top}L = \\mathbf{0}^{\\top}$, the zero row vector.\n\nNow we can complete the evaluation of the time derivative of $S(t)$:\n$$\n\\frac{d S(t)}{dt} = - ( \\mathbf{1}^{\\top} L ) x(t) = - \\mathbf{0}^{\\top} x(t) = 0\n$$\nSince the time derivative of $S(t)$ is zero for all $t$, the total heat $S(t)$ is a conserved quantity. Its value is constant over time and is equal to its initial value, $S(0)$.\n\nWe compute this constant value using the given initial condition $x(0)$:\n$$\nx(0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix}\n$$\nThe total heat at $t=0$ is:\n$$\nS(0) = \\mathbf{1}^{\\top} x(0) = \\begin{pmatrix} 1 & 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix} = 1(1) + 1(2) + 1(0.5) + 1(1.5)\n$$\n$$\nS(0) = 1 + 2 + 0.5 + 1.5 = 5\n$$\nThus, the total heat $S(t)$ is conserved, and its constant value is $5$.",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "Building on the principle of conservation, we now explore how network topology directly shapes diffusion patterns. This practice uses a hypothetical network with two disconnected protein complexes to demonstrate a key application of network propagation: identifying functional modules. By solving the heat equation on this network, you will see precisely how the mathematical structure of the Laplacian matrix prevents information from flowing between isolated components, providing a clear and tangible link between graph theory and biological modularity .",
            "id": "3332574",
            "problem": "In a proteinâ€“protein interaction (PPI) network representing two disconnected protein complexes, heat diffusion is used to model the propagation of an initial perturbation from a single seed protein. The network has four proteins labeled $1,2,3,4$. Proteins $1$ and $2$ form one complex with a single interaction, and proteins $3$ and $4$ form another complex with a single interaction. There are no interactions between the two complexes. The unweighted adjacency matrix is\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix},\n$$\nand the degree matrix is\n$$\nD \\;=\\; \\operatorname{diag}(1,1,1,1).\n$$\nLet the combinatorial graph Laplacian be $L = D - A$. Consider a heat diffusion dynamics on the network under the following assumptions:\n- The total heat is conserved in the absence of sources and sinks.\n- The net flux between two interacting proteins is proportional to the difference in their heat levels.\n- The diffusion constant is scaled to $1$.\n- The initial heat is concentrated at the seed protein $1$, so the initial condition is the vector $u(0) = s$, where $s_1 = 1$ and $s_i = 0$ for $i \\neq 1$.\n\nStarting from these assumptions and definitions only, derive the linear dynamical system governing the evolution of the node-wise heat $u(t)$ on this network, solve it exactly, and use this solution to justify from first principles whether nodes $3$ and $4$ are affected by the seed at any time $t \\ge 0$. Then, compute explicitly the function $u_2(t)$ for all $t \\ge 0$ as a closed-form analytic expression. Report $u_2(t)$ as your final answer. Do not include any units in your final answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Network**: Four proteins (nodes) labeled $1, 2, 3, 4$.\n- **Structure**: Two disconnected complexes. One formed by proteins $1$ and $2$ with a single interaction. The other formed by proteins $3$ and $4$ with a single interaction. No interactions between complexes.\n- **Adjacency Matrix**: $A = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix}$.\n- **Degree Matrix**: $D = \\operatorname{diag}(1,1,1,1)$.\n- **Graph Laplacian**: The combinatorial graph Laplacian is $L = D - A$.\n- **Model**: Heat diffusion.\n- **Assumptions**:\n    1. The total heat is conserved.\n    2. The net flux between two interacting proteins is proportional to the difference in their heat levels.\n    3. The diffusion constant is scaled to $1$.\n- **Initial Condition**: $u(0) = s$, where $s$ is a vector with $s_1 = 1$ and $s_i = 0$ for $i \\in \\{2, 3, 4\\}$. This can be written as $s = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}^T$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes heat diffusion on a graph, a standard and well-established model in computational systems biology and network science for studying propagation phenomena. The model is based on firm mathematical and physical principles (Fick's laws of diffusion adapted to graphs).\n- **Well-Posed**: The problem provides a well-defined mathematical structure (a graph specified by its adjacency matrix), a clear physical model (the heat equation on the graph), and a specific initial condition. This constitutes a standard initial value problem for a system of linear ordinary differential equations, which has a unique, stable, and meaningful solution.\n- **Objective**: The problem is stated using precise mathematical language and definitions, free of any subjectivity or ambiguity. The provided matrices $A$ and $D$ correctly represent the described network structure. The requested tasks are specific and verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, objective, and self-contained. The solution process can proceed.\n\n### Derivation of the Dynamical System\nLet $u_i(t)$ be the heat level at node $i$ at time $t$. The vector of heat levels is $u(t) = \\begin{pmatrix} u_1(t) & u_2(t) & u_3(t) & u_4(t) \\end{pmatrix}^T$.\nThe assumption \"the net flux between two interacting proteins is proportional to the difference in their heat levels\" with a diffusion constant of $1$ means the flux from node $j$ to an adjacent node $i$ is given by $u_j - u_i$.\nThe rate of change of heat at node $i$, $\\frac{du_i}{dt}$, is the sum of fluxes from all its neighbors. For a general network with adjacency matrix $A$, the neighbors of node $i$ are the set of nodes $j$ for which $A_{ij}=1$.\n$$ \\frac{du_i}{dt} = \\sum_{j=1}^{4} A_{ij} (u_j(t) - u_i(t)) $$\nThis can be expanded as:\n$$ \\frac{du_i}{dt} = \\sum_{j=1}^{4} A_{ij} u_j(t) - u_i(t) \\sum_{j=1}^{4} A_{ij} $$\nThe first term, $\\sum_{j=1}^{4} A_{ij} u_j(t)$, is the $i$-th component of the vector product $A u(t)$.\nThe second term contains the sum $\\sum_{j=1}^{4} A_{ij}$, which is the degree of node $i$, denoted $d_i$. The matrix $D$ is the diagonal matrix of node degrees, $D_{ii} = d_i$. Thus, the term $u_i(t) d_i$ is the $i$-th component of the vector product $D u(t)$.\nSo, the equation for a single node is $\\frac{du_i}{dt} = (A u(t))_i - (D u(t))_i$.\nWriting this for all nodes in vector form, we get the linear dynamical system:\n$$ \\frac{du(t)}{dt} = A u(t) - D u(t) = (A - D) u(t) $$\nThe combinatorial graph Laplacian is defined as $L = D - A$. Therefore, the system is:\n$$ \\frac{du(t)}{dt} = -L u(t) $$\nThis is the heat equation on the graph.\n\n### Solving the System\nThe solution to this linear system of ordinary differential equations with the initial condition $u(0) = s$ is given by the matrix exponential:\n$$ u(t) = \\exp(-Lt) u(0) = \\exp(-Lt) s $$\nFirst, we compute the Laplacian matrix $L$:\n$$ L = D - A = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ -1 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\\\ 0 & 0 & -1 & 1 \\end{pmatrix} $$\nThe Laplacian $L$ is a block-diagonal matrix: $L = \\begin{pmatrix} L_c & 0 \\\\ 0 & L_c \\end{pmatrix}$, where $L_c = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$. This block structure reflects the fact that the network consists of two disconnected components: $\\{1, 2\\}$ and $\\{3, 4\\}$.\n\n### Justification for Nodes $3$ and $4$\nThe block-diagonal nature of $L$ decouples the system of differential equations. Let $u_{12}(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ and $u_{34}(t) = \\begin{pmatrix} u_3(t) \\\\ u_4(t) \\end{pmatrix}$. The system $\\frac{du}{dt} = -Lu$ can be written as two independent systems:\n$$ \\frac{du_{12}(t)}{dt} = -L_c u_{12}(t) $$\n$$ \\frac{du_{34}(t)}{dt} = -L_c u_{34}(t) $$\nThe initial condition is $u(0) = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}^T$. This means $u_{12}(0) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ and $u_{34}(0) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nThe second system, for nodes $3$ and $4$, is $\\frac{du_{34}(t)}{dt} = -L_c u_{34}(t)$ with the initial condition $u_{34}(0) = 0$. The unique solution to this homogeneous initial value problem is the trivial solution $u_{34}(t) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ for all $t \\ge 0$.\nTherefore, $u_3(t) = 0$ and $u_4(t) = 0$ for all $t \\ge 0$. The initial heat at node $1$ never reaches nodes $3$ and $4$ because there is no path in the network connecting component $\\{1, 2\\}$ to component $\\{3, 4\\}$.\n\n### Explicit Solution for $u_2(t)$\nWe need to solve the first system for $u_{12}(t)$:\n$$ \\frac{du_{12}(t)}{dt} = -L_c u_{12}(t), \\quad u_{12}(0) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\nThe solution is $u_{12}(t) = \\exp(-L_c t) u_{12}(0)$. We need to compute the matrix exponential $\\exp(-L_c t)$. We do this by diagonalizing $L_c = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nThe characteristic equation is $\\det(L_c - \\lambda I) = (1-\\lambda)^2 - (-1)^2 = \\lambda^2 - 2\\lambda = 0$, which gives eigenvalues $\\lambda_1 = 0$ and $\\lambda_2 = 2$.\nThe corresponding orthonormal eigenvectors are $v_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ for $\\lambda_1=0$, and $v_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ for $\\lambda_2=2$.\nThe diagonalization of $L_c$ is $L_c = P \\Lambda P^T$, where $P = \\begin{pmatrix} v_1 & v_2 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$ and $\\Lambda = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix}$.\nThe matrix exponential is $\\exp(-L_c t) = P \\exp(-\\Lambda t) P^T$.\n$$ \\exp(-\\Lambda t) = \\begin{pmatrix} \\exp(-0 \\cdot t) & 0 \\\\ 0 & \\exp(-2t) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\exp(-2t) \\end{pmatrix} $$\nNow we compute the product:\n$$ \\exp(-L_c t) = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & \\exp(-2t) \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\n$$ = \\frac{1}{2} \\begin{pmatrix} 1 & \\exp(-2t) \\\\ 1 & -\\exp(-2t) \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\n$$ = \\frac{1}{2} \\begin{pmatrix} 1 + \\exp(-2t) & 1 - \\exp(-2t) \\\\ 1 - \\exp(-2t) & 1 + \\exp(-2t) \\end{pmatrix} $$\nFinally, we compute $u_{12}(t)$:\n$$ u_{12}(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix} = \\exp(-L_c t) u_{12}(0) = \\frac{1}{2} \\begin{pmatrix} 1 + \\exp(-2t) & 1 - \\exp(-2t) \\\\ 1 - \\exp(-2t) & 1 + \\exp(-2t) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n$$ = \\frac{1}{2} \\begin{pmatrix} 1 + \\exp(-2t) \\\\ 1 - \\exp(-2t) \\end{pmatrix} $$\nThe function for the heat at node $2$ is the second component of this vector:\n$$ u_2(t) = \\frac{1}{2} (1 - \\exp(-2t)) $$\nThis solution shows that as $t \\to 0$, $u_2(t) \\to \\frac{1}{2}(1-1) = 0$, matching the initial condition. As $t \\to \\infty$, heat diffuses completely within the component, so $u_2(t) \\to \\frac{1}{2}$. This is expected, as the total initial heat of $1$ is conserved within the component $\\{1, 2\\}$, and at equilibrium it is distributed evenly between the two nodes.",
            "answer": "$$\\boxed{\\frac{1}{2}(1 - \\exp(-2t))}$$"
        },
        {
            "introduction": "Our final practice advances to a more complex and practical scenario, comparing continuous-time heat diffusion with another powerful algorithm, Random Walk with Restart (RWR). While heat diffusion models propagation in continuous time, RWR operates in discrete steps, yet they share a deep theoretical connection. This exercise challenges you to derive the mathematical relationship that equates their \"smoothing\" levels and then implement a numerical comparison . This task bridges theory and application, reflecting the type of model comparison and validation common in computational systems biology research.",
            "id": "3332580",
            "problem": "Consider an undirected biological interaction network represented by a nonnegative, symmetric adjacency matrix $A \\in \\mathbb{R}^{n \\times n}$ and a nonnegative seed vector $f \\in \\mathbb{R}^{n}$ with $\\sum_{i=1}^{n} f_i = 1$. Let the degree matrix be $D = \\mathrm{diag}(d_1,\\dots,d_n)$ with $d_i = \\sum_{j=1}^{n} A_{ij}$, and define the row-stochastic transition matrix $P = D^{-1} A$ under the convention that if $d_i = 0$ then the $i$-th row of $P$ is the zero row. The random-walk normalized Laplacian is $L_{\\mathrm{rw}} = I - P$. Continuous-time diffusion on the network is governed by the graph heat equation $\\frac{d}{dt} u(t) = - L_{\\mathrm{rw}} u(t)$, with solution $u(t) = \\exp(- t L_{\\mathrm{rw}}) f$. The Random Walk with Restart (RWR) process is defined by the iterative update $u_{k+1} = (1 - \\alpha) f + \\alpha P u_k$ for a restart parameter $\\alpha \\in [0,1)$, initialized at $u_0 = f$, and converges to a steady state $u_{\\mathrm{RWR}}$.\n\nStarting only from these definitions and the properties that $P$ is row-stochastic and $L_{\\mathrm{rw}}$ generates a stable semigroup, derive and implement an algorithm that computes $u_{\\mathrm{RWR}}$ for a given $\\alpha$ and compares it to $u(t)$ at a matched smoothing level $t$. To match smoothing levels between the geometric path-length weighting implicit in Random Walk with Restart and the Poisson path-length weighting implicit in the heat kernel, choose $t$ by equating the expected number of propagation steps under both weightings.\n\nUse the following concrete instance for testing:\n- Network size is $n = 5$.\n- The adjacency matrix $A$ is\n$$\nA =\n\\begin{bmatrix}\n0 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & \\tfrac{1}{2} & 0 \\\\\n0 & 0 & \\tfrac{1}{2} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0\n\\end{bmatrix}.\n$$\n- The seed vector is\n$$\nf = \\begin{bmatrix} \\tfrac{1}{2} \\\\ 0 \\\\ 0 \\\\ 0 \\\\ \\tfrac{1}{2} \\end{bmatrix}.\n$$\n- The test suite for the restart parameter consists of $\\alpha \\in \\left\\{ 0, \\tfrac{1}{2}, \\tfrac{9}{10}, \\tfrac{99}{100} \\right\\}$.\n\nYour program must, for each $\\alpha$ in the test suite, compute:\n1. The steady-state Random Walk with Restart vector $u_{\\mathrm{RWR}}$ obtained by numerically solving the fixed-point equation defined by the update $u_{k+1} = (1 - \\alpha) f + \\alpha P u_k$.\n2. The continuous-time diffusion vector $u(t)$ at the matched smoothing level $t$ obtained by equating expected path lengths as described above.\n3. The Euclidean norm difference $\\|u_{\\mathrm{RWR}} - u(t)\\|_2$ as a real number.\n\nAll quantities are dimensionless, so no physical units are required. Your program should produce a single line of output containing the results for the test suite as a comma-separated list of real numbers rounded to six decimal places and enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4]$ where each $x_i$ is the computed $\\|u_{\\mathrm{RWR}} - u(t)\\|_2$ for the corresponding $\\alpha$ in the order given.",
            "solution": "The problem asks for a derivation and implementation of an algorithm to compare the steady-state solution of Random Walk with Restart ($u_{\\mathrm{RWR}}$) with the solution of a continuous-time heat diffusion process ($u(t)$) on a network, where the time parameter $t$ is chosen to match the smoothing level of the RWR process.\n\n### Step 1: Formalization and Calculation of Network Matrices\n\nFirst, we formalize the network representations based on the provided adjacency matrix $A$.\n\nThe adjacency matrix is given as:\n$$\nA =\n\\begin{bmatrix}\n0 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & \\tfrac{1}{2} & 0 \\\\\n0 & 0 & \\tfrac{1}{2} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0\n\\end{bmatrix}\n$$\nThe seed vector is $f = [\\tfrac{1}{2}, 0, 0, 0, \\tfrac{1}{2}]^T$.\n\nThe degree of each node $i$ is $d_i = \\sum_{j=1}^{n} A_{ij}$.\n$d_1 = 1$\n$d_2 = 1 + 1 = 2$\n$d_3 = 1 + \\tfrac{1}{2} = \\tfrac{3}{2}$\n$d_4 = \\tfrac{1}{2}$\n$d_5 = 0$\n\nThe degree matrix $D$ is the diagonal matrix of these degrees:\n$$ D = \\mathrm{diag}(1, 2, \\tfrac{3}{2}, \\tfrac{1}{2}, 0) $$\nIts inverse $D^{-1}$ is defined with the convention that if $d_i = 0$, the corresponding entry is $0$ to avoid division by zero. This convention is applied when calculating the transition matrix $P$.\n$$ D^{-1} = \\mathrm{diag}(1, \\tfrac{1}{2}, \\tfrac{2}{3}, 2, 0) $$\n\nThe row-stochastic transition matrix $P = D^{-1} A$ is:\n$$\nP =\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & 0 \\\\\n0 & \\tfrac{1}{2} & 0 & 0 & 0 \\\\\n0 & 0 & \\tfrac{2}{3} & 0 & 0 \\\\\n0 & 0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 0 & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n0 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & \\tfrac{1}{2} & 0 \\\\\n0 & 0 & \\tfrac{1}{2} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 & 1 & 0 & 0 & 0 \\\\\n\\tfrac{1}{2} & 0 & \\tfrac{1}{2} & 0 & 0 \\\\\n0 & \\tfrac{2}{3} & 0 & \\tfrac{1}{3} & 0 \\\\\n0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0\n\\end{bmatrix}\n$$\nNote that the rows of $P$ sum to $1$ for nodes with non-zero degree, and the row for the isolated node (node $5$) is all zeros.\n\nThe random-walk normalized Laplacian $L_{\\mathrm{rw}} = I - P$ is:\n$$\nL_{\\mathrm{rw}} =\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 1\n\\end{bmatrix}\n-\n\\begin{bmatrix}\n0 & 1 & 0 & 0 & 0 \\\\\n\\tfrac{1}{2} & 0 & \\tfrac{1}{2} & 0 & 0 \\\\\n0 & \\tfrac{2}{3} & 0 & \\tfrac{1}{3} & 0 \\\\\n0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1 & -1 & 0 & 0 & 0 \\\\\n-\\tfrac{1}{2} & 1 & -\\tfrac{1}{2} & 0 & 0 \\\\\n0 & -\\tfrac{2}{3} & 1 & -\\tfrac{1}{3} & 0 \\\\\n0 & 0 & -1 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 1\n\\end{bmatrix}\n$$\n\n### Step 2: Deriving the Random Walk with Restart (RWR) Solution\n\nThe RWR process is defined by the iterative update $u_{k+1} = (1 - \\alpha) f + \\alpha P u_k$. The steady-state solution $u_{\\mathrm{RWR}}$ is the fixed point of this iteration, satisfying:\n$$ u_{\\mathrm{RWR}} = (1 - \\alpha) f + \\alpha P u_{\\mathrm{RWR}} $$\nThis is a linear equation for $u_{\\mathrm{RWR}}$. Rearranging the terms, we get:\n$$ u_{\\mathrm{RWR}} - \\alpha P u_{\\mathrm{RWR}} = (1 - \\alpha) f $$\n$$ (I - \\alpha P) u_{\\mathrm{RWR}} = (1 - \\alpha) f $$\nFor $\\alpha \\in [0, 1)$, the matrix $(I - \\alpha P)$ is guaranteed to be invertible. Thus, we can solve for $u_{\\mathrm{RWR}}$ directly:\n$$ u_{\\mathrm{RWR}} = (1 - \\alpha) (I - \\alpha P)^{-1} f $$\nThis equation provides a direct method for computing $u_{\\mathrm{RWR}}$ by solving a linear system, which is numerically preferable to iterating until convergence.\n\n### Step 3: Deriving the Matching Condition for Smoothing Levels\n\nThe core of the problem is to find a time $t$ for heat diffusion that corresponds to the restart parameter $\\alpha$ of RWR. This is achieved by equating the expected number of propagation steps implicit in both models.\n\n**Path Weighting in RWR:**\nThe term $(I - \\alpha P)^{-1}$ can be expanded as a Neumann series for $\\|\\alpha P\\| < 1$, which holds since $\\alpha < 1$ and $P$ is row-stochastic.\n$$ (I - \\alpha P)^{-1} = \\sum_{k=0}^{\\infty} (\\alpha P)^k = I + \\alpha P + \\alpha^2 P^2 + \\dots $$\nSubstituting this into the solution for $u_{\\mathrm{RWR}}$:\n$$ u_{\\mathrm{RWR}} = (1 - \\alpha) \\sum_{k=0}^{\\infty} \\alpha^k P^k f $$\nThis expression reveals that $u_{\\mathrm{RWR}}$ is a weighted sum over random walks of all possible lengths $k$. The term $P^k f$ represents the distribution of the random walk after $k$ steps. The weight associated with a path of length $k$ is proportional to $\\alpha^k$. The sequence of normalized weights is $w_k^{\\mathrm{RWR}} = (1 - \\alpha)\\alpha^k$ for $k=0, 1, 2, \\dots$. This is a geometric distribution. The expected path length is the mean of this distribution:\n$$ \\mathbb{E}[k]_{\\mathrm{RWR}} = \\sum_{k=0}^{\\infty} k \\cdot w_k^{\\mathrm{RWR}} = \\sum_{k=0}^{\\infty} k (1 - \\alpha) \\alpha^k = (1 - \\alpha) \\sum_{k=0}^{\\infty} k \\alpha^k $$\nThe sum is a known series result: $\\sum_{k=0}^{\\infty} k x^k = \\frac{x}{(1-x)^2}$ for $|x|<1$.\n$$ \\mathbb{E}[k]_{\\mathrm{RWR}} = (1 - \\alpha) \\frac{\\alpha}{(1 - \\alpha)^2} = \\frac{\\alpha}{1 - \\alpha} $$\n\n**Path Weighting in Heat Diffusion:**\nThe solution to the heat diffusion equation is $u(t) = \\exp(-t L_{\\mathrm{rw}}) f$. Substituting $L_{\\mathrm{rw}} = I - P$:\n$$ u(t) = \\exp(-t(I - P))f = \\exp(-tI)\\exp(tP)f = e^{-t} \\exp(tP) f $$\nWe expand the matrix exponential $\\exp(tP)$ using its Taylor series definition:\n$$ \\exp(tP) = \\sum_{k=0}^{\\infty} \\frac{(tP)^k}{k!} = \\sum_{k=0}^{\\infty} \\frac{t^k}{k!} P^k $$\nSubstituting this into the solution for $u(t)$:\n$$ u(t) = e^{-t} \\sum_{k=0}^{\\infty} \\frac{t^k}{k!} P^k f $$\nSimilar to RWR, this shows $u(t)$ is a weighted sum over random walks of length $k$. The weights are $w_k^{\\mathrm{Heat}} = e^{-t} \\frac{t^k}{k!}$, which define a Poisson distribution with parameter $\\lambda = t$. The expected value (mean) of a Poisson distribution is its parameter $\\lambda$.\n$$ \\mathbb{E}[k]_{\\mathrm{Heat}} = t $$\n\n**Matching Condition:**\nBy equating the expected number of propagation steps for both processes, we establish the correspondence between $\\alpha$ and $t$:\n$$ \\mathbb{E}[k]_{\\mathrm{RWR}} = \\mathbb{E}[k]_{\\mathrm{Heat}} $$\n$$ \\frac{\\alpha}{1 - \\alpha} = t $$\nThis relationship allows us to compare the two processes at equivalent levels of propagation or smoothing.\n\n### Step 4: Algorithm Summary\n\nFor each given value of $\\alpha$ in the test suite $\\{0, \\tfrac{1}{2}, \\tfrac{9}{10}, \\tfrac{99}{100}\\}$:\n1.  **Compute $u_{\\mathrm{RWR}}$**: Solve the linear system $(I - \\alpha P) u_{\\mathrm{RWR}} = (1 - \\alpha) f$.\n2.  **Determine Matched Time $t$**: Calculate $t = \\frac{\\alpha}{1 - \\alpha}$. For the special case $\\alpha = 0$, $t = 0$.\n3.  **Compute $u(t)$**: Calculate the vector $u(t) = \\exp(-t L_{\\mathrm{rw}}) f$. This involves computing the matrix exponential of $-t L_{\\mathrm{rw}}$.\n4.  **Compute Difference**: Calculate the Euclidean norm of the difference vector, $\\|u_{\\mathrm{RWR}} - u(t)\\|_2$.\n\nThis procedure will be implemented for each value of $\\alpha$ to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the difference between Random Walk with Restart (RWR) and heat diffusion\n    at matched smoothing levels for a given biological network.\n    \"\"\"\n    # Define the problem instance based on the provided statement.\n    n = 5\n    A = np.array([\n        [0.0, 1.0, 0.0, 0.0, 0.0],\n        [1.0, 0.0, 1.0, 0.0, 0.0],\n        [0.0, 1.0, 0.0, 0.5, 0.0],\n        [0.0, 0.0, 0.5, 0.0, 0.0],\n        [0.0, 0.0, 0.0, 0.0, 0.0]\n    ])\n    \n    f = np.array([0.5, 0.0, 0.0, 0.0, 0.5])\n    \n    # The test suite for the restart parameter alpha.\n    test_suite_alpha = [0.0, 0.5, 0.9, 0.99]\n\n    # --- Step 1: Calculate network matrices ---\n    # Calculate degree vector d from the adjacency matrix A.\n    d = A.sum(axis=1)\n    \n    # Calculate the inverse of the degree matrix D, handling nodes with zero degree.\n    # The problem specifies that if d_i=0, the i-th row of P is zero, which is\n    # achieved by having d_inv_ii = 0 for d_i = 0.\n    d_inv_diag = np.zeros_like(d)\n    non_zero_mask = d != 0\n    d_inv_diag[non_zero_mask] = 1.0 / d[non_zero_mask]\n    \n    # Construct the transition matrix P = D^-1 * A.\n    # D_inv is a diagonal matrix, so we can multiply row-wise.\n    P = np.diag(d_inv_diag) @ A\n    \n    # Construct the random-walk normalized Laplacian L_rw = I - P.\n    L_rw = np.identity(n) - P\n\n    results = []\n    \n    for alpha in test_suite_alpha:\n        # --- Step 2: Compute u_RWR ---\n        # The steady-state RWR vector u_RWR is found by solving the linear system:\n        # (I - alpha * P) * u_RWR = (1 - alpha) * f\n        matrix_lhs = np.identity(n) - alpha * P\n        vector_rhs = (1 - alpha) * f\n        u_rwr = np.linalg.solve(matrix_lhs, vector_rhs)\n\n        # --- Step 3: Compute u(t) at matched smoothing level ---\n        # The smoothing level is matched by equating expected path lengths, giving:\n        # t = alpha / (1 - alpha)\n        # Handle the case alpha=1 to avoid division by zero, though problem states alpha < 1.\n        if alpha < 1.0:\n            t = alpha / (1.0 - alpha)\n        else: # Should not be reached based on problem description.\n            t = np.inf\n\n        # The heat diffusion solution is u(t) = exp(-t * L_rw) * f.\n        # We use scipy.linalg.expm for robust matrix exponential computation.\n        matrix_to_exponentiate = -t * L_rw\n        matrix_exponential = expm(matrix_to_exponentiate)\n        u_t = matrix_exponential @ f\n        \n        # --- Step 4: Compute the Euclidean norm of the difference ---\n        diff_norm = np.linalg.norm(u_rwr - u_t)\n        results.append(diff_norm)\n\n    # Final print statement in the exact required format.\n    # The results are rounded to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}