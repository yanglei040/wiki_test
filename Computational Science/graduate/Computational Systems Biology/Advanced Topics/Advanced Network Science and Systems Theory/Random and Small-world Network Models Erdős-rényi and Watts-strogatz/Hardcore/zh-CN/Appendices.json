{
    "hands_on_practices": [
        {
            "introduction": "在随机图论中，期望的线性性质是一个极其强大的工具，它使我们能够轻松计算复杂的全局属性。本练习将指导您应用此原理来计算 Erdős-Rényi (ER) 随机图中一些基本子图——边、三角形和四元环——的期望数量 。掌握这项技能对于建立基准或“零模型”至关重要，从而可以判断在真实生物网络中观察到的网络基序（motif）是否具有统计显著性。",
            "id": "3342456",
            "problem": "在计算系统生物学中，随机图零模型有助于评估细胞网络（例如蛋白质-蛋白质相互作用网络）中观测到的模体丰度是否偏离了随机情况。考虑建立在 $n$ 个标记顶点上的 Erdős–Rényi (ER) 模型 $G(n,p)$，其中每条可能的无向边都以概率 $p \\in (0,1)$ 独立出现。设 $m$ 表示边的总数，$T$ 表示三角形（简单3-圈）的总数，$C_4$ 表示简单无向4-圈的总数。对于 $C_4$，每个不同的简单无向4-圈只计数一次，无论其遍历方向或起始顶点如何；该圈不必是导出的，因此这4个顶点之间的额外弦不影响计数。\n\n仅从 $G(n,p)$ 的核心定义和期望的线性性出发，为期望 $\\mathbb{E}[m]$、$\\mathbb{E}[T]$ 和 $\\mathbb{E}[C_4]$ 推导关于 $n$ 和 $p$ 的闭式表达式。将最终答案表示为仅包含 $n$ 和 $p$ 的闭式解析表达式。不需要进行数值近似。最终答案必须是单个对象：将三个表达式按 $\\mathbb{E}[m]$、$\\mathbb{E}[T]$、$\\mathbb{E}[C_4]$ 的顺序列在一个单行矩阵中。",
            "solution": "我们从 Erdős–Rényi (ER) 模型 $G(n,p)$ 的定义开始：对于一个大小为 $n$ 的标记顶点集，$\\binom{n}{2}$ 条可能的无向边中的每一条都以概率 $p \\in (0,1)$ 独立存在。我们使用指示随机变量和期望的线性性来计算子图的期望计数。\n\n首先，计算边的期望数量 $\\mathbb{E}[m]$。设 $X_{e}$ 为特定无向边 $e$ 存在的指示变量。则 $m = \\sum_{e} X_{e}$，其中求和遍历所有 $\\binom{n}{2}$ 条可能的边。根据独立性和 $G(n,p)$ 的定义，$\\mathbb{P}(X_{e}=1)=p$，因此 $\\mathbb{E}[X_{e}] = p$。根据期望的线性性，\n$$\n\\mathbb{E}[m] \\;=\\; \\sum_{e} \\mathbb{E}[X_{e}] \\;=\\; \\binom{n}{2}\\, p.\n$$\n\n其次，计算三角形的期望数量 $\\mathbb{E}[T]$。一个三角形由一个包含3个元素的顶点子集确定。对于每个无序三元组 $\\{i,j,k\\}$，定义一个指示变量 $Y_{\\{i,j,k\\}}$，表示这三个顶点之间的三条边都存在。由于这3条边中的每一条都以概率 $p$ 独立出现，我们有 $\\mathbb{P}(Y_{\\{i,j,k\\}}=1)=p^{3}$，所以 $\\mathbb{E}[Y_{\\{i,j,k\\}}]=p^{3}$。无序三元组的总数为 $\\binom{n}{3}$。因此，\n$$\n\\mathbb{E}[T] \\;=\\; \\sum_{\\{i,j,k\\}} \\mathbb{E}[Y_{\\{i,j,k\\}}]\n\\;=\\; \\binom{n}{3}\\, p^{3}.\n$$\n\n第三，计算简单无向4-圈的期望数量 $\\mathbb{E}[C_4]$，计数时不考虑方向或起点，且不要求是导出的。有两种等价的计数方法。\n\n方法1（通过有序圈和自同构因子）：考虑由不同顶点组成的有序4元组 $(v_{1},v_{2},v_{3},v_{4})$。$v_1$ 有 $n$ 个选择，$v_2$ 有 $(n-1)$ 个选择，$v_3$ 有 $(n-2)$ 个选择，$v_4$ 有 $(n-3)$ 个选择，总共产生 $n(n-1)(n-2)(n-3)$ 个有序元组。当且仅当 $\\{v_{1},v_{2}\\}$、$\\{v_{2},v_{3}\\}$、$\\{v_{3},v_{4}\\}$ 和 $\\{v_{4},v_{1}\\}$ 这4条边都存在时，每个这样的有序元组确定一个有向简单4-圈。这4条边独立出现，概率为 $p^4$，因此有序简单4-圈的期望数量是 $n(n-1)(n-2)(n-3)\\, p^{4}$。每个无向4-圈都对应着恰好8个有序元组（有4种旋转和2种方向），即圈的自同构群的大小为8。因此，\n$$\n\\mathbb{E}[C_4] \\;=\\; \\frac{n(n-1)(n-2)(n-3)}{8}\\, p^{4}.\n$$\n\n方法2（通过4顶点子集）：对于每个包含4个元素的顶点子集，在该顶点集上恰好有3个不同的简单无向4-圈（4个标记顶点上的哈密顿圈在旋转和反射下等价的数量为3）。对于任何一个这样的无向圈，其所需的4条边都存在的概率是 $p^{4}$（边是独立的）。对 $\\binom{n}{4}$ 个顶点子集以及每个子集上的3个圈求和，\n$$\n\\mathbb{E}[C_4] \\;=\\; 3 \\binom{n}{4} \\, p^{4}\n\\;=\\; \\frac{n(n-1)(n-2)(n-3)}{8}\\, p^{4},\n$$\n这与方法1的结果一致，因为 $3 \\binom{n}{4} = \\frac{n(n-1)(n-2)(n-3)}{8}$。\n\n综合以上结果，\n$$\n\\mathbb{E}[m] \\;=\\; \\binom{n}{2} p,\\quad\n\\mathbb{E}[T] \\;=\\; \\binom{n}{3} p^{3},\\quad\n\\mathbb{E}[C_4] \\;=\\; \\frac{n(n-1)(n-2)(n-3)}{8} p^{4}.\n$$\n这些表达式是关于 $n$ 和 $p$ 的闭式表达式，并且仅依赖于 $G(n,p)$ 的独立性结构和期望的线性性。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\binom{n}{2}\\, p  \\binom{n}{3}\\, p^{3}  \\dfrac{n(n-1)(n-2)(n-3)}{8}\\, p^{4}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在计算了基本期望值之后，我们深入探讨网络在节点数 $n$ 趋于无穷大时的行为。本练习将重点分析稀疏 ER 图中孤立节点的期望数量，这是一种典型的渐近分析 。这类分析对于理解“巨型连通分支”的出现等相变现象至关重要，这些现象在生物学和流行病学中（例如疾病在人群中的传播）都有直接的对应物。",
            "id": "3342524",
            "problem": "考虑一个计算系统生物学中的阈值基因共表达网络，该网络被建模为一个 Erdős-Rényi (ER) 随机图 $G(n,p)$，其中 $n$ 表示基因的数量，每对不同的基因以概率 $p$ 独立连接。如果一个基因的度为零，则称该基因为孤立基因。仅从 $G(n,p)$ 的定义性质和基础概率出发，推导孤立基因的期望数（记为 $\\mathbb{E}[N_{0}]$），并用 $n$ 和 $p$ 表示。然后，在 $p=\\frac{c}{n}$（其中 $c0$ 且与 $n$ 无关）的稀疏机制下，当 $n\\to\\infty$ 时，求出 $\\mathbb{E}[N_{0}]$ 的领头阶渐进行为。将你的最终答案表示为关于 $n$ 和 $c$ 的单个闭式解析表达式。无需四舍五入，不涉及物理单位。仅提供渐进表达式作为你的最终答案。",
            "solution": "该问题要求计算 Erdős-Rényi (ER) 随机图 $G(n,p)$ 中孤立基因的期望数，以及在特定稀疏机制下其领头阶渐进行为。所给问题具有科学依据，提法明确且客观。我将进行完整的推导。\n\n设顶点（基因）集合为 $V = \\{1, 2, \\dots, n\\}$。该图是一个 ER 随机图 $G(n,p)$，其中任意两个不同顶点 $i, j \\in V$ 之间存在一条边的概率为 $p$，且与其他所有边独立。孤立基因是度为 $0$ 的顶点。令 $N_{0}$ 为表示图中孤立基因总数的随机变量。\n\n为了求出 $N_{0}$ 的期望值，记为 $\\mathbb{E}[N_{0}]$，我们使用指示变量法。对于每个基因 $i \\in V$，令 $X_i$ 为一个指示随机变量，使得：\n$$\nX_i = \n\\begin{cases} \n1  \\text{如果基因 } i \\text{ 是孤立的} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n孤立基因的总数是这些指示变量的和：\n$$\nN_{0} = \\sum_{i=1}^{n} X_i\n$$\n根据期望的线性性，孤立基因的期望数是各个指示变量期望的和：\n$$\n\\mathbb{E}[N_{0}] = \\mathbb{E}\\left[\\sum_{i=1}^{n} X_i\\right] = \\sum_{i=1}^{n} \\mathbb{E}[X_i]\n$$\n一个指示变量的期望就是它所指示事件的概率。因此，对于任意基因 $i$：\n$$\n\\mathbb{E}[X_i] = 1 \\cdot P(X_i = 1) + 0 \\cdot P(X_i = 0) = P(X_i = 1)\n$$\n$P(X_i = 1)$ 是基因 $i$ 是孤立的概率。要使基因 $i$ 孤立，它必须与网络中其他任何 $n-1$ 个基因都没有边相连。我们考虑一个特定的基因 $j \\neq i$。基因 $i$ 和基因 $j$ 之间*不*存在边的概率是 $1-p$。由于每条潜在边的存在都是一个独立事件，因此基因 $i$ 与其他任何 $n-1$ 个基因都不相连的概率是这 $n-1$ 个不连接事件概率的乘积：\n$$\nP(X_i = 1) = (1-p) \\times (1-p) \\times \\dots \\times (1-p) \\quad (n-1 \\text{ 次})\n$$\n$$\nP(X_i = 1) = (1-p)^{n-1}\n$$\n由于 $G(n,p)$ 模型的对称性，这个概率对于每个基因 $i \\in \\{1, 2, \\dots, n\\}$ 都是相同的。因此，对于所有的 $i$，$\\mathbb{E}[X_i] = (1-p)^{n-1}$。\n将此结果代回 $\\mathbb{E}[N_{0}]$ 的求和式中：\n$$\n\\mathbb{E}[N_{0}] = \\sum_{i=1}^{n} (1-p)^{n-1} = n(1-p)^{n-1}\n$$\n这就是 $G(n,p)$ 随机图中孤立基因期望数的精确表达式。\n\n接下来，我们被要求在稀疏机制下（其中 $p = \\frac{c}{n}$，对于某个常数 $c0$），当基因数量 $n$ 趋于无穷大（$n \\to \\infty$）时，求 $\\mathbb{E}[N_{0}]$ 的领头阶渐进行为。\n我们将 $p = \\frac{c}{n}$ 代入我们推导出的 $\\mathbb{E}[N_{0}]$ 表达式中：\n$$\n\\mathbb{E}[N_{0}] = n\\left(1 - \\frac{c}{n}\\right)^{n-1}\n$$\n为了分析此表达式的渐进行为，我们考察当 $n \\to \\infty$ 时 $\\left(1 - \\frac{c}{n}\\right)^{n-1}$ 这一项。我们可以将此项重写为：\n$$\n\\left(1 - \\frac{c}{n}\\right)^{n-1} = \\frac{\\left(1 - \\frac{c}{n}\\right)^n}{1 - \\frac{c}{n}}\n$$\n我们使用定义指数函数的基本极限：\n$$\n\\lim_{n \\to \\infty} \\left(1 + \\frac{x}{n}\\right)^n = \\exp(x)\n$$\n对于分子，令 $x = -c$，我们有：\n$$\n\\lim_{n \\to \\infty} \\left(1 - \\frac{c}{n}\\right)^n = \\exp(-c)\n$$\n对于分母，其极限是直接的：\n$$\n\\lim_{n \\to \\infty} \\left(1 - \\frac{c}{n}\\right) = 1 - 0 = 1\n$$\n结合这些结果，我们求得该因子的极限：\n$$\n\\lim_{n \\to \\infty} \\left(1 - \\frac{c}{n}\\right)^{n-1} = \\frac{\\lim_{n \\to \\infty} \\left(1 - \\frac{c}{n}\\right)^n}{\\lim_{n \\to \\infty} \\left(1 - \\frac{c}{n}\\right)} = \\frac{\\exp(-c)}{1} = \\exp(-c)\n$$\n因此，对于大的 $n$，$\\mathbb{E}[N_{0}]$ 的表达式渐进等价于 $n$ 乘以这个极限值。其领头阶渐进行为是：\n$$\n\\mathbb{E}[N_{0}] \\sim n \\exp(-c)\n$$\n这个表达式描述了在指定的稀疏机制下，孤立基因的期望数如何随网络规模的变化而变化。",
            "answer": "$$\n\\boxed{n \\exp(-c)}\n$$"
        },
        {
            "introduction": "期望值告诉我们一个网络属性的平均情况，但并未描述其围绕平均值的波动。本练习将引导您完成一项更高级的分析：计算 ER 图中三角形数量的方差 。这项任务需要仔细处理不同子图之间的依赖关系，是理解网络属性完整概率分布的第一步，也为构建严谨的统计检验奠定了基础。",
            "id": "3342490",
            "problem": "在计算系统生物学中使用的蛋白质-蛋白质相互作用网络的粗粒度模型中，假设由 $n$ 个蛋白质组成的网络被建模为一个无向 Erdős–Rényi (ER) 随机图 $G(n,p)$，其中 $\\binom{n}{2}$ 种可能的蛋白质-蛋白质相互作用中的每一种都以概率 $p \\in (0,1)$ 独立存在。一个完全相互作用的 $3$-蛋白质复合物对应于一个无向三角形（一个 $3$-团）。令 $T$ 表示计算 $G(n,p)$ 中三角形数量的随机变量。\n\n仅从核心定义和独立性结构出发，并且不假设任何已有的子图计数公式：\n- 推导 $\\mathbb{E}[T]$。\n- 通过将 $T$ 写成指示随机变量之和，并仔细枚举所有相关性贡献，推导 $\\mathrm{Var}(T)$ 的精确闭式表达式。\n- 使用您的方差分解，根据 $p = p(n)$ 的渐近区域，有理有据地讨论当 $n \\to \\infty$ 时，对 $T$ 进行正态近似（在通过 $\\mathbb{E}[T]$ 中心化并通过 $\\sqrt{\\mathrm{Var}(T)}$ 缩放后）何时是合理的。您的讨论应基于第一性原理，例如弱相关被加数的中心极限定理（CLT）启发式方法或依赖图视角，并应明确指出至少两个性质上不同的稀疏到稠密区域，在这些区域中，渐近方差由不同的项主导。\n\n您最终报告的答案必须是您得到的关于 $n$ 和 $p$ 的函数 $\\mathrm{Var}(T)$ 的精确闭式解析表达式。不需要数值近似。不包括单位。",
            "solution": "我们对模型进行形式化，并从第一性原理出发。在一个顶点集为 $[n] = \\{1,2,\\dots,n\\}$ 的无向 Erdős–Rényi (ER) 随机图 $G(n,p)$ 中，$\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p \\in (0,1)$ 独立存在。三角形是 $3$ 个不同顶点的集合，它们之间的 $3$ 条成对的边都存在。\n\n定义指示随机变量如下。对于每个无序三元组 $a = \\{i,j,k\\} \\subset [n]$，其中 $|a| = 3$，令\n$$\nI_{a} \\;=\\; \\mathbf{1}\\{\\text{i,j,k 之间的所有 } 3 \\text{ 条边都存在}\\}.\n$$\n那么，三角形的总数为\n$$\nT \\;=\\; \\sum_{a \\in \\binom{[n]}{3}} I_{a},\n$$\n其中 $\\binom{[n]}{3}$ 表示所有 $\\binom{n}{3}$ 个无序三元组的集合。\n\n期望。对于任意固定的三元组 $a$，所需的 $3$ 条边是独立的，并且每条边都以概率 $p$ 存在，所以\n$$\n\\mathbb{E}[I_{a}] \\;=\\; p^{3}.\n$$\n根据期望的线性性质，\n$$\n\\mathbb{E}[T] \\;=\\; \\sum_{a} \\mathbb{E}[I_{a}]\n\\;=\\; \\binom{n}{3} p^{3}.\n$$\n\n方差。我们使用恒等式\n$$\n\\mathrm{Var}(T) = \\mathrm{Var}\\left(\\sum_{a} I_{a}\\right) = \\sum_{a} \\mathrm{Var}(I_{a}) + \\sum_{a \\neq b} \\mathrm{Cov}(I_{a}, I_{b})\n$$\n其中 $a$ 和 $b$ 是不同的顶点三元组。\n\n第一项是方差之和。对于任何指示变量 $I_a$，\n$$\n\\mathrm{Var}(I_{a}) = \\mathbb{E}[I_{a}^2] - (\\mathbb{E}[I_{a}])^2 = p^3 - (p^3)^2 = p^3(1-p^3).\n$$\n因为有 $\\binom{n}{3}$ 个这样的三元组，所以这一项的总和是 $\\binom{n}{3} p^3(1-p^3)$。\n\n第二项是协方差之和。协方差 $\\mathrm{Cov}(I_{a}, I_{b}) = \\mathbb{E}[I_{a}I_{b}] - \\mathbb{E}[I_{a}]\\mathbb{E}[I_{b}]$。协方差非零的唯一情况是当两个三角形 $a$ 和 $b$ 共享至少一条边时。\n- 关键情况是当两个三角形 $a=\\{i,j,k\\}$ 和 $b=\\{i,j,l\\}$ 共享一条边（即共享两个顶点 $\\{i,j\\}$）。这两个三角形总共涉及 4 个顶点和 5 条边。\n$$\n\\mathbb{E}[I_{a}I_{b}] = P(\\text{这 5 条边都存在}) = p^5.\n$$\n因此，\n$$\n\\mathrm{Cov}(I_{a}, I_{b}) = p^5 - (p^3)(p^3) = p^5 - p^6 = p^5(1-p).\n$$\n我们需要计算有多少对这样的三角形。我们可以通过选择 4 个顶点（$\\binom{n}{4}$ 种方式），然后从这 4 个顶点中选择 2 个作为共享边的顶点（$\\binom{4}{2}=6$ 种方式）来构成这样一对三角形。因此，总共有 $6\\binom{n}{4}$ 对共享一条边的三角形。\n协方差项的总和 $\\sum_{a \\neq b} \\mathrm{Cov}(I_{a}, I_{b})$ 是对所有有序对求和。因此，总贡献是 $2 \\times 6\\binom{n}{4} \\times (p^5 - p^6) = 12\\binom{n}{4}p^5(1-p)$。\n\n将方差项和协方差项相加，我们得到总方差：\n$$\n\\mathrm{Var}(T) = \\binom{n}{3} p^3(1-p^3) + 12\\binom{n}{4}p^5(1-p)\n$$\n\n关于正态近似的讨论：\n$T$ 是 $\\binom{n}{3}$ 个指示变量的和。当这些变量是弱相关的（即协方差项远小于方差项之和），中心极限定理（CLT）的一种形式表明 $T$ 的分布（经过中心化和缩放后）趋于正态分布。我们可以通过比较 $\\mathrm{Var}(T)$ 中两个项的渐近大小来判断相关性的强度。\n令 $V_1 = \\binom{n}{3} p^3(1-p^3) \\sim \\frac{n^3}{6}p^3$ 和 $V_2 = 12\\binom{n}{4} p^5(1-p) \\sim \\frac{n^4}{2}p^5$。\n它们的比率是 $\\frac{V_2}{V_1} \\sim \\frac{n^4 p^5 / 2}{n^3 p^3 / 6} = 3np^2$。\n\n1.  **稀疏区域 ($np^2 \\to 0$)**: 例如，$p = c/n$。在这种情况下，$V_2/V_1 \\to 0$，方差由 $V_1$（独立部分）主导。三角形之间的相关性很弱。如果 $\\mathbb{E}[T] \\to \\infty$，则正态近似是合理的。如果 $\\mathbb{E}[T]$ 趋于一个常数，则 $T$ 的分布更接近泊松分布。\n\n2.  **稠密区域 ($np^2 \\to \\infty$)**: 例如，$p=c$ (常数) 或 $p=c/n^{2/3}$。在这种情况下，$V_2/V_1 \\to \\infty$，方差由 $V_2$（协方差部分）主导。变量之间存在强相关性，简单的CLT不再适用。然而，更高级的中心极限定理（如针对U统计量或依赖图的CLT）表明，在这些区域中，正态近似通常仍然成立，尽管其证明更为复杂。\n\n因此，渐近方差由不同项主导的转变发生在 $np^2 \\sim \\text{const}$ 附近。正态近似在各种密度下通常都是一个合理的启发式，但其理论依据在稀疏和稠密区域有所不同。",
            "answer": "$$\\boxed{\\binom{n}{3} \\, p^{3} \\left(1 - p^{3}\\right) \\;+\\; 12 \\binom{n}{4} \\, p^{5} \\left(1 - p\\right)}$$"
        }
    ]
}