{
    "hands_on_practices": [
        {
            "introduction": "Our first exercise grounds us in the fundamentals of fitness landscape construction. Using a standard model that includes both additive effects and pairwise epistatic interactions, you will calculate the fitness for every genotype in a simple three-locus system. This process of mapping out the entire landscape and identifying its local maxima provides a tangible example of how epistasis creates a 'rugged' topography that can trap evolving populations. ",
            "id": "3307467",
            "problem": "Consider a binary-genotype fitness landscape in evolutionary systems biology, with three loci, where each locus can be in a reference state $0$ or a mutant state $1$. Let the genotype be denoted by a vector $\\boldsymbol{x} = (x_{1}, x_{2}, x_{3}) \\in \\{0,1\\}^{3}$, and let the fitness be modeled as Malthusian fitness (log-fitness), defined by an additive plus pairwise epistatic model\n$$\nF(\\boldsymbol{x}) = a_{1} x_{1} + a_{2} x_{2} + a_{3} x_{3} + e_{12} x_{1} x_{2} + e_{13} x_{1} x_{3} + e_{23} x_{2} x_{3}.\n$$\nThis model is a standard representation of pairwise epistasis in fitness landscapes, in which $a_{i}$ are additive contributions per locus and $e_{ij}$ capture pairwise epistatic interactions. The Hamming distance $d_{H}(\\boldsymbol{x}, \\boldsymbol{y})$ between two genotypes is defined as the number of loci that differ between $\\boldsymbol{x}$ and $\\boldsymbol{y}$, and a Hamming-neighbor of $\\boldsymbol{x}$ is any genotype $\\boldsymbol{y}$ with $d_{H}(\\boldsymbol{x}, \\boldsymbol{y}) = 1$. A local maximum is a genotype $\\boldsymbol{x}$ such that $F(\\boldsymbol{x})  F(\\boldsymbol{y})$ for all Hamming-neighbors $\\boldsymbol{y}$ of $\\boldsymbol{x}$; ties are not considered local maxima.\n\nConstruct the minimal three-locus landscape with both additive and pairwise epistatic terms using the following parameter values:\n$$\na_{1} = 0.4,\\quad a_{2} = -0.3,\\quad a_{3} = 0.9,\\quad e_{12} = 0.8,\\quad e_{13} = -0.7,\\quad e_{23} = -0.4.\n$$\nEnumerate all genotypes, compute their fitness values $F(\\boldsymbol{x})$, and determine all local maxima under the Hamming-neighborhood definition above. Label each genotype by its integer index\n$$\nI(\\boldsymbol{x}) = 4 x_{1} + 2 x_{2} + x_{3},\n$$\nthat is, by its binary value $x_{1} x_{2} x_{3}$ interpreted with $x_{1}$ as the most significant bit. Express the set of local maxima indices as a row matrix in increasing order. No rounding is required, and no physical units apply.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Genotype space: $\\boldsymbol{x} = (x_{1}, x_{2}, x_{3}) \\in \\{0,1\\}^{3}$.\n-   Fitness function: $F(\\boldsymbol{x}) = a_{1} x_{1} + a_{2} x_{2} + a_{3} x_{3} + e_{12} x_{1} x_{2} + e_{13} x_{1} x_{3} + e_{23} x_{2} x_{3}$.\n-   Parameter values: $a_{1} = 0.4$, $a_{2} = -0.3$, $a_{3} = 0.9$, $e_{12} = 0.8$, $e_{13} = -0.7$, $e_{23} = -0.4$.\n-   Neighborhood definition: A Hamming-neighbor of $\\boldsymbol{x}$ is any genotype $\\boldsymbol{y}$ with Hamming distance $d_{H}(\\boldsymbol{x}, \\boldsymbol{y}) = 1$.\n-   Local maximum definition: A genotype $\\boldsymbol{x}$ is a local maximum if $F(\\boldsymbol{x})  F(\\boldsymbol{y})$ for all its Hamming-neighbors $\\boldsymbol{y}$. Ties are not considered local maxima.\n-   Genotype indexing: $I(\\boldsymbol{x}) = 4 x_{1} + 2 x_{2} + x_{3}$.\n-   Objective: Find all local maxima indices and present them as a row matrix in increasing order.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it uses a standard additive-plus-pairwise-epistasis model for fitness landscapes, a well-established concept in evolutionary systems biology. The problem is well-posed: the genotype space is finite, the fitness function and its parameters are explicitly defined, and the criteria for identifying local maxima are unambiguous. This ensures a unique and computable solution. The problem statement is objective, using formal mathematical language. It is self-contained, providing all necessary information for a solution. The calculations are feasible and the setup is logically consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution is provided below.\n\nThe fitness function with the specified parameters is:\n$$\nF(x_1, x_2, x_3) = 0.4 x_{1} - 0.3 x_{2} + 0.9 x_{3} + 0.8 x_{1} x_{2} - 0.7 x_{1} x_{3} - 0.4 x_{2} x_{3}.\n$$\nWe must enumerate all $2^3 = 8$ genotypes, calculate their fitness values, and then check the local maximum condition for each.\n\nThe genotypes are indexed from $0$ to $7$. We calculate the fitness $F(\\boldsymbol{x})$ for each genotype $\\boldsymbol{x} = (x_1, x_2, x_3)$.\n\n-   **Genotype 0:** $\\boldsymbol{x} = (0,0,0)$, Index $I = 0$.\n    $F(0,0,0) = 0.4(0) - 0.3(0) + 0.9(0) + 0.8(0)(0) - 0.7(0)(0) - 0.4(0)(0) = 0$.\n-   **Genotype 1:** $\\boldsymbol{x} = (0,0,1)$, Index $I = 1$.\n    $F(0,0,1) = 0.4(0) - 0.3(0) + 0.9(1) + 0.8(0)(0) - 0.7(0)(1) - 0.4(0)(1) = 0.9$.\n-   **Genotype 2:** $\\boldsymbol{x} = (0,1,0)$, Index $I = 2$.\n    $F(0,1,0) = 0.4(0) - 0.3(1) + 0.9(0) + 0.8(0)(1) - 0.7(0)(0) - 0.4(1)(0) = -0.3$.\n-   **Genotype 3:** $\\boldsymbol{x} = (0,1,1)$, Index $I = 3$.\n    $F(0,1,1) = 0.4(0) - 0.3(1) + 0.9(1) + 0.8(0)(1) - 0.7(0)(1) - 0.4(1)(1) = -0.3 + 0.9 - 0.4 = 0.2$.\n-   **Genotype 4:** $\\boldsymbol{x} = (1,0,0)$, Index $I = 4$.\n    $F(1,0,0) = 0.4(1) - 0.3(0) + 0.9(0) + 0.8(1)(0) - 0.7(1)(0) - 0.4(0)(0) = 0.4$.\n-   **Genotype 5:** $\\boldsymbol{x} = (1,0,1)$, Index $I = 5$.\n    $F(1,0,1) = 0.4(1) - 0.3(0) + 0.9(1) + 0.8(1)(0) - 0.7(1)(1) - 0.4(0)(1) = 0.4 + 0.9 - 0.7 = 0.6$.\n-   **Genotype 6:** $\\boldsymbol{x} = (1,1,0)$, Index $I = 6$.\n    $F(1,1,0) = 0.4(1) - 0.3(1) + 0.9(0) + 0.8(1)(1) - 0.7(1)(0) - 0.4(1)(0) = 0.4 - 0.3 + 0.8 = 0.9$.\n-   **Genotype 7:** $\\boldsymbol{x} = (1,1,1)$, Index $I = 7$.\n    $F(1,1,1) = 0.4(1) - 0.3(1) + 0.9(1) + 0.8(1)(1) - 0.7(1)(1) - 0.4(1)(1) = 0.4 - 0.3 + 0.9 + 0.8 - 0.7 - 0.4 = 0.7$.\n\nSummary of fitness values (denoted $F_I$ for index $I$):\n$F_0 = 0$; $F_1 = 0.9$; $F_2 = -0.3$; $F_3 = 0.2$; $F_4 = 0.4$; $F_5 = 0.6$; $F_6 = 0.9$; $F_7 = 0.7$.\n\nNow, we check the local maximum condition for each genotype.\n\n-   **Genotype 0 (0,0,0):** $F_0=0$. Neighbors are $(1,0,0)$, $(0,1,0)$, $(0,0,1)$ (indices $4, 2, 1$). Their fitness values are $F_4=0.4$, $F_2=-0.3$, $F_1=0.9$. Since $F_0 \\ngtr F_4$ and $F_0 \\ngtr F_1$, it is not a local maximum.\n\n-   **Genotype 1 (0,0,1):** $F_1=0.9$. Neighbors are $(1,0,1)$, $(0,1,1)$, $(0,0,0)$ (indices $5, 3, 0$). Their fitness values are $F_5=0.6$, $F_3=0.2$, $F_0=0$. We check if $F_1$ is strictly greater than all neighbor fitness values:\n    -   $F_1  F_5 \\implies 0.9  0.6$ (True)\n    -   $F_1  F_3 \\implies 0.9  0.2$ (True)\n    -   $F_1  F_0 \\implies 0.9  0$ (True)\n    All conditions hold. Genotype with index $1$ is a local maximum.\n\n-   **Genotype 2 (0,1,0):** $F_2=-0.3$. Neighbors are $(1,1,0)$, $(0,0,0)$, $(0,1,1)$ (indices $6, 0, 3$). Their fitness values are $F_6=0.9$, $F_0=0$, $F_3=0.2$. Since $F_2 \\ngtr F_6$, it is not a local maximum.\n\n-   **Genotype 3 (0,1,1):** $F_3=0.2$. Neighbors are $(1,1,1)$, $(0,0,1)$, $(0,1,0)$ (indices $7, 1, 2$). Their fitness values are $F_7=0.7$, $F_1=0.9$, $F_2=-0.3$. Since $F_3 \\ngtr F_7$ and $F_3 \\ngtr F_1$, it is not a local maximum.\n\n-   **Genotype 4 (1,0,0):** $F_4=0.4$. Neighbors are $(0,0,0)$, $(1,1,0)$, $(1,0,1)$ (indices $0, 6, 5$). Their fitness values are $F_0=0$, $F_6=0.9$, $F_5=0.6$. Since $F_4 \\ngtr F_6$ and $F_4 \\ngtr F_5$, it is not a local maximum.\n\n-   **Genotype 5 (1,0,1):** $F_5=0.6$. Neighbors are $(0,0,1)$, $(1,1,1)$, $(1,0,0)$ (indices $1, 7, 4$). Their fitness values are $F_1=0.9$, $F_7=0.7$, $F_4=0.4$. Since $F_5 \\ngtr F_1$ and $F_5 \\ngtr F_7$, it is not a local maximum.\n\n-   **Genotype 6 (1,1,0):** $F_6=0.9$. Neighbors are $(0,1,0)$, $(1,0,0)$, $(1,1,1)$ (indices $2, 4, 7$). Their fitness values are $F_2=-0.3$, $F_4=0.4$, $F_7=0.7$. We check if $F_6$ is strictly greater than all neighbor fitness values:\n    -   $F_6  F_2 \\implies 0.9  -0.3$ (True)\n    -   $F_6  F_4 \\implies 0.9  0.4$ (True)\n    -   $F_6  F_7 \\implies 0.9  0.7$ (True)\n    All conditions hold. Genotype with index $6$ is a local maximum.\n\n-   **Genotype 7 (1,1,1):** $F_7=0.7$. Neighbors are $(0,1,1)$, $(1,0,1)$, $(1,1,0)$ (indices $3, 5, 6$). Their fitness values are $F_3=0.2$, $F_5=0.6$, $F_6=0.9$. Since $F_7 \\ngtr F_6$, it is not a local maximum.\n\nThe genotypes identified as local maxima have indices $1$ and $6$. Arranged in increasing order, the set of indices is $\\{1, 6\\}$. This must be expressed as a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the first practice involved building a landscape from known parameters, real-world scenarios often start with measured fitness values. This exercise introduces the Walsh-Hadamard transform, a powerful mathematical tool for decomposing any fitness landscape on a binary genotype space into its constituent parts: the average fitness, additive effects, and a complete hierarchy of epistatic interactions. By applying this technique, you will learn how to extract the precise genetic architecture underlying a set of fitness measurements, a core skill in quantitative and systems genetics. ",
            "id": "3307521",
            "problem": "Consider a binary, three-locus genotype space $\\mathcal{G} = \\{0,1\\}^3$ with genotypes denoted by $\\mathbf{b} = (b_1,b_2,b_3)$ and a dimensionless fitness function $f: \\mathcal{G} \\to \\mathbb{R}$. In evolutionary systems biology, a fitness landscape can be represented as a function on the hypercube and decomposed into additive and epistatic contributions using an orthogonal basis on $\\{-1,1\\}^3$. Define spin variables $s_i \\in \\{-1,1\\}$ for each locus via $s_i = 2 b_i - 1$. The orthogonal decomposition over products of spins is known as the Walsh-Hadamard transform (WHT). Starting from the fundamental definitions of fitness landscapes on $\\{0,1\\}^3$, orthogonality of character functions on the hypercube, and the mapping $\\mathbf{b} \\mapsto \\mathbf{s}$, perform the decomposition into additive and epistatic spectral components and reconstruct the fitness function $f(s_1,s_2,s_3)$.\n\nThe observed fitnesses are:\n- $f(0,0,0) = 4$,\n- $f(1,0,0) = 5$,\n- $f(0,1,0) = 6$,\n- $f(0,0,1) = 3$,\n- $f(1,1,0) = 9$,\n- $f(1,0,1) = 6$,\n- $f(0,1,1) = 7$,\n- $f(1,1,1) = 13$.\n\nUsing only the fundamental base indicated above, quantify the additive, pairwise epistatic, and third-order epistatic coefficients via the WHT on the spin representation, and reconstruct the fitness function as a polynomial in $s_1$, $s_2$, and $s_3$. Express your final reconstructed fitness function $f(s_1,s_2,s_3)$ as a single closed-form analytic expression with exact rational coefficients. No rounding is required. Report your final answer as the explicit polynomial in $s_1$, $s_2$, and $s_3$.",
            "solution": "The user wants me to solve this problem.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n\n-   **Genotype Space:** A binary, three-locus genotype space $\\mathcal{G} = \\{0,1\\}^3$. Genotypes are denoted by $\\mathbf{b} = (b_1,b_2,b_3)$.\n-   **Fitness Function:** A dimensionless fitness function $f: \\mathcal{G} \\to \\mathbb{R}$.\n-   **Spin Variable Mapping:** Spin variables $s_i \\in \\{-1,1\\}$ are defined from binary alleles $b_i \\in \\{0,1\\}$ by the mapping $s_i = 2 b_i - 1$.\n-   **Decomposition Method:** The fitness function on the hypercube $\\{-1,1\\}^3$ is to be decomposed into additive and epistatic contributions using an orthogonal basis of products of spins, which corresponds to the Walsh-Hadamard transform (WHT).\n-   **Task:** Quantify the additive, pairwise epistatic, and third-order epistatic coefficients. Reconstruct the fitness function $f(s_1,s_2,s_3)$ as a polynomial in the spin variables.\n-   **Observed Fitness Data:**\n    -   $f(0,0,0) = 4$\n    -   $f(1,0,0) = 5$\n    -   $f(0,1,0) = 6$\n    -   $f(0,0,1) = 3$\n    -   $f(1,1,0) = 9$\n    -   $f(1,0,1) = 6$\n    -   $f(0,1,1) = 7$\n    -   $f(1,1,1) = 13$\n-   **Final Answer Format:** A single closed-form analytic expression for $f(s_1,s_2,s_3)$ with exact rational coefficients.\n\n**1.2. Validate Using Extracted Givens:**\n\n-   **Scientific Grounding:** The problem is a standard exercise in the field of evolutionary systems biology, specifically concerning the analysis of fitness landscapes. The use of the Walsh-Hadamard transform to decompose a function on a hypercube into its spectral components (additive and epistatic effects) is a well-established and fundamental technique. The problem is scientifically sound and correctly formulated.\n-   **Well-Posedness:** The problem provides a complete set of data ($8$ fitness values for the $2^3 = 8$ possible genotypes). The Walsh-Hadamard transform on a finite group is a well-defined linear transformation that yields a unique set of coefficients. The problem is unambiguous and has a unique solution.\n-   **Objectivity:** The problem statement is written in precise, objective, and standard scientific language. There is no subjective or opinion-based content.\n-   **Completeness and Consistency:** All necessary information is provided. There are no contradictions in the givens.\n-   **Other Criteria:** The problem is not trivial, falls within the scientific domain, is verifiable, and is well-structured.\n\n**1.3. Verdict and Action:**\n\nThe problem is **valid**. A full solution will be provided.\n\n### Step 2: Solution\n\nThe problem requires the decomposition of a fitness function defined on the binary hypercube $\\{0,1\\}^3$ into its epistatic components. This is achieved by first mapping the function to the spin hypercube $\\{-1,1\\}^3$ and then applying the Walsh-Hadamard transform.\n\nFirst, we map the binary genotypes $\\mathbf{b} = (b_1,b_2,b_3)$ to spin genotypes $\\mathbf{s} = (s_1,s_2,s_3)$ using the relation $s_i = 2b_i - 1$. A value of $b_i=0$ maps to $s_i=-1$, and $b_i=1$ maps to $s_i=1$. We list the fitness values for each corresponding spin genotype:\n-   $f(-1,-1,-1) = f(0,0,0) = 4$\n-   $f(1,-1,-1) = f(1,0,0) = 5$\n-   $f(-1,1,-1) = f(0,1,0) = 6$\n-   $f(-1,-1,1) = f(0,0,1) = 3$\n-   $f(1,1,-1) = f(1,1,0) = 9$\n-   $f(1,-1,1) = f(1,0,1) = 6$\n-   $f(-1,1,1) = f(0,1,1) = 7$\n-   $f(1,1,1) = f(1,1,1) = 13$\n\nThe fitness function $f(\\mathbf{s})$ can be expressed as a linear combination of orthogonal basis functions on the spin hypercube. These basis functions are the Walsh functions, which for the spin representation are products of the spin variables. For a $3$-locus system, the $2^3=8$ basis functions are $\\chi_I(\\mathbf{s}) = \\prod_{i \\in I} s_i$, where $I$ is a subset of $\\{1,2,3\\}$. The function can be written as:\n\n$$\nf(s_1,s_2,s_3) = \\sum_{I \\subseteq \\{1,2,3\\}} w_I \\chi_I(s_1,s_2,s_3)\n$$\n\nThis expands to:\n$$\nf(s_1,s_2,s_3) = w_{\\emptyset} + w_{\\{1\\}}s_1 + w_{\\{2\\}}s_2 + w_{\\{3\\}}s_3 + w_{\\{1,2\\}}s_1s_2 + w_{\\{1,3\\}}s_1s_3 + w_{\\{2,3\\}}s_2s_3 + w_{\\{1,2,3\\}}s_1s_2s_3\n$$\nFor simplicity, we denote $w_{\\emptyset}$ as $w_0$, $w_{\\{i\\}}$ as $w_i$, $w_{\\{i,j\\}}$ as $w_{ij}$, and $w_{\\{1,2,3\\}}$ as $w_{123}$.\n\nThe coefficients $w_I$ are the projections of the function $f$ onto the basis functions $\\chi_I$. They are calculated using the inner product on the space of functions on the hypercube, defined as $\\langle g_1, g_2 \\rangle = \\frac{1}{2^3} \\sum_{\\mathbf{s} \\in \\{-1,1\\}^3} g_1(\\mathbf{s})g_2(\\mathbf{s})$. Due to the orthogonality of the Walsh functions, the coefficients are given by:\n\n$$\nw_I = \\langle f, \\chi_I \\rangle = \\frac{1}{8} \\sum_{\\mathbf{s} \\in \\{-1,1\\}^3} f(\\mathbf{s}) \\chi_I(\\mathbf{s})\n$$\n\nWe now calculate each of the $8$ coefficients. We order the summation over $\\mathbf{s}$ lexicographically: $(-1,-1,-1), (-1,-1,1), \\dots, (1,1,1)$. The corresponding fitness values are $(4, 3, 6, 7, 5, 6, 9, 13)$.\n\n-   **Mean fitness ($w_0$):**\n    $w_0 = \\frac{1}{8} \\sum f(\\mathbf{s}) = \\frac{1}{8}(4+3+6+7+5+6+9+13) = \\frac{53}{8}$.\n\n-   **Additive effects ($w_1, w_2, w_3$):**\n    $w_1 = \\frac{1}{8} \\sum f(\\mathbf{s})s_1 = \\frac{1}{8}(-4-3-6-7+5+6+9+13) = \\frac{13}{8}$.\n    $w_2 = \\frac{1}{8} \\sum f(\\mathbf{s})s_2 = \\frac{1}{8}(-4-3+6+7-5-6+9+13) = \\frac{17}{8}$.\n    $w_3 = \\frac{1}{8} \\sum f(\\mathbf{s})s_3 = \\frac{1}{8}(-4+3-6+7-5+6-9+13) = \\frac{5}{8}$.\n\n-   **Pairwise epistatic effects ($w_{12}, w_{13}, w_{23}$):**\n    $w_{12} = \\frac{1}{8} \\sum f(\\mathbf{s})s_1s_2 = \\frac{1}{8}(+4+3-6-7-5-6+9+13) = \\frac{5}{8}$.\n    $w_{13} = \\frac{1}{8} \\sum f(\\mathbf{s})s_1s_3 = \\frac{1}{8}(+4-3+6-7-5+6-9+13) = \\frac{5}{8}$.\n    $w_{23} = \\frac{1}{8} \\sum f(\\mathbf{s})s_2s_3 = \\frac{1}{8}(+4-3-6+7+5-6-9+13) = \\frac{5}{8}$.\n\n-   **Third-order epistatic effect ($w_{123}$):**\n    $w_{123} = \\frac{1}{8} \\sum f(\\mathbf{s})s_1s_2s_3 = \\frac{1}{8}(-4+3+6-7+5-6-9+13) = \\frac{1}{8}$.\n\nHaving calculated all the coefficients, we can reconstruct the fitness function as a polynomial in $s_1, s_2, s_3$:\n$$\nf(s_1,s_2,s_3) = w_0 + w_1 s_1 + w_2 s_2 + w_3 s_3 + w_{12} s_1 s_2 + w_{13} s_1 s_3 + w_{23} s_2 s_3 + w_{123} s_1 s_2 s_3\n$$\nSubstituting the calculated values:\n$$\nf(s_1,s_2,s_3) = \\frac{53}{8} + \\frac{13}{8} s_1 + \\frac{17}{8} s_2 + \\frac{5}{8} s_3 + \\frac{5}{8} s_1 s_2 + \\frac{5}{8} s_1 s_3 + \\frac{5}{8} s_2 s_3 + \\frac{1}{8} s_1 s_2 s_3\n$$\nThis can be written in a more compact form:\n$$\nf(s_1,s_2,s_3) = \\frac{1}{8} (53 + 13 s_1 + 17 s_2 + 5 s_3 + 5 s_1 s_2 + 5 s_1 s_3 + 5 s_2 s_3 + s_1 s_2 s_3)\n$$\nThis is the required closed-form analytical expression for the reconstructed fitness function with exact rational coefficients.\n\nWe can verify this result by plugging in a point, for example $\\mathbf{s}=(1,1,1)$:\n$$\nf(1,1,1) = \\frac{1}{8}(53+13+17+5+5+5+5+1) = \\frac{104}{8} = 13.\n$$\nThis matches the given value $f(1,1,1)=13$. Another check for $\\mathbf{s}=(-1,-1,-1)$:\n$$\nf(-1,-1,-1) = \\frac{1}{8}(53-13-17-5+5+5+5-1) = \\frac{1}{8}(53-35+15-1) = \\frac{32}{8} = 4.\n$$\nThis also matches the given value $f(0,0,0)=4$, confirming the correctness of the coefficients.",
            "answer": "$$\n\\boxed{\\frac{53}{8} + \\frac{13}{8} s_1 + \\frac{17}{8} s_2 + \\frac{5}{8} s_3 + \\frac{5}{8} s_1 s_2 + \\frac{5}{8} s_1 s_3 + \\frac{5}{8} s_2 s_3 + \\frac{1}{8} s_1 s_2 s_3}\n$$"
        },
        {
            "introduction": "Finally, we connect the static structure of a fitness landscape to the dynamics of evolution through the concept of evolutionary accessibility. This computational exercise explores the probability that a global fitness optimum can be reached by a series of strictly beneficial mutations. You will implement a Monte Carlo simulation to investigate how different patterns of epistasis influence the likelihood of adaptive success, demonstrating how computational modeling can reveal the consequences of complex, stochastic evolutionary processes that are often analytically intractable. ",
            "id": "3307506",
            "problem": "You are given a biallelic, four-locus genotype space modeled as the vertices of a hypercube of dimension $4$. Each genotype is represented by a binary vector $x = (x_0, x_1, x_2, x_3) \\in \\{0,1\\}^4$, where $x_i = 1$ indicates the derived allele at locus $i$ and $x_i = 0$ indicates the ancestral allele. A fitness landscape is a mapping $w: \\{0,1\\}^4 \\to \\mathbb{R}$. A strictly fitness-increasing path from the wild type $0000$ to the all-ones genotype $1111$ is a sequence of $5$ genotypes $(g_0,g_1,g_2,g_3,g_4)$ such that $g_0 = 0000$, $g_4 = 1111$, each $g_{k+1}$ differs from $g_k$ by flipping one $0$ to $1$, and $w(g_{k+1}) - w(g_k)  0$ for all $k \\in \\{0,1,2,3\\}$. There are $4! = 24$ such monotonic mutation orders in total. We say that the global optimum is reachable via strictly fitness-increasing paths if at least one such path exists to $1111$.\n\nWe consider a parametric model for $w(x)$ in which pairwise two-locus epistasis is controlled while guaranteeing that $1111$ is the global maximum. Specifically, let\n$$\nw(x) \\;=\\; \\sum_{i=0}^3 a_i x_i \\;+\\; \\sum_{0 \\le i  j \\le 3} b_{ij} x_i x_j \\;+\\; c \\prod_{k=0}^3 x_k,\n$$\nwith $c$ fixed to a positive constant to ensure $1111$ is globally optimal. The $a_i$ and $b_{ij}$ are random variables drawn from continuous distributions constrained to realize a prescribed qualitative pattern of pairwise sign epistasis along each two-locus face when all other loci are at the ancestral state. For a given pair $(i,j)$, with other loci set to $0$, the two-locus fitnesses are\n$$\nw(00)=0,\\quad w(10)=a_i,\\quad w(01)=a_j,\\quad w(11)=a_i + a_j + b_{ij}.\n$$\nDefine the marginal effect of mutating at locus $i$ on backgrounds $x_j=0$ and $x_j=1$ as $\\Delta_i^{(0)} = a_i$ and $\\Delta_i^{(1)} = a_i + b_{ij}$, respectively. The qualitative epistasis classes on the pair $(i,j)$ are defined by:\n- No sign epistasis (“none”): $a_i(a_i + b_{ij})  0$ and $a_j(a_j + b_{ij})  0$.\n- Sign epistasis (“sign”): exactly one of $a_i(a_i + b_{ij})$ and $a_j(a_j + b_{ij})$ is negative.\n- Reciprocal sign epistasis (“reciprocal”): both $a_i(a_i + b_{ij})  0$ and $a_j(a_j + b_{ij})  0$.\n\nWe impose the following generative scheme to compute the probability that $1111$ is reachable via strictly fitness-increasing paths under a specified pattern of pairwise epistasis across all $\\binom{4}{2} = 6$ pairs:\n1. Draw main effects independently as $a_i \\sim \\mathrm{Uniform}(0.2, 0.8)$ for $i \\in \\{0,1,2,3\\}$. These draws guarantee $a_i  0$.\n2. For each unordered pair $(i,j)$, draw an interaction $b_{ij}$ from a continuous uniform distribution over an interval that enforces the requested epistasis class, with the other loci fixed at $0$:\n   - If class is “none”, sample $b_{ij}$ uniformly from $( -\\min(a_i,a_j), \\, 1 )$.\n   - If class is “sign”, sample $b_{ij}$ uniformly from $( -\\max(a_i,a_j), \\, -\\min(a_i,a_j) )$.\n   - If class is “reciprocal”, sample $b_{ij}$ uniformly from ( $-1 ,\\, -\\max(a_i,a_j)$ ).\n   In all cases, also set $b_{ji} = b_{ij}$ and $b_{ii} = 0$.\n3. Fix $c = 10$ so that $w(1111)$ exceeds all other $15$ genotypes for any $(a,b)$ in the above ranges.\n\nGiven a qualitative epistasis pattern on all $6$ pairs, we define the target probability as the Monte Carlo (MC) limit of the fraction of random landscapes generated by the above procedure for which at least one strictly increasing path from $0000$ to $1111$ exists.\n\nYour task is to implement a program that, for each test case below, performs $N$ independent and identically distributed MC draws of $(a,b)$ with the specified pseudorandom seed and estimates the accessibility probability $\\hat{p}$ as the fraction of draws with at least one strictly fitness-increasing path to $1111$. Use the above model exactly. For each test case, return $\\hat{p}$ as a float rounded to three decimal places. The final output must be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets.\n\nTest suite specification. There are $4$ test cases. Index loci as $\\{0,1,2,3\\}$ and pairs in the fixed order $\\{(0,1),(0,2),(0,3),(1,2),(1,3),(2,3)\\}$. Each test case is a triple: $(\\text{pattern}, N, \\text{seed})$, where pattern is a list of $6$ strings from $\\{\\text{\"none\"}, \\text{\"sign\"}, \\text{\"reciprocal\"}\\}$.\n\n- Test case $1$ (happy path, no sign epistasis anywhere):\n  - pattern $=$ $[\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"}]$\n  - $N = 10000$\n  - seed $= 1337$\n- Test case $2$ (single sign-epistatic pair):\n  - pattern $=$ $[\\text{\"sign\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"}]$\n  - $N = 10000$\n  - seed $= 4242$\n- Test case $3$ (single reciprocal-sign-epistatic pair):\n  - pattern $=$ $[\\text{\"reciprocal\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"},\\text{\"none\"}]$\n  - $N = 10000$\n  - seed $= 202311$\n- Test case $4$ (three reciprocal pairs forming a chain):\n  - pattern $=$ $[\\text{\"reciprocal\"},\\text{\"none\"},\\text{\"none\"},\\text{\"reciprocal\"},\\text{\"none\"},\\text{\"reciprocal\"}]$\n  - $N = 10000$\n  - seed $= 777$\n\nProgram requirements:\n- Implement the exact generative model described above with $c = 10$, $a_i \\sim \\mathrm{Uniform}(0.2,0.8)$, and $b_{ij}$ drawn from the open intervals implied by the pattern.\n- Compute $w(x)$ exactly as defined, for all $16$ genotypes $x \\in \\{0,1\\}^4$.\n- Determine accessibility by checking whether any of the $24$ monotonic mutation orders yields a strictly increasing fitness sequence from $0000$ to $1111$.\n- For each test case, estimate $\\hat{p}$ as a float in $[0,1]$ and round to three decimals.\n- Final output format: a single line containing the four results as a comma-separated list enclosed in square brackets, e.g., $[\\hat{p}_1,\\hat{p}_2,\\hat{p}_3,\\hat{p}_4]$ with each $\\hat{p}_k$ rounded to three decimals. No additional text should be printed.\n\nNo physical units are involved. All probabilities must be reported as decimals in $[0,1]$.",
            "solution": "The user-provided problem statement is valid. It is scientifically grounded within the field of computational evolutionary biology, mathematically well-posed, and provides a complete, unambiguous specification for a numerical simulation. All necessary parameters, distributions, definitions, and procedures are explicitly defined, forming a self-contained and solvable problem. There are no contradictions, factual errors, or subjective elements.\n\nThe problem requires the estimation of the probability that the global fitness optimum of a $4$-locus system is accessible via strictly fitness-increasing paths. This is a classic question in the study of fitness landscapes. The solution involves a Monte Carlo simulation based on the precise generative model provided.\n\nA genotype is represented by a binary vector $x = (x_0, x_1, x_2, x_3) \\in \\{0,1\\}^4$. The fitness $w(x)$ is given by the function:\n$$\nw(x) = \\sum_{i=0}^3 a_i x_i + \\sum_{0 \\le i  j \\le 3} b_{ij} x_i x_j + c \\prod_{k=0}^3 x_k\n$$\nThis function includes additive effects from single loci (the $a_i$ terms), pairwise epistatic interactions (the $b_{ij}$ terms), and a single four-way interaction term with coefficient $c$. The provided problem statement contains a minor typographical error in the product term, writing $x_1 x_2 x_3 x_4$ with $1$-based indexing for loci but contextually implying a $4$-locus model consistent with $0$-based indexing derived from test suite specifications. The correct interpretation, consistent with a $4$-locus interaction, is the product over all four components of $x$.\n\nThe core of the problem is to determine the accessibility of the genotype $1111$ from the wild-type $0000$. A path from $0000$ to $1111$ is a sequence of $4$ mutations, each flipping a single $0$ to a $1$. The order in which these mutations occur defines a specific path. There are $4! = 24$ such unique orderings, or paths. A path $(g_0, g_1, g_2, g_3, g_4)$, where $g_0=0000$, is strictly fitness-increasing if $w(g_{k+1})  w(g_k)$ for all $k \\in \\{0, 1, 2, 3\\}$. The global optimum $1111$ is considered accessible if at least one of these $24$ paths is strictly fitness-increasing.\n\nWe will write a program to estimate the probability of accessibility, $\\hat{p}$, for different scenarios of pairwise epistasis. The estimation is performed via a Monte Carlo simulation of $N$ trials for each test case. Each trial consists of the following steps:\n\n1.  **Landscape Generation**: A random fitness landscape is generated by sampling the parameters $a_i$ and $b_{ij}$. The random number generator is seeded for reproducibility.\n    -   The main effects $a_i$ are drawn independently from $\\mathrm{Uniform}(0.2, 0.8)$ for $i \\in \\{0,1,2,3\\}$.\n    -   The epistatic coefficients $b_{ij}$ for each of the $\\binom{4}{2}=6$ pairs are drawn from specific uniform distributions. The interval for each $b_{ij}$ depends on the pre-specified qualitative epistasis class (\"none\", \"sign\", or \"reciprocal\") and the values of the corresponding main effects, $a_i$ and $a_j$.\n    -   The coefficient for the highest-order term is fixed at $c=10$.\n\n2.  **Fitness Calculation**: For the generated landscape, the fitness values $w(x)$ for all $2^4 = 16$ genotypes are computed and stored. Genotypes are efficiently represented as integers from $0$ (for $0000$) to $15$ (for $1111$), where the integer is the decimal representation of the binary genotype string.\n\n3.  **Accessibility Check**: The $24$ possible mutational paths are examined.\n    -   Each path corresponds to a permutation of the loci indices $\\{0, 1, 2, 3\\}$. For a permutation $(\\pi_0, \\pi_1, \\pi_2, \\pi_3)$, the path of genotypes is $g_0 = 0000$, $g_1$ (mutate locus $\\pi_0$), $g_2$ (mutate locus $\\pi_1$ on top of $g_1$), and so on.\n    -   For each path, we check if all $4$ mutational steps are fitness-increasing by comparing the pre-computed fitness values.\n    -   If a strictly increasing path is found, the landscape is marked as \"accessible,\" and the check for the current landscape terminates (as only one such path is needed).\n\n4.  **Probability Estimation**: After $N$ trials, the estimated probability $\\hat{p}$ is calculated as the ratio of the number of accessible landscapes to the total number of trials, $N$. This value is then rounded to three decimal places as required.\n\nThis procedure is repeated for each test case specified in the problem, yielding a list of estimated probabilities. The implementation will use `numpy` for numerical operations and `itertools` for generating permutations and combinations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import permutations, combinations\n\ndef has_accessible_path(fitness_values):\n    \"\"\"\n    Checks if at least one strictly increasing path exists from 0000 to 1111.\n\n    Args:\n        fitness_values: A numpy array of 16 fitness values, indexed by genotype integer.\n\n    Returns:\n        True if an accessible path exists, False otherwise.\n    \"\"\"\n    # A path is a permutation of the 4 loci to be mutated.\n    for path_order in permutations(range(4)):\n        current_g_int = 0\n        is_path_accessible = True\n        for i in range(4):\n            locus_to_mutate = path_order[i]\n            # Flip the bit for the locus to mutate\n            next_g_int = current_g_int | (1  locus_to_mutate)\n            \n            # Check for strictly increasing fitness\n            if fitness_values[next_g_int] = fitness_values[current_g_int]:\n                is_path_accessible = False\n                break\n            current_g_int = next_g_int\n        \n        if is_path_accessible:\n            return True\n            \n    return False\n\ndef estimate_accessibility_probability(pattern, N, seed):\n    \"\"\"\n    Estimates the accessibility probability for a given epistasis pattern.\n\n    Args:\n        pattern: A list of 6 strings specifying the epistasis class for each pair.\n        N: The number of Monte Carlo samples.\n        seed: The seed for the random number generator.\n\n    Returns:\n        The estimated probability, rounded to 3 decimal places.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    # Pairs are in lexicographical order: (0,1), (0,2), (0,3), (1,2), (1,3), (2,3)\n    pairs = list(combinations(range(4), 2))\n    \n    accessible_count = 0\n    c = 10.0\n\n    for _ in range(N):\n        # 1. Generate landscape parameters\n        a = rng.uniform(0.2, 0.8, size=4)\n        B = np.zeros((4, 4))\n        \n        for k, (i, j) in enumerate(pairs):\n            ep_type = pattern[k]\n            ai, aj = a[i], a[j]\n            min_a, max_a = min(ai, aj), max(ai, aj)\n            \n            if ep_type == \"none\":\n                low, high = -min_a, 1.0\n            elif ep_type == \"sign\":\n                low, high = -max_a, -min_a\n            else:  # \"reciprocal\"\n                low, high = -1.0, -max_a\n                \n            bij = rng.uniform(low, high)\n            B[i, j] = B[j, i] = bij\n            \n        # 2. Calculate fitness for all 16 genotypes\n        fitness_values = np.zeros(16)\n        for g_int in range(16):\n            # Convert integer to binary vector representation\n            x = np.array([(g_int  i)  1 for i in range(4)], dtype=np.int8)\n            \n            term1 = np.dot(a, x)\n            \n            term2 = 0.0\n            for i_idx in range(4):\n                for j_idx in range(i_idx + 1, 4):\n                    term2 += B[i_idx, j_idx] * x[i_idx] * x[j_idx]\n            \n            term3 = c * np.prod(x)\n            \n            fitness_values[g_int] = term1 + term2 + term3\n\n        # 3. Check for accessibility\n        if has_accessible_path(fitness_values):\n            accessible_count += 1\n            \n    probability = accessible_count / N\n    return round(probability, 3)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        ([\"none\", \"none\", \"none\", \"none\", \"none\", \"none\"], 10000, 1337),\n        # Test case 2\n        ([\"sign\", \"none\", \"none\", \"none\", \"none\", \"none\"], 10000, 4242),\n        # Test case 3\n        ([\"reciprocal\", \"none\", \"none\", \"none\", \"none\", \"none\"], 10000, 202311),\n        # Test case 4\n        ([\"reciprocal\", \"none\", \"none\", \"reciprocal\", \"none\", \"reciprocal\"], 10000, 777)\n    ]\n\n    results = []\n    for pattern, N, seed in test_cases:\n        p_hat = estimate_accessibility_probability(pattern, N, seed)\n        results.append(p_hat)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}