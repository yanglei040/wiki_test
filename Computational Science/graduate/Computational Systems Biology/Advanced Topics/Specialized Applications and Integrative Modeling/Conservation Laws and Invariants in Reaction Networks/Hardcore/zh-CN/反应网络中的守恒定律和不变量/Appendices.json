{
    "hands_on_practices": [
        {
            "introduction": "守恒定律并非一组任意的规则，而是直接源于反应网络内在的数学结构。第一个练习将引导你运用化学反应网络理论（CRNT）的核心定义进行实践。通过对一个简单的网络手动计算其关键不变量，你将从第一性原理出发，建立对守恒空间维度如何由网络反应向量决定的深刻理解。",
            "id": "3296877",
            "problem": "考虑一个化学反应网络理论 (CRNT) 意义下的反应网络，该网络由三种化学物种 $A$、$B$ 和 $C$ 组成，并包含以下可逆反应：$A \\rightleftharpoons B$、$B \\rightleftharpoons C$ 和 $C \\rightleftharpoons A$。请在标准的 CRNT 框架内进行分析，其中反应网络由其物种、复合物和反应定义；化学计量子空间是物种空间中反应向量的线性生成空间；联动类是复合物构成的有向图的连通分量；亏格是根据复合物、联动类和化学计量子空间维度的数量来定义的。\n\n从核心定义出发，确定以下网络不变量：\n- 物种数 $n$。\n- 联动类数 $\\ell$。\n- 化学计量子空间的维度 $s$。\n- 亏格 $\\delta$。\n\n然后，仅使用基于形式化定义的第一性原理推导，推断出与此网络相关的守恒律空间的维度。您应当通过识别复合物、构建适当的反应向量以及评估生成空间和连通性，从定义出发推导所有量，而不是调用预先记忆的快捷公式。\n\n将您的最终结果表示为一个单一的解析表达式，该表达式按顺序包含 $n$、$\\ell$、$s$、$\\delta$ 和守恒律空间的维度，并写成单个行向量的形式。无需四舍五入，且不适用物理单位。",
            "solution": "该问题要求遵循化学反应网络理论 (CRNT) 的框架，从第一性原理出发分析一个给定的化学反应网络。目标是确定五个关键的网络不变量：物种数 ($n$)、联动类数 ($\\ell$)、化学计量子空间的维度 ($s$)、网络亏格 ($\\delta$) 以及守恒律空间的维度。\n\n该反应网络定义如下：\n-   **物种：** 集合 $\\mathcal{S} = \\{A, B, C\\}$。\n-   **反应：** $A \\rightleftharpoons B$，$B \\rightleftharpoons C$ 和 $C \\rightleftharpoons A$。\n\n我们基于形式化定义，系统地推导每个所需的量。\n\n**1. 物种数 ($n$)**\n通过观察可知，网络中不同化学物种的数量为三个。\n$$ n = 3 $$\n\n**2. 复合物和联动类 ($\\ell$)**\n反应网络的复合物是作为反应物或产物出现的独特化学实体。这些反应可以写成六个基元步骤：\n$A \\to B$\n$B \\to A$\n$B \\to C$\n$C \\to B$\n$C \\to A$\n$A \\to C$\n\n复合物集合（记为 $\\mathcal{C}$）是反应箭头两侧所有物种的唯一多重集和的集合。在此网络中，复合物就是物种本身。\n$$ \\mathcal{C} = \\{A, B, C\\} $$\n复合物的数量为 $m = |\\mathcal{C}| = 3$。\n\n联动类 $\\ell$ 是反应图的连通分量。反应图是一个有向图，其顶点是复合物，有向边代表反应。\n-   顶点为 $A$、$B$ 和 $C$。\n-   边为 $A \\to B$、$B \\to A$、$B \\to C$、$C \\to B$、$C \\to A$ 和 $A \\to C$。\n\n我们观察到该图是强连通的。对于任意一对顶点，它们之间都存在一条有向路径。例如，可以沿着 $A \\to B \\to C \\to A$ 遍历。由于所有顶点都属于同一个连通分量，因此联动类的数量为：\n$$ \\ell = 1 $$\n\n**3. 化学计量子空间的维度 ($s$)**\n物种浓度存在于一个向量空间中，即物种空间，它与 $\\mathbb{R}^n$ 同构。对于此网络，物种空间是 $\\mathbb{R}^3$。我们可以建立一组基，使物种对应于标准基向量：\n$$ A \\mapsto e_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad B \\mapsto e_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad C \\mapsto e_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n每个反应 $y \\to y'$ 都与一个反应向量相关联，该向量定义为产物复合物向量与反应物复合物向量之差，$y' - y$。对于给定的网络，我们有三对方向相反的反应。只需考虑每对中的一个向量即可，因为逆反应产生的向量只是原向量的负值。我们选择以下三个反应向量：\n-   对于 $A \\to B$：$v_1 = e_2 - e_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n-   对于 $B \\to C$：$v_2 = e_3 - e_2 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$\n-   对于 $C \\to A$：$v_3 = e_1 - e_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$\n\n化学计量子空间 $S$ 是由反应向量在 $\\mathbb{R}^n$ 中生成的线性子空间：\n$$ S = \\text{span}\\{v_1, v_2, v_3\\} $$\n该子空间的维度 $s$ 是此集合中线性无关向量的数量。我们通过寻找 $c_1 v_1 + c_2 v_2 + c_3 v_3 = 0$ 的非平凡解来检验线性相关性：\n$$ c_1 \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + c_2 \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} + c_3 \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n这对应于线性系统：\n$$ \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n直接将这三个向量相加，可以显示出线性相关性：\n$$ v_1 + v_2 + v_3 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1+0+1 \\\\ 1-1+0 \\\\ 0+1-1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n由于这三个向量是线性相关的，它们生成空间的维度小于 $3$。然而，任意一对向量都是线性无关的（例如，$v_1$ 和 $v_2$ 不是彼此的标量倍数）。因此，化学计量子空间的维度是：\n$$ s = \\dim(S) = 2 $$\n\n**4. 亏格 ($\\delta$)**\n反应网络的亏格是一个非负整数，由公式定义：\n$$ \\delta = m - \\ell - s $$\n其中 $m$ 是复合物的数量，$\\ell$ 是联动类的数量，$s$ 是化学计量子空间的维度。代入我们推导出的值：\n$$ \\delta = 3 - 1 - 2 = 0 $$\n该网络的亏格为零。\n\n**5. 守恒律空间的维度**\n守恒律是物种浓度之间的一种线性关系，该关系随时间保持不变。在数学上，守恒律由一个向量 $c \\in \\mathbb{R}^n$ 表示，该向量与每个反应向量正交。所有这些向量的集合构成了守恒律空间，它是化学计量子空间的正交补，记为 $S^{\\perp}$。\n$$ S^{\\perp} = \\{ c \\in \\mathbb{R}^n \\mid c^T v = 0 \\text{ for all } v \\in S \\} $$\n该空间的维度可以根据线性代数基本定理确定，该定理指出，对于有限维内积空间 $V$ 的任何子空间 $S$：\n$$ \\dim(V) = \\dim(S) + \\dim(S^{\\perp}) $$\n在我们的情境中，$V = \\mathbb{R}^n$。因此，守恒律空间的维度是：\n$$ \\dim(S^{\\perp}) = n - s $$\n代入我们得到的 $n$ 和 $s$ 的值：\n$$ \\dim(S^{\\perp}) = 3 - 2 = 1 $$\n存在一个线性无关的守恒律。为了明确地找到它，我们寻找一个向量 $c = (c_A, c_B, c_C)^T$，使得 $c^T v_1 = 0$ 且 $c^T v_2 = 0$（因为 $\\{v_1, v_2\\}$ 是 $S$ 的一组基）。\n-   $c^T v_1 = (c_A, c_B, c_C) \\cdot (-1, 1, 0) = -c_A + c_B = 0 \\implies c_A = c_B$\n-   $c^T v_2 = (c_A, c_B, c_C) \\cdot (0, -1, 1) = -c_B + c_C = 0 \\implies c_B = c_C$\n这意味着 $c_A = c_B = c_C$。守恒律空间由向量 $(1, 1, 1)^T$ 生成。相应的守恒量是总浓度 $x_A + x_B + x_C = \\text{常数}$。该空间的维度是 $1$。\n\n**结果摘要**\n推导出的网络不变量是：\n-   物种数，$n = 3$。\n-   联动类数，$\\ell = 1$。\n-   化学计量子空间的维度，$s = 2$。\n-   亏格，$\\delta = 0$。\n-   守恒律空间的维度，为 $1$。\n\n最终结果表示为所要求的行向量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3  1  2  0  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在掌握了基本原理之后，这个练习将阐明为何严谨的代数方法是不可或缺的。直觉判断往往会产生误导，尤其是在包含催化剂、中间复合物或与环境有物质交换的复杂网络中。本问题要求你分析一个专门设计用于凸显这些常见陷阱的网络，从而强调通过计算化学计量矩阵的左零空间来准确识别真实守恒定律的必要性。",
            "id": "3296878",
            "problem": "我们提出了一个生化反应网络，以说明通过观察与通过化学计量分析来识别守恒律时可能遇到的陷阱。考虑物种向量 $x = \\big[A,\\,B,\\,C,\\,E,\\,D,\\,F\\big]^{\\top}$，其中 $A$、$B$ 和 $C$ 是底物形式，$E$ 是催化剂，$D$ 和 $F$ 是酶-底物复合物。反应如下：\n- $\\mathrm{R}_{1}\\!:\\; A + E \\rightarrow D$\n- $\\mathrm{R}_{2}\\!:\\; D \\rightarrow A + E$\n- $\\mathrm{R}_{3}\\!:\\; D \\rightarrow B + E$\n- $\\mathrm{R}_{4}\\!:\\; B + E \\rightarrow F$\n- $\\mathrm{R}_{5}\\!:\\; F \\rightarrow C + E$\n- $\\mathrm{R}_{6}\\!:\\; C \\rightarrow A$\n- $\\mathrm{R}_{7}\\!:\\; A \\rightarrow \\varnothing$\n- $\\mathrm{R}_{8}\\!:\\; \\varnothing \\rightarrow B$\n\n假设任何与这些化学计量相符的光滑动力学（例如，质量作用动力学），并以标准形式 $\\dot{x} = N\\,v(x)$ 写出常微分方程（ODE）模型，其中 $N$ 是化学计量矩阵，$v(x)$ 是反应速率向量。线性守恒律（也称为化学计量不变量或守恒部分）是一个线性泛函 $L(x) = \\ell^{\\top}x$，对于所有时间和所有遵循该反应图的速率常数和动力学参数的选择，它都保持恒定。\n\n通过观察，人们可能会猜测“总底物”或“总酶”看起来是守恒的。然而，诸如复合物形成和与环境的交换等微妙特征会使这种判断复杂化。\n\n以下哪个量是对于该网络所有允许的动力学都始终守恒的真正线性不变量？选择所有适用项。\n\nA. $A + B + C$ 是守恒的。\n\nB. $A + B + C + D + F$ 是守恒的。\n\nC. $E + D + F$ 是守恒的。\n\nD. $B - C$ 是守恒的。\n\nE. 以上都不是。",
            "solution": "我们从反应网络中线性不变量的结构定义开始。对于一个写成 $\\dot{x} = N\\,v(x)$ 形式的包含 $m$ 个物种、$r$ 个反应的系统，一个线性泛函 $L(x) = \\ell^{\\top}x$ 是一个守恒律，当且仅当\n$$\n\\frac{d}{dt}\\big(\\ell^{\\top}x\\big) \\;=\\; \\ell^{\\top}\\dot{x} \\;=\\; \\ell^{\\top}N\\,v(x) \\;=\\; 0\n$$\n对于每个允许的反应速率向量 $v(x)$ 都成立。这对所有 $v(x)$ 成立，当且仅当\n$$\n\\ell^{\\top}N \\;=\\; 0^{\\top},\n$$\n也就是说，$\\ell$ 位于化学计量矩阵 $N$ 的左零空间中。因此，只要反应图是固定的，不变量的识别就是关于 $N$ 的线性代数问题，并且与速率常数和动力学形式无关。\n\n针对物种排序 $[A,\\,B,\\,C,\\,E,\\,D,\\,F]$ 和反应 $\\mathrm{R}_{1}$ 到 $\\mathrm{R}_{8}$，构造化学计量矩阵 $N$。每一列 $n_{j}$ 是反应 $\\mathrm{R}_{j}$ 的净化学计量变化向量：\n\n- $\\mathrm{R}_{1}\\!:\\; A + E \\rightarrow D \\;\\Rightarrow\\; n_{1} = \\big[-1,\\,0,\\,0,\\,-1,\\,+1,\\,0\\big]^{\\top}$。\n- $\\mathrm{R}_{2}\\!:\\; D \\rightarrow A + E \\;\\Rightarrow\\; n_{2} = \\big[+1,\\,0,\\,0,\\,+1,\\,-1,\\,0\\big]^{\\top}$。\n- $\\mathrm{R}_{3}\\!:\\; D \\rightarrow B + E \\;\\Rightarrow\\; n_{3} = \\big[0,\\,+1,\\,0,\\,+1,\\,-1,\\,0\\big]^{\\top}$。\n- $\\mathrm{R}_{4}\\!:\\; B + E \\rightarrow F \\;\\Rightarrow\\; n_{4} = \\big[0,\\,-1,\\,0,\\,-1,\\,0,\\,+1\\big]^{\\top}$。\n- $\\mathrm{R}_{5}\\!:\\; F \\rightarrow C + E \\;\\Rightarrow\\; n_{5} = \\big[0,\\,0,\\,+1,\\,+1,\\,0,\\,-1\\big]^{\\top}$。\n- $\\mathrm{R}_{6}\\!:\\; C \\rightarrow A \\;\\Rightarrow\\; n_{6} = \\big[+1,\\,0,\\,-1,\\,0,\\,0,\\,0\\big]^{\\top}$。\n- $\\mathrm{R}_{7}\\!:\\; A \\rightarrow \\varnothing \\;\\Rightarrow\\; n_{7} = \\big[-1,\\,0,\\,0,\\,0,\\,0,\\,0\\big]^{\\top}$。\n- $\\mathrm{R}_{8}\\!:\\; \\varnothing \\rightarrow B \\;\\Rightarrow\\; n_{8} = \\big[0,\\,+1,\\,0,\\,0,\\,0,\\,0\\big]^{\\top}$。\n\n因此 $N = \\big[n_{1}\\;\\cdots\\;n_{8}\\big]$。一个向量 $\\ell = \\big[\\ell_{A},\\,\\ell_{B},\\,\\ell_{C},\\,\\ell_{E},\\,\\ell_{D},\\,\\ell_{F}\\big]^{\\top}$ 位于左零空间中，当且仅当对于 $j \\in \\{1,\\dots,8\\}$，$\\ell^{\\top}n_{j} = 0$ 成立，这施加了以下线性约束：\n- 来自 $\\mathrm{R}_{7}$：$-\\,\\ell_{A} = 0 \\Rightarrow \\ell_{A} = 0$。\n- 来自 $\\mathrm{R}_{8}$：$+\\,\\ell_{B} = 0 \\Rightarrow \\ell_{B} = 0$。\n- 来自 $\\mathrm{R}_{6}$：$+\\,\\ell_{A} - \\ell_{C} = 0 \\Rightarrow \\ell_{C} = \\ell_{A} = 0$。\n- 来自 $\\mathrm{R}_{1}$：$-\\,\\ell_{A} - \\ell_{E} + \\ell_{D} = 0 \\Rightarrow \\ell_{D} = \\ell_{E}$ (因为 $\\ell_{A} = 0$)。\n- 来自 $\\mathrm{R}_{3}$：$+\\,\\ell_{B} + \\ell_{E} - \\ell_{D} = 0 \\Rightarrow \\ell_{E} - \\ell_{D} = 0$ (与 $\\ell_{D} = \\ell_{E}$ 一致)。\n- 来自 $\\mathrm{R}_{4}$：$-\\,\\ell_{B} - \\ell_{E} + \\ell_{F} = 0 \\Rightarrow \\ell_{F} = \\ell_{E}$。\n- 来自 $\\mathrm{R}_{5}$：$+\\,\\ell_{C} + \\ell_{E} - \\ell_{F} = 0 \\Rightarrow \\ell_{E} - \\ell_{F} = 0$ (与 $\\ell_{F} = \\ell_{E}$ 一致)。\n- 来自 $\\mathrm{R}_{2}$：$+\\,\\ell_{A} + \\ell_{E} - \\ell_{D} = 0$ (再次与 $\\ell_{D} = \\ell_{E}$ 一致)。\n\n因此，左零空间是一维的，由以下形式的向量张成：\n$$\n\\ell \\;=\\; \\big[\\,0,\\,0,\\,0,\\,t,\\,t,\\,t\\,\\big]^{\\top},\\quad t \\in \\mathbb{R}.\n$$\n等价地，唯一的（在尺度上）守恒线性池是 $E + D + F$，即包括复合物在内的“总酶”。在这个开放系统中，由于源/汇反应 $\\mathrm{R}_{7}$ 和 $\\mathrm{R}_{8}$ 的存在，任何涉及 $A$、$B$ 或 $C$ 的线性组合都不能守恒。\n\n现在评估每个选项：\n\n- 选项 A：$A + B + C$ 对应于 $\\ell = \\big[1,\\,1,\\,1,\\,0,\\,0,\\,0\\big]^{\\top}$。检查 $\\ell^{\\top}n_{1} = -1 \\neq 0$，因为 $\\mathrm{R}_{1}$ 将 $A$ 移入 $D$，而没有在 $A + B + C$ 内部进行补偿。因此这不是一个守恒律。这说明了忽略瞬时复合物的陷阱：通过观察，人们可能认为“总底物形式”是守恒的，但复合物的形成将质量移出了所选的池。\n\n- 选项 B：$A + B + C + D + F$ 对应于 $\\ell = \\big[1,\\,1,\\,1,\\,0,\\,1,\\,1\\big]^{\\top}$。虽然这个池在封闭子网络 $\\{\\mathrm{R}_{1}\\text{–}\\mathrm{R}_{6}\\}$ 中是守恒的，但在整个网络中它不守恒，因为 $\\mathrm{R}_{7}$ 和 $\\mathrm{R}_{8}$ 与环境交换物质：$\\ell^{\\top}n_{7} = -1 \\neq 0$ 且 $\\ell^{\\top}n_{8} = +1 \\neq 0$。这暴露了一个常见的陷阱：从内部循环推断守恒，而忽略了外部的源和汇。\n\n- 选项 C：$E + D + F$ 对应于 $\\ell = \\big[0,\\,0,\\,0,\\,1,\\,1,\\,1\\big]^{\\top}$。对于每个反应，$E + D + F$ 的净变化为零：对于所有 $j \\in \\{1,\\dots,8\\}$，$\\ell^{\\top}n_{j} = 0$。因此 $E + D + F$ 确实是一个守恒部分（总酶池），与动力学无关。这是给定网络的唯一独立线性不变量。\n\n- 选项 D：$B - C$ 对应于 $\\ell = \\big[0,\\,1,\\,-1,\\,0,\\,0,\\,0\\big]^{\\top}$。对于 $\\mathrm{R}_{3}$，$\\ell^{\\top}n_{3} = +1 \\neq 0$，对于 $\\mathrm{R}_{5}$，$\\ell^{\\top}n_{5} = -1 \\neq 0$。因此不守恒。\n\n- 选项 E：“以上都不是”是错误的，因为选项 C 是有效的。\n\n所说明的陷阱总结：\n- 忽略复合物（$D$ 和 $F$）会导致错误地认为 $A + B + C$ 是守恒的。\n- 忽略与环境的交换反应（$\\mathrm{R}_{7}$ 和 $\\mathrm{R}_{8}$）会导致错误地认为 $A + B + C + D + F$ 是守恒的。\n- 正确的识别需要计算化学计量矩阵 $N$ 的左零空间，而不是对反应图进行基于路径的目视检查。\n\n因此，唯一正确的选择是选项 C。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "最后的练习将理论与实际应用联系起来。你将通过编程来分析一个重要的生物学通路——糖酵解，并以计算的方式验证其已知的守恒部分，例如腺苷酸池和烟酰胺池。这个练习展示了化学计量矩阵和零空间这些抽象概念，如何转变为在规模化系统生物学中用于模型降维和验证的强大工具。",
            "id": "3296813",
            "problem": "考虑由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times r}$ 表示的反应网络，其中 $m$ 是化学物种的数量，$r$ 是反应的数量。设 $x(t) \\in \\mathbb{R}^m$ 表示物种量向量，$v(t) \\in \\mathbb{R}^r$ 表示反应速率向量。在化学计量动力学下，时间演化为 $ \\frac{dx}{dt} = S v(t) $。一个线性守恒部分是任意向量 $c \\in \\mathbb{R}^m$，使得 $c^\\top S = 0$，这意味着对于所有允许的 $v(t)$，都有 $\\frac{d}{dt}(c^\\top x(t)) = 0$，即 $c^\\top x(t)$ 是不变量。\n\n您的任务是实现一个程序，该程序：\n- 为一个精选的糖酵解子网络和额外的测试网络构建 $S$。\n- 计算 $S$ 的左零空间（等价于 $S^\\top$ 的零空间）的维数，也就是线性无关守恒定律的数量。\n- 通过检查 $c^\\top S = 0$（使用规定的数值容差），验证指定的守恒部分（基于糖酵解的文献注释，如腺苷酸和烟酰胺腺嘌呤二核苷酸池，以及磷酸基团计数）是否属于左零空间。\n\n您必须使用以下基本原理：\n- 化学计量动力学的定义 $\\frac{dx}{dt} = S v(t)$。\n- 线性守恒定律和不变量的定义 $c^\\top S = 0$。\n- 线性代数事实：左零空间的维数等于 $\\mathrm{Null}(S^\\top)$ 的维数，并且向量 $c$ 是一个守恒定律当且仅当 $c^\\top S = 0$。\n\n构建以下反应网络测试套件。每个反应都以化学计量变化的形式给出，其中反应物（负）和产物（正）具有整数系数。在指定的物种集合内，所有反应都是质量平衡的。此问题中没有物理单位；所有量都是无量纲的。\n\n测试用例 $1$（无交换的精选糖酵解子网络）：\n- 物种（按顺序）：$[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH$]$。\n- 反应（共 $10$ 个）：\n    - 己糖激酶 (Hexokinase): $-1$ GLU $-1$ ATP $+1$ G6P $+1$ ADP。\n    - 磷酸葡萄糖异构酶 (Phosphoglucose isomerase): $-1$ G6P $+1$ F6P。\n    - 磷酸果糖激酶 (Phosphofructokinase): $-1$ F6P $-1$ ATP $+1$ FBP $+1$ ADP。\n    - 醛缩酶 (Aldolase): $-1$ FBP $+1$ GAP $+1$ DHAP。\n    - 磷酸丙糖异构酶 (Triose phosphate isomerase): $-1$ DHAP $+1$ GAP。\n    - 3-磷酸甘油醛脱氢酶 (Glyceraldehyde-3-phosphate dehydrogenase): $-1$ GAP $-1$ Pi $-1$ NAD $+1$ 13BPG $+1$ NADH。\n    - 磷酸甘油酸激酶 (Phosphoglycerate kinase): $-1$ 13BPG $-1$ ADP $+1$ 3PG $+1$ ATP。\n    - 磷酸甘油酸变位酶 (Phosphoglycerate mutase): $-1$ 3PG $+1$ 2PG。\n    - 烯醇化酶 (Enolase): $-1$ 2PG $+1$ PEP。\n    - 丙酮酸激酶 (Pyruvate kinase): $-1$ PEP $-1$ ADP $+1$ PYR $+1$ ATP。\n- 待交叉验证的文献部分：\n    - 腺苷酸池 (Adenylate pool): $c_{\\mathrm{A}}$，在 ATP 和 ADP 上为 $1$，其余为 $0$。\n    - 烟酰胺腺嘌呤二核苷酸池 (Nicotinamide adenine dinucleotide pool): $c_{\\mathrm{N}}$，在 NAD 和 NADH 上为 $1$，其余为 $0$。\n    - 磷酸基团计数 (Phosphate group count): $c_{\\mathrm{P}}$，系数等于每个物种的磷酸基团数：\n        - GLU $0$, G6P $1$, F6P $1$, FBP $2$, GAP $1$, DHAP $1$, 13BPG $2$, 3PG $1$, 2PG $1$, PEP $1$, PYR $0$, ATP $3$, ADP $2$, Pi $1$, NAD $0$, NADH $0$。\n\n测试用例 $2$（糖酵解加腺苷酸激酶）：\n- 物种：与测试用例 $1$ 相同，外加 AMP，即 $[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH, AMP$]$。\n- 反应：测试用例 $1$ 的所有反应，外加腺苷酸激酶 (adenylate kinase)：$-2$ ADP $+1$ ATP $+1$ AMP。\n- 待交叉验证的文献部分：\n    - 腺苷酸池 (Adenylate pool): $c_{\\mathrm{A}}$，在 ATP、ADP 和 AMP 上为 $1$。\n    - 烟酰胺腺嘌呤二核苷酸池 (Nicotinamide adenine dinucleotide pool): $c_{\\mathrm{N}}$，在 NAD 和 NADH 上为 $1$。\n    - 磷酸基团计数 (Phosphate group count): $c_{\\mathrm{P}}$，每个物种的磷酸基团数，并扩展 AMP 为 $1$。\n\n测试用例 $3$（带外部 NAD 消耗的糖酵解）：\n- 物种：与测试用例 $1$ 相同，外加一个外部汇 EXT，即 $[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH, EXT$]$。\n- 反应：测试用例 $1$ 的所有反应，外加一个外部消耗：$-1$ NAD $+1$ EXT。\n- 待交叉验证的文献部分：\n    - 腺苷酸池 (Adenylate pool): $c_{\\mathrm{A}}$，在 ATP 和 ADP 上为 $1$。\n    - 烟酰胺腺嘌呤二核苷酸池 (Nicotinamide adenine dinucleotide pool): $c_{\\mathrm{N}}$，在 NAD 和 NADH 上为 $1$（由于消耗，预计不守恒）。\n    - 磷酸基团计数 (Phosphate group count): $c_{\\mathrm{P}}$，与测试用例 $1$ 中相同（EXT 的磷酸基团数为 $0$）。\n\n测试用例 $4$（最小双物种相互转化）：\n- 物种：$[$A, B$]$。\n- 反应：$-1$ A $+1$ B 和 $-1$ B $+1$ A。\n- 待交叉验证的文献部分：\n    - 总量 (Total amount): $c_{\\mathrm{T}}$，在 A 和 B 上均为 $1$。\n\n算法要求：\n- 对于每个测试用例，将 $S$ 构建为一个 $m \\times r$ 矩阵，其中条目 $S_{i,j}$ 等于物种 $i$ 在反应 $j$ 中的净化学计量系数。\n- 将左零空间维数计算为 $\\mathrm{Null}(S^\\top)$ 的标准正交基中的列数。\n- 对于每个指定的守恒部分向量 $c$，计算 $c^\\top S$，如果 $\\max_j |(c^\\top S)_j| \\leq \\tau$（容差 $\\tau = 10^{-12}$），则声明其守恒。\n- 最终输出格式必须是单行，包含四个测试用例的结果，形式为用方括号括起来的逗号分隔的列表的列表。对于测试用例 $1$、测试用例 $2$ 和测试用例 $3$，每个内部列表必须是 $[d,a,n,p]$，其中 $d$ 是左零空间维数，$a$、$n$、$p$ 是整数（$1$ 表示守恒，$0$ 表示不守恒），分别对应于腺苷酸、烟酰胺腺嘌呤二核苷酸和磷酸基团部分。对于测试用例 $4$，内部列表必须是 $[d,t]$，其中如果 $c_{\\mathrm{T}}$ 守恒，则 $t$ 为 $1$，否则为 $0$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[[d_1,a_1,n_1,p_1], [d_2,a_2,n_2,p_2], [d_3,a_3,n_3,p_3], [d_4,t_4 ]]$）。",
            "solution": "用户提供的问题是有效的。它在科学上基于化学反应网络理论和线性代数的原理，问题表述清晰，目标明确，数据充分，并且其表述是客观的。该问题要求分析指定生化反应网络中的守恒定律，这是计算系统生物学中的一个标准任务。\n\n解决方案通过对每个测试用例实施指定的分析来进行。核心原理是，对于一个化学反应系统，其动力学由 $\\frac{d\\vec{x}}{dt} = S \\vec{v}(t)$ 描述，其中 $\\vec{x}$ 是物种浓度向量，$S$ 是化学计量矩阵，$\\vec{v}(t)$ 是反应速率向量，一个线性守恒定律由一个向量 $\\vec{c}$ 表示，使得量 $\\vec{c}^\\top \\vec{x}$ 随时间保持恒定。这当且仅当对于所有有效的速率向量 $\\vec{v}(t)$，$\\frac{d}{dt}(\\vec{c}^\\top \\vec{x}) = \\vec{c}^\\top \\frac{d\\vec{x}}{dt} = \\vec{c}^\\top S \\vec{v}(t) = 0$。该条件简化为 $\\vec{c}^\\top S = \\vec{0}^\\top$。\n\n因此，所有线性守恒定律的集合构成了化学计量矩阵 $S$ 的左零空间。线性无关的守恒定律的数量等于该向量空间的维数，这等价于 $S$ 的转置矩阵的零空间维数，即 $\\dim(\\mathrm{Null}(S^\\top))$。\n\n每个测试用例的计算过程如下：\n$1$。**化学计量矩阵构建**：对于一个有 $m$ 个物种和 $r$ 个反应的网络，构建一个 $m \\times r$ 的矩阵 $S$。每一列 $j$ 对应一个反应，每一行 $i$ 对应一个物种。元素 $S_{ij}$ 是物种 $i$ 在反应 $j$ 中的化学计量系数。反应物的系数为负，产物的系数为正。\n$2$。**零空间维数计算**：计算 $S$ 的左零空间的维数。这通过首先计算转置 $S^\\top$，然后找到其零空间 $\\mathrm{Null}(S^\\top)$ 的一个标准正交基来实现。该基中向量（列）的数量就是零空间的维数。\n$3$。**守恒部分验证**：对于每个提出的守恒部分向量 $\\vec{c}$，计算乘积 $\\vec{p}^\\top = \\vec{c}^\\top S$。如果 $\\vec{p}^\\top$ 在数值上接近于零向量，则确认该部分是守恒的。检查的标准是 $\\vec{p}$ 元素的最大绝对值不得超过容差 $\\tau = 10^{-12}$，即 $\\max_j |\\vec{p}_j| \\leq 10^{-12}$。结果为 $1$ 表示守恒，为 $0$ 表示不守恒。\n\n此过程应用于所提供的四个测试用例。\n\n**测试用例 $1$：精选的糖酵解子网络**\n- 物种数量，$m = 16$。\n- 反应数量，$r = 10$。\n- 物种按顺序排列：$[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH$]$。\n- 根据给定的 $10$ 个反应构建 $16 \\times 10$ 的化学计量矩阵 $S_1$。\n- 待测试的部分是：\n    - $\\vec{c}_{\\mathrm{A}}$：腺苷酸池，ATP 和 ADP 的系数为 $1$。\n    - $\\vec{c}_{\\mathrm{N}}$：烟酰胺腺嘌呤二核苷酸池，NAD 和 NADH 的系数为 $1$。\n    - $\\vec{c}_{\\mathrm{P}}$：磷酸基团计数，系数对应于每个物种中的磷酸基团数量。\n- **结果**：\n    - $S_1$ 的左零空间的维数计算为 $3$。\n    - 验证 $\\vec{c}_{\\mathrm{A}}^\\top S_1 = \\vec{0}^\\top$：测试通过。腺苷酸池是守恒的。结果为 $1$。\n    - 验证 $\\vec{c}_{\\mathrm{N}}^\\top S_1 = \\vec{0}^\\top$：测试通过。NAD/NADH 池是守恒的。结果为 $1$。\n    - 验证 $\\vec{c}_{\\mathrm{P}}^\\top S_1 = \\vec{0}^\\top$：测试通过。磷酸基团计数是守恒的。结果为 $1$。\n\n**测试用例 $2$：糖酵解加腺苷酸激酶**\n- 物种数量，$m = 17$（原始 $16$ 个加 AMP）。\n- 反应数量，$r = 11$（原始 $10$ 个加腺苷酸激酶：$-2$ ADP $+1$ ATP $+1$ AMP）。\n- 构建 $17 \\times 11$ 的化学计量矩阵 $S_2$。\n- 待测试的部分更新为：\n    - $\\vec{c}_{\\mathrm{A}}$：现在包括 AMP，ATP、ADP 和 AMP 的系数均为 $1$。\n    - $\\vec{c}_{\\mathrm{N}}$：与测试用例 $1$ 中相同。\n    - $\\vec{c}_{\\mathrm{P}}$：现在包括 AMP，其有 $1$ 个磷酸基团。\n- **结果**：\n    - $S_2$ 的左零空间的维数计算为 $3$。\n    - 验证 $\\vec{c}_{\\mathrm{A}}^\\top S_2 = \\vec{0}^\\top$：测试通过。扩展的腺苷酸池是守恒的。结果为 $1$。\n    - 验证 $\\vec{c}_{\\mathrm{N}}^\\top S_2 = \\vec{0}^\\top$：测试通过。NAD/NADH 池不受影响，仍然守恒。结果为 $1$。\n    - 验证 $\\vec{c}_{\\mathrm{P}}^\\top S_2 = \\vec{0}^\\top$：测试通过。扩展的磷酸基团计数是守恒的。结果为 $1$。\n\n**测试用例 $3$：带外部 NAD 消耗的糖酵解**\n- 物种数量，$m = 17$（原始 $16$ 个加一个外部物种 EXT）。\n- 反应数量，$r = 11$（原始 $10$ 个加一个消耗反应：$-1$ NAD $+1$ EXT）。\n- 构建 $17 \\times 11$ 的化学计量矩阵 $S_3$。\n- 待测试的部分是：\n    - $\\vec{c}_{\\mathrm{A}}$：与测试用例 $1$ 中相同。\n    - $\\vec{c}_{\\mathrm{N}}$：与测试用例 $1$ 中相同，但现在预计为非守恒。\n    - $\\vec{c}_{\\mathrm{P}}$：与测试用例 $1$ 中相同（EXT 被分配 $0$ 个磷酸基团）。\n- **结果**：\n    - $S_3$ 的左零空间的维数计算为 $2$。消耗反应破坏了一个守恒定律。\n    - 验证 $\\vec{c}_{\\mathrm{A}}^\\top S_3 = \\vec{0}^\\top$：测试通过。腺苷酸池不受影响。结果为 $1$。\n    - 验证 $\\vec{c}_{\\mathrm{N}}^\\top S_3 = \\vec{0}^\\top$：测试失败，如预期。消耗反应从池中消耗了 NAD。结果为 $0$。\n    - 验证 $\\vec{c}_{\\mathrm{P}}^\\top S_3 = \\vec{0}^\\top$：测试通过。磷酸基团计数不受影响。结果为 $1$。\n\n**测试用例 $4$：最小双物种相互转化**\n- 物种数量，$m = 2$ (A, B)。\n- 反应数量，$r = 2$ ($-1$ A $+1$ B 和 $-1$ B $+1$ A)。\n- 构建 $2 \\times 2$ 的化学计量矩阵 $S_4$。\n- 待测试的部分是 $\\vec{c}_{\\mathrm{T}}$，表示 A 和 B 的总和，两者的系数均为 $1$。\n- **结果**：\n    - $S_4$ 的左零空间的维数计算为 $1$。\n    - 验证 $\\vec{c}_{\\mathrm{T}}^\\top S_4 = \\vec{0}^\\top$：测试通过。总量是守恒的。结果为 $1$。\n\n以下代码实现了此分析并生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef solve():\n    \"\"\"\n    Constructs stoichiometric matrices for four test cases,\n    computes the number of conservation laws, and verifies specified\n    conserved moieties.\n    \"\"\"\n\n    # --- Test Case Data ---\n\n    # Test Case 1: Curated glycolysis subnetwork\n    species1 = ['GLU', 'G6P', 'F6P', 'FBP', 'GAP', 'DHAP', '13BPG', '3PG', '2PG', 'PEP', 'PYR', 'ATP', 'ADP', 'Pi', 'NAD', 'NADH']\n    reactions1 = [\n        {'GLU': -1, 'ATP': -1, 'G6P': 1, 'ADP': 1},        # Hexokinase\n        {'G6P': -1, 'F6P': 1},                             # Phosphoglucose isomerase\n        {'F6P': -1, 'ATP': -1, 'FBP': 1, 'ADP': 1},        # Phosphofructokinase\n        {'FBP': -1, 'GAP': 1, 'DHAP': 1},                  # Aldolase\n        {'DHAP': -1, 'GAP': 1},                            # Triose phosphate isomerase\n        {'GAP': -1, 'Pi': -1, 'NAD': -1, '13BPG': 1, 'NADH': 1}, # GAPDH\n        {'13BPG': -1, 'ADP': -1, '3PG': 1, 'ATP': 1},      # Phosphoglycerate kinase\n        {'3PG': -1, '2PG': 1},                             # Phosphoglycerate mutase\n        {'2PG': -1, 'PEP': 1},                             # Enolase\n        {'PEP': -1, 'ADP': -1, 'PYR': 1, 'ATP': 1}         # Pyruvate kinase\n    ]\n    moieties1 = {\n        'a': {'ATP': 1, 'ADP': 1},\n        'n': {'NAD': 1, 'NADH': 1},\n        'p': {'G6P': 1, 'F6P': 1, 'FBP': 2, 'GAP': 1, 'DHAP': 1, '13BPG': 2, '3PG': 1, '2PG': 1, 'PEP': 1, 'ATP': 3, 'ADP': 2, 'Pi': 1}\n    }\n    moiety_keys1 = ['a', 'n', 'p']\n\n    # Test Case 2: Glycolysis plus adenylate kinase\n    species2 = species1 + ['AMP']\n    reactions2 = reactions1 + [{'ADP': -2, 'ATP': 1, 'AMP': 1}]  # Adenylate kinase\n    moieties2 = {\n        'a': {'ATP': 1, 'ADP': 1, 'AMP': 1},\n        'n': {'NAD': 1, 'NADH': 1},\n        'p': {**moieties1['p'], 'AMP': 1}\n    }\n    moiety_keys2 = ['a', 'n', 'p']\n\n    # Test Case 3: Glycolysis with an external NAD drain\n    species3 = species1 + ['EXT']\n    reactions3 = reactions1 + [{'NAD': -1, 'EXT': 1}]  # NAD drain\n    moieties3 = {\n        'a': {'ATP': 1, 'ADP': 1},\n        'n': {'NAD': 1, 'NADH': 1},\n        'p': moieties1['p']\n    }\n    moiety_keys3 = ['a', 'n', 'p']\n\n    # Test Case 4: Minimal two-species interconversion\n    species4 = ['A', 'B']\n    reactions4 = [{'A': -1, 'B': 1}, {'B': -1, 'A': 1}]\n    moieties4 = {'t': {'A': 1, 'B': 1}}\n    moiety_keys4 = ['t']\n\n    test_cases = [\n        (species1, reactions1, moieties1, moiety_keys1),\n        (species2, reactions2, moieties2, moiety_keys2),\n        (species3, reactions3, moieties3, moiety_keys3),\n        (species4, reactions4, moieties4, moiety_keys4)\n    ]\n\n    all_results = []\n    TOL = 1e-12\n\n    for species, reactions, moieties, moiety_keys in test_cases:\n        m = len(species)\n        r = len(reactions)\n        species_map = {name: i for i, name in enumerate(species)}\n\n        # 1. Construct the stoichiometric matrix S\n        S = np.zeros((m, r))\n        for j, reaction in enumerate(reactions):\n            for species_name, coeff in reaction.items():\n                if species_name in species_map:\n                    i = species_map[species_name]\n                    S[i, j] = coeff\n\n        # 2. Compute the dimension of the left nullspace of S\n        # This is dim(Null(S.T))\n        dim_left_null = null_space(S.T).shape[1]\n        \n        case_results = [dim_left_null]\n\n        # 3. Verify specified conserved moieties\n        for key in moiety_keys:\n            moiety_dict = moieties[key]\n            c = np.zeros(m)\n            for species_name, coeff in moiety_dict.items():\n                if species_name in species_map:\n                    i = species_map[species_name]\n                    c[i] = coeff\n            \n            # Check if c.T * S is the zero vector\n            prod = c.T @ S\n            is_conserved = 1 if np.max(np.abs(prod)) = TOL else 0\n            case_results.append(is_conserved)\n        \n        all_results.append(case_results)\n\n    # Format the final print statement as specified.\n    # e.g., [[3,1,1,1],[3,1,1,1],[2,1,0,1],[1,1]]\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}