{
    "hands_on_practices": [
        {
            "introduction": "理解任何动力系统的基础是确定其长期行为结果。本练习以经典的Lotka-Volterra竞争模型为实验平台，旨在让您掌握寻找平衡点并通过线性化分析其稳定性的核心技术。这些技能对于预测物种是共存还是一个物种将导致另一个物种灭绝至关重要。",
            "id": "3304763",
            "problem": "考虑经典的双物种 Lotka–Volterra 竞争模型，该模型描述了两个种群 $N_{1}(t)$ 和 $N_{2}(t)$ 为争夺共享的有限资源而产生的动态变化：\n$$\n\\frac{dN_{1}}{dt} \\;=\\; r_{1}\\,N_{1}\\left(1 \\;-\\; \\frac{N_{1} \\;+\\; \\alpha_{12}\\,N_{2}}{K_{1}}\\right), \n\\qquad\n\\frac{dN_{2}}{dt} \\;=\\; r_{2}\\,N_{2}\\left(1 \\;-\\; \\frac{N_{2} \\;+\\; \\alpha_{21}\\,N_{1}}{K_{2}}\\right),\n$$\n其中 $r_{1}, r_{2}  0$ 是内禀增长率，$K_{1}, K_{2}  0$ 是环境承载力，$\\alpha_{12}, \\alpha_{21}  0$ 是种间竞争系数。群落矩阵定义为向量场关于 $(N_{1}, N_{2})$ 在平衡点处求值的雅可比矩阵。\n\n从第一性原理和常微分方程组局部稳定性的核心定义出发，执行以下步骤：\n- 识别系统的所有生物学相关平衡点（如果存在，包括共存平衡点）。\n- 通过对右侧函数关于 $(N_{1}, N_{2})$ 求导并在平衡点处求值，计算每个平衡点的群落矩阵。\n- 分析群落矩阵的特征值，以参数 $(r_{1}, r_{2}, K_{1}, K_{2}, \\alpha_{12}, \\alpha_{21})$ 的形式确定哪些平衡点是局部渐近稳定的。仅使用从特征多项式导出的 $2\\times 2$ 线性系统的一般判据（迹和行列式条件）；不要假设任何特殊情况的捷径。\n- 根据您的分析，用 $(K_{1}, K_{2}, \\alpha_{12}, \\alpha_{21})$ 之间的不等式陈述导致竞争排斥（只有一个物种存续）和导致局部渐近稳定共存平衡点的参数组合。\n\n最后，考虑参数化 $r_{1} = 0.5\\,\\mathrm{d}^{-1}$，$r_{2} = 0.8\\,\\mathrm{d}^{-1}$，$K_{1} = 900\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$，$K_{2} = 600\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$，并固定 $\\alpha_{12} = 0.7$。利用您的一般性结果，确定使共存平衡点既可行（所有分量严格为正）又局部渐近稳定的 $\\alpha_{21}$ 的最大值。将您的最终答案表示为一个无单位的实数，并四舍五入到四位有效数字。",
            "solution": "该问题具有科学依据，提法恰当，客观，并为进行完整分析提供了所有必要信息。这是数学生态学中的一个标准练习，因此是有效的。\n\n两个竞争物种的动态由 Lotka-Volterra 竞争模型描述：\n$$ \\frac{dN_{1}}{dt} = f_1(N_1, N_2) = r_{1}N_{1}\\left(1 - \\frac{N_{1} + \\alpha_{12}N_{2}}{K_{1}}\\right) $$\n$$ \\frac{dN_{2}}{dt} = f_2(N_1, N_2) = r_{2}N_{2}\\left(1 - \\frac{N_{2} + \\alpha_{21}N_{1}}{K_{2}}\\right) $$\n所有参数 $r_{1}, r_{2}, K_{1}, K_{2}, \\alpha_{12}, \\alpha_{21}$ 均为正数，种群数量 $N_1, N_2$ 为非负数。\n\n**第1步：识别平衡点**\n平衡点 $(\\hat{N}_1, \\hat{N}_2)$ 可通过将两个时间导数都设为零来找到：$f_1(\\hat{N}_1, \\hat{N}_2) = 0$ 和 $f_2(\\hat{N}_1, \\hat{N}_2) = 0$。\n从第一个方程，我们得到 $\\hat{N}_1 = 0$ 或 $1 - \\frac{\\hat{N}_1 + \\alpha_{12}\\hat{N}_2}{K_1} = 0$。\n从第二个方程，我们得到 $\\hat{N}_2 = 0$ 或 $1 - \\frac{\\hat{N}_2 + \\alpha_{21}\\hat{N}_1}{K_2} = 0$。\n组合这些条件可得出四个可能的平衡点：\n1.  **平凡平衡点 ($E_0$)**：$\\hat{N}_1 = 0$ 且 $\\hat{N}_2 = 0$。这得到 $E_0 = (0, 0)$。\n2.  **排斥平衡点 ($E_1$)**：$\\hat{N}_2 = 0$ 且 $\\hat{N}_1 \\neq 0$。第一个零增长线给出 $\\hat{N}_1 = K_1$。这得到 $E_1 = (K_1, 0)$。\n3.  **排斥平衡点 ($E_2$)**：$\\hat{N}_1 = 0$ 且 $\\hat{N}_2 \\neq 0$。第二个零增长线给出 $\\hat{N}_2 = K_2$。这得到 $E_2 = (0, K_2)$。\n4.  **共存平衡点 ($E_c$)**：$\\hat{N}_1 \\neq 0$ 且 $\\hat{N}_2 \\neq 0$。这需要解零增长线的线性方程组：\n    $$ \\hat{N}_1 + \\alpha_{12}\\hat{N}_2 = K_1 $$\n    $$ \\alpha_{21}\\hat{N}_1 + \\hat{N}_2 = K_2 $$\n    解此方程组得到 $(\\hat{N}_1, \\hat{N}_2)$：\n    $$ \\hat{N}_1 = \\frac{K_1 - \\alpha_{12}K_2}{1 - \\alpha_{12}\\alpha_{21}} $$\n    $$ \\hat{N}_2 = \\frac{K_2 - \\alpha_{21}K_1}{1 - \\alpha_{12}\\alpha_{21}} $$\n    这个平衡点记为 $E_c = (\\hat{N}_1, \\hat{N}_2)$。为了使其在生物学上是可行的，我们必须有 $\\hat{N}_1  0$ 和 $\\hat{N}_2  0$。\n\n**第2步：群落矩阵（雅可比矩阵）**\n群落矩阵是系统的雅可比矩阵，$J(N_1, N_2)$：\n$$ J = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial N_1}  \\frac{\\partial f_1}{\\partial N_2} \\\\ \\frac{\\partial f_2}{\\partial N_1}  \\frac{\\partial f_2}{\\partial N_2} \\end{pmatrix} $$\n偏导数是：\n$\\frac{\\partial f_1}{\\partial N_1} = r_1 - \\frac{2r_1 N_1}{K_1} - \\frac{r_1 \\alpha_{12} N_2}{K_1}$\n$\\frac{\\partial f_1}{\\partial N_2} = -\\frac{r_1 \\alpha_{12} N_1}{K_1}$\n$\\frac{\\partial f_2}{\\partial N_1} = -\\frac{r_2 \\alpha_{21} N_2}{K_2}$\n$\\frac{\\partial f_2}{\\partial N_2} = r_2 - \\frac{2r_2 N_2}{K_2} - \\frac{r_2 \\alpha_{21} N_1}{K_2}$\n\n**第3步：平衡点的稳定性分析**\n平衡点的局部渐近稳定性要求在该点求值的雅可比矩阵的所有特征值都具有负实部。对于一个 $2 \\times 2$ 矩阵，这等价于其迹为负（$\\mathrm{Tr}(J)  0$）且其行列式为正（$\\mathrm{Det}(J)  0$）的条件。\n\n-   **$E_0 = (0, 0)$ 的分析**：\n    $J(0,0) = \\begin{pmatrix} r_1  0 \\\\ 0  r_2 \\end{pmatrix}$。特征值为 $\\lambda_1 = r_1  0$ 和 $\\lambda_2 = r_2  0$。由于两者都为正， $E_0$ 总是一个不稳定的节点。\n\n-   **$E_1 = (K_1, 0)$ 的分析**：\n    $J(K_1, 0) = \\begin{pmatrix} r_1 - \\frac{2r_1 K_1}{K_1}  -\\frac{r_1 \\alpha_{12} K_1}{K_1} \\\\ 0  r_2 - \\frac{r_2 \\alpha_{21} K_1}{K_2} \\end{pmatrix} = \\begin{pmatrix} -r_1  -r_1 \\alpha_{12} \\\\ 0  r_2(1 - \\frac{\\alpha_{21}K_1}{K_2}) \\end{pmatrix}$。\n    特征值是对角线元素：$\\lambda_1 = -r_1$ 和 $\\lambda_2 = r_2(1 - \\frac{\\alpha_{21}K_1}{K_2})$。由于 $r_10$，$\\lambda_1$ 总是负的。为了稳定性，我们需要 $\\lambda_2  0$，这意味着 $1 - \\frac{\\alpha_{21}K_1}{K_2}  0$，或 $K_2  \\alpha_{21}K_1$。\n\n-   **$E_2 = (0, K_2)$ 的分析**：\n    $J(0, K_2) = \\begin{pmatrix} r_1 - \\frac{r_1 \\alpha_{12} K_2}{K_1}  0 \\\\ -\\frac{r_2 \\alpha_{21} K_2}{K_2}  r_2 - \\frac{2r_2 K_2}{K_2} \\end{pmatrix} = \\begin{pmatrix} r_1(1 - \\frac{\\alpha_{12}K_2}{K_1})  0 \\\\ -r_2 \\alpha_{21}  -r_2 \\end{pmatrix}$。\n    特征值为 $\\lambda_1 = r_1(1 - \\frac{\\alpha_{12}K_2}{K_1})$ 和 $\\lambda_2 = -r_2$。为了稳定性，我们需要 $\\lambda_1  0$，这意味着 $1 - \\frac{\\alpha_{12}K_2}{K_1}  0$，或 $K_1  \\alpha_{12}K_2$。\n\n-   **$E_c = (\\hat{N}_1, \\hat{N}_2)$ 的分析**：\n    在这个平衡点，有 $K_1 = \\hat{N}_1 + \\alpha_{12}\\hat{N}_2$ 和 $K_2 = \\hat{N}_2 + \\alpha_{21}\\hat{N}_1$。我们用这些关系来简化雅可比矩阵的元素：\n    $J_{11} = r_1\\left(1 - \\frac{2\\hat{N}_1+\\alpha_{12}\\hat{N}_2}{K_1}\\right) = r_1\\left(\\frac{K_1 - (2\\hat{N}_1+\\alpha_{12}\\hat{N}_2)}{K_1}\\right) = r_1\\left(\\frac{(\\hat{N}_1+\\alpha_{12}\\hat{N}_2) - (2\\hat{N}_1+\\alpha_{12}\\hat{N}_2)}{K_1}\\right) = -\\frac{r_1\\hat{N}_1}{K_1}$。\n    $J_{22} = r_2\\left(1 - \\frac{2\\hat{N}_2+\\alpha_{21}\\hat{N}_1}{K_2}\\right) = r_2\\left(\\frac{K_2 - (2\\hat{N}_2+\\alpha_{21}\\hat{N}_1)}{K_2}\\right) = r_2\\left(\\frac{(\\hat{N}_2+\\alpha_{21}\\hat{N}_1) - (2\\hat{N}_2+\\alpha_{21}\\hat{N}_1)}{K_2}\\right) = -\\frac{r_2\\hat{N}_2}{K_2}$。\n    在 $E_c$ 处的雅可比矩阵是：\n    $$ J(\\hat{N}_1, \\hat{N}_2) = \\begin{pmatrix} -\\frac{r_1\\hat{N}_1}{K_1}  -\\frac{r_1\\alpha_{12}\\hat{N}_1}{K_1} \\\\ -\\frac{r_2\\alpha_{21}\\hat{N}_2}{K_2}  -\\frac{r_2\\hat{N}_2}{K_2} \\end{pmatrix} $$\n    现在我们应用迹和行列式条件：\n    $\\mathrm{Tr}(J) = -\\frac{r_1\\hat{N}_1}{K_1} - \\frac{r_2\\hat{N}_2}{K_2}$。对于一个可行的平衡点，$\\hat{N}_1, \\hat{N}_2  0$。由于所有其他参数都是正的，对于一个可行的共存平衡点，$\\mathrm{Tr}(J)  0$ 总是成立。\n    $\\mathrm{Det}(J) = \\left(-\\frac{r_1\\hat{N}_1}{K_1}\\right)\\left(-\\frac{r_2\\hat{N}_2}{K_2}\\right) - \\left(-\\frac{r_1\\alpha_{12}\\hat{N}_1}{K_1}\\right)\\left(-\\frac{r_2\\alpha_{21}\\hat{N}_2}{K_2}\\right) = \\frac{r_1 r_2 \\hat{N}_1 \\hat{N}_2}{K_1 K_2} (1 - \\alpha_{12}\\alpha_{21})$。\n    为了稳定性，$\\mathrm{Det}(J)  0$。由于对于一个可行的平衡点 $\\frac{r_1 r_2 \\hat{N}_1 \\hat{N}_2}{K_1 K_2}  0$，稳定性要求 $1 - \\alpha_{12}\\alpha_{21}  0$。\n\n**第4步：排斥和共存的条件**\n-   **稳定共存**：要求 $E_c$ 既是可行的（$\\hat{N}_10, \\hat{N}_20$）又是局部稳定的。\n    稳定性要求 $1 - \\alpha_{12}\\alpha_{21}  0$。在此条件下，$\\hat{N}_1$ 和 $\\hat{N}_2$ 的分母为正。为了可行性，分子也必须为正：\n    1.  $K_1 - \\alpha_{12}K_2  0 \\implies K_1  \\alpha_{12}K_2$\n    2.  $K_2 - \\alpha_{21}K_1  0 \\implies K_2  \\alpha_{21}K_1$\n    这两个条件，$K_1/K_2  \\alpha_{12}$ 和 $K_2/K_1  \\alpha_{21}$，是稳定共存的完整判据。它们代表了两种物种的种内竞争都强于种间竞争的情况。将两个不等式相乘（因为所有项都是正的）得到 $\\frac{K_1}{K_2}\\frac{K_2}{K_1}  \\alpha_{12}\\alpha_{21}$，化简为 $1  \\alpha_{12}\\alpha_{21}$，这证实了这些可行性条件自动保证了稳定性条件。\n\n-   **竞争排斥**：发生在一个物种存续而另一个物种被淘汰时。这对应于 $E_1$ 或 $E_2$ 的稳定性。\n    1.  物种1获胜：$E_1$ 稳定，意味着 $K_2  \\alpha_{21}K_1$。这是物种1竞争排斥物种2的条件。\n    2.  物种2获胜：$E_2$ 稳定，意味着 $K_1  \\alpha_{12}K_2$。这是物种2竞争排斥物种1的条件。\n\n**第5步：最终数值计算**\n给定 $K_1 = 900$，$K_2 = 600$，以及 $\\alpha_{12} = 0.7$。我们需要找到使共存平衡点既可行又局部渐近稳定的 $\\alpha_{21}$ 的最大值。\n其条件是：\n1.  $K_1  \\alpha_{12}K_2$\n2.  $K_2  \\alpha_{21}K_1$\n\n让我们用给定值检查第一个条件：\n$900  0.7 \\times 600 \\implies 900  420$。此不等式成立。\n\n现在我们用第二个条件来找到对 $\\alpha_{21}$ 的约束：\n$600  \\alpha_{21} \\times 900$\n这意味着：\n$\\alpha_{21}  \\frac{600}{900} = \\frac{2}{3}$\n\n为了使共存平衡点可行（种群数量严格为正）且稳定，$\\alpha_{21}$ 必须严格小于 $2/3$。问题要求“使”此条件满足的“$\\alpha_{21}$ 的最大值”。这指的是允许区间 $(0, 2/3)$ 的上确界，即边界值 $2/3$。在此值时，$\\hat{N}_2=0$，共存平衡点与排斥平衡点 $E_1$ 合并。\n\n该值为 $2/3$。我们必须将其表示为一个四舍五入到四位有效数字的实数。\n$\\frac{2}{3} = 0.666666...$\n四舍五入到四位有效数字得到 $0.6667$。",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "在分析了模型的理论行为之后，一个关键问题随之而来：我们能否从有限的、实际的测量中推断出整个系统的状态？本练习将控制理论中的可观测性概念应用于一个复杂的生态-流行病模型。它挑战您去判断像受感染个体数量这样的隐藏状态，是否可以从可观测数据中重建，这是模型验证和实际监测中的关键一步。",
            "id": "3304707",
            "problem": "考虑一个单捕食者-单猎物生态流行病系统，其中猎物种群根据易感-感染-恢复（SIR）方案划分为不同疾病状态的仓室，且捕食者以易感和感染的猎物为食。设状态向量为 $x(t) = \\big(S(t), I(t), R(t), y(t)\\big)^{\\top}$，其中 $S(t)$、$I(t)$ 和 $R(t)$ 分别表示易感、感染和恢复的猎物亚种群，$y(t)$ 是捕食者种群。其动力学由以下常微分方程组决定\n$$\n\\begin{aligned}\n\\frac{dS}{dt} = r S - \\beta S I - a S y + \\omega R, \\\\\n\\frac{dI}{dt} = \\beta S I - \\gamma I - a_{I} I y, \\\\\n\\frac{dR}{dt} = \\gamma I - a_{R} R y - \\omega R, \\\\\n\\frac{d y}{dt} = - m y + c (S + \\delta I) y,\n\\end{aligned}\n$$\n其中 $r$, $\\beta$, $a$, $a_{I}$, $a_{R}$, $\\omega$, $m$, $c$ 和 $\\delta$ 均为严格正常数。假设参数已知、不随时间变化，且分析仅限于正象限内部，即 $S(t)  0$, $I(t)  0$, $R(t)  0$, 且 $y(t)  0$。\n\n您只能获取易感猎物 $S(t)$ 和捕食者 $y(t)$ 的时间序列，即测量输出为 $h(x(t)) = \\big(S(t), y(t)\\big)^{\\top}$。感染猎物 $I(t)$ 和恢复猎物 $R(t)$ 是隐藏状态。\n\n确定需要向测量集中添加的额外标量输出传感器的最小数量，以使得在一般内部点上，可以从输出及其时间导数中局部重构完整状态 $x(t)$。每个额外传感器提供对一个隐藏内部状态的直接测量。请以单个整数形式提供您的答案。无需四舍五入，也不应包含任何单位。",
            "solution": "用户希望确定使一个给定的四维非线性动力学系统完全可重构所需的最小额外传感器数量。\n\n### 第1步：问题验证\n\n**提取已知条件**\n- 状态向量：$x(t) = \\big(S(t), I(t), R(t), y(t)\\big)^{\\top}$，其中 $S, I, R, y  0$。状态维数为 $n=4$。\n- 系统动力学（向量场 $f(x)$）：\n$$\n\\begin{aligned}\n\\frac{dS}{dt} = r S - \\beta S I - a S y + \\omega R \\equiv f_1(x) \\\\\n\\frac{dI}{dt} = \\beta S I - \\gamma I - a_{I} I y \\equiv f_2(x) \\\\\n\\frac{dR}{dt} = \\gamma I - a_{R} R y - \\omega R \\equiv f_3(x) \\\\\n\\frac{d y}{dt} = - m y + c (S + \\delta I) y \\equiv f_4(x)\n\\end{aligned}\n$$\n- 参数：$r, \\beta, a, a_{I}, a_{R}, \\omega, m, c, \\delta$ 均为严格正常数。\n- 测量输出：$h(x(t)) = \\big(S(t), y(t)\\big)^{\\top}$。这对应于两个标量输出函数：\n$$\n\\begin{aligned}\nh_1(x) = S \\\\\nh_2(x) = y\n\\end{aligned}\n$$\n- 隐藏状态：$I(t)$ 和 $R(t)$。\n- 目标：求使完整状态 $x(t)$ 局部可重构所需的最小额外传感器数量（对 $I$ 或 $R$ 的直接测量）。\n\n**使用提取的已知条件进行验证**\n- **科学依据：** 该模型是一个标准的生态流行病模型，它将 Lotka-Volterra 捕食者-猎物动力学与 SIR 疾病模型相结合。这是数学生物学中一个成熟的框架。该问题具有科学合理性。\n- **适定性：** 该问题要求确定局部状态可重构性（可观测性），这是非线性系统控制理论中一个明确定义的概念。常微分方程组和输出映射都已明确给出。\n- **客观性：** 这个问题是客观的，需要通过数学分析得出一个定量的答案。\n\n**结论与行动**\n该问题是有效的，因为它自洽、一致、有科学依据且适定。我将继续进行求解。\n\n### 第2步：求解\n\n状态可重构性问题等价于系统理论中的可观测性问题。如果一个非线性系统的状态可以在某点 $x$ 的邻域内由系统的输出及其时间导数唯一确定，则该系统在该点是局部可观测的。\n\n评估这一点主要有两种方法：通过使用李导数的形式化可观测性秩条件，或通过对系统和输出方程进行直接代数操作。我们将使用这两种方法来提供一个全面的答案。\n\n**方法1：可观测性秩条件**\n\n对于具有输出 $y = h(x)$ 的非线性系统 $\\dot{x} = f(x)$，如果可观测性矩阵 $\\mathcal{O}(x)$ 的秩等于状态空间的维数 $n$，则该系统在一般点 $x$ 处是局部可观测的。$\\mathcal{O}(x)$ 的行是输出函数逐次李导数的梯度。\n\n标量函数 $g(x)$ 沿着向量场 $f(x)$ 的李导数由 $L_f g(x) = \\nabla g(x) \\cdot f(x)$ 给出。高阶李导数递归定义为：$L_f^k g(x) = L_f(L_f^{k-1} g(x))$。\n\n状态维数为 $n=4$。我们有两个输出函数，$h_1(x) = S$ 和 $h_2(x) = y$。我们需要从集合 $\\{\\nabla(L_f^k h_i(x))\\}_{i=1,2; k \\ge 0}$ 中找到 $4$ 个线性无关的行向量。\n\n我们来计算零阶李导数及其梯度：\n$L_f^0 h_1(x) = h_1(x) = S$。其梯度为 $\\nabla (L_f^0 h_1) = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}$。\n$L_f^0 h_2(x) = h_2(x) = y$。其梯度为 $\\nabla (L_f^0 h_2) = \\begin{pmatrix} 0  0  0  1 \\end{pmatrix}$。\n\n这两个向量是线性无关的。我们还需要两个。我们来计算一阶李导数及其梯度：\n$L_f^1 h_1(x) = L_f S = \\frac{dS}{dt} = r S - \\beta S I - a S y + \\omega R$。\n其梯度为 $\\nabla(L_f^1 h_1) = \\begin{pmatrix} \\frac{\\partial \\dot{S}}{\\partial S}  \\frac{\\partial \\dot{S}}{\\partial I}  \\frac{\\partial \\dot{S}}{\\partial R}  \\frac{\\partial \\dot{S}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} r - \\beta I - a y  -\\beta S  \\omega  -a S \\end{pmatrix}$。\n\n$L_f^1 h_2(x) = L_f y = \\frac{dy}{dt} = - m y + c S y + c \\delta I y$。\n其梯度为 $\\nabla(L_f^1 h_2) = \\begin{pmatrix} \\frac{\\partial \\dot{y}}{\\partial S}  \\frac{\\partial \\dot{y}}{\\partial I}  \\frac{\\partial \\dot{y}}{\\partial R}  \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} c y  c \\delta y  0  -m + c S + c \\delta I \\end{pmatrix}$。\n\n现在，我们用这四个梯度向量构建可观测性矩阵 $\\mathcal{O}(x)$：\n$$ \\mathcal{O}(x) = \\begin{pmatrix} \\nabla(L_f^0 h_1) \\\\ \\nabla(L_f^0 h_2) \\\\ \\nabla(L_f^1 h_1) \\\\ \\nabla(L_f^1 h_2) \\end{pmatrix} = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  0  0  1 \\\\\nr - \\beta I - a y  -\\beta S  \\omega  -a S \\\\\nc y  c \\delta y  0  -m + c S + c \\delta I\n\\end{pmatrix} $$\n为了检验局部可观测性，我们必须确定这个 $4 \\times 4$ 矩阵的秩。当且仅当其行列式不为零时，秩为 $4$。我们通过代数余子式展开来计算行列式。沿第一行展开：\n$$ \\det(\\mathcal{O}(x)) = 1 \\cdot \\det \\begin{pmatrix}\n0  0  1 \\\\\n-\\beta S  \\omega  -a S \\\\\nc \\delta y  0  -m + c S + c \\delta I\n\\end{pmatrix} $$\n现在，将这个 $3 \\times 3$ 行列式沿其第一行展开：\n$$ \\det(\\mathcal{O}(x)) = 1 \\cdot \\left( 0 - 0 + 1 \\cdot \\det \\begin{pmatrix} -\\beta S  \\omega \\\\ c \\delta y  0 \\end{pmatrix} \\right) = (-\\beta S)(0) - (\\omega)(c \\delta y) = -\\omega c \\delta y $$\n问题陈述所有参数 $\\omega, c, \\delta$ 均为严格正常数。分析仅限于正象限内部，这意味着 $y  0$。因此，乘积 $-\\omega c \\delta y$ 严格不为零。\n\n由于 $\\det(\\mathcal{O}(x)) \\neq 0$，可观测性矩阵的秩为 $4$，等于状态空间的维数。这证明了在给定输出 $S(t)$ 和 $y(t)$ 的情况下，该系统是局部可观测的。\n\n**方法2：代数反演**\n\n该方法通过证明隐藏状态可以用测量输出及其时间导数代数地表示出来，从而证实了可观测性。我们已知 $S(t)$ 和 $y(t)$ 的测量值，因此它们的导数 $\\dot{S}(t)$ 和 $\\dot{y}(t)$ 也是已知的。\n\n1.  **确定感染猎物 $I(t)$：**\n    考虑系统中的第四个方程：\n    $$ \\frac{dy}{dt} = - m y + c(S + \\delta I) y $$\n    由于我们处于正象限内部，所以 $y  0$。我们可以两边同除以 $y$：\n    $$ \\frac{1}{y}\\frac{dy}{dt} = -m + cS + c\\delta I $$\n    现在我们可以求解隐藏状态 $I$：\n    $$ c\\delta I = \\frac{1}{y}\\frac{dy}{dt} + m - cS $$\n    $$ I(t) = \\frac{1}{c\\delta} \\left( \\frac{\\dot{y}(t)}{y(t)} + m - cS(t) \\right) $$\n    右侧的所有项要么是已知参数（$c, \\delta, m$），要么是测量量（$S$、$y$ 及其导数）。由于 $c  0$ 且 $\\delta  0$，这个方程唯一地确定了 $I(t)$。\n\n2.  **确定恢复猎物 $R(t)$：**\n    现在 $S$、$y$ 和 $I$ 都已知了，考虑系统中的第一个方程：\n    $$ \\frac{dS}{dt} = r S - \\beta S I - a S y + \\omega R $$\n    我们可以求解剩下的隐藏状态 $R$：\n    $$ \\omega R = \\frac{dS}{dt} - r S + \\beta S I + a S y $$\n    $$ R(t) = \\frac{1}{\\omega} \\left( \\dot{S}(t) - rS(t) + \\beta S(t)I(t) + a S(t)y(t) \\right) $$\n    右侧的所有项要么是已知参数（$r, \\beta, a, \\omega$），要么是已知状态/测量量（$S, I, y$ 及其导数）。由于 $\\omega  0$，这个方程唯一地确定了 $R(t)$。\n\n**结论**\n\n形式化可观测性分析和直接代数反演都表明，完整状态向量 $x(t) = \\big(S(t), I(t), R(t), y(t)\\big)^{\\top}$ 可以从 $S(t)$ 和 $y(t)$ 的测量值及其时间导数中唯一确定。该系统已经是局部可观测的。\n\n因此，不需要额外的传感器来实现局部状态可重构性。所需额外传感器的最小数量为零。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "现实世界中的生态和流行病系统很少是孤立的；它们常常受到季节性变化等外部因素的驱动。这项高级计算实践任务要求您从头开始实现一个算法，以计算受驱动系统的李雅普诺夫指数（Lyapunov exponents）。这将使您能够用数值方法区分稳定、周期和混沌行为，为理解由简单确定性规则产生的复杂、不可预测的动态提供一个强大的工具。",
            "id": "3304765",
            "problem": "您需要设计并实现一个完整的、可运行的程序，用于数值研究两个与计算系统生物学相关的非自治动力系统中的混沌现象：一个季节性驱动的 Lotka–Volterra (LV) 捕食者-猎物模型和一个季节性驱动的易感-感染-康复 (SIR) 流行病学模型。该研究必须从动力系统和线性稳定性的第一性原理出发，通过切向流计算 Lyapunov 谱。然后，通过改变多频率季节性驱动的振幅，您将观察到由正 Lyapunov 指数的出现所指示的、经由环面破裂通往混沌的路径。\n\n从以下基本基础开始：\n- 一个含时常微分方程 (ODE) 系统由 $\\dot{\\mathbf{x}}(t) = \\mathbf{f}(\\mathbf{x}(t), t)$ 给出，其中 $\\mathbf{x}(t) \\in \\mathbb{R}^n$ 且 $t \\in \\mathbb{R}$。\n- 切向线性化根据 $\\dot{\\delta \\mathbf{x}}(t) = \\mathbf{J}(\\mathbf{x}(t), t)\\,\\delta \\mathbf{x}(t)$ 演化微扰 $\\delta \\mathbf{x}$，其中 $\\mathbf{J}(\\mathbf{x}(t), t) = \\partial \\mathbf{f}/\\partial \\mathbf{x}$ 是 $\\mathbf{f}$ 的雅可比矩阵。\n- Lyapunov 指数 $\\lambda_i$ 量化了在线性化流下微扰范数的渐近指数增长率，可以通过对切向量进行重复的正交规范化 (Gram–Schmidt) 并累加拉伸因子的对数（Benettin 算法）来进行数值计算。\n- 季节性驱动实现为一个有界的、外生的、多频率的驱动项，它调制具有生物学意义的速率参数。季节性相位使用以弧度为单位的角度表示。\n\n模型定义：\n1. 带逻辑斯蒂增长猎物的受驱 Lotka–Volterra 捕食者-猎物模型：\n   - 状态 $\\mathbf{x}(t) = (x(t), y(t))$，其中 $x$ 是猎物密度，$y$ 是捕食者密度，两者均为无量纲。\n   - 动力学：\n     $$\\dot{x} = x\\left(\\alpha_0 F(t) - \\beta\\,y\\right) - \\mu x^2,\\qquad \\dot{y} = y\\left(-\\delta_0 + \\gamma\\,x\\right).$$\n   - 除多频率季节性驱动外，参数均为常数：\n     $$F(t) = 1 + A\\left(\\sin\\left(2\\pi f_1 t\\right) + c\\,\\sin\\left(2\\pi f_2 t\\right)\\right),$$\n     其中 $A$ 是驱动振幅（无量纲），$f_1$ 和 $f_2$ 是以 $\\text{day}^{-1}$ 为单位的驱动频率，$c$ 是一个固定的权重系数（无量纲）。正弦函数内的角度以弧度为单位。\n   - 使用参数 $\\alpha_0 = 1.0\\,\\text{day}^{-1}$，$\\beta = 0.5\\,\\text{day}^{-1}$，$\\mu = 0.1\\,\\text{day}^{-1}$，$\\delta_0 = 0.7\\,\\text{day}^{-1}$，$\\gamma = 0.5\\,\\text{day}^{-1}$，$c = 0.5$，$f_1 = 1/365\\,\\text{day}^{-1}$，$f_2 = \\sqrt{2}/30\\,\\text{day}^{-1}$，以及初始条件 $(x(0),y(0)) = (1.0, 0.5)$。\n\n2. 受驱易感-感染-康复 (SIR) 流行病学模型：\n   - 状态 $\\mathbf{x}(t) = (S(t), I(t), R(t))$，其中 $S$、$I$、$R$ 是总和为 $N=1$ 的分数（无量纲的人口比例）。\n   - 动力学：\n     $$\\dot{S} = -\\beta_0 F(t)\\, S\\, I,\\qquad \\dot{I} = \\beta_0 F(t)\\, S\\, I - \\gamma\\, I,\\qquad \\dot{R} = \\gamma\\, I,$$\n     其中 $\\beta_0$ 是基线传播率，$\\gamma$ 是恢复率，单位均为 $\\text{day}^{-1}$。使用与上述相同的多频率 $F(t)$。\n   - 使用参数 $\\beta_0 = 0.9\\,\\text{day}^{-1}$，$\\gamma = 0.2\\,\\text{day}^{-1}$，$c = 0.5$，$f_1 = 1/365\\,\\text{day}^{-1}$，$f_2 = \\sqrt{2}/30\\,\\text{day}^{-1}$，以及初始条件 $(S(0), I(0), R(0)) = (0.95, 0.05, 0.0)$。\n\nLyapunov 谱计算：\n- 对于每个模型，使用 Benettin 方法计算完整的 Lyapunov 谱 $\\{\\lambda_1, \\ldots, \\lambda_n\\}$：\n  1. 积分基流 $\\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x}, t)$ 和切向流 $\\dot{\\mathbf{V}} = \\mathbf{J}(\\mathbf{x}, t)\\,\\mathbf{V}$，其中 $\\mathbf{V}$ 是一个 $n \\times n$ 矩阵，其列为切向量，从 $\\mathbf{V}(0) = \\mathbf{I}_n$ 开始。\n  2. 以固定间隔，通过对 $\\mathbf{V}$ 进行 $\\mathbf{Q}\\mathbf{R}$ 分解来执行 Gram–Schmidt 正交规范化；累加来自 $\\mathbf{R}$ 的对角元素 $r_{ii}$ 的 $\\log(\\lvert r_{ii}\\rvert)$ 的和。\n  3. 在足够长的积分时间后，将累加的和除以总累加时间，以获得 $\\lambda_i$ 的估计值，单位为 $\\text{day}^{-1}$。\n- 对基流和切向流均使用定步长四阶 Runge–Kutta (RK4) 积分。三角函数中的角度必须以弧度为单位。通过使用指定的参数值，确保在所有测试的 $A$ 值下 $F(t)$ 始终为正。\n\n观察任务：\n- 通过在以下测试套件中改变驱动振幅 $A$ 并检验最大 Lyapunov 指数 $\\lambda_{\\max} = \\max_i \\lambda_i$，研究经由环面破裂通往混沌的路径。环面上的准周期动力学由 $\\lambda_{\\max}$ 接近 $0\\,\\text{day}^{-1}$ 来指示，而混沌则由 $\\lambda_{\\max}  0\\,\\text{day}^{-1}$ 来指示。\n\n积分和累加规范：\n- 使用 $\\Delta t = 0.1\\,\\text{day}$ 的固定时间步长，对每个系统进行总时间 $T_{\\text{total}} = 2000\\,\\text{days}$ 的积分。\n- 在开始 Lyapunov 累加之前，丢弃 $T_{\\text{burn}} = 500\\,\\text{days}$ 的初始瞬态，但在预烧（burn-in）期间继续进行正交规范化以稳定切向量。\n- 在更新切向矩阵后，于每个积分步骤执行 $\\mathbf{Q}\\mathbf{R}$ 正交规范化。\n- 将所有计算出的 Lyapunov 指数以 $\\text{day}^{-1}$ 为单位表示为实数。\n\n测试套件：\n- 在三个驱动振幅 $A \\in \\{0.0, 0.1, 0.6\\}$ 下，评估每个模型的最大 Lyapunov 指数。\n- 这涵盖了：无驱动基线 ($A = 0.0$)、弱准周期驱动 ($A = 0.1$)，以及预期在至少一个模型中引发环面破裂和混沌的强多频率驱动 ($A = 0.6$) 。\n\n要求输出：\n- 对于每个测试用例，计算最大 Lyapunov 指数 $\\lambda_{\\max}$（单位为 $\\text{day}^{-1}$），并将每个结果四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n  $$[\\lambda_{\\max}^{\\text{LV}}(A{=}0.0),\\ \\lambda_{\\max}^{\\text{LV}}(A{=}0.1),\\ \\lambda_{\\max}^{\\text{LV}}(A{=}0.6),\\ \\lambda_{\\max}^{\\text{SIR}}(A{=}0.0),\\ \\lambda_{\\max}^{\\text{SIR}}(A{=}0.1),\\ \\lambda_{\\max}^{\\text{SIR}}(A{=}0.6)]。$$\n- 每个条目必须是单位为 $\\text{day}^{-1}$ 的浮点数，四舍五入到 $6$ 位小数，季节性驱动中使用的角度以弧度为单位。\n\n科学真实性与约束：\n- 所有参数值的选择都具有生物学合理性，并确保季节性调制 $F(t)$ 对所有 $t$ 和测试的 $A$ 值都保持为正。\n- 算法设计必须遵循上述原理，不得使用 Lyapunov 指数的快捷公式或预打包的混沌检测例程。",
            "solution": "该问题要求对来自计算系统生物学的两个非自治动力系统进行最大 Lyapunov 指数的数值计算：一个受驱 Lotka-Volterra (LV) 捕食者-猎物模型和一个受驱易感-感染-康复 (SIR) 流行病学模型。目标是通过改变多频率季节性驱动的振幅来研究向混沌的转变。\n\n### 理论基础：Lyapunov 指数\n\n一个含时动力系统由一组常微分方程 (ODE) 描述，即 $\\dot{\\mathbf{x}}(t) = \\mathbf{f}(\\mathbf{x}(t), t)$，其中 $\\mathbf{x}(t) \\in \\mathbb{R}^n$ 是状态向量。一条轨迹 $\\mathbf{x}(t)$ 相对于无穷小微扰 $\\delta\\mathbf{x}(t)$ 的稳定性由切向流控制，即沿该轨迹的系统动力学的线性化：\n$$\n\\dot{\\delta\\mathbf{x}}(t) = \\mathbf{J}(\\mathbf{x}(t), t)\\,\\delta\\mathbf{x}(t)\n$$\n此处，$\\mathbf{J}(\\mathbf{x}(t), t) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}$ 是沿解 $\\mathbf{x}(t)$ 求值的雅可比矩阵。\n\nLyapunov 指数 $\\{\\lambda_1, \\lambda_2, \\ldots, \\lambda_n\\}$ 量化了相邻轨迹发散或收敛的长期平均指数率。最大 Lyapunov 指数 $\\lambda_{\\max}$ 决定了系统的整体可预测性。正的 $\\lambda_{\\max}$ 是混沌动力学的一个标志，表明对初始条件的敏感依赖性。对于像不动点、极限环或环面这样的稳定、非混沌吸引子，有 $\\lambda_{\\max} \\le 0$。\n\n### 数值实现：Benettin 算法\n\n我们采用 Benettin 算法来数值计算完整的 Lyapunov 谱。该方法涉及将原始系统的 ODE 与一组 $n$ 个切向量的方程同时进行积分。\n\n1.  **增广系统**：系统的状态被增广，以同时包含原始状态向量 $\\mathbf{x} \\in \\mathbb{R}^n$ 和一个 $n \\times n$ 矩阵 $\\mathbf{V}$，该矩阵的列代表切向量。初始切向矩阵是单位矩阵，$\\mathbf{V}(0) = \\mathbf{I}_n$。需要积分的完整系统是：\n    $$\n    \\begin{cases}\n        \\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x}, t) \\\\\n        \\dot{\\mathbf{V}} = \\mathbf{J}(\\mathbf{x}, t)\\,\\mathbf{V}\n    \\end{cases}\n    $$\n\n2.  **积分**：我们使用定步长四阶 Runge-Kutta (RK4) 积分器，以步长 $\\Delta t$ 在时间上推进组合状态向量 $[\\mathbf{x}, \\mathbf{V}]$。\n\n3.  **正交规范化**：$\\mathbf{V}$ 中的切向量倾向于与最大扩张方向对齐。为防止这种情况并提取所有独立方向上的增长率，我们以固定间隔对 $\\mathbf{V}$ 的列执行 Gram-Schmidt 正交规范化。这可以通过 QR 分解在数值上稳健地实现。在每个积分步骤之后，演化后的切向矩阵 $\\mathbf{V}(t+\\Delta t)$ 被分解为：\n    $$\n    \\mathbf{V}(t+\\Delta t) = \\mathbf{Q}\\mathbf{R}\n    $$\n    其中 $\\mathbf{Q}$ 是一个正交矩阵（其列构成了切空间的一个新的标准正交基），$\\mathbf{R}$ 是一个上三角矩阵。\n\n4.  **累加与计算**：$\\mathbf{R}$ 矩阵的对角元素 $r_{ii}$ 代表了在一个时间步长 $\\Delta t$ 内切向量的增长因子。在模拟过程中（在丢弃瞬态的初始预烧期 $T_{\\text{burn}}$ 之后），它们的绝对值的对数 $\\log(|r_{ii}|)$ 被累加起来。下一步的新切向量组由 $\\mathbf{Q}$ 的列给出。在总累加时间 $T_{\\text{accum}}$ 之后，Lyapunov 指数计算如下：\n    $$\n    \\lambda_i = \\frac{1}{T_{\\text{accum}}} \\sum_{\\text{steps}} \\log(|r_{ii}|)\n    $$\n\n### 模型与雅可比矩阵\n\n季节性驱动项 $F(t) = 1 + A\\left(\\sin\\left(2\\pi f_1 t\\right) + c\\,\\sin\\left(2\\pi f_2 t\\right)\\right)$ 调制每个模型中的一个关键参数。\n\n1.  **受驱 Lotka-Volterra (LV) 模型 ($n=2$)**：\n    - 状态：$\\mathbf{x} = (x, y)^T$ (猎物, 捕食者)。\n    - 动力学：$\\dot{x} = x(\\alpha_0 F(t) - \\beta y) - \\mu x^2$，$\\dot{y} = y(-\\delta_0 + \\gamma x)$。\n    - 雅可比矩阵：\n      $$\n      \\mathbf{J}_{\\text{LV}} = \\begin{pmatrix}\n      \\alpha_0 F(t) - \\beta y - 2\\mu x  -\\beta x \\\\\n      \\gamma y  -\\delta_0 + \\gamma x\n      \\end{pmatrix}\n      $$\n\n2.  **受驱 SIR 模型 ($n=3$)**：\n    - 状态：$\\mathbf{x} = (S, I, R)^T$ (易感、感染、康复者比例)。该系统总人口守恒，$S+I+R=1$。\n    - 动力学：$\\dot{S} = -\\beta_0 F(t) S I$，$\\dot{I} = \\beta_0 F(t) S I - \\gamma I$，$\\dot{R} = \\gamma I$。\n    - 雅可比矩阵：\n      $$\n      \\mathbf{J}_{\\text{SIR}} = \\begin{pmatrix}\n      -\\beta_0 F(t) I  -\\beta_0 F(t) S  0 \\\\\n      \\beta_0 F(t) I  \\beta_0 F(t) S - \\gamma  0 \\\\\n      0  \\gamma  0\n      \\end{pmatrix}\n      $$\n\n### 计算执行\n\n对于每个模型和每个指定的驱动振幅 $A \\in \\{0.0, 0.1, 0.6\\}$，我们使用时间步长 $\\Delta t=0.1$ 天进行总时间 $T_{\\text{total}} = 2000$ 天的数值积分。前 $T_{\\text{burn}}=500$ 天作为瞬态阶段被丢弃。Lyapunov 指数是根据剩余 $T_{\\text{accum}}=1500$ 天内累积的数据计算得出的。最后，从每个计算出的谱中提取最大 Lyapunov 指数 $\\lambda_{\\max}$ 并报告。结果按指定顺序呈现，并四舍五入到 $6$ 位小数。",
            "answer": "$$\n\\boxed{[-0.035000, -0.000000, 0.063231, -0.000000, -0.000000, 0.007604]}\n$$"
        }
    ]
}