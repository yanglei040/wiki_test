{
    "hands_on_practices": [
        {
            "introduction": "The first step in using Petri nets for biochemical modeling is mastering the translation from a chemical reaction to the net's mathematical structure. This exercise provides practice in this fundamental skill by asking you to construct the pre- and post-incidence matrices, which encode the stoichiometry of a simple reaction. You will also engage with the crucial modeling decision of whether tokens represent discrete molecules or continuous concentrations, and use the concept of place invariants to verify the conservation laws inherent in the system.",
            "id": "3337346",
            "problem": "Consider a single, irreversible, bimolecular association reaction in a well-stirred cytosolic compartment: $A + B \\to C$. Model this reaction as a Petri net (PN) whose places correspond to the chemical species $A$, $B$, and $C$, and whose single transition corresponds to the reaction event. Construct the pre-incidence matrix $Pre$ and post-incidence matrix $Post$ that encode the stoichiometric requirements and outcomes of the reaction. Choose and state an initial marking $M_0$ in terms of continuous token quantities, and provide a scientifically grounded justification for using tokens measured as concentrations rather than molecule counts in this deterministic modeling context. Assume the compartment is well mixed, and measurements of species are available as concentrations.\n\nLet the initial concentrations be $[A]_0 = 2.75$ nanomolar (nM), $[B]_0 = 1.25$ nM, and $[C]_0 = 0.60$ nM. Use these to define the initial marking $M_0$ over the places $(A,B,C)$.\n\nFinally, derive a minimal positive integer vector $w \\in \\mathbb{Z}_{>0}^3$ that represents a conserved linear place-invariant associated with the reaction’s stoichiometry and atomic moiety conservation, and compute the corresponding invariant value $w^{\\top} M_0$. Express the final invariant value in nanomolar (nM) and round your answer to four significant figures.",
            "solution": "Here is a step-by-step solution to the problem.\n\n**1. Define the Petri Net Structure and Incidence Matrices**\n\nThe reaction $A + B \\to C$ is modeled with one transition, $t_1$, and three places, $p_A, p_B, p_C$. The transition consumes one token from $p_A$ and $p_B$ and produces one token in $p_C$. The pre-incidence ($Pre$) and post-incidence ($Post$) matrices, with rows ordered $(A, B, C)$, are:\n$$\nPre = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad Post = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nThe incidence matrix $C$ is the net change, $C = Post - Pre$:\n$$\nC = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n\n**2. Justify Using Concentrations for Tokens**\n\nIn deterministic modeling of large-scale biochemical systems, it is common to use concentrations instead of discrete molecule counts. This approach is justified under the assumption of a well-mixed system containing a large number of molecules (approaching the thermodynamic limit). By the law of large numbers, the stochastic fluctuations of individual reaction events average out, and the system's state can be accurately described by continuous variables (concentrations). This allows the use of differential equations and simplifies analysis, providing a valid macroscopic view of the system's dynamics.\n\n**3. Define the Initial Marking $M_0$**\n\nThe initial marking $M_0$ is defined by the given initial concentrations:\n$$\nM_0 = \\begin{pmatrix} M(p_A) \\\\ M(p_B) \\\\ M(p_C) \\end{pmatrix} = \\begin{pmatrix} 2.75 \\\\ 1.25 \\\\ 0.60 \\end{pmatrix} \\text{ (in nM)}\n$$\n\n**4. Derive the Place Invariant and Calculate Conserved Value**\n\nA place invariant (P-invariant) is a vector $w = (w_A, w_B, w_C)^T$ that satisfies the equation $w^T C = 0$.\n$$\n\\begin{pmatrix} w_A & w_B & w_C \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\end{pmatrix} = -w_A - w_B + w_C = 0\n$$\nThis implies that for any P-invariant, $w_C = w_A + w_B$. The problem asks for a minimal positive integer vector $w \\in \\mathbb{Z}_{>0}^3$, meaning all its components must be positive integers. To find the minimal vector, we choose the smallest possible positive integers for the free variables, $w_A = 1$ and $w_B = 1$. This determines $w_C = 1 + 1 = 2$.\nThus, the minimal positive integer P-invariant is:\n$$\nw = \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix}\n$$\nThis vector defines a conserved quantity, $S = w^T M = 1 \\cdot M(A) + 1 \\cdot M(B) + 2 \\cdot M(C)$. We calculate the value of this invariant using the initial marking $M_0$:\n$$\nS = w^T M_0 = (1)(2.75) + (1)(1.25) + (2)(0.60) = 2.75 + 1.25 + 1.20 = 5.20\n$$\nThe value of the conserved quantity is $5.20$ nM. Rounded to four significant figures, the answer is $5.200$.",
            "answer": "$$\n\\boxed{5.200}\n$$"
        },
        {
            "introduction": "Once a model is constructed, we can analyze its structural and dynamic properties to ensure it behaves realistically. This practice explores the key concepts of boundedness and safeness, which constrain the number of tokens a place can hold, and connects them to their biological meaning. By analyzing a receptor-ligand system, you will learn to use place invariants to formally prove these properties and appreciate why a 'safe' place is an excellent model for a single-occupancy binding site but inappropriate for a large pool of metabolite molecules.",
            "id": "3337357",
            "problem": "Consider a place/transition Petri net (PN) that models receptor–ligand binding and subsequent metabolic conversion. The PN has four places: $p_{R\\_f}$ (free receptor site), $p_{R\\_b}$ (bound receptor site), $p\\_L$ (free ligand molecules), and $p\\_M$ (a downstream metabolite). There are three transitions:\n- $t\\_{\\mathrm{bind}}$: consumes $1$ token from $p_{R\\_f}$ and $1$ token from $p\\_L$, and produces $1$ token in $p_{R\\_b}$.\n- $t\\_{\\mathrm{unbind}}$: consumes $1$ token from $p_{R\\_b}$, and produces $1$ token in $p_{R\\_f}$ and $1$ token in $p\\_L$.\n- $t\\_{\\mathrm{convert}}$: consumes $1$ token from $p\\_L$ and produces $1$ token in $p\\_M$.\n\nAssume unit arc weights as stated, no other arcs, and the initial marking $M\\_0$ given by $M\\_0(p_{R\\_f})=1$, $M\\_0(p_{R\\_b})=0$, $M\\_0(p\\_L)=3$, and $M\\_0(p\\_M)=0$.\n\nUse the standard definitions:\n- A place is safe (also called $1$-bounded) if in all reachable markings it never carries more than $1$ token.\n- A PN is $k$-bounded if there exists a finite $k\\in\\mathbb{N}$ such that in all reachable markings every place carries at most $k$ tokens; a PN is bounded if it is $k$-bounded for some finite $k$.\n- A place invariant (also called a $P$-invariant) is a nonnegative vector $x$ such that for all firings, the weighted sum $\\sum\\_p x(p)\\,M(p)$ remains constant.\n\nSelect all statements that are correct about this PN and about biological modeling choices concerning safeness versus general boundedness.\n\nA. For all reachable markings, $p_{R\\_f}$ and $p_{R\\_b}$ are safe.\n\nB. The PN is safe.\n\nC. The PN is bounded but not safe.\n\nD. Enforcing safeness on places that represent single-occupancy binding sites (such as $p_{R\\_f}$ and $p_{R\\_b}$) is biologically appropriate, whereas enforcing safeness on places that represent high-copy metabolites (such as $p\\_L$ or $p\\_M$) is biologically inappropriate.\n\nE. If one adds a new transition $t\\_{\\mathrm{in}}$ with no inputs ($0$ input arcs) and a single output arc of weight $1$ to $p\\_L$, then the PN remains bounded because $p\\_L+p\\_M+p_{R\\_b}$ is conserved.\n\nF. If the initial ligand count is changed to $M\\_0(p\\_L)=1000$ while keeping the same structure and the same initial values for $p_{R\\_f}$, $p_{R\\_b}$, and $p\\_M$, then $p_{R\\_f}$ and $p_{R\\_b}$ remain safe for all reachable markings.\n\nChoose all that apply.",
            "solution": "The problem statement has been validated and is determined to be sound. It is scientifically grounded, well-posed, objective, complete, consistent, and feasible for analysis. We may proceed with the solution.\n\nThe Petri net (PN) is defined by its places, transitions, and initial marking.\nThe set of places is $P = \\{p_{R\\_f}, p_{R\\_b}, p\\_L, p\\_M\\}$.\nThe set of transitions is $T = \\{t_{\\mathrm{bind}}, t_{\\mathrm{unbind}}, t_{\\mathrm{convert}}\\}$.\nThe initial marking is $M_0 = (M_0(p_{R\\_f}), M_0(p_{R\\_b}), M_0(p\\_L), M_0(p\\_M))^T = (1, 0, 3, 0)^T$.\n\nThe dynamics of the system are governed by the state equation $M_k = M_{k-1} + C \\cdot v_k$, where $M_k$ is the marking after the $k$-th firing, $C$ is the incidence matrix, and $v_k$ is a vector indicating which transition fires. The incidence matrix $C$ for this PN, with rows corresponding to places $(p_{R\\_f}, p_{R\\_b}, p\\_L, p\\_M)$ and columns to transitions $(t_{\\mathrm{bind}}, t_{\\mathrm{unbind}}, t_{\\mathrm{convert}})$, is:\n$$\nC = \\begin{pmatrix}\n -1 &  1 &  0 \\\\\n  1 & -1 &  0 \\\\\n -1 &  1 & -1 \\\\\n  0 &  0 &  1\n\\end{pmatrix}\n$$\nA place invariant is a non-negative integer vector $x$ such that $x^T C = \\mathbf{0}^T$. Solving this linear system for $x = (x_1, x_2, x_3, x_4)^T$:\n$$\n\\begin{pmatrix} x_1 & x_2 & x_3 & x_4 \\end{pmatrix}\n\\begin{pmatrix}\n -1 &  1 &  0 \\\\\n  1 & -1 &  0 \\\\\n -1 &  1 & -1 \\\\\n  0 &  0 &  1\n\\end{pmatrix}\n= \\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}\n$$\nThis yields the system of equations:\n1. $-x_1 + x_2 - x_3 = 0$\n2. $x_1 - x_2 + x_3 = 0$\n3. $-x_3 + x_4 = 0$\n\nEquation (2) is redundant with (1). From (3), we get $x_3 = x_4$. Substituting into (1), we have $x_2 = x_1 + x_3$.\nWe can find a basis for the solution space.\n- Let $x_1=1, x_3=0$. Then $x_4=0$ and $x_2=1$. This gives the invariant vector $I_1 = (1, 1, 0, 0)^T$.\nThe corresponding conserved sum is $S_1 = I_1^T \\cdot M = 1 \\cdot M(p_{R\\_f}) + 1 \\cdot M(p_{R\\_b})$. At the initial marking $M_0$, this sum is $1 \\cdot M_0(p_{R\\_f}) + 1 \\cdot M_0(p_{R\\_b}) = 1 \\cdot 1 + 1 \\cdot 0 = 1$. Thus, for any reachable marking $M$, $M(p_{R\\_f}) + M(p_{R\\_b}) = 1$.\n\n- Let $x_1=0, x_3=1$. Then $x_4=1$ and $x_2=1$. This gives the invariant vector $I_2 = (0, 1, 1, 1)^T$.\nThe corresponding conserved sum is $S_2 = I_2^T \\cdot M = 1 \\cdot M(p_{R\\_b}) + 1 \\cdot M(p\\_L) + 1 \\cdot M(p\\_M)$. At the initial marking $M_0$, this sum is $1 \\cdot M_0(p_{R\\_b}) + 1 \\cdot M_0(p\\_L) + 1 \\cdot M_0(p\\_M) = 1 \\cdot 0 + 1 \\cdot 3 + 1 \\cdot 0 = 3$. Thus, for any reachable marking $M$, $M(p_{R\\_b}) + M(p\\_L) + M(p\\_M) = 3$.\n\nThese two invariants can be used to analyze the properties of the PN.\n\n**A. For all reachable markings, $p_{R\\_f}$ and $p_{R\\_b}$ are safe.**\nA place is safe if its token count never exceeds $1$. From the P-invariant $I_1$, we know that for any reachable marking $M$, $M(p_{R\\_f}) + M(p_{R\\_b}) = 1$. Since markings must be non-negative integers ($M(p) \\in \\mathbb{N}_0$), this equality implies that $M(p_{R\\_f})$ can only be $0$ or $1$, and similarly for $M(p_{R\\_b})$. If $M(p_{R\\_f})=1$, then $M(p_{R\\_b})=0$, and vice versa. Neither place can ever hold more than $1$ token. Therefore, both $p_{R\\_f}$ and $p_{R\\_b}$ are safe.\nVerdict: **Correct**.\n\n**B. The PN is safe.**\nA PN is safe if all of its places are safe (i.e., $1$-bounded). The initial marking is $M_0(p\\_L) = 3$. Since there exists a marking (the initial one) where a place ($p\\_L$) has more than $1$ token, this place is not safe. Consequently, the entire PN is not safe.\nVerdict: **Incorrect**.\n\n**C. The PN is bounded but not safe.**\nAs established in B, the PN is not safe. We now check for boundedness. A PN is bounded if every place is bounded.\n- From invariant $S_1$, $M(p_{R\\_f}) \\le 1$ and $M(p_{R\\_b}) \\le 1$. So, $p_{R\\_f}$ and $p_{R\\_b}$ are bounded.\n- From invariant $S_2$, $M(p_{R\\_b}) + M(p\\_L) + M(p\\_M) = 3$. Since markings are non-negative, this implies $M(p_{R\\_b}) \\le 3$, $M(p\\_L) \\le 3$, and $M(p\\_M) \\le 3$. So, $p_{R\\_b}$, $p\\_L$, and $p\\_M$ are bounded.\nSince all places are bounded, the PN is bounded. Specifically, it is $3$-bounded, because the maximum token count for any place is $3$ ($p\\_L$ and $p\\_M$). The statement that the PN is bounded but not safe is therefore accurate.\nVerdict: **Correct**.\n\n**D. Enforcing safeness on places that represent single-occupancy binding sites (such as $p_{R\\_f}$ and $p_{R\\_b}$) is biologically appropriate, whereas enforcing safeness on places that represent high-copy metabolites (such as $p\\_L$ or $p\\_M$) is biologically inappropriate.**\nThis statement addresses the modeling philosophy. In biochemical systems, a single binding site on a molecule (like a receptor) can either be free or occupied. It cannot be in a state of being \"doubly free\" or \"doubly occupied\". A safe place, which can hold at most one token, is an ideal mathematical construct to represent this binary, single-occupancy state. Therefore, it is biologically appropriate to model $p_{R\\_f}$ and $p_{R\\_b}$ such that they are safe places, ensuring $M(p_{R\\_f}) + M(p_{R\\_b}) = 1$. In contrast, species like ligands ($p\\_L$) or metabolites ($p\\_M$) are typically populations of many individual molecules, and their numbers (or concentrations) can vary over a wide range. Restricting their corresponding places to be safe would be a gross oversimplification and biologically unrealistic, as it would imply only a single molecule of that species could exist in the system. Thus, it is biologically inappropriate to enforce safeness on such places. The statement correctly contrasts these two modeling scenarios.\nVerdict: **Correct**.\n\n**E. If one adds a new transition $t\\_{\\mathrm{in}}$ with no inputs ($0$ input arcs) and a single output arc of weight $1$ to $p\\_L$, then the PN remains bounded because $p\\_L+p\\_M+p_{R\\_b}$ is conserved.**\nThe new transition $t_{\\mathrm{in}}$ is a source transition for $p\\_L$. Its change vector is $(0, 0, 1, 0)^T$. A source transition is always enabled. It can be fired an arbitrary number of times, continuously adding tokens to its output places. This means the number of tokens in $p\\_L$ can grow without limit. Therefore, the modified PN is unbounded.\nThe reason given in the statement, \"because $p\\_L+p\\_M+p_{R\\_b}$ is conserved\", is also false. The sum $S_2 = M(p_{R\\_b}) + M(p\\_L) + M(p\\_M)$ is associated with the P-invariant $I_2 = (0, 1, 1, 1)^T$. For this sum to remain conserved, we must have $I_2^T \\cdot C' = \\mathbf{0}^T$, where $C'$ is the new incidence matrix including $t_{\\mathrm{in}}$. Let's check the dot product with the change vector of $t_{\\mathrm{in}}$:\n$I_2^T \\cdot (\\text{change vector of } t_{\\mathrm{in}}) = (0, 1, 1, 1) \\cdot (0, 0, 1, 0)^T = 1 \\neq 0$.\nSince the result is not zero, the sum $S_2$ is not conserved when $t_{\\mathrm{in}}$ fires; in fact, each firing increases the sum by $1$. So, both the main claim (boundedness) and the justification (conservation) are false.\nVerdict: **Incorrect**.\n\n**F. If the initial ligand count is changed to $M\\_0(p\\_L)=1000$ while keeping the same structure and the same initial values for $p_{R\\_f}$, $p_{R\\_b}$, and $p\\_M$, then $p_{R\\_f}$ and $p_{R\\_b}$ remain safe for all reachable markings.**\nThe P-invariants are structural properties of the net; they do not depend on the initial marking. The conserved sum $S_1 = M(p_{R\\_f}) + M(p_{R\\_b})$ is therefore still a constant for any firing sequence. The value of this constant is determined by the new initial marking, $M'_0 = (1, 0, 1000, 0)^T$.\n$S_1 = M'_0(p_{R\\_f}) + M'_0(p_{R\\_b}) = 1 + 0 = 1$.\nSince the sum $M(p_{R\\_f}) + M(p_{R\\_b})$ remains equal to $1$ for all markings reachable from $M'_0$, and markings are non-negative, both $M(p_{R\\_f})$ and $M(p_{R\\_b})$ are bounded above by $1$. They remain safe places. The large number of initial tokens in $p\\_L$ affects the value of the other invariant ($S_2 = 1000$) and the size of the reachability set, but it does not change the safeness of the receptor-site places.\nVerdict: **Correct**.",
            "answer": "$$\\boxed{ACDF}$$"
        },
        {
            "introduction": "Petri nets excel at revealing complex dynamic behaviors that emerge from simple interaction rules, including potential system failures. This problem delves into the concept of deadlock, a state where a system comes to a standstill, which has direct analogues in biology such as the sequestration of essential cofactors. By tracing the state evolution of a competitive binding system, you will identify a deadlock marking and evaluate how structural changes to the network—such as making reactions reversible—can resolve this pathological state, showcasing the power of Petri nets for qualitative analysis and troubleshooting of biochemical networks.",
            "id": "3337348",
            "problem": "You are given a place/transition Petri net (P/T Petri net) model of a minimal biochemical system exhibiting the following qualitative mechanism: two proteins competitively acquire scarce cofactors in a way that can lead to a standstill. A place/transition Petri net is defined by a finite set of places $P$, a finite set of transitions $T$, arc-weight (incidence) functions $\\text{pre}:P\\times T\\to\\mathbb{N}$ and $\\text{post}:P\\times T\\to\\mathbb{N}$, and a marking $M:P\\to\\mathbb{N}$. A transition $t\\in T$ is enabled at marking $M$ if for all $p\\in P$ one has $M(p)\\ge \\text{pre}(p,t)$. Firing $t$ yields $M'(p)=M(p)-\\text{pre}(p,t)+\\text{post}(p,t)$. A deadlock marking is a reachable marking at which no transition is enabled.\n\nConsider the following biochemical interpretation: places represent molecular pools; tokens represent molecule copy numbers; transitions represent elementary reactions with unit stoichiometry where specified. The net has places $P=\\{p\\_X, p\\_Y, p\\_{C\\_1}, p\\_{C\\_2}, p\\_{X\\text{-}C\\_1}, p\\_{Y\\text{-}C\\_2}\\}$ and transitions $T=\\{t\\_{\\text{b}1}, t\\_{\\text{b}2}, t\\_{\\text{cat}1}, t\\_{\\text{cat}2}\\}$ with the following biochemical semantics:\n- $t\\_{\\text{b}1}$: binding of $X$ to cofactor $C\\_1$, consuming one token from $p\\_X$ and $p\\_{C\\_1}$ and producing one token in $p\\_{X\\text{-}C\\_1}$.\n- $t\\_{\\text{b}2}$: binding of $Y$ to cofactor $C\\_2$, consuming one token from $p\\_Y$ and $p\\_{C\\_2}$ and producing one token in $p\\_{Y\\text{-}C\\_2}$.\n- $t\\_{\\text{cat}1}$: cofactor-assisted catalysis by $X$ that requires the preformed complex and the other cofactor, consuming one token from $p\\_{X\\text{-}C\\_1}$ and $p\\_{C\\_2}$ and producing one token in each of $p\\_X$, $p\\_{C\\_1}$, and $p\\_{C\\_2}$ (thus releasing $X$ and restoring both cofactors to the free pools).\n- $t\\_{\\text{cat}2}$: analogous catalysis by $Y$, consuming one token from $p\\_{Y\\text{-}C\\_2}$ and $p\\_{C\\_1}$ and producing one token in each of $p\\_Y$, $p\\_{C\\_1}$, and $p\\_{C\\_2}$.\n\nAssume the initial marking $M\\_0$ satisfies $M\\_0(p\\_X)=1$, $M\\_0(p\\_Y)=1$, $M\\_0(p\\_{C\\_1})=1$, $M\\_0(p\\_{C\\_2})=1$, and $M\\_0(p\\_{X\\text{-}C\\_1})=0$, $M\\_0(p\\_{Y\\text{-}C\\_2})=0$.\n\nTasks:\n- Using only the formal Petri net definitions above and the given incidence semantics, determine whether there exists a reachable deadlock marking in which both $t\\_{\\text{cat}1}$ and $t\\_{\\text{cat}2}$ are disabled due to competitive sequestration of cofactors and no other transition is enabled. Provide the minimal firing sequence that reaches such a marking if it exists, and justify that it is a deadlock in the strict Petri net sense.\n- Consider the following structural modifications to the net. Under standard place/transition Petri net semantics and requiring that changes preserve biochemical interpretability (mass-balanced reactions, no non-biochemical control constructs), which modifications guarantee the elimination of the deadlock regardless of firing order from the initial marking $M\\_0$? Select all that apply.\n\nOptions:\n\nA. Add reversible dissociation transitions $t\\_{\\text{u}1}$ and $t\\_{\\text{u}2}$ with $\\text{pre}(p\\_{X\\text{-}C\\_1}, t\\_{\\text{u}1})=1$, $\\text{post}(p\\_X, t\\_{\\text{u}1})=1$, $\\text{post}(p\\_{C\\_1}, t\\_{\\text{u}1})=1$ and $\\text{pre}(p\\_{Y\\text{-}C\\_2}, t\\_{\\text{u}2})=1$, $\\text{post}(p\\_Y, t\\_{\\text{u}2})=1$, $\\text{post}(p\\_{C\\_2}, t\\_{\\text{u}2})=1$ (i.e., make the binding reactions reversible by adding unimolecular dissociation).\n\nB. Increase the initial token count of exactly one cofactor pool by $1$ (i.e., either set $M\\_0(p\\_{C\\_1})=2$ and $M\\_0(p\\_{C\\_2})=1$, or set $M\\_0(p\\_{C\\_1})=1$ and $M\\_0(p\\_{C\\_2})=2$) without changing transitions.\n\nC. Replace the two-step acquisition pattern for each protein with an atomic ternary acquisition by removing $t\\_{\\text{b}1}$ and $t\\_{\\text{b}2}$ and adding transitions $t'\\_{\\text{b}1}$ and $t'\\_{\\text{b}2}$ with $\\text{pre}(p\\_X,t'\\_{\\text{b}1})=\\text{pre}(p\\_{C\\_1},t'\\_{\\text{b}1})=\\text{pre}(p\\_{C\\_2},t'\\_{\\text{b}1})=1$, $\\text{post}(p\\_X,t'\\_{\\text{b}1})=\\text{post}(p\\_{C\\_1},t'\\_{\\text{b}1})=\\text{post}(p\\_{C\\_2},t'\\_{\\text{b}1})=0$, and an intermediate complex place $p\\_{X\\text{-}C\\_1\\text{-}C\\_2}$ that then undergoes catalysis releasing all components; analogously for $Y$. All reactions remain mass-balanced.\n\nD. Add an inhibitor arc from $p\\_{C\\_1}$ to $t\\_{\\text{b}2}$ that disables $t\\_{\\text{b}2}$ when $p\\_{C\\_1}$ has $0$ tokens, thereby preventing $Y$ from binding $C\\_2$ if $C\\_1$ is unavailable.\n\nE. Add a sink transition $t\\_{\\text{sink}}$ that irreversibly consumes one token each from $p\\_{X\\text{-}C\\_1}$ and $p\\_{Y\\text{-}C\\_2}$ without products, removing the species and freeing no cofactors.\n\nSelect the correct option set that satisfies the stated criteria.",
            "solution": "The user has provided a problem in computational systems biology involving the analysis of a place/transition Petri net model of a biochemical system. The task is to first identify a potential deadlock state and then evaluate several proposed modifications to the network for their ability to eliminate this deadlock.\n\n### Formal Problem Specification\n\nThe Petri net is defined by:\n- A set of places $P = \\{p\\_X, p\\_Y, p\\_{C\\_1}, p\\_{C\\_2}, p\\_{X\\text{-}C\\_1}, p\\_{Y\\text{-}C\\_2}\\}$.\n- A set of transitions $T = \\{t\\_{\\text{b}1}, t\\_{\\text{b}2}, t\\_{\\text{cat}1}, t\\_{\\text{cat}2}\\}$.\n- An initial marking $M_0$ given as a vector over the places $(p\\_X, p\\_Y, p\\_{C\\_1}, p\\_{C\\_2}, p\\_{X\\text{-}C\\_1}, p\\_{Y\\text{-}C\\_2})$:\n$$M_0 = (1, 1, 1, 1, 0, 0)$$\n- The transitions' effects are defined by their pre- and post-conditions, which can be summarized by their change vectors (columns of the incidence matrix):\n  - $t\\_{\\text{b}1}$ (binding $X+C_1 \\to X\\text{-}C_1$): Consumes one token from $p_X$ and $p_{C_1}$, produces one in $p_{X\\text{-}C_1}$. Change vector: $(-1, 0, -1, 0, 1, 0)^T$.\n  - $t\\_{\\text{b}2}$ (binding $Y+C_2 \\to Y\\text{-}C_2$): Consumes one token from $p_Y$ and $p_{C_2}$, produces one in $p_{Y\\text{-}C_2}$. Change vector: $(0, -1, 0, -1, 0, 1)^T$.\n  - $t\\_{\\text{cat}1}$ (catalysis by $X$): Consumes one token from $p_{X\\text{-}C_1}$ and $p_{C_2}$, produces one each in $p_X$, $p_{C_1}$, and $p_{C_2}$. The net change for $p_{C_2}$ is $1-1=0$. Change vector: $(1, 0, 1, 0, -1, 0)^T$.\n  - $t\\_{\\text{cat}2}$ (catalysis by $Y$): Consumes one token from $p_{Y\\text{-}C_2}$ and $p_{C_1}$, produces one each in $p_Y$, $p_{C_1}$, and $p_{C_2}$. The net change for $p_{C_1}$ is $1-1=0$. Change vector: $(0, 1, 0, 1, 0, -1)^T$.\n\nA transition $t$ is enabled at marking $M$ if $M(p) \\geq \\text{pre}(p,t)$ for all places $p$. A deadlock is a reachable marking where no transitions are enabled.\n\n### Part 1: Existence of a Deadlock\n\nWe will explore the reachability graph starting from the initial marking $M_0 = (1, 1, 1, 1, 0, 0)$.\n\n1.  **Initial State $M_0$**:\n    - $t\\_{\\text{b}1}$ is enabled because $M_0(p\\_X) \\ge 1$ and $M_0(p\\_{C\\_1}) \\ge 1$.\n    - $t\\_{\\text{b}2}$ is enabled because $M_0(p\\_Y) \\ge 1$ and $M_0(p\\_{C\\_2}) \\ge 1$.\n    - $t\\_{\\text{cat}1}$ and $t\\_{\\text{cat}2}$ are disabled as their required complex places are empty.\n\n2.  **Firing Sequence leading to Deadlock**:\n    There is a non-deterministic choice between firing $t\\_{\\text{b}1}$ and $t\\_{\\text{b}2}$. Let's consider the sequence where both binding transitions fire before any catalytic transition.\n    - **Fire $t\\_{\\text{b}1}$**:\n      $M_1 = M_0 + (-1, 0, -1, 0, 1, 0)^T = (0, 1, 0, 1, 1, 0)$.\n      At $M_1$, $t\\_{\\text{b}1}$ is disabled (no $X$). $t\\_{\\text{cat}2}$ is disabled (no $Y\\text{-}C_2$).\n      However, $t\\_{\\text{b}2}$ is enabled ($M_1(p_Y) \\ge 1, M_1(p_{C_2}) \\ge 1$) and $t\\_{\\text{cat}1}$ is enabled ($M_1(p_{X\\text{-}C_1}) \\ge 1, M_1(p_{C_2}) \\ge 1$).\n    - **Fire $t\\_{\\text{b}2}$ from $M_1$**:\n      This choice leads to the sequestration state.\n      $M_D = M_1 + (0, -1, 0, -1, 0, 1)^T = (0, 0, 0, 0, 1, 1)$.\n      The firing sequence to reach this state is $(t\\_{\\text{b}1}, t\\_{\\text{b}2})$. Due to the symmetry of the system, the sequence $(t\\_{\\text{b}2}, t\\_{\\text{b}1})$ also leads to $M_D$.\n\n3.  **Verification of Deadlock**:\n    Let's check if any transition is enabled at $M_D = (0, 0, 0, 0, 1, 1)$.\n    - $t\\_{\\text{b}1}$: requires $M_D(p\\_X) \\ge 1$ and $M_D(p\\_{C\\_1}) \\ge 1$. Both are $0$. Disabled.\n    - $t\\_{\\text{b}2}$: requires $M_D(p\\_Y) \\ge 1$ and $M_D(p\\_{C\\_2}) \\ge 1$. Both are $0$. Disabled.\n    - $t\\_{\\text{cat}1}$: requires $M_D(p\\_{X\\text{-}C\\_1}) \\ge 1$ (true) and $M_D(p\\_{C\\_2}) \\ge 1$ (false, is $0$). Disabled.\n    - $t\\_{\\text{cat}2}$: requires $M_D(p\\_{Y\\text{-}C\\_2}) \\ge 1$ (true) and $M_D(p\\_{C\\_1}) \\ge 1$ (false, is $0$). Disabled.\n    No transitions are enabled. Therefore, $M_D = (0, 0, 0, 0, 1, 1)$ is a reachable deadlock marking. This state represents the mutual sequestration where protein $X$ has captured all of cofactor $C_1$, and protein $Y$ has captured all of cofactor $C_2$. Neither can complete its catalytic cycle because it requires the cofactor now held by the other.\n\n### Part 2: Evaluation of Modifications\n\nWe analyze each proposed modification for its ability to *guarantee* the elimination of deadlocks, regardless of the firing order.\n\n**A. Add reversible dissociation transitions**\nThis modification introduces $t\\_{\\text{u}1}: p\\_{X\\text{-}C\\_1} \\to p\\_X + p\\_{C\\_1}$ and $t\\_{\\text{u}2}: p\\_{Y\\text{-}C\\_2} \\to p\\_Y + p\\_{C\\_2}$.\nLet's examine the former deadlock marking $M_D = (0, 0, 0, 0, 1, 1)$ in the modified net.\n- $t\\_{\\text{u}1}$ requires $M_D(p\\_{X\\text{-}C\\_1}) \\ge 1$, which is true. So, $t\\_{\\text{u}1}$ is enabled.\n- $t\\_{\\text{u}2}$ requires $M_D(p\\_{Y\\text{-}C\\_2}) \\ge 1$, which is true. So, $t\\_{\\text{u}2}$ is enabled.\nSince at least one transition is enabled, $M_D$ is no longer a deadlock.\nFurthermore, any potential deadlock state must have no enabled transitions. In the modified net, any state with $M(p\\_{X\\text{-}C\\_1})>0$ has $t\\_{\\text{u}1}$ enabled, and any state with $M(p\\_{Y\\text{-}C\\_2})>0$ has $t\\_{\\text{u}2}$ enabled. Thus, a deadlock state $M_{dead}$ must satisfy $M_{dead}(p\\_{X\\text{-}C\\_1})=0$ and $M_{dead}(p\\_{Y\\text{-}C\\_2})=0$. From the system's P-invariants ($M(p_X)+M(p_{X-C1})=1$, $M(p_Y)+M(p_{Y-C2})=1$, etc.), this implies that $M_{dead}$ must be the initial marking $M_0 = (1, 1, 1, 1, 0, 0)$. At $M_0$, transitions $t\\_{\\text{b}1}$ and $t\\_{\\text{b}2}$ are enabled. Therefore, no reachable marking is a deadlock. This modification is biochemically realistic (reactions are typically reversible) and guarantees deadlock elimination.\n**Verdict: Correct**\n\n**B. Increase the initial token count of exactly one cofactor pool by $1$**\nLet's analyze the case where $M_0' = (1, 1, 2, 1, 0, 0)$, i.e., $M_0'(p_{C_1})=2$.\nThe path to the sequestration state remains possible: starting from $M_0'$, firing $(t\\_{\\text{b}1}, t\\_{\\text{b}2})$ leads to the marking $M' = (0, 0, 1, 0, 1, 1)$.\nLet's check if $M'$ is a deadlock:\n- $t\\_{\\text{b}1}, t\\_{\\text{b}2}$ are disabled (no free $X$ or $Y$).\n- $t\\_{\\text{cat}1}$ requires $M'(p_{X\\text{-}C\\_1}) \\ge 1$ (true) and $M'(p_{C\\_2}) \\ge 1$ (false, is $0$). Disabled.\n- $t\\_{\\text{cat}2}$ requires $M'(p_{Y\\text{-}C\\_2}) \\ge 1$ (true) and $M'(p_{C\\_1}) \\ge 1$ (true, is $1$). Enabled.\nSince $t\\_{\\text{cat}2}$ is enabled, this state is not a deadlock. The extra token in $p_{C_1}$ ensures that even after both proteins bind their primary cofactors, there is a free $C_1$ available for $t\\_{\\text{cat}2}$ to proceed.\nBy symmetry, if we start with $M_0''(p_{C_2})=2$, the sequence $(t\\_{\\text{b}1}, t\\_{\\text{b}2})$ would lead to a state $(0, 0, 0, 1, 1, 1)$ where $t\\_{\\text{cat}1}$ is enabled. In all cases, regardless of firing order, the system never reaches a state where both free $C_1$ and free $C_2$ are depleted. Thus, the deadlock is guaranteed to be eliminated.\n**Verdict: Correct**\n\n**C. Replace the two-step acquisition with atomic ternary acquisition**\nThis modification changes the binding mechanism. The transitions $t\\_{\\text{b}1}, t\\_{\\text{b}2}$ are removed. New transitions $t'_{b1}, t'_{b2}$ are added, where binding requires all three species simultaneously (e.g., for $X$: $X+C_1+C_2 \\to \\text{complex}$). The catalytic transitions are also adapted accordingly.\nLet the new system have transitions for $X+C_1+C_2 \\rightleftharpoons X\\text{-}C_1\\text{-}C_2$ and $Y+C_1+C_2 \\rightleftharpoons Y\\text{-}C_1\\text{-}C_2$.\nAt the initial marking $M_0=(1,1,1,1,...)$, both $t'_{\\text{b}1}$ and $t'_{\\text{b}2}$ are enabled, as $M_0(p_X)=1, M_0(p_Y)=1, M_0(p_{C_1})=1, M_0(p_{C_2})=1$. However, they compete for the single token in $p_{C_1}$ and the single token in $p_{C_2}$. Once one fires (e.g., $t'_{\\text{b}1}$), the marking becomes $(0,1,0,0,...)$ plus one token in the new complex place for $X$. At this new marking, $t'_{\\text{b}2}$ is disabled for lack of $C_1$ and $C_2$. The only enabled transition is the catalytic/dissociation step for the $X$ complex.\nA deadlock state requires all transitions to be disabled. In this modified net, any state with a complex formed will have the corresponding catalytic/dissociation transition enabled. Thus, a deadlock must have zero tokens in any complex-representing place. This would imply all molecules are in their free forms, which corresponds to the initial marking $M_0$. As we've seen, $M_0$ is not a deadlock. Therefore, no deadlock states exist. The original deadlock is impossible as it relied on splitting the cofactors $C_1$ and $C_2$ between the two proteins, which is prevented by the ternary binding mechanism.\n**Verdict: Correct**\n\n**D. Add an inhibitor arc**\nThe modification proposes an inhibitor arc from $p\\_{C\\_1}$ to $t\\_{\\text{b}2}$ that disables $t\\_{\\text{b}2}$ when $p\\_{C\\_1}$ has $0$ tokens. This means the enabling condition for $t\\_{\\text{b}2}$ becomes: $M(p_Y) \\ge 1 \\land M(p_{C_2}) \\ge 1 \\land M(p_{C_1}) > 0$. First, this uses a non-standard P/T net construct, which the problem statement asks to avoid. Even if we accept this construct, we must check if it guarantees deadlock elimination *regardless of firing order*.\n- If $t\\_{\\text{b}1}$ fires first from $M_0=(1,1,1,1,0,0)$, the marking becomes $M_1=(0,1,0,1,1,0)$. Here $M_1(p_{C_1})=0$, so the new condition makes $t\\_{\\text{b}2}$ disabled. The path to the deadlock is blocked.\n- However, the choice of which transition to fire from $M_0$ is non-deterministic. If $t\\_{\\text{b}2}$ fires first, the marking becomes $M_2=(1,0,1,0,0,1)$. At $M_2$, $M_2(p_{C_1})=1>0$, so the inhibitor arc has no effect. The original transition $t\\_{\\text{b}1}$ is still enabled as well. Firing $t\\_{\\text{b}1}$ from $M_2$ leads to the deadlock state $M_D=(0,0,0,0,1,1)$.\nSince a path to the deadlock still exists, this modification does not *guarantee* its elimination.\n**Verdict: Incorrect**\n\n**E. Add a sink transition**\nThis adds $t\\_{\\text{sink}}$ which consumes one token from $p\\_{X\\text{-}C\\_1}$ and one from $p\\_{Y\\text{-}C\\_2}$.\nLet's analyze the original deadlock marking $M_D=(0,0,0,0,1,1)$.\n- $t\\_{\\text{sink}}$ requires $M_D(p\\_{X\\text{-}C\\_1}) \\ge 1$ (true) and $M_D(p\\_{Y\\text{-}C\\_2}) \\ge 1$ (true). Thus, $t\\_{\\text{sink}}$ is enabled at $M_D$.\nThis means $M_D$ is no longer a deadlock. However, firing $t\\_{\\text{sink}}$ leads to a new marking $M_{sink} = (0,0,0,0,0,0)$.\nAt $M_{sink}$, all places are empty. No transition can fire. Thus, $M_{sink}$ is a new deadlock marking. The modification merely replaces one deadlock state with another. It does not eliminate the possibility of the system reaching a \"standstill\".\n**Verdict: Incorrect**\n\n### Conclusion\n\nBased on the analysis, modifications A, B, and C all guarantee the elimination of any deadlock state from the system, regardless of the firing order of transitions.",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}