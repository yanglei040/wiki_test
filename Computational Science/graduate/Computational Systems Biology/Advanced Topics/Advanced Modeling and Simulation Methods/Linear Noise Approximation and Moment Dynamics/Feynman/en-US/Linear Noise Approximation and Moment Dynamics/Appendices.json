{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation in the Linear Noise Approximation (LNA), we begin with its derivation from first principles. This exercise guides you through the process of applying the van Kampen system-size expansion to a simple birth-death model, allowing you to derive the diffusion coefficient which quantifies intrinsic noise . By explicitly calculating the contributions from birth and death events, you will gain a concrete understanding of how individual stochastic reactions collectively shape the fluctuations at the macroscopic level.",
            "id": "3323858",
            "problem": "Consider a single-species birth-death process in a well-mixed compartment of volume $\\Omega$, with molecular count denoted by $X$. The reaction scheme is: birth $\\varnothing \\to X$ and death $X \\to \\varnothing$. Assume standard stochastic mass-action kinetics with propensities $a_{+}(X)=\\alpha \\Omega$ for birth and $a_{-}(X)=k X$ for death, where $\\alpha$ and $k$ are positive constants, and define the macroscopic concentration $\\phi$ via $X=\\Omega \\phi$. Using the van Kampen system-size expansion up to the linear noise approximation (LNA), let $\\xi$ denote the concentration fluctuation defined by $X=\\Omega \\phi + \\Omega^{1/2}\\xi$. In the LNA, the probability density for $\\xi$ obeys a linear Fokker–Planck equation with a state-dependent diffusion coefficient $D(\\phi)$ that captures the intrinsic noise intensity at concentration $\\phi$.\n\nStarting from the Chemical Master Equation and the definition of stoichiometry for the two reactions, derive the explicit expression for $D(\\phi)$ in terms of $\\alpha$, $k$, and $\\phi$. Then, interpret how the separate birth and death reactions contribute to the instantaneous variance growth of $X$ at the macroscopic concentration $\\phi$. Express your final answer as a single closed-form analytic expression for $D(\\phi)$. No numerical evaluation is required and no units need to be reported in the final answer.",
            "solution": "The problem requires the derivation of the diffusion coefficient $D(\\phi)$ for a single-species birth-death process within the framework of the Linear Noise Approximation (LNA). We begin with the Chemical Master Equation (CME), which governs the time evolution of the probability $P(X, t)$ of having $X$ molecules at time $t$.\n\nThe reactions are:\n1. Birth: $\\varnothing \\xrightarrow{\\alpha\\Omega} X$, with stoichiometry $S_+ = +1$ and propensity $a_+(X) = \\alpha\\Omega$.\n2. Death: $X \\xrightarrow{kX} \\varnothing$, with stoichiometry $S_- = -1$ and propensity $a_-(X) = kX$.\n\nThe CME for this system is:\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = [a_+(X-1)P(X-1, t) - a_+(X)P(X, t)] + [a_-(X+1)P(X+1, t) - a_-(X)P(X, t)]\n$$\nSubstituting the given propensities:\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = [\\alpha\\Omega P(X-1, t) - \\alpha\\Omega P(X, t)] + [k(X+1)P(X+1, t) - kX P(X, t)]\n$$\n\nThe next step is to apply the van Kampen system-size expansion. We decompose the molecular count $X$ into a deterministic, macroscopic part and a stochastic fluctuation part:\n$$\nX(t) = \\Omega\\phi(t) + \\Omega^{1/2}\\xi(t)\n$$\nHere, $\\phi(t)$ is the macroscopic concentration and $\\xi(t)$ is the fluctuation variable. The probability distribution $P(X, t)$ is transformed into a distribution for the fluctuation, $\\Pi(\\xi, t)$, such that $P(X, t)dX = \\Pi(\\xi, t)d\\xi$. Since $dX = \\Omega^{1/2}d\\xi$, we have $P(X, t) = \\Omega^{-1/2}\\Pi(\\xi, t)$.\n\nThe time derivative on the left-hand side of the CME transforms as:\n$$\n\\frac{\\partial}{\\partial t} P(X, t) = \\frac{\\partial}{\\partial t} \\left(\\Omega^{-1/2}\\Pi(\\xi, t)\\right) = \\Omega^{-1/2}\\frac{\\partial \\Pi}{\\partial t} + \\Omega^{-1/2} \\frac{\\partial \\Pi}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial t}\n$$\nFrom the definition of $\\xi$, we have $\\frac{\\partial \\xi}{\\partial t} = -\\Omega^{1/2} \\frac{d\\phi}{dt}$. Thus, the LHS becomes:\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = \\Omega^{-1/2}\\frac{\\partial \\Pi}{\\partial t} - \\Omega^{1/2}\\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi}\n$$\n\nNow we expand the terms on the right-hand side of the CME. We use the Kramers-Moyal expansion, which can be expressed using shift operators $E_X^n f(X) = f(X+n)$. The CME can be written as:\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = \\sum_{j \\in \\{+,-\\}} (E_X^{-S_j} - 1)[a_j(X) P(X, t)]\n$$\nThe shift operator acting on functions of $X$ can be expanded in terms of derivatives with respect to $\\xi$, using $\\frac{\\partial}{\\partial X} = \\Omega^{-1/2}\\frac{\\partial}{\\partial \\xi}$:\n$$\nE_X^{-S_j} = \\exp\\left(-S_j \\frac{\\partial}{\\partial X}\\right) = \\exp\\left(-S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi}\\right)\n$$\nExpanding the exponential operator up to second order yields:\n$$\nE_X^{-S_j} - 1 \\approx -S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi} + \\frac{1}{2} S_j^2 \\Omega^{-1} \\frac{\\partial^2}{\\partial \\xi^2}\n$$\nThe propensity terms are expanded around the macroscopic state $\\Omega\\phi$:\n$$\na_j(X) = a_j(\\Omega\\phi + \\Omega^{1/2}\\xi) \\approx a_j(\\Omega\\phi) + \\Omega^{1/2}\\xi \\frac{da_j}{dX}\\bigg|_{X=\\Omega\\phi}\n$$\nLet's define the macroscopic rate functions $F_j(\\phi) = \\Omega^{-1}a_j(\\Omega\\phi)$.\nFor the birth reaction: $F_+(\\phi) = \\Omega^{-1}(\\alpha\\Omega) = \\alpha$.\nFor the death reaction: $F_-(\\phi) = \\Omega^{-1}(k\\Omega\\phi) = k\\phi$.\n\nThe term $[a_j(X) P(X, t)]$ in the CME is expanded as:\n$$\na_j(\\Omega\\phi + \\Omega^{1/2}\\xi) \\Omega^{-1/2}\\Pi(\\xi, t) \\approx [\\Omega F_j(\\phi) + \\dots] \\Omega^{-1/2}\\Pi = \\Omega^{1/2}F_j(\\phi)\\Pi(\\xi, t) + \\mathcal{O}(\\Omega^0)\n$$\nSubstituting these expansions into the RHS of the CME:\n$$\n\\sum_j \\left(-S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi} + \\frac{1}{2} S_j^2 \\Omega^{-1} \\frac{\\partial^2}{\\partial \\xi^2} + \\dots\\right) \\left[ (a_j(\\Omega\\phi) + \\dots)\\Omega^{-1/2}\\Pi \\right]\n$$\nWe collect terms by powers of $\\Omega$.\n\nThe highest order term is $\\Omega^{1/2}$. Equating terms of this order from the LHS and RHS:\n$$\n-\\Omega^{1/2}\\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi} = \\sum_j \\left( -S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi}\\right) (a_j(\\Omega\\phi) \\Omega^{-1/2} \\Pi) = \\sum_j -S_j (\\Omega^{-1}a_j(\\Omega\\phi))\\Omega^{1/2}\\frac{\\partial\\Pi}{\\partial\\xi}\n$$\n$$\n-\\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi} = -\\left(\\sum_j S_j F_j(\\phi)\\right) \\frac{\\partial \\Pi}{\\partial \\xi}\n$$\nThis must hold for any $\\Pi$, giving the macroscopic rate equation:\n$$\n\\frac{d\\phi}{dt} = \\sum_j S_j F_j(\\phi) = S_+ F_+(\\phi) + S_- F_-(\\phi) = (+1)\\alpha + (-1)k\\phi = \\alpha - k\\phi\n$$\nThis equation describes the evolution of the deterministic, macroscopic concentration.\n\nTo find the diffusion coefficient, we examine the terms of order $\\Omega^0$. This requires a more careful expansion of the RHS. A general result from the van Kampen expansion is that the resulting linear Fokker-Planck equation for $\\xi$ is:\n$$\n\\frac{\\partial \\Pi}{\\partial t} = -J(\\phi) \\frac{\\partial}{\\partial \\xi}(\\xi \\Pi) + \\frac{1}{2} D(\\phi) \\frac{\\partial^2 \\Pi}{\\partial \\xi^2}\n$$\nwhere $J(\\phi)$ is related to the Jacobian of the macroscopic system and $D(\\phi)$ is the diffusion coefficient. The diffusion coefficient is given by the general formula:\n$$\nD(\\phi) = \\sum_j S_j^2 F_j(\\phi)\n$$\nUsing the stoichiometry vectors and macroscopic rates for our system:\n$S_+ = +1$, $F_+(\\phi) = \\alpha$\n$S_- = -1$, $F_-(\\phi) = k\\phi$\nWe can compute $D(\\phi)$:\n$$\nD(\\phi) = S_+^2 F_+(\\phi) + S_-^2 F_-(\\phi) = (+1)^2 (\\alpha) + (-1)^2 (k\\phi)\n$$\n$$\nD(\\phi) = \\alpha + k\\phi\n$$\nThis is the explicit expression for the diffusion coefficient in the LNA.\n\nThe problem also asks for an interpretation of the contributions from the birth and death reactions. The diffusion term in the Fokker-Planck equation, $\\frac{1}{2} D(\\phi) \\frac{\\partial^2 \\Pi}{\\partial \\xi^2}$, governs the rate of increase of the variance of the fluctuations. The rate of change of the variance of $\\xi$, denoted $V_\\xi = \\langle \\xi^2 \\rangle - \\langle \\xi \\rangle^2$, is given by $\\frac{dV_\\xi}{dt} = -2J(\\phi) V_\\xi + D(\\phi)$. The term $D(\\phi)$ represents the instantaneous growth rate of the variance of $\\xi$ due to the stochastic nature of the reactions.\n\nThe variance of the molecular count $X$ is $\\text{Var}(X) = \\Omega V_\\xi$. The instantaneous growth of this variance due to stochastic events is $\\Omega D(\\phi)$:\n$$\n\\text{Growth rate of Var}(X) = \\Omega D(\\phi) = \\Omega(\\alpha + k\\phi) = \\alpha\\Omega + k\\Omega\\phi\n$$\nWe can recognize the terms on the right-hand side:\n- $\\alpha\\Omega = a_+(\\Omega\\phi)$ is the macroscopic propensity of the birth reaction.\n- $k\\Omega\\phi = a_-(\\Omega\\phi)$ is the macroscopic propensity of the death reaction.\n\nThe instantaneous growth of variance for a set of random events is given by $\\sum_j (\\Delta X_j)^2 \\times (\\text{rate}_j)$, where $\\Delta X_j$ is the change in state and $\\text{rate}_j$ is the frequency of the event. For chemical reactions, this corresponds to $\\sum_j S_j^2 a_j(X)$. Evaluated at the macroscopic level, this is $\\sum_j S_j^2 a_j(\\Omega\\phi)$.\n- Birth reaction contribution: $S_+^2 a_+(\\Omega\\phi) = (+1)^2 (\\alpha\\Omega) = \\alpha\\Omega$.\n- Death reaction contribution: $S_-^2 a_-(\\Omega\\phi) = (-1)^2 (k\\Omega\\phi) = k\\Omega\\phi$.\nThe total variance growth rate for the particle number $X$ is the sum of these contributions, $\\alpha\\Omega + k\\Omega\\phi$. The diffusion coefficient $D(\\phi)$ for the concentration fluctuation $\\xi$ is this total variance growth rate scaled by the system size $\\Omega$.\nTherefore, the term $\\alpha$ in $D(\\phi)$ is the scaled contribution from the birth reaction, and the term $k\\phi$ is the scaled contribution from the death reaction. The birth reaction provides a constant noise source, while the noise from the death reaction is proportional to the concentration.",
            "answer": "$$\n\\boxed{\\alpha + k\\phi}\n$$"
        },
        {
            "introduction": "We now apply the LNA framework to a cornerstone of systems biology: the two-stage model of gene expression. This practice moves beyond a single species to a multivariate system, introducing the essential matrix tools used to analyze noise in networks . You will construct the stoichiometry and Jacobian matrices and solve the Lyapunov equation to determine the steady-state variance of protein levels, a classic result that reveals how noise propagates from transcription to translation.",
            "id": "3323872",
            "problem": "Consider a well-mixed single-cell gene expression system with two chemical species, messenger RNA $\\mathrm{mRNA}$ and protein $\\mathrm{Protein}$, undergoing the following elementary reactions with mass-action kinetics: transcription $\\emptyset \\xrightarrow{k_m} \\mathrm{mRNA}$, translation $\\mathrm{mRNA} \\xrightarrow{k_p} \\mathrm{mRNA}+ \\mathrm{Protein}$, and first-order degradations $\\mathrm{mRNA}\\xrightarrow{\\gamma_m}\\emptyset$, $\\mathrm{Protein}\\xrightarrow{\\gamma_p}\\emptyset$. Let the state vector be $\\phi(t) = (m(t), p(t))^{\\top}$, where $m(t)$ and $p(t)$ denote the deterministic concentrations or copy-number means scaled to a fixed system size. Using the standard definitions of the stoichiometry matrix $S$ and the macroscopic rate function $f(\\phi) = S\\,a(\\phi)$ with mass-action propensities $a(\\phi)$, construct $S$ and the Jacobian $A(\\phi^{\\ast}) = \\left.\\frac{\\partial f}{\\partial \\phi}\\right|_{\\phi=\\phi^{\\ast}}$ evaluated at the deterministic steady state $\\phi^{\\ast}$. Then, invoking the Linear Noise Approximation (LNA), determine the stationary variance of protein copy-number fluctuations, i.e., the $(2,2)$-entry of the steady-state covariance matrix of fluctuations around $\\phi^{\\ast}$. Express your final answer as a single closed-form analytic expression in terms of $k_m$, $k_p$, $\\gamma_m$, and $\\gamma_p$. Do not include any units. No numerical evaluation is required.",
            "solution": "The system consists of two species, $\\mathrm{mRNA}$ and $\\mathrm{Protein}$, with concentrations denoted by the state vector $\\phi(t) = (m(t), p(t))^{\\top}$. The four elementary reactions are:\n1. Transcription: $\\emptyset \\xrightarrow{k_m} \\mathrm{mRNA}$\n2. Translation: $\\mathrm{mRNA} \\xrightarrow{k_p} \\mathrm{mRNA}+ \\mathrm{Protein}$\n3. mRNA degradation: $\\mathrm{mRNA}\\xrightarrow{\\gamma_m}\\emptyset$\n4. Protein degradation: $\\mathrm{Protein}\\xrightarrow{\\gamma_p}\\emptyset$\n\nFirst, we construct the stoichiometry matrix $S$, which describes the net change in species copy numbers for each reaction. With species ordered as $(m, p)$ and reactions as $(1, 2, 3, 4)$, the net changes are:\n$R_1: \\Delta m=1, \\Delta p=0$\n$R_2: \\Delta m=0, \\Delta p=1$\n$R_3: \\Delta m=-1, \\Delta p=0$\n$R_4: \\Delta m=0, \\Delta p=-1$\nThe stoichiometry matrix $S$ is a $2 \\times 4$ matrix:\n$$S = \\begin{pmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 \\end{pmatrix}$$\nThe propensity vector $a(\\phi)$ contains the rates for each reaction, which follow mass-action kinetics:\n$$a(\\phi) = \\begin{pmatrix} k_m \\\\ k_p m \\\\ \\gamma_m m \\\\ \\gamma_p p \\end{pmatrix}$$\nThe macroscopic rate equation is given by $\\frac{d\\phi}{dt} = f(\\phi) = S a(\\phi)$:\n$$\\frac{d\\phi}{dt} = \\begin{pmatrix} \\frac{dm}{dt} \\\\ \\frac{dp}{dt} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} k_m \\\\ k_p m \\\\ \\gamma_m m \\\\ \\gamma_p p \\end{pmatrix} = \\begin{pmatrix} k_m - \\gamma_m m \\\\ k_p m - \\gamma_p p \\end{pmatrix}$$\nTo find the deterministic steady state $\\phi^{\\ast} = (m^{\\ast}, p^{\\ast})^{\\top}$, we set $\\frac{d\\phi}{dt} = 0$:\n$$k_m - \\gamma_m m^{\\ast} = 0 \\implies m^{\\ast} = \\frac{k_m}{\\gamma_m}$$\n$$k_p m^{\\ast} - \\gamma_p p^{\\ast} = 0 \\implies p^{\\ast} = \\frac{k_p m^{\\ast}}{\\gamma_p} = \\frac{k_p}{\\gamma_p} \\left(\\frac{k_m}{\\gamma_m}\\right) = \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\nNext, we compute the Jacobian matrix $A = \\frac{\\partial f}{\\partial \\phi}$ evaluated at the steady state $\\phi^{\\ast}$:\n$$A = \\left.\\begin{pmatrix} \\frac{\\partial}{\\partial m}(k_m - \\gamma_m m) & \\frac{\\partial}{\\partial p}(k_m - \\gamma_m m) \\\\ \\frac{\\partial}{\\partial m}(k_p m - \\gamma_p p) & \\frac{\\partial}{\\partial p}(k_p m - \\gamma_p p) \\end{pmatrix}\\right|_{\\phi=\\phi^{\\ast}} = \\begin{pmatrix} -\\gamma_m & 0 \\\\ k_p & -\\gamma_p \\end{pmatrix}$$\nThe Jacobian is independent of the state $\\phi$, so $A(\\phi^{\\ast}) = A$.\n\nThe Linear Noise Approximation (LNA) models the dynamics of the covariance matrix of fluctuations, $C(t)$, via the Lyapunov equation: $\\frac{dC}{dt} = A C + C A^{\\top} + E$. At steady state, $\\frac{dC}{dt}=0$, so the steady-state covariance matrix $C_{ss}$ satisfies:\n$$A C_{ss} + C_{ss} A^{\\top} = -E$$\nThe diffusion matrix $E$ is defined as $E = S \\operatorname{diag}(a(\\phi^{\\ast})) S^{\\top}$. First, we evaluate the propensities at steady state:\n$$a(\\phi^{\\ast}) = \\begin{pmatrix} k_m \\\\ k_p m^{\\ast} \\\\ \\gamma_m m^{\\ast} \\\\ \\gamma_p p^{\\ast} \\end{pmatrix} = \\begin{pmatrix} k_m \\\\ k_p \\frac{k_m}{\\gamma_m} \\\\ \\gamma_m \\frac{k_m}{\\gamma_m} \\\\ \\gamma_p \\frac{k_m k_p}{\\gamma_m \\gamma_p} \\end{pmatrix} = \\begin{pmatrix} k_m \\\\ \\frac{k_m k_p}{\\gamma_m} \\\\ k_m \\\\ \\frac{k_m k_p}{\\gamma_m} \\end{pmatrix}$$\nNow we compute $E$:\n$$E = \\begin{pmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} k_m & 0 & 0 & 0 \\\\ 0 & \\frac{k_m k_p}{\\gamma_m} & 0 & 0 \\\\ 0 & 0 & k_m & 0 \\\\ 0 & 0 & 0 & \\frac{k_m k_p}{\\gamma_m} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ -1 & 0 \\\\ 0 & -1 \\end{pmatrix}$$\n$$E = \\begin{pmatrix} k_m & 0 & -k_m & 0 \\\\ 0 & \\frac{k_m k_p}{\\gamma_m} & 0 & -\\frac{k_m k_p}{\\gamma_m} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ -1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 2k_m & 0 \\\\ 0 & \\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\nLet $C_{ss} = \\begin{pmatrix} C_{11} & C_{12} \\\\ C_{21} & C_{22} \\end{pmatrix}$, where $C_{12} = C_{21}$. The Lyapunov equation becomes:\n$$\\begin{pmatrix} -\\gamma_m & 0 \\\\ k_p & -\\gamma_p \\end{pmatrix} \\begin{pmatrix} C_{11} & C_{12} \\\\ C_{12} & C_{22} \\end{pmatrix} + \\begin{pmatrix} C_{11} & C_{12} \\\\ C_{12} & C_{22} \\end{pmatrix} \\begin{pmatrix} -\\gamma_m & k_p \\\\ 0 & -\\gamma_p \\end{pmatrix} = \\begin{pmatrix} -2k_m & 0 \\\\ 0 & -\\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\nPerforming the matrix multiplication gives:\n$$\\begin{pmatrix} -2\\gamma_m C_{11} & k_p C_{11} - \\gamma_m C_{12} - \\gamma_p C_{12} \\\\ k_p C_{11} - \\gamma_m C_{12} - \\gamma_p C_{12} & 2k_p C_{12} - 2\\gamma_p C_{22} \\end{pmatrix} = \\begin{pmatrix} -2k_m & 0 \\\\ 0 & -\\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\nThis yields a system of three linear equations:\n1.  $-2\\gamma_m C_{11} = -2k_m \\implies C_{11} = \\frac{k_m}{\\gamma_m}$\n2.  $k_p C_{11} - (\\gamma_m + \\gamma_p)C_{12} = 0 \\implies C_{12} = \\frac{k_p C_{11}}{\\gamma_m + \\gamma_p} = \\frac{k_p (k_m/\\gamma_m)}{\\gamma_m + \\gamma_p} = \\frac{k_m k_p}{\\gamma_m(\\gamma_m + \\gamma_p)}$\n3.  $2k_p C_{12} - 2\\gamma_p C_{22} = -\\frac{2k_m k_p}{\\gamma_m} \\implies \\gamma_p C_{22} = k_p C_{12} + \\frac{k_m k_p}{\\gamma_m}$\n\nWe want to find $C_{22}$, the $(2,2)$-entry of the covariance matrix, which represents the variance of protein copy-number fluctuations. From equation $(3)$:\n$$C_{22} = \\frac{k_p}{\\gamma_p} C_{12} + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\nSubstituting the expression for $C_{12}$ from equation $(2)$:\n$$C_{22} = \\frac{k_p}{\\gamma_p} \\left( \\frac{k_m k_p}{\\gamma_m(\\gamma_m + \\gamma_p)} \\right) + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n$$C_{22} = \\frac{k_m k_p^2}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\nTo combine the terms, we find a common denominator:\n$$C_{22} = \\frac{k_m k_p^2}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} + \\frac{k_m k_p (\\gamma_m + \\gamma_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n$$C_{22} = \\frac{k_m k_p^2 + k_m k_p \\gamma_m + k_m k_p \\gamma_p}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\nFactoring out $k_m k_p$ from the numerator gives the final expression:\n$$C_{22} = \\frac{k_m k_p (\\gamma_m + \\gamma_p + k_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\nThis expression represents the stationary variance of protein copy-number fluctuations.",
            "answer": "$$\\boxed{\\frac{k_m k_p (\\gamma_m + \\gamma_p + k_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}}$$"
        },
        {
            "introduction": "A crucial aspect of mastering any approximation is understanding its limitations. This hands-on coding exercise challenges you to critically evaluate the LNA by comparing its predictions against the exact solution derived from the Chemical Master Equation (CME) . By calculating the extinction probability for a subcritical birth-death process, you will quantitatively explore a scenario where the LNA's underlying Gaussian assumption breaks down, providing deep insight into when this powerful approximation is appropriate and when it fails to capture essential features of stochastic dynamics.",
            "id": "3323843",
            "problem": "Consider a well-mixed single-species biochemical population undergoing a linear birth-death process with absorbing boundary at zero. The reactions are: birth $X \\to X + 1$ with propensity $a_{b}(x) = \\lambda x$ and death $X \\to X - 1$ with propensity $a_{d}(x) = \\mu x$, where $x \\in \\mathbb{Z}_{\\ge 0}$ is the molecule count, $\\lambda$ is the per-capita birth rate, and $\\mu$ is the per-capita death rate. Assume the population is subcritical so that $\\mu > \\lambda$, and let the initial molecule count be $x(0) = n_{0} \\in \\mathbb{Z}_{\\ge 0}$. Time is measured in seconds, and rates are measured in $\\mathrm{s}^{-1}$.\n\nYour task is to start from first principles in stochastic chemical kinetics and derive two independent predictions for the probability that the population is extinct (i.e., absorbed at zero) at a fixed observation time $T$:\n- One prediction must be derived from the Chemical Master Equation (CME) for the linear birth-death process treated as a continuous-time branching process, leading to the exact extinction probability at time $T$ given $n_{0}$ independent initial molecules.\n- The second prediction must be derived from the Linear Noise Approximation (LNA), which assumes Gaussian fluctuations around the deterministic mean field trajectory obtained from the macroscopic Ordinary Differential Equation (ODE). From the LNA, compute the mean $m(T)$ and variance $v(T)$ of $X(T)$, and then use these to approximate the extinction probability by the Gaussian left-tail probability at zero.\n\nYou must then implement both derived formulas in a single program and quantify the discrepancy between them for a specified test suite. The discrepancy for each test case must be computed as the absolute difference between the exact CME extinction probability and the LNA Gaussian approximation.\n\nFundamental base to use:\n- The CME defines the time evolution of probability over molecule counts for a Markov jump process with the given propensities.\n- The macroscopic ODE for the mean-field dynamics of a linear birth-death process is $d\\phi/dt = (\\lambda - \\mu)\\phi$ with solution $\\phi(t)$ given the initial condition $\\phi(0) = n_{0}$.\n- Moment dynamics for linear systems can be obtained from the CME or equivalent Kramers–Moyal expansion, and the LNA assumes Gaussian fluctuations determined by a linearized drift and diffusion around the macroscopic trajectory.\n\nImportant requirements and clarifications:\n- Carefully derive both predictions without using any pre-provided shortcut formulas.\n- Clearly state the units for all dimensional inputs and ensure the output probabilities are dimensionless and expressed as decimals (no percentage sign).\n- The approximation from the LNA must be implemented as a Gaussian cumulative distribution function (cdf) evaluated at zero using $m(T)$ and $v(T)$.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest suite:\n- Case $1$: $\\lambda = 0.4\\,\\mathrm{s}^{-1}$, $\\mu = 0.6\\,\\mathrm{s}^{-1}$, $n_{0} = 10$ molecules, $T = 2\\,\\mathrm{s}$.\n- Case $2$: $\\lambda = 0.95\\,\\mathrm{s}^{-1}$, $\\mu = 1.0\\,\\mathrm{s}^{-1}$, $n_{0} = 50$ molecules, $T = 1\\,\\mathrm{s}$.\n- Case $3$ (pure death edge case): $\\lambda = 0.0\\,\\mathrm{s}^{-1}$, $\\mu = 1.0\\,\\mathrm{s}^{-1}$, $n_{0} = 5$ molecules, $T = 0.2\\,\\mathrm{s}$.\n- Case $4$ (long-time limit): $\\lambda = 0.2\\,\\mathrm{s}^{-1}$, $\\mu = 0.4\\,\\mathrm{s}^{-1}$, $n_{0} = 20$ molecules, $T = 50\\,\\mathrm{s}$.\n\nFinal output format:\n- Your program should output a single line containing the absolute discrepancies for the four test cases in the order listed above, as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]$).",
            "solution": "### Derivation of the Exact Extinction Probability (CME)\n\nThe linear birth-death process starting with $n_0$ individuals can be viewed as the superposition of $n_0$ independent and identically distributed branching processes, each initiated by a single individual. The total population is extinct at time $T$ if and only if all $n_0$ independent lineages have gone extinct by time $T$.\n\nLet $p_{\\text{ext},1}(t)$ be the probability that a lineage started by a single individual at time $t=0$ is extinct by time $t$. The probability of extinction for the entire population is then:\n$$P_{\\text{CME}}(T) = [p_{\\text{ext},1}(T)]^{n_0}$$\n\nTo find $p_{\\text{ext},1}(t)$, we can analyze the dynamics of the probability of being in state $x=0$, denoted $P_0(t)$. For a process starting with one individual, $P_0(t) \\equiv p_{\\text{ext},1}(t)$. The backward Kolmogorov equation for the extinction probability $p(t)$ for a single lineage is:\n$$\\frac{dp}{dt} = \\lambda p^2 - (\\lambda+\\mu)p + \\mu$$\nThis can be rewritten as:\n$$\\frac{dp}{dt} = (\\mu - \\lambda p)(1 - p)$$\nThis is a separable first-order differential equation. We solve it with the initial condition $p(0)=0$ (the probability of being extinct at time $0$ is zero if we start with one particle).\n$$\\int_0^p \\frac{dp'}{(\\mu-\\lambda p')(1-p')} = \\int_0^t dt'$$\nUsing partial fraction decomposition, the integral on the left becomes $\\frac{1}{\\mu-\\lambda}\\int_0^p (\\frac{\\lambda}{\\mu-\\lambda p'} + \\frac{1}{1-p'}) dp'$. Integrating gives:\n$$\\frac{1}{\\mu-\\lambda}\\left[-\\ln(\\mu-\\lambda p') - \\ln(1-p')\\right]_0^p = t$$\n$$\\frac{1}{\\mu-\\lambda}\\left(\\ln(1-p) - \\ln(\\mu-\\lambda p) - (\\ln(1) - \\ln(\\mu))\\right) = t$$\n$$\\ln\\left(\\frac{\\mu(1-p)}{\\mu-\\lambda p}\\right) = (\\mu-\\lambda)t$$\nSolving for $p$, which is our $p_{\\text{ext},1}(t)$:\n$$\\frac{\\mu(1-p)}{\\mu-\\lambda p} = e^{(\\mu-\\lambda)t}$$\n$$p(t) = \\frac{\\mu(1 - e^{-(\\mu-\\lambda)t})}{ \\mu - \\lambda e^{-(\\mu-\\lambda)t}} = \\frac{\\mu(e^{(\\mu-\\lambda)t} - 1)}{\\mu e^{(\\mu-\\lambda)t} - \\lambda}$$\nThe exact probability of extinction for an initial population of $n_0$ is:\n$$P_{\\text{CME}}(T) = \\left( \\frac{\\mu(e^{(\\mu-\\lambda)T} - 1)}{\\mu e^{(\\mu-\\lambda)T} - \\lambda} \\right)^{n_0}$$\n\n### Derivation of the Approximate Extinction Probability (LNA)\n\nThe Linear Noise Approximation (LNA) approximates the stochastic dynamics by a Gaussian process governed by equations for the mean and variance.\n\n**1. Mean Dynamics:**\nThe macroscopic rate equation for the mean number of molecules, $m(t)$, is obtained from the propensities:\n$$\\frac{dm}{dt} = (+1) a_b(m) + (-1) a_d(m) = \\lambda m - \\mu m = (\\lambda-\\mu)m$$\nWith the initial condition $m(0) = n_0$, the solution is:\n$$m(t) = n_0 e^{(\\lambda-\\mu)t}$$\nAt the observation time $T$, the mean is $m(T) = n_0 e^{(\\lambda-\\mu)T}$.\n\n**2. Variance Dynamics:**\nThe evolution of the variance, $v(t)$, under the LNA is given by the Lyapunov equation:\n$$\\frac{dv}{dt} = 2 J(t) v(t) + D(t)$$\nwhere $J(t)$ is the Jacobian of the rate equation and $D(t)$ is the diffusion term.\n-   **Jacobian**: $J(t) = \\frac{d}{dm}[(\\lambda-\\mu)m] = \\lambda-\\mu$.\n-   **Diffusion**: $D(t) = \\sum_{k \\in \\{b,d\\}} \\nu_k^2 a_k(m(t)) = (+1)^2 (\\lambda m(t)) + (-1)^2 (\\mu m(t)) = (\\lambda+\\mu)m(t)$.\n\nSubstituting these into the variance equation:\n$$\\frac{dv}{dt} = 2(\\lambda-\\mu)v + (\\lambda+\\mu)m(t)$$\nThis is a first-order linear ordinary differential equation for $v(t)$, which can be solved with the initial condition $v(0)=0$. The solution is:\n$$v(t) = n_0 \\frac{\\lambda+\\mu}{\\mu-\\lambda} (e^{(\\lambda-\\mu)t} - e^{2(\\lambda-\\mu)t})$$\nAt the observation time $T$, the variance is:\n$$v(T) = n_0 \\frac{\\lambda+\\mu}{\\mu-\\lambda} (e^{(\\lambda-\\mu)T} - e^{2(\\lambda-\\mu)T})$$\n\n**3. Gaussian Approximation for Extinction:**\nThe LNA approximates the probability distribution of $X(T)$ as a Gaussian distribution $\\mathcal{N}(m(T), v(T))$. The probability of extinction, $P(X(T)=0)$, is approximated by the cumulative probability of this Gaussian up to $0$:\n$$P_{\\text{LNA}}(T) = P(Y \\le 0) \\quad \\text{where } Y \\sim \\mathcal{N}(m(T), v(T))$$\nThis is calculated using the standard normal cumulative distribution function (CDF), $\\Phi(z)$, as:\n$$P_{\\text{LNA}}(T) = \\Phi\\left(\\frac{0 - m(T)}{\\sqrt{v(T)}}\\right) = \\Phi\\left(-\\frac{m(T)}{\\sqrt{v(T)}}\\right)$$\nwhere $m(T)$ and $v(T)$ are the expressions derived above.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import ndtr\n\ndef solve():\n    \"\"\"\n    Solves for the discrepancy between CME and LNA extinction probabilities for a linear birth-death process.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (lambda, mu, n0, T)\n        (0.4, 0.6, 10, 2.0),\n        (0.95, 1.0, 50, 1.0),\n        (0.0, 1.0, 5, 0.2),\n        (0.2, 0.4, 20, 50.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        lmbda, mu, n0, T = case\n\n        # 1. CME Exact Extinction Probability\n        # For a subcritical process (mu > lmbda)\n        delta = mu - lmbda\n        \n        # Formula for the extinction probability of a single lineage\n        # p_ext_1 = (mu * (exp(delta*T) - 1)) / (mu * exp(delta*T) - lmbda)\n        exp_delta_T = np.exp(delta * T)\n        \n        # Handle the case where lambda is 0 separately to avoid 0/0\n        if lmbda == 0:\n            p_ext_1 = 1 - np.exp(-mu * T)\n        else:\n            p_ext_1 = (mu * (exp_delta_T - 1)) / (mu * exp_delta_T - lmbda)\n\n        # Total extinction probability for n0 independent lineages\n        p_cme = p_ext_1**n0\n\n        # 2. LNA Approximate Extinction Probability\n        # Mean m(T)\n        m_T = n0 * np.exp((lmbda - mu) * T)\n        \n        # Variance v(T)\n        # The term (lmbda-mu) is negative.\n        term1 = np.exp((lmbda - mu) * T)\n        term2 = np.exp(2 * (lmbda - mu) * T)\n        # The correct formula for variance is n0 * (lmbda+mu)/(mu-lmbda) * (exp((lmbda-mu)T) - exp(2*(lmbda-mu)T))\n        # Since lmbda-mu is negative, exp((lmbda-mu)T) > exp(2*(lmbda-mu)T), so the difference is positive.\n        if mu - lmbda > 1e-9: # Avoid division by zero if mu is very close to lambda\n            v_T = n0 * (lmbda + mu) / (mu - lmbda) * (term1 - term2)\n        else: # Case of mu=lambda, variance has a different form\n            v_T = 2 * lmbda * n0 * T\n        \n        # The LNA can produce zero or very small variance.\n        if v_T > 1e-12:\n            # Argument for the standard normal CDF\n            z = -m_T / np.sqrt(v_T)\n            # Gaussian CDF evaluated at 0 for a N(m_T, v_T) distribution\n            # This is equivalent to Phi(z) for a standard normal distribution\n            p_lna = ndtr(z)\n        else:\n            # If variance is zero, the distribution is a delta function at the mean.\n            # If mean is positive, extinction probability is 0. If non-positive, it is 1.\n            p_lna = 0.0 if m_T > 0 else 1.0\n            \n        # 3. Discrepancy calculation\n        discrepancy = abs(p_cme - p_lna)\n        results.append(discrepancy)\n\n    # Final print statement in the exact required format.\n    # Format results to a reasonable number of significant figures for consistent output.\n    formatted_results = [f\"{r:.12f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}