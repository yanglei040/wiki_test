{
    "hands_on_practices": [
        {
            "introduction": "在比较不同单细胞之间的基因表达时，首要步骤是校正测序深度等技术差异。通过细胞特异性的大小因子（size factors）进行归一化，可以使基因表达水平具有可比性，而对数倍数变化（log-fold change）则提供了一种对称且易于解释的差异表达度量。这项基础练习  是所有差异表达分析的基石，它确保了我们进行的比较在生物学上是有意义的。",
            "id": "3301307",
            "problem": "考虑在两个细胞中测量的单个基因的单细胞核糖核酸测序 (scRNA-seq) 计数，观测计数为 $x_1=50$ 和 $x_2=100$，相应的文库大小标准化因子为 $s_1=1.0$ 和 $s_2=2.5$。在一个标准的生成框架中，假设细胞 $j$ 的计数 $x_j$ 是一个分布的实现，该分布的均值通过一个乘性大小因子与细胞的文库大小成线性比例，具体为 $\\mathbb{E}[x_j]=s_j \\,\\mu$，其中 $\\mu$ 表示在考虑了文库大小后、在细胞间可比较的、计数尺度上的潜在基因特异性表达水平。在此框架下，标准化计数 $\\tilde{x}_j$ 定义为细胞 $j$ 每单位大小因子的计数，而细胞 2 和细胞 1 之间的表达倍数变化是在标准化尺度上定义的。对数倍数变化使用以 2 为底的对数来量化二元乘法尺度上的差异，这在单细胞的差异表达分析中是标准做法。\n\n根据这些原理，计算标准化计数 $\\tilde{x}_1$ 和 $\\tilde{x}_2$，然后计算倍数变化的以 2 为底的对数 $\\log_{2}\\!\\left(\\frac{\\tilde{x}_2}{\\tilde{x}_1}\\right)$。仅报告最终的对数倍数变化值作为答案。将最终答案四舍五入到六位有效数字。",
            "solution": "题目提供了在两个不同细胞中测量的单个基因的观测核糖核酸 (RNA) 计数和文库大小标准化因子。给定值为：\n- 细胞 1 的观测计数：$x_1 = 50$\n- 细胞 2 的观测计数：$x_2 = 100$\n- 细胞 1 的文库大小因子：$s_1 = 1.0$\n- 细胞 2 的文库大小因子：$s_2 = 2.5$\n\n细胞 $j$ 的标准化计数，记为 $\\tilde{x}_j$，被定义为“每单位大小因子的计数”。这可以转化为数学运算，即用观测计数 $x_j$ 除以相应的细胞特异性大小因子 $s_j$：\n$$ \\tilde{x}_j = \\frac{x_j}{s_j} $$\n这个标准化程序是单细胞转录组学中一个标准且必要的步骤。其目的是为了调整测序深度的技术性差异，从而使得在不同测序程度的细胞间的基因表达水平具有可比性。\n\n我们继续使用所提供的数据计算细胞 1 和细胞 2 的标准化计数。\n对于细胞 1，标准化计数 $\\tilde{x}_1$ 为：\n$$ \\tilde{x}_1 = \\frac{x_1}{s_1} = \\frac{50}{1.0} = 50 $$\n对于细胞 2，标准化计数 $\\tilde{x}_2$ 为：\n$$ \\tilde{x}_2 = \\frac{x_2}{s_2} = \\frac{100}{2.5} = 40 $$\n\n从细胞 1 到细胞 2 的表达倍数变化 (FC) 计算为它们标准化计数的比率。为了获得具有生物学意义的比较，关键是要使用标准化计数进行此计算，而不是原始计数。\n$$ \\text{FC} = \\frac{\\tilde{x}_2}{\\tilde{x}_1} = \\frac{40}{50} = 0.8 $$\n\n最终要计算的量是对数倍数变化 (LFC)，即倍数变化的以 2 为底的对数。在基因组学中，以 2 为底是常规做法，因为它提供了一个直观的尺度，其中 +1 或 -1 的变化分别对应于表达量的加倍或减半。\n$$ \\text{LFC} = \\log_{2}(\\text{FC}) = \\log_{2}\\left(\\frac{\\tilde{x}_2}{\\tilde{x}_1}\\right) = \\log_{2}(0.8) $$\nLFC 值为 0 表示没有变化，正 LFC 表示上调，负 LFC 表示下调。由于细胞 2 的标准化表达量 (40) 低于细胞 1 (50)，我们预期 LFC 为负值。\n\n为了求出数值，我们应用对数的换底公式 $\\log_{b}(a) = \\frac{\\ln(a)}{\\ln(b)}$：\n$$ \\log_{2}(0.8) = \\frac{\\ln(0.8)}{\\ln(2)} $$\n使用计算器计算自然对数的数值：\n$$ \\log_{2}(0.8) \\approx \\frac{-0.2231435513}{0.6931471806} \\approx -0.3219280949 $$\n题目要求最终答案四舍五入到六位有效数字。计算出的值为 $-0.3219280949\\ldots$。前六位有效数字是 $3, 2, 1, 9, 2, 8$。第七位数字是 $0$，小于 $5$，因此我们不对第六位有效数字进行进位。\n最终得到的对数倍数变化，四舍五入到六位有效数字后，是 $-0.321928$。",
            "answer": "$$\n\\boxed{-0.321928}\n$$"
        },
        {
            "introduction": "在掌握了细胞间的基本比较方法后，我们可以将其应用于一个更实际的目标：鉴定能够定义特定细胞类型的标记基因（marker genes）。“一对多”（one-vs-rest）策略通过将目标细胞群的表达与所有其他细胞的混合表达进行比较，为基因的特异性提供了一个稳健的衡量标准。本练习  演示了如何量化一个基因作为细胞类型标记的潜力，这是单细胞数据解读的核心任务。",
            "id": "3301298",
            "problem": "您正在分析一个单细胞RNA测序 (scRNA-seq) 数据集，以通过差异表达来发现三种细胞类型（标记为A、B和C）的标记基因。在使用跨细胞的均等大小因子进行归一化后，您计算了一个候选基因的分组归一化平均表达值：$ \\bar{x}_{\\text{A}} = 12 $，$ \\bar{x}_{\\text{B}} = 5 $ 和 $ \\bar{x}_{\\text{C}} = 4 $。假设每组的细胞数量相等，并且归一化均值是在相同的尺度上计算的，因此跨组比较是有效的。从倍数变化（fold-change）作为归一化平均表达值之比的核心定义出发，并使用以2为底的对数进行方差稳定的效应大小量化，推导A类型相对于汇集的非A组（B和C）的“一对多”（one-versus-rest）对数倍数变化。然后，基于标记基因发现的原则，论证其数值大小是否表明该基因相对于其余细胞类型具有A类型的特异性（在差异表达的意义上）。请以使用以2为底的对数的单个封闭形式表达式给出最终的“一对多”对数倍数变化。无需四舍五入，且不适用物理单位。",
            "solution": "本题的目标是计算细胞类型A相对于“其余”（rest）细胞类型（即B和C）的“一对多”对数倍数变化（LFC）。这是鉴定细胞类型特异性标记基因的常用方法。\n\n首先，我们需要计算“其余”组的平均表达水平，记为 $\\bar{x}_{\\text{rest}}$。该组由细胞类型B和C构成。根据题意，每种细胞类型的细胞数量相等。因此，“其余”组的平均表达是B和C组平均表达的算术平均值：\n$$\n\\bar{x}_{\\text{rest}} = \\frac{\\bar{x}_{\\text{B}} + \\bar{x}_{\\text{C}}}{2}\n$$\n将给定值代入：$\\bar{x}_{\\text{B}} = 5$ 和 $\\bar{x}_{\\text{C}} = 4$。\n$$\n\\bar{x}_{\\text{rest}} = \\frac{5 + 4}{2} = 4.5\n$$\n接下来，我们计算A类型与“其余”组之间的倍数变化（Fold Change, FC），即两者平均表达水平的比值：\n$$\n\\text{FC} = \\frac{\\bar{x}_{\\text{A}}}{\\bar{x}_{\\text{rest}}} = \\frac{12}{4.5} = \\frac{12}{9/2} = \\frac{24}{9} = \\frac{8}{3}\n$$\n最后，计算以2为底的对数倍数变化（LFC）：\n$$\n\\text{LFC}_{\\text{A vs. rest}} = \\log_{2}(\\text{FC}) = \\log_{2}\\left(\\frac{8}{3}\\right)\n$$\n这个正值表示，相比于其他细胞类型的平均水平，该基因在细胞类型A中是上调的。LFC的大小（约1.42）表明这是一个具有生物学意义的差异，使该基因成为细胞类型A的一个有潜力的标记基因。题目要求以封闭形式表达式给出最终答案。",
            "answer": "$$\n\\boxed{\\log_{2}\\left(\\frac{8}{3}\\right)}\n$$"
        },
        {
            "introduction": "在基因组学分析中，我们通常会同时对成千上万个基因进行假设检验，这极大地增加了出现假阳性的几率。Benjamini-Hochberg (BH) 程序通过校正 $p$ 值来控制错误发现率 (False Discovery Rate, FDR)，即在所有宣告的“发现”中假阳性所占的预期比例。掌握这一程序  对于从高通量实验中得出统计上可靠的结论、并将真实的生物信号与随机噪声区分开来至关重要。",
            "id": "3301279",
            "problem": "在一个单细胞核糖核酸测序 (scRNA-seq) 实验中，您对一个目标细胞簇的候选标记基因进行差异表达检验。该检验使用一个经过良好校准的基因水平检验，其在真零假设下的 $p$ 值服从独立同分布的 $\\mathrm{Uniform}(0,1)$ 分布。错误发现率 (FDR) 的概念定义为所有拒绝中错误拒绝的预期比例，即 $\\mathrm{FDR} = \\mathbb{E}\\!\\left[\\frac{V}{\\max(R,1)}\\right]$，其中 $V$ 是错误拒绝的数量，$R$ 是总拒绝数。在独立性或子集正回归依赖 (PRDS) 的条件下，Benjamini–Hochberg (BH) 升阶程序已知可以将 FDR 控制在目标水平 $q$。\n\n您已经获得了目标细胞簇中五个基因相对于所有其他细胞的 $p$ 值：$\\{0.001, 0.02, 0.03, 0.2, 0.6\\}$。假设独立性或 PRDS 条件成立。从 $p$ 值的基本定义和 FDR 控制目标出发，并且仅使用标准的 BH 升阶决策规则（不假设任何关于校正 $p$ 值的快捷公式），推导出原始基因顺序下的 BH 校正 $p$ 值，并确定在目标 FDR 水平 $q = 0.1$ 时哪些基因是发现。\n\n请以单个行向量的形式提供您的最终答案，按顺序包含：原始基因顺序下的五个 BH 校正 $p$ 值，随后是原始基因顺序下的五个二进制指示符（其中 $1$ 表示发现，$0$ 表示非发现）。无需四舍五入。",
            "solution": "本题要求我们对一组给定的 $p$ 值应用Benjamini-Hochberg (BH) 程序，计算其校正 $p$ 值（也称为 $q$ 值），并根据给定的错误发现率（FDR）阈值 $q=0.1$ 来确定哪些基因是显著的“发现”。\n设原始 $p$ 值向量为 $P = \\{0.001, 0.02, 0.03, 0.2, 0.6\\}$。检验的总数为 $m=5$。\n\n1.  **对 $p$ 值排序**：BH程序的第一步是将 $p$ 值从小到大排序。设排序后的 $p$ 值为 $P_{(i)}$。在本例中，原始 $p$ 值已经是有序的：\n$P_{(1)} = 0.001, P_{(2)} = 0.02, P_{(3)} = 0.03, P_{(4)} = 0.2, P_{(5)} = 0.6$。\n\n2.  **计算BH校正 $p$ 值**：校正 $p$ 值 $p_{\\text{adj},(i)}$ 可以通过从最大秩的 $p$ 值开始，向下迭代计算，以保证单调性：\n-   $p_{\\text{adj},(i)} = \\min\\left(p_{\\text{adj},(i+1)}, \\frac{m \\cdot P_{(i)}}{i}\\right)$，其中 $p_{\\text{adj},(m)} = P_{(m)}$。\n-   对于 $i=5$：$p_{\\text{adj},(5)} = P_{(5)} = 0.6$。\n-   对于 $i=4$：$p_{\\text{adj},(4)} = \\min(p_{\\text{adj},(5)}, \\frac{5 \\cdot P_{(4)}}{4}) = \\min(0.6, \\frac{5 \\cdot 0.2}{4}) = \\min(0.6, 0.25) = 0.25$。\n-   对于 $i=3$：$p_{\\text{adj},(3)} = \\min(p_{\\text{adj},(4)}, \\frac{5 \\cdot P_{(3)}}{3}) = \\min(0.25, \\frac{5 \\cdot 0.03}{3}) = \\min(0.25, 0.05) = 0.05$。\n-   对于 $i=2$：$p_{\\text{adj},(2)} = \\min(p_{\\text{adj},(3)}, \\frac{5 \\cdot P_{(2)}}{2}) = \\min(0.05, \\frac{5 \\cdot 0.02}{2}) = \\min(0.05, 0.05) = 0.05$。\n-   对于 $i=1$：$p_{\\text{adj},(1)} = \\min(p_{\\text{adj},(2)}, \\frac{5 \\cdot P_{(1)}}{1}) = \\min(0.05, \\frac{5 \\cdot 0.001}{1}) = \\min(0.05, 0.005) = 0.005$。\n\n由于原始 $p$ 值已经排序，因此按原始基因顺序排列的校正 $p$ 值向量为 $\\{0.005, 0.05, 0.05, 0.25, 0.6\\}$。\n\n3.  **确定发现**：在FDR阈值 $q=0.1$下，如果一个基因的校正 $p$ 值 $p_{\\text{adj}} \\le q$，则该基因被视为一个“发现”（用1表示），否则不是（用0表示）。\n-   基因 1: $0.005 \\le 0.1 \\implies 1$ (发现)\n-   基因 2: $0.05 \\le 0.1 \\implies 1$ (发现)\n-   基因 3: $0.05 \\le 0.1 \\implies 1$ (发现)\n-   基因 4: $0.25 > 0.1 \\implies 0$ (非发现)\n-   基因 5: $0.6 > 0.1 \\implies 0$ (非发现)\n\n将校正 $p$ 值和发现指示符按原始顺序组合成一个行向量，得到最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.005  0.05  0.05  0.25  0.6  1  1  1  0  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}