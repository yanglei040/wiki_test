{
    "hands_on_practices": [
        {
            "introduction": "This first practice guides you through the core two-step optimization of parsimonious FBA. By working with a simple, analytically solvable network, you will gain a concrete understanding of how pFBA first maximizes a biological objective and then minimizes total flux to find a resource-efficient solution. This exercise  builds foundational intuition for the pFBA algorithm before we explore its deeper justifications.",
            "id": "3336992",
            "problem": "You are given a steady-state metabolic network described by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ and a reaction flux vector $v \\in \\mathbb{R}^{n}$. At steady state, the mass balance requires $S v = 0$. Flux Balance Analysis (FBA) defines linear flux bounds $l_i \\le v_i \\le u_i$ for each reaction $i$ and selects a primary objective to optimize, often representing growth or product formation. Parsimonious Flux Balance Analysis (pFBA) is a hierarchical optimization: first maximize the primary objective to its optimal value, then among all flux vectors achieving that optimum, minimize the total flux $\\sum_{i=1}^{n} |v_i|$ as a proxy for minimal enzyme usage and resource allocation.\n\nFundamental base assumptions:\n- Steady-state mass conservation: $S v = 0$.\n- Linear feasibility constraints: $l_i \\le v_i \\le u_i$ for each $i$.\n- Hierarchical objectives: first maximize a single flux $v_k$; second, given the optimal value $v_k^\\star$, minimize $\\sum_i v_i$ subject to $S v = 0$, $l_i \\le v_i \\le u_i$, and $v_k = v_k^\\star$.\n\nConsider the toy network with $S = \\begin{bmatrix} -1  1  0 \\\\ 0  -1  1 \\end{bmatrix}$ and three fluxes $v_1, v_2, v_3$. The primary objective is to maximize $v_3$. All quantities are dimensionless and should be output as real numbers without physical units.\n\nYour task is to implement the hierarchical pFBA optimization for the following test suite. For each test case, compute the pFBA solution vector $v = [v_1, v_2, v_3]$:\n1. Baseline case: bounds $0 \\le v_1 \\le 10$, $0 \\le v_2 \\le 100$, $0 \\le v_3 \\le 100$.\n2. Objective-limited case: bounds $0 \\le v_1 \\le 10$, $0 \\le v_2 \\le 100$, $0 \\le v_3 \\le 5$.\n3. Internal bottleneck case: bounds $0 \\le v_1 \\le 10$, $0 \\le v_2 \\le 4$, $0 \\le v_3 \\le 100$.\n4. Null case: bounds $0 \\le v_1 \\le 0$, $0 \\le v_2 \\le 0$, $0 \\le v_3 \\le 0$.\n5. Nonzero lower bound case: bounds $2 \\le v_1 \\le 10$, $0 \\le v_2 \\le 100$, $0 \\le v_3 \\le 100$.\n\nFor each case, perform:\n- Stage 1: maximize $v_3$ subject to $S v = 0$ and the bounds.\n- Stage 2: minimize $v_1 + v_2 + v_3$ subject to $S v = 0$, the bounds, and $v_3 = v_3^\\star$ where $v_3^\\star$ is the optimal value from Stage 1.\n\nYour program should produce a single line of output containing the pFBA flux vectors for all test cases as a comma-separated list enclosed in square brackets. Each flux component must be a real number rounded to three decimal places. For example, the output format should be like $[[a_{11},a_{12},a_{13}],[a_{21},a_{22},a_{23}],...]$ where $a_{ij}$ denotes the $j$-th flux of the $i$-th test case, rounded to three decimal places.",
            "solution": "The problem requires the calculation of the parsimonious Flux Balance Analysis (pFBA) solution for a simple metabolic network under five different sets of flux bounds. The pFBA methodology is a two-stage optimization process. First, a primary biological objective is maximized. Second, among all possible flux distributions that achieve this maximum objective value, a secondary objective, typically the minimization of total flux, is optimized.\n\nThe network is described by the stoichiometric matrix $S \\in \\mathbb{R}^{2 \\times 3}$ and a flux vector $v \\in \\mathbb{R}^{3}$:\n$$ S = \\begin{bmatrix} -1  1  0 \\\\ 0  -1  1 \\end{bmatrix}, \\quad v = \\begin{bmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{bmatrix} $$\nThe fundamental constraints on the system are the steady-state mass balance condition, $S v = 0$, and the reaction flux bounds, $l_i \\le v_i \\le u_i$ for each reaction $i \\in \\{1, 2, 3\\}$.\n\n**Step 1: Analysis of the Steady-State Constraint**\nThe steady-state condition $S v = 0$ is a system of linear equations that defines the feasible flux space. For the given matrix $S$, this expands to:\n$$ \\begin{bmatrix} -1  1  0 \\\\ 0  -1  1 \\end{bmatrix} \\begin{bmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{bmatrix} = \\begin{bmatrix} -v_1 + v_2 \\\\ -v_2 + v_3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} $$\nThis system yields two equations:\n1. $-v_1 + v_2 = 0 \\implies v_1 = v_2$\n2. $-v_2 + v_3 = 0 \\implies v_2 = v_3$\n\nFrom these equations, we deduce that any steady-state flux vector must satisfy $v_1 = v_2 = v_3$. This implies that the null space of $S$ is one-dimensional, and any feasible flux vector $v$ must be of the form $v = [k, k, k]^T$ for some scalar value $k$. This significantly simplifies the optimization problem, as we only need to determine the feasible range for $k$.\n\n**Step 2: Defining the Feasible Space for the System**\nThe scalar flux value $k$ must satisfy the bounds for all three reactions simultaneously:\n$$ l_1 \\le v_1 \\le u_1 \\implies l_1 \\le k \\le u_1 $$\n$$ l_2 \\le v_2 \\le u_2 \\implies l_2 \\le k \\le u_2 $$\n$$ l_3 \\le v_3 \\le u_3 \\implies l_3 \\le k \\le u_3 $$\nFor $k$ to be a valid flux, it must lie within the intersection of these three intervals. This leads to a single composite interval for $k$:\n$$ \\max(l_1, l_2, l_3) \\le k \\le \\min(u_1, u_2, u_3) $$\nLet's define $L_{max} = \\max(l_1, l_2, l_3)$ and $U_{min} = \\min(u_1, u_2, u_3)$. The feasible set for $k$ is the interval $[L_{max}, U_{min}]$. A feasible solution exists if and only if $L_{max} \\le U_{min}$, which is true for all given test cases.\n\n**Step 3: Stage 1 Optimization (Maximization of Primary Objective)**\nThe primary objective is to maximize the flux $v_3$. Since $v_3 = k$, this is equivalent to finding the maximum value of $k$ within its feasible range $[L_{max}, U_{min}]$.\n$$ \\max_{k} k \\quad \\text{subject to} \\quad k \\in [L_{max}, U_{min}] $$\nThe solution to this maximization is trivially the upper bound of the interval. The optimal value for $v_3$ is:\n$$ v_3^{\\star} = U_{min} = \\min(u_1, u_2, u_3) $$\n\n**Step 4: Stage 2 Optimization (Minimization of Total Flux)**\nThe second stage of pFBA is to find the flux distribution that minimizes the total flux, $\\sum_{i=1}^{3} v_i$, subject to the original constraints and the additional constraint that the primary objective must equal its optimal value found in Stage 1, i.e., $v_3 = v_3^{\\star}$.\nThe objective function is $\\sum v_i = v_1 + v_2 + v_3 = k + k + k = 3k$. So we must minimize $3k$.\nThe constraints for this stage are:\n1. $k \\in [L_{max}, U_{min}]$ (from original bounds and steady-state)\n2. $v_3 = v_3^{\\star}$, which implies $k = U_{min}$ (from Stage 1)\n\nThe feasible set for $k$ in Stage 2 is reduced to the single point $\\{U_{min}\\}$. The optimization problem becomes:\n$$ \\min_{k} 3k \\quad \\text{subject to} \\quad k = U_{min} $$\nThe unique solution is $k_{pFBA} = U_{min}$. Because the set of flux distributions that maximize the primary objective consists of a single vector, $[U_{min}, U_{min}, U_{min}]^T$, the secondary optimization step must select this same vector.\n\n**Step 5: Application to Test Cases**\nThe derived analytical solution, $v_{pFBA} = [k, k, k]^T$ where $k = \\min(u_1, u_2, u_3)$, can be applied to each test case.\n\n1.  **Baseline case:** Bounds are $l=[0, 0, 0]$ and $u=[10, 100, 100]$.\n    $k = \\min(10, 100, 100) = 10$.\n    Solution vector: $[10.0, 10.0, 10.0]$.\n\n2.  **Objective-limited case:** Bounds are $l=[0, 0, 0]$ and $u=[10, 100, 5]$.\n    $k = \\min(10, 100, 5) = 5$.\n    Solution vector: $[5.0, 5.0, 5.0]$.\n\n3.  **Internal bottleneck case:** Bounds are $l=[0, 0, 0]$ and $u=[10, 4, 100]$.\n    $k = \\min(10, 4, 100) = 4$.\n    Solution vector: $[4.0, 4.0, 4.0]$.\n\n4.  **Null case:** Bounds are $l=[0, 0, 0]$ and $u=[0, 0, 0]$.\n    $k = \\min(0, 0, 0) = 0$.\n    Solution vector: $[0.0, 0.0, 0.0]$.\n\n5.  **Nonzero lower bound case:** Bounds are $l=[2, 0, 0]$ and $u=[10, 100, 100]$.\n    $L_{max} = \\max(2, 0, 0) = 2$.\n    $U_{min} = \\min(10, 100, 100) = 10$.\n    The feasible range for $k$ is $[2, 10]$. Since $L_{max} \\le U_{min}$, the problem is feasible. The pFBA solution for $k$ is still determined by $U_{min}$.\n    $k = 10$.\n    Solution vector: $[10.0, 10.0, 10.0]$.\n\nThe implementation will calculate these values and format them as requested.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the parsimonious Flux Balance Analysis (pFBA) solution for a toy\n    metabolic network under several different bounding conditions.\n    \"\"\"\n    \n    # Test cases are defined as tuples of (lower_bounds, upper_bounds)\n    test_cases = [\n        # Case 1: Baseline\n        ([0, 0, 0], [10, 100, 100]),\n        # Case 2: Objective-limited\n        ([0, 0, 0], [10, 100, 5]),\n        # Case 3: Internal bottleneck\n        ([0, 0, 0], [10, 4, 100]),\n        # Case 4: Null case\n        ([0, 0, 0], [0, 0, 0]),\n        # Case 5: Nonzero lower bound\n        ([2, 0, 0], [10, 100, 100]),\n    ]\n\n    results_vectors = []\n    \n    # The stoichiometric matrix S = [[-1, 1, 0], [0, -1, 1]] imposes the\n    # steady-state constraint Sv = 0, which simplifies to v1 = v2 = v3.\n    # Let's call this common flux value 'k'.\n    # The pFBA procedure for this simple network was solved analytically.\n    # Stage 1 (maximize v3 = k) yields k_opt = min(u1, u2, u3).\n    # Stage 2 (minimize v1+v2+v3=3k subject to k=k_opt) confirms the solution k = k_opt.\n    # Thus, the pFBA solution vector is [k_opt, k_opt, k_opt].\n    # We must also ensure feasibility, i.e., max(l_bounds) = min(u_bounds).\n    # All provided test cases are feasible.\n\n    for l_bounds, u_bounds in test_cases:\n        # Calculate the common flux value 'k' for the pFBA solution\n        k = np.min(u_bounds)\n        \n        # The pFBA flux vector is [k, k, k]\n        pfba_vector = [k, k, k]\n        results_vectors.append(pfba_vector)\n\n    # Format results according to the problem specification:\n    # [[a11,a12,a13],[a21,a22,a23],...] with numbers rounded to three decimal places.\n    formatted_results = []\n    for vec in results_vectors:\n        # Format each component of the vector to three decimal places\n        formatted_vec = [f\"{x:.3f}\" for x in vec]\n        # Join components with a comma and enclose in brackets\n        formatted_results.append(f\"[{','.join(formatted_vec)}]\")\n    \n    # Join all formatted vectors with a comma and enclose in brackets\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Why is minimizing total flux a reasonable secondary objective? This exercise explores the connection between pFBA and the principle of efficient resource allocation. You will construct a scenario where standard, unweighted pFBA makes a biologically questionable choice and then demonstrate how a weighted pFBA, incorporating enzyme catalytic efficiencies ($k_{\\text{cat}}$ values), can correct this and select a more plausible metabolic strategy . This highlights the bio-physical justification for parsimony and introduces a more refined, resource-aware modeling approach.",
            "id": "3337066",
            "problem": "Consider a minimal metabolic network with four internal metabolites and six irreversible reactions. The metabolites are substrate $S$, intermediates $A$ and $B$, and biomass precursor $X$. The reactions are:\n1. Uptake $\\text{R}_0$: $S_{\\text{ext}} \\rightarrow S$ with flux $v_0 \\ge 0$ and an upper bound chosen sufficiently large to not be limiting.\n2. Direct conversion $\\text{R}_1$: $S \\rightarrow X$ with flux $v_1 \\ge 0$.\n3. Step $\\text{R}_2$: $S \\rightarrow A$ with flux $v_2 \\ge 0$.\n4. Step $\\text{R}_3$: $A \\rightarrow B$ with flux $v_3 \\ge 0$.\n5. Step $\\text{R}_4$: $B \\rightarrow X$ with flux $v_4 \\ge 0$.\n6. Biomass drain $\\text{R}_X$: $X \\rightarrow \\emptyset$ with flux $v_X \\ge 0$.\n\nAssume steady state and apply the flux balance constraints derived from conservation of mass for internal metabolites. Using the stoichiometric matrix $S$ that encodes the balances\n$$\n\\begin{aligned}\nS\\text{-row:}\\quad +v_0 - v_1 - v_2 = 0,\\\\\nA\\text{-row:}\\quad +v_2 - v_3 = 0,\\\\\nB\\text{-row:}\\quad +v_3 - v_4 = 0,\\\\\nX\\text{-row:}\\quad +v_1 + v_4 - v_X = 0,\n\\end{aligned}\n$$\nfix the biomass drain to $v_X = 1$ (units of amount per second), and require $v_i \\ge 0$ for all reactions $i \\in \\{0,1,2,3,4,X\\}$. All reactions are irreversible in the forward direction. The uptake bound for $v_0$ should be set to a value strictly greater than $1$ so that uptake is not rate-limiting under these constraints.\n\nThis network has two alternative routes to satisfy $v_X=1$: a single-reaction route via $\\text{R}_1$, and a three-reaction route via $\\text{R}_2, \\text{R}_3, \\text{R}_4$. In Parsimonious Flux Balance Analysis (pFBA), one minimizes the total flux magnitude to obtain a sparse flux distribution. In the unweighted form, one minimizes $\\min \\sum_i |v_i|$. In a resource-allocation-aware variant, one assigns weights $w_i$ and minimizes $\\min \\sum_i w_i |v_i|$, where weights are derived from enzyme catalytic constants $k_{\\text{cat},i}$ in reciprocal form $w_i = 1/k_{\\text{cat},i}$ for enzyme-catalyzed reactions. Uptake $\\text{R}_0$ and the biomass drain $\\text{R}_X$ are treated as non-enzyme steps and assigned $w_0 = 0$ and $w_X = 0$.\n\nYour tasks are:\n- Construct and solve the unweighted pFBA for the network above subject to the given constraints.\n- Construct and solve the weighted pFBA with weights $w_i = 1/k_{\\text{cat},i}$ for $i \\in \\{1,2,3,4\\}$, and $w_0 = w_X = 0$.\n- Demonstrate a counterexample where unweighted pFBA prefers the low-catalytic-constant route via $\\text{R}_1$ (because it uses fewer reactions), while the weighted pFBA with $w_i = 1/k_{\\text{cat},i}$ prefers the multi-step route via $\\text{R}_2, \\text{R}_3, \\text{R}_4$ due to higher catalytic efficiency. Decide the preferred route for each optimization by comparing the magnitudes of $v_1$ and $v_4$ and choosing the route with the larger flux to $X$.\n\nFormulate each optimization as a linear program:\n$$\n\\min_{v \\ge 0} \\sum_i w_i v_i \\quad \\text{subject to} \\quad S v = 0,\\quad v_X = 1,\n$$\nwhere $S$ encodes the stoichiometric equalities given above. For the unweighted case, set $w_i = 1$ for all $i$. For the weighted case, set $w_0 = 0$, $w_X = 0$, and $w_i = 1/k_{\\text{cat},i}$ for $i \\in \\{1,2,3,4\\}$.\n\nUse the following test suite of catalytic constants $k_{\\text{cat},i}$, expressed in $\\text{s}^{-1}$:\n- Test 1 (counterexample target): $k_{\\text{cat},1} = 1$, $k_{\\text{cat},2} = 100$, $k_{\\text{cat},3} = 100$, $k_{\\text{cat},4} = 100$. This case should exhibit a switch under weighted pFBA.\n- Test 2 (no switch, direct route remains preferable): $k_{\\text{cat},1} = 40$, $k_{\\text{cat},2} = 100$, $k_{\\text{cat},3} = 100$, $k_{\\text{cat},4} = 100$.\n- Test 3 (all equal catalysis): $k_{\\text{cat},1} = 100$, $k_{\\text{cat},2} = 100$, $k_{\\text{cat},3} = 100$, $k_{\\text{cat},4} = 100$.\n\nFor all tests, set an uptake bound of $v_0 \\le 10$ and keep $v_X = 1$ fixed. Decide the preferred route for each optimization as follows: if $v_1 \\ge v_4$ choose the direct route, otherwise choose the multi-step route.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a boolean indicating whether, for the corresponding test case, the weighted pFBA changes the preferred route compared to the unweighted pFBA and, in doing so, prefers the higher-$k_{\\text{cat}}$ multi-step route. The output is unitless booleans. For example, an output of the form $[b_1,b_2,b_3]$ where each $b_j$ is either True or False is required.",
            "solution": "The problem requires us to analyze a small metabolic network using two variants of Parsimonious Flux Balance Analysis (pFBA): an unweighted version that minimizes the sum of all reaction fluxes, and a weighted version that minimizes an enzyme-cost-related objective function. We must determine for three test cases whether the weighted pFBA prefers a different, more catalytically efficient, pathway compared to the unweighted pFBA.\n\nFirst, we formalize the problem as a Linear Program (LP). The variables are the fluxes of the six reactions, represented by the vector $v = [v_0, v_1, v_2, v_3, v_4, v_X]^T$. All fluxes are irreversible, so we have the non-negativity constraint $v_i \\ge 0$ for all $i$.\n\nThe steady-state mass balance equations form a set of linear equality constraints, $S v = 0$, where $S$ is the stoichiometric matrix. Based on the provided equations, $S$ is a $4 \\times 6$ matrix:\n$$\nS = \\begin{pmatrix}\n1  -1  -1  0  0  0 \\\\\n0  0  1  -1  0  0 \\\\\n0  0  0  1  -1  0 \\\\\n0  1  0  0  1  -1\n\\end{pmatrix}\n$$\nThe right-hand side of this system is a zero vector, $b_{eq} = [0, 0, 0, 0]^T$.\n\nAdditional constraints are given as bounds on individual fluxes:\n1.  Biomass drain is fixed: $v_X = 1$.\n2.  Substrate uptake is non-limiting: $0 \\le v_0 \\le 10$.\n3.  All other fluxes are non-negative: $v_i \\ge 0$ for $i \\in \\{1, 2, 3, 4\\}$.\n\nFrom the stoichiometric constraints, we can deduce key relationships between the fluxes.\nThe second and third rows of $S v = 0$ imply $v_2 - v_3 = 0$ and $v_3 - v_4 = 0$, which simplifies to $v_2 = v_3 = v_4$. This means the flux through the multi-step pathway ($\\text{R}_2, \\text{R}_3, \\text{R}_4$) is uniform.\nThe fourth row, combined with the constraint $v_X = 1$, gives $v_1 + v_4 = v_X = 1$. This equation is central, as it shows that the production of the biomass precursor $X$ is partitioned between the direct route (flux $v_1$) and the multi-step route (flux $v_4$).\nThe first row gives $v_0 = v_1 + v_2$. Substituting $v_2 = v_4$ and $v_1 + v_4 = 1$, we find $v_0 = v_1 + v_4 = 1$. The total substrate uptake is fixed at $1$, which respects the upper bound $v_0 \\le 10$.\n\nThe system has a single degree of freedom, which can be represented by the fraction of flux going through the direct route $\\text{R}_1$. Let us define $\\alpha = v_1$, where $\\alpha \\in [0, 1]$ due to the non-negativity of fluxes and the constraint $v_1+v_4=1$. Then, the entire flux vector $v$ can be expressed in terms of $\\alpha$:\n$v_1 = \\alpha$\n$v_4 = 1 - \\alpha$\n$v_2 = v_3 = v_4 = 1 - \\alpha$\n$v_X = 1$\n$v_0 = 1$\nSo, the flux vector is $v(\\alpha) = [1, \\alpha, 1-\\alpha, 1-\\alpha, 1-\\alpha, 1]^T$. The optimization problem reduces to finding the $\\alpha \\in [0, 1]$ that minimizes the respective objective function.\n\nThe objective is to minimize a linear combination of fluxes, $\\min \\sum_i w_i v_i$.\n\nFor unweighted pFBA, the weights are $w_i = 1$ for all $i$. The objective function $F_{unw}$ is the sum of all fluxes:\n$$F_{unw}(\\alpha) = \\sum_{i} v_i(\\alpha) = v_0 + v_1 + v_2 + v_3 + v_4 + v_X$$\n$$F_{unw}(\\alpha) = 1 + \\alpha + (1-\\alpha) + (1-\\alpha) + (1-\\alpha) + 1 = 1 + \\alpha + 3(1-\\alpha) + 1 = 5 - 2\\alpha$$\nTo minimize $F_{unw}(\\alpha)$, we must maximize $\\alpha$. The maximum value is $\\alpha = 1$. This corresponds to a flux distribution where $v_1 = 1$ and $v_4 = 0$. According to the decision criterion ($v_1 \\ge v_4$), the unweighted pFBA always chooses the direct route. This is expected, as this route involves fewer reactions and thus a lower total flux ($1+1+0+0+0+1 = 3$) compared to any other flux split.\n\nFor weighted pFBA, the weights are $w_0 = 0$, $w_X = 0$, and $w_i = 1/k_{\\text{cat},i}$ for the enzymatic reactions $i \\in \\{1, 2, 3, 4\\}$. The objective function $F_w$ is:\n$$F_w(\\alpha) = \\sum_{i} w_i v_i(\\alpha) = w_0 v_0 + w_1 v_1 + w_2 v_2 + w_3 v_3 + w_4 v_4 + w_X v_X$$\n$$F_w(\\alpha) = 0 \\cdot 1 + w_1 \\alpha + w_2 (1-\\alpha) + w_3 (1-\\alpha) + w_4 (1-\\alpha) + 0 \\cdot 1$$\n$$F_w(\\alpha) = w_1 \\alpha + (w_2 + w_3 + w_4)(1-\\alpha)$$\nRearranging this linear function of $\\alpha$:\n$$F_w(\\alpha) = (w_1 - (w_2 + w_3 + w_4))\\alpha + (w_2 + w_3 + w_4)$$\nThe minimum of this function over $\\alpha \\in [0, 1]$ depends on the sign of the coefficient of $\\alpha$.\n- If $w_1 - (w_2 + w_3 + w_4)  0$, the minimum occurs at $\\alpha = 0$. This means $v_1 = 0, v_4 = 1$, and the multi-step route is preferred.\n- If $w_1 - (w_2 + w_3 + w_4)  0$, the minimum occurs at $\\alpha = 1$. This means $v_1 = 1, v_4 = 0$, and the direct route is preferred.\n- If $w_1 - (w_2 + w_3 + w_4) = 0$, any $\\alpha \\in [0, 1]$ is an optimal solution.\n\nA switch from the direct route (unweighted case) to the multi-step route (weighted case) occurs if and only if $w_1  w_2 + w_3 + w_4$. Recalling that $w_i = 1/k_{\\text{cat},i}$, this condition is equivalent to:\n$$ \\frac{1}{k_{\\text{cat},1}}  \\frac{1}{k_{\\text{cat},2}} + \\frac{1}{k_{\\text{cat},3}} + \\frac{1}{k_{\\text{cat},4}} $$\nThis inequality means that the enzyme \"cost\" of the direct route is greater than the sum of the enzyme costs for the multi-step route, thus making the latter more efficient from a resource allocation perspective.\n\nWe now apply this condition to the given test cases.\n\nTest 1: $k_{\\text{cat}} = (1, 100, 100, 100)$.\n- $w_1 = 1/1 = 1$.\n- $w_2 = 1/100 = 0.01$, $w_3 = 1/100 = 0.01$, $w_4 = 1/100 = 0.01$.\n- Condition: Is $1  0.01 + 0.01 + 0.01$? Yes, $1  0.03$.\n- A switch occurs. The multi-step route is preferred in the weighted case. The enzymes of this route ($k_{\\text{cat}}=100$) are more efficient than the direct route's enzyme ($k_{\\text{cat}}=1$). The result is `True`.\n\nTest 2: $k_{\\text{cat}} = (40, 100, 100, 100)$.\n- $w_1 = 1/40 = 0.025$.\n- $w_2 = w_3 = w_4 = 0.01$.\n- Condition: Is $0.025  0.01 + 0.01 + 0.01$? No, $0.025 \\ngtr 0.03$.\n- No switch occurs. The direct route remains preferred. The result is `False`.\n\nTest 3: $k_{\\text{cat}} = (100, 100, 100, 100)$.\n- $w_1 = 1/100 = 0.01$.\n- $w_2 = w_3 = w_4 = 0.01$.\n- Condition: Is $0.01  0.01 + 0.01 + 0.01$? No, $0.01 \\ngtr 0.03$.\n- No switch occurs. The direct route remains preferred. The result is `False`.\n\nThe final outcome is a list of booleans: `[True, False, False]`. The provided code will implement this logic using a standard LP solver to verify the analytical derivation.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the pFBA problem for the given metabolic network and test cases.\n    \"\"\"\n\n    # Define the test suite of catalytic constants\n    test_cases = [\n        # (k_cat1, k_cat2, k_cat3, k_cat4)\n        (1.0, 100.0, 100.0, 100.0),  # Test 1: Should switch\n        (40.0, 100.0, 100.0, 100.0), # Test 2: Should not switch\n        (100.0, 100.0, 100.0, 100.0) # Test 3: Should not switch\n    ]\n\n    # Flux vector v = [v0, v1, v2, v3, v4, vX]^T\n    # Stoichiometric matrix S for Sv = 0\n    # Rows correspond to metabolites S, A, B, X\n    A_eq = np.array([\n        [1, -1, -1,  0,  0,  0],  # S balance: v0 - v1 - v2 = 0\n        [0,  0,  1, -1,  0,  0],  # A balance: v2 - v3 = 0\n        [0,  0,  0,  1, -1,  0],  # B balance: v3 - v4 = 0\n        [0,  1,  0,  0,  1, -1]   # X balance: v1 + v4 - vX = 0\n    ])\n\n    # Right-hand side for the equality constraints\n    b_eq = np.zeros(4)\n\n    # Bounds for the fluxes [v0, v1, v2, v3, v4, vX]\n    # v0 = 10, vX = 1, all others = 0\n    bounds = [\n        (0, 10.0),  # v0\n        (0, None),  # v1\n        (0, None),  # v2\n        (0, None),  # v3\n        (0, None),  # v4\n        (1.0, 1.0)  # vX\n    ]\n\n    # Objective function for unweighted pFBA: min sum(v_i)\n    c_unweighted = np.ones(6)\n\n    def get_preferred_route(flux_vector):\n        \"\"\"\n        Determines the preferred route based on v1 and v4 fluxes.\n        A small tolerance is used for floating point comparison.\n        \"\"\"\n        v1 = flux_vector[1]\n        v4 = flux_vector[4]\n        # Direct route is chosen if v1 = v4\n        return 'direct' if v1 = v4 - 1e-9 else 'multi-step'\n\n    results = []\n    for k_cats in test_cases:\n        k1, k2, k3, k4 = k_cats\n\n        # 1. Unweighted pFBA\n        res_unw = linprog(c=c_unweighted, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        if not res_unw.success:\n            raise RuntimeError(f\"Unweighted LP solver failed for case {k_cats}\")\n        route_unw = get_preferred_route(res_unw.x)\n\n        # 2. Weighted pFBA\n        # Weights w_i = 1/k_cat_i for i=1,2,3,4 and w_0=w_X=0\n        weights = [0.0, 1.0/k1, 1.0/k2, 1.0/k3, 1.0/k4, 0.0]\n        c_weighted = np.array(weights)\n        \n        res_w = linprog(c=c_weighted, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        if not res_w.success:\n            raise RuntimeError(f\"Weighted LP solver failed for case {k_cats}\")\n        route_w = get_preferred_route(res_w.x)\n\n        # 3. Compare routes\n        # Unweighted should always be 'direct' as analyzed.\n        # A switch means unweighted is 'direct' and weighted is 'multi-step'.\n        # The problem statement also implies checking that the multi-step route is 'higher-kcat'.\n        # In Test 1, k_cat for multi-step (100)  k_cat for direct (1), so this holds.\n        # The condition of switching to the multi-step implies it must be more efficient overall.\n        is_switch = (route_unw == 'direct' and route_w == 'multi-step')\n        results.append(is_switch)\n\n    # Format the final output string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A major challenge in standard FBA is the existence of 'alternate optima'â€”multiple different flux patterns that yield the same maximal objective. This practice delves into the computational properties of pFBA that make it so useful for resolving this ambiguity. You will write code to identify degeneracy in FBA solutions and then verify that pFBA selects a unique, sparse solution corresponding to an extreme point of the feasible space, effectively removing uninformative flux loops and clarifying pathway usage .",
            "id": "3336975",
            "problem": "You are given the steady-state metabolic modeling framework grounded in mass conservation and linear programming. The fundamental base is the stoichiometric steady-state assumption and reaction bounds: steady state requires that the net production rate of each intracellular metabolite is zero, enforced by the linear constraints $\\mathbf{S}\\mathbf{v} = \\mathbf{0}$, where $\\mathbf{S} \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix with $m$ metabolites and $n$ reactions, and $\\mathbf{v} \\in \\mathbb{R}^{n}$ is the flux vector. Reaction bounds satisfy $\\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}$, with lower bounds $\\mathbf{l}$ and upper bounds $\\mathbf{u}$. Flux Balance Analysis (FBA) maximizes a linear objective $z = \\mathbf{c}^{\\top}\\mathbf{v}$ subject to these constraints. Parsimonious Flux Balance Analysis (pFBA) resolves degeneracy among FBA-optimal flux vectors by minimizing a proxy of enzymatic resource usage, modeled as the $\\ell_1$-norm $\\sum_{i=1}^{n} |v_i|$, subject to achieving the same optimal objective value.\n\nYour task is to write a complete program that, for each test case, performs the following:\n\n1. Solve the FBA problem by maximizing $z = \\mathbf{c}^{\\top}\\mathbf{v}$ subject to $\\mathbf{S}\\mathbf{v} = \\mathbf{0}$ and $\\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}$.\n2. Identify degeneracy at the FBA optimum via nullspace analysis of the active constraints. Form the active constraint matrix $\\mathbf{A}_{\\text{act}}$ as follows:\n   - Include all rows of $\\mathbf{S}$ (these are equality constraints and always active).\n   - Include for each reaction $i$ the standard basis row $\\mathbf{e}_i^{\\top}$ whenever either $v_i = l_i$ or $v_i = u_i$ is active at the optimum (within a numerical tolerance).\n   - Include the objective hyperplane row $\\mathbf{c}^{\\top}$ to restrict to the optimal solution set $z = z^{\\star}$, where $z^{\\star}$ is the maximal value found in step $1$.\n   Compute the degeneracy dimension at the FBA optimum as $d_{\\text{FBA}} = n - \\operatorname{rank}(\\mathbf{A}_{\\text{act}})$.\n3. Solve the pFBA problem by minimizing $\\sum_{i=1}^{n} |v_i|$ subject to $\\mathbf{S}\\mathbf{v} = \\mathbf{0}$, $\\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}$, and $\\mathbf{c}^{\\top}\\mathbf{v} = z^{\\star}$, using standard linearization with auxiliary variables to enforce absolute values. Let the pFBA solution be $\\mathbf{v}^{\\text{pFBA}}$.\n4. At the pFBA solution, form the active constraint matrix using only the original polytope-defining constraints (exclude the objective hyperplane), i.e., include all rows of $\\mathbf{S}$ and the bound-equality rows $\\mathbf{e}_i^{\\top}$ for reactions at bound. Compute $d_{\\text{pFBA}} = n - \\operatorname{rank}(\\mathbf{A}_{\\text{act,poly}})$. Report whether pFBA selects an extreme point of the original feasible polytope by checking if $d_{\\text{pFBA}} = 0$.\n5. Quantify pathway identifiability by comparing sparsity: compute the number of nonzero fluxes (above a tolerance) in the FBA solution, denoted $\\text{nnz}_{\\text{FBA}}$, and in the pFBA solution, denoted $\\text{nnz}_{\\text{pFBA}}$.\n\nNumerical tolerance for deciding activity and nonzero-ness must be set to $10^{-9}$.\n\nTest Suite:\nProvide results for the following three scientifically consistent networks. In each case, all bounds are in arbitrary flux units and should be treated as dimensionless numbers.\n\n- Test case $1$ (two alternative pathways from $G$ to biomass):\n  - Metabolites: $G, B, C$ (so $m = 3$).\n  - Reactions ($n = 6$): $v_1$ uptake $: \\varnothing \\to G$, $v_2$ direct conversion $: G \\to B$, $v_3$ branch $: G \\to C$, $v_4$ conversion $: C \\to B$, $v_5$ biomass drain $: B \\to \\varnothing$, $v_6$ export $: C \\to \\varnothing$.\n  - Stoichiometric matrix rows:\n    - $G$: $(+1, -1, -1, 0, 0, 0)$,\n    - $B$: $(0, +1, 0, +1, -1, 0)$,\n    - $C$: $(0, 0, +1, -1, 0, -1)$.\n  - Bounds: $v_1 \\in [0, 10]$, $v_2 \\in [0, 1000]$, $v_3 \\in [0, 1000]$, $v_4 \\in [0, 1000]$, $v_5 \\in [0, 1000]$, $v_6 \\in [0, 1000]$.\n  - Objective: $\\mathbf{c} = (0, 0, 0, 0, 1, 0)$.\n\n- Test case $2$ (unique pathway, no branch):\n  - Metabolites: $G, B$ (so $m = 2$).\n  - Reactions ($n = 3$): $v_1$ uptake $: \\varnothing \\to G$, $v_2$ conversion $: G \\to B$, $v_3$ biomass drain $: B \\to \\varnothing$.\n  - Stoichiometric matrix rows:\n    - $G$: $(+1, -1, 0)$,\n    - $B$: $(0, +1, -1)$.\n  - Bounds: $v_1 \\in [0, 10]$, $v_2 \\in [0, 1000]$, $v_3 \\in [0, 1000]$.\n  - Objective: $\\mathbf{c} = (0, 0, 1)$.\n\n- Test case $3$ (two alternative pathways plus a futile cycle $B \\leftrightarrow D$):\n  - Metabolites: $G, B, C, D$ (so $m = 4$).\n  - Reactions ($n = 8$): same as test case $1$ ($v_1$ through $v_6$) plus $v_7$ cycle forward $: B \\to D$, $v_8$ cycle backward $: D \\to B$.\n  - Stoichiometric matrix rows:\n    - $G$: $(+1, -1, -1, 0, 0, 0, 0, 0)$,\n    - $B$: $(0, +1, 0, +1, -1, 0, -1, +1)$,\n    - $C$: $(0, 0, +1, -1, 0, -1, 0, 0)$,\n    - $D$: $(0, 0, 0, 0, 0, 0, +1, -1)$.\n  - Bounds: $v_1 \\in [0, 10]$, $v_2 \\in [0, 1000]$, $v_3 \\in [0, 1000]$, $v_4 \\in [0, 1000]$, $v_5 \\in [0, 1000]$, $v_6 \\in [0, 1000]$, $v_7 \\in [0, 1000]$, $v_8 \\in [0, 1000]$.\n  - Objective: $\\mathbf{c} = (0, 0, 0, 0, 1, 0, 0, 0)$.\n\nAnswer Specification:\nFor each test case, produce a list of five values in the order $[d_{\\text{FBA}}, d_{\\text{pFBA}}, \\text{nnz}_{\\text{FBA}}, \\text{nnz}_{\\text{pFBA}}, \\text{extreme}_{\\text{pFBA}}]$, where $d_{\\text{FBA}}$ and $d_{\\text{pFBA}}$ are integers, $\\text{nnz}_{\\text{FBA}}$ and $\\text{nnz}_{\\text{pFBA}}$ are integers, and $\\text{extreme}_{\\text{pFBA}}$ is a boolean indicating whether $d_{\\text{pFBA}} = 0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of five values for the corresponding test case. For example: $[[d_1, d'_1, k_1, k'_1, b_1], [d_2, d'_2, k_2, k'_2, b_2], [d_3, d'_3, k_3, k'_3, b_3]]$.",
            "solution": "The problem requires the implementation and analysis of Flux Balance Analysis (FBA) and Parsimonious Flux Balance Analysis (pFBA) for three distinct metabolic network models. The analysis involves solving linear programming problems, determining solution space degeneracy through nullspace analysis, and comparing the sparsity of resulting flux distributions.\n\nThe methodological foundation is constraint-based modeling of metabolism. The core assumption is that intracellular metabolites are at a steady state, leading to the mass balance constraint $\\mathbf{S}\\mathbf{v} = \\mathbf{0}$, where $\\mathbf{S}$ is the stoichiometric matrix and $\\mathbf{v}$ is the vector of reaction fluxes. Fluxes are further constrained by thermodynamic and capacity limits, expressed as box constraints $\\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}$.\n\nThe analysis proceeds in five prescribed steps for each test case:\n\n**Step 1: Flux Balance Analysis (FBA)**\nThe first step is to solve the standard FBA problem. This is a linear programming (LP) problem formulated to maximize a biological objective function, $z = \\mathbf{c}^{\\top}\\mathbf{v}$, subject to the steady-state and flux bound constraints.\n$$\n\\begin{align*}\n\\text{maximize} \\quad  z = \\mathbf{c}^{\\top}\\mathbf{v} \\\\\n\\text{subject to} \\quad  \\mathbf{S}\\mathbf{v} = \\mathbf{0} \\\\\n \\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}\n\\end{align*}\n$$\nThis LP will be solved using the `linprog` function from the `scipy.optimize` library. Since `linprog` is a minimizer, we solve the equivalent problem of minimizing $z' = -\\mathbf{c}^{\\top}\\mathbf{v}$. The optimal objective value from FBA is denoted $z^{\\star}$.\n\n**Step 2: FBA Degeneracy ($d_{\\text{FBA}}$)**\nThe FBA problem may yield a single unique optimal flux vector or a convex set of alternate optimal solutions. The problem defines a procedure to compute a quantity, $d_{\\text{FBA}}$, related to this degeneracy. An active constraint matrix, $\\mathbf{A}_{\\text{act}}$, is constructed for the specific FBA solution vector $\\mathbf{v}^{\\text{FBA}}$ returned by the solver. This matrix includes:\n1. All rows of the stoichiometric matrix $\\mathbf{S}$.\n2. The objective function row $\\mathbf{c}^{\\top}$, representing the constraint $\\mathbf{c}^{\\top}\\mathbf{v} = z^{\\star}$.\n3. For each reaction $i$ whose flux $v_i^{\\text{FBA}}$ is at a lower or upper bound, the corresponding standard basis vector $\\mathbf{e}_i^{\\top}$.\nThe degeneracy is then computed as $d_{\\text{FBA}} = n - \\operatorname{rank}(\\mathbf{A}_{\\text{act}})$, where $n$ is the number of reactions. It is critical to note that this specific formulation measures the nullity of the set of active constraints at a single vertex returned by the LP solver. If the solver returns a non-degenerate vertex of the optimal face, this value will be $0$ regardless of whether alternate optima exist. This quantity is distinct from the dimensionality of the entire optimal solution space, which is a more common definition of alternate optima degeneracy. We shall adhere strictly to the problem's definition. A numerical tolerance of $10^{-9}$ is used to determine if a constraint is active.\n\n**Step 3: Parsimonious Flux Balance Analysis (pFBA)**\npFBA is a two-step optimization process that refines the FBA solution. After finding the maximal objective value $z^{\\star}$, pFBA seeks the solution(s) within the FBA-optimal space that minimize the total flux, taken as a proxy for minimizing enzymatic cost. The objective is to minimize the $\\ell_{1}$-norm of the flux vector, $\\sum_{i=1}^{n} |v_i|$. In the provided test cases, all flux lower bounds are $l_i = 0$, meaning all fluxes are non-negative ($v_i \\ge 0$). This simplifies the pFBA objective, as $|v_i| = v_i$. The pFBA problem is thus another LP:\n$$\n\\begin{align*}\n\\text{minimize} \\quad  \\sum_{i=1}^{n} v_i \\\\\n\\text{subject to} \\quad  \\mathbf{S}\\mathbf{v} = \\mathbf{0} \\\\\n \\mathbf{c}^{\\top}\\mathbf{v} = z^{\\star} \\\\\n \\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}\n\\end{align*}\nThis formulation finds a flux distribution that achieves the maximum biological yield with the minimum total enzyme investment.\n\n**Step 4: pFBA Solution Characterization ($d_{\\text{pFBA}}$)**\nThe pFBA solution, $\\mathbf{v}^{\\text{pFBA}}$, is typically a unique vertex of the original feasible polytope. To verify this, we compute a second degeneracy metric, $d_{\\text{pFBA}}$. We form an active constraint matrix $\\mathbf{A}_{\\text{act,poly}}$ using only the constraints that define the feasible polytope (i.e., excluding the objective hyperplane $\\mathbf{c}^{\\top}\\mathbf{v} = z^{\\star}$). This matrix includes all rows of $\\mathbf{S}$ and the active bound constraints at $\\mathbf{v}^{\\text{pFBA}}$. The degeneracy is $d_{\\text{pFBA}} = n - \\operatorname{rank}(\\mathbf{A}_{\\text{act,poly}})$. If $d_{\\text{pFBA}} = 0$, the pFBA solution is a unique vertex of the feasible region, and we report that pFBA selects an extreme point.\n\n**Step 5: Sparsity Analysis**\nA key benefit of pFBA is its tendency to produce sparser flux vectors, meaning fewer reactions carry flux. This enhances pathway identifiability. We quantify this by computing the number of non-zero fluxes (defined as $|v_i|  10^{-9}$) in both the FBA solution ($\\text{nnz}_{\\text{FBA}}$) and the pFBA solution ($\\text{nnz}_{\\text{pFBA}}$). This comparison highlights pFBA's ability to eliminate physiologically unnecessary fluxes, such as those in futile cycles or redundant pathways, that FBA may arbitrarily include. While a standard LP solver might fortuitously return a sparse FBA solution (as a vertex of the optimal face), pFBA guarantees it.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute the specified results.\n    \"\"\"\n    tol = 1e-9\n\n    # Test case 1 definition\n    S1 = np.array([\n        [1, -1, -1, 0, 0, 0],\n        [0, 1, 0, 1, -1, 0],\n        [0, 0, 1, -1, 0, -1]\n    ], dtype=float)\n    l1 = np.zeros(6)\n    u1 = np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float)\n    c1 = np.array([0, 0, 0, 0, 1, 0], dtype=float)\n\n    # Test case 2 definition\n    S2 = np.array([\n        [1, -1, 0],\n        [0, 1, -1]\n    ], dtype=float)\n    l2 = np.zeros(3)\n    u2 = np.array([10, 1000, 1000], dtype=float)\n    c2 = np.array([0, 0, 1], dtype=float)\n\n    # Test case 3 definition\n    S3 = np.array([\n        [1, -1, -1, 0, 0, 0, 0, 0],\n        [0, 1, 0, 1, -1, 0, -1, 1],\n        [0, 0, 1, -1, 0, -1, 0, 0],\n        [0, 0, 0, 0, 0, 0, 1, -1]\n    ], dtype=float)\n    l3 = np.zeros(8)\n    u3 = np.array([10, 1000, 1000, 1000, 1000, 1000, 1000, 1000], dtype=float)\n    c3 = np.array([0, 0, 0, 0, 1, 0, 0, 0], dtype=float)\n\n    test_cases = [\n        (S1, l1, u1, c1),\n        (S2, l2, u2, c2),\n        (S3, l3, u3, c3)\n    ]\n\n    results = []\n    for S, l, u, c in test_cases:\n        results.append(_process_case(S, l, u, c, tol))\n    \n    # Format the final output string\n    # E.g., [[0, 0, 3, 3, True], [0, 0, 3, 3, True], [0, 0, 3, 3, True]]\n    result_str = '[' + ','.join([f\"[{','.join(map(str, r))}]\" for r in results]) + ']'\n    print(result_str)\n\ndef _process_case(S, l, u, c, tol):\n    \"\"\"\n    Performs the full FBA and pFBA analysis for a single test case.\n    \"\"\"\n    m, n = S.shape\n\n    # --- Step 1: Solve FBA ---\n    # Maximize c'v by a minimizing -c'v\n    res_fba = linprog(c=-c, A_eq=S, b_eq=np.zeros(m), bounds=list(zip(l, u)), method='highs')\n    \n    if not res_fba.success:\n        # This should not happen for the given valid problems.\n        raise RuntimeError(\"FBA optimization failed.\")\n        \n    v_fba = res_fba.x\n    z_star = c @ v_fba\n\n    # --- Step 2: Compute FBA Degeneracy (d_FBA) ---\n    # Construct A_act based on the FBA solution\n    A_act_fba_rows = [S, c.reshape(1, -1)]\n    for i in range(n):\n        if abs(v_fba[i] - l[i])  tol or abs(v_fba[i] - u[i])  tol:\n            row = np.zeros(n)\n            row[i] = 1.0\n            A_act_fba_rows.append(row.reshape(1, -1))\n    \n    A_act_fba = np.vstack(A_act_fba_rows)\n    rank_fba = np.linalg.matrix_rank(A_act_fba, tol=tol)\n    d_fba = n - rank_fba\n\n    # --- Step 3: Solve pFBA ---\n    # Objective is to minimize sum(v_i) since all v_i = 0\n    c_pfba = np.ones(n)\n    \n    # Constraints for pFBA: S.v=0 and c.v=z_star\n    A_eq_pfba = np.vstack([S, c.reshape(1, -1)])\n    b_eq_pfba = np.append(np.zeros(m), z_star)\n\n    res_pfba = linprog(c=c_pfba, A_eq=A_eq_pfba, b_eq=b_eq_pfba, bounds=list(zip(l, u)), method='highs')\n\n    if not res_pfba.success:\n        # This should not happen for the given valid problems.\n        raise RuntimeError(\"pFBA optimization failed.\")\n    \n    v_pfba = res_pfba.x\n\n    # --- Step 4: Compute pFBA Degeneracy  Extreme Point Check (d_pFBA) ---\n    # Construct A_act_poly based on the pFBA solution (excluding objective)\n    A_act_poly_rows = [S]\n    for i in range(n):\n        if abs(v_pfba[i] - l[i])  tol or abs(v_pfba[i] - u[i])  tol:\n            row = np.zeros(n)\n            row[i] = 1.0\n            A_act_poly_rows.append(row.reshape(1, -1))\n\n    A_act_poly = np.vstack(A_act_poly_rows)\n    rank_pfba_poly = np.linalg.matrix_rank(A_act_poly, tol=tol)\n    d_pfba = n - rank_pfba_poly\n    extreme_pfba = (d_pfba == 0)\n\n    # --- Step 5: Quantify Sparsity (nnz) ---\n    nnz_fba = np.sum(np.abs(v_fba)  tol)\n    nnz_pfba = np.sum(np.abs(v_pfba)  tol)\n    \n    return [int(d_fba), int(d_pfba), int(nnz_fba), int(nnz_pfba), extreme_pfba]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}