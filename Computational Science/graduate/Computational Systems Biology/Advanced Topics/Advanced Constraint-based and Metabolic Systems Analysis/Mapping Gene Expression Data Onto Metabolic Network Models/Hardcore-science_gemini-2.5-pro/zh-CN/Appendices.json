{
    "hands_on_practices": [
        {
            "introduction": "这项练习将引导您完成处理原始转录组数据以用于代谢模型的基本步骤。从原始的RNA测序（RNA-Seq）读数计数开始，您将首先学习计算百万转录本每百万（TPM），这是一种标准化的基因表达量度，它同时考虑了测序深度和基因长度。接着，您将运用基本原理，通过基因-蛋白质-反应（GPR）规则，将这些基因层面的表达值转化为反应活性评分，并处理酶复合物（AND逻辑）和同工酶（OR逻辑）两种情况。这项练习  为连接实验数据与模型输入提供了一座至关重要的桥梁。",
            "id": "3324702",
            "problem": "给定一个单一条件下的小型RNA测序（RNA-Seq）数据集，该数据集包含四个基因的原始读数计数和基因长度。这四个基因编码与基因组尺度模型中两个代谢反应相关的酶。使用每百万转录本（TPM）的标准定义，它是一种经过长度归一化和文库大小归一化的转录本丰度度量。数据集如下：基因 $g_{1}$ 的长度为 $2000$ 碱基对，有 $500$ 个比对上的读数；基因 $g_{2}$ 的长度为 $1000$ 碱基对，有 $1000$ 个比对上的读数；基因 $g_{3}$ 的长度为 $3000$ 碱基对，有 $300$ 个比对上的读数；基因 $g_{4}$ 的长度为 $1500$ 碱基对，有 $1200$ 个比对上的读数。考虑两个具有基因-蛋白质-反应（GPR）关联的反应：反应 $\\mathcal{R}_{1}$ 由一个专性异源复合物催化，该复合物需要由 $g_{1}$ 和 $g_{2}$ 共同编码的两个亚基；反应 $\\mathcal{R}_{2}$ 由 $g_{3}$ 或 $g_{4}$ 编码的两种同工酶催化。从分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）以及RNA-Seq读数计数与转录本丰度乘以转录本有效长度成正比的原理出发，推导TPM的计算方法，并计算每个基因的TPM值。然后，利用关于酶复合物化学计量和同工酶可加性的第一性原理推理，推导如何将基因水平的TPM聚合成 $\\mathcal{R}_{1}$ 和 $\\mathcal{R}_{2}$ 的单一反应活性评分。最后，使用推导出的聚合方法计算反应 $\\mathcal{R}_{1}$ 的活性评分，并将其报告为一个无单位的十进制数。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题需要一个多步骤的推导和计算过程，从分子生物学和数据分析的基本原理出发，计算一个反应活性评分。该过程包括三个主要部分：首先，推导每百万转录本（TPM）的公式并为四个基因计算其值；其次，根据基因-蛋白质-反应（GPR）规则，推导将基因水平的表达数据聚合成反应水平评分的逻辑；第三，应用此逻辑计算反应 $\\mathcal{R}_{1}$ 的评分。\n\n提供的四个基因的数据如下：\n- 基因 $g_{1}$：长度 $L_1 = 2000$ 碱基对 (bp)，读数计数 $C_1 = 500$。\n- 基因 $g_{2}$：长度 $L_2 = 1000$ bp，读数计数 $C_2 = 1000$。\n- 基因 $g_{3}$：长度 $L_3 = 3000$ bp，读数计数 $C_3 = 300$。\n- 基因 $g_{4}$：长度 $L_4 = 1500$ bp，读数计数 $C_4 = 1200$。\n\nGPR关联如下：\n- 反应 $\\mathcal{R}_{1}$：$g_{1}$ AND $g_{2}$（专性异源复合物）。\n- 反应 $\\mathcal{R}_{2}$：$g_{3}$ OR $g_{4}$（同工酶）。\n\n第1部分：每百万转录本（TPM）的推导与计算\n\n问题陈述RNA-Seq的读数计数与转录本丰度和转录本有效长度成正比。对于一个给定的基因 $g_i$，其读数计数 $C_i$ 可以被建模为与其相应转录本的摩尔浓度（我们将其表示为丰度 $A_i$）及其长度 $L_i$ 成正比。\n$$C_i \\propto A_i \\cdot L_i$$\n这种关系意味着，为了估计相对丰度 $A_i$，我们必须用基因长度 $L_i$ 对读数计数 $C_i$ 进行归一化。\n$$A_i \\propto \\frac{C_i}{L_i}$$\n项 $\\frac{C_i}{L_i}$ 表示每个转录本碱基上比对到的读数速率。我们定义这个速率为 $r_i = \\frac{C_i}{L_i}$。这一步是针对基因长度进行归一化。\n\n然而，这些速率 $r_i$ 也依赖于文库的总测序深度。为了使不同样本间的表达水平具有可比性（或者，在本例中，为了在单个样本内创建一个归一化的度量），我们还必须按文库大小进行归一化。TPM通过将每个基因的速率 $r_i$ 表示为所有基因总速率的一部分，然后将该分数缩放到“每百万”的值来实现这一点。\n\n所有速率的总和 $\\sum_{j} r_j = \\sum_{j} \\frac{C_j}{L_j}$，是总比对读数除以转录组长度的代理，因此可作为文库大小的度量。基因 $g_i$ 的TPM定义为归因于基因 $g_i$ 的总速率分数，再乘以 $10^6$。\n$$\n\\text{TPM}_i = \\left(\\frac{r_i}{\\sum_{j} r_j}\\right) \\times 10^6 = \\left(\\frac{C_i / L_i}{\\sum_{j} (C_j / L_j)}\\right) \\times 10^6\n$$\n现在，我们计算四个基因中每个基因的TPM值。为了简化数字，用千碱基对（kb）表示基因长度很方便，其中 $1 \\text{ kb} = 1000 \\text{ bp}$。\n- $L_1 = 2.0$ kb, $C_1 = 500$\n- $L_2 = 1.0$ kb, $C_2 = 1000$\n- $L_3 = 3.0$ kb, $C_3 = 300$\n- $L_4 = 1.5$ kb, $C_4 = 1200$\n\n首先，我们计算速率 $r_i = C_i/L_i$（单位为 读数/kb）：\n- $r_1 = \\frac{500}{2.0} = 250$\n- $r_2 = \\frac{1000}{1.0} = 1000$\n- $r_3 = \\frac{300}{3.0} = 100$\n- $r_4 = \\frac{1200}{1.5} = 800$\n\n接下来，我们计算这些速率的总和，这是用于文库大小归一化的因子：\n$$\n\\sum_{j=1}^{4} r_j = r_1 + r_2 + r_3 + r_4 = 250 + 1000 + 100 + 800 = 2150\n$$\n最后，我们计算每个基因的TPM值：\n- $\\text{TPM}_1 = \\frac{r_1}{\\sum r_j} \\times 10^6 = \\frac{250}{2150} \\times 10^6 \\approx 116279.07$\n- $\\text{TPM}_2 = \\frac{r_2}{\\sum r_j} \\times 10^6 = \\frac{1000}{2150} \\times 10^6 \\approx 465116.28$\n- $\\text{TPM}_3 = \\frac{r_3}{\\sum r_j} \\times 10^6 = \\frac{100}{2150} \\times 10^6 \\approx 46511.63$\n- $\\text{TPM}_4 = \\frac{r_4}{\\sum r_j} \\times 10^6 = \\frac{800}{2150} \\times 10^6 \\approx 372093.02$\n\n第2部分：GPR聚合规则的推导\n\n中心法则指出，遗传信息从DNA流向RNA，再到蛋白质。我们假设由TPM测量的基因转录本（mRNA）的丰度，是其编码的蛋白质丰度的合理代理。GPR规则描述了这些蛋白质如何结合形成催化代谢反应的功能性酶。\n\n对于反应 $\\mathcal{R}_{2}$ ($g_{3}$ OR $g_{4}$)，逻辑运算符“或”（OR）表示由 $g_{3}$ 和 $g_{4}$ 编码的蛋白质是同工酶。每种酶都可以独立催化该反应。因此，$\\mathcal{R}_{2}$ 的总催化能力是单个酶能力的总和。反应评分是相应基因表达水平的总和。\n$$\n\\text{Score}(\\mathcal{R}_\\text{OR}) = \\sum_i \\text{TPM}_i\n$$\n所以，对于 $\\mathcal{R}_{2}$，$\\text{Score}(\\mathcal{R}_2) = \\text{TPM}_3 + \\text{TPM}_4$。\n\n对于反应 $\\mathcal{R}_{1}$ ($g_{1}$ AND $g_{2}$)，逻辑运算符“与”（AND）表示由 $g_{1}$ 和 $g_{2}$ 编码的蛋白质都是必需的，形成一个专性异源复合物。这个功能性复合物的组装依赖于其所有组成亚基的可用性。根据限制性反应物原理（源自质量作用定律），最终产物（酶复合物）的形成速率受丰度最低的亚基的限制。因此，功能性酶复合物的总量，也即反应的催化能力，由其亚基丰度的最小值决定。反应评分是所需基因表达水平的最小值。\n$$\n\\text{Score}(\\mathcal{R}_\\text{AND}) = \\min(\\{\\text{TPM}_i\\})\n$$\n所以，对于 $\\mathcal{R}_{1}$，$\\text{Score}(\\mathcal{R}_1) = \\min(\\text{TPM}_1, \\text{TPM}_2)$。\n\n第3部分：反应 $\\mathcal{R}_{1}$ 活性评分的计算\n\n使用为“与”关系推导出的规则和在第1部分中计算的TPM值，我们可以计算反应 $\\mathcal{R}_{1}$ 的活性评分。\n$$\n\\text{Score}(\\mathcal{R}_1) = \\min(\\text{TPM}_1, \\text{TPM}_2)\n$$\n代入计算出的值：\n$$\n\\text{Score}(\\mathcal{R}_1) = \\min(116279.069..., 465116.279...)\n$$\n这两个值的最小值是 $\\text{TPM}_1$。\n$$\n\\text{Score}(\\mathcal{R}_1) = 116279.069...\n$$\n问题要求将此答案四舍五入到四位有效数字。前四位有效数字是 $1, 1, 6, 2$。第五位数字是 $7$，大于或等于 $5$，所以我们将第四位数字向上取整。数字 $2$ 变为 $3$。其余数字用零替换，以保持数值的大小。\n$$\n\\text{Score}(\\mathcal{R}_1) \\approx 116300\n$$\n因此，反应 $\\mathcal{R}_{1}$ 的活性评分为 $116300$。",
            "answer": "$$\n\\boxed{116300}\n$$"
        },
        {
            "introduction": "在GPR概念的基础上，这项练习深入探讨了如何解释更复杂的逻辑规则，并利用它们做出具体的生物学预测。您将处理一个同时包含AND和OR运算符的GPR规则，这反映了基因在形成功能性酶过程中的复杂关系。这项练习  的一个关键部分是应用一种数据驱动的阈值方案，将一个反应分类为“活跃”或“不活跃”，这是许多算法中将表达数据离散化以约束代谢模型的关键步骤。这个问题将锻炼您将复杂的GPR逻辑转化为定量决策的能力。",
            "id": "3324676",
            "problem": "考虑一个基因组尺度模型中的单个代谢反应，其关联的基因-蛋白质-反应（GPR）规则包含可替换的同工酶和必需的蛋白质亚基。其分子生物学基础是，根据中心法则（脱氧核糖核酸 $\\rightarrow$ mRNA $\\rightarrow$ 蛋白质），信使核糖核酸（mRNA）的丰度映射到酶的丰度；多亚基酶复合物需要所有亚基都存在才能形成功能性催化剂，而同工酶则为同一反应提供了可替换的催化途径。在映射到反应活性之前，将一个严格递增的预处理函数应用于原始转录本丰度，以减轻其偏度。\n\n对于单个样本，给定以下每个基因的转录本丰度（以每百万转录本数（TPM）为单位测量）：\n- 基因 $g_{1}$：$40$，\n- 基因 $g_{2}$：$10$，\n- 基因 $g_{3}$：$0.8$，\n- 基因 $g_{4}$：$30$，\n- 基因 $g_{5}$：$50$。\n\n该反应相关的 GPR 规则为\n$$(g_{1} \\ \\text{AND} \\ (g_{2} \\ \\text{OR} \\ g_{3})) \\ \\text{OR} \\ (g_{4} \\ \\text{AND} \\ g_{5}).$$\n\n在映射之前，每个原始丰度 $x$ 通过严格递增函数 $p(x) = \\ln(1+x)$ 进行转换，其中 $\\ln$ 表示自然对数。阈值方案如下：\n- 计算样本特异性阈值 $\\tau$，其值为集合 $\\{p(x_{g_{1}}), p(x_{g_{2}}), p(x_{g_{3}}), p(x_{g_{4}}), p(x_{g_{5}})\\}$ 的中位数。\n- 根据以下生物学原理评估 GPR 规则，以计算反应的有效表达量：多亚基复合物受其最不丰富的必需亚基限制，而可替换的同工酶使反应由最丰富的可用同工酶决定。此评估在预处理转换 $p(\\cdot)$ 之后应用。\n- 如果反应的有效表达量大于或等于 $\\tau$，则将其分类为活性；否则为非活性。\n\n仅使用以上信息，确定在此方案下该反应是否为活性。如果为活性，最终答案表示为 $1$；如果为非活性，则表示为 $0$。无需四舍五入。最终答案不应包含单位。",
            "solution": "本问题要求根据一组基因表达测量值、一个基因-蛋白质-反应（GPR）规则以及一个定义的评估程序，来确定一个特定的代谢反应是活性还是非活性。如果反应是活性的，最终答案应为 $1$；如果是非活性的，则为 $0$。\n\n首先，我们必须验证问题的有效性。给定条件如下：\n- 基因转录本丰度：$x_{g_1} = 40$, $x_{g_2} = 10$, $x_{g_3} = 0.8$, $x_{g_4} = 30$, $x_{g_5} = 50$。\n- GPR规则：$(g_{1} \\ \\text{AND} \\ (g_{2} \\ \\text{OR} \\ g_{3})) \\ \\text{OR} \\ (g_{4} \\ \\text{AND} \\ g_{5})$。\n- 预处理函数：$p(x) = \\ln(1+x)$。\n- 映射逻辑：'AND' 对应于最小值，'OR' 对应于最大值。\n- 阈值 $\\tau$：预处理后丰度集合的中位数。\n- 活性条件：如果反应的有效表达量大于或等于 $\\tau$，则反应为活性。\n\n该问题在计算系统生物学中有科学依据，问题陈述清晰，提供了所有必要信息，并且表述客观。前提条件一致，所需计算可行。因此，该问题是有效的，我们可以继续进行求解。\n\n求解过程包括四个主要步骤：\n1.  对给定的转录本丰度应用预处理函数。\n2.  计算样本特异性活性阈值 $\\tau$。\n3.  根据 GPR 规则计算反应的有效表达量。\n4.  将有效表达量与阈值进行比较，以确定反应的状态。\n\n**步骤1：预处理基因表达数据**\n每个基因的原始转录本丰度 $x$ 通过函数 $p(x) = \\ln(1+x)$ 进行转换。我们为五个基因中的每一个计算该值：\n- 对于 $g_1$：$p(x_{g_1}) = p(40) = \\ln(1+40) = \\ln(41)$\n- 对于 $g_2$：$p(x_{g_2}) = p(10) = \\ln(1+10) = \\ln(11)$\n- 对于 $g_3$：$p(x_{g_3}) = p(0.8) = \\ln(1+0.8) = \\ln(1.8)$\n- 对于 $g_4$：$p(x_{g_4}) = p(30) = \\ln(1+30) = \\ln(31)$\n- 对于 $g_5$：$p(x_{g_5}) = p(50) = \\ln(1+50) = \\ln(51)$\n\n令这些预处理值的集合为 $S = \\{\\ln(41), \\ln(11), \\ln(1.8), \\ln(31), \\ln(51)\\}$。\n\n**步骤2：计算活性阈值 $\\tau$**\n阈值 $\\tau$ 定义为集合 $S$ 的中位数。为求中位数，我们首先对 $S$ 的元素进行排序。由于 $\\ln(x)$ 是一个严格递增函数，$S$ 中值的顺序由其自变量的顺序决定。这些自变量是 $1.8, 10, 30, 41, 50$。对其进行排序得到 $1.8  10  30  41  50$。\n排序后的预处理值集合为：\n$$S_{\\text{sorted}} = \\{\\ln(1.8), \\ln(11), \\ln(31), \\ln(41), \\ln(51)\\}$$\n对于一个包含 $5$ 个元素的集合，中位数是排序后列表中的第3个元素。\n因此，阈值为 $\\tau = \\ln(31)$。\n\n**步骤3：计算有效反应表达量**\n我们记反应的有效表达量为 $E_{\\text{rxn}}$，通过评估 GPR 规则来计算。给定的生物学原理意味着'AND'逻辑运算符对应于最小值函数（用于必需的蛋白质亚基），而'OR'逻辑运算符对应于最大值函数（用于可替换的同工酶）。GPR 规则是：\n$$(g_{1} \\ \\text{AND} \\ (g_{2} \\ \\text{OR} \\ g_{3})) \\ \\text{OR} \\ (g_{4} \\ \\text{AND} \\ g_{5})$$\n将其转化为对预处理后基因表达值 $p(x_{g_i})$ 的数学运算：\n$$E_{\\text{rxn}} = \\max(\\min(p(x_{g_1}), \\max(p(x_{g_2}), p(x_{g_3}))), \\min(p(x_{g_4}), p(x_{g_5})))$$\n我们代入已计算的预处理值：\n$$E_{\\text{rxn}} = \\max(\\min(\\ln(41), \\max(\\ln(11), \\ln(1.8))), \\min(\\ln(31), \\ln(51)))$$\n我们从内向外计算表达式。\n首先，是内部的 $\\max$ 和 $\\min$ 项：\n- $\\max(\\ln(11), \\ln(1.8)) = \\ln(11)$，因为 $11 > 1.8$。\n- $\\min(\\ln(31), \\ln(51)) = \\ln(31)$，因为 $31  51$。\n\n将这些结果代回 $E_{\\text{rxn}}$ 的表达式中：\n$$E_{\\text{rxn}} = \\max(\\min(\\ln(41), \\ln(11)), \\ln(31))$$\n接下来，我们计算剩余的内部项：\n- $\\min(\\ln(41), \\ln(11)) = \\ln(11)$，因为 $11  41$。\n\n最后，我们计算最外层的运算：\n$$E_{\\text{rxn}} = \\max(\\ln(11), \\ln(31))$$\n- $E_{\\text{rxn}} = \\ln(31)$，因为 $31 > 11$。\n\n所以，该反应的有效表达量为 $E_{\\text{rxn}} = \\ln(31)$。\n\n**步骤4：确定反应活性**\n如果反应的有效表达量大于或等于阈值 $\\tau$，则该反应被分类为活性。条件是 $E_{\\text{rxn}} \\geq \\tau$。\n我们已经计算出 $E_{\\text{rxn}} = \\ln(31)$ 和 $\\tau = \\ln(31)$。\n将这些值代入条件中，我们得到：\n$$\\ln(31) \\geq \\ln(31)$$\n这个不等式成立（因为两边相等）。因此，该反应被分类为**活性**。\n\n问题要求对于活性反应，最终答案应为 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "这最后一个练习将从单个反应的层面推进到系统层面，将离散化的基因表达数据整合到一个全网络范围的代谢模型中。您将接触到整合代谢分析工具（iMAT）算法，这是一种强大的方法，用于识别与转录组数据最大程度一致的代谢状态。这项练习  的核心是构建并求解一个混合整数线性规划（MILP）问题，该问题旨在调和网络的化学计量约束（$S v = 0$）与高、低基因表达所建议的反应活性状态。通过这项练习，您将亲身体验基于约束的建模和数据整合领域的基石技术之一。",
            "id": "3324646",
            "problem": "考虑一个由三种细胞内代谢物 $A$、$B$ 和 $C$ 组成的最小代谢网络，它们通过4个不可逆反应 $R_1, R_2, R_3, R_4$ 连接。化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 4}$ 通过 $S v = 0$ 编码了代谢物 $A$、$B$ 和 $C$ 的稳态质量平衡约束，其中 $v \\in \\mathbb{R}^{4}$ 是反应通量向量。这些反应是：\n- $R_1$：从环境中摄取代谢物 $A$，增加细胞内 $A$ 的浓度，其对 $A$ 的化学计量系数为 $+1$，通量边界为 $0 \\leq v_1 \\leq U_1$，\n- $R_2$：转化 $A \\to B$，其对 $A$ 的化学计量系数为 $-1$，对 $B$ 的化学计量系数为 $+1$，通量边界为 $0 \\leq v_2 \\leq U_2$，\n- $R_3$：转化 $B \\to C$，其对 $B$ 的化学计量系数为 $-1$，对 $C$ 的化学计量系数为 $+1$，通量边界为 $0 \\leq v_3 \\leq U_3$，\n- $R_4$：$C$ 损失到一个生物质汇中，其对 $C$ 的化学计量系数为 $-1$，通量边界为 $0 \\leq v_4 \\leq U_4$。\n\n具体来说，化学计量矩阵 $S$ 为\n$$\nS \\;=\\; \\begin{pmatrix}\n+1  -1  0  0 \\\\\n0  +1  -1  0 \\\\\n0  0  +1  -1\n\\end{pmatrix},\n$$\n因此稳态质量平衡约束为\n$$\nv_1 - v_2 = 0, \\quad v_2 - v_3 = 0, \\quad v_3 - v_4 = 0,\n$$\n并且每个反应通量都是非负的，且其上界为\n$$\n0 \\leq v_j \\leq U_j, \\quad j \\in \\{1,2,3,4\\}.\n$$\n\n假设使用整合代谢分析工具（Integrative Metabolic Analysis Tool, iMAT）进行离散化的基因表达整合，该工具将高表达和低表达集合映射到期望的反应活性状态。设高表达集合为 $H = \\{2,3\\}$，低表达集合为 $L = \\{4\\}$。反应 $R_1$ 既不属于高表达也不属于低表达。设最小活性阈值为 $\\delta  0$，因此一个活跃的反应必须承载至少 $\\delta$ 的通量，并设上界为 $U_1 = U_2 = U_3 = U_4 = 10$。\n\n从通量平衡分析（Flux Balance Analysis, FBA）的原理出发，即稳态约束 $S v = 0$ 和反应边界，以及将离散表达状态与期望反应活性状态相关联的基因-蛋白质-反应（GPR）映射概念，构建 iMAT 的混合整数线性规划模型。该模型在强制执行 $S v = 0$ 和通量边界的同时，最大化与高表达和低表达集合的一致性。使用二元活性变量 $y_j \\in \\{0,1\\}$ 来指示反应 $j$ 是否活跃。明确写出目标函数以及连接 $y_j$ 和 $v_j$ 所需的所有约束，确保对不可逆反应的科学真实性。\n\n然后，对于给定的玩具网络，其中 $H = \\{2,3\\}$，$L = \\{4\\}$，所有 $j$ 的 $U_j = 10$，最小活性阈值 $\\delta = 1$，确定 iMAT 模型的最优目标值。将最优目标值表示为单个整数。报告的数字无需四舍五入，也无需单位。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知条件\n-   **系统**：一个包含3种代谢物（$A$、$B$、$C$）和4个不可逆反应（$R_1, R_2, R_3, R_4$）的代谢网络。\n-   **化学计量矩阵**：$S \\in \\mathbb{R}^{3 \\times 4}$ 给出如下\n    $$ S \\;=\\; \\begin{pmatrix} +1  -1  0  0 \\\\ 0  +1  -1  0 \\\\ 0  0  +1  -1 \\end{pmatrix} $$\n-   **稳态约束**：$S v = 0$，其中 $v = (v_1, v_2, v_3, v_4)^T$ 是反应通量向量。展开为：\n    $$ v_1 - v_2 = 0 $$\n    $$ v_2 - v_3 = 0 $$\n    $$ v_3 - v_4 = 0 $$\n-   **通量边界**：反应是不可逆且有界的：$0 \\leq v_j \\leq U_j$，对于 $j \\in \\{1, 2, 3, 4\\}$。\n-   **iMAT 数据**：\n    -   高表达集合：$H = \\{2, 3\\}$。\n    -   低表达集合：$L = \\{4\\}$。\n    -   反应 $R_1$ 不在 $H$ 或 $L$ 中。\n-   **参数**：\n    -   最小活性阈值：$\\delta  0$。对于具体问题，$\\delta = 1$。\n    -   上界：$U_1 = U_2 = U_3 = U_4 = 10$。\n-   **变量**：使用二元活性变量 $y_j \\in \\{0, 1\\}$ 来指示反应 $j$ 是否活跃。\n-   **任务**：\n    1.  为整合代谢分析工具（iMAT）构建混合整数线性规划（MILP）模型。\n    2.  求解具体问题以找到最优目标值。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在计算系统生物学中有充分的依据。通量平衡分析（FBA）及其扩展 iMAT 是标准的、广泛使用的技术。使用化学计量矩阵、稳态假设（$Sv=0$）以及构建优化问题（特别是 MILP）来整合表达数据都是已建立且科学有效的概念。\n-   **适定性**：该问题是适定的。它清晰地定义了网络、约束和目标。要求的输出，即一个最优目标值，对于给定的 MILP 是一个可以唯一确定的量。\n-   **客观性**：问题使用精确、无歧义的技术语言陈述，不含主观论断。\n-   **一致性检查**：稳态约束 $v_1 - v_2 = 0$，$v_2 - v_3 = 0$ 和 $v_3 - v_4 = 0$ 意味着所有通量相等：$v_1 = v_2 = v_3 = v_4$。我们用 $v_{common}$ 表示这个共同的通量。每个通量 $v_j$ 的边界也适用于 $v_{common}$。具体来说，$0 \\leq v_{common} \\leq \\min(U_1, U_2, U_3, U_4)$。该问题内部是一致的。\n\n### 步骤 3：结论与行动\n该问题是有效的。这是一个构建和求解基于约束的模型的标准练习。将提供完整的解答。\n\n### 解答\n根据要求，解答分为两部分呈现：首先是 iMAT 混合整数线性规划（MILP）的一般形式，其次是针对所提供具体实例的求解。\n\n#### 第 1 部分：通用 iMAT 模型构建\n整合代谢分析工具（iMAT）的目标是找到一个稳态通量分布 $v$，使其与基因表达数据的一致性最大化。数据以一组与高表达基因相关的反应集合 $H$（这些反应最好是活跃的）和一组与低表达基因相关的反应集合 $L$（这些反应最好是不活跃的）的形式提供。这可以构建为一个 MILP。\n\n**变量：**\n-   $v_j \\in \\mathbb{R}$：反应 $j$ 的通量。由于所有反应都是不可逆的，因此 $v_j \\ge 0$。\n-   $y_j \\in \\{0, 1\\}$：一个二元变量，指示反应 $j$ 的活性状态。如果反应 $j$ 是活跃的（通量高于某个阈值），则 $y_j=1$；如果它是不活跃的（通量为零），则 $y_j=0$。\n\n**目标函数：**\n目标是最大化通量状态与表达数据之间的一致性数量。对于 $H$ 中每个活跃的反应以及 $L$ 中每个不活跃的反应，都会得一分。\n-   对于一个反应 $j \\in H$，一致性意味着它是活跃的，即 $y_j=1$。\n-   对于一个反应 $j \\in L$，一致性意味着它是不活跃的，即 $y_j=0$。这等价于 $1-y_j=1$。\n要最大化的目标函数是一致状态的总数：\n$$ \\text{最大化} \\quad Z = \\sum_{j \\in H} y_j + \\sum_{j \\in L} (1 - y_j) $$\n\n**约束条件：**\n1.  **稳态质量平衡**：在稳态下，每种内部代谢物的净生成量必须为零。\n    $$ S v = 0 $$\n2.  **通量容量约束**：每个反应通量 $v_j$ 都受其下界和上界的约束。对于给定的不可逆反应：\n    $$ 0 \\leq v_j \\leq U_j \\quad \\forall j $$\n3.  **通量-活性耦合**：二元活性变量 $y_j$ 必须与连续通量变量 $v_j$ 相关联。如果反应 $j$ 的通量 $v_j$ 大于或等于最小阈值 $\\delta  0$，则定义为活跃的（$y_j=1$）；如果其通量为零，则定义为不活跃的（$y_j=0$）。对于不可逆反应，这通过两个不等式来强制执行：\n    $$ \\delta \\cdot y_j \\leq v_j $$\n    $$ v_j \\leq U_j \\cdot y_j $$\n    如果 $y_j=0$，这些约束简化为 $0 \\leq v_j \\leq 0$，从而强制 $v_j=0$。如果 $y_j=1$，它们变为 $\\delta \\leq v_j \\leq U_j$，强制进入活跃状态。这两个约束必须对所有定义了活性状态的反应 $j$ 成立，通常是 $H \\cup L$ 中的所有反应以及与它们耦合的任何其他反应。为了得到一个完整的模型，我们将它们应用于所有反应 $j \\in \\{1, 2, 3, 4\\}$。\n\n结合这些元素，完整的 MILP 模型是：\n$$ \\begin{aligned}\n\\text{最大化} \\quad  \\sum_{j \\in H} y_j + \\sum_{j \\in L} (1 - y_j) \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n 0 \\leq v_j \\leq U_j  \\forall j \\\\\n \\delta \\cdot y_j \\leq v_j \\leq U_j \\cdot y_j  \\forall j \\\\\n v_j \\in \\mathbb{R}_{\\ge 0}  \\forall j \\\\\n y_j \\in \\{0, 1\\}  \\forall j\n\\end{aligned} $$\n\n#### 第 2 部分：具体网络的求解\n我们现在将此模型应用于给定的网络，参数为 $H = \\{2, 3\\}$，$L = \\{4\\}$，所有 $j$ 的 $U_j = 10$，以及 $\\delta = 1$。\n\n具体的 MILP 模型是：\n**目标函数：**\n$$ \\text{最大化} \\quad Z = y_2 + y_3 + (1 - y_4) $$\n\n**约束条件：**\n1.  $v_1 - v_2 = 0$\n2.  $v_2 - v_3 = 0$\n3.  $v_3 - v_4 = 0$\n4.  $0 \\leq v_j \\leq 10$ for $j \\in \\{1, 2, 3, 4\\}$\n5.  $1 \\cdot y_j \\leq v_j \\leq 10 \\cdot y_j$ for $j \\in \\{1, 2, 3, 4\\}$\n6.  $v_j \\in \\mathbb{R}_{\\ge 0}$, $y_j \\in \\{0, 1\\}$ for $j \\in \\{1, 2, 3, 4\\}$\n\n从约束 1、2、3 可知，所有通量必须相等。设 $v_{common} = v_1 = v_2 = v_3 = v_4$。问题大大简化。所有四个反应的耦合约束都必须对这个单一通量值 $v_{common}$ 成立：\n$$ y_j \\leq v_{common} \\leq 10 \\cdot y_j \\quad \\text{对于 } j=1, 2, 3, 4 $$\n\n我们现在可以根据 $v_{common}$ 的值来分析可能的情景。\n\n**情况 1：网络不活跃。**\n我们假设通过该通路的通量为零，$v_{common} = 0$。\n约束 $y_j \\leq v_{common}$ 变为 $y_j \\leq 0$。由于 $y_j$ 必须是 0 或 1，这强制所有 $j \\in \\{1, 2, 3, 4\\}$ 的 $y_j=0$。\n约束的右侧，$v_{common} \\leq 10 \\cdot y_j$，变为 $0 \\leq 10 \\cdot 0$，即 $0 \\leq 0$。这是满足的。\n所以，一个可行解是 $v_1=v_2=v_3=v_4=0$ 和 $y_1=y_2=y_3=y_4=0$。\n对于这个解，目标函数值为：\n$$ Z = y_2 + y_3 + (1 - y_4) = 0 + 0 + (1 - 0) = 1 $$\n\n**情况 2：网络活跃。**\n我们假设通过该通路的通量非零，$v_{common}  0$。\n约束 $v_{common} \\leq 10 \\cdot y_j$ 意味着如果 $y_j=0$，则 $v_{common} \\leq 0$。这与我们的假设 $v_{common}  0$ 相矛盾。因此，如果该通路是活跃的，我们必须有所有 $j \\in \\{1, 2, 3, 4\\}$ 的 $y_j=1$。\n当所有 $j$ 的 $y_j=1$ 时，耦合约束变为：\n$$ 1 \\leq v_{common} \\leq 10 $$\n在区间 $[1, 10]$ 中任意选择一个 $v_{common}$ 的值（例如，$v_{common}=5$）都构成一个所有反应均活跃的可行解。\n在这种情况下，我们有二元变量赋值 $y_1=1, y_2=1, y_3=1, y_4=1$。\n目标函数值为：\n$$ Z = y_2 + y_3 + (1 - y_4) = 1 + 1 + (1 - 1) = 2 $$\n\n**结论：**\n我们找到了两种可能类型的可行解，分别对应整个通路关闭或开启。\n-   如果通路关闭，目标值为 $1$。这个解与 $R_4$ 的低表达数据一致，但与 $R_2$ 和 $R_3$ 的高表达数据不一致。\n-   如果通路开启，目标值为 $2$。这个解与 $R_2$ 和 $R_3$ 的高表达数据一致，但与 $R_4$ 的低表达数据不一致。\n\nMILP 的目标是最大化目标函数。比较这两种情况，可实现的最大值为 $2$。这就是最优目标值。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}