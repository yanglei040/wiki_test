{
    "hands_on_practices": [
        {
            "introduction": "生物系统通常由复杂的相互作用网络构成，如图蛋白质相互作用网络。图卷积网络（GCN）为从这些结构化数据中学习提供了强大的框架。本练习将通过一个具体的计算任务，揭示GCN层中信息传播的核心机制，即一个节点如何聚合其邻近节点的信息，从而更新自身的状态。 这个过程对于理解GCN如何在生物网络上学习节点表示至关重要。",
            "id": "3299390",
            "problem": "考虑一个小的蛋白质信号网络，表示为一个无向图，其中节点对应于蛋白质，边表示实验观察到的物理相互作用。设该网络有$3$个蛋白质，标记为$P_1$、$P_2$和$P_3$，其对称邻接矩阵$\\mathbf{A}$由下式给出\n$$\n\\mathbf{A}=\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}.\n$$\n在图卷积网络（Graph Convolutional Network, GCN）中，信息通过自环和对称归一化进行传播。通过构建$\\tilde{\\mathbf{A}}=\\mathbf{A}+\\mathbf{I}$来添加自环，度矩阵$\\tilde{\\mathbf{D}}$定义为$\\tilde{D}_{ii}=\\sum_{j} \\tilde{A}_{ij}$。对称归一化使用算子$\\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2}$。节点特征矩阵$\\mathbf{H}\\in\\mathbb{R}^{3\\times 2}$为每个蛋白质收集了两个具有生物学意义的特征（例如，基础活性和磷酸化相关活性），层的权重矩阵为$\\mathbf{W}\\in\\mathbb{R}^{2\\times 1}$。非线性激活函数是修正线性单元（Rectified Linear Unit, ReLU），定义为$\\sigma(x)=\\max\\{0,x\\}$。\n\n假设初始节点特征矩阵和权重矩阵为\n$$\n\\mathbf{H}=\\begin{pmatrix}\n2  0 \\\\\n1  1 \\\\\n0  2\n\\end{pmatrix},\n\\qquad\n\\mathbf{W}=\\begin{pmatrix}\n1 \\\\\n-2\n\\end{pmatrix}.\n$$\n使用一个如上所述的、带有自环和对称归一化的GCN层，计算该层之后蛋白质$P_2$（第二个节点）的单个激活标量特征。请用封闭形式的实数精确表达你的答案。不需要四舍五入，也不需要单位。",
            "solution": "该问题要求计算在单个图卷积网络（GCN）层之后，蛋白质$P_2$的激活标量特征。该层的操作由以下传播规则定义：\n$$\n\\mathbf{H}' = \\sigma(\\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2} \\mathbf{H} \\mathbf{W})\n$$\n其中$\\mathbf{H}$是输入特征矩阵，$\\mathbf{W}$是权重矩阵，$\\sigma$是ReLU激活函数，而项$\\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2}$是带有自环的对称归一化邻接矩阵。\n\n首先，我们确定给定的矩阵。对于这个$3$蛋白质网络，邻接矩阵$\\mathbf{A}$为：\n$$\n\\mathbf{A}=\\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}\n$$\n初始节点特征矩阵$\\mathbf{H} \\in \\mathbb{R}^{3\\times 2}$和权重矩阵$\\mathbf{W} \\in \\mathbb{R}^{2\\times 1}$为：\n$$\n\\mathbf{H}=\\begin{pmatrix}\n2  0 \\\\\n1  1 \\\\\n0  2\n\\end{pmatrix},\n\\qquad\n\\mathbf{W}=\\begin{pmatrix}\n1 \\\\\n-2\n\\end{pmatrix}\n$$\n\n计算过程分为以下几个步骤：\n\n1.  **为邻接矩阵添加自环。**\n    这通过计算$\\tilde{\\mathbf{A}} = \\mathbf{A} + \\mathbf{I}$来完成，其中$\\mathbf{I}$是$3 \\times 3$的单位矩阵。\n    $$\n    \\tilde{\\mathbf{A}} = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix}\n    $$\n\n2.  **计算度矩阵$\\tilde{\\mathbf{D}}$。**\n    $\\tilde{\\mathbf{D}}$的对角线元素是$\\tilde{\\mathbf{A}}$的行和。\n    -   $\\tilde{D}_{11} = 1 + 1 + 0 = 2$\n    -   $\\tilde{D}_{22} = 1 + 1 + 1 = 3$\n    -   $\\tilde{D}_{33} = 0 + 1 + 1 = 2$\n    所以，度矩阵为：\n    $$\n    \\tilde{\\mathbf{D}} = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  2 \\end{pmatrix}\n    $$\n\n3.  **计算对称归一化的邻接矩阵$\\hat{\\mathbf{A}} = \\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2}$。**\n    首先，我们通过对$\\tilde{\\mathbf{D}}$的对角线元素取逆平方根来找到$\\tilde{\\mathbf{D}}^{-1/2}$。\n    $$\n    \\tilde{\\mathbf{D}}^{-1/2} = \\begin{pmatrix} 2^{-1/2}  0  0 \\\\ 0  3^{-1/2}  0 \\\\ 0  0  2^{-1/2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n    $$\n    现在我们执行矩阵乘法：\n    $$\n    \\hat{\\mathbf{A}} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n    $$\n    $$\n    \\hat{\\mathbf{A}} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}} \\\\ 0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n    $$\n    $$\n    \\hat{\\mathbf{A}} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{\\sqrt{6}}  0 \\\\ \\frac{1}{\\sqrt{6}}  \\frac{1}{3}  \\frac{1}{\\sqrt{6}} \\\\ 0  \\frac{1}{\\sqrt{6}}  \\frac{1}{2} \\end{pmatrix}\n    $$\n\n4.  **计算线性变换部分，$\\mathbf{Z} = \\hat{\\mathbf{A}}\\mathbf{H}\\mathbf{W}$。**\n    首先计算乘积$\\mathbf{X} = \\mathbf{H}\\mathbf{W}$在计算上更高效。\n    $$\n    \\mathbf{X} = \\begin{pmatrix} 2  0 \\\\ 1  1 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} (2)(1) + (0)(-2) \\\\ (1)(1) + (1)(-2) \\\\ (0)(1) + (2)(-2) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ -4 \\end{pmatrix}\n    $$\n    现在我们计算$\\mathbf{Z} = \\hat{\\mathbf{A}}\\mathbf{X}$。\n    $$\n    \\mathbf{Z} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{\\sqrt{6}}  0 \\\\ \\frac{1}{\\sqrt{6}}  \\frac{1}{3}  \\frac{1}{\\sqrt{6}} \\\\ 0  \\frac{1}{\\sqrt{6}}  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ -4 \\end{pmatrix}\n    $$\n    问题只要求蛋白质$P_2$的特征，它对应于最终输出向量的第二个元素。我们计算$\\mathbf{Z}$的第二个元素，记为$Z_2$。\n    $$\n    Z_2 = \\left(\\frac{1}{\\sqrt{6}}\\right)(2) + \\left(\\frac{1}{3}\\right)(-1) + \\left(\\frac{1}{\\sqrt{6}}\\right)(-4)\n    $$\n    $$\n    Z_2 = \\frac{2}{\\sqrt{6}} - \\frac{1}{3} - \\frac{4}{\\sqrt{6}} = -\\frac{2}{\\sqrt{6}} - \\frac{1}{3}\n    $$\n\n5.  **应用ReLU激活函数。**\n    激活函数是$\\sigma(x) = \\max\\{0, x\\}$。我们需要将此函数应用于$Z_2$。\n    $Z_2$的值是$-\\frac{2}{\\sqrt{6}} - \\frac{1}{3}$。由于两项都是负数，它们的和也是负数。\n    $$\n    Z_2  0\n    $$\n    蛋白质$P_2$的激活特征，记为$H'_{2}$，是：\n    $$\n    H'_{2} = \\sigma(Z_2) = \\max\\{0, -\\frac{2}{\\sqrt{6}} - \\frac{1}{3}\\} = 0\n    $$\n蛋白质$P_2$的单个激活标量特征是$0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在系统生物学中，我们构建的机理模型（如常微分方程）往往无法完全捕捉真实生物过程的复杂性。一种前沿的解决方法是利用神经网络来学习和弥补模型与现实之间的差距，即构建所谓的“神经残差模型”。本练习将模拟一个由经典基因调控开关（toggle switch）机理模型和一个多层感知机残差项组成的混合系统，通过计算单个前向欧拉步骤，让你亲身体验如何将先验生物学知识与数据驱动的深度学习模型相结合。",
            "id": "3299355",
            "problem": "考虑一个双基因触发开关，其中基因产物浓度 $x_1$ 和 $x_2$（无量纲单位）相互抑制。根据分子生物学的中心法则和唯象基因调控理论，一个受抑制基因的净生成速率可以使用一个Hill型抑制项和一个一阶降解项来建模。具体来说，假设其动力学由一个常微分方程 (ODE) 给出：$\\dot{x} = g(x)$，其中 $x = (x_1, x_2)^{\\top}$ 且\n$$\ng_1(x) = \\frac{\\alpha_1}{1 + x_2^{n}} - \\beta_1 x_1,\\qquad\ng_2(x) = \\frac{\\alpha_2}{1 + x_1^{m}} - \\beta_2 x_2,\n$$\n其中 $\\alpha_1$, $\\alpha_2$ 是最大合成速率，$\\beta_1$, $\\beta_2$ 是降解速率常数，$n$, $m$ 是Hill系数。假设我们在离散时间 $t_k = t_0 + k h$（具有恒定步长 $h  0$）观测该系统，并用一个神经残差来增强机理模型，以捕捉模型不匹配和未建模的效应。定义神经残差模型为\n$$\n\\dot{x} = g(x) + r_{\\theta}(x),\n$$\n其中 $r_{\\theta}(x)$ 是一个双层多层感知器 (MLP)，使用双曲正切激活函数，并由权重和偏置 $\\theta = \\{W_1, b_1, W_2, b_2\\}$ 参数化：\n$$\nr_{\\theta}(x) = W_2\\,\\tanh\\!\\big(W_1 x + b_1\\big) + b_2.\n$$\n假设触发开关的参数值如下：\n$$\n\\alpha_1 = 3,\\quad \\alpha_2 = 4,\\quad \\beta_1 = 1,\\quad \\beta_2 = 1.5,\\quad n = 2,\\quad m = 2,\n$$\n以及以下神经网络参数：\n$$\nW_1 = \\begin{pmatrix} 0.5  -0.3 \\\\ 0.2  0.4 \\end{pmatrix},\\quad\nb_1 = \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix},\\quad\nW_2 = \\begin{pmatrix} 0.7  -0.1 \\\\ 0.05  0.6 \\end{pmatrix},\\quad\nb_2 = \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}.\n$$\n给定当前离散观测值 $x_k = \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix}$ 和步长 $h = 0.05$，请根据上述定义明确地构建 $g(x)$ 和 $r_{\\theta}(x)$，然后使用与采样方案一致的一阶离散化方法计算单步前向更新 $x_{k+1}$。将最终向量的每个分量四舍五入到四位有效数字。浓度使用无量纲单位。",
            "solution": "该问题陈述具有科学依据、形式适定、客观且内容自洽，提出了一个在机器学习增强的系统生物学领域内有效的计算任务。所有必要的参数和初始条件都已提供，以计算出唯一解。\n\n系统动力学由一个神经普通微分方程 (ODE) 描述：\n$$\n\\dot{x} = F(x) = g(x) + r_{\\theta}(x)\n$$\n其中 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 表示两种基因产物的浓度。$g(x)$ 项是双基因触发开关的机理模型，$r_{\\theta}(x)$ 项是神经残差项。\n\n问题要求使用步长为 $h$ 的“一阶离散化”方法，从时间 $t_k$ 的当前状态 $x_k$ 计算下一个状态 $x_{k+1}$。这对应于前向欧拉法：\n$$\nx_{k+1} = x_k + h F(x_k) = x_k + h \\left( g(x_k) + r_{\\theta}(x_k) \\right)\n$$\n\n给定当前状态 $x_k = \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix}$ 和步长 $h = 0.05$。我们首先计算该状态下的机理项 $g(x_k)$ 和神经残差项 $r_{\\theta}(x_k)$。\n\n**步骤1：计算机理项 $g(x_k)$**\n\n$g(x)$ 的分量由下式给出：\n$$\ng_1(x) = \\frac{\\alpha_1}{1 + x_2^{n}} - \\beta_1 x_1, \\qquad g_2(x) = \\frac{\\alpha_2}{1 + x_1^{m}} - \\beta_2 x_2\n$$\n机理模型的参数为 $\\alpha_1 = 3$, $\\alpha_2 = 4$, $\\beta_1 = 1$, $\\beta_2 = 1.5$, $n = 2$ 和 $m = 2$。我们将这些值以及 $x_k = (x_{k,1}, x_{k,2})^{\\top} = (1.2, 0.8)^{\\top}$ 的分量代入：\n$$\ng_1(x_k) = \\frac{3}{1 + (0.8)^{2}} - (1)(1.2) = \\frac{3}{1 + 0.64} - 1.2 = \\frac{3}{1.64} - 1.2 \\approx 1.829268 - 1.2 = 0.629268\n$$\n$$\ng_2(x_k) = \\frac{4}{1 + (1.2)^{2}} - (1.5)(0.8) = \\frac{4}{1 + 1.44} - 1.2 = \\frac{4}{2.44} - 1.2 \\approx 1.639344 - 1.2 = 0.439344\n$$\n因此，机理速率向量为：\n$$\ng(x_k) \\approx \\begin{pmatrix} 0.629268 \\\\ 0.439344 \\end{pmatrix}\n$$\n\n**步骤2：计算神经残差项 $r_{\\theta}(x_k)$**\n\n神经残差由一个双层MLP定义：\n$$\nr_{\\theta}(x) = W_2\\,\\tanh\\!\\big(W_1 x + b_1\\big) + b_2\n$$\n我们使用给定的网络参数计算 $x_k$ 处的该表达式。首先，我们计算激活前向量 $z = W_1 x_k + b_1$：\n$$\nz = \\begin{pmatrix} 0.5  -0.3 \\\\ 0.2  0.4 \\end{pmatrix} \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} (0.5)(1.2) + (-0.3)(0.8) \\\\ (0.2)(1.2) + (0.4)(0.8) \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix}\n$$\n$$\nz = \\begin{pmatrix} 0.6 - 0.24 \\\\ 0.24 + 0.32 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} 0.36 \\\\ 0.56 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} 0.46 \\\\ 0.36 \\end{pmatrix}\n$$\n接下来，我们应用逐元素的双曲正切激活函数 $a = \\tanh(z)$：\n$$\na = \\begin{pmatrix} \\tanh(0.46) \\\\ \\tanh(0.36) \\end{pmatrix} \\approx \\begin{pmatrix} 0.430080 \\\\ 0.345260 \\end{pmatrix}\n$$\n最后，我们计算网络的输出 $r_{\\theta}(x_k) = W_2 a + b_2$：\n$$\nr_{\\theta}(x_k) = \\begin{pmatrix} 0.7  -0.1 \\\\ 0.05  0.6 \\end{pmatrix} \\begin{pmatrix} 0.430080 \\\\ 0.345260 \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}\n$$\n$$\nr_{\\theta}(x_k) \\approx \\begin{pmatrix} (0.7)(0.430080) + (-0.1)(0.345260) \\\\ (0.05)(0.430080) + (0.6)(0.345260) \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}\n$$\n$$\nr_{\\theta}(x_k) \\approx \\begin{pmatrix} 0.301056 - 0.034526 \\\\ 0.021504 + 0.207156 \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.266530 \\\\ 0.228660 \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.276530 \\\\ 0.208660 \\end{pmatrix}\n$$\n\n**步骤3：计算前向欧拉更新**\n\n我们现在计算总变化率向量 $F(x_k) = g(x_k) + r_{\\theta}(x_k)$：\n$$\nF(x_k) \\approx \\begin{pmatrix} 0.629268 \\\\ 0.439344 \\end{pmatrix} + \\begin{pmatrix} 0.276530 \\\\ 0.208660 \\end{pmatrix} = \\begin{pmatrix} 0.905798 \\\\ 0.648004 \\end{pmatrix}\n$$\n我们用它通过前向欧拉法找到下一个状态 $x_{k+1}$：\n$$\nx_{k+1} = x_k + h F(x_k) \\approx \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix} + 0.05 \\begin{pmatrix} 0.905798 \\\\ 0.648004 \\end{pmatrix}\n$$\n$$\nx_{k+1} \\approx \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix} + \\begin{pmatrix} 0.045290 \\\\ 0.032400 \\end{pmatrix} = \\begin{pmatrix} 1.245290 \\\\ 0.832400 \\end{pmatrix}\n$$\n\n**步骤4：四舍五入到四位有效数字**\n\n最后一步是按要求将 $x_{k+1}$ 的每个分量四舍五入到四位有效数字。\n第一个分量是 $1.245290$，四舍五入为 $1.245$。\n第二个分量是 $0.832400$，四舍五入为 $0.8324$。\n因此，更新后的状态向量为：\n$$\nx_{k+1} \\approx \\begin{pmatrix} 1.245 \\\\ 0.8324 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.245 \\\\ 0.8324 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在生物学研究中，区分“相关性”与“因果性”至关重要，尤其是在预测基因敲降等干预实验的结果时。一个仅在观测数据上训练的标准预测模型可能会得出误导性的结论，因为它无法区分直接因果效应和由未观测的混杂变量（如细胞环境）引起的相关性。本练习通过一个简化的基因调控结构因果模型（SCM），让你计算并比较干预性期望（$do$算子）与观测性条件期望的差异，从而深刻理解为何因果推断对于设计和解释生物干预实验是必不可少的。",
            "id": "3299366",
            "problem": "考虑一个基因调控模块，它被建模为一个具有已知有向无环图 (DAG) 的线性结构因果模型 (SCM)。该 DAG 包含节点 $C$（一个未被观测的细胞环境背景变量）、$G_1$（一个受到敲降的转录因子）、$G_2$（一个下游基因）和 $Y$（一个表型输出）。其有向边为 $C \\rightarrow G_1$、$C \\rightarrow Y$、$G_1 \\rightarrow G_2$、$G_1 \\rightarrow Y$ 和 $G_2 \\rightarrow Y$。该 SCM 由以下线性高斯结构方程指定：\n$$\nC \\sim \\mathcal{N}(\\mu_C,\\sigma_C^2), \\quad G_1 = a_{CG_1} C + \\varepsilon_1, \\quad G_2 = a_{12} G_1 + \\varepsilon_2, \\quad Y = b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y,\n$$\n其中 $\\varepsilon_1 \\sim \\mathcal{N}(0,\\sigma_1^2)$、$\\varepsilon_2 \\sim \\mathcal{N}(0,\\sigma_2^2)$ 和 $\\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)$ 是相互独立的，并且也独立于 $C$。所有变量代表稳态水平，以一致的无量纲相对表达或活性单位进行度量。\n\n给定以下数值参数：$\\mu_C = 0.5$，$\\sigma_C^2 = 1.0$，$a_{CG_1} = 1.3$，$\\sigma_1^2 = 0.4$，$a_{12} = 0.8$，$\\sigma_2^2 = 0.3$，$b_{2Y} = 2.0$，$b_{1Y} = 0.5$，$b_{CY} = 1.1$，以及 $\\sigma_Y^2 = 0.2$。\n\n一次系统性敲降将转录因子 $G_1$ 设定在固定水平 $g^* = 0.2$。使用 SCM 干预分布的截断因子分解定义，推导此次敲降的干预期望 $\\mathbb{E}[Y \\mid do(G_1 = g^*)]$。\n\n另外，考虑一个深度神经预测器，它纯粹基于观测数据对 $(G_1,Y)$ 进行训练，以最小化期望平方误差。假设数据无限且容量足够大，使得学习到的预测器收敛于观测条件期望 $\\mathbb{E}[Y \\mid G_1 = g^*]$。在给定的 SCM 下推导这个观测期望。\n\n最后，计算在敲降下，观测预测器与干预效应之间的数值差异，定义为\n$$\n\\Delta \\equiv \\mathbb{E}[Y \\mid G_1 = g^*] - \\mathbb{E}[Y \\mid do(G_1 = g^*)].\n$$\n提供 $\\Delta$ 的值，它是一个无量纲实数。将你的答案四舍五入到四位有效数字。",
            "solution": "在尝试提供解决方案之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n\n所提供的信息包含一个基因调控模块的结构因果模型 (SCM)，由一个有向无环图 (DAG) 和一组线性高斯结构方程描述。\n\nDAG 中的节点是 $C$（未观测的细胞环境背景）、$G_1$（转录因子）、$G_2$（下游基因）和 $Y$（表型输出）。\n有向边为 $C \\rightarrow G_1$、$C \\rightarrow Y$、$G_1 \\rightarrow G_2$、$G_1 \\rightarrow Y$ 和 $G_2 \\rightarrow Y$。\n\n结构方程如下：\n$$\nC \\sim \\mathcal{N}(\\mu_C,\\sigma_C^2)\n$$\n$$\nG_1 = a_{CG_1} C + \\varepsilon_1, \\quad \\varepsilon_1 \\sim \\mathcal{N}(0,\\sigma_1^2)\n$$\n$$\nG_2 = a_{12} G_1 + \\varepsilon_2, \\quad \\varepsilon_2 \\sim \\mathcal{N}(0,\\sigma_2^2)\n$$\n$$\nY = b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y, \\quad \\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)\n$$\n噪声项 $\\varepsilon_1$、$\\varepsilon_2$ 和 $\\varepsilon_Y$ 相互独立，并且也独立于 $C$。\n\n给定的数值参数如下：\n$\\mu_C = 0.5$，$\\sigma_C^2 = 1.0$，$a_{CG_1} = 1.3$，$\\sigma_1^2 = 0.4$，$a_{12} = 0.8$，$\\sigma_2^2 = 0.3$，$b_{2Y} = 2.0$，$b_{1Y} = 0.5$，$b_{CY} = 1.1$，以及 $\\sigma_Y^2 = 0.2$。\n\n问题指定了对 $G_1$ 的干预，将其值设定为常数 $g^* = 0.2$。这表示为 $do(G_1 = g^*)$。\n\n目标是计算数值差异 $\\Delta \\equiv \\mathbb{E}[Y \\mid G_1 = g^*] - \\mathbb{E}[Y \\mid do(G_1 = g^*)]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据以下验证标准对问题进行评估：\n1.  **科学依据：** 该问题基于结构因果模型 (SCM) 和 Pearl 的 do-演算这一成熟框架，这些是因果推断和计算系统生物学中的标准工具。线性高斯假设是一个常见且易于解析处理的模型实例。观测分布和干预分布之间的区别是因果关系中的核心概念。该问题在科学上是合理的。\n2.  **适定性：** 所有必需的参数、结构方程和分布均已提供。目标定义清晰，并能得出一个唯一、可计算的结果。该问题是适定的。\n3.  **客观性：** 问题以精确的数学语言陈述，没有任何主观或有偏见的措辞。\n4.  **完整性：** 问题是自洽的，并提供了所有需要的信息。\n5.  **一致性：** 结构方程与指定的 DAG 一致。没有矛盾之处。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将推导解决方案。\n\n### 干预期望的推导\n\n干预期望 $\\mathbb{E}[Y \\mid do(G_1 = g^*)]$ 是使用一个修改后的 SCM 计算的。$do(G_1 = g^*)$ 操作将 $G_1$ 的结构方程替换为赋值 $G_1 = g^*$，从而有效地移除了其父节点 $C$ 的影响。\n\n修改后的 SCM 为：\n$C \\sim \\mathcal{N}(\\mu_C, \\sigma_C^2)$\n$G_1 = g^*$\n$G_2 = a_{12} G_1 + \\varepsilon_2 = a_{12} g^* + \\varepsilon_2$\n$Y = b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y$\n\n我们在这个新模型下计算 $Y$ 的期望。根据期望的线性性质：\n$$\n\\mathbb{E}[Y \\mid do(G_1 = g^*)] = \\mathbb{E}[b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y]\n$$\n$$\n= b_{2Y} \\mathbb{E}[G_2] + b_{1Y} \\mathbb{E}[G_1] + b_{CY} \\mathbb{E}[C] + \\mathbb{E}[\\varepsilon_Y]\n$$\n各个组成部分的期望是：\n- $\\mathbb{E}[G_1] = g^*$（因为 $G_1$ 是一个常数）。\n- $C$ 的分布不受对其子节点 $G_1$ 的干预影响，所以 $\\mathbb{E}[C] = \\mu_C$。\n- 噪声项的均值为零，$\\mathbb{E}[\\varepsilon_Y] = 0$。\n- $\\mathbb{E}[G_2] = \\mathbb{E}[a_{12} g^* + \\varepsilon_2] = a_{12} g^* + \\mathbb{E}[\\varepsilon_2] = a_{12} g^*$。\n\n将这些代入 $Y$ 的期望方程：\n$$\n\\mathbb{E}[Y \\mid do(G_1 = g^*)] = b_{2Y} (a_{12} g^*) + b_{1Y} g^* + b_{CY} \\mu_C\n$$\n$$\n= (a_{12}b_{2Y} + b_{1Y}) g^* + b_{CY} \\mu_C\n$$\n这个表达式代表了将 $G_1$ 设定为 $g^*$ 对 $Y$ 的因果效应。\n\n### 观测条件期望的推导\n\n观测条件期望 $\\mathbb{E}[Y \\mid G_1 = g^*]$ 是使用原始、未修改的 SCM 计算的。其前提是，一个在无限观测数据上训练以最小化平方误差的预测器将收敛到这个量。\n$$\n\\mathbb{E}[Y \\mid G_1 = g^*] = \\mathbb{E}[b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y \\mid G_1 = g^*]\n$$\n使用条件期望的线性性质：\n$$\n= b_{2Y} \\mathbb{E}[G_2 \\mid G_1 = g^*] + b_{1Y} \\mathbb{E}[G_1 \\mid G_1 = g^*] + b_{CY} \\mathbb{E}[C \\mid G_1 = g^*] + \\mathbb{E}[\\varepsilon_Y \\mid G_1 = g^*]\n$$\n我们计算每一项：\n- $\\mathbb{E}[G_1 \\mid G_1 = g^*] = g^*$。\n- 由于 $\\varepsilon_Y$ 独立于所有其他变量，所以 $\\mathbb{E}[\\varepsilon_Y \\mid G_1 = g^*] = \\mathbb{E}[\\varepsilon_Y] = 0$。\n- $G_2 = a_{12}G_1 + \\varepsilon_2$。由于 $\\varepsilon_2$ 独立于 $C$ 和 $\\varepsilon_1$，因此它也独立于 $G_1$。所以，$\\mathbb{E}[G_2 \\mid G_1 = g^*] = \\mathbb{E}[a_{12}G_1 + \\varepsilon_2 \\mid G_1 = g^*] = a_{12}g^* + \\mathbb{E}[\\varepsilon_2] = a_{12}g^*$。\n- 关键项是 $\\mathbb{E}[C \\mid G_1 = g^*]$。$C$ 和 $G_1$ 服从联合高斯分布，因为 $G_1$ 是 $C$ 和一个独立高斯噪声项的线性函数。\n$(C, G_1)$ 的联合分布是二元正态分布。该分布的参数为：\n$\\mathbb{E}[C] = \\mu_C$\n$\\text{Var}(C) = \\sigma_C^2$\n$\\mathbb{E}[G_1] = \\mathbb{E}[a_{CG_1}C + \\varepsilon_1] = a_{CG_1}\\mathbb{E}[C] + \\mathbb{E}[\\varepsilon_1] = a_{CG_1}\\mu_C$\n$\\text{Var}(G_1) = \\text{Var}(a_{CG_1}C + \\varepsilon_1) = a_{CG_1}^2 \\text{Var}(C) + \\text{Var}(\\varepsilon_1) = a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2$\n$\\text{Cov}(C, G_1) = \\text{Cov}(C, a_{CG_1}C + \\varepsilon_1) = a_{CG_1}\\text{Var}(C) = a_{CG_1}\\sigma_C^2$\n\n在二元正态系统中，条件期望的公式为：\n$$\n\\mathbb{E}[C \\mid G_1 = g^*] = \\mathbb{E}[C] + \\frac{\\text{Cov}(C, G_1)}{\\text{Var}(G_1)} (g^* - \\mathbb{E}[G_1])\n$$\n代入推导出的参数：\n$$\n\\mathbb{E}[C \\mid G_1 = g^*] = \\mu_C + \\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\n$$\n组合成 $\\mathbb{E}[Y \\mid G_1 = g^*]$ 的完整表达式：\n$$\n\\mathbb{E}[Y \\mid G_1 = g^*] = b_{2Y}(a_{12}g^*) + b_{1Y}g^* + b_{CY}\\left(\\mu_C + \\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\\right)\n$$\n$$\n= (a_{12}b_{2Y} + b_{1Y})g^* + b_{CY}\\mu_C + b_{CY}\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\n$$\n这个表达式代表了基于观测到 $G_1=g^*$ 而对 $Y$ 做出的预测，其中包含了来自未观测共同原因 $C$ 的混杂偏倚。\n\n### 差异 $\\Delta$ 的计算\n\n差异 $\\Delta$ 是观测预测值减去干预效应。\n$$\n\\Delta = \\mathbb{E}[Y \\mid G_1 = g^*] - \\mathbb{E}[Y \\mid do(G_1 = g^*)]\n$$\n将两个推导出的表达式相减：\n$$\n\\Delta = \\left[(a_{12}b_{2Y} + b_{1Y})g^* + b_{CY}\\mu_C + b_{CY}\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\\right] - \\left[(a_{12}b_{2Y} + b_{1Y}) g^* + b_{CY} \\mu_C\\right]\n$$\n公共项相互抵消，只剩下混杂偏倚项：\n$$\n\\Delta = b_{CY}\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\n$$\n该项源于“后门路径”$G_1 \\leftarrow C \\rightarrow Y$。观测到 $G_1$ 使得我们可以推断未观测混杂因素 $C$ 的状态，而 $C$ 也影响 $Y$。\n\n### 数值计算\n\n我们将给定的数值代入 $\\Delta$ 的表达式中：\n$\\mu_C = 0.5$，$\\sigma_C^2 = 1.0$，$a_{CG_1} = 1.3$，$\\sigma_1^2 = 0.4$，$b_{CY} = 1.1$，以及 $g^* = 0.2$。\n\n首先，计算表达式的各个部分：\n项 $(g^* - a_{CG_1}\\mu_C)$：\n$$\n0.2 - (1.3 \\times 0.5) = 0.2 - 0.65 = -0.45\n$$\n分数项 $\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2}$：\n$$\n\\frac{1.3 \\times 1.0}{(1.3)^2 \\times 1.0 + 0.4} = \\frac{1.3}{1.69 + 0.4} = \\frac{1.3}{2.09}\n$$\n现在，组合计算 $\\Delta$：\n$$\n\\Delta = 1.1 \\times \\left(\\frac{1.3}{2.09}\\right) \\times (-0.45)\n$$\n$$\n\\Delta = \\frac{1.1 \\times 1.3 \\times (-0.45)}{2.09} = \\frac{-0.6435}{2.09}\n$$\n$$\n\\Delta \\approx -0.3078947368...\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta = -0.3079$。",
            "answer": "$$\n\\boxed{-0.3079}\n$$"
        }
    ]
}