{
    "hands_on_practices": [
        {
            "introduction": "随机森林中的每棵决策树都是通过一系列分裂（split）构建的。算法如何决定使用哪个特征和哪个阈值来划分数据呢？本练习将带你深入了解这一核心机制，通过计算基尼不纯度（Gini impurity）的下降值来评估不同分裂方案的优劣。掌握这一基本计算是理解包括随机森林在内的所有树模型如何从数据中学习的关键一步 。",
            "id": "3342859",
            "problem": "一项计算系统生物学的联合研究试图基于基因 $X$ 的单个归一化信使核糖核酸(mRNA)表达特征，来预测一个癌细胞系是药物敏感型还是药物抗性型。作为训练随机森林(RF)分类器的一个子程序，一个二元分裂在这个连续特征上使用基尼不纯度准则进行评估。对于一个在两个类别（敏感 s，抗性 r）上具有经验类别分布 $\\mathbf{p} = (p_{\\text{s}}, p_{\\text{r}})$ 的节点，基尼不纯度定义为 $G(\\mathbf{p}) = 1 - \\sum_{k} p_{k}^{2}$。一次分裂的不纯度减少量定义为父节点的不纯度减去预期的分裂后不纯度，其中期望是根据样本落入每个子节点的经验概率计算的。\n\n给定一个大小为 $N = 120$ 的父节点，其类别计数为（48个敏感型，72个抗性型）。基因 $X$ 表达的四个候选阈值产生以下左/右子节点的类别计数，其中每个阈值 $t$ 将表达值 $\\leq t$ 的样本发送到左子节点，其余的样本发送到右子节点：\n\n- 阈值 $t = 3.0$：左子节点 $(6, 18)$，右子节点 $(42, 54)$。\n- 阈值 $t = 5.5$：左子节点 $(18, 30)$，右子节点 $(30, 42)$。\n- 阈值 $t = 7.0$：左子节点 $(30, 40)$，右子节点 $(18, 32)$。\n- 阈值 $t = 8.5$：左子节点 $(40, 55)$，右子节点 $(8, 17)$。\n\n仅从基尼不纯度的定义以及“预期的分裂后不纯度等于按其经验样本比例加权的子节点不纯度”这一原则（即，将全概率定律应用于节点成员身份）出发，计算每个候选阈值的不纯度减少量 $\\Delta G$，并找出最佳分裂（即最大化 $\\Delta G$ 的分裂）。作为您的最终答案，请提供最大不纯度减少量 $\\Delta G_{\\max}$ 的精确值，表示为一个最简有理数。不要包含单位，也不要四舍五入。",
            "solution": "该问题要求基于基尼不纯度减少准则，评估决策树中一个数据集节点的四个候选分裂。目标是找出使这个减少量最大化的分裂，并提供该最大减少量的精确值。\n\n对于一个有 $C$ 个类别，经验类别比例为 $\\mathbf{p} = (p_1, p_2, \\ldots, p_C)$ 的节点，基尼不纯度由以下公式给出：\n$$G(\\mathbf{p}) = 1 - \\sum_{k=1}^{C} p_{k}^{2}$$\n对于二元分裂，不纯度减少量（记为 $\\Delta G$）是父节点的不纯度与两个子节点不纯度的加权平均值之差：\n$$\\Delta G = G_{\\text{parent}} - \\left( \\frac{N_{\\text{left}}}{N} G_{\\text{left}} + \\frac{N_{\\text{right}}}{N} G_{\\text{right}} \\right)$$\n其中 $N$ 是父节点中的样本总数，$N_{\\text{left}}$ 和 $N_{\\text{right}}$ 分别是左、右子节点中的样本数。\n\n首先，我们计算父节点的基尼不纯度 $G_{\\text{parent}}$。\n父节点的总样本大小为 $N=120$，其中“敏感”类的计数为 $N_s = 48$，“抗性”类的计数为 $N_r = 72$。\n类别比例为：\n$p_s = \\frac{48}{120} = \\frac{2}{5}$ 和 $p_r = \\frac{72}{120} = \\frac{3}{5}$。\n父节点的基尼不纯度为：\n$$G_{\\text{parent}} = 1 - \\left( \\left(\\frac{2}{5}\\right)^2 + \\left(\\frac{3}{5}\\right)^2 \\right) = 1 - \\left( \\frac{4}{25} + \\frac{9}{25} \\right) = 1 - \\frac{13}{25} = \\frac{12}{25}$$\n\n接下来，我们评估四个候选分裂中的每一个。\n\n**1. 阈值 $t = 3.0$**\n- 左子节点: $(6, 18)$, $N_L=24$。$G_L = 1 - ((\\frac{6}{24})^2 + (\\frac{18}{24})^2) = 1 - ((\\frac{1}{4})^2 + (\\frac{3}{4})^2) = 1 - \\frac{1+9}{16} = \\frac{6}{16} = \\frac{3}{8}$。\n- 右子节点: $(42, 54)$, $N_R=96$。$G_R = 1 - ((\\frac{42}{96})^2 + (\\frac{54}{96})^2) = 1 - ((\\frac{7}{16})^2 + (\\frac{9}{16})^2) = 1 - \\frac{49+81}{256} = \\frac{126}{256} = \\frac{63}{128}$。\n- 不纯度减少量: $\\Delta G_1 = \\frac{12}{25} - \\left(\\frac{24}{120}\\cdot\\frac{3}{8} + \\frac{96}{120}\\cdot\\frac{63}{128}\\right) = \\frac{12}{25} - \\left(\\frac{1}{5}\\cdot\\frac{3}{8} + \\frac{4}{5}\\cdot\\frac{63}{128}\\right) = \\frac{12}{25} - \\left(\\frac{3}{40} + \\frac{63}{160}\\right) = \\frac{12}{25} - \\frac{12+63}{160} = \\frac{12}{25} - \\frac{75}{160} = \\frac{12}{25} - \\frac{15}{32} = \\frac{384 - 375}{800} = \\frac{9}{800}$。\n\n**2. 阈值 $t = 5.5$**\n- 左子节点: $(18, 30)$, $N_L=48$。$G_L = 1 - ((\\frac{18}{48})^2 + (\\frac{30}{48})^2) = 1 - ((\\frac{3}{8})^2 + (\\frac{5}{8})^2) = 1 - \\frac{9+25}{64} = \\frac{30}{64} = \\frac{15}{32}$。\n- 右子节点: $(30, 42)$, $N_R=72$。$G_R = 1 - ((\\frac{30}{72})^2 + (\\frac{42}{72})^2) = 1 - ((\\frac{5}{12})^2 + (\\frac{7}{12})^2) = 1 - \\frac{25+49}{144} = \\frac{70}{144} = \\frac{35}{72}$。\n- 不纯度减少量: $\\Delta G_2 = \\frac{12}{25} - \\left(\\frac{48}{120}\\cdot\\frac{15}{32} + \\frac{72}{120}\\cdot\\frac{35}{72}\\right) = \\frac{12}{25} - \\left(\\frac{2}{5}\\cdot\\frac{15}{32} + \\frac{3}{5}\\cdot\\frac{35}{72}\\right) = \\frac{12}{25} - \\left(\\frac{3}{16} + \\frac{7}{24}\\right) = \\frac{12}{25} - \\frac{9+14}{48} = \\frac{12}{25} - \\frac{23}{48} = \\frac{576 - 575}{1200} = \\frac{1}{1200}$。\n\n**3. 阈值 $t = 7.0$**\n- 左子节点: $(30, 40)$, $N_L=70$。$G_L = 1 - ((\\frac{30}{70})^2 + (\\frac{40}{70})^2) = 1 - ((\\frac{3}{7})^2 + (\\frac{4}{7})^2) = 1 - \\frac{9+16}{49} = \\frac{24}{49}$。\n- 右子节点: $(18, 32)$, $N_R=50$。$G_R = 1 - ((\\frac{18}{50})^2 + (\\frac{32}{50})^2) = 1 - ((\\frac{9}{25})^2 + (\\frac{16}{25})^2) = 1 - \\frac{81+256}{625} = \\frac{288}{625}$。\n- 不纯度减少量: $\\Delta G_3 = \\frac{12}{25} - \\left(\\frac{70}{120}\\cdot\\frac{24}{49} + \\frac{50}{120}\\cdot\\frac{288}{625}\\right) = \\frac{12}{25} - \\left(\\frac{7}{12}\\cdot\\frac{24}{49} + \\frac{5}{12}\\cdot\\frac{288}{625}\\right) = \\frac{12}{25} - \\left(\\frac{2}{7} + \\frac{24}{125}\\right) = \\frac{12}{25} - \\frac{250+168}{875} = \\frac{12}{25} - \\frac{418}{875} = \\frac{420 - 418}{875} = \\frac{2}{875}$。\n\n**4. 阈值 $t = 8.5$**\n- 左子节点: $(40, 55)$, $N_L=95$。$G_L = 1 - ((\\frac{40}{95})^2 + (\\frac{55}{95})^2) = 1 - ((\\frac{8}{19})^2 + (\\frac{11}{19})^2) = 1 - \\frac{64+121}{361} = \\frac{176}{361}$。\n- 右子节点: $(8, 17)$, $N_R=25$。$G_R = 1 - ((\\frac{8}{25})^2 + (\\frac{17}{25})^2) = 1 - \\frac{64+289}{625} = \\frac{272}{625}$。\n- 不纯度减少量: $\\Delta G_4 = \\frac{12}{25} - \\left(\\frac{95}{120}\\cdot\\frac{176}{361} + \\frac{25}{120}\\cdot\\frac{272}{625}\\right) = \\frac{12}{25} - \\left(\\frac{19}{24}\\cdot\\frac{176}{19^2} + \\frac{5}{24}\\cdot\\frac{272}{5^4}\\right) = \\frac{12}{25} - (\\frac{176}{24 \\cdot 19} + \\frac{272}{24 \\cdot 125}) = \\frac{12}{25} - (\\frac{22}{57} + \\frac{34}{375}) = \\frac{12}{25} - \\frac{1132}{2375} = \\frac{1140-1132}{2375} = \\frac{8}{2375}$。\n\n最后，我们比较这四个不纯度减少值以找到最大值。\n$\\Delta G_1 = \\frac{9}{800} = 0.01125$\n$\\Delta G_2 = \\frac{1}{1200} \\approx 0.000833$\n$\\Delta G_3 = \\frac{2}{875} \\approx 0.002286$\n$\\Delta G_4 = \\frac{8}{2375} \\approx 0.003368$\n最大值为 $\\Delta G_1$。\n因此，最佳分裂在阈值 $t = 3.0$ 处，最大不纯度减少量为 $\\Delta G_{\\max} = \\frac{9}{800}$。该分数已为最简形式。",
            "answer": "$$\\boxed{\\frac{9}{800}}$$"
        },
        {
            "introduction": "在理解了单个分裂的原理后，我们自然会问：如何量化一个特征对于整棵决策树的总体贡献？本练习将介绍平均不纯度减少（Mean Decrease in Impurity, MDI）这一重要的特征重要性度量。通过汇总特定特征在树中所有分裂节点上带来的不纯度减少量，MDI为我们提供了一个衡量该特征在模型构建中作用大小的指标，从而将我们对模型机制的理解从微观的单次分裂提升到宏观的全局视角 。",
            "id": "3342894",
            "problem": "一个计算系统生物学实验室正在使用随机森林分类器，基于分子测量将单细胞分层为两种表型类别：类别标签为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示通路激活状态，$Y=0$ 表示非激活状态。每个细胞测量两个特征：$x_{1}$ 是一个转录因子的对数转换表达量，$x_{2}$ 是一个通路基因的启动子甲基化分数。考虑该森林中的一棵决策树，它在一个包含 $N_{\\text{total}} = 100$ 个细胞的数据集上进行训练，所有细胞的样本权重均相等。\n\n该树具有以下结构。根节点（表示为 $t_{0}$）基于特征 $x_{1}$ 在阈值 $\\tau_{1}$ 处分裂，将 $N_{L}(t_{0}) = 50$ 个细胞分到左侧，将 $N_{R}(t_{0}) = 50$ 个细胞分到右侧。$t_{0}$ 及其子节点的类别计数如下：\n- 在 $t_{0}$ 处：$(Y=1,Y=0)$ 的计数为 $(55,45)$。\n- 左子节点 $t_{1}$：$(Y=1,Y=0)$ 的计数为 $(40,10)$；节点 $t_{1}$ 进一步基于特征 $x_{2}$ 在阈值 $\\tau_{2}$ 处分裂。\n- 右子节点 $t_{2}$：$(Y=1,Y=0)$ 的计数为 $(15,35)$；节点 $t_{2}$ 进一步基于特征 $x_{1}$ 在阈值 $\\tau'_{1}$ 处分裂。\n\n这些后续分裂产生的终端叶节点具有以下类别计数和样本大小：\n- 从 $t_{1}$ （基于 $x_{2}$ 分裂）产生：$t_{3}$ 的样本大小为 $N(t_{3}) = 30$，计数为 $(30,0)$；$t_{4}$ 的样本大小为 $N(t_{4}) = 20$，计数为 $(10,10)$。\n- 从 $t_{2}$ （基于 $x_{1}$ 分裂）产生：$t_{5}$ 的样本大小为 $N(t_{5}) = 20$，计数为 $(10,10)$；$t_{6}$ 的样本大小为 $N(t_{6}) = 30$，计数为 $(5,25)$。\n\n假设节点的不纯度由基尼不纯度量化，对于具有类别概率 $\\{p_{k}(t)\\}_{k \\in \\{0,1\\}}$ 的节点 $t$，定义为 $G(t) = 1 - \\sum_{k \\in \\{0,1\\}} p_{k}(t)^{2}$。特征 $x_{j}$ 的平均不纯度减少量（MDI）特征重要性，是对所有使用 $x_{j}$ 的分裂节点，由这些分裂引起的不纯度减少量进行聚合，并按到达每个分裂节点的总训练样本比例进行加权。终端叶节点不计入贡献。\n\n仅使用这些定义和提供的数据，计算此单棵树的平均不纯度减少量 $VI^{\\text{MDI}}(x_{1})$ 和 $VI^{\\text{MDI}}(x_{2})$，无需对特征进行任何事后归一化。请用精确值将最终答案表示为一个二元行矩阵 $\\big[VI^{\\text{MDI}}(x_{1}) \\;\\; VI^{\\text{MDI}}(x_{2})\\big]$；不要四舍五入。",
            "solution": "该问题要求计算单棵决策树中两个特征 $x_1$ 和 $x_2$ 的平均不纯度减少量（MDI）特征重要性。MDI的计算公式为：\n$$VI^{\\text{MDI}}(x_{j}) = \\sum_{t \\text{ a node that splits on } x_{j}} \\frac{N(t)}{N_{\\text{total}}} \\Delta G(t)$$\n其中，$N(t)$ 是节点 $t$ 的样本数，$N_{\\text{total}}$ 是总样本数，$\\Delta G(t)$ 是节点 $t$ 分裂带来的基尼不纯度减少量。$\\Delta G(t)$ 的计算公式为：\n$$\\Delta G(t) = G(t) - \\frac{N_{L}(t)}{N(t)}G(t_{L}) - \\frac{N_{R}(t)}{N(t)}G(t_{R})$$\n一个节点 $t$ 的基尼不纯度 $G(t)$ 对于二分类问题（类别0和1）计算如下，其中 $p_0$ 和 $p_1$ 是类别比例：\n$$G(t) = 1 - (p_0^2 + p_1^2)$$\n\n**第1步：计算所有相关节点的基尼不纯度**\n\n-   **根节点 $t_0$**: 计数 $(Y=1: 55, Y=0: 45)$，$N(t_0)=100$。\n    $G(t_0) = 1 - \\left( (\\frac{55}{100})^2 + (\\frac{45}{100})^2 \\right) = 1 - \\left( (\\frac{11}{20})^2 + (\\frac{9}{20})^2 \\right) = 1 - \\frac{121+81}{400} = 1 - \\frac{202}{400} = \\frac{198}{400} = \\frac{99}{200}$。\n\n-   **节点 $t_1$**: 计数 $(40, 10)$，$N(t_1)=50$。\n    $G(t_1) = 1 - \\left( (\\frac{40}{50})^2 + (\\frac{10}{50})^2 \\right) = 1 - \\left( (\\frac{4}{5})^2 + (\\frac{1}{5})^2 \\right) = 1 - \\frac{16+1}{25} = \\frac{8}{25}$。\n\n-   **节点 $t_2$**: 计数 $(15, 35)$，$N(t_2)=50$。\n    $G(t_2) = 1 - \\left( (\\frac{15}{50})^2 + (\\frac{35}{50})^2 \\right) = 1 - \\left( (\\frac{3}{10})^2 + (\\frac{7}{10})^2 \\right) = 1 - \\frac{9+49}{100} = \\frac{42}{100} = \\frac{21}{50}$。\n\n-   **叶节点 $t_3$**: 计数 $(30, 0)$。$G(t_3) = 1 - 1^2 = 0$。\n-   **叶节点 $t_4$**: 计数 $(10, 10)$。$G(t_4) = 1 - ((\\frac{1}{2})^2 + (\\frac{1}{2})^2) = \\frac{1}{2}$。\n-   **叶节点 $t_5$**: 计数 $(10, 10)$。$G(t_5) = \\frac{1}{2}$。\n-   **叶节点 $t_6$**: 计数 $(5, 25)$。$G(t_6) = 1 - ((\\frac{5}{30})^2 + (\\frac{25}{30})^2) = 1 - ((\\frac{1}{6})^2 + (\\frac{5}{6})^2) = 1 - \\frac{1+25}{36} = \\frac{10}{36} = \\frac{5}{18}$。\n\n**第2步：计算每个分裂节点的MDI贡献**\n\n-   **在 $t_0$ 的分裂 (基于 $x_1$)**:\n    权重: $\\frac{N(t_0)}{N_{\\text{total}}} = \\frac{100}{100} = 1$。\n    不纯度减少量 $\\Delta G(t_0) = G(t_0) - \\left(\\frac{N(t_1)}{N(t_0)}G(t_1) + \\frac{N(t_2)}{N(t_0)}G(t_2)\\right)$\n    $\\Delta G(t_0) = \\frac{99}{200} - \\left(\\frac{50}{100}\\cdot\\frac{8}{25} + \\frac{50}{100}\\cdot\\frac{21}{50}\\right) = \\frac{99}{200} - \\left(\\frac{1}{2}\\cdot\\frac{8}{25} + \\frac{1}{2}\\cdot\\frac{21}{50}\\right) = \\frac{99}{200} - \\frac{4}{25} - \\frac{21}{100} = \\frac{99 - 32 - 42}{200} = \\frac{25}{200} = \\frac{1}{8}$。\n    对 $VI^{\\text{MDI}}(x_1)$ 的贡献是 $1 \\times \\frac{1}{8} = \\frac{1}{8}$。\n\n-   **在 $t_1$ 的分裂 (基于 $x_2$)**:\n    权重: $\\frac{N(t_1)}{N_{\\text{total}}} = \\frac{50}{100} = \\frac{1}{2}$。\n    不纯度减少量 $\\Delta G(t_1) = G(t_1) - \\left(\\frac{N(t_3)}{N(t_1)}G(t_3) + \\frac{N(t_4)}{N(t_1)}G(t_4)\\right)$\n    $\\Delta G(t_1) = \\frac{8}{25} - \\left(\\frac{30}{50}\\cdot 0 + \\frac{20}{50}\\cdot\\frac{1}{2}\\right) = \\frac{8}{25} - \\frac{2}{5}\\cdot\\frac{1}{2} = \\frac{8}{25} - \\frac{1}{5} = \\frac{3}{25}$。\n    对 $VI^{\\text{MDI}}(x_2)$ 的贡献是 $\\frac{1}{2} \\times \\frac{3}{25} = \\frac{3}{50}$。\n\n-   **在 $t_2$ 的分裂 (基于 $x_1$)**:\n    权重: $\\frac{N(t_2)}{N_{\\text{total}}} = \\frac{50}{100} = \\frac{1}{2}$。\n    不纯度减少量 $\\Delta G(t_2) = G(t_2) - \\left(\\frac{N(t_5)}{N(t_2)}G(t_5) + \\frac{N(t_6)}{N(t_2)}G(t_6)\\right)$\n    $\\Delta G(t_2) = \\frac{21}{50} - \\left(\\frac{20}{50}\\cdot\\frac{1}{2} + \\frac{30}{50}\\cdot\\frac{5}{18}\\right) = \\frac{21}{50} - \\frac{1}{5} - \\frac{3}{5}\\cdot\\frac{5}{18} = \\frac{21}{50} - \\frac{1}{5} - \\frac{1}{6} = \\frac{63 - 30 - 25}{150} = \\frac{8}{150} = \\frac{4}{75}$。\n    对 $VI^{\\text{MDI}}(x_1)$ 的贡献是 $\\frac{1}{2} \\times \\frac{4}{75} = \\frac{2}{75}$。\n\n**第3步：聚合每个特征的重要性**\n\n-   **特征 $x_1$**:\n    $VI^{\\text{MDI}}(x_1) = (\\text{来自 } t_0 \\text{ 的贡献}) + (\\text{来自 } t_2 \\text{ 的贡献}) = \\frac{1}{8} + \\frac{2}{75} = \\frac{75 + 16}{600} = \\frac{91}{600}$。\n\n-   **特征 $x_2$**:\n    $VI^{\\text{MDI}}(x_2) = (\\text{来自 } t_1 \\text{ 的贡献}) = \\frac{3}{50}$。\n\n最终结果以行矩阵形式表示为 $\\big[VI^{\\text{MDI}}(x_{1}) \\;\\; VI^{\\text{MDI}}(x_{2})\\big] = \\big[\\frac{91}{600} \\;\\; \\frac{3}{50}\\big]$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{91}{600} & \\frac{3}{50} \\end{pmatrix}}$$"
        },
        {
            "introduction": "MDI是基于模型内部结构来评估特征重要性的，但我们也可以从另一个角度来思考：如果一个特征的信息被破坏，模型的预测性能会下降多少？本练习将引导你探索一种功能强大且与模型无关的技术——置换特征重要性（permutation feature importance）。你将利用袋外（Out-of-Bag, OOB）样本来评估模型的预测误差，然后通过置换某一特征的数值来破坏其与目标变量的关联，并观察误差的增加程度，以此来判断该特征的重要性 。这项实践不仅展示了与MDI不同的评估方法，还通过计算重要性估计的方差，揭示了模型稳定性的重要概念，这在实际应用中是至关重要的考量。",
            "id": "3342911",
            "problem": "考虑一个简化的计算系统生物学分类任务，其中训练一个随机森林 (RF) 分类器，以从基因表达特征 $(G_1,G_2,G_3)$ 中区分表型 $y \\in \\{0,1\\}$。该随机森林包含 $T=3$ 棵决策树，这些决策树是使用自助重采样方法从一个包含 $N=6$ 个样本的数据集中训练得到的。该数据集为\n$i=1: (x_{11},x_{12},x_{13};y_1)=(1.0,5.5,6.0;1)$，\n$i=2: (x_{21},x_{22},x_{23};y_2)=(2.5,3.0,7.5;1)$，\n$i=3: (x_{31},x_{32},x_{33};y_3)=(3.5,6.5,5.5;1)$，\n$i=4: (x_{41},x_{42},x_{43};y_4)=(1.5,2.5,4.0;0)$，\n$i=5: (x_{51},x_{52},x_{53};y_5)=(4.0,4.5,6.5;0)$，\n$i=6: (x_{61},x_{62},x_{63};y_6)=(2.0,5.0,3.5;0)$，\n其中 $x_{i1}$、$x_{i2}$ 和 $x_{i3}$ 分别表示 $G_1$、$G_2$ 和 $G_3$ 的测量表达量。\n\n这三棵树在以下自助样本（训练样本的索引列表，有放回抽样）上进行训练：对于树 $t=1$，$B_1 = [1,2,5,5,6,6]$；对于树 $t=2$，$B_2 = [1,3,3,4,6,6]$；对于树 $t=3$，$B_3 = [2,2,3,5,5,6]$。对于树 $t$ 的袋外 (OOB) 集是补集 $O_t=\\{1,\\dots,N\\}\\setminus B_t$（忽略重复项）：因此 $O_1=\\{3,4\\}$，$O_2=\\{2,5\\}$，$O_3=\\{1,4\\}$。\n\n每棵训练好的树根据以下规则确定性地预测一个类别 $\\hat{y}_t(x)$：\n- 树 $t=1$：如果 $x_{2} \\ge 5.0$，则预测 $\\hat{y}_1(x)=1$，否则预测 $\\hat{y}_1(x)=0$。\n- 树 $t=2$：如果 $x_{3} \\ge 6.0$，则预测 $\\hat{y}_2(x)=1$；否则如果 $x_{2} \\ge 4.0$，则预测 $\\hat{y}_2(x)=1$；否则预测 $\\hat{y}_2(x)=0$。\n- 树 $t=3$：如果 $x_{1} \\le 2.0$，则预测 $\\hat{y}_3(x)=0$；否则如果 $x_{2} \\ge 6.0$，则预测 $\\hat{y}_3(x)=1$；否则预测 $\\hat{y}_3(x)=0$。\n\n将树 $t$ 的 OOB 错分率定义为 $L_t^{\\mathrm{OOB}}=\\frac{1}{|O_t|}\\sum_{i\\in O_t}\\mathbf{1}\\{\\hat{y}_t(x_i)\\ne y_i\\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。为了评估基因 $G_2$（记为 $j=2$）的置换重要性，根据以下映射，在每棵树的 OOB 集内对 $x_{i2}$ 值执行一次 OOB 置换：\n- 对于 $t=1$ 在 $O_1=\\{3,4\\}$ 上，交换 $x_{32}$ 和 $x_{42}$，使得置换后的值为 $x_{32}^{\\pi}=2.5$ 和 $x_{42}^{\\pi}=6.5$。\n- 对于 $t=2$ 在 $O_2=\\{2,5\\}$ 上，交换 $x_{22}$ 和 $x_{52}$，使得 $x_{22}^{\\pi}=4.5$ 和 $x_{52}^{\\pi}=3.0$。\n- 对于 $t=3$ 在 $O_3=\\{1,4\\}$ 上，交换 $x_{12}$ 和 $x_{42}$，使得 $x_{12}^{\\pi}=2.5$ 和 $x_{42}^{\\pi}=5.5$。\n\n使用这些置换后的值（并保持所有其他特征 $x_{i1}$ 和 $x_{i3}$ 不变），计算置换后的 OOB 错分率 $L_t^{\\mathrm{perm}}=\\frac{1}{|O_t|}\\sum_{i\\in O_t}\\mathbf{1}\\{\\hat{y}_t(x_i^{\\pi})\\ne y_i\\}$，其中对于 $i\\in O_t$，$x_i^{\\pi}$ 是将 $x_{i2}$ 替换为 $x_{i2}^{\\pi}$ 后的结果。对于每棵树，定义单次置换重要性增量 $\\Delta_t=L_t^{\\mathrm{perm}}-L_t^{\\mathrm{OOB}}$。\n\n最后，计算：\n- 聚合重要性 $\\bar{\\Delta}=\\frac{1}{T}\\sum_{t=1}^{T}\\Delta_t$；以及\n- 树间的无偏样本方差 $s^2=\\frac{1}{T-1}\\sum_{t=1}^{T}\\left(\\Delta_t-\\bar{\\Delta}\\right)^2$。\n\n以二元行矩阵 $\\begin{pmatrix} \\bar{\\Delta}  s^2 \\end{pmatrix}$ 的形式报告你的最终答案，在适当情况下使用有理数，无需四舍五入。在你的解答中，从每棵树单次 OOB 置换所导致的重要性估计不确定性的角度，简要解释 $s^2$ 相对于 $\\bar{\\Delta}$ 的大小。",
            "solution": "该问题要求我们计算基因 $G_2$ 的置换特征重要性，具体是计算聚合重要性增量 $\\bar{\\Delta}$ 及其树间样本方差 $s^2$。为此，我们需要为森林中的每棵树计算其袋外（OOB）错分率 $L_t^{\\mathrm{OOB}}$ 和置换特征后的错分率 $L_t^{\\mathrm{perm}}$。\n\n**第1步：为树 $t=1$ 计算 $\\Delta_1$**\n- **决策规则**: 如果 $x_2 \\ge 5.0$，预测1；否则预测0。\n- **OOB集**: $O_1=\\{3,4\\}$。样本为 $x_3=(..., 6.5, ...; y_3=1)$ 和 $x_4=(..., 2.5, ...; y_4=0)$。\n- **计算 $L_1^{\\mathrm{OOB}}$**:\n    - 样本3: $x_{32} = 6.5 \\ge 5.0 \\implies \\hat{y}_1(x_3)=1$。与 $y_3=1$ 匹配，无错。\n    - 样本4: $x_{42} = 2.5  5.0 \\implies \\hat{y}_1(x_4)=0$。与 $y_4=0$ 匹配，无错。\n    - $L_1^{\\mathrm{OOB}} = \\frac{0+0}{2} = 0$。\n- **计算 $L_1^{\\mathrm{perm}}$**:\n    置换后的值为 $x_{32}^{\\pi}=2.5, x_{42}^{\\pi}=6.5$。\n    - 样本3: $x_{32}^{\\pi} = 2.5  5.0 \\implies \\hat{y}_1(x_3^{\\pi})=0$。与 $y_3=1$ 不匹配，错误。\n    - 样本4: $x_{42}^{\\pi} = 6.5 \\ge 5.0 \\implies \\hat{y}_1(x_4^{\\pi})=1$。与 $y_4=0$ 不匹配，错误。\n    - $L_1^{\\mathrm{perm}} = \\frac{1+1}{2} = 1$。\n- **计算 $\\Delta_1$**: $\\Delta_1 = L_1^{\\mathrm{perm}} - L_1^{\\mathrm{OOB}} = 1 - 0 = 1$。\n\n**第2步：为树 $t=2$ 计算 $\\Delta_2$**\n- **决策规则**: 如果 $x_3 \\ge 6.0$，预测1；否则如果 $x_2 \\ge 4.0$，预测1；否则预测0。\n- **OOB集**: $O_2=\\{2,5\\}$。样本为 $x_2=(..., 3.0, 7.5; y_2=1)$ 和 $x_5=(..., 4.5, 6.5; y_5=0)$。\n- **计算 $L_2^{\\mathrm{OOB}}$**:\n    - 样本2: $x_{23} = 7.5 \\ge 6.0 \\implies \\hat{y}_2(x_2)=1$。与 $y_2=1$ 匹配，无错。\n    - 样本5: $x_{53} = 6.5 \\ge 6.0 \\implies \\hat{y}_2(x_5)=1$。与 $y_5=0$ 不匹配，错误。\n    - $L_2^{\\mathrm{OOB}} = \\frac{0+1}{2} = \\frac{1}{2}$。\n- **计算 $L_2^{\\mathrm{perm}}$**:\n    置换后的值为 $x_{22}^{\\pi}=4.5, x_{52}^{\\pi}=3.0$。\n    - 样本2: $x_{23} = 7.5 \\ge 6.0 \\implies \\hat{y}_2(x_2^{\\pi})=1$。预测不受 $x_2$ 置换的影响。与 $y_2=1$ 匹配，无错。\n    - 样本5: $x_{53} = 6.5 \\ge 6.0 \\implies \\hat{y}_2(x_5^{\\pi})=1$。预测不受 $x_2$ 置换的影响。与 $y_5=0$ 不匹配，错误。\n    - $L_2^{\\mathrm{perm}} = \\frac{0+1}{2} = \\frac{1}{2}$。\n- **计算 $\\Delta_2$**: $\\Delta_2 = L_2^{\\mathrm{perm}} - L_2^{\\mathrm{OOB}} = \\frac{1}{2} - \\frac{1}{2} = 0$。\n\n**第3步：为树 $t=3$ 计算 $\\Delta_3$**\n- **决策规则**: 如果 $x_1 \\le 2.0$，预测0；否则如果 $x_2 \\ge 6.0$，预测1；否则预测0。\n- **OOB集**: $O_3=\\{1,4\\}$。样本为 $x_1=(1.0, 5.5, ...; y_1=1)$ 和 $x_4=(1.5, 2.5, ...; y_4=0)$。\n- **计算 $L_3^{\\mathrm{OOB}}$**:\n    - 样本1: $x_{11} = 1.0 \\le 2.0 \\implies \\hat{y}_3(x_1)=0$。与 $y_1=1$ 不匹配，错误。\n    - 样本4: $x_{41} = 1.5 \\le 2.0 \\implies \\hat{y}_3(x_4)=0$。与 $y_4=0$ 匹配，无错。\n    - $L_3^{\\mathrm{OOB}} = \\frac{1+0}{2} = \\frac{1}{2}$。\n- **计算 $L_3^{\\mathrm{perm}}$**:\n    置换后的值为 $x_{12}^{\\pi}=2.5, x_{42}^{\\pi}=5.5$。\n    - 样本1: $x_{11} = 1.0 \\le 2.0 \\implies \\hat{y}_3(x_1^{\\pi})=0$。预测不受 $x_2$ 置换的影响。与 $y_1=1$ 不匹配，错误。\n    - 样本4: $x_{41} = 1.5 \\le 2.0 \\implies \\hat{y}_3(x_4^{\\pi})=0$。预测不受 $x_2$ 置换的影响。与 $y_4=0$ 匹配，无错。\n    - $L_3^{\\mathrm{perm}} = \\frac{1+0}{2} = \\frac{1}{2}$。\n- **计算 $\\Delta_3$**: $\\Delta_3 = L_3^{\\mathrm{perm}} - L_3^{\\mathrm{OOB}} = \\frac{1}{2} - \\frac{1}{2} = 0$。\n\n**第4步：聚合结果**\n重要性增量为 $\\Delta_1=1, \\Delta_2=0, \\Delta_3=0$。\n- **聚合重要性 $\\bar{\\Delta}$**:\n  $$ \\bar{\\Delta} = \\frac{1}{3}\\sum_{t=1}^{3}\\Delta_t = \\frac{1}{3}(1+0+0) = \\frac{1}{3} $$\n- **树间无偏样本方差 $s^2$**:\n  $$ s^2 = \\frac{1}{3-1}\\sum_{t=1}^{3}\\left(\\Delta_t-\\bar{\\Delta}\\right)^2 = \\frac{1}{2}\\left[ \\left(1-\\frac{1}{3}\\right)^2 + \\left(0-\\frac{1}{3}\\right)^2 + \\left(0-\\frac{1}{3}\\right)^2 \\right] $$\n  $$ s^2 = \\frac{1}{2}\\left[ \\left(\\frac{2}{3}\\right)^2 + \\left(-\\frac{1}{3}\\right)^2 + \\left(-\\frac{1}{3}\\right)^2 \\right] = \\frac{1}{2}\\left( \\frac{4}{9} + \\frac{1}{9} + \\frac{1}{9} \\right) = \\frac{1}{2}\\left( \\frac{6}{9} \\right) = \\frac{1}{3} $$\n\n**解释**:\n基因 $G_2$ 的平均重要性估计为 $\\bar{\\Delta} = 1/3$。这个估计在三棵树间的样本方差为 $s^2 = 1/3$，对应的样本标准差为 $s = \\sqrt{1/3} \\approx 0.577$。方差与均值大小相近（标准差大于均值）表明该重要性估计具有非常高的不确定性。这种不稳定性源于随机过程中的多个环节，尤其是在每棵树上只使用了一个非常小的OOB集（仅2个样本）并执行单次置换。结果显示，三棵树中有两棵的重要性增量为零，而另一棵的增量为1，这种剧烈波动导致了高方差。这表明基于当前计算得出的 $\\bar{\\Delta}$ 估计是不可靠的，需要更多的树和/或在每棵树上进行多次置换才能获得一个更稳定的特征重要性度量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3}  \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}