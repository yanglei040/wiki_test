{
    "hands_on_practices": [
        {
            "introduction": "评估生成对抗网络（GAN）的一个核心任务是比较生成数据与真实数据的分布。像Fréchet初始距离（FID）这样的常用指标，其基础是假设数据为高斯分布时的Wasserstein距离。这个练习  将引导你从第一性原理出发，推导并计算这一距离，从而帮助你建立对这些评估指标工作原理的直观理解，并认识到它们的局限性。",
            "id": "3316104",
            "problem": "一个计算系统生物学小组正在训练一个生成对抗网络 (GAN)，用于合成两个标记基因的低维基因表达向量。为了评估真实样本和合成样本之间的分布相似性，他们决定使用一种类似于 Fréchet Inception 距离 (FID) 的 Fréchet 式准则。在 FID 背后的标准建模假设下，真实数据和合成数据的特征分布可以用具有匹配一阶矩和二阶矩的多元正态分布来近似。\n\n设真实基因表达向量被建模为均值为 $ \\mu_{r} \\in \\mathbb{R}^{2} $、协方差为 $ \\Sigma_{r} \\in \\mathbb{R}^{2 \\times 2} $ 的多元正态分布，合成基因表达向量被建模为均值为 $ \\mu_{s} \\in \\mathbb{R}^{2} $、协方差为 $ \\Sigma_{s} \\in \\mathbb{R}^{2 \\times 2} $ 的多元正态分布，其中两个协方差矩阵都是对称正定的。\n\n从具有有限二阶矩的两个概率测度之间带二次传输成本的平方 $2$-Wasserstein 距离的定义出发，并仅使用上述高斯性假设以及关于对称正定矩阵的标准线性代数知识，完成以下任务：\n\n1. 推导 $ \\mathcal{N}(\\mu_{r}, \\Sigma_{r}) $ 和 $ \\mathcal{N}(\\mu_{s}, \\Sigma_{s}) $ 之间平方距离的闭式解析表达式，用 $ \\mu_{r}, \\mu_{s}, \\Sigma_{r}, \\Sigma_{s} $ 表示。\n\n2. 对以下参数计算该平方距离，这些参数来自于对一个留出验证集的经验估计：\n   - $ \\mu_{r} = \\begin{pmatrix} 5 \\\\ 8 \\end{pmatrix} $, $ \\Sigma_{r} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} $,\n   - $ \\mu_{s} = \\begin{pmatrix} 4 \\\\ 10 \\end{pmatrix} $, $ \\Sigma_{s} = \\begin{pmatrix} \\tfrac{1}{2}  0 \\\\ 0  2 \\end{pmatrix} $.\n\n3. 基于建模假设的第一性原理，简要指出单细胞基因表达数据中对高斯性的偏离以及协方差结构，在用于评估 GAN 时，相对于通常证明 Fréchet Inception 距离合理性的那些假设，可能以至少两种方式使该度量产生偏差。\n\n将第 2 部分的数值作为最终答案报告。以精确形式表示答案，不要近似或四舍五入。不需要单位。",
            "solution": "在尝试任何解答之前，对问题陈述的有效性进行严格评估。\n\n### 第 1 步：提取已知条件\n- 背景是评估一个用于合成二维基因表达向量的生成对抗网络 (GAN)。\n- 真实数据向量被建模为来自多元正态分布 $\\mathcal{N}(\\mu_{r}, \\Sigma_{r})$ 的样本。\n- 合成数据向量被建模为来自多元正态分布 $\\mathcal{N}(\\mu_{s}, \\Sigma_{s})$ 的样本。\n- 均值为 $\\mu_{r} \\in \\mathbb{R}^{2}$ 和 $\\mu_{s} \\in \\mathbb{R}^{2}$。\n- 协方差矩阵为 $\\Sigma_{r} \\in \\mathbb{R}^{2 \\times 2}$ 和 $\\Sigma_{s} \\in \\mathbb{R}^{2 \\times 2}$，并且是对称正定的。\n- 任务是推导这两个高斯分布之间的平方 $2$-Wasserstein 距离。\n- 任务是为特定参数计算此距离：\n  - $\\mu_{r} = \\begin{pmatrix} 5 \\\\ 8 \\end{pmatrix}$\n  - $\\Sigma_{r} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$\n  - $\\mu_{s} = \\begin{pmatrix} 4 \\\\ 10 \\end{pmatrix}$\n  - $\\Sigma_{s} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  2 \\end{pmatrix}$\n- 任务是指出当该度量应用于可能非高斯分布的真实基因表达数据时，其存在的两个潜在偏差。\n- 最终答案是评估部分计算出的平方距离的数值。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础（关键）**：该问题具有科学基础。使用 Wasserstein 距离比较概率分布是数学和统计学中的标准技术。它应用于比较真实数据和生成数据的分布，尤其是在高斯假设下（如在 Fréchet Inception 距离，或 FID 中），是现代机器学习评估生成模型的基石。其计算系统生物学的背景适合此类建模。\n- **良构的**：该问题是良构的。它要求推导一个已知的、唯一的解析公式。它为后续计算提供了所有必要的数值数据。第三部分的概念性问题很精确，要求分析模型的局限性，这是科学中标准的批判性思维练习。\n- **客观性（关键）**：问题以客观、正式且无歧义的语言陈述。\n- 该问题未表现出无效标准中列出的任何缺陷。诸如高斯性之类的假设被明确说明为待用模型的一部分，并且任务的一部分就是评判这些假设。所提供的矩阵是对称正定的（对角线元素为正，非对角线元素为零），确保所有必需的矩阵运算（例如，平方根）都是良定义的。\n\n### 第 3 步：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解答\n\n该问题要求三个部分：推导、计算和概念分析。最终需要的答案是计算的结果。\n\n#### 第 1 部分：两个高斯分布之间平方 $2$-Wasserstein 距离的推导\n\n设两个多元正态分布为 $P_r = \\mathcal{N}(\\mu_{r}, \\Sigma_{r})$ 和 $P_s = \\mathcal{N}(\\mu_{s}, \\Sigma_{s})$。它们之间的平方 $2$-Wasserstein 距离由下式给出：\n$$\nW_2^2(P_r, P_s) = \\inf_{\\gamma \\in \\Gamma(P_r, P_s)} \\int_{\\mathbb{R}^d \\times \\mathbb{R}^d} \\|x-y\\|_2^2 \\, d\\gamma(x,y)\n$$\n其中 $\\Gamma(P_r, P_s)$ 是 $\\mathbb{R}^d \\times \\mathbb{R}^d$ 上所有以 $P_r$ 和 $P_s$ 为边缘分布的联合概率测度的集合。对于高斯分布，这有一个闭式解。实现这个下确界的最优传输方案对应于一个仿射映射。也就是说，如果一个随机变量 $X \\sim P_r$，那么最优传输的随机变量 $Y$ 由 $Y = \\mu_s + A(X - \\mu_r)$ 给出，其中 $A$ 是一个为最小化期望平方距离而选择的特定矩阵。为了使 $Y$ 具有分布 $P_s$，它的均值必须是 $\\mu_s$，协方差必须是 $\\Sigma_s$。均值通过构造得到满足：$\\mathbb{E}[Y] = \\mu_s + A(\\mathbb{E}[X] - \\mu_r) = \\mu_s$。协方差为 $\\text{Cov}(Y) = A \\text{Cov}(X) A^T = A \\Sigma_r A^T$。我们需要 $A \\Sigma_r A^T = \\Sigma_s$。最小化传输成本的 $A$ 的解是唯一的且是正定的，由 $A = \\Sigma_r^{-1/2} (\\Sigma_r^{1/2} \\Sigma_s \\Sigma_r^{1/2})^{1/2} \\Sigma_r^{-1/2}$ 给出。\n\n那么平方距离就是 $\\|X - Y\\|_2^2$ 的期望值：\n$$\nW_2^2(P_r, P_s) = \\mathbb{E}[\\|X - Y\\|_2^2] = \\mathbb{E}[\\|(X - \\mu_r) - (\\mu_s - \\mu_r) - A(X - \\mu_r)\\|_2^2]\n$$\n$$\nW_2^2(P_r, P_s) = \\mathbb{E}[\\|(I-A)(X-\\mu_r) - (\\mu_s-\\mu_r)\\|_2^2]\n$$\n展开范数并利用期望的线性性：\n$$\nW_2^2(P_r, P_s) = \\mathbb{E}[\\|(I-A)(X-\\mu_r)\\|_2^2] + \\|\\mu_s-\\mu_r\\|_2^2 - 2\\mathbb{E}[(\\mu_s-\\mu_r)^T(I-A)(X-\\mu_r)]\n$$\n交叉项为零，因为 $\\mathbb{E}[X-\\mu_r] = 0$。第一项可以用迹来写：\n$$\n\\mathbb{E}[\\|(I-A)(X-\\mu_r)\\|_2^2] = \\mathbb{E}[\\text{Tr}((X-\\mu_r)^T(I-A)^T(I-A)(X-\\mu_r))]\n$$\n$$\n= \\text{Tr}(\\mathbb{E}[(I-A)^T(I-A)(X-\\mu_r)(X-\\mu_r)^T]) = \\text{Tr}((I-A)^T(I-A)\\Sigma_r)\n$$\n因为 $A$ 的构造只涉及对称矩阵，所以 $A$ 是对称的 ($A^T=A$)，这可以简化为：\n$$\n\\text{Tr}((I-A)\\Sigma_r(I-A)) = \\text{Tr}(\\Sigma_r - 2A\\Sigma_r + A\\Sigma_rA)\n$$\n根据协方差匹配条件 $A \\Sigma_r A^T = \\Sigma_s$ 和 $A=A^T$，我们有 $A \\Sigma_r A = \\Sigma_s$。表达式变为：\n$$\n\\text{Tr}(\\Sigma_r + \\Sigma_s - 2A\\Sigma_r)\n$$\n利用迹的循环性质和 $A$ 的表达式：\n$$\n\\text{Tr}(A\\Sigma_r) = \\text{Tr}(\\Sigma_r^{-1/2} (\\Sigma_r^{1/2} \\Sigma_s \\Sigma_r^{1/2})^{1/2} \\Sigma_r^{-1/2} \\Sigma_r) = \\text{Tr}(\\Sigma_r^{-1/2} (\\Sigma_r^{1/2} \\Sigma_s \\Sigma_r^{1/2})^{1/2} \\Sigma_r^{1/2})\n$$\n$$\n= \\text{Tr}(\\Sigma_r^{1/2} \\Sigma_r^{-1/2} (\\Sigma_r^{1/2} \\Sigma_s \\Sigma_r^{1/2})^{1/2}) = \\text{Tr}((\\Sigma_r^{1/2} \\Sigma_s \\Sigma_r^{1/2})^{1/2})\n$$\n合并所有项，平方 $2$-Wasserstein 距离为：\n$$\nW_2^2(\\mathcal{N}(\\mu_{r}, \\Sigma_{r}), \\mathcal{N}(\\mu_{s}, \\Sigma_{s})) = \\|\\mu_{r} - \\mu_{s}\\|_2^2 + \\text{Tr}(\\Sigma_{r} + \\Sigma_{s} - 2(\\Sigma_{r}^{1/2} \\Sigma_{s} \\Sigma_{r}^{1/2})^{1/2})\n$$\n\n#### 第 2 部分：对给定参数的计算\n\n给定的参数是：\n- $\\mu_{r} = \\begin{pmatrix} 5 \\\\ 8 \\end{pmatrix}$，$\\mu_{s} = \\begin{pmatrix} 4 \\\\ 10 \\end{pmatrix}$\n- $\\Sigma_{r} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$，$\\Sigma_{s} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  2 \\end{pmatrix}$\n\n我们计算推导出的公式中的两项。\n\n首先，均值差的平方范数：\n$$\n\\mu_{r} - \\mu_{s} = \\begin{pmatrix} 5 - 4 \\\\ 8 - 10 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n$$\n$$\n\\|\\mu_{r} - \\mu_{s}\\|_2^2 = (1)^2 + (-2)^2 = 1 + 4 = 5\n$$\n\n其次，迹项。由于 $\\Sigma_{r}$ 和 $\\Sigma_{s}$ 是对角矩阵，所有派生出的矩阵（如平方根）也将是对角的，这大大简化了计算。\n$\\Sigma_r$ 的平方根是：\n$$\n\\Sigma_{r}^{1/2} = \\begin{pmatrix} \\sqrt{2}  0 \\\\ 0  \\sqrt{1} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2}  0 \\\\ 0  1 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $\\Sigma_{r}^{1/2} \\Sigma_{s} \\Sigma_{r}^{1/2}$：\n$$\n\\Sigma_{r}^{1/2} \\Sigma_{s} \\Sigma_{r}^{1/2} = \\begin{pmatrix} \\sqrt{2}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} \\sqrt{2}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2} \\cdot \\frac{1}{2} \\cdot \\sqrt{2}  0 \\\\ 0  1 \\cdot 2 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}\n$$\n现在，我们取这个结果矩阵的平方根：\n$$\n(\\Sigma_{r}^{1/2} \\Sigma_{s} \\Sigma_{r}^{1/2})^{1/2} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}^{1/2} = \\begin{pmatrix} \\sqrt{1}  0 \\\\ 0  \\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{2} \\end{pmatrix}\n$$\n现在我们计算迹的参数：\n$$\n\\Sigma_{r} + \\Sigma_{s} - 2(\\Sigma_{r}^{1/2} \\Sigma_{s} \\Sigma_{r}^{1/2})^{1/2} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  2 \\end{pmatrix} - 2\\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{2} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 2 + \\frac{1}{2} - 2(1)  0 \\\\ 0  1 + 2 - 2\\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{2} - 2  0 \\\\ 0  3 - 2\\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  3 - 2\\sqrt{2} \\end{pmatrix}\n$$\n这个矩阵的迹是其对角线元素之和：\n$$\n\\text{Tr}(\\dots) = \\frac{1}{2} + 3 - 2\\sqrt{2} = \\frac{7}{2} - 2\\sqrt{2}\n$$\n最后，我们将这两个分量相加，求得平方距离：\n$$\nW_2^2 = 5 + \\left(\\frac{7}{2} - 2\\sqrt{2}\\right) = \\frac{10}{2} + \\frac{7}{2} - 2\\sqrt{2} = \\frac{17}{2} - 2\\sqrt{2}\n$$\n\n#### 第 3 部分：该度量用于基因表达数据的潜在偏差\n\n基于匹配高斯近似的前两阶矩的类 Fréchet 距离，由于其基本假设被违背，在评估用于单细胞基因表达数据的 GAN 时，可能成为一个有偏或信息量不足的度量。\n\n1.  **违反高斯性假设（多峰性和稀疏性）**：真实的单细胞基因表达数据从根本上说不是高斯的。它的特点是高度稀疏（许多基因在许多细胞中的表达值为零的比例很高）和显著的多峰性。这种多峰性反映了离散细胞类型或状态的存在，它们是基因表达空间中的不同聚类。一个只考虑均值和协方差的度量对这种峰态结构是“盲目”的。一个 GAN 可能会生成一个单峰的、类高斯的合成数据云，它完美地匹配了真实双峰分布的均值和协方差。在这种情况下，Fréchet 距离会具有欺骗性地低（表明拟合得很好），而实际上 GAN 完全没有学到数据中最关键的生物学特征：不同的细胞群体。这导致对真实分布和合成分布之间的真实差异的系统性低估。\n\n2.  **对非线性相关性和流形结构不敏感**：协方差矩阵只捕捉变量之间的线性相关性。生物系统，如基因调控网络，受复杂的非线性动力学支配。因此，基因表达数据通常位于高维基因空间内的一个低维非线性流形上或其附近。Fréchet 距离依赖于线性（仿射）最优传输映射和欧几里得空间中的二次成本函数，因此对这些流形的几何形状不敏感。一个 GAN 可能生成具有正确均值和线性协方差结构的数据，但其数据点却偏离了真实的生物学流形。例如，真实数据可能位于一个弯曲的“香蕉”形状上，而 GAN 生成了一个椭圆云。该度量将无法充分惩罚这种拓扑和几何上的不匹配，从而对一个生成生物学上不合理细胞状态的模型给出了误导性的有利评估。这是一个关键的失败，因为在生物数据合成中，保持数据的流形结构通常是一个主要目标。",
            "answer": "$$\\boxed{\\frac{17}{2} - 2\\sqrt{2}}$$"
        },
        {
            "introduction": "要使GAN在科学发现中发挥作用，其输出通常必须遵循已知的物理或生物学定律，例如代谢网络中的质量守恒。本练习  演示了一种强大的技术——正交投影，用以强制施加此类线性约束。你将推导出一个投影算子，它能将任何生成的向量映射到符合物理现实的可行子空间上。",
            "id": "3316149",
            "problem": "一个生成对抗网络 (GAN) 被训练用于为一个包含两个内代谢物的线性三反应途径合成稳态代谢通量向量。化学计量矩阵由下式给出\n$$\nS = \\begin{pmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix},\n$$\n该矩阵通过约束条件 $S v = 0$ 对任何可行的通量向量 $v \\in \\mathbb{R}^{3}$ 编码了稳态下的质量平衡。矩阵 $S$ 具有满行秩。\n\n为了在一个生成的通量向量 $\\tilde{v} \\in \\mathbb{R}^{3}$ 上严格执行化学计量约束，同时在标准欧几里得范数下做出最小可能的改变，考虑寻找 $v^{\\star}$ 作为在以下线性约束条件下到 $\\tilde{v}$ 的无约束距离的最小化者的问题：\n$$\n\\text{minimize } \\frac{1}{2}\\|v - \\tilde{v}\\|_{2}^{2} \\quad \\text{subject to} \\quad S v = 0.\n$$\n从稳态质量守恒 ($S v = 0$) 的原理、正交投影的欧几里得几何以及标准的拉格朗日乘子法出发，推导出将任何 $\\tilde{v}$ 映射到上述优化问题的唯一解 $v^{\\star}$ 的显式线性算子 $P \\in \\mathbb{R}^{3 \\times 3}$。然后，使用给定的 $S$ 计算 $P$。\n\n以有理数项的单一闭式矩阵形式，精确提供最终算子 $P$。最终表达式中不需四舍五入，也不应包含单位。",
            "solution": "所述问题是有效的。它在科学上基于代谢建模和凸优化的原理，问题提法良好，有唯一解，并且形式上明确无歧义。因此，我们可以进行推导。\n\n问题是找到解决以下约束优化问题的向量 $v^{\\star}$：\n$$\n\\text{minimize } f(v) = \\frac{1}{2}\\|v - \\tilde{v}\\|_{2}^{2} \\quad \\text{subject to} \\quad S v = 0\n$$\n其中 $v, \\tilde{v} \\in \\mathbb{R}^{3}$ 且 $S \\in \\mathbb{R}^{2 \\times 3}$。向量 $v^{\\star}$ 是生成向量 $\\tilde{v}$ 到化学计量矩阵 $S$ 的零空间（记作 $\\text{Null}(S)$）上的正交投影。零空间代表了所有可行的稳态通量向量的集合。\n\n我们将使用拉格朗日乘子法来解决这个问题。拉格朗日函数 $\\mathcal{L}(v, \\lambda)$ 是通过将目标函数与由拉格朗日乘子向量 $\\lambda \\in \\mathbb{R}^{2}$ 加权的等式约束相加来构造的：\n$$\n\\mathcal{L}(v, \\lambda) = \\frac{1}{2}\\|v - \\tilde{v}\\|_{2}^{2} + \\lambda^T (S v)\n$$\n目标函数 $f(v)$ 是严格凸的，约束是线性的，因此一阶必要条件对于最优性也是充分的。这些条件通过将拉格朗日函数相对于 $v$ 和 $\\lambda$ 的梯度设置为零来找到。\n\n相对于 $v$ 的梯度是：\n$$\n\\nabla_v \\mathcal{L}(v, \\lambda) = \\frac{\\partial}{\\partial v} \\left( \\frac{1}{2}(v - \\tilde{v})^T(v - \\tilde{v}) + \\lambda^T S v \\right) = (v - \\tilde{v}) + S^T \\lambda\n$$\n将此梯度设置为零得到第一个条件：\n$$\nv - \\tilde{v} + S^T \\lambda = 0 \\implies v = \\tilde{v} - S^T \\lambda\n$$\n相对于 $\\lambda$ 的梯度只是恢复了原始约束：\n$$\n\\nabla_\\lambda \\mathcal{L}(v, \\lambda) = S v = 0\n$$\n为了找到最优解 $v^{\\star}$，我们将第一个条件中 $v$ 的表达式代入第二个条件：\n$$\nS(\\tilde{v} - S^T \\lambda) = 0\n$$\n$$\nS\\tilde{v} - S S^T \\lambda = 0\n$$\n这导致了关于拉格朗日乘子 $\\lambda$ 的一个线性系统：\n$$\nS S^T \\lambda = S \\tilde{v}\n$$\n问题陈述指明矩阵 $S$ 具有满行秩。对于 $S \\in \\mathbb{R}^{2 \\times 3}$，这意味着 $\\text{rank}(S) = 2$。因此，格拉姆矩阵 $S S^T \\in \\mathbb{R}^{2 \\times 2}$ 是可逆的。因此我们可以解出 $\\lambda$：\n$$\n\\lambda = (S S^T)^{-1} S \\tilde{v}\n$$\n现在，我们将 $\\lambda$ 的这个表达式代回到最优向量的方程中，我们将其记为 $v^{\\star}$：\n$$\nv^{\\star} = \\tilde{v} - S^T \\left( (S S^T)^{-1} S \\tilde{v} \\right)\n$$\n通过提取公因子 $\\tilde{v}$，我们可以确定线性算子 $P$，使得 $v^{\\star} = P \\tilde{v}$：\n$$\nv^{\\star} = \\left( I - S^T (S S^T)^{-1} S \\right) \\tilde{v}\n$$\n因此，投影算子是：\n$$\nP = I - S^T (S S^T)^{-1} S\n$$\n其中 $I$ 是 $3 \\times 3$ 的单位矩阵。这是到 $S$ 的零空间上的正交投影矩阵的一般形式。\n\n现在，我们为给定的化学计量矩阵计算这个算子：\n$$\nS = \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix}\n$$\n$S$ 的转置是：\n$$\nS^T = \\begin{pmatrix} 1  0 \\\\ -1  1 \\\\ 0  -1 \\end{pmatrix}\n$$\n首先，我们计算乘积 $S S^T$：\n$$\nS S^T = \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -1  1 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + (-1) \\cdot (-1)  1 \\cdot 0 + (-1) \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot (-1)  0 \\cdot 0 + 1 \\cdot 1 + (-1) \\cdot (-1) \\end{pmatrix} = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n接下来，我们求 $S S^T$ 的逆。行列式为 $\\det(S S^T) = (2)(2) - (-1)(-1) = 4 - 1 = 3$。\n$$\n(S S^T)^{-1} = \\frac{1}{3} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n现在我们计算乘积 $S^T (S S^T)^{-1} S$：\n$$\nS^T (S S^T)^{-1} = \\frac{1}{3} \\begin{pmatrix} 1  0 \\\\ -1  1 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 1 \\cdot 2 + 0 \\cdot 1  1 \\cdot 1 + 0 \\cdot 2 \\\\ -1 \\cdot 2 + 1 \\cdot 1  -1 \\cdot 1 + 1 \\cdot 2 \\\\ 0 \\cdot 2 + (-1) \\cdot 1  0 \\cdot 1 + (-1) \\cdot 2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2  1 \\\\ -1  1 \\\\ -1  -2 \\end{pmatrix}\n$$\n$$\nS^T (S S^T)^{-1} S = \\frac{1}{3} \\begin{pmatrix} 2  1 \\\\ -1  1 \\\\ -1  -2 \\end{pmatrix} \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2  -1  -1 \\\\ -1  2  -1 \\\\ -1  -1  2 \\end{pmatrix}\n$$\n最后，我们计算投影算子 $P = I - S^T (S S^T)^{-1} S$：\n$$\nP = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 2  -1  -1 \\\\ -1  2  -1 \\\\ -1  -1  2 \\end{pmatrix}\n$$\n$$\nP = \\frac{1}{3}\\begin{pmatrix} 3-2 & 0-(-1) & 0-(-1) \\\\ 0-(-1) & 3-2 & 0-(-1) \\\\ 0-(-1) & 0-(-1) & 3-2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & 1 \\end{pmatrix}\n$$\n该矩阵将任何向量 $\\tilde{v} \\in \\mathbb{R}^{3}$ 投影到 $S$ 的零空间上。$S$ 的零空间由 $v_1 - v_2 = 0$ 和 $v_2 - v_3 = 0$ 定义，这意味着 $v_1 = v_2 = v_3$。这是由向量 $(1, 1, 1)^T$ 张成的一维子空间。推导出的算子 $P$ 正确地将任何向量投影到该子空间上。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\\\ \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\\\ \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "GANs一个常见的失效模式是“模式坍塌”（mode collapse），即生成器只产生种类有限的样本，这在生物学应用中尤其成问题，因为它可能导致错过关键的细胞类型或状态。本练习  介绍了一种先进的方法——拓扑数据分析（TDA），它能够量化数据的“形状”和结构。通过计算贝蒂数（Betti numbers），你可以识别出这类微妙但至关重要的生成缺陷。",
            "id": "3316091",
            "problem": "给定由生成对抗网络 (GAN) 生成的、代表单细胞核糖核酸测序 (scRNA-seq) 数据嵌入的有限点云。任务是使用拓扑数据分析 (TDA) 方法，通过比较真实嵌入与生成嵌入的 Vietoris–Rips 复形的拓扑结构，来评估潜在的模式坍塌 (mode collapse)。请使用纯数学术语进行操作：将每个嵌入视为带有欧几里得度量的 $\\mathbb{R}^d$ 的一个有限子集，并将在尺度参数 $\\varepsilon > 0$ 下的 Vietoris–Rips 复形定义为一个抽象单纯复形，其 $k$-单纯形是所有大小为 $k+1$ 且任意两顶点间距离至多为 $\\varepsilon$ 的顶点子集。计算 Betti 数，其中 $\\beta_k$ 是在有限域 $\\mathbb{F}_2$ 上定义的第 $k$ 个同调群的维数，并特别关注 $k \\in \\{0,1\\}$ 的情况。\n\n使用的基本概念和定义：\n- 一个有限度量空间在尺度 $\\varepsilon$ 下的 Vietoris–Rips 复形包含一个 $k$-单纯形，当且仅当其每对顶点的距离至多为 $\\varepsilon$。\n- 有限单纯复形的同调是在一个域上通过链复形定义的，该链复形带有将 $k$-链映射到 $(k-1)$-链的边界算子，而 $\\beta_k$ 等于第 $k$ 个同调群的维数。\n- 对于 $k=0$，$\\beta_0$ 等于复形 1-骨架图的连通分支数。\n- 对于 $k=1$，第一个 Betti 数计算的是在考虑了为圈提供边界的 2-单纯形之后，独立的一维孔洞的数量。\n\n对于每个测试用例，您的程序必须在给定的 $\\varepsilon$ 下，构建维度最高为 2 的 Vietoris–Rips 复形（顶点、边和三角形），计算 $\\beta_0$ 和 $\\beta_1$，然后生成一个模式坍塌的布尔指示符，其定义如下：如果生成嵌入的连通分支数严格少于真实嵌入，并且一维孔洞数没有增加，即 $\\beta_0^{\\mathrm{gen}}  \\beta_0^{\\mathrm{real}}$ 且 $\\beta_1^{\\mathrm{gen}} \\le \\beta_1^{\\mathrm{real}}$，则判定为坍塌。\n\n测试套件（每个测试用例是一个三元组，由真实嵌入、生成嵌入和尺度参数 $\\varepsilon$ 组成）：\n- 测试用例 1（两个分离良好的簇 vs 单个簇）：\n  - 真实嵌入 $\\phi(X)_{\\mathrm{real}}$ 在 $\\mathbb{R}^2$ 中，点为：$(0,0)$, $(1,0)$, $(0.5,0.866025403784)$, $(4,0)$, $(5,0)$, $(4.5,0.866025403784)$；尺度 $\\varepsilon = 1.1$。\n  - 生成嵌入 $\\phi(X)_{\\mathrm{gen}}$ 在 $\\mathbb{R}^2$ 中，点为：$(0,0)$, $(1,0)$, $(0.5,0.866025403784)$；尺度 $\\varepsilon = 1.1$。\n- 测试用例 2（一个环 vs 一个填充的三角形）：\n  - 真实嵌入 $\\phi(X)_{\\mathrm{real}}$ 在 $\\mathbb{R}^2$ 中，点为：$(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$；尺度 $\\varepsilon = 1.05$。\n  - 生成嵌入 $\\phi(X)_{\\mathrm{gen}}$ 在 $\\mathbb{R}^2$ 中，点为：$(0,0)$, $(0.6,0)$, $(0.3,0.519615242270)$；尺度 $\\varepsilon = 1.05$。\n- 测试用例 3（孤立点 vs 单个填充的三角形）：\n  - 真实嵌入 $\\phi(X)_{\\mathrm{real}}$ 在 $\\mathbb{R}^2$ 中，点为：$(0,0)$, $(2,0)$, $(0,2)$；尺度 $\\varepsilon = 0.5$。\n  - 生成嵌入 $\\phi(X)_{\\mathrm{gen}}$ 在 $\\mathbb{R}^2$ 中，点为：$(0,0)$, $(0.4,0)$, $(0.2,0.346410161514)$；尺度 $\\varepsilon = 0.5$。\n\n对于每个测试用例，计算元组 $\\left[\\beta_0^{\\mathrm{real}}, \\beta_1^{\\mathrm{real}}, \\beta_0^{\\mathrm{gen}}, \\beta_1^{\\mathrm{gen}}, C\\right]$，其中 $C$ 是如上定义的坍塌指示符。您的程序应生成单行输出，包含一个由逗号分隔并用方括号括起来的列表，其中每个元素是对应于一个测试用例的列表，并按给定测试用例的顺序排列（例如 $\\left[ [\\cdots], [\\cdots], [\\cdots] \\right]$）。不涉及物理单位，也不使用角度。所有返回值必须是布尔型、整型、浮点型或这些基本类型的列表。计算必须基于给定输入是精确的；不涉及随机性。",
            "solution": "该问题要求通过比较真实数据和生成数据的点云嵌入的拓扑结构，来评估生成对抗网络 (GAN) 中潜在的模式坍塌。指定的方法是拓扑数据分析 (TDA)，具体来说是计算从数据构建的 Vietoris–Rips (VR) 复形的 Betti 数。该问题定义明确，数学上可靠，并提供了所有必要的参数和定义。我们将为每个测试用例逐步进行解答。\n\n**Test Case 1: 两个分离良好的簇 vs 单个簇**\n- **尺度 $\\varepsilon = 1.1$**\n- **真实嵌入**: 点集 $P_r = \\{(0,0), (1,0), (0.5,0.866...), (4,0), (5,0), (4.5,0.866...)\\}$。\n    - 这些点构成两个边长为1的等边三角形。我们称它们为 $T_1 = \\{(0,0), (1,0), (0.5,0.866...)\\}$ 和 $T_2 = \\{(4,0), (5,0), (4.5,0.866...)\\}$。\n    - 在每个三角形内部，所有点对之间的距离均为1，小于 $\\varepsilon=1.1$。因此，$T_1$ 和 $T_2$ 各自形成一个完整的图（K3），并被填充为2-单纯形（实心三角形）。\n    - $T_1$ 和 $T_2$ 之间的最小距离是 $d((1,0), (4,0)) = 3$，大于 $\\varepsilon$。因此，这两个部分是互相不连通的。\n    - $\\beta_0^{\\mathrm{real}}$: 有2个连通分支，所以 $\\beta_0^{\\mathrm{real}} = 2$。\n    - $\\beta_1^{\\mathrm{real}}$: 每个连通分支都是一个实心三角形，没有一维孔洞，所以 $\\beta_1^{\\mathrm{real}} = 0$。\n- **生成嵌入**: 点集 $P_g = \\{(0,0), (1,0), (0.5,0.866...)\\}$。\n    - 这是一个边长为1的等边三角形。所有点对之间的距离都小于 $\\varepsilon$。\n    - $\\beta_0^{\\mathrm{gen}}$: 只有1个连通分支，所以 $\\beta_0^{\\mathrm{gen}} = 1$。\n    - $\\beta_1^{\\mathrm{gen}}$: 该连通分支是一个实心三角形，没有孔洞，所以 $\\beta_1^{\\mathrm{gen}} = 0$。\n- **坍塌指示符 (C)**: 条件是 $(\\beta_0^{\\mathrm{gen}}  \\beta_0^{\\mathrm{real}}) \\land (\\beta_1^{\\mathrm{gen}} \\le \\beta_1^{\\mathrm{real}})$。\n    - 我们检验 $(1  2) \\land (0 \\le 0)$，结果为 `True`。\n- **结果 1**: `[2, 0, 1, 0, True]`\n\n**Test Case 2: 一个环 vs 一个填充的三角形**\n- **尺度 $\\varepsilon = 1.05$**\n- **真实嵌入**: 点集 $P_r = \\{(0,0), (1,0), (1,1), (0,1)\\}$，为一个边长为1的正方形的顶点。\n    - 相邻顶点间的距离为1，对角顶点间的距离为 $\\sqrt{2} \\approx 1.414$。\n    - 由于 $\\varepsilon = 1.05$，只有相邻的顶点之间有边。VR复形是一个由4个顶点和4条边构成的环。由于没有三个顶点两两之间的距离都小于等于$\\varepsilon$，所以没有2-单纯形形成。\n    - $\\beta_0^{\\mathrm{real}}$: 图是连通的，所以 $\\beta_0^{\\mathrm{real}} = 1$。\n    - $\\beta_1^{\\mathrm{real}}$: 这个环形成了一个一维孔洞，所以 $\\beta_1^{\\mathrm{real}} = 1$。\n- **生成嵌入**: 点集 $P_g = \\{(0,0), (0.6,0), (0.3,0.5196...)\\}$，为一个边长为0.6的等边三角形。\n    - 所有点对之间的距离都是0.6，小于 $\\varepsilon=1.05$。因此该复形是一个实心三角形（2-单纯形）。\n    - $\\beta_0^{\\mathrm{gen}}$: 图是连通的，所以 $\\beta_0^{\\mathrm{gen}} = 1$。\n    - $\\beta_1^{\\mathrm{gen}}$: 三角形是实心的，没有孔洞，所以 $\\beta_1^{\\mathrm{gen}} = 0$。\n- **坍塌指示符 (C)**: 检验 $(1  1) \\land (0 \\le 1)$。第一个条件为假，所以 $C$ 为 `False`。\n- **结果 2**: `[1, 1, 1, 0, False]`\n\n**Test Case 3: 孤立点 vs 单个填充的三角形**\n- **尺度 $\\varepsilon = 0.5$**\n- **真实嵌入**: 点集 $P_r = \\{(0,0), (2,0), (0,2)\\}$。\n    - 点对之间的距离分别为 $d((0,0),(2,0))=2$，$d((0,0),(0,2))=2$，$d((2,0),(0,2))=\\sqrt{8}\\approx 2.828$。所有距离都大于 $\\varepsilon=0.5$。\n    - VR复形由3个顶点和0条边构成。\n    - $\\beta_0^{\\mathrm{real}}$: 有3个连通分支（即3个孤立点），所以 $\\beta_0^{\\mathrm{real}} = 3$。\n    - $\\beta_1^{\\mathrm{real}}$: 没有边，因此没有环或孔洞，所以 $\\beta_1^{\\mathrm{real}} = 0$。\n- **生成嵌入**: 点集 $P_g = \\{(0,0), (0.4,0), (0.2,0.3464...)\\}$，为一个边长为0.4的等边三角形。\n    - 所有点对之间的距离都是0.4，小于 $\\varepsilon=0.5$。因此该复形是一个实心三角形。\n    - $\\beta_0^{\\mathrm{gen}}$: 图是连通的，所以 $\\beta_0^{\\mathrm{gen}} = 1$。\n    - $\\beta_1^{\\mathrm{gen}}$: 三角形是实心的，没有孔洞，所以 $\\beta_1^{\\mathrm{gen}} = 0$。\n- **坍塌指示符 (C)**: 检验 $(1  3) \\land (0 \\le 0)$。结果为 `True`。\n- **结果 3**: `[3, 0, 1, 0, True]`\n\n**最终输出**:\n将三个测试用例的结果合并，得到最终的列表。",
            "answer": "[[2, 0, 1, 0, True], [1, 1, 1, 0, False], [3, 0, 1, 0, True]]"
        }
    ]
}