{
    "hands_on_practices": [
        {
            "introduction": "在系统生物学中，量化分子实体间的相互作用强度至关重要。加权无向图为此提供了一个强大的框架，其中节点代表分子（如蛋白质或酶），而边权重则表示它们之间相互作用的强度。为了分析这些网络，我们首先需要将它们转化为数学对象，例如加权邻接矩阵 $A$ 和度矩阵 $D$，它们共同构成了图拉普拉斯算子 $L = D - A$ 。这个练习将指导你完成这一基本转换过程，并计算一个二次型，它揭示了节点上的信号（例如基因表达水平）与网络拓扑结构之间的一致性。",
            "id": "3302969",
            "problem": "在计算系统生物学中，分子实体之间的相互作用或耦合强度通常被建模为无向图上的正边权重，从而产生系统级关系的加权网络表示。考虑一个由标记为 $\\{1,2,3,4\\}$ 的四个酶组成的网络，其中酶 $i$ 和 $j$ 之间的无向边具有正耦合强度 $w_{ij}$，且具有对称性 $w_{ij} = w_{ji} > 0$。加权邻接矩阵 $A$ 和（加权）度矩阵 $D$ 是基本的图构造：$A$ 编码边权重，$D$ 编码每个节点的入射权重之和。组合拉普拉斯矩阵定义为 $L = D - A$，并广泛用于量化扩散耦合以及节点上定义的信号的平滑度。从核心定义出发，即对于一个无向加权图，$A$ 是对称的，其中当 $i \\neq j$ 时 $a_{ij} = w_{ij}$ 且 $a_{ii} = 0$，$D$ 是对角矩阵，其中 $d_{i} = \\sum_{j=1}^{n} a_{ij}$，请推导如何从 $\\{w_{ij}\\}$ 构建 $A$ 和 $D$，并由此构建 $L$。然后，通过为指定的节点信号 $x$ 计算二次型 $x^{\\top} L x$ 来计算一个从 $L$ 导出的标量。\n\n该生物网络由以下无向正权重给出：\n- $w_{12} = 3.2$, $w_{13} = 0.7$, $w_{14} = 4.1$,\n- $w_{23} = 1.8$, $w_{24} = 3.3$,\n- $w_{34} = 2.5$,\n\n对于所有 $i$，满足 $w_{ij} = w_{ji}$ 且 $w_{ii} = 0$。设节点信号（例如，酶活性的对数倍数变化）为 $x = (1,\\,-1,\\,2,\\,0)^{\\top}$。\n\n任务：\n1. 使用无向加权图的基本定义，明确构建加权邻接矩阵 $A$ 和度矩阵 $D$。\n2. 计算拉普拉斯矩阵 $L = D - A$。\n3. 计算二次型 $x^{\\top} L x$。\n\n将你的最终答案表示为单个实数。无需四舍五入；报告精确值。",
            "solution": "问题陈述经证实具有科学依据、问题明确且客观。它提供了来自计算系统生物学和图论领域的完整且一致的定义和数据。这些任务在计算上是直接的，并能得出一个唯一的、可验证的结果。我们开始解题。\n\n该问题要求为一个包含四个酶的网络构建三个矩阵——加权邻接矩阵 $A$、度矩阵 $D$ 和组合拉普拉斯矩阵 $L$——并随后计算二次型 $x^{\\top} L x$。\n\n**任务1：构建加权邻接矩阵 $A$ 和度矩阵 $D$。**\n\n对于一个有 $n$ 个节点的无向图，其加权邻接矩阵 $A$ 是一个 $n \\times n$ 的对称矩阵。其元素 $a_{ij}$ 是根据节点 $i$ 和 $j$ 之间的边权重 $w_{ij}$ 定义的。对于 $i \\neq j$，$a_{ij} = w_{ij}$。对角线元素为零，即 $a_{ii} = 0$。\n\n给定 $n=4$ 个酶的网络和所提供的权重：\n$w_{12} = 3.2$, $w_{13} = 0.7$, $w_{14} = 4.1$,\n$w_{23} = 1.8$, $w_{24} = 3.3$,\n$w_{34} = 2.5$.\n以及对称条件 $w_{ij} = w_{ji}$。\n\n这个 $4 \\times 4$ 的邻接矩阵 $A$ 构建如下：\n$$ A = \\begin{pmatrix} a_{11} & a_{12} & a_{13} & a_{14} \\\\ a_{21} & a_{22} & a_{23} & a_{24} \\\\ a_{31} & a_{32} & a_{33} & a_{34} \\\\ a_{41} & a_{42} & a_{43} & a_{44} \\end{pmatrix} = \\begin{pmatrix} 0 & w_{12} & w_{13} & w_{14} \\\\ w_{21} & 0 & w_{23} & w_{24} \\\\ w_{31} & w_{32} & 0 & w_{34} \\\\ w_{41} & w_{42} & w_{43} & 0 \\end{pmatrix} $$\n代入给定的数值：\n$$ A = \\begin{pmatrix} 0 & 3.2 & 0.7 & 4.1 \\\\ 3.2 & 0 & 1.8 & 3.3 \\\\ 0.7 & 1.8 & 0 & 2.5 \\\\ 4.1 & 3.3 & 2.5 & 0 \\end{pmatrix} $$\n\n度矩阵 $D$ 是一个对角矩阵，其中每个对角元素 $d_i$（也表示为 $d_{ii}$）代表节点 $i$ 的度。对于加权图，一个节点的度是所有与其相连的边的权重之和。这可以通过对邻接矩阵 $A$ 中相应行（或列）的元素求和来计算：\n$$ d_i = \\sum_{j=1}^{n} a_{ij} $$\n那么，度矩阵 $D$ 为：\n$$ D = \\begin{pmatrix} d_1 & 0 & 0 & 0 \\\\ 0 & d_2 & 0 & 0 \\\\ 0 & 0 & d_3 & 0 \\\\ 0 & 0 & 0 & d_4 \\end{pmatrix} $$\n我们计算各个节点的度：\n$d_1 = a_{12} + a_{13} + a_{14} = 3.2 + 0.7 + 4.1 = 8.0$\n$d_2 = a_{21} + a_{23} + a_{24} = 3.2 + 1.8 + 3.3 = 8.3$\n$d_3 = a_{31} + a_{32} + a_{34} = 0.7 + 1.8 + 2.5 = 5.0$\n$d_4 = a_{41} + a_{42} + a_{43} = 4.1 + 3.3 + 2.5 = 9.9$\n\n因此，度矩阵 $D$ 为：\n$$ D = \\begin{pmatrix} 8.0 & 0 & 0 & 0 \\\\ 0 & 8.3 & 0 & 0 \\\\ 0 & 0 & 5.0 & 0 \\\\ 0 & 0 & 0 & 9.9 \\end{pmatrix} $$\n\n**任务2：计算拉普拉斯矩阵 $L = D - A$。**\n\n组合拉普拉斯矩阵 $L$ 定义为度矩阵 $D$ 和邻接矩阵 $A$ 之差。\n$$ L = D - A $$\n$$ L = \\begin{pmatrix} 8.0 & 0 & 0 & 0 \\\\ 0 & 8.3 & 0 & 0 \\\\ 0 & 0 & 5.0 & 0 \\\\ 0 & 0 & 0 & 9.9 \\end{pmatrix} - \\begin{pmatrix} 0 & 3.2 & 0.7 & 4.1 \\\\ 3.2 & 0 & 1.8 & 3.3 \\\\ 0.7 & 1.8 & 0 & 2.5 \\\\ 4.1 & 3.3 & 2.5 & 0 \\end{pmatrix} $$\n$$ L = \\begin{pmatrix} 8.0 - 0 & 0 - 3.2 & 0 - 0.7 & 0 - 4.1 \\\\ 0 - 3.2 & 8.3 - 0 & 0 - 1.8 & 0 - 3.3 \\\\ 0 - 0.7 & 0 - 1.8 & 5.0 - 0 & 0 - 2.5 \\\\ 0 - 4.1 & 0 - 3.3 & 0 - 2.5 & 9.9 - 0 \\end{pmatrix} $$\n$$ L = \\begin{pmatrix} 8.0 & -3.2 & -0.7 & -4.1 \\\\ -3.2 & 8.3 & -1.8 & -3.3 \\\\ -0.7 & -1.8 & 5.0 & -2.5 \\\\ -4.1 & -3.3 & -2.5 & 9.9 \\end{pmatrix} $$\n\n**任务3：计算二次型 $x^{\\top} L x$。**\n\n节点信号由列向量 $x = \\begin{pmatrix} 1 & -1 & 2 & 0 \\end{pmatrix}^{\\top}$ 给出。其转置为 $x^{\\top} = \\begin{pmatrix} 1 & -1 & 2 & 0 \\end{pmatrix}$。\n二次型 $x^{\\top} L x$ 通过矩阵乘法计算。首先，我们计算乘积 $L x$：\n$$ L x = \\begin{pmatrix} 8.0 & -3.2 & -0.7 & -4.1 \\\\ -3.2 & 8.3 & -1.8 & -3.3 \\\\ -0.7 & -1.8 & 5.0 & -2.5 \\\\ -4.1 & -3.3 & -2.5 & 9.9 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\\\ 0 \\end{pmatrix} $$\n$$ L x = \\begin{pmatrix} (8.0)(1) + (-3.2)(-1) + (-0.7)(2) + (-4.1)(0) \\\\ (-3.2)(1) + (8.3)(-1) + (-1.8)(2) + (-3.3)(0) \\\\ (-0.7)(1) + (-1.8)(-1) + (5.0)(2) + (-2.5)(0) \\\\ (-4.1)(1) + (-3.3)(-1) + (-2.5)(2) + (9.9)(0) \\end{pmatrix} $$\n$$ L x = \\begin{pmatrix} 8.0 + 3.2 - 1.4 \\\\ -3.2 - 8.3 - 3.6 \\\\ -0.7 + 1.8 + 10.0 \\\\ -4.1 + 3.3 - 5.0 \\end{pmatrix} = \\begin{pmatrix} 9.8 \\\\ -15.1 \\\\ 11.1 \\\\ -5.8 \\end{pmatrix} $$\n接下来，我们计算 $x^{\\top}$ 与所得向量 $L x$ 的点积：\n$$ x^{\\top} L x = x^{\\top} (L x) = \\begin{pmatrix} 1 & -1 & 2 & 0 \\end{pmatrix} \\begin{pmatrix} 9.8 \\\\ -15.1 \\\\ 11.1 \\\\ -5.8 \\end{pmatrix} $$\n$$ x^{\\top} L x = (1)(9.8) + (-1)(-15.1) + (2)(11.1) + (0)(-5.8) $$\n$$ x^{\\top} L x = 9.8 + 15.1 + 22.2 + 0 $$\n$$ x^{\\top} L x = 24.9 + 22.2 = 47.1 $$\n二次型的值为 $47.1$。",
            "answer": "$$\n\\boxed{47.1}\n$$"
        },
        {
            "introduction": "许多生物过程，如基因调控和信号转导，本质上是具有方向性的。有向无环图（DAG）是模拟这类无反馈层次结构系统的理想模型，其中有向边代表了事件的先后顺序或因果关系。拓扑排序是分析DAG的一个核心算法，它可以为网络中的所有节点生成一个线性序列，这个序列与图中所有的有向边约束都相符，从而揭示了一个有效的调控层级 。通过这个实践，你将学习如何对一个基因调控网络进行拓扑排序，并探索确定所有可能调控序列的组合复杂性。",
            "id": "3303015",
            "problem": "在计算系统生物学中使用的基因调控网络中，基因和转录因子可以表示为有向图的顶点，其中从顶点 $i$ 到顶点 $j$ 的有向边表示基因 $i$ 的产物调控基因 $j$ 的表达。考虑以下模型假设作为基本基础：基因调控遵循分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质），调控影响沿有向边传播，有向环对应于反馈回路。没有有向环的有向图是有向无环图（DAG），这种图允许进行拓扑排序，即列出所有顶点，使得所有有向边都从较早的位置指向较晚的位置。\n\n给定一个顶点集为 $V=\\{A,B,C,D,E,F\\}$ 的小型有向基因调控网络，表示转录调控，其中边的方向编码了调控影响的优先约束。提供了加权邻接矩阵，但为了进行层级排序，只有拓扑结构（非零元素的位置）是重要的。顶点按 $(A,B,C,D,E,F)$ 排序，邻接矩阵 $M$ 为\n$$\nM \\;=\\; \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n矩阵项 $M_{ij}=1$ 表示存在一条有向边 $i\\to j$，并编码了在任何有效的层级排序中 $i$ 必须在 $j$ 之前；矩阵项 $M_{ij}=0$ 表示不存在直接的调控边。假设所有非零项都对应于正权重，其大小与优先顺序无关。\n\n任务：\n1. 仅从有向图、有向无环图、偏序和拓扑排序的定义出发，解释为什么在没有反馈回路的情况下，对此网络进行拓扑排序能够捕捉到层级调控，以及为什么这种排序的存在等价于有向图的无环性。\n2. 使用给定的邻接矩阵 $M$，验证该有向图是无环的，并计算：\n   - 一个与 $M$ 一致的 $V$ 的有效拓扑排序，以及\n   - 由 $M$ 编码的优先约束的所有不同有效拓扑排序（线性扩展）的总数。\n\n答案规格：为了评分，仅报告有效拓扑排序的总数，形式为不带单位的单个整数。不要四舍五入。你可能会发现生成一个有效的排序作为中间步骤很有帮助，但不要将其包含在最终答案中。",
            "solution": "该问题分为概念解释和涉及特定有向图的计算任务。\n\n**第1部分：概念框架**\n\n有向图 $G=(V, E)$ 由一个顶点集 $V$ 和一个边集 $E$ 组成，其中每条边是顶点的有序对 $(u, v)$，表示从 $u$到 $v$ 的有向连接。在基因调控网络的背景下，顶点代表基因，有向边 $(i, j)$ 意味着基因 $i$ 的产物调控基因 $j$。这建立了一个优先约束：$i$ 的调控作用在逻辑上必须先于其对 $j$ 的影响。\n\n所有这些优先约束的集合可以通过传递性进行扩展。如果存在从顶点 $u$到顶点 $v$ 的有向路径，我们说 $u$ 是 $v$ 的祖先，或 $u$ 先于 $v$，记为 $u \\prec v$。这个优先关系构成一个严格偏序，当且仅当该图是一个有向无环图（DAG）。严格偏序是一个反自反、非对称和传递的二元关系。\n1.  **反自反性**：对于任何顶点 $v$，$v \\not\\prec v$。这意味着没有从 $v$ 回到自身的路径，这正是一个图没有长度为 $1$ 或更长的环的定义。\n2.  **非对称性**：如果 $u \\prec v$，那么 $v \\not\\prec u$。如果存在一条从 $u$ 到 $v$ 的路径和一条从 $v$ 到 $u$ 的路径，它们的串联将形成一个有向环。因此，非对称性是无环性的直接结果。\n3.  **传递性**：如果 $u \\prec v$ 且 $v \\prec w$，那么 $u \\prec w$。如果存在一条从 $u$到 $v$ 的路径和一条从 $v$到 $w$ 的路径，将它们串联起来就构成了从 $u$到 $w$ 的路径。这在基于路径的优先定义中是固有的。\n\n问题指出，有向环对应于反馈回路。因此，没有反馈回路等价于图是无环的。在这样的系统中，调控是层级的：有“上游”调控因子和“下游”靶标，而靶标不会反馈影响其自身的调控因子。这种层级结构正是DAG上的偏序关系 $\\prec$所捕捉的。\n\n有向图的拓扑排序是对其所有顶点的一种线性排序，使得对于每条从顶点 $u$到顶点 $v$ 的有向边，$u$ 在排序中都出现在 $v$ 之前。这样的排序是将偏序“扁平化”为全序，代表了调控事件展开的一种可能的有效序列。\n\n拓扑排序的存在等价于图是一个DAG。\n-   **(DAG $\\implies$ 拓扑排序)**：一个有限DAG必须至少有一个入度为 $0$ 的顶点。这样的顶点可以放在排序的首位。移除这个顶点及其出边会产生一个更小的子图，该子图也是一个DAG。这个过程可以重复进行，在每一步从剩余的图中选择一个入度为 $0$ 的顶点，直到所有顶点都被排序。这种构造性算法（Kahn算法）对于DAG总是成功的。\n-   **(拓扑排序 $\\implies$ DAG)**：假设存在一个拓扑排序。设排序为 $v_1, v_2, \\ldots, v_n$。对于任何边 $(v_i, v_j)$，排序的定义要求 $i  j$。因此，任何有向路径 $v_{k_1} \\to v_{k_2} \\to \\ldots \\to v_{k_m}$ 都必须满足 $k_1  k_2  \\ldots  k_m$。环是一条起点和终点相同的路径，例如 $v_i \\to \\ldots \\to v_i$。这将意味着一个索引序列 $i  \\ldots  i$，这是一个矛盾。因此，不可能存在环。\n\n因此，拓扑排序代表了基因表达事件的一个有效的时间或层级序列，其存在保证了网络没有反馈回路。\n\n**第2部分：对给定网络的分析**\n\n顶点集为 $V=\\{A,B,C,D,E,F\\}$。邻接矩阵 $M$ 定义了以下边：\n$A \\to B$, $A \\to C$\n$B \\to D$, $B \\to E$\n$C \\to E$, $C \\to F$\n$D \\to F$\n$E \\to F$\n\n**验证无环性并找到一个拓扑排序**\n我们使用Kahn算法。首先计算所有顶点的入度：\n-   $\\text{入度}(A) = 0$\n-   $\\text{入度}(B) = 1$\n-   $\\text{入度}(C) = 1$\n-   $\\text{入度}(D) = 1$\n-   $\\text{入度}(E) = 2$\n-   $\\text{入度}(F) = 3$\n\n1.  初始化一个队列，包含所有入度为 $0$ 的顶点：$Q = [A]$。\n2.  从队列中取出 $A$。将其添加到排序列表 $L$ 中：$L=(A)$。减少其邻居（$B$，$C$）的入度。\n    -   $\\text{入度}(B)$ 变为 $0$。将 $B$ 入队。\n    -   $\\text{入度}(C)$ 变为 $0$。将 $C$ 入队。\n    -   $Q = [B, C]$。\n3.  从队列中取出 $B$。$L=(A, B)$。减少其邻居（$D$，$E$）的入度。\n    -   $\\text{入度}(D)$ 变为 $0$。将 $D$ 入队。\n    -   $\\text{入度}(E)$ 变为 $2-1=1$。\n    -   $Q = [C, D]$。\n4.  从队列中取出 $C$。$L=(A, B, C)$。减少其邻居（$E$，$F$）的入度。\n    -   $\\text{入度}(E)$ 变为 $1-1=0$。将 $E$ 入队。\n    -   $\\text{入度}(F)$ 变为 $3-1=2$。\n    -   $Q = [D, E]$。\n5.  从队列中取出 $D$。$L=(A, B, C, D)$。减少其邻居（$F$）的入度。\n    -   $\\text{入度}(F)$ 变为 $2-1=1$。\n    -   $Q = [E]$。\n6.  从队列中取出 $E$。$L=(A, B, C, D, E)$。减少其邻居（$F$）的入度。\n    -   $\\text{入度}(F)$ 变为 $1-1=0$。将 $F$ 入队。\n    -   $Q = [F]$。\n7.  从队列中取出 $F$。$L=(A, B, C, D, E, F)$。$F$ 没有邻居。\n    -   $Q = []$。\n\n算法终止，排序列表 $L$ 包含所有 $6$ 个顶点。这验证了该图是DAG。一个有效的拓扑排序是 $(A, B, C, D, E, F)$。\n\n**计算不同拓扑排序的总数**\n\n不同拓扑排序的数量可以通过考虑排序过程中每一步的可用选择数量来计算。这等价于枚举Kahn算法的决策树表示中的所有路径。\n\n1.  **位置 1**：唯一入度为 $0$ 的顶点是 $A$。只有 $1$ 个选择。\n    -   排序：$(A, \\ldots)$。下一步可用顶点：$\\{B, C\\}$。\n\n2.  **位置 2**：我们可以选择 $B$ 或 $C$。这产生了两个主要分支。\n\n    -   **分支 1：为位置 2 选择 $B$。**\n        -   排序前缀：$(A, B)$。\n        -   现在，可用顶点集（在剩余图中的入度为 $0$）是 $\\{C, D\\}$。\n        -   **子分支 1.1：为位置 3 选择 $C$。**\n            -   排序前缀：$(A, B, C)$。\n            -   可用集：$\\{D, E\\}$（因为 $E$ 的前驱 $B$ 和 $C$ 已被放置）。\n            -   对于位置 $4$ 和 $5$，我们可以按任意顺序放置 $D$ 和 $E$，因为它们现在是独立的（它们之间没有边）。这给出 $2! = 2$ 种排列：$(D, E)$ 或 $(E, D)$。\n            -   位置 $6$ 必须是 $F$。\n            -   该子分支产生 $2$ 种排序：$(A, B, C, D, E, F)$ 和 $(A, B, C, E, D, F)$。\n        -   **子分支 1.2：为位置 3 选择 $D$。**\n            -   排序前缀：$(A, B, D)$。\n            -   唯一可用的顶点是 $C$（$E$ 仍需要 $C$；$F$ 需要 $C, D, E$）。\n            -   **位置 4**：必须是 $C$。排序前缀：$(A, B, D, C)$。\n            -   现在 $E$ 可用（前驱 $B, C$ 已被放置）。\n            -   **位置 5**：必须是 $E$。排序前缀：$(A, B, D, C, E)$。\n            -   **位置 6**：必须是 $F$。\n            -   该子分支产生 $1$ 种排序：$(A, B, D, C, E, F)$。\n        -   分支 1 的总数（以 $A, B$ 开头）：$2 + 1 = 3$ 种排序。\n\n    -   **分支 2：为位置 2 选择 $C$。**\n        -   排序前缀：$(A, C)$。\n        -   唯一可用的顶点是 $B$（$D$ 和 $E$ 仍需要 $B$）。\n        -   **位置 3**：必须是 $B$。排序前缀：$(A, C, B)$。\n        -   现在的可用顶点集是 $\\{D, E\\}$。\n        -   这种情况与子分支 1.1 对称。我们已经放置了 $\\{A, B, C\\}$，现在必须对 $\\{D, E, F\\}$ 进行排序，其中 $D \\prec F$ 和 $E \\prec F$。可用的选择是 $D$ 和 $E$，它们是独立的。\n        -   我们可以用 $2! = 2$ 种方式放置它们：$(D,E)$ 或 $(E,D)$，然后是 $F$。\n        -   该分支产生 $2$ 种排序：$(A, C, B, D, E, F)$ 和 $(A, C, B, E, D, F)$。\n        -   分支 2 的总数（以 $A, C$ 开头）：$2$ 种排序。\n\n3.  **总数**：不同拓扑排序的总数是所有初始分支计数之和：$3 + 2 = 5$。\n\n这 $5$ 种不同的有效拓扑排序是：\n-   $(A,B,C,D,E,F)$\n-   $(A,B,C,E,D,F)$\n-   $(A,B,D,C,E,F)$\n-   $(A,C,B,D,E,F)$\n-   $(A,C,B,E,D,F)$\n总数是 $5$。",
            "answer": "$$\n\\boxed{5}\n$$"
        },
        {
            "introduction": "在信号网络中，正反馈回路（即有向环）可能导致信号的持续激活，这在癌症等疾病中是常见的病理特征。因此，理解和控制这些网络环路的动态至关重要。加权有向图的谱半径 $\\rho(A)$ 是一个关键指标，它决定了网络信号是会放大还是会衰减，而反馈顶点集（FVS）则可以帮助我们识别破坏所有环路所需的关键节点 。这项综合性练习将引导你通过计算最小反馈顶点集来分析网络结构，并模拟靶向干预，以找到最有效地降低网络谱半径、从而抑制病理信号传播的策略。",
            "id": "3303023",
            "problem": "给定代表线性化信号网络的加权有向图，其中每个节点代表一个信号实体，从节点 $i$ 到节点 $j$ 的每条有向边都有一个非负权重 $w_{ij}$，该权重解释为从 $i$ 到 $j$ 的磷酸基转移速率。对于这样一个包含 $n$ 个节点的图，我们定义加权邻接矩阵 $A \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$，其元素为 $A_{ij} = w_{ij}$。考虑信号在不动点附近的传播的线性离散时间近似 $x_{t+1} = A x_t$，其中 $x_t \\in \\mathbb{R}^n$ 表示活动水平。$A$ 的谱半径 $\\rho(A)$ 定义为 $\\rho(A) = \\max\\{|\\lambda| : \\lambda \\in \\mathbb{C} \\text{ 是 } A \\text{ 的一个特征值}\\}$。它量化了每个时间步的渐近放大因子。如果 $\\rho(A)  1$，线性化活动会衰减；如果 $\\rho(A)  1$，它会增长；如果 $\\rho(A) = 0$，矩阵是幂零的。\n\n反馈顶点集 (feedback vertex set, FVS) 是一个节点子集，移除该子集可以破坏图中所有的有向环。形式上，对于一个有向图 $G = (V,E)$，其中 $|V| = n$，一个子集 $S \\subseteq V$ 是一个反馈顶点集，如果其在 $V \\setminus S$ 上的导出子图是一个有向无环图 (directed acyclic graph, DAG)。最小反馈顶点集 (minimum FVS) 是基数最小的 FVS。在具有非负权重的加权有向图中，移除一组节点 $S$ 对应于通过删除 $A$ 中由 $S$ 索引的行和列来形成主子矩阵 $A[V \\setminus S]$。对于任何 DAG $H$，其邻接矩阵 $A_H$ 在适当的拓扑排序下是严格上三角矩阵，因此是幂零的，这意味着 $\\rho(A_H) = 0$。\n\n您的任务是实现一个程序，为每个测试用例从第一性原理出发执行以下计算：\n\n1) 通过枚举节点子集并测试导出无权结构的无环性来计算最小反馈顶点集 $S^\\star$。其中，当且仅当 $w_{ij}  0$ 时，我们认为边 $i \\to j$ 存在。在所有最小基数的 FVS 中，报告当节点按从 $0$ 开始的升序整数标记时字典序最小的一个。\n\n2) 给定一个干预预算 $b \\in \\mathbb{Z}_{\\ge 0}$，计算一个子集 $T \\subseteq V$ 且 $|T| \\le b$，使得 $\\rho(A[V \\setminus T])$ 最小化。如果在预算下有多个子集达到相同的最小谱半径，则选择其中基数最小的子集；如果仍然存在平局，则选择字典序最小的子集。对于空矩阵（所有节点被移除），定义 $\\rho(\\cdot) = 0$。\n\n实现细节和精度要求：\n\n- 节点由整数 $0,1,\\dots,n-1$ 标记。\n\n- 当且仅当边的权重 $w_{ij}$ 满足 $w_{ij}  0$ 时，才认为该边存在；不要引入任何其他阈值化处理。\n\n- 谱半径必须通过实非负矩阵的特征值进行数值计算，然后使用传统四舍五入方法保留六位小数。\n\n- 所有浮点数输出都必须如上所述进行四舍五入。整数和整数列表必须是精确的。\n\n- 在检查无环性时，您必须使用例如拓扑排序准则来测试由正权重导出的无权有向结构。\n\n测试套件：\n\n提供代码，为以下三个测试用例解决任务。对于每个用例，请指定节点集 $V = \\{0,1,\\dots,n-1\\}$ 和带权重的边 $(i,j,w_{ij})$。\n\n- 测试用例 A:\n  - 节点：$V = \\{0,1,2,3\\}$。\n  - 带权重的边：\n    - $(0,1,0.9)$, $(1,0,0.8)$,\n    - $(2,3,1.1)$, $(3,2,0.7)$。\n  - 预算：$b_1 = 1$, $b_2 = 2$。\n\n- 测试用例 B:\n  - 节点：$V = \\{0,1,2,3,4\\}$。\n  - 带权重的边：\n    - $(0,1,0.5)$, $(1,2,1.2)$, $(2,0,0.6)$, $(2,3,0.4)$, $(3,4,0.3)$。\n  - 预算：$b_1 = 0$, $b_2 = 1$。\n\n- 测试用例 C:\n  - 节点：$V = \\{0,1,2,3,4\\}$。\n  - 带权重的边：\n    - $(0,1,0.2)$, $(0,2,0.1)$, $(1,3,0.4)$, $(2,3,0.3)$, $(3,4,0.5)$。\n  - 预算：$b_1 = 0$, $b_2 = 1$。\n\n最终输出格式：\n\n对于每个测试用例，您的程序必须生成一个包含六个条目的列表：\n- 最小 FVS 大小（一个整数），\n- 一个最小 FVS（一个整数列表，在所有最小 FVS 中字典序最小），\n- 预算 $b_1$ 下的最小谱半径（一个保留六位小数的浮点数），\n- 为 $b_1$ 选择的子集（一个整数列表），\n- 预算 $b_2$ 下的最小谱半径（一个保留六位小数的浮点数），\n- 为 $b_2$ 选择的子集（一个整数列表）。\n\n将每个测试用例的结果按 A, B, C 的顺序汇总到一个列表中。您的程序应生成单行输出，其中包含一个列表字面量形式的结果，例如：\n[[minFVS_A,[...],rhoA_b1,[...],rhoA_b2,[...]],[minFVS_B,[...],rhoB_b1,[...],rhoB_b2,[...]],[minFVS_C,[...],rhoC_b1,[...],rhoC_b2,[...]]]",
            "solution": "问题陈述已经过仔细验证，并被确定为是合理的。它在科学上基于应用于计算系统生物学的线性系统理论和图论原理。该问题是适定 (well-posed) 的，具有明确的目标、约束和确定性的平局打破规则，确保了唯一解。考虑到图的规模较小，使用指定的基于枚举的方法，所提供的测试用例在计算上是可行的。\n\n解决方案分为两个主要任务：寻找最小反馈顶点集 (FVS) 和优化干预策略以最小化网络邻接矩阵的谱半径。\n\n**任务 1：最小反馈顶点集 (FVS)**\n\n目标是找到一个最小反馈顶点集 $S^\\star$，这是一个基数尽可能小的节点子集 $S \\subseteq V$，使得移除它后图变为无环图。问题规定，在所有最小规模的 FVS 中，应报告字典序最小的那个。\n\n该算法通过系统地搜索 FVS 来进行，优先考虑最小基数，其次是字典序。\n$1$. 我们遍历可能的 FVS 大小 $k$，从 $k=0$ 开始，直到节点总数 $n = |V|$。\n$2$. 对于每个大小 $k$，我们生成所有基数为 $|S|=k$ 的可能子集 $S \\subseteq V$。这些子集按字典序生成。\n$3$. 对于每个候选子集 $S$，我们测试它是否为有效的 FVS。这通过在剩余顶点上构建导出子图 $G[V \\setminus S]$ 并检查该子图是否有向无环图 (DAG) 来完成。\n$4$. 找到的第一个作为 FVS 的子集 $S$ 被保证具有最小基数（因为我们从下往上迭代 $k$），并且在所有最小 FVS 中是字典序最小的（因为对于固定的 $k$，我们按字典序生成子集）。\n\n为了检查一个图是否是 DAG，我们采用基于拓扑排序的标准方法 Kahn 算法。对于给定节点集 $V'$ 上的子图，该算法工作如下：\na. 计算每个节点 $v \\in V'$ 的入度。节点的入度是指来自 $V'$ 内其他节点的入边数量。\nb. 用 $V'$ 中所有入度为 $0$ 的节点初始化一个队列。\nc. 维护一个已访问节点的计数，初始化为 $0$。\nd. 当队列不为空时，出队一个节点 $u$，增加已访问节点的计数，并对于 $u$ 的每个在 $V'$ 内的邻居 $v$，将其入度减一。如果 $v$ 的入度变为 $0$，则将 $v$ 入队。\ne. 循环终止后，如果已访问节点的计数等于子图中的节点数 $|V'|$，则该子图是 DAG。否则，它至少包含一个环。\n\n此任务的无权图结构由规则定义：当且仅当权重 $w_{ij}  0$ 时，从 $i$ 到 $j$ 的边存在。\n\n**任务 2：最小化谱半径的最优干预**\n\n第二个任务是找到一个要移除的节点子集 $T \\subseteq V$，在预算约束 $|T| \\le b$ 下，使得谱半径 $\\rho(A[V \\setminus T])$ 最小化。矩阵 $M$ 的谱半径 $\\rho(M)$ 是其特征值中的最大绝对值，即 $\\rho(M) = \\max_i |\\lambda_i|$。对于非负矩阵，Perron-Frobenius 定理保证 $\\rho(M)$ 是一个非负实特征值。\n\n平局打破规则要求在那些达到最小谱半径的子集中选择基数 $|T|$ 最小的子集 $T$；如果平局仍然存在，则选择字典序最小的子集。\n\n这个优化问题通过枚举所有有效的候选子集 $T$ 并比较得到的谱半径来解决。搜索的组织方式自然地遵循了平局打破规则：\n$1$. 我们遍历集合 $T$ 的可能子集大小 $k$，从 $k=0$ 到预算 $b$。这优先考虑了较小的基数。\n$2$. 对于每个大小 $k$，我们按字典序生成所有基数为 $|T|=k$ 的子集 $T \\subseteq V$。\n$3$. 对于每个子集 $T$，我们定义剩余节点集 $V' = V \\setminus T$。然后，我们通过选择原始邻接矩阵 $A$ 中对应于 $V'$ 中节点的行和列来构造主子矩阵 $A[V']$。\n$4$. 我们数值计算 $A[V']$ 的特征值。如果 $V'$ 是空的，则得到的矩阵是空的，其谱半径定义为 $0$。否则，我们使用标准的数值库来找到特征值 $\\lambda_i$。\n$5$. 谱半径计算为 $\\rho(A[V']) = \\max_i |\\lambda_i|$，并按规定四舍五入到六位小数。\n$6$. 我们维护一个变量用于记录到目前为止找到的最小谱半径 $\\rho_{min}$，以及相应的最优子集 $T_{opt}$。第一次为一个子集 $T$ 计算谱半径 $\\rho$ 时，我们设置 $\\rho_{min} = \\rho$ 和 $T_{opt} = T$。随后，只有当我们找到一个新的子集 $T'$ 产生严格更小的谱半径 $\\rho'  \\rho_{min}$ 时，我们才更新这些值。由于是有序枚举（按大小，然后按字典序），这个简单的更新规则足以保证最终的 $T_{opt}$ 满足所有平局打破条件。\n\n该实现将使用 `numpy` 进行线性代数运算，包括矩阵创建和特征值计算，并使用 `itertools.combinations` 来高效、有序地生成子集。",
            "answer": "[[2,[0,2],0.848528,[2],0.0,[0,2]],[1,[0],0.824823,[],0.0,[0]],[0,[],0.0,[],0.0,[]]]"
        }
    ]
}