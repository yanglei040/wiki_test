{
    "hands_on_practices": [
        {
            "introduction": "Many biological systems, from protein interaction networks to enzyme-coupled pathways, can be modeled as weighted undirected graphs where edge weights represent the strength of an interaction. A powerful tool for analyzing such networks is the graph Laplacian matrix, $L$. This practice  provides a foundational exercise in constructing the essential matrix representations of a weighted network—the adjacency matrix $A$ and degree matrix $D$—and using them to compute the Laplacian, a cornerstone for studying network diffusion, clustering, and the stability of dynamic processes on graphs.",
            "id": "3302969",
            "problem": "In computational systems biology, interaction or coupling strengths between molecular entities are often modeled as positive edge weights on an undirected graph, yielding a weighted network representation of system-level relationships. Consider a network of four enzymes labeled $\\{1,2,3,4\\}$ where the undirected edge between enzymes $i$ and $j$ has a positive coupling strength $w_{ij}$ with symmetry $w_{ij} = w_{ji} > 0$. The weighted adjacency matrix $A$ and the (weighted) degree matrix $D$ are foundational graph constructs: $A$ encodes the edge weights, and $D$ encodes the sum of incident weights at each node. The combinatorial Laplacian is defined by $L = D - A$ and is widely used to quantify diffusive coupling and smoothness of signals defined on nodes. Starting from the core definitions that for an undirected weighted graph $A$ is symmetric with $a_{ij} = w_{ij}$ for $i \\neq j$ and $a_{ii} = 0$, and $D$ is diagonal with $d_{i} = \\sum_{j=1}^{n} a_{ij}$, derive how $A$ and $D$ are constructed from $\\{w_{ij}\\}$ and hence construct $L$. Then, compute a scalar derived from $L$ by evaluating the quadratic form $x^{\\top} L x$ for a specified node signal $x$.\n\nThe biological network is given by the following undirected positive weights:\n- $w_{12} = 3.2$, $w_{13} = 0.7$, $w_{14} = 4.1$,\n- $w_{23} = 1.8$, $w_{24} = 3.3$,\n- $w_{34} = 2.5$,\n\nwith $w_{ij} = w_{ji}$ and $w_{ii} = 0$ for all $i$. Let the node signal (for instance, log-fold changes in enzyme activity) be $x = (1,\\,-1,\\,2,\\,0)^{\\top}$.\n\nTasks:\n1. Using the fundamental definitions for undirected weighted graphs, explicitly construct the weighted adjacency matrix $A$ and the degree matrix $D$.\n2. Compute the Laplacian $L = D - A$.\n3. Evaluate the quadratic form $x^{\\top} L x$.\n\nExpress your final answer as a single real number. No rounding is required; report the exact value.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It provides a complete and consistent set of definitions and data from the field of computational systems biology and graph theory. The tasks are computationally straightforward and lead to a unique, verifiable result. We proceed with the solution.\n\nThe problem requires the construction of three matrices—the weighted adjacency matrix $A$, the degree matrix $D$, and the combinatorial Laplacian $L$—for a network of four enzymes, and the subsequent evaluation of a quadratic form $x^{\\top} L x$.\n\n**Task 1: Construct the weighted adjacency matrix $A$ and the degree matrix $D$.**\n\nThe weighted adjacency matrix $A$ for an undirected graph with $n$ nodes is an $n \\times n$ symmetric matrix. Its elements, $a_{ij}$, are defined based on the edge weights $w_{ij}$ between nodes $i$ and $j$. For $i \\neq j$, $a_{ij} = w_{ij}$. The diagonal elements are zero, i.e., $a_{ii} = 0$.\n\nGiven the network of $n=4$ enzymes and the provided weights:\n$w_{12} = 3.2$, $w_{13} = 0.7$, $w_{14} = 4.1$,\n$w_{23} = 1.8$, $w_{24} = 3.3$,\n$w_{34} = 2.5$.\nAnd the symmetry condition $w_{ij} = w_{ji}$.\n\nThe $4 \\times 4$ adjacency matrix $A$ is constructed as follows:\n$$ A = \\begin{pmatrix} a_{11}  a_{12}  a_{13}  a_{14} \\\\ a_{21}  a_{22}  a_{23}  a_{24} \\\\ a_{31}  a_{32}  a_{33}  a_{34} \\\\ a_{41}  a_{42}  a_{43}  a_{44} \\end{pmatrix} = \\begin{pmatrix} 0  w_{12}  w_{13}  w_{14} \\\\ w_{21}  0  w_{23}  w_{24} \\\\ w_{31}  w_{32}  0  w_{34} \\\\ w_{41}  w_{42}  w_{43}  0 \\end{pmatrix} $$\nSubstituting the given numerical values:\n$$ A = \\begin{pmatrix} 0  3.2  0.7  4.1 \\\\ 3.2  0  1.8  3.3 \\\\ 0.7  1.8  0  2.5 \\\\ 4.1  3.3  2.5  0 \\end{pmatrix} $$\n\nThe degree matrix $D$ is a diagonal matrix where each diagonal element $d_i$ (also denoted as $d_{ii}$) represents the degree of node $i$. For a weighted graph, the degree of a node is the sum of the weights of all edges incident to it. This can be calculated by summing the elements in the corresponding row (or column) of the adjacency matrix $A$:\n$$ d_i = \\sum_{j=1}^{n} a_{ij} $$\nThe degree matrix $D$ is then:\n$$ D = \\begin{pmatrix} d_1  0  0  0 \\\\ 0  d_2  0  0 \\\\ 0  0  d_3  0 \\\\ 0  0  0  d_4 \\end{pmatrix} $$\nWe compute the individual degrees:\n$d_1 = a_{12} + a_{13} + a_{14} = 3.2 + 0.7 + 4.1 = 8.0$\n$d_2 = a_{21} + a_{23} + a_{24} = 3.2 + 1.8 + 3.3 = 8.3$\n$d_3 = a_{31} + a_{32} + a_{34} = 0.7 + 1.8 + 2.5 = 5.0$\n$d_4 = a_{41} + a_{42} + a_{43} = 4.1 + 3.3 + 2.5 = 9.9$\n\nThus, the degree matrix $D$ is:\n$$ D = \\begin{pmatrix} 8.0  0  0  0 \\\\ 0  8.3  0  0 \\\\ 0  0  5.0  0 \\\\ 0  0  0  9.9 \\end{pmatrix} $$\n\n**Task 2: Compute the Laplacian $L = D - A$.**\n\nThe combinatorial Laplacian matrix $L$ is defined as the difference between the degree matrix $D$ and the adjacency matrix $A$.\n$$ L = D - A $$\n$$ L = \\begin{pmatrix} 8.0  0  0  0 \\\\ 0  8.3  0  0 \\\\ 0  0  5.0  0 \\\\ 0  0  0  9.9 \\end{pmatrix} - \\begin{pmatrix} 0  3.2  0.7  4.1 \\\\ 3.2  0  1.8  3.3 \\\\ 0.7  1.8  0  2.5 \\\\ 4.1  3.3  2.5  0 \\end{pmatrix} $$\n$$ L = \\begin{pmatrix} 8.0 - 0  0 - 3.2  0 - 0.7  0 - 4.1 \\\\ 0 - 3.2  8.3 - 0  0 - 1.8  0 - 3.3 \\\\ 0 - 0.7  0 - 1.8  5.0 - 0  0 - 2.5 \\\\ 0 - 4.1  0 - 3.3  0 - 2.5  9.9 - 0 \\end{pmatrix} $$\n$$ L = \\begin{pmatrix} 8.0  -3.2  -0.7  -4.1 \\\\ -3.2  8.3  -1.8  -3.3 \\\\ -0.7  -1.8  5.0  -2.5 \\\\ -4.1  -3.3  -2.5  9.9 \\end{pmatrix} $$\n\n**Task 3: Evaluate the quadratic form $x^{\\top} L x$.**\n\nThe node signal is given by the column vector $x = \\begin{pmatrix} 1  -1  2  0 \\end{pmatrix}^{\\top}$. Its transpose is $x^{\\top} = \\begin{pmatrix} 1  -1  2  0 \\end{pmatrix}$.\nThe quadratic form $x^{\\top} L x$ is computed by matrix multiplication. First, we compute the product $L x$:\n$$ L x = \\begin{pmatrix} 8.0  -3.2  -0.7  -4.1 \\\\ -3.2  8.3  -1.8  -3.3 \\\\ -0.7  -1.8  5.0  -2.5 \\\\ -4.1  -3.3  -2.5  9.9 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\\\ 0 \\end{pmatrix} $$\n$$ L x = \\begin{pmatrix} (8.0)(1) + (-3.2)(-1) + (-0.7)(2) + (-4.1)(0) \\\\ (-3.2)(1) + (8.3)(-1) + (-1.8)(2) + (-3.3)(0) \\\\ (-0.7)(1) + (-1.8)(-1) + (5.0)(2) + (-2.5)(0) \\\\ (-4.1)(1) + (-3.3)(-1) + (-2.5)(2) + (9.9)(0) \\end{pmatrix} $$\n$$ L x = \\begin{pmatrix} 8.0 + 3.2 - 1.4 \\\\ -3.2 - 8.3 - 3.6 \\\\ -0.7 + 1.8 + 10.0 \\\\ -4.1 + 3.3 - 5.0 \\end{pmatrix} = \\begin{pmatrix} 9.8 \\\\ -15.1 \\\\ 11.1 \\\\ -5.8 \\end{pmatrix} $$\nNext, we compute the dot product of $x^{\\top}$ with the resulting vector $L x$:\n$$ x^{\\top} L x = x^{\\top} (L x) = \\begin{pmatrix} 1  -1  2  0 \\end{pmatrix} \\begin{pmatrix} 9.8 \\\\ -15.1 \\\\ 11.1 \\\\ -5.8 \\end{pmatrix} $$\n$$ x^{\\top} L x = (1)(9.8) + (-1)(-15.1) + (2)(11.1) + (0)(-5.8) $$\n$$ x^{\\top} L x = 9.8 + 15.1 + 22.2 + 0 $$\n$$ x^{\\top} L x = 24.9 + 22.2 = 47.1 $$\nThe value of the quadratic form is $47.1$.",
            "answer": "$$\n\\boxed{47.1}\n$$"
        },
        {
            "introduction": "Directed graphs are indispensable for modeling processes with inherent directionality, such as gene regulatory cascades or signaling pathways. In systems without feedback loops, which form a Directed Acyclic Graph (DAG), it is possible to establish a clear hierarchy of control from upstream regulators to downstream targets. This exercise  explores this concept through topological sorting, challenging you to determine a valid sequence of regulatory events and to quantify the number of possible valid sequences, offering insight into the network's structural constraints and flexibility.",
            "id": "3303015",
            "problem": "In a gene regulatory network used in computational systems biology, genes and transcription factors can be represented as vertices of a directed graph, where a directed edge from vertex $i$ to vertex $j$ signifies that the product of gene $i$ regulates the expression of gene $j$. Consider the following model assumptions as the fundamental base: gene regulation proceeds according to the Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein), regulatory influence propagates along directed edges, and a directed cycle corresponds to a feedback loop. A directed graph with no directed cycles is a directed acyclic graph (DAG), and such graphs admit a topological sorting, which lists vertices so that all directed edges point from earlier to later positions.\n\nYou are given a small directed gene regulatory network over the vertex set $V=\\{A,B,C,D,E,F\\}$ representing transcriptional regulation, where the direction of edges encodes precedence constraints in regulatory influence. The weighted adjacency matrix is provided, but for the purposes of hierarchical ordering, only the topology (location of nonzero entries) matters. The vertices are ordered as $(A,B,C,D,E,F)$ and the adjacency matrix $M$ is\n$$\nM \\;=\\; \\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n0  0  0  1  1  0 \\\\\n0  0  0  0  1  1 \\\\\n0  0  0  0  0  1 \\\\\n0  0  0  0  0  1 \\\\\n0  0  0  0  0  0\n\\end{pmatrix}.\n$$\nAn entry $M_{ij}=1$ indicates a directed edge $i\\to j$ and encodes that $i$ must precede $j$ in any valid hierarchical ordering; an entry $M_{ij}=0$ indicates the absence of a direct regulatory edge. Assume all nonzero entries correspond to positive weights whose magnitudes are irrelevant for precedence.\n\nTasks:\n1. Starting only from the definitions of a directed graph, directed acyclic graph, partial order, and topological sorting, explain why topological sorting of this network captures hierarchical regulation in the absence of feedback loops, and why the existence of such a sorting is equivalent to acyclicity in the directed graph.\n2. Using the given adjacency matrix $M$, verify that the directed graph is acyclic and compute:\n   - one valid topological ordering of $V$ consistent with $M$, and\n   - the total number of distinct valid topological orderings (linear extensions) of the precedence constraints encoded by $M$.\n\nAnswer specification: For the purposes of grading, report only the total number of valid topological orderings as a single integer without units. Do not round. You may find it helpful to produce a valid ordering as an intermediate step, but do not include it in the final answer.",
            "solution": "The problem is divided into a conceptual explanation and a computational task involving a specific directed graph.\n\n**Part 1: Conceptual Framework**\n\nA directed graph, $G=(V, E)$, consists of a set of vertices $V$ and a set of edges $E$, where each edge is an ordered pair of vertices $(u, v)$ representing a directed connection from $u$ to $v$. In the context of a gene regulatory network, vertices represent genes and a directed edge $(i, j)$ means the product of gene $i$ regulates gene $j$. This establishes a precedence constraint: the regulatory action of $i$ must logically precede its effect on $j$.\n\nThe collection of all such precedence constraints can be extended by transitivity. If there is a directed path from vertex $u$ to vertex $v$, we say $u$ is an ancestor of $v$, or $u$ precedes $v$, denoted $u \\prec v$. This precedence relation forms a strict partial order if and only if the graph is a Directed Acyclic Graph (DAG). A strict partial order is a binary relation that is irreflexive, asymmetric, and transitive.\n1.  **Irreflexivity**: For any vertex $v$, $v \\not\\prec v$. This means there is no path from $v$ back to itself, which is the definition of a graph having no cycles of length $1$ or greater.\n2.  **Asymmetry**: If $u \\prec v$, then $v \\not\\prec u$. If there were a path from $u$ to $v$ and a path from $v$ to $u$, their concatenation would form a directed cycle. Thus, asymmetry is a direct consequence of acyclicity.\n3.  **Transitivity**: If $u \\prec v$ and $v \\prec w$, then $u \\prec w$. If there's a path from $u$ to $v$ and one from $v$ to $w$, concatenating them forms a path from $u$ to $w$. This is inherent to the definition of path-based precedence.\n\nThe problem states that a directed cycle corresponds to a feedback loop. The absence of feedback loops is therefore equivalent to the graph being acyclic. In such a system, regulation is hierarchical: there are \"upstream\" regulators and \"downstream\" targets without the targets feeding back to influence their own regulators. This hierarchical structure is precisely what is captured by the partial order relation $\\prec$ on a DAG.\n\nA topological sorting of a directed graph is a linear ordering of all its vertices such that for every directed edge from vertex $u$ to vertex $v$, $u$ comes before $v$ in the ordering. Such an ordering is a \"flattening\" of the partial order into a total order, representing one possible valid sequence for the unfolding of regulatory events.\n\nThe existence of a topological sorting is equivalent to the graph being a DAG.\n-   **(DAG $\\implies$ Topological Sort)**: A finite DAG must have at least one vertex with an in-degree of $0$. Such a vertex can be placed first in the ordering. Removing this vertex and its outgoing edges results in a smaller subgraph which is also a DAG. This process can be repeated, selecting a vertex of in-degree $0$ from the remaining graph at each step, until all vertices are ordered. This constructive algorithm (Kahn's algorithm) always succeeds for a DAG.\n-   **(Topological Sort $\\implies$ DAG)**: Assume a topological sort exists. Let the ordering be $v_1, v_2, \\ldots, v_n$. For any edge $(v_i, v_j)$, the definition of the sort requires $i  j$. Any directed path $v_{k_1} \\to v_{k_2} \\to \\ldots \\to v_{k_m}$ must therefore satisfy $k_1  k_2  \\ldots  k_m$. A cycle is a path that starts and ends at the same vertex, say $v_i \\to \\ldots \\to v_i$. This would imply an index sequence $i  \\ldots  i$, a contradiction. Therefore, no cycles can exist.\n\nThus, a topological sort represents a valid temporal or hierarchical sequence of gene expression events, and its existence is a guarantee that the network is free of feedback loops.\n\n**Part 2: Analysis of the Given Network**\n\nThe vertex set is $V=\\{A,B,C,D,E,F\\}$. The adjacency matrix $M$ defines the edges:\n$A \\to B$, $A \\to C$\n$B \\to D$, $B \\to E$\n$C \\to E$, $C \\to F$\n$D \\to F$\n$E \\to F$\n\n**Verification of Acyclicity and finding one Topological Ordering**\nWe use Kahn's algorithm. We first compute the in-degrees of all vertices:\n-   $\\text{in-degree}(A) = 0$\n-   $\\text{in-degree}(B) = 1$\n-   $\\text{in-degree}(C) = 1$\n-   $\\text{in-degree}(D) = 1$\n-   $\\text{in-degree}(E) = 2$\n-   $\\text{in-degree}(F) = 3$\n\n1.  Initialize a queue with all vertices of in-degree $0$: $Q = [A]$.\n2.  Dequeue $A$. Add to sorted list $L$: $L=(A)$. Decrease in-degree of its neighbors ($B$, $C$).\n    -   $\\text{in-degree}(B)$ becomes $0$. Enqueue $B$.\n    -   $\\text{in-degree}(C)$ becomes $0$. Enqueue $C$.\n    -   $Q = [B, C]$.\n3.  Dequeue $B$. $L=(A, B)$. Decrease in-degree of its neighbors ($D$, $E$).\n    -   $\\text{in-degree}(D)$ becomes $0$. Enqueue $D$.\n    -   $\\text{in-degree}(E)$ becomes $2-1=1$.\n    -   $Q = [C, D]$.\n4.  Dequeue $C$. $L=(A, B, C)$. Decrease in-degree of its neighbors ($E$, $F$).\n    -   $\\text{in-degree}(E)$ becomes $1-1=0$. Enqueue $E$.\n    -   $\\text{in-degree}(F)$ becomes $3-1=2$.\n    -   $Q = [D, E]$.\n5.  Dequeue $D$. $L=(A, B, C, D)$. Decrease in-degree of its neighbor ($F$).\n    -   $\\text{in-degree}(F)$ becomes $2-1=1$.\n    -   $Q = [E]$.\n6.  Dequeue $E$. $L=(A, B, C, D, E)$. Decrease in-degree of its neighbor ($F$).\n    -   $\\text{in-degree}(F)$ becomes $1-1=0$. Enqueue $F$.\n    -   $Q = [F]$.\n7.  Dequeue $F$. $L=(A, B, C, D, E, F)$. $F$ has no neighbors.\n    -   $Q = []$.\n\nThe algorithm terminates, and the sorted list $L$ contains all $6$ vertices. This verifies that the graph is a DAG. One valid topological ordering is $(A, B, C, D, E, F)$.\n\n**Computation of the Total Number of Distinct Topological Orderings**\n\nThe number of distinct topological orderings can be calculated by considering the number of choices available at each step of the sorting process. This is equivalent to enumerating all paths in a decision-tree representation of Kahn's algorithm.\n\n1.  **Position 1**: The only vertex with in-degree $0$ is $A$. There is only $1$ choice.\n    -   Order: $(A, \\ldots)$. Available for next step: $\\{B, C\\}$.\n\n2.  **Position 2**: We can choose either $B$ or $C$. This creates two main branches.\n\n    -   **Branch 1: Choose $B$ for Position 2.**\n        -   Order prefix: $(A, B)$.\n        -   Now, the set of available vertices (in-degree $0$ in the remaining graph) is $\\{C, D\\}$.\n        -   **Sub-branch 1.1: Choose $C$ for Position 3.**\n            -   Order prefix: $(A, B, C)$.\n            -   Available set: $\\{D, E\\}$ (since $E$'s predecessors $B$ and $C$ are placed).\n            -   For positions $4$ and $5$, we can place $D$ and $E$ in any order, as they are now independent (no edge between them). This gives $2! = 2$ permutations: $(D, E)$ or $(E, D)$.\n            -   Position $6$ must be $F$.\n            -   This sub-branch yields $2$ orderings: $(A, B, C, D, E, F)$ and $(A, B, C, E, D, F)$.\n        -   **Sub-branch 1.2: Choose $D$ for Position 3.**\n            -   Order prefix: $(A, B, D)$.\n            -   The only available vertex is $C$ ( $E$ still needs $C$; $F$ needs $C$, $D$, $E$).\n            -   **Position 4**: Must be $C$. Order prefix: $(A, B, D, C)$.\n            -   Now $E$ is available (predecessors $B, C$ are placed).\n            -   **Position 5**: Must be $E$. Order prefix: $(A, B, D, C, E)$.\n            -   **Position 6**: Must be $F$.\n            -   This sub-branch yields $1$ ordering: $(A, B, D, C, E, F)$.\n        -   Total for Branch 1 (starting with $A, B$): $2 + 1 = 3$ orderings.\n\n    -   **Branch 2: Choose $C$ for Position 2.**\n        -   Order prefix: $(A, C)$.\n        -   The only available vertex is $B$ ($D$ and $E$ still need $B$).\n        -   **Position 3**: Must be $B$. Order prefix: $(A, C, B)$.\n        -   The set of available vertices is now $\\{D, E\\}$.\n        -   This situation is symmetric to Sub-branch 1.1. We have placed $\\{A, B, C\\}$ and must now order $\\{D, E, F\\}$ where $D \\prec F$ and $E \\prec F$. The available choices are $D$ and $E$, which are independent.\n        -   We can place them in $2! = 2$ ways: $(D,E)$ or $(E,D)$, followed by $F$.\n        -   This branch yields $2$ orderings: $(A, C, B, D, E, F)$ and $(A, C, B, E, D, F)$.\n        -   Total for Branch 2 (starting with $A, C$): $2$ orderings.\n\n3.  **Total Count**: The total number of distinct topological orderings is the sum of the counts from all initial branches: $3 + 2 = 5$.\n\nThe $5$ distinct valid topological orderings are:\n-   $(A,B,C,D,E,F)$\n-   $(A,B,C,E,D,F)$\n-   $(A,B,D,C,E,F)$\n-   $(A,C,B,D,E,F)$\n-   $(A,C,B,E,D,F)$\nThe total number is $5$.",
            "answer": "$$\n\\boxed{5}\n$$"
        },
        {
            "introduction": "Bipartite graphs provide a natural framework for representing interactions between two distinct classes of objects, such as drugs and their targets, or as in this problem, metabolites and the metabolic reactions that produce them. A common and critical question in these systems is whether a unique one-to-one assignment can be made between the two sets. This conceptual exercise  invites you to apply Hall's Marriage Theorem, a fundamental result in graph theory, to determine the necessary and sufficient conditions for successfully matching every metabolite to a unique producing reaction, a key consideration in analyzing the structural capacity of metabolic networks.",
            "id": "3302991",
            "problem": "Consider a metabolic network with a set of metabolites $M$ and a set of reactions $R$. Let the Stoichiometric Matrix (SM) be $S \\in \\mathbb{R}^{|M| \\times |R|}$, where $S_{m r}  0$ indicates that reaction $r \\in R$ produces metabolite $m \\in M$, and $S_{m r}  0$ indicates that reaction $r$ consumes metabolite $m$. Construct the bipartite graph $G = (M \\cup R, E)$ where an undirected edge $\\{m, r\\} \\in E$ is present if and only if $S_{m r}  0$. One seeks an injective assignment $f: M \\to R$ such that $\\{m, f(m)\\} \\in E$ for all $m \\in M$, meaning each metabolite is matched to a unique producing reaction. This question concerns the existence of such an assignment and the construction of counterexamples when it is impossible, using fundamental graph-theoretic principles at the core of bipartite matching theory.\n\nYou are asked to identify which statements correctly capture the necessary and sufficient condition for the existence of such an assignment and how to construct a counterexample when the condition does not hold. Select all that apply.\n\nA. For every subset $U \\subseteq M$, if the set of neighboring reactions $N(U) := \\{ r \\in R \\mid \\exists m \\in U \\text{ with } \\{m, r\\} \\in E \\}$ satisfies $|N(U)| \\geq |U|$, then there exists an injective assignment $f: M \\to R$ with $\\{m, f(m)\\} \\in E$ for all $m \\in M$, and conversely, the existence of such an assignment implies $|N(U)| \\geq |U|$ for all $U \\subseteq M$.\n\nB. If, for every subset $U \\subseteq M$, the total production capacity $\\sum_{m \\in U} \\sum_{r \\in R} \\max\\{ S_{m r}, 0 \\}$ is at least $|U|$, then an injective assignment exists even when all metabolites in $U$ are produced by a single reaction; weights from the Stoichiometric Matrix (SM) suffice to guarantee distinct assignments.\n\nC. It suffices to verify the neighbor inequality $|N(U)| \\geq |U|$ for all $U \\subseteq M$ with $|U| \\leq 2$, because if it holds for singletons and pairs, then it must hold for all larger subsets by monotonicity of neighborhood size.\n\nD. A valid counterexample can be constructed by choosing a subset $U \\subseteq M$ with $|U| = k$ such that all metabolites in $U$ are produced by fewer than $k$ reactions; for example, let $M = \\{ m_1, m_2, m_3 \\}$, $R = \\{ r_1, r_2 \\}$, and $S$ satisfy $S_{m_1 r_1}  0$, $S_{m_2 r_1}  0$, $S_{m_3 r_2}  0$, with all other $S_{m r} \\leq 0$. Then $U = \\{ m_1, m_2 \\}$ has $N(U) = \\{ r_1 \\}$, which prevents matching $m_1$ and $m_2$ to distinct reactions.\n\nE. If the directed production-consumption graph formed by directing edges from reactions to produced metabolites and from metabolites to consuming reactions is acyclic, then an injective assignment exists, because acyclicity ensures the absence of competition among metabolites for reactions.",
            "solution": "The problem asks for the necessary and sufficient condition for the existence of a matching that covers all metabolites in the set $M$, assigning each to a unique producing reaction in $R$. This is a classic problem in bipartite graph theory.\n\nThe governing principle is **Hall's Marriage Theorem**. For a bipartite graph with partitions $M$ and $R$, a matching that covers every vertex in $M$ exists if and only if for every subset of metabolites $U \\subseteq M$, the size of its neighborhood $N(U)$ (the set of all reactions that produce at least one metabolite in $U$) is at least as large as the size of the subset itself. That is, the condition $|N(U)| \\ge |U|$ must hold for all $U \\subseteq M$.\n\nLet's evaluate each statement based on this theorem:\n\n**A. Correct.** This statement is a precise and accurate formulation of Hall's Marriage Theorem applied to the given problem. It correctly states that the condition $|N(U)| \\geq |U|$ for all $U \\subseteq M$ is both necessary and sufficient for the existence of the desired injective assignment.\n\n**B. Incorrect.** This statement incorrectly introduces the magnitude of the stoichiometric coefficients (production capacity). The problem is about the existence of connections (a topological property), not their weights. It is possible for a single reaction to produce large quantities of two different metabolites. In this case, the stoichiometric condition might be met, but it's impossible to assign two metabolites to one reaction in an injective manner. Thus, Hall's condition ($|N(U)| \\ge |U|$) would be violated for the set $U$ containing those two metabolites.\n\n**C. Incorrect.** Hall's condition must be checked for all $2^{|M|}$ subsets of $M$. It is not sufficient to check only for small subsets. A counterexample can be constructed where the condition holds for all singletons and pairs but fails for a larger subset (e.g., three metabolites being produced by only two unique reactions).\n\n**D. Correct.** This statement accurately describes how a counterexample to the existence of a matching is formed. If a matching that covers $M$ does not exist, it is precisely because there is a \"violating set\" $U \\subseteq M$ for which $|N(U)|  |U|$. The example provided is a perfect illustration of such a violating set. The set $U = \\{m_1, m_2\\}$ has size 2, but its neighborhood $N(U) = \\{r_1\\}$ has size 1. Since $1  2$, Hall's condition fails, and it is impossible to match both $m_1$ and $m_2$ to unique reactions.\n\n**E. Incorrect.** Acyclicity in a larger production-consumption graph is unrelated to the matching condition in the simpler bipartite production graph. A network can be acyclic but still possess a \"bottleneck\" where more metabolites than reactions exist in a local part of the network, violating Hall's condition. Competition for reactions is a matter of neighborhood size, not the presence or absence of feedback loops.\n\nTherefore, statements A and D are the correct ones.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}