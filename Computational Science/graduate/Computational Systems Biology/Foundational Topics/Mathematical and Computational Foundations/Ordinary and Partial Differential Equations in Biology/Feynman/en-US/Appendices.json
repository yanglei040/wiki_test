{
    "hands_on_practices": [
        {
            "introduction": "Before we can trust the predictions of a kinetic model, we must ensure it is physically plausible. This exercise focuses on the crucial link between reaction kinetics and thermodynamics, which imposes fundamental constraints on the rate constants. You will practice applying the principle of detailed balance to a cyclic reaction network to derive and enforce the Wegscheider condition, a cornerstone of thermodynamically consistent modeling .",
            "id": "3335929",
            "problem": "Consider a closed, well-mixed biochemical system of three species $A$, $B$, and $C$ connected by three reversible unimolecular reactions $A \\rightleftharpoons B$, $B \\rightleftharpoons C$, and $C \\rightleftharpoons A$ under isothermal conditions. Assume mass-action kinetics with strictly positive rate constants and concentrations. Let the forward rate constant for $A \\to B$ be $k_{1}^{+}$ and the reverse be $k_{1}^{-}$, for $B \\to C$ be $k_{2}^{+}$ and the reverse be $k_{2}^{-}$, and for $C \\to A$ be $k_{3}^{+}$ and the reverse be $k_{3}^{-}$. The concentration vector is $\\mathbf{c}(t) = (c_{A}(t), c_{B}(t), c_{C}(t))$ and the dynamics obey the ordinary differential equations\n$$\n\\frac{dc_{A}}{dt} = -k_{1}^{+} c_{A} + k_{1}^{-} c_{B} - k_{3}^{-} c_{A} + k_{3}^{+} c_{C}, \\quad\n\\frac{dc_{B}}{dt} = k_{1}^{+} c_{A} - k_{1}^{-} c_{B} - k_{2}^{+} c_{B} + k_{2}^{-} c_{C}, \\quad\n\\frac{dc_{C}}{dt} = k_{2}^{+} c_{B} - k_{2}^{-} c_{C} + k_{3}^{-} c_{A} - k_{3}^{+} c_{C}.\n$$\nStart from the Second Law of Thermodynamics and the definition of chemical potential in a dilute solution, and use mass-action kinetics to formalize the entropy production rate. The nondimensional entropy production rate (normalized by the Boltzmann constant), defined reaction-wise as the sum of flux–affinity products, is\n$$\n\\sigma(\\mathbf{c}) = \\sum_{r=1}^{3} \\left( v_{r}^{+}(\\mathbf{c}) - v_{r}^{-}(\\mathbf{c}) \\right) \\ln\\!\\left( \\frac{v_{r}^{+}(\\mathbf{c})}{v_{r}^{-}(\\mathbf{c})} \\right),\n$$\nwhere for reaction $r$ the forward and reverse mass-action rates are $v_{r}^{+}(\\mathbf{c})$ and $v_{r}^{-}(\\mathbf{c})$, respectively.\n\nYou are given the numerical values $k_{1}^{+} = 4$, $k_{1}^{-} = 1$, $k_{2}^{+} = 3$, $k_{2}^{-} = 2$, $k_{3}^{-} = 5$, and an initial (to-be-corrected) value $k_{3}^{+}(0) = 6$. You are also given the state $\\mathbf{c} = (c_{A}, c_{B}, c_{C}) = (2, 1, 4)$ at which to evaluate $\\sigma(\\mathbf{c})$. For this closed cycle, thermodynamic consistency requires that there exists a detailed-balance equilibrium with zero cycle affinity, which implies the Wegscheider condition for the cycle $A \\to B \\to C \\to A$.\n\nTasks:\n1. Derive from first principles the Wegscheider condition for this unimolecular cycle by imposing zero cycle affinity at detailed balance, and use it to determine the unique multiplicative correction factor $f$ such that the corrected forward rate constant $\\tilde{k}_{3}^{+} = f \\, k_{3}^{+}(0)$ makes the network thermodynamically consistent.\n2. Using the corrected $\\tilde{k}_{3}^{+}$, derive the nondimensional entropy production rate $\\sigma(\\mathbf{c})$ at the given state $\\mathbf{c}$, prove it is nonnegative, and compute its exact expression in terms of natural logarithms.\n3. Linearize the dynamics at a detailed-balance equilibrium $\\mathbf{c}^{*}$ and relate the symmetry of an appropriately weighted Jacobian to stability constraints on the stoichiometric subspace, explaining how detailed balance implies a symmetric similarity transform and real, nonpositive spectrum except for the conserved mode.\n\nReport as your final answer only the exact rational number for the multiplicative correction factor $f$ that enforces the Wegscheider condition. Express $f$ in exact rational form. Do not include units and do not round.",
            "solution": "The problem asks for the calculation of a multiplicative correction factor $f$ that ensures a given set of reaction rate constants is thermodynamically consistent. This consistency is enforced by the Wegscheider condition, which arises from the principle of detailed balance in a closed reaction cycle at equilibrium.\n\nThe system consists of three species $A$, $B$, and $C$ involved in a cyclic reaction network:\n$A \\underset{k_{1}^{-}}{\\stackrel{k_{1}^{+}}{\\rightleftharpoons}} B$\n$B \\underset{k_{2}^{-}}{\\stackrel{k_{2}^{+}}{\\rightleftharpoons}} C$\n$C \\underset{k_{3}^{-}}{\\stackrel{k_{3}^{+}}{\\rightleftharpoons}} A$\n\nThe problem states that thermodynamic consistency requires the existence of a detailed-balance equilibrium. At a detailed-balance equilibrium state, denoted by concentrations $\\mathbf{c}^{*} = (c_{A}^{*}, c_{B}^{*}, c_{C}^{*})$, the net flux for every reaction is zero, which means the forward rate equals the reverse rate for each reaction individually:\n$v_{r}^{+}(\\mathbf{c}^{*}) = v_{r}^{-}(\\mathbf{c}^{*})$ for $r=1, 2, 3$.\n\nThis gives the following set of equations:\n1. $k_{1}^{+} c_{A}^{*} = k_{1}^{-} c_{B}^{*}$\n2. $k_{2}^{+} c_{B}^{*} = k_{2}^{-} c_{C}^{*}$\n3. $k_{3}^{+} c_{C}^{*} = k_{3}^{-} c_{A}^{*}$\n\nFrom these equations, we can express the ratios of equilibrium concentrations in terms of the rate constants:\n1. $\\frac{c_{B}^{*}}{c_{A}^{*}} = \\frac{k_{1}^{+}}{k_{1}^{-}}$\n2. $\\frac{c_{C}^{*}}{c_{B}^{*}} = \\frac{k_{2}^{+}}{k_{2}^{-}}$\n3. $\\frac{c_{A}^{*}}{c_{C}^{*}} = \\frac{k_{3}^{+}}{k_{3}^{-}}$\n\nFor these three equations to hold simultaneously for a non-trivial equilibrium state (where all concentrations are positive), a consistency condition must be satisfied by the rate constants. We can see this by multiplying the three ratios:\n$$ \\left(\\frac{c_{B}^{*}}{c_{A}^{*}}\\right) \\left(\\frac{c_{C}^{*}}{c_{B}^{*}}\\right) \\left(\\frac{c_{A}^{*}}{c_{C}^{*}}\\right) = 1 $$\nSubstituting the expressions in terms of rate constants yields the Wegscheider condition for this cycle:\n$$ \\left(\\frac{k_{1}^{+}}{k_{1}^{-}}\\right) \\left(\\frac{k_{2}^{+}}{k_{2}^{-}}\\right) \\left(\\frac{k_{3}^{+}}{k_{3}^{-}}\\right) = 1 $$\nThis can be rewritten as:\n$$ k_{1}^{+} k_{2}^{+} k_{3}^{+} = k_{1}^{-} k_{2}^{-} k_{3}^{-} $$\nThis condition is a fundamental constraint on the kinetic parameters of any closed reaction loop that is required to obey detailed balance. This can also be derived by requiring that the net thermodynamic affinity around the cycle is zero.\n\nThe problem provides an initial, possibly inconsistent rate constant $k_{3}^{+}(0) = 6$ and asks for a correction factor $f$ such that the corrected constant $\\tilde{k}_{3}^{+} = f \\cdot k_{3}^{+}(0)$ makes the system thermodynamically consistent. We must impose the Wegscheider condition using this corrected constant:\n$$ k_{1}^{+} k_{2}^{+} \\tilde{k}_{3}^{+} = k_{1}^{-} k_{2}^{-} k_{3}^{-} $$\nSubstituting $\\tilde{k}_{3}^{+} = f \\cdot k_{3}^{+}(0)$:\n$$ k_{1}^{+} k_{2}^{+} \\left(f \\cdot k_{3}^{+}(0)\\right) = k_{1}^{-} k_{2}^{-} k_{3}^{-} $$\nWe can now solve for the correction factor $f$:\n$$ f = \\frac{k_{1}^{-} k_{2}^{-} k_{3}^{-}}{k_{1}^{+} k_{2}^{+} k_{3}^{+}(0)} $$\nThe problem provides the following numerical values for the rate constants:\n$k_{1}^{+} = 4$\n$k_{1}^{-} = 1$\n$k_{2}^{+} = 3$\n$k_{2}^{-} = 2$\n$k_{3}^{-} = 5$\n$k_{3}^{+}(0) = 6$\n\nSubstituting these values into the expression for $f$:\n$$ f = \\frac{(1) \\cdot (2) \\cdot (5)}{(4) \\cdot (3) \\cdot (6)} $$\n$$ f = \\frac{10}{72} $$\nSimplifying the fraction gives:\n$$ f = \\frac{5}{36} $$\nThis is the unique multiplicative correction factor that ensures the rate constants for the reaction network satisfy the condition of detailed balance. The other tasks in the problem statement, while valid extensions of this analysis, are not required for determining the final answer requested.",
            "answer": "$$\\boxed{\\frac{5}{36}}$$"
        },
        {
            "introduction": "Reaction-diffusion systems often generate sharp spatial patterns, such as boundary layers, where concentrations change dramatically over short distances. This exercise introduces matched asymptotic expansions, a powerful analytical technique for dissecting such multiscale phenomena when diffusion is slow compared to reaction. By constructing separate 'inner' and 'outer' solutions, you will build a uniformly valid approximation that captures the system's behavior across the entire domain .",
            "id": "3335892",
            "problem": "A one-dimensional, dimensionless reaction–diffusion steady state for a bistable regulatory protein concentration $u(x)$ along a cell of length scaled to $[0,1]$ is modeled by the ordinary differential equation\n$$\nD\\,u''(x) + f(u(x)) = 0, \\quad x \\in (0,1),\n$$\nwith small diffusivity parameter $0 < D \\ll 1$. The reaction term arises from coarse-grained kinetics with two stable expression states and is taken as $f(u) = u - u^{3}$. Boundary concentrations are clamped by membrane-associated processes so that\n$$\nu(0) = \\frac{4}{5}, \\qquad u(1) = 1.\n$$\nStarting from fundamental balances for steady reaction–diffusion systems (Fick’s law for diffusive flux and stationarity of concentration implying diffusive flux divergence balances local reaction), use matched asymptotic expansions to determine where boundary layers must form and their characteristic thickness. Then, derive the leading-order outer solution and the appropriate inner problem near any boundary layer(s), and solve the inner problem to obtain a closed-form expression that matches the outer solution. Finally, construct a uniformly valid leading-order composite approximation $u_{\\mathrm{comp}}(x;D)$.\n\nProvide your final answer as a single closed-form analytic expression for $u_{\\mathrm{comp}}(x;D)$ in terms of $x$ and $D$. Do not round; no units are required.",
            "solution": "The problem provided is a valid, self-contained, and well-posed boundary value problem for a nonlinear ordinary differential equation. It is a classic example of a singular perturbation problem in the context of reaction-diffusion systems, which is a core topic in computational systems biology. We can proceed with a solution using the method of matched asymptotic expansions.\n\nThe provided steady-state reaction-diffusion equation is:\n$$D u''(x) + f(u(x)) = 0, \\quad x \\in (0, 1)$$\nwith the reaction term $f(u) = u - u^3$ and boundary conditions $u(0) = 4/5$ and $u(1) = 1$. The parameter $D$ is small, $0 < D \\ll 1$.\n\nThe equation can be interpreted as a steady-state mass balance. Let $J(x) = -D u'(x)$ be the diffusive flux (Fick's law). The equation becomes $\\frac{dJ}{dx} = -f(u)$, which states that the spatial change in flux is balanced by the local reaction rate.\n\n**Step 1: Outer Solution**\nIn the outer region, away from any boundary layers, we assume the solution $u(x)$ varies slowly. The term $D u''(x)$ is thus negligible compared to the reaction term $f(u(x))$. We find the leading-order outer solution, $u_{out}(x)$, by setting $D=0$ in the original equation:\n$$f(u_{out}(x)) = 0$$\n$$u_{out} - u_{out}^3 = 0 \\implies u_{out}(1 - u_{out}^2) = 0$$\nThis algebraic equation has three constant solutions: $u_{out} = -1$, $u_{out} = 0$, and $u_{out} = 1$. Since $u(x)$ represents a protein concentration, it must be non-negative, so we only consider $u_{out}=0$ and $u_{out}=1$.\n\nFor a reaction-diffusion system, the outer solution must correspond to a stable steady state of the reaction kinetics, described by the ODE $\\frac{du}{dt} = f(u)$. The stability is determined by the sign of $f'(u) = 1 - 3u^2$.\n- For $u=0$, $f'(0) = 1 > 0$, so this state is unstable.\n- For $u=1$, $f'(1) = 1-3 = -2 < 0$, so this state is stable.\nAny small perturbation would cause the solution to move away from the unstable state $u=0$. Therefore, the only valid leading-order outer solution is $u_{out}(x) = 1$.\n\nWe check this outer solution against the boundary conditions:\n- At $x=1$, $u_{out}(1)=1$, which matches the boundary condition $u(1)=1$.\n- At $x=0$, $u_{out}(0)=1$, which does not match the boundary condition $u(0)=4/5$.\n\nThis discrepancy signifies the presence of a boundary layer at $x=0$, where the solution changes rapidly to satisfy the boundary condition. No boundary layer is needed at $x=1$.\n\n**Step 2: Inner Solution and Boundary Layer Analysis**\nTo analyze the boundary layer at $x=0$, we introduce a stretched inner coordinate $X = \\frac{x}{\\delta(D)}$, where $\\delta(D)$ is the characteristic thickness of the layer. Let the inner solution be $u_{in}(X) \\equiv u(x)$. The derivatives transform as:\n$$\\frac{du}{dx} = \\frac{1}{\\delta} \\frac{du_{in}}{dX}, \\qquad \\frac{d^2u}{dx^2} = \\frac{1}{\\delta^2} \\frac{d^2u_{in}}{dX^2}$$\nSubstituting into the ODE gives:\n$$\\frac{D}{\\delta^2} \\frac{d^2u_{in}}{dX^2} + u_{in} - u_{in}^3 = 0$$\nTo obtain a distinguished limit where the diffusive and reaction terms balance, we must set the coefficient of the highest derivative to be of order one. We choose $\\frac{D}{\\delta^2} = 1$, which implies $\\delta = \\sqrt{D}$.\nThus, the boundary layer has a characteristic thickness of order $O(\\sqrt{D})$, and the inner coordinate is $X = \\frac{x}{\\sqrt{D}}$. The leading-order inner equation is:\n$$\\frac{d^2u_{in}}{dX^2} + u_{in} - u_{in}^3 = 0$$\nThe inner solution must satisfy the boundary condition at $x=0$:\n$$u_{in}(X=0) = u(0) = \\frac{4}{5}$$\nIt must also match the outer solution as the inner variable goes to infinity. The matching condition is:\n$$\\lim_{X \\to \\infty} u_{in}(X) = \\lim_{x \\to 0^+} u_{out}(x) = 1$$\nTo solve the second-order inner ODE, we multiply by $\\frac{du_{in}}{dX}$ and integrate with respect to $X$:\n$$\\int \\frac{du_{in}}{dX}\\frac{d^2u_{in}}{dX^2} dX + \\int (u_{in} - u_{in}^3)\\frac{du_{in}}{dX} dX = C_1$$\n$$\\frac{1}{2}\\left(\\frac{du_{in}}{dX}\\right)^2 + \\frac{1}{2}u_{in}^2 - \\frac{1}{4}u_{in}^4 = C_1$$\nWe use the matching condition at infinity to find the constant $C_1$. As $X \\to \\infty$, $u_{in} \\to 1$ and its derivative $\\frac{du_{in}}{dX} \\to 0$.\n$$\\frac{1}{2}(0)^2 + \\frac{1}{2}(1)^2 - \\frac{1}{4}(1)^4 = C_1 \\implies C_1 = \\frac{1}{4}$$\nSubstituting $C_1$ back:\n$$\\frac{1}{2}\\left(\\frac{du_{in}}{dX}\\right)^2 = \\frac{1}{4} - \\frac{1}{2}u_{in}^2 + \\frac{1}{4}u_{in}^4 = \\frac{1}{4}(1 - 2u_{in}^2 + u_{in}^4) = \\frac{1}{4}(1 - u_{in}^2)^2$$\n$$\\left(\\frac{du_{in}}{dX}\\right)^2 = \\frac{1}{2}(1 - u_{in}^2)^2 \\implies \\frac{du_{in}}{dX} = \\pm \\frac{1}{\\sqrt{2}}(1 - u_{in}^2)$$\nSince $u_{in}(0) = 4/5$ and $u_{in}$ must increase to approach $1$ as $X \\to \\infty$, the derivative $\\frac{du_{in}}{dX}$ must be positive. For $u_{in}$ in the range $[4/5, 1)$, the term $1 - u_{in}^2$ is positive. We must select the positive sign:\n$$\\frac{du_{in}}{dX} = \\frac{1}{\\sqrt{2}}(1 - u_{in}^2)$$\nThis is a separable first-order ODE. We separate variables and integrate:\n$$\\int \\frac{du_{in}}{1 - u_{in}^2} = \\int \\frac{1}{\\sqrt{2}} dX$$\nThe integral on the left is $\\text{arctanh}(u_{in})$.\n$$\\text{arctanh}(u_{in}) = \\frac{X}{\\sqrt{2}} + C_2$$\nWe use the boundary condition $u_{in}(0) = 4/5$ to find the integration constant $C_2$:\n$$\\text{arctanh}\\left(\\frac{4}{5}\\right) = \\frac{0}{\\sqrt{2}} + C_2 \\implies C_2 = \\text{arctanh}\\left(\\frac{4}{5}\\right)$$\nThe value of this constant can be simplified using the logarithmic definition of the inverse hyperbolic tangent, $\\text{arctanh}(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$:\n$$C_2 = \\frac{1}{2}\\ln\\left(\\frac{1+4/5}{1-4/5}\\right) = \\frac{1}{2}\\ln\\left(\\frac{9/5}{1/5}\\right) = \\frac{1}{2}\\ln(9) = \\ln(3)$$\nSo, the inner solution is given by:\n$$\\text{arctanh}(u_{in}) = \\frac{X}{\\sqrt{2}} + \\ln(3)$$\n$$u_{in}(X) = \\tanh\\left(\\frac{X}{\\sqrt{2}} + \\ln(3)\\right)$$\n\n**Step 3: Uniformly Valid Composite Solution**\nA composite solution $u_{\\mathrm{comp}}(x;D)$ that is uniformly valid across the entire domain $[0,1]$ is constructed by adding the outer and inner solutions and subtracting their common part (the overlap region).\n$$u_{\\mathrm{comp}}(x;D) = u_{out}(x) + u_{in}(X) - (\\text{common part})$$\nThe common part is the limit of the inner solution as $X \\to \\infty$, which is equal to the limit of the outer solution as $x \\to 0$:\n$$\\text{common part} = \\lim_{X \\to \\infty} u_{in}(X) = \\lim_{X \\to \\infty} \\tanh\\left(\\frac{X}{\\sqrt{2}} + \\ln(3)\\right) = 1$$\nThis matches the outer solution value, $u_{out}(x) = 1$.\nSubstituting the components:\n$$u_{\\mathrm{comp}}(x;D) = 1 + \\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right) - 1$$\nThe final composite solution is:\n$$u_{\\mathrm{comp}}(x;D) = \\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right)$$\nThis expression provides a leading-order approximation to the solution $u(x)$ that is valid for $x \\in [0,1]$. It correctly reduces to $4/5$ at $x=0$ and is asymptotically close to $1$ for $x > O(\\sqrt{D})$, satisfying both boundary conditions in the limit $D \\to 0$.",
            "answer": "$$\\boxed{\\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right)}$$"
        },
        {
            "introduction": "Most biological PDEs are too complex for analytical solutions, necessitating numerical methods. A common challenge is 'stiffness', where fast reactions and slow diffusion create stability issues for simple numerical schemes. This practice problem guides you through the analysis of an Implicit-Explicit (IMEX) method designed to handle stiffness efficiently, and has you derive the constraints on the time step required for a stable simulation .",
            "id": "3335951",
            "problem": "Consider the reaction–diffusion partial differential equation (PDE) $\\,\\partial_t u = D \\Delta u + f(u)\\,$ for a scalar field $\\,u(x,t)\\,$ on a one-dimensional periodic domain of length $\\,L\\,$ with constant diffusion coefficient $\\,D > 0\\,$ and a sufficiently smooth reaction term $\\,f(u)\\,$. Assume a uniform spatial grid with $\\,N\\,$ nodes and spacing $\\,h = L/N\\,$, and define the standard second-order central-difference discrete Laplacian operator $\\,\\Delta_h\\,$ with periodic boundary conditions, given by $\\,(\\Delta_h u)_i = \\dfrac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}\\,$, where indices wrap mod $\\,N\\,$. Your tasks are as follows.\n\n1) Starting from mass balance and Fick’s law for diffusion and the definition of forward Euler for explicit reaction, construct a semi-implicit implicit–explicit (IMEX) finite difference scheme that treats the diffusion term implicitly and the reaction term explicitly. Denote the time step by $\\,\\Delta t > 0\\,$ and write the update from level $\\,n\\,$ to $\\,n+1\\,$ for the discrete unknown $\\,u^n \\in \\mathbb{R}^N\\,$ in the form\n$$\n\\left(I - \\Delta t\\, D\\, \\Delta_h\\right) u^{n+1} \\;=\\; u^n \\;+\\; \\Delta t\\, f(u^n).\n$$\nExplain why this scheme is consistent with the PDE $\\,\\partial_t u = D \\Delta u + f(u)\\,$ under the stated discretizations.\n\n2) Perform a linear stability analysis about a spatially homogeneous steady state $\\,u^\\star\\,$ that satisfies $\\,f(u^\\star) = 0\\,$. Linearize the reaction term as $\\,f(u) \\approx f(u^\\star) + f'(u^\\star)(u - u^\\star)\\,$ and set $\\,r = f'(u^\\star)\\,$. Use the discrete Fourier modes $\\,\\varphi_k(i) = \\exp\\!\\left(2\\pi \\mathrm{i}\\, k\\, i/N\\right)\\,$ for $\\,k \\in \\{0,1,\\dots,N-1\\}\\,$ to diagonalize $\\,\\Delta_h\\,$, and recall that the corresponding eigenvalues are\n$$\n\\lambda_k \\;=\\; -\\frac{4}{h^2}\\,\\sin^2\\!\\left(\\frac{\\pi k}{N}\\right).\n$$\nDerive the scalar mode amplification factor $\\,G_k(\\Delta t)\\,$ and formulate a necessary and sufficient condition for linear stability of the IMEX scheme in terms of $\\,\\max_k |G_k(\\Delta t)| \\le 1\\,$. Show that the worst case is the zero mode $\\,k=0\\,$, and deduce the largest linearly stable time step $\\,\\Delta t_{\\max}\\,$ as a function of $\\,r\\,$. State your result clearly for the cases $\\,r < 0\\,$, $\\,r = 0\\,$, and $\\,r > 0\\,$.\n\n3) Implementation and testable outputs. Implement a program that, for each test case below, does the following:\n- Computes $\\,\\Delta t_{\\max}\\,$ in seconds using your formula from part $\\,2\\,$.\n- For two prescribed test step sizes $\\,\\Delta t_1\\,$ and $\\,\\Delta t_2\\,$ (each in seconds), evaluates the maximum amplification factor $\\,\\max_k |G_k(\\Delta t_j)|\\,$ over all discrete Fourier modes $\\,k \\in \\{0,\\dots,N-1\\}\\,$ using the eigenvalues $\\,\\lambda_k\\,$ above, and returns two booleans indicating whether the scheme is linearly stable at $\\,\\Delta t_1\\,$ and linearly unstable at $\\,\\Delta t_2\\,$, respectively. Take stability to mean $\\,\\max_k |G_k(\\Delta t_j)| \\le 1\\,$ and instability to mean $\\,\\max_k |G_k(\\Delta t_j)| > 1\\,$.\n- Note that all quantities must be treated in consistent units. Express $\\,\\Delta t_{\\max}\\,$ in seconds as a floating-point number.\n\nYour program must handle the following test suite. Each test case gives $\\,L\\,$ (length unit), $\\,N\\,$, $\\,D\\,$ (length squared per second), and a reaction model that determines $\\,r\\,$ together with two probe time steps $\\,\\Delta t_1\\,$ and $\\,\\Delta t_2\\,$ (seconds):\n- Test case $\\,1\\,$ (linear reaction, negative slope): $\\,L = 1.0\\,$, $\\,N = 64\\,$, $\\,D = 1.0 \\times 10^{-3}\\,$, $\\,f(u) = \\alpha u\\,$ with $\\,\\alpha = -10.0\\,\\mathrm{s}^{-1}\\,$ so that $\\,r = \\alpha\\,$, $\\,\\Delta t_1 = 0.18\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.22\\,\\mathrm{s}\\,$.\n- Test case $\\,2\\,$ (linear reaction, same $\\,r\\,$ but different $\\,D, N$): $\\,L = 1.0\\,$, $\\,N = 257\\,$, $\\,D = 0.2\\,$, $\\,f(u) = \\alpha u\\,$ with $\\,\\alpha = -10.0\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t_1 = 0.18\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.22\\,\\mathrm{s}\\,$.\n- Test case $\\,3\\,$ (linear reaction, positive slope): $\\,L = 1.0\\,$, $\\,N = 128\\,$, $\\,D = 0.01\\,$, $\\,f(u) = \\alpha u\\,$ with $\\,\\alpha = +2.0\\,\\mathrm{s}^{-1}\\,$ so that $\\,r = \\alpha\\,$, $\\,\\Delta t_1 = 0.001\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.1\\,\\mathrm{s}\\,$.\n- Test case $\\,4\\,$ (logistic reaction at the stable fixed point): $\\,L = 1.0\\,$, $\\,N = 100\\,$, $\\,D = 5.0 \\times 10^{-4}\\,$, $\\,f(u) = \\rho\\, u \\left(1 - \\dfrac{u}{K}\\right)\\,$ with $\\,\\rho = 7.5\\,\\mathrm{s}^{-1}\\,$, linearized at $\\,u^\\star = K\\,$ so that $\\,r = f'(K) = -\\rho\\,$, $\\,\\Delta t_1 = 0.25\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.28\\,\\mathrm{s}\\,$.\n- Test case $\\,5\\,$ (linear reaction, weakly negative slope): $\\,L = 1.0\\,$, $\\,N = 32\\,$, $\\,D = 10.0\\,$, $\\,f(u) = \\alpha u\\,$ with $\\,\\alpha = -0.1\\,\\mathrm{s}^{-1}\\,$ so that $\\,r = \\alpha\\,$, $\\,\\Delta t_1 = 10.0\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 25.0\\,\\mathrm{s}\\,$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing a top-level list of length $\\,5\\,$. Each entry is itself a list of the form $[\\Delta t_{\\max}, s_1, s_2]$, where $\\,\\Delta t_{\\max}\\,$ is a floating-point number in seconds, $\\,s_1\\,$ is a boolean equal to $\\,\\mathrm{True}\\,$ if the scheme is linearly stable at $\\,\\Delta t_1\\,$ and $\\,\\mathrm{False}\\,$ otherwise, and $\\,s_2\\,$ is a boolean equal to $\\,\\mathrm{True}\\,$ if the scheme is linearly unstable at $\\,\\Delta t_2\\,$ and $\\,\\mathrm{False}\\,$ otherwise. For example, the output must look like $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$ with commas separating entries.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard task in the numerical analysis of partial differential equations, specifically within computational systems biology where reaction-diffusion models are prevalent. The parameters and definitions are complete and consistent.\n\n### 1. Derivation and Consistency of the IMEX Scheme\n\nThe governing partial differential equation (PDE) is the reaction-diffusion equation $\\partial_t u = D \\Delta u + f(u)$. We are tasked with discretizing this equation on a one-dimensional periodic domain of length $L$ with a uniform grid of $N$ nodes, where the grid spacing is $h=L/N$.\n\nThe spatial part of the PDE is discretized using a second-order central difference for the Laplacian, resulting in the semi-discrete system of ordinary differential equations (ODEs):\n$$\n\\frac{d u_i}{d t} = D (\\Delta_h u)_i + f(u_i) \\quad \\text{for } i=0, \\dots, N-1,\n$$\nwhere $u_i(t) \\approx u(x_i, t)$ and $(\\Delta_h u)_i = (u_{i+1} - 2u_i + u_{i-1})/h^2$. In vector form, this is $\\frac{d\\vec{u}}{dt} = D \\Delta_h \\vec{u} + \\vec{f}(\\vec{u})$, where $\\vec{u} = (u_0, \\dots, u_{N-1})^T$ and $\\vec{f}(\\vec{u}) = (f(u_0), \\dots, f(u_{N-1}))^T$.\n\nThe desired implicit-explicit (IMEX) scheme treats the stiff linear diffusion term ($D \\Delta_h \\vec{u}$) implicitly and the potentially nonlinear reaction term ($\\vec{f}(\\vec{u})$) explicitly. This corresponds to using the backward Euler method for the diffusion term and the forward Euler method for the reaction term. Applying this to the semi-discrete system from time $t_n$ to $t_{n+1}=t_n+\\Delta t$, we approximate the time derivative as $(\\vec{u}^{n+1} - \\vec{u}^n)/\\Delta t$, evaluate the implicit term at the future time level $n+1$, and the explicit term at the current time level $n$:\n$$\n\\frac{\\vec{u}^{n+1} - \\vec{u}^n}{\\Delta t} = D \\Delta_h \\vec{u}^{n+1} + \\vec{f}(\\vec{u}^n).\n$$\nThis constitutes a mass balance where the rate of change is set equal to the sum of a diffusive flux evaluated implicitly and a reaction source term evaluated explicitly. Rearranging the equation to group the unknown terms $\\vec{u}^{n+1}$ on the left-hand side yields:\n$$\n\\vec{u}^{n+1} - \\Delta t D \\Delta_h \\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\vec{f}(\\vec{u}^n).\n$$\nFactoring out $\\vec{u}^{n+1}$ using the identity operator $I$, we obtain the required matrix form of the update rule:\n$$\n\\left(I - \\Delta t D \\Delta_h\\right) \\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\vec{f}(\\vec{u}^n).\n$$\n\nTo demonstrate consistency, we analyze the local truncation error, $\\tau^n_i$, by substituting the exact solution $u(x_i, t_n)$ into the finite difference equation:\n$$\n\\frac{u(x_i, t_{n+1}) - u(x_i, t_n)}{\\Delta t} = D \\Delta_h u(x_i, t_{n+1}) + f(u(x_i, t_n)).\n$$\nUsing Taylor expansions around $(x_i, t_n)$ for a sufficiently smooth solution $u$:\n\\begin{itemize}\n    \\item $u(x_i, t_{n+1}) = u(x_i, t_n) + \\Delta t \\partial_t u + \\frac{(\\Delta t)^2}{2} \\partial_{tt} u + O((\\Delta t)^3)$.\n    \\item The left-hand side becomes: $\\partial_t u + \\frac{\\Delta t}{2} \\partial_{tt} u + O((\\Delta t)^2)$.\n    \\item For the right-hand side, the discrete Laplacian is a second-order approximation to the continuous one: $\\Delta_h \\phi(x_i) = \\partial_{xx} \\phi(x_i) + O(h^2)$.\n    \\item Thus, $D \\Delta_h u(x_i, t_{n+1}) = D (\\partial_{xx} u(x_i, t_{n+1}) + O(h^2)) = D (\\partial_{xx} u(x_i, t_n) + \\Delta t \\partial_{xx}\\partial_t u + O((\\Delta t)^2) + O(h^2))$.\n\\end{itemize}\nThe truncation error is the difference between the discretized PDE and the exact PDE, $\\partial_t u - D \\partial_{xx} u - f(u) = 0$. After substituting the expansions, we find:\n$$\n\\tau_i^n = \\left(\\partial_t u + \\frac{\\Delta t}{2} \\partial_{tt} u \\right) - D\\left(\\partial_{xx} u + \\Delta t \\partial_{xx}\\partial_t u\\right) - f(u) + O((\\Delta t)^2) + O(D h^2).\n$$\nGrouping terms:\n$$\n\\tau_i^n = (\\partial_t u - D \\partial_{xx} u - f(u)) + \\frac{\\Delta t}{2} \\partial_{tt} u - D \\Delta t \\partial_{xx}\\partial_t u + O((\\Delta t)^2, h^2).\n$$\nThe first parenthesis is zero. The remaining error is $\\tau_i^n = O(\\Delta t) + O(h^2)$. As $\\Delta t \\to 0$ and $h \\to 0$, the truncation error vanishes. Therefore, the scheme is consistent, with first-order accuracy in time and second-order accuracy in space.\n\n### 2. Linear Stability Analysis\n\nWe analyze the stability of the scheme around a spatially homogeneous steady state $u^\\star$, where $f(u^\\star) = 0$. Let $\\vec{u}^n = \\vec{u}^\\star + \\delta\\vec{u}^n$, where $\\vec{u}^\\star$ is a vector with all components equal to $u^\\star$ and $\\delta\\vec{u}^n$ is a small perturbation. The reaction term is linearized as $f(u_i^n) \\approx f(u^\\star) + f'(u^\\star)\\delta u_i^n = r \\delta u_i^n$. Substituting into the scheme:\n$$\n(I - \\Delta t D \\Delta_h) (\\vec{u}^\\star + \\delta\\vec{u}^{n+1}) = (\\vec{u}^\\star + \\delta\\vec{u}^n) + \\Delta t \\vec{f}(\\vec{u}^\\star + \\delta\\vec{u}^n).\n$$\nUsing the linearization and noting that $\\Delta_h \\vec{u}^\\star = \\vec{0}$ because $\\vec{u}^\\star$ is constant:\n$$\n\\vec{u}^\\star + (I - \\Delta t D \\Delta_h) \\delta\\vec{u}^{n+1} = \\vec{u}^\\star + \\delta\\vec{u}^n + \\Delta t r \\delta\\vec{u}^n.\n$$\nThe steady state $\\vec{u}^\\star$ cancels, yielding the evolution equation for the perturbation:\n$$\n(I - \\Delta t D \\Delta_h) \\delta\\vec{u}^{n+1} = (1 + r \\Delta t) \\delta\\vec{u}^n.\n$$\nTo perform a von Neumann stability analysis, we decompose the perturbation $\\delta\\vec{u}^n$ into the discrete Fourier modes $\\vec{\\varphi}_k$, which are the eigenvectors of the circulant matrix $\\Delta_h$. Let $\\delta\\vec{u}^n = \\sum_{k=0}^{N-1} \\hat{u}_k^n \\vec{\\varphi}_k$. Since $\\Delta_h \\vec{\\varphi}_k = \\lambda_k \\vec{\\varphi}_k$, substituting the expansion into the perturbation equation and exploiting linearity allows us to analyze each mode independently:\n$$\n(1 - \\Delta t D \\lambda_k) \\hat{u}_k^{n+1} \\vec{\\varphi}_k = (1 + r \\Delta t) \\hat{u}_k^n \\vec{\\varphi}_k.\n$$\nThe amplification factor for mode $k$ is $G_k(\\Delta t) = \\hat{u}_k^{n+1}/\\hat{u}_k^n$, given by:\n$$\nG_k(\\Delta t) = \\frac{1 + r \\Delta t}{1 - \\Delta t D \\lambda_k}.\n$$\nFor linear stability, we require the magnitude of the amplification factor to be no greater than $1$ for all modes, i.e., $\\max_{k} |G_k(\\Delta t)| \\le 1$. The eigenvalues are given as $\\lambda_k = -\\frac{4}{h^2}\\sin^2(\\frac{\\pi k}{N})$, which are real and non-positive ($\\lambda_k \\le 0$). Since $D>0$ and $\\Delta t>0$, the denominator $1 - \\Delta t D \\lambda_k$ is always real and greater than or equal to $1$. The modulus of the amplification factor is:\n$$\n|G_k(\\Delta t)| = \\frac{|1 + r \\Delta t|}{1 - \\Delta t D \\lambda_k}.\n$$\nThe numerator is independent of the mode index $k$. To maximize $|G_k(\\Delta t)|$, we must minimize the denominator $1 - \\Delta t D \\lambda_k$. This occurs when $\\lambda_k$ is maximal (least negative), which corresponds to the mode $k=0$, for which $\\lambda_0 = 0$. Thus, the worst-case (largest) amplification factor is:\n$$\n\\max_{k} |G_k(\\Delta t)| = |G_0(\\Delta t)| = \\frac{|1 + r \\Delta t|}{1 - 0} = |1 + r \\Delta t|.\n$$\nThis demonstrates that the stability of this IMEX scheme is governed solely by the explicit treatment of the reaction term, independent of the diffusion coefficient $D$ and the spatial discretization $h$. The stability condition simplifies to $|1 + r \\Delta t| \\le 1$. This is equivalent to the inequality $-1 \\le 1 + r \\Delta t \\le 1$, which simplifies to $-2 \\le r \\Delta t \\le 0$.\n\nWe now determine the maximum stable time step $\\Delta t_{\\max}$ based on the sign of $r = f'(u^\\star)$:\n\\begin{itemize}\n    \\item Case $r > 0$ (unstable reaction): Since $\\Delta t > 0$, $r \\Delta t > 0$. The condition $r \\Delta t \\le 0$ can only hold if $\\Delta t = 0$. The scheme is unconditionally unstable for any $\\Delta t > 0$. Thus, $\\Delta t_{\\max} = 0$.\n    \\item Case $r = 0$ (neutrally stable reaction): The condition becomes $-2 \\le 0 \\le 0$, which is always true. The scheme is unconditionally stable. Thus, $\\Delta t_{\\max} = \\infty$.\n    \\item Case $r < 0$ (stable reaction): Since $r$ is negative, $r \\Delta t \\le 0$ is always true for $\\Delta t \\ge 0$. The remaining condition is $-2 \\le r \\Delta t$. Dividing by the negative value $r$ reverses the inequality: $\\Delta t \\le -2/r$. Thus, the maximum stable time step is $\\Delta t_{\\max} = -2/r$.\n\\end{itemize}\n\n### 3. Implementation and Testable Outputs\n\nThe implementation computes $\\Delta t_{\\max}$ using the derived formulas. It then assesses the stability for two given time steps, $\\Delta t_1$ and $\\Delta t_2$, by checking if the maximum amplification factor, $|G_0(\\Delta t_j)| = |1 + r \\Delta t_j|$, is less than or equal to $1$. The parameters $L$, $N$, and $D$ do not influence the linear stability of this specific IMEX scheme, as shown by the analysis where the worst-case amplification factor simplified to be independent of $\\lambda_k$. The program calculates $\\Delta t_{\\max}$ and the two boolean stability/instability indicators for each test case as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n\n    def analyze_stability(L, N, D, r, dt1, dt2):\n        \"\"\"\n        Analyzes the stability of the IMEX scheme for a given set of parameters.\n\n        Args:\n            L (float): Domain length.\n            N (int): Number of grid nodes.\n            D (float): Diffusion coefficient.\n            r (float): Linearized reaction rate f'(u*).\n            dt1 (float): First test time step.\n            dt2 (float): Second test time step.\n\n        Returns:\n            list: A list containing [dt_max, s1, s2], where dt_max is the\n                  maximum stable time step, s1 is a boolean for stability at dt1,\n                  and s2 is a boolean for instability at dt2.\n        \"\"\"\n        # Part 1: Compute the maximum linearly stable time step (dt_max).\n        # The stability is governed by |1 + r*dt| <= 1, which means -2 <= r*dt <= 0.\n        if r > 0:\n            # Unconditionally unstable as r*dt > 0 cannot satisfy r*dt <= 0.\n            dt_max = 0.0\n        elif r == 0:\n            # Unconditionally stable as -2 <= 0 <= 0 is always true.\n            dt_max = np.inf\n        else:  # r < 0\n            # Condition simplifies to dt <= -2/r.\n            dt_max = -2.0 / r\n\n        # Part 2: Evaluate stability for dt1 and instability for dt2.\n        # The maximum amplification factor over all modes k is |G_0(dt)| = |1 + r*dt|.\n        # We don't need to compute eigenvalues as the k=0 mode is always the worst case.\n\n        # Check stability at dt1: max|G_k(dt1)| <= 1\n        max_amp_factor_1 = abs(1.0 + r * dt1)\n        is_stable_at_dt1 = max_amp_factor_1 <= 1.0\n\n        # Check instability at dt2: max|G_k(dt2)| > 1\n        max_amp_factor_2 = abs(1.0 + r * dt2)\n        is_unstable_at_dt2 = max_amp_factor_2 > 1.0\n\n        return [dt_max, is_stable_at_dt1, is_unstable_at_dt2]\n\n    test_cases = [\n        # Case 1: L=1.0, N=64, D=1e-3, r=-10.0, dt1=0.18, dt2=0.22\n        (1.0, 64, 1.0e-3, -10.0, 0.18, 0.22),\n        # Case 2: L=1.0, N=257, D=0.2, r=-10.0, dt1=0.18, dt2=0.22\n        (1.0, 257, 0.2, -10.0, 0.18, 0.22),\n        # Case 3: L=1.0, N=128, D=0.01, r=2.0, dt1=0.001, dt2=0.1\n        (1.0, 128, 0.01, 2.0, 0.001, 0.1),\n        # Case 4: L=1.0, N=100, D=5e-4, r=-7.5, dt1=0.25, dt2=0.28\n        (1.0, 100, 5.0e-4, -7.5, 0.25, 0.28),\n        # Case 5: L=1.0, N=32, D=10.0, r=-0.1, dt1=10.0, dt2=25.0\n        (1.0, 32, 10.0, -0.1, 10.0, 25.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_stability(*case)\n        results.append(result)\n\n    # Format the output string exactly as required: [[...],[...],...] with no spaces.\n    case_strings = []\n    for res in results:\n        # str(True) -> \"True\", str(False) -> \"False\"\n        # str(float) gives standard representation. This works.\n        case_strings.append(f\"[{res[0]},{str(res[1])},{str(res[2])}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    # Python prints True/False with initial capital, which is the required output format.\n    print(final_output.replace(\"'\", \"\"))\n\nsolve()\n# The generated output by this code would be:\n# [[0.2,True,True],[0.2,True,True],[0.0,False,True],[0.26666666666666666,True,True],[20.0,True,True]]\n```"
        }
    ]
}