{
    "hands_on_practices": [
        {
            "introduction": "在求解复杂的生物化学网络微分方程之前，我们可以仅从其网络拓扑结构中推断出系统的许多潜在行为。本练习将介绍化学反应网络理论 (CRNT) 作为一个强大的框架，通过分析网络的结构不变量来预测其动态特性，例如稳定平衡点的存在性 。这种方法有助于我们建立关于网络结构如何约束系统动力学的深刻直觉，而无需知道具体的反应速率常数。",
            "id": "3335925",
            "problem": "考虑一个充分混合的等温生化系统，其中有两种物种，记为 $A$ 和 $B$，它们通过可逆反应 $A \\rightleftharpoons B$ 和 $2A \\rightleftharpoons A + B$ 相互作用。假设对于每个定向反应，都遵循质量作用动力学，且速率常数严格为正。令 $x_A(t)$ 和 $x_B(t)$ 分别表示 $A$ 和 $B$ 的浓度，并设系统根据质量作用动力学和质量作用定律所导出的常微分方程（ODEs）进行演化。使用化学反应网络理论（CRNT）的框架。\n\n任务：\n- 通过识别所有复合物和由反应诱导的有向边来构建复合物图。确定复合物的数量 $n_c$ 和连通类的数量 $\\ell$。\n- 使用物种顺序 $(A,B)$ 构建网络的化学计量矩阵 $N$，并计算化学计量子空间的维度，即 $\\operatorname{rank} N$。\n- 使用 CRNT 中亏格的标准定义，计算该网络的亏格 $\\delta$。\n- 根据 CRNT 中零亏格定理所需的结构条件，判断该定理是否能推断，对于该网络速率常数的所有正值选择，都存在正的复合物平衡平衡点。从第一性原理出发，基于复合物、连通类、化学计量子空间、弱可逆性和亏格的定义来证明你的结论。\n\n仅报告计算出的亏格 $\\delta$ 值作为最终答案。无需四舍五入，也无需单位。",
            "solution": "该问题要求在化学反应网络理论（CRNT）的框架内对一个生化反应网络进行分析。该系统涉及两种物种 $A$ 和 $B$，它们的浓度分别表示为 $x_A(t)$ 和 $x_B(t)$。反应为 $A \\rightleftharpoons B$ 和 $2A \\rightleftharpoons A + B$。我们假设系统遵循质量作用动力学，且速率常数为正。\n\n构成该网络的四个基元反应是：\n1. $A \\xrightarrow{k_1} B$\n2. $B \\xrightarrow{k_{-1}} A$\n3. $2A \\xrightarrow{k_2} A+B$\n4. $A+B \\xrightarrow{k_{-2}} 2A$\n\n我们将通过系统地计算分析所需的量来逐步进行。\n\n**1. 复合物与连通类**\n\n第一步是识别网络的复合物。复合物是在反应集合中作为反应物或产物出现的不同化学实体。\n从给定的反应中，复合物的集合是 $\\{ A, B, 2A, A+B \\}$。\n因此，不同复合物的数量为 $n_c = 4$。\n\n接下来，我们构建复合物图，其中顶点是复合物，有向边代表反应。\n- 反应 $A \\rightleftharpoons B$ 在复合物 $A$ 和复合物 $B$ 之间创建了一条双向边。\n- 反应 $2A \\rightleftharpoons A+B$ 在复合物 $2A$ 和复合物 $A+B$ 之间创建了一条双向边。\n\n该图由两个不连通的组件构成。连通类被定义为复合物图的一个连通分量。该网络的连通类是：\n- $L_1 = \\{A, B\\}$\n- $L_2 = \\{2A, A+B\\}$\n\n有两个连通类，因此连通类的数量为 $\\ell = 2$。\n\n**2. 化学计量子空间**\n\n化学计量子空间 $S$ 是由反应向量张成的物种空间的线性子空间。物种空间是 $\\mathbb{R}^2$，其基向量对应于物种 $A$ 和 $B$。我们可以将每个复合物表示为该空间中的一个向量：\n- 复合物 $A$ 对应于向量 $y_A = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- 复合物 $B$ 对应于向量 $y_B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n- 复合物 $2A$ 对应于向量 $y_{2A} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。\n- 复合物 $A+B$ 对应于向量 $y_{A+B} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n一个形式为 $y \\to y'$ 的反应有一个关联的反应向量 $y' - y$。我们网络的反应向量是：\n- 对于 $A \\to B$：$y_B - y_A = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n- 对于 $B \\to A$：$y_A - y_B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n- 对于 $2A \\to A+B$：$y_{A+B} - y_{2A} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n- 对于 $A+B \\to 2A$：$y_{2A} - y_{A+B} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n化学计量矩阵 $N$ 由这些反应向量作为列构成。化学计量子空间 $S$ 是 $N$ 的列空间。\n$$S = \\operatorname{span}\\left\\{ \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\right\\}$$\n由于第二个向量就是第一个向量的负向量，该子空间是一维的。\n$$S = \\operatorname{span}\\left\\{ \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right\\}$$\n化学计量子空间的维度是化学计量矩阵的秩，记为 $s$。因此，$s = \\operatorname{rank} N = 1$。这个维度对应于独立化学守恒定律的数量。对于这个系统，守恒定律是 $x_A(t) + x_B(t) = \\text{constant}$。\n\n**3. 网络的亏格**\n\n化学反应网络的亏格，记为 $\\delta$，是一个由以下公式定义的非负整数：\n$$\\delta = n_c - \\ell - s$$\n使用前面步骤中计算出的值：\n- 复合物数量，$n_c = 4$。\n- 连通类数量，$\\ell = 2$。\n- 化学计量子空间的维度，$s = 1$。\n\n亏格为：\n$$\\delta = 4 - 2 - 1 = 1$$\n\n**4. 零亏格定理的应用**\n\n零亏格定理为质量作用系统的动力学提供了一个强有力的结论，但它要求网络具有特定的结构性质。该定理指出，对于一个**弱可逆**且**亏格为零**（$\\delta = 0$）的网络，相应的质量作用动力学系统对于任何正速率常数的选择，在每个正化学计量相容类中都恰好有一个平衡点，且此平衡点是复合物平衡的。\n\n我们必须检查给定网络是否满足该定理的条件。\n\n- **弱可逆性：** 如果每个反应都属于一个有向反应环，则该网络是弱可逆的。这等价于说每个连通类都是复合物图中的一个强连通分量。\n  - 在连通类 $L_1 = \\{A, B\\}$ 中，反应 $A \\to B$ 和 $B \\to A$ 都存在。因此，在这个连通类中，从任何复合物到任何其他复合物都存在路径。它是强连通的。\n  - 在连通类 $L_2 = \\{2A, A+B\\}$ 中，反应 $2A \\to A+B$ 和 $A+B \\to 2A$ 都存在。这个连通类也是强连通的。\n  由于所有连通类都是强连通的，该网络是弱可逆的。\n\n- **亏格：** 如前一节所计算，该网络的亏格是 $\\delta = 1$。\n\n该网络是弱可逆的，但其亏格不为零。由于条件 $\\delta = 0$ 未被满足，零亏格定理不能应用于此网络。因此，该定理并不能推断对于所有正速率常数，该系统都存在正的复合物平衡平衡点。尽管这样的平衡点可能存在，但其存在性并不能由这个特定定理来保证。问题是问该定理能推断出什么，在这种情况下，它什么也推断不出，因为其假设不成立。\n\n最终要求的值是亏格 $\\delta$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "许多生物系统涉及在不同尺度上发生的过程，例如快速的分子扩散和缓慢的化学反应。本练习介绍了一种强大的解析技术——匹配渐近展开法，用于求解此类“奇异摄动”问题 。通过分别处理具有快速变化的“边界层”和变化平缓的“外部区域”，然后将解“匹配”起来，我们可以为复杂的反应扩散问题构建出精确的近似解。",
            "id": "3335892",
            "problem": "对于一个长度被缩放到 $[0,1]$ 的细胞上，双稳态调控蛋白浓度 $u(x)$ 的一维无量纲反应-扩散稳态由以下常微分方程建模：\n$$\nD\\,u''(x) + f(u(x)) = 0, \\quad x \\in (0,1),\n$$\n其中扩散系数参数 $0  D \\ll 1$ 很小。反应项源于具有两个稳定表达状态的粗粒化动力学，并取为 $f(u) = u - u^{3}$。边界浓度被膜相关过程固定，使得：\n$$\nu(0) = \\frac{4}{5}, \\qquad u(1) = 1.\n$$\n从稳态反应-扩散系统的基本平衡关系（用于扩散通量的菲克定律，以及浓度稳态意味着扩散通量散度与局部反应相平衡）出发，使用匹配渐近展开法确定边界层必须在何处形成及其特征厚度。然后，推导主导阶外解和任何边界层附近的相应内问题，并求解内问题以获得与外解相匹配的闭式表达式。最后，构建一个一致有效的主导阶复合近似解 $u_{\\mathrm{comp}}(x;D)$。\n\n请以关于 $x$ 和 $D$ 的单个闭式解析表达式的形式提供最终答案。不要四舍五入；无需单位。",
            "solution": "所给出的问题是一个有效的、自洽的、适定的非线性常微分方程边值问题。它是反应-扩散系统背景下的一个经典奇异摄动问题，这是计算系统生物学的一个核心课题。我们可以使用匹配渐近展开法来求解。\n\n所给出的稳态反应-扩散方程为：\n$$D u''(x) + f(u(x)) = 0, \\quad x \\in (0, 1)$$\n反应项为 $f(u) = u - u^3$，边界条件为 $u(0) = 4/5$ 和 $u(1) = 1$。参数 $D$ 很小，$0  D \\ll 1$。\n\n该方程可以解释为稳态质量平衡。令 $J(x) = -D u'(x)$ 为扩散通量（菲克定律）。方程变为 $\\frac{dJ}{dx} = -f(u)$，这表明通量的空间变化与局部反应速率相平衡。\n\n**步骤 1：外解**\n在远离任何边界层的外部区域，我们假设解 $u(x)$ 变化缓慢。因此，与反应项 $f(u(x))$ 相比，$D u''(x)$ 项是可忽略的。我们通过在原方程中令 $D=0$ 来求得主导阶外解 $u_{out}(x)$：\n$$f(u_{out}(x)) = 0$$\n$$u_{out} - u_{out}^3 = 0 \\implies u_{out}(1 - u_{out}^2) = 0$$\n这个代数方程有三个常数解：$u_{out} = -1$，$u_{out} = 0$ 和 $u_{out} = 1$。由于 $u(x)$ 代表蛋白浓度，它必须是非负的，所以我们只考虑 $u_{out}=0$ 和 $u_{out}=1$。\n\n对于一个反应-扩散系统，外解必须对应于由常微分方程 $\\frac{du}{dt} = f(u)$ 描述的反应动力学的一个稳定稳态。其稳定性由 $f'(u) = 1 - 3u^2$ 的符号决定。\n- 对于 $u=0$，$f'(0) = 1 > 0$，所以这个状态是不稳定的。\n- 对于 $u=1$，$f'(1) = 1-3 = -2  0$，所以这个状态是稳定的。\n任何微小的扰动都会导致解偏离不稳定的状态 $u=0$。因此，唯一有效的主导阶外解是 $u_{out}(x) = 1$。\n\n我们将此外解与边界条件进行核对：\n- 在 $x=1$ 处，$u_{out}(1)=1$，与边界条件 $u(1)=1$ 相匹配。\n- 在 $x=0$ 处，$u_{out}(0)=1$，与边界条件 $u(0)=4/5$ 不匹配。\n\n这种差异表明在 $x=0$ 处存在一个边界层，解在该处快速变化以满足边界条件。在 $x=1$ 处则不需要边界层。\n\n**步骤 2：内解与边界层分析**\n为了分析 $x=0$ 处的边界层，我们引入一个拉伸的内坐标 $X = \\frac{x}{\\delta(D)}$，其中 $\\delta(D)$ 是该层的特征厚度。令内解为 $u_{in}(X) \\equiv u(x)$。导数变换如下：\n$$\\frac{du}{dx} = \\frac{1}{\\delta} \\frac{du_{in}}{dX}, \\qquad \\frac{d^2u}{dx^2} = \\frac{1}{\\delta^2} \\frac{d^2u_{in}}{dX^2}$$\n代入常微分方程得到：\n$$\\frac{D}{\\delta^2} \\frac{d^2u_{in}}{dX^2} + u_{in} - u_{in}^3 = 0$$\n为了获得一个扩散项和反应项相平衡的显著极限，我们必须将最高阶导数的系数设为 1 的量级。我们选择 $\\frac{D}{\\delta^2} = 1$，这意味着 $\\delta = \\sqrt{D}$。\n因此，边界层的特征厚度为 $O(\\sqrt{D})$ 量级，内坐标为 $X = \\frac{x}{\\sqrt{D}}$。主导阶内方程为：\n$$\\frac{d^2u_{in}}{dX^2} + u_{in} - u_{in}^3 = 0$$\n内解必须满足在 $x=0$ 处的边界条件：\n$$u_{in}(X=0) = u(0) = \\frac{4}{5}$$\n它还必须在内变量趋于无穷大时与外解相匹配。匹配条件是：\n$$\\lim_{X \\to \\infty} u_{in}(X) = \\lim_{x \\to 0^+} u_{out}(x) = 1$$\n为了求解这个二阶内常微分方程，我们两边乘以 $\\frac{du_{in}}{dX}$ 并对 $X$ 积分：\n$$\\int \\frac{du_{in}}{dX}\\frac{d^2u_{in}}{dX^2} dX + \\int (u_{in} - u_{in}^3)\\frac{du_{in}}{dX} dX = C_1$$\n$$\\frac{1}{2}\\left(\\frac{du_{in}}{dX}\\right)^2 + \\frac{1}{2}u_{in}^2 - \\frac{1}{4}u_{in}^4 = C_1$$\n我们使用在无穷远处的匹配条件来求出常数 $C_1$。当 $X \\to \\infty$ 时，$u_{in} \\to 1$ 且其导数 $\\frac{du_{in}}{dX} \\to 0$。\n$$\\frac{1}{2}(0)^2 + \\frac{1}{2}(1)^2 - \\frac{1}{4}(1)^4 = C_1 \\implies C_1 = \\frac{1}{4}$$\n将 $C_1$ 代回：\n$$\\frac{1}{2}\\left(\\frac{du_{in}}{dX}\\right)^2 = \\frac{1}{4} - \\frac{1}{2}u_{in}^2 + \\frac{1}{4}u_{in}^4 = \\frac{1}{4}(1 - 2u_{in}^2 + u_{in}^4) = \\frac{1}{4}(1 - u_{in}^2)^2$$\n$$\\left(\\frac{du_{in}}{dX}\\right)^2 = \\frac{1}{2}(1 - u_{in}^2)^2 \\implies \\frac{du_{in}}{dX} = \\pm \\frac{1}{\\sqrt{2}}(1 - u_{in}^2)$$\n由于 $u_{in}(0) = 4/5$ 且当 $X \\to \\infty$ 时 $u_{in}$ 必须增加以趋近于 1，导数 $\\frac{du_{in}}{dX}$ 必须为正。对于在区间 $[4/5, 1)$ 内的 $u_{in}$，项 $1 - u_{in}^2$ 是正的。我们必须选择正号：\n$$\\frac{du_{in}}{dX} = \\frac{1}{\\sqrt{2}}(1 - u_{in}^2)$$\n这是一个可分离的一阶常微分方程。我们分离变量并积分：\n$$\\int \\frac{du_{in}}{1 - u_{in}^2} = \\int \\frac{1}{\\sqrt{2}} dX$$\n左边的积分是 $\\text{arctanh}(u_{in})$。\n$$\\text{arctanh}(u_{in}) = \\frac{X}{\\sqrt{2}} + C_2$$\n我们使用边界条件 $u_{in}(0) = 4/5$ 来求积分常数 $C_2$：\n$$\\text{arctanh}\\left(\\frac{4}{5}\\right) = \\frac{0}{\\sqrt{2}} + C_2 \\implies C_2 = \\text{arctanh}\\left(\\frac{4}{5}\\right)$$\n这个常数的值可以使用反双曲正切的对数定义 $\\text{arctanh}(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$ 来简化：\n$$C_2 = \\frac{1}{2}\\ln\\left(\\frac{1+4/5}{1-4/5}\\right) = \\frac{1}{2}\\ln\\left(\\frac{9/5}{1/5}\\right) = \\frac{1}{2}\\ln(9) = \\ln(3)$$\n所以，内解由下式给出：\n$$\\text{arctanh}(u_{in}) = \\frac{X}{\\sqrt{2}} + \\ln(3)$$\n$$u_{in}(X) = \\tanh\\left(\\frac{X}{\\sqrt{2}} + \\ln(3)\\right)$$\n\n**步骤 3：一致有效复合解**\n一个在整个定义域 $[0,1]$ 上一致有效的复合解 $u_{\\mathrm{comp}}(x;D)$，可以通过将外解和内解相加，然后减去它们的公共部分（重叠区域）来构建。\n$$u_{\\mathrm{comp}}(x;D) = u_{out}(x) + u_{in}(X) - (\\text{common part})$$\n公共部分是内解在 $X \\to \\infty$ 时的极限，它等于外解在 $x \\to 0$ 时的极限：\n$$\\text{common part} = \\lim_{X \\to \\infty} u_{in}(X) = \\lim_{X \\to \\infty} \\tanh\\left(\\frac{X}{\\sqrt{2}} + \\ln(3)\\right) = 1$$\n这与外解的值 $u_{out}(x) = 1$ 相匹配。\n代入各个部分：\n$$u_{\\mathrm{comp}}(x;D) = 1 + \\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right) - 1$$\n最终的复合解是：\n$$u_{\\mathrm{comp}}(x;D) = \\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right)$$\n这个表达式为解 $u(x)$ 提供了一个在 $x \\in [0,1]$ 上有效的主导阶近似。它在 $x=0$ 处正确地简化为 $4/5$，并在 $x > O(\\sqrt{D})$ 时渐近地接近于 $1$，从而在 $D \\to 0$ 的极限下满足两个边界条件。",
            "answer": "$$\\boxed{\\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right)}$$"
        },
        {
            "introduction": "大多数真实的生物模型过于复杂，难以求得解析解，因此计算模拟变得至关重要。本练习将探讨反应扩散系统数值求解中常见的“刚性”问题，并介绍一种高效的标准解决方案——隐式-显式 (IMEX) 方法 。您不仅需要实现该数值格式，还需要通过线性稳定性分析来从数学上证明其稳定性条件，这是计算生物学家必须掌握的一项核心技能。",
            "id": "3335951",
            "problem": "考虑一个标量场 $\\,u(x,t)\\,$ 在长度为 $\\,L\\,$ 的一维周期性区域上的反应扩散偏微分方程 (PDE) $\\,\\partial_t u = D \\Delta u + f(u)\\,$，其中扩散系数 $\\,D  0\\,$ 为常数，反应项 $\\,f(u)\\,$ 足够光滑。假设有一个包含 $\\,N\\,$ 个节点的均匀空间网格，间距为 $\\,h = L/N\\,$，并定义具有周期性边界条件的标准二阶中心差分离散拉普拉斯算子 $\\,\\Delta_h\\,$，其形式为 $\\,(\\Delta_h u)_i = \\dfrac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}\\,$，其中下标对 $\\,N\\,$ 取模。您的任务如下：\n\n1) 从质量守恒和 Fick 扩散定律以及显式反应的前向欧拉法定义出发，构建一个半隐式隐-显 (IMEX) 有限差分格式，该格式隐式处理扩散项，显式处理反应项。用 $\\,\\Delta t  0\\,$ 表示时间步长，并写出离散未知量 $\\,u^n \\in \\mathbb{R}^N\\,$ 从时间层 $\\,n\\,$到 $\\,n+1\\,$ 的更新，形式如下：\n$$\n\\left(I - \\Delta t\\, D\\, \\Delta_h\\right) u^{n+1} \\;=\\; u^n \\;+\\; \\Delta t\\, f(u^n).\n$$\n解释为什么在所述离散化下，该格式与 PDE $\\,\\partial_t u = D \\Delta u + f(u)\\,$ 相容。\n\n2) 对满足 $\\,f(u^\\star) = 0\\,$ 的空间均匀稳态 $\\,u^\\star\\,$ 进行线性稳定性分析。将反应项线性化为 $\\,f(u) \\approx f(u^\\star) + f'(u^\\star)(u - u^\\star)\\,$，并设 $\\,r = f'(u^\\star)\\,$。使用离散傅里叶模态 $\\,\\varphi_k(i) = \\exp\\!\\left(2\\pi \\mathrm{i}\\, k\\, i/N\\right)\\,$（其中 $\\,k \\in \\{0,1,\\dots,N-1\\}\\,$）对 $\\,\\Delta_h\\,$ 进行对角化，并回顾其对应的特征值为：\n$$\n\\lambda_k \\;=\\; -\\frac{4}{h^2}\\,\\sin^2\\!\\left(\\frac{\\pi k}{N}\\right).\n$$\n推导出标量模态放大因子 $\\,G_k(\\Delta t)\\,$，并根据 $\\,\\max_k |G_k(\\Delta t)| \\le 1\\,$ 形式化地给出该 IMEX 格式线性稳定的充要条件。证明最坏情况是零模态 $\\,k=0\\,$，并推导出作为 $\\,r\\,$ 的函数最大线性稳定时间步长 $\\,\\Delta t_{\\max}\\,$。针对 $\\,r  0\\,$、$\\,r = 0\\,$ 和 $\\,r > 0\\,$ 的情况，清楚地陈述您的结果。\n\n3) 实现与可测试输出。实现一个程序，对下面的每个测试用例执行以下操作：\n- 使用第 2 部分的公式计算以秒为单位的 $\\,\\Delta t_{\\max}\\,$。\n- 对于两个给定的测试步长 $\\,\\Delta t_1\\,$ 和 $\\,\\Delta t_2\\,$（均以秒为单位），使用上述特征值 $\\,\\lambda_k\\,$ 评估所有离散傅里叶模态 $\\,k \\in \\{0,\\dots,N-1\\}\\,$ 上的最大放大因子 $\\,\\max_k |G_k(\\Delta t_j)|\\,$，并返回两个布尔值，分别指示该格式在 $\\,\\Delta t_1\\,$ 时是否线性稳定，在 $\\,\\Delta t_2\\,$ 时是否线性不稳定。稳定性定义为 $\\,\\max_k |G_k(\\Delta t_j)| \\le 1\\,$，不稳定性定义为 $\\,\\max_k |G_k(\\Delta t_j)|  1\\,$。\n- 注意，所有量都必须以一致的单位处理。将 $\\,\\Delta t_{\\max}\\,$ 表示为以秒为单位的浮点数。\n\n您的程序必须处理以下测试套件。每个测试用例给出 $\\,L\\,$（长度单位）、$\\,N\\,$、$\\,D\\,$（长度的平方每秒）和一个决定 $\\,r\\,$ 的反应模型，以及两个探测时间步长 $\\,\\Delta t_1\\,$ 和 $\\,\\Delta t_2\\,$（秒）：\n- 测试用例 1（线性反应，负斜率）：$\\,L = 1.0\\,$，$\\,N = 64\\,$，$\\,D = 1.0 \\times 10^{-3}\\,$，$\\,f(u) = \\alpha u\\,$，其中 $\\,\\alpha = -10.0\\,\\mathrm{s}^{-1}\\,$，因此 $\\,r = \\alpha\\,$，$\\,\\Delta t_1 = 0.18\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.22\\,\\mathrm{s}\\,$。\n- 测试用例 2（线性反应，相同的 $\\,r\\,$ 但不同的 $\\,D, N$）：$\\,L = 1.0\\,$，$\\,N = 257\\,$，$\\,D = 0.2\\,$，$\\,f(u) = \\alpha u\\,$，其中 $\\,\\alpha = -10.0\\,\\mathrm{s}^{-1}\\,$，$\\,\\Delta t_1 = 0.18\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.22\\,\\mathrm{s}\\,$。\n- 测试用例 3（线性反应，正斜率）：$\\,L = 1.0\\,$，$\\,N = 128\\,$，$\\,D = 0.01\\,$，$\\,f(u) = \\alpha u\\,$，其中 $\\,\\alpha = +2.0\\,\\mathrm{s}^{-1}\\,$，因此 $\\,r = \\alpha\\,$，$\\,\\Delta t_1 = 0.001\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.1\\,\\mathrm{s}\\,$。\n- 测试用例 4（稳定不动点处的逻辑斯谛反应）：$\\,L = 1.0\\,$，$\\,N = 100\\,$，$\\,D = 5.0 \\times 10^{-4}\\,$，$\\,f(u) = \\rho\\, u \\left(1 - \\dfrac{u}{K}\\right)\\,$，其中 $\\,\\rho = 7.5\\,\\mathrm{s}^{-1}\\,$，在 $\\,u^\\star = K\\,$ 处线性化，因此 $\\,r = f'(K) = -\\rho\\,$，$\\,\\Delta t_1 = 0.25\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.28\\,\\mathrm{s}\\,$。\n- 测试用例 5（线性反应，弱负斜率）：$\\,L = 1.0\\,$，$\\,N = 32\\,$，$\\,D = 10.0\\,$，$\\,f(u) = \\alpha u\\,$，其中 $\\,\\alpha = -0.1\\,\\mathrm{s}^{-1}\\,$，因此 $\\,r = \\alpha\\,$，$\\,\\Delta t_1 = 10.0\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 25.0\\,\\mathrm{s}\\,$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个长度为 5 的顶层列表。每个条目本身是一个形式为 $[\\Delta t_{\\max}, s_1, s_2]$ 的列表，其中 $\\,\\Delta t_{\\max}\\,$ 是一个以秒为单位的浮点数，$\\,s_1\\,$ 是一个布尔值，如果格式在 $\\,\\Delta t_1\\,$ 时线性稳定，则为 $\\,\\mathrm{True}\\,$，否则为 $\\,\\mathrm{False}\\,$；$\\,s_2\\,$ 是一个布尔值，如果格式在 $\\,\\Delta t_2\\,$ 时线性不稳定，则为 $\\,\\mathrm{True}\\,$，否则为 $\\,\\mathrm{False}\\,$。例如，输出必须看起来像 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，条目之间用逗号分隔。",
            "solution": "该问题被验证为具有科学依据、良态且客观。它提出了偏微分方程数值分析中的一个标准任务，特别是在反应扩散模型普遍存在的计算系统生物学领域。所给的参数和定义是完整和一致的。\n\n### 1. IMEX 格式的推导和相容性\n\n控制偏微分方程 (PDE) 是反应扩散方程 $\\partial_t u = D \\Delta u + f(u)$。我们的任务是在一个长度为 $L$ 的一维周期性区域上，使用一个有 $N$ 个节点的均匀网格来离散化此方程，网格间距为 $h=L/N$。\n\nPDE 的空间部分使用二阶中心差分对拉普拉斯算子进行离散化，得到半离散常微分方程 (ODEs) 组：\n$$\n\\frac{d u_i}{d t} = D (\\Delta_h u)_i + f(u_i) \\quad \\text{对于 } i=0, \\dots, N-1,\n$$\n其中 $u_i(t) \\approx u(x_i, t)$ 且 $(\\Delta_h u)_i = (u_{i+1} - 2u_i + u_{i-1})/h^2$。以向量形式表示为 $\\frac{d\\vec{u}}{dt} = D \\Delta_h \\vec{u} + \\vec{f}(\\vec{u})$，其中 $\\vec{u} = (u_0, \\dots, u_{N-1})^T$ 且 $\\vec{f}(\\vec{u}) = (f(u_0), \\dots, f(u_{N-1}))^T$。\n\n所要求的隐-显 (IMEX) 格式隐式地处理刚性的线性扩散项 ($D \\Delta_h \\vec{u}$)，显式地处理可能非线性的反应项 ($\\vec{f}(\\vec{u})$)。这对应于对扩散项使用后向欧拉法，对反应项使用前向欧拉法。将此应用于从时间 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 的半离散系统，我们将时间导数近似为 $(\\vec{u}^{n+1} - \\vec{u}^n)/\\Delta t$，在未来的时间层 $n+1$ 上计算隐式项，在当前的时间层 $n$ 上计算显式项：\n$$\n\\frac{\\vec{u}^{n+1} - \\vec{u}^n}{\\Delta t} = D \\Delta_h \\vec{u}^{n+1} + \\vec{f}(\\vec{u}^n).\n$$\n这构成了一个质量守恒，其中变化率等于隐式计算的扩散通量与显式计算的反应源项之和。重排方程，将未知项 $\\vec{u}^{n+1}$ 归到左侧，得到：\n$$\n\\vec{u}^{n+1} - \\Delta t D \\Delta_h \\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\vec{f}(\\vec{u}^n).\n$$\n使用单位算子 $I$ 提出公因子 $\\vec{u}^{n+1}$，我们便得到所要求的更新规则的矩阵形式：\n$$\n\\left(I - \\Delta t D \\Delta_h\\right) \\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\vec{f}(\\vec{u}^n).\n$$\n\n为了证明相容性，我们通过将精确解 $u(x_i, t_n)$ 代入有限差分方程来分析局部截断误差 $\\tau^n_i$：\n$$\n\\frac{u(x_i, t_{n+1}) - u(x_i, t_n)}{\\Delta t} = D \\Delta_h u(x_i, t_{n+1}) + f(u(x_i, t_n)).\n$$\n对于足够光滑的解 $u$，在 $(x_i, t_n)$ 附近进行泰勒展开：\n\\begin{itemize}\n    \\item $u(x_i, t_{n+1}) = u(x_i, t_n) + \\Delta t \\partial_t u + \\frac{(\\Delta t)^2}{2} \\partial_{tt} u + O((\\Delta t)^3)$。\n    \\item 左侧变为：$\\partial_t u + \\frac{\\Delta t}{2} \\partial_{tt} u + O((\\Delta t)^2)$。\n    \\item 对于右侧，离散拉普拉斯算子是连续算子的二阶近似：$\\Delta_h \\phi(x_i) = \\partial_{xx} \\phi(x_i) + O(h^2)$。\n    \\item 因此，$D \\Delta_h u(x_i, t_{n+1}) = D (\\partial_{xx} u(x_i, t_{n+1}) + O(h^2)) = D (\\partial_{xx} u(x_i, t_n) + \\Delta t \\partial_{xx}\\partial_t u + O((\\Delta t)^2) + O(h^2))$。\n\\end{itemize}\n截断误差是离散化 PDE 与精确 PDE $\\partial_t u - D \\partial_{xx} u - f(u) = 0$ 之间的差。代入展开式后，我们发现：\n$$\n\\tau_i^n = \\left(\\partial_t u + \\frac{\\Delta t}{2} \\partial_{tt} u \\right) - D\\left(\\partial_{xx} u + \\Delta t \\partial_{xx}\\partial_t u\\right) - f(u) + O((\\Delta t)^2) + O(D h^2).\n$$\n整理各项：\n$$\n\\tau_i^n = (\\partial_t u - D \\partial_{xx} u - f(u)) + \\frac{\\Delta t}{2} \\partial_{tt} u - D \\Delta t \\partial_{xx}\\partial_t u + O((\\Delta t)^2, h^2).\n$$\n第一个括号项为零。剩余误差为 $\\tau_i^n = O(\\Delta t) + O(h^2)$。当 $\\Delta t \\to 0$ 且 $h \\to 0$ 时，截断误差消失。因此，该格式是相容的，时间上为一阶精度，空间上为二阶精度。\n\n### 2. 线性稳定性分析\n\n我们分析该格式在空间均匀稳态 $u^\\star$（其中 $f(u^\\star) = 0$）附近的稳定性。设 $\\vec{u}^n = \\vec{u}^\\star + \\delta\\vec{u}^n$，其中 $\\vec{u}^\\star$ 是所有分量均为 $u^\\star$ 的向量，$\\delta\\vec{u}^n$ 是一个小扰动。反应项被线性化为 $f(u_i^n) \\approx f(u^\\star) + f'(u^\\star)\\delta u_i^n = r \\delta u_i^n$。代入格式中：\n$$\n(I - \\Delta t D \\Delta_h) (\\vec{u}^\\star + \\delta\\vec{u}^{n+1}) = (\\vec{u}^\\star + \\delta\\vec{u}^n) + \\Delta t \\vec{f}(\\vec{u}^\\star + \\delta\\vec{u}^n).\n$$\n利用线性化并注意到由于 $\\vec{u}^\\star$ 是常数，$\\Delta_h \\vec{u}^\\star = \\vec{0}$：\n$$\n\\vec{u}^\\star + (I - \\Delta t D \\Delta_h) \\delta\\vec{u}^{n+1} = \\vec{u}^\\star + \\delta\\vec{u}^n + \\Delta t r \\delta\\vec{u}^n.\n$$\n稳态 $\\vec{u}^\\star$ 被抵消，得到扰动的演化方程：\n$$\n(I - \\Delta t D \\Delta_h) \\delta\\vec{u}^{n+1} = (1 + r \\Delta t) \\delta\\vec{u}^n.\n$$\n为进行 von Neumann 稳定性分析，我们将扰动 $\\delta\\vec{u}^n$ 分解为离散傅里叶模态 $\\vec{\\varphi}_k$，它们是循环矩阵 $\\Delta_h$ 的特征向量。设 $\\delta\\vec{u}^n = \\sum_{k=0}^{N-1} \\hat{u}_k^n \\vec{\\varphi}_k$。由于 $\\Delta_h \\vec{\\varphi}_k = \\lambda_k \\vec{\\varphi}_k$，将此展开式代入扰动方程并利用线性性质，我们可以独立分析每个模态：\n$$\n(1 - \\Delta t D \\lambda_k) \\hat{u}_k^{n+1} \\vec{\\varphi}_k = (1 + r \\Delta t) \\hat{u}_k^n \\vec{\\varphi}_k.\n$$\n模态 $k$ 的放大因子是 $G_k(\\Delta t) = \\hat{u}_k^{n+1}/\\hat{u}_k^n$，由下式给出：\n$$\nG_k(\\Delta t) = \\frac{1 + r \\Delta t}{1 - \\Delta t D \\lambda_k}.\n$$\n为了线性稳定性，我们要求所有模态的放大因子的模不大于 1，即 $\\max_{k} |G_k(\\Delta t)| \\le 1$。特征值由 $\\lambda_k = -\\frac{4}{h^2}\\sin^2(\\frac{\\pi k}{N})$ 给出，它们是实数且非正 ($\\lambda_k \\le 0$)。由于 $D>0$ 和 $\\Delta t>0$，分母 $1 - \\Delta t D \\lambda_k$ 总是实数且大于或等于 $1$。放大因子的模为：\n$$\n|G_k(\\Delta t)| = \\frac{|1 + r \\Delta t|}{1 - \\Delta t D \\lambda_k}.\n$$\n分子与模态指数 $k$ 无关。为了最大化 $|G_k(\\Delta t)|$，我们必须最小化分母 $1 - \\Delta t D \\lambda_k$。这在 $\\lambda_k$ 最大（负得最少）时发生，即对应于模态 $k=0$ 时，此时 $\\lambda_0 = 0$。因此，最坏情况（最大）的放大因子是：\n$$\n\\max_{k} |G_k(\\Delta t)| = |G_0(\\Delta t)| = \\frac{|1 + r \\Delta t|}{1 - 0} = |1 + r \\Delta t|.\n$$\n这表明此 IMEX 格式的稳定性仅由反应项的显式处理决定，与扩散系数 $D$ 和空间离散化 $h$ 无关。稳定性条件简化为 $|1 + r \\Delta t| \\le 1$。这等价于不等式 $-1 \\le 1 + r \\Delta t \\le 1$，可简化为 $-2 \\le r \\Delta t \\le 0$。\n\n现在我们根据 $r = f'(u^\\star)$ 的符号来确定最大稳定时间步长 $\\Delta t_{\\max}$：\n\\begin{itemize}\n    \\item 情况 $r > 0$（不稳定反应）：由于 $\\Delta t > 0$，所以 $r \\Delta t > 0$。条件 $r \\Delta t \\le 0$ 仅在 $\\Delta t = 0$ 时成立。对于任何 $\\Delta t > 0$，该格式都是无条件不稳定的。因此，$\\Delta t_{\\max} = 0$。\n    \\item 情况 $r = 0$（中性稳定反应）：条件变为 $-2 \\le 0 \\le 0$，这总是成立的。该格式是无条件稳定的。因此，$\\Delta t_{\\max} = \\infty$。\n    \\item 情况 $r  0$（稳定反应）：由于 $r$ 是负数，对于 $\\Delta t \\ge 0$，$r \\Delta t \\le 0$ 总是成立的。剩下的条件是 $-2 \\le r \\Delta t$。两边除以负值 $r$ 会使不等式反向：$\\Delta t \\le -2/r$。因此，最大稳定时间步长为 $\\Delta t_{\\max} = -2/r$。\n\\end{itemize}\n\n### 3. 实现与可测试输出\n\n该实现使用推导出的公式计算 $\\Delta t_{\\max}$。然后，它通过检查最大放大因子 $|G_0(\\Delta t_j)| = |1 + r \\Delta t_j|$ 是否小于或等于 $1$，来评估两个给定时间步长 $\\Delta t_1$ 和 $\\Delta t_2$ 的稳定性。分析表明，最坏情况下的放大因子简化为与 $\\lambda_k$ 无关，因此该特定 IMEX 格式的线性稳定性与扩散系数 $L$、 $N$ 和 $D$ 无关。程序按规定为每个测试用例计算 $\\Delta t_{\\max}$ 和两个布尔值的稳定性/不稳定性指标。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n\n    def analyze_stability(L, N, D, r, dt1, dt2):\n        \"\"\"\n        Analyzes the stability of the IMEX scheme for a given set of parameters.\n\n        Args:\n            L (float): Domain length.\n            N (int): Number of grid nodes.\n            D (float): Diffusion coefficient.\n            r (float): Linearized reaction rate f'(u*).\n            dt1 (float): First test time step.\n            dt2 (float): Second test time step.\n\n        Returns:\n            list: A list containing [dt_max, s1, s2], where dt_max is the\n                  maximum stable time step, s1 is a boolean for stability at dt1,\n                  and s2 is a boolean for instability at dt2.\n        \"\"\"\n        # Part 1: Compute the maximum linearly stable time step (dt_max).\n        # The stability is governed by |1 + r*dt| = 1, which means -2 = r*dt = 0.\n        if r > 0:\n            # Unconditionally unstable as r*dt > 0 cannot satisfy r*dt = 0.\n            dt_max = 0.0\n        elif r == 0:\n            # Unconditionally stable as -2 = 0 = 0 is always true.\n            dt_max = np.inf\n        else:  # r  0\n            # Condition simplifies to dt = -2/r.\n            dt_max = -2.0 / r\n\n        # Part 2: Evaluate stability for dt1 and instability for dt2.\n        # The maximum amplification factor over all modes k is |G_0(dt)| = |1 + r*dt|.\n        # We don't need to compute eigenvalues as the k=0 mode is always the worst case.\n\n        # Check stability at dt1: max|G_k(dt1)| = 1\n        max_amp_factor_1 = abs(1.0 + r * dt1)\n        is_stable_at_dt1 = max_amp_factor_1 = 1.0\n\n        # Check instability at dt2: max|G_k(dt2)| > 1\n        max_amp_factor_2 = abs(1.0 + r * dt2)\n        is_unstable_at_dt2 = max_amp_factor_2 > 1.0\n\n        return [dt_max, is_stable_at_dt1, is_unstable_at_dt2]\n\n    test_cases = [\n        # Case 1: L=1.0, N=64, D=1.0e-3, r=-10.0, dt1=0.18, dt2=0.22\n        (1.0, 64, 1.0e-3, -10.0, 0.18, 0.22),\n        # Case 2: L=1.0, N=257, D=0.2, r=-10.0, dt1=0.18, dt2=0.22\n        (1.0, 257, 0.2, -10.0, 0.18, 0.22),\n        # Case 3: L=1.0, N=128, D=0.01, r=2.0, dt1=0.001, dt2=0.1\n        (1.0, 128, 0.01, 2.0, 0.001, 0.1),\n        # Case 4: L=1.0, N=100, D=5e-4, r=-7.5, dt1=0.25, dt2=0.28\n        (1.0, 100, 5.0e-4, -7.5, 0.25, 0.28),\n        # Case 5: L=1.0, N=32, D=10.0, r=-0.1, dt1=10.0, dt2=25.0\n        (1.0, 32, 10.0, -0.1, 10.0, 25.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_stability(*case)\n        results.append(result)\n\n    # Format the output string exactly as required: [[...],[...],...] with no spaces.\n    case_strings = []\n    for res in results:\n        # str(True) -> \"True\", str(False) -> \"False\"\n        # str(float) gives standard representation. This works.\n        case_strings.append(f\"[{res[0]},{str(res[1])},{str(res[2])}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}