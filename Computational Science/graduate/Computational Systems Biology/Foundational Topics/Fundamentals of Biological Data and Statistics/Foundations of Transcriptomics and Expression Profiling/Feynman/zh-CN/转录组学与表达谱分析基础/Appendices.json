{
    "hands_on_practices": [
        {
            "introduction": "转录组学的核心目标是量化基因表达水平，但量化方法的选择至关重要。基因表达的量化主要有两种范式：相对定量（如 Transcripts Per Million, TPM）和绝对定量（使用外部参照，即 spike-in）。这项练习  将通过一个具体的思想实验，揭示相对定量方法在某些生物学场景下的局限性，并展示如何利用 spike-in 来校正这些偏差，从而获得对分子变化的真实度量。",
            "id": "3311844",
            "problem": "一项基于测序的信使核糖核酸（mRNA）表达实验比较了两个样本，记为 $\\mathcal{A}$ 和 $\\mathcal{B}$，这两个样本每个细胞的总内源性核糖核酸（RNA）含量不同。实验流程在文库制备前加入了已知数量的外部 spike-in RNA 分子，以实现绝对定量归一化。考虑三个内源性基因 $X$、$Y$ 和 $Z$，其转录本长度分别为 $L_X = 2$ kb、$L_Y = 1$ kb 和 $L_Z = 4$ kb。在样本 $\\mathcal{A}$ 中，每个细胞的内源性转录本绝对丰度为 $M_X^{\\mathcal{A}} = 10$ 分子/细胞，$M_Y^{\\mathcal{A}} = 20$ 分子/细胞，$M_Z^{\\mathcal{A}} = 100$ 分子/细胞。在样本 $\\mathcal{B}$ 中，这些丰度为 $M_X^{\\mathcal{B}} = 10$ 分子/细胞，$M_Y^{\\mathcal{B}} = 20$ 分子/细胞，$M_Z^{\\mathcal{B}} = 300$ 分子/细胞。因此，由于基因 $Z$ 的变化，$\\mathcal{B}$ 中每个细胞的总内源性 RNA 含量高于 $\\mathcal{A}$。在提取和文库制备之前，向两个样本中都加入了一个外部 spike-in 对照 $S$，其转录本长度为 $L_S = 2$ kb，已知添加量为每个细胞 $S = 50$ 个分子。\n\n测序为每个样本中的每个转录本产生了以下唯一比对的读数计数：在 $\\mathcal{A}$ 中，$c_X^{\\mathcal{A}} = 2000$，$c_Y^{\\mathcal{A}} = 2000$，$c_Z^{\\mathcal{A}} = 40000$，$c_S^{\\mathcal{A}} = 10000$；在 $\\mathcal{B}$ 中，$c_X^{\\mathcal{B}} = 2400$，$c_Y^{\\mathcal{B}} = 2400$，$c_Z^{\\mathcal{B}} = 144000$，$c_S^{\\mathcal{B}} = 12000$。假设存在以下基础模型：在均匀片段化和无偏采样的情况下，转录本 $i$ 的期望计数值 $c_i$ 与其每个细胞的分子数 $M_i$ 和其长度 $L_i$ 的乘积成正比，比例因子是一个样本特异性的常数，该常数包含了测序深度和捕获效率的影响。该模型同样适用于 spike-in 转录本 $S$。\n\n仅使用适用于转录组学和表达谱分析的基本定义和原理，完成以下任务：\n\n- 定义每百万转录本数（TPM），并用它计算 $\\mathrm{TPM}_X^{\\mathcal{A}}$ 和 $\\mathrm{TPM}_X^{\\mathcal{B}}$，将 TPM 计算限制在内源性基因集 $\\{X,Y,Z\\}$ 内，并计算基于 TPM 的基因 $X$ 的倍数变化，由 $\\frac{\\mathrm{TPM}_X^{\\mathcal{B}}}{\\mathrm{TPM}_X^{\\mathcal{A}}}$ 给出。\n\n- 从相对测量值（其总和为常数）的组分性质和提供的绝对丰度出发，分析性地解释当样本间每个细胞的总 RNA 含量不同时，依赖 TPM 为何会引入组分假象。\n\n- 推导一个基于 spike-in 的归一化方程，用于从相对于 spike-in 的长度归一化计数来估计内源性转录本 $i$ 的每个细胞的绝对分子数，并将其应用于样本 $\\mathcal{A}$ 和 $\\mathcal{B}$ 中的基因 $X$，以计算经 spike-in 归一化后的倍数变化\n$$\nF_X \\equiv \\frac{\\widehat{M}_X^{\\mathcal{B}}}{\\widehat{M}_X^{\\mathcal{A}}}.\n$$\n\n将最终数值答案报告为经 spike-in 归一化后的倍数变化 $F_X$。将您的最终答案四舍五入到四位有效数字。倍数变化不需要物理单位。",
            "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于转录组数据分析的原理，问题提出得当，给出的条件完整且一致，并以客观、正式的语言表述。所提供的数值数据与基础模型一致，证实了问题的内部逻辑一致性。因此，我们可以进行完整解答。\n\n问题要求完成三个不同的任务：使用每百万转录本数（TPM）进行分析，对组分假象进行分析性解释，以及使用 spike-in 归一化分析来计算基因 $X$ 的倍数变化。\n\n**1. 每百万转录本数（TPM）分析**\n\n首先，我们定义每百万转录本数（TPM）。TPM 是衡量转录本相对丰度的指标。其计算方法是先对基因长度进行归一化，然后对测序深度进行归一化，通过缩放数值使得一个样本中所有 TPM 值的总和为 $1,000,000$。\n\n对于基因集 $\\mathcal{G}$ 中的一个给定基因 $i$，其 TPM 值的计算方法如下：\n1.  对于每个基因 $j \\in \\mathcal{G}$，将其读数计数 $c_j$ 按其长度 $L_j$（单位为 kb）进行归一化，得到一个比率 $r_j = \\frac{c_j}{L_j}$。\n2.  计算样本中所有这些比率的总和：$T = \\sum_{j \\in \\mathcal{G}} r_j = \\sum_{j \\in \\mathcal{G}} \\frac{c_j}{L_j}$。\n3.  基因 $i$ 的 TPM 则由下式给出：\n$$\n\\mathrm{TPM}_i = \\left(\\frac{r_i}{T}\\right) \\times 10^6 = \\left(\\frac{c_i/L_i}{\\sum_{j \\in \\mathcal{G}} c_j/L_j}\\right) \\times 10^6\n$$\n问题指定 TPM 计算应仅限于内源性基因集 $\\{X, Y, Z\\}$。\n\n**对于样本 $\\mathcal{A}$：**\n给定值为 $L_X = 2$，$L_Y = 1$，$L_Z = 4$（单位 kb），以及计数 $c_X^{\\mathcal{A}} = 2000$，$c_Y^{\\mathcal{A}} = 2000$，$c_Z^{\\mathcal{A}} = 40000$。\n比率为：\n$r_X^{\\mathcal{A}} = \\frac{c_X^{\\mathcal{A}}}{L_X} = \\frac{2000}{2} = 1000$\n$r_Y^{\\mathcal{A}} = \\frac{c_Y^{\\mathcal{A}}}{L_Y} = \\frac{2000}{1} = 2000$\n$r_Z^{\\mathcal{A}} = \\frac{c_Z^{\\mathcal{A}}}{L_Z} = \\frac{40000}{4} = 10000$\n\n比率之和为 $T^{\\mathcal{A}} = r_X^{\\mathcal{A}} + r_Y^{\\mathcal{A}} + r_Z^{\\mathcal{A}} = 1000 + 2000 + 10000 = 13000$。\n样本 $\\mathcal{A}$ 中基因 $X$ 的 TPM 为：\n$\\mathrm{TPM}_X^{\\mathcal{A}} = \\left(\\frac{1000}{13000}\\right) \\times 10^6 = \\frac{1}{13} \\times 10^6$。\n\n**对于样本 $\\mathcal{B}$：**\n给定值为 $L_X = 2$，$L_Y = 1$，$L_Z = 4$（单位 kb），以及计数 $c_X^{\\mathcal{B}} = 2400$，$c_Y^{\\mathcal{B}} = 2400$，$c_Z^{\\mathcal{B}} = 144000$。\n比率为：\n$r_X^{\\mathcal{B}} = \\frac{c_X^{\\mathcal{B}}}{L_X} = \\frac{2400}{2} = 1200$\n$r_Y^{\\mathcal{B}} = \\frac{c_Y^{\\mathcal{B}}}{L_Y} = \\frac{2400}{1} = 2400$\n$r_Z^{\\mathcal{B}} = \\frac{c_Z^{\\mathcal{B}}}{L_Z} = \\frac{144000}{4} = 36000$\n\n比率之和为 $T^{\\mathcal{B}} = r_X^{\\mathcal{B}} + r_Y^{\\mathcal{B}} + r_Z^{\\mathcal{B}} = 1200 + 2400 + 36000 = 39600$。\n样本 $\\mathcal{B}$ 中基因 $X$ 的 TPM 为：\n$\\mathrm{TPM}_X^{\\mathcal{B}} = \\left(\\frac{1200}{39600}\\right) \\times 10^6 = \\frac{12}{396} \\times 10^6 = \\frac{1}{33} \\times 10^6$。\n\n**基于 TPM 的基因 $X$ 的倍数变化：**\n倍数变化是比率 $\\frac{\\mathrm{TPM}_X^{\\mathcal{B}}}{\\mathrm{TPM}_X^{\\mathcal{A}}}$。\n$$\n\\frac{\\mathrm{TPM}_X^{\\mathcal{B}}}{\\mathrm{TPM}_X^{\\mathcal{A}}} = \\frac{\\frac{1}{33} \\times 10^6}{\\frac{1}{13} \\times 10^6} = \\frac{13}{33} \\approx 0.3939\n$$\n这个结果表明，与样本 $\\mathcal{A}$ 相比，基因 $X$ 在样本 $\\mathcal{B}$ 中被强烈下调。\n\n**2. TPM 引入的组分假象的分析性解释**\n\n基础模型指出，转录本 $i$ 的期望计数值 $c_i$ 与其分子数 $M_i$ 和长度 $L_i$ 的乘积成正比。设 $k$ 为样本特异性的比例因子（与测序深度相关）。\n$c_i = k \\cdot M_i \\cdot L_i$。\n\n将此代入 TPM 公式（忽略在比率中会抵消的 $10^6$ 缩放因子）：\n$$\n\\mathrm{TPM}_i \\propto \\frac{c_i/L_i}{\\sum_{j \\in \\mathcal{G}} c_j/L_j} = \\frac{(k \\cdot M_i \\cdot L_i)/L_i}{\\sum_{j \\in \\mathcal{G}} (k \\cdot M_j \\cdot L_j)/L_j} = \\frac{k \\cdot M_i}{k \\sum_{j \\in \\mathcal{G}} M_j} = \\frac{M_i}{\\sum_{j \\in \\mathcal{G}} M_j}\n$$\n这表明 TPM 是转录本 $i$ 相对于所考虑基因集 $\\mathcal{G}$ 中所有转录本总摩尔量的相对摩尔丰度的一种度量，记为 $M_{\\mathrm{total}} = \\sum_{j \\in \\mathcal{G}} M_j$。\n\n样本 $\\mathcal{B}$ 和 $\\mathcal{A}$ 之间基于 TPM 的倍数变化为：\n$$\n\\frac{\\mathrm{TPM}_i^{\\mathcal{B}}}{\\mathrm{TPM}_i^{\\mathcal{A}}} = \\frac{M_i^{\\mathcal{B}}/M_{\\mathrm{total}}^{\\mathcal{B}}}{M_i^{\\mathcal{A}}/M_{\\mathrm{total}}^{\\mathcal{A}}} = \\left(\\frac{M_i^{\\mathcal{B}}}{M_i^{\\mathcal{A}}}\\right) \\cdot \\left(\\frac{M_{\\mathrm{total}}^{\\mathcal{A}}}{M_{\\mathrm{total}}^{\\mathcal{B}}}\\right)\n$$\n真实的绝对倍数变化是 $\\frac{M_i^{\\mathcal{B}}}{M_i^{\\mathcal{A}}}$。基于 TPM 的倍数变化被因子 $\\frac{M_{\\mathrm{total}}^{\\mathcal{A}}}{M_{\\mathrm{total}}^{\\mathcal{B}}}$ 扭曲了，该因子是两个样本中每个细胞内源性转录本分子总数的反比。这是一种组分假象。因为 TPM 是一种相对度量，一个高表达基因（如基因 $Z$）丰度的巨大变化会改变分母 $M_{\\mathrm{total}}$，从而改变所有其他基因的表观丰度，即使它们的绝对丰度是恒定的。\n\n在本问题中：\n$M_{\\mathrm{total}}^{\\mathcal{A}} = M_X^{\\mathcal{A}} + M_Y^{\\mathcal{A}} + M_Z^{\\mathcal{A}} = 10 + 20 + 100 = 130$ 分子/细胞。\n$M_{\\mathrm{total}}^{\\mathcal{B}} = M_X^{\\mathcal{B}} + M_Y^{\\mathcal{B}} + M_Z^{\\mathcal{B}} = 10 + 20 + 300 = 330$ 分子/细胞。\n基因 $X$ 的真实倍数变化是 $\\frac{M_X^{\\mathcal{B}}}{M_X^{\\mathcal{A}}} = \\frac{10}{10} = 1$。\n基于 TPM 的倍数变化预测为 $1 \\times \\frac{130}{330} = \\frac{13}{33}$，这与我们的计算完全相符。样本 $\\mathcal{B}$ 中 $M_Z$ 的大幅增加使得丰度恒定的基因 $X$ 表现出下调。\n\n**3. 基于 Spike-in 的归一化**\n\nspike-in 对照提供了一个稳定的参考，可以据此估计绝对丰度。同样的模型 $c_i = k \\cdot M_i \\cdot L_i$ 也适用于 spike-in 转录本 $S$。对于一个通用样本：\n$c_i = k \\cdot M_i \\cdot L_i$\n$c_S = k \\cdot M_S \\cdot L_S$\n这里，$M_S$ 是已知的加入的 spike-in 分子数，给定为每个细胞 $S=50$ 个分子。\n\n我们可以使用 spike-in 方程求解未知的深度因子 $k$：$k = \\frac{c_S}{S \\cdot L_S}$。\n将此代入内源性基因 $i$ 的方程中：\n$c_i = \\left(\\frac{c_S}{S \\cdot L_S}\\right) \\cdot M_i \\cdot L_i$\n\n我们现在可以求解 $M_i$ 来得到其估计的绝对丰度 $\\widehat{M}_i$：\n$$\n\\widehat{M}_i = c_i \\cdot \\frac{S \\cdot L_S}{c_S \\cdot L_i} = S \\cdot \\frac{c_i/L_i}{c_S/L_S}\n$$\n该方程表明，基因 $i$ 的绝对丰度是通过将已知的 spike-in 丰度 $S$ 乘以基因 $i$ 与 spike-in $S$ 的长度归一化计数的比率来估计的。\n\n现在我们将此应用于两个样本中的基因 $X$。\n相关值为：$S=50$，$L_X=2$，$L_S=2$。\n\n**对于样本 $\\mathcal{A}$：**\n$c_X^{\\mathcal{A}} = 2000$，$c_S^{\\mathcal{A}} = 10000$。\n$$\n\\widehat{M}_X^{\\mathcal{A}} = 50 \\cdot \\frac{2000/2}{10000/2} = 50 \\cdot \\frac{1000}{5000} = 50 \\cdot \\frac{1}{5} = 10\n$$\n这正确地恢复了真实的绝对丰度 $M_X^{\\mathcal{A}} = 10$ 分子/细胞。\n\n**对于样本 $\\mathcal{B}$：**\n$c_X^{\\mathcal{B}} = 2400$，$c_S^{\\mathcal{B}} = 12000$。\n$$\n\\widehat{M}_X^{\\mathcal{B}} = 50 \\cdot \\frac{2400/2}{12000/2} = 50 \\cdot \\frac{1200}{6000} = 50 \\cdot \\frac{1}{5} = 10\n$$\n这也正确地恢复了真实的绝对丰度 $M_X^{\\mathcal{B}} = 10$ 分子/细胞。\n\n**经 spike-in 归一化的基因 $X$ 的倍数变化：**\n所要求的倍数变化是 $F_X = \\frac{\\widehat{M}_X^{\\mathcal{B}}}{\\widehat{M}_X^{\\mathcal{A}}}$。\n$$\nF_X = \\frac{10}{10} = 1\n$$\nspike-in 归一化正确地确定了基因 $X$ 的绝对丰度在两个样本之间没有变化，得出的倍数变化为 $1$。这成功地纠正了使用 TPM 时观察到的组分假象。\n\n问题要求最终答案四舍五入到四位有效数字。确切答案是 $1$。为了以所要求的精度表示，我们写作 $1.000$。",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "在理解了基因表达数据的“组分性”特质后，我们来探讨另一种常见的偏差来源：组分偏差 (composition bias)。即使起始的 RNA 总量相同，少数高表达基因的剧烈变化也会“稀释”文库中所有其他基因的相对比例，导致错误的差异表达分析结果。这项动手实践  将引导你完成 Trimmed Mean of $M$-values (TMM) 归一化方法的计算，这是一种修正此类偏差的稳健方法，并让你从根本上理解为何简单的按总读数（library size）进行缩放是不够的。",
            "id": "3311834",
            "problem": "一项基于测序的转录组分析实验获得了两个样本（记为样本 $A$ 和样本 $B$）在 $10$ 个基因上的读数计数数据。假设基础测序过程可以建模为对信使核糖核酸（mRNA）分子群体的多项式抽样：每个样本的观测计数值是随机抽样的结果，其概率与真实的相对转录本丰度成正比，并按其总文库大小进行缩放。标准化的目标是通过消除测序深度和组成效应来恢复样本间的可比性，从而对于大多数真实丰度在样本间没有变化的基因，其标准化后的表达比率以1为中心。\n\n已知该数据集表现出强烈的组成偏差：两个高丰度的核糖体基因在样本 $B$ 中显著上调，而其余基因的真实丰度没有变化。观测到的计数值如下：\n\n- 样本 $A$ 的总文库大小为 $N_{A} = 1{,}000{,}000$，其计数值为：\n  基因 $1$：$100{,}000$；基因 $2$：$80{,}000$；基因 $3$：$150{,}000$；基因 $4$：$130{,}000$；基因 $5$：$120{,}000$；基因 $6$：$100{,}000$；基因 $7$：$90{,}000$；基因 $8$：$70{,}000$；基因 $9$：$80{,}000$；基因 $10$：$80{,}000$。\n\n- 样本 $B$ 的总文库大小为 $N_{B} = 1{,}048{,}000$，其计数值为：\n  基因 $1$：$400{,}000$；基因 $2$：$320{,}000$；基因 $3$：$60{,}000$；基因 $4$：$52{,}000$；基因 $5$：$48{,}000$；基因 $6$：$40{,}000$；基因 $7$：$36{,}000$；基因 $8$：$28{,}000$；基因 $9$：$32{,}000$；基因 $10$：$32{,}000$。\n\n使用 M 值截尾均值（TMM）标准化方法 (Robinson and Oshlack)，计算样本 $B$ 相对于样本 $A$ 的标准化因子。对于此数据集，对保留的基因采用相等的权重，并通过排除两个具有最大绝对对数表达比率的基因（即基因 $1$ 和 $2$）进行截尾处理。将 TMM 标准化因子报告为一个无量纲标量，并四舍五入到四位有效数字。\n\n此外，请基于读数生成的多项式抽样观点以及将大多数未变化基因的表达比率中心化在1的目标，从第一性原理出发，解释为什么仅基于 $\\frac{N_{A}}{N_{B}}$ 的简单文库大小缩放方法在这种组成偏差下会失效。\n\n将您的最终数值答案四舍五入到四位有效数字，并以无量纲因子的形式报告。",
            "solution": "首先将根据指定标准对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- 样本：样本 $A$，样本 $B$。\n- 基因数量：$10$。\n- 模型：对信使核糖核酸（mRNA）分子群体的多项式抽样。\n- 组成偏差：两个高丰度的核糖体基因（基因 $1$ 和基因 $2$）在样本 $B$ 中显著上调。其余基因的真实丰度没有变化。\n- 样本 $A$ 数据：\n  - 总文库大小：$N_{A} = 1,000,000$。\n  - 基因计数值 ($C_{gA}$):\n    - 基因 $1$：$100,000$\n    - 基因 $2$：$80,000$\n    - 基因 $3$：$150,000$\n    - 基因 $4$：$130,000$\n    - 基因 $5$：$120,000$\n    - 基因 $6$：$100,000$\n    - 基因 $7$：$90,000$\n    - 基因 $8$：$70,000$\n    - 基因 $9$：$80,000$\n    - 基因 $10$：$80,000$\n- 样本 $B$ 数据：\n  - 总文库大小：$N_{B} = 1,048,000$。\n  - 基因计数值 ($C_{gB}$):\n    - 基因 $1$：$400,000$\n    - 基因 $2$：$320,000$\n    - 基因 $3$：$60,000$\n    - 基因 $4$：$52,000$\n    - 基因 $5$：$48,000$\n    - 基因 $6$：$40,000$\n    - 基因 $7$：$36,000$\n    - 基因 $8$：$28,000$\n    - 基因 $9$：$32,000$\n    - 基因 $10$：$32,000$\n- 标准化方法：M 值截尾均值 (TMM)。\n- TMM 参数：\n  - 参考样本：样本 $A$。\n  - 目标样本：样本 $B$。\n  - 权重：对保留的基因使用相等权重。\n  - 截尾：排除两个具有最大绝对对数表达比率的基因。\n- 要求输出：将样本 $B$ 的 TMM 标准化因子四舍五入到四位有效数字，并提供关于简单文库大小缩放方法失效的第一性原理的解释。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题牢固植根于计算系统生物学，特别是在转录组学数据（RNA-seq）的分析中。多项式抽样模型是测序计数的标准理论框架。组成偏差是此类数据中一种有据可查的人为现象，而 TMM 标准化是解决该问题的一种广泛接受的方法。所提供的数据虽然是为了一个明确的例子而设计的，但在数值上是一致的（计数值总和等于文库大小），并代表了一个合理但夸张的生物学场景。该问题在科学上是合理的。\n2.  **提问明确：** 问题提供了所有必要的数据，并定义了方法（TMM）、参考样本 ($A$)、截尾标准（绝对M值最大的前 $2$ 个基因）和加权方案（相等权重）。这些规范足以计算出唯一的标准化因子。\n3.  **客观性：** 问题以精确、技术性的语言表述，没有主观性或意见。数据和任务都是事实陈述。\n\n### 第三步：结论与行动\n问题有效。将提供一个完整且有理有据的解决方案。\n\n### 解决方案\n\n该解决方案包括两部分：首先，计算 M 值截尾均值（TMM）标准化因子；其次，解释为什么在给定条件下，简单的文库大小缩放是不合适的。\n\n#### 第一部分：计算 TMM 标准化因子\n\nTMM 方法旨在估算一个有效的文库大小缩放因子，该因子能解释组成偏差。该过程包括计算对数倍数变化（$M$ 值）和平均丰度（$A$ 值），截去在这些指标上处于极端的基因，然后计算剩余基因的 $M$ 值的加权平均值，以推导出标准化因子。\n\n设 $C_{gi}$ 为样本 $i \\in \\{A, B\\}$ 中基因 $g$ 的观测读数计数，设 $N_i$ 为样本 $i$ 的总文库大小。样本 $i$ 中基因 $g$ 的标准化后表达比例为 $P_{gi} = C_{gi} / N_i$。\n\n基因 $g$ 的 $M$ 值（对数比率）比较了样本 $B$ 相对于参考样本 $A$ 的表达：\n$$M_g = \\log_2\\left(\\frac{P_{gB}}{P_{gA}}\\right) = \\log_2\\left(\\frac{C_{gB}/N_B}{C_{gA}/N_A}\\right) = \\log_2\\left(\\frac{C_{gB}}{C_{gA}} \\cdot \\frac{N_A}{N_B}\\right)$$\n\n我们已知 $N_A = 1,000,000$ 和 $N_B = 1,048,000$。文库大小比率为 $\\frac{N_A}{N_B} = \\frac{1,000,000}{1,048,000} \\approx 0.9542$。\n\n让我们计算所有 $10$ 个基因的 $M$ 值。\n\n对于基因 $1$：$C_{1A} = 100,000$，$C_{1B} = 400,000$。计数值比率为 $\\frac{C_{1B}}{C_{1A}} = 4$。\n$$M_1 = \\log_2\\left(4 \\cdot \\frac{1,000,000}{1,048,000}\\right) \\approx \\log_2(3.8168) \\approx 1.932$$\n\n对于基因 $2$：$C_{2A} = 80,000$，$C_{2B} = 320,000$。计数值比率为 $\\frac{C_{2B}}{C_{2A}} = 4$。\n$$M_2 = \\log_2\\left(4 \\cdot \\frac{1,000,000}{1,048,000}\\right) \\approx \\log_2(3.8168) \\approx 1.932$$\n\n对于基因 $3$ 到 $10$，题目设计使得计数值比率 $C_{gB}/C_{gA}$ 是一个常数。我们来验证一下基因 $3$：\n$C_{3A} = 150,000$，$C_{3B} = 60,000$。计数值比率为 $\\frac{C_{3B}}{C_{3A}} = \\frac{60,000}{150,000} = 0.4$。\n对于基因 $4$：$C_{4A} = 130,000$，$C_{4B} = 52,000$。计数值比率为 $\\frac{C_{4B}}{C_{4A}} = \\frac{52,000}{130,000} = 0.4$。\n这个规律对基因 $g \\in \\{3, 4, \\dots, 10\\}$ 都成立。对于这组基因，$M$ 值为：\n$$M_{g \\in \\{3..10\\}} = \\log_2\\left(0.4 \\cdot \\frac{1,000,000}{1,048,000}\\right) \\approx \\log_2(0.38168) \\approx -1.389$$\n\n题目要求截去具有最大绝对 $M$ 值的两个基因。\n我们有 $|M_1| = |M_2| \\approx 1.932$ 和 $|M_{g \\in \\{3..10\\}}| \\approx 1.389$。\n显然，基因 $1$ 和 $2$ 具有最大的绝对 $M$ 值，因此被截去。\n\n保留的基因集合为 $G' = \\{3, 4, 5, 6, 7, 8, 9, 10\\}$，其中 $|G'| = 8$。\n样本 $B$ 的 TMM 标准化因子，记作 $F_B$，由保留基因的 $M$ 值的加权平均值确定。题目指定使用相等权重，因此计算简化为算术平均值：\n$$\\log_2(F_B) = \\frac{\\sum_{g \\in G'} M_g}{\\sum_{g \\in G'} 1} = \\frac{1}{|G'|} \\sum_{g \\in G'} M_g$$\n由于对于所有 $g \\in G'$，$M_g$ 都是常数，所以平均值就是这个值：\n$$\\log_2(F_B) = \\log_2\\left(0.4 \\cdot \\frac{N_A}{N_B}\\right)$$\nTMM因子本身是$2$的这个平均值次方。\n$$F_B = 2^{\\frac{1}{|G'|} \\sum_{g \\in G'} M_g} = 2^{\\log_2\\left(0.4 \\cdot \\frac{N_A}{N_B}\\right)} = 0.4 \\cdot \\frac{N_A}{N_B}$$\n代入给定的文库大小：\n$$F_B = 0.4 \\cdot \\frac{1,000,000}{1,048,000} = \\frac{400,000}{1,048,000} \\approx 0.381679389...$$\n四舍五入到四位有效数字，TMM 标准化因子为 $0.3817$。\n\n#### 第二部分：简单的文库大小缩放方法的失效\n\n在存在组成偏差的情况下，简单的文库大小缩放方法的失效可以用 RNA 测序的多项式抽样模型从第一性原理进行解释。\n\n1.  **真实分子丰度与比例：** 设 $\\mu_{gi}$ 为样本 $i \\in \\{A, B\\}$ 的生物材料中基因 $g$ 的真实的（未观测到的）mRNA 分子数。样本 $i$ 中的 mRNA 分子总数为 $T_i = \\sum_{g} \\mu_{gi}$。基因 $g$ 的真实相对丰度或比例为 $\\pi_{gi} = \\mu_{gi} / T_i$。\n\n2.  **多项式抽样：** 测序过程从这个分子群体中抽取 $N_i$ 个读数（文库大小）。因此，样本 $i$ 中基因 $g$ 的期望计数值为 $E[C_{gi}] = N_i \\cdot \\pi_{gi} = N_i \\cdot (\\mu_{gi} / T_i)$。\n\n3.  **组成偏差的影响：** 问题陈述指出，对于基因 $g \\in \\{3, ..., 10\\}$，它们的真实丰度没有改变，这意味着对于这组占大多数的基因，$\\mu_{gA} = \\mu_{gB}$。然而，对于基因 $1$ 和 $2$，在样本 $B$ 中有显著上调，意味着 $\\mu_{1B} \\gg \\mu_{1A}$ 和 $\\mu_{2B} \\gg \\mu_{2A}$。\n    少数高丰度转录本的这种大量增加，极大地增加了样本 $B$ 相对于样本 $A$ 的总 mRNA 池的大小。也就是说，$T_B = \\sum_g \\mu_{gB} > \\sum_g \\mu_{gA} = T_A$。\n\n4.  **比例的扭曲：** 对于任何非差异表达基因 $g'$（其中 $\\mu_{g'A} = \\mu_{g'B}$），其在两个样本间的真实比例的比值为：\n    $$\\frac{\\pi_{g'B}}{\\pi_{g'A}} = \\frac{\\mu_{g'B}/T_B}{\\mu_{g'A}/T_A} = \\frac{\\mu_{g'A}/T_B}{\\mu_{g'A}/T_A} = \\frac{T_A}{T_B}$$\n    由于 $T_B > T_A$，这个比率小于 $1$。这就是组成偏差的本质：某些转录本的大量产生稀释了所有其他转录本的*比例*，即使那些绝对分子数量未变的转录本也是如此。\n\n5.  **简单缩放的失效：** 简单的文库大小缩放方法将表达比率计算为 $\\frac{C_{gB}/N_B}{C_{gA}/N_A}$。其基本假设是，对于一个非差异表达的基因，这个比率应该为 $1$。然而，根据我们的模型，这个比率的期望值为：\n    $$\\frac{E[C_{gB}]/N_B}{E[C_{gA}]/N_A} = \\frac{(N_B \\cdot \\pi_{gB})/N_B}{(N_A \\cdot \\pi_{gA})/N_A} = \\frac{\\pi_{gB}}{\\pi_{gA}} = \\frac{T_A}{T_B}$$\n    由于组成的改变，$T_A/T_B  1$。在本问题中，比率 $T_A/T_B$ 由 TMM 因子 $F_B \\approx 0.3817$ 估算。因此，简单的缩放会错误地报告大多数基因被下调了约 $0.3817$ 倍。该方法之所以失效，是因为它错误地假设测序文库大小 $N_i$ 是有效文库大小的直接且充分的代表，而忽略了组成变化对读数抽样所依据的基础比例 ($\\pi_{gi}$) 的深刻影响。TMM 正确地估计并补偿了这种由总 RNA 池大小 ($T_i$) 变化引起的扭曲。",
            "answer": "$$\\boxed{0.3817}$$"
        },
        {
            "introduction": "从整体 (bulk) RNA 测序到单细胞 RNA 测序的跨越，带来了新的数据分析挑战，其中最突出的就是如何对普遍存在的“零值”进行建模。这些零值究竟代表了基因真实的未表达，还是由于技术限制（如 RNA 捕获效率低）造成的“技术性零”？这项练习  将挑战你对这一核心问题的批判性思维，通过从第一性原理出发推导计数模型，并将其预测与观测数据进行比较，你将学会如何严谨地评估是否需要使用更复杂的零膨胀（zero-inflated）模型来描述单细胞数据。",
            "id": "3311792",
            "problem": "给定使用单细胞转录组学中的独特分子标识符 (UMI) 测序技术测量的、单个基因在多个细胞中的计数数据。您必须从第一性原理出发，判断这些 UMI 计数是否需要使用零膨胀模型，或者一个能够捕捉细胞间异质性的负二项 (NB) 混合模型是否足够。该决策必须通过比较观测到的零计数频率与一个从机理抽样模型推导出的 NB 混合模型所预测的零计数频率来做出。\n\n使用的基础理论：\n- 分子生物学的中心法则描述了信息从 DNA 流向 RNA 再到蛋白质的过程，在表达谱分析中，信使核糖核酸 (mRNA) 分子被抽样和计数。\n- 在 UMI 测序中，定量是基于对捕获并去重的分子进行计数，这可以被建模为一个抽样过程。\n- 对于 UMI 计数，一个典型的假设是，在给定每个细胞捕获效率的条件下，一个细胞中某个特定基因被捕获的分子数量是泊松过程的一个实现。\n- 真实的潜在表达水平在细胞间的异质性可以通过一个跨细胞的伽马分布来建模，这导致了计数的泊松-伽马混合，即一个负二项 (NB) 分布。\n- 多个细胞亚群的混合（每个亚群有其自身的 NB 参数）在整个细胞群体上产生了一个 NB 混合模型。\n- 零膨胀负二项 (ZINB) 模型在 NB（或 NB 混合）模型预测的基础上，在零点额外增加了一个点质量。\n\n您的推导必须从泊松抽样假设和伽马异质性出发，逻辑上推导出 NB 分布、在 NB 模型下零计数的概率，然后聚合到跨细胞亚群和可变文库大小的 NB 混合模型。在本问题陈述中，您不能使用快捷公式；请在您的解决方案中进行推导。\n\n需实现的决策规则：\n- 考虑 $n$ 个细胞，索引为 $i \\in \\{1,\\dots,n\\}$。\n- 令 $s_i$ 表示细胞 $i$ 的大小因子（文库大小缩放），并视为已知。\n- 假设有 $m$ 个潜在亚群，索引为 $j \\in \\{1,\\dots,m\\}$，其混合权重为 $w_j$（非负且总和为 1），每个亚群的 NB 参数由均值参数 $\\mu_j$ 和逆离散参数 $k_j$ 给出。\n- 在 NB 混合模型下，通过对混合成分进行加权求和，计算每个细胞 $i$ 的预测零概率，然后对所有细胞取平均，得到全局预测零分数 $p_0$。\n- 令 $Z$ 为表示 $n$ 个细胞中零计数数量的随机变量。在 NB 混合模型下，将 $Z$ 视为参数为 $(n, p_0)$ 的二项随机变量，作为零数量的第一性原理近似。\n- 给定观测到的零数量 $z_{\\text{obs}}$，计算二项分布的右尾概率 $\\mathbb{P}(Z \\ge z_{\\text{obs}})$，并与用户指定的显著性阈值 $\\alpha$ 进行比较。\n- 如果 $\\mathbb{P}(Z \\ge z_{\\text{obs}})  \\alpha$，则断定观测到的零计数超出了 NB 混合模型的预测，因此零膨胀模型是必要的；否则，断定零膨胀模型不是必要的。\n\n您的程序必须直接基于该推导实现此决策规则，并为每个测试用例生成一个布尔决策。\n\n测试套件：\n对于每个测试用例，程序必须构建一个长度为 $n = 100$ 的计数数组，方法是先拼接指定数量的零，然后重复一个正整数的周期性模式，直到数组长度达到 100。数组中的所有数字都是计数，并且是无量纲整数。对于每个案例，混合参数 $(w_j, \\mu_j, k_j)$、大小因子 $\\{s_i\\}$、显著性水平 $\\alpha$ 以及计数数组的构建方法在下面指定。\n\n- 案例 1 (理想情况：NB 混合模型足够):\n  - $n = 100$\n  - 混合权重: $w = [\\,0.4,\\,0.6\\,]$\n  - 均值: $\\mu = [\\,1.5,\\,5.0\\,]$\n  - 逆离散度: $k = [\\,2.0,\\,2.0\\,]$\n  - 大小因子: 对所有 $i$，$s_i = 1$ (即 $\\{s_i\\} = [\\,1, 1, \\dots, 1\\,]$，长度为 $100$)\n  - 计数构建: 放置 18 个零，然后重复正数模式 $[\\,1,\\,2,\\,1,\\,3,\\,2,\\,4,\\,1,\\,5,\\,2,\\,3\\,]$ 八次，并追加 $[\\,4,\\,2\\,]$ 以达到 100 的长度。\n  - 显著性水平: $\\alpha = 0.01$\n\n- 案例 2 (零过多：需要零膨胀模型):\n  - $n = 100$\n  - 混合权重: $w = [\\,0.4,\\,0.6\\,]$\n  - 均值: $\\mu = [\\,1.5,\\,5.0\\,]$\n  - 逆离散度: $k = [\\,2.0,\\,2.0\\,]$\n  - 大小因子: 对所有 $i$，$s_i = 1$\n  - 计数构建: 放置 40 个零，然后重复正数模式 $[\\,1,\\,2,\\,3,\\,2,\\,4,\\,3,\\,5,\\,2,\\,4,\\,3\\,]$ 六次以达到 100 的长度。\n  - 显著性水平: $\\alpha = 0.01$\n\n- 案例 3 (边界低表达：在 NB 模型下预期有大量零):\n  - $n = 100$\n  - 混合权重: $w = [\\,1.0\\,]$\n  - 均值: $\\mu = [\\,0.2\\,]$\n  - 逆离散度: $k = [\\,5.0\\,]$\n  - 大小因子: 对所有 $i$，$s_i = 1$\n  - 计数构建: 放置 82 个零，然后重复正数模式 $[\\,1,\\,1,\\,2,\\,1,\\,1,\\,2,\\,1,\\,2,\\,1\\,]$ 两次以达到 100 的长度。\n  - 显著性水平: $\\alpha = 0.01$\n\n- 案例 4 (异构文库大小：具有可变 $s_i$ 的 NB 混合模型):\n  - $n = 100$\n  - 混合权重: $w = [\\,0.5,\\,0.5\\,]$\n  - 均值: $\\mu = [\\,2.0,\\,8.0\\,]$\n  - 逆离散度: $k = [\\,1.2,\\,3.0\\,]$\n  - 大小因子: 前 50 个细胞 $s_i = 1$，后 50 个细胞 $s_i = 0.5$，即 $\\{s_i\\} = [\\,\\underbrace{1, \\dots, 1}_{50}, \\underbrace{0.5, \\dots, 0.5}_{50}\\,]$\n  - 计数构建: 放置 22 个零，然后重复正数模式 $[\\,1,\\,2,\\,3,\\,4,\\,5,\\,3,\\,4,\\,2,\\,6,\\,3,\\,2,\\,5,\\,4,\\,3,\\,7\\,]$ 五次，并追加 $[\\,4,\\,3,\\,2\\,]$ 以达到 100 的长度。\n  - 显著性水平: $\\alpha = 0.01$\n\n要求的输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的布尔决策，形式为方括号内以逗号分隔的列表，例如： $[\\,\\text{False},\\text{True},\\text{False},\\text{False}\\,]$。",
            "solution": "该问题要求基于第一性原理推导和统计检验，来判定对于单细胞 UMI 计数是否需要零膨胀模型。该决策取决于将观测到的零计数频率与负二项 (NB) 混合模型预测的频率进行比较。\n\n推导从 UMI 测序的基本过程开始。对于单个细胞 $i$ 中的某个特定基因，令其 mRNA 的真实（未观测到的）相对丰度由一个速率参数 $\\lambda_i$ 表示。捕获和测序这些分子的过程是一个离散的抽样过程。假设有足够多的分子存在，那么计数到的独特分子（UMI）数量 $c_i$，可以在此速率的条件下，被建模为一个泊松随机变量：\n$$c_i | \\lambda_i \\sim \\text{Poisson}(\\lambda_i)$$\n其概率质量函数 (PMF) 由下式给出：\n$$P(c_i=y | \\lambda_i) = \\frac{e^{-\\lambda_i} \\lambda_i^y}{y!} \\quad \\text{for } y \\in \\{0, 1, 2, \\dots\\}$$\n\n基因表达的细胞间变异性是单细胞数据的一个标志性特征。这种生物学异质性意味着速率参数 $\\lambda_i$ 在细胞群体中不是恒定的，其本身就是一个随机变量。对这种变异性进行建模的一个常见且数学上方便的选择是伽马分布。令 $\\lambda$ 在一个同质细胞亚群中的分布为：\n$$\\lambda \\sim \\text{Gamma}(\\text{shape}=k, \\text{rate}=\\beta)$$\n其概率密度函数 (PDF) 为：\n$$f(\\lambda; k, \\beta) = \\frac{\\beta^k}{\\Gamma(k)} \\lambda^{k-1} e^{-\\beta \\lambda}$$\n这里，$\\Gamma(k)$ 是伽马函数。\n\n计数 $c$ 在整个细胞群体中的边际分布是通过将条件泊松概率对 $\\lambda$ 的分布进行积分得到的：\n$$P(c=y) = \\int_0^\\infty P(c=y | \\lambda) f(\\lambda; k, \\beta) \\,d\\lambda$$\n$$P(c=y) = \\int_0^\\infty \\left( \\frac{e^{-\\lambda} \\lambda^y}{y!} \\right) \\left( \\frac{\\beta^k}{\\Gamma(k)} \\lambda^{k-1} e^{-\\beta \\lambda} \\right) \\,d\\lambda$$\n重新整理各项，我们得到：\n$$P(c=y) = \\frac{\\beta^k}{y! \\Gamma(k)} \\int_0^\\infty \\lambda^{y+k-1} e^{-(\\beta+1)\\lambda} \\,d\\lambda$$\n该积分是形状为 $y+k$、速率为 $\\beta+1$ 的伽马分布的核。积分的值为 $\\frac{\\Gamma(y+k)}{(\\beta+1)^{y+k}}$。将其代回得到：\n$$P(c=y) = \\frac{\\beta^k}{y! \\Gamma(k)} \\frac{\\Gamma(y+k)}{(\\beta+1)^{y+k}} = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\left(\\frac{\\beta}{\\beta+1}\\right)^k \\left(\\frac{1}{\\beta+1}\\right)^y$$\n这是负二项 (NB) 分布的 PMF。这证明了泊松-伽马混合等价于 NB 分布。\n\n问题使用均值参数 $\\mu$ 和逆离散参数 $k$ 来指定 NB 分布。我们必须将这些参数与伽马分布的参数关联起来。NB 分布的均值是其底层伽马分布的均值：\n$$E[c] = \\mu = E[\\lambda] = \\frac{k}{\\beta} \\implies \\beta = \\frac{k}{\\mu}$$\nNB 分布的方差是 $\\text{Var}(c) = \\mu + \\frac{\\mu^2}{k}$。这种参数化将伽马分布的形状参数确定为逆离散参数 $k$。\n\n现在我们可以推导在该 NB 模型下观测到零计数（$y=0$）的概率。使用推导出的 PMF：\n$$P(c=0) = \\frac{\\Gamma(0+k)}{0! \\Gamma(k)} \\left(\\frac{\\beta}{\\beta+1}\\right)^k \\left(\\frac{1}{\\beta+1}\\right)^0 = \\left(\\frac{\\beta}{\\beta+1}\\right)^k$$\n代入 $\\beta = k/\\mu$：\n$$P(c=0) = \\left(\\frac{k/\\mu}{k/\\mu + 1}\\right)^k = \\left(\\frac{k/\\mu}{(k+\\mu)/\\mu}\\right)^k = \\left(\\frac{k}{k+\\mu}\\right)^k$$\n\n单细胞实验通常每个细胞具有不同的文库大小（测序深度）。这通过一个细胞特异性的大小因子 $s_i$ 来解决，该因子用于缩放均值。因此，细胞 $i$ 的有效均值为 $s_i \\mu$。假设细胞 $i$ 来自一个参数为 $(\\mu, k)$ 的群体，其零计数的概率因此为：\n$$P(c_i=0 | \\mu, k, s_i) = \\left(\\frac{k}{k+s_i\\mu}\\right)^k$$\n\n总细胞群体可能是 $m$ 个不同亚群的混合，每个亚群都有自己的参数 $(\\mu_j, k_j)$ 和在总群体中的比例 $w_j$（其中 $\\sum_{j=1}^m w_j = 1$）。对于一个随机选择的细胞 $i$，其零计数的预测概率是它可能所属的所有亚群的加权平均值：\n$$p_{0,i} = P(c_i=0) = \\sum_{j=1}^m w_j P(c_i=0 | \\mu_j, k_j, s_i) = \\sum_{j=1}^m w_j \\left(\\frac{k_j}{k_j+s_i\\mu_j}\\right)^{k_j}$$\n\n为了得到包含 $n$ 个细胞的整个数据集的单一预测零频率，我们对单个概率求平均：\n$$p_0 = \\frac{1}{n} \\sum_{i=1}^n p_{0,i}$$\n\n最后，决策规则基于一个统计检验。原假设是，观测到的零数量 $z_{\\text{obs}}$ 与 NB 混合模型是一致的。我们将 $n$ 个细胞中的总零计数数量 $Z$ 建模为一个二项随机变量，其平均成功（零计数）概率为 $p_0$：\n$$Z \\sim \\text{Binomial}(n, p_0)$$\n这是一个近似方法，其中将每个细胞不同的概率 $p_{0,i}$ 替换为它们的平均值。我们通过计算在该原模型下观测到至少 $z_{\\text{obs}}$ 个零的概率来计算 p 值：\n$$\\mathbb{P}(Z \\ge z_{\\text{obs}}) = \\sum_{y=z_{\\text{obs}}}^n \\binom{n}{y} p_0^y (1-p_0)^{n-y}$$\n如果这个右尾概率小于指定的显著性水平 $\\alpha$，即 $\\mathbb{P}(Z \\ge z_{\\text{obs}})  \\alpha$，我们就拒绝原假设。这意味着观测到的零数量显著多于 NB 混合模型的预测，因此有必要使用零膨胀模型。否则，认为 NB 混合模型是足够的。\n\n这个从泊松抽样过程到最终统计检验的逐步推导，为所实现的程序提供了逻辑基础。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import binom\n\ndef solve():\n    \"\"\"\n    Validates if a zero-inflated model is warranted for UMI counts by comparing observed\n    zero counts to those predicted by a Negative Binomial (NB) mixture model.\n    \"\"\"\n\n    # Test suite definition as specified in the problem statement.\n    test_cases = [\n        {\n            \"n\": 100, \"z_obs\": 18, \"alpha\": 0.01,\n            \"mixture_weights\": np.array([0.4, 0.6]),\n            \"means\": np.array([1.5, 5.0]),\n            \"inv_dispersions\": np.array([2.0, 2.0]),\n            \"size_factors\": np.ones(100)\n        },\n        {\n            \"n\": 100, \"z_obs\": 40, \"alpha\": 0.01,\n            \"mixture_weights\": np.array([0.4, 0.6]),\n            \"means\": np.array([1.5, 5.0]),\n            \"inv_dispersions\": np.array([2.0, 2.0]),\n            \"size_factors\": np.ones(100)\n        },\n        {\n            \"n\": 100, \"z_obs\": 82, \"alpha\": 0.01,\n            \"mixture_weights\": np.array([1.0]),\n            \"means\": np.array([0.2]),\n            \"inv_dispersions\": np.array([5.0]),\n            \"size_factors\": np.ones(100)\n        },\n        {\n            \"n\": 100, \"z_obs\": 22, \"alpha\": 0.01,\n            \"mixture_weights\": np.array([0.5, 0.5]),\n            \"means\": np.array([2.0, 8.0]),\n            \"inv_dispersions\": np.array([1.2, 3.0]),\n            \"size_factors\": np.concatenate([np.ones(50), np.full(50, 0.5)])\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        n = case[\"n\"]\n        z_obs = case[\"z_obs\"]\n        alpha = case[\"alpha\"]\n        w = case[\"mixture_weights\"]\n        mu = case[\"means\"]\n        k = case[\"inv_dispersions\"]\n        s = case[\"size_factors\"]\n\n        # Vectorized calculation of predicted zero probabilities\n        # s has shape (n,), mu and k have shape (m,)\n        # Broadcasting s[:, np.newaxis] with mu[np.newaxis, :] creates an (n, m) matrix\n        # of scaled means for each cell and each mixture component.\n        scaled_means = s[:, np.newaxis] * mu[np.newaxis, :]\n\n        # Calculate the probability of zero for each cell under each mixture component.\n        # This results in an (n, m) matrix.\n        # The formula derived is P(c=0) = (k / (k + s*mu))^k\n        component_zero_probs = (k / (k + scaled_means)) ** k\n\n        # Calculate the per-cell zero probability by taking the weighted average\n        # over the mixture components. This results in a vector of shape (n,).\n        per_cell_zero_probs = np.sum(w * component_zero_probs, axis=1)\n\n        # Calculate the global average zero probability p0, as specified.\n        p_zero_predicted = np.mean(per_cell_zero_probs)\n\n        # Calculate the right-tail probability (p-value) under the Binomial model.\n        # P(Z >= z_obs) where Z ~ Binomial(n, p_zero_predicted)\n        # Using survival function sf(k) = P(X > k), so sf(k-1) = P(X >= k)\n        p_value = binom.sf(z_obs - 1, n, p_zero_predicted)\n        \n        # Make the decision based on the significance level alpha.\n        # True means zero-inflation is warranted.\n        decision = p_value  alpha\n        results.append(decision)\n\n    # Format the final output as a comma-separated list of booleans in brackets.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}