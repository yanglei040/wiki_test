{
    "hands_on_practices": [
        {
            "introduction": "理解酶动力学始于推导其最著名的模型。本练习 () 将引导你从一个基本的反应机制出发，直至得到普适的米氏方程。通过将反应转化为微分方程、进行量纲分析并应用无量纲化，你将把系统简化为其核心的无量纲形式，这是生物过程建模的一项基本技能。",
            "id": "3302218",
            "problem": "考虑一个在充分混合体系中遵循质量作用定律的单底物催化反应：$E + S \\rightleftharpoons ES \\to E + P$，其中 $E$ 是游离酶，$S$ 是底物，$ES$ 是酶-底物复合物，$P$ 是产物。令 $E(t)$、$S(t)$、$ES(t)$ 和 $P(t)$ 表示各物质浓度随时间 $t$ 变化的函数。令基元反应速率常数分别为：缔合反应 $E+S\\to ES$ 的速率常数为 $k_{1}$，解离反应 $ES\\to E+S$ 的速率常数为 $k_{-1}$，催化转换反应 $ES\\to E+P$ 的速率常数为 $k_{\\mathrm{cat}}$。假设酶守恒，$E_{\\mathrm{tot}} = E(t) + ES(t)$，其中 $E_{\\mathrm{tot}}$ 为常数。用基元反应速率常数定义米氏常数 $K_{M}$。使用国际单位制 (SI)，浓度单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$，时间单位为 $\\mathrm{s}$。\n任务：\n1. 使用质量作用定律，写出关于 $E(t)$、$S(t)$、$ES(t)$ 和 $P(t)$ 的常微分方程 (ODE)。\n2. 进行量纲分析，确定 $k_{1}$、$k_{-1}$、$k_{\\mathrm{cat}}$ 和 $K_{M}$ 的单位。验证每个速率定律中的每一项都具有一致的量纲。\n3. 引入以下无量纲化：选择底物尺度 $K_{M}$、酶尺度 $E_{\\mathrm{tot}}$ 和时间尺度 $1/k_{\\mathrm{cat}}$，并定义无量纲变量 $\\sigma = S/K_{M}$、$e = E/E_{\\mathrm{tot}}$、$c = ES/E_{\\mathrm{tot}}$ 和 $\\tau = k_{\\mathrm{cat}} t$。\n4. 在米氏 (MM) 动力学的准稳态假设 (QSSA) 条件下（其合理性由一个小的参数如 $E_{\\mathrm{tot}}/(K_{M}+S_{0}) \\ll 1$ 保证，其中 $S_{0}$ 是初始底物浓度），推导无量纲归一化产物生成速率 $v^{*}(\\sigma) = v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$ 作为 $\\sigma$ 的闭式函数，其中 $v = dP/dt$ 是产物生成速率。\n将 $v^{*}(\\sigma)$ 作为您的最终答案。最终答案必须是一个无单位的单个闭式解析表达式。",
            "solution": "该问题陈述经过了严格验证，被认为是具有科学依据、良定且客观的。它为一个酶动力学中的标准问题提供了完整且一致的设定。未发现任何缺陷。解答过程如下。\n\n反应机理由 $E + S \\rightleftharpoons ES \\to E + P$ 给出，其正向速率常数为 $k_1$，逆向速率常数为 $k_{-1}$，催化速率常数为 $k_{\\mathrm{cat}}$。\n\n**1. 常微分方程组 (ODEs)**\n\n将质量作用定律应用于该反应网络，我们可以写出物质 $E(t)$、$S(t)$、$ES(t)$ 和 $P(t)$ 浓度的随时间演化方程。各个反应步骤的速率为：\n- 缔合 $E+S\\to ES$：$v_1 = k_1 E(t) S(t)$\n- 解离 $ES\\to E+S$：$v_{-1} = k_{-1} ES(t)$\n- 催化 $ES\\to E+P$：$v_{\\mathrm{cat}} = k_{\\mathrm{cat}} ES(t)$\n\n每种物质浓度的净变化速率是生成它的反应速率之和减去消耗它的反应速率之和。\n\n$$ \\frac{dE}{dt} = -v_1 + v_{-1} + v_{\\mathrm{cat}} = -k_1 E(t)S(t) + (k_{-1} + k_{\\mathrm{cat}})ES(t) $$\n$$ \\frac{dS}{dt} = -v_1 + v_{-1} = -k_1 E(t)S(t) + k_{-1}ES(t) $$\n$$ \\frac{dES}{dt} = v_1 - v_{-1} - v_{\\mathrm{cat}} = k_1 E(t)S(t) - (k_{-1} + k_{\\mathrm{cat}})ES(t) $$\n$$ \\frac{dP}{dt} = v_{\\mathrm{cat}} = k_{\\mathrm{cat}}ES(t) $$\n\n问题陈述了总酶守恒，$E_{\\mathrm{tot}} = E(t) + ES(t)$。对此式对时间 $t$ 求导，得到 $\\frac{dE_{\\mathrm{tot}}}{dt} = \\frac{dE}{dt} + \\frac{dES}{dt}$。将推导出的 $E$ 和 $ES$ 的常微分方程相加可以证实这一点：$\\frac{dE}{dt} + \\frac{dES}{dt} = [-k_1 E S + (k_{-1} + k_{\\mathrm{cat}})ES] + [k_1 E S - (k_{-1} + k_{\\mathrm{cat}})ES] = 0$。\n\n**2. 量纲分析**\n\n令 $[X]$ 表示量 $X$ 的物理量纲。浓度单位为摩尔/升，我们将其量纲记为 $C = \\mathrm{mol}\\,\\mathrm{L}^{-1}$。时间单位为秒，记为 $T = \\mathrm{s}$。浓度变化率的量纲为 $C/T$。\n\n- 从 $dP/dt$ 方程中的 $k_{\\mathrm{cat}}ES(t)$ 项，我们有 $[k_{\\mathrm{cat}}][ES] = C/T$。由于 $[ES] = C$，因此 $[k_{\\mathrm{cat}}] = T^{-1}$。\n- 类似地，从 $dS/dt$ 方程中的 $k_{-1}ES(t)$ 项，我们有 $[k_{-1}][ES] = C/T$，这得出 $[k_{-1}] = T^{-1}$。\n- 从 $dS/dt$ 方程中的 $k_1 E(t)S(t)$ 项，我们有 $[k_1][E][S] = C/T$。由于 $[E] = [S] = C$，我们有 $[k_1]C^2 = C/T$，这得出 $[k_1] = C^{-1}T^{-1}$。\n- 米氏常数定义为 $K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}$。其量纲为 $[K_M] = \\frac{[k_{-1}] + [k_{\\mathrm{cat}}]}{[k_1]}$。由于 $k_{-1}$ 和 $k_{\\mathrm{cat}}$ 具有相同的量纲 $T^{-1}$，它们的和也具有量纲 $T^{-1}$。因此，$[K_M] = \\frac{T^{-1}}{C^{-1}T^{-1}} = C$。\n\n因此，单位为：\n- $k_1$：$\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$\n- $k_{-1}$：$\\mathrm{s}^{-1}$\n- $k_{\\mathrm{cat}}$：$\\mathrm{s}^{-1}$\n- $K_M$：$\\mathrm{mol}\\,\\mathrm{L}^{-1}$\n\n量纲一致性得到验证，因为每个常微分方程中的每一项都具有 $C/T$ 的量纲。\n\n**3. 无量纲化**\n\n我们引入问题中定义的无量纲变量和特征尺度：\n- 时间：$\\tau = k_{\\mathrm{cat}} t \\implies t = \\tau / k_{\\mathrm{cat}}$\n- 底物浓度：$\\sigma(\\tau) = S(t)/K_M \\implies S(t) = K_M \\sigma(\\tau)$\n- 酶复合物浓度：$c(\\tau) = ES(t)/E_{\\mathrm{tot}} \\implies ES(t) = E_{\\mathrm{tot}}c(\\tau)$\n- 游离酶浓度：$e(\\tau) = E(t)/E_{\\mathrm{tot}} \\implies E(t) = E_{\\mathrm{tot}}e(\\tau)$\n\n酶守恒定律 $E(t) + ES(t) = E_{\\mathrm{tot}}$ 变为 $E_{\\mathrm{tot}}e(\\tau) + E_{\\mathrm{tot}}c(\\tau) = E_{\\mathrm{tot}}$，简化为无量纲形式 $e(\\tau) + c(\\tau) = 1$。\n\n**4. 在准稳态假设下推导无量纲速率**\n\n为了推导归一化速率 $v^*(\\sigma)$，我们首先对酶-底物复合物 $ES$ 的常微分方程进行无量纲化。\n$$ \\frac{dES}{dt} = k_1 E(t)S(t) - (k_{-1} + k_{\\mathrm{cat}})ES(t) $$\n代入无量纲变量的定义：\n$$ \\frac{d(E_{\\mathrm{tot}}c)}{d(\\tau/k_{\\mathrm{cat}})} = k_1 (E_{\\mathrm{tot}}e)(K_M\\sigma) - (k_{-1} + k_{\\mathrm{cat}})(E_{\\mathrm{tot}}c) $$\n使用链式法则，$\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = k_{\\mathrm{cat}}\\frac{d}{d\\tau}$：\n$$ E_{\\mathrm{tot}}k_{\\mathrm{cat}} \\frac{dc}{d\\tau} = k_1 E_{\\mathrm{tot}} K_M e \\sigma - (k_{-1} + k_{\\mathrm{cat}}) E_{\\mathrm{tot}} c $$\n两边除以 $E_{\\mathrm{tot}}k_{\\mathrm{cat}}$：\n$$ \\frac{dc}{d\\tau} = \\frac{k_1 K_M}{k_{\\mathrm{cat}}} e \\sigma - \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} c $$\n代入 $e = 1 - c$ 和定义 $K_M = (k_{-1} + k_{\\mathrm{cat}})/k_1$。项 $\\frac{k_1 K_M}{k_{\\mathrm{cat}}} = \\frac{k_1}{k_{\\mathrm{cat}}} \\frac{k_{-1}+k_{\\mathrm{cat}}}{k_1} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}}$。\n$$ \\frac{dc}{d\\tau} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} (1-c) \\sigma - \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} c $$\n$$ \\frac{dc}{d\\tau} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} \\left[ (1-c)\\sigma - c \\right] $$\n$$ \\frac{dc}{d\\tau} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} \\left[ \\sigma - c(\\sigma+1) \\right] $$\n当中间复合物 $ES$ 的浓度变化的时间尺度远快于底物 $S$ 时，准稳态假设 (QSSA) 是有效的。这个条件，以 $E_{\\mathrm{tot}}/(K_M+S_0) \\ll 1$ 的形式给出，允许我们将快变量的时间导数设为零。在有量纲的情况下，$\\frac{dES}{dt} \\approx 0$。在无量纲的情况下，这对应于 $\\frac{dc}{d\\tau} \\approx 0$。\n将准稳态假设应用于 $c$ 的无量纲方程：\n$$ 0 \\approx \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} \\left[ \\sigma - c_{qss}(\\sigma+1) \\right] $$\n其中 $c_{qss}$ 是 $c$ 的准稳态值。由于前置因子不为零，括号中的项必须为零：\n$$ \\sigma - c_{qss}(\\sigma+1) = 0 $$\n$$ \\sigma = c_{qss}(\\sigma+1) $$\n解出 $c_{qss}$，得到无量纲复合物浓度作为无量纲底物浓度的函数：\n$$ c_{qss}(\\sigma) = \\frac{\\sigma}{1+\\sigma} $$\n产物生成速率为 $v = dP/dt = k_{\\mathrm{cat}}ES(t)$。问题要求的是无量纲归一化速率 $v^{*}(\\sigma) = v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$。\n$$ v^{*} = \\frac{k_{\\mathrm{cat}}ES(t)}{k_{\\mathrm{cat}}E_{\\mathrm{tot}}} = \\frac{ES(t)}{E_{\\mathrm{tot}}} $$\n根据定义，$c = ES(t)/E_{\\mathrm{tot}}$。因此，$v^{*} = c$。\n在准稳态假设下，速率由准稳态复合物浓度决定：\n$$ v^{*}(\\sigma) = c_{qss}(\\sigma) = \\frac{\\sigma}{1+\\sigma} $$\n这是无量纲形式的归一化米氏方程。",
            "answer": "$$ \\boxed{\\frac{\\sigma}{1+\\sigma}} $$"
        },
        {
            "introduction": "虽然准稳态假设 (Quasi-Steady-State Assumption, QSSA) 是一个强大的捷径，但对酶动力学的严格理解需要更深入地探讨时间尺度分离的数学原理。本练习 () 将介绍奇异摄动分析，作为一种严格证明 QSSA 合理性的方法。你将推导系统的慢流形，从而获得一个更精确的近似，并深入理解为何这类简化在特定生物学条件下是有效的。",
            "id": "3302214",
            "problem": "考虑一个单底物酶系统中的不可逆酶促反应机制，该机制遵循质量作用定律：$E + S \\xrightleftharpoons[k_{-1}]{k_{1}} C \\xrightarrow{k_{2}} E + P$。总酶浓度 $E_{T}$ 是守恒的，因此有 $E(t) = E_{T} - C(t)$。令 $S(t)$ 表示底物浓度，$C(t)$ 表示酶-底物复合物浓度。$S(t)$ 和 $C(t)$ 的有量纲质量作用动力学方程为\n$$\n\\frac{dS}{dt} = -k_{1}\\big(E_{T} - C\\big) S + k_{-1} C, \\qquad\n\\frac{dC}{dt} = k_{1}\\big(E_{T} - C\\big) S - (k_{-1} + k_{2}) C,\n$$\n其中米氏常数定义为 $K_{M} \\equiv \\frac{k_{-1} + k_{2}}{k_{1}}$。使用量纲分析，基于特征底物浓度 $S_{0} > 0$（例如，初始底物水平）和总酶浓度 $E_{T} > 0$ 引入无量纲变量：$s \\equiv \\frac{S}{S_{0}}$，$c \\equiv \\frac{C}{E_{T}}$，以及无量纲时间 $\\tau \\equiv k_{1} S_{0} t$。定义无量纲参数 $\\kappa \\equiv \\frac{K_{M}}{S_{0}}$，$\\rho \\equiv \\frac{k_{2}}{k_{1} S_{0}}$ 和 $\\varepsilon \\equiv \\frac{E_{T}}{S_{0}}$。从这些基本定义出发，不援引任何现成的准稳态公式，在极限 $\\varepsilon \\to 0^{+}$下进行奇异摄动分析，以推导米氏-孟顿系统轨迹的慢流形近似 $c = \\phi(s)$，精确到 $O(\\varepsilon)$ 阶。具体要求：\n- 推导以变量 $(s,c)$ 和参数 $(\\kappa,\\rho,\\varepsilon)$ 表示的无量纲动力学系统。\n- 通过施加流形不变性，计算领先阶 $O(1)$ 的临界流形和 $O(\\varepsilon)$ 阶的修正项。\n- 从物理上解释小参数 $\\varepsilon$ 在酶饱和和时间尺度分离方面的含义，并阐明为何 $c$ 中的酶饱和度可以是 $O(1)$ 阶，而 $s$ 的消耗仍是 $O(\\varepsilon)$ 阶。\n\n将你的最终结果表示为慢流形 $c = \\phi(s)$ 的单个闭式解析表达式，该表达式精确到并包括 $O(\\varepsilon)$ 阶项，用 $s$、$\\kappa$、$\\rho$ 和 $\\varepsilon$ 表示。不需要进行数值计算。最终答案中只给出解析表达式，不含额外文本或单位。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **反应机制**：$E + S \\xrightleftharpoons[k_{-1}]{k_{1}} C \\xrightarrow{k_{2}} E + P$\n- **守恒定律**：总酶浓度是守恒的，$E(t) = E_{T} - C(t)$。\n- **有量纲常微分方程(ODE)**：\n$$\n\\frac{dS}{dt} = -k_{1}\\big(E_{T} - C\\big) S + k_{-1} C\n$$\n$$\n\\frac{dC}{dt} = k_{1}\\big(E_{T} - C\\big) S - (k_{-1} + k_{2}) C\n$$\n- **参数定义**：\n  - 米氏常数：$K_{M} \\equiv \\frac{k_{-1} + k_{2}}{k_{1}}$\n- **无量纲变量和参数**：\n  - 底物：$s \\equiv \\frac{S}{S_{0}}$\n  - 复合物：$c \\equiv \\frac{C}{E_{T}}$\n  - 时间：$\\tau \\equiv k_{1} S_{0} t$\n  - 小参数：$\\varepsilon \\equiv \\frac{E_{T}}{S_{0}}$\n  - 无量纲米氏常数：$\\kappa \\equiv \\frac{K_{M}}{S_{0}}$\n  - 无量纲催化速率：$\\rho \\equiv \\frac{k_{2}}{k_{1} S_{0}}$\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础**：该问题描述了米氏-孟顿酶动力学模型，这是生物化学和系统生物学中的一个基本且成熟的原理。奇异摄动分析法是分析此类系统的标准而严谨的数学技术。所有方面在科学上都是合理的。\n- **适定性**：该问题提供了推导慢流形唯一解析表达式所需的所有必要方程、定义和约束。目标陈述清晰。\n- **客观性**：问题以精确的数学语言陈述，没有歧义、主观性或观点。\n- **完备性与一致性**：方程组是自洽的。无量纲变量和参数的定义是明确且一致的。\n- **现实性**：该模型是酶动力学的标准表示。极限 $\\varepsilon \\to 0^{+}$ 对应于底物比酶丰富得多的常见生理条件。\n- **非平凡性**：推导过程需要进行无量纲化，并对奇异摄动理论中的流形不变性原理进行非平凡的应用以获得一阶修正项，这绕过了更简单但不够严谨的准稳态假设。\n\n### 第 3 步：结论与行动\n问题在科学上有效，数学上适定，且内部一致。将提供解答。\n\n### 解答推导\n\n解答按要求分三部分进行：（1）推导无量纲动力学系统，（2）计算慢流形至 $O(\\varepsilon)$ 阶，以及（3）物理解释。\n\n**1. 无量纲系统的推导**\n\n我们首先用无量纲变量表示有量纲变量及其时间导数。\n给定 $s = S/S_{0}$，$c = C/E_{T}$，我们有 $S = S_{0}s$ 和 $C = E_{T}c$。\n时间的无量纲化为 $\\tau = k_{1}S_{0}t$，这意味着 $t = \\tau/(k_{1}S_{0})$。根据时间导数的链式法则，可得：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau} = (k_{1}S_{0}) \\frac{d}{d\\tau}\n$$\n我们将此变换应用于给定的两个常微分方程。\n\n对于底物浓度 $S(t)$：\n导数变换为 $\\frac{dS}{dt} = \\frac{d(S_{0}s)}{dt} = S_{0}\\frac{ds}{dt} = S_{0}(k_{1}S_{0})\\frac{ds}{d\\tau} = k_{1}S_{0}^{2}\\frac{ds}{d\\tau}$。\n代入 $S$ 的常微分方程：\n$$\nk_{1}S_{0}^{2}\\frac{ds}{d\\tau} = -k_{1}(E_{T} - E_{T}c)(S_{0}s) + k_{-1}(E_{T}c)\n$$\n两边除以 $k_{1}S_{0}^{2}$：\n$$\n\\frac{ds}{d\\tau} = -\\frac{E_{T}}{S_{0}}(1-c)s + \\frac{k_{-1}E_{T}}{k_{1}S_{0}^{2}}c\n$$\n使用定义 $\\varepsilon = E_{T}/S_{0}$ 并用给定的无量纲参数表示 $k_{-1}$：\n$K_{M} = \\frac{k_{-1}+k_2}{k_1} \\implies k_{-1} = k_1 K_M - k_2$。\n$\\frac{k_{-1}}{k_{1}S_{0}} = \\frac{K_{M}}{S_{0}} - \\frac{k_{2}}{k_{1}S_{0}} = \\kappa - \\rho$。\n将这些代入 $s$ 的方程：\n$$\n\\frac{ds}{d\\tau} = -\\varepsilon(1-c)s + \\varepsilon(\\kappa - \\rho)c = -\\varepsilon[s(1-c) - (\\kappa-\\rho)c]\n$$\n\n对于酶-底物复合物浓度 $C(t)$：\n导数变换为 $\\frac{dC}{dt} = \\frac{d(E_{T}c)}{dt} = E_{T}\\frac{dc}{dt} = E_{T}(k_{1}S_{0})\\frac{dc}{d\\tau}$。\n代入 $C$ 的常微分方程：\n$$\nk_{1}S_{0}E_{T}\\frac{dc}{d\\tau} = k_{1}(E_{T} - E_{T}c)(S_{0}s) - (k_{-1} + k_{2})(E_{T}c)\n$$\n使用定义 $K_M = (k_{-1}+k_2)/k_1$：\n$$\nk_{1}S_{0}E_{T}\\frac{dc}{d\\tau} = k_{1}E_{T}S_{0}(1-c)s - k_{1}K_{M}E_{T}c\n$$\n两边除以 $k_{1}S_{0}E_{T}$：\n$$\n\\frac{dc}{d\\tau} = (1-c)s - \\frac{K_{M}}{S_{0}}c\n$$\n使用定义 $\\kappa = K_{M}/S_{0}$：\n$$\n\\frac{dc}{d\\tau} = s(1-c) - \\kappa c = s - (s+\\kappa)c\n$$\n\n最终得到的以变量 $(s,c)$ 和时间 $\\tau$ 表示的无量纲动力学系统是：\n$$\n\\frac{ds}{d\\tau} = -\\varepsilon [s(1-c) - (\\kappa - \\rho)c]\n$$\n$$\n\\frac{dc}{d\\tau} = s - (s+\\kappa)c\n$$\n\n**2. 奇异摄动分析与慢流形计算**\n\n该系统揭示了时间尺度的分离。$s$ 的变化率 $\\frac{ds}{d\\tau}$ 是 $O(\\varepsilon)$ 阶，而 $c$ 的变化率 $\\frac{dc}{d\\tau}$ 是 $O(1)$ 阶。因此，$s$ 是慢变量，$c$ 是快变量。时间变量 $\\tau$ 代表快时间尺度。慢动力学发生在时间尺度 $\\sigma = \\varepsilon\\tau$ 上。我们寻求一个慢流形，即一个不变关系 $c = \\phi(s)$，系统轨迹会快速收敛到该流形上。\n\n**领先阶流形 ($O(1)$)**\n当 $\\frac{dc}{d\\tau} \\approx 0$ 时，快动力学达到弛豫。将 $\\frac{dc}{d\\tau}$ 的方程设为零，可得到慢流形的领先阶近似，也称为临界流形或准稳态近似。\n$$\n0 = s - (s+\\kappa)c\n$$\n解出 $c$ 可得领先阶流形 $\\phi_0(s)$：\n$$\n\\phi_0(s) = \\frac{s}{s+\\kappa}\n$$\n\n**一阶修正 ($O(\\varepsilon)$)**\n为了找到 $\\varepsilon$ 阶的修正项，我们假设慢流形有一个渐近展开式：\n$$\nc = \\phi(s) = \\phi_0(s) + \\varepsilon \\phi_1(s) + O(\\varepsilon^2)\n$$\n我们施加流形不变性条件，即从流形上开始的轨迹将保持在流形上。这可以表示为 $\\frac{dc}{d\\tau} = \\frac{d\\phi}{ds}\\frac{ds}{d\\tau}$。\n将系统方程代入不变性条件：\n$$\ns - (s+\\kappa)c = \\left(\\frac{d\\phi}{ds}\\right) \\left(-\\varepsilon [s(1-c) - (\\kappa - \\rho)c]\\right)\n$$\n现在，将展开式 $c = \\phi_0 + \\varepsilon\\phi_1$ 代入此方程。\n左手边 (LHS)：\n$$\n\\text{LHS} = s - (s+\\kappa)(\\phi_0 + \\varepsilon\\phi_1) = [s - (s+\\kappa)\\phi_0] - \\varepsilon(s+\\kappa)\\phi_1\n$$\n根据 $\\phi_0$ 的定义，方括号中的项为零。因此，\n$$\n\\text{LHS} = -\\varepsilon(s+\\kappa)\\phi_1\n$$\n右手边 (RHS)：\n$$\n\\text{RHS} = -\\varepsilon \\left(\\frac{d}{ds}(\\phi_0 + \\varepsilon\\phi_1)\\right) \\left(s(1 - (\\phi_0+\\varepsilon\\phi_1)) - (\\kappa-\\rho)(\\phi_0+\\varepsilon\\phi_1)\\right)\n$$\n我们只需要将其展开到 $O(\\varepsilon)$ 阶。\n$$\n\\text{RHS} = -\\varepsilon \\left(\\frac{d\\phi_0}{ds} + O(\\varepsilon)\\right) \\left(s(1 - \\phi_0) - (\\kappa-\\rho)\\phi_0 + O(\\varepsilon)\\right)\n$$\n$$\n\\text{RHS} = -\\varepsilon \\left(\\frac{d\\phi_0}{ds}\\right) [s - (s+\\kappa-\\rho)\\phi_0] + O(\\varepsilon^2)\n$$\n现在我们计算 RHS 表达式中的各项。\n$\\phi_0$ 的导数：$\\frac{d\\phi_0}{ds} = \\frac{d}{ds}\\left(\\frac{s}{s+\\kappa}\\right) = \\frac{(1)(s+\\kappa) - s(1)}{(s+\\kappa)^2} = \\frac{\\kappa}{(s+\\kappa)^2}$。\n方括号中的项：\n$$\ns - (s+\\kappa-\\rho)\\phi_0 = s - (s+\\kappa-\\rho)\\frac{s}{s+\\kappa} = s\\left(1 - \\frac{s+\\kappa-\\rho}{s+\\kappa}\\right) = s\\left(\\frac{s+\\kappa-(s+\\kappa-\\rho)}{s+\\kappa}\\right) = \\frac{\\rho s}{s+\\kappa}\n$$\n将这些代回 RHS：\n$$\n\\text{RHS} = -\\varepsilon \\left(\\frac{\\kappa}{(s+\\kappa)^2}\\right) \\left(\\frac{\\rho s}{s+\\kappa}\\right) + O(\\varepsilon^2) = -\\varepsilon \\frac{\\kappa \\rho s}{(s+\\kappa)^3} + O(\\varepsilon^2)\n$$\n令 LHS 和 RHS 的 $O(\\varepsilon)$ 阶项相等：\n$$\n-\\varepsilon(s+\\kappa)\\phi_1 = -\\varepsilon \\frac{\\kappa \\rho s}{(s+\\kappa)^3}\n$$\n解出 $\\phi_1(s)$：\n$$\n\\phi_1(s) = \\frac{\\kappa \\rho s}{(s+\\kappa)^4}\n$$\n结合结果，精确到 $O(\\varepsilon)$ 阶的慢流形为：\n$$\nc = \\phi(s) = \\phi_0(s) + \\varepsilon \\phi_1(s) = \\frac{s}{s+\\kappa} + \\varepsilon \\frac{\\kappa \\rho s}{(s+\\kappa)^4}\n$$\n\n**3. 物理解释**\n\n- **$\\varepsilon$ 的含义与时间尺度分离**：参数 $\\varepsilon = E_T/S_0$ 是总酶浓度与特征底物浓度之比。奇异摄动分析的条件 $\\varepsilon \\to 0^{+}$ 对应于生物学中常见的酶比其底物稀少得多的情况。这种浓度上的差异导致了时间尺度的分离。酶-底物复合物浓度 $c$ 的动力学在快时间尺度（量级为 $1/k_1S_0$）上演化，相对于底物水平迅速达到准平衡。底物浓度 $s$ 在慢时间尺度（量级为 $1/(k_1E_T)$）上演化，其消耗由已平衡的复合物生成产物的速率决定。快慢时间尺度之比为 $O(\\varepsilon)$。\n\n- **酶饱和与底物消耗**：无量纲复合物浓度 $c = C/E_T$ 代表与底物结合的总酶的比例。领先阶解 $c \\approx \\phi_0(s) = s/(s+\\kappa)$ 表明 $c$ 可以是 $O(1)$ 阶。例如，如果底物浓度相对于米氏常数很高（$s \\gg \\kappa$），那么 $c \\approx 1$，表示酶几乎完全饱和（$C \\approx E_T$）。尽管饱和度很高，在快时间尺度 $\\tau$ 上，底物的变化率 $\\frac{ds}{d\\tau} = O(\\varepsilon)$ 仍然很小。这是因为在任何给定时刻被处理的底物总量受限于总量很小的酶 $E_T$。只有在长的慢时间尺度 $\\sigma = \\varepsilon\\tau$ 上，底物消耗才变得显著，如将慢流形代入 $s$ 的方程所描述的：\n$$\n\\frac{ds}{d\\sigma} = \\frac{1}{\\varepsilon}\\frac{ds}{d\\tau} \\approx -[s(1-\\phi_0) - (\\kappa-\\rho)\\phi_0] = -\\frac{\\rho s}{s+\\kappa}\n$$\n这证实了虽然酶饱和度（$c$）可以是 $O(1)$，但底物消耗在快时间尺度上是一个 $O(\\varepsilon)$ 效应，从而证明了奇异摄动方法的合理性。",
            "answer": "$$\n\\boxed{\\frac{s}{s+\\kappa} + \\varepsilon \\frac{\\kappa \\rho s}{(s+\\kappa)^4}}\n$$"
        },
        {
            "introduction": "无量纲化的威力远不止于分析单个酶，它同样适用于复杂的生物网络。本练习 () 将这些技术应用于合成生物学的一个基石模型：基因拨动开关。你将首先通过识别控制其行为的关键无量纲参数来降低系统复杂性，然后利用计算工具探索这些参数如何产生双稳态——这是生物回路中一个经典的涌现特性。",
            "id": "3302286",
            "problem": "考虑一个具有相互抑制作用的双基因触发开关，其中基因$X$产生蛋白质$x(t)$，基因$Y$产生蛋白质$y(t)$。每种蛋白质的产生都通过希尔抑制函数被另一种蛋白质抑制，而降解为一阶过程。设物理参数为：最大产生速率$\\alpha_x$和$\\alpha_y$（单位为$\\mu\\mathrm{M}/\\mathrm{min}$），解离常数$K_x$和$K_y$（单位为$\\mu\\mathrm{M}$），降解速率常数$\\gamma_x$和$\\gamma_y$（单位为$\\mathrm{min}^{-1}$），以及希尔指数$m$和$n$（无量纲）。其动力学由以下耦合常微分方程(ODE)建模：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^n} - \\gamma_x x, \\quad \n\\frac{dy}{dt} = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^m} - \\gamma_y y.\n$$\n您的任务是：\n- 从上述有量纲模型出发，仅使用希尔抑制函数和一阶降解的定义，通过定义无量纲浓度$\\bar{x} = x/K_x$和$\\bar{y} = y/K_y$以及无量纲时间$\\tau = \\gamma_x t$来进行无量纲化。推导无量纲ODE，并明确指出控制稳态及其稳定性的最小无量纲参数组。避免使用任何未从这些定义中推导出的快捷公式。\n- 实现一个算法，通过以下步骤确定给定物理参数集下的线性稳定稳态数量：(i) 根据物理参数计算无量纲参数组，(ii) 找到无量纲系统的所有非负稳态，以及 (iii) 通过计算每个稳态处的雅可比矩阵特征值来评估线性稳定性。两个特征值的实部均为负则表示线性稳定。将每个测试用例的线性稳定稳态数量表示为一个整数。\n- 单位：给定的物理参数必须按其所述单位处理。最终输出是无单位的整数，无需单位转换。本任务不涉及角度或百分比。\n- 测试套件：使用以下五个测试用例，每个用例以$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n)$的形式提供，其中$\\alpha_x$和$\\alpha_y$的单位为$\\mu\\mathrm{M}/\\mathrm{min}$，$K_x$和$K_y$的单位为$\\mu\\mathrm{M}$，$\\gamma_x$和$\\gamma_y$的单位为$\\mathrm{min}^{-1}$，$m$和$n$无量纲：\n  1. 用例A（对称、协同、高产生率）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$10$$,$$10$$,$$1$$,$$1$$,$$1$$,$$1$$,$$2$$,$$2$$)$。\n  2. 用例B（对称、协同、低产生率）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$0.5$$,$$0.5$$,$$1$$,$$1$$,$$1$$,$$1$$,$$2$$,$$2$$)$。\n  3. 用例C（不对称产生、协同）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$10$$,$$1$$,$$1$$,$$1$$,$$1$$,$$1$$,$$2$$,$$2$$)$。\n  4. 用例D（对称、非协同、高产生率）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$10$$,$$10$$,$$1$$,$$1$$,$$1$$,$$1$$,$$1$$,$$1$$)$。\n  5. 用例E（不等降解率、协同、高产生率）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$8$$,$$8$$,$$1$$,$$1$$,$$1$$,$$0.5$$,$$2$$,$$2$$)$。\n- 最终输出格式：您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,result_3,result_4,result_5]$），其中$result_i$是按上述顺序列出的第$i$个测试用例的线性稳定稳态的整数计数。",
            "solution": "我们从由希尔抑制用于产生和一阶降解用于消耗所控制的有量纲模型开始。有量纲的常微分方程(ODE)是\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^n} - \\gamma_x x, \\quad \n\\frac{dy}{dt} = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^m} - \\gamma_y y,\n$$\n其中$\\alpha_x$和$\\alpha_y$是最大产生速率（单位$\\mu\\mathrm{M}/\\mathrm{min}$），$K_x$和$K_y$是解离常数（单位$\\mu\\mathrm{M}$），$\\gamma_x$和$\\gamma_y$是降解速率常数（单位$\\mathrm{min}^{-1}$），$m$和$n$是希尔指数。\n\n我们使用无量纲浓度$\\bar{x} = x/K_x$和$\\bar{y} = y/K_y$以及无量纲时间$\\tau = \\gamma_x t$来进行无量纲化。利用链式法则$d\\bar{x}/d\\tau = (1/\\gamma_x)(1/K_x) dx/dt$以及类似的$\\bar{y}$表达式，我们将$x = K_x \\bar{x}$和$y = K_y \\bar{y}$代入，得到\n$$\n\\frac{d\\bar{x}}{d\\tau} = \\frac{1}{\\gamma_x K_x}\\frac{\\alpha_x}{1 + \\left(\\frac{K_y \\bar{y}}{K_y}\\right)^n} - \\frac{1}{\\gamma_x}\\gamma_x \\bar{x}\n= \\frac{\\alpha_x}{\\gamma_x K_x}\\frac{1}{1 + \\bar{y}^n} - \\bar{x},\n$$\n以及\n$$\n\\frac{d\\bar{y}}{d\\tau} = \\frac{1}{\\gamma_x K_y}\\frac{\\alpha_y}{1 + \\left(\\frac{K_x \\bar{x}}{K_x}\\right)^m} - \\frac{\\gamma_y}{\\gamma_x}\\bar{y}\n= \\frac{\\alpha_y}{\\gamma_x K_y}\\frac{1}{1 + \\bar{x}^m} - \\Delta \\bar{y},\n$$\n在此我们引入了无量纲降解比$\\Delta = \\gamma_y/\\gamma_x$。定义无量纲产生强度\n$$\nA_1 = \\frac{\\alpha_x}{\\gamma_x K_x},\\quad A_2 = \\frac{\\alpha_y}{\\gamma_x K_y},\n$$\n因此无量纲ODE变为\n$$\n\\frac{d\\bar{x}}{d\\tau} = \\frac{A_1}{1 + \\bar{y}^n} - \\bar{x}, \\quad\n\\frac{d\\bar{y}}{d\\tau} = \\frac{A_2}{1 + \\bar{x}^m} - \\Delta \\bar{y}.\n$$\n控制动力学的最小无量纲参数组是$(A_1, A_2, \\Delta, m, n)$。直观地看，$A_1$和$A_2$比较了最大产生速率与经降解缩放的解离常数，$m$和$n$指定了抑制的协同性（非线性），而$\\Delta$量化了相对降解速度。\n\n稳态$(\\bar{x}^*, \\bar{y}^*)$满足代数方程\n$$\n\\bar{x}^* = \\frac{A_1}{1 + (\\bar{y}^*)^n}, \\quad\n\\bar{y}^* = \\frac{A_2}{\\Delta(1 + (\\bar{x}^*)^m)}.\n$$\n为了确定线性稳定性，我们在一个稳态处对系统进行线性化，并检查右侧矢量场的雅可比矩阵。定义矢量场\n$$\nf_1(\\bar{x},\\bar{y}) = \\frac{A_1}{1 + \\bar{y}^n} - \\bar{x},\\quad\nf_2(\\bar{x},\\bar{y}) = \\frac{A_2}{1 + \\bar{x}^m} - \\Delta \\bar{y}.\n$$\n雅可比矩阵$J$是\n$$\nJ(\\bar{x},\\bar{y}) =\n\\begin{bmatrix}\n\\frac{\\partial f_1}{\\partial \\bar{x}} & \\frac{\\partial f_1}{\\partial \\bar{y}}\\\\\n\\frac{\\partial f_2}{\\partial \\bar{x}} & \\frac{\\partial f_2}{\\partial \\bar{y}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-1 & -\\frac{A_1 n \\bar{y}^{n-1}}{(1+\\bar{y}^n)^2}\\\\\n-\\frac{A_2 m \\bar{x}^{m-1}}{(1+\\bar{x}^m)^2} & -\\Delta\n\\end{bmatrix}.\n$$\n如果$J$的两个特征值的实部都为负，则该稳态是线性稳定的。对于这个二维系统，这等价于迹为负且行列式为正；然而，为了稳健性，我们将通过数值方法计算特征值。\n\n每个物理参数集的算法步骤：\n1. 从$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n)$通过$A_1 = \\alpha_x/(\\gamma_x K_x)$、$A_2 = \\alpha_y/(\\gamma_x K_y)$和$\\Delta = \\gamma_y/\\gamma_x$计算无量纲参数组$A_1$、$A_2$、$\\Delta$、$m$、$n$。\n2. 通过求解$f_1(\\bar{x},\\bar{y})=0$、$f_2(\\bar{x},\\bar{y})=0$来找到所有非负稳态。求解时，在一个由零斜线边界$\\bar{x} \\le A_1$、$\\bar{y} \\le A_2/\\Delta$（当分母项$1+\\bar{y}^n$和$1+\\bar{x}^m$最小时达到的最大值）确定的有界域内的网格上使用多个初始猜测值。\n3. 使用一个小的容差对数值解进行聚类以去除重复项，并舍弃具有负分量的非物理性解。\n4. 对于每个稳态，评估$J$并计算其特征值。如果两个特征值的实部均为负（在小的数值容差内），则将该稳态计为线性稳定。\n5. 报告每个测试用例的线性稳定稳态的整数计数。\n\n无量纲参数和双稳态的解释：\n- 较大的$A_1$和$A_2$增强了每个基因在抑制下维持表达的能力，使零斜线延伸到更大的值，并增加了多重交点（导致两个稳定不动点和一个不稳定不动点）的可能性。\n- 希尔指数$m>1$和$n>1$引入了S形抑制曲线，这对于产生多重交点至关重要；$m=n=1$通常导致单稳态。\n- 降解比$\\Delta$扭曲了相对响应时间和稳态水平；$\\Delta$偏离1会使零斜线变形，根据与$A_1$和$A_2$的平衡，既可能促进也可能抑制双稳态。\n\n测试套件涵盖：一个对称、协同、高产生率的用例（预期为双稳态）；一个对称、协同、低产生率的用例（预期为单稳态）；一个不对称产生率的用例；一个非协同的用例；以及一个降解率不等的用例。程序将为每个用例计算线性稳定稳态的数量。最终输出必须是格式为$[r_1,r_2,r_3,r_4,r_5]$的单行，其中$r_i$是整数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef dimensionless_params(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n):\n    \"\"\"\n    Compute dimensionless parameters:\n    A1 = alpha_x / (gamma_x * Kx)\n    A2 = alpha_y / (gamma_x * Ky)\n    Delta = gamma_y / gamma_x\n    m, n as given (dimensionless).\n    \"\"\"\n    A1 = alpha_x / (gamma_x * Kx)\n    A2 = alpha_y / (gamma_x * Ky)\n    Delta = gamma_y / gamma_x\n    return A1, A2, Delta, float(m), float(n)\n\ndef steady_states(A1, A2, Delta, m, n, grid_points=11, tol=1e-8, cluster_tol=1e-6, max_iter=200):\n    \"\"\"\n    Find steady states by solving:\n    f1(u, v) = A1/(1 + v^n) - u = 0\n    f2(u, v) = A2/(1 + u^m) - Delta*v = 0\n    Use multiple initial guesses over a grid within bounds:\n    0 = u = A1, 0 = v = A2/Delta (if Delta>0).\n    Cluster solutions to remove duplicates.\n    \"\"\"\n    # Bounds for u and v based on nullcline maxima\n    u_max = max(A1, 1.0)\n    v_max = max(A2 / Delta if Delta > 0 else A2, 1.0)\n    # Construct initial guess grid\n    u_guesses = np.linspace(0.0, u_max, grid_points)\n    v_guesses = np.linspace(0.0, v_max, grid_points)\n\n    def F(z):\n        u, v = z\n        # Guard against negative and large powers causing issues\n        # Allow evaluation for u,v >= 0\n        # Compute f1 and f2\n        denom_v = 1.0 + (v**n if v >= 0 else np.abs(v)**n)\n        denom_u = 1.0 + (u**m if u >= 0 else np.abs(u)**m)\n        f1 = A1 / denom_v - u\n        f2 = A2 / denom_u - Delta * v\n        return np.array([f1, f2])\n\n    solutions = []\n    for ug in u_guesses:\n        for vg in v_guesses:\n            sol = root(F, np.array([ug, vg]), method='hybr')\n            if sol.success:\n                u_sol, v_sol = sol.x\n                # Only accept nonnegative solutions within bounds (with tolerance)\n                if u_sol >= -1e-8 and v_sol >= -1e-8:\n                    # Clip tiny negatives to zero\n                    u_sol = max(u_sol, 0.0)\n                    v_sol = max(v_sol, 0.0)\n                    # Basic bound check (allow slight overshoot due to numerics)\n                    if u_sol = u_max + 1e-3 and v_sol = v_max + 1e-3:\n                        # Cluster: check if close to an existing solution\n                        is_new = True\n                        for (uu, vv) in solutions:\n                            if np.hypot(uu - u_sol, vv - v_sol)  cluster_tol:\n                                is_new = False\n                                break\n                        if is_new:\n                            solutions.append((u_sol, v_sol))\n    return solutions\n\ndef jacobian(A1, A2, Delta, m, n, u, v):\n    \"\"\"\n    Analytical Jacobian of the vector field at (u, v):\n    df1/du = -1\n    df1/dv = -A1 * n * v^(n-1) / (1 + v^n)^2\n    df2/du = -A2 * m * u^(m-1) / (1 + u^m)^2\n    df2/dv = -Delta\n    \"\"\"\n    # Handle v=0 with n>1: v^(n-1) is 0 if n>1; if n=1, v^(n-1)=v^0=1.\n    # Similarly for u.\n    denom_v = (1.0 + v**n)**2\n    denom_u = (1.0 + u**m)**2\n    # For zero values and fractional powers, guard using np.power\n    # Here m,n are integers in test suite, but treat generally.\n    dv_term_num = 0.0\n    du_term_num = 0.0\n    # Compute v^(n-1) and u^(m-1) robustly\n    if v == 0.0 and n > 1:\n        v_pow = 0.0\n    else:\n        v_pow = v**(n - 1)\n    if u == 0.0 and m > 1:\n        u_pow = 0.0\n    else:\n        u_pow = u**(m - 1)\n    df1_du = -1.0\n    df1_dv = -A1 * n * v_pow / denom_v\n    df2_du = -A2 * m * u_pow / denom_u\n    df2_dv = -Delta\n    J = np.array([[df1_du, df1_dv],\n                  [df2_du, df2_dv]])\n    return J\n\ndef count_stable_states(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n):\n    \"\"\"\n    Compute dimensionless parameters, find steady states, and count how many are linearly stable.\n    \"\"\"\n    A1, A2, Delta, m_dimless, n_dimless = dimensionless_params(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n)\n    # Find steady states\n    ss = steady_states(A1, A2, Delta, m_dimless, n_dimless, grid_points=13)\n    stable_count = 0\n    for (u, v) in ss:\n        J = jacobian(A1, A2, Delta, m_dimless, n_dimless, u, v)\n        eigvals = np.linalg.eigvals(J)\n        # Consider stability if all eigenvalues have negative real parts\n        if np.max(np.real(eigvals))  -1e-8:\n            stable_count += 1\n    return stable_count\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n)\n    test_cases = [\n        (10.0, 10.0, 1.0, 1.0, 1.0, 1.0, 2, 2),  # Case A\n        (0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 2, 2),    # Case B\n        (10.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2, 2),   # Case C\n        (10.0, 10.0, 1.0, 1.0, 1.0, 1.0, 1, 1),  # Case D\n        (8.0, 8.0, 1.0, 1.0, 1.0, 0.5, 2, 2),    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n = case\n        result = count_stable_states(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n)\n        results.append(int(result))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}