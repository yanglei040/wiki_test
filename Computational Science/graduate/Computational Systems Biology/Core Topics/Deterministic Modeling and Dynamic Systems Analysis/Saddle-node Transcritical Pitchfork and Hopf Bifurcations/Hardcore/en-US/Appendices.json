{
    "hands_on_practices": [
        {
            "introduction": "The saddle-node bifurcation represents a fundamental mechanism for creating bistability and threshold-like \"on/off\" switches in gene regulatory networks. This first practice focuses on the canonical normal form of this bifurcation to build foundational analytical skills. By deriving the relaxation rate near the stable equilibrium , you will connect the abstract concept of an eigenvalue to the physical phenomenon of critical slowing down, a key experimental signature of systems approaching a tipping point.",
            "id": "3347415",
            "problem": "In a simplified model of a bistable regulatory module in computational systems biology, the activation state variable $x$ evolves according to the ordinary differential equation (ODE) $\\dot{x} = \\mu + x^{2}$, where the control parameter $\\mu$ is a nondimensional measure of net activation bias induced by upstream signals after appropriate rescaling. A bifurcation occurs at the threshold where equilibria are created or annihilated. For $\\mu < 0$, two equilibria exist and one is stable, consistent with saddle-node bifurcation phenomenology. Starting from the foundational definition of an equilibrium for an ODE and the conceptual basis that small perturbations about a stable equilibrium obey a linearized dynamics that relaxes exponentially, determine the analytic expression for the magnitude of the relaxation rate $|\\lambda(\\mu)|$ near the stable equilibrium for $\\mu < 0$. Express your final answer as a function of $\\mu$ and do not round; no physical units are required. Additionally, use your derived expression to explain, in words within your solution, how critical slowing down manifests as $\\mu \\uparrow 0^{-}$.",
            "solution": "The problem presents a one-dimensional ordinary differential equation (ODE) governing the evolution of a state variable $x$:\n$$\n\\dot{x} = \\mu + x^{2}\n$$\nHere, $\\dot{x}$ represents the time derivative $\\frac{dx}{dt}$, and $\\mu$ is a control parameter. This equation is the normal form for a saddle-node bifurcation. The problem asks for the analytic expression for the magnitude of the relaxation rate, $|\\lambda(\\mu)|$, for the stable equilibrium that exists when $\\mu < 0$.\n\nFirst, we identify the equilibria (or fixed points) of the system, which are the values of $x$ for which the system's state does not change over time. These points, denoted by $x^*$, are found by setting $\\dot{x} = 0$.\n$$\n\\mu + (x^*)^{2} = 0\n$$\nSolving for $x^*$ gives:\n$$\n(x^*)^{2} = -\\mu\n$$\nReal-valued equilibria exist only if $-\\mu \\geq 0$, or equivalently, $\\mu \\leq 0$. For the specific case given in the problem, $\\mu < 0$, we have two distinct equilibria:\n$$\nx^* = \\pm\\sqrt{-\\mu}\n$$\nLet us denote these two equilibria as $x^*_1 = \\sqrt{-\\mu}$ and $x^*_2 = -\\sqrt{-\\mu}$.\n\nNext, we determine the stability of each equilibrium by linearizing the system around them. The stability of a one-dimensional system is determined by the sign of the first derivative of the right-hand side of the ODE, evaluated at the equilibrium. Let $f(x) = \\mu + x^2$. The derivative is:\n$$\nf'(x) = \\frac{df}{dx} = 2x\n$$\nThe value of this derivative at an equilibrium $x^*$ is the eigenvalue, $\\lambda$, of the linearized system. The dynamics of a small perturbation $\\delta x$ from the equilibrium $x^*$ are governed by $\\dot{\\delta x} \\approx \\lambda \\delta x$. If $\\lambda < 0$, the perturbation decays, and the equilibrium is stable. If $\\lambda > 0$, the perturbation grows, and the equilibrium is unstable.\n\nLet's evaluate $\\lambda$ for each of our two equilibria:\n1.  For the equilibrium $x^*_1 = \\sqrt{-\\mu}$:\n    The corresponding eigenvalue is $\\lambda_1 = f'(x^*_1) = 2(\\sqrt{-\\mu})$. Since $\\mu < 0$, $-\\mu$ is a positive quantity, and its square root is a positive real number. Thus, $\\lambda_1 = 2\\sqrt{-\\mu} > 0$. This equilibrium is unstable.\n\n2.  For the equilibrium $x^*_2 = -\\sqrt{-\\mu}$:\n    The corresponding eigenvalue is $\\lambda_2 = f'(x^*_2) = 2(-\\sqrt{-\\mu}) = -2\\sqrt{-\\mu}$. Since $\\sqrt{-\\mu}$ is a positive real number, $\\lambda_2 < 0$. This equilibrium is stable, as stated in the problem.\n\nThe problem defines the relaxation rate based on the exponential decay of small perturbations around the stable equilibrium. The solution to the linearized equation $\\dot{\\delta x} = \\lambda_2 \\delta x$ is $\\delta x(t) = \\delta x(0)\\exp(\\lambda_2 t)$. The rate of this exponential relaxation is determined by the eigenvalue $\\lambda_2$. The magnitude of this rate, $|\\lambda_2|$, is what the problem asks for.\n\nThe relaxation rate for the stable equilibrium is $\\lambda(\\mu) = \\lambda_2 = -2\\sqrt{-\\mu}$. The magnitude of this relaxation rate is:\n$$\n|\\lambda(\\mu)| = |-2\\sqrt{-\\mu}|\n$$\nSince $\\mu < 0$, the term $\\sqrt{-\\mu}$ is real and positive. Therefore, the magnitude is:\n$$\n|\\lambda(\\mu)| = 2\\sqrt{-\\mu}\n$$\nThis is the required analytic expression for the magnitude of the relaxation rate near the stable equilibrium for $\\mu < 0$.\n\nThe problem also requires an explanation of how critical slowing down manifests as $\\mu \\uparrow 0^{-}$ (i.e., as $\\mu$ approaches $0$ from the negative side). Critical slowing down is the phenomenon where the time it takes for a system to return to a stable equilibrium following a perturbation diverges as a control parameter approaches a bifurcation point. In this system, the bifurcation point is at $\\mu = 0$.\n\nThe characteristic relaxation time, $\\tau$, is the time scale over which a perturbation decays. It is inversely related to the magnitude of the relaxation rate:\n$$\n\\tau = \\frac{1}{|\\lambda(\\mu)|} = \\frac{1}{2\\sqrt{-\\mu}}\n$$\nAs the parameter $\\mu$ approaches the bifurcation point at $\\mu = 0$ from below ($\\mu \\uparrow 0^{-}$), the value of $-\\mu$ approaches $0$. Consequently, the magnitude of the relaxation rate, $|\\lambda(\\mu)| = 2\\sqrt{-\\mu}$, also approaches $0$. This means that the \"restoring force\" that pulls the system back to its stable state becomes progressively weaker. The relaxation time $\\tau = \\frac{1}{2\\sqrt{-\\mu}}$ therefore tends to infinity. This divergence of the relaxation time as the system nears the critical point $\\mu = 0$ is the hallmark of critical slowing down. The system takes an increasingly long time to recover from even infinitesimal disturbances, \"slowing down\" its return to equilibrium.",
            "answer": "$$\n\\boxed{2\\sqrt{-\\mu}}\n$$"
        },
        {
            "introduction": "While static analysis provides crucial insights, biological parameters are rarely constant. This computational exercise  extends our study of the saddle-node bifurcation to the dynamic realm by simulating the system's response to a time-varying input. You will implement a numerical solver to quantify the resulting 'bifurcation delay,' gaining hands-on experience with the phenomenon of dynamic hysteresis and its scaling properties, a concept vital for interpreting time-series data from biological experiments.",
            "id": "3347406",
            "problem": "Consider the canonical one-dimensional normal form for a saddle-node bifurcation used to model threshold gene induction under a time-varying input, given by the ordinary differential equation $\\dot{x} = \\mu(t) + x^2$ with a linear ramp $\\mu(t) = \\nu t$, where $\\nu > 0$ is the sweep rate. For $t < 0$, there exists a stable equilibrium branch $x(t) = -\\sqrt{-\\mu(t)}$, which disappears at $t = 0$. When the system is swept through the bifurcation point, dynamic hysteresis (bifurcation delay) can cause a finite lag before the system escapes to large positive values of $x$.\n\nStarting from the foundational base of ordinary differential equations, stability of equilibria, and the concept of time-dependent parameter sweeps in dynamical systems, implement a numerical procedure to quantify the dynamic bifurcation delay and its scaling with the sweep rate $\\nu$ for gene induction modeled by $\\dot{x} = \\nu t + x^2$. Proceed under the following requirements:\n\n- Use dimensionless variables throughout; no physical units are required.\n- Initialize the system at time $t_0 = s_0 \\nu^{-1/3}$ with $s_0 = -8$ on the instantaneous stable branch $x(t_0) = -\\sqrt{-\\mu(t_0)} = -\\sqrt{-\\nu t_0}$.\n- Integrate forward in time up to $t_{\\max} = s_{\\max} \\nu^{-1/3}$ with $s_{\\max} = 20$.\n- Define the escape time $t_{\\mathrm{esc}}$ as the first time $t \\ge 0$ at which $x(t)$ reaches the induction threshold $x_{\\mathrm{th}} = 5$ from below. The dynamic lag in the control parameter is $\\mu_{\\mathrm{esc}} = \\nu t_{\\mathrm{esc}}$.\n- For each test case, compute the normalized lag ratio $r = \\mu_{\\mathrm{esc}} / \\nu^{2/3}$.\n\nYour program must numerically integrate the ordinary differential equation using a robust method with event detection to find $t_{\\mathrm{esc}}$. The final output should be the list of ratios $r$ for the provided test suite, each rounded to six decimal places.\n\nTest Suite:\n- Case 1: $\\nu = 1.0$.\n- Case 2: $\\nu = 0.3$.\n- Case 3: $\\nu = 0.1$.\n- Case 4: $\\nu = 0.01$.\n- Case 5: $\\nu = 0.001$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4,r_5]$). Each $r_i$ must be a floating-point number rounded to six decimal places. If the escape threshold is not reached within the integration window for any case, return the string literal `nan` for that case in place of a numeric value.",
            "solution": "The problem requires the numerical computation of a normalized dynamic lag for a system described by the canonical normal form of a saddle-node bifurcation with a time-varying control parameter. The analysis will proceed by directly solving the provided ordinary differential equation (ODE) using a robust numerical integrator with event detection capabilities.\n\nThe governing equation for the system's state variable $x$ is a non-autonomous first-order ODE:\n$$\n\\frac{dx}{dt} = \\nu t + x^2\n$$\nwhere $\\nu > 0$ is the sweep rate of the control parameter $\\mu(t) = \\nu t$.\n\nThe problem specifies a set of initial conditions, an integration window, and a condition for \"escape,\" all of which scale with the sweep rate $\\nu$. These are defined as follows:\n\n1.  **Initial time $t_0$**: The integration starts at $t_0 = s_0 \\nu^{-1/3}$, with a given dimensionless constant $s_0 = -8$.\n2.  **Initial state $x(t_0)$**: The system is initialized on the quasi-static stable equilibrium branch. For $t < 0$, the instantaneous equilibria are $x_{eq}(t) = \\pm\\sqrt{-\\mu(t)} = \\pm\\sqrt{-\\nu t}$. The stable branch is $x_{stable}(t) = -\\sqrt{-\\nu t}$. Therefore, the initial state is $x(t_0) = -\\sqrt{-\\nu t_0}$. Substituting the expression for $t_0$, we get $x(t_0) = -\\sqrt{-\\nu (-8 \\nu^{-1/3})} = -\\sqrt{8 \\nu^{2/3}}$.\n3.  **Final time $t_{\\max}$**: The integration proceeds up to a maximum time of $t_{\\max} = s_{\\max} \\nu^{-1/3}$, with $s_{\\max} = 20$.\n4.  **Escape Condition**: The escape time, $t_{\\mathrm{esc}}$, is defined as the first time $t \\ge 0$ at which the state variable $x(t)$ reaches an induction threshold $x_{\\mathrm{th}} = 5$.\n\nThe objective is to compute the normalized lag ratio, $r$, for several values of $\\nu$. This ratio is defined as:\n$$\nr = \\frac{\\mu_{\\mathrm{esc}}}{\\nu^{2/3}}\n$$\nwhere $\\mu_{\\mathrm{esc}} = \\nu t_{\\mathrm{esc}}$ is the value of the control parameter at the moment of escape. Combining these definitions, the target quantity is:\n$$\nr = \\frac{\\nu t_{\\mathrm{esc}}}{\\nu^{2/3}} = \\nu^{1/3} t_{\\mathrm{esc}}\n$$\n\nThe numerical procedure to solve this problem for each given value of $\\nu$ is as follows:\n\n1.  **Set up the Initial Value Problem (IVP)**: For a given $\\nu$, calculate the specific initial time $t_0$, initial state $x_0 = x(t_0)$, and the integration time span $[t_0, t_{\\max}]$.\n2.  **Define the ODE and Event Function**: The ODE function is $f(t, x) = \\nu t + x^2$. The event marking the escape is defined by the condition $x(t) - x_{\\mathrm{th}} = 0$.\n3.  **Numerical Integration with Event Detection**: The `scipy.integrate.solve_ivp` function is ideally suited for this task. It can integrate the ODE from $t_0$ to $t_{\\max}$ while simultaneously finding the roots of a given event function.\n    - We configure the event to be terminal (`terminal=True`), which instructs the solver to stop integration as soon as the event is detected. This improves efficiency.\n    - We specify the direction of the crossing (`direction=1`), ensuring that the event is triggered only when $x(t)$ increases through the threshold $x_{\\mathrm{th}}$, as required by the physics of the problem (escaping from below).\n    - To ensure high accuracy, especially given the scaling analysis, the solver's absolute and relative tolerances (`atol` and `rtol`) are set to a stringent value of $10^{-8}$.\n4.  **Extract and Process Results**: After the integration, we inspect the solver's output.\n    - The `sol.t_events` attribute will contain an array of time points at which the event condition was met.\n    - We must filter these event times to find the first one that satisfies the condition $t \\ge 0$, which gives $t_{\\mathrm{esc}}$.\n    - If one or more such times exist, we take the first one, calculate $r = \\nu^{1/3} t_{\\mathrm{esc}}$, and round it to six decimal places.\n    - If the `sol.t_events` array is empty or contains only negative times, it means the threshold was not reached within the integration window for $t \\ge 0$. In this case, the result is recorded as the string literal `nan`.\n5.  **Iterate and Report**: This process is repeated for each value of $\\nu$ in the provided test suite. The final results are collected into a list and formatted into the required single-line string output.\n\nThis methodology provides a direct and robust numerical solution that faithfully implements the conditions described in the problem statement.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Numerically solves for the dynamic bifurcation delay in a gene induction model.\n    The model is dx/dt = nu*t + x^2. The function calculates a normalized lag ratio\n    for a series of sweep rates (nu).\n    \"\"\"\n\n    # Test cases for the sweep rate nu\n    test_cases = [1.0, 0.3, 0.1, 0.01, 0.001]\n    \n    results = []\n\n    for nu in test_cases:\n        # Define problem-specific constants and dimensionless parameters\n        s0 = -8.0\n        s_max = 20.0\n        x_th = 5.0\n\n        # Calculate initial and final times based on nu\n        nu_pow_neg_1_3 = nu**(-1.0/3.0)\n        t0 = s0 * nu_pow_neg_1_3\n        t_max = s_max * nu_pow_neg_1_3\n\n        # Calculate the initial state x(t0) on the stable branch\n        # x(t0) = -sqrt(-nu * t0)\n        x0 = -np.sqrt(-nu * t0)\n\n        # Define the ordinary differential equation dx/dt = f(t, x)\n        def ode_func(t, x):\n            # x is a 1-element array, so we access x[0]\n            return nu * t + x[0]**2\n\n        # Define the event function to detect threshold crossing\n        # The event occurs when this function is zero.\n        def escape_event(t, x):\n            return x[0] - x_th\n        \n        # Stop integration when the event occurs\n        escape_event.terminal = True\n        # Trigger event only when x is increasing (crossing from below)\n        escape_event.direction = 1\n\n        # Integrate the ODE using a high-precision solver (RK45) with event detection\n        sol = solve_ivp(\n            fun=ode_func,\n            t_span=[t0, t_max],\n            y0=[x0],\n            events=escape_event,\n            dense_output=True,\n            atol=1e-9,  # Stricter tolerances for higher accuracy\n            rtol=1e-9\n        )\n\n        # Process the results from the solver\n        if sol.t_events[0].size > 0:\n            # An event was detected. Find the first event time t >= 0.\n            event_times = sol.t_events[0]\n            valid_escape_times = event_times[event_times >= 0]\n\n            if valid_escape_times.size > 0:\n                t_esc = valid_escape_times[0]\n                \n                # Calculate the control parameter lag mu_esc\n                mu_esc = nu * t_esc\n                \n                # Calculate the normalized lag ratio r\n                r = mu_esc / nu**(2.0/3.0)\n                \n                # Append the formatted result\n                results.append(f\"{r:.6f}\")\n            else:\n                # Event occurred, but only for t < 0. Per problem, this is not an escape.\n                results.append(\"nan\")\n        else:\n            # No event was detected within the integration interval [t0, t_max].\n            results.append(\"nan\")\n    \n    # Print the final list of results in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "We now shift our focus from switches to oscillators, a hallmark of many biological systems from circadian rhythms to metabolic cycles. The Hopf bifurcation is the primary mechanism through which a stable steady state gives rise to sustained oscillations. This practice  uses the elegant polar coordinate normal form to analyze the birth of a limit cycle, allowing you to derive its amplitude and stability, and thereby classify the bifurcation as supercritical.",
            "id": "3347394",
            "problem": "Consider a two-dimensional oscillator model arising from a reduced description on the center manifold of a biochemical feedback network near a Hopf bifurcation. In polar coordinates, the reduced system is given by the normal form\n$$\n\\dot{r} = \\mu\\, r - r^{3}, \\qquad \\dot{\\theta} = \\omega,\n$$\nwhere $r$ is the oscillation amplitude, $\\theta$ is the phase angle measured in radians, $\\mu$ is the bifurcation parameter (smoothly dependent on an underlying biochemical control parameter), and $\\omega$ is the natural oscillation frequency. Using the definitions of a limit cycle in an autonomous ordinary differential equation (ODE) system (a closed isolated trajectory in state space) and linear stability via the sign of the eigenvalue of the one-dimensional linearization about an equilibrium of the amplitude equation, derive the existence and stability of a nontrivial oscillation (limit cycle) for $\\mu>0$ and explain how this corresponds to a supercritical Hopf bifurcation in the original two-dimensional system. Provide the closed-form analytic expression for the amplitude $r^{\\ast}$ of the stable limit cycle as a function of $\\mu$ as your final answer. No numerical approximation is required.",
            "solution": "The given system is the normal form for the dynamics near a Hopf bifurcation expressed in polar coordinates on the center manifold. The phase dynamics $\\dot{\\theta}=\\omega$ are decoupled and constant, so the existence and stability of oscillations are determined entirely by the amplitude dynamics $\\dot{r}=\\mu r - r^{3}$.\n\nWe start from the definition of a limit cycle in a planar autonomous ODE: a closed isolated trajectory to which nearby trajectories may converge (stable) or from which they diverge (unstable). In polar coordinates for a rotationally symmetric normal form, a limit cycle corresponds to a constant-amplitude solution $r(t)\\equiv r^{\\ast}$ with $\\theta$ rotating uniformly, hence it is sufficient to find nonzero equilibria of the amplitude equation and assess their stability.\n\nConsider the amplitude ODE:\n$$\n\\dot{r} = f(r) = \\mu r - r^{3}.\n$$\nEquilibria of $r$ satisfy $f(r)=0$. Factoring gives\n$$\nf(r) = r\\left(\\mu - r^{2}\\right).\n$$\nHence the equilibria are\n$$\nr_{0}=0, \\qquad r_{\\pm}=\\pm\\sqrt{\\mu}.\n$$\nBecause $r$ is an amplitude, the physically relevant branch is $r^{\\ast}=\\sqrt{\\mu}$ for $\\mu>0$. For $\\mu<0$, the quantities $\\pm\\sqrt{\\mu}$ are not real, so the only real equilibrium is $r=0$.\n\nTo determine stability of these equilibria in the one-dimensional amplitude equation, we linearize $f(r)$ at each equilibrium by computing its derivative:\n$$\nf'(r) = \\mu - 3 r^{2}.\n$$\nAt $r=0$,\n$$\nf'(0) = \\mu.\n$$\nThus, for $\\mu>0$, $f'(0)>0$, which implies that $r=0$ is an unstable equilibrium of the amplitude dynamics; trajectories with small $r$ increase away from zero. For $\\mu<0$, $f'(0)<0$ so $r=0$ is stable.\n\nAt $r^{\\ast}=\\sqrt{\\mu}$ (assuming $\\mu>0$ so that $r^{\\ast}$ is real and positive),\n$$\nf'\\!\\left(r^{\\ast}\\right) = \\mu - 3\\left(\\sqrt{\\mu}\\right)^{2} = \\mu - 3\\mu = -2\\mu < 0.\n$$\nTherefore, the nontrivial equilibrium $r^{\\ast}=\\sqrt{\\mu}$ is linearly stable for $\\mu>0$. In the full two-dimensional dynamics, this corresponds to a stable periodic orbit (limit cycle) of radius $r^{\\ast}=\\sqrt{\\mu}$ in polar coordinates and constant angular velocity $\\dot{\\theta}=\\omega$.\n\nWe now classify the Hopf bifurcation at $\\mu=0$. A Hopf bifurcation occurs when a pair of complex conjugate eigenvalues of the linearization of the planar system crosses the imaginary axis, generating oscillations. In the normal form amplitude equation, the nature of the Hopf bifurcation (supercritical or subcritical) is determined by the sign of the leading nonlinear term governing amplitude saturation. Specifically, the cubic coefficient in the amplitude equation,\n$$\n\\dot{r} = \\mu r - r^{3},\n$$\nis negative for the $r^{3}$ term (coefficient $-1$), which implies that nonlinear saturation reduces amplitude growth. As $\\mu$ increases through zero, the equilibrium at $r=0$ loses stability ($f'(0)=\\mu$ changes sign from negative to positive), and a branch of stable, small-amplitude limit cycles with amplitude $r^{\\ast}=\\sqrt{\\mu}$ is born for $\\mu>0$. This is the defining feature of a supercritical Hopf bifurcation: a stable limit cycle emerges as the fixed point becomes unstable when the parameter passes through the critical value.\n\nTherefore, the existence condition is $\\mu>0$, the stable limit cycle amplitude is $r^{\\ast}=\\sqrt{\\mu}$, and the Hopf bifurcation is supercritical due to the negative cubic nonlinearity and the stability of the emergent cycle.\n\nThe requested final result is the closed-form amplitude:\n$$\nr^{\\ast} = \\sqrt{\\mu}.\n$$",
            "answer": "$$\\boxed{\\sqrt{\\mu}}$$"
        }
    ]
}