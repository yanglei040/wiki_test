{
    "hands_on_practices": [
        {
            "introduction": "理论模型是连接生物学机制与可量化预测的桥梁。然而，一个模型的实用性不仅取决于其准确性，也取决于其简洁性。本练习 () 将引导你从一个详尽的质量作用动力学模型出发，通过应用生物化学中至关重要的准稳态近似 (quasi-steady-state approximation, QSSA)，推导出描述磷酸化循环的简化模型。这个过程不仅揭示了米氏方程等经典动力学形式的微观基础，还引入了集总参数 (lumped parameters) 和结构可辨识性的关键概念，阐明了我们如何以及为何要将复杂的微观速率常数组合为宏观上可测量的量。",
            "id": "3310431",
            "problem": "一个单一位点的磷酸化循环在体外通过激酶和磷酸酶作用于底物来实现。该底物具有未磷酸化形式 $X$ 和磷酸化形式 $X_{P}$。激酶 $E$ 和磷酸酶 $F$ 可逆地结合各自的底物，形成复合物 $C_{1}$ 和 $C_{2}$，随后进行催化转化。反应方案如下\n$$\nX + E \\xrightleftharpoons[k_{-1}]{k_{1}} C_{1} \\xrightarrow{k_{\\text{cat},1}} X_{P} + E, \\qquad\nX_{P} + F \\xrightleftharpoons[k_{-2}]{k_{2}} C_{2} \\xrightarrow{k_{\\text{cat},2}} X + F,\n$$\n其中总酶浓度 $E_{T}$ 和 $F_{T}$ 是守恒的，并且系统是充分混合的闭合系统，总底物浓度 $X_{T}$ 固定。设可观测量为 $y(t) = X_{P}(t)$，并记 $x(t) = X(t)$、$c_{1}(t) = C_{1}(t)$、$c_{2}(t) = C_{2}(t)$、$e(t) = E(t)$ 和 $f(t) = F(t)$。所有反应均遵循质量作用动力学，且 $E_{T} = e + c_{1}$，$F_{T} = f + c_{2}$。\n\n以质量作用动力学和守恒定律为基本依据，通过变量消除来证明具有状态变量 $(x, y, c_{1}, c_{2}, e, f)$ 的完整质量作用公式与一个以可观测量 $y(t)$ 和底物守恒 $X_{T}$ 表示的简化公式之间的动态等价性。具体来说：\n\n1. 对复合物 $C_{1}$ 和 $C_{2}$ 应用准稳态近似（QSSA），并假设酶相对于底物处于催化量级，因此复合物对底物守恒的贡献可以忽略不计，即 $X_{T} \\approx x + y$。\n\n2. 使用酶守恒关系消除 $e$ 和 $f$，并使用准稳态近似消除 $c_{1}$ 和 $c_{2}$，以获得一个关于 $y(t)$ 的无输入的单一常微分方程，其形式为\n$$\n\\frac{dy}{dt} = f\\!\\left(y; X_{T}, V_{1}, K_{M,1}, V_{2}, K_{M,2}\\right),\n$$\n其中合适的集总参数 $V_{1}$、$K_{M,1}$、$V_{2}$ 和 $K_{M,2}$ 由微观速率常数和总量定义。\n\n3. 运用模型简化和可观测性的第一性原理，简要解释您所获得的集总参数如何仅从 $y(t)$ 的测量值中确定简化模型的结构可辨识性，以及为什么在没有额外实验信息的情况下无法辨识单个微观速率常数。\n\n您最终报告的答案必须是右侧项 $f\\!\\left(y; X_{T}, V_{1}, K_{M,1}, V_{2}, K_{M,2}\\right)$ 的显式闭合表达式，形式为单个解析表达式。最终答案中不要包含中间步骤或参数定义。不需要进行数值计算。最终答案不带单位表示。",
            "solution": "问题陈述经过严格验证，被认为是有效的。这是一个科学上合理、适定且客观的问题陈述，是计算系统生物学中的典型问题。它要求使用标准的、明确定义的假设（质量作用动力学、准稳态近似（QSSA）和守恒定律）来推导单一位点磷酸化循环的简化动力学模型。所有必要的信息都已提供，任务是执行标准的模型简化，该简化具有唯一且有意义的解。\n\n我们首先根据质量作用动力学原理，建立描述所有物种浓度的完整常微分方程组（ODEs）。设 $x(t)$、$y(t)$、$e(t)$、$f(t)$、$c_1(t)$ 和 $c_2(t)$ 分别表示 $X$、$X_P$、$E$、$F$、$C_1$ 和 $C_2$ 的浓度。反应方案为：\n$$\nX + E \\xrightleftharpoons[k_{-1}]{k_{1}} C_{1} \\xrightarrow{k_{\\text{cat},1}} X_{P} + E\n$$\n$$\nX_{P} + F \\xrightleftharpoons[k_{-2}]{k_{2}} C_{2} \\xrightarrow{k_{\\text{cat},2}} X + F\n$$\n相应的常微分方程组为：\n$$\n\\frac{dc_{1}}{dt} = k_{1} x e - (k_{-1} + k_{\\text{cat},1}) c_{1}\n$$\n$$\n\\frac{dc_{2}}{dt} = k_{2} y f - (k_{-2} + k_{\\text{cat},2}) c_{2}\n$$\n$$\n\\frac{dy}{dt} = k_{\\text{cat},1} c_{1} - k_{2} y f + k_{-2} c_{2}\n$$\n该系统受制于总酶浓度 $E_{T}$ 和 $F_{T}$ 以及总底物浓度 $X_{T}$ 的守恒定律：\n$$\nE_{T} = e(t) + c_{1}(t)\n$$\n$$\nF_{T} = f(t) + c_{2}(t)\n$$\n$$\nX_{T} = x(t) + y(t) + c_{1}(t) + c_{2}(t)\n$$\n问题指定了两个用于模型简化的关键假设。首先，对酶-底物复合物应用准稳态近似（QSSA），即假设它们达到平衡的速度远快于底物浓度的变化速度。这意味着 $\\frac{dc_{1}}{dt} \\approx 0$ 和 $\\frac{dc_{2}}{dt} \\approx 0$。\n将QSSA应用于 $c_1$ 的常微分方程：\n$$\n0 \\approx k_{1} x e - (k_{-1} + k_{\\text{cat},1}) c_{1} \\implies c_{1} \\approx \\frac{k_{1} x e}{k_{-1} + k_{\\text{cat},1}}\n$$\n我们使用守恒定律 $e = E_{T} - c_{1}$ 来消除游离酶浓度 $e$：\n$$\nc_{1} (k_{-1} + k_{\\text{cat},1}) \\approx k_{1} x (E_{T} - c_{1})\n$$\n$$\nc_{1} (k_{-1} + k_{\\text{cat},1} + k_{1} x) \\approx k_{1} x E_{T}\n$$\n$$\nc_{1} \\approx \\frac{k_{1} x E_{T}}{k_{-1} + k_{\\text{cat},1} + k_{1} x} = \\frac{x E_{T}}{\\frac{k_{-1} + k_{\\text{cat},1}}{k_{1}} + x}\n$$\n我们定义激酶的米氏常数 $K_{M,1} = \\frac{k_{-1} + k_{\\text{cat},1}}{k_{1}}$，从而得到熟悉的米氏-门腾形式：\n$$\nc_{1} \\approx \\frac{E_{T} x}{K_{M,1} + x}\n$$\n类似地，将QSSA应用于 $c_2$ 的常微分方程并使用 $f = F_{T} - c_{2}$：\n$$\n0 \\approx k_{2} y f - (k_{-2} + k_{\\text{cat},2}) c_{2} \\implies c_{2} \\approx \\frac{k_{2} y (F_{T} - c_{2})}{k_{-2} + k_{\\text{cat},2}}\n$$\n$$\nc_{2} (k_{-2} + k_{\\text{cat},2} + k_{2} y) \\approx k_{2} y F_{T}\n$$\n$$\nc_{2} \\approx \\frac{k_{2} y F_{T}}{k_{-2} + k_{\\text{cat},2} + k_{2} y} = \\frac{y F_{T}}{\\frac{k_{-2} + k_{\\text{cat},2}}{k_{2}} + y}\n$$\n定义磷酸酶的米氏常数 $K_{M,2} = \\frac{k_{-2} + k_{\\text{cat},2}}{k_{2}}$，我们得到：\n$$\nc_{2} \\approx \\frac{F_{T} y}{K_{M,2} + y}\n$$\n现在，我们求出可观测量 $y = X_P$ 的简化常微分方程。完整的常微分方程为 $\\frac{dy}{dt} = k_{\\text{cat},1} c_{1} - k_{2} y f + k_{-2} c_{2}$。根据 $c_2$ 的QSSA，我们有 $k_{2} y f - k_{-2} c_{2} = k_{\\text{cat},2} c_2$。将此代入 $y$ 的常微分方程，可显著简化：\n$$\n\\frac{dy}{dt} = k_{\\text{cat},1} c_1 - (k_{2} y f - k_{-2} c_2) = k_{\\text{cat},1} c_{1} - k_{\\text{cat},2} c_{2}\n$$\n该方程表示磷酸化底物的净变化率，即激酶催化的生成速率与磷酸酶催化的消耗速率之差。\n现在我们将 $c_1$ 和 $c_2$ 的QSSA表达式代入此方程：\n$$\n\\frac{dy}{dt} \\approx k_{\\text{cat},1} \\left(\\frac{E_{T} x}{K_{M,1} + x}\\right) - k_{\\text{cat},2} \\left(\\frac{F_{T} y}{K_{M,2} + y}\\right)\n$$\n第二个假设是总酶浓度是催化量的，即 $E_T \\ll X_T$ 和 $F_T \\ll X_T$。这使得忽略复合物中螯合的底物量是合理的，从而得到近似 $X_{T} \\approx x(t) + y(t)$。我们用这个关系来消除 $x$：\n$$\nx(t) \\approx X_{T} - y(t)\n$$\n将此代入常微分方程，得到一个仅含 $y$ 的方程：\n$$\n\\frac{dy}{dt} = k_{\\text{cat},1} E_{T} \\frac{X_{T} - y}{K_{M,1} + (X_{T} - y)} - k_{\\text{cat},2} F_{T} \\frac{y}{K_{M,2} + y}\n$$\n最后，我们定义激酶和磷酸酶反应的最大速率分别为 $V_{1} = k_{\\text{cat},1} E_{T}$ 和 $V_{2} = k_{\\text{cat},2} F_{T}$。这些参数代表了在底物浓度饱和时每个反应的最大速率。最终的简化常微分方程为：\n$$\n\\frac{dy}{dt} = \\frac{V_{1} (X_{T} - y)}{K_{M,1} + X_{T} - y} - \\frac{V_{2} y}{K_{M,2} + y}\n$$\n这就是所求的函数 $f(y; X_{T}, V_{1}, K_{M,1}, V_{2}, K_{M,2})$。\n\n对于问题的第三部分，关于结构可辨识性：模型简化的过程将微观常数 $\\{k_1, k_{-1}, k_{\\text{cat},1}, k_2, k_{-2}, k_{\\text{cat},2}, E_T, F_T\\}$ 的高维参数空间转换为了集总的、有效的参数 $\\{V_1, K_{M,1}, V_2, K_{M,2}\\}$ 的低维空间。可观测量 $y(t)$ 的动力学完全由这四个参数的简化集合决定（假设 $X_T$ 已知）。通过在足够大的范围内测量 $y(t)$ 及其导数 $\\frac{dy}{dt}$，原则上可以唯一地确定 $V_1$、$K_{M,1}$、$V_2$ 和 $K_{M,2}$ 的数值。因此，这些集总参数仅从 $y(t)$ 的测量值来看是结构可辨识的。\n然而，微观速率常数则不是。从微观参数到集总参数的映射是多对一的。例如，$V_1 = k_{\\text{cat},1} E_T$ 且 $K_{M,1} = (k_{-1} + k_{\\text{cat},1}) / k_1$。从一个测得的 $V_1$ 值，只能确定乘积 $k_{\\text{cat},1} E_T$，而不能确定单个的值。无限多种 $k_1$、$k_{-1}$ 和 $k_{\\text{cat},1}$ 的组合可以产生相同的 $K_{M,1}$ 值。由于不可能从定义集总参数的四个方程中唯一地解出八个微观参数，因此这些微观参数是结构不可辨识的。要确定它们，需要额外的实验来分离子系统或直接测量特定参数（例如，通过结合分析来确定 $k_1/k_{-1}$）。",
            "answer": "$$\n\\boxed{\\frac{V_{1} (X_{T} - y)}{K_{M,1} + X_{T} - y} - \\frac{V_{2} y}{K_{M,2} + y}}\n$$"
        },
        {
            "introduction": "动态模型一旦建立，其核心价值在于揭示系统可能展现的生物学行为。在基因调控等领域，系统通常会演化到特定的稳定状态，代表不同的细胞表型。本练习 () 以一个经典的双基因反馈模块为背景，这是一个理解细胞决策和表型转换的核心模型。通过求解系统的平衡点，并利用雅可比矩阵分析其局部稳定性，你将亲身体验如何将稳定节点、鞍点等抽象的数学概念与双稳态、表型选择等具体的生物学功能联系起来，从而掌握从模型方程中解读生物学意义的关键技能。",
            "id": "3310471",
            "problem": "考虑一个简化的双基因反馈模块，其表达式由相对于基准稳态的无量纲偏差给出。设状态向量为 $x(t)$ 和 $y(t)$，其中 $x$ 和 $y$ 表示两种相互作用的蛋白质浓度相对于各自基准水平的微小带符号偏差。在此工作点附近，假设相互作用的非线性可以由与对称性和质量平衡降解相符的最低阶奇次多项式捕获，从而得到常微分方程（ODE）\n$$\n\\frac{dx}{dt} \\;=\\; -\\,x \\;+\\; k\\,y \\;-\\; y^{3}, \n\\qquad\n\\frac{dy}{dt} \\;=\\; -\\,y \\;+\\; k\\,x \\;-\\; x^{3},\n$$\n其中 $k$ 是一个正的无量纲反馈强度参数。可观测量（实验中测量的量）是两种蛋白质的线性读出，由下式给出\n$$\nz \\;=\\; x \\;+\\; 2\\,y,\n$$\n例如，这可以解释为一个对 $y$ 比对 $x$ 更敏感的荧光通道。所有变量和参数均为无量纲。\n\n任务：\n- 仅使用确定性动力系统的基本原理，即平衡点满足 $\\frac{dx}{dt} = 0$ 和 $\\frac{dy}{dt} = 0$，且局部稳定性由在平衡点处评估的向量场的雅可比矩阵的特征值决定，计算系统的所有平衡点（用 $k$ 表示），并通过评估雅可比特征值来分析每个平衡点的局部稳定性。\n- 在反馈基因模块的表型选择和吸引盆边界的背景下，解释您发现的不同稳定性类型（例如，渐近稳定节点、鞍点和不稳定平衡点）的生物学意义。\n- 假设 $k$ 位于范围 $1  k  2$ 内。在此区间存在的平衡点中，恰好有一个满足 $x>0$ 和 $y>0$ 的渐近稳定平衡点。设 $(x^{\\star},y^{\\star})$ 表示该平衡点。可观测量 $z^{\\star} = x^{\\star} + 2\\,y^{\\star}$ 关于 $k$ 的闭式表达式是什么？\n\n答案格式：\n- 提供一个关于 $k$ 的 $z^{\\star}$ 的单一闭式解析表达式。不包括单位。不要在最终答案框中提供中间步骤。无需四舍五入。",
            "solution": "我们从定义开始：平衡点求解 $\\frac{dx}{dt}=0$ 和 $\\frac{dy}{dt}=0$。局部稳定性由每个平衡点处向量场的雅可比矩阵 $J(x,y)$ 的特征值决定。如果所有特征值的实部均为负，则该平衡点是局部渐近稳定的；如果一个特征值有正实部而另一个有负实部，则该平衡点是鞍点。\n\n第1步：计算平衡点。令\n$$\n0 \\;=\\; -\\,x \\;+\\; k\\,y \\;-\\; y^{3}, \\qquad 0 \\;=\\; -\\,y \\;+\\; k\\,x \\;-\\; x^{3}。\n$$\n我们寻找对角线 $x=y$ 上的对称平衡点和反对角线 $y=-x$ 上的反对称平衡点；这些是由于右手边在交换 $x$ 和 $y$ 时具有对称性而自然产生的。\n\n- 对角线平衡点 $x=y=s$：代入 $x=y=s$ 得\n$$\n0 \\;=\\; -\\,s \\;+\\; k\\,s \\;-\\; s^{3} \\;=\\; s\\big(k-1-s^{2}\\big).\n$$\n因此 $s=0$ 或 $s^{2}=k-1$。所以，对角线平衡点是\n$$\n(x,y) \\;=\\; (0,0) \\quad\\text{和}\\quad (x,y)\\;=\\;(\\pm \\sqrt{k-1}, \\pm \\sqrt{k-1}),\n$$\n后者在 $k>1$ 时存在。\n\n- 反对角线平衡点 $y=-x=s'$，其中 $x=s$ 且 $y=-s$：将 $y=-x$ 代入第一个方程得\n$$\n0 \\;=\\; -\\,x \\;+\\; k(-x) \\;-\\; (-x)^{3} \\;=\\; -\\,(1+k)\\,x \\;+\\; x^{3} \\;=\\; x\\big(x^{2}-(k+1)\\big).\n$$\n因此 $x=0$ 或 $x^{2}=k+1$。相应的平衡点是\n$$\n(x,y)\\;=\\;(0,0)\\quad\\text{和}\\quad (x,y)\\;=\\;(\\pm \\sqrt{k+1}, \\mp \\sqrt{k+1}),\n$$\n后者在 $k>-1$ 时存在。点 $(0,0)$ 已经找到。因此，对于 $k>1$，存在五个平衡点：\n$$\n(0,0),\\quad (\\sqrt{k-1},\\sqrt{k-1}),\\quad (-\\sqrt{k-1},-\\sqrt{k-1}),\\quad (\\sqrt{k+1},-\\sqrt{k+1}),\\quad (-\\sqrt{k+1},\\sqrt{k+1})。\n$$\n\n第2步：计算雅可比矩阵并根据特征值对平衡点进行分类。雅可比矩阵是\n$$\nJ(x,y) \\;=\\; \\begin{pmatrix}\n\\frac{\\partial}{\\partial x}\\big(-x + k y - y^{3}\\big)  \\frac{\\partial}{\\partial y}\\big(-x + k y - y^{3}\\big) \\\\\n\\frac{\\partial}{\\partial x}\\big(-y + k x - x^{3}\\big)  \\frac{\\partial}{\\partial y}\\big(-y + k x - x^{3}\\big)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n-1  k - 3 y^{2} \\\\\nk - 3 x^{2}  -1\n\\end{pmatrix}.\n$$\n\n- 在 $(0,0)$ 处：我们有 $J(0,0) = \\begin{pmatrix} -1  k \\\\ k  -1 \\end{pmatrix}$。矩阵 $\\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}$ 的特征值是 $a\\pm b$。因此\n$$\n\\lambda_{1,2}(0,0) \\;=\\; -1 \\pm k.\n$$\n对于 $k>1$，一个特征值为正（即 $-1+k$），一个为负（即 $-1-k$），所以 $(0,0)$ 是一个鞍点。\n\n- 在 $(\\pm \\sqrt{k-1}, \\pm \\sqrt{k-1})$ 处：令 $s=\\sqrt{k-1}$，则 $x=y=s$ 或 $x=y=-s$。两种情况下都有 $x^{2}=y^{2}=s^{2}=k-1$。那么\n$$\nJ(s,s) \\;=\\; \\begin{pmatrix} -1  k - 3 s^{2} \\\\ k - 3 s^{2}  -1 \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} -1  3 - 2k \\\\ 3 - 2k  -1 \\end{pmatrix},\n$$\n因为 $k - 3 s^{2} = k - 3(k-1) = 3 - 2k$。特征值是\n$$\n\\lambda_{1,2}(s,s) \\;=\\; -1 \\pm (3 - 2k) \\;=\\; 2(1-k),\\;\\; 2(k-2).\n$$\n对于 $1  k  2$，两个特征值都是负的（因为 $1-k  0$ 且 $k-2  0$）。因此，这些点是稳定的。当 $k=2$ 时，一个特征值为零。当 $k>2$ 时，一个特征值变为正，它们变得不稳定。\n\n- 在 $(\\pm \\sqrt{k+1}, \\mp \\sqrt{k+1})$ 处：令 $s'=\\sqrt{k+1}$，则 $x^{2}=y^{2}=(s')^{2}=k+1$。那么\n$$\nJ(s',-s') \\;=\\; \\begin{pmatrix} -1  k - 3 (s')^{2} \\\\ k - 3 (s')^{2}  -1 \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} -1  -3-2k \\\\ -3-2k  -1 \\end{pmatrix},\n$$\n因为 $k - 3(k+1) = -2k-3$。特征值是\n$$\n\\lambda_{1,2}(s',-s') \\;=\\; -1 \\pm (-3 - 2k) \\;=\\; 2,\\;\\; -2(k+2).\n$$\n因为 $k>1$，一个特征值是正的（$2$），另一个是负的（$-2(k+2)$）。因此，这些点总是鞍点。\n\n第3步：生物学意义和最终答案。\n对于 $1  k  2$，系统具有两个稳定的平衡点（节点），$(\\sqrt{k-1},\\sqrt{k-1})$ 和 $(-\\sqrt{k-1},-\\sqrt{k-1})$，以及三个鞍点。\n- 稳定的平衡点代表了系统的长期行为或表型。因为系统是双稳态的，它将根据其初始条件演化到这两个稳定状态中的一个。这些状态对应于基因表达的“高-高”和“低-低”模式。\n- 鞍点是不稳定的。它们的生物学意义在于它们位于不同稳定状态的吸引盆（basins of attraction）之间的边界上，即所谓的“分界线”（separatrix）。从这些点附近开始的轨迹将对微小的扰动高度敏感，决定系统最终走向哪个稳定表型。\n\n问题要求在 $1  k  2$ 时，对于满足 $x>0$ 和 $y>0$ 的渐近稳定平衡点 $(x^{\\star},y^{\\star})$，计算 $z^{\\star}$。该平衡点是\n$$\n(x^{\\star}, y^{\\star}) \\;=\\; (\\sqrt{k-1},\\sqrt{k-1}).\n$$\n可观测量是\n$$\nz^{\\star} \\;=\\; x^{\\star} \\;+\\; 2 y^{\\star} \\;=\\; \\sqrt{k-1} \\;+\\; 2 \\sqrt{k-1} \\;=\\; 3\\sqrt{k-1}.\n$$",
            "answer": "$$\\boxed{3\\sqrt{k-1}}$$"
        },
        {
            "introduction": "真实的生物系统往往包含跨越多个数量级的时间尺度，例如快速的分子结合与缓慢的基因表达。这种时间尺度分离会导致常微分方程 (ODE) 模型出现“刚性” (stiffness) 问题，给数值求解带来巨大挑战。本练习 () 将通过一个具体的信号级联模型，让你动手解决这一计算难题。你将学习如何通过无量纲化和变量缩放来改善模型的数值条件，并量化这一过程对系统雅可比矩阵的改善效果，从而深刻理解为何模型的“表达形式”对于其计算分析的成败至关重要。",
            "id": "3310428",
            "problem": "考虑一个三态质量作用信号级联，它捕捉了快速的受体激活、中速的激酶激活和慢速的基因表达响应。设状态向量为 $x(t) = [x_1(t), x_2(t), x_3(t)]^\\top$，其中 $x_1(t)$ 是活性受体浓度，$x_2(t)$ 是活性激酶浓度，$x_3(t)$ 是基因产物浓度。总受体和总激酶池分别为 $R_{\\mathrm{tot}}$ 和 $K_{\\mathrm{tot}}$。配体浓度 $S$ 是恒定的。控制常微分方程 (ODEs) 由以下质量作用和一级过程指定：\n1. 受体激活与失活：$\\dfrac{dx_1}{dt} = k_{1,\\mathrm{on}} S \\left(R_{\\mathrm{tot}} - x_1\\right) - k_{1,\\mathrm{off}} x_1 - d_1 x_1$。\n2. 由活性受体驱动的激酶激活/失活：$\\dfrac{dx_2}{dt} = k_{2,\\mathrm{cat}} x_1 \\left(K_{\\mathrm{tot}} - x_2\\right) - k_{2,\\mathrm{deact}} x_2$。\n3. 由活性激酶驱动的基因表达与降解：$\\dfrac{dx_3}{dt} = k_{3,\\mathrm{syn}} x_2 - d_3 x_3$。\n\n所有浓度单位均应解释为微摩尔(micromolar)，所有速率常数单位均为每秒(per second)，但本问题中要求的输出是无量纲的，因此不需要物理单位。假设对于所有 $t \\ge 0$，$x_i(t) \\ge 0$ 且 $0 \\le x_1(t) \\le R_{\\mathrm{tot}}$，$0 \\le x_2(t) \\le K_{\\mathrm{tot}}$。\n\n从这些基本定义出发，为下面提供的测试套件中的每个参数集执行以下任务。\na) 推导并评估满足 $f(x^\\ast)=0$ 的稳态 $x^\\ast = [x_1^\\ast,x_2^\\ast,x_3^\\ast]^\\top$，其中 $f(x)$ 是 ODE 的右侧函数。你可以利用该系统在 $x_1$ 影响 $x_2$、$x_2$ 影响 $x_3$ 但没有向上游物质反馈的意义上是严格下块三角的这一事实。\nb) 推导雅可比矩阵 $J(x) = \\dfrac{\\partial f}{\\partial x}(x)$ 并在 $x^\\ast$ 处对其进行评估。明确地，$J(x^\\ast)$ 的元素为 $J_{ij}(x^\\ast) = \\dfrac{\\partial f_i}{\\partial x_j}(x^\\ast)$。\nc) 定义由稳态本身给出的浓度标度 $C = \\mathrm{diag}(x_1^\\ast, x_2^\\ast, x_3^\\ast)$，并定义一个无量纲变量替换 $y = C^{-1} x$。通过稳态下最快的局部线性速率大小定义一个时间标度 $T$，$T = \\left(\\max\\{ |J_{11}(x^\\ast)|, |J_{22}(x^\\ast)|, |J_{33}(x^\\ast)| \\}\\right)^{-1}$。证明关于 $y$ 的无量纲雅可比矩阵是 $J_{\\mathrm{scaled}} = T \\, C^{-1} J(x^\\ast) C$。\nd) 通过两种互补的方式量化此缩放下线性化动力学数值条件的改善：\n   1. 使用奇异值分解 (SVD) 计算稳态下雅可比矩阵的二范数条件数 $\\kappa_2(J) = \\sigma_{\\max}(J) / \\sigma_{\\min}(J)$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别表示最大和最小奇异值。类似地计算 $\\kappa_2(J_{\\mathrm{scaled}})$。将改善因子 $\\rho_J = \\kappa_2(J) / \\kappa_2(J_{\\mathrm{scaled}})$ 作为浮点数报告，四舍五入到六位小数。\n   2. 设 $J = V \\Lambda V^{-1}$ 是一个特征分解，其中 $V$ 是右特征向量矩阵，$\\Lambda$ 是特征值对角矩阵。$J$ 的非正规性可以通过二范数条件数 $\\kappa_2(V)$ 来量化。计算 $J$ 和 $J_{\\mathrm{scaled}}$ 的 $\\kappa_2(V)$ 和 $\\kappa_2(V_{\\mathrm{scaled}})$，并报告改善因子 $\\rho_V = \\kappa_2(V) / \\kappa_2(V_{\\mathrm{scaled}})$ 作为浮点数，四舍五入到六位小数。使用特征分解的主分支，并通过 $V$ 的最大奇异值与最小奇异值之比定义 $\\kappa_2(V)$；如果最小奇异值因数值精度下溢为零，则将条件数视为 $+\\infty$，并将相应的改善因子视为 $1.0$。\n注意，$T$ 对所有奇异值进行等比例缩放，其本身不会改变矩阵条件数；为了形式上的正确性，将其包含在 $J_{\\mathrm{scaled}}$ 中，但改善是由浓度缩放驱动的。\n\n测试套件参数 (所有数值根据情况解释为微摩尔或每秒)：\n测试用例 1 (强时间尺度分离)：$R_{\\mathrm{tot}}=1.0$, $K_{\\mathrm{tot}}=10.0$, $S=1.0$, $k_{1,\\mathrm{on}}=1000.0$, $k_{1,\\mathrm{off}}=1.0$, $d_1=9.0$, $k_{2,\\mathrm{cat}}=5.0$, $k_{2,\\mathrm{deact}}=0.5$, $k_{3,\\mathrm{syn}}=0.2$, $d_3=0.01$。\n测试用例 2 (非常慢的基因产物降解)：$R_{\\mathrm{tot}}=1.0$, $K_{\\mathrm{tot}}=10.0$, $S=0.1$, $k_{1,\\mathrm{on}}=500.0$, $k_{1,\\mathrm{off}}=1.0$, $d_1=9.0$, $k_{2,\\mathrm{cat}}=2.0$, $k_{2,\\mathrm{deact}}=0.2$, $k_{3,\\mathrm{syn}}=0.05$, $d_3=0.001$。\n测试用例 3 (几乎平衡的时间尺度)：$R_{\\mathrm{tot}}=1.0$, $K_{\\mathrm{tot}}=2.0$, $S=0.05$, $k_{1,\\mathrm{on}}=20.0$, $k_{1,\\mathrm{off}}=0.5$, $d_1=0.5$, $k_{2,\\mathrm{cat}}=0.2$, $k_{2,\\mathrm{deact}}=0.3$, $k_{3,\\mathrm{syn}}=0.4$, $d_3=0.5$。\n\n你的程序必须为每个测试用例计算项目 d) 中描述的两个改善因子 $\\rho_J$ 和 $\\rho_V$，并将六个结果聚合成单行打印输出，形式为用逗号分隔并包含在方括号中的列表，顺序为：$[\\rho_J^{(1)}, \\rho_V^{(1)}, \\rho_J^{(2)}, \\rho_V^{(2)}, \\rho_J^{(3)}, \\rho_V^{(3)}]$，每个值四舍五入到六位小数，并表示为普通十进制字符串。不允许有其他输出。",
            "solution": "该问题要求分析一个由常微分方程（ODE）系统描述的三态生化信号级联模型。任务包括推导系统的稳态、其在稳态下的雅可比矩阵、对相应的线性化系统进行无量纲化，以及量化由此缩放带来的数值条件改善。该分析将针对三个不同的参数集进行。\n\nODE 系统由 $\\frac{d x}{dt} = f(x)$ 给出，其中 $x(t) = [x_1(t), x_2(t), x_3(t)]^\\top$，函数 $f(x) = [f_1(x), f_2(x), f_3(x)]^\\top$ 定义为：\n$$ f_1(x) = k_{1,\\mathrm{on}} S \\left(R_{\\mathrm{tot}} - x_1\\right) - k_{1,\\mathrm{off}} x_1 - d_1 x_1 $$\n$$ f_2(x) = k_{2,\\mathrm{cat}} x_1 \\left(K_{\\mathrm{tot}} - x_2\\right) - k_{2,\\mathrm{deact}} x_2 $$\n$$ f_3(x) = k_{3,\\mathrm{syn}} x_2 - d_3 x_3 $$\n\n**a) 稳态推导**\n\n稳态 $x^\\ast = [x_1^\\ast, x_2^\\ast, x_3^\\ast]^\\top$ 是通过设置 $\\frac{dx}{dt} = 0$ 来找到的，这会产生代数方程组 $f(x^\\ast) = 0$。由于系统的级联（严格下块三角）结构，我们可以按顺序求解每个状态变量。\n\n1.  由 $\\frac{dx_1}{dt} = 0$：\n    $k_{1,\\mathrm{on}} S (R_{\\mathrm{tot}} - x_1^\\ast) - k_{1,\\mathrm{off}} x_1^\\ast - d_1 x_1^\\ast = 0$\n    $k_{1,\\mathrm{on}} S R_{\\mathrm{tot}} = (k_{1,\\mathrm{on}} S + k_{1,\\mathrm{off}} + d_1) x_1^\\ast$\n    $$ x_1^\\ast = \\frac{k_{1,\\mathrm{on}} S R_{\\mathrm{tot}}}{k_{1,\\mathrm{on}} S + k_{1,\\mathrm{off}} + d_1} $$\n\n2.  由 $\\frac{dx_2}{dt} = 0$，代入 $x_1^\\ast$：\n    $k_{2,\\mathrm{cat}} x_1^\\ast (K_{\\mathrm{tot}} - x_2^\\ast) - k_{2,\\mathrm{deact}} x_2^\\ast = 0$\n    $k_{2,\\mathrm{cat}} x_1^\\ast K_{\\mathrm{tot}} = (k_{2,\\mathrm{cat}} x_1^\\ast + k_{2,\\mathrm{deact}}) x_2^\\ast$\n    $$ x_2^\\ast = \\frac{k_{2,\\mathrm{cat}} x_1^\\ast K_{\\mathrm{tot}}}{k_{2,\\mathrm{cat}} x_1^\\ast + k_{2,\\mathrm{deact}}} $$\n\n3.  由 $\\frac{dx_3}{dt} = 0$，代入 $x_2^\\ast$：\n    $k_{3,\\mathrm{syn}} x_2^\\ast - d_3 x_3^\\ast = 0$\n    $$ x_3^\\ast = \\frac{k_{3,\\mathrm{syn}} x_2^\\ast}{d_3} $$\n鉴于所有参数都是非负的，且分母是（部分严格为正的）非负项之和，稳态分量 $x_i^\\ast$ 是良定义且非负的。\n\n**b) 雅可比矩阵推导**\n\n雅可比矩阵 $J(x)$ 的元素为 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$。\n\n偏导数如下：\n$J_{11} = \\frac{\\partial f_1}{\\partial x_1} = -k_{1,\\mathrm{on}} S - k_{1,\\mathrm{off}} - d_1$\n$J_{12} = \\frac{\\partial f_1}{\\partial x_2} = 0$\n$J_{13} = \\frac{\\partial f_1}{\\partial x_3} = 0$\n\n$J_{21} = \\frac{\\partial f_2}{\\partial x_1} = k_{2,\\mathrm{cat}} (K_{\\mathrm{tot}} - x_2)$\n$J_{22} = \\frac{\\partial f_2}{\\partial x_2} = -k_{2,\\mathrm{cat}} x_1 - k_{2,\\mathrm{deact}}$\n$J_{23} = \\frac{\\partial f_2}{\\partial x_3} = 0$\n\n$J_{31} = \\frac{\\partial f_3}{\\partial x_1} = 0$\n$J_{32} = \\frac{\\partial f_3}{\\partial x_2} = k_{3,\\mathrm{syn}}$\n$J_{33} = \\frac{\\partial f_3}{\\partial x_3} = -d_3$\n\n在稳态 $x^\\ast$ 处评估的雅可比矩阵是一个下三角矩阵：\n$$ J(x^\\ast) = \\begin{pmatrix}\n-k_{1,\\mathrm{on}} S - k_{1,\\mathrm{off}} - d_1  0  0 \\\\\nk_{2,\\mathrm{cat}} (K_{\\mathrm{tot}} - x_2^\\ast)  -k_{2,\\mathrm{cat}} x_1^\\ast - k_{2,\\mathrm{deact}}  0 \\\\\n0  k_{3,\\mathrm{syn}}  -d_3\n\\end{pmatrix} $$\n\n**c) 无量纲雅可比矩阵**\n\n缩放是使用特征浓度矩阵 $C = \\mathrm{diag}(x_1^\\ast, x_2^\\ast, x_3^\\ast)$ 和特征时间标度 $T$ 进行的。\n变量替换为 $x = C y$。围绕稳态 $x^\\ast$ 的线性化动力学是 $\\frac{d\\delta x}{dt} = J(x^\\ast) \\delta x$，其中 $\\delta x = x - x^\\ast$。\n代入 $\\delta x = C \\delta y$，我们得到 $C \\frac{d\\delta y}{dt} = J(x^\\ast) C \\delta y$，这给出 $\\frac{d\\delta y}{dt} = C^{-1} J(x^\\ast) C \\delta y$。\n引入无量纲时间 $\\tau = t/T$，我们有 $\\frac{d}{dt} = \\frac{1}{T}\\frac{d}{d\\tau}$。\n无量纲扰动 $\\delta y$ 的方程变为：\n$\\frac{d\\delta y}{d\\tau} = T C^{-1} J(x^\\ast) C \\delta y$。\n因此，无量纲雅可比矩阵是 $J_{\\mathrm{scaled}} = T C^{-1} J(x^\\ast) C$。\n\n时间标度 $T$ 定义为稳态下最快局部线性速率的倒数：\n$$ T = \\left(\\max\\{ |J_{11}(x^\\ast)|, |J_{22}(x^\\ast)|, |J_{33}(x^\\ast)| \\}\\right)^{-1} $$\n其中 $J_{ii}(x^\\ast)$ 是在 $x^\\ast$ 处评估的雅可比矩阵的对角元素。\n\n**d) 条件改善量化**\n\n数值条件的改善使用两个指标进行评估。\n\n1.  **雅可比矩阵条件数改善 ($\\rho_J$)：** 矩阵 $A$ 的二范数条件数是 $\\kappa_2(A) = \\sigma_{\\max}(A) / \\sigma_{\\min}(A)$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $A$ 的最大和最小奇异值。我们使用奇异值分解（SVD）计算 $\\kappa_2(J(x^\\ast))$ 和 $\\kappa_2(J_{\\mathrm{scaled}})$。改善因子是以下比率：\n    $$ \\rho_J = \\frac{\\kappa_2(J(x^\\ast))}{\\kappa_2(J_{\\mathrm{scaled}})} $$\n\n2.  **特征向量条件数改善 ($\\rho_V$)：** 对于矩阵 $A$，如果 $A=V\\Lambda V^{-1}$ 是其特征分解，A 的非正规性可以通过其特征向量矩阵的条件数 $\\kappa_2(V)$ 来衡量。我们为 $J(x^\\ast)$ 的特征向量矩阵 $V$ 和 $J_{\\mathrm{scaled}}$ 的特征向量矩阵 $V_{\\mathrm{scaled}}$ 计算这个值。改善因子是：\n    $$ \\rho_V = \\frac{\\kappa_2(V)}{\\kappa_2(V_{\\mathrm{scaled}})} $$\n    如果 $V$ 的最小奇异值在数值上为零（即，未缩放的特征向量基是退化的），则条件数被视为无穷大，并根据问题规范，改善因子 $\\rho_V$ 被设置为 $1.0$。\n\n以下 Python 代码为每个测试用例实现了这整个过程，计算稳态、雅可比矩阵以及改善因子 $\\rho_J$ 和 $\\rho_V$。",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Solves the problem for each test case, calculating steady states, Jacobians,\n    scaled Jacobians, and conditioning improvement factors.\n    \"\"\"\n    \n    test_cases = [\n        {\n            # Test case 1 (strong time-scale separation)\n            'R_tot': 1.0, 'K_tot': 10.0, 'S': 1.0,\n            'k1_on': 1000.0, 'k1_off': 1.0, 'd1': 9.0,\n            'k2_cat': 5.0, 'k2_deact': 0.5,\n            'k3_syn': 0.2, 'd3': 0.01\n        },\n        {\n            # Test case 2 (very slow gene product degradation)\n            'R_tot': 1.0, 'K_tot': 10.0, 'S': 0.1,\n            'k1_on': 500.0, 'k1_off': 1.0, 'd1': 9.0,\n            'k2_cat': 2.0, 'k2_deact': 0.2,\n            'k3_syn': 0.05, 'd3': 0.001\n        },\n        {\n            # Test case 3 (nearly balanced time scales)\n            'R_tot': 1.0, 'K_tot': 2.0, 'S': 0.05,\n            'k1_on': 20.0, 'k1_off': 0.5, 'd1': 0.5,\n            'k2_cat': 0.2, 'k2_deact': 0.3,\n            'k3_syn': 0.4, 'd3': 0.5\n        }\n    ]\n\n    results = []\n\n    for params in test_cases:\n        p = params\n\n        # a) Calculate steady state x_star\n        x1_star = (p['k1_on'] * p['S'] * p['R_tot']) / \\\n                  (p['k1_on'] * p['S'] + p['k1_off'] + p['d1'])\n        \n        x2_star = (p['k2_cat'] * x1_star * p['K_tot']) / \\\n                  (p['k2_cat'] * x1_star + p['k2_deact'])\n        \n        x3_star = (p['k3_syn'] * x2_star) / p['d3']\n\n        x_star = np.array([x1_star, x2_star, x3_star])\n\n        # b) Evaluate Jacobian J at x_star\n        J11 = -p['k1_on'] * p['S'] - p['k1_off'] - p['d1']\n        J21 = p['k2_cat'] * (p['K_tot'] - x_star[1])\n        J22 = -p['k2_cat'] * x_star[0] - p['k2_deact']\n        J32 = p['k3_syn']\n        J33 = -p['d3']\n        \n        J = np.array([\n            [J11, 0.0, 0.0],\n            [J21, J22, 0.0],\n            [0.0, J32, J33]\n        ])\n\n        # c) Define scales and compute scaled Jacobian J_scaled\n        C = np.diag(x_star)\n        \n        # Check for non-invertibility of C, though not expected for given test cases\n        if np.any(np.isclose(np.diag(C), 0)):\n             raise ValueError(\"Steady state concentration is zero, C is singular.\")\n        C_inv = np.diag(1.0 / x_star)\n\n        T = 1.0 / np.max(np.abs([J11, J22, J33]))\n        \n        J_scaled = T * (C_inv @ J @ C)\n\n        # d) Quantify improvement in conditioning\n        \n        # 1. Jacobian condition number improvement (rho_J)\n        s_J = linalg.svd(J, compute_uv=False)\n        cond_J = s_J[0] / s_J[-1] if s_J[-1] > 0 else np.inf\n        \n        s_Js = linalg.svd(J_scaled, compute_uv=False)\n        cond_Js = s_Js[0] / s_Js[-1] if s_Js[-1] > 0 else np.inf\n\n        rho_J = cond_J / cond_Js if cond_Js > 0 else np.inf\n        results.append(f\"{rho_J:.6f}\")\n\n        # 2. Eigenvector matrix condition number improvement (rho_V)\n        _, V = linalg.eig(J)\n        s_V = linalg.svd(V, compute_uv=False)\n        \n        # Handle numerical singularity as per problem statement\n        # Check if s_V[-1] is smaller than machine epsilon times s_V[0]\n        if s_V[-1]  np.finfo(float).eps * s_V[0]:\n            rho_V = 1.0\n        else:\n            cond_V = s_V[0] / s_V[-1]\n            \n            _, V_scaled = linalg.eig(J_scaled)\n            s_Vs = linalg.svd(V_scaled, compute_uv=False)\n            \n            cond_Vs = s_Vs[0] / s_Vs[-1] if s_Vs[-1] > 0 else np.inf\n            \n            rho_V = cond_V / cond_Vs if cond_Vs > 0 else np.inf\n\n        results.append(f\"{rho_V:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}