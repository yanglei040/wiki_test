{
    "hands_on_practices": [
        {
            "introduction": "除了判断稳态的稳定性，雅可比矩阵的一个核心应用是量化系统对参数变化的响应。稳态灵敏度分析旨在确定当系统参数（如反应速率或外部信号强度）发生微小变化时，稳态点会如何移动。这项实践将指导你通过求解一个线性方程组来计算灵敏度向量，从而揭示系统状态对参数扰动的依赖关系，这是理解和工程改造生物回路的关键一步 。",
            "id": "3321821",
            "problem": "考虑一个双态生化反应模块，在标量参数 $p$ 下，围绕一个稳定稳态 $x^{\\ast}$进行线性化。设其局部动力学由雅可比矩阵 $J$ 和在 $(x^{\\ast}, p^{\\ast})$ 处求值的直接参数输入向量 $\\partial f / \\partial p$ 表示，其中\n$$\nJ=\\begin{pmatrix}-2  1\\\\ 0  -1\\end{pmatrix},\\qquad \\frac{\\partial f}{\\partial p}=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}.\n$$\n假设 $f(x^{\\ast},p^{\\ast})=0$ 且稳态灵敏度向量 $S_{x}:=\\frac{d x^{\\ast}}{d p}$ 存在且有限。仅使用稳态下的标准线性化和灵敏度定义，通过求解关联 $J$、$S_{x}$ 和 $\\partial f/\\partial p$ 的适当线性系统来计算稳态灵敏度 $S_{x}$。然后，根据 $J$ 所隐含的局部耦合结构及其特征值所指示的稳定性，简要解释每个状态灵敏度的符号和相对大小。\n\n将最终的灵敏度向量以行向量形式报告，其元素为精确的有理数。无需四舍五入，也无需单位。",
            "solution": "该问题是有效的。这是动力系统灵敏度分析中的一个标准练习，也是计算系统生物学的核心课题。所有提供的信息在数学上是一致的，并且足以获得一个唯一的、有意义的解。\n\n系统在稳态 $x^{\\ast}$ 附近的动力学由常微分方程向量 $\\frac{dx}{dt} = f(x, p)$ 描述。根据定义，在稳态下，时间导数为零，因此我们有条件 $f(x^{\\ast}(p), p) = 0$，其中我们写作 $x^{\\ast}(p)$ 以强调稳态的位置取决于参数 $p$。\n\n稳态灵敏度向量 $S_{x}$ 定义为稳态解 $x^{\\ast}$ 对参数 $p$ 的导数，即 $S_{x} := \\frac{d x^{\\ast}}{d p}$。为了找到 $S_x$、雅可比矩阵 $J$ 和直接参数扰动 $\\frac{\\partial f}{\\partial p}$ 之间的关系，我们使用多变量链式法则对稳态方程 $f(x^{\\ast}(p), p) = 0$ 关于 $p$ 求导：\n$$\n\\frac{d}{dp} [f(x^{\\ast}(p), p)] = \\frac{\\partial f}{\\partial x} \\frac{d x^{\\ast}}{d p} + \\frac{\\partial f}{\\partial p} \\frac{d p}{d p} = 0\n$$\n根据定义，雅可比矩阵是 $J = \\frac{\\partial f}{\\partial x}$ 在稳态 $(x^{\\ast}, p^{\\ast})$ 处的值。项 $\\frac{d x^{\\ast}}{d p}$ 是灵敏度向量 $S_x$。由于 $\\frac{dp}{dp}=1$，该方程变为：\n$$\nJ S_{x} + \\frac{\\partial f}{\\partial p} = 0\n$$\n这可以重排为我们必须求解 $S_x$ 的线性系统：\n$$\nJ S_{x} = - \\frac{\\partial f}{\\partial p}\n$$\n问题提供了系统在特定稳态 $(x^{\\ast}, p^{\\ast})$ 下的具体矩阵：\n$$\nJ=\\begin{pmatrix}-2  1\\\\ 0  -1\\end{pmatrix},\\qquad \\frac{\\partial f}{\\partial p}=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}\n$$\n设灵敏度向量为 $S_{x} = \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix}$。我们将给定值代入线性系统：\n$$\n\\begin{pmatrix}-2  1\\\\ 0  -1\\end{pmatrix} \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} = - \\begin{pmatrix}1\\\\ 0\\end{pmatrix} = \\begin{pmatrix}-1\\\\ 0\\end{pmatrix}\n$$\n这个矩阵方程对应一个由两个线性方程组成的方程组：\n1.  $-2s_1 + s_2 = -1$\n2.  $0s_1 - s_2 = 0$\n\n从第二个方程，我们立即得出 $-s_2 = 0$，这意味着 $s_2 = 0$。\n将 $s_2 = 0$ 代入第一个方程得到：\n$$\n-2s_1 + 0 = -1\n$$\n$$\n-2s_1 = -1\n$$\n$$\ns_1 = \\frac{1}{2}\n$$\n因此，稳态灵敏度向量为 $S_{x} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\end{pmatrix}$。按照要求，写成行向量形式为 $(\\frac{1}{2}, 0)$。\n\n为了进行解释，我们分析系统的结构和结果。\n首先，我们检查稳定性。雅可比矩阵 $J$ 是一个上三角矩阵，所以其特征值是其对角线元素：$\\lambda_1 = -2$ 和 $\\lambda_2 = -1$。由于两个特征值都是负实数，该稳态是稳定的，正如问题中所述。\n\n雅可比矩阵 $J$ 的分量描述了局部相互作用：\n- $J_{11} = -2$ 和 $J_{22} = -1$ 表明状态变量 $x_1$ 和 $x_2$ 都是自抑制的，这是一个稳定化特征。\n- $J_{12} = 1$ 表明 $x_2$ 激活 $x_1$。\n- $J_{21} = 0$ 表明 $x_1$ 不直接影响 $x_2$。这建立了一种级联式或前馈式的相互作用，其中影响从 $x_2$ 流向 $x_1$，但反向不成立。\n\n直接参数输入向量 $\\frac{\\partial f}{\\partial p} = \\begin{pmatrix}1\\\\ 0\\end{pmatrix}$ 表明，参数 $p$ 仅直接扰动 $x_1$ 的动力学（具体来说，它增加了其变化率），而对 $x_2$ 没有直接影响。\n\n灵敏度结果 $S_{x} = (\\frac{dx_1^{\\ast}}{dp}, \\frac{dx_2^{\\ast}}{dp}) = (\\frac{1}{2}, 0)$ 现在可以解释如下：\n- 第二个状态的灵敏度为零 ($s_2 = 0$)。这是因为参数 $p$ 不直接影响 $x_2$ (因为 $\\frac{\\partial f_2}{\\partial p} = 0$)，并且不存在扰动从 $x_1$ 传到 $x_2$ 的间接路径 (因为 $J_{21} = 0$)。因此，$x_2$ 的稳态值完全不受 $p$ 变化的影响。\n- 第一个状态的灵敏度为正且有限 ($s_1 = \\frac{1}{2}$)。正号表示 $p$ 的增加会导致 $x_1$ 稳态值的增加。这是符合预期的，因为 $p$ 直接促进 $x_1$，而来自系统的唯一反馈是通过 $x_2$ 实现的，而 $x_2$ 对 $x_1$ 有正向影响。数值大小 $\\frac{1}{2}$ 反映了新稳态下的平衡。来自 $p$ 的直接正向扰动（强度为+1）必须由系统的响应来平衡。由于 $s_2=0$，$x_1$ 的变化仅由其自身的强自抑制 ($J_{11}=-2$) 来平衡。从第一个方程可以看出最终的灵敏度，$s_1 = \\frac{-1 - s_2}{-2} = \\frac{-1 - 0}{-2} = \\frac{1}{2}$。强大的自阻尼作用减弱了参数扰动的影响。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "生物系统常常表现出节律性行为，例如昼夜节律和细胞周期，这些都源于潜在的分子振荡。雅可比矩阵的特征值分析是预测这些振荡何时出现的有力工具。当一对共轭复特征值的实部由负变正，穿越虚轴时，系统会经历一次霍普夫分岔（Hopf bifurcation），导致稳定的稳态转变为持续的振荡（极限环）。本练习将以合成生物学中的经典模型——抑制子振荡器（repressilator）为例，让你通过分析和计算，亲手确定导致振荡产生的参数条件 。",
            "id": "3321845",
            "problem": "考虑无量纲的三基因振荡器（repressilator）模型，这是一个典型的合成基因回路，由三个排列成环形的转录抑制因子组成。令 $x(t)$、$y(t)$ 和 $z(t)$ 表示三种基因产物的浓度。其动力学由以下常微分方程组建模：\n$$\n\\frac{dx}{dt} = -x + \\frac{\\alpha}{1 + \\left(\\frac{z}{K}\\right)^n}, \\quad\n\\frac{dy}{dt} = -y + \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^n}, \\quad\n\\frac{dz}{dt} = -z + \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^n},\n$$\n其中 $n \\ge 1$ 是希尔系数（无量纲），$\\alpha  0$ 是最大生产速率（无量纲），$K  0$ 是抑制阈值（无量纲）。所有物质的降解率均被缩放为 $1$。\n\n任务：\n1. 从通过雅可比矩阵进行局部线性化的定义出发，考虑由不动点条件 $s = \\frac{\\alpha}{1 + \\left(\\frac{s}{K}\\right)^n}$ 隐式定义的对称稳态 $x^* = y^* = z^* = s$。通过计算右侧函数对状态变量的偏导数，并在 $x=y=z=s$ 处求值，推导出在该对称稳态下的雅可比矩阵 $J$，用 $s$、$n$、$\\alpha$ 和 $K$ 表示。\n2. 使用第一性原理来解释雅可比矩阵的特征值，说明特征值实部的符号如何决定局部稳定性。确定一对共轭复数特征值穿过虚轴的条件，该条件预示着霍普夫分岔（Hopf bifurcation）和持续振荡的开始。\n3. 编写一个完整的、可运行的程序，对于给定的一组参数 $(n,\\alpha,K)$，执行以下步骤：\n   - 通过求解 $s$（或等效地求解 $r = \\left(\\frac{s}{K}\\right)^n$）来数值计算对称稳态，以满足不动点条件。\n   - 使用计算出的导数构建在 $x=y=z=s$ 处的雅可比矩阵 $J$。\n   - 计算 $J$ 的特征值，并确定是否存在具有正实部（严格大于零）的共轭复数对，这表明系统处于与霍普夫分岔相关的振荡状态。\n   - 对于每个测试用例，如果预测系统处于振荡状态（共轭复数对具有正实部），则输出整数 $1$，否则输出 $0$（包括实部等于零的边界情况）。\n所有变量和参数均为无量纲；无需物理单位。不涉及角度。\n\n测试集：\n使用以下参数集 $(n,\\alpha,K)$ 来评估您的程序。这些参数集涵盖了一般情况、边界条件和边缘情况：\n- $(2, 100.0, 1.0)$\n- $(3, 4.0, 1.0)$\n- $(4, 2.0, 1.0)$\n- $(4, 4.0, 1.0)$\n- $(5, 1.0, 0.1)$\n- $(3, 1.0, 1.0)$\n\n最终输出格式：\n您的程序应生成单行结果，格式为方括号内包含的逗号分隔列表。例如，对于六个测试用例，输出必须为以下形式：\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5,\\text{result}_6]\n$$\n其中每个 $\\text{result}_i$ 是如上指定的整数 $0$ 或 $1$。",
            "solution": "在提供解决方案之前，需对问题进行验证。\n\n### 步骤1：提取已知信息\n\n所提供的信息包括：\n- **无量纲常微分方程（ODE）系统：**\n$$\n\\frac{dx}{dt} = -x + \\frac{\\alpha}{1 + \\left(\\frac{z}{K}\\right)^n} \\\\\n\\frac{dy}{dt} = -y + \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^n} \\\\\n\\frac{dz}{dt} = -z + \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^n}\n$$\n- **状态变量：** 代表浓度的 $x(t)$、$y(t)$、$z(t)$。\n- **参数：**\n  - $n \\ge 1$：希尔系数。\n  - $\\alpha  0$：最大生产速率。\n  - $K  0$：抑制阈值。\n- **对称稳态：** 一个不动点，其中 $x^* = y^* = z^* = s$。\n- **不动点条件：** 稳态值 $s$ 由方程 $s = \\frac{\\alpha}{1 + \\left(\\frac{s}{K}\\right)^n}$ 隐式定义。\n- **任务1：** 推导在对称稳态 $s$ 处的雅可比矩阵 $J$，用 $s$、$n$、$\\alpha$ 和 $K$ 表示。\n- **任务2：** 解释雅可比矩阵的特征值与局部稳定性之间的关系，并确定霍普夫分岔的条件。\n- **任务3：** 编写一个程序，数值计算稳态，构建雅可比矩阵，计算其特征值，并通过检查是否存在具有严格正实部的共轭复数对来确定系统是否处于振荡状态。振荡状态输出 $1$，否则输出 $0$。\n- **测试集：** 六组参数 $(n, \\alpha, K)$ 的列表：$(2, 100.0, 1.0)$、$(3, 4.0, 1.0)$、$(4, 2.0, 1.0)$、$(4, 4.0, 1.0)$、$(5, 1.0, 0.1)$、$(3, 1.0, 1.0)$。\n- **最终输出格式：** 包含逗号分隔结果列表的单行，例如 $[\\text{result}_1,\\dots,\\text{result}_6]$。\n\n### 步骤2：使用提取的已知信息进行验证\n\n- **科学依据：** 该问题基于振荡器模型，这是合成生物学和系统生物学中一个基础且被广泛研究的系统。方程使用标准的希尔动力学来模拟转录抑制。通过雅可比矩阵分析局部稳定性是动力系统理论中的一种经典方法。该模型和方法在科学上是合理的。\n- **适定性：** 问题是适定的。它要求完成具体的、连续的任务：解析推导、理论解释和数值实现。稳态方程有唯一的正解，后续分析是确定性的。对于每组参数，这些任务都会产生唯一且有意义的结果。\n- **客观性：** 问题陈述使用了精确的数学和科学术语，没有主观或含糊不清的语言。\n- **完整性和一致性：** 提供了所有必要的信息（方程、定义、参数、任务和测试用例）。没有缺失数据或内部矛盾。\n- **可行性：** 任务在计算上和解析上都是可行的。参数是无量纲的，排除了物理上的不一致性。\n\n### 步骤3：结论与行动\n\n问题陈述是有效的，因为它具有科学依据、适定、客观、完整且可行。将提供完整的解决方案。\n\n### 解决方案\n\n对振荡器模型在其对称稳态附近的局域动力学分析涉及系统的线性化，这通过雅可比矩阵实现。该矩阵的特征值决定了稳态的稳定性。\n\n#### 任务1：雅可比矩阵的推导\n\n该常微分方程组可以写成向量形式 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x})$，其中 $\\mathbf{x} = [x, y, z]^T$ 且 $\\mathbf{F}(\\mathbf{x}) = [f_x(x,y,z), f_y(x,y,z), f_z(x,y,z)]^T$ 如下：\n$$\nf_x(x,y,z) = -x + \\frac{\\alpha}{1 + (z/K)^n} \\\\\nf_y(x,y,z) = -y + \\frac{\\alpha}{1 + (x/K)^n} \\\\\nf_z(x,y,z) = -z + \\frac{\\alpha}{1 + (y/K)^n}\n$$\n雅可比矩阵 $J$ 是向量函数 $\\mathbf{F}$ 的所有一阶偏导数组成的矩阵：\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial f_x}{\\partial x}  \\frac{\\partial f_x}{\\partial y}  \\frac{\\partial f_x}{\\partial z} \\\\\n\\frac{\\partial f_y}{\\partial x}  \\frac{\\partial f_y}{\\partial y}  \\frac{\\partial f_y}{\\partial z} \\\\\n\\frac{\\partial f_z}{\\partial x}  \\frac{\\partial f_z}{\\partial y}  \\frac{\\partial f_z}{\\partial z}\n\\end{pmatrix}\n$$\n我们计算各个偏导数：\n- 对角线元素很简单：$\\frac{\\partial f_x}{\\partial x} = -1$、$\\frac{\\partial f_y}{\\partial y} = -1$、$\\frac{\\partial f_z}{\\partial z} = -1$。\n- 非对角线元素捕捉了抑制相互作用。例如，$\\frac{\\partial f_x}{\\partial z}$ 为：\n$$\n\\frac{\\partial f_x}{\\partial z} = \\frac{\\partial}{\\partial z} \\left( \\alpha \\left[ 1 + \\left(\\frac{z}{K}\\right)^n \\right]^{-1} \\right) = -\\alpha \\left( 1 + \\left(\\frac{z}{K}\\right)^n \\right)^{-2} \\cdot n \\left(\\frac{z}{K}\\right)^{n-1} \\cdot \\frac{1}{K} = -\\frac{\\alpha n z^{n-1}}{K^n \\left( 1 + (z/K)^n \\right)^2}\n$$\n其他导数要么为零（例如 $\\frac{\\partial f_x}{\\partial y} = 0$），要么由系统的循环对称性得出：\n$$\n\\frac{\\partial f_y}{\\partial x} = -\\frac{\\alpha n x^{n-1}}{K^n \\left( 1 + (x/K)^n \\right)^2}, \\quad \\frac{\\partial f_z}{\\partial y} = -\\frac{\\alpha n y^{n-1}}{K^n \\left( 1 + (y/K)^n \\right)^2}\n$$\n现在，我们在对称稳态 $x = y = z = s$ 处计算该矩阵。矩阵元素变为：\n$$\nJ_{11} = J_{22} = J_{33} = -1 \\\\\nJ_{12} = J_{23} = J_{31} = 0\n$$\n由于对称性，其余元素均相等。我们用 $\\beta$ 表示这个共同的值：\n$$\n\\beta = J_{13} = J_{21} = J_{32} = -\\frac{\\alpha n s^{n-1}}{K^n \\left( 1 + (s/K)^n \\right)^2}\n$$\n在稳态下的雅可比矩阵 $J^*$ 为：\n$$\nJ^* = \\begin{pmatrix} -1  0  \\beta \\\\ \\beta  -1  0 \\\\ 0  \\beta  -1 \\end{pmatrix}\n$$\n我们可以利用稳态条件 $s = \\frac{\\alpha}{1 + (s/K)^n}$ 来简化 $\\beta$ 的表达式。这得到 $\\alpha = s(1+(s/K)^n)$。将此代入 $\\beta$ 的表达式中：\n$$\n\\beta = -\\frac{s(1+(s/K)^n) \\cdot n s^{n-1}}{K^n (1 + (s/K)^n)^2} = -\\frac{n s^n}{K^n (1 + (s/K)^n)} = -\\frac{n (s/K)^n}{1 + (s/K)^n}\n$$\n这是雅可比矩阵非对角线项关于 $s$、$n$ 和 $K$ 的最终表达式。\n\n#### 任务2：特征值解释与霍普夫分岔\n\n根据 Hartman-Grobman 定理，非线性动力系统在双曲不动点附近的行为与其在该点的线性化行为在性质上是相同的。线性化由系统 $\\frac{d(\\delta\\mathbf{x})}{dt} = J^* \\delta\\mathbf{x}$ 给出，其中 $\\delta\\mathbf{x}$ 是对不动点的一个小扰动。这个线性系统的解由雅可比矩阵 $J^*$ 的特征值 $\\lambda_i$ 决定。\n\n- 如果所有特征值的实部都为负，即对所有 $i$ 都有 $\\text{Re}(\\lambda_i)  0$，任何小扰动都将指数衰减，该不动点是局部渐近稳定的。\n- 如果至少有一个特征值的实部为正，即对某个 $j$ 有 $\\text{Re}(\\lambda_j) > 0$，沿着相应特征向量方向的扰动将会增长，使得该不动点不稳定。\n- 如果至少有一个特征值的实部为零，而所有其他特征值的实部都为负，则该不动点是非双曲的。这是一个临界点，系统的稳定性可能在此发生改变，这种现象称为分岔。\n\n当一对共轭复数特征值随着系统参数的变化而穿过虚轴时，就会发生霍普夫分岔（Hopf bifurcation）。具体来说，如果一对特征值为 $\\lambda = \\mu \\pm i\\omega$ 且 $\\omega \\neq 0$，当实部 $\\mu$ 穿过零时，分岔发生。如果 $\\mu$ 从负变正，稳定的不动点会失去其稳定性，并通常产生一个稳定的极限环，这对应于系统中的持续振荡。\n\n为了找到振荡器模型中霍普夫分岔的条件，我们计算 $J^*$ 的特征值。特征方程为 $\\det(J^* - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} -1-\\lambda  0  \\beta \\\\ \\beta  -1-\\lambda  0 \\\\ 0  \\beta  -1-\\lambda \\end{pmatrix} = (-1-\\lambda)\\left((-1-\\lambda)^2-0\\right) - 0 + \\beta(\\beta^2-0) = 0\n$$\n$$\n(-1-\\lambda)^3 + \\beta^3 = 0 \\implies (\\lambda+1)^3 = \\beta^3\n$$\n$\\lambda+1$ 的三个解是 $\\beta^3$ 的三次方根，即 $\\beta e^{i0}$、$\\beta e^{i2\\pi/3}$ 和 $\\beta e^{i4\\pi/3}$。回顾欧拉公式 $e^{i\\theta} = \\cos\\theta + i\\sin\\theta$，我们找到三个特征值：\n- $\\lambda_1+1 = \\beta \\implies \\lambda_1 = \\beta - 1$\n- $\\lambda_2+1 = \\beta(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}) \\implies \\lambda_2 = -1 - \\frac{\\beta}{2} + i\\frac{\\beta\\sqrt{3}}{2}$\n- $\\lambda_3+1 = \\beta(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}) \\implies \\lambda_3 = -1 - \\frac{\\beta}{2} - i\\frac{\\beta\\sqrt{3}}{2}$\n\n由于 $s, K > 0$ 且 $n \\ge 1$，项 $(s/K)^n$ 是正的。因此，$\\beta = -n\\frac{(s/K)^n}{1+(s/K)^n}$ 总是负的。\n- 第一个特征值的实部 $\\text{Re}(\\lambda_1) = \\beta - 1$ 因此总是负的。这个特征值总是起稳定作用。\n- 另外两个特征值 $\\lambda_2$ 和 $\\lambda_3$ 构成一个共轭复数对。它们的实部是 $\\text{Re}(\\lambda_{2,3}) = -1 - \\frac{\\beta}{2}$。\n\n当这个实部变为正时，系统变得不稳定并进入振荡状态：\n$$\n-1 - \\frac{\\beta}{2} > 0 \\implies -\\frac{\\beta}{2} > 1 \\implies \\beta  -2\n$$\n代入 $\\beta$ 的表达式：\n$$\n-\\frac{n (s/K)^n}{1 + (s/K)^n}  -2 \\implies \\frac{n (s/K)^n}{1 + (s/K)^n} > 2\n$$\n$$\nn(s/K)^n > 2(1 + (s/K)^n) \\implies (n-2)(s/K)^n > 2\n$$\n这就是振荡不稳定的条件。请注意，这要求 $n-2 > 0$，因此只有当希尔系数 $n > 2$ 时才可能出现振荡。\n\n#### 任务3：计算实现\n\n程序必须为每组参数 $(n, \\alpha, K)$ 实现以下逻辑：\n1.  数值求解对称稳态。为了方便，可以求解无量纲比率 $r = (s/K)^n$。将 $s = K r^{1/n}$ 代入稳态方程得到 $K r^{1/n} = \\frac{\\alpha}{1+r}$。这等效于找到函数 $g(r) = K r^{1/n} - \\frac{\\alpha}{1+r} = 0$ 在 $r > 0$ 时的根。该方程有唯一的正根。\n2.  找到 $r$ 的值后，评估在任务2中推导出的不稳定性条件：$(n-2)r > 2$。\n3.  如果满足该条件，则系统处于振荡状态，输出为 $1$。否则，输出为 $0$（包括特征值实部为零的边界情况 $(n-2)r = 2$）。\n此过程将使用 Python 编程，并利用 `scipy.optimize.root_scalar` 进行数值求根。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the stability of the repressilator symmetric steady state for a suite of test cases.\n    \"\"\"\n    # Test cases defined as tuples of (n, alpha, K)\n    test_cases = [\n        # (n, alpha, K)\n        (2.0, 100.0, 1.0),\n        (3.0, 4.0, 1.0),\n        (4.0, 2.0, 1.0),\n        (4.0, 4.0, 1.0),\n        (5.0, 1.0, 0.1),\n        (3.0, 1.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, alpha, K = case\n\n        # The condition for oscillatory instability is (n-2)r  2, where r = (s/K)^n.\n        # This is only possible if n  2. If n = 2, the system cannot oscillate.\n        if n = 2:\n            results.append(0)\n            continue\n\n        # Define the function whose root we need to find to determine the steady state.\n        # The equation for the steady state can be rewritten in terms of r = (s/K)^n as:\n        # K * r^(1/n) - alpha / (1 + r) = 0\n        def fixed_point_equation(r):\n            # To avoid potential domain errors for r near 0 with n  1\n            if r = 0:\n                return -alpha\n            return K * (r**(1/n)) - alpha / (1 + r)\n\n        # We need to find a bracketing interval [a, b] for the root r  0\n        # such that f(a) and f(b) have opposite signs.\n        # For a very small r (e.g., 1e-9), f(r) approaches -alpha, which is negative.\n        # So we need to find an upper bound b such that f(b)  0.\n        # The steady state s must be less than alpha. Thus, r = (s/K)^n  (alpha/K)^n.\n        # Let's check the value at r_upper = (alpha/K)^n.\n        # f(r_upper) = K * ((alpha/K)^n)^(1/n) - alpha / (1 + (alpha/K)^n)\n        #            = K * (alpha/K) - alpha / (1 + (alpha/K)^n)\n        #            = alpha * (1 - 1 / (1 + (alpha/K)^n))\n        #            = alpha * ((alpha/K)^n / (1 + (alpha/K)^n))  0.\n        # So, a root is guaranteed to exist in the interval (0, (alpha/K)^n).\n        bracket_a = 1e-9\n        bracket_b = (alpha / K)**n\n        \n        # It's possible for the bracket bounds to be extremely close for some parameters,\n        # so we'll add a small epsilon to the upper bound to ensure a valid interval.\n        if bracket_b = bracket_a:\n            bracket_b = bracket_a + 1.0\n\n        # Use a robust root-finding algorithm (Brent's method)\n        sol = root_scalar(fixed_point_equation, bracket=[bracket_a, bracket_b], method='brentq')\n        r_steady_state = sol.root\n\n        # Check the condition for oscillatory instability: (n - 2) * r  2.\n        # The problem asks for the real part to be strictly greater than zero,\n        # so we use a strict inequality.\n        if (n - 2) * r_steady_state > 2:\n            results.append(1)\n        else:\n            results.append(0)\n\n    # Format the final output as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "虽然特征值的实部为负通常意味着扰动会衰减，但这只描述了系统的长期渐近行为。在许多生物网络中，即使系统最终是稳定的，短期内也可能出现显著的瞬时放大（transient amplification）现象，这在“非正规”（non-normal）系统中尤为常见。这种瞬时增长对于理解细胞的兴奋性、信号放大和对噪声的鲁棒性至关重要。这项高阶练习将引导你显式地计算系统演化的矩阵指数 $\\exp(Jt)$ 及其范数，从而直观地观察并量化一个渐近稳定系统如何能够产生远超初始扰动的大幅瞬时响应 。",
            "id": "3321850",
            "problem": "一个双物种生物化学反应网络在一个稳定稳态附近被线性化，以获得由线性常微分方程 $\\frac{d x}{d t} = J x$ 控制的偏差向量 $x(t) \\in \\mathbb{R}^{2}$ 的局部动力学。$2 \\times 2$ 的雅可比矩阵 $J$ 为\n$$\nJ \\;=\\; \\begin{pmatrix} -1  100 \\\\ 0  -1 \\end{pmatrix}.\n$$\n在计算系统生物学中，局部流映射 $x(t) = \\exp(J t) x(0)$ 由矩阵指数 $\\exp(J t)$ 决定，而扰动的瞬时放大则由诱导矩阵 2-范数 $\\|\\exp(J t)\\|_{2}$（即 $\\exp(J t)$ 的最大奇异值）来量化。\n\n仅从以下事实出发：(i) 带有初始条件 $x(0)$ 的线性系统 $\\frac{d x}{d t} = J x$ 的解是 $x(t) = \\exp(J t) x(0)$，以及 (ii) 谱范数 $\\|A\\|_{2}$ 等于 $A$ 的最大奇异值，执行以下操作：\n\n1. 对所有实数 $t \\ge 0$，显式计算 $\\exp(J t)$。\n2. 使用关于奇异值的基本原理，推导 $\\|\\exp(J t)\\|_{2}$ 作为 $t$ 的函数的精确解析表达式，并用它来证明存在瞬时增长，即存在一个适中的 $t  0$ 区间，在此区间内 $\\|\\exp(J t)\\|_{2}  1$，尽管 $J$ 的所有特征值都具有负实部。\n3. 从机理上解释为什么大的非对角元 $100$ 会导致这个双物种系统中的非正规瞬时放大。\n\n最后，对于这个特定的矩阵 $J$，确定 $\\|\\exp(J t)\\|_{2}$ 在 $t \\ge 0$ 上的上确界（以初等函数表示）的精确闭式表达式，并将该单一表达式作为您的最终答案报告。放大因子是无量纲的，因此不需要单位。不要四舍五入；请提供精确的符号结果。",
            "solution": "此问题需经过验证。\n\n### 步骤 1：提取已知条件\n- 系统动力学由线性常微分方程 $\\frac{d x}{d t} = J x$ 描述，其中偏差向量为 $x(t) \\in \\mathbb{R}^{2}$。\n- 雅可比矩阵为 $J = \\begin{pmatrix} -1  100 \\\\ 0  -1 \\end{pmatrix}$。\n- 系统解是局部流映射 $x(t) = \\exp(J t) x(0)$。\n- 瞬时放大由诱导矩阵 2-范数 $\\|\\exp(J t)\\|_{2}$ 量化。\n- 谱范数的定义已给出：$\\|A\\|_{2}$ 是 $A$ 的最大奇异值。\n- 时间变量为非负数，$t \\ge 0$。\n- 任务是：(1) 显式计算 $\\exp(J t)$。(2) 推导 $\\|\\exp(J t)\\|_{2}$ 的解析表达式并证明瞬时增长。(3) 为瞬时放大提供机理上的解释。(4) 确定 $\\sup_{t \\ge 0} \\|\\exp(J t)\\|_{2}$ 的精确闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础：** 该问题基于线性系统理论、矩阵分析及其在 linearized 生物化学反应网络中的应用的基本原理。非正规矩阵尽管渐近稳定但仍导致瞬时增长的概念，在计算系统生物学和动力系统中是一个已得到充分证明且重要的课题。给定的雅可比矩阵代表了一个简单的、物理上合理的相互作用模式（例如，一个物种会衰减，但同时被另一个衰减的物种强烈催化生成）。\n- **适定性：** 所有必需信息均已提供。矩阵 $J$ 被完全指定，任务是标准的数学计算，会导出一个唯一的、明确定义的解。\n- **客观性：** 问题使用精确的数学语言陈述，没有主观或含糊的术语。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它在数学上是合理的，具有科学相关性，并且是适定的。将提供完整的解答。\n\n### 解答\n\n解答过程将处理问题的四个要求部分。\n\n**1. 矩阵指数 $\\exp(J t)$ 的计算**\n\n雅可比矩阵为 $J = \\begin{pmatrix} -1  100 \\\\ 0  -1 \\end{pmatrix}$。我们可以将 $J$ 分解为一个对角矩阵 $D$ 和一个幂零矩阵 $N$ 的和。\n令 $D = -1 \\cdot I = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}$ 和 $N = \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix}$。\n则 $J = D + N$。我们必须检查 $D$ 和 $N$ 是否交换：\n$$DN = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -100 \\\\ 0  0 \\end{pmatrix}$$\n$$ND = \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 0  -100 \\\\ 0  0 \\end{pmatrix}$$\n由于 $DN = ND$，我们可以使用性质 $\\exp(J t) = \\exp((D+N)t) = \\exp(Dt)\\exp(Nt)$。\n\n对角部分的指数为：\n$$\\exp(Dt) = \\exp(-It) = \\exp(-t) I = \\begin{pmatrix} \\exp(-t)  0 \\\\ 0  \\exp(-t) \\end{pmatrix}$$\n\n对于幂零部分，我们计算其幂次：\n$$N^2 = \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$$\n由于 $N^2$ 是零矩阵，所有更高次的幂 $N^k$（对于 $k \\ge 2$）也都是零。因此 $\\exp(Nt)$ 的泰勒级数是截断的：\n$$\\exp(Nt) = I + Nt + \\frac{(Nt)^2}{2!} + \\dots = I + Nt = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + t\\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix}$$\n\n结合这些结果，我们得到 $\\exp(Jt)$ 的显式形式：\n$$\\exp(Jt) = \\exp(Dt)\\exp(Nt) = \\begin{pmatrix} \\exp(-t)  0 \\\\ 0  \\exp(-t) \\end{pmatrix} \\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\exp(-t)  100t \\exp(-t) \\\\ 0  \\exp(-t) \\end{pmatrix}$$\n\n**2. $\\|\\exp(J t)\\|_{2}$ 的推导及瞬时增长的证明**\n\n范数 $\\|\\exp(J t)\\|_{2}$ 是 $\\exp(J t)$ 的最大奇异值，由 $\\sigma_{\\max} = \\sqrt{\\lambda_{\\max}(A^T A)}$ 给出，其中 $A = \\exp(J t)$。\n首先，我们计算乘积 $A^T A$：\n$$A = \\exp(-t)\\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix}$$\n$$A^T A = \\left( \\exp(-t)\\begin{pmatrix} 1  0 \\\\ 100t  1 \\end{pmatrix} \\right) \\left( \\exp(-t)\\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix} \\right) = \\exp(-2t)\\begin{pmatrix} 1  100t \\\\ 100t  1+(100t)^2 \\end{pmatrix}$$\n为了找到 $A^T A$ 的特征值，我们先找到矩阵 $M = \\begin{pmatrix} 1  100t \\\\ 100t  1+(100t)^2 \\end{pmatrix}$ 的特征值。特征方程为 $\\det(M-\\lambda I) = 0$：\n$$(1-\\lambda)(1+(100t)^2-\\lambda) - (100t)^2 = 0$$\n$$\\lambda^2 - (2+(100t)^2)\\lambda + (1+(100t)^2) - (100t)^2 = 0$$\n$$\\lambda^2 - (2+(100t)^2)\\lambda + 1 = 0$$\n$M$ 的最大特征值由二次方程求根公式给出：\n$$\\lambda_{\\max}(M) = \\frac{2+(100t)^2 + \\sqrt{(2+(100t)^2)^2 - 4}}{2} = \\frac{2+(100t)^2 + \\sqrt{(100t)^4 + 4(100t)^2}}{2}$$\n$$\\lambda_{\\max}(M) = \\frac{2+(100t)^2 + 100t\\sqrt{(100t)^2+4}}{2}$$\n$A^T A$ 的最大特征值是 $\\lambda_{\\max}(A^T A) = \\exp(-2t)\\lambda_{\\max}(M)$。范数是它的平方根：\n$$\\|\\exp(J t)\\|_{2} = \\sqrt{\\exp(-2t)\\lambda_{\\max}(M)} = \\exp(-t)\\sqrt{\\frac{2+(100t)^2 + 100t\\sqrt{(100t)^2+4}}{2}}$$\n为了证明瞬时增长，我们证明范数在 $t>0$ 的初始阶段是增加的。在 $t=0$ 时，$\\|\\exp(J \\cdot 0)\\|_{2} = \\|I\\|_{2} = 1$。一个系统的初始增长率由其雅可比矩阵的对称部分 $J_S = \\frac{1}{2}(J+J^T)$ 的最大特征值决定。如果此特征值为正，则范数在初始时会增长。\n对于本例中的 $J$，其对称部分是 $J_S = \\frac{1}{2}(J+J^T) = \\frac{1}{2}\\begin{pmatrix} -2  100 \\\\ 100  -2 \\end{pmatrix} = \\begin{pmatrix} -1  50 \\\\ 50  -1 \\end{pmatrix}$。\n$J_S$ 的特征值由特征方程 $(-1-\\lambda)^2 - 50^2 = 0$ 给出，所以 $\\lambda+1 = \\pm 50$，得到特征值为 $\\lambda_1=49$ 和 $\\lambda_2=-51$。$J_S$ 的最大特征值是 $49$，为正数。因此，$\\|\\exp(Jt)\\|_2$ 最初会从 $1$ 开始增加，表现出瞬时增长。\n$J$ 的特征值为 $\\lambda_1 = \\lambda_2 = -1$。由于所有特征值的实部都为负，系统是渐近稳定的，即 $\\lim_{t\\to\\infty} \\|\\exp(Jt)\\|_2 = 0$。初始增长后最终衰减是稳定的非正规系统的决定性特征。非正规性由 $J J^\\top \\neq J^\\top J$ 证实。\n\n**3. 机理上的解释**\n\n该微分方程系统为：\n$$\\frac{dx_1}{dt} = -x_1 + 100x_2$$\n$$\\frac{dx_2}{dt} = -x_2$$\n物种 $1$ ($x_1$) 和物种 $2$ ($x_2$) 都以速率常数 $1$ 进行一阶降解。然而，物种 $2$ 对物种 $1$ 起着强烈的激活作用，耦合常数高达 $100$。\n$x_2(t)$ 的解是一个简单的指数衰减：$x_2(t) = x_2(0)\\exp(-t)$。\n将此代入 $x_1$ 的方程中得到：$\\frac{dx_1}{dt} + x_1 = 100 x_2(0) \\exp(-t)$。\n解为 $x_1(t) = (x_1(0) + 100 x_2(0) t)\\exp(-t)$。\n考虑一个仅在物种 $2$ 上的初始扰动：$x(0) = \\begin{pmatrix} 0 \\\\ \\epsilon \\end{pmatrix}$。在时间 $t$ 的状态为 $x(t) = \\begin{pmatrix} 100 \\epsilon t \\exp(-t) \\\\ \\epsilon \\exp(-t) \\end{pmatrix}$。\n该状态向量的范数 $\\|x(t)\\|_2 = \\epsilon \\exp(-t) \\sqrt{(100t)^2+1}$，可以变得比初始范数 $\\|x(0)\\|_2 = \\epsilon$ 大得多。$100t\\exp(-t)$ 项表明，$x_1$ 的浓度最初随时间线性放大，并带有一个 $100$ 的大因子。这种由 $x_2$ 对 $x_1$ 的“泵送”作用导致系统状态出现大的瞬时偏移，之后在 $t$ 较大时，指数衰减项 $\\exp(-t)$ 占主导地位，将系统带回原点的稳态。这种一个状态变量被另一个同时衰减的状态变量放大的机制，是非正规系统中具有“剪切流”特征的放大现象。\n\n**4. $\\|\\exp(J t)\\|_{2}$ 的上确界**\n\n为了找到 $\\|\\exp(J t)\\|_{2}$ 的最大值，我们简化其表达式。令 $u = 100t$。我们使用双曲替换 $u = 2\\sinh(\\theta)$，所以 $t = \\frac{1}{50}\\sinh(\\theta)$ 且 $\\theta = \\arcsinh(50t)$。\n在这种替换下，$\\lambda_{\\max}(M)$ 的表达式大大简化：\n$$100t\\sqrt{(100t)^2+4} = 2\\sinh(\\theta)\\sqrt{4\\sinh^2(\\theta)+4} = 2\\sinh(\\theta)(2\\cosh(\\theta)) = 2\\sinh(2\\theta)$$\n$$(100t)^2 = 4\\sinh^2(\\theta) = 2(\\cosh(2\\theta)-1)$$\n$$\\lambda_{\\max}(M) = \\frac{2 + 2(\\cosh(2\\theta)-1) + 2\\sinh(2\\theta)}{2} = \\cosh(2\\theta) + \\sinh(2\\theta) = \\exp(2\\theta)$$\n现在，将此代回范数表达式：\n$$\\|\\exp(J t)\\|_{2} = \\exp(-t)\\sqrt{\\exp(2\\theta)} = \\exp(-t)\\exp(\\theta) = \\exp(\\theta-t)$$\n代入 $\\theta$ 和 $t$ 的定义：\n$$F(t) = \\|\\exp(Jt)\\|_2 = \\exp(\\arcsinh(50t) - t)$$\n为了找到最大值，我们可以最大化指数部分 $G(t) = \\arcsinh(50t) - t$。我们通过将其导数设为零来找到临界点：\n$$G'(t) = \\frac{d}{dt}(\\arcsinh(50t)) - 1 = \\frac{50}{\\sqrt{(50t)^2+1}} - 1$$\n令 $G'(t)=0$ 得到：\n$$\\frac{50}{\\sqrt{(50t)^2+1}} = 1 \\implies 50 = \\sqrt{2500t^2+1}$$\n$$2500 = 2500t^2+1 \\implies 2500t^2 = 2499 \\implies t^2 = \\frac{2499}{2500}$$\n最大放大的时间为 $t_{\\max} = \\sqrt{\\frac{2499}{2500}} = \\frac{\\sqrt{2499}}{50}$。我们可以简化 $\\sqrt{2499} = \\sqrt{3 \\cdot 833} = \\sqrt{3 \\cdot 7 \\cdot 119} = \\sqrt{3 \\cdot 7 \\cdot 7 \\cdot 17} = 7\\sqrt{51}$。\n所以，$t_{\\max} = \\frac{7\\sqrt{51}}{50}$。\n最大值通过计算 $F(t_{\\max})$ 获得：\n$$\\sup_{t \\ge 0} \\|\\exp(J t)\\|_{2} = F(t_{\\max}) = \\exp(\\arcsinh(50 t_{\\max}) - t_{\\max})$$\n在 $t_{\\max}$ 处，我们有 $50t_{\\max} = 7\\sqrt{51}$。所以我们需要计算 $\\arcsinh(7\\sqrt{51})$。\n使用对数恒等式 $\\arcsinh(z) = \\ln(z+\\sqrt{z^2+1})$：\n$$\\arcsinh(7\\sqrt{51}) = \\ln(7\\sqrt{51} + \\sqrt{(7\\sqrt{51})^2+1}) = \\ln(7\\sqrt{51} + \\sqrt{2499+1}) = \\ln(7\\sqrt{51} + \\sqrt{2500}) = \\ln(50+7\\sqrt{51})$$\n因此，指数部分为 $\\ln(50+7\\sqrt{51}) - \\frac{7\\sqrt{51}}{50}$。\n上确界是：\n$$\\exp\\left(\\ln(50+7\\sqrt{51}) - \\frac{7\\sqrt{51}}{50}\\right) = (50+7\\sqrt{51})\\exp\\left(-\\frac{7\\sqrt{51}}{50}\\right)$$\n这是最大放大因子的最终精确表达式。",
            "answer": "$$\n\\boxed{(50+7\\sqrt{51})\\exp\\left(-\\frac{7\\sqrt{51}}{50}\\right)}\n$$"
        }
    ]
}