{
    "hands_on_practices": [
        {
            "introduction": "This first practice serves as a fundamental exercise in calculating the most direct measure of a node's importance: degree centrality. Using a star graph, a common motif in biological networks representing a master regulator, you will apply the formal definition of normalized degree centrality. This exercise is designed to demonstrate both the power of degree centrality in identifying highly connected hubs and its inherent limitation as a purely local measure, blind to the larger network context.",
            "id": "3294657",
            "problem": "Consider a Protein-Protein Interaction (PPI) network that is topologically a star graph with $N$ nodes, modeling a single master regulator protein $h$ interacting with $N-1$ peripheral proteins $\\{ \\ell_{1}, \\ell_{2}, \\dots, \\ell_{N-1} \\}$. The network is undirected, simple (no self-loops or multi-edges), and unweighted. Let the graph be $G = (V, E)$ with $V = \\{ h \\} \\cup \\{ \\ell_{1}, \\ell_{2}, \\dots, \\ell_{N-1} \\}$ and $E = \\{ (h, \\ell_{j}) : j = 1, 2, \\dots, N-1 \\}$.\n\nUsing only first principles from graph theory appropriate for computational systems biology, compute the degree centrality for each node under the normalization that scales by the maximum possible degree in a simple undirected graph on $N$ nodes. Then, analyze why this degree-based measure correctly identifies the hub $h$ but is insensitive to any structural differences among the leaves $\\{ \\ell_{j} \\}$ that might arise from biological heterogeneity (for example, differences in downstream pathway roles), even though such differences are relevant in biological interpretation.\n\nExpress your final answer as a single closed-form analytic expression for the normalized degree centrality $C_{D}(i)$ of an arbitrary node $i \\in V$ in terms of $N$ and an indicator that distinguishes whether $i$ is the hub $h$ or a leaf. No rounding is required. The final value is dimensionless.",
            "solution": "The problem statement is scientifically grounded, self-contained, and well-posed. It rests on fundamental, unambiguous definitions from graph theory and their standard application in computational systems biology. We may therefore proceed with a formal solution.\n\nThe problem describes a protein-protein interaction network as a star graph $G = (V, E)$ with $N$ nodes. The vertex set is given by $V = \\{ h \\} \\cup \\{ \\ell_{1}, \\ell_{2}, \\dots, \\ell_{N-1} \\}$, where $h$ is the central hub node and $\\{ \\ell_{j} \\}_{j=1}^{N-1}$ represents the set of $N-1$ peripheral leaf nodes. The total number of nodes is $|V| = N$. The edge set is $E = \\{ (h, \\ell_{j}) : j = 1, 2, \\dots, N-1 \\}$, indicating that the hub $h$ is connected to every leaf node, and there are no edges between any two leaf nodes. The graph is simple and undirected.\n\nOur first task is to compute the degree of each node. The degree of a node $i$, denoted $\\deg(i)$, is the number of edges incident to it.\nFor the central hub node $h$, it is connected to all $N-1$ leaf nodes. Its degree is therefore:\n$$\n\\deg(h) = N-1\n$$\nFor any peripheral leaf node $\\ell_{j}$, where $j \\in \\{1, 2, \\dots, N-1\\}$, it is connected only to the single hub node $h$. Its degree is therefore:\n$$\n\\deg(\\ell_{j}) = 1\n$$\n\nNext, we compute the normalized degree centrality, $C_{D}(i)$. The problem specifies normalization by the maximum possible degree in a simple undirected graph with $N$ nodes. For a graph with $N$ vertices, any single vertex can be connected to at most the other $N-1$ vertices. Thus, the maximum possible degree is $N-1$.\nThe normalized degree centrality of a node $i$ is defined as the ratio of its degree to this maximum possible degree:\n$$\nC_{D}(i) = \\frac{\\deg(i)}{N-1}\n$$\n\nApplying this formula to the nodes of the star graph:\nFor the hub node $h$:\n$$\nC_{D}(h) = \\frac{\\deg(h)}{N-1} = \\frac{N-1}{N-1} = 1\n$$\nFor any leaf node $\\ell_{j}$:\n$$\nC_{D}(\\ell_{j}) = \\frac{\\deg(\\ell_{j})}{N-1} = \\frac{1}{N-1}\n$$\n\nThe second part of the task is to analyze the properties of this measure.\nThe degree centrality measure successfully identifies the hub $h$ as the most central node. Its centrality value, $C_{D}(h) = 1$, is the maximum possible value in any simple graph, while the centrality of any leaf node is $C_{D}(\\ell_{j}) = \\frac{1}{N-1}$. For any non-trivial star graph (i.e., $N > 2$), we have $1 > \\frac{1}{N-1}$, so the hub's centrality is strictly greater than that of any other node.\n\nThe measure's insensitivity to differences among the leaves is a direct consequence of its definition. Degree is a purely local measure of connectivity; it only counts the number of direct neighbors of a node. In the star graph topology, every leaf node $\\ell_{j}$ is structurally identical from a local perspective: each is a node of degree $1$ connected to a single neighbor (the hub). Consequently, their degree centralities are all identical, $C_{D}(\\ell_{j}) = \\frac{1}{N-1}$. This measure is therefore blind to any potential \"biological heterogeneity\" or differences in functional roles (e.g., downstream pathway involvement) among the proteins represented by the leaf nodes, as these roles are not encoded in the immediate local topology. This limitation illustrates why more global centrality measures, which account for paths and positions within the entire network structure, are often required to obtain a more nuanced understanding of node importance in biological networks.\n\nTo express the normalized degree centrality $C_{D}(i)$ for an arbitrary node $i \\in V$ as a single closed-form expression, we introduce an indicator function. Let $\\delta_{i,h}$ be the Kronecker delta, defined such that $\\delta_{i,h} = 1$ if node $i$ is the hub $h$, and $\\delta_{i,h} = 0$ if node $i$ is a leaf node. We can then write a general expression for $C_D(i)$ by combining the results for the two cases:\n$$\nC_{D}(i) = (1) \\cdot \\delta_{i,h} + \\left(\\frac{1}{N-1}\\right) \\cdot (1 - \\delta_{i,h})\n$$\nThis expression can be simplified to a more compact form:\n$$\nC_{D}(i) = \\delta_{i,h} + \\frac{1 - \\delta_{i,h}}{N-1}\n$$\nThis single, compact expression correctly yields the centrality for any node $i$ in the graph given its identity, fulfilling the requirements of the problem.",
            "answer": "$$\n\\boxed{\\delta_{i,h} + \\frac{1 - \\delta_{i,h}}{N-1}}\n$$"
        },
        {
            "introduction": "Moving beyond local connectivity, this next exercise challenges you to compute betweenness centrality, a measure that quantifies a node's importance as a \"bridge\" in network pathways. The problem uses a weighted triangular motif, requiring careful application of the shortest path definition where path lengths are determined by edge weights. This practice specifically illuminates a crucial subtlety: how the betweenness centrality calculation accounts for ties when multiple shortest paths exist between two nodes.",
            "id": "3294601",
            "problem": "Consider an undirected, weighted network motif representing three signaling proteins $v_{1}$, $v_{2}$, and $v_{3}$ interacting in a pathway. Edge weights represent effective path lengths (for example, composite delays or resistances to signal flow) and are strictly positive. The motif is a triangle with one heavy edge: the edges and their weights are $(v_{1},v_{2})$ with weight $4$, $(v_{1},v_{3})$ with weight $2$, and $(v_{2},v_{3})$ with weight $2$. Assume that weighted shortest paths are defined by minimizing the sum of edge weights along a path, and that betweenness centrality counts contributions only from paths in which the node is strictly intermediate between source and target (endpoints do not contribute to their own betweenness).\n\nStarting from the foundational definition of geodesic paths in weighted graphs and the combinatorial notion of betweenness centrality in terms of counts of geodesics, compute the betweenness centrality $C_{B}(v)$ for each node $v \\in \\{v_{1},v_{2},v_{3}\\}$ in this motif. In your reasoning, explain how ties in shortest paths affect the contributions to betweenness for intermediate nodes.\n\nExpress your final numerical answer as a row vector in the order $v_{1}$, $v_{2}$, $v_{3}$. No rounding is required.",
            "solution": "The problem statement has been validated and is deemed valid. It is a well-posed, scientifically grounded problem in graph theory and network analysis, providing all necessary information for a unique solution.\n\nThe problem requires the computation of the betweenness centrality, $C_B(v)$, for each node $v$ in a given three-node weighted, undirected graph. The nodes are $v_1$, $v_2$, and $v_3$. The edge weights, representing effective path lengths, are given as $w(v_1, v_2) = 4$, $w(v_1, v_3) = 2$, and $w(v_2, v_3) = 2$.\n\nThe betweenness centrality of a node $v$ is defined as the sum of the fractions of all-pairs shortest paths that pass through $v$. For an unnormalized centrality in an undirected graph, the formula is:\n$$C_B(v) = \\sum_{s \\neq v \\neq t} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}$$\nwhere the sum is over all distinct unordered pairs of nodes $\\{s,t\\}$ not including $v$. Here, $\\sigma_{st}$ is the total number of shortest paths (geodesics) between nodes $s$ and $t$, and $\\sigma_{st}(v)$ is the number of those shortest paths that pass through node $v$.\n\nTo calculate the centrality for each node, we must first identify all shortest paths between all pairs of nodes in the graph. The graph has $\\binom{3}{2} = 3$ pairs of nodes: $\\{v_1, v_2\\}$, $\\{v_1, v_3\\}$, and $\\{v_2, v_3\\}$.\n\n1.  **Shortest paths between $v_1$ and $v_2$:**\n    There are two possible paths between $v_1$ and $v_2$:\n    *   The direct path $(v_1, v_2)$ has a length equal to its weight, which is $w(v_1, v_2) = 4$.\n    *   The indirect path through $v_3$, i.e., $(v_1, v_3, v_2)$, has a total length of $w(v_1, v_3) + w(v_3, v_2) = 2 + 2 = 4$.\n    Since both paths have the same minimal length of $4$, there are two shortest paths between $v_1$ and $v_2$. Thus, $\\sigma_{v_1, v_2} = 2$.\n\n2.  **Shortest paths between $v_1$ and $v_3$:**\n    There are two possible paths between $v_1$ and $v_3$:\n    *   The direct path $(v_1, v_3)$ has a length of $w(v_1, v_3) = 2$.\n    *   The indirect path through $v_2$, i.e., $(v_1, v_2, v_3)$, has a total length of $w(v_1, v_2) + w(v_2, v_3) = 4 + 2 = 6$.\n    The path of minimal length is the direct one. Therefore, there is only one shortest path between $v_1$ and $v_3$. Thus, $\\sigma_{v_1, v_3} = 1$.\n\n3.  **Shortest paths between $v_2$ and $v_3$:**\n    There are two possible paths between $v_2$ and $v_3$:\n    *   The direct path $(v_2, v_3)$ has a length of $w(v_2, v_3) = 2$.\n    *   The indirect path through $v_1$, i.e., $(v_2, v_1, v_3)$, has a total length of $w(v_2, v_1) + w(v_1, v_3) = 4 + 2 = 6$.\n    The path of minimal length is the direct one. Therefore, there is only one shortest path between $v_2$ and $v_3$. Thus, $\\sigma_{v_2, v_3} = 1$.\n\nNow, we can compute the betweenness centrality for each node.\n\n**Betweenness Centrality of $v_1$, $C_B(v_1)$:**\nThe node $v_1$ can only be an intermediary for paths between $v_2$ and $v_3$. The contribution to $C_B(v_1)$ is $\\frac{\\sigma_{v_2, v_3}(v_1)}{\\sigma_{v_2, v_3}}$.\nWe found that there is only one shortest path between $v_2$ and $v_3$, which is the direct edge $(v_2, v_3)$. This path does not pass through $v_1$.\nTherefore, $\\sigma_{v_2, v_3}(v_1) = 0$.\nThe contribution is $\\frac{0}{1} = 0$.\nSo, $C_B(v_1) = 0$.\n\n**Betweenness Centrality of $v_2$, $C_B(v_2)$:**\nThe node $v_2$ can only be an intermediary for paths between $v_1$ and $v_3$. The contribution to $C_B(v_2)$ is $\\frac{\\sigma_{v_1, v_3}(v_2)}{\\sigma_{v_1, v_3}}$.\nWe found that there is only one shortest path between $v_1$ and $v_3$, which is the direct edge $(v_1, v_3)$. This path does not pass through $v_2$.\nTherefore, $\\sigma_{v_1, v_3}(v_2) = 0$.\nThe contribution is $\\frac{0}{1} = 0$.\nSo, $C_B(v_2) = 0$.\n\n**Betweenness Centrality of $v_3$, $C_B(v_3)$:**\nThe node $v_3$ can only be an intermediary for paths between $v_1$ and $v_2$. The contribution to $C_B(v_3)$ is $\\frac{\\sigma_{v_1, v_2}(v_3)}{\\sigma_{v_1, v_2}}$.\nWe found there are two shortest paths between $v_1$ and $v_2$: the direct path $(v_1, v_2)$ and the indirect path $(v_1, v_3, v_2)$.\nOf these two paths, only the path $(v_1, v_3, v_2)$ passes through $v_3$.\nTherefore, the number of shortest paths passing through $v_3$ is $\\sigma_{v_1, v_2}(v_3) = 1$.\nThe total number of shortest paths is $\\sigma_{v_1, v_2} = 2$.\nThe contribution is $\\frac{1}{2}$.\nSo, $C_B(v_3) = \\frac{1}{2}$.\n\nThis calculation illustrates the effect of ties in shortest paths. When multiple geodesics exist between a source-target pair, an intermediate node on only a subset of these paths receives a fractional credit, which is diluted compared to a scenario where it lies on all shortest paths. Here, $v_3$ lies on only one of the two shortest paths between $v_1$ and $v_2$, so its betweenness contribution from this pair is $\\frac{1}{2}$ rather than $1$.\n\nThe final results for the betweenness centralities are:\n$C_B(v_1) = 0$\n$C_B(v_2) = 0$\n$C_B(v_3) = \\frac{1}{2}$\n\nExpressing this as a row vector in the specified order $(v_1, v_2, v_3)$ yields $\\begin{pmatrix} 0 & 0 & \\frac{1}{2} \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "To complete our exploration, this practice introduces eigenvector centrality, a sophisticated measure that defines a node's influence recursively: a node is important if it is connected to other important nodes. By revisiting the star graph topology from our first exercise , you will derive eigenvector centrality from its foundational eigenvalue equation. This direct comparison against degree centrality provides a sharp, quantitative understanding of how these different measures can lead to distinct conclusions about a node's role and influence within a network.",
            "id": "3294654",
            "problem": "In a computational systems biology analysis of a gene regulatory module, consider an undirected, unweighted star network representing a transcription factor hub regulating target genes: a single hub node regulates $N-1$ targets, with no other interactions among targets. This network is the star graph $K_{1,N-1}$ on $N$ nodes. Let $A$ denote its adjacency matrix. \n\nUse only the following foundational definitions:\n- The eigenvector centrality vector $x$ is any positive vector satisfying $A x = \\lambda x$, where $\\lambda$ is the largest eigenvalue of $A$.\n- The degree centrality $k_{i}$ of node $i$ is the number of its neighbors.\n\nDerive, from first principles, the eigenvector centrality ratio of the hub to any leaf, and the degree centrality ratio of the hub to any leaf. Then define the comparative discriminative factor $R(N)$ as the ratio of these two ratios:\n$$\nR(N) \\equiv \\frac{\\text{(hub-to-leaf eigenvector centrality ratio)}}{\\text{(hub-to-leaf degree centrality ratio)}}.\n$$\nProvide a closed-form analytic expression for $R(N)$ in terms of $N$. Express your final answer as a single exact expression; no rounding is required and no units apply.",
            "solution": "The problem asks for a closed-form analytic expression for the comparative discriminative factor $R(N)$ for a star network $K_{1,N-1}$. This factor is defined as the ratio of the hub-to-leaf eigenvector centrality ratio to the hub-to-leaf degree centrality ratio. We will derive this expression from the first principles and definitions provided.\n\nLet the set of nodes be $V = \\{v_1, v_2, \\dots, v_N\\}$. We designate $v_1$ as the central hub node and $\\{v_2, \\dots, v_N\\}$ as the $N-1$ peripheral leaf nodes. The graph is undirected and unweighted. Edges exist only between the hub and each leaf. The adjacency matrix $A$ of size $N \\times N$ can be written, with the hub as the first index, as:\n$$\nA_{ij} =\n\\begin{cases}\n1 & \\text{if } i=1, j > 1 \\\\\n1 & \\text{if } j=1, i > 1 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nIn block matrix form, this is $A = \\begin{pmatrix} 0 & \\mathbf{1}_{N-1}^T \\\\ \\mathbf{1}_{N-1} & \\mathbf{0}_{N-1 \\times N-1} \\end{pmatrix}$, where $\\mathbf{1}_{N-1}$ is a column vector of $N-1$ ones and $\\mathbf{0}_{N-1 \\times N-1}$ is the $(N-1) \\times (N-1)$ zero matrix. This analysis is valid for $N \\ge 2$.\n\nFirst, we calculate the degree centrality for the hub and leaf nodes. The degree centrality $k_i$ of a node $v_i$ is the number of its neighbors, which is the sum of the entries in the $i$-th row of the adjacency matrix.\n\nFor the hub node, $v_1$:\n$$\nk_{hub} = k_1 = \\sum_{j=1}^{N} A_{1j} = \\sum_{j=2}^{N} 1 = N-1\n$$\n\nFor any leaf node, $v_i$ where $i \\in \\{2, \\dots, N\\}$:\n$$\nk_{leaf} = k_i = \\sum_{j=1}^{N} A_{ij} = A_{i1} = 1\n$$\n\nThe hub-to-leaf degree centrality ratio is therefore:\n$$\n\\frac{k_{hub}}{k_{leaf}} = \\frac{N-1}{1} = N-1\n$$\n\nNext, we calculate the eigenvector centrality. According to the definition provided, the eigenvector centrality vector $x = (x_1, x_2, \\dots, x_N)^T$ is a positive vector that is an eigenvector of the adjacency matrix $A$ corresponding to the largest eigenvalue $\\lambda$. The equation is $Ax = \\lambda x$.\n\nDue to the symmetry of the star graph, all leaf nodes are topologically equivalent. Thus, their eigenvector centrality components must be equal. Let $x_1 = x_{hub}$ be the centrality of the hub, and let $x_i = x_{leaf}$ for all $i \\in \\{2, \\dots, N\\}$.\n\nWe can write the matrix equation $Ax = \\lambda x$ as a system of scalar equations:\nFor the hub node ($i=1$):\n$$\n\\sum_{j=1}^{N} A_{1j} x_j = \\lambda x_1 \\implies \\sum_{j=2}^{N} x_j = \\lambda x_1\n$$\nSubstituting $x_j=x_{leaf}$ for $j=2, \\dots, N$ and $x_1=x_{hub}$, we get:\n$$\n(N-1) x_{leaf} = \\lambda x_{hub} \\quad (1)\n$$\n\nFor any leaf node (e.g., $i=2$):\n$$\n\\sum_{j=1}^{N} A_{2j} x_j = \\lambda x_2 \\implies A_{21} x_1 = \\lambda x_2\n$$\nSubstituting $x_1=x_{hub}$ and $x_2=x_{leaf}$, we get:\n$$\nx_{hub} = \\lambda x_{leaf} \\quad (2)\n$$\n\nWe now have a system of two linear equations for $x_{hub}$ and $x_{leaf}$. To find the eigenvalue $\\lambda$, we substitute equation $(2)$ into equation $(1)$:\n$$\n(N-1) x_{leaf} = \\lambda (\\lambda x_{leaf}) = \\lambda^2 x_{leaf}\n$$\nSince eigenvector centrality is defined for a positive vector $x$, we must have $x_{leaf} > 0$. We can thus divide by $x_{leaf}$:\n$$\n\\lambda^2 = N-1\n$$\nThis gives two possible eigenvalues, $\\lambda = \\sqrt{N-1}$ and $\\lambda = -\\sqrt{N-1}$. The adjacency matrix of a connected graph has a unique largest eigenvalue, which is positive, as guaranteed by the Perron-Frobenius theorem. Therefore, the largest eigenvalue is:\n$$\n\\lambda_{max} = \\sqrt{N-1}\n$$\n\nNow we find the eigenvector centralities using this eigenvalue. From equation $(2)$:\n$$\nx_{hub} = \\lambda_{max} \\cdot x_{leaf} = \\sqrt{N-1} \\cdot x_{leaf}\n$$\nThe hub-to-leaf eigenvector centrality ratio is the ratio of their corresponding components in the eigenvector:\n$$\n\\frac{x_{hub}}{x_{leaf}} = \\frac{\\sqrt{N-1} \\cdot x_{leaf}}{x_{leaf}} = \\sqrt{N-1}\n$$\n\nFinally, we compute the comparative discriminative factor $R(N)$ using its definition:\n$$\nR(N) = \\frac{\\text{(hub-to-leaf eigenvector centrality ratio)}}{\\text{(hub-to-leaf degree centrality ratio)}}\n$$\nSubstituting the two ratios we derived:\n$$\nR(N) = \\frac{\\sqrt{N-1}}{N-1}\n$$\nThis expression can be simplified by recognizing that $N-1 = (\\sqrt{N-1})^2$:\n$$\nR(N) = \\frac{\\sqrt{N-1}}{(\\sqrt{N-1})^2} = \\frac{1}{\\sqrt{N-1}}\n$$\nThis is the closed-form analytic expression for $R(N)$ in terms of $N$.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{N-1}}}\n$$"
        }
    ]
}