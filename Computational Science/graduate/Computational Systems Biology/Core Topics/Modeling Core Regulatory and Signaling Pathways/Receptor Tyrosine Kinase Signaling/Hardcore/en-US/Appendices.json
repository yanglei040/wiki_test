{
    "hands_on_practices": [
        {
            "introduction": "The activation of most receptor tyrosine kinases begins with ligand-induced dimerization, a critical event that brings the intracellular kinase domains into proximity for autophosphorylation. This foundational process can be quantitatively understood by applying the principles of chemical equilibrium. This exercise  challenges you to build a simple mathematical model based on mass-action kinetics and conservation laws to determine the fraction of activated receptor dimers as a function of ligand concentration.",
            "id": "3344214",
            "problem": "A single-species Receptor Tyrosine Kinase (RTK) undergoes ligand-induced dimerization. Consider the minimal equilibrium scheme in which unliganded receptor monomers $R$ bind ligand $L$ to form liganded monomers $RL$, which then dimerize to form $(RL)_{2}$:\n$$R + L \\rightleftharpoons RL,\\qquad RL + RL \\rightleftharpoons (RL)_{2}.$$\nAssume quasi-equilibrium governed by mass action, with dissociation constants defined by $K_{d1} = \\frac{[R][L]}{[RL]}$ for ligand binding and $K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]}$ for dimerization. Let the total receptor concentration be $R_{\\text{tot}} = 100\\,\\text{nM}$ and the free ligand concentration be fixed at $[L] = 10\\,\\text{nM}$ (assume the extracellular ligand bath is effectively constant). Take $K_{d1} = 1\\,\\text{nM}$ and $K_{d2} = 10\\,\\text{nM}$. Neglect ligand-independent dimerization and any higher-order oligomers.\n\nUsing only the equilibrium definitions and receptor mass conservation, solve the binding–dimerization equilibrium to determine the fraction of receptor subunits that reside in dimers at equilibrium,\n$$f_{\\text{dim}} \\equiv \\frac{2\\,[(RL)_{2}]}{R_{\\text{tot}}}.$$\nExpress your final answer as a decimal number rounded to four significant figures. In your derivation, start from the definitions of $K_{d1}$ and $K_{d2}$ and the conservation relation for $R_{\\text{tot}}$, and state clearly any approximations. As part of your reasoning (not the final numerical answer), identify the parameter regime in which $f_{\\text{dim}}$ exhibits an effectively quadratic dependence on $[L]$ and provide the corresponding leading-order scaling expression for $f_{\\text{dim}}$ in that regime.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   **Reactions:** $R + L \\rightleftharpoons RL$ and $RL + RL \\rightleftharpoons (RL)_{2}$.\n-   **Definitions:**\n    -   Ligand binding dissociation constant: $K_{d1} = \\frac{[R][L]}{[RL]}$.\n    -   Dimerization dissociation constant: $K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]}$.\n    -   Fraction of receptor subunits in dimers: $f_{\\text{dim}} \\equiv \\frac{2\\,[(RL)_{2}]}{R_{\\text{tot}}}$.\n-   **Constants and Conditions:**\n    -   Total receptor concentration: $R_{\\text{tot}} = 100\\,\\text{nM}$.\n    -   Free ligand concentration: $[L] = 10\\,\\text{nM}$.\n    -   $K_{d1} = 1\\,\\text{nM}$.\n    -   $K_{d2} = 10\\,\\text{nM}$.\n-   **Constraints:**\n    -   Neglect ligand-independent dimerization.\n    -   Neglect higher-order oligomers.\n    -   Use only equilibrium definitions and receptor mass conservation.\n    -   The extracellular ligand bath is effectively constant.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem describes a minimal, standard model of ligand-induced receptor dimerization, a fundamental process in cell signaling, particularly for Receptor Tyrosine Kinases (RTKs). The use of mass-action kinetics and dissociation constants to describe molecular equilibria is a cornerstone of physical chemistry and systems biology. The model is scientifically sound and widely used.\n-   **Well-Posed:** The problem provides a complete set of algebraic equations (two equilibrium relations and one conservation law) and three unknown concentrations ($[R]$, $[RL]$, $[(RL)_2]$). The number of independent equations matches the number of unknowns, ensuring a solution can be found. The parameters given lead to a physically meaningful solution (positive concentrations). A unique, stable, and meaningful solution exists.\n-   **Objective:** The problem is stated in precise, quantitative terms using standard scientific notation and terminology. There are no subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It is a valid scientific problem. I will now proceed with the solution.\n\nThe system is described by three states of the receptor: unliganded monomer ($R$), liganded monomer ($RL$), and liganded dimer ($(RL)_2$). The concentrations of these species at equilibrium are denoted by $[R]$, $[RL]$, and $[(RL)_{2}]$, respectively. The equilibrium relationships are given by the dissociation constants:\n$$K_{d1} = \\frac{[R][L]}{[RL]} \\quad (1)$$\n$$K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]} \\quad (2)$$\nThe total concentration of receptor subunits is conserved. Each monomeric species ($R$ and $RL$) contains one subunit, while the dimer ($(RL)_2$) contains two subunits. Thus, the mass conservation law is:\n$$R_{\\text{tot}} = [R] + [RL] + 2[(RL)_{2}] \\quad (3)$$\nThe goal is to solve for $f_{\\text{dim}} = \\frac{2[(RL)_{2}]}{R_{\\text{tot}}}$. To do this, we must first find the equilibrium concentrations of the species. We can express $[R]$ and $[(RL)_2]$ in terms of $[RL]$ using equations $(1)$ and $(2)$:\nFrom $(1)$, we have $[R] = \\frac{K_{d1}[RL]}{[L]}$.\nFrom $(2)$, we have $[(RL)_{2}] = \\frac{[RL]^2}{K_{d2}}$.\nSubstituting these expressions into the conservation equation $(3)$ yields an equation solely in terms of $[RL]$:\n$$R_{\\text{tot}} = \\left(\\frac{K_{d1}}{[L]}\\right)[RL] + [RL] + 2\\left(\\frac{[RL]^2}{K_{d2}}\\right)$$\nThis can be rearranged into a standard quadratic equation of the form $ax^2 + bx + c = 0$, where $x = [RL]$:\n$$\\left(\\frac{2}{K_{d2}}\\right)[RL]^2 + \\left(1 + \\frac{K_{d1}}{[L]}\\right)[RL] - R_{\\text{tot}} = 0$$\nThis derivation uses no approximations; it is an exact algebraic consequence of the model's definitions.\n\nNow, we substitute the given numerical values: $R_{\\text{tot}} = 100\\,\\text{nM}$, $[L] = 10\\,\\text{nM}$, $K_{d1} = 1\\,\\text{nM}$, and $K_{d2} = 10\\,\\text{nM}$.\nThe coefficients of the quadratic equation are:\n$$a = \\frac{2}{K_{d2}} = \\frac{2}{10} = 0.2\\,(\\text{nM})^{-1}$$\n$$b = 1 + \\frac{K_{d1}}{[L]} = 1 + \\frac{1}{10} = 1.1$$\n$$c = -R_{\\text{tot}} = -100\\,\\text{nM}$$\nThe quadratic equation for $[RL]$ is:\n$$0.2 [RL]^2 + 1.1 [RL] - 100 = 0$$\nWe solve for $[RL]$ using the quadratic formula, $[RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$. Since concentration must be a positive quantity, we take the positive root:\n$$[RL] = \\frac{-1.1 + \\sqrt{(1.1)^2 - 4(0.2)(-100)}}{2(0.2)}$$\n$$[RL] = \\frac{-1.1 + \\sqrt{1.21 + 80}}{0.4}$$\n$$[RL] = \\frac{-1.1 + \\sqrt{81.21}}{0.4}$$\n$$[RL] = \\frac{-1.1 + 9.011659...}{0.4}$$\n$$[RL] = \\frac{7.911659...}{0.4} = 19.779147...\\,\\text{nM}$$\nNow we can calculate the concentration of dimers, $[(RL)_{2}]$:\n$$[(RL)_{2}] = \\frac{[RL]^2}{K_{d2}} = \\frac{(19.779147...)^2}{10} = \\frac{391.2149...}{10} = 39.12149...\\,\\text{nM}$$\nFinally, we compute the fraction of receptor subunits in dimers, $f_{\\text{dim}}$:\n$$f_{\\text{dim}} = \\frac{2[(RL)_{2}]}{R_{\\text{tot}}} = \\frac{2 \\times 39.12149...}{100} = \\frac{78.24298...}{100} = 0.7824298...$$\nRounding to four significant figures, we get $f_{\\text{dim}} \\approx 0.7824$.\n\nNext, we identify the parameter regime in which $f_{\\text{dim}}$ exhibits an effectively quadratic dependence on $[L]$. A quadratic dependence, $f_{\\text{dim}} \\propto [L]^2$, typically arises in a multi-step process where the initial step is limiting. Here, that corresponds to the regime of low ligand concentration, where the initial binding event is rare.\nLet's assume the concentration of ligand is very low, specifically $[L] \\ll K_{d1}$. In this case, receptor binding is weak, and we can expect most receptors to be in the unliganded monomer state, $R$. This leads to the approximation $[R] \\approx R_{\\text{tot}}$. This approximation holds as long as the concentration of liganded species is negligible, i.e., $[RL] + 2[(RL)_2] \\ll R_{\\text{tot}}$.\nUnder the approximation $[R] \\approx R_{\\text{tot}}$, we can use equation $(1)$ to find a leading-order expression for $[RL]$:\n$$[RL] = \\frac{[R][L]}{K_{d1}} \\approx \\frac{R_{\\text{tot}}[L]}{K_{d1}}$$\nThis shows that $[RL]$ scales linearly with $[L]$ at low ligand concentrations.\nNow, we substitute this approximation for $[RL]$ into the expression for $f_{\\text{dim}}$:\n$$f_{\\text{dim}} = \\frac{2[(RL)_2]}{R_{\\text{tot}}} = \\frac{2}{R_{\\text{tot}}} \\frac{[RL]^2}{K_{d2}}$$\n$$f_{\\text{dim}} \\approx \\frac{2}{R_{\\text{tot}}K_{d2}} \\left( \\frac{R_{\\text{tot}}[L]}{K_{d1}} \\right)^2$$\n$$f_{\\text{dim}} \\approx \\frac{2 R_{\\text{tot}}}{K_{d1}^2 K_{d2}} [L]^2$$\nThis expression demonstrates that in the regime where $[L]$ is sufficiently small such that $[R] \\approx R_{\\text{tot}}$, the fraction of dimerized receptors, $f_{\\text{dim}}$, depends quadratically on the ligand concentration $[L]$. The regime is thus the low-ligand, weak-binding limit where receptor saturation is minimal.",
            "answer": "$$\\boxed{0.7824}$$"
        },
        {
            "introduction": "Once an RTK is activated, it recruits downstream enzymes that trigger signaling cascades, often involving molecular switches that can be rapidly turned on and off. A classic example is the phosphorylation of membrane lipids like PIP2 to PIP3 by PI3K, a process counteracted by the phosphatase PTEN. This practice problem  guides you through the process of modeling this dynamic tug-of-war using ordinary differential equations to predict the system's response time and the steady-state level of the active signal.",
            "id": "3344245",
            "problem": "In a simplified membrane model of phosphatidylinositol signaling, phosphatidylinositol-4,5-bisphosphate (PIP2) is converted to phosphatidylinositol-3,4,5-trisphosphate (PIP3) by phosphoinositide 3-kinase (PI3K) recruited by a receptor tyrosine kinase (RTK), and PIP3 is dephosphorylated back to PIP2 by phosphatase and tensin homolog (PTEN). Assume a well-mixed membrane patch where the total pool of phosphoinositides is conserved, so that $[ \\text{PIP2} ] + [ \\text{PIP3} ] = P_{\\text{tot}}$. Assume the unsaturated, first-order (mass-action) regime in which the effective forward conversion rate is proportional to the fraction of RTK–PI3K complexes that are active. A step stimulus at time $t=0$ instantaneously increases RTK–PI3K occupancy to a constant fraction $\\alpha$. Before $t=0$, there is no PI3K activation and $[ \\text{PIP3} ](0)=0$. Let the intrinsic first-order rate constants (per active enzyme) be $k_{\\text{PI3K}}$ for PIP2 to PIP3 and $k_{\\text{PTEN}}$ for PIP3 to PIP2.\n\nUsing only the principles of mass-action kinetics and conservation of the total phosphoinositide pool, derive the governing dynamics of $[ \\text{PIP3} ](t)$ after the step and compute:\n- the steady-state fraction of PIP2 converted to PIP3, defined as $[ \\text{PIP3} ]_{\\text{ss}} / P_{\\text{tot}}$, and\n- the half-time to reach this steady-state following the step, defined as the time at which $[ \\text{PIP3} ](t)$ equals half of its steady-state value.\n\nTake $k_{\\text{PI3K}} = 0.05\\,\\text{s}^{-1}$, $k_{\\text{PTEN}} = 0.02\\,\\text{s}^{-1}$, $P_{\\text{tot}} = 10\\,\\mu\\text{M}$, and $\\alpha = 30\\%$. Express the steady-state fraction as a dimensionless decimal and the half-time in seconds. Round both quantities to four significant figures.",
            "solution": "The problem requires modeling the dynamics of phosphatidylinositol-3,4,5-trisphosphate ($[\\text{PIP3}]$) concentration following a step change in enzymatic activity. We are given a two-state system involving phosphatidylinositol-4,5-bisphosphate ($[\\text{PIP2}]$) and $[\\text{PIP3}]$, governed by the reversible reaction:\n$$\n\\text{PIP2} \\underset{k_{\\text{rev}}}{\\stackrel{k_{\\text{fwd}}}{\\rightleftharpoons}} \\text{PIP3}\n$$\nThe total concentration of these two phosphoinositides is conserved, such that $[\\text{PIP2}](t) + [\\text{PIP3}](t) = P_{\\text{tot}}$, where $P_{\\text{tot}}$ is a constant.\n\nAccording to the problem description, the kinetics are governed by mass-action principles.\nFor $t \\ge 0$, a constant fraction $\\alpha$ of receptor tyrosine kinase–phosphoinositide 3-kinase (RTK–PI3K) complexes becomes active. The forward reaction (PIP2 to PIP3) is catalyzed by these active complexes. The rate is first-order in $[\\text{PIP2}]$. The effective forward rate constant is $k_{\\text{fwd}} = \\alpha k_{\\text{PI3K}}$.\nThe reverse reaction (PIP3 to PIP2) is catalyzed by the phosphatase PTEN. The rate is first-order in $[\\text{PIP3}]$ with an intrinsic rate constant $k_{\\text{rev}} = k_{\\text{PTEN}}$.\n\nThe rate of change of the concentration of $[\\text{PIP3}]$ is the difference between its formation rate and its consumption rate:\n$$\n\\frac{d[\\text{PIP3}]}{dt} = (\\text{rate of formation}) - (\\text{rate of consumption})\n$$\n$$\n\\frac{d[\\text{PIP3}]}{dt} = k_{\\text{fwd}} [\\text{PIP2}] - k_{\\text{rev}} [\\text{PIP3}]\n$$\nSubstituting the given rate constants:\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} [\\text{PIP2}] - k_{\\text{PTEN}} [\\text{PIP3}]\n$$\nTo obtain a differential equation in a single variable, we use the conservation law: $[\\text{PIP2}] = P_{\\text{tot}} - [\\text{PIP3}]$. Substituting this into the rate equation gives:\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} (P_{\\text{tot}} - [\\text{PIP3}]) - k_{\\text{PTEN}} [\\text{PIP3}]\n$$\nThis is a first-order linear ordinary differential equation. Let's rearrange it into a standard form:\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} P_{\\text{tot}} - (\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}) [\\text{PIP3}]\n$$\n$$\n\\frac{d[\\text{PIP3}]}{dt} + (\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}) [\\text{PIP3}] = \\alpha k_{\\text{PI3K}} P_{\\text{tot}}\n$$\nLet the effective relaxation rate constant be $k_{\\text{eff}} = \\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}$. The equation becomes:\n$$\n\\frac{d[\\text{PIP3}]}{dt} + k_{\\text{eff}} [\\text{PIP3}] = \\alpha k_{\\text{PI3K}} P_{\\text{tot}}\n$$\nThe general solution to this differential equation is the sum of the homogeneous solution and a particular solution. The homogeneous equation has the solution $C \\exp(-k_{\\text{eff}} t)$, and a particular solution is the steady-state value. The full solution is:\n$$\n[\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} + C \\exp(-k_{\\text{eff}} t)\n$$\nWe determine the integration constant $C$ using the initial condition $[\\text{PIP3}](0) = 0$:\n$$\n0 = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} + C \\exp(0) \\implies C = -\\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}}\n$$\nSubstituting $C$ back, the time evolution of $[\\text{PIP3}]$ is:\n$$\n[\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} (1 - \\exp(-k_{\\text{eff}} t))\n$$\n\nThe steady-state concentration, $[\\text{PIP3}]_{\\text{ss}}$, is the value of $[\\text{PIP3}](t)$ as $t \\to \\infty$:\n$$\n[\\text{PIP3}]_{\\text{ss}} = \\lim_{t \\to \\infty} [\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\nThe problem asks for the steady-state fraction of PIP2 converted to PIP3, which is defined as $[\\text{PIP3}]_{\\text{ss}} / P_{\\text{tot}}$.\n$$\n\\frac{[\\text{PIP3}]_{\\text{ss}}}{P_{\\text{tot}}} = \\frac{\\alpha k_{\\text{PI3K}}}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n\nNext, we compute the half-time, $t_{1/2}$, which is the time at which $[\\text{PIP3}](t)$ reaches half of its steady-state value: $[\\text{PIP3}](t_{1/2}) = \\frac{1}{2} [\\text{PIP3}]_{\\text{ss}}$.\n$$\n\\frac{1}{2} [\\text{PIP3}]_{\\text{ss}} = [\\text{PIP3}]_{\\text{ss}} (1 - \\exp(-k_{\\text{eff}} t_{1/2}))\n$$\nDividing by $[\\text{PIP3}]_{\\text{ss}}$ (which is non-zero for $\\alpha, k_{\\text{PI3K}} > 0$):\n$$\n\\frac{1}{2} = 1 - \\exp(-k_{\\text{eff}} t_{1/2})\n$$\n$$\n\\exp(-k_{\\text{eff}} t_{1/2}) = \\frac{1}{2}\n$$\nTaking the natural logarithm of both sides:\n$$\n-k_{\\text{eff}} t_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_{\\text{eff}}} = \\frac{\\ln(2)}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n\nNow we substitute the given numerical values: $k_{\\text{PI3K}} = 0.05\\,\\text{s}^{-1}$, $k_{\\text{PTEN}} = 0.02\\,\\text{s}^{-1}$, and $\\alpha = 0.30$.\nFirst, calculate the effective rate constant $k_{\\text{eff}}$:\n$$\nk_{\\text{eff}} = (0.30)(0.05\\,\\text{s}^{-1}) + 0.02\\,\\text{s}^{-1} = 0.015\\,\\text{s}^{-1} + 0.02\\,\\text{s}^{-1} = 0.035\\,\\text{s}^{-1}\n$$\nThe steady-state fraction is:\n$$\n\\frac{[\\text{PIP3}]_{\\text{ss}}}{P_{\\text{tot}}} = \\frac{\\alpha k_{\\text{PI3K}}}{k_{\\text{eff}}} = \\frac{(0.30)(0.05)}{0.035} = \\frac{0.015}{0.035} = \\frac{15}{35} = \\frac{3}{7}\n$$\nConverting to a decimal and rounding to four significant figures:\n$$\n\\frac{3}{7} \\approx 0.428571... \\approx 0.4286\n$$\nThe half-time is:\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_{\\text{eff}}} = \\frac{\\ln(2)}{0.035\\,\\text{s}^{-1}} \\approx \\frac{0.693147...}{0.035\\,\\text{s}^{-1}} \\approx 19.8042... \\,\\text{s}\n$$\nRounding to four significant figures gives:\n$$\nt_{1/2} \\approx 19.80\\,\\text{s}\n$$\nThe total phosphoinositide concentration $P_{\\text{tot}} = 10\\,\\mu\\text{M}$ is not required for these calculations.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4286 & 19.80\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building predictive models in systems biology requires not only formulating the correct equations but also determining their parameters from experimental data, a task complicated by issues of parameter identifiability. Receptor trafficking, a process that controls the abundance of RTKs at the cell surface, provides a perfect context to explore this challenge. This computational exercise  introduces a core technique, Fisher Information Matrix analysis, to assess which kinetic rates in a trafficking model can be reliably estimated from typical pulse-chase data and to identify 'sloppy' parameter combinations.",
            "id": "3344235",
            "problem": "You are given a two-compartment linear mass-action model of Receptor Tyrosine Kinase (RTK) trafficking during a pulse-chase experiment, describing labeled receptor amounts at the plasma membrane (surface) and in the internalized compartment. Let $R_s(t)$ denote the surface-labeled receptor amount and $R_i(t)$ denote the internalized-labeled receptor amount at time $t$. The model assumes first-order internalization, recycling, and internal degradation. The parameter vector is $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}]$, where $k_{\\mathrm{int}}$ is the internalization rate constant, $k_{\\mathrm{rec}}$ is the recycling rate constant, and $k_{\\mathrm{deg}}$ is the internal degradation rate constant. All rate constants are in units of $\\mathrm{s}^{-1}$. The governing ordinary differential equations are\n$$\n\\frac{dR_s}{dt} = -k_{\\mathrm{int}} R_s + k_{\\mathrm{rec}} R_i, \\quad\n\\frac{dR_i}{dt} = k_{\\mathrm{int}} R_s - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_i,\n$$\nwith initial conditions representing the chase onset after a labeling pulse:\n$$\nR_s(0) = R_0, \\quad R_i(0) = 0,\n$$\nwhere $R_0$ is the initial labeled receptor amount (dimensionless fraction of labeled receptors or normalized to $R_0=1$).\n\nYou observe $R_s(t)$ and/or $R_i(t)$ at specified times with independent additive Gaussian noise of known standard deviation $\\sigma_y$ for each measured component. Assume the measurement function is the identity (observations directly equal the corresponding state component), and that measurement noise is zero-mean Gaussian with variance $\\sigma_y^2$ and independent across time points and components.\n\nYour task is to evaluate local structural and practical identifiability via the Fisher Information Matrix (FIM) constructed from the continuous-time sensitivity equations. Let $x(t) = [R_s(t), R_i(t)]^\\top$ denote the state vector and let $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ denote the $2 \\times 3$ sensitivity matrix where the $(j,\\ell)$ entry is $\\frac{\\partial x_j(t)}{\\partial \\theta_\\ell}$. The sensitivity dynamics follow from first principles for differentiable flows:\n$$\n\\frac{d}{dt} S(t) = A(t) S(t) + B_\\theta(t), \\quad S(0) = 0_{2 \\times 3},\n$$\nwhere $A(t) = \\frac{\\partial f}{\\partial x}\\big|_{x(t),\\theta}$ and $B_\\theta(t) = \\frac{\\partial f}{\\partial \\theta}\\big|_{x(t),\\theta}$ for the right-hand side $f(x,\\theta)$ of the state dynamics. For the linear model above,\n$$\nA(t) = \\begin{bmatrix}\n-k_{\\mathrm{int}} & k_{\\mathrm{rec}} \\\\\nk_{\\mathrm{int}} & -(k_{\\mathrm{rec}} + k_{\\mathrm{deg}})\n\\end{bmatrix},\n\\quad\nB_\\theta(t) = \\begin{bmatrix}\n-R_s(t) & R_i(t) & 0 \\\\\nR_s(t) & -R_i(t) & -R_i(t)\n\\end{bmatrix}.\n$$\n\nGiven observation times $t_1, \\dots, t_N$, a subset of observed components indicated by an index set $\\mathcal{O} \\subset \\{1,2\\}$ (with $1$ for $R_s$ and $2$ for $R_i$), and a common standard deviation $\\sigma_y$ for all observed components, the Fisher Information Matrix is\n$$\nF(\\theta) = \\sum_{k=1}^N \\sum_{j \\in \\mathcal{O}} \\frac{1}{\\sigma_y^2} \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)^\\top \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right),\n$$\nwhere $\\frac{\\partial x_j(t_k)}{\\partial \\theta}$ is the $1 \\times 3$ row of $S(t_k)$ corresponding to component $j$. Perform eigen-decomposition of the symmetric matrix $F(\\theta)$ to extract eigenvalues and eigenvectors. Define the numerical condition number of $F(\\theta)$ as\n$$\n\\kappa_{10} = \\log_{10} \\left( \\frac{\\lambda_{\\max}}{\\max(\\lambda_{\\min}, \\epsilon)} \\right),\n$$\nwith $\\lambda_{\\max}$ and $\\lambda_{\\min}$ the largest and smallest eigenvalues of $F(\\theta)$, respectively, and with a fixed regularizer $\\epsilon = 10^{-12}$ to avoid division by zero in singular cases. Define the sloppiest direction as the unit eigenvector $v_{\\mathrm{sloppy}}$ associated with $\\lambda_{\\min}$. To interpret which parameter combination is sloppiest, compute the principal angle (in degrees) between $v_{\\mathrm{sloppy}}$ and the unit axis vector for $k_{\\mathrm{rec}}$, namely $e_{\\mathrm{rec}} = [0,1,0]^\\top$. The angle is\n$$\n\\phi = \\arccos\\left( \\left| v_{\\mathrm{sloppy}} \\cdot e_{\\mathrm{rec}} \\right| \\right) \\cdot \\frac{180}{\\pi},\n$$\nwhere the absolute value enforces an acute angle.\n\nWrite a complete program that, for each test case specified below, constructs $F(\\theta)$ using the sensitivity-based approach above and returns two outputs: the base-$10$ logarithm of the condition number $\\kappa_{10}$ and the sloppiest-direction angle $\\phi$ in degrees. All rate constants must be treated in $\\mathrm{s}^{-1}$ and all angles must be reported in degrees. There are no percentage outputs anywhere in this task.\n\nUse the following test suite of parameter sets, observation settings, and time grids:\n\n- Test case $1$ (balanced trafficking, both components observed):\n  - $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}] = [0.15, 0.08, 0.02]$ in $\\mathrm{s}^{-1}$.\n  - $R_0 = 1.0$ (dimensionless).\n  - Observation index set $\\mathcal{O} = \\{1,2\\}$.\n  - Observation times $t_k$ in seconds: $[0, 5, 10, 20, 40, 80, 160]$.\n  - $\\sigma_y = 0.01$ (dimensionless).\n- Test case $2$ (surface-only observation to probe practical non-identifiability):\n  - $\\theta = [0.15, 0.08, 0.02]$ in $\\mathrm{s}^{-1}$.\n  - $R_0 = 1.0$ (dimensionless).\n  - Observation index set $\\mathcal{O} = \\{1\\}$.\n  - Observation times $t_k$ in seconds: $[0, 5, 10, 20, 40, 80, 160]$.\n  - $\\sigma_y = 0.01$ (dimensionless).\n- Test case $3$ (slow recycling regime, both components observed):\n  - $\\theta = [0.20, 0.005, 0.20]$ in $\\mathrm{s}^{-1}$.\n  - $R_0 = 1.0$ (dimensionless).\n  - Observation index set $\\mathcal{O} = \\{1,2\\}$.\n  - Observation times $t_k$ in seconds: $[0, 2, 4, 8, 16, 32, 64, 128]$.\n  - $\\sigma_y = 0.01$ (dimensionless).\n\nYour program must:\n- Integrate the coupled state and sensitivity dynamics to obtain $S(t_k)$ at the specified times for each test case.\n- Assemble the Fisher Information Matrix $F(\\theta)$ using the formula above with the specified $\\sigma_y$ and $\\mathcal{O}$.\n- Compute $\\kappa_{10}$ with $\\epsilon = 10^{-12}$ and the acute angle $\\phi$ (in degrees) between $v_{\\mathrm{sloppy}}$ and $e_{\\mathrm{rec}}$.\n- Produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[\\kappa_{10}, \\phi]$. For example, the output format must be exactly like $[[a,b],[c,d],[e,f]]$ with floating-point numbers in place of $a,b,c,d,e,f$.",
            "solution": "The problem requires an evaluation of parameter identifiability for a two-compartment model of receptor trafficking using a sensitivity-based Fisher Information Matrix (FIM) approach. The solution involves numerically integrating a system of coupled ordinary differential equations (ODEs) for the system states and their sensitivities with respect to the model parameters, followed by the construction and analysis of the FIM.\n\n### Mathematical Model and State Dynamics\nThe system describes the quantities of labeled receptors at the cell surface, $R_s(t)$, and in an internal compartment, $R_i(t)$. The dynamics are governed by a system of linear first-order ODEs:\n$$\n\\frac{d R_s}{dt} = -k_{\\mathrm{int}} R_s + k_{\\mathrm{rec}} R_i\n$$\n$$\n\\frac{d R_i}{dt} = k_{\\mathrm{int}} R_s - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_i\n$$\nHere, the parameter vector is $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}]^\\top$, representing the rate constants for internalization, recycling, and degradation, respectively. The initial conditions for the chase phase of the experiment are given as $R_s(0) = R_0$ and $R_i(0) = 0$, where $R_0$ is normalized to $1.0$.\n\n### Sensitivity Analysis via Augmented ODE System\nTo construct the FIM, we need the sensitivities of the state variables with respect to the parameters, i.e., the components of the sensitivity matrix $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$, where $x(t) = [R_s(t), R_i(t)]^\\top$. The dynamics of $S(t)$ are given by:\n$$\n\\frac{d}{dt} S(t) = A S(t) + B_\\theta(t)\n$$\nwith the initial condition $S(0) = 0_{2 \\times 3}$, a $2 \\times 3$ zero matrix. The matrices $A$ and $B_\\theta(t)$ are the Jacobian of the state dynamics with respect to the states and parameters, respectively:\n$$\nA = \\begin{bmatrix} -k_{\\mathrm{int}} & k_{\\mathrm{rec}} \\\\ k_{\\mathrm{int}} & -(k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) \\end{bmatrix}, \\quad\nB_\\theta(t) = \\begin{bmatrix}\n-R_s(t) & R_i(t) & 0 \\\\\nR_s(t) & -R_i(t) & -R_i(t)\n\\end{bmatrix}\n$$\nTo solve this system numerically, we create an augmented state vector $y(t)$ of dimension $8$, which combines the $2$ state variables and the $6$ components of the sensitivity matrix. For efficient implementation, the $2 \\times 3$ sensitivity matrix $S(t)$ is flattened column-wise. The augmented vector is $y(t) = [R_s, R_i, S_{11}, S_{21}, S_{12}, S_{22}, S_{13}, S_{23}]^\\top$. The complete system of $8$ coupled ODEs is then integrated numerically. The initial condition for this augmented system is $y(0) = [R_0, 0, 0, 0, 0, 0, 0, 0]^\\top$.\n\n### Numerical Integration\nThe `scipy.integrate.solve_ivp` function is employed to integrate the augmented ODE system from $t=0$ to the final observation time for each test case. The solution is evaluated at the specific time points $t_k$ provided in each case, yielding the state trajectories $x(t_k)$ and the sensitivity matrices $S(t_k)$.\n\n### Fisher Information Matrix (FIM) Construction\nThe FIM, $F(\\theta)$, quantifies the information that the observed data provides about the parameters $\\theta$. For independent, additive Gaussian noise with variance $\\sigma_y^2$, it is calculated by summing the contributions from each observation at each time point:\n$$\nF(\\theta) = \\sum_{k=1}^{N} \\sum_{j \\in \\mathcal{O}} \\frac{1}{\\sigma_y^2} \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)^\\top \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)\n$$\nwhere $\\mathcal{O}$ is the set of indices of observed components (e.g., $\\{1\\}$ for $R_s$, $\\{1,2\\}$ for both $R_s$ and $R_i$), and $\\frac{\\partial x_j(t_k)}{\\partial \\theta}$ is the $j$-th row of the sensitivity matrix $S(t_k)$. Each term in the sum is a $3 \\times 3$ matrix formed by the outer product of a sensitivity row vector with itself. The algorithm iterates through the specified observation times $t_k$ and observed components $j \\in \\mathcal{O}$, accumulating these outer products into the FIM, which is then scaled by $1/\\sigma_y^2$.\n\n### Identifiability Metrics Calculation\nThe properties of the FIM reveal the identifiability of the parameters. We perform an eigendecomposition of the symmetric $3 \\times 3$ matrix $F(\\theta)$ to obtain its eigenvalues $\\lambda_i$ and corresponding eigenvectors $v_i$.\n\n1.  **Condition Number**: The ratio of the largest eigenvalue, $\\lambda_{\\max}$, to the smallest, $\\lambda_{\\min}$, indicates the stiffness of the parameter estimation problem. A large condition number signifies \"sloppiness,\" meaning some parameter combinations are poorly constrained by the data. We compute the base-10 logarithm of a regularized condition number:\n    $$\n    \\kappa_{10} = \\log_{10} \\left( \\frac{\\lambda_{\\max}}{\\max(\\lambda_{\\min}, \\epsilon)} \\right)\n    $$\n    where the regularizer $\\epsilon = 10^{-12}$ prevents division by zero for a singular FIM.\n\n2.  **Sloppy Direction Angle**: The eigenvector $v_{\\mathrm{sloppy}}$ associated with $\\lambda_{\\min}$ defines the \"sloppiest\" direction in parameter space—the combination of parameters that is least identifiable. To interpret this direction, we calculate its alignment with the axis of a specific parameter. Here, we compute the principal angle $\\phi$ between $v_{\\mathrm{sloppy}}$ and the axis for $k_{\\mathrm{rec}}$, represented by the unit vector $e_{\\mathrm{rec}} = [0,1,0]^\\top$:\n    $$\n    \\phi = \\arccos\\!\\left( \\left| v_{\\mathrm{sloppy}} \\cdot e_{\\mathrm{rec}} \\right| \\right) \\cdot \\frac{180}{\\pi}\n    $$\nThe absolute value of the dot product ensures the angle is acute (between $0^\\circ$ and $90^\\circ$). A small angle $\\phi$ indicates that the sloppiest direction is closely aligned with the $k_{\\mathrm{rec}}$ axis, meaning $k_{\\mathrm{rec}}$ is the parameter (or a dominant component of the unidentifiable combination) that is most difficult to estimate.\n\nThis entire procedure is applied to each of the three test cases specified in the problem, yielding a pair of values $[\\kappa_{10}, \\phi]$ for each.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1: balanced trafficking, both components observed\n        {\n            \"theta\": np.array([0.15, 0.08, 0.02]),  # [k_int, k_rec, k_deg]\n            \"R0\": 1.0,\n            \"obs_indices\": {1, 2},  # 1 for R_s, 2 for R_i\n            \"t_obs\": np.array([0, 5, 10, 20, 40, 80, 160]),\n            \"sigma_y\": 0.01\n        },\n        # Test case 2: surface-only observation\n        {\n            \"theta\": np.array([0.15, 0.08, 0.02]),\n            \"R0\": 1.0,\n            \"obs_indices\": {1},\n            \"t_obs\": np.array([0, 5, 10, 20, 40, 80, 160]),\n            \"sigma_y\": 0.01\n        },\n        # Test case 3: slow recycling regime, both components observed\n        {\n            \"theta\": np.array([0.20, 0.005, 0.20]),\n            \"R0\": 1.0,\n            \"obs_indices\": {1, 2},\n            \"t_obs\": np.array([0, 2, 4, 8, 16, 32, 64, 128]),\n            \"sigma_y\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_identifiability(case)\n        results.append(result)\n\n    # Format the final output as a list of lists of floats\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef dydt_augmented(t, y, theta):\n    \"\"\"\n    Defines the augmented ODE system for states and sensitivities.\n    \n    Args:\n        t (float): Time.\n        y (np.ndarray): Augmented state vector [R_s, R_i, S_11, S_21, ...].\n        theta (np.ndarray): Parameter vector [k_int, k_rec, k_deg].\n\n    Returns:\n        np.ndarray: The derivative of the augmented state vector.\n    \"\"\"\n    k_int, k_rec, k_deg = theta\n    R_s, R_i = y[0], y[1]\n\n    # Initialize derivative vector\n    dydt = np.zeros_like(y)\n\n    # State equations\n    dydt[0] = -k_int * R_s + k_rec * R_i\n    dydt[1] = k_int * R_s - (k_rec + k_deg) * R_i\n\n    # Sensitivity equations\n    # Jacobian of the system w.r.t. states\n    A = np.array([\n        [-k_int, k_rec],\n        [k_int, -(k_rec + k_deg)]\n    ])\n\n    # Jacobian of the system w.r.t. parameters\n    B_theta = np.array([\n        [-R_s, R_i, 0],\n        [R_s, -R_i, -R_i]\n    ])\n\n    # Sensitivities are flattened column-wise in the state vector y\n    # dS/dt = A*S + B_theta\n    # For each parameter (column of S and B_theta):\n    # dS_j/dt = A * S_j + B_theta_j\n\n    # Sensitivity w.r.t. k_int (S_col1)\n    S_col1 = y[2:4]\n    dydt[2:4] = A @ S_col1 + B_theta[:, 0]\n\n    # Sensitivity w.r.t. k_rec (S_col2)\n    S_col2 = y[4:6]\n    dydt[4:6] = A @ S_col2 + B_theta[:, 1]\n\n    # Sensitivity w.r.t. k_deg (S_col3)\n    S_col3 = y[6:8]\n    dydt[6:8] = A @ S_col3 + B_theta[:, 2]\n\n    return dydt\n\ndef analyze_identifiability(case):\n    \"\"\"\n    Performs the full identifiability analysis for a single test case.\n    \n    Args:\n        case (dict): A dictionary containing all parameters for the test case.\n        \n    Returns:\n        list: A list containing [kappa_10, phi].\n    \"\"\"\n    theta = case[\"theta\"]\n    R0 = case[\"R0\"]\n    obs_indices = case[\"obs_indices\"]\n    t_obs = case[\"t_obs\"]\n    sigma_y = case[\"sigma_y\"]\n    epsilon = 1e-12\n\n    # 1. Integrate the augmented ODE system\n    y0 = np.zeros(8)\n    y0[0] = R0  # R_s(0) = R0\n    t_span = [0, t_obs[-1]]\n    \n    sol = solve_ivp(\n        dydt_augmented,\n        t_span,\n        y0,\n        t_eval=t_obs,\n        args=(theta,),\n        method='RK45', \n        rtol=1e-8, \n        atol=1e-10\n    )\n\n    # 2. Assemble the Fisher Information Matrix (FIM)\n    num_params = 3\n    FIM = np.zeros((num_params, num_params))\n    \n    for k in range(len(t_obs)):\n        # Sensitivity matrix S(t_k)\n        # S_ij = d(x_i)/d(theta_j)\n        # Row 1 of S corresponds to R_s sensitivities\n        s_Rs = np.array([sol.y[2, k], sol.y[4, k], sol.y[6, k]])\n        # Row 2 of S corresponds to R_i sensitivities\n        s_Ri = np.array([sol.y[3, k], sol.y[5, k], sol.y[7, k]])\n\n        if 1 in obs_indices:  # R_s is observed\n            FIM += np.outer(s_Rs, s_Rs)\n        if 2 in obs_indices:  # R_i is observed\n            FIM += np.outer(s_Ri, s_Ri)\n    \n    FIM /= (sigma_y**2)\n\n    # 3. Compute identifiability metrics\n    # Eigendecomposition of the symmetric FIM\n    evals, evecs = np.linalg.eigh(FIM)\n    \n    lambda_min = evals[0]\n    lambda_max = evals[-1]\n    v_sloppy = evecs[:, 0]\n\n    # a. Condition number\n    kappa_10 = np.log10(lambda_max / max(lambda_min, epsilon))\n\n    # b. Sloppiest direction angle\n    e_rec = np.array([0., 1., 0.])\n    # The dot product is just the second component of the eigenvector\n    cos_angle_abs = np.abs(np.dot(v_sloppy, e_rec))\n    # Ensure argument to arccos is <= 1.0 due to potential float precision issues\n    cos_angle_abs = min(cos_angle_abs, 1.0)\n    angle_rad = np.arccos(cos_angle_abs)\n    phi = np.degrees(angle_rad)\n\n    return [kappa_10, phi]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}