## 引言
[主成分分析](@entry_id:145395)（Principal Component Analysis, PCA）是[计算系统生物学](@entry_id:747636)中用于探索高维数据的基石方法。从基因表达谱到代谢物丰度，PCA能够将复杂的数据集简化为少数几个关键的变异维度，揭示隐藏的模式。然而，许多分析仅仅停留在生成[得分图](@entry_id:195133)以观察样本[聚类](@entry_id:266727)，未能充分挖掘PCA输出——即载荷（loadings）与得分（scores）——中所蕴含的丰富生物学信息。正确而深入地解释这些组件，是将PCA从一个单纯的降维工具转变为一个强大假设生成引擎的关键，但这其中充满了挑战和陷阱。

本文旨在填补这一知识鸿沟，提供一个关于[PCA载荷](@entry_id:636346)与得分解释的全面指南。我们将超越基础概念，深入探讨确保分析结果稳健性与生物学相关性所需的理论知识和实践策略。读者将通过本文学习到：

- **第一章：原理与机制**，我们将从数学第一性原理出发，剖析PCA如何工作，阐明[数据预处理](@entry_id:197920)（如中心化和[标准化](@entry_id:637219)）的决定性影响，并建立一套解释载荷与得分的严谨框架。
- **第二章：应用与跨学科联系**，我们将通过系统生物学、化学计量学和生态学等领域的真实案例，展示这些解释框架如何被应用于解构生物信号、识别动态过程和处理特殊[数据结构](@entry_id:262134)。
- **第三章：动手实践**，你将通过解决具体问题，学习如何将新数据投影到现有模型、评估结果的稳定性以及选择有意义的主成分。

本指南将引导你从数据中提取更深层次的洞见，确保你对PCA的每一次应用都既精确又富有洞察力。让我们从深入理解PCA背后的数学原理和机制开始。

## 原理与机制

[主成分分析](@entry_id:145395) (Principal Component Analysis, PCA) 是一种强大的降维和[探索性数据分析](@entry_id:172341)技术，在[计算系统生物学](@entry_id:747636)中无处不在。在前一章介绍其基本目标之后，本章将深入探讨其核心的数学原理、解释其输出（载荷与得分）的关键策略，以及在分析生物学数据时必须考虑的实际问题。我们将从第一性原理出发，构建一个严谨的框架，以确保对 PCA 结果的解释既准确又具有生物学意义。

### 主成分的数学基础

从根本上说，PCA 提供了两种等价但概念上不同的视角来理解数据中的变异。

#### 变分定义：最大化投影[方差](@entry_id:200758)

第一种视角是变分法。假设我们有一个经过中心化的数据矩阵 $X \in \mathbb{R}^{n \times p}$，其中 $n$ 是样本数（例如，细胞或实验条件），$p$ 是变量数（例如，基因或代谢物）。PCA 的目标是找到一系列正交的[单位向量](@entry_id:165907)（方向），将数据投影到这些方向上时，投影数据的样本[方差](@entry_id:200758)依次最大化。

第一个主成分 (PC1) 的方向，即第一个**[载荷向量](@entry_id:635284)** (loading vector) $p_1 \in \mathbb{R}^p$，是以下约束优化问题的解：

$$ p_1 = \arg\max_{\|w\|_2 = 1} \operatorname{Var}(Xw) $$

这里，$Xw$ 是一个 $n \times 1$ 的向量，代表了 $n$ 个样本在 $w$ 方向上的投影，即**得分** (scores)。由于 $X$ 已经中心化，投影后的数据也是中心化的。其样本[方差](@entry_id:200758)为：

$$ \operatorname{Var}(Xw) = \frac{1}{n-1} (Xw)^\top(Xw) = \frac{1}{n-1} w^\top X^\top X w = w^\top S w $$

其中 $S = \frac{1}{n-1} X^\top X$ 是样本协方差矩阵。根据[瑞利-里兹定理](@entry_id:194531) (Rayleigh-Ritz theorem)，最大化二次型 $w^\top S w$ 在约束 $\|w\|_2=1$ 下的解，是 $S$ 的最大[特征值](@entry_id:154894)对应的[特征向量](@entry_id:151813)。因此，$p_1$ 就是 $S$ 的[主特征向量](@entry_id:264358)。

后续的主成分通过迭代地求解相同的最大化问题，但增加了与所有先前找到的[载荷向量](@entry_id:635284)正交的额外约束。例如，第二个[载荷向量](@entry_id:635284) $p_2$ 的求解，需要满足 $p_2^\top p_1 = 0$ 的约束。这个过程最终产生了一组[载荷向量](@entry_id:635284) $p_1, p_2, \dots, p_r$（其中 $r = \operatorname{rank}(X)$），它们是[协方差矩阵](@entry_id:139155) $S$ 的[正交特征向量](@entry_id:155522)，按其对应[特征值](@entry_id:154894) $\lambda_1 \ge \lambda_2 \ge \dots \ge \lambda_r$ 的大小排序 。

#### 几何定义：最佳低秩近似

第二种视角是几何的。PCA 旨在找到一个低维[子空间](@entry_id:150286)，使得原始数据点到该[子空间](@entry_id:150286)的投影误差最小。对于一个给定的秩 $k$ ($1 \le k \le r$)，PCA 提供了对原始数据矩阵 $X$ 的最佳秩-$k$ 近似 $X_k$。这个近似是在 Frobenius 范数意义下最佳的，即它最小化了重建误差 $\|X - X_k\|_F^2$。

这个最佳近似 $X_k$ 可以通过保留前 $k$ 个主成分来构建。令 $P_k \in \mathbb{R}^{p \times k}$ 为包含前 $k$ 个[载荷向量](@entry_id:635284)的矩阵， $T_k \in \mathbb{R}^{n \times k}$ 为包含对应得分向量的矩阵，那么重建矩阵为：

$$ X_k = T_k P_k^\top $$

根据 Eckart-Young-Mirsky 定理，这个重建等价于对 $X$ 的[奇异值分解](@entry_id:138057) (Singular Value Decomposition, SVD) 进行截断。若 $X = U \Sigma V^\top$ 是 $X$ 的 SVD，其中 $U \in \mathbb{R}^{n \times r}$ 和 $V \in \mathbb{R}^{p \times r}$ 的列是正交的，$\Sigma = \operatorname{diag}(s_1, \dots, s_r)$ 是包含[奇异值](@entry_id:152907)的对角矩阵。那么，载荷矩阵就是 $P = V$，得分矩阵是 $T = XP = U\Sigma V^\top V = U\Sigma$。因此，秩-$k$ 近似就是 $X_k = U_k \Sigma_k V_k^\top$，其中 $U_k, \Sigma_k, V_k$ 分别是 $U, \Sigma, V$ 的前 $k$ 列或左上角 $k \times k$ 块 。

这个几何视角揭示了**解释[方差](@entry_id:200758)** (explained variance) 的一个重要含义。总的重建误差，即被丢弃的[信息量](@entry_id:272315)，可以直接用[奇异值](@entry_id:152907)来量化：

$$ \|X - X_k\|_F^2 = \sum_{i=k+1}^{r} s_i^2 $$

这个公式表明，重建误差等于被丢弃的主成分所对应的[奇异值](@entry_id:152907)的平方和。因此，当我们说前 $k$ 个主成分“解释”了大部分[方差](@entry_id:200758)时，我们的意思是它们的和 $\sum_{i=1}^{k} s_i^2$ 占据了总[方差](@entry_id:200758)（即总平方和 $\|X\|_F^2 = \sum_{i=1}^{r} s_i^2$）的绝大部分，从而使得重建误差很小 。

### [数据预处理](@entry_id:197920)及其对解释的影响

在应用 PCA 之前，必须对数据进行[预处理](@entry_id:141204)。这些看似技术性的步骤对最终结果的生物学解释有着深远的影响。

#### 均值中心化

几乎所有 PCA 的应用都始于**均值中心化** (mean-centering)，即从每个变量（矩阵的每一列）中减去其均值。此操作将数据云的质心平移到[坐标系](@entry_id:156346)的原点。其后果是，主成分将描述数据点**围绕多元均值**的变异模式，而不是它们相对于任意原点的绝对水平。一个直接的数学结果是，任何主成分的得分向量的均值都恰好为零 。

#### [协方差与相关性](@entry_id:262778)：一个关键选择

中心化之后，研究者面临一个关键选择：是直接在中心化后的数据上执行 PCA（等价于对协方差矩阵进行[特征分解](@entry_id:181333)），还是先对每个变量进行标准化（即除以其[标准差](@entry_id:153618)），再执行 PCA（等价于对[相关矩阵](@entry_id:262631)进行[特征分解](@entry_id:181333)）。

- **基于协[方差](@entry_id:200758)的 PCA**：当变量具有相同的单位且其原始[方差](@entry_id:200758)本身就蕴含着重要的生物学信息时，这种方法是合适的。然而，在典型的[多组学](@entry_id:148370)数据中，变量的单位和尺度[异质性](@entry_id:275678)极大（例如，转录本读数、蛋白质丰度、代谢物浓度）。在这种情况下，直接使用协[方差](@entry_id:200758)会导致[方差](@entry_id:200758)最大的变量（通常仅仅是因为其测量单位或内在尺度）不成比例地主导第一个主成分，即使它与其他变量的关联很弱。这使得载荷的解释偏向于绝对[方差](@entry_id:200758)的贡献，而不是变量间的协同变化模式 。

- **基于相关性的 PCA**：为了解决上述问题，标准做法是先对每个变量进行**单位[方差](@entry_id:200758)缩放** (scaling to unit variance)，即在中心化后，将每个变量除以其标准差。此过程将每个变量转换为均值为 0、[方差](@entry_id:200758)为 1 的 Z-score。在此[标准化](@entry_id:637219)数据上执行 PCA，等价于对[原始变量](@entry_id:753733)的**[相关矩阵](@entry_id:262631)**进行[特征分解](@entry_id:181333)。

选择基于相关性的 PCA 有两个主要优点，尤其是在[计算系统生物学](@entry_id:747636)中 ：
1.  **尺度不变性**：基于相关性的 PCA 对每个变量的独立线性重缩放（例如，单位变换）是不变的。这意味着无论一个代谢物是以微摩尔还是纳摩尔为单位测量，它对最终 PCA 模型结构的影响是相同的。这种稳健性对于整合来自不同技术平台和组学层次的数据至关重要。
2.  **可比性**：通过将所有变量置于一个共同的尺度上（[方差](@entry_id:200758)为 1），它使得不同变量的载荷大小变得可以直接比较。一个基因的载荷和一个代谢物的载荷现在都可以被解释为它们对某个协同变异模式的相对贡献，而不会被它们原始的、任意的测量尺度所混淆。

需要注意的是，经过单位[方差](@entry_id:200758)缩放后，得分向量成为无量纲的数值，不能再直接与原始变量的测量值进行比较 。

### 解释 PCA 输出：载荷、得分和解释[方差](@entry_id:200758)

PCA 的最终输出是一组载荷、得分和每个成分的解释[方差](@entry_id:200758)。正确地解释这些元素是提取生物学见解的关键。

#### 解释[方差](@entry_id:200758)

如前所述，第 $k$ 个主成分的重要性由它所捕获的[方差](@entry_id:200758)量来衡量。这通常表示为一个比例，即**解释[方差比](@entry_id:162608)** (explained variance ratio)：

$$ \text{解释方差比}_k = \frac{s_k^2}{\sum_{j=1}^{r} s_j^2} $$

其中 $s_k$ 是第 $k$ 个奇异值。这个比率代表了第 $k$ 个[主成分得分](@entry_id:636463)向量的[方差](@entry_id:200758)占数据总[方差](@entry_id:200758)的比例。在生物学背景下，一个高的解释[方差比](@entry_id:162608)表明，由相应[载荷向量](@entry_id:635284)定义的变量组合（可视为一个“基因模块”或“分子特征”）是数据中一个主要的、系统的变异来源。因此，该比率量化了由 $p_k$ 所编码的协同变异模式的重要性，数值越高，表明 $p_k$ 捕捉到了一个越主导的生物学变异轴 。

#### 解释载荷

[载荷向量](@entry_id:635284) $p_k$ 定义了第 $k$ 个主成分。$p_k$ 中的每个元素 $p_{jk}$ 对应于第 $j$ 个变量。$p_{jk}$ 的**大小**（[绝对值](@entry_id:147688)）表示变量 $j$ 对成分 $k$ 的贡献强度。一个[绝对值](@entry_id:147688)大的载荷意味着该基因或代谢物是定义该特定生物学模式的关键参与者。

变量 $j$ 对成分 $k$ 的**贡献度** (contribution) 可以被精确地定义为载荷的平方，即 $c_{jk} = p_{jk}^2$（因为[载荷向量](@entry_id:635284)是[单位向量](@entry_id:165907)，$\sum_j p_{jk}^2 = 1$）。这个值代表了在定义成分 $k$ 的方向时，变量 $j$ 所起作用的比例 。

载荷的**符号**（正或负）表示贡献的方向。在同一个主成分中，具有相同符号载荷的变量是正相关的（即它们倾向于以相同方向变化），而具有相反符号载荷的变量是负相关的。

#### 解释得分

如果说载荷定义了生物学“模式”，那么得分则量化了每个**样本**表达该模式的程度。得分向量 $t_k = X p_k$ 中的每个元素 $t_{ik}$ 是第 $i$ 个样本在第 $k$ 个主成分轴上的坐标。

- 一个[绝对值](@entry_id:147688)大的得分 $t_{ik}$ 意味着样本 $i$ 强烈地表现出由 $p_k$ 定义的分子特征。
- 得分的符号与载荷的符号结合起来解释。例如，如果 $t_{ik}$ 是一个大的正数，那么在样本 $i$ 中，那些在 $p_k$ 中有大的正载荷的基因倾向于高表达，而那些有大的负载荷的基因倾向于低表达。

通过绘制一个样本的得分（例如，PC2 vs. PC1），我们可以生成一个低维视图，观察样本间的关系。聚集成簇的样本在这些主导的生物学模式上是相似的。

### 高级解释与实践考量

超越基础解释，在[计算系统生物学](@entry_id:747636)中严谨地使用 PCA 需要考虑一些更深层次的问题。

#### 正交性谬误：不相关不等于独立

PCA 的一个核心数学特性是它产生的主成分是正交的（[载荷向量](@entry_id:635284)正交），并且得分是**不相关的** (uncorrelated)。这是一个常见的混淆点：统计上的不相关性并不等同于生物学上的**独立性** (independence)。

- **不相关**是一个线性概念，意味着两个变量的协[方差](@entry_id:200758)为零。
- **独立**是一个更强的概率概念，意味着一个变量的信息不能用来预测另一个变量。

只有当数据服从[联合高斯](@entry_id:636452)[分布](@entry_id:182848)时，不相关才等价于独立。然而，单细胞[转录组](@entry_id:274025)等生物学数据通常是高度非高斯的（例如，存在零膨胀、偏态和非线性关系）。因此，即使 PCA 发现了一个与“[细胞周期](@entry_id:140664)”相关的 PC1 和一个与“缺氧”相关的 PC2，并且它们是正交的，我们**不能**断定细胞周期和[缺氧](@entry_id:153785)这两个生物学过程是相互独立的。我们只能说，在数据中存在的主要线性变化模式中，这两个方向是不相关的。若要寻找统计上独立的来源，需要使用诸如[独立成分分析](@entry_id:261857) (Independent Component Analysis, ICA) 等方法 。

#### 对离群点的敏感性

经典 PCA 对离群点极其敏感。这是因为它所依赖的样本[协方差矩阵](@entry_id:139155)的**[影响函数](@entry_id:168646)** (influence function) 是无界的。[影响函数](@entry_id:168646)衡量了单个数据点对估计量的影响。对于[协方差矩阵](@entry_id:139155)，其影响与离群点到数据中心的距离的平方成正比。

这意味着一个极端的离群点（例如，一个技术伪迹或一个罕见的细胞类型）可以不成比例地“拉”动主成分的方向，使其指向该离群点，而不是反映数据主体的变异结构。这会严重扭曲载荷，使得基因模块的解释变得毫无意义，同时在[得分图](@entry_id:195133)中将所有正常样本压缩成一团，掩盖了它们内部的生物学结构。

为了解决这个问题，可以使用**稳健 PCA** (Robust PCA)。这些方法用一个具有有界[影响函数](@entry_id:168646)的稳健[协方差估计](@entry_id:145514)量（如最小协[方差](@entry_id:200758)[行列式](@entry_id:142978) (MCD) 或 Huberized 协[方差](@entry_id:200758)）来替代标准样本[协方差矩阵](@entry_id:139155)。通过限制或剔除离群点的影响，稳健 PCA 能够揭示数据主体中更稳定和可解释的生物学模式 。

#### 可复现性与符号模糊性

PCA 的载荷（[特征向量](@entry_id:151813)）的符号具有内在的模糊性。如果 $p_k$ 是一个有效的[载荷向量](@entry_id:635284)，那么 $-p_k$ 同样有效，因为它定义了相同的方向（轴）并解释了完全相同的[方差](@entry_id:200758)。相应地，得分向量也会变号，$t_k \to -t_k$。这种符号的任意性意味着，不同的软件实现或甚至同一软件的不同版本在处理 PCA 时可能会输出符号相反的载荷和得分。

这给生物学解释带来了麻烦。例如，“PC1 得分高的细胞上调了基因 X”这一陈述的真伪将取决于 PC1 的任意方向。为了确保分析的可复现性和解释的一致性，可以采用一个**确定性的符号约定**。一个常见且有效的约定是：对于每个主成分 $k$，找到其[载荷向量](@entry_id:635284) $p_k$ 中[绝对值](@entry_id:147688)最大的元素 $p_{jk}$，然后检查其符号。如果为负，则将 $p_k$ 和对应的得分向量 $t_k$ 同时反转符号。这个简单的规则通过将每个 PC 的方向“锚定”到其最具影响力的变量上，消除了模糊性，从而使得跨研究和平台的比较成为可能 。

#### 有监督的解释：整合外部信息

在系统生物学中，我们通常不仅仅是想探索数据，而是想将数据变异与某个特定的生物学问题（如疾病状态、治疗反应或通路活性）联系起来。PCA 可以作为一个强大的中间步骤，将高维的基因空间与低维的[表型空间](@entry_id:268006)联系起来。

一个严谨的基因优先排序策略如下 ：
1.  **选择相关的 PC**：首先，不是所有 PC 都有意义。计算每个 PC 的得分向量与感兴趣的外部表型（例如，一个连续的通路活性得分 $y$）之间的相关性或[回归系数](@entry_id:634860)。只选择那些与表型显著相关的 PC。
2.  **控制混杂因素**：在评估 PC 与表型的关联时，必须控制已知的技术混杂因素（如[批次效应](@entry_id:265859) $b$）。这可以通过[多元回归](@entry_id:144007)模型（例如，$\mathbf{t}_k \sim \alpha_y y + \alpha_b b$）来实现，并选择那些与 $y$ 显著相关但与 $b$ 无关的 PC。
3.  **在相关 PC 内对基因进行排序**：对于每个选定的 PC，使用其贡献度 $c_{jk} = p_{jk}^2$ 对基因进行排序。贡献度高的基因是定义这个与表型相关的生物学模式的关键。
4.  **推断[方向性](@entry_id:266095)**：基因对表型的作用方向（促进或抑制）取决于两个符号的乘积：PC得分与表型的关联方向（例如，$\text{corr}(\mathbf{t}_k, y)$ 的符号）和基因在PC中的载荷符号 ($p_{jk}$)。
5.  **评估稳定性**：由于 PCA 载荷可能不稳定，尤其是在 $p \gg n$ 的情况下，通过重采样技术（如[自助法](@entry_id:139281) bootstrapping）来验证高贡献度基因的稳定性是进行昂贵的实验验证前的一个关键步骤。

### 特殊[数据结构](@entry_id:262134)的处理：[成分数据](@entry_id:153479)

最后，一个重要的警告是，标准 PCA 并不适用于所有类型的数据。一个在微生物组学和[代谢组学](@entry_id:148375)中常见的例子是**[成分数据](@entry_id:153479)** (compositional data)，其特点是数据向量中各部分的总和为一个常数（通常为 1），例如[相对丰度](@entry_id:754219)。

直接将 PCA 应用于这类数据是错误的，因为**单位和约束** (unit-sum constraint) 会在数据中引入虚假的负相关。例如，如果一个物种的丰度增加，其他物种的[相对丰度](@entry_id:754219)必然会减少，即使它们在生态上是无关的。这使得协方差矩阵变得奇异，并且其结构被分析伪影所主导。

处理[成分数据](@entry_id:153479)的原则性方法是在 PCA 之前应用一个对数比变换。最常用的变换是**中心化对数比变换** (Centered Log-Ratio, CLR)：

$$ y_j = \operatorname{clr}(x)_j = \ln\left(\frac{x_j}{g(x)}\right) $$

其中 $g(x)$ 是样本 $x$ 中所有组分的几何平均值。这个变换将数据从单纯形（simplex）映射到一个标准的[欧几里得空间](@entry_id:138052)，其中各分量之和为零。在此 CLR 变换后的数据上执行 PCA 是统计上有效的。

其结果的解释也相应改变 ：
- **载荷**：在 CLR-PCA 中，[载荷向量](@entry_id:635284)的元素之和为零。它不再代表绝对贡献，而是定义了一个**对数反差** (log-contrast)。[载荷向量](@entry_id:635284)将变量分为两组（正载荷和负载荷），而得分则量化了这两组变量加权几何平均值之间的对数比，即一个“平衡”。
- **得分**：得分的高低反映了样本中由载荷定义的两组分之间的相对优势。

这种方法尊重了[成分数据](@entry_id:153479)的相对性质，并确保了分析结果对[测序深度](@entry_id:178191)等缩放因子具有不变性，从而能够得出有意义的生物学结论。