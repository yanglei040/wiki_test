{
    "hands_on_practices": [
        {
            "introduction": "对数据集进行训练的主成分分析（PCA）定义了一个新的、方差最大化的坐标系。一个常见且至关重要的任务是确定新的数据点在这个已建立的系统中的位置。本练习将引导你完成将新样本投影到主成分上的基本推导，并强调一个关键原则：新样本必须经过与原始训练数据完全相同的预处理步骤，以确保科学上有效的比较。",
            "id": "3321042",
            "problem": "一项转录组学研究测量了 $n$ 个训练样本中 $m$ 个基因的信使RNA (mRNA) 丰度，并对预处理后的训练数据执行主成分分析 (PCA)。预处理流程包括对所有训练样本应用一个固定的变换（对数变换以稳定方差），然后在整个训练队列中进行均值中心化。除了均值中心化外，不应用任何方差缩放。通过计算均值中心化数据的样本协方差矩阵并进行特征分解，来训练 PCA 模型，从而获得一个正交标准载荷矩阵 $P \\in \\mathbb{R}^{m \\times k}$，其列是对应于前 $k$ 个最大特征值的特征向量。训练样本的得分坐标定义为其均值中心化向量在载荷子空间上的正交投影。\n\n对于一个测量值由 $x_{\\mathrm{new}} \\in \\mathbb{R}^{m}$ 表示的新生物学重复样本，必须按照与训练流程一致的方式将其投影到训练好的主成分子空间中。从正交投影到正交标准基的核心定义以及从预处理训练数据协方差的特征分解构建 PCA 出发，推导 $x_{\\mathrm{new}}$ 的得分坐标关于训练均值向量 $\\hat{\\mu}$ 和载荷矩阵 $P$ 的表达式。解释为什么在计算系统生物学背景下，为了科学上的一致性和可解释性，有必要对 $x_{\\mathrm{new}}$ 应用与训练数据相同的预处理（包括固定变换和通过 $\\hat{\\mu}$ 进行的中心化）。\n\n然后，将你的推导应用于以下具有 $m=3$ 个变量和 $k=2$ 个成分的科学上合理的代谢物组。训练得到的载荷矩阵（其列是正交标准的）和预处理后计算出的训练均值向量为\n$$\nP \\;=\\; \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{6}} \\\\\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{6}} \\\\\n0  \\frac{2}{\\sqrt{6}}\n\\end{pmatrix},\n\\qquad\n\\hat{\\mu} \\;=\\; \\begin{pmatrix} 5 \\\\ 7 \\\\ 4 \\end{pmatrix}.\n$$\n一个新样本，在应用了与训练中相同的固定变换后，其测量值为\n$$\nx_{\\mathrm{new}} \\;=\\; \\begin{pmatrix} 6 \\\\ 8.5 \\\\ 3 \\end{pmatrix}.\n$$\n根据你推导的投影表达式，计算这个新样本的第一主成分得分。将你的数值答案四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "所述问题是有效的。它提出了一个在计算系统生物学中涉及主成分分析 (PCA) 应用的标准、适定场景。其前提在科学上是合理的，定义清晰，并且为求解提供了所有必需信息。\n\n主要任务是推导一个新样本 $x_{\\mathrm{new}}$ 投影到由训练数据集构建的 PCA 空间中的得分坐标表达式。这需要系统地应用线性代数知识和对 PCA 方法的理解。\n\n设训练数据由一个矩阵表示，其中 $n$ 列中的每一列都是一个包含 $m$ 个测量值（例如基因丰度）的样本向量。对训练数据的预处理流程包括逐元素应用一个固定的变换函数 $f$，然后进行均值中心化。设 $x'_{i}$ 是应用 $f$ 后的第 $i$ 个训练样本。训练均值向量 $\\hat{\\mu}$ 由这些变换后的样本计算得出：\n$$ \\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^{n} x'_{i} $$\n最终的预处理训练向量 $\\tilde{x}_i$ 是均值中心化后的向量：\n$$ \\tilde{x}_i = x'_{i} - \\hat{\\mu} $$\nPCA 是通过寻找向量集合 $\\{\\tilde{x}_i\\}_{i=1}^n$ 的样本协方差矩阵的特征向量来执行的。载荷矩阵 $P \\in \\mathbb{R}^{m \\times k}$ 是通过将其列设为与 $k$ 个最大特征值相对应的 $k$ 个正交标准特征向量来构建的。这些列 $\\{p_1, p_2, \\dots, p_k\\}$ 构成了主子空间的一个正交标准基，该子空间捕获了训练数据的最大方差。\n\n预处理空间中任何向量的得分坐标都是通过将其投影到这个正交标准基上找到的。对于一个预处理过的训练样本 $\\tilde{x}_i$，其得分向量 $s_i \\in \\mathbb{R}^k$ 是通过计算其与每个基向量的点积得到的。第 $j$ 个得分 $s_{ij}$ 是 $p_j^T \\tilde{x}_i$。其矩阵形式为：\n$$ s_i = P^T \\tilde{x}_i $$\n对于一个原始测量值为 $x_{\\mathrm{raw, new}}$ 的新样本，只有当它经历与训练数据完全相同的预处理变换时，其在 PCA 空间中的投影才有意义。这是科学一致性和可解释性的一个基本要求。\n$1$. 应用固定变换 $f$：$x_{\\mathrm{new}} = f(x_{\\mathrm{raw, new}})$。问题直接提供了这个变换后的向量。\n$2$. 使用*训练数据的均值向量* $\\hat{\\mu}$ 对该向量进行中心化。这一步至关重要，因为主成分是相对于训练数据云的中心定义的。为了将新样本与训练样本进行比较，必须将其置于同一坐标系中，这必然要求使用 $\\hat{\\mu}$ 作为原点。\n因此，正确预处理的新向量是：\n$$ \\tilde{x}_{\\mathrm{new}} = x_{\\mathrm{new}} - \\hat{\\mu} $$\n然后通过相同的投影操作找到这个新样本的得分坐标 $s_{\\mathrm{new}}$：\n$$ s_{\\mathrm{new}} = P^T \\tilde{x}_{\\mathrm{new}} $$\n代入 $\\tilde{x}_{\\mathrm{new}}$ 的表达式，我们得到将一个新的（变换后的）样本 $x_{\\mathrm{new}}$ 投影到训练好的 PCA 空间的通用公式：\n$$ s_{\\mathrm{new}} = P^T (x_{\\mathrm{new}} - \\hat{\\mu}) $$\n这个推导过程强调了为什么一致的预处理不仅仅是一个程序性步骤，更是一个概念上的必然要求。由 $P$ 和 $\\hat{\\mu}$ 定义的 PCA 模型，构成了从原始数据空间到主成分空间的一个固定映射。从得分中得出的科学结论依赖于为所有样本（包括训练样本和新样本）保持此映射的完整性。\n\n现在，我们将此推导出的表达式应用于具体的数值问题。给定值为：\n$$\nP \\;=\\; \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{6}} \\\\\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{6}} \\\\\n0  \\frac{2}{\\sqrt{6}}\n\\end{pmatrix},\n\\qquad\n\\hat{\\mu} \\;=\\; \\begin{pmatrix} 5 \\\\ 7 \\\\ 4 \\end{pmatrix},\n\\qquad\nx_{\\mathrm{new}} \\;=\\; \\begin{pmatrix} 6 \\\\ 8.5 \\\\ 3 \\end{pmatrix}.\n$$\n首先，我们计算中心化后的向量 $\\tilde{x}_{\\mathrm{new}}$：\n$$\n\\tilde{x}_{\\mathrm{new}} = x_{\\mathrm{new}} - \\hat{\\mu} = \\begin{pmatrix} 6 \\\\ 8.5 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 5 \\\\ 7 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1.5 \\\\ -1 \\end{pmatrix}.\n$$\n问题要求计算第一主成分得分，我们将其记为 $s_{\\mathrm{new}, 1}$。这是 $\\tilde{x}_{\\mathrm{new}}$ 在第一主成分向量 $p_1$（即 $P$ 的第一列）上的投影。\n$$\np_1 = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n该得分计算为点积 $p_1^T \\tilde{x}_{\\mathrm{new}}$：\n$$\ns_{\\mathrm{new}, 1} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1.5 \\\\ -1 \\end{pmatrix} = (1)\\left(\\frac{1}{\\sqrt{2}}\\right) + (1.5)\\left(\\frac{1}{\\sqrt{2}}\\right) + (-1)(0).\n$$\n$$\ns_{\\mathrm{new}, 1} = \\frac{1 + 1.5}{\\sqrt{2}} = \\frac{2.5}{\\sqrt{2}}.\n$$\n对此表达式进行数值计算：\n$$\ns_{\\mathrm{new}, 1} = \\frac{2.5}{\\sqrt{2}} \\approx 1.76776695...\n$$\n根据要求，将结果四舍五入到四位有效数字，得到 $1.768$。",
            "answer": "$$\\boxed{1.768}$$"
        },
        {
            "introduction": "执行PCA后，一个关键问题随之而来：我们应该解释多少个主成分？尽管存在一些启发式方法，如碎石图的“拐点”或累积方差阈值，但严谨的科学解释需要更多考量。本练习通过一个真实的转录组学场景，展示了领域知识在剖析每个主成分含义时的重要性，教你如何区分真实的生物信号、技术性伪影，甚至是那些否则可能被忽略的稀有但重要的亚群。",
            "id": "3321098",
            "problem": "一项转录组学研究测量了 $n$ 个样本中 $p$ 个基因的信使RNA丰度，得到一个数据矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$，其列（基因）已经过对数转换、中心化，并跨样本缩放至单位方差。对样本协方差矩阵 $\\mathbf{S} = \\frac{1}{n-1}\\mathbf{X}^{\\top}\\mathbf{X}$ 执行主成分分析 (PCA, Principal Component Analysis)。$\\mathbf{S}$ 的特征值按降序排列为 $\\lambda_{1} \\ge \\lambda_{2} \\ge \\cdots \\ge \\lambda_{p} \\ge 0$，相应的标准正交特征向量给出了载荷，主成分得分是样本在这些特征向量上的投影。对于该数据集，前六个主成分解释的方差比例分别为 $0.38$、$0.22$、$0.09$、$0.04$、$0.02$ 和 $0.01$。剩余的方差分布在更高阶的成分中。载荷和得分的诊断分析揭示了以下几点：\n- 主成分 $1$ 的得分与每个样本的唯一分子标识符 (UMI, Unique Molecular Identifier) 计数强相关 ($r \\approx 0.93$)，其载荷富集了核糖体和线粒体基因集，这表明存在技术性或组成性效应。\n- 主成分 $2$ 的得分与干扰素治疗剂量相关 ($r \\approx 0.81$)，其载荷富集了干扰素刺激基因，这表明存在治疗梯度。\n- 主成分 $3$ 的得分与两个测序批次的批次标签一致 ($r \\approx 0.88$)，并与RNA完整性数值 (RIN, RNA Integrity Number) 负相关 ($r \\approx -0.62$)，其载荷包括应激反应和线粒体基因，这表明存在批次/质量伪影。\n- 主成分 $4$ 在一组紧凑的T细胞标记基因上具有较大的正载荷；大约只有 $5\\%$ 的样本在主成分 $4$ 上有较高的正得分，且这些得分与独立的流式细胞术对一种罕见T细胞亚群的估计相关 ($r \\approx 0.77$)，这表明存在一个具有生物学意义但患病率低的亚群。\n\n仅使用PCA的标准定义（$\\mathbf{S}$ 的特征分解以及将特征值解释为主成分方差），推导累积解释方差作为成分数量 $k$ 的函数的通用表达式，然后，结合累积方差曲线和上述载荷与得分中编码的领域知识，决定在这项研究中您将解释多少个成分，并说明原因。\n\n选择唯一一个既能从第一性原理正确推导出累积解释方差函数，又能为在这种情况下解释 $k$ 的选择提供合理解释的选项。\n\nA. $C(k) = \\dfrac{\\sum_{i=1}^{k} \\sigma_{i}}{\\sum_{j=1}^{\\min(n,p)} \\sigma_{j}}$，其中 $\\sigma_{i}$ 是中心化 $\\mathbf{X}$ 的奇异值；选择 $k=2$，因为在主成分 $2$ 之后有一个明显的“肘部”，并且即使其他成分显示出特定的基因集富集，它们也很小，可以忽略。\n\nB. $C(k) = \\dfrac{\\sum_{i=1}^{k} \\lambda_{i}}{\\sum_{j=1}^{p} \\lambda_{j}}$，其中 $\\lambda_{i}$ 是 $\\mathbf{S}$ 的特征值；选择检查至多 $k=4$ 个成分，因为 $C(4) = 0.38+0.22+0.09+0.04 = 0.73$ 超过了探索性解释的合理信息捕获目标，主成分 $2$ 捕获了治疗梯度，主成分 $1$ 和主成分 $3$ 是需要控制而不是进行生物学解释的技术/混杂效应，而主成分 $4$——尽管方差很低——与一个罕见但经过生物学验证的T细胞亚群一致。\n\nC. $C(k) = \\dfrac{\\sum_{i=1}^{k} \\lambda_{i}}{\\sum_{j=1}^{p} \\lambda_{j}}$，其中 $\\lambda_{i}$ 是 $\\mathbf{S}$ 的特征值；选择使 $C(k) \\ge 0.80$ 的最小 $k$ 值，如果需要，这可能需要包含远多于 $6$ 个成分，因为解释方差应是唯一标准，即使后面的成分具有嘈杂的载荷且没有明确的生物学关联。\n\nD. $C(k) = \\sum_{g=1}^{p} \\ell_{gk}^{2}$，其中 $\\ell_{gk}$ 是基因 $g$ 在成分 $k$ 上的载荷；选择 $k=3$，因为前三个成分的平方载荷之和很大，而主成分 $4$ 解释的方差很小，无论其基因水平的解释如何都应被丢弃。",
            "solution": "用户提供了一个关于对转录组数据集执行主成分分析 (PCA, Principal Component Analysis) 的解释问题。任务是验证问题陈述，推导累积解释方差的表达式，并为保留用于解释的成分数量 $k$ 提供理由。\n\n### 步骤 1：提取给定信息\n\n- 数据矩阵：$\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$，表示 $p$ 个基因和 $n$ 个样本。\n- 数据预处理：列（基因）经过对数转换、中心化和单位方差缩放。\n- PCA 流程：对样本协方差矩阵 $\\mathbf{S} = \\frac{1}{n-1}\\mathbf{X}^{\\top}\\mathbf{X}$ 进行特征分解。\n- $\\mathbf{S}$ 的特征值：$\\lambda_{1} \\ge \\lambda_{2} \\ge \\cdots \\ge \\lambda_{p} \\ge 0$。\n- 载荷：$\\mathbf{S}$ 的标准正交特征向量。\n- 得分：样本在特征向量上的投影。\n- 主成分 (PCs) $1$ 至 $6$ 的观测解释方差比例：$0.38$、$0.22$、$0.09$、$0.04$、$0.02$ 和 $0.01$。\n- PC1 解释：与每个样本的唯一分子标识符 (UMI, Unique Molecular Identifier) 计数相关 ($r \\approx 0.93$)；载荷富集了核糖体和线粒体基因；表明存在技术性/组成性效应。\n- PC2 解释：与干扰素治疗剂量相关 ($r \\approx 0.81$)；载荷富集了干扰素刺激基因；表明存在治疗梯度。\n- PC3 解释：与批次标签相关 ($r \\approx 0.88$) 并与RNA完整性数值 (RIN, RNA Integrity Number) 负相关 ($r \\approx -0.62$)；载荷包括应激反应和线粒体基因；表明存在批次/质量伪影。\n- PC4 解释：在T细胞标记基因上具有较大的正载荷；约 $5\\%$ 的样本具有高正得分，这些得分与流式细胞术对一种罕见T细胞亚群的估计相关 ($r \\approx 0.77$)；表明存在具有生物学意义的亚群。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n问题陈述在科学上是合理的、定义明确且客观的。\n1.  **科学基础**：该设置描述了转录组学中PCA的标准工作流程。数据矩阵维度、预处理步骤（对数转换、中心化、缩放）、协方差矩阵 $\\mathbf{S}$ 的定义，以及其特征分解与PCA结果之间的关系（特征值作为成分方差，特征向量作为载荷）都是该方法正确且基础的部分。对已经缩放至单位方差的数据使用协方差矩阵，等同于使用相关矩阵，这是一种标准且有效的方法。生物学背景，包括提及UMI、RIN、批次效应、干扰素刺激和细胞亚群识别，都是现代基因组学中非常现实和常见的主题。\n2.  **定义明确**：问题要求进行推导和论证，这两者都可以使用所提供的信息和标准统计理论来解决。可以得出一个独特的、有意义的结论。\n3.  **客观性**：问题使用精确的定量语言（例如，相关系数、方差比例）陈述，并避免了主观性陈述。对PC的解释使用了“表明”一词进行限定，这对于探索性数据分析是恰当的。\n\n问题陈述没有任何使其无效的缺陷。它内部一致，有科学依据，并提供了进行解答所需的所有必要信息。\n\n### 步骤 3：结论和行动\n\n该问题是**有效的**。我将继续推导解决方案并评估各个选项。\n\n### 解决方案推导\n\n第一个任务是推导由前 $k$ 个主成分解释的累积方差比例 $C(k)$ 的通用表达式。\n\n数据集的总方差是单个变量（基因）方差的总和。问题陈述中提到，数据矩阵 $\\mathbf{X}$ 的基因列已经过中心化并缩放至单位方差。设 $\\mathbf{X}$ 的第 $j$ 列为 $\\mathbf{x}_j$。那么，对于 $j=1, \\ldots, p$，$\\text{Var}(\\mathbf{x}_j) = 1$。\n因此，数据集中的总方差为：\n$$\n\\text{Total Variance} = \\sum_{j=1}^{p} \\text{Var}(\\mathbf{x}_j) = \\sum_{j=1}^{p} 1 = p\n$$\n样本协方差矩阵由 $\\mathbf{S} = \\frac{1}{n-1}\\mathbf{X}^{\\top}\\mathbf{X}$ 给出。该矩阵的对角元素 $S_{jj}$ 表示基因的样本方差。由于数据被缩放至单位方差，对于所有 $j=1, \\ldots, p$，都有 $S_{jj} = 1$。\n方阵的迹是其对角线元素之和。因此，协方差矩阵的迹等于总方差：\n$$\n\\text{Tr}(\\mathbf{S}) = \\sum_{j=1}^{p} S_{jj} = \\sum_{j=1}^{p} 1 = p\n$$\n线性代数的一个基本性质是，矩阵的迹也等于其特征值之和。设 $\\mathbf{S}$ 的特征值为 $\\lambda_1, \\lambda_2, \\ldots, \\lambda_p$。\n$$\n\\text{Tr}(\\mathbf{S}) = \\sum_{j=1}^{p} \\lambda_j\n$$\n因此，数据集中的总方差由协方差矩阵的特征值之和捕获：$\\sum_{j=1}^{p} \\lambda_j = p$。\n\n在PCA中，第 $i$ 个主成分捕获的方差等于第 $i$ 个特征值 $\\lambda_i$。由前 $k$ 个成分解释的累积方差是它们各自方差的总和：$\\sum_{i=1}^{k} \\lambda_i$。\n解释方差的累积*比例* $C(k)$ 是该累积方差与总方差的比率。\n$$\nC(k) = \\frac{\\text{由前 } k \\text{ 个PC解释的方差}}{\\text{总方差}} = \\frac{\\sum_{i=1}^{k} \\lambda_{i}}{\\sum_{j=1}^{p} \\lambda_{j}}\n$$\n这个表达式是正确的通用公式。\n\n第二个任务是决定要解释多少个成分。这需要同时考虑解释的方差和每个成分的生物学/技术意义。\n- **PC1 (38% 方差)**：被识别为与测序深度（UMI计数）相关的主要技术伪影。这是一个关键发现，因为它代表了一个强大的混杂效应，在任何下游分析中都必须加以考虑。它必须被解释，但应作为混杂因素，而不是感兴趣的生物学信号。\n- **PC2 (22% 方差)**：捕获了感兴趣的生物学效应（干扰素治疗梯度）。这个成分是研究目标的核心。\n- **PC3 (9% 方差)**：被识别为另一个与批次和样本质量（RIN）相关的技术伪影。与PC1类似，这是一个需要识别的重要混杂因素。\n- **PC4 (4% 方差)**：虽然解释的方差很小，但该成分分离出了一个罕见但具有生物学意义的细胞亚群，并由流式细胞术独立验证。在探索性研究中，发现这种微妙的、低流行率的生物信号是一个主要目标。如果因其低方差而丢弃该成分，将是一个重大的科学错误，因为这意味着忽视一个关键发现。\n\n在此处，使用诸如碎石图的“肘部”（可能出现在PC2之后，方差从 $0.22$ 下降到 $0.09$）或固定的方差截止值之类的简单方法是不合适的。复杂的分析需要解释所有揭示重要结构的成分，无论它是感兴趣的生物信号、混杂的技术变量，还是罕见但经过验证的生物现象。因此，为了全面了解数据结构，必须检查*至少*前四个成分。PC1和PC3揭示了关键的混杂因素，PC2捕获了主要的实验信号，而PC4则揭示了一个重要的次要生物学发现。\n\n### 逐项分析选项\n\n**A. $C(k) = \\dfrac{\\sum_{i=1}^{k} \\sigma_{i}}{\\sum_{j=1}^{\\min(n,p)} \\sigma_{j}}$，其中 $\\sigma_{i}$ 是中心化 $\\mathbf{X}$ 的奇异值；选择 $k=2$，因为在主成分 $2$ 之后有一个明显的“肘部”，并且即使其他成分显示出特定的基因集富集，它们也很小，可以忽略。**\n\n- **公式**：该公式不正确。PC的方差与相应奇异值的*平方*成正比（$\\lambda_i \\propto \\sigma_i^2$），而不是奇异值本身。正确的公式应包含 $\\sigma_i^2$。\n- **理由**：理由有缺陷。它提倡使用简单的“肘部”法则，并明确建议忽略可解释的成分，如果它们的方差很小。这与探索性数据分析的原则相矛盾，后者的一个主要目标是发现微妙但有意义的信号（如PC4中的信号）。\n- **结论**：**错误**。\n\n**B. $C(k) = \\dfrac{\\sum_{i=1}^{k} \\lambda_{i}}{\\sum_{j=1}^{p} \\lambda_{j}}$，其中 $\\lambda_{i}$ 是 $\\mathbf{S}$ 的特征值；选择检查至多 $k=4$ 个成分，因为 $C(4) = 0.38+0.22+0.09+0.04 = 0.73$ 超过了探索性解释的合理信息捕获目标，主成分 $2$ 捕获了治疗梯度，主成分 $1$ 和主成分 $3$ 是需要控制而不是进行生物学解释的技术/混杂效应，而主成分 $4$——尽管方差很低——与一个罕见但经过生物学验证的T细胞亚群一致。**\n\n- **公式**：这个公式 $C(k) = \\frac{\\sum_{i=1}^{k} \\lambda_{i}}{\\sum_{j=1}^{p} \\lambda_{j}}$ 是正确的，如上文推导所示。\n- **理由**：理由非常出色。它正确地计算了累积方差 $C(4) = 0.73$。最重要的是，它通过平衡解释方差与每个成分的科学意义，展示了对PCA解释的深刻理解。它正确地识别了PC1/PC3作为混杂因素、PC2作为主要信号以及PC4作为关键（尽管方差较低）的生物学发现的角色。这一推理在科学上是合理的，在方法上是严谨的。\n- **结论**：**正确**。\n\n**C. $C(k) = \\dfrac{\\sum_{i=1}^{k} \\lambda_{i}}{\\sum_{j=1}^{p} \\lambda_{j}}$，其中 $\\lambda_{i}$ 是 $\\mathbf{S}$ 的特征值；选择使 $C(k) \\ge 0.80$ 的最小 $k$ 值，如果需要，这可能需要包含远多于 $6$ 个成分，因为解释方差应是唯一标准，即使后面的成分具有嘈杂的载荷且没有明确的生物学关联。**\n\n- **公式**：公式是正确的。\n- **理由**：理由在科学上是贫乏的。它依赖于一个任意的方差截止值（$0.80$），并明确指出应忽略成分的解释。这是对PCA的一种机械化、欠思考的应用，有可能会错过重要的发现（如PC4），并包含无法解释的噪声。PCA的目的是获得科学洞见，而不是盲目地进行数据压缩。前6个PC的累积方差为 $0.38+0.22+0.09+0.04+0.02+0.01 = 0.76$，因此该规则将强制包含没有可用解释的成分，这不是一个合理的策略。\n- **结论**：**错误**。\n\n**D. $C(k) = \\sum_{g=1}^{p} \\ell_{gk}^{2}$，其中 $\\ell_{gk}$ 是基因 $g$ 在成分 $k$ 上的载荷；选择 $k=3$，因为前三个成分的平方载荷之和很大，而主成分 $4$ 解释的方差很小，无论其基因水平的解释如何都应被丢弃。**\n\n- **公式**：该公式不正确。成分 $k$ 的载荷向量是 $\\mathbf{S}$ 的第 $k$ 个特征向量。这些特征向量被定义为标准正交的，意味着它们的欧几里得范数为 $1$。因此，对于任何成分 $k$，$\\sum_{g=1}^{p} \\ell_{gk}^{2} = 1$。此表达式不是累积方差比例。\n- **理由**：推理基于一个错误的前提，即“前三个成分的平方载荷之和很大”。此外，建议“无论其基因水平的解释如何”都丢弃PC4，这是对选项A和C中看到的相同基本错误的重复，即将简单的统计启发式方法置于科学洞见之上。\n- **结论**：**错误**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "当PCA在预测建模任务之前用于降维时，将其整合到交叉验证方案中充满了潜在的陷阱。其中最危险的是数据泄漏，即来自测试集的信息无意中影响了训练过程，导致了具有误导性的乐观性能和不可复现的发现。本练习要求你辨别结合PCA和交叉验证的正确与错误方法，从而巩固你对如何构建稳健且可泛化的生物信息学流程的理解。",
            "id": "3321102",
            "problem": "一个研究团队正在分析一个单细胞核糖核酸测序 (RNA-seq) 数据集，以发现与免疫刺激相关的通路水平的变异。该数据集包含一个基因表达矩阵，其中有 $n = 2000$ 个细胞和 $p = 10000$ 个基因，以及一个指示刺激组与对照组的二元条件标签。他们计划使用主成分分析 (PCA) 进行降维，然后使用一个通过 $K$-折交叉验证（$K=5$）评估的分类器。预处理流程包括对每个基因进行中心化和缩放。\n\n考虑了两种流程：\n\n- 流程 $\\mathcal{T}$：在每一折中，仅使用该折的训练数据重新拟合 PCA，以估计载荷以及中心化/缩放参数。通过应用训练折的中心化/缩放并将数据投影到训练折的载荷上，来转换留出的细胞以获得主成分得分。分类器在训练折的得分上进行训练，并在留出折的得分上进行评估。\n\n- 流程 $\\mathcal{L}$：使用所有 $n$ 个细胞一次性拟合 PCA，以估计载荷以及中心化/缩放参数。在每一折中，训练细胞和留出细胞都使用这些全局参数和载荷进行转换。分类器如流程 $\\mathcal{T}$ 中一样进行训练和评估。\n\n经验上，当使用 $m = 20$ 个主成分时，流程 $\\mathcal{L}$ 产生的交叉验证的受试者工作特征曲线下面积 (AUROC) 比流程 $\\mathcal{T}$ 略高，并且研究团队还观察到前几个主成分与条件标签高度一致。\n\n根据 PCA 的核心定义（即最大化训练数据协方差方差的正交归一方向）以及交叉验证估计要求训练衍生的转换与留出评估之间保持独立性的原则，回答以下多项选择题：\n\n关于为什么 PCA 必须仅在训练折上重新拟合，并通过投影计算留出得分，以及数据泄露如何引入解释性偏差，以下哪些陈述是正确的？\n\nA. 在 $K$-折交叉验证中，对所有 $n$ 个样本拟合 PCA 会导致数据泄露，因为特征向量依赖于留出的数据，这使得下游的性能估计（例如 AUROC）出现乐观偏差。\n\nB. 获得留出主成分得分的有效方法是，使用训练折的统计数据对留出的样本进行中心化和缩放，然后投影到训练折的载荷向量上；这保留了无偏风险估计所需的独立性。\n\nC. 因为 PCA 是无监督的，不使用标签，所以在交叉验证中对完整数据集拟合 PCA 是可以接受的，并且不会引入泄露。\n\nD. PCA 中的泄露会使生物学解释产生偏差：绝对载荷值大的基因可能被过分强调为对条件分离具有生物学重要性，因为载荷受到了留出数据结构的影响，这混淆了探索性分析和验证性分析。\n\nE. 在每个折的训练数据上重新拟合 PCA 会使得各折之间的主成分方向不具可比性，即使存在跨折一致的模式，也会使通路水平的解释在形式上无效。\n\n选择所有适用的选项。",
            "solution": "问题陈述提出了一个场景，在一个 $K$-折交叉验证框架内，比较了两种数据分析流程 $\\mathcal{T}$ 和 $\\mathcal{L}$ 对单细胞 RNA-seq 数据集的处理。问题的核心在于如何正确应用主成分分析 (PCA) 作为后续分类任务的预处理步骤，以及不正确的应用（数据泄露）对性能评估和生物学解释的影响。\n\n首先，让我们将过程形式化。数据集是一个矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$，其中有 $n=2000$ 个细胞和 $p=10000$ 个基因。每个细胞都有一个二元标签。$K$-折交叉验证的目标是将数据划分为 $K$ 个折，对于每个折 $k \\in \\{1, ..., K\\}$，将第 $k$ 个折作为留出的测试集，其余 $K-1$ 个折作为训练集。这个过程重复 $K$ 次，并将性能指标（例如 AUROC）在各折之间取平均。其基本原则是，任何一折的测试集都必须完全独立于整个模型拟合过程，这包括任何依赖于数据的预处理步骤。\n\n流程 $\\mathcal{L}$ 违反了这一原则。它在交叉验证循环*之前*对整个数据集 $\\mathbf{X}$ 进行了 PCA 拟合。这意味着中心化参数（均值 $\\boldsymbol{\\mu}$）、缩放参数（标准差 $\\boldsymbol{\\sigma}$）和 PCA 载荷向量（整个数据集协方差矩阵的特征向量，我们可以表示为 $\\mathbf{W}$）都是使用所有 $n$ 个细胞的信息确定的。在每个交叉验证的折中，留出的数据是用于计算 $\\boldsymbol{\\mu}$、$\\boldsymbol{\\sigma}$ 和 $\\mathbf{W}$ 的数据集的一部分。这构成了数据泄露。\n\n流程 $\\mathcal{T}$ 代表了正确的程序。在每个折 $k$ 中，中心化参数 $\\boldsymbol{\\mu}^{(k)}$、缩放参数 $\\boldsymbol{\\sigma}^{(k)}$ 和载荷向量 $\\mathbf{W}^{(k)}$ 都*仅*使用该折的训练数据来估计。然后，使用这些预先确定的、特定于训练折的参数来转换留出的数据。这模仿了真实世界的应用场景，即在一个可用的数据集上训练一个模型流程，然后将其应用于新的、未见过的数据，从而提供对模型泛化性能的无偏估计。\n\n流程 $\\mathcal{L}$ 产生比流程 $\\mathcal{T}$ 更高 AUROC 的经验观察是数据泄露的典型症状。流程 $\\mathcal{L}$ 中的模型具有不公平的优势，因为它使用的特征空间（主成分）是在部分了解测试集数据结构的情况下构建的。\n\n基于这些原则，我们评估每个陈述。\n\n**A. 在 $K$-折交叉验证中，对所有 $n$ 个样本拟合 PCA 会导致数据泄露，因为特征向量依赖于留出的数据，这使得下游的性能估计（例如 AUROC）出现乐观偏差。**\n\n该陈述是正确的。PCA 寻找数据协方差矩阵的特征向量（载荷）。在流程 $\\mathcal{L}$ 中，协方差矩阵是从所有 $n$ 个样本计算得出的。因此，对于任何给定的折，留出集中的数据影响了这些特征向量的计算。这些特征向量定义了所有数据（包括留出数据）被投影到的坐标系。因为应用于留出数据的转换依赖于该数据本身，所以无偏性能估计所需的独立性被破坏了。这种从测试集到模型训练过程的信息泄露通常会导致过于乐观的性能估计。观察到流程 $\\mathcal{L}$ 的 AUROC 更高，正是这种乐观偏差的直接后果。\n**结论：正确。**\n\n**B. 获得留出主成分得分的有效方法是，使用训练折的统计数据对留出的样本进行中心化和缩放，然后投影到训练折的载荷向量上；这保留了无偏风险估计所需的独立性。**\n\n该陈述准确地描述了正确的程序，即流程 $\\mathcal{T}$ 所体现的。为了获得泛化误差（或风险）的无偏估计，整个模型拟合过程必须对测试集“不可见”。这个“过程”包括所有数据依赖的转换。因此，用于中心化和缩放的统计数据（均值和标准差）以及 PCA 载荷向量必须仅从给定折的训练数据中计算。然后，使用这些固定的、从训练中派生的参数来转换留出的数据。这个程序保留了模型开发生态系统与用于评估的数据之间的关键独立性，这是有效交叉验证的基石。\n**结论：正确。**\n\n**C. 因为 PCA 是无监督的，不使用标签，所以在交叉验证中对完整数据集拟合 PCA 是可以接受的，并且不会引入泄露。**\n\n该陈述是不正确的，并阐述了一个常见但关键的谬误。PCA 是“无监督的”（即它不使用类别标签 $\\mathbf{y}$）这一事实与在此背景下的数据泄露问题无关。泄露的发生是因为关于测试集*特征*的信息（其分布和协方差结构）被用来定义特征转换（主成分）。任何数据驱动的转换，无论是否是监督的，都必须包含在交叉验证循环内，并且只能从数据的训练部分学习，以确保无偏的性能估计。主成分是特征工程步骤的参数，和所有模型参数一样，它们必须在不接触测试集的情况下学习。\n**结论：不正确。**\n\n**D. PCA 中的泄露会使生物学解释产生偏差：绝对载荷值大的基因可能被过分强调为对条件分离具有生物学重要性，因为载荷受到了留出数据结构的影响，这混淆了探索性分析和验证性分析。**\n\n该陈述是正确的。数据泄露的后果不仅限于虚高的性能指标，还延伸到从模型中得出的科学结论。在生物信息学中，PCA 载荷常被用来解释，以确定哪些原始变量（基因）驱动了主成分所捕获的方差。问题陈述中提到，前几个主成分与条件标签一致。在有泄露的流程 $\\mathcal{L}$ 中，这些主成分被定义为最大化*整个*数据集的方差。因此，它们通过预知测试数据的结构，“非自然地”与分离条件对齐。当研究人员解释这样一个“有泄露”的 PC 的基因载荷时，他们可能会错误地将强烈的生物学重要性归因于那些看起来能分离条件的基因。这个结论是有偏的，因为主成分本身已经被来自测试集的信息所污染。它混淆了探索阶段（在训练数据中发现模式）和验证阶段（在测试数据上验证模式），可能导致不可重复的科学主张。\n**结论：正确。**\n\n**E. 在每个折的训练数据上重新拟合 PCA 会使得各折之间的主成分方向不具可比性，即使存在跨折一致的模式，也会使通路水平的解释在形式上无效。**\n\n该陈述是不正确的。虽然在 $K$ 个折中分别重新拟合 PCA 会产生 $K$ 组不同的载荷向量（即第 1 折的 PC1 与第 2 折的 PC1 并非严格相同），但这并不会使解释失效。交叉验证（流程 $\\mathcal{T}$）的主要目的是获得对整个建模策略*性能*的稳健估计。对模型生物学意义的解释通常是在建模策略被验证之后，对在*整个数据集*上训练的最终模型进行的。此外，观察到不同折之间存在一致的模式（例如，如果每个折中的 PC1 都一致地分离了条件，并且由一组相似的基因驱动），这实际上会*增强*对生物学解释的信心，因为它表明该发现对于训练数据的特定抽样是稳健的。声称这个程序使得解释“在形式上无效”是一种夸大其词，并且误解了最佳实践。\n**结论：不正确。**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}