{
    "hands_on_practices": [
        {
            "introduction": "分位数归一化是微阵列数据分析中消除技术偏差的关键步骤。该方法通过强制所有样本的表达强度具有相同的经验分布来校正非生物学差异。这个动手练习将引导您完成分位数归一化的核心机制：对每个样本进行排序，计算每个位次的跨样本均值，然后将这些均值映射回原始数据的位次，从而让您深刻理解这一广泛使用的算法是如何工作的。",
            "id": "3339411",
            "problem": "在计算系统生物学中，跨样本标准化的目的是消除技术性变异，同时保留生物学上有意义的排序结构。分位数标准化是微阵列数据中广泛使用的一种方法，在经过适当的方差稳定化变换后，也可谨慎地用于核糖核酸测序 (RNA-seq) 数据。其核心思想是通过对齐所有样本的顺序统计量，并将每个值替换为在相同排序上跨样本计算出的共同目标值，来使所有样本的经验分布相同。考虑一个包含 $3$ 个基因（行）和 $3$ 个样本（列）的基因表达矩阵。设观测到的强度矩阵为\n$$\nX \\;=\\;\n\\begin{pmatrix}\n5  7  3 \\\\\n2  7  9 \\\\\n8  1  3\n\\end{pmatrix}.\n$$\n将每一列视为一个样本。使用以下基于顺序统计量的操作性定义跨列进行分位数标准化：对每一列，将其条目按非递减顺序排序，以产生排序为 $1,2,3$ 的顺序统计量；对于每个排序 $r \\in \\{1,2,3\\}$，计算占据排序 $r$ 的值的跨列平均值；然后，对于每一列，将每个原始条目赋予其在该列中所占排序对应的平均值。如果某一列有相同值（相等的值）占据了多个连续的排序，则将这些相同值中的每一个都赋予这些排序对应目标值的平均值。完成分位数标准化得到矩阵 $Y$ 后，计算其行列式 $\\det(Y)$。将最终答案表示为一个精确的有理数，不进行四舍五入，不带单位。",
            "solution": "题目要求对一个给定的 $3 \\times 3$ 基因表达矩阵 $X$ 进行分位数标准化，得到标准化后的矩阵 $Y$，然后计算 $Y$ 的行列式。\n\n给定的表达矩阵是：\n$$\nX \\;=\\;\n\\begin{pmatrix}\n5  7  3 \\\\\n2  7  9 \\\\\n8  1  3\n\\end{pmatrix}\n$$\n其中每一列代表一个样本，每一行代表一个基因。\n\n分位数标准化的过程包括三个主要步骤。\n\n**第1步：排序和定序**\n首先，我们将每列（样本）中的值按非递减顺序排序，以确定每个条目在其列内的排序。\n\n对于第 $1$ 列：$[5, 2, 8]$。排序后的顺序是 $[2, 5, 8]$。\n值 $2$ 的排序为 $1$。\n值 $5$ 的排序为 $2$。\n值 $8$ 的排序为 $3$。\n\n对于第 $2$ 列：$[7, 7, 1]$。排序后的顺序是 $[1, 7, 7]$。\n值 $1$ 的排序为 $1$。\n两个值 $7$ 是相同值，占据了排序 $2$ 和 $3$。\n\n对于第 $3$ 列：$[3, 9, 3]$。排序后的顺序是 $[3, 3, 9]$。\n两个值 $3$ 是相同值，占据了排序 $1$ 和 $2$。\n值 $9$ 的排序为 $3$。\n\n我们可以将排好序的列组成一个新矩阵 $X_{\\text{sorted}}$，其中每一行对应一个特定的排序。\n$$\nX_{\\text{sorted}} \\;=\\;\n\\begin{pmatrix}\n2  1  3 \\\\\n5  7  3 \\\\\n8  7  9\n\\end{pmatrix}\n$$\n第一行包含所有排序为 $1$ 的值，第二行包含所有排序为 $2$ 的值（或在相同值情况下的较低排序），依此类推。\n\n**第2步：计算目标分布**\n目标分布是通过计算每个排序上所有样本值的平均值来得到的。这些平均值对应于矩阵 $X_{\\text{sorted}}$ 的行均值。设 $T_r$ 为排序 $r$ 的目标值。\n\n排序 $1$ 的目标值 ($T_1$)：\n$$\nT_1 \\;=\\; \\frac{2 + 1 + 3}{3} = \\frac{6}{3} = 2\n$$\n排序 $2$ 的目标值 ($T_2$)：\n$$\nT_2 \\;=\\; \\frac{5 + 7 + 3}{3} = \\frac{15}{3} = 5\n$$\n排序 $3$ 的目标值 ($T_3$)：\n$$\nT_3 \\;=\\; \\frac{8 + 7 + 9}{3} = \\frac{24}{3} = 8\n$$\n对应于排序 $\\{1, 2, 3\\}$ 的目标值集合为 $\\{2, 5, 8\\}$。\n\n**第3步：构建标准化矩阵 $Y$**\n现在，我们将原始矩阵 $X$ 中的每个条目替换为其在原始列中排序对应的目标值。我们必须应用处理相同值的指定规则。\n\n对于 $Y$ 的第 $1$ 列：原始条目为 $(5, 2, 8)$，其排序分别为 $(2, 1, 3)$。我们用对应的目标值 $(T_2, T_1, T_3)$ 替换它们。\n$$\nY_{\\cdot 1} \\;=\\; \\begin{pmatrix} T_2 \\\\ T_1 \\\\ T_3 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 5 \\\\ 2 \\\\ 8 \\end{pmatrix}\n$$\n\n对于 $Y$ 的第 $2$ 列：原始条目为 $(7, 7, 1)$。值 $1$ 的排序为 $1$，被替换为 $T_1 = 2$。两个值 $7$ 是相同值，共享排序 $2$ 和 $3$。根据题目的规则，这些相同条目中的每一个都被替换为这些排序对应目标值的平均值，即 $\\frac{T_2 + T_3}{2}$。\n$$\n\\text{Value for tied entries} \\;=\\; \\frac{5 + 8}{2} = \\frac{13}{2}\n$$\n因此，$Y$ 的第二列是：\n$$\nY_{\\cdot 2} \\;=\\; \\begin{pmatrix} \\frac{13}{2} \\\\ \\frac{13}{2} \\\\ 2 \\end{pmatrix}\n$$\n\n对于 $Y$ 的第 $3$ 列：原始条目为 $(3, 9, 3)$。值 $9$ 的排序为 $3$，被替换为 $T_3 = 8$。两个值 $3$ 是相同值，共享排序 $1$ 和 $2$。它们被替换为这些排序对应目标值的平均值，即 $\\frac{T_1 + T_2}{2}$。\n$$\n\\text{Value for tied entries} \\;=\\; \\frac{2 + 5}{2} = \\frac{7}{2}\n$$\n因此，$Y$ 的第三列是：\n$$\nY_{\\cdot 3} \\;=\\; \\begin{pmatrix} \\frac{7}{2} \\\\ 8 \\\\ \\frac{7}{2} \\end{pmatrix}\n$$\n\n组合各列得到完全标准化的矩阵 $Y$：\n$$\nY \\;=\\;\n\\begin{pmatrix}\n5  \\frac{13}{2}  \\frac{7}{2} \\\\\n2  \\frac{13}{2}  8 \\\\\n8  2  \\frac{7}{2}\n\\end{pmatrix}\n$$\n\n**第4步：计算 $Y$ 的行列式**\n一个 $3 \\times 3$ 矩阵 $\\begin{pmatrix} a  b  c \\\\ d  e  f \\\\ g  h  i \\end{pmatrix}$ 的行列式由公式 $a(ei - fh) - b(di - fg) + c(dh - eg)$ 给出。\n\n对于矩阵 $Y$：\n$$\n\\det(Y) \\;=\\; 5 \\left( (\\frac{13}{2})(\\frac{7}{2}) - (8)(2) \\right) - \\frac{13}{2} \\left( (2)(\\frac{7}{2}) - (8)(8) \\right) + \\frac{7}{2} \\left( (2)(2) - (\\frac{13}{2})(8) \\right)\n$$\n首先，计算第一行展开所需的各项：\n$$\n(\\frac{13}{2})(\\frac{7}{2}) - (8)(2) \\;=\\; \\frac{91}{4} - 16 \\;=\\; \\frac{91}{4} - \\frac{64}{4} \\;=\\; \\frac{27}{4}\n$$\n$$\n(2)(\\frac{7}{2}) - (8)(8) \\;=\\; 7 - 64 \\;=\\; -57\n$$\n$$\n(2)(2) - (\\frac{13}{2})(8) \\;=\\; 4 - 52 \\;=\\; -48\n$$\n现在将这些值代入行列式公式：\n$$\n\\det(Y) \\;=\\; 5 \\left( \\frac{27}{4} \\right) - \\frac{13}{2} \\left( -57 \\right) + \\frac{7}{2} \\left( -48 \\right)\n$$\n$$\n\\det(Y) \\;=\\; \\frac{135}{4} + \\frac{741}{2} - \\frac{336}{2}\n$$\n$$\n\\det(Y) \\;=\\; \\frac{135}{4} + \\frac{741 - 336}{2} \\;=\\; \\frac{135}{4} + \\frac{405}{2}\n$$\n为了将这些项相加，我们使用公分母 $4$：\n$$\n\\det(Y) \\;=\\; \\frac{135}{4} + \\frac{810}{4} \\;=\\; \\frac{135 + 810}{4} \\;=\\; \\frac{945}{4}\n$$\n经分位数标准化的矩阵 $Y$ 的行列式是 $\\frac{945}{4}$。",
            "answer": "$$\\boxed{\\frac{945}{4}}$$"
        },
        {
            "introduction": "与微阵列的连续信号不同，RNA测序（RNA-seq）产生的是离散的计数数据，这需要不同的归一化策略。DESeq等工具中使用的“比率中位数法”是一种稳健的解决方案，它通过计算一个尺寸因子来调整文库大小，且不易受少数高表达或差异表达基因的影响。本练习将通过一个具体的计算案例，逐步分解该方法的实现细节，包括如何处理零计数基因，从而帮助您掌握RNA-seq数据归一化的核心原理。",
            "id": "3339403",
            "problem": "考虑 5 个基因在 3 个样本中的核糖核酸测序 (RNA-seq) 片段计数，这些计数被整合在计数矩阵 $K \\in \\mathbb{N}^{5 \\times 3}$ 中，其形式如下\n$$\nK \\;=\\;\n\\begin{pmatrix}\n100  150  50 \\\\\n40  60  20 \\\\\n0  15  5 \\\\\n200  0  100 \\\\\n5  8  0 \n\\end{pmatrix}.\n$$\n您将使用测序差异表达分析 (DESeq) 所采用的比率中位数法来计算文库大小归一化。请使用以下基本定义和规则，这些在此背景下是标准的：\n- 对于每个基因 $i$，将其基因层面的几何平均数 $g_i$ 定义为仅对正数条目进行计算，如下所示\n$$\ng_i \\;=\\; \\exp\\!\\Bigg(\\frac{1}{n_i}\\sum_{j: K_{ij} > 0} \\ln K_{ij}\\Bigg),\n$$\n其中 $n_i \\in \\{1,2,3\\}$ 是基因 $i$ 在 3 个样本中严格为正的计数数量。\n- 对于每个样本 $j$ 以及每个满足 $K_{ij} > 0$ 的基因 $i$，定义比率\n$$\nr_{ij} \\;=\\; \\frac{K_{ij}}{g_i}.\n$$\n- 样本 $j$ 的大小因子 $s_j$ 是集合 $\\{ r_{ij} : K_{ij} > 0 \\}$ 在样本层面的中位数，使用中位数的常规定义。如果比率的数量是偶数，则中位数定义为两个中心顺序统计量的算术平均值。\n- 定义归一化计数为\n$$\n\\tilde{K}_{ij} \\;=\\; \\frac{K_{ij}}{s_j}.\n$$\n\n任务：\n- 计算所有基因层面的几何平均数 $g_i$，所有样本层面的大小因子 $s_j$，以及完整的归一化计数矩阵 $\\tilde{K}$。\n-作为您最终报告的结果，请提供基因 3 在样本 2 中的归一化计数，即 $\\tilde{K}_{3,2}$ 的值。\n\n将您最终报告的 $\\tilde{K}_{3,2}$ 值四舍五入到 4 位有效数字。最终报告的值应表示为一个纯数字（无单位）。",
            "solution": "任务是从给定的原始计数矩阵 $K$ 计算归一化计数 $\\tilde{K}_{3,2}$。这涉及问题陈述中定义的一系列计算。\n\n原始计数矩阵如下：\n$$\nK \\;=\\;\n\\begin{pmatrix}\n100  150  50 \\\\\n40  60  20 \\\\\n0  15  5 \\\\\n200  0  100 \\\\\n5  8  0 \n\\end{pmatrix}\n$$\n分析过程分为三个主要步骤：\n$1$. 计算每个基因的基因层面几何平均数 $g_i$。\n$2$. 计算每个样本的样本层面大小因子 $s_j$。\n$3$. 计算归一化计数 $\\tilde{K}_{ij}$。\n\n步骤 1：计算基因层面的几何平均数 ($g_i$)\n每个基因 $i$ 的几何平均数是针对具有正计数 $K_{ij} > 0$ 的样本 $j$ 计算的。公式为 $g_i = \\exp\\left(\\frac{1}{n_i}\\sum_{j: K_{ij} > 0} \\ln K_{ij}\\right)$，其中 $n_i$ 是基因 $i$ 的正计数数量。\n\n- 对于基因 $i=1$：计数为 $(100, 150, 50)$，所以 $n_1=3$。\n$$g_1 = (100 \\times 150 \\times 50)^{1/3} = (750000)^{1/3} \\approx 90.85603$$\n- 对于基因 $i=2$：计数为 $(40, 60, 20)$，所以 $n_2=3$。\n$$g_2 = (40 \\times 60 \\times 20)^{1/3} = (48000)^{1/3} \\approx 36.34241$$\n- 对于基因 $i=3$：计数为 $(0, 15, 5)$，所以 $n_3=2$。\n$$g_3 = (15 \\times 5)^{1/2} = \\sqrt{75} \\approx 8.66025$$\n- 对于基因 $i=4$：计数为 $(200, 0, 100)$，所以 $n_4=2$。\n$$g_4 = (200 \\times 100)^{1/2} = \\sqrt{20000} = 100\\sqrt{2} \\approx 141.42136$$\n- 对于基因 $i=5$：计数为 $(5, 8, 0)$，所以 $n_5=2$。\n$$g_5 = (5 \\times 8)^{1/2} = \\sqrt{40} \\approx 6.32456$$\n\n步骤 2：计算样本层面的大小因子 ($s_j$)\n对于每个样本 $j$，我们为满足 $K_{ij} > 0$ 的基因计算比率 $r_{ij} = K_{ij}/g_i$。大小因子 $s_j$ 是这些比率的中位数。问题要求计算所有的大小因子，但为了求得 $\\tilde{K}_{3,2}$，我们严格来说只需要 $s_2$。我们将详细计算 $s_2$。\n\n为了计算 $s_2$，我们考虑样本 $j=2$。计数为 $(150, 60, 15, 0, 8)$。具有正计数的基因为 $i \\in \\{1, 2, 3, 5\\}$。我们计算比率 $r_{i2}$：\n- $r_{12} = \\frac{K_{12}}{g_1} = \\frac{150}{90.85603} \\approx 1.65096$\n- $r_{22} = \\frac{K_{22}}{g_2} = \\frac{60}{36.34241} \\approx 1.65096$\n- $r_{32} = \\frac{K_{32}}{g_3} = \\frac{15}{\\sqrt{75}} = \\frac{15}{5\\sqrt{3}} = \\sqrt{3} \\approx 1.73205$\n- $r_{52} = \\frac{K_{52}}{g_5} = \\frac{8}{\\sqrt{40}} = \\frac{8}{2\\sqrt{10}} = \\frac{4}{\\sqrt{10}} = \\sqrt{1.6} \\approx 1.26491$\n\n样本 2 的比率集合为 $\\{1.65096, 1.65096, 1.73205, 1.26491\\}$。\n为了找到中位数，我们将集合排序：$\\{1.26491, 1.65096, 1.65096, 1.73205\\}$。\n由于值的数量为偶数（$4$），中位数是两个中心值的算术平均值。\n$$s_2 = \\text{median}\\{r_{i2}\\} = \\frac{1.65096 + 1.65096}{2} = 1.65096$$\n\n为了完整性，我们计算 $s_1$ 和 $s_3$。\n对于样本 $j=1$：正计数对应的基因为 $i \\in \\{1, 2, 4, 5\\}$。比率如下：\n$r_{11} \\approx 1.10064$, $r_{21} \\approx 1.10064$, $r_{41} = \\frac{200}{100\\sqrt{2}} = \\sqrt{2} \\approx 1.41421$, $r_{51} = \\frac{5}{\\sqrt{40}} \\approx 0.79057$。\n排序后的比率：$\\{0.79057, 1.10064, 1.10064, 1.41421\\}$。\n$$s_1 = \\frac{1.10064 + 1.10064}{2} = 1.10064$$\n\n对于样本 $j=3$：正计数对应的基因为 $i \\in \\{1, 2, 3, 4\\}$。比率如下：\n$r_{13} \\approx 0.55032$, $r_{23} \\approx 0.55032$, $r_{33} = \\frac{5}{\\sqrt{75}} = \\frac{1}{\\sqrt{3}} \\approx 0.57735$, $r_{43} = \\frac{100}{100\\sqrt{2}} = \\frac{1}{\\sqrt{2}} \\approx 0.70711$。\n排序后的比率：$\\{0.55032, 0.55032, 0.57735, 0.70711\\}$。\n$$s_3 = \\frac{0.55032 + 0.57735}{2} = 0.563835$$\n\n步骤 3：计算归一化计数 $\\tilde{K}_{3,2}$\n归一化计数定义为 $\\tilde{K}_{ij} = \\frac{K_{ij}}{s_j}$。我们需要求解 $\\tilde{K}_{3,2}$。\n我们使用原始计数 $K_{3,2} = 15$ 和计算出的大小因子 $s_2 \\approx 1.65096$。\n$$\\tilde{K}_{3,2} = \\frac{K_{3,2}}{s_2} = \\frac{15}{1.65096} \\approx 9.085603$$\n问题要求将此值四舍五入到 4 位有效数字。前四位有效数字是 $9, 0, 8, 5$。第五位数字是 $6$，因此我们将第四位数字（$5$）向上取整为 $6$。\n$$\\tilde{K}_{3,2} \\approx 9.086$$\n完整的归一化矩阵 $\\tilde{K}$ 是通过将 $K$ 的每一列 $j$ 除以其对应的大小因子 $s_j$ 来计算的。\n$$\n\\tilde{K} \\approx\n\\begin{pmatrix}\n100/1.10064  150/1.65096  50/0.563835 \\\\\n40/1.10064  60/1.65096  20/0.563835 \\\\\n0/1.10064  15/1.65096  5/0.563835 \\\\\n200/1.10064  0/1.65096  100/0.563835 \\\\\n5/1.10064  8/1.65096  0/0.563835\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n90.856  90.856  88.678 \\\\\n36.342  36.342  35.471 \\\\\n0  9.086  8.868 \\\\\n181.712  0  177.356 \\\\\n4.543  4.846  0\n\\end{pmatrix}\n$$\n所要求的值是位于第 3 行，第 2 列的条目。",
            "answer": "$$\n\\boxed{9.086}\n$$"
        },
        {
            "introduction": "选择正确的归一化策略至关重要，因为一个看似合理但存在缺陷的方法可能会导出错误的生物学结论。本练习构建了一个思想实验，旨在揭示在存在大规模、不对称的转录变化时，简单的总计数归一化会遇到的一个根本性陷阱。通过将其结果与基于“外参”（spike-in）的校正进行对比，此练习清晰地阐释了测序数据的“组分性”本质，并强调了使用稳健归一化方法的必要性。",
            "id": "3339479",
            "problem": "考虑一个比较条件 $A$ 和条件 $B$ 的双条件核糖核酸测序（RNA-seq）实验。假设抽样遵循多项式模型：在样本 $j$ 中分配给转錄本 $i$ 的预期读数计数与其在该样本中的基础分子丰度成正比。每个样本精确产生 $R = 3828$ 个比对上的读数（内源性加spike-in）。内源性转录本包括一个管家基因 $H$ 和五个其他基因 $G_{1}, G_{2}, G_{3}, G_{4}, G_{5}$。在文库制备之前，将两种外部RNA控制联盟（ERCC）的spike-in转录本 $S_{1}$ 和 $S_{2}$ 以相等的绝对量添加到每个样本中。每个细胞的真实基础分子丰度如下：\n- 在条件 $A$ 中：$m_{H} = 100$，$k \\in \\{1,2,3,4,5\\}$ 时 $m_{G_{k}} = 100$，以及 $m_{S_{1}} = m_{S_{2}} = 30$。\n- 在条件 $B$ 中：存在一个全局激活，使所有非管家内源性基因的表达量加倍，而 $H$ 保持不变：$m_{H} = 100$，$k \\in \\{1,2,3,4,5\\}$ 时 $m_{G_{k}} = 200$，以及 $m_{S_{1}} = m_{S_{2}} = 30$。\n\n在多项式抽样假设和各样本间 $R$ 相等的条件下，观测到的读数计数与这些丰度一致，且等于：\n- 样本 $A$：$c_{H,A} = 580$，对于每个 $k$，$c_{G_{k},A} = 580$，$c_{S_{1},A} = c_{S_{2},A} = 174$，总计 $T_{A} = 3828$。\n- 样本 $B$：$c_{H,B} = 330$，对于每个 $k$，$c_{G_{k},B} = 660$，$c_{S_{1},B} = c_{S_{2},B} = 99$，总计 $T_{B} = 3828$。\n\n您将研究在全局转录变化存在的情况下，总计数归一化的效应，然后实施一种基于spike-in的校正方法。将基因 $i$ 在 $B$ 和 $A$ 之间的总计数归一化倍数变化定义为其计数比例的比值，并将样本 $B$ 的spike-in归一化因子定义为 $A$ 中总spike-in计数与 $B$ 中总spike-in计数的比值。\n\n任务：\n1. 使用总计数归一化，计算管家基因 $H$ 在 $B$ 和 $A$ 之间估计的倍数变化的以2为底的对数。\n2. 使用spike-in归一化和上面定义的因子，计算 $H$ 在 $B$ 和 $A$ 之间校正后的倍数变化的以2为底的对数。\n3. 报告总计数归一化对 $H$ 引入的偏差，该偏差定义为总计数和spike-in对数倍数变化估计值之间的差异。请用一个单一的封闭形式解析表达式表示您的最终答案；不要四舍五入。",
            "solution": "核心任务是，在全局、非对称性转录放大的背景下，量化总计数归一化对一个非差异表达基因引入的偏差，并将其与基于spike-in的归一化进行对比。\n\n设 $c_{i,j}$ 为样本 $j$ 中转录本 $i$ 的读数计数，其中 $j \\in \\{A, B\\}$。每个样本中的总读数是恒定的，记为 $R$。给定数据表明 $T_A = T_B = R = 3828$。\n\n**任务1：总计数归一化倍数变化**\n\n问题将基因 $i$ 在条件 $B$ 和 $A$ 之间的总计数归一化倍数变化定义为其计数比例的比值。\n样本 $j$ 中基因 $i$ 的计数比例为 $p_{i,j} = \\frac{c_{i,j}}{T_j}$，其中 $T_j$ 是样本 $j$ 的总读数计数。\n因此倍数变化为 $FC_{\\text{TC}, i} = \\frac{p_{i,B}}{p_{i,A}} = \\frac{c_{i,B}/T_B}{c_{i,A}/T_A}$。\n\n由于问题说明总读数计数相等，$T_A = T_B = 3828$，因此倍数变化的表达式简化为原始计数的比值：\n$$FC_{\\text{TC}, i} = \\frac{c_{i,B}}{c_{i,A}}$$\n\n对于管家基因 $H$，我们给定的计数是：\n$c_{H,A} = 580$\n$c_{H,B} = 330$\n\n使用总计数归一化对 $H$ 估计的倍数变化是：\n$$FC_{\\text{TC}, H} = \\frac{c_{H,B}}{c_{H,A}} = \\frac{330}{580} = \\frac{33}{58}$$\n\n第一个任务是计算该值的以2为底的对数：\n$$\\log_{2}(FC_{\\text{TC}, H}) = \\log_{2}\\left(\\frac{33}{58}\\right)$$\n这个结果显示管家基因表观下调，而我们知道它在生物学上是未改变的。这种假象的产生是因为，尽管 $H$ 分子的绝对丰度保持不变，但在样本 $B$ 中，由于来自基因 $G_k$ 的读数大量增加，导致来自基因 $H$ 的读数比例下降了。\n\n**任务2：Spike-In校正后的倍数变化**\n\nSpike-in归一化使用来自外部添加的RNA标准品（spike-ins）的计数来推导归一化因子。其前提是这些spike-in以相等的绝对量添加到每个样本中，因此它们测序计数中的任何观测差异都必须归因于技术或组成上的变异，例如此处看到的总RNA含量的变化。\n\n样本 $B$ 的spike-in归一化因子 $f_S$ 定义为样本 $A$ 中总spike-in计数与样本 $B$ 中总spike-in计数的比值。\n样本 $A$ 中的总spike-in计数：$C_{S,A} = c_{S_1,A} + c_{S_2,A} = 174 + 174 = 348$。\n样本 $B$ 中的总spike-in计数：$C_{S,B} = c_{S_1,B} + c_{S_2,B} = 99 + 99 = 198$。\n\n归一化因子为：\n$$f_S = \\frac{C_{S,A}}{C_{S,B}} = \\frac{348}{198} = \\frac{174}{99} = \\frac{58 \\times 3}{33 \\times 3} = \\frac{58}{33}$$\n\n此因子用于校正样本 $B$ 中的计数。样本 $B$ 中基因 $H$ 的校正后计数，记为 $c'_{H,B}$，是：\n$$c'_{H,B} = c_{H,B} \\times f_S = 330 \\times \\frac{58}{33} = 10 \\times 58 = 580$$\n\nSpike-in校正后的倍数变化 $FC_{S, H}$ 是 $B$ 中校正后计数与 $A$ 中计数的比值：\n$$FC_{S, H} = \\frac{c'_{H,B}}{c_{H,A}} = \\frac{580}{580} = 1$$\n\n校正后倍数变化的以2为底的对数是：\n$$\\log_{2}(FC_{S, H}) = \\log_{2}(1) = 0$$\n这个结果正确地反映了基础生物学事实，即管家基因 $H$ 在条件 $A$ 和 $B$ 之間没有发生变化。\n\n**任务3：总计数归一化引入的偏差**\n\n偏差定义为总计数对数倍数变化估计值与spike-in校正后对数倍数变化估计值之间的差异。\n$$\\text{Bias} = \\log_{2}(FC_{\\text{TC}, H}) - \\log_{2}(FC_{S, H})$$\n\n代入前面任务中计算出的值：\n$$\\text{Bias} = \\log_{2}\\left(\\frac{33}{58}\\right) - 0 = \\log_{2}\\left(\\frac{33}{58}\\right)$$\n\n这个偏差可以用归一化因子 $f_S$ 来表示。偏差是：\n$$\\text{Bias} = \\log_{2}\\left(\\frac{FC_{\\text{TC}, H}}{FC_{S, H}}\\right) = \\log_{2}\\left(\\frac{c_{H,B}/c_{H,A}}{(c_{H,B} \\times f_S)/c_{H,A}}\\right) = \\log_{2}\\left(\\frac{1}{f_S}\\right) = -\\log_{2}(f_S)$$\n代入 $f_S$ 的值：\n$$\\text{Bias} = -\\log_{2}\\left(\\frac{58}{33}\\right) = \\log_{2}\\left(\\left(\\frac{58}{33}\\right)^{-1}\\right) = \\log_{2}\\left(\\frac{33}{58}\\right)$$\n这证实了结果。该偏差是文库组成变化的直接后果，spike-in归一化因子捕捉到了这种变化，而总计数方法忽略了它。最终答案是该偏差的封闭形式解析表达式。",
            "answer": "$$\n\\boxed{\\log_{2}\\left(\\frac{33}{58}\\right)}\n$$"
        }
    ]
}