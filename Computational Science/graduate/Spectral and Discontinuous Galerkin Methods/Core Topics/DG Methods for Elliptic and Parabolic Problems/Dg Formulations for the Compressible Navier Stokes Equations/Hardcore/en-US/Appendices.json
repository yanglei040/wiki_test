{
    "hands_on_practices": [
        {
            "introduction": "This first practice focuses on a cornerstone of stable numerical schemes: the discretization of nonlinear convective terms. Using the simple Burgers' equation as a model, this exercise  demonstrates how a carefully constructed \"skew-symmetric\" form can discretely conserve energy, a property that is crucial for long-time stability and reducing non-physical aliasing errors that arise from under-integration. By comparing different forms, you will gain a hands-on appreciation for why the choice of discretization matters profoundly.",
            "id": "3376460",
            "problem": "Consider a one-dimensional prototype of the quadratic convective nonlinearity that appears in the compressible Euler and Navier-Stokes equations, modeled by the inviscid Burgers-type strong form on the reference element $[-1,1]$:\n$$\n\\frac{\\partial u}{\\partial t} + \\mathcal{C}(u) = 0, \\qquad \\mathcal{C}(u) := \\frac{\\partial}{\\partial x}\\!\\left(\\frac{u^2}{2}\\right),\n$$\nwith periodic boundary conditions. In a nodal Discontinuous Galerkin (DG) collocation discretization based on Gauss–Lobatto–Legendre (GLL) nodes, the semi-discrete differentiation operator $D$ and diagonal mass/weight matrix $W$ satisfy the Summation-By-Parts (SBP) property $W D + D^{\\top} W = B$, where $B$ is a rank-$2$ matrix containing only boundary contributions. On a periodic mesh, these boundary contributions cancel between neighboring elements, and are thus taken to vanish at the semi-discrete level.\n\n- Use the following GLL data for polynomial degree $N=2$ on $[-1,1]$:\n  - Nodes $x_0=-1$, $x_1=0$, $x_2=1$.\n  - Quadrature weights $W=\\mathrm{diag}\\!\\big(\\tfrac{1}{3},\\tfrac{4}{3},\\tfrac{1}{3}\\big)$.\n  - Differentiation matrix\n    $$\n    D \\;=\\;\n    \\begin{pmatrix}\n    -\\tfrac{3}{2} & 2 & -\\tfrac{1}{2} \\\\\n    -\\tfrac{1}{2} & 0 & \\tfrac{1}{2} \\\\\n    \\tfrac{1}{2} & -2 & \\tfrac{3}{2}\n    \\end{pmatrix}.\n    $$\n  You may assume the SBP identity $W D + D^{\\top} W = \\mathrm{diag}(-1,0,1)$ holds.\n\n- Let $u(x)=1+x^2$, and let $u_i := u(x_i)$ denote its nodal values. Define the exact strong-form convective derivative at nodes by\n  $$\n  s_{\\mathrm{exact},i} := u(x_i)\\,\\frac{d u}{d x}(x_i).\n  $$\n\n- In collocation, two common under-integrated strong-form discretizations of $\\mathcal{C}(u)$ at the nodes are:\n  - Conservative (flux) form: $s_{\\mathrm{cons}} := D\\big(\\tfrac{1}{2} u^{\\circ 2}\\big)$, where $u^{\\circ 2}$ denotes componentwise square.\n  - Advective form: $s_{\\mathrm{adv}} := U\\,D u$, where $U=\\mathrm{diag}(u_0,u_1,u_2)$.\n\nA skew-symmetric split form of the strong-form convective derivative for quadratic nonlinearities is sought in the family\n$$\ns_{\\alpha,\\beta}(u) \\;=\\; \\alpha\\, U\\,D u \\;+\\; \\beta\\, D\\!\\left(\\tfrac{1}{2}u^{\\circ 2}\\right),\n$$\nwith constants $\\alpha$ and $\\beta$ that do not depend on $u$ or $x$. You will determine $\\alpha$ and $\\beta$ by enforcing discrete energy conservation in the periodic case with the SBP property.\n\nTasks:\n1) Starting from the SBP identity and the semi-discrete energy $E = \\tfrac{1}{2} u^{\\top} W u$, derive the necessary and sufficient condition on $\\alpha$ and $\\beta$ for the skew-symmetric split form $s_{\\alpha,\\beta}(u)$ to satisfy $dE/dt = 0$ on a periodic mesh for all $u$. Express your final $s_{\\mathrm{skew}}(u)$ explicitly.\n\n2) Using the provided nodes $x_i$ and operators $D$ and $W$, compute the nodal vectors $s_{\\mathrm{exact}}$, $s_{\\mathrm{cons}}$, and $s_{\\mathrm{skew}}$ for $u(x)=1+x^2$.\n\n3) Define the weighted aliasing-error norms\n$$\n\\|e_{\\mathrm{cons}}\\|_{W}^{2} := \\sum_{i=0}^{2} w_i \\left(s_{\\mathrm{cons},i} - s_{\\mathrm{exact},i}\\right)^{2},\n\\qquad\n\\|e_{\\mathrm{skew}}\\|_{W}^{2} := \\sum_{i=0}^{2} w_i \\left(s_{\\mathrm{skew},i} - s_{\\mathrm{exact},i}\\right)^{2},\n$$\nwith $w_0=\\tfrac{1}{3}$, $w_1=\\tfrac{4}{3}$, $w_2=\\tfrac{1}{3}$. Compute the ratio\n$$\nr \\;=\\; \\frac{\\|e_{\\mathrm{cons}}\\|_{W}^{2}}{\\|e_{\\mathrm{skew}}\\|_{W}^{2}}.\n$$\n\nProvide the final value of $r$ as an exact number. Do not include units. Do not use a percentage. If you approximate, round to four significant figures.",
            "solution": "The problem is evaluated to be scientifically sound, self-contained, and well-posed. All data and definitions required for a unique solution are provided, and there are no internal contradictions or violations of mathematical principles. We may proceed with the solution.\n\nThe problem is divided into three tasks. We will address them in sequence.\n\n### Task 1: Derivation of the Skew-Symmetric Form\nWe are given the semi-discrete equation for the nodal values vector $\\mathbf{u}$ as $\\frac{d\\mathbf{u}}{dt} + s_{\\alpha,\\beta}(\\mathbf{u}) = 0$. The discrete kinetic energy on the element is $E = \\frac{1}{2} \\mathbf{u}^{\\top} W \\mathbf{u}$. The time rate of change of energy is given by:\n$$\n\\frac{dE}{dt} = \\frac{1}{2} \\left( \\frac{d\\mathbf{u}^{\\top}}{dt} W \\mathbf{u} + \\mathbf{u}^{\\top} W \\frac{d\\mathbf{u}}{dt} \\right) = \\mathbf{u}^{\\top} W \\frac{d\\mathbf{u}}{dt}\n$$\nwhere we have used the symmetry of the mass matrix $W$. Substituting the semi-discrete equation, we get:\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top} W s_{\\alpha,\\beta}(\\mathbf{u})\n$$\nThe split form $s_{\\alpha,\\beta}(\\mathbf{u})$ is given by:\n$$\ns_{\\alpha,\\beta}(\\mathbf{u}) = \\alpha U D \\mathbf{u} + \\beta D\\left(\\frac{1}{2}\\mathbf{u}^{\\circ 2}\\right)\n$$\nwhere $U = \\mathrm{diag}(\\mathbf{u})$ and $\\mathbf{u}^{\\circ 2}$ is the element-wise square of $\\mathbf{u}$. The energy change rate becomes:\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top} W \\left[ \\alpha U D \\mathbf{u} + \\frac{\\beta}{2} D(\\mathbf{u}^{\\circ 2}) \\right] = -\\alpha (\\mathbf{u}^{\\top} W U D \\mathbf{u}) - \\frac{\\beta}{2} (\\mathbf{u}^{\\top} W D(\\mathbf{u}^{\\circ 2}))\n$$\nLet's analyze the term $\\mathbf{u}^{\\top} W U$. Since $W$ and $U$ are diagonal, with entries $w_i$ and $u_i$ respectively, the $j$-th element of the row vector $\\mathbf{u}^{\\top} W U$ is $\\sum_i u_i (WU)_{ij} = \\sum_i u_i W_{ij} U_{jj} = u_j W_{jj} U_{jj} = u_j w_j u_j = w_j u_j^2$. This is the same as the $j$-th component of the row vector $(\\mathbf{u}^{\\circ 2})^{\\top} W$. Thus, we have the identity $\\mathbf{u}^{\\top} W U = (\\mathbf{u}^{\\circ 2})^{\\top} W$.\nLet's define two quadratic forms:\n$$\nT_1 = (\\mathbf{u}^{\\circ 2})^{\\top} W D \\mathbf{u} \\qquad \\text{and} \\qquad T_2 = \\mathbf{u}^{\\top} W D(\\mathbf{u}^{\\circ 2})\n$$\nWith this, the energy change rate is $\\frac{dE}{dt} = -(\\alpha T_1 + \\frac{\\beta}{2} T_2)$.\n\nThe Summation-By-Parts (SBP) property $W D + D^{\\top} W = B$ provides a discrete integration-by-parts formula. For any vectors $\\mathbf{v}$ and $\\mathbf{z}$:\n$$\n\\mathbf{v}^{\\top} W D \\mathbf{z} + (D\\mathbf{v})^{\\top} W \\mathbf{z} = \\mathbf{v}^{\\top} B \\mathbf{z}\n$$\nLet $\\mathbf{v} = \\mathbf{u}^{\\circ 2}$ and $\\mathbf{z} = \\mathbf{u}$. The SBP formula gives:\n$$\n(\\mathbf{u}^{\\circ 2})^{\\top} W D \\mathbf{u} + (D(\\mathbf{u}^{\\circ 2}))^{\\top} W \\mathbf{u} = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}\n$$\nThe second term on the left is $(D(\\mathbf{u}^{\\circ 2}))^{\\top} W \\mathbf{u} = \\mathbf{u}^{\\top} W (D(\\mathbf{u}^{\\circ 2})) = T_2$. The first term is $T_1$. So, we have the relation:\n$$\nT_1 + T_2 = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}\n$$\nThe term on the right is a boundary term. For a globally periodic mesh, the sum of these boundary terms over all elements vanishes.\n\nWe now express the energy change rate in terms of $T_1$ and the boundary term. From the SBP relation, we have $T_2 = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} - T_1$. Substituting this into the expression for $\\frac{dE}{dt}$:\n$$\n\\frac{dE}{dt} = -\\left[ \\alpha T_1 + \\frac{\\beta}{2} \\left( (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} - T_1 \\right) \\right] = -\\left[ \\left(\\alpha - \\frac{\\beta}{2}\\right)T_1 + \\frac{\\beta}{2}(\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} \\right]\n$$\nThe total energy change over a periodic domain is the sum of these elemental contributions. The sum of the boundary term $\\frac{\\beta}{2}(\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}$ over all elements is zero. However, the term $T_1$ is generally non-zero and its sum over the elements does not vanish. Therefore, for the total energy to be conserved for any $\\mathbf{u}$, the coefficient of $T_1$ must be zero:\n$$\n\\alpha - \\frac{\\beta}{2} = 0 \\implies 2\\alpha = \\beta\n$$\nFor the split-form discretization to be consistent with the original convective term $\\mathcal{C}(u)$, the sum of the coefficients must be unity, since both $U D \\mathbf{u}$ and $D(\\frac{1}{2}\\mathbf{u}^{\\circ 2})$ are consistent discretizations of $\\mathcal{C}(u)$:\n$$\n\\alpha + \\beta = 1\n$$\nSolving this system of two linear equations:\n$$\n\\alpha + 2\\alpha = 1 \\implies 3\\alpha = 1 \\implies \\alpha = \\frac{1}{3}\n$$\n$$\n\\beta = 2\\alpha = \\frac{2}{3}\n$$\nThe resulting energy-conserving or skew-symmetric split form is:\n$$\ns_{\\mathrm{skew}}(\\mathbf{u}) = \\frac{1}{3} U D \\mathbf{u} + \\frac{2}{3} D\\left(\\frac{1}{2}\\mathbf{u}^{\\circ 2}\\right) = \\frac{1}{3} U D \\mathbf{u} + \\frac{1}{3} D(\\mathbf{u}^{\\circ 2})\n$$\n\n### Task 2: Computation of Nodal Vectors\nWe are given $u(x) = 1+x^2$ and the GLL nodes $x_0=-1, x_1=0, x_2=1$.\nThe nodal values of $u(x)$ are:\n$u_0 = u(-1) = 1+(-1)^2 = 2$\n$u_1 = u(0) = 1+0^2 = 1$\n$u_2 = u(1) = 1+1^2 = 2$\nThe nodal vector is $\\mathbf{u} = \\begin{pmatrix} 2 & 1 & 2 \\end{pmatrix}^{\\top}$.\n\nThe exact strong-form convective derivative is $s_{\\mathrm{exact},i} = u(x_i) \\frac{du}{dx}(x_i)$. With $\\frac{du}{dx} = 2x$:\n$s_{\\mathrm{exact},0} = u(-1) \\cdot (2(-1)) = 2 \\cdot (-2) = -4$\n$s_{\\mathrm{exact},1} = u(0) \\cdot (2(0)) = 1 \\cdot 0 = 0$\n$s_{\\mathrm{exact},2} = u(1) \\cdot (2(1)) = 2 \\cdot 2 = 4$\nSo, $\\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -4 & 0 & 4 \\end{pmatrix}^{\\top}$.\n\nThe conservative form is $s_{\\mathrm{cons}} = D(\\frac{1}{2} \\mathbf{u}^{\\circ 2})$. The vector of squared nodal values is $\\mathbf{u}^{\\circ 2} = \\begin{pmatrix} 2^2 & 1^2 & 2^2 \\end{pmatrix}^{\\top} = \\begin{pmatrix} 4 & 1 & 4 \\end{pmatrix}^{\\top}$.\n$$\n\\mathbf{s}_{\\mathrm{cons}} = \\frac{1}{2} D \\mathbf{u}^{\\circ 2} = \\frac{1}{2} \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 1 \\\\ 4 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} -6+2-2 \\\\ -2+0+2 \\\\ 2-2+6 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} -6 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix}\n$$\n\nThe skew-symmetric form is $s_{\\mathrm{skew}}(\\mathbf{u}) = \\frac{1}{3} U D \\mathbf{u} + \\frac{1}{3} D(\\mathbf{u}^{\\circ 2})$.\nFirst, we compute $D\\mathbf{u}$:\n$$\nD\\mathbf{u} = \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -3+2-1 \\\\ -1+0+1 \\\\ 1-2+3 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\\\ 2 \\end{pmatrix}\n$$\nThe matrix $U$ is $\\mathrm{diag}(2,1,2)$. So, $UD\\mathbf{u} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix}$.\nWe already computed $D(\\mathbf{u}^{\\circ 2}) = \\begin{pmatrix} -6 & 0 & 6 \\end{pmatrix}^{\\top}$.\n$$\n\\mathbf{s}_{\\mathrm{skew}} = \\frac{1}{3} \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} + \\frac{1}{3} \\begin{pmatrix} -6 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -10 \\\\ 0 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ \\frac{10}{3} \\end{pmatrix}\n$$\n\n### Task 3: Computation of the Error Ratio\nFirst, we compute the error vectors.\n$$\n\\mathbf{e}_{\\mathrm{cons}} = \\mathbf{s}_{\\mathrm{cons}} - \\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{e}_{\\mathrm{skew}} = \\mathbf{s}_{\\mathrm{skew}} - \\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ \\frac{10}{3} \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} -\\frac{10}{3} + \\frac{12}{3} \\\\ 0 \\\\ \\frac{10}{3} - \\frac{12}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ 0 \\\\ -\\frac{2}{3} \\end{pmatrix}\n$$\nNext, we compute the weighted squared norms. The weights are $w_0=\\frac{1}{3}, w_1=\\frac{4}{3}, w_2=\\frac{1}{3}$.\n$$\n\\|\\mathbf{e}_{\\mathrm{cons}}\\|_{W}^{2} = \\sum_{i=0}^{2} w_i e_{\\mathrm{cons},i}^2 = \\frac{1}{3}(1)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}(-1)^2 = \\frac{1}{3} + 0 + \\frac{1}{3} = \\frac{2}{3}\n$$\n$$\n\\|\\mathbf{e}_{\\mathrm{skew}}\\|_{W}^{2} = \\sum_{i=0}^{2} w_i e_{\\mathrm{skew},i}^2 = \\frac{1}{3}\\left(\\frac{2}{3}\\right)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}\\left(-\\frac{2}{3}\\right)^2 = \\frac{1}{3}\\left(\\frac{4}{9}\\right) + 0 + \\frac{1}{3}\\left(\\frac{4}{9}\\right) = \\frac{4}{27} + \\frac{4}{27} = \\frac{8}{27}\n$$\nFinally, we compute the ratio $r$:\n$$\nr = \\frac{\\|\\mathbf{e}_{\\mathrm{cons}}\\|_{W}^{2}}{\\|\\mathbf{e}_{\\mathrm{skew}}\\|_{W}^{2}} = \\frac{\\frac{2}{3}}{\\frac{8}{27}} = \\frac{2}{3} \\times \\frac{27}{8} = \\frac{2 \\times 27}{3 \\times 8} = \\frac{54}{24} = \\frac{9 \\times 6}{4 \\times 6} = \\frac{9}{4}\n$$\nAs a decimal, this is $2.25$. The problem requests an exact number.",
            "answer": "$$\\boxed{\\frac{9}{4}}$$"
        },
        {
            "introduction": "Building on the treatment of convective terms, this problem tackles two critical components of a robust DG solver for the Euler equations. First, you will derive the celebrated Roe linearization , which provides a consistent and accurate way to define a numerical flux at element interfaces. Second, you will confront a practical challenge in high-speed flows: the potential for solutions to develop non-physical negative density or pressure. This exercise guides you through the principles of a positivity-preserving limiter, a technique that enforces physical realizability while maintaining conservation.",
            "id": "3376511",
            "problem": "Consider the one-dimensional compressible Euler equations in conservation form with state vector $\\,\\boldsymbol{q} = (\\rho,\\,\\rho u,\\,E)^{\\top}\\,$, flux $\\,\\boldsymbol{f}(\\boldsymbol{q}) = \\big(\\rho u,\\,\\rho u^{2} + p,\\,u(E + p)\\big)^{\\top}\\,$, and an ideal-gas equation of state $\\,p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)\\,$ with constant ratio of specific heats $\\,\\gamma > 1\\,$.\n\nPart A (derivation): Starting from the conservation form and the ideal-gas thermodynamics above, derive the Roe linearization for the compressible Euler flux across an interface with unit normal in the flow direction, that is, determine a constant Jacobian $\\,\\tilde{\\boldsymbol{A}}\\,(\\boldsymbol{q}_{\\mathrm{L}},\\boldsymbol{q}_{\\mathrm{R}})\\,$ such that $\\,\\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}\\,(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}})\\,$. Your derivation must identify the Roe-averaged quantities $\\,\\tilde{u}\\,$ and $\\,\\tilde{H}\\,$, the Roe sound speed $\\,\\tilde{a}\\,$, and the eigenvalues of $\\,\\tilde{\\boldsymbol{A}}\\,$ in terms of the left and right states. Do not quote the result; derive it from the defining property of the Roe linearization and the ideal-gas relations.\n\nPart B (positivity modifications in Discontinuous Galerkin): In a Discontinuous Galerkin (DG) formulation for high-Mach flows, density and pressure must remain positive at quadrature points to avoid loss of hyperbolicity and nonphysical states. Explain, from first principles of conservation and convexity, how a positivity-preserving limiter can be constructed by rescaling polynomial deviations from the cell average. In particular, consider a nodal DG representation on a cell with two quadrature nodes with equal weights $\\,\\tfrac{1}{2}\\,$ and conservative nodal states $\\,\\boldsymbol{U}_{1}=(\\rho_{1},m_{1},E_{1})^{\\top}\\,$ and $\\,\\boldsymbol{U}_{2}=(\\rho_{2},m_{2},E_{2})^{\\top}\\,$, where $\\,m=\\rho u\\,$. The cell average is $\\,\\bar{\\boldsymbol{U}}=\\tfrac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})\\,$. The positivity-preserving rescaling produces the limited nodal state $\\,\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta\\big(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}}\\big)\\,$ with $\\,\\theta \\in [0,1]\\,$ chosen minimally so that both $\\,\\rho(\\theta) > 0\\,$ and $\\,p(\\theta) \\ge 0\\,$ at node $\\,1\\,$, where $\\,\\rho(\\theta)\\,$, $\\,m(\\theta)\\,$, and $\\,E(\\theta)\\,$ are the components of $\\,\\boldsymbol{U}_{1}^{\\mathrm{lim}}\\,$ and $\\,p(\\theta)=(\\gamma-1)\\!\\left(E(\\theta)-\\tfrac{1}{2}\\tfrac{m(\\theta)^{2}}{\\rho(\\theta)}\\right)\\,$. Derive the scalar nonlinear condition for $\\,\\theta\\,$ implied by $\\,p(\\theta)=0\\,$ and reduce it to a quadratic equation. State precisely how the minimal admissible $\\,\\theta\\,$ is selected from the roots of this quadratic under the constraint $\\,\\theta \\in [0,1]\\,$.\n\nConcrete calculation: Take $\\,\\gamma=1.4\\,$ and the two nodal states\n- $\\,\\boldsymbol{U}_{1} = (\\rho_{1},m_{1},E_{1})^{\\top} = (\\,0.05,\\,2.0,\\,39.75\\,)^{\\top}\\,$,\n- $\\,\\boldsymbol{U}_{2} = (\\rho_{2},m_{2},E_{2})^{\\top} = (\\,0.8,\\,4.0,\\,12.5\\,)^{\\top}\\,$,\nso that $\\,\\bar{\\boldsymbol{U}} = \\tfrac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})\\,$. Compute the minimal $\\,\\theta \\in [0,1]\\,$ such that the limited state at node $\\,1\\,$ satisfies $\\,p(\\theta)=0\\,$ (take the pressure floor as $\\,0\\,$ for this computation). Round your answer for $\\,\\theta\\,$ to four significant figures. The final answer you submit must be only the numerical value of $\\,\\theta\\,$, which is dimensionless.",
            "solution": "The user has provided a two-part problem concerning the compressible Euler equations. I will first validate the problem statement and then provide a complete solution.\n\n## Problem Validation\n\n### Step 1: Extract Givens\n\n**Part A (Derivation):**\n-   System of equations: One-dimensional compressible Euler equations in conservation form.\n-   State vector: $\\boldsymbol{q} = (\\rho, \\rho u, E)^{\\top}$.\n-   Flux vector: $\\boldsymbol{f}(\\boldsymbol{q}) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$.\n-   Equation of state: Ideal gas, $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$, with constant $\\gamma > 1$.\n-   Task: Derive the Roe linearization $\\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{L}}, \\boldsymbol{q}_{\\mathrm{R}})$ satisfying $\\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}})$.\n-   Required outputs: Expressions for Roe-averaged quantities $\\tilde{u}$ and $\\tilde{H}$, Roe sound speed $\\tilde{a}$, and the eigenvalues of $\\tilde{\\boldsymbol{A}}$. The derivation must be from first principles.\n\n**Part B (Positivity-Preserving Limiter):**\n-   Context: Nodal Discontinuous Galerkin (DG) method, one cell with two quadrature nodes.\n-   Quadrature weights: Equal, $\\frac{1}{2}$.\n-   Nodal states: $\\boldsymbol{U}_{1}=(\\rho_{1},m_{1},E_{1})^{\\top}$ and $\\boldsymbol{U}_{2}=(\\rho_{2},m_{2},E_{2})^{\\top}$, where $m=\\rho u$.\n-   Cell average: $\\bar{\\boldsymbol{U}}=\\frac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})$.\n-   Limited state at node 1: $\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}})$ with $\\theta \\in [0,1]$.\n-   Positivity constraints: $\\rho(\\theta) > 0$ and $p(\\theta) \\ge 0$ at node 1, where $p(\\theta)=(\\gamma-1)(E(\\theta)-\\frac{1}{2}\\frac{m(\\theta)^{2}}{\\rho(\\theta)})$.\n-   Task 1 (Derivation): Derive the scalar nonlinear condition for $\\theta$ from $p(\\theta)=0$, reduce it to a quadratic equation, and explain how to select the minimal admissible $\\theta \\in [0,1]$.\n-   Task 2 (Calculation): For $\\gamma=1.4$ and given nodal states $\\boldsymbol{U}_{1} = (0.05, 2.0, 39.75)^{\\top}$ and $\\boldsymbol{U}_{2} = (0.8, 4.0, 12.5)^{\\top}$, compute the minimal $\\theta \\in [0,1]$ that makes $p(\\theta)=0$.\n-   Final answer requirement: Numerical value of $\\theta$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded:** The problem deals with the Euler equations, ideal gas law, Roe linearization, and positivity-preserving limiters. These are standard, well-established concepts in computational fluid dynamics (CFD) and applied mathematics. The problem is scientifically sound.\n2.  **Well-Posed:**\n    -   Part A is a standard derivation task with a unique, well-known result. All necessary definitions are provided.\n    -   Part B presents a clear procedure for limiting a solution. It specifies the form of the limited state and the conditions it must satisfy. The given numerical values lead to a situation (negative pressure at a node) where such a limiter is required, making the problem meaningful. It asks to solve for a parameter $\\theta$, and the derivation leads to a solvable quadratic equation. The problem is well-posed.\n3.  **Objective:** The problem is stated in precise mathematical and physical terms, free of ambiguity or subjectivity.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. It is scientifically grounded, well-posed, objective, and contains all necessary information. I will now proceed with the solution.\n\n## Part A: Derivation of the Roe Linearization\n\nThe Roe linearization requires finding a matrix $\\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{L}}, \\boldsymbol{q}_{\\mathrm{R}})$ such that the flux difference across a discontinuity satisfies\n$$ \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}}) $$\nLet $\\Delta(\\cdot)$ denote the jump $(\\cdot)_{\\mathrm{R}} - (\\cdot)_{\\mathrm{L}}$. The condition is $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$.\nThe Roe matrix $\\tilde{\\boldsymbol{A}}$ has the same structure as the true flux Jacobian $\\boldsymbol{A}(\\boldsymbol{q}) = \\frac{\\partial\\boldsymbol{f}}{\\partial\\boldsymbol{q}}$, but is evaluated at a special \"Roe-averaged\" state. The Jacobian of the Euler flux is:\n$$ \\boldsymbol{A}(\\boldsymbol{q}) = \\begin{pmatrix} 0 & 1 & 0 \\\\ \\frac{\\gamma-3}{2}u^2 & (3-\\gamma)u & \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2-H\\right) & H - (\\gamma-1)u^2 & \\gamma u \\end{pmatrix} $$\nwhere $H = (E+p)/\\rho$ is the specific total enthalpy. The Roe matrix $\\tilde{\\boldsymbol{A}}$ is obtained by replacing $u$ and $H$ with their Roe averages $\\tilde{u}$ and $\\tilde{H}$:\n$$ \\tilde{\\boldsymbol{A}} = \\begin{pmatrix} 0 & 1 & 0 \\\\ \\frac{\\gamma-3}{2}\\tilde{u}^2 & (3-\\gamma)\\tilde{u} & \\gamma-1 \\\\ \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H}\\right) & \\tilde{H} - (\\gamma-1)\\tilde{u}^2 & \\gamma \\tilde{u} \\end{pmatrix} $$\nThe Roe-averaged quantities are defined as follows:\n$$ \\tilde{\\rho} = \\sqrt{\\rho_{\\mathrm{L}}\\rho_{\\mathrm{R}}} $$\n$$ \\tilde{u} = \\frac{\\sqrt{\\rho_{\\mathrm{L}}}u_{\\mathrm{L}} + \\sqrt{\\rho_{\\mathrm{R}}}u_{\\mathrm{R}}}{\\sqrt{\\rho_{\\mathrm{L}}} + \\sqrt{\\rho_{\\mathrm{R}}}} $$\n$$ \\tilde{H} = \\frac{\\sqrt{\\rho_{\\mathrm{L}}}H_{\\mathrm{L}} + \\sqrt{\\rho_{\\mathrm{R}}}H_{\\mathrm{R}}}{\\sqrt{\\rho_{\\mathrm{L}}} + \\sqrt{\\rho_{\\mathrm{R}}}} $$\nThe derivation consists of showing that with these definitions, the property $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ holds exactly. This verification relies on several identities that are satisfied by the Roe averages. Let $S_{\\mathrm{L}}=\\sqrt{\\rho_{\\mathrm{L}}}$ and $S_{\\mathrm{R}}=\\sqrt{\\rho_{\\mathrm{R}}}$.\n\n**Key Identities:**\nA crucial set of identities relates the jumps in conserved quantities to jumps in primitive variables using the Roe averages.\n1.  $\\Delta(\\rho u) = \\rho_{\\mathrm{R}}u_{\\mathrm{R}} - \\rho_{\\mathrm{L}}u_{\\mathrm{L}} = S_{\\mathrm{R}}^2 u_{\\mathrm{R}} - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}$.\n    A direct algebraic manipulation shows: $\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\tilde{u}(\\rho_{\\mathrm{R}}-\\rho_{\\mathrm{L}}) + \\sqrt{\\rho_{\\mathrm{L}}\\rho_{\\mathrm{R}}}(u_{\\mathrm{R}}-u_{\\mathrm{L}}) = \\Delta(\\rho u)$.\n2.  $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2\\Delta\\rho$.\n    Proof: $2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2\\Delta\\rho = \\tilde{u}(2\\Delta(\\rho u) - \\tilde{u}\\Delta\\rho)$. The term in parentheses becomes\n    $2(S_{\\mathrm{R}}^2 u_{\\mathrm{R}} - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}) - \\frac{S_{\\mathrm{L}}u_{\\mathrm{L}}+S_{\\mathrm{R}}u_{\\mathrm{R}}}{S_{\\mathrm{L}}+S_{\\mathrm{R}}}(S_{\\mathrm{R}}^2-S_{\\mathrm{L}}^2) = (S_{\\mathrm{L}}+S_{\\mathrm{R}})(S_{\\mathrm{R}}u_{\\mathrm{R}} - S_{\\mathrm{L}}u_{\\mathrm{L}})$.\n    Multiplying by $\\tilde{u}$ gives $(S_{\\mathrm{L}}u_{\\mathrm{L}}+S_{\\mathrm{R}}u_{\\mathrm{R}})(S_{\\mathrm{R}}u_{\\mathrm{R}} - S_{\\mathrm{L}}u_{\\mathrm{L}}) = S_{\\mathrm{R}}^2 u_{\\mathrm{R}}^2 - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}^2 = \\Delta(\\rho u^2)$.\n3.  $\\Delta(\\rho uH) = \\tilde{u}\\Delta(\\rho H) + \\tilde{H}\\Delta(\\rho u) - \\tilde{u}\\tilde{H}\\Delta\\rho$. This can be proven with similar (though lengthier) algebraic steps.\n\n**Verification of the Roe Property:** We check $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ row by row.\n$\\Delta\\boldsymbol{q} = (\\Delta\\rho, \\Delta(\\rho u), \\Delta E)^{\\top} = (\\Delta q_1, \\Delta q_2, \\Delta q_3)^{\\top}$.\n$\\Delta\\boldsymbol{f} = (\\Delta(\\rho u), \\Delta(\\rho u^2+p), \\Delta(u(E+p)))^{\\top} = (\\Delta f_1, \\Delta f_2, \\Delta f_3)^{\\top}$.\n\n*   **Row 1:** $\\Delta f_1 = \\Delta(\\rho u) = \\Delta q_2$.\n    The first row of $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ is $0 \\cdot \\Delta q_1 + 1 \\cdot \\Delta q_2 + 0 \\cdot \\Delta q_3 = \\Delta q_2$. This is correct.\n\n*   **Row 2:** $\\Delta f_2 = \\Delta(\\rho u^2+p) = \\Delta(\\rho u^2) + \\Delta p$.\n    Using $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$, we have $\\Delta p = (\\gamma-1)(\\Delta E - \\frac{1}{2}\\Delta(\\rho u^2))$.\n    So, $\\Delta f_2 = \\Delta(\\rho u^2) + (\\gamma-1)(\\Delta E - \\frac{1}{2}\\Delta(\\rho u^2)) = \\frac{3-\\gamma}{2}\\Delta(\\rho u^2) + (\\gamma-1)\\Delta E$.\n    The second row of $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ is $\\frac{\\gamma-3}{2}\\tilde{u}^2 \\Delta q_1 + (3-\\gamma)\\tilde{u} \\Delta q_2 + (\\gamma-1) \\Delta q_3$.\n    Equating the two expressions for $\\Delta f_2$, we must verify:\n    $\\frac{3-\\gamma}{2}\\Delta(\\rho u^2) = \\frac{\\gamma-3}{2}\\tilde{u}^2 \\Delta\\rho + (3-\\gamma)\\tilde{u}\\Delta(\\rho u)$.\n    Dividing by $\\frac{3-\\gamma}{2}$, this is exactly Identity 2: $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2 \\Delta\\rho$. This is correct.\n\n*   **Row 3:** $\\Delta f_3 = \\Delta(u(E+p)) = \\Delta(\\rho u H)$.\n    The third row of $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ is $\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\gamma\\tilde{u}\\Delta E$.\n    Let's rearrange this expression. From the relation for pressure, $\\Delta p = \\frac{\\gamma-1}{\\gamma}\\Delta(\\rho(H-u^2/2)) = \\frac{\\gamma-1}{\\gamma}(\\Delta(\\rho H)-\\frac{1}{2}\\Delta(\\rho u^2))$.\n    Also, $\\Delta E = \\frac{\\Delta p}{\\gamma-1} + \\frac{1}{2}\\Delta(\\rho u^2) = \\frac{1}{\\gamma}\\Delta(\\rho H) + \\frac{\\gamma-1}{2\\gamma}\\Delta(\\rho u^2)$.\n    Substitute this into the third row expression:\n    $\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\gamma\\tilde{u}\\left( \\frac{1}{\\gamma}\\Delta(\\rho H) + \\frac{\\gamma-1}{2\\gamma}\\Delta(\\rho u^2) \\right)$\n    $= \\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\tilde{u}\\Delta(\\rho H) + \\frac{\\gamma-1}{2}\\tilde{u}\\Delta(\\rho u^2)$.\n    Using Identity 2, $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2 \\Delta\\rho$:\n    $= \\tilde{u}\\Delta(\\rho H) + \\Delta\\rho\\left[\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H}) - \\frac{\\gamma-1}{2}\\tilde{u}^3\\right] + \\Delta(\\rho u)\\left[\\tilde{H} - (\\gamma-1)\\tilde{u}^2 + (\\gamma-1)\\tilde{u}^2\\right]$\n    $= \\tilde{u}\\Delta(\\rho H) + \\Delta\\rho[-\\tilde{u}\\tilde{H}] + \\Delta(\\rho u)[\\tilde{H}]$.\n    This is precisely Identity 3: $\\tilde{u}\\Delta(\\rho H) + \\tilde{H}\\Delta(\\rho u) - \\tilde{u}\\tilde{H}\\Delta\\rho = \\Delta(\\rho u H)$. This is correct.\n\n**Eigenvalues:**\nThe eigenvalues of the Roe matrix $\\tilde{\\boldsymbol{A}}$ are obtained by analogy with the eigenvalues of the true Jacobian $\\boldsymbol{A}(\\boldsymbol{q})$, which are $\\lambda_1=u-a$, $\\lambda_2=u$, $\\lambda_3=u+a$, where $a=\\sqrt{\\gamma p/\\rho}$ is the sound speed. Replacing the variables with their Roe-averaged counterparts gives the eigenvalues of $\\tilde{\\boldsymbol{A}}$:\n$$ \\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a} $$\nThe Roe-averaged sound speed $\\tilde{a}$ is defined by\n$$ \\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right) $$\nThis expression arises from requiring $\\tilde{a}^2 = \\gamma\\tilde{p}/\\tilde{\\rho}$ which can be shown to be consistent with the other definitions. The Roe-averaging procedure guarantees that $\\tilde{a}^2 > 0$ if the states L and R have positive pressure and density, thus ensuring the hyperbolicity of the linearized system.\n\n## Part B: Positivity-Preserving Limiter\n\nThe problem asks for the derivation of a condition on a scaling factor $\\theta$ to enforce positivity of pressure, and then to compute this factor for a specific case.\n\n**Derivation of the Quadratic Equation:**\nThe limited state at node 1 is given by $\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}})$, where $\\theta \\in [0,1]$. This can be written as a convex combination: $\\boldsymbol{U}_{1}^{\\mathrm{lim}}(\\theta) = (1-\\theta)\\bar{\\boldsymbol{U}} + \\theta\\boldsymbol{U}_{1}$.\nThe components of the limited state vector $\\boldsymbol{U}_{1}^{\\mathrm{lim}}(\\theta) = (\\rho(\\theta), m(\\theta), E(\\theta))^{\\top}$ are:\n$$ \\rho(\\theta) = (1-\\theta)\\bar{\\rho} + \\theta\\rho_{1} $$\n$$ m(\\theta) = (1-\\theta)\\bar{m} + \\theta m_{1} $$\n$$ E(\\theta) = (1-\\theta)\\bar{E} + \\theta E_{1} $$\nThe pressure positivity constraint is $p(\\theta) \\ge 0$, where $p(\\theta) = (\\gamma-1)(E(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)})$. We set $p(\\theta)=0$ to find the boundary of the admissible region. Since $\\gamma > 1$, this requires\n$$ E(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)} = 0 $$\nAssuming $\\rho(\\theta)>0$, this is equivalent to $2E(\\theta)\\rho(\\theta) - m(\\theta)^2 = 0$.\nSubstituting the expressions for $\\rho(\\theta), m(\\theta), E(\\theta)$:\n$$ 2 \\left((1-\\theta)\\bar{E} + \\theta E_{1}\\right) \\left((1-\\theta)\\bar{\\rho} + \\theta\\rho_{1}\\right) - \\left((1-\\theta)\\bar{m} + \\theta m_{1}\\right)^2 = 0 $$\nThis is a quadratic equation in $\\theta$. Let's expand it in powers of $\\theta$:\n$$ (1-\\theta)^2 [2\\bar{E}\\bar{\\rho} - \\bar{m}^2] + \\theta(1-\\theta)[2(\\bar{E}\\rho_1 + E_1\\bar{\\rho}) - 2\\bar{m}m_1] + \\theta^2[2E_1\\rho_1 - m_1^2] = 0 $$\nLet $C_0 = 2\\bar{E}\\bar{\\rho} - \\bar{m}^2$, $C_1 = 2(\\bar{E}\\rho_1 + E_1\\bar{\\rho}) - 2\\bar{m}m_1$, and $C_2 = 2E_1\\rho_1 - m_1^2$. The equation is:\n$$ (1-2\\theta+\\theta^2)C_0 + (\\theta-\\theta^2)C_1 + \\theta^2 C_2 = 0 $$\nRearranging into the standard form $A\\theta^2 + B\\theta + C = 0$:\n$$ \\theta^2(C_0 - C_1 + C_2) + \\theta(-2C_0 + C_1) + C_0 = 0 $$\nThus, $A=C_0 - C_1 + C_2$, $B=-2C_0 + C_1$, and $C=C_0$.\n\n**Selection of $\\theta$:**\nThe coefficient $C=C_0$ is proportional to the numerator of the pressure of the cell-averaged state $\\bar{\\boldsymbol{U}}$. It is assumed that the cell average has positive pressure, so $C_0 > 0$. The value of the quadratic at $\\theta=1$ is $A(1)^2+B(1)+C = C_2$, which is proportional to the numerator of the pressure at the original nodal state $\\boldsymbol{U}_1$. The limiting procedure is invoked because this pressure is negative, so $C_2 < 0$.\nA continuous function that is positive at $\\theta=0$ and negative at $\\theta=1$ must have at least one root in the interval $(0,1)$.\nThe set of admissible states (with positive density and pressure) is convex. The trajectory of $\\boldsymbol{U}_1^{\\text{lim}}(\\theta)$ for $\\theta \\in [0,1]$ is a straight line from the admissible state $\\bar{\\boldsymbol{U}}$ to the non-physical state $\\boldsymbol{U}_1$. This line must cross the boundary of the admissible set exactly once in $(0,1)$. Therefore, the quadratic equation has a unique root $\\theta_p \\in (0,1)$.\nThe region where $p(\\theta) \\ge 0$ is the interval $[0, \\theta_p]$. The question asks for the minimal $\\theta \\in [0,1]$ such that $p(\\theta)=0$. This is precisely the root $\\theta_p$.\n\n**Concrete Calculation:**\nGiven $\\gamma=1.4$, $\\boldsymbol{U}_{1} = (0.05, 2.0, 39.75)^{\\top}$, and $\\boldsymbol{U}_{2} = (0.8, 4.0, 12.5)^{\\top}$.\nFirst, compute the cell average $\\bar{\\boldsymbol{U}}$:\n$$ \\bar{\\rho} = \\frac{0.05+0.8}{2} = 0.425 $$\n$$ \\bar{m} = \\frac{2.0+4.0}{2} = 3.0 $$\n$$ \\bar{E} = \\frac{39.75+12.5}{2} = 26.125 $$\nSo $\\bar{\\boldsymbol{U}} = (0.425, 3.0, 26.125)^{\\top}$.\nThe state at node 1 needs limiting because its pressure is negative: $p_1 = (1.4-1)(39.75 - \\frac{2.0^2}{2 \\times 0.05}) = 0.4(39.75 - 40) = -0.1$.\nThe state is modified as $\\boldsymbol{U}_1^{\\text{lim}}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_1 - \\bar{\\boldsymbol{U}})$. The components are:\n$$ \\rho(\\theta) = 0.425 + \\theta(0.05 - 0.425) = 0.425 - 0.375\\theta $$\n$$ m(\\theta) = 3.0 + \\theta(2.0 - 3.0) = 3.0 - \\theta $$\n$$ E(\\theta) = 26.125 + \\theta(39.75 - 26.125) = 26.125 + 13.625\\theta $$\nThe condition $p(\\theta)=0$ leads to $2E(\\theta)\\rho(\\theta) - m(\\theta)^2 = 0$.\n$$ 2(26.125 + 13.625\\theta)(0.425 - 0.375\\theta) - (3.0 - \\theta)^2 = 0 $$\nExpanding the terms:\n$2(26.125 \\times 0.425 - 26.125 \\times 0.375\\theta + 13.625 \\times 0.425\\theta - 13.625 \\times 0.375\\theta^2) - (9 - 6\\theta + \\theta^2) = 0$\n$2(11.103125 - 9.796875\\theta + 5.790625\\theta - 5.109375\\theta^2) - (9 - 6\\theta + \\theta^2) = 0$\n$2(11.103125 - 4.00625\\theta - 5.109375\\theta^2) - 9 + 6\\theta - \\theta^2 = 0$\n$22.20625 - 8.0125\\theta - 10.21875\\theta^2 - 9 + 6\\theta - \\theta^2 = 0$\nCollecting terms for the quadratic equation in $\\theta$:\n$$ (-10.21875 - 1)\\theta^2 + (-8.0125 + 6)\\theta + (22.20625 - 9) = 0 $$\n$$ -11.21875\\theta^2 - 2.0125\\theta + 13.20625 = 0 $$\nMultiplying by $-1$:\n$$ 11.21875\\theta^2 + 2.0125\\theta - 13.20625 = 0 $$\nWe solve for $\\theta$ using the quadratic formula, $\\theta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{2.0125^2 - 4(11.21875)(-13.20625)}}{2(11.21875)} $$\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{4.05015625 + 592.6546875}}{22.4375} $$\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{596.70484375}}{22.4375} $$\n$$ \\theta = \\frac{-2.0125 \\pm 24.42754274}{22.4375} $$\nWe seek the root in $[0,1]$. The positive solution is:\n$$ \\theta = \\frac{-2.0125 + 24.42754274}{22.4375} = \\frac{22.41504274}{22.4375} \\approx 0.999000... $$\nThe other root is negative ($\\approx -1.178$) and is not physically relevant.\nRounding to four significant figures, we get $\\theta = 0.9990$.",
            "answer": "$$\n\\boxed{0.9990}\n$$"
        },
        {
            "introduction": "Our final practice addresses a more subtle but critical challenge: the loss of accuracy and efficiency of compressible flow solvers in the low-Mach number regime. This stiffness arises from the large disparity between acoustic and convective wave speeds. This exercise  introduces the concept of all-speed preconditioning, guiding you through the derivation of a matrix that rescales the system's eigenvalues to make it well-conditioned across all Mach numbers. Mastering this technique is essential for developing versatile DG methods that can handle both compressible and nearly-incompressible flows.",
            "id": "3376451",
            "problem": "Consider the inviscid part of the one-dimensional compressible Navier-Stokes equations (Euler limit) for a calorically perfect gas with ratio of specific heats $\\gamma$, written in primitive variables $W = [\\rho, u, p]^{\\top}$, where $\\rho$ is the density, $u$ is the velocity, and $p$ is the pressure. Assume an ideal gas closure and smooth solutions. Let the spatial coordinate be $x$ and the time be $t$. The inviscid subsystem admits a quasi-linear form $\\partial W / \\partial t + A(W) \\, \\partial W / \\partial x = 0$, where $A(W)$ is the inviscid flux Jacobian in primitive variables.\n\nDiscontinuous Galerkin (DG) formulations for compressible flow become inaccurate and stiff in the low-Mach-number limit due to the disparity between convective and acoustic wave speeds. To address this, one introduces a preconditioning matrix $P(W; \\beta)$ multiplying the time derivative, yielding the modified system $P(W; \\beta)\\, \\partial W / \\partial t + A(W)\\, \\partial W / \\partial x = 0$, so that the eigenvalues of the preconditioned operator $P(W; \\beta)^{-1} A(W)$ are rescaled to alleviate stiffness while recovering correct low-Mach asymptotics. Here $\\beta = \\beta(M_{\\text{ref}}) \\in (0,1]$ is a prescribed Mach-scaling function of a chosen reference Mach number $M_{\\text{ref}}$, satisfying $\\beta \\to M_{\\text{ref}}$ as $M_{\\text{ref}} \\to 0$ and $\\beta \\to 1$ as $M_{\\text{ref}} \\to 1$ and above.\n\nStarting from the governing equations and their quasi-linear form in primitive variables, perform a low-Mach-number asymptotic analysis to identify the source of stiffness in terms of the eigenstructure of $A(W)$, and then, by enforcing that:\n- the entropy (convective) characteristic speed remains $u$,\n- the acoustic characteristic speeds are mapped from $u \\pm a$ to $u \\pm \\beta a$, where $a = \\sqrt{\\gamma p / \\rho}$ is the local speed of sound,\n- the preconditioner reduces to the identity as $\\beta \\to 1$,\n\nderive an explicit, closed-form analytic expression for a preconditioning matrix $P(W; \\beta)$ in primitive variables that achieves these properties. Your final expression must be a single analytic matrix in terms of $\\rho$, $u$, $p$, $a$, and $\\beta$. Express your final answer as a $3 \\times 3$ matrix in terms of these symbols. Do not introduce any additional numerical constants, and do not assume any special values of $\\gamma$. No rounding is required, and no units are to be reported in the final answer.",
            "solution": "The user wants to derive a preconditioning matrix for the one-dimensional compressible Euler equations in primitive variables.\n\n**1. Problem Validation**\n\n*   **Step 1: Extract Givens**\n    *   System: 1D inviscid compressible Navier-Stokes equations (Euler equations) for a calorically perfect gas.\n    *   Variables: Primitive variables $W = [\\rho, u, p]^{\\top}$, where $\\rho$ is density, $u$ is velocity, $p$ is pressure.\n    *   System Form: Quasi-linear form $\\partial W / \\partial t + A(W) \\, \\partial W / \\partial x = 0$, where $A(W)$ is the inviscid flux Jacobian.\n    *   Preconditioned System: $P(W; \\beta)\\, \\partial W / \\partial t + A(W)\\, \\partial W / \\partial x = 0$.\n    *   Preconditioning Parameter: $\\beta = \\beta(M_{\\text{ref}}) \\in (0,1]$, a function of a reference Mach number $M_{\\text{ref}}$.\n    *   Speed of Sound: $a = \\sqrt{\\gamma p / \\rho}$, where $\\gamma$ is the ratio of specific heats.\n\n    *   Conditions for the preconditioning matrix $P(W; \\beta)$:\n        1.  The entropy characteristic speed of the preconditioned operator $P^{-1}A$ must remain $u$.\n        2.  The acoustic characteristic speeds of $A$, which are $u \\pm a$, must be mapped to $u \\pm \\beta a$ for the operator $P^{-1}A$.\n        3.  The preconditioner must reduce to the identity matrix $I$ as $\\beta \\to 1$, i.e., $\\lim_{\\beta \\to 1} P(W; \\beta) = I$.\n\n*   **Step 2: Validate Using Extracted Givens**\n    *   **Scientifically Grounded:** The problem is rooted in the well-established field of computational fluid dynamics (CFD), specifically addressing the known issue of low-Mach-number stiffness in numerical methods for compressible flows. The concept of preconditioning is a standard technique. All principles and equations are standard.\n    *   **Well-Posed:** The problem provides a clear objective (derive $P$) and a set of explicit mathematical constraints that the solution must satisfy. The information is sufficient to derive a unique solution under the standard assumption that the preconditioner preserves the eigenvectors of the original system.\n    *   **Objective:** The language is formal and precise, with no subjective or ambiguous statements.\n\n*   **Step 3: Verdict and Action**\n    *   The problem is valid. I will proceed with the derivation.\n\n**2. Derivation and Solution**\n\nThe derivation proceeds in several steps:\n1.  Formulate the quasi-linear system and identify the flux Jacobian $A(W)$.\n2.  Determine the eigenstructure (eigenvalues and eigenvectors) of $A(W)$. This will identify the source of low-Mach stiffness.\n3.  Construct the preconditioner $P$ by imposing the specified modifications on the eigenvalues while preserving the eigenvectors.\n\n**Step 2.1: The Quasi-Linear System**\n\nThe 1D Euler equations for a calorically perfect gas in primitive variables $(\\rho, u, p)$ for smooth solutions are:\n*   Continuity: $\\partial_t \\rho + u \\partial_x \\rho + \\rho \\partial_x u = 0$\n*   Momentum: $\\partial_t u + u \\partial_x u + \\frac{1}{\\rho}\\partial_x p = 0$\n*   Energy (from entropy conservation): $\\partial_t p + u \\partial_x p + \\gamma p \\partial_x u = 0$\n\nWriting this system in the matrix form $\\partial_t W + A(W) \\partial_x W = 0$ for $W = [\\rho, u, p]^\\top$:\n$$\n\\begin{pmatrix} \\partial_t \\rho \\\\ \\partial_t u \\\\ \\partial_t p \\end{pmatrix} + \\begin{pmatrix} u & \\rho & 0 \\\\ 0 & u & 1/\\rho \\\\ 0 & \\gamma p & u \\end{pmatrix} \\begin{pmatrix} \\partial_x \\rho \\\\ \\partial_x u \\\\ \\partial_x p \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe inviscid flux Jacobian in primitive variables is therefore:\n$$\nA(W) = \\begin{pmatrix} u & \\rho & 0 \\\\ 0 & u & 1/\\rho \\\\ 0 & \\gamma p & u \\end{pmatrix}\n$$\n\n**Step 2.2: Eigenstructure of A(W)**\n\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} u-\\lambda & \\rho & 0 \\\\ 0 & u-\\lambda & 1/\\rho \\\\ 0 & \\gamma p & u-\\lambda \\end{pmatrix} = (u-\\lambda) \\left( (u-\\lambda)^2 - \\frac{\\gamma p}{\\rho} \\right) = 0\n$$\nUsing the definition of the speed of sound $a^2 = \\gamma p / \\rho$, this becomes:\n$$\n(u-\\lambda)((u-\\lambda)^2 - a^2) = 0\n$$\nThe eigenvalues are the characteristic wave speeds of the system:\n$$\n\\lambda_1 = u-a \\quad \\text{(acoustic)}, \\quad \\lambda_2 = u \\quad \\text{(entropy/convective)}, \\quad \\lambda_3 = u+a \\quad \\text{(acoustic)}\n$$\nAt low Mach numbers ($M = u/a \\ll 1$), we have $|u| \\ll a$. The eigenvalues are approximately $-a, 0, a$. The disparity between the convective speed $u$ and the acoustic speed $a$ is the source of stiffness for explicit time-stepping schemes, which are constrained by the fastest wave speed ($|u|+a \\approx a$), while the phenomena of interest evolve on the much slower time scale associated with $u$.\n\nThe corresponding right eigenvectors $r_i$ (where $A r_i = \\lambda_i r_i$) and left eigenvectors $l_i^\\top$ (where $l_i^\\top A = \\lambda_i l_i^\\top$) can be found. A standard choice for the matrices of right eigenvectors $(R = [r_1, r_2, r_3])$ and left eigenvectors $(L = R^{-1} = [l_1, l_2, l_3]^\\top)$ is:\n$$\nR = \\begin{pmatrix} \\rho & 1 & \\rho \\\\ -a & 0 & a \\\\ \\gamma p & 0 & \\gamma p \\end{pmatrix}, \\quad L = R^{-1} = \\frac{1}{2a\\gamma p} \\begin{pmatrix} 0 & -\\gamma p & a \\\\ 2a\\gamma p & 0 & -2a\\rho \\\\ 0 & \\gamma p & a \\end{pmatrix}\n$$\nNote that $\\gamma p = \\rho a^2$. The set of eigenvectors is not unique (due to scaling), but the final preconditioner matrix will be independent of this choice.\n\n**Step 2.3: Construction of the Preconditioner P**\n\nThe preconditioned system is $\\partial_t W + P^{-1} A \\partial_x W = 0$. We need to construct $P$ such that the eigenvalues of the new system matrix $A' = P^{-1} A$ are:\n$$\n\\lambda'_1 = u-\\beta a, \\quad \\lambda'_2 = u, \\quad \\lambda'_3 = u+\\beta a\n$$\nThis satisfies the first two conditions. Let the diagonal matrix of original eigenvalues be $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$ and the target eigenvalues be $\\Lambda' = \\text{diag}(\\lambda'_1, \\lambda'_2, \\lambda'_3)$.\nThe standard method to construct such a preconditioner is to enforce that it preserves the original eigenvectors. This means that $A'$ has the same eigenvectors as $A$.\nSince $A = R \\Lambda R^{-1}$, the new matrix must be $A' = R \\Lambda' R^{-1}$.\nFrom $A' = P^{-1}A$, we have:\n$$\nP^{-1} = A' A^{-1} = (R \\Lambda' R^{-1}) (R \\Lambda R^{-1})^{-1} = (R \\Lambda' R^{-1}) (R \\Lambda^{-1} R^{-1}) = R (\\Lambda' \\Lambda^{-1}) R^{-1}\n$$\nInverting this expression gives the preconditioner $P$:\n$$\nP = (R (\\Lambda' \\Lambda^{-1}) R^{-1})^{-1} = R (\\Lambda' \\Lambda^{-1})^{-1} R^{-1} = R (\\Lambda (\\Lambda')^{-1}) R^{-1}\n$$\nLet's check the third condition: as $\\beta \\to 1$, we have $\\Lambda' \\to \\Lambda$. Then $\\Lambda (\\Lambda')^{-1} \\to \\Lambda \\Lambda^{-1} = I$. In this limit, $P \\to R I R^{-1} = I$, so all conditions are met.\n\n**Step 2.4: Calculating the Matrix P**\n\nWe now compute $P = R D R^{-1}$, where $D = \\Lambda (\\Lambda')^{-1}$ is the diagonal matrix:\n$$\nD = \\begin{pmatrix} \\frac{u-a}{u-\\beta a} & 0 & 0 \\\\ 0 & \\frac{u}{u} & 0 \\\\ 0 & 0 & \\frac{u+a}{u+\\beta a} \\end{pmatrix} = \\begin{pmatrix} d_{11} & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & d_{33} \\end{pmatrix}\n$$\nThe matrix $P$ can be computed via the sum of outer products of the eigenvectors:\n$$\nP = \\sum_{i=1}^{3} D_{ii} r_i l_i^\\top = d_{11} r_1 l_1^\\top + 1 \\cdot r_2 l_2^\\top + d_{33} r_3 l_3^\\top\n$$\nLet's compute the individual matrix components:\n*   $P_{11} = d_{11}(r_1 l_1^\\top)_{11} + (r_2 l_2^\\top)_{11} + d_{33}(r_3 l_3^\\top)_{11} = 0 + 1 + 0 = 1$\n*   $P_{12} = d_{11} (\\frac{\\rho(-\\gamma p)}{2a\\gamma p}) + d_{33} (\\frac{\\rho(\\gamma p)}{2a\\gamma p}) = \\frac{\\rho}{2a}(d_{33}-d_{11})$\n*   $P_{13} = d_{11}(\\frac{\\rho a}{2a\\gamma p}) + (\\frac{1(-2a\\rho)}{2a\\gamma p}) + d_{33}(\\frac{\\rho a}{2a\\gamma p}) = \\frac{\\rho}{2\\gamma p}(d_{11}+d_{33}) - \\frac{\\rho}{\\gamma p} = \\frac{\\rho}{\\gamma p}\\left( \\frac{d_{11}+d_{33}}{2} - 1 \\right)$\n*   $P_{21} = 0$, $P_{31} = 0$\n*   $P_{22} = d_{11}(\\frac{-a(-\\gamma p)}{2a\\gamma p}) + d_{33}(\\frac{a(\\gamma p)}{2a\\gamma p}) = \\frac{1}{2}(d_{11}+d_{33})$\n*   $P_{23} = d_{11}(\\frac{-a(a)}{2a\\gamma p}) + d_{33}(\\frac{a(a)}{2a\\gamma p}) = \\frac{a}{2\\gamma p}(d_{33}-d_{11})$\n*   $P_{32} = d_{11}(\\frac{\\gamma p(-\\gamma p)}{2a\\gamma p}) + d_{33}(\\frac{\\gamma p(\\gamma p)}{2a\\gamma p}) = \\frac{\\gamma p}{2a}(d_{33}-d_{11})$\n*   $P_{33} = d_{11}(\\frac{\\gamma p(a)}{2a\\gamma p}) + d_{33}(\\frac{\\gamma p(a)}{2a\\gamma p}) = \\frac{1}{2}(d_{11}+d_{33})$\n\nNow, we evaluate the terms involving $d_{ii}$:\n$$\nd_{33}-d_{11} = \\frac{u+a}{u+\\beta a} - \\frac{u-a}{u-\\beta a} = \\frac{(u+a)(u-\\beta a) - (u-a)(u+\\beta a)}{(u+\\beta a)(u-\\beta a)} = \\frac{2ua - 2u\\beta a}{u^2 - \\beta^2 a^2} = \\frac{2ua(1-\\beta)}{u^2 - \\beta^2 a^2}\n$$\n$$\nd_{11}+d_{33} = \\frac{u+a}{u+\\beta a} + \\frac{u-a}{u-\\beta a} = \\frac{(u+a)(u-\\beta a) + (u-a)(u+\\beta a)}{u^2 - \\beta^2 a^2} = \\frac{2u^2 - 2\\beta a^2}{u^2 - \\beta^2 a^2}\n$$\nSubstituting these into the components of $P$:\n*   $P_{12} = \\frac{\\rho}{2a} \\left(\\frac{2ua(1-\\beta)}{u^2 - \\beta^2 a^2}\\right) = \\frac{\\rho u(1-\\beta)}{u^2 - \\beta^2 a^2}$\n*   $P_{13} = \\frac{\\rho}{\\gamma p}\\left( \\frac{u^2 - \\beta a^2}{u^2 - \\beta^2 a^2} - 1 \\right) = \\frac{\\rho}{\\gamma p}\\left( \\frac{u^2 - \\beta a^2 - (u^2 - \\beta^2 a^2)}{u^2 - \\beta^2 a^2} \\right) = \\frac{\\rho}{\\gamma p}\\frac{a^2(\\beta^2-\\beta)}{u^2 - \\beta^2 a^2} = \\frac{\\beta(\\beta-1)}{u^2 - \\beta^2 a^2}$\n*   $P_{22} = P_{33} = \\frac{1}{2} \\left( \\frac{2u^2 - 2\\beta a^2}{u^2 - \\beta^2 a^2} \\right) = \\frac{u^2 - \\beta a^2}{u^2 - \\beta^2 a^2}$\n*   $P_{23} = \\frac{a}{2\\gamma p}\\left(\\frac{2ua(1-\\beta)}{u^2 - \\beta^2 a^2}\\right) = \\frac{ua^2(1-\\beta)}{\\gamma p(u^2 - \\beta^2 a^2)} = \\frac{u(1-\\beta)}{\\rho(u^2 - \\beta^2 a^2)}$\n*   $P_{32} = \\frac{\\gamma p}{2a}\\left(\\frac{2ua(1-\\beta)}{u^2 - \\beta^2 a^2}\\right) = \\frac{\\gamma p u(1-\\beta)}{u^2 - \\beta^2 a^2} = \\frac{\\rho a^2 u(1-\\beta)}{u^2 - \\beta^2 a^2}$\n\nCombining these components gives the final preconditioning matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\frac{\\rho u(1-\\beta)}{u^2 - \\beta^2 a^2} & \\frac{\\beta(\\beta-1)}{u^2 - \\beta^2 a^2} \\\\\n0 & \\frac{u^2 - \\beta a^2}{u^2 - \\beta^2 a^2} & \\frac{u(1-\\beta)}{\\rho(u^2-\\beta^2 a^2)} \\\\\n0 & \\frac{\\rho a^2 u(1-\\beta)}{u^2 - \\beta^2 a^2} & \\frac{u^2 - \\beta a^2}{u^2 - \\beta^2 a^2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}