{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您完成局部间断Galerkin（LDG）方法的基本力学构建。通过处理一个简单的一维扩散问题，您将练习从一阶系统推导弱形式，更重要的是，学习如何使用数值通量来施加边界数据。这是将LDG方法应用于任何问题的基础技能。",
            "id": "3365011",
            "problem": "考虑区间 $[0,1]$ 上的一个一维、稳态、二阶扩散模型，其扩散系数 $\\kappa > 0$ 为正常数，\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) \\;=\\; f(x),\n$$\n该模型服从边界条件 $u(0)=0$ 和 $\\kappa\\, u'(1)=1$，源项为零 $f(x)\\equiv 0$。引入辅助变量 $r(x)=\\kappa\\, u'(x)$，使系统变为\n$$\nr - \\kappa\\, u' \\;=\\; 0, \\qquad -r' \\;=\\; 0.\n$$\n使用局部间断伽辽金 (Local Discontinuous Galerkin, LDG) 方法，在单个单元 $E=[0,1]$ 上通过 $p=1$ 次的分段多项式来逼近 $u$ 和 $r$：\n$u_h(x) = a_0\\phi_0(x) + a_1\\phi_1(x)$, $r_h(x) = b_0\\phi_0(x) + b_1\\phi_1(x)$,\n其中，单元 $E$ 上的局部基函数选择为 $\\phi_0(x)=1$ 和 $\\phi_1(x)=x$。令 $v,w \\in \\mathrm{span}\\{\\phi_0,\\phi_1\\}$ 分别作为第一个和第二个方程的检验函数。从一阶系统出发，通过适当使用分部积分，并将边界上的迹替换为数值通量，推导单元上的 LDG 弱形式。对于数值通量，在单个单元的边界上采用标准的 LDG 交替格式：\n- 在 $x=0$ 处 (狄利克雷边界)，设置 $\\widehat{u}(0)=u_D=0$，并对 $\\widehat{r}(0)$ 使用内部值 $\\widehat{r}(0)=r_h(0)$。\n- 在 $x=1$ 处 (诺伊曼边界)，设置 $\\widehat{r}(1)=g_N=1$，并对 $\\widehat{u}(1)$ 使用内部值 $\\widehat{u}(1)=u_h(1)$。\n\n写出最终的单元 LDG 系统，然后显式计算 $p=1$ 次多项式的边界贡献。具体来说，提取仅由给定边界数据 $(u_D,g_N)=(0,1)$ 产生的局部残差中的纯边界贡献，该贡献通过每个方程中的两个检验函数 $\\phi_0$ 和 $\\phi_1$进行计算。将这四个边界贡献按行向量的形式排列\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big],\n$$\n其中，$B^{(r-\\kappa u')}_{\\phi_j}$ 和 $B^{(-r')}_{\\phi_j}$ 分别表示第一个和第二个方程的弱形式中，仅由给定边界数据产生的边界项。请将此行向量作为最终答案。无需四舍五入。请以闭式解析表达式给出最终答案。",
            "solution": "用户要求我基于局部间断伽辽金 (LDG) 方法求解一个关于一维扩散方程的问题。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n-   **控制方程**：在区间 $[0,1]$ 上，$- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) = f(x)$。\n-   **参数**：扩散系数 $\\kappa > 0$ 为常数。源项 $f(x) \\equiv 0$。\n-   **边界条件**：$u(0)=u_D=0$ 和 $\\kappa\\, u'(1)=g_N=1$。\n-   **一阶系统**：辅助变量为 $r(x)=\\kappa\\, u'(x)$。该系统为：\n    $$\n    r - \\kappa\\, u' = 0\n    $$\n    $$\n    -r' = 0\n    $$\n-   **离散化**：区域为单个单元 $E=[0,1]$。逼近空间由 $p=1$ 次多项式组成。\n-   **试探函数和检验函数**：\n    -   基函数：$\\phi_0(x)=1$，$\\phi_1(x)=x$。\n    -   试探函数：$u_h(x) = a_0\\phi_0(x) + a_1\\phi_1(x)$ 和 $r_h(x) = b_0\\phi_0(x) + b_1\\phi_1(x)$。\n    -   检验函数：$v,w \\in \\mathrm{span}\\{\\phi_0,\\phi_1\\}$。\n-   **数值通量**：指定了交替通量格式：\n    -   在 $x=0$ 处：$\\widehat{u}(0)=u_D=0$；$\\widehat{r}(0)=r_h(0)$。\n    -   在 $x=1$ 处：$\\widehat{r}(1)=g_N=1$；$\\widehat{u}(1)=u_h(1)$。\n-   **任务**：计算局部残差的四个边界贡献，按行向量 $\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]$ 排列，这些贡献仅由给定的边界数据 $(u_D,g_N)=(0,1)$ 产生。\n\n**1.2. 使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题是将成熟的局部间断伽辽金 (LDG) 方法应用于一个基本的二阶椭圆偏微分方程（扩散方程）的标准应用。所有概念在数值分析和计算科学中都是标准的。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了一套完整的指令，包括控制方程、边界条件、离散化细节（单元、基函数）以及数值通量的具体选择。任务是基于这些输入进行的一个具体、明确的计算。\n-   **客观性**：问题陈述以精确的数学术语表述，没有任何主观或模棱两可的语言。\n\n**1.3. 结论与行动**\n\n问题有效。我将继续进行求解。\n\n### 步骤 2：求解推导\n\n该过程首先推导一阶系统在单元 $E=[0,1]$ 上的弱形式。\n\n**第一个方程弱形式的推导**\n第一个方程是 $r - \\kappa u' = 0$。我们用检验函数 $v$ 乘以该方程，并在单元 $E$ 上积分：\n$$\n\\int_{E} (r_h - \\kappa u'_h) v \\, dx = 0\n$$\n$$\n\\int_{0}^{1} r_h v \\, dx - \\kappa \\int_{0}^{1} u'_h v \\, dx = 0\n$$\n我们对第二项使用分部积分：\n$$\n\\int_{0}^{1} u'_h v \\, dx = [u_h v]_{x=0}^{x=1} - \\int_{0}^{1} u_h v' \\, dx = u_h(1)v(1) - u_h(0)v(0) - \\int_{0}^{1} u_h v' \\, dx\n$$\n将其代回方程得到：\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa(u_h(1)v(1) - u_h(0)v(0)) = 0\n$$\n在间断伽辽金框架中，单元边界上解的迹被数值通量（用帽子符号表示）所取代。弱形式变为：\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa \\widehat{u}(1)v(1) + \\kappa \\widehat{u}(0)v(0) = 0\n$$\n\n**第二个方程弱形式的推导**\n第二个方程是 $-r' = 0$。我们用检验函数 $w$ 乘以该方程，并在 $E$ 上积分：\n$$\n-\\int_{E} r'_h w \\, dx = 0\n$$\n应用分部积分：\n$$\n-[r_h w]_{x=0}^{x=1} + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n$$\n-(r_h(1)w(1) - r_h(0)w(0)) + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n用数值通量 $\\widehat{r}(1)$ 和 $\\widehat{r}(0)$ 替换边界上的迹：\n$$\n\\int_{0}^{1} r_h w' \\, dx - \\widehat{r}(1)w(1) + \\widehat{r}(0)w(0) = 0\n$$\n\n**定义局部残差并识别边界贡献**\n问题要求的是仅由给定边界数据产生的对局部残差的贡献。每个方程的局部残差是必须等于零的表达式。我们代入问题中给定的具体数值通量：\n-   在 $x=0$ 处：$\\widehat{u}(0)=u_D=0$，$\\widehat{r}(0)=r_h(0)$（内部值）。\n-   在 $x=1$ 处：$\\widehat{r}(1)=g_N=1$，$\\widehat{u}(1)=u_h(1)$（内部值）。\n\n将这些代入弱形式得到残差方程：\n第一个方程的残差：\n$$\n\\underbrace{\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa u_h(1)v(1)}_{\\text{依赖于未知解的项}} + \\underbrace{\\kappa u_D v(0)}_{\\text{来自给定边界数据的项}} = 0\n$$\n第二个方程的残差：\n$$\n\\underbrace{\\int_{0}^{1} r_h w' \\, dx + r_h(0)w(0)}_{\\text{依赖于未知解的项}} \\underbrace{- g_N w(1)}_{\\text{来自给定边界数据的项}} = 0\n$$\n来自给定边界数据的局部残差贡献是表达式中不依赖于未知解系数 $(a_0, a_1, b_0, b_1)$ 的部分。\n对于第一个方程，该贡献为 $B^{(r-\\kappa u')}_{v} = \\kappa u_D v(0)$。\n对于第二个方程，该贡献为 $B^{(-r')}_{w} = -g_N w(1)$。\n\n**计算特定检验函数的贡献**\n给定 $u_D=0$ 和 $g_N=1$。检验函数为 $\\phi_0(x)=1$ 和 $\\phi_1(x)=x$。\n\n1.  **项 $B^{(r-\\kappa u')}_{\\phi_0}$**：此处 $v = \\phi_0(x)=1$。\n    $B^{(r-\\kappa u')}_{\\phi_0} = \\kappa u_D \\phi_0(0) = \\kappa \\cdot 0 \\cdot 1 = 0$。\n\n2.  **项 $B^{(r-\\kappa u')}_{\\phi_1}$**：此处 $v = \\phi_1(x)=x$。\n    $B^{(r-\\kappa u')}_{\\phi_1} = \\kappa u_D \\phi_1(0) = \\kappa \\cdot 0 \\cdot 0 = 0$。\n\n3.  **项 $B^{(-r')}_{\\phi_0}$**：此处 $w = \\phi_0(x)=1$。\n    $B^{(-r')}_{\\phi_0} = -g_N \\phi_0(1) = -1 \\cdot 1 = -1$。\n\n4.  **项 $B^{(-r')}_{\\phi_1}$**：此处 $w = \\phi_1(x)=x$。\n    $B^{(-r')}_{\\phi_1} = -g_N \\phi_1(1) = -1 \\cdot 1 = -1$。\n\n**向量的最终组合**\n问题要求按指定顺序排列这四个贡献的行向量：\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]\n$$\n代入计算出的值，我们得到最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  -1  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个好的数值方法不仅应该准确，还应该保留模型的基本物理性质，例如非负性。本练习探讨了一种情景，其中一个朴素的LDG离散化可能导致非物理的负值，从而展示了罚参数 $\\tau$ 在确保解的正性方面的关键作用。您将确定维持这一基本物理约束所需的最小罚参数。",
            "id": "3396371",
            "problem": "考虑定义在区间 $[0,1]$ 上的一维稳态扩散问题，其边值问题为\n$$\n- u''(x) = 1 \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\n对于这个具有非负源项和齐次狄利克雷边界条件的二阶线性椭圆问题，一个基本事实是其精确解在 $[0,1]$ 上是非负的。特别地，通过两次积分可以得到经典解 $u(x) = \\frac{1}{2}x(1-x)$，该解对于所有 $x \\in [0,1]$ 满足 $u(x) \\ge 0$。\n\n现在，使用局部间断伽辽金（Local Discontinuous Galerkin, LDG）方法对该问题进行离散化，其中原始变量 $u$ 和辅助变量 $p = u_x$ 的多项式空间均为分片常数。使用网格 $\\{[0,h_1],[h_1,1]\\}$，其中 $h_1 = \\frac{1}{3}$ 且 $h_2 = \\frac{2}{3}$。在每个单元 $K_i$ 上，分别用常数 $U_i$ 和 $P_i$ 来近似 $u$ 和 $p$。\n\n从混合一阶系统出发\n$$\np - u_x = 0, \\qquad -p_x = 1,\n$$\n以及在每个单元上通过分部积分得到的标准积分恒等式，通过如下定义的 LDG 数值通量来施加单元间的耦合。在左边界 $x=0$ 处，弱形式施加齐次狄利克雷边界条件：\n$$\nu^{*}(0) = 0, \\qquad p^{*}(0) = p^{-}(0) - \\tau \\left(u^{-}(0) - 0\\right).\n$$\n在内部界面 $x = h_1$ 处，选择交替通量：\n$$\nu^{*}(h_1) = u^{-}(h_1), \\qquad p^{*}(h_1) = p^{+}(h_1) - \\tau\\left(u^{+}(h_1) - u^{-}(h_1)\\right).\n$$\n在右边界 $x=1$ 处，弱形式施加齐次狄利克雷边界条件：\n$$\nu^{*}(1) = 0, \\qquad p^{*}(1) = p^{+}(1) + \\tau \\left(u^{+}(1) - 0\\right).\n$$\n这里，$u^{-}$ 和 $p^{-}$ 表示来自界面左侧单元的内部迹，而 $u^{+}$ 和 $p^{+}$ 表示来自界面右侧单元的内部迹；$\\tau > 0$ 是一个罚参数，对于此网格，在所有面上取相同的值。\n\n在每个单元上仅使用分片常数测试函数，推导 $U_1$, $U_2$, $P_1$, 和 $P_2$ 的 LDG 离散方程，消去 $P_1$ 和 $P_2$，得到关于 $U_1$ 和 $U_2$ 的 $2 \\times 2$ 线性系统。然后，确定罚参数 $\\tau$ 的最小值，使得 LDG 离散解是非负的，即两个单元常数都满足 $U_1 \\ge 0$ 和 $U_2 \\ge 0$。将最终的 $\\tau_{\\min}$ 表示为精确的分数形式。不需要四舍五入。最终答案必须是单个数字。",
            "solution": "用户要求我解决一个涉及一维扩散方程的局部间断伽辽金（LDG）方法的问题。\n\n### 问题验证\n\n首先，我必须验证问题陈述。\n\n**步骤 1：提取已知条件**\n\n- **偏微分方程组：**\n  - $p - u_x = 0$\n  - $-p_x = 1$\n- **定义域：** $x \\in [0,1]$\n- **边界条件（BCs）：** $u(0) = 0$, $u(1) = 0$\n- **离散化：**\n  - 网格：两个单元，$K_1 = [0, h_1]$ 和 $K_2 = [h_1, 1]$，其中 $h_1 = \\frac{1}{3}$。这意味着 $K_1$ 的网格尺寸为 $h_1 = \\frac{1}{3}$，$K_2$ 的网格尺寸为 $h_2 = 1 - \\frac{1}{3} = \\frac{2}{3}$。\n  - 多项式空间：$u$ 和 $p$ 均为分片常数。在 $K_i$ 上，近似值为 $U_i$ 和 $P_i$。\n- **数值通量：**\n  - 在 $x=0$ 处：$u^{*}(0) = 0$, $p^{*}(0) = p^{-}(0) - \\tau (u^{-}(0) - 0)$。\n  - 在 $x=h_1$ 处：$u^{*}(h_1) = u^{-}(h_1)$, $p^{*}(h_1) = p^{+}(h_1) - \\tau(u^{+}(h_1) - u^{-}(h_1))$。\n  - 在 $x=1$ 处：$u^{*}(1) = 0$, $p^{*}(1) = p^{+}(1) + \\tau (u^{+}(1) - 0)$。\n- **罚参数：** $\\tau > 0$，在所有面上为常数。\n- **任务：** 推导关于 $U_1, U_2$ 的 $2 \\times 2$ 系统，并找到 $\\tau$ 的最小值 $\\tau_{\\min}$，使得 $U_1 \\ge 0$ 和 $U_2 \\ge 0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题是将 LDG 方法应用于经典扩散边值问题的标准应用。LDG 方法和其基础的偏微分方程在数值分析和应用数学领域是公认的。\n- **适定性：** 该问题明确了推导唯一离散系统所需的所有组成部分（偏微分方程、定义域、边界条件、网格、基函数、数值通量）。问题要求从该系统中推导出一个特定值 $\\tau_{\\min}$。\n- **客观性：** 该问题以精确、形式化的数学语言陈述。\n- **一致性与完备性：** 设置是完整的。然而，边界上迹的记法，例如 $u^{-}(0)$ 和 $u^{+}(1)$，是非标准的。通常，在 $x=0$ 处，只有来自右侧的迹 $u(0^{+})$；在 $x=1$ 处，只有来自左侧的迹 $u(1^{-})$。一个合理的解释是，给定的记法指的是来自唯一相邻单元的迹。我将基于此解释继续进行：\n  - 在 $x=0$ 处，$u^{-}(0)$ 和 $p^{-}(0)$ 指的是来自 $K_1$ 的迹，因此 $u^{-}(0) \\equiv u(0^{+}) = U_1$ 且 $p^{-}(0) \\equiv p(0^{+}) = P_1$。\n  - 在 $x=1$ 处，$u^{+}(1)$ 和 $p^{+}(1)$ 指的是来自 $K_2$ 的迹，因此 $u^{+}(1) \\equiv u(1^{-}) = U_2$ 且 $p^{+}(1) \\equiv p(1^{-}) = P_2$。\n在此解释下，该问题是一致且可解的。\n\n**步骤 3：结论与行动**\n\n该问题被判定为 **有效**。我将继续进行详细求解。\n\n### 详细求解过程\n\n我们首先在每个单元 $K_i = [x_{i-1}, x_i]$ 上推导系统的弱形式。对于方程 $p - u_x = 0$，我们使用分片常数测试函数 $v_h$；对于方程 $-p_x = 1$，我们使用分片常数测试函数 $q_h$。\n\n对于第一个方程，我们乘以测试函数 $v_h$ 并在 $K_i$ 上积分：\n$$ \\int_{K_i} p_h v_h \\,dx - \\int_{K_i} (u_h)_x v_h \\,dx = 0 $$\n对第二项进行分部积分得到：\n$$ \\int_{K_i} p_h v_h \\,dx - \\left[ u_h v_h \\right]_{x_{i-1}}^{x_i} + \\int_{K_i} u_h (v_h)_x \\,dx = 0 $$\n由于 $v_h$ 在 $K_i$ 上是常数，其导数 $(v_h)_x$ 为零。用数值通量 $u^*$ 替换 $u_h$ 的边界值，我们得到：\n$$ \\int_{K_i} p_h v_h \\,dx - u^*(x_i) v_h(x_i^-) + u^*(x_{i-1}) v_h(x_{i-1}^+) = 0 $$\n\n对于第二个方程，我们乘以测试函数 $q_h$ 并在 $K_i$ 上积分：\n$$ -\\int_{K_i} (p_h)_x q_h \\,dx = \\int_{K_i} 1 \\cdot q_h \\,dx $$\n对左侧进行分部积分得到：\n$$ -\\left[ p_h q_h \\right]_{x_{i-1}}^{x_i} + \\int_{K_i} p_h (q_h)_x \\,dx = \\int_{K_i} q_h \\,dx $$\n由于 $q_h$ 在 $K_i$ 上是常数，$(q_h)_x = 0$。用通量 $p^*$ 替换 $p_h$ 的边界值：\n$$ -p^*(x_i) q_h(x_i^-) + p^*(x_{i-1}) q_h(x_{i-1}^+) = \\int_{K_i} q_h \\,dx $$\n\n现在我们将这些一般形式应用于我们的具体问题。近似解为 $u_h|_{K_1}=U_1$，$p_h|_{K_1}=P_1$，$u_h|_{K_2}=U_2$，$p_h|_{K_2}=P_2$。可以依次在每个单元上取测试函数为 $v_h=1$ 和 $q_h=1$。\n\n**在单元 $K_1 = [0, h_1] = [0, 1/3]$ 上：**\n单元长度为 $h_1 = 1/3$。离散方程为：\n1.  $P_1 h_1 - u^*(1/3) + u^*(0) = 0$\n2.  $-p^*(1/3) + p^*(0) = h_1$\n\n**在单元 $K_2 = [h_1, 1] = [1/3, 1]$ 上：**\n单元长度为 $h_2 = 2/3$。离散方程为：\n3.  $P_2 h_2 - u^*(1) + u^*(1/3) = 0$\n4.  $-p^*(1) + p^*(1/3) = h_2$\n\n接下来，我们代入给定的数值通量。\n- 在 $x=0$ 处：$u^*(0) = 0$。根据我们的解释，$p^*(0) = P_1 - \\tau(U_1 - 0) = P_1 - \\tau U_1$。\n- 在 $x=1/3$ 处：$u^-(1/3) = U_1$，$u^+(1/3) = U_2$，$p^+(1/3) = P_2$。因此，$u^*(1/3) = U_1$ 且 $p^*(1/3) = P_2 - \\tau(U_2 - U_1)$。\n- 在 $x=1$ 处：$u^*(1) = 0$。根据我们的解释，$p^*(1) = P_2 + \\tau(U_2 - 0) = P_2 + \\tau U_2$。\n\n将这些代入四个方程中：\n1.  $P_1(\\frac{1}{3}) - U_1 + 0 = 0 \\implies P_1 = 3 U_1$\n2.  $-(P_2 - \\tau(U_2 - U_1)) + (P_1 - \\tau U_1) = \\frac{1}{3} \\implies P_1 - P_2 - 2\\tau U_1 + \\tau U_2 = \\frac{1}{3}$\n3.  $P_2(\\frac{2}{3}) - 0 + U_1 = 0 \\implies P_2 = -\\frac{3}{2} U_1$\n4.  $-(P_2 + \\tau U_2) + (P_2 - \\tau(U_2 - U_1)) = \\frac{2}{3} \\implies \\tau U_1 - 2\\tau U_2 = \\frac{2}{3}$\n\n我们现在得到了一个关于四个未知数 $U_1, U_2, P_1, P_2$ 的四元线性方程组。我们可以消去 $P_1$ 和 $P_2$ 来找到关于 $U_1, U_2$ 的系统。\n将方程 (1) 和 (3) 代入方程 (2)：\n$$ (3 U_1) - \\left(-\\frac{3}{2} U_1\\right) - 2\\tau U_1 + \\tau U_2 = \\frac{1}{3} $$\n$$ \\left(3 + \\frac{3}{2} - 2\\tau\\right) U_1 + \\tau U_2 = \\frac{1}{3} $$\n$$ \\left(\\frac{9}{2} - 2\\tau\\right) U_1 + \\tau U_2 = \\frac{1}{3} $$\n这是我们关于变量 $U$ 的第一个方程。第二个方程是方程 (4)：\n$$ \\tau U_1 - 2\\tau U_2 = \\frac{2}{3} $$\n\n关于 $(U_1, U_2)$ 的 $2 \\times 2$ 线性系统是：\n$$ \\begin{pmatrix} \\frac{9}{2} - 2\\tau  \\tau \\\\ \\tau  -2\\tau \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix} $$\n\n我们求解这个系统以得到 $U_1$ 和 $U_2$。系数矩阵的行列式是：\n$$ D = \\left(\\frac{9}{2} - 2\\tau\\right)(-2\\tau) - (\\tau)(\\tau) = -9\\tau + 4\\tau^2 - \\tau^2 = 3\\tau^2 - 9\\tau = 3\\tau(\\tau - 3) $$\n使用克莱姆法则：\n$$ U_1 = \\frac{1}{D} \\det \\begin{pmatrix} \\frac{1}{3}  \\tau \\\\ \\frac{2}{3}  -2\\tau \\end{pmatrix} = \\frac{\\frac{1}{3}(-2\\tau) - \\tau(\\frac{2}{3})}{3\\tau(\\tau - 3)} = \\frac{-\\frac{2\\tau}{3} - \\frac{2\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{-\\frac{4\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{-4}{9(\\tau - 3)} = \\frac{4}{9(3 - \\tau)} $$\n$$ U_2 = \\frac{1}{D} \\det \\begin{pmatrix} \\frac{9}{2} - 2\\tau  \\frac{1}{3} \\\\ \\tau  \\frac{2}{3} \\end{pmatrix} = \\frac{(\\frac{9}{2} - 2\\tau)\\frac{2}{3} - \\tau(\\frac{1}{3})}{3\\tau(\\tau - 3)} = \\frac{3 - \\frac{4\\tau}{3} - \\frac{\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{3 - \\frac{5\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{\\frac{9-5\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{9 - 5\\tau}{9\\tau(\\tau - 3)} $$\n\n问题要求离散解是非负的，即 $U_1 \\ge 0$ 且 $U_2 \\ge 0$。\n条件 $U_1 \\ge 0$ 意味着：\n$$ \\frac{4}{9(3 - \\tau)} \\ge 0 $$\n由于分子 $4$ 是正数，分母必须是正数：$9(3 - \\tau) > 0$，这意味着 $3 - \\tau > 0$，所以 $\\tau  3$。\n\n条件 $U_2 \\ge 0$ 意味着：\n$$ \\frac{9 - 5\\tau}{9\\tau(\\tau - 3)} \\ge 0 $$\n由于已知 $\\tau > 0$，分母中的项 $9\\tau$ 是正数。该不等式等价于：\n$$ \\frac{9 - 5\\tau}{\\tau - 3} \\ge 0 $$\n这个不等式在两种情况下满足：\n1.  $9 - 5\\tau \\ge 0$ 且 $\\tau - 3 > 0$。这得到 $\\tau \\le \\frac{9}{5}$ 且 $\\tau > 3$，这是一个矛盾。\n2.  $9 - 5\\tau \\le 0$ 且 $\\tau - 3  0$。这得到 $\\tau \\ge \\frac{9}{5}$ 且 $\\tau  3$。合并后的条件是 $\\frac{9}{5} \\le \\tau  3$。\n\n为了使 $U_1$ 和 $U_2$ 均为非负，必须同时满足关于 $\\tau$ 的两个条件。我们必须找到集合 $(\\tau  3)$ 和 $[\\frac{9}{5}, 3)$ 的交集。交集是区间 $[\\frac{9}{5}, 3)$。\n\n问题要求保证非负性的 $\\tau$ 的最小值。这是区间 $[\\frac{9}{5}, 3)$ 中的最小值，即 $\\frac{9}{5}$。\n因此，最小罚参数为 $\\tau_{\\min} = \\frac{9}{5}$。",
            "answer": "$$\\boxed{\\frac{9}{5}}$$"
        },
        {
            "introduction": "本高级练习超越了基本实现，深入探讨了LDG方法的分析。您将研究伴随一致性的概念，并了解某些通量选择如何破坏它，这是误差分析的关键洞见。通过应用对偶加权残差（DWR）方法，您将推导出目标量误差的精确表达式，为理解和预测数值误差提供了强大的工具。",
            "id": "3396365",
            "problem": "考虑区间 $\\Omega=(0,1)$ 上的标量扩散边值问题：求解 $u:\\Omega \\to \\mathbb{R}$ 使得在 $\\Omega$ 内有 $-u''=f$，并满足齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。引入一阶系统，其中辅助变量为 $q=u'$，从而有 $-q'=f$。设 $f(x)=\\pi^{2}\\sin(\\pi x)$，则其精确解为 $u(x)=\\sin(\\pi x)$。\n\n在单个单元 $K=(0,1)$ 上采用局部间断伽辽金 (LDG) 离散，对 $u$ 和 $q$ 均使用多项式次数 $p=1$，即近似为 $u_{h}(x)=a_{0}+a_{1}x$ 和 $q_{h}(x)=b_{0}+b_{1}x$。对于两个物理边界 $x=0$ 和 $x=1$ 处的数值迹，选择：\n- 在 $x=0$ 和 $x=1$ 处均施加狄利克雷条件的 $u$-迹 $\\widehat{u}=0$，以及\n- 在两个边界上通量均为 $\\widehat{q}=q^{-}$，即 $\\widehat{q}(0)=q_{h}(0)$ 和 $\\widehat{q}(1)=q_{h}(1)$，不含任何罚项或提升项。\n\n任务：\n1. 从一阶系统的弱形式出发，写出用单元上的常数和线性函数进行测试的 LDG 方程，并用 $f$ 表示 $q_{h}(x)$ 的系数。然后，仅使用 LDG 方程，确定离散系统所蕴含的目标泛函 $J(u_{h})=\\int_{0}^{1}u_{h}(x)\\,dx$ 的值。\n2. 通过比较连续弱形式和离散边界项，论证在狄利克雷边界上选择边界迹 $\\widehat{q}=q^{-}$ 破坏了相对于与 $-u''$ 相关的连续对称双线性形式的伴随一致性。\n3. 设目标泛函为 $J(u)=\\int_{0}^{1}u(x)\\,dx$。使用伴随问题 $-z''=1$（在 $(0,1)$ 内，且 $z(0)=0, z(1)=0$）的精确对偶解 $z$ 为此目标推导对偶加权残差恒等式。对于上述数据，以闭合形式计算由此产生的对偶加权残差误差 $E=J(u)-J(u_{h})$。将您的最终答案表示为单个精确的解析表达式。不要近似任何常数。不需要单位。\n\n您的最终答案必须是单个解析表达式。如果您选择数值近似，请四舍五入到四位有效数字；否则，请提供精确的符号表达式。",
            "solution": "用户提出了一个关于一维扩散方程的局部间断伽辽金 (LDG) 方法的三部分问题。在验证问题陈述后，我将系统地处理每个部分。\n\n### 问题验证\n\n我首先根据要求的协议验证问题陈述。\n\n**步骤 1：提取已知条件**\n- **控制方程：** $-u''=f$ 在 $\\Omega=(0,1)$上。\n- **边界条件：** 齐次狄利克雷，$u(0)=0$ 和 $u(1)=0$。\n- **一阶系统：** $q=u'$ 和 $-q'=f$。\n- **源项：** $f(x)=\\pi^{2}\\sin(\\pi x)$。\n- **精确解：** $u(x)=\\sin(\\pi x)$，这意味着 $q(x)=\\pi\\cos(\\pi x)$。\n- **离散化：** 在单个单元 $K=(0,1)$ 上使用 LDG 方法，试探/测试空间为次数 $p=1$ 的多项式。\n- **近似：** $u_{h}(x)=a_{0}+a_{1}x$ 和 $q_{h}(x)=b_{0}+b_{1}x$。\n- **数值迹：**\n    - 在 $x=0$ 和 $x=1$ 处 $\\widehat{u}=0$。\n    - 在 $x=0$ 和 $x=1$ 处 $\\widehat{q}=q^{-}$，即 $\\widehat{q}(0)=q_{h}(0)$ 和 $\\widehat{q}(1)=q_{h}(1)$。\n- **任务 1：** 求解 $q_h(x)$ 的系数，然后使用 LDG 方程计算 $J(u_{h})=\\int_{0}^{1}u_{h}(x)\\,dx$。\n- **任务 2：** 论证选择 $\\widehat{q}=q^{-}$ 破坏了伴随一致性。\n- **任务 3：** 对于目标泛函 $J(u)=\\int_{0}^{1}u(x)\\,dx$，使用伴随问题 $-z''=1$ 且 $z(0)=0, z(1)=0$ 推导对偶加权残差 (DWR) 恒等式。计算误差 $E=J(u)-J(u_h)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上和数学上是合理的。它描述了一个标准的一维泊松边值问题，这是数学物理中的一个基本模型。LDG 方法是解决此类问题的一种成熟的数值技术。提供的源项 $f(x)$ 与精确解 $u(x)$ 和控制方程是一致的。问题的所有组成部分（方程、边界条件、离散化选择、数值通量）都得到了清晰客观的定义。这些任务是具体的、可形式化的，并涉及间断伽辽金方法分析中的核心概念，即求解离散系统、理解伴随一致性和应用 DWR 误差估计。该问题是适定的和自洽的。\n\n**步骤 3：结论和行动**\n问题有效。我将继续进行完整解答。\n\n### 解答\n\n**第 1 部分：LDG 系统和目标泛函求值**\n\n在单元 $K=(0,1)$ 上，一阶系统的弱形式为：求解 $(u_h, q_h) \\in (P^1(K))^2$，使得对于所有测试函数 $(v_h, w_h) \\in (P^1(K))^2$：\n$$\n\\int_0^1 q_h v_h \\,dx = \\int_0^1 u'_h v_h \\,dx = [u_h v_h]_0^1 - \\int_0^1 u_h v_h' \\,dx\n$$\n$$\n\\int_0^1 (-q'_h) w_h \\,dx = \\int_0^1 f w_h \\,dx \\implies [q_h w_h]_0^1 - \\int_0^1 q_h w_h' \\,dx = -\\int_0^1 f w_h \\,dx\n$$\nLDG 格式是通过将边界项中的迹 $u$ 和 $q$ 替换为数值迹 $\\widehat{u}$ 和 $\\widehat{q}$ 得到的：\n1.  $\\int_0^1 q_h v_h \\,dx + \\int_0^1 u_h v_h' \\,dx - [\\widehat{u} v_h]_0^1 = 0$\n2.  $\\int_0^1 q_h w_h' \\,dx - [\\widehat{q} w_h]_0^1 = \\int_0^1 f w_h \\,dx$\n\n我们对测试函数 $v_h$ 和 $w_h$ 使用基函数 $\\{1, x\\}$。我们有 $u_h(x)=a_0+a_1x$ 和 $q_h(x)=b_0+b_1x$。数值迹为 $\\widehat{u}(0)=0, \\widehat{u}(1)=0$ 和 $\\widehat{q}(0)=q_h(0)=b_0, \\widehat{q}(1)=q_h(1)=b_0+b_1$。\n\n从第二个 LDG 方程：\n- 用 $w_h=1$ ($w_h'=0$) 测试：\n$$\n\\int_0^1 q_h(0) \\,dx - [\\widehat{q}(1) \\cdot 1 - \\widehat{q}(0) \\cdot 1] = \\int_0^1 f(x) \\cdot 1 \\,dx\n$$\n$$\n0 - ((b_0+b_1) - b_0) = \\int_0^1 \\pi^2 \\sin(\\pi x) \\,dx\n$$\n$$\n-b_1 = \\pi^2 \\left[-\\frac{1}{\\pi}\\cos(\\pi x)\\right]_0^1 = -\\pi(\\cos(\\pi)-\\cos(0)) = -\\pi(-1-1) = 2\\pi\n$$\n因此，$b_1 = -2\\pi$。\n\n- 用 $w_h=x$ ($w_h'=1$) 测试：\n$$\n\\int_0^1 q_h(x) \\cdot 1 \\,dx - [\\widehat{q}(1) \\cdot 1 - \\widehat{q}(0) \\cdot 0] = \\int_0^1 f(x) x \\,dx\n$$\n$$\n\\int_0^1 (b_0+b_1x) \\,dx - (b_0+b_1) = \\int_0^1 x \\pi^2 \\sin(\\pi x) \\,dx\n$$\n$$\n(b_0 + \\frac{b_1}{2}) - (b_0+b_1) = -\\frac{b_1}{2} = \\pi^2 \\int_0^1 x \\sin(\\pi x) \\,dx\n$$\n积分为 $\\int_0^1 x \\sin(\\pi x) \\,dx = \\left[-\\frac{x}{\\pi}\\cos(\\pi x) + \\frac{1}{\\pi^2}\\sin(\\pi x)\\right]_0^1 = \\frac{1}{\\pi}$。\n所以，$-\\frac{b_1}{2} = \\pi^2(\\frac{1}{\\pi}) = \\pi$，这也得到 $b_1 = -2\\pi$。关于 $b_1$ 的方程是一致的。\n\n现在我们使用第一个 LDG 方程来找到 $b_0$ 的关系式。\n- 用 $v_h=1$ ($v_h'=0$) 测试：\n$$\n\\int_0^1 q_h(x) \\cdot 1 \\,dx + \\int_0^1 u_h(x) \\cdot 0 \\,dx - [\\widehat{u}(1)\\cdot 1 - \\widehat{u}(0)\\cdot 1] = 0\n$$\n$$\n\\int_0^1 (b_0+b_1x) \\,dx - [0-0] = 0 \\implies b_0 + \\frac{b_1}{2} = 0\n$$\n代入 $b_1=-2\\pi$，我们得到 $b_0 - \\pi = 0$，所以 $b_0 = \\pi$。\n$q_h(x)$ 的系数是 $b_0=\\pi$ 和 $b_1=-2\\pi$，所以 $q_h(x) = \\pi - 2\\pi x$。\n\n为了求目标泛函 $J(u_h) = \\int_0^1 u_h(x)\\,dx$，我们使用第一个 LDG 方程并令 $v_h=x$ ($v_h'=1$)：\n$$\n\\int_0^1 q_h(x) x \\,dx + \\int_0^1 u_h(x) \\cdot 1 \\,dx - [\\widehat{u}(1)\\cdot 1 - \\widehat{u}(0)\\cdot 0] = 0\n$$\n$$\n\\int_0^1 (b_0+b_1x)x \\,dx + J(u_h) - 0 = 0\n$$\n$$\nJ(u_h) = - \\int_0^1 (b_0x+b_1x^2) \\,dx = - \\left[ b_0\\frac{x^2}{2} + b_1\\frac{x^3}{3} \\right]_0^1 = -(\\frac{b_0}{2} + \\frac{b_1}{3})\n$$\n代入 $b_0$ 和 $b_1$ 的值：\n$$\nJ(u_h) = -(\\frac{\\pi}{2} + \\frac{-2\\pi}{3}) = -(\\frac{3\\pi-4\\pi}{6}) = -(-\\frac{\\pi}{6}) = \\frac{\\pi}{6}.\n$$\n\n**第 2 部分：伴随不一致性**\n\n伴随一致性关系到离散格式是否保持了连续算子的自伴随性。带有齐次狄利克雷边界条件的连续算子 $-d^2/dx^2$ 是自伴随的。其弱形式基于对称双线性形式 $B(u,v)=\\int_0^1 u'v' \\,dx$。\n对称性 $B(u,v)=B(v,u)$ 是显而易见的。\n\n在 LDG 格式中，项 $\\int_K u'v' \\,dx$ 被有效地替换为一个涉及辅助变量 $q \\approx u'$ 的方程组。单元之间（或边界上）的信息传递由数值通量处理。为使格式是自伴随的，分部积分产生的总边界项必须关于交换试探函数 $(u_h, q_h)$ 和测试函数 $(v_h, w_h)$ 是对称的。\n\nLDG 格式中的边界项由数值迹 $[\\widehat{u} v_h]$ 和 $[\\widehat{q} w_h]$ 驱动。在狄利克雷边界上，辅助变量通量的选择是 $\\widehat{q}=q^-$。这意味着通量*仅*由单元内部的值确定，忽略了来自外部的任何信息（在伴随问题中，这些信息会与测试函数相关）。这是一种单边或迎风的通量选择。\n\n众所周知，这种单边通量会破坏底层双线性形式的对称性。连续形式 $B(u,v)$ 的对称性源于微分和分部积分是中性操作这一事实。通过选择一个有向通量 $\\widehat{q}=q^-$，我们为离散系统引入了一个特定的信息流方向。伴随算子将需要相反方向的信息流（即，伴随通量为 $\\widehat{p}=p^+$）。由于原始通量和伴随通量的选择彼此不对称，因此得到的离散算子不是自伴随的。因此，该格式相对于原始的自伴随连续算子而言不是伴随一致的。\n\n**第 3 部分：对偶加权残差误差求值**\n\n目标是计算泛函中的误差 $E = J(u)-J(u_h)$。泛函是 $J(w) = \\int_0^1 w(x)\\,dx$。该泛函的对偶或伴随问题是求解 $z$，使得 $L^*z = g_J$，其中 $L^*$ 是伴随算子，$g_J$ 是 $J$ 的 Riesz 表示。对于算子 $-d^2/dx^2$，$L^*=L$，且 $J(w)=\\int w \\cdot 1 \\,dx$。所以对偶问题是 $-z''=1$ 在 $\\Omega=(0,1)$ 内，带有齐次边界条件 $z(0)=0, z(1)=0$。\n\nDWR 恒等式将泛函中的误差与由对偶解加权的控制方程的残差联系起来。推导精确误差表示的一种直接方法是使用对偶问题：\n$$\nE = J(u) - J(u_h) = \\int_0^1 u(x) \\cdot 1 \\,dx - J(u_h)\n$$\n使用对偶问题方程 $1 = -z''$：\n$$\nE = \\int_0^1 u(x)(-z''(x)) \\,dx - J(u_h)\n$$\n我们进行两次分部积分。由于 $u$ 和 $z$ 上的齐次边界条件，边界项消失。\n$$\n\\int_0^1 u(-z'') \\,dx = \\left[-u z'\\right]_0^1 + \\int_0^1 u' z' \\,dx = \\int_0^1 u' z' \\,dx\n$$\n$$\n\\int_0^1 u' z' \\,dx = \\left[u' z\\right]_0^1 - \\int_0^1 u'' z \\,dx = \\int_0^1 (-u'')z \\,dx\n$$\n由于 $-u'' = f$，我们得到恒等式：\n$$\nE = \\int_0^1 f(x) z(x) \\,dx - J(u_h)\n$$\n这个恒等式将泛函 $J(u_h)$ 中的误差表示为应用于源项 $f$ 的目标泛函（由对偶解 $z$ 加权）与泛函 $J(u_h)$ 的计算值之间的差。\n\n我们现在计算这个表达式。\n从第 1 部分，我们有 $J(u_h) = \\frac{\\pi}{6}$。\n我们需要求解 $z(x)$，然后计算积分。\n对偶问题是 $-z''=1$, $z(0)=0, z(1)=0$。\n积分一次：$z'(x) = -x+C_1$。\n再次积分：$z(x) = -\\frac{x^2}{2} + C_1 x + C_2$。\n应用边界条件：\n$z(0)=0 \\implies C_2 = 0$。\n$z(1)=0 \\implies -\\frac{1}{2} + C_1 = 0 \\implies C_1 = \\frac{1}{2}$。\n所以，精确对偶解是 $z(x) = \\frac{1}{2}(x-x^2)$。\n\n现在，我们计算积分项 $\\int_0^1 f(x) z(x) \\,dx$：\n$$\n\\int_0^1 \\pi^2 \\sin(\\pi x) \\frac{1}{2}(x-x^2) \\,dx = \\frac{\\pi^2}{2} \\left( \\int_0^1 x \\sin(\\pi x) \\,dx - \\int_0^1 x^2 \\sin(\\pi x) \\,dx \\right)\n$$\n第一个积分已在第 1 部分计算：$\\int_0^1 x \\sin(\\pi x) \\,dx = \\frac{1}{\\pi}$。\n第二个积分通过两次分部积分计算：\n$$\n\\int x^2 \\sin(\\pi x) \\,dx = x^2(-\\frac{\\cos(\\pi x)}{\\pi}) - \\int 2x(-\\frac{\\cos(\\pi x)}{\\pi}) \\,dx\n$$\n$$\n= -\\frac{x^2}{\\pi}\\cos(\\pi x) + \\frac{2}{\\pi} \\left( x\\frac{\\sin(\\pi x)}{\\pi} - \\int \\frac{\\sin(\\pi x)}{\\pi} \\,dx \\right)\n$$\n$$\n= -\\frac{x^2}{\\pi}\\cos(\\pi x) + \\frac{2x}{\\pi^2}\\sin(\\pi x) + \\frac{2}{\\pi^3}\\cos(\\pi x)\n$$\n从 $0$ 到 $1$ 求值：\n$$\n\\left[ \\dots \\right]_0^1 = \\left( -\\frac{1}{\\pi}\\cos(\\pi) + 0 + \\frac{2}{\\pi^3}\\cos(\\pi) \\right) - \\left( 0 + 0 + \\frac{2}{\\pi^3}\\cos(0) \\right)\n$$\n$$\n= \\left( \\frac{1}{\\pi} - \\frac{2}{\\pi^3} \\right) - \\frac{2}{\\pi^3} = \\frac{1}{\\pi} - \\frac{4}{\\pi^3}\n$$\n代回到主表达式中：\n$$\n\\int_0^1 f(x) z(x) \\,dx = \\frac{\\pi^2}{2} \\left( \\frac{1}{\\pi} - \\left(\\frac{1}{\\pi} - \\frac{4}{\\pi^3}\\right) \\right) = \\frac{\\pi^2}{2} \\left( \\frac{4}{\\pi^3} \\right) = \\frac{2}{\\pi}\n$$\n注意，这正是泛函 $J(u) = \\int_0^1 \\sin(\\pi x) \\,dx = [-\\frac{1}{\\pi}\\cos(\\pi x)]_0^1 = \\frac{2}{\\pi}$ 的精确值。\n\n最后，误差 $E$ 是：\n$$\nE = \\int_0^1 f(x) z(x) \\,dx - J(u_h) = \\frac{2}{\\pi} - \\frac{\\pi}{6}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{\\pi} - \\frac{\\pi}{6}}\n$$"
        }
    ]
}