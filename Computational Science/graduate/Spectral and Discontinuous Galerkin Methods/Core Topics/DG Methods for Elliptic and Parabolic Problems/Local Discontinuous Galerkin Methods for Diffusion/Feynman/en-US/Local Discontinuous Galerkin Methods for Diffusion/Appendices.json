{
    "hands_on_practices": [
        {
            "introduction": "Mastering the Local Discontinuous Galerkin (LDG) method begins with understanding its local structure on a single element. This first practice exercise focuses on this foundational skill, demonstrating how to derive the weak form and incorporate numerical fluxes for mixed boundary conditions. By working through these steps, you will see precisely how prescribed boundary data contributes to the system's final algebraic equations .",
            "id": "3365011",
            "problem": "Consider the one-dimensional, steady, second-order diffusion model on the interval $[0,1]$ with constant positive diffusivity $\\kappa > 0$,\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) \\;=\\; f(x),\n$$\nsubject to the boundary conditions $u(0)=0$ and $\\kappa\\, u'(1)=1$, with zero source $f(x)\\equiv 0$. Introduce the auxiliary variable $r(x)=\\kappa\\, u'(x)$ so that the system becomes\n$$\nr - \\kappa\\, u' \\;=\\; 0, \\qquad -r' \\;=\\; 0.\n$$\nUsing the Local Discontinuous Galerkin (LDG) method, approximate $u$ and $r$ on the single element $E=[0,1]$ by piecewise polynomials of degree $p=1$:\n$$\nu_h(x) \\;=\\; a_0\\,\\phi_0(x) + a_1\\,\\phi_1(x), \\qquad r_h(x) \\;=\\; b_0\\,\\phi_0(x) + b_1\\,\\phi_1(x),\n$$\nwhere the local basis is chosen as $\\phi_0(x)=1$ and $\\phi_1(x)=x$ on $E$. Let $v,w\\in\\mathrm{span}\\{\\phi_0,\\phi_1\\}$ be test functions for the first and second equations, respectively. Derive the elementwise LDG weak forms by starting from the first-order system and applying integration by parts where appropriate, replacing boundary traces by numerical fluxes. For numerical fluxes, adopt the standard LDG alternating choice at the single element boundaries:\n- At $x=0$ (Dirichlet), set $\\widehat{u}(0)=u_D=0$ and use the interior value for $\\widehat{r}(0)=r_h(0)$.\n- At $x=1$ (Neumann), set $\\widehat{r}(1)=g_N=1$ and use the interior value for $\\widehat{u}(1)=u_h(1)$.\n\nWrite the resulting elementwise LDG system and then compute the boundary contributions explicitly for $p=1$ polynomials. Specifically, extract the boundary-only contribution to the local residual arising solely from the prescribed boundary data $(u_D,g_N)=(0,1)$, evaluated with the two test functions $\\phi_0$ and $\\phi_1$ in each equation. Order the four boundary contributions as the row vector\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big],\n$$\nwhere $B^{(r-\\kappa u')}_{\\phi_j}$ and $B^{(-r')}_{\\phi_j}$ denote the boundary term in the weak form of the first and second equations, respectively, coming only from the imposed boundary data. Provide this row vector as your final answer. No rounding is required. Express the final answer as a closed-form analytic expression.",
            "solution": "The user wants me to solve a problem based on the Local Discontinuous Galerkin (LDG) method for a one-dimensional diffusion equation.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **Governing Equation**: $- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) = f(x)$ on the interval $[0,1]$.\n-   **Parameters**: Diffusivity $\\kappa > 0$ is a constant. Source term $f(x) \\equiv 0$.\n-   **Boundary Conditions**: $u(0)=u_D=0$ and $\\kappa\\, u'(1)=g_N=1$.\n-   **First-Order System**: The auxiliary variable is $r(x)=\\kappa\\, u'(x)$. The system is:\n    $$\n    r - \\kappa\\, u' = 0\n    $$\n    $$\n    -r' = 0\n    $$\n-   **Discretization**: The domain is a single element $E=[0,1]$. The approximation space consists of polynomials of degree $p=1$.\n-   **Trial and Test Functions**:\n    -   Basis functions: $\\phi_0(x)=1$, $\\phi_1(x)=x$.\n    -   Trial functions: $u_h(x) = a_0\\phi_0(x) + a_1\\phi_1(x)$ and $r_h(x) = b_0\\phi_0(x) + b_1\\phi_1(x)$.\n    -   Test functions: $v,w \\in \\mathrm{span}\\{\\phi_0,\\phi_1\\}$.\n-   **Numerical Fluxes**: The alternating flux choice is specified:\n    -   At $x=0$: $\\widehat{u}(0)=u_D=0$; $\\widehat{r}(0)=r_h(0)$.\n    -   At $x=1$: $\\widehat{r}(1)=g_N=1$; $\\widehat{u}(1)=u_h(1)$.\n-   **Task**: Compute the four boundary contributions to the local residual, ordered as the row vector $\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]$, arising solely from the prescribed boundary data $(u_D,g_N)=(0,1)$.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientific Grounding**: The problem is a standard application of the well-established Local Discontinuous Galerkin (LDG) method to a fundamental second-order elliptic partial differential equation (the diffusion equation). All concepts are standard in numerical analysis and computational science. The problem is scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. It provides a complete set of instructions, including the governing equations, boundary conditions, discretization details (element, basis functions), and the specific choice of numerical fluxes. The task is a specific, unambiguous calculation based on these inputs.\n-   **Objectivity**: The problem statement is formulated in precise mathematical terms, free from any subjective or ambiguous language.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. I will proceed with the solution.\n\n### Step 2: Solution Derivation\n\nThe process begins by deriving the weak formulation for the first-order system on the element $E=[0,1]$.\n\n**Derivation of the Weak Form for the First Equation**\nThe first equation is $r - \\kappa u' = 0$. We multiply by a test function $v$ and integrate over the element $E$:\n$$\n\\int_{E} (r_h - \\kappa u'_h) v \\, dx = 0\n$$\n$$\n\\int_{0}^{1} r_h v \\, dx - \\kappa \\int_{0}^{1} u'_h v \\, dx = 0\n$$\nWe apply integration by parts to the second term:\n$$\n\\int_{0}^{1} u'_h v \\, dx = [u_h v]_{x=0}^{x=1} - \\int_{0}^{1} u_h v' \\, dx = u_h(1)v(1) - u_h(0)v(0) - \\int_{0}^{1} u_h v' \\, dx\n$$\nSubstituting this back into the equation gives:\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa(u_h(1)v(1) - u_h(0)v(0)) = 0\n$$\nIn the Discontinuous Galerkin framework, the traces of the solution at the element boundary are replaced by numerical fluxes, denoted by a hat symbol. The weak form becomes:\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa \\widehat{u}(1)v(1) + \\kappa \\widehat{u}(0)v(0) = 0\n$$\n\n**Derivation of the Weak Form for the Second Equation**\nThe second equation is $-r' = 0$. We multiply by a test function $w$ and integrate over $E$:\n$$\n-\\int_{E} r'_h w \\, dx = 0\n$$\nApplying integration by parts:\n$$\n-[r_h w]_{x=0}^{x=1} + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n$$\n-(r_h(1)w(1) - r_h(0)w(0)) + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\nReplacing the boundary traces with numerical fluxes $\\widehat{r}(1)$ and $\\widehat{r}(0)$:\n$$\n\\int_{0}^{1} r_h w' \\, dx - \\widehat{r}(1)w(1) + \\widehat{r}(0)w(0) = 0\n$$\n\n**Defining the Local Residual and Identifying Boundary Contributions**\nThe problem asks for the contribution to the local residual arising solely from the prescribed boundary data. The local residual for each equation is the expression that must equal zero. We substitute the specific numerical fluxes given in the problem:\n-   At $x=0$: $\\widehat{u}(0)=u_D=0$, $\\widehat{r}(0)=r_h(0)$ (interior value).\n-   At $x=1$: $\\widehat{r}(1)=g_N=1$, $\\widehat{u}(1)=u_h(1)$ (interior value).\n\nSubstituting these into the weak forms gives the residual equations:\nResidual for the first equation:\n$$\n\\underbrace{\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa u_h(1)v(1)}_{\\text{terms depending on unknown solution}} + \\underbrace{\\kappa u_D v(0)}_{\\text{term from prescribed data}} = 0\n$$\nResidual for the second equation:\n$$\n\\underbrace{\\int_{0}^{1} r_h w' \\, dx + r_h(0)w(0)}_{\\text{terms depending on unknown solution}} \\underbrace{- g_N w(1)}_{\\text{term from prescribed data}} = 0\n$$\nThe contribution to the local residual from the prescribed boundary data is the part of the expression that does not depend on the unknown solution coefficients $(a_0, a_1, b_0, b_1)$.\nFrom the first equation, this contribution is $B^{(r-\\kappa u')}_{v} = \\kappa u_D v(0)$.\nFrom the second equation, this contribution is $B^{(-r')}_{w} = -g_N w(1)$.\n\n**Computing the Contributions for Specific Test Functions**\nWe are given $u_D=0$ and $g_N=1$. The test functions are $\\phi_0(x)=1$ and $\\phi_1(x)=x$.\n\n1.  **Term $B^{(r-\\kappa u')}_{\\phi_0}$**: Here $v = \\phi_0(x)=1$.\n    $B^{(r-\\kappa u')}_{\\phi_0} = \\kappa u_D \\phi_0(0) = \\kappa \\cdot 0 \\cdot 1 = 0$.\n\n2.  **Term $B^{(r-\\kappa u')}_{\\phi_1}$**: Here $v = \\phi_1(x)=x$.\n    $B^{(r-\\kappa u')}_{\\phi_1} = \\kappa u_D \\phi_1(0) = \\kappa \\cdot 0 \\cdot 0 = 0$.\n\n3.  **Term $B^{(-r')}_{\\phi_0}$**: Here $w = \\phi_0(x)=1$.\n    $B^{(-r')}_{\\phi_0} = -g_N \\phi_0(1) = -1 \\cdot 1 = -1$.\n\n4.  **Term $B^{(-r')}_{\\phi_1}$**: Here $w = \\phi_1(x)=x$.\n    $B^{(-r')}_{\\phi_1} = -g_N \\phi_1(1) = -1 \\cdot 1 = -1$.\n\n**Final Assembly of the Vector**\nThe problem requests the row vector of these four contributions in the specified order:\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]\n$$\nSubstituting the computed values, we obtain the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & -1 & -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "An important consideration in numerical analysis is whether the discrete solution inherits the essential physical properties of the continuous PDE. This exercise explores the discrete maximum principle, demonstrating through a carefully constructed hypothetical scenario how a standard LDG approximation can yield non-physical results for a problem with a known positive solution. You will investigate the crucial role of the penalty parameter $\\tau$ and determine the minimum value required to enforce this important property, a concept central to the method's stability and robustness .",
            "id": "3396371",
            "problem": "Consider the one-dimensional steady diffusion problem on the domain $[0,1]$ given by the boundary value problem\n$$\n- u''(x) = 1 \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\nA fundamental fact for this second-order linear elliptic problem with nonnegative source and homogeneous Dirichlet boundary conditions is that the exact solution is nonnegative on $[0,1]$. In particular, integrating twice yields the classical solution $u(x) = \\frac{1}{2}x(1-x)$, which satisfies $u(x) \\ge 0$ for all $x \\in [0,1]$.\n\nNow discretize this problem using the Local Discontinuous Galerkin (LDG) method with piecewise constant polynomial spaces for both the primal variable $u$ and the auxiliary variable $p = u_x$. Use the mesh $\\{[0,h_1],[h_1,1]\\}$ with $h_1 = \\frac{1}{3}$ and $h_2 = \\frac{2}{3}$. On each element $K_i$, approximate $u$ and $p$ by constants $U_i$ and $P_i$, respectively.\n\nStarting from the mixed first-order system\n$$\np - u_x = 0, \\qquad -p_x = 1,\n$$\nand the standard integral identities obtained via integration by parts on each element, enforce interelement coupling through LDG numerical fluxes defined as follows. At the left boundary $x=0$, impose the homogeneous Dirichlet boundary condition weakly with\n$$\nu^{*}(0) = 0, \\qquad p^{*}(0) = p^{-}(0) - \\tau \\left(u^{-}(0) - 0\\right).\n$$\nAt the interior interface $x = h_1$, choose alternating fluxes\n$$\nu^{*}(h_1) = u^{-}(h_1), \\qquad p^{*}(h_1) = p^{+}(h_1) - \\tau\\left(u^{+}(h_1) - u^{-}(h_1)\\right).\n$$\nAt the right boundary $x=1$, enforce the homogeneous Dirichlet condition weakly with\n$$\nu^{*}(1) = 0, \\qquad p^{*}(1) = p^{+}(1) + \\tau \\left(u^{+}(1) - 0\\right).\n$$\nHere, $u^{-}$ and $p^{-}$ denote interior traces from the element on the left of an interface, and $u^{+}$ and $p^{+}$ denote interior traces from the element on the right of an interface; $\\tau > 0$ is a penalty parameter, taken to be the same at all faces for this mesh.\n\nUsing only piecewise constant test functions on each element, derive the LDG discrete equations for $U_1$, $U_2$, $P_1$, and $P_2$, eliminate $P_1$ and $P_2$, and obtain a $2 \\times 2$ linear system for $U_1$ and $U_2$. Then, determine the minimal value of the penalty parameter $\\tau$ such that the LDG discrete solution is nonnegative in the sense that both elementwise constants satisfy $U_1 \\ge 0$ and $U_2 \\ge 0$. Express the final $\\tau_{\\min}$ in exact fractional form. No rounding is required. The final answer must be a single number.",
            "solution": "The user wants me to solve a problem that involves the Local Discontinuous Galerkin (LDG) method for a 1D diffusion equation.\n\n### Problem Validation\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n\n- **PDE system:**\n  - $p - u_x = 0$\n  - $-p_x = 1$\n- **Domain:** $x \\in [0,1]$\n- **Boundary Conditions (BCs):** $u(0) = 0$, $u(1) = 0$\n- **Discretization:**\n  - Mesh: Two elements, $K_1 = [0, h_1]$ and $K_2 = [h_1, 1]$, with $h_1 = \\frac{1}{3}$. This implies the mesh size of $K_1$ is $h_1 = \\frac{1}{3}$ and of $K_2$ is $h_2 = 1 - \\frac{1}{3} = \\frac{2}{3}$.\n  - Polynomial Space: Piecewise constants for both $u$ and $p$. On $K_i$, the approximations are $U_i$ and $P_i$.\n- **Numerical Fluxes:**\n  - At $x=0$: $u^{*}(0) = 0$, $p^{*}(0) = p^{-}(0) - \\tau (u^{-}(0) - 0)$.\n  - At $x=h_1$: $u^{*}(h_1) = u^{-}(h_1)$, $p^{*}(h_1) = p^{+}(h_1) - \\tau(u^{+}(h_1) - u^{-}(h_1))$.\n  - At $x=1$: $u^{*}(1) = 0$, $p^{*}(1) = p^{+}(1) + \\tau (u^{+}(1) - 0)$.\n- **Penalty Parameter:** $\\tau > 0$, constant on all faces.\n- **Task:** Derive the $2 \\times 2$ system for $U_1, U_2$ and find the minimal value of $\\tau$, denoted $\\tau_{\\min}$, such that $U_1 \\ge 0$ and $U_2 \\ge 0$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientific Grounding:** The problem is a standard application of the LDG method to a classic diffusion boundary value problem. The LDG method and the underlying PDE are well-established in numerical analysis and applied mathematics.\n- **Well-Posedness:** The problem specifies all necessary components (PDE, domain, BCs, mesh, basis functions, numerical fluxes) to derive a unique discrete system. The question asks for a specific value, $\\tau_{\\min}$, derivable from this system.\n- **Objectivity:** The problem is stated in precise, formal mathematical language.\n- **Consistency and Completeness:** The setup is complete. However, the notation for traces at the boundary, e.g., $u^{-}(0)$ and $u^{+}(1)$, is non-standard. Typically, at $x=0$, there is only a trace from the right, $u(0^{+})$, and at $x=1$, only a trace from the left, $u(1^{-})$. A reasonable interpretation is that the given notation refers to the trace from the only adjacent element. I will proceed with this interpretation:\n  - At $x=0$, $u^{-}(0)$ and $p^{-}(0)$ refer to the traces from $K_1$, so $u^{-}(0) \\equiv u(0^{+}) = U_1$ and $p^{-}(0) \\equiv p(0^{+}) = P_1$.\n  - At $x=1$, $u^{+}(1)$ and $p^{+}(1)$ refer to the traces from $K_2$, so $u^{+}(1) \\equiv u(1^{-}) = U_2$ and $p^{+}(1) \\equiv p(1^{-}) = P_2$.\n  Under this interpretation, the problem is consistent and solvable.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. I will proceed with the detailed solution.\n\n### Detailed Solution\n\nWe begin by deriving the weak formulation of the system on each element $K_i = [x_{i-1}, x_i]$. We use piecewise constant test functions $v_h$ for the equation $p - u_x = 0$ and $q_h$ for the equation $-p_x = 1$.\n\nFor the first equation, we multiply by a test function $v_h$ and integrate over $K_i$:\n$$ \\int_{K_i} p_h v_h \\,dx - \\int_{K_i} (u_h)_x v_h \\,dx = 0 $$\nIntegrating the second term by parts gives:\n$$ \\int_{K_i} p_h v_h \\,dx - \\left[ u_h v_h \\right]_{x_{i-1}}^{x_i} + \\int_{K_i} u_h (v_h)_x \\,dx = 0 $$\nSince $v_h$ is a constant on $K_i$, its derivative $(v_h)_x$ is zero. Replacing the boundary values of $u_h$ with numerical fluxes $u^*$, we get:\n$$ \\int_{K_i} p_h v_h \\,dx - u^*(x_i) v_h(x_i^-) + u^*(x_{i-1}) v_h(x_{i-1}^+) = 0 $$\n\nFor the second equation, we multiply by a test function $q_h$ and integrate over $K_i$:\n$$ -\\int_{K_i} (p_h)_x q_h \\,dx = \\int_{K_i} 1 \\cdot q_h \\,dx $$\nIntegrating the left side by parts yields:\n$$ -\\left[ p_h q_h \\right]_{x_{i-1}}^{x_i} + \\int_{K_i} p_h (q_h)_x \\,dx = \\int_{K_i} q_h \\,dx $$\nSince $q_h$ is a constant on $K_i$, $(q_h)_x = 0$. Replacing boundary values of $p_h$ with fluxes $p^*$:\n$$ -p^*(x_i) q_h(x_i^-) + p^*(x_{i-1}) q_h(x_{i-1}^+) = \\int_{K_i} q_h \\,dx $$\n\nNow we apply these general forms to our specific problem. The approximations are $u_h|_{K_1}=U_1$, $p_h|_{K_1}=P_1$, $u_h|_{K_2}=U_2$, $p_h|_{K_2}=P_2$. The test functions can be taken as $v_h=1$ and $q_h=1$ on each element in turn.\n\n**On element $K_1 = [0, h_1] = [0, 1/3]$:**\nThe element length is $h_1 = 1/3$. The discrete equations are:\n1.  $\\int_0^{1/3} P_1 \\cdot 1 \\,dx - u^*(1/3) \\cdot 1 + u^*(0) \\cdot 1 = 0 \\implies P_1 h_1 - u^*(1/3) + u^*(0) = 0$\n2.  $-p^*(1/3) \\cdot 1 + p^*(0) \\cdot 1 = \\int_0^{1/3} 1 \\,dx \\implies -p^*(1/3) + p^*(0) = h_1$\n\n**On element $K_2 = [h_1, 1] = [1/3, 1]$:**\nThe element length is $h_2 = 2/3$. The discrete equations are:\n3.  $\\int_{1/3}^1 P_2 \\cdot 1 \\,dx - u^*(1) \\cdot 1 + u^*(1/3) \\cdot 1 = 0 \\implies P_2 h_2 - u^*(1) + u^*(1/3) = 0$\n4.  $-p^*(1) \\cdot 1 + p^*(1/3) \\cdot 1 = \\int_{1/3}^1 1 \\,dx \\implies -p^*(1) + p^*(1/3) = h_2$\n\nNext, we substitute the given numerical fluxes.\n- At $x=0$: $u^*(0) = 0$. Based onour interpretation, $p^*(0) = P_1 - \\tau(U_1 - 0) = P_1 - \\tau U_1$.\n- At $x=1/3$: $u^-(1/3) = U_1$, $u^+(1/3) = U_2$, $p^+(1/3) = P_2$. So, $u^*(1/3) = U_1$ and $p^*(1/3) = P_2 - \\tau(U_2 - U_1)$.\n- At $x=1$: $u^*(1) = 0$. Based on our interpretation, $p^*(1) = P_2 + \\tau(U_2 - 0) = P_2 + \\tau U_2$.\n\nSubstituting these into the four equations:\n1.  $P_1(\\frac{1}{3}) - U_1 + 0 = 0 \\implies P_1 = 3 U_1$\n2.  $-(P_2 - \\tau(U_2 - U_1)) + (P_1 - \\tau U_1) = \\frac{1}{3} \\implies P_1 - P_2 - 2\\tau U_1 + \\tau U_2 = \\frac{1}{3}$\n3.  $P_2(\\frac{2}{3}) - 0 + U_1 = 0 \\implies P_2 = -\\frac{3}{2} U_1$\n4.  $-(P_2 + \\tau U_2) + (P_2 - \\tau(U_2 - U_1)) = \\frac{2}{3} \\implies \\tau U_1 - 2\\tau U_2 = \\frac{2}{3}$\n\nWe now have a system of four linear equations for the four unknowns $U_1, U_2, P_1, P_2$. We can eliminate $P_1$ and $P_2$ to find the system for $U_1, U_2$.\nSubstitute Eq. (1) and (3) into Eq. (2):\n$$ (3 U_1) - \\left(-\\frac{3}{2} U_1\\right) - 2\\tau U_1 + \\tau U_2 = \\frac{1}{3} $$\n$$ \\left(3 + \\frac{3}{2} - 2\\tau\\right) U_1 + \\tau U_2 = \\frac{1}{3} $$\n$$ \\left(\\frac{9}{2} - 2\\tau\\right) U_1 + \\tau U_2 = \\frac{1}{3} $$\nThis is our first equation for the $U$ variables. The second equation is Eq. (4):\n$$ \\tau U_1 - 2\\tau U_2 = \\frac{2}{3} $$\n\nThe $2 \\times 2$ linear system for $(U_1, U_2)$ is:\n$$ \\begin{pmatrix} \\frac{9}{2} - 2\\tau & \\tau \\\\ \\tau & -2\\tau \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix} $$\n\nWe solve this system for $U_1$ and $U_2$. The determinant of the coefficient matrix is:\n$$ D = \\left(\\frac{9}{2} - 2\\tau\\right)(-2\\tau) - (\\tau)(\\tau) = -9\\tau + 4\\tau^2 - \\tau^2 = 3\\tau^2 - 9\\tau = 3\\tau(\\tau - 3) $$\nUsing Cramer's rule:\n$$ U_1 = \\frac{1}{D} \\det \\begin{pmatrix} \\frac{1}{3} & \\tau \\\\ \\frac{2}{3} & -2\\tau \\end{pmatrix} = \\frac{\\frac{1}{3}(-2\\tau) - \\tau(\\frac{2}{3})}{3\\tau(\\tau - 3)} = \\frac{-\\frac{2\\tau}{3} - \\frac{2\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{-\\frac{4\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{-4}{9(\\tau - 3)} = \\frac{4}{9(3 - \\tau)} $$\n$$ U_2 = \\frac{1}{D} \\det \\begin{pmatrix} \\frac{9}{2} - 2\\tau & \\frac{1}{3} \\\\ \\tau & \\frac{2}{3} \\end{pmatrix} = \\frac{(\\frac{9}{2} - 2\\tau)\\frac{2}{3} - \\tau(\\frac{1}{3})}{3\\tau(\\tau - 3)} = \\frac{3 - \\frac{4\\tau}{3} - \\frac{\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{3 - \\frac{5\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{\\frac{9-5\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{9 - 5\\tau}{9\\tau(\\tau - 3)} $$\n\nThe problem requires the discrete solution to be non-negative, meaning $U_1 \\ge 0$ and $U_2 \\ge 0$.\nThe condition $U_1 \\ge 0$ implies:\n$$ \\frac{4}{9(3 - \\tau)} \\ge 0 $$\nSince the numerator $4$ is positive, the denominator must be positive: $9(3 - \\tau) > 0$, which means $3 - \\tau > 0$, so $\\tau < 3$.\n\nThe condition $U_2 \\ge 0$ implies:\n$$ \\frac{9 - 5\\tau}{9\\tau(\\tau - 3)} \\ge 0 $$\nSince we are given $\\tau > 0$, the term $9\\tau$ in the denominator is positive. The inequality is equivalent to:\n$$ \\frac{9 - 5\\tau}{\\tau - 3} \\ge 0 $$\nThis inequality can be satisfied in two cases:\n1.  $9 - 5\\tau \\ge 0$ and $\\tau - 3 > 0$. This gives $\\tau \\le \\frac{9}{5}$ and $\\tau > 3$, which is a contradiction.\n2.  $9 - 5\\tau \\le 0$ and $\\tau - 3 < 0$. This gives $\\tau \\ge \\frac{9}{5}$ and $\\tau < 3$. The combined condition is $\\frac{9}{5} \\le \\tau < 3$.\n\nFor both $U_1$ and $U_2$ to be non-negative, both conditions on $\\tau$ must be met. We must find the intersection of the sets $(\\tau < 3)$ and $[\\frac{9}{5}, 3)$. The intersection is the interval $[\\frac{9}{5}, 3)$.\n\nThe problem asks for the minimal value of $\\tau$ that ensures non-negativity. This is the minimum value in the interval $[\\frac{9}{5}, 3)$, which is $\\frac{9}{5}$.\nThus, the minimal penalty parameter is $\\tau_{\\min} = \\frac{9}{5}$.",
            "answer": "$$\\boxed{\\frac{9}{5}}$$"
        },
        {
            "introduction": "Beyond steady-state problems, the LDG method is a powerful tool for time-dependent phenomena like heat diffusion. This practice extends the framework to an evolution equation on a periodic domain, a common setup for theoretical studies. You will use discrete Fourier analysis to probe the scheme's stability by deriving an amplification factor, which reveals the influence of numerical flux parameters on the method's dissipative character and its behavior over time .",
            "id": "3396329",
            "problem": "Consider the one-dimensional heat equation on a periodic domain with constant diffusivity,\n$$\nu_{t}(x,t) \\;=\\; \\nu \\, u_{xx}(x,t), \\qquad x \\in [0,L], \\quad t \\ge 0,\n$$\nwhere $\\nu \\gt 0$ is a constant. Partition $[0,L]$ into $N$ uniform elements $I_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$ of size $h = L/N$, and impose periodicity at $x=0$ and $x=L$. Introduce the local discontinuous Galerkin (LDG) mixed form by setting $q = u_x$ so that $u_t = \\nu \\, q_x$. Use the piecewise-constant approximation space on each element for both $q$ and $u$, with the canonical constant basis function on each element, and adopt the following numerical fluxes at each interface $x_{j+\\frac{1}{2}}$:\n$$\n\\widehat{u}_{j+\\frac{1}{2}} \\;=\\; u_j^{-}, \n\\qquad \n\\widehat{q}_{j+\\frac{1}{2}} \\;=\\; q_{j+1}^{+} \\;+\\; \\frac{\\tau}{h} \\,\\big(u_{j+1}^{+} - u_{j}^{-}\\big),\n$$\nwhere $\\tau \\ge 0$ is a dimensionless penalty parameter, $u_j^{-}$ denotes the trace from the left of $x_{j+\\frac{1}{2}}$ (element $I_j$), and $q_{j+1}^{+}$ the trace from the right (element $I_{j+1}$). Assume that the traces equal the elementwise constants $u_j$ and $q_j$.\n\n1) Starting from elementwise integration by parts and the LDG mixed formulation with the specified numerical fluxes, derive the element-level matrices for the $q$-equation and the $u$-equation using the constant basis on each element. Then, assemble the global semi-discrete saddle system that couples the vectors of elementwise constants for $q$ and $u$ across the periodic mesh.\n\n2) For the resulting global semi-discrete system, perform a discrete Fourier analysis on the uniform periodic mesh by seeking solutions of the form $u_j(t) = \\widehat{u}(t) \\exp(\\mathrm{i} j \\theta)$ and $q_j(t) = \\widehat{q}(t) \\exp(\\mathrm{i} j \\theta)$ with $\\theta \\in [-\\pi,\\pi]$. Eliminate $\\widehat{q}(t)$ to obtain a closed scalar evolution for $\\widehat{u}(t)$ of the form\n$$\n\\widehat{u}_t \\;=\\; - \\frac{\\nu}{h^2} \\, \\phi(\\theta) \\, \\widehat{u}.\n$$\nCompute the exact closed-form analytic expression for $\\phi(\\theta)$ in terms of $\\tau$ and $\\theta$. Your final answer must be the expression for $\\phi(\\theta)$ only. No numerical approximation or rounding is required.",
            "solution": "The problem asks for the derivation of the semi-discrete system for a Local Discontinuous Galerkin (LDG) method applied to the 1D heat equation, and then to compute the amplification factor symbol $\\phi(\\theta)$ via a discrete Fourier analysis.\n\nThe problem is valid as it is scientifically grounded in the theory of numerical methods for PDEs, is well-posed with all necessary information provided, and is stated objectively.\n\n**Part 1: Derivation of the Semi-Discrete System**\n\nWe start with the one-dimensional heat equation rewritten as a first-order system:\n$$\n\\begin{cases}\nq - u_x = 0 \\\\\nu_t - \\nu q_x = 0\n\\end{cases}\n$$\nWe seek approximate solutions $u_h$ and $q_h$ in the space of piecewise constant functions on a uniform mesh of elements $I_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$ of size $h$. On each element $I_j$, we have $u_h(x,t) = u_j(t)$ and $q_h(x,t) = q_j(t)$.\n\nThe weak formulation is obtained by multiplying the equations by test functions $v$ and $w$ from the same approximation space and integrating over an element $I_j$:\n$$\n\\int_{I_j} q_h v \\,dx - \\int_{I_j} u_{hx} v \\,dx = 0\n$$\n$$\n\\int_{I_j} u_{ht} w \\,dx - \\nu \\int_{I_j} q_{hx} w \\,dx = 0\n$$\nWe apply integration by parts to the spatial derivative terms:\n$$\n\\int_{I_j} q_h v \\,dx + \\int_{I_j} u_h v_x \\,dx - [u_h v]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} = 0\n$$\n$$\n\\int_{I_j} u_{ht} w \\,dx + \\nu \\int_{I_j} q_h w_x \\,dx - \\nu [q_h w]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} = 0\n$$\nSince the test functions are piecewise constant, their derivatives $v_x$ and $w_x$ are zero inside each element. The boundary terms are replaced by numerical fluxes, denoted by a hat symbol $(\\widehat{\\cdot})$. The equations become:\n$$\n\\int_{I_j} q_h v \\,dx - (\\widehat{u}_{j+\\frac{1}{2}} v_j^{-} - \\widehat{u}_{j-\\frac{1}{2}} v_j^{+}) = 0\n$$\n$$\n\\int_{I_j} u_{ht} w \\,dx - \\nu (\\widehat{q}_{j+\\frac{1}{2}} w_j^{-} - \\widehat{q}_{j-\\frac{1}{2}} w_j^{+}) = 0\n$$\nHere, $v_j^{-} = v(x_{j+\\frac{1}{2}}^{-})$ and $v_j^{+} = v(x_{j-\\frac{1}{2}}^{+})$ are the traces of the test function $v$ at the boundaries of element $I_j$.\n\nWe use the canonical basis function which is $1$ on element $I_j$ and $0$ elsewhere. For element $I_j$, we choose $v(x) = w(x) = 1$ for $x \\in I_j$ and $0$ otherwise. This implies $v_j^{-} = 1$ and $v_j^{+} = 1$. The integrals become $\\int_{I_j} u_j \\,dx = u_j h$, $\\int_{I_j} q_j \\,dx = q_j h$, and $\\int_{I_j} u_{jt} \\,dx = \\frac{du_j}{dt} h$. The weak formulation for element $I_j$ simplifies to:\n$$\nh q_j - (\\widehat{u}_{j+\\frac{1}{2}} - \\widehat{u}_{j-\\frac{1}{2}}) = 0\n$$\n$$\nh \\frac{du_j}{dt} - \\nu (\\widehat{q}_{j+\\frac{1}{2}} - \\widehat{q}_{j-\\frac{1}{2}}) = 0\n$$\nNow we substitute the given numerical fluxes. The problem states that the traces of the piecewise constant solutions are equal to the elementwise constants, e.g., $u_j^{-} = u_j$ and $u_{j+1}^{+} = u_{j+1}$.\nThe fluxes are:\n$$\n\\widehat{u}_{j+\\frac{1}{2}} = u_j^{-} = u_j\n$$\n$$\n\\widehat{q}_{j+\\frac{1}{2}} = q_{j+1}^{+} + \\frac{\\tau}{h} (u_{j+1}^{+} - u_j^{-}) = q_{j+1} + \\frac{\\tau}{h} (u_{j+1} - u_j)\n$$\nFor the interface $x_{j-\\frac{1}{2}}$, we decrement the indices:\n$$\n\\widehat{u}_{j-\\frac{1}{2}} = u_{j-1}^{-} = u_{j-1}\n$$\n$$\n\\widehat{q}_{j-\\frac{1}{2}} = q_{j}^{+} + \\frac{\\tau}{h} (u_{j}^{+} - u_{j-1}^{-}) = q_j + \\frac{\\tau}{h} (u_j - u_{j-1})\n$$\nSubstituting these into the semi-discrete equations:\nFor the $q$-equation:\n$$\nh q_j - (u_j - u_{j-1}) = 0 \\implies h q_j = u_j - u_{j-1}\n$$\nFor the $u$-equation:\n$$\nh \\frac{du_j}{dt} - \\nu \\left[ \\left(q_{j+1} + \\frac{\\tau}{h}(u_{j+1} - u_j)\\right) - \\left(q_j + \\frac{\\tau}{h}(u_j - u_{j-1})\\right) \\right] = 0\n$$\n$$\nh \\frac{du_j}{dt} = \\nu (q_{j+1} - q_j) + \\frac{\\nu\\tau}{h} (u_{j+1} - 2u_j + u_{j-1})\n$$\nThese two sets of equations, holding for $j=1, \\dots, N$ with periodic boundary conditions (e.g., $u_0 = u_N$, $q_{N+1}=q_1$), form the global semi-discrete system. This is a system of differential-algebraic equations. In matrix form, with $\\mathbf{u} = (u_1, \\dots, u_N)^T$ and $\\mathbf{q} = (q_1, \\dots, q_N)^T$, the system can be expressed as:\n$$\nh \\mathbf{I} \\mathbf{q} - (\\mathbf{I} - \\mathbf{C}_{-1}) \\mathbf{u} = \\mathbf{0}\n$$\n$$\nh \\mathbf{I} \\frac{d\\mathbf{u}}{dt} - \\nu(\\mathbf{C}_{1} - \\mathbf{I})\\mathbf{q} - \\frac{\\nu\\tau}{h}(\\mathbf{C}_{1} - 2\\mathbf{I} + \\mathbf{C}_{-1})\\mathbf{u} = \\mathbf{0}\n$$\nwhere $\\mathbf{I}$ is the identity matrix, and $\\mathbf{C}_1$ and $\\mathbf{C}_{-1}$ are the forward and backward circulant shift matrices, respectively.\n\n**Part 2: Discrete Fourier Analysis**\n\nWe seek solutions of the form $u_j(t) = \\widehat{u}(t) \\exp(\\mathrm{i} j \\theta)$ and $q_j(t) = \\widehat{q}(t) \\exp(\\mathrm{i} j \\theta)$. Substituting this ansatz into the scalar semi-discrete equations, the common factor $\\exp(\\mathrm{i} j \\theta)$ cancels out.\n\nThe shifted terms become:\n$u_{j\\pm 1} = \\widehat{u} \\exp(\\mathrm{i} (j\\pm 1) \\theta) = \\widehat{u} \\exp(\\pm \\mathrm{i} \\theta) \\exp(\\mathrm{i} j \\theta)$\n$q_{j\\pm 1} = \\widehat{q} \\exp(\\mathrm{i} (j\\pm 1) \\theta) = \\widehat{q} \\exp(\\pm \\mathrm{i} \\theta) \\exp(\\mathrm{i} j \\theta)$\n\nApplying this to the first equation, $h q_j = u_j - u_{j-1}$:\n$$\nh \\widehat{q} = \\widehat{u} - \\widehat{u} \\exp(-\\mathrm{i}\\theta) = \\widehat{u}(1 - \\exp(-\\mathrm{i}\\theta))\n$$\nThis allows us to express $\\widehat{q}$ in terms of $\\widehat{u}$:\n$$\n\\widehat{q} = \\frac{\\widehat{u}}{h} (1 - \\exp(-\\mathrm{i}\\theta))\n$$\nApplying the ansatz to the second equation, $h \\frac{du_j}{dt} = \\nu (q_{j+1} - q_j) + \\frac{\\nu\\tau}{h} (u_{j+1} - 2u_j + u_{j-1})$:\n$$\nh \\frac{d\\widehat{u}}{dt} = \\nu (\\widehat{q}\\exp(\\mathrm{i}\\theta) - \\widehat{q}) + \\frac{\\nu\\tau}{h} (\\widehat{u}\\exp(\\mathrm{i}\\theta) - 2\\widehat{u} + \\widehat{u}\\exp(-\\mathrm{i}\\theta))\n$$\n$$\nh \\widehat{u}_t = \\nu \\widehat{q} (\\exp(\\mathrm{i}\\theta) - 1) + \\frac{\\nu\\tau}{h} \\widehat{u} (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))\n$$\nNow, we eliminate $\\widehat{q}$ by substituting its expression from the first equation:\n$$\nh \\widehat{u}_t = \\nu \\left( \\frac{\\widehat{u}}{h} (1 - \\exp(-\\mathrm{i}\\theta)) \\right) (\\exp(\\mathrm{i}\\theta) - 1) + \\frac{\\nu\\tau}{h} \\widehat{u} (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))\n$$\nDividing by $h$ and factoring out $\\widehat{u}$:\n$$\n\\widehat{u}_t = \\frac{\\nu}{h^2} \\left[ (1 - \\exp(-\\mathrm{i}\\theta))(\\exp(\\mathrm{i}\\theta) - 1) + \\tau(\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta)) \\right] \\widehat{u}\n$$\nWe simplify the terms in the square brackets. Using $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos\\theta$:\nThe second term is straightforward:\n$$\n\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta) = 2\\cos\\theta - 2\n$$\nThe first term is:\n$$\n(1 - \\exp(-\\mathrm{i}\\theta))(\\exp(\\mathrm{i}\\theta) - 1) = \\exp(\\mathrm{i}\\theta) - 1 - \\exp(-\\mathrm{i}\\theta)\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta) = \\exp(\\mathrm{i}\\theta) - 1 - 1 + \\exp(-\\mathrm{i}\\theta) = 2\\cos\\theta - 2\n$$\nSubstituting these simplified expressions back:\n$$\n\\widehat{u}_t = \\frac{\\nu}{h^2} \\left[ (2\\cos\\theta - 2) + \\tau(2\\cos\\theta - 2) \\right] \\widehat{u}\n$$\n$$\n\\widehat{u}_t = \\frac{\\nu}{h^2} (1+\\tau)(2\\cos\\theta - 2) \\widehat{u}\n$$\n$$\n\\widehat{u}_t = - \\frac{\\nu}{h^2} (1+\\tau)(2 - 2\\cos\\theta) \\widehat{u}\n$$\n$$\n\\widehat{u}_t = - \\frac{\\nu}{h^2} \\left[ 2(1+\\tau)(1 - \\cos\\theta) \\right] \\widehat{u}\n$$\nThis equation is in the desired form $\\widehat{u}_t = - \\frac{\\nu}{h^2} \\phi(\\theta) \\widehat{u}$. By comparing the two expressions, we identify $\\phi(\\theta)$.\n\nThe final expression for $\\phi(\\theta)$ is:\n$$\n\\phi(\\theta) = 2(1+\\tau)(1 - \\cos\\theta)\n$$",
            "answer": "$$\\boxed{2(1+\\tau)(1 - \\cos\\theta)}$$"
        }
    ]
}