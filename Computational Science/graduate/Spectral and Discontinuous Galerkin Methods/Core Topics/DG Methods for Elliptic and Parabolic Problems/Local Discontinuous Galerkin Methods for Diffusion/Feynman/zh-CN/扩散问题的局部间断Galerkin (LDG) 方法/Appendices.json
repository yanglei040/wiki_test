{
    "hands_on_practices": [
        {
            "introduction": "实现数值格式的第一步是将连续问题正确地转化为离散代数系统。本练习侧重于局部间断伽辽金（LDG）方法的基本机理，指导您针对一个带混合边界条件的一维扩散问题，推导其弱形式并显式计算边界项 。掌握这一过程对于将该方法应用于更复杂的场景至关重要。",
            "id": "3365011",
            "problem": "考虑在区间 $[0,1]$ 上的一维、稳态、二阶扩散模型，其扩散系数 $\\kappa>0$ 为正常数，\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) \\;=\\; f(x),\n$$\n该模型满足边界条件 $u(0)=0$ 和 $\\kappa\\, u'(1)=1$，源项为零，即 $f(x)\\equiv 0$。引入辅助变量 $r(x)=\\kappa\\, u'(x)$，使方程组变为\n$$\nr - \\kappa\\, u' \\;=\\; 0, \\qquad -r' \\;=\\; 0.\n$$\n使用局部间断伽辽金 (Local Discontinuous Galerkin, LDG) 方法，在单个单元 $E=[0,1]$ 上用 $p=1$ 次的分段多项式来近似 $u$ 和 $r$：\n$$\nu_h(x) \\;=\\; a_0\\,\\phi_0(x) + a_1\\,\\phi_1(x), \\qquad r_h(x) \\;=\\; b_0\\,\\phi_0(x) + b_1\\,\\phi_1(x),\n$$\n其中，在 $E$ 上的局部基函数选择为 $\\phi_0(x)=1$ 和 $\\phi_1(x)=x$。令 $v,w\\in\\mathrm{span}\\{\\phi_0,\\phi_1\\}$ 分别为第一个和第二个方程的检验函数。从一阶系统出发，通过适当使用分部积分法，并将边界上的迹替换为数值通量，推导单元上的 LDG 弱形式。对于数值通量，在单个单元的边界上采用标准的 LDG 交替选择：\n- 在 $x=0$ (狄利克雷，Dirichlet) 处，设 $\\widehat{u}(0)=u_D=0$ 并对 $\\widehat{r}(0)$ 使用内部值 $\\widehat{r}(0)=r_h(0)$。\n- 在 $x=1$ (诺伊曼，Neumann) 处，设 $\\widehat{r}(1)=g_N=1$ 并对 $\\widehat{u}(1)$ 使用内部值 $\\widehat{u}(1)=u_h(1)$。\n\n写出由此得到的单元 LDG 系统，然后显式计算 $p=1$ 次多项式的边界贡献项。具体来说，提取仅由给定边界数据 $(u_D,g_N)=(0,1)$ 产生的局部残差中的纯边界贡献，该贡献通过在每个方程中使用两个检验函数 $\\phi_0$ 和 $\\phi_1$ 进行计算。将这四个边界贡献按行向量的形式排列\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big],\n$$\n其中 $B^{(r-\\kappa u')}_{\\phi_j}$ 和 $B^{(-r')}_{\\phi_j}$ 分别表示第一个和第二个方程的弱形式中，仅来自给定边界数据的边界项。将此行向量作为你的最终答案。无需四舍五入。最终答案需以封闭形式的解析表达式给出。",
            "solution": "用户要求我解决一个基于局部间断伽辽金 (LDG) 方法求解一维扩散方程的问题。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n-   **控制方程**：$- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) = f(x)$，在区间 $[0,1]$ 上。\n-   **参数**：扩散系数 $\\kappa > 0$ 为常数。源项 $f(x) \\equiv 0$。\n-   **边界条件**：$u(0)=u_D=0$ 和 $\\kappa\\, u'(1)=g_N=1$。\n-   **一阶系统**：辅助变量为 $r(x)=\\kappa\\, u'(x)$。方程组为：\n    $$\n    r - \\kappa\\, u' = 0\n    $$\n    $$\n    -r' = 0\n    $$\n-   **离散化**：区域为单个单元 $E=[0,1]$。近似空间由 $p=1$ 次的多项式组成。\n-   **试探函数和检验函数**：\n    -   基函数：$\\phi_0(x)=1$, $\\phi_1(x)=x$。\n    -   试探函数：$u_h(x) = a_0\\phi_0(x) + a_1\\phi_1(x)$ 和 $r_h(x) = b_0\\phi_0(x) + b_1\\phi_1(x)$。\n    -   检验函数：$v,w \\in \\mathrm{span}\\{\\phi_0,\\phi_1\\}$。\n-   **数值通量**：指定了交替通量选择：\n    -   在 $x=0$ 处：$\\widehat{u}(0)=u_D=0$；$\\widehat{r}(0)=r_h(0)$。\n    -   在 $x=1$ 处：$\\widehat{r}(1)=g_N=1$；$\\widehat{u}(1)=u_h(1)$。\n-   **任务**：计算局部残差的四个边界贡献项，按行向量 $\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]$ 的顺序排列，这些贡献项仅由给定的边界数据 $(u_D,g_N)=(0,1)$ 产生。\n\n**1.2. 使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题是将成熟的局部间断伽辽金 (LDG) 方法应用于一个基本的二阶椭圆偏微分方程（扩散方程）的标准应用。所有概念在数值分析和计算科学中都是标准的。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了一套完整的指令，包括控制方程、边界条件、离散化细节（单元、基函数）以及数值通量的具体选择。任务是基于这些输入进行一个具体、明确的计算。\n-   **客观性**：问题陈述是用精确的数学术语表述的，没有任何主观或模棱两可的语言。\n\n**1.3. 结论与行动**\n\n问题有效。我将继续进行求解。\n\n### 步骤 2：求解推导\n\n该过程首先从推导单元 $E=[0,1]$ 上一阶系统的弱形式开始。\n\n**第一个方程的弱形式推导**\n第一个方程是 $r - \\kappa u' = 0$。我们用检验函数 $v$ 乘以该方程，并在单元 $E$ 上积分：\n$$\n\\int_{E} (r_h - \\kappa u'_h) v \\, dx = 0\n$$\n$$\n\\int_{0}^{1} r_h v \\, dx - \\kappa \\int_{0}^{1} u'_h v \\, dx = 0\n$$\n我们对第二项应用分部积分法：\n$$\n\\int_{0}^{1} u'_h v \\, dx = [u_h v]_{x=0}^{x=1} - \\int_{0}^{1} u_h v' \\, dx = u_h(1)v(1) - u_h(0)v(0) - \\int_{0}^{1} u_h v' \\, dx\n$$\n将其代回原方程，得到：\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa(u_h(1)v(1) - u_h(0)v(0)) = 0\n$$\n在间断伽辽金框架中，单元边界上解的迹被数值通量（用帽子符号表示）所取代。弱形式变为：\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa \\widehat{u}(1)v(1) + \\kappa \\widehat{u}(0)v(0) = 0\n$$\n\n**第二个方程的弱形式推导**\n第二个方程是 $-r' = 0$。我们用检验函数 $w$ 乘以该方程，并在 $E$ 上积分：\n$$\n-\\int_{E} r'_h w \\, dx = 0\n$$\n应用分部积分法：\n$$\n-[r_h w]_{x=0}^{x=1} + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n$$\n-(r_h(1)w(1) - r_h(0)w(0)) + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n用数值通量 $\\widehat{r}(1)$ 和 $\\widehat{r}(0)$ 替换边界上的迹：\n$$\n\\int_{0}^{1} r_h w' \\, dx - \\widehat{r}(1)w(1) + \\widehat{r}(0)w(0) = 0\n$$\n\n**定义局部残差并识别边界贡献**\n问题要求的是仅由给定边界数据产生的局部残差贡献项。每个方程的局部残差是必须等于零的表达式。我们代入问题中给定的特定数值通量：\n-   在 $x=0$ 处：$\\widehat{u}(0)=u_D=0$，$\\widehat{r}(0)=r_h(0)$（内部值）。\n-   在 $x=1$ 处：$\\widehat{r}(1)=g_N=1$，$\\widehat{u}(1)=u_h(1)$（内部值）。\n\n将这些代入弱形式，得到残差方程：\n第一个方程的残差：\n$$\n\\underbrace{\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa u_h(1)v(1)}_{\\text{依赖于未知解的项}} + \\underbrace{\\kappa u_D v(0)}_{\\text{来自给定数据的项}} = 0\n$$\n第二个方程的残差：\n$$\n\\underbrace{\\int_{0}^{1} r_h w' \\, dx + r_h(0)w(0)}_{\\text{依赖于未知解的项}} \\underbrace{- g_N w(1)}_{\\text{来自给定数据的项}} = 0\n$$\n来自给定边界数据的局部残差贡献项是表达式中不依赖于未知解系数 $(a_0, a_1, b_0, b_1)$ 的部分。\n从第一个方程看，该贡献为 $B^{(r-\\kappa u')}_{v} = \\kappa u_D v(0)$。\n从第二个方程看，该贡献为 $B^{(-r')}_{w} = -g_N w(1)$。\n\n**计算特定检验函数的贡献**\n我们已知 $u_D=0$ 和 $g_N=1$。检验函数为 $\\phi_0(x)=1$ 和 $\\phi_1(x)=x$。\n\n1.  **项 $B^{(r-\\kappa u')}_{\\phi_0}$**：此处 $v = \\phi_0(x)=1$。\n    $B^{(r-\\kappa u')}_{\\phi_0} = \\kappa u_D \\phi_0(0) = \\kappa \\cdot 0 \\cdot 1 = 0$。\n\n2.  **项 $B^{(r-\\kappa u')}_{\\phi_1}$**：此处 $v = \\phi_1(x)=x$。\n    $B^{(r-\\kappa u')}_{\\phi_1} = \\kappa u_D \\phi_1(0) = \\kappa \\cdot 0 \\cdot 0 = 0$。\n\n3.  **项 $B^{(-r')}_{\\phi_0}$**：此处 $w = \\phi_0(x)=1$。\n    $B^{(-r')}_{\\phi_0} = -g_N \\phi_0(1) = -1 \\cdot 1 = -1$。\n\n4.  **项 $B^{(-r')}_{\\phi_1}$**：此处 $w = \\phi_1(x)=x$。\n    $B^{(-r')}_{\\phi_1} = -g_N \\phi_1(1) = -1 \\cdot 1 = -1$。\n\n**向量的最终组合**\n问题要求按指定顺序将这四个贡献项组成行向量：\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]\n$$\n代入计算出的值，我们得到最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  -1  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "具有非负源项的连续扩散问题通常保证其解是非负的，这一性质被称为正定性。然而，数值近似不一定能自动继承这一特性。本练习展示了一个标准LDG格式可能产生非物理解的负值的场景，并揭示了罚参数 $\\tau$ 在保证稳定性和恢复正定性方面的关键作用 。",
            "id": "3396371",
            "problem": "考虑区域 $[0,1]$ 上的一维稳态扩散问题，由以下边值问题给出\n$$\n- u''(x) = 1 \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\n对于这个具有非负源项和齐次狄利克雷边界条件的二阶线性椭圆问题，一个基本事实是其精确解在 $[0,1]$ 上是非负的。特别是，通过两次积分可得到古典解 $u(x) = \\frac{1}{2}x(1-x)$，该解对于所有 $x \\in [0,1]$ 满足 $u(x) \\ge 0$。\n\n现在使用局部间断伽辽金 (LDG) 方法来离散化此问题，其中LDG代表局部间断伽辽金，对主变量 $u$ 和辅助变量 $p = u_x$ 均使用分片常数多项式空间。使用网格 $\\{[0,h_1],[h_1,1]\\}$，其中 $h_1 = \\frac{1}{3}$ 且 $h_2 = \\frac{2}{3}$。在每个单元 $K_i$ 上，分别用常数 $U_i$ 和 $P_i$ 来近似 $u$ 和 $p$。\n\n从一阶混合系统出发\n$$\np - u_x = 0, \\qquad -p_x = 1,\n$$\n并利用在每个单元上通过分部积分得到的标准积分恒等式，通过如下定义的LDG数值通量来施加单元间的耦合。在左边界 $x=0$ 处，弱施加齐次狄利克雷边界条件：\n$$\nu^{*}(0) = 0, \\qquad p^{*}(0) = p^{-}(0) - \\tau \\left(u^{-}(0) - 0\\right).\n$$\n在内部界面 $x = h_1$ 处，选择交替通量：\n$$\nu^{*}(h_1) = u^{-}(h_1), \\qquad p^{*}(h_1) = p^{+}(h_1) - \\tau\\left(u^{+}(h_1) - u^{-}(h_1)\\right).\n$$\n在右边界 $x=1$ 处，弱施加齐次狄利克雷条件：\n$$\nu^{*}(1) = 0, \\qquad p^{*}(1) = p^{+}(1) + \\tau \\left(u^{+}(1) - 0\\right).\n$$\n此处，$u^{-}$ 和 $p^{-}$ 表示来自界面左侧单元的内部迹，$u^{+}$ 和 $p^{+}$ 表示来自界面右侧单元的内部迹；$\\tau > 0$ 是一个罚参数，在此网格的所有面上均取相同的值。\n\n仅使用每个单元上的分片常数测试函数，推导 $U_1$、$U_2$、$P_1$ 和 $P_2$ 的LDG离散方程，消去 $P_1$ 和 $P_2$，得到一个关于 $U_1$ 和 $U_2$ 的 $2 \\times 2$ 线性系统。然后，确定罚参数 $\\tau$ 的最小值，使得LDG离散解是非负的，即逐单元常数满足 $U_1 \\ge 0$ 和 $U_2 \\ge 0$。将最终的 $\\tau_{\\min}$ 表示为精确的分数形式。无需四舍五入。最终答案必须是一个数字。",
            "solution": "用户要求我解决一个涉及一维扩散方程的局部间断Galerkin (LDG) 方法的问题。\n\n### 问题验证\n\n首先，我必须验证问题陈述。\n\n**步骤1：提取已知条件**\n\n- **PDE系统：**\n  - $p - u_x = 0$\n  - $-p_x = 1$\n- **区域：** $x \\in [0,1]$\n- **边界条件 (BCs)：** $u(0) = 0$, $u(1) = 0$\n- **离散化：**\n  - 网格：两个单元，$K_1 = [0, h_1]$ 和 $K_2 = [h_1, 1]$，其中 $h_1 = \\frac{1}{3}$。这意味着 $K_1$ 的网格尺寸为 $h_1 = \\frac{1}{3}$，$K_2$ 的网格尺寸为 $h_2 = 1 - \\frac{1}{3} = \\frac{2}{3}$。\n  - 多项式空间：对 $u$ 和 $p$ 均使用分片常数。在 $K_i$ 上，近似解分别为 $U_i$ 和 $P_i$。\n- **数值通量：**\n  - 在 $x=0$ 处：$u^{*}(0) = 0$, $p^{*}(0) = p^{-}(0) - \\tau (u^{-}(0) - 0)$。\n  - 在 $x=h_1$ 处：$u^{*}(h_1) = u^{-}(h_1)$, $p^{*}(h_1) = p^{+}(h_1) - \\tau(u^{+}(h_1) - u^{-}(h_1))$。\n  - 在 $x=1$ 处：$u^{*}(1) = 0$, $p^{*}(1) = p^{+}(1) + \\tau (u^{+}(1) - 0)$。\n- **罚参数：** $\\tau > 0$，在所有面上为常数。\n- **任务：** 推导关于 $U_1, U_2$ 的 $2 \\times 2$ 系统，并找到使 $U_1 \\ge 0$ 和 $U_2 \\ge 0$ 的最小 $\\tau$ 值，记为 $\\tau_{\\min}$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题是LDG方法在经典扩散边值问题上的一个标准应用。LDG方法及相关的偏微分方程在数值分析和应用数学领域是公认的。\n- **适定性：** 该问题指明了推导唯一离散系统的所有必要组成部分（PDE、区域、边界条件、网格、基函数、数值通量）。问题要求一个可以从该系统推导出的特定值 $\\tau_{\\min}$。\n- **客观性：** 问题以精确、形式化的数学语言陈述。\n- **一致性与完整性：** 设置是完整的。但是，边界上迹的记法，例如 $u^{-}(0)$ 和 $u^{+}(1)$，是非标准的。通常，在 $x=0$ 处，只有来自右侧的迹 $u(0^{+})$；在 $x=1$ 处，只有来自左侧的迹 $u(1^{-})$。一个合理的解释是，给定的记法指的是来自唯一相邻单元的迹。我将按照这个解释进行：\n  - 在 $x=0$ 处，$u^{-}(0)$ 和 $p^{-}(0)$ 指的是来自 $K_1$ 的迹，因此 $u^{-}(0) \\equiv u(0^{+}) = U_1$ 且 $p^{-}(0) \\equiv p(0^{+}) = P_1$。\n  - 在 $x=1$ 处，$u^{+}(1)$ 和 $p^{+}(1)$ 指的是来自 $K_2$ 的迹，因此 $u^{+}(1) \\equiv u(1^{-}) = U_2$ 且 $p^{+}(1) \\equiv p(1^{-}) = P_2$。\n  在此解释下，问题是一致且可解的。\n\n**步骤3：结论与行动**\n\n问题被判定为**有效**。我将继续进行详细求解。\n\n### 详细求解过程\n\n我们首先在每个单元 $K_i = [x_{i-1}, x_i]$ 上推导系统的弱形式。我们对方程 $p - u_x = 0$ 使用分片常数测试函数 $v_h$，对方程 $-p_x = 1$ 使用分片常数测试函数 $q_h$。\n\n对于第一个方程，我们乘以测试函数 $v_h$ 并在 $K_i$ 上积分：\n$$ \\int_{K_i} p_h v_h \\,dx - \\int_{K_i} (u_h)_x v_h \\,dx = 0 $$\n对第二项进行分部积分得到：\n$$ \\int_{K_i} p_h v_h \\,dx - \\left[ u_h v_h \\right]_{x_{i-1}}^{x_i} + \\int_{K_i} u_h (v_h)_x \\,dx = 0 $$\n由于 $v_h$ 在 $K_i$ 上是常数，其导数 $(v_h)_x$ 为零。用数值通量 $u^*$ 替换 $u_h$ 的边界值，我们得到：\n$$ \\int_{K_i} p_h v_h \\,dx - u^*(x_i) v_h(x_i^-) + u^*(x_{i-1}) v_h(x_{i-1}^+) = 0 $$\n\n对于第二个方程，我们乘以测试函数 $q_h$ 并在 $K_i$ 上积分：\n$$ -\\int_{K_i} (p_h)_x q_h \\,dx = \\int_{K_i} 1 \\cdot q_h \\,dx $$\n对左侧进行分部积分得到：\n$$ -\\left[ p_h q_h \\right]_{x_{i-1}}^{x_i} + \\int_{K_i} p_h (q_h)_x \\,dx = \\int_{K_i} q_h \\,dx $$\n由于 $q_h$ 在 $K_i$ 上是常数，$(q_h)_x = 0$。用通量 $p^*$ 替换 $p_h$ 的边界值：\n$$ -p^*(x_i) q_h(x_i^-) + p^*(x_{i-1}) q_h(x_{i-1}^+) = \\int_{K_i} q_h \\,dx $$\n\n现在我们将这些一般形式应用于我们的具体问题。近似解为 $u_h|_{K_1}=U_1$, $p_h|_{K_1}=P_1$, $u_h|_{K_2}=U_2$, $p_h|_{K_2}=P_2$。测试函数可以在每个单元上依次取为 $v_h=1$ 和 $q_h=1$。\n\n**在单元 $K_1 = [0, h_1] = [0, 1/3]$ 上：**\n单元长度为 $h_1 = 1/3$。离散方程为：\n1.  $\\int_0^{1/3} P_1 \\cdot 1 \\,dx - u^*(1/3) \\cdot 1 + u^*(0) \\cdot 1 = 0 \\implies P_1 h_1 - u^*(1/3) + u^*(0) = 0$\n2.  $-p^*(1/3) \\cdot 1 + p^*(0) \\cdot 1 = \\int_0^{1/3} 1 \\,dx \\implies -p^*(1/3) + p^*(0) = h_1$\n\n**在单元 $K_2 = [h_1, 1] = [1/3, 1]$ 上：**\n单元长度为 $h_2 = 2/3$。离散方程为：\n3.  $\\int_{1/3}^1 P_2 \\cdot 1 \\,dx - u^*(1) \\cdot 1 + u^*(1/3) \\cdot 1 = 0 \\implies P_2 h_2 - u^*(1) + u^*(1/3) = 0$\n4.  $-p^*(1) \\cdot 1 + p^*(1/3) \\cdot 1 = \\int_{1/3}^1 1 \\,dx \\implies -p^*(1) + p^*(1/3) = h_2$\n\n接下来，我们代入给定的数值通量。\n- 在 $x=0$ 处：$u^*(0) = 0$。根据我们的解释，$p^*(0) = P_1 - \\tau(U_1 - 0) = P_1 - \\tau U_1$。\n- 在 $x=1/3$ 处：$u^-(1/3) = U_1$, $u^+(1/3) = U_2$, $p^+(1/3) = P_2$。所以，$u^*(1/3) = U_1$ 且 $p^*(1/3) = P_2 - \\tau(U_2 - U_1)$。\n- 在 $x=1$ 处：$u^*(1) = 0$。根据我们的解释，$p^*(1) = P_2 + \\tau(U_2 - 0) = P_2 + \\tau U_2$。\n\n将这些代入四个方程中：\n1.  $P_1(\\frac{1}{3}) - U_1 + 0 = 0 \\implies P_1 = 3 U_1$\n2.  $-(P_2 - \\tau(U_2 - U_1)) + (P_1 - \\tau U_1) = \\frac{1}{3} \\implies P_1 - P_2 - 2\\tau U_1 + \\tau U_2 = \\frac{1}{3}$\n3.  $P_2(\\frac{2}{3}) - 0 + U_1 = 0 \\implies P_2 = -\\frac{3}{2} U_1$\n4.  $-(P_2 + \\tau U_2) + (P_2 - \\tau(U_2 - U_1)) = \\frac{2}{3} \\implies \\tau U_1 - 2\\tau U_2 = \\frac{2}{3}$\n\n我们现在得到了关于四个未知数 $U_1, U_2, P_1, P_2$ 的四个线性方程组。我们可以消去 $P_1$ 和 $P_2$ 来得到关于 $U_1, U_2$ 的方程组。\n将方程(1)和(3)代入方程(2)中：\n$$ (3 U_1) - \\left(-\\frac{3}{2} U_1\\right) - 2\\tau U_1 + \\tau U_2 = \\frac{1}{3} $$\n$$ \\left(3 + \\frac{3}{2} - 2\\tau\\right) U_1 + \\tau U_2 = \\frac{1}{3} $$\n$$ \\left(\\frac{9}{2} - 2\\tau\\right) U_1 + \\tau U_2 = \\frac{1}{3} $$\n这是我们关于变量 $U$ 的第一个方程。第二个方程是方程(4)：\n$$ \\tau U_1 - 2\\tau U_2 = \\frac{2}{3} $$\n\n关于 $(U_1, U_2)$ 的 $2 \\times 2$ 线性系统是：\n$$ \\begin{pmatrix} \\frac{9}{2} - 2\\tau  & \\tau \\\\ \\tau  & -2\\tau \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix} $$\n\n我们求解这个系统以得到 $U_1$ 和 $U_2$。系数矩阵的行列式是：\n$$ D = \\left(\\frac{9}{2} - 2\\tau\\right)(-2\\tau) - (\\tau)(\\tau) = -9\\tau + 4\\tau^2 - \\tau^2 = 3\\tau^2 - 9\\tau = 3\\tau(\\tau - 3) $$\n使用克莱姆法则：\n$$ U_1 = \\frac{1}{D} \\det \\begin{pmatrix} \\frac{1}{3}  & \\tau \\\\ \\frac{2}{3}  & -2\\tau \\end{pmatrix} = \\frac{\\frac{1}{3}(-2\\tau) - \\tau(\\frac{2}{3})}{3\\tau(\\tau - 3)} = \\frac{-\\frac{2\\tau}{3} - \\frac{2\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{-\\frac{4\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{-4}{9(\\tau - 3)} = \\frac{4}{9(3 - \\tau)} $$\n$$ U_2 = \\frac{1}{D} \\det \\begin{pmatrix} \\frac{9}{2} - 2\\tau  & \\frac{1}{3} \\\\ \\tau  & \\frac{2}{3} \\end{pmatrix} = \\frac{(\\frac{9}{2} - 2\\tau)\\frac{2}{3} - \\tau(\\frac{1}{3})}{3\\tau(\\tau - 3)} = \\frac{3 - \\frac{4\\tau}{3} - \\frac{\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{3 - \\frac{5\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{\\frac{9-5\\tau}{3}}{3\\tau(\\tau - 3)} = \\frac{9 - 5\\tau}{9\\tau(\\tau - 3)} $$\n\n问题要求离散解是非负的，即 $U_1 \\ge 0$ 且 $U_2 \\ge 0$。\n条件 $U_1 \\ge 0$ 意味着：\n$$ \\frac{4}{9(3 - \\tau)} \\ge 0 $$\n由于分子 $4$ 是正数，分母必须是正数：$9(3 - \\tau) > 0$，这意味着 $3 - \\tau > 0$，所以 $\\tau < 3$。\n\n条件 $U_2 \\ge 0$ 意味着：\n$$ \\frac{9 - 5\\tau}{9\\tau(\\tau - 3)} \\ge 0 $$\n由于已知 $\\tau > 0$，分母中的项 $9\\tau$ 是正数。该不等式等价于：\n$$ \\frac{9 - 5\\tau}{\\tau - 3} \\ge 0 $$\n这个不等式可以在两种情况下成立：\n1.  $9 - 5\\tau \\ge 0$ 且 $\\tau - 3 > 0$。这得到 $\\tau \\le \\frac{9}{5}$ 且 $\\tau > 3$，这是一个矛盾。\n2.  $9 - 5\\tau \\le 0$ 且 $\\tau - 3 < 0$。这得到 $\\tau \\ge \\frac{9}{5}$ 且 $\\tau < 3$。合并后的条件是 $\\frac{9}{5} \\le \\tau < 3$。\n\n为了使 $U_1$ 和 $U_2$ 均为非负，关于 $\\tau$ 的两个条件都必须满足。我们必须找到集合 $(\\tau < 3)$ 和 $[\\frac{9}{5}, 3)$ 的交集。交集是区间 $[\\frac{9}{5}, 3)$。\n\n问题要求保证非负性的 $\\tau$ 的最小值。这就是区间 $[\\frac{9}{5}, 3)$ 中的最小值，即 $\\frac{9}{5}$。\n因此，最小罚参数是 $\\tau_{\\min} = \\frac{9}{5}$。",
            "answer": "$$\\boxed{\\frac{9}{5}}$$"
        },
        {
            "introduction": "在许多科学计算中，某个特定积分量（或称‘泛函’）的准确性比整个解的逐点误差更重要。这个高级练习深入探讨了伴随一致性的概念，这是准确进行目标导向误差估计的关键属性。本练习将使用对偶加权残差（DWR）方法，分析由一个伴随不一致的数值通量选择所导致的误差 。",
            "id": "3396365",
            "problem": "考虑区间 $\\Omega=(0,1)$ 上的标量扩散边值问题：求解 $u:\\Omega \\to \\mathbb{R}$，使得在 $\\Omega$ 内有 $-u''=f$，并满足齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。引入辅助变量 $q=u'$，得到一阶系统 $-q'=f$。设 $f(x)=\\pi^{2}\\sin(\\pi x)$，则精确解为 $u(x)=\\sin(\\pi x)$。\n\n对 $u$ 和 $q$ 均采用多项式次数为 $p=1$ 的局部间断伽辽金 (LDG) 离散，在单个单元 $K=(0,1)$ 上，即近似为 $u_{h}(x)=a_{0}+a_{1}x$ 和 $q_{h}(x)=b_{0}+b_{1}x$。对于两个物理边界 $x=0$ 和 $x=1$ 处的数值迹，选择\n- 在 $x=0$ 和 $x=1$ 处，施加狄利克雷条件的 $u$-迹为 $\\widehat{u}=0$，并且\n- 在两个边界处，通量 $\\widehat{q}=q^{-}$，即 $\\widehat{q}(0)=q_{h}(0)$ 和 $\\widehat{q}(1)=q_{h}(1)$，不含任何罚项或提升项。\n\n任务：\n1. 从一阶系统的弱形式出发，写出用单元上的常数和线性函数进行测试的 LDG 方程，并求解 $q_{h}(x)$ 的系数（用 $f$ 表示）。然后，仅使用 LDG 方程，确定离散系统所蕴含的目标泛函 $J(u_{h})=\\int_{0}^{1}u_{h}(x)\\,dx$ 的值。\n2. 通过比较连续弱形式和离散边界项，论证在狄利克雷边界上选择边界迹 $\\widehat{q}=q^{-}$ 会破坏与 $-u''$ 相关的连续对称双线性形式的伴随一致性。\n3. 设目标泛函为 $J(u)=\\int_{0}^{1}u(x)\\,dx$。使用伴随问题 $-z''=1$ 在 $(0,1)$ 上且满足 $z(0)=0$ 和 $z(1)=0$ 的精确对偶解 $z$，为此目标推导对偶加权残差恒等式。对于上述数据，以闭合形式计算最终的对偶加权残差误差 $E=J(u)-J(u_{h})$。将最终答案表示为单个精确的解析表达式。不要对任何常数进行近似。不需要单位。\n\n你的最终答案必须是单个解析表达式。如果选择数值近似，则四舍五入到四位有效数字；否则，提供精确的符号表达式。",
            "solution": "用户提出了一个关于一维扩散方程的局部间断伽辽金 (LDG) 方法的三部分问题。在验证问题陈述后，我将系统地解决每个部分。\n\n### 问题验证\n\n我首先根据要求的协议验证问题陈述。\n\n**步骤1：提取给定条件**\n- **控制方程：** $-u''=f$ 于 $\\Omega=(0,1)$ 上。\n- **边界条件：** 齐次狄利克雷，$u(0)=0$ 且 $u(1)=0$。\n- **一阶系统：** $q=u'$ 且 $-q'=f$。\n- **源项：** $f(x)=\\pi^{2}\\sin(\\pi x)$。\n- **精确解：** $u(x)=\\sin(\\pi x)$，这意味着 $q(x)=\\pi\\cos(\\pi x)$。\n- **离散化：** 在单个单元 $K=(0,1)$ 上进行 LDG，试探/检验空间为次数 $p=1$ 的多项式。\n- **近似：** $u_{h}(x)=a_{0}+a_{1}x$ 和 $q_{h}(x)=b_{0}+b_{1}x$。\n- **数值迹：**\n    - 在 $x=0$ 和 $x=1$ 处 $\\widehat{u}=0$。\n    - 在 $x=0$ 和 $x=1$ 处 $\\widehat{q}=q^{-}$，即 $\\widehat{q}(0)=q_{h}(0)$ 和 $\\widehat{q}(1)=q_{h}(1)$。\n- **任务1：** 求 $q_h(x)$ 的系数，然后用 LDG 方程计算 $J(u_{h})=\\int_{0}^{1}u_{h}(x)\\,dx$。\n- **任务2：** 论证选择 $\\widehat{q}=q^{-}$ 会破坏伴随一致性。\n- **任务3：** 对于目标泛函 $J(u)=\\int_{0}^{1}u(x)\\,dx$，使用伴随问题 $-z''=1$ 且 $z(0)=0, z(1)=0$ 推导对偶加权残差 (DWR) 恒等式。计算误差 $E=J(u)-J(u_h)$。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题在科学上和数学上是合理的。它描述了一个标准的一维泊松边值问题，这是数学物理中的一个基本模型。LDG 方法是解决此类问题的成熟数值技术。所提供的源项 $f(x)$ 与精确解 $u(x)$ 和控制方程是一致的。问题的所有组成部分（方程、边界条件、离散化选择、数值通量）都得到了清晰客观的定义。这些任务是具体的、可形式化的，并且涉及间断伽辽金方法分析中的核心概念，即求解离散系统、理解伴随一致性以及应用 DWR 误差估计。该问题是适定的和自洽的。\n\n**步骤3：结论与行动**\n问题有效。我将继续进行完整解答。\n\n### 解答\n\n**第1部分：LDG 系统与目标泛函计算**\n\n单元 $K=(0,1)$ 上一阶系统的弱形式为：求解 $(u_h, q_h) \\in (P^1(K))^2$，使得对于所有检验函数 $(v_h, w_h) \\in (P^1(K))^2$：\n$$\n\\int_0^1 q_h v_h \\,dx = \\int_0^1 u' v_h \\,dx = [u_h v_h]_0^1 - \\int_0^1 u_h v_h' \\,dx\n$$\n$$\n\\int_0^1 (-q') w_h \\,dx = \\int_0^1 f w_h \\,dx \\implies [q w_h]_0^1 - \\int_0^1 q w_h' \\,dx = -\\int_0^1 f w_h \\,dx\n$$\nLDG 形式是通过将边界项中的迹 $u$ 和 $q$ 替换为数值迹 $\\widehat{u}$ 和 $\\widehat{q}$ 得到的：\n1.  $\\int_0^1 q_h v_h \\,dx + \\int_0^1 u_h v_h' \\,dx - [\\widehat{u} v_h]_0^1 = 0$\n2.  $\\int_0^1 q_h w_h' \\,dx - [\\widehat{q} w_h]_0^1 = \\int_0^1 f w_h \\,dx$\n\n我们使用基函数 $\\{1, x\\}$ 作为检验函数 $v_h$ 和 $w_h$。我们有 $u_h(x)=a_0+a_1x$ 和 $q_h(x)=b_0+b_1x$。数值迹为 $\\widehat{u}(0)=0, \\widehat{u}(1)=0$ 以及 $\\widehat{q}(0)=q_h(0)=b_0, \\widehat{q}(1)=q_h(1)=b_0+b_1$。\n\n从第二个 LDG 方程：\n- 用 $w_h=1$ ($w_h'=0$) 进行检验：\n$$\n\\int_0^1 q_h(0) \\,dx - [\\widehat{q}(1) \\cdot 1 - \\widehat{q}(0) \\cdot 1] = \\int_0^1 f(x) \\cdot 1 \\,dx\n$$\n$$\n0 - ((b_0+b_1) - b_0) = \\int_0^1 \\pi^2 \\sin(\\pi x) \\,dx\n$$\n$$\n-b_1 = \\pi^2 \\left[-\\frac{1}{\\pi}\\cos(\\pi x)\\right]_0^1 = -\\pi(\\cos(\\pi)-\\cos(0)) = -\\pi(-1-1) = 2\\pi\n$$\n因此，$b_1 = -2\\pi$。\n\n- 用 $w_h=x$ ($w_h'=1$) 进行检验：\n$$\n\\int_0^1 q_h(x) \\cdot 1 \\,dx - [\\widehat{q}(1) \\cdot 1 - \\widehat{q}(0) \\cdot 0] = \\int_0^1 f(x) x \\,dx\n$$\n$$\n\\int_0^1 (b_0+b_1x) \\,dx - (b_0+b_1) = \\int_0^1 x \\pi^2 \\sin(\\pi x) \\,dx\n$$\n$$\n(b_0 + \\frac{b_1}{2}) - (b_0+b_1) = -\\frac{b_1}{2} = \\pi^2 \\int_0^1 x \\sin(\\pi x) \\,dx\n$$\n积分为 $\\int_0^1 x \\sin(\\pi x) \\,dx = \\left[-\\frac{x}{\\pi}\\cos(\\pi x) + \\frac{1}{\\pi^2}\\sin(\\pi x)\\right]_0^1 = \\frac{1}{\\pi}$。\n所以，$-\\frac{b_1}{2} = \\pi^2(\\frac{1}{\\pi}) = \\pi$，这也得到 $b_1 = -2\\pi$。关于 $b_1$ 的方程是一致的。\n\n现在我们使用第一个 LDG 方程来找到 $b_0$ 的关系。\n- 用 $v_h=1$ ($v_h'=0$) 进行检验：\n$$\n\\int_0^1 q_h(x) \\cdot 1 \\,dx + \\int_0^1 u_h(x) \\cdot 0 \\,dx - [\\widehat{u}(1)\\cdot 1 - \\widehat{u}(0)\\cdot 1] = 0\n$$\n$$\n\\int_0^1 (b_0+b_1x) \\,dx - [0-0] = 0 \\implies b_0 + \\frac{b_1}{2} = 0\n$$\n代入 $b_1=-2\\pi$，我们得到 $b_0 - \\pi = 0$，所以 $b_0 = \\pi$。\n$q_h(x)$ 的系数是 $b_0=\\pi$ 和 $b_1=-2\\pi$，所以 $q_h(x) = \\pi - 2\\pi x$。\n\n为了求目标泛函 $J(u_h) = \\int_0^1 u_h(x)\\,dx$，我们使用第一个 LDG 方程，并令 $v_h=x$ ($v_h'=1$)：\n$$\n\\int_0^1 q_h(x) x \\,dx + \\int_0^1 u_h(x) \\cdot 1 \\,dx - [\\widehat{u}(1)\\cdot 1 - \\widehat{u}(0)\\cdot 0] = 0\n$$\n$$\n\\int_0^1 (b_0+b_1x)x \\,dx + J(u_h) - 0 = 0\n$$\n$$\nJ(u_h) = - \\int_0^1 (b_0x+b_1x^2) \\,dx = - \\left[ b_0\\frac{x^2}{2} + b_1\\frac{x^3}{3} \\right]_0^1 = -(\\frac{b_0}{2} + \\frac{b_1}{3})\n$$\n代入 $b_0$ 和 $b_1$ 的值：\n$$\nJ(u_h) = -(\\frac{\\pi}{2} + \\frac{-2\\pi}{3}) = -(\\frac{3\\pi-4\\pi}{6}) = -(-\\frac{\\pi}{6}) = \\frac{\\pi}{6}.\n$$\n\n**第2部分：伴随不一致性**\n\n伴随一致性关系到离散格式是否保持连续算子的自伴随性。带有齐次狄利克雷边界条件的连续算子 $-d^2/dx^2$ 是自伴随的。它的弱形式基于对称双线性形式 $B(u,v)=\\int_0^1 u'v' \\,dx$。\n对称性 $B(u,v)=B(v,u)$ 是显而易见的。\n\n在 LDG 格式中，项 $\\int_K u'v' \\,dx$ 被有效地替换为一个涉及辅助变量 $q \\approx u'$ 的方程组。单元之间（或在边界处）的信息传递由数值通量处理。为了使格式是自伴随的，由分部积分产生的总边界项必须在交换试探函数 $(u_h, q_h)$ 和检验函数 $(v_h, w_h)$ 时是对称的。\n\nLDG 格式中的边界项由数值迹 $[\\widehat{u} v_h]$ 和 $[\\widehat{q} w_h]$ 驱动。在狄利克雷边界处，辅助变量通量的选择是 $\\widehat{q}=q^-$。这意味着通量*完全*由单元内部的值确定，忽略了任何来自外部的信息（在伴随问题中，这会与检验函数相关）。这是一种单边或迎风的通量选择。\n\n众所周知，这种单边通量会破坏底层双线性形式的对称性。连续形式 $B(u,v)$ 的对称性源于微分和分部积分是中性操作这一事实。通过选择一个有方向的通量 $\\widehat{q}=q^-$，我们为离散系统引入了一个特定的信息流方向。伴随算子将需要一个相反方向的信息流（即，对于伴随通量有 $\\widehat{p}=p^+$）。由于原始通量和伴随通量的选择彼此不对称，因此得到的离散算子不是自伴随的。因此，该格式相对于原始的自伴随连续算子不是伴随一致的。\n\n**第3部分：对偶加权残差误差计算**\n\n目标是计算泛函中的误差 $E = J(u)-J(u_h)$。泛函为 $J(w) = \\int_0^1 w(x)\\,dx$。此泛函的对偶或伴随问题是求解 $z$，使得 $L^*z = g_J$，其中 $L^*$ 是伴随算子，$g_J$ 是 $J$ 的里兹表示。对于算子 $-d^2/dx^2$，$L^*=L$，且 $J(w)=\\int w \\cdot 1 \\,dx$。因此对偶问题是在 $\\Omega=(0,1)$ 内 $-z''=1$，并带有齐次边界条件 $z(0)=0, z(1)=0$。\n\nDWR 恒等式将泛函中的误差与由对偶解加权的控制方程的残差联系起来。推导精确误差表示的一种直接方法是使用对偶问题：\n$$\nE = J(u) - J(u_h) = \\int_0^1 u(x) \\cdot 1 \\,dx - J(u_h)\n$$\n使用对偶问题方程 $1 = -z''$：\n$$\nE = \\int_0^1 u(x)(-z''(x)) \\,dx - J(u_h)\n$$\n我们进行两次分部积分。由于 $u$ 和 $z$ 均满足齐次边界条件，边界项消失。\n$$\n\\int_0^1 u(-z'') \\,dx = \\left[-u z'\\right]_0^1 + \\int_0^1 u' z' \\,dx = \\int_0^1 u' z' \\,dx\n$$\n$$\n\\int_0^1 u' z' \\,dx = \\left[u' z\\right]_0^1 - \\int_0^1 u'' z \\,dx = \\int_0^1 (-u'')z \\,dx\n$$\n由于 $-u'' = f$，我们得到恒等式：\n$$\nE = \\int_0^1 f(x) z(x) \\,dx - J(u_h)\n$$\n该恒等式将泛函 $J(u_h)$ 中的误差表示为目标泛函应用于源项 $f$（由对偶解 $z$ 加权）与泛函 $J(u_h)$ 的计算值之间的差。\n\n我们现在计算这个表达式。\n从第1部分，我们有 $J(u_h) = \\frac{\\pi}{6}$。\n我们需要求出 $z(x)$，然后计算积分。\n对偶问题是 $-z''=1$, $z(0)=0, z(1)=0$。\n积分一次：$z'(x) = -x+C_1$。\n再积分一次：$z(x) = -\\frac{x^2}{2} + C_1 x + C_2$。\n应用边界条件：\n$z(0)=0 \\implies C_2 = 0$。\n$z(1)=0 \\implies -\\frac{1}{2} + C_1 = 0 \\implies C_1 = \\frac{1}{2}$。\n因此，精确对偶解是 $z(x) = \\frac{1}{2}(x-x^2)$。\n\n现在，我们计算积分项 $\\int_0^1 f(x) z(x) \\,dx$：\n$$\n\\int_0^1 \\pi^2 \\sin(\\pi x) \\frac{1}{2}(x-x^2) \\,dx = \\frac{\\pi^2}{2} \\left( \\int_0^1 x \\sin(\\pi x) \\,dx - \\int_0^1 x^2 \\sin(\\pi x) \\,dx \\right)\n$$\n第一个积分已在第1部分计算过：$\\int_0^1 x \\sin(\\pi x) \\,dx = \\frac{1}{\\pi}$。\n第二个积分通过两次分部积分计算：\n$$\n\\int x^2 \\sin(\\pi x) \\,dx = x^2(-\\frac{\\cos(\\pi x)}{\\pi}) - \\int 2x(-\\frac{\\cos(\\pi x)}{\\pi}) \\,dx\n$$\n$$\n= -\\frac{x^2}{\\pi}\\cos(\\pi x) + \\frac{2}{\\pi} \\left( x\\frac{\\sin(\\pi x)}{\\pi} - \\int \\frac{\\sin(\\pi x)}{\\pi} \\,dx \\right)\n$$\n$$\n= -\\frac{x^2}{\\pi}\\cos(\\pi x) + \\frac{2x}{\\pi^2}\\sin(\\pi x) + \\frac{2}{\\pi^3}\\cos(\\pi x)\n$$\n从 $0$ 到 $1$ 求值：\n$$\n\\left[ \\dots \\right]_0^1 = \\left( -\\frac{1}{\\pi}\\cos(\\pi) + 0 + \\frac{2}{\\pi^3}\\cos(\\pi) \\right) - \\left( 0 + 0 + \\frac{2}{\\pi^3}\\cos(0) \\right)\n$$\n$$\n= \\left( \\frac{1}{\\pi} - \\frac{2}{\\pi^3} \\right) - \\frac{2}{\\pi^3} = \\frac{1}{\\pi} - \\frac{4}{\\pi^3}\n$$\n代回到主表达式中：\n$$\n\\int_0^1 f(x) z(x) \\,dx = \\frac{\\pi^2}{2} \\left( \\frac{1}{\\pi} - \\left(\\frac{1}{\\pi} - \\frac{4}{\\pi^3}\\right) \\right) = \\frac{\\pi^2}{2} \\left( \\frac{4}{\\pi^3} \\right) = \\frac{2}{\\pi}\n$$\n注意，这正是泛函 $J(u) = \\int_0^1 \\sin(\\pi x) \\,dx = [-\\frac{1}{\\pi}\\cos(\\pi x)]_0^1 = \\frac{2}{\\pi}$ 的精确值。\n\n最后，误差 $E$ 为：\n$$\nE = \\int_0^1 f(x) z(x) \\,dx - J(u_h) = \\frac{2}{\\pi} - \\frac{\\pi}{6}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{\\pi} - \\frac{\\pi}{6}}\n$$"
        }
    ]
}