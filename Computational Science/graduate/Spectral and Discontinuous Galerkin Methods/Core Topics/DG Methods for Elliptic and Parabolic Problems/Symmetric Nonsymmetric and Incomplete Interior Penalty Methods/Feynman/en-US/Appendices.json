{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, we begin with a direct calculation of the different interior penalty bilinear forms. This exercise provides a concrete application of the theoretical formulas for Symmetric (SIPG), Nonsymmetric (NIPG), and Incomplete (IIPG) Interior Penalty methods, helping to demystify the roles of the jump and average operators. By working through this simple one-dimensional example, you will develop a hands-on feel for how the parameter $\\theta$ alters the structure of the discrete system .",
            "id": "3422664",
            "problem": "Consider the one-dimensional Poisson equation on the domain $\\Omega = [0,1]$ with homogeneous Neumann boundary conditions, discretized by a Discontinuous Galerkin (DG) method using a uniform mesh with two elements $K_{1} = [0,\\tfrac{1}{2}]$ and $K_{2} = [\\tfrac{1}{2},1]$. Let the polynomial degree be one on each element, and define the trial and test functions $u_{h}$ and $v_{h}$ by\n$$\nu_{h}(x) = \\begin{cases}\nx & \\text{for } x \\in K_{1}, \\\\\n0 & \\text{for } x \\in K_{2},\n\\end{cases}\n\\qquad\nv_{h}(x) = \\begin{cases}\n1 & \\text{for } x \\in K_{1}, \\\\\nx & \\text{for } x \\in K_{2}.\n\\end{cases}\n$$\nLet the outward unit normal for $K_{1}$ at $x=\\tfrac{1}{2}$ be $n^{-}=+1$ and for $K_{2}$ at $x=\\tfrac{1}{2}$ be $n^{+}=-1$. For a scalar function $w$, define the jump as $[w] = w^{-} - w^{+}$ at the interior face $e=\\{ \\tfrac{1}{2} \\}$, and the average of the normal derivative as\n$$\n\\{ \\partial_{n} w \\} = \\frac{ \\nabla w^{-} \\cdot n^{-} + \\nabla w^{+} \\cdot n^{+} }{2}.\n$$\nStarting from the elementwise integration by parts and the definition of numerical fluxes, derive the interior-penalty DG bilinear form\n$$\na_{\\theta}(u_{h},v_{h}) = \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\, dx \\;-\\; \\sum_{e} \\left( \\{ \\partial_{n} u_{h} \\} [v_{h}] + \\theta \\, \\{ \\partial_{n} v_{h} \\} [u_{h}] \\right) \\;+\\; \\sum_{e} \\frac{\\sigma}{h_{e}} \\, [u_{h}] [v_{h}],\n$$\nwhere the sum over $e$ runs over interior faces, $h_{e}$ is the local face size defined as the harmonic average of adjacent element sizes (which equals $h_{e} = \\tfrac{1}{2}$ for the given mesh), and $\\sigma$ is a positive penalty parameter. In this one-dimensional setting, interpret the face integral as the evaluation at the face point. The three classical interior penalty variants are obtained by choosing $\\theta$ as follows: symmetric interior penalty Galerkin (SIPG) with $\\theta=1$, nonsymmetric interior penalty Galerkin (NIPG) with $\\theta=-1$, and incomplete interior penalty Galerkin (IIPG) with $\\theta=0$.\n\nUsing the above definitions and choices, evaluate the linear combination\n$$\nL \\;=\\; a_{\\text{SIPG}}(u_{h},v_{h}) \\;+\\; 2\\,a_{\\text{NIPG}}(u_{h},v_{h}) \\;+\\; 3\\,a_{\\text{IIPG}}(u_{h},v_{h}),\n$$\nfor the penalty parameter $\\sigma = 3$ and $h_{e} = \\tfrac{1}{2}$, where $a_{\\text{SIPG}}$, $a_{\\text{NIPG}}$, and $a_{\\text{IIPG}}$ denote $a_{\\theta}$ evaluated at $\\theta=1$, $\\theta=-1$, and $\\theta=0$, respectively. Express your final answer exactly as a rational number.",
            "solution": "We are asked to compute the linear combination $L = a_{\\text{SIPG}}(u_{h},v_{h}) + 2\\,a_{\\text{NIPG}}(u_{h},v_{h}) + 3\\,a_{\\text{IIPG}}(u_{h},v_{h})$. First, we will evaluate the general bilinear form $a_{\\theta}(u_{h},v_{h})$ for the given functions and parameters.\n\nThe trial and test functions and their derivatives are:\n- On $K_{1} = [0, \\tfrac{1}{2}]$: $u_h(x) = x$, $\\nabla u_h = 1$; $v_h(x) = 1$, $\\nabla v_h = 0$.\n- On $K_{2} = [\\tfrac{1}{2}, 1]$: $u_h(x) = 0$, $\\nabla u_h = 0$; $v_h(x) = x$, $\\nabla v_h = 1$.\n\nAt the interior face $x = \\frac{1}{2}$, the traces from the left ($^-$ from $K_1$) and right ($^+$ from $K_2$) are:\n- $u_h^{-} = \\frac{1}{2}$, $u_h^{+} = 0$.\n- $v_h^{-} = 1$, $v_h^{+} = \\frac{1}{2}$.\n- $\\nabla u_h^{-} = 1$, $\\nabla u_h^{+} = 0$.\n- $\\nabla v_h^{-} = 0$, $\\nabla v_h^{+} = 1$.\n\nUsing the outward normals $n^{-} = +1$ and $n^{+} = -1$, we compute the jumps and averages:\n- Jump of $u_h$: $[u_h] = u_h^{-} - u_h^{+} = \\frac{1}{2} - 0 = \\frac{1}{2}$.\n- Jump of $v_h$: $[v_h] = v_h^{-} - v_h^{+} = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n- Average of $\\partial_n u_h$: $\\{ \\partial_{n} u_{h} \\} = \\frac{ \\nabla u_{h}^{-} \\cdot n^{-} + \\nabla u_{h}^{+} \\cdot n^{+} }{2} = \\frac{(1)(1) + (0)(-1)}{2} = \\frac{1}{2}$.\n- Average of $\\partial_n v_h$: $\\{ \\partial_{n} v_{h} \\} = \\frac{ \\nabla v_{h}^{-} \\cdot n^{-} + \\nabla v_{h}^{+} \\cdot n^{+} }{2} = \\frac{(0)(1) + (1)(-1)}{2} = -\\frac{1}{2}$.\n\nNow we evaluate the three components of the bilinear form $a_{\\theta}(u_{h},v_{h})$:\n1.  **Volume integral:**\n    $$ \\sum_{K} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\, dx = \\int_{K_1} (1)(0) \\, dx + \\int_{K_2} (0)(1) \\, dx = 0. $$\n2.  **Flux term (evaluated at the single interior face $e = \\{ \\frac{1}{2} \\}$):**\n    $$ - \\left( \\{ \\partial_{n} u_{h} \\} [v_{h}] + \\theta \\, \\{ \\partial_{n} v_{h} \\} [u_{h}] \\right) = - \\left( \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\theta \\left(-\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) \\right) = - \\left( \\frac{1}{4} - \\frac{\\theta}{4} \\right) = \\frac{\\theta-1}{4}. $$\n3.  **Penalty term (with $\\sigma = 3$ and $h_e = \\frac{1}{2}$):**\n    $$ \\frac{\\sigma}{h_{e}} \\, [u_{h}] [v_{h}] = \\frac{3}{1/2} \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 6 \\cdot \\frac{1}{4} = \\frac{3}{2}. $$\n\nCombining these terms gives the general bilinear form:\n$$ a_{\\theta}(u_{h},v_{h}) = 0 + \\frac{\\theta-1}{4} + \\frac{3}{2}. $$\n\nNext, we evaluate this for the specific choices of $\\theta$:\n- $a_{\\text{SIPG}}(u_h,v_h)$ for $\\theta=1$: $a_{1} = \\frac{1-1}{4} + \\frac{3}{2} = \\frac{3}{2}$.\n- $a_{\\text{NIPG}}(u_h,v_h)$ for $\\theta=-1$: $a_{-1} = \\frac{-1-1}{4} + \\frac{3}{2} = -\\frac{2}{4} + \\frac{3}{2} = -\\frac{1}{2} + \\frac{3}{2} = 1$.\n- $a_{\\text{IIPG}}(u_h,v_h)$ for $\\theta=0$: $a_{0} = \\frac{0-1}{4} + \\frac{3}{2} = -\\frac{1}{4} + \\frac{6}{4} = \\frac{5}{4}$.\n\nFinally, we compute the linear combination $L$:\n$$ L = a_{\\text{SIPG}} + 2\\,a_{\\text{NIPG}} + 3\\,a_{\\text{IIPG}} = \\frac{3}{2} + 2(1) + 3\\left(\\frac{5}{4}\\right) $$\n$$ L = \\frac{3}{2} + 2 + \\frac{15}{4} = \\frac{6}{4} + \\frac{8}{4} + \\frac{15}{4} = \\frac{6+8+15}{4} = \\frac{29}{4}. $$",
            "answer": "$$\\boxed{\\frac{29}{4}}$$"
        },
        {
            "introduction": "Having practiced the basic mechanics, we now delve into the \"why\" behind the specific definitions used in interior penalty methods. This problem demonstrates a crucial concept: adjoint consistency, which ensures that the numerical method properly relates to the original differential operator. You will construct a counterexample to show how a seemingly intuitive but \"naive\" definition of the jump operator can violate this property, leading to an incorrect formulation .",
            "id": "3422725",
            "problem": "Consider the scalar diffusion problem in one spatial dimension on the open interval $\\Omega=(0,1)$ with the strong form $-u''=f$. Let the mesh $\\mathcal{T}_h$ consist of $2$ elements, $K_1=(0,\\tfrac{1}{2})$ and $K_2=(\\tfrac{1}{2},1)$, with the unique interior face $F=\\{\\tfrac{1}{2}\\}$. For a function $v$ with traces $v_{-}$ from $K_1$ and $v_{+}$ from $K_2$, define the oriented average and jump by $\\{v'\\}=\\tfrac{1}{2}(v'_{-}+v'_{+})$ and $[v]=v_{-}n^{-}+v_{+}n^{+}$, where the outward unit normals satisfy $n^{-}=+1$ on the right boundary of $K_1$ and $n^{+}=-1$ on the left boundary of $K_2$. The Nonsymmetric Interior Penalty Galerkin (NIPG) bilinear form for the model diffusion operator, using correct orientation, is\n$$\na_{\\mathrm{NIPG}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]\\,\\mathrm{d}s+\\int_{F}\\{w'\\}\\,[u]\\,\\mathrm{d}s+\\int_{F}\\frac{\\sigma}{h_F}[u][w]\\,\\mathrm{d}s,\n$$\nwith penalty parameter $\\sigma>0$ and face size $h_F$. In the exact-solution consistency check, when $u$ is sufficiently smooth across $F$, one has $[u]=0$, so the last two terms vanish.\n\nNow replace the oriented jump by the naive choice that ignores the sign of the outward normal and sets both normals to $+1$, i.e.,\n$$\n[w]_{\\mathrm{naive}}=w_{-}+w_{+}.\n$$\nKeep the oriented average $\\{u'\\}$ as above, and define the naive NIPG bilinear form by\n$$\na_{\\mathrm{naive}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s.\n$$\n\nLet $u(x)=x-x^{3}$, so that $f(x)=-u''(x)=6x$, and choose the test function $w(x)=x(1-x)$. Both $u$ and $w$ are $C^{\\infty}$ on $\\Omega$, and $w(0)=w(1)=0$. Define the adjoint-consistency defect\n$$\nD(u,w)=a_{\\mathrm{naive}}(u,w)-\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x.\n$$\nCompute $D(u,w)$ exactly for this two-element mesh. Your final answer must be a single real number. No rounding is required.",
            "solution": "The user-provided problem statement is valid. It is scientifically grounded in the theory of Discontinuous Galerkin methods, well-posed with all necessary information provided, and objective in its phrasing. We can therefore proceed to a solution.\n\nThe problem asks for the computation of the adjoint-consistency defect, defined as\n$$\nD(u,w) = a_{\\mathrm{naive}}(u,w) - \\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x.\n$$\nWe will compute the two terms on the right-hand side separately.\n\nThe naive bilinear form is given by\n$$\na_{\\mathrm{naive}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s.\n$$\nThe first term is the sum of integrals over the elements $K_1=(0,\\frac{1}{2})$ and $K_2=(\\frac{1}{2},1)$, which can be combined into a single integral over the domain $\\Omega=(0,1)$ since the integrand is well-defined across the element boundary.\n$$\n\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x = \\int_{0}^{1}u'(x)w'(x)\\,\\mathrm{d}x.\n$$\nThe functions $u(x)$ and $w(x)$ are given as $u(x)=x-x^3$ and $w(x)=x(1-x)=x-x^2$. Their first derivatives are:\n$$\nu'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(x-x^3) = 1 - 3x^2,\n$$\n$$\nw'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(x-x^2) = 1 - 2x.\n$$\nWe can now compute the integral of their product:\n$$\n\\int_{0}^{1}u'(x)w'(x)\\,\\mathrm{d}x = \\int_{0}^{1}(1-3x^2)(1-2x)\\,\\mathrm{d}x = \\int_{0}^{1}(1 - 2x - 3x^2 + 6x^3)\\,\\mathrm{d}x.\n$$\nEvaluating the integral gives:\n$$\n\\left[x - \\frac{2x^2}{2} - \\frac{3x^3}{3} + \\frac{6x^4}{4}\\right]_{0}^{1} = \\left[x - x^2 - x^3 + \\frac{3}{2}x^4\\right]_{0}^{1} = \\left(1 - 1 - 1 + \\frac{3}{2}\\right) - 0 = \\frac{1}{2}.\n$$\nNext, we evaluate the face integral term $-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s$. The interior face $F$ is the point $x=\\frac{1}{2}$. In one dimension, an integral over a point face is simply the evaluation of the integrand at that point. Thus,\n$$\n\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s = \\left(\\{u'\\}\\,[w]_{\\mathrm{naive}}\\right)\\Big|_{x=\\frac{1}{2}}.\n$$\nWe need to compute the average $\\{u'\\}$ and the naive jump $[w]_{\\mathrm{naive}}$ at $x=\\frac{1}{2}$. Since $u(x)$ is a smooth polynomial, its derivative $u'(x)$ is continuous across the face, so the traces from the left ($K_1$) and right ($K_2$) are equal:\n$$\nu'_{-} = u'\\left(\\frac{1}{2}\\right) = 1 - 3\\left(\\frac{1}{2}\\right)^2 = 1 - \\frac{3}{4} = \\frac{1}{4},\n$$\n$$\nu'_{+} = u'\\left(\\frac{1}{2}\\right) = \\frac{1}{4}.\n$$\nThe average is then\n$$\n\\{u'\\} = \\frac{1}{2}(u'_{-} + u'_{+}) = \\frac{1}{2}\\left(\\frac{1}{4} + \\frac{1}{4}\\right) = \\frac{1}{4}.\n$$\nSimilarly, the function $w(x)$ is continuous, so its traces are equal:\n$$\nw_{-} = w\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1-\\frac{1}{2}\\right) = \\frac{1}{4},\n$$\n$$\nw_{+} = w\\left(\\frac{1}{2}\\right) = \\frac{1}{4}.\n$$\nThe naive jump is defined as $[w]_{\\mathrm{naive}} = w_{-} + w_{+}$:\n$$\n[w]_{\\mathrm{naive}} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}.\n$$\nNow we compute the value of the face integral term:\n$$\n-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s = -\\{u'\\}\\,[w]_{\\mathrm{naive}} = -\\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) = -\\frac{1}{8}.\n$$\nCombining the volume and face terms to find $a_{\\mathrm{naive}}(u,w)$:\n$$\na_{\\mathrm{naive}}(u,w) = \\frac{1}{2} - \\frac{1}{8} = \\frac{4}{8} - \\frac{1}{8} = \\frac{3}{8}.\n$$\nThe second part of the defect calculation is the integral $\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x$. The source term $f(x)$ is given by $f(x) = -u''(x)$.\n$$\nu''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1-3x^2) = -6x,\n$$\nso $f(x) = -(-6x) = 6x$.\nThe integral is:\n$$\n\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x = \\int_{0}^{1}(6x)(x-x^2)\\,\\mathrm{d}x = \\int_{0}^{1}(6x^2 - 6x^3)\\,\\mathrm{d}x.\n$$\nEvaluating this integral yields:\n$$\n\\left[\\frac{6x^3}{3} - \\frac{6x^4}{4}\\right]_{0}^{1} = \\left[2x^3 - \\frac{3}{2}x^4\\right]_{0}^{1} = \\left(2 - \\frac{3}{2}\\right) - 0 = \\frac{1}{2}.\n$$\nFinally, we compute the adjoint-consistency defect $D(u,w)$ by subtracting the second result from the first:\n$$\nD(u,w) = a_{\\mathrm{naive}}(u,w) - \\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x = \\frac{3}{8} - \\frac{1}{2} = \\frac{3}{8} - \\frac{4}{8} = -\\frac{1}{8}.\n$$",
            "answer": "$$\n\\boxed{-\\frac{1}{8}}\n$$"
        },
        {
            "introduction": "Finally, we turn our attention to a critical aspect of practical implementation: handling boundary conditions. This exercise demonstrates the elegance with which the SIPG formulation incorporates non-homogeneous Dirichlet boundary data, a common task in solving real-world problems. By deriving the explicit contributions to the local load vector on boundary elements, you will gain insight into a fundamental step in assembling the global linear system in a discontinuous Galerkin code .",
            "id": "3422733",
            "problem": "Consider the stationary diffusion problem on a one-dimensional domain with nonhomogeneous Dirichlet boundary conditions: find a sufficiently smooth function $u$ such that\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = g_L, \\quad u(1) = g_R,\n$$\nwhere $f$ is a given source and $g_L, g_R$ are prescribed boundary data. Discretize $(0,1)$ by a uniform mesh of $N \\geq 2$ affine elements of size $h = 1/N$. On each element, use a polynomial space of degree $p=2$ represented in a nodal basis given by the three Gaussâ€“Legendre quadrature nodes on the reference element $[-1,1]$, namely $\\xi_1 = -\\sqrt{3/5}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{3/5}$, and the associated Lagrange basis functions $\\{\\ell_i(\\xi)\\}_{i=1}^3$. Adopt the Symmetric Interior Penalty Galerkin (SIPG) formulation for diffusion with constant diffusion coefficient $1$ and a penalty parameter $\\sigma > 0$, using the standard outward unit normals at boundary points ($n(0) = -1$, $n(1) = +1$).\n\nStarting from the definition of the discontinuous Galerkin method via elementwise integration by parts and numerical fluxes, derive the explicit boundary contributions to the local load vectors that arise solely from the nonhomogeneous Dirichlet boundary data $g_L$ and $g_R$ on the first and last elements, respectively. Assume that:\n- mapping from the reference coordinate $\\xi \\in [-1,1]$ to a boundary element $K$ is affine, $x = x_K + \\frac{h}{2}\\,\\xi$, so that $\\frac{d\\xi}{dx} = \\frac{2}{h}$,\n- only boundary terms are required (ignore the volume source $f$ and all interior-face contributions),\n- the SIPG linear functional contribution on a boundary face $\\partial K \\cap \\partial\\Omega$ is\n$$\n\\int_{\\partial K \\cap \\partial\\Omega} \\left( \\partial_n v_h \\, g + \\frac{\\sigma}{h} \\, g\\, v_h \\right) \\, ds,\n$$\nwhere $v_h$ is a local test function and $\\partial_n v_h = n\\, \\frac{dv_h}{dx}$.\n\nLet $g(0) = g_L$ and $g(1) = g_R$. Using the above nodal basis on each boundary element (leftmost and rightmost elements), compute the three entries of the local load vector contributed by the boundary data at $x=0$ and the three entries at $x=1$. Express your final answer in closed form in terms of $g_L$, $g_R$, $h$, $\\sigma$, and $\\sqrt{3/5}$, in the following order:\n$$\n\\bigl[\\, \\text{left element entry }1,\\ \\text{left element entry }2,\\ \\text{left element entry }3,\\ \\text{right element entry }1,\\ \\text{right element entry }2,\\ \\text{right element entry }3 \\,\\bigr].\n$$\nProvide your answer as a single row vector as specified. No numerical rounding is required.",
            "solution": "The task is to find the contributions to the local load vectors from nonhomogeneous Dirichlet boundary conditions in a Symmetric Interior Penalty Galerkin (SIPG) discretization of a 1D diffusion problem. The local load vector $\\mathbf{b}_K$ for an element $K$ has entries $b_{K,i} = L(\\phi_i)$, where $\\phi_i$ are the local basis functions and $L(\\cdot)$ is the linear functional part of the weak form. We are interested only in the contributions from the nonhomogeneous Dirichlet boundaries.\n\nThe basis functions on the reference element $\\xi \\in [-1,1]$ are the Lagrange polynomials of degree $2$ for the nodes $\\xi_1 = -\\sqrt{3/5}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{3/5}$. Their derivatives are:\n- $\\ell_1(\\xi) = \\frac{5}{6}\\left(\\xi^2 - \\xi\\sqrt{\\frac{3}{5}}\\right) \\implies \\frac{d\\ell_1}{d\\xi} = \\frac{5}{6}\\left(2\\xi - \\sqrt{\\frac{3}{5}}\\right)$\n- $\\ell_2(\\xi) = 1 - \\frac{5}{3}\\xi^2 \\implies \\frac{d\\ell_2}{d\\xi} = -\\frac{10}{3}\\xi$\n- $\\ell_3(\\xi) = \\frac{5}{6}\\left(\\xi^2 + \\xi\\sqrt{\\frac{3}{5}}\\right) \\implies \\frac{d\\ell_3}{d\\xi} = \\frac{5}{6}\\left(2\\xi + \\sqrt{\\frac{3}{5}}\\right)$\n\nThe derivative of a test function $v_h(x) = \\ell_i(\\xi(x))$ with respect to $x$ is $\\frac{dv_h}{dx} = \\frac{d\\ell_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{2}{h} \\frac{d\\ell_i}{d\\xi}$.\n\n**Contribution from the Left Boundary ($x=0$)**\nThis affects the first element, $K_1 = [0, h]$. The boundary point $x=0$ maps to $\\xi = -1$. The outward normal is $n(0) = -1$. The boundary data is $g_L$. In 1D, the integral $\\int ds$ is a point evaluation. The contribution to the $i$-th entry of the local load vector is:\n$$ b_{1,i} = g_L \\left( n(0) \\frac{dv_h}{dx}(0) + \\frac{\\sigma}{h} v_h(0) \\right)\\bigg|_{v_h=\\phi_i} = g_L \\left( -\\frac{2}{h} \\frac{d\\ell_i}{d\\xi}(-1) + \\frac{\\sigma}{h} \\ell_i(-1) \\right) $$\nWe evaluate the basis functions and their derivatives at $\\xi=-1$:\n- $\\ell_1(-1) = \\frac{5}{6}(1+\\sqrt{3/5})$, $\\ell_2(-1) = -2/3$, $\\ell_3(-1) = \\frac{5}{6}(1-\\sqrt{3/5})$\n- $\\frac{d\\ell_1}{d\\xi}(-1) = \\frac{5}{6}(-2-\\sqrt{3/5})$, $\\frac{d\\ell_2}{d\\xi}(-1) = 10/3$, $\\frac{d\\ell_3}{d\\xi}(-1) = \\frac{5}{6}(-2+\\sqrt{3/5})$\nThe three entries are:\n- $b_{1,1} = \\frac{g_L}{h} \\left[ -2\\left(\\frac{5}{6}(-2-\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1+\\sqrt{3/5})\\right) \\right] = \\frac{5g_L}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n- $b_{1,2} = \\frac{g_L}{h} \\left[ -2\\left(\\frac{10}{3}\\right) + \\sigma\\left(-\\frac{2}{3}\\right) \\right] = -\\frac{2g_L}{3h}(10+\\sigma)$\n- $b_{1,3} = \\frac{g_L}{h} \\left[ -2\\left(\\frac{5}{6}(-2+\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1-\\sqrt{3/5})\\right) \\right] = \\frac{5g_L}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n\n**Contribution from the Right Boundary ($x=1$)**\nThis affects the last element, $K_N = [1-h, 1]$. The boundary point $x=1$ maps to $\\xi = +1$. The outward normal is $n(1) = +1$. The boundary data is $g_R$.\n$$ b_{N,i} = g_R \\left( n(1) \\frac{dv_h}{dx}(1) + \\frac{\\sigma}{h} v_h(1) \\right)\\bigg|_{v_h=\\phi_i} = g_R \\left( \\frac{2}{h} \\frac{d\\ell_i}{d\\xi}(1) + \\frac{\\sigma}{h} \\ell_i(1) \\right) $$\nWe evaluate the basis functions and their derivatives at $\\xi=+1$:\n- $\\ell_1(1) = \\frac{5}{6}(1-\\sqrt{3/5})$, $\\ell_2(1) = -2/3$, $\\ell_3(1) = \\frac{5}{6}(1+\\sqrt{3/5})$\n- $\\frac{d\\ell_1}{d\\xi}(1) = \\frac{5}{6}(2-\\sqrt{3/5})$, $\\frac{d\\ell_2}{d\\xi}(1) = -10/3$, $\\frac{d\\ell_3}{d\\xi}(1) = \\frac{5}{6}(2+\\sqrt{3/5})$\nThe three entries are:\n- $b_{N,1} = \\frac{g_R}{h} \\left[ 2\\left(\\frac{5}{6}(2-\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1-\\sqrt{3/5})\\right) \\right] = \\frac{5g_R}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n- $b_{N,2} = \\frac{g_R}{h} \\left[ 2\\left(-\\frac{10}{3}\\right) + \\sigma\\left(-\\frac{2}{3}\\right) \\right] = -\\frac{2g_R}{3h}(10+\\sigma)$\n- $b_{N,3} = \\frac{g_R}{h} \\left[ 2\\left(\\frac{5}{6}(2+\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1+\\sqrt{3/5})\\right) \\right] = \\frac{5g_R}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n\nCombining these six entries into the requested row vector gives the final answer.",
            "answer": "$$ \\boxed{\\bigl[ \\frac{5g_L}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right), -\\frac{2g_L}{3h} (10+\\sigma), \\frac{5g_L}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right), \\frac{5g_R}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right), -\\frac{2g_R}{3h} (10+\\sigma), \\frac{5g_R}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right) \\bigr]} $$"
        }
    ]
}