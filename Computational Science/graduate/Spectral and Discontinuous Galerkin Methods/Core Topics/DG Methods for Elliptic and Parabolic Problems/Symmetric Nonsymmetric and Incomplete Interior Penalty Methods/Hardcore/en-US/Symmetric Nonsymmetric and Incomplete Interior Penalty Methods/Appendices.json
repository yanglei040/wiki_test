{
    "hands_on_practices": [
        {
            "introduction": "The heart of any interior penalty discontinuous Galerkin (DG) method lies in its unique bilinear form, which couples adjacent elements through face integrals. This first exercise provides direct, hands-on practice in calculating these forms for the three classical variants: symmetric (SIPG), nonsymmetric (NIPG), and incomplete (IIPG). By applying the definitions to simple polynomial functions, you will build foundational skills in computing the jumps, averages, and penalty terms that are central to the method's structure .",
            "id": "3422664",
            "problem": "Consider the one-dimensional Poisson equation on the domain $\\Omega = [0,1]$ with homogeneous Neumann boundary conditions, discretized by a Discontinuous Galerkin (DG) method using a uniform mesh with two elements $K_{1} = [0,\\tfrac{1}{2}]$ and $K_{2} = [\\tfrac{1}{2},1]$. Let the polynomial degree be one on each element, and define the trial and test functions $u_{h}$ and $v_{h}$ by\n$$\nu_{h}(x) = \\begin{cases}\nx  \\text{for } x \\in K_{1}, \\\\\n0  \\text{for } x \\in K_{2},\n\\end{cases}\n\\qquad\nv_{h}(x) = \\begin{cases}\n1  \\text{for } x \\in K_{1}, \\\\\nx  \\text{for } x \\in K_{2}.\n\\end{cases}\n$$\nLet the outward unit normal for $K_{1}$ at $x=\\tfrac{1}{2}$ be $n^{-}=+1$ and for $K_{2}$ at $x=\\tfrac{1}{2}$ be $n^{+}=-1$. For a scalar function $w$, define the jump as $[w] = w^{-} - w^{+}$ at the interior face $e=\\{ \\tfrac{1}{2} \\}$, and the average of the normal derivative as\n$$\n\\{ \\partial_{n} w \\} = \\frac{ \\nabla w^{-} \\cdot n^{-} + \\nabla w^{+} \\cdot n^{+} }{2}.\n$$\nStarting from the elementwise integration by parts and the definition of numerical fluxes, derive the interior-penalty DG bilinear form\n$$\na_{\\theta}(u_{h},v_{h}) = \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\, dx \\;-\\; \\sum_{e} \\left( \\{ \\partial_{n} u_{h} \\} [v_{h}] + \\theta \\, \\{ \\partial_{n} v_{h} \\} [u_{h}] \\right) \\;+\\; \\sum_{e} \\frac{\\sigma}{h_{e}} \\, [u_{h}] [v_{h}],\n$$\nwhere the sum over $e$ runs over interior faces, $h_{e}$ is the local face size defined as the harmonic average of adjacent element sizes (which equals $h_{e} = \\tfrac{1}{2}$ for the given mesh), and $\\sigma$ is a positive penalty parameter. In this one-dimensional setting, interpret the face integral as the evaluation at the face point. The three classical interior penalty variants are obtained by choosing $\\theta$ as follows: symmetric interior penalty Galerkin (SIPG) with $\\theta=1$, nonsymmetric interior penalty Galerkin (NIPG) with $\\theta=-1$, and incomplete interior penalty Galerkin (IIPG) with $\\theta=0$.\n\nUsing the above definitions and choices, evaluate the linear combination\n$$\nL \\;=\\; a_{\\text{SIPG}}(u_{h},v_{h}) \\;+\\; 2\\,a_{\\text{NIPG}}(u_{h},v_{h}) \\;+\\; 3\\,a_{\\text{IIPG}}(u_{h},v_{h}),\n$$\nfor the penalty parameter $\\sigma = 3$ and $h_{e} = \\tfrac{1}{2}$, where $a_{\\text{SIPG}}$, $a_{\\text{NIPG}}$, and $a_{\\text{IIPG}}$ denote $a_{\\theta}$ evaluated at $\\theta=1$, $\\theta=-1$, and $\\theta=0$, respectively. Express your final answer exactly as a rational number.",
            "solution": "The user wants me to solve a problem related to Discontinuous Galerkin (DG) methods.\n\nHere's my plan:\n1.  **Validate the problem:**\n    *   Extract all given information: the domain, the PDE, the mesh, the polynomial degree, the specific trial and test functions, definitions for jumps and averages, the general bilinear form, the values of `theta` for SIPG, NIPG, and IIPG, and the final expression to calculate.\n    *   Check for scientific soundness, well-posedness, objectivity, completeness, and consistency.\n    *   The problem is about applying a well-defined mathematical formula from numerical analysis (DG methods) to specific functions. It seems well-posed and grounded in its field. The definitions are clear. The functions and parameters are explicitly given. It's a calculation problem, not a conceptual one requiring deep proofs from first principles. The problem statement itself *derives* the bilinear form needed, which is a bit unusual, but then it asks to *use* that form. It seems the \"derivation\" part is just context for the formula. The core task is to evaluate the bilinear form for given functions and parameters.\n\n2.  **Solve the problem (if valid):**\n    *   The final goal is to compute `L = a_SIPG(u_h, v_h) + 2*a_NIPG(u_h, v_h) + 3*a_IIPG(u_h, v_h)`.\n    *   This simplifies to `L = a_{theta=1} + 2*a_{theta=-1} + 3*a_{theta=0}`.\n    *   Let's analyze the general bilinear form `a_theta(u_h, v_h)`. It has three parts:\n        1.  Volume integral: `Sum_{K} integral_{K} (nabla u_h) . (nabla v_h) dx`\n        2.  Flux terms: `- Sum_{e} ( {d_n u_h} [v_h] + theta * {d_n v_h} [u_h] )`\n        3.  Penalty term: `+ Sum_{e} (sigma / h_e) * [u_h] [v_h]`\n\n    *   I need to calculate each of these parts for the given `u_h` and `v_h`.\n\n    *   **Step A: Calculate derivatives and function values at the interface.**\n        *   The interface is at `x = 1/2`.\n        *   The elements are `K_1 = [0, 1/2]` and `K_2 = [1/2, 1]`.\n        *   Trial function `u_h`:\n            *   On `K_1`: `u_h(x) = x`. So, `nabla u_h = d/dx u_h = 1`.\n            *   On `K_2`: `u_h(x) = 0`. So, `nabla u_h = d/dx u_h = 0`.\n        *   Test function `v_h`:\n            *   On `K_1`: `v_h(x) = 1`. So, `nabla v_h = d/dx v_h = 0`.\n            *   On `K_2`: `v_h(x) = x`. So, `nabla v_h = d/dx v_h = 1`.\n\n        *   Values at the interface `e = {1/2}`:\n            *   `u_h` values:\n                *   `u_h^- = u_h(1/2)` from `K_1` is `1/2`.\n                *   `u_h^+ = u_h(1/2)` from `K_2` is `0`.\n            *   `v_h` values:\n                *   `v_h^- = v_h(1/2)` from `K_1` is `1`.\n                *   `v_h^+ = v_h(1/2)` from `K_2` is `1/2`.\n            *   `nabla u_h` values:\n                *   `nabla u_h^-` (on `K_1`) is `1`.\n                *   `nabla u_h^+` (on `K_2`) is `0`.\n            *   `nabla v_h` values:\n                *   `nabla v_h^-` (on `K_1`) is `0`.\n                *   `nabla v_h^+` (on `K_2`) is `1`.\n\n    *   **Step B: Calculate jumps and averages at the interface `e = {1/2}`.**\n        *   Normals: `n^- = +1` for `K_1`, `n^+ = -1` for `K_2`.\n        *   Jump `[u_h]`: `u_h^- - u_h^+ = 1/2 - 0 = 1/2`.\n        *   Jump `[v_h]`: `v_h^- - v_h^+ = 1 - 1/2 = 1/2`.\n        *   Average `{d_n u_h}`:\n            *   `d_n u_h` on `K_1` is `nabla u_h^- . n^- = 1 * (+1) = 1`.\n            *   `d_n u_h` on `K_2` is `nabla u_h^+ . n^+ = 0 * (-1) = 0`.\n            *   `{d_n u_h} = (1 + 0) / 2 = 1/2`.\n        *   Average `{d_n v_h}`:\n            *   `d_n v_h` on `K_1` is `nabla v_h^- . n^- = 0 * (+1) = 0`.\n            *   `d_n v_h` on `K_2` is `nabla v_h^+ . n^+ = 1 * (-1) = -1`.\n            *   `{d_n v_h} = (0 - 1) / 2 = -1/2`.\n\n    *   **Step C: Calculate the three terms of the bilinear form `a_theta`.**\n        1.  **Volume integral term:**\n            *   `Sum_{K} integral_{K} (nabla u_h) . (nabla v_h) dx`\n            *   `= integral_{K_1} (nabla u_h) . (nabla v_h) dx + integral_{K_2} (nabla u_h) . (nabla v_h) dx`\n            *   On `K_1`, `nabla u_h = 1` and `nabla v_h = 0`. So, the integrand is `1 * 0 = 0`. The integral is `0`.\n            *   On `K_2`, `nabla u_h = 0` and `nabla v_h = 1`. So, the integrand is `0 * 1 = 0`. The integral is `0`.\n            *   Therefore, the volume integral term is `0 + 0 = 0`.\n\n        2.  **Flux term:**\n            *   The sum is over interior faces. There is only one interior face `e = {1/2}`.\n            *   The term is `- ( {d_n u_h} [v_h] + theta * {d_n v_h} [u_h] )`.\n            *   Substituting the values I calculated:\n            *   `= - ( (1/2) * (1/2) + theta * (-1/2) * (1/2) )`\n            *   `= - ( 1/4 - theta/4 )`\n            *   `= (theta - 1) / 4`.\n\n        3.  **Penalty term:**\n            *   The sum is over interior faces. Only `e = {1/2}`.\n            *   The term is `(sigma / h_e) * [u_h] [v_h]`.\n            *   Given `sigma = 3` and `h_e = 1/2`.\n            *   `[u_h] = 1/2`, `[v_h] = 1/2`.\n            *   Term = `(3 / (1/2)) * (1/2) * (1/2) = 6 * (1/4) = 6/4 = 3/2`.\n\n    *   **Step D: Combine the terms to get `a_theta(u_h, v_h)`.**\n        *   `a_theta(u_h, v_h) = (Volume Term) + (Flux Term) + (Penalty Term)`\n        *   `a_theta(u_h, v_h) = 0 + (theta - 1) / 4 + 3/2`.\n        *   Let's check my work.\n            *   `{d_n u_h}` calculation: `nabla u_h^- = 1`, `n^- = +1`. `nabla u_h^+ = 0`, `n^+ = -1`. `{d_n u_h} = (1*1 + 0*(-1))/2 = 1/2`. Correct.\n            *   `{d_n v_h}` calculation: `nabla v_h^- = 0`, `n^- = +1`. `nabla v_h^+ = 1`, `n^+ = -1`. `{d_n v_h} = (0*1 + 1*(-1))/2 = -1/2`. Correct.\n            *   `[u_h] = 1/2`. Correct.\n            *   `[v_h] = 1/2`. Correct.\n            *   Flux term: `- ( {d_n u_h} [v_h] + theta * {d_n v_h} [u_h] ) = - ( (1/2)*(1/2) + theta*(-1/2)*(1/2) ) = - (1/4 - theta/4) = (theta-1)/4`. Correct.\n            *   Penalty term: `(sigma / h_e) * [u_h] [v_h] = (3 / (1/2)) * (1/2) * (1/2) = 6 * 1/4 = 3/2`. Correct.\n            *   Volume term is `0`. Correct.\n        *   So, `a_theta(u_h, v_h) = (theta - 1) / 4 + 3/2`.\n\n    *   **Step E: Calculate `a_SIPG`, `a_NIPG`, and `a_IIPG`.**\n        *   `a_SIPG` corresponds to `theta = 1`.\n            *   `a_SIPG(u_h, v_h) = (1 - 1) / 4 + 3/2 = 0 + 3/2 = 3/2`.\n        *   `a_NIPG` corresponds to `theta = -1`.\n            *   `a_NIPG(u_h, v_h) = (-1 - 1) / 4 + 3/2 = -2/4 + 3/2 = -1/2 + 3/2 = 2/2 = 1`.\n        *   `a_IIPG` corresponds to `theta = 0`.\n            *   `a_IIPG(u_h, v_h) = (0 - 1) / 4 + 3/2 = -1/4 + 6/4 = 5/4`.\n\n    *   **Step F: Calculate the final linear combination `L`.**\n        *   `L = a_SIPG(u_h, v_h) + 2 * a_NIPG(u_h, v_h) + 3 * a_IIPG(u_h, v_h)`\n        *   `L = (3/2) + 2 * (1) + 3 * (5/4)`\n        *   `L = 3/2 + 2 + 15/4`\n        *   Find a common denominator, which is `4`.\n        *   `L = 6/4 + 8/4 + 15/4`\n        *   `L = (6 + 8 + 15) / 4`\n        *   `L = 29 / 4`.\n\n    *   **Final checks:**\n        *   The problem asks for the answer as an exact rational number. `29/4` is an exact rational number.\n        *   All steps followed the definitions provided in the problem statement.\n        *   The numerical values for `sigma` and `h_e` were used correctly.\n        *   The interpretation of the bilinear form `a_theta` and its variants (SIPG, NIPG, IIPG) is correct.\n        *   The calculations of jumps and averages seem correct.\n        *   Let's double-check the average definition. `{d_n w} = (nabla w^- . n^- + nabla w^+ . n^+)/2`. Correct.\n        *   `w = u_h`: `nabla u_h^- . n^- = 1 * 1 = 1`. `nabla u_h^+ . n^+ = 0 * (-1) = 0`. `{d_n u_h} = (1+0)/2 = 1/2`.\n        *   `w = v_h`: `nabla v_h^- . n^- = 0 * 1 = 0`. `nabla v_h^+ . n^+ = 1 * (-1) = -1`. `{d_n v_h} = (0-1)/2 = -1/2`.\n        *   The arithmetic a a final check: `L = 3/2 + 2 + 15/4 = 1.5 + 2 + 3.75 = 7.25`. `29/4 = 7.25`. Correct.\n        *   The logic is sound. The calculations are verified. The answer format is a rational number.\n\n    *   Now, I will construct the solution text, ensuring all mathematical expressions are in LaTeX.\n\n    *   **Structure of the solution text:**\n        1.  Start by stating the goal: to compute the linear combination `L`.\n        2.  First, simplify the expression for `L` in terms of `a_theta`. `L = a_1 + 2*a_{-1} + 3*a_0`.\n        3.  Next, compute the general form of `a_theta(u_h, v_h)` by calculating its three components: the volume integral, the flux term, and the penalty term.\n        4.  To do this, first compute the necessary quantities: derivatives of `u_h` and `v_h`, and their values at the interface `x=1/2`.\n        5.  Then compute the jumps (`[u_h]`, `[v_h]`) and averages (`{d_n u_h}`, `{d_n v_h}`).\n        6.  Substitute these into the three components of `a_theta`.\n            *   Volume term calculation.\n            *   Flux term calculation (this will contain `theta`).\n            *   Penalty term calculation.\n        7.  Combine these to get the expression for `a_theta(u_h, v_h)` as a function of `theta`.\n        8.  Evaluate `a_theta` for `theta=1`, `theta=-1`, and `theta=0` to get `a_SIPG`, `a_NIPG`, and `a_IIPG`.\n        9.  Finally, substitute these values into the expression for `L` and compute the final result.\n\n    *   This structure is logical and easy to follow. I will ensure every single mathematical entity, including simple numbers and variables, is in LaTeX.\n    *   For example: \"The domain is $\\Omega = [0,1]$ with two elements $K_{1} = [0,\\tfrac{1}{2}]$ and $K_{2} = [\\tfrac{1}{2},1]$.\"\n    *   \"The trial function is $u_h(x)$ and the test function is $v_h(x)$.\"\n    *   \"We are asked to compute $L$.\"\n    *   This is a strict requirement and I must be meticulous about it.\n\n    *   Let's draft the steps again with LaTeX in mind.\n        -   Problem is valid.\n        -   Solution:\n            -   Goal is to evaluate $L = a_{\\text{SIPG}}(u_{h},v_{h}) + 2\\,a_{\\text{NIPG}}(u_{h},v_{h}) + 3\\,a_{\\text{IIPG}}(u_{h},v_{h})$.\n            -   Using the definition $a_{\\theta}$, where SIPG has $\\theta=1$, NIPG has $\\theta=-1$, and IIPG has $\\theta=0$, we can write $L$ as $a_{1}(u_h, v_h) + 2a_{-1}(u_h, v_h) + 3a_{0}(u_h, v_h)$.\n            -   We first evaluate the components of the general bilinear form $a_{\\theta}(u_{h},v_{h})$.\n            -   The given functions are $u_{h}(x) = x$ on $K_1$ and $0$ on $K_2$, and $v_{h}(x) = 1$ on $K_1$ and $x$ on $K_2$.\n            -   The gradients are $\\nabla u_{h} = 1$ on $K_1$ and $0$ on $K_2$. $\\nabla v_{h} = 0$ on $K_1$ and $1$ on $K_2$.\n            -   The interior face is at $x=\\frac{1}{2}$. We evaluate the traces from the left ($^-$ from $K_1$) and right ($^+$ from $K_2$).\n            -   $u_h^{-} = \\frac{1}{2}$, $u_h^{+} = 0$. $\\nabla u_h^{-} = 1$, $\\nabla u_h^{+} = 0$.\n            -   $v_h^{-} = 1$, $v_h^{+} = \\frac{1}{2}$. $\\nabla v_h^{-} = 0$, $\\nabla v_h^{+} = 1$.\n            -   The outward normals are $n^{-} = +1$ and $n^{+} = -1$.\n            -   Now compute jumps and averages:\n                -   $[u_h] = u_h^{-} - u_h^{+} = \\frac{1}{2} - 0 = \\frac{1}{2}$.\n                -   $[v_h] = v_h^{-} - v_h^{+} = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n                -   $\\{ \\partial_{n} u_{h} \\} = \\frac{ \\nabla u_{h}^{-} \\cdot n^{-} + \\nabla u_{h}^{+} \\cdot n^{+} }{2} = \\frac{(1)(1) + (0)(-1)}{2} = \\frac{1}{2}$.\n                -   $\\{ \\partial_{n} v_{h} \\} = \\frac{ \\nabla v_{h}^{-} \\cdot n^{-} + \\nabla v_{h}^{+} \\cdot n^{+} }{2} = \\frac{(0)(1) + (1)(-1)}{2} = -\\frac{1}{2}$.\n            -   Now we evaluate the three terms of $a_\\theta(u_h, v_h)$.\n            -   Term 1 (Volume integral): $\\sum_{K} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\, dx = \\int_{K_1} (1)(0) dx + \\int_{K_2} (0)(1) dx = 0$.\n            -   Term 2 (Flux term): The sum is over the single interior face $e=\\{\\frac{1}{2}\\}$. $-(\\{ \\partial_{n} u_{h} \\} [v_{h}] + \\theta \\, \\{ \\partial_{n} v_{h} \\} [u_{h}]) = - \\left( (\\frac{1}{2})(\\frac{1}{2}) + \\theta (-\\frac{1}{2})(\\frac{1}{2}) \\right) = -(\\frac{1}{4} - \\frac{\\theta}{4}) = \\frac{\\theta-1}{4}$.\n            -   Term 3 (Penalty term): With $\\sigma = 3$ and $h_e=\\frac{1}{2}$: $\\frac{\\sigma}{h_{e}} \\, [u_{h}] [v_{h}] = \\frac{3}{1/2} (\\frac{1}{2})(\\frac{1}{2}) = 6 \\cdot \\frac{1}{4} = \\frac{3}{2}$.\n            -   Combining the terms: $a_{\\theta}(u_{h},v_{h}) = 0 + \\frac{\\theta-1}{4} + \\frac{3}{2}$.\n            -   Now we compute the specific bilinear forms:\n                -   $a_{\\text{SIPG}} = a_{1} = \\frac{1-1}{4} + \\frac{3}{2} = \\frac{3}{2}$.\n                -   $a_{\\text{NIPG}} = a_{-1} = \\frac{-1-1}{4} + \\frac{3}{2} = \\frac{-2}{4} + \\frac{3}{2} = -\\frac{1}{2} + \\frac{3}{2} = 1$.\n                -   $a_{\\text{IIPG}} = a_{0} = \\frac{0-1}{4} + \\frac{3}{2} = -\\frac{1}{4} + \\frac{6}{4} = \\frac{5}{4}$.\n            -   Finally, compute the linear combination $L$:\n                -   $L = a_{\\text{SIPG}} + 2\\,a_{\\text{NIPG}} + 3\\,a_{\\text{IIPG}} = \\frac{3}{2} + 2(1) + 3(\\frac{5}{4}) = \\frac{3}{2} + 2 + \\frac{15}{4}$.\n                -   $L = \\frac{6}{4} + \\frac{8}{4} + \\frac{15}{4} = \\frac{6+8+15}{4} = \\frac{29}{4}$.\n            -   The final answer is $\\frac{29}{4}$.",
            "answer": "$$\\boxed{\\frac{29}{4}}$$"
        },
        {
            "introduction": "The specific definitions of jump and average operators in DG methods can seem overly technical, but they are essential for the mathematical integrity of the scheme. This exercise demonstrates the importance of these details by exploring a hypothetical \"naive\" formulation where the orientation of face normals is ignored. By calculating the resulting adjoint-consistency defect, you will see firsthand how such a seemingly minor simplification violates a fundamental property of the method, reinforcing the necessity of the rigorous, standard definitions .",
            "id": "3422725",
            "problem": "Consider the scalar diffusion problem in one spatial dimension on the open interval $\\Omega=(0,1)$ with the strong form $-u''=f$. Let the mesh $\\mathcal{T}_h$ consist of $2$ elements, $K_1=(0,\\tfrac{1}{2})$ and $K_2=(\\tfrac{1}{2},1)$, with the unique interior face $F=\\{\\tfrac{1}{2}\\}$. For a function $v$ with traces $v_{-}$ from $K_1$ and $v_{+}$ from $K_2$, define the oriented average and jump by $\\{v'\\}=\\tfrac{1}{2}(v'_{-}+v'_{+})$ and $[v]=v_{-}n^{-}+v_{+}n^{+}$, where the outward unit normals satisfy $n^{-}=+1$ on the right boundary of $K_1$ and $n^{+}=-1$ on the left boundary of $K_2$. The Nonsymmetric Interior Penalty Galerkin (NIPG) bilinear form for the model diffusion operator, using correct orientation, is\n$$\na_{\\mathrm{NIPG}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]\\,\\mathrm{d}s+\\int_{F}\\{w'\\}\\,[u]\\,\\mathrm{d}s+\\int_{F}\\frac{\\eta}{h_F}[u][w]\\,\\mathrm{d}s,\n$$\nwith penalty parameter $\\eta0$ and face size $h_F$. In the exact-solution consistency check, when $u$ is sufficiently smooth across $F$, one has $[u]=0$, so the last two terms vanish.\n\nNow replace the oriented jump by the naive choice that ignores the sign of the outward normal and sets both normals to $+1$, i.e.,\n$$\n[w]_{\\mathrm{naive}}=w_{-}+w_{+}.\n$$\nKeep the oriented average $\\{u'\\}$ as above, and define the naive NIPG bilinear form by\n$$\na_{\\mathrm{naive}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s.\n$$\n\nLet $u(x)=x-x^{3}$, so that $f(x)=-u''(x)=6x$, and choose the test function $w(x)=x(1-x)$. Both $u$ and $w$ are $C^{\\infty}$ on $\\Omega$, and $w(0)=w(1)=0$. Define the adjoint-consistency defect\n$$\nD(u,w)=a_{\\mathrm{naive}}(u,w)-\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x.\n$$\nCompute $D(u,w)$ exactly for this two-element mesh. Your final answer must be a single real number. No rounding is required.",
            "solution": "The user-provided problem statement is valid. It is scientifically grounded in the theory of Discontinuous Galerkin methods, well-posed with all necessary information provided, and objective in its phrasing. We can therefore proceed to a solution.\n\nThe problem asks for the computation of the adjoint-consistency defect, defined as\n$$\nD(u,w) = a_{\\mathrm{naive}}(u,w) - \\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x.\n$$\nWe will compute the two terms on the right-hand side separately.\n\nThe naive bilinear form is given by\n$$\na_{\\mathrm{naive}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s.\n$$\nThe first term is the sum of integrals over the elements $K_1=(0,\\frac{1}{2})$ and $K_2=(\\frac{1}{2},1)$, which can be combined into a single integral over the domain $\\Omega=(0,1)$ since the integrand is well-defined across the element boundary.\n$$\n\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x = \\int_{0}^{1}u'(x)w'(x)\\,\\mathrm{d}x.\n$$\nThe functions $u(x)$ and $w(x)$ are given as $u(x)=x-x^3$ and $w(x)=x(1-x)=x-x^2$. Their first derivatives are:\n$$\nu'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(x-x^3) = 1 - 3x^2,\n$$\n$$\nw'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(x-x^2) = 1 - 2x.\n$$\nWe can now compute the integral of their product:\n$$\n\\int_{0}^{1}u'(x)w'(x)\\,\\mathrm{d}x = \\int_{0}^{1}(1-3x^2)(1-2x)\\,\\mathrm{d}x = \\int_{0}^{1}(1 - 2x - 3x^2 + 6x^3)\\,\\mathrm{d}x.\n$$\nEvaluating the integral gives:\n$$\n\\left[x - \\frac{2x^2}{2} - \\frac{3x^3}{3} + \\frac{6x^4}{4}\\right]_{0}^{1} = \\left[x - x^2 - x^3 + \\frac{3}{2}x^4\\right]_{0}^{1} = \\left(1 - 1 - 1 + \\frac{3}{2}\\right) - 0 = \\frac{1}{2}.\n$$\nNext, we evaluate the face integral term $-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s$. The interior face $F$ is the point $x=\\frac{1}{2}$. In one dimension, an integral over a point face is simply the evaluation of the integrand at that point. Thus,\n$$\n\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s = \\left(\\{u'\\}\\,[w]_{\\mathrm{naive}}\\right)\\Big|_{x=\\frac{1}{2}}.\n$$\nWe need to compute the average $\\{u'\\}$ and the naive jump $[w]_{\\mathrm{naive}}$ at $x=\\frac{1}{2}$. Since $u(x)$ is a smooth polynomial, its derivative $u'(x)$ is continuous across the face, so the traces from the left ($K_1$) and right ($K_2$) are equal:\n$$\nu'_{-} = u'\\left(\\frac{1}{2}\\right) = 1 - 3\\left(\\frac{1}{2}\\right)^2 = 1 - \\frac{3}{4} = \\frac{1}{4},\n$$\n$$\nu'_{+} = u'\\left(\\frac{1}{2}\\right) = \\frac{1}{4}.\n$$\nThe average is then\n$$\n\\{u'\\} = \\frac{1}{2}(u'_{-} + u'_{+}) = \\frac{1}{2}\\left(\\frac{1}{4} + \\frac{1}{4}\\right) = \\frac{1}{4}.\n$$\nSimilarly, the function $w(x)$ is continuous, so its traces are equal:\n$$\nw_{-} = w\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1-\\frac{1}{2}\\right) = \\frac{1}{4},\n$$\n$$\nw_{+} = w\\left(\\frac{1}{2}\\right) = \\frac{1}{4}.\n$$\nThe naive jump is defined as $[w]_{\\mathrm{naive}} = w_{-} + w_{+}$:\n$$\n[w]_{\\mathrm{naive}} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}.\n$$\nNow we compute the value of the face integral term:\n$$\n-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s = -\\{u'\\}\\,[w]_{\\mathrm{naive}} = -\\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) = -\\frac{1}{8}.\n$$\nCombining the volume and face terms to find $a_{\\mathrm{naive}}(u,w)$:\n$$\na_{\\mathrm{naive}}(u,w) = \\frac{1}{2} - \\frac{1}{8} = \\frac{4}{8} - \\frac{1}{8} = \\frac{3}{8}.\n$$\nThe second part of the defect calculation is the integral $\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x$. The source term $f(x)$ is given by $f(x) = -u''(x)$.\n$$\nu''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1-3x^2) = -6x,\n$$\nso $f(x) = -(-6x) = 6x$.\nThe integral is:\n$$\n\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x = \\int_{0}^{1}(6x)(x-x^2)\\,\\mathrm{d}x = \\int_{0}^{1}(6x^2 - 6x^3)\\,\\mathrm{d}x.\n$$\nEvaluating this integral yields:\n$$\n\\left[\\frac{6x^3}{3} - \\frac{6x^4}{4}\\right]_{0}^{1} = \\left[2x^3 - \\frac{3}{2}x^4\\right]_{0}^{1} = \\left(2 - \\frac{3}{2}\\right) - 0 = \\frac{1}{2}.\n$$\nFinally, we compute the adjoint-consistency defect $D(u,w)$ by subtracting the second result from the first:\n$$\nD(u,w) = a_{\\mathrm{naive}}(u,w) - \\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x = \\frac{3}{8} - \\frac{1}{2} = \\frac{3}{8} - \\frac{4}{8} = -\\frac{1}{8}.\n$$",
            "answer": "$$\n\\boxed{-\\frac{1}{8}}\n$$"
        },
        {
            "introduction": "Moving from the theoretical bilinear form to a full problem solver requires correctly handling boundary conditions. This practice focuses on implementing non-homogeneous Dirichlet boundary conditions within the Symmetric Interior Penalty Galerkin (SIPG) framework, a common and crucial task in applications. You will derive the contributions of the boundary data to the local load vector for a higher-order element, gaining practical insight into how the abstract DG boundary integrals translate into computable algebraic quantities .",
            "id": "3422733",
            "problem": "Consider the stationary diffusion problem on a one-dimensional domain with nonhomogeneous Dirichlet boundary conditions: find a sufficiently smooth function $u$ such that\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = g_L, \\quad u(1) = g_R,\n$$\nwhere $f$ is a given source and $g_L, g_R$ are prescribed boundary data. Discretize $(0,1)$ by a uniform mesh of $N \\geq 2$ affine elements of size $h = 1/N$. On each element, use a polynomial space of degree $p=2$ represented in a nodal basis given by the three Gaussâ€“Legendre quadrature nodes on the reference element $[-1,1]$, namely $\\xi_1 = -\\sqrt{3/5}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{3/5}$, and the associated Lagrange basis functions $\\{\\ell_i(\\xi)\\}_{i=1}^3$. Adopt the Symmetric Interior Penalty Galerkin (SIPG) formulation for diffusion with constant diffusion coefficient $1$ and a penalty parameter $\\sigma  0$, using the standard outward unit normals at boundary points ($n(0) = -1$, $n(1) = +1$).\n\nStarting from the definition of the discontinuous Galerkin method via elementwise integration by parts and numerical fluxes, derive the explicit boundary contributions to the local load vectors that arise solely from the nonhomogeneous Dirichlet boundary data $g_L$ and $g_R$ on the first and last elements, respectively. Assume that:\n- mapping from the reference coordinate $\\xi \\in [-1,1]$ to a boundary element $K$ is affine, $x = x_K + \\frac{h}{2}\\,\\xi$, so that $\\frac{d\\xi}{dx} = \\frac{2}{h}$,\n- only boundary terms are required (ignore the volume source $f$ and all interior-face contributions),\n- the SIPG linear functional contribution on a boundary face $\\partial K \\cap \\partial\\Omega$ is\n$$\n\\int_{\\partial K \\cap \\partial\\Omega} \\left( \\partial_n v_h \\, g + \\frac{\\sigma}{h} \\, g\\, v_h \\right) \\, ds,\n$$\nwhere $v_h$ is a local test function and $\\partial_n v_h = n\\, \\frac{dv_h}{dx}$.\n\nLet $g(0) = g_L$ and $g(1) = g_R$. Using the above nodal basis on each boundary element (leftmost and rightmost elements), compute the three entries of the local load vector contributed by the boundary data at $x=0$ and the three entries at $x=1$. Express your final answer in closed form in terms of $g_L$, $g_R$, $h$, $\\sigma$, and $\\sqrt{3/5}$, in the following order:\n$$\n\\bigl[\\, \\text{left element entry }1,\\ \\text{left element entry }2,\\ \\text{left element entry }3,\\ \\text{right element entry }1,\\ \\text{right element entry }2,\\ \\text{right element entry }3 \\,\\bigr].\n$$\nProvide your answer as a single row vector as specified. No numerical rounding is required.",
            "solution": "The user wants to find the contributions to the local load vectors from nonhomogeneous Dirichlet boundary conditions in a Symmetric Interior Penalty Galerkin (SIPG) discretization of a 1D diffusion problem.\n\n### Step 1: Problem Validation\n\n**1. Extract Givens:**\n- **Differential Equation:** $-u''(x) = f(x)$ for $x \\in (0,1)$.\n- **Boundary Conditions:** $u(0) = g_L$, $u(1) = g_R$.\n- **Discretization:** Uniform mesh of $N$ elements, size $h = 1/N$.\n- **Approximation Space:** Polynomials of degree $p=2$ on each element.\n- **Basis:** Nodal basis on the reference element $[-1,1]$ using Lagrange polynomials $\\{\\ell_i(\\xi)\\}_{i=1}^3$ associated with the Gauss-Legendre quadrature nodes $\\xi_1 = -\\sqrt{3/5}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{3/5}$.\n- **Formulation:** SIPG with diffusion coefficient $1$ and penalty parameter $\\sigma  0$.\n- **Outward Normals:** $n(0) = -1$, $n(1) = +1$.\n- **Mapping:** Affine map from reference coordinate $\\xi \\in [-1,1]$ to physical coordinate $x \\in K$, with Jacobian derivative $\\frac{d\\xi}{dx} = \\frac{2}{h}$.\n- **Boundary Integral:** The contribution to the linear functional (load vector) from a Dirichlet boundary face is given by:\n$$\nL_{\\partial}(v_h) = \\int_{\\partial K \\cap \\partial\\Omega} \\left( \\partial_n v_h \\, g + \\frac{\\sigma}{h} \\, g\\, v_h \\right) \\, ds\n$$\nwhere $g$ is the imposed Dirichlet value and $v_h$ is a test function.\n- **Task:** Compute the three entries of the local load vectors for the first (leftmost) and last (rightmost) elements that arise from the boundary data $g_L$ and $g_R$. Ignore all other contributions (source term $f$, interior faces).\n\n**2. Validate Using Extracted Givens:**\n- **Scientific Grounding:** The problem is a standard exercise in the numerical analysis of partial differential equations, specifically concerning discontinuous Galerkin methods. The SIPG formulation and the use of Lagrange basis on Gauss-Legendre nodes are well-established techniques. The problem is scientifically sound.\n- **Well-Posedness:** All necessary information is provided. The form of the boundary integral term is explicitly given, as are the basis functions (via the nodes), the mapping derivative, and the physical setup. The task is specific and leads to a unique result.\n- **Objectivity:** The problem is stated in precise mathematical terms, free from ambiguity or subjective content.\n\n**3. Verdict and Action:**\nThe problem is valid as it is scientifically grounded, well-posed, and objective. I will proceed with the solution.\n\n### Step 2: Derivation of Load Vector Contributions\n\nThe local load vector $\\mathbf{b}_K$ for an element $K$ has entries $b_{K,i} = L(\\phi_i)$, where $\\phi_i$ are the local basis functions and $L(\\cdot)$ is the linear functional part of the weak form. We are interested only in the contributions from the nonhomogeneous Dirichlet boundaries.\n\nThe basis functions on the reference element $\\xi \\in [-1,1]$ are the Lagrange polynomials of degree $2$ for the nodes $\\xi_1 = -\\sqrt{3/5}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{3/5}$:\n$$ \\ell_1(\\xi) = \\frac{5}{6}\\left(\\xi^2 - \\xi\\sqrt{\\frac{3}{5}}\\right) $$\n$$ \\ell_2(\\xi) = 1 - \\frac{5}{3}\\xi^2 $$\n$$ \\ell_3(\\xi) = \\frac{5}{6}\\left(\\xi^2 + \\xi\\sqrt{\\frac{3}{5}}\\right) $$\nThe test functions on a physical element $K$ are of the form $v_h(x) = \\ell_i(\\xi(x))$.\n\nThe derivative of a test function with respect to $x$ is found using the chain rule:\n$$ \\frac{dv_h}{dx} = \\frac{d\\ell_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{2}{h} \\frac{d\\ell_i}{d\\xi} $$\nThe derivatives of the basis functions with respect to $\\xi$ are:\n$$ \\frac{d\\ell_1}{d\\xi} = \\frac{5}{6}\\left(2\\xi - \\sqrt{\\frac{3}{5}}\\right) $$\n$$ \\frac{d\\ell_2}{d\\xi} = -\\frac{10}{3}\\xi $$\n$$ \\frac{d\\ell_3}{d\\xi} = \\frac{5}{6}\\left(2\\xi + \\sqrt{\\frac{3}{5}}\\right) $$\n\n**Contribution from the Left Boundary ($x=0$)**\nThis contribution affects the first element, $K_1 = [0, h]$. The boundary point is $x=0$, which maps to $\\xi = -1$ on the reference element. The outward normal is $n(0) = -1$. The boundary data is $g_L$. In 1D, the integral $\\int ds$ is just a point evaluation.\nThe contribution to the load vector for a test function $v_h$ is:\n$$ L_{L}(v_h) = \\left. \\left( \\partial_n v_h \\, g_L + \\frac{\\sigma}{h} g_L v_h \\right) \\right|_{x=0} = g_L \\left( n(0) \\frac{dv_h}{dx}(0) + \\frac{\\sigma}{h} v_h(0) \\right) $$\n$$ L_{L}(v_h) = g_L \\left( - \\frac{dv_h}{dx}(0) + \\frac{\\sigma}{h} v_h(0) \\right) $$\nThe three entries of the local load vector for $K_1$ are found by taking $v_h = \\phi_i(x) = \\ell_i(\\xi(x))$ for $i=1, 2, 3$.\n$$ b_{1,i} = g_L \\left( - \\frac{2}{h} \\frac{d\\ell_i}{d\\xi}(-1) + \\frac{\\sigma}{h} \\ell_i(-1) \\right) = \\frac{g_L}{h} \\left( -2 \\frac{d\\ell_i}{d\\xi}(-1) + \\sigma \\ell_i(-1) \\right) $$\nWe evaluate the basis functions and their derivatives at $\\xi=-1$:\n- $\\ell_1(-1) = \\frac{5}{6}(1+\\sqrt{3/5})$, $\\ell_2(-1) = -2/3$, $\\ell_3(-1) = \\frac{5}{6}(1-\\sqrt{3/5})$\n- $\\frac{d\\ell_1}{d\\xi}(-1) = \\frac{5}{6}(-2-\\sqrt{3/5})$, $\\frac{d\\ell_2}{d\\xi}(-1) = 10/3$, $\\frac{d\\ell_3}{d\\xi}(-1) = \\frac{5}{6}(-2+\\sqrt{3/5})$\n\nNow we compute the three entries:\n- **Left element entry 1 ($i=1$):**\n$b_{1,1} = \\frac{g_L}{h} \\left[ -2\\left(\\frac{5}{6}(-2-\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1+\\sqrt{3/5})\\right) \\right] = \\frac{5g_L}{6h} \\left[ (4+2\\sqrt{3/5}) + \\sigma(1+\\sqrt{3/5}) \\right] = \\frac{5g_L}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n- **Left element entry 2 ($i=2$):**\n$b_{1,2} = \\frac{g_L}{h} \\left[ -2\\left(\\frac{10}{3}\\right) + \\sigma\\left(-\\frac{2}{3}\\right) \\right] = \\frac{g_L}{h} \\left( -\\frac{20}{3} - \\frac{2\\sigma}{3} \\right) = -\\frac{2g_L}{3h}(10+\\sigma)$\n- **Left element entry 3 ($i=3$):**\n$b_{1,3} = \\frac{g_L}{h} \\left[ -2\\left(\\frac{5}{6}(-2+\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1-\\sqrt{3/5})\\right) \\right] = \\frac{5g_L}{6h} \\left[ (4-2\\sqrt{3/5}) + \\sigma(1-\\sqrt{3/5}) \\right] = \\frac{5g_L}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n\n**Contribution from the Right Boundary ($x=1$)**\nThis contribution affects the last element, $K_N = [1-h, 1]$. The boundary point is $x=1$, which maps to $\\xi = +1$. The outward normal is $n(1) = +1$. The boundary data is $g_R$.\n$$ L_{R}(v_h) = g_R \\left( n(1) \\frac{dv_h}{dx}(1) + \\frac{\\sigma}{h} v_h(1) \\right) = g_R \\left( \\frac{dv_h}{dx}(1) + \\frac{\\sigma}{h} v_h(1) \\right) $$\nThe three entries of the local load vector for $K_N$ are:\n$$ b_{N,i} = g_R \\left( \\frac{2}{h} \\frac{d\\ell_i}{d\\xi}(1) + \\frac{\\sigma}{h} \\ell_i(1) \\right) = \\frac{g_R}{h} \\left( 2 \\frac{d\\ell_i}{d\\xi}(1) + \\sigma \\ell_i(1) \\right) $$\nWe evaluate the basis functions and their derivatives at $\\xi=+1$:\n- $\\ell_1(1) = \\frac{5}{6}(1-\\sqrt{3/5})$, $\\ell_2(1) = -2/3$, $\\ell_3(1) = \\frac{5}{6}(1+\\sqrt{3/5})$\n- $\\frac{d\\ell_1}{d\\xi}(1) = \\frac{5}{6}(2-\\sqrt{3/5})$, $\\frac{d\\ell_2}{d\\xi}(1) = -10/3$, $\\frac{d\\ell_3}{d\\xi}(1) = \\frac{5}{6}(2+\\sqrt{3/5})$\n\nNow we compute the three entries:\n- **Right element entry 1 ($i=1$):**\n$b_{N,1} = \\frac{g_R}{h} \\left[ 2\\left(\\frac{5}{6}(2-\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1-\\sqrt{3/5})\\right) \\right] = \\frac{5g_R}{6h} \\left[ (4-2\\sqrt{3/5}) + \\sigma(1-\\sqrt{3/5}) \\right] = \\frac{5g_R}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n- **Right element entry 2 ($i=2$):**\n$b_{N,2} = \\frac{g_R}{h} \\left[ 2\\left(-\\frac{10}{3}\\right) + \\sigma\\left(-\\frac{2}{3}\\right) \\right] = \\frac{g_R}{h} \\left( -\\frac{20}{3} - \\frac{2\\sigma}{3} \\right) = -\\frac{2g_R}{3h}(10+\\sigma)$\n- **Right element entry 3 ($i=3$):**\n$b_{N,3} = \\frac{g_R}{h} \\left[ 2\\left(\\frac{5}{6}(2+\\sqrt{3/5})\\right) + \\sigma\\left(\\frac{5}{6}(1+\\sqrt{3/5})\\right) \\right] = \\frac{5g_R}{6h} \\left[ (4+2\\sqrt{3/5}) + \\sigma(1+\\sqrt{3/5}) \\right] = \\frac{5g_R}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)$\n\nThe final result is the row vector composed of these six entries in the specified order.",
            "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n\\frac{5g_L}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)  -\\frac{2g_L}{3h} (10+\\sigma)  \\frac{5g_L}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)  \\frac{5g_R}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)  -\\frac{2g_R}{3h} (10+\\sigma)  \\frac{5g_R}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right)\n\\end{bmatrix}\n}\n$$"
        }
    ]
}