{
    "hands_on_practices": [
        {
            "introduction": "我们首先通过局部间断Galerkin（LDG）方法来处理抛物型方程，以此开启我们的实践探索。这个练习将演示一种标准技术，即将一个二阶偏微分方程降阶为一阶方程组，并推导出相应的离散算子。通过傅里叶分析，你将揭示该数值格式的基本性质，例如其稳定性与耗散特性。",
            "id": "3376782",
            "problem": "考虑一维扩散方程 $u_{t} - \\partial_{x}\\!\\left(\\kappa \\,\\partial_{x} u\\right) = 0$，定义在周期性区域 $x \\in [0,L]$ 上，其中扩散系数 $\\kappa > 0$ 为常数。引入辅助变量 $q = \\partial_{x} u$，将该方程组重写为 $u_{t} - \\kappa \\,\\partial_{x} q = 0$ 和 $q - \\partial_{x} u = 0$。使用局部不连续伽辽金 (Local Discontinuous Galerkin, LDG) 方法（不连续伽辽金 (Discontinuous Galerkin, DG) 族的一员），按以下步骤进行：\n\n- 将区域划分为一个包含 $N$ 个单元的均匀网格，单元大小为 $h = L/N$，界面位于 $x_{j \\pm \\frac{1}{2}}$，单元内部为 $I_{j} = [x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}}]$。\n- 在每个单元内，使用分片常数函数（多项式次数 $k=0$）来近似 $u$ 和 $q$。\n- 对于界面处的数值通量，使用交替的 LDG 选择：$\\hat{u} = u^{-}$ 和 $\\hat{q} = q^{+}$，其中 $u^{-}$ 表示从界面左侧取迹，$q^{+}$ 表示从界面右侧取迹。\n\n从基本弱形式出发，将 $q - \\partial_{x} u = 0$ 和 $u_{t} - \\kappa\\,\\partial_{x} q = 0$ 分别乘以测试函数，在一个通用单元 $I_{j}$ 上积分，并根据 DG 范式和指定的数值通量一致地使用分部积分。推导在 $I_{j}$ 上关于 $u$ 和 $q$ 的耦合 DG 弱形式，消去 $q$ 以获得关于单元值 $u_{j}(t)$ 的单一半离散演化方程，然后在周期性边界条件下，通过寻找形式为 $u_{j}(t) = \\tilde{u}(t)\\,\\exp(i \\theta j)$（其中傅里叶频率 $\\theta \\in [-\\pi,\\pi]$ 为实数）的解来进行离散傅里叶分析。\n\n你的任务是确定所得半离散 LDG 算子的傅里叶符号 $\\lambda(\\theta)$，对于上述傅里叶模式，该符号由 $\\frac{\\mathrm{d}}{\\mathrm{d}t} u_{j}(t) = \\lambda(\\theta)\\,u_{j}(t)$ 定义。请用 $\\kappa$、$h$ 和 $\\theta$ 将最终答案表示为一个单一的闭式解析表达式。",
            "solution": "用户希望求出一维扩散方程的局部不连续伽辽金 (LDG) 半离散化的傅里叶符号。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **控制方程**：\n  1.  $u_{t} - \\partial_{x}\\!\\left(\\kappa \\,\\partial_{x} u\\right) = 0$\n- **方程组形式**：\n  1.  $u_{t} - \\kappa \\,\\partial_{x} q = 0$\n  2.  $q - \\partial_{x} u = 0$\n- **区域**：周期性，$x \\in [0,L]$。\n- **扩散系数**：$\\kappa > 0$，常数。\n- **离散化方法**：局部不连续伽辽金 (LDG)。\n- **网格**：均匀划分为 $N$ 个大小为 $h = L/N$ 的单元 $I_{j} = [x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}}]$。\n- **近似空间**：$u$ 和 $q$ 均为分片常数函数（多项式次数 $k=0$）。在单元 $I_j$ 内，近似为 $u_h(x,t) = u_j(t)$ 和 $q_h(x,t) = q_j(t)$。\n- **数值通量**：在界面处，$u$ 的通量为 $\\hat{u} = u^{-}$（从左侧取迹），$q$ 的通量为 $\\hat{q} = q^{+}$（从右侧取迹）。\n- **任务**：推导半离散弱形式，消去辅助变量 $q$，并通过代入 $u_{j}(t) = \\tilde{u}(t)\\,\\exp(i \\theta j)$ 进行离散傅里叶分析，以求出由 $\\frac{\\mathrm{d}}{\\mathrm{d}t} u_{j}(t) = \\lambda(\\theta)\\,u_{j}(t)$ 定义的傅里叶符号 $\\lambda(\\theta)$。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。它提出了偏微分方程数值分析中的一个标准任务，特别是关于不连续伽辽金方法。所有组成部分——扩散方程、LDG 公式、交替通量的特定选择、分片常数基函数，以及使用傅里叶分析研究半离散算子——都是成熟的概念。该问题为进行唯一推导提供了完整且一致的信息集。不存在矛盾、歧义或事实错误。\n\n**1.3. 结论与行动**\n问题是**有效的**。将推导完整解法。\n\n### 步骤 2：半离散格式的推导\n\nLDG 方法从写出通用单元 $I_j$ 上一阶系统的弱形式开始。我们使用分片常数测试函数 $v_h$ 和 $w_h$，它们在单元 $I_j$ 上分别取常数值 $v_j$ 和 $w_j$。\n\n**2.1. $q - \\partial_x u = 0$ 的弱形式**\n乘以一个测试函数 $w_h$ 并在单元 $I_j$ 上积分：\n$$\n\\int_{I_j} q_h w_h \\,dx - \\int_{I_j} (\\partial_x u_h) w_h \\,dx = 0\n$$\n由于 $q_h$ 和 $w_h$ 在 $I_j$ 上是常数（分别为 $q_j$ 和 $w_j$），第一项为 $q_j w_j h$。对于第二项，我们应用分部积分：\n$$\n\\int_{I_j} (\\partial_x u_h) w_h \\,dx = \\left[u_h w_h\\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} u_h (\\partial_x w_h) \\,dx\n$$\n因为测试函数 $w_h$ 在 $I_j$ 上是常数，其导数 $\\partial_x w_h$ 为零，所以右侧的积分消失。边界项使用 $u_h$ 的数值通量和测试函数 $w_h$ 的单元内部值进行计算：\n$$\n\\left[u_h w_h\\right]_{x_{j-1/2}}^{x_{j+1/2}} = \\hat{u}(x_{j+1/2}) w_h(x_{j+1/2}^-) - \\hat{u}(x_{j-1/2}) w_h(x_{j-1/2}^+)\n$$\n在 DG 框架中，测试函数的迹是从单元 $I_j$ 内部取值的。因此，$w_h(x_{j+1/2}^-) = w_j$ 且 $w_h(x_{j-1/2}^+) = w_j$。$u$ 的数值通量被指定为 $\\hat{u} = u^-$。\n在右界面 $x_{j+1/2}$ 处，来自左侧的值 ($u^-$) 是 $u_j$。\n在左界面 $x_{j-1/2}$ 处，来自左侧的值 ($u^-$) 是 $u_{j-1}$。\n所以，$\\hat{u}(x_{j+1/2})=u_j$ 且 $\\hat{u}(x_{j-1/2})=u_{j-1}$。边界项变为 $(u_j - u_{j-1})w_j$。\n代回到弱形式中：\n$$\nq_j w_j h - (u_j - u_{j-1})w_j = 0\n$$\n由于这对任何测试函数值 $w_j$ 都必须成立，我们得到 $q_j$ 的代数关系式：\n$$\nq_j = \\frac{u_j - u_{j-1}}{h}\n$$\n\n**2.2. $u_t - \\kappa \\partial_x q = 0$ 的弱形式**\n乘以一个测试函数 $v_h$ 并在 $I_j$ 上积分：\n$$\n\\int_{I_j} (\\partial_t u_h) v_h \\,dx - \\kappa \\int_{I_j} (\\partial_x q_h) v_h \\,dx = 0\n$$\n由于在 $I_j$ 上 $u_h(x,t) = u_j(t)$ 且 $v_h(x) = v_j$，第一项变为 $v_j \\frac{d u_j}{dt} \\int_{I_j} dx = h v_j \\frac{d u_j}{dt}$。对于第二项，我们再次使用分部积分：\n$$\n\\int_{I_j} (\\partial_x q_h) v_h \\,dx = \\left[q_h v_h\\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} q_h (\\partial_x v_h) \\,dx\n$$\n右侧的积分因 $v_h$ 是常数而消失。边界项为 $\\hat{q}(x_{j+1/2}) v_j - \\hat{q}(x_{j-1/2}) v_j$。$q$ 的数值通量被指定为 $\\hat{q} = q^+$。\n在右界面 $x_{j+1/2}$ 处，来自右侧的值 ($q^+$) 是 $q_{j+1}$。\n在左界面 $x_{j-1/2}$ 处，来自右侧的值 ($q^+$) 是 $q_j$。\n所以，$\\hat{q}(x_{j+1/2})=q_{j+1}$ 且 $\\hat{q}(x_{j-1/2})=q_j$。边界项变为 $(q_{j+1} - q_j)v_j$。\n代回到弱形式中：\n$$\nh v_j \\frac{d u_j}{dt} - \\kappa (q_{j+1} - q_j)v_j = 0\n$$\n由于这对任何 $v_j$ 都成立，我们得到半离散演化方程：\n$$\nh \\frac{d u_j}{dt} = \\kappa (q_{j+1} - q_j)\n$$\n\n**2.3. 消去 $q$**\n我们现在有一个关于单元常数 $u_j$ 和 $q_j$ 的耦合系统：\n1. $q_j = \\frac{u_j - u_{j-1}}{h}$\n2. $h \\frac{d u_j}{dt} = \\kappa (q_{j+1} - q_j)$\n\n我们将 (1) 中 $q$ 的表达式代入 (2)。我们需要 $q_j$ 和 $q_{j+1}$：\n$$q_{j+1} = \\frac{u_{j+1} - u_j}{h}$$\n$$q_j = \\frac{u_j - u_{j-1}}{h}$$\n演化方程变为：\n$$\nh \\frac{d u_j}{dt} = \\kappa \\left( \\frac{u_{j+1} - u_j}{h} - \\frac{u_j - u_{j-1}}{h} \\right)\n$$\n$$\nh \\frac{d u_j}{dt} = \\frac{\\kappa}{h} (u_{j+1} - 2u_j + u_{j-1})\n$$\n两边除以 $h$，我们得到关于 $u_j(t)$ 的最终半离散格式：\n$$\n\\frac{d u_j}{dt} = \\frac{\\kappa}{h^2} (u_{j+1} - 2u_j + u_{j-1})\n$$\n这可以被识别为扩散算子 $\\kappa \\partial_{xx}u$ 的标准二阶中心有限差分近似。\n\n### 步骤 3：傅里叶分析\n\n为了求出傅里叶符号 $\\lambda(\\theta)$，我们分析半离散算子在单个傅里叶模式上的作用。我们假设解的形式为 $u_j(t) = \\tilde{u}(t)\\exp(i\\theta j)$，其中 $\\theta$ 是实值傅里叶频率。问题通过关系式 $\\frac{d u_j}{dt} = \\lambda(\\theta) u_j$ 来定义 $\\lambda(\\theta)$。\n\n我们将右侧的算子应用于这种形式的 $u_j$：\n$$\n\\frac{\\kappa}{h^2} (u_{j+1} - 2u_j + u_{j-1}) = \\frac{\\kappa}{h^2} \\left[ \\tilde{u}(t)\\exp(i\\theta(j+1)) - 2\\tilde{u}(t)\\exp(i\\theta j) + \\tilde{u}(t)\\exp(i\\theta(j-1)) \\right]\n$$\n提出公因子 $\\tilde{u}(t)\\exp(i\\theta j) = u_j(t)$：\n$$\n= \\frac{\\kappa}{h^2} u_j(t) \\left[ \\exp(i\\theta) - 2 + \\exp(-i\\theta) \\right]\n$$\n使用欧拉公式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，方括号中的项变为：\n$$\n\\exp(i\\theta) - 2 + \\exp(-i\\theta) = 2\\cos(\\theta) - 2 = 2(\\cos(\\theta) - 1)\n$$\n使用半角三角恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\frac{\\theta}{2})$，这可以进一步简化为：\n$$\n2\\left(-2\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = -4\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n因此，对于模式 $u_j$ 的半离散方程是：\n$$\n\\frac{d u_j}{dt} = \\frac{\\kappa}{h^2} u_j(t) \\left( -4\\sin^2\\left(\\frac{\\theta}{2}\\right) \\right) = \\left( -\\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\theta}{2}\\right) \\right) u_j(t)\n$$\n通过将其与定义 $\\frac{d u_j}{dt} = \\lambda(\\theta) u_j$ 进行比较，我们可以确定傅里叶符号 $\\lambda(\\theta)$。\n\n### 步骤 4：傅里叶符号的最终表达式\n\n半离散算子的傅里叶符号是：\n$$\n\\lambda(\\theta) = -\\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n该表达式是实数且非正，这是扩散方程稳定数值格式的一个特征。",
            "answer": "$$\\boxed{-\\frac{4\\kappa}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right)}$$"
        },
        {
            "introduction": "在解决了扩散问题之后，我们现在转向平流方程，其中数值通量的选择对稳定性至关重要。此练习将引导你进行能量分析，以直接比较中心通量和迎风通量。你将从量化的角度理解迎风格式如何引入必要的数值耗散，这是为双曲问题构建稳定DG格式的关键机制。",
            "id": "3376796",
            "problem": "考虑一维线性平流方程 $u_{t} + a \\, u_{x} = 0$，其中平流速度 $a > 0$ 为常数，定义在周期性区域 $[0,L]$ 上。设 $[0,L]$ 被划分为 $N$ 个不重叠的区间 $I_{j} = [x_{j-1/2}, x_{j+1/2}]$，$j = 1, \\dots, N$，并具有周期性标识 $x_{N+1/2} \\equiv x_{1-1/2}$。设 $u_{h}$ 为每个单元中次数为 $p \\geq 0$ 的间断 Galerkin (DG) 近似，并考虑通过将守恒律乘以一个测试函数 $v$ 并在每个区间上分部积分得到的 DG 弱形式。在每个界面 $x_{j+1/2}$ 处，定义左迹和右迹 $u_{h}^{-} = \\lim_{x \\uparrow x_{j+1/2}} u_{h}(x)$ 和 $u_{h}^{+} = \\lim_{x \\downarrow x_{j+1/2}} u_{h}(x)$，以及跳跃和平均\n$$[w] = w^{+} - w^{-}, \\qquad \\{ w \\} = \\frac{w^{-} + w^{+}}{2}.$$\n设物理通量 $f(u) = a u$ 的数值通量为中心通量 $\\hat{f}_{c}(u^{-},u^{+}) = a \\, \\{ u \\}$ 或迎风通量 (对于 $a>0$) $\\hat{f}_{u}(u^{-},u^{+}) = a \\, u^{-}$。定义离散能量\n$$E(t) = \\frac{1}{2} \\sum_{j=1}^{N} \\int_{I_{j}} u_{h}(x,t)^{2} \\, dx.$$\n从选择 $v = u_{h}$ 的 DG 弱形式出发，推导在周期性边界条件下，两种通量对能量时间导数 $\\frac{d}{dt} E(t)$ 的总界面贡献的精确表达式。将最终答案表示为一个包含两个条目的单一闭式解析行向量，其中第一个条目是中心通量的总界面贡献，第二个条目是迎风通量的总界面贡献，完全用 $a$ 和所有界面上的跳跃 $[u_{h}]$ 来表示。无需进行数值计算。用关于所有界面 $x_{j+1/2}$ 的总和来表述结果。",
            "solution": "该问题要求推导应用于线性平流方程的间断 Galerkin (DG) 方法中，离散能量的时间导数的总界面贡献。\n\n离散能量定义为\n$$E(t) = \\frac{1}{2} \\sum_{j=1}^{N} \\int_{I_{j}} u_{h}(x,t)^{2} \\, dx$$\n其中 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 是第 $j$ 个单元。对时间 $t$ 求导，我们得到\n$$\\frac{dE}{dt} = \\sum_{j=1}^{N} \\int_{I_{j}} u_{h} \\frac{\\partial u_{h}}{\\partial t} \\, dx$$\n平流方程 $u_{t} + a \\, u_{x} = 0$ 的半离散 DG 格式是通过乘以一个测试函数 $v$ 并在单元 $I_j$ 上积分得到的。对于任意测试函数 $v$，在单元 $I_j$ 上的弱形式为：\n$$\\int_{I_{j}} \\frac{\\partial u_{h}}{\\partial t} v \\, dx - \\int_{I_{j}} (a u_{h}) \\frac{\\partial v}{\\partial x} \\, dx + \\hat{f}_{j+1/2} v(x_{j+1/2}^{-}) - \\hat{f}_{j-1/2} v(x_{j-1/2}^{+}) = 0$$\n其中 $\\hat{f}_{j+1/2} = \\hat{f}(u_h(x_{j+1/2}^{-}), u_h(x_{j+1/2}^{+}))$ 是界面 $x_{j+1/2}$ 处的数值通量。注意，$v(x_{j+1/2}^{-})$ 是测试函数在单元 $I_j$ 内部于其右边界的迹，而 $v(x_{j-1/2}^{+})$ 是测试函数在单元 $I_j$ 内部于其左边界的迹。\n\n我们令 $v = u_{h}$：\n$$\\int_{I_{j}} \\frac{\\partial u_{h}}{\\partial t} u_{h} \\, dx - \\int_{I_{j}} a u_{h} \\frac{\\partial u_{h}}{\\partial x} \\, dx + \\hat{f}_{j+1/2} u_{h}(x_{j+1/2}^{-}) - \\hat{f}_{j-1/2} u_{h}(x_{j-1/2}^{+}) = 0$$\n认识到 $\\int_{I_j} u_h \\frac{\\partial u_h}{\\partial x} \\, dx = \\int_{I_j} \\frac{1}{2} \\frac{\\partial (u_h^2)}{\\partial x} \\, dx = \\frac{1}{2} [u_h^2]_{x_{j-1/2}^{+}}^{x_{j+1/2}^{-}} = \\frac{1}{2} \\left((u_{h}(x_{j+1/2}^{-}))^{2} - (u_{h}(x_{j-1/2}^{+}))^{2}\\right)$，我们可以写出：\n$$\\frac{1}{2}\\frac{d}{dt} \\int_{I_j} u_h^2 \\, dx = \\frac{a}{2} \\left((u_{h}(x_{j+1/2}^{-}))^{2} - (u_{h}(x_{j-1/2}^{+}))^{2}\\right) - \\hat{f}_{j+1/2} u_{h}(x_{j+1/2}^{-}) + \\hat{f}_{j-1/2} u_{h}(x_{j-1/2}^{+})$$\n现在，我们对从 $j=1$ 到 $N$ 的所有单元求和：\n$$\\frac{dE}{dt} = \\sum_{j=1}^{N} \\left[ \\frac{a}{2} \\left( (u_{h}(x_{j+1/2}^{-}))^{2} - (u_{h}(x_{j-1/2}^{+}))^{2} \\right) - \\hat{f}_{j+1/2} u_{h}(x_{j+1/2}^{-}) + \\hat{f}_{j-1/2} u_{h}(x_{j-1/2}^{+}) \\right]$$\n这是一个对单元的求和。我们将其重排为对界面的求和。考虑一个一般的界面 $x_{k+1/2}$。它是单元 $I_k$ 的右边界和单元 $I_{k+1}$ 的左边界。\n来自单元 $I_k$ 且涉及该界面的项是：$\\frac{a}{2}(u_{h}(x_{k+1/2}^{-}))^{2} - \\hat{f}_{k+1/2} u_{h}(x_{k+1/2}^{-})$。\n来自单元 $I_{k+1}$ 且涉及该界面的项是：$-\\frac{a}{2}(u_{h}(x_{k+1/2}^{+}))^{2} + \\hat{f}_{k+1/2} u_{h}(x_{k+1/2}^{+})$。\n对界面 $x_{k+1/2}$ 的这些贡献求和得到：\n$$\\frac{a}{2} \\left( (u_{h}^{-})^{2} - (u_{h}^{+})^{2} \\right) + \\hat{f}_{k+1/2} (u_{h}^{+} - u_{h}^{-})$$\n其中我们使用问题中的记号 $u_h^{-} = u_h(x_{k+1/2}^{-})$ 和 $u_h^{+} = u_h(x_{k+1/2}^{+})$。\n使用跳跃 $[u_h] = u_h^+ - u_h^-$ 和平均 $\\{u_h\\} = \\frac{u_h^- + u_h^+}{2}$ 的定义，我们可以重写第一项：\n$$(u_h^-)^2 - (u_h^+)^2 = (u_h^- - u_h^+)(u_h^- + u_h^+) = (-[u_h])(2\\{u_h\\}) = -2\\{u_h\\}[u_h]$$\n因此，来自界面 $x_{k+1/2}$ 的总贡献为：\n$$\\frac{a}{2} \\left( -2\\{u_h\\}[u_h] \\right) + \\hat{f}_{k+1/2}[u_h] = -a\\{u_h\\}[u_h] + \\hat{f}_{k+1/2}[u_h] = \\left(\\hat{f}_{k+1/2} - a\\{u_h\\}\\right)[u_h]$$\n由于周期性边界条件，对所有单元求和并重排为对所有界面的求和，会导致所有单元内部项的抵消，而 $\\frac{dE}{dt}$ 仅由这些界面贡献的总和给出。\n$$\\frac{dE}{dt} = \\sum_{j=1}^{N} \\left( \\hat{f}_{j+1/2} - a\\{u_h\\}_{j+1/2} \\right) [u_h]_{j+1/2}$$\n此表达式表示能量时间导数的总界面贡献。\n\n我们现在对两种指定的数值通量计算此表达式。\n\n**情况1：中心通量**\n中心通量为 $\\hat{f}_{c}(u^{-}, u^{+}) = a \\{u_h\\}$。将其代入一般表达式中：\n$$\\frac{dE}{dt} \\Big|_{\\text{central}} = \\sum_{j=1}^{N} \\left( a\\{u_h\\}_{j+1/2} - a\\{u_h\\}_{j+1/2} \\right) [u_h]_{j+1/2} = \\sum_{j=1}^{N} (0) \\cdot [u_h]_{j+1/2} = 0$$\n因此，对于中心通量，对能量导数的总界面贡献为 $0$。该格式是能量守恒的。\n\n**情况2：迎风通量**\n对于 $a > 0$，迎风通量为 $\\hat{f}_{u}(u^{-}, u^{+}) = a u_h^{-}$。代入得：\n$$\\frac{dE}{dt} \\Big|_{\\text{upwind}} = \\sum_{j=1}^{N} \\left( a u_h^{-}|_{j+1/2} - a\\{u_h\\}_{j+1/2} \\right) [u_h]_{j+1/2}$$\n让我们简化括号中的项：\n$$a u_h^{-} - a\\{u_h\\} = a u_h^{-} - a \\frac{u_h^{-} + u_h^{+}}{2} = \\frac{a}{2} (2u_h^{-} - u_h^{-} - u_h^{+}) = \\frac{a}{2} (u_h^{-} - u_h^{+}) = -\\frac{a}{2} (u_h^{+} - u_h^{-}) = -\\frac{a}{2} [u_h]$$\n将此代回求和式中：\n$$\\frac{dE}{dt} \\Big|_{\\text{upwind}} = \\sum_{j=1}^{N} \\left( -\\frac{a}{2} [u_h]_{j+1/2} \\right) [u_h]_{j+1/2} = -\\frac{a}{2} \\sum_{j=1}^{N} \\left([u_h]_{j+1/2}\\right)^2$$\n对于迎风通量，总界面贡献是耗散的，因为 $- \\frac{a}{2} \\sum_{j=1}^{N} [u_h]_{j+1/2}^2 \\le 0$。\n\n最终答案是一个包含这两个结果的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & -\\frac{a}{2} \\sum_{j=1}^{N} [u_{h}]_{j+1/2}^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "基于迎风格式的原理，我们将分析扩展到有界域上的问题，这更能代表现实世界的应用。这个问题要求你在区域边界上设计和分析数值通量，以正确施加入流条件，同时允许信息在出流边界自由流出。最终的能量平衡关系将揭示边界条件如何影响数值解的整体稳定性。",
            "id": "3376765",
            "problem": "考虑具有常速度 $a>0$ 的一维线性平流方程，\n$$\nu_{t} + a\\,u_{x} = 0 \\quad \\text{for} \\quad x \\in (0,1), \\ t>0,\n$$\n该方程满足在 $x=0$ 处的流入边界条件 $u(0,t)=g(t)$，其中 $g$ 是一个给定的关于时间的充分光滑函数。将空间域划分为 $N$ 个不重叠的区间 $\\{I_{j}\\}_{j=1}^{N}$，其中 $I_{j}=(x_{j-1},x_{j})$，$0=x_{0} < x_1 < \\dots < x_N = 1$。推导离散能量 $E(t)=\\tfrac{1}{2}\\,\\|u_{h}(\\cdot,t)\\|_{L^{2}(0,1)}^{2}$ 的时间导数的显式表达式，该表达式是由以下指定的迎风不连续伽辽金格式产生的：对于 $j=1,\\dots,N-1$，$x_{j}$ 处的内部通量为 $\\widehat{f}(x_{j},t)=a\\,u_{h}(x_{j}^{-},t)$；在 $x=0$ 处的流入通量为 $\\widehat{f}(0,t)=a\\,g(t)$；在 $x=1$ 处的流出通量为 $\\widehat{f}(1,t)=a\\,u_{h}(1^{-},t)$。",
            "solution": "我们从区间 $(0,1)$ 上的线性平流方程 $u_{t} + a\\,u_{x} = 0$ 开始，其流入边界数据为 $u(0,t)=g(t)$ 且 $a>0$。不连续伽辽金(DG)半离散近似旨在寻找 $u_{h}(t) \\in V_{h}$，使得对于任意测试函数 $v_{h} \\in V_{h}$ 和每个单元 $I_{j}=(x_{j-1},x_{j})$，都有：\n$$\n\\int_{I_{j}} u_{h,t}\\, v_{h}\\,dx \\;-\\; \\int_{I_{j}} a\\,u_{h}\\,(v_{h})_{x}\\,dx \\;+\\; \\widehat{f}(x_{j},t)\\, v_{h}(x_{j}^{-},t) \\;-\\; \\widehat{f}(x_{j-1},t)\\, v_{h}(x_{j-1}^{+},t) \\;=\\; 0.\n$$\n此处 $\\widehat{f}$ 是物理通量 $f(u)=a\\,u$ 的数值通量。对于 $a>0$，内部界面上的迎风通量为 $\\widehat{f}(x_{j},t)=a\\,u_{h}(x_{j}^{-},t)$（$j=1,\\dots,N-1$）。在流入边界 $x=0$ 处，通量由数据设定，$\\widehat{f}(0,t)=a\\,g(t)$；而在流出边界 $x=1$ 处，“无为”条件选择 $\\widehat{f}(1,t)=a\\,u_{h}(1^{-},t)$。\n\n为了获得能量恒等式，我们在每个单元上选择 $v_{h}=u_{h}$，然后对所有单元 $j=1,\\dots,N$ 求和。第一项得到\n$$\n\\sum_{j=1}^{N} \\int_{I_{j}} u_{h,t}\\, u_{h}\\,dx \\;=\\; \\tfrac{1}{2}\\,\\frac{d}{dt}\\sum_{j=1}^{N} \\int_{I_{j}} u_{h}^{2}\\,dx \\;=\\; \\frac{d}{dt} E(t).\n$$\n对于第二项，在每个单元上进行分部积分：\n$$\n- \\int_{I_{j}} a\\,u_{h}\\,(u_{h})_{x}\\,dx \\;=\\; -\\tfrac{a}{2}\\,\\left[ u_{h}(x_{j}^{-},t)^{2} - u_{h}(x_{j-1}^{+},t)^{2} \\right].\n$$\n对 $j$ 求和并加上界面上的数值通量贡献，每个内部界面 $x_{j}$（$j=1,\\dots,N-1$）的贡献为\n$$\n\\widehat{f}(x_{j},t)\\,\\Big(u_{h}(x_{j}^{-},t) - u_{h}(x_{j}^{+},t)\\Big) \\;-\\; \\tfrac{a}{2}\\,\\Big( u_{h}(x_{j}^{-},t)^{2} - u_{h}(x_{j}^{+},t)^{2} \\Big).\n$$\n采用迎风通量选择 $\\widehat{f}(x_{j},t)=a\\,u_{h}(x_{j}^{-},t)$，上式变为\n$$\n\\Big(u_{h}(x_{j}^{-},t) - u_{h}(x_{j}^{+},t)\\Big)\\,\\Big(a\\,u_{h}(x_{j}^{-},t) - \\tfrac{a}{2}\\big(u_{h}(x_{j}^{-},t)+u_{h}(x_{j}^{+},t)\\big) \\Big)\n\\;=\\; \\tfrac{a}{2}\\,\\Big(u_{h}(x_{j}^{-},t) - u_{h}(x_{j}^{+},t)\\Big)^{2}.\n$$\n使用跳跃项记号 $[\\![u_{h}]\\!](x_{j},t)=u_{h}(x_{j}^{+},t)-u_{h}(x_{j}^{-},t)$，每个内部界面的贡献为 $\\tfrac{a}{2}\\,[\\![u_{h}]\\!](x_{j},t)^{2}$。\n\n对于边界面，我们分别收集左边界（$x=0$）和右边界（$x=1$）的贡献。在 $x=0$ 处，只有单元 $I_{1}$ 有贡献。从分部积分项我们得到 $+\\tfrac{a}{2}\\,u_{h}(0^{+},t)^{2}$，从数值通量项我们得到 $-\\widehat{f}(0,t)\\,u_{h}(0^{+},t) = -a\\,g(t)\\,u_{h}(0^{+},t)$。因此，在 $x=0$ 处的总贡献是\n$$\n-\\;a\\,g(t)\\,u_{h}(0^{+},t) \\;+\\; \\tfrac{a}{2}\\,u_{h}(0^{+},t)^{2}\n\\;=\\; \\tfrac{a}{2}\\,\\Big( \\big(u_{h}(0^{+},t)-g(t)\\big)^{2} - g(t)^{2} \\Big).\n$$\n在 $x=1$ 处，只有单元 $I_{N}$ 有贡献。从分部积分项我们得到 $-\\tfrac{a}{2}\\,u_{h}(1^{-},t)^{2}$，从数值通量项我们得到 $+\\widehat{f}(1,t)\\,u_{h}(1^{-},t) = +a\\,u_{h}(1^{-},t)^{2}$。在 $x=1$ 处的总贡献是\n$$\na\\,u_{h}(1^{-},t)^{2} \\;-\\; \\tfrac{a}{2}\\,u_{h}(1^{-},t)^{2} \\;=\\; \\tfrac{a}{2}\\,u_{h}(1^{-},t)^{2}.\n$$\n\n将单元上的时间导数、所有内部界面的贡献以及两个边界的贡献放在一起，求和后的DG方程给出了精确的能量平衡关系\n$$\n\\frac{d}{dt} E(t) \\;+\\; \\frac{a}{2}\\sum_{j=1}^{N-1} [\\![u_{h}]\\!](x_{j},t)^{2} \\;+\\; \\frac{a}{2}\\,u_{h}(1^{-},t)^{2} \\;+\\; \\frac{a}{2}\\,\\big(u_{h}(0^{+},t)-g(t)\\big)^{2} \\;=\\; \\frac{a}{2}\\,g(t)^{2}.\n$$\n等价地，能量的时间导数是以下闭式表达式\n$$\n\\frac{d}{dt} E(t) \\;=\\; -\\,\\frac{a}{2}\\sum_{j=1}^{N-1} [\\![u_{h}]\\!](x_{j},t)^{2} \\;-\\; \\frac{a}{2}\\,u_{h}(1^{-},t)^{2} \\;-\\; \\frac{a}{2}\\,\\big(u_{h}(0^{+},t)-g(t)\\big)^{2} \\;+\\; \\frac{a}{2}\\,g(t)^{2}.\n$$\n\n对离散守恒性和稳定性的影响直接如下：\n- 质量的离散守恒（使用 $v_{h}\\equiv 1$ 作为测试函数，因此 $(v_{h})_{x}=0$）给出\n$$\n\\frac{d}{dt} \\int_{0}^{1} u_{h}(x,t)\\,dx \\;+\\; \\widehat{f}(1,t) \\;-\\; \\widehat{f}(0,t) \\;=\\; 0,\n$$\n即，\n$$\n\\frac{d}{dt} \\int_{0}^{1} u_{h}(x,t)\\,dx \\;=\\; a\\,g(t) \\;-\\; a\\,u_{h}(1^{-},t),\n$$\n这表明质量在内部是精确守恒的，并且只通过设计的边界通量进行交换。\n- 能量恒等式表明，内部迎风格式和流出边界条件的选择产生了非负的耗散项 $\\tfrac{a}{2}\\sum [\\![u_{h}]\\!]^2$ 和 $\\tfrac{a}{2}u_{h}(1^{-})^{2}$，而流入边界条件贡献了控制项 $\\tfrac{a}{2}\\big(u_{h}(0^{+})-g\\big)^{2}$ 和源项 $\\tfrac{a}{2}g^{2}$。特别地，对于齐次流入 $g\\equiv 0$，我们有 $\\dfrac{d}{dt}E(t) \\le 0$，这证明了半离散意义下的 $L^{2}$-稳定性。\n\n因此，所要求的 $\\dfrac{d}{dt} E(t)$ 的显式表达式如上所示。",
            "answer": "$$\\boxed{\\frac{d}{dt}\\left(\\tfrac{1}{2}\\,\\|u_{h}(\\cdot,t)\\|_{L^{2}(0,1)}^{2}\\right)\\;=\\;-\\frac{a}{2}\\sum_{j=1}^{N-1}[\\![u_{h}]\\!](x_{j},t)^{2}\\;-\\;\\frac{a}{2}\\,u_{h}(1^{-},t)^{2}\\;-\\;\\frac{a}{2}\\,\\big(u_{h}(0^{+},t)-g(t)\\big)^{2}\\;+\\;\\frac{a}{2}\\,g(t)^{2}}$$"
        }
    ]
}