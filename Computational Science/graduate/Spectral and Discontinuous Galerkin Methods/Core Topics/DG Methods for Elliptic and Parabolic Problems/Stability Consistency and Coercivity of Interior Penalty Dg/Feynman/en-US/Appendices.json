{
    "hands_on_practices": [
        {
            "introduction": "To trust a numerical method, we must first confirm that it correctly represents the underlying physics and mathematical properties of the problem it aims to solve. This exercise grounds the abstract formulation of the Symmetric Interior Penalty Galerkin (SIPG) method in its two most fundamental properties: symmetry and consistency . By explicitly calculating the boundary terms from first principles, you will verify that the bilinear form is symmetric and, critically, that it is consistent with the original differential equation's weak form when applied to a smooth solution.",
            "id": "3420636",
            "problem": "Consider the scalar second-order elliptic model problem in one-dimension on the open interval $\\Omega = (0,L)$ with $L>0$,\n$$\n- u'' = f \\quad \\text{in } (0,L),\n$$\nsubject to homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(L)=0$. Let $\\mathcal{T}_h$ be a uniform partition of $(0,L)$ into $M \\in \\mathbb{N}$ subintervals of equal length $h = L/M$. Let $n$ denote the outward unit normal on the boundary $\\partial \\Omega = \\{0,L\\}$, hence $n(0)=-1$ and $n(L)=+1$. Let $u_h$ and $v_h$ be arbitrary functions in a discontinuous polynomial space on $\\mathcal{T}_h$.\n\nAdopt the standard Discontinuous Galerkin (DG) jump and average operators for a scalar field $w$ and a flux $q$ as follows. On an interior face (node) separating two elements, define the jump\n$$\n[w] := w^{-} n^{-} + w^{+} n^{+},\n$$\nand the average\n$$\n\\{q\\} := \\tfrac{1}{2}\\left(q^{-}+q^{+}\\right),\n$$\nwhere $n^{-}$ and $n^{+}$ are the outward unit normals from the left and right elements, respectively. On a boundary face $x \\in \\partial \\Omega$, define\n$$\n[w] := w\\, n, \\qquad \\{q\\} := q,\n$$\nwhere $n$ is the outward unit normal at $x$ and $q$ is the trace of the flux from the unique adjacent element.\n\nThe Symmetric Interior Penalty Galerkin (SIPG) bilinear form $a_h(u_h,v_h)$ is built from elemental gradient inner-products and face contributions that use the above jumps and averages, with a positive penalty parameter $\\sigma>0$. Using only these definitions and the outward normals at $x=0$ and $x=L$, compute explicitly the total boundary contribution $B(u_h,v_h)$ to $a_h(u_h,v_h)$ on $\\partial \\Omega$ in terms of the traces $u_h(0)$, $u_h'(0)$, $v_h(0)$, $v_h'(0)$, $u_h(L)$, $u_h'(L)$, $v_h(L)$, $v_h'(L)$, the mesh size $h$, and the penalty $\\sigma$.\n\nThen, verify two properties of the derived boundary contribution:\n(i) symmetry, namely $B(u_h,v_h)=B(v_h,u_h)$ for all $u_h$ and $v_h$, and\n(ii) consistency with the continuous model problem, namely that if $u \\in H^{2}(0,L)$ satisfies $-u''=f$ in $(0,L)$ and $u(0)=u(L)=0$, then the full SIPG bilinear form reduces to\n$$\na_h(u,v_h) = \\int_{0}^{L} f\\, v_h \\,\\mathrm{d}x\n$$\nfor all $v_h$, when interior contributions are included according to the DG construction and the boundary contribution $B(u,v_h)$ you computed is used on $\\partial \\Omega$.\n\nYour final answer must be the single closed-form analytic expression for $B(u_h,v_h)$.",
            "solution": "The problem asks for the computation of the boundary contribution to the Symmetric Interior Penalty Galerkin (SIPG) bilinear form for a one-dimensional elliptic problem, and subsequent verification of its symmetry and consistency properties. The problem statement is validated as scientifically sound, well-posed, and sufficiently specified for a solution within the established context of discontinuous Galerkin methods.\n\nThe general form of the SIPG bilinear form $a_h(w, z)$ for the problem $-w''=f$ is constructed by integrating by parts twice on each element $K \\in \\mathcal{T}_h$. For functions $w, z$ in the discontinuous space, this yields:\n$$\na_h(w, z) = \\sum_{K \\in \\mathcal{T}_h} \\int_K w' z' \\, \\mathrm{d}x - \\sum_{e \\in \\mathcal{F}_h} \\left( \\{w'\\} [z] + \\epsilon [w] \\{z'\\} \\right) \\, \\mathrm{d}S + \\sum_{e \\in \\mathcal{F}_h} \\frac{\\sigma_e}{h_e} [w] [z] \\, \\mathrm{d}S\n$$\nwhere $\\mathcal{F}_h$ is the set of all faces (nodes in 1D), $\\epsilon$ is a parameter that is $+1$ for symmetric methods (SIPG), $-1$ for non-symmetric methods (NIPG), and $0$ for incomplete methods (IIPG). For SIPG, $\\epsilon=+1$. The penalty term involves a parameter $\\sigma_e > 0$ and the element size $h_e$. For the given uniform mesh, we let $h_e=h$ and $\\sigma_e=\\sigma$. The problem statement refers to \"the penalty $\\sigma$\"; for dimensional consistency, the penalty term must be of the form $\\frac{\\sigma}{h}$, where $\\sigma$ is a dimensionless positive parameter. The integrals over the faces, which are points in 1D, are interpreted as evaluation at those points.\n\nThe SIPG bilinear form is thus:\n$$\na_h(u_h,v_h) = \\sum_{K \\in \\mathcal{T}_h} \\int_K u_h' v_h' \\, \\mathrm{d}x - \\sum_{e \\in \\mathcal{F}_h} \\left( \\{u_h'\\} [v_h] + [u_h] \\{v_h'\\} \\right) + \\sum_{e \\in \\mathcal{F}_h} \\frac{\\sigma}{h} [u_h] [v_h]\n$$\nThe problem requires computing the total boundary contribution, $B(u_h, v_h)$, which consists of the terms evaluated on the boundary faces $\\partial\\Omega = \\{0, L\\}$.\n$$\nB(u_h, v_h) = \\left. \\left( - (\\{u_h'\\} [v_h] + [u_h] \\{v_h'\\}) + \\frac{\\sigma}{h} [u_h] [v_h] \\right) \\right|_{x=0} + \\left. \\left( - (\\{u_h'\\} [v_h] + [u_h] \\{v_h'\\}) + \\frac{\\sigma}{h} [u_h] [v_h] \\right) \\right|_{x=L}\n$$\n\nWe evaluate the jump and average operators at each boundary point using the provided definitions. The traces $u_h(0), u_h'(0)$, etc., are understood as the limits from within the domain, i.e., $u_h(0^+), u_h'(0^+)$, etc.\n\nAt the left boundary, $x=0$:\nThe outward unit normal is $n(0) = -1$. The fields $u_h, u_h'$ are taken from the interior of the domain, i.e., from the element $(0, h)$.\nUsing the boundary definitions $[w] := w n$ and $\\{q\\} := q$:\n$$\n[u_h](0) = u_h(0) n(0) = -u_h(0)\n$$\n$$\n[v_h](0) = v_h(0) n(0) = -v_h(0)\n$$\n$$\n\\{u_h'\\}(0) = u_h'(0)\n$$\n$$\n\\{v_h'\\}(0) = v_h'(0)\n$$\nThe contribution at $x=0$ is:\n$$\n- (\\{u_h'\\}(0) [v_h](0) + [u_h](0) \\{v_h'\\}(0)) + \\frac{\\sigma}{h} [u_h](0) [v_h](0)\n$$\n$$\n= - (u_h'(0)(-v_h(0)) + (-u_h(0))v_h'(0)) + \\frac{\\sigma}{h} (-u_h(0))(-v_h(0))\n$$\n$$\n= u_h'(0)v_h(0) + u_h(0)v_h'(0) + \\frac{\\sigma}{h} u_h(0)v_h(0)\n$$\n\nAt the right boundary, $x=L$:\nThe outward unit normal is $n(L) = +1$. The fields are taken from the element $(L-h, L)$.\n$$\n[u_h](L) = u_h(L) n(L) = u_h(L)\n$$\n$$\n[v_h](L) = v_h(L) n(L) = v_h(L)\n$$\n$$\n\\{u_h'\\}(L) = u_h'(L)\n$$\n$$\n\\{v_h'\\}(L) = v_h'(L)\n$$\nThe contribution at $x=L$ is:\n$$\n- (\\{u_h'\\}(L) [v_h](L) + [u_h](L) \\{v_h'\\}(L)) + \\frac{\\sigma}{h} [u_h](L) [v_h](L)\n$$\n$$\n= - (u_h'(L)v_h(L) + u_h(L)v_h'(L)) + \\frac{\\sigma}{h} u_h(L)v_h(L)\n$$\n\nThe total boundary contribution $B(u_h, v_h)$ is the sum of the contributions at $x=0$ and $x=L$:\n$$\nB(u_h,v_h) = \\left( u_h'(0)v_h(0) + u_h(0)v_h'(0) + \\frac{\\sigma}{h} u_h(0)v_h(0) \\right) + \\left( - u_h'(L)v_h(L) - u_h(L)v_h'(L) + \\frac{\\sigma}{h} u_h(L)v_h(L) \\right)\n$$\nThis expression can be rearranged as:\n$$\nB(u_h,v_h) = u_h'(0)v_h(0) + u_h(0)v_h'(0) - u_h'(L)v_h(L) - u_h(L)v_h'(L) + \\frac{\\sigma}{h} \\left( u_h(0)v_h(0) + u_h(L)v_h(L) \\right)\n$$\nThis is the required expression for the total boundary contribution.\n\nNext, we verify the two requested properties.\n\n(i) Symmetry: We must verify that $B(u_h,v_h) = B(v_h,u_h)$.\nBy swapping $u_h$ and $v_h$ in the expression for $B(u_h,v_h)$:\n$$\nB(v_h,u_h) = v_h'(0)u_h(0) + v_h(0)u_h'(0) - v_h'(L)u_h(L) - v_h(L)u_h'(L) + \\frac{\\sigma}{h} \\left( v_h(0)u_h(0) + v_h(L)u_h(L) \\right)\n$$\nDue to the commutativity of scalar multiplication and addition, this is identical to the expression for $B(u_h,v_h)$. Thus, the boundary contribution is symmetric.\n\n(ii) Consistency: We must verify that if $u \\in H^2(0,L)$ is the exact solution, with $-u''=f$ and $u(0)=u(L)=0$, then $a_h(u, v_h) = \\int_0^L f v_h \\, \\mathrm{d}x$.\n\nThe full bilinear form is:\n$$\na_h(u,v_h) = \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v_h' \\, \\mathrm{d}x - \\sum_{e \\in \\mathcal{F}_h^I} \\left( \\{u'\\} [v_h] + [u] \\{v_h'\\} \\right) + \\sum_{e \\in \\mathcal{F}_h^I} \\frac{\\sigma}{h} [u] [v_h] + B(u, v_h)\n$$\nWe apply integration by parts to the first term on each element $K_j = (x_{j-1}, x_j)$:\n$$\n\\sum_{j=1}^M \\int_{K_j} u' v_h' \\, \\mathrm{d}x = \\sum_{j=1}^M \\left( \\left[ u' v_h \\right]_{x_{j-1}}^{x_j} - \\int_{K_j} u'' v_h \\, \\mathrm{d}x \\right)\n$$\nSince $-u'' = f$, the second part is $\\sum_j \\int_{K_j} f v_h \\, \\mathrm{d}x = \\int_0^L f v_h \\, \\mathrm{d}x$.\nThe boundary part of the sum is $\\sum_{j=1}^M ( u'(x_j^-) v_h(x_j^-) - u'(x_{j-1}^+) v_h(x_{j-1}^+) )$.\nSince $u \\in H^2(0,L)$, its first derivative $u'$ is continuous. So, $u'(x_j^-) = u'(x_j^+) = u'(x_j)$ for all interior nodes $x_j$. The sum of boundary terms from integration by parts becomes:\n$$\nu'(L)v_h(L) - u'(0)v_h(0) + \\sum_{j=1}^{M-1} u'(x_j) (v_h(x_j^-) - v_h(x_j^+))\n$$\nNow, consider the interior face terms in $a_h(u,v_h)$. Since $u$ is smooth, at any interior face $e=x_j$, we have $[u] = u(x_j^-) n^- + u(x_j^+) n^+ = u(x_j)(+1) + u(x_j)(-1) = 0$. Also, $\\{u'\\} = \\frac{1}{2}(u'(x_j^-)+u'(x_j^+)) = u'(x_j)$.\nThe interior face sum is:\n$$\n- \\sum_{j=1}^{M-1} \\left( \\{u'\\} [v_h] + [u] \\{v_h'\\} - \\frac{\\sigma}{h} [u] [v_h] \\right) = - \\sum_{j=1}^{M-1} \\left( u'(x_j)[v_h] + 0 + 0 \\right)\n$$\nAt an interior face $x_j$, $[v_h] = v_h(x_j^-)n^- + v_h(x_j^+)n^+ = v_h(x_j^-) - v_h(x_j^+)$. So the interior face contribution is $-\\sum_{j=1}^{M-1} u'(x_j)(v_h(x_j^-) - v_h(x_j^+))$.\n\nCombining all parts of $a_h(u, v_h)$:\n$$\na_h(u, v_h) = \\left( u'(L)v_h(L) - u'(0)v_h(0) + \\sum_{j=1}^{M-1} u'(x_j)(v_h(x_j^-) - v_h(x_j^+)) + \\int_0^L f v_h \\, \\mathrm{d}x \\right)\n$$\n$$\n- \\left( \\sum_{j=1}^{M-1} u'(x_j)(v_h(x_j^-) - v_h(x_j^+)) \\right) + B(u, v_h)\n$$\nThe sums over interior faces cancel out, leaving:\n$$\na_h(u, v_h) = u'(L)v_h(L) - u'(0)v_h(0) + \\int_0^L f v_h \\, \\mathrm{d}x + B(u, v_h)\n$$\nNow we evaluate $B(u, v_h)$ using the boundary conditions $u(0)=0$ and $u(L)=0$:\n$$\nB(u,v_h) = u'(0)v_h(0) + u(0)v_h'(0) - u'(L)v_h(L) - u(L)v_h'(L) + \\frac{\\sigma}{h} \\left( u(0)v_h(0) + u(L)v_h(L) \\right)\n$$\n$$\nB(u,v_h) = u'(0)v_h(0) + 0 - u'(L)v_h(L) - 0 + \\frac{\\sigma}{h} (0 + 0) = u'(0)v_h(0) - u'(L)v_h(L)\n$$\nSubstituting this into the expression for $a_h(u, v_h)$:\n$$\na_h(u, v_h) = (u'(L)v_h(L) - u'(0)v_h(0)) + \\int_0^L f v_h \\, \\mathrm{d}x + (u'(0)v_h(0) - u'(L)v_h(L))\n$$\nThe boundary terms cancel completely:\n$$\na_h(u, v_h) = \\int_0^L f v_h \\, \\mathrm{d}x\n$$\nThis demonstrates the consistency of the SIPG formulation. The final answer required is the analytical expression for $B(u_h,v_h)$.",
            "answer": "$$\\boxed{u_h'(0)v_h(0) + u_h(0)v_h'(0) - u_h'(L)v_h(L) - u_h(L)v_h'(L) + \\frac{\\sigma}{h} \\left( u_h(0)v_h(0) + u_h(L)v_h(L) \\right)}$$"
        },
        {
            "introduction": "The penalty term is the defining feature of Interior Penalty methods, but its inclusion is not arbitrary; it is essential for mathematical stability. This practice provides a compelling demonstration of this necessity by guiding you through the construction of a \"worst-case\" scenario on a simple two-element mesh . By crafting a specific function with a jump discontinuity, you will show that if the penalty parameter $\\sigma$ is too small, the method's core stability property—coercivity—can be lost, making the abstract condition tangible.",
            "id": "3420600",
            "problem": "Consider the Symmetric Interior Penalty Discontinuous Galerkin (SIPDG) method for the one-dimensional Poisson operator on a two-element mesh. Let the mesh consist of two adjacent elements $K_1 = (0,h)$ and $K_2 = (h,2h)$, with a single interior face at $x=h$. Assume unit diffusion coefficient and ignore boundary-face contributions by focusing on this interior patch. For any piecewise-smooth function $v$, define the jump at the interior face by $[v] := v(h^{+}) - v(h^{-})$ and the average of the derivative by $\\{v'\\} := \\frac{1}{2}\\left(v'|_{K_1}(h^{-}) + v'|_{K_2}(h^{+})\\right)$. The SIPDG bilinear form on this two-element patch is\n$$\na_h(u,v) := \\sum_{K \\in \\{K_1,K_2\\}} \\int_{K} u'v'\\,dx \\;-\\; (\\{u'\\}\\,[v] + \\{v'\\}\\,[u]) \\;+\\; \\frac{\\sigma}{h}\\,[u]\\,[v],\n$$\nwhere $\\sigma > 0$ is the penalty parameter.\n\nTake polynomial degree $p=1$ and consider the specific discontinuous, piecewise-linear function\n$$\nv(x) \\;=\\; \n\\begin{cases}\n\\dfrac{x}{h}, & x \\in K_1, \\\\[6pt]\n\\dfrac{x-h}{h} + C, & x \\in K_2,\n\\end{cases}\n$$\nwhere $C \\in \\mathbb{R}$ is a constant. Starting only from the above definitions, compute $a_h(v,v)$ on this two-element patch as a function of $C$, $h$, and $\\sigma$. Then, choose $C$ to minimize $a_h(v,v)$ with respect to $C$, and report the minimized value of $a_h(v,v)$ as a single closed-form analytic expression in $h$ and $\\sigma$. Your final answer must be this minimized expression. No rounding is required.",
            "solution": "The problem asks to compute the value of the SIPDG bilinear form $a_h(v,v)$ for a specific piecewise-linear function $v(x)$ and then to find the minimum of this value with respect to the constant $C$ that defines the jump. This will demonstrate the role of the penalty parameter $\\sigma$ in ensuring coercivity.\n\nFirst, we evaluate the terms needed for $a_h(v,v)$. The bilinear form for $u=v$ is:\n$$\na_h(v,v) = \\sum_{K \\in \\{K_1,K_2\\}} \\int_K (v')^2 \\,dx - 2\\{v'\\}\\,[v] + \\frac{\\sigma}{h}\\,[v]^2\n$$\n\n**1. Compute derivatives and integrals:**\nThe function $v(x)$ is defined piecewise.\n- On element $K_1 = (0,h)$: $v(x) = \\frac{x}{h}$. The derivative is $v'(x) = \\frac{1}{h}$.\n- On element $K_2 = (h,2h)$: $v(x) = \\frac{x-h}{h} + C$. The derivative is $v'(x) = \\frac{1}{h}$.\n\nThe integral of $(v')^2$ over each element is:\n$$\n\\int_{K_1} (v')^2 \\,dx = \\int_0^h \\left(\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2} [x]_0^h = \\frac{h}{h^2} = \\frac{1}{h}\n$$\n$$\n\\int_{K_2} (v')^2 \\,dx = \\int_h^{2h} \\left(\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2} [x]_h^{2h} = \\frac{2h-h}{h^2} = \\frac{1}{h}\n$$\nThe sum of the integrals is:\n$$\n\\sum_{K \\in \\{K_1,K_2\\}} \\int_K (v')^2 \\,dx = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}\n$$\n\n**2. Compute jumps and averages at the interior face $x=h$:**\nWe need the function values and derivative values at the face from both sides.\n- From the left ($x \\to h^-$ in $K_1$): $v(h^-) = \\frac{h}{h} = 1$. The derivative is $v'(h^-) = \\frac{1}{h}$.\n- From the right ($x \\to h^+$ in $K_2$): $v(h^+) = \\frac{h-h}{h} + C = C$. The derivative is $v'(h^+) = \\frac{1}{h}$.\n\nUsing the problem's definitions:\n- The jump of $v$ is $[v] = v(h^+) - v(h^-) = C - 1$.\n- The average of $v'$ is $\\{v'\\} = \\frac{1}{2}(v'(h^-) + v'(h^+)) = \\frac{1}{2}\\left(\\frac{1}{h} + \\frac{1}{h}\\right) = \\frac{1}{h}$.\n\n**3. Assemble $a_h(v,v)$:**\nNow substitute these components into the expression for $a_h(v,v)$:\n$$\na_h(v,v) = \\frac{2}{h} - 2\\left(\\frac{1}{h}\\right)(C-1) + \\frac{\\sigma}{h}(C-1)^2\n$$\nThis is the expression for $a_h(v,v)$ as a function of $C$, $h$, and $\\sigma$.\n\n**4. Minimize $a_h(v,v)$ with respect to $C$:**\nThe expression is a quadratic function of $C$. To find the minimum, we take the derivative with respect to $C$ and set it to zero.\n$$\n\\frac{d}{dC} a_h(v,v) = \\frac{d}{dC} \\left( \\frac{2}{h} - \\frac{2(C-1)}{h} + \\frac{\\sigma(C-1)^2}{h} \\right)\n$$\n$$\n\\frac{d}{dC} a_h(v,v) = -\\frac{2}{h} + \\frac{2\\sigma(C-1)}{h} = 0\n$$\nSolving for $(C-1)$:\n$$\n\\frac{2\\sigma(C-1)}{h} = \\frac{2}{h} \\implies \\sigma(C-1) = 1 \\implies C-1 = \\frac{1}{\\sigma}\n$$\nThe second derivative is $\\frac{2\\sigma}{h}$, which is positive since $\\sigma > 0$ and $h > 0$, confirming this is a minimum.\n\n**5. Compute the minimized value:**\nSubstitute $C-1 = \\frac{1}{\\sigma}$ back into the expression for $a_h(v,v)$:\n$$\na_h(v,v)_{\\min} = \\frac{2}{h} - 2\\left(\\frac{1}{h}\\right)\\left(\\frac{1}{\\sigma}\\right) + \\frac{\\sigma}{h}\\left(\\frac{1}{\\sigma}\\right)^2\n$$\n$$\na_h(v,v)_{\\min} = \\frac{2}{h} - \\frac{2}{h\\sigma} + \\frac{\\sigma}{h\\sigma^2} = \\frac{2}{h} - \\frac{2}{h\\sigma} + \\frac{1}{h\\sigma}\n$$\n$$\na_h(v,v)_{\\min} = \\frac{2}{h} - \\frac{1}{h\\sigma} = \\frac{2\\sigma - 1}{h\\sigma}\n$$\nThis is the minimized value of $a_h(v,v)$. This result shows that if $2\\sigma - 1  0$ (i.e., $\\sigma  1/2$), the bilinear form $a_h(v,v)$ can be negative for this function $v(x)$. This would violate coercivity, demonstrating that the penalty parameter $\\sigma$ must be sufficiently large to ensure stability.",
            "answer": "$$\n\\boxed{\\frac{2\\sigma - 1}{h\\sigma}}\n$$"
        },
        {
            "introduction": "We have established that the penalty parameter must be \"sufficiently large\" to ensure stability, but how is this quantified in a practical implementation? This exercise bridges the gap between abstract stability theory and the concrete entries of a stiffness matrix . By analyzing the penalty term's contribution for a standard modal basis, you will derive the crucial scaling relationship that connects the penalty magnitude to the polynomial degree $p$ and element size $h$, a result dictated by fundamental polynomial trace inverse inequalities.",
            "id": "3420603",
            "problem": "Consider a one-dimensional second-order elliptic model posed on a single physical element $K = [x_{L}, x_{R}]$ of length $h = x_{R} - x_{L}$. Let the local approximation space on $K$ be the span of the modal Legendre basis of degree at most $p$, with $L^2(K)$-orthonormal basis functions given by $\\phi_{n}(x) = \\sqrt{\\frac{2n+1}{h}}\\,P_{n}(\\xi(x))$ for $n = 0, 1, \\dots, p$, where $P_{n}$ is the $n$-th Legendre polynomial on the reference coordinate $\\xi \\in [-1,1]$ and $\\xi(x) = \\frac{2(x - x_{c})}{h}$ with $x_{c} = \\frac{x_{L} + x_{R}}{2}$. In the symmetric interior penalty Discontinuous Galerkin (DG) method, the penalty contribution to the bilinear form on each face $F \\subset \\partial K$ is defined by $\\tau \\int_{F} u\\,v\\,\\mathrm{d}s$, where the penalty parameter is $\\tau = \\eta\\,\\frac{p(p+1)}{h}$ with fixed $\\eta  0$ independent of $h$ and $p$. Denote by $A_{nn}^{\\mathrm{pen}}$ the diagonal entry of the local stiffness matrix on $K$ corresponding to the mode $n$, arising solely from the penalty term. Using only the fundamental definitions above and properties of the Legendre polynomials, compute a closed-form expression for $A_{nn}^{\\mathrm{pen}}$ in terms of $n$, $p$, $h$, and $\\eta$, and relate its dependence on $p$ to the scaling predicted by polynomial trace inverse inequalities. The final answer must be a single closed-form analytic expression.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of discontinuous Galerkin methods, is well-posed, and uses objective, formal language. It presents a standard calculation based on fundamental definitions.\n\nThe quantity to be computed is $A_{nn}^{\\mathrm{pen}}$, the diagonal entry of the local stiffness matrix on element $K$ arising from the penalty term of the symmetric interior penalty Discontinuous Galerkin (DG) method. This entry corresponds to using the same basis function, $\\phi_n(x)$, for both the trial and test functions.\n\nThe penalty contribution to the bilinear form is given as $\\tau \\int_{F} u\\,v\\,\\mathrm{d}s$ for each face $F$ of the element $K$. For a one-dimensional element $K = [x_L, x_R]$, the boundary $\\partial K$ consists of two faces, which are the endpoints $F_L = \\{x_L\\}$ and $F_R = \\{x_R\\}$. The integral over a point face, $\\int_{F} \\mathrm{d}s$, is simply the evaluation of the integrand at that point.\n\nThus, the total penalty contribution for trial function $u$ and test function $v$ is the sum of the contributions from both faces:\n$$\n\\tau \\, u(x_L)v(x_L) + \\tau \\, u(x_R)v(x_R)\n$$\nTo find the diagonal entry $A_{nn}^{\\mathrm{pen}}$, we set $u = v = \\phi_n(x)$.\n$$\nA_{nn}^{\\mathrm{pen}} = \\tau (\\phi_n(x_L)^2 + \\phi_n(x_R)^2)\n$$\nThe basis functions are defined as $\\phi_n(x) = \\sqrt{\\frac{2n+1}{h}} P_n(\\xi(x))$, where $P_n$ is the $n$-th Legendre polynomial on the reference interval $[-1,1]$, and $\\xi(x)$ maps the physical element $K$ to this reference interval. The mapping is given by $\\xi(x) = \\frac{2(x - x_c)}{h}$, where $x_c = \\frac{x_L+x_R}{2}$ is the center of the element and $h = x_R - x_L$ is its length.\n\nWe evaluate the mapping $\\xi(x)$ at the endpoints of the physical element $K$:\nAt $x=x_L$:\n$$\n\\xi(x_L) = \\frac{2\\left(x_L - \\frac{x_L+x_R}{2}\\right)}{x_R-x_L} = \\frac{2\\left(\\frac{2x_L - x_L - x_R}{2}\\right)}{x_R-x_L} = \\frac{x_L - x_R}{x_R-x_L} = -1\n$$\nAt $x=x_R$:\n$$\n\\xi(x_R) = \\frac{2\\left(x_R - \\frac{x_L+x_R}{2}\\right)}{x_R-x_L} = \\frac{2\\left(\\frac{2x_R - x_L - x_R}{2}\\right)}{x_R-x_L} = \\frac{x_R - x_L}{x_R-x_L} = 1\n$$\nSo, evaluating the basis function $\\phi_n(x)$ at the endpoints requires evaluating the Legendre polynomial $P_n(\\xi)$ at $\\xi = -1$ and $\\xi = 1$. A fundamental property of Legendre polynomials is that for any integer degree $n \\ge 0$:\n$$\nP_n(1) = 1 \\quad \\text{and} \\quad P_n(-1) = (-1)^n\n$$\nUsing this property, we can find the values of $\\phi_n(x)$ at the element boundaries:\n$$\n\\phi_n(x_L) = \\sqrt{\\frac{2n+1}{h}} P_n(-1) = \\sqrt{\\frac{2n+1}{h}} (-1)^n\n$$\n$$\n\\phi_n(x_R) = \\sqrt{\\frac{2n+1}{h}} P_n(1) = \\sqrt{\\frac{2n+1}{h}}\n$$\nNow we compute the squared values:\n$$\n\\phi_n(x_L)^2 = \\left(\\sqrt{\\frac{2n+1}{h}} (-1)^n\\right)^2 = \\frac{2n+1}{h} ((-1)^n)^2 = \\frac{2n+1}{h}\n$$\n$$\n\\phi_n(x_R)^2 = \\left(\\sqrt{\\frac{2n+1}{h}}\\right)^2 = \\frac{2n+1}{h}\n$$\nSubstituting these into the expression for $A_{nn}^{\\mathrm{pen}}$:\n$$\nA_{nn}^{\\mathrm{pen}} = \\tau \\left(\\frac{2n+1}{h} + \\frac{2n+1}{h}\\right) = \\tau \\left(2\\frac{2n+1}{h}\\right)\n$$\nFinally, we substitute the given definition of the penalty parameter, $\\tau = \\eta \\frac{p(p+1)}{h}$:\n$$\nA_{nn}^{\\mathrm{pen}} = \\left(\\eta \\frac{p(p+1)}{h}\\right) \\left(2\\frac{2n+1}{h}\\right) = \\frac{2\\eta(2n+1)p(p+1)}{h^2}\n$$\nThis is the closed-form expression for the diagonal penalty matrix entry for mode $n$.\n\nThe problem also asks to relate the dependence on $p$ to the scaling predicted by polynomial trace inverse inequalities.\nThe expression for $A_{nn}^{\\mathrm{pen}}$ is a product of two terms with physical and numerical meaning: the penalty parameter $\\tau$ and the squared $L^2$-norm of the basis function $\\phi_n$ on the boundary $\\partial K$, which is $\\| \\phi_n \\|_{L^2(\\partial K)}^2 = \\phi_n(x_L)^2 + \\phi_n(x_R)^2 = 2\\frac{2n+1}{h}$.\nThe penalty parameter $\\tau = \\eta \\frac{p(p+1)}{h}$ is not arbitrary. Its scaling is chosen to ensure the stability (specifically, the coercivity) of the DG formulation. The stability proof requires that the penalty term be large enough to dominate certain boundary terms arising from integration by parts. This domination is guaranteed by polynomial trace inverse inequalities, which bound the norm of a polynomial on an element's boundary by its norm in the element's interior. A standard trace inequality for a polynomial $v_p$ of degree $p$ on an element $K$ of size $h$ is of the form:\n$$\n\\|v_p\\|_{L^2(\\partial K)}^2 \\le C_{tr} h^{-1} \\|v_p\\|_{L^2(K)}^2\n$$\nwhere the trace constant $C_{tr}$ depends on the polynomial degree $p$. For many polynomial families, $C_{tr}$ scales as $O(p^2)$. The factor $p(p+1)$ in the definition of $\\tau$ is a more precise form of this $p^2$ scaling, arising from a detailed analysis using Legendre polynomials. Thus, the $p(p+1)$ dependence of $A_{nn}^{\\mathrm{pen}}$ is a direct consequence of the stability requirement for the DG method, which is quantified by such trace inverse inequalities.\n\nThe other factor, $\\|\\phi_n\\|_{L^2(\\partial K)}^2 = 2\\frac{2n+1}{h}$, shows how the boundary \"energy\" of a single basis function scales with its degree $n$ and element size $h$. Since the basis functions are $L^2(K)$-orthonormal (i.e., $\\|\\phi_n\\|_{L^2(K)}=1$), this term itself demonstrates the trace inequality for the specific function $\\phi_n$: its trace constant is $2(2n+1)$, which grows linearly in $n$. This is consistent with the worst-case $O(p^2)$ scaling for the entire space of polynomials of degree up to $p$. The overall magnitude of $A_{nn}^{\\mathrm{pen}}$ thus reflects both the global stability requirement (via $\\tau$) and the specific boundary behavior of the chosen basis function $\\phi_n$.",
            "answer": "$$\\boxed{\\frac{2\\eta(2n+1)p(p+1)}{h^2}}$$"
        }
    ]
}