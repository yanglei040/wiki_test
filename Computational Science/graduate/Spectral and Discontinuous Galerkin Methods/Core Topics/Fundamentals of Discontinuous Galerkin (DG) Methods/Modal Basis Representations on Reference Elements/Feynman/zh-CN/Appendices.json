{
    "hands_on_practices": [
        {
            "introduction": "我们实践的第一步是构建我们方法的基础：一组定义在参考单元上的标准正交模态基函数。这个练习将指导您从标准的勒让德多项式出发，它们是正交的但非单位范数的，然后推导出将它们转换为一个完全标准正交基所需的精确缩放因子。掌握这一过程对于理解谱方法中质量矩阵为何在理想情况下能简化为单位矩阵至关重要。",
            "id": "3400583",
            "problem": "考虑谱方法和间断Galerkin（DG）方法中使用的标准一维参考单元 $I = [-1,1]$。令 $\\{P_{n}\\}_{n=0}^{\\infty}$ 表示在 $I$ 上的非归一化勒让德多项式，其特征为 $P_{n}(1)=1$，它们构成了 $I$ 上的一个模态基。定义权重为1的 $L^{2}(I)$ 内积为 $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,dx$，并令质量矩阵的元素由 $M_{mn} = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx$ 给出。从内积和质量矩阵的定义出发，并仅使用勒让德多项式在 $[-1,1]$ 上的基本性质，推导对角元素 $M_{nn}$ 的封闭形式表达式，并确定一个缩放因子 $\\alpha_{n}$，使得 $\\phi_{n}(x) = \\alpha_{n}\\,P_{n}(x)$ 产生一个 $L^{2}(I)$-标准正交基，即对于所有 $m,n \\ge 0$ 都有 $\\int_{-1}^{1} \\phi_{m}(x)\\,\\phi_{n}(x)\\,dx = \\delta_{mn}$。将您的最终答案以一个单行矩阵的形式给出，其中包含 $M_{nn}$ 和 $\\alpha_{n}$ 关于 $n$ 的表达式。不需要数值近似，也不涉及单位。",
            "solution": "首先验证问题，以确保其具有科学依据、良定性和客观性。\n\n**第1步：提取已知条件**\n- **参考单元：** $I = [-1,1]$。\n- **基函数：** $\\{P_{n}\\}_{n=0}^{\\infty}$，在 $I$ 上的非归一化勒让德多项式。\n- **归一化条件：** 对于所有 $n \\ge 0$，$P_{n}(1)=1$。\n- **内积：** $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,dx$。\n- **质量矩阵：** $M_{mn} = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx$。\n- **目标1：** 求对角质量矩阵元素 $M_{nn}$ 的封闭形式表达式。\n- **目标2：** 求一个缩放因子 $\\alpha_{n}$，使得 $\\{\\phi_{n}(x) = \\alpha_{n}\\,P_{n}(x)\\}$ 是一个 $L^{2}(I)$-标准正交基，即 $\\int_{-1}^{1} \\phi_{m}(x)\\,\\phi_{n}(x)\\,dx = \\delta_{mn}$。\n- **约束：** 推导过程必须仅使用勒让德多项式在 $[-1,1]$ 上的基本性质。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于正交多项式的标准理论及其在偏微分方程数值方法（特别是谱方法和间断伽辽金方法）中的应用。勒让德多项式、$L^2$ 内积和标准正交性是定义明确的数学构造。该问题是良定的，陈述了明确的目标，并提供了所有必要的定义和约束。它是客观的，没有任何歧义或主观论断。该问题不违反提示中列出的任何无效标准。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n**对角质量矩阵元素 $M_{nn}$ 的推导**\n\n质量矩阵的对角元素由 $M_{nn} = \\langle P_{n},P_{n}\\rangle = \\int_{-1}^{1} (P_{n}(x))^{2}\\,dx$ 给出。我们将利用勒让德多项式的三项递推关系（这是一个基本性质）来推导 $M_{nn}$ 的封闭形式表达式。具有归一化条件 $P_{n}(1)=1$ 的勒让德多项式满足以下对于 $n \\ge 1$ 的递推关系：\n$$ (n+1)P_{n+1}(x) = (2n+1)xP_{n}(x) - nP_{n-1}(x) $$\n对该式进行整理，得到 $xP_{n}(x)$ 的表达式：\n$$ (2n+1)xP_{n}(x) = (n+1)P_{n+1}(x) + nP_{n-1}(x) $$\n我们将此方程两边乘以 $P_{n-1}(x)$ 并在区间 $I=[-1,1]$ 上积分：\n$$ (2n+1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = (n+1)\\int_{-1}^{1} P_{n+1}(x)P_{n-1}(x)\\,dx + n\\int_{-1}^{1} (P_{n-1}(x))^{2}\\,dx $$\n勒让德多项式的一个基本性质是它们在 $[-1,1]$ 上关于 $L^2$ 内积是正交的，即当 $m \\ne n$ 时，$\\int_{-1}^{1} P_{m}(x)P_{n}(x)\\,dx = 0$。应用此性质，右侧的第一个积分为零。根据定义，第二个积分是 $M_{n-1,n-1}$。因此，对于 $n \\ge 1$：\n$$ (2n+1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = n M_{n-1,n-1} $$\n这给出了包含 $x$ 的积分的第一个表达式：\n$$ \\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = \\frac{n}{2n+1} M_{n-1,n-1} $$\n接下来，我们可以将递推关系中的索引从 $n$ 移至 $n-1$（对于 $n \\ge 2$，或者更一般地，通过定义 $P_{-1}=0$）：\n$$ nP_{n}(x) = (2(n-1)+1)xP_{n-1}(x) - (n-1)P_{n-2}(x) $$\n整理得到 $xP_{n-1}(x)$ 的表达式：\n$$ (2n-1)xP_{n-1}(x) = nP_{n}(x) + (n-1)P_{n-2}(x) $$\n现在，将此方程两边乘以 $P_{n}(x)$ 并在 $I$ 上积分：\n$$ (2n-1)\\int_{-1}^{1} xP_{n-1}(x)P_{n}(x)\\,dx = n\\int_{-1}^{1} (P_{n}(x))^{2}\\,dx + (n-1)\\int_{-1}^{1} P_{n-2}(x)P_{n}(x)\\,dx $$\n根据正交性，右侧的第二个积分为零。右侧的第一个积分是 $M_{nn}$。因此，对于 $n \\ge 1$：\n$$ (2n-1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = n M_{nn} $$\n这得到了同一个积分的第二个表达式：\n$$ \\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = \\frac{n}{2n-1} M_{nn} $$\n令关于积分 $\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx$ 的两个表达式相等，我们得到 $M_{nn}$ 的一个递推关系：\n$$ \\frac{n}{2n-1} M_{nn} = \\frac{n}{2n+1} M_{n-1,n-1} $$\n对于 $n \\ge 1$，两边除以 $n$ 可得：\n$$ M_{nn} = \\frac{2n-1}{2n+1} M_{n-1,n-1} $$\n为了找到封闭形式的表达式，我们需要一个基例。对于 $n=0$，$P_0(x)$ 是一个常数。条件 $P_0(1)=1$ 意味着 $P_0(x)=1$。因此，\n$$ M_{00} = \\int_{-1}^{1} (P_0(x))^2\\,dx = \\int_{-1}^{1} 1^2\\,dx = [x]_{-1}^{1} = 1 - (-1) = 2 $$\n通过重复应用递推关系，我们得到一个伸缩积：\n$$ M_{nn} = \\left(\\frac{2n-1}{2n+1}\\right)M_{n-1,n-1} = \\left(\\frac{2n-1}{2n+1}\\right)\\left(\\frac{2n-3}{2n-1}\\right)M_{n-2,n-2} = \\dots = \\left(\\frac{2n-1}{2n+1}\\right)\\left(\\frac{2n-3}{2n-1}\\right)\\dots\\left(\\frac{1}{3}\\right)M_{00} $$\n中间项相互抵消，剩下：\n$$ M_{nn} = \\frac{1}{2n+1} M_{00} = \\frac{2}{2n+1} $$\n该公式对所有 $n \\ge 0$ 成立。\n\n**标准正交缩放因子 $\\alpha_{n}$ 的推导**\n\n要求基 $\\{\\phi_{n}(x) = \\alpha_{n}P_{n}(x)\\}$ 是标准正交的，这意味着 $\\int_{-1}^{1} \\phi_{m}(x)\\phi_{n}(x)\\,dx = \\delta_{mn}$。\n代入 $\\phi_n(x)$ 的定义：\n$$ \\int_{-1}^{1} (\\alpha_{m}P_{m}(x))(\\alpha_{n}P_{n}(x))\\,dx = \\alpha_{m}\\alpha_{n}\\int_{-1}^{1} P_{m}(x)P_{n}(x)\\,dx = \\alpha_{m}\\alpha_{n}M_{mn} = \\delta_{mn} $$\n勒让德多项式 $\\{P_n\\}$ 的正交性确保了当 $m \\ne n$ 时 $M_{mn} = 0$，因此对于非对角项，该条件已经满足。对于对角项（$m=n$），我们要求：\n$$ \\alpha_{n}^2 M_{nn} = 1 $$\n求解 $\\alpha_n^2$：\n$$ \\alpha_{n}^2 = \\frac{1}{M_{nn}} $$\n使用先前推导的 $M_{nn}$ 表达式：\n$$ \\alpha_{n}^2 = \\frac{1}{\\frac{2}{2n+1}} = \\frac{2n+1}{2} $$\n按照惯例，缩放因子 $\\alpha_n$ 取正值。因此，取正平方根可得：\n$$ \\alpha_{n} = \\sqrt{\\frac{2n+1}{2}} $$\n\n推导出的对角质量矩阵元素和标准正交缩放因子的封闭形式表达式分别为 $M_{nn} = \\frac{2}{2n+1}$ 和 $\\alpha_{n} = \\sqrt{\\frac{2n+1}{2}}$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{2n+1} & \\sqrt{\\frac{2n+1}{2}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在理论上，我们使用连续积分来定义内积和质量矩阵，但在实践中，这些积分必须通过数值求积（quadrature）进行近似。这个练习探讨了这一离散化步骤的关键影响，特别是当使用一种常见的次优求积规则（高斯-洛巴托-勒让德求积）时。通过分析离散质量矩阵的结构，您将深入了解数值积分如何影响离散系统的性质，以及为什么它可能导致最高阶模态的混叠误差。",
            "id": "3400503",
            "problem": "考虑一维参考单元 $[-1,1]$ 和由 $\\phi_{k}(x) = \\sqrt{\\frac{2k+1}{2}}\\,P_{k}(x)$ 定义的模态基 $\\{\\phi_{k}\\}_{k=0}^{N}$，其中 $P_{k}(x)$ 是k次勒让德多项式。精确（连续）质量矩阵的元素为 $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$。根据构造，在精确积分下，该质量矩阵是单位矩阵。\n\n现要求您仅从勒让德多项式和高斯型求积的基本定义和公认事实出发，分析质量矩阵在求积下的对角化，并量化使用次优求积法则的影响。\n\n任务：\n1. 利用 $Q$ 点高斯-勒让德 (GL) 求积对次数最高为 $2Q-1$ 的多项式精确，以及 $Q$ 点高斯-洛巴托-勒让德 (GLL) 求积对次数最高为 $2Q-3$ 的多项式精确且包含端点的性质，确定每种求积法则所需的最小 $Q$ 值（作为 $N$ 的函数），以使得通过求积计算的离散质量矩阵对于所选的最高次数为 $N$ 的模态基是精确对角的。\n2. 特别考虑使用 $Q = N+1$ 个点的 GLL 求积，并证明离散质量矩阵保持对角，但其最高阶模态的对角项有所修正。仅使用以下标准事实：\n   - GLL 节点 $\\{x_{i}\\}_{i=0}^{N}$ 由端点 $\\pm 1$ 和 $P'_{N}(x)$ 的 $N-1$ 个内部根组成。\n   - 相关的 GLL 权重满足 $w_{0} = w_{N} = \\frac{2}{N(N+1)}$，对于内部节点 $x_{i}$（$1 \\le i \\le N-1$），有 $w_{i} = \\frac{2}{N(N+1)\\,P_{N}(x_{i})^{2}}$。\n   - 端点值 $P_{N}(\\pm 1) = (\\pm 1)^{N}$。\n   - 对于次数 $i \\ne j$ 且满足 $i+j \\le 2N-1$ 的情况，使用 $Q=N+1$ 的 GLL 法则能将 $\\phi_{i}\\phi_{j}$ 精确积分为零。\n3. 用 $M^{\\mathrm{GLL}}_{NN}$ 表示使用 $Q=N+1$ 的 GLL 求积计算的最高阶模态的离散质量项。推导 $M^{\\mathrm{GLL}}_{NN}$ 作为 $N$ 的函数的闭式表达式。\n\n给出 $M^{\\mathrm{GLL}}_{NN}$ 关于 $N$ 的精确解析表达式作为最终答案。不要四舍五入。不涉及单位。以最简闭式形式表示您的最终答案。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个数值分析领域中适定的、有科学依据的问题，特别涉及谱方法。所有定义和性质都是标准的，并得到了一致的应用。\n\n该问题要求分析一个使用参考区间 $[-1, 1]$ 上的归一化勒让德多项式模态基构建的离散质量矩阵。使用具有 $Q$ 个点 $\\{x_q\\}$ 和权重 $\\{w_q\\}$ 的求积法则计算的离散质量矩阵项由下式给出：\n$$ M^{\\mathrm{Q}}_{ij} = \\sum_{q=0}^{Q-1} w_q \\phi_i(x_q) \\phi_j(x_q) $$\n这近似于连续质量矩阵 $M_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) dx$。基函数为 $\\phi_k(x) = \\sqrt{\\frac{2k+1}{2}} P_k(x)$，其中 $P_k(x)$ 是 $k$ 次勒让德多项式。由于勒让德多项式的正交性 $\\int_{-1}^{1} P_i(x) P_j(x) dx = \\frac{2}{2i+1} \\delta_{ij}$，连续质量矩阵是单位矩阵：\n$$ M_{ij} = \\sqrt{\\frac{2i+1}{2}} \\sqrt{\\frac{2j+1}{2}} \\int_{-1}^{1} P_i(x) P_j(x) dx = \\frac{\\sqrt{(2i+1)(2j+1)}}{2} \\frac{2}{2i+1} \\delta_{ij} = \\delta_{ij} $$\n我们现在来解决提出的三个任务。\n\n任务1：使质量矩阵对角化所需的最小求积点数。\n质量矩阵项 $M_{ij}$ 的被积函数是 $\\phi_i(x)\\phi_j(x)$。这个乘积是一个次数为 $i+j$ 的多项式。对于最高次数为 $N$ 的多项式基，索引 $i$ 和 $j$ 的范围是从 $0$ 到 $N$。要积分的多项式的最高次数因此是 $N+N = 2N$，这在乘积 $\\phi_N(x)\\phi_N(x)$ 中出现。为了使离散质量矩阵精确对角（并等于单位矩阵），求积法则必须对所有多项式乘积 $\\phi_i(x)\\phi_j(x)$（$0 \\le i, j \\le N$）都是精确的。这要求该法则对次数最高至少为 $2N$ 的多项式是精确的。\n\n对于有 $Q$ 个点的高斯-勒让德 (GL) 求积，该法则对次数最高为 $2Q-1$ 的多项式是精确的。为确保对次数 $2N$ 的精确性，我们需要：\n$$ 2Q-1 \\ge 2N $$\n$$ 2Q \\ge 2N+1 $$\n$$ Q \\ge N + \\frac{1}{2} $$\n由于点数 $Q$ 必须是整数，所以 GL 点的最小数量是 $Q = N+1$。\n\n对于有 $Q$ 个点的高斯-洛巴托-勒让德 (GLL) 求积，该法则对次数最高为 $2Q-3$ 的多项式是精确的。为确保对次数 $2N$ 的精确性，我们需要：\n$$ 2Q-3 \\ge 2N $$\n$$ 2Q \\ge 2N+3 $$\n$$ Q \\ge N + \\frac{3}{2} $$\n由于 $Q$ 必须是整数，所以 GLL 点的最小数量是 $Q = N+2$。\n\n任务2：对具有 $Q = N+1$ 个点的 GLL 质量矩阵的分析。\n根据任务1的结论，为 GLL 求积选择 $Q=N+1$ 个点是次优的。该法则对次数最高为 $2(N+1)-3 = 2N-1$ 的多项式是精确的。\n\n我们分析离散质量矩阵项 $M^{\\mathrm{GLL}}_{ij} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)\\phi_{j}(x_q)$。\n\n对于非对角项（$i \\ne j$，其中 $0 \\le i, j \\le N$）：\n被积函数 $\\phi_i(x)\\phi_j(x)$ 的次数是 $i+j$。可能的最大次数出现在 $(i,j) = (N, N-1)$ 或 $(N-1, N)$ 时，为 $2N-1$。对于所有其他 $i \\ne j$ 的配对，次数 $i+j$ 小于 $2N-1$。由于求积法则对次数最高为 $2N-1$ 的多项式是精确的，所以对于所有非对角项，离散和等于精确积分：\n$$ M^{\\mathrm{GLL}}_{ij} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)\\phi_{j}(x_q) = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x) dx = \\delta_{ij} = 0 \\quad \\text{for } i \\ne j $$\n这证实了离散质量矩阵是对角的。\n\n对于对角项（$i = j$）：\n被积函数 $\\phi_i(x)^2$ 的次数是 $2i$。\n对于 $i  N$，最大次数为 $2(N-1) = 2N-2$。由于 $2N-2  2N-1$，求积法则对这些项是精确的。\n$$ M^{\\mathrm{GLL}}_{ii} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)^2 = \\int_{-1}^{1} \\phi_i(x)^2 dx = 1 \\quad \\text{for } i = 0, 1, \\dots, N-1 $$\n对于最高阶模态 $i=N$，被积函数 $\\phi_N(x)^2$ 的次数是 $2N$。由于 $2N > 2N-1$，求积法则对这一项不是精确的。因此，$M^{\\mathrm{GLL}}_{NN}$ 的值通常不等于 $1$。\n这证明了该矩阵是对角的，但其最高阶模态的项 $M^{\\mathrm{GLL}}_{NN}$ 有特定修正。\n\n任务3：推导 $M^{\\mathrm{GLL}}_{NN}$ 的表达式。\n我们要使用具有 $Q=N+1$ 个点、节点 $\\{x_q\\}_{q=0}^N$ 和权重 $\\{w_q\\}_{q=0}^N$ 的 GLL 求积法则来计算 $M^{\\mathrm{GLL}}_{NN}$ 的值。\n$$ M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\phi_N(x_q)^2 $$\n代入定义 $\\phi_N(x) = \\sqrt{\\frac{2N+1}{2}} P_N(x)$，我们得到：\n$$ M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\left( \\sqrt{\\frac{2N+1}{2}} P_N(x_q) \\right)^2 = \\frac{2N+1}{2} \\sum_{q=0}^{N} w_q P_N(x_q)^2 $$\n我们通过将其分为端点贡献（$q=0, N$）和内部点贡献（$q=1, \\dots, N-1$）来计算这个和。\nGLL 网格的端点是 $x_0 = -1$ 和 $x_N = 1$。相关的权重给出为 $w_0 = w_N = \\frac{2}{N(N+1)}$。\n勒让德多项式的端点值为 $P_N(1) = 1$ 和 $P_N(-1) = (-1)^N$。\n来自端点的贡献是：\n$$ w_0 P_N(x_0)^2 + w_N P_N(x_N)^2 = \\frac{2}{N(N+1)} P_N(-1)^2 + \\frac{2}{N(N+1)} P_N(1)^2 $$\n$$ = \\frac{2}{N(N+1)} ((-1)^N)^2 + \\frac{2}{N(N+1)} (1)^2 = \\frac{2}{N(N+1)} (1+1) = \\frac{4}{N(N+1)} $$\n内部 GLL 节点 $\\{x_q\\}_{q=1}^{N-1}$ 是 $P'_N(x)$ 的根。这些节点的权重给出为 $w_q = \\frac{2}{N(N+1)P_N(x_q)^2}$。\n来自内部点的贡献是：\n$$ \\sum_{q=1}^{N-1} w_q P_N(x_q)^2 = \\sum_{q=1}^{N-1} \\left( \\frac{2}{N(N+1)P_N(x_q)^2} \\right) P_N(x_q)^2 $$\n$P_N(x_q)^2$ 项相互抵消，剩下：\n$$ \\sum_{q=1}^{N-1} \\frac{2}{N(N+1)} $$\n这是一个常数项在 $N-1$ 个索引上的和。\n$$ (N-1) \\times \\frac{2}{N(N+1)} = \\frac{2(N-1)}{N(N+1)} $$\n总和是端点贡献和内部贡献的和：\n$$ \\sum_{q=0}^{N} w_q P_N(x_q)^2 = \\frac{4}{N(N+1)} + \\frac{2(N-1)}{N(N+1)} = \\frac{4 + 2N - 2}{N(N+1)} = \\frac{2N+2}{N(N+1)} = \\frac{2(N+1)}{N(N+1)} = \\frac{2}{N} $$\n最后，我们将此结果代回到 $M^{\\mathrm{GLL}}_{NN}$ 的表达式中：\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{2} \\left( \\sum_{q=0}^{N} w_q P_N(x_q)^2 \\right) = \\frac{2N+1}{2} \\cdot \\frac{2}{N} $$\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{N} $$\n这也可以写成 $2 + \\frac{1}{N}$。这就是最高阶模态对角项的闭式表达式。",
            "answer": "$$\\boxed{\\frac{2N+1}{N}}$$"
        },
        {
            "introduction": "谱方法的一个标志性特征是其对光滑函数的高精度。但是，当函数存在不连续性（如冲击或界面）时会发生什么？这个练习通过分析具有跳跃间断的函数，揭示了其谱模态系数的收敛行为。通过推导系数的代数衰减率，您将理解吉布斯现象的数学根源，并能预测间断伽辽金（DG）方法在这种挑战性情况下的收敛阶。",
            "id": "3400525",
            "problem": "考虑参考单元 $[-1,1]$，其上的模态 Legendre 基为 $\\{P_{n}(x)\\}_{n\\geq 0}$，关于 $[-1,1]$ 上的标准内积正交。令 $u(x)=v(x)+\\Delta H(x-\\xi)$，其中 $v(x)$ 是在 $[-1,1]$ 上无限可微的函数，$H$ 是 Heaviside 阶跃函数，$\\xi \\in (-1,1)$ 是一个固定的内点，$\\Delta \\in \\mathbb{R}$ 是 $u$ 在 $x=\\xi$ 处的跳跃幅度。Legendre 模态系数定义为 $a_{n}=\\frac{2n+1}{2}\\int_{-1}^{1}u(x)P_{n}(x)\\,\\mathrm{d}x$，并令 $\\Pi_{p}$ 表示 $u$ 到多项式子空间 $\\mathrm{span}\\{P_{0},P_{1},\\dots,P_{p}\\}$ 上的 $L^{2}$ 投影。在间断 Galerkin (DG) 方法的背景下，参考单元上的 $L^{2}$ 投影误差为 $E_{p}:=\\|u-\\Pi_{p}u\\|_{L^{2}([-1,1])}$。\n\n从 Legendre 多项式的正交性和 $P_{n}$ 在内点处经过充分检验的渐近公式出发，推导由跳跃贡献产生的模态系数 $\\{a_{n}\\}$ 的代数衰减率，并利用此结果预测当多项式次数 $p\\to\\infty$ 时，DG $L^{2}$ 投影误差 $E_{p}$ 的主阶渐近行为。用 $\\Delta$、$p$ 和参数 $\\theta=\\arccos(\\xi)\\in(0,\\pi)$ 来表示你的最终结果。以单一的封闭形式解析表达式给出最终答案。不需要四舍五入，也不涉及物理单位。",
            "solution": "该问题要求推导在参考区间 $[-1,1]$ 上具有单个跳跃间断点的函数 $u(x)$ 的 $L^{2}$ 投影误差 $E_{p}$ 的主阶渐近行为。该函数由 $u(x)=v(x)+\\Delta H(x-\\xi)$ 给出，其中 $v(x)$ 是一个 $C^{\\infty}$ 函数，$H$ 是 Heaviside 阶跃函数，$\\xi\\in(-1,1)$，$\\Delta \\in \\mathbb{R}$ 是跳跃幅度。\n\n首先，我们分析 Legendre 模态系数 $a_{n}$，其定义为 $a_{n}=\\frac{2n+1}{2}\\int_{-1}^{1}u(x)P_{n}(x)\\,\\mathrm{d}x$。根据积分的线性性质，我们可以将系数分解为两部分：\n$$a_{n} = \\frac{2n+1}{2}\\int_{-1}^{1}v(x)P_{n}(x)\\,\\mathrm{d}x + \\frac{2n+1}{2}\\int_{-1}^{1}\\Delta H(x-\\xi)P_{n}(x)\\,\\mathrm{d}x = a_{n}^{(v)} + a_{n}^{(\\text{jump})}$$\n对于光滑部分 $v(x)$，它是无限可微的，其 Legendre 系数 $a_{n}^{(v)}$ 表现出谱衰减。这意味着当 $n\\to\\infty$ 时，它们的衰减速度快于 $n$ 的任何代数幂，即 $a_{n}^{(v)} = O(n^{-k})$ 对任意 $k>0$ 成立。来自跳跃间断点的贡献 $a_{n}^{(\\text{jump})}$ 将具有慢得多的代数衰减率，因此将主导 $a_n$ 的渐近行为。我们专注于这一项。\n\n对系数的跳跃贡献为：\n$$a_{n}^{(\\text{jump})} = \\Delta \\frac{2n+1}{2}\\int_{-1}^{1} H(x-\\xi) P_{n}(x)\\,\\mathrm{d}x$$\n根据 Heaviside 函数的定义，$x\\xi$ 时 $H(x-\\xi)=0$，$x>\\xi$ 时 $H(x-\\xi)=1$。积分变为：\n$$a_{n}^{(\\text{jump})} = \\Delta \\frac{2n+1}{2}\\int_{\\xi}^{1} P_{n}(x)\\,\\mathrm{d}x$$\n我们使用与 Legendre 多项式导数相关的恒等式：$P'_{n+1}(x) - P'_{n-1}(x) = (2n+1)P_n(x)$。对这个关系式进行积分得到：\n$$\\int (2n+1)P_n(x)\\,\\mathrm{d}x = P_{n+1}(x) - P_{n-1}(x) + C$$\n将此应用于我们的定积分：\n$$\\int_{\\xi}^{1} (2n+1)P_{n}(x)\\,\\mathrm{d}x = \\left[P_{n+1}(x) - P_{n-1}(x)\\right]_{\\xi}^{1} = \\left(P_{n+1}(1) - P_{n-1}(1)\\right) - \\left(P_{n+1}(\\xi) - P_{n-1}(\\xi)\\right)$$\n由于对所有整数 $k \\geq 0$ 都有 $P_k(1)=1$，第一项为 $1-1=0$。因此，\n$$\\int_{\\xi}^{1} (2n+1)P_{n}(x)\\,\\mathrm{d}x = -\\left(P_{n+1}(\\xi) - P_{n-1}(\\xi)\\right)$$\n将此结果代回 $a_{n}^{(\\text{jump})}$ 的表达式中：\n$$a_{n}^{(\\text{jump})} = \\frac{\\Delta}{2} \\left(P_{n-1}(\\xi) - P_{n+1}(\\xi)\\right)$$\n这个表达式是精确的。为了找到大 $n$ 时的渐近行为，我们使用 Legendre 多项式在内点 $x=\\cos(\\theta)\\in(-1,1)$ 处的 Hilb 渐近公式：\n$$P_n(\\cos\\theta) = \\sqrt{\\frac{2}{n\\pi\\sin\\theta}} \\cos\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) + O(n^{-3/2})$$\n当 $\\xi = \\cos(\\theta)$ 时，对于大的 $n$ 我们有：\n$$P_{n-1}(\\xi) - P_{n+1}(\\xi) \\approx \\sqrt{\\frac{2}{n\\pi\\sin\\theta}} \\left[ \\cos\\left(\\left(n-\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) - \\cos\\left(\\left(n+\\frac{3}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) \\right]$$\n使用三角恒等式 $\\cos(A)-\\cos(B) = -2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$，其中 $A=\\left(n-\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}$ 且 $B=\\left(n+\\frac{3}{2}\\right)\\theta - \\frac{\\pi}{4}$，我们得到：\n$$\\frac{A+B}{2} = \\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4} \\quad \\text{和} \\quad \\frac{A-B}{2} = -\\theta$$\n余弦之差变为 $2\\sin\\theta \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)$。\n将此代入 $a_{n}^{(\\text{jump})}$ 的表达式中，得到主阶项：\n$$a_{n} \\approx a_{n}^{(\\text{jump})} \\approx \\frac{\\Delta}{2} \\sqrt{\\frac{2}{n\\pi\\sin\\theta}} \\left(2\\sin\\theta \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)\\right)$$\n$$a_{n} \\approx \\Delta \\sqrt{\\frac{2\\sin\\theta}{n\\pi}} \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)$$\n这表明系数以 $|a_n| = O(n^{-1/2})$ 的代数速率衰减。\n\n$L^2$ 投影误差为 $E_p = \\|u - \\Pi_p u\\|_{L^2}$。根据 Legendre 级数的 Parseval 恒等式，误差的平方是次数超过 $p$ 的模态平方和：\n$$E_p^2 = \\|u - \\Pi_p u\\|_{L^{2}}^{2} = \\sum_{n=p+1}^{\\infty} a_n^2 \\|P_n\\|_{L^2}^2 = \\sum_{n=p+1}^{\\infty} a_n^2 \\frac{2}{2n+1}$$\n代入 $a_n$ 的渐近表达式：\n$$E_p^2 \\approx \\sum_{n=p+1}^{\\infty} \\left(\\Delta \\sqrt{\\frac{2\\sin\\theta}{n\\pi}} \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)\\right)^2 \\frac{2}{2n+1}$$\n$$E_p^2 \\approx \\sum_{n=p+1}^{\\infty} \\Delta^2 \\frac{2\\sin\\theta}{n\\pi} \\sin^2\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) \\frac{2}{2n+1}$$\n对于大的 $n$，我们可以近似 $2n+1 \\approx 2n$。\n$$E_p^2 \\approx \\frac{2\\Delta^2\\sin\\theta}{\\pi} \\sum_{n=p+1}^{\\infty} \\frac{1}{n^2} \\sin^2\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)$$\n为了找到这个和在大 $p$ 时的主阶行为，我们可以用一个积分来近似它。项 $\\sin^2\\left(\\dots\\right)$ 快速振荡。其平均值为 $1/2$。严格的分析表明，该和的主项是通过将振荡项替换为其平均值得到的：\n$$E_p^2 \\approx \\frac{2\\Delta^2\\sin\\theta}{\\pi} \\sum_{n=p+1}^{\\infty} \\frac{1}{n^2} \\left(\\frac{1}{2}\\right) = \\frac{\\Delta^2\\sin\\theta}{\\pi} \\sum_{n=p+1}^{\\infty} \\frac{1}{n^2}$$\n剩余的和可以用一个积分对大 $p$ 进行近似：\n$$\\sum_{n=p+1}^{\\infty} \\frac{1}{n^2} \\approx \\int_{p}^{\\infty} \\frac{1}{x^2}\\,\\mathrm{d}x = \\left[-\\frac{1}{x}\\right]_{p}^{\\infty} = \\frac{1}{p}$$\n结合这些结果，我们得到误差平方的渐近行为：\n$$E_p^2 \\approx \\frac{\\Delta^2\\sin\\theta}{\\pi p}$$\n取平方根，得到 $L^2$ 投影误差的主阶渐近行为：\n$$E_p \\approx \\sqrt{\\frac{\\Delta^2\\sin\\theta}{\\pi p}} = |\\Delta| \\sqrt{\\frac{\\sin\\theta}{\\pi p}}$$\n此表达式用跳跃幅度 $\\Delta$、多项式次数 $p$ 和跳跃位置参数 $\\theta=\\arccos(\\xi)$ 给出了误差。",
            "answer": "$$\\boxed{|\\Delta| \\sqrt{\\frac{\\sin(\\theta)}{\\pi p}}}$$"
        }
    ]
}