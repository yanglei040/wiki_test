## 引言

在[高阶数值方法](@entry_id:142601)（如[谱方法](@entry_id:141737)和[间断伽辽金方法](@entry_id:748369)）中，为了精确且高效地[求解偏微分方程](@entry_id:138485)，选择合适的函数逼近空间至关重要。然而，当计算区域的几何形状复杂、网格不规则时，如何在成千上万个不同形状和大小的单元上一致地定义和操作[基函数](@entry_id:170178)，成为一个巨大的挑战。这正是本文旨在解决的核心问题：如何通过参考单元上的[模态基表示](@entry_id:752056)，为[高阶方法](@entry_id:165413)构建一个既严谨又高效的计算框架。

本文将系统地引导您深入理解这一关键技术。我们将从基本原理出发，揭示[模态基表示](@entry_id:752056)如何将几何的复杂性与[函数逼近](@entry_id:141329)的[代数结构](@entry_id:137052)解耦，并阐明正交性在简化计算、实现谱精度和高效算法中的核心作用。

为实现这一目标，本文分为三个循序渐进的章节：
*   在**“原理与机制”**一章中，我们将建立参考单元[范式](@entry_id:161181)，定义关键的[多项式空间](@entry_id:144410)，并详细介绍如何构造核心的正交[模态基](@entry_id:752055)（如勒让德基和Dubiner基），揭示其背后的数学原理。
*   在**“应用与交叉学科联系”**一章中，我们将展示这些原理如何转化为实际的高性能算法，例如通过[和因子分解](@entry_id:755628)与[静态凝聚](@entry_id:176722)提升效率，以及如何处理弯曲几何与[非线性](@entry_id:637147)项等复杂问题。此外，我们还将探索其与信号处理、不确定性量化等领域的深刻联系。
*   最后，在**“动手实践”**部分，您将通过一系列精心设计的练习，亲手推导和分析[模态基](@entry_id:752055)的关键性质，将理论知识转化为实践能力。

通过阅读本文，您将不仅掌握[参考单元](@entry_id:168425)上[模态基表示](@entry_id:752056)的理论精髓，更能理解其在现代科学与工程计算中的强大应用价值。

## 原理与机制

本章旨在阐述[谱方法](@entry_id:141737)与间断 Galerkin (DG) 方法中[模态基表示](@entry_id:752056)的核心原理与关键机制。我们将从参考单元这一基本概念出发，系统地介绍如何在这些规范化几何上构建[多项式逼近](@entry_id:137391)空间，并深入探讨正交性在简化计算、分析误差和实现高级算法（如自适应）中的中心作用。

### [参考单元](@entry_id:168425)[范式](@entry_id:161181)：为何与如何

在求解[偏微分方程的数值方法](@entry_id:143514)中，尤其是在处理复杂几何域时，一个核心的挑战是如何在不规则、大小各异的网格单元上一致地定义和处理逼近函数（例如多项式）。如果为每个物理单元 $K_e$ 单独设计一套[基函数](@entry_id:170178)，将会导致算法实现异常复杂且效率低下。

参考单元（reference element）[范式](@entry_id:161181)为这一挑战提供了优雅的解决方案。其核心思想是：将所有的计算，包括[基函数](@entry_id:170178)的定义、[数值积分](@entry_id:136578)和微分算子的离散，都在一个固定的、几何形状简单的**参考单元** $\hat{K}$ 上进行。然后，通过一个可逆的[光滑映射](@entry_id:203730) $\boldsymbol{\Phi}_e: \hat{K} \to K_e$，将这些在[参考单元](@entry_id:168425)上完成的计算“转换”到每一个物理单元 $K_e$ 上。

这一[范式](@entry_id:161181)的巨大优势在于，它将几何的复杂性与函数逼近的[代数结构](@entry_id:137052)分离开来。具体而言，任何在物理单元 $K_e$ 上的积分，例如两个函数 $u$ 和 $v$ 的[内积](@entry_id:158127)，都可以通过**[变量替换定理](@entry_id:160749)**（change-of-variables theorem）转换到[参考单元](@entry_id:168425) $\hat{K}$ 上进行计算：
$$
\int_{K_e} u(\boldsymbol{x}) v(\boldsymbol{x}) \, \mathrm{d}\boldsymbol{x} = \int_{\hat{K}} u(\boldsymbol{\Phi}_e(\boldsymbol{\xi})) v(\boldsymbol{\Phi}_e(\boldsymbol{\xi})) J_e(\boldsymbol{\xi}) \, \mathrm{d}\boldsymbol{\xi}
$$
这里，$\boldsymbol{\xi}$ 是[参考单元](@entry_id:168425)上的坐标，$\boldsymbol{x}$ 是物理单元上的坐标，而 $J_e(\boldsymbol{\xi}) = |\det D\boldsymbol{\Phi}_e(\boldsymbol{\xi})|$ 是映射 $\boldsymbol{\Phi}_e$ 的**雅可比行列式**（Jacobian determinant）的[绝对值](@entry_id:147688)。这个[雅可比因子](@entry_id:186289) $J_e(\boldsymbol{\xi})$ 如同一个几何权重，封装了从参考单元到物理单元的局部拉伸、压缩或扭曲信息。

因此，我们只需在参考单元 $\hat{K}$ 上定义一套统一的[模态基](@entry_id:752055)函数 $\{\hat{\psi}_\alpha\}$ 和一套统一的数值积分方案（即求积点和权重）。对于任意物理单元，我们计算时所需要的只是该单元对应的[雅可比行列式](@entry_id:137120) $J_e$ 在这些求积点上的值。这种方式极大地简化了算法实现，使得我们能够用一套统一的代码框架处理任意形状和大小的网格，这也是该方法在工程与科学计算中得以广泛应用的关键原因 。

### 基本构件：[参考单元](@entry_id:168425)与[多项式空间](@entry_id:144410)

为了实现上述[范式](@entry_id:161181)，我们首先需要精确定义其基本构件：参考单元和其上的多项式空间。

最常用的[参考单元](@entry_id:168425)包括：
- **一维参考区间 (Canonical Reference Interval)**：$I = [-1, 1]$。
- **d维参考超立方体 (Reference Hypercube)**：$\hat{Q} = [-1, 1]^d$，它是一维区间的 $d$ 次[张量积](@entry_id:140694)。
- **d维参考单纯形 (Unit Simplex)**：$\hat{T}^d = \{ \boldsymbol{x} \in \mathbb{R}^d : x_i \ge 0 \ \forall i, \ \sum_{i=1}^d x_i \le 1 \}$。这是由原点和 $d$ 个坐标轴上的单位向量所构成的凸包。

在这些参考单元上，我们通常定义两种主要的[多项式空间](@entry_id:144410) ：

1.  **全次数多项式空间 (Total-Degree Polynomial Space)** $P^p(\hat{K})$：该空间由所有**总次数**不超过 $p$ 的 $d$ 元多项式组成。一个次数为 $|\boldsymbol{\alpha}| = \sum_{i=1}^d \alpha_i$ 的单项式形如 $\boldsymbol{x}^{\boldsymbol{\alpha}} = x_1^{\alpha_1} \cdots x_d^{\alpha_d}$。$P^p(\hat{K})$ 包含了所有满足 $|\boldsymbol{\alpha}| \le p$ 的单项式的[线性组合](@entry_id:154743)。这个空间常用于单纯形单元。其维度由组合学中的“[隔板法](@entry_id:152143)”确定：
    $$
    \dim P^p(\hat{T}^d) = \binom{p+d}{d}
    $$

2.  **张量积多项式空间 (Tensor-Product Polynomial Space)** $Q^p(\hat{K})$：该空间由一维多项式空间张量积而成。一个多项式属于 $Q^p(\hat{Q})$，如果它在**每个坐标方向**上的次数都不超过 $p$。这个空间天然地适用于超立方体单元。其维度为：
    $$
    \dim Q^p(\hat{Q}) = (p+1)^d
    $$

需要注意的是，对于 $d>1$ 和 $p>1$，全次数空间 $P^p$ 是[张量积](@entry_id:140694)空间 $Q^p$ 的一个[真子集](@entry_id:152276)。例如，在二维正方形上（$d=2$），单项式 $\xi^p \eta^p$ 属于 $Q^p$ 空间（每个变量次数都是 $p$），但它的总次数是 $2p$，因此不属于 $P^p$ 空间。在实际应用中，为 $p=3$ 的[四边形单元](@entry_id:176937)选择 $P^p$ 空间会得到一个维度为 $\binom{3+2}{2}=10$ 的基，而选择 $Q^p$ 空间则会得到一个维度为 $(3+1)^2 = 16$ 的基 。选择哪种空间取决于具体的应用需求，例如所需的逼近性质和计算成本。

### 核心原理：正交性

一旦确定了多项式空间，我们的目标是为其寻找一组“好”的[基函数](@entry_id:170178)，即**[模态基](@entry_id:752055)**。这里的“好”通常意味着[基函数](@entry_id:170178)之间满足**正交性**（orthogonality）。

为了定义正交性，我们首先引入一个定义在参考单元 $\hat{K}$ 上的带权 $L^2$ [内积](@entry_id:158127)：
$$
(u, v)_{w, \hat{K}} = \int_{\hat{K}} u(\boldsymbol{\hat{x}}) v(\boldsymbol{\hat{x}}) w(\boldsymbol{\hat{x}}) \, \mathrm{d}\boldsymbol{\hat{x}}
$$
其中 $w(\boldsymbol{\hat{x}})$ 是一个权重函数。为了使这个[双线性形式](@entry_id:746794)成为一个合法的[内积](@entry_id:158127)，并能保证一个完备的[正交多项式](@entry_id:146918)系统的存在，权重函数 $w$ 必须满足一些基本条件。最关键的条件是，它必须在 $\hat{K}$ 上几乎处处为正（$w(\boldsymbol{\hat{x}}) > 0$ a.e.），并且是可积的（$w \in L^1(\hat{K})$）。正性确保了[内积](@entry_id:158127)的[正定性](@entry_id:149643)（即 $(p, p)_w > 0$ 对任意非零多项式 $p$ 成立），而可积性保证了任意两个多项式的[内积](@entry_id:158127)都是有限的 。

有了[内积](@entry_id:158127)的定义，我们可以精确地描述两种重要的[模态基](@entry_id:752055)：
- **[正交基](@entry_id:264024) (Orthogonal Basis)** $\{\phi_i\}$：满足 $( \phi_i, \phi_j )_{w, \hat{K}} = 0$ 对所有 $i \neq j$ 成立。
- **[标准正交基](@entry_id:147779) (Orthonormal Basis)** $\{\phi_i\}$：在正交的基础上，还满足[归一化条件](@entry_id:156486)，即 $( \phi_i, \phi_j )_{w, \hat{K}} = \delta_{ij}$，其中 $\delta_{ij}$ 是克罗内克（Kronecker）符号。

使用正交基（特别是标准正交基）的核心优势在于它能极大地简化计算。考虑一个在单元 $\hat{K}$ 上的逼近问题，我们通常需要计算一个所谓的**质量矩阵**（mass matrix），其定义为 $M_{ij} = (\phi_i, \phi_j)_{w, \hat{K}}$。这个矩阵在许多数值格式中都扮演着核心角色。

- 如果我们使用一个**正交**但未归一化的基，质量矩阵 $M$ 将会是一个**[对角矩阵](@entry_id:637782)**，其对角线元素为 $M_{ii} = (\phi_i, \phi_i)_{w, \hat{K}} = \|\phi_i\|^2_{L^2_w(\hat{K})}$ 。
- 如果我们更进一步，使用一个**标准正交**基，那么质量矩阵 $M$ 将直接成为**[单位矩阵](@entry_id:156724)**（$M=I$），即 $M_{ij} = \delta_{ij}$ 。

[质量矩阵](@entry_id:177093)的[对角化](@entry_id:147016)（或单位化）具有重大的计算意义。例如，在求解时间依赖的[偏微分方程](@entry_id:141332)（如[标量守恒律](@entry_id:754532)）的 DG 方法中，[半离散格式](@entry_id:165671)会得到一个[常微分方程组](@entry_id:266774)：$M \frac{\mathrm{d}\boldsymbol{\hat{u}}}{\mathrm{d}t} = \boldsymbol{R}(\boldsymbol{\hat{u}})$，其中 $\boldsymbol{\hat{u}}$ 是[模态系数](@entry_id:752057)向量。如果 $M$ 是单位矩阵，这个[方程组](@entry_id:193238)就变成了显式形式 $\frac{\mathrm{d}\boldsymbol{\hat{u}}}{\mathrm{d}t} = \boldsymbol{R}(\boldsymbol{\hat{u}})$，我们无需进行任何矩阵求逆或[求解线性方程组](@entry_id:169069)就能计算时间导数，从而极大地提高了时间步进的效率 。

### [模态基](@entry_id:752055)函数的构造：典型示例

理论上的优势必须通过具体的构造来实现。幸运的是，对于标准[参考单元](@entry_id:168425)，存在着丰富的正交多项式理论可供利用。

#### 一维区间上的勒让德基

最基础也是最重要的例子是在参考区间 $I = [-1, 1]$ 上构建关于标准 $L^2$ [内积](@entry_id:158127)（即权重 $w(x)=1$）的正交基。这组基就是著名的**[勒让德多项式](@entry_id:141510)**（Legendre polynomials）$\{P_n(x)\}$。它们可以通过[三项递推关系](@entry_id:176845)方便地生成：
$$
(n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x)
$$
从初始值 $P_0(x) = 1$ 和 $P_1(x) = x$ 出发，我们可以依次得到更高阶的多项式。例如，$P_2(x) = \frac{1}{2}(3x^2 - 1)$ 和 $P_3(x) = \frac{1}{2}(5x^3 - 3x)$ 。

[勒让德多项式](@entry_id:141510)是正交的，但不是标准正交的。它们的 $L^2$ 范数的平方为 $\int_{-1}^1 [P_n(x)]^2 dx = \frac{2}{2n+1}$。因此，为了获得一个标准正交的[模态基](@entry_id:752055) $\{\phi_n(x)\}$，我们需要对它们进行归一化：
$$
\phi_n(x) = \sqrt{\frac{2n+1}{2}} P_n(x)
$$
例如，前四个[标准正交基函数](@entry_id:193867)为：
- $\phi_0(x) = \frac{1}{\sqrt{2}}$
- $\phi_1(x) = \sqrt{\frac{3}{2}}x$
- $\phi_2(x) = \frac{1}{2}\sqrt{\frac{5}{2}}(3x^2 - 1)$
- $\phi_3(x) = \frac{1}{2}\sqrt{\frac{7}{2}}(5x^3 - 3x)$

这组 $\{\phi_n(x)\}$ 是谱方法和[DG方法](@entry_id:748369)在一维问题中最常用的[模态基](@entry_id:752055)之一 。

#### 二维四边形上的张量积基

对于超立方体单元，例如二维正方形 $\hat{Q}=[-1,1]^2$，最自然的构造方法是**张量积**。我们可以将一维的正交基函数（如勒让德多项式）进行组合。一个二维的[张量积](@entry_id:140694)[模态基](@entry_id:752055)函数可以定义为：
$$
\phi_{ij}(\xi, \eta) = \ell_i(\xi) \ell_j(\eta)
$$
其中 $\ell_i$ 和 $\ell_j$ 是一维[勒让德多项式](@entry_id:141510)。由于一维基[函数的正交性](@entry_id:160337)，这组二维[基函数](@entry_id:170178)在 $\hat{Q}$ 上关于单位权重 $w(\xi, \eta)=1$ 的 $L^2$ [内积](@entry_id:158127)也是正交的：
$$
\int_{-1}^1 \int_{-1}^1 \phi_{ij}(\xi, \eta) \phi_{kl}(\xi, \eta) \,d\xi d\eta = \left( \int_{-1}^1 \ell_i(\xi)\ell_k(\xi) \,d\xi \right) \left( \int_{-1}^1 \ell_j(\eta)\ell_l(\eta) \,d\eta \right)
$$
这个[内积](@entry_id:158127)仅当 $i=k$ 和 $j=l$ 时才非零。这提供了一种在四边形和[六面体单元](@entry_id:174602)上系统地构建[正交基](@entry_id:264024)的简单方法 。

#### 二维单纯形上的Dubiner基

在单纯形单元（如三角形或四面体）上构造正交基则要复杂得多，因为其几何形状不具备[张量积](@entry_id:140694)结构。一个直接的解决方案是使用格拉姆-施密特（Gram-Schmidt）[正交化](@entry_id:149208)，但这个过程在数值上可能不稳定，并且得到的[基函数](@entry_id:170178)缺乏简洁的解析形式。

一个更为优雅和强大的方法是由 Dubiner 提出的，它通过一个巧妙的坐标变换，将在正方形上的张量积正交结构“映射”到三角形上。考虑从参考正方形 $[-1,1]^2$ 到参考三角形 $\hat{T}^2$ 的一个**Duffy映射**：
$$
x = \frac{1}{4}(1+\xi)(1-\eta), \qquad y = \frac{1}{2}(1+\eta)
$$
我们希望在三角形 $\hat{T}^2$ 上构建一组关于标准 $L^2$ [内积](@entry_id:158127)（即权重 $w(x,y)=1$）正交的多项式基。通过变量替换，这个[内积](@entry_id:158127)在 $(\xi, \eta)$ [坐标系](@entry_id:156346)下变为：
$$
\int_{\hat{T}^2} u v \, dx dy = \int_{-1}^1 \int_{-1}^1 (u \circ D)(\xi, \eta) (v \circ D)(\xi, \eta) \left(\frac{1-\eta}{8}\right) \, d\xi d\eta
$$
这里的关键是雅可比行列式 $\det(J) = \frac{1-\eta}{8}$ 引入了一个非均匀的权重 $(1-\eta)$。直接使用[勒让德多项式](@entry_id:141510)的[张量积](@entry_id:140694)在 $(\xi, \eta)$ 坐标下将不再正交。

Dubiner 基的构造精妙之处在于，它在 $(\xi, \eta)$ [坐标系](@entry_id:156346)下定义了一组特殊的函数，这组函数在这个带权[内积](@entry_id:158127)下是正交的，并且它们在 $(x,y)$ [坐标系](@entry_id:156346)下恰好是多项式。其形式为：
$$
\hat{\phi}_{pq}(\xi, \eta) = c_{pq} \, P_p^{(0,0)}(\xi) \left(\frac{1-\eta}{2}\right)^p P_q^{(2p+1, 0)}(\eta)
$$
这里 $P_p^{(0,0)}$ 是标准的[勒让德多项式](@entry_id:141510)，而 $P_q^{(2p+1, 0)}$ 是**[雅可比多项式](@entry_id:197425)**（Jacobi polynomial）。[雅可比多项式](@entry_id:197425) $P_n^{(\alpha, \beta)}$ 在区间 $[-1,1]$ 上关于权重 $(1-z)^\alpha (1+z)^\beta$ 正交。

当我们将这个表达式代入带权[内积](@entry_id:158127)时，$\xi$ 方向的积分是勒让德多项式的正交积分，而 $\eta$ 方向的积分经过化简后，恰好变成了参数为 $\alpha=2p+1, \beta=0$ 的[雅可比多项式](@entry_id:197425)的正交积分。因此，这组[基函数](@entry_id:170178)在三角形上是 $L^2$ 正交的。同时，由于因子 $(\frac{1-\eta}{2})^p = (1-y)^p$ 的存在，这些在 $(\xi,\eta)$ [坐标系](@entry_id:156346)下看起来复杂的函数，在 $(x,y)$ [坐标系](@entry_id:156346)下是总次数为 $p+q$ 的多项式。这一构造完美地解决了在单纯形上构建正交[模态基](@entry_id:752055)的难题 。

### [模态基](@entry_id:752055)的性质与应用

[模态基](@entry_id:752055)，特别是正交[模态基](@entry_id:752055)，不仅仅是为了简化质量矩阵。它们还带来了一系列深刻的理论和实践优势。

#### 逼近、误差与[Parseval恒等式](@entry_id:147134)

使用标准正交[模态基](@entry_id:752055) $\{\phi_n\}$，一个函数 $f \in L^2(\hat{K})$ 的最佳 $p$ 次[多项式逼近](@entry_id:137391)（在 $L^2$ 范数意义下），即其 $L^2$ 投影 $\Pi_p f$，可以非常简单地表示为该函数傅里叶级数的截断：
$$
\Pi_p f(x) = \sum_{n=0}^p a_n \phi_n(x), \quad \text{其中 } a_n = (f, \phi_n)_{L^2(\hat{K})}
$$
逼近误差 $e_p = f - \Pi_p f$ 就是级数的“尾巴” $\sum_{n=p+1}^\infty a_n \phi_n(x)$。根据**[Parseval恒等式](@entry_id:147134)**，函数的 $L^2$ 范数平方等于其所有[模态系数](@entry_id:752057)的平方和。因此，逼近误差的 $L^2$ 范数平方直接由被截断的系数决定：
$$
\|e_p\|_{L^2(\hat{K})}^2 = \|f - \Pi_p f\|_{L^2(\hat{K})}^2 = \sum_{n=p+1}^\infty |a_n|^2
$$
这个关系极为重要。它意味着我们可以通过分析函数[模态系数](@entry_id:752057)的衰减速率来精确估计和控制逼近误差。例如，如果一个函数的[模态系数](@entry_id:752057) $a_n$ 以 $\frac{1}{n+1}$ 的速率衰减，那么其 $p$ 次逼近误差的平方就是 $\sum_{n=p+1}^\infty \frac{1}{(n+1)^2}$，这是一个可以计算的级数 。这种性质是[谱方法](@entry_id:141737)实现[指数收敛](@entry_id:142080)（即所谓的“谱精度”）的理论基础。

#### 层级结构与p-自适应

许多正交[模态基](@entry_id:752055)（如勒让德基和Dubiner基）都具有**层级**（hierarchical）或**嵌套**（nested）的性质。这意味着 $p$ 次多项式空间 $V_p$ 是 $p+1$ 次[多项式空间](@entry_id:144410) $V_{p+1}$ 的一个[子空间](@entry_id:150286)（$V_p \subset V_{p+1}$）。

这一性质与正交性相结合，带来了一个显著的优势：当进行 $p$-自适应（即从 $p$ 次逼近提升到 $p+1$ 次逼近）时，我们不需要重新计算已有的低阶[模态系数](@entry_id:752057)。新的逼近 $P_{p+1}u$ 只是在旧的逼近 $P_p u$ 的基础上，简单地加上了新的、次数为 $p+1$ 的模态分量：
$$
P_{p+1} u = P_p u + \sum_{k+\ell=p+1} \langle u, \phi_{k,\ell} \rangle \phi_{k,\ell}
$$
这是因为计算任意一个[模态系数](@entry_id:752057) $c_{k,\ell} = \langle u, \phi_{k,\ell} \rangle$ 的过程只依赖于函数 $u$ 和对应的[基函数](@entry_id:170178) $\phi_{k,\ell}$，而与空间中其他[基函数](@entry_id:170178)的存在与否无关。这使得 $p$-[自适应算法](@entry_id:142170)的实现非常高效，因为增加精度只需增量式地计算新的高阶信息，而无需废弃已有的计算结果 。

#### 处理弯曲几何

我们之前提到，参考单元[范式](@entry_id:161181)通过[雅可比行列式](@entry_id:137120) $J_e$ 来处理几何变化。对于[仿射映射](@entry_id:746332)（即[线性变换](@entry_id:149133)加平移，例如，任意三角形/四面体都可以通过[仿射映射](@entry_id:746332)从参考单纯形得到），$J_e$ 是一个常数。在这种情况下，参考单元上的正交基在物理单元上仍然是正交的（只是[内积](@entry_id:158127)被缩放了 $J_e$ 倍）。

然而，当物理单元是弯曲的（例如，带有曲线边界的单元），映射 $\boldsymbol{\Phi}_e$ 就不再是仿射的，其[雅可比行列式](@entry_id:137120) $J_e(\boldsymbol{\xi})$ 将是一个非[常数函数](@entry_id:152060)。这将破坏参考基[函数的正交性](@entry_id:160337)。在物理单元上计算的[质量矩阵](@entry_id:177093) $M^e_{ij} = \int_{\hat{K}} \hat{\psi}_i(\boldsymbol{\xi}) \hat{\psi}_j(\boldsymbol{\xi}) J_e(\boldsymbol{\xi}) \,d\boldsymbol{\xi}$ 将不再是[对角矩阵](@entry_id:637782)。

例如，考虑一个一维映射，其[雅可比](@entry_id:264467)为 $J(\xi) = 1 + \varepsilon\xi$。即使我们从标准正交的勒让德基 $\{\phi_0, \phi_1\}$ 出发，其在带权[内积](@entry_id:158127)下的质量矩阵也会出现非对角项 $M_{01} = \int_{-1}^1 \phi_0(\xi)\phi_1(\xi)(1+\varepsilon\xi)d\xi \neq 0$ 。

尽管如此，模态方法仍然能够灵活应对。一种策略是接受物理单元上的[质量矩阵](@entry_id:177093)是满阵的事实，并直接使用它。另一种更精细的策略是，在每个弯曲单元上，对这个非对角的质量矩阵 $M^e$ 进行**[特征值分解](@entry_id:272091)**。这个分解可以给出一个局部的[基变换](@entry_id:189626)，从而构造出一组新的、在该特定弯曲单元上关于其特定带权[内积](@entry_id:158127) $\langle \cdot, \cdot \rangle_{J_e}$ 正交的基。这展示了模态方法在处理复杂几何时的理论灵活性和适应性 。

#### 与节点表示的联系

最后，值得一提的是[模态基](@entry_id:752055)与另一种常见的表示方法——[节点基](@entry_id:752522)（nodal basis，如[拉格朗日多项式](@entry_id:142463)）之间的联系。两者之间可以通过一个**模态-节点转换矩阵** $U$ 相互转换，其元素为 $U_{kj} = \phi_j(\xi_k)$，即在节点 $\xi_k$ 处对[模态基](@entry_id:752055)函数 $\phi_j$求值。

这个转换矩阵的稳定性和条件数对于许多算法至关重要。一个有趣且深刻的结果是，如果选择特定的[正交多项式](@entry_id:146918)基（如与切比雪夫多项式相关的基）和特定的求积节点（如高斯-[切比雪夫点](@entry_id:634016)），可以证明相应的模态-节点转换矩阵 $U$ 的[条件数](@entry_id:145150)可以为 1，这意味着转换过程在数值上是极其稳定的。这揭示了[模态基](@entry_id:752055)、求积规则和函数插值之间存在的深刻内在联系 。