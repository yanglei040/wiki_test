{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational, hands-on check of a quadrature rule's properties. By comparing the numerical result with the exact analytical integral for a monomial on the reference triangle, you will gain a concrete understanding of how these rules work and why their accuracy on simple polynomials is a cornerstone of high-order methods.",
            "id": "3406319",
            "problem": "In high-order spectral element and Discontinuous Galerkin (DG) methods, numerical quadrature rules on simplices must reproduce exact volume and surface integrals of low-degree polynomials to guarantee design-order accuracy. Consider the reference triangle $\\mathcal{T}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$, i.e., $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\ge 0,\\ y\\ge 0,\\ x+y\\le 1\\}$. Starting from the fundamental definition of a two-dimensional integral as an iterated integral over $\\mathcal{T}$, compute the exact value of the integral of the monomial $x^i y^j$ with $i=1$ and $j=1$, namely\n$$\nI=\\int_{\\mathcal{T}} xy\\,dx\\,dy.\n$$\nThen, verify this exact value against the following Dunavant triangle quadrature rule that is designed to be exact for all polynomials of total degree up to $2$. The rule uses $N_q=3$ symmetric points given in barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3)$ by the set\n$$\n\\{( \\tfrac{2}{3},\\tfrac{1}{6},\\tfrac{1}{6}),\\ (\\tfrac{1}{6},\\tfrac{2}{3},\\tfrac{1}{6}),\\ (\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3})\\},\n$$\neach with weight $w=\\frac{1}{6}$ on $\\mathcal{T}$. Use the standard mapping from barycentric coordinates with respect to the vertices $(0,0)$, $(1,0)$, $(0,1)$ to Cartesian coordinates, namely $x=\\lambda_2$ and $y=\\lambda_3$, to evaluate the quadrature approximation\n$$\nQ=\\sum_{q=1}^{N_{q}} w\\, x_q^1 y_q^1.\n$$\nConfirm that $Q=I$, thereby verifying the degree of exactness for this monomial. Provide the final answer as the exact value of $I$. No rounding is required, and no units are involved. Your final answer must be a single number.",
            "solution": "The problem requires a two-part calculation. First, we must find the exact analytical value of the integral $I=\\int_{\\mathcal{T}} xy\\,dx\\,dy$ over the reference triangle $\\mathcal{T}$. Second, we must compute the numerical approximation $Q$ of this integral using a specified $3$-point Dunavant quadrature rule and verify that $Q=I$. The final answer is the exact value of $I$.\n\nThe reference triangle $\\mathcal{T}$ is defined by its vertices at $(0,0)$, $(1,0)$, and $(0,1)$. This region in the Cartesian plane corresponds to the set of points $(x,y)$ satisfying the inequalities $x \\ge 0$, $y \\ge 0$, and $x+y \\le 1$.\n\nFirst, we compute the exact value of the integral $I$ by expressing it as an iterated integral. We choose to integrate with respect to $y$ first, then with respect to $x$. The limits of integration for $x$ are from $0$ to $1$. For a fixed value of $x$ in this interval, $y$ ranges from $0$ to $1-x$.\n$$\nI = \\int_{\\mathcal{T}} xy \\,dx\\,dy = \\int_{x=0}^{x=1} \\left( \\int_{y=0}^{y=1-x} xy \\,dy \\right) dx\n$$\nWe evaluate the inner integral with respect to $y$:\n$$\n\\int_{0}^{1-x} xy \\,dy = x \\left[ \\frac{y^2}{2} \\right]_{0}^{1-x} = x \\left( \\frac{(1-x)^2}{2} - \\frac{0^2}{2} \\right) = \\frac{x(1-x)^2}{2}\n$$\nNext, we substitute this result into the outer integral and integrate with respect to $x$:\n$$\nI = \\int_{0}^{1} \\frac{x(1-x)^2}{2} \\,dx\n$$\nWe expand the integrand to facilitate integration:\n$$\nI = \\frac{1}{2} \\int_{0}^{1} x(1 - 2x + x^2) \\,dx = \\frac{1}{2} \\int_{0}^{1} (x - 2x^2 + x^3) \\,dx\n$$\nPerforming the integration term by term:\n$$\nI = \\frac{1}{2} \\left[ \\frac{x^2}{2} - \\frac{2x^3}{3} + \\frac{x^4}{4} \\right]_{0}^{1}\n$$\nEvaluating the resulting polynomial at the limits of integration:\n$$\nI = \\frac{1}{2} \\left( \\left( \\frac{1^2}{2} - \\frac{2(1)^3}{3} + \\frac{1^4}{4} \\right) - (0) \\right) = \\frac{1}{2} \\left( \\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} \\right)\n$$\nTo simplify the expression in the parenthesis, we find a common denominator, which is $12$:\n$$\nI = \\frac{1}{2} \\left( \\frac{6}{12} - \\frac{8}{12} + \\frac{3}{12} \\right) = \\frac{1}{2} \\left( \\frac{6 - 8 + 3}{12} \\right) = \\frac{1}{2} \\left( \\frac{1}{12} \\right) = \\frac{1}{24}\n$$\nThe exact value of the integral is $I = \\frac{1}{24}$.\n\nSecond, we verify this result using the specified Dunavant quadrature rule. The rule approximates the integral as a weighted sum:\n$$\nQ = \\sum_{q=1}^{N_{q}} w\\, x_{q}^{1} y_{q}^{1}\n$$\nwhere the number of points is $N_q=3$ and the weight for each point is $w=\\frac{1}{6}$. The quadrature points are given in barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ and must be converted to Cartesian coordinates $(x_q, y_q)$ using the provided mapping $x=\\lambda_2$ and $y=\\lambda_3$.\n\nThe three quadrature points are:\n1.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$. This maps to $(x_1, y_1) = (\\frac{1}{6}, \\frac{1}{6})$.\n2.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$. This maps to $(x_2, y_2) = (\\frac{2}{3}, \\frac{1}{6})$.\n3.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3})$. This maps to $(x_3, y_3) = (\\frac{1}{6}, \\frac{2}{3})$.\n\nWe then evaluate the integrand, $f(x,y)=xy$, at each of these Cartesian points:\n-   $f(x_1, y_1) = x_1 y_1 = (\\frac{1}{6})(\\frac{1}{6}) = \\frac{1}{36}$\n-   $f(x_2, y_2) = x_2 y_2 = (\\frac{2}{3})(\\frac{1}{6}) = \\frac{2}{18} = \\frac{1}{9}$\n-   $f(x_3, y_3) = x_3 y_3 = (\\frac{1}{6})(\\frac{2}{3}) = \\frac{2}{18} = \\frac{1}{9}$\n\nNow we compute the quadrature sum $Q$:\n$$\nQ = w f(x_1, y_1) + w f(x_2, y_2) + w f(x_3, y_3) = \\frac{1}{6} \\left( \\frac{1}{36} \\right) + \\frac{1}{6} \\left( \\frac{1}{9} \\right) + \\frac{1}{6} \\left( \\frac{1}{9} \\right)\n$$\n$$\nQ = \\frac{1}{6} \\left( \\frac{1}{36} + \\frac{1}{9} + \\frac{1}{9} \\right)\n$$\nUsing a common denominator of $36$ for the terms in the parenthesis:\n$$\nQ = \\frac{1}{6} \\left( \\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36} \\right) = \\frac{1}{6} \\left( \\frac{1+4+4}{36} \\right) = \\frac{1}{6} \\left( \\frac{9}{36} \\right) = \\frac{1}{6} \\left( \\frac{1}{4} \\right) = \\frac{1}{24}\n$$\nThe value computed by the quadrature rule is $Q = \\frac{1}{24}$.\n\nComparing the exact integral value $I=\\frac{1}{24}$ with the quadrature approximation $Q=\\frac{1}{24}$, we find that they are identical. This confirms that the given quadrature rule is exact for the monomial $x^1y^1$, which has a total degree of $1+1=2$, as stated in the problem's premises. The final answer required is the exact value of $I$.",
            "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$"
        },
        {
            "introduction": "Understanding the efficiency of different quadrature rules is critical for designing performant numerical codes. This practice challenges you to derive and compare the cost, in terms of nodes, of two of the most important one-dimensional quadrature families—Gauss-Legendre and Gauss-Lobatto-Legendre—for achieving a desired polynomial degree of exactness.",
            "id": "3406258",
            "problem": "Consider a one-dimensional reference element with domain $[-1,1]$ and weight function $w(x)=1$. In spectral element and Discontinuous Galerkin (DG) methods, volume and surface integrals over polynomial trial and test spaces are evaluated by numerical quadrature. Two widely used quadrature rules on $[-1,1]$ are Gauss–Legendre (GL) quadrature, which uses $N$ interior nodes, and Gauss–Lobatto–Legendre (GLL) quadrature, which uses $N$ nodes including the endpoints $x=-1$ and $x=1$. The degree of exactness of a quadrature rule is the largest integer $r$ for which the rule integrates every polynomial $p(x)$ with $\\deg(p)\\le r$ exactly.\n\nStarting from fundamental properties of orthogonal polynomials, their associated Gaussian quadrature, and classical error representations for polynomial integration by quadrature, determine, as functions of the target polynomial degree $D \\in \\mathbb{N}$, the minimal number of nodes $N$ required so that:\n- GL with $N$ nodes integrates every polynomial $p(x)$ with $\\deg(p)\\le D$ exactly, and\n- GLL with $N$ nodes integrates every polynomial $p(x)$ with $\\deg(p)\\le D$ exactly.\n\nThen compare these minimal node counts analytically. Express your final answer as a row matrix whose entries are, in order, the minimal $N$ for GL, the minimal $N$ for GLL, and the difference between these two minimal counts. No numerical rounding is required, and no physical units apply. The final answer must be a single closed-form analytic expression.",
            "solution": "The objective is to determine the minimal number of nodes $N$ required for Gauss-Legendre (GL) and Gauss-Lobatto-Legendre (GLL) quadrature to exactly integrate any polynomial $p(x)$ of degree at most $D$, where $D \\in \\mathbb{N}$, on the interval $[-1, 1]$ with weight function $w(x)=1$. The degree of exactness of a quadrature rule is the largest integer $r$ such that the rule is exact for all polynomials of degree less than or equal to $r$. The problem requires finding the minimal $N$ such that the degree of exactness is at least $D$.\n\nLet the integral of a function $f(x)$ be $I(f) = \\int_{-1}^{1} f(x) \\, dx$. An $N$-point quadrature rule approximates this as $Q_N(f) = \\sum_{i=1}^{N} w_i f(x_i)$, where $\\{x_i\\}$ are the nodes and $\\{w_i\\}$ are the weights.\n\n**Gauss-Legendre (GL) Quadrature**\n\nThe GL quadrature rule is the standard Gaussian quadrature for the weight function $w(x)=1$ on the interval $[-1, 1]$. The associated orthogonal polynomials are the Legendre polynomials, $P_n(x)$, which satisfy the orthogonality condition $\\int_{-1}^{1} P_m(x) P_n(x) \\, dx = 0$ for $m \\neq n$.\n\nAn $N$-point GL quadrature rule is constructed using the $N$ roots of the Legendre polynomial $P_N(x)$ as the nodes $\\{x_i\\}_{i=1}^N$. A fundamental theorem of Gaussian quadrature states that such a rule has a degree of exactness of $2N-1$. We can demonstrate this as follows.\n\nLet $p(x)$ be any polynomial with degree at most $2N-1$. We can perform polynomial division of $p(x)$ by the $N$-th degree Legendre polynomial $P_N(x)$:\n$$p(x) = q(x) P_N(x) + r(x)$$\nwhere $q(x)$ is the quotient and $r(x)$ is the remainder. The degrees of these polynomials satisfy $\\deg(q) \\le (2N-1) - N = N-1$ and $\\deg(r) \\le N-1$.\n\nThe exact integral of $p(x)$ is:\n$$I(p) = \\int_{-1}^{1} p(x) \\, dx = \\int_{-1}^{1} \\left( q(x) P_N(x) + r(x) \\right) \\, dx = \\int_{-1}^{1} q(x) P_N(x) \\, dx + \\int_{-1}^{1} r(x) \\, dx$$\nSince $\\deg(q) \\le N-1$, $q(x)$ can be expressed as a linear combination of Legendre polynomials $P_0(x), \\dots, P_{N-1}(x)$. Due to the orthogonality property, $P_N(x)$ is orthogonal to all polynomials of degree less than $N$. Thus, the first integral term is zero:\n$$\\int_{-1}^{1} q(x) P_N(x) \\, dx = 0$$\nThis leaves us with $I(p) = \\int_{-1}^{1} r(x) \\, dx = I(r)$.\n\nNow, we evaluate the quadrature sum for $p(x)$:\n$$Q_N(p) = \\sum_{i=1}^{N} w_i p(x_i)$$\nThe quadrature nodes $x_i$ are the roots of $P_N(x)$, so $P_N(x_i) = 0$ for all $i=1, \\dots, N$. Evaluating $p(x)$ at these nodes gives:\n$$p(x_i) = q(x_i) P_N(x_i) + r(x_i) = q(x_i) \\cdot 0 + r(x_i) = r(x_i)$$\nTherefore, the quadrature sum becomes:\n$$Q_N(p) = \\sum_{i=1}^{N} w_i r(x_i) = Q_N(r)$$\nA Gaussian quadrature rule with $N$ nodes is constructed to be exact for all polynomials of degree up to $N-1$. Since $\\deg(r) \\le N-1$, we have $Q_N(r) = I(r)$.\nCombining these results, we get $I(p) = I(r) = Q_N(r) = Q_N(p)$, which shows the rule is exact for any polynomial $p(x)$ with $\\deg(p) \\le 2N-1$. This degree of exactness is maximal.\n\nFor the GL rule to integrate every polynomial $p(x)$ with $\\deg(p) \\le D$ exactly, its degree of exactness must be at least $D$.\n$$2N_{GL} - 1 \\ge D$$\nSolving for $N_{GL}$, we find:\n$$N_{GL} \\ge \\frac{D+1}{2}$$\nSince $N_{GL}$ must be an integer, we take the smallest integer satisfying this inequality, which is given by the ceiling function:\n$$N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$$\n\n**Gauss-Lobatto-Legendre (GLL) Quadrature**\n\nThe GLL quadrature rule is a variant of Gaussian quadrature where the endpoints of the interval, $x=-1$ and $x=1$, are pre-assigned as nodes. For an $N$-point rule, two nodes are fixed ($x_1=-1$, $x_N=1$), and the remaining $N-2$ interior nodes are chosen to maximize the degree of exactness. It can be shown that these $N-2$ interior nodes are the roots of $P'_{N-1}(x)$, the first derivative of the $(N-1)$-th degree Legendre polynomial.\n\nThe degree of exactness of an $N$-point GLL rule is $2N-3$. Let's demonstrate this.\nLet $p(x)$ be a polynomial of degree at most $2N-3$. The $N$ GLL nodes are the roots of the polynomial $\\omega(x) = (x^2-1)P'_{N-1}(x)$, which has degree $N$. We divide $p(x)$ by $\\omega(x)$:\n$$p(x) = q(x) (x^2-1)P'_{N-1}(x) + r(x)$$\nwhere $\\deg(q) \\le (2N-3) - N = N-3$ and $\\deg(r) \\le N-1$.\n\nThe exact integral is $I(p) = \\int_{-1}^{1} q(x)(x^2-1)P'_{N-1}(x) \\, dx + \\int_{-1}^{1} r(x) \\, dx$.\nUsing integration by parts on the first term:\n$$\\int_{-1}^{1} q(x)(x^2-1)P'_{N-1}(x) \\, dx = \\left[ q(x)(x^2-1)P_{N-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} \\frac{d}{dx}\\left(q(x)(x^2-1)\\right) P_{N-1}(x) \\, dx$$\nThe boundary term is zero because $(x^2-1)$ is zero at $x=\\pm 1$. The derivative $\\frac{d}{dx}(q(x)(x^2-1))$ results in a polynomial of degree at most $(N-3)+2-1 = N-2$. By orthogonality, the integral of this polynomial multiplied by $P_{N-1}(x)$ is zero. Thus, the first integral term vanishes, and $I(p) = I(r)$.\n\nThe quadrature sum is $Q_N(p) = \\sum_{i=1}^{N} w_i p(x_i)$. Since the GLL nodes $x_i$ are the roots of $(x^2-1)P'_{N-1}(x)$, we have $p(x_i) = r(x_i)$ at each node. Thus, $Q_N(p) = Q_N(r)$.\nThe GLL rule is constructed to be exact for polynomials of degree up to $N-1$. Since $\\deg(r) \\le N-1$, we have $Q_N(r) = I(r)$.\nTherefore, $I(p) = I(r) = Q_N(r) = Q_N(p)$, and the rule is exact for all polynomials of degree up to $2N-3$.\n\nFor the GLL rule to integrate every polynomial $p(x)$ with $\\deg(p) \\le D$ exactly, its degree of exactness must be at least $D$.\n$$2N_{GLL} - 3 \\ge D$$\nSolving for $N_{GLL}$:\n$$2N_{GLL} \\ge D+3 \\implies N_{GLL} \\ge \\frac{D+3}{2}$$\nThe minimal integer $N_{GLL}$ is:\n$$N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil$$\n\n**Comparison**\n\nWe now compare the minimal node counts $N_{GL}$ and $N_{GLL}$.\n$$N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$$\n$$N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil = \\left\\lceil \\frac{D+1}{2} + \\frac{2}{2} \\right\\rceil = \\left\\lceil \\frac{D+1}{2} + 1 \\right\\rceil$$\nUsing the property of the ceiling function $\\lceil z+k \\rceil = \\lceil z \\rceil + k$ for any integer $k$, we get:\n$$N_{GLL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil + 1 = N_{GL} + 1$$\nThe difference between the minimal node counts is:\n$$N_{GLL} - N_{GL} = 1$$\nThis shows that for a given required degree of exactness $D$, GLL quadrature requires exactly one more node than GL quadrature. This is the trade-off for forcing the endpoints to be included in the node set.\n\nThe final answer requires a row matrix with the entries $N_{GL}$, $N_{GLL}$, and $N_{GLL} - N_{GL}$. These are:\n1. $N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$\n2. $N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil$\n3. $N_{GLL} - N_{GL} = 1$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lceil \\frac{D+1}{2} \\right\\rceil & \\left\\lceil \\frac{D+3}{2} \\right\\rceil & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This exercise illuminates one of the most subtle yet critical pitfalls in spectral and Discontinuous Galerkin methods: aliasing error. By working through a concrete example where an insufficient quadrature rule corrupts a fundamental $L^2$ projection, you will see precisely how errors can arise even when they are \"invisible\" at the quadrature points themselves, underscoring the need for careful quadrature selection.",
            "id": "3406257",
            "problem": "Consider the one-dimensional reference element $[-1,1]$ with the standard $L^2$ inner product $\\langle u, v \\rangle = \\int_{-1}^{1} u(x)v(x)\\,dx$. Let $\\{P_n(x)\\}_{n\\geq 0}$ denote the Legendre polynomials on $[-1,1]$, which are orthogonal with respect to $\\langle \\cdot, \\cdot \\rangle$ and have exact norms $\\|P_n\\|_{L^2(-1,1)}^2 = \\int_{-1}^{1} P_n(x)^2\\,dx = \\frac{2}{2n+1}$. In polynomial spectral and Discontinuous Galerkin methods, the $L^2$ projection of a function $f$ onto the degree-$p$ polynomial space is defined by coefficients $c_k$ satisfying $\\langle f - \\sum_{k=0}^{p} c_k P_k, P_j \\rangle = 0$ for all $j=0,\\dots,p$.\n\nSuppose the inner products are approximated by a quadrature rule of polynomial exactness $2p-1$, specifically the $(p+1)$-point Gauss–Lobatto–Legendre (GLL) quadrature on $[-1,1]$, which is exact for integrands of degree at most $2p-1$. To demonstrate aliasing when projecting a degree-$2p$ polynomial onto the degree-$p$ space, construct and analyze the following specific example:\n\n- Take $p=2$ and $f(x) = P_4(x)$.\n- Use the $3$-point GLL quadrature nodes and weights: $x_1=-1$, $x_2=0$, $x_3=1$, with weights $w_1=\\frac{1}{3}$, $w_2=\\frac{4}{3}$, $w_3=\\frac{1}{3}$.\n\nCompute the quadrature-based projection coefficients $c_0$, $c_1$, and $c_2$ defined by the discrete normal equations\n$$\n\\sum_{m=0}^{2} \\left(\\sum_{i=1}^{3} w_i P_m(x_i) P_j(x_i)\\right) c_m = \\sum_{i=1}^{3} w_i f(x_i) P_j(x_i), \\quad j=0,1,2,\n$$\nand thereby obtain the quadrature-based projection $u_Q(x)=\\sum_{k=0}^{2} c_k P_k(x)$. Show that aliasing occurs (i.e., $u_Q(x)\\not\\equiv 0$), even though the exact $L^2$ projection of $f(x)=P_4(x)$ onto degree $2$ is the zero polynomial. Finally, quantify the resulting projection error by reporting the exact value of the $L^2([-1,1])$ norm of the aliasing-induced error, $\\|u_Q-0\\|_{L^2([-1,1])}$. Your final answer must be a single closed-form analytic expression with no units.",
            "solution": "The problem asks for the computation of a quadrature-based $L^2$ projection of the function $f(x) = P_4(x)$ onto the space of polynomials of degree at most $p=2$ on the interval $[-1,1]$. The projection, which we denote as $u_Q(x)$, is an element of the space $\\mathbb{P}_2 = \\text{span}\\{P_0(x), P_1(x), P_2(x)\\}$, and can be written as $u_Q(x) = \\sum_{k=0}^{2} c_k P_k(x)$.\n\nThe coefficients $c_k$ are determined by approximating the inner products in the Galerkin orthogonality condition using a specified quadrature rule. The exact orthogonality condition for the true $L^2$ projection is $\\langle f - \\sum_{k=0}^{2} c_k P_k, P_j \\rangle = 0$ for $j=0,1,2$. Replacing the exact inner product $\\langle u, v \\rangle = \\int_{-1}^{1} u(x)v(x)dx$ with the discrete inner product induced by the quadrature rule, $\\langle u, v \\rangle_Q = \\sum_{i=1}^{3} w_i u(x_i)v(x_i)$, we get the system of linear equations provided in the problem statement:\n$$ \\sum_{m=0}^{2} \\langle P_m, P_j \\rangle_Q c_m = \\langle f, P_j \\rangle_Q, \\quad j=0,1,2 $$\nThis can be written as a matrix system $M_Q \\mathbf{c} = \\mathbf{f}_Q$, where $(M_Q)_{jm} = \\langle P_m, P_j \\rangle_Q$, $\\mathbf{c} = (c_0, c_1, c_2)^T$, and $(\\mathbf{f}_Q)_j = \\langle f, P_j \\rangle_Q$.\n\nThe problem specifies $p=2$ and the use of a $3$-point Gauss-Lobatto-Legendre (GLL) quadrature, with nodes $x_1=-1$, $x_2=0$, $x_3=1$ and weights $w_1=1/3$, $w_2=4/3$, $w_3=1/3$. This quadrature rule is exact for polynomials of degree at most $2p-1 = 2(2)-1 = 3$.\n\nFirst, we require the values of the relevant Legendre polynomials at the quadrature nodes. The first few Legendre polynomials are:\n$P_0(x) = 1$\n$P_1(x) = x$\n$P_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$\n\nEvaluating these at the nodes $x \\in \\{-1, 0, 1\\}$:\n$P_0(-1)=1, P_0(0)=1, P_0(1)=1$\n$P_1(-1)=-1, P_1(0)=0, P_1(1)=1$\n$P_2(-1)=1, P_2(0)=-\\frac{1}{2}, P_2(1)=1$\n$P_4(-1)=1, P_4(0)=\\frac{3}{8}, P_4(1)=1$\n\nNext, we compute the elements of the discrete mass matrix $M_Q$. For $j,m \\in \\{0,1,2\\}$:\n$(M_Q)_{jm} = \\langle P_m, P_j \\rangle_Q = \\sum_{i=1}^{3} w_i P_j(x_i) P_m(x_i)$.\nSince the integrand $P_j(x)P_m(x)$ has degree at most $2+2=4$, and the quadrature is only exact up to degree $3$, we do not expect the discrete mass matrix to be proportional to the identity matrix, which would happen if it were equal to the exact (diagonal) mass matrix. However, due to the symmetry of the GLL nodes and weights, and properties of even/odd Legendre polynomials, the off-diagonal terms are zero:\n$\\langle P_0, P_1 \\rangle_Q = \\frac{1}{3}(1)(-1) + \\frac{4}{3}(1)(0) + \\frac{1}{3}(1)(1) = 0$ (exact, deg=1)\n$\\langle P_0, P_2 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac{4}{3}(1)(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = \\frac{2}{3} - \\frac{2}{3} = 0$ (exact, deg=2)\n$\\langle P_1, P_2 \\rangle_Q = \\frac{1}{3}(-1)(1) + \\frac{4}{3}(0)(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = 0$ (exact, deg=3)\nThe diagonal elements are:\n$\\langle P_0, P_0 \\rangle_Q = \\sum_{i=1}^{3} w_i (1)^2 = \\frac{1}{3} + \\frac{4}{3} + \\frac{1}{3} = 2$. This is exact: $\\|P_0\\|^2=2$.\n$\\langle P_1, P_1 \\rangle_Q = \\frac{1}{3}(-1)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}(1)^2 = \\frac{2}{3}$. This is exact: $\\|P_1\\|^2=2/3$.\n$\\langle P_2, P_2 \\rangle_Q = \\frac{1}{3}(1)^2 + \\frac{4}{3}(-\\frac{1}{2})^2 + \\frac{1}{3}(1)^2 = \\frac{1}{3} + \\frac{4}{3}(\\frac{1}{4}) + \\frac{1}{3} = 1$. This is not exact: $\\|P_2\\|^2=2/5$.\nThe discrete mass matrix is diagonal:\n$$ M_Q = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2/3 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nNow, we compute the right-hand side vector $\\mathbf{f}_Q$, with $f(x)=P_4(x)$:\n$(\\mathbf{f}_Q)_j = \\langle P_4, P_j \\rangle_Q = \\sum_{i=1}^{3} w_i P_4(x_i) P_j(x_i)$.\nFor $j=0$: $\\langle P_4, P_0 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac{4}{3}(\\frac{3}{8})(1) + \\frac{1}{3}(1)(1) = \\frac{1}{3} + \\frac{1}{2} + \\frac{1}{3} = \\frac{7}{6}$.\nFor $j=1$: $\\langle P_4, P_1 \\rangle_Q = \\frac{1}{3}(1)(-1) + \\frac{4}{3}(\\frac{3}{8})(0) + \\frac{1}{3}(1)(1) = 0$.\nFor $j=2$: $\\langle P_4, P_2 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac43(\\frac{3}{8})(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = \\frac{2}{3} - \\frac{1}{4} = \\frac{5}{12}$.\n\nThe system $M_Q \\mathbf{c} = \\mathbf{f}_Q$ is:\n$$ \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2/3 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 7/6 \\\\ 0 \\\\ 5/12 \\end{pmatrix} $$\nSolving for the coefficients:\n$c_0 = \\frac{7/6}{2} = \\frac{7}{12}$\n$c_1 = \\frac{0}{2/3} = 0$\n$c_2 = \\frac{5/12}{1} = \\frac{5}{12}$\n\nThe quadrature-based projection is $u_Q(x) = \\frac{7}{12}P_0(x) + 0 \\cdot P_1(x) + \\frac{5}{12}P_2(x)$.\nThe exact $L^2$ projection of $f(x) = P_4(x)$ onto $\\mathbb{P}_2$ is the zero polynomial, because $\\langle P_4, P_j \\rangle = 0$ for $j=0,1,2$ due to the orthogonality of Legendre polynomials. However, the computed projection $u_Q(x)$ is not the zero polynomial, since coefficients $c_0$ and $c_2$ are non-zero. This discrepancy is the aliasing error, caused by the quadrature rule's inability to exactly integrate the products $P_4(x)P_j(x)$, which have degrees up to $4+2=6$. The high-frequency component $P_4(x)$ is \"aliased\" into the lower-frequency space $\\mathbb{P}_2$. At the quadrature points, $u_Q(x_i)$ is equal to $P_4(x_i)$, so the error is invisible to the quadrature rule.\n\nThe problem asks for the $L^2$ norm of the resulting aliasing-induced error. The error is the difference between the computed projection and the exact projection, which is $u_Q(x) - 0 = u_Q(x)$. We need to calculate $\\|u_Q\\|_{L^2(-1,1)}$.\nUsing the orthogonality of the Legendre polynomials under the exact inner product:\n$$ \\|u_Q\\|^2 = \\left\\langle \\frac{7}{12}P_0 + \\frac{5}{12}P_2, \\frac{7}{12}P_0 + \\frac{5}{12}P_2 \\right\\rangle $$\n$$ \\|u_Q\\|^2 = \\left(\\frac{7}{12}\\right)^2 \\langle P_0, P_0 \\rangle + \\left(\\frac{5}{12}\\right)^2 \\langle P_2, P_2 \\rangle $$\nUsing the known norms $\\|P_n\\|^2 = \\frac{2}{2n+1}$:\n$\\|P_0\\|^2 = \\frac{2}{2(0)+1} = 2$\n$\\|P_2\\|^2 = \\frac{2}{2(2)+1} = \\frac{2}{5}$\nSubstituting these values:\n$$ \\|u_Q\\|^2 = \\left(\\frac{49}{144}\\right)(2) + \\left(\\frac{25}{144}\\right)\\left(\\frac{2}{5}\\right) = \\frac{98}{144} + \\frac{50}{144 \\cdot 5} = \\frac{98}{144} + \\frac{10}{144} = \\frac{108}{144} $$\nSimplifying the fraction:\n$$ \\|u_Q\\|^2 = \\frac{108}{144} = \\frac{9 \\times 12}{12 \\times 12} = \\frac{9}{12} = \\frac{3}{4} $$\nThe $L^2$ norm of the aliasing error is the square root of this value:\n$$ \\|u_Q - 0\\|_{L^2([-1,1])} = \\|u_Q\\| = \\sqrt{\\frac{3}{4}} = \\frac{\\sqrt{3}}{2} $$\nThis is the final measure of the projection error due to aliasing.",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$"
        }
    ]
}