{
    "hands_on_practices": [
        {
            "introduction": "不连续伽辽金方法（Discontinuous Galerkin, DG）的核心在于处理单元之间的交界。第一个练习将通过一个具体的三维算例，让您亲手实践这些基本定义。我们将确定共享面上指向外部的单位法向量，计算函数在界面上的迹（trace），并最终计算一个内部罚项的能量积分，这是保证DG方法稳定性的基石 。",
            "id": "3391964",
            "problem": "考虑$\\mathbb{R}^3$中的两个四面体，记为$T^{-}$和$T^{+}$，它们共享一个顶点为$A=(0,0,0)$、$B=(1,0,0)$和$C=(0,1,0)$的三角形面$F$。四面体$T^{-}$的第四个顶点为$D^{-}=(0,0,1)$，四面体$T^{+}$的第四个顶点为$D^{+}=(0,0,-1)$。设$u$是一个标量场，关于此剖分是分段仿射的，其限制为\n$$\nu^{-}(x,y,z)=2x+y+z \\quad \\text{on } T^{-}, \n\\qquad \nu^{+}(x,y,z)=x - y + 2z + 1 \\quad \\text{on } T^{+}.\n$$\n使用间断 Galerkin (DG) 方法在内部面上的界面微积分，从迹算子、外向单位法向量、跳跃和平均的基本定义出发。首先，确定在面$F$上分别由$T^{-}$和$T^{+}$继承的外向单位法向量$\\boldsymbol{n}^{-}$和$\\boldsymbol{n}^{+}$，除了每个单元的外向约定外，不做任何关于面定向的先验选择。然后计算标量场穿过$F$的跳跃$[u]$，并评估对称内部罚能贡献\n$$\nJ \\;=\\; \\int_{F} [u]\\cdot [u] \\, \\mathrm{d}S,\n$$\n注意展示正确的定向处理，以使结果与标记约定无关。将最终答案表示为一个精确的数字（无单位）。不需要四舍五入，也不需要引入额外的常数。",
            "solution": "问题陈述经核实具有科学依据、适定且客观。这是数值分析领域中的一个标准问题，特别涉及间断 Galerkin (DG) 方法。所有必要信息均已提供，各量定义明确，任务是基于这些定义进行直接计算。因此，该问题是有效的，将提供解答。\n\n问题要求在两个四面体$T^{-}$和$T^{+}$之间共享的三角形面$F$上，计算一个对称内部罚项 $J_F = \\int_{F} [u]^2 \\, \\mathrm{d}S$。这需要三个主要步骤：确定面$F$的外向单位法向量，计算标量场$u$穿过$F$的跳跃$[u]$，最后计算曲面积分。\n\n步骤 1：确定外向单位法向量$\\boldsymbol{n}^{-}$和$\\boldsymbol{n}^{+}$。\n\n面$F$是一个顶点为$A=(0,0,0)$、$B=(1,0,0)$和$C=(0,1,0)$的三角形。由于所有三个顶点的$z$坐标都为$0$，因此面$F$完全位于$xy$平面内，该平面由方程$z=0$描述。\n\n为了找到面$F$的法向量，我们可以计算位于该面平面内的两个向量的叉积。我们使用向量$\\vec{AB}$和$\\vec{AC}$：\n$$ \\vec{AB} = B - A = (1,0,0) - (0,0,0) = (1,0,0) $$\n$$ \\vec{AC} = C - A = (0,1,0) - (0,0,0) = (0,1,0) $$\n一个法向量$\\boldsymbol{n}_{F}$由下式给出：\n$$ \\boldsymbol{n}_{F} = \\vec{AB} \\times \\vec{AC} = \\begin{vmatrix} \\boldsymbol{i} & \\boldsymbol{j} & \\boldsymbol{k} \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{vmatrix} = (0-0)\\boldsymbol{i} - (0-0)\\boldsymbol{j} + (1-0)\\boldsymbol{k} = (0,0,1) $$\n因此，面$F$的两个单位法向量是$(0,0,1)$和$(0,0,-1)$。\n\n问题要求确定分别由四面体$T^{-}$和$T^{+}$继承的*外向*单位法向量$\\boldsymbol{n}^{-}$和$\\boldsymbol{n}^{+}$。一个体的一个面上的外向法向量指向远离该体内部的方向。\n\n对于四面体$T^{-}$，其顶点为$A=(0,0,0)$、$B=(1,0,0)$、$C=(0,1,0)$和$D^{-}=(0,0,1)$。第四个顶点$D^{-}$的$z$坐标为正。$T^{-}$内部的任何点都可以表示为其顶点的正系数凸组合，因此其$z$坐标也为正。所以，$T^{-}$的内部位于半空间$z>0$中。面$F$（在$z=0$处）上的外向法向量$\\boldsymbol{n}^{-}$必须指向远离这个内部的方向，即$z$减小的方向。因此，从$T^{-}$出发的外向单位法向量是：\n$$ \\boldsymbol{n}^{-} = (0,0,-1) $$\n对于四面体$T^{+}$，其顶点为$A=(0,0,0)$、$B=(1,0,0)$、$C=(0,1,0)$和$D^{+}=(0,0,-1)$。第四个顶点$D^{+}$的$z$坐标为负。$T^{+}$的内部位于半空间$z<0$中。面$F$（在$z=0$处）上的外向法向量$\\boldsymbol{n}^{+}$必须指向远离这个内部的方向，即$z$增大的方向。因此，从$T^{+}$出发的外向单位法向量是：\n$$ \\boldsymbol{n}^{+} = (0,0,1) $$\n正如内部面所预期的，我们有$\\boldsymbol{n}^{+} = -\\boldsymbol{n}^{-}$。\n\n步骤 2：计算标量场穿过$F$的跳跃$[u]$。\n\n标量场$u$是分段给出的：\n$$ u^{-}(x,y,z) = 2x+y+z \\quad \\text{on } T^{-} $$\n$$ u^{+}(x,y,z) = x - y + 2z + 1 \\quad \\text{on } T^{+} $$\n这些函数在面$F$上（其中$z=0$）的迹可以通过设置$z=0$来找到：\n$$ u^{-}|_{F} = u^{-}(x,y,0) = 2x+y $$\n$$ u^{+}|_{F} = u^{+}(x,y,0) = x-y+1 $$\n内部面上的跳跃算子$[u]$是相对于为该面选择的单位法向量方向来定义的。让我们将共享该面的两个单元表示为$K_L$和$K_R$，其中所选法向量$\\boldsymbol{n}$从$K_L$指向$K_R$。标量跳跃的一个常用定义是$[u] = u_R - u_L$。然而，要计算的量是$J = \\int_{F} [u]^2 \\, \\mathrm{d}S$。如果我们选择相反的法向量$\\boldsymbol{n}' = -\\boldsymbol{n}$，那么$K_L$和$K_R$的角色会互换，导致新的跳跃$[u]' = u_L - u_R = -[u]$。被积函数将变为$([u]')^2 = (-[u])^2 = [u]^2$。因此，积分$J$的值与面的特定法向量定向选择无关，这符合要求。\n\n让我们根据标签'$+$'和'$-$'来采用一个跳跃的约定。我们将跳跃定义为：\n$$ [u] = u^{+}|_{F} - u^{-}|_{F} $$\n代入迹的表达式：\n$$ [u] = (x-y+1) - (2x+y) = -x - 2y + 1 $$\n\n步骤 3：计算积分$J = \\int_{F} [u]^2 \\, \\mathrm{d}S$。\n\n需要计算的积分是：\n$$ J = \\int_{F} (-x - 2y + 1)^2 \\, \\mathrm{d}S $$\n面$F$是$xy$平面中的一个三角形，因此曲面元$\\mathrm{d}S$就是$\\mathrm{d}A = \\mathrm{d}x\\mathrm{d}y$。积分区域是顶点为$(0,0)$、$(1,0)$和$(0,1)$的三角形。这个直角三角形的斜边是连接$(1,0)$和$(0,1)$的线段，其方程为$x+y=1$，或$y=1-x$。该区域由不等式$0 \\le x \\le 1$和$0 \\le y \\le 1-x$描述。\n\n积分变为：\n$$ J = \\int_{0}^{1} \\int_{0}^{1-x} (1-x-2y)^2 \\, \\mathrm{d}y \\, \\mathrm{d}x $$\n首先，我们计算关于$y$的内层积分：\n$$ \\int_{0}^{1-x} (1-x-2y)^2 \\, \\mathrm{d}y $$\n设$v = 1-x-2y$，则$\\mathrm{d}v = -2\\mathrm{d}y$，或$\\mathrm{d}y = -\\frac{1}{2}\\mathrm{d}v$。\n当$y=0$时，$v = 1-x$。\n当$y=1-x$时，$v = 1-x-2(1-x) = 1-x-2+2x = x-1$。\n内层积分是：\n$$ \\int_{1-x}^{x-1} v^2 \\left(-\\frac{1}{2}\\right) \\, \\mathrm{d}v = \\frac{1}{2} \\int_{x-1}^{1-x} v^2 \\, \\mathrm{d}v = \\frac{1}{2} \\left[ \\frac{v^3}{3} \\right]_{x-1}^{1-x} $$\n$$ = \\frac{1}{6} \\left( (1-x)^3 - (x-1)^3 \\right) = \\frac{1}{6} \\left( (1-x)^3 - (-(1-x))^3 \\right) $$\n$$ = \\frac{1}{6} \\left( (1-x)^3 + (1-x)^3 \\right) = \\frac{1}{6} \\left( 2(1-x)^3 \\right) = \\frac{1}{3}(1-x)^3 $$\n现在，我们将此结果代入外层积分：\n$$ J = \\int_{0}^{1} \\frac{1}{3} (1-x)^3 \\, \\mathrm{d}x $$\n我们可以进行另一次换元，令$w = 1-x$，则$\\mathrm{d}w = -\\mathrm{d}x$。当$x=0$时，$w=1$。当$x=1$时，$w=0$。\n$$ J = \\frac{1}{3} \\int_{1}^{0} w^3 (-\\mathrm{d}w) = \\frac{1}{3} \\int_{0}^{1} w^3 \\, \\mathrm{d}w = \\frac{1}{3} \\left[ \\frac{w^4}{4} \\right]_{0}^{1} $$\n$$ J = \\frac{1}{3} \\left( \\frac{1^4}{4} - \\frac{0^4}{4} \\right) = \\frac{1}{3} \\cdot \\frac{1}{4} = \\frac{1}{12} $$\n对称内部罚能贡献的值为$\\frac{1}{12}$。",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "掌握了界面量的计算后，下一步是理解它们如何影响单元内部的解。这一步通过“提升算子”（lifting operator）实现，它将界面上的信息（如跃变）转化为定义在单元体上的函数。本练习将指导您在一个简单的一维情况下构造一个提升算子，并验证一个关键的稳定性估计，揭示其在确保DG格式良定性中的作用 。",
            "id": "3391981",
            "problem": "考虑一个一维(1D)间断Galerkin(DG)设置，用于定义在区域 $\\Omega=[0,2]$ 上的一个标量场。该区域被划分为两个单元 $K^{-}=[0,1]$ 和 $K^{+}=[1,2]$，它们有一个内部面 $e=\\{x=1\\}$。令分片多项式空间为分片线性空间 $V_h$，它由在每个单元上是线性的且在 $x=1$ 处间断的函数组成。\n\n对于任意 $v_h \\in V_h$，定义在内部面 $e$ 上的平均算子和跳跃算子为\n$$\\{v_h\\}(1)=\\frac{v_h(1^{-})+v_h(1^{+})}{2}, \\qquad [v_h]=v_h(1^{+})-v_h(1^{-}).$$\n通过关于双单元片上的 $L^{2}$ 内积的 Riesz 表示来定义局部提升算子 $r_e:\\mathbb{R}\\to V_h$，即，对于任意标量 $\\varphi \\in \\mathbb{R}$ 和任意支集在 $K^{-}\\cup K^{+}$ 上的测试函数 $v_h \\in V_h$，\n$$\\int_{K^{-}} r_e(\\varphi)\\, v_h\\, dx+\\int_{K^{+}} r_e(\\varphi)\\, v_h\\, dx \\;=\\; -\\,\\varphi\\, \\{v_h\\}(1).$$\n\n设 $u_h\\in V_h$ 为分片线性函数，其迹为 $u_h(1^{-})=b$ 和 $u_h(1^{+})=c$，因此 $[u_h]=c-b$。在 $K^{-}$上，使用节点基函数 $\\phi_{0}(x)=1-x$ 和 $\\phi_{1}(x)=x$。在 $K^{+}$上，使用 $\\psi_{1}(x)=2-x$ 和 $\\psi_{2}(x)=x-1$。取单元长度 $h_e=1$，并通过在 $x=1$ 处的离散对偶配对定义 $L^{2}(e)$ 范数，$\\| \\varphi \\|_{L^{2}(e)}=|\\varphi|$。\n\n任务：\n- 计算 $r_e([u_h])$ 在 $K^{-}$ 上的局部基 $\\{\\phi_{0},\\phi_{1}\\}$ 和 $K^{+}$ 上的局部基 $\\{\\psi_{1},\\psi_{2}\\}$ 中的系数，并写出 $r_e([u_h])(x)$ 在每个单元上的显式表达式。\n- 计算 $\\|r_e([u_h])\\|_{L^{2}(\\Omega)}$。\n- 在此网格和空间上验证稳定性界 $$\\|r_e([u_h])\\|_{L^{2}(\\Omega)} \\leq C\\, h_e^{-1/2}\\, \\|[u_h]\\|_{L^{2}(e)}$$，并确定使其对所有实数 $b$ 和 $c$ 均成立的最小常数 $C$。\n\n将你的最终答案表示为最小常数 $C$ 的精确值。不需要四舍五入，也不使用单位。",
            "solution": "首先将根据指定标准对问题进行验证。\n\n### 问题验证\n\n#### 第1步：提取已知条件\n- 区域: $\\Omega=[0,2]$\n- 剖分: $K^{-}=[0,1]$ 和 $K^{+}=[1,2]$\n- 内部面: $e=\\{x=1\\}$\n- 函数空间: $V_h$ 是分片线性多项式空间，在 $x=1$ 处间断。\n- 在 $e$ 上的平均算子: $\\{v_h\\}(1)=\\frac{v_h(1^{-})+v_h(1^{+})}{2}$，对于 $v_h \\in V_h$。\n- 在 $e$ 上的跳跃算子: $[v_h]=v_h(1^{+})-v_h(1^{-})$，对于 $v_h \\in V_h$。\n- 局部提升算子 $r_e:\\mathbb{R}\\to V_h$ 定义为:\n  $$\\int_{K^{-}} r_e(\\varphi)\\, v_h\\, dx+\\int_{K^{+}} r_e(\\varphi)\\, v_h\\, dx \\;=\\; -\\,\\varphi\\, \\{v_h\\}(1)$$\n  对于任意标量 $\\varphi \\in \\mathbb{R}$ 和任意支集在 $K^{-}\\cup K^{+}$ 上的测试函数 $v_h \\in V_h$。\n- 一个特定的函数 $u_h \\in V_h$ 的迹为 $u_h(1^{-})=b$ 和 $u_h(1^{+})=c$。其跳跃为 $[u_h]=c-b$。\n- 在 $K^{-}=[0,1]$ 上的基函数: $\\phi_{0}(x)=1-x$ 和 $\\phi_{1}(x)=x$。\n- 在 $K^{+}=[1,2]$ 上的基函数: $\\psi_{1}(x)=2-x$ 和 $\\psi_{2}(x)=x-1$。\n- 单元长度: $h_e=1$。\n- $L^{2}(e)$ 范数: $\\| \\varphi \\|_{L^{2}(e)}=|\\varphi|$，对于一个标量 $\\varphi$。\n- 任务:\n  1. 计算 $r_e([u_h])$ 在给定局部基中的系数，并写出其在每个单元上的显式形式。\n  2. 计算 $\\|r_e([u_h])\\|_{L^{2}(\\Omega)}$。\n  3. 验证稳定性界 $\\|r_e([u_h])\\|_{L^{2}(\\Omega)} \\leq C\\, h_e^{-1/2}\\, \\|[u_h]\\|_{L^{2}(e)}$ 并找到最小常数 $C$。\n\n#### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是间断Galerkin(DG)方法理论中的一个标准练习，这是偏微分方程数值分析的一个成熟分支。区域、函数空间、算子（跳跃、平均、提升）和基函数的定义都是标准的且内部一致。该问题是适定的，因为通过Riesz表示定义的提升算子确保了在有限维空间 $V_h$ 中存在唯一解。语言客观而精确。问题是完整且自洽的。它没有违反任何无效性标准。\n\n#### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n问题要求计算提升算子 $r_e([u_h])$、其 $L^2$-范数以及一个稳定性常数。令 $\\varphi = [u_h] = u_h(1^{+}) - u_h(1^{-}) = c-b$。\n\n提升算子 $r_e(\\varphi)$ 是分片线性空间 $V_h$ 中的一个元素。因此，它可以表示为每个单元上给定基函数的线性组合。\n在 $K^{-} = [0,1]$上，我们写成：\n$$r_e(\\varphi)(x) = a_0 \\phi_0(x) + a_1 \\phi_1(x)$$\n在 $K^{+} = [1,2]$上，我们写成：\n$$r_e(\\varphi)(x) = b_1 \\psi_1(x) + b_2 \\psi_2(x)$$\n系数 $a_0, a_1, b_1, b_2$ 由提升算子的定义关系确定：\n$$\\int_{\\Omega} r_e(\\varphi) v_h dx = -\\varphi \\{v_h\\}(1)$$\n对于所有 $v_h \\in V_h$。为了求出这四个系数，我们将此关系与张成 $V_h$ 的四个基函数进行测试。\n\n首先，令 $v_h(x)$ 为基函数 $\\phi_0(x)=1-x$ (当 $x \\in K^{-}$ 时) 且在其他地方为0。在 $x=1$ 处的迹为 $v_h(1^{-})=\\phi_0(1)=0$ 和 $v_h(1^{+})=0$。因此，平均值为 $\\{v_h\\}(1)=0$。\n定义关系变为：\n$$\\int_0^1 (a_0 \\phi_0(x) + a_1 \\phi_1(x)) \\phi_0(x) dx = -\\varphi \\cdot 0 = 0$$\n我们计算在 $[0,1]$ 上基函数乘积的积分：\n$\\int_0^1 \\phi_0^2(x) dx = \\int_0^1 (1-x)^2 dx = [-\\frac{(1-x)^3}{3}]_0^1 = \\frac{1}{3}$。\n$\\int_0^1 \\phi_0(x)\\phi_1(x) dx = \\int_0^1 (1-x)x dx = [\\frac{x^2}{2} - \\frac{x^3}{3}]_0^1 = \\frac{1}{6}$。\n系数方程变为：$\\frac{1}{3}a_0 + \\frac{1}{6}a_1 = 0$，化简为 $2a_0 + a_1 = 0$。\n\n其次，令 $v_h(x)$ 为 $\\phi_1(x)=x$ (当 $x \\in K^{-}$ 时) 且在其他地方为0。迹为 $v_h(1^{-})=\\phi_1(1)=1$ 和 $v_h(1^{+})=0$。平均值为 $\\{v_h\\}(1) = (1+0)/2 = 1/2$。\n定义关系为：\n$$\\int_0^1 (a_0 \\phi_0(x) + a_1 \\phi_1(x)) \\phi_1(x) dx = -\\varphi \\cdot \\frac{1}{2}$$\n我们需要积分 $\\int_0^1 \\phi_1^2(x) dx = \\int_0^1 x^2 dx = [\\frac{x^3}{3}]_0^1 = \\frac{1}{3}$。\n方程为：$\\frac{1}{6}a_0 + \\frac{1}{3}a_1 = -\\frac{\\varphi}{2}$，化简为 $a_0 + 2a_1 = -3\\varphi$。\n\n我们求解关于 $a_0, a_1$ 的方程组：\n1) $2a_0 + a_1 = 0 \\implies a_1 = -2a_0$\n2) $a_0 + 2a_1 = -3\\varphi$\n将 (1) 代入 (2)：$a_0 + 2(-2a_0) = -3\\varphi \\implies -3a_0 = -3\\varphi \\implies a_0 = \\varphi$。\n则 $a_1 = -2\\varphi$。\n在 $K^{-}$ 上的系数为 $a_0 = c-b$ 和 $a_1 = -2(c-b)$。\n$r_e([u_h])$ 在 $K^{-}$ 上的表达式为：\n$r_e([u_h])(x) = \\varphi(1-x) - 2\\varphi x = \\varphi(1-3x) = (c-b)(1-3x)$，对于 $x \\in [0,1]$。\n\n第三，令 $v_h(x)$ 为 $\\psi_1(x)=2-x$ (当 $x \\in K^{+}$ 时) 且在其他地方为0。迹为 $v_h(1^{-})=0$ 和 $v_h(1^{+})=\\psi_1(1)=1$。平均值为 $\\{v_h\\}(1) = (0+1)/2 = 1/2$。\n定义关系为：\n$$\\int_1^2 (b_1 \\psi_1(x) + b_2 \\psi_2(x)) \\psi_1(x) dx = -\\varphi \\cdot \\frac{1}{2}$$\n在 $[1,2]$ 上的积分可以通过 $\\hat{x}=x-1$ 映射到 $[0,1]$ 上。\n$\\psi_1(x)=2-x=1-(x-1)=\\phi_0(\\hat{x})$ 和 $\\psi_2(x)=x-1=\\phi_1(\\hat{x})$。\n$\\int_1^2 \\psi_1^2 dx = \\int_0^1 \\phi_0^2 d\\hat{x} = 1/3$。\n$\\int_1^2 \\psi_1 \\psi_2 dx = \\int_0^1 \\phi_0 \\phi_1 d\\hat{x} = 1/6$。\n方程为：$\\frac{1}{3}b_1 + \\frac{1}{6}b_2 = -\\frac{\\varphi}{2}$，即 $2b_1 + b_2 = -3\\varphi$。\n\n第四，令 $v_h(x)$ 为 $\\psi_2(x)=x-1$ (当 $x \\in K^{+}$ 时) 且在其他地方为0。迹为 $v_h(1^{-})=0$ 和 $v_h(1^{+})=\\psi_2(1)=0$。平均值为 $\\{v_h\\}(1) = 0$。\n关系为：\n$$\\int_1^2 (b_1 \\psi_1(x) + b_2 \\psi_2(x)) \\psi_2(x) dx = -\\varphi \\cdot 0 = 0$$\n我们需要 $\\int_1^2 \\psi_2^2 dx = \\int_0^1 \\phi_1^2 d\\hat{x} = 1/3$。\n方程为：$\\frac{1}{6}b_1 + \\frac{1}{3}b_2 = 0$，即 $b_1 + 2b_2 = 0$。\n\n我们求解关于 $b_1, b_2$ 的方程组：\n1) $2b_1 + b_2 = -3\\varphi$\n2) $b_1 + 2b_2 = 0 \\implies b_1 = -2b_2$\n将 (2) 代入 (1)：$2(-2b_2) + b_2 = -3\\varphi \\implies -3b_2 = -3\\varphi \\implies b_2 = \\varphi$。\n则 $b_1 = -2\\varphi$。\n在 $K^{+}$ 上的系数为 $b_1 = -2(c-b)$ 和 $b_2 = c-b$。\n$r_e([u_h])$ 在 $K^{+}$ 上的表达式为：\n$r_e([u_h])(x) = -2\\varphi \\psi_1(x) + \\varphi \\psi_2(x) = -2\\varphi(2-x) + \\varphi(x-1) = \\varphi(-4+2x+x-1) = \\varphi(3x-5) = (c-b)(3x-5)$，对于 $x \\in [1,2]$。\n\n现在我们计算 $r_e([u_h])$ 在 $\\Omega=[0,2]$ 上的 $L^2$ 范数。\n$$\\|r_e([u_h])\\|_{L^2(\\Omega)}^2 = \\int_{\\Omega} (r_e([u_h])(x))^2 dx = \\int_0^1 ((c-b)(1-3x))^2 dx + \\int_1^2 ((c-b)(3x-5))^2 dx$$\n$$\\|r_e([u_h])\\|_{L^2(\\Omega)}^2 = (c-b)^2 \\left( \\int_0^1 (1-6x+9x^2) dx + \\int_1^2 (9x^2-30x+25) dx \\right)$$\n第一个积分是：\n$$\\int_0^1 (1-6x+9x^2) dx = \\left[x - 3x^2 + 3x^3\\right]_0^1 = 1-3+3 = 1$$\n第二个积分是：\n$$\\int_1^2 (9x^2-30x+25) dx = \\left[3x^3 - 15x^2 + 25x\\right]_1^2 = (3(8)-15(4)+25(2)) - (3-15+25) = (24-60+50) - (13) = 14-13 = 1$$\n所以，$\\|r_e([u_h])\\|_{L^2(\\Omega)}^2 = (c-b)^2 (1+1) = 2(c-b)^2$。\n开平方根，我们得到 $\\|r_e([u_h])\\|_{L^2(\\Omega)} = \\sqrt{2} |c-b|$。\n\n最后，我们验证稳定性界并确定最小常数 $C$。\n不等式为：\n$$\\|r_e([u_h])\\|_{L^{2}(\\Omega)} \\leq C\\, h_e^{-1/2}\\, \\|[u_h]\\|_{L^{2}(e)}$$\n我们代入已知量：\n- $\\|r_e([u_h])\\|_{L^{2}(\\Omega)} = \\sqrt{2}|c-b|$\n- $h_e=1$，所以 $h_e^{-1/2}=1$。\n- $[u_h] = c-b$。\n- $\\|[u_h]\\|_{L^{2}(e)} = |[u_h]| = |c-b|$。\n\n不等式变为：\n$$\\sqrt{2}|c-b| \\leq C \\cdot 1 \\cdot |c-b|$$\n如果 $c \\neq b$，我们可以在两边同时除以 $|c-b|$：\n$$\\sqrt{2} \\leq C$$\n这个不等式必须对所有可能的 $b$ 和 $c$ 值都成立。如果 $b=c$，不等式为 $0 \\leq 0$，对于任何 $C$ 都平凡成立。为了使不等式对所有的 $b, c$ 都有效，我们必须有 $C \\geq \\sqrt{2}$。因此，常数 $C$ 的最小可能值为 $\\sqrt{2}$。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "跃变和平均算子不仅用于计算，它们还是构建“数值通量”的基本模块，数值通量定义了单元之间的信息交换方式。这些通量的设计至关重要。最后一个练习将探讨伴随一致性（adjoint consistency）这一关键性质，展示一个不恰当的（非对称）通量定义如何破坏原始物理问题的基本对称性，这对方法的精度和稳定性有着深远影响 。",
            "id": "3392011",
            "problem": "考虑定义在区域 $\\Omega = (-1,1)$ 上的一维空间自伴标量扩散算子，由 $-\\frac{d^{2}u}{dx^{2}} = f$ 给出，并带有齐次狄利克雷边界条件。设该区域被剖分为两个单元 $K^{-} = (-1,0)$ 和 $K^{+} = (0,1)$，有一个内部面 $F = \\{0\\}$，其单位外法向量在 $K^{-}$ 上为 $n^{-} = +1$，在 $K^{+}$ 上为 $n^{+} = -1$。在非连续伽辽金 (DG) 方法中，内部面 $F$ 上的迹、跳跃和平均算子定义如下：\n- 迹 $w^{-} = \\lim_{x \\uparrow 0} w(x)$ 和 $w^{+} = \\lim_{x \\downarrow 0} w(x)$，\n- 标量 $w$ 跨越 $F$ 的跳跃为 $[w] = w^{-} n^{-} + w^{+} n^{+}$，\n- 面量 $g$ 的平均为 $\\{g\\} = \\frac{1}{2}(g^{-} + g^{+})$。\n从在每个单元上进行分部积分出发，并应用这些界面算子，考虑带有非对称界面项的扩散问题的内部罚 DG 双线性形式。在单个内部面 $F$ 上，数值通量的特征由面贡献项给出：\n$$\n\\mathcal{F}_{\\theta}(u,v)\\big|_{F} \\equiv - \\langle \\{u'\\}, [v] \\rangle_{F} - \\theta \\langle \\{v'\\}, [u] \\rangle_{F} + \\eta \\langle [u],[v] \\rangle_{F},\n$$\n其中 $\\theta \\in \\mathbb{R}$ 选择对称性（$\\theta = 1$ 对应于对称内部罚选择），$\\eta > 0$ 是一个罚系数，$\\langle \\cdot,\\cdot \\rangle_{F}$ 表示在面 $F$ 上的对偶配对。连续算子是自伴的，因此在离散层面上，一个面上的伴随一致性要求面贡献项在其参数上是对称的。非对称选择（取 $\\theta = -1$）通常会违反这一点。\n\n使用以下分段仿射离散函数，构造一个伴随一致性的具体反例：\n- 在 $K^{-}$ 上定义 $u_{h}(x) = 2 + 1 \\, x$ 和 $\\varphi_{h}(x) = 0 + 2 \\, x$。\n- 在 $K^{+}$ 上定义 $u_{h}(x) = -1 + 3 \\, x$ 和 $\\varphi_{h}(x) = 4 - 2 \\, x$。\n\n仅使用单个内部面 $F$ 和非对称选择 $\\theta = -1$，计算离散伴随残差的面贡献与在精确伴随对称性下应有的值之间的差异，定义为：\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) \\equiv \\mathcal{F}_{-1}(u_{h},\\varphi_{h})\\big|_{F} - \\mathcal{F}_{-1}(\\varphi_{h},u_{h})\\big|_{F}.\n$$\n将 $\\Delta_{F}(u_{h},\\varphi_{h})$ 精确计算为一个实数。无需四舍五入。将你的最终答案表述为一个单独的数字（无单位）。",
            "solution": "用户提供的问题已经过分析并被确定为有效。它在科学上基于非连续伽辽金方法的理论，问题本身是适定的，提供了所有必要的信息，并且陈述客观。因此，我们可以开始求解。\n\n目标是计算量 $\\Delta_{F}(u_{h},\\varphi_{h})$，该量衡量了特定内部罚非连续伽辽金 (DG) 格式伴随对称性的缺失程度。该量定义为：\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) \\equiv \\mathcal{F}_{-1}(u_{h},\\varphi_{h})\\big|_{F} - \\mathcal{F}_{-1}(\\varphi_{h},u_{h})\\big|_{F}\n$$\n面贡献项 $\\mathcal{F}_{\\theta}$ 由下式给出：\n$$\n\\mathcal{F}_{\\theta}(u,v)\\big|_{F} = - \\langle \\{u'\\}, [v] \\rangle_{F} - \\theta \\langle \\{v'\\}, [u] \\rangle_{F} + \\eta \\langle [u],[v] \\rangle_{F}\n$$\n区域是 $\\Omega=(-1,1)$，被剖分为 $K^{-} = (-1,0)$ 和 $K^{+} = (0,1)$，在 $F = \\{0\\}$ 处有一个内部面。此面上的单位外法向量对于单元 $K^{-}$ 是 $n^{-} = +1$，对于单元 $K^{+}$ 是 $n^{+} = -1$。由于面 $F$ 是一个单点，对偶配对 $\\langle a,b \\rangle_{F}$ 简化为在该面处求值的量的标准标量积 $a \\cdot b$。\n\n我们考虑非对称情况，其中 $\\theta = -1$。面贡献变为：\n$$\n\\mathcal{F}_{-1}(u,v)\\big|_{F} = - \\{u'\\} [v] - (-1) \\{v'\\} [u] + \\eta [u][v] = - \\{u'\\} [v] + \\{v'\\} [u] + \\eta [u][v]\n$$\n为了计算 $\\Delta_{F}$，我们首先写出它的两个组成项：\n$$\n\\mathcal{F}_{-1}(u_{h},\\varphi_{h})\\big|_{F} = - \\{u_{h}'\\}[\\varphi_{h}] + \\{\\varphi_{h}'\\}[u_{h}] + \\eta [u_{h}][\\varphi_{h}]\n$$\n$$\n\\mathcal{F}_{-1}(\\varphi_{h},u_{h})\\big|_{F} = - \\{\\varphi_{h}'\\}[u_{h}] + \\{u_{h}'\\}[\\varphi_{h}] + \\eta [\\varphi_{h}][u_{h}]\n$$\n现在，我们计算它们的差。注意罚项是对称的，即 $\\eta [u_{h}][\\varphi_{h}] = \\eta [\\varphi_{h}][u_{h}]$，因此它将被消去。\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = \\left( - \\{u_{h}'\\}[\\varphi_{h}] + \\{\\varphi_{h}'\\}[u_{h}] \\right) - \\left( - \\{\\varphi_{h}'\\}[u_{h}] + \\{u_{h}'\\}[\\varphi_{h}] \\right)\n$$\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = - \\{u_{h}'\\}[\\varphi_{h}] + \\{\\varphi_{h}'\\}[u_{h}] + \\{\\varphi_{h}'\\}[u_{h}] - \\{u_{h}'\\}[\\varphi_{h}]\n$$\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = 2 \\left( \\{\\varphi_{h}'\\}[u_{h}] - \\{u_{h}'\\}[\\varphi_{h}] \\right)\n$$\n为了计算该表达式的值，我们必须计算给定的分段仿射函数 $u_{h}(x)$ 和 $\\varphi_{h}(x)$ 的跳跃量和平均量。\n\n函数及其导数如下：\n对于 $u_h(x)$：\n- 在 $K^{-} = (-1,0)$ 上：$u_{h}(x) = 2 + x$，所以 $u_{h}'(x) = 1$。\n- 在 $K^{+} = (0,1)$ 上：$u_{h}(x) = -1 + 3x$，所以 $u_{h}'(x) = 3$。\n\n对于 $\\varphi_h(x)$：\n- 在 $K^{-} = (-1,0)$ 上：$\\varphi_{h}(x) = 2x$，所以 $\\varphi_{h}'(x) = 2$。\n- 在 $K^{+} = (0,1)$ 上：$\\varphi_{h}(x) = 4 - 2x$，所以 $\\varphi_{h}'(x) = -2$。\n\n接下来，我们计算这些函数及其导数在面 $F=\\{0\\}$ 处从左侧 ($x \\uparrow 0$) 和右侧 ($x \\downarrow 0$) 的迹。\n- $u_h$ 的迹：\n  $u_{h}^{-} = \\lim_{x \\uparrow 0} (2+x) = 2$\n  $u_{h}^{+} = \\lim_{x \\downarrow 0} (-1+3x) = -1$\n- $u_h'$ 的迹：\n  $(u_{h}')^{-} = \\lim_{x \\uparrow 0} (1) = 1$\n  $(u_{h}')^{+} = \\lim_{x \\downarrow 0} (3) = 3$\n- $\\varphi_h$ 的迹：\n  $\\varphi_{h}^{-} = \\lim_{x \\uparrow 0} (2x) = 0$\n  $\\varphi_{h}^{+} = \\lim_{x \\downarrow 0} (4-2x) = 4$\n- $\\varphi_h'$ 的迹：\n  $(\\varphi_{h}')^{-} = \\lim_{x \\uparrow 0} (2) = 2$\n  $(\\varphi_{h}')^{+} = \\lim_{x \\downarrow 0} (-2) = -2$\n\n使用这些迹和法向量 $n^{-} = 1$，$n^{+} = -1$，我们计算所需的跳跃项和平均项。\n- $u_h$ 的跳跃：\n  $[u_{h}] = u_{h}^{-}n^{-} + u_{h}^{+}n^{+} = (2)(1) + (-1)(-1) = 2 + 1 = 3$。\n- $\\varphi_h$ 的跳跃：\n  $[\\varphi_{h}] = \\varphi_{h}^{-}n^{-} + \\varphi_{h}^{+}n^{+} = (0)(1) + (4)(-1) = 0 - 4 = -4$。\n- $u_h'$ 的平均：\n  $\\{u_{h}'\\} = \\frac{1}{2}((u_{h}')^{-} + (u_{h}')^{+}) = \\frac{1}{2}(1 + 3) = \\frac{4}{2} = 2$。\n- $\\varphi_h'$ 的平均：\n  $\\{\\varphi_{h}'\\} = \\frac{1}{2}((\\varphi_{h}')^{-} + (\\varphi_{h}')^{+}) = \\frac{1}{2}(2 + (-2)) = \\frac{0}{2} = 0$。\n\n最后，我们将这些值代入 $\\Delta_{F}(u_{h},\\varphi_{h})$ 的表达式中：\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = 2 \\left( \\{\\varphi_{h}'\\}[u_{h}] - \\{u_{h}'\\}[\\varphi_{h}] \\right)\n$$\n代入计算出的值：$\\{\\varphi_{h}'\\}=0$, $[u_{h}]=3$, $\\{u_{h}'\\}=2$, 和 $[\\varphi_{h}]=-4$：\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = 2 \\left( (0)(3) - (2)(-4) \\right)\n$$\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = 2 \\left( 0 - (-8) \\right)\n$$\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = 2(8)\n$$\n$$\n\\Delta_{F}(u_{h},\\varphi_{h}) = 16\n$$\n差值 $\\Delta_{F}(u_{h},\\varphi_{h})$ 精确为 $16$。这个非零结果明确地证明了选择 $\\theta=-1$ 会导致一个非伴随对称的格式。",
            "answer": "$$\\boxed{16}$$"
        }
    ]
}