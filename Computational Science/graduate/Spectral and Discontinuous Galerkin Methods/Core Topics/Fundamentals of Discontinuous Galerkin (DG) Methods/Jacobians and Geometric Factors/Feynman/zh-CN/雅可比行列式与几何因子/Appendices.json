{
    "hands_on_practices": [
        {
            "introduction": "在谱元法和间断Galerkin方法中，从参考单元到物理单元的坐标变换是所有计算的基础。本练习旨在通过一个具体的二维非线性映射，让您亲手计算雅可比行列式。通过这个计算，您将深入理解雅可比行列式如何量化局部面积的缩放，这是后续进行积分变换和误差分析的关键第一步。",
            "id": "3393863",
            "problem": "在高阶谱元法 (SEM) 和间断 Galerkin (DG) 方法中，物理单元上的积分是通过一个光滑映射将其拉回到参考单元上进行计算的。考虑一个二维参考正方形 $[-1,1]^2$，其坐标为 $(\\xi,\\eta)$，以及一个到物理平面的曲线等参映射 $\\boldsymbol{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)$，定义如下：\n$$\nx(\\xi,\\eta) = \\xi + 0.1\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta) = \\eta + 0.2\\,\\eta^{2}.\n$$\n从第一性原理出发，即曲面积分的变量替换定理和雅可比矩阵作为映射偏导数矩阵的定义，推导此映射的雅可比矩阵行列式 $J(\\xi,\\eta)$。使用你推导出的表达式，计算在点 $(\\xi,\\eta)=(0.5,-0.5)$ 处的 $J(\\xi,\\eta)$ 及其绝对值 $|J(\\xi,\\eta)|$。简要解释该行列式的值，将其作为联系参考空间中无穷小面积元与其在物理空间中像的局部面积缩放因子。将你的最终答案表示为 $|J(0.5,-0.5)|$ 的精确值（不进行四舍五入）。",
            "solution": "该问题要求推导给定映射（从参考单元到物理单元）的雅可比行列式，在特定点处对其进行求值，并解释其几何意义。\n\n从参考坐标 $(\\xi, \\eta)$ 所在的正方形 $[-1,1]^2$ 到物理坐标 $(x,y)$ 的映射由 $\\boldsymbol{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$ 给出，其分量为：\n$$\nx(\\xi,\\eta) = \\xi + 0.1\\,\\xi\\,\\eta\n$$\n$$\ny(\\xi,\\eta) = \\eta + 0.2\\,\\eta^{2}\n$$\n从第一性原理可知，此变换的雅可比矩阵，记为 $\\mathbf{J}(\\xi, \\eta)$，是映射函数所有一阶偏导数构成的矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算每个偏导数：\n1.  $\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\xi + 0.1\\,\\xi\\,\\eta) = 1 + 0.1\\,\\eta$\n2.  $\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\xi + 0.1\\,\\xi\\,\\eta) = 0.1\\,\\xi$\n3.  $\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\eta + 0.2\\,\\eta^{2}) = 0$\n4.  $\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\eta + 0.2\\,\\eta^{2}) = 1 + 0.4\\,\\eta$\n\n将这些偏导数代入矩阵，得到该映射的雅可比矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 1 + 0.1\\,\\eta  0.1\\,\\xi \\\\ 0  1 + 0.4\\,\\eta \\end{pmatrix}\n$$\n雅可比矩阵的行列式，记为 $J(\\xi,\\eta)$，计算如下：\n$$\nJ(\\xi,\\eta) = \\det(\\mathbf{J}(\\xi, \\eta)) = (1 + 0.1\\,\\eta)(1 + 0.4\\,\\eta) - (0.1\\,\\xi)(0)\n$$\n因此，雅可比行列式的表达式为：\n$$\nJ(\\xi,\\eta) = (1 + 0.1\\,\\eta)(1 + 0.4\\,\\eta)\n$$\n接下来，我们在指定点 $(\\xi, \\eta) = (0.5, -0.5)$ 处计算该行列式的值。\n代入 $\\xi = 0.5$ 和 $\\eta = -0.5$：\n$$\nJ(0.5, -0.5) = \\big(1 + 0.1 \\times (-0.5)\\big) \\big(1 + 0.4 \\times (-0.5)\\big)\n$$\n$$\nJ(0.5, -0.5) = (1 - 0.05)(1 - 0.20)\n$$\n$$\nJ(0.5, -0.5) = (0.95)(0.80)\n$$\n为了求得精确值，我们可以使用分数：$0.95 = \\frac{95}{100} = \\frac{19}{20}$ 和 $0.80 = \\frac{80}{100} = \\frac{4}{5}$。\n$$\nJ(0.5, -0.5) = \\left(\\frac{19}{20}\\right) \\left(\\frac{4}{5}\\right) = \\frac{19 \\times 4}{20 \\times 5} = \\frac{19}{5 \\times 5} = \\frac{19}{25}\n$$\n这个精确值也可以表示为小数 $0.76$。\n在该点处雅可比行列式的值为 $J(0.5,-0.5) = 0.76$。\n其绝对值为 $|J(0.5, -0.5)| = |0.76| = 0.76$。\n\n雅可比行列式的解释来自于多重积分的变量替换定理。参考空间中的一个无穷小面积元 $dA_{ref} = d\\xi\\,d\\eta$ 被映射到物理空间中的一个无穷小面积元 $dA_{phys} = dx\\,dy$，它们的面积关系如下：\n$$\ndA_{phys} = |J(\\xi,\\eta)| \\, dA_{ref}\n$$\n因此，值 $|J(\\xi,\\eta)|$ 是局部面积缩放因子。在点 $(\\xi, \\eta) = (0.5, -0.5)$ 处，该值为 $|J| = 0.76$。这意味着参考空间中该点周围的一个无穷小面积被变换到物理空间后，其面积变为原来的 $0.76$ 倍。由于 $|J|  1$，该映射是面积的局部压缩。$J = 0.76$ 的符号为正，这表明该映射在该点是保向的。",
            "answer": "$$\n\\boxed{\\frac{19}{25}}\n$$"
        },
        {
            "introduction": "除了简单的面积缩放，坐标变换还会引入剪切和拉伸，导致网格各向异性。本练习引入了微分几何中的协变基向量和度量张量等更有力的工具来精确描述这种几何变形。您将学习如何计算这些量，并最终导出一个量化映射各向异性程度的因子，这对于评估和控制数值方法的精度至关重要。",
            "id": "3393851",
            "problem": "在高阶谱元法和间断 Galerkin (DG) 方法中，物理单元通过一个光滑映射从具有坐标 $(\\xi,\\eta)$ 的参考单元映射到物理空间坐标 $\\boldsymbol{x}=(x,y)$。考虑由下式定义的二维映射：\n$$\n\\boldsymbol{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big) = \\big(\\,\\xi + \\alpha \\eta^{2},\\ \\eta\\,\\big),\n$$\n其中 $\\alpha \\in \\mathbb{R}$ 是一个给定的常数。请仅使用高阶方法中采用的映射微分几何基本定义，在点 $(\\xi,\\eta)=(0,1)$ 处执行以下操作：\n\n1. 计算协变基向量 $\\boldsymbol{a}_{1}$ 和 $\\boldsymbol{a}_{2}$，其定义为 $\\boldsymbol{a}_{i} = \\partial \\boldsymbol{x} / \\partial \\xi^{i}$，其中 $(\\xi^{1},\\xi^{2})=(\\xi,\\eta)$。\n2. 计算度量张量分量 $g_{ij}$，其定义为 $g_{ij} = \\boldsymbol{a}_{i} \\cdot \\boldsymbol{a}_{j}$。\n3. 计算逆变基向量 $\\boldsymbol{a}^{1}$ 和 $\\boldsymbol{a}^{2}$，其由对偶关系 $\\boldsymbol{a}^{i} \\cdot \\boldsymbol{a}_{j} = \\delta^{i}_{\\ j}$ 定义。\n4. 根据某点映射的各向异性因子定义为该点映射的雅可比矩阵最大奇异值与最小奇异值之比（等效于度量张量谱条件数的平方根），推导各向异性因子作为 $\\alpha$ 函数的精确表达式。\n\n根据您计算出的量，简要解释参数 $\\alpha$ 如何影响指定点的几何各向异性。\n\n请将您获得的各向异性因子作为 $\\alpha$ 函数的精确封闭形式表达式作为最终答案报告。不要四舍五入。不要包含单位。",
            "solution": "该问题陈述经解析和验证，具有科学依据、问题明确且客观。它基于应用于偏微分方程数值方法的微分几何标准定义。所有必要信息均已提供，且该问题在数学上是可解的。我们开始求解。\n\n从参考坐标 $(\\xi, \\eta)$ 到物理坐标 $\\boldsymbol{x}=(x,y)$ 的映射由下式给出：\n$$\n\\boldsymbol{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big) = \\big(\\xi + \\alpha \\eta^{2}, \\eta\\big)\n$$\n其中 $\\alpha \\in \\mathbb{R}$ 是一个常数。我们需要在点 $(\\xi,\\eta)=(0,1)$ 进行计算。\n\n**1. 协变基向量**\n\n协变基向量 $\\boldsymbol{a}_{1}$ 和 $\\boldsymbol{a}_{2}$ 定义为位置向量 $\\boldsymbol{x}$ 关于参考坐标 $\\xi^1 = \\xi$ 和 $\\xi^2 = \\eta$ 的偏导数。\n\n向量 $\\boldsymbol{a}_{1}$ 是：\n$$\n\\boldsymbol{a}_{1} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} = \\left(\\frac{\\partial x}{\\partial \\xi}, \\frac{\\partial y}{\\partial \\xi}\\right) = \\left(\\frac{\\partial}{\\partial \\xi}(\\xi + \\alpha \\eta^2), \\frac{\\partial}{\\partial \\xi}(\\eta)\\right) = (1, 0)\n$$\n该向量在整个域中是恒定的。\n\n向量 $\\boldsymbol{a}_{2}$ 是：\n$$\n\\boldsymbol{a}_{2} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} = \\left(\\frac{\\partial x}{\\partial \\eta}, \\frac{\\partial y}{\\partial \\eta}\\right) = \\left(\\frac{\\partial}{\\partial \\eta}(\\xi + \\alpha \\eta^2), \\frac{\\partial}{\\partial \\eta}(\\eta)\\right) = (2\\alpha\\eta, 1)\n$$\n在指定点 $(\\xi, \\eta) = (0, 1)$ 处计算这些向量：\n$$\n\\boldsymbol{a}_{1}|_{(0,1)} = (1, 0)\n$$\n$$\n\\boldsymbol{a}_{2}|_{(0,1)} = (2\\alpha(1), 1) = (2\\alpha, 1)\n$$\n\n**2. 度量张量分量**\n\n协变度量张量的分量 $g_{ij}$ 由协变基向量的点积定义：$g_{ij} = \\boldsymbol{a}_{i} \\cdot \\boldsymbol{a}_{j}$。在点 $(0,1)$ 处：\n\n$$\ng_{11} = \\boldsymbol{a}_{1} \\cdot \\boldsymbol{a}_{1} = (1, 0) \\cdot (1, 0) = 1^2 + 0^2 = 1\n$$\n$$\ng_{12} = \\boldsymbol{a}_{1} \\cdot \\boldsymbol{a}_{2} = (1, 0) \\cdot (2\\alpha, 1) = (1)(2\\alpha) + (0)(1) = 2\\alpha\n$$\n$$\ng_{21} = \\boldsymbol{a}_{2} \\cdot \\boldsymbol{a}_{1} = (2\\alpha, 1) \\cdot (1, 0) = (2\\alpha)(1) + (1)(0) = 2\\alpha\n$$\n$$\ng_{22} = \\boldsymbol{a}_{2} \\cdot \\boldsymbol{a}_{2} = (2\\alpha, 1) \\cdot (2\\alpha, 1) = (2\\alpha)^2 + 1^2 = 4\\alpha^2 + 1\n$$\n在 $(\\xi, \\eta) = (0,1)$ 处的度量张量 $G$ 是以 $g_{ij}$ 为分量的矩阵：\n$$\nG = \\begin{pmatrix} g_{11}  g_{12} \\\\ g_{21}  g_{22} \\end{pmatrix} = \\begin{pmatrix} 1  2\\alpha \\\\ 2\\alpha  4\\alpha^2 + 1 \\end{pmatrix}\n$$\n\n**3. 逆变基向量**\n\n逆变基向量 $\\boldsymbol{a}^{1}$ 和 $\\boldsymbol{a}^{2}$ 由对偶关系 $\\boldsymbol{a}^{i} \\cdot \\boldsymbol{a}_{j} = \\delta^{i}_{\\ j}$ 定义，其中 $\\delta^{i}_{\\ j}$ 是克罗内克 δ 符号。它们可以使用逆变度量张量 $g^{ij}$ 的分量来计算，这些分量是矩阵 $G$ 的逆矩阵的元素。\n首先，我们计算 $G$ 的行列式：\n$$\n\\det(G) = g_{11}g_{22} - g_{12}g_{21} = (1)(4\\alpha^2 + 1) - (2\\alpha)(2\\alpha) = 4\\alpha^2 + 1 - 4\\alpha^2 = 1\n$$\n逆矩阵 $G^{-1} = [g^{ij}]$ 是：\n$$\nG^{-1} = \\frac{1}{\\det(G)} \\begin{pmatrix} g_{22}  -g_{12} \\\\ -g_{21}  g_{11} \\end{pmatrix} = \\frac{1}{1} \\begin{pmatrix} 4\\alpha^2 + 1  -2\\alpha \\\\ -2\\alpha  1 \\end{pmatrix} = \\begin{pmatrix} 4\\alpha^2 + 1  -2\\alpha \\\\ -2\\alpha  1 \\end{pmatrix}\n$$\n逆变基向量与协变基向量的关系为 $\\boldsymbol{a}^i = \\sum_{j=1}^2 g^{ij}\\boldsymbol{a}_j$：\n$$\n\\boldsymbol{a}^{1} = g^{11}\\boldsymbol{a}_{1} + g^{12}\\boldsymbol{a}_{2} = (4\\alpha^2+1)(1,0) + (-2\\alpha)(2\\alpha,1) = (4\\alpha^2+1-4\\alpha^2, -2\\alpha) = (1, -2\\alpha)\n$$\n$$\n\\boldsymbol{a}^{2} = g^{21}\\boldsymbol{a}_{1} + g^{22}\\boldsymbol{a}_{2} = (-2\\alpha)(1,0) + (1)(2\\alpha,1) = (-2\\alpha+2\\alpha, 1) = (0, 1)\n$$\n\n**4. 各向异性因子**\n\n各向异性因子定义为映射雅可比矩阵的最大奇异值与最小奇异值之比，即 $\\sigma_{\\max}/\\sigma_{\\min}$。这等效于度量张量 $G=J^T J$（其中 $J$ 是雅可比矩阵）谱条件数的平方根。谱条件数为 $\\kappa_2(G) = \\lambda_{\\max}/\\lambda_{\\min}$，其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 是 $G$ 的最大和最小特征值。因此，各向异性因子是 $\\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$。\n\n$G$ 的特征值 $\\lambda$ 是特征方程 $\\det(G - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} 1-\\lambda  2\\alpha \\\\ 2\\alpha  4\\alpha^2 + 1 - \\lambda \\end{pmatrix} = (1-\\lambda)(4\\alpha^2 + 1 - \\lambda) - (2\\alpha)^2 = 0\n$$\n$$\n\\lambda^2 - (4\\alpha^2 + 2)\\lambda + (4\\alpha^2 + 1) - 4\\alpha^2 = 0\n$$\n$$\n\\lambda^2 - (4\\alpha^2 + 2)\\lambda + 1 = 0\n$$\n使用二次公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{(4\\alpha^2 + 2) \\pm \\sqrt{(4\\alpha^2 + 2)^2 - 4(1)(1)}}{2}\n$$\n$$\n\\lambda = \\frac{4\\alpha^2 + 2 \\pm \\sqrt{16\\alpha^4 + 16\\alpha^2 + 4 - 4}}{2} = \\frac{4\\alpha^2 + 2 \\pm \\sqrt{16\\alpha^4 + 16\\alpha^2}}{2}\n$$\n$$\n\\lambda = \\frac{4\\alpha^2 + 2 \\pm \\sqrt{16\\alpha^2(\\alpha^2 + 1)}}{2} = \\frac{4\\alpha^2 + 2 \\pm 4|\\alpha|\\sqrt{\\alpha^2+1}}{2}\n$$\n两个特征值是：\n$$\n\\lambda_{\\max} = 2\\alpha^2 + 1 + 2|\\alpha|\\sqrt{\\alpha^2+1}\n$$\n$$\n\\lambda_{\\min} = 2\\alpha^2 + 1 - 2|\\alpha|\\sqrt{\\alpha^2+1}\n$$\n我们注意到特征值的乘积为 $\\lambda_{\\max}\\lambda_{\\min} = \\frac{c}{a} = 1$。这与我们之前发现的 $\\det(G)=1$ 是一致的，因为行列式是特征值的乘积。\n\n各向异性因子是 $\\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$。由于 $\\lambda_{\\min} = 1/\\lambda_{\\max}$，我们可以简化这个表达式：\n$$\n\\text{各向异性因子} = \\sqrt{\\frac{\\lambda_{\\max}}{1/\\lambda_{\\max}}} = \\sqrt{\\lambda_{\\max}^2} = \\lambda_{\\max}\n$$\n（我们取正根，因为正定矩阵 $G$ 的特征值是正的，因此 $\\lambda_{\\max}  0$）。\n所以，各向异性因子作为 $\\alpha$ 函数的精确表达式是：\n$$\n\\text{各向异性因子} = 2\\alpha^2 + 1 + 2|\\alpha|\\sqrt{\\alpha^2+1}\n$$\n\n**解释：**\n参数 $\\alpha$ 控制映射中的剪切。当 $\\alpha=0$ 时，映射为恒等映射，协变基向量 $\\boldsymbol{a}_1=(1,0)$ 和 $\\boldsymbol{a}_2=(0,1)$ 正交且长度为单位1，度量张量为单位矩阵，各向异性因子为 $2(0)^2+1+0 = 1$。因子为 $1$ 表示这是一个没有扭曲的各向同性映射。随着 $|\\alpha|$ 的增加，基向量 $\\boldsymbol{a}_1$ 和 $\\boldsymbol{a}_2=(2\\alpha,1)$ 之间的夹角偏离 $90^\\circ$，且 $\\boldsymbol{a}_2$ 的长度增加。这种几何扭曲由各向异性因子量化，该因子随 $|\\alpha|$ 单调增加。大的各向异性因子表示单元高度扭曲，这会降低数值模拟的准确性和稳定性。",
            "answer": "$$\n\\boxed{2\\alpha^2 + 1 + 2|\\alpha|\\sqrt{\\alpha^2+1}}\n$$"
        },
        {
            "introduction": "将连续的几何关系离散化到计算网格上会带来新的挑战，其中最关键的便是几何守恒律（GCL）。本练习将揭示当离散几何因子不满足离散GCL时所产生的严重后果。通过构建一个不满足守恒律的离散度量，您将分析并计算出一个常数解（自由流）如何产生了非零的伪残差，从而深刻体会到在求解守恒律方程时，对几何因子进行保守离散化的极端重要性。",
            "id": "3393877",
            "problem": "考虑在参考正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 上的二维节点谱元离散化，其多项式次数为 $N=2$，采用张量积高斯-洛巴托-勒让德 (GLL) 网格。每个坐标方向上的节点为 $s \\in \\{-1,0,1\\}$ 和 $r \\in \\{-1,0,1\\}$，对应的一维 GLL 微分矩阵为\n$$\nD \\;=\\;\n\\begin{pmatrix}\n-\\tfrac{3}{2}  2  -\\tfrac{1}{2}\\\n\\\\$$4pt]\n-\\tfrac{1}{2}  0  \\tfrac{1}{2}\\\n\\\\$$4pt]\n\\tfrac{1}{2}  -2  \\tfrac{3}{2}\n\\end{pmatrix}.\n$$\n设从参考坐标 $(r,s)$ 到物理坐标 $(x,y)$ 的曲线映射为\n$$\nx(r,s) \\;=\\; r \\;+\\; r\\,s^{2}, \n\\qquad\ny(r,s) \\;=\\; s.\n$$\n采用标准协变基向量 $\\mathbf{a}_{r} = \\partial \\mathbf{x}/\\partial r$ 和 $\\mathbf{a}_{s} = \\partial \\mathbf{x}/\\partial s$，雅可比行列式 $J = \\det[\\mathbf{a}_{r}\\ \\mathbf{a}_{s}]$，以及由协变基向量的平面 $90^{\\circ}$ 旋转定义的逆变度量向量 $J\\,\\mathbf{a}^{r}$ 和 $J\\,\\mathbf{a}^{s}$：\n$$\nJ\\,\\mathbf{a}^{r} \\;=\\; \\big(a_{s,y},\\,-a_{s,x}\\big),\n\\qquad\nJ\\,\\mathbf{a}^{s} \\;=\\; \\big(-a_{r,y},\\,a_{r,x}\\big),\n$$\n其中 $\\mathbf{a}_{r}=(a_{r,x},a_{r,y})$ 且 $\\mathbf{a}_{s}=(a_{s,x},a_{s,y})$。对于此映射，逆变度量向量的精确 $y$ 分量为\n$$\nG^{r}_{y}(r,s) \\;=\\; -\\,2\\,r\\,s,\n\\qquad\nG^{s}_{y}(r,s) \\;=\\; 1 \\;+\\; s^{2}.\n$$\n它们满足连续度量恒等式 $\\partial_{r} G^{r}_{y} + \\partial_{s} G^{s}_{y} = 0$。\n\n现在通过在 $s$ 方向上仅使用端点节点 $s=\\pm 1$ 进行一次插值来定义 $J\\,\\mathbf{a}^{s}$ 的 $y$ 分量，从而构建一个违反度量恒等式的离散度量近似：\n$$\n\\tilde{G}^{s}_{y}(r,s) \\;:=\\; I_{1}\\big[\\,1+s^{2}\\,\\big](s)\n\\;=\\; \\tfrac{1+s}{2}\\big(1+1^{2}\\big) \\;+\\; \\tfrac{1-s}{2}\\big(1+(-1)^{2}\\big)\n\\;=\\; 2,\n$$\n使得 $\\tilde{G}^{s}_{y}$ 在 $s$ 方向上是常数。在节点处保持 $G^{r}_{y}$ 的精确性。\n\n考虑具有恒定物理平流速度 $\\mathbf{a}=(0,1)$ 的常数解 $u(r,s)\\equiv u_{0}$ 的映射线性平流问题。在强形式下，节点 $(r_{i},s_{j})$ 处的半离散体积残差是通过将张量积微分算子应用于映射后的逆变通量分量来计算的\n$$\n\\phi^{r}(r_{i},s_{j}) \\;=\\; u_{0}\\,G^{r}_{y}(r_{i},s_{j}), \n\\qquad\n\\phi^{s}(r_{i},s_{j}) \\;=\\; u_{0}\\,\\tilde{G}^{s}_{y}(r_{i},s_{j}),\n$$\n即\n$$\n\\mathcal{R}_{ij} \\;=\\; \\sum_{k=1}^{3} D_{ik}\\,\\phi^{r}(r_{k},s_{j}) \\;+\\; \\sum_{\\ell=1}^{3} D_{j\\ell}\\,\\phi^{s}(r_{i},s_{\\ell}).\n$$\n\n使用 $u_{0}=1$，计算节点 $(r_{i},s_{j})=(0,1)$ 处的半离散体积残差 $\\mathcal{R}_{ij}$。将最终答案表示为单个实数，无需四舍五入。",
            "solution": "该问题是有效的。问题设定是自洽的，在偏微分方程数值分析领域内是科学合理的，并且是适定的。计算所需的所有数据和定义均已提供。\n\n目标是计算节点 $(r_{i},s_{j})=(0,1)$ 处的半离散体积残差 $\\mathcal{R}_{ij}$。对于多项式次数 $N=2$，节点网格点为 $r, s \\in \\{-1, 0, 1\\}$。我们可以将其索引为 $r_1=-1$, $r_2=0$, $r_3=1$ 和 $s_1=-1$, $s_2=0$, $s_3=1$。因此，目标节点 $(r,s)=(0,1)$ 对应于索引 $(i,j)=(2,3)$。\n\n节点 $(r_i, s_j)$ 处的半离散体积残差的公式由下式给出：\n$$\n\\mathcal{R}_{ij} \\;=\\; \\sum_{k=1}^{3} D_{ik}\\,\\phi^{r}(r_{k},s_{j}) \\;+\\; \\sum_{\\ell=1}^{3} D_{j\\ell}\\,\\phi^{s}(r_{i},s_{\\ell})\n$$\n我们需要对 $(i,j)=(2,3)$ 计算该式：\n$$\n\\mathcal{R}_{23} \\;=\\; \\sum_{k=1}^{3} D_{2k}\\,\\phi^{r}(r_{k},s_{3}) \\;+\\; \\sum_{\\ell=1}^{3} D_{3\\ell}\\,\\phi^{s}(r_{2},s_{\\ell})\n$$\n计算分为两部分。\n\n**第1部分：$r$ 方向上的导数。**\n这一项是第一个求和：$\\sum_{k=1}^{3} D_{2k}\\,\\phi^{r}(r_{k},s_{3})$。这对应于将微分矩阵 $D$ 的第二行应用于在 $s=s_3=1$ 这条线上计算得到的通量值 $\\phi^r$ 向量。\n微分矩阵 $D$ 的第二行由 $(D_{21}, D_{22}, D_{23}) = (-\\frac{1}{2}, 0, \\frac{1}{2})$ 给出。\n逆变通量分量 $\\phi^r$ 定义为 $\\phi^{r}(r,s) = u_{0}\\,G^{r}_{y}(r,s)$。当 $u_0=1$ 且精确度量分量为 $G^{r}_{y}(r,s) = -2rs$ 时，通量变为 $\\phi^{r}(r,s) = -2rs$。\n我们计算在 $s_j=s_3=1$ 处的通量值，代入 $r_k \\in \\{-1, 0, 1\\}$：\n*   $\\phi^{r}(r_1,s_3) = \\phi^{r}(-1,1) = -2(-1)(1) = 2$\n*   $\\phi^{r}(r_2,s_3) = \\phi^{r}(0,1) = -2(0)(1) = 0$\n*   $\\phi^{r}(r_3,s_3) = \\phi^{r}(1,1) = -2(1)(1) = -2$\n\n因此，第一项为：\n$$\n\\sum_{k=1}^{3} D_{2k}\\,\\phi^{r}(r_{k},s_{3}) = D_{21}\\phi^{r}(r_1,s_3) + D_{22}\\phi^{r}(r_2,s_3) + D_{23}\\phi^{r}(r_3,s_3) = (-\\tfrac{1}{2})(2) + (0)(0) + (\\tfrac{1}{2})(-2) = -1 - 1 = -2.\n$$\n\n**第2部分：$s$ 方向上的导数。**\n这一项是第二个求和：$\\sum_{\\ell=1}^{3} D_{3\\ell}\\,\\phi^{s}(r_{2},s_{\\ell})$。这对应于将微分矩阵 $D$ 的第三行应用于在 $r=r_2=0$ 这条线上计算得到的通量值 $\\phi^s$ 向量。\n微分矩阵 $D$ 的第三行由 $(D_{31}, D_{32}, D_{33}) = (\\frac{1}{2}, -2, \\frac{3}{2})$ 给出。\n不精确的逆变通量分量 $\\phi^s$ 定义为 $\\phi^{s}(r,s) = u_{0}\\,\\tilde{G}^{s}_{y}(r,s)$。当 $u_0=1$ 且 $\\tilde{G}^{s}_{y}(r,s)=2$ 时，通量为常数 $\\phi^{s}(r,s) = 2$。\n因此，在 $r_i=r_2=0$ 处，通量值对于所有 $s_\\ell$ 都是2：\n*   $\\phi^{s}(r_2,s_1) = 2$\n*   $\\phi^{s}(r_2,s_2) = 2$\n*   $\\phi^{s}(r_2,s_3) = 2$\n\n第二项为：\n$$\n\\sum_{\\ell=1}^{3} D_{3\\ell}\\,\\phi^{s}(r_{2},s_{\\ell}) = (\\tfrac{1}{2})(2) + (-2)(2) + (\\tfrac{3}{2})(2) = 1 - 4 + 3 = 0.\n$$\n这个结果是预料之中的，因为微分矩阵作用于常数向量应得到零（对于$N \\ge 1$的多项式空间，微分算子是精确的，而常数的导数为零）。\n\n将两部分相加，得到最终的残差：\n$$\n\\mathcal{R}_{23} = (-2) + 0 = -2.\n$$\n这个非零残差是直接由于离散几何因子 ($\\tilde{G}^{s}_{y}$) 未能满足离散几何守恒律（即，离散散度不为零）而产生的。它错误地为常数解（自由流）产生了一个伪源项，这在物理上是不正确的。",
            "answer": "$$\\boxed{-2}$$"
        }
    ]
}