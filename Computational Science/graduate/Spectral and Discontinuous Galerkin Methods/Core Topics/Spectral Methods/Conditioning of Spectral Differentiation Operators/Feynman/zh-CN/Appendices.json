{
    "hands_on_practices": [
        {
            "introduction": "谱微分矩阵 $D$ 可以通过一个模态基底和相关的范德蒙矩阵 $V$ 来构建，其关系为 $D = V_x V^{-1}$。这个练习旨在揭示，虽然 $D$ 本身是唯一的，但其计算的数值稳定性在很大程度上取决于 $V$ 的条件数。通过比较一个条件恶劣的基底（单项式）和一个条件良好的基底（正交勒让德多项式），我们将亲身体验基底选择对数值稳定性的关键影响 。",
            "id": "3372519",
            "problem": "考虑在区间 $[-1,1]$ 上的谱配置法，使用 $3$ 个不同的插值节点 $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$。设 $\\{\\psi_{0}(x),\\psi_{1}(x),\\psi_{2}(x)\\}$ 为一个模态基，定义范德蒙矩阵 $V \\in \\mathbb{R}^{3 \\times 3}$ 及其对应的导数求值矩阵 $V_{x} \\in \\mathbb{R}^{3 \\times 3}$ 为 $(V)_{ij}=\\psi_{j}(x_{i})$ 和 $(V_{x})_{ij}=\\psi_{j}'(x_{i})$，其中 $i,j \\in \\{0,1,2\\}$。对于任意二次多项式 $u(x)$，定义节点微分算子 $D \\in \\mathbb{R}^{3 \\times 3}$，其满足要求 $u'(x_{i})=\\sum_{j=0}^{2} D_{ij} u(x_{j})$，其中 $i \\in \\{0,1,2\\}$。仅从多项式插值的唯一性和这些求值矩阵的定义出发，推导出用 $V$ 和 $V_{x}$ 表示的 $D$，并确定模态基的列向缩放是否使 $D$ 保持不变。\n\n现在考虑两个特定的模态基：\n- 单项式基 $\\{\\psi_{0}(x)=1,\\ \\psi_{1}(x)=x,\\ \\psi_{2}(x)=x^{2}\\}$。\n- 在 $[-1,1]$ 上 $L^2$-正交归一的 Legendre 基 $\\{\\phi_{0},\\phi_{1},\\phi_{2}\\}$，由 $\\phi_{n}(x)=\\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ 给出，其中 $P_{n}(x)$ 是 $[-1,1]$ 上的 $n$ 次 Legendre 多项式。\n\n对于每个基，构建在节点 $x_{0},x_{1},x_{2}$ 处的相应范德蒙矩阵，并计算其欧几里得 $2$-范数条件数 $\\kappa_{2}(V)=\\sigma_{\\max}(V)/\\sigma_{\\min}(V)$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是由奇异值分解（SVD）定义的最大和最小奇异值。仅使用多项式插值和线性代数的基本原理，求出这些条件数的精确闭式表达式。然后计算比值的精确闭式表达式\n$$\nR \\;=\\; \\frac{\\kappa_{2}\\big(V_{\\mathrm{mono}}\\big)}{\\kappa_{2}\\big(V_{\\mathrm{orth}}\\big)} \\, .\n$$\n你的最终答案必须是这个关于 $R$ 的单一表达式。不要近似；不要四舍五入。以闭式形式表示最终答案。",
            "solution": "我们从插值和线性代数的基本原理出发。对于任意二次多项式 $u(x)$，在所选的模态基 $\\{\\psi_{0},\\psi_{1},\\psi_{2}\\}$ 中，存在一个唯一的系数向量 $a \\in \\mathbb{R}^{3}$，使得\n$$\nu(x) \\;=\\; \\sum_{j=0}^{2} a_{j}\\,\\psi_{j}(x).\n$$\n在节点处求值，得到节点值向量 $u \\in \\mathbb{R}^{3}$，其分量为 $u_{i}=u(x_{i})$。根据范德蒙矩阵的定义，这可以写作\n$$\nu \\;=\\; V\\,a.\n$$\n对多项式求导并在节点处求值，得到 $u'(x_{i})=\\sum_{j=0}^{2} a_{j}\\,\\psi_{j}'(x_{i})$，因此节点导数向量满足\n$$\nu' \\;=\\; V_{x}\\,a.\n$$\n由于对于不同的节点和一组基，$V$ 是非奇异的，我们有 $a=V^{-1}u$。将其代入导数关系式中，得到\n$$\nu' \\;=\\; V_{x}\\,V^{-1}\\,u.\n$$\n根据节点微分算子 $D$ 的定义，即对于所有二次多项式 $u$ 都有 $u'=D\\,u$，我们得出结论\n$$\nD \\;=\\; V_{x}\\,V^{-1}.\n$$\n现在考虑模态基的列向缩放。设 $\\tilde{\\psi}_{j}(x)=s_{j}\\,\\psi_{j}(x)$，其中 $s_{j}$ 为非零标量，并定义对角矩阵 $S=\\mathrm{diag}(s_{0},s_{1},s_{2})$。那么新的矩阵满足 $\\tilde{V}=V\\,S$ 和 $\\tilde{V}_{x}=V_{x}\\,S$。相应的节点微分算子是\n$$\n\\tilde{D} \\;=\\; \\tilde{V}_{x}\\,\\tilde{V}^{-1} \\;=\\; V_{x}\\,S\\,(S^{-1}V^{-1}) \\;=\\; V_{x}\\,V^{-1} \\;=\\; D.\n$$\n因此，列向缩放（包括 $L^2$-正交归一化）使 $D$ 保持不变。然而，在这种缩放下，$V$ 的条件数通常会发生变化。\n\n我们现在具体到给定的两个基，在节点 $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$ 处进行计算。\n\n单项式基。当 $\\psi_{0}(x)=1$, $\\psi_{1}(x)=x$, $\\psi_{2}(x)=x^{2}$ 时，范德蒙矩阵是\n$$\nV_{\\mathrm{mono}} \\;=\\;\n\\begin{pmatrix}\n\\psi_{0}(-1)  \\psi_{1}(-1)  \\psi_{2}(-1) \\\\\n\\psi_{0}(0)  \\psi_{1}(0)  \\psi_{2}(0) \\\\\n\\psi_{0}(1)  \\psi_{1}(1)  \\psi_{2}(1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1  -1  1 \\\\\n1  0  0 \\\\\n1  1  1\n\\end{pmatrix}.\n$$\n$V_{\\mathrm{mono}}$ 的奇异值是 $V_{\\mathrm{mono}}^{\\top}V_{\\mathrm{mono}}$ 的特征值的平方根。计算\n$$\nV_{\\mathrm{mono}}^{\\top}V_{\\mathrm{mono}} \\;=\\;\n\\begin{pmatrix}\n3  0  2 \\\\\n0  2  0 \\\\\n2  0  2\n\\end{pmatrix}.\n$$\n这个对称矩阵有一个解耦的中间坐标，其特征值为 $\\lambda_{2}=2$；在索引 $\\{1,3\\}$ 上有一个 $2\\times 2$ 的子块，等于 $\\begin{pmatrix}3  2 \\\\ 2  2\\end{pmatrix}$，其特征值是以下方程的解\n$$\n\\lambda^{2} - 5\\lambda + 2 \\;=\\; 0,\n$$\n所以 $\\lambda_{\\pm}=\\frac{5 \\pm \\sqrt{17}}{2}$。因此，$V_{\\mathrm{mono}}^{\\top}V_{\\mathrm{mono}}$ 的特征值为 $\\left\\{\\frac{5+\\sqrt{17}}{2},\\,2,\\,\\frac{5-\\sqrt{17}}{2}\\right\\}$，欧几里得 $2$-范数条件数为\n$$\n\\kappa_{2}\\big(V_{\\mathrm{mono}}\\big) \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}\n\\;=\\; \\sqrt{\\frac{\\frac{5+\\sqrt{17}}{2}}{\\frac{5-\\sqrt{17}}{2}}}\n\\;=\\; \\sqrt{\\frac{5+\\sqrt{17}}{5-\\sqrt{17}}}.\n$$\n\n在 $[-1,1]$ 上 $L^2$-正交归一的 Legendre 基。当 $\\phi_{n}(x)=\\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ 时，我们在 $x \\in \\{-1,0,1\\}$ 处求值。使用 $P_{0}(x)=1$, $P_{1}(x)=x$, $P_{2}(x)=\\frac{1}{2}(3x^{2}-1)$，我们有\n$$\n\\phi_{0}(x)=\\sqrt{\\frac{1}{2}}\\cdot 1,\\quad\n\\phi_{1}(x)=\\sqrt{\\frac{3}{2}}\\cdot x,\\quad\n\\phi_{2}(x)=\\sqrt{\\frac{5}{2}}\\cdot \\frac{1}{2}(3x^{2}-1).\n$$\n因此\n$$\nV_{\\mathrm{orth}} \\;=\\;\n\\begin{pmatrix}\n\\phi_{0}(-1)  \\phi_{1}(-1)  \\phi_{2}(-1) \\\\\n\\phi_{0}(0)  \\phi_{1}(0)  \\phi_{2}(0) \\\\\n\\phi_{0}(1)  \\phi_{1}(1)  \\phi_{2}(1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sqrt{\\frac{1}{2}}  -\\sqrt{\\frac{3}{2}}  \\sqrt{\\frac{5}{2}} \\\\\n\\sqrt{\\frac{1}{2}}  0  -\\sqrt{\\frac{5}{2}}\\cdot \\frac{1}{2} \\\\\n\\sqrt{\\frac{1}{2}}  \\sqrt{\\frac{3}{2}}  \\sqrt{\\frac{5}{2}}\n\\end{pmatrix}.\n$$\n通过列向量内积计算 $V_{\\mathrm{orth}}^{\\top}V_{\\mathrm{orth}}$。设列向量为 $c_{1}$, $c_{2}$, $c_{3}$。那么\n$$\nc_{1}\\cdot c_{1} \\;=\\; \\frac{3}{2},\\quad\nc_{2}\\cdot c_{2} \\;=\\; 3,\\quad\nc_{3}\\cdot c_{3} \\;=\\; \\frac{45}{8},\\quad\nc_{1}\\cdot c_{2} \\;=\\; 0,\\quad\nc_{2}\\cdot c_{3} \\;=\\; 0,\\quad\nc_{1}\\cdot c_{3} \\;=\\; \\frac{3\\sqrt{5}}{4}.\n$$\n因此\n$$\nV_{\\mathrm{orth}}^{\\top}V_{\\mathrm{orth}} \\;=\\;\n\\begin{pmatrix}\n\\frac{3}{2}  0  \\frac{3\\sqrt{5}}{4} \\\\\n0  3  0 \\\\\n\\frac{3\\sqrt{5}}{4}  0  \\frac{45}{8}\n\\end{pmatrix}.\n$$\n同样，中间坐标解耦，特征值为 $\\lambda_{2}=3$。在索引 $\\{1,3\\}$ 上的 $2\\times 2$ 子块为 $\\begin{pmatrix}\\frac{3}{2}  \\frac{3\\sqrt{5}}{4} \\\\ \\frac{3\\sqrt{5}}{4}  \\frac{45}{8}\\end{pmatrix}$，其迹为\n$$\nt \\;=\\; \\frac{3}{2}+\\frac{45}{8} \\;=\\; \\frac{57}{8},\n$$\n行列式为\n$$\n\\det \\;=\\; \\frac{3}{2}\\cdot \\frac{45}{8} - \\left(\\frac{3\\sqrt{5}}{4}\\right)^{2}\n\\;=\\; \\frac{135}{16} - \\frac{45}{16} \\;=\\; \\frac{45}{8}.\n$$\n因此，这个子块的两个特征值是\n$$\n\\lambda_{\\pm} \\;=\\; \\frac{t \\pm \\sqrt{t^{2}-4\\det}}{2}\n\\;=\\; \\frac{\\frac{57}{8} \\pm \\sqrt{\\frac{57^{2}}{64} - \\frac{4\\cdot 45}{8}}}{2}\n\\;=\\; \\frac{\\frac{57}{8} \\pm \\frac{\\sqrt{1809}}{8}}{2}\n\\;=\\; \\frac{57 \\pm \\sqrt{1809}}{16}.\n$$\n因此，$V_{\\mathrm{orth}}^{\\top}V_{\\mathrm{orth}}$ 的特征值为 $\\left\\{\\frac{57+\\sqrt{1809}}{16},\\,3,\\,\\frac{57-\\sqrt{1809}}{16}\\right\\}$，欧几里得 $2$-范数条件数为\n$$\n\\kappa_{2}\\big(V_{\\mathrm{orth}}\\big) \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}\n\\;=\\; \\sqrt{\\frac{\\frac{57+\\sqrt{1809}}{16}}{\\frac{57-\\sqrt{1809}}{16}}}\n\\;=\\; \\sqrt{\\frac{57+\\sqrt{1809}}{57-\\sqrt{1809}}}.\n$$\n\n最后，所求的比值为\n$$\nR \\;=\\; \\frac{\\kappa_{2}\\big(V_{\\mathrm{mono}}\\big)}{\\kappa_{2}\\big(V_{\\mathrm{orth}}\\big)}\n\\;=\\; \\sqrt{\\frac{\\frac{5+\\sqrt{17}}{5-\\sqrt{17}}}{\\frac{57+\\sqrt{1809}}{57-\\sqrt{1809}}}}\n\\;=\\; \\sqrt{\\frac{(5+\\sqrt{17})(57-\\sqrt{1809})}{(5-\\sqrt{17})(57+\\sqrt{1809})}}.\n$$\n该计算表明，$L^2$-正交归一化以一种方式重新缩放了 $V$ 的列，从而减小了这些节点上 $\\kappa_{2}(V)$ 的值，同时保持了精确的节点微分算子 $D$ 不变，从而减轻了因通过涉及病态矩阵 $V$ 的运算来构造 $D$ 而可能引起的数值恶化。",
            "answer": "$$\\boxed{\\sqrt{\\frac{(5+\\sqrt{17})(57-\\sqrt{1809})}{(5-\\sqrt{17})(57+\\sqrt{1809})}}}$$"
        },
        {
            "introduction": "在构建了微分算子之后，我们现在研究它的内在性质，特别是其条件数如何随着分辨率（多项式阶数 $N$）的增加而变化。本练习通过分析微分算子对低频和高频模式的不同放大作用，推导出切比雪夫微分矩阵条件数著名的 $O(N^2)$ 缩放规律 。这个结果揭示了高阶谱方法为何对数值误差敏感，并为理解其收敛性和稳定性提供了理论基础。",
            "id": "3372568",
            "problem": "考虑由 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$（其中 $j \\in \\{0,1,\\dots,N\\}$）定义的 Chebyshev-Gauss-Lobatto 网格，并令 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 表示通过对构建在 $\\{x_j\\}$ 上的 $N$ 次 Lagrange 插值多项式求导而获得的谱微分矩阵。令 $\\omega_j$ 表示任意一组求积权重，该组权重能够对与 Chebyshev 权重 $w(x) = \\frac{1}{\\sqrt{1-x^2}}$ 相关联的加权 $L^2$ 内积给出谱精确的离散近似，即对于足够光滑的 $f$，有 $\\sum_{j=0}^{N} \\omega_j f(x_j) \\approx \\int_{-1}^{1} \\frac{f(x)}{\\sqrt{1-x^2}}\\,dx$，其误差的衰减速度快于 $N$ 的任何次幂。对于向量 $v \\in \\mathbb{R}^{N+1}$，定义离散加权 $\\ell^2$ 范数为 $\\|v\\|_{2,w} = \\left(\\sum_{j=0}^{N} \\omega_j |v_j|^2\\right)^{1/2}$，并定义零均值子空间\n$$\n\\mathcal{M} = \\left\\{ v \\in \\mathbb{R}^{N+1} : \\sum_{j=0}^{N} \\omega_j v_j = 0 \\right\\}。\n$$\n考虑限制在 $\\mathcal{M}$ 上的算子 $D|_{\\mathcal{M}}$ 及其奇异值分解 (SVD)，即关于由 $\\|\\cdot\\|_{2,w}$ 导出的内积的奇异值和奇异向量分解。令 $\\sigma_{\\min}(N)$ 和 $\\sigma_{\\max}(N)$ 分别表示在加权 $\\ell^2$ 范数下 $D|_{\\mathcal{M}}$ 的最小和最大奇异值。仅使用关于 Chebyshev 多项式、节点分布 $\\{x_j\\}$ 以及谱精确求积与相应连续加权 $L^2$ 范数之间的范数等价性的基本事实，推导当 $N \\to \\infty$ 时 $\\sigma_{\\min}(N)$ 和 $\\sigma_{\\max}(N)$ 的渐近尺度，并解释与这两个极值奇异值相关的右奇异向量的主要模态内容（用 Chebyshev 多项式表示）。\n\n您最终需要报告的量是条件数的主阶渐近尺度中的指数 $\\alpha$\n$$\\kappa(N) = \\frac{\\sigma_{\\max}(N)}{\\sigma_{\\min}(N)} \\sim C N^{\\alpha}$$\n其中某个常数 $C>0$ 与 $N$ 无关。请提供 $\\alpha$ 的单一值作为最终答案。无需四舍五入。",
            "solution": "用户想要确定限制在零均值子空间上的 Chebyshev 谱微分矩阵的条件数的渐近尺度。\n\n问题定义在 Chebyshev-Gauss-Lobatto (CGL) 网格 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$（$j \\in \\{0, 1, \\dots, N\\}$）上。令 $D$ 为相关的 $(N+1) \\times (N+1)$ 谱微分矩阵。分析是关于一个离散加权内积 $\\langle u, v \\rangle_{2,w} = \\sum_{j=0}^{N} \\omega_j u_j v_j$ 进行的，该内积导出范数 $\\|v\\|_{2,w} = \\left(\\sum_{j=0}^{N} \\omega_j |v_j|^2\\right)^{1/2}$。权重 $\\omega_j$ 使得该内积是连续加权内积 $\\langle f, g \\rangle_{L^2_w} = \\int_{-1}^{1} \\frac{f(x)g(x)}{\\sqrt{1-x^2}}\\,dx$ 的一个谱精确近似。问题依赖于 $\\|v\\|_{2,w}$ 和 $\\|p\\|_{L^2_w}$ 之间的范数等价性，其中 $v_j=p(x_j)$，而 $p(x)$ 是一个次数至多为 $N$ 的多项式。\n\n算子被限制在零均值子空间 $\\mathcal{M} = \\left\\{ v \\in \\mathbb{R}^{N+1} : \\sum_{j=0}^{N} \\omega_j v_j = 0 \\right\\}$ 上。这个离散条件对于相应的多项式 $p(x)$ 而言，等价于连续条件 $\\int_{-1}^{1} \\frac{p(x)}{\\sqrt{1-x^2}}\\,dx=0$。在 Chebyshev 多项式 $T_k(x)$ 的基中，此条件意味着 $T_0(x)=1$ 的系数为零。因此，$\\mathcal{M}$ 对应于多项式空间 $\\text{span}\\{T_1(x), T_2(x), \\dots, T_N(x)\\}$。\n\n受限算子 $D|_{\\mathcal{M}}$ 的奇异值 $\\sigma$ 由 $(D|_{\\mathcal{M}})^* (D|_{\\mathcal{M}})$ 的特征值的平方根给出，其中伴随是相对于加权内积定义的。等价地，它们可以通过瑞利商来刻画：\n$$\n\\sigma = \\sup_{v \\in \\mathcal{M}, v \\neq 0} \\frac{\\|Dv\\|_{2,w}}{\\|v\\|_{2,w}}\n$$\n根据问题中陈述的范数等价性原理，离散算子 $D$ 的奇异值的尺度可以通过分析作用于相应多项式空间上的连续微分算子 $\\mathcal{D} = \\frac{d}{dx}$ 的范数来确定，其中范数在 $L^2_w$ 中取。我们寻求 $\\sigma_{\\min}(N)$ 和 $\\sigma_{\\max}(N)$ 的尺度，它们对应于比率 $\\frac{\\|\\mathcal{D}p\\|_{L^2_w}}{\\|p\\|_{L^2_w}}$ 在所有 $p \\in \\text{span}\\{T_1, \\dots, T_N\\}$ 上的下确界和上确界。\n\n### **最小奇异值 $\\sigma_{\\min}(N)$ 的分析**\n\n最小奇异值对应于被微分放大得最少的模态。这对应于空间 $\\mathcal{M}$ 中“最平滑”或频率最低的函数。与 $\\mathcal{M}$ 对应的多项式空间的基是 $\\{T_k(x)\\}_{k=1}^N$。最低频率的模态是 $T_1(x)=x$。\n\n我们来计算多项式 $p(x) = T_1(x)$ 的瑞利商：\n$p(x)$ 在 $L^2_w$ 中的范数的平方是：\n$$\n\\|T_1\\|^2_{L^2_w} = \\int_{-1}^{1} \\frac{T_1(x)^2}{\\sqrt{1-x^2}}\\,dx = \\frac{\\pi}{2}\n$$\n其导数为 $p'(x) = T_1'(x) = 1 = T_0(x)$。导数的范数的平方是：\n$$\n\\|T_1'\\|^2_{L^2_w} = \\int_{-1}^{1} \\frac{T_0(x)^2}{\\sqrt{1-x^2}}\\,dx = \\pi\n$$\n$T_1(x)$ 的瑞利商是 $\\frac{\\|T_1'\\|_{L^2_w}}{\\|T_1\\|_{L^2_w}} = \\sqrt{\\frac{\\pi}{\\pi/2}} = \\sqrt{2}$。\n\n这为最小奇异值提供了一个上界。由于零均值函数空间上的算子 $\\mathcal{D}$ 是可逆的，其奇异值有正下界。空间族 $\\text{span}\\{T_1, \\dots, T_N\\}$ 是嵌套的。最小奇异值 $\\sigma_{\\min}(N)$ 是 $N$ 的一个非增函数，且有正的下界。因此，当 $N \\to \\infty$ 时，它收敛于一个正常数。\n$$\n\\sigma_{\\min}(N) \\sim O(1)\n$$\n与 $\\sigma_{\\min}(N)$ 相关联的右奇异向量由最低频率的模态 $T_1(x)$ 主导。\n\n### **最大奇异值 $\\sigma_{\\max}(N)$ 的分析**\n\n最大奇异值是算子范数 $\\|D|_{\\mathcal{M}}\\|_{2,w}$。为了找到它的尺度，我们可以构造一个测试向量 $v \\in \\mathcal{M}$，它被 $D$ 极大地放大。众所周知，微分算子对快速变化的函数会产生大的导数。在 CGL 网格上，节点密度在端点 $x=\\pm 1$ 附近最高。这表明，一个局部化在某个端点附近的函数将具有大的离散导数。\n\n我们考虑与节点 $x_0 = 1$ 相关的 Lagrange 基多项式 $p_0(x)=L_0(x)$。对应的向量 $v^{(0)}$ 的分量为 $v^{(0)}_j = \\delta_{j0}$。这个向量不在零均值子空间 $\\mathcal{M}$ 中，因为 $\\sum_{j=0}^N \\omega_j v^{(0)}_j = \\omega_0 \\neq 0$。我们将 $v^{(0)}$ 投影到 $\\mathcal{M}$ 上以获得一个有效的测试向量 $\\tilde{v}$。与常数函数 $T_0(x)=1$ 对应的向量是 $\\mathbf{1}=(1,1,\\dots,1)^T$。投影为：\n$$\n\\tilde{v} = v^{(0)} - \\frac{\\langle v^{(0)}, \\mathbf{1} \\rangle_{2,w}}{\\|\\mathbf{1}\\|_{2,w}^2} \\mathbf{1}\n$$\n我们有 $\\langle v^{(0)}, \\mathbf{1} \\rangle_{2,w} = \\sum_{j=0}^N \\omega_j \\delta_{j0} (1) = \\omega_0$。求积权重的总和对于 $T_0(x)=1$ 的积分是精确的：$\\|\\mathbf{1}\\|_{2,w}^2 = \\sum_{j=0}^N \\omega_j = \\int_{-1}^1 \\frac{1}{\\sqrt{1-x^2}}dx = \\pi$。所以，$\\tilde{v} = v^{(0)} - \\frac{\\omega_0}{\\pi} \\mathbf{1}$。\n\n现在我们计算 $\\tilde{v}$ 和 $D\\tilde{v}$ 的范数。\n$\\tilde{v}$ 的范数的平方是：\n$$\n\\|\\tilde{v}\\|_{2,w}^2 = \\|v^{(0)}\\|_{2,w}^2 - \\frac{|\\langle v^{(0)}, \\mathbf{1} \\rangle_{2,w}|^2}{\\|\\mathbf{1}\\|_{2,w}^2} = \\omega_0 - \\frac{\\omega_0^2}{\\pi}\n$$\n对于常用的 Clenshaw-Curtis 求积权重，$\\omega_0 = \\frac{\\pi}{2N}$。因此，$\\|\\tilde{v}\\|_{2,w}^2 = \\frac{\\pi}{2N} - O(N^{-2})$，其尺度为 $O(N^{-1})$。\n\n接下来，我们计算 $D\\tilde{v}$。由于 $D$ 作用于常数向量为零，即 $D\\mathbf{1}=0$。\n$$\nD\\tilde{v} = D\\left(v^{(0)} - \\frac{\\omega_0}{\\pi} \\mathbf{1}\\right) = Dv^{(0)}\n$$\n向量 $Dv^{(0)}$ 是微分矩阵 $D$ 的第0列。其分量为 $(Dv^{(0)})_j = D_{j0}$。范数的平方是：\n$$\n\\|D\\tilde{v}\\|_{2,w}^2 = \\|Dv^{(0)}\\|_{2,w}^2 = \\sum_{j=0}^{N} \\omega_j (D_{j0})^2\n$$\nChebyshev 微分矩阵的元素是已知的。第0列中的主导元素是对角元素：\n$$\nD_{00} = \\frac{2N^2+1}{6} \\sim O(N^2)\n$$\n非对角元素 $D_{j0}$ 较小。$j=0$ 项对和的贡献将主导其尺度。我们用这一个单项来近似范数：\n$$\n\\|D\\tilde{v}\\|_{2,w}^2 \\approx \\omega_0 (D_{00})^2 \\approx \\left(\\frac{\\pi}{2N}\\right) \\left(\\frac{2N^2+1}{6}\\right)^2 \\approx \\frac{\\pi}{2N} \\frac{4N^4}{36} = \\frac{\\pi}{18} N^3\n$$\n范数的平方的尺度为 $O(N^3)$。\n这个测试向量 $\\tilde{v}$ 的瑞利商是：\n$$\n\\frac{\\|D\\tilde{v}\\|_{2,w}^2}{\\|\\tilde{v}\\|_{2,w}^2} \\approx \\frac{O(N^3)}{O(N^{-1})} = O(N^4)\n$$\n由于 $\\sigma_{\\max}^2(N) \\ge \\frac{\\|D\\tilde{v}\\|_{2,w}^2}{\\|\\tilde{v}\\|_{2,w}^2}$，我们有 $\\sigma_{\\max}^2(N) \\sim O(N^4)$，这意味着：\n$$\n\\sigma_{\\max}(N) \\sim O(N^2)\n$$\n这是 Chebyshev 微分的一个熟知结果。与 $\\sigma_{\\max}(N)$ 相关的右奇异向量不是单个 Chebyshev 多项式，而是一个高度局部化在某个边界（$x=\\pm 1$）附近的函数，它是许多 $T_k(x)$ 模态的宽带叠加。\n\n### **条件数尺度**\n条件数 $\\kappa(N)$ 是最大奇异值与最小奇异值的比值：\n$$\n\\kappa(N) = \\frac{\\sigma_{\\max}(N)}{\\sigma_{\\min}(N)} \\sim \\frac{O(N^2)}{O(1)} = O(N^2)\n$$\n问题要求的是尺度定律 $\\kappa(N) \\sim C N^\\alpha$ 中的指数 $\\alpha$。与我们的结果比较，我们发现 $\\alpha=2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "微分算子严重的病态性给迭代求解器带来了巨大挑战。本练习在傅里叶谱方法的背景下，展示了一种简洁而高效的解决方案——预处理。我们将构建一个离散积分算子，它作为预处理器，能有效地将均值为零子空间上条件恶劣的微分问题转化为一个条件数为1的理想问题 ，从而量化这种显著的性能改进。",
            "id": "3372558",
            "problem": "考虑一个 $2\\pi$-周期区间和 $N \\geq 4$ 个等距节点 $x_{j} = -\\pi + \\frac{2\\pi j}{N}$（$j = 0, 1, \\dots, N-1$，$N$为偶数）。设 $\\mathbf{u} \\in \\mathbb{C}^{N}$ 表示一个三角插值函数在节点上的值。将傅里叶谱微分算子 $D$ 定义为一个线性映射，它将 $\\mathbf{u}$ 映为对其 $2\\pi$-周期三角插值函数求导后在节点 $\\{x_{j}\\}_{j=0}^{N-1}$ 处的值。设 $\\mathcal{Z} \\subset \\mathbb{C}^{N}$ 表示离散零均值子空间，\n$$\n\\mathcal{Z} = \\left\\{\\mathbf{u} \\in \\mathbb{C}^{N} : \\sum_{j=0}^{N-1} u_{j} = 0 \\right\\}.\n$$\n采用酉离散傅里叶变换 (DFT) 矩阵 $F$，使得 $F$ 能对角化循环算子。在波数 $\\{k\\}$ 的标准排序为 $k = 0, 1, \\dots, \\frac{N}{2}, -\\frac{N}{2}+1, \\dots, -1$ 的情况下，微分算子的谱符号为对角矩阵 $\\Lambda = \\mathrm{diag}(i k)$。\n\n通过其在傅里叶空间中的作用构造一个离散积分算子 $I$，该算子将非零波数系数 $\\hat{u}_{k}$ 映射为 $\\hat{v}_{k} = \\frac{1}{i k}\\hat{u}_{k}$ (当 $k \\neq 0$)，并将零波数系数设为零。即，使用对角矩阵 $\\Lambda^{\\dagger} = \\mathrm{diag}(\\mu_{k})$，其中 $\\mu_{0} = 0$ 且当 $k \\neq 0$ 时 $\\mu_{k} = \\frac{1}{i k}$，并定义 $I = F^{*}\\Lambda^{\\dagger}F$。设 $P$ 表示通过在傅里叶空间中将 $k=0$ 模式置零而诱导出的到 $\\mathcal{Z}$ 上的正交投影，即 $P = F^{*}\\Pi F$，其中 $\\Pi = \\mathrm{diag}(\\pi_{k})$，$\\pi_{0} = 0$ 且当 $k \\neq 0$ 时 $\\pi_{k} = 1$。\n\n从这些定义和傅里叶谱配置法的基本原理出发，证明 $ID = P$。然后，对于一个非奇异算子 $A$，使用 $2$-范数条件数 $\\kappa_{2}(A) = \\|A\\|_{2}\\|A^{-1}\\|_{2}$，考虑算子在零均值子空间 $\\mathcal{Z}$ 上的限制。确定\n$$\nr(N) = \\frac{\\kappa_{2}\\!\\left(ID\\big|_{\\mathcal{Z}}\\right)}{\\kappa_{2}\\!\\left(D\\big|_{\\mathcal{Z}}\\right)}\n$$\n作为 $N$ 的函数的精确闭式表达式。将你的最终答案表示为一个简化的解析表达式。不要提供不等式。无需四舍五入。",
            "solution": "该问题要求两个主要结果。首先，证明离散积分算子 $I$ 和离散微分算子 $D$ 的乘积等于到零均值子空间 $\\mathcal{Z}$ 上的正交投影算子 $P$。其次，确定算子 $ID$ 和 $D$（均限制在子空间 $\\mathcal{Z}$ 上）的 $2$-范数条件数的比值 $r(N)$。\n\n我们从第一部分开始：证明恒等式 $ID=P$。\n算子 $D$、$I$ 和 $P$ 是通过酉离散傅里叶变换 (DFT) 矩阵 $F$ 及其各自的谱符号（均为对角矩阵）来定义的。定义如下：\n$D = F^{*}\\Lambda F$，其中 $\\Lambda = \\mathrm{diag}(ik)$\n$I = F^{*}\\Lambda^{\\dagger}F$，其中 $\\Lambda^{\\dagger} = \\mathrm{diag}(\\mu_{k})$，$\\mu_{0}=0$ 且当 $k \\neq 0$ 时 $\\mu_{k} = \\frac{1}{ik}$。\n$P = F^{*}\\Pi F$，其中 $\\Pi = \\mathrm{diag}(\\pi_{k})$，$\\pi_{0}=0$ 且当 $k \\neq 0$ 时 $\\pi_{k} = 1$。\n\n让我们计算乘积 $ID$：\n$$\nID = (F^{*}\\Lambda^{\\dagger}F)(F^{*}\\Lambda F)\n$$\n由于 DFT 矩阵 $F$ 是酉矩阵，我们有 $F F^{*} = \\mathbb{I}$，其中 $\\mathbb{I}$ 是 $N \\times N$ 单位矩阵。乘积可简化为：\n$$\nID = F^{*}\\Lambda^{\\dagger}(F F^{*})\\Lambda F = F^{*}\\Lambda^{\\dagger}\\mathbb{I}\\Lambda F = F^{*}(\\Lambda^{\\dagger}\\Lambda)F\n$$\n现在我们必须计算矩阵乘积 $\\Lambda^{\\dagger}\\Lambda$。由于 $\\Lambda^{\\dagger}$ 和 $\\Lambda$ 都是对角矩阵，它们的乘积也是一个对角矩阵。$\\Lambda^{\\dagger}\\Lambda$ 的第 $k$ 个对角元素是 $\\Lambda^{\\dagger}$ 和 $\\Lambda$ 的第 $k$ 个对角元素的乘积。让我们将 $\\Lambda^{\\dagger}$ 的对角元素记为 $\\mu_k$，将 $\\Lambda$ 的对角元素记为 $\\lambda_k = ik$。\n\n对于波数 $k=0$：\n相应的对角元素是 $\\mu_{0} \\cdot \\lambda_{0} = 0 \\cdot (i \\cdot 0) = 0$。\n\n对于集合 $\\{1, \\dots, \\frac{N}{2}, -\\frac{N}{2}+1, \\dots, -1\\}$ 中的任意非零波数 $k \\neq 0$：\n相应的对角元素是 $\\mu_{k} \\cdot \\lambda_{k} = \\left(\\frac{1}{ik}\\right) \\cdot (ik) = 1$。\n\n因此，乘积矩阵 $\\Lambda^{\\dagger}\\Lambda$ 是一个对角矩阵，其对应于 $k=0$ 的元素为 $0$，所有其他对角元素为 $1$。这恰好是矩阵 $\\Pi = \\mathrm{diag}(\\pi_{k})$ 的定义。\n所以，$\\Lambda^{\\dagger}\\Lambda = \\Pi$。\n将此代回 $ID$ 的表达式，我们得到：\n$$\nID = F^{*}\\Pi F\n$$\n根据定义，$P = F^{*}\\Pi F$。因此我们证明了 $ID = P$。\n\n接下来，我们进行第二部分：确定 $r(N) = \\frac{\\kappa_{2}\\!\\left(ID\\big|_{\\mathcal{Z}}\\right)}{\\kappa_{2}\\!\\left(D\\big|_{\\mathcal{Z}}\\right)}$。\n这涉及到计算算子 $ID$ 和 $D$ 在其定义域被限制在零均值子空间 $\\mathcal{Z}$ 上时的 $2$-范数条件数。空间 $\\mathcal{Z}$ 由所有 $k=0$ 傅里叶系数为零的向量 $\\mathbf{u} \\in \\mathbb{C}^{N}$ 组成。算子 $P$ 是到 $\\mathcal{Z}$ 上的正交投影。\n\n让我们首先分析分子，$\\kappa_{2}\\!\\left(ID\\big|_{\\mathcal{Z}}\\right)$。\n从第一部分可知，$ID = P$。所以我们需要计算 $\\kappa_{2}\\!\\left(P\\big|_{\\mathcal{Z}}\\right)$。算子 $P\\big|_{\\mathcal{Z}}$ 是投影 $P$ 在其自身值域 $\\mathcal{Z}$ 上的限制。根据投影的定义，对于 $P$ 的值域中的任何向量 $\\mathbf{u}$，我们有 $P\\mathbf{u} = \\mathbf{u}$。因此，对于任意 $\\mathbf{u} \\in \\mathcal{Z}$，$P\\mathbf{u} = \\mathbf{u}$。这意味着 $P\\big|_{\\mathcal{Z}}$ 是子空间 $\\mathcal{Z}$ 上的单位算子，我们称之为 $\\mathbb{I}_{\\mathcal{Z}}$。\n任何非平凡向量空间上的单位算子的 $2$-范数条件数都是 $1$。形式上，$\\kappa_{2}(\\mathbb{I}_{\\mathcal{Z}}) = \\|\\mathbb{I}_{\\mathcal{Z}}\\|_{2} \\|(\\mathbb{I}_{\\mathcal{Z}})^{-1}\\|_{2}$。逆 $(\\mathbb{I}_{\\mathcal{Z}})^{-1}$ 就是 $\\mathbb{I}_{\\mathcal{Z}}$ 本身。单位算子的 $2$-范数是 $\\|\\mathbb{I}_{\\mathcal{Z}}\\|_{2} = \\sup_{\\mathbf{u} \\in \\mathcal{Z}, \\|\\mathbf{u}\\|_{2}=1} \\|\\mathbb{I}_{\\mathcal{Z}}\\mathbf{u}\\|_{2} = \\sup_{\\mathbf{u} \\in \\mathcal{Z}, \\|\\mathbf{u}\\|_{2}=1} \\|\\mathbf{u}\\|_{2} = 1$。\n因此，\n$$\n\\kappa_{2}\\!\\left(ID\\big|_{\\mathcal{Z}}\\right) = \\kappa_{2}\\!\\left(P\\big|_{\\mathcal{Z}}\\right) = 1 \\cdot 1 = 1\n$$\n\n现在，我们来分析分母，$\\kappa_{2}\\!\\left(D\\big|_{\\mathcal{Z}}\\right)$。\n条件数由 $\\kappa_{2}\\!\\left(D\\big|_{\\mathcal{Z}}\\right) = \\|D\\big|_{\\mathcal{Z}}\\|_{2} \\|(D\\big|_{\\mathcal{Z}})^{-1}\\|_{2}$ 给出。\n算子 $D = F^{*}\\Lambda F$ 是一个正规矩阵，因为 $F$ 是酉矩阵且 $\\Lambda$ 是对角矩阵，因此 $D^{*}D = DD^{*}$。正规算子的一个重要性质是其 $2$-范数等于其谱半径（其特征值的最大绝对值）。\n$D$ 的特征值是 $\\Lambda$ 的对角元素，即对于给定的波数集合 $k = 0, 1, \\dots, \\frac{N}{2}, -\\frac{N}{2}+1, \\dots, -1$ 的 $\\{ik\\}$。相应的特征向量是 $F^{*}$ 的列，它们是在节点 $\\{x_j\\}$ 上采样的复指数函数。\n子空间 $\\mathcal{Z}$ 是零均值向量的空间，这对应于 $k=0$ 傅里叶系数为零。这意味着 $\\mathcal{Z}$ 由 $D$ 的对应于所有非零波数的特征向量张成。因此，$\\mathcal{Z}$ 是 $D$ 的一个不变子空间。算子 $D\\big|_{\\mathcal{Z}}$ 将 $\\mathcal{Z}$ 映射到自身，其特征值恰好是 $D$ 在 $k \\neq 0$ 时的特征值，即 $\\{ik\\}$ 对于 $k \\in \\{1, \\dots, \\frac{N}{2}, -\\frac{N}{2}+1, \\dots, -1\\}$。\n由于 $D\\big|_{\\mathcal{Z}}$ 也是一个正规算子（作为正规算子在其特征向量张成的不变子空间上的限制），其 $2$-范数是其特征值绝对值的最大值：\n$$\n\\|D\\big|_{\\mathcal{Z}}\\|_{2} = \\max_{k \\neq 0} |ik| = \\max_{k \\neq 0} |k|\n$$\n非零波数的集合是 $k \\in \\{1, 2, \\dots, \\frac{N}{2}\\} \\cup \\{-1, -2, \\dots, -\\frac{N}{2}+1\\}$。其绝对值为 $|k| \\in \\{1, 2, \\dots, \\frac{N}{2}\\}$。最大值在 $k=\\frac{N}{2}$ 处取得。\n$$\n\\|D\\big|_{\\mathcal{Z}}\\|_{2} = \\frac{N}{2}\n$$\n接下来，我们求逆算子 $(D\\big|_{\\mathcal{Z}})^{-1}$ 的范数。由于 $D\\big|_{\\mathcal{Z}}$ 的所有特征值都是非零的，该算子是可逆的。$(D\\big|_{\\mathcal{Z}})^{-1}$ 的特征值是 $D\\big|_{\\mathcal{Z}}$ 特征值的倒数，即对于 $k \\neq 0$ 的 $\\{\\frac{1}{ik}\\}$。\n逆算子的 $2$-范数是其特征值的最大绝对值：\n$$\n\\|(D\\big|_{\\mathcal{Z}})^{-1}\\|_{2} = \\max_{k \\neq 0} \\left|\\frac{1}{ik}\\right| = \\max_{k \\neq 0} \\frac{1}{|k|} = \\frac{1}{\\min_{k \\neq 0} |k|}\n$$\n非零波数的最小绝对值为 $1$，在 $k=1$ 和 $k=-1$ 时出现。\n$$\n\\|(D\\big|_{\\mathcal{Z}})^{-1}\\|_{2} = \\frac{1}{1} = 1\n$$\n现在我们可以计算 $D\\big|_{\\mathcal{Z}}$ 的条件数：\n$$\n\\kappa_{2}\\!\\left(D\\big|_{\\mathcal{Z}}\\right) = \\|D\\big|_{\\mathcal{Z}}\\|_{2} \\|(D\\big|_{\\mathcal{Z}})^{-1}\\|_{2} = \\frac{N}{2} \\cdot 1 = \\frac{N}{2}\n$$\n最后，我们计算比值 $r(N)$：\n$$\nr(N) = \\frac{\\kappa_{2}\\!\\left(ID\\big|_{\\mathcal{Z}}\\right)}{\\kappa_{2}\\!\\left(D\\big|_{\\mathcal{Z}}\\right)} = \\frac{1}{\\frac{N}{2}} = \\frac{2}{N}\n$$\n这是该比值作为 $N \\geq 4$ 的函数的简化解析表达式。",
            "answer": "$$\\boxed{\\frac{2}{N}}$$"
        }
    ]
}