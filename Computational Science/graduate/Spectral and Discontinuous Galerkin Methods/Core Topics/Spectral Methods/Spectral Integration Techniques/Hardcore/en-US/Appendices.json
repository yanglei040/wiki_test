{
    "hands_on_practices": [
        {
            "introduction": "While one-dimensional quadrature rules form the theoretical backbone of spectral integration, most scientific and engineering problems are set in multiple dimensions. This practice provides a direct, hands-on application of the tensor-product method, the standard technique for extending 1D rules to multidimensional domains like squares and cubes. By explicitly computing a double integral of a polynomial function on the reference square, you will see how the exactness property of one-dimensional Gauss-Legendre quadrature translates directly to higher dimensions, building a crucial intuition for implementing spectral methods on structured grids .",
            "id": "3418941",
            "problem": "Consider the reference square element with coordinates $(x,y) \\in [-1,1] \\times [-1,1]$ as used in spectral element methods and discontinuous Galerkin methods. In this context, quadrature rules are employed to perform exact polynomial integration whenever possible. The Gaussian quadrature rule associated with Legendre polynomials, known as Gauss–Legendre Quadrature (GLQ), has the well-tested property of exactness for one-dimensional polynomials up to degree $2N-1$ when $N$ points are used. The tensor-product of one-dimensional GLQ rules is used to construct multidimensional quadrature on tensor-product domains, such as the reference square.\n\nStarting from Fubini’s theorem and the definition of exactness for GLQ, compute the double integral\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\nusing a tensor-product GLQ with $N_x = N_y = 3$ points in each direction. Then verify, in terms of separate one-dimensional rules applied in $x$ and $y$, why the tensor-product GLQ is exact for this integrand. Express the final value of the integral as an exact real number.",
            "solution": "The problem requires the computation of a double integral over the reference square element using a tensor-product Gauss-Legendre Quadrature (GLQ) rule, and a verification of the exactness of the result.\n\nThe integral to be computed is\n$$\nI = \\int_{-1}^{1}\\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\nThe integrand is $f(x,y) = x^3 y^4$. Since the integrand is a separable function of its variables, $f(x,y) = p_x(x) p_y(y)$ where $p_x(x) = x^3$ and $p_y(y) = y^4$, and the domain of integration is a Cartesian product of intervals, we can apply Fubini’s theorem to separate the double integral into a product of two one-dimensional integrals:\n$$\nI = \\left( \\int_{-1}^{1} x^{3} \\, dx \\right) \\left( \\int_{-1}^{1} y^{4} \\, dy \\right)\n$$\nA tensor-product quadrature rule approximates this structure by applying one-dimensional quadrature rules to each integral separately. The general form of a tensor-product quadrature on the reference square is:\n$$\nI \\approx I_{GLQ} = \\sum_{i=1}^{N_y} \\sum_{j=1}^{N_x} w_j w_i f(x_j, y_i)\n$$\nwhere $\\{x_j, w_j\\}_{j=1}^{N_x}$ are the quadrature points and weights in the $x$-direction, and $\\{y_i, w_i\\}_{i=1}^{N_y}$ are the quadrature points and weights in the $y$-direction. Due to the separability of the integrand, this sum can be factored:\n$$\nI_{GLQ} = \\left( \\sum_{j=1}^{N_x} w_j p_x(x_j) \\right) \\left( \\sum_{i=1}^{N_y} w_i p_y(y_i) \\right)\n$$\nThe problem specifies a Gauss-Legendre Quadrature with $N_x = 3$ points in the $x$-direction and $N_y = 3$ points in the $y$-direction. For a $3$-point GLQ ($N=3$), the quadrature points are the roots of the Legendre polynomial of degree $3$, $P_3(z) = \\frac{1}{2}(5z^3 - 3z)$. The roots are $z_1 = -\\sqrt{\\frac{3}{5}}$, $z_2 = 0$, and $z_3 = \\sqrt{\\frac{3}{5}}$.\nThe corresponding weights are $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, and $w_3 = \\frac{5}{9}$.\n\nWe apply this rule to each one-dimensional integral.\n\nFirst, for the integral in the $x$-direction with $p_x(x) = x^3$:\n$$\n\\int_{-1}^{1} x^3 \\, dx \\approx \\sum_{j=1}^{3} w_j x_j^3 = w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3\n$$\nSubstituting the points and weights:\n$$\n\\sum_{j=1}^{3} w_j x_j^3 = \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^3 + \\left(\\frac{8}{9}\\right) (0)^3 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^3\n$$\n$$\n= \\frac{5}{9} \\left(-\\frac{3\\sqrt{3}}{5\\sqrt{5}}\\right) + 0 + \\frac{5}{9} \\left(\\frac{3\\sqrt{3}}{5\\sqrt{5}}\\right) = -\\frac{3\\sqrt{3}}{9\\sqrt{5}} + \\frac{3\\sqrt{3}}{9\\sqrt{5}} = 0\n$$\n\nSecond, for the integral in the $y$-direction with $p_y(y) = y^4$:\n$$\n\\int_{-1}^{1} y^4 \\, dy \\approx \\sum_{i=1}^{3} w_i y_i^4 = w_1 y_1^4 + w_2 y_2^4 + w_3 y_3^4\n$$\nSubstituting the points and weights:\n$$\n\\sum_{i=1}^{3} w_i y_i^4 = \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^4 + \\left(\\frac{8}{9}\\right) (0)^4 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^4\n$$\n$$\n= \\frac{5}{9} \\left(\\frac{9}{25}\\right) + 0 + \\frac{5}{9} \\left(\\frac{9}{25}\\right) = 2 \\left(\\frac{5 \\cdot 9}{9 \\cdot 25}\\right) = 2 \\left(\\frac{5}{25}\\right) = \\frac{2}{5}\n$$\n\nThe value of the double integral computed by the tensor-product GLQ is the product of these two results:\n$$\nI_{GLQ} = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\n\nNext, we verify the exactness of this result. The one-dimensional Gauss-Legendre Quadrature rule with $N$ points is exact for any polynomial of degree up to $2N-1$.\n\nFor the $x$-direction, we used $N_x = 3$ points to integrate the polynomial $p_x(x) = x^3$. The degree of this polynomial is $d_x = 3$. The rule is exact for polynomials of degree up to $2N_x - 1 = 2(3) - 1 = 5$. Since $d_x = 3 \\le 5$, the quadrature for the $x$-integral is exact. The exact value is $\\int_{-1}^{1} x^3 \\, dx = \\left[\\frac{x^4}{4}\\right]_{-1}^{1} = \\frac{1}{4} - \\frac{1}{4} = 0$, which matches the quadrature result.\n\nFor the $y$-direction, we used $N_y = 3$ points to integrate the polynomial $p_y(y) = y^4$. The degree of this polynomial is $d_y = 4$. The rule is exact for polynomials of degree up to $2N_y - 1 = 2(3) - 1 = 5$. Since $d_y = 4 \\le 5$, the quadrature for the $y$-integral is also exact. The exact value is $\\int_{-1}^{1} y^4 \\, dy = \\left[\\frac{y^5}{5}\\right]_{-1}^{1} = \\frac{1}{5} - \\frac{-1}{5} = \\frac{2}{5}$, which matches the quadrature result.\n\nSince the tensor-product GLQ is equivalent to the product of two one-dimensional GLQ evaluations, and each one-dimensional evaluation was exact for its respective polynomial factor, the final result is exact. The exact value of the double integral is the product of the exact values of the one-dimensional integrals:\n$$\nI_{exact} = \\left( \\int_{-1}^{1} x^{3} \\, dx \\right) \\left( \\int_{-1}^{1} y^{4} \\, dy \\right) = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\nThis confirms that the value $I_{GLQ} = 0$ is the exact value of the integral.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "In the finite element or discontinuous Galerkin framework, numerical integration is not an end in itself but a means to construct the discrete algebraic system. The entries of the mass matrix, $M_{ij}$, and stiffness matrix, $K_{ij}$, are defined by integrals whose accuracy directly impacts the stability and convergence of the entire simulation. This exercise addresses a fundamental question for any practitioner: given a polynomial approximation of degree $p$, what is the minimum number of quadrature points $N$ needed to compute these matrices exactly? By analyzing the polynomial degree of the integrands, you will derive the precise relationship between $p$ and $N$ for different quadrature families, a critical piece of knowledge for writing efficient and accurate code .",
            "id": "3418922",
            "problem": "Consider a one-dimensional discontinuous Galerkin (DG) discretization on the reference element $\\left[-1,1\\right]$ using a polynomial approximation space of degree at most $p \\in \\mathbb{N}_{0}$. Let $\\{\\phi_{i}(x)\\}_{i=0}^{p}$ be any basis spanning this space. The element mass matrix and the (volume) stiffness matrix are defined by the bilinear forms\n$$\nM_{ij} \\equiv \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x, \n\\qquad\nK_{ij} \\equiv \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,\\mathrm{d}x.\n$$\nAssume that the numerical integration is performed using either standard Gaussian (Gauss–Legendre) quadrature with $N$ interior points or Gauss–Lobatto–Legendre quadrature with $N$ points including the endpoints. Starting only from the following fundamental bases:\n- the degree properties of products and derivatives of polynomials,\n- the definition of exactness of a quadrature rule for polynomials,\nderive the minimal number of quadrature points $N$ needed by each quadrature rule to compute the mass matrix entries $M_{ij}$ exactly for all $i,j \\in \\{0,\\dots,p\\}$. Then, using the same reasoning, determine the minimal $N$ sufficient to compute the (volume) stiffness matrix entries $K_{ij}$ exactly, and explain the implications for stiffness matrix accuracy when one chooses $N$ that guarantees exactness of the mass matrix.\n\nProvide your final answer as the pair $\\left(N_{\\text{Gauss}},\\,N_{\\text{Gauss–Lobatto}}\\right)$ for mass-matrix exactness, expressed symbolically in terms of $p$, in a single row matrix using $\\texttt{pmatrix}$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the minimal number of quadrature points, $N$, for two types of quadrature rules to exactly compute the mass and stiffness matrices in a discontinuous Galerkin framework on a reference element. The solution will be derived from first principles regarding polynomial degrees and quadrature rule exactness.\n\nLet $\\mathcal{P}_k$ denote the space of polynomials of degree at most $k$. The problem states that the approximation space is the set of polynomials of degree at most $p$, where $p \\in \\mathbb{N}_0 = \\{0, 1, 2, \\dots\\}$. The basis functions $\\{\\phi_i(x)\\}_{i=0}^{p}$ span this space, so each $\\phi_i(x) \\in \\mathcal{P}_p$.\n\nThe fundamental properties we will use are:\n1.  **Degree of a product**: If $f(x) \\in \\mathcal{P}_{d_1}$ and $g(x) \\in \\mathcal{P}_{d_2}$, their product $f(x)g(x)$ is a polynomial in $\\mathcal{P}_{d_1+d_2}$.\n2.  **Degree of a derivative**: If $f(x) \\in \\mathcal{P}_d$ with $d \\ge 1$, its derivative $f'(x)$ is a polynomial in $\\mathcal{P}_{d-1}$. If $f(x) \\in \\mathcal{P}_0$ (a constant), then $f'(x) = 0$.\n3.  **Exactness of Gaussian quadrature**: A standard Gauss-Legendre quadrature rule with $N$ points is exact for any polynomial of degree at most $2N-1$.\n4.  **Exactness of Gauss-Lobatto-Legendre quadrature**: A Gauss-Lobatto-Legendre quadrature rule with $N$ points is exact for any polynomial of degree at most $2N-3$.\n\n**Part 1: Exact Integration of the Mass Matrix ($M_{ij}$)**\n\nThe entries of the mass matrix are defined by the integral $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$. The integrand is the product $\\phi_{i}(x)\\phi_{j}(x)$.\nSince $\\phi_i(x) \\in \\mathcal{P}_p$ and $\\phi_j(x) \\in \\mathcal{P}_p$, their product is a polynomial. The maximum degree of this product occurs when both basis functions have the maximal degree $p$. In this case, the degree of the integrand is $p+p=2p$. Therefore, to compute all entries $M_{ij}$ exactly, the quadrature rule must be exact for all polynomials of degree up to $2p$.\n\n*   **For Gauss-Legendre quadrature:**\n    We require the rule to be exact for polynomials of degree at most $2p$. The condition is:\n    $$2N - 1 \\ge 2p$$\n    Solving for $N$ gives:\n    $$2N \\ge 2p + 1 \\implies N \\ge p + \\frac{1}{2}$$\n    Since the number of quadrature points $N$ must be an integer, the minimal number of points is $N_{\\text{Gauss}} = \\lceil p + \\frac{1}{2} \\rceil = p+1$.\n\n*   **For Gauss-Lobatto-Legendre quadrature:**\n    We again require the rule to be exact for polynomials of degree at most $2p$. The condition is:\n    $$2N - 3 \\ge 2p$$\n    Solving for $N$ gives:\n    $$2N \\ge 2p + 3 \\implies N \\ge p + \\frac{3}{2}$$\n    Since $N$ must be an integer, the minimal number of points is $N_{\\text{Gauss-Lobatto}} = \\lceil p + \\frac{3}{2} \\rceil = p+2$.\n\n**Part 2: Exact Integration of the Stiffness Matrix ($K_{ij}$)**\n\nThe entries of the stiffness matrix are defined by $K_{ij} = \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,\\mathrm{d}x$. The integrand is the product $\\phi_{i}'(x)\\phi_{j}'(x)$.\nSince $\\phi_i(x) \\in \\mathcal{P}_p$, its derivative $\\phi_i'(x)$ is a polynomial of degree at most $p-1$. Similarly, $\\phi_j'(x) \\in \\mathcal{P}_{p-1}$. This holds for $p \\ge 1$. If $p=0$, the basis functions are constants, and their derivatives are zero, making the integrand identically zero.\nFor $p \\ge 1$, the product $\\phi_i'(x)\\phi_j'(x)$ is a polynomial of degree at most $(p-1)+(p-1) = 2p-2$. For $p=0$, the integrand is the zero polynomial, which has a degree of $-\\infty$. The integral of zero is zero, and any quadrature rule with at least one point ($N \\ge 1$) will compute this exactly.\nThus, the quadrature rule must be exact for polynomials of degree up to $2p-2$ if $p \\ge 1$, and for the zero polynomial if $p=0$.\n\n*   **For Gauss-Legendre quadrature:**\n    For $p \\ge 1$, we require exactness up to degree $2p-2$:\n    $$2N - 1 \\ge 2p - 2 \\implies 2N \\ge 2p - 1 \\implies N \\ge p - \\frac{1}{2}$$\n    The minimal integer is $N=p$.\n    For $p=0$, we need $N \\ge 1$. The formula $N=p$ gives $N=0$, which is not a valid number of points.\n    Therefore, the minimal number of points is $N=1$ for $p=0$, and $N=p$ for $p \\ge 1$. This can be written compactly as $N_{\\text{Gauss, stiff}} = \\max(1, p)$.\n\n*   **For Gauss-Lobatto-Legendre quadrature:**\n    For $p \\ge 1$, we require exactness up to degree $2p-2$:\n    $$2N - 3 \\ge 2p - 2 \\implies 2N \\ge 2p + 1 \\implies N \\ge p + \\frac{1}{2}$$\n    The minimal integer is $N=p+1$.\n    For $p=0$, the minimal $N$ is $1$. The formula $N=p+1$ gives $N=1$, so it holds for $p=0$ as well.\n    Thus, the minimal number of points is $N_{\\text{Gauss-Lobatto, stiff}} = p+1$ for all $p \\in \\mathbb{N}_0$.\n\n**Part 3: Implications for Stiffness Matrix Accuracy**\n\nThe problem asks for the implication on the stiffness matrix computation if one chooses $N$ to guarantee exactness of the mass matrix.\n\n*   **Using Gauss-Legendre:**\n    We choose $N = p+1$ to exactly integrate the mass matrix. With this choice, the quadrature is exact for polynomials of degree up to $2(p+1) - 1 = 2p+1$. The stiffness matrix integrand has a maximum degree of $2p-2$. Since $2p+1 \\ge 2p-2$ for all $p \\ge 0$ (the inequality is $3 \\ge 0$), the quadrature rule is more than sufficient to integrate the stiffness matrix integrand exactly.\n\n*   **Using Gauss-Lobatto-Legendre:**\n    We choose $N = p+2$ to exactly integrate the mass matrix. This rule is exact for polynomials of degree up to $2(p+2) - 3 = 2p+1$. Again, the stiffness matrix integrand has a maximum degree of $2p-2$. Since $2p+1 \\ge 2p-2$ for all $p \\ge 0$, this choice of $N$ also guarantees the exact integration of the stiffness matrix.\n\n**Conclusion:**\nIn both cases (Gauss-Legendre and Gauss-Lobatto-Legendre), selecting the minimal number of quadrature points $N$ required for exact integration of the mass matrix automatically ensures that the (volume) stiffness matrix is also computed exactly. This is because the polynomial degree of the integrand for the mass matrix ($2p$) is always greater than the polynomial degree of the integrand for the stiffness matrix ($2p-2$). The final answer is the pair of minimal points for mass-matrix exactness.\nFor Gauss-Legendre, $N_{\\text{Gauss}} = p+1$.\nFor Gauss-Lobatto-Legendre, $N_{\\text{Gauss-Lobatto}} = p+2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np+1 & p+2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The power of Gaussian quadrature lies in its high degree of exactness, but not all 'Gaussian' rules are created equal. This practice explores the subtle but critical differences between the standard Gauss-Legendre rule and the Gauss-Lobatto-Legendre rule, which includes the element endpoints as nodes. Using a specially designed polynomial whose degree lies precisely between the exactness limits of these two rules, you will uncover a scenario where the Gauss-Lobatto approximation yields a result of zero for a non-zero integral. This striking example provides a deep insight into quadrature error and serves as a powerful lesson on the importance of selecting a rule whose properties are appropriate for the problem at hand .",
            "id": "3418953",
            "problem": "Let $N \\geq 3$ be an integer and consider the Legendre polynomials $\\{P_{k}(x)\\}_{k=0}^{\\infty}$ on the interval $[-1,1]$, defined as the unique polynomial sequence satisfying the Legendre differential equation and the normalization $P_{0}(x)=1$. Define the polynomial\n$$p_{N}(x) \\coloneqq (1 - x^{2})\\left[P_{N-1}'(x)\\right]^{2}.$$\nUsing only fundamental properties of orthogonal polynomials (orthogonality of Legendre polynomials on $[-1,1]$, the Legendre differential equation, and basic facts about Gaussian quadrature constructed from orthogonal polynomials), do the following:\n\n1) Show that $p_{N}(x)$ is a polynomial of degree $2N-2$ and compute the exact integral\n$$I \\coloneqq \\int_{-1}^{1} p_{N}(x)\\,dx,$$\nin closed form as a function of $N$.\n\n2) Consider the $N$-point Legendre–Gauss–Lobatto (LGL) quadrature, whose $N$ nodes comprise the endpoints $x=-1$ and $x=1$ together with the $N-2$ interior nodes given by the zeros of $P_{N-1}'(x)$. Evaluate the LGL quadrature approximation of $\\int_{-1}^{1} p_{N}(x)\\,dx$ and compare it to $I$.\n\n3) Consider the $N$-point Legendre–Gauss (LG) quadrature, whose $N$ nodes are the zeros of $P_{N}(x)$. Explain whether the LG quadrature exactly integrates $p_{N}(x)$ and justify your conclusion from first principles of orthogonal polynomial quadrature construction.\n\nReport, as your final answer, the Gauss–Lobatto quadrature error\n$$E_{N} \\coloneqq Q_{\\mathrm{LGL}}[p_{N}] - I,$$\nin a single closed-form expression in $N$. No rounding is required, and there are no physical units to report.",
            "solution": "**1) Degree of $p_N(x)$ and calculation of the integral $I$**\n\nFirst, we determine the degree of the polynomial $p_{N}(x) \\coloneqq (1 - x^{2})\\left[P_{N-1}'(x)\\right]^{2}$.\nThe Legendre polynomial $P_{n}(x)$ is a polynomial of degree $n$. Therefore, $P_{N-1}(x)$ is a polynomial of degree $N-1$. Its derivative, $P_{N-1}'(x)$, is a polynomial of degree $N-2$. Consequently, the square of the derivative, $\\left[P_{N-1}'(x)\\right]^{2}$, is a polynomial of degree $2(N-2) = 2N-4$. The term $(1-x^2)$ is a polynomial of degree $2$. Thus, $p_N(x)$ is the product of a polynomial of degree $2N-4$ and a polynomial of degree $2$. The degree of $p_N(x)$ is the sum of these degrees, which is $(2N-4) + 2 = 2N-2$.\n\nNext, we compute the exact value of the integral $I \\coloneqq \\int_{-1}^{1} p_{N}(x)\\,dx$.\n$$I = \\int_{-1}^{1} (1 - x^{2})\\left[P_{N-1}'(x)\\right]^{2}\\,dx$$\nWe can solve this integral using integration by parts. Let $u = (1-x^2)P'_{N-1}(x)$ and $dv = P'_{N-1}(x)\\,dx$. Then $v = P_{N-1}(x)$ and $du = \\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right]\\,dx$.\nThe integration by parts formula $\\int u \\,dv = uv - \\int v \\,du$ yields:\n$$I = \\left[ (1-x^2)P'_{N-1}(x)P_{N-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{N-1}(x) \\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right]\\,dx$$\nThe boundary term vanishes because the factor $(1-x^2)$ is zero at $x=-1$ and $x=1$. So, we have:\n$$I = - \\int_{-1}^{1} P_{N-1}(x) \\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right]\\,dx$$\nNow, we use a fundamental property of Legendre polynomials: they are solutions to the Legendre differential equation, which can be written in self-adjoint form as:\n$$\\frac{d}{dx}\\left[(1-x^2)\\frac{dP_n(x)}{dx}\\right] + n(n+1)P_n(x) = 0$$\nRearranging this for $n=N-1$, we get:\n$$\\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right] = -(N-1)((N-1)+1)P_{N-1}(x) = -N(N-1)P_{N-1}(x)$$\nSubstituting this expression back into the integral for $I$:\n$$I = - \\int_{-1}^{1} P_{N-1}(x) \\left[-N(N-1)P_{N-1}(x)\\right]\\,dx = N(N-1) \\int_{-1}^{1} \\left[P_{N-1}(x)\\right]^{2}\\,dx$$\nThe final step is to use the orthogonality property of Legendre polynomials on the interval $[-1,1]$:\n$$\\int_{-1}^{1} P_m(x) P_n(x) \\,dx = \\frac{2}{2n+1}\\delta_{mn}$$\nFor $m=n=N-1$, this gives:\n$$\\int_{-1}^{1} \\left[P_{N-1}(x)\\right]^{2}\\,dx = \\frac{2}{2(N-1)+1} = \\frac{2}{2N-1}$$\nSubstituting this result into our expression for $I$:\n$$I = N(N-1) \\left(\\frac{2}{2N-1}\\right) = \\frac{2N(N-1)}{2N-1}$$\n\n**2) Legendre–Gauss–Lobatto (LGL) Quadrature Approximation**\n\nThe $N$-point Legendre–Gauss–Lobatto quadrature rule, $Q_{\\mathrm{LGL}}[f] = \\sum_{j=1}^{N} w_j f(x_j)$, is designed to be exact for polynomials of degree up to $2N-3$. The nodes $\\{x_j\\}_{j=1}^N$ are the endpoints $x_1 = -1$, $x_N = 1$, and the $N-2$ roots of $P_{N-1}'(x)$. We want to evaluate $Q_{\\mathrm{LGL}}[p_N]$.\nThe integrand is $p_N(x) = (1-x^2)[P_{N-1}'(x)]^2$. We must evaluate this function at the LGL nodes.\n\n- For the interior nodes, $x_j$ for $j=2, \\dots, N-1$: By definition, these are the roots of $P_{N-1}'(x)$, so $P_{N-1}'(x_j)=0$. Therefore, $p_N(x_j) = (1-x_j^2)[P_{N-1}'(x_j)]^2 = (1-x_j^2) \\cdot 0^2 = 0$.\n- For the endpoint nodes, $x_1 = -1$ and $x_N = 1$: The factor $(1-x^2)$ in $p_N(x)$ becomes $(1-(\\pm 1)^2) = 0$. Therefore, $p_N(-1) = 0$ and $p_N(1) = 0$.\n\nSince the integrand $p_N(x)$ is zero at all $N$ LGL quadrature nodes, the quadrature sum is:\n$$Q_{\\mathrm{LGL}}[p_N] = \\sum_{j=1}^N w_j p_N(x_j) = \\sum_{j=1}^N w_j \\cdot 0 = 0$$\nComparing this approximation to the exact integral $I = \\frac{2N(N-1)}{2N-1}$, we see they are not equal for $N \\geq 3$. This is expected, as the degree of $p_N(x)$ is $2N-2$, which is greater than the degree of exactness ($2N-3$) of the $N$-point LGL rule.\n\n**3) Legendre–Gauss (LG) Quadrature Exactness**\n\nThe $N$-point Legendre-Gauss quadrature rule is constructed to be exact for polynomials of degree up to $2N-1$. As we established in part 1, the degree of the polynomial $p_N(x)$ is $2N-2$. Since $2N-2 \\leq 2N-1$, the $N$-point LG quadrature rule will integrate $p_N(x)$ exactly.\n\nTo justify this from first principles, let $f(x)$ be any polynomial of degree at most $2N-1$. The $N$ nodes $\\{x_i\\}_{i=1}^N$ of the LG quadrature are the zeros of the Legendre polynomial $P_N(x)$. By polynomial long division, we can write $f(x)$ as:\n$$f(x) = q(x)P_N(x) + r(x)$$\nwhere $q(x)$ and $r(x)$ are the quotient and remainder polynomials, respectively. Since $\\text{deg}(f) \\le 2N-1$ and $\\text{deg}(P_N) = N$, the degrees of the quotient and remainder are at most $N-1$.\nThe exact integral of $f(x)$ is:\n$$\\int_{-1}^1 f(x) \\,dx = \\int_{-1}^1 \\left(q(x)P_N(x) + r(x)\\right) \\,dx = \\int_{-1}^1 q(x)P_N(x) \\,dx + \\int_{-1}^1 r(x) \\,dx$$\nSince $q(x)$ is a polynomial of degree at most $N-1$, it can be expressed as a linear combination of Legendre polynomials $\\{P_k(x)\\}_{k=0}^{N-1}$. Due to the orthogonality property, $\\int_{-1}^1 P_k(x) P_N(x) \\,dx = 0$ for all $k < N$. Therefore, the first integral is zero: $\\int_{-1}^1 q(x)P_N(x) \\,dx = 0$. This leaves:\n$$\\int_{-1}^1 f(x) \\,dx = \\int_{-1}^1 r(x) \\,dx$$\nThe LG quadrature sum for $f(x)$ is $Q_{\\mathrm{LG}}[f] = \\sum_{i=1}^N w_i f(x_i)$. At the LG nodes $x_i$, we have $P_N(x_i)=0$, so $f(x_i) = q(x_i)P_N(x_i) + r(x_i) = r(x_i)$. The quadrature sum becomes:\n$$Q_{\\mathrm{LG}}[f] = \\sum_{i=1}^N w_i r(x_i) = Q_{\\mathrm{LG}}[r]$$\nBy construction, the $N$-point LG quadrature with appropriately chosen weights $w_i$ is exact for any polynomial of degree up to $N-1$. Since $\\text{deg}(r) \\le N-1$, we have $Q_{\\mathrm{LG}}[r] = \\int_{-1}^1 r(x) \\,dx$.\nCombining these results, we get $Q_{\\mathrm{LG}}[f] = \\int_{-1}^1 f(x) \\,dx$ for any polynomial $f(x)$ of degree up to $2N-1$.\nSince $p_N(x)$ is a polynomial of degree $2N-2$, this general principle confirms that the $N$-point Legendre-Gauss quadrature integrates $p_N(x)$ exactly.\n\n**Computation of the Error $E_N$**\n\nThe final task is to compute the Gauss-Lobatto quadrature error, defined as $E_N \\coloneqq Q_{\\mathrm{LGL}}[p_{N}] - I$.\nFrom our work in part 1 and part 2:\n- $I = \\frac{2N(N-1)}{2N-1}$\n- $Q_{\\mathrm{LGL}}[p_N] = 0$\n\nTherefore, the error is:\n$$E_N = 0 - \\frac{2N(N-1)}{2N-1} = -\\frac{2N(N-1)}{2N-1}$$\nThis is the required closed-form expression for the error as a function of $N$.",
            "answer": "$$\\boxed{-\\frac{2N(N-1)}{2N-1}}$$"
        }
    ]
}