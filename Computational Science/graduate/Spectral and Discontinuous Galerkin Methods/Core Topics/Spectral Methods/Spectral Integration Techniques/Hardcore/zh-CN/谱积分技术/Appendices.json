{
    "hands_on_practices": [
        {
            "introduction": "现实世界中的科学与工程问题本质上是多维的。将一维谱方法的高精度特性推广到二维或三维区域是至关重要的。本练习将通过一个具体实例，引导您实践张量积求积（tensor-product quadrature）这一基本技术，它是处理矩形或立方体域上问题的谱元法和间断Galerkin方法的核心。",
            "id": "3418941",
            "problem": "考虑在谱元法和间断 Galerkin 方法中使用的参考方形单元，其坐标为 $(x,y) \\in [-1,1] \\times [-1,1]$。在此背景下，采用求积法则来尽可能地对多项式进行精确积分。与 Legendre 多项式相关的高斯求积法则，即高斯-勒让德求积（Gauss–Legendre Quadrature, GLQ），具有一个经过充分验证的特性：当使用 $N$ 个点时，它对于次数最高为 $2N-1$ 的一维多项式是精确的。一维 GLQ 法则的张量积被用来在张量积域（例如参考方形）上构造多维求积。\n\n从 Fubini 定理和 GLQ 的精确性定义出发，使用每方向 $N_x = N_y = 3$ 个点的张量积 GLQ 计算二重积分\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\n然后，根据分别应用于 $x$ 和 $y$ 方向的一维法则，验证为何张量积 GLQ 对此被积函数是精确的。将积分的最终值表示为一个精确的实数。",
            "solution": "该问题要求使用张量积高斯-勒让德求积（GLQ）法则计算在参考方形单元上的一个二重积分，并验证结果的精确性。\n\n需要计算的积分是\n$$\nI = \\int_{-1}^{1}\\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\n被积函数为 $f(x,y) = x^3 y^4$。由于该被积函数是其变量的可分离函数，$f(x,y) = p_x(x) p_y(y)$，其中 $p_x(x) = x^3$ 且 $p_y(y) = y^4$，并且积分区域是区间的笛卡尔积，我们可以应用 Fubini 定理将二重积分分离为两个一维积分的乘积：\n$$\nI = \\left( \\int_{-1}^{1} x^{3} \\, dx \\right) \\left( \\int_{-1}^{1} y^{4} \\, dy \\right)\n$$\n张量积求积法则通过对每个积分分别应用一维求积法则来逼近此结构。在参考方形上的张量积求积的一般形式为：\n$$\nI \\approx I_{GLQ} = \\sum_{i=1}^{N_y} \\sum_{j=1}^{N_x} w_j w_i f(x_j, y_i)\n$$\n其中 $\\{x_j, w_j\\}_{j=1}^{N_x}$ 是 $x$ 方向的求积点和权重，而 $\\{y_i, w_i\\}_{i=1}^{N_y}$ 是 $y$ 方向的求积点和权重。由于被积函数的可分离性，这个求和可以被分解为：\n$$\nI_{GLQ} = \\left( \\sum_{j=1}^{N_x} w_j p_x(x_j) \\right) \\left( \\sum_{i=1}^{N_y} w_i p_y(y_i) \\right)\n$$\n题目指定了在 $x$ 方向有 $N_x = 3$ 个点，在 $y$ 方向有 $N_y = 3$ 个点的高斯-勒让德求积。对于一个 3 点 GLQ（$N=3$），求积点是 3 次 Legendre 多项式 $P_3(z) = \\frac{1}{2}(5z^3 - 3z)$ 的根。这些根是 $z_1 = -\\sqrt{\\frac{3}{5}}$，$z_2 = 0$ 和 $z_3 = \\sqrt{\\frac{3}{5}}$。\n对应的权重是 $w_1 = \\frac{5}{9}$，$w_2 = \\frac{8}{9}$ 和 $w_3 = \\frac{5}{9}$。\n\n我们将此法则应用于每个一维积分。\n\n首先，对于 $x$ 方向的积分，其中 $p_x(x) = x^3$：\n$$\n\\int_{-1}^{1} x^3 \\, dx \\approx \\sum_{j=1}^{3} w_j x_j^3 = w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3\n$$\n代入求积点和权重：\n$$\n\\sum_{j=1}^{3} w_j x_j^3 = \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^3 + \\left(\\frac{8}{9}\\right) (0)^3 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^3\n$$\n$$\n= \\frac{5}{9} \\left(-\\frac{3\\sqrt{3}}{5\\sqrt{5}}\\right) + 0 + \\frac{5}{9} \\left(\\frac{3\\sqrt{3}}{5\\sqrt{5}}\\right) = -\\frac{3\\sqrt{3}}{9\\sqrt{5}} + \\frac{3\\sqrt{3}}{9\\sqrt{5}} = 0\n$$\n\n其次，对于 $y$ 方向的积分，其中 $p_y(y) = y^4$：\n$$\n\\int_{-1}^{1} y^4 \\, dy \\approx \\sum_{i=1}^{3} w_i y_i^4 = w_1 y_1^4 + w_2 y_2^4 + w_3 y_3^4\n$$\n代入求积点和权重：\n$$\n\\sum_{i=1}^{3} w_i y_i^4 = \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^4 + \\left(\\frac{8}{9}\\right) (0)^4 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^4\n$$\n$$\n= \\frac{5}{9} \\left(\\frac{9}{25}\\right) + 0 + \\frac{5}{9} \\left(\\frac{9}{25}\\right) = 2 \\left(\\frac{5 \\cdot 9}{9 \\cdot 25}\\right) = 2 \\left(\\frac{5}{25}\\right) = \\frac{2}{5}\n$$\n\n通过张量积 GLQ 计算出的二重积分的值是这两个结果的乘积：\n$$\nI_{GLQ} = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\n\n接下来，我们验证这个结果的精确性。具有 $N$ 个点的一维高斯-勒让德求积法则对次数最高为 $2N-1$ 的任意多项式都是精确的。\n\n对于 $x$ 方向，我们使用 $N_x = 3$ 个点来积分多项式 $p_x(x) = x^3$。该多项式的次数为 $d_x = 3$。该法则对于次数最高为 $2N_x - 1 = 2(3) - 1 = 5$ 的多项式是精确的。由于 $d_x = 3 \\le 5$，因此对 $x$ 积分的求积是精确的。其精确值为 $\\int_{-1}^{1} x^3 \\, dx = \\left[\\frac{x^4}{4}\\right]_{-1}^{1} = \\frac{1}{4} - \\frac{1}{4} = 0$，与求积结果相符。\n\n对于 $y$ 方向，我们使用 $N_y = 3$ 个点来积分多项式 $p_y(y) = y^4$。该多项式的次数为 $d_y = 4$。该法则对于次数最高为 $2N_y - 1 = 2(3) - 1 = 5$ 的多项式是精确的。由于 $d_y = 4 \\le 5$，因此对 $y$ 积分的求积也是精确的。其精确值为 $\\int_{-1}^{1} y^4 \\, dy = \\left[\\frac{y^5}{5}\\right]_{-1}^{1} = \\frac{1}{5} - \\frac{-1}{5} = \\frac{2}{5}$，与求积结果相符。\n\n由于张量积 GLQ 等价于两个一维 GLQ 计算的乘积，并且每个一维计算对其各自的多项式因子都是精确的，因此最终结果是精确的。该二重积分的精确值是一维积分精确值的乘积：\n$$\nI_{exact} = \\left( \\int_{-1}^{1} x^{3} \\, dx \\right) \\left( \\int_{-1}^{1} y^{4} \\, dy \\right) = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\n这证实了 $I_{GLQ} = 0$ 是该积分的精确值。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "将抽象的求积法则与求解偏微分方程的具体实践联系起来是理解谱方法的关键一步。数值解的精度在很大程度上依赖于质量矩阵和刚度矩阵中积分的精确计算。本练习将指导您推导在间断Galerkin (DG)方法中选择求积点数的“经验法则”，从而确保离散系统的准确性。",
            "id": "3418922",
            "problem": "考虑在参考单元 $\\left[-1,1\\right]$ 上的一维间断 Galerkin (DG) 离散，使用次数至多为 $p \\in \\mathbb{N}_{0}$ 的多项式逼近空间。令 $\\{\\phi_{i}(x)\\}_{i=0}^{p}$ 为张成该空间的任意一组基。单元质量矩阵和（体积）刚度矩阵由以下双线性形式定义\n$$\nM_{ij} \\equiv \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x, \n\\qquad\nK_{ij} \\equiv \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,\\mathrm{d}x.\n$$\n假设数值积分使用具有 $N$ 个内部点的标准高斯 (Gauss–Legendre) 求积或包含端点的 $N$ 点 Gauss–Lobatto–Legendre 求积来执行。仅从以下基本依据出发：\n- 多项式乘积和导数的次数性质，\n- 求积法则对多项式精确的定义，\n推导每个求积法则为精确计算所有 $i,j \\in \\{0,\\dots,p\\}$ 的质量矩阵元 $M_{ij}$ 所需的最小求积点数 $N$。然后，使用相同的推理，确定精确计算（体积）刚度矩阵元 $K_{ij}$ 所需的最小 $N$，并解释当选择保证质量矩阵精确性的 $N$ 时，对刚度矩阵精确性的影响。\n\n将质量矩阵精确性所需的 $\\left(N_{\\text{Gauss}},\\,N_{\\text{Gauss–Lobatto}}\\right)$ 对，用 $p$ 的符号表示，并使用 $\\texttt{pmatrix}$ 写成一个单行矩阵作为最终答案。不需要进行数值计算。",
            "solution": "该问题要求推导两种求积法则在参考单元上的间断 Galerkin 框架中精确计算质量矩阵和刚度矩阵所需的最小求积点数 $N$。解法将从关于多项式次数和求积法则精确性的第一性原理推导得出。\n\n令 $\\mathcal{P}_k$ 表示次数至多为 $k$ 的多项式空间。问题指出，逼近空间是次数至多为 $p$ 的多项式集合，其中 $p \\in \\mathbb{N}_0 = \\{0, 1, 2, \\dots\\}$。基函数 $\\{\\phi_i(x)\\}_{i=0}^{p}$ 张成这个空间，因此每个 $\\phi_i(x) \\in \\mathcal{P}_p$。\n\n我们将使用的基本性质如下：\n1.  **乘积的次数**：如果 $f(x) \\in \\mathcal{P}_{d_1}$ 且 $g(x) \\in \\mathcal{P}_{d_2}$，它们的乘积 $f(x)g(x)$ 是一个 $\\mathcal{P}_{d_1+d_2}$ 中的多项式。\n2.  **导数的次数**：如果 $f(x) \\in \\mathcal{P}_d$ 且 $d \\ge 1$，其导数 $f'(x)$ 是一个 $\\mathcal{P}_{d-1}$ 中的多项式。如果 $f(x) \\in \\mathcal{P}_0$（一个常数），则 $f'(x) = 0$。\n3.  **高斯求积的精确性**：具有 $N$ 个点的标准 Gauss-Legendre 求积法则对次数至多为 $2N-1$ 的任意多项式都是精确的。\n4.  **Gauss-Lobatto-Legendre 求积的精确性**：具有 $N$ 个点的 Gauss-Lobatto-Legendre 求积法则对次数至多为 $2N-3$ 的任意多项式都是精确的。\n\n**第一部分：质量矩阵 ($M_{ij}$) 的精确积分**\n\n质量矩阵的元素由积分 $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$ 定义。被积函数是乘积 $\\phi_{i}(x)\\phi_{j}(x)$。\n由于 $\\phi_i(x) \\in \\mathcal{P}_p$ 且 $\\phi_j(x) \\in \\mathcal{P}_p$，它们的乘积是一个多项式。当两个基函数的次数都达到最大值 $p$ 时，该乘积的次数最高。在这种情况下，被积函数的次数是 $p+p=2p$。因此，为了精确计算所有的矩阵元 $M_{ij}$，求积法则必须对所有次数最高为 $2p$ 的多项式都精确。\n\n*   **对于 Gauss-Legendre 求积：**\n    我们要求该法则对次数至多为 $2p$ 的多项式精确。条件是：\n    $$2N - 1 \\ge 2p$$\n    解出 $N$：\n    $$2N \\ge 2p + 1 \\implies N \\ge p + \\frac{1}{2}$$\n    由于求积点数 $N$ 必须是整数，最小点数为 $N_{\\text{Gauss}} = \\lceil p + \\frac{1}{2} \\rceil = p+1$。\n\n*   **对于 Gauss-Lobatto-Legendre 求积：**\n    我们同样要求该法则对次数至多为 $2p$ 的多项式精确。条件是：\n    $$2N - 3 \\ge 2p$$\n    解出 $N$：\n    $$2N \\ge 2p + 3 \\implies N \\ge p + \\frac{3}{2}$$\n    由于 $N$ 必须是整数，最小点数为 $N_{\\text{Gauss-Lobatto}} = \\lceil p + \\frac{3}{2} \\rceil = p+2$。\n\n**第二部分：刚度矩阵 ($K_{ij}$) 的精确积分**\n\n刚度矩阵的元素由 $K_{ij} = \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,\\mathrm{d}x$ 定义。被积函数是乘积 $\\phi_{i}'(x)\\phi_{j}'(x)$。\n由于 $\\phi_i(x) \\in \\mathcal{P}_p$，其导数 $\\phi_i'(x)$ 是一个次数至多为 $p-1$ 的多项式。类似地，$\\phi_j'(x) \\in \\mathcal{P}_{p-1}$。这对 $p \\ge 1$ 成立。如果 $p=0$，基函数是常数，其导数为零，被积函数恒为零。\n对于 $p \\ge 1$，乘积 $\\phi_i'(x)\\phi_j'(x)$ 是一个次数至多为 $(p-1)+(p-1) = 2p-2$ 的多项式。对于 $p=0$，被积函数是零多项式，其次数为 $-\\infty$。零的积分是零，任何至少有一个点 ($N \\ge 1$) 的求积法则都能精确计算它。\n因此，如果 $p \\ge 1$，求积法则必须对次数最高为 $2p-2$ 的多项式精确；如果 $p=0$，则必须对零多项式精确。\n\n*   **对于 Gauss-Legendre 求积：**\n    对于 $p \\ge 1$，我们要求精确到 $2p-2$ 次：\n    $$2N - 1 \\ge 2p - 2 \\implies 2N \\ge 2p - 1 \\implies N \\ge p - \\frac{1}{2}$$\n    最小整数是 $N=p$。\n    对于 $p=0$，我们需要 $N \\ge 1$。公式 $N=p$ 给出 $N=0$，这不是一个有效的点数。\n    因此，对于 $p=0$，最小点数为 $N=1$，对于 $p \\ge 1$，最小点数为 $N=p$。这可以紧凑地写成 $N_{\\text{Gauss, stiff}} = \\max(1, p)$。\n\n*   **对于 Gauss-Lobatto-Legendre 求积：**\n    对于 $p \\ge 1$，我们要求精确到 $2p-2$ 次：\n    $$2N - 3 \\ge 2p - 2 \\implies 2N \\ge 2p + 1 \\implies N \\ge p + \\frac{1}{2}$$\n    最小整数是 $N=p+1$。\n    对于 $p=0$，最小的 $N$ 是 $1$。公式 $N=p+1$ 给出 $N=1$，因此它也对 $p=0$ 成立。\n    因此，对所有 $p \\in \\mathbb{N}_0$，最小点数为 $N_{\\text{Gauss-Lobatto, stiff}} = p+1$。\n\n**第三部分：对刚度矩阵精确性的影响**\n\n问题询问，如果选择一个保证质量矩阵精确性的 $N$，这对刚度矩阵的计算有何影响。\n\n*   **使用 Gauss-Legendre：**\n    我们选择 $N = p+1$ 来精确积分质量矩阵。如此选择，求积法则对次数至多为 $2(p+1) - 1 = 2p+1$ 的多项式是精确的。刚度矩阵被积函数的最高次数为 $2p-2$。由于对所有 $p \\ge 0$ 都有 $2p+1 \\ge 2p-2$（不等式为 $3 \\ge 0$），该求积法则足以精确积分刚度矩阵的被积函数。\n\n*   **使用 Gauss-Lobatto-Legendre：**\n    我们选择 $N = p+2$ 来精确积分质量矩阵。该法则对次数至多为 $2(p+2) - 3 = 2p+1$ 的多项式是精确的。同样，刚度矩阵被积函数的最高次数为 $2p-2$。由于对所有 $p \\ge 0$ 都有 $2p+1 \\ge 2p-2$，这个 $N$ 的选择也保证了刚度矩阵的精确积分。\n\n**结论：**\n在两种情况下（Gauss-Legendre 和 Gauss-Lobatto-Legendre），选择精确积分质量矩阵所需的最小求积点数 $N$ 会自动确保（体积）刚度矩阵也能被精确计算。这是因为质量矩阵被积函数的多项式次数 ($2p$) 总是大于刚度矩阵被积函数的多项式次数 ($2p-2$)。最终答案是为保证质量矩阵精确性所需的最小点数对。\n对于 Gauss-Legendre, $N_{\\text{Gauss}} = p+1$。\n对于 Gauss-Lobatto-Legendre, $N_{\\text{Gauss-Lobatto}} = p+2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np+1  p+2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在数值积分工具箱中，选择正确的工具至关重要。虽然存在多种高斯型求积法则，但它们各自的特性可能导致截然不同的计算结果。本练习通过一个精心构造的多项式，揭示了标准高斯求积与高斯-洛巴托（Gauss-Lobatto）求积在精度阶上的细微而关键的差异，从而加深对每种方法理论基础的理解。",
            "id": "3418953",
            "problem": "设 $N \\geq 3$ 为一个整数，并考虑区间 $[-1,1]$ 上的勒让德多项式 $\\{P_{k}(x)\\}_{k=0}^{\\infty}$，其定义为满足勒让德微分方程和归一化条件 $P_{0}(x)=1$ 的唯一多项式序列。定义多项式\n$$p_{N}(x) \\coloneqq (1 - x^{2})\\left[P_{N-1}'(x)\\right]^{2}.$$\n仅使用正交多项式的基本性质（勒让德多项式在 $[-1,1]$ 上的正交性、勒让德微分方程，以及关于由正交多项式构造的高斯求积的基本事实），完成以下任务：\n\n1) 证明 $p_{N}(x)$ 是一个次数为 $2N-2$ 的多项式，并以 $N$ 的闭式函数形式计算精确积分\n$$I \\coloneqq \\int_{-1}^{1} p_{N}(x)\\,dx。$$\n\n2) 考虑 $N$ 点勒让德-高斯-洛巴托（LGL）求积，其 $N$ 个节点包括端点 $x=-1$ 和 $x=1$ 以及由 $P_{N-1}'(x)$ 的零点给出的 $N-2$ 个内部节点。计算 $\\int_{-1}^{1} p_{N}(x)\\,dx$ 的 LGL 求积近似值，并将其与 $I$ 进行比较。\n\n3) 考虑 $N$ 点勒让德-高斯（LG）求积，其 $N$ 个节点是 $P_{N}(x)$ 的零点。解释 LG 求积是否能精确积分 $p_{N}(x)$，并根据正交多项式求积构造的第一性原理证明你的结论。\n\n作为最终答案，报告高斯-洛巴托求积误差\n$$E_{N} \\coloneqq Q_{\\mathrm{LGL}}[p_{N}] - I,$$\n以 $N$ 的单个闭式表达式给出。无需四舍五入，也无需报告物理单位。",
            "solution": "该问题已经过验证，被认为是合理的。这是一个在数值分析领域中适定的问题，具体涉及勒让德多项式的性质及相关的高斯求积法则。所有定义都是标准的，问题是自洽的且数学上一致的。\n\n我们被要求执行三个任务，然后计算一个最终量。让我们按顺序处理每个部分。\n\n**1) $p_N(x)$ 的次数和积分 $I$ 的计算**\n\n首先，我们确定多项式 $p_{N}(x) \\coloneqq (1 - x^{2})\\left[P_{N-1}'(x)\\right]^{2}$ 的次数。\n勒让德多项式 $P_{n}(x)$ 是一个 $n$ 次多项式。因此，$P_{N-1}(x)$ 是一个 $N-1$ 次多项式。其导数 $P_{N-1}'(x)$ 是一个 $N-2$ 次多项式。因此，导数的平方 $\\left[P_{N-1}'(x)\\right]^{2}$ 是一个次数为 $2(N-2) = 2N-4$ 的多项式。项 $(1-x^2)$ 是一个 2 次多项式。因此，$p_N(x)$ 是一个 $2N-4$ 次多项式和一个 2 次多项式的乘积。$p_N(x)$ 的次数是这些次数之和，即 $(2N-4) + 2 = 2N-2$。\n\n接下来，我们计算积分 $I \\coloneqq \\int_{-1}^{1} p_{N}(x)\\,dx$ 的精确值。\n$$I = \\int_{-1}^{1} (1 - x^{2})\\left[P_{N-1}'(x)\\right]^{2}\\,dx$$\n我们可以使用分部积分法来求解这个积分。设 $u = (1-x^2)P'_{N-1}(x)$ 和 $dv = P'_{N-1}(x)\\,dx$。则 $v = P_{N-1}(x)$ 且 $du = \\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right]\\,dx$。\n分部积分公式 $\\int u \\,dv = uv - \\int v \\,du$ 得出：\n$$I = \\left[ (1-x^2)P'_{N-1}(x)P_{N-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{N-1}(x) \\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right]\\,dx$$\n边界项消失，因为因子 $(1-x^2)$ 在 $x=-1$ 和 $x=1$ 处为零。所以，我们有：\n$$I = - \\int_{-1}^{1} P_{N-1}(x) \\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right]\\,dx$$\n现在，我们使用勒让德多项式的一个基本性质：它们是勒让德微分方程的解，该方程可以写成自伴随形式：\n$$\\frac{d}{dx}\\left[(1-x^2)\\frac{dP_n(x)}{dx}\\right] + n(n+1)P_n(x) = 0$$\n对 $n=N-1$ 重新整理此式，我们得到：\n$$\\frac{d}{dx}\\left[(1-x^2)P'_{N-1}(x)\\right] = -(N-1)((N-1)+1)P_{N-1}(x) = -N(N-1)P_{N-1}(x)$$\n将此表达式代回 $I$ 的积分中：\n$$I = - \\int_{-1}^{1} P_{N-1}(x) \\left[-N(N-1)P_{N-1}(x)\\right]\\,dx = N(N-1) \\int_{-1}^{1} \\left[P_{N-1}(x)\\right]^{2}\\,dx$$\n最后一步是使用勒让德多项式在区间 $[-1,1]$ 上的正交性：\n$$\\int_{-1}^{1} P_m(x) P_n(x) \\,dx = \\frac{2}{2n+1}\\delta_{mn}$$\n对于 $m=n=N-1$，这给出：\n$$\\int_{-1}^{1} \\left[P_{N-1}(x)\\right]^{2}\\,dx = \\frac{2}{2(N-1)+1} = \\frac{2}{2N-1}$$\n将此结果代入我们关于 $I$ 的表达式中：\n$$I = N(N-1) \\left(\\frac{2}{2N-1}\\right) = \\frac{2N(N-1)}{2N-1}$$\n\n**2) 勒让德-高斯-洛巴托（LGL）求积近似**\n\n$N$ 点勒让德-高斯-洛巴托求积法则 $Q_{\\mathrm{LGL}}[f] = \\sum_{j=1}^{N} w_j f(x_j)$ 被设计为对次数最高为 $2N-3$ 的多项式是精确的。其节点 $\\{x_j\\}_{j=1}^N$ 是端点 $x_1 = -1$、$x_N = 1$ 以及 $P_{N-1}'(x)$ 的 $N-2$ 个根。我们要计算 $Q_{\\mathrm{LGL}}[p_N]$。\n被积函数是 $p_N(x) = (1-x^2)[P_{N-1}'(x)]^2$。我们必须在 LGL 节点上计算这个函数的值。\n\n- 对于内部节点，$x_j$（$j=2, \\dots, N-1$）：根据定义，这些是 $P_{N-1}'(x)$ 的根，所以 $P_{N-1}'(x_j)=0$。因此，$p_N(x_j) = (1-x_j^2)[P_{N-1}'(x_j)]^2 = (1-x_j^2) \\cdot 0^2 = 0$。\n- 对于端点节点，$x_1 = -1$ 和 $x_N = 1$：$p_N(x)$ 中的因子 $(1-x^2)$ 变为 $(1-(\\pm 1)^2) = 0$。因此，$p_N(-1) = 0$ 且 $p_N(1) = 0$。\n\n由于被积函数 $p_N(x)$ 在所有 $N$ 个 LGL 求积节点上都为零，因此求积和为：\n$$Q_{\\mathrm{LGL}}[p_N] = \\sum_{j=1}^N w_j p_N(x_j) = \\sum_{j=1}^N w_j \\cdot 0 = 0$$\n将此近似值与精确积分 $I = \\frac{2N(N-1)}{2N-1}$ 进行比较，我们发现对于 $N \\geq 3$，它们不相等。这是预料之中的，因为 $p_N(x)$ 的次数是 $2N-2$，它大于 $N$ 点 LGL 法则的精确次数（$2N-3$）。\n\n**3) 勒让德-高斯（LG）求积的精确性**\n\n$N$ 点勒让德-高斯求积法则是为对次数最高为 $2N-1$ 的多项式精确而构造的。正如我们在第 1 部分所确定的，$p_N(x)$ 多项式的次数为 $2N-2$。由于 $2N-2 \\leq 2N-1$，因此 $N$ 点 LG 求积法则将精确地积分 $p_N(x)$。\n\n为了从第一性原理证明这一点，设 $f(x)$ 是任意一个次数至多为 $2N-1$ 的多项式。LG 求积的 $N$ 个节点 $\\{x_i\\}_{i=1}^N$ 是勒让德多项式 $P_N(x)$ 的零点。通过多项式长除法，我们可以将 $f(x)$ 写成：\n$$f(x) = q(x)P_N(x) + r(x)$$\n其中 $q(x)$ 和 $r(x)$ 分别是商式和余式多项式。由于 $\\text{deg}(f) \\le 2N-1$ 且 $\\text{deg}(P_N) = N$，商式和余式的次数至多为 $N-1$。\n$f(x)$ 的精确积分为：\n$$\\int_{-1}^1 f(x) \\,dx = \\int_{-1}^1 \\left(q(x)P_N(x) + r(x)\\right) \\,dx = \\int_{-1}^1 q(x)P_N(x) \\,dx + \\int_{-1}^1 r(x) \\,dx$$\n由于 $q(x)$ 是一个次数至多为 $N-1$ 的多项式，它可以表示为勒让德多项式 $\\{P_k(x)\\}_{k=0}^{N-1}$ 的线性组合。由于正交性，对所有 $k  N$ 都有 $\\int_{-1}^1 P_k(x) P_N(x) \\,dx = 0$。因此，第一个积分为零：$\\int_{-1}^1 q(x)P_N(x) \\,dx = 0$。剩下：\n$$\\int_{-1}^1 f(x) \\,dx = \\int_{-1}^1 r(x) \\,dx$$\n$f(x)$ 的 LG 求积和为 $Q_{\\mathrm{LG}}[f] = \\sum_{i=1}^N w_i f(x_i)$。在 LG 节点 $x_i$ 处，我们有 $P_N(x_i)=0$，所以 $f(x_i) = q(x_i)P_N(x_i) + r(x_i) = r(x_i)$。求积和变为：\n$$Q_{\\mathrm{LG}}[f] = \\sum_{i=1}^N w_i r(x_i) = Q_{\\mathrm{LG}}[r]$$\n根据构造，具有适当选择的权重 $w_i$ 的 $N$ 点 LG 求积对于次数最高为 $N-1$ 的任何多项式都是精确的。由于 $\\text{deg}(r) \\le N-1$，我们有 $Q_{\\mathrm{LG}}[r] = \\int_{-1}^1 r(x) \\,dx$。\n结合这些结果，我们得到对于任意次数至多为 $2N-1$ 的多项式 $f(x)$，都有 $Q_{\\mathrm{LG}}[f] = \\int_{-1}^1 f(x) \\,dx$。\n由于 $p_N(x)$ 是一个次数为 $2N-2$ 的多项式，这个一般原理证实了 $N$ 点勒让德-高斯求积能精确地积分 $p_N(x)$。\n\n**误差 $E_N$ 的计算**\n\n最后的任务是计算高斯-洛巴托求积误差，定义为 $E_N \\coloneqq Q_{\\mathrm{LGL}}[p_{N}] - I$。\n根据我们在第 1 部分和第 2 部分的工作：\n- $I = \\frac{2N(N-1)}{2N-1}$\n- $Q_{\\mathrm{LGL}}[p_N] = 0$\n\n因此，误差为：\n$$E_N = 0 - \\frac{2N(N-1)}{2N-1} = -\\frac{2N(N-1)}{2N-1}$$\n这就是所要求的误差关于 $N$ 的闭式表达式。",
            "answer": "$$\\boxed{-\\frac{2N(N-1)}{2N-1}}$$"
        }
    ]
}