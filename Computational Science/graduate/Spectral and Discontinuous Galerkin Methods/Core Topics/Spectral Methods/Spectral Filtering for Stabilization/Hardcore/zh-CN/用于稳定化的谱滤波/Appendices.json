{
    "hands_on_practices": [
        {
            "introduction": "一个好的谱滤波器必须能有效抑制高频振荡，同时保留精确表示解的光滑部分的低频内容。本练习要求你通过推导满足特定低阶多项式精度要求所需的最小滤波器阶数，来量化这种权衡。通过这个过程，你将更深入地理解滤波器阶数（$m$）和强度（$\\alpha$）等参数如何控制其在整个频谱上的行为。",
            "id": "3418245",
            "problem": "考虑在标准单元 $[-1,1]$ 上使用标准正交 Legendre 多项式基的一维模态谱近似，该近似在模态指数 $N$ 处截断。设函数 $u(x)$ 的展开式为 $u(x) = \\sum_{k=0}^{N} a_{k} \\phi_{k}(x)$，其中 $\\{\\phi_{k}\\}_{k=0}^{N}$ 是标准正交模态，$a_{k}$ 是相应的模态系数。在间断伽辽金 (DG) 近似中，通过将模态系数乘以滤波器传递函数 $\\sigma_{k}$ 来实现谱滤波稳定。\n\n假设一个指数滤波器，其模态传递函数定义为\n$$\n\\sigma_{k} = \\exp\\!\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right),\n$$\n其中 $m > 0$ 是滤波器阶数，$\\alpha > 0$ 是滤波器强度。要求该滤波器在以下意义上近似保持所有次数至多为 $r$（其中 $0  r  N$）的多项式：对于任何模态系数为 $\\{a_{k}\\}_{k=0}^{r}$ 且当 $k>r$ 时 $a_{k}=0$ 的多项式 $p(x)$，滤波在所有保留模态上引起的相对模态扰动必须满足\n$$\n\\max_{0 \\leq k \\leq r} \\left|1 - \\sigma_{k}\\right| \\leq \\varepsilon,\n$$\n其中 $0  \\varepsilon  1$ 是一个给定的容差。假设 $\\alpha > -\\ln(1 - \\varepsilon)$，因此保持约束是非平凡的，并且要求 $m > 0$。\n\n从模态滤波器的基本定义出发，推导一个保证满足上述保持要求的最小阶数 $m$ 的闭式解析表达式。您的最终答案应该是一个用 $r$、$N$、$\\alpha$ 和 $\\varepsilon$ 表示的单一解析表达式。无需进行数值计算或四舍五入。将最终答案表示为单个表达式，且最终答案中不应包含不等式。",
            "solution": "目标是推导一个满足指定多项式保持要求的最小滤波器阶数 $m$ 的闭式解析表达式。\n\n问题陈述，对于一个次数至多为 $r$（其中 $0  r  N$）的多项式，其模态系数 $a_k$ 在 $k > r$ 时为零。滤波器的保持要求由以下不等式给出：\n$$\n\\max_{0 \\leq k \\leq r} |1 - \\sigma_{k}| \\leq \\varepsilon\n$$\n其中 $0  \\varepsilon  1$ 是一个给定的容差，$\\sigma_k$ 是滤波器的模态传递函数。\n\n滤波器被定义为一个指数滤波器：\n$$\n\\sigma_{k} = \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right)\n$$\n其中滤波器阶数 $m > 0$，滤波器强度 $\\alpha > 0$。指数 $k$ 是非负整数。\n\n首先，我们分析 $|1 - \\sigma_k|$ 这一项。对于 $k=0$，指数为 $-\\alpha(0/N)^m = 0$，所以 $\\sigma_0 = \\exp(0) = 1$。这得到 $|1 - \\sigma_0| = |1-1| = 0$。对于任何 $k > 0$，由于 $\\alpha > 0$ 和 $m > 0$，指数 $-\\alpha(k/N)^m$ 严格为负。因此，$0  \\sigma_k  1$。这意味着对于 $k > 0$，$1 - \\sigma_k$ 恒为正。因此，对于所有 $k \\ge 0$，绝对值是多余的：\n$$\n|1 - \\sigma_k| = 1 - \\sigma_k\n$$\n保持约束简化为：\n$$\n\\max_{0 \\leq k \\leq r} (1 - \\sigma_{k}) \\leq \\varepsilon\n$$\n接下来，我们确定在 $0 \\le k \\le r$ 范围内哪个 $k$ 值能使函数 $f(k) = 1 - \\sigma_k$ 最大化。我们将 $k$ 视为 $k \\ge 0$ 的连续实变量来分析 $f(k)$ 的单调性。该函数为：\n$$\nf(k) = 1 - \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right)\n$$\n我们计算 $f(k)$ 关于 $k$ 的导数：\n$$\n\\frac{df}{dk} = -\\frac{d}{dk} \\left[ \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right) \\right]\n$$\n使用链式法则，\n$$\n\\frac{df}{dk} = - \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right) \\cdot \\left(-\\alpha \\frac{m k^{m-1}}{N^m}\\right)\n$$\n$$\n\\frac{df}{dk} = \\left(\\frac{\\alpha m}{N^m}\\right) k^{m-1} \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right)\n$$\n鉴于 $\\alpha > 0$，$m > 0$，$N > 0$，前置因子 $(\\alpha m / N^m)$ 是正的。指数项总是正的。对于 $k \\ge 0$，项 $k^{m-1}$ 是非负的。仅当 $m>1$ 时，它在 $k=0$ 处为零；当 $m \\le 1$ 时，它在 $k>0$ 处为正。在所有 $k \\ge 0$ 的情况下，$\\frac{df}{dk} \\ge 0$。这表明 $f(k)$ 是一个关于 $k$ 的单调非减函数。\n\n对于一个离散整数值集合 $\\{0, 1, 2, ..., r\\}$，一个单调非减函数在该集合中的最大值处达到其最大值。因此，$f(k)$ 的最大值出现在 $k=r$ 处。\n$$\n\\max_{0 \\leq k \\leq r} (1 - \\sigma_{k}) = 1 - \\sigma_{r}\n$$\n保持约束简化为只涉及模态 $k=r$ 的单个不等式：\n$$\n1 - \\sigma_{r} \\leq \\varepsilon\n$$\n代入 $\\sigma_r$ 的表达式：\n$$\n1 - \\exp\\left(-\\alpha \\left(\\frac{r}{N}\\right)^{m}\\right) \\leq \\varepsilon\n$$\n我们现在针对滤波器阶数 $m$ 求解此不等式。整理各项，我们得到：\n$$\n1 - \\varepsilon \\leq \\exp\\left(-\\alpha \\left(\\frac{r}{N}\\right)^{m}\\right)\n$$\n由于 $0  \\varepsilon  1$，项 $1 - \\varepsilon$ 在 $0$ 和 $1$ 之间。我们可以对两边取自然对数。由于自然对数函数是单调递增的，不等式的方向保持不变：\n$$\n\\ln(1 - \\varepsilon) \\leq -\\alpha \\left(\\frac{r}{N}\\right)^{m}\n$$\n两边乘以 $-1$ 会使不等式反向：\n$$\n-\\ln(1 - \\varepsilon) \\geq \\alpha \\left(\\frac{r}{N}\\right)^{m}\n$$\n由于 $\\alpha > 0$，我们可以除以 $\\alpha$ 而不改变不等式方向：\n$$\n\\frac{-\\ln(1 - \\varepsilon)}{\\alpha} \\geq \\left(\\frac{r}{N}\\right)^{m}\n$$\n为了分离出 $m$，我们再次对两边取自然对数。问题陈述 $\\alpha > -\\ln(1 - \\varepsilon)$，这意味着左侧的 $\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}$ 是一个小于 $1$ 的正数。右侧幂的底数 $r/N$ 也介于 $0$ 和 $1$ 之间，因为 $0  r  N$。对一个介于 $0$ 和 $1$ 之间的数取自然对数会得到一个负数结果。\n$$\n\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right) \\geq \\ln\\left(\\left(\\frac{r}{N}\\right)^{m}\\right)\n$$\n使用对数性质 $\\ln(x^y) = y \\ln(x)$：\n$$\n\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right) \\geq m \\ln\\left(\\frac{r}{N}\\right)\n$$\n为了求解 $m$，我们必须除以 $\\ln(r/N)$。由于 $0  r  N$，我们有 $0  r/N  1$，这意味着 $\\ln(r/N)$ 是一个负数。除以一个负数会使不等号反向：\n$$\n\\frac{\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right)}{\\ln\\left(\\frac{r}{N}\\right)} \\leq m\n$$\n这个不等式提供了 $m$ 必须满足的条件。为了找到保证保持要求的最小阶数 $m$，我们选择 $m$ 的最小可能值，即这个不等式的下界。\n$$\nm_{\\text{min}} = \\frac{\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right)}{\\ln\\left(\\frac{r}{N}\\right)}\n$$\n该表达式为最小滤波器阶数 $m$ 提供了所要求的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right)}{\\ln\\left(\\frac{r}{N}\\right)}}$$"
        },
        {
            "introduction": "虽然滤波对于保证稳定性至关重要，但它并非没有代价，有时会干扰高阶数值格式的优良特性。本练习将探讨一个关键例子：在单元边界处超收敛性的丧失，而这些点对于间断 Galerkin 方法中通量的精确计算至关重要。通过分析这个具体案例，你将学会认识到与稳定性相关的微妙代价，并理解滤波对方法底层精度的影响。",
            "id": "3418287",
            "problem": "考虑标量线性平流方程 $u_{t} + a u_{x} = 0$，定义在区间 $[-1,1]$ 上，其中平流速度 $a>0$ 为常数。设使用多项式次数为 $N$ 的勒让德-高斯-洛巴托节点的单单元谱配置离散化，因此数值解（在没有滤波的情况下）可以通过勒让德模态展开精确表示为 $u_{N}(x,t) = \\sum_{k=0}^{N} \\hat{u}_{k}(t) P_{k}(x)$，其中 $P_{k}(x)$ 是勒让德多项式，满足对所有 $k$ 都有 $P_{k}(1)=1$。在这种配置设置中，点 $x=1$ 是一个通量点：对于次数至多为 $N$ 的多项式数据，节点表示和模态表示是一致的，并且在未滤波的格式中，在 $x=1$ 处计算的守恒通量是精确的。\n\n为了稳定振荡，在每个时间步对模态系数应用指数模态滤波器，通过 $\\hat{u}_{k} \\mapsto \\sigma_{k} \\hat{u}_{k}$，其中传递函数为\n$$\n\\sigma_{k} = \\exp\\!\\big(-\\alpha \\left(\\tfrac{k}{N}\\right)^{p}\\big),\n$$\n滤波器强度为 $\\alpha>0$，滤波器阶数为 $p \\in \\mathbb{N}$。假设在某个固定时间 $t^{\\star}$，精确解 $u(x,t^{\\star})$ 等于单个勒让德模态 $P_{N}(x)$，因此未滤波的谱配置表示能精确地恢复 $u(x,t^{\\star})$，其中 $\\hat{u}_{N}(t^{\\star})=1$ 且对于 $k\\neq N$ 有 $\\hat{u}_{k}(t^{\\star})=0$。\n\n从勒让德多项式模态展开的核心定义和对角模态滤波的作用出发，推导由滤波器在通量点 $x=1$ 处引入的点误差，定义为\n$$\n\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star}),\n$$\n并提供 $\\varepsilon(\\alpha,p,N)$ 关于 $\\alpha$、$p$ 和 $N$ 的闭式解析表达式。然后，使用在 $x=1$ 处从模态到点求值的第一性原理，描述对角模态传递函数 $k \\mapsto \\sigma_{k}$ 需满足的充要条件，在该条件下，通量点超收敛性（对于所有次数至多为 $N$ 的多项式，通量点的值是精确的）在滤波后得以保持。\n\n将最终答案表示为 $\\varepsilon(\\alpha,p,N)$ 的单一解析表达式。无需四舍五入，也不涉及单位。",
            "solution": "用户提供了一个来自数值分析领域的问题，具体涉及偏微分方程的谱方法。任务是验证问题陈述，如果有效，则推导一个特定的误差量和一个与谱滤波相关的通用条件。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **控制方程：** $u_{t} + a u_{x} = 0$，在 $x \\in [-1,1]$ 上，其中常数 $a>0$。\n- **离散化：** 使用多项式次数为 $N$ 的勒让德-高斯-洛巴托节点的单单元谱配置。\n- **解的表示：** 勒让德模态展开 $u_{N}(x,t) = \\sum_{k=0}^{N} \\hat{u}_{k}(t) P_{k}(x)$。\n- **勒让德多项式：** $P_{k}(x)$，性质为对所有 $k$ 都有 $P_{k}(1)=1$。\n- **通量点：** 点 $x=1$。\n- **模态滤波器：** 通过 $\\hat{u}_{k} \\mapsto \\sigma_{k} \\hat{u}_{k}$ 应用。\n- **滤波器传递函数：** $\\sigma_{k} = \\exp(-\\alpha (\\frac{k}{N})^{p})$，参数为 $\\alpha>0$ 和 $p \\in \\mathbb{N}$。\n- **$t^{\\star}$ 时刻的解状态：** 精确解为 $u(x,t^{\\star}) = P_{N}(x)$。这意味着未滤波的数值解的模态系数为 $\\hat{u}_{N}(t^{\\star})=1$ 且对于 $k\\neq N$ 有 $\\hat{u}_{k}(t^{\\star})=0$。\n- **误差定义：** $\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star})$。\n- **任务：**\n  1. 推导 $\\varepsilon(\\alpha,p,N)$ 的闭式解析表达式。\n  2. 描述为保持通量点超收敛性，$\\sigma_{k}$ 需满足的充要条件。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地植根于谱方法和间断伽辽金方法的理论中。平流方程、勒让德多项式、模态滤波以及单元边界（通量点）处的超收敛性概念都是该领域中标准且成熟的课题。\n- **适定性：** 问题是适定的。它提供了所有必要的定义和数据，以唯一确定所要求的量。设置是自洽且逻辑清晰的。\n- **客观性：** 问题以精确、客观和数学化的语言陈述，没有任何主观或模棱两可的术语。\n- **缺陷检查清单：** 该问题未违反任何无效性标准。它在科学上是合理的、可形式化的、完整的，在数值分析模型问题的背景下是现实的，并且并非微不足道。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n按照问题陈述的要求，分析分两部分进行。\n\n**第一部分：点误差 $\\varepsilon(\\alpha,p,N)$ 的推导**\n\n在通量点 $x=1$ 处的误差定义为 $\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star})$。我们将分别计算每一项。\n\n首先，我们确定精确解在目标点的值。问题陈述在时间 $t^{\\star}$，精确解为 $u(x,t^{\\star}) = P_{N}(x)$。我们在 $x=1$ 处对此进行求值：\n$$\nu(1,t^{\\star}) = P_{N}(1)\n$$\n问题指明了勒让德多项式满足对所有 $k$ 都有 $P_{k}(1) = 1$ 的性质。因此，对于 $k=N$，我们有：\n$$\nu(1,t^{\\star}) = 1\n$$\n\n接下来，我们确定滤波后数值解的值 $u_{N}^{\\mathrm{filtered}}(1,t^{\\star})$。已知未滤波解 $u_{N}(x,t^{\\star})$ 的模态系数为 $\\hat{u}_{N}(t^{\\star})=1$ 且对于所有 $k \\neq N$ 有 $\\hat{u}_{k}(t^{\\star})=0$。滤波过程作用于这些模态系数。令滤波后的系数表示为 $\\hat{u}_{k}^{\\mathrm{filtered}}$。变换由下式给出：\n$$\n\\hat{u}_{k}^{\\mathrm{filtered}} = \\sigma_{k} \\hat{u}_{k}(t^{\\star})\n$$\n对于 $k \\neq N$，我们有 $\\hat{u}_{k}(t^{\\star})=0$，因此 $\\hat{u}_{k}^{\\mathrm{filtered}} = \\sigma_{k} \\cdot 0 = 0$。\n对于 $k = N$，我们有 $\\hat{u}_{N}(t^{\\star})=1$，因此 $\\hat{u}_{N}^{\\mathrm{filtered}} = \\sigma_{N} \\cdot 1 = \\sigma_{N}$。\n\n滤波器的传递函数为 $\\sigma_{k} = \\exp(-\\alpha (\\frac{k}{N})^{p})$。对于特定模态 $k=N$，这变为：\n$$\n\\sigma_{N} = \\exp\\big(-\\alpha \\left(\\tfrac{N}{N}\\right)^{p}\\big) = \\exp(-\\alpha \\cdot 1^{p}) = \\exp(-\\alpha)\n$$\n因此，唯一非零的滤波后模态系数是 $\\hat{u}_{N}^{\\mathrm{filtered}} = \\exp(-\\alpha)$。\n\n滤波后的数值解由这些滤波后的系数重构：\n$$\nu_{N}^{\\mathrm{filtered}}(x,t^{\\star}) = \\sum_{k=0}^{N} \\hat{u}_{k}^{\\mathrm{filtered}} P_{k}(x)\n$$\n由于只有 $k=N$ 的系数非零，此和式简化为单项：\n$$\nu_{N}^{\\mathrm{filtered}}(x,t^{\\star}) = \\hat{u}_{N}^{\\mathrm{filtered}} P_{N}(x) = \\exp(-\\alpha) P_{N}(x)\n$$\n现在，我们在通量点 $x=1$ 处对此滤波解进行求值：\n$$\nu_{N}^{\\mathrm{filtered}}(1,t^{\\star}) = \\exp(-\\alpha) P_{N}(1)\n$$\n使用性质 $P_{N}(1)=1$，我们发现：\n$$\nu_{N}^{\\mathrm{filtered}}(1,t^{\\star}) = \\exp(-\\alpha)\n$$\n\n最后，我们通过代入我们求得的值来计算误差 $\\varepsilon(\\alpha,p,N)$：\n$$\n\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star}) = \\exp(-\\alpha) - 1\n$$\n这就是误差的闭式解析表达式。值得注意的是，在初始误差集中于最高模态 $k=N$ 的特定条件下，滤波器引入的误差与多项式次数 $N$ 和滤波器阶数 $p$ 无关。\n\n**第二部分：保持通量点超收敛性的条件**\n\n通量点超收敛性意味着对于任何次数至多为 $N$ 的多项式解，数值解在点 $x=1$ 处是精确的。让我们考虑该空间中的一个任意多项式解 $u(x)$，由其勒让德模态展开表示：\n$$\nu(x) = \\sum_{k=0}^{N} \\hat{u}_{k} P_{k}(x)\n$$\n该解在 $x=1$ 处的精确值为：\n$$\nu(1) = \\sum_{k=0}^{N} \\hat{u}_{k} P_{k}(1) = \\sum_{k=0}^{N} \\hat{u}_{k}\n$$\n该解的滤波后数值表示 $u_{N}^{\\mathrm{filtered}}(x)$ 的模态系数为 $\\hat{u}_{k}^{\\mathrm{filtered}} = \\sigma_{k} \\hat{u}_{k}$。其在 $x=1$ 处的值为：\n$$\nu_{N}^{\\mathrm{filtered}}(1) = \\sum_{k=0}^{N} \\hat{u}_{k}^{\\mathrm{filtered}} P_{k}(1) = \\sum_{k=0}^{N} (\\sigma_{k} \\hat{u}_{k}) \\cdot 1 = \\sum_{k=0}^{N} \\sigma_{k} \\hat{u}_{k}\n$$\n为了使超收敛性被滤波器保持，对于系数 $\\{\\hat{u}_{k}\\}_{k=0}^{N}$ 的任何选择，滤波后的值必须等于精确值。这给出了条件：\n$$\n\\sum_{k=0}^{N} \\sigma_{k} \\hat{u}_{k} = \\sum_{k=0}^{N} \\hat{u}_{k}\n$$\n重新排列各项，我们得到：\n$$\n\\sum_{k=0}^{N} \\sigma_{k} \\hat{u}_{k} - \\sum_{k=0}^{N} \\hat{u}_{k} = 0\n$$\n$$\n\\sum_{k=0}^{N} (\\sigma_{k} - 1) \\hat{u}_{k} = 0\n$$\n这个方程必须对任意系数向量 $(\\hat{u}_{0}, \\hat{u}_{1}, \\dots, \\hat{u}_{N})$ 都成立。在系数的向量空间中，这等价于向量 $(\\sigma_{0}-1, \\dots, \\sigma_{N}-1)$ 与任意向量 $(\\hat{u}_{0}, \\dots, \\hat{u}_{N})$ 的点积为零。这只有在第一个向量是零向量时才可能。因此，每个分量都必须为零：\n$$\n\\sigma_{k} - 1 = 0 \\quad \\text{对所有 } k \\in \\{0, 1, \\dots, N\\}\n$$\n这就得出了充要条件：\n$$\n\\sigma_{k} = 1 \\quad \\text{对所有 } k \\in \\{0, 1, \\dots, N\\}\n$$\n换句话说，为了对所有次数至多为 $N$ 的多项式保持解在通量点处的精确性，滤波器的传递函数对于所有相应的模态都必须为1。这意味着滤波器必须在解空间上充当单位算子，实际上根本不施加任何滤波。任何非平凡的滤波器（即对于某些 $k$ 有 $\\sigma_{k}  1$）都会破坏超收敛性。",
            "answer": "$$\n\\boxed{\\exp(-\\alpha) - 1}\n$$"
        },
        {
            "introduction": "既然我们已经理解了滤波的设计原则和潜在缺陷，现在让我们将其应用于一个经典且具有挑战性的问题：稳定激波。本练习使用谱消失粘性（SVV）这一复杂的模态滤波形式，来控制 Burgers 方程数值解中的振荡。你将把抽象的滤波器参数与一个具体的物理量——激波厚度——联系起来，并实现一个模型来预测它，从而巩固你对稳定化如何在实践中发挥作用的理解。",
            "id": "3418289",
            "problem": "考虑在区间 $[-1,1]$ 上带狄利克雷边界条件的一维无粘性Burgers方程，\n$$\nu_t + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0, \\quad x \\in [-1,1], \\quad t \\ge 0,\n$$\n边界数据为 $u(-1,t)=u_L$ 和 $u(1,t)=u_R$，初始条件为黎曼阶梯，产生一个以 $x=0$ 为中心的定常激波，其中 $u_L > u_R$。在一个使用 $N+1$ 个Legendre-Gauss-Lobatto配置点和谱消失粘性（SVV）稳定化的Legendre谱方法中，通过一个模态扩散算子来增强半离散方程，该算子抑制高阶Legendre模态。在由 $k=0,1,\\dots,N$ 索引的模态空间中，SVV向模态 $k$ 添加阻尼率 $\\widehat{\\nu}_k \\,\\eta_k$，其中 $\\eta_k$ 是与Legendre模态的二阶导数类算子相关的谱符号，而 $\\widehat{\\nu}_k$ 是SVV核。假设采用以下标准建模选择：\n- 符号为 $\\eta_k = k(k+1)$。\n- SVV核是分段多项式，截斷值为 $m$，斜坡幂次为 $p=2$，\n$$\n\\widehat{\\nu}_k = \\nu_0 \\, s_k, \\quad s_k = \\begin{cases}\n0,  k  m,\\\\\n\\left( \\dfrac{k-m}{N-m} \\right)^{2},  m \\le k \\le N,\n\\end{cases}\n$$\n参数为 $\\nu_0>0$，$m \\in \\{0,1,\\dots,N-1\\}$，以及 $N \\in \\mathbb{N}$。\n\n对于方程 $u_t + \\partial_x(\\tfrac{1}{2}u^2) = \\nu \\, u_{xx}$，连接 $u_L$ 和 $u_R$ 的定常粘性Burgers激波有一个光滑的内层，其厚度 $\\delta$ 的标度关系为 $\\delta \\sim 4 \\nu / \\Delta$，其中 $\\Delta = u_L - u_R$ 是跳跃强度。在SVV稳定的Legendre谱方法中，SVV算子在激波尺度上充当有效的物理粘性。通过将SVV算子替换为一个常数粘性 $\\nu_{\\mathrm{eff}}$ 来模拟这种有效粘性，该常数粘性等于高于截断值的平均模态阻尼強度，并由最高阶模态符号进行归一化，即\n$$\n\\nu_{\\mathrm{eff}}(\\nu_0,m,N) = \\nu_0 \\, \\overline{\\eta}_m, \\quad \\overline{\\eta}_m = \\frac{1}{N-m+1} \\sum_{k=m}^{N} s_k \\, \\frac{\\eta_k}{N(N+1)}.\n$$\n在此建模假设下，对于 $u_L=1$ 和 $u_R=-1$ 的定常激波（因此 $\\Delta = 2$ 且激波速度为零），激波厚度 $\\delta$ 由以下公式预测\n$$\n\\delta(\\nu_0,m,N) = \\frac{4 \\, \\nu_{\\mathrm{eff}}(\\nu_0,m,N)}{\\Delta}.\n$$\n\n你的任务是：\n1. 从定常粘性Burgers方程的平衡关系和Rankine–Hugoniot条件出发，假设存在连接 $u_L$ 和 $u_R$ 的单调行波解，从第一性原理推导具有常数粘性 $\\nu$ 的粘性Burgers方程的激波厚度 $\\delta$ 的标度律 $\\delta = 4\\nu/\\Delta$。\n2. 使用Legendre谱SVV模型和上面定义的模态平均有效粘性 $\\nu_{\\mathrm{eff}}(\\nu_0,m,N)$，在 $p=2$，$u_L=1$ 和 $u_R=-1$ 的条件下，推导出 $\\delta(\\nu_0,m,N)$ 关于 $\\nu_0$、$m$ 和 $N$ 的显式可计算表达式。\n3. 实现一个程序，为一组测试用例计算 $\\delta(\\nu_0,m,N)$。使用以下参数测试套件 $(\\nu_0,m,N)$：\n   - $(0.02,16,32)$,\n   - $(0.01,32,64)$,\n   - $(0.02,56,64)$,\n   - $(0.05,8,16)$,\n   - $(0.02,0,32)$.\n   你应该始终假设使用无量纲单位，并以实数形式返回激波厚度值。\n4. 你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,...]”），顺序与上述测试套件相同。\n\n约束和说明：\n- 所有数学符号和数字必须以适用于带SVV的无粘性Burgers方程的标准无量纲形式进行解释。\n- 不涉及角度；不需要角度单位。\n- 不涉及百分比；不需要百分比表示。\n- 每个测试用例的最终答案必须是实数（浮点数）。",
            "solution": "该问题提出了一组有效且适定的任务，其基础是双曲守恒律的数值分析。我们被要求进行两项与激波厚度相关的推导，第一项是针对连续粘性Burgers方程，第二项是针对由谱消失粘性（SVV）稳定的Legendre谱方法。最后，我们必须根据推导出的公式，实现一个程序来计算SVV情况下的激波厚度。\n\n问题验证如下：\n- **提取的已知条件**：\n    - 控制方程：$u_t + \\partial_x (\\tfrac{1}{2} u^2) = 0$，对于 $x \\in [-1,1], t \\ge 0$。\n    - 边界条件：$u(-1,t)=u_L$ 和 $u(1,t)=u_R$。\n    - 初始条件：黎曼阶梯，在 $x=0$ 处产生定常激波，且 $u_L > u_R$。\n    - 离散化方法：使用 $N+1$ 个Legendre-Gauss-Lobatto点的Legendre谱方法。\n    - 稳定化：SVV算子向Legendre模态 $k$ 添加阻尼率 $\\widehat{\\nu}_k \\eta_k$。\n    - 算子符号：$\\eta_k = k(k+1)$。\n    - SVV核：$\\widehat{\\nu}_k = \\nu_0 s_k$，其中 $s_k = \\begin{cases} 0,  k  m,\\\\ \\left( \\frac{k-m}{N-m} \\right)^{2},  m \\le k \\le N \\end{cases}$。\n    - 核参数：$\\nu_0>0$，$m \\in \\{0,1,\\dots,N-1\\}$，$N \\in \\mathbb{N}$，以及斜坡幂次 $p=2$。\n    - 粘性类比：$u_t + \\partial_x(\\tfrac{1}{2}u^2) = \\nu u_{xx}$。\n    - 粘性激波厚度标度关系：$\\delta \\sim 4\\nu/\\Delta$，其中 $\\Delta = u_L - u_R$。\n    - 有效粘性模型：$\\nu_{\\mathrm{eff}}(\\nu_0,m,N) = \\nu_0 \\overline{\\eta}_m$，其中 $\\overline{\\eta}_m = \\frac{1}{N-m+1} \\sum_{k=m}^{N} s_k \\frac{\\eta_k}{N(N+1)}$。\n    - 预测的SVV激波厚度：$\\delta(\\nu_0,m,N) = \\frac{4 \\nu_{\\mathrm{eff}}(\\nu_0,m,N)}{\\Delta}$。\n    - 特定激波参数：$u_L=1$，$u_R=-1$，意味着 $\\Delta = 2$。\n    - 测试用例 $(\\nu_0, m, N)$: $(0.02,16,32)$, $(0.01,32,64)$, $(0.02,56,64)$, $(0.05,8,16)$, $(0.02,0,32)$.\n- **验证结论**：该问题在科学上是合理的、适定的、客观的且自洽的。它涉及计算流体动力学和数值分析中的一个标准课题。所提供的模型是SVV方法文献中的标准模型。任务明确，能导出一个唯一的、可验证的解。因此，该问题是有效的。\n\n我们现在进行推导和实现。\n\n**1. 粘性激波厚度标度律的推导**\n\n第一个任务是为粘性Burgers方程 $u_t + \\partial_x(\\tfrac{1}{2}u^2) = \\nu u_{xx}$ 中的定常激波推导标度律 $\\delta \\sim 4\\nu/\\Delta$。\n\n对于定常激波，解与时间 $t$ 无关，因此 $u_t=0$。方程简化为稳态形式：\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} u^2 \\right) = \\nu \\frac{d^2u}{dx^2}.\n$$\n对 $x$ 积分一次得到：\n$$\n\\frac{1}{2} u^2 = \\nu \\frac{du}{dx} + C_1,\n$$\n其中 $C_1$ 是一个积分常数。我们考虑一个在 $x \\to -\\infty$ 时连接状态 $u_L$ 到 $x \\to +\\infty$ 时状态 $u_R$ 的解。在这些远场极限下，解变为常数，因此其导数 $\\frac{du}{dx}$ 为零。在 $x \\to -\\infty$ 处应用此条件：\n$$\n\\frac{1}{2} u_L^2 = \\nu(0) + C_1 \\implies C_1 = \\frac{1}{2} u_L^2.\n$$\nBurgers方程中定常激波（$c=0$）的Rankine-Hugoniot条件要求 $\\frac{1}{2}u_L^2 = \\frac{1}{2}u_R^2$，这意味着 $u_R = -u_L$。这与问题中 $u_L=1$ 和 $u_R=-1$ 的设定一致。由此，常数 $C_1$ 可由 $x \\to \\pm\\infty$ 两端的条件一致地确定。\n\n将 $C_1$ 代回，我们得到关于激波剖面 $u(x)$ 的一阶常微分方程：\n$$\n\\nu \\frac{du}{dx} = \\frac{1}{2} (u^2 - u_L^2).\n$$\n这是一个可分离变量的方程。我们可以写成：\n$$\n\\frac{dx}{\\nu} = \\frac{2}{u^2 - u_L^2} du.\n$$\n对该方程积分可得 $u(x)$ 的隐式解。以 $x=0$ 为中心（使得 $u(0)=0$）的显式解为：\n$$\nu(x) = -u_L \\tanh\\left( \\frac{u_L x}{2\\nu} \\right).\n$$\n激波厚度 $\\delta$ 表征了过渡层的宽度。该厚度由解剖面中出现的特征长度尺度决定。从双曲正切函数的参数中，我们可以确定此长度尺度为 $L_{\\text{char}} = \\frac{2\\nu}{u_L}$。\n\n问题要求用激波跳跃强度 $\\Delta = u_L - u_R$ 来表示此标度关系。由于 $u_R = -u_L$，我们有 $\\Delta = u_L - (-u_L) = 2u_L$。我们可以将 $u_L = \\Delta/2$ 代入特征长度的表达式中：\n$$\nL_{\\text{char}} = \\frac{2\\nu}{(\\Delta/2)} = \\frac{4\\nu}{\\Delta}.\n$$\n激波厚度 $\\delta$与解的这个内在长度尺度成正比。因此，我们推导出标度律：\n$$\n\\delta \\sim \\frac{4\\nu}{\\Delta}.\n$$\n至此完成了第一部分的推导。\n\n**2. $\\delta(\\nu_0, m, N)$ 可计算表达式的推导**\n\n第二个任务是在SVV模型下找到激波厚度 $\\delta(\\nu_0, m, N)$ 的显式公式。问题提供了一系列定义，我们将把它们组合起来。\n\n预测的激波厚度由下式给出：\n$$\n\\delta(\\nu_0, m, N) = \\frac{4 \\nu_{\\mathrm{eff}}(\\nu_0, m, N)}{\\Delta}.\n$$\n给定的具体情况是 $u_L=1$ 和 $u_R=-1$，所以跳跃强度为 $\\Delta = 1 - (-1) = 2$。\n$$\n\\delta(\\nu_0, m, N) = \\frac{4 \\nu_{\\mathrm{eff}}(\\nu_0, m, N)}{2} = 2 \\nu_{\\mathrm{eff}}(\\nu_0, m, N).\n$$\n有效粘性 $\\nu_{\\mathrm{eff}}$ 被建模为：\n$$\n\\nu_{\\mathrm{eff}}(\\nu_0, m, N) = \\nu_0 \\overline{\\eta}_m.\n$$\n将此式代入 $\\delta$ 的表达式中：\n$$\n\\delta(\\nu_0, m, N) = 2 \\nu_0 \\overline{\\eta}_m.\n$$\n项 $\\overline{\\eta}_m$ 是归一化的平均模态阻尼强度：\n$$\n\\overline{\\eta}_m = \\frac{1}{N-m+1} \\sum_{k=m}^{N} s_k \\frac{\\eta_k}{N(N+1)}.\n$$\n对于 $m \\le k \\le N$，我们已知SVV核分量 $s_k$ 和谱符号 $\\eta_k$：\n$$\ns_k = \\left( \\frac{k-m}{N-m} \\right)^{2}, \\quad \\eta_k = k(k+1).\n$$\n将 $s_k$ 和 $\\eta_k$ 的表达式代入 $\\overline{\\eta}_m$ 的公式中：\n$$\n\\overline{\\eta}_m = \\frac{1}{N-m+1} \\sum_{k=m}^{N} \\left( \\frac{k-m}{N-m} \\right)^{2} \\frac{k(k+1)}{N(N+1)}.\n$$\n现在，我们将 $\\overline{\\eta}_m$ 的完整表达式代入我们的 $\\delta(\\nu_0, m, N)$方程中：\n$$\n\\delta(\\nu_0, m, N) = 2 \\nu_0 \\left[ \\frac{1}{N-m+1} \\sum_{k=m}^{N} \\left( \\frac{k-m}{N-m} \\right)^{2} \\frac{k(k+1)}{N(N+1)} \\right].\n$$\n为了计算上的清晰，可以通过将常数从求和中提取出来重新排列此式：\n$$\n\\delta(\\nu_0, m, N) = \\frac{2 \\nu_0}{(N-m+1) (N-m)^2 N(N+1)} \\sum_{k=m}^{N} (k-m)^2 k(k+1).\n$$\n这是激波厚度 $\\delta$ 作为SVV参数 $\\nu_0$、$m$ 和 $N$ 的函数的最终、显式和可计算的表达式。求和是在整数索引 $k$ 从 $m$ 到 $N$ 的范围内进行的。参数 $m$ 和 $N$ 受 $m \\in \\{0,1,\\dots,N-1\\}$ 约束，确保项 $(N-m)$ 始终为正整数，从而避免除以零。该公式将在程序中实现，以解决任务的最后一部分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_delta(nu_0, m, N):\n    \"\"\"\n    Computes the predicted shock thickness for a Legendre spectral method \n    stabilized with Spectral Vanishing Viscosity (SVV).\n\n    Args:\n        nu_0 (float): The base viscosity parameter for the SVV kernel.\n        m (int): The cutoff mode index for the SVV kernel.\n        N (int): The maximum polynomial degree (number of modes is N+1).\n\n    Returns:\n        float: The computed shock thickness delta.\n    \"\"\"\n    # The problem specifies m is in {0, 1, ..., N-1}, so N-m >= 1.\n    # We defensively check for this condition.\n    if not (0 = m  N):\n        raise ValueError(\"Parameters must satisfy 0 = m  N.\")\n\n    # The shock jump strength Delta is u_L - u_R = 1 - (-1) = 2.\n    delta_u = 2.0\n\n    # The problem defines the predicted shock thickness as:\n    # delta = (4 * nu_eff) / delta_u = 2 * nu_eff\n    # where nu_eff = nu_0 * eta_m_bar\n\n    # We need to compute eta_m_bar, which involves a summation.\n    # eta_m_bar = (1/(N-m+1)) * sum_{k=m to N} [s_k * eta_k / (N*(N+1))]\n\n    # s_k = ((k-m)/(N-m))^2\n    # eta_k = k*(k+1)\n    \n    # Let's compute the summation part first.\n    # We use a generator expression within np.sum for efficiency and clarity.\n    # The case N-m = 0 is avoided by the problem constraint m  N.\n    sum_val = np.sum(\n        [\n            (((k - m) / (N - m)) ** 2) * (k * (k + 1))\n            for k in range(m, N + 1)\n        ]\n    )\n\n    # Now, assemble eta_m_bar.\n    # Normalization factor for the sum.\n    num_modes_filtered = N - m + 1\n    # Symbol at the highest mode for normalization.\n    # Avoid division by zero if N=0, though problem constraints imply N>=1.\n    if N == 0:\n        # This case won't be reached with m  N\n        eta_N = 1.0 \n    else:\n        eta_N = N * (N + 1)\n    \n    eta_m_bar = (1 / num_modes_filtered) * (sum_val / eta_N)\n\n    # Compute the effective viscosity.\n    nu_eff = nu_0 * eta_m_bar\n\n    # Finally, compute the shock thickness.\n    shock_thickness = (4.0 * nu_eff) / delta_u\n\n    return shock_thickness\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is in the format (nu_0, m, N).\n    test_cases = [\n        (0.02, 16, 32),\n        (0.01, 32, 64),\n        (0.02, 56, 64),\n        (0.05, 8, 16),\n        (0.02, 0, 32),\n    ]\n\n    results = []\n    for nu_0, m, N in test_cases:\n        result = compute_delta(nu_0, m, N)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts each float result to a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver.\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}