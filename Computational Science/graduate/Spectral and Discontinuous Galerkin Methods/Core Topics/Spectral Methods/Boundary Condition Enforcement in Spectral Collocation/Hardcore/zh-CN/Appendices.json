{
    "hands_on_practices": [
        {
            "introduction": "此练习聚焦于在谱搭配法中最直接施加狄利克雷边界条件的方法：强施加法。我们将通过数值方式，研究并比较两种常见的强施加策略——修改算子矩阵的对应行与缩减到内部区域。通过这个过程，我们将理解这些选择如何显著影响算子的稳定性和条件数，这对于实际的数值计算是一个至关重要的课题。",
            "id": "3367677",
            "problem": "考虑在区间 $\\left[-1,1\\right]$ 上的边值问题，该问题由线性微分算子 $\\mathcal{L}u = -u'' + u$ 和齐次狄利克雷边界条件 $u(-1) = 0$ 与 $u(1) = 0$ 控制。目标是在切比雪夫-高斯-洛巴托点上的谱配点框架中，分析通过修改离散算子的首行和末行来施加狄利克雷边界条件，如何随着多项式次数的增加而影响离散算子的谱和二范数条件数。该分析必须与切比雪夫点在端点附近的聚集现象及其数值影响相关联。\n\n从以下基本定义开始：\n- 切比雪夫-高斯-洛巴托点的定义为 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$，其中 $j = 0,1,\\dots,N$，$N$ 是多项式次数，配点数量为 $N+1$。\n- 在切比雪夫-高斯-洛巴托点上，谱一阶微分矩阵 $D$ 的定义为一个将节点值映射到其一阶导数近似值的矩阵。该矩阵根据切比雪夫理论指定的类重心权重构建，以满足对最高 $N$ 次多项式的精确性。\n- 通过一阶微分矩阵的平方来离散逼近二阶导数，即 $D^{(2)} = D D$。\n- 在配点上，算子 $\\mathcal{L}$ 的离散近似为 $A_{\\mathrm{full}} = -D^{(2)} + I$，其中 $I$ 是大小为 $N+1$ 的单位矩阵。\n- 通过行修改施加齐次狄利克雷边界条件：将 $A_{\\mathrm{full}}$ 的首行和末行替换为分别施加 $u(-1)=0$ 和 $u(1)=0$ 的单位行，从而得到 $A_{\\mathrm{bc}}$。\n- 通过内部缩减施加齐次狄利克雷边界条件：提取 $A_{\\mathrm{full}}$ 中对应于索引 $1,2,\\dots,N-1$ 的内部块，形成 $A_{\\mathrm{int}}$。该矩阵作用于边界值固定为零的内部未知数。\n\n您必须：\n1. 对每个给定的 $N$ 构建切比雪夫-高斯-洛巴托网格，并使用经典的切比雪夫权重和节点坐标之差构建谱一阶微分矩阵 $D$。其对角线元素由 $D$ 的每行元素之和为零的要求（对常数求导为零的推论）来定义。不要使用未从这些基础推导出的简化公式。\n2. 形成离散二阶导数算子 $D^{(2)} = D D$。\n3. 组装离散算子 $A_{\\mathrm{full}} = -D^{(2)} + I$。\n4. 使用两种方法施加齐次狄利克雷边界条件：\n   - 行修改：通过将 $A_{\\mathrm{full}}$ 的首行和末行替换为分别施加 $u(-1)=0$ 和 $u(1)=0$ 的行来构造 $A_{\\mathrm{bc}}$，即将首行设置为 $[1,0,\\dots,0]$，末行设置为 $[0,\\dots,0,1]$。\n   - 内部缩减：将 $A_{\\mathrm{int}}$ 构造为通过提取 $A_{\\mathrm{full}}$ 中行和列索引为 $1$ 到 $N-1$ 的内部块得到的 $(N-1)\\times(N-1)$ 矩阵。\n5. 对每个矩阵 $A_{\\mathrm{bc}}$ 和 $A_{\\mathrm{int}}$，计算：\n   - 二范数条件数 $\\kappa_2$，定义为最大奇异值与最小奇异值之比。\n   - 谱（特征值集合），您必须从中提取特征值实部的最小值和最大值，以及虚部绝对值的最大值。这些谱特征量化了相对于内部缩减方法，行修改方法在多大程度上改变了谱的分布和非正规性。\n6. 解释 $\\kappa_2$ 随 $N$ 的增长如何与切比雪夫配点在 $x=-1$ 和 $x=1$ 附近的聚集现象相关，以及行修改如何影响局部化在端点附近的高频模式。\n\n您必须实现一个程序，为以下多项式次数的测试套件返回数值结果：\n- $N=6$（小尺寸，用于验证基线行为），\n- $N=16$（中等尺寸），\n- $N=32$（较大尺寸），\n- $N=64$（高分辨率）。\n\n对于测试套件中的每个 $N$，按此顺序生成一个包含以下九个浮点值的列表：\n- $\\kappa_2(A_{\\mathrm{bc}})$，\n- $\\kappa_2(A_{\\mathrm{int}})$，\n- $\\kappa_2(A_{\\mathrm{bc}})/\\kappa_2(A_{\\mathrm{int}})$，\n- $\\min\\left(\\Re\\lambda\\left(A_{\\mathrm{bc}}\\right)\\right)$，\n- $\\max\\left(\\Re\\lambda\\left(A_{\\mathrm{bc}}\\right)\\right)$，\n- $\\min\\left(\\Re\\lambda\\left(A_{\\mathrm{int}}\\right)\\right)$，\n- $\\max\\left(\\Re\\lambda\\left(A_{\\mathrm{int}}\\right)\\right)$，\n- $\\max\\left(\\left|\\Im\\lambda\\left(A_{\\mathrm{bc}}\\right)\\right|\\right)$，\n- $\\max\\left(\\left|\\Im\\lambda\\left(A_{\\mathrm{int}}\\right)\\right|\\right)$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个 $N$，其本身是上述九个数字的列表。例如，输出格式必须如下：\n[[n1_1,n1_2,n1_3,n1_4,n1_5,n1_6,n1_7,n1_8,n1_9],[n2_1,n2_2,n2_3,n2_4,n2_5,n2_6,n2_7,n2_8,n2_9],[n3_1,n3_2,n3_3,n3_4,n3_5,n3_6,n3_7,n3_8,n3_9],[n4_1,n4_2,n4_3,n4_4,n4_5,n4_6,n4_7,n4_8,n4_9]]\n\n所有量都是无量纲的；不涉及物理单位。最终打印的输出必须是指定格式的单行文本，所有值都表示为普通十进制数。",
            "solution": "用户提供的问题是有效的。这是一个在数值分析领域（特别是谱方法）中提法恰当、具有科学依据的问题。所有必要的定义和约束都已提供，没有矛盾或含糊之处。该问题要求对在切比雪夫配点格式中施加狄利克雷边界条件的两种标准方法进行定量和定性分析，这是该学科的一个核心课题。\n\n### **1. 理论框架**\n\n该问题涉及区间 $x \\in [-1, 1]$ 上的一维线性边值问题（BVP）的数值解：\n$$\n\\mathcal{L}u = -u''(x) + u(x) = f(x)\n$$\n其边界条件为齐次狄利克雷边界条件 $u(-1) = 0$ 和 $u(1) = 0$。我们将分析通过谱配点方法获得的离散算子的性质。\n\n### **2. 谱配点离散化**\n\n该方法的基础是用一个次数为 $N$ 的全局多项式 $p(x)$ 来逼近未知函数 $u(x)$。通过在一组 $N+1$ 个特定点（称为配点）上强制满足微分方程来确定该多项式的系数。\n\n**2.1. 切比雪夫-高斯-洛巴托（CGL）网格**\n所选择的配点是切比雪夫-高斯-洛巴托（CGL）点，定义为第一类 $N$ 次切比雪夫多项式的极值点：\n$$\nx_j = \\cos\\left(\\frac{\\pi j}{N}\\right) \\quad \\text{for } j = 0, 1, \\dots, N\n$$\n这些点包括边界点 $x_0 = 1$ 和 $x_N = -1$。该网格的一个关键特性是其非均匀间距：点在边界附近聚集，相邻点之间的距离 $\\Delta x_j$ 在 $x=\\pm 1$ 附近按 $O(1/N^2)$ 比例缩放，在定义域内部按 $O(1/N)$ 比例缩放。这种聚集对于解析边界层和减轻龙格现象至关重要，但对数值算子的条件数有显著影响。\n\n**2.2. 谱微分矩阵**\n在CGL点上，插值多项式 $p(x)$ 的导数可以通过对函数值 $\\{u(x_j)\\}_{j=0}^N$ 进行线性变换来计算。此变换由 $(N+1) \\times (N+1)$ 的谱微分矩阵 $D$ 表示。该矩阵的元素由下式给出：\n$$\nD_{jk} = \\begin{cases}\n    \\frac{c_j}{c_k} \\frac{(-1)^{j+k}}{x_j - x_k}  \\text{if } j \\neq k \\\\\n    -\\sum_{l=0, l \\neq j}^{N} D_{jl}  \\text{if } j = k\n\\end{cases}\n$$\n其中权重 $c_j$ 定义为 $c_0 = c_N = 2$，$c_j = 1$ (对于 $j=1, \\dots, N-1$)。对角线元素由常数函数（0次多项式）的导数为零这一性质明确定义，这意味着 $D$ 的每行之和必须为零。\n\n二阶导数通过两次应用微分矩阵来近似，得到二阶导数矩阵 $D^{(2)} = D^2 = D \\cdot D$。然后，对应于 $\\mathcal{L} = -d^2/dx^2 + 1$ 的完整离散算子组装为：\n$$\nA_{\\mathrm{full}} = -D^2 + I\n$$\n其中 $I$ 是 $(N+1) \\times (N+1)$ 的单位矩阵。\n\n### **3. 施加边界条件**\n\n矩阵 $A_{\\mathrm{full}}$ 是奇异的，因为它尚未包含边界条件。我们分析两种施加 $u(1)=u(x_0)=0$ 和 $u(-1)=u(x_N)=0$ 的方法。\n\n**3.1. 方法1：内部缩减**\n此方法从方程组中消除了已知的边界值。由于 $u_0 = 0$ 和 $u_N = 0$，内部点 $j=1, \\dots, N-1$ 的方程仅依赖于内部未知数 $u_1, \\dots, u_{N-1}$。最终的系统由一个 $(N-1) \\times (N-1)$ 的矩阵 $A_{\\mathrm{int}}$ 控制，该矩阵通过提取 $A_{\\mathrm{full}}$ 中对应于行和列 $1$ 到 $N-1$ 的块而形成。\n$$\nA_{\\mathrm{int}} = (A_{\\mathrm{full}})_{1:N-1, 1:N-1}\n$$\n该矩阵为边值问题提供了一个直接且稳定的表示。尽管 $A_{\\mathrm{int}}$ 是非对称的，但其特征值是实数、正数，并且能准确逼近连续算子 $\\mathcal{L}$ 的特征值 $\\lambda_k = 1 + (k\\pi/2)^2$（其中 $k=1, 2, \\dots$）。因此，其谱的虚部为零（在浮点误差范围内），其条件数虽然随 $N$ 增长（对于此算子通常为 $O(N^4)$），但其行为是可预测的。\n\n**3.2. 方法2：行修改**\n此方法保留了完整的 $(N+1) \\times (N+1)$ 系统大小。边界条件通过替换矩阵 $A_{\\mathrm{full}}$ 的首行和末行以及右端向量中相应的项来施加。为了求解齐次问题或分析算子谱，我们考虑修改后的矩阵 $A_{\\mathrm{bc}}$：\n$$\nA_{\\mathrm{bc}} =\n\\begin{pmatrix}\n1  0  \\dots  0  0 \\\\\n(A_{\\mathrm{full}})_{1,0}  (A_{\\mathrm{full}})_{1,1}  \\dots  (A_{\\mathrm{full}})_{1,N-1}  (A_{\\mathrm{full}})_{1,N} \\\\\n\\vdots   \\ddots   \\vdots \\\\\n(A_{\\mathrm{full}})_{N-1,0}  (A_{\\mathrm{full}})_{N-1,1}  \\dots  (A_{\\mathrm{full}})_{N-1,N-1}  (A_{\\mathrm{full}})_{N-1,N} \\\\\n0  0  \\dots  0  1\n\\end{pmatrix}\n$$\n其中 $(A_{\\mathrm{full}})_{j,k}$ 表示原始完整算子中第 $j$ 行、第 $k$ 列的元素。\n\n### **4. 谱与条件数分析**\n\n对特征值问题 $A_{\\mathrm{bc}}v = \\lambda v$ 的仔细分析揭示了一种具有欺骗性的关系。该方程的首行和末行意味着 $v_0 = \\lambda v_0$ 和 $v_N = \\lambda v_N$。\n- 如果 $\\lambda \\neq 1$，那么必须有 $v_0 = 0$ 和 $v_N = 0$。此时，关于内部份量 $v_{1}, \\dots, v_{N-1}$ 的剩余方程恰好简化为内部矩阵的特征值问题：$A_{\\mathrm{int}}v_{\\mathrm{int}} = \\lambda v_{\\mathrm{int}}$。\n- 如果 $\\lambda = 1$，条件 $v_0=v_0$ 和 $v_N=v_N$ 变得平凡。可以构造出两个对应于 $\\lambda=1$ 的线性无关的特征向量。\n\n这证明了 $A_{\\mathrm{bc}}$ 的谱是 $A_{\\mathrm{int}}$ 的谱与在 $\\lambda=1$ 处的一个二重特征值的并集：\n$$\n\\sigma(A_{\\mathrm{bc}}) = \\sigma(A_{\\mathrm{int}}) \\cup \\{1, 1\\}\n$$\n这意味着两个矩阵的特征值范围及其虚部将几乎相同（因为 $A_{\\mathrm{int}}$ 的最小特征值大于 $1$）。\n\n然而，条件数揭示了不同的情况。二范数条件数 $\\kappa_2(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$ 取决于奇异值，而非特征值。对于一个非正规矩阵，这两者可能差异巨大。行修改过程使得 $A_{\\mathrm{bc}}$ 变得高度非正规。$A_{\\mathrm{bc}}$ 的特征向量变得近乎线性相关，特别是那些与特征值 $\\lambda=1$ 相关联的特征向量。这种特征向量的非正交性是非正规性的标志，并导致条件数的爆炸性增长。\n\nCGL点在边界附近的聚集导致 $A_{\\mathrm{full}}$ 的相应行变得近乎冗余，这是谱方法中病态问题的一个主要来源。行修改方法通过用任意单位向量替换这些敏感的行，创建了一个数值上脆弱的算子。相比之下，内部缩减方法正确地构建了规模更小、性质良好的内部问题，从而带来了更优的数值稳定性。因此，比率 $\\kappa_2(A_{\\mathrm{bc}})/\\kappa_2(A_{\\mathrm{int}})$ 将会很大并随 $N$ 迅速增长，量化了由行修改引起的稳定性下降。",
            "answer": "```python\nimport numpy as np\n\ndef build_chebyshev_diff_matrix(N):\n    \"\"\"\n    Constructs the Chebyshev spectral differentiation matrix D on the N+1\n    Chebyshev-Gauss-Lobatto points.\n    \"\"\"\n    if N == 0:\n        return np.array([[0.]])\n        \n    N_plus_1 = N + 1\n    # Define Chebyshev-Gauss-Lobatto points\n    x = np.cos(np.pi * np.arange(N_plus_1) / N)\n    \n    # Define weights c_j\n    c = np.ones(N_plus_1)\n    c[0] = 2.0\n    c[N] = 2.0\n    \n    D = np.zeros((N_plus_1, N_plus_1))\n    \n    # Off-diagonal entries\n    for j in range(N_plus_1):\n        for k in range(N_plus_1):\n            if j != k:\n                D[j, k] = (c[j] / c[k]) * ((-1)**(j + k)) / (x[j] - x[k])\n                \n    # Diagonal entries are set by the row-sum-to-zero property\n    # D_jj = -sum_{k!=j} D_jk\n    row_sums = np.sum(D, axis=1)\n    np.fill_diagonal(D, -row_sums)\n    \n    return D\n\ndef analyze_operators(N):\n    \"\"\"\n    Performs the complete analysis for a given polynomial degree N.\n    \"\"\"\n    # 1. Construct differentiation matrix\n    D = build_chebyshev_diff_matrix(N)\n    \n    # 2. Form second derivative operator\n    D2 = D @ D\n    \n    # 3. Assemble the full discrete operator\n    I_full = np.eye(N + 1)\n    A_full = -D2 + I_full\n    \n    # 4. Enforce boundary conditions\n    # Interior reduction\n    A_int = A_full[1:N, 1:N]\n    \n    # Row modification\n    A_bc = A_full.copy()\n    A_bc[0, :] = 0.0\n    A_bc[0, 0] = 1.0\n    A_bc[N, :] = 0.0\n    A_bc[N, N] = 1.0\n    \n    # 5. Compute required quantities\n    # Condition numbers\n    kappa_bc = np.linalg.cond(A_bc, 2)\n    kappa_int = np.linalg.cond(A_int, 2)\n    ratio_kappa = kappa_bc / kappa_int\n    \n    # Eigenvalues\n    eig_bc = np.linalg.eigvals(A_bc)\n    eig_int = np.linalg.eigvals(A_int)\n    \n    # Spectral characteristics\n    # For A_bc\n    min_re_bc = np.min(np.real(eig_bc)) if eig_bc.size > 0 else 0.0\n    max_re_bc = np.max(np.real(eig_bc)) if eig_bc.size > 0 else 0.0\n    max_im_abs_bc = np.max(np.abs(np.imag(eig_bc))) if eig_bc.size > 0 else 0.0\n    \n    # For A_int\n    min_re_int = np.min(np.real(eig_int)) if eig_int.size > 0 else 0.0\n    max_re_int = np.max(np.real(eig_int)) if eig_int.size > 0 else 0.0\n    max_im_abs_int = np.max(np.abs(np.imag(eig_int))) if eig_int.size > 0 else 0.0\n\n    return [\n        kappa_bc,\n        kappa_int,\n        ratio_kappa,\n        min_re_bc,\n        max_re_bc,\n        min_re_int,\n        max_re_int,\n        max_im_abs_bc,\n        max_im_abs_int\n    ]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for the specified test cases and print results.\n    \"\"\"\n    test_cases = [6, 16, 32, 64]\n    all_results = []\n\n    for N in test_cases:\n        result_for_N = analyze_operators(N)\n        all_results.append(result_for_N)\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从节点空间转换到模态空间为处理边界条件提供了不同的视角。本练习将动手实现经典的tau方法，在该方法中，微分方程在一个稍小的函数空间内被强制满足，从而为边界约束“腾出空间”。通过这个编程实践，我们将清晰地看到边界数据是如何被直接整合进求解谱系数的线性方程组中的。",
            "id": "3367693",
            "problem": "考虑在区间 $\\left[-1,1\\right]$ 上的一维泊松问题，\n$$-u''(x)=f(x),\\quad x\\in(-1,1),\\qquad u(-1)=0,\\quad u(1)=0,$$\n该问题将使用第一类切比雪夫多项式，通过谱陶方法进行近似。设 $\\{T_k(x)\\}_{k=0}^N$ 表示最高为 $N$ 次的切比雪夫基，并将近似解表示为 $u_N(x)=\\sum_{k=0}^N a_k T_k(x)$，其中 $\\{a_k\\}_{k=0}^N$ 是未知的模态系数。陶配置在由 $\\{T_0,\\dots,T_{N-2}\\}$ 张成的子空间中强制执行微分方程，并用边界条件 $u(\\pm 1)=0$ 替代两个最高阶方程，从而得到一个关于 $\\{a_k\\}_{k=0}^N$ 的方形线性系统。\n\n仅从基本定义和经过充分检验的构造出发：\n- 切比雪夫-高斯-洛巴托节点 $x_j=\\cos\\left(\\pi j/N\\right)$，其中 $j=0,\\dots,N$。\n- 基于重心坐标的切比雪夫微分矩阵，用于在节点上得到一阶和二阶导数。\n- 由切比雪夫-范德蒙德求值矩阵 $V_{jk}=T_k(x_j)$ 及其逆矩阵定义的节点到模态和模态到节点的线性映射。\n\n推导将 $\\{a_k\\}$ 映射到 $-u''$ 的切比雪夫系数的模态算子，然后通过用模态形式的边界条件替换最后两个方程来组装陶系统。注意，$T_k(1)=1$ 且 $T_k(-1)=(-1)^k$，因此两个边界条件变为关于 $\\{a_k\\}$ 的线性条件：\n$$\\sum_{k=0}^N a_k = 0,\\qquad \\sum_{k=0}^N (-1)^k a_k = 0.$$\n\n您的任务是实现一个完整的程序，该程序：\n- 使用切比雪夫-高斯-洛巴托配置点和节点与模态空间之间的精确投影，构造 $-d^2/dx^2$ 的模态算子。\n- 通过在 $\\{T_0,\\dots,T_{N-2}\\}$ 上强制执行偏微分方程并将边界条件作为最后两行来组装陶系统。\n- 对于给定的右侧项 $f(x)=T_m(x)$，通过将 $f$ 投影到 $\\{T_0,\\dots,T_N\\}$ 上来计算右侧模态向量。\n- 求解模态系数 $\\{a_k\\}$。\n\n为了测试正确性并明确突出陶项的作用，对每个测试用例计算并报告以下三个标量诊断值：\n- 在模态形式下，限制在第 $0$ 行到第 $N-2$ 行的偏微分方程残差的无穷范数，即 $\\left\\|L_{0:N-1,:}\\,a - b_{0:N-1}\\right\\|_{\\infty}$，其中 $L$ 是 $-d^2/dx^2$ 的模态算子，$a$ 是解向量，$b$ 是 $f$ 的模态向量。\n- 边界残差大小 $\\max\\left\\{\\left|\\sum_{k=0}^N a_k\\right|,\\left|\\sum_{k=0}^N (-1)^k a_k\\right|\\right\\}$。\n- 用于衡量组装系统的最后两行与强制边界条件的陶行是否一致的无穷范数，即这两行与向量 $\\left[1,1,\\dots,1\\right]$ 和 $\\left[1,-1,1,-1,\\dots\\right]$ 之间差值的无穷范数的最大值。\n\n您的实现不得在模态空间中使用任何特殊情况下的算子闭式公式；必须按照上述描述，通过节点微分矩阵和精确的模态-节点变换来构造算子。\n\n测试套件：\n- 情况 1：$N=8$， $m=5$。\n- 情况 2：$N=5$， $m=0$。\n- 情况 3：$N=6$， $m=6$。\n\n对于每种情况，设 $f(x)=T_m(x)$。您的程序应生成一行输出，其中包含按测试用例顺序连接的所有结果，每个用例按上述顺序贡献三个浮点数，形式为逗号分隔的列表并用方括号括起来。例如，输出格式必须严格符合\n$[\\text{residual}_{\\text{PDE,case 1}},\\text{residual}_{\\text{BC,case 1}},\\text{residual}_{\\text{tau,case 1}},\\text{residual}_{\\text{PDE,case 2}},\\dots,\\text{residual}_{\\text{tau,case 3}}]$ 的形式。\n所有报告的值必须是无单位的实值浮点数。角度（若在内部使用）以弧度为单位。",
            "solution": "用户提供的问题被评估为有效。它在科学上是合理的、适定的，并且为解决该问题提供了所有必要的信息。任务是为一维泊松方程实现一个切比雪夫谱陶方法，并有特定要求，即通过节点空间操作来构造模态算子。\n\n我们的任务是找到泊松问题\n$$ -u''(x) = f(x), \\quad x \\in (-1, 1) $$\n在齐次狄利克雷边界条件 $u(-1) = 0$ 和 $u(1) = 0$ 下的近似解 $u_N(x)$。该近似解在最高次为 $N$ 的多项式空间中寻找，表示为第一类切比雪夫多项式 $T_k(x)$ 的和：\n$$ u_N(x) = \\sum_{k=0}^N a_k T_k(x) $$\n目标是确定未知的模态系数 $a = \\{a_k\\}_{k=0}^N$。\n\n谱陶方法并非在所有点上都强制执行微分方程，而是要求残差与一组测试函数正交。对于本问题，要求残差 $r(x) = -u_N''(x) - f(x)$ 与前 $N-1$ 个切比雪夫多项式 $\\{T_0(x), \\dots, T_{N-2}(x)\\}$ 正交。在模态系数空间中，这等价于要求残差的前 $N-1$ 个系数为零。系统中的另外两个自由度用于强制执行两个边界条件。\n\n问题的核心是构建线性算子 $L$，该算子将 $u_N(x)$ 的系数（即向量 $a$）映射到 $-u_N''(x)$ 的系数。问题明确禁止在模态空间中使用此算子的已知稀疏结构，而是要求通过与物理空间（节点表示）之间的转换来构建它。这个过程涉及三个主要步骤：\n\n1.  **模态到节点变换：** 给定模态系数 $a = (a_0, \\dots, a_N)^T$，我们在 $N+1$ 个切比雪夫-高斯-洛巴托 (CGL) 节点 $x_j = \\cos(\\frac{\\pi j}{N})$（其中 $j=0, \\dots, N$）上计算函数 $u_N(x)$ 的值。节点值向量 $\\hat{u} = (u_N(x_0), \\dots, u_N(x_N))^T$ 可通过切比雪夫-范德蒙德矩阵 $V$ 获得，其元素为 $V_{jk} = T_k(x_j) = \\cos(\\frac{jk\\pi}{N})$。该变换是一个矩阵向量乘积：\n    $$ \\hat{u} = V a $$\n\n2.  **节点空间中的微分：** $u_N$ 在 CGL 节点处的二阶导数，记为 $\\hat{u}''$，可以通过将二阶切比雪夫微分矩阵 $D^{(2)}$ 应用于节点值 $\\hat{u}$ 来计算。该矩阵通过对一阶微分矩阵求平方得到，$D^{(2)} = (D^{(1)})^2$。$D^{(1)}$ 的元素由已有公式给出：\n    $$ (D^{(1)})_{ij} = \\begin{cases} \\frac{\\bar{c}_i (-1)^{i+j}}{\\bar{c}_j (x_i - x_j)}  i \\neq j \\\\ -\\frac{x_j}{2(1-x_j^2)}  0 < i=j < N \\\\ \\frac{2N^2+1}{6}  i=j=0 \\\\ -\\frac{2N^2+1}{6}  i=j=N \\end{cases} $$\n    其中 $\\bar{c}_0 = \\bar{c}_N = 2$，对于 $j=1, \\dots, N-1$，$\\bar{c}_j = 1$。因此，二阶导数的节点值为：\n    $$ \\hat{u}'' = D^{(2)} \\hat{u} = (D^{(1)})^2 V a $$\n\n3.  **节点到模态变换：** 二阶导数的节点值 $\\hat{u}''$ 被投影回切比雪夫基，以获得其模态系数。这通过应用范德蒙德矩阵的逆矩阵 $V^{-1}$ 来实现。设 $c$ 为 $-u_N''(x)$ 的模态系数向量。则：\n    $$ c = -V^{-1} \\hat{u}'' = -V^{-1} (D^{(1)})^2 V a $$\n    矩阵 $L = -V^{-1} (D^{(1)})^2 V$ 就是所求的 $-d^2/dx^2$ 的模态算子。逆范德蒙德矩阵的元素为 $(V^{-1})_{kj} = \\frac{2}{N \\bar{c}_k \\bar{c}_j} T_k(x_j)$。\n\n构建了 $(N+1) \\times (N+1)$ 算子 $L$ 后，我们可以构建系数 $a$ 的线性系统。我们希望求解的方程是 $La = b$，其中 $b$ 是右侧项函数 $f(x)$ 的模态系数向量。对于测试用例，$f(x) = T_m(x)$，因此其模态系数向量 $b$ 是标准基向量 $e_m$，即在索引 $m$ 处为 $1$，其余为零。\n\n陶系统，记为 $A_{\\text{tau}} a = b_{\\text{tau}}$，组装如下：\n-   **偏微分方程强制执行：** 对于前 $N-1$ 个方程（行 $k=0, \\dots, N-2$），我们强制执行偏微分方程。这意味着我们取算子 $L$ 的前 $N-1$ 行和右侧项向量 $b$ 中对应的元素。\n    $$ (A_{\\text{tau}})_{k,:} = L_{k,:} \\quad \\text{以及} \\quad (b_{\\text{tau}})_k = b_k, \\quad \\text{对于 } k = 0, \\dots, N-2 $$\n-   **边界条件强制执行：** 最后两个方程被边界条件取代。\n    -   $u(1)=0 \\implies \\sum_{k=0}^N a_k T_k(1) = \\sum_{k=0}^N a_k = 0$。这为矩阵 $A_{\\text{tau}}$ 提供了行向量 $[1, 1, \\dots, 1]$，为 $b_{\\text{tau}}$ 提供了 $0$。\n    -   $u(-1)=0 \\implies \\sum_{k=0}^N a_k T_k(-1) = \\sum_{k=0}^N (-1)^k a_k = 0$。这为 $A_{\\text{tau}}$ 提供了行向量 $[1, -1, 1, \\dots, (-1)^N]$，为 $b_{\\text{tau}}$ 提供了 $0$。\n\n具体来说，系统的最后两行是：\n$$ (A_{\\text{tau}})_{N-1,:} = [1, 1, \\dots, 1], \\quad (b_{\\text{tau}})_{N-1} = 0 $$\n$$ (A_{\\text{tau}})_{N,:} = [1, -1, 1, \\dots, (-1)^N], \\quad (b_{\\text{tau}})_{N} = 0 $$\n\n求解方形线性系统 $A_{\\text{tau}} a = b_{\\text{tau}}$ 得到系数向量 $a$。然后，问题要求计算三个诊断值以验证方法的正确实现：\n1.  在强制子空间中偏微分方程残差的无穷范数：$\\|L_{0:N-1,:} a - b_{0:N-1}\\|_{\\infty}$。根据陶系统的构造，这个值应接近机器精度。\n2.  满足边界条件的最大绝对误差：$\\max\\{|\\sum_{k=0}^N a_k|, |\\sum_{k=0}^N (-1)^k a_k|\\}$。这也应接近机器精度。\n3.  检查系统矩阵中的陶行是否正确构造：$\\max \\{\\| (A_{\\text{tau}})_{N-1,:} - \\mathbf{1}^T \\|_{\\infty}, \\| (A_{\\text{tau}})_{N,:} - ((-1)^k)^T \\|_{\\infty} \\}$。这个值应精确为零。\n\n以下实现为每个测试用例执行此过程。",
            "answer": "```python\nimport numpy as np\n\ndef chebyshev_diff_matrix(N):\n    \"\"\"\n    Constructs the first-order Chebyshev differentiation matrix on N+1 CGL nodes.\n    \n    Args:\n        N (int): The degree of the polynomial approximation.\n        \n    Returns:\n        np.ndarray: The (N+1)x(N+1) differentiation matrix D.\n    \"\"\"\n    if N == 0:\n        return np.array([[0.0]])\n        \n    n_plus_1 = N + 1\n    j = np.arange(n_plus_1)\n    x = np.cos(np.pi * j / N)\n    \n    # c_bar coefficients\n    c_bar = np.ones(n_plus_1)\n    c_bar[0] = 2.0\n    c_bar[N] = 2.0\n    \n    # Off-diagonal entries\n    X = np.tile(x, (n_plus_1, 1))\n    dX = X - X.T\n    # Add identity to avoid division by zero on the diagonal\n    dX += np.eye(n_plus_1) \n    \n    # Alternating sign matrix\n    signs = (-1.0)**(j[:, None] + j[None, :])\n    \n    # C_ij = c_bar_i / c_bar_j\n    C = c_bar[:, None] / c_bar[None, :]\n    \n    D = C * signs / dX\n    \n    # Diagonal entries\n    np.fill_diagonal(D, 0)\n    D[0, 0] = (2 * N**2 + 1) / 6.0\n    D[N, N] = -(2 * N**2 + 1) / 6.0\n    \n    for jj in range(1, N):\n        D[jj, jj] = -x[jj] / (2.0 * (1.0 - x[jj]**2))\n        \n    return D\n\ndef solve_case(N, m):\n    \"\"\"\n    Solves the Poisson problem for a given N and m, and computes diagnostics.\n    \n    Args:\n        N (int): The degree of the polynomial approximation.\n        m (int): The index of the Chebyshev polynomial for the RHS f(x) = T_m(x).\n    \n    Returns:\n        tuple[float, float, float]: A tuple containing the three diagnostics:\n                                    1. PDE residual norm.\n                                    2. Boundary condition residual.\n                                    3. Tau row construction residual.\n    \"\"\"\n    n_plus_1 = N + 1\n    \n    # 1. Build the foundational matrices\n    # Chebyshev-Gauss-Lobatto nodes and indices\n    j = np.arange(n_plus_1)\n    k = j\n    \n    # First and second differentiation matrices in nodal space\n    D1 = chebyshev_diff_matrix(N)\n    D2 = D1 @ D1\n    \n    # Modal-to-nodal transform (Vandermonde matrix V)\n    V = np.cos(np.outer(j, k) * np.pi / N)\n\n    # Nodal-to-modal transform (Inverse Vandermonde matrix V_inv)\n    c_bar = np.ones(n_plus_1)\n    c_bar[0] = 2.0\n    c_bar[N] = 2.0\n    \n    # Entry (k,j) of V_inv is (2/N) * (1/(c_k * c_j)) * T_k(x_j)\n    # T_k(x_j) is V[j,k] = V.T[k,j]\n    scaling = (2.0 / N) / np.outer(c_bar, c_bar)\n    V_inv = scaling * V.T\n    \n    # 2. Construct the modal operator for -d^2/dx^2\n    L = -V_inv @ D2 @ V\n    \n    # 3. Assemble the tau system A_tau * a = b_tau\n    A_tau = np.zeros((n_plus_1, n_plus_1))\n    b_tau = np.zeros(n_plus_1)\n    \n    # Full RHS modal vector for f(x) = T_m(x)\n    b_full = np.zeros(n_plus_1)\n    if m = N:\n        b_full[m] = 1.0\n        \n    # Enforce PDE on T_0, ..., T_{N-2}\n    # This corresponds to rows 0 to N-2 of the system\n    num_pde_eqs = N - 1\n    if num_pde_eqs  0:\n        A_tau[:num_pde_eqs, :] = L[:num_pde_eqs, :]\n        b_tau[:num_pde_eqs] = b_full[:num_pde_eqs]\n\n    # Enforce boundary conditions\n    # u(1) = 0  => sum(a_k) = 0\n    A_tau[N - 1, :] = 1.0\n    b_tau[N - 1] = 0.0\n    \n    # u(-1) = 0 => sum((-1)^k * a_k) = 0\n    A_tau[N, :] = (-1.0)**k\n    b_tau[N] = 0.0\n    \n    # 4. Solve for the modal coefficients {a_k}\n    a = np.linalg.solve(A_tau, b_tau)\n    \n    # 5. Compute diagnostics\n    # Diagnostic 1: PDE residual norm\n    res_pde = 0.0\n    if num_pde_eqs  0:\n        pde_residual_vec = L[:num_pde_eqs, :] @ a - b_full[:num_pde_eqs]\n        res_pde = np.linalg.norm(pde_residual_vec, np.inf)\n\n    # Diagnostic 2: Boundary condition residual magnitude\n    bc_res_1 = np.abs(np.sum(a))\n    bc_res_2 = np.abs(np.sum(a * ((-1.0)**k)))\n    res_bc = np.max([bc_res_1, bc_res_2])\n    \n    # Diagnostic 3: Tau row construction residual\n    tau_row_1 = np.ones(n_plus_1)\n    tau_row_2 = (-1.0)**k\n    res_tau_1 = np.linalg.norm(A_tau[N-1, :] - tau_row_1, np.inf)\n    res_tau_2 = np.linalg.norm(A_tau[N, :] - tau_row_2, np.inf)\n    res_tau = np.max([res_tau_1, res_tau_2])\n\n    return res_pde, res_bc, res_tau\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        (8, 5),  # Case 1\n        (5, 0),  # Case 2\n        (6, 6)   # Case 3\n    ]\n\n    results = []\n    for N, m in test_cases:\n        pde_res, bc_res, tau_res = solve_case(N, m)\n        results.extend([pde_res, bc_res, tau_res])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于那些物理守恒律至关重要的问题，仅仅强制解在边界处满足给定值可能是不够的。这个高级练习介绍了功能强大的同步近似项（SAT）方法，它通过惩罚项来弱形式地施加边界条件。通过为线性化欧拉方程推导正确的惩罚系数，我们将确保一个基本的物理原理——质量守恒——在离散层面得到精确维持，从而展示分部求和-同步近似项（SBP-SAT）框架的一个关键优势。",
            "id": "3367664",
            "problem": "考虑在区间 $x \\in [-1,1]$ 上，关于密度为 $\\rho_{0}  0$、速度为 $u_{0} = 0$、压力为 $p_{0}  0$ 的均匀平衡态的一维线性化可压缩欧拉方程。扰动量 $\\rho(x,t)$、$u(x,t)$ 和 $p(x,t)$ 的线性化系统为\n$$\n\\rho_{t} + \\rho_{0}\\,u_{x} = 0,\\quad\nu_{t} + \\frac{1}{\\rho_{0}}\\,p_{x} = 0,\\quad\np_{t} + \\gamma p_{0}\\,u_{x} = 0,\n$$\n其中比热比 $\\gamma  1$。在节点 $x_{j} = \\cos\\!\\left(\\frac{\\pi j}{N}\\right)$（$j=0,\\dots,N$）处，通过 Chebyshev–Gauss–Lobatto 配置法对 $x \\in [-1,1]$ 进行离散化。设微分矩阵为 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，对角求积/范数矩阵为 $H = \\mathrm{diag}(h_{0},\\dots,h_{N})$，使得分部求和 (SBP) 性质成立：若 $Q := H D$，则\n$$\nQ + Q^{\\top} = B,\\quad B = \\mathrm{diag}(-1,0,\\dots,0,1).\n$$\n在两个边界上施加不可穿透的完全反射壁条件，即在 $x=-1$ 和 $x=1$ 处有边界条件 $u=0$。仅在质量方程中使用同步近似项 (SAT) 方法，将半离散质量方程写为\n$$\nH\\,\\dot{\\rho} + \\rho_{0}\\,Q\\,u = \\mathrm{SAT}_{\\rho},\\quad\n\\mathrm{SAT}_{\\rho} = H^{-1}\\!\\left(\\tau_{L}\\,e_{0}\\,u_{0} + \\tau_{R}\\,e_{N}\\,u_{N}\\right),\n$$\n其中 $e_{0},e_{N} \\in \\mathbb{R}^{N+1}$ 是提取边界自由度的标准基向量，$u_{0}$ 和 $u_{N}$ 表示 $u$ 在 $x=-1$ 和 $x=1$ 处的离散边界值，$\\tau_{L},\\tau_{R} \\in \\mathbb{R}$ 是待选的罚系数（常数）。\n\n从线性化方程和 SBP 性质的定义出发，推导总质量 $M(t) := \\mathbf{1}^{\\top} H\\,\\rho(t)$（其中 $\\mathbf{1} = [1,\\dots,1]^{\\top} \\in \\mathbb{R}^{N+1}$）的精确离散守恒律，并获得关于 $\\tau_{L}$ 和 $\\tau_{R}$ 的代数条件，以保证在边界数据强制两端 $u_{\\mathrm{bc}}=0$ 的情况下，对于任意离散状态，在离散意义上没有净质量泄漏，即 $\\frac{d}{dt}M(t) = 0$。然后选择 $\\tau_{L}$ 和 $\\tau_{R}$，使得对于任何 $N$、任何 $\\rho_{0}  0$ 以及定义 $H$ 的任何 Chebyshev 权重 $h_{0},\\dots,h_{N}$，该性质都能恒成立（在舍入误差范围内）。\n\n用 $\\rho_{0}$、$h_{0}$ 和 $h_{N}$ 给出 $\\tau_{L}$ 和 $\\tau_{R}$ 的解析表达式作为你的最终答案。将最终答案表示为包含这两个系数的单行矩阵。无需进行数值近似。",
            "solution": "本题要求为线性化质量守恒方程的分部求和-同步近似项 (SBP-SAT) 离散化方法推导罚系数 $\\tau_{L}$ 和 $\\tau_{R}$，以使总离散质量守恒。\n\n总离散质量定义为 $M(t) := \\mathbf{1}^{\\top} H\\,\\rho(t)$，其中 $\\rho(t) \\in \\mathbb{R}^{N+1}$ 是配置点上密度扰动的向量，$H$ 是对角求积矩阵，$\\mathbf{1} \\in \\mathbb{R}^{N+1}$ 是全为 1 的向量。为确保没有净质量泄漏，我们必须有 $\\frac{d}{dt}M(t) = 0$。\n\n我们来计算 $M(t)$ 的时间导数：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\left(\\mathbf{1}^{\\top} H\\,\\rho(t)\\right)\n$$\n由于向量 $\\mathbf{1}$ 和矩阵 $H$ 不随时间变化，导数仅作用于 $\\rho(t)$：\n$$\n\\frac{dM}{dt} = \\mathbf{1}^{\\top} \\left(H\\,\\frac{d\\rho}{dt}\\right) = \\mathbf{1}^{\\top} H\\,\\dot{\\rho}\n$$\n题目给出了半离散质量方程：\n$$\nH\\,\\dot{\\rho} + \\rho_{0}\\,Q\\,u = \\mathrm{SAT}_{\\rho}\n$$\n其中 $Q = H D$。我们可以将 $H\\,\\dot{\\rho}$ 表示为：\n$$\nH\\,\\dot{\\rho} = -\\rho_{0}\\,Q\\,u + \\mathrm{SAT}_{\\rho}\n$$\n将其代入 $\\frac{dM}{dt}$ 的表达式中：\n$$\n\\frac{dM}{dt} = \\mathbf{1}^{\\top} \\left(-\\rho_{0}\\,Q\\,u + \\mathrm{SAT}_{\\rho}\\right) = -\\rho_{0}\\,\\mathbf{1}^{\\top}Q\\,u + \\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho}\n$$\n我们现在分别分析右侧的两项。\n\n对于第一项 $-\\rho_{0}\\,\\mathbf{1}^{\\top}Q\\,u$，我们使用 SBP 性质。项 $\\mathbf{1}^{\\top}Q\\,u$ 是一个标量，因此它等于其转置：\n$$\n\\mathbf{1}^{\\top}Q\\,u = \\left(\\mathbf{1}^{\\top}Q\\,u\\right)^{\\top} = u^{\\top}Q^{\\top}\\mathbf{1}\n$$\nSBP 性质表明 $Q + Q^{\\top} = B$，这意味着 $Q^{\\top} = B - Q$。代入此式可得：\n$$\nu^{\\top}Q^{\\top}\\mathbf{1} = u^{\\top}(B - Q)\\mathbf{1} = u^{\\top}B\\,\\mathbf{1} - u^{\\top}Q\\,\\mathbf{1}\n$$\n我们来计算这两个部分。首先是 $u^{\\top}B\\,\\mathbf{1}$，其中 $B = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$：\n$$\nB\\,\\mathbf{1} = \\begin{pmatrix} -1   \\\\  0  \\\\   \\ddots  \\\\    0  \\\\     1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n然后，与 $u^{\\top} = [u_0, u_1, \\dots, u_N]$ 的乘积为：\n$$\nu^{\\top}B\\,\\mathbf{1} = [u_{0}, u_{1}, \\dots, u_{N}] \\begin{pmatrix} -1 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} = -u_{0} + u_{N}\n$$\n对于第二部分 $u^{\\top}Q\\,\\mathbf{1}$，我们回顾 $Q = HD$。由于 $D$ 是一个微分矩阵，它作用于向量 $\\mathbf{1}$（代表一个常数函数）时产生零向量，即 $D\\mathbf{1} = \\mathbf{0}$。因此：\n$$\nQ\\,\\mathbf{1} = H D \\mathbf{1} = H \\mathbf{0} = \\mathbf{0}\n$$\n这导致 $u^{\\top}Q\\,\\mathbf{1} = u^{\\top}\\mathbf{0} = 0$。\n综合这些结果，我们发现 $\\mathbf{1}^{\\top}Q\\,u = -u_{0} + u_{N}$。因此，$\\frac{dM}{dt}$ 表达式中的第一项为：\n$$\n-\\rho_{0}\\,\\mathbf{1}^{\\top}Q\\,u = -\\rho_{0}(-u_{0} + u_{N}) = \\rho_{0}(u_{0} - u_{N})\n$$\n\n对于第二项 $\\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho}$，我们使用给定的定义：\n$$\n\\mathrm{SAT}_{\\rho} = H^{-1}\\!\\left(\\tau_{L}\\,e_{0}\\,u_{0} + \\tau_{R}\\,e_{N}\\,u_{N}\\right)\n$$\n其中 $H=\\mathrm{diag}(h_0, \\dots, h_N)$，$e_0=[1,0,\\dots,0]^\\top$，$e_N=[0,\\dots,0,1]^\\top$。那么：\n$$\n\\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho} = \\mathbf{1}^{\\top} H^{-1}(\\tau_{L}\\,e_{0}\\,u_{0} + \\tau_{R}\\,e_{N}\\,u_{N}) = \\tau_L u_0 (\\mathbf{1}^\\top H^{-1} e_0) + \\tau_R u_N (\\mathbf{1}^\\top H^{-1} e_N)\n$$\n括号中的项是标量。我们有 $H^{-1} = \\mathrm{diag}(h_0^{-1}, \\dots, h_N^{-1})$。\n$$\n\\mathbf{1}^{\\top} H^{-1} e_0 = [1, \\dots, 1] \\begin{pmatrix} h_0^{-1} \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix} = h_0^{-1}\n$$\n$$\n\\mathbf{1}^{\\top} H^{-1} e_N = [1, \\dots, 1] \\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ h_N^{-1} \\end{pmatrix} = h_N^{-1}\n$$\n所以，$\\frac{dM}{dt}$ 表达式中的第二项是：\n$$\n\\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho} = \\frac{\\tau_L}{h_0}u_0 + \\frac{\\tau_R}{h_N}u_N\n$$\n\n合并两项，总质量变化率为：\n$$\n\\frac{dM}{dt} = \\rho_{0}(u_{0} - u_{N}) + \\frac{\\tau_L}{h_0}u_0 + \\frac{\\tau_R}{h_N}u_N\n$$\n将边界速度值 $u_0$ 和 $u_N$ 的系数分组：\n$$\n\\frac{dM}{dt} = \\left(\\rho_{0} + \\frac{\\tau_L}{h_0}\\right)u_0 + \\left(-\\rho_{0} + \\frac{\\tau_R}{h_N}\\right)u_N\n$$\n题目要求该守恒性质对于“任意离散状态”都“恒”成立。这意味着无论 $u_0$ 和 $u_N$ 的值如何，$\\frac{dM}{dt}$ 都必须为零，而 $u_0$ 和 $u_N$ 是数值解向量 $u$ 的分量。由于可以构造出 $u_0 \\neq 0$ 同时 $u_N=0$ 的离散多项式状态，反之亦然，因此要使该表达式恒为零，唯一的途径是 $u_0$ 和 $u_N$ 的系数各自独立为零。\n\n1.  $u_0$ 的系数：\n    $$\n    \\rho_{0} + \\frac{\\tau_L}{h_0} = 0 \\implies \\tau_L = -\\rho_{0}\\,h_0\n    $$\n2.  $u_N$ 的系数：\n    $$\n    -\\rho_{0} + \\frac{\\tau_R}{h_N} = 0 \\implies \\tau_R = \\rho_{0}\\,h_N\n    $$\n\n对 $\\tau_L$ 和 $\\tau_R$ 的这些选择保证了对于任何离散解，$\\frac{dM}{dt} = 0$ 均成立，从而确保半离散化是精确质量守恒的。最终答案要求将这两个系数写在一个行矩阵中。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\rho_{0} h_{0}  \\rho_{0} h_{N} \\end{pmatrix}}\n$$"
        }
    ]
}