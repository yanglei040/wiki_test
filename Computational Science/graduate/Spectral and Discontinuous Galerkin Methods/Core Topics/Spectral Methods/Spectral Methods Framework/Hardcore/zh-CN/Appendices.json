{
    "hands_on_practices": [
        {
            "introduction": "谱方法的核心思想之一是将解投影到一个由一组基函数张成的有限维空间中。伽辽金方法（Galerkin method）通过要求残差与每个基函数正交，为我们提供了一种系统性的投影方式。本练习  将从最经典的情形入手：使用三角多项式作为基函数，在周期域上计算一个简单函数的傅里叶级数。这个过程不仅能加深你对伽辽金投影原理的理解，还能展示如何利用函数的对称性来简化计算。",
            "id": "3419311",
            "problem": "考虑在标准 $L^{2}([-\\pi,\\pi])$ 框架下，将一个函数在区间 $[-\\pi,\\pi]$ 上谱伽辽金投影到三角多项式上。令 $u(x)=x$。利用三角函数系关于内积 $(f,g) = \\int_{-\\pi}^{\\pi} f(x) g(x)\\,\\mathrm{d}x$ 的正交性，以及伽辽金系数是通过强制残差与每个基函数正交而产生的原理，推导 $u$ 的傅里叶级数展开式，其形式为\n$$\nu(x) \\sim \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty} a_{n}\\cos(nx) + \\sum_{n=1}^{\\infty} b_{n}\\sin(nx).\n$$\n你的推导必须从三角基的投影特性和正交关系出发，并且不得假定任何已有的系数公式。具体而言：\n- 利用对称性，确定并证明哪些系数子集必须为零。\n- 通过从基本原理出发计算所需积分，精确地计算出剩余的非零系数。\n- 根据 $L^{2}([-\\pi,\\pi])$ 分解为偶函数子空间和奇函数子空间，以及伽辽金投影对于奇偶性的不变性，来解释系数为零的现象。\n\n将你的最终答案表示为 $u(x)$ 在 $[-\\pi,\\pi]$ 上的单一闭式级数表示，并利用你所建立的对称性进行简化。不需要进行数值舍入，也不涉及物理单位。最终答案必须是单一的解析表达式。",
            "solution": "本题要求使用谱伽辽金投影框架，推导函数 $u(x) = x$ 在区间 $[-\\pi, \\pi]$ 上的傅里叶级数。推导过程必须从正交性原理出发，并明确阐述对称性的作用。\n\n令 $V_N$ 为次数至多为 $N$ 的三角多项式空间，由区间 $[-\\pi, \\pi]$ 上的正交基函数 $\\{1, \\cos(nx), \\sin(nx)\\}_{n=1}^{N}$ 张成。内积定义为 $(f,g) = \\int_{-\\pi}^{\\pi} f(x)g(x)\\,\\mathrm{d}x$。\n\n$u(x)$ 到 $V_N$ 上的谱伽辽金投影记为 $u_N(x)$，它是 $V_N$ 中使误差 $\\|u - u_N\\|_{L^2}$ 最小化的函数。这等价于要求残差 $R(x) = u(x) - u_N(x)$ 与 $V_N$ 中的每一个基函数都正交。\n投影 $u_N(x)$ 写为：\n$$\nu_N(x) = \\frac{a_0}{2} + \\sum_{n=1}^{N} \\left( a_n \\cos(nx) + b_n \\sin(nx) \\right)\n$$\n正交条件是：\n\\begin{enumerate}\n    \\item $(u - u_N, 1) = 0$\n    \\item $(u - u_N, \\cos(mx)) = 0$ 对于 $m=1, 2, \\dots, N$\n    \\item $(u - u_N, \\sin(mx)) = 0$ 对于 $m=1, 2, \\dots, N$\n\\end{enumerate}\n\n利用内积的线性性质，这些条件变为：\n\\begin{enumerate}\n    \\item $(u, 1) = (u_N, 1)$\n    \\item $(u, \\cos(mx)) = (u_N, \\cos(mx))$\n    \\item $(u, \\sin(mx)) = (u_N, \\sin(mx))$\n\\end{enumerate}\n\n对于整数 $n, m \\ge 1$，三角基函数满足以下正交关系：\n$$\n\\int_{-\\pi}^{\\pi} \\cos(nx)\\cos(mx)\\,\\mathrm{d}x = \\pi\\delta_{nm}\n$$\n$$\n\\int_{-\\pi}^{\\pi} \\sin(nx)\\sin(mx)\\,\\mathrm{d}x = \\pi\\delta_{nm}\n$$\n$$\n\\int_{-\\pi}^{\\pi} \\cos(nx)\\sin(mx)\\,\\mathrm{d}x = 0\n$$\n$$\n\\int_{-\\pi}^{\\pi} 1 \\cdot \\cos(nx)\\,\\mathrm{d}x = 0\n$$\n$$\n\\int_{-\\pi}^{\\pi} 1 \\cdot \\sin(nx)\\,\\mathrm{d}x = 0\n$$\n$$\n\\int_{-\\pi}^{\\pi} 1 \\cdot 1\\,\\mathrm{d}x = 2\\pi\n$$\n其中 $\\delta_{nm}$ 是克罗内克δ。\n\n现在我们可以推导系数的一般公式。\n对于 $m \\ge 1$ 的 $a_m$：\n$$\n(u, \\cos(mx)) = \\left(\\frac{a_0}{2} + \\sum_{n=1}^{N} a_n \\cos(nx) + \\sum_{n=1}^{N} b_n \\sin(nx), \\cos(mx)\\right)\n$$\n根据线性性质和正交性，右边的所有项都为零，除了 $n=m$ 的那一项：\n$$\n(u, \\cos(mx)) = a_m (\\cos(mx), \\cos(mx)) = a_m \\pi\n$$\n$$\n\\implies a_m = \\frac{1}{\\pi} (u, \\cos(mx)) = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} u(x)\\cos(mx)\\,\\mathrm{d}x\n$$\n对 $b_m$ 进行类似的处理：\n$$\n(u, \\sin(mx)) = b_m (\\sin(mx), \\sin(mx)) = b_m \\pi\n$$\n$$\n\\implies b_m = \\frac{1}{\\pi} (u, \\sin(mx)) = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} u(x)\\sin(mx)\\,\\mathrm{d}x\n$$\n对于 $a_0$：\n$$\n(u, 1) = \\left(\\frac{a_0}{2}, 1\\right) = \\frac{a_0}{2} (1, 1) = \\frac{a_0}{2} (2\\pi) = a_0 \\pi\n$$\n$$\n\\implies a_0 = \\frac{1}{\\pi} (u, 1) = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} u(x)\\,\\mathrm{d}x\n$$\n本题考虑 $N \\to \\infty$ 的极限情况。\n\n现在，我们特化到 $u(x) = x$ 的情况。\n首先，我们利用对称性来确定哪些系数为零。如果 $f(-x) = f(x)$，则函数 $f(x)$ 是偶函数；如果 $f(-x) = -f(x)$，则函数是奇函数。函数 $u(x) = x$ 是一个奇函数。基函数 $\\cos(nx)$ 对所有 $n \\ge 0$ (包括常数函数 $1$，即 $\\cos(0x)$) 都是偶函数，而 $\\sin(nx)$ 对所有 $n \\ge 1$ 都是奇函数。\n奇函数 $f_{odd}(x)$ 在对称区间 $[-\\pi, \\pi]$ 上的积分恒为零：$\\int_{-\\pi}^{\\pi} f_{odd}(x)\\,\\mathrm{d}x = 0$。\n系数 $a_n$ 是通过 $u(x)\\cos(nx) = x\\cos(nx)$ 的积分计算的。一个奇函数 ($x$) 和一个偶函数 ($\\cos(nx)$) 的乘积是奇函数。因此，被积函数 $x\\cos(nx)$ 是奇函数。\n对于 $n \\ge 1$：\n$$\na_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x\\cos(nx)\\,\\mathrm{d}x = 0\n$$\n对于 $n=0$：\n$$\na_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x\\,\\mathrm{d}x = 0\n$$\n因此，由于奇偶性，所有 $n \\ge 0$ 的系数 $a_n$ 都必须为零。\n\n接下来，我们计算非零系数 $b_n$。$b_n$ 的被積函數是 $u(x)\\sin(nx) = x\\sin(nx)$。两个奇函数 ($x$ 和 $\\sin(nx)$) 的乘积是偶函数。偶函数 $f_{even}(x)$ 在 $[-\\pi, \\pi]$ 上的积分等于 $2\\int_{0}^{\\pi} f_{even}(x)\\,\\mathrm{d}x$。系数 $b_n$ 通常不为零。\n$$\nb_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x\\sin(nx)\\,\\mathrm{d}x\n$$\n我们使用分部积分法 $\\int U\\,\\mathrm{d}V = UV - \\int V\\,\\mathrm{d}U$ 来计算该积分。令 $U=x$ 且 $\\mathrm{d}V=\\sin(nx)\\,\\mathrm{d}x$。则 $\\mathrm{d}U=\\mathrm{d}x$ 且 $V = -\\frac{1}{n}\\cos(nx)$。\n$$\n\\int x\\sin(nx)\\,\\mathrm{d}x = x\\left(-\\frac{1}{n}\\cos(nx)\\right) - \\int \\left(-\\frac{1}{n}\\cos(nx)\\right)\\,\\mathrm{d}x = -\\frac{x}{n}\\cos(nx) + \\frac{1}{n}\\int\\cos(nx)\\,\\mathrm{d}x = -\\frac{x}{n}\\cos(nx) + \\frac{1}{n^2}\\sin(nx)\n$$\n现在，我们计算定积分：\n$$\n\\int_{-\\pi}^{\\pi} x\\sin(nx)\\,\\mathrm{d}x = \\left[ -\\frac{x}{n}\\cos(nx) + \\frac{1}{n^2}\\sin(nx) \\right]_{-\\pi}^{\\pi}\n$$\n$$\n= \\left( -\\frac{\\pi}{n}\\cos(n\\pi) + \\frac{1}{n^2}\\sin(n\\pi) \\right) - \\left( -\\frac{(-\\pi)}{n}\\cos(-n\\pi) + \\frac{1}{n^2}\\sin(-n\\pi) \\right)\n$$\n使用 $\\cos(n\\pi) = (-1)^n$、$\\cos(-n\\pi) = \\cos(n\\pi)$、$\\sin(n\\pi)=0$ 和 $\\sin(-n\\pi) = -\\sin(n\\pi)=0$：\n$$\n= \\left( -\\frac{\\pi}{n}(-1)^n + 0 \\right) - \\left( \\frac{\\pi}{n}(-1)^n - 0 \\right) = -\\frac{2\\pi}{n}(-1)^n = \\frac{2\\pi}{n}(-1)^{n+1}\n$$\n将此结果代回 $b_n$ 的公式中：\n$$\nb_n = \\frac{1}{\\pi} \\left( \\frac{2\\pi}{n}(-1)^{n+1} \\right) = \\frac{2}{n}(-1)^{n+1}\n$$\n$u(x)=x$ 的傅里叶级数因此是一个纯正弦级数：\n$$\nu(x) \\sim \\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n}\\sin(nx)\n$$\n\n最后，我们在 $L^2([-\\pi, \\pi])$ 分解的背景下解释系数为零的现象。希尔伯特空间 $L^2([-\\pi, \\pi])$ 可以分解为偶函数子空间 $L^2_{even}$ 和奇函数子空间 $L^2_{odd}$ 的正交直和：\n$$\nL^2([-\\pi, \\pi]) = L^2_{even} \\oplus L^2_{odd}\n$$\n这意味着任何函数 $f \\in L^2$ 都可以唯一地写成 $f = f_{even} + f_{odd}$，其中 $f_{even} \\in L^2_{even}$ 且 $f_{odd} \\in L^2_{odd}$，并且 $(f_{even}, f_{odd}) = 0$。\n三角多项式的基也按奇偶性划分。集合 $\\{1, \\cos(nx)\\}_{n=1}^\\infty$ 是所有三角多项式空间内偶函数子空间的一个基。集合 $\\{\\sin(nx)\\}_{n=1}^\\infty$ 是奇函数子空间的一个基。\n伽辽金投影是一个继承了内积性质的线性算子。具体来说，它保持奇偶性分解。如果我们将一个奇函数 $u \\in L^2_{odd}$ 投影到三角多项式空间上，其投影也必须是一个奇函数。一个奇三角多项式仅仅是 $\\sin(nx)$ 项的线性组合。因此，它在偶函数子空间中的分量（由 $\\cos(nx)$ 项的系数 $a_n$ 决定）必须全部为零。\n在本问题中，$u(x)=x$ 是一个奇函数。它的伽辽金投影必须是一个奇三角多项式，即一个正弦级数。这直接意味着对于所有 $n \\ge 0$都有 $a_n=0$，我们的直接计算也证实了这一结论。这表明了伽辽金投影对于奇偶性的不变性。\n\n该级数的最终表达式是：\n$$\nx \\sim 2\\left(\\sin(x) - \\frac{1}{2}\\sin(2x) + \\frac{1}{3}\\sin(3x) - \\dots\\right) = \\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n}\\sin(nx)\n$$",
            "answer": "$$\n\\boxed{\\sum_{n=1}^{\\infty}\\frac{2(-1)^{n+1}}{n}\\sin(nx)}\n$$"
        },
        {
            "introduction": "虽然傅里叶级数在处理周期性问题时非常强大，但许多科学和工程问题定义在有限的非周期域上。在这种情况下，我们需要使用不同的正交多项式基底，例如勒让德多项式（Legendre polynomials）。本练习  将伽辽金投影的思想扩展到非周期区间 $[-1, 1]$ 上。你将亲手计算一个函数在勒让德基下的最佳多项式逼近，这是在有限域上应用谱方法求解微分方程的关键一步。",
            "id": "3419277",
            "problem": "令 $L^{2}([-1,1])$ 为 $[-1,1]$ 上的平方可积函数构成的 Hilbert 空间，其标准内积为 $\\langle f,g\\rangle=\\int_{-1}^{1} f(x)\\,g(x)\\,dx$。考虑 Legendre 多项式 $\\{P_{n}(x)\\}_{n\\geq 0}$，它们在 $L^{2}([-1,1])$ 中关于权重 $1$ 形成一个正交基，满足 $\\int_{-1}^{1} P_{n}(x)\\,P_{m}(x)\\,dx=\\frac{2}{2n+1}\\,\\delta_{nm}$，其具体形式为 $P_{0}(x)=1$, $P_{1}(x)=x$, $P_{2}(x)=\\frac{1}{2}(3x^{2}-1)$, $P_{3}(x)=\\frac{1}{2}(5x^{3}-3x)$。令 $u(x)=\\exp(x)$。\n\n从 Hilbert 空间中正交投影的定义以及 Legendre 基的正交性出发，确定在 $L^{2}([-1,1])$ 中逼近 $u(x)$ 的次数至多为 $N=3$ 的最佳多项式。将该多项式 $p_{3}(x)$ 表示为单个闭式解析表达式。请勿四舍五入；提供精确表达式。",
            "solution": "该问题陈述经证实具有科学依据、是适定的且客观的。这是数值分析和谱方法领域中逼近论的一个标准问题。所有必要的数据和定义均已提供，不存在矛盾或歧义。\n\n该问题要求在 $L^2([-1,1])$ 范数下，求函数 $u(x) = \\exp(x)$ 在区间 $[-1,1]$ 上的次数至多为 $N=3$ 的最佳多项式逼近。在 Hilbert 空间中，最佳逼近由函数到指定子空间的正交投影给出。在本例中，子空间是 $\\mathcal{P}_3$，即所有次数至多为 $3$ 的多项式组成的空间。\n\nLegendre 多项式 $\\{P_n(x)\\}_{n=0}^{\\infty}$ 构成了 $L^2([-1,1])$ 的一个完备正交基。子空间 $\\mathcal{P}_3$ 由前四个 Legendre 多项式 $\\{P_0(x), P_1(x), P_2(x), P_3(x)\\}$ 张成。$u(x)$ 到 $\\mathcal{P}_3$ 上的正交投影（记作 $p_3(x)$）由 $u(x)$ 的截断 Legendre 级数展开给出：\n$$\np_3(x) = \\sum_{n=0}^{3} \\hat{u}_n P_n(x)\n$$\n其中系数 $\\hat{u}_n$ 是 $u(x)$ 关于 Legendre 基的广义 Fourier 系数。这些系数通过内积 $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)dx$ 计算。\n\n根据正交关系 $\\langle P_n, P_m \\rangle = \\int_{-1}^{1} P_n(x)P_m(x)dx = \\frac{2}{2n+1}\\delta_{nm}$，通过计算 $u(x)$ 与 $P_n(x)$ 的内积可以求得系数 $\\hat{u}_n$：\n$$\n\\langle u, P_n \\rangle = \\left\\langle \\sum_{k=0}^{\\infty} \\hat{u}_k P_k, P_n \\right\\rangle = \\sum_{k=0}^{\\infty} \\hat{u}_k \\langle P_k, P_n \\rangle = \\hat{u}_n \\langle P_n, P_n \\rangle = \\hat{u}_n \\frac{2}{2n+1}\n$$\n这给出了系数的计算公式：\n$$\n\\hat{u}_n = \\frac{\\langle u, P_n \\rangle}{\\langle P_n, P_n \\rangle} = \\frac{2n+1}{2} \\int_{-1}^{1} u(x)P_n(x)dx\n$$\n对于本问题，$u(x) = \\exp(x)$。我们需要计算系数 $\\hat{u}_0, \\hat{u}_1, \\hat{u}_2, \\hat{u}_3$。这需要计算 $n=0, 1, 2, 3$ 时的积分 $\\int_{-1}^{1} \\exp(x) P_n(x) dx$。给定的 Legendre 多项式为：\n$P_0(x) = 1$\n$P_1(x) = x$\n$P_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$P_3(x) = \\frac{1}{2}(5x^3 - 3x)$\n\n为计算所需的积分，我们首先计算 $\\exp(x)$ 在 $[-1,1]$ 上的矩，即形如 $\\int_{-1}^{1} x^k \\exp(x) dx$ 的积分。这些积分可以用分部积分法求解。\n令 $I_k = \\int_{-1}^{1} x^k \\exp(x) dx$。\n对于 $k=0$：\n$I_0 = \\int_{-1}^{1} \\exp(x) dx = [\\exp(x)]_{-1}^{1} = \\exp(1) - \\exp(-1)$。\n对于 $k=1$：\n$I_1 = \\int_{-1}^{1} x \\exp(x) dx = [x\\exp(x) - \\exp(x)]_{-1}^{1} = (1\\exp(1) - \\exp(1)) - (-1\\exp(-1) - \\exp(-1)) = 0 - (-2\\exp(-1)) = 2\\exp(-1)$。\n对于 $k=2$：\n$I_2 = \\int_{-1}^{1} x^2 \\exp(x) dx = [(x^2-2x+2)\\exp(x)]_{-1}^{1} = ((1)^2-2(1)+2)\\exp(1) - ((-1)^2-2(-1)+2)\\exp(-1) = (1-2+2)\\exp(1) - (1+2+2)\\exp(-1) = \\exp(1) - 5\\exp(-1)$。\n对于 $k=3$：\n$I_3 = \\int_{-1}^{1} x^3 \\exp(x) dx = [(x^3-3x^2+6x-6)\\exp(x)]_{-1}^{1} = ((1)^3-3(1)^2+6(1)-6)\\exp(1) - ((-1)^3-3(-1)^2+6(-1)-6)\\exp(-1) = (1-3+6-6)\\exp(1) - (-1-3-6-6)\\exp(-1) = -2\\exp(1) + 16\\exp(-1)$。\n\n现在我们计算内积 $\\langle \\exp(x), P_n(x) \\rangle$：\n对于 $n=0$： $\\langle u, P_0 \\rangle = \\int_{-1}^{1} \\exp(x) \\cdot 1 dx = I_0 = \\exp(1) - \\exp(-1)$。\n对于 $n=1$： $\\langle u, P_1 \\rangle = \\int_{-1}^{1} \\exp(x) \\cdot x dx = I_1 = 2\\exp(-1)$。\n对于 $n=2$： $\\langle u, P_2 \\rangle = \\int_{-1}^{1} \\exp(x) \\frac{1}{2}(3x^2-1) dx = \\frac{3}{2}I_2 - \\frac{1}{2}I_0 = \\frac{3}{2}(\\exp(1) - 5\\exp(-1)) - \\frac{1}{2}(\\exp(1) - \\exp(-1)) = (\\frac{3}{2}-\\frac{1}{2})\\exp(1) + (-\\frac{15}{2}+\\frac{1}{2})\\exp(-1) = \\exp(1) - 7\\exp(-1)$。\n对于 $n=3$： $\\langle u, P_3 \\rangle = \\int_{-1}^{1} \\exp(x) \\frac{1}{2}(5x^3-3x) dx = \\frac{5}{2}I_3 - \\frac{3}{2}I_1 = \\frac{5}{2}(-2\\exp(1) + 16\\exp(-1)) - \\frac{3}{2}(2\\exp(-1)) = -5\\exp(1) + 40\\exp(-1) - 3\\exp(-1) = -5\\exp(1) + 37\\exp(-1)$。\n\n接下来，我们计算系数 $\\hat{u}_n$：\n$\\hat{u}_0 = \\frac{1}{2} \\langle u, P_0 \\rangle = \\frac{1}{2}(\\exp(1) - \\exp(-1))$。\n$\\hat{u}_1 = \\frac{3}{2} \\langle u, P_1 \\rangle = \\frac{3}{2}(2\\exp(-1)) = 3\\exp(-1)$。\n$\\hat{u}_2 = \\frac{5}{2} \\langle u, P_2 \\rangle = \\frac{5}{2}(\\exp(1) - 7\\exp(-1))$。\n$\\hat{u}_3 = \\frac{7}{2} \\langle u, P_3 \\rangle = \\frac{7}{2}(-5\\exp(1) + 37\\exp(-1))$。\n\n最后，我们将这些系数和 Legendre 多项式的具体形式代入求和式中，然后按 $x$ 的幂次合并同类项，从而构造出多项式 $p_3(x)$。\n$$\np_3(x) = \\hat{u}_0 P_0(x) + \\hat{u}_1 P_1(x) + \\hat{u}_2 P_2(x) + \\hat{u}_3 P_3(x)\n$$\n$$\np_3(x) = \\hat{u}_0(1) + \\hat{u}_1(x) + \\hat{u}_2\\left(\\frac{3}{2}x^2 - \\frac{1}{2}\\right) + \\hat{u}_3\\left(\\frac{5}{2}x^3 - \\frac{3}{2}x\\right)\n$$\n该多项式为 $p_3(x) = c_3x^3 + c_2x^2 + c_1x + c_0$，其中系数为：\n$c_3 = \\frac{5}{2}\\hat{u}_3 = \\frac{5}{2} \\cdot \\frac{7}{2}(-5\\exp(1) + 37\\exp(-1)) = \\frac{35}{4}(-5\\exp(1) + 37\\exp(-1)) = \\frac{-175\\exp(1) + 1295\\exp(-1)}{4}$。\n$c_2 = \\frac{3}{2}\\hat{u}_2 = \\frac{3}{2} \\cdot \\frac{5}{2}(\\exp(1) - 7\\exp(-1)) = \\frac{15}{4}(\\exp(1) - 7\\exp(-1)) = \\frac{15\\exp(1) - 105\\exp(-1)}{4}$。\n$c_1 = \\hat{u}_1 - \\frac{3}{2}\\hat{u}_3 = 3\\exp(-1) - \\frac{3}{2} \\cdot \\frac{7}{2}(-5\\exp(1) + 37\\exp(-1)) = 3\\exp(-1) - \\frac{21}{4}(-5\\exp(1) + 37\\exp(-1)) = \\frac{12\\exp(-1) + 105\\exp(1) - 777\\exp(-1)}{4} = \\frac{105\\exp(1) - 765\\exp(-1)}{4}$。\n$c_0 = \\hat{u}_0 - \\frac{1}{2}\\hat{u}_2 = \\frac{1}{2}(\\exp(1) - \\exp(-1)) - \\frac{1}{2} \\cdot \\frac{5}{2}(\\exp(1) - 7\\exp(-1)) = \\frac{1}{2}(\\exp(1) - \\exp(-1)) - \\frac{5}{4}(\\exp(1) - 7\\exp(-1)) = \\frac{2(\\exp(1) - \\exp(-1)) - 5(\\exp(1) - 7\\exp(-1))}{4} = \\frac{2\\exp(1) - 2\\exp(-1) - 5\\exp(1) + 35\\exp(-1)}{4} = \\frac{-3\\exp(1) + 33\\exp(-1)}{4}$。\n\n因此，次数至多为 $3$ 的最佳 $L^2$ 多项式逼近为：\n$$\np_3(x) = \\left(\\frac{-175\\exp(1) + 1295\\exp(-1)}{4}\\right)x^3 + \\left(\\frac{15\\exp(1) - 105\\exp(-1)}{4}\\right)x^2 + \\left(\\frac{105\\exp(1) - 765\\exp(-1)}{4}\\right)x + \\left(\\frac{-3\\exp(1) + 33\\exp(-1)}{4}\\right)\n$$",
            "answer": "$$\n\\boxed{\\left(\\frac{-175\\exp(1) + 1295\\exp(-1)}{4}\\right)x^3 + \\left(\\frac{15\\exp(1) - 105\\exp(-1)}{4}\\right)x^2 + \\left(\\frac{105\\exp(1) - 765\\exp(-1)}{4}\\right)x + \\left(\\frac{-3\\exp(1) + 33\\exp(-1)}{4}\\right)}\n$$"
        },
        {
            "introduction": "与基于积分的伽辽金方法相比，谱配置法（spectral collocation method）在实际应用中通常更容易实现。配置法的核心思想是要求微分方程在一些预先选定的配置点上精确满足。本练习  将引导你构建和应用一个谱微分矩阵，这是配置法中的一个关键工具。通过在切比雪夫点（Chebyshev points）上操作，这个练习将抽象的微分运算转化为具体的矩阵向量乘法，为高效求解微分方程铺平了道路。",
            "id": "3419278",
            "problem": "您需要在一个谱方法框架内实现一个多项式配置方案，使用 Chebyshev–Gauss–Lobatto 点。重点是构建微分矩阵，该矩阵通过对拉格朗日插值多项式求导，将节点值映射到导数的节点值。这是一个纯数学问题，不需要物理单位，但所有三角函数求值都必须使用弧度。\n\n从区间 $[-1,1]$ 上点的节点多项式插值定义出发，并基于插值多项式在节点处的导数可以表示为作用于节点值的线性算子这一原理，推导并实现以下内容：\n\n1. 在 $[-1,1]$ 上生成 Chebyshev–Gauss–Lobatto 节点 $\\{x_j\\}_{j=0}^N$。\n2. 根据拉格朗日插值及其重心形式的基本定义，推导并构建微分矩阵 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，使得对于一个光滑函数 $u$，向量 $D\\,\\mathbf{u}$ 近似于 $u'(x)$ 的节点值，其中 $\\mathbf{u} = \\big(u(x_0),\\ldots,u(x_N)\\big)^\\top$。\n3. 考虑常微分方程 $u'(x) = \\sin(x)$，并设 $u(x) = -\\cos(x)$，从而精确满足 $u'(x) = \\sin(x)$。使用构建的微分矩阵 $D$，计算无穷范数误差 $E_N = \\|D\\,\\mathbf{u} - \\boldsymbol{\\sin}\\|_\\infty$，其中 $\\boldsymbol{\\sin} = \\big(\\sin(x_0),\\ldots,\\sin(x_N)\\big)^\\top$，范数是最大绝对值项。所有三角函数求值均使用弧度。\n4. 计算谱半径 $\\rho(D)$，其定义为 $D$ 的特征值的最大绝对值。\n5. 通过测试 $u(x) = x^3$ 来验证微分矩阵对次数至多为 $N$ 的多项式的精确性，并检查是否满足 $\\|D\\,\\mathbf{u} - \\mathbf{v}\\|_\\infty  10^{-12}$，其中 $\\mathbf{v} = \\big(3 x_0^2,\\ldots,3 x_N^2\\big)^\\top$。如果此条件成立，则返回布尔值 true，否则返回 false。\n\n使用以下测试套件，它探讨了一个一般情况、一个边界情况和一个精度趋势情况：\n- 情况 1：$N=8$（一般情况）。计算 $u(x)=-\\cos(x)$ 的 $E_8$，$\\rho(D)$，以及对 $u(x)=x^3$ 在容差为 $10^{-12}$ 下的布尔精确性检查。\n- 情况 2：$N=1$（有两个节点的边界情况）。计算 $u(x)=-\\cos(x)$ 的 $E_1$。\n- 情况 3：$N=32$（更高分辨率情况）。计算 $u(x)=-\\cos(x)$ 的 $E_{32}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：$[E_8,\\rho(D_8),\\text{poly\\_exact\\_N8},E_1,E_{32}]$，其中 $E_8$、$\\rho(D_8)$、$E_1$ 和 $E_{32}$ 是浮点数，而 $\\text{poly\\_exact\\_N8}$ 是布尔值。\n\n确保您的实现仅使用植根于多项式插值基本定义的数值稳健构造，并且不假设任何未经推导的简化公式。所有角度都必须以弧度为单位。",
            "solution": "多项式配置微分的基本基础是在指定节点上对函数进行拉格朗日插值，以及由此产生的将节点值映射到插值多项式在节点处的导数的线性算子。选择 Chebyshev–Gauss–Lobatto 节点是因为它们在 $[-1,1]$ 区间上的多项式逼近中具有最优性质。我们从第一性原理出发，步骤如下。\n\n1. Chebyshev–Gauss–Lobatto 节点。对于给定的整数 $N \\geq 1$，节点定义为\n$$\nx_j = \\cos\\left(\\frac{\\pi j}{N}\\right), \\quad j=0,1,\\ldots,N,\n$$\n这些节点位于 $[-1,1]$ 内，并包括端点 $x_0=1$ 和 $x_N=-1$。这些节点是 $(1-x^2)T'_N(x)$ 的根，其中 $T_N(x)$ 是 $N$ 次第一类切比雪夫多项式，这确保了有利于谱插值的分布。\n\n2. 拉格朗日插值和重心权重。对于节点 $\\{x_j\\}_{j=0}^N$ 上的节点值 $\\{u_j\\}_{j=0}^N$，次数至多为 $N$ 的拉格朗日插值多项式 $p(x)$ 为\n$$\np(x) = \\sum_{j=0}^N u_j \\ell_j(x),\n$$\n其中 $\\ell_j(x)$ 是满足 $\\ell_j(x_k) = \\delta_{jk}$ 的拉格朗日基多项式，$\\delta_{jk}$ 是克罗内克 δ。在重心形式中，仅根据节点定义重心权重 $\\{\\lambda_j\\}_{j=0}^N$，插值多项式可以被稳定地书写和求值。对于 Chebyshev–Gauss–Lobatto 节点，从拉格朗日基的乘积形式推导出的重心权重可以选择为\n$$\n\\lambda_j = (-1)^j \\alpha_j, \\quad \\alpha_j = \\begin{cases}\n\\frac{1}{2},  j=0 \\text{ or } j=N,\\\\\n1,  \\text{otherwise}.\n\\end{cases}\n$$\n这个选择源于 $(1-x^2)T'_N(x)$ 的导数以及节点间距与定义 $\\ell_j(x)$ 的乘积之间的关系。\n\n3. 从重心权重构建微分矩阵。对 $p(x)$ 求导并在节点处求值，提供了一个从节点向量 $\\mathbf{u} = (u_0,\\ldots,u_N)^\\top$ 到节点导数向量 $(p'(x_0),\\ldots,p'(x_N))^\\top$ 的线性映射。这个映射由一个矩阵 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 表示，定义为\n$$\np'(x_j) = \\sum_{k=0}^N D_{jk} u_k.\n$$\n根据重心表示法和节点处 $\\ell_j'(x)$ 的基本恒等式，对于 $j \\neq k$，\n$$\nD_{jk} = \\frac{\\lambda_k}{\\lambda_j} \\cdot \\frac{1}{x_j - x_k},\n$$\n对角线元素遵循以下约束：由于常数可以被精确微分，每行的和为零：\n$$\nD_{jj} = -\\sum_{k=0, k\\neq j}^N D_{jk}.\n$$\n该构造是通过对重心拉格朗日形式进行微分，并使用恒等式 $\\sum_{k=0}^N \\ell_k(x) \\equiv 1$ 及其导数 $\\sum_{k=0}^N \\ell_k'(x) \\equiv 0$ 推导出来的，这意味着 $D \\mathbf{1} = \\mathbf{0}$，因此每行的和为零。\n\n尽管对于 Chebyshev–Gauss–Lobatto 节点存在闭式对角线项（例如，$D_{00} = \\frac{2N^2+1}{6}$，$D_{NN} = -\\frac{2N^2+1}{6}$，以及对于 $1 \\le j \\le N-1$ 有 $D_{jj} = -\\frac{x_j}{2(1-x_j^2)}$），但上述基于重心权重的构造在数值上是稳健的，并避免了显式的端点奇异公式。\n\n4. 对 $u'(x) = \\sin(x)$ 进行配置。选择 $u(x) = -\\cos(x)$，从而精确满足 $u'(x) = \\sin(x)$。在节点 $\\{x_j\\}$ 处，定义节点值 $\\mathbf{u} = \\big(u(x_0),\\ldots,u(x_N)\\big)^\\top = \\big(-\\cos(x_0),\\ldots,-\\cos(x_N)\\big)^\\top$。精确的导数节点向量是 $\\boldsymbol{\\sin} = \\big(\\sin(x_0),\\ldots,\\sin(x_N)\\big)^\\top$。微分矩阵作用于 $\\mathbf{u}$ 得到插值多项式在节点处的导数；与精确导数的偏差捕捉了插值-微分误差：\n$$\nE_N = \\|D\\,\\mathbf{u} - \\boldsymbol{\\sin}\\|_\\infty = \\max_{0 \\le j \\le N} \\left| \\sum_{k=0}^N D_{jk} u_k - \\sin(x_j) \\right|.\n$$\n所有三角函数求值均以弧度为单位。\n\n5. 谱半径。谱半径 $\\rho(D)$ 定义为\n$$\n\\rho(D) = \\max_{1 \\le i \\le N+1} |\\lambda_i(D)|,\n$$\n其中 $\\{\\lambda_i(D)\\}$ 是 $D$ 的特征值。此量表征了微分算子的大小，并在稳定性分析中具有重要意义。\n\n6. 多项式精确性验证。对于 $u(x) = x^3$，当 $N \\ge 3$ 时，插值多项式与 $u(x)$ 匹配。其导数 $u'(x) = 3x^2$ 对于任何 $N \\ge 3$ 也是一个次数至多为 $N$ 的多项式。因此，对于这样的 $u$，配置微分必须产生精确的节点导数。我们计算\n$$\nE_N^{(3)} = \\|D\\,\\mathbf{u} - \\mathbf{v}\\|_\\infty, \\quad \\mathbf{u} = (x_0^3,\\ldots,x_N^3)^\\top, \\quad \\mathbf{v} = (3x_0^2,\\ldots,3x_N^2)^\\top,\n$$\n并验证是否 $E_N^{(3)}  10^{-12}$，返回一个布尔结果。\n\n7. 测试套件和输出。我们实现上述构造并报告：\n- 对于 $N=8$：$u(x)=-\\cos(x)$ 的 $E_8$，$\\rho(D_8)$，以及对 $u(x)=x^3$ 在容差为 $10^{-12}$ 下的布尔精确性检查。\n- 对于 $N=1$：$u(x)=-\\cos(x)$ 的 $E_1$。\n- 对于 $N=32$：$u(x)=-\\cos(x)$ 的 $E_{32}$。\n\n最终程序以精确格式输出单行\n$$\n[E_8,\\rho(D_8),\\text{poly\\_exact\\_N8},E_1,E_{32}],\n$$\n其中 $E_8$、$\\rho(D_8)$、$E_1$ 和 $E_{32}$ 是浮点数，而 $\\text{poly\\_exact\\_N8}$ 是一个布尔值。\n\n算法步骤：\n- 通过 $x_j = \\cos(\\pi j/N)$ 计算 $\\{x_j\\}_{j=0}^N$。\n- 计算重心权重 $\\lambda_j = (-1)^j \\alpha_j$，其中 $\\alpha_0=\\alpha_N=\\frac{1}{2}$，对于 $1 \\le j \\le N-1$ 有 $\\alpha_j=1$。\n- 构建矩阵 $D$，其非对角线项为 $D_{jk} = \\frac{\\lambda_k}{\\lambda_j}\\frac{1}{x_j-x_k}$ (当 $j \\ne k$ 时)，对角线项为 $D_{jj} = -\\sum_{k \\ne j} D_{jk}$。\n- 对于 $u(x)=-\\cos(x)$，以弧度计算 $\\mathbf{u}$ 和 $\\boldsymbol{\\sin}$，通过无穷范数计算 $E_N$。\n- 计算 $\\rho(D)$，即 $D$ 的特征值的最大绝对值。\n- 对 $u(x)=x^3$ 求值，计算 $E_N^{(3)}$，并与 $10^{-12}$ 比较以获得布尔精确性结果。\n\n此方法遵循谱方法框架，并利用关于切比雪夫多项式和重心插值的经过充分检验的事实来构建一个稳健的微分算子，而不依赖于未经证明的捷径。",
            "answer": "```python\nimport numpy as np\n\ndef chebyshev_gauss_lobatto_nodes(N: int) - np.ndarray:\n    # x_j = cos(pi*j/N), j=0..N\n    j = np.arange(N + 1)\n    return np.cos(np.pi * j / N)\n\ndef barycentric_weights_cgl(N: int) - np.ndarray:\n    # lambda_j = (-1)^j * alpha_j, alpha_0 = alpha_N = 1/2, else 1\n    j = np.arange(N + 1)\n    w = np.ones(N + 1)\n    if N == 0:\n        # Degenerate case, not used in our tests\n        return w\n    w[0] = 0.5\n    w[-1] = 0.5\n    w *= (-1.0) ** j\n    return w\n\ndef differentiation_matrix_from_weights(x: np.ndarray, w: np.ndarray) - np.ndarray:\n    # Construct D with off-diagonal entries via barycentric weights and diagonal by row-sum zero\n    Np1 = x.size\n    Xdiff = x[:, None] - x[None, :]\n    # Avoid division by zero on diagonal by setting placeholder\n    np.fill_diagonal(Xdiff, 1.0)\n    wratio = (w[None, :]) / (w[:, None])\n    D = wratio / Xdiff\n    # Zero out diagonal temporarily\n    np.fill_diagonal(D, 0.0)\n    # Set diagonal as negative row sum\n    D[np.arange(Np1), np.arange(Np1)] = -np.sum(D, axis=1)\n    return D\n\ndef max_abs_error(D: np.ndarray, u_nodes: np.ndarray, exact_nodes: np.ndarray) - float:\n    approx = D @ u_nodes\n    return float(np.max(np.abs(approx - exact_nodes)))\n\ndef spectral_radius(D: np.ndarray) - float:\n    eigvals = np.linalg.eigvals(D)\n    return float(np.max(np.abs(eigvals)))\n\ndef test_case_errors(N: int):\n    x = chebyshev_gauss_lobatto_nodes(N)\n    w = barycentric_weights_cgl(N)\n    D = differentiation_matrix_from_weights(x, w)\n    # Test function u(x) = -cos(x), u'(x) = sin(x), angles in radians\n    u_nodes = -np.cos(x)\n    exact_nodes = np.sin(x)\n    E = max_abs_error(D, u_nodes, exact_nodes)\n    return D, E\n\ndef polynomial_exactness_boolean(D: np.ndarray, x: np.ndarray, tol: float = 1e-12) - bool:\n    # u(x) = x^3, u'(x) = 3x^2\n    u_nodes = x**3\n    exact_nodes = 3.0 * x**2\n    err = np.max(np.abs(D @ u_nodes - exact_nodes))\n    return bool(err  tol)\n\ndef solve():\n    results = []\n\n    # Case 1: N = 8\n    N1 = 8\n    x8 = chebyshev_gauss_lobatto_nodes(N1)\n    D8, E8 = test_case_errors(N1)\n    rho8 = spectral_radius(D8)\n    poly_exact_N8 = polynomial_exactness_boolean(D8, x8, tol=1e-12)\n    results.append(E8)\n    results.append(rho8)\n    results.append(poly_exact_N8)\n\n    # Case 2: N = 1 (boundary case)\n    N2 = 1\n    D1, E1 = test_case_errors(N2)\n    results.append(E1)\n\n    # Case 3: N = 32 (higher resolution case)\n    N3 = 32\n    D32, E32 = test_case_errors(N3)\n    results.append(E32)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}