## 引言
[正交多项式](@entry_id:146918)是[谱方法](@entry_id:141737)、间断Galerkin（DG）方法以及众多科学计算领域不可或缺的基石。它们优美的数学性质使得高阶逼近成为可能。然而，许多使用者仅将其作为现成的工具，却未能深入理解其背后强大而高效的代数引擎——[三项递推关系](@entry_id:176845)。正是这一关系，将抽象的[函数空间](@entry_id:143478)理论与具体的矩阵计算联系起来，催生了无数精巧的算法。本文旨在填补这一认知鸿沟，系统性地揭示[三项递推关系](@entry_id:176845)的理论内涵与实践价值。

在接下来的篇章中，读者将踏上一段从原理到应用的探索之旅。我们将在“原理与机制”一章中，从[内积空间](@entry_id:271570)的基本定义出发，严格推导[三项递推关系](@entry_id:176845)及其与雅可比矩阵的深刻联系。随后，在“应用与交叉学科联系”一章，我们将展示这一代数框架如何在数值积分、算子构造、[稳定性分析](@entry_id:144077)乃至不确定性量化和[谱图论](@entry_id:150398)等前沿领域中发挥关键作用。最后，通过“动手实践”环节，读者将亲手构建和分析递推算法，将理论知识转化为解决实际问题的能力。

让我们首先深入其核心，探究构成这一切基础的原理与机制。

## 原理与机制

本章旨在深入探讨[正交多项式](@entry_id:146918)理论的核心——[三项递推关系](@entry_id:176845)。我们将从[内积空间](@entry_id:271570)的基本定义出发，系统地推导出这一关键关系，并揭示其与[Jacobi矩阵](@entry_id:178326)、[算子谱](@entry_id:276315)理论及[高斯求积](@entry_id:146011)等重要概念之间深刻的内在联系。通过理解这些原理与机制，读者将能够掌握设计高效、精密的[谱方法](@entry_id:141737)和[间断Galerkin方法](@entry_id:748369)算法所必需的代数框架。

### 基础：正交性与[内积](@entry_id:158127)

在谱方法和相关数值技术中，我们通常在加权[函数空间](@entry_id:143478)中构造近似解。给定一个区间 $I \subset \mathbb{R}$ 和一个几乎处处为正的**权函数** $w(x)$，我们可以定义加权$L^2$空间，记为 $L^2(I, w)$。这个空间中的任意两个函数 $f(x)$ 和 $g(x)$ 之间的**[加权内积](@entry_id:163877)**定义为：

$$
\langle f, g \rangle_w = \int_I f(x)g(x)w(x) \, dx
$$

为了使这个定义成为一个有效的[内积](@entry_id:158127)，它必须满足对称性、双线性和正定性。其中，**[正定性](@entry_id:149643)**尤为关键，它要求对于任意非零函数 $f$, 都有 $\langle f, f \rangle_w > 0$。这个性质直接由权函数 $w(x)$ 在其支撑集上[几乎处处](@entry_id:146631)为正所保证。对于任意非零多项式 $f(x)$，其平方 $f(x)^2$ 仅在有限个点上为零，因此乘积 $f(x)^2 w(x)$ 在一个正测度集上是严格为正的，从而保证其积分 $\langle f, f \rangle_w = \int_I f(x)^2 w(x) \, dx$ 严格为正。这个看似细微的条件是整个[正交多项式](@entry_id:146918)理论结构的基石，它确保了每个非零多项式都有一个非零的长度或范数 $\|f\|_w = \sqrt{\langle f, f \rangle_w}$。

一个次数为 $n$ 的多项式序列 $\{p_n\}_{n=0}^\infty$ 如果满足对于任意 $n \neq m$ 都有 $\langle p_n, p_m \rangle_w = 0$，则称该序列关于[内积](@entry_id:158127) $\langle \cdot, \cdot \rangle_w$ 是**正交的**。值得强调的是，**正交性**与**归一化**是两个独立的概念。正交性是关于多项式在函数空间中方向的属性，而归一化是关于其“长度”的约定。例如，如果 $\{p_n\}$ 是一个正交序列，那么对于任意非零常数序列 $\{c_n\}$，$\{c_n p_n\}$ 也是一个正交序列。常见的归一化选择包括：

*   **首一（monic）归一化**：要求每个 $p_n(x)$ 的最高次项系数为 $1$。
*   **标准（orthonormal）归一化**：要求每个 $p_n(x)$ 的范数为 $1$，即 $\|p_n\|_w = 1$。

改变归一化会改变序列中每个多项式的具体形式，但不会破坏序列成员之间的[正交关系](@entry_id:145540)。

### 核心机制：[三项递推关系](@entry_id:176845)

[正交多项式](@entry_id:146918)最引人注目的代数特性是它们总是满足一个**[三项递推关系](@entry_id:176845)**。这个性质并非巧合，而是正交性的直接推论。下面，我们为首一[正交多项式](@entry_id:146918) $\{p_n(x)\}_{n=0}^\infty$ 推导这个关系。

考虑多项式 $x p_n(x)$。由于 $p_n(x)$ 是一个 $n$ 次[首一多项式](@entry_id:152311)， $x p_n(x)$ 是一个 $n+1$ 次[首一多项式](@entry_id:152311)。同时，$p_{n+1}(x)$ 也是一个 $n+1$ 次[首一多项式](@entry_id:152311)。因此，它们的差 $x p_n(x) - p_{n+1}(x)$ 是一个次数最多为 $n$ 的多项式。

由于 $\{p_k(x)\}_{k=0}^n$ 构成了次数不超过 $n$ 的[多项式空间](@entry_id:144410)的一个正交基，我们可以将这个差表示为它们的[线性组合](@entry_id:154743)：
$$
x p_n(x) - p_{n+1}(x) = \sum_{k=0}^{n} c_k p_k(x)
$$
为了确定系数 $c_k$，我们将等式两边与 $p_j(x)$ ($j \in \{0, \dots, n\}$) 作[内积](@entry_id:158127)。利用正交性，右侧变为 $c_j \|p_j\|_w^2$。左侧变为 $\langle x p_n - p_{n+1}, p_j \rangle_w$。由于 $j \le n$，根据正交性定义，$\langle p_{n+1}, p_j \rangle_w = 0$。因此，我们得到：
$$
c_j = \frac{\langle x p_n, p_j \rangle_w}{\|p_j\|_w^2}
$$
利用[内积](@entry_id:158127)的对称性，我们有 $\langle x p_n, p_j \rangle_w = \langle p_n, x p_j \rangle_w$。注意到 $x p_j(x)$ 是一个 $j+1$ 次多项式。如果 $n > j+1$（即 $j  n-1$），那么 $p_n$ 与所有次数低于 $n$ 的多项式（包括 $x p_j$）都正交。这意味着 $\langle p_n, x p_j \rangle_w = 0$。因此，系数 $c_j$ 对于 $j=0, 1, \dots, n-2$ 均为零。

这样，求和式中只剩下 $k=n$ 和 $k=n-1$ 两项，表达式简化为：
$$
x p_n(x) - p_{n+1}(x) = c_n p_n(x) + c_{n-1} p_{n-1}(x)
$$
整理后，我们得到首一正交多项式的标准[三项递推关系](@entry_id:176845)：
$$
p_{n+1}(x) = (x - a_n) p_n(x) - b_n p_{n-1}(x), \quad n \ge 1
$$
其中递推系数为 $a_n = c_n$ 和 $b_n = c_{n-1}$。其具体表达式为：
$$
a_n = \frac{\langle x p_n, p_n \rangle_w}{\|p_n\|_w^2}, \quad n \ge 0
$$
$$
b_n = \frac{\langle x p_n, p_{n-1} \rangle_w}{\|p_{n-1}\|_w^2}, \quad n \ge 1
$$
对于系数 $b_n$，通过将 $x p_{n-1}(x)$ 用递推式展开，可以证明 $\langle x p_n, p_{n-1} \rangle_w = \|p_n\|_w^2$。这给出了一个更简洁的表达式：
$$
b_n = \frac{\|p_n\|_w^2}{\|p_{n-1}\|_w^2}, \quad n \ge 1
$$
这个关系表明 $b_n$ 恒为正。

**示例：勒让德（Legendre）多项式**
考虑在区间 $[-1, 1]$ 上权函数为 $w(x)=1$ 的情况，对应的首一正交多项式是首一[勒让德多项式](@entry_id:141510)。由于积分区间关于[原点对称](@entry_id:172995)且权函数为偶函数，多项式 $p_n(x)$ 具有确定宇称，即 $p_n(-x)=(-1)^n p_n(x)$。因此，在 $a_n$ 的积分 $\int_{-1}^1 x [p_n(x)]^2 dx$ 中，被积函数是一个奇函数，其在对称区间上的积分为零。所以，对于所有 $n \ge 0$，我们有 $a_n = 0$。通过计算范数的比值，可以得到 $b_n = \frac{n^2}{4n^2-1}$ 对于 $n \ge 1$。

对于标准[正交多项式](@entry_id:146918) $\{\varphi_n\}$，其[递推关系](@entry_id:189264)通常写作：
$$
x \varphi_n(x) = \beta_n \varphi_{n+1}(x) + \alpha_n \varphi_n(x) + \beta_{n-1} \varphi_{n-1}(x)
$$
这里的系数与[首一多项式](@entry_id:152311)的系数有直接关系：$\alpha_n = a_n$ 且 $\beta_n = \sqrt{b_{n+1}}$。

### 矩阵表示：Jacobi 矩阵

[三项递推关系](@entry_id:176845)揭示了一个深刻的[代数结构](@entry_id:137052)：乘法算子可以用一个三对角矩阵来表示。考虑在 $L^2(I, w)$ 空间中由 $x$ 定义的**乘法算子** $M_x$，即 $M_x f = x f(x)$。在标准正交多项式基 $\{\varphi_n\}$ 下，这个[算子的矩阵表示](@entry_id:153664) $J$ 的元素为 $J_{ij} = \langle \varphi_i, x \varphi_j \rangle_w$。

将[递推关系](@entry_id:189264) $x \varphi_j(x) = \beta_j \varphi_{j+1}(x) + \alpha_j \varphi_j(x) + \beta_{j-1} \varphi_{j-1}(x)$ 代入，我们发现：
$$
J_{ij} = \langle \varphi_i, \beta_j \varphi_{j+1} + \alpha_j \varphi_j + \beta_{j-1} \varphi_{j-1} \rangle_w = \begin{cases} \alpha_j  \text{if } i=j \\ \beta_j  \text{if } i=j+1 \\ \beta_{j-1}  \text{if } i=j-1 \\ 0  \text{otherwise} \end{cases}
$$
这是一个[对称三对角矩阵](@entry_id:755732)，被称为**[Jacobi矩阵](@entry_id:178326)**：
$$
J = \begin{pmatrix}
\alpha_0  \beta_0  0  \dots \\
\beta_0  \alpha_1  \beta_1  \ddots \\
0  \beta_1  \alpha_2  \ddots \\
\vdots  \ddots  \ddots  \ddots
\end{pmatrix}
$$
这个矩阵完美地编码了[正交多项式](@entry_id:146918)系统的所有信息。一个重要的推论是，多项式 $\varphi_n(x)$ 的零点恰好是 $n \times n$ 阶[主子矩阵](@entry_id:201119) $J_n$ 的[特征值](@entry_id:154894)。

从[算子理论](@entry_id:139990)的角度看，乘法算子 $M_x$ 在 $L^2(\mu)$（其中 $d\mu = w(x)dx$）上是一个自伴算子。其算子范数为 $\|M_x\| = \sup_{x \in \text{supp}(\mu)} |x|$。由于 Jacobi 矩阵 $J$ 是 $M_x$ 在一个标准正交基下的表示，它与 $M_x$ 是[酉等价](@entry_id:197898)的。因此，$J$ 也是一个[有界自伴算子](@entry_id:200159)，且 $\|J\| = \|M_x\|$。对于[有界算子](@entry_id:264879)，其任何矩阵元素的大小都不能超过其范数。这意味着 Jacobi 矩阵的元素——即递推系数——是有一致[上界](@entry_id:274738)的：$|\alpha_n| \le \|J\|$ 和 $\beta_n \le \|J\|$。这一结论的前提是[测度的支撑集](@entry_id:191178)是[紧集](@entry_id:147575)，这保证了 $\|M_x\|$ 是有限的。因此，只要权函数定义在有界区间上，递推系数就不会无界增长。

### 应用与进阶推论

[三项递推关系](@entry_id:176845)的威力在于它连接了多个看似无关的领域，并催生了强大的计算工具。

#### [高斯求积](@entry_id:146011)与 Lanczos 算法

Jacobi 矩阵与**高斯求积**和**[Lanczos算法](@entry_id:148448)**之间存在着深刻的联系。考虑计算形如 $I(f) = \int f(\lambda) d\mu(\lambda)$ 的积分，其中 $d\mu$ 是由对称矩阵 $A$ 和向量 $b$ 定义的[离散谱](@entry_id:150970)测度，满足 $b^\top f(A) b = \int f(\lambda) d\mu(\lambda)$。

对矩阵 $A$ 和初始向量 $b/\|b\|_2$ 应用 $m$ 步 Lanczos 迭代，会生成一个 $m \times m$ 的[对称三对角矩阵](@entry_id:755732) $T_m$。这个 $T_m$ 正是与测度 $d\mu$ 相关的前 $m$ 个[正交多项式](@entry_id:146918)的 Jacobi 矩阵。高斯求积理论指出，$m$ 点[高斯求积](@entry_id:146011)公式的节点是第 $m$ 个[正交多项式](@entry_id:146918)的零点，这等价于 $T_m$ 的[特征值](@entry_id:154894)。求积的权重则与 $T_m$ 的[特征向量](@entry_id:151813)的第一分量有关。最终，对积分 $I(f)$ 的 $m$ 点[高斯求积](@entry_id:146011)近似恰好等于 $\|b\|_2^2 e_1^\top f(T_m) e_1$。这个强大的等价关系将一个分析问题（[高斯求积](@entry_id:146011)）转化为一个代数问题（[矩阵函数](@entry_id:180392)计算），构成了许多现代数值线性代数算法的基石，例如在[求解线性系统](@entry_id:146035)时近似计算 $b^\top A^{-1} b$。

#### Christoffel-Darboux 公式

[三项递推关系](@entry_id:176845)能够导出一个关于正交[多项式核函数](@entry_id:270040)的优美恒等式。**Christoffel-Darboux 核**定义为 $K_n(x,y) = \sum_{k=0}^n \varphi_k(x) \varphi_k(y)$。通过对[递推关系](@entry_id:189264)进行巧妙的代数操作，可以证明（对于 $x \neq y$）：
$$
K_n(x,y) = \beta_n \frac{\varphi_{n+1}(x)\varphi_n(y) - \varphi_n(x)\varphi_{n+1}(y)}{x-y}
$$
这个公式在谱方法的理论分析中扮演着重要角色，例如在分析插值算子的性质和谱展开的收敛性时。它的推导完全依赖于[三项递推关系](@entry_id:176845)，展示了这一关系的结构力量。

#### 渐近行为与零点[分布](@entry_id:182848)

递推系数的极限行为决定了[多项式零点](@entry_id:164249)的宏观[分布](@entry_id:182848)。如果对于一个在有界区间上的[正则测度](@entry_id:186011)，递推系数收敛于常数，即 $\alpha_n \to \alpha$ 且 $\beta_n \to \beta > 0$，那么当 $n \to \infty$ 时，第 $n$ 个[正交多项式](@entry_id:146918) $p_n(x)$ 的 $n$ 个零点的[经验分布](@entry_id:274074)测度将[弱收敛](@entry_id:146650)于一个具有特定密度的测度。这个[极限分布](@entry_id:174797)被称为**平衡测度**，其支撑集为 $[\alpha-2\beta, \alpha+2\beta]$，密度函数为反正弦[分布](@entry_id:182848)：
$$
\rho(x) = \frac{1}{\pi\sqrt{4\beta^2 - (x-\alpha)^2}}
$$
这个结果源于这样一个事实：$p_n$ 的零点是 $n \times n$ Jacobi 矩阵 $J_n$ 的[特征值](@entry_id:154894)，而当 $n \to \infty$ 时，$J_n$ 的[谱分布](@entry_id:158779)趋向于一个[常系数](@entry_id:269842)三对角 Toeplitz 矩阵的[谱分布](@entry_id:158779)。后者的谱由其符号 $\lambda(\theta) = \alpha + 2\beta \cos\theta$ 决定。这就在递推系数的[渐近行为](@entry_id:160836)与[多项式零点](@entry_id:164249)的全局[分布](@entry_id:182848)之间建立了一座桥梁。

### 完备性与实际构造

#### [基的完备性](@entry_id:196285)

在将函数展开为正交多项式级数时，一个关键问题是这样的展开是否能收敛到函数本身。这等价于多项式集合在 $L^2(I, w)$ 空间中是否是**稠密的**，或者说，[正交多项式](@entry_id:146918)序列是否构成一个**[完备基](@entry_id:143908)**。

*   对于紧区间 $[a,b]$，只要所有矩 $\int_a^b x^k w(x) dx$ 都是有限的，根据 [Stone-Weierstrass 定理](@entry_id:146002)的推广，多项式空间在 $L^2([a,b], w)$ 中总是稠密的。
*   对于无界区间（如 $\mathbb{R}$ 或 $[0, \infty)$），所有矩有限是一个必要但不充分的条件。还需要满足额外的条件，如 Carleman 条件 $\sum_{k=1}^\infty \mu_{2k}^{-1/(2k)} = \infty$（其中 $\mu_{2k}$ 是 $2k$ 阶矩），以保证矩问题是“定解的”，从而确保多项式[基的完备性](@entry_id:196285)。

需要区分正交多项式序列的**存在性**与**完备性**。只要 Gram 矩阵（即 Hankel 矩矩阵）是非奇异的，就可以通过 Gram-Schmidt 过程构造出任意阶的[正交多项式](@entry_id:146918)。然而，这并不能保证它们构成一个[完备基](@entry_id:143908)。只有当基是完备时，我们才能保证对于空间中的任意函数，其谱展开式都收敛。

#### 权函数的变换与递推系数的构造

在实际应用中，我们常常需要处理非标准的权函数，或者研究当权函数变化时递推关系如何变化。

*   **权函数的缩放**：若将权函[数乘](@entry_id:155971)以一个正常数 $c$，即 $w(x) \to c w(x)$，[首一多项式](@entry_id:152311)序列及其递推系数 $\{a_n, b_n\}$ 保持不变。而标准正交多项式则需要乘以一个因子 $c^{-1/2}$ 以维持单位范数，但其递推系数 $\{\alpha_n, \beta_n\}$ 同样保持不变。

*   **权函[数乘](@entry_id:155971)以多项式**：若将权函[数乘](@entry_id:155971)以一个非负多项式 $r(x)$，即 $w(x) \to r(x)w(x)$，情况则变得复杂。这会产生一个全新的[正交多项式](@entry_id:146918)序列，其递推系数通常会完全改变。这种变换被称为 Christoffel-Darboux 变换，它在 Jacobi 矩阵层面对应于一个 Darboux 变换。例如，对于 Jacobi 多项式，其权函数为 $w^{(\alpha,\beta)}(x) = (1-x)^\alpha (1+x)^\beta$，若将其乘以 $(1-x)$，则得到一个新的 Jacobi 族，其参数变为 $(\alpha+1, \beta)$。

*   **递推系数的数值构造**：对于不具有解析表达式的复杂权函数（例如，带有[跳跃间断](@entry_id:139886)的权函数），可以通过数值方法构造递推系数。一个稳定而强大的方法是**修正[矩方法](@entry_id:752140)** (Gautschi's algorithm)。该方法通过计算权函数关于某个已知参考[正交基](@entry_id:264024)（如切比雪夫多项式）的“修正矩”，然后通过一个被称为 Stieltjes 过程的算法来稳定地生成 Jacobi 矩阵。这种方法能够有效处理分段光滑或带有间断的权函数。

*   **间断点的影响**：权函数中的[跳跃间断](@entry_id:139886)点不会破坏[三项递推](@entry_id:755957)结构，但会影响递推系数的渐近行为。除了收敛到由区间决定的极限值外，系数还会出现衰减的[振荡](@entry_id:267781)修正项，其频率由[间断点](@entry_id:144108)在区间内的相对位置决定。

在间断 Galerkin (DG) 方法中，[基函数](@entry_id:170178)通常定义在每个网格单元上。通过[仿射变换](@entry_id:144885)将物理单元映射到[参考单元](@entry_id:168425) $[-1,1]$，物理单元上的递推系数可以通过简单的代数关系从[参考单元](@entry_id:168425)的系数变换得到。例如，若[仿射映射](@entry_id:746332)为 $x(t) = d_K + c_K t$，则标准正交多项式的系数变换规则为 $\alpha_n^{(K)} = d_K + c_K \alpha_n^{\text{ref}}$ 和 $\beta_n^{(K)} = c_K \beta_n^{\text{ref}}$。这种变换规则是谱元和 DG 方法实现中的一个基本要素。此外，通过选择特定的正交多项式族（如调节[Gegenbauer多项式](@entry_id:193407)的参数 $\lambda$），可以在 DG 方法中更好地抑制 Gibbs [振荡](@entry_id:267781)现象，这体现了正交多项式理论在现代数值计算中的深刻应用。