{
    "hands_on_practices": [
        {
            "introduction": "We begin with a core analytical skill: computing the normalization constant, which defines the squared norm of an orthogonal polynomial with respect to its weight function. This exercise  requires using the Rodrigues formula for Jacobi polynomials, providing deep insight into their fundamental structure and the origin of their orthogonality. Mastering this type of calculation is essential for correctly normalizing basis functions and deriving key properties in spectral methods.",
            "id": "3370701",
            "problem": "A modal spectral expansion for a scalar conservation law on the reference interval $[-1,1]$ often employs the Jacobi polynomial family $P_{n}^{(\\alpha,\\beta)}(x)$ with the Jacobi weight $w(x)=(1-x)^{\\alpha}(1+x)^{\\beta}$, where $\\alpha>-1$ and $\\beta>-1$. In the Discontinuous Galerkin (DG) method, the mass matrix entries on the reference element arise from the weighted inner product $\\langle f,g \\rangle_{w}=\\int_{-1}^{1} f(x)\\,g(x)\\,w(x)\\,\\mathrm{d}x$. The Jacobi polynomials $P_{n}^{(\\alpha,\\beta)}(x)$ are defined by the Rodrigues formula\n$$\nP_{n}^{(\\alpha,\\beta)}(x)=\\frac{(-1)^{n}}{2^{n} n!}\\,(1-x)^{-\\alpha}(1+x)^{-\\beta}\\,\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\Big[(1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\Big].\n$$\nAssume $\\alpha>-1$, $\\beta>-1$, and $n\\in\\mathbb{N}$. Using only the definition above together with standard properties of integration by parts and the Euler Beta function $B(u,v)=\\int_{0}^{1} t^{u-1}(1-t)^{v-1}\\,\\mathrm{d}t=\\frac{\\Gamma(u)\\Gamma(v)}{\\Gamma(u+v)}$, compute the exact value of the weighted inner product \n$$\n\\int_{-1}^{1} (1-x)^{\\alpha}(1+x)^{\\beta}\\,\\Big(P_{n}^{(\\alpha,\\beta)}(x)\\Big)^{2}\\,\\mathrm{d}x\n$$\nin closed form as a function of $n$, $\\alpha$, and $\\beta$. Your final answer must be a single analytic expression.",
            "solution": "The problem is to compute the squared norm of a Jacobi polynomial $P_{n}^{(\\alpha,\\beta)}(x)$ with respect to the associated Jacobi weight function $w(x)=(1-x)^{\\alpha}(1+x)^{\\beta}$. The quantity to be computed is the integral\n$$\nI_{n} = \\int_{-1}^{1} (1-x)^{\\alpha}(1+x)^{\\beta}\\,\\Big(P_{n}^{(\\alpha,\\beta)}(x)\\Big)^{2}\\,\\mathrm{d}x,\n$$\nwhere $\\alpha>-1$, $\\beta>-1$, and $n$ is a non-negative integer. The Jacobi polynomial $P_{n}^{(\\alpha,\\beta)}(x)$ is given by the Rodrigues formula:\n$$\nP_{n}^{(\\alpha,\\beta)}(x)=\\frac{(-1)^{n}}{2^{n} n!}\\,(1-x)^{-\\alpha}(1+x)^{-\\beta}\\,\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\Big[(1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\Big].\n$$\nThis formula reveals that $P_{n}^{(\\alpha,\\beta)}(x)$ is a polynomial of degree $n$. Let us denote its leading coefficient by $k_n$. We can then write $P_{n}^{(\\alpha,\\beta)}(x)$ as\n$$\nP_{n}^{(\\alpha,\\beta)}(x) = k_{n} x^{n} + q_{n-1}(x),\n$$\nwhere $q_{n-1}(x)$ is a polynomial of degree at most $n-1$. Substituting this into the integral $I_{n}$:\n$$\nI_{n} = \\int_{-1}^{1} w(x)\\,P_{n}^{(\\alpha,\\beta)}(x)\\,(k_{n} x^{n} + q_{n-1}(x))\\,\\mathrm{d}x = k_{n} \\int_{-1}^{1} w(x)\\,P_{n}^{(\\alpha,\\beta)}(x)\\,x^{n}\\,\\mathrm{d}x + \\int_{-1}^{1} w(x)\\,P_{n}^{(\\alpha,\\beta)}(x)\\,q_{n-1}(x)\\,\\mathrm{d}x.\n$$\nA fundamental property of Jacobi polynomials, derivable from the Rodrigues formula, is their orthogonality with respect to the weight function $w(x)$. Specifically, $P_{n}^{(\\alpha,\\beta)}(x)$ is orthogonal to any polynomial of degree less than $n$. Since $q_{n-1}(x)$ is a linear combination of monomials $x^m$ with $m < n$, the second integral vanishes:\n$$\n\\int_{-1}^{1} w(x)\\,P_{n}^{(\\alpha,\\beta)}(x)\\,q_{n-1}(x)\\,\\mathrm{d}x = 0.\n$$\nThus, the expression for $I_{n}$ simplifies to\n$$\nI_{n} = k_{n} \\int_{-1}^{1} x^{n}\\, P_{n}^{(\\alpha,\\beta)}(x)\\,w(x)\\,\\mathrm{d}x.\n$$\nNow, we substitute the Rodrigues formula for $P_{n}^{(\\alpha,\\beta)}(x)$ into this simplified expression. The weight function $w(x)=(1-x)^{\\alpha}(1+x)^{\\beta}$ cancels with the $(1-x)^{-\\alpha}(1+x)^{-\\beta}$ term in the formula:\n$$\nI_{n} = k_{n} \\int_{-1}^{1} x^{n} \\left(\\frac{(-1)^{n}}{2^{n} n!}\\,\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\Big[(1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\Big]\\right) \\mathrm{d}x.\n$$\nWe proceed by applying integration by parts $n$ times. For each step, we differentiate $x^n$ and integrate the $n$-th derivative term. The boundary terms at each step are zero. This is because the derivatives of $(1-x)^{\\alpha+n}(1+x)^{\\beta+n}$ of order $j < n$ contain factors of $(1-x)^{\\alpha+n-j}$ and $(1+x)^{\\beta+n-j}$. Since $\\alpha>-1$ and $\\beta>-1$, we have $\\alpha+n-j > n-j-1 \\ge 0$ and $\\beta+n-j > n-j-1 \\ge 0$ for $j \\le n-1$, ensuring the boundary terms vanish at $x=\\pm 1$. After $n$ applications of integration by parts, we obtain:\n$$\nI_{n} = k_{n} \\frac{(-1)^{n}}{2^{n} n!} \\int_{-1}^{1} \\Big[(1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\Big] \\left( (-1)^{n} \\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}} x^{n} \\right) \\mathrm{d}x.\n$$\nSince $\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}} x^{n} = n!$ and $(-1)^{n}(-1)^{n} = 1$, the expression further simplifies:\n$$\nI_{n} = k_{n} \\frac{1}{2^{n} n!} (n!) \\int_{-1}^{1} (1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\,\\mathrm{d}x = \\frac{k_{n}}{2^{n}} \\int_{-1}^{1} (1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\,\\mathrm{d}x.\n$$\nThe next step is to determine the leading coefficient $k_{n}$. We can extract it from the Rodrigues formula by examining the behavior of the terms for large $x$:\n\\begin{align*} (1-x)^{\\alpha+n}(1+x)^{\\beta+n} &\\sim (-x)^{\\alpha+n}(x)^{\\beta+n} = (-1)^{\\alpha+n}x^{\\alpha+\\beta+2n} \\\\ \\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}} \\Big[(1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\Big] &\\sim (-1)^{\\alpha+n} \\frac{\\Gamma(\\alpha+\\beta+2n+1)}{\\Gamma(\\alpha+\\beta+n+1)} x^{\\alpha+\\beta+n} \\\\ (1-x)^{-\\alpha}(1+x)^{-\\beta} &\\sim (-x)^{-\\alpha}(x)^{-\\beta} = (-1)^{-\\alpha}x^{-\\alpha-\\beta} \\end{align*}\nCombining these asymptotic forms yields the leading term of $P_{n}^{(\\alpha,\\beta)}(x)$:\n$$\nP_{n}^{(\\alpha,\\beta)}(x) \\sim \\frac{(-1)^{n}}{2^{n} n!} \\big( (-1)^{-\\alpha}x^{-\\alpha-\\beta} \\big) \\left( (-1)^{\\alpha+n} \\frac{\\Gamma(\\alpha+\\beta+2n+1)}{\\Gamma(\\alpha+\\beta+n+1)} x^{\\alpha+\\beta+n} \\right).\n$$\nThe powers of $(-1)$ cancel as $(-1)^{n-\\alpha+\\alpha+n} = (-1)^{2n}=1$. The leading term is\n$$\nP_{n}^{(\\alpha,\\beta)}(x) \\sim \\frac{1}{2^{n} n!} \\frac{\\Gamma(\\alpha+\\beta+2n+1)}{\\Gamma(\\alpha+\\beta+n+1)} x^{n},\n$$\nfrom which we identify the leading coefficient:\n$$\nk_{n} = \\frac{\\Gamma(2n+\\alpha+\\beta+1)}{2^{n} n! \\Gamma(n+\\alpha+\\beta+1)}.\n$$\nThe final piece is the integral term, which can be evaluated using the Euler Beta function, $B(u,v) = \\int_0^1 t^{u-1}(1-t)^{v-1}\\,\\mathrm{d}t$. Let $x=2t-1$, so $\\mathrm{d}x=2\\,\\mathrm{d}t$:\n\\begin{align*} \\int_{-1}^{1} (1-x)^{\\alpha+n}(1+x)^{\\beta+n}\\,\\mathrm{d}x &= \\int_{0}^{1} (2(1-t))^{\\alpha+n}(2t)^{\\beta+n}\\,(2\\,\\mathrm{d}t) \\\\ &= 2^{\\alpha+n} 2^{\\beta+n} 2 \\int_{0}^{1} (1-t)^{\\alpha+n} t^{\\beta+n}\\,\\mathrm{d}t \\\\ &= 2^{\\alpha+\\beta+2n+1} B(\\beta+n+1, \\alpha+n+1) \\\\ &= 2^{\\alpha+\\beta+2n+1} \\frac{\\Gamma(\\beta+n+1)\\Gamma(\\alpha+n+1)}{\\Gamma(\\alpha+\\beta+2n+2)}. \\end{align*}\nSubstituting the expressions for $k_n$ and the integral back into the formula for $I_n$:\n$$\nI_{n} = \\frac{1}{2^{n}} \\left( \\frac{\\Gamma(2n+\\alpha+\\beta+1)}{2^{n} n! \\Gamma(n+\\alpha+\\beta+1)} \\right) \\left( 2^{\\alpha+\\beta+2n+1} \\frac{\\Gamma(n+\\alpha+1)\\Gamma(n+\\beta+1)}{\\Gamma(2n+\\alpha+\\beta+2)} \\right).\n$$\nWe can simplify this expression by combining powers of $2$ and using the property $\\Gamma(z+1)=z\\Gamma(z)$:\n\\begin{align*} I_{n} &= \\frac{2^{\\alpha+\\beta+2n+1}}{2^{2n} n!} \\frac{\\Gamma(2n+\\alpha+\\beta+1)}{\\Gamma(n+\\alpha+\\beta+1)} \\frac{\\Gamma(n+\\alpha+1)\\Gamma(n+\\beta+1)}{\\Gamma(2n+\\alpha+\\beta+2)} \\\\ &= \\frac{2^{\\alpha+\\beta+1}}{n!} \\frac{\\Gamma(2n+\\alpha+\\beta+1)}{\\Gamma(n+\\alpha+\\beta+1)} \\frac{\\Gamma(n+\\alpha+1)\\Gamma(n+\\beta+1)}{(2n+\\alpha+\\beta+1)\\Gamma(2n+\\alpha+\\beta+1)} \\\\ &= \\frac{2^{\\alpha+\\beta+1}}{n! (2n+\\alpha+\\beta+1)} \\frac{\\Gamma(n+\\alpha+1)\\Gamma(n+\\beta+1)}{\\Gamma(n+\\alpha+\\beta+1)}. \\end{align*}\nThis is the final closed-form expression for the integral.",
            "answer": "$$\n\\boxed{\\frac{2^{\\alpha+\\beta+1}}{n! (2n+\\alpha+\\beta+1)} \\frac{\\Gamma(n+\\alpha+1)\\Gamma(n+\\beta+1)}{\\Gamma(n+\\alpha+\\beta+1)}}\n$$"
        },
        {
            "introduction": "We now build upon the ideal concept of orthogonality by exploring its behavior in a more realistic setting: a curved physical element. This practice  uses Legendre polynomials to demonstrate how a non-constant geometric Jacobian, $J(\\xi)$, breaks the orthogonality of the basis, leading to a non-diagonal mass matrix. This exercise is crucial for understanding modal coupling and the properties of Discontinuous Galerkin methods on isoparametric meshes.",
            "id": "3370740",
            "problem": "Consider a one-dimensional Discontinuous Galerkin (DG) discretization of a conservation law on a single reference element $\\xi \\in [-1,1]$, where the mapping to physical space is isoparametric and given by $x(\\xi) = \\xi + \\varepsilon \\,\\xi^{2}$ with a small but otherwise arbitrary curvature parameter $\\varepsilon \\in \\mathbb{R}$. The basis functions are the classical Legendre polynomials $\\{P_{k}(\\xi)\\}_{k=0}^{\\infty}$ on $[-1,1]$. The physical-volume inner product induced by the mapping is defined by the Jacobian factor $J(\\xi) = \\frac{dx}{d\\xi}$, so that the DG mass matrix entries are\n$$\nM_{mn} = \\int_{-1}^{1} P_{m}(\\xi)\\,P_{n}(\\xi)\\,J(\\xi)\\,d\\xi.\n$$\nStarting from core definitions of the change-of-variables in integrals, the $L^{2}$-orthogonality of Legendre polynomials on $[-1,1]$, and structure relations for Legendre polynomials derived from their defining differential equation and Rodrigues' formula, perform the following tasks:\n- Explain why the non-constant Jacobian $J(\\xi)$ alters the orthogonality of the Legendre basis in physical space and how this induces modal coupling and potential aliasing when integrals are approximated by finite-degree quadrature rules.\n- Derive the discrete metric identity needed for free-stream preservation (i.e., exact preservation of a constant solution) in DG under isoparametric mappings, and state clearly the consistency conditions on polynomial representation and differentiation that make this identity hold for the mapping $x(\\xi)$ above with a Legendre modal basis.\n\nThen, compute explicitly the off-diagonal mass matrix entry for adjacent modes,\n$$\nM_{n,n+1} = \\int_{-1}^{1} P_{n}(\\xi)\\,P_{n+1}(\\xi)\\,J(\\xi)\\,d\\xi,\n$$\nas a closed-form analytic function of $\\varepsilon$ and the integer degree $n \\geq 0$. No rounding is required. Report only the final closed-form expression for $M_{n,n+1}$ as your answer.",
            "solution": "The problem requires a three-part response: an explanation of geometric-induced modal coupling, a derivation of the free-stream preservation identity, and an explicit computation of a specific off-diagonal mass matrix entry.\n\nFirst, we establish the geometric context. The mapping from the reference element $\\xi \\in [-1,1]$ to the physical element $x \\in [x(-1), x(1)]$ is given by $x(\\xi) = \\xi + \\varepsilon \\xi^{2}$. The Jacobian of this transformation is $J(\\xi) = \\frac{dx}{d\\xi} = 1 + 2\\varepsilon \\xi$. Since the mapping is quadratic in $\\xi$, the Jacobian is linear in $\\xi$.\n\n**Part 1: Altered Orthogonality, Modal Coupling, and Aliasing**\n\nThe Legendre polynomials $\\{P_k(\\xi)\\}_{k=0}^\\infty$ form an orthogonal basis on the interval $[-1,1]$ with respect to the standard (unweighted) $L^2$ inner product, which has a weight function of unity. This orthogonality is expressed as:\n$$\n\\langle P_m, P_n \\rangle = \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) \\,d\\xi = \\frac{2}{2n+1} \\delta_{mn}\n$$\nwhere $\\delta_{mn}$ is the Kronecker delta.\n\nThe DG mass matrix $M_{mn}$ is constructed using the physical-volume inner product, which includes the Jacobian $J(\\xi)$ as a weight function. The entries are given by:\n$$\nM_{mn} = \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) J(\\xi) \\,d\\xi\n$$\nSubstituting the given Jacobian $J(\\xi) = 1 + 2\\varepsilon\\xi$, we obtain:\n$$\nM_{mn} = \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) (1 + 2\\varepsilon\\xi) \\,d\\xi = \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) \\,d\\xi + 2\\varepsilon \\int_{-1}^{1} \\xi P_m(\\xi) P_n(\\xi) \\,d\\xi\n$$\nThe first term corresponds to the standard, diagonal mass matrix scaled by the orthogonality constant. The second term, $2\\varepsilon \\int_{-1}^{1} \\xi P_m(\\xi) P_n(\\xi) \\,d\\xi$, prevents the basis from being orthogonal with respect to this new weighted inner product. Specifically, this integral is generally non-zero for $m \\neq n$ (for example, when $|m-n|=1$), leading to non-zero off-diagonal entries in the mass matrix, $M_{mn} \\neq 0$ for $m \\neq n$.\n\nThis phenomenon is known as **modal coupling**. The non-constant Jacobian $J(\\xi)$ introduces a coupling between different modes (basis functions) that would be decoupled (orthogonal) on a canonical affine element where $J$ is constant. The mass matrix is no longer diagonal, which means its inverse, $\\mathbf{M}^{-1}$, is dense. This has significant computational implications, as updating the solution in a DG scheme with an explicit time integrator requires multiplication by $\\mathbf{M}^{-1}$.\n\nRegarding **aliasing**, numerical DG methods approximate integrals using quadrature rules, such as Gauss-Legendre quadrature. A quadrature rule with $N_q$ points is exact for polynomials of degree up to $2N_q-1$. The integrand for the mass matrix entry $M_{mn}$ is $P_m(\\xi) P_n(\\xi) J(\\xi)$. If the basis functions are polynomials of degree up to $N$, the highest degree of this product occurs for $m=n=N$. The degree of $P_N(\\xi) P_N(\\xi) J(\\xi)$ is $N+N+1 = 2N+1$. To compute all mass matrix entries exactly, the quadrature rule must be exact for polynomials of degree at least $2N+1$, requiring $2N_q - 1 \\ge 2N+1$, or $N_q \\ge N+2$. If a quadrature rule with fewer points is used (an \"inexact integration\" or \"under-integration\" strategy, common for efficiency), the integral is not computed exactly. The error in this approximation, known as aliasing error, effectively projects energy from polynomial modes higher than what the quadrature can resolve onto the existing modes within the polynomial space $\\mathbb{P}_N$, corrupting the solution.\n\n**Part 2: Free-Stream Preservation and the Discrete Metric Identity**\n\nFree-stream preservation requires that a DG scheme for a conservation law $\\partial_t u + \\partial_x f(u) = 0$ maintains a constant state $u(x,t) = c$ exactly. In the weak formulation on a physical element $K$, this means the spatial residual must be zero for $u=c$. For a test function $v_h$, the spatial residual is:\n$$\nR_{sp}(v_h, u_h) = \\int_K v_h \\frac{\\partial f(u_h)}{\\partial x} \\,dx\n$$\nTransforming to the reference element $\\xi \\in [-1,1]$ using $\\partial_x = \\frac{1}{J(\\xi)} \\partial_\\xi$ and $dx=J(\\xi)d\\xi$:\n$$\nR_{sp}(v_h, u_h) = \\int_{-1}^{1} v_h(\\xi) \\left( \\frac{1}{J(\\xi)} \\frac{\\partial f(u_h(\\xi))}{\\partial \\xi} \\right) J(\\xi) \\,d\\xi = \\int_{-1}^{1} v_h(\\xi) \\frac{\\partial f(u_h(\\xi))}{\\partial \\xi} \\,d\\xi\n$$\nA crucial observation is that the Jacobian factors $J(\\xi)$ and $1/J(\\xi)$ cancel analytically. This is the **metric identity**. Integrating by parts yields the standard DG weak form:\n$$\nR_{sp}(v_h, u_h) = \\left[ v_h(\\xi) f(u_h(\\xi)) \\right]_{-1}^{1} - \\int_{-1}^{1} \\frac{\\partial v_h(\\xi)}{\\partial \\xi} f(u_h(\\xi)) \\,d\\xi\n$$\nIf the solution is a constant free-stream, $u_h = c$, then $f(u_h)=f(c)$ is also constant. The residual becomes:\n$$\nR_{sp}(v_h, c) = f(c) \\left[ v_h(\\xi) \\right]_{-1}^{1} - f(c) \\int_{-1}^{1} \\frac{\\partial v_h(\\xi)}{\\partial \\xi} \\,d\\xi\n$$\nBy the Fundamental Theorem of Calculus, $\\int_{-1}^{1} \\frac{\\partial v_h}{\\partial \\xi} d\\xi = v_h(1) - v_h(-1)$. Thus,\n$$\nR_{sp}(v_h, c) = f(c) (v_h(1) - v_h(-1)) - f(c) (v_h(1) - v_h(-1)) = 0\n$$\nThis shows that the volume contribution to the spatial residual is identically zero for a constant state. Free-stream preservation is achieved if the numerical fluxes at the boundaries also take on the free-stream value, i.e., $f(u_h^*) = f(c)$.\n\nThe \"discrete\" aspect of the metric identity relates to the **consistency conditions** ensuring this cancellation is preserved in the numerical implementation:\n1.  **Formulation Consistency**: The weak form of the derivative operator must be formulated as $\\int v_h(\\xi) (\\partial_\\xi u_h(\\xi)) d\\xi$, thereby embedding the analytical cancellation of the geometric terms. It must not be formulated in a way that requires approximating $1/J(\\xi)$ as a polynomial, as this would break the perfect cancellation. For the given mapping, this is straightforward as shown.\n2.  **Quadrature Consistency**: The resulting integrals must be computed exactly. The term from the stiffness matrix, $\\int v_h (\\partial_\\xi u_h) d\\xi$, involves a polynomial of degree at most $N + (N-1) = 2N-1$ if $v_h, u_h \\in \\mathbb{P}_N$. This requires a Gauss quadrature rule with at least $N$ points. The mass matrix integral requires a quadrature rule exact for degree $2N+1$, as discussed previously. If these quadrature rules are used, the discrete evaluation of the spatial operator on a constant state will be zero, thus preserving the free-stream.\n\n**Part 3: Computation of $M_{n,n+1}$**\n\nThe off-diagonal mass matrix entry for adjacent modes $n$ and $n+1$ ($n \\geq 0$) is given by:\n$$\nM_{n,n+1} = \\int_{-1}^{1} P_n(\\xi) P_{n+1}(\\xi) J(\\xi) \\,d\\xi = \\int_{-1}^{1} P_n(\\xi) P_{n+1}(\\xi) (1 + 2\\varepsilon\\xi) \\,d\\xi\n$$\nThis can be split into two integrals:\n$$\nM_{n,n+1} = \\int_{-1}^{1} P_n(\\xi) P_{n+1}(\\xi) \\,d\\xi + 2\\varepsilon \\int_{-1}^{1} \\xi P_n(\\xi) P_{n+1}(\\xi) \\,d\\xi\n$$\nThe first integral is zero due to the orthogonality of Legendre polynomials for different degrees. Thus, we only need to evaluate the second integral:\n$$\nM_{n,n+1} = 2\\varepsilon \\int_{-1}^{1} \\xi P_n(\\xi) P_{n+1}(\\xi) \\,d\\xi\n$$\nTo evaluate this integral, we use the three-term recurrence relation for Legendre polynomials:\n$$\n(k+1)P_{k+1}(x) = (2k+1)x P_k(x) - k P_{k-1}(x)\n$$\nRearranging for the term $x P_k(x)$:\n$$\nx P_k(x) = \\frac{k+1}{2k+1} P_{k+1}(x) + \\frac{k}{2k+1} P_{k-1}(x)\n$$\nLet $k=n$ and $x=\\xi$. Substitute this into our integral:\n$$\nM_{n,n+1} = 2\\varepsilon \\int_{-1}^{1} \\left( \\frac{n+1}{2n+1} P_{n+1}(\\xi) + \\frac{n}{2n+1} P_{n-1}(\\xi) \\right) P_{n+1}(\\xi) \\,d\\xi\n$$\nDistributing $P_{n+1}(\\xi)$ across the terms:\n$$\nM_{n,n+1} = 2\\varepsilon \\left( \\frac{n+1}{2n+1} \\int_{-1}^{1} P_{n+1}(\\xi)^2 \\,d\\xi + \\frac{n}{2n+1} \\int_{-1}^{1} P_{n-1}(\\xi) P_{n+1}(\\xi) \\,d\\xi \\right)\n$$\nAgain, by orthogonality, the second integral $\\int_{-1}^{1} P_{n-1}(\\xi) P_{n+1}(\\xi) \\,d\\xi$ is zero for all $n \\geq 0$ (if $n=0$, the term is multiplied by $n=0$; if $n \\geq 1$, the indices differ by $2$). The first integral is the normalization constant:\n$$\n\\int_{-1}^{1} P_{n+1}(\\xi)^2 \\,d\\xi = \\frac{2}{2(n+1)+1} = \\frac{2}{2n+3}\n$$\nSubstituting this result back:\n$$\nM_{n,n+1} = 2\\varepsilon \\left( \\frac{n+1}{2n+1} \\cdot \\frac{2}{2n+3} + 0 \\right) = \\frac{4\\varepsilon(n+1)}{(2n+1)(2n+3)}\n$$\nThis formula provides the closed-form analytic expression for the specified off-diagonal mass matrix entry as a function of the curvature parameter $\\varepsilon$ and the mode index $n \\geq 0$.",
            "answer": "$$\\boxed{\\frac{4\\varepsilon(n+1)}{(2n+1)(2n+3)}}$$"
        },
        {
            "introduction": "This final practice culminates in a complete computational analysis of a Discontinuous Galerkin Spectral Element Method (DGSEM). The task  is to implement the numerical scheme for the linear advection equation and perform a Fourier analysis to measure its wave propagation properties, namely dispersion and dissipation. By comparing results from different nodal sets derived from Legendre polynomials, you will gain practical insight into how theoretical choices impact the performance of advanced numerical methods.",
            "id": "3370734",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ with constant speed $a>0$ on a periodic domain partitioned into a uniform mesh of elements of size $h$. In a Discontinuous Galerkin Spectral Element Method (DGSEM) with polynomial degree $p$ per element, one represents $u$ by a nodal polynomial of degree $p$ using $p+1$ interpolation points in the reference element $\\xi \\in [-1,1]$ and a diagonal mass matrix induced by collocation quadrature. Two canonical choices of interpolation points are Legendre-Gauss (LG) points and Legendre-Gauss-Lobatto (LGL) points. The DGSEM in strong form can be constructed from:\n\n- Fundamental facts about classical orthogonal polynomials: Legendre polynomials $P_n(x)$ are orthogonal on $[-1,1]$ with respect to the weight $1$, satisfy $P_n(1)=1$ and $P_n(-1)=(-1)^n$, and have simple identities for derivatives at the endpoints. LG points are the $p+1$ roots of $P_{p+1}(x)$, while LGL points are the $p+1$ roots of $(1-x^2)P_p'(x)$, including the endpoints $x=\\pm 1$. Jacobi polynomials $P_n^{(\\alpha,\\beta)}(x)$ connect derivatives via $P_p'(x)$ having the same zeros as $P_{p-1}^{(1,1)}(x)$ in $(-1,1)$. Quadrature weights are known for LG and LGL and define the diagonal mass matrix.\n\n- The summation-by-parts (SBP) property realized in DGSEM when the derivative operator is built from the differentiation of the Lagrange basis associated with the collocation nodes and the surface terms are added using numerical fluxes. The strong-form semi-discrete operator for advection combines a volume derivative term and a lifted surface correction term determined by fluxes at element interfaces.\n\nYou will quantify the dispersion (phase speed) and dissipation (amplitude decay) of DGSEM for both LG and LGL points by performing a semi-discrete Fourier analysis on the block-circulant operator for a uniform periodic mesh. Assume $a=1$ and $h=1$ throughout, and angles must be handled in radians.\n\nStarting from the above fundamental base:\n\n1. Construct, for each choice of nodes (LG and LGL), the nodal derivative matrix on $[-1,1]$ using the Lagrange basis differentiation formula derived from the polynomial $L(x)$ that has the collocation nodes as roots. Specifically, use the identity that the Lagrange basis $l_j(x)$ can be represented as $l_j(x) = \\dfrac{L(x)}{(x-x_j)L'(x_j)}$, so that the differentiation matrix entries are $D_{ij} = \\dfrac{L'(x_i)}{L'(x_j)\\,(x_i - x_j)}$ for $i\\neq j$ and $D_{ii} = -\\sum_{j\\neq i} D_{ij}$. For LG, $L(x) = P_{p+1}(x)$; for LGL, $L(x) = (1-x^2)P_p'(x)$, with $L'(x)$ evaluated using standard Legendre polynomial derivative identities. Quadrature weights define the diagonal mass matrix $M$.\n\n2. Define the boundary evaluation vectors $r_L$ and $r_R$ that map nodal values to left and right face values, respectively, by evaluating the Lagrange basis at $x=-1$ and $x=1$. Use the barycentric evaluation induced by the weights $1/L'(x_j)$ to compute $r_L$ and $r_R$ stably for both LG and LGL (noting that, at LGL endpoints, the corresponding basis function equals $1$ and the others $0$).\n\n3. For each non-dimensional wavenumber $\\theta = k h$ in a prescribed test set, form the $p+1$ by $p+1$ Fourier symbol $A(\\theta)$ of the semi-discrete DGSEM strong-form operator with upwind numerical flux for $a>0$. Use the Bloch ansatz over the uniform mesh so that the left neighbor’s right-face value contributes a factor $z^{-1}$ with $z = e^{i\\theta}$. The strong-form symbol matrix is\n$$\nA(\\theta) = -\\frac{2}{h}\\,a\\,D \\;-\\;\\frac{2}{h}\\,a\\,M^{-1}\\,r_L\\left(z^{-1}r_R^\\top - r_L^\\top\\right).\n$$\nWith $a=1$ and $h=1$, this simplifies appropriately.\n\n4. For each $\\theta$, compute all eigenvalues $\\lambda(\\theta)$ of $A(\\theta)$ and define the complex angular frequency $\\omega(\\theta) = i\\,\\lambda(\\theta)$. The phase speed is $c_p(\\theta) = \\dfrac{\\mathrm{Re}(\\omega(\\theta))}{k} = -\\dfrac{\\mathrm{Im}(\\lambda(\\theta))}{\\theta}$, the dissipation is $d(\\theta) = -\\mathrm{Im}(\\omega(\\theta)) = -\\mathrm{Re}(\\lambda(\\theta))$, and the group velocity is $c_g(\\theta) = \\dfrac{d}{dk}\\mathrm{Re}(\\omega(\\theta))$, which you should approximate by finite differences of $\\mathrm{Re}(\\omega(\\theta))$ with respect to $k=\\theta/h$ on the given grid of $\\theta$ values.\n\n5. Identify the physical branch for each method by selecting, at the smallest $\\theta$ in the test set, the eigenvalue whose phase speed $c_p(\\theta)$ is closest to the exact speed $a$. For successive $\\theta$, continue the branch by choosing, among the eigenvalues at that $\\theta$, the one whose phase speed is closest to the previously selected branch’s phase speed.\n\n6. Compute, for each method and each $p$, the maximum absolute phase speed error $\\max_{\\theta} |c_p(\\theta)-a|$, the maximum absolute group velocity error over interior $\\theta$ values where central differences are defined, and the maximum dissipation $\\max_{\\theta} d(\\theta)$ on the given $\\theta$ grid.\n\nYour program must implement all of the above steps without using any shortcut formulas beyond the fundamental identities stated. Angles must be in radians. No physical units other than radians are involved.\n\nTest Suite:\n- Use $a=1$ and $h=1$.\n- Use polynomial degrees $p \\in \\{1,3,6\\}$.\n- For each $p$, compare the two node choices: LG and LGL.\n- Use the $\\theta$ grid $\\{\\theta_m\\}_{m=1}^9$ with $\\theta_m = \\frac{\\pi}{16} m$ for $m=1,2,\\dots,9$ (so from $\\pi/16$ to $9\\pi/16$). This tests low to moderate wavenumbers, ensuring coverage of smooth and dispersive regimes while avoiding the trivial $\\theta=0$ case.\n- For each $(p,\\text{nodes})$, produce three floats: maximum absolute phase speed error, maximum absolute group velocity error (computed via central differences on interior points only), and maximum dissipation.\n\nFinal Output Format:\n- Aggregate the results for the six comparisons in the fixed order: for $p=1$, LGL then LG; for $p=3$, LGL then LG; for $p=6$, LGL then LG.\n- For each comparison, output the three floats in the order described above.\n- Your program should produce a single line of output containing the eighteen floats as a comma-separated list enclosed in square brackets. For example: \"[f1,f2,...,f18]\".",
            "solution": "The objective of this problem is to perform a dispersion and dissipation analysis of the Discontinuous Galerkin Spectral Element Method (DGSEM) for the one-dimensional linear advection equation, $u_t + a\\,u_x = 0$, on a periodic domain. The analysis is conducted using a semi-discrete Fourier approach for a uniform mesh with element size $h$ and polynomial approximation of degree $p$. We are tasked with comparing two common choices for intra-element collocation nodes: Legendre-Gauss (LG) and Legendre-Gauss-Lobatto (LGL) points. The analysis requires constructing the DGSEM operator in strong form and then examining the eigenvalues of its Fourier symbol to determine key properties like phase speed, group velocity, and dissipation. Throughout the analysis, the advection speed is set to $a=1$ and the element size to $h=1$.\n\nThe solution methodology is structured as follows:\n1.  **Nodal Sets and Basis Construction**: For a given polynomial degree $p$, we first determine the $p+1$ nodes for both the LG and LGL sets within the reference element $\\xi \\in [-1, 1]$. We then construct the nodal differentiation matrix $D$ and the diagonal mass matrix $M$.\n2.  **Semi-Discrete Operator Symbol**: We define the boundary evaluation vectors $r_L$ and $r_R$ and use them to construct the Fourier symbol $A(\\theta)$ of the strong-form DGSEM operator with an upwind flux.\n3.  **Dispersion and Dissipation Analysis**: For a grid of non-dimensional wavenumbers $\\theta = kh$, we compute the eigenvalues of $A(\\theta)$. From these eigenvalues, we derive the numerical phase speed $c_p(\\theta)$, dissipation $d(\\theta)$, and group velocity $c_g(\\theta)$. A physical mode is identified and tracked across the wavenumber spectrum.\n4.  **Error Quantification**: Finally, we compute three error metrics for each configuration ($p$ and node type): the maximum absolute phase speed error $|c_p(\\theta) - a|$, the maximum absolute group velocity error $|c_g(\\theta) - a|$, and the maximum dissipation $d(\\theta)$.\n\n### Step 1: Nodal Sets, Differentiation, and Mass Matrices\n\nThe foundation of a nodal DGSEM is the set of collocation points within each element.\nFor a polynomial of degree $p$, we use $p+1$ points. Let $N=p+1$.\n-   **Legendre-Gauss (LG) nodes**: These are the $N$ roots of the Legendre polynomial $P_N(\\xi)$. These points lie strictly within the interval $(-1, 1)$.\n-   **Legendre-Gauss-Lobatto (LGL) nodes**: These are the $N$ roots of the polynomial $(1-\\xi^2)P_p'(\\xi)$. These points include the endpoints $\\xi = \\pm 1$ and the $p-1$ roots of $P_p'(\\xi)$, which are the same as the roots of the Jacobi polynomial $P_{p-1}^{(1,1)}(\\xi)$.\n\nThe differentiation matrix $D$ is constructed from the derivatives of the Lagrange basis polynomials $l_j(\\xi)$ evaluated at the nodes $\\xi_i$. The entries $D_{ij} = l_j'(\\xi_i)$ are computed using the formula derived from the polynomial $L(\\xi)$ which has the collocation nodes as its roots:\n$$\nD_{ij} = \\begin{cases} \\dfrac{L'(\\xi_i)}{(\\xi_i - \\xi_j)L'(\\xi_j)} & i \\neq j \\\\ -\\sum_{k\\neq i} D_{ik} & i=j \\end{cases}\n$$\nThe choice of $L(\\xi)$ depends on the nodal set:\n-   For LG nodes, $L(\\xi)$ is proportional to $P_{p+1}(\\xi)$.\n-   For LGL nodes, $L(\\xi)$ is proportional to $(1-\\xi^2)P_p'(\\xi)$.\nThe values $L'(\\xi_j)$ at the nodes are computed using standard identities for Legendre polynomials and their derivatives.\n\nThe mass matrix $M$ for a collocated scheme is diagonal, with entries $M_{jj}$ being the quadrature weights $w_j$ associated with the nodes $\\xi_j$. For both LG and LGL points, these weights are well-known:\n-   For LG quadrature, the weights are given by $w_j = \\frac{2}{(1-\\xi_j^2)[P_{p+1}'(\\xi_j)]^2}$.\n-   For LGL quadrature, the weights are $w_j = \\frac{2}{p(p+1)}$ at the endpoints $\\xi_j=\\pm 1$, and $w_j = \\frac{2}{p(p+1)[P_p(\\xi_j)]^2}$ at the interior nodes.\n\n### Step 2: Boundary Vectors and Operator Symbol\n\nThe strong-form DG operator requires evaluating the solution at the element boundaries $\\xi = -1$ and $\\xi = 1$. This is achieved using boundary evaluation vectors $r_L$ and $r_R$, whose entries are the values of the Lagrange basis functions at the left and right boundaries, respectively: $(r_L)_j = l_j(-1)$ and $(r_R)_j = l_j(1)$.\n-   For LGL nodes, since $\\xi_0 = -1$ and $\\xi_p = 1$ (assuming sorted nodes), the basis functions have the property $l_j(\\pm 1) = \\delta_{j,0 \\text{ or } p}$. This simplifies $r_L$ and $r_R$ to standard basis vectors, e.g., $r_L = [1, 0, \\dots, 0]^\\top$.\n-   For LG nodes, which are all interior to the element, the values $l_j(\\pm 1)$ are non-zero and are computed using the definition of the Lagrange basis.\n\nWith these components, the Fourier symbol $A(\\theta)$ of the semi-discrete operator for the linear advection equation with an upwind flux is given by:\n$$\nA(\\theta) = -\\frac{2a}{h}D - \\frac{2a}{h}M^{-1} r_L \\left( z^{-1}r_R^\\top - r_L^\\top \\right)\n$$\nwhere $z = e^{i\\theta}$, $i = \\sqrt{-1}$, and $\\theta=kh$ is the non-dimensional wavenumber. The term with $D$ represents the volume derivative, while the second term represents the lifted surface flux correction.\n\n### Step 3: Eigenvalue-based Analysis\n\nThe temporal evolution of a Fourier mode with wavenumber $k$ is governed by the eigenvalues $\\lambda(\\theta)$ of the symbol matrix $A(\\theta)$. For each $\\theta$, we compute the $p+1$ eigenvalues. The numerical complex angular frequency is defined as $\\omega(\\theta) = i\\lambda(\\theta)$. From this, we define:\n-   **Phase Speed**: $c_p(\\theta) = \\dfrac{\\mathrm{Re}(\\omega(\\theta))}{k} = -\\dfrac{\\mathrm{Im}(\\lambda(\\theta))}{\\theta}$. This represents the propagation speed of a single Fourier mode. The exact phase speed is $a$.\n-   **Dissipation**: $d(\\theta) = -\\mathrm{Im}(\\omega(\\theta)) = -\\mathrm{Re}(\\lambda(\\theta))$. This represents the exponential decay rate of a mode's amplitude. For the exact equation, dissipation is zero.\n-   **Group Velocity**: $c_g(\\theta) = \\dfrac{d}{dk}\\mathrm{Re}(\\omega(\\theta))$. This represents the propagation speed of a wave packet. The exact group velocity is $a$. We approximate this using central finite differences on the grid of $\\theta$ values.\n\nA critical step is to identify the \"physical branch\" of eigenvalues, corresponding to the mode that correctly approximates the physical wave propagation. Starting with the smallest non-zero $\\theta$, we select the eigenvalue whose phase speed $c_p$ is closest to the exact speed $a=1$. For subsequent values of $\\theta$, we maintain continuity by selecting the eigenvalue whose phase speed is closest to that of the previously selected physical mode.\n\n### Step 4: Error Computation\n\nAfter identifying the physical branch properties across the specified grid of $\\theta$ values, we quantify the performance of each scheme ($p$, node type) by calculating three metrics:\n1.  The maximum absolute phase speed error, $\\max_{\\theta} |c_p(\\theta) - a|$.\n2.  The maximum absolute group velocity error, $\\max_{\\theta_{\\text{int}}} |c_g(\\theta) - a|$, computed over the interior points of the $\\theta$ grid where central differences are defined.\n3.  The maximum dissipation, $\\max_{\\theta} d(\\theta)$.\n\nThese metrics provide a concise summary of the scheme's accuracy in terms of wave propagation and amplitude preservation. The following program implements this entire procedure.",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\nfrom scipy.special import eval_legendre, roots_legendre, roots_jacobi\n\ndef get_nodes_weights_Lprime(p, node_type):\n    \"\"\"\n    Computes the nodes, quadrature weights, and values of L'(x_j) for LG and LGL points.\n    L(x) is the polynomial whose roots are the collocation nodes.\n    \"\"\"\n    N = p + 1\n    if node_type == 'LG':\n        nodes, weights = roots_legendre(N)\n        # For LG, L(x) is proportional to P_N(x).\n        # We need values of L'(x_j) which are proportional to P_N'(x_j) at nodes x_j.\n        # Identity at roots of P_N(x): (1-x_j^2)P_N'(x_j) = N*P_{N-1}(x_j).\n        L_prime_vals = N * eval_legendre(N - 1, nodes) / (1 - nodes**2)\n        return nodes, weights, L_prime_vals\n\n    elif node_type == 'LGL':\n        if p == 0:\n            nodes = np.array([0.0])\n        elif p == 1:\n            internal_nodes = np.array([])\n        else: # p > 1\n            internal_nodes, _ = roots_jacobi(p - 1, 1, 1)\n        nodes = np.concatenate(([-1.0], np.sort(internal_nodes), [1.0]))\n        \n        # Weights for LGL\n        weights = np.zeros(N)\n        weights[0] = weights[-1] = 2.0 / (p * (p + 1))\n        if p > 1:\n            weights[1:-1] = 2.0 / (p * (p + 1) * eval_legendre(p, internal_nodes)**2)\n            \n        # For LGL, L(x) is proportional to (1-x^2)P_p'(x).\n        # We need L'(x_j) at the nodes x_j.\n        L_prime_vals = np.zeros(N)\n        # At x_j = -1: L'(-1) = 2*P_p'(-1) = 2*(-1)^(p-1)*p(p+1)/2 = (-1)^(p-1)*p(p+1)\n        L_prime_vals[0] = (-1.0)**(p - 1) * p * (p + 1)\n        # At x_j = +1: L'(1) = -2*P_p'(1) = -2*p(p+1)/2 = -p(p+1)\n        L_prime_vals[-1] = -p * (p + 1)\n        # At internal nodes, P_p'(x_j)=0. L'(x_j) = (1-x_j^2)P_p''(x_j) = -p(p+1)P_p(x_j)\n        if p > 1:\n             L_prime_vals[1:-1] = -p * (p + 1) * eval_legendre(p, internal_nodes)\n             \n        return nodes, weights, L_prime_vals\n\ndef get_diff_matrix(nodes, L_prime_vals):\n    \"\"\"Constructs the nodal differentiation matrix D.\"\"\"\n    N = len(nodes)\n    D = np.zeros((N, N))\n    # Use broadcasting for efficient computation of off-diagonal elements\n    nodes_col = nodes[:, np.newaxis]\n    nodes_row = nodes[np.newaxis, :]\n    L_prime_col = L_prime_vals[:, np.newaxis]\n    L_prime_row = L_prime_vals[np.newaxis, :]\n    \n    # Temporarily disable division by zero warnings for the diagonal\n    with np.errstate(divide='ignore', invalid='ignore'):\n         D = L_prime_col / (L_prime_row * (nodes_col - nodes_row))\n    \n    np.fill_diagonal(D, 0)\n    # Diagonal entries are sum of off-diagonals in the row\n    D_diag = -np.sum(D, axis=1)\n    np.fill_diagonal(D, D_diag)\n    return D\n\ndef get_boundary_vectors(p, nodes, L_prime_vals, node_type):\n    \"\"\"Constructs boundary evaluation vectors r_L and r_R.\"\"\"\n    N = p + 1\n    r_L = np.zeros(N)\n    r_R = np.zeros(N)\n    \n    if node_type == 'LGL':\n        r_L[0] = 1.0\n        r_R[-1] = 1.0\n    elif node_type == 'LG':\n        # For LG, L(x) is proportional to P_N(x).\n        # l_j(x) = L(x) / ((x - x_j) * L'(x_j))\n        L_at_1 = 1.0  # P_N(1) = 1\n        L_at_minus_1 = (-1.0)**N \n        \n        r_R = L_at_1 / ((1.0 - nodes) * L_prime_vals)\n        r_L = L_at_minus_1 / ((-1.0 - nodes) * L_prime_vals)\n        \n    return r_L, r_R\n\ndef analyze_scheme(p, node_type, a, h, thetas):\n    \"\"\"Performs the full dispersion/dissipation analysis for a given scheme.\"\"\"\n    nodes, weights, L_prime_vals = get_nodes_weights_Lprime(p, node_type)\n    \n    D = get_diff_matrix(nodes, L_prime_vals)\n    M_inv = np.diag(1.0 / weights)\n    r_L, r_R = get_boundary_vectors(p, nodes, L_prime_vals, node_type)\n    \n    physical_branch_cp = []\n    physical_branch_d = []\n    physical_branch_omega_re = []\n    prev_cp = a # Start tracking from the exact speed\n    \n    for theta in thetas:\n        z = np.exp(1j * theta)\n        \n        A_theta = (-2*a/h * D) - (2*a/h * M_inv @ (r_L[:, np.newaxis] @ (z**(-1) * r_R[np.newaxis, :] - r_L[np.newaxis, :])))\n        \n        lambdas, _ = linalg.eig(A_theta)\n        \n        k = theta / h\n        \n        cps = -lambdas.imag / k\n        ds = -lambdas.real\n        \n        # Branch tracking\n        idx = np.argmin(np.abs(cps - prev_cp))\n        current_cp = cps[idx]\n        current_d = ds[idx]\n        current_omega_re = -lambdas[idx].imag\n        \n        physical_branch_cp.append(current_cp)\n        physical_branch_d.append(current_d)\n        physical_branch_omega_re.append(current_omega_re)\n        \n        prev_cp = current_cp\n        \n    physical_branch_cp = np.array(physical_branch_cp)\n    physical_branch_d = np.array(physical_branch_d)\n    physical_branch_omega_re = np.array(physical_branch_omega_re)\n\n    max_phase_speed_error = np.max(np.abs(physical_branch_cp - a))\n    max_dissipation = np.max(physical_branch_d)\n\n    # Group velocity on interior points of the theta grid\n    group_velocities = []\n    for i in range(1, len(thetas) - 1):\n        omega_re_plus = physical_branch_omega_re[i+1]\n        omega_re_minus = physical_branch_omega_re[i-1]\n        k_plus = thetas[i+1] / h\n        k_minus = thetas[i-1] / h\n        cg = (omega_re_plus - omega_re_minus) / (k_plus - k_minus)\n        group_velocities.append(cg)\n    \n    max_group_velocity_error = np.max(np.abs(np.array(group_velocities) - a))\n\n    return max_phase_speed_error, max_group_velocity_error, max_dissipation\n\ndef solve():\n    # Define the test cases from the problem statement.\n    a = 1.0\n    h = 1.0\n    ps = [1, 3, 6]\n    node_types = ['LGL', 'LG']\n    \n    thetas = np.array([m * np.pi / 16.0 for m in range(1, 10)])\n\n    results = []\n    for p_val in ps:\n        for node_type_val in node_types:\n            errors = analyze_scheme(p_val, node_type_val, a, h, thetas)\n            results.extend(errors)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}