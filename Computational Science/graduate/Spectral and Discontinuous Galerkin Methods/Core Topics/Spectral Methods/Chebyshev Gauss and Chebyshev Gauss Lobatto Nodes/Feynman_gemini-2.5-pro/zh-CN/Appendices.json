{
    "hands_on_practices": [
        {
            "introduction": "谱方法和间断伽辽金方法通常在参考单元上进行公式化，然后通过映射应用到网格中的物理单元上。这个基础练习将引导你推导在这种仿射映射下，求积权重和微分矩阵的缩放规律，并最终构建出核心的质量矩阵和刚度矩阵。",
            "id": "3369302",
            "problem": "考虑在参考区间 $[-1,1]$ 上的一维谱元格式，其节点拉格朗日基函数定义在 Chebyshev-Gauss 节点或 Chebyshev-Gauss-Lobatto 节点上。Chebyshev-Gauss 节点由 $\\xi_{k}=\\cos\\left(\\frac{2k-1}{2N}\\pi\\right)$（$k=1,\\dots,N$）给出，而 Chebyshev-Gauss-Lobatto 节点由 $\\xi_{j}=\\cos\\left(\\frac{j}{N}\\pi\\right)$（$j=0,\\dots,N$）给出。令 $\\{\\hat{\\ell}_{m}(\\xi)\\}$ 表示在 $[-1,1]$ 上的相关节点拉格朗日基，并令 $\\{\\hat{w}_{m}\\}$ 表示在 $[-1,1]$ 上与任一节点选择配对的任意一致的参考求积权重，使得离散内积由 $\\sum_{m}\\hat{w}_{m} f(\\xi_{m})g(\\xi_{m})$ 近似。\n\n通过仿射映射 $x=\\frac{b-a}{2}\\,\\xi+\\frac{a+b}{2}$ 将参考单元映射到物理单元 $[a,b]$，其雅可比定义为 $J=\\frac{b-a}{2}$。通过参考基的回拉来定义物理节点基 $\\{\\ell_{m}(x)\\}$，即 $\\ell_{m}(x)=\\hat{\\ell}_{m}(\\xi(x))$。仅使用链式法则、仿射映射的雅可比定义，以及谱方法和间断 Galerkin (DG) 方法中的标准离散内积构造，完成以下任务：\n\n1. 从以上定义出发，确定在仿射映射下，物理单元求积权重 $\\{w_{m}\\}$ 相对于参考权重 $\\{\\hat{w}_{m}\\}$ 如何缩放。\n\n2. 确定在仿射映射下，物理微分矩阵 $D_{x}$ 相对于参考微分矩阵 $D_{\\xi}$ 如何缩放，其中 $D_{\\xi}$ 作用于函数在 $[-1,1]$ 上的节点值，以近似其关于 $\\xi$ 的导数。\n\n3. 根据参考算子 $(\\hat{W},D_{\\xi})$ 构造单元级质量矩阵 $M_{e}$ 和刚度矩阵 $K_{e}$，其中 $\\hat{W}=\\mathrm{diag}(\\hat{w}_{m})$ 是参考求积权重的对角矩阵。您的构造应仅使用仿射映射和适用于节点谱/DG格式的离散内积定义。\n\n最后，提取并给出乘法标量 $\\alpha$，使得 $K_{e}=\\alpha\\,\\hat{K}$，其中 $\\hat{K}=D_{\\xi}^{\\top}\\hat{W}D_{\\xi}$ 是参考刚度矩阵。请将您的最终答案表示为仅含 $a$ 和 $b$ 的单个闭式解析表达式。不需要数值近似。",
            "solution": "该问题被认为是有效的，因为它科学地基于数值分析的原理，特别是谱元法。它问题适定、客观，并为得到唯一的、可验证的解提供了完整且一致的定义和约束。\n\n问题的核心在于理解积分和导数在仿射坐标变换下的转换方式，以及这些转换如何在谱方法和间断 Galerkin (DG) 方法中使用的离散算子中体现出来。从参考单元 $\\xi \\in [-1, 1]$ 到物理单元 $x \\in [a, b]$ 的仿射映射由下式给出：\n$$x(\\xi) = \\frac{b-a}{2}\\xi + \\frac{a+b}{2}$$\n该变换的雅可比 $J$ 是一个常数，表示长度元的缩放比例：\n$$J = \\frac{dx}{d\\xi} = \\frac{b-a}{2}$$\n坐标的反向关系是 $\\xi(x) = \\frac{2x - (a+b)}{b-a}$，这给出了导数的缩放比例：\n$$\\frac{d\\xi}{dx} = \\frac{2}{b-a} = \\frac{1}{J}$$\n\n我们现在将按顺序解决这三个任务。\n\n1. 物理求积权重 $\\{w_{m}\\}$ 的缩放\n\n物理单元求积权重 $\\{w_m\\}$ 的定义是，它们能正确地近似函数 $f(x)$ 在物理单元 $[a, b]$ 上的积分：\n$$ \\int_{a}^{b} f(x) \\, dx \\approx \\sum_{m} w_m f(x_m) $$\n其中 $x_m = x(\\xi_m)$ 是物理节点。为了找到 $\\{w_m\\}$ 和参考权重 $\\{\\hat{w}_m\\}$ 之间的关系，我们对积分进行从 $x$ 到 $\\xi$ 的变量替换。\n$$ \\int_{a}^{b} f(x) \\, dx = \\int_{-1}^{1} f(x(\\xi)) \\frac{dx}{d\\xi} \\, d\\xi = \\int_{-1}^{1} f(x(\\xi)) J \\, d\\xi $$\n现在，我们使用参考求积法则来近似参考单元上的积分，该法则规定对于函数 $g(\\xi)$，有 $\\int_{-1}^{1} g(\\xi) \\, d\\xi \\approx \\sum_m \\hat{w}_m g(\\xi_m)$。在我们的例子中，被积函数是 $g(\\xi) = f(x(\\xi)) J$。应用该求积法则得到：\n$$ \\int_{-1}^{1} f(x(\\xi)) J \\, d\\xi \\approx \\sum_{m} \\hat{w}_m \\left( f(x(\\xi_m)) J \\right) $$\n由于 $J$ 是一个常数，我们可以将其重写为：\n$$ \\sum_{m} (J \\hat{w}_m) f(x_m) $$\n通过将此表达式与物理求积的定义 $\\sum_{m} w_m f(x_m)$ 进行比较，我们可以直接确定物理权重：\n$$ w_m = J \\hat{w}_m = \\frac{b-a}{2} \\hat{w}_m $$\n因此，物理求积权重是参考权重按雅可比 $J$ 缩放的结果。\n\n2. 物理微分矩阵 $D_{x}$ 的缩放\n\n微分矩阵 $D_{\\xi}$ 和 $D_{x}$ 是线性算子，它们作用于节点函数值的向量，以近似节点导数值的向量。这些矩阵之间的关系可以从微分的链式法则中导出。对于任意可微函数 $u$，我们有：\n$$ \\frac{du}{dx} = \\frac{du}{d\\xi} \\frac{d\\xi}{dx} $$\n代入 $\\frac{d\\xi}{dx}$ 的表达式：\n$$ \\frac{du}{dx} = \\frac{du}{d\\xi} \\left( \\frac{1}{J} \\right) $$\n这种连续关系必须在离散层面上成立。如果 $\\mathbf{u}$ 是节点处函数值的向量，那么在节点处关于 $x$ 的导数值向量（由 $D_x \\mathbf{u}$ 给出）必须等于关于 $\\xi$ 的导数值向量（由 $D_{\\xi} \\mathbf{u}$ 给出）的 $\\frac{1}{J}$ 倍。\n$$ D_x \\mathbf{u} = \\frac{1}{J} (D_{\\xi} \\mathbf{u}) $$\n由于这对于任何函数 $u$（因此对于任何节点向量 $\\mathbf{u}$）都必须成立，所以矩阵关系为：\n$$ D_x = \\frac{1}{J} D_{\\xi} = \\frac{2}{b-a} D_{\\xi} $$\n\n3. 质量矩阵和刚度矩阵的构造 ($M_e$ 和 $K_e$)\n\n单元质量矩阵和刚度矩阵由基函数及其导数的离散内积构造而成。\n\n单元级质量矩阵 $M_e$ 的元素 $(M_e)_{ij}$ 由内积 $(\\ell_i, \\ell_j)_{L^2([a,b])}$ 给出：\n$$ (M_e)_{ij} = \\int_{a}^{b} \\ell_i(x) \\ell_j(x) \\, dx $$\n使用 $\\ell_i(x) = \\hat{\\ell}_i(\\xi(x))$ 和 $dx = J\\,d\\xi$ 变换到参考单元：\n$$ (M_e)_{ij} = \\int_{-1}^{1} \\hat{\\ell}_i(\\xi) \\hat{\\ell}_j(\\xi) J \\, d\\xi $$\n使用参考求积法则，该积分近似为：\n$$ (M_e)_{ij} \\approx J \\sum_{m} \\hat{w}_m \\hat{\\ell}_i(\\xi_m) \\hat{\\ell}_j(\\xi_m) $$\n根据节点拉格朗日基函数的定义，$\\hat{\\ell}_i(\\xi_m) = \\delta_{im}$，其中 $\\delta_{im}$ 是克罗内克 delta 符号。因此，乘积 $\\hat{\\ell}_i(\\xi_m) \\hat{\\ell}_j(\\xi_m) = \\delta_{im} \\delta_{jm}$。该乘积仅在 $m=i$ 且 $m=j$ 时非零，这要求 $i=j$。求和式因此简化为：\n$$ (M_e)_{ij} \\approx J \\sum_{m} \\hat{w}_m \\delta_{im} \\delta_{jm} = J \\hat{w}_i \\delta_{ij} $$\n这表明 $M_e$ 是一个对角矩阵。以矩阵形式，使用 $\\hat{W} = \\mathrm{diag}(\\hat{w}_m)$：\n$$ M_e = J \\hat{W} = \\frac{b-a}{2} \\hat{W} $$\n\n单元级刚度矩阵 $K_e$ 的元素 $(K_e)_{ij}$ 由基函数导数的内积给出：\n$$ (K_e)_{ij} = \\int_{a}^{b} \\frac{d\\ell_i(x)}{dx} \\frac{d\\ell_j(x)}{dx} \\, dx $$\n使用链式法则，$\\frac{d\\ell_j}{dx} = \\frac{1}{J}\\frac{d\\hat{\\ell}_j}{d\\xi}$。应用此法则并进行积分变量替换：\n$$ (K_e)_{ij} = \\int_{-1}^{1} \\left( \\frac{1}{J} \\frac{d\\hat{\\ell}_i}{d\\xi} \\right) \\left( \\frac{1}{J} \\frac{d\\hat{\\ell}_j}{d\\xi} \\right) (J \\, d\\xi) = \\frac{1}{J} \\int_{-1}^{1} \\frac{d\\hat{\\ell}_i}{d\\xi} \\frac{d\\hat{\\ell}_j}{d\\xi} \\, d\\xi $$\n使用参考求积法则近似该积分：\n$$ (K_e)_{ij} \\approx \\frac{1}{J} \\sum_{m} \\hat{w}_m \\left( \\frac{d\\hat{\\ell}_i}{d\\xi} \\Big|_{\\xi=\\xi_m} \\right) \\left( \\frac{d\\hat{\\ell}_j}{d\\xi} \\Big|_{\\xi=\\xi_m} \\right) $$\n项 $\\frac{d\\hat{\\ell}_j}{d\\xi} |_{\\xi=\\xi_m}$ 是参考微分矩阵的第 $(m,j)$ 个元素，即 $(D_{\\xi})_{mj}$。因此，我们可以用矩阵表示法写出该求和：\n$$ (K_e)_{ij} \\approx \\frac{1}{J} \\sum_{m} (D_{\\xi})_{mi} \\hat{w}_m (D_{\\xi})_{mj} $$\n认识到 $\\hat{W} = \\mathrm{diag}(\\hat{w}_m)$，该求和是矩阵乘积 $D_{\\xi}^{\\top} \\hat{W} D_{\\xi}$ 的第 $(i,j)$ 个元素。\n$$ (K_e)_{ij} \\approx \\frac{1}{J} (D_{\\xi}^{\\top} \\hat{W} D_{\\xi})_{ij} $$\n因此，矩阵 $K_e$ 与参考刚度矩阵 $\\hat{K} = D_{\\xi}^{\\top} \\hat{W} D_{\\xi}$ 的关系如下：\n$$ K_e = \\frac{1}{J} \\hat{K} $$\n\n最后，我们被要求找到乘法标量 $\\alpha$，使得 $K_e = \\alpha \\hat{K}$。从我们推导出的关系中，我们可以立即看出：\n$$ \\alpha = \\frac{1}{J} $$\n代入雅可比的定义 $J = \\frac{b-a}{2}$：\n$$ \\alpha = \\frac{1}{\\frac{b-a}{2}} = \\frac{2}{b-a} $$\n这就是所要求的仅用 $a$ 和 $b$ 表示的闭式表达式。",
            "answer": "$$\\boxed{\\frac{2}{b-a}}$$"
        },
        {
            "introduction": "谱方法的一个著名特性是其对于解析函数能实现指数收敛，但当函数不满足此条件时会发生什么呢？这个高级问题将探讨对一个具有端点奇性的函数进行插值的情况，它揭示了收敛率如何从指数阶退化为代数阶，并将此行为与函数切比雪夫系数的衰减联系起来。",
            "id": "3369358",
            "problem": "考虑函数 $f:[-1,1]\\to\\mathbb{R}$，其定义为 $f(x)=(1-x)^{\\beta}$，其中指数 $\\beta\\in(0,1)$ 是一个固定值。令 $T_{n}(x)$ 表示第一类 $n$ 次切比雪夫多项式，并回顾恒等式 $T_{n}(\\cos\\theta)=\\cos(n\\theta)$ 对所有 $\\theta\\in\\mathbb{R}$ 成立。通过标准的余弦表示来定义 $f$ 的切比雪夫系数 $\\{a_{n}\\}_{n\\geq 0}$：\n$$\na_{n}=\\frac{2}{\\pi}\\int_{0}^{\\pi}f(\\cos\\theta)\\cos(n\\theta)\\,d\\theta,\\quad n\\geq 0,\n$$\n并考虑在 $[-1,1]$ 上的两个典范聚集节点集上对 $f$ 进行 $N$ 次多项式插值：\n- 切比雪夫–高斯节点 $x_{j}^{\\mathrm{G}}=\\cos\\left(\\frac{(2j+1)\\pi}{2(N+1)}\\right)$，其中 $j=0,\\dots,N$（$T_{N+1}$ 的零点），以及\n- 切比雪夫–高斯–洛巴托节点 $x_{j}^{\\mathrm{L}}=\\cos\\left(\\frac{j\\pi}{N}\\right)$，其中 $j=0,\\dots,N$（$(1-x^2)T_N'(x)$ 的零点，包括端点）。\n\n令 $p_{N}^{\\mathrm{G}}$ 和 $p_{N}^{\\mathrm{L}}$ 分别表示在这些节点上对 $f$ 进行的 $N$ 次插值多项式。仅从上述定义、恒等式 $T_{n}(\\cos\\theta)=\\cos(n\\theta)$、光滑函数的标准渐近展开以及针对振荡积分的经过充分检验的积分变换出发，推导大 $N$ 代数收敛率指数 $p(\\beta)$，使得\n$$\n\\|f-p_{N}^{\\mathrm{G}}\\|_{L^{\\infty}([-1,1])}=\\Theta(N^{-p(\\beta)})\\quad\\text{且}\\quad \\|f-p_{N}^{\\mathrm{L}}\\|_{L^{\\infty}([-1,1])}=\\Theta(N^{-p(\\beta)}),\n$$\n其中记号 $\\Theta(\\cdot)$ 的精确含义是，在相差一个依赖于 $\\beta$ 但不依赖于 $N$ 的正常数下成立的双边界。您的推导必须通过量化 $\\{a_{n}\\}$ 的衰减，并将此衰减传播到两种节点族的插值误差中，从而明确证明 $x=1$ 处的端点奇点迫使收敛是代数的（而非指数的）。最后，给出 $p(\\beta)$ 的解析表达式，并说明切比雪夫–高斯节点和切比雪夫–高斯–洛巴托节点之间的聚集差异是否会改变此指数。\n\n您的最终答案必须仅为 $p(\\beta)$ 的闭式解析表达式。无需数值舍入。",
            "solution": "目标是推导函数 $f(x) = (1-x)^\\beta$ 在 $[-1,1]$ 上（其中 $\\beta \\in (0,1)$）的切比雪夫插值的代数收敛率指数 $p(\\beta)$。推导过程首先需要找到 $f$ 的切比雪夫系数的渐近衰减率，然后用它来确定 $N$ 次插值多项式 $p_N^{\\mathrm{G}}$ 和 $p_N^{\\mathrm{L}}$ 的误差。\n\n首先，我们分析 $f(x)$ 的切比雪夫系数 $\\{a_n\\}_{n\\geq 0}$。问题给出的定义为\n$$\na_n = \\frac{2}{\\pi} \\int_0^\\pi f(\\cos\\theta) \\cos(n\\theta) d\\theta, \\quad n \\ge 0.\n$$\n代入 $f(x)=(1-x)^\\beta$，我们得到 $f(\\cos\\theta) = (1-\\cos\\theta)^\\beta$。积分变为\n$$\na_n = \\frac{2}{\\pi} \\int_0^\\pi (1-\\cos\\theta)^\\beta \\cos(n\\theta) d\\theta.\n$$\n当 $n \\to \\infty$ 时，序列 $\\{a_n\\}$ 的收敛率由函数 $g(\\theta) = (1-\\cos\\theta)^\\beta$ 在区间 $[0, \\pi]$ 上的光滑性决定。函数 $g(\\theta)$ 在 $\\theta \\in (0, \\pi]$ 上是解析的。然而，在 $\\theta=0$ 处（对应于点 $x=1$），由于 $\\beta$ 不是整数，函数具有奇点。我们使用 $\\cos\\theta$ 的泰勒展开来分析 $\\theta=0$ 附近的行为：\n$$\n1-\\cos\\theta = 1 - \\left(1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - \\dots\\right) = \\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + \\mathcal{O}(\\theta^6).\n$$\n对于小的 $\\theta$，我们有 $(1-\\cos\\theta)^\\beta \\approx \\left(\\frac{\\theta^2}{2}\\right)^\\beta = 2^{-\\beta}\\theta^{2\\beta}$。\n像 $a_n$ 这样的振荡积分的渐近行为主要由被积函数非振荡部分的非解析点的贡献决定。在这种情况下，$[0,\\pi]$ 中唯一的这样的点是端点 $\\theta=0$。来自光滑端点 $\\theta=\\pi$ 的贡献可以忽略不计，因为它比 $n$ 的任何负幂次都衰减得更快。\n\n对于在 $\\theta=0$ 处具有 $|\\theta|^\\alpha$ 形式的代数奇点的函数，其第 $n$ 个傅里叶余弦系数的渐近行为阶为 $\\mathcal{O}(n^{-(\\alpha+1)})$（对于 $\\alpha > -1$）。这里，函数 $g(\\theta)$ 的行为如同 $\\theta^{2\\beta}$，所以 $\\alpha=2\\beta$。因此，我们预期 $|a_n| = \\Theta(n^{-(2\\beta+1)})$。\n\n为了更严格地证明这一点，我们可以使用驻相法，或者更准确地说，是 Watson 引理在傅里叶积分中的一个应用。我们通过积分在奇点附近的行为来近似它：\n$$\na_n \\approx \\frac{2}{\\pi} \\int_0^\\epsilon 2^{-\\beta} \\theta^{2\\beta} \\cos(n\\theta) d\\theta\n$$\n对于某个小的 $\\epsilon>0$。令 $u=n\\theta$，则 $d\\theta = du/n$。积分变为\n$$\na_n \\approx \\frac{2 \\cdot 2^{-\\beta}}{\\pi} \\int_0^{n\\epsilon} \\left(\\frac{u}{n}\\right)^{2\\beta} \\cos(u) \\frac{du}{n} = \\frac{2^{1-\\beta}}{\\pi n^{2\\beta+1}} \\int_0^{n\\epsilon} u^{2\\beta} \\cos(u) du.\n$$\n当 $n \\to \\infty$ 时，积分上限 $n\\epsilon \\to \\infty$。定积分 $\\int_0^\\infty u^{2\\beta} \\cos(u) du$ 对于 $\\beta \\in (0,1)$ 是收敛的，并且是一个与 $n$ 无关的常数。此积分可与伽马函数 (Gamma function) 建立联系：\n$$\n\\int_0^\\infty u^{2\\beta} \\cos(u) du = \\text{Re}\\left[ \\int_0^\\infty u^{2\\beta} e^{iu} du \\right] = \\text{Re}\\left[ \\frac{\\Gamma(2\\beta+1)}{( -i )^{2\\beta+1}} \\right] = -\\Gamma(2\\beta+1)\\sin(\\pi\\beta).\n$$\n由于 $\\beta \\in (0,1)$，$\\sin(\\pi\\beta) \\neq 0$。因此，系数的渐近行为是\n$$\na_n \\sim -\\frac{2^{1-\\beta} \\Gamma(2\\beta+1) \\sin(\\pi\\beta)}{\\pi} n^{-(2\\beta+1)}.\n$$\n这证实了 $|a_n| = \\Theta(n^{-(2\\beta+1)})$。代数衰减是 $x=1$ 处奇点的直接后果。\n\n接下来，我们将此系数衰减与插值误差联系起来。多项式插值的误差与 $N$ 次最佳一致多项式逼近 $p_N^*$ 的误差有关。最佳逼近的误差又受限于截断的切比雪夫级数 $S_N f(x) = \\sum_{k=0}^N c_k T_k(x)$ 的误差，其中 $\\{c_k\\}$ 是标准的切比雪夫展开系数。问题中给出的系数 $a_n$ 为 $a_n=2c_n$（对于 $n>0$）和 $a_0=c_0$。渐近衰减率不受影响。截断级数的误差为\n$$\n\\|f - S_N f\\|_{L^\\infty([-1,1])} = \\left\\| \\sum_{k=N+1}^\\infty c_k T_k \\right\\|_{L^\\infty} \\le \\sum_{k=N+1}^\\infty |c_k|.\n$$\n由于 $|c_k| = \\Theta(k^{-(2\\beta+1)})$，此和的行为类似于相应的积分：\n$$\n\\sum_{k=N+1}^\\infty k^{-(2\\beta+1)} \\approx \\int_{N+1}^\\infty t^{-(2\\beta+1)} dt = \\left[ \\frac{t^{-2\\beta}}{-2\\beta} \\right]_{N+1}^\\infty = \\frac{1}{2\\beta}(N+1)^{-2\\beta}.\n$$\n因此，最佳逼近误差为 $\\|f - p_N^*\\|_{L^\\infty} = \\Theta(N^{-2\\beta})$。\n\n插值误差 $\\|f - p_N\\|$（对于任一节点集）由 $\\|f - p_N\\|_{L^\\infty} \\le (1+\\Lambda_N)\\|f - p_N^*\\|_{L^\\infty}$ 界定，其中 $\\Lambda_N$ 是勒贝格常数。对于切比雪夫–高斯节点和切比雪夫–高斯–洛巴托节点，$\\Lambda_N = \\mathcal{O}(\\ln N)$。这给出了一个上界 $\\|f - p_N\\|_{L^\\infty} = \\mathcal{O}(N^{-2\\beta} \\ln N)$，但这对于确定 $\\Theta$ 阶是不够精确的。\n\n一个更精确的分析指出，对于这类具有代数端点奇点的函数，插值误差的收敛率与最佳逼近误差的收敛率相同，对数因子不会出现。也就是说，对于切比雪夫点（CG 和 CGL），有\n$$\n\\|f - p_N\\|_{L^\\infty} = \\Theta(\\|f - p_N^*\\|_{L^\\infty}) = \\Theta(N^{-2\\beta}).\n$$\n这表明，尽管 CG 和 CGL 节点在端点处的聚集方式略有不同，但它们对由端点奇点控制的代数收敛率的影响是相同的。收敛率指数 $p(\\beta)$ 不依赖于这两种节点集之间的选择。\n\n因此，收敛率指数由下式给出\n$$\np(\\beta) = 2\\beta.\n$$",
            "answer": "$$\\boxed{2\\beta}$$"
        }
    ]
}