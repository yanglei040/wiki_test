{
    "hands_on_practices": [
        {
            "introduction": "在求积概念的基础上，本练习将探讨参考单元上的算子（如质量矩阵和刚度矩阵）是如何构建并变换到物理单元上的。理解这种缩放关系对于实现谱方法和间断伽辽金方法至关重要。这项练习将切比雪夫节点的抽象性质与求解偏微分方程中使用的矩阵的实际构建联系起来。",
            "id": "3369302",
            "problem": "考虑在参考区间 $[-1,1]$ 上的一维谱元公式，其节点拉格朗日基函数定义在切比雪夫-高斯节点或切比雪夫-高斯-洛巴托节点上。切比雪夫-高斯节点由 $\\xi_{k}=\\cos\\left(\\frac{2k-1}{2N}\\pi\\right)$ 给出，其中 $k=1,\\dots,N$；切比雪夫-高斯-洛巴托节点由 $\\xi_{j}=\\cos\\left(\\frac{j}{N}\\pi\\right)$ 给出，其中 $j=0,\\dots,N$。令 $\\{\\hat{\\ell}_{m}(\\xi)\\}$表示 $[-1,1]$ 上相关的节点拉格朗日基，并令 $\\{\\hat{w}_{m}\\}$ 表示与任一节点选择配对的 $[-1,1]$ 上的任意一致的参考求积权重，使得离散内积近似为 $\\sum_{m}\\hat{w}_{m} f(\\xi_{m})g(\\xi_{m})$。\n\n通过仿射映射 $x=\\frac{b-a}{2}\\,\\xi+\\frac{a+b}{2}$ 将参考单元映射到物理单元 $[a,b]$，其雅可比行列式定义为 $J=\\frac{b-a}{2}$。通过参考基的回拉来定义物理节点基 $\\{\\ell_{m}(x)\\}$，即 $\\ell_{m}(x)=\\hat{\\ell}_{m}(\\xi(x))$。仅使用链式法则、仿射映射的雅可比行列式的定义，以及谱方法和间断伽辽金（DG）方法中的标准离散内积构造，完成以下任务：\n\n1. 从以上定义出发，确定在仿射映射下，物理单元求积权重 $\\{w_{m}\\}$ 相对于参考权重 $\\{\\hat{w}_{m}\\}$ 如何缩放。\n\n2. 确定在仿射映射下，物理微分矩阵 $D_{x}$ 相对于参考微分矩阵 $D_{\\xi}$ 如何缩放，其中 $D_{\\xi}$ 作用于 $[-1,1]$ 上函数的节点值，以近似其关于 $\\xi$ 的导数。\n\n3. 根据参考算子 $(\\hat{W},D_{\\xi})$ 构造单元级质量矩阵 $M_{e}$ 和刚度矩阵 $K_{e}$，其中 $\\hat{W}=\\mathrm{diag}(\\hat{w}_{m})$ 是参考求积权重的对角矩阵。您的构造应仅使用仿射映射和适用于节点谱/DG公式的离散内积定义。\n\n最后，提取并提供乘法标量 $\\alpha$，使得 $K_{e}=\\alpha\\,\\hat{K}$，其中 $\\hat{K}=D_{\\xi}^{\\top}\\hat{W}D_{\\xi}$ 是参考刚度矩阵。请将您的最终答案表示为仅含 $a$ 和 $b$ 的单个闭式解析表达式。不需要数值近似。",
            "solution": "该问题被认为是有效的，因为它科学地基于数值分析的原理，特别是谱元法。该问题是适定的、客观的，并为获得唯一的、可验证的解提供了一套完整且一致的定义和约束。\n\n问题的核心在于理解积分和导数在仿射坐标变换下如何转换，以及这些转换如何在谱方法和间断伽辽金（DG）方法中使用的离散算子中体现出来。从参考单元 $\\xi \\in [-1, 1]$ 到物理单元 $x \\in [a, b]$ 的仿射映射由下式给出\n$$x(\\xi) = \\frac{b-a}{2}\\xi + \\frac{a+b}{2}$$\n该变换的雅可比行列式 $J$ 是一个常数，表示长度元的缩放比例：\n$$J = \\frac{dx}{d\\xi} = \\frac{b-a}{2}$$\n坐标的反向关系为 $\\xi(x) = \\frac{2x - (a+b)}{b-a}$，这给出了导数的缩放比例：\n$$\\frac{d\\xi}{dx} = \\frac{2}{b-a} = \\frac{1}{J}$$\n\n我们现在按顺序处理这三个任务。\n\n1. 物理求积权重 $\\{w_{m}\\}$ 的缩放\n\n物理单元求积权重 $\\{w_m\\}$ 的定义是，它们能正确地近似函数 $f(x)$ 在物理单元 $[a, b]$ 上的积分：\n$$ \\int_{a}^{b} f(x) \\, dx \\approx \\sum_{m} w_m f(x_m) $$\n其中 $x_m = x(\\xi_m)$ 是物理节点。为了找到 $\\{w_m\\}$ 和参考权重 $\\{\\hat{w}_m\\}$ 之间的关系，我们对积分进行从 $x$ 到 $\\xi$ 的变量替换。\n$$ \\int_{a}^{b} f(x) \\, dx = \\int_{-1}^{1} f(x(\\xi)) \\frac{dx}{d\\xi} \\, d\\xi = \\int_{-1}^{1} f(x(\\xi)) J \\, d\\xi $$\n现在，我们使用参考求积法则来近似参考单元上的积分，该法则指出，对于函数 $g(\\xi)$，有 $\\int_{-1}^{1} g(\\xi) \\, d\\xi \\approx \\sum_m \\hat{w}_m g(\\xi_m)$。在我们的例子中，被积函数是 $g(\\xi) = f(x(\\xi)) J$。应用该求积法则得到：\n$$ \\int_{-1}^{1} f(x(\\xi)) J \\, d\\xi \\approx \\sum_{m} \\hat{w}_m \\left( f(x(\\xi_m)) J \\right) $$\n由于 $J$ 是一个常数，我们可以将其重写为：\n$$ \\sum_{m} (J \\hat{w}_m) f(x_m) $$\n通过将此表达式与物理求积的定义 $\\sum_{m} w_m f(x_m)$ 进行比较，我们可以直接确定物理权重：\n$$ w_m = J \\hat{w}_m = \\frac{b-a}{2} \\hat{w}_m $$\n因此，物理求积权重是参考权重乘以雅可比行列式 $J$。\n\n2. 物理微分矩阵 $D_{x}$ 的缩放\n\n微分矩阵 $D_{\\xi}$ 和 $D_{x}$ 是线性算子，它们作用于节点函数值的向量，以近似节点导数值的向量。这些矩阵之间的关系可以从微分的链式法则推导出来。对于任何可微函数 $u$，我们有：\n$$ \\frac{du}{dx} = \\frac{du}{d\\xi} \\frac{d\\xi}{dx} $$\n代入 $\\frac{d\\xi}{dx}$ 的表达式：\n$$ \\frac{du}{dx} = \\frac{du}{d\\xi} \\left( \\frac{1}{J} \\right) $$\n这种连续关系必须在离散层面上成立。如果 $\\mathbf{u}$ 是节点上的函数值向量，那么在节点上关于 $x$ 的导数值向量（由 $D_x \\mathbf{u}$ 给出）必须等于关于 $\\xi$ 的导数值向量（由 $D_{\\xi} \\mathbf{u}$ 给出）的 $\\frac{1}{J}$ 倍。\n$$ D_x \\mathbf{u} = \\frac{1}{J} (D_{\\xi} \\mathbf{u}) $$\n由于这对任何函数 $u$（因此对任何节点向量 $\\mathbf{u}$）都必须成立，所以矩阵关系为：\n$$ D_x = \\frac{1}{J} D_{\\xi} = \\frac{2}{b-a} D_{\\xi} $$\n\n3. 质量矩阵和刚度矩阵（$M_e$ 和 $K_e$）的构造\n\n单元质量矩阵和刚度矩阵是由基函数及其导数的离散内积构造的。\n\n单元级质量矩阵 $M_e$ 的元素 $(M_e)_{ij}$ 由内积 $(\\ell_i, \\ell_j)_{L^2([a,b])}$ 给出：\n$$ (M_e)_{ij} = \\int_{a}^{b} \\ell_i(x) \\ell_j(x) \\, dx $$\n使用 $\\ell_i(x) = \\hat{\\ell}_i(\\xi(x))$ 和 $dx = J\\,d\\xi$ 转换到参考单元：\n$$ (M_e)_{ij} = \\int_{-1}^{1} \\hat{\\ell}_i(\\xi) \\hat{\\ell}_j(\\xi) J \\, d\\xi $$\n使用参考求积法则，该积分近似为：\n$$ (M_e)_{ij} \\approx J \\sum_{m} \\hat{w}_m \\hat{\\ell}_i(\\xi_m) \\hat{\\ell}_j(\\xi_m) $$\n根据节点拉格朗日基函数的定义，$\\hat{\\ell}_i(\\xi_m) = \\delta_{im}$，其中 $\\delta_{im}$ 是克罗内克（Kronecker）δ。因此，乘积 $\\hat{\\ell}_i(\\xi_m) \\hat{\\ell}_j(\\xi_m) = \\delta_{im} \\delta_{jm}$。该乘积仅在 $m=i$ 和 $m=j$ 时非零，这要求 $i=j$。求和式因此简化为：\n$$ (M_e)_{ij} \\approx J \\sum_{m} \\hat{w}_m \\delta_{im} \\delta_{jm} = J \\hat{w}_i \\delta_{ij} $$\n这表明 $M_e$ 是一个对角矩阵。以矩阵形式，使用 $\\hat{W} = \\mathrm{diag}(\\hat{w}_m)$：\n$$ M_e = J \\hat{W} = \\frac{b-a}{2} \\hat{W} $$\n\n单元级刚度矩阵 $K_e$ 的元素 $(K_e)_{ij}$ 由基函数导数的内积给出：\n$$ (K_e)_{ij} = \\int_{a}^{b} \\frac{d\\ell_i(x)}{dx} \\frac{d\\ell_j(x)}{dx} \\, dx $$\n使用链式法则，$\\frac{d\\ell_j}{dx} = \\frac{1}{J}\\frac{d\\hat{\\ell}_j}{d\\xi}$。应用此法则并进行积分变量替换：\n$$ (K_e)_{ij} = \\int_{-1}^{1} \\left( \\frac{1}{J} \\frac{d\\hat{\\ell}_i}{d\\xi} \\right) \\left( \\frac{1}{J} \\frac{d\\hat{\\ell}_j}{d\\xi} \\right) (J \\, d\\xi) = \\frac{1}{J} \\int_{-1}^{1} \\frac{d\\hat{\\ell}_i}{d\\xi} \\frac{d\\hat{\\ell}_j}{d\\xi} \\, d\\xi $$\n用参考求积法则近似该积分：\n$$ (K_e)_{ij} \\approx \\frac{1}{J} \\sum_{m} \\hat{w}_m \\left( \\frac{d\\hat{\\ell}_i}{d\\xi} \\Big|_{\\xi=\\xi_m} \\right) \\left( \\frac{d\\hat{\\ell}_j}{d\\xi} \\Big|_{\\xi=\\xi_m} \\right) $$\n项 $\\frac{d\\hat{\\ell}_j}{d\\xi} |_{\\xi=\\xi_m}$ 是参考微分矩阵的第 $(m,j)$ 个元素，即 $(D_{\\xi})_{mj}$。因此，我们可以用矩阵表示法写出该求和：\n$$ (K_e)_{ij} \\approx \\frac{1}{J} \\sum_{m} (D_{\\xi})_{mi} \\hat{w}_m (D_{\\xi})_{mj} $$\n认识到 $\\hat{W} = \\mathrm{diag}(\\hat{w}_m)$，该求和是矩阵乘积 $D_{\\xi}^{\\top} \\hat{W} D_{\\xi}$ 的第 $(i,j)$ 个元素。\n$$ (K_e)_{ij} \\approx \\frac{1}{J} (D_{\\xi}^{\\top} \\hat{W} D_{\\xi})_{ij} $$\n因此，矩阵 $K_e$ 与参考刚度矩阵 $\\hat{K} = D_{\\xi}^{\\top} \\hat{W} D_{\\xi}$ 的关系如下：\n$$ K_e = \\frac{1}{J} \\hat{K} $$\n\n最后，我们被要求找到乘法标量 $\\alpha$，使得 $K_e = \\alpha \\hat{K}$。从我们推导出的关系中，我们可以立即看出：\n$$ \\alpha = \\frac{1}{J} $$\n代入雅可比行列式的定义 $J = \\frac{b-a}{2}$：\n$$ \\alpha = \\frac{1}{\\frac{b-a}{2}} = \\frac{2}{b-a} $$\n这就是所要求的仅用 $a$ 和 $b$ 表示的闭式表达式。",
            "answer": "$$\\boxed{\\frac{2}{b-a}}$$"
        },
        {
            "introduction": "这项高级实践旨在解决一个在发展可证明稳定的数值格式中的关键挑战：在离散层面模拟分部积分。我们将探究为何标准的分部求和（Summation-By-Parts, SBP）构造在切比雪夫-高斯节点（其不包含端点）上会失效，并接着构建一个广义的SBP算子。这项练习有助于深入理解高阶稳定数值方法所需的精密设计原则。",
            "id": "3369362",
            "problem": "考虑区间 $\\left[-1,1\\right]$ 以及由 $x_k=\\cos\\!\\left(\\frac{2k-1}{2N}\\pi\\right)$（$k=1,\\dots,N$）给出的切比雪夫-高斯节点（第一类切比雪夫多项式的零点）。与切比雪夫-高斯-洛巴托节点不同，切比雪夫-高斯节点不包含端点 $x=-1$ 和 $x=1$，这使得构造在 $\\left[-1,1\\right]$ 上模拟分部积分的分部求和（SBP）有限差分算子变得复杂。\n\n考虑 $N=3$ 的情况，此时节点为 $x_1=-s, x_2=0, x_3=s$，其中 $s=\\sqrt{3}/2$。设 $\\{\\ell_j(x)\\}_{j=1}^{3}$ 是与这些节点相关联的拉格朗日基多项式，并设节点微分矩阵 $\\mathbf{D}\\in\\mathbb{R}^{3\\times 3}$ 定义为 $\\mathbf{D}_{ij}=\\ell_j'(x_i)$，该矩阵能精确地对最高为2次的节点插值多项式进行微分。\n\n1. 从分部积分的基本原理出发，解释当在切比雪夫-高斯节点上进行离散化时，为什么端点的缺失会阻碍边界矩阵为 $\\mathbf{B}=\\mathbf{e}_3\\mathbf{e}_3^{\\top}-\\mathbf{e}_1\\mathbf{e}_1^{\\top}$ 的标准SBP恒等式的成立。你的解释必须基于以下要求：对于多项式数据，离散双线性形式 $u^{\\top}\\mathbf{H}\\mathbf{D}v+v^{\\top}\\mathbf{H}\\mathbf{D}u$ 应逼近连续边界通量 $u(1)v(1)-u(-1)v(-1)$，其中 $\\mathbf{H}$ 是一个对称正定对角范数矩阵。\n\n2. 不使用标准边界矩阵，而是使用专门的边界求值泛函来增强算子。通过对最高2次的多项式强制施加端点精确性来定义行向量 $\\mathbf{P}_L,\\mathbf{P}_R\\in\\mathbb{R}^{1\\times 3}$：\n   - $\\mathbf{P}_L\\mathbf{p} = p(-1)$，\n   - $\\mathbf{P}_R\\mathbf{p} = p(1)$，\n   对于任意最高次数为2的多项式 $p(x)$，其中 $\\mathbf{p}=[p(x_1),p(x_2),p(x_3)]^{\\top}$ 是节点采样值。证明这些条件意味着 $\\mathbf{P}_L=\\left[\\ell_1(-1),\\ell_2(-1),\\ell_3(-1)\\right]$ 和 $\\mathbf{P}_R=\\left[\\ell_1(1),\\ell_2(1),\\ell_3(1)\\right]$。\n\n3. 寻找一个对角范数矩阵 $\\mathbf{H}=\\mathrm{diag}(h_1,h_2,h_3)$（其中 $h_i0$），使得下面的广义SBP恒等式在最高2次的多项式子空间上精确成立：\n   $$\\mathbf{H}\\mathbf{D}+\\mathbf{D}^{\\top}\\mathbf{H}=\\mathbf{P}_R^{\\top}\\mathbf{P}_R-\\mathbf{P}_L^{\\top}\\mathbf{P}_L.$$\n   根据节点 $x_1=-s, x_2=0, x_3=s$（其中 $s=\\sqrt{3}/2$）显式地构造 $\\mathbf{D}$ 和 $\\mathbf{P}_L,\\mathbf{P}_R$，并求解对角元 $h_1,h_2,h_3$。\n\n以行矩阵的形式给出你的最终答案，使用精确值，无需四舍五入。",
            "solution": "该问题是有效的，因为它在数值分析领域有科学依据，是适定、客观的，并且包含足够的信息以获得唯一解。\n\n在区间 $\\left[\\,-1, 1\\,\\right]$ 上的连续分部积分公式表明，对于任意两个可微函数 $u(x)$ 和 $v(x)$，\n$$ \\int_{-1}^{1} u'(x)v(x) \\, dx = \\left[ u(x)v(x) \\right]_{-1}^{1} - \\int_{-1}^{1} u(x)v'(x) \\, dx. $$\n重新整理可得到乘积导数的恒等式：\n$$ \\int_{-1}^{1} \\left( u'(x)v(x) + u(x)v'(x) \\right) \\, dx = u(1)v(1) - u(-1)v(-1). $$\n分部求和（SBP）格式旨在寻找该恒等式的离散模拟。设 $\\mathbf{u}$ 和 $\\mathbf{v}$ 是在一组 $N$ 个节点 $\\{x_i\\}_{i=1}^N$ 上的函数值向量。一个数值微分矩阵 $\\mathbf{D}$ 逼近微分算子，一个对称正定的对角矩阵 $\\mathbf{H}$（范数矩阵或质量矩阵）定义了一个离散内积，它对应于区间上的一个求积法则。左边的离散模拟是 $\\mathbf{u}^{\\top}\\mathbf{H}(\\mathbf{D}\\mathbf{v}) + \\mathbf{v}^{\\top}\\mathbf{H}(\\mathbf{D}\\mathbf{u})$，可以写成 $\\mathbf{u}^{\\top}(\\mathbf{H}\\mathbf{D} + \\mathbf{D}^{\\top}\\mathbf{H})\\mathbf{v}$。SBP性质要求这个量精确等于右边边界项的离散表示。因此，标准的SBP恒等式为 $\\mathbf{H}\\mathbf{D} + \\mathbf{D}^{\\top}\\mathbf{H} = \\mathbf{B}$，其中 $\\mathbf{B}$ 是边界矩阵。\n为了使该恒等式成为连续形式的直接模拟，矩阵 $\\mathbf{B}$ 必须表示在边界 $x=-1$ 和 $x=1$ 上对函数的求值。如果节点是切比雪夫-高斯-洛巴托类型，端点被包含在节点集中，例如 $x_1=-1$ 和 $x_N=1$。在这种情况下，函数值 $u(-1)$ 和 $u(1)$ 就是向量 $\\mathbf{u}$ 的第一个和最后一个分量，即 $u(-1)=u_1$ 和 $u(1)=u_N$。边界项 $u(1)v(1) - u(-1)v(-1)$ 可以被写作 $u_N v_N - u_1 v_1 = \\mathbf{u}^{\\top}(\\mathbf{e}_N\\mathbf{e}_N^{\\top} - \\mathbf{e}_1\\mathbf{e}_1^{\\top})\\mathbf{v}$。边界矩阵就是简单的 $\\mathbf{B} = \\mathbf{e}_N\\mathbf{e}_N^{\\top} - \\mathbf{e}_1\\mathbf{e}_1^{\\top}$。\n问题指出节点是切比雪夫-高斯类型，对于 $N=3$ 的情况，节点为 $x_1 = -\\sqrt{3}/2$, $x_2=0$ 和 $x_3=\\sqrt{3}/2$。关键的是，这些节点严格位于区间 $\\left[\\,-1, 1\\,\\right]$ 内部，不包含端点 $x=-1$ 和 $x=1$。这意味着值 $u(-1)$ 和 $u(1)$ 不存在于节点向量 $\\mathbf{u} = [u(x_1), u(x_2), u(x_3)]^{\\top}$ 中。形式为 $\\mathbf{B}=\\mathbf{e}_3\\mathbf{e}_3^{\\top}-\\mathbf{e}_1\\mathbf{e}_1^{\\top}$ 的矩阵将表示边界项 $u(x_3)v(x_3) - u(x_1)v(x_1)$，即 $u(\\sqrt{3}/2)v(\\sqrt{3}/2) - u(-\\sqrt{3}/2)v(-\\sqrt{3}/2)$。这显然不是正确的边界项 $u(1)v(1) - u(-1)v(-1)$。因此，使用标准基向量构建的简单边界矩阵的标准SBP构造方法会失败，因为函数的节点表示不包含其在定义域边界上的值的直接信息。\n\n为了解决这个问题，我们必须定义将函数值从内部节点外插到边界的算子。设 $p(x)$ 是任意一个最高次数为2的多项式。我们可以使用与节点 $\\{x_j\\}_{j=1}^3$ 相关联的拉格朗日基多项式 $\\{\\ell_j(x)\\}_{j=1}^3$ 唯一地表示 $p(x)$：\n$$ p(x) = \\sum_{j=1}^{3} p(x_j) \\ell_j(x). $$\n节点采样值的向量是 $\\mathbf{p} = [p(x_1), p(x_2), p(x_3)]^{\\top}$。边界求值泛函 $\\mathbf{P}_L$ 和 $\\mathbf{P}_R$ 由条件 $\\mathbf{P}_L \\mathbf{p} = p(-1)$ 和 $\\mathbf{P}_R \\mathbf{p} = p(1)$ 定义。将 $p(x)$ 的拉格朗日表示在 $x=-1$ 处求值得到\n$$ p(-1) = \\sum_{j=1}^{3} p(x_j) \\ell_j(-1) = \\begin{pmatrix} \\ell_1(-1)  \\ell_2(-1)  \\ell_3(-1) \\end{pmatrix} \\begin{pmatrix} p(x_1) \\\\ p(x_2) \\\\ p(x_3) \\end{pmatrix}. $$\n因为这对于任意最高次数为2的多项式 $p(x)$（因此对于任意向量 $\\mathbf{p}$）的选择都必须成立，所以行向量泛函 $\\mathbf{P}_L$ 必须由 $\\mathbf{P}_L = \\left[ \\ell_1(-1), \\ell_2(-1), \\ell_3(-1) \\right]$ 给出。通过同样的推理，在 $x=1$ 处求值得到\n$$ p(1) = \\sum_{j=1}^{3} p(x_j) \\ell_j(1), $$\n这意味着 $\\mathbf{P}_R = \\left[ \\ell_1(1), \\ell_2(1), \\ell_3(1) \\right]$。这些算子将最高次数为2的多项式的节点值映射到其在端点处的精确值。广义SBP恒等式 $\\mathbf{H}\\mathbf{D}+\\mathbf{D}^{\\top}\\mathbf{H}=\\mathbf{P}_R^{\\top}\\mathbf{P}_R-\\mathbf{P}_L^{\\top}\\mathbf{P}_L$ 正确地将边界项表示为 $(\\mathbf{P}_R \\mathbf{u})(\\mathbf{P}_R \\mathbf{v}) - (\\mathbf{P}_L \\mathbf{u})(\\mathbf{P}_L \\mathbf{v}) \\approx u(1)v(1) - u(-1)v(-1)$。\n\n我们现在为 $N=3$ 构造矩阵。节点为 $x_1=-s$, $x_2=0$, $x_3=s$，其中 $s=\\sqrt{3}/2$，所以 $s^2=3/4$。\n拉格朗日基多项式为：\n$$ \\ell_1(x) = \\frac{x(x-s)}{(-s)(-2s)} = \\frac{x^2-sx}{2s^2} = \\frac{2}{3}(x^2-sx) $$\n$$ \\ell_2(x) = \\frac{(x+s)(x-s)}{(s)(-s)} = \\frac{x^2-s^2}{-s^2} = 1-\\frac{x^2}{s^2} = 1-\\frac{4}{3}x^2 $$\n$$ \\ell_3(x) = \\frac{x(x+s)}{(2s)(s)} = \\frac{x^2+sx}{2s^2} = \\frac{2}{3}(x^2+sx) $$\n它们的导数为：\n$$ \\ell_1'(x) = \\frac{2}{3}(2x-s), \\quad \\ell_2'(x) = -\\frac{8}{3}x, \\quad \\ell_3'(x) = \\frac{2}{3}(2x+s). $$\n微分矩阵 $\\mathbf{D}$ 的元素为 $\\mathbf{D}_{ij} = \\ell_j'(x_i)$。\n对于 $i=1$, $x_1=-s$: $\\mathbf{D}_{11} = -2s$, $\\mathbf{D}_{12} = \\frac{8s}{3}$, $\\mathbf{D}_{13} = -\\frac{2s}{3}$。\n对于 $i=2$, $x_2=0$: $\\mathbf{D}_{21} = -\\frac{2s}{3}$, $\\mathbf{D}_{22} = 0$, $\\mathbf{D}_{23} = \\frac{2s}{3}$。\n对于 $i=3$, $x_3=s$: $\\mathbf{D}_{31} = \\frac{2s}{3}$, $\\mathbf{D}_{32} = -\\frac{8s}{3}$, $\\mathbf{D}_{33} = 2s$。\n代入 $s=\\sqrt{3}/2$：\n$$ \\mathbf{D} = \\begin{pmatrix} -\\sqrt{3}  \\frac{4\\sqrt{3}}{3}  -\\frac{\\sqrt{3}}{3} \\\\ -\\frac{\\sqrt{3}}{3}  0  \\frac{\\sqrt{3}}{3} \\\\ \\frac{\\sqrt{3}}{3}  -\\frac{4\\sqrt{3}}{3}  \\sqrt{3} \\end{pmatrix} = \\frac{\\sqrt{3}}{3} \\begin{pmatrix} -3  4  -1 \\\\ -1  0  1 \\\\ 1  -4  3 \\end{pmatrix}. $$\n通过在 $x=-1$ 和 $x=1$ 处对拉格朗日多项式求值来找到边界算子：\n$$ \\mathbf{P}_L = \\begin{pmatrix} \\ell_1(-1)  \\ell_2(-1)  \\ell_3(-1) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}(1+s)  -\\frac{1}{3}  \\frac{2}{3}(1-s) \\end{pmatrix} $$\n$$ \\mathbf{P}_R = \\begin{pmatrix} \\ell_1(1)  \\ell_2(1)  \\ell_3(1) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}(1-s)  -\\frac{1}{3}  \\frac{2}{3}(1+s) \\end{pmatrix} $$\n边界矩阵为 $\\mathbf{B} = \\mathbf{P}_R^{\\top}\\mathbf{P}_R - \\mathbf{P}_L^{\\top}\\mathbf{P}_L$。令 $a = \\frac{2}{3}(1-s)$, $b = -\\frac{1}{3}$, $c = \\frac{2}{3}(1+s)$。那么 $\\mathbf{P}_R = [a,b,c]$ 且 $\\mathbf{P}_L = [c,b,a]$。\n$$ \\mathbf{B} = \\begin{pmatrix} a^2-c^2  ab-bc  0 \\\\ ab-bc  0  bc-ab \\\\ 0  bc-ab  c^2-a^2 \\end{pmatrix} = \\begin{pmatrix} (a-c)(a+c)  b(a-c)  0 \\\\ b(a-c)  0  -b(a-c) \\\\ 0  -b(a-c)  -(a-c)(a+c) \\end{pmatrix} $$\n我们计算 $a-c = \\frac{2}{3}(1-s) - \\frac{2}{3}(1+s) = -\\frac{4s}{3}$ 和 $a+c = \\frac{4}{3}$。\n因此，$a^2-c^2 = (-\\frac{4s}{3})(\\frac{4}{3}) = -\\frac{16s}{9}$ 且 $b(a-c) = (-\\frac{1}{3})(-\\frac{4s}{3}) = \\frac{4s}{9}$。\n$$ \\mathbf{B} = \\frac{4s}{9} \\begin{pmatrix} -4  1  0 \\\\ 1  0  -1 \\\\ 0  -1  4 \\end{pmatrix} = \\frac{4(\\sqrt{3}/2)}{9} \\begin{pmatrix} -4  1  0 \\\\ 1  0  -1 \\\\ 0  -1  4 \\end{pmatrix} = \\frac{2\\sqrt{3}}{9} \\begin{pmatrix} -4  1  0 \\\\ 1  0  -1 \\\\ 0  -1  4 \\end{pmatrix}. $$\n我们寻找 $\\mathbf{H} = \\mathrm{diag}(h_1, h_2, h_3)$。根据节点的对称性，$h_1=h_3$。\n$\\mathbf{H}\\mathbf{D}+\\mathbf{D}^{\\top}\\mathbf{H}$ 项变为：\n$$ \\mathbf{H}\\mathbf{D}+\\mathbf{D}^{\\top}\\mathbf{H} = \\frac{\\sqrt{3}}{3} \\begin{pmatrix} -6h_1  4h_1-h_2  0 \\\\ 4h_1-h_2  0  h_2-4h_1 \\\\ 0  h_2-4h_1  6h_1 \\end{pmatrix}. $$\n将此与 $\\mathbf{B}$ 等同：\n$$ \\frac{\\sqrt{3}}{3} \\begin{pmatrix} -6h_1  4h_1-h_2  0 \\\\ 4h_1-h_2  0  h_2-4h_1 \\\\ 0  h_2-4h_1  6h_1 \\end{pmatrix} = \\frac{2\\sqrt{3}}{9} \\begin{pmatrix} -4  1  0 \\\\ 1  0  -1 \\\\ 0  -1  4 \\end{pmatrix}. $$\n两边同乘 $3/\\sqrt{3}$ 得到：\n$$ \\begin{pmatrix} -6h_1  4h_1-h_2  0 \\\\ \\dots  \\dots  \\dots \\\\ \\dots  \\dots  6h_1 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -4  1  0 \\\\ \\dots  \\dots  \\dots \\\\ \\dots  \\dots  4 \\end{pmatrix}. $$\n比较 $(1,1)$ 元素：$-6h_1 = \\frac{2}{3}(-4) = -\\frac{8}{3}$，这得出 $h_1 = \\frac{8}{18} = \\frac{4}{9}$。\n$(3,3)$ 元素给出 $6h_1 = \\frac{2}{3}(4) = \\frac{8}{3}$，这得到相同的 $h_1 = \\frac{4}{9}$。\n比较 $(1,2)$ 元素：$4h_1 - h_2 = \\frac{2}{3}(1) = \\frac{2}{3}$。\n代入 $h_1=\\frac{4}{9}$：$4(\\frac{4}{9}) - h_2 = \\frac{2}{3} \\implies \\frac{16}{9} - h_2 = \\frac{6}{9}$。\n这得出 $h_2 = \\frac{16}{9} - \\frac{6}{9} = \\frac{10}{9}$。\n范数矩阵的对角元素是 $h_1 = \\frac{4}{9}$, $h_2 = \\frac{10}{9}$ 和 $h_3 = h_1 = \\frac{4}{9}$。这些值都是正的，符合范数矩阵的要求。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{9}  \\frac{10}{9}  \\frac{4}{9} \\end{pmatrix}}$$"
        }
    ]
}