{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete application of the famous 'three-halves rule' for de-aliasing quadratic nonlinearities in Fourier pseudospectral methods. By working through the calculation analytically, you will see precisely how padding in spectral space creates a finer physical grid where the nonlinear product can be computed without ambiguity. This practice solidifies the connection between discrete convolution, aliasing, and the truncation process that isolates the correctly computed low-frequency modes. ",
            "id": "3363423",
            "problem": "Consider a periodic function $u(x)$ defined on $[0,2\\pi]$ and sampled at $N=16$ equispaced points, with $x_{j} = \\frac{2\\pi j}{N}$ for $j=0,1,\\dots, N-1$. In the pseudospectral approach, nonlinear products are computed by transforming to physical space, multiplying pointwise, and transforming back to Fourier space. Aliasing arises due to the discrete convolution of Fourier modes folding high-frequency content back into the resolved band. A standard way to avoid aliasing for quadratic nonlinearities is the \"three-halves padding\" method: zero-pad the spectral representation to $M = \\frac{3}{2}N$ modes, transform to $M$ physical points, multiply pointwise, transform back to spectral space, and then project onto the original $N$-mode subspace by discarding modes outside the original resolved band.\n\nLet $u(x) = \\sin(3x) + \\sin(5x)$. Using the de-aliased pseudospectral evaluation with three-halves padding, compute the analytic expression of the de-aliased product $u^{2}(x)$ after projecting back onto the original $N=16$-mode subspace. Express your final result as a single simplified trigonometric expression in $x$. No numerical rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of spectral methods, well-posed, and objective. There are no contradictions or missing information. The described procedure, three-halves padding for de-aliasing a quadratic nonlinearity, is a standard technique in computational physics and engineering. We may therefore proceed with the solution.\n\nThe problem asks for the de-aliased expression for the product $u^2(x)$ where $u(x) = \\sin(3x) + \\sin(5x)$, using a pseudospectral method with three-halves padding on a grid with $N=16$ points.\n\nFirst, we determine the exact analytical expression for the product $u^2(x)$. This represents the result of the physical-space multiplication step before any truncation or aliasing effects are considered.\n$$u^2(x) = (\\sin(3x) + \\sin(5x))^2$$\n$$u^2(x) = \\sin^2(3x) + \\sin^2(5x) + 2\\sin(3x)\\sin(5x)$$\nWe use the following trigonometric identities to simplify this expression:\n1. Power-reduction formula: $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$\n2. Product-to-sum formula: $2\\sin(A)\\sin(B) = \\cos(A-B) - \\cos(A+B)$\n\nApplying these identities, we get:\n$$\\sin^2(3x) = \\frac{1 - \\cos(2 \\cdot 3x)}{2} = \\frac{1}{2} - \\frac{1}{2}\\cos(6x)$$\n$$\\sin^2(5x) = \\frac{1 - \\cos(2 \\cdot 5x)}{2} = \\frac{1}{2} - \\frac{1}{2}\\cos(10x)$$\n$$2\\sin(3x)\\sin(5x) = \\cos(5x - 3x) - \\cos(5x + 3x) = \\cos(2x) - \\cos(8x)$$\n\nSubstituting these back into the expression for $u^2(x)$:\n$$u^2(x) = \\left(\\frac{1}{2} - \\frac{1}{2}\\cos(6x)\\right) + \\left(\\frac{1}{2} - \\frac{1}{2}\\cos(10x)\\right) + (\\cos(2x) - \\cos(8x))$$\nCombining terms, the exact product is:\n$$u^2(x) = 1 + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x) - \\frac{1}{2}\\cos(10x)$$\nThis expression reveals that the true product contains Fourier modes corresponding to wavenumbers $k \\in \\{0, 2, 6, 8, 10\\}$.\n\nNext, we analyze the de-aliasing procedure. The calculation is performed on a discrete grid of $N=16$ points. The initial function $u(x)$ contains modes with wavenumbers $k=3$ and $k=5$. The Nyquist wavenumber for the original grid is $k_{Ny,N} = N/2 = 16/2 = 8$. Since the wavenumbers in $u(x)$ are less than $k_{Ny,N}$, the function is well-resolved on the initial grid.\n\nThe de-aliasing procedure involves padding the spectral representation to $M = \\frac{3}{2}N = \\frac{3}{2}(16) = 24$ modes. The nonlinear product is then computed in physical space on a finer grid of $M=24$ points. The Nyquist wavenumber for this padded grid is $k_{Ny,M} = M/2 = 24/2 = 12$.\n\nFor a quadratic product to be computed without aliasing on this padded grid, the highest wavenumber present in the exact product must be less than the padded Nyquist wavenumber $k_{Ny,M}$. The highest wavenumber in our exact product $u^2(x)$ is $k_{max}=10$.\nSince $k_{max} = 10  k_{Ny,M} = 12$, the pointwise product on the $M=24$ point grid will not suffer from aliasing. Transforming this product back to the padded spectral space yields the exact Fourier coefficients of the true product $u^2(x)$.\n\nThe final step is to project the result onto the original $N=16$-mode subspace. This means we must discard all modes that are not representable on the original grid. For a real-valued function on $N=16$ points, the basis functions for the discrete Fourier representation are typically chosen as $\\{\\cos(kx) \\mid k=0, 1, \\dots, N/2\\}$ and $\\{\\sin(kx) \\mid k=1, 2, \\dots, N/2-1\\}$.\nFor $N=16$, the resolved cosine wavenumbers are $k \\in \\{0, 1, 2, 3, 4, 5, 6, 7, 8\\}$. The product $u^2(x)$ only contains cosine terms.\n\nWe examine the wavenumbers of the terms in the exact product:\n$u^2(x) = 1\\cdot\\cos(0x) + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x) - \\frac{1}{2}\\cos(10x)$\n- The constant term $1$ corresponds to $k=0$. This is in the resolved band ($0 \\le 8$).\n- The term $\\cos(2x)$ has $k=2$. This is in the resolved band ($2 \\le 8$).\n- The term $-\\frac{1}{2}\\cos(6x)$ has $k=6$. This is in the resolved band ($6 \\le 8$).\n- The term $-\\cos(8x)$ has $k=8$. This is the Nyquist wavenumber of the original grid, which is included in the cosine basis. It is in the resolved band ($8 \\le 8$).\n- The term $-\\frac{1}{2}\\cos(10x)$ has $k=10$. This wavenumber is outside the resolved band ($10 > 8$).\n\nThe projection operation discards the mode with $k=10$. Therefore, the de-aliased product, after projection back to the original $N=16$-mode subspace, is given by the sum of the terms with resolved wavenumbers.\n\nThe resulting expression is:\n$$u^2_{\\text{de-aliased}}(x) = 1 + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x)$$\nThis is the final analytical expression for the de-aliased product.",
            "answer": "$$\\boxed{1 + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x)}$$"
        },
        {
            "introduction": "Moving from Fourier to polynomial bases, this practice explores how aliasing manifests in methods like the Spectral Element or Discontinuous Galerkin methods. Here, aliasing is not a consequence of discrete Fourier transforms but of using numerical quadrature rules that are inexact for the degree of the nonlinear product. This exercise will make the abstract concept of aliasing error tangible by having you calculate the squared $L^2$ norm of the error, comparing the exact projection with the collocation-based (aliased) result. ",
            "id": "3363449",
            "problem": "Consider a one-dimensional reference element with coordinate $x \\in [-1,1]$ and the polynomial space $\\mathbb{P}_p$ of degree at most $p$ represented in a modal Legendre basis $\\{P_n(x)\\}_{n=0}^{p}$, where $P_n(x)$ denotes the degree-$n$ Legendre polynomial. Legendre polynomials are orthogonal on $[-1,1]$ with respect to the weight $1$, satisfying $\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}$ for nonnegative integers $m$ and $n$. In a spectral or Discontinuous Galerkin (DG) discretization, nonlinear terms such as $u^2$ can be represented either by exact $L^2$ projection into $\\mathbb{P}_p$ or by the collocation-based nodal product followed by interpolation from nodal values back into $\\mathbb{P}_p$. The latter introduces aliasing when the nonlinear product increases polynomial degree beyond $p$. Use the following specific setting to analyze and quantify aliasing error:\n\n- Take polynomial degree $p=2$ and the modal Legendre basis $\\{P_0(x),P_1(x),P_2(x)\\}$, where $P_0(x)=1$, $P_1(x)=x$, and $P_2(x)=\\frac{3x^2-1}{2}$.\n- Let $u(x) = P_0(x) + P_1(x) + P_2(x)$.\n- Define the exact $L^2$ projection $\\Pi_{\\mathbb{P}_2}(u^2)$ to be the unique polynomial in $\\mathbb{P}_2$ whose modal coefficients $\\{c_n\\}_{n=0}^{2}$ satisfy $c_n = \\frac{2n+1}{2} \\int_{-1}^{1} u(x)^2 P_n(x) \\,\\mathrm{d}x$.\n- Define the collocation-based product on the Legendre-Gauss-Lobatto (LGL) nodes for $p=2$, which are $x \\in \\{-1,0,1\\}$. Compute the nodal values $v_i = u(x_i)^2$ for $x_i \\in \\{-1,0,1\\}$, and let $w(x) \\in \\mathbb{P}_2$ be the unique degree-$2$ interpolating polynomial satisfying $w(x_i) = v_i$ for $x_i \\in \\{-1,0,1\\}$.\n- Quantify the aliasing error as the squared $L^2$ norm of the difference between the exact projection and the collocation-based polynomial, defined by\n$$E = \\int_{-1}^{1} \\big(\\Pi_{\\mathbb{P}_2}(u^2)(x) - w(x)\\big)^2 \\,\\mathrm{d}x.$$\n\nDerive all required intermediate expressions from the fundamental definitions above. Express your final answer for $E$ as an exact fraction. Do not round.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in numerical analysis for quantifying aliasing error in spectral methods. All definitions and data are provided and are consistent with established theory. Therefore, the problem is valid, and a solution will be derived.\n\nThe solution proceeds in four steps:\n1.  First, we determine the explicit polynomial form of $u(x)$ and $u(x)^2$.\n2.  Second, we compute the exact $L^2$ projection of $u(x)^2$ onto the polynomial space $\\mathbb{P}_2$, which we denote as $\\Pi_{\\mathbb{P}_2}(u^2)(x)$.\n3.  Third, we compute the interpolating polynomial $w(x) \\in \\mathbb{P}_2$ that collocates $u(x)^2$ at the specified Legendre-Gauss-Lobatto (LGL) nodes.\n4.  Finally, we compute the squared $L^2$ norm of the difference between these two polynomials to find the aliasing error $E$.\n\nStep 1: Express $u(x)$ and $u(x)^2$.\nThe function $u(x)$ is given in the Legendre basis as $u(x) = P_0(x) + P_1(x) + P_2(x)$. Substituting the definitions $P_0(x)=1$, $P_1(x)=x$, and $P_2(x) = \\frac{3x^2-1}{2}$, we obtain:\n$$u(x) = 1 + x + \\frac{3x^2-1}{2} = \\frac{3}{2}x^2 + x + \\frac{1}{2}$$\nSquaring this expression gives the nonlinear term $u(x)^2$:\n$$u(x)^2 = \\left(\\frac{3}{2}x^2 + x + \\frac{1}{2}\\right)^2 = \\frac{9}{4}x^4 + x^2 + \\frac{1}{4} + 2\\left(\\frac{3}{2}x^3\\right) + 2\\left(\\frac{3}{4}x^2\\right) + 2\\left(\\frac{1}{2}x\\right)$$\n$$u(x)^2 = \\frac{9}{4}x^4 + 3x^3 + \\left(1 + \\frac{3}{2}\\right)x^2 + x + \\frac{1}{4} = \\frac{9}{4}x^4 + 3x^3 + \\frac{5}{2}x^2 + x + \\frac{1}{4}$$\nThis is a polynomial of degree $4$.\n\nStep 2: Compute the exact $L^2$ projection $\\Pi_{\\mathbb{P}_2}(u^2)$.\nThe exact projection $\\Pi_{\\mathbb{P}_2}(u^2)$ is the component of $u(x)^2$ that lies in the space $\\mathbb{P}_2$ spanned by $\\{P_0(x), P_1(x), P_2(x)\\}$. We can find this by expressing $u(x)^2$ in the Legendre basis and truncating terms of degree higher than $2$. We use the standard identities: $1=P_0(x)$, $x=P_1(x)$, $x^2 = \\frac{1}{3}P_0(x) + \\frac{2}{3}P_2(x)$, $x^3 = \\frac{3}{5}P_1(x) + \\frac{2}{5}P_3(x)$, and $x^4 = \\frac{1}{5}P_0(x) + \\frac{4}{7}P_2(x) + \\frac{8}{35}P_4(x)$.\nSubstituting these into the expression for $u(x)^2$:\n$$u(x)^2 = \\frac{9}{4}\\left(\\frac{1}{5}P_0 + \\frac{4}{7}P_2 + \\frac{8}{35}P_4\\right) + 3\\left(\\frac{3}{5}P_1 + \\frac{2}{5}P_3\\right) + \\frac{5}{2}\\left(\\frac{1}{3}P_0 + \\frac{2}{3}P_2\\right) + P_1 + \\frac{1}{4}P_0$$\nCollecting coefficients for each Legendre polynomial:\n- $P_0$ term: $(\\frac{9}{20} + \\frac{5}{6} + \\frac{1}{4})P_0 = (\\frac{27+50+15}{60})P_0 = \\frac{92}{60}P_0 = \\frac{23}{15}P_0$\n- $P_1$ term: $(\\frac{9}{5} + 1)P_1 = \\frac{14}{5}P_1$\n- $P_2$ term: $(\\frac{9}{7} + \\frac{5}{3})P_2 = (\\frac{27+35}{21})P_2 = \\frac{62}{21}P_2$\n- $P_3$ term: $\\frac{6}{5}P_3$\n- $P_4$ term: $\\frac{18}{35}P_4$\nThe exact $L^2$ projection is obtained by keeping only the terms in $\\mathbb{P}_2$:\n$$\\Pi_{\\mathbb{P}_2}(u^2)(x) = \\frac{23}{15}P_0(x) + \\frac{14}{5}P_1(x) + \\frac{62}{21}P_2(x)$$\n\nStep 3: Compute the collocation-based polynomial $w(x)$.\nThe LGL nodes for $p=2$ are $x_0=-1$, $x_1=0$, and $x_2=1$. We first evaluate $u(x)$ at these nodes:\n- $u(x_0) = u(-1) = \\frac{3}{2}(-1)^2 + (-1) + \\frac{1}{2} = \\frac{3}{2} - 1 + \\frac{1}{2} = 1$\n- $u(x_1) = u(0) = \\frac{3}{2}(0)^2 + (0) + \\frac{1}{2} = \\frac{1}{2}$\n- $u(x_2) = u(1) = \\frac{3}{2}(1)^2 + (1) + \\frac{1}{2} = \\frac{3}{2} + 1 + \\frac{1}{2} = 3$\nThe nodal values for the collocation are $v_i = u(x_i)^2$:\n- $v_0 = u(-1)^2 = 1^2 = 1$\n- $v_1 = u(0)^2 = (\\frac{1}{2})^2 = \\frac{1}{4}$\n- $v_2 = u(1)^2 = 3^2 = 9$\nWe seek the unique polynomial $w(x) = ax^2 + bx + c$ that interpolates these values:\n- $w(0) = c = \\frac{1}{4}$\n- $w(1) = a + b + c = 9 \\implies a+b = 9 - \\frac{1}{4} = \\frac{35}{4}$\n- $w(-1) = a - b + c = 1 \\implies a-b = 1 - \\frac{1}{4} = \\frac{3}{4}$\nAdding the last two equations gives $2a = \\frac{35}{4} + \\frac{3}{4} = \\frac{38}{4} = \\frac{19}{2}$, so $a = \\frac{19}{4}$.\nSubtracting the third from the second gives $2b = \\frac{35}{4} - \\frac{3}{4} = \\frac{32}{4} = 8$, so $b=4$.\nThus, the interpolating polynomial is $w(x) = \\frac{19}{4}x^2 + 4x + \\frac{1}{4}$.\nTo facilitate comparison, we express $w(x)$ in the Legendre basis:\n$$w(x) = \\frac{19}{4}\\left(\\frac{1}{3}P_0 + \\frac{2}{3}P_2\\right) + 4P_1 + \\frac{1}{4}P_0 = \\left(\\frac{19}{12} + \\frac{1}{4}\\right)P_0 + 4P_1 + \\frac{19}{6}P_2$$\n$$w(x) = \\left(\\frac{19+3}{12}\\right)P_0 + 4P_1 + \\frac{19}{6}P_2 = \\frac{22}{12}P_0 + 4P_1 + \\frac{19}{6}P_2 = \\frac{11}{6}P_0(x) + 4P_1(x) + \\frac{19}{6}P_2(x)$$\n\nStep 4: Compute the aliasing error $E$.\nThe aliasing error is the squared $L^2$ norm of the difference polynomial $\\Delta(x) = \\Pi_{\\mathbb{P}_2}(u^2)(x) - w(x)$.\n$$\\Delta(x) = \\left(\\frac{23}{15} - \\frac{11}{6}\\right)P_0(x) + \\left(\\frac{14}{5} - 4\\right)P_1(x) + \\left(\\frac{62}{21} - \\frac{19}{6}\\right)P_2(x)$$\nThe coefficients of the difference are:\n- $P_0$ coefficient: $\\frac{23 \\cdot 2 - 11 \\cdot 5}{30} = \\frac{46-55}{30} = -\\frac{9}{30} = -\\frac{3}{10}$\n- $P_1$ coefficient: $\\frac{14 - 20}{5} = -\\frac{6}{5}$\n- $P_2$ coefficient: $\\frac{62 \\cdot 2 - 19 \\cdot 7}{42} = \\frac{124 - 133}{42} = -\\frac{9}{42} = -\\frac{3}{14}$\nSo, the difference polynomial is $\\Delta(x) = -\\frac{3}{10}P_0(x) - \\frac{6}{5}P_1(x) - \\frac{3}{14}P_2(x)$.\nThe error $E$ is the integral of $\\Delta(x)^2$. Due to the orthogonality of Legendre polynomials, $\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = 0$ for $m \\neq n$.\n$$E = \\int_{-1}^{1} \\left( -\\frac{3}{10}P_0(x) - \\frac{6}{5}P_1(x) - \\frac{3}{14}P_2(x) \\right)^2 \\,\\mathrm{d}x$$\n$$E = \\left(-\\frac{3}{10}\\right)^2 \\int_{-1}^{1} P_0(x)^2 \\,\\mathrm{d}x + \\left(-\\frac{6}{5}\\right)^2 \\int_{-1}^{1} P_1(x)^2 \\,\\mathrm{d}x + \\left(-\\frac{3}{14}\\right)^2 \\int_{-1}^{1} P_2(x)^2 \\,\\mathrm{d}x$$\nUsing the orthogonality relation $\\int_{-1}^{1} P_n(x)^2 \\,\\mathrm{d}x = \\frac{2}{2n+1}$:\n- $\\int_{-1}^{1} P_0(x)^2 \\,\\mathrm{d}x = \\frac{2}{1} = 2$\n- $\\int_{-1}^{1} P_1(x)^2 \\,\\mathrm{d}x = \\frac{2}{3}$\n- $\\int_{-1}^{1} P_2(x)^2 \\,\\mathrm{d}x = \\frac{2}{5}$\nSubstituting these values into the expression for $E$:\n$$E = \\frac{9}{100}(2) + \\frac{36}{25}\\left(\\frac{2}{3}\\right) + \\frac{9}{196}\\left(\\frac{2}{5}\\right)$$\n$$E = \\frac{18}{100} + \\frac{24}{25} + \\frac{18}{980} = \\frac{9}{50} + \\frac{24}{25} + \\frac{9}{490}$$\nTo sum these fractions, we find a common denominator.\n$$E = \\frac{9}{50} + \\frac{48}{50} + \\frac{9}{490} = \\frac{57}{50} + \\frac{9}{490}$$\nThe least common multiple of $50 = 2 \\cdot 5^2$ and $490 = 2 \\cdot 5 \\cdot 7^2$ is $2 \\cdot 5^2 \\cdot 7^2 = 2450$.\n$$E = \\frac{57 \\cdot 49}{2450} + \\frac{9 \\cdot 5}{2450} = \\frac{2793}{2450} + \\frac{45}{2450} = \\frac{2793+45}{2450} = \\frac{2838}{2450}$$\nSimplifying the fraction by dividing the numerator and denominator by their greatest common divisor, which is $2$:\n$$E = \\frac{1419}{1225}$$\nThe numerator $1419 = 3 \\cdot 473$ and the denominator $1225=5^2 \\cdot 7^2$. There are no common factors, so the fraction is in its simplest form.",
            "answer": "$$\\boxed{\\frac{1419}{1225}}$$"
        },
        {
            "introduction": "Building on our understanding of quadrature-induced aliasing, this final practice addresses a critical implementation choice in modern spectral codes. We will computationally compare two pathways for evaluating a nonlinear term: a fast 'nodal' pathway using pointwise products on collocation points, and an exact 'modal' pathway based on convolution. This coding exercise demonstrates why the nodal approach, while efficient, introduces aliasing error, and it confirms that the modal convolution approach, when done with sufficient quadrature, is exact, serving as a 'gold standard' for comparison. ",
            "id": "3363437",
            "problem": "Consider the Spectral Element Method (SEM) on the reference one-dimensional element with domain $[-1,1]$. Let $\\{P_n(x)\\}_{n=0}^{\\infty}$ denote the Legendre polynomial basis on $[-1,1]$ with the standard $L^2$ inner product. For a given polynomial degree $N \\in \\mathbb{N}$, define a modal function\n$$\nu(x) = \\sum_{n=0}^{N} a_n P_n(x), \\quad \\text{with} \\quad a_n = \\frac{1}{n+1}.\n$$\nThe nonlinear quantity of interest is the square $u^2(x)$. We compare two computational pathways for obtaining a degree-$N$ approximation of $u^2(x)$ in the Legendre modal space:\n- Nodal pathway: compute the pointwise product $u^2(x)$ on Gauss-Lobatto-Legendre (GLL) nodes of order $N$ (that is, $N+1$ nodes that include the endpoints), and then project onto the modal space $\\text{span}\\{P_0,\\dots,P_N\\}$ using GLL quadrature weights.\n- Modal convolution with truncation pathway: compute the modal coefficients of $u^2(x)$ by evaluating exact inner products in the Legendre basis (equivalently, via the Gaunt triple-product coefficients $\\int_{-1}^{1} P_n(x) P_m(x) P_k(x)\\,\\mathrm{d}x$) and then truncate to retain modes $k \\le N$.\n\nThe foundational bases you must use are:\n- Orthogonality of the Legendre polynomials,\n$$\n\\int_{-1}^{1} P_k(x) P_\\ell(x)\\,\\mathrm{d}x = \\begin{cases}\n\\frac{2}{2k+1},  k=\\ell,\\\\\n0,  k\\ne \\ell,\n\\end{cases}\n$$\n- Exactness degree of Gauss-Lobatto-Legendre (GLL) quadrature with $N+1$ nodes for polynomials up to degree $2N-1$, and exactness degree of Gauss-Legendre (GL) quadrature with $M$ nodes for polynomials up to degree $2M-1$.\n\nDefine the $L^2$ modal projection coefficient for $u^2$ onto $P_k$ as\n$$\nc_k^{\\star} = \\frac{\\int_{-1}^{1} u^2(x) P_k(x)\\,\\mathrm{d}x}{\\int_{-1}^{1} P_k^2(x)\\,\\mathrm{d}x} = \\frac{2k+1}{2}\\int_{-1}^{1} u^2(x) P_k(x)\\,\\mathrm{d}x, \\quad 0\\le k\\le N,\n$$\nwhich represents the exact degree-$N$ $L^2$ projection coefficients of $u^2(x)$.\n\nThe nodal pathway approximation to these coefficients, $c_k^{\\text{nod}}$, is obtained by:\n1. Evaluating $u(x)$ at the $N+1$ GLL nodes $\\{x_q\\}_{q=0}^{N}$ and weights $\\{w_q\\}_{q=0}^{N}$,\n2. Forming the pointwise square $u^2(x_q)$,\n3. Computing\n$$\nc_k^{\\text{nod}} = \\frac{\\sum_{q=0}^{N} w_q\\,u^2(x_q)\\,P_k(x_q)}{\\int_{-1}^{1} P_k^2(x)\\,\\mathrm{d}x} = \\frac{2k+1}{2}\\sum_{q=0}^{N} w_q\\,u^2(x_q)\\,P_k(x_q).\n$$\n\nThe modal convolution with truncation approximation, $c_k^{\\text{conv}}$, is computed by evaluating the inner product\n$$\nc_k^{\\text{conv}} = \\frac{\\int_{-1}^{1} u^2(x) P_k(x)\\,\\mathrm{d}x}{\\int_{-1}^{1} P_k^2(x)\\,\\mathrm{d}x},\n$$\nusing a sufficiently high-order Gauss-Legendre quadrature with $M$ nodes chosen so that the integrals of polynomials up to degree $3N$ are exact. The resulting coefficients are then truncated to modes $k \\le N$.\n\nDefine the aliasing error as the $L^2$ norm of the difference between the computed low-mode representation and the exact low-mode representation. Because the Legendre polynomials are orthogonal, this error reduces to the weighted Euclidean norm of coefficient differences:\n$$\nE_{\\text{nodal}}(N) = \\left( \\sum_{k=0}^{N} \\left(c_k^{\\text{nod}} - c_k^{\\star}\\right)^2 \\int_{-1}^{1} P_k^2(x)\\,\\mathrm{d}x \\right)^{1/2} = \\left( \\sum_{k=0}^{N} \\left(c_k^{\\text{nod}} - c_k^{\\star}\\right)^2 \\frac{2}{2k+1} \\right)^{1/2},\n$$\n$$\nE_{\\text{conv}}(N) = \\left( \\sum_{k=0}^{N} \\left(c_k^{\\text{conv}} - c_k^{\\star}\\right)^2 \\frac{2}{2k+1} \\right)^{1/2}.\n$$\n\nTasks:\n1. Implement the two pathways described above. Use Gauss-Lobatto-Legendre nodes and weights for the nodal pathway. For the modal convolution with truncation pathway and for computing $c_k^{\\star}$, use Gauss-Legendre quadrature with $M = 3N+3$ nodes to ensure exactness for polynomials up to degree $6N+5$.\n2. For each polynomial degree in the test suite, compute $E_{\\text{nodal}}(N)$ and $E_{\\text{conv}}(N)$, and determine which pathway yields smaller aliasing in practice. Output a boolean indicating whether $E_{\\text{conv}}(N)  E_{\\text{nodal}}(N)$.\n3. Test Suite:\n   - Case 1: $N=1$\n   - Case 2: $N=3$\n   - Case 3: $N=8$\n   - Case 4: $N=16$\n4. Output Specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list in the form $[N, E_{\\text{nodal}}(N), E_{\\text{conv}}(N), \\text{is\\_conv\\_better}]$, where $N$ is an integer, $E_{\\text{nodal}}(N)$ and $E_{\\text{conv}}(N)$ are floating-point numbers, and $\\text{is\\_conv\\_better}$ is a boolean. For example: $[[1,0.0,0.0,True],[3,0.1,0.0,True]]$.\n\nThe problem is purely mathematical and involves no physical units. Angles do not appear. Percentages are not required. The design probes aliasing arising from underintegration in nonlinear spectral computations and asks you to determine which computational pathway yields smaller aliasing and how the result depends on the polynomial degree $N$.",
            "solution": "The problem requires a comparison of two computational pathways for determining the low-degree modal coefficients of a squared polynomial, $u^2(x)$, within the framework of the Spectral Element Method. The function is defined in a Legendre polynomial basis of degree $N$ as $u(x) = \\sum_{n=0}^{N} a_n P_n(x)$ with coefficients $a_n = \\frac{1}{n+1}$. The two pathways are a nodal product followed by projection and a direct modal convolution followed by truncation. The core of the problem is to quantify the aliasing error introduced by the nodal pathway.\n\nThe analysis hinges on the properties of the quadrature rules used. A Gauss-type quadrature with $K$ points integrates polynomials of degree up to $2K-1$ exactly. The Gauss-Lobatto-Legendre (GLL) quadrature with $N+1$ points is a notable exception, being exact for polynomials of degree up to $2N-1$.\n\nFirst, we analyze the **modal convolution with truncation pathway**. The coefficients $c_k^{\\text{conv}}$ are computed by evaluating the integral in the definition of the $L^2$ projection:\n$$\nc_k^{\\text{conv}} = \\frac{2k+1}{2}\\int_{-1}^{1} u^2(x) P_k(x)\\,\\mathrm{d}x, \\quad 0 \\le k \\le N.\n$$\nThe function $u(x)$ is a polynomial of degree $N$, so its square, $u^2(x)$, is a polynomial of degree $2N$. The integrand, $u^2(x) P_k(x)$, is thus a polynomial of degree $2N+k$. For the range of modes considered, $0 \\le k \\le N$, the maximum degree of the integrand is $2N+N=3N$. The problem specifies using a Gauss-Legendre (GL) quadrature with $M=3N+3$ nodes to evaluate this integral. This GL quadrature is exact for polynomials of degree up to $2M-1 = 2(3N+3)-1 = 6N+5$. Since $6N+5 \\ge 3N$ for all $N \\ge 0$, this quadrature rule computes the integral exactly (to machine precision).\n\nThe \"exact\" degree-$N$ projection coefficients, $c_k^{\\star}$, are defined by the same integral. Since both $c_k^{\\text{conv}}$ and $c_k^{\\star}$ for $k \\le N$ are computed using a method that is exact for the underlying integral, they must be identical: $c_k^{\\text{conv}} = c_k^{\\star}$. Consequently, the aliasing error for the modal convolution pathway is identically zero:\n$$\nE_{\\text{conv}}(N) = \\left( \\sum_{k=0}^{N} (c_k^{\\text{conv}} - c_k^{\\star})^2 \\frac{2}{2k+1} \\right)^{1/2} = 0.\n$$\n\nNext, we analyze the **nodal pathway**. The coefficients $c_k^{\\text{nod}}$ are computed by replacing the integral with a GLL quadrature sum over $N+1$ nodes $\\{x_q\\}_{q=0}^N$:\n$$\nc_k^{\\text{nod}} = \\frac{2k+1}{2}\\sum_{q=0}^{N} w_q\\,u^2(x_q)\\,P_k(x_q).\n$$\nThis corresponds to approximating the integral $\\int_{-1}^{1} u^2(x) P_k(x)\\,\\mathrm{d}x$ using a quadrature rule that is exact only for polynomials of degree up to $2N-1$. As established, the integrand $u^2(x) P_k(x)$ is a polynomial of degree $2N+k$. For any $N \\ge 1$ and $k \\ge 0$, the degree $2N+k$ is strictly greater than $2N-1$. Because the quadrature rule is not exact for the integrand, the computed sum will not equal the true integral value. This discrepancy, known as aliasing, arises because the high-frequency content of the integrand (modes with degree greater than $2N-1$) is erroneously represented (or \"aliased\") as low-frequency content by the quadrature sum. This leads to inexact coefficients, $c_k^{\\text{nod}} \\ne c_k^{\\star}$, and thus a non-zero aliasing error:\n$$\nE_{\\text{nodal}}(N) = \\left( \\sum_{k=0}^{N} (c_k^{\\text{nod}} - c_k^{\\star})^2 \\frac{2}{2k+1} \\right)^{1/2} > 0.\n$$\n\nFrom this analysis, it is clear that for all test cases with $N \\ge 1$, the modal convolution pathway is perfectly accurate, while the nodal pathway introduces aliasing error. Therefore, we can predict that $E_{\\text{conv}}(N)  E_{\\text{nodal}}(N)$ will hold true for all specified values of $N$.\n\nThe implementation will proceed as follows:\n1.  For each $N$ in the test suite, we define the coefficients $a_n = 1/(n+1)$ for the modal expansion of $u(x)$.\n2.  We compute the \"exact\" coefficients $c_k^{\\star}$ (which are equal to $c_k^{\\text{conv}}$) by numerically evaluating the defining integral using a high-order ($M=3N+3$ point) Gauss-Legendre quadrature, which guarantees a result accurate to machine precision.\n3.  We compute the nodal coefficients $c_k^{\\text{nod}}$ by first generating the $N+1$ Gauss-Lobatto-Legendre nodes and weights. The nodes consist of the endpoints $\\{-1, 1\\}$ and the roots of the derivative of the Legendre polynomial $P_N'(x)$. The weights are calculated from the standard formula $w_q = 2 / (N(N+1) [P_N(x_q)]^2)$. Then, we evaluate $u(x)$ at these nodes, compute the pointwise square $u^2(x_q)$, and perform the weighted sum to find the coefficients.\n4.  The errors $E_{\\text{nodal}}(N)$ and $E_{\\text{conv}}(N)$ are then calculated using their respective definitions. $E_{\\text{conv}}(N)$ will be zero by construction.\n5.  Finally, we compare the two errors and determine the boolean value of $E_{\\text{conv}}(N)  E_{\\text{nodal}}(N)$. The results for all test cases are collected and formatted as specified.\n\nThe required `scipy` and `numpy` libraries provide functions for Gauss-Legendre quadrature (`scipy.special.roots_legendre`) and evaluating Legendre polynomials (`scipy.special.eval_legendre`). The GLL quadrature points and weights will be implemented based on the properties of Legendre polynomials available in `numpy.polynomial.legendre`.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import eval_legendre, roots_legendre\nfrom numpy.polynomial.legendre import Legendre\n\ndef get_gll_quadrature(N):\n    \"\"\"\n    Computes Gauss-Lobatto-Legendre (GLL) nodes and weights for a given polynomial degree N.\n    \"\"\"\n    if N == 0:\n        # Not required by problem but included for completeness\n        return np.array([0.0]), np.array([2.0])\n    if N == 1:\n        return np.array([-1.0, 1.0]), np.array([1.0, 1.0])\n    \n    # Interior nodes are the roots of the derivative of P_N(x)\n    p_N_poly = Legendre.basis(N)\n    p_N_prime = p_N_poly.deriv(1)\n    interior_nodes = p_N_prime.roots()\n    \n    # Full set of nodes includes endpoints\n    nodes = np.concatenate(([-1.0], np.sort(interior_nodes), [1.0]))\n    \n    # Weights using the formula w_j = 2 / (N(N+1) * P_N(x_j)^2)\n    weights = 2.0 / (N * (N + 1) * (p_N_poly(nodes)**2))\n    \n    return nodes, weights\n\ndef solve():\n    \"\"\"\n    Computes and compares aliasing error from nodal and modal convolution pathways for a squared polynomial.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [1, 3, 8, 16]\n\n    results = []\n    for N in test_cases:\n        # Define the modal function u(x) with coefficients a_n = 1/(n+1)\n        n_vals = np.arange(N + 1, dtype=int)\n        a_coeffs = 1.0 / (n_vals + 1.0)\n        \n        # --- Compute exact coefficients c_k_star (and c_k_conv) ---\n        # Use high-order Gauss-Legendre quadrature with M = 3N+3 points\n        M = 3 * N + 3\n        nodes_gl, weights_gl = roots_legendre(M)\n        \n        # Evaluate u(x) at GL nodes: u(y_j) = sum_{n=0..N} a_n * P_n(y_j)\n        # Using a matrix representation for efficiency: P_matrix_gl[j, n] = P_n(nodes_gl[j])\n        P_matrix_gl = np.array([eval_legendre(n, nodes_gl) for n in n_vals]).T\n        u_at_gl = P_matrix_gl @ a_coeffs\n        \n        # Compute c_k_star for k=0,...,N\n        k_vals = np.arange(N + 1, dtype=int)\n        c_k_star = np.zeros(N + 1)\n        for k in k_vals:\n            Pk_at_gl = eval_legendre(k, nodes_gl)\n            integrand_at_gl = u_at_gl**2 * Pk_at_gl\n            integral = np.sum(weights_gl * integrand_at_gl)\n            c_k_star[k] = (2.0 * k + 1.0) / 2.0 * integral\n            \n        c_k_conv = c_k_star.copy()\n\n        # --- Compute nodal coefficients c_k_nod ---\n        # Use N+1 point Gauss-Lobatto-Legendre quadrature\n        nodes_gll, weights_gll = get_gll_quadrature(N)\n\n        # Evaluate u(x) at GLL nodes: u(x_q) = sum_{n=0..N} a_n * P_n(x_q)\n        P_matrix_gll = np.array([eval_legendre(n, nodes_gll) for n in n_vals]).T\n        u_at_gll = P_matrix_gll @ a_coeffs\n\n        # Compute c_k_nod for k=0,...,N\n        c_k_nod = np.zeros(N + 1)\n        for k in k_vals:\n            Pk_at_gll = P_matrix_gll[:, k]  # P_k(nodes_gll)\n            integrand_at_gll = u_at_gll**2 * Pk_at_gll\n            integral_approx = np.sum(weights_gll * integrand_at_gll)\n            c_k_nod[k] = (2.0 * k + 1.0) / 2.0 * integral_approx\n            \n        # --- Compute errors ---\n        # L2 norm weights for the coefficient vectors\n        weights_L2 = 2.0 / (2.0 * k_vals + 1.0)\n\n        # Nodal error calculation\n        error_coeffs_nodal = c_k_nod - c_k_star\n        E_nodal = np.sqrt(np.sum(error_coeffs_nodal**2 * weights_L2))\n        \n        # Convolution error calculation\n        # By definition and construction, E_conv must be zero (to machine precision)\n        error_coeffs_conv = c_k_conv - c_k_star\n        E_conv = np.sqrt(np.sum(error_coeffs_conv**2 * weights_L2))\n        \n        # Compare errors and store the result for this test case\n        is_conv_better = bool(E_conv  E_nodal)\n        results.append([N, E_nodal, E_conv, is_conv_better])\n    \n    # Final print statement in the exact required format.\n    formatted_results = []\n    for res in results:\n        # Note: str(bool) in Python produces \"True\" or \"False\", which matches the example's capitalization.\n        formatted_results.append(f\"[{res[0]},{res[1]},{res[2]},{str(res[3])}]\")\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}