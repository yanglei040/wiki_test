{
    "hands_on_practices": [
        {
            "introduction": "理解数值格式的第一步往往是亲手构建一个。本练习将引导你为一个简单的平流问题构建一个间断Galerkin（DG）算子，并分析其基本的稳定性特征 。通过这个过程，你将为后续更抽象的概念打下坚实的基础。",
            "id": "3391299",
            "problem": "考虑周期区间 $[0,1]$ 上的一个平流-扩散系统中的线性平流部分，由标量守恒律 $u_{t} + (a u)_{x} = 0$ 给出，其中平流速度为常数 $a = 1$。使用间断伽辽金 (DG) 方法，在由 $K = 2$ 个大小相等的单元 $h = \\frac{1}{2}$ 组成的均匀网格上，采用分片常数基函数（多项式阶数为 $0$）对平流算子进行离散，并施加周期性边界条件。对界面项使用迎风数值通量，并进行精确积分。组装显式半离散 DG 平流算子矩阵 $L$，使得半离散系统表示为 $u_{t} = L u$，其中 $u$ 是 DG 自由度向量。\n\n从守恒律和每个单元上的 DG 弱形式出发，推导该网格上 $L$ 的显式形式。然后计算该矩阵的谱半径 $\\rho(L)$。最后，考虑一个隐式-显式 (IMEX) 欧拉时间离散格式，其中平流项由显式前向欧拉方法处理，而扩散项（在此算子中不存在）将被隐式处理。利用前向欧拉方法的绝对稳定域，确定该网格上平流算子所施加的最大线性稳定显式时间步长 $\\Delta t_{\\max}$。\n\n以行矩阵 $\\big[ \\rho(L) \\ \\ \\Delta t_{\\max} \\big]$ 的形式给出你的最终答案，要求为精确形式（不进行四舍五入）。",
            "solution": "用户想要分析线性平流方程的间断伽辽金 (DG) 离散。\n\n### 步骤 1：提取已知条件\n- **偏微分方程 (PDE)**：$u_{t} + (a u)_{x} = 0$\n- **区域**：周期区间 $[0,1]$\n- **平流速度**：常数，$a = 1$\n- **离散方法**：间断伽辽金 (DG)\n- **基函数**：分片常数（多项式阶数 $p=0$）\n- **网格**：均匀，有 $K = 2$ 个单元。\n- **单元大小**：$h = \\frac{1-0}{K} = \\frac{1}{2}$\n- **单元定义**：$I_1 = [0, \\frac{1}{2}]$, $I_2 = [\\frac{1}{2}, 1]$\n- **数值通量**：界面项使用迎风通量。\n- **积分**：使用精确积分。\n- **任务**：\n    1. 为系统 $u_{t} = L u$ 组装半离散 DG 算子矩阵 $L$。\n    2. 计算谱半径 $\\rho(L)$。\n    3. 确定应用于此算子的前向欧拉格式的最大线性稳定显式时间步长 $\\Delta t_{\\max}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是偏微分方程数值分析中的一个标准练习，特别是在谱方法和间断伽辽金方法的专题内。\n- **科学依据**：该问题基于成熟的线性平流 DG 方法，这是计算科学中的一个基本课题。所有引用的原理（弱形式、数值通量、稳定性分析）都是标准且正确的。\n- **适定性**：问题陈述清晰，包含了推导唯一算子矩阵 $L$ 所需的所有参数（偏微分方程、区域、边界条件、离散化细节）。后续寻找其谱半径和相应显式时间步长稳定极限的任务是明确定义的数学过程。\n- **客观性**：问题使用精确、无歧义的数学语言表述。\n- **完整性**：设置是完整的。方程、区域、网格、基函数和数值通量都已指定。\n- **结论**：该问题有效、自洽且一致。\n\n### 步骤 3：判断与行动\n问题有效。将继续进行求解。\n\n### 半离散系统的推导\n\n偏微分方程 $u_t + (au)_x = 0$ 的 DG 弱形式是通过乘以一个来自相同逼近空间的测试函数 $v_h$ 并在单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分得到的：\n$$\n\\int_{I_j} u_t v_h \\, dx + \\int_{I_j} (au)_x v_h \\, dx = 0\n$$\n对第二项应用分部积分法得到：\n$$\n\\int_{I_j} u_t v_h \\, dx - \\int_{I_j} au v_{h,x} \\, dx + [au v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\n展开边界项，并将通量 $au$ 替换为数值通量，记为 $(au)^*$，我们得到：\n$$\n\\int_{I_j} u_t v_h \\, dx - \\int_{I_j} au v_{h,x} \\, dx + (au)^*|_{x_{j+1/2}} v_h(x_{j+1/2}^-) - (au)^*|_{x_{j-1/2}} v_h(x_{j-1/2}^+) = 0\n$$\n这里，$v_h(x_{j+1/2}^-)$ 是测试函数在右边界处从单元 $I_j$ 内部取的值，而 $v_h(x_{j-1/2}^+)$ 是在左边界处从 $I_j$ 内部取的值。\n\n对于这个问题，我们使用分片常数基函数 ($p=0$)。在单元 $I_j$ 上的近似解是 $u_h(x,t) = u_j(t)$，其中 $x \\in I_j$。测试函数在单元上也是常数，$v_h(x) = 1$。因此，其导数 $v_{h,x}$ 为 $0$，项 $\\int_{I_j} au v_{h,x} \\, dx$ 消失。弱形式简化为：\n$$\n\\int_{I_j} \\frac{du_j}{dt} \\cdot 1 \\, dx + (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} = 0\n$$\n由于 $\\int_{I_j} dx = h$，我们有：\n$$\nh \\frac{du_j}{dt} + (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} = 0\n$$\n对时间导数进行整理，得到单元 $j$ 的半离散形式：\n$$\n\\frac{du_j}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} \\right)\n$$\n\n对于平流速度 $a > 0$，指定的迎风通量为 $(au)^* = a u_{\\text{left}}$，其中 $u_{\\text{left}}$ 是界面左侧单元中解的值。我们已知 $a=1$。\n\n网格由两个单元组成，$I_1 = [0, 1/2]$ 和 $I_2 = [1/2, 1]$，单元大小为 $h=1/2$。自由度为 $u_1$ 和 $u_2$。\n\n**对于单元 $I_1$ (j=1)：**\n界面位于 $x_{1/2}=0$ 和 $x_{3/2}=1/2$。方程为：\n$$\n\\frac{du_1}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x=1/2} - (au)^*|_{x=0} \\right)\n$$\n- 在界面 $x=1/2$ 处（$I_1$ 和 $I_2$ 之间），左侧状态为 $u_1$。因此，$(au)^*|_{x=1/2} = a u_1 = u_1$。\n- 在界面 $x=0$ 处，由于周期性边界条件，左侧状态来自区域的末端，即单元 $I_2$。因此，左侧状态为 $u_2$。于是，$(au)^*|_{x=0} = a u_2 = u_2$。\n将这些通量代入 $u_1$ 的方程：\n$$\n\\frac{du_1}{dt} = - \\frac{1}{h} (u_1 - u_2) = \\frac{1}{h} (-u_1 + u_2)\n$$\n\n**对于单元 $I_2$ (j=2)：**\n界面位于 $x_{3/2}=1/2$ 和 $x_{5/2}=1$。方程为：\n$$\n\\frac{du_2}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x=1} - (au)^*|_{x=1/2} \\right)\n$$\n- 在界面 $x=1$ 处，由于周期性边界条件，左侧状态来自单元 $I_2$。因此，$(au)^*|_{x=1} = a u_2 = u_2$。\n- 在界面 $x=1/2$ 处（$I_1$ 和 $I_2$ 之间），左侧状态来自单元 $I_1$，即 $u_1$。因此，$(au)^*|_{x=1/2} = a u_1 = u_1$。\n将这些通量代入 $u_2$ 的方程：\n$$\n\\frac{du_2}{dt} = - \\frac{1}{h} (u_2 - u_1) = \\frac{1}{h} (u_1 - u_2)\n$$\n\n### 算子矩阵 $L$ 的组装\n常微分方程组为：\n$$\n\\frac{d}{dt} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -u_1 + u_2 \\\\ u_1 - u_2 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}\n$$\n当 $h=1/2$ 时，算子矩阵 $L$ 为：\n$$\nL = \\frac{1}{1/2} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = 2 \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} -2  2 \\\\ 2  -2 \\end{pmatrix}\n$$\n\n### 谱半径 $\\rho(L)$ 的计算\n$L$ 的特征值 $\\lambda$ 是特征方程 $\\det(L - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} -2-\\lambda  2 \\\\ 2  -2-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2-\\lambda)^2 - (2)(2) = 0\n$$\n$$\n(2+\\lambda)^2 - 4 = 0\n$$\n$$\n(2+\\lambda)^2 = 4\n$$\n$$\n2+\\lambda = \\pm 2\n$$\n两个特征值为：\n$$\n\\lambda_1 = -2 + 2 = 0\n$$\n$$\n\\lambda_2 = -2 - 2 = -4\n$$\n$L$ 的谱为 $\\{0, -4\\}$。谱半径是特征值绝对值的最大值：\n$$\n\\rho(L) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|0|, |-4|) = 4\n$$\n\n### 最大稳定时间步长 $\\Delta t_{\\max}$ 的确定\n对半离散系统 $u_t = Lu$ 应用前向欧拉方法：\n$$\nu^{n+1} = u^n + \\Delta t L u^n = (I + \\Delta t L) u^n\n$$\n为了线性稳定性，放大矩阵 $G = I + \\Delta t L$ 的特征值的模必须不大于 $1$。$G$ 的特征值为 $g_i = 1 + \\Delta t \\lambda_i$，其中 $\\lambda_i$ 是 $L$ 的特征值。\n稳定性条件是对于所有的 $i$，都有 $|1 + \\Delta t \\lambda_i| \\le 1$。这要求复数 $z = \\Delta t \\lambda_i$ 位于前向欧拉方法的绝对稳定域内，该区域是在复平面上以 $-1$ 为中心、半径为 $1$ 的圆盘。\n- 对于 $\\lambda_1 = 0$：$|1 + \\Delta t \\cdot 0| = |1| = 1 \\le 1$。这个条件对任何 $\\Delta t$ 都满足。\n- 对于 $\\lambda_2 = -4$：$|1 + \\Delta t (-4)| \\le 1$，即 $|1 - 4 \\Delta t| \\le 1$。\n这个不等式等价于 $-1 \\le 1 - 4\\Delta t \\le 1$。\n1.  $1 - 4\\Delta t \\le 1 \\implies -4\\Delta t \\le 0 \\implies \\Delta t \\ge 0$。\n2.  $-1 \\le 1 - 4\\Delta t \\implies 4\\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{4} = \\frac{1}{2}$。\n综合这些，我们得到 $0 \\le \\Delta t \\le \\frac{1}{2}$。因此，最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{1}{2}\n$$\n\n最终答案要求行矩阵 $[\\rho(L) \\ \\ \\Delta t_{\\max}]$。\n$$\n\\rho(L) = 4, \\quad \\Delta t_{\\max} = \\frac{1}{2}\n$$\n结果矩阵为 $\\begin{pmatrix} 4  \\frac{1}{2} \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "使用隐式-显式（IMEX）格式的主要动机是克服像扩散这样的刚性项所带来的严格时间步长限制。本练习通过在典型的平流-扩散场景下，定量比较IMEX格式与完全显式格式所允许的最大时间步长，来清晰地展示IMEX的这一优势 。这将帮助你理解算子分裂在实践中的好处。",
            "id": "3391304",
            "problem": "考虑一维常系数平流-扩散方程 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$，该方程定义在周期性域 $x \\in [0,1]$ 上，在空间上使用次数为 $p$ 的多项式，在尺寸为 $h$ 的均匀网格上，通过间断伽辽金 (Discontinuous Galerkin, DG) 方法进行离散化，其中平流项使用迎风数值通量，扩散项使用对称内部罚函数伽辽金 (symmetric interior penalty Galerkin, SIPG) 形式。设半离散系统写为可加形式 $u'(t) = L_{A}u(t) + L_{D}u(t)$，其中 $L_{A}$ 是平流算子，$L_{D}$ 是扩散算子。根据DG多项式空间的反估计，已知 $L_{A}$ 的谱半径标度为 $\\omega_{A} = \\frac{a}{h}(2p+1)$，$L_{D}$ 的谱半径标度为 $\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}$。\n\n您将使用两种不同的时间积分器对半离散系统进行时间推进：\n- 一种隐式-显式 (Implicit–Explicit, IMEX) 可加龙格-库塔 (Additive Runge–Kutta, ARK) 方法，其中平流部分 $L_{A}$ 被显式处理，扩散部分 $L_{D}$ 被隐式处理。假定隐式部分是 A-稳定的（不受负实特征值的限制），而显式部分的线性稳定域与虚轴的交集是一个已知常数 $\\alpha_{I} = 2.785$。\n- 一种全显式经典四阶龙格-库塔 (Runge–Kutta, RK) 方法，其线性稳定域与虚轴的交点在 $\\alpha_{E} = 2.785$，与负实轴的交点在 $\\beta_{E} = 2.785$。\n\n仅使用上述基本事实和标度律（不使用其他预先制表的稳定性极限或快捷公式），推导每个积分器在绝对稳定性要求下所隐含的时间步长限制，并计算在以下参数值下：$a = 1$, $\\nu = 10^{-3}$, $h = \\frac{1}{128}$, $p = 5$，IMEX 方法允许的最大时间步长与全显式 RK 方法允许的最大时间步长之比 $R$。\n\n将您的最终数值答案 $R$ 四舍五入到四位有效数字。将 $R$ 报告为无量纲量。",
            "solution": "我们从方程 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$ 经过间断伽辽金 (DG) 空间离散化得到的半离散表示 $u'(t) = L_{A}u(t) + L_{D}u(t)$ 开始。对于均匀网格上的常系数线性算子，由于其带有迎风通量稳定化的斜伴随特性，平流算子 $L_{A}$ 的特征值主要为纯虚数；而由于椭圆性和对称内部罚函数伽辽金 (SIPG) 构造，扩散算子 $L_{D}$ 的特征值为负实数。\n\n基本的 DG 反估计表明，对于尺寸为 $h$ 的单元上次数为 $p$ 的多项式，存在导数范数界和迹不等式，这意味着半离散算子范数的标度如下：\n$$\n\\omega_{A} = \\frac{a}{h}(2p+1), \\qquad \\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}.\n$$\n这些是经过充分检验的标度估计，分别反映了平流算子和扩散算子的最大模特征值。\n\n将龙格-库塔方法应用于线性系统 $y' = \\lambda y$ 时，其绝对稳定性要求 $\\Delta t\\,\\lambda$ 位于该方法的稳定域内。对于纯虚数 $\\lambda$（来自平流项），限制条件由稳定域与虚轴的交集决定；对于负实数 $\\lambda$（来自扩散项），限制条件由稳定域与负实轴的交集决定。\n\n对于隐式-显式 (IMEX) 可加龙格-库塔 (ARK) 方法：\n- 显式部分用于推进 $L_{A}$，其虚数特征值有界，满足 $|\\lambda_{A}| \\leq \\omega_{A}$。显式稳定域与虚轴的交点在 $\\alpha_{I} = 2.785$，因此时间步长必须满足\n$$\n\\Delta t_{\\text{IMEX}} \\leq \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- 隐式部分是 A-稳定的，因此位于负实轴上的扩散特征值不对 $\\Delta t_{\\text{IMEX}}$ 施加限制。\n\n对于全显式经典四阶龙格-库塔 (RK) 方法：\n- 平流项的限制是\n$$\n\\Delta t \\leq \\frac{\\alpha_{E}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- 扩散项的限制是\n$$\n\\Delta t \\leq \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{\\frac{\\nu}{h^{2}}(2p+1)^{2}}.\n$$\n全显式方法允许的时间步长是这两者中的最小值。\n\n我们需要计算在参数 $a = 1$, $\\nu = 10^{-3}$, $h = \\frac{1}{128}$ 和 $p = 5$ 下，IMEX 方法的最大时间步长与全显式 RK 方法的最大时间步长之比 $R$。首先，我们计算算子的标度：\n$$\n2p+1 = 11, \\quad \\omega_{A} = \\frac{a}{h}(2p+1) = \\frac{1}{h}\\cdot 11 = 11 \\cdot 128 = 1408,\n$$\n$$\n\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2} = \\nu \\cdot \\frac{1}{h^{2}} \\cdot 121 = 10^{-3} \\cdot 16384 \\cdot 121 = 16.384 \\cdot 121 = 1982.464.\n$$\n接下来，我们通过比较平流和扩散的限制来确定哪一个约束对全显式 RK 方法是起作用的。由于 $\\omega_{D} > \\omega_{A}$，扩散约束更严格：\n$$\n\\Delta t_{\\text{explicit}} = \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{1982.464}.\n$$\n对于 IMEX 方法，只有平流约束适用：\n$$\n\\Delta t_{\\text{IMEX}} = \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{1408}.\n$$\n该比值简化为\n$$\nR = \\frac{\\Delta t_{\\text{IMEX}}}{\\Delta t_{\\text{explicit}}} = \\frac{\\alpha_{I}/\\omega_{A}}{\\beta_{E}/\\omega_{D}} = \\frac{\\alpha_{I}}{\\beta_{E}}\\cdot \\frac{\\omega_{D}}{\\omega_{A}}.\n$$\n给定 $\\alpha_{I} = \\beta_{E} = 2.785$，该式变为\n$$\nR = \\frac{\\omega_{D}}{\\omega_{A}} = \\frac{\\frac{\\nu}{h^{2}}(2p+1)^{2}}{\\frac{a}{h}(2p+1)} = \\frac{\\nu}{a}\\cdot \\frac{2p+1}{h}.\n$$\n代入参数值，\n$$\nR = \\frac{10^{-3}}{1}\\cdot \\frac{11}{\\frac{1}{128}} = 10^{-3}\\cdot 11 \\cdot 128 = 1.408.\n$$\n四舍五入到四位有效数字，该比值为 $1.408$。这表明，在给定参数下，与全显式四阶龙格-库塔格式相比，IMEX 方法允许的时间步长要大 $1.408$ 倍。",
            "answer": "$$\\boxed{1.408}$$"
        },
        {
            "introduction": "从理论走向实践，求解IMEX格式中的隐式部分通常需要迭代线性求解器，而这并不会求解到机器精度。本练习探讨了一个关键问题：我们需要多精确地求解这个线性系统，才能不损害整个IMEX时间步进法的整体精度 ？这为你架起了理论误差分析与高效计算实现之间的桥梁。",
            "id": "3391226",
            "problem": "考虑一个定义在周期性区域上的线性平流-扩散初值问题，\n$$\nu_t + a\\,u_x \\;=\\; \\nu\\,u_{xx}, \\qquad x\\in [0,L], \\quad t\\ge 0,\n$$\n其初值数据是光滑的，其中 $a\\in\\mathbb{R}$ 且 $\\nu0$。假设空间离散化通过高阶间断 Galerkin (DG) 方法或傅里叶谱方法进行，得到一个半离散的常微分方程 (ODE) 系统\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) \\;=\\; \\mathbf{f}(\\mathbf{u}(t)) \\;+\\; \\mathbf{g}(\\mathbf{u}(t)),\n$$\n其中 $\\mathbf{M}$ 是一个对称正定质量矩阵，$\\mathbf{f}$ 编码了显式平流项的贡献，而 $\\mathbf{g}$ 编码了刚性扩散项的贡献。假设 $\\mathbf{g}$ 是线性的，可以写成 $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$ 的形式，其中 $\\mathbf{L}$ 在 $\\mathbf{M}$-内积下是半负定对称的。时间积分采用全局阶为 $p\\ge 1$ 的隐式-显式 (IMEX) 加性 Runge–Kutta (ARK) 方法，其隐式部分是 $L$-稳定的。在每个隐式阶段，用于求解阶段值 $\\mathbf{Y}_i$ 的线性系统通过迭代法进行非精确求解，当阶段方程的残差在 $\\mathbf{M}$-范数下满足以下条件时终止迭代\n$$\n\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\;\\le\\; \\tau,\n$$\n其中 $\\tau0$ 是用户指定的绝对容差，且 $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$。假设存在一个与时间步长 $\\Delta t$ 和空间分辨率无关的常数 $c_\\star$，使得对于每个形如 $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$ 的隐式阶段矩阵（其中 $\\gamma_i0$ 是对角的隐式系数，$\\mathbf{J}_g$ 是 $\\mathbf{g}$ 的雅可比矩阵，此处等于 $\\mathbf{L}$），其逆在 $\\mathbf{M}$-算子范数下是一致有界的：\n$\n\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star.\n$\n忽略空间离散误差，假设在所考虑的时间步长下，它渐近地小于时间误差。\n\n你的任务是分析隐式阶段求解的非精确性如何影响 IMEX 方法的整体精度。具体而言，确定容差 $\\tau$ 应如何随时间步长 $\\Delta t$ 缩放，以便为半离散平流-扩散系统保持 IMEX 方法设计的全局阶 $p$。选择能够保证保持全局阶 $p$ 且过求解（oversolving）最少的最佳建议，并根据半离散 ODE、隐式算子的稳定性以及 IMEX ARK 方法的结构来论证你的选择。\n\n哪个建议最合适？\n\nA. 选择 $\\tau = C\\,\\Delta t^{p}$（其中 $C$ 与 $\\Delta t$ 无关），作为阶段残差在 $\\mathbf{M}$-范数下的绝对容差，从而使求解器引起的局部缺陷与方法的局部截断误差具有相同的渐近规模。\n\nB. 选择 $\\tau = C\\,\\Delta t^{p+1}$ 以直接匹配局部截断误差，因为阶段残差对单步误差的贡献没有额外的 $\\Delta t$ 因子。\n\nC. 保持 $\\tau$ 与 $\\Delta t$ 无关，以避免在 $\\Delta t$ 较小时进行不必要的工作，因为隐式算子是 $L$-稳定的，能够衰减由刚性引起的误差。\n\nD. 选择 $\\tau = C\\,\\Delta t^{p-1}$，因为扩散刚性会将阶段误差放大一个量级为 $\\Delta t^{-1}$ 的因子，这要求比标称的局部截断误差缩放更紧的阶段容差。\n\n这里 $C0$ 表示一个不依赖于 $\\Delta t$ 的常数，它可能依赖于解的范数和方法的系数。假设对于精确求解，经典阶 $p$ 误差估计所需的所有稳定性和光滑性条件都成立，并且只关注在上述指定的容差 $\\tau$ 下终止隐式阶段求解的影响。",
            "solution": "问题陈述需要进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程：** 线性平流-扩散方程 $u_t + a\\,u_x = \\nu\\,u_{xx}$，定义在周期性区域 $x\\in [0,L]$，$t\\ge 0$ 上，其中 $a\\in\\mathbb{R}$，$\\nu0$，且初值数据光滑。\n- **半离散系统：** $\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) = \\mathbf{f}(\\mathbf{u}(t)) + \\mathbf{g}(\\mathbf{u}(t))$。\n- **质量矩阵 $\\mathbf{M}$：** 对称正定。\n- **平流项 $\\mathbf{f}(\\mathbf{u})$：** 显式处理。\n- **扩散项 $\\mathbf{g}(\\mathbf{u})$：** 刚性，隐式处理。它是线性的，因此 $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$。\n- **扩散矩阵 $\\mathbf{L}$：** 在 $\\mathbf{M}$-内积下是对称半负定的。\n- **时间积分：** 全局阶为 $p\\ge 1$ 的隐式-显式 (IMEX) 加性 Runge–Kutta (ARK) 方法。隐式部分是 $L$-稳定的。\n- **非精确求解：** 隐式阶段的线性系统被非精确求解。\n- **终止准则：** 对每个隐式阶段 $i$ 的迭代求解在阶段方程残差 $\\mathbf{r}_i$ 满足 $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$ 时终止，其中 $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$ 且 $\\tau0$ 是绝对容差。\n- **隐式阶段矩阵：** 第 $i$ 个隐式阶段的矩阵是 $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$，其中 $\\gamma_i0$ 是隐式 Runge-Kutta 方法的对角系数，$\\mathbf{J}_g=\\mathbf{L}$ 是 $\\mathbf{g}$ 的雅可比矩阵。\n- **有界性假设：** 存在一个与 $\\Delta t$ 和空间分辨率无关的常数 $c_\\star$，使得阶段矩阵的逆在由 $\\mathbf{M}$-范数诱导的算子范数下一致有界：$\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$。\n- **简化假设：** 空间离散误差可忽略不计。假设精确求解情况下的经典阶条件成立。\n- **问题：** 确定容差 $\\tau$ 随时间步长 $\\Delta t$ 的缩放关系，以在过求解最少的情况下保持全局精度阶 $p$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是偏微分方程数值分析领域的一个典型例子。对平流-扩散-反应系统使用 IMEX ARK 方法是一种标准且经过充分研究的技术。离散化算子（$\\mathbf{M}$，$\\mathbf{L}$）的性质是间断 Galerkin 或谱方法等空间离散化方法的典型特征。\n- **良态性：** 该问题是良态的。它要求在数值参数（$\\tau$ 和 $\\Delta t$）之间建立一种特定关系，以实现所需的理论性质（精度阶）。所给出的假设，特别是隐式阶段矩阵的逆的一致有界性，是对此类方法进行严格分析时的标准假设，并且是得出明确结论所必需的。\n- **客观性：** 该问题使用数值分析中精确、客观和标准的术语进行陈述。\n\n问题陈述内部一致、科学合理且良态。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将推导解答。\n\n### 正确容差缩放的推导\n\n目标是确定非精确线性求解的容差 $\\tau$ 必须如何随时间步长 $\\Delta t$ 缩放，以确保时间积分方法的全局误差保持在 $\\mathcal{O}(\\Delta t^p)$。\n\n1.  **局部截断误差 (LTE)：** 一个全局阶为 $p$ 的 IMEX ARK 方法，其局部截断误差的阶为 $\\mathcal{O}(\\Delta t^{p+1})$。这是在假设一个时间步从 ODE 系统的精确解开始，并且所有阶段方程都得到精确求解的情况下，在该步中引入的误差。为了保持全局阶 $p$，在该步内引入的任何额外误差在 $\\Delta t$ 上的阶数不得低于方法自身的 LTE。\n\n2.  **非精确隐式阶段分析：** 我们考虑 ARK 方法的一个通用隐式阶段 $i$。阶段方程的隐式部分可以写成：\n    $$(\\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}) \\mathbf{Y}_i = \\mathbf{b}_i$$\n    其中 $\\mathbf{Y}_i$ 是精确的阶段解向量，$\\mathbf{b}_i$ 包含来自前一时间步和先前阶段的信息。令 $\\mathbf{A}_i := \\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}$。精确的阶段解是 $\\mathbf{Y}_i = \\mathbf{A}_i^{-1}\\mathbf{b}_i$。\n\n    迭代求解器计算一个近似的阶段解 $\\hat{\\mathbf{Y}}_i$。当残差 $\\mathbf{r}_i := \\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i$ 满足 $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$ 时，求解器终止。\n\n3.  **阶段解中的误差：** 由于非精确求解导致的阶段解误差为 $\\mathbf{e}_i := \\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i$。我们可以将此误差与残差联系起来：\n    $$\\mathbf{A}_i \\mathbf{e}_i = \\mathbf{A}_i (\\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i) = (\\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i) - (\\mathbf{A}_i \\mathbf{Y}_i - \\mathbf{b}_i) = \\mathbf{r}_i - \\mathbf{0} = \\mathbf{r}_i$$\n    因此，阶段解误差为 $\\mathbf{e}_i = \\mathbf{A}_i^{-1} \\mathbf{r}_i$。\n\n4.  **阶段解误差的上界：** 使用由 $\\mathbf{M}$-内积诱导的范数，我们可以界定此误差的大小：\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} = \\|\\mathbf{A}_i^{-1} \\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\|\\mathbf{r}_i\\|_{\\mathbf{M}}$$\n    使用问题的已知条件 $\\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ 和 $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$，我们得到阶段误差的一个界：\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} \\le c_\\star \\tau$$\n    这表明每个阶段向量中的误差量级为 $\\mathcal{O}(\\tau)$。\n\n5.  **对单步误差的贡献：** 阶段解中的误差 $\\mathbf{e}_i$ 会传播到该步的最终解更新中。新时间层级的解 $\\mathbf{u}_{n+1}$ 是通过旧时间层级解 $\\mathbf{u}_n$ 与涉及阶段值的项的线性组合计算得出的：\n    $$\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\sum_{j=1}^s \\left( b_j^E \\mathbf{f}(\\mathbf{Y}_j) + b_j^I \\mathbf{L}\\mathbf{Y}_j \\right)$$\n    当使用非精确阶段解 $\\hat{\\mathbf{Y}}_j = \\mathbf{Y}_j + \\mathbf{e}_j$ 时，计算出的更新 $\\hat{\\mathbf{u}}_{n+1}$ 将与精确求解的更新 $\\mathbf{u}_{n+1}$ 不同。求解器在一步中引入的误差 $\\delta_{\\text{step}} := \\hat{\\mathbf{u}}_{n+1} - \\mathbf{u}_{n+1}$ 是：\n    $$\\delta_{\\text{step}} = \\Delta t \\sum_{j=1}^s \\left( b_j^E (\\mathbf{f}(\\hat{\\mathbf{Y}}_j) - \\mathbf{f}(\\mathbf{Y}_j)) + b_j^I \\mathbf{L}(\\hat{\\mathbf{Y}}_j - \\mathbf{Y}_j) \\right)$$\n    假设函数是良态的（例如，$\\mathbf{f}$ 是 Lipschitz 连续的），求和号内的项的量级与阶段误差 $\\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}}$ 相同。\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} \\approx \\mathcal{O}(\\Delta t \\cdot \\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}})$$\n    由于 $\\|\\mathbf{e}_j\\|_{\\mathbf{M}} = \\mathcal{O}(\\tau)$，由非精确求解引入的局部误差为：\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} = \\mathcal{O}(\\Delta t \\cdot \\tau)$$\n\n6.  **匹配误差阶：** 为了保持方法的全局阶 $p$，由非精确求解产生的局部误差最多必须与方法固有的局部截断误差同阶。\n    $$\\text{求解器引起的局部误差} \\le \\text{方法的局部截断误差}$$\n    $$\\mathcal{O}(\\Delta t \\cdot \\tau) \\le \\mathcal{O}(\\Delta t^{p+1})$$\n    为了在 $\\Delta t \\to 0$ 时成立，我们必须有：\n    $$\\tau = \\mathcal{O}(\\Delta t^p)$$\n    选择 $\\tau = C\\,\\Delta t^p$（对于某个常数 $C$）确保了求解器引起的局部误差为 $\\mathcal{O}(\\Delta t^{p+1})$，这与方法的 LTE 的阶相匹配。这个选择是最佳的，因为它是保持精度阶所需的最不严格的要求，从而避免了不必要的过求解。\n\n### 逐项分析选项\n\n**A. 选择 $\\tau = C\\,\\Delta t^{p}$（其中 $C$ 与 $\\Delta t$ 无关），作为阶段残差在 $\\mathbf{M}$-范数下的绝对容差，从而使求解器引起的局部缺陷与方法的局部截断误差具有相同的渐近规模。**\n此建议与我们的推导完全一致。设置 $\\tau = C\\,\\Delta t^p$ 会使求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t^{p+1})$，这与方法的局部截断误差同阶。这确保了全局阶 $p$ 得以保持，而不会使容差变得不必要地严格。\n**结论：正确。**\n\n**B. 选择 $\\tau = C\\,\\Delta t^{p+1}$ 以直接匹配局部截断误差，因为阶段残差对单步误差的贡献没有额外的 $\\Delta t$ 因子。**\n$\\tau = C\\,\\Delta t^{p+1}$ 的缩放过于严格。它会导致求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p+1}) = \\mathcal{O}(\\Delta t^{p+2})$，比要求的阶数小一阶。这会导致“过求解”和不必要的计算成本。其理由也是有缺陷的；如推导所示，阶段级误差对单步误差的贡献会因 Runge-Kutta 更新公式而乘以一个 $\\Delta t$ 因子。\n**结论：不正确。**\n\n**C. 保持 $\\tau$ 与 $\\Delta t$ 无关，以避免在 $\\Delta t$ 较小时进行不必要的工作，因为隐式算子是 $L$-稳定的，能够衰减由刚性引起的误差。**\n如果 $\\tau = \\mathcal{O}(1)$（与 $\\Delta t$ 无关），则求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t)$。对于任何阶数 $p \\ge 1$ 的方法，其 LTE 为 $\\mathcal{O}(\\Delta t^{p+1})$，阶数高于 $\\mathcal{O}(\\Delta t)$。总局部误差将由求解器误差主导，变为 $\\mathcal{O}(\\Delta t)$。在 $T/\\Delta t$ 步上累积的全局误差将是 $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t) = \\mathcal{O}(1)$，这意味着当 $\\Delta t \\to 0$ 时完全丧失收敛性。$L$-稳定性已在常数 $c_\\star$ 中被考虑，并不能消除控制容差的需要。\n**结论：不正确。**\n\n**D. 选择 $\\tau = C\\,\\Delta t^{p-1}$，因为扩散刚性会将阶段误差放大一个量级为 $\\Delta t^{-1}$ 的因子，这要求比标称的局部截断误差缩放更紧的阶段容差。**\n选择容差 $\\tau = C\\,\\Delta t^{p-1}$ 会导致求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p-1}) = \\mathcal{O}(\\Delta t^p)$。该误差将主导方法的 LTE $\\mathcal{O}(\\Delta t^{p+1})$。总局部误差为 $\\mathcal{O}(\\Delta t^p)$，这导致全局误差为 $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t^p) = \\mathcal{O}(\\Delta t^{p-1})$。方法的阶数从 $p$ 降至 $p-1$。其理由也是错误的：假设 $\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ 明确指出不存在 $\\Delta t^{-1}$ 的放大。这一假设是 $L$-稳定隐式方法应用于耗散算子的直接结果。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}