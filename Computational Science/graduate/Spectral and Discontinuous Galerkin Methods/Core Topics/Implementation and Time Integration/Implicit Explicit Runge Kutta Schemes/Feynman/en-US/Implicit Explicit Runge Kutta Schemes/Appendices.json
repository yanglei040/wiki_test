{
    "hands_on_practices": [
        {
            "introduction": "A key property for implicit time integrators designed for stiff systems is 'stiff accuracy.' This exercise will guide you through verifying this property for a given IMEX scheme. By confirming that the implicit weight vector matches the last row of the implicit coefficient matrix, you will demonstrate a crucial feature that enhances stability and ensures the final solution aligns with the last computed implicit stage, which is particularly important in the stiff limit. ",
            "id": "3391644",
            "problem": "Consider the semi-discrete system obtained by a spectral Discontinuous Galerkin (DG) spatial discretization of a linear advection-diffusion equation on a periodic domain, written as an ordinary differential equation (ODE) split into nonstiff and stiff components,\n$$\n\\frac{d}{dt} u(t) \\;=\\; f(u(t)) \\;+\\; g(u(t)),\n$$\nwhere $f$ denotes the nonstiff advective contribution and $g$ denotes the stiff diffusive contribution. Time integration is performed with a $2$-stage Implicit-Explicit (IMEX) Runge-Kutta (RK) scheme whose explicit and implicit Butcher tableaux have coefficients\n$$\nA^{E} \\;=\\;\n\\begin{pmatrix}\n0 & 0 \\\\\n1 & 0\n\\end{pmatrix},\n\\quad\nb^{E} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix},\n\\quad\nc^{E} \\;=\\;\n\\begin{pmatrix}\n0 \\\\ 1\n\\end{pmatrix},\n$$\nand\n$$\nA^{I} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{3} & 0 \\\\\n\\frac{2}{3} & \\frac{1}{3}\n\\end{pmatrix},\n\\quad\nb^{I} \\;=\\;\n\\begin{pmatrix}\n\\frac{2}{3} & \\frac{1}{3}\n\\end{pmatrix},\n\\quad\nc^{I} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{3} \\\\ 1\n\\end{pmatrix}.\n$$\nAssume one time step where the nonstiff contribution vanishes, $f \\equiv 0$, so only the stiff component is active. Using the foundational definitions of Implicit-Explicit (IMEX) Runge-Kutta (RK) stages and updates, determine whether the implicit part is stiffly accurate by checking the criterion $b^{I} = A^{I}_{s,:}$, where $s = 2$ is the number of stages. Then conclude, under $f \\equiv 0$, whether the one-step update $u^{n+1}$ equals the last implicit stage.\n\nFor the purposes of a single scalar diagnostic, compute\n$$\n\\delta \\;=\\; \\left|b^{I}_{1} \\;-\\; A^{I}_{2,1}\\right| \\;+\\; \\left|b^{I}_{2} \\;-\\; A^{I}_{2,2}\\right|.\n$$\nExpress the final scalar quantity $\\delta$ in exact form (no rounding).",
            "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded in the theory of numerical methods for differential equations, is well-posed, and objective. It contains all necessary information to arrive at a unique solution.\n\nThe problem asks for an analysis of a specific $2$-stage Implicit-Explicit (IMEX) Runge-Kutta (RK) scheme under the condition that the nonstiff part of the differential equation vanishes.\n\nFirst, let us recall the general formulation of an $s$-stage IMEX-RK scheme for the ordinary differential equation (ODE) $\\frac{d}{dt} u(t) = f(u(t)) + g(u(t))$. The scheme computes the updated solution $u^{n+1}$ from the solution at the previous time step, $u^n$, over a time step of size $\\Delta t$. The intermediate stages $U_i$ are computed as:\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{s} A^{E}_{ij} f(U_j) + \\Delta t \\sum_{j=1}^{s} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\nThe explicit part is typically strictly lower triangular ($A^E_{ij} = 0$ for $j \\ge i$), while the implicit part is lower triangular ($A^I_{ij} = 0$ for $j > i$). Thus, the stage equations are:\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{i-1} A^{E}_{ij} f(U_j) + \\Delta t \\sum_{j=1}^{i} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\nThe final solution update is given by:\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b^{E}_{i} f(U_i) + \\Delta t \\sum_{i=1}^{s} b^{I}_{i} g(U_i)\n$$\nThe problem specifies that the nonstiff contribution vanishes, i.e., $f \\equiv 0$. Under this condition, the IMEX-RK scheme simplifies significantly. The stage equations become:\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{i} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\nAnd the final update becomes:\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b^{I}_{i} g(U_i)\n$$\nThis is equivalent to applying a standard implicit Runge-Kutta (IRK) method with coefficients $(A^I, b^I, c^I)$ to the stiff ODE $\\frac{d}{dt} u(t) = g(u(t))$.\n\nThe problem asks to determine if the implicit part is stiffly accurate. An IRK scheme is called stiffly accurate if its vector of weights $b^I$ is equal to the last row of its coefficient matrix $A^I$. For an $s$-stage scheme, this criterion is $b^I = A^I_{s,:}$, which means $b^I_j = A^I_{s,j}$ for all $j=1, \\dots, s$.\n\nThe given scheme has $s=2$ stages. The implicit Butcher tableau coefficients are:\n$$\nA^{I} = \\begin{pmatrix} \\frac{1}{3} & 0 \\\\ \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix} \\quad \\text{and} \\quad b^{I} = \\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix}\n$$\nThe number of stages is $s=2$. The last row of the matrix $A^I$ is the second row, $A^I_{2,:}$:\n$$\nA^{I}_{2,:} = \\begin{pmatrix} A^{I}_{2,1} & A^{I}_{2,2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix}\n$$\nComparing this with the vector of weights $b^I$:\n$$\nb^{I} = \\begin{pmatrix} b^{I}_{1} & b^{I}_{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix}\n$$\nWe observe that $A^I_{2,:} = b^I$. Therefore, the implicit part of the scheme is indeed stiffly accurate.\n\nNext, we conclude whether the one-step update $u^{n+1}$ equals the last implicit stage, $U_s$. With $f \\equiv 0$ and $s=2$, the last stage $U_2$ is given by:\n$$\nU_2 = u^n + \\Delta t \\sum_{j=1}^{2} A^{I}_{2j} g(U_j) = u^n + \\Delta t \\left( A^{I}_{2,1} g(U_1) + A^{I}_{2,2} g(U_2) \\right)\n$$\nThe final update $u^{n+1}$ is given by:\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{2} b^{I}_{i} g(U_i) = u^n + \\Delta t \\left( b^{I}_{1} g(U_1) + b^{I}_{2} g(U_2) \\right)\n$$\nSince the scheme is stiffly accurate, we have $b^{I}_{1} = A^{I}_{2,1}$ and $b^{I}_{2} = A^{I}_{2,2}$. Substituting these equalities into the expression for $u^{n+1}$ yields:\n$$\nu^{n+1} = u^n + \\Delta t \\left( A^{I}_{2,1} g(U_1) + A^{I}_{2,2} g(U_2) \\right)\n$$\nThis expression is identical to the expression for $U_2$. Thus, we can conclude that for this scheme under the condition $f \\equiv 0$, the one-step update is equal to the last implicit stage: $u^{n+1} = U_2$. This is a key benefit of stiffly accurate methods, particularly for problems with stiff boundary conditions or for ensuring stability properties.\n\nFinally, we compute the scalar diagnostic $\\delta$, which quantifies the difference between $b^I$ and the last row of $A^I$. The definition is:\n$$\n\\delta = |b^{I}_{1} - A^{I}_{2,1}| + |b^{I}_{2} - A^{I}_{2,2}|\n$$\nWe substitute the values from the provided Butcher tableau:\n- $b^{I}_{1} = \\frac{2}{3}$\n- $b^{I}_{2} = \\frac{1}{3}$\n- $A^{I}_{2,1} = \\frac{2}{3}$\n- $A^{I}_{2,2} = \\frac{1}{3}$\n\nThe calculation proceeds as follows:\n$$\n\\delta = \\left|\\frac{2}{3} - \\frac{2}{3}\\right| + \\left|\\frac{1}{3} - \\frac{1}{3}\\right|\n$$\n$$\n\\delta = |0| + |0|\n$$\n$$\n\\delta = 0\n$$\nThe value $\\delta = 0$ confirms our earlier finding that the implicit part of the scheme is stiffly accurate.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "The effectiveness of an IMEX scheme is deeply intertwined with the properties of the spatial discretization. This problem explores the critical trade-off between computational cost and stability in Discontinuous Galerkin (DG) methods through the practice of 'mass lumping.' You will analyze how replacing the exact mass matrix with a diagonal (lumped) one alters the spectrum of the stiff operator, and consequently, the stability constraints on the time step. ",
            "id": "3391604",
            "problem": "Consider the one-dimensional linear diffusion equation $u_{t} = \\nu u_{xx}$ with constant diffusivity $\\nu > 0$ on a single physical element of length $h > 0$. Discretize using the Discontinuous Galerkin (DG) method with a nodal Lagrange basis of polynomial degree $p = 1$ at the Legendre–Gauss–Lobatto nodes $\\xi_{1} = -1$, $\\xi_{2} = 1$ on the reference interval $[-1,1]$, mapped affinely to the physical element so that $\\mathrm{d}x = \\frac{h}{2}\\,\\mathrm{d}\\xi$. Denote the nodal basis functions by $\\ell_{1}(\\xi) = \\frac{1 - \\xi}{2}$ and $\\ell_{2}(\\xi) = \\frac{1 + \\xi}{2}$. Let the exact elemental mass matrix $\\boldsymbol{M}$ be defined by $M_{ij} = \\int_{-1}^{1} \\ell_{i}(\\xi)\\,\\ell_{j}(\\xi)\\,\\frac{h}{2}\\,\\mathrm{d}\\xi$, and define the lumped mass matrix $\\boldsymbol{M}_{\\mathrm{L}}$ by applying Legendre–Gauss–Lobatto quadrature with weights $w_{1} = w_{2} = 1$, i.e., $M_{\\mathrm{L},ij} = \\sum_{k=1}^{2} w_{k}\\,\\ell_{i}(\\xi_{k})\\,\\ell_{j}(\\xi_{k})\\,\\frac{h}{2}$. Let the elemental stiffness matrix $\\boldsymbol{K}$ be the standard symmetric gradient form $K_{ij} = \\int_{-1}^{1} \\frac{\\mathrm{d}\\ell_{i}}{\\mathrm{d}x}(\\xi)\\,\\frac{\\mathrm{d}\\ell_{j}}{\\mathrm{d}x}(\\xi)\\,\\frac{h}{2}\\,\\mathrm{d}\\xi$, with $\\frac{\\mathrm{d}\\ell_{i}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\ell_{i}}{\\mathrm{d}\\xi}\\cdot\\frac{2}{h}$.\n\nThe semi-discrete system for the implicit diffusion stage of an Implicit–Explicit Runge–Kutta (IMEX-RK) method can be written in the linear form $\\boldsymbol{M}\\,\\dot{\\boldsymbol{u}} = -\\nu\\,\\boldsymbol{K}\\,\\boldsymbol{u}$ when using the exact mass matrix, and $\\boldsymbol{M}_{\\mathrm{L}}\\,\\dot{\\boldsymbol{u}} = -\\nu\\,\\boldsymbol{K}\\,\\boldsymbol{u}$ when using the lumped mass matrix. The linear stability of the implicit stage for a Runge–Kutta method is characterized by the location of the scaled eigenvalues $z = \\Delta t\\,\\lambda$, where $\\lambda$ are the eigenvalues of $-\\nu\\,\\boldsymbol{M}^{-1}\\boldsymbol{K}$ (or $-\\nu\\,\\boldsymbol{M}_{\\mathrm{L}}^{-1}\\boldsymbol{K}$), and $\\Delta t$ is the time step.\n\nUsing the Gershgorin Circle Theorem to bound the spectrum of $\\boldsymbol{M}^{-1}\\boldsymbol{K}$ and of $\\boldsymbol{M}_{\\mathrm{L}}^{-1}\\boldsymbol{K}$, derive the Gershgorin-based upper bound on the largest eigenvalue in each case, and then quantify how mass lumping rescales the implicit linear stability abscissa along the negative real axis for the IMEX-RK operator. Specifically, compute the factor $\\gamma$ defined by\n$$\n\\gamma \\equiv \\frac{\\text{Gershgorin-based upper bound on } \\rho\\!\\left(\\boldsymbol{M}^{-1}\\boldsymbol{K}\\right)}{\\text{Gershgorin-based upper bound on } \\rho\\!\\left(\\boldsymbol{M}_{\\mathrm{L}}^{-1}\\boldsymbol{K}\\right)},\n$$\nwhere $\\rho(\\cdot)$ denotes the spectral radius. This factor determines the ratio by which the maximum allowable time step for the implicit stage increases under mass lumping for any IMEX-RK scheme whose implicit stability domain along the negative real axis is finite. Provide your final answer for $\\gamma$ as a single real number without units. No rounding is required.",
            "solution": "The objective is to compute the ratio $\\gamma$ of the Gershgorin-based upper bounds on the spectral radii of the matrices $\\boldsymbol{M}^{-1}\\boldsymbol{K}$ and $\\boldsymbol{M}_{\\mathrm{L}}^{-1}\\boldsymbol{K}$. The Gershgorin Circle Theorem states that for any square matrix $\\boldsymbol{A}$, its spectral radius $\\rho(\\boldsymbol{A})$ is bounded by its maximum absolute row sum, denoted as $\\|\\boldsymbol{A}\\|_{\\infty}$. Thus, the Gershgorin-based upper bound is given by $\\max_i \\sum_j |A_{ij}|$. Let $B_E$ be the bound for the exact mass matrix case and $B_L$ for the lumped mass matrix case. The quantity to compute is $\\gamma = B_E / B_L$.\n\nFirst, we must compute the elemental stiffness matrix $\\boldsymbol{K}$, the exact mass matrix $\\boldsymbol{M}$, and the lumped mass matrix $\\boldsymbol{M}_{\\mathrm{L}}$.\n\nThe basis functions on the reference element $\\xi \\in [-1, 1]$ are given as $\\ell_{1}(\\xi) = \\frac{1 - \\xi}{2}$ and $\\ell_{2}(\\xi) = \\frac{1 + \\xi}{2}$. Their derivatives are $\\frac{\\mathrm{d}\\ell_{1}}{\\mathrm{d}\\xi} = -\\frac{1}{2}$ and $\\frac{\\mathrm{d}\\ell_{2}}{\\mathrm{d}\\xi} = \\frac{1}{2}$. The affine mapping from the physical element of length $h$ to the reference element gives $\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = \\frac{h}{2}$, which implies $\\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} = \\frac{2}{h}$. The derivatives of the basis functions with respect to the physical coordinate $x$ are:\n$$\n\\frac{\\mathrm{d}\\ell_{1}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\ell_{1}}{\\mathrm{d}\\xi}\\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} = \\left(-\\frac{1}{2}\\right)\\left(\\frac{2}{h}\\right) = -\\frac{1}{h}\n$$\n$$\n\\frac{\\mathrm{d}\\ell_{2}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\ell_{2}}{\\mathrm{d}\\xi}\\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} = \\left(\\frac{1}{2}\\right)\\left(\\frac{2}{h}\\right) = \\frac{1}{h}\n$$\n\nThe stiffness matrix $\\boldsymbol{K}$ has entries $K_{ij} = \\int_{-1}^{1} \\frac{\\mathrm{d}\\ell_{i}}{\\mathrm{d}x} \\frac{\\mathrm{d}\\ell_{j}}{\\mathrm{d}x} \\frac{h}{2} \\mathrm{d}\\xi$.\n$$\nK_{11} = \\int_{-1}^{1} \\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) \\frac{h}{2} \\mathrm{d}\\xi = \\frac{1}{2h} \\int_{-1}^{1} \\mathrm{d}\\xi = \\frac{1}{2h} (2) = \\frac{1}{h}\n$$\n$$\nK_{22} = \\int_{-1}^{1} \\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\frac{h}{2} \\mathrm{d}\\xi = \\frac{1}{h}\n$$\n$$\nK_{12} = K_{21} = \\int_{-1}^{1} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\frac{h}{2} \\mathrm{d}\\xi = -\\frac{1}{h}\n$$\nTherefore, the stiffness matrix is:\n$$\n\\boldsymbol{K} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n\nThe exact mass matrix $\\boldsymbol{M}$ has entries $M_{ij} = \\int_{-1}^{1} \\ell_{i}(\\xi) \\ell_{j}(\\xi) \\frac{h}{2} \\mathrm{d}\\xi$.\n$$\nM_{11} = \\int_{-1}^{1} \\left(\\frac{1-\\xi}{2}\\right)^2 \\frac{h}{2} \\mathrm{d}\\xi = \\frac{h}{8} \\int_{-1}^{1} (1-2\\xi+\\xi^2) \\mathrm{d}\\xi = \\frac{h}{8} \\left[\\xi-\\xi^2+\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{h}{8}\\left(\\frac{8}{3}\\right) = \\frac{h}{3}\n$$\n$$\nM_{22} = \\int_{-1}^{1} \\left(\\frac{1+\\xi}{2}\\right)^2 \\frac{h}{2} \\mathrm{d}\\xi = \\frac{h}{8} \\int_{-1}^{1} (1+2\\xi+\\xi^2) \\mathrm{d}\\xi = \\frac{h}{8} \\left[\\xi+\\xi^2+\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{h}{8}\\left(\\frac{8}{3}\\right) = \\frac{h}{3}\n$$\n$$\nM_{12} = M_{21} = \\int_{-1}^{1} \\left(\\frac{1-\\xi}{2}\\right)\\left(\\frac{1+\\xi}{2}\\right) \\frac{h}{2} \\mathrm{d}\\xi = \\frac{h}{8} \\int_{-1}^{1} (1-\\xi^2) \\mathrm{d}\\xi = \\frac{h}{8} \\left[\\xi-\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{h}{8}\\left(\\frac{4}{3}\\right) = \\frac{h}{6}\n$$\nThus, the exact mass matrix is:\n$$\n\\boldsymbol{M} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n\nThe lumped mass matrix $\\boldsymbol{M}_{\\mathrm{L}}$ is obtained by Legendre–Gauss–Lobatto quadrature with nodes $\\xi_1 = -1$, $\\xi_2 = 1$ and weights $w_1 = 1$, $w_2 = 1$. The basis functions satisfy the nodal property $\\ell_i(\\xi_j) = \\delta_{ij}$.\n$$\nM_{\\mathrm{L},ij} = \\sum_{k=1}^{2} w_k \\ell_i(\\xi_k) \\ell_j(\\xi_k) \\frac{h}{2} = \\frac{h}{2} (w_1 \\delta_{i1} \\delta_{j1} + w_2 \\delta_{i2} \\delta_{j2}) = \\frac{h}{2} \\delta_{ij}\n$$\nsince $w_1=w_2=1$. This gives the diagonal matrix:\n$$\n\\boldsymbol{M}_{\\mathrm{L}} = \\frac{h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n\nNext, we compute the Gershgorin-based bounds. For the lumped mass case, we form the matrix $\\boldsymbol{A}_L = \\boldsymbol{M}_{\\mathrm{L}}^{-1}\\boldsymbol{K}$:\n$$\n\\boldsymbol{M}_{\\mathrm{L}}^{-1} = \\frac{2}{h} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{A}_L = \\boldsymbol{M}_{\\mathrm{L}}^{-1}\\boldsymbol{K} = \\frac{2}{h} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{2}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe Gershgorin-based bound $B_L$ is the maximum absolute row sum:\n$$\nB_L = \\max\\left( \\left|\\frac{2}{h^2}\\right| + \\left|-\\frac{2}{h^2}\\right|, \\left|-\\frac{2}{h^2}\\right| + \\left|\\frac{2}{h^2}\\right| \\right) = \\frac{4}{h^2}\n$$\n\nFor the exact mass case, we form the matrix $\\boldsymbol{A}_E = \\boldsymbol{M}^{-1}\\boldsymbol{K}$. First, we invert $\\boldsymbol{M}$:\n$$\n\\det(\\boldsymbol{M}) = \\left(\\frac{h}{6}\\right)^2 (2 \\cdot 2 - 1 \\cdot 1) = \\frac{3h^2}{36} = \\frac{h^2}{12}\n$$\n$$\n\\boldsymbol{M}^{-1} = \\frac{12}{h^2} \\frac{h}{6} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\frac{2}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\nNow, we compute $\\boldsymbol{A}_E$:\n$$\n\\boldsymbol{A}_E = \\boldsymbol{M}^{-1}\\boldsymbol{K} = \\frac{2}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{2}{h^2} \\begin{pmatrix} 3 & -3 \\\\ -3 & 3 \\end{pmatrix} = \\frac{6}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe Gershgorin-based bound $B_E$ is the maximum absolute row sum:\n$$\nB_E = \\max\\left( \\left|\\frac{6}{h^2}\\right| + \\left|-\\frac{6}{h^2}\\right|, \\left|-\\frac{6}{h^2}\\right| + \\left|\\frac{6}{h^2}\\right| \\right) = \\frac{12}{h^2}\n$$\n\nFinally, we compute the ratio $\\gamma$:\n$$\n\\gamma = \\frac{B_E}{B_L} = \\frac{12/h^2}{4/h^2} = 3\n$$\nThis factor indicates that, based on this Gershgorin analysis, mass lumping increases the implicit time step limit by a factor of $3$ for the diffusion operator.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "For many real-world problems, a fixed time step is inefficient, as the solution's dynamics can vary dramatically. This hands-on practice delves into adaptive time-stepping by guiding you through the construction of an embedded IMEX Runge-Kutta pair. By leveraging the difference between a higher-order and a lower-order solution, you will derive an error estimator and justify the form of a step-size controller, a fundamental technique for building efficient and robust numerical solvers. ",
            "id": "3391633",
            "problem": "Consider a semi-discrete Discontinuous Galerkin (DG) approximation of a linear advection-diffusion equation on a periodic domain, written in the additive form\n$$\n\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} \\;=\\; \\boldsymbol{f}(\\boldsymbol{u}) \\;+\\; \\boldsymbol{g}(\\boldsymbol{u}),\n$$\nwhere $\\boldsymbol{f}$ denotes the non-stiff convective contribution (to be treated explicitly) and $\\boldsymbol{g}$ denotes the stiff viscous contribution (to be treated implicitly). You are to construct an implicit-explicit (IMEX) Runge–Kutta (RK) embedded pair of orders $(p,p-1) = (2,1)$ for time integration of this semi-discrete system, and to derive an error estimator that blends explicit and implicit residuals for adaptive time-step control.\n\nAdopt a two-stage additive RK structure with stage values $\\boldsymbol{Y}_{i}$, $i \\in \\{1,2\\}$, and time step $\\Delta t$, of the form\n$$\n\\boldsymbol{Y}_{i} \\;=\\; \\boldsymbol{u}^{n} \\;+\\; \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{i j} \\, \\boldsymbol{f}(\\boldsymbol{Y}_{j}) \\;+\\; \\Delta t \\sum_{j=1}^{i} a^{\\mathrm{I}}_{i j} \\, \\boldsymbol{g}(\\boldsymbol{Y}_{j}),\n$$\nand the solution update\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{n} \\;+\\; \\Delta t \\sum_{i=1}^{2} b^{\\mathrm{E}}_{i} \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}) \\;+\\; \\Delta t \\sum_{i=1}^{2} b^{\\mathrm{I}}_{i} \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}).\n$$\nTake the explicit part as the two-stage explicit trapezoidal method (also called Heun’s method),\n$$\nA^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix}, \n\\quad \\boldsymbol{b}^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{pmatrix}, \n\\quad \\boldsymbol{c}^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\nand the implicit part as a two-stage singly diagonally implicit Runge–Kutta (SDIRK) scheme with unknown diagonal parameter $\\gamma$,\n$$\nA^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} \\gamma & 0 \\\\ 1-\\gamma & \\gamma \\end{pmatrix}, \n\\quad \\boldsymbol{b}^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix}, \n\\quad \\boldsymbol{c}^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} \\gamma \\\\ 1 \\end{pmatrix}.\n$$\nAssume a stiffly accurate implicit part, i.e., the last row of $A^{\\mathrm{I}}$ equals $(\\boldsymbol{b}^{\\mathrm{I}})^{\\top}$ and $c^{\\mathrm{I}}_{2} = 1$. Construct the embedded lower-order $(p-1)=1$ pair by taking the first-order explicit and implicit weights\n$$\n\\widetilde{\\boldsymbol{b}}^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n\\qquad\n\\widetilde{\\boldsymbol{b}}^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n\nTasks:\n\n- Starting from the linear test equations $\\boldsymbol{u}' = \\boldsymbol{f}(\\boldsymbol{u})$ and $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$, and the standard Runge–Kutta order conditions up to order $p=2$, determine the exact value of $\\gamma$ that makes the implicit part second order and L-stable when applied to $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$.\n\n- Define the embedded error estimator as the difference of the high-order and low-order IMEX updates,\n$$\n\\boldsymbol{e} \\;=\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{E}}_{i} - \\widetilde{b}^{\\mathrm{E}}_{i}\\bigr) \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}) \\;+\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{I}}_{i} - \\widetilde{b}^{\\mathrm{I}}_{i}\\bigr) \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}),\n$$\nand, for adaptive time stepping in the DG context, introduce a blended scalar indicator that combines explicit and implicit residual contributions,\n$$\n\\eta \\;=\\; \\Bigl( \\alpha \\, \\|\\boldsymbol{e}_{\\mathrm{E}}\\|^{2} \\;+\\; (1-\\alpha)\\, \\|\\boldsymbol{e}_{\\mathrm{I}}\\|^{2} \\Bigr)^{1/2},\n$$\nwhere\n$$\n\\boldsymbol{e}_{\\mathrm{E}} \\;=\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{E}}_{i} - \\widetilde{b}^{\\mathrm{E}}_{i}\\bigr) \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}),\n\\qquad\n\\boldsymbol{e}_{\\mathrm{I}} \\;=\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{I}}_{i} - \\widetilde{b}^{\\mathrm{I}}_{i}\\bigr) \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}),\n$$\nand $\\alpha \\in (0,1)$ is a user-chosen weight. Using leading-order truncation error scaling, justify the step-size controller\n$$\n\\Delta t_{\\mathrm{new}} \\;=\\; \\theta \\, \\Delta t \\, \\Bigl(\\frac{\\mathrm{TOL}}{\\eta}\\Bigr)^{1/2},\n$$\nwith safety factor $\\theta \\in (0,1)$ and tolerance $\\mathrm{TOL} > 0$. No numerical evaluation is required for $\\Delta t_{\\mathrm{new}}$.\n\nYour final deliverable is the exact analytic expression for the unique $\\gamma \\in (0,1)$ that enforces second-order accuracy and L-stability of the implicit part. Report only that value as your final answer, in exact form without approximation and without units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, objective, and complete. All given data, variables, and conditions are explicitly defined within the standard framework of numerical analysis for differential equations. The problem is a formal exercise in deriving properties of an implicit-explicit (IMEX) Runge-Kutta scheme, a well-established topic. There are no contradictions, ambiguities, or scientifically unsound premises. The problem is valid.\n\nThe problem is divided into two tasks: first, to determine the parameter $\\gamma$ for the implicit part of the scheme, and second, to justify the proposed adaptive time-step controller.\n\nThe first task is to find the value of $\\gamma \\in (0,1)$ that makes the implicit Runge-Kutta scheme second-order accurate and L-stable when applied to the ordinary differential equation $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$. The implicit scheme is a singly diagonally implicit Runge-Kutta (SDIRK) method described by the Butcher tableau:\n$$\n\\begin{array}{c|c}\n\\boldsymbol{c}^{\\mathrm{I}} & A^{\\mathrm{I}} \\\\\n\\hline\n& (\\boldsymbol{b}^{\\mathrm{I}})^{\\top}\n\\end{array}\n\\;=\\;\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n& 1-\\gamma & \\gamma\n\\end{array}\n$$\nThe node vector $\\boldsymbol{c}^{\\mathrm{I}}$ is consistent with the matrix $A^{\\mathrm{I}}$, as $c^{\\mathrm{I}}_1 = a^{\\mathrm{I}}_{11} + a^{\\mathrm{I}}_{12} = \\gamma + 0 = \\gamma$ and $c^{\\mathrm{I}}_2 = a^{\\mathrm{I}}_{21} + a^{\\mathrm{I}}_{22} = (1-\\gamma) + \\gamma = 1$.\n\nThe order conditions for a Runge-Kutta method to be of order $p=2$ are:\n$1$. Order $1$: $\\sum_{i=1}^{s} b^{\\mathrm{I}}_i = 1$.\n$2$. Order $2$: $\\sum_{i=1}^{s} b^{\\mathrm{I}}_i c^{\\mathrm{I}}_i = \\frac{1}{2}$.\n\nHere, $s=2$. We check these conditions for the given implicit scheme.\nFor the first-order condition:\n$$\n\\sum_{i=1}^{2} b^{\\mathrm{I}}_i = b^{\\mathrm{I}}_1 + b^{\\mathrm{I}}_2 = (1-\\gamma) + \\gamma = 1.\n$$\nThis condition is satisfied for any value of $\\gamma$.\n\nFor the second-order condition:\n$$\n\\sum_{i=1}^{2} b^{\\mathrm{I}}_i c^{\\mathrm{I}}_i = b^{\\mathrm{I}}_1 c^{\\mathrm{I}}_1 + b^{\\mathrm{I}}_2 c^{\\mathrm{I}}_2 = (1-\\gamma)(\\gamma) + (\\gamma)(1) = \\gamma - \\gamma^2 + \\gamma = 2\\gamma - \\gamma^2.\n$$\nTo achieve second-order accuracy, this sum must equal $\\frac{1}{2}$:\n$$\n2\\gamma - \\gamma^2 = \\frac{1}{2}.\n$$\nThis can be rewritten as a standard quadratic equation:\n$$\n\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0.\n$$\nUsing the quadratic formula, $\\gamma = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with $a=1$, $b=-2$, and $c=\\frac{1}{2}$:\n$$\n\\gamma = \\frac{2 \\pm \\sqrt{(-2)^2 - 4(1)(\\frac{1}{2})}}{2(1)} = \\frac{2 \\pm \\sqrt{4 - 2}}{2} = \\frac{2 \\pm \\sqrt{2}}{2} = 1 \\pm \\frac{\\sqrt{2}}{2}.\n$$\nThe problem specifies that $\\gamma \\in (0,1)$. The solution $1 + \\frac{\\sqrt{2}}{2} \\approx 1.707$ is outside this interval. The other solution, $1 - \\frac{\\sqrt{2}}{2} \\approx 0.293$, is inside the interval. Therefore, the unique value of $\\gamma$ that ensures second-order accuracy is:\n$$\n\\gamma = 1 - \\frac{\\sqrt{2}}{2}.\n$$\n\nNext, we must verify that this choice of $\\gamma$ results in an L-stable method. L-stability requires that the method is A-stable and its stability function $R(z)$ satisfies $\\lim_{|z| \\to \\infty} |R(z)| = 0$.\n\nThe problem states the method is stiffly accurate, which implies that the numerical solution update coincides with the final stage value. For the linear test equation $u' = \\lambda u$, with $z = \\lambda \\Delta t$, the stability function $R(z)$ is given by the last component of the vector $(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$, where $\\boldsymbol{e}=(1, 1)^{\\top}$.\n$$\n\\boldsymbol{I} - z A^{\\mathrm{I}} = \\begin{pmatrix} 1 - z\\gamma & 0 \\\\ -z(1-\\gamma) & 1 - z\\gamma \\end{pmatrix}.\n$$\nThe inverse is:\n$$\n(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma & 0 \\\\ z(1-\\gamma) & 1 - z\\gamma \\end{pmatrix}.\n$$\nThen, $(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$ is:\n$$\n\\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma \\\\ z(1-\\gamma) + (1 - z\\gamma) \\end{pmatrix} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma \\\\ 1 + z(1-2\\gamma) \\end{pmatrix}.\n$$\nThe stability function is the second component of this vector:\n$$\nR(z) = \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2}.\n$$\nFor L-stability, we first check the limit as $|z| \\to \\infty$:\n$$\n\\lim_{|z| \\to \\infty} |R(z)| = \\lim_{|z| \\to \\infty} \\left| \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2} \\right| = \\lim_{|z| \\to \\infty} \\left| \\frac{z(1-2\\gamma)}{z^2\\gamma^2} \\right| = \\lim_{|z| \\to \\infty} \\left| \\frac{1-2\\gamma}{\\gamma^2 z} \\right| = 0.\n$$\nThis condition is satisfied for any $\\gamma \\neq 0$.\n\nNext, we check for A-stability, which requires $|R(z)| \\le 1$ for all $z$ in the left half-plane, $\\mathrm{Re}(z) \\le 0$. By the maximum modulus principle, it is sufficient to check this on the imaginary axis, i.e., $|R(iy)| \\le 1$ for all real $y$.\n$$\n|R(iy)|^2 = \\left| \\frac{1 + iy(1-2\\gamma)}{(1-iy\\gamma)^2} \\right|^2 = \\frac{|1 + iy(1-2\\gamma)|^2}{|(1-iy\\gamma)^2|^2} = \\frac{1 + y^2(1-2\\gamma)^2}{(1+y^2\\gamma^2)^2}.\n$$\nThe condition $|R(iy)|^2 \\le 1$ becomes:\n$$\n1 + y^2(1-2\\gamma)^2 \\le (1+y^2\\gamma^2)^2 = 1 + 2y^2\\gamma^2 + y^4\\gamma^4.\n$$\nSubtracting $1$ from both sides and dividing by $y^2$ (for $y \\neq 0$):\n$$\n(1-2\\gamma)^2 \\le 2\\gamma^2 + y^2\\gamma^4.\n$$\n$$\n1 - 4\\gamma + 4\\gamma^2 \\le 2\\gamma^2 + y^2\\gamma^4.\n$$\n$$\n1 - 4\\gamma + 2\\gamma^2 \\le y^2\\gamma^4.\n$$\nSince this inequality must hold for all real $y$, it must hold as $y \\to 0$. This implies that the left-hand side cannot be positive:\n$$\n2\\gamma^2 - 4\\gamma + 1 \\le 0.\n$$\nThe roots of the quadratic $2\\gamma^2 - 4\\gamma + 1 = 0$ are $\\gamma = 1 \\pm \\frac{\\sqrt{2}}{2}$. Since the parabola opens upwards, the inequality holds for $\\gamma$ between these roots: $1 - \\frac{\\sqrt{2}}{2} \\le \\gamma \\le 1 + \\frac{\\sqrt{2}}{2}$.\nOur value $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ lies on the boundary of this region, satisfying the condition with equality. Thus, the scheme is A-stable. Since both A-stability and the limit condition are met, the scheme is L-stable for $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.\n\nThe second task is to justify the step-size controller. The error estimator $\\boldsymbol{e}$ is the difference between the second-order solution $\\boldsymbol{u}^{n+1}$ and the first-order embedded solution $\\widetilde{\\boldsymbol{u}}^{n+1}$. The local truncation error (LTE) for the higher-order method is $LTE_p = O((\\Delta t)^{p+1}) = O((\\Delta t)^3)$, while for the lower-order method it is $LTE_{p-1} = O((\\Delta t)^p) = O((\\Delta t)^2)$.\nThe error estimate is therefore:\n$$\n\\boldsymbol{e} = \\boldsymbol{u}^{n+1} - \\widetilde{\\boldsymbol{u}}^{n+1} = (\\boldsymbol{u}(t_{n+1}) - \\widetilde{\\boldsymbol{u}}^{n+1}) - (\\boldsymbol{u}(t_{n+1}) - \\boldsymbol{u}^{n+1}) = LTE_{p-1} - LTE_p.\n$$\nFor small $\\Delta t$, the leading term is from the lower-order method:\n$$\n\\boldsymbol{e} \\approx LTE_{p-1} \\approx \\boldsymbol{C} (\\Delta t)^2,\n$$\nwhere $\\boldsymbol{C}$ is a vector that depends on the derivatives of the solution but is assumed to be approximately constant over a single time step. The scalar error indicator $\\eta$ is a norm of the components of $\\boldsymbol{e}$, so its scaling behavior is the same:\n$$\n\\eta \\approx K (\\Delta t)^2,\n$$\nwhere $K$ is a scalar constant. The goal of adaptive time-stepping is to choose a new step size, $\\Delta t_{\\mathrm{new}}$, such that the estimated error for the new step, $\\eta_{\\mathrm{new}}$, is equal to a specified tolerance, $\\mathrm{TOL}$.\nAssuming $K$ is constant, we have:\n$$\n\\eta \\approx K (\\Delta t)^2 \\quad \\text{and} \\quad \\mathrm{TOL} \\approx K (\\Delta t_{\\mathrm{new}})^2.\n$$\nTaking the ratio of these two expressions gives:\n$$\n\\frac{\\mathrm{TOL}}{\\eta} \\approx \\frac{K (\\Delta t_{\\mathrm{new}})^2}{K (\\Delta t)^2} = \\left(\\frac{\\Delta t_{\\mathrm{new}}}{\\Delta t}\\right)^2.\n$$\nSolving for $\\Delta t_{\\mathrm{new}}$ yields:\n$$\n\\Delta t_{\\mathrm{new}} \\approx \\Delta t \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2}.\n$$\nA safety factor $\\theta \\in (0,1)$ is introduced to provide a more conservative step-size update and to account for the approximation, leading to the controller:\n$$\n\\Delta t_{\\mathrm{new}} = \\theta \\, \\Delta t \\, \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2}.\n$$\nThis justifies the form of the proposed controller, with the exponent of $1/2$ arising from the fact that the error estimator scales quadratically with the time step size.\n\nThe final deliverable is the aformentioned value of $\\gamma$.",
            "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$"
        }
    ]
}