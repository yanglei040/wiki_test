{
    "hands_on_practices": [
        {
            "introduction": "A key property for the implicit part of an Implicit-Explicit (IMEX) scheme is stiff accuracy. A stiffly accurate scheme ensures that for a purely stiff problem, the final solution update is identical to the last implicit stage, which can significantly enhance stability and accuracy. This exercise provides a direct, hands-on check of this property for a given IMEX Runge-Kutta scheme by examining its Butcher tableau, reinforcing a fundamental concept in the design of robust time integrators .",
            "id": "3391644",
            "problem": "Consider the semi-discrete system obtained by a spectral Discontinuous Galerkin (DG) spatial discretization of a linear advection-diffusion equation on a periodic domain, written as an ordinary differential equation (ODE) split into nonstiff and stiff components,\n$$\n\\frac{d u}{dt} = f(u) + g(u),\n$$\nwhere $f$ denotes the nonstiff advective contribution and $g$ denotes the stiff diffusive contribution. Time integration is performed with a $2$-stage Implicit-Explicit (IMEX) Runge-Kutta (RK) scheme whose explicit and implicit Butcher tableaux have coefficients\n$$\nA^{E} =\n\\begin{pmatrix}\n0  0 \\\\\n1  0\n\\end{pmatrix},\n\\quad\n\\mathbf{b}^{E} =\n\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{2}\n\\end{pmatrix},\n\\quad\n\\mathbf{c}^{E} =\n\\begin{pmatrix}\n0 \\\\ 1\n\\end{pmatrix},\n$$\nand\n$$\nA^{I} =\n\\begin{pmatrix}\n\\frac{1}{3}  0 \\\\\n\\frac{2}{3}  \\frac{1}{3}\n\\end{pmatrix},\n\\quad\n\\mathbf{b}^{I} =\n\\begin{pmatrix}\n\\frac{2}{3}  \\frac{1}{3}\n\\end{pmatrix},\n\\quad\n\\mathbf{c}^{I} =\n\\begin{pmatrix}\n\\frac{1}{3} \\\\ 1\n\\end{pmatrix}.\n$$\nAssume one time step where the nonstiff contribution vanishes, $f \\equiv 0$, so only the stiff component is active. Using the foundational definitions of Implicit-Explicit (IMEX) Runge-Kutta (RK) stages and updates, determine whether the implicit part is stiffly accurate by checking the criterion $\\mathbf{b}^{I} = A^{I}_{s,:}$, where $s = 2$ is the number of stages. Then conclude, under $f \\equiv 0$, whether the one-step update $u^{n+1}$ equals the last implicit stage.\n\nFor the purposes of a single scalar diagnostic, compute\n$$\n\\delta = \\left|b^{I}_{1} - A^{I}_{2,1}\\right| + \\left|b^{I}_{2} - A^{I}_{2,2}\\right|.\n$$\nExpress the final scalar quantity $\\delta$ in exact form (no rounding).",
            "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded in the theory of numerical methods for differential equations, is well-posed, and objective. It contains all necessary information to arrive at a unique solution.\n\nThe problem asks for an analysis of a specific $2$-stage Implicit-Explicit (IMEX) Runge-Kutta (RK) scheme under the condition that the nonstiff part of the differential equation vanishes.\n\nFirst, let us recall the general formulation of an $s$-stage IMEX-RK scheme for the ordinary differential equation (ODE) $\\frac{d}{dt} u(t) = f(u(t)) + g(u(t))$. The scheme computes the updated solution $u^{n+1}$ from the solution at the previous time step, $u^n$, over a time step of size $\\Delta t$. The intermediate stages $U_i$ are computed as:\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{s} A^{E}_{ij} f(U_j) + \\Delta t \\sum_{j=1}^{s} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\nThe explicit part is typically strictly lower triangular ($A^E_{ij} = 0$ for $j \\ge i$), while the implicit part is lower triangular ($A^I_{ij} = 0$ for $j > i$). Thus, the stage equations are:\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{i-1} A^{E}_{ij} f(U_j) + \\Delta t \\sum_{j=1}^{i} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\nThe final solution update is given by:\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b^{E}_{i} f(U_i) + \\Delta t \\sum_{i=1}^{s} b^{I}_{i} g(U_i)\n$$\nThe problem specifies that the nonstiff contribution vanishes, i.e., $f \\equiv 0$. Under this condition, the IMEX-RK scheme simplifies significantly. The stage equations become:\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{i} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\nAnd the final update becomes:\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b^{I}_{i} g(U_i)\n$$\nThis is equivalent to applying a standard implicit Runge-Kutta (IRK) method with coefficients $(A^I, \\mathbf{b}^I, \\mathbf{c}^I)$ to the stiff ODE $\\frac{d}{dt} u(t) = g(u(t))$.\n\nThe problem asks to determine if the implicit part is stiffly accurate. An IRK scheme is called stiffly accurate if its vector of weights $\\mathbf{b}^I$ is equal to the last row of its coefficient matrix $A^I$. For an $s$-stage scheme, this criterion is $\\mathbf{b}^I = A^I_{s,:}$, which means $b^I_j = A^I_{s,j}$ for all $j=1, \\dots, s$.\n\nThe given scheme has $s=2$ stages. The implicit Butcher tableau coefficients are:\n$$\nA^{I} = \\begin{pmatrix} \\frac{1}{3}  0 \\\\ \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix} \\quad \\text{and} \\quad \\mathbf{b}^{I} = \\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}\n$$\nThe number of stages is $s=2$. The last row of the matrix $A^I$ is the second row, $A^I_{2,:}$:\n$$\nA^{I}_{2,:} = \\begin{pmatrix} A^{I}_{2,1}  A^{I}_{2,2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}\n$$\nComparing this with the vector of weights $\\mathbf{b}^I$:\n$$\n\\mathbf{b}^{I} = \\begin{pmatrix} b^{I}_{1}  b^{I}_{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}\n$$\nWe observe that $A^I_{2,:} = \\mathbf{b}^I$. Therefore, the implicit part of the scheme is indeed stiffly accurate.\n\nNext, we conclude whether the one-step update $u^{n+1}$ equals the last implicit stage, $U_s$. With $f \\equiv 0$ and $s=2$, the last stage $U_2$ is given by:\n$$\nU_2 = u^n + \\Delta t \\sum_{j=1}^{2} A^{I}_{2j} g(U_j) = u^n + \\Delta t \\left( A^{I}_{2,1} g(U_1) + A^{I}_{2,2} g(U_2) \\right)\n$$\nThe final update $u^{n+1}$ is given by:\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{2} b^{I}_{i} g(U_i) = u^n + \\Delta t \\left( b^{I}_{1} g(U_1) + b^{I}_{2} g(U_2) \\right)\n$$\nSince the scheme is stiffly accurate, we have $b^{I}_{1} = A^{I}_{2,1}$ and $b^{I}_{2} = A^{I}_{2,2}$. Substituting these equalities into the expression for $u^{n+1}$ yields:\n$$\nu^{n+1} = u^n + \\Delta t \\left( A^{I}_{2,1} g(U_1) + A^{I}_{2,2} g(U_2) \\right)\n$$\nThis expression is identical to the expression for $U_2$. Thus, we can conclude that for this scheme under the condition $f \\equiv 0$, the one-step update is equal to the last implicit stage: $u^{n+1} = U_2$. This is a key benefit of stiffly accurate methods, particularly for problems with stiff boundary conditions or for ensuring stability properties.\n\nFinally, we compute the scalar diagnostic $\\delta$, which quantifies the difference between $\\mathbf{b}^I$ and the last row of $A^I$. The definition is:\n$$\n\\delta = |b^{I}_{1} - A^{I}_{2,1}| + |b^{I}_{2} - A^{I}_{2,2}|\n$$\nWe substitute the values from the provided Butcher tableau:\n- $b^{I}_{1} = \\frac{2}{3}$\n- $b^{I}_{2} = \\frac{1}{3}$\n- $A^{I}_{2,1} = \\frac{2}{3}$\n- $A^{I}_{2,2} = \\frac{1}{3}$\n\nThe calculation proceeds as follows:\n$$\n\\delta = \\left|\\frac{2}{3} - \\frac{2}{3}\\right| + \\left|\\frac{1}{3} - \\frac{1}{3}\\right|\n$$\n$$\n\\delta = |0| + |0|\n$$\n$$\n\\delta = 0\n$$\nThe value $\\delta = 0$ confirms our earlier finding that the implicit part of the scheme is stiffly accurate.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "To solve complex problems efficiently, it is often necessary to adapt the time step size $\\Delta t$ based on the solution's behavior. This is typically achieved using embedded Runge-Kutta pairs, which provide a higher-order and a lower-order solution estimate, with their difference serving as an error indicator. This practice guides you through the process of constructing such an IMEX pair by determining a crucial scheme parameter to satisfy specific order and stability requirements, and then understanding how the resulting error estimate drives an adaptive time-stepping strategy .",
            "id": "3391633",
            "problem": "Consider a semi-discrete Discontinuous Galerkin (DG) approximation of a linear advection-diffusion equation on a periodic domain, written in the additive form\n$$\n\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{f}(\\boldsymbol{u}) + \\boldsymbol{g}(\\boldsymbol{u}),\n$$\nwhere $\\boldsymbol{f}$ denotes the non-stiff convective contribution (to be treated explicitly) and $\\boldsymbol{g}$ denotes the stiff viscous contribution (to be treated implicitly). You are to construct an implicit-explicit (IMEX) Runge-Kutta (RK) embedded pair of orders $(p,p-1) = (2,1)$ for time integration of this semi-discrete system, and to derive an error estimator that blends explicit and implicit residuals for adaptive time-step control.\n\nAdopt a two-stage additive RK structure with stage values $\\boldsymbol{Y}_{i}$, $i \\in \\{1,2\\}$, and time step $\\Delta t$, of the form\n$$\n\\boldsymbol{Y}_{i} = \\boldsymbol{u}^{n} + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{i j} \\, \\boldsymbol{f}(\\boldsymbol{Y}_{j}) + \\Delta t \\sum_{j=1}^{i} a^{\\mathrm{I}}_{i j} \\, \\boldsymbol{g}(\\boldsymbol{Y}_{j}),\n$$\nand the solution update\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t \\sum_{i=1}^{2} b^{\\mathrm{E}}_{i} \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}) + \\Delta t \\sum_{i=1}^{2} b^{\\mathrm{I}}_{i} \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}).\n$$\nTake the explicit part as the two-stage explicit trapezoidal method (also called Heunâ€™s method),\n$$\nA^{\\mathrm{E}} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}, \n\\quad \\boldsymbol{b}^{\\mathrm{E}} = \\begin{pmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{pmatrix}, \n\\quad \\boldsymbol{c}^{\\mathrm{E}} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\nand the implicit part as a two-stage singly diagonally implicit Runge-Kutta (SDIRK) scheme with unknown diagonal parameter $\\gamma$,\n$$\nA^{\\mathrm{I}} = \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \n\\quad \\boldsymbol{b}^{\\mathrm{I}} = \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix}, \n\\quad \\boldsymbol{c}^{\\mathrm{I}} = \\begin{pmatrix} \\gamma \\\\ 1 \\end{pmatrix}.\n$$\nAssume a stiffly accurate implicit part, i.e., the last row of $A^{\\mathrm{I}}$ equals $(\\boldsymbol{b}^{\\mathrm{I}})^{\\top}$ and $c^{\\mathrm{I}}_{2} = 1$. Construct the embedded lower-order $(p-1)=1$ pair by taking the first-order explicit and implicit weights\n$$\n\\widetilde{\\boldsymbol{b}}^{\\mathrm{E}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n\\qquad\n\\widetilde{\\boldsymbol{b}}^{\\mathrm{I}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n\nTasks:\n\n- Starting from the linear test equations $\\boldsymbol{u}' = \\boldsymbol{f}(\\boldsymbol{u})$ and $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$, and the standard Runge-Kutta order conditions up to order $p=2$, determine the exact value of $\\gamma$ that makes the implicit part second order and L-stable when applied to $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$.\n\n- Define the embedded error estimator as the difference of the high-order and low-order IMEX updates,\n$$\n\\boldsymbol{e} = \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{E}}_{i} - \\widetilde{b}^{\\mathrm{E}}_{i}\\bigr) \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}) + \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{I}}_{i} - \\widetilde{b}^{\\mathrm{I}}_{i}\\bigr) \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}),\n$$\nand, for adaptive time stepping in the DG context, introduce a blended scalar indicator that combines explicit and implicit residual contributions,\n$$\n\\eta = \\Bigl( \\alpha \\, \\|\\boldsymbol{e}_{\\mathrm{E}}\\|^{2} + (1-\\alpha)\\, \\|\\boldsymbol{e}_{\\mathrm{I}}\\|^{2} \\Bigr)^{1/2},\n$$\nwhere\n$$\n\\boldsymbol{e}_{\\mathrm{E}} = \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{E}}_{i} - \\widetilde{b}^{\\mathrm{E}}_{i}\\bigr) \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}),\n\\qquad\n\\boldsymbol{e}_{\\mathrm{I}} = \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{I}}_{i} - \\widetilde{b}^{\\mathrm{I}}_{i}\\bigr) \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}),\n$$\nand $\\alpha \\in (0,1)$ is a user-chosen weight. Using leading-order truncation error scaling, justify the step-size controller\n$$\n\\Delta t_{\\mathrm{new}} = \\theta \\, \\Delta t \\, \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2},\n$$\nwith safety factor $\\theta \\in (0,1)$ and tolerance $\\mathrm{TOL}  0$. No numerical evaluation is required for $\\Delta t_{\\mathrm{new}}$.\n\nYour final deliverable is the exact analytic expression for the unique $\\gamma \\in (0,1)$ that enforces second-order accuracy and L-stability of the implicit part. Report only that value as your final answer, in exact form without approximation and without units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, objective, and complete. All given data, variables, and conditions are explicitly defined within the standard framework of numerical analysis for differential equations. The problem is a formal exercise in deriving properties of an implicit-explicit (IMEX) Runge-Kutta scheme, a well-established topic. There are no contradictions, ambiguities, or scientifically unsound premises. The problem is valid.\n\nThe problem is divided into two tasks: first, to determine the parameter $\\gamma$ for the implicit part of the scheme, and second, to justify the proposed adaptive time-step controller.\n\nThe first task is to find the value of $\\gamma \\in (0,1)$ that makes the implicit Runge-Kutta scheme second-order accurate and L-stable when applied to the ordinary differential equation $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$. The implicit scheme is a singly diagonally implicit Runge-Kutta (SDIRK) method described by the Butcher tableau:\n$$\n\\begin{array}{c|c}\n\\boldsymbol{c}^{\\mathrm{I}}  A^{\\mathrm{I}} \\\\\n\\hline\n (\\boldsymbol{b}^{\\mathrm{I}})^{\\top}\n\\end{array}\n=\n\\begin{array}{c|cc}\n\\gamma  \\gamma  0 \\\\\n1  1-\\gamma  \\gamma \\\\\n\\hline\n 1-\\gamma  \\gamma\n\\end{array}\n$$\nThe node vector $\\boldsymbol{c}^{\\mathrm{I}}$ is consistent with the matrix $A^{\\mathrm{I}}$, as $c^{\\mathrm{I}}_1 = a^{\\mathrm{I}}_{11} + a^{\\mathrm{I}}_{12} = \\gamma + 0 = \\gamma$ and $c^{\\mathrm{I}}_2 = a^{\\mathrm{I}}_{21} + a^{\\mathrm{I}}_{22} = (1-\\gamma) + \\gamma = 1$.\n\nThe order conditions for a Runge-Kutta method to be of order $p=2$ are:\n$1$. Order $1$: $\\sum_{i=1}^{s} b^{\\mathrm{I}}_i = 1$.\n$2$. Order $2$: $\\sum_{i=1}^{s} b^{\\mathrm{I}}_i c^{\\mathrm{I}}_i = \\frac{1}{2}$.\n\nHere, $s=2$. We check these conditions for the given implicit scheme.\nFor the first-order condition:\n$$\n\\sum_{i=1}^{2} b^{\\mathrm{I}}_i = b^{\\mathrm{I}}_1 + b^{\\mathrm{I}}_2 = (1-\\gamma) + \\gamma = 1.\n$$\nThis condition is satisfied for any value of $\\gamma$.\n\nFor the second-order condition:\n$$\n\\sum_{i=1}^{2} b^{\\mathrm{I}}_i c^{\\mathrm{I}}_i = b^{\\mathrm{I}}_1 c^{\\mathrm{I}}_1 + b^{\\mathrm{I}}_2 c^{\\mathrm{I}}_2 = (1-\\gamma)(\\gamma) + (\\gamma)(1) = \\gamma - \\gamma^2 + \\gamma = 2\\gamma - \\gamma^2.\n$$\nTo achieve second-order accuracy, this sum must equal $\\frac{1}{2}$:\n$$\n2\\gamma - \\gamma^2 = \\frac{1}{2}.\n$$\nThis can be rewritten as a standard quadratic equation:\n$$\n\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0.\n$$\nUsing the quadratic formula, $\\gamma = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with $a=1$, $b=-2$, and $c=\\frac{1}{2}$:\n$$\n\\gamma = \\frac{2 \\pm \\sqrt{(-2)^2 - 4(1)(\\frac{1}{2})}}{2(1)} = \\frac{2 \\pm \\sqrt{4 - 2}}{2} = \\frac{2 \\pm \\sqrt{2}}{2} = 1 \\pm \\frac{\\sqrt{2}}{2}.\n$$\nThe problem specifies that $\\gamma \\in (0,1)$. The solution $1 + \\frac{\\sqrt{2}}{2} \\approx 1.707$ is outside this interval. The other solution, $1 - \\frac{\\sqrt{2}}{2} \\approx 0.293$, is inside the interval. Therefore, the unique value of $\\gamma$ that ensures second-order accuracy is:\n$$\n\\gamma = 1 - \\frac{\\sqrt{2}}{2}.\n$$\n\nNext, we must verify that this choice of $\\gamma$ results in an L-stable method. L-stability requires that the method is A-stable and its stability function $R(z)$ satisfies $\\lim_{|z| \\to \\infty} |R(z)| = 0$.\n\nThe problem states the method is stiffly accurate, which implies that the numerical solution update coincides with the final stage value. For the linear test equation $u' = \\lambda u$, with $z = \\lambda \\Delta t$, the stability function $R(z)$ is given by the last component of the vector $(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$, where $\\boldsymbol{e}=(1, 1)^{\\top}$.\n$$\n\\boldsymbol{I} - z A^{\\mathrm{I}} = \\begin{pmatrix} 1 - z\\gamma  0 \\\\ -z(1-\\gamma)  1 - z\\gamma \\end{pmatrix}.\n$$\nThe inverse is:\n$$\n(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma  0 \\\\ z(1-\\gamma)  1 - z\\gamma \\end{pmatrix}.\n$$\nThen, $(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$ is:\n$$\n\\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma \\\\ z(1-\\gamma) + (1 - z\\gamma) \\end{pmatrix} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma \\\\ 1 + z(1-2\\gamma) \\end{pmatrix}.\n$$\nThe stability function is the second component of this vector:\n$$\nR(z) = \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2}.\n$$\nFor L-stability, we first check the limit as $|z| \\to \\infty$:\n$$\n\\lim_{|z| \\to \\infty} |R(z)| = \\lim_{|z| \\to \\infty} \\left| \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2} \\right| = \\lim_{|z| \\to \\infty} \\left| \\frac{z(1-2\\gamma)}{z^2\\gamma^2} \\right| = \\lim_{|z| \\to \\infty} \\left| \\frac{1-2\\gamma}{\\gamma^2 z} \\right| = 0.\n$$\nThis condition is satisfied for any $\\gamma \\neq 0$.\n\nNext, we check for A-stability, which requires $|R(z)| \\le 1$ for all $z$ in the left half-plane, $\\mathrm{Re}(z) \\le 0$. By the maximum modulus principle, it is sufficient to check this on the imaginary axis, i.e., $|R(iy)| \\le 1$ for all real $y$.\n$$\n|R(iy)|^2 = \\left| \\frac{1 + iy(1-2\\gamma)}{(1-iy\\gamma)^2} \\right|^2 = \\frac{|1 + iy(1-2\\gamma)|^2}{|(1-iy\\gamma)^2|^2} = \\frac{1 + y^2(1-2\\gamma)^2}{(1+y^2\\gamma^2)^2}.\n$$\nThe condition $|R(iy)|^2 \\le 1$ becomes:\n$$\n1 + y^2(1-2\\gamma)^2 \\le (1+y^2\\gamma^2)^2 = 1 + 2y^2\\gamma^2 + y^4\\gamma^4.\n$$\nSubtracting $1$ from both sides and dividing by $y^2$ (for $y \\neq 0$):\n$$\n(1-2\\gamma)^2 \\le 2\\gamma^2 + y^2\\gamma^4.\n$$\n$$\n1 - 4\\gamma + 4\\gamma^2 \\le 2\\gamma^2 + y^2\\gamma^4.\n$$\n$$\n1 - 4\\gamma + 2\\gamma^2 \\le y^2\\gamma^4.\n$$\nSince this inequality must hold for all real $y$, it must hold as $y \\to 0$. This implies that the left-hand side cannot be positive:\n$$\n2\\gamma^2 - 4\\gamma + 1 \\le 0.\n$$\nThe roots of the quadratic $2\\gamma^2 - 4\\gamma + 1 = 0$ are $\\gamma = 1 \\pm \\frac{\\sqrt{2}}{2}$. Since the parabola opens upwards, the inequality holds for $\\gamma$ between these roots: $1 - \\frac{\\sqrt{2}}{2} \\le \\gamma \\le 1 + \\frac{\\sqrt{2}}{2}$.\nOur value $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ lies on the boundary of this region, satisfying the condition with equality. Thus, the scheme is A-stable. Since both A-stability and the limit condition are met, the scheme is L-stable for $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.\n\nThe second task is to justify the step-size controller. The error estimator $\\boldsymbol{e}$ is the difference between the second-order solution $\\boldsymbol{u}^{n+1}$ and the first-order embedded solution $\\widetilde{\\boldsymbol{u}}^{n+1}$. The local truncation error (LTE) for the higher-order method is $LTE_p = O((\\Delta t)^{p+1}) = O((\\Delta t)^3)$, while for the lower-order method it is $LTE_{p-1} = O((\\Delta t)^p) = O((\\Delta t)^2)$.\nThe error estimate is therefore:\n$$\n\\boldsymbol{e} = \\boldsymbol{u}^{n+1} - \\widetilde{\\boldsymbol{u}}^{n+1} = (\\boldsymbol{u}(t_{n+1}) - \\widetilde{\\boldsymbol{u}}^{n+1}) - (\\boldsymbol{u}(t_{n+1}) - \\boldsymbol{u}^{n+1}) = LTE_{p-1} - LTE_p.\n$$\nFor small $\\Delta t$, the leading term is from the lower-order method:\n$$\n\\boldsymbol{e} \\approx LTE_{p-1} \\approx \\boldsymbol{C} (\\Delta t)^2,\n$$\nwhere $\\boldsymbol{C}$ is a vector that depends on the derivatives of the solution but is assumed to be approximately constant over a single time step. The scalar error indicator $\\eta$ is a norm of the components of $\\boldsymbol{e}$, so its scaling behavior is the same:\n$$\n\\eta \\approx K (\\Delta t)^2,\n$$\nwhere $K$ is a scalar constant. The goal of adaptive time-stepping is to choose a new step size, $\\Delta t_{\\mathrm{new}}$, such that the estimated error for the new step, $\\eta_{\\mathrm{new}}$, is equal to a specified tolerance, $\\mathrm{TOL}$.\nAssuming $K$ is constant, we have:\n$$\n\\eta \\approx K (\\Delta t)^2 \\quad \\text{and} \\quad \\mathrm{TOL} \\approx K (\\Delta t_{\\mathrm{new}})^2.\n$$\nTaking the ratio of these two expressions gives:\n$$\n\\frac{\\mathrm{TOL}}{\\eta} \\approx \\frac{K (\\Delta t_{\\mathrm{new}})^2}{K (\\Delta t)^2} = \\left(\\frac{\\Delta t_{\\mathrm{new}}}{\\Delta t}\\right)^2.\n$$\nSolving for $\\Delta t_{\\mathrm{new}}$ yields:\n$$\n\\Delta t_{\\mathrm{new}} \\approx \\Delta t \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2}.\n$$\nA safety factor $\\theta \\in (0,1)$ is introduced to provide a more conservative step-size update and to account for the approximation, leading to the controller:\n$$\n\\Delta t_{\\mathrm{new}} = \\theta \\, \\Delta t \\, \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2}.\n$$\nThis justifies the form of the proposed controller, with the exponent of $1/2$ arising from the fact that the error estimator scales quadratically with the time step size.\n\nThe final deliverable is the aformentioned value of $\\gamma$.",
            "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$"
        },
        {
            "introduction": "Many physical systems are characterized by processes occurring on vastly different time scales, leading to stiff \"singularly perturbed\" ordinary differential equations. A powerful class of numerical methods, known as Asymptotic Preserving schemes, are designed to remain accurate even when the time step is too large to resolve the fastest time scales. This advanced exercise explores this concept by analyzing an IMEX scheme in the infinitely stiff limit, demonstrating how it correctly transitions to a stable scheme for the underlying slow dynamics on the equilibrium manifold .",
            "id": "3391641",
            "problem": "Consider the linear relaxation ordinary differential equation arising from a Fourier-mode semi-discretization of a split spectral Discontinuous Galerkin (DG) formulation,\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}t} = \\lambda_{E}\\,u + \\frac{1}{\\varepsilon}\\,\\bigl(R(u)-u\\bigr),\n$$\nwhere $u$ is the semi-discrete state, $\\lambda_{E}\\in\\mathbb{C}$ is the nonstiff Fourier symbol of the convective operator, $\\varepsilon0$ is a stiffness parameter, and $R$ is a linear equilibrium projection satisfying $R^{2}=R$. Denote the equilibrium (or relaxed) variable by $v:=R(u)$ so that points on the equilibrium manifold satisfy $R(u)=u$. Time advance is performed by the two-stage implicit-explicit (IMEX) Additive Runge-Kutta scheme of order $2$ of Ascher-Ruuth-Spiteri type, with explicit and diagonally implicit tableaux given by\n$$\nA^{E} = \\begin{pmatrix} 0  0 \\\\ \\gamma  0 \\end{pmatrix}, \n\\qquad\n\\mathbf{b}^{E} = \\begin{pmatrix} b_{1}^{E} \\\\ b_{2}^{E} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{1}{2\\gamma} \\\\ \\frac{1}{2\\gamma} \\end{pmatrix},\n$$\nand\n$$\nA^{I} = \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \n\\qquad\n\\mathbf{b}^{I} = \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix},\n$$\nwith \n$$\n\\gamma = 1 - \\frac{1}{\\sqrt{2}}.\n$$\nLet $\\Delta t0$ be the time step and define the nondimensional parameters $z_{E}:=\\Delta t\\,\\lambda_{E}$ and $z_{I}:=\\Delta t/\\varepsilon$. Apply the above IMEX scheme to the given semi-discrete system.\n\nTask: Compute the limiting stability function $R_{\\mathrm{lim}}(z_{E})$ for the equilibrated variable $v=R(u)$ in the asymptotic regime $z_{I}\\to\\infty$ (with $z_{E}$ fixed), and verify that in this limit each explicit stage acts on equilibrated data satisfying $R(Y_{i})=Y_{i}$. Provide your final answer as a closed-form analytic expression in $z_{E}$ (no units).",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. The provided information is self-contained and sufficient for deriving a solution.\n\nThe given ordinary differential equation (ODE) is\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}t} = \\lambda_{E}\\,u + \\frac{1}{\\varepsilon}\\,\\bigl(R(u)-u\\bigr)\n$$\nThis system is split into a non-stiff (explicit) part $F(u)$ and a stiff (implicit) part $G(u)$:\n$$\nF(u) = \\lambda_{E} u\n$$\n$$\nG(u) = \\frac{1}{\\varepsilon}(R(u) - u)\n$$\nThe time integration is performed using a two-stage implicit-explicit (IMEX) Additive Runge-Kutta scheme. The stage values $Y_i$ are computed as:\n$$\nY_i = u_n + \\Delta t \\sum_{j=1}^{i-1} A^E_{ij} F(Y_j) + \\Delta t \\sum_{j=1}^{s} A^I_{ij} G(Y_j), \\quad i=1, \\dots, s\n$$\nand the solution is updated via\n$$\nu_{n+1} = u_n + \\Delta t \\sum_{i=1}^{s} b^E_i F(Y_i) + \\Delta t \\sum_{i=1}^{s} b^I_i G(Y_i)\n$$\nFor the given two-stage scheme ($s=2$), the explicit and implicit Butcher tableaux are:\n$$\nA^{E} = \\begin{pmatrix} 0  0 \\\\ \\gamma  0 \\end{pmatrix}, \\quad \\mathbf{b}^{E} = \\begin{pmatrix} 1 - \\frac{1}{2\\gamma} \\\\ \\frac{1}{2\\gamma} \\end{pmatrix}\n$$\n$$\nA^{I} = \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \\quad \\mathbf{b}^{I} = \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix}\n$$\nwith $\\gamma = 1 - \\frac{1}{\\sqrt{2}}$.\n\nLet's write out the stage equations explicitly:\nStage $1$:\n$$\nY_1 = u_n + \\Delta t A^I_{11} G(Y_1) = u_n + \\Delta t \\gamma \\frac{1}{\\varepsilon}(R(Y_1) - Y_1)\n$$\nStage $2$:\n$$\nY_2 = u_n + \\Delta t A^E_{21} F(Y_1) + \\Delta t \\left( A^I_{21} G(Y_1) + A^I_{22} G(Y_2) \\right)\n$$\n$$\nY_2 = u_n + \\Delta t \\gamma \\lambda_E Y_1 + \\Delta t \\frac{1-\\gamma}{\\varepsilon}(R(Y_1) - Y_1) + \\Delta t \\frac{\\gamma}{\\varepsilon}(R(Y_2) - Y_2)\n$$\nWe introduce the non-dimensional parameters $z_{E} := \\Delta t \\lambda_{E}$ and $z_{I} := \\Delta t / \\varepsilon$. The stage equations become:\n$$\nY_1 = u_n + z_{I} \\gamma (R(Y_1) - Y_1) \\quad (1)\n$$\n$$\nY_2 = u_n + z_{E} \\gamma Y_1 + z_{I} (1-\\gamma)(R(Y_1) - Y_1) + z_{I} \\gamma(R(Y_2) - Y_2) \\quad (2)\n$$\n\nWe are interested in the asymptotic regime $z_{I} \\to \\infty$ with $z_{E}$ fixed.\n\nFirst, let's analyze Stage $1$. Rearranging equation (1):\n$$\n(1 + z_{I} \\gamma)Y_1 = u_n + z_{I} \\gamma R(Y_1)\n$$\n$$\nY_1 = \\frac{1}{1+z_{I}\\gamma}u_n + \\frac{z_{I}\\gamma}{1+z_{I}\\gamma} R(Y_1)\n$$\nIn the limit $z_{I} \\to \\infty$, the first term vanishes and the coefficient of the second term approaches $1$. Assuming $Y_1$ converges to a limit $Y_{1, \\mathrm{lim}}$, we have:\n$$\nY_{1, \\mathrm{lim}} = \\lim_{z_{I} \\to \\infty} R(Y_1) = R\\left(\\lim_{z_{I} \\to \\infty} Y_1\\right) = R(Y_{1, \\mathrm{lim}})\n$$\nThis shows that in the limit, the stage value $Y_1$ is on the equilibrium manifold, satisfying $R(Y_1)=Y_1$. This verifies the condition for the first stage argument. To find the value of $Y_{1, \\mathrm{lim}}$, we apply the projection operator $R$ to equation (1), leveraging the linearity of $R$ and the property $R^2=R$:\n$$\nR(Y_1) = R(u_n) + z_{I} \\gamma R(R(Y_1) - Y_1) = R(u_n) + z_{I} \\gamma(R^2(Y_1) - R(Y_1)) = R(u_n)\n$$\nTaking the limit $z_{I} \\to \\infty$, we find $\\lim_{z_{I} \\to \\infty} R(Y_1) = R(u_n)$. Since $Y_{1, \\mathrm{lim}} = R(Y_{1, \\mathrm{lim}}) = \\lim_{z_{I} \\to \\infty} R(Y_1)$, it follows that:\n$$\nY_{1, \\mathrm{lim}} = R(u_n)\n$$\n\nNext, we analyze Stage $2$ in the limit $z_{I} \\to \\infty$. Rearranging equation (2):\n$$\n(1 + z_{I} \\gamma)Y_2 = u_n + z_{E} \\gamma Y_1 + z_{I} (1-\\gamma)(R(Y_1) - Y_1) + z_{I} \\gamma R(Y_2)\n$$\nFrom equation (1), we have $R(Y_1) - Y_1 = -\\frac{1}{z_{I} \\gamma}(Y_1-u_n)$. Substituting this into the equation for $Y_2$:\n$$\n(1 + z_{I} \\gamma)Y_2 = u_n + z_{E} \\gamma Y_1 - \\frac{1-\\gamma}{\\gamma}(Y_1-u_n) + z_{I} \\gamma R(Y_2)\n$$\nDividing by $(1+z_{I}\\gamma)$ and taking the limit $z_{I} \\to \\infty$ leads to $Y_{2, \\mathrm{lim}} = R(Y_{2, \\mathrm{lim}})$, verifying the equilibration condition for the second stage. To find its value, we apply the operator $R$ to equation (2):\n$$\nR(Y_2) = R(u_n) + z_{E} \\gamma R(Y_1) + z_{I} (1-\\gamma)R(R(Y_1) - Y_1) + z_{I} \\gamma R(R(Y_2) - Y_2)\n$$\nThe terms involving $z_{I}$ vanish because $R(R(X)-X) = R^2(X)-R(X)=0$. This leaves:\n$$\nR(Y_2) = R(u_n) + z_{E} \\gamma R(Y_1)\n$$\nTaking the limit $z_{I} \\to \\infty$ and using the fact that $\\lim_{z_{I} \\to \\infty} R(Y_1) = R(u_n)$:\n$$\n\\lim_{z_{I} \\to \\infty} R(Y_2) = R(u_n) + z_{E} \\gamma R(u_n) = (1 + z_{E} \\gamma)R(u_n)\n$$\nSince $Y_{2, \\mathrm{lim}} = R(Y_{2, \\mathrm{lim}}) = \\lim_{z_{I} \\to \\infty} R(Y_2)$, we have:\n$$\nY_{2, \\mathrm{lim}} = (1 + z_{E} \\gamma)R(u_n)\n$$\n\nThe problem asks for the limiting stability function for the equilibrated variable $v=R(u)$. The time update for the full variable $u$ is given by:\n$$\nu_{n+1} = u_n + \\Delta t \\left( b^E_1 F(Y_1) + b^E_2 F(Y_2) \\right) + \\Delta t \\left( b^I_1 G(Y_1) + b^I_2 G(Y_2) \\right)\n$$\nWe find the update for $v_{n+1} = R(u_{n+1})$ by applying the projection operator $R$:\n$$\nv_{n+1} = R(u_n) + \\Delta t R\\left( b^E_1 F(Y_1) + b^E_2 F(Y_2) \\right) + \\Delta t R\\left( b^I_1 G(Y_1) + b^I_2 G(Y_2) \\right)\n$$\nLet's analyze the term with the implicit contributions. For any $Y$,\n$$\nR(G(Y)) = R\\left(\\frac{1}{\\varepsilon}(R(Y)-Y)\\right) = \\frac{1}{\\varepsilon}(R^2(Y) - R(Y)) = 0\n$$\nTherefore, the implicit part of the update vanishes when projected onto the equilibrium manifold, regardless of the limit. The update for $v$ simplifies to:\n$$\nv_{n+1} = R(u_n) + \\Delta t R\\left( b^E_1 \\lambda_E Y_1 + b^E_2 \\lambda_E Y_2 \\right) = v_n + z_{E} \\left( b^E_1 R(Y_1) + b^E_2 R(Y_2) \\right)\n$$\nwhere $v_n = R(u_n)$. In the limit $z_{I} \\to \\infty$, we substitute the limiting values for $R(Y_1)$ and $R(Y_2)$:\n$$\nv_{n+1} = v_n + z_{E} \\left( b^E_1 R(u_n) + b^E_2 (1+z_{E}\\gamma)R(u_n) \\right)\n$$\n$$\nv_{n+1} = v_n + z_{E} \\left( b^E_1 v_n + b^E_2 (1+z_{E}\\gamma)v_n \\right)\n$$\n$$\nv_{n+1} = \\left[ 1 + z_{E} b^E_1 + z_{E} b^E_2 (1+z_{E}\\gamma) \\right] v_n\n$$\nThe term in the brackets is the limiting stability function, $R_{\\mathrm{lim}}(z_{E})$:\n$$\nR_{\\mathrm{lim}}(z_{E}) = 1 + z_{E} (b^E_1 + b^E_2) + z_{E}^2 \\gamma b^E_2\n$$\nThe problem provides the values for the coefficients:\n$$\nb^E_1 = 1 - \\frac{1}{2\\gamma}, \\quad b^E_2 = \\frac{1}{2\\gamma}\n$$\nThe sum is $b^E_1 + b^E_2 = 1$. The product is $\\gamma b^E_2 = \\gamma \\left(\\frac{1}{2\\gamma}\\right) = \\frac{1}{2}$.\nSubstituting these values into the expression for $R_{\\mathrm{lim}}(z_{E})$:\n$$\nR_{\\mathrm{lim}}(z_{E}) = 1 + z_{E}(1) + z_{E}^2 \\left(\\frac{1}{2}\\right) = 1 + z_{E} + \\frac{1}{2}z_{E}^2\n$$\nThis expression is the stability function for a standard second-order explicit Runge-Kutta method.",
            "answer": "$$\\boxed{1 + z_{E} + \\frac{1}{2}z_{E}^{2}}$$"
        }
    ]
}