{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes to the heart of mass lumping by linking a quadrature rule's degree of exactness to the diagonality of the mass matrix. You will determine the minimum points needed for exact integration with standard quadrature rules and analyze a common, practical scenario where the rule is slightly inexact. This practice clarifies how a diagonal, albeit approximate, mass matrix arises and allows you to compute the specific error introduced for the highest-order basis function.",
            "id": "3400503",
            "problem": "Consider the one-dimensional reference element $[-1,1]$ and the modal basis $\\{\\phi_{k}\\}_{k=0}^{N}$ defined by $\\phi_{k}(x) = \\sqrt{\\frac{2k+1}{2}}\\,P_{k}(x)$, where $P_{k}(x)$ is the Legendre polynomial of degree $k$. The exact (continuous) mass matrix entries are $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$. By construction, with exact integration, the mass matrix is the identity.\n\nYou are asked to analyze the diagonalization of the mass matrix under quadrature and to quantify the effect of using a suboptimal quadrature rule, starting only from fundamental definitions and widely accepted facts about Legendre polynomials and Gaussian-type quadrature.\n\nTasks:\n1. Using the properties that Gauss-Legendre (GL) quadrature with $Q$ points is exact for polynomials of degree up to $2Q-1$, and Gauss-Lobatto-Legendre (GLL) quadrature with $Q$ points is exact for polynomials of degree up to $2Q-3$ and includes the endpoints, determine the minimal $Q$ (as a function of $N$) required for each rule so that the discrete mass matrix computed by quadrature is exactly diagonal for the chosen modal basis up to degree $N$.\n2. Specialize to GLL with $Q = N+1$ points and prove that the discrete mass matrix remains diagonal but with a modified highest-mode diagonal entry. Use only the following standard facts: \n   - The GLL nodes are $\\{x_{i}\\}_{i=0}^{N}$ consisting of the endpoints $\\pm 1$ and the $N-1$ interior roots of $P'_{N}(x)$.\n   - The associated GLL weights satisfy $w_{0} = w_{N} = \\frac{2}{N(N+1)}$ and, for interior nodes $x_{i}$ with $1 \\le i \\le N-1$, $w_{i} = \\frac{2}{N(N+1)\\,P_{N}(x_{i})^{2}}$.\n   - The endpoint values $P_{N}(\\pm 1) = (\\pm 1)^{N}$.\n   - For degrees $i \\ne j$ with $i+j \\le 2N-1$, the GLL rule with $Q=N+1$ integrates $\\phi_{i}\\phi_{j}$ exactly to zero.\n3. Denote by $M^{\\mathrm{GLL}}_{NN}$ the discrete mass entry for the highest mode computed using GLL with $Q=N+1$. Derive a closed-form expression for $M^{\\mathrm{GLL}}_{NN}$ as a function of $N$.\n\nProvide as your final answer the exact analytic expression for $M^{\\mathrm{GLL}}_{NN}$ in terms of $N$. Do not round. No units are involved. Express your final answer in simplest closed form.",
            "solution": "The discrete mass matrix entries, computed using a quadrature rule with $Q$ points $\\{x_q\\}$ and weights $\\{w_q\\}$, are given by $M^{\\mathrm{Q}}_{ij} = \\sum_{q=0}^{Q-1} w_q \\phi_i(x_q) \\phi_j(x_q)$. This approximates the continuous mass matrix $M_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) dx$, which is the identity matrix, $M_{ij} = \\delta_{ij}$, for the given orthonormal basis.\n\n**Task 1: Minimal quadrature points for a diagonal mass matrix.**\nThe integrand for the mass matrix entry $M_{ij}$ is $\\phi_i(x)\\phi_j(x)$, which is a polynomial of degree up to $N+N = 2N$. For the discrete mass matrix to equal the identity matrix, the quadrature rule must be exact for all polynomials of degree up to $2N$.\n\nFor Gauss-Legendre (GL) quadrature with $Q$ points, the rule is exact for polynomials of degree up to $2Q-1$. We require $2Q-1 \\ge 2N$, which implies $Q \\ge N + 1/2$. The minimal integer number of GL points is $Q = N+1$.\n\nFor Gauss-Lobatto-Legendre (GLL) quadrature with $Q$ points, the rule is exact for polynomials of degree up to $2Q-3$. We require $2Q-3 \\ge 2N$, which implies $Q \\ge N + 3/2$. The minimal integer number of GLL points is $Q = N+2$.\n\n**Task 2: Analysis of the GLL mass matrix with $Q = N+1$ points.**\nThis choice is suboptimal, as the rule is only exact for polynomials of degree up to $2(N+1)-3 = 2N-1$.\n\nFor off-diagonal entries ($i \\ne j$), the integrand $\\phi_i(x)\\phi_j(x)$ has degree $i+j \\le 2N-1$. Since the rule is exact for these degrees, the discrete sum equals the exact integral:\n$$ M^{\\mathrm{GLL}}_{ij} = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x) dx = 0 \\quad \\text{for } i \\ne j $$\nThis confirms the discrete mass matrix is diagonal.\n\nFor diagonal entries ($i = j$), the integrand $\\phi_i(x)^2$ has degree $2i$.\n- For $i < N$, the degree is at most $2(N-1) = 2N-2 < 2N-1$. The rule is exact, so $M^{\\mathrm{GLL}}_{ii} = \\int_{-1}^{1} \\phi_i(x)^2 dx = 1$.\n- For the highest mode, $i=N$, the degree is $2N$, which is greater than the rule's exactness of $2N-1$. The integration is inexact, so $M^{\\mathrm{GLL}}_{NN} \\ne 1$.\n\n**Task 3: Derivation of the expression for $M^{\\mathrm{GLL}}_{NN}$.**\nWe compute $M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\phi_N(x_q)^2 = \\frac{2N+1}{2} \\sum_{q=0}^{N} w_q P_N(x_q)^2$.\nThe sum is split into contributions from the endpoints ($q=0, N$) and the interior points ($q=1, \\dots, N-1$).\nThe contribution from the endpoints is:\n$$ w_0 P_N(x_0)^2 + w_N P_N(x_N)^2 = \\frac{2}{N(N+1)} P_N(-1)^2 + \\frac{2}{N(N+1)} P_N(1)^2 = \\frac{2}{N(N+1)} ((-1)^{2N} + 1^2) = \\frac{4}{N(N+1)} $$\nFor the interior GLL nodes, which are the roots of $P'_N(x)$, the contribution is:\n$$ \\sum_{q=1}^{N-1} w_q P_N(x_q)^2 = \\sum_{q=1}^{N-1} \\left( \\frac{2}{N(N+1)P_N(x_q)^2} \\right) P_N(x_q)^2 = \\sum_{q=1}^{N-1} \\frac{2}{N(N+1)} = \\frac{2(N-1)}{N(N+1)} $$\nThe total sum is:\n$$ \\sum_{q=0}^{N} w_q P_N(x_q)^2 = \\frac{4}{N(N+1)} + \\frac{2(N-1)}{N(N+1)} = \\frac{2N+2}{N(N+1)} = \\frac{2}{N} $$\nFinally, we find $M^{\\mathrm{GLL}}_{NN}$:\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{2} \\left( \\sum_{q=0}^{N} w_q P_N(x_q)^2 \\right) = \\frac{2N+1}{2} \\cdot \\frac{2}{N} = \\frac{2N+1}{N} $$\nThis can also be written as $2 + 1/N$, showing the error introduced by the inexact quadrature for the highest mode.",
            "answer": "$$\\boxed{\\frac{2N+1}{N}}$$"
        },
        {
            "introduction": "Building on foundational principles, this exercise generalizes the concept to Discontinuous Galerkin methods on curvilinear elements, where the Jacobian $J$ of the geometric mapping adds complexity. This practice challenges you to derive the required degree of exactness for a cubature rule by carefully accounting for the total polynomial degree of the full integrand. This skill is crucial for implementing accurate schemes on complex geometries, where both the basis functions and the geometry itself contribute to the integration challenge.",
            "id": "3397960",
            "problem": "Let $\\hat{K}$ denote the reference tetrahedron and let $K$ be a curvilinear tetrahedral element obtained by an isoparametric polynomial mapping of total degree $r \\geq 1$, so that the Jacobian determinant $J(\\hat{\\boldsymbol{x}})$ is a polynomial of total degree at most $3(r-1)$ in the reference coordinates $\\hat{\\boldsymbol{x}} \\in \\hat{K}$. Consider a Discontinuous Galerkin (DG) method on $K$ with a nodal Lagrange basis $\\{\\ell_i\\}_{i=1}^{M}$ associated with an unisolvent set of interpolation nodes $\\{\\hat{\\boldsymbol{x}}_i\\}_{i=1}^{M}$ for the polynomial space $\\mathbb{P}_N(\\hat{K})$ of total degree at most $N$, where $M = \\dim \\mathbb{P}_N(\\hat{K})$.\n\nThe exact mass matrix has entries\n$$\nM_{ij} = \\int_{\\hat{K}} \\ell_i(\\hat{\\boldsymbol{x}})\\,\\ell_j(\\hat{\\boldsymbol{x}})\\,J(\\hat{\\boldsymbol{x}})\\,d\\hat{\\boldsymbol{x}}.\n$$\nA quadrature-based mass lumping is proposed by choosing a cubature rule with nodes equal to the interpolation nodes $\\{\\hat{\\boldsymbol{x}}_i\\}_{i=1}^{M}$ and positive weights $\\{w_i\\}_{i=1}^{M}$, leading to the approximated mass matrix\n$$\n\\tilde{M}_{ij} = \\sum_{a=1}^{M} w_a\\,J(\\hat{\\boldsymbol{x}}_a)\\,\\ell_i(\\hat{\\boldsymbol{x}}_a)\\,\\ell_j(\\hat{\\boldsymbol{x}}_a).\n$$\nBy the Kronecker-delta property of nodal Lagrange basis functions, $\\tilde{M}$ is diagonal with entries $\\tilde{M}_{ii} = w_i\\,J(\\hat{\\boldsymbol{x}}_i)$. To formalize the requirement that this diagonalization “remains exact for $\\mathbb{P}_N$,” impose that for every $p \\in \\mathbb{P}_N(\\hat{K})$, the quadrature reproduces the weighted $L^2$ norm:\n$$\n\\int_{\\hat{K}} p(\\hat{\\boldsymbol{x}})^2\\,J(\\hat{\\boldsymbol{x}})\\,d\\hat{\\boldsymbol{x}} \\;=\\; \\sum_{a=1}^{M} w_a\\,J(\\hat{\\boldsymbol{x}}_a)\\,p(\\hat{\\boldsymbol{x}}_a)^2.\n$$\n\nAssume the cubature rule is exact for all polynomials on $\\hat{K}$ of total degree at most $q$ and that the nodes $\\{\\hat{\\boldsymbol{x}}_i\\}_{i=1}^{M}$ are unisolvent for $\\mathbb{P}_N(\\hat{K})$ so that the nodal basis is well-defined. Determine, in closed form and in terms of $N$ and $r$, the minimal algebraic exactness degree $q$ sufficient to guarantee the above identity holds for all $p \\in \\mathbb{P}_N(\\hat{K})$. Your final answer must be a single analytic expression. No rounding is required.",
            "solution": "The central task is to find the minimal integer $q$, representing the algebraic degree of exactness for a cubature rule, that is sufficient to guarantee the identity:\n$$\n\\int_{\\hat{K}} p(\\hat{\\boldsymbol{x}})^2\\,J(\\hat{\\boldsymbol{x}})\\,d\\hat{\\boldsymbol{x}} \\;=\\; \\sum_{a=1}^{M} w_a\\,J(\\hat{\\boldsymbol{x}}_a)\\,p(\\hat{\\boldsymbol{x}}_a)^2\n$$\nfor all polynomials $p \\in \\mathbb{P}_N(\\hat{K})$.\n\nThe given cubature rule (nodes $\\{\\hat{\\boldsymbol{x}}_a\\}$ and weights $\\{w_a\\}$) is exact for any polynomial $\\phi(\\hat{\\boldsymbol{x}})$ of total degree at most $q$:\n$$\n\\int_{\\hat{K}} \\phi(\\hat{\\boldsymbol{x}})\\,d\\hat{\\boldsymbol{x}} \\;=\\; \\sum_{a=1}^{M} w_a\\,\\phi(\\hat{\\boldsymbol{x}}_a)\n$$\nThe identity we must satisfy can be seen as applying this cubature rule to the function $F_p(\\hat{\\boldsymbol{x}}) = p(\\hat{\\boldsymbol{x}})^2 J(\\hat{\\boldsymbol{x}})$. For the identity to hold for all $p \\in \\mathbb{P}_N(\\hat{K})$, a sufficient condition is that the cubature rule must be exact for all possible functions $F_p(\\hat{\\boldsymbol{x}})$ that can be formed. This means the degree of exactness $q$ must be at least the maximum possible polynomial degree of $F_p(\\hat{\\boldsymbol{x}})$.\n\nWe determine the maximum degree of $F_p(\\hat{\\boldsymbol{x}})$ by summing the degrees of its factors:\n$$\n\\deg(F_p) = \\deg(p^2) + \\deg(J)\n$$\n1.  The polynomial $p(\\hat{\\boldsymbol{x}})$ is an element of $\\mathbb{P}_N(\\hat{K})$, so its maximum total degree is $N$. The degree of its square, $p(\\hat{\\boldsymbol{x}})^2$, is therefore at most $2N$.\n    $$\n    \\max_{p \\in \\mathbb{P}_N(\\hat{K})} \\deg(p^2) = 2N\n    $$\n2.  The Jacobian determinant $J(\\hat{\\boldsymbol{x}})$ arises from an isoparametric mapping of total degree $r$. The problem states that its degree is at most $3(r-1)$.\n    $$\n    \\deg(J) \\le 3(r-1)\n    $$\nThe maximum possible total degree of the integrand $F_p(\\hat{\\boldsymbol{x}})$ is the sum of the maximum degrees of its factors:\n$$\n\\max_{p \\in \\mathbb{P}_N(\\hat{K})} \\deg(F_p) = 2N + 3(r-1)\n$$\nFor the cubature rule to be exact for every possible $F_p(\\hat{\\boldsymbol{x}})$, its degree of exactness $q$ must be at least this maximum possible degree. The minimal sufficient value for $q$ is therefore this maximum value.\n$$\nq = 2N + 3(r-1)\n$$",
            "answer": "$$\\boxed{2N + 3(r-1)}$$"
        },
        {
            "introduction": "After establishing conditions for exactness, this final exercise quantifies the consequences when those conditions are not met. This practice provides a concrete, quantitative answer by asking you to compute the error in an $L^2$ projection that results from using an insufficient quadrature rule. You will see firsthand how aliasing errors manifest and how to measure the resulting loss of accuracy in the $L^2$ norm, providing a tangible understanding of the trade-offs involved in mass lumping.",
            "id": "3397913",
            "problem": "Consider the reference interval $[-1,1]$ equipped with the standard $L^{2}$ inner product $\\langle f,g\\rangle=\\int_{-1}^{1} f(x)g(x)\\,dx$. Let $\\{P_{k}(x)\\}_{k\\geq 0}$ denote the Legendre polynomials in their standard normalization, so that $\\int_{-1}^{1} P_{i}(x)P_{j}(x)\\,dx=\\frac{2}{2i+1}\\,\\delta_{ij}$.\n\nLet $N=2$ and define $u(x)=P_{2}(x)$ and $v(x)=P_{2}(x)$, so that $g(x)=u(x)v(x)=P_{2}(x)^{2}$ is a polynomial of degree $4$. Let $\\Pi_{L^{2}} g$ denote the exact $L^{2}$ projection of $g$ onto the polynomial subspace $P_{2}$ (the span of $\\{P_{0},P_{1},P_{2}\\}$), and let $\\Pi_{q} g$ denote the projection obtained by replacing all inner products with Legendre-Gauss-Lobatto (LGL) quadrature with $N+1=3$ nodes. Specifically, the LGL nodes and weights are\n$$\nx_{0}=-1,\\quad x_{1}=0,\\quad x_{2}=1,\\qquad w_{0}=\\frac{1}{3},\\quad w_{1}=\\frac{4}{3},\\quad w_{2}=\\frac{1}{3}.\n$$\nThe exact coefficients $c_{i}^{\\ast}$ of $\\Pi_{L^{2}} g=\\sum_{i=0}^{2} c_{i}^{\\ast} P_{i}$ are defined by\n$$\nc_{i}^{\\ast}=\\frac{2i+1}{2}\\int_{-1}^{1} g(x)\\,P_{i}(x)\\,dx,\n$$\nwhile the quadrature-induced coefficients $c_{i}^{q}$ of $\\Pi_{q} g=\\sum_{i=0}^{2} c_{i}^{q} P_{i}$ are defined by\n$$\nc_{i}^{q}=\\frac{2i+1}{2}\\sum_{q=0}^{2} w_{q}\\,g(x_{q})\\,P_{i}(x_{q}).\n$$\n\nUsing these definitions, compute the $L^{2}$-norm of the projection error\n$$\nE=\\|\\Pi_{q} g-\\Pi_{L^{2}} g\\|_{L^{2}([-1,1])},\n$$\nand express your result as a single exact analytic expression. Do not round the final answer.",
            "solution": "The quantity to compute is the $L^2$-norm of the projection error, $E = \\|\\Pi_{q} g - \\Pi_{L^{2}} g\\|_{L^{2}}$. Due to the orthogonality of the Legendre polynomials $\\{P_i\\}$, the squared norm is given by:\n$$\nE^{2} = \\left\\| \\sum_{i=0}^{2} (c_{i}^{q} - c_{i}^{\\ast}) P_{i}(x) \\right\\|_{L^{2}}^{2} = \\sum_{i=0}^{2} (c_{i}^{q} - c_{i}^{\\ast})^{2} \\int_{-1}^{1} P_{i}(x)^{2} dx = \\sum_{i=0}^{2} (c_{i}^{q} - c_{i}^{\\ast})^{2} \\frac{2}{2i+1}\n$$\nWe must compute the exact coefficients $c_{i}^{\\ast}$ and the quadrature-based coefficients $c_{i}^{q}$.\n\n**1. Exact Coefficients ($c_{i}^{\\ast}$):**\nThe function to project is $g(x) = P_{2}(x)^{2}$. Using the known product-to-sum formula for Legendre polynomials, we can express $g(x)$ in the Legendre basis:\n$$\ng(x) = P_{2}(x)^{2} = \\frac{1}{5}P_{0}(x) + \\frac{2}{7}P_{2}(x) + \\frac{18}{35}P_{4}(x)\n$$\nThe exact $L^{2}$ projection of $g(x)$ onto the subspace spanned by $\\{P_0, P_1, P_2\\}$ is obtained by truncating this series:\n$$\n\\Pi_{L^{2}} g(x) = \\frac{1}{5}P_{0}(x) + \\frac{2}{7}P_{2}(x)\n$$\nThus, the exact coefficients are:\n$c_{0}^{\\ast} = \\frac{1}{5}$, $c_{1}^{\\ast} = 0$, $c_{2}^{\\ast} = \\frac{2}{7}$.\n\n**2. Quadrature-based Coefficients ($c_{i}^{q}$):**\nWe use the 3-point LGL rule with nodes $x \\in \\{-1, 0, 1\\}$ and weights $w \\in \\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\}$. We evaluate $g(x)=P_2(x)^2$ and the basis functions at these nodes:\n- $g(-1)=1, g(0)=1/4, g(1)=1$\n- $P_{0}(x)=1$ for all nodes.\n- $P_{1}(-1)=-1, P_{1}(0)=0, P_{1}(1)=1$\n- $P_{2}(-1)=1, P_{2}(0)=-1/2, P_{2}(1)=1$\n\nThe coefficients are computed as $c_{i}^{q}=\\frac{2i+1}{2}\\sum_{q=0}^{2} w_{q}\\,g(x_{q})\\,P_{i}(x_{q})$:\n- $c_{0}^{q}=\\frac{1}{2}\\left[ \\frac{1}{3}(1)(1) + \\frac{4}{3}(\\frac{1}{4})(1) + \\frac{1}{3}(1)(1) \\right] = \\frac{1}{2}\\left( \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{3} \\right) = \\frac{1}{2}$\n- $c_{1}^{q}=\\frac{3}{2}\\left[ \\frac{1}{3}(1)(-1) + \\frac{4}{3}(\\frac{1}{4})(0) + \\frac{1}{3}(1)(1) \\right] = 0$\n- $c_{2}^{q}=\\frac{5}{2}\\left[ \\frac{1}{3}(1)(1) + \\frac{4}{3}(\\frac{1}{4})(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) \\right] = \\frac{5}{2}\\left( \\frac{1}{3} - \\frac{1}{6} + \\frac{1}{3} \\right) = \\frac{5}{4}$\nSo, the approximate coefficients are: $c_{0}^{q} = \\frac{1}{2}$, $c_{1}^{q} = 0$, $c_{2}^{q} = \\frac{5}{4}$.\n\n**3. Error Norm Calculation:**\nWe find the differences in coefficients:\n- $\\Delta c_{0} = c_{0}^{q} - c_{0}^{\\ast} = \\frac{1}{2} - \\frac{1}{5} = \\frac{3}{10}$\n- $\\Delta c_{1} = c_{1}^{q} - c_{1}^{\\ast} = 0 - 0 = 0$\n- $\\Delta c_{2} = c_{2}^{q} - c_{2}^{\\ast} = \\frac{5}{4} - \\frac{2}{7} = \\frac{27}{28}$\n\nSubstitute into the error formula:\n$$\nE^{2} = \\left(\\frac{3}{10}\\right)^{2}(2) + (0)^{2}\\left(\\frac{2}{3}\\right) + \\left(\\frac{27}{28}\\right)^{2}\\left(\\frac{2}{5}\\right) = \\frac{18}{100} + \\frac{1458}{3920} = \\frac{9}{50} + \\frac{729}{1960}\n$$\n$$\nE^{2} = \\frac{1764}{9800} + \\frac{3645}{9800} = \\frac{5409}{9800}\n$$\nThe error norm is the square root:\n$$\nE = \\sqrt{\\frac{5409}{9800}} = \\frac{\\sqrt{9 \\cdot 601}}{\\sqrt{4900 \\cdot 2}} = \\frac{3\\sqrt{601}}{70\\sqrt{2}} = \\frac{3\\sqrt{1202}}{140}\n$$",
            "answer": "$$\\boxed{\\frac{3\\sqrt{1202}}{140}}$$"
        }
    ]
}