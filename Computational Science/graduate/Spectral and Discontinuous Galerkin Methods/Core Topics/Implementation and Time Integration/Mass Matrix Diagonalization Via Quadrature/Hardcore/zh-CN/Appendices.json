{
    "hands_on_practices": [
        {
            "introduction": "对于显式时间步进方案，对角质量矩阵是高效计算的关键。本练习将探讨数值求积实现这一目标的确切条件。我们将确定所需的最少求积点数，并分析在一种常见的实际情况下，使用略微不精确的求积规则所产生的“误差”，从而揭示效率与精度之间的一个关键权衡 。",
            "id": "3400503",
            "problem": "考虑一维参考单元 $[-1,1]$ 和由 $\\phi_{k}(x) = \\sqrt{\\frac{2k+1}{2}}\\,P_{k}(x)$ 定义的模态基 $\\{\\phi_{k}\\}_{k=0}^{N}$，其中 $P_{k}(x)$ 是 $k$ 次勒让德多项式。精确（连续）质量矩阵的项为 $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$。根据构造，在精确积分下，该质量矩阵是单位矩阵。\n\n要求您分析该质量矩阵在求积法下的对角化，并仅从勒让德多项式和高斯型求积的基本定义和广泛接受的事实出发，量化使用次优求积法则的影响。\n\n任务：\n1. 利用具有 $Q$ 个点的高斯-勒让德（GL）求积对次数最高为 $2Q-1$ 的多项式是精确的，以及具有 $Q$ 个点的高斯-洛巴托-勒让德（GLL）求积对次数最高为 $2Q-3$ 的多项式是精确的且包含端点这些性质，确定每种法则所需的最小 $Q$ 值（作为 $N$ 的函数），以使得对于所选的最高次数为 $N$ 的模态基，通过求积计算出的离散质量矩阵是精确对角的。\n2. 特别考虑使用 $Q = N+1$ 个点的 GLL 求积，并证明离散质量矩阵保持对角，但其最高阶模态的对角项被修正。仅使用以下标准事实：\n   - GLL 节点 $\\{x_{i}\\}_{i=0}^{N}$ 由端点 $\\pm 1$ 和 $P'_{N}(x)$ 的 $N-1$ 个内部根组成。\n   - 相应的 GLL 权重满足 $w_{0} = w_{N} = \\frac{2}{N(N+1)}$，对于内部节点 $x_{i}$（$1 \\le i \\le N-1$），权重为 $w_{i} = \\frac{2}{N(N+1)\\,P_{N}(x_{i})^{2}}$。\n   - 端点值 $P_{N}(\\pm 1) = (\\pm 1)^{N}$。\n   - 对于次数 $i \\ne j$ 且 $i+j \\le 2N-1$，具有 $Q=N+1$ 个点的 GLL 法则将 $\\phi_{i}\\phi_{j}$ 精确地积分为零。\n3. 用 $M^{\\mathrm{GLL}}_{NN}$ 表示使用 $Q=N+1$ 的 GLL 求积计算的最高阶模态的离散质量项。推导 $M^{\\mathrm{GLL}}_{NN}$ 作为 $N$ 的函数的闭式表达式。\n\n请提供 $M^{\\mathrm{GLL}}_{NN}$ 关于 $N$ 的精确解析表达式作为最终答案。不要四舍五入。不涉及单位。以最简闭式形式表示您的最终答案。",
            "solution": "问题陈述已通过验证，被认为是有效的。这是一个在数值分析领域（具体涉及谱方法）的适定且有科学依据的问题。所有定义和性质都是标准的，并得到了一致的应用。\n\n该问题要求分析使用在参考区间 $[-1, 1]$ 上的归一化勒让德多项式模态基构建的离散质量矩阵。使用具有 $Q$ 个点 $\\{x_q\\}$ 和权重 $\\{w_q\\}$ 的求积法则计算的离散质量矩阵项由下式给出：\n$$ M^{\\mathrm{Q}}_{ij} = \\sum_{q=0}^{Q-1} w_q \\phi_i(x_q) \\phi_j(x_q) $$\n这近似于连续质量矩阵 $M_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) dx$。基函数为 $\\phi_k(x) = \\sqrt{\\frac{2k+1}{2}} P_k(x)$，其中 $P_k(x)$ 是 $k$ 次勒让德多项式。由于勒让德多项式的正交性 $\\int_{-1}^{1} P_i(x) P_j(x) dx = \\frac{2}{2i+1} \\delta_{ij}$，连续质量矩阵是单位矩阵：\n$$ M_{ij} = \\sqrt{\\frac{2i+1}{2}} \\sqrt{\\frac{2j+1}{2}} \\int_{-1}^{1} P_i(x) P_j(x) dx = \\frac{\\sqrt{(2i+1)(2j+1)}}{2} \\frac{2}{2i+1} \\delta_{ij} = \\delta_{ij} $$\n我们现在来解决提出的三个任务。\n\n任务1：使质量矩阵为对角矩阵所需的最小求积点数。\n质量矩阵项 $M_{ij}$ 的被积函数是 $\\phi_i(x)\\phi_j(x)$。这个乘积是一个次数为 $i+j$ 的多项式。对于一个最高次数为 $N$ 的多项式基，索引 $i$ 和 $j$ 的范围是从 $0$ 到 $N$。因此，待积分多项式的最高次数是 $N+N = 2N$，这发生在乘积 $\\phi_N(x)\\phi_N(x)$ 的情况。为了使离散质量矩阵精确对角（并等于单位矩阵），求积法则必须对所有多项式乘积 $\\phi_i(x)\\phi_j(x)$（其中 $0 \\le i, j \\le N$）都是精确的。这要求该法则对次数最高为 $2N$ 的多项式是精确的。\n\n对于具有 $Q$ 个点的高斯-勒让德（GL）求积，该法则对次数最高为 $2Q-1$ 的多项式是精确的。为确保对 $2N$ 次多项式的精确性，我们需要：\n$$ 2Q-1 \\ge 2N $$\n$$ 2Q \\ge 2N+1 $$\n$$ Q \\ge N + \\frac{1}{2} $$\n由于点数 $Q$ 必须是整数，所以 GL 求积点的最小数量是 $Q = N+1$。\n\n对于具有 $Q$ 个点的高斯-洛巴托-勒让德（GLL）求积，该法则对次数最高为 $2Q-3$ 的多项式是精确的。为确保对 $2N$ 次多项式的精确性，我们需要：\n$$ 2Q-3 \\ge 2N $$\n$$ 2Q \\ge 2N+3 $$\n$$ Q \\ge N + \\frac{3}{2} $$\n由于 $Q$ 必须是整数，所以 GLL 求积点的最小数量是 $Q = N+2$。\n\n任务2：使用 $Q = N+1$ 个点的 GLL 质量矩阵分析。\n正如任务1所确定的，为 GLL 求积选择 $Q=N+1$ 个点是次优的。该法则对次数最高为 $2(N+1)-3 = 2N-1$ 的多项式是精确的。\n\n我们分析离散质量矩阵项 $M^{\\mathrm{GLL}}_{ij} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)\\phi_{j}(x_q)$。\n\n对于非对角项（$i \\ne j$，其中 $0 \\le i, j \\le N$）：\n被积函数 $\\phi_i(x)\\phi_j(x)$ 的次数是 $i+j$。可能的最大次数出现在 $(i,j) = (N, N-1)$ 或 $(N-1, N)$ 时，为 $2N-1$。对于所有其他 $i \\ne j$ 的配对，次数 $i+j$ 小于 $2N-1$。由于该求积法则对次数最高为 $2N-1$ 的多项式是精确的，因此对于所有非对角项，离散和等于精确积分：\n$$ M^{\\mathrm{GLL}}_{ij} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)\\phi_{j}(x_q) = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x) dx = \\delta_{ij} = 0 \\quad \\text{for } i \\ne j $$\n这证实了离散质量矩阵是对角的。\n\n对于对角项（$i = j$）：\n被积函数 $\\phi_i(x)^2$ 的次数是 $2i$。\n对于 $i  N$，最高次数为 $2(N-1) = 2N-2$。由于 $2N-2  2N-1$，求积法则对这些项是精确的。\n$$ M^{\\mathrm{GLL}}_{ii} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)^2 = \\int_{-1}^{1} \\phi_i(x)^2 dx = 1 \\quad \\text{for } i = 0, 1, \\dots, N-1 $$\n对于最高阶模态 $i=N$，被积函数 $\\phi_N(x)^2$ 的次数为 $2N$。由于 $2N > 2N-1$，求积法则对该项不精确。因此，$M^{\\mathrm{GLL}}_{NN}$ 的值通常不等于 $1$。这证明了该矩阵是对角的，但最高阶模态的项 $M^{\\mathrm{GLL}}_{NN}$ 经过了特别修正。\n\n任务3：推导 $M^{\\mathrm{GLL}}_{NN}$ 的表达式。\n我们试图使用具有 $Q=N+1$ 个点、节点 $\\{x_q\\}_{q=0}^N$ 和权重 $\\{w_q\\}_{q=0}^N$ 的 GLL 求积法则来计算 $M^{\\mathrm{GLL}}_{NN}$ 的值。\n$$ M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\phi_N(x_q)^2 $$\n代入定义 $\\phi_N(x) = \\sqrt{\\frac{2N+1}{2}} P_N(x)$，我们得到：\n$$ M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\left( \\sqrt{\\frac{2N+1}{2}} P_N(x_q) \\right)^2 = \\frac{2N+1}{2} \\sum_{q=0}^{N} w_q P_N(x_q)^2 $$\n我们通过将其分解为端点贡献（$q=0, N$）和内部点贡献（$q=1, \\dots, N-1$）来计算这个和。\nGLL 网格的端点是 $x_0 = -1$ 和 $x_N = 1$。相应的权重由 $w_0 = w_N = \\frac{2}{N(N+1)}$ 给出。\n勒让德多项式的端点值为 $P_N(1) = 1$ 和 $P_N(-1) = (-1)^N$。\n来自端点的贡献是：\n$$ w_0 P_N(x_0)^2 + w_N P_N(x_N)^2 = \\frac{2}{N(N+1)} P_N(-1)^2 + \\frac{2}{N(N+1)} P_N(1)^2 $$\n$$ = \\frac{2}{N(N+1)} ((-1)^N)^2 + \\frac{2}{N(N+1)} (1)^2 = \\frac{2}{N(N+1)} (1+1) = \\frac{4}{N(N+1)} $$\n内部 GLL 节点 $\\{x_q\\}_{q=1}^{N-1}$ 是 $P'_N(x)$ 的根。这些节点的权重由 $w_q = \\frac{2}{N(N+1)P_N(x_q)^2}$ 给出。\n来自内部点的贡献是：\n$$ \\sum_{q=1}^{N-1} w_q P_N(x_q)^2 = \\sum_{q=1}^{N-1} \\left( \\frac{2}{N(N+1)P_N(x_q)^2} \\right) P_N(x_q)^2 $$\n$P_N(x_q)^2$ 项被消去，剩下：\n$$ \\sum_{q=1}^{N-1} \\frac{2}{N(N+1)} $$\n这是一个常数项在 $N-1$ 个索引上的和。\n$$ (N-1) \\times \\frac{2}{N(N+1)} = \\frac{2(N-1)}{N(N+1)} $$\n总和是端点贡献和内部点贡献之和：\n$$ \\sum_{q=0}^{N} w_q P_N(x_q)^2 = \\frac{4}{N(N+1)} + \\frac{2(N-1)}{N(N+1)} = \\frac{4 + 2N - 2}{N(N+1)} = \\frac{2N+2}{N(N+1)} = \\frac{2(N+1)}{N(N+1)} = \\frac{2}{N} $$\n最后，我们将此结果代回 $M^{\\mathrm{GLL}}_{NN}$ 的表达式中：\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{2} \\left( \\sum_{q=0}^{N} w_q P_N(x_q)^2 \\right) = \\frac{2N+1}{2} \\cdot \\frac{2}{N} $$\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{N} $$\n这也可以写成 $2 + \\frac{1}{N}$。这就是最高阶模态对角项的闭式表达式。",
            "answer": "$$\\boxed{\\frac{2N+1}{N}}$$"
        },
        {
            "introduction": "基于前一个练习，我们现在来研究质量集中近似所带来的实际后果。虽然对角质量矩阵简化了计算，但我们发现的微小不精确性会影响其他数值运算。本练习通过计算一个 $L^2$ 投影中引入的误差，提供了一个具体的例子，将抽象的矩阵元素误差与可感知的精度损失联系起来 。",
            "id": "3397913",
            "problem": "考虑参考区间 $[-1,1]$，其上配备了标准 $L^{2}$ 内积 $\\langle f,g\\rangle=\\int_{-1}^{1} f(x)g(x)\\,dx$。令 $\\{P_{k}(x)\\}_{k\\geq 0}$ 表示 Legendre 多项式，采用其标准归一化，使得 $\\int_{-1}^{1} P_{i}(x)P_{j}(x)\\,dx=\\frac{2}{2i+1}\\,\\delta_{ij}$。\n\n令 $N=2$ 并定义 $u(x)=P_{2}(x)$ 和 $v(x)=P_{2}(x)$，因此 $g(x)=u(x)v(x)=P_{2}(x)^{2}$ 是一个 4 次多项式。令 $\\Pi_{L^{2}} g$ 表示 $g$ 到多项式子空间 $P_{2}$（由 $\\{P_{0},P_{1},P_{2}\\}$ 张成的空间）上的精确 $L^{2}$ 投影，并令 $\\Pi_{q} g$ 表示通过将所有内积替换为使用 $N+1=3$ 个节点的 Legendre–Gauss–Lobatto (LGL) 求积所获得的投影。具体来说，LGL 节点和权重为\n$$\nx_{0}=-1,\\quad x_{1}=0,\\quad x_{2}=1,\\qquad w_{0}=\\frac{1}{3},\\quad w_{1}=\\frac{4}{3},\\quad w_{2}=\\frac{1}{3}.\n$$\n$\\Pi_{L^{2}} g=\\sum_{i=0}^{2} c_{i}^{\\ast} P_{i}$ 的精确系数 $c_{i}^{\\ast}$ 定义为\n$$\nc_{i}^{\\ast}=\\frac{2i+1}{2}\\int_{-1}^{1} g(x)\\,P_{i}(x)\\,dx,\n$$\n而 $\\Pi_{q} g=\\sum_{i=0}^{2} c_{i}^{q} P_{i}$ 的由求积导出的系数 $c_{i}^{q}$ 定义为\n$$\nc_{i}^{q}=\\frac{2i+1}{2}\\sum_{q=0}^{2} w_{q}\\,g(x_{q})\\,P_{i}(x_{q}).\n$$\n\n使用这些定义，计算投影误差的 $L^{2}$ 范数\n$$\nE=\\|\\Pi_{q} g-\\Pi_{L^{2}} g\\|_{L^{2}([-1,1])},\n$$\n并将结果表示为单一的精确解析表达式。不要对最终答案进行四舍五入。",
            "solution": "本题旨在计算精确 $L^2$ 投影与使用次精确 LGL 求积规则计算的近似投影之间的误差。误差 $E$ 定义为两个投影之差的 $L^2$ 范数：\n$$\nE = \\|\\Pi_{q} g - \\Pi_{L^{2}} g\\|_{L^{2}([-1,1])} = \\left\\| \\sum_{i=0}^{2} (c_{i}^{q} - c_{i}^{\\ast}) P_{i}(x) \\right\\|_{L^{2}}\n$$\n利用勒让德多项式的正交性 $\\int_{-1}^{1} P_{i}(x)P_{j}(x)\\,dx = \\frac{2}{2i+1}\\,\\delta_{ij}$，范数的平方可以表示为系数误差的加权和：\n$$\nE^{2} = \\sum_{i=0}^{2} (c_{i}^{q} - c_{i}^{\\ast})^{2} \\int_{-1}^{1} P_{i}(x)^{2} dx = \\sum_{i=0}^{2} (c_{i}^{q} - c_{i}^{\\ast})^{2} \\frac{2}{2i+1}\n$$\n为了计算 $E$，我们必须分别计算精确系数 $c_{i}^{\\ast}$ 和近似系数 $c_{i}^{q}$。\n\n**1. 计算精确系数 $c_{i}^{\\ast}$**\n\n首先，我们将待投影函数 $g(x) = P_{2}(x)^{2}$ 展开为勒让德级数。使用 $P_{2}(x) = \\frac{1}{2}(3x^{2} - 1)$，我们有：\n$$\ng(x) = \\left( \\frac{1}{2}(3x^{2} - 1) \\right)^{2} = \\frac{1}{4}(9x^{4} - 6x^{2} + 1)\n$$\n利用已知的 $x$ 的幂次与勒让德多项式的关系，可以得到 $g(x)$ 的展开式：\n$$\ng(x) = \\frac{1}{5}P_{0}(x) + \\frac{2}{7}P_{2}(x) + \\frac{18}{35}P_{4}(x)\n$$\n$g(x)$ 到多项式空间 $P_2 = \\text{span}\\{P_0, P_1, P_2\\}$ 上的精确 $L^2$ 投影 $\\Pi_{L^{2}} g$ 就是截断上述级数，舍弃高阶项：\n$$\n\\Pi_{L^{2}} g(x) = \\frac{1}{5}P_{0}(x) + \\frac{2}{7}P_{2}(x)\n$$\n因此，精确投影的系数为：\n$c_{0}^{\\ast} = \\frac{1}{5}$， $c_{1}^{\\ast} = 0$， $c_{2}^{\\ast} = \\frac{2}{7}$。\n\n**2. 计算近似系数 $c_{i}^{q}$**\n\n近似系数 $c_{i}^{q}$ 使用给定的 3 点 LGL 求积规则计算。首先，在求积节点 $x_{0}=-1, x_{1}=0, x_{2}=1$ 处计算所需函数的值：\n- $g(x_0) = g(-1) = P_{2}(-1)^{2} = (1)^{2} = 1$\n- $g(x_1) = g(0) = P_{2}(0)^{2} = (-\\frac{1}{2})^{2} = \\frac{1}{4}$\n- $g(x_2) = g(1) = P_{2}(1)^{2} = (1)^{2} = 1$\n- $P_{0}(x)$ 在所有节点处均为 $1$。\n- $P_{1}(x)$ 的值为：$P_1(-1)=-1, P_1(0)=0, P_1(1)=1$。\n- $P_{2}(x)$ 的值为：$P_2(-1)=1, P_2(0)=-1/2, P_2(1)=1$。\n\n现在，我们可以根据定义计算 $c_{i}^{q}$：\n$$\nc_{0}^{q}=\\frac{1}{2}\\sum_{q=0}^{2} w_{q}\\,g(x_{q})\\,P_{0}(x_{q}) = \\frac{1}{2}\\left[ \\frac{1}{3}(1)(1) + \\frac{4}{3}\\left(\\frac{1}{4}\\right)(1) + \\frac{1}{3}(1)(1) \\right] = \\frac{1}{2}\\left( \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{3} \\right) = \\frac{1}{2}\n$$\n$$\nc_{1}^{q}=\\frac{3}{2}\\sum_{q=0}^{2} w_{q}\\,g(x_{q})\\,P_{1}(x_{q}) = \\frac{3}{2}\\left[ \\frac{1}{3}(1)(-1) + \\frac{4}{3}\\left(\\frac{1}{4}\\right)(0) + \\frac{1}{3}(1)(1) \\right] = \\frac{3}{2}\\left( -\\frac{1}{3} + 0 + \\frac{1}{3} \\right) = 0\n$$\n$$\nc_{2}^{q}=\\frac{5}{2}\\sum_{q=0}^{2} w_{q}\\,g(x_{q})\\,P_{2}(x_{q}) = \\frac{5}{2}\\left[ \\frac{1}{3}(1)(1) + \\frac{4}{3}\\left(\\frac{1}{4}\\right)\\left(-\\frac{1}{2}\\right) + \\frac{1}{3}(1)(1) \\right] = \\frac{5}{2}\\left( \\frac{1}{3} - \\frac{1}{6} + \\frac{1}{3} \\right) = \\frac{5}{2}\\left(\\frac{3}{6}\\right) = \\frac{5}{4}\n$$\n因此，近似系数为：$c_{0}^{q} = \\frac{1}{2}$， $c_{1}^{q} = 0$， $c_{2}^{q} = \\frac{5}{4}$。\n\n**3. 计算误差范数 $E$**\n\n首先计算系数的差值：\n- $\\Delta c_{0} = c_{0}^{q} - c_{0}^{\\ast} = \\frac{1}{2} - \\frac{1}{5} = \\frac{3}{10}$\n- $\\Delta c_{1} = c_{1}^{q} - c_{1}^{\\ast} = 0 - 0 = 0$\n- $\\Delta c_{2} = c_{2}^{q} - c_{2}^{\\ast} = \\frac{5}{4} - \\frac{2}{7} = \\frac{35 - 8}{28} = \\frac{27}{28}$\n\n将这些差值代入误差范数平方的公式中：\n$$\nE^{2} = (\\Delta c_{0})^{2} \\frac{2}{1} + (\\Delta c_{1})^{2} \\frac{2}{3} + (\\Delta c_{2})^{2} \\frac{2}{5} = \\left(\\frac{3}{10}\\right)^{2}(2) + (0)^{2}\\left(\\frac{2}{3}\\right) + \\left(\\frac{27}{28}\\right)^{2}\\left(\\frac{2}{5}\\right)\n$$\n$$\nE^{2} = \\frac{9}{100}(2) + \\frac{729}{784}\\left(\\frac{2}{5}\\right) = \\frac{18}{100} + \\frac{1458}{3920} = \\frac{9}{50} + \\frac{729}{1960}\n$$\n通分相加：\n$$\nE^{2} = \\frac{9 \\cdot 196}{9800} + \\frac{729 \\cdot 5}{9800} = \\frac{1764}{9800} + \\frac{3645}{9800} = \\frac{5409}{9800}\n$$\n最后，取平方根并化简：\n$$\nE = \\sqrt{\\frac{5409}{9800}} = \\frac{\\sqrt{9 \\cdot 601}}{\\sqrt{100 \\cdot 98}} = \\frac{3\\sqrt{601}}{10 \\cdot 7\\sqrt{2}} = \\frac{3\\sqrt{601}}{70\\sqrt{2}}\n$$\n将分母有理化得到最终答案：\n$$\nE = \\frac{3\\sqrt{1202}}{140}\n$$",
            "answer": "$$\\boxed{\\frac{3\\sqrt{1202}}{140}}$$"
        },
        {
            "introduction": "现实世界的问题常常涉及可变系数，例如非均匀的材料密度。本练习将我们的分析扩展到这类情况。我们将使用节点基（这使得对角化过程变得简单），考察在内积中引入一个可变密度项 $\\rho(x)$ 如何影响质量集中的精度，从而揭示集总质量矩阵的精度现在如何依赖于求积规则对包含该可变系数的积分的近似程度 。",
            "id": "3397920",
            "problem": "考虑在参考单元 $[-1,1]$ 上的一个一维间断伽辽金 (DG) 离散化，其多项式近似空间的次数最高为 $N=2$。使用与高斯-洛巴托-勒让德 (GLL) 节点 $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$ 相关联的节点拉格朗日基 $\\{\\ell_{i}(x)\\}_{i=1}^{3}$。加权内积定义为\n$$\n(u,v)_{\\rho} \\equiv \\int_{-1}^{1} \\rho(x)\\,u(x)\\,v(x)\\,dx,\n$$\n其中密度是可变的，由 $\\rho(x)=1+\\alpha x^{2}$ 给出，且 $\\alpha -1$。精确单元质量矩阵的元素为 $M_{ij}=\\int_{-1}^{1} \\rho(x)\\,\\ell_{i}(x)\\,\\ell_{j}(x)\\,dx$。基于求积的质量矩阵是通过使用相同的节点和权重的3点GLL求积法则来近似积分定义的，即，\n$$\nM^{Q}_{ij} \\equiv \\sum_{k=1}^{3} w_{k}\\,\\rho(x_{k})\\,\\ell_{i}(x_{k})\\,\\ell_{j}(x_{k}),\n$$\n其中 GLL 求积节点和权重为 $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$ 以及 $w_{1}=\\frac{1}{3}$, $w_{2}=\\frac{4}{3}$, $w_{3}=\\frac{1}{3}$。\n\n仅从上述定义和拉格朗日插值的标准性质出发，完成以下任务：(i) 推导 $M^{Q}_{ij}$ 的对角形式，以及 (ii) 计算精确对角元 $M_{22}$ 和基于求积的对角元 $M^{Q}_{22}$。然后，构建比值\n$$\nR(\\alpha) \\equiv \\frac{M^{Q}_{22}}{M_{22}},\n$$\n并将其完全化简。将你的最终答案以关于 $\\alpha$ 的单个闭式表达式的形式给出。无需四舍五入，也不涉及任何单位。",
            "solution": "该问题在偏微分方程数值方法领域内是适定的且有科学依据。所有必要信息均已提供，目标明确。\n\n第一步是推导基于求积的质量矩阵 $M^{Q}_{ij}$ 的一般形式。根据定义，其元素由下式给出：\n$$\nM^{Q}_{ij} = \\sum_{k=1}^{3} w_{k}\\,\\rho(x_{k})\\,\\ell_{i}(x_{k})\\,\\ell_{j}(x_{k})\n$$\n基函数 $\\{\\ell_{i}(x)\\}_{i=1}^{3}$ 是与高斯-洛巴托-勒让德 (GLL) 节点 $\\{x_{k}\\}_{k=1}^{3}$ 相关联的节点拉格朗日多项式。这些基函数的一个基本性质是克罗内克-德尔塔性质（也称为核心性质）：\n$$\n\\ell_{i}(x_{k}) = \\delta_{ik} = \\begin{cases} 1  \\text{if } i=k \\\\ 0  \\text{if } i\\neq k \\end{cases}\n$$\n将此性质代入 $M^{Q}_{ij}$ 的表达式中：\n$$\nM^{Q}_{ij} = \\sum_{k=1}^{3} w_{k}\\,\\rho(x_{k})\\,\\delta_{ik}\\,\\delta_{jk}\n$$\n两个克罗内克-德尔塔的乘积 $\\delta_{ik}\\delta_{jk}$ 仅在 $k=i$ 且 $k=j$ 时非零。这意味着除非 $i=j$，否则整个乘积为零。\n\n情况 1：$i \\neq j$。\n在这种情况下，对于求和中的任何 $k$ 值，$k=i$ 和 $k=j$ 不可能同时成立。因此，对于任何 $k$，$\\delta_{ik}$ 或 $\\delta_{jk}$ 中至少有一个必须为零。所以乘积 $\\delta_{ik}\\delta_{jk}$ 始终为零，求和结果为零。\n$$\nM^{Q}_{ij} = 0 \\quad \\text{for } i \\neq j\n$$\n\n情况 2：$i = j$。\n在这种情况下，表达式变为：\n$$\nM^{Q}_{ii} = \\sum_{k=1}^{3} w_{k}\\,\\rho(x_{k})\\,\\delta_{ik}\\,\\delta_{ik}\n$$\n由于 $\\delta_{ik}$ 的值是 $0$ 或 $1$，所以 $\\delta_{ik}\\delta_{ik} = \\delta_{ik}$。表达式化简为：\n$$\nM^{Q}_{ii} = \\sum_{k=1}^{3} w_{k}\\,\\rho(x_{k})\\,\\delta_{ik}\n$$\n$\\delta_{ik}$ 项仅在 $k=i$ 时非零，因此求和式收缩为单项：\n$$\nM^{Q}_{ii} = w_{i}\\,\\rho(x_{i})\n$$\n综合两种情况，基于求积的质量矩阵是对角的，这是质量集中的结果：\n$$\nM^{Q}_{ij} = w_{i}\\,\\rho(x_{i})\\,\\delta_{ij}\n$$\n这就完成了问题的第一部分 (i)。\n\n对于第二部分 (ii)，我们必须计算特定元素 $M^{Q}_{22}$ 和 $M_{22}$。\n\n首先，我们使用上面为 $i=2$ 推导出的公式计算 $M^{Q}_{22}$：\n$$\nM^{Q}_{22} = w_{2}\\,\\rho(x_{2})\n$$\n问题给出了 $x_{2}=0$ 和 $w_{2}=\\frac{4}{3}$。密度函数是 $\\rho(x)=1+\\alpha x^{2}$。我们计算 $\\rho(x_{2})$：\n$$\n\\rho(x_{2}) = \\rho(0) = 1 + \\alpha (0)^2 = 1\n$$\n因此，\n$$\nM^{Q}_{22} = \\frac{4}{3} \\times 1 = \\frac{4}{3}\n$$\n\n接下来，我们根据定义计算精确质量矩阵元素 $M_{22}$：\n$$\nM_{22} = \\int_{-1}^{1} \\rho(x)\\,\\ell_{2}(x)\\,\\ell_{2}(x)\\,dx = \\int_{-1}^{1} (1+\\alpha x^{2})\\,(\\ell_{2}(x))^{2}\\,dx\n$$\n我们需要找到节点 $x_{1}=-1$、$x_{2}=0$ 和 $x_{3}=1$ 对应的拉格朗日多项式 $\\ell_{2}(x)$。根据定义，$\\ell_{2}(x)$ 是一个最高次数为 $2$ 的多项式，满足 $\\ell_{2}(x_{2})=1$ 且 $\\ell_{2}(x_{1})=\\ell_{2}(x_{3})=0$。\n$$\n\\ell_{2}(x) = \\frac{(x-x_{1})}{(x_{2}-x_{1})} \\frac{(x-x_{3})}{(x_{2}-x_{3})} = \\frac{(x-(-1))}{(0-(-1))} \\frac{(x-1)}{(0-1)} = \\frac{x+1}{1} \\frac{x-1}{-1} = -(x^{2}-1) = 1-x^{2}\n$$\n现在我们将 $\\ell_{2}(x)$ 和 $\\rho(x)$ 代入 $M_{22}$ 的积分中：\n$$\nM_{22} = \\int_{-1}^{1} (1+\\alpha x^{2})\\,(1-x^{2})^{2}\\,dx\n$$\n我们展开被积函数：\n$$\n(1+\\alpha x^{2})(1-2x^{2}+x^{4}) = 1 - 2x^{2} + x^{4} + \\alpha x^{2} - 2\\alpha x^{4} + \\alpha x^{6}\n$$\n按 $x$ 的幂次合并项：\n$$\n1 + (\\alpha-2)x^{2} + (1-2\\alpha)x^{4} + \\alpha x^{6}\n$$\n被积函数是偶函数，所以我们可以将积分写成：\n$$\nM_{22} = 2 \\int_{0}^{1} \\left(1 + (\\alpha-2)x^{2} + (1-2\\alpha)x^{4} + \\alpha x^{6}\\right)\\,dx\n$$\n逐项积分：\n$$\nM_{22} = 2 \\left[ x + \\frac{\\alpha-2}{3}x^{3} + \\frac{1-2\\alpha}{5}x^{5} + \\frac{\\alpha}{7}x^{7} \\right]_{0}^{1}\n$$\n$$\nM_{22} = 2 \\left( 1 + \\frac{\\alpha-2}{3} + \\frac{1-2\\alpha}{5} + \\frac{\\alpha}{7} \\right)\n$$\n为了化简，我们找到公分母 $3 \\times 5 \\times 7 = 105$：\n$$\nM_{22} = 2 \\left( \\frac{105}{105} + \\frac{35(\\alpha-2)}{105} + \\frac{21(1-2\\alpha)}{105} + \\frac{15\\alpha}{105} \\right)\n$$\n$$\nM_{22} = \\frac{2}{105} \\left( 105 + 35\\alpha - 70 + 21 - 42\\alpha + 15\\alpha \\right)\n$$\n分别合并常数项和含 $\\alpha$ 的项：\n$$\n105 - 70 + 21 = 56\n$$\n$$\n35\\alpha - 42\\alpha + 15\\alpha = (35-42+15)\\alpha = 8\\alpha\n$$\n所以 $M_{22}$ 的表达式变为：\n$$\nM_{22} = \\frac{2}{105}(56 + 8\\alpha) = \\frac{16(7 + \\alpha)}{105}\n$$\n\n最后，对于第三部分 (iii)，我们构建比值 $R(\\alpha) = \\frac{M^{Q}_{22}}{M_{22}}$：\n$$\nR(\\alpha) = \\frac{\\frac{4}{3}}{\\frac{16(7 + \\alpha)}{105}} = \\frac{4}{3} \\times \\frac{105}{16(7 + \\alpha)}\n$$\n我们化简常数因子：\n$$\n\\frac{4 \\times 105}{3 \\times 16} = \\frac{1 \\times 35}{1 \\times 4} = \\frac{35}{4}\n$$\n因此，比值为：\n$$\nR(\\alpha) = \\frac{35}{4(7 + \\alpha)}\n$$\n条件 $\\alpha  -1$ 确保了 $7 + \\alpha  6$，因此分母始终有定义且非零。",
            "answer": "$$\\boxed{\\frac{35}{4(7 + \\alpha)}}$$"
        }
    ]
}