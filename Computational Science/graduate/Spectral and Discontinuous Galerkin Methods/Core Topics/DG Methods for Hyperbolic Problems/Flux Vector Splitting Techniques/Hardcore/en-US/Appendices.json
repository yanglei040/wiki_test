{
    "hands_on_practices": [
        {
            "introduction": "The essence of flux vector splitting lies in decomposing the governing equations according to the direction of information flow. For the Euler equations, this information travels at characteristic wave speeds. This first exercise  will guide you through the fundamental derivation of these speeds from first principles, connecting the abstract flux Jacobian to the physical velocities $u$, $u+a$, and $u-a$. Mastering this derivation is the first step toward understanding how and why splitting techniques work.",
            "id": "3366221",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas in conservative form with conserved state vector $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ and flux vector $\\mathbf{F}(\\mathbf{U}) = \\big(\\rho u, \\rho u^{2} + p, u(E + p)\\big)^{\\mathsf{T}}$. The pressure $p$ is related to the total energy density $E$ and the density $\\rho$ via the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2} \\rho u^{2}\\right)$, where $\\gamma$ is the ratio of specific heats. The speed of sound $a$ is defined thermodynamically by $a^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$, the derivative of pressure with respect to density at constant entropy $s$. The framework of Computational Fluid Dynamics (CFD) often employs characteristic information of the flux Jacobian to construct upwind schemes, such as the Steger–Warming flux vector splitting method, which separates flux contributions according to the signs of wave speeds.\n\nStarting from the above fundamental laws and definitions, without invoking any pre-stated characteristic formulas, first derive the characteristic wave speeds of the one-dimensional Euler equations and the expression for the sound speed $a$ for an ideal gas in terms of $\\gamma$, $p$, and $\\rho$. Then, for the specific uniform state $(\\rho, u, p) = (1.0, 0.3, 1.0)$ with $\\gamma = 1.4$, evaluate numerically the sound speed $a$ and the three characteristic speeds $u - a$, $u$, and $u + a$. Assume nondimensional variables so that no physical units are required. Round your numerical answers to six significant figures. Report your final answer as a single row matrix in the order $[a,\\ u - a,\\ u,\\ u + a]$.",
            "solution": "The problem requires the derivation of the characteristic wave speeds for the one-dimensional Euler equations and the expression for the speed of sound for an ideal gas, followed by a numerical evaluation for a specific state. The procedure is as follows.\n\nFirst, we derive the characteristic speeds of the system. The one-dimensional Euler equations in conservative form are given by:\n$$ \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0 $$\nwhere $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ is the vector of conserved variables and $\\mathbf{F} = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$ is the flux vector. The variables are density $\\rho$, velocity $u$, total energy per unit volume $E$, and pressure $p$. The system is closed by the ideal gas equation of state, $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^{2})$, where $\\gamma$ is the ratio of specific heats.\n\nThe characteristic wave speeds are the eigenvalues of the flux Jacobian matrix $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$. A direct calculation of this Jacobian is algebraically intensive. A more systematic approach involves transforming the equations into a quasi-linear form using a vector of primitive variables, such as $\\mathbf{W} = (\\rho, u, p)^{\\mathsf{T}}$.\n\nUsing the chain rule, the Euler equations can be written as:\n$$ \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0 $$\nLet $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ and $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$. The equation becomes $\\mathbf{M} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$. Multiplying by $\\mathbf{M}^{-1}$ gives the quasi-linear form $\\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{M}^{-1}\\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$. The characteristic speeds $\\lambda$ are the eigenvalues of the matrix $\\mathbf{A} = \\mathbf{M}^{-1}\\mathbf{B}$, which are the roots of the generalized eigenvalue problem $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$.\n\nLet's compute the matrices $\\mathbf{M}$ and $\\mathbf{B}$. First, we express the conserved variables $\\mathbf{U}$ in terms of the primitive variables $\\mathbf{W}$:\n$U_1 = \\rho$\n$U_2 = \\rho u$\n$U_3 = E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$\nThe matrix $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ is:\n$$ \\mathbf{M} = \\frac{\\partial(U_1, U_2, U_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} 1  0  0 \\\\ u  \\rho  0 \\\\ \\frac{1}{2}u^2  \\rho u  \\frac{1}{\\gamma-1} \\end{pmatrix} $$\nNext, we express the flux vector $\\mathbf{F}$ in terms of $\\mathbf{W}$:\n$F_1 = \\rho u$\n$F_2 = \\rho u^2 + p$\n$F_3 = u(E+p) = u\\left(\\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2 + p\\right) = u\\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\\right) = \\frac{\\gamma u p}{\\gamma-1} + \\frac{1}{2}\\rho u^3$\nThe matrix $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$ is:\n$$ \\mathbf{B} = \\frac{\\partial(F_1, F_2, F_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} u  \\rho  0 \\\\ u^2  2\\rho u  1 \\\\ \\frac{1}{2}u^3  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2  \\frac{\\gamma u}{\\gamma-1} \\end{pmatrix} $$\nNow we solve the characteristic equation $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$. From the structure of $\\mathbf{B} - \\lambda\\mathbf{M}$, we can factor out $(u-\\lambda)$ from the first column, which reveals one eigenvalue is $\\lambda = u$. For the other eigenvalues, we can perform a cofactor expansion.\n$$ (u-\\lambda)\\det\\begin{pmatrix} 2\\rho u - \\lambda \\rho  1 \\\\ \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda \\rho u  \\frac{\\gamma u - \\lambda}{\\gamma-1} \\end{pmatrix} - \\rho\\det\\begin{pmatrix} u^2 - \\lambda u  1 \\\\ \\frac{1}{2}u^3 - \\frac{\\lambda}{2}u^2  \\frac{\\gamma u - \\lambda}{\\gamma-1} \\end{pmatrix} = 0 $$\nFactoring out the common term $(u-\\lambda)$:\n$$ (u-\\lambda) \\left\\{ \\rho(2u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda\\rho u\\right) - \\rho\\left[u\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{u^2}{2}\\right] \\right\\} = 0 $$\nFor $\\lambda \\neq u$, the expression in the curly braces must be zero. Let's simplify this expression. Combining terms with a factor of $\\frac{\\rho}{\\gamma-1}$:\n$$ \\frac{\\rho}{\\gamma-1} \\left( (2u-\\lambda)(\\gamma u - \\lambda) - u(\\gamma u - \\lambda) \\right) - \\frac{\\gamma p}{\\gamma-1} - \\frac{3}{2}\\rho u^2 + \\lambda\\rho u + \\frac{1}{2}\\rho u^2 = 0 $$\nThe first term simplifies as $(2u-\\lambda - u)(\\gamma u - \\lambda) = (u-\\lambda)(\\gamma u - \\lambda)$. The equation becomes:\n$$ \\frac{\\rho}{\\gamma-1}(u-\\lambda)(\\gamma u - \\lambda) - \\frac{\\gamma p}{\\gamma-1} - \\rho u^2 + \\lambda\\rho u = 0 $$\nMultiplying by $(\\gamma-1)$:\n$$ \\rho(u-\\lambda)(\\gamma u - \\lambda) - \\gamma p - (\\gamma-1)\\rho u^2 + (\\gamma-1)\\lambda\\rho u = 0 $$\nExpanding the terms:\n$$ \\rho(\\gamma u^2 - u\\lambda - \\gamma u\\lambda + \\lambda^2) - \\gamma p - \\gamma\\rho u^2 + \\rho u^2 + \\gamma\\lambda\\rho u - \\lambda\\rho u = 0 $$\nNow we collect terms by powers of $\\lambda$:\n- The coefficient of $\\lambda^2$ is $\\rho$.\n- The coefficient of $\\lambda$ is $-\\rho u - \\rho\\gamma u + \\gamma\\rho u - \\rho u = -2\\rho u$.\n- The constant terms are $\\rho\\gamma u^2 - \\gamma p - \\gamma\\rho u^2 + \\rho u^2 = \\rho u^2 - \\gamma p$.\nThe equation for the remaining eigenvalues simplifies to:\n$$ \\rho\\lambda^2 - 2\\rho u \\lambda + (\\rho u^2 - \\gamma p) = 0 $$\nDividing by $\\rho$ (which is non-zero):\n$$ \\lambda^2 - 2u\\lambda + u^2 - \\frac{\\gamma p}{\\rho} = 0 $$\n$$ (\\lambda - u)^2 = \\frac{\\gamma p}{\\rho} $$\n$$ \\lambda - u = \\pm\\sqrt{\\frac{\\gamma p}{\\rho}} $$\nThis gives the other two eigenvalues: $\\lambda_{2,3} = u \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n\nSecond, we derive the expression for the speed of sound $a$. The problem defines it as $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$, where the derivative is taken at constant entropy $s$. For a calorically perfect ideal gas, an isentropic process is governed by the relation $p = K\\rho^\\gamma$, where $K$ is constant. This relation arises from the first law of thermodynamics, $de = Tds - p d(1/\\rho)$, where $e$ is the specific internal energy. For an ideal gas, $e=c_v T$ and $p=\\rho R T$. For an isentropic process ($ds=0$), this leads to $p/\\rho^\\gamma = \\text{const}$.\nTaking the partial derivative of $p$ with respect to $\\rho$:\n$$ a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\frac{\\partial}{\\partial \\rho}(K\\rho^\\gamma) = K\\gamma\\rho^{\\gamma-1} $$\nSubstituting $K = p/\\rho^\\gamma$:\n$$ a^2 = \\left(\\frac{p}{\\rho^\\gamma}\\right)\\gamma\\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho} $$\nThus, the speed of sound is $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\nThe three characteristic wave speeds of the one-dimensional Euler equations are therefore $\\lambda_1 = u$, $\\lambda_2 = u - a$, and $\\lambda_3 = u + a$.\n\nThird, we evaluate these speeds for the given uniform state: $\\rho = 1.0$, $u = 0.3$, $p = 1.0$, and $\\gamma = 1.4$. All variables are non-dimensional.\n\nThe speed of sound $a$ is:\n$$ a = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.183215956... $$\nRounding to six significant figures, we get $a \\approx 1.18322$.\n\nThe three characteristic speeds are:\n1.  $u - a = 0.3 - \\sqrt{1.4} \\approx 0.3 - 1.183215956... = -0.883215956...$\n    Rounding to six significant figures, $u - a \\approx -0.883216$.\n2.  $u = 0.3$. Expressed with six significant figures, this is $0.300000$.\n3.  $u + a = 0.3 + \\sqrt{1.4} \\approx 0.3 + 1.183215956... = 1.483215956...$\n    Rounding to six significant figures, $u + a \\approx 1.48322$.\n\nThe final results are ordered as $[a,\\ u-a,\\ u,\\ u+a]$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 1.18322  -0.883216  0.300000  1.48322 \\end{pmatrix}} $$"
        },
        {
            "introduction": "While splitting fluxes based on the sign of the eigenvalues is powerful, a naive implementation can lead to unphysical results, such as expansion shocks in transonic rarefactions. This issue arises because the numerical dissipation vanishes precisely where it may be needed to ensure entropy satisfaction. This practice  delves into a common remedy, the \"entropy fix,\" demonstrating how a small modification to the split eigenvalues near a sonic point can introduce the necessary numerical dissipation to restore the correct physical behavior of the numerical scheme.",
            "id": "3320873",
            "problem": "Consider the one-dimensional Euler equations for a calorically perfect gas with constant specific heat ratio $\\gamma$ governing a smooth, isentropic transonic rarefaction. Let the conservative variable vector be $U = (\\rho, \\rho u, E)^{\\top}$, the flux be $f(U) = (\\rho u, \\rho u^{2} + p, u(E+p))^{\\top}$, and the flux Jacobian be $A(U) = \\frac{\\partial f}{\\partial U}$. The eigenstructure of $A(U)$ at a state with density $\\rho$, velocity $u$, pressure $p$, speed of sound $a = \\sqrt{\\gamma p/\\rho}$, and total enthalpy $H = (E+p)/\\rho$ consists of eigenvalues $\\lambda_{1} = u - a$, $\\lambda_{2} = u$, $\\lambda_{3} = u + a$, with corresponding right eigenvectors $r_{1} = (1, u - a, H - u a)^{\\top}$, $r_{2} = (1, u, \\tfrac{1}{2}u^{2})^{\\top}$, and $r_{3} = (1, u + a, H + u a)^{\\top}$. In the Steger–Warming flux vector splitting, one writes $A(U) = R \\Lambda R^{-1}$ and defines the split operators $A^{\\pm}(U) = R \\Lambda^{\\pm} R^{-1}$ with $\\Lambda^{\\pm} = \\mathrm{diag}(\\lambda_{1}^{\\pm}, \\lambda_{2}^{\\pm}, \\lambda_{3}^{\\pm})$, where $\\lambda^{\\pm} = \\tfrac{1}{2}(\\lambda \\pm |\\lambda|)$.\n\nIn a centered rarefaction that crosses the sonic condition, consider the interfacial (Roe-averaged) state at which the local Mach number $M = u/a$ satisfies $M = 1$, so that $\\lambda_{1} = u - a = 0$, $\\lambda_{2} = u = a  0$, and $\\lambda_{3} = u + a = 2a  0$. To enforce the correct entropy production in the transonic region, apply an entropy fix that smooths the sign function near zero in terms of a dimensionless Mach-based threshold. Specifically, for each characteristic, introduce the dimensionless eigenvalue $\\mu = \\lambda/a$ and replace $|\\mu|$ by\n$$\n\\phi_{M}(\\mu) = \\begin{cases}\n\\displaystyle \\frac{\\mu^{2} + \\delta_{M}^{2}}{2 \\delta_{M}},  |\\mu|  \\delta_{M}, \\\\\n|\\mu|,  |\\mu| \\ge \\delta_{M},\n\\end{cases}\n$$\nwhere $\\delta_{M}  0$ is a prescribed (dimensionless) entropy-fix parameter. The modified split eigenvalues are then defined by $\\mu^{\\pm} = \\tfrac{1}{2}(\\mu \\pm \\phi_{M}(\\mu))$, and returned to dimensional form via $\\lambda^{\\pm} = a\\,\\mu^{\\pm}$.\n\nUsing this entropy fix, compute the modified split flux operators $A^{+}$ and $A^{-}$ at the sonic interfacial state and explicitly identify how the previously vanishing acoustic contribution associated with $\\lambda_{1}$ is altered. Next, quantify the change in the dimensionless numerical dissipation coefficient per unit characteristic amplitude for the left-going acoustic field, defined as $d_{1} = \\tfrac{1}{2}|\\mu_{1}|$ without the entropy fix and $d_{1}^{\\mathrm{EF}} = \\tfrac{1}{2}\\phi_{M}(\\mu_{1})$ with the entropy fix, evaluated at the sonic interfacial state where $\\mu_{1} = (\\lambda_{1}/a) = 0$. Express your final answer as a single closed-form analytic expression in terms of $\\delta_{M}$, with no units required.",
            "solution": "We begin from the one-dimensional Euler equations for a calorically perfect gas, whose flux Jacobian $A(U) = \\frac{\\partial f}{\\partial U}$ possesses the well-known eigenstructure determined by the flow speed $u$, the speed of sound $a = \\sqrt{\\gamma p/\\rho}$, and the total enthalpy $H = (E+p)/\\rho$. The eigenvalues are $\\lambda_{1} = u - a$, $\\lambda_{2} = u$, and $\\lambda_{3} = u + a$. The corresponding right eigenvectors under Roe linearization are\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ u - a \\\\ H - u a \\end{pmatrix}, \\quad\nr_{2} = \\begin{pmatrix} 1 \\\\ u \\\\ \\tfrac{1}{2}u^{2} \\end{pmatrix}, \\quad\nr_{3} = \\begin{pmatrix} 1 \\\\ u + a \\\\ H + u a \\end{pmatrix},\n$$\nand the flux Jacobian admits the decomposition $A = R \\Lambda R^{-1}$, where $R = [r_{1}\\; r_{2}\\; r_{3}]$ and $\\Lambda = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$.\n\nIn the Steger–Warming flux vector splitting, one defines the split operators\n$$\nA^{\\pm} = R \\Lambda^{\\pm} R^{-1}, \\quad \\Lambda^{\\pm} = \\mathrm{diag}(\\lambda_{1}^{\\pm}, \\lambda_{2}^{\\pm}, \\lambda_{3}^{\\pm}),\n$$\nwith\n$$\n\\lambda^{\\pm} = \\frac{1}{2}\\left(\\lambda \\pm |\\lambda|\\right).\n$$\nAt the interfacial state inside a centered isentropic rarefaction where the Mach number is $M = u/a = 1$, the eigenvalues are\n$$\n\\lambda_{1} = u - a = 0, \\quad \\lambda_{2} = u = a  0, \\quad \\lambda_{3} = u + a = 2a  0.\n$$\nUnder the unmodified splitting, we have\n$$\n\\lambda_{1}^{+} = \\frac{1}{2}(0 + |0|) = 0, \\quad \\lambda_{1}^{-} = \\frac{1}{2}(0 - |0|) = 0,\n$$\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(a + a) = a, \\quad \\lambda_{2}^{-} = \\frac{1}{2}(a - a) = 0,\n$$\n$$\n\\lambda_{3}^{+} = \\frac{1}{2}(2a + 2a) = 2a, \\quad \\lambda_{3}^{-} = \\frac{1}{2}(2a - 2a) = 0.\n$$\nThus, without entropy fix, the left-going acoustic field contributes nothing to either $A^{+}$ or $A^{-}$ at the sonic point; in particular, $A^{-}$ vanishes entirely and $A^{+} = R \\,\\mathrm{diag}(0, a, 2a)\\, R^{-1}$.\n\nThis zero contribution at the sonic point is associated with potential non-entropy-satisfying behavior in transonic expansions. To remove this deficiency, we introduce a Mach-based entropy fix that smooths the absolute value near zero. Define the dimensionless characteristic eigenvalues $\\mu_{k} = \\lambda_{k}/a$ and replace $|\\mu|$ by\n$$\n\\phi_{M}(\\mu) = \\begin{cases}\n\\displaystyle \\frac{\\mu^{2} + \\delta_{M}^{2}}{2 \\delta_{M}},  |\\mu|  \\delta_{M}, \\\\\n|\\mu|,  |\\mu| \\ge \\delta_{M},\n\\end{cases}\n$$\nwhere $\\delta_{M}  0$ is a prescribed dimensionless threshold. The modified split eigenvalues are formed in dimensionless variables as\n$$\n\\mu^{\\pm} = \\frac{1}{2}\\left(\\mu \\pm \\phi_{M}(\\mu)\\right),\n$$\nand converted back to dimensional form via\n$$\n\\lambda^{\\pm} = a\\,\\mu^{\\pm}.\n$$\nAt the sonic point for the left-going acoustic field, $\\mu_{1} = \\lambda_{1}/a = 0$. Because $|\\mu_{1}| = 0  \\delta_{M}$, we invoke the smoothed branch, yielding\n$$\n\\phi_{M}(\\mu_{1}) = \\phi_{M}(0) = \\frac{0^{2} + \\delta_{M}^{2}}{2 \\delta_{M}} = \\frac{\\delta_{M}}{2}.\n$$\nTherefore, the modified split eigenvalues for the first field are\n$$\n\\mu_{1}^{+} = \\frac{1}{2}\\left(0 + \\frac{\\delta_{M}}{2}\\right) = \\frac{\\delta_{M}}{4}, \\quad\n\\mu_{1}^{-} = \\frac{1}{2}\\left(0 - \\frac{\\delta_{M}}{2}\\right) = -\\frac{\\delta_{M}}{4},\n$$\nand in dimensional form,\n$$\n\\lambda_{1}^{+} = a\\,\\frac{\\delta_{M}}{4}, \\quad \\lambda_{1}^{-} = -a\\,\\frac{\\delta_{M}}{4}.\n$$\nThe other two eigenvalues remain strictly positive at $M=1$, so their splitting is unaffected: $\\lambda_{2}^{+} = a$, $\\lambda_{2}^{-} = 0$, $\\lambda_{3}^{+} = 2a$, $\\lambda_{3}^{-} = 0$. Consequently, the entropy-fixed split operators at the sonic state are\n$$\nA^{+}_{\\mathrm{EF}} = R \\,\\mathrm{diag}\\!\\left(a\\,\\frac{\\delta_{M}}{4},\\; a,\\; 2a\\right)\\, R^{-1}, \\quad\nA^{-}_{\\mathrm{EF}} = R \\,\\mathrm{diag}\\!\\left(-a\\,\\frac{\\delta_{M}}{4},\\; 0,\\; 0\\right)\\, R^{-1}.\n$$\nRelative to the unmodified scheme, the entropy fix introduces a nonzero contribution from the first acoustic field into both $A^{+}$ and $A^{-}$, symmetrically about zero, with magnitude set by $a\\,\\delta_{M}/4$.\n\nTo quantify the change in numerical dissipation, we define a dimensionless measure per unit characteristic amplitude for the $k$-th field as\n$$\nd_{k} = \\frac{1}{2}|\\mu_{k}|\n$$\nfor the unmodified scheme, and\n$$\nd_{k}^{\\mathrm{EF}} = \\frac{1}{2}\\phi_{M}(\\mu_{k})\n$$\nfor the entropy-fixed scheme. At the sonic interfacial state for the left-going acoustic field, $\\mu_{1} = 0$, so\n$$\nd_{1} = \\frac{1}{2}|0| = 0, \\quad\nd_{1}^{\\mathrm{EF}} = \\frac{1}{2}\\phi_{M}(0) = \\frac{1}{2}\\cdot \\frac{\\delta_{M}}{2} = \\frac{\\delta_{M}}{4}.\n$$\nThe change in the dimensionless numerical dissipation coefficient per unit characteristic amplitude for the left-going acoustic field is therefore\n$$\n\\Delta d \\equiv d_{1}^{\\mathrm{EF}} - d_{1} = \\frac{\\delta_{M}}{4} - 0 = \\frac{\\delta_{M}}{4}.\n$$\nThis closed-form expression in terms of $\\delta_{M}$ captures the additional entropy-consistent smoothing introduced by the fix precisely at the sonic point in a transonic rarefaction.",
            "answer": "$$\\boxed{\\frac{\\delta_{M}}{4}}$$"
        },
        {
            "introduction": "The evolution of flux vector splitting has been driven by the need for greater accuracy and robustness, particularly in resolving complex flow features. A significant weakness of early schemes was their excessive numerical smearing of contact discontinuities. This exercise  explores how modern schemes, like the Advection Upstream Splitting Method Plus (AUSM+), are intelligently designed to overcome this deficiency, allowing for the exact transport of contact waves under ideal conditions.",
            "id": "3320913",
            "problem": "Consider the one-dimensional Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$. Let the left and right states across a planar interface (aligned with the computational face normal, i.e., ideal alignment) represent a pure contact discontinuity:\n- Left state: density $\\rho_{L} = 1.0$, velocity $u_{L} = 600$, pressure $p_{L} = 1.0 \\times 10^{5}$.\n- Right state: density $\\rho_{R} = 0.8$, velocity $u_{R} = 600$, pressure $p_{R} = 1.0 \\times 10^{5}$.\nAll quantities are in International System of Units (SI): $\\rho$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $u$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $p$ in $\\mathrm{Pa}$.\n\nUsing the principles of flux vector splitting for the Advection Upstream Splitting Method Plus (AUSM+) and starting from the definitions of the Euler fluxes and the ideal gas law, derive the interfacial AUSM+ numerical flux vector $\\boldsymbol{F}^{\\mathrm{AUSM+}} = \\left(F_{1},\\,F_{2},\\,F_{3}\\right)$, where $F_{1}$, $F_{2}$, and $F_{3}$ are the mass, momentum, and energy fluxes, respectively, evaluated at the given interface. In your derivation, explain why, under ideal alignment and the given contact discontinuity, AUSM+ achieves exact transport of the contact. Then compute the numerical values of $\\left(F_{1},\\,F_{2},\\,F_{3}\\right)$ for the provided states.\n\nExpress $F_{1}$ in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $F_{2}$ in $\\mathrm{N}\\,\\mathrm{m}^{-2}$, and $F_{3}$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$. Provide the final numerical flux vector as exact values (no rounding required).",
            "solution": "We begin with the one-dimensional Euler equations and their fluxes. For the conservative variables $\\boldsymbol{U} = \\left(\\rho,\\,\\rho u,\\,E\\right)$, the physical flux vector in the $x$-direction is\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) = \\left(\\rho u,\\,\\rho u^{2} + p,\\,u(E + p)\\right),\n$$\nwhere $E = \\rho e + \\tfrac{1}{2}\\rho u^{2}$ is the total energy per unit volume, $e$ is the internal energy per unit mass, and the ideal gas law relates pressure and internal energy by\n$$\np = (\\gamma - 1)\\rho e \\quad \\Rightarrow \\quad \\rho e = \\frac{p}{\\gamma - 1}.\n$$\nThus,\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}.\n$$\n\nFlux vector splitting methods construct a numerical interfacial flux $\\boldsymbol{F}^{\\mathrm{num}}$ by separating convective transport from acoustic (pressure) contributions and by upwinding information based on a Mach-number-dependent splitting. In the Advection Upstream Splitting Method Plus (AUSM+), convective quantities are upwinded using Mach number splitting and acoustic quantities are split in a way that avoids spurious oscillations and preserves exact transport of contact discontinuities under ideal alignment.\n\nAdvection Upstream Splitting Method Plus (AUSM+) employs the following general structure at an interface:\n- The mass flux $F_{1}$ is written as a convective flux $m$,\n- The momentum flux $F_{2}$ is a sum of a convective part $m u_{f}$ and a pressure part $p_{f}$,\n- The energy flux $F_{3}$ is a convective transport of total enthalpy by $m$.\n\nA key property of AUSM+ is its exact transport of a contact discontinuity when the interface is ideally aligned (face normal aligned with the discontinuity normal), and the left and right states share the same velocity and pressure. In such a case, the contact wave moves with the fluid velocity, and there are no acoustic jumps ($p_{L} = p_{R}$). AUSM+ recovers the exact upwind convective transport and a consistent pressure at the face:\n- For supersonic flow with $u  0$, the Mach-number splitting yields purely upwind convection from the left, i.e., the mass flux reduces to $m = \\rho_{L} u_{L}$, the face pressure is $p_{f} = p_{L}$, and the energy convective flux uses the left state’s total enthalpy $h_{t,L} = (E_{L} + p_{L})/\\rho_{L}$, so $F_{3} = m h_{t,L} = u_{L}(E_{L} + p_{L})$.\n\nWe verify that the given states are indeed supersonic on both sides. The speed of sound is\n$$\na = \\sqrt{\\gamma \\frac{p}{\\rho}}.\n$$\nLeft side:\n$$\na_{L} = \\sqrt{1.4 \\cdot \\frac{1.0 \\times 10^{5}}{1.0}} = \\sqrt{1.4 \\times 10^{5}}.\n$$\nRight side:\n$$\na_{R} = \\sqrt{1.4 \\cdot \\frac{1.0 \\times 10^{5}}{0.8}} = \\sqrt{1.75 \\times 10^{5}}.\n$$\nNumerically,\n$$\na_{L} = \\sqrt{140000} \\approx 374.1657387, \\quad a_{R} = \\sqrt{175000} \\approx 418.3300133.\n$$\nWith $u_{L} = u_{R} = 600$, the Mach numbers are\n$$\nM_{L} = \\frac{u_{L}}{a_{L}} \\approx \\frac{600}{374.1657387} \\approx 1.603, \\quad M_{R} = \\frac{u_{R}}{a_{R}} \\approx \\frac{600}{418.3300133} \\approx 1.435,\n$$\nboth strictly greater than $1$, confirming supersonic flow.\n\nFor AUSM+, in the supersonic regime with $u  0$, the splitting functions simplify such that the entire convective transport at the face originates from the left state (pure upwind), and the acoustic (pressure) part equals the left pressure. Therefore, under the given contact discontinuity ($u_{L} = u_{R}$, $p_{L} = p_{R}$) and ideal alignment, AUSM+ achieves exact transport of the contact:\n- Exact mass flux:\n$$\nF_{1} = m = \\rho_{L} u_{L}.\n$$\n- Exact momentum flux:\n$$\nF_{2} = \\rho_{L} u_{L}^{2} + p_{L}.\n$$\n- Exact energy flux:\n$$\nF_{3} = u_{L}(E_{L} + p_{L}), \\quad \\text{with} \\quad E_{L} = \\frac{p_{L}}{\\gamma - 1} + \\frac{1}{2}\\rho_{L} u_{L}^{2}.\n$$\n\nWe now compute the numerical values.\n\nCompute $E_{L}$:\n$$\nE_{L} = \\frac{1.0 \\times 10^{5}}{1.4 - 1} + \\frac{1}{2} \\cdot 1.0 \\cdot 600^{2} = \\frac{1.0 \\times 10^{5}}{0.4} + \\frac{1}{2} \\cdot 360000 = 2.5 \\times 10^{5} + 1.8 \\times 10^{5} = 4.3 \\times 10^{5}.\n$$\nThen\n$$\nE_{L} + p_{L} = 4.3 \\times 10^{5} + 1.0 \\times 10^{5} = 5.3 \\times 10^{5}.\n$$\n\nMass flux:\n$$\nF_{1} = \\rho_{L} u_{L} = 1.0 \\cdot 600 = 600.\n$$\n\nMomentum flux:\n$$\nF_{2} = \\rho_{L} u_{L}^{2} + p_{L} = 1.0 \\cdot 600^{2} + 1.0 \\times 10^{5} = 360000 + 100000 = 460000.\n$$\n\nEnergy flux:\n$$\nF_{3} = u_{L}(E_{L} + p_{L}) = 600 \\cdot 5.3 \\times 10^{5} = 3.18 \\times 10^{8}.\n$$\n\nThus, the AUSM+ numerical flux vector at the interface is\n$$\n\\boldsymbol{F}^{\\mathrm{AUSM+}} = \\left(600,\\,460000,\\,3.18 \\times 10^{8}\\right),\n$$\nwhich expresses exact upwind transport of the contact under ideal alignment in the supersonic regime.",
            "answer": "$$\\boxed{\\begin{pmatrix}600  460000  3.18 \\times 10^{8}\\end{pmatrix}}$$"
        }
    ]
}