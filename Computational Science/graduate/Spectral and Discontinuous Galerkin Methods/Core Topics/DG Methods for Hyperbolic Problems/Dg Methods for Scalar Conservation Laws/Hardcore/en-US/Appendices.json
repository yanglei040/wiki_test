{
    "hands_on_practices": [
        {
            "introduction": "The behavior of solutions to scalar conservation laws is locally dominated by the interaction of waves, a phenomenon perfectly captured by the Riemann problem. This foundational exercise guides you through deriving the essential tools for analyzing these interactions: the Rankine-Hugoniot condition for shocks and the entropy condition that selects the physically relevant solution. Mastering this framework is the first and most critical step toward understanding and constructing the Godunov-type numerical fluxes that form the heart of modern Discontinuous Galerkin schemes for hyperbolic problems .",
            "id": "3377120",
            "problem": "Consider the scalar conservation law $u_{t} + \\partial_{x} f(u) = 0$ with a twice continuously differentiable and strictly convex flux $f$ (i.e., $f \\in C^{2}$ and $f''(u)  0$ for all $u$ in the range of interest). In the Discontinuous Galerkin (DG) method for scalar conservation laws, the interface numerical flux in a consistent Godunov-type formulation is obtained by evaluating the exact solution of the Riemann problem posed at each element interface. Let the initial data be a Riemann datum\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x  0,\n\\end{cases}\n$$\nwith constant left and right states $u_{L}, u_{R} \\in \\mathbb{R}$. Starting from the conservation law and the definition of weak solutions, derive the jump condition across a moving discontinuity and the characteristic-based entropy condition for strictly convex fluxes. Use these to determine whether the Riemann solution is a single shock wave with speed $s$ or a centered self-similar rarefaction wave, in terms of the ordering of $u_{L}$ and $u_{R}$. Finally, for the case $u_{L}  u_{R}$, compute the shock speed $s$ in closed form in terms of $f$, $u_{L}$, and $u_{R}$. Your final answer must be a single closed-form analytical expression for $s$.",
            "solution": "The problem as stated is a standard theoretical exercise in the study of hyperbolic scalar conservation laws. It is scientifically grounded, self-contained, and well-posed. All premises are standard definitions and conditions used in this field. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe problem asks for several derivations concerning the solution to the Riemann problem for the scalar conservation law\n$$\nu_t + \\partial_x f(u) = 0\n$$\nwhere the flux function $f$ is twice continuously differentiable ($f \\in C^2$) and strictly convex ($f''(u)  0$). The initial condition is a step function:\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x  0.\n\\end{cases}\n$$\n\nFirst, we will derive the jump condition for a moving discontinuity. We start from the definition of a weak solution. A function $u(x,t)$ is a weak solution to the conservation law if for any smooth test function $\\phi(x,t)$ with compact support in $\\mathbb{R} \\times [0, \\infty)$, the following integral identity holds:\n$$\n\\int_0^\\infty \\int_{-\\infty}^\\infty \\left( u \\frac{\\partial \\phi}{\\partial t} + f(u) \\frac{\\partial \\phi}{\\partial x} \\right) dx dt + \\int_{-\\infty}^\\infty u(x,0) \\phi(x,0) dx = 0\n$$\nLet us assume a solution exists that is piecewise smooth, with a single curve of discontinuity given by $x = x(t)$. Let's denote the shock speed as $s = \\frac{dx}{dt}$. For the self-similar solution of a Riemann problem, this curve is a straight line through the origin, $x = st$, where $s$ is a constant. The solution is $u(x,t) = u_L$ to the left of the discontinuity and $u(x,t) = u_R$ to the right. Let $\\Omega$ be an arbitrary region in the upper half-plane $t  0$, and let the discontinuity curve $\\Gamma$ with equation $x - st = 0$ pass through $\\Omega$, dividing it into a left region $\\Omega_L$ and a right region $\\Omega_R$.\n\nApplying the integral definition of a weak solution and using integration by parts (or the divergence theorem) on $\\Omega_L$ and $\\Omega_R$ separately, we get:\n$$\n\\iint_{\\Omega_L \\cup \\Omega_R} \\left( u \\phi_t + f(u) \\phi_x \\right) dx dt = 0\n$$\n$$\n\\iint_{\\Omega_L \\cup \\Omega_R} \\left( \\partial_t(u\\phi) - u_t \\phi + \\partial_x(f(u)\\phi) - (\\partial_x f(u)) \\phi \\right) dx dt = 0\n$$\nSince $u$ is a classical solution in the smooth regions $\\Omega_L$ and $\\Omega_R$, the term $u_t + \\partial_x f(u)$ vanishes within these regions. This leaves:\n$$\n\\iint_{\\Omega_L} \\left( \\partial_t(u_L \\phi) + \\partial_x(f(u_L) \\phi) \\right) dx dt + \\iint_{\\Omega_R} \\left( \\partial_t(u_R \\phi) + \\partial_x(f(u_R) \\phi) \\right) dx dt = 0\n$$\nBy the divergence theorem, this is equivalent to a sum of line integrals over the boundaries $\\partial\\Omega_L$ and $\\partial\\Omega_R$.\n$$\n\\oint_{\\partial\\Omega_L} \\begin{pmatrix} f(u_L)\\phi \\\\ u_L\\phi \\end{pmatrix} \\cdot \\mathbf{n} \\, d\\ell + \\oint_{\\partial\\Omega_R} \\begin{pmatrix} f(u_R)\\phi \\\\ u_R\\phi \\end{pmatrix} \\cdot \\mathbf{n} \\, d\\ell = 0\n$$\nwhere $\\mathbf{n}$ is the outward-pointing normal. The contributions from the parts of the boundaries that coincide with the boundary of $\\Omega$ cancel out if we sum them, or vanish if $\\phi$ has compact support within $\\Omega$. The only remaining contributions are from the interface $\\Gamma$, which is traversed in opposite directions for each integral. Let the normal to $\\Gamma$, pointing from left to right, be $\\mathbf{n}_{\\Gamma} = (n_x, n_t) = (1, -s) / \\sqrt{1+s^2}$. The integral relation reduces to an integral along the curve $\\Gamma$:\n$$\n\\int_{\\Gamma} \\left( f(u_L) n_x + u_L n_t \\right) \\phi \\, d\\ell - \\int_{\\Gamma} \\left( f(u_R) n_x + u_R n_t \\right) \\phi \\, d\\ell = 0\n$$\nThis simplifies to:\n$$\n\\int_{\\Gamma} \\left( (f(u_L) - f(u_R)) n_x + (u_L - u_R) n_t \\right) \\phi \\, d\\ell = 0\n$$\nSince this must hold for any test function $\\phi$, the integrand must be zero. Let $[q] = q_R - q_L$ denote the jump in a quantity $q$.\n$$\n- [f(u)] n_x - [u] n_t = 0\n$$\nSubstituting the components of the normal vector $(n_x, n_t)$, we get:\n$$\n(f(u_R) - f(u_L)) \\cdot 1 + (u_R - u_L) \\cdot (-s) = 0\n$$\nSolving for $s$, we obtain the Rankine-Hugoniot jump condition:\n$$\ns = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{[f(u)]}{[u]}\n$$\n\nNext, we address the entropy condition. The conservation law can be written in quasilinear form as $u_t + f'(u)u_x = 0$. The quantity $a(u) = f'(u)$ is the characteristic speed, which is the speed at which information about the value $u$ propagates. Since the flux $f$ is strictly convex, $f''(u)  0$, which implies that the characteristic speed $a(u) = f'(u)$ is a strictly increasing function of $u$.\n\nA discontinuous solution, or shock, is physically admissible only if characteristics on both sides of the discontinuity flow into it. If characteristics were to flow out of the discontinuity, it would imply a non-unique evolution, as small perturbations could propagate away, leading to different solutions. For characteristics to enter the shock from the left, their speed must be greater than the shock speed $s$. For characteristics to enter from the right, their speed must be less than $s$. This gives the Lax entropy condition:\n$$\na(u_L)  s  a(u_R) \\quad \\implies \\quad f'(u_L)  s  f'(u_R)\n$$\n\nNow we can determine the nature of the solution to the Riemann problem.\nCase 1: $u_L  u_R$.\nSince $f'(u)$ is a strictly increasing function, $u_L  u_R$ implies $f'(u_L)  f'(u_R)$. In this situation, it is possible for a shock speed $s$ to exist that satisfies the Lax entropy condition. By the Mean Value Theorem, the shock speed $s = \\frac{f(u_L) - f(u_R)}{u_L - u_R}$ is equal to $f'(c)$ for some $c \\in (u_R, u_L)$. Since $f'$ is strictly increasing, this means $f'(u_R)  f'(c)  f'(u_L)$, so $f'(u_R)  s  f'(u_L)$. The entropy condition is automatically satisfied. Thus, for $u_L  u_R$, the solution is a single shock wave moving with speed $s$. The characteristics are colliding.\n\nCase 2: $u_L  u_R$.\nSince $f'(u)$ is strictly increasing, $u_L  u_R$ implies $f'(u_L)  f'(u_R)$. The Lax entropy condition $f'(u_L)  s  f'(u_R)$ can never be satisfied. A discontinuous solution is therefore not admissible. The characteristics are spreading apart. The solution must be a continuous, self-similar solution $u(x,t) = w(x/t)$ known as a centered rarefaction wave, which connects the state $u_L$ to $u_R$ through all intermediate values.\n\nFinally, the problem asks for the shock speed $s$ for the case $u_L  u_R$. As demonstrated, this case corresponds to a shock wave whose speed is determined by the Rankine-Hugoniot jump condition. We can write the expression for $s$ as:\n$$\ns = \\frac{f(u_L) - f(u_R)}{u_L - u_R}\n$$\nThis is the required closed-form analytical expression.",
            "answer": "$$\n\\boxed{\\frac{f(u_L) - f(u_R)}{u_L - u_R}}\n$$"
        },
        {
            "introduction": "Building upon the general theory of Riemann problems, this practice asks you to apply those principles to a concrete and important case: the inviscid Burgers' equation. You will derive the explicit analytical form of the Godunov numerical flux, which is based on the exact solution at the element interface . This exercise is crucial as it bridges the gap between abstract theory and the practical construction of a numerical scheme, revealing how the 'exact' local solution provides the necessary physical dissipation to ensure the stability of the DG method.",
            "id": "3401198",
            "problem": "Consider the scalar conservation law Burgers’ equation $u_{t} + (f(u))_{x} = 0$ with $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional Discontinuous Galerkin (DG) method, the inter-element coupling is effected via a numerical flux at each interface. The Godunov numerical flux is defined as the physical flux evaluated at the state of the exact self-similar Riemann solution at the interface $x=0$ for the initial data $u(x,0) = u^{-}$ for $x0$ and $u(x,0) = u^{+}$ for $x0$. Starting from the fundamental principles for scalar conservation laws, namely (i) Rankine–Hugoniot jump condition for shocks, (ii) Lax entropy condition for admissible discontinuities, and (iii) method of characteristics for rarefactions, derive the explicit analytic expression of the Godunov flux $F_{G}(u^{-},u^{+})$ in terms of $u^{-}$ and $u^{+}$ for Burgers’ equation. Then, explain how using this flux in the DG method at interfaces yields a discrete entropy (quadratic entropy) inequality and stabilizes the semi-discrete scheme by dissipating inter-element jumps.\n\nYour final answer must be the single closed-form analytic expression for $F_{G}(u^{-},u^{+})$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the Godunov numerical flux for Burgers' equation, followed by an explanation of its role in ensuring entropy stability in a Discontinuous Galerkin (DG) framework.\n\nThe scalar conservation law under consideration is Burgers' equation:\n$$\nu_{t} + \\left(\\frac{u^2}{2}\\right)_x = 0\n$$\nwhere the flux function is $f(u) = \\frac{u^2}{2}$. The characteristic speed is given by $c(u) = f'(u) = u$.\n\nThe Godunov numerical flux, $F_{G}(u^{-},u^{+})$, is defined as the physical flux evaluated at the self-similar solution of the Riemann problem at the interface location $x=0$. The Riemann problem is defined by the initial condition:\n$$\nu(x,0) = \\begin{cases} u^{-}  x  0 \\\\ u^{+}  x  0 \\end{cases}\n$$\nThe solution to this problem, $u(x,t)$, is a function of the similarity variable $\\xi = x/t$. The Godunov flux is then $F_{G}(u^{-},u^{+}) = f(u(0,t)) = f(u(\\xi=0))$. We must analyze the solution based on the relationship between $u^{-}$ and $u^{+}$.\n\n**Part 1: Derivation of the Godunov Flux $F_{G}(u^{-},u^{+})$**\n\nThe nature of the Riemann solution depends on whether characteristics are diverging or converging.\n\n**Case 1: Rarefaction Wave ($u^{-}  u^{+}$)**\nThe characteristics with speeds $c(u)=u$ are diverging from the origin, creating a continuous solution known as a rarefaction wave. The solution is given by:\n$$\nu(x,t) = \\begin{cases} u^{-}  \\text{for } x/t  u^{-} \\\\ x/t  \\text{for } u^{-} \\le x/t \\le u^{+} \\\\ u^{+}  \\text{for } x/t  u^{+} \\end{cases}\n$$\nThe state at the interface, $u(\\xi=0)$, is found by evaluating this solution at $x/t=0$.\n- If $u^{-}  0  u^{+}$, the interface state is $u(0,t)=0$. The flux is $F_{G} = f(0) = 0$.\n- If $0 \\le u^{-}  u^{+}$, the characteristics have positive speeds, so they all move to the right. The region $x0$ remains in state $u^{-}$, thus the interface state is $u(0,t)=u^{-}$. The flux is $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$.\n- If $u^{-}  u^{+} \\le 0$, the characteristics have negative speeds, so they all move to the left. The region $x0$ remains in state $u^{+}$, thus the interface state is $u(0,t)=u^{+}$. The flux is $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$.\n\nThese three sub-cases for the rarefaction wave can be summarized elegantly. The flux function $f(u) = u^2/2$ is convex, with a global minimum at $u=0$. The value of the Godunov flux in a rarefaction corresponds to the value of the physical flux at the point that minimizes $f(u)$ over the interval $[u^{-}, u^{+}]$. That is, for $u^{-}  u^{+}$,\n$$\nF_{G}(u^{-},u^{+}) = \\min_{u \\in [u^{-}, u^{+}]} f(u)\n$$\n\n**Case 2: Shock Wave ($u^{-}  u^{+}$)**\nThe characteristics are converging, which leads to the formation of a discontinuity, or shock. The speed of this shock, $s$, is determined by the Rankine-Hugoniot jump condition:\n$$\ns = \\frac{[f]}{[u]} = \\frac{f(u^{+}) - f(u^{-})}{u^{+} - u^{-}}\n$$\nFor Burgers' equation, this yields:\n$$\ns = \\frac{\\frac{(u^{+})^2}{2} - \\frac{(u^{-})^2}{2}}{u^{+} - u^{-}} = \\frac{(u^{+} - u^{-})(u^{+} + u^{-})}{2(u^{+} - u^{-})} = \\frac{u^{-} + u^{+}}{2}\n$$\nA shock is physically admissible only if it satisfies the Lax entropy condition, which states that characteristics must enter the shock from both sides: $f'(u^{-})  s  f'(u^{+})$. For Burgers' equation, this is $u^{-}  s  u^{+}$.\n- $u^{-}  \\frac{u^{-} + u^{+}}{2} \\implies 2u^{-}  u^{-} + u^{+} \\implies u^{-}  u^{+}$\n- $\\frac{u^{-} + u^{+}}{2}  u^{+} \\implies u^{-} + u^{+} 2u^{+} \\implies u^{-}  u^{+}$\nThe condition is satisfied for any $u^{-}  u^{+}$, so all such shocks are admissible.\n\nThe state at the interface $x=0$ depends on the direction of shock propagation, determined by the sign of $s$.\n- If $s  0$ (i.e., $u^{-} + u^{+}  0$), the shock propagates to the right. For $t0$, the state at $x=0$ is the left state, $u^{-}$. The flux is $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$.\n- If $s  0$ (i.e., $u^{-} + u^{+}  0$), the shock propagates to the left. For $t0$, the state at $x=0$ is the right state, $u^{+}$. The flux is $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$.\n- If $s = 0$ (i.e., $u^{-} + u^{+} = 0$), the shock is stationary at $x=0$. The Rankine-Hugoniot condition implies $f(u^{+}) - f(u^{-}) = 0$, so $f(u^{-}) = f(u^{+})$. The flux is continuous across the shock, and we can take either value. Note that $f(u^{-}) = f(-u^{+}) = \\frac{(-u^{+})^2}{2} = \\frac{(u^{+})^2}{2} = f(u^{+})$. Our convention for $s \\le 0$ correctly selects $f(u^{+})$.\n\nWe can express these sub-cases for the shock wave in a compact form. The sign of $f(u^{-}) - f(u^{+}) = \\frac{1}{2}(u^{-}-u^{+})(u^{-}+u^{+})$ depends on the sign of $u^{-}+u^{+}$, since $u^{-}-u^{+}0$.\n- If $u^{-}+u^{+}  0$, then $f(u^{-})  f(u^{+})$, so $F_{G} = f(u^{-}) = \\max(f(u^{-}), f(u^{+}))$.\n- If $u^{-}+u^{+}  0$, then $f(u^{-})  f(u^{+})$, so $F_{G} = f(u^{+}) = \\max(f(u^{-}), f(u^{+}))$.\nSince $f(u)=u^2/2$ is convex, its maximum on an interval $[u^{+}, u^{-}]$ must occur at an endpoint. Thus, for $u^{-}  u^{+}$,\n$$\nF_{G}(u^{-},u^{+}) = \\max(f(u^{-}), f(u^{+}))\n$$\n\n**Explicit Analytic Expression for $F_{G}(u^{-},u^{+})$**\nCombining all cases, we arrive at the explicit piecewise definition of the Godunov flux for Burgers' equation:\n$$\nF_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right)  \\text{if } u^{-}  u^{+} \\\\ \\frac{(u^{-})^2}{2}  \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0  \\text{if } u^{-}  0  u^{+} \\\\ \\frac{(u^{+})^2}{2}  \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}\n$$\nNote that the case $u^{-}=u^{+}$ is consistent, as $F_G(u,u) = f(u)$.\n\n**Part 2: Entropy Stability and Scheme Stabilization**\n\nThe use of the Godunov flux in a DG scheme ensures that a discrete version of the entropy inequality is satisfied, thereby guaranteeing the nonlinear stability of the semi-discrete scheme.\n\nFor a convex entropy function $U(u)$ and corresponding entropy flux $Q(u)$ (where $Q'(u) = U'(u)f'(u)$), the continuous entropy inequality is $U(u)_t + Q(u)_x \\le 0$. For Burgers' equation, the quadratic entropy is $U(u) = u^2/2$, for which $U'(u)=u$ and the entropy flux is $Q(u) = u^3/3$.\n\nIn a DG scheme, summing the local weak formulation over all elements and choosing the test function $v_h = U'(u_h) = u_h$ leads to an evolution equation for the total entropy $\\mathcal{E}(t) = \\int_{\\Omega} U(u_h) dx$. The rate of change of total entropy is determined by the sum of contributions from each inter-element interface. The contribution from the interface between states $u^{-}$ and $u^{+}$ is the numerical entropy dissipation:\n$$\n\\mathcal{D}(u^{-}, u^{+}) = F_G(u^{-}, u^{+}) [U'] - [Q] = F_G(u^{-}, u^{+})(u^{+} - u^{-}) - \\left(\\frac{(u^{+})^3}{3} - \\frac{(u^{-})^3}{3}\\right)\n$$\nThe semi-discrete scheme is entropy stable if this term is non-positive, i.e., $\\mathcal{D}(u^{-}, u^{+}) \\le 0$, at every interface. This would imply $\\frac{d\\mathcal{E}}{dt} \\le 0$.\n\nThe Godunov flux is an \"E-flux,\" a class of numerical fluxes known to be entropy-satisfying. An E-flux satisfies the property that $(u^{-} - u^{+})(F_G(u^{-},u^{+}) - f(u)) \\ge 0$ for all values of $u$ on the path between $u^{-}$ and $u^{+}$. As shown in Part 1, the Godunov flux for Burgers' equation is $F_G = \\max f$ for shocks ($u^{-}u^{+}$) and $F_G = \\min f$ for rarefactions ($u^{-}u^{+}$), which directly satisfies this condition. This property is sufficient to prove that $\\mathcal{D}(u^{-}, u^{+}) \\le 0$.\n\nThis dissipation mechanism is what stabilizes the scheme. Inter-element jumps $[u] = u^+ - u^-$ are sources of potential instability, especially for under-resolved shocks which manifest as oscillations. The Godunov flux introduces a precise amount of numerical dissipation—no more and no less than what is present in the exact solution of the local Riemann problem.\n- For a rarefaction ($u^{-}u^{+}$), the exact solution is smooth and entropy is conserved. The Godunov flux is constructed to yield zero numerical entropy dissipation in this case (apart from spatial discretization errors within the element).\n- For a shock ($u^{-}u^{+}$), the exact solution is discontinuous and produces entropy. The Godunov flux mimics this physical dissipation by satisfying $\\mathcal{D}(u^{-}, u^{+})  0$, effectively damping oscillations that would arise from the jump and ensuring the correct shock propagation.\n\nIn conclusion, the Godunov flux stabilizes the DG scheme by building in the physical mechanism of entropy production at discontinuities, preventing the growth of non-physical oscillations and ensuring the solution converges to the weak, entropy-satisfying solution of the PDE.",
            "answer": "$$\n\\boxed{F_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right)  \\text{if } u^{-}  u^{+} \\\\ \\frac{(u^{-})^2}{2}  \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0  \\text{if } u^{-}  0  u^{+} \\\\ \\frac{(u^{+})^2}{2}  \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}}\n$$"
        },
        {
            "introduction": "While numerical fluxes ensure stability, the inherent polynomial nature of DG approximations can struggle to accurately capture sharp features, a prime example being the speed of an under-resolved shock wave. This hands-on programming challenge addresses this practical limitation by guiding you to implement a subcell reconstruction technique . By replacing inaccurate pointwise data with more robust local averages, you will develop and test a correction that significantly improves the shock speed estimate, offering a glimpse into advanced techniques for enhancing the fidelity of DG simulations.",
            "id": "3377131",
            "problem": "Consider the one-dimensional scalar conservation law $u_t + (f(u))_x = 0$ and its weak solution containing a single shock separating two constant plateau states $u_L^\\star$ (left) and $u_R^\\star$ (right). The Rankine–Hugoniot condition gives the shock speed $s^\\star = \\dfrac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star}$. In a Discontinuous Galerkin (DG) method, the numerical solution in each cell is represented by a polynomial of degree $p$ in Legendre modal form on the reference interval $\\xi \\in [-1,1]$, $u_h(\\xi) = \\sum_{k=0}^p a_k P_k(\\xi)$, where $P_k$ is the $k$-th Legendre polynomial and $a_k$ are the modal coefficients. At a cell interface, the DG solution provides one-sided polynomial traces, which can be used to form a numerical estimate of the shock speed by inserting these traces into the Rankine–Hugoniot formula.\n\nYour task is to derive, implement, and test a correction for under-resolved shocks that improves the shock speed estimate by locally reconstructing plateau states using subcell averages near the interface. Begin from the integral form of conservation and the definition of Rankine–Hugoniot, and then derive an algorithm that replaces the pointwise DG interface traces with local subcell averages over small intervals adjacent to the interface on each side. Use the following principles and requirements.\n\n- Start from the integral conservation statement across a moving discontinuity and the Rankine–Hugoniot condition. The numerical DG state at the interface is given by the one-sided polynomial trace $u_h(\\pm 1)$. Use these traces in the Rankine–Hugoniot formula to define a baseline DG shock speed estimate $s_{\\mathrm{DG}}$.\n- Define a local subcell reconstruction as follows. For a given integer $M \\ge 1$, let the subcell width in reference coordinates be $\\Delta \\xi = \\dfrac{2}{M}$. On the left cell, define the left reconstructed state as the subcell average near the right interface,\n  $$ \\bar{u}_L^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{1 - \\Delta \\xi}^{1} u_h^{(L)}(\\xi)\\, d\\xi, $$\n  and on the right cell, define the right reconstructed state near the left interface,\n  $$ \\bar{u}_R^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{-1}^{-1 + \\Delta \\xi} u_h^{(R)}(\\xi)\\, d\\xi. $$\n  Use these reconstructed subcell averages $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$ as corrected plateau state estimates in a corrected Rankine–Hugoniot shock speed $s_{\\mathrm{corr}} = \\dfrac{f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}})}{\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}}}$.\n- Your program must implement the above baseline and corrected shock speed estimates. The Legendre polynomials must be taken as the standard polynomials $P_0(\\xi) = 1$, $P_1(\\xi) = \\xi$, $P_2(\\xi) = \\dfrac{1}{2}(3\\xi^2 - 1)$, etc. The interface traces are evaluated at $\\xi = 1$ (right side of the left cell) and $\\xi = -1$ (left side of the right cell). The subcell averages must be computed by numerical quadrature that is exact for polynomials of degree at least $p$; use Gaussian–Legendre quadrature mapped to the subintervals to evaluate the integrals defining $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$.\n- For each test case, compute the exact shock speed $s^\\star = \\dfrac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star}$ from the given plateau states $u_L^\\star$ and $u_R^\\star$. Then compute the absolute baseline error $E_{\\mathrm{DG}} = |s_{\\mathrm{DG}} - s^\\star|$ and the absolute corrected error $E_{\\mathrm{corr}} = |s_{\\mathrm{corr}} - s^\\star|$. Report, for each test, the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$ as a single floating-point number, where a positive value indicates that the correction improved the estimate.\n\nUse the following test suite. In all cases, use polynomial degree $p = 2$ and subcell count $M = 4$.\n\n- Test $1$ (convex quadratic flux, under-resolved jump):\n  - Flux: $f(u) = \\dfrac{1}{2} u^2$.\n  - True plateau states: $u_L^\\star = 2.0$, $u_R^\\star = 0.0$.\n  - Left cell coefficients: $\\boldsymbol{a}^{(L)} = [1.95,\\,-0.08,\\,0.03]$.\n  - Right cell coefficients: $\\boldsymbol{a}^{(R)} = [0.10,\\,0.12,\\,0.03]$.\n- Test $2$ (linear flux edge case, constant signal speed):\n  - Flux: $f(u) = a\\, u$ with $a = 1.3$.\n  - True plateau states: $u_L^\\star = 1.0$, $u_R^\\star = 0.0$.\n  - Left cell coefficients: $\\boldsymbol{a}^{(L)} = [0.90,\\,0.20,\\,-0.05]$.\n  - Right cell coefficients: $\\boldsymbol{a}^{(R)} = [0.10,\\,0.00,\\,0.00]$.\n- Test $3$ (convex cubic flux, asymmetric bias):\n  - Flux: $f(u) = \\dfrac{1}{3} u^3$.\n  - True plateau states: $u_L^\\star = 1.5$, $u_R^\\star = -0.5$.\n  - Left cell coefficients: $\\boldsymbol{a}^{(L)} = [1.55,\\,-0.08,\\,0.00]$.\n  - Right cell coefficients: $\\boldsymbol{a}^{(R)} = [-0.48,\\,0.03,\\,0.00]$.\n\nImplementation details and output specification:\n\n- Represent each cell polynomial as $u_h(\\xi) = \\sum_{k=0}^{2} a_k P_k(\\xi)$, with the given modal coefficients in the standard Legendre basis on $[-1,1]$.\n- Compute the one-sided DG interface traces using evaluation at $\\xi = 1$ (for the left cell) and $\\xi = -1$ (for the right cell).\n- Compute subcell averages using Gaussian–Legendre quadrature of sufficient order mapped to the subintervals $[1 - \\Delta \\xi, 1]$ and $[-1, -1 + \\Delta \\xi]$ with $\\Delta \\xi = \\dfrac{2}{M}$.\n- For each test case, output the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$ rounded to six decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$0.012345$, $0.000000$, $0.004200$]\") in the order of Tests $1$–$3$.\n\nAll answers are purely numerical; no physical units or angles are required in this problem. Ensure that every mathematical entity in this problem statement is written in LaTeX using $...$ delimiters.",
            "solution": "The problem requires the derivation and implementation of a corrected shock speed estimate for a Discontinuous Galerkin (DG) numerical method applied to a one-dimensional scalar conservation law, $u_t + (f(u))_x = 0$. The correction is based on local subcell averaging to better approximate the plateau states on either side of a shock discontinuity.\n\nThe analysis begins with the integral form of the conservation law over a spacetime rectangle $[x_L, x_R] \\times [t_1, t_2]$ containing a shock propagating with speed $s$. This leads to the Rankine–Hugoniot condition for the exact shock speed $s^\\star$:\n$$\ns^\\star = \\frac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star} = \\frac{[f(u)]}{[u]}\n$$\nwhere $u_L^\\star$ and $u_R^\\star$ are the constant states to the left and right of the shock, respectively, and $[ \\cdot ]$ denotes the jump in a quantity across the discontinuity.\n\nIn a DG framework, the numerical solution within each computational cell is represented by a polynomial. For this problem, the polynomial is of degree $p$ on the reference interval $\\xi \\in [-1, 1]$, expressed in a Legendre modal basis:\n$$\nu_h(\\xi) = \\sum_{k=0}^p a_k P_k(\\xi)\n$$\nwhere $P_k(\\xi)$ is the $k$-th Legendre polynomial and $a_k$ are the modal coefficients. The given degree is $p=2$, so the relevant polynomials are:\n$$\nP_0(\\xi) = 1, \\quad P_1(\\xi) = \\xi, \\quad P_2(\\xi) = \\frac{1}{2}(3\\xi^2 - 1)\n$$\nThe solution in a given cell is thus explicit: $u_h(\\xi) = a_0 + a_1 \\xi + a_2 \\frac{1}{2}(3\\xi^2 - 1)$.\n\nA baseline numerical estimate for the shock speed, $s_{\\mathrm{DG}}$, can be formed by substituting the one-sided traces of the DG solution at the cell interface directly into the Rankine–Hugoniot formula. Let the interface be between a \"left\" cell and a \"right\" cell. The right boundary of the left cell corresponds to $\\xi=1$, and the left boundary of the right cell corresponds to $\\xi=-1$. The one-sided traces are:\n$$\nu_L = u_h^{(L)}(\\xi=1) = a_0^{(L)} P_0(1) + a_1^{(L)} P_1(1) + a_2^{(L)} P_2(1) = a_0^{(L)} + a_1^{(L)} + a_2^{(L)}\n$$\n$$\nu_R = u_h^{(R)}(\\xi=-1) = a_0^{(R)} P_0(-1) + a_1^{(R)} P_1(-1) + a_2^{(R)} P_2(-1) = a_0^{(R)} - a_1^{(R)} + a_2^{(R)}\n$$\nThe baseline shock speed estimate is then:\n$$\ns_{\\mathrm{DG}} = \\frac{f(u_R) - f(u_L)}{u_R - u_L}\n$$\n\nFor under-resolved shocks, the polynomial oscillations near the discontinuity (Gibbs phenomenon) can make the pointwise traces $u_L$ and $u_R$ poor approximations of the true plateau states $u_L^\\star$ and $u_R^\\star$. The proposed correction aims to mitigate this by using local averages as more robust estimates of the plateau states.\n\nA subcell reconstruction defines corrected states $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$ by averaging the DG polynomial over small sub-intervals adjacent to the interface. Given a subcell count $M$, the width of the sub-interval in reference coordinates is $\\Delta\\xi = 2/M$. The corrected states are defined as:\n$$\n\\bar{u}_L^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{1 - \\Delta \\xi}^{1} u_h^{(L)}(\\xi)\\, d\\xi\n$$\n$$\n\\bar{u}_R^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{-1}^{-1 + \\Delta \\xi} u_h^{(R)}(\\xi)\\, d\\xi\n$$\nUsing these averaged states, a corrected shock speed estimate, $s_{\\mathrm{corr}}$, is formulated:\n$$\ns_{\\mathrm{corr}} = \\frac{f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}})}{\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}}}\n$$\n\nTo compute the integrals for $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$, we employ Gaussian-Legendre quadrature, which is required to be exact for polynomials of degree at least $p=2$. An $N$-point Gauss-Legendre quadrature rule is exact for polynomials of degree up to $2N-1$. For our integrand of degree $p=2$, we need $2N-1 \\ge 2$, which implies $N \\ge 1.5$. Thus, a $2$-point quadrature rule ($N=2$, exact up to degree $3$) is sufficient.\n\nTo evaluate an integral $\\int_a^b g(\\xi) d\\xi$ using an $N$-point Gauss-Legendre rule, we map the interval $[a, b]$ to the reference quadrature interval $[-1, 1]$ using the transformation $\\xi(\\eta) = \\frac{b-a}{2}\\eta + \\frac{a+b}{2}$. The integral is then approximated as:\n$$\n\\int_a^b g(\\xi) d\\xi = \\frac{b-a}{2} \\int_{-1}^1 g(\\xi(\\eta)) d\\eta \\approx \\frac{b-a}{2} \\sum_{i=1}^N w_i g(\\xi(\\eta_i))\n$$\nwhere $(\\eta_i, w_i)$ are the standard Gauss-Legendre nodes and weights on $[-1, 1]$.\n\nFor the given parameters $p=2$ and $M=4$, we have $\\Delta\\xi = 2/4 = 0.5$.\nThe integration interval for $\\bar{u}_L^{\\mathrm{sub}}$ is $[1 - 0.5, 1] = [0.5, 1]$.\nThe integration interval for $\\bar{u}_R^{\\mathrm{sub}}$ is $[-1, -1 + 0.5] = [-1, -0.5]$.\n\nThe final task is to calculate the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$ for each test case, where the errors are defined as $E_{\\mathrm{DG}} = |s_{\\mathrm{DG}} - s^\\star|$ and $E_{\\mathrm{corr}} = |s_{\\mathrm{corr}} - s^\\star|$. A positive value of $I$ indicates that the subcell correction improved the shock speed estimate.\n\nThe algorithm for each test case is as follows:\n1.  Given the true plateau states $u_L^\\star$ and $u_R^\\star$ and the flux function $f(u)$, calculate the exact shock speed $s^\\star$.\n2.  Given the modal coefficients $\\boldsymbol{a}^{(L)}$ and $\\boldsymbol{a}^{(R)}$, calculate the interface traces $u_L = u_h^{(L)}(1)$ and $u_R = u_h^{(R)}(-1)$.\n3.  Compute the baseline shock speed $s_{\\mathrm{DG}} = (f(u_R) - f(u_L))/(u_R - u_L)$.\n4.  Set up the $2$-point Gauss-Legendre quadrature for the sub-intervals $[0.5, 1]$ and $[-1, -0.5]$.\n5.  Evaluate the average values $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$ using the quadrature rule.\n6.  Compute the corrected shock speed $s_{\\mathrm{corr}} = (f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}}))/(\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}})$.\n7.  Calculate the absolute errors $E_{\\mathrm{DG}}$ and $E_{\\mathrm{corr}}$.\n8.  Compute the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$.\nThis procedure is applied to all specified test cases. For the linear flux case $f(u) = au$, the Rankine-Hugoniot speed is always $s=a$, provided the states on either side of the shock are not equal. This serves as a useful analytical check on the implementation.",
            "answer": "[0.006223, 0.000000, 0.017534]"
        }
    ]
}