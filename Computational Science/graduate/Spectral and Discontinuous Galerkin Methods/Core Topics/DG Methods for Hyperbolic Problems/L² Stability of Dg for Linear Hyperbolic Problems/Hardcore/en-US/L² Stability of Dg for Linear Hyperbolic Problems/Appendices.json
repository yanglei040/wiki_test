{
    "hands_on_practices": [
        {
            "introduction": "The stability of a numerical method is paramount for generating reliable solutions. A natural first attempt at defining a numerical flux at an interface is to simply average the values from the left and right, leading to the central flux. This practice will serve as a critical cautionary tale, demonstrating that this intuitive choice, when paired with a simple explicit time-stepping scheme, leads to an unconditionally unstable method. By performing a von Neumann stability analysis, you will mathematically prove that the discrete $L^2$ energy grows at every time step, highlighting why more sophisticated flux designs are necessary .",
            "id": "3394374",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}\\setminus\\{0\\}$ on the periodic domain $x \\in [0,2\\pi]$. Discretize the domain into $N$ uniform cells of width $h = \\frac{2\\pi}{N}$, and approximate $u$ by a piecewise constant function on each cell (polynomial degree zero) using the Discontinuous Galerkin (DG) method. Employ the central numerical flux at interfaces, defined by $\\widehat{u} = \\frac{1}{2}\\left(u^{-} + u^{+}\\right)$, and advance in time with the forward Euler method with time step $\\Delta t  0$. Define the discrete $L^{2}$ energy of a cellwise constant vector $(u_{j})_{j=0}^{N-1}$ by $E = h \\sum_{j=0}^{N-1} |u_{j}|^{2}$.\n\nStarting from the weak form with test function $v \\equiv 1$ on each cell and the flux balance at interfaces, derive the semi-discrete update for the cell averages and the corresponding forward Euler step. Then, consider the discrete Fourier mode $u_{j}^{n} = \\alpha^{n} \\exp\\!\\big(i\\,\\theta\\,j\\big)$ with $\\theta = \\frac{\\pi}{2}$ on the uniform grid, and determine the one-step amplification factor of the discrete $L^{2}$ energy, defined as the ratio $\\frac{E^{n+1}}{E^{n}}$ for this mode.\n\nProvide your final answer as a single closed-form expression in terms of $a$, $\\Delta t$, and $h$. No numerical evaluation is required.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\nThe problem asks for the derivation of the one-step amplification factor for the discrete $L^2$ energy of a Discontinuous Galerkin (DG) scheme for the linear advection equation.\n\nGivens extracted from the problem statement:\n-   PDE: $u_{t} + a\\,u_{x} = 0$, where $a \\in \\mathbb{R}\\setminus\\{0\\}$ is a constant wave speed.\n-   Domain: $x \\in [0, 2\\pi]$, periodic.\n-   Discretization: $N$ uniform cells, $K_j = [x_{j-1/2}, x_{j+1/2}]$, of width $h = \\frac{2\\pi}{N}$.\n-   Approximation space: Piecewise constant functions on each cell (polynomial degree $p=0$). The solution in cell $K_j$ is denoted by the constant value $u_j$.\n-   Numerical flux: Central flux, $\\widehat{u} = \\frac{1}{2}\\left(u^{-} + u^{+}\\right)$, where $u^{-}$ and $u^{+}$ are the values at the interface from the left and right cells, respectively.\n-   Time integration: Forward Euler method with time step $\\Delta t  0$.\n-   Test function: $v \\equiv 1$ on each cell.\n-   Discrete $L^2$ energy definition: $E = h \\sum_{j=0}^{N-1} |u_{j}|^{2}$.\n-   Fourier mode for analysis: $u_{j}^{n} = \\alpha^{n} \\exp\\!\\big(i\\,\\theta\\,j\\big)$ with wave number $\\theta = \\frac{\\pi}{2}$.\n-   Objective: Find the energy amplification factor $\\frac{E^{n+1}}{E^{n}}$ for this mode.\n\nThe problem is valid. It is a standard von Neumann stability analysis of a widely used numerical method (DG-P0) for a fundamental hyperbolic PDE. All components are clearly defined, and the question is self-contained and mathematically well-posed. There are no scientific flaws, ambiguities, or contradictions.\n\nWe proceed with the solution.\n\nFirst, we derive the semi-discrete scheme. We start with the PDE $u_{t} + a\\,u_{x} = 0$. We multiply by a test function $v$ and integrate over a cell $K_j = [x_{j-1/2}, x_{j+1/2}]$:\n$$\n\\int_{K_j} u_t v \\,dx + \\int_{K_j} a u_x v \\,dx = 0\n$$\nFor a piecewise constant approximation $u(x,t) = u_j(t)$ for $x \\in K_j$, and using the specified constant test function $v(x) = 1$ for $x \\in K_j$, the first term becomes:\n$$\n\\int_{K_j} \\frac{d u_j}{dt} (1) \\,dx = \\frac{d u_j}{dt} \\int_{K_j} dx = h \\frac{d u_j}{dt}\n$$\nThe second term is integrated by parts:\n$$\n\\int_{K_j} a u_x v \\,dx = a [u v]_{x_{j-1/2}}^{x_{j+1/2}} - a \\int_{K_j} u v_x \\,dx\n$$\nSince $v$ is constant on the cell, its derivative $v_x = 0$, so the integral on the right-hand side vanishes. The boundary term is evaluated using the numerical flux. The physical flux is $f(u) = au$. The numerical flux at an interface is $\\widehat{f} = a \\widehat{u}$. The integration by parts formula for the DG method is:\n$$\n\\int_{K_j} a u_x v \\,dx = a \\left( \\widehat{u}(x_{j+1/2}) v(x_{j+1/2}^-) - \\widehat{u}(x_{j-1/2}) v(x_{j-1/2}^+) \\right)\n$$\nwhere $v$ is evaluated from within the cell $K_j$, meaning $v(x_{j+1/2}^-) = v(x_{j-1/2}^+) = 1$. The numerical flux values are given by the central flux formula:\n-   At interface $x_{j+1/2}$: $\\widehat{u}_{j+1/2} = \\frac{1}{2}(u_j + u_{j+1})$.\n-   At interface $x_{j-1/2}$: $\\widehat{u}_{j-1/2} = \\frac{1}{2}(u_{j-1} + u_j)$.\nSubstituting these into the weak form, we get:\n$$\nh \\frac{d u_j}{dt} + a \\left( \\frac{u_j + u_{j+1}}{2} - \\frac{u_{j-1} + u_j}{2} \\right) = 0\n$$\nSimplifying the terms in the parenthesis gives:\n$$\nh \\frac{d u_j}{dt} + a \\left( \\frac{u_{j+1} - u_{j-1}}{2} \\right) = 0\n$$\nThis yields the semi-discrete ordinary differential equation for the cell average $u_j$:\n$$\n\\frac{d u_j}{dt} = - \\frac{a}{2h} (u_{j+1} - u_{j-1})\n$$\n\nNext, we apply the forward Euler method for time discretization: $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{d u_j}{dt}\\Big|_n$.\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{a}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\nThe fully discrete update rule is:\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\nLet $\\lambda = \\frac{a \\Delta t}{h}$ be the Courant number. The scheme is:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\nNow, we perform a von Neumann stability analysis by substituting the discrete Fourier mode $u_j^n = \\alpha^n \\exp(i \\theta j)$:\n$$\n\\alpha^{n+1} \\exp(i \\theta j) = \\alpha^n \\exp(i \\theta j) - \\frac{\\lambda}{2} \\left[ \\alpha^n \\exp(i \\theta (j+1)) - \\alpha^n \\exp(i \\theta (j-1)) \\right]\n$$\nWe divide by $\\alpha^n \\exp(i \\theta j)$:\n$$\n\\alpha = 1 - \\frac{\\lambda}{2} \\left[ \\exp(i \\theta) - \\exp(-i \\theta) \\right]\n$$\nUsing Euler's formula, $\\exp(i\\theta) - \\exp(-i\\theta) = 2i \\sin(\\theta)$, the amplification factor $\\alpha$ becomes:\n$$\n\\alpha = 1 - \\frac{\\lambda}{2} (2i \\sin(\\theta)) = 1 - i \\lambda \\sin(\\theta)\n$$\nThe problem asks for the one-step amplification factor of the discrete $L^2$ energy, $E^n = h \\sum_{j=0}^{N-1} |u_j^n|^2$.\nLet's compute the ratio $\\frac{E^{n+1}}{E^n}$.\n$$\nE^{n+1} = h \\sum_{j=0}^{N-1} |u_j^{n+1}|^2 = h \\sum_{j=0}^{N-1} |\\alpha u_j^n|^2 = h \\sum_{j=0}^{N-1} |\\alpha|^2 |u_j^n|^2 = |\\alpha|^2 \\left( h \\sum_{j=0}^{N-1} |u_j^n|^2 \\right) = |\\alpha|^2 E^n\n$$\nThus, the energy amplification factor is $\\frac{E^{n+1}}{E^n} = |\\alpha|^2$.\nWe now compute $|\\alpha|^2$:\n$$\n|\\alpha|^2 = \\alpha \\overline{\\alpha} = (1 - i \\lambda \\sin(\\theta))(1 + i \\lambda \\sin(\\theta)) = 1^2 - (i \\lambda \\sin(\\theta))^2 = 1 - i^2 \\lambda^2 \\sin^2(\\theta) = 1 + \\lambda^2 \\sin^2(\\theta)\n$$\nThe problem specifies the analysis for the mode with $\\theta = \\frac{\\pi}{2}$. For this mode, $\\sin(\\theta) = \\sin(\\frac{\\pi}{2}) = 1$.\nSubstituting this value, the energy amplification factor is:\n$$\n\\frac{E^{n+1}}{E^n} = 1 + \\lambda^2 (1)^2 = 1 + \\lambda^2\n$$\nFinally, we express the result in terms of the given parameters $a$, $\\Delta t$, and $h$ by substituting back $\\lambda = \\frac{a \\Delta t}{h}$:\n$$\n\\frac{E^{n+1}}{E^n} = 1 + \\left(\\frac{a \\Delta t}{h}\\right)^2\n$$\nThis result, being greater than $1$ for any $\\Delta t  0$, demonstrates the unconditional instability of the DG-P0 method with central fluxes and forward Euler time stepping.",
            "answer": "$$\n\\boxed{1 + \\left(\\frac{a \\Delta t}{h}\\right)^{2}}\n$$"
        },
        {
            "introduction": "Having seen that the central flux is unstable, we now explore how to remedy this issue. The solution lies in adding a carefully calibrated numerical dissipation term to the flux, which penalizes jumps in the solution and removes the spurious energy growth. This exercise guides you through determining the minimal amount of dissipation required to guarantee $L^2$ stability for any Fourier mode under a given Courant–Friedrichs–Lewy (CFL) condition. This practice is fundamental to understanding the design of stable numerical schemes, such as the widely used Lax-Friedrichs or upwind fluxes .",
            "id": "3394373",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a \\in \\mathbb{R}$ on a periodic domain. Discretize the spatial domain with a uniform mesh of cells of width $h$ and apply a Discontinuous Galerkin (DG) method of polynomial degree zero (piecewise constants) with exact mass matrices, so that the cell average in each cell is the sole degree of freedom. Use an explicit forward Euler time integrator with time step $\\Delta t$, and assume the Courant–Friedrichs–Lewy (CFL) number $\\sigma := \\frac{a\\,\\Delta t}{h}$ satisfies $0  \\sigma \\leq 1$. At each cell interface, use a one-parameter family of consistent numerical fluxes defined by\n$$\nf^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right),\n$$\nwhere $u^{-}$ and $u^{+}$ denote the interior traces of $u$ on the left and right of the interface, respectively, and $\\lambda \\ge 0$ is a constant flux parameter with the same physical units as $a$.\n\nPerform a von Neumann analysis on this fully discrete scheme by assuming periodicity and a single Fourier mode in the cell indices. Derive the amplification factor $G(\\theta)$ as a function of the nondimensional wavenumber $\\theta \\in [-\\pi,\\pi]$. Then, impose the condition that the discrete $L^{2}$ norm of the solution does not increase in one forward Euler step for any Fourier mode, which is equivalent to the requirement $|G(\\theta)| \\leq 1$ for all $\\theta \\in [-\\pi,\\pi]$. Under the stated CFL constraint $0  \\sigma \\le 1$, determine the minimal value of the flux parameter $\\lambda_{\\min}$ (expressed as a symbolic analytic expression in terms of $a$, $\\Delta t$, and $h$) that guarantees the non-increasing $L^{2}$ condition for all Fourier modes.\n\nYour final answer must be a single closed-form analytic expression for $\\lambda_{\\min}$ with no units included in the expression.",
            "solution": "The user wants to find the minimal value of the flux parameter $\\lambda$ that ensures $L^2$ stability for a Discontinuous Galerkin (DG) scheme applied to the linear advection equation. The validation and solution process is as follows.\n\n### Step 1: Extract Givens\n-   **Equation**: $u_{t} + a\\,u_{x} = 0$, where $a \\in \\mathbb{R}$ is a constant.\n-   **Domain**: Periodic.\n-   **Discretization**: Uniform mesh with cell width $h$.\n-   **Method**: Discontinuous Galerkin with polynomial degree zero (DG-P0).\n-   **Mass Matrix**: Exact.\n-   **Time Integration**: Explicit forward Euler with time step $\\Delta t$.\n-   **CFL Condition**: $\\sigma := \\frac{a\\,\\Delta t}{h}$ satisfies $0  \\sigma \\leq 1$.\n-   **Numerical Flux**: $f^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right)$, with $\\lambda \\ge 0$.\n-   **Analysis**: von Neumann stability analysis.\n-   **Stability Condition**: The amplification factor $G(\\theta)$ must satisfy $|G(\\theta)| \\leq 1$ for all non-dimensional wavenumbers $\\theta \\in [-\\pi,\\pi]$.\n-   **Objective**: Find the minimal value $\\lambda_{\\min}$ of the flux parameter $\\lambda$ that guarantees the stability condition.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in the field of numerical analysis for partial differential equations. It describes a standard DG-P0 scheme for the linear advection equation and uses a classical von Neumann stability analysis, which is appropriate for linear, constant-coefficient problems on periodic domains.\n-   **Well-Posedness**: The problem is well-posed. It provides all necessary information: the PDE, discretization method, numerical flux, time-stepping scheme, and a precise stability criterion. The objective is to find a single, well-defined quantity, $\\lambda_{\\min}$.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the problem validation checklist (e.g., scientific unsoundness, incompleteness, ambiguity). It is a standard, solvable problem in computational fluid dynamics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be derived.\n\n### Derivation of the Solution\n\nThe DG-P0 semi-discretization of $u_{t} + a\\,u_{x} = 0$ on a cell $I_j = [x_{j-1/2}, x_{j+1/2}]$ uses piecewise constant basis and test functions. For a cell average $u_j(t)$, the scheme is given by:\n$$\nh \\frac{du_j}{dt} + f^*(x_{j+1/2}) - f^*(x_{j-1/2}) = 0\n$$\nwhere $f^*(x_{j+1/2})$ is the numerical flux at the interface between cells $j$ and $j+1$, and $f^*(x_{j-1/2})$ is the flux at the interface between cells $j-1$ and $j$. The states at these interfaces are $u^- = u_j, u^+ = u_{j+1}$ and $u^- = u_{j-1}, u^+ = u_j$, respectively.\n\nSubstituting the given numerical flux $f^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right)$:\n$$\nf^*(x_{j+1/2}) = a\\,\\frac{u_{j}+u_{j+1}}{2} - \\frac{\\lambda}{2}\\,(u_{j+1}-u_j)\n$$\n$$\nf^*(x_{j-1/2}) = a\\,\\frac{u_{j-1}+u_{j}}{2} - \\frac{\\lambda}{2}\\,(u_{j}-u_{j-1})\n$$\nThe semi-discrete equation becomes:\n$$\nh \\frac{du_j}{dt} = - \\left( a\\,\\frac{u_{j}+u_{j+1}}{2} - \\frac{\\lambda}{2}\\,(u_{j+1}-u_j) \\right) + \\left( a\\,\\frac{u_{j-1}+u_{j}}{2} - \\frac{\\lambda}{2}\\,(u_{j}-u_{j-1}) \\right)\n$$\nExpanding and collecting terms for $u_{j-1}$, $u_j$, and $u_{j+1}$:\n$$\nh \\frac{du_j}{dt} = u_{j+1}\\left(-\\frac{a}{2} + \\frac{\\lambda}{2}\\right) + u_j\\left(-\\frac{a}{2} - \\frac{\\lambda}{2} + \\frac{a}{2} - \\frac{\\lambda}{2}\\right) + u_{j-1}\\left(\\frac{a}{2} + \\frac{\\lambda}{2}\\right)\n$$\n$$\nh \\frac{du_j}{dt} = \\frac{\\lambda-a}{2} u_{j+1} - \\lambda u_j + \\frac{\\lambda+a}{2} u_{j-1}\n$$\nApplying the explicit forward Euler time integration, $u_j^{n+1} = u_j^n + \\Delta t \\frac{du_j}{dt}|_n$:\n$$\nu_j^{n+1} = u_j^n + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} u_{j-1}^n - \\lambda u_j^n + \\frac{\\lambda-a}{2} u_{j+1}^n \\right)\n$$\nFor the von Neumann analysis, we assume a single Fourier mode solution $u_j^n = (G(\\theta))^n e^{ij\\theta}$, where $\\theta=kh$ is the non-dimensional wavenumber. Substituting this into the scheme:\n$$\nG(\\theta) e^{ij\\theta} = e^{ij\\theta} + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} e^{i(j-1)\\theta} - \\lambda e^{ij\\theta} + \\frac{\\lambda-a}{2} e^{i(j+1)\\theta} \\right)\n$$\nDividing by $e^{ij\\theta}$:\n$$\nG(\\theta) = 1 + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} e^{-i\\theta} - \\lambda + \\frac{\\lambda-a}{2} e^{i\\theta} \\right)\n$$\nLet's group the terms using the definitions $\\sigma = \\frac{a\\Delta t}{h}$ and introducing $\\tilde{\\lambda} = \\frac{\\lambda\\Delta t}{h}$:\n$$\nG(\\theta) = 1 - \\tilde{\\lambda} + \\frac{\\tilde{\\lambda}}{2}(e^{i\\theta} + e^{-i\\theta}) + \\frac{\\sigma}{2}(e^{-i\\theta} - e^{i\\theta})\n$$\nUsing Euler's identities $e^{i\\theta}+e^{-i\\theta} = 2\\cos\\theta$ and $e^{i\\theta}-e^{-i\\theta} = 2i\\sin\\theta$:\n$$\nG(\\theta) = 1 - \\tilde{\\lambda} + \\tilde{\\lambda}\\cos\\theta - i\\sigma\\sin\\theta = 1 + \\tilde{\\lambda}(\\cos\\theta-1) - i\\sigma\\sin\\theta\n$$\nFor $L^2$ stability, we require $|G(\\theta)|^2 \\le 1$.\n$$\n|G(\\theta)|^2 = \\left(1 + \\tilde{\\lambda}(\\cos\\theta-1)\\right)^2 + (-\\sigma\\sin\\theta)^2 \\le 1\n$$\n$$\n1 + 2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 + \\sigma^2\\sin^2\\theta \\le 1\n$$\nSubtracting $1$ from both sides:\n$$\n2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 + \\sigma^2\\sin^2\\theta \\le 0\n$$\nUsing the identity $\\sin^2\\theta = 1-\\cos^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta) = -(\\cos\\theta-1)(1+\\cos\\theta)$:\n$$\n2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 - \\sigma^2(\\cos\\theta-1)(1+\\cos\\theta) \\le 0\n$$\nWe can factor out the term $(\\cos\\theta-1)$. For $\\theta \\neq 0$, $\\cos\\theta-1  0$. For $\\theta=0$, the inequality is $0 \\le 0$. For $\\theta \\in (-\\pi, \\pi) \\setminus \\{0\\}$, we divide by $(\\cos\\theta-1)$ and reverse the inequality sign:\n$$\n2\\tilde{\\lambda} + \\tilde{\\lambda}^2(\\cos\\theta-1) - \\sigma^2(1+\\cos\\theta) \\ge 0\n$$\nLet's reorganize the terms as a linear function of $y = \\cos\\theta$, which varies in $[-1,1]$:\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)y + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\nFor this linear function of $y$ to be non-negative over the interval $[-1, 1]$, it must be non-negative at the endpoints $y=-1$ and $y=1$.\n\nCase 1: $y = 1$ (which corresponds to $\\theta=0$)\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)(1) + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n$$\n2\\tilde{\\lambda} - 2\\sigma^2 \\ge 0 \\implies \\tilde{\\lambda} \\ge \\sigma^2\n$$\n\nCase 2: $y = -1$ (which corresponds to $\\theta=\\pm\\pi$)\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)(-1) + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n$$\n-\\tilde{\\lambda}^2 + \\sigma^2 + 2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2 \\ge 0\n$$\n$$\n-2\\tilde{\\lambda}^2 + 2\\tilde{\\lambda} \\ge 0 \\implies 2\\tilde{\\lambda}(1-\\tilde{\\lambda}) \\ge 0\n$$\nGiven $\\lambda \\ge 0$ (and $\\Delta t, h  0$), we have $\\tilde{\\lambda} \\ge 0$. Thus, for the inequality to hold, we must have:\n$$\n1-\\tilde{\\lambda} \\ge 0 \\implies \\tilde{\\lambda} \\le 1\n$$\n\nCombining both conditions, the scheme is $L^2$-stable if and only if $\\tilde{\\lambda}$ satisfies:\n$$\n\\sigma^2 \\le \\tilde{\\lambda} \\le 1\n$$\nThis condition is consistent with the problem's CFL constraint $0  \\sigma \\le 1$, which ensures that $\\sigma^2 \\le 1$ and the interval for $\\tilde{\\lambda}$ is non-empty.\n\nWe are asked for the minimal value of $\\lambda$, denoted $\\lambda_{\\min}$, that guarantees stability. This corresponds to the minimal valid value of $\\tilde{\\lambda}$, which is the lower bound of the derived interval:\n$$\n\\tilde{\\lambda}_{\\min} = \\sigma^2\n$$\nSubstituting the definitions of $\\tilde{\\lambda}$ and $\\sigma$:\n$$\n\\frac{\\lambda_{\\min} \\Delta t}{h} = \\left(\\frac{a \\Delta t}{h}\\right)^2\n$$\nSolving for $\\lambda_{\\min}$:\n$$\n\\lambda_{\\min} = \\left(\\frac{a^2 (\\Delta t)^2}{h^2}\\right) \\frac{h}{\\Delta t} = a^2 \\frac{\\Delta t}{h}\n$$\nThis is the minimal value of the flux parameter $\\lambda$ required to ensure $|G(\\theta)| \\le 1$ for all $\\theta$, given the constraint $0  \\sigma \\le 1$.\nThe problem states $0  \\sigma \\le 1$, which implies $a0$ (assuming $\\Delta t, h 0$), so $|a|=a$. Even if $a$ could be negative, $a^2 = |a|^2$, so the expression $a^2 \\frac{\\Delta t}{h}$ remains correct.",
            "answer": "$$\\boxed{a^2 \\frac{\\Delta t}{h}}$$"
        },
        {
            "introduction": "Theoretical analysis provides the foundation for stable methods, but verifying these properties in practice is a crucial step for any numerical practitioner. This hands-on coding exercise challenges you to implement a stable Discontinuous Galerkin scheme with an upwind flux for the two-dimensional advection equation. You will design a numerical diagnostic to monitor the discrete $L^2$ energy and confirm the scheme's stability, even when faced with geometrically challenging meshes containing sliver or high-aspect-ratio triangles. This task bridges the gap between abstract stability theory and robust computational implementation .",
            "id": "3394323",
            "problem": "Consider the constant-coefficient, linear advection equation in two spatial dimensions, posed on a polygonal domain tessellated by triangles:\n$$\\partial_t u + \\boldsymbol{a}\\cdot\\nabla u = 0,$$\nwhere $u = u(\\boldsymbol{x},t)$ is an advected scalar and $\\boldsymbol{a}\\in\\mathbb{R}^2$ is a constant velocity vector. We consider the Discontinuous Galerkin (DG) method with polynomial degree $0$ (piecewise constant), which coincides with a conservative finite volume scheme with upwind numerical fluxes. We impose inflow boundary conditions $u_{\\text{in}}=0$ on all edges where the outward normal $\\boldsymbol{n}$ of a boundary edge satisfies $\\boldsymbol{a}\\cdot\\boldsymbol{n}0$. The discrete $L^2$ energy associated with a piecewise constant state $u_h(t)$ is defined by\n$$E_h(t) = \\frac{1}{2}\\sum_{K} |K|\\,u_K(t)^2,$$\nwhere the sum ranges over all triangular elements $K$, $|K|$ is the area of $K$, and $u_K(t)$ is the cell-averaged state on $K$ at time $t$.\n\nYour task is to design a numerical diagnostic that tests the discrete $L^2$-stability of the degree-$0$ DG method with upwind fluxes under explicit time stepping on triangular meshes that include pathological shapes (sliver triangles and high aspect ratio elements). Specifically, implement the following steps from first principles:\n\n- Starting from the integral conservation law and Gauss's divergence theorem, derive the piecewise constant DG update using upwind numerical fluxes across each edge with outward unit normal $\\boldsymbol{n}$ and edge length $L$. For an element $K$ with area $|K|$, the explicit update is of forward Euler type with a time step $\\Delta t$ constrained by a Courant–Friedrichs–Lewy (CFL) condition that depends on $|K|$, its edge lengths, and the projections $\\boldsymbol{a}\\cdot\\boldsymbol{n}$.\n- Implement this update on three meshes with specified coordinates and initial states. For each mesh, compute the discrete energy $E_h(t^n)$ at each time step $t^n$ and verify the diagnostic criterion\n$$E_h(t^{n+1})\\le E_h(t^n)+\\varepsilon,$$\nwhere $\\varepsilon$ is a small positive tolerance. Report a boolean indicating whether this monotonic non-increase holds at every step for the duration of the simulation.\n\nUse the following test suite. In each case, all coordinates are given as ordered pairs $(x,y)$, with triangles specified by vertex indices referring to the coordinate list.\n\n- Test case $1$ (regular mesh, oblique advection):\n  - Vertices: $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$.\n  - Triangles: $[0,1,3]$, $[1,2,3]$.\n  - Velocity: $\\boldsymbol{a}=(0.8,0.3)$.\n  - Initial cell-averaged states: $u = [1.0,\\,0.5]$ corresponding to the two triangles in order.\n  - Inflow boundary condition: $u_{\\text{in}}=0$.\n  - CFL factor: $\\text{CFL}=0.3$.\n  - Final time: $T=0.5$.\n\n- Test case $2$ (mesh with a sliver triangle; take $\\varepsilon=10^{-3}$):\n  - Vertices: $(0.0,0.0)$, $(1.0,0.0)$, $(1.0,1.0)$, $(0.0,1.0)$, $(0.5,0.5+\\varepsilon)$, $(0.2,0.5-\\varepsilon)$.\n  - Triangles: $[0,5,4]$, $[5,1,4]$, $[4,2,3]$.\n  - Velocity: $\\boldsymbol{a}=(1.0,0.0)$.\n  - Initial cell-averaged states: $u = [1.0,\\,0.2,\\,0.4]$.\n  - Inflow boundary condition: $u_{\\text{in}}=0$.\n  - CFL factor: $\\text{CFL}=0.2$.\n  - Final time: $T=0.002$.\n\n- Test case $3$ (high aspect ratio mesh, vertical advection):\n  - Vertices: $(0,0)$, $(2,0)$, $(2,0.1)$, $(0,0.1)$, $(1,0)$, $(1,0.1)$.\n  - Triangles: $[0,4,3]$, $[4,5,3]$, $[4,1,5]$, $[1,2,5]$.\n  - Velocity: $\\boldsymbol{a}=(0.0,1.0)$.\n  - Initial cell-averaged states: $u = [0.8,\\,0.3,\\,1.2,\\,0.1]$.\n  - Inflow boundary condition: $u_{\\text{in}}=0$.\n  - CFL factor: $\\text{CFL}=0.4$.\n  - Final time: $T=0.05$.\n\nDiagnostic specification:\n\n- For each test case, compute a global time step $\\Delta t$ by first determining, for every element $K$, the quantity\n$$S_K = \\sum_{e\\subset\\partial K}\\max\\{0,\\boldsymbol{a}\\cdot\\boldsymbol{n}_e\\}\\,L_e,$$\nwhere the sum is over the edges $e$ of $K$, $L_e$ is the length of edge $e$, and $\\boldsymbol{n}_e$ is the outward unit normal of $K$ on edge $e$. Then set\n$$\\Delta t = \\text{CFL}\\cdot\\min_{K}\\left\\{\\frac{|K|}{S_K}\\,:\\,S_K>0\\right\\},$$\nand if an element has $S_K=0$, ignore it in the minimum (treating its local bound as $+\\infty$). Use an integer number of steps $N=\\lceil T/\\Delta t\\rceil$ and replace $\\Delta t$ by $T/N$ to hit the final time exactly.\n- The discrete energy is\n$$E_h^n=\\frac{1}{2}\\sum_{K}|K|\\,u_K^n\\,u_K^n.$$\nThe monotonicity diagnostic for a given case is the boolean\n$$\\text{stable}=\\bigwedge_{n=0}^{N-1}\\left(E_h^{n+1}\\le E_h^n+\\varepsilon\\right),$$\nwith tolerance $\\varepsilon=10^{-12}$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ to $3$, for example,\n$$[v_1,v_2,v_3]$$\nwhere each $v_i$ is a boolean indicating the monotonic non-increase of the discrete energy for test case $i$.\n\nYour implementation must be self-contained and make no use of external files or inputs, and it must adhere to the execution environment specified in the final answer.",
            "solution": "The user-provided problem is valid. It is a well-posed problem in the field of numerical analysis for partial differential equations, specifically concerning the stability of the Discontinuous Galerkin (DG) method. All required data, including mesh geometry, physical parameters, initial conditions, and numerical parameters, are provided. The problem asks for a numerical diagnostic, which is a standard procedure for verifying theoretical properties of a numerical scheme.\n\nThe solution proceeds in two main stages: first, the derivation of the explicit time-update formula for the piecewise constant (DG(0)) approximation, and second, the implementation of a numerical simulation to test the scheme's $L^2$-stability on given meshes.\n\n### Derivation of the DG(0) Update Scheme\n\nWe begin with the linear advection equation in two dimensions:\n$$\n\\partial_t u + \\boldsymbol{a}\\cdot\\nabla u = 0\n$$\nwhere $\\boldsymbol{a}$ is a constant velocity vector. For a Discontinuous Galerkin method, we multiply by a test function $v_h$ and integrate over an element $K$ of the mesh tessellation:\n$$\n\\int_K (\\partial_t u_h) v_h \\,d\\boldsymbol{x} + \\int_K (\\boldsymbol{a}\\cdot\\nabla u_h) v_h \\,d\\boldsymbol{x} = 0\n$$\nFor a DG(0) method, the basis and test functions are piecewise constants. Within an element $K$, we approximate the solution $u(\\boldsymbol{x},t)$ by its cell average, $u_K(t)$. Thus, $u_h(\\boldsymbol{x},t) = u_K(t)$ and $v_h(\\boldsymbol{x}) = 1$ for $\\boldsymbol{x} \\in K$.\n\nThe first term becomes:\n$$\n\\int_K (\\partial_t u_K) \\cdot 1 \\,d\\boldsymbol{x} = |K| \\frac{d u_K}{dt}\n$$\nwhere $|K|$ is the area of element $K$.\n\nFor the second term, we use the vector calculus identity $\\nabla \\cdot (\\boldsymbol{a} u) = u (\\nabla \\cdot \\boldsymbol{a}) + \\boldsymbol{a} \\cdot \\nabla u$. Since $\\boldsymbol{a}$ is constant, $\\nabla \\cdot \\boldsymbol{a} = 0$, so $\\boldsymbol{a} \\cdot \\nabla u = \\nabla \\cdot (\\boldsymbol{a} u)$. Applying the divergence theorem:\n$$\n\\int_K \\boldsymbol{a}\\cdot\\nabla u_h \\,d\\boldsymbol{x} = \\int_K \\nabla \\cdot (\\boldsymbol{a} u_h) \\,d\\boldsymbol{x} = \\int_{\\partial K} (\\boldsymbol{a} u_h) \\cdot \\boldsymbol{n} \\,d S\n$$\nwhere $\\partial K$ is the boundary of element $K$ and $\\boldsymbol{n}$ is the outward unit normal vector. The solution $u_h$ is discontinuous across element boundaries, so we must replace it with a numerical flux, $\\hat{u}$. The integral becomes:\n$$\n\\sum_{e \\subset \\partial K} \\int_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) \\hat{u}_e \\,dS\n$$\nwhere the sum is over the edges $e$ of $K$. Since $u_h$ is constant on each element, the flux $\\hat{u}_e$ is constant along each edge $e$. This simplifies to:\n$$\n\\sum_{e \\subset \\partial K} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) \\hat{u}_e\n$$\nwhere $L_e$ is the length of edge $e$. For the upwind flux, the value of $\\hat{u}_e$ is taken from the \"upwind\" side, determined by the sign of $\\boldsymbol{a}\\cdot\\boldsymbol{n}_e$:\n$$\n\\hat{u}_e = \\begin{cases} u_K  \\text{if } \\boldsymbol{a}\\cdot\\boldsymbol{n}_e  0 \\quad (\\text{outflow from } K) \\\\ u_{K'}  \\text{if } \\boldsymbol{a}\\cdot\\boldsymbol{n}_e  0 \\quad (\\text{inflow to } K) \\end{cases}\n$$\nHere, $u_{K'}$ is the value in the adjacent element $K'$. If edge $e$ is on the domain boundary, $u_{K'}$ becomes the prescribed inflow data, $u_{\\text{in}}$.\n\nCombining the terms gives the semi-discrete ordinary differential equation (ODE) for each cell average $u_K$:\n$$\n|K| \\frac{d u_K}{dt} + \\sum_{e \\subset \\partial K} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) \\hat{u}_e = 0\n$$\nSubstituting the upwind flux definition:\n$$\n|K| \\frac{d u_K}{dt} = - \\left( \\sum_{e \\text{ outflow}} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) u_K + \\sum_{e \\text{ inflow}} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) u_{K'} \\right)\n$$\nThe sum over outflow edges can be written using the quantity $S_K = \\sum_{e \\subset \\partial K} \\max\\{0, \\boldsymbol{a}\\cdot\\boldsymbol{n}_e\\} L_e$. The semi-discrete scheme is thus:\n$$\n|K| \\frac{d u_K}{dt} = - \\left( u_K S_K + \\sum_{e \\text{ inflow}} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) u_{K'} \\right)\n$$\nApplying the forward Euler method for time integration with step size $\\Delta t$:\n$$\n|K| \\frac{u_K^{n+1} - u_K^n}{\\Delta t} = - \\left( u_K^n S_K + \\sum_{e \\text{ inflow}} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) u_{K'}^n \\right)\n$$\nRearranging for $u_K^{n+1}$ gives the final explicit update formula:\n$$\nu_K^{n+1} = u_K^n - \\frac{\\Delta t}{|K|} \\left( u_K^n S_K + \\sum_{e \\text{ inflow to } K} L_e (\\boldsymbol{a}\\cdot\\boldsymbol{n}_e) u_{K'}^n \\right)\n$$\nwhere $u_{K'}^n$ is either the state of a neighboring cell or the boundary condition $u_{\\text{in}}=0$.\n\n### Implementation Strategy\n\nThe numerical implementation follows these steps for each test case:\n1.  **Mesh Pre-processing**: The given vertices and triangle connectivity are processed. The area of each triangle is computed. An edge-based data structure is constructed to identify neighbors for each cell and to distinguish interior edges from boundary edges. For robustness, triangle vertices are reordered if necessary to ensure a consistent counter-clockwise (CCW) orientation, which simplifies the calculation of outward normal vectors.\n2.  **Geometric Properties**: For each edge of every cell, its length and outward unit normal vector are calculated. The CCW orientation ensures the normals point outwards.\n3.  **Time Step Calculation**: For each cell $K$, the term $S_K = \\sum_{e \\subset \\partial K} \\max\\{0, \\boldsymbol{a}\\cdot\\boldsymbol{n}_e\\} L_e$ is computed. The global time step $\\Delta t$ is determined according to the specified CFL condition: $\\Delta t = \\text{CFL} \\cdot \\min_K \\{|K|/S_K\\}$ over all $K$ with $S_K  0$. The total number of steps $N$ is calculated as $N = \\lceil T/\\Delta t \\rceil$, and $\\Delta t$ is adjusted to $T/N$ to reach the final time $T$ exactly.\n4.  **Time Evolution**: The system is evolved for $N$ time steps.\n    - The initial discrete energy $E_h^0 = \\frac{1}{2}\\sum_{K}|K|(u_K^0)^2$ is computed.\n    - In each step from $n$ to $n+1$, the right-hand side of the ODE is assembled for every cell $K$ using the state $u_h^n$, and the values $u_K^{n+1}$ are computed using the derived forward Euler update rule.\n    - The new discrete energy $E_h^{n+1}$ is calculated.\n    - The stability diagnostic is checked: $E_h^{n+1} \\le E_h^n + \\varepsilon$. If this condition is violated at any step, the simulation for that test case is marked as unstable, and the loop terminates.\n5.  **Result Reporting**: If the simulation completes without violating the energy condition, the test case is marked as stable. The final boolean results for all test cases are collected and formatted.\n\nThe upwind flux scheme is known to be energy-stable for the linear advection equation under an appropriate CFL condition. The provided CFL factors and time-stepping rule ensure this. Therefore, the discrete energy is expected to be non-increasing (up to floating-point precision) for all test cases, including those with pathologically shaped elements.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the stability diagnostic.\n    \"\"\"\n\n    def run_case(vertices, triangles, velocity, u_initial, CFL, T, epsilon_diagnostic):\n        \"\"\"\n        Executes a single test case for the DG(0) L2-stability diagnostic.\n\n        Args:\n            vertices (list): List of (x, y) vertex coordinates.\n            triangles (list): List of [v0, v1, v2] vertex indices for each triangle.\n            velocity (tuple): The constant advection velocity (ax, ay).\n            u_initial (list): Initial cell-averaged states for each triangle.\n            CFL (float): The CFL factor.\n            T (float): The final simulation time.\n            epsilon_diagnostic (float): Tolerance for the energy non-increase check.\n\n        Returns:\n            bool: True if the discrete energy is monotonically non-increasing at all steps, False otherwise.\n        \"\"\"\n        num_cells = len(triangles)\n        verts = np.array(vertices, dtype=float)\n        velocity = np.array(velocity, dtype=float)\n        u = np.array(u_initial, dtype=float)\n\n        # 1. Mesh Pre-processing and Geometric Calculations\n        cell_areas = np.zeros(num_cells)\n        edge_to_cells = {}\n        oriented_triangles = []\n\n        for i, tri_indices in enumerate(triangles):\n            v0, v1, v2 = tri_indices\n            p0, p1, p2 = verts[v0], verts[v1], verts[v2]\n            \n            # Shoelace formula for signed area to determine winding order\n            area = 0.5 * (p0[0]*(p1[1]-p2[1]) + p1[0]*(p2[1]-p0[1]) + p2[0]*(p0[1]-p1[1]))\n            \n            # Ensure CCW winding for consistent normal calculations\n            if area  0:\n                area = -area\n                oriented_triangles.append([v0, v2, v1]) # Reverse winding to get CCW\n            else:\n                oriented_triangles.append(list(tri_indices))\n\n            cell_areas[i] = area\n            \n            # Build edge-to-cell mapping\n            for j in range(3):\n                v_start = tri_indices[j]\n                v_end = tri_indices[(j + 1) % 3]\n                edge_key = tuple(sorted((v_start, v_end)))\n                if edge_key not in edge_to_cells:\n                    edge_to_cells[edge_key] = []\n                edge_to_cells[edge_key].append(i)\n\n        # Store detailed edge information for each cell\n        cell_edges_data = [[] for _ in range(num_cells)]\n        for k in range(num_cells):\n            tri_indices = oriented_triangles[k]\n            for j in range(3):\n                v_start_idx, v_end_idx = tri_indices[j], tri_indices[(j + 1) % 3]\n                p_start, p_end = verts[v_start_idx], verts[v_end_idx]\n\n                edge_vec = p_end - p_start\n                length = np.linalg.norm(edge_vec)\n                \n                # Outward normal for CCW triangle\n                normal = np.array([edge_vec[1], -edge_vec[0]]) / length\n                \n                edge_key = tuple(sorted((v_start_idx, v_end_idx)))\n                neighbor_cells_list = edge_to_cells[edge_key]\n                \n                neighbor_k = -1 # Boundary indicator\n                if len(neighbor_cells_list)  1:\n                    neighbor_k = neighbor_cells_list[0] if neighbor_cells_list[1] == k else neighbor_cells_list[1]\n\n                cell_edges_data[k].append({\n                    'length': length,\n                    'normal': normal,\n                    'neighbor': neighbor_k\n                })\n\n        # 2. Calculate S_K for each cell K\n        S_vals = np.zeros(num_cells)\n        for k in range(num_cells):\n            s_k = 0.0\n            for edge_data in cell_edges_data[k]:\n                a_dot_n = np.dot(velocity, edge_data['normal'])\n                s_k += max(0, a_dot_n) * edge_data['length']\n            S_vals[k] = s_k\n        \n        # 3. Calculate time step dt\n        dt_ratios = [cell_areas[k] / S_vals[k] for k in range(num_cells) if S_vals[k]  1e-15]\n        \n        if not dt_ratios:\n            # If all S_K are zero, the solution is static. Can take one large step.\n            num_steps = 1\n            dt = T\n        else:\n            dt_cfl = CFL * min(dt_ratios)\n            if T == 0 or dt_cfl == 0:\n                num_steps, dt = 0, 0\n            else:\n                num_steps = math.ceil(T / dt_cfl)\n                dt = T / num_steps\n        \n        # 4. Time Stepping Loop and Stability Check\n        is_stable = True\n        if num_steps  0:\n            energy_prev = 0.5 * np.sum(cell_areas * u**2)\n\n            for _ in range(num_steps):\n                rhs = np.zeros(num_cells)\n                for k in range(num_cells):\n                    # Sum over inflow edges for the update term\n                    sum_inflow_term = 0.0\n                    for edge_data in cell_edges_data[k]:\n                        a_dot_n = np.dot(velocity, edge_data['normal'])\n                        if a_dot_n  0: # Inflow edge\n                            neighbor_k = edge_data['neighbor']\n                            # Use u_in=0 for boundary edges\n                            u_neighbor = 0.0 if neighbor_k == -1 else u[neighbor_k]\n                            sum_inflow_term += edge_data['length'] * a_dot_n * u_neighbor\n                    \n                    rhs[k] = -(u[k] * S_vals[k] + sum_inflow_term)\n                \n                # Forward Euler update, avoiding division by zero area\n                u += np.divide(dt * rhs, cell_areas, out=np.zeros_like(rhs), where=cell_areas!=0)\n\n                energy_curr = 0.5 * np.sum(cell_areas * u**2)\n                \n                if energy_curr  energy_prev + epsilon_diagnostic:\n                    is_stable = False\n                    break\n                \n                energy_prev = energy_curr\n\n        return is_stable\n\n    # --- Test Cases ---\n    \n    # Test case 1\n    case1 = {\n        'vertices': [(0,0), (1,0), (1,1), (0,1)],\n        'triangles': [[0,1,3], [1,2,3]],\n        'velocity': (0.8,0.3),\n        'u_initial': [1.0, 0.5],\n        'CFL': 0.3, 'T': 0.5\n    }\n\n    # Test case 2\n    eps_geom = 1e-3\n    case2 = {\n        'vertices': [(0.0,0.0), (1.0,0.0), (1.0,1.0), (0.0,1.0), (0.5,0.5+eps_geom), (0.2,0.5-eps_geom)],\n        'triangles': [[0,5,4], [5,1,4], [4,2,3]],\n        'velocity': (1.0,0.0),\n        'u_initial': [1.0, 0.2, 0.4],\n        'CFL': 0.2, 'T': 0.002\n    }\n    \n    # Test case 3\n    case3 = {\n        'vertices': [(0,0), (2,0), (2,0.1), (0,0.1), (1,0), (1,0.1)],\n        'triangles': [[0,4,3], [4,5,3], [4,1,5], [1,2,5]],\n        'velocity': (0.0, 1.0),\n        'u_initial': [0.8, 0.3, 1.2, 0.1],\n        'CFL': 0.4, 'T': 0.05\n    }\n\n    test_cases = [case1, case2, case3]\n    epsilon_diagnostic = 1e-12\n    results = []\n\n    for case in test_cases:\n        result = run_case(\n            case['vertices'], case['triangles'], case['velocity'],\n            case['u_initial'], case['CFL'], case['T'], epsilon_diagnostic\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\".lower())\n    \nsolve()\n```"
        }
    ]
}