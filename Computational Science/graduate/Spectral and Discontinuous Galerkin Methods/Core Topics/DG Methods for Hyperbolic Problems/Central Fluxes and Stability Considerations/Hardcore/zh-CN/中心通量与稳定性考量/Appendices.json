{
    "hands_on_practices": [
        {
            "introduction": "在实施间断 Galerkin (DG) 方法时，一个基础且关键的步骤是确保离散算子的精确计算。本练习将指导您确定精确积分 DG 双线性形式所需的最小数值求积阶数，该形式针对的是采用中心通量的线性平流方程。通过完成此实践 ，您将掌握分析离散弱形式中被积函数多项式次数的核心技能，这对于任何 DG 代码的正确实现都至关重要。",
            "id": "3368532",
            "problem": "考虑空间维度为 $d \\ge 1$、在仿射单元网格上具有恒定平流向量 $\\boldsymbol{a} \\in \\mathbb{R}^d$ 的标量线性平流方程，\n$$\n\\partial_t u + \\nabla \\cdot (\\boldsymbol{a} \\, u) = 0,\n$$\n该方程通过间断 Galerkin (DG) 方法进行离散化，在每个单元上使用次数至多为 $p \\ge 1$ 的多项式试探和检验空间。假设从参考单元到每个单元的映射都是仿射的，因此雅可比行列式和面法向量分别在每个单元和面上是常数。\n\n采用通过在每个单元上对通量项中的散度进行分部积分、并使用中心数值通量来封闭方法而得到的 DG 弱形式。在每个具有固定单位法向量 $\\boldsymbol{n}_F$ 的内部面 $F$ 上，标量 $w$ 的平均和跳跃定义为\n$$\n\\{ w \\} = \\frac{w^{-} + w^{+}}{2}, \\qquad [w] = w^{-} - w^{+},\n$$\n并将中心数值通量设置为 $\\widehat{f} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\, \\{ u \\}$。在边界面上，对于内部迹，将 $\\{ u \\}$ 理解为 $u$，将 $[v]$ 理解为 $v$。\n\n令双线性形式 $B(u_h, v_h)$ 表示作用于离散函数 $u_h$ 和 $v_h$ 的空间半离散 DG 算子，其中 $u_h$ 和 $v_h$ 取自每个单元上总次数至多为 $p$ 的多项式空间。你需要确定体积和面积分求积法则的最小多项式精确次数（分别表示为 $q_V$ 和 $q_F$），这是对所有此类 $u_h$ 和 $v_h$ 精确积分 $B(u_h, v_h)$ 所必需的。\n\n为本题之目的，定义体积求积法则的多项式精确次数为 $q_V$，如果它能在参考单元的任何仿射像上精确积分任何总次数至多为 $q_V$ 的多项式；定义面积分求积法则的多项式精确次数为 $q_F$，如果它能在参考面的任何仿射像上精确积分任何总次数至多为 $q_F$ 的多项式。\n\n从第一性原理出发，通过由仿射映射和带中心通量的 DG 弱形式结构所支持的次数计算论证，推导出 $q_V$ 和 $q_F$ 作为 $p$ 的函数的最小值。你的最终答案必须是 $q_V$ 和 $q_F$ 的一对解析表达式，写成使用 $\\mathrm{pmatrix}$ 环境的单行矩阵。不需要进行数值近似。",
            "solution": "该问题要求确定用于线性平流方程的间断 Galerkin (DG) 离散化的体积和面积分求积法则的最小多项式精确次数，分别表示为 $q_V$ 和 $q_F$。\n\n设离散解 $u_h$ 和检验函数 $v_h$ 属于网格 $\\mathcal{T}_h$ 中每个单元 $K$ 上的总次数至多为 $p \\ge 1$ 的多项式空间。标量线性平流方程由下式给出\n$$\n\\partial_t u + \\nabla \\cdot (\\boldsymbol{a} \\, u) = 0\n$$\n其中 $\\boldsymbol{a} \\in \\mathbb{R}^d$ 是一个常向量。由于 $\\boldsymbol{a}$ 是常数，散度项简化为 $\\nabla \\cdot (\\boldsymbol{a} \\, u) = \\boldsymbol{a} \\cdot \\nabla u$。\n\n为推导半离散弱形式，我们将方程的空间部分乘以一个检验函数 $v_h$ 并在单元 $K$ 上积分：\n$$\n\\int_K (\\boldsymbol{a} \\cdot \\nabla u_h) v_h \\, d\\boldsymbol{x}\n$$\n应用分部积分（Green 定理）可得：\n$$\n\\int_{\\partial K} (\\boldsymbol{a} \\cdot \\boldsymbol{n}_K) u_h v_h \\, dS - \\int_K (\\boldsymbol{a} u_h) \\cdot \\nabla v_h \\, d\\boldsymbol{x}\n$$\n其中 $\\boldsymbol{n}_K$ 是边界 $\\partial K$ 上的外指单位法向量。由于 $\\boldsymbol{a}$ 是常数，这等价于：\n$$\n\\int_{\\partial K} u_h (\\boldsymbol{a} \\cdot \\boldsymbol{n}_K) v_h \\, dS - \\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x}\n$$\n在 DG 方法中，单元边界 $\\partial K$ 上 $u_h$ 的迹被数值通量所取代。本题指定使用中心通量，其法向数值通量由 $\\widehat{f} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\}$ 给出。项 $u_h (\\boldsymbol{a} \\cdot \\boldsymbol{n}_K)$ 被 $\\widehat{f}$ 替换。\n\n因此，单元 $K$ 对空间算子的贡献为：\n$$\n\\int_{\\partial K} \\widehat{f}(u_h) v_h \\, dS - \\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x}\n$$\n双线性形式 $B(u_h, v_h)$ 是通过对所有单元 $K \\in \\mathcal{T}_h$ 上的这些贡献求和得到的：\n$$\nB(u_h, v_h) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_{\\partial K} \\widehat{f}(u_h) v_h \\, dS - \\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x} \\right)\n$$\n我们可以将边界面上的积分之和重写为对网格中所有唯一面集合 $\\mathcal{F}$ 的求和。设 $F$ 是单元 $K^-$ 和 $K^+$ 之间的一个内部面，其单位法向量 $\\boldsymbol{n}_F$ 从 $K^-$ 指向 $K^+$。这个面对总和的贡献是：\n$$\n\\int_F \\widehat{f}(u_h^-, u_h^+, \\boldsymbol{n}_F) v_h^- \\, dS + \\int_F \\widehat{f}(u_h^+, u_h^-, -\\boldsymbol{n}_F) v_h^+ \\, dS\n$$\n中心通量 $\\widehat{f}(u^-, u^+, \\boldsymbol{n}) = (\\boldsymbol{a} \\cdot \\boldsymbol{n}) \\frac{u^- + u^+}{2} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}) \\{u\\}$ 是守恒的，即 $\\widehat{f}(u^+, u^-, -\\boldsymbol{n}) = -\\widehat{f}(u^-, u^+, \\boldsymbol{n})$。因此，内部面项变为：\n$$\n\\int_F \\widehat{f}(u_h^-, u_h^+, \\boldsymbol{n}_F) (v_h^- - v_h^+) \\, dS = \\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\} [v_h] \\, dS\n$$\n对于边界面 $F$，题目规定将 $\\{u\\}$ 理解为内部迹 $u$，将 $[v]$ 理解为内部迹 $v$。因此，面积分项变为 $\\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_h v_h \\, dS$。这个约定允许我们以统一的方式写出所有面上的积分之和。\n\n完整的双线性形式为：\n$$\nB(u_h, v_h) = - \\sum_{K \\in \\mathcal{T}_h} \\underbrace{\\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x}}_{\\text{体积分}} + \\sum_{F \\in \\mathcal{F}} \\underbrace{\\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\} [v_h] \\, dS}_{\\text{面积分}}\n$$\n我们需要找到最小的求积精确次数 $q_V$ 和 $q_F$，以便对次数至多为 $p$ 的多项式空间中的所有 $u_h, v_h$ 精确地积分体积分项和面积分项。题目假设了仿射单元映射，这意味着用于体积分的雅可比行列式以及用于面积分的雅可比行列式和法向量在每个单元和面上分别是常数。这确保了在变换到参考单元/面时，被积函数的多项式次数得以保持。\n\n**体积分求积 ($q_V$)**\n\n在单元 $K$ 上的体积分的被积函数为 $I_V = u_h (\\boldsymbol{a} \\cdot \\nabla v_h)$。\n-   $u_h$ 是一个总次数至多为 $p$ 的多项式。\n-   $v_h$ 是一个总次数至多为 $p$ 的多项式。其梯度 $\\nabla v_h$ 是一个总次数至多为 $p-1$ 的多项式向量。\n-   由于 $\\boldsymbol{a}$ 是一个常向量，点积 $\\boldsymbol{a} \\cdot \\nabla v_h$ 是一个总次数至多为 $p-1$ 的标量多项式。\n-   因此，乘积 $I_V = u_h (\\boldsymbol{a} \\cdot \\nabla v_h)$ 是一个总次数至多为 $p + (p-1) = 2p-1$ 的多项式。\n\n为确保此积分被精确计算，体积分求积法则必须对所有次数直至此次数的多项式都是精确的。这给出了一个上界 $q_V \\ge 2p-1$。为了证明这是最小的，我们必须证明可以形成一个次数恰好为 $2p-1$ 的多项式。考虑一个一维情况，其中 $u_h(x) = x^p$ 且 $v_h(x) = x^p$。那么 $\\nabla v_h = v_h'(x) = p x^{p-1}$。被积函数为 $u_h (a v_h') = x^p (a \\cdot p x^{p-1}) = ap x^{2p-1}$，这是一个 $2p-1$ 次的多项式。因此，精确度低于 $2p-1$ 的求积法则将会失效。\n体积分求积所需的最小多项式精确次数为 $q_V = 2p-1$。\n\n**面积分求积 ($q_F$)**\n\n在面 $F$ 上的面积分被积函数为 $I_F = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\} [v_h]$。\n-   由于仿射网格假设，项 $\\boldsymbol{a} \\cdot \\boldsymbol{n}_F$ 在面 $F$ 上是常数。\n-   $u_h$ 和 $v_h$ 在面 $F$ 上的迹是面的局部坐标系中总次数至多为 $p$ 的多项式。\n-   在内部面上，平均值 $\\{u_h\\} = \\frac{u_h^- + u_h^+}{2}$ 是一个总次数至多为 $p$ 的多项式。\n-   跳跃项 $[v_h] = v_h^- - v_h^+$ 也是一个总次数至多为 $p$ 的多项式。\n-   因此，乘积 $\\{u_h\\} [v_h]$ 是一个总次数至多为 $p + p = 2p$ 的多项式。\n\n在边界面上，根据指定的约定，被积函数为 $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_h v_h$。$u_h$ 和 $v_h$ 在该面上都是次数至多为 $p$ 的多项式。它们的乘积是次数至多为 $2p$ 的多项式。\n\n在两种情况下，面积分被积函数都是总次数至多为 $2p$ 的多项式。为保证精确积分，面积分求积法则必须对所有次数直至此次数的多项式都是精确的，因此 $q_F \\ge 2p$。为了证明这是最小的，考虑一个我们可以独立选择迹的面。令 $\\phi$ 为面坐标系中次数为 $p$ 的多项式。我们可以构造 $u_h$ 和 $v_h$，使得在面上，$u_h^-=\\phi, u_h^+=0$ 且 $v_h^-=\\phi, v_h^+=0$。那么 $\\{u_h\\}=\\phi/2$ 且 $[v_h]=\\phi$。乘积 $\\{u_h\\}[v_h]=\\phi^2/2$ 是一个次数为 $2p$ 的多项式。因此，精确度低于 $2p$ 的求积法则是不足够的。\n面积分求积所需的最小多项式精确次数为 $q_F = 2p$。\n\n总之，体积分和面积分的最小求积精确次数分别为 $q_V = 2p-1$ 和 $q_F = 2p$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2p-1  2p\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在正确构建离散算子之后，下一步是分析其稳定性，尤其是在使用非耗散的中心通量时。本练习  采用傅里叶分析（von Neumann 分析）这一强大工具，来研究一个针对线性平流问题的全离散格式（空间上采用中心通量 DG，时间上采用强稳定性保持龙格-库塔法）的稳定性。通过推导其放大因子并确定临界时间步长，您将深刻理解中心通量的纯振荡特性如何与时间积分格式相互作用，并学会量化稳定计算的极限。",
            "id": "3368574",
            "problem": "考虑在间距为 $h$ 的均匀网格上的周期性一维域中的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a  0$ 是一个恒定的平流速度。使用分片常数基函数（多项式次数 $p=0$）和中心数值通量的间断Galerkin (DG) 空间离散化方法。即，在每个界面上，数值通量是由左右迹计算出的物理通量的算术平均值。将单元 $j$ 中的单元平均值记为 $u_{j}(t)$，并令与此单元关联的网格点为 $x_{j} = j\\,h$。\n\n一个代表性的傅里叶模态形式为 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,k\\,x_{j})$，其中 $k$ 是波数。对于上述半离散DG算子，通过代入此傅里叶模态，构建常微分方程 $d\\hat{u}/dt = \\lambda(k)\\,\\hat{u}$，并确定相应的特征值 $\\lambda(k)$。\n\n接下来，使用三阶三步强稳定性保持Runge–Kutta方法 (SSPRK(3,3)) 对半离散系统进行时间推进。对于标量线性测试方程 $y' = \\lambda\\,y$，此方法引入一个作用于模态振幅 $\\hat{u}$ 的标量放大因子 $G = R(z)$，其中 $z = \\Delta t\\,\\lambda(k)$ 且 $\\Delta t$ 是时间步长。计算代表性傅里叶模态的放大因子 $G$ 的闭式表达式，用 $k$、$a$、$h$ 和 $\\Delta t$ 表示。\n\n最后，通过要求最大振幅的傅里叶模态在一个SSPRK(3,3)步长下幅值不增长，确定此DG中心通量半离散化方法开始出现数值不稳定性的临界时间步长 $\\Delta t_{\\text{crit}}$。用 $a$ 和 $h$ 的符号形式表达您的答案，并将一般傅里叶模态的放大因子报告为无量纲参数 $\\nu \\equiv a\\,\\Delta t / h$ 和无量纲波数 $\\theta \\equiv k\\,h$ 的函数。\n\n以一个两元行矩阵的形式提供您的最终答案：第一个元素是 $G(\\theta,\\nu)$ 的闭式表达式，第二个元素是临界时间步长 $\\Delta t_{\\text{crit}}$。最终答案中不要包含单位。无需进行数值舍入。",
            "solution": "用户希望分析用于线性平流方程的间断Galerkin (DG) 方法的稳定性。该分析包括几个步骤：推导半离散系统，进行傅里叶分析以找到空间算子的特征值，确定时间步进格式的放大因子，最后确定稳定性极限。\n\n### 步骤1：问题验证\n\n根据所需标准对问题陈述进行验证。\n\n**1. 提取已知条件：**\n-   **控制方程：** $u_{t} + a\\,u_{x} = 0$，其中 $a  0$ 为常数。\n-   **域：** 一维、周期性，均匀网格间距为 $h$。\n-   **离散化方法：** 间断Galerkin (DG)，采用分片常数基函数 ($p=0$)。\n-   **单元定义：** 单元 $j$ 的中心位于 $x_{j} = j\\,h$。单元平均值为 $u_{j}(t)$。\n-   **数值通量：** 中心通量，定义为从左右单元迹计算的物理通量 ($f(u) = a\\,u$) 的算术平均值。\n-   **傅里叶模态分析：** 代表性模态由 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,k\\,x_{j})$ 给出，导出半离散常微分方程 $d\\hat{u}/dt = \\lambda(k)\\,\\hat{u}$。\n-   **时间积分：** 三阶三步强稳定性保持Runge–Kutta方法 (SSPRK(3,3))。\n-   **放大因子：** 放大因子为 $G = R(z)$，其中 $z = \\Delta t\\,\\lambda(k)$。\n-   **目标1：** 求出放大因子 $G$ 作为无量纲参数 $\\nu \\equiv a\\,\\Delta t / h$ 和 $\\theta \\equiv k\\,h$ 的函数的闭式表达式。\n-   **目标2：** 确定数值稳定性的临界时间步长 $\\Delta t_{\\text{crit}}$，用 $a$ 和 $h$ 表示。\n\n**2. 验证：**\n-   **科学依据：** 该问题牢固地植根于偏微分方程数值分析领域。DG方法、傅里叶稳定性分析和SSPRK方法都是标准且成熟的课题。\n-   **适定性：** 问题定义清晰，提供了推导唯一解所需的所有信息。指定的空间和时间离散化方法的组合导出了一个可解的稳定性问题。\n-   **客观性：** 问题以精确的技术语言陈述，没有任何主观性或模糊性。\n\n**3. 结论：**\n该问题是有效的。它是守恒律数值分析中的一个标准练习。\n\n### 步骤2：半离散DG格式的推导\n\n方程 $u_t + a u_x = 0$ 在单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上的DG方法的弱形式为：\n$$ \\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx = \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx - [a \\hat{u}_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} $$\n其中 $u_h$ 是数值解，$v_h$ 是来自同一空间的检验函数，$\\hat{u}_h$ 是数值通量。单元的长度为 $h = x_{j+1/2} - x_{j-1/2}$。\n\n对于分片常数基函数 ($p=0$)，我们令 $u_h(x,t) = u_j(t)$ 对 $x \\in I_j$ 成立，并选择检验函数 $v_h(x) = 1$ 对 $x \\in I_j$ 成立，在其他地方为 $0$。\n当 $v_h = 1$ 时，其导数 $\\frac{\\partial v_h}{\\partial x} = 0$，所以右侧的积分为零。方程简化为：\n$$ \\int_{I_j} \\frac{d u_j}{d t} (1) \\, dx = - \\left( (a \\hat{u}_h)_{j+1/2} - (a \\hat{u}_h)_{j-1/2} \\right) $$\n$$ h \\frac{d u_j}{d t} = - \\left( (a \\hat{u}_h)_{j+1/2} - (a \\hat{u}_h)_{j-1/2} \\right) $$\n问题指定了中心数值通量。在单元 $j$ 和 $j+1$ 之间的界面 $x_{j+1/2}$ 处，解在左侧有迹 $u_j(t)$，在右侧有迹 $u_{j+1}(t)$。对于物理通量 $f(u)=au$，中心通量是算术平均值：\n$$ (a \\hat{u}_h)_{j+1/2} = \\frac{a u_j(t) + a u_{j+1}(t)}{2} $$\n类似地，在界面 $x_{j-1/2}$ 处：\n$$ (a \\hat{u}_h)_{j-1/2} = \\frac{a u_{j-1}(t) + a u_j(t)}{2} $$\n将这些通量表达式代入半离散方程，得到：\n$$ h \\frac{d u_j}{d t} = - \\left( \\frac{a u_j + a u_{j+1}}{2} - \\frac{a u_{j-1} + a u_j}{2} \\right) $$\n$$ h \\frac{d u_j}{d t} = - \\frac{a}{2} (u_j + u_{j+1} - u_{j-1} - u_j) $$\n$$ \\frac{d u_j}{d t} = - \\frac{a}{2h} (u_{j+1} - u_{j-1}) $$\n\n### 步骤3：傅里叶分析与特征值确定\n\n我们将傅里叶模态 $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$（其中 $x_j=jh$）代入半离散方程：\n$$ \\frac{d}{dt} \\left( \\hat{u}(t) e^{ikjh} \\right) = - \\frac{a}{2h} \\left( \\hat{u}(t) e^{ik(j+1)h} - \\hat{u}(t) e^{ik(j-1)h} \\right) $$\n$$ \\frac{d\\hat{u}}{dt} e^{ikjh} = - \\frac{a}{2h} \\hat{u}(t) e^{ikjh} \\left( e^{ikh} - e^{-ikh} \\right) $$\n两边同除以 $e^{ikjh}$ 并使用欧拉公式 $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$，我们得到：\n$$ \\frac{d\\hat{u}}{dt} = - \\frac{a}{2h} \\hat{u}(t) (2i\\sin(kh)) $$\n$$ \\frac{d\\hat{u}}{dt} = \\left( - \\frac{ia}{h} \\sin(kh) \\right) \\hat{u}(t) $$\n这是 $d\\hat{u}/dt = \\lambda(k)\\hat{u}$ 的形式，因此半离散算子的特征值为：\n$$ \\lambda(k) = - \\frac{ia}{h} \\sin(kh) $$\n特征值是纯虚数，这是非耗散中心空间离散化的一个特征。\n\n### 步骤4：SSPRK(3,3)的放大因子\n\n对于常微分方程 $y' = L(y)$，SSPRK(3,3)方法由下式给出：\n$$ y^{(1)} = y_n + \\Delta t L(y_n) $$\n$$ y^{(2)} = \\frac{3}{4} y_n + \\frac{1}{4} (y^{(1)} + \\Delta t L(y^{(1)})) $$\n$$ y_{n+1} = \\frac{1}{3} y_n + \\frac{2}{3} (y^{(2)} + \\Delta t L(y^{(2)})) $$\n对于标量测试方程 $y'=\\lambda y$，我们有 $L(y)=\\lambda y$。令 $z = \\lambda \\Delta t$。该方法变为：\n$$ y^{(1)} = (1+z) y_n $$\n$$ y^{(2)} = \\left[ \\frac{3}{4} + \\frac{1}{4} (1+z) + \\frac{1}{4} z(1+z) \\right] y_n = \\left[ \\frac{3}{4} + \\frac{1}{4}(1+z)^2 \\right] y_n = \\left( 1 + \\frac{1}{2}z + \\frac{1}{4}z^2 \\right) y_n $$\n$$ y_{n+1} = \\left[ \\frac{1}{3} + \\frac{2}{3} (1+z) \\left( 1 + \\frac{1}{2}z + \\frac{1}{4}z^2 \\right) \\right] y_n $$\n方括号中的项是稳定性多项式 $R(z)$。\n$$ R(z) = \\frac{1}{3} + \\frac{2}{3} \\left( 1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3 \\right) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 $$\n放大因子是 $G = R(z)$。现在我们将 $z$ 替换为我们的特定表达式：\n$$ z = \\lambda(k)\\Delta t = \\left( - \\frac{ia}{h} \\sin(kh) \\right) \\Delta t = -i \\frac{a \\Delta t}{h} \\sin(kh) $$\n使用无量纲参数 $\\nu = a \\Delta t / h$ 和 $\\theta = k h$：\n$$ z = -i \\nu \\sin(\\theta) $$\n我们计算 $z$ 的幂：\n$$ z^2 = (-i)^2 (\\nu \\sin(\\theta))^2 = -\\nu^2\\sin^2(\\theta) $$\n$$ z^3 = (-i)^3 (\\nu \\sin(\\theta))^3 = i \\nu^3\\sin^3(\\theta) $$\n将这些代入 $G=R(z)$ 的表达式中：\n$$ G(\\theta, \\nu) = 1 + (-i\\nu\\sin(\\theta)) + \\frac{1}{2}(-\\nu^2\\sin^2(\\theta)) + \\frac{1}{6}(i\\nu^3\\sin^3(\\theta)) $$\n$$ G(\\theta, \\nu) = \\left( 1 - \\frac{1}{2}\\nu^2\\sin^2(\\theta) \\right) - i \\left( \\nu\\sin(\\theta) - \\frac{1}{6}\\nu^3\\sin^3(\\theta) \\right) $$\n这就是放大因子的闭式表达式。\n\n### 步骤5：稳定性分析与临界时间步长\n\n为使格式数值稳定，任何傅里叶模态的放大因子的幅值都不得超过1，即 $|G| \\le 1$。\n$$ |G|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2 \\le 1 $$\n令 $X = \\nu\\sin(\\theta)$。\n$$ |G|^2 = \\left( 1 - \\frac{1}{2}X^2 \\right)^2 + \\left( - \\left(X - \\frac{1}{6}X^3\\right) \\right)^2 $$\n$$ |G|^2 = \\left( 1 - X^2 + \\frac{1}{4}X^4 \\right) + \\left( X^2 - \\frac{1}{3}X^4 + \\frac{1}{36}X^6 \\right) $$\n$$ |G|^2 = 1 + \\left(\\frac{1}{4} - \\frac{1}{3}\\right)X^4 + \\frac{1}{36}X^6 $$\n$$ |G|^2 = 1 - \\frac{1}{12}X^4 + \\frac{1}{36}X^6 = 1 - \\frac{X^4}{36}(3 - X^2) $$\n稳定性条件 $|G|^2 \\le 1$ 变为：\n$$ 1 - \\frac{X^4}{36}(3 - X^2) \\le 1 $$\n$$ - \\frac{X^4}{36}(3 - X^2) \\le 0 $$\n由于 $X^4 \\ge 0$，该不等式成立当且仅当：\n$$ 3 - X^2 \\ge 0 \\implies X^2 \\le 3 $$\n$$ |X| \\le \\sqrt{3} $$\n代回 $X = \\nu \\sin(\\theta)$：\n$$ |\\nu \\sin(\\theta)| \\le \\sqrt{3} $$\n由于 $\\nu = a\\Delta t/h > 0$，这等价于 $\\nu |\\sin(\\theta)| \\le \\sqrt{3}$。\n为确保对所有可能的傅里叶模态都稳定，此条件必须对使 $|\\sin(\\theta)|$ 最大化的 $\\theta=kh$ 值成立。在离散网格上，可分辨波数的范围使 $\\theta$ 跨越 $[-\\pi, \\pi]$，因此最大值为 $\\max_{\\theta} |\\sin(\\theta)| = 1$（在 $\\theta = \\pm \\pi/2$ 时取得）。\n因此，总的稳定性条件是：\n$$ \\nu \\cdot 1 \\le \\sqrt{3} \\implies \\nu \\le \\sqrt{3} $$\n临界Courant数为 $\\nu_{\\text{crit}} = \\sqrt{3}$。临界时间步长 $\\Delta t_{\\text{crit}}$ 是与此临界Courant数对应的时间步长：\n$$ \\frac{a \\Delta t_{\\text{crit}}}{h} = \\sqrt{3} $$\n$$ \\Delta t_{\\text{crit}} = \\frac{\\sqrt{3}h}{a} $$\n\n最终答案需要两个部分：放大因子 $G(\\theta, \\nu)$ 和临界时间步长 $\\Delta t_{\\text{crit}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 - \\frac{1}{2}\\nu^2 \\sin^2(\\theta) - i \\left(\\nu\\sin(\\theta) - \\frac{1}{6}\\nu^3 \\sin^3(\\theta)\\right)  \\frac{\\sqrt{3}h}{a} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "处理非线性问题（如无粘性伯格斯方程）为稳定性分析带来了新的挑战，其中由于非线性项的近似积分而产生的“混淆误差”(aliasing error) 可能会导致能量增长和不稳定。本练习  探讨了一种实用的镇定策略：通过混合使用非耗散的中心通量和耗散的迎风通量来构建数值格式。您将基于一个简化的混淆误差模型，推导保证非线性稳定所需的最小耗散量，从而掌握如何设计数值通量以抵消非物理能量产生，确保解的鲁棒性。",
            "id": "3368546",
            "problem": "考虑一维无粘伯格斯方程 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$，定义在周期性区域 $[0,1]$ 上，使用节点间断伽辽金 (DG) 方法进行离散，该方法采用 Legendre–Gauss–Lobatto (LGL) 点和配置正交。网格是均匀的，包含 $N$ 个大小为 $h = \\frac{1}{N}$ 的单元，每个单元的多项式次数为 $p \\in \\{3,4,5\\}$。数值界面通量选择为凸混合形式\n$$\n\\widehat{f} \\;=\\; (1-\\alpha)\\, f^{\\text{cen}} \\;+\\; \\alpha\\, f^{\\text{up}},\n$$\n其中 $f^{\\text{cen}}$ 是中心（算术平均）通量，$f^{\\text{up}}$ 是 Rusanov（局部 Lax–Friedrichs）通量，其参数 $\\lambda \\geq \\max\\{|u_{L}|,|u_{R}|\\}$，$0 \\leq \\alpha \\leq 1$ 是一个混合系数。假设存在均匀边界 $|u| \\leq U$，因此 Rusanov 参数设置为 $\\lambda = U$。\n\n对半离散 DG 格式使用能量方法，并利用以下经过充分检验的事实：\n- 使用 $f^{\\text{cen}}$ 和精确的体积积分时，半离散 DG 格式是能量守恒的；使用 $f^{\\text{up}}$ 时，它会引入与 $[u]^{2}$ 成正比的界面耗散，其中 $[u]$ 表示跨界面的跳跃。\n- 在没有过积分的配置方法下，体积项中的非线性混叠可以建模为面局部的能量产生，其每个界面的贡献上界为\n$$\n\\frac{U}{2}\\,\\eta\\,p\\, [u]^{2},\n$$\n其中 $\\eta$ 是一个指定的无量纲混叠水平，$p$ 是多项式次数。这个界反映了在 LGL 配置中，多项式乘积的积分不足误差随 $p$ 的增长。\n\n基于这些基础，推导出一个关于 $p$ 和 $h$ 的 $\\alpha$ 的充分下界，以保证混合通量选择下的非线性能量稳定性（离散 $L^{2}$ 能量不增加）。然后，对于指定的参数 $U = 1$，$\\eta = 0.18$ 和 $p \\in \\{3,4,5\\}$，确定一个能同时对这三种次数强制实现稳定性的最小 $\\alpha$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。不需要单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- **控制方程**：一维无粘伯格斯方程，$u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$。\n- **区域**：在 $[0,1]$ 上的周期性区域。\n- **离散方法**：节点间断伽辽金 (DG) 方法，采用 Legendre–Gauss–Lobatto (LGL) 点和配置正交。\n- **网格**：均匀网格，包含 $N$ 个大小为 $h = \\frac{1}{N}$ 的单元。\n- **多项式次数**：$p \\in \\{3,4,5\\}$。\n- **数值通量**：$\\widehat{f} \\;=\\; (1-\\alpha)\\, f^{\\text{cen}} \\;+\\; \\alpha\\, f^{\\text{up}}$，其中 $0 \\leq \\alpha \\leq 1$。\n- **通量分量**：$f^{\\text{cen}}$ 是中心（算术平均）通量；$f^{\\text{up}}$ 是 Rusanov（局部 Lax–Friedrichs）通量。\n- **Rusanov 参数**：$\\lambda \\geq \\max\\{|u_{L}|,|u_{R}|\\}$，具体选择为 $\\lambda = U$，基于均匀边界 $|u| \\leq U$。\n- **已知事实 1**：使用 $f^{\\text{cen}}$ 和精确的体积积分时，半离散 DG 格式是能量守恒的。\n- **已知事实 2**：使用 $f^{\\text{up}}$ 时，会引入与 $[u]^{2}$ 成正比的界面耗散，其中 $[u]$ 是跳跃。\n- **已知事实 3**：在配置方法下，体积项中的混叠被建模为面局部的能量产生，其每个界面的贡献上界为 $\\frac{U}{2}\\,\\eta\\,p\\, [u]^{2}$，其中 $\\eta$ 是一个无量纲混叠水平。\n- **数值参数**：$U = 1$，$\\eta = 0.18$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题属于偏微分方程数值分析的成熟领域，特别关注谱方法和 DG 方法。伯格斯方程、能量稳定性分析、Rusanov 通量和混叠误差都是标准且经过充分研究的概念。该问题在科学上是合理的。\n- **适定性**：问题要求基于一个简化但明确定义的混叠误差模型，给出一个稳定性的充分条件。这使得该问题是适定的且可解的。\n- **客观性**：该问题以精确、客观的数学语言陈述。\n- **完整性**：该问题提供了所有必要信息，包括一个可处理的混叠误差模型，否则将需要更复杂的推导。问题是自洽的。\n- **一致性**：所提供的信息中没有明显的矛盾。\n\n**第 3 步：结论与行动**\n\n问题被判定为有效。将推导解答。\n\n### 解答推导\n\n目标是找到混合系数 $\\alpha$ 的一个充分下界，以确保半离散 DG 格式是非线性能量稳定的。能量稳定性意味着总离散 $L^2$ 能量 $E_h$ 不随时间增加。能量定义为：\n$$\nE_h = \\sum_{k=1}^{N} \\int_{I_k} \\frac{u_h^2}{2} dx_h\n$$\n其中 $u_h$ 是单元 $I_k$ 中的多项式近似，积分使用 LGL 配置正交法则进行近似。我们分析能量的时间导数 $\\frac{dE_h}{dt}$。\n\n能量的变化率在概念上可以分解为几个部分：\n$$\n\\frac{dE_h}{dt} = \\dot{E}_{\\text{vol, h}} + \\dot{E}_{\\text{surf}}\n$$\n其中 $\\dot{E}_{\\text{vol, h}}$ 是由非精确正交计算的体积积分的贡献，而 $\\dot{E}_{\\text{surf}}$ 是来自单元界面的数值通量的贡献。\n\n我们可以进一步分解这些项。体积项可以写成精确积分产生的项和一个混叠误差项 $A$ 的和：\n$$\n\\dot{E}_{\\text{vol, h}} = \\dot{E}_{\\text{vol, exact}} + A\n$$\n表面通量项，使用混合通量 $\\widehat{f} = (1-\\alpha)f^{\\text{cen}} + \\alpha f^{\\text{up}}$，可以分解为中心通量的贡献和迎风偏置部分的贡献：\n$$\n\\dot{E}_{\\text{surf}} = \\dot{E}_{\\text{surf, cen}} + \\dot{E}_{\\text{diss}}\n$$\n结合这些，总能量变化率为：\n$$\n\\frac{dE_h}{dt} = \\left( \\dot{E}_{\\text{vol, exact}} + \\dot{E}_{\\text{surf, cen}} \\right) + A + \\dot{E}_{\\text{diss}}\n$$\n我们现在根据问题陈述中提供的事实来分析每个分量。\n\n1.  **守恒部分**：第一个事实指出，采用中心通量和精确体积积分的格式是能量守恒的。这直接意味着这两部分贡献之和为零：\n    $$\n    \\dot{E}_{\\text{vol, exact}} + \\dot{E}_{\\text{surf, cen}} = 0\n    $$\n    这将能量变化率方程简化为：\n    $$\n    \\frac{dE_h}{dt} = A + \\dot{E}_{\\text{diss}}\n    $$\n\n2.  **耗散部分 ($\\dot{E}_{\\text{diss}}$)**：Rusanov 通量由 $f^{\\text{up}} = f^{\\text{cen}} - \\frac{\\lambda}{2}[u]$ 给出，其中 $[u] = u_R - u_L$ 是跨界面的跳跃，$u_L$ 和 $u_R$ 分别是界面左侧和右侧的状态。混合通量为：\n    $$\n    \\widehat{f} = (1-\\alpha)f^{\\text{cen}} + \\alpha\\left(f^{\\text{cen}} - \\frac{\\lambda}{2}[u]\\right) = f^{\\text{cen}} - \\frac{\\alpha\\lambda}{2}[u]\n    $$\n    界面项对能量变化率的贡献是 $\\sum_j ([u]_j \\widehat{f}_j - \\text{来自 } \\dot{E}_{\\text{vol, exact}} \\text{ 的边界项})$。中心通量贡献和精确体积项的组合已经被考虑在内（其和为零）。剩余的部分，我们称之为耗散，来自通量的迎风部分。由表面项引起的能量变化为 $\\sum_j \\mathcal{F}_j$，其中 $\\mathcal{F}_j$ 是跨界面 $j$ 的数值能量通量。耗散对应于使用 $\\widehat{f}$ 的能量通量与使用 $f^{\\text{cen}}$ 的能量通量之间的差异。这导致在所有界面 $j$ 上求和的耗散率为：\n    $$\n    \\dot{E}_{\\text{diss}} = -\\sum_j \\frac{\\alpha\\lambda}{2} [u]_j^2\n    $$\n    由于 $\\alpha \\ge 0$ 和 $\\lambda \\ge 0$，该项为非正数，表示在界面处的能量耗散。\n\n3.  **混叠部分 ($A$)**：第三个事实提供了一个模型，用于描述由体积项积分不足引起的非线性混叠所产生的能量。它以每个界面贡献的总和形式给出，$A = \\sum_j A_j$，其界为：\n    $$\n    A_j \\le \\frac{U}{2}\\eta p [u]_j^2\n    $$\n    对所有界面求和，总混叠产生量有界：\n    $$\n    A \\le \\sum_j \\frac{U}{2}\\eta p [u]_j^2\n    $$\n\n结合混叠和耗散的界，我们得到总能量变化率的上界：\n$$\n\\frac{dE_h}{dt} = A + \\dot{E}_{\\text{diss}} \\le \\sum_j \\frac{U}{2}\\eta p [u]_j^2 - \\sum_j \\frac{\\alpha\\lambda}{2} [u]_j^2\n$$\n$$\n\\frac{dE_h}{dt} \\le \\sum_j \\left( \\frac{U}{2}\\eta p - \\frac{\\alpha\\lambda}{2} \\right) [u]_j^2\n$$\n为保证能量稳定性，我们需要 $\\frac{dE_h}{dt} \\le 0$。为确保对任何可能的跳跃 $[u]_j$ 配置都成立，一个充分条件是每个 $[u]_j^2$ 项的系数为非正：\n$$\n\\frac{U}{2}\\eta p - \\frac{\\alpha\\lambda}{2} \\le 0\n$$\n我们现在可以解出 $\\alpha$。问题指定 Rusanov 参数 $\\lambda$ 被设置为速度界 $U$，所以 $\\lambda=U$。\n$$\n\\frac{U}{2}\\eta p \\le \\frac{\\alpha U}{2}\n$$\n因为 $U  0$，我们可以除以 $U/2$ 而不改变不等号方向：\n$$\n\\eta p \\le \\alpha\n$$\n因此，非线性能量稳定的一个充分条件是 $\\alpha \\ge \\eta p$。这个 $\\alpha$ 的下界取决于多项式次数 $p$ 和混叠水平 $\\eta$，但与网格大小 $h$ 无关。\n\n最后，我们必须确定在给定 $\\eta = 0.18$ 的情况下，能确保对所有指定多项式次数 $p \\in \\{3,4,5\\}$ 都稳定的单一最小 $\\alpha$ 值。我们必须满足这些 $p$ 值中“最坏情况”的条件。\n\n对于 $p=3$：\n$$\n\\alpha \\ge 0.18 \\times 3 = 0.54\n$$\n对于 $p=4$：\n$$\n\\alpha \\ge 0.18 \\times 4 = 0.72\n$$\n对于 $p=5$：\n$$\n\\alpha \\ge 0.18 \\times 5 = 0.90\n$$\n\n为了同时确保所有三种情况的稳定性，$\\alpha$ 必须大于或等于这些下界中的最大值：\n$$\n\\alpha \\ge \\max(0.54, 0.72, 0.90) = 0.90\n$$\n满足此条件的最小 $\\alpha$ 值为 $\\alpha = 0.90$。问题要求将这个无量纲数四舍五入到四位有效数字。",
            "answer": "$$\n\\boxed{0.9000}\n$$"
        }
    ]
}