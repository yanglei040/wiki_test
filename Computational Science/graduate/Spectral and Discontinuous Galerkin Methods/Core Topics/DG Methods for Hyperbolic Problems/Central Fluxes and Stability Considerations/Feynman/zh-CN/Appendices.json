{
    "hands_on_practices": [
        {
            "introduction": "在分析间断伽辽金（DG）方法的稳定性之前，我们必须首先确保数值格式本身的精确实现。本练习将引导你通过阶数分析，确定精确计算DG弱形式中各项积分所需的最小求积阶数。这对于避免不必要的离散误差至关重要，是构建任何可靠DG求解器的第一步。",
            "id": "3368532",
            "problem": "考虑在仿射单元网格上，空间维度为 $d \\ge 1$、具有恒定平流向量 $\\boldsymbol{a} \\in \\mathbb{R}^d$ 的标量线性平流方程，\n$$\n\\partial_t u + \\nabla \\cdot (\\boldsymbol{a} \\, u) = 0,\n$$\n该方程通过间断 Galerkin (DG) 方法进行离散化，在每个单元上使用次数至多为 $p \\ge 1$ 的多项式试探和检验空间。假设从参考单元到每个单元的映射都是仿射的，因此雅可比行列式和面法向量分别在每个单元和每个面上都是常数。\n\n采用 DG 弱形式，该弱形式通过在每个单元上对通量项中的散度进行分部积分得到，并使用中心数值通量来封闭该方法。在每个具有固定单位法向量 $\\boldsymbol{n}_F$ 的内部面 $F$ 上，标量 $w$ 的平均和跳跃定义为\n$$\n\\{ w \\} = \\frac{w^{-} + w^{+}}{2}, \\qquad [w] = w^{-} - w^{+},\n$$\n并将中心数值通量设为 $\\widehat{f} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\, \\{ u \\}$。在边界面上，对于内部迹，将 $\\{ u \\}$ 解释为 $u$，将 $[v]$ 解释为 $v$。\n\n令双线性形式 $B(u_h, v_h)$ 表示作用于离散函数 $u_h$ 和 $v_h$ 的空间半离散 DG 算子，其中 $u_h$ 和 $v_h$ 取自每个单元上总次数至多为 $p$ 的多项式空间。你的任务是确定为能对所有这样的 $u_h$ 和 $v_h$ 精确积分 $B(u_h, v_h)$ 所需的体和面积分求积法则的最小多项式精确次数，分别记为 $q_V$ 和 $q_F$。\n\n就本题而言，如果一个体积求积法则能在参考单元的任何仿射像上精确积分任何总次数至多为 $q_V$ 的多项式，则定义其多项式精确次数为 $q_V$；如果一个面积分求积法则能在参考面的任何仿射像上精确积分任何总次数至多为 $q_F$ 的多项式，则定义其多项式精确次数为 $q_F$。\n\n从第一性原理出发，并通过由仿射映射和带中心通量的 DG 弱形式结构所支持的次数计算论证，推导出 $q_V$ 和 $q_F$ 作为 $p$ 的函数的最小值。你的最终答案必须是 $q_V$ 和 $q_F$ 的一对解析表达式，并使用 $\\mathrm{pmatrix}$ 环境写成一个单行矩阵。不需要进行数值近似。",
            "solution": "该问题要求确定用于线性平流方程的间断 Galerkin (DG) 离散的体积和面积分求积法则的最小多项式精确次数，分别记为 $q_V$ 和 $q_F$。\n\n设离散解 $u_h$ 和检验函数 $v_h$ 属于网格 $\\mathcal{T}_h$ 中每个单元 $K$ 上总次数至多为 $p \\ge 1$ 的多项式空间。标量线性平流方程由下式给出\n$$\n\\partial_t u + \\nabla \\cdot (\\boldsymbol{a} \\, u) = 0\n$$\n其中 $\\boldsymbol{a} \\in \\mathbb{R}^d$ 是一个常向量。由于 $\\boldsymbol{a}$ 是常数，散度项简化为 $\\nabla \\cdot (\\boldsymbol{a} \\, u) = \\boldsymbol{a} \\cdot \\nabla u$。\n\n为推导半离散弱形式，我们将方程的空间部分乘以一个检验函数 $v_h$，并在一个单元 $K$ 上积分：\n$$\n\\int_K (\\boldsymbol{a} \\cdot \\nabla u_h) v_h \\, d\\boldsymbol{x}\n$$\n应用分部积分（格林公式）可得：\n$$\n\\int_{\\partial K} (\\boldsymbol{a} \\cdot \\boldsymbol{n}_K) u_h v_h \\, dS - \\int_K (\\boldsymbol{a} u_h) \\cdot \\nabla v_h \\, d\\boldsymbol{x}\n$$\n其中 $\\boldsymbol{n}_K$ 是边界 $\\partial K$ 上的外指单位法向量。由于 $\\boldsymbol{a}$ 是常数，这等价于：\n$$\n\\int_{\\partial K} u_h (\\boldsymbol{a} \\cdot \\boldsymbol{n}_K) v_h \\, dS - \\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x}\n$$\n在 DG 方法中，单元边界 $\\partial K$ 上 $u_h$ 的迹被一个数值通量所替代。问题指定了中心通量，其法向数值通量由 $\\widehat{f} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\}$ 给出。项 $u_h (\\boldsymbol{a} \\cdot \\boldsymbol{n}_K)$ 被 $\\widehat{f}$ 替换。\n\n因此，单元 $K$ 对空间算子的贡献为：\n$$\n\\int_{\\partial K} \\widehat{f}(u_h) v_h \\, dS - \\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x}\n$$\n双线性形式 $B(u_h, v_h)$ 是通过对所有单元 $K \\in \\mathcal{T}_h$ 的这些贡献求和得到的：\n$$\nB(u_h, v_h) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_{\\partial K} \\widehat{f}(u_h) v_h \\, dS - \\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x} \\right)\n$$\n我们可以将边界积分的和重写为网格中所有唯一面 $\\mathcal{F}$ 的集合上的和。设 $F$ 为单元 $K^-$ 和 $K^+$ 之间的一个内部面，其单位法向量 $\\boldsymbol{n}_F$ 从 $K^-$ 指向 $K^+$。该面对总和的贡献是：\n$$\n\\int_F \\widehat{f}(u_h^-, u_h^+, \\boldsymbol{n}_F) v_h^- \\, dS + \\int_F \\widehat{f}(u_h^+, u_h^-, -\\boldsymbol{n}_F) v_h^+ \\, dS\n$$\n中心通量 $\\widehat{f}(u^-, u^+, \\boldsymbol{n}) = (\\boldsymbol{a} \\cdot \\boldsymbol{n}) \\frac{u^- + u^+}{2} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}) \\{u\\}$ 是守恒的，即 $\\widehat{f}(u^+, u^-, -\\boldsymbol{n}) = -\\widehat{f}(u^-, u^+, \\boldsymbol{n})$。因此，内部面项变为：\n$$\n\\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\} [v_h] \\, dS\n$$\n对于边界面 $F$，问题规定将 $\\{u\\}$ 解释为内部迹 $u$，将 $[v]$ 解释为内部迹 $v$。因此，面积分项变为 $\\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_h v_h \\, dS$。这个约定使我们能够以统一的方式写出所有面上的和。\n\n完整的双线性形式为：\n$$\nB(u_h, v_h) = - \\sum_{K \\in \\mathcal{T}_h} \\underbrace{\\int_K u_h (\\boldsymbol{a} \\cdot \\nabla v_h) \\, d\\boldsymbol{x}}_{\\text{体积分}} + \\sum_{F \\in \\mathcal{F}} \\underbrace{\\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\} [v_h] \\, dS}_{\\text{面积分}}\n$$\n我们需要找到最小的求积精确次数 $q_V$ 和 $q_F$，以便对次数至多为 $p$ 的多项式空间中所有的 $u_h, v_h$ 精确地积分体和面积分项。问题假设了仿射单元映射，这意味着体积积分的雅可比行列式以及面积分的雅可比行列式和法向量分别在每个单元和面上是常数。这确保了在变换到参考单元/面时，被积函数的多项式次数保持不变。\n\n**体积积分求积 ($q_V$)**\n\n单元 $K$ 上体积积分的被积函数是 $I_V = u_h (\\boldsymbol{a} \\cdot \\nabla v_h)$。\n-   $u_h$ 是一个总次数至多为 $p$ 的多项式。\n-   $v_h$ 是一个总次数至多为 $p$ 的多项式。其梯度 $\\nabla v_h$ 是一个由总次数至多为 $p-1$ 的多项式组成的向量。\n-   由于 $\\boldsymbol{a}$ 是一个常向量，点积 $\\boldsymbol{a} \\cdot \\nabla v_h$ 是一个总次数至多为 $p-1$ 的标量多项式。\n-   因此，乘积 $I_V = u_h (\\boldsymbol{a} \\cdot \\nabla v_h)$ 是一个总次数至多为 $p + (p-1) = 2p-1$ 的多项式。\n\n为确保该积分能被精确计算，体积求积法则必须对所有次数至多为此次数的多项式都精确。这给出了一个下界 $q_V \\ge 2p-1$。为了证明这是最小的，我们必须证明可以构造出一个次数恰好为 $2p-1$ 的多项式。考虑一维情况，其中 $u_h(x) = x^p$ 且 $v_h(x) = x^p$。那么 $\\nabla v_h = v_h'(x) = p x^{p-1}$。被积函数为 $u_h (a v_h') = x^p (a \\cdot p x^{p-1}) = ap x^{2p-1}$，这是一个次数为 $2p-1$ 的多项式。因此，一个精确次数小于 $2p-1$ 的求积法则将会失效。\n体积求积所需的最小多项式精确次数为 $q_V = 2p-1$。\n\n**面积分求积 ($q_F$)**\n\n面 $F$ 上面积分的被积函数为 $I_F = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) \\{u_h\\} [v_h]$。\n-   由于仿射网格的假设，项 $\\boldsymbol{a} \\cdot \\boldsymbol{n}_F$ 在面 $F$ 上是常数。\n-   $u_h$ 和 $v_h$ 在面 $F$ 上的迹是该面局部坐标系下总次数至多为 $p$ 的多项式。\n-   在内部面上，平均值 $\\{u_h\\} = \\frac{u_h^- + u_h^+}{2}$ 是一个总次数至多为 $p$ 的多项式。\n-   跳跃项 $[v_h] = v_h^- - v_h^+$ 也是一个总次数至多为 $p$ 的多项式。\n-   因此，乘积 $\\{u_h\\} [v_h]$ 是一个总次数至多为 $p + p = 2p$ 的多项式。\n\n在边界面上，根据指定的约定，被积函数为 $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_h v_h$。$u_h$ 和 $v_h$ 在该面上都是次数至多为 $p$ 的多项式。它们的乘积是一个次数至多为 $2p$ 的多项式。\n\n在这两种情况下，面积分被积函数都是总次数至多为 $2p$ 的多项式。为保证精确积分，面积分求积法则必须对所有次数达到此值的多项式都精确，因此 $q_F \\ge 2p$。为了证明这是最小的，考虑一个可以独立选择迹的面。设 $\\phi$ 是面坐标系下次数为 $p$ 的多项式。我们可以构造 $u_h$ 和 $v_h$，使得在面上，$u_h^-=\\phi, u_h^+=0$ 且 $v_h^-=\\phi, v_h^+=0$。那么 $\\{u_h\\}=\\phi/2$ 且 $[v_h]=\\phi$。乘积 $\\{u_h\\}[v_h]=\\phi^2/2$ 是一个次数为 $2p$ 的多项式。因此，一个精确次数小于 $2p$ 的求积法则是不足够的。\n面积分求积所需的最小多项式精确次数为 $q_F = 2p$。\n\n总之，体积积分所需的最小求积精确次数为 $q_V = 2p-1$，面积分所需的最小求积精确次数为 $q_F = 2p$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2p-1  2p\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "即便积分是精确的，数值通量的选择对稳定性也至关重要。本练习利用傅里叶分析，研究了中心通量在一维线性平流问题中的表现，揭示了其纯粹的非耗散特性。通过这个练习，你将推导出在特定时间积分格式下，为保证数值解稳定所必须满足的时间步长限制（CFL条件）。",
            "id": "3368574",
            "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其定义于一个具有均匀网格（间距为 $h$）的周期性一维域上，其中 $a > 0$ 是一个恒定的平流速度。\n\n使用间断伽辽金（DG）空间离散方法，采用分片常数基函数（多项式次数 $p = 0$）和中心数值通量。即，在每个交界面上，数值通量是根据左迹和右迹计算的物理通量的算术平均值。将单元 $j$ 内的单元平均值记为 $u_{j}(t)$，并设与该单元关联的网格点为 $x_{j} = j\\,h$。\n\n一个代表性的傅里叶模态形式为 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,k\\,x_{j})$，其中 $k$ 是波数。对于上述半离散DG算子，通过代入此傅里叶模态，建立常微分方程 $d\\hat{u}/dt = \\lambda(k)\\,\\hat{u}$，并确定相应的特征值 $\\lambda(k)$。\n\n接下来，使用三阶三步强稳定保持龙格-库塔方法（SSPRK(3,3)）对该半离散系统进行时间推进。对于标量线性测试方程 $y' = \\lambda\\,y$，该方法会产生一个作用于模态振幅 $\\hat{u}$ 上的标量放大因子 $G = R(z)$，其中 $z = \\Delta t\\,\\lambda(k)$ 且 $\\Delta t$ 是时间步长。计算代表性傅里叶模态的放大因子 $G$ 的闭式表达式，该表达式应以 $k$、$a$、$h$ 和 $\\Delta t$ 表示。\n\n最后，通过要求最大振幅的傅里叶模态在一个SSPRK(3,3)步长下幅值不增长，确定此DG中心通量半离散格式开始出现数值不稳定性时的临界时间步长 $\\Delta t_{\\text{crit}}$。请用 $a$ 和 $h$ 符号化地表示你的答案，并将一般傅里叶模态的放大因子报告为无量纲参数 $\\nu \\equiv a\\,\\Delta t / h$ 和无量纲波数 $\\theta \\equiv k\\,h$ 的函数。\n\n以一个两元行矩阵的形式提供最终答案：第一个元素是 $G(\\theta,\\nu)$ 的闭式表达式，第二个元素是临界时间步长 $\\Delta t_{\\text{crit}}$。最终答案中不要包含单位。无需进行数值取整。",
            "solution": "首先，推导用于分片常数基函数 ($p=0$) 的半离散DG格式。对于方程 $u_t + a u_x = 0$，其在单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上的弱形式为：\n$$ \\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx = \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx - [a \\hat{u}_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} $$\n对于分片常数基函数，我们令 $u_h(x,t) = u_j(t)$ 且测试函数 $v_h(x) = 1$。因此 $\\frac{\\partial v_h}{\\partial x} = 0$，方程简化为：\n$$ h \\frac{d u_j}{d t} = - \\left( (a \\hat{u}_h)_{j+1/2} - (a \\hat{u}_h)_{j-1/2} \\right) $$\n中心通量为 $(a \\hat{u}_h)_{j+1/2} = \\frac{a u_j(t) + a u_{j+1}(t)}{2}$。将其代入得到：\n$$ h \\frac{d u_j}{d t} = - \\left( \\frac{a u_j + a u_{j+1}}{2} - \\frac{a u_{j-1} + a u_j}{2} \\right) = - \\frac{a}{2} (u_{j+1} - u_{j-1}) $$\n半离散方程为：\n$$ \\frac{d u_j}{d t} = - \\frac{a}{2h} (u_{j+1} - u_{j-1}) $$\n\n接下来，进行傅里叶分析以确定空间算子的特征值 $\\lambda(k)$。将傅里叶模态 $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$ 代入半离散方程：\n$$ \\frac{d\\hat{u}}{dt} e^{ikjh} = - \\frac{a}{2h} \\hat{u}(t) \\left( e^{ik(j+1)h} - e^{ik(j-1)h} \\right) $$\n$$ \\frac{d\\hat{u}}{dt} = - \\frac{a}{2h} \\hat{u}(t) \\left( e^{ikh} - e^{-ikh} \\right) = - \\frac{a}{2h} \\hat{u}(t) (2i\\sin(kh)) $$\n特征值为：\n$$ \\lambda(k) = - \\frac{ia}{h} \\sin(kh) $$\n该特征值是纯虚数，表明空间离散是无耗散的。\n\n然后，分析SSPRK(3,3)时间积分方法的稳定性。该方法的稳定性多项式为 $R(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3$。放大因子 $G$ 是当 $z = \\lambda(k)\\Delta t$ 时 $R(z)$ 的值。使用无量纲参数 $\\nu = a \\Delta t / h$ 和 $\\theta = k h$，我们有：\n$$ z = -i \\frac{a\\Delta t}{h} \\sin(kh) = -i \\nu \\sin(\\theta) $$\n代入 $R(z)$，得到放大因子 $G(\\theta, \\nu)$:\n$$ G(\\theta, \\nu) = 1 + (-i\\nu\\sin(\\theta)) + \\frac{1}{2}(-i\\nu\\sin(\\theta))^2 + \\frac{1}{6}(-i\\nu\\sin(\\theta))^3 $$\n$$ G(\\theta, \\nu) = \\left( 1 - \\frac{1}{2}\\nu^2\\sin^2(\\theta) \\right) - i \\left( \\nu\\sin(\\theta) - \\frac{1}{6}\\nu^3\\sin^3(\\theta) \\right) $$\n\n最后，确定稳定性条件。数值稳定性要求 $|G|^2 \\le 1$。令 $X = \\nu\\sin(\\theta)$，则 $G = (1 - \\frac{1}{2}X^2) - i(X - \\frac{1}{6}X^3)$。\n$$ |G|^2 = \\left( 1 - \\frac{1}{2}X^2 \\right)^2 + \\left( X - \\frac{1}{6}X^3 \\right)^2 = 1 - \\frac{1}{12}X^4 + \\frac{1}{36}X^6 = 1 - \\frac{X^4}{36}(3 - X^2) $$\n稳定性条件 $|G|^2 \\le 1$ 意味着 $1 - \\frac{X^4}{36}(3 - X^2) \\le 1$，这简化为 $3 - X^2 \\ge 0$，即 $|X| \\le \\sqrt{3}$。\n将 $X$ 代回：$|\\nu\\sin(\\theta)| \\le \\sqrt{3}$。为对所有波数都稳定，该条件必须对 $|\\sin(\\theta)|$ 的最大值（即 1）成立。因此，稳定性限制是 $\\nu \\le \\sqrt{3}$。\n临界时间步长为：\n$$ \\frac{a \\Delta t_{\\text{crit}}}{h} = \\sqrt{3} \\implies \\Delta t_{\\text{crit}} = \\frac{\\sqrt{3}h}{a} $$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 - \\frac{1}{2}\\nu^2 \\sin^2(\\theta) - i \\left(\\nu\\sin(\\theta) - \\frac{1}{6}\\nu^3 \\sin^3(\\theta)\\right)  \\frac{\\sqrt{3}h}{a} \\end{pmatrix}}\n$$"
        }
    ]
}