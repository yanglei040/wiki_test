## Introduction
The compressible Euler equations form the bedrock of modern fluid dynamics, describing the motion of gases in regimes where viscosity and thermal conductivity are negligible. However, solving these nonlinear [hyperbolic conservation laws](@entry_id:147752) presents a formidable numerical challenge, demanding methods that can achieve [high-order accuracy](@entry_id:163460) in smooth regions while robustly capturing sharp discontinuities like shock waves. The Discontinuous Galerkin (DG) method has emerged as a particularly powerful and flexible framework for this task, elegantly bridging the gap between finite volume and finite element techniques. It offers [high-order accuracy](@entry_id:163460) on unstructured meshes, straightforward handling of complex geometries, and a natural framework for [parallelization](@entry_id:753104) and adaptivity.

This article provides a graduate-level exploration of DG formulations for the compressible Euler equations, designed to guide the reader from foundational theory to advanced application. It addresses the central problem of how to construct a stable, accurate, and efficient DG scheme for complex, real-world flows. Across three comprehensive chapters, you will gain a deep understanding of the method's inner workings and its vast potential.

The journey begins in **"Principles and Mechanisms"**, where we will dissect the core mathematical and numerical machinery of the DG method. This chapter lays the groundwork, covering the [weak formulation](@entry_id:142897), [spatial discretization](@entry_id:172158) with different bases, the crucial role of numerical fluxes, and the theoretical underpinnings of stability and accuracy. Next, **"Applications and Interdisciplinary Connections"** bridges theory and practice. We explore how the DG method is applied in [computational fluid dynamics](@entry_id:142614) to handle boundary conditions, moving meshes, and shock waves, and we examine advanced techniques like `hp`-adaptivity and connections to fields like [geophysics](@entry_id:147342) and [high-performance computing](@entry_id:169980). Finally, **"Hands-On Practices"** solidifies this knowledge through targeted exercises focused on essential skills such as selecting [quadrature rules](@entry_id:753909), analyzing [numerical fluxes](@entry_id:752791), and implementing shock detection indicators. We will now begin by establishing the foundational principles that make the DG method a cornerstone of modern computational science.

## Principles and Mechanisms

The Discontinuous Galerkin (DG) method represents a powerful framework for the numerical approximation of conservation laws, combining advantageous features of both finite element and [finite volume methods](@entry_id:749402). This chapter elucidates the fundamental principles and mechanisms that underpin DG formulations for the compressible Euler equations. We will proceed from the [weak formulation](@entry_id:142897) to the details of [spatial discretization](@entry_id:172158), the treatment of complex geometries, the crucial role of [numerical fluxes](@entry_id:752791), and conclude with an examination of stability and accuracy.

### The DG Weak Formulation and Conservation

The foundation of a DG method is its weak formulation, derived on an element-by-element basis. We begin with the compressible Euler equations in their [conservative form](@entry_id:747710). For computational convenience, it is often advantageous to first non-dimensionalize these equations, expressing them in terms of reference scales and [dimensionless parameters](@entry_id:180651) such as the Mach number, $\mathrm{Ma}$ . In a domain $\Omega$, partitioned into a set of non-overlapping elements $\{K\}$, the conservation law is written as:
$$
\partial_t \boldsymbol{U} + \nabla \cdot \boldsymbol{F}(\boldsymbol{U}) = \boldsymbol{0}
$$
where $\boldsymbol{U}$ is the vector of [conserved variables](@entry_id:747720) (density, momentum, total energy) and $\boldsymbol{F}(\boldsymbol{U})$ is the corresponding flux tensor.

Within a single element $K$, we seek an approximate solution $\boldsymbol{U}_h$ that belongs to a finite-dimensional space of functions, typically polynomials of degree $p$, denoted $\mathcal{P}_p(K)$. The [weak form](@entry_id:137295) is obtained by multiplying the PDE by a test function $\boldsymbol{v}_h$ from the same [polynomial space](@entry_id:269905) and integrating over the element $K$:
$$
\int_K (\partial_t \boldsymbol{U}_h) \cdot \boldsymbol{v}_h \, d\boldsymbol{x} + \int_K (\nabla \cdot \boldsymbol{F}(\boldsymbol{U}_h)) \cdot \boldsymbol{v}_h \, d\boldsymbol{x} = \boldsymbol{0}
$$

Applying the [divergence theorem](@entry_id:145271) ([integration by parts](@entry_id:136350)) to the flux term separates the contributions from the element's interior and its boundary $\partial K$:
$$
\int_K (\partial_t \boldsymbol{U}_h) \cdot \boldsymbol{v}_h \, d\boldsymbol{x} - \int_K \boldsymbol{F}(\boldsymbol{U}_h) : \nabla \boldsymbol{v}_h \, d\boldsymbol{x} + \oint_{\partial K} (\boldsymbol{F}(\boldsymbol{U}_h) \cdot \boldsymbol{n}) \cdot \boldsymbol{v}_h \, dS = \boldsymbol{0}
$$
Here, $\boldsymbol{n}$ is the outward-pointing [unit normal vector](@entry_id:178851) on the boundary $\partial K$.

A defining feature of DG methods is that the approximate solution $\boldsymbol{U}_h$ is discontinuous across element boundaries. Consequently, the trace of the solution at an interface is two-valued. We denote the interior trace (from within element $K$) as $\boldsymbol{U}_h^-$ and the exterior trace (from the neighboring element) as $\boldsymbol{U}_h^+$. The physical flux $\boldsymbol{F}(\boldsymbol{U}_h) \cdot \boldsymbol{n}$ is no longer uniquely defined at the interface and must be replaced by a **[numerical flux](@entry_id:145174)**, denoted $\widehat{\boldsymbol{F}}(\boldsymbol{U}_h^-, \boldsymbol{U}_h^+, \boldsymbol{n})$. This numerical flux function is the sole mechanism for communication between elements and is responsible for defining the [upwinding](@entry_id:756372) and dissipation necessary for stability. The final elemental weak form is:
$$
\int_K (\partial_t \boldsymbol{U}_h) \cdot \boldsymbol{v}_h \, d\boldsymbol{x} - \int_K \boldsymbol{F}(\boldsymbol{U}_h) : \nabla \boldsymbol{v}_h \, d\boldsymbol{x} + \oint_{\partial K} \widehat{\boldsymbol{F}}(\boldsymbol{U}_h^-, \boldsymbol{U}_h^+, \boldsymbol{n}) \cdot \boldsymbol{v}_h \, dS = \boldsymbol{0}
$$

A critical property of any scheme for conservation laws is that it must be conservative at the discrete level. For DG methods, this is achieved by careful design of the numerical flux. If we sum the weak form over all elements in the mesh (using a constant [test function](@entry_id:178872) $\boldsymbol{v}_h \equiv 1$), the [volume integrals](@entry_id:183482) of the flux divergence telescope and cancel out. Global conservation then requires that the sum of all interior face contributions also vanishes. This is guaranteed if the [numerical flux](@entry_id:145174) is **single-valued** and satisfies an **orientation-[antisymmetry](@entry_id:261893)** condition on any interior face:
$$
\widehat{\boldsymbol{F}}(\boldsymbol{U}^-, \boldsymbol{U}^+, \boldsymbol{n}) = - \widehat{\boldsymbol{F}}(\boldsymbol{U}^+, \boldsymbol{U}^-, -\boldsymbol{n})
$$
This ensures that the flux computed by one element is the exact negative of the flux computed by its neighbor on their shared face, leading to perfect cancellation in the global sum . All standard upwind fluxes are designed to satisfy this property.

### Spatial Discretization: Bases, Quadrature, and Mass Matrices

The choice of basis functions for the [polynomial space](@entry_id:269905) $\mathcal{P}_p(K)$ has profound implications for the structure and efficiency of the resulting DG scheme. Two primary families of bases are used.

**Modal bases** employ a set of [orthogonal polynomials](@entry_id:146918), such as the Legendre polynomials on a reference interval $[-1,1]$. If we choose our basis functions $\{\phi_n\}_{n=0}^p$ to be the Legendre polynomials, their [orthogonality property](@entry_id:268007),
$$
\int_{-1}^{1} \phi_i(x) \phi_j(x) \, dx = \frac{2}{2i+1} \delta_{ij}
$$
ensures that the **[mass matrix](@entry_id:177093)**, $\boldsymbol{M}$, with entries $M_{ij} = \int_K \phi_i \phi_j \, d\boldsymbol{x}$, is diagonal when integrals are computed exactly .

**Nodal bases** are constructed using Lagrange interpolation polynomials $\{\ell_i\}_{i=0}^p$ associated with a set of $p+1$ distinct nodes $\{x_i\}$ within the element. These bases are defined by the property $\ell_i(x_j) = \delta_{ij}$. While intuitive, using a nodal basis with exact integration typically results in a dense, fully-coupled mass matrix, which is computationally expensive to invert.

A more computationally attractive approach emerges when we combine a nodal basis with **numerical quadrature**. Specifically, if we choose the interpolation nodes for the Lagrange basis to be the same as the nodes of a quadrature rule—a technique known as **collocation**—we can achieve a [diagonal mass matrix](@entry_id:173002). For instance, using Legendre-Gauss-Lobatto (LGL) quadrature nodes and weights $\{x_q, w_q\}_{q=0}^p$, the mass matrix entries are approximated as:
$$
M_{ij} = \int_{-1}^{1} \ell_i(x) \ell_j(x) \, dx \approx \sum_{q=0}^{p} w_q \ell_i(x_q) \ell_j(x_q) = \sum_{q=0}^{p} w_q \delta_{iq} \delta_{jq} = w_i \delta_{ij}
$$
This yields a diagonal, or **lumped**, [mass matrix](@entry_id:177093) whose entries are simply the [quadrature weights](@entry_id:753910) . This "[mass lumping](@entry_id:175432)" is a key advantage, as the inversion of the mass matrix, required at every time step in an explicit scheme, becomes a trivial element-wise division. For a degree $p=3$ approximation on $[-1,1]$, the diagonal entries of the modal mass matrix are $(2, 2/3, 2/5, 2/7)$, whereas the diagonal entries of the nodal [mass matrix](@entry_id:177093) (the LGL weights) are $(1/6, 5/6, 5/6, 1/6)$ .

This combination of a nodal basis collocated at quadrature points forms the basis of the **Discontinuous Galerkin Spectral Element Method (DGSEM)**. In this formulation, the volume integral term $\int_K \boldsymbol{F}(\boldsymbol{U}_h) : \nabla \boldsymbol{v}_h \, d\boldsymbol{x}$ also simplifies. By choosing [test functions](@entry_id:166589) $\boldsymbol{v}_h = \ell_i$ and applying the LGL quadrature, the integral is approximated by a sum over the nodes. This reveals that the discrete operator can be expressed in terms of a **[differentiation matrix](@entry_id:149870)**, $\boldsymbol{D}$, acting on the vector of flux values at the nodes . The entries of this matrix are given by the derivatives of the basis functions evaluated at the nodes, $D_{ij} = \ell'_j(\xi_i)$, and have known analytic forms. This transforms the weak-form integral into an efficient matrix-vector product, highlighting the connection between DG and [spectral collocation methods](@entry_id:755162).

### Isoparametric Mappings and Contravariant Fluxes

To apply DG methods to domains with complex, curved geometries, we map each physical element $K$ from a simple **reference element** $\hat{K}$ (e.g., a square or triangle in 2D) using an **[isoparametric mapping](@entry_id:173239)** $\boldsymbol{x}(\boldsymbol{\xi})$, where $\boldsymbol{\xi}$ are the coordinates in the reference element. This transformation introduces geometric factors into the governing equations.

By applying the [chain rule](@entry_id:147422) for derivatives and multiplying by the Jacobian determinant of the mapping, $J$, the conservation law on the physical element is transformed into an equivalent conservation law on the [reference element](@entry_id:168425). This new equation involves **contravariant fluxes**, which are combinations of the physical fluxes and the metric terms of the mapping. For a 2D mapping $(x(\xi, \eta), y(\xi, \eta))$, the transformed equation takes the form :
$$
\frac{\partial}{\partial t}\left(J \boldsymbol{U}\right) + \frac{\partial \hat{\boldsymbol{F}}^\xi}{\partial \xi} + \frac{\partial \hat{\boldsymbol{F}}^\eta}{\partial \eta} = 0
$$
where the contravariant fluxes are given by:
$$
\hat{\boldsymbol{F}}^\xi = y_{\eta} \boldsymbol{F}(\boldsymbol{U}) - x_{\eta} \boldsymbol{G}(\boldsymbol{U}) \quad \text{and} \quad \hat{\boldsymbol{F}}^\eta = -y_{\xi} \boldsymbol{F}(\boldsymbol{U}) + x_{\xi} \boldsymbol{G}(\boldsymbol{U})
$$
Here, $\boldsymbol{F}$ and $\boldsymbol{G}$ are the physical flux vectors in the $x$ and $y$ directions, respectively, and terms like $x_\xi$ denote partial derivatives of the mapping, e.g., $\partial x / \partial \xi$. All computations are then performed efficiently on the fixed reference element, with the geometric complexity encapsulated within these contravariant fluxes.

In a full DG discretization, the semi-discrete equation for the vector of nodal unknowns $\boldsymbol{U}_h$ on an element takes the form $\boldsymbol{M} \frac{d\boldsymbol{U}_h}{dt} = \boldsymbol{R}(\boldsymbol{U}_h)$, where $\boldsymbol{M}$ is the [mass matrix](@entry_id:177093) and $\boldsymbol{R}$ is the residual. The residual includes contributions from the [volume integrals](@entry_id:183482) and the [surface integrals](@entry_id:144805). The surface contribution can be written using a **lift operator**, $\boldsymbol{L}$, which maps the jump in the [numerical flux](@entry_id:145174) at the faces to a polynomial contribution in the volume. This operator is defined as $\boldsymbol{L} = \boldsymbol{M}^{-1}\boldsymbol{R}_{\text{face}}$, where $\boldsymbol{R}_{\text{face}}$ is the matrix resulting from the face integrals . For a nodal DG scheme with a [diagonal mass matrix](@entry_id:173002), its inverse $\boldsymbol{M}^{-1}$ is trivial to compute, making the lift operator highly efficient.

### The Crucial Role of the Numerical Flux

The choice of numerical flux $\widehat{\boldsymbol{F}}$ is paramount, as it governs the stability and accuracy of the entire DG scheme. It must resolve the Riemann problem at each interface, at least approximately. Several options exist, each with a different trade-off between accuracy (dissipation) and robustness.

Consider the classic shock tube problem, whose solution contains a shock, a [rarefaction](@entry_id:201884), and a [contact discontinuity](@entry_id:194702) . The behavior of a numerical flux on the **[contact discontinuity](@entry_id:194702)**—a linearly degenerate wave across which density jumps but pressure and velocity are continuous—is a key indicator of its performance.

- **Local Lax-Friedrichs (LLF) Flux:** Also known as the Rusanov flux, this is the simplest and most robust option. It adds a scalar dissipation proportional to the maximum local [wave speed](@entry_id:186208) ($|u|+c$). While robust, it applies this large amount of damping to all wave families equally. This leads to significant smearing of the [contact discontinuity](@entry_id:194702), which travels at the much slower speed $u$. For [high-order methods](@entry_id:165413), this excessive dissipation can severely degrade accuracy.

- **Roe's Flux:** This is a characteristic-based flux that provides dissipation tailored to each wave family, proportional to the [wave speed](@entry_id:186208). It is designed to exactly resolve isolated [contact discontinuities](@entry_id:747781) with minimal dissipation. While this offers superior accuracy for resolving such features, the underlying linearization can fail for strong shocks or rarefactions, leading to non-physical solutions (e.g., negative pressures) and a lack of robustness. This fragility makes it a risky choice for complex problems.

- **HLLC Flux (Harten-Lax-van Leer with Contact):** This flux represents an excellent compromise. It extends the robust HLL two-wave model to a three-wave model that explicitly accounts for the contact wave. By doing so, it restores the contact wave structure with very low dissipation, similar to Roe's flux, but without the need for a full [characteristic decomposition](@entry_id:747276). This makes it significantly more robust than Roe's flux while retaining high accuracy. For these reasons, the HLLC flux is often the preferred choice for high-order DG simulations of the compressible Euler equations .

### Stability, Positivity, and Accuracy

Beyond the choice of numerical flux, several other mechanisms are critical for a stable and accurate DG scheme.

**Aliasing Instability:** The Euler equations are nonlinear. When a polynomial solution $\boldsymbol{U}_h$ of degree $p$ is substituted into the flux function $\boldsymbol{F}(\boldsymbol{U}_h)$, the result is a polynomial of a higher degree. For instance, the [momentum flux](@entry_id:199796) $\rho u^2$ becomes a polynomial of degree up to $2p$. If the [volume integrals](@entry_id:183482) are evaluated with a quadrature rule that is not exact for this higher-degree polynomial (**under-integration**), a phenomenon called **aliasing** occurs. High-frequency modes of the integrand, which should integrate to zero, are instead "aliased" as low-frequency modes by the quadrature rule, leading to a spurious source of energy that can drive the simulation unstable. This can be demonstrated with a simple scalar model $u_t + \partial_x(u^2/2)=0$; under-integration can lead to a non-zero rate of change of discrete energy, $\frac{dE_h}{dt} \neq 0$, even when it should be conserved . To prevent this, DG schemes for nonlinear problems often use "over-integration"—a quadrature rule exact for the degree of the flux-test function product.

**Positivity Preservation:** The physical state described by the Euler equations requires positive density ($\rho > 0$) and pressure ($p > 0$). High-order polynomial approximations can oscillate, especially near sharp gradients, and may produce non-physical negative values. To prevent this, DG schemes can be equipped with **[positivity-preserving limiters](@entry_id:753610)**. A common approach, such as the limiter by Zhang and Shu, works by scaling the nodal values of the solution towards the element's average state if any nodal value is found to be non-physical. This procedure is guaranteed to succeed provided the element-average state itself remains physical. Ensuring the positivity of the cell average requires coupling this [limiter](@entry_id:751283) with a **Strong Stability Preserving (SSP)** [time integration](@entry_id:170891) scheme and a sufficiently strict Courant-Friedrichs-Lewy (CFL) condition on the time step $\Delta t$ .

**A Priori Error Estimates:** For smooth solutions, the accuracy of the DG method can be rigorously analyzed. A central requirement for accuracy is that the [numerical flux](@entry_id:145174) must be **consistent**, meaning it reduces to the physical flux when its arguments are identical: $\widehat{\boldsymbol{F}}(W,W,n) = \boldsymbol{F}(W)\cdot n$. This ensures the scheme is approximating the correct PDE. Under assumptions of solution smoothness and mesh regularity, a standard DG scheme using a polynomial basis of degree $p$ achieves a convergence rate in the $L^2$-norm of $O(h^{p+1/2})$. The optimal rate for a degree-$p$ approximation is $O(h^{p+1})$. The half-order loss of accuracy is a characteristic feature of standard DG analysis for hyperbolic problems and arises from the terms used to control the jumps in the solution at element interfaces, which are bounded using trace inequalities . A typical proof strategy involves splitting the error, testing the error equation, and using Grönwall's inequality to bound the error growth in time .