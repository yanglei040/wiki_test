{
    "hands_on_practices": [
        {
            "introduction": "要实现一个模态间断伽辽金（DG）方法，我们必须将连续的弱形式方程转化为一个涉及矩阵的常微分方程（ODE）系统。本练习的核心在于计算“类刚度”微分矩阵，它源于弱形式中的体积积分项。通过亲手进行这一计算，您将具体地理解基函数（如勒让德多项式）的性质如何直接决定DG格式中核心算子的结构。",
            "id": "3378346",
            "problem": "考虑用于求解形式为 $u_{t} + f(u)_{x} = 0$ 的标量守恒律的半离散间断伽辽金（DG）方法，例如常数 $a$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$ 或无粘伯格斯方程 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$。在每个单元上，映射到参考坐标 $\\xi \\in [-1,1]$ 后，采用模态谱近似，在勒让德多项式基 $\\{\\phi_{k}(\\xi)\\}_{k=0}^{p}$ 中展开解，其中 $\\phi_{k}$ 表示 $k$ 次勒让德多项式。对于标准勒让德基，其各项由\n$$\nD_{kl} = \\int_{-1}^{1} \\phi_{k}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n定义的类刚度微分矩阵 $D$ 源于弱形式，并且是构造用于通量导数的DG算子的核心。\n\n利用勒让德多项式的基本性质——在 $[-1,1]$ 上的正交性、奇偶性、端点值 $\\phi_{n}(1) = 1$ 和 $\\phi_{n}(-1) = (-1)^{n}$，以及 $\\phi_{k}$ 是一个 $k$ 次多项式这一事实——计算多项式次数 $p = 2$ 时矩阵 $D$ 的所有元素。使用标准的（未归一化的）勒让德多项式 $\\phi_{0}(\\xi) = 1$，$\\phi_{1}(\\xi) = \\xi$ 和 $\\phi_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2} - 1\\right)$。将最终结果表示为一个封闭形式的 $3 \\times 3$ 矩阵。无需四舍五入，且不涉及物理单位。用完整的矩阵作为单一解析表达式来回答。",
            "solution": "该问题是有效的。这是一个适定的数学问题，其基础是谱方法和间断伽辽金方法的成熟理论。所有必需信息均已提供，且目标清晰明确。\n\n任务是计算多项式次数为 $p=2$ 的基下的类刚度微分矩阵 $D$。该矩阵的元素 $D_{kl}$ 由以下积分定义：\n$$\nD_{kl} = \\int_{-1}^{1} \\phi_{k}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n其中 $k, l \\in \\{0, 1, 2\\}$，且 $\\{\\phi_k\\}$ 是参考区间 $\\xi \\in [-1, 1]$ 上的标准勒让德多项式基。问题给出了 $p=2$ 时的具体基函数：\n$$\n\\phi_{0}(\\xi) = 1 \\\\\n\\phi_{1}(\\xi) = \\xi \\\\\n\\phi_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2} - 1\\right)\n$$\n首先，我们计算这些基函数关于 $\\xi$ 的导数：\n$$\n\\phi_{0}'(\\xi) = \\frac{d}{d\\xi}(1) = 0 \\\\\n\\phi_{1}'(\\xi) = \\frac{d}{d\\xi}(\\xi) = 1 \\\\\n\\phi_{2}'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(3\\xi^{2} - 1)\\right) = \\frac{1}{2}(6\\xi) = 3\\xi\n$$\n我们可以观察到，这些导数可以用基函数本身来表示：\n$$\n\\phi_{1}'(\\xi) = 1 = \\phi_{0}(\\xi) \\\\\n\\phi_{2}'(\\xi) = 3\\xi = 3\\phi_{1}(\\xi)\n$$\n现在我们通过对每一对 $(k, l)$ 系统地计算积分，来计算 $3 \\times 3$ 矩阵 $D$ 的9个元素。我们将利用勒让德多项式的基本正交性质：\n$$\n\\int_{-1}^{1} \\phi_{m}(\\xi)\\,\\phi_{n}(\\xi)\\,d\\xi = 0 \\quad \\text{对于 } m \\neq n\n$$\n\n**第1行：$k=0$**\n对于这一行，导数为 $\\phi_{0}'(\\xi) = 0$。\n$$\nD_{0l} = \\int_{-1}^{1} \\phi_{0}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} 0 \\cdot \\phi_{l}(\\xi)\\,d\\xi = 0 \\quad \\text{对于 } l \\in \\{0, 1, 2\\}\n$$\n因此，矩阵 $D$ 的第一行完全为零：$D_{00} = 0$，$D_{01} = 0$，$D_{02} = 0$。\n\n**第2行：$k=1$**\n对于这一行，导数为 $\\phi_{1}'(\\xi) = 1 = \\phi_{0}(\\xi)$。\n$$\nD_{1l} = \\int_{-1}^{1} \\phi_{1}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n- 对于 $l=0$：\n$$\nD_{10} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{0}(\\xi)\\,d\\xi = \\int_{-1}^{1} (1)(1)\\,d\\xi = \\int_{-1}^{1} 1\\,d\\xi = [\\xi]_{-1}^{1} = 1 - (-1) = 2\n$$\n- 对于 $l=1$：\n$$\nD_{11} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{1}(\\xi)\\,d\\xi = 0 \\quad \\text{（根据正交性，因为 } 0 \\neq 1)\n$$\n- 对于 $l=2$：\n$$\nD_{12} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{2}(\\xi)\\,d\\xi = 0 \\quad \\text{（根据正交性，因为 } 0 \\neq 2)\n$$\n矩阵 $D$ 的第二行为 $[2, 0, 0]$。\n\n**第3行：$k=2$**\n对于这一行，导数为 $\\phi_{2}'(\\xi) = 3\\xi = 3\\phi_{1}(\\xi)$。\n$$\nD_{2l} = \\int_{-1}^{1} \\phi_{2}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} 3\\phi_{1}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n- 对于 $l=0$：\n$$\nD_{20} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{0}(\\xi)\\,d\\xi = 0 \\quad \\text{（根据正交性，因为 } 1 \\neq 0)\n$$\n- 对于 $l=1$：\n$$\nD_{21} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{1}(\\xi)\\,d\\xi = 3 \\int_{-1}^{1} \\xi^{2}\\,d\\xi = 3 \\left[\\frac{\\xi^{3}}{3}\\right]_{-1}^{1} = 3 \\left(\\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3}\\right) = 3 \\left(\\frac{1}{3} - \\left(-\\frac{1}{3}\\right)\\right) = 3 \\left(\\frac{2}{3}\\right) = 2\n$$\n- 对于 $l=2$：\n$$\nD_{22} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{2}(\\xi)\\,d\\xi = 0 \\quad \\text{（根据正交性，因为 } 1 \\neq 2)\n$$\n矩阵 $D$ 的第三行为 $[0, 2, 0]$。\n\n综合这些结果，我们构造矩阵 $D$：\n$$\nD = \\begin{pmatrix} D_{00}  D_{01}  D_{02} \\\\ D_{10}  D_{11}  D_{12} \\\\ D_{20}  D_{21}  D_{22} \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 2  0  0 \\\\ 0  2  0 \\end{pmatrix}\n$$\n这个结果与未归一化勒让德基的一般性质相符，即如果 $l",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0 \\\\ 2  0  0 \\\\ 0  2  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "DG方法可以有多种在数学上等价的表达形式，例如“强形式”和“弱形式”。然而，当使用数值求积（quadrature）进行积分时，这种等价性可能会被打破。本练习探讨了积分不精确性如何影响这些不同离散格式的守恒性质，这一现象与所谓的“混淆误差”（aliasing error）有关。",
            "id": "3378342",
            "problem": "考虑参考区间 $[-1,1]$ 上的一维线性平流方程\n$$\nu_{t} + s\\,u_{x} = 0,\n$$\n其平流速度为常数 $s0$，采用多项式次数为 $N$ 的单单元模态间断伽辽金（DG）方法进行离散，并使用勒让德多项式作为试探和检验空间。半离散的 DG 格式定义为：用 $v \\in \\mathbb{P}_{N}$ 进行检验，并在单元边界上逐点选择数值通量。单元上的 DG 强形式定义为\n$$\n\\int_{-1}^{1} v\\,u_{t}\\,dx + \\int_{-1}^{1} v\\,s\\,u_{x}\\,dx - v^{-} \\widehat{f}\\big|_{x=-1} + v^{+} \\widehat{f}\\big|_{x=1} = 0,\n$$\n单元上的 DG 弱形式定义为\n$$\n\\int_{-1}^{1} v\\,u_{t}\\,dx - \\int_{-1}^{1} v_{x}\\,s\\,u\\,dx + v^{-} \\widehat{f}\\big|_{x=-1} - v^{+} \\widehat{f}\\big|_{x=1} = 0,\n$$\n其中 $\\widehat{f}$ 是物理通量 $f=s\\,u$ 的一个相容的数值通量，上标 $-$ 和 $+$ 分别表示单元左边界和右边界上的值。假设采用中心数值通量 $\\widehat{f}=\\frac{1}{2}\\big(f^{-}+f^{+}\\big)$，并考虑通过用 $v=u$ 进行检验以及使用基于求积的内积来测量能量，从而计算出的瞬时能量变化率\n$$\nE_{Q}(t) := \\frac{1}{2}\\,(u,u)_{Q}, \\qquad (w,z)_{Q} := \\sum_{q=1}^{Q} w_{q}\\,w(x_{q})\\,z(x_{q}).\n$$\n\n你将需要评估在对体积项故意进行欠积分（使用 $Q=2$ 点的高斯-勒让德求积，节点为 $x_{1}=-1/\\sqrt{3}$，$x_{2}=+1/\\sqrt{3}$，权重为 $w_{1}=w_{2}=1$）的情况下，从强形式和弱形式的 DG 格式中得到的两个能量变化率 $E'_{\\text{strong}}(0)$ 和 $E'_{\\text{weak}}(0)$。假设多项式次数 $N=3$ 的近似，其初始 DG 场为\n$$\nu_{h}(x,0) = (x^{2}-1)(x+1),\n$$\n该场满足 $u_{h}(-1,0)=u_{h}(1,0)=0$，因此在 $t=0$ 时，对于中心通量，强形式和弱形式的瞬时边界贡献均为零。\n\n从上述守恒律和 DG 原理出发，并且对所有体积内积仅使用指定的求积法则，推导并计算在 $t=0$ 时强形式和弱形式能量变化率之间的瞬时差值，\n$$\n\\Delta := E'_{\\text{strong}}(0) - E'_{\\text{weak}}(0),\n$$\n以单一精确实数表示。在你的计算中，取 $s=1$。请以精确值的形式提供最终答案。如果在计算过程中得到近似小数，请不要四舍五入；而应在报告最终结果前将其简化为有理数或封闭形式的表达式。答案无需物理单位。",
            "solution": "用户希望找出在线性平流方程的强形式和弱形式间断伽辽金（DG）格式下，在特定的欠积分条件下，产生的瞬时能量变化率之差 $\\Delta := E'_{\\text{strong}}(0) - E'_{\\text{weak}}(0)$。\n\n首先，我们建立能量变化率的表达式。能量使用基于求积的内积定义为 $E_{Q}(t) := \\frac{1}{2}\\,(u,u)_{Q}$。能量的变化率为：\n$$\nE'_{Q}(t) = \\frac{d}{dt} \\left( \\frac{1}{2} (u,u)_{Q} \\right) = \\frac{1}{2} \\left( (\\frac{du}{dt}, u)_{Q} + (u, \\frac{du}{dt})_{Q} \\right)\n$$\n由于求积内积 $(w,z)_{Q} := \\sum_{q=1}^{Q} w_{q}\\,w(x_{q})\\,z(x_{q})$ 是对称的，这可以简化为：\n$$\nE'_{Q}(t) = (u_t, u)_{Q}\n$$\n我们需要对强形式和弱形式的 DG 格式，在 $t=0$ 时计算这个表达式的值。这需要从每种形式中找到 $(u_t, u)_{Q}$ 的表达式。\n\n我们先分析强形式。使用指定的求积法则对体积积分进行计算，半离散的强形式为：\n$$\n(v, u_t)_{Q} + s(v, u_x)_{Q} - v(-1) \\widehat{f}(-1) + v(1) \\widehat{f}(1) = 0\n$$\n为计算能量变化率，我们将检验函数 $v$ 设为解 $u$：\n$$\n(u, u_t)_{Q} + s(u, u_x)_{Q} - u(-1) \\widehat{f}(-1) + u(1) \\widehat{f}(1) = 0\n$$\n这给出了强形式的能量变化率：\n$$\nE'_{\\text{strong}}(t) = (u, u_t)_{Q} = -s(u, u_x)_{Q} + u(-1) \\widehat{f}(-1) - u(1) \\widehat{f}(1)\n$$\n问题指定了初始 DG 场 $u_h(x,0) = (x^2-1)(x+1)$。在单元边界 $x=-1$ 和 $x=1$ 处：\n$u_h(-1,0) = ((-1)^2-1)(-1+1) = 0$\n$u_h(1,0) = ((1)^2-1)(1+1) = 0$\n因此，在 $t=0$ 时，边界项为零：\n$$\nE'_{\\text{strong}}(0) = -s(u_h(x,0), u_{h,x}(x,0))_{Q}\n$$\n\n接下来，我们分析弱形式。使用求积法则的半离散弱形式为：\n$$\n(v, u_t)_{Q} - s(v_x, u)_{Q} + v(-1) \\widehat{f}(-1) - v(1) \\widehat{f}(1) = 0\n$$\n设 $v=u$：\n$$\n(u, u_t)_{Q} - s(u_x, u)_{Q} + u(-1) \\widehat{f}(-1) - u(1) \\widehat{f}(1) = 0\n$$\n这给出了弱形式的能量变化率：\n$$\nE'_{\\text{weak}}(t) = (u, u_t)_{Q} = s(u_x, u)_{Q} - u(-1) \\widehat{f}(-1) + u(1) \\widehat{f}(1)\n$$\n同样地，因为 $u_h(-1,0)=u_h(1,0)=0$，在 $t=0$ 时边界项为零。\n$$\nE'_{\\text{weak}}(0) = s(u_{h,x}(x,0), u_h(x,0))_{Q}\n$$\n由于求积内积的对称性，$(u_x, u)_Q = (u, u_x)_Q$。因此：\n$$\nE'_{\\text{weak}}(0) = s(u_h(x,0), u_{h,x}(x,0))_{Q}\n$$\n\n现在我们可以计算差值 $\\Delta$：\n$$\n\\Delta = E'_{\\text{strong}}(0) - E'_{\\text{weak}}(0) = -s(u_h, u_{h,x})_{Q} - s(u_h, u_{h,x})_{Q} = -2s(u_h, u_{h,x})_{Q}\n$$\n问题指定了常数平流速度 $s=1$。任务简化为在 $t=0$ 时计算内积 $(u_h, u_{h,x})_{Q}$。\n问题指定了一个 $Q=2$ 点的高斯-勒让德求积法则。节点为 $x_1 = -1/\\sqrt{3}$，$x_2 = +1/\\sqrt{3}$，权重为 $w_1=w_2=1$。内积为：\n$$\n(w,z)_{Q} = \\sum_{q=1}^{2} w_q w(x_q) z(x_q) = w(x_1)z(x_1) + w(x_2)z(x_2)\n$$\n所以我们需要计算：\n$$\n\\Delta = -2 \\left[ u_h(x_1, 0) u_{h,x}(x_1, 0) + u_h(x_2, 0) u_{h,x}(x_2, 0) \\right]\n$$\n初始条件是 $u_h(x,0) = (x^2-1)(x+1) = x^3 + x^2 - x - 1$。其导数为 $u_{h,x}(x,0) = 3x^2 + 2x - 1$。\n\n让我们在求积节点上计算这些多项式的值。设 $x = \\pm 1/\\sqrt{3}$，所以 $x^2=1/3$。\n\n在第一个节点 $x_1 = -1/\\sqrt{3}$ 处：\n$$\nu_h(x_1, 0) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(-\\frac{1}{\\sqrt{3}}\\right)^2 - \\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{3} + \\frac{1}{\\sqrt{3}} - 1 = \\frac{2}{3\\sqrt{3}} - \\frac{2}{3} = \\frac{2-2\\sqrt{3}}{3\\sqrt{3}}\n$$\n$$\nu_{h,x}(x_1, 0) = 3\\left(-\\frac{1}{\\sqrt{3}}\\right)^2 + 2\\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = 3\\left(\\frac{1}{3}\\right) - \\frac{2}{\\sqrt{3}} - 1 = 1 - \\frac{2}{\\sqrt{3}} - 1 = -\\frac{2}{\\sqrt{3}}\n$$\n$x_1$ 处的乘积是：\n$$\nu_h(x_1, 0)u_{h,x}(x_1, 0) = \\left(\\frac{2-2\\sqrt{3}}{3\\sqrt{3}}\\right) \\left(-\\frac{2}{\\sqrt{3}}\\right) = \\frac{-4+4\\sqrt{3}}{3 \\cdot 3} = \\frac{-4+4\\sqrt{3}}{9}\n$$\n\n在第二个节点 $x_2 = 1/\\sqrt{3}$ 处：\n$$\nu_h(x_2, 0) = \\left(\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(\\frac{1}{\\sqrt{3}}\\right)^2 - \\frac{1}{\\sqrt{3}} - 1 = \\frac{1}{3\\sqrt{3}} + \\frac{1}{3} - \\frac{1}{\\sqrt{3}} - 1 = -\\frac{2}{3\\sqrt{3}} - \\frac{2}{3} = \\frac{-2-2\\sqrt{3}}{3\\sqrt{3}}\n$$\n$$\nu_{h,x}(x_2, 0) = 3\\left(\\frac{1}{\\sqrt{3}}\\right)^2 + 2\\left(\\frac{1}{\\sqrt{3}}\\right) - 1 = 3\\left(\\frac{1}{3}\\right) + \\frac{2}{\\sqrt{3}} - 1 = 1 + \\frac{2}{\\sqrt{3}} - 1 = \\frac{2}{\\sqrt{3}}\n$$\n$x_2$ 处的乘积是：\n$$\nu_h(x_2, 0)u_{h,x}(x_2, 0) = \\left(\\frac{-2-2\\sqrt{3}}{3\\sqrt{3}}\\right) \\left(\\frac{2}{\\sqrt{3}}\\right) = \\frac{-4-4\\sqrt{3}}{3 \\cdot 3} = \\frac{-4-4\\sqrt{3}}{9}\n$$\n\n现在，我们计算内积 $(u_h, u_{h,x})_{Q}$：\n$$\n(u_h, u_{h,x})_{Q} = \\left(\\frac{-4+4\\sqrt{3}}{9}\\right) + \\left(\\frac{-4-4\\sqrt{3}}{9}\\right) = \\frac{-4+4\\sqrt{3}-4-4\\sqrt{3}}{9} = -\\frac{8}{9}\n$$\n\n最后，我们计算 $\\Delta$：\n$$\n\\Delta = -2s(u_h, u_{h,x})_{Q} = -2(1)\\left(-\\frac{8}{9}\\right) = \\frac{16}{9}\n$$\n能量变化率的差异是由于使用了一个对于被积函数 $u_h u_{h,x}$（一个5次多项式）不精确的求积法则所引入的混叠误差的直接结果。$2$ 点高斯-勒让德法则仅对次数最高为 $2(2)-1=3$ 的多项式是精确的。",
            "answer": "$$\n\\boxed{\\frac{16}{9}}\n$$"
        },
        {
            "introduction": "虽然线性问题中的混淆误差可能仅导致精度损失，但在像伯格斯方程（Burgers' equation）这样的非线性问题中，它们可能引发灾难性的不稳定。本练习从离散熵守恒的角度审视了这一现象。我们将计算伯格斯方程的节点DG格式中伪熵（能量）的产生率，并将其与非线性混淆引起的解的不同模式间的相互作用直接联系起来。",
            "id": "3378396",
            "problem": "考虑一维无粘 Burgers 方程 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$，该方程定义在一个周期性区间上。使用不连续伽辽金 (DG) 方法，在单个参考单元 $x \\in [-1,1]$ 上以节点搭配形式对其进行离散化，多项式阶数为 $N=2$，并使用 Legendre–Gauss–Lobatto (LGL) 节点。使用中心数值通量并施加周期性识别，以便所有表面贡献项完全抵消。节点处的半离散强形式更新为\n$$\n\\frac{d \\boldsymbol{u}}{dt} = - \\boldsymbol{D}\\,\\boldsymbol{f}, \\qquad \\boldsymbol{f} = \\frac{1}{2}\\,\\boldsymbol{u}\\odot\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{u} = \\left[u(x_{1}),u(x_{2}),u(x_{3})\\right]^{T}$ 汇集了 LGL 节点 $x_{1}=-1$、$x_{2}=0$、$x_{3}=1$ 处的节点值，$\\odot$ 是逐分量乘积，$\\boldsymbol{D}$ 是 LGL 微分矩阵，其元素为 $\\left(D_{ij}\\right) = \\ell_{j}'(x_{i})$，其中 $\\{\\ell_{j}\\}$ 是阶数为 2 的 Lagrange 基。相应的对角求积权重矩阵是 $\\boldsymbol{W}=\\mathrm{diag}(w_{1},w_{2},w_{3})$，其中 $w_{1}=\\frac{1}{3}$、$w_{2}=\\frac{4}{3}$、$w_{3}=\\frac{1}{3}$。对于阶数 $N=2$，矩阵为\n$$\n\\boldsymbol{D}=\\begin{pmatrix}\n-\\frac{3}{2}  2  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  0  \\frac{1}{2} \\\\\n\\frac{1}{2}  -2  \\frac{3}{2}\n\\end{pmatrix}, \n\\qquad \n\\boldsymbol{W}=\\begin{pmatrix}\n\\frac{1}{3}  0  0\\\\\n0  \\frac{4}{3}  0\\\\\n0  0  \\frac{1}{3}\n\\end{pmatrix}.\n$$\n\n将离散二次熵（离散能量）定义为 $E(\\boldsymbol{u})=\\frac{1}{2}\\,\\boldsymbol{u}^{T}\\boldsymbol{W}\\,\\boldsymbol{u}$，这是对 $\\frac{1}{2}\\int_{-1}^{1} u^{2}\\,dx$ 的 LGL 求积近似。因为体积项是逐点计算的，并且求积仅对阶数不超过 3 的多项式是精确的，所以对于一般的 $u$，非线性体积积分是欠积分的，因此表现出混叠效应。\n\n假设 $t=0$ 时的多项式解是 Legendre 模态组合 $u(x,0)=a\\,P_{2}(x)+b\\,P_{1}(x)$，其中 $P_{1}(x)=x$，$P_{2}(x)=\\frac{1}{2}\\left(3x^{2}-1\\right)$，且 $a$ 和 $b$ 为实常数。仅使用上述数据和算子，计算由欠积分体积项在 $t=0$ 时产生的离散熵的半离散生成率 $\\,\\frac{dE}{dt}\\,$。将最终答案表示为关于 $a$ 和 $b$ 的封闭形式解析表达式。在推导过程中，简要指出导致符号不确定熵产生的奇偶 Legendre 模态耦合。\n\n最终答案必须是关于 $a$ 和 $b$ 的单个解析表达式（无单位）。不要四舍五入。",
            "solution": "用户要求我计算无粘 Burgers 方程的不连续伽辽金 (DG) 离散化的离散熵生成率。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件：**\n- **方程：** 周期区间上的 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$。\n- **离散化：** 在单个参考单元 $x \\in [-1,1]$ 上采用节点搭配形式的 DG 方法。\n- **多项式阶数：** $N=2$。\n- **节点：** Legendre–Gauss–Lobatto (LGL) 节点。对于 $N=2$，节点为 $x_{1}=-1$，$x_{2}=0$，$x_{3}=1$。\n- **数值通量：** 中心通量，通过周期性识别使表面项抵消。\n- **半离散形式：** $\\frac{d \\boldsymbol{u}}{dt} = - \\boldsymbol{D}\\,\\boldsymbol{f}$，其中 $\\boldsymbol{f} = \\frac{1}{2}\\,\\boldsymbol{u}\\odot\\boldsymbol{u}$。\n- **节点向量：** $\\boldsymbol{u} = \\left[u(x_{1}),u(x_{2}),u(x_{3})\\right]^{T}$。\n- **微分矩阵 ($N=2$ LGL):**\n    $$\n    \\boldsymbol{D}=\\begin{pmatrix}\n    -\\frac{3}{2}  2  -\\frac{1}{2} \\\\\n    -\\frac{1}{2}  0  \\frac{1}{2} \\\\\n    \\frac{1}{2}  -2  \\frac{3}{2}\n    \\end{pmatrix}\n    $$\n- **求积权重矩阵 ($N=2$ LGL):**\n    $$\n    \\boldsymbol{W}=\\begin{pmatrix}\n    \\frac{1}{3}  0  0\\\\\n    0  \\frac{4}{3}  0\\\\\n    0  0  \\frac{1}{3}\n    \\end{pmatrix}\n    $$\n- **离散熵（能量）：** $E(\\boldsymbol{u})=\\frac{1}{2}\\,\\boldsymbol{u}^{T}\\boldsymbol{W}\\,\\boldsymbol{u}$。\n- **初始条件：** $u(x,0)=a\\,P_{2}(x)+b\\,P_{1}(x)$，其中 $P_{1}(x)=x$ 且 $P_{2}(x)=\\frac{1}{2}\\left(3x^{2}-1\\right)$。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题使用了标准的无粘 Burgers 方程和一种成熟的数值方法（带 LGL 节点的节点 DG）。为 $N=2$ 提供的矩阵 $\\boldsymbol{D}$ 和 $\\boldsymbol{W}$ 对于 LGL 基是正确的。欠积分伽辽金方法中由混叠引起的熵产生是数值分析中的一个标准课题。\n- **良态性：** 该问题是基于给定定义的直接计算。所有必要的组成部分（方程、矩阵、初始条件）都已提供。任务是计算一个特定量 $\\frac{dE}{dt}$ 在 $t=0$ 时的值，该值由给定设置唯一确定。\n- **目标：** 该问题以精确的数学和数值分析术语陈述。没有主观或模糊的陈述。\n\n**1.3. 结论与行动：**\n该问题有效。它是偏微分方程数值方法领域内一个定义明确的计算。我将继续进行求解。\n\n### 步骤2：求解推导\n\n目标是计算离散熵的变化率 $\\frac{dE}{dt}$ 在时间 $t=0$ 时的值。离散熵由下式给出\n$$E(\\boldsymbol{u}) = \\frac{1}{2}\\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{u}$$\n\n我们首先使用链式法则求 $E(\\boldsymbol{u})$ 的时间导数：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2}\\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{u} \\right) = \\frac{1}{2} \\left( \\frac{d\\boldsymbol{u}^{T}}{dt}\\boldsymbol{W}\\boldsymbol{u} + \\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt} \\right)\n$$\n由于 $\\boldsymbol{W}$ 是一个对称矩阵（$\\boldsymbol{W}^{T}=\\boldsymbol{W}$），且项 $\\frac{d\\boldsymbol{u}^{T}}{dt}\\boldsymbol{W}\\boldsymbol{u}$ 是一个标量，我们有 $\\frac{d\\boldsymbol{u}^{T}}{dt}\\boldsymbol{W}\\boldsymbol{u} = \\left(\\boldsymbol{u}^{T}\\boldsymbol{W}^{T}\\frac{d\\boldsymbol{u}}{dt}\\right)^{T} = \\left(\\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt}\\right)^{T} = \\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt}$。\n因此，这两项相等，我们得到：\n$$\n\\frac{dE}{dt} = \\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt}\n$$\n现在，我们代入给定的半离散方程 $\\frac{d \\boldsymbol{u}}{dt} = - \\boldsymbol{D}\\,\\boldsymbol{f}$：\n$$\n\\frac{dE}{dt} = - \\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}\n$$\n通量向量 $\\boldsymbol{f}$ 定义为 $\\boldsymbol{f} = \\frac{1}{2}\\boldsymbol{u}\\odot\\boldsymbol{u}$，其中 $\\odot$ 表示逐元素乘积。\n$$\n\\frac{dE}{dt} = - \\frac{1}{2} \\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{D} (\\boldsymbol{u}\\odot\\boldsymbol{u})\n$$\n我们需要在 $t=0$ 时计算这个表达式。首先，我们从初始条件 $u(x,0)=a\\,P_{2}(x)+b\\,P_{1}(x)$ 在 LGL 节点 $x_{1}=-1$、$x_{2}=0$、$x_{3}=1$ 处计算节点值向量 $\\boldsymbol{u}_{0} = \\boldsymbol{u}(t=0)$。\n$$u(x,0) = a\\left(\\frac{1}{2}(3x^{2}-1)\\right) + b x$$\n在节点处：\n-   $u_{0,1} = u(-1,0) = a\\left(\\frac{1}{2}(3(-1)^{2}-1)\\right) + b(-1) = a\\left(\\frac{2}{2}\\right) - b = a - b$\n-   $u_{0,2} = u(0,0) = a\\left(\\frac{1}{2}(3(0)^{2}-1)\\right) + b(0) = -\\frac{a}{2}$\n-   $u_{0,3} = u(1,0) = a\\left(\\frac{1}{2}(3(1)^{2}-1)\\right) + b(1) = a\\left(\\frac{2}{2}\\right) + b = a + b$\n\n所以，初始节点向量为 $\\boldsymbol{u}_{0} = \\begin{pmatrix} a-b  -\\frac{a}{2}  a+b \\end{pmatrix}^{T}$。\n\n接下来，我们计算初始通量向量 $\\boldsymbol{f}_{0} = \\frac{1}{2}\\boldsymbol{u}_{0}\\odot\\boldsymbol{u}_{0}$：\n$$\n\\boldsymbol{f}_{0} = \\frac{1}{2} \\begin{pmatrix} (a-b)^{2} \\\\ (-\\frac{a}{2})^{2} \\\\ (a+b)^{2} \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} a^{2}-2ab+b^{2} \\\\ \\frac{a^{2}}{4} \\\\ a^{2}+2ab+b^{2} \\end{pmatrix}\n$$\n现在我们计算乘积 $\\boldsymbol{u}_{0}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0}$。让我们先计算乘积 $\\boldsymbol{W}\\boldsymbol{D}$：\n$$\n\\boldsymbol{W}\\boldsymbol{D} = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  \\frac{4}{3}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} -\\frac{3}{2}  2  -\\frac{1}{2} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\\\ \\frac{1}{2}  -2  \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{2}{3}  -\\frac{1}{6} \\\\ -\\frac{2}{3}  0  \\frac{2}{3} \\\\ \\frac{1}{6}  -\\frac{2}{3}  \\frac{1}{2} \\end{pmatrix}\n$$\n现在我们计算向量 $\\boldsymbol{v} = \\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0}$：\n$$\n\\boldsymbol{v} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{2}{3}  -\\frac{1}{6} \\\\ -\\frac{2}{3}  0  \\frac{2}{3} \\\\ \\frac{1}{6}  -\\frac{2}{3}  \\frac{1}{2} \\end{pmatrix} \\left( \\frac{1}{2} \\begin{pmatrix} a^{2}-2ab+b^{2} \\\\ \\frac{a^{2}}{4} \\\\ a^{2}+2ab+b^{2} \\end{pmatrix} \\right)\n$$\n让我们计算 $2\\boldsymbol{v}$：\n-   $(2\\boldsymbol{v})_{1} = -\\frac{1}{2}(a^{2}-2ab+b^{2}) + \\frac{2}{3}(\\frac{a^{2}}{4}) - \\frac{1}{6}(a^{2}+2ab+b^{2})$\n    $= a^{2}(-\\frac{1}{2}+\\frac{1}{6}-\\frac{1}{6}) + ab(1-\\frac{1}{3}) + b^{2}(-\\frac{1}{2}-\\frac{1}{6}) = -\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2}$\n-   $(2\\boldsymbol{v})_{2} = -\\frac{2}{3}(a^{2}-2ab+b^{2}) + 0 + \\frac{2}{3}(a^{2}+2ab+b^{2})$\n    $= \\frac{2}{3}[ (a^{2}+2ab+b^{2}) - (a^{2}-2ab+b^{2}) ] = \\frac{2}{3}(4ab) = \\frac{8}{3}ab$\n-   $(2\\boldsymbol{v})_{3} = \\frac{1}{6}(a^{2}-2ab+b^{2}) - \\frac{2}{3}(\\frac{a^{2}}{4}) + \\frac{1}{2}(a^{2}+2ab+b^{2})$\n    $= a^{2}(\\frac{1}{6}-\\frac{1}{6}+\\frac{1}{2}) + ab(-\\frac{1}{3}+1) + b^{2}(\\frac{1}{6}+\\frac{1}{2}) = \\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2}$\n\n所以，$\\boldsymbol{v} = \\frac{1}{2} \\begin{pmatrix} -\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2} \\\\ \\frac{8}{3}ab \\\\ \\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2} \\end{pmatrix}$。\n\n最后，我们计算点积 $\\boldsymbol{u}_{0}^{T} \\boldsymbol{v}$：\n$$\n\\boldsymbol{u}_{0}^{T}\\boldsymbol{v} = \\begin{pmatrix} a-b  -\\frac{a}{2}  a+b \\end{pmatrix} \\left( \\frac{1}{2} \\begin{pmatrix} -\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2} \\\\ \\frac{8}{3}ab \\\\ \\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2} \\end{pmatrix} \\right)\n$$\n令 $2(\\boldsymbol{u}_{0}^{T}\\boldsymbol{v}) = (a-b)(-\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2}) - \\frac{a}{2}(\\frac{8}{3}ab) + (a+b)(\\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2})$。\n我们可以将乘以 $a$ 和 $b$ 的项分组：\n$a \\left[ \\left(-\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2}\\right) + \\left(\\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2}\\right) \\right] = a\\left[\\frac{4}{3}ab\\right] = \\frac{4}{3}a^{2}b$。\n$b \\left[ -\\left(-\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2}\\right) + \\left(\\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2}\\right) \\right] = b\\left[ \\left(\\frac{1}{2}a^{2} - \\frac{2}{3}ab + \\frac{2}{3}b^{2}\\right) + \\left(\\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2}\\right) \\right] = b\\left[a^{2} + \\frac{4}{3}b^{2}\\right] = a^{2}b + \\frac{4}{3}b^{3}$。\n剩下的项是 $-\\frac{a}{2}(\\frac{8}{3}ab) = -\\frac{4}{3}a^{2}b$。\n\n将这些部分相加：\n$2(\\boldsymbol{u}_{0}^{T}\\boldsymbol{v}) = \\left(\\frac{4}{3}a^{2}b\\right) + \\left(a^{2}b + \\frac{4}{3}b^{3}\\right) - \\frac{4}{3}a^{2}b = a^{2}b + \\frac{4}{3}b^{3}$。\n所以，$\\boldsymbol{u}_{0}^{T}\\boldsymbol{v} = \\boldsymbol{u}_{0}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0} = \\frac{1}{2}a^{2}b + \\frac{2}{3}b^{3}$。\n\n熵生成率为 $\\frac{dE}{dt}|_{t=0} = - \\boldsymbol{u}_{0}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0}$。\n$$\n\\frac{dE}{dt} = -\\left(\\frac{1}{2}a^{2}b + \\frac{2}{3}b^{3}\\right) = -\\frac{1}{2}a^{2}b - \\frac{2}{3}b^{3}\n$$\n\n离散熵的不守恒源于混叠误差，因为 LGL 求积法则（对于阶数最高为 $2N-1 = 3$ 的多项式是精确的）被用来积分包含 $u \\frac{df}{dx}$ 的体积项。这里，$u$ 的阶数为 2，$f = \\frac{1}{2}u^2$ 的阶数为 4，所以其插值函数导数得到的被积函数阶数为 5，这不能被精确积分。\n\n问题要求指出奇偶 Legendre 模态的耦合。初始条件 $u(x,0)=a P_2(x) + b P_1(x)$ 是一个偶数模态（$P_2$）和一个奇数模态（$P_1$）的和。熵生成率为 $\\frac{dE}{dt} = -b(\\frac{1}{2}a^2 + \\frac{2}{3}b^2)$。对于实数 $a, b$，括号中的项是非负的。因此，$\\frac{dE}{dt}$ 的符号完全由 $-b$ 的符号决定。这意味着离散熵可能增加也可能减少，这取决于奇数模态 $P_1(x)$ 的系数，这也是符号不确定生成率的来源。奇数模态的存在（即 $b \\neq 0$）对于任何熵变都是必要的，因为如果 $b=0$，则 $\\frac{dE}{dt}=0$。与 $a^2b$ 成比例的项是偶数模态 $a P_2(x)$ 和奇数模态 $b P_1(x)$ 之间非线性耦合的直接结果。",
            "answer": "$$\\boxed{-\\frac{1}{2}a^{2}b - \\frac{2}{3}b^{3}}$$"
        }
    ]
}