{
    "hands_on_practices": [
        {
            "introduction": "The Discontinuous Galerkin method approximates the solution within each element using a basis of polynomials. This exercise provides foundational practice in constructing the core building block of the DG spatial operator: the elemental differentiation matrix. By explicitly calculating the entries of this matrix for a low-order Legendre polynomial basis , you will gain a concrete understanding of how differential operators are represented in the discrete formulation.",
            "id": "3378346",
            "problem": "Consider the semi-discrete Discontinuous Galerkin (DG) method for a scalar conservation law of the form $u_{t} + f(u)_{x} = 0$, such as linear advection $u_{t} + a\\,u_{x} = 0$ with constant $a$ or the inviscid Burgers equation $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$. On each element, after mapping to the reference coordinate $\\xi \\in [-1,1]$, a modal spectral approximation expands the solution in the Legendre polynomial basis $\\{\\phi_{k}(\\xi)\\}_{k=0}^{p}$, where $\\phi_{k}$ denotes the Legendre polynomial of degree $k$. For the standard Legendre basis, the stiffness-like differentiation matrix $D$ with entries\n$$\nD_{kl} = \\int_{-1}^{1} \\phi_{k}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\narises from the weak formulation and is central to constructing DG operators for flux derivatives.\n\nUsing the fundamental properties of Legendre polynomials—orthogonality on $[-1,1]$, parity, endpoint values $\\phi_{n}(1) = 1$ and $\\phi_{n}(-1) = (-1)^{n}$, and the fact that $\\phi_{k}$ is a polynomial of degree $k$—compute all entries of the matrix $D$ for polynomial degree $p = 2$, taking the standard (unnormalized) Legendre polynomials $\\phi_{0}(\\xi) = 1$, $\\phi_{1}(\\xi) = \\xi$, and $\\phi_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2} - 1\\right)$. Express your final result as a single $3 \\times 3$ matrix in closed form. No rounding is required, and no physical units apply. Answer with the full matrix as a single analytic expression.",
            "solution": "The problem is valid. It is a well-posed mathematical problem grounded in the established theory of spectral and discontinuous Galerkin methods. All required information is provided, and the objective is clear and unambiguous.\n\nThe task is to compute the stiffness-like differentiation matrix $D$ for a polynomial basis of degree $p=2$. The entries $D_{kl}$ of this matrix are defined by the integral:\n$$\nD_{kl} = \\int_{-1}^{1} \\phi_{k}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\nwhere $k, l \\in \\{0, 1, 2\\}$, and $\\{\\phi_k\\}$ is the basis of standard Legendre polynomials on the reference interval $\\xi \\in [-1, 1]$. The problem provides the specific basis functions for $p=2$:\n$$\n\\phi_{0}(\\xi) = 1 \\\\\n\\phi_{1}(\\xi) = \\xi \\\\\n\\phi_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2} - 1\\right)\n$$\nFirst, we compute the derivatives of these basis functions with respect to $\\xi$:\n$$\n\\phi_{0}'(\\xi) = \\frac{d}{d\\xi}(1) = 0 \\\\\n\\phi_{1}'(\\xi) = \\frac{d}{d\\xi}(\\xi) = 1 \\\\\n\\phi_{2}'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(3\\xi^{2} - 1)\\right) = \\frac{1}{2}(6\\xi) = 3\\xi\n$$\nWe can observe that these derivatives can be expressed in terms of the basis functions themselves:\n$$\n\\phi_{1}'(\\xi) = 1 = \\phi_{0}(\\xi) \\\\\n\\phi_{2}'(\\xi) = 3\\xi = 3\\phi_{1}(\\xi)\n$$\nNow we compute the $9$ entries of the $3 \\times 3$ matrix $D$ by systematically evaluating the integral for each pair $(k, l)$. We will make use of the fundamental orthogonality property of Legendre polynomials:\n$$\n\\int_{-1}^{1} \\phi_{m}(\\xi)\\,\\phi_{n}(\\xi)\\,d\\xi = 0 \\quad \\text{for } m \\neq n\n$$\n\n**Row 1: $k=0$**\nFor this row, the derivative is $\\phi_{0}'(\\xi) = 0$.\n$$\nD_{0l} = \\int_{-1}^{1} \\phi_{0}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} 0 \\cdot \\phi_{l}(\\xi)\\,d\\xi = 0 \\quad \\text{for } l \\in \\{0, 1, 2\\}\n$$\nThus, the first row of the matrix $D$ is entirely zero: $D_{00} = 0$, $D_{01} = 0$, $D_{02} = 0$.\n\n**Row 2: $k=1$**\nFor this row, the derivative is $\\phi_{1}'(\\xi) = 1 = \\phi_{0}(\\xi)$.\n$$\nD_{1l} = \\int_{-1}^{1} \\phi_{1}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n- For $l=0$:\n$$\nD_{10} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{0}(\\xi)\\,d\\xi = \\int_{-1}^{1} (1)(1)\\,d\\xi = \\int_{-1}^{1} 1\\,d\\xi = [\\xi]_{-1}^{1} = 1 - (-1) = 2\n$$\n- For $l=1$:\n$$\nD_{11} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{1}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 0 \\neq 1)\n$$\n- For $l=2$:\n$$\nD_{12} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{2}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 0 \\neq 2)\n$$\nThe second row of the matrix $D$ is $[2, 0, 0]$.\n\n**Row 3: $k=2$**\nFor this row, the derivative is $\\phi_{2}'(\\xi) = 3\\xi = 3\\phi_{1}(\\xi)$.\n$$\nD_{2l} = \\int_{-1}^{1} \\phi_{2}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} 3\\phi_{1}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n- For $l=0$:\n$$\nD_{20} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{0}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 1 \\neq 0)\n$$\n- For $l=1$:\n$$\nD_{21} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{1}(\\xi)\\,d\\xi = 3 \\int_{-1}^{1} \\xi^{2}\\,d\\xi = 3 \\left[\\frac{\\xi^{3}}{3}\\right]_{-1}^{1} = 3 \\left(\\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3}\\right) = 3 \\left(\\frac{1}{3} - \\left(-\\frac{1}{3}\\right)\\right) = 3 \\left(\\frac{2}{3}\\right) = 2\n$$\n- For $l=2$:\n$$\nD_{22} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{2}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 1 \\neq 2)\n$$\nThe third row of the matrix $D$ is $[0, 2, 0]$.\n\nCombining these results, we construct the matrix $D$:\n$$\nD = \\begin{pmatrix} D_{00} & D_{01} & D_{02} \\\\ D_{10} & D_{11} & D_{12} \\\\ D_{20} & D_{21} & D_{22} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 2 & 0 & 0 \\\\ 0 & 2 & 0 \\end{pmatrix}\n$$\nThis result is consistent with the general property for the unnormalized Legendre basis, which states that $D_{kl} = 2$ if $l<k$ and $(k-l)$ is odd, and $D_{kl} = 0$ otherwise.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 \\\\ 2 & 0 & 0 \\\\ 0 & 2 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A critical aspect of implementing any explicit numerical method for time-dependent PDEs is ensuring stability by selecting an appropriate time step, $\\Delta t$. This hands-on problem addresses the practical application of the Courant-Friedrichs-Lewy (CFL) condition for a DG scheme applied to the nonlinear Burgers' equation. You will determine the maximum stable time step by considering the interplay between element size, polynomial degree, and the local wave speed , a vital skill for developing robust DG codes.",
            "id": "3378391",
            "problem": "Consider the one-dimensional inviscid Burgers equation $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$ posed on a periodic interval and discretized by a piecewise polynomial Discontinuous Galerkin (DG) method of degree $p$ on a nonuniform mesh $\\{K_{j}\\}$ with element lengths $h_{j}$. The numerical flux used at interfaces is the Local Lax-Friedrichs (LLF) flux, and time advancement is by an explicit Strong Stability Preserving Runge-Kutta (SSPRK) method. Let the semi-discrete solution on element $K_{j}$ be denoted $u_{h}|_{K_{j}} \\in \\mathbb{P}^{p}(K_{j})$. Define the LLF dissipation parameter on each element by $\\alpha_{j} = \\max_{x \\in K_{j}} |u_{h}(x)|$, estimated from the nodal values of $u_{h}$ on $K_{j}$.\n\nStarting from the DG weak formulation, an integration-by-parts energy balance, and standard one-dimensional inverse and trace inequalities for polynomials on $K_{j}$, derive a sufficient Courant-Friedrichs-Lewy (CFL) restriction for forward Euler stability that depends only on ($p$, $h_{j}$, $\\alpha_{j}$). Then, using this restriction, compute the maximal stable time step for the following data:\n- Polynomial degree: $p = 3$.\n- Explicit integrator Courant factor: $C = 0.9$.\n- Mesh element lengths: $h_{1} = 0.22$, $h_{2} = 0.18$, $h_{3} = 0.25$, $h_{4} = 0.35$.\n- Elementwise nodal values of $u_{h}$ (four nodes per element):\n  $K_{1}$: $\\{0.8,\\ 1.1,\\ -0.9,\\ 0.5\\}$,\n  $K_{2}$: $\\{0.2,\\ -0.4,\\ 0.6,\\ -0.3\\}$,\n  $K_{3}$: $\\{-1.2,\\ -0.7,\\ -0.5,\\ -0.9\\}$,\n  $K_{4}$: $\\{0.05,\\ 0.15,\\ -0.1,\\ 0.2\\}$.\n\nInterpret $\\alpha_{j}$ via the nodal maximum, i.e., $\\alpha_{j} = \\max_{\\text{nodes in }K_{j}} |u_{h}|$, and determine the maximal admissible $\\Delta t$ implied by the derived CFL restriction. Round your final numerical answer to four significant figures and provide it as a single real number, expressed in dimensionless time units.",
            "solution": "The problem requires the derivation of a sufficient Courant-Friedrichs-Lewy (CFL) condition for a Discontinuous Galerkin (DG) method applied to the inviscid Burgers' equation, and then the application of this condition to compute a maximal stable time step for a given set of parameters.\n\nThe one-dimensional inviscid Burgers' equation is given by:\n$$ u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0 $$\nThis is a nonlinear hyperbolic conservation law of the form $u_t + f(u)_x = 0$, with flux function $f(u) = \\frac{u^2}{2}$. The DG semi-discretization on a mesh element $K_j$ with test function $v_h \\in \\mathbb{P}^p(K_j)$ is:\n$$ \\frac{d}{dt}\\int_{K_j} u_h v_h \\,dx - \\int_{K_j} f(u_h) \\frac{\\partial v_h}{\\partial x} \\,dx + \\widehat{f}_{j+1/2} v_h(x_{j+1/2}^{-}) - \\widehat{f}_{j-1/2} v_h(x_{j-1/2}^{+}) = 0 $$\nwhere $\\widehat{f}$ is a numerical flux. This can be written abstractly as a system of ordinary differential equations (ODEs), $\\frac{d\\mathbf{u}}{dt} = \\mathcal{L}_h(\\mathbf{u})$, where $\\mathbf{u}$ represents the degrees of freedom of the solution $u_h$.\n\n**Part 1: Derivation of the CFL Restriction for Forward Euler Stability**\n\nThe stability of the forward Euler scheme, $\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t \\mathcal{L}_h(\\mathbf{u}^n)$, requires that $\\Delta t$ be restricted such that the scheme does not amplify errors. For a linear system, this means $\\Delta t \\lambda$ must lie within the stability region of the forward Euler method for all eigenvalues $\\lambda$ of the system matrix. For nonlinear systems, one analyzes the Jacobian of the spatial operator, $J = \\frac{\\partial \\mathcal{L}_h}{\\partial \\mathbf{u}}$. Stability requires that $\\Delta t \\rho(J) \\le 1$, where $\\rho(J)$ is the spectral radius of the Jacobian.\n\nA rigorous derivation of the spectral radius of the DG operator Jacobian is highly technical. The problem asks for a derivation based on \"integration-by-parts energy balance, and standard one-dimensional inverse and trace inequalities\". This points towards a standard argument used to estimate the magnitude of the operator norm, which in turn bounds the spectral radius.\n\n1.  **Linearization:** The Jacobian analysis involves linearizing the equation around a local state. The relevant wave speed is given by the derivative of the flux function, $f'(u) = u$. Stability on an element $K_j$ depends on the maximum wave speed over that element, which is given as $\\alpha_j = \\max_{x \\in K_j} |u_h(x)|$. The numerical flux is the Local Lax-Friedrichs (LLF) flux, which for the linearized problem $u_t + a u_x = 0$ (where $|a| \\le \\alpha_j$) uses a dissipation parameter that must be at least $|a|$. The given definition of $\\alpha_j$ is consistent with this.\n\n2.  **Operator Norm Estimation:** The spatial operator $\\mathcal{L}_h$ involves an integral term and boundary flux terms. Using inverse and trace inequalities, one can bound the norm of the operator.\n    - The interior integral term, $\\int_{K_j} f(u_h) v_h' \\,dx$, after linearization involves a term like $\\alpha_j \\int_{K_j} u_h v_h' \\,dx$. The norm of this part can be bounded using the inverse inequality $\\|v_h'\\|_{L^2(K_j)} \\le C \\frac{p^2}{h_j} \\|v_h\\|_{L^2(K_j)}$.\n    - The boundary flux terms involve values of $u_h$ and $v_h$ at the element endpoints. Their contribution can be bounded using trace inequalities, e.g., $\\|v_h\\|_{L^2(\\partial K_j)} \\le C \\sqrt{p/h_j}\\|v_h\\|_{L^2(K_j)}$.\n    - A detailed analysis combining these bounds shows that the spectral radius of the DG spatial operator for 1D advection scales as $\\rho(J) \\sim \\frac{\\alpha_j}{h_j} \\times (\\text{polynomial in } p)$.\n\n3.  **Standard CFL Condition:** For DG methods applied to hyperbolic conservation laws, a widely established sufficient condition for stability with an upwind or other monotone flux is given by:\n    $$ \\Delta t \\le \\frac{h_j}{\\alpha_j (2p+1)} $$\n    This result stems from a more precise analysis of the eigenvalues of the DG operator, which for a 1D problem with an upwind flux are found to be bounded by $\\rho(J) \\approx \\frac{\\alpha_j(2p+1)}{h_j}$. The LLF flux is generally more dissipative than the upwind flux due to its construction, which adds dissipation for all wave components. Consequently, a stability condition sufficient for an upwind flux is typically also sufficient for an LLF flux. We therefore adopt this as the required sufficient CFL restriction for forward Euler stability.\n\n**Part 2: Computation of the Maximal Stable Time Step**\n\nThe derived condition must hold for all elements in the mesh. Furthermore, the problem specifies an SSPRK method with a Courant factor $C = 0.9$. This coefficient extends the stability region of the forward Euler method. The global time step $\\Delta t$ is thus limited by the most restrictive element:\n$$ \\Delta t \\le C \\times \\min_{j} \\left( \\frac{h_j}{\\alpha_j (2p+1)} \\right) = \\frac{C}{2p+1} \\min_{j} \\left( \\frac{h_j}{\\alpha_j} \\right) $$\n\nWe are given the following data:\n- Polynomial degree: $p = 3$. This gives $2p+1 = 2(3)+1 = 7$.\n- Integrator Courant factor: $C = 0.9$.\n- Mesh element lengths and nodal values.\n\nWe now compute the ratio $\\frac{h_j}{\\alpha_j}$ for each element $K_j$. The parameter $\\alpha_j$ is the maximum absolute value of the nodal solution values on element $K_j$.\n\n- **Element $K_1$**:\n  - Nodal values: $\\{0.8, 1.1, -0.9, 0.5\\}$\n  - $\\alpha_1 = \\max(|0.8|, |1.1|, |-0.9|, |0.5|) = 1.1$\n  - $h_1 = 0.22$\n  - Ratio: $\\frac{h_1}{\\alpha_1} = \\frac{0.22}{1.1} = 0.2$\n\n- **Element $K_2$**:\n  - Nodal values: $\\{0.2, -0.4, 0.6, -0.3\\}$\n  - $\\alpha_2 = \\max(|0.2|, |-0.4|, |0.6|, |-0.3|) = 0.6$\n  - $h_2 = 0.18$\n  - Ratio: $\\frac{h_2}{\\alpha_2} = \\frac{0.18}{0.6} = 0.3$\n\n- **Element $K_3$**:\n  - Nodal values: $\\{-1.2, -0.7, -0.5, -0.9\\}$\n  - $\\alpha_3 = \\max(|-1.2|, |-0.7|, |-0.5|, |-0.9|) = 1.2$\n  - $h_3 = 0.25$\n  - Ratio: $\\frac{h_3}{\\alpha_3} = \\frac{0.25}{1.2} = \\frac{25}{120} = \\frac{5}{24} \\approx 0.20833$\n\n- **Element $K_4$**:\n  - Nodal values: $\\{0.05, 0.15, -0.1, 0.2\\}$\n  - $\\alpha_4 = \\max(|0.05|, |0.15|, |-0.1|, |0.2|) = 0.2$\n  - $h_4 = 0.35$\n  - Ratio: $\\frac{h_4}{\\alpha_4} = \\frac{0.35}{0.2} = 1.75$\n\nNext, we find the minimum of these ratios:\n$$ \\min_{j} \\left( \\frac{h_j}{\\alpha_j} \\right) = \\min(0.2, 0.3, 0.20833..., 1.75) = 0.2 $$\nThe most restrictive element is $K_1$.\n\nFinally, we compute the maximal admissible time step $\\Delta t$:\n$$ \\Delta t = \\frac{C}{2p+1} \\times \\min_{j} \\left( \\frac{h_j}{\\alpha_j} \\right) = \\frac{0.9}{7} \\times 0.2 = \\frac{0.18}{7} \\approx 0.02571428... $$\n\nRounding the result to four significant figures gives $0.02571$.",
            "answer": "$$\n\\boxed{0.02571}\n$$"
        },
        {
            "introduction": "While DG methods offer many advantages, their application to nonlinear conservation laws like the Burgers' equation can introduce subtle numerical artifacts. This advanced practice explores the phenomenon of aliasing, where under-integration of nonlinear terms leads to a violation of discrete energy conservation. By computing the spurious rate of entropy production in a nodal DG scheme , you will uncover the mechanism of odd-even mode coupling that can drive numerical instability.",
            "id": "3378396",
            "problem": "Consider the one-dimensional inviscid Burgers equation $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$ on a periodic interval. Discretize it on a single reference element $x \\in [-1,1]$ using a Discontinuous Galerkin (DG) method in nodal collocation form with polynomial degree $N=2$ and Legendre–Gauss–Lobatto (LGL) nodes. Use the central numerical flux and impose periodic identification so that all surface contributions cancel exactly. The semi-discrete strong-form update at the nodes is taken to be\n$$\n\\frac{d \\boldsymbol{u}}{dt} = - \\boldsymbol{D}\\,\\boldsymbol{f}, \\qquad \\boldsymbol{f} = \\frac{1}{2}\\,\\boldsymbol{u}\\odot\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{u} = \\left[u(x_{1}),u(x_{2}),u(x_{3})\\right]^{T}$ collects the nodal values at the LGL nodes $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$, $\\odot$ is the componentwise product, and $\\boldsymbol{D}$ is the LGL differentiation matrix with entries $\\left(D_{ij}\\right) = \\ell_{j}'(x_{i})$ for the degree-$2$ Lagrange basis $\\{\\ell_{j}\\}$. The corresponding diagonal quadrature weight matrix is $\\boldsymbol{W}=\\mathrm{diag}(w_{1},w_{2},w_{3})$ with $w_{1}=\\frac{1}{3}$, $w_{2}=\\frac{4}{3}$, $w_{3}=\\frac{1}{3}$. For degree $N=2$, the matrices are\n$$\n\\boldsymbol{D}=\\begin{pmatrix}\n-\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\\n-\\frac{1}{2} & 0 & \\frac{1}{2} \\\\\n\\frac{1}{2} & -2 & \\frac{3}{2}\n\\end{pmatrix}, \n\\qquad \n\\boldsymbol{W}=\\begin{pmatrix}\n\\frac{1}{3} & 0 & 0\\\\\n0 & \\frac{4}{3} & 0\\\\\n0 & 0 & \\frac{1}{3}\n\\end{pmatrix}.\n$$\n\nDefine the discrete quadratic entropy (discrete energy) as $E(\\boldsymbol{u})=\\frac{1}{2}\\,\\boldsymbol{u}^{T}\\boldsymbol{W}\\,\\boldsymbol{u}$, which is the LGL-quadrature approximation to $\\frac{1}{2}\\int_{-1}^{1} u^{2}\\,dx$. Because the volume term is evaluated pointwise and the quadrature is exact only up to degree $3$, the nonlinear volume integral is underintegrated and thus exhibits aliasing for general $u$.\n\nSuppose the polynomial solution at $t=0$ is the Legendre-modal combination $u(x,0)=a\\,P_{2}(x)+b\\,P_{1}(x)$, where $P_{1}(x)=x$ and $P_{2}(x)=\\frac{1}{2}\\left(3x^{2}-1\\right)$, with real constants $a$ and $b$. Using only the data and operators stated above, compute the semi-discrete rate of discrete entropy production $\\,\\frac{dE}{dt}\\,$ at $t=0$ produced by the underintegrated volume term. Express your final answer as a closed-form analytic expression in terms of $a$ and $b$. Briefly, in your derivation, identify the odd–even Legendre mode coupling responsible for the sign-indefinite entropy production.\n\nYour final answer must be a single analytic expression in terms of $a$ and $b$ (no units). Do not round.",
            "solution": "The user wants me to compute the rate of discrete entropy production for a Discontinuous Galerkin (DG) discretization of the inviscid Burgers' equation.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n-   **Equation:** $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$ on a periodic interval.\n-   **Discretization:** DG method on a single reference element $x \\in [-1,1]$ in nodal collocation form.\n-   **Polynomial Degree:** $N=2$.\n-   **Nodes:** Legendre–Gauss–Lobatto (LGL) nodes. For $N=2$, these are $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$.\n-   **Numerical Flux:** Central flux, with periodic identification causing surface terms to cancel.\n-   **Semi-discrete Form:** $\\frac{d \\boldsymbol{u}}{dt} = - \\boldsymbol{D}\\,\\boldsymbol{f}$, where $\\boldsymbol{f} = \\frac{1}{2}\\,\\boldsymbol{u}\\odot\\boldsymbol{u}$.\n-   **Nodal Vector:** $\\boldsymbol{u} = \\left[u(x_{1}),u(x_{2}),u(x_{3})\\right]^{T}$.\n-   **Differentiation Matrix ($N=2$ LGL):**\n    $$\n    \\boldsymbol{D}=\\begin{pmatrix}\n    -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\\n    -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\\n    \\frac{1}{2} & -2 & \\frac{3}{2}\n    \\end{pmatrix}\n    $$\n-   **Quadrature Weight Matrix ($N=2$ LGL):**\n    $$\n    \\boldsymbol{W}=\\begin{pmatrix}\n    \\frac{1}{3} & 0 & 0\\\\\n    0 & \\frac{4}{3} & 0\\\\\n    0 & 0 & \\frac{1}{3}\n    \\end{pmatrix}\n    $$\n-   **Discrete Entropy (Energy):** $E(\\boldsymbol{u})=\\frac{1}{2}\\,\\boldsymbol{u}^{T}\\boldsymbol{W}\\,\\boldsymbol{u}$.\n-   **Initial Condition:** $u(x,0)=a\\,P_{2}(x)+b\\,P_{1}(x)$, with $P_{1}(x)=x$ and $P_{2}(x)=\\frac{1}{2}\\left(3x^{2}-1\\right)$.\n\n**1.2. Validate Using Extracted Givens:**\n-   **Scientifically Grounded:** The problem uses the standard inviscid Burgers' equation and a well-established numerical method (nodal DG with LGL nodes). The matrices $\\boldsymbol{D}$ and $\\boldsymbol{W}$ provided for $N=2$ are correct for the LGL basis. The concept of aliasing-induced entropy production in under-integrated Galerkin methods is a standard topic in numerical analysis.\n-   **Well-Posed:** The problem is a direct calculation based on the given definitions. All necessary components (equations, matrices, initial conditions) are provided. The task is to compute a specific quantity, $\\frac{dE}{dt}$ at $t=0$, which is uniquely determined by the setup.\n-   **Objective:** The problem is stated in precise mathematical and numerical analysis terms. There are no subjective or ambiguous statements.\n\n**1.3. Verdict and Action:**\nThe problem is valid. It is a well-defined calculation within the field of numerical methods for partial differential equations. I will proceed with the solution.\n\n### Step 2: Solution Derivation\n\nThe objective is to compute the rate of change of the discrete entropy, $\\frac{dE}{dt}$, at time $t=0$. The discrete entropy is given by\n$$E(\\boldsymbol{u}) = \\frac{1}{2}\\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{u}$$\n\nWe first find the time derivative of $E(\\boldsymbol{u})$ using the chain rule:\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2}\\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{u} \\right) = \\frac{1}{2} \\left( \\frac{d\\boldsymbol{u}^{T}}{dt}\\boldsymbol{W}\\boldsymbol{u} + \\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt} \\right)\n$$\nSince $\\boldsymbol{W}$ is a symmetric matrix ($\\boldsymbol{W}^{T}=\\boldsymbol{W}$), and the term $\\frac{d\\boldsymbol{u}^{T}}{dt}\\boldsymbol{W}\\boldsymbol{u}$ is a scalar, we have $\\frac{d\\boldsymbol{u}^{T}}{dt}\\boldsymbol{W}\\boldsymbol{u} = \\left(\\boldsymbol{u}^{T}\\boldsymbol{W}^{T}\\frac{d\\boldsymbol{u}}{dt}\\right)^{T} = \\left(\\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt}\\right)^{T} = \\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt}$.\nThus, the two terms are equal, and we have:\n$$\n\\frac{dE}{dt} = \\boldsymbol{u}^{T}\\boldsymbol{W}\\frac{d\\boldsymbol{u}}{dt}\n$$\nNow, we substitute the given semi-discrete equation, $\\frac{d \\boldsymbol{u}}{dt} = - \\boldsymbol{D}\\,\\boldsymbol{f}$:\n$$\n\\frac{dE}{dt} = - \\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}\n$$\nThe flux vector $\\boldsymbol{f}$ is defined as $\\boldsymbol{f} = \\frac{1}{2}\\boldsymbol{u}\\odot\\boldsymbol{u}$, where $\\odot$ denotes the element-wise product.\n$$\n\\frac{dE}{dt} = - \\frac{1}{2} \\boldsymbol{u}^{T}\\boldsymbol{W}\\boldsymbol{D} (\\boldsymbol{u}\\odot\\boldsymbol{u})\n$$\nWe need to evaluate this expression at $t=0$. First, we compute the vector of nodal values $\\boldsymbol{u}_{0} = \\boldsymbol{u}(t=0)$ from the initial condition $u(x,0)=a\\,P_{2}(x)+b\\,P_{1}(x)$ at the LGL nodes $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$.\n$$u(x,0) = a\\left(\\frac{1}{2}(3x^{2}-1)\\right) + b x$$\nAt the nodes:\n-   $u_{0,1} = u(-1,0) = a\\left(\\frac{1}{2}(3(-1)^{2}-1)\\right) + b(-1) = a\\left(\\frac{2}{2}\\right) - b = a - b$\n-   $u_{0,2} = u(0,0) = a\\left(\\frac{1}{2}(3(0)^{2}-1)\\right) + b(0) = -\\frac{a}{2}$\n-   $u_{0,3} = u(1,0) = a\\left(\\frac{1}{2}(3(1)^{2}-1)\\right) + b(1) = a\\left(\\frac{2}{2}\\right) + b = a + b$\n\nSo, the initial nodal vector is $\\boldsymbol{u}_{0} = \\begin{pmatrix} a-b & -\\frac{a}{2} & a+b \\end{pmatrix}^{T}$.\n\nNext, we compute the initial flux vector $\\boldsymbol{f}_{0} = \\frac{1}{2}\\boldsymbol{u}_{0}\\odot\\boldsymbol{u}_{0}$:\n$$\n\\boldsymbol{f}_{0} = \\frac{1}{2} \\begin{pmatrix} (a-b)^{2} \\\\ (-\\frac{a}{2})^{2} \\\\ (a+b)^{2} \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} a^{2}-2ab+b^{2} \\\\ \\frac{a^{2}}{4} \\\\ a^{2}+2ab+b^{2} \\end{pmatrix}\n$$\nNow we compute the product $\\boldsymbol{u}_{0}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0}$. Let's first calculate the product $\\boldsymbol{W}\\boldsymbol{D}$:\n$$\n\\boldsymbol{W}\\boldsymbol{D} = \\begin{pmatrix} \\frac{1}{3} & 0 & 0 \\\\ 0 & \\frac{4}{3} & 0 \\\\ 0 & 0 & \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} & \\frac{2}{3} & -\\frac{1}{6} \\\\ -\\frac{2}{3} & 0 & \\frac{2}{3} \\\\ \\frac{1}{6} & -\\frac{2}{3} & \\frac{1}{2} \\end{pmatrix}\n$$\nNow we compute the vector $\\boldsymbol{v} = \\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0}$:\n$$\n\\boldsymbol{v} = \\begin{pmatrix} -\\frac{1}{2} & \\frac{2}{3} & -\\frac{1}{6} \\\\ -\\frac{2}{3} & 0 & \\frac{2}{3} \\\\ \\frac{1}{6} & -\\frac{2}{3} & \\frac{1}{2} \\end{pmatrix} \\left( \\frac{1}{2} \\begin{pmatrix} a^{2}-2ab+b^{2} \\\\ \\frac{a^{2}}{4} \\\\ a^{2}+2ab+b^{2} \\end{pmatrix} \\right)\n$$\nLet's compute $2\\boldsymbol{v}$:\n-   $(2\\boldsymbol{v})_{1} = -\\frac{1}{2}(a^{2}-2ab+b^{2}) + \\frac{2}{3}(\\frac{a^{2}}{4}) - \\frac{1}{6}(a^{2}+2ab+b^{2})$\n    $= a^{2}(-\\frac{1}{2}+\\frac{1}{6}-\\frac{1}{6}) + ab(1-\\frac{1}{3}) + b^{2}(-\\frac{1}{2}-\\frac{1}{6}) = -\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2}$\n-   $(2\\boldsymbol{v})_{2} = -\\frac{2}{3}(a^{2}-2ab+b^{2}) + 0 + \\frac{2}{3}(a^{2}+2ab+b^{2})$\n    $= \\frac{2}{3}[ (a^{2}+2ab+b^{2}) - (a^{2}-2ab+b^{2}) ] = \\frac{2}{3}(4ab) = \\frac{8}{3}ab$\n-   $(2\\boldsymbol{v})_{3} = \\frac{1}{6}(a^{2}-2ab+b^{2}) - \\frac{2}{3}(\\frac{a^{2}}{4}) + \\frac{1}{2}(a^{2}+2ab+b^{2})$\n    $= a^{2}(\\frac{1}{6}-\\frac{1}{6}+\\frac{1}{2}) + ab(-\\frac{1}{3}+1) + b^{2}(\\frac{1}{6}+\\frac{1}{2}) = \\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2}$\n\nSo, $\\boldsymbol{v} = \\frac{1}{2} \\begin{pmatrix} -\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2} \\\\ \\frac{8}{3}ab \\\\ \\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2} \\end{pmatrix}$.\n\nFinally, we compute the dot product $\\boldsymbol{u}_{0}^{T} \\boldsymbol{v}$:\n$$\n\\boldsymbol{u}_{0}^{T}\\boldsymbol{v} = \\begin{pmatrix} a-b & -\\frac{a}{2} & a+b \\end{pmatrix} \\left( \\frac{1}{2} \\begin{pmatrix} -\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2} \\\\ \\frac{8}{3}ab \\\\ \\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2} \\end{pmatrix} \\right)\n$$\nLet $2(\\boldsymbol{u}_{0}^{T}\\boldsymbol{v}) = (a-b)(-\\frac{1}{2}a^{2} + \\frac{2}{3}ab - \\frac{2}{3}b^{2}) - \\frac{a}{2}(\\frac{8}{3}ab) + (a+b)(\\frac{1}{2}a^{2} + \\frac{2}{3}ab + \\frac{2}{3}b^{2})$.\nExpanding the terms:\n$2(\\boldsymbol{u}_{0}^{T}\\boldsymbol{v}) = (-\\frac{1}{2}a^3 + \\frac{7}{6}a^2b - \\frac{4}{3}ab^2 + \\frac{2}{3}b^3) - \\frac{4}{3}a^2b + (\\frac{1}{2}a^3 + \\frac{7}{6}a^2b + \\frac{4}{3}ab^2 + \\frac{2}{3}b^3)$\nGrouping terms by powers:\n$a^3: -\\frac{1}{2} + \\frac{1}{2} = 0$\n$a^2b: \\frac{7}{6} - \\frac{4}{3} + \\frac{7}{6} = \\frac{14}{6} - \\frac{8}{6} = \\frac{6}{6} = 1$\n$ab^2: -\\frac{4}{3} + \\frac{4}{3} = 0$\n$b^3: \\frac{2}{3} + \\frac{2}{3} = \\frac{4}{3}$\nSo, $2(\\boldsymbol{u}_{0}^{T}\\boldsymbol{v}) = a^2b + \\frac{4}{3}b^3$.\nThis gives $\\boldsymbol{u}_{0}^{T}\\boldsymbol{v} = \\boldsymbol{u}_{0}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0} = \\frac{1}{2}a^{2}b + \\frac{2}{3}b^{3}$.\n\nThe rate of entropy production is $\\frac{dE}{dt}|_{t=0} = - \\boldsymbol{u}_{0}^{T}\\boldsymbol{W}\\boldsymbol{D}\\boldsymbol{f}_{0}$.\n$$\n\\frac{dE}{dt} = -\\left(\\frac{1}{2}a^{2}b + \\frac{2}{3}b^{3}\\right) = -\\frac{1}{2}a^{2}b - \\frac{2}{3}b^{3}\n$$\n\nThe non-conservation of discrete entropy arises from aliasing error, as the LGL quadrature rule (exact for polynomials up to degree $2N-1 = 3$) is used to integrate the volume term involving $u \\frac{df}{dx}$. Here, $u$ is degree $2$ and $f = \\frac{1}{2}u^2$ is degree $4$, so the derivative of its interpolant results in a integrand of degree $5$, which is not integrated exactly.\n\nThe problem asks to identify the odd–even Legendre mode coupling. The initial condition $u(x,0)=a P_2(x) + b P_1(x)$ is a sum of an even mode ($P_2$) and an odd mode ($P_1$). The entropy production rate is $\\frac{dE}{dt} = -b(\\frac{1}{2}a^2 + \\frac{2}{3}b^2)$. The term in the parentheses is non-negative for real $a, b$. Therefore, the sign of $\\frac{dE}{dt}$ is determined solely by the sign of $-b$. This means the discrete entropy can either increase or decrease depending on the coefficient of the odd mode $P_1(x)$, which is the source of the sign-indefinite production. The presence of the odd mode (i.e., $b \\neq 0$) is necessary for any entropy change, as $\\frac{dE}{dt}=0$ if $b=0$. The term proportional to $a^2b$ is a direct consequence of the nonlinear coupling between the even mode $a P_2(x)$ and the odd mode $b P_1(x)$.",
            "answer": "$$\\boxed{-\\frac{1}{2}a^{2}b - \\frac{2}{3}b^{3}}$$"
        }
    ]
}