{
    "hands_on_practices": [
        {
            "introduction": "Understanding the stability of a numerical method is paramount, and von Neumann analysis is a powerful tool for this purpose. We begin our hands-on practice with the simplest possible Discontinuous Galerkin (DG) method, using piecewise-constant elements ($p=0$) for the linear advection equation. This foundational exercise  will demonstrate that this scheme is equivalent to the well-known first-order upwind finite difference method, allowing you to apply the full pipeline of Fourier analysis—from deriving the semi-discrete operator to finding its symbol and determining the explicit time-step limit—in a familiar context.",
            "id": "3426865",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$ on a periodic one-dimensional domain partitioned into a uniform mesh of elements of size $h$. Discretize the equation using a Discontinuous Galerkin (DG) method of polynomial degree $p=0$ (piecewise constants) with the upwind numerical flux for $a0$, and write the resulting semi-discrete system in the form $M\\,\\dot{U} = K\\,U$, where $M$ is the elementwise mass matrix and $K$ is the stiffness operator induced by the numerical fluxes.\n\nYou are asked to analyze how two common modifications affect the semi-discrete operator, its Fourier symbol, and the allowable explicit time step for advection:\n- Diagonal preconditioning: define the symmetrically preconditioned operator $B := M^{-1/2} K M^{-1/2}$.\n- Mass-lumping: replace $M$ by a diagonal approximation $L$ and evolve with $L^{-1}K$.\n\nPerform a von Neumann Fourier analysis by considering plane-wave solutions of the form $U_{j}(t) = \\widehat{U}(t)\\,\\exp(i \\kappa j h)$, where $j$ indexes elements, $\\kappa$ is the continuous wavenumber, and $\\theta := \\kappa h \\in [-\\pi, \\pi]$ is the nondimensional wavenumber in radians. Starting from the DG weak form and the definitions above, derive:\n1. The explicit form of $M$ and $K$ for this DG discretization, and the corresponding evolution operator $A := M^{-1}K$.\n2. The Fourier symbol $\\lambda(\\theta)$ of $A$, and the modified wavenumber $k_{\\mathrm{eff}}(\\theta)$ defined by $\\lambda(\\theta) = -i\\,a\\,k_{\\mathrm{eff}}(\\theta) + \\text{dissipation}(\\theta)$.\n3. The relationship between the spectra of $A$ and $B$ (obtained via diagonal preconditioning), and the consequence for the allowable forward Euler (FE) time step.\n4. The exact upper bound on the forward Euler time step $\\Delta t$ for stability, obtained by requiring the FE amplification factor $1 + \\Delta t\\,\\lambda(\\theta)$ to remain inside the FE stability disk for all $\\theta \\in [-\\pi,\\pi]$.\n\nProvide your final answer as a single closed-form analytic expression for the maximum allowable time step $\\Delta t_{\\max}$ in terms of $h$ and $a$. No numerical substitution is required. State all intermediate steps and assumptions clearly, and express the answer with no units. If any angular quantities appear, treat them explicitly as radians. The final answer must be a single expression.",
            "solution": "The problem asks for an analysis of the Discontinuous Galerkin (DG) method with polynomial degree $p=0$ applied to the one-dimensional linear advection equation $u_t + a u_x = 0$, where the advection speed $a$ is a positive constant. The analysis includes deriving the semi-discrete operators, performing a von Neumann stability analysis, and determining the maximum stable time step for the forward Euler method.\n\n### Step 1: Derivation of the Semi-discrete System\n\nThe DG weak formulation on a mesh element $I_j = [x_{j-1/2}, x_{j+1/2}]$ of uniform size $h = x_{j+1/2} - x_{j-1/2}$ is: find the approximate solution $u_h$ from the finite-dimensional space $V_h$ such that for every test function $v_h \\in V_h$,\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + \\left[ a u_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\nwhere $u_h^*$ is the numerical flux at the element interfaces.\n\nFor a polynomial degree of $p=0$, the solution $u_h$ and test function $v_h$ are piecewise-constant. On element $I_j$, we represent the solution as $u_h(x,t) = U_j(t)$ for $x \\in I_j$. The basis functions are indicator functions $\\phi_j(x) = 1$ if $x \\in I_j$ and $0$ otherwise. We choose the test function to be $v_h(x) = \\phi_j(x)$.\n\nSubstituting these into the weak form:\n1.  The first term is $\\int_{I_j} \\frac{d U_j}{dt} \\cdot 1 \\, dx = \\dot{U}_j \\int_{I_j} dx = h \\dot{U}_j$.\n2.  The second term is $- \\int_{I_j} a U_j \\frac{\\partial \\phi_j}{\\partial x} \\, dx = 0$, since $\\frac{\\partial \\phi_j}{\\partial x} = 0$ inside the element $I_j$.\n3.  The third term represents the flux contributions at the element boundaries:\n    $$\n    \\left[ a u_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = a u_h^*(x_{j+1/2}, t) v_h(x_{j+1/2}^-) - a u_h^*(x_{j-1/2}, t) v_h(x_{j-1/2}^+)\n    $$\n    Since $v_h(x_{j+1/2}^-) = \\phi_j(x_{j+1/2}^-) = 1$ and $v_h(x_{j-1/2}^+) = \\phi_j(x_{j-1/2}^+) = 1$, this becomes $a u_h^*(x_{j+1/2}, t) - a u_h^*(x_{j-1/2}, t)$.\n\nThe problem specifies the upwind numerical flux. Since $a > 0$, the information propagates from left to right. The upwind flux at an interface is the value of the solution from the upwind (left) side.\nAt interface $x_{j+1/2}$, the upwind value is $u_h(x_{j+1/2}^-) = U_j(t)$.\nAt interface $x_{j-1/2}$, the upwind value is $u_h(x_{j-1/2}^-) = U_{j-1}(t)$.\nThus, the numerical fluxes are $u_h^*(x_{j+1/2}, t) = U_j(t)$ and $u_h^*(x_{j-1/2}, t) = U_{j-1}(t)$.\n\nCombining these terms, the semi-discrete equation for element $j$ is:\n$$\nh \\dot{U}_j + a U_j - a U_{j-1} = 0\n$$\nRearranging this into the form $M \\dot{U} = K U$:\n$$\nh \\dot{U}_j = a U_{j-1} - a U_j\n$$\nThe left-hand side corresponds to the mass matrix operator. The $(j,k)$ entry of the mass matrix $M$ is $M_{jk} = \\int_{\\Omega} \\phi_j \\phi_k \\, dx$. For $p=0$, the basis functions have disjoint support, so $M_{jk}=0$ for $j \\neq k$. The diagonal entries are $M_{jj} = \\int_{I_j} 1 \\cdot 1 \\, dx = h$. Therefore, the mass matrix is $M = hI$, where $I$ is the identity matrix.\n\nThe right-hand side corresponds to the stiffness operator $K$. The $j$-th row of the vector $KU$ is $a U_{j-1} - a U_j$. This means the matrix $K$ has diagonal entries $K_{jj} = -a$ and sub-diagonal entries $K_{j, j-1} = a$. All other entries are zero.\n\nThe evolution operator is $A := M^{-1}K$. Since $M=hI$, its inverse is $M^{-1} = \\frac{1}{h}I$.\n$$ A = \\frac{1}{h}K $$\nThe semi-discrete system can be written as $\\dot{U} = A U$, which for element $j$ is:\n$$ \\dot{U}_j = \\frac{a}{h}(U_{j-1} - U_j) $$\nThis is identical to the first-order upwind finite difference scheme.\n\n### Step 2: Fourier Symbol and Modified Wavenumber\n\nWe perform a von Neumann Fourier analysis by substituting a plane-wave solution $U_j(t) = \\widehat{U}(t) \\exp(i\\kappa j h)$ into the semi-discrete equation, where $\\kappa$ is the wavenumber and $\\theta := \\kappa h$ is the non-dimensional wavenumber.\n$$\n\\frac{d}{dt} \\left( \\widehat{U}(t) e^{i\\kappa j h} \\right) = \\frac{a}{h} \\left( \\widehat{U}(t) e^{i\\kappa (j-1) h} - \\widehat{U}(t) e^{i\\kappa j h} \\right)\n$$\n$$\n\\dot{\\widehat{U}}(t) e^{i\\kappa j h} = \\frac{a}{h} \\widehat{U}(t) e^{i\\kappa j h} \\left( e^{-i\\kappa h} - 1 \\right)\n$$\nDividing by $\\widehat{U}(t) e^{i\\kappa j h}$ gives the evolution equation for the Fourier amplitude, $\\dot{\\widehat{U}}(t) = \\lambda(\\theta) \\widehat{U}(t)$. The Fourier symbol (eigenvalue) $\\lambda(\\theta)$ of the operator $A$ is:\n$$\n\\lambda(\\theta) = \\frac{a}{h} (e^{-i\\theta} - 1)\n$$\nWe separate this into real and imaginary parts using $e^{-i\\theta} = \\cos\\theta - i\\sin\\theta$:\n$$\n\\lambda(\\theta) = \\frac{a}{h} (\\cos\\theta - 1 - i\\sin\\theta) = \\frac{a}{h}(\\cos\\theta - 1) - i \\frac{a}{h}\\sin\\theta\n$$\nThe exact solution to $u_t+au_x=0$ has a pure imaginary Fourier symbol $-ia\\kappa$. The numerical symbol has a real part, representing numerical dissipation, and an imaginary part related to numerical dispersion. The modified wavenumber $k_{\\mathrm{eff}}$ is defined such that the imaginary part of $\\lambda(\\theta)$ takes the form $-ia k_{\\mathrm{eff}}$.\n$$\n-a k_{\\mathrm{eff}}(\\theta) = \\text{Im}[\\lambda(\\theta)] = - \\frac{a}{h} \\sin\\theta\n$$\nSolving for $k_{\\mathrm{eff}}$ yields:\n$$\nk_{\\mathrm{eff}}(\\theta) = \\frac{\\sin\\theta}{h}\n$$\nThe real part of $\\lambda(\\theta)$, $\\text{Re}[\\lambda(\\theta)] = \\frac{a}{h}(\\cos\\theta-1)$, represents the numerical dissipation. Since $a0$, $h0$, and $\\cos\\theta-1 \\le 0$, the real part is non-positive, indicating that the scheme is dissipative.\n\n### Step 3: Analysis of Operator Modifications\n\nThe problem mentions two modifications: diagonal preconditioning and mass-lumping.\n- **Diagonal Preconditioning**: The operator $B$ is defined as $B := M^{-1/2} K M^{-1/2}$. For the $p=0$ case, $M=hI$, which is already diagonal. So, $M^{-1/2} = (1/\\sqrt{h})I$.\n$$\nB = \\left( \\frac{1}{\\sqrt{h}}I \\right) K \\left( \\frac{1}{\\sqrt{h}}I \\right) = \\frac{1}{h}K\n$$\nThis is identical to the original evolution operator $A = M^{-1}K = \\frac{1}{h}K$. Thus, for $p=0$, $A=B$. In general, $A=M^{-1}K$ is related to the symmetric matrix $B$ by a similarity transformation $B = M^{1/2} A M^{-1/2}$, which implies that $A$ and $B$ have the same spectrum (eigenvalues). For our case, this is trivially true as the operators are identical. The consequence for the forward Euler time step is that the stability limit, which depends on the spectrum of the evolution operator, is the same for both $A$ and $B$.\n\n- **Mass-Lumping**: This involves replacing the consistent mass matrix $M$ with a diagonal approximation $L$. For the $p=0$ DG method, the consistent mass matrix $M=hI$ is inherently diagonal. Therefore, any standard mass-lumping procedure (e.g., row-sum lumping) results in $L=M$. The \"mass-lumped\" operator $L^{-1}K$ is identical to $M^{-1}K=A$.\n\nIn summary, for the specific case of $p=0$, neither of the proposed modifications alters the semi-discrete evolution operator $A$.\n\n### Step 4: Forward Euler Time Step Restriction\n\nThe forward Euler time-stepping scheme for $\\dot{U} = AU$ is $U^{n+1} = U^n + \\Delta t A U^n$. A mode with wavenumber $\\kappa$ is amplified by the factor $G(\\theta) = 1 + \\Delta t \\lambda(\\theta)$. For stability, the magnitude of this amplification factor must not exceed $1$ for any mode, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$.\n$$\n|1 + \\Delta t \\lambda(\\theta)| \\le 1\n$$\nSubstituting $\\lambda(\\theta) = \\frac{a}{h}(e^{-i\\theta} - 1)$:\n$$\n\\left|1 + \\frac{a \\Delta t}{h}(e^{-i\\theta} - 1)\\right| \\le 1\n$$\nLet $C = \\frac{a \\Delta t}{h}$ be the Courant number. The inequality becomes:\n$$\n|1 + C(e^{-i\\theta} - 1)| \\le 1\n$$\nLet's analyze this geometrically. The complex number $z = \\Delta t \\lambda(\\theta) = C(e^{-i\\theta}-1)$ must lie within the Forward Euler stability domain, which is a disk of radius $1$ centered at $-1$ in the complex plane.\nAs $\\theta$ varies, $e^{-i\\theta}$ traces the unit circle. The term $e^{-i\\theta}-1$ traces a circle of radius $1$ centered at $-1$. The term $C(e^{-i\\theta}-1)$ traces a circle of radius $C$ centered at $-C$.\nFor this circle of eigenvalues (domain $L$) to be contained within the stability disk (domain $S$), its leftmost point must be within the leftmost point of $S$.\nThe leftmost point of $L$ is at $-2C$.\nThe leftmost point of $S$ is at $-2$.\nThe condition is $-2C \\ge -2$, which simplifies to $C \\le 1$.\n\nAlternatively, we can proceed algebraically:\n$$\n| (1 - C + C\\cos\\theta) - i(C\\sin\\theta) |^2 \\le 1\n$$\n$$\n(1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2 \\le 1\n$$\n$$\n(1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta \\le 1\n$$\n$$\n1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 \\le 1\n$$\n$$\n-2C + 2C^2 + 2C(1-C)\\cos\\theta \\le 0\n$$\nSince $C  0$, we can divide by $2C$:\n$$\n-1 + C + (1-C)\\cos\\theta \\le 0\n$$\n$$\n(C-1) - (C-1)\\cos\\theta \\le 0\n$$\n$$\n(C-1)(1-\\cos\\theta) \\le 0\n$$\nSince $1-\\cos\\theta \\ge 0$ for all real $\\theta$, and we require the inequality to hold for all $\\theta$, we must ensure that the other factor is non-positive.\n$$ C-1 \\le 0 \\implies C \\le 1 $$\nThe Courant number must be less than or equal to $1$.\n$$\n\\frac{a \\Delta t}{h} \\le 1\n$$\nThis gives the maximum allowable time step for stability:\n$$\n\\Delta t_{\\max} = \\frac{h}{a}\n$$",
            "answer": "$$\\boxed{\\frac{h}{a}}$$"
        },
        {
            "introduction": "Building on the fundamentals, we now increase the complexity to a higher-order DG method using linear polynomials ($p=1$). This step is crucial as it introduces a concept central to the analysis of most advanced numerical methods: the block symbol. Because a DG($p=1$) scheme involves multiple degrees of freedom per element, its Fourier analysis yields a matrix-valued symbol whose eigenvalues determine the behavior of different modes. This practice  will guide you through deriving this $2 \\times 2$ block symbol and its eigenvalues, providing direct insight into the physical and spurious modes of the scheme.",
            "id": "3426843",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ posed on a periodic domain with a uniform mesh of cell size $h$, where $a0$ is a constant advection speed. Use the Discontinuous Galerkin (DG) method with polynomial degree $p=1$ on each cell, employing the reference element mapping $x = x_j + \\frac{h}{2}\\,\\xi$ with $\\xi \\in [-1,1]$, and the local basis $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$. Adopt the upwind numerical flux corresponding to $a0$, so the numerical interface value at $x_{j+1/2}$ is the trace from the left element.\n\nStarting from the weak form and using von Neumann (Fourier) analysis with the nondimensional wavenumber $\\theta = k h$ (take $\\theta$ in radians), derive the semi-discrete DG block symbol for this $p=1$ scheme and obtain its eigenvalues as functions of $\\theta$. Express your final answer as the pair of eigenvalues $\\lambda_{\\pm}(\\theta)$ of the semi-discrete operator, written in closed form in terms of $a$, $h$, and $\\theta$. No intermediate results or proofs should appear in the final answer. No rounding is required, and no physical units should be included in the final expression.",
            "solution": "To find the eigenvalues of the semi-discrete operator for the DG(p=1) method, we start with the weak formulation of the linear advection equation, $u_t + a u_x = 0$, on an element $K_j$.\n\n### DG Formulation\nThe DG weak form, after integrating by parts and applying the upwind flux for $a > 0$, is:\n$$ \\int_{K_j} \\frac{\\partial u_j}{\\partial t} v_j \\, dx - \\int_{K_j} a u_j \\frac{\\partial v_j}{\\partial x} \\, dx + a u_j(x_{j+1/2}) v_j(x_{j+1/2}) - a u_{j-1}(x_{j-1/2}) v_j(x_{j-1/2}) = 0 $$\nwhere $u_j$ and $v_j$ are the solution and test functions in element $K_j$. We use the local basis $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$ on the reference element $\\xi \\in [-1,1]$ via the mapping $x(\\xi) = x_j + \\frac{h}{2}\\xi$. The solution in element $j$ is written as $u_j(\\xi, t) = u_{j,0}(t)\\phi_0(\\xi) + u_{j,1}(t)\\phi_1(\\xi)$.\n\nBy choosing $v_j = \\phi_0$ and $v_j = \\phi_1$ as test functions and carrying out the integrations on the reference element, we obtain a system of two ordinary differential equations for the coefficients $\\mathbf{u}_j(t) = \\begin{pmatrix} u_{j,0}(t)  u_{j,1}(t) \\end{pmatrix}^T$. This system couples the degrees of freedom in element $j$ with those in the upwind element $j-1$:\n\\begin{align*} \\dot{u}_{j,0} = -\\frac{a}{h}(u_{j,0}+u_{j,1}) + \\frac{a}{h}(u_{j-1,0}+u_{j-1,1}) \\\\ \\dot{u}_{j,1} = \\frac{3a}{h}(u_{j,0}-u_{j,1}) - \\frac{3a}{h}(u_{j-1,0}+u_{j-1,1}) \\end{align*}\nThis can be written in matrix form as $\\frac{d\\mathbf{u}_j}{dt} = A_0 \\mathbf{u}_j + A_1 \\mathbf{u}_{j-1}$, where:\n$$ A_0 = \\frac{a}{h} \\begin{pmatrix} -1  -1 \\\\ 3  -3 \\end{pmatrix}, \\quad A_1 = \\frac{a}{h} \\begin{pmatrix} 1  1 \\\\ -3  -3 \\end{pmatrix} $$\n\n### Von Neumann Analysis\nWe perform a von Neumann analysis by substituting the plane-wave ansatz $\\mathbf{u}_j(t) = \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta}$ into the semi-discrete system, where $\\theta=kh$ is the non-dimensional wavenumber. This leads to the eigenvalue problem:\n$$ \\lambda \\hat{\\mathbf{u}} = (A_0 + e^{-i\\theta} A_1) \\hat{\\mathbf{u}} $$\nThe matrix $S(\\theta) = A_0 + e^{-i\\theta} A_1$ is the block symbol of the operator. Its eigenvalues $\\lambda(\\theta)$ are the desired eigenvalues. Letting $z = e^{-i\\theta}$, the block symbol is:\n$$ S(\\theta) = \\frac{a}{h} \\left[ \\begin{pmatrix} -1  -1 \\\\ 3  -3 \\end{pmatrix} + z \\begin{pmatrix} 1  1 \\\\ -3  -3 \\end{pmatrix} \\right] = \\frac{a}{h} \\begin{pmatrix} z-1  z-1 \\\\ -3(z-1)  -3(1+z) \\end{pmatrix} $$\nThe characteristic equation for the eigenvalues $\\lambda$ of $S(\\theta)$ is $\\det(S(\\theta) - \\lambda I) = 0$. Let $\\lambda' = \\lambda \\frac{h}{a}$. The characteristic equation for the scaled matrix becomes:\n$$ (\\lambda')^2 + (4+2z)\\lambda' + (6-6z) = 0 $$\nSolving this quadratic equation for $\\lambda'$ yields:\n$$ \\lambda' = \\frac{-(4+2z) \\pm \\sqrt{(4+2z)^2 - 4(6-6z)}}{2} = -2-z \\pm \\sqrt{z^2+10z-2} $$\nSubstituting back $\\lambda = \\frac{a}{h}\\lambda'$ and $z = e^{-i\\theta}$, we obtain the two eigenvalues of the semi-discrete operator:\n$$ \\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -(2+e^{-i\\theta}) \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2} \\right) $$",
            "answer": "$$\\boxed{\\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -(2+e^{-i\\theta}) \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2} \\right)}$$"
        },
        {
            "introduction": "Our final practice synthesizes the concepts of spatial and temporal stability into a single, powerful framework. Real-world simulations rely on sophisticated time-stepping schemes, like Runge-Kutta methods, each with its own stability region. This exercise  challenges you to connect the spectral properties of the DG spatial operator (specifically, how its spectral radius scales with polynomial degree $p$) with the stability constraints of a general explicit time integrator. By deriving the maximum allowable polynomial degree $p_{\\max}$ for a given CFL number, you will develop a deeper appreciation for the practical trade-offs between polynomial order, time-step size, and the choice of numerical flux.",
            "id": "3426857",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a0$ on a periodic domain discretized by a uniform mesh of element size $h$. Within each element, approximate $u$ by polynomials of degree $p$ and use a standard nodal discontinuous Galerkin (DG) method with exact mass and the numerical flux\n$$\nf^{\\ast} = a\\,\\{u\\} - \\frac{\\alpha\\,a}{2}\\,[u],\n$$\nwhere $\\{u\\}$ and $[u]$ denote the average and jump of $u$ across interfaces, respectively, and $\\alpha \\in [0,1]$ is a parameter that interpolates between central flux ($\\alpha=0$) and fully upwind flux ($\\alpha=1$). Time integration is performed by a fixed explicit Runge-Kutta method whose absolute stability region $\\mathcal{S}_{\\mathrm{RK}}$ contains the largest closed disk centered at the origin of radius $r_{\\mathrm{in}}0$.\n\nDefine the Courant–Friedrichs–Lewy (CFL) number $\\nu := a\\,\\Delta t / h$, where $\\Delta t$ is the time step. Let $\\lambda_{\\mathrm{DG},p}(\\theta)$ denote any eigenvalue of the DG semi-discrete operator (as a function of the nondimensional wavenumber $\\theta \\in [-\\pi,\\pi]$ obtained by von Neumann analysis), and define the worst-case nondimensional spectral radius\n$$\n\\rho_{p} := \\max_{\\theta \\in [-\\pi,\\pi]} \\frac{h}{a}\\,|\\lambda_{\\mathrm{DG},p}(\\theta)|.\n$$\nIt is known that there exists a flux-dependent constant $\\kappa(\\alpha) \\geq 1$ such that\n$$\n\\rho_{p} \\leq \\kappa(\\alpha)\\,(2p+1).\n$$\nStarting from the definitions of the absolute stability region and the von Neumann amplification factor, derive the stability requirement on $\\nu$ in terms of $r_{\\mathrm{in}}$, $\\kappa(\\alpha)$, and $p$, and then solve for the largest admissible polynomial degree $p$ (denoted $p_{\\max}$) that guarantees $\\Delta t\\,\\max_{\\theta}|\\lambda_{\\mathrm{DG},p}(\\theta)|$ lies within $\\mathcal{S}_{\\mathrm{RK}}$. Express your final answer as a single closed-form analytic expression for $p_{\\max}$ in terms of $\\nu$, $r_{\\mathrm{in}}$, and $\\kappa(\\alpha)$.\n\nIn your derivation, begin from the fundamental definitions of absolute stability for explicit Runge-Kutta methods and von Neumann stability for linear constant-coefficient schemes. Use the modified wavenumber perspective to justify the scaling of the worst-case spectral radius with $p$, but do not assume any final result without a clear argument. Conclude by briefly discussing, at a conceptual level, how the choice of $\\alpha$ affects $\\kappa(\\alpha)$ and thus the sensitivity of $p_{\\max}$ to flux choices. No numerical evaluation is required, and you should provide the exact analytic expression. No units are required.",
            "solution": "The problem requires the derivation of a stability condition for a discontinuous Galerkin (DG) method and the subsequent determination of the maximum allowable polynomial degree, $p_{\\max}$. The analysis begins with the method of lines, where the partial differential equation is first discretized in space, yielding a system of ordinary differential equations (ODEs), which is then integrated in time.\n\nThe semi-discretization of the linear advection equation, $u_{t} + a\\,u_{x} = 0$, using a DG method results in a system of ODEs of the form:\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}_{\\mathrm{DG},p} \\mathbf{u}\n$$\nwhere $\\mathbf{u}$ is the vector of degrees of freedom representing the polynomial approximation of degree $p$, and $\\mathbf{L}_{\\mathrm{DG},p}$ is the spatial discretization operator. The eigenvalues of this operator, denoted by $\\lambda_{\\mathrm{DG},p}$, depend on the polynomial degree $p$ and the nondimensional wavenumber $\\theta$.\n\nTime integration is performed using an explicit Runge-Kutta (RK) method. The stability of the fully discrete scheme is governed by the interaction between the eigenvalues of the spatial operator and the stability region of the time integrator. An explicit RK method is stable for the test equation $y' = \\lambda y$ if the complex number $z = \\Delta t \\lambda$ lies within the method's absolute stability region, $\\mathcal{S}_{\\mathrm{RK}}$. For the system of ODEs, this condition must hold for all eigenvalues of the operator $\\mathbf{L}_{\\mathrm{DG},p}$. Therefore, for the numerical scheme to be stable, we require:\n$$\n\\Delta t \\lambda_{\\mathrm{DG},p}(\\theta) \\in \\mathcal{S}_{\\mathrm{RK}} \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\nfor all eigenvalues corresponding to the spatial discretization.\n\nThe problem states that the stability region $\\mathcal{S}_{\\mathrm{RK}}$ contains the largest closed disk centered at the origin of radius $r_{\\mathrm{in}}  0$. This means that any complex number $z$ satisfying $|z| \\leq r_{\\mathrm{in}}$ is guaranteed to be in $\\mathcal{S}_{\\mathrm{RK}}$. This provides a sufficient condition for stability:\n$$\n|\\Delta t \\lambda_{\\mathrm{DG},p}(\\theta)| \\leq r_{\\mathrm{in}} \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\nTo ensure this holds for all eigenvalues and all wavenumbers, we must consider the eigenvalue with the largest magnitude (the spectral radius of the operator):\n$$\n\\Delta t \\cdot \\max_{\\theta \\in [-\\pi,\\pi]} |\\lambda_{\\mathrm{DG},p}(\\theta)| \\leq r_{\\mathrm{in}}\n$$\n\nWe can express this condition in terms of the given nondimensional parameters. The CFL number is $\\nu := a\\,\\Delta t / h$, and the worst-case nondimensional spectral radius is $\\rho_{p} := \\max_{\\theta \\in [-\\pi,\\pi]} \\frac{h}{a}\\,|\\lambda_{\\mathrm{DG},p}(\\theta)|$.\nFrom the definition of $\\rho_{p}$, we can write:\n$$\n\\max_{\\theta \\in [-\\pi,\\pi]} |\\lambda_{\\mathrm{DG},p}(\\theta)| = \\frac{a}{h} \\rho_{p}\n$$\nSubstituting this into the stability condition gives:\n$$\n\\Delta t \\left( \\frac{a}{h} \\rho_{p} \\right) \\leq r_{\\mathrm{in}}\n$$\nRearranging the terms on the left side, we identify the CFL number:\n$$\n\\left( \\frac{a \\Delta t}{h} \\right) \\rho_{p} \\leq r_{\\mathrm{in}}\n$$\n$$\n\\nu \\rho_{p} \\leq r_{\\mathrm{in}}\n$$\nThis inequality is a general stability requirement relating the CFL number, the spectral properties of the DG operator, and the stability region of the RK method.\n\nThe problem provides a specific bound for the nondimensional spectral radius: $\\rho_{p} \\leq \\kappa(\\alpha)\\,(2p+1)$, where $\\kappa(\\alpha) \\geq 1$ is a constant that depends on the numerical flux parameter $\\alpha$. To guarantee stability, we can substitute this upper bound into our stability condition, which results in a more restrictive, but sufficient, condition:\n$$\n\\nu \\left( \\kappa(\\alpha)\\,(2p+1) \\right) \\leq r_{\\mathrm{in}}\n$$\nThis is the explicit stability requirement on $\\nu$ in terms of $r_{\\mathrm{in}}$, $\\kappa(\\alpha)$, and $p$.\n\nThe final step is to solve this inequality for the largest admissible polynomial degree, $p$, which we denote by $p_{\\max}$. We rearrange the inequality to isolate $p$:\n$$\n2p+1 \\leq \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)}\n$$\n$$\n2p \\leq \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1\n$$\n$$\np \\leq \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right)\n$$\nSince the polynomial degree $p$ must be a non-negative integer, the largest integer value of $p$ that satisfies this condition is obtained by taking the floor of the expression on the right-hand side. We must also ensure that the result is a valid polynomial degree, i.e., non-negative. The floor function appropriately determines the largest integer.\nThus, the expression for $p_{\\max}$ is:\n$$\np_{\\max} = \\left\\lfloor \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right) \\right\\rfloor\n$$\nThis expression is valid under the assumption that the parameters $\\nu$, $r_{\\mathrm{in}}$, and $\\kappa(\\alpha)$ are such that the argument of the floor function is non-negative, allowing for at least $p=0$.\n\nConceptually, the choice of the flux parameter $\\alpha$ has a significant impact on stability through the constant $\\kappa(\\alpha)$.\nFor $\\alpha=0$, the flux is central and non-dissipative. The eigenvalues of $\\mathbf{L}_{\\mathrm{DG},p}$ lie on the imaginary axis. For this case, the spectral radius of the DG operator is known to be large (scaling as $O(p^2)$ in some norms), which means that $\\kappa(0)$ would be the largest value in the range of $\\kappa(\\alpha)$. A large $\\kappa(\\alpha)$ leads to a small $p_{\\max}$ for a given CFL number $\\nu$, reflecting a stringent stability constraint.\nConversely, for $\\alpha=1$, the flux is fully upwind and introduces numerical dissipation. This dissipation moves the eigenvalues of $\\mathbf{L}_{\\mathrm{DG},p}$ from the imaginary axis into the open left half of the complex plane. This generally reduces the spectral radius (the maximum modulus of the eigenvalues). Consequently, $\\kappa(1)$ is expected to be smaller than $\\kappa(0)$, and the $O(p)$ scaling for the spectral radius given in the problem is more representative of upwind-biased schemes.\nFrom the expression for $p_{\\max}$, we see that it is inversely related to $\\kappa(\\alpha)$. A smaller value of $\\kappa(\\alpha)$ (achieved by increasing $\\alpha$ towards $1$) permits a larger value for $p_{\\max}$ at a fixed CFL number $\\nu$. This illustrates a fundamental trade-off in numerical methods: increasing dissipation (by choosing $\\alpha$ closer to $1$) enhances stability, allowing for higher-order polynomials or larger time steps, but at the cost of reduced accuracy due to the artificial diffusion.",
            "answer": "$$\n\\boxed{\\left\\lfloor \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right) \\right\\rfloor}\n$$"
        }
    ]
}