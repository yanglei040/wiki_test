{
    "hands_on_practices": [
        {
            "introduction": "数值方法的第一个基本要求是相容性，即离散格式在网格尺寸趋于零时是否能收敛到其所要模拟的偏微分方程。检验相容性的核心工具是泰勒级数展开，通过它我们可以量化截断误差——离散算子作用于精确解与真实微分算子作用于精确解之间的差异。本练习 () 将引导你通过泰勒展开，从第一性原理出发，分析一个通用的中心差分格式的截断误差，从而掌握评估任何有限差分格式准确阶数的基本技能。",
            "id": "3373307",
            "problem": "考虑一个足够光滑的函数 $u(x,t)$，对于每个固定的时间 $t$，该函数满足 $u(\\cdot,t) \\in C^{6}(\\mathbb{R})$。设 $\\{x_i\\}_{i \\in \\mathbb{Z}}$ 是一个步长为 $\\Delta x  0$ 的均匀空间网格，并考虑一个 $q$ 点中心有限差分模板（其中 $q = 2m + 1$ 且 $m \\in \\mathbb{N}$），该模板通过以下公式近似空间二阶导数 $u_{xx}(x_i,t)$：\n$$\nD_{xx}^{(q)} u(x_i,t) \\equiv \\frac{1}{\\Delta x^{2}} \\sum_{j=-m}^{m} a_j\\, u(x_i + j \\Delta x, t),\n$$\n其中系数是对称的（即对所有 $j$ 都有 $a_{-j} = a_j$），并且选择这些系数以精确地重现常数和二次多项式，即：\n$$\n\\sum_{j=-m}^{m} a_j = 0, \\quad \\sum_{j=-m}^{m} a_j\\, j = 0, \\quad \\sum_{j=-m}^{m} a_j\\, j^{2} = 2.\n$$\n在固定时间 $t$，使用关于 $x_i$ 的 $x$ 的 Taylor 展开，从第一性原理出发，推导在均匀网格上使用 $D_{xx}^{(q)}$ 近似 $u_{xx}(x_i,t)$ 的局部截断误差。并证明，在上述矩条件下且不施加任何额外的高阶精确性条件时，当 $\\Delta x \\to 0$ 时，截断误差为 $O(\\Delta x^{2})$。以 $\\{a_j\\}_{j=-m}^{m}$ 和 $m$ 的函数的闭式形式，找出乘以 $u_{xxxx}(x_i,t)\\, \\Delta x^{2}$ 的主误差项系数。将您的最终答案表示为单个解析表达式。",
            "solution": "本题的任务是推导给定有限差分模板的局部截断误差，证明其精度阶数，并找出主误差项的系数。推导将从第一性原理出发，使用 Taylor 级数展开。为记法清晰起见，我们将省略对时间 $t$ 的显式依赖，因为所有空间导数都是在固定的时间 $t$ 计算的。我们将 $u(x,t)$ 记为 $u(x)$，并令 $u^{(k)}(x_i)$ 表示 $\\frac{\\partial^k u}{\\partial x^k}(x_i, t)$。\n\n在网格点 $x_i$ 处的局部截断误差 $\\tau_i$ 定义为将有限差分算子应用于精确解的结果，减去其所近似的精确导数：\n$$\n\\tau_i \\equiv D_{xx}^{(q)} u(x_i) - u_{xx}(x_i) = \\frac{1}{\\Delta x^{2}} \\sum_{j=-m}^{m} a_j\\, u(x_i + j \\Delta x) - u^{(2)}(x_i)\n$$\n给定函数 $u$ 足够光滑，具体来说 $u(\\cdot, t) \\in C^{6}(\\mathbb{R})$。这使我们能够对每一项 $u(x_i + j \\Delta x)$ 在点 $x_i$ 周围进行 Taylor 级数展开：\n$$\nu(x_i + j \\Delta x) = \\sum_{k=0}^{\\infty} \\frac{(j \\Delta x)^k}{k!} u^{(k)}(x_i)\n$$\n由于 $u \\in C^{6}$，我们可以写出带有显式余项的展开式。为达此目的，展开到六阶导数是足够的：\n$$\nu(x_i + j \\Delta x) = u(x_i) + j \\Delta x u^{(1)}(x_i) + \\frac{(j \\Delta x)^2}{2!} u^{(2)}(x_i) + \\frac{(j \\Delta x)^3}{3!} u^{(3)}(x_i) + \\frac{(j \\Delta x)^4}{4!} u^{(4)}(x_i) + \\frac{(j \\Delta x)^5}{5!} u^{(5)}(x_i) + \\frac{(j \\Delta x)^6}{6!} u^{(6)}(x_i) + O(\\Delta x^7)\n$$\n将此展开式代入 $D_{xx}^{(q)} u(x_i)$ 的公式中：\n$$\nD_{xx}^{(q)} u(x_i) = \\frac{1}{\\Delta x^{2}} \\sum_{j=-m}^{m} a_j \\left( \\sum_{k=0}^{6} \\frac{(j \\Delta x)^k}{k!} u^{(k)}(x_i) + O(\\Delta x^7) \\right)\n$$\n我们可以交换求和顺序，并按 $u$ 的导数阶数对各项进行重新组合：\n$$\nD_{xx}^{(q)} u(x_i) = \\sum_{k=0}^{6} \\frac{\\Delta x^{k-2}}{k!} u^{(k)}(x_i) \\left( \\sum_{j=-m}^{m} a_j j^k \\right) + O(\\Delta x^5)\n$$\n让我们检查这个和的前几项：\n\\begin{itemize}\n    \\item 对于 $k=0$：$\\frac{1}{\\Delta x^{2}} u(x_i) \\left(\\sum_{j=-m}^{m} a_j\\right)$\n    \\item 对于 $k=1$：$\\frac{1}{\\Delta x} u^{(1)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j\\right)$\n    \\item 对于 $k=2$：$\\frac{1}{2} u^{(2)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^2\\right)$\n    \\item 对于 $k=3$：$\\frac{\\Delta x}{6} u^{(3)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^3\\right)$\n    \\item 对于 $k=4$：$\\frac{\\Delta x^2}{24} u^{(4)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^4\\right)$\n\\end{itemize}\n题目给出了关于系数 $\\{a_j\\}$ 的三个矩条件，这些条件确保了该模板能精确重现最高为2次的多项式：\n\\begin{enumerate}\n    \\item $\\sum_{j=-m}^{m} a_j = 0$\n    \\item $\\sum_{j=-m}^{m} a_j j = 0$\n    \\item $\\sum_{j=-m}^{m} a_j j^{2} = 2$\n\\end{enumerate}\n应用这些条件，展开式的前三项变为：\n\\begin{itemize}\n    \\item $k=0$ 项为 $\\frac{1}{\\Delta x^{2}} u(x_i) \\cdot 0 = 0$。\n    \\item $k=1$ 项为 $\\frac{1}{\\Delta x} u^{(1)}(x_i) \\cdot 0 = 0$。\n    \\item $k=2$ 项为 $\\frac{1}{2} u^{(2)}(x_i) \\cdot 2 = u^{(2)}(x_i)$。\n\\end{itemize}\n将这些结果代回算子的表达式，我们得到：\n$$\nD_{xx}^{(q)} u(x_i) = u^{(2)}(x_i) + \\frac{\\Delta x}{6} u^{(3)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^3\\right) + \\frac{\\Delta x^2}{24} u^{(4)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^4\\right) + \\frac{\\Delta x^3}{120} u^{(5)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^5\\right) + O(\\Delta x^4)\n$$\n现在，我们考虑系数的对称性，$a_{-j} = a_j$。这个性质简化了涉及 $j$ 的奇数次幂的求和。对于任何奇整数 $p \\ge 1$：\n$$\n\\sum_{j=-m}^{m} a_j j^p = a_0 \\cdot 0^p + \\sum_{j=1}^{m} (a_j j^p + a_{-j} (-j)^p) = \\sum_{j=1}^{m} (a_j j^p - a_{-j} j^p)\n$$\n使用 $a_{-j} = a_j$，括号中的项变为 $a_j j^p - a_j j^p = 0$。因此，对于任何奇数 $p$：\n$$\n\\sum_{j=-m}^{m} a_j j^p = 0\n$$\n这适用于我们展开式中 $k=3$ 和 $k=5$ 的项。$u^{(3)}(x_i)$ 的系数为零，$u^{(5)}(x_i)$ 的系数也为零。算子的展开式简化为：\n$$\nD_{xx}^{(q)} u(x_i) = u^{(2)}(x_i) + \\frac{\\Delta x^2}{24} u^{(4)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^4\\right) + \\frac{\\Delta x^4}{720} u^{(6)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^6\\right) + O(\\Delta x^6)\n$$\n于是，局部截断误差 $\\tau_i$ 为：\n$$\n\\tau_i = D_{xx}^{(q)} u(x_i) - u^{(2)}(x_i) = \\frac{\\Delta x^2}{24} u^{(4)}(x_i) \\left(\\sum_{j=-m}^{m} a_j j^4\\right) + O(\\Delta x^4)\n$$\n题目说明没有施加额外的高阶精确性条件。这意味着我们不假设 $\\sum a_j j^4 = 0$。通常情况下，对于一个二阶精度的模板，这个和是不为零的。\n这个结果证明了截断误差为 $O(\\Delta x^2)$，因为主项与 $\\Delta x^2$ 成正比。误差项 $u_{xxxx}(x_i,t)\\,\\Delta x^2$（即 $u^{(4)}(x_i)\\,\\Delta x^2$ 的记法）的系数，是截断误差主项中乘以它的因子。\n从 $\\tau_i$ 的表达式可知，主误差项为 $\\left(\\frac{1}{24} \\sum_{j=-m}^{m} a_j j^4 \\right) u^{(4)}(x_i) \\Delta x^2$。\n因此，所要求的系数是：\n$$\n\\frac{1}{24} \\sum_{j=-m}^{m} a_j j^4\n$$\n这个表达式是关于系数集合 $\\{a_j\\}_{j=-m}^{m}$ 的函数的闭式形式，符合题目要求。",
            "answer": "$$\\boxed{\\frac{1}{24} \\sum_{j=-m}^{m} a_j j^{4}}$$"
        },
        {
            "introduction": "一个相容的格式仅仅是第一步；我们还必须确保其稳定性，即计算过程中引入的误差（如舍入误差）不会无限增长。对于具有周期性边界条件的线性问题，冯·诺依曼稳定性分析是一种强大的工具，它通过考察单个傅里叶模态的增长或衰减来判断格式的稳定性。本练习 () 提供了一个经典的警示案例，它组合了一个无耗散的空间离散格式（傅里叶谱方法）和一个简单的时间推进格式（前向欧拉法），分析将揭示两者性质上的根本性不匹配，从而导致无条件不稳定。",
            "id": "3373430",
            "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，定义在周期性域 $x \\in [0,L]$ 上，其中平流速度 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 为常数。使用 Fourier 谱配置法在 $N$ 个等距节点 $x_{j} = j\\,h$（其中 $j \\in \\{0,1,\\dots,N-1\\}$ 且 $h = L/N$）上对空间进行离散。空间导数由标准 Fourier 伪谱微分矩阵近似，当该矩阵作用于波数为 $\\kappa$ 的离散 Fourier 模时，其效果等同于对所有可解波数乘以 $i\\,\\kappa$。该微分算子是反对称的，并且具有纯虚数特征值，这反映了中心差分的非耗散特性。使用时间步长为 $\\Delta t  0$ 的前向 Euler 法进行时间推进。\n\n从 Fourier 谱配置导数和应用于线性平流方程的前向 Euler 更新的定义出发，推导波数为 $\\kappa$ 的离散 Fourier 模的单步放大因子 $G(\\kappa,\\Delta t)$。基于此放大因子，确定在 $|G(\\kappa,\\Delta t)|1$（对于任意固定的 $\\Delta t0$）意义下导致线性不稳定性的可解波数集合。最后，定义 Courant 数 $\\lambda = a\\,\\Delta t/h$，并确定最大值 $\\lambda_{\\max}$，使得对于所有可解波数和所有 $N \\ge 2$，都有 $|G(\\kappa,\\Delta t)| \\le 1$。请给出 $\\lambda_{\\max}$ 的精确值作为最终答案。无需四舍五入。最终答案必须是一个不带单位的实数。",
            "solution": "该问题要求对一个求解一维线性平流方程的数值格式进行稳定性分析。该格式结合了用于空间离散的 Fourier 谱配置法和用于时间积分的前向 Euler 法。\n\n线性平流方程由下式给出：\n$$\nu_t + a u_x = 0\n$$\n其中 $u=u(x,t)$，$u_t = \\frac{\\partial u}{\\partial t}$，$u_x = \\frac{\\partial u}{\\partial x}$，平流速度 $a$ 是一个非零实常数（$a \\in \\mathbb{R}\\setminus\\{0\\}$）。空间域为 $x \\in [0,L]$，具有周期性边界条件。\n\n我们通过考虑单个 Fourier 模的行为来进行 von Neumann 稳定性分析。一个一般解分量可以表示为平面波：\n$$\nu(x,t) = \\hat{u}_\\kappa(t) e^{i\\kappa x}\n$$\n其中 $\\kappa$ 是波数，$\\hat{u}_\\kappa(t)$ 是该模随时间变化的振幅。\n\n将此形式代入偏微分方程（PDE），我们得到：\n$$\n\\frac{d\\hat{u}_\\kappa(t)}{dt} e^{i\\kappa x} + a \\frac{\\partial}{\\partial x} \\left( \\hat{u}_\\kappa(t) e^{i\\kappa x} \\right) = 0\n$$\n$$\n\\frac{d\\hat{u}_\\kappa(t)}{dt} e^{i\\kappa x} + a (i\\kappa) \\hat{u}_\\kappa(t) e^{i\\kappa x} = 0\n$$\n除以空间部分 $e^{i\\kappa x}$（它永远不为零），我们得到关于模 $\\kappa$ 的振幅的常微分方程（ODE）：\n$$\n\\frac{d\\hat{u}_\\kappa}{dt} = -i a \\kappa \\hat{u}_\\kappa\n$$\n问题陈述，对于空间离散，Fourier 谱配置法的微分算子作用于波数为 $\\kappa$ 的离散 Fourier 模时，其效果等同于乘以 $i\\kappa$。这意味着每个模的半离散系统是上述连续 Fourier 变换方程的精确表示。因此，在网格点 $x_j$ 处，模 $\\kappa$ 的半离散方程确实是上面推导出的常微分方程。\n\n接下来，我们应用前向 Euler 法进行时间推进。对于形式为 $\\frac{dy}{dt} = f(y)$ 的一般常微分方程，前向 Euler 更新为 $y^{n+1} = y^n + \\Delta t f(y^n)$，其中 $\\Delta t$ 是时间步长。\n将此应用于我们关于 $\\hat{u}_\\kappa$ 的特定常微分方程，其中 $f(\\hat{u}_\\kappa) = -i a \\kappa \\hat{u}_\\kappa$，我们得到：\n$$\n\\hat{u}_\\kappa^{n+1} = \\hat{u}_\\kappa^n + \\Delta t (-i a \\kappa \\hat{u}_\\kappa^n)\n$$\n$$\n\\hat{u}_\\kappa^{n+1} = (1 - i a \\kappa \\Delta t) \\hat{u}_\\kappa^n\n$$\n单步放大因子 $G(\\kappa, \\Delta t)$ 是 $n+1$ 时刻的振幅与 $n$ 时刻的振幅之比：\n$$\nG(\\kappa, \\Delta t) = \\frac{\\hat{u}_\\kappa^{n+1}}{\\hat{u}_\\kappa^n} = 1 - i a \\kappa \\Delta t\n$$\n这完成了问题的第一部分。\n\n为使格式线性稳定，对于所有可解波数，放大因子的模必须小于或等于 1，即 $|G(\\kappa, \\Delta t)| \\le 1$。如果 $|G(\\kappa, \\Delta t)|  1$，相应模的振幅将指数增长，导致不稳定性。\n\n让我们计算 $G(\\kappa, \\Delta t)$ 的模。由于 $G$ 是一个形式为 $z = x+iy$ 的复数，其模的平方为 $|z|^2 = x^2+y^2$。这里，$x=1$ 且 $y=-a\\kappa\\Delta t$。\n$$\n|G(\\kappa, \\Delta t)|^2 = |1 - i a \\kappa \\Delta t|^2 = 1^2 + (-a \\kappa \\Delta t)^2 = 1 + (a \\kappa \\Delta t)^2\n$$\n问题要求找出导致不稳定性（定义为 $|G(\\kappa, \\Delta t)|  1$）的可解波数集合。这等价于 $|G(\\kappa, \\Delta t)|^2  1$。\n$$\n1 + (a \\kappa \\Delta t)^2  1\n$$\n$$\n(a \\kappa \\Delta t)^2  0\n$$\n由于 $a$、$\\kappa$ 和 $\\Delta t$ 都是实数，平方 $(a \\kappa \\Delta t)^2$ 总是非负的。它严格为正当且仅当 $a \\kappa \\Delta t \\neq 0$。\n问题指定 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 且 $\\Delta t  0$。因此，对于任何可解的波数 $\\kappa \\neq 0$，都会发生不稳定性。$\\kappa=0$ 的模对应于常数平均分量，对于该分量，$G(0, \\Delta t) = 1$ 且 $|G(0, \\Delta t)| = 1$，因此它是中性稳定的。因此，导致线性不稳定性的可解波数集合是所有非零可解波数的集合。\n\n最后，我们被要求找到 Courant 数 $\\lambda = a \\Delta t/h$ 的最大值，使得该格式对所有可解波数都稳定，即对所有 $\\kappa$ 都有 $|G(\\kappa, \\Delta t)| \\le 1$。\n稳定性条件是 $|G(\\kappa, \\Delta t)|^2 \\le 1$：\n$$\n1 + (a \\kappa \\Delta t)^2 \\le 1\n$$\n这个不等式简化为：\n$$\n(a \\kappa \\Delta t)^2 \\le 0\n$$\n再次，由于 $(a \\kappa \\Delta t)^2$ 是一个实数的平方，它不能是负数。满足此条件的唯一方法是该平方项恰好为零：\n$$\n(a \\kappa \\Delta t)^2 = 0 \\implies a \\kappa \\Delta t = 0\n$$\n对于具有 $N \\ge 2$ 个点的给定网格，此稳定性条件必须对*所有*可解波数 $\\kappa$ 都成立。在长度为 $L$、有 $N$ 个点的周期域上，可解波数的集合包含非零值。例如，基本非零波数是 $\\kappa_1 = 2\\pi/L$。更一般地，波数集合是 $\\kappa_k = k \\frac{2\\pi}{L}$，其中整数 $k$ 直到 Nyquist 频率。由于该条件必须对所有可解的 $\\kappa$ 成立，它必须对离散化中存在的任何非零 $\\kappa$ 成立。对于任何这样的 $\\kappa \\neq 0$，并且给定 $a \\neq 0$ 和 $\\Delta t  0$，乘积 $a \\kappa \\Delta t$ 是非零的。因此，稳定性条件 $a \\kappa \\Delta t = 0$ 被违反了。\n\n该条件对所有波数都成立的唯一方式是，不存在非零波数（这不是一个有效的离散化），或者 $a=0$ 或 $\\Delta t=0$，这两者都被问题陈述所排除。这意味着该格式对于任何 $\\Delta t  0$ 都是无条件不稳定的。\n\n让我们用 Courant 数 $\\lambda = a \\Delta t/h$ 来表示该条件。稳定性条件 $a \\kappa \\Delta t = 0$ 必须成立。\n$$\n\\left(\\frac{a \\Delta t}{h}\\right) (\\kappa h) = 0 \\implies \\lambda (\\kappa h) = 0\n$$\n对于任何具有 $N \\ge 2$ 的网格，都存在一个非零的最大可解波数 $\\kappa_{\\max}$。例如，对于偶数 $N$，$\\kappa_{\\max} = \\pi/h$。为使此格式稳定，该条件必须对 $\\kappa_{\\max}$ 成立，因此 $\\lambda (\\kappa_{\\max} h) = \\lambda \\pi = 0$，这意味着 $\\lambda=0$。\n如果 $\\lambda = 0$，则 $a \\Delta t / h = 0$。由于 $a \\neq 0$ 且 $h  0$，这要求 $\\Delta t=0$，而这是不允许的。然而，问题要求的是使稳定性条件得以满足的 $\\lambda_{\\max}$ 的最大值。条件 $\\lambda (\\kappa h)=0$ 对所有 $\\kappa$ 都满足，当且仅当 $\\lambda=0$。因此，$\\lambda$ 的稳定区域是单点集 $\\{0\\}$。此集合中的最大值是 $0$。\n\n这个结果是数值分析中的一个经典结论：将一个纯非耗散的空间离散格式（如 Fourier 谱方法，其一阶导数算子具有纯虚数特征值）与一个其稳定域未能恰当包含虚轴上一段的（像前向 Euler 法，其稳定域仅在原点处接触虚轴）时间步进格式相结合，会导致求解双曲型方程的方法无条件不稳定。为保证稳定性，所允许的最大 Courant 数为零。\n因此，$\\lambda_{\\max} = 0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "数值方法的最终目标是收敛性：当网格不断加密时，数值解是否趋近于真实的精确解？拉克斯等价定理（Lax Equivalence Theorem）为此提供了关键的联系：对于一个适定的线性问题，一个相容的格式是收敛的，当且仅当它是稳定的。本练习 () 通过构造一个虽然稳定但明显不相容的格式，让你亲身体验为何即使是稳定的格式，如果不满足相容性，也无法收敛到正确的解，从而深刻理解拉克斯等价定理中相容性与稳定性的双重必要性。",
            "id": "3394996",
            "problem": "考虑周期性线性平流初值问题 $u_{t} + a\\,u_{x} = 0$，其中 $x \\in [0,2\\pi]$ 且 $t \\ge 0$，具有周期性边界条件和零初始数据 $u(x,0) = 0$。该问题是适定的，即对于合适范数空间中的任何容许初始数据，都存在唯一解，并且该解连续依赖于初始数据。在谱方法和间断伽辽金（DG）方法的背景下，如果一个线性格式的齐次部分在所选范数下产生有界演化，则称该格式是稳定的；如果将离散算子应用于足够光滑的精确解所产生的残差在网格加密时趋于零，则称该格式是相容的。\n\n构建以下具有 $N$ 个模态（由满足 $|k| \\le K$ 的整数 $k$ 标记，其中 $N = 2K+1$）的傅里叶谱半离散格式：将 $u_{N}(x,t)$ 展开为 $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$，并根据以下方程演化模态系数：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0},\n$$\n其中参数 $a = 1$，强迫振幅 $\\gamma = 1$，$\\delta_{k,0}$ 为克罗内克δ函数。假设对此半离散系统进行精确时间积分。此格式是线性的，其齐次部分对应于斜伴随平流算子的标准傅里叶谱离散化，该离散化在 $L^{2}$ 范数下是保范数的。然而，增加的零模态强迫使得该格式与原始齐次问题不相容。\n\n从上述定义和半离散系统的精确演化出发，运用第一性原理推导，证明该格式是稳定的（即齐次演化保持 $L^{2}$ 范数）但不相容，并解释为何它不收敛到精确解 $u \\equiv 0$。然后，计算当模态数 $N \\to \\infty$ 时，在时间 $t = 1$ 处的 $L^{2}$ 误差的极限：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)}.\n$$\n请以单一闭式解析表达式的形式提供您的最终答案。无需四舍五入。角度（若有）必须以弧度表示。",
            "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n已知条件如下：\n1.  偏微分方程（PDE）是线性平流方程：$u_{t} + a\\,u_{x} = 0$。\n2.  空间域为 $x \\in [0,2\\pi]$，具有周期性边界条件。\n3.  时间域为 $t \\ge 0$。\n4.  初始条件为 $u(x,0) = 0$。\n5.  提出了一个傅里叶谱半离散格式，用于数值解 $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$，其中 $N = 2K+1$。\n6.  模态系数 $\\hat{u}_{k}(t)$ 的演化由常微分方程（ODE）组给出：$\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}$。\n7.  该格式的初始条件与 $u(x,0)=0$ 一致，这意味着对所有 $k$ 都有 $\\hat{u}_{k}(0)=0$。\n8.  参数指定为 $a = 1$ 和 $\\gamma = 1$。\n9.  该初值问题的精确解为 $u(x,t) = 0$，对所有 $x$ 和 $t$ 成立。\n10. 任务是证明该格式是稳定的但不相容，解释由此导致的不收敛性，并计算当 $N \\to \\infty$ 时在 $t=1$ 处的 $L^{2}$ 误差的极限。\n\n该问题在数学上是适定的，内部是一致的，并且直接关系到偏微分方程数值方法的分析，特别是拉克斯-里奇特迈尔等价定理所描述的稳定性、相容性和收敛性之间的相互作用。所构建的格式是一个用于说明相容性重要性的教科书式例子。因此，该问题是有效的。\n\n我们开始求解，求解过程包括三个部分：稳定性与相容性分析、不收敛性解释以及误差计算。\n\n首先，我们分析格式的稳定性。根据问题陈述，稳定性由格式齐次部分的行为决定。给定的半离散格式为：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}\n$$\n移除强迫项 $\\gamma\\,\\delta_{k,0}$ 后得到齐次部分：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}^{h}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}^{h}(t)\n$$\n其中 $\\hat{u}_{k}^{h}(t)$ 表示齐次演化的系数。这个线性常微分方程的解是 $\\hat{u}_{k}^{h}(t) = \\hat{u}_{k}^{h}(0) \\exp(-iakt)$。数值解 $u_{N}(x,t)$ 的 $L^{2}$ 范数通过帕塞瓦尔定理与其傅里叶系数相关联：\n$$\n\\left\\| u_{N}(\\cdot, t) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |u_{N}(x,t)|^{2} dx = 2\\pi \\sum_{|k| \\le K} |\\hat{u}_{k}(t)|^{2}\n$$\n对于齐次演化，我们考察系数模的平方：\n$$\n|\\hat{u}_{k}^{h}(t)|^{2} = \\left| \\hat{u}_{k}^{h}(0) \\exp(-iakt) \\right|^{2} = |\\hat{u}_{k}^{h}(0)|^{2} |\\exp(-iakt)|^{2} = |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n因为对于任意实数 $\\theta$，都有 $|\\exp(i\\theta)|=1$。对所有模态求和，我们得到：\n$$\n\\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(t)|^{2} = \\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n这意味着 $\\left\\| u_{N}^{h}(\\cdot, t) \\right\\|_{L^{2}}^{2} = \\left\\| u_{N}^{h}(\\cdot, 0) \\right\\|_{L^{2}}^{2}$。齐次格式解的 $L^{2}$ 范数在任何时候都是守恒的。保持范数的演化是有界的（算子范数为 $1$）。因此，根据所给定义，该格式是稳定的。\n\n第二，我们分析相容性。如果将偏微分方程的精确解代入数值格式所得到的截断误差（即残差）在离散化加密（$N \\to \\infty$）时趋于零，则称该格式与偏微分方程是相容的。对于 $u(x,0)=0$ 的方程 $u_{t} + a u_{x} = 0$，其精确解为 $u(x,t) = 0$ 对所有 $t \\ge 0$ 成立。精确解的傅里叶系数为 $\\hat{u}_{k,exact}(t) = 0$，对所有 $k$ 和 $t$ 成立。\n我们将这些精确解的系数代入完整的数值格式，以求出每个模态的残差 $\\tau_k(t)$：\n$$\n\\tau_k(t) = \\frac{d}{dt}\\hat{u}_{k,exact}(t) - \\left( -iak\\,\\hat{u}_{k,exact}(t) + \\gamma\\,\\delta_{k,0} \\right)\n$$\n代入 $\\hat{u}_{k,exact}(t) = 0$ 及其时间导数 $\\frac{d}{dt}(0)=0$：\n$$\n\\tau_k(t) = 0 - \\left( -iak \\cdot 0 + \\gamma\\,\\delta_{k,0} \\right) = -\\gamma\\,\\delta_{k,0}\n$$\n当 $\\gamma=1$ 时，残差为 $\\tau_k(t) = -\\delta_{k,0}$。对于 $k=0$ 模态，残差为 $\\tau_0 = -1$，而对于所有其他模态 $k \\neq 0$，残差为 $\\tau_k = 0$。零模态的残差是一个非零常数。它不依赖于模态数 $N$，因此当 $N \\to \\infty$ 时不趋于零。因此，该格式与齐次偏微分方程 $u_t + a u_x = 0$ 不相容。\n\n正如拉克斯-里奇特迈尔等价定理所解释的，不收敛是这种不相容性的直接后果。该定理指出，对于一个适定的线性初值问题，一个相容的线性有限差分格式是收敛的，当且仅当它是稳定的。在这里，格式是稳定的但不是相容的。不满足该定理的收敛条件。该格式实际上是另一个偏微分方程 $u_t + a u_x = F(x)$ 的相容离散化，其中 $F(x)$ 是一个傅里叶系数为 $\\gamma\\,\\delta_{k,0}$ 的函数。这对应于一个空间上恒定的强迫项 $F(x) = \\gamma=1$。该数值格式正在求解一个错误的问题，因此其解不会收敛到目标问题的解。源项 $\\gamma\\,\\delta_{k,0}$ 持续向零模态注入非物理信号，导致数值解偏离真实解 $u=0$。\n\n最后，我们计算在 $t=1$ 处的 $L^{2}$ 误差的极限。我们必须求解具有指定参数 $a=1, \\gamma=1$ 和初始条件 $\\hat{u}_k(0)=0$ 的半离散系统的精确解。该常微分方程组为：\n$$\n\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t) + \\delta_{k,0}\n$$\n我们分两种情况求解。\n情况1：$k \\neq 0$。方程为 $\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t)$。在初始条件 $\\hat{u}_k(0)=0$ 下，唯一解为 $\\hat{u}_{k}(t)=0$ 对所有 $t$ 成立。\n情况2：$k=0$。方程为 $\\frac{d}{dt}\\hat{u}_{0}(t) = -i(0)\\hat{u}_{0}(t) + 1$，简化为 $\\frac{d}{dt}\\hat{u}_{0}(t) = 1$。从 $0$ 到 $t$ 积分得到 $\\hat{u}_{0}(t) - \\hat{u}_{0}(0) = \\int_0^t 1 ds = t$。因为 $\\hat{u}_{0}(0)=0$，我们有 $\\hat{u}_{0}(t)=t$。\n\n因此，数值解的系数为 $\\hat{u}_{k}(t) = t\\,\\delta_{k,0}$。物理空间中的数值解为：\n$$\nu_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(ikx) = \\hat{u}_{0}(t)\\exp(i \\cdot 0 \\cdot x) = t\n$$\n解 $u_{N}(x,t)=t$ 是一个随时间线性增长的空间常数函数。该解对任何 $N \\ge 1$（即 $K \\ge 0$）都有效。\n\n误差为 $e_{N}(x,t) = u_{N}(x,t) - u(x,t) = t - 0 = t$。\n我们被要求计算时间 $t=1$ 时误差的 $L^{2}$ 范数。此时的误差为 $e_N(x,1) = 1$。\n误差的 $L^{2}$ 范数的平方为：\n$$\n\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |e_{N}(x,1)|^{2} dx = \\int_{0}^{2\\pi} |1|^{2} dx = \\int_{0}^{2\\pi} 1 dx = 2\\pi\n$$\n因此，在 $t=1$ 时误差的 $L^{2}$ 范数为 $\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}$。\n\n这个结果与 $N$ 无关。因此，当 $N \\to \\infty$ 时的极限是相同的值：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}\n$$\n这个非零极限证实了该格式不收敛到精确解。",
            "answer": "$$\n\\boxed{\\sqrt{2\\pi}}\n$$"
        }
    ]
}