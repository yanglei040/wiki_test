{
    "hands_on_practices": [
        {
            "introduction": "Sturm-Liouville特征值问题是数学物理中的一个经典问题，它可以描述弦振动或量子能级等现象。本练习将引导你一步步地将谱Bubnov-Galerkin方法应用于此问题。通过构造合适的基函数并组装离散系统，你将计算出特征值的近似值，并亲身体验该方法在自伴问题中的应用，这种情况下它是自然且高效的选择。",
            "id": "3368169",
            "problem": "考虑对称区间上具有齐次狄利克雷边界条件的一维拉普拉斯算子的斯图姆-刘维尔特征值问题：\n寻找非平凡的 $u \\in H_{0}^{1}(-1,1)$ 和 $\\lambda \\in \\mathbb{R}$ 使得\n$$\n- u''(x) = \\lambda\\, u(x), \\quad x \\in (-1,1), \\qquad u(-1)=u(1)=0.\n$$\n精确谱为 $\\lambda_{n}^{\\star} = \\left(\\frac{n\\pi}{2}\\right)^{2}$ (对于 $n \\in \\mathbb{N}$)，因此前两个精确特征值为 $\\lambda_{1}^{\\star} = \\pi^{2}/4$ 和 $\\lambda_{2}^{\\star} = \\pi^{2}$。\n\n使用勒让德谱布勃诺夫-伽辽金离散化方法，其多项式试验空间为 $\\mathbb{P}_{3}^{0} := \\{ p \\in \\mathbb{P}_{3} : p(\\pm 1)=0\\}$，按以下步骤进行：\n- 从格林恒等式和狄利克雷边界条件推导出的弱形式出发。\n- 为试验空间选择模态勒让德基函数，给定为 $\\phi_{0}(x) = L_{2}(x)-L_{0}(x)$ 和 $\\phi_{1}(x) = L_{3}(x)-L_{1}(x)$，其中 $L_{n}(x)$ 表示归一化为 $L_{n}(1)=1$ 的 $n$ 次勒让德多项式。\n- 组装刚度矩阵 $K$（其元素为 $K_{ij} = \\int_{-1}^{1} \\phi'_{i}(x)\\,\\phi'_{j}(x)\\,dx$）和质量矩阵 $M$（其元素为 $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$）。\n- 求解得到的 $2\\times 2$ 广义特征值问题 $K \\mathbf{a} = \\lambda_{h}\\, M \\mathbf{a}$，以获得前两个特征值的两个瑞利-里兹近似值 $\\lambda_{h,1}$ 和 $\\lambda_{h,2}$。\n\n此外，鉴于双线性形式的自伴性质，简要论证对于此问题，使用相同的两个边界消失的测试函数的彼得罗夫-伽辽金选择是否会导致不同的离散谱。\n\n定义无量纲量\n$$\n\\Pi := \\left(\\frac{\\lambda_{h,1}}{\\pi^{2}/4}\\right)\\left(\\frac{\\lambda_{h,2}}{\\pi^{2}}\\right).\n$$\n精确计算 $\\Pi$，并将最终答案表示为关于 $\\pi$ 的封闭形式解析表达式。不要提供中间数值近似。最终答案必须是单个表达式。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是适定的、客观的，提出了一个微分方程数值分析中的标准问题。所有必要信息均已提供，没有矛盾或含糊之处。\n\n问题要求使用勒让德谱布勃诺夫-伽辽金方法求解一个斯图姆-刘维尔特征值问题。问题是寻找非平凡的 $u \\in H_{0}^{1}(-1,1)$ 和 $\\lambda \\in \\mathbb{R}$ 使得：\n$$\n- u''(x) = \\lambda\\, u(x), \\quad x \\in (-1,1), \\qquad u(-1)=u(1)=0.\n$$\n首先，我们推导弱形式。我们将微分方程乘以一个测试函数 $v \\in H_{0}^{1}(-1,1)$ 并在定义域 $(-1,1)$ 上积分：\n$$\n-\\int_{-1}^{1} u''(x)v(x) \\,dx = \\lambda \\int_{-1}^{1} u(x)v(x) \\,dx.\n$$\n对左侧应用分部积分法（格林第一恒等式）得到：\n$$\n\\int_{-1}^{1} u'(x)v'(x) \\,dx - \\left[u'(x)v(x)\\right]_{-1}^{1} = \\lambda \\int_{-1}^{1} u(x)v(x) \\,dx.\n$$\n由于测试函数 $v$ 属于 $H_{0}^{1}(-1,1)$，它满足齐次狄利克雷边界条件 $v(-1)=v(1)=0$。因此，边界项消失。弱形式为：寻找 $u \\in H_{0}^{1}(-1,1)$ 和 $\\lambda \\in \\mathbb{R}$ 使得\n$$\na(u,v) = \\lambda (u,v)_{L^2} \\qquad \\forall v \\in H_{0}^{1}(-1,1),\n$$\n其中 $a(u,v) := \\int_{-1}^{1} u'(x)v'(x) \\,dx$ 是一个对称双线性形式，而 $(u,v)_{L^2} := \\int_{-1}^{1} u(x)v(x) \\,dx$ 是 $L^2$ 内积。\n\n对于布勃诺夫-伽辽金方法，我们在有限维试验空间 $\\mathbb{P}_{3}^{0} = \\{ p \\in \\mathbb{P}_{3} : p(\\pm 1)=0\\}$ 中寻求近似解 $u_h(x)$。近似解表示为基函数的线性组合，$u_h(x) = \\sum_{j=0}^{1} a_j \\phi_j(x)$。测试函数从同一空间中选择。给定的基函数是 $\\phi_{0}(x) = L_{2}(x)-L_{0}(x)$ 和 $\\phi_{1}(x) = L_{3}(x)-L_{1}(x)$，其中 $L_n(x)$ 是归一化为 $L_n(1)=1$ 的勒让德多项式。它们是：\n$L_0(x) = 1$\n$L_1(x) = x$\n$L_2(x) = \\frac{1}{2}(3x^2-1)$\n$L_3(x) = \\frac{1}{2}(5x^3-3x)$\n我们已在问题验证阶段确认这些基函数满足所需的边界条件，即对于 $i=0,1$，有 $\\phi_i(\\pm 1)=0$。\n\n布勃诺夫-伽辽金方法导出广义矩阵特征值问题 $K \\mathbf{a} = \\lambda_{h} M \\mathbf{a}$，其中 $\\mathbf{a}$ 是系数向量 $[a_0, a_1]^T$，刚度矩阵 $K$ 和质量矩阵 $M$ 的元素为：\n$K_{ij} = a(\\phi_j, \\phi_i) = \\int_{-1}^{1} \\phi'_{j}(x)\\phi'_{i}(x)\\,dx$\n$M_{ij} = (\\phi_j, \\phi_i)_{L^2} = \\int_{-1}^{1} \\phi_{j}(x)\\phi_{i}(x)\\,dx$\n\n我们计算基函数的导数：\n$\\phi'_{0}(x) = L'_{2}(x) - L'_{0}(x) = 3x - 0 = 3x$\n$\\phi'_{1}(x) = L'_{3}(x) - L'_{1}(x) = \\frac{1}{2}(15x^2 - 3) - 1 = \\frac{15}{2}x^2 - \\frac{5}{2}$\n\n现在，我们组装刚度矩阵 $K$：\n$K_{00} = \\int_{-1}^{1} (3x)^2 \\,dx = 9 \\int_{-1}^{1} x^2 \\,dx = 9 \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = 9\\left(\\frac{2}{3}\\right) = 6$。\n$K_{11} = \\int_{-1}^{1} \\left(\\frac{15}{2}x^2 - \\frac{5}{2}\\right)^2 \\,dx = \\frac{25}{4} \\int_{-1}^{1} (3x^2 - 1)^2 \\,dx = \\frac{25}{4} \\int_{-1}^{1} (9x^4 - 6x^2 + 1) \\,dx = \\frac{25}{4} \\left[9\\frac{x^5}{5} - 6\\frac{x^3}{3} + x\\right]_{-1}^{1} = \\frac{25}{4} \\cdot 2\\left(\\frac{9}{5} - 2 + 1\\right) = \\frac{25}{2}\\left(\\frac{4}{5}\\right) = 10$。\n$K_{01} = K_{10} = \\int_{-1}^{1} (3x)\\left(\\frac{15}{2}x^2 - \\frac{5}{2}\\right) \\,dx = \\int_{-1}^{1} \\left(\\frac{45}{2}x^3 - \\frac{15}{2}x\\right) \\,dx = 0$，因为被积函数是在对称区间上积分的奇函数。\n因此，刚度矩阵是 $K = \\begin{pmatrix} 6 & 0 \\\\ 0 & 10 \\end{pmatrix}$。\n\n接下来，我们组装质量矩阵 $M$。我们使用勒让德多项式的正交性：$\\int_{-1}^{1} L_m(x)L_n(x)\\,dx = \\frac{2}{2n+1}\\delta_{mn}$。\n$M_{00} = \\int_{-1}^{1} (\\phi_0(x))^2 \\,dx = \\int_{-1}^{1} (L_2(x)-L_0(x))^2 \\,dx = \\int_{-1}^{1} (L_2^2 - 2L_2L_0 + L_0^2) \\,dx$。由于正交性，$\\int L_2L_0 \\,dx = 0$。\n$M_{00} = \\int_{-1}^{1} L_2^2 \\,dx + \\int_{-1}^{1} L_0^2 \\,dx = \\frac{2}{2(2)+1} + \\frac{2}{2(0)+1} = \\frac{2}{5} + 2 = \\frac{12}{5}$。\n$M_{11} = \\int_{-1}^{1} (\\phi_1(x))^2 \\,dx = \\int_{-1}^{1} (L_3(x)-L_1(x))^2 \\,dx = \\int_{-1}^{1} L_3^2 \\,dx + \\int_{-1}^{1} L_1^2 \\,dx = \\frac{2}{2(3)+1} + \\frac{2}{2(1)+1} = \\frac{2}{7} + \\frac{2}{3} = \\frac{6+14}{21} = \\frac{20}{21}$。\n$M_{01} = M_{10} = \\int_{-1}^{1} (L_2(x)-L_0(x))(L_3(x)-L_1(x)) \\,dx = 0$，由于不同奇偶性的勒让德多项式的正交性。\n因此，质量矩阵是 $M = \\begin{pmatrix} 12/5 & 0 \\\\ 0 & 20/21 \\end{pmatrix}$。\n\n矩阵 $K$ 和 $M$ 是对角矩阵，因为所选的基函数具有确定的奇偶性（偶/奇），这将问题分离为两个解耦的子问题，分别对应于偶特征函数和奇特征函数。偶基函数 $\\phi_0(x)$ 近似连续问题的第一个（偶）特征函数，奇基函数 $\\phi_1(x)$ 近似第二个（奇）特征函数。\n广义特征值问题 $K \\mathbf{a} = \\lambda_h M \\mathbf{a}$ 简化为：\n$\\lambda_{h,1} = \\frac{K_{00}}{M_{00}} = \\frac{6}{12/5} = \\frac{30}{12} = \\frac{5}{2}$。\n$\\lambda_{h,2} = \\frac{K_{11}}{M_{11}} = \\frac{10}{20/21} = \\frac{210}{20} = \\frac{21}{2}$。\n这些是前两个特征值的瑞利-里兹近似值。\n\n关于彼得罗夫-伽辽金方法，其定义性特征是使用不同于试验空间 $V_h$ 的测试空间 $W_h$。问题中提到“使用相同的两个边界消失的测试函数的彼得罗夫-伽辽金选择”。这意味着使用的测试空间由 $\\{\\phi_0, \\phi_1\\}$ 张成，这与试验空间 $V_h = \\text{span}\\{\\phi_0, \\phi_1\\}$ 相同。当测试空间与试验空间相同时（$W_h=V_h$），该方法根据定义就是布勃诺夫-伽辽金方法。因此，得到的离散谱将是相同的。对于像这样的自伴问题，对称双线性形式 $a(u,v)$ 使得布勃诺夫-伽辽金方法成为自然选择，它保证了特征值为实数，并且是真实特征值的上界（瑞利-里兹原理）。一个真正的彼得罗夫-伽辽金方法（$W_h \\neq V_h$）通常会导致非对称矩阵和不同的、次优的离散谱。\n\n最后，我们计算无量纲量 $\\Pi$：\n$$\n\\Pi := \\left(\\frac{\\lambda_{h,1}}{\\pi^{2}/4}\\right)\\left(\\frac{\\lambda_{h,2}}{\\pi^{2}}\\right)\n$$\n代入计算出的特征值 $\\lambda_{h,1} = 5/2$ 和 $\\lambda_{h,2} = 21/2$：\n$$\n\\Pi = \\left(\\frac{5/2}{\\pi^{2}/4}\\right)\\left(\\frac{21/2}{\\pi^{2}}\\right) = \\left(\\frac{5}{2} \\cdot \\frac{4}{\\pi^2}\\right)\\left(\\frac{21}{2\\pi^2}\\right) = \\left(\\frac{10}{\\pi^2}\\right)\\left(\\frac{21}{2\\pi^2}\\right) = \\frac{210}{2\\pi^4} = \\frac{105}{\\pi^4}.\n$$",
            "answer": "$$\\boxed{\\frac{105}{\\pi^4}}$$"
        },
        {
            "introduction": "虽然Bubnov-Galerkin方法是自伴问题的最优选择，但在其他情况下，测试函数的选取则更为微妙。本练习探讨了Petrov-Galerkin格式如何影响离散系统的基本属性，特别是质量矩阵的对称性。你将看到这一选择如何与确保时间相关模拟稳定性的实际挑战联系起来，这需要基于系统离散能量进行分析。",
            "id": "3368113",
            "problem": "考虑一维参考单元 $\\Omega = [-1,1]$ 以及一个二维多项式逼近空间。令试探基为 $\\{\\phi_{0}(x),\\phi_{1}(x)\\} = \\{1,x\\}$。使用相同的两点对称求积法定义两种 Galerkin 变体：\n- 求积节点位于 $x=\\pm \\xi$，其中 $0  \\xi \\leq 1$，且每个节点的权重均为 $1$。因此，对于任意被积函数 $g(x)$，其求积近似为 $\\int_{-1}^{1} g(x)\\,\\mathrm{d}x \\approx g(\\xi)+g(-\\xi)$。\n- Bubnov Galerkin 法使用与试探基相同的检验基，即 $\\{\\psi_{0}(x),\\psi_{1}(x)\\} = \\{1,x\\}$。\n- Petrov Galerkin 法使用非正交检验基 $\\{\\psi_{0}(x),\\psi_{1}(x)\\} = \\{1,x+\\alpha\\}$，其中 $\\alpha\\in\\mathbb{R}$ 为一个实数参数。\n\n设半离散系统通过双线性形式 $a(u,v) = \\kappa\\int_{-1}^{1} u_{x} v_{x}\\,\\mathrm{d}x$ 来近似一个扩散过程，该过程的扩散系数为 $\\kappa0$。此双线性形式使用上述相同的求积方法进行离散。用 $M$ 表示离散质量矩阵，其元素为 $M_{ij} = \\sum_{q} w_{q}\\,\\psi_{i}(x_{q})\\,\\phi_{j}(x_{q})$；用 $C$ 表示离散刚度矩阵，其元素为 $C_{ij} = \\sum_{q} w_{q}\\,\\kappa\\,\\phi_{j}'(x_{q})\\,\\psi_{i}'(x_{q})$。考虑半离散常微分方程 $M\\,\\dot{\\boldsymbol{u}}(t) = -\\,C\\,\\boldsymbol{u}(t)$。\n\n任务：\n1. 从以上定义出发，推导 Bubnov Galerkin 质量矩阵 $M^{B}$，并根据 $\\xi$ 说明其何时是对称正定的。计算相关的刚度矩阵 $C^{B}$。\n2. 对于 Petrov Galerkin 情况，推导质量矩阵 $M^{P}$ 及其对称部分 $M^{\\mathrm{sym}} = \\tfrac{1}{2}\\left(M^{P} + (M^{P})^{\\top}\\right)$。陈述使 $M^{\\mathrm{sym}}$ 成为对称正定矩阵的关于 $\\alpha$ 和 $\\xi$ 的充分必要条件。\n3. 假设对对称化的 Petrov 系统 $M^{\\mathrm{sym}}\\,\\dot{\\boldsymbol{u}}(t) = -\\,C^{P}\\,\\boldsymbol{u}(t)$ 应用显式前向欧拉法。使用基于 $M^{\\mathrm{sym}}$ 导出内积的能量法，推导能够保证每一步的离散能量 $E(\\boldsymbol{u}) = \\tfrac{1}{2}\\,\\boldsymbol{u}^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}$ 不增加的最大允许时间步长 $\\Delta t_{\\max}$。将最终答案表示为关于 $\\kappa$、$\\xi$ 和 $\\alpha$ 的闭式解析表达式。以与 $t$ 相同的时间单位给出 $\\Delta t_{\\max}$ 的结果。\n\n你的最终答案必须是 $\\Delta t_{\\max}$ 的一个单一闭式解析表达式。",
            "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于微分方程数值方法的理论，特别是谱方法和间断 Galerkin 方法。该问题是适定的、客观的、自洽的，并且所有术语都经过了形式化定义。不存在不一致、矛盾或不切实际的假设。因此，我们可以开始解答。\n\n该问题分为三个任务。我们将按顺序解决它们。\n\n基本要素如下：\n- 区域 $\\Omega = [-1, 1]$。\n- 试探基函数 $\\{\\phi_{0}(x), \\phi_{1}(x)\\} = \\{1, x\\}$，其导数为 $\\{\\phi_{0}'(x), \\phi_{1}'(x)\\} = \\{0, 1\\}$。\n- 两点对称求积法则，节点为 $x_q \\in \\{\\xi, -\\xi\\}$，权重为 $w_q=1$。求积近似为 $\\int_{-1}^{1} g(x)\\,\\mathrm{d}x \\approx g(\\xi) + g(-\\xi)$。参数 $\\xi$ 满足 $0  \\xi \\leq 1$。\n\n**任务1：Bubnov-Galerkin 分析**\n在 Bubnov-Galerkin 方法中，检验基与试探基相同：$\\{\\psi_{0}(x), \\psi_{1}(x)\\} = \\{1, x\\}$。其导数为 $\\{\\psi_{0}'(x), \\psi_{1}'(x)\\} = \\{0, 1\\}$。\n\n离散质量矩阵 $M^B$ 的元素为 $M_{ij}^{B} = \\sum_{q} w_{q}\\,\\psi_{i}(x_{q})\\,\\phi_{j}(x_{q}) = \\psi_{i}(\\xi)\\phi_{j}(\\xi) + \\psi_{i}(-\\xi)\\phi_{j}(-\\xi)$。\n- $M_{00}^{B} = \\psi_{0}(\\xi)\\phi_{0}(\\xi) + \\psi_{0}(-\\xi)\\phi_{0}(-\\xi) = (1)(1) + (1)(1) = 2$。\n- $M_{01}^{B} = \\psi_{0}(\\xi)\\phi_{1}(\\xi) + \\psi_{0}(-\\xi)\\phi_{1}(-\\xi) = (1)(\\xi) + (1)(-\\xi) = 0$。\n- $M_{10}^{B} = \\psi_{1}(\\xi)\\phi_{0}(\\xi) + \\psi_{1}(-\\xi)\\phi_{0}(-\\xi) = (\\xi)(1) + (-\\xi)(1) = 0$。\n- $M_{11}^{B} = \\psi_{1}(\\xi)\\phi_{1}(\\xi) + \\psi_{1}(-\\xi)\\phi_{1}(-\\xi) = (\\xi)(\\xi) + (-\\xi)(-\\xi) = \\xi^2 + \\xi^2 = 2\\xi^2$。\nBubnov-Galerkin 质量矩阵为 $M^{B} = \\begin{pmatrix} 2  0 \\\\ 0  2\\xi^2 \\end{pmatrix}$。\n要使 $M^{B}$ 为对称正定 (SPD)，它必须是对称的，并且其所有特征值都必须为正。由于 $M^{B}$ 是一个对角矩阵，它是对称的，其特征值即为对角线上的元素。正定性的条件是 $2  0$ 和 $2\\xi^2  0$。第一个条件恒成立。由于问题规定 $0  \\xi \\leq 1$，我们有 $\\xi \\neq 0$，这意味着 $\\xi^2  0$。因此，对于所有允许的 $\\xi$ 值，$M^B$ 都是对称正定的。\n\n离散刚度矩阵 $C^B$ 的元素为 $C_{ij}^{B} = \\sum_{q} w_{q}\\,\\kappa\\,\\phi_{j}'(x_{q})\\,\\psi_{i}'(x_{q}) = \\kappa(\\phi_{j}'(\\xi)\\psi_{i}'(\\xi) + \\phi_{j}'(-\\xi)\\psi_{i}'(-\\xi))$。\n- $C_{00}^{B} = \\kappa(\\phi_{0}'(\\xi)\\psi_{0}'(\\xi) + \\phi_{0}'(-\\xi)\\psi_{0}'(-\\xi)) = \\kappa((0)(0) + (0)(0)) = 0$。\n- $C_{01}^{B} = \\kappa(\\phi_{1}'(\\xi)\\psi_{0}'(\\xi) + \\phi_{1}'(-\\xi)\\psi_{0}'(-\\xi)) = \\kappa((1)(0) + (1)(0)) = 0$。\n- $C_{10}^{B} = \\kappa(\\phi_{0}'(\\xi)\\psi_{1}'(\\xi) + \\phi_{0}'(-\\xi)\\psi_{1}'(-\\xi)) = \\kappa((0)(1) + (0)(1)) = 0$。\n- $C_{11}^{B} = \\kappa(\\phi_{1}'(\\xi)\\psi_{1}'(\\xi) + \\phi_{1}'(-\\xi)\\psi_{1}'(-\\xi)) = \\kappa((1)(1) + (1)(1)) = 2\\kappa$。\nBubnov-Galerkin 刚度矩阵为 $C^{B} = \\begin{pmatrix} 0  0 \\\\ 0  2\\kappa \\end{pmatrix}$。\n\n**任务2：Petrov-Galerkin 分析**\n在这种情况下，检验基为 $\\{\\psi_{0}(x), \\psi_{1}(x)\\} = \\{1, x+\\alpha\\}$。其导数为 $\\{\\psi_{0}'(x), \\psi_{1}'(x)\\} = \\{0, 1\\}$，与 Bubnov-Galerkin 情况相同。\n\nPetrov-Galerkin 质量矩阵 $M^P$ 的元素为 $M^P_{ij} = \\psi_{i}(\\xi)\\phi_{j}(\\xi) + \\psi_{i}(-\\xi)\\phi_{j}(-\\xi)$。\n- $M_{00}^{P} = \\psi_{0}(\\xi)\\phi_{0}(\\xi) + \\psi_{0}(-\\xi)\\phi_{0}(-\\xi) = (1)(1) + (1)(1) = 2$。\n- $M_{01}^{P} = \\psi_{0}(\\xi)\\phi_{1}(\\xi) + \\psi_{0}(-\\xi)\\phi_{1}(-\\xi) = (1)(\\xi) + (1)(-\\xi) = 0$。\n- $M_{10}^{P} = \\psi_{1}(\\xi)\\phi_{0}(\\xi) + \\psi_{1}(-\\xi)\\phi_{0}(-\\xi) = (\\xi+\\alpha)(1) + (-\\xi+\\alpha)(1) = 2\\alpha$。\n- $M_{11}^{P} = \\psi_{1}(\\xi)\\phi_{1}(\\xi) + \\psi_{1}(-\\xi)\\phi_{1}(-\\xi) = (\\xi+\\alpha)(\\xi) + (-\\xi+\\alpha)(-\\xi) = \\xi^2 + \\alpha\\xi + \\xi^2 - \\alpha\\xi = 2\\xi^2$。\nPetrov-Galerkin 质量矩阵为 $M^{P} = \\begin{pmatrix} 2  0 \\\\ 2\\alpha  2\\xi^2 \\end{pmatrix}$。\n\n$M^P$ 的对称部分是 $M^{\\mathrm{sym}} = \\frac{1}{2}(M^P + (M^P)^{\\top})$。\n$M^{\\mathrm{sym}} = \\frac{1}{2} \\left( \\begin{pmatrix} 2  0 \\\\ 2\\alpha  2\\xi^2 \\end{pmatrix} + \\begin{pmatrix} 2  2\\alpha \\\\ 0  2\\xi^2 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 4  2\\alpha \\\\ 2\\alpha  4\\xi^2 \\end{pmatrix} = \\begin{pmatrix} 2  \\alpha \\\\ \\alpha  2\\xi^2 \\end{pmatrix}$。\n根据 Sylvester 准则，要使 $M^{\\mathrm{sym}}$ 为对称正定，其所有顺序主子式必须为正。\n1. 一阶主子式为 $2  0$，恒成立。\n2. 二阶主子式是其行列式：$\\det(M^{\\mathrm{sym}}) = (2)(2\\xi^2) - (\\alpha)(\\alpha) = 4\\xi^2 - \\alpha^2$。\n该值必须为正：$4\\xi^2 - \\alpha^2  0$，这意味着 $4\\xi^2  \\alpha^2$。两边取平方根得到 $2|\\xi|  |\\alpha|$。由于 $0  \\xi \\leq 1$，这可以简化为 $2\\xi  |\\alpha|$，或 $-2\\xi  \\alpha  2\\xi$。这是 $M^{\\mathrm{sym}}$ 为对称正定的充分必要条件。\n\n**任务3：稳定性分析**\n我们分析对称化系统 $M^{\\mathrm{sym}}\\,\\dot{\\boldsymbol{u}}(t) = -\\,C^{P}\\,\\boldsymbol{u}(t)$。刚度矩阵 $C^P$ 使用 PG 检验基的导数计算。如前所示，$\\{\\psi'_0, \\psi'_1\\} = \\{0, 1\\}$，这与 BG 情况相同。因此，$C^P = C^B = \\begin{pmatrix} 0  0 \\\\ 0  2\\kappa \\end{pmatrix}$。\n\n显式前向欧拉法应用于 $\\dot{\\boldsymbol{y}} = \\boldsymbol{f}(\\boldsymbol{y})$ 的形式为 $\\boldsymbol{y}^{n+1} = \\boldsymbol{y}^n + \\Delta t \\, \\boldsymbol{f}(\\boldsymbol{y}^n)$。对于我们的系统，$\\dot{\\boldsymbol{u}} = -(M^{\\mathrm{sym}})^{-1}C^P\\boldsymbol{u}$，因此更新规则为：\n$\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^n - \\Delta t (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n$。\n\n离散能量为 $E(\\boldsymbol{u}) = \\frac{1}{2}\\,\\boldsymbol{u}^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}$。稳定性条件是能量不增，即 $E(\\boldsymbol{u}^{n+1}) \\leq E(\\boldsymbol{u}^n)$。\n$(\\boldsymbol{u}^{n+1})^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^{n+1} \\leq (\\boldsymbol{u}^{n})^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^{n}$。\n将 $\\boldsymbol{u}^{n+1}$ 的更新规则代入：\n$(\\boldsymbol{u}^n - \\Delta t (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} (\\boldsymbol{u}^n - \\Delta t (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n) \\leq (\\boldsymbol{u}^{n})^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^{n}$。\n展开左侧 (LHS)：\nLHS $= (\\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^n - \\Delta t (\\boldsymbol{u}^n)^{\\top} (C^P)^{\\top} (M^{\\mathrm{sym}})^{-1} M^{\\mathrm{sym}} \\boldsymbol{u}^n - \\Delta t (\\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n + (\\Delta t)^2 (\\boldsymbol{u}^n)^{\\top} (C^P)^{\\top} (M^{\\mathrm{sym}})^{-1} M^{\\mathrm{sym}} (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n$。\n由于 $M^{\\mathrm{sym}}$ 和 $C^P$ 是对称的，上式简化为：\nLHS $= (\\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^n - 2\\Delta t (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n + (\\Delta t)^2 (\\boldsymbol{u}^n)^{\\top} C^P (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n$。\n稳定性不等式变为：\n$-2\\Delta t (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n + (\\Delta t)^2 (\\boldsymbol{u}^n)^{\\top} C^P (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n \\leq 0$。\n这个不等式必须对任意向量 $\\boldsymbol{u}^n$ 成立。如果 $\\boldsymbol{u}^n$ 在 $C^P$ 的零空间中，不等式变为 $0 \\leq 0$，自然满足。对于任何不在 $C^P$ 零空间中的 $\\boldsymbol{u}^n$，我们可以除以 $(\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n$（该项为正，因为 $C^P$ 是半正定的且 $\\boldsymbol{u}^n$ 不在其零空间中），并重新整理以得到关于 $\\Delta t$ 的界：\n$\\Delta t \\leq \\frac{2 (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n}{(\\boldsymbol{u}^n)^{\\top} C^P (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n}$。\n\n为了找到最严格的时间步长限制，我们必须找到右侧表达式对于所有不在 $C^P$ 零空间中的 $\\boldsymbol{u}^n$ 的最小值。\n令 $\\boldsymbol{u}^n = (u_0, u_1)^{\\top}$。\n分子是 $2 (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n = 2 \\begin{pmatrix} u_0  u_1 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  2\\kappa \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\end{pmatrix} = 4\\kappa u_1^2$。\n对于分母，我们首先求 $(M^{\\mathrm{sym}})^{-1}$：\n$(M^{\\mathrm{sym}})^{-1} = \\frac{1}{\\det(M^{\\mathrm{sym}})} \\begin{pmatrix} 2\\xi^2  -\\alpha \\\\ -\\alpha  2 \\end{pmatrix} = \\frac{1}{4\\xi^2 - \\alpha^2} \\begin{pmatrix} 2\\xi^2  -\\alpha \\\\ -\\alpha  2 \\end{pmatrix}$。\n并且我们计算 $C^P \\boldsymbol{u}^n = \\begin{pmatrix} 0 \\\\ 2\\kappa u_1 \\end{pmatrix}$。\n分母项是 $(C^P \\boldsymbol{u}^n)^{\\top} (M^{\\mathrm{sym}})^{-1} (C^P \\boldsymbol{u}^n)$：\n$= \\begin{pmatrix} 0  2\\kappa u_1 \\end{pmatrix} \\frac{1}{4\\xi^2 - \\alpha^2} \\begin{pmatrix} 2\\xi^2  -\\alpha \\\\ -\\alpha  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2\\kappa u_1 \\end{pmatrix}$\n$= \\frac{1}{4\\xi^2 - \\alpha^2} \\begin{pmatrix} -2\\alpha\\kappa u_1  4\\kappa u_1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2\\kappa u_1 \\end{pmatrix}$\n$= \\frac{1}{4\\xi^2 - \\alpha^2} (4\\kappa u_1)(2\\kappa u_1) = \\frac{8\\kappa^2 u_1^2}{4\\xi^2 - \\alpha^2}$。\n将这些代入关于 $\\Delta t$ 的不等式中：\n$\\Delta t \\leq \\frac{4\\kappa u_1^2}{\\frac{8\\kappa^2 u_1^2}{4\\xi^2 - \\alpha^2}}$。\n对于 $u_1 \\neq 0$，我们可以消去项：\n$\\Delta t \\leq \\frac{4\\kappa u_1^2 (4\\xi^2 - \\alpha^2)}{8\\kappa^2 u_1^2} = \\frac{4\\xi^2 - \\alpha^2}{2\\kappa}$。\n这个上界与 $\\boldsymbol{u}^n$ 的选择无关（只要它不在 $C^P$ 的零空间中）。因此，这是最严格的界。\n最大允许时间步长是 $\\Delta t_{\\max} = \\frac{4\\xi^2 - \\alpha^2}{2\\kappa}$。该结果在 $M^{\\mathrm{sym}}$ 为对称正定所需的条件 $4\\xi^2 - \\alpha^2  0$ 下有效，该条件确保了 $\\Delta t_{\\max}  0$。",
            "answer": "$$\n\\boxed{\\frac{4\\xi^{2} - \\alpha^{2}}{2\\kappa}}\n$$"
        },
        {
            "introduction": "对流扩散方程是许多输运现象的模型，但当对流占主导地位时，标准的Bubnov-Galerkin方法常常会失效，并产生非物理振荡。本问题介绍了流线迎风Petrov-Galerkin (SUPG) 方法，这是一种强大的稳定化技术，它沿着流动方向选择性地增加人工耗散。通过比较两种方法产生的算子的特征值谱，你将从量化角度理解这种定制的Petrov-Galerkin方法如何有效抑制不稳定性。",
            "id": "3368137",
            "problem": "设计并实现一个一维谱元离散化方法，用于求解在区间 $[0,1]$ 上带有齐次狄利克雷边界条件的标量场 $u$ 的定常线性对流扩散算子。其强形式为 $u' - \\epsilon u'' = f$，$x \\in (0,1)$，且 $u(0)=u(1)=0$，其中 $\\epsilon \\ge 0$ 是一个实数参数，而 $'$ 表示对 $x$ 的导数。取对流速度为 $a=1$。使用一个将 $[0,1]$ 划分为 $E$ 个长度为 $h = 1/E$ 的等长单元的剖分，并在每个单元上使用以勒让德-高斯-洛巴托 (Legendre–Gauss–Lobatto, LGL) 插值节点为基础的 $p$ 次多项式基。推导并实现以下两种离散算子：\n- Bubnov-Galerkin 格式（试探函数等于检验函数）：从标准弱形式出发，检验函数取自 Sobolev 空间 $H^1_0(0,1)$，将扩散项和对流项各进行一次分部积分，使得单元双线性形式为 $-\\int v' u \\, dx + \\epsilon \\int v' u' \\, dx$；使用 LGL 节点上的拉格朗日形函数 $\\{\\ell_j\\}$ 和带权重 $\\{\\omega_i\\}$ 的 LGL 求积来构成单元矩阵\n  - $M_e = \\dfrac{h}{2} \\operatorname{diag}(\\omega)$，\n  - 在参考区间 $[-1,1]$ 的 LGL 节点 $\\{\\xi_i\\}_{i=0}^p$ 上，$D_{ij} = \\ell_j'(\\xi_i)$，\n  - $K_e = \\dfrac{2}{h} D^\\top \\operatorname{diag}(\\omega) D$，\n  - $C_e = - D^\\top \\operatorname{diag}(\\omega)$，\n  从而单元算子为 $A^{\\text{BG}}_e = C_e + \\epsilon K_e$。将这些单元矩阵组装成全局矩阵 $A^{\\text{BG}}$，在界面处保持标准的 $C^0$ 连续性，并通过消除边界自由度来施加狄利克雷条件。\n- Petrov-Galerkin 迎风格式：采用由 $w = v + \\tau v'$ 定义的流线迎风 Petrov-Galerkin (SUPG) 检验空间，其中对流速度为常数 $a = 1$，单元稳定化参数为 $\\tau_e = \\theta \\, \\dfrac{h}{2p+1}$，且 $\\theta = \\dfrac{1}{2}$。在得到的离散双线性形式中，保留主导的一致性 SUPG 贡献，并将其作为附加的流线扩散项与原扩散项一同实现，即在每个单元上取 $A^{\\text{PG}}_e = C_e + (\\epsilon + \\tau_e) K_e$。将其组装成全局矩阵 $A^{\\text{PG}}$ 并施加相同的狄利克雷条件。\n\n对每个组装好的全局算子（在施加边界条件后），使用复数运算计算矩阵的谱（所有特征值）。然后，对每个算子 $A$，计算以下两种谱诊断量：\n- 谱半径 $\\rho(A) = \\max_i |\\lambda_i|$，\n- 谱横坐标 $\\alpha(A) = \\max_i \\operatorname{Re}(\\lambda_i)$。\n\n您的程序必须为一组测试用例实现上述计算，这些测试用例旨在探究 $\\epsilon \\to 0$ 的极限情况以及增加多项式次数 $p$ 的影响。使用以下测试套件，每个测试用例由一个三元组 $(\\epsilon, p, E)$ 指定：\n- 测试 1：$(10^{-2}, 2, 3)$，\n- 测试 2：$(10^{-6}, 2, 3)$，\n- 测试 3：$(10^{-6}, 6, 3)$，\n- 测试 4：$(0, 4, 2)$。\n\n对于每个测试用例，计算四个浮点数值：\n- $\\rho\\!\\left(A^{\\text{BG}}\\right)$,\n- $\\rho\\!\\left(A^{\\text{PG}}\\right)$,\n- $\\alpha\\!\\left(A^{\\text{BG}}\\right)$,\n- $\\alpha\\!\\left(A^{\\text{PG}}\\right)$.\n\n所有浮点数输出必须以科学记数法的十进制数形式报告，小数点后精确到六位。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，每个内部列表对应一个测试用例，并按上述顺序排列。每个内部列表必须按 $[\\rho(A^{\\text{BG}}), \\rho(A^{\\text{PG}}), \\alpha(A^{\\text{BG}}), \\alpha(A^{\\text{PG}})]$ 的顺序排列。例如，包含两个测试用例的输出应类似于 $[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4]]$，所有数字均采用指定格式。\n\n不涉及物理单位。所有角度（如有）均以弧度处理。每个测试用例的答案必须是指定格式的浮点数。",
            "solution": "本问题要求设计并实现一个求解定常线性对流扩散方程的一维谱元法，并对得到的离散算子进行谱分析。我们考虑两种格式：标准的 Bubnov-Galerkin (BG) 方法和稳定的流线迎风 Petrov-Galerkin (SUPG) 方法。\n\n在域 $x \\in [0,1]$ 上的控制方程的强形式为：\n$$ u' - \\epsilon u'' = f $$\n边界条件为齐次狄利克雷条件 $u(0)=u(1)=0$。此处，对流速度取为 $a=1$，$\\epsilon \\ge 0$ 为扩散系数。\n\n求解域 $[0,1]$ 被划分为 $E$ 个长度相等的无重叠单元，单元长度为 $h=1/E$。在每个单元内，解 $u$ 由一个 $p$ 次多项式近似。\n\n标准弱形式通过将方程乘以一个检验函数 $v \\in H^1_0(0,1)$ 并在整个域上积分得到。问题指定了一个特殊的弱形式，其中对流项和扩散项都进行了分部积分。对于对流项 $\\int v u' dx$，分部积分得到 $[vu]|_0^1 - \\int v' u dx$。对于扩散项 $-\\int v (\\epsilon u'') dx$，分部积分得到 $-[v \\epsilon u']|_0^1 + \\int v' (\\epsilon u') dx$。由于 $v \\in H^1_0(0,1)$，边界项为零，从而得到双线性形式：\n$$ B(u, v) = \\int_0^1 \\left( -v' u + \\epsilon v' u' \\right) dx $$\n\n谱元法在每个单元上使用基函数的和来近似 $u$ 和 $v$。在参考单元 $\\xi \\in [-1,1]$ 上，解使用在 $p+1$ 个勒让德-高斯-洛巴托 (LGL) 节点 $\\{\\xi_j\\}_{j=0}^p$ 上定义的拉格朗日多项式 $\\{\\ell_j(\\xi)\\}_{j=0}^p$ 来表示：\n$$ u(\\xi) = \\sum_{j=0}^p u_j \\ell_j(\\xi) \\quad \\text{以及} \\quad v(\\xi) = \\sum_{i=0}^p v_i \\ell_i(\\xi) $$\n单元上的物理坐标 $x$ 通过 $x(\\xi) = x_k + \\frac{h}{2}(\\xi+1)$ 从参考坐标 $\\xi$ 映射而来，其中 $x_k$ 是单元的起始点。这导出了关系式 $dx = \\frac{h}{2} d\\xi$ 和 $\\frac{d}{dx} = \\frac{2}{h} \\frac{d}{d\\xi}$。\n\n双线性形式 $B(u,v)$ 可以逐单元计算。代入基函数展开式，并使用带权重 $\\{\\omega_k\\}$ 的 LGL 求积进行积分，我们便可推导出单元矩阵。\n\n单元对流矩阵 $C_e$ 源于项 $-\\int v' u dx$。变换到参考单元上，其 $(i, j)$ 元为：\n$$ (C_e)_{ij} = -\\int_{-1}^1 \\left(\\frac{2}{h} \\ell_i'(\\xi)\\right) \\ell_j(\\xi) \\left(\\frac{h}{2} d\\xi\\right) = -\\int_{-1}^1 \\ell_i'(\\xi) \\ell_j(\\xi) d\\xi $$\n应用 LGL 求积，并利用性质 $\\ell_j(\\xi_k) = \\delta_{jk}$：\n$$ (C_e)_{ij} \\approx -\\sum_{k=0}^p \\omega_k \\ell_i'(\\xi_k) \\ell_j(\\xi_k) = -\\sum_{k=0}^p \\omega_k (D)_{ki} \\delta_{jk} = -\\omega_j (D)_{ji} $$\n其中 $D$ 是 LGL 微分矩阵，其元素为 $D_{kj} = \\ell_j'(\\xi_k)$。用矩阵形式表示，即为 $C_e = - D^\\top \\operatorname{diag}(\\omega)$，与问题描述一致。\n\n单元刚度矩阵 $K_e$ 源于项 $\\int \\epsilon v' u' dx$。其 $(i, j)$ 元为：\n$$ (K_e)_{ij} = \\epsilon \\int_{-1}^1 \\left(\\frac{2}{h} \\ell_i'(\\xi)\\right) \\left(\\frac{2}{h} \\ell_j'(\\xi)\\right) \\left(\\frac{h}{2} d\\xi\\right) = \\epsilon \\frac{2}{h} \\int_{-1}^1 \\ell_i'(\\xi) \\ell_j'(\\xi) d\\xi $$\n使用 LGL 求积：\n$$ (K_e)_{ij} \\approx \\epsilon \\frac{2}{h} \\sum_{k=0}^p \\omega_k \\ell_i'(\\xi_k) \\ell_j'(\\xi_k) = \\epsilon \\frac{2}{h} \\sum_{k=0}^p \\omega_k (D)_{ki} (D)_{kj} $$\n用矩阵形式表示，即为 $\\epsilon \\frac{2}{h} D^\\top \\operatorname{diag}(\\omega) D$。问题中定义了 $K_e = \\frac{2}{h} D^\\top \\operatorname{diag}(\\omega) D$，因此该项为 $\\epsilon K_e$。\n\n**Bubnov-Galerkin (BG) 格式：**\nBG 方法对试探函数和检验函数使用相同的空间。单元算子矩阵是对流贡献和刚度贡献之和：\n$$ A^{\\text{BG}}_e = C_e + \\epsilon K_e $$\n\n**Petrov-Galerkin (PG) 格式 (SUPG)：**\n当 $\\epsilon$ 很小时，BG 格式容易产生伪振荡。SUPG 方法通过在流线方向上增加人工扩散来稳定离散化。这是通过使用一个修正的检验函数空间 $w = v + \\tau_e v'$ 实现的，其中 $\\tau_e$ 是一个逐单元的稳定化参数。问题指定了一个简化的 SUPG 实现，其最终单元算子为：\n$$ A^{\\text{PG}}_e = C_e + (\\epsilon + \\tau_e) K_e $$\n其中 $\\tau_e = \\theta \\frac{h}{2p+1}$ 且 $\\theta = 1/2$。这相当于在物理扩散 $\\epsilon$ 的基础上增加了一个大小为 $\\tau_e$ 的人工扩散。\n\n**全局组装与边界条件：**\n全局矩阵 $A^{\\text{BG}}$ 和 $A^{\\text{PG}}$ 是通过将所有单元矩阵 $A^{\\text{BG}}_e$ 和 $A^{\\text{PG}}_e$ 的贡献累加到对应于全局自由度的适当位置来组装的。这个过程称为直接刚度求和，它自然地保证了单元界面处的 $C^0$ 连续性。\n齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$ 是通过移除全局矩阵中对应于边界节点（第一个和最后一个全局自由度）的行和列来施加的。\n\n**谱分析：**\n在组装并施加边界条件后，我们得到最终的系统矩阵。数值格式的稳定性和行为可以通过这些矩阵的特征值 $\\{\\lambda_i\\}$ 来分析。我们计算两个关键的谱诊断量：\n- 谱半径 $\\rho(A) = \\max_i |\\lambda_i|$，它控制着迭代方法中误差的放大。\n- 谱横坐标 $\\alpha(A) = \\max_i \\operatorname{Re}(\\lambda_i)$，它与相应瞬态问题的时间推进格式的稳定性有关。对于离散的对流扩散算子，期望谱横坐标为非负值。\n\n实现过程将首先为给定的多项式次数 $p$ 生成 LGL 节点、权重和微分矩阵。然后，对于每个测试用例，将计算单元矩阵并组装成全局算子。在施加边界条件后，将计算特征值以求得谱半径和谱横坐标。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import legendre, eval_legendre\n\ndef get_lgl_nodes_weights_deriv_matrix(p):\n    \"\"\"\n    Computes Legendre-Gauss-Lobatto (LGL) nodes, weights, and the\n    first derivative matrix for a given polynomial degree p.\n    \"\"\"\n    if p == 0:\n        # LGL is not defined for p=0 in a way that makes sense for C0 elements.\n        # However, the smallest p in the test suite is 2.\n        raise ValueError(\"LGL elements require p >= 1.\")\n\n    # LGL nodes are roots of (1-x^2) * P_p'(x)\n    # The interior nodes are the roots of P_p'(x)\n    if p > 1:\n        p_poly = legendre(p)\n        p_deriv_roots = p_poly.deriv().roots\n        nodes = np.concatenate(([-1.0], np.sort(p_deriv_roots), [1.0]))\n    else: # p == 1\n        nodes = np.array([-1.0, 1.0])\n\n    # LGL weights\n    weights = 2.0 / (p * (p + 1) * (eval_legendre(p, nodes)**2))\n\n    # Differentiation matrix D\n    D = np.zeros((p + 1, p + 1))\n    p_at_nodes = eval_legendre(p, nodes) #\n    for i in range(p + 1):\n        for j in range(p + 1):\n            if i != j:\n                D[i, j] = p_at_nodes[i] / (p_at_nodes[j] * (nodes[i] - nodes[j]))\n            else:\n                if i == 0:\n                    D[i, j] = -p * (p + 1) / 4.0\n                elif i == p:\n                    D[i, j] = p * (p + 1) / 4.0\n                else:\n                    D[i, j] = 0.0\n    return nodes, weights, D\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and generate the final output.\n    \"\"\"\n    test_cases = [\n        (1e-2, 2, 3),\n        (1e-6, 2, 3),\n        (1e-6, 6, 3),\n        (0.0, 4, 2),\n    ]\n\n    all_results = []\n\n    for epsilon, p, E in test_cases:\n        # Step 1: Get LGL data for the reference element\n        _, weights, D = get_lgl_nodes_weights_deriv_matrix(p)\n        omega_diag = np.diag(weights)\n\n        # Step 2: Form element matrices\n        h = 1.0 / E\n        \n        # Convection matrix Ce = -D^T * diag(w)\n        C_e = -D.T @ omega_diag\n        \n        # Stiffness matrix Ke = (2/h) * D^T * diag(w) * D\n        K_e = (2.0 / h) * D.T @ omega_diag @ D\n\n        # Element operator for Bubnov-Galerkin\n        A_bg_e = C_e + epsilon * K_e\n\n        # Element operator for Petrov-Galerkin (SUPG)\n        theta = 0.5\n        tau_e = theta * h / (2 * p + 1)\n        A_pg_e = C_e + (epsilon + tau_e) * K_e\n\n        # Step 3: Assemble global matrices\n        n_dof_total = E * p + 1\n        A_bg = np.zeros((n_dof_total, n_dof_total), dtype=np.complex128)\n        A_pg = np.zeros((n_dof_total, n_dof_total), dtype=np.complex128)\n\n        for e in range(E):\n            # Map local DoFs to global DoFs\n            global_indices = np.arange(e * p, e * p + p + 1)\n            # Direct stiffness summation\n            idx = np.ix_(global_indices, global_indices)\n            A_bg[idx] += A_bg_e\n            A_pg[idx] += A_pg_e\n\n        # Step 4: Apply homogeneous Dirichlet boundary conditions\n        # Eliminate first and last rows and columns\n        A_bg_int = A_bg[1:-1, 1:-1]\n        A_pg_int = A_pg[1:-1, 1:-1]\n        \n        # Step 5: Spectral Analysis\n        # Bubnov-Galerkin\n        eigvals_bg = np.linalg.eigvals(A_bg_int)\n        rho_bg = np.max(np.abs(eigvals_bg))\n        alpha_bg = np.max(np.real(eigvals_bg))\n        \n        # Petrov-Galerkin\n        eigvals_pg = np.linalg.eigvals(A_pg_int)\n        rho_pg = np.max(np.abs(eigvals_pg))\n        alpha_pg = np.max(np.real(eigvals_pg))\n        \n        case_results = [rho_bg, rho_pg, alpha_bg, alpha_pg]\n        all_results.append(case_results)\n\n    # Format the final output string\n    formatted_results = []\n    for case_res in all_results:\n        formatted_case = [f\"{v:.6e}\" for v in case_res]\n        formatted_results.append(f\"[{','.join(formatted_case)}]\")\n    \n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}