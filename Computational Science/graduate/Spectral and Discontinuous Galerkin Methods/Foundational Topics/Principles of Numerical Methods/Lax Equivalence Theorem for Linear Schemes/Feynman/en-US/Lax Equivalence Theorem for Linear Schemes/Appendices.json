{
    "hands_on_practices": [
        {
            "introduction": "The Lax equivalence theorem forms the theoretical bedrock of numerical analysis for linear partial differential equations, asserting that for a consistent scheme, stability is the necessary and sufficient condition for convergence. This first exercise provides a compelling demonstration of this principle by exploring what happens when stability is violated . You will analyze a scheme that is a consistent approximation of the advection equation but, due to a seemingly innocuous choice of numerical flux, is fundamentally unstable, leading to non-convergence.",
            "id": "3394971",
            "problem": "Consider the one-dimensional linear advection initial value problem on a periodic interval,\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\\quad x\\in[0,L],\\ t\\ge 0,\\quad a>0,\n$$\nwith smooth periodic initial data $u(x,0) = u_{0}(x)$. Discretize the spatial domain into $N$ uniform cells of size $h=L/N$, and approximate $u$ by a Discontinuous Galerkin (DG) method using piecewise constants (polynomial degree $p=0$) on each cell. Use the central numerical flux for the advection flux, namely $F^{*}(u^{-},u^{+}) = a\\,\\frac{u^{-}+u^{+}}{2}$ at each interface, and advance in time using the forward Euler method with time step $\\Delta t>0$. Define the Courant number $\\nu = \\frac{a\\,\\Delta t}{h}$.\n\nStarting from the DG weak formulation with test function equal to the cellwise constant basis, derive the fully discrete update for the cell averages $u_{j}^{n}$, where $j\\in\\{0,1,\\dots,N-1\\}$ indexes cells and $n\\in\\mathbb{N}$ indexes time steps. Then perform a von Neumann (Fourier) analysis on the periodic grid by considering a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,\\theta\\,j)$ with $\\theta\\in[-\\pi,\\pi]$ measured in radians, and obtain the one-step amplification factor $G(\\theta,\\nu)$.\n\nUsing this analysis, compute the supremum over all Fourier modes of the modulus of the amplification factor,\n$$\n\\sup_{\\theta\\in[-\\pi,\\pi]} |G(\\theta,\\nu)|,\n$$\nexpressed purely as a function of the Courant number $\\nu$. Finally, use the Lax equivalence theorem for linear schemes to explain why this scheme is non-convergent, despite the possibility of apparent short-time accuracy for smooth initial data when $\\nu$ is small. Your final answer must be the closed-form analytic expression for $\\sup_{\\theta} |G(\\theta,\\nu)|$.",
            "solution": "The problem requires the derivation and analysis of a Discontinuous Galerkin (DG) scheme for the one-dimensional linear advection equation. The analysis will culminate in an explanation of the scheme's non-convergence based on the Lax equivalence theorem.\n\nThe governing partial differential equation (PDE) is the linear advection equation:\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0\n$$\non a periodic domain $x\\in[0,L]$ for $t\\ge 0$, with a constant advection speed $a>0$.\n\nFirst, we derive the fully discrete numerical scheme. The DG method starts from a weak formulation. We multiply the PDE by a test function $v_h(x)$ from the same approximation space as the numerical solution $u_h(x,t)$ and integrate over a computational cell $I_j = [x_{j-1/2}, x_{j+1/2}]$ of size $h$. For a polynomial degree $p=0$, the approximation $u_h(x,t)$ is a piecewise constant function, taking the value $u_j(t)$ on cell $I_j$. The test function $v_h(x)$ is the corresponding basis function, which is $1$ on $I_j$ and $0$ elsewhere.\n\nThe weak formulation on cell $I_j$ is:\n$$\n\\int_{I_j} v_h(x) \\left( \\partial_{t} u_h(x,t) + a\\,\\partial_{x} u_h(x,t) \\right) dx = 0\n$$\nIntegrating the advection term by parts, we get:\n$$\n\\int_{I_j} v_h \\partial_{t} u_h dx + \\left[ v_h a u_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} ( \\partial_{x} v_h ) a u_h dx = 0\n$$\nSince $u_h(x,t) = u_j(t)$ and $v_h(x) = 1$ on $I_j$, the time derivative term becomes $\\int_{I_j} \\partial_t u_j(t) dx = h \\frac{du_j}{dt}$. As $v_h$ is constant on the cell, its derivative $\\partial_x v_h$ is zero inside the cell. The equation simplifies to:\n$$\nh \\frac{du_j}{dt} + a u_h(x_{j+1/2},t) - a u_h(x_{j-1/2},t) = 0\n$$\nThe terms $u_h(x_{j\\pm1/2},t)$ are evaluated at the cell interfaces where the solution is discontinuous. These single-valued fluxes must be replaced by a numerical flux $F^{*}(u^-, u^+)$, where $u^-$ and $u^+$ are the values of the solution from the left and right of the interface, respectively. The semi-discrete scheme is:\n$$\nh \\frac{du_j}{dt} + F^*(u_j(t), u_{j+1}(t)) - F^*(u_{j-1}(t), u_j(t)) = 0\n$$\nHere, at interface $x_{j+1/2}$, $u^-=u_j(t)$ and $u^+=u_{j+1}(t)$. At interface $x_{j-1/2}$, $u^-=u_{j-1}(t)$ and $u^+=u_j(t)$. The problem specifies the central numerical flux, $F^{*}(u^{-},u^{+}) = a\\,\\frac{u^{-}+u^{+}}{2}$. Substituting this into the scheme:\n$$\nh \\frac{du_j}{dt} + a \\frac{u_j + u_{j+1}}{2} - a \\frac{u_{j-1} + u_j}{2} = 0\n$$\nSimplifying the expression gives:\n$$\nh \\frac{du_j}{dt} = - \\frac{a}{2} (u_j + u_{j+1} - u_{j-1} - u_j) = - \\frac{a}{2} (u_{j+1} - u_{j-1})\n$$\nThis is the semi-discrete scheme. Now, we apply the forward Euler method for time discretization, where $\\frac{u_j^{n+1}-u_j^n}{\\Delta t}$ approximates $\\frac{du_j}{dt}$:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{a}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\nRearranging and introducing the Courant number $\\nu = \\frac{a\\,\\Delta t}{h}$, we obtain the fully discrete update equation:\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2h} (u_{j+1}^n - u_{j-1}^n) = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\nThis scheme is identical to the one derived from a central difference in space and forward Euler in time finite difference method.\n\nNext, we perform a von Neumann stability analysis. We consider a single Fourier mode for the solution of the form $u_j^n = \\hat{u}^n \\exp(i\\theta j)$, where $\\theta \\in [-\\pi, \\pi]$ is the dimensionless wavenumber. Substituting this into the discrete scheme yields:\n$$\n\\hat{u}^{n+1}\\exp(i\\theta j) = \\hat{u}^{n}\\exp(i\\theta j) - \\frac{\\nu}{2} \\left( \\hat{u}^{n}\\exp(i\\theta (j+1)) - \\hat{u}^{n}\\exp(i\\theta (j-1)) \\right)\n$$\nDividing by $\\hat{u}^{n}\\exp(i\\theta j)$ (assuming it is non-zero), we find the amplification factor $G(\\theta,\\nu) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$:\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} \\left( \\exp(i\\theta) - \\exp(-i\\theta) \\right)\n$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, we have $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin\\theta$. The amplification factor becomes:\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} (2i\\sin\\theta) = 1 - i\\nu\\sin\\theta\n$$\nNow, we compute the supremum of the modulus of this complex-valued amplification factor over all possible modes $\\theta \\in [-\\pi, \\pi]$. The modulus is:\n$$\n|G(\\theta,\\nu)| = |1 - i\\nu\\sin\\theta| = \\sqrt{1^2 + (-\\nu\\sin\\theta)^2} = \\sqrt{1 + \\nu^2\\sin^2\\theta}\n$$\nTo find the supremum, we need to maximize this expression with respect to $\\theta$. Since $\\nu = \\frac{a\\Delta t}{h} > 0$ and the square root function is monotonic, maximizing $|G(\\theta,\\nu)|$ is equivalent to maximizing $\\sin^2\\theta$. The range of $\\sin\\theta$ for $\\theta \\in [-\\pi,\\pi]$ is $[-1,1]$, so the maximum value of $\\sin^2\\theta$ is $1$, which occurs at $\\theta = \\pm\\frac{\\pi}{2}$.\nTherefore, the supremum of the modulus of the amplification factor is:\n$$\n\\sup_{\\theta\\in[-\\pi,\\pi]} |G(\\theta,\\nu)| = \\sqrt{1 + \\nu^2(1)^2} = \\sqrt{1 + \\nu^2}\n$$\nFinally, we use the Lax equivalence theorem to explain why this scheme is non-convergent. The theorem states that for a linear, well-posed initial value problem, a consistent numerical scheme is convergent if and only if it is stable.\n\n1.  **Linearity**: The PDE and the discrete scheme are both linear.\n2.  **Consistency**: The scheme is a standard finite difference approximation (central in space, forward in time) to the advection equation. A Taylor series expansion shows a truncation error of $O(\\Delta t, h^2)$, which goes to zero as $\\Delta t, h \\to 0$. Thus, the scheme is consistent.\n3.  **Stability**: For a scheme to be stable in the von Neumann sense, the amplification factor must satisfy $|G(\\theta,\\nu)| \\le 1$ for all relevant modes $\\theta$ and for the spatiotemporal refinement process. In our case, we found $|G(\\theta, \\nu)| = \\sqrt{1 + \\nu^2\\sin^2\\theta}$. For any $\\nu > 0$, this value is strictly greater than $1$ for any mode with $\\sin\\theta \\neq 0$ (i.e., for any mode other than the zero-frequency mode $\\theta=0$ or the aliased zero-frequency mode $\\theta=\\pm\\pi$). Specifically, $\\sup_\\theta |G(\\theta,\\nu)| = \\sqrt{1+\\nu^2} > 1$.\n\nSince the stability condition $|G| \\le 1$ is violated for any choice of $\\nu > 0$, the scheme is unconditionally unstable. Any numerical error or high-frequency component present in the initial data will be amplified exponentially over time, leading to a blow-up of the numerical solution.\n\nBy the Lax equivalence theorem, because the scheme is consistent but unstable, it is **non-convergent**. The fact that the problem may exhibit apparent short-time accuracy for smooth initial data is because smooth data has very small high-frequency components, where the instability is most severe (at $\\theta=\\pm\\pi/2$, corresponding to the highest non-aliased frequency on the grid). For small $\\nu$, the amplification factor is only slightly larger than $1$ (e.g., $|G| \\approx 1 + \\frac{1}{2}\\nu^2\\sin^2\\theta$). The growth per time step is small, but it accumulates. For any fixed time $T = n\\Delta t$, as we refine the grid ($\\Delta t \\to 0$, $n \\to \\infty$), the total amplification $(|G|)^n$ will diverge, confirming the lack of convergence.",
            "answer": "$$\n\\boxed{\\sqrt{1 + \\nu^2}}\n$$"
        },
        {
            "introduction": "Having seen the dramatic failure of an unstable scheme, we now turn to the second pillar of the Lax equivalence theorem: consistency. A stable scheme is useless if it does not approximate the correct partial differential equation, as it will simply converge to the wrong solution. This practice  presents a fascinating case study of a Fourier spectral scheme that is provably stable in the $L^2$ norm but contains a deliberate, subtle inconsistency, reinforcing that stability alone is insufficient for convergence to the correct solution.",
            "id": "3394996",
            "problem": "Consider the periodic linear advection initial value problem $u_{t} + a\\,u_{x} = 0$ for $x \\in [0,2\\pi]$ and $t \\ge 0$, with periodic boundary conditions and zero initial data $u(x,0) = 0$. This problem is well-posed in the sense that for any admissible initial data in a suitable normed space, there exists a unique solution that depends continuously on the initial data. In the context of spectral methods and Discontinuous Galerkin (DG) methods, a linear scheme is called stable if its homogeneous part generates a bounded evolution in the chosen norm and is called consistent if the discrete operator applied to sufficiently smooth exact solutions yields a residual that tends to zero under refinement.\n\nConstruct the following Fourier spectral semi-discrete scheme with $N$ modes (labeled by integers $k$ with $|k| \\le K$ where $N = 2K+1$): expand $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$ and evolve the modal coefficients according to\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0},\n$$\nwith parameter $a = 1$, forcing amplitude $\\gamma = 1$, and Kronecker delta $\\delta_{k,0}$. Assume exact time integration of this semi-discrete system. This scheme is linear and its homogeneous part corresponds to the standard Fourier spectral discretization of the skew-adjoint advection operator, which is norm-preserving in the $L^{2}$ norm. However, the added zero-mode forcing makes the scheme inconsistent with the original homogeneous problem.\n\nUsing first-principles reasoning starting from the definitions above and the exact evolution of the semi-discrete system, show that the scheme is stable (in the sense that the homogeneous evolution preserves the $L^{2}$ norm) yet inconsistent, and explain why it does not converge to the exact solution $u \\equiv 0$. Then, compute the limit of the $L^{2}$ error at time $t = 1$ as the number of modes $N \\to \\infty$:\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)}.\n$$\nProvide your final answer as a single closed-form analytic expression. No rounding is required. Angles, if any, must be expressed in radians.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\nThe givens are:\n1.  The partial differential equation (PDE) is the linear advection equation: $u_{t} + a\\,u_{x} = 0$.\n2.  The spatial domain is $x \\in [0,2\\pi]$ with periodic boundary conditions.\n3.  The temporal domain is $t \\ge 0$.\n4.  The initial condition is $u(x,0) = 0$.\n5.  A Fourier spectral semi-discrete scheme is proposed for a numerical solution $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$, where $N = 2K+1$.\n6.  The evolution of the modal coefficients $\\hat{u}_{k}(t)$ is given by the ordinary differential equation (ODE) system: $\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}$.\n7.  The initial conditions for the scheme are consistent with $u(x,0)=0$, which implies $\\hat{u}_{k}(0)=0$ for all $k$.\n8.  The parameters are specified as $a = 1$ and $\\gamma = 1$.\n9.  The exact solution to the initial value problem is $u(x,t) = 0$ for all $x$ and $t$.\n10. The task is to show the scheme is stable but inconsistent, explain the resulting non-convergence, and compute the limit of the $L^{2}$ error at $t=1$ as $N \\to \\infty$.\n\nThe problem is mathematically well-defined, internally consistent, and directly pertains to the analysis of numerical methods for PDEs, specifically the interplay of stability, consistency, and convergence as described by the Lax equivalence theorem. The constructed scheme is a textbook example used to illustrate the importance of consistency. The problem is therefore valid.\n\nWe proceed with the solution, which consists of three parts: analysis of stability and consistency, explanation of non-convergence, and computation of the error.\n\nFirst, we analyze the stability of the scheme. According to the problem statement, stability is determined by the behavior of the homogeneous part of the scheme. The given semi-discrete scheme is:\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}\n$$\nThe homogeneous part is obtained by removing the forcing term $\\gamma\\,\\delta_{k,0}$:\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}^{h}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}^{h}(t)\n$$\nwhere $\\hat{u}_{k}^{h}(t)$ denotes the coefficients of the homogeneous evolution. The solution to this linear ODE is $\\hat{u}_{k}^{h}(t) = \\hat{u}_{k}^{h}(0) \\exp(-iakt)$. The $L^{2}$ norm of the numerical solution $u_{N}(x,t)$ is related to its Fourier coefficients by Parseval's theorem:\n$$\n\\left\\| u_{N}(\\cdot, t) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |u_{N}(x,t)|^{2} dx = 2\\pi \\sum_{|k| \\le K} |\\hat{u}_{k}(t)|^{2}\n$$\nFor the homogeneous evolution, we examine the squared magnitude of the coefficients:\n$$\n|\\hat{u}_{k}^{h}(t)|^{2} = \\left| \\hat{u}_{k}^{h}(0) \\exp(-iakt) \\right|^{2} = |\\hat{u}_{k}^{h}(0)|^{2} |\\exp(-iakt)|^{2} = |\\hat{u}_{k}^{h}(0)|^{2}\n$$\nsince $|\\exp(i\\theta)|=1$ for any real $\\theta$. Summing over all modes, we find:\n$$\n\\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(t)|^{2} = \\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(0)|^{2}\n$$\nThis implies that $\\left\\| u_{N}^{h}(\\cdot, t) \\right\\|_{L^{2}}^{2} = \\left\\| u_{N}^{h}(\\cdot, 0) \\right\\|_{L^{2}}^{2}$. The $L^{2}$ norm of the solution to the homogeneous scheme is conserved for all time. An evolution that preserves the norm is bounded (with an operator norm of $1$). Therefore, by the definition provided, the scheme is stable.\n\nSecond, we analyze the consistency. A scheme is consistent with a PDE if the truncation error—the residual obtained by substituting the exact solution of the PDE into the numerical scheme—tends to zero as the discretization is refined ($N \\to \\infty$). The exact solution to $u_{t} + a u_{x} = 0$ with $u(x,0)=0$ is $u(x,t) = 0$ for all $t \\ge 0$. The Fourier coefficients of the exact solution are $\\hat{u}_{k,exact}(t) = 0$ for all $k$ and $t$.\nWe substitute these exact solution coefficients into the full numerical scheme to find the residual for each mode, $\\tau_k(t)$:\n$$\n\\tau_k(t) = \\frac{d}{dt}\\hat{u}_{k,exact}(t) - \\left( -iak\\,\\hat{u}_{k,exact}(t) + \\gamma\\,\\delta_{k,0} \\right)\n$$\nPlugging in $\\hat{u}_{k,exact}(t) = 0$ and its time-derivative $\\frac{d}{dt}(0)=0$:\n$$\n\\tau_k(t) = 0 - \\left( -iak \\cdot 0 + \\gamma\\,\\delta_{k,0} \\right) = -\\gamma\\,\\delta_{k,0}\n$$\nWith $\\gamma=1$, the residual is $\\tau_k(t) = -\\delta_{k,0}$. For the mode $k=0$, the residual is $\\tau_0 = -1$, while for all other modes $k \\neq 0$, the residual is $\\tau_k = 0$. The residual for the zeroth mode is a constant nonzero value. It does not depend on the number of modes $N$ and thus does not tend to zero as $N \\to \\infty$. Therefore, the scheme is inconsistent with the homogeneous PDE $u_t + a u_x = 0$.\n\nThe failure to converge is a direct consequence of this inconsistency, as explained by the Lax-Richtmyer equivalence theorem. The theorem states that for a well-posed linear initial value problem, a consistent linear finite-difference scheme is convergent if and only if it is stable. Here, the scheme is stable but not consistent. The conditions of the theorem for convergence are not met. The scheme is actually a consistent discretization of a different PDE: $u_t + a u_x = F(x)$, where $F(x)$ is a function whose Fourier coefficients are $\\gamma\\,\\delta_{k,0}$. This corresponds to a spatially constant forcing term $F(x) = \\gamma=1$. The numerical scheme is solving the wrong problem, so its solution does not converge to the solution of the intended problem. The source term $\\gamma\\,\\delta_{k,0}$ continuously injects a non-physical signal into the zeroth mode, causing the numerical solution to diverge from the true solution $u=0$.\n\nFinally, we compute the limit of the $L^{2}$ error at $t=1$. We must find the exact solution to the semi-discrete system with the specified parameters $a=1$, $\\gamma=1$ and initial conditions $\\hat{u}_k(0)=0$. The system of ODEs is:\n$$\n\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t) + \\delta_{k,0}\n$$\nWe solve this for two cases.\nCase 1: $k \\neq 0$. The equation is $\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t)$. With the initial condition $\\hat{u}_k(0)=0$, the unique solution is $\\hat{u}_{k}(t)=0$ for all $t$.\nCase 2: $k=0$. The equation is $\\frac{d}{dt}\\hat{u}_{0}(t) = -i(0)\\hat{u}_{0}(t) + 1$, which simplifies to $\\frac{d}{dt}\\hat{u}_{0}(t) = 1$. Integrating from $0$ to $t$ gives $\\hat{u}_{0}(t) - \\hat{u}_{0}(0) = \\int_0^t 1 ds = t$. Since $\\hat{u}_{0}(0)=0$, we have $\\hat{u}_{0}(t)=t$.\n\nThe coefficients of the numerical solution are thus $\\hat{u}_{k}(t) = t\\,\\delta_{k,0}$. The numerical solution in physical space is:\n$$\nu_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(ikx) = \\hat{u}_{0}(t)\\exp(i \\cdot 0 \\cdot x) = t\n$$\nThe solution $u_{N}(x,t)=t$ is a spatially constant function that grows linearly in time. This solution is valid for any $N \\ge 1$ (i.e., $K \\ge 0$).\n\nThe error is $e_{N}(x,t) = u_{N}(x,t) - u(x,t) = t - 0 = t$.\nWe are asked to compute the $L^{2}$ norm of the error at time $t=1$. The error at this time is $e_N(x,1) = 1$.\nThe squared $L^{2}$ norm of the error is:\n$$\n\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |e_{N}(x,1)|^{2} dx = \\int_{0}^{2\\pi} |1|^{2} dx = \\int_{0}^{2\\pi} 1 dx = 2\\pi\n$$\nThus, the $L^{2}$ norm of the error at $t=1$ is $\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}$.\n\nThis result is independent of $N$. Therefore, the limit as $N \\to \\infty$ is the same value:\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}\n$$\nThis nonzero limit confirms that the scheme does not converge to the exact solution.",
            "answer": "$$\n\\boxed{\\sqrt{2\\pi}}\n$$"
        },
        {
            "introduction": "After exploring schemes that fail by violating either stability or consistency, we now apply our understanding to analyze a method designed for success. This comprehensive exercise  guides you through the complete, first-principles analysis of a Discontinuous Galerkin scheme using an upwind flux, a standard technique for achieving stability in advection problems. By performing a Bloch–Floquet analysis, you will determine the operator's eigenvalues, confirm its stability, and use the Lax equivalence theorem to rigorously justify its convergence, synthesizing the core concepts of the chapter.",
            "id": "3395011",
            "problem": "Consider the one-dimensional linear advection equation $\\partial_{t} u + a \\,\\partial_{x} u = 0$ with constant advection speed $a>0$ on the periodic domain $[0,L]$. Partition the domain into $N$ uniform elements of size $h = L/N$, and on each element $K_{e}$ adopt the modal Legendre basis $\\{P_{j}(\\xi)\\}_{j=0}^{p}$ on the reference coordinate $\\xi \\in [-1,1]$ via the affine map $x = x_{e} + \\tfrac{h}{2}\\,\\xi$. Use the Discontinuous Galerkin (DG) method with upwind numerical flux. \n\nStarting only from the definition of the weak form of Galerkin methods, the properties of Legendre polynomials $\\{P_{j}\\}$, and the mapping rules between $x$ and $\\xi$, perform the following:\n\n1. Derive the semidiscrete DG formulation on each element $K_{e}$ with test functions in the same polynomial space $\\mathbb{P}_{p}(K_{e})$, using an upwind numerical flux for $a>0$ at inter-element boundaries. Express the result in the form\n$$\nM\\,\\dot{u} = A\\,u,\n$$\nwhere $M$ is the global block-diagonal mass matrix and $A$ is the global advection operator assembled from element-local volume contributions and numerical fluxes. Make the element-local structure explicit by identifying the diagonal mass contributions and the nearest-neighbor coupling due to fluxes on a periodic uniform mesh.\n\n2. Specialize to polynomial degree $p=1$ and write the element-local mass matrix $M_{e}$ and the two block matrices $A_{0}$ (self-coupling) and $A_{-1}$ (coupling from the immediate left neighbor) so that, on a uniform periodic mesh,\n$$\nM_{e}\\,\\dot{u}_{e} \\;=\\; A_{0}\\,u_{e} \\;+\\; A_{-1}\\,u_{e-1},\n$$\nwith $u_{e}$ the vector of modal coefficients on element $K_{e}$ and indices taken modulo $N$.\n\n3. Using Bloch–Floquet analysis, assume a Fourier mode $u_{e}(t) = \\widehat{u}\\,\\exp\\!\\big(i k x_{e}\\big)$ with wave number $k \\in \\mathbb{R}$ and define $\\theta = k h$ in radians. Derive the $2 \\times 2$ symbol $S(\\theta)$ of the semidiscrete operator for $p=1$ and compute its two eigenvalues in closed form as functions of $\\theta$, $a$, and $h$. Identify the “physical” branch, namely the eigenvalue that asymptotically matches the continuous symbol $-i a k$ as $\\theta \\to 0$.\n\n4. In light of the Lax equivalence theorem for linear schemes, briefly justify why the upwind choice implies stability of the semidiscrete operator and hence, together with consistency, convergence on the periodic mesh. For grading, however, report only the requested eigenvalue expression.\n\nAnswer specification: Provide, as your final answer, a single closed-form analytical expression for the physical-branch eigenvalue $\\lambda_{\\mathrm{phys}}(\\theta)$ for $p=1$ in terms of $a$, $h$, and $\\theta$ (with $\\theta$ in radians). Do not include any units in the final answer and do not approximate or round.",
            "solution": "The problem is valid as it presents a standard, well-posed question in the numerical analysis of partial differential equations, specifically concerning the Discontinuous Galerkin (DG) method. All required information is provided, and the problem is scientifically and mathematically sound.\n\nWe begin by deriving the semidiscrete DG formulation for the one-dimensional linear advection equation $\\partial_{t} u + a \\,\\partial_{x} u = 0$, where $a>0$ is a constant speed.\n\n**1. Derivation of the Semidiscrete DG Formulation**\n\nWe multiply the PDE by a test function $v_h$ from a finite-dimensional polynomial space $\\mathbb{P}_p(K_e)$ and integrate over a generic element $K_e = [x_{e-1/2}, x_{e+1/2}]$.\n$$\n\\int_{K_e} (\\partial_t u_h) v_h \\,dx + \\int_{K_e} a (\\partial_x u_h) v_h \\,dx = 0\n$$\nHere, $u_h$ is the approximate solution, which is a polynomial of degree $p$ on $K_e$. Applying integration by parts to the second term yields:\n$$\n\\int_{K_e} (\\partial_t u_h) v_h \\,dx + \\left[ a u_h v_h \\right]_{x_{e-1/2}}^{x_{e+1/2}} - \\int_{K_e} a u_h (\\partial_x v_h) \\,dx = 0\n$$\nSince $u_h$ is discontinuous across element boundaries, the flux term $a u_h$ must be replaced by a single-valued numerical flux, denoted $\\widehat{au_h}$.\n$$\n\\int_{K_e} (\\partial_t u_h) v_h \\,dx - \\int_{K_e} a u_h (\\partial_x v_h) \\,dx + \\widehat{au_h}(x_{e+1/2}) v_h(x_{e+1/2}^-) - \\widehat{au_h}(x_{e-1/2}) v_h(x_{e-1/2}^+) = 0\n$$\nFor $a>0$, the upwind flux is defined by the value from the \"upwind\" or left side of the interface, so $\\widehat{au_h} = a u_h^-$. For element $K_e$, the solution at its right boundary is $u_e(x_{e+1/2})$, and the upwind information at its left boundary comes from the solution in element $K_{e-1}$ at its right boundary, i.e., $u_{e-1}(x_{e-1/2})$.\nThe weak form for element $K_e$ is thus:\n$$\n\\int_{K_e} (\\partial_t u_e) v_e \\,dx = \\int_{K_e} a u_e (\\partial_x v_e) \\,dx - a u_e(x_{e+1/2}) v_e(x_{e+1/2}) + a u_{e-1}(x_{e-1/2}) v_e(x_{e-1/2})\n$$\nWe introduce the affine mapping from the reference element $\\xi \\in [-1,1]$ to the physical element $x \\in K_e$: $x = x_e + \\frac{h}{2}\\xi$, where $x_e$ is the center of the element and $h$ is its width. This implies $dx=\\frac{h}{2}d\\xi$ and $\\partial_x = \\frac{2}{h}\\partial_\\xi$. The solution and test function are expanded in the modal Legendre basis $\\{P_j(\\xi)\\}_{j=0}^p$: $u_e(x(\\xi),t) = \\sum_{j=0}^p u_{e,j}(t) P_j(\\xi)$ and $v_e(x(\\xi)) = P_k(\\xi)$ for $k=0,\\dots,p$.\nSubstituting these into the weak form, we obtain a system of ordinary differential equations for the coefficients $u_{e,j}$.\n$$\n\\sum_{j=0}^{p} \\dot{u}_{e,j} \\int_{-1}^{1} P_j P_k \\frac{h}{2}d\\xi = a \\sum_{j=0}^{p} u_{e,j} \\int_{-1}^{1} P_j \\frac{2}{h} \\frac{dP_k}{d\\xi} \\frac{h}{2}d\\xi - a \\sum_{j=0}^{p} u_{e,j} P_j(1)P_k(1) + a \\sum_{j=0}^{p} u_{e-1,j} P_j(1)P_k(-1)\n$$\nThis can be written in matrix form for the vector of coefficients $u_e = [u_{e,0}, \\dots, u_{e,p}]^T$:\n$$ M_e \\dot{u}_e = a(S - F_R)u_e + a F_L u_{e-1} $$\nwhere the element-local matrices are defined as:\nMass matrix: $(M_e)_{kj} = \\int_{-1}^1 P_j P_k \\frac{h}{2} d\\xi$.\nStiffness matrix: $(S)_{kj} = \\int_{-1}^1 P_j \\frac{dP_k}{d\\xi} d\\xi$.\nRight boundary flux matrix: $(F_R)_{kj} = P_j(1) P_k(1)$.\nLeft boundary flux matrix: $(F_L)_{kj} = P_j(1) P_k(-1)$. Note that $u_{e-1}$ is evaluated at its right boundary, which corresponds to its own local coordinate $\\xi=1$.\n\nThe global system is $M \\dot{u} = A u$, where $M$ is a block-diagonal matrix with blocks $M_e$, and $A$ consists of block entries corresponding to the self-coupling $A_0 = a(S - F_R)$ and neighbor-coupling $A_{-1} = a F_L$ for a uniform periodic mesh.\n\n**2. Specialization to Polynomial Degree $p=1$**\n\nFor $p=1$, the basis is $\\{P_0(\\xi), P_1(\\xi)\\} = \\{1, \\xi\\}$. We use the properties of Legendre polynomials:\n$\\int_{-1}^1 P_j P_k d\\xi = \\frac{2}{2j+1}\\delta_{jk}$.\n$P_0(1)=1, P_0(-1)=1$.\n$P_1(1)=1, P_1(-1)=-1$.\n$\\frac{dP_0}{d\\xi}=0, \\frac{dP_1}{d\\xi}=1$.\n\nThe $2\\times 2$ element matrices are:\n*   Mass matrix $M_e$: $(M_e)_{kj} = \\frac{h}{2} \\frac{2}{2k+1}\\delta_{kj} = \\frac{h}{2k+1}\\delta_{kj}$.\n    $$ M_e = h \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{3} \\end{pmatrix} $$\n*   Stiffness matrix $S$: $(S)_{kj} = \\int_{-1}^1 P_j \\frac{dP_k}{d\\xi} d\\xi$.\n    $S_{10} = \\int_{-1}^1 P_0 \\frac{dP_1}{d\\xi} d\\xi = \\int_{-1}^1 (1)(1) d\\xi = 2$. All other entries are zero.\n    $$ S = \\begin{pmatrix} 0 & 0 \\\\ 2 & 0 \\end{pmatrix} $$\n*   Flux matrices $F_R$ and $F_L$:\n    $(F_R)_{kj} = P_j(1) P_k(1) \\implies F_R = \\begin{pmatrix} P_0(1) \\\\ P_1(1) \\end{pmatrix} \\begin{pmatrix} P_0(1) & P_1(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$.\n    $(F_L)_{kj} = P_j(1) P_k(-1) \\implies F_L = \\begin{pmatrix} P_0(-1) \\\\ P_1(-1) \\end{pmatrix} \\begin{pmatrix} P_0(1) & P_1(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ -1 & -1 \\end{pmatrix}$.\nThe block matrices for the semidiscrete system $M_e \\dot{u}_e = A_0 u_e + A_{-1} u_{e-1}$ are:\n$$ A_0 = a(S - F_R) = a \\left( \\begin{pmatrix} 0 & 0 \\\\ 2 & 0 \\end{pmatrix} - \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\right) = a \\begin{pmatrix} -1 & -1 \\\\ 1 & -1 \\end{pmatrix} $$\n$$ A_{-1} = a F_L = a \\begin{pmatrix} 1 & 1 \\\\ -1 & -1 \\end{pmatrix} $$\n\n**3. Bloch-Floquet Analysis and Eigenvalues**\n\nWe assume a plane wave solution (Bloch-Floquet mode) for the coefficient vectors: $u_e(t) = \\widehat{u} \\exp(\\lambda t) \\exp(i k x_e)$, where $\\widehat{u}$ is a constant vector amplitude, $\\lambda$ is the temporal eigenvalue, and $k$ is the wavenumber. On a uniform grid, $x_{e-1} = x_e - h$, so $u_{e-1} = u_e \\exp(-ikh)$. Defining $\\theta = kh$, we have $u_{e-1} = u_e \\exp(-i\\theta)$.\nSubstituting this into the semidiscrete equation:\n$$ \\lambda M_e u_e = A_0 u_e + A_{-1} u_e \\exp(-i\\theta) $$\nThis is a generalized eigenvalue problem for $\\lambda$: $\\lambda M_e \\widehat{u} = (A_0 + \\exp(-i\\theta) A_{-1}) \\widehat{u}$. The eigenvalues $\\lambda$ are the eigenvalues of the symbol matrix $S(\\theta) = M_e^{-1} (A_0 + \\exp(-i\\theta) A_{-1})$.\nLet $C = \\exp(-i\\theta)$.\n$A_0 + C A_{-1} = a \\begin{pmatrix} -1 & -1 \\\\ 1 & -1 \\end{pmatrix} + a C \\begin{pmatrix} 1 & 1 \\\\ -1 & -1 \\end{pmatrix} = a \\begin{pmatrix} C-1 & C-1 \\\\ 1-C & -1-C \\end{pmatrix}$.\n$M_e^{-1} = \\frac{1}{h} \\begin{pmatrix} 1 & 0 \\\\ 0 & 3 \\end{pmatrix}$.\n$S(\\theta) = \\frac{a}{h} \\begin{pmatrix} 1 & 0 \\\\ 0 & 3 \\end{pmatrix} \\begin{pmatrix} C-1 & C-1 \\\\ 1-C & -3(1+C) \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} C-1 & C-1 \\\\ 3(1-C) & -3(1+C) \\end{pmatrix}$.\n\nThe eigenvalues $\\lambda$ of $S(\\theta)$ satisfy the characteristic equation $\\det(S(\\theta) - \\lambda I) = 0$.\nLet $H(\\theta) = \\frac{h}{a}S(\\theta)$. The eigenvalues of $H(\\theta)$, denoted $\\tilde{\\lambda}$, are related by $\\lambda = \\frac{a}{h}\\tilde{\\lambda}$.\nThe characteristic equation for $\\tilde{\\lambda}$ is $\\tilde{\\lambda}^2 - \\text{tr}(H)\\tilde{\\lambda} + \\det(H) = 0$.\n$\\text{tr}(H) = (C-1) - 3(1+C) = -4-2C$.\n$\\det(H) = (C-1)(-3(1+C)) - (C-1)(3(1-C)) = (C-1)[-3-3C - 3+3C] = -6(C-1) = 6-6C$.\nThe equation is $\\tilde{\\lambda}^2 + (4+2C)\\tilde{\\lambda} + (6-6C) = 0$.\nThe solutions are:\n$$\n\\tilde{\\lambda} = \\frac{-(4+2C) \\pm \\sqrt{(4+2C)^2 - 4(6-6C)}}{2} = -(2+C) \\pm \\sqrt{(2+C)^2 - (6-6C)}\n$$\n$$\n\\tilde{\\lambda} = -(2+C) \\pm \\sqrt{C^2+4C+4 - 6+6C} = -(2+C) \\pm \\sqrt{C^2+10C-2}\n$$\nThe two eigenvalues for $\\lambda = \\frac{a}{h} \\tilde{\\lambda}$ are:\n$$\n\\lambda(\\theta) = \\frac{a}{h} \\left( -(2+\\exp(-i\\theta)) \\pm \\sqrt{\\exp(-i2\\theta)+10\\exp(-i\\theta)-2} \\right)\n$$\nTo identify the physical branch, we examine the behavior as $\\theta \\to 0$. The continuous operator $\\partial_t = -a\\partial_x$ has symbol $-iak = -ia\\frac{\\theta}{h}$.\nLet's expand for small $\\theta$: $C = \\exp(-i\\theta) \\approx 1-i\\theta - \\frac{\\theta^2}{2}$.\n$-(2+C) \\approx -3+i\\theta+\\frac{\\theta^2}{2}$.\nThe term under the square root becomes $\\sqrt{(1-i\\theta)^2 + 10(1-i\\theta) - 2} \\approx \\sqrt{1-2i\\theta + 10-10i\\theta - 2} = \\sqrt{9-12i\\theta} = 3\\sqrt{1-\\frac{4}{3}i\\theta} \\approx 3(1-\\frac{2}{3}i\\theta) = 3-2i\\theta$.\nThe two branches for $\\tilde{\\lambda}$ are:\n$\\tilde{\\lambda}_+ \\approx (-3+i\\theta) + (3-2i\\theta) = -i\\theta$.\n$\\tilde{\\lambda}_- \\approx (-3+i\\theta) - (3-2i\\theta) = -6+3i\\theta$.\nThe corresponding eigenvalues $\\lambda$ are:\n$\\lambda_+ \\approx \\frac{a}{h}(-i\\theta) = -iak$. This is the physical branch.\n$\\lambda_- \\approx \\frac{a}{h}(-6+3i\\theta)$. This is a non-physical, damped numerical mode.\nThe physical branch corresponds to the '+' sign in our solution for $\\lambda$.\n\n**4. Lax Equivalence Theorem and Stability**\n\nThe Lax-Richtmyer equivalence theorem states that for a consistent linear scheme, stability is necessary and sufficient for convergence.\nThe DG scheme is consistent, as demonstrated by the fact that the physical eigenvalue branch approaches the symbol of the continuous operator for long wavelengths ($k h \\to 0$).\nThe choice of an upwind numerical flux is crucial for stability. For $a>0$, this choice introduces numerical dissipation at element interfaces, which removes energy from the system that would otherwise accumulate due to the discontinuous representation. A formal energy analysis, by setting the test function $v_h=u_h$, shows that the rate of change of the total energy $\\frac{d}{dt} \\int |u_h|^2 dx$ is non-positive. This energy stability (or $L^2$-stability) implies that the real parts of all eigenvalues $\\lambda$ of the semidiscrete operator are non-positive, i.e., $\\text{Re}(\\lambda) \\le 0$.\nSince the scheme is consistent and stable, it is convergent.\n\nThe requested final answer is the closed-form expression for the physical branch eigenvalue, $\\lambda_{\\mathrm{phys}}(\\theta)$.",
            "answer": "$$ \\boxed{ \\frac{a}{h} \\left( -(2+\\exp(-i\\theta)) + \\sqrt{\\exp(-i2\\theta)+10\\exp(-i\\theta)-2} \\right) } $$"
        }
    ]
}