{
    "hands_on_practices": [
        {
            "introduction": "Lax等价定理是数值分析的基石，它将相容性、稳定性与收敛性联系起来。第一个练习将挑战你探索稳定性的必要性。你将构建一个与平流方程相容的间断Galerkin格式，但由于采用了中心通量格式，该格式是无条件不稳定的，从而证明仅有相容性无法保证得到有意义的数值解。",
            "id": "3394971",
            "problem": "考虑一个定义在周期区间上的一维线性平流初值问题，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\\quad x\\in[0,L],\\ t\\ge 0,\\quad a>0,\n$$\n具有光滑的周期性初始数据 $u(x,0) = u_{0}(x)$。将空间域离散化为 $N$ 个大小为 $h=L/N$ 的均匀单元，并使用间断 Galerkin (DG) 方法在每个单元上以分片常数（多项式次数 $p=0$）来逼近 $u$。对平流通量使用中心数值通量，即在每个交界面上使用 $F^{*}(u^{-},u^{+}) = a\\,\\frac{u^{-}+u^{+}}{2}$，并使用时间步长为 $\\Delta t>0$ 的前向欧拉法进行时间推进。定义 Courant 数 $\\nu = \\frac{a\\,\\Delta t}{h}$。\n\n从 DG 弱形式出发，取检验函数为单元上的常数基函数，推导单元平均值 $u_{j}^{n}$ 的全离散更新格式，其中 $j\\in\\{0,1,\\dots,N-1\\}$ 为单元索引，$n\\in\\mathbb{N}$ 为时间步索引。然后，在周期性网格上，通过考虑单个 Fourier 模 $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,\\theta\\,j)$（其中 $\\theta\\in[-\\pi,\\pi]$ 以弧度为单位）进行 von Neumann (Fourier) 分析，并求出单步放大因子 $G(\\theta,\\nu)$。\n\n利用此分析，计算放大因子模在所有 Fourier 模上的上确界，\n$$\n\\sup_{\\theta\\in[-\\pi,\\pi]} |G(\\theta,\\nu)|,\n$$\n并将其表示为仅含 Courant 数 $\\nu$ 的函数。最后，使用关于线性格式的 Lax 等价定理来解释为何此格式是非收敛的，尽管当 $\\nu$ 很小时，对于光滑的初始数据可能表现出表观上的短期精度。你的最终答案必须是 $\\sup_{\\theta} |G(\\theta,\\nu)|$ 的闭式解析表达式。",
            "solution": "该问题要求对一维线性平流方程的间断 Galerkin (DG) 格式进行推导和分析。分析的最终目的是基于 Lax 等价定理，解释该格式的非收敛性。\n\n控制偏微分方程 (PDE) 是线性平流方程：\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0\n$$\n定义在周期域 $x\\in[0,L]$ 上，时间 $t\\ge 0$，具有恒定的平流速度 $a>0$。\n\n首先，我们推导全离散数值格式。DG 方法从弱形式出发。我们将 PDE 乘以一个与数值解 $u_h(x,t)$ 处于相同逼近空间的检验函数 $v_h(x)$，然后在大小为 $h$ 的计算单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分。对于多项式次数 $p=0$ 的情况，逼近解 $u_h(x,t)$ 是一个分片常数函数，在单元 $I_j$ 上取值为 $u_j(t)$。检验函数 $v_h(x)$ 是相应的基函数，它在 $I_j$ 上为 1，在其他地方为 0。\n\n在单元 $I_j$ 上的弱形式为：\n$$\n\\int_{I_j} v_h(x) \\left( \\partial_{t} u_h(x,t) + a\\,\\partial_{x} u_h(x,t) \\right) dx = 0\n$$\n对平流项进行分部积分，我们得到：\n$$\n\\int_{I_j} v_h \\partial_{t} u_h dx + \\left[ v_h a u_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} ( \\partial_{x} v_h ) a u_h dx = 0\n$$\n由于在 $I_j$ 上 $u_h(x,t) = u_j(t)$ 且 $v_h(x) = 1$，时间导数项变为 $\\int_{I_j} \\partial_t u_j(t) dx = h \\frac{du_j}{dt}$。因为 $v_h$ 在单元上是常数，其导数 $\\partial_x v_h$ 在单元内部为零。方程简化为：\n$$\nh \\frac{du_j}{dt} + a u_h(x_{j+1/2},t) - a u_h(x_{j-1/2},t) = 0\n$$\n项 $u_h(x_{j\\pm1/2},t)$ 在解不连续的单元交界面处取值。这些单值通量必须由一个数值通量 $F^{*}(u^-, u^+)$ 代替，其中 $u^-$ 和 $u^+$ 分别是解在交界面左侧和右侧的值。半离散格式为：\n$$\nh \\frac{du_j}{dt} + F^*(u_j(t), u_{j+1}(t)) - F^*(u_{j-1}(t), u_j(t)) = 0\n$$\n在这里，在交界面 $x_{j+1/2}$ 处，$u^-=u_j(t)$ 且 $u^+=u_{j+1}(t)$。在交界面 $x_{j-1/2}$ 处，$u^-=u_{j-1}(t)$ 且 $u^+=u_j(t)$。问题指定了中心数值通量，$F^{*}(u^{-},u^{+}) = a\\,\\frac{u^{-}+u^{+}}{2}$。将此代入格式中：\n$$\nh \\frac{du_j}{dt} + a \\frac{u_j + u_{j+1}}{2} - a \\frac{u_{j-1} + u_j}{2} = 0\n$$\n简化表达式得到：\n$$\nh \\frac{du_j}{dt} = - \\frac{a}{2} (u_j + u_{j+1} - u_{j-1} - u_j) = - \\frac{a}{2} (u_{j+1} - u_{j-1})\n$$\n这是半离散格式。现在，我们应用前向欧拉法进行时间离散化，其中 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t}$ 逼近 $\\frac{du_j}{dt}$：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{a}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\n重新整理并引入 Courant 数 $\\nu = \\frac{a\\,\\Delta t}{h}$，我们得到全离散更新方程：\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2h} (u_{j+1}^n - u_{j-1}^n) = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\n这个格式与从空间中心差分和时间前向欧拉的有限差分法推导出的格式完全相同。\n\n接下来，我们进行 von Neumann 稳定性分析。我们考虑解的单个 Fourier 模，形式为 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$，其中 $\\theta \\in [-\\pi, \\pi]$ 是无量纲波数。将其代入离散格式得到：\n$$\n\\hat{u}^{n+1}\\exp(i\\theta j) = \\hat{u}^{n}\\exp(i\\theta j) - \\frac{\\nu}{2} \\left( \\hat{u}^{n}\\exp(i\\theta (j+1)) - \\hat{u}^{n}\\exp(i\\theta (j-1)) \\right)\n$$\n两边同除以 $\\hat{u}^{n}\\exp(i\\theta j)$（假设其非零），我们求得放大因子 $G(\\theta,\\nu) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$：\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} \\left( \\exp(i\\theta) - \\exp(-i\\theta) \\right)\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，我们有 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin\\theta$。放大因子变为：\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} (2i\\sin\\theta) = 1 - i\\nu\\sin\\theta\n$$\n现在，我们计算这个复值放大因子的模在所有可能的模 $\\theta \\in [-\\pi, \\pi]$ 上的上确界。其模为：\n$$\n|G(\\theta,\\nu)| = |1 - i\\nu\\sin\\theta| = \\sqrt{1^2 + (-\\nu\\sin\\theta)^2} = \\sqrt{1 + \\nu^2\\sin^2\\theta}\n$$\n为了求得上确界，我们需要关于 $\\theta$ 最大化这个表达式。因为 $\\nu = \\frac{a\\Delta t}{h} > 0$ 且平方根函数是单调的，所以最大化 $|G(\\theta,\\nu)|$ 等价于最大化 $\\sin^2\\theta$。对于 $\\theta \\in [-\\pi,\\pi]$，$\\sin\\theta$ 的值域是 $[-1,1]$，所以 $\\sin^2\\theta$ 的最大值是 1，这在 $\\theta = \\pm\\frac{\\pi}{2}$ 时取得。\n因此，放大因子模的上确界是：\n$$\n\\sup_{\\theta\\in[-\\pi,\\pi]} |G(\\theta,\\nu)| = \\sqrt{1 + \\nu^2(1)^2} = \\sqrt{1 + \\nu^2}\n$$\n最后，我们使用 Lax 等价定理来解释为什么这个格式是非收敛的。该定理指出，对于一个线性的、适定的初值问题，一个相容的数值格式是收敛的当且仅当它是稳定的。\n\n1.  **线性**：该 PDE 和离散格式都是线性的。\n2.  **相容性**：该格式是平流方程的一个标准有限差分逼近（空间中心差分，时间前向差分）。泰勒级数展开显示其截断误差为 $O(\\Delta t, h^2)$，当 $\\Delta t, h \\to 0$ 时，该误差趋于零。因此，该格式是相容的。\n3.  **稳定性**：一个格式在 von Neumann 意义下是稳定的，要求其放大因子对于所有相关模 $\\theta$ 和时空加密过程都满足 $|G(\\theta,\\nu)| \\le 1$。在我们的例子中，我们发现 $|G(\\theta, \\nu)| = \\sqrt{1 + \\nu^2\\sin^2\\theta}$。对于任何 $\\nu > 0$，只要 $\\sin\\theta \\neq 0$（即，除了零频模 $\\theta=0$ 或混叠的零频模 $\\theta=\\pm\\pi$ 之外的任何模），这个值都严格大于 1。具体来说，$\\sup_\\theta |G(\\theta,\\nu)| = \\sqrt{1+\\nu^2} > 1$。\n\n由于对于任何 $\\nu > 0$ 的选择，稳定性条件 $|G| \\le 1$ 都被违反，该格式是无条件不稳定的。初始数据中存在的任何数值误差或高频分量都会随时间指数级放大，导致数值解的爆破。\n\n根据 Lax 等价定理，由于该格式是相容但不稳定的，因此它是**非收敛的**。对于光滑初始数据，问题可能表现出表观上的短期精度的原因在于，光滑数据的极小高频分量，而不稳定性正是在这些高频处最为严重（在 $\\theta=\\pm\\pi/2$ 处，对应网格上的最高非混叠频率）。当 $\\nu$ 很小时，放大因子仅略大于 1（例如， $|G| \\approx 1 + \\frac{1}{2}\\nu^2\\sin^2\\theta$）。每个时间步的增长很小，但会累积。对于任何固定的时间 $T = n\\Delta t$，当我们加密网格时（$\\Delta t \\to 0$，$n \\to \\infty$），总放大 $(|G|)^n$ 将会发散，从而证实了其不收敛性。",
            "answer": "$$\n\\boxed{\\sqrt{1 + \\nu^2}}\n$$"
        },
        {
            "introduction": "在看到相容性并非充分条件后，我们现在来研究Lax等价定理的另一个支柱：相容性本身。本练习将指导你构建一个完全稳定（保范数）的傅里叶谱方法格式，但该格式被刻意设计为与目标齐次方程不相容。通过分析这个格式，你将发现一个稳定的方法为何会无法收敛到正确解，而是收敛到它所隐式代表的另一个问题的解。",
            "id": "3394996",
            "problem": "考虑周期性线性平流初值问题 $u_{t} + a\\,u_{x} = 0$，其中 $x \\in [0,2\\pi]$ 且 $t \\ge 0$，满足周期性边界条件和零初始数据 $u(x,0) = 0$。该问题是适定的，其意义是对于合适的赋范空间中的任何可容许初始数据，都存在唯一解，且该解连续依赖于初始数据。在谱方法和间断伽辽金 (DG) 方法的背景下，如果一个线性格式的齐次部分在所选范数下产生有界演化，则称该格式是稳定的；如果离散算子作用于足够光滑的精确解所产生的残差在网格加密时趋于零，则称该格式是一致的。\n\n构造如下具有 $N$ 个模式（由整数 $k$ 标记，其中 $|k| \\le K$ 且 $N = 2K+1$）的傅里叶谱半离散格式：将 $u_{N}(x,t)$ 展开为 $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$，并根据以下方程演化模态系数\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0},\n$$\n其中参数 $a = 1$，强迫振幅 $\\gamma = 1$，$\\delta_{k,0}$ 为克罗内克 δ 函数。假设对该半离散系统进行精确的时间积分。该格式是线性的，其齐次部分对应于斜伴随平流算子的标准傅里叶谱离散化，该离散化在 $L^{2}$ 范数下是保范数的。然而，所添加的零模强迫项使得该格式与原始齐次问题不一致。\n\n使用第一性原理推导，从上述定义和半离散系统的精确演化出发，证明该格式是稳定的（其意义是齐次演化保持 $L^{2}$ 范数）但不一致，并解释为什么它不收敛到精确解 $u \\equiv 0$。然后，计算在时间 $t = 1$ 时 $L^{2}$ 误差的极限，当模式数 $N \\to \\infty$ 时：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)}.\n$$\n将您的最终答案表示为单个闭式解析表达式。无需四舍五入。如果涉及角度，必须以弧度表示。",
            "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n给定条件如下：\n1.  偏微分方程 (PDE) 是线性平流方程：$u_{t} + a\\,u_{x} = 0$。\n2.  空间域为 $x \\in [0,2\\pi]$，具有周期性边界条件。\n3.  时间域为 $t \\ge 0$。\n4.  初始条件为 $u(x,0) = 0$。\n5.  提出了一个用于数值解 $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$ 的傅里叶谱半离散格式，其中 $N = 2K+1$。\n6.  模态系数 $\\hat{u}_{k}(t)$ 的演化由常微分方程 (ODE) 系统给出：$\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}$。\n7.  格式的初始条件与 $u(x,0)=0$ 一致，这意味着对所有 $k$ 都有 $\\hat{u}_{k}(0)=0$。\n8.  参数指定为 $a = 1$ 和 $\\gamma = 1$。\n9.  初值问题的精确解是对所有 $x$ 和 $t$ 都有 $u(x,t) = 0$。\n10. 任务是证明该格式是稳定的但不一致，解释由此导致的不收敛性，并计算当 $N \\to \\infty$ 时在 $t=1$ 处的 $L^{2}$ 误差的极限。\n\n该问题在数学上是明确定义的，内部是一致的，并直接关系到偏微分方程数值方法的分析，特别是 Lax 等价定理所描述的稳定性、一致性和收敛性之间的相互作用。所构造的格式是一个用于说明一致性重要性的教科书式例子。因此，该问题是有效的。\n\n我们继续求解，包括三个部分：分析稳定性和一致性，解释不收敛性，以及计算误差。\n\n首先，我们分析格式的稳定性。根据问题陈述，稳定性由格式的齐次部分的行为决定。给定的半离散格式是：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}\n$$\n通过移除强迫项 $\\gamma\\,\\delta_{k,0}$ 得到齐次部分：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}^{h}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}^{h}(t)\n$$\n其中 $\\hat{u}_{k}^{h}(t)$ 表示齐次演化的系数。这个线性常微分方程的解是 $\\hat{u}_{k}^{h}(t) = \\hat{u}_{k}^{h}(0) \\exp(-iakt)$。数值解 $u_{N}(x,t)$ 的 $L^{2}$ 范数通过帕塞瓦尔定理（Parseval's theorem）与其傅里叶系数相关联：\n$$\n\\left\\| u_{N}(\\cdot, t) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |u_{N}(x,t)|^{2} dx = 2\\pi \\sum_{|k| \\le K} |\\hat{u}_{k}(t)|^{2}\n$$\n对于齐次演化，我们考察系数的模平方：\n$$\n|\\hat{u}_{k}^{h}(t)|^{2} = \\left| \\hat{u}_{k}^{h}(0) \\exp(-iakt) \\right|^{2} = |\\hat{u}_{k}^{h}(0)|^{2} |\\exp(-iakt)|^{2} = |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n因为对于任意实数 $\\theta$，都有 $|\\exp(i\\theta)|=1$。对所有模式求和，我们得到：\n$$\n\\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(t)|^{2} = \\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n这意味着 $\\left\\| u_{N}^{h}(\\cdot, t) \\right\\|_{L^{2}}^{2} = \\left\\| u_{N}^{h}(\\cdot, 0) \\right\\|_{L^{2}}^{2}$。齐次格式解的 $L^{2}$ 范数在所有时间上都是守恒的。保持范数的演化是有界的（算子范数为 1）。因此，根据所提供的定义，该格式是稳定的。\n\n其次，我们分析一致性。如果截断误差——即将偏微分方程的精确解代入数值格式所得到的残差——在离散化加密（$N \\to \\infty$）时趋于零，则格式与偏微分方程是一致的。$u_{t} + a u_{x} = 0$ 且 $u(x,0)=0$ 的精确解是对所有 $t \\ge 0$ 都有 $u(x,t) = 0$。精确解的傅里叶系数是对所有 $k$ 和 $t$ 都有 $\\hat{u}_{k,exact}(t) = 0$。\n我们将这些精确解的系数代入完整的数值格式，以求得每个模式的残差 $\\tau_k(t)$：\n$$\n\\tau_k(t) = \\frac{d}{dt}\\hat{u}_{k,exact}(t) - \\left( -iak\\,\\hat{u}_{k,exact}(t) + \\gamma\\,\\delta_{k,0} \\right)\n$$\n代入 $\\hat{u}_{k,exact}(t) = 0$ 及其时间导数 $\\frac{d}{dt}(0)=0$：\n$$\n\\tau_k(t) = 0 - \\left( -iak \\cdot 0 + \\gamma\\,\\delta_{k,0} \\right) = -\\gamma\\,\\delta_{k,0}\n$$\n当 $\\gamma=1$ 时，残差为 $\\tau_k(t) = -\\delta_{k,0}$。对于模式 $k=0$，残差为 $\\tau_0 = -1$，而对于所有其他模式 $k \\neq 0$，残差为 $\\tau_k = 0$。零模的残差是一个非零常数。它不依赖于模式数 $N$，因此当 $N \\to \\infty$ 时不趋于零。因此，该格式与齐次偏微分方程 $u_t + a u_x = 0$ 不一致。\n\n不收敛是这种不一致性的直接后果，正如 Lax-Richtmyer 等价定理所解释的。该定理指出，对于一个适定的线性初值问题，一个一致的线性有限差分格式是收敛的，当且仅当它是稳定的。在这里，格式是稳定的但不一致。定理中关于收敛的条件没有得到满足。该格式实际上是另一个不同偏微分方程 $u_t + a u_x = F(x)$ 的一致离散化，其中 $F(x)$ 是一个函数，其傅里叶系数为 $\\gamma\\,\\delta_{k,0}$。这对应于一个空间上恒定的强迫项 $F(x) = \\gamma=1$。该数值格式正在解决一个错误的问题，因此其解不收敛于预期问题的解。源项 $\\gamma\\,\\delta_{k,0}$ 持续向零模注入一个非物理信号，导致数值解偏离真实解 $u=0$。\n\n最后，我们计算在 $t=1$ 时 $L^{2}$ 误差的极限。我们必须求解具有指定参数 $a=1$，$\\gamma=1$ 和初始条件 $\\hat{u}_k(0)=0$ 的半离散系统的精确解。常微分方程组为：\n$$\n\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t) + \\delta_{k,0}\n$$\n我们分两种情况求解。\n情况1：$k \\neq 0$。方程为 $\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t)$。在初始条件 $\\hat{u}_k(0)=0$ 下，唯一解为对所有 $t$ 都有 $\\hat{u}_{k}(t)=0$。\n情况2：$k=0$。方程为 $\\frac{d}{dt}\\hat{u}_{0}(t) = -i(0)\\hat{u}_{0}(t) + 1$，简化为 $\\frac{d}{dt}\\hat{u}_{0}(t) = 1$。从 $0$ 到 $t$ 积分得到 $\\hat{u}_{0}(t) - \\hat{u}_{0}(0) = \\int_0^t 1 ds = t$。由于 $\\hat{u}_{0}(0)=0$，我们有 $\\hat{u}_{0}(t)=t$。\n\n因此，数值解的系数为 $\\hat{u}_{k}(t) = t\\,\\delta_{k,0}$。物理空间中的数值解是：\n$$\nu_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(ikx) = \\hat{u}_{0}(t)\\exp(i \\cdot 0 \\cdot x) = t\n$$\n解 $u_{N}(x,t)=t$ 是一个在空间上恒定且随时间线性增长的函数。这个解对任何 $N \\ge 1$（即 $K \\ge 0$）都有效。\n\n误差是 $e_{N}(x,t) = u_{N}(x,t) - u(x,t) = t - 0 = t$。\n题目要求我们计算在时间 $t=1$ 时误差的 $L^{2}$ 范数。此时的误差是 $e_N(x,1) = 1$。\n误差的 $L^{2}$ 范数的平方是：\n$$\n\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |e_{N}(x,1)|^{2} dx = \\int_{0}^{2\\pi} |1|^{2} dx = \\int_{0}^{2\\pi} 1 dx = 2\\pi\n$$\n因此，在 $t=1$ 时误差的 $L^{2}$ 范数是 $\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}$。\n\n这个结果与 $N$ 无关。因此，当 $N \\to \\infty$ 时的极限是相同的值：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}\n$$\n这个非零极限证实了该格式不收敛于精确解。",
            "answer": "$$\n\\boxed{\\sqrt{2\\pi}}\n$$"
        },
        {
            "introduction": "Lax等价定理的威力取决于其所应用的底层问题是适定的。这最后一个练习将挑战这一定理的边界，要求你对不适定的反向热传导方程进行离散化。你将发现，你所构建的相容数值格式是内在地不稳定的，这恰恰反映了连续问题的本质，因此无法实现收敛，从而突显了该定理适用范围的一个关键限制。",
            "id": "3395033",
            "problem": "考虑在周期性环面 $[0,2\\pi]$ 上设定的反向热传导方程，\n$$\nu_{t}(x,t) \\;=\\; -\\nu\\,u_{xx}(x,t), \\qquad x\\in[0,2\\pi],\\; t\\ge 0,\n$$\n其中 $\\nu>0$ 且在 $x$ 方向上具有周期性边界条件。令 $\\Pi_{K}$ 表示到傅里叶模 $\\{\\exp(\\mathrm{i}kx)\\}_{|k|\\le K}$ 的张成空间上的傅里叶-伽辽金投影算子，其中 $K\\in\\mathbb{N}$ 是谱截断波数。考虑将空间上的傅里叶-伽辽金半离散化与时间上的向前欧拉法相结合得到的全离散格式，即\n$$\nu^{n+1}_{K} \\;=\\; u^{n}_{K} \\;+\\; \\Delta t\\,\\big(-\\nu\\,\\Pi_{K}\\partial_{xx} u^{n}_{K}\\big), \\qquad n=0,1,2,\\dots,\n$$\n其中 $\\Delta t>0$ 是时间步长，而 $u^{n}_{K}\\in\\operatorname{range}(\\Pi_{K})$ 是在时间 $t^{n}=n\\Delta t$ 时的数值解。\n\n任务：\n- 从傅里叶-伽辽金投影和向前欧拉时间步进的定义出发，推导对于 $|k|\\le K$ 的模 $\\exp(\\mathrm{i}kx)$ 的系数 $u^{n}_{k}$ 的逐模更新公式，并求出相应的冯·诺依曼放大因子 $G(k)$。\n- 使用局部截断误差的定义，证明该格式对于每个固定的傅里叶模都与反向热传导方程相容，并且对于光滑数据，在 $K\\to\\infty$ 时在谱意义下是相容的。\n- 使用放大因子分析该格式在 $K$ 变化时的冯·诺依曼稳定性。特别地，确定在所有保留的模态 $|k|\\le K$ 上的每步最大放大因子，并论证为何稳定性关于 $K$ 不是一致的；解释为什么对于这个不适定问题，在线性格式的 Lax 等价定理框架内，相容性并不意味着收敛性。\n- 报告每步最大放大因子作为 $\\nu$、$\\Delta t$ 和 $K$ 的函数的精确解析表达式。您的最终答案必须是这个单一的闭式表达式，不带单位，也无额外评论。",
            "solution": "问题陈述被认为是有效的，因为它提出了一组适定的任务，涉及对应用于数学定义的偏微分方程的数值方法的标准分析。该方程本身，即反向热传导方程，是众所周知的不适定问题，但分析数值格式在应用于该方程时的行为是数值分析中一个标准且有意义的练习。该问题是自洽的，科学上基于数值偏微分方程的原理，并且没有任何说明中列出的导致无效的缺陷。\n\n我们开始解题。\n\n在时间 $t^n = n\\Delta t$ 的数值解，记作 $u^{n}_{K}$，属于由傅里叶模 $\\{\\exp(\\mathrm{i}kx)\\}_{|k|\\le K}$ 张成的空间。它可以表示为一个截断的傅里叶级数：\n$$\nu^{n}_{K}(x) = \\sum_{|k|\\le K} \\hat{u}^{n}_{k} \\exp(\\mathrm{i}kx)\n$$\n其中 $\\hat{u}^{n}_{k}$ 是在时间层 $n$ 的离散傅里叶系数。\n\n空间导数算子 $\\partial_{xx}$ 对 $u^{n}_{K}$ 的作用是：\n$$\n\\partial_{xx} u^{n}_{K}(x) = \\partial_{xx} \\left( \\sum_{|k|\\le K} \\hat{u}^{n}_{k} \\exp(\\mathrm{i}kx) \\right) = \\sum_{|k|\\le K} \\hat{u}^{n}_{k} (\\mathrm{i}k)^2 \\exp(\\mathrm{i}kx) = \\sum_{|k|\\le K} (-k^2) \\hat{u}^{n}_{k} \\exp(\\mathrm{i}kx)\n$$\n由于 $\\partial_{xx} u^{n}_{K}$ 已经处在 $\\{\\exp(\\mathrm{i}kx)\\}_{|k|\\le K}$ 的张成空间中，傅里叶-伽辽金投影算子 $\\Pi_{K}$ 对其作用如同单位算子：$\\Pi_{K} \\partial_{xx} u^{n}_{K} = \\partial_{xx} u^{n}_{K}$。\n\n现在我们将傅里叶级数表示代入全离散格式：\n$$\nu^{n+1}_{K} = u^{n}_{K} - \\nu \\Delta t\\, (\\Pi_{K}\\partial_{xx} u^{n}_{K})\n$$\n$$\n\\sum_{|k|\\le K} \\hat{u}^{n+1}_{k} \\exp(\\mathrm{i}kx) = \\sum_{|k|\\le K} \\hat{u}^{n}_{k} \\exp(\\mathrm{i}kx) - \\nu \\Delta t \\left( \\sum_{|k|\\le K} (-k^2) \\hat{u}^{n}_{k} \\exp(\\mathrm{i}kx) \\right)\n$$\n合并右侧的项：\n$$\n\\sum_{|k|\\le K} \\hat{u}^{n+1}_{k} \\exp(\\mathrm{i}kx) = \\sum_{|k|\\le K} \\left( \\hat{u}^{n}_{k} + \\nu \\Delta t k^2 \\hat{u}^{n}_{k} \\right) \\exp(\\mathrm{i}kx)\n$$\n由于傅里叶基函数 $\\{\\exp(\\mathrm{i}kx)\\}$ 在 $[0, 2\\pi]$ 上的正交性，我们可以令每个模态 $k$ 的系数相等：\n$$\n\\hat{u}^{n+1}_{k} = (1 + \\nu \\Delta t k^2) \\hat{u}^{n}_{k}\n$$\n这是逐个傅里叶模的更新法则。冯·诺依曼放大因子 $G(k)$ 是第 $k$ 个模的系数在每个时间步长上乘以的因子。因此，\n$$\nG(k) = 1 + \\nu \\Delta t k^2\n$$\n\n为了分析相容性，我们考察局部截断误差。对于单模态初始条件 $u(x,0)=\\exp(\\mathrm{i}kx)$，反向热传导方程 $u_t = -\\nu u_{xx}$ 的精确解是 $u_k(x,t) = \\exp(\\mathrm{i}kx + \\nu k^2 t)$。在时间 $t$ 的精确系数是 $\\hat{u}_k(t) = \\exp(\\nu k^2 t)$。\n模态 $k$ 的数值算子是 $L_{\\Delta t} \\hat{u}^n_k = \\frac{\\hat{u}^{n+1}_k - \\hat{u}^n_k}{\\Delta t}$。离散空间算子得到 $\\nu k^2 \\hat{u}^n_k$。该格式为 $\\frac{\\hat{u}^{n+1}_k - \\hat{u}^n_k}{\\Delta t} = \\nu k^2 \\hat{u}^n_k$。\n将精确解代入数值格式，可以得到模态 $k$ 的局部截断误差：\n$$\n\\tau_k = \\frac{\\hat{u}_k(t+\\Delta t) - \\hat{u}_k(t)}{\\Delta t} - \\nu k^2 \\hat{u}_k(t) = \\frac{\\exp(\\nu k^2(t+\\Delta t)) - \\exp(\\nu k^2 t)}{\\Delta t} - \\nu k^2 \\exp(\\nu k^2 t)\n$$\n提出因子 $\\exp(\\nu k^2 t)$：\n$$\n\\tau_k = \\exp(\\nu k^2 t) \\left[ \\frac{\\exp(\\nu k^2 \\Delta t) - 1}{\\Delta t} - \\nu k^2 \\right]\n$$\n使用泰勒展开 $\\exp(z) = 1 + z + \\frac{z^2}{2} + O(z^3)$，其中 $z = \\nu k^2 \\Delta t$：\n$$\n\\tau_k = \\exp(\\nu k^2 t) \\left[ \\frac{(1 + \\nu k^2 \\Delta t + \\frac{(\\nu k^2 \\Delta t)^2}{2} + O(\\Delta t^3)) - 1}{\\Delta t} - \\nu k^2 \\right]\n$$\n$$\n\\tau_k = \\exp(\\nu k^2 t) \\left[ (\\nu k^2 + \\frac{\\nu^2 k^4 \\Delta t}{2} + O(\\Delta t^2)) - \\nu k^2 \\right] = \\exp(\\nu k^2 t) \\left(\\frac{\\nu^2 k^4 \\Delta t}{2}\\right) + O(\\Delta t^2)\n$$\n对于任何固定的模态 $k$，当 $\\Delta t \\to 0$ 时，截断误差 $\\tau_k \\to 0$。这证明了对每个模态的相容性。对于光滑数据，总截断误差由这个时间误差和投影产生的空间误差 $\\nu(\\Pi_K-I)u_{xx}$ 组成。当 $K\\to\\infty$ 时，对于光滑的 $u$，这个投影误差也趋于零。因此，该格式是相容的。\n\n对于冯·诺依曼稳定性，我们要求放大因子的模是有界的，通常为 $|G(k)| \\le 1$。在我们的情况下，\n$$\n|G(k)| = |1 + \\nu \\Delta t k^2|\n$$\n由于 $\\nu > 0$, $\\Delta t > 0$ 且 $k^2 \\ge 0$，项 $\\nu \\Delta t k^2$ 总是非负的。\n$$\n|G(k)| = 1 + \\nu \\Delta t k^2 \\ge 1\n$$\n对于任何非零波数 $k$，$|G(k)| > 1$。任何 $k \\ne 0$ 的模的振幅在每个时间步都会增长。该格式对于所有非零模态都是无条件不稳定的。\n\n在所有保留的模态 $|k|\\le K$ 上的每步最大放大因子出现在最大波数处，即 $|k|=K$ 时，因为 $G(k)$ 是 $k^2$ 的单调递增函数。\n$$\n\\max_{|k|\\le K} |G(k)| = G(K) = 1 + \\nu \\Delta t K^2\n$$\n随着谱截断 $K$ 的增加以提高空间精度，这个最大放大因子以 $K^2$ 的速度增长，并且在 $K\\to\\infty$ 时是无界的。因此，该格式关于 $K$ 不是一致稳定的。\n\nLax 等价定理指出，对于一个线性的、适定的初值问题，一个相容的格式是收敛的当且仅当它是稳定的。该定理的关键假设是底层的偏微分方程问题必须是适定的。反向热传导方程是不适定问题的一个经典例子。初始数据中的高频分量会指数级快速增长，这意味着解不连续地依赖于初始数据。\n我们的分析表明，该数值格式与偏微分方程相容，但无条件不稳定。该格式的不稳定性反映了连续问题的不适定性。对于小的 $\\Delta t$，放大因子 $G(k) \\approx \\exp(\\nu \\Delta t k^2)$ 正确地近似了单个时间步内精确解的放大因子 $\\exp(\\nu k^2 \\Delta t)$。由于偏微分方程问题是不适定的，Lax 等价定理不适用。相容性并不意味着收敛性，因为稳定性条件不满足，而这种失效是该格式作为不适定物理过程的精确模型的直接且必然的结果。\n\n最后，从稳定性分析中推导出在保留模态 $|k|\\le K$ 上的每步最大放大因子的精确解析表达式。",
            "answer": "$$\n\\boxed{1 + \\nu \\Delta t K^2}\n$$"
        }
    ]
}