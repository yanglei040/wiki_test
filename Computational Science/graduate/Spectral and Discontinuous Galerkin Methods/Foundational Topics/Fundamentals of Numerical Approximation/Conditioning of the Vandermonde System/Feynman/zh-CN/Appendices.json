{
    "hands_on_practices": [
        {
            "introduction": "我们从一个经典的数值实验开始，具体探究多项式插值中的一个严重问题：由等距节点构建的范德蒙矩阵的病态性。这个练习将提供切实的证据，展示随着多项式次数的增加，这些系统会如何迅速变得数值不稳定，以及插值区间的选择会如何影响其条件数。",
            "id": "3256284",
            "problem": "考虑牛顿-科特斯求积法则的推导，其中的权重是通过强制其在多项式基上精确积分来确定的。设一个区间上有 $n$ 个等距节点，记为 $x_0, x_1, \\dots, x_{n-1}$。为了构造能够精确积分最高为 $n-1$ 次多项式的权重，需要使用一个匹配单项式矩的线性系统。该线性系统中的系数矩阵是范德蒙矩阵 $V \\in \\mathbb{R}^{n \\times n}$，其元素为 $V_{i,j} = x_i^j$，其中 $i = 0,1,\\dots,n-1$ 且 $j = 0,1,\\dots,n-1$。求解此类线性系统的数值敏感性由矩阵 $V$ 的2-范数条件数决定，其定义为 $\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2$，可计算为 $V$ 的最大奇异值与最小奇异值之比。\n\n从一个基本事实出发：牛顿-科特斯权重是通过求解一个线性系统得到的，该系统的系数矩阵是一个由等距节点构造的范德蒙矩阵。结合通过奇异值定义的矩阵2-范数条件数，请研究该范德蒙矩阵的条件数如何依赖于节点数 $n$ 和区间缩放。具体来说，比较两个区间：\n(1) 单位区间 $[0,1]$，节点为 $x_i = \\frac{i}{n-1}$（当 $n > 1$ 时）和 $x_0 = 0$（当 $n = 1$ 时），以及\n(2) 对称区间 $[-1,1]$，节点为 $x_i = -1 + \\frac{2 i}{n-1}$（当 $n > 1$ 时）和 $x_0 = 0$（当 $n = 1$ 时）。\n对于每个 $n$，使用单项式基 $1, x, x^2, \\dots, x^{n-1}$ 构造相应的范德蒙矩阵 $V$，通过奇异值分解计算 $\\kappa_2(V)$，并报告两个区间上以10为底的对数值 $\\log_{10}(\\kappa_2(V))$。此外，报告差值 $\\log_{10}(\\kappa_2(V \\text{ on } [0,1])) - \\log_{10}(\\kappa_2(V \\text{ on } [-1,1]))$ 以量化区间缩放对条件数的影响。\n\n您的任务是编写一个完整的、可运行的程序，对以下节点数 $n$ 的测试集 $n \\in \\{1,2,3,5,10,15,20\\}$ 以双精度执行这些计算。该测试集包括一个边界情况 $n=1$、一些小案例以及条件数变得非常大的大案例。对于测试集中的每个 $n$，您的程序必须输出一个浮点数三元组 $[\\log_{10}(\\kappa_2(V_{[0,1]})), \\log_{10}(\\kappa_2(V_{[-1,1]})), \\log_{10}(\\kappa_2(V_{[0,1]})) - \\log_{10}(\\kappa_2(V_{[-1,1]}))]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应测试集中的一个 $n$，其本身也是一个用方括号括起来的逗号分隔三元组。例如，输出应类似于 $[[a,b,c],[d,e,f],\\dots]$，不含空格。\n\n不涉及物理单位或角度。所有答案必须是指定的浮点数，并且数值应按照描述使用通过奇异值计算的矩阵2-范数条件数来计算。",
            "solution": "该问题要求研究在两个不同区间（单位区间 $[0,1]$ 和对称区间 $[-1,1]$）上由等距节点构造的范德蒙矩阵的数值条件数。这项分析对于理解推导牛顿-科特斯求积权重方法的数值稳定性至关重要，因为这些方法依赖于求解一个包含此类矩阵的线性系统。\n\n对于一个能精确积分所有最高为 $n-1$ 次多项式的 $n$ 点求积法则，其权重的推导需要求解线性系统 $Vw = \\mathbf{m}$。在该系统中，$V$ 是一个 $n \\times n$ 的范德蒙矩阵，$w$ 是未知权重的向量，$\\mathbf{m}$ 是单项式基函数的矩向量，其元素为 $m_j = \\int_a^b x^j dx$，其中 $j=0, 1, \\dots, n-1$。范德蒙矩阵 $V$ 由 $n$ 个求积节点 $x_0, x_1, \\dots, x_{n-1}$ 构造，其元素定义为 $V_{i,j} = x_i^j$，其中 $i,j \\in \\{0, \\dots, n-1\\}$。\n\n求解 $Vw = \\mathbf{m}$ 的数值稳定性由矩阵 $V$ 的条件数决定。大的条件数意味着输入数据（例如矩向量 $\\mathbf{m}$）中的小误差可能导致计算解（权重 $w$）中的大误差。矩阵2-范数条件数，记为 $\\kappa_2(V)$，定义为 $\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2$。它被计算为矩阵的最大奇异值（$\\sigma_{\\max}$）与最小奇异值（$\\sigma_{\\min}$）之比：\n$$ \\kappa_2(V) = \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)} $$\n奇异值通过奇异值分解（SVD）计算。对于由等距点构造的范德蒙矩阵，已知 $\\kappa_2(V)$ 会随节点数 $n$ 呈指数级增长，导致极端病态。为了处理这些数值的巨大数量级，我们分析它们以10为底的对数 $\\log_{10}(\\kappa_2(V))$。\n\n解决该问题的步骤如下：\n对于测试集 $\\{1, 2, 3, 5, 10, 15, 20\\}$ 中的每个节点数 $n$：\n$1$. 首先处理特殊情况 $n=1$。问题指定两个区间的节点均为 $x_0 = 0$。这产生一个 $1 \\times 1$ 的范德蒙矩阵 $V = [x_0^0] = [1]$。其奇异值为 $1$，因此对于两个区间，$\\kappa_2(V) = 1$ 且 $\\log_{10}(\\kappa_2(V)) = 0$。\n\n$2$. 对于 $n > 1$ 的情况：\n   a. **区间 $[0,1]$**：使用公式 $x_i = \\frac{i}{n-1}$（其中 $i=0, 1, \\dots, n-1$）生成一组 $n$ 个等距节点 $\\{x_i\\}$。构造相应的范德蒙矩阵 $V_{[0,1]}$。\n   b. **区间 $[-1,1]$**：使用公式 $x_i = -1 + \\frac{2i}{n-1}$（其中 $i=0, 1, \\dots, n-1$）生成第二组 $n$ 个等距节点 $\\{x_i\\}$。构造相应的范德蒙矩阵 $V_{[-1,1]}$。\n   c. 对两个矩阵，使用基于SVD的方法计算2-范数条件数。\n   d. 计算每个条件数以10为底的对数。\n   e. 计算差值 $\\log_{10}(\\kappa_2(V_{[0,1]})) - \\log_{10}(\\kappa_2(V_{[-1,1]}))$，以量化区间选择对条件数的影响。\n\n区间的选择对条件数有深远的影响。在 $[0,1]$ 上，所有节点都是非负的。基函数 $x^j$ 和 $x^{j+1}$ 在此区间上的行为相似，导致范德蒙矩阵的列向量近似线性相关。这种近共线性是导致严重病态的根源。相比之下，区间 $[-1,1]$ 关于原点对称。这种对称性在范德蒙矩阵的列向量之间（例如，对于奇次幂和偶次幂 $j$）引入了一定程度的正交性，从而显著减轻了病态问题。以下程序实现了这一分析。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the log10 of the 2-norm condition number for Vandermonde matrices\n    on two different intervals for a given set of node counts.\n    \"\"\"\n    \n    # Test suite of node counts as specified in the problem statement.\n    test_cases_n = [1, 2, 3, 5, 10, 15, 20]\n    \n    results = []\n    \n    for n in test_cases_n:\n        # The problem statement defines V_{i,j} = x_i^j, which corresponds to\n        # increasing powers in the numpy.vander function.\n        # This is handled by setting the 'increasing' parameter to True.\n        \n        # We perform calculations in double precision as requested.\n        # numpy's default float is float64 (double precision).\n        dtype = np.float64\n        \n        # Handle the special case n=1 as per the problem description.\n        if n == 1:\n            # For n=1, x0=0 for both intervals. V=[[1]].\n            # The condition number of a 1x1 non-zero matrix is 1.\n            # log10(1) = 0.\n            log_kappa_01 = 0.0\n            log_kappa_m11 = 0.0\n        else:\n            # --- Interval [0, 1] ---\n            # Generate n equispaced nodes from 0 to 1.\n            nodes_01 = np.linspace(0.0, 1.0, n, dtype=dtype)\n            # Construct the Vandermonde matrix.\n            V_01 = np.vander(nodes_01, N=n, increasing=True)\n            # Compute the 2-norm condition number.\n            kappa_01 = np.linalg.cond(V_01, p=2)\n            # Compute the base-10 logarithm.\n            log_kappa_01 = np.log10(kappa_01)\n            \n            # --- Interval [-1, 1] ---\n            # Generate n equispaced nodes from -1 to 1.\n            nodes_m11 = np.linspace(-1.0, 1.0, n, dtype=dtype)\n            # Construct the Vandermonde matrix.\n            V_m11 = np.vander(nodes_m11, N=n, increasing=True)\n            # Compute the 2-norm condition number.\n            kappa_m11 = np.linalg.cond(V_m11, p=2)\n            # Compute the base-10 logarithm.\n            log_kappa_m11 = np.log10(kappa_m11)\n\n        # Calculate the difference in log-condition numbers.\n        diff = log_kappa_01 - log_kappa_m11\n        \n        # Store the triple of results for this n.\n        results.append([log_kappa_01, log_kappa_m11, diff])\n        \n    # Format the final output string exactly as required: [[a,b,c],[d,e,f],...].\n    # No spaces are permitted in the final output string.\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]) + \"]\"\n    \n    # Print the single-line result to standard output.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在观察到问题的存在后，我们需要深入其理论根源。这个练习将抽象的条件数概念与一个更直观的性质——即给定节点上基函数的“近似正交性”——联系起来。通过推导一个基于格拉姆矩阵（Gram matrix）的界，我们将精确地理解基函数的非正交性是如何导致系统病态的。",
            "id": "3372894",
            "problem": "在高阶谱方法和间断Galerkin方法中，在不同节点 $\\{x_i\\}_{i=1}^{n}$ 上，次数至多为 $n-1$ 的多项式的节点表示会导出一个范德蒙矩阵 $V \\in \\mathbb{R}^{n \\times n}$，其列由在这些节点上计算选定多项式基函数的值得到。考虑这样一个可逆的范德蒙矩阵 $V$，其格拉姆矩阵为 $G = V^{\\top} V$。欧几里得范数下的谱条件数定义为 $\\kappa_{2}(V) = \\|V\\|_{2} \\,\\|V^{-1}\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 表示由欧几里得内积诱导的谱范数。\n\n从奇异值、谱范数和格拉姆矩阵的定义出发，完成以下任务：\n\n- 推导一个用 $G$ 的特征值表示 $\\kappa_{2}(V)$ 的表达式。\n- 另外，假设 $V$ 的列向量已被缩放至单位欧几里得范数，并且不同列之间的逐对内积的绝对值被一个常数 $\\varepsilon \\in [0,1)$ 一致地界定，即，如果 $v_i$ 表示第 $i$ 列，则对所有 $i$ 都有 $v_i^{\\top} v_i = 1$，且 $\\max_{i \\neq j} |v_i^{\\top} v_j| \\le \\varepsilon$。仅使用标准谱理论分析这个近正交性假设如何约束 $G$ 的谱，并推导出仅依赖于 $n$ 和 $\\varepsilon$ 的 $\\kappa_{2}(V)$ 的一个界。\n\n给出您在近正交性假设下获得的 $\\kappa_{2}(V)$ 的界的单一、闭式解析表达式作为最终答案。无需进行数值计算。",
            "solution": "我们从数值线性代数的核心定义开始。对于任何实矩阵 $V \\in \\mathbb{R}^{n \\times n}$，其谱范数是 $\\|V\\|_{2} = \\sigma_{\\max}(V)$，即 $V$ 的最大奇异值；如果 $V$ 可逆，则 $\\|V^{-1}\\|_{2} = \\sigma_{\\max}(V^{-1}) = 1/\\sigma_{\\min}(V)$，其中 $\\sigma_{\\min}(V)$ 是 $V$ 的最小奇异值。因此，\n$$\n\\kappa_{2}(V) \\;=\\; \\|V\\|_{2}\\,\\|V^{-1}\\|_{2} \\;=\\; \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)}.\n$$\n$V$ 的奇异值是正定格拉姆矩阵 $G = V^{\\top} V$ 的特征值的非负平方根。具体来说，如果 $\\lambda_{1}(G) \\ge \\lambda_{2}(G) \\ge \\cdots \\ge \\lambda_{n}(G) > 0$ 是 $G$ 的特征值，那么\n$$\n\\sigma_{i}(V) \\;=\\; \\sqrt{\\lambda_{i}(G)} \\quad \\text{for each } i,\n$$\n因此\n$$\n\\sigma_{\\max}(V) \\;=\\; \\sqrt{\\lambda_{\\max}(G)}, \\qquad \\sigma_{\\min}(V) \\;=\\; \\sqrt{\\lambda_{\\min}(G)}.\n$$\n立即可得\n$$\n\\kappa_{2}(V) \\;=\\; \\frac{\\sqrt{\\lambda_{\\max}(G)}}{\\sqrt{\\lambda_{\\min}(G)}} \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}(G)}{\\lambda_{\\min}(G)}}.\n$$\n\n现在我们引入近正交性假设。设 $v_{1},\\dots,v_{n}$ 是 $V$ 的列向量，经过缩放使得对所有 $i$ 都有 $v_{i}^{\\top} v_{i} = 1$，且其逐对内积的绝对值由 $\\varepsilon \\in [0,1)$ 界定：\n$$\n\\max_{i \\neq j} |v_{i}^{\\top} v_{j}| \\;\\le\\; \\varepsilon.\n$$\n在这些假设下，格拉姆矩阵 $G = V^{\\top} V$ 具有一个特殊结构：其对角线元素等于 $1$，而非对角线元素的绝对值以 $\\varepsilon$ 为界：\n$$\nG_{ii} \\;=\\; 1, \\qquad |G_{ij}| \\;\\le\\; \\varepsilon \\quad \\text{for } i \\neq j.\n$$\n我们使用盖尔圆盘定理来约束 $G$ 的特征值。对于每一行 $i$，盖尔圆盘的圆心为 $G_{ii} = 1$，半径为\n$$\nR_{i} \\;=\\; \\sum_{j \\neq i} |G_{ij}| \\;\\le\\; (n-1)\\,\\varepsilon.\n$$\n因此，$G$ 的每个特征值 $\\lambda(G)$ 都位于这些圆盘的并集中，这意味着以下粗略但一致的界：\n$$\n\\lambda_{\\min}(G) \\;\\ge\\; 1 - (n-1)\\varepsilon, \\qquad \\lambda_{\\max}(G) \\;\\le\\; 1 + (n-1)\\varepsilon.\n$$\n因为 $G$ 是正定的，为了使下界有意义，我们需要 $1 - (n-1)\\varepsilon > 0$；如果 $(n-1)\\varepsilon < 1$，这个条件就能得到保证。将这些界与前面得到的 $\\kappa_{2}(V)$ 的恒等式相结合，得到\n$$\n\\kappa_{2}(V) \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}(G)}{\\lambda_{\\min}(G)}} \\;\\le\\; \\sqrt{\\frac{1 + (n-1)\\varepsilon}{1 - (n-1)\\varepsilon}}.\n$$\n\n这个表达式量化了近正交性的影响：当 $\\varepsilon \\to 0$ 时，格拉姆矩阵 $G$ 趋近于单位矩阵，因此其特征值聚集在 $1$ 附近，并且条件数的界趋近于 $1$。反之，增大 $\\varepsilon$ 会扩大 $G$ 的最大和最小特征值之间的差距，从而恶化条件数；其敏感性通过因子 $(n-1)\\varepsilon$ 随 $n$ 增长。\n\n所要求的最终解析表达式即为上面推导出的 $\\kappa_{2}(V)$ 的界。",
            "answer": "$$\\boxed{\\sqrt{\\frac{1+(n-1)\\varepsilon}{\\,1-(n-1)\\varepsilon\\,}}}$$"
        },
        {
            "introduction": "有了清晰的诊断和对病因的理解，我们现在可以构建一种“疗法”。这最后一个练习将演示谱方法中的一个强大技术：将基函数从性质恶劣的单项式基转换为性质优良的正交多项式基（特别是勒让德多项式）。我们将看到，当这一技术与特定的节点选择（高斯-勒让德节点）相结合时，如何能够得到一个条件数为$1$的完美系统。",
            "id": "3372834",
            "problem": "考虑在节点谱方法或间断伽辽金（DG）离散化中，区间 $[-1,1]$ 上的一个一维单元。设 $N \\in \\mathbb{N}$ 为一固定值，令 $\\{x_{i}\\}_{i=1}^{N}$ 表示 $N$ 个 Gauss–Legendre 节点，即 $N$ 次 Legendre 多项式的 $N$ 个不同根。令 $\\{w_{i}\\}_{i=1}^{N}$ 为相关的 Gauss–Legendre 求积权重。定义单项式范德蒙矩阵 $V \\in \\mathbb{R}^{N \\times N}$ 为\n$$\nV_{i,k} = x_{i}^{k}, \\quad 1 \\leq i \\leq N, \\quad 0 \\leq k \\leq N-1.\n$$\n令 $\\{p_{j}\\}_{j=0}^{N-1}$ 为 $[-1,1]$ 上的 Legendre 多项式，它们被归一化，以在单位权重下的标准 $L^{2}([-1,1])$ 内积下是标准正交的，即，\n$$\n\\int_{-1}^{1} p_{j}(x)\\,p_{k}(x)\\,\\mathrm{d}x = \\delta_{jk}, \\quad 0 \\leq j,k \\leq N-1.\n$$\n定义求值矩阵 $\\Phi \\in \\mathbb{R}^{N \\times N}$ 为\n$$\n\\Phi_{i,j} = p_{j}(x_{i}), \\quad 1 \\leq i \\leq N, \\quad 0 \\leq j \\leq N-1.\n$$\n存在一个从单项式基到标准正交多项式基的基变换矩阵 $C \\in \\mathbb{R}^{N \\times N}$，使得 $\\Phi = V C$。同时考虑求积权重的对角矩阵 $W = \\mathrm{diag}(w_{1},\\dots,w_{N})$ 及其正定平方根 $L = W^{1/2} = \\mathrm{diag}(\\sqrt{w_{1}},\\dots,\\sqrt{w_{N}})$。\n\n仅从上述定义以及标准正交多项式和 Gauss–Legendre 求积的基本性质出发，推导一个基于到标准正交多项式基投影的预条件子，该预条件子将单项式范德蒙矩阵转换为一个近似正交的求值矩阵。具体来说，利用 $L$ 和 $C$ 构建左预条件子和右预条件子，使得预处理后的矩阵在欧几里得内积下具有标准正交的列，并利用此结果严格分析该预处理对 2-范数条件数 $\\kappa_{2}$ 的有效性。\n\n你的任务是，当多项式次数为 $N-1$ 且节点为 $N$ 个 Gauss–Legendre 点及其相关求积权重时，计算完全预处理后的矩阵的 2-范数条件数 $\\kappa_{2}$ 的精确值。将最终答案表示为一个精确数，无需四舍五入。",
            "solution": "目标是为单项式范德蒙矩阵 $V$ 推导一个预处理策略，并计算得到的预处理矩阵的 2-范数条件数。该预处理应使用所提供的矩阵 $L$ 和 $C$ 来构建。\n\n令预处理后的矩阵记为 $A$。对矩阵 $V$ 的一般双边预处理形式为 $A = P_L V P_R$，其中 $P_L$ 和 $P_R$ 分别是左预条件子和右预条件子。题目规定这些预条件子应由基变换矩阵 $C$ 和缩放后的求积权重矩阵 $L = W^{1/2}$ 构建。\n\n题目指出，存在一个从单项式基 $\\{x^k\\}_{k=0}^{N-1}$ 到标准正交多项式基 $\\{p_j\\}_{j=0}^{N-1}$ 的基变换矩阵 $C \\in \\mathbb{R}^{N \\times N}$，使得 $\\Phi = V C$。这个关系将病态的单项式范德蒙矩阵 $V$ 与良态的标准正交多项式求值矩阵 $\\Phi$ 联系起来。右预条件子的一个自然选择是 $P_R = C$，因为这有效地将问题的基从单项式基转换为标准正交的 Legendre 多项式基。\n\n应用这个右预条件子，我们得到一个中间矩阵 $V C = \\Phi$。$\\Phi$ 的列是标准正交多项式 $\\{p_j\\}_{j=0}^{N-1}$ 在 Gauss-Legendre 节点 $\\{x_i\\}_{i=1}^{N}$ 上的求值。题目要求最终预处理后的矩阵的列在欧几里得内积下是标准正交的。我们来检验一下 $\\Phi$ 的列。$\\Phi$ 的第 $j$ 列和第 $k$ 列的内积由下式给出：\n$$\n(\\Phi_{:,j})^T (\\Phi_{:,k}) = \\sum_{i=1}^{N} \\Phi_{ij} \\Phi_{ik} = \\sum_{i=1}^{N} p_j(x_i) p_k(x_i)\n$$\n这个表达式通常不等于克罗内克 δ (Kronecker delta) $\\delta_{jk}$。然而，我们可以利用 Gauss-Legendre 求积的基本性质。使用 $N$ 个节点 $\\{x_i\\}$ 和权重 $\\{w_i\\}$ 的求积法则对于次数至多为 $2N-1$ 的任何多项式 $f(x)$ 都是精确的。即，\n$$\n\\int_{-1}^{1} f(x)\\,\\mathrm{d}x = \\sum_{i=1}^{N} w_i f(x_i)\n$$\n已知多项式 $\\{p_j(x)\\}_{j=0}^{N-1}$ 在 $[-1,1]$ 上关于单位权重函数是标准正交的：\n$$\n\\int_{-1}^{1} p_j(x) p_k(x)\\,\\mathrm{d}x = \\delta_{jk}\n$$\n考虑函数 $f(x) = p_j(x) p_k(x)$。这个多项式的次数是 $j+k$。由于 $0 \\le j, k \\le N-1$，最大次数是 $(N-1) + (N-1) = 2N-2$。因为 $2N-2  2N-1$，Gauss-Legendre 求积法则对 $p_j(x) p_k(x)$ 是精确的。因此，我们可以写出：\n$$\n\\delta_{jk} = \\int_{-1}^{1} p_j(x) p_k(x)\\,\\mathrm{d}x = \\sum_{i=1}^{N} w_i p_j(x_i) p_k(x_i)\n$$\n让我们将此结果表示为矩阵形式。右边的和是矩阵乘积 $\\Phi^T W \\Phi$ 的第 $(j,k)$ 个元素，其中 $W = \\mathrm{diag}(w_1, \\dots, w_N)$。具体来说：\n$$\n(\\Phi^T W \\Phi)_{jk} = \\sum_{l=1}^{N} (\\Phi^T)_{jl} (W \\Phi)_{lk} = \\sum_{l=1}^{N} \\Phi_{lj} \\sum_{m=1}^{N} W_{lm} \\Phi_{mk} = \\sum_{l=1}^{N} \\Phi_{lj} (w_l \\Phi_{lk}) = \\sum_{l=1}^{N} w_l p_j(x_l) p_k(x_l)\n$$\n与求积结果比较，我们发现：\n$$\n\\Phi^T W \\Phi = I\n$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵。这表明 $\\Phi$ 的列关于由矩阵 $W$ 加权的内积是正交的。\n\n题目要求预处理矩阵 $A$ 的列在标准欧几里得内积下是标准正交的，这意味着我们需要 $A^T A = I$。设左预条件子为 $P_L$。预处理后的矩阵是 $A = P_L V C = P_L \\Phi$。让我们计算 $A^T A$：\n$$\nA^T A = (P_L \\Phi)^T (P_L \\Phi) = \\Phi^T P_L^T P_L \\Phi\n$$\n我们希望它等于单位矩阵 $I$。与我们推导出的性质 $\\Phi^T W \\Phi = I$ 相比，一个显而易见的选择是设 $P_L^T P_L = W$。\n题目提供了矩阵 $L = W^{1/2} = \\mathrm{diag}(\\sqrt{w_1},\\dots,\\sqrt{w_N})$。由于求积权重 $w_i$ 是正的，$L$ 是一个实对称正定矩阵。我们选择 $P_L=L$。那么：\n$$\nP_L^T P_L = L^T L = L L = W^{1/2} W^{1/2} = W\n$$\n这个选择满足条件。因此，完全预处理后的矩阵是 $A = L V C$。\n\n我们现在可以验证 $A$ 的列的标准正交性：\n$$\nA = L(VC) = L\\Phi\n$$\n$$\nA^T A = (L\\Phi)^T (L\\Phi) = \\Phi^T L^T L \\Phi = \\Phi^T W \\Phi = I\n$$\n由于 $A$ 是一个满足 $A^T A = I$ 的 $N \\times N$ 方阵，所以 $A$ 是一个正交矩阵。\n\n最后的任务是计算该矩阵 $A$ 的 2-范数条件数 $\\kappa_2(A)$。条件数定义为 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。对于非奇异矩阵，它也可以表示为最大奇异值与最小奇异值之比：$\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)}$。\n\n矩阵 $A$ 的奇异值是矩阵 $A^T A$ 的特征值的平方根。在我们的例子中，我们已经确定 $A^T A = I$。单位矩阵 $I$ 的特征值都等于 $1$。设 $\\lambda_j$ 为 $A^T A$ 的特征值，那么对所有的 $j=1, \\dots, N$，都有 $\\lambda_j = 1$。\n奇异值 $\\sigma_j(A)$ 由下式给出：\n$$\n\\sigma_j(A) = \\sqrt{\\lambda_j(A^T A)} = \\sqrt{1} = 1 \\quad \\text{for } j=1, \\dots, N\n$$\n由于 $A$ 的所有奇异值都等于 $1$，所以最大奇异值为 $\\sigma_{\\max}(A) = 1$，最小奇异值为 $\\sigma_{\\min}(A) = 1$。\n因此，$A$ 的 2-范数条件数为：\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)} = \\frac{1}{1} = 1\n$$\n这个结果证明了该预处理策略的极高有效性。原始的单项式范德蒙矩阵 $V$ 是出了名的病态，其条件数随 $N$ 呈指数级增长。而预处理后的矩阵 $A=LVC$ 是一个正交矩阵，具有最优的条件数 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}