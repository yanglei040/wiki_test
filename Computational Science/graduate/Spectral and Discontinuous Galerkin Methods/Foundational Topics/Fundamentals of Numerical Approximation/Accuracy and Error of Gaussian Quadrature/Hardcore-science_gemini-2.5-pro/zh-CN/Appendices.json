{
    "hands_on_practices": [
        {
            "introduction": "我们通常将高斯求积法则当作一个“黑盒子”来使用，但它们是如何被构造出来的？我们又该如何估计它们产生的误差？本练习将深入探讨高斯-克朗罗德 (Gauss-Kronrod) 求积法则的构建，这是一种为高效误差估计而设计的巧妙方法。你将从第一性原理出发，推导出一个求积法则，并用它来创建一个嵌入式误差估计器，从而揭示自适应求积算法的理论核心。",
            "id": "3361974",
            "problem": "在一维间断 Galerkin (DG) 方法的数值组装中，考虑在参考单元 $E=[-1,1]$ 上权重为单位1的积分。设 $P_{n}(x)$ 表示 $n$ 次 Legendre 多项式，并回顾 $n$ 点 Gauss-Legendre 求积法使用 $P_{n}(x)$ 的 $n$ 个不同零点作为节点，对最高为 $2n-1$ 次的多项式可达到精确。\n\n1) 从 Legendre 多项式在 $[-1,1]$ 上关于权重 $w(x)=1$ 的正交性以及 Gauss 求积精确性的定义出发，推导 Kronrod 扩展的构建原则。该扩展通过增加 $n+1$ 个新节点，同时保留原有的 $n$ 个 Gauss 节点，将一个 $n$ 点的 Gauss-Legendre 法则扩展为一个 $(2n+1)$ 点的法则。你的推导必须仅基于以下基本原理：(i) 作为矩匹配条件的求积精确性，(ii) 对于 $w(x)=1$ 的法则对称性，以及 (iii) 由正交性所蕴含的节点交错特性。解释精确性条件如何确定新节点和所有权重，以及为什么得到的法则能够达到严格大于 $2n-1$ 的精确阶数。\n\n2) 将你的推导具体化到在 $E=[-1,1]$ 上 $n=1$ 的情况。通过求解由偶次幂单项式的精确性所蕴含的矩方程，显式地确定 Kronrod 扩展法则的 $(2n+1)=3$ 个节点和权重。证明该扩展法则包含原有的 Gauss 节点并且是对称的。\n\n3) 在自适应 DG 积分中，可以在每个单元上构造一个嵌入式后验误差估计量，其值为应用于同一被积函数的高阶法则与其嵌入的低阶子法则之间的绝对差。将 $E$ 上的嵌入式估计量 $\\varepsilon(f)$ 定义为 $\\varepsilon(f)=\\left|Q_{K}(f)-Q_{G}(f)\\right|$，其中 $Q_{K}$ 是第 2 部分得到的 Kronrod 扩展 $(2n+1)$ 点法则，而 $Q_{G}$ 是原始的 $n$ 点 Gauss 法则。对被积函数 $f(x)=x^{4}$ 在 $E=[-1,1]$ 上评估此估计量。将你的最终答案表示为一个精确数。不要包含任何单位。需要提交的最终答案是在 $[-1,1]$ 上 $\\varepsilon(x^{4})$ 的值。",
            "solution": "问题陈述已经过验证，并且被认为是合理的。它在科学上基于数值求积理论，是适定的，有通往唯一解的清晰路径，并以客观的数学语言表达。我们可以开始解题。\n\n该问题分三部分解决：首先，推导 Gauss-Kronrod 求积的原理；其次，显式构造 3 点 Gauss-Kronrod 法则；第三，使用该法则评估一个误差估计量。\n\n**1) Kronrod 扩展的构建原则**\n\n目标是通过增加 $n+1$ 个新节点，同时重用原有的 $n$ 个节点，将一个 $n$ 点 Gauss-Legendre 法则 $Q_G(f)$ 扩展为一个更高阶的 $(2n+1)$ 点法则 $Q_K(f)$。原有的 Gauss 节点，记为 $\\{x_i\\}_{i=1}^n$，是 Legendre 多项式 $P_n(x)$ 的根。原始法则 $Q_G(f) = \\sum_{i=1}^n w_i f(x_i)$ 对所有最高为 $2n-1$ 次的多项式都是精确的。\n\n新的 $(2n+1)$ 点 Kronrod 法则 $Q_K(f)$ 定义为：\n$$\nQ_K(f) = \\sum_{i=1}^n a_i f(x_i) + \\sum_{j=1}^{n+1} b_j f(y_j)\n$$\n其中 $\\{x_i\\}_{i=1}^n$ 是固定的 Gauss 节点，$\\{y_j\\}_{j=1}^{n+1}$ 是新的 Kronrod 节点，$\\{a_i\\}_{i=1}^n$ 和 $\\{b_j\\}_{j=1}^{n+1}$ 是相应的权重。待定参数的总数为 $(n+1)$ 个节点 $y_j$，$n$ 个权重 $a_i$，以及 $(n+1)$ 个权重 $b_j$，总共有 $3n+2$ 个自由参数。\n\n(i) **作为矩匹配条件的精确性**：Gauss 求积构造的原理是利用可用的自由度来强制法则对尽可能高次数的多项式精确。利用 $3n+2$ 个参数，我们可以施加 $3n+2$ 个约束。这些约束是要求该求积法则对单项式 $x^k$（其中 $k=0, 1, \\dots, 3n+1$）的积分是精确的。这就建立了一个包含 $3n+2$ 个方程的方程组：\n$$\n\\int_{-1}^1 x^k \\, dx = \\sum_{i=1}^n a_i x_i^k + \\sum_{j=1}^{n+1} b_j y_j^k, \\quad \\text{对于 } k = 0, 1, \\dots, 3n+1\n$$\n这是一个关于未知数 $\\{y_j\\}$、$\\{a_i\\}$ 和 $\\{b_j\\}$ 的非线性方程组。\n\n(ii) **对于 $w(x)=1$ 的对称性**：对于对称区间 $E=[-1,1]$ 上的权重函数 $w(x)=1$，求积法则也必须是对称的。这意味着如果 $z$ 是一个节点，那么 $-z$ 也是一个节点，并且它们的权重相等。原始的 Gauss 节点 $\\{x_i\\}$ 是 $P_n(x)$ 的根，关于 $x=0$ 对称。我们强制要求新节点 $\\{y_j\\}$ 也关于 $x=0$ 对称。这一对称性自动满足了所有奇次幂 $k$ 的矩方程，因为对于奇数 $k$，$\\int_{-1}^1 x^k dx = 0$，而右侧的求和项也因为节点对 $(\\pm z, \\pm z, ...)$ 之间的抵消而为零。这极大地简化了方程组，只留下偶数值 $k$ 的方程需要求解。唯一未知数（非负节点及其权重）的数量与偶次矩方程的数量相匹配，从而得到一个可解的（虽然仍是非线性的）系统。\n\n(iii) **节点的交错特性**：求解矩方程组会揭示一个更深层次的结构。新节点 $\\{y_j\\}$ 是一个 $n+1$ 次多项式的根，该多项式通常记为 $E_{n+1}(x)$。可以发现，这个多项式在 $[-1,1]$ 上与 $P_n(x)$ 正交，即 $\\int_{-1}^1 E_{n+1}(x) P_n(x) dx = 0$。一个关于正交多项式根的基本定理指出，一个正交序列中两个连续多项式的根是相互交错的。虽然 $\\{P_n(x), E_{n+1}(x)\\}$ 不构成一个标准正交序列，但它们的正交性质保证了其根的交错性。因此，每两个连续的 Gauss 节点 $(x_i, x_{i+1})$ 之间的区间恰好包含一个 Kronrod 节点 $y_j$，并且区间 $(-\\infty, x_{\\min})$ 和 $(x_{\\max}, \\infty)$ 也各包含一个 Kronrod 节点。\n\n**精确阶数**：原始的 $n$ 点法则对最高为 $2n-1$ 次的多项式是精确的。通过引入 $n+1$ 个新节点并拥有总共 $3n+2$ 个参数，我们可以强制法则对最高为 $3n+1$ 次的多项式精确。由于 $n \\ge 1$，我们有 $3n+1 > 2n-1$，这意味着 Kronrod 扩展达到了比原始 Gauss 法则严格更高的精确阶数。事实上，由于对称性，当 $n$ 是奇数时，该法则通常对 $3n+2$ 次多项式也是精确的。\n\n**2) 具体化到 $n=1$ 的情况**\n\n对于 $n=1$，Gauss-Legendre 法则只有一个点。节点是 $P_1(x)=x$ 的根，所以 $x_1=0$。通过对 $f(x)=1$ 积分来求得权重 $w_1$：$\\int_{-1}^1 1 \\,dx = 2 = w_1 \\cdot 1$，因此 $w_1=2$。这个 1 点 Gauss 法则为 $Q_G(f) = 2f(0)$。它对最高为 $2(1)-1=1$ 次的多项式是精确的。\n\n我们试图通过增加 $n+1=2$ 个节点，将其扩展为一个 $(2n+1)=3$ 点的 Kronrod 法则。设该法则为 $Q_K(f) = a_1 f(x_1) + b_1 f(y_1) + b_2 f(y_2)$。由于 $x_1=0$，我们有 $Q_K(f) = a_1 f(0) + b_1 f(y_1) + b_2 f(y_2)$。根据对称性，我们必须有 $y_2 = -y_1$ 和 $b_2=b_1$。设 $y_1=y$ 且 $b_1=b_2=b$。该法则变为：\n$$\nQ_K(f) = a_1 f(0) + b f(y) + b f(-y)\n$$\n共有 3 个未知数：$a_1$，$b$ 和 $y$。我们强制该法则对最高至少为 $3n+1=4$ 次的多项式精确。由于对称性，我们只需要考虑偶次幂 $k=0, 2, 4$ 的矩方程。\n\n对于 $k=0$ ($f(x)=1$):\n$\\int_{-1}^1 1 \\,dx = 2$。\n$Q_K(1) = a_1(1) + b(1) + b(1) = a_1+2b$。\n方程 (1)：$a_1+2b=2$。\n\n对于 $k=2$ ($f(x)=x^2$):\n$\\int_{-1}^1 x^2 \\,dx = \\frac{2}{3}$。\n$Q_K(x^2) = a_1(0)^2 + b(y)^2 + b(-y)^2 = 2by^2$。\n方程 (2)：$2by^2 = \\frac{2}{3} \\implies by^2 = \\frac{1}{3}$。\n\n对于 $k=4$ ($f(x)=x^4$):\n$\\int_{-1}^1 x^4 \\,dx = \\frac{2}{5}$。\n$Q_K(x^4) = a_1(0)^4 + b(y)^4 + b(-y)^4 = 2by^4$。\n方程 (3)：$2by^4 = \\frac{2}{5} \\implies by^4 = \\frac{1}{5}$。\n\n我们求解这个方程组。将方程(3)除以方程(2)：\n$\\frac{by^4}{by^2} = \\frac{1/5}{1/3} \\implies y^2 = \\frac{3}{5}$。\n所以，新节点为 $y = \\pm\\sqrt{\\frac{3}{5}}$。\n将 $y^2 = 3/5$ 代入方程 (2)：\n$b \\left(\\frac{3}{5}\\right) = \\frac{1}{3} \\implies b = \\frac{5}{9}$。\n将 $b=5/9$ 代入方程 (1)：\n$a_1 + 2\\left(\\frac{5}{9}\\right) = 2 \\implies a_1 = 2 - \\frac{10}{9} = \\frac{8}{9}$。\n\n得到的 3 点 Gauss-Kronrod 法则具有：\n- 节点：$-\\sqrt{\\frac{3}{5}}, 0, \\sqrt{\\frac{3}{5}}$\n- 权重：$\\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}$\n此法则包含了原始的 Gauss 节点 ($0$) 并且是对称的，符合要求。\n\n**3) 误差估计量的评估**\n\n嵌入式误差估计量定义为 $\\varepsilon(f) = |Q_K(f) - Q_G(f)|$。我们对被积函数 $f(x)=x^4$ 在 $E=[-1,1]$ 上评估此估计量。\n\n首先，应用低阶的 1 点 Gauss 法则 $Q_G(f) = 2f(0)$：\n$$\nQ_G(x^4) = 2 \\cdot (0)^4 = 0\n$$\n\n接着，应用高阶的 3 点 Kronrod 法则 $Q_K(f) = \\frac{8}{9}f(0) + \\frac{5}{9}f(-\\sqrt{3/5}) + \\frac{5}{9}f(\\sqrt{3/5})$：\n$$\nQ_K(x^4) = \\frac{8}{9}(0)^4 + \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^4 + \\frac{5}{9}\\left(\\sqrt{\\frac{3}{5}}\\right)^4\n$$\n$$\nQ_K(x^4) = 0 + \\frac{5}{9}\\left(\\frac{3}{5}\\right)^2 + \\frac{5}{9}\\left(\\frac{3}{5}\\right)^2 = 2 \\cdot \\frac{5}{9} \\cdot \\frac{9}{25} = 2 \\cdot \\frac{5}{25} = \\frac{10}{25} = \\frac{2}{5}\n$$\n注意，这与精确积分 $\\int_{-1}^{1} x^4 \\,dx = \\frac{2}{5}$ 的值相匹配，这与我们的构造预期一致。\n\n最后，计算估计量的值：\n$$\n\\varepsilon(x^4) = |Q_K(x^4) - Q_G(x^4)| = \\left|\\frac{2}{5} - 0\\right| = \\frac{2}{5}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{5}}\n$$"
        },
        {
            "introduction": "求积法则的精度不仅仅是关于单个积分的近似，它对整个数值格式的结构特性有着深远的影响。本练习将探索高斯-洛巴托-勒让德 (Gauss-Lobatto-Legendre) 求积与分部求和 (Summation-By-Parts, SBP) 特性之间的关键联系，后者是分部积分的离散模拟。你将验证当求积精度足够时，这个对数值稳定性至关重要的恒等式是如何被精确保持的，并量化当求积不精确时所产生的“缺陷”或误差。",
            "id": "3361955",
            "problem": "考虑参考单元 $[-1,1]$ 和模态 Legendre 多项式基 $\\{P_{i}(x)\\}_{i=0}^{p}$，其中 $P_{i}(x)$ 表示 $i$ 次 Legendre 多项式，其归一化使得 $\\int_{-1}^{1} P_{i}(x) P_{j}(x) \\,\\mathrm{d}x = \\frac{2}{2i+1} \\delta_{ij}$ 且 $P_{i}(1)=1$，$P_{i}(-1)=(-1)^{i}$。设 $p=4$。将 $[-1,1]$ 上具有 $n$ 个节点的 Gauss–Lobatto–Legendre 求积定义为唯一的对称求积法则，该法则包含端点 $x=\\pm 1$，并将内部节点置于 $P_{n-1}'(x)$ 的零点处，其正权重 $\\{w_{k}\\}_{k=1}^{n}$ 的选择方式使得该法则对于 $[-1,1]$ 上次数至多为 $2n-3$ 的任意多项式都是精确的。\n\n对于给定的 $n$，定义离散质量矩阵和离散导数内积矩阵为\n$$\n\\widetilde{M}_{ij} := \\sum_{k=1}^{n} w_{k}\\, P_{i}(x_{k}) P_{j}(x_{k}), \n\\qquad\n\\widetilde{S}_{ij} := \\sum_{k=1}^{n} w_{k}\\, P_{i}'(x_{k}) P_{j}(x_{k}),\n$$\n并定义边界矩阵\n$$\nB_{ij} := P_{i}(1) P_{j}(1) - P_{i}(-1) P_{j}(-1) = 1 - (-1)^{i+j}.\n$$\n分部求和 (Summation-By-Parts, SBP) 恒等式陈述了分部积分的离散模拟，\n$$\n\\widetilde{S} + \\widetilde{S}^{\\top} = B,\n$$\n其中上标 ${\\top}$ 表示转置。\n\n任务：\n- 仅使用 Legendre 多项式性质和 Gauss–Lobatto–Legendre 求积的精确性，对 $p=4$ 验证当有 $n=p+1=5$ 个节点时，SBP 恒等式 $\\widetilde{S}+\\widetilde{S}^{\\top}=B$ 是精确的。\n- 现在取 $n=4  p+1$，在这种欠积分的情况下，计算 SBP 恒等式在 $(i, j) = (3, 4)$ 处的误差 $\\Delta_{34} = (\\widetilde{S}+\\widetilde{S}^{\\top}-B)_{34}$。",
            "solution": "该问题已经过验证，被认为是有效的。它在数值分析领域，特别是在谱方法和分部求和 (SBP) 算子方面，具有科学依据。该问题是适定的、客观的，并包含推导唯一解所需的所有必要信息。\n\n该问题包含两部分。第一部分是在完全积分情况下对性质的验证，第二部分是在欠积分情况下对一个误差项的计算。\n\n首先，我们验证在多项式次数 $p=4$ 和具有 $n=p+1=5$ 个节点的 Gauss-Lobatto-Legendre (GLL) 求积法则的情况下的 SBP 恒等式。具有 $n$ 个节点的 GLL 求积法则对于 $[-1,1]$ 上次数至多为 $2n-3$ 的任意多项式都是精确的。对于 $n=5$，该法则对次数最高为 $2(5)-3=7$ 的多项式是精确的。\n\nSBP 恒等式为 $\\widetilde{S} + \\widetilde{S}^{\\top} = B$。左侧的 $(i,j)$ 元是 $\\widetilde{S}_{ij} + \\widetilde{S}_{ji} = \\sum_{k=1}^{5} w_k (P_i'(x_k) P_j(x_k) + P_j'(x_k) P_i(x_k))$。和中的项是乘积的导数，即 $(P_i(x)P_j(x))'$。这是一个次数为 $i+j-1$ 的多项式。对于 $0 \\le i, j \\le 4$，最大次数为 $4+4-1=7$。具有 $n=5$ 个节点的 GLL 法则对这些多项式是精确的。因此，\n$$ \\widetilde{S}_{ij} + \\widetilde{S}_{ji} = \\int_{-1}^{1} \\frac{d}{dx} (P_i(x)P_j(x)) \\,dx $$\n根据微积分基本定理，这个积分的计算结果为\n$$ [P_i(x)P_j(x)]_{x=-1}^{x=1} = P_i(1)P_j(1) - P_i(-1)P_j(-1). $$\n使用给定的性质 $P_k(1)=1$ 和 $P_k(-1)=(-1)^k$，这变为 $1 \\cdot 1 - (-1)^i (-1)^j = 1 - (-1)^{i+j}$，这正是 $B_{ij}$ 的定义。因此，对于 $n=p+1=5$，SBP 恒等式 $\\widetilde{S}+\\widetilde{S}^{\\top}=B$ 精确成立。\n\n现在，我们处理第二个任务：在 $p=4$ 且具有 $n=4$ 个节点的欠积分情况下，计算误差 $\\Delta_{34}$。要计算的量是\n$$ \\Delta_{34} = (\\widetilde{S}+\\widetilde{S}^{\\top} - B)_{34} = (\\widetilde{S}_{34} + \\widetilde{S}_{43}) - B_{34}. $$\n具有 $n=4$ 个节点的 GLL 求积对于次数至多为 $2n-3 = 2(4)-3=5$ 的多项式是精确的。项 $\\widetilde{S}_{34} + \\widetilde{S}_{43}$ 是 $\\int_{-1}^1 (P_3(x)P_4(x))' \\,dx$ 的求积近似。被积函数 $(P_3P_4)'$ 是一个次数为 $3+4-1=6$ 的多项式。由于次数 6 大于 5，求积不是精确的，我们预计会有一个非零的误差 $\\Delta_{34}$。\n\n首先，我们确定 $n=4$ 时的 GLL 节点和权重。节点是端点 $\\{-1, 1\\}$ 和 $P'_{n-1}(x) = P'_3(x)$ 的零点。归一化为 $P_i(1)=1$ 的 Legendre 多项式是：\n$P_3(x) = \\frac{1}{2}(5x^3-3x)$\n$P_4(x) = \\frac{1}{8}(35x^4-30x^2+3)$\n$P_3(x)$ 的导数是 $P'_3(x) = \\frac{1}{2}(15x^2-3)$。令 $P'_3(x)=0$ 得到 $15x^2=3$，所以 $x^2=1/5$。内部节点是 $x = \\pm 1/\\sqrt{5}$。\n四个 GLL 节点是 $x_1=-1$，$x_2=-1/\\sqrt{5}$，$x_3=1/\\sqrt{5}$，$x_4=1$。\nGLL 权重由 $w_k = \\frac{2}{n(n-1)[P_{n-1}(x_k)]^2} = \\frac{2}{4(3)[P_3(x_k)]^2} = \\frac{1}{6[P_3(x_k)]^2}$ 给出。\n对于端点 $x=\\pm 1$，我们有 $P_3(1)=1$ 和 $P_3(-1)=-1$，所以 $[P_3(\\pm 1)]^2=1$。端点权重是 $w_1=w_4=\\frac{1}{6}$。\n对于内部节点 $x=\\pm 1/\\sqrt{5}$：\n$P_3(1/\\sqrt{5}) = \\frac{1}{2}(5(1/\\sqrt{5})^3-3(1/\\sqrt{5})) = \\frac{1}{2\\sqrt{5}}(1-3) = -1/\\sqrt{5}$。\n$P_3(-1/\\sqrt{5}) = 1/\\sqrt{5}$。\n所以，$[P_3(\\pm 1/\\sqrt{5})]^2 = 1/5$。内部权重是 $w_2=w_3=\\frac{1}{6(1/5)} = \\frac{5}{6}$。\n\n接下来，我们计算项 $\\widetilde{S}_{34} + \\widetilde{S}_{43} = \\sum_{k=1}^{4} w_{k} (P_{3}'(x_{k}) P_{4}(x_{k}) + P_{4}'(x_{k}) P_{3}(x_{k}))$。设 $g(x) = P_3'(x)P_4(x) + P_4'(x)P_3(x)$。所需的导数是：\n$P'_3(x) = \\frac{3}{2}(5x^2-1)$\n$P'_4(x) = \\frac{1}{8}(140x^3-60x) = \\frac{5}{2}(7x^3-3x)$\n函数 $g(x)$ 是偶函数，因为 $P_3$ 是奇函数，$P_4$ 是偶函数，$P_3'$ 是偶函数，$P_4'$ 是奇函数，这使得 $P_3'P_4$ 是偶函数，$P_4'P_3$ 也是偶函数。所以 $g(-x)=g(x)$。和为 $\\sum_{k=1}^4 w_k g(x_k) = 2w_1 g(1) + 2w_2 g(1/\\sqrt{5})$。\n\n我们在正节点处计算 $g(x)$ 的值：\n在 $x=1$ 处：\n$P_3(1)=1$, $P_4(1)=1$\n$P'_3(1) = \\frac{3}{2}(5-1) = 6$\n$P'_4(1) = \\frac{5}{2}(7-3) = 10$\n$g(1) = P'_3(1)P_4(1) + P'_4(1)P_3(1) = 6(1) + 10(1) = 16$。\n\n在 $x=1/\\sqrt{5}$ 处：\n$P_3(1/\\sqrt{5}) = -1/\\sqrt{5}$\n$P_4(1/\\sqrt{5}) = \\frac{1}{8}(35(1/25) - 30(1/5) + 3) = \\frac{1}{8}(7/5 - 6 + 3) = \\frac{1}{8}(7/5 - 15/5) = -1/5$。\n$P'_3(1/\\sqrt{5}) = \\frac{3}{2}(5(1/5)-1) = 0$ (正如预期的那样，因为它是一个节点)。\n$P'_4(1/\\sqrt{5}) = \\frac{5}{2}(7(1/5\\sqrt{5}) - 3(1/\\sqrt{5})) = \\frac{5}{2\\sqrt{5}}(7/5 - 3) = \\frac{5}{2\\sqrt{5}}(-8/5) = -4/\\sqrt{5}$。\n$g(1/\\sqrt{5}) = P'_3 P_4 + P'_4 P_3 = 0 \\cdot (-1/5) + (-4/\\sqrt{5})(-1/\\sqrt{5}) = 4/5$。\n\n现在我们计算和：\n$\\widetilde{S}_{34} + \\widetilde{S}_{43} = 2w_1 g(1) + 2w_2 g(1/\\sqrt{5}) = 2(\\frac{1}{6})(16) + 2(\\frac{5}{6})(\\frac{4}{5}) = \\frac{16}{3} + \\frac{10}{6}\\frac{4}{5} = \\frac{16}{3} + \\frac{40}{30} = \\frac{16}{3} + \\frac{4}{3} = \\frac{20}{3}$。\n\n最后，我们计算边界项 $B_{34}$：\n$B_{34} = P_3(1)P_4(1) - P_3(-1)P_4(-1) = 1 \\cdot 1 - (-1)^3 (-1)^4 = 1 - (-1)(1) = 2$。\n\n误差是差值：\n$\\Delta_{34} = (\\widetilde{S}_{34} + \\widetilde{S}_{43}) - B_{34} = \\frac{20}{3} - 2 = \\frac{20-6}{3} = \\frac{14}{3}$。",
            "answer": "$$\\boxed{\\frac{14}{3}}$$"
        },
        {
            "introduction": "在求解波传播问题时，求积误差会以一种微妙但物理上非常重要的方式表现出来。在本练习中，你将使用傅里叶分析来剖析一个求解平流方程的间断伽辽金 (DG) 格式的性能。通过对比精确积分与积分不足的两种格式，你将能够分离并量化求积误差是如何直接转化为非物理的频散（相位误差）和耗散（幅值误差）的。",
            "id": "3361950",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中常数波速 $a0$，定义在周期性域上，并用长度为 $h$ 的单元组成的均匀网格进行离散。在每个单元上，使用多项式次数为 $p=1$ 的间断伽辽金 (DG) 近似，参考单元 $\\xi \\in [-1,1]$ 上的模态勒让德基为 $\\phi_{0}(\\xi)=1$ 和 $\\phi_{1}(\\xi)=\\xi$，并使用标准的迎风数值通量。在映射 $x = x_{j} + \\frac{h}{2}\\,\\xi$ 下，写出参考单元上的半离散 DG 弱形式。设精确解为一个傅里叶模态 $u(x,t)=\\sin(\\kappa x - \\omega t)$，其波数为 $\\kappa$，定义无量纲波数 $\\theta := \\kappa h$ 和无量纲半离散特征值 $\\sigma(\\theta)$，通过 $\\lambda = \\frac{a}{h}\\,\\sigma(\\theta)$ 使得 $u \\sim \\exp(\\lambda t)$。\n\n定义“精确 DG 算子”为精确计算参考单元内积。定义“次精确求积 DG 算子”为使用 $[-1,1]$ 上的两点高斯-洛巴托法则（该法则对次数最高为 1 的多项式是精确的，但对次数为 2 的多项式则积分不足）来计算所有体积内积和表面通量贡献的提升项。两个算子都使用相同的迎风数值通量。\n\n- 对每个 $\\theta$，跨单元采用傅里叶 (布洛赫) 假设，以获得半离散算子的 $2\\times 2$ 符号。对于小的 $\\theta$，将物理（右行）特征值展开为以下形式：\n$$\n\\sigma(\\theta) \\;=\\; -\\,i\\,\\theta \\;+\\; \\alpha\\,\\theta^{2} \\;+\\; i\\,\\beta\\,\\theta^{3} \\;+\\; \\mathcal{O}(\\theta^{4}),\n$$\n其中 $\\alpha$ 和 $\\beta$ 为实系数。\n- 定义相位误差系数为 $\\beta$，幅值误差系数为 $\\alpha$，与上述分解一致。\n\n通过从弱形式和给定的求积选择直接推导，计算次精确求积 DG 算子的系数与精确 DG 算子的系数之间的差异，从而分离并量化次精确求积对这些低波数误差的贡献。即，确定序对\n$$\n\\Delta \\alpha \\;=\\; \\alpha_{\\text{sub-exact}} - \\alpha_{\\text{exact}}, \n\\qquad\n\\Delta \\beta \\;=\\; \\beta_{\\text{sub-exact}} - \\beta_{\\text{exact}}.\n$$\n\n您的最终答案必须是写成行矩阵形式的有序对 $(\\Delta \\alpha,\\;\\Delta \\beta)$。无需进行数值取整；请提供精确值。角度（若有）以弧度为单位。",
            "solution": "用户希望找到次精确求积对于一维线性平流方程的间断伽辽金 (DG) 离散化在低波数误差系数上的贡献。\n\n### 步骤 1：问题验证\n\n问题陈述的验证如下：\n- **给定条件**：\n    - 偏微分方程(PDE)：$u_t + a u_x = 0$，常数 $a0$。\n    - 域：一维、周期性、单元长度为 $h$ 的均匀网格。\n    - DG 方法：多项式次数 $p=1$。\n    - 参考单元 $\\xi \\in [-1,1]$ 上的基：模态基 $\\phi_0(\\xi)=1$, $\\phi_1(\\xi)=\\xi$。\n    - 映射：对于单元 $K_j$，$x = x_j + \\frac{h}{2}\\xi$。\n    - 数值通量：迎风格式，$\\hat{f}(u_L, u_R) = a u_L$。\n    - 傅里叶分析：波数 $\\kappa$，无量纲波数 $\\theta = \\kappa h$。\n    - 特征值问题：半离散解 $u \\sim \\exp(\\lambda t)$，其中 $\\lambda = \\frac{a}{h}\\sigma(\\theta)$。\n    - 特征值展开：$\\sigma(\\theta) = -i\\theta + \\alpha\\theta^2 + i\\beta\\theta^3 + \\mathcal{O}(\\theta^4)$。\n    - 两种内积计算情况：\n        1. “精确 DG 算子”：所有积分都精确计算。\n        2. “次精确求积 DG 算子”：体积积分和表面提升积分使用两点高斯-洛巴托 (GL2) 法则计算，该法则对次数为 1 的多项式是精确的。\n- **验证**：\n    - 该问题具有科学依据，涉及 DG 方法的数值分析，这是计算科学中的一个标准课题。\n    - 该问题是适定的、客观的、自洽的，提供了推导结果所需的所有必要参数。\n    - 计算是可行的。\n- **结论**：该问题有效。\n\n### 步骤 2：半离散 DG 格式\n\n对于检验函数 $v_h$，参考单元 $K_j$ 上的 DG 弱形式为：\n$$\n\\int_{K_j} (u_h)_t v_h \\, dx - \\int_{K_j} a u_h (v_h)_x \\, dx + [a u_h^* v_h]_{\\partial K_j} = 0\n$$\n其中 $u_h^*$ 是数值通量。对于 $a0$ 使用迎风通量，$u_h^*(x_{j+1/2}) = u_h(x_{j+1/2}^-)$ 且 $u_h^*(x_{j-1/2}) = u_{h,j-1}(x_{j-1/2}^-)$。设 $v_h=\\phi_l(\\xi)$。变换到参考单元 $\\xi \\in [-1,1]$：\n$$\n\\frac{h}{2} \\int_{-1}^1 (u_h)_t \\phi_l \\, d\\xi = a \\int_{-1}^1 u_h (\\phi_l)_\\xi \\, d\\xi - a u_h(1) \\phi_l(1) + a u_{h,j-1}(1) \\phi_l(-1)\n$$\n解为 $u_h(\\xi) = \\hat{u}_{j0}\\phi_0(\\xi) + \\hat{u}_{j1}\\phi_1(\\xi)$。设 $\\hat{\\mathbf{u}}_j = [\\hat{u}_{j0}, \\hat{u}_{j1}]^T$。方程变为：\n$$\n\\frac{h}{2} \\mathbf{M} \\frac{d\\hat{\\mathbf{u}}_j}{dt} = a \\left( \\mathbf{S} \\hat{\\mathbf{u}}_j - (\\hat{u}_{j0}+\\hat{u}_{j1}) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + e^{-i\\theta}(\\hat{u}_{j0}+\\hat{u}_{j1}) \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\right)\n$$\n其中，对相邻单元的贡献使用了傅里叶假设 $\\hat{\\mathbf{u}}_{j-1} = e^{-i\\theta} \\hat{\\mathbf{u}}_j$。矩阵为：\n- 质量矩阵：$M_{lk} = \\int_{-1}^1 \\phi_k \\phi_l \\, d\\xi$。\n- 刚度矩阵：$S_{lk} = \\int_{-1}^1 \\phi_k (\\phi_l)_\\xi \\, d\\xi$。\n\n假设解为 $\\hat{\\mathbf{u}}_j(t) = \\tilde{\\mathbf{u}} e^{\\lambda t}$，我们得到特征值问题 $\\lambda \\hat{\\mathbf{u}}_j = \\frac{2a}{h} \\mathbf{M}^{-1} \\dots \\hat{\\mathbf{u}}_j$。设 $\\sigma = \\frac{h}{a}\\lambda$，符号矩阵 $\\hat{\\mathbf{L}}(\\theta)$ 为：\n$$\n\\hat{\\mathbf{L}}(\\theta) = 2 \\mathbf{M}^{-1} \\left[ \\left(\\mathbf{S} - \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\\right) + e^{-i\\theta} \\begin{pmatrix} 1  1 \\\\ -1  -1 \\end{pmatrix} \\right] \\hat{\\mathbf{u}}_j\n$$\n\n### 步骤 3：精确 DG 算子分析\n\n对于精确情况，我们精确计算矩阵 $\\mathbf{M}$ 和 $\\mathbf{S}$。\n$\\phi_0=1, \\phi_1=\\xi$。\n$M_{00} = \\int_{-1}^1 1^2 \\,d\\xi=2$， $M_{11} = \\int_{-1}^1 \\xi^2 \\,d\\xi = 2/3$，$M_{01}=M_{10}=0$。\n$\\mathbf{M}_{\\text{exact}} = \\begin{pmatrix} 2  0 \\\\ 0  2/3 \\end{pmatrix}$。\n$S_{10} = \\int_{-1}^1 \\phi_0 (\\phi_1)_\\xi \\,d\\xi = \\int_{-1}^1 1 \\cdot 1 \\,d\\xi=2$。所有其他项均为零。\n$\\mathbf{S} = \\begin{pmatrix} 0  0 \\\\ 2  0 \\end{pmatrix}$。\n前乘因子为 $2 \\mathbf{M}_{\\text{exact}}^{-1} = 2 \\begin{pmatrix} 1/2  0 \\\\ 0  3/2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  3 \\end{pmatrix}$。\n符号矩阵为：\n$$\n\\hat{\\mathbf{L}}_{\\text{exact}}(\\theta) = \\begin{pmatrix} 1  0 \\\\ 0  3 \\end{pmatrix} \\left[ \\left(\\begin{pmatrix} 0  0 \\\\ 2  0 \\end{pmatrix} - \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\\right) + e^{-i\\theta} \\begin{pmatrix} 1  1 \\\\ -1  -1 \\end{pmatrix} \\right] = \\begin{pmatrix} -1+e^{-i\\theta}  -1+e^{-i\\theta} \\\\ 3-3e^{-i\\theta}  -3-3e^{-i\\theta} \\end{pmatrix}\n$$\n特征方程为 $\\det(\\hat{\\mathbf{L}}_{\\text{exact}} - \\sigma \\mathbf{I}) = 0$。\n$\\text{tr}(\\hat{\\mathbf{L}}_{\\text{exact}}) = -4 - 2e^{-i\\theta}$。\n$\\det(\\hat{\\mathbf{L}}_{\\text{exact}}) = -6(e^{-i\\theta}-1)$。\n方程为 $\\sigma^2 - (-4-2e^{-i\\theta})\\sigma - 6(e^{-i\\theta}-1) = 0$，即 $\\sigma^2 + (4+2e^{-i\\theta})\\sigma + 6(1-e^{-i\\theta}) = 0$。\n解为 $\\sigma = \\frac{-(4+2e^{-i\\theta}) \\pm \\sqrt{(4+2e^{-i\\theta})^2 - 24(1-e^{-i\\theta})}}{2} = -2-e^{-i\\theta} \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2}$。\n对于物理模态，$\\sigma(0)=0$，我们取‘+’号。\n$\\sigma_{\\text{exact}}(\\theta) = -2 - e^{-i\\theta} + \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2}$。\n对于小 $\\theta$ 进行展开，使用 $e^{-i\\theta} = z = 1-i\\theta - \\frac{\\theta^2}{2} + i\\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^4)$：\n被开方数为 $R = z^2+10z-2 = 9 - 12i\\theta - 7\\theta^2 + 3i\\theta^3 + \\mathcal{O}(\\theta^4)$。\n$\\sqrt{R} = 3\\sqrt{1 - \\frac{4}{3}i\\theta - \\frac{7}{9}\\theta^2 + \\frac{i}{3}\\theta^3 + \\dots} = 3\\left[1 + \\frac{1}{2}(-\\frac{4}{3}i\\theta - \\frac{7}{9}\\theta^2 + \\frac{i}{3}\\theta^3) - \\frac{1}{8}(-\\frac{4}{3}i\\theta)^2 + \\frac{1}{16}(-\\frac{4}{3}i\\theta)^3 + \\dots\\right]$。\n$= 3\\left[1 - \\frac{2}{3}i\\theta - \\frac{7}{18}\\theta^2 + \\frac{i}{6}\\theta^3 + \\frac{2}{9}\\theta^2 - \\frac{7i}{27}\\theta^3 + \\frac{4i}{27}\\theta^3 + \\dots \\right] = 3\\left[1 - \\frac{2}{3}i\\theta - \\frac{1}{6}\\theta^2 + \\frac{i}{18}\\theta^3 + \\dots\\right] = 3 - 2i\\theta - \\frac{1}{2}\\theta^2 + \\frac{i}{6}\\theta^3 + \\dots$。\n$\\sigma_{\\text{exact}}(\\theta) = -2 - (1-i\\theta-\\frac{\\theta^2}{2}+\\frac{i\\theta^3}{6}) + (3 - 2i\\theta - \\frac{1}{2}\\theta^2 + \\frac{i}{6}\\theta^3) + \\mathcal{O}(\\theta^4) = (-2-1+3) + i\\theta(1-2) + \\theta^2(\\frac{1}{2}-\\frac{1}{2}) + i\\theta^3(-\\frac{1}{6}+\\frac{1}{6}) + \\mathcal{O}(\\theta^4)$。\n$\\sigma_{\\text{exact}}(\\theta) = -i\\theta + \\mathcal{O}(\\theta^4)$。\n因此，对于精确 DG 算子，$\\alpha_{\\text{exact}} = 0$ 且 $\\beta_{\\text{exact}} = 0$。\n\n### 步骤 4：次精确求积 DG 算子分析\n\n$[-1,1]$ 上的 GL2 求积法则的节点为 $\\{-1, 1\\}$，权重为 $\\{1, 1\\}$。它对次数最高为 1 的多项式是精确的。\n该法则应用于体积积分。刚度矩阵 $\\mathbf{S}$ 的被积函数次数为 0 或 1，因此可以精确计算。$\\mathbf{S}_{\\text{sub}} = \\mathbf{S}$。\n质量矩阵的被积函数 $\\phi_1^2=\\xi^2$ 次数为 2，无法被精确积分。\n$M_{00}^{GL2} = 1\\cdot(1)^2+1\\cdot(1)^2 = 2$。\n$M_{11}^{GL2} = 1\\cdot(-1)^2+1\\cdot(1)^2 = 2$。\n$\\mathbf{M}_{\\text{sub}} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} = 2\\mathbf{I}$。\n前乘因子为 $2 \\mathbf{M}_{\\text{sub}}^{-1} = 2 (\\frac{1}{2}\\mathbf{I}) = \\mathbf{I}$。\n符号矩阵为：\n$$\n\\hat{\\mathbf{L}}_{\\text{sub}}(\\theta) = \\mathbf{I} \\left[ \\dots \\right] = \\begin{pmatrix} -1+e^{-i\\theta}  -1+e^{-i\\theta} \\\\ 1-e^{-i\\theta}  -1-e^{-i\\theta} \\end{pmatrix}\n$$\n特征方程为 $\\sigma^2 - \\text{tr}(\\hat{\\mathbf{L}}_{\\text{sub}})\\sigma + \\det(\\hat{\\mathbf{L}}_{\\text{sub}}) = 0$。\n$\\text{tr}(\\hat{\\mathbf{L}}_{\\text{sub}}) = -2$。\n$\\det(\\hat{\\mathbf{L}}_{\\text{sub}}) = -2(e^{-i\\theta}-1)$。\n方程为 $\\sigma^2 + 2\\sigma - 2(e^{-i\\theta}-1) = 0$。\n解为 $\\sigma = -1 \\pm \\sqrt{1 - (-2(e^{-i\\theta}-1))} = -1 \\pm \\sqrt{2e^{-i\\theta}-1}$。\n取物理分支得到 $\\sigma_{\\text{sub}}(\\theta) = -1 + \\sqrt{2e^{-i\\theta}-1}$。\n对小 $\\theta$ 进行展开：\n被开方数为 $2(1-i\\theta-\\frac{\\theta^2}{2}+\\frac{i\\theta^3}{6}+\\dots)-1 = 1-2i\\theta-\\theta^2+\\frac{i\\theta^3}{3}+\\dots$。\n$\\sqrt{1-2i\\theta-\\theta^2+\\frac{i\\theta^3}{3}} = 1 + \\frac{1}{2}(-2i\\theta-\\theta^2+\\frac{i\\theta^3}{3}) - \\frac{1}{8}(-2i\\theta)^2 + \\frac{1}{16}(-2i\\theta)^3 + \\dots$。\n$= 1 - i\\theta - \\frac{\\theta^2}{2} + \\frac{i\\theta^3}{6} + \\frac{\\theta^2}{2} - \\frac{i\\theta^3}{2} + \\frac{i\\theta^3}{2} + \\dots = 1 - i\\theta + i\\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^4)$。\n$\\sigma_{\\text{sub}}(\\theta) = -1 + (1 - i\\theta + i\\frac{1}{6}\\theta^3 + \\dots) = -i\\theta + i\\frac{1}{6}\\theta^3 + \\mathcal{O}(\\theta^4)$。\n因此，对于次精确算子，$\\alpha_{\\text{sub-exact}} = 0$ 且 $\\beta_{\\text{sub-exact}} = 1/6$。\n\n### 步骤 5：次精确求积的贡献\n\n次精确求积对误差系数的贡献是次精确情况和精确情况之间的差值。\n$\\Delta \\alpha = \\alpha_{\\text{sub-exact}} - \\alpha_{\\text{exact}} = 0 - 0 = 0$。\n$\\Delta \\beta = \\beta_{\\text{sub-exact}} - \\beta_{\\text{exact}} = \\frac{1}{6} - 0 = \\frac{1}{6}$。\n序对为 $(\\Delta\\alpha, \\Delta\\beta) = (0, 1/6)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0   \\frac{1}{6} \\end{pmatrix}}\n$$"
        }
    ]
}