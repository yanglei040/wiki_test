{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在奠定坚实的理论与实践基础。我们首先从一个经典问题入手：对绝对值函数 $|x|$ 进行最佳一致逼近。 这个问题因其在原点的不可微性而成为一个典型的教学案例，它能帮助学生掌握切比雪夫交错定理的应用。随后，练习将理论与谱方法的实际操作联系起来，要求构建并分析一个将节点值转换为模态系数的矩阵，从而深入理解谱方法中不同表示之间的转换及其数值稳定性。",
            "id": "3367314",
            "problem": "考虑谱方法和间断Galerkin方法背景下的最佳均匀多项式逼近问题。令函数 $f(x) = |x|$ 定义在区间 $[-1,1]$上。对任意连续函数 $g$，定义均匀范数为 $\\|g\\|_{\\infty} = \\sup_{x \\in [-1,1]} |g(x)|$。在所有次数至多为1的多项式中，考虑 $p(x) = a x + b$ 以及均匀逼近误差 $E = \\|f - p\\|_{\\infty}$。利用切比雪夫交错定理和对称性考虑等基本结果，确定唯一最佳均匀逼近式的系数 $a$ 和 $b$ 以及相应的误差 $E$。\n\n现在，在勒让德多项式的模态谱设置中进行系数确定。考虑勒让德多项式 $P_{0}(x) = 1$ 和 $P_{1}(x) = x$，它们在区间 $[-1,1]$上关于权重 $1$ 正交，满足 $\\int_{-1}^{1} P_{n}(x) P_{m}(x)\\, dx = \\frac{2}{2n+1} \\delta_{nm}$。定义具有3个节点 $x_{0} = -1$、$x_{1} = 0$、$x_{2} = 1$ 和权重 $w_{0} = \\frac{1}{3}$、$w_{1} = \\frac{4}{3}$、$w_{2} = \\frac{1}{3}$ 的勒让德-高斯-洛巴托（LGL）求积法，该方法能精确积分次数最高为3的多项式。考虑离散系数确定算子 $M$，它通过LGL权重导出的离散内积，将节点采样向量 $\\mathbf{u} = \\big(u(x_{0}), u(x_{1}), u(x_{2})\\big)^{\\top}$ 映射到模态系数 $(c_{0}, c_{1})^{\\top}$：\n$$\nc_{n} = \\alpha_{n} \\sum_{j=0}^{2} w_{j}\\, u(x_{j})\\, P_{n}(x_{j}), \\quad \\text{for } n = 0,1,\n$$\n其中 $\\alpha_{n} = \\frac{2n+1}{2}$，这样如果使用精确积分，连续 $L^{2}$ 勒让德系数将是 $c_{n} = \\alpha_{n} \\int_{-1}^{1} u(x)\\, P_{n}(x)\\, dx$。构建与此映射相对应的 $2 \\times 3$ 矩阵 $M$。\n\n计算 $M$ 的2-范数条件数 $\\kappa_{2}(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)}$，其中 $\\sigma_{\\max}(M)$ 和 $\\sigma_{\\min}(M)$ 分别表示 $M$ 的最大和最小奇异值。将你的最终答案以一个精确数值的形式表示。",
            "solution": "这个问题包含两个不同的部分。第一部分要求找到函数 $f(x) = |x|$ 在区间 $[-1,1]$ 上的最佳均匀线性多项式逼近。第二部分涉及在谱方法背景下，构建一个与离散系数确定过程相关的矩阵算子 $M$，然后计算其2-范数条件数。我将按顺序解决这两个部分。\n\n第一部分：$f(x) = |x|$ 的最佳均匀逼近\n\n问题是找到一个次数至多为1的多项式 $p(x) = ax+b$，使得误差的均匀范数 $E = \\|f - p\\|_{\\infty} = \\sup_{x \\in [-1,1]} ||x| - (ax+b)|$ 最小。\n\n首先，我们利用对称性。函数 $f(x)=|x|$ 是一个偶函数，即对所有 $x$ 都有 $f(x) = f(-x)$。逼近区间 $[-1,1]$ 关于 $x=0$ 对称。在这种情况下，唯一的次数为 $n$ 的最佳均匀多项式逼近本身也是一个偶多项式。一个次数至多为1的多项式 $p(x) = ax+b$ 是偶函数，当且仅当其奇部为零。奇部由 $\\frac{p(x)-p(-x)}{2} = \\frac{(ax+b)-(-ax+b)}{2} = ax$ 给出。要使此式对所有 $x$ 都为零，系数 $a$ 必须为 $0$。\n因此，最佳线性逼近式必须是一个常数多项式 $p(x) = b$。\n\n接下来，我们必须找到使 $E = \\sup_{x \\in [-1,1]} ||x|-b|$ 最小化的常数 $b$。\n函数 $|x|$ 在区间 $[-1,1]$ 上的值域是 $[0,1]$。问题简化为在无穷范数的意义下，找到一个与区间 $[0,1]$“最接近”的常数 $b$。这等价于最小化 $\\max_{y \\in [0,1]} |y-b|$。当 $b$ 是值域区间 $[0,1]$ 的中点时，该最小值得以实现。\n因此，$b = \\frac{0+1}{2} = \\frac{1}{2}$。\n\n最佳均匀逼近是 $p(x) = \\frac{1}{2}$，对应的系数是 $a=0$ 和 $b=\\frac{1}{2}$。\n\n相应的误差是 $E = \\sup_{x \\in [-1,1]} ||x|-\\frac{1}{2}|$。\n函数 $e(x) = |x|-\\frac{1}{2}$ 在 $[-1,1]$ 上，在 $x=\\pm 1$ 处取得最大值 $e(\\pm 1) = 1-\\frac{1}{2} = \\frac{1}{2}$。在 $x=0$ 处取得最小值 $e(0) = 0-\\frac{1}{2} = -\\frac{1}{2}$。\n因此，最大绝对误差为 $E = \\frac{1}{2}$。\n\n为了正式确认这个结果，我们应用切比雪夫交错定理。对于一个次数 $n=1$ 的多项式逼近，在区间内必须存在至少 $n+2=3$ 个点，使得误差函数 $e(x)$ 在这些点上达到其最大绝对值 $E$ 且符号交替。\n我们来检验误差函数 $e(x) = |x|-\\frac{1}{2}$，其中 $E=\\frac{1}{2}$：\n1. 在 $x_1 = -1$ 处，$e(-1) = |-1|-\\frac{1}{2} = 1-\\frac{1}{2} = \\frac{1}{2} = +E$。\n2. 在 $x_2 = 0$ 处，$e(0) = |0|-\\frac{1}{2} = -\\frac{1}{2} = -E$。\n3. 在 $x_3 = 1$ 处，$e(1) = |1|-\\frac{1}{2} = 1-\\frac{1}{2} = \\frac{1}{2} = +E$。\n点 $x_1=-1  x_2=0  x_3=1$ 展示了所要求的误差符号交替 $(+E, -E, +E)$。这证实了 $p(x)=\\frac{1}{2}$ 确实是次数至多为1的唯一最佳均匀逼近。\n系数为 $a=0$，$b=\\frac{1}{2}$，误差为 $E=\\frac{1}{2}$。\n\n第二部分：矩阵 $M$ 的条件数\n\n问题定义了一个从节点采样向量 $\\mathbf{u} = (u(x_0), u(x_1), u(x_2))^\\top$ 到模态系数向量 $\\mathbf{c} = (c_0, c_1)^\\top$ 的映射，通过矩阵-向量乘积 $\\mathbf{c} = M\\mathbf{u}$ 实现。矩阵 $M$ 的元素公式由系数的表达式导出：\n$$c_{n} = \\sum_{j=0}^{2} \\left( \\alpha_{n} w_{j} P_{n}(x_{j}) \\right) u(x_{j})$$\n矩阵 $M$ 是一个 $2 \\times 3$ 矩阵，其中元素 $M_{n,j}$ 是括号内乘以 $u(x_j)=u_j$ 的项。因此，$M_{n,j} = \\alpha_n w_j P_n(x_j)$，其中 $n \\in \\{0, 1\\}$ 且 $j \\in \\{0, 1, 2\\}$。\n\n给定的值为：\n- 勒让德多项式：$P_0(x) = 1$, $P_1(x) = x$。\n- LGL 节点：$x_0 = -1$, $x_1 = 0$, $x_2 = 1$。\n- LGL 权重：$w_0 = \\frac{1}{3}$, $w_1 = \\frac{4}{3}$, $w_2 = \\frac{1}{3}$。\n- 归一化因子：$\\alpha_n = \\frac{2n+1}{2}$，所以 $\\alpha_0 = \\frac{1}{2}$ 和 $\\alpha_1 = \\frac{3}{2}$。\n\n我们逐行构建矩阵 $M$。\n\n对于第一行 ($n=0$)：\n$M_{0,0} = \\alpha_0 w_0 P_0(x_0) = \\frac{1}{2} \\cdot \\frac{1}{3} \\cdot P_0(-1) = \\frac{1}{6} \\cdot 1 = \\frac{1}{6}$。\n$M_{0,1} = \\alpha_0 w_1 P_0(x_1) = \\frac{1}{2} \\cdot \\frac{4}{3} \\cdot P_0(0) = \\frac{2}{3} \\cdot 1 = \\frac{2}{3}$。\n$M_{0,2} = \\alpha_0 w_2 P_0(x_2) = \\frac{1}{2} \\cdot \\frac{1}{3} \\cdot P_0(1) = \\frac{1}{6} \\cdot 1 = \\frac{1}{6}$。\n\n对于第二行 ($n=1$)：\n$M_{1,0} = \\alpha_1 w_0 P_1(x_0) = \\frac{3}{2} \\cdot \\frac{1}{3} \\cdot P_1(-1) = \\frac{1}{2} \\cdot (-1) = -\\frac{1}{2}$。\n$M_{1,1} = \\alpha_1 w_1 P_1(x_1) = \\frac{3}{2} \\cdot \\frac{4}{3} \\cdot P_1(0) = 2 \\cdot 0 = 0$。\n$M_{1,2} = \\alpha_1 w_2 P_1(x_2) = \\frac{3}{2} \\cdot \\frac{1}{3} \\cdot P_1(1) = \\frac{1}{2} \\cdot 1 = \\frac{1}{2}$。\n\n所以，矩阵 $M$ 是：\n$$M = \\begin{pmatrix} \\frac{1}{6}  \\frac{2}{3}  \\frac{1}{6} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\end{pmatrix}$$\n\n2-范数条件数 $\\kappa_2(M)$ 是 $M$ 的最大奇异值与最小奇异值的比值，即 $\\kappa_2(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)}$。$M$ 的奇异值是矩阵 $MM^\\top$ 的特征值的平方根。\n$M^\\top = \\begin{pmatrix} \\frac{1}{6}  -\\frac{1}{2} \\\\ \\frac{2}{3}  0 \\\\ \\frac{1}{6}  \\frac{1}{2} \\end{pmatrix}$。\n我们来计算 $MM^\\top$：\n$$MM^\\top = \\begin{pmatrix} \\frac{1}{6}  \\frac{2}{3}  \\frac{1}{6} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6}  -\\frac{1}{2} \\\\ \\frac{2}{3}  0 \\\\ \\frac{1}{6}  \\frac{1}{2} \\end{pmatrix}$$\n元素 $(1,1)$ 是 $(\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2 = \\frac{1}{36} + \\frac{4}{9} + \\frac{1}{36} = \\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36} = \\frac{18}{36} = \\frac{1}{2}$。\n元素 $(1,2)$ 是 $(\\frac{1}{6})(-\\frac{1}{2}) + (\\frac{2}{3})(0) + (\\frac{1}{6})(\\frac{1}{2}) = -\\frac{1}{12} + 0 + \\frac{1}{12} = 0$。\n元素 $(2,1)$ 是 $(-\\frac{1}{2})(\\frac{1}{6}) + (0)(\\frac{2}{3}) + (\\frac{1}{2})(\\frac{1}{6}) = -\\frac{1}{12} + 0 + \\frac{1}{12} = 0$。\n元素 $(2,2)$ 是 $(-\\frac{1}{2})^2 + (0)^2 + (\\frac{1}{2})^2 = \\frac{1}{4} + 0 + \\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2}$。\n所以，我们有：\n$$MM^\\top = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}$$\n这个对角矩阵的特征值就是其对角元素，即 $\\lambda_1 = \\frac{1}{2}$ 和 $\\lambda_2 = \\frac{1}{2}$。\n$M$ 的奇异值是这些特征值的平方根。因为 $M$ 是一个秩为2的 $2 \\times 3$ 矩阵，它有两个非零奇异值。\n$\\sigma_{\\max}(M) = \\sigma_1 = \\sqrt{\\lambda_1} = \\sqrt{\\frac{1}{2}}$。\n$\\sigma_{\\min}(M) = \\sigma_2 = \\sqrt{\\lambda_2} = \\sqrt{\\frac{1}{2}}$。\n条件数是这些值的比值：\n$$\\kappa_2(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)} = \\frac{\\sqrt{\\frac{1}{2}}}{\\sqrt{\\frac{1}{2}}} = 1$$\n矩阵 $M$ 的条件数是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "本练习将我们带入一个更高级的概念层面，探讨几何映射如何影响最佳一致逼近。在高阶间断Galerkin方法或谱方法中，非线性坐标映射是一种强大工具，它能够在不改变多项式次数的情况下，将计算资源集中在边界层或其他解的陡峭区域。 这个练习通过一系列判断题，旨在挑战学生对坐标映射如何改变逼近空间以及误差等波特性的深刻理解，这对设计高效的自适应数值格式至关重要。",
            "id": "3367374",
            "problem": "考虑一个定义在 $[-1,1]$ 上的实值函数 $f$ 和一个严格单调双射 $\\phi:[-1,1]\\to[-1,1]$。定义 $h(y):=f(\\phi^{-1}(y))$。对于一个固定的整数 $n\\ge 0$，令 $p_n^\\star$ 表示一个次数$\\le n$的多项式，它是 $h$ 在 $[-1,1]$ 上的最佳一致（极小化极大）逼近；也就是说，$p_n^\\star$ 在所有次数$\\le n$的多项式 $p$ 中，最小化一致范数误差 $\\|h-p\\|_{L^\\infty([-1,1])}:=\\sup_{y\\in[-1,1]}|h(y)-p(y)|$。考虑 $f$ 在 $[-1,1]$ 上的复合逼近 $q_n(x):=p_n^\\star(\\phi(x))$，并令 $e(x):=f(x)-q_n(x)$。假定 Chebyshev 系统中最佳一致逼近的 Chebyshev 等波定理中的等波概念是已知的。\n\n在高等谱方法和间断 Galerkin (DG) 方法实践中，非线性的 $\\phi$ 被用来在边界或层附近聚集分辨率。评估以下关于严格单调映射 $\\phi$ 如何影响最佳一致逼近和等波，以及这如何为解析边界层的 DG 离散化的基函数选择提供信息的陈述。\n\nA. 如果 $\\phi$ 是严格单调的，那么误差 $E(y):=h(y)-p_n^\\star(y)$ 在 $[-1,1]$ 上以相等的振幅等波 $n+2$ 次，并且映射后的误差 $e(x)=f(x)-p_n^\\star(\\phi(x))$ 在点 $x_i=\\phi^{-1}(y_i)$ 处以相同的最大振幅恰好等波 $n+2$ 次，其中 $y_i$ 是 $E$ 的等波点。\n\nB. 对于一个一般的非线性严格单调函数 $\\phi$，复合函数 $q_n(x)=p_n^\\star(\\phi(x))$ 是 $f$ 在 $[-1,1]$ 上的次数$\\le n$的极小化极大（或“最佳一致”）多项式逼近。\n\nC. 因为一致范数 $\\|\\cdot\\|_{L^\\infty}$ 在变量变换下不是不变的，所以在边界层附近压缩 $\\phi$（即使得那里的 $|\\phi'|$ 很小）可以对同一个最小化 $\\|h-p\\|_{L^\\infty}$ 的 $p_n^\\star$ 减小 $e$ 的最大误差振幅。\n\nD. 存在 $[0,1]$ 上的函数 $f$ 和一个严格单调映射 $\\phi:[0,1]\\to[0,1]$，使得当 $n=1$ 时，有 $\\inf_{p\\in\\mathcal{P}_1}\\|f-p\\circ \\phi\\|_{L^\\infty([0,1])}=0$ 而 $\\inf_{r\\in\\mathcal{P}_1}\\|f-r\\|_{L^\\infty([0,1])}>0$，其中 $\\mathcal{P}_1$ 是次数$\\le 1$的多项式空间。这表明对于具有端点层的目标函数，映射多项式逼近可以严格优于在 $x$ 中次数匹配的多项式逼近。\n\nE. 在一个具有从参考单元 $\\xi\\in[-1,1]$ 到物理坐标 $x$ 的几何映射 $x=\\Phi(\\xi)$ 的 DG 单元上，使用一个将参考点聚集在边界层附近的非线性 $\\Phi$ 会将逼近空间变为映射多项式 $\\{p(\\xi)\\circ \\Phi^{-1}(x)\\}$，并且对于由此产生的最佳一致逼近，会将等波点集中在边界附近。这为使用映射基或边界层网格以降低满足最大范数误差容限所需的次数提供了理由。\n\n选择所有正确的陈述。",
            "solution": "我们从基本定义和经过充分检验的结果开始。\n\n**最佳一致逼近的定义**：对于紧区间 $I$ 上的连续函数 $g$，其次数 $\\le n$ 的最佳一致（极小化极大）多项式 $p_n^\\star$ 是在所有次数 $\\le n$ 的多项式 $p$ 中，最小化 $\\|g-p\\|_{L^\\infty(I)}=\\sup_{t\\in I}|g(t)-p(t)|$ 的那一个。\n\n**切比雪夫等波定理**：经典定理指出，$p_n^\\star$ 是 $g$ 的最佳一致逼近的充要条件是，误差函数 $g-p_n^\\star$ 在区间 $I$ 上至少有 $n+2$ 个点，其值等于最大误差的绝对值，且符号交替。这些点被称为等波点或交错点组。\n\n**一致范数在变量变换下的不变性**：令 $\\phi:I_x\\to I_y$ 为一个双射。对于 $I_x$ 上的任何函数 $f$ 和 $I_y$ 上的任何函数 $p$，有：\n$$\n\\sup_{x\\in I_x}|f(x)-p(\\phi(x))| = \\sup_{y\\in I_y}|f(\\phi^{-1}(y))-p(y)|.\n$$\n这是因为 $\\phi$ 是一个双射，所以两个上确界是在相同的函数值集合上取值，只是自变量的标记不同。\n\n基于这些原则，我们来分析每个陈述：\n\n**A. 如果 $\\phi$ 是严格单调的，那么误差 $E(y):=h(y)-p_n^\\star(y)$ 在 $[-1,1]$ 上以相等的振幅等波 $n+2$ 次，并且映射后的误差 $e(x)=f(x)-p_n^\\star(\\phi(x))$ 在点 $x_i=\\phi^{-1}(y_i)$ 处以相同的最大振幅恰好等波 $n+2$ 次，其中 $y_i$ 是 $E$ 的等波点。**\n\n**正确**。根据切比雪夫等波定理，$p_n^\\star$ 是 $h$ 的最佳逼近，因此误差 $E(y)$ 在 $[-1,1]$ 上存在一个包含至少 $n+2$ 个点的交错点组 $\\{y_i\\}$。映射后的误差 $e(x)$ 为 $e(x) = f(x) - p_n^\\star(\\phi(x)) = h(\\phi(x)) - p_n^\\star(\\phi(x)) = E(\\phi(x))$。由于 $\\phi$ 是双射，有 $\\|e\\|_{L^\\infty([-1,1])} = \\|E\\|_{L^\\infty([-1,1])}$。令 $x_i = \\phi^{-1}(y_i)$，则 $e(x_i) = E(y_i)$。因此，$\\{x_i\\}$ 构成了 $e(x)$ 的一个交错点组，其长度至少为 $n+2$，且振幅与 $E(y)$ 的最大振幅相同。\n\n**B. 对于一个一般的非线性严格单调函数 $\\phi$，复合函数 $q_n(x)=p_n^\\star(\\phi(x))$ 是 $f$ 在 $[-1,1]$ 上的次数$\\le n$的极小化极大（或“最佳一致”）多项式逼近。**\n\n**错误**。$q_n(x) = p_n^\\star(\\phi(x))$ 不是一个多项式，除非 $\\phi(x)$ 本身是次数为1的多项式。问题要求的是在次数 $\\le n$ 的**多项式**空间中的最佳逼近。$q_n(x)$ 属于一个不同的函数空间，即 $\\{p \\circ \\phi \\mid p \\in \\mathcal{P}_n\\}$。\n\n**C. 因为一致范数 $\\|\\cdot\\|_{L^\\infty}$ 在变量变换下不是不变的，所以在边界层附近压缩 $\\phi$（即使得那里的 $|\\phi'|$ 很小）可以对同一个最小化 $\\|h-p\\|_{L^\\infty}$ 的 $p_n^\\star$ 减小 $e$ 的最大误差振幅。**\n\n**错误**。如上所述，一致范数在变量变换下是**不变的**，即 $\\|e\\|_{L^\\infty} = \\|E\\|_{L^\\infty}$。因此，无论 $\\phi$ 的形式如何，只要它是严格单调的，映射后的误差的最大振幅与原始逼近问题的误差振幅完全相同。$\\phi$ 的作用是重新分布这些误差点在物理域中的位置，而不是改变误差的大小。\n\n**D. 存在 $[0,1]$ 上的函数 $f$ 和一个严格单调映射 $\\phi:[0,1]\\to[0,1]$，使得当 $n=1$ 时，有 $\\inf_{p\\in\\mathcal{P}_1}\\|f-p\\circ \\phi\\|_{L^\\infty([0,1])}=0$ 而 $\\inf_{r\\in\\mathcal{P}_1}\\|f-r\\|_{L^\\infty([0,1])}>0$，其中 $\\mathcal{P}_1$ 是次数$\\le 1$的多项式空间。这表明对于具有端点层的目标函数，映射多项式逼近可以严格优于在 $x$ 中次数匹配的多项式逼近。**\n\n**正确**。考虑函数 $f(x) = \\sqrt{x}$ 在 $[0,1]$ 上。$f$ 不是一个线性函数，因此其最佳线性逼近误差 $\\inf_{r\\in\\mathcal{P}_1}\\|f-r\\|_{L^\\infty}$ 严格大于零。现在，选择严格单调映射 $\\phi(x)=\\sqrt{x}$ 和线性多项式 $p(y)=y$。那么 $p(\\phi(x)) = \\sqrt{x} = f(x)$。因此，$\\|f-p\\circ\\phi\\|_{L^\\infty} = 0$。而 $\\phi(x)=\\sqrt{x}$ 在 $[0,1]$ 上是严格单调的。这表明通过选择合适的非多项式基函数 $\\{p \\circ \\phi\\}$，我们可以比标准多项式基函数获得更好的逼近效果。\n\n**E. 在一个具有从参考单元 $\\xi\\in[-1,1]$ 到物理坐标 $x$ 的几何映射 $x=\\Phi(\\xi)$ 的 DG 单元上，使用一个将参考点聚集在边界层附近的非线性 $\\Phi$ 会将逼近空间变为映射多项式 $\\{p(\\xi)\\circ \\Phi^{-1}(x)\\}$，并且对于由此产生的最佳一致逼近，会将等波点集中在边界附近。这为使用映射基或边界层网格以降低满足最大范数误差容限所需的次数提供了理由。**\n\n**正确**。这是一个关于映射谱方法或DG方法核心思想的准确描述。非线性映射 $\\Phi$ 改变了逼近基函数在物理坐标 $x$ 中的形式。如果 $\\Phi$ 在 $\\xi$ 域的端点附近变化缓慢（即 $|\\Phi'(\\xi)|$ 很小），它会将参考单元端点附近的一小段区域映射到物理单元端点附近一个更小的区域。由于最佳逼近的等波点在参考坐标 $\\xi$ 中趋向于向端点聚集（切比雪夫点分布），这个映射将导致这些点在物理坐标 $x$ 中更加密集地聚集在边界层附近。这实质上是把分辨率重新分配到了最需要它的地方。\n\n综上所述，正确的陈述是 A、D 和 E。",
            "answer": "$$\\boxed{ADE}$$"
        },
        {
            "introduction": "这是一个综合性的实践项目，融合了理论、数值实现与前沿应用。该练习的核心任务是逼近函数 $|x|^{\\alpha}$，它常用于模拟哈密顿-雅可比方程中的不可微哈密顿量。 学生需要将这个逼近问题构建为一个线性规划问题——这是计算极小极大逼近的标准方法，并利用计算出的逼近误差来确定保证数值格式稳定所需的人工粘性大小。这个过程清晰地揭示了抽象的逼近理论如何直接指导鲁棒偏微分方程求解器的设计。",
            "id": "3367329",
            "problem": "考虑函数 $f(x)=|x|^{\\alpha}$ 在区间 $[-1,1]$ 上的情况，其中参数 $0\\alpha1$ 是一个定值。我们研究在谱方法和间断Galerkin方法求解Hamilton-Jacobi方程的背景下，该函数的最佳一致多项式逼近问题。次数为 $N$ 的最佳一致逼近是指多项式 $p_N\\in\\mathcal{P}_N$，它最小化一致范数误差 $\\|f-p_N\\|_{\\infty}=\\sup_{x\\in[-1,1]}|f(x)-p_N(x)|$。函数 $f$ 是偶函数，任何最佳一致逼近 $p_N$ 都可以取为偶多项式（根据对称性），这在正则化谱Hamilton-Jacobi求解器中使用的不可微哈密顿量 $H(p)=|p|^{\\alpha}$ 时非常重要。为了将逼近与稳定性联系起来，我们考虑对Hamilton-Jacobi方程 $u_t + H(u_x)=0$ 进行消失粘性正则化，方法是添加一个粘性项 $\\nu \\, u_{xx}$（其中 $\\nu>0$），并将 $H$ 替换为次数至多为 $N$ 的多项式逼近 $P_N$。一个一致的稳定性要求是，取足够大的 $\\nu_N$ 以支配一致哈密顿量逼近误差，从而在谱方法或间断Galerkin离散化的标准假设下，确保收敛到粘性解。\n\n您的任务是通过将问题简化为在变换变量上次数为 $m=\\lfloor N/2\\rfloor$ 的问题，来构造仅限于偶多项式的最佳一致逼近。令 $y=2x^2-1$，这样 $x\\in[-1,1]$ 就映射到 $y\\in[-1,1]$。然后，当用 $y$ 变量表示时，$f(x)=|x|^{\\alpha}$ 等于 $g(y)=\\left(\\frac{1+y}{2}\\right)^{\\alpha/2}$。如果 $q_m(y)$ 是 $\\mathcal{P}_m$ 中对 $g(y)$ 在一致范数下的最佳一致逼近，那么 $p_N(x)=q_m(2x^2-1)$ 是一个次数至多为 $2m\\le N$ 的偶多项式，并且它是所有次数至多为 $N$ 的偶多项式中的最佳一致逼近。\n\n请仅从一致范数、最佳一致逼近的基本定义以及切比雪夫多项式 $T_k(y)$ 的性质出发，完成以下任务：\n\n1. 使用切比雪夫多项式基 $\\{T_k(y)\\}_{k=0}^m$（其中 $m=\\lfloor N/2\\rfloor$），为 $g(y)$ 在 $[-1,1]$ 上的最佳一致逼近问题建立数学模型。将 $q_m(y)$ 表示为 $q_m(y)=\\sum_{k=0}^m c_k T_k(y)$，并构建一致误差最小化问题 $\\min_{c_0,\\dots,c_m} \\sup_{y\\in[-1,1]} \\left| g(y) - \\sum_{k=0}^m c_k T_k(y) \\right|$。\n\n2. 通过在大小为 $M$（$M$ 为固定的奇数）的切比雪夫-洛巴托网格上对 $y$ 进行采样，将此连续极小化极大问题转化为一个有限维线性规划问题。引入一个辅助变量 $t\\ge 0$ 来表示采样集上的一致误差界，并对每个网格点 $y_j$ 强制执行不等式 $-t \\le g(y_j)-\\sum_{k=0}^m c_k T_k(y_j) \\le t$。您的模型应将得到的线性规划问题表示为具有未知数 $(c_0,\\dots,c_m,t)$ 的标准形式。\n\n3. 求解该线性规划以获得系数 $\\{c_k\\}_{k=0}^m$，并通过在一个独立的、更精细的、大小为 $M_{\\mathrm{eval}}$ 的均匀网格上求值，计算得到的一致误差 $E_N=\\sup_{y\\in[-1,1]} \\left| g(y)-\\sum_{k=0}^m c_k T_k(y)\\right|$。将 $E_N$ 报告为一个浮点数。\n\n4. 根据逼近论中经过充分检验的结论（例如，针对赫尔德连续函数的Jackson型估计），预计 $E_N$ 会以 $C N^{-\\alpha}$ 的速率衰减，其中 $C>0$ 是一个依赖于 $\\alpha$ 的常数。对于每个测试用例，计算经验常数 $K_N = E_N (N+1)^{\\alpha}$ 并将其报告为一个浮点数。因子 $(N+1)^{\\alpha}$ 用于正则化 $N=0$ 的情况。\n\n5. 通过简单准则 $\\nu_N^\\star = E_N$，为谱方法或间断Galerkin逼近收敛到粘性解定义一个充分的诱导粘性大小 $\\nu_N^\\star$。这一选择的理由是，要求人工粘性在离散残差中支配一致哈密顿量逼近误差。将 $\\nu_N^\\star$ 报告为一个浮点数。\n\n程序的实现要求：\n\n- 对于每个测试用例，通过在 $y\\in[-1,1]$ 上具有 $M=2049$ 个点的切比雪夫-洛巴托网格上求解所述的线性规划来计算 $q_m$，并在一个独立的、具有 $M_{\\mathrm{eval}}=20001$ 个点的 $y\\in[-1,1]$ 均匀网格上评估 $E_N$。\n- 为了数值 conditioning，使用切比雪夫多项式基 $T_k(y)$，$0\\le k\\le m$。\n- 每个测试用例的最终输出是一个三元组 $[E_N, K_N, \\nu_N^\\star]$。\n\n测试套件：\n\n- 使用以下测试用例 $(\\alpha,N)$：\n    - $(\\alpha,N)=(0.25,8)$，\n    - $(\\alpha,N)=(0.5,16)$，\n    - $(\\alpha,N)=(0.9,32)$，\n    - $(\\alpha,N)=(0.75,0)$。\n- 为每个测试用例生成三元组 $[E_N, K_N, \\nu_N^\\star]$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，包含一个结果列表，其中每个结果是对应一个测试用例的三个浮点数列表。该列表必须以逗号分隔，并用方括号括起来，不含空格。例如，格式为 $[[r_{11},r_{12},r_{13}],[r_{21},r_{22},r_{23}],\\dots]$，其中每个 $r_{ij}$ 都是一个浮点数。",
            "solution": "我们从最佳一致逼近的基本定义和切比雪夫多项式的性质出发。函数是 $f(x)=|x|^{\\alpha}$，$0\\alpha1$，它在 $[-1,1]$ 上是偶函数且是指数为 $\\alpha$ 的赫尔德连续函数。因为 $f$ 是偶函数，所以任何次数为 $N$ 的最佳一致多项式逼近都可以取为偶函数：如果 $p_N$ 是最优的，那么 $(p_N(x)+p_N(-x))/2$ 是偶函数且不会增加一致误差，因此可以在不失最优性的情况下强制要求偶性。我们因此将注意力限制在偶多项式上。\n\n为了消除偶性约束，我们使用变量替换 $y=2x^2-1$ 将 $x\\in[-1,1]$ 映射到 $y\\in[-1,1]$，并定义 $g(y)=\\left(\\frac{1+y}{2}\\right)^{\\alpha/2}$，使得 $f(x)=g(2x^2-1)$。任何次数至多为 $N$ 的偶多项式 $p(x)$ 都可以写成 $p(x)=q_m(2x^2-1)$ 的形式，其中 $q_m$ 是一个关于 $y$ 的次数至多为 $m=\\lfloor N/2\\rfloor$ 的多项式。因此，对次数至多为 $N$ 的偶多项式的最佳一致逼近问题等价于在 $[-1,1]$ 上用多项式 $q_m\\in\\mathcal{P}_m$ 对 $g$ 进行最佳一致逼近的问题：\n$$\n\\inf_{q_m\\in \\mathcal{P}_m} \\| g - q_m \\|_{\\infty}, \\quad \\|h\\|_{\\infty}=\\sup_{y\\in[-1,1]}|h(y)|.\n$$\n\n我们将 $q_m$ 表示在切比雪夫多项式基 $\\{T_k(y)\\}_{k=0}^m$ 中，其中 $T_k$ 是由 $T_k(\\cos\\theta)=\\cos(k\\theta)$ 定义的第一类切比雪夫多项式。写作\n$$\nq_m(y)=\\sum_{k=0}^m c_k T_k(y),\n$$\n其中系数 $\\{c_k\\}_{k=0}^m$ 待定。于是最佳一致逼近问题变为\n$$\n\\min_{c_0,\\dots,c_m} \\sup_{y\\in[-1,1]} \\left| g(y) - \\sum_{k=0}^m c_k T_k(y) \\right|.\n$$\n\n为了计算数值解，我们通过在一组点上采样来离散化一致范数，并将问题转化为一个线性规划。设 $M$ 为一个奇数，并在 $[-1,1]$ 上使用 $M$ 点切比雪夫-洛巴托网格：\n$$\ny_j=\\cos\\left(\\frac{\\pi j}{M-1}\\right), \\quad j=0,1,\\dots,M-1.\n$$\n定义 $g_j=g(y_j)$ 和 $V_{jk}=T_k(y_j)$，其中 $0\\le j\\le M-1$ 且 $0\\le k\\le m$。引入一个辅助变量 $t\\ge 0$，表示采样点上一致误差的上界。离散的极小化极大问题就变成了线性规划\n$$\n\\min_{c_0,\\dots,c_m,t} \\; t\n$$\n受制于对每个 $j$ 的线性不等式，\n$$\n-t \\le g(y_j) - \\sum_{k=0}^m c_k T_k(y_j), \\qquad \\sum_{k=0}^m c_k T_k(y_j) - t \\le g_j,\n$$\n或等价地，\n$$\n\\sum_{k=0}^m c_k T_k(y_j) - t \\le g_j, \\qquad -\\sum_{k=0}^m c_k T_k(y_j) - t \\le -g_j.\n$$\n这是一个标准形式的线性规划，变量为 $(c_0,\\dots,c_m,t)$，目标系数向量为 $(0,\\dots,0,1)$，有 $2M$ 个不等式约束。使用切比雪夫基是为了改善数值条件。\n\n求解这个线性规划可以得到系数 $\\{c_k\\}$ 和网格上的一个离散界 $t$。为了估计真正的一致误差，我们在一个大小为 $M_{\\mathrm{eval}}$ 的、在 $y\\in[-1,1]$ 上均匀分布的独立精细网格上评估误差：\n$$\nE_N \\approx \\max_{0\\le j \\le M_{\\mathrm{eval}}-1} \\left| g(y_j^{\\mathrm{eval}}) - \\sum_{k=0}^m c_k T_k\\left(y_j^{\\mathrm{eval}}\\right) \\right|.\n$$\n由于 $x\\mapsto y=2x^2-1$ 将 $[-1,1]$ 映射到 $[-1,1]$ 并且 $p_N(x)=q_m(2x^2-1)$，这个在 $y$ 上的误差等于偶多项式 $p_N$ 在 $x$ 上的一致误差：\n$$\nE_N=\\sup_{x\\in[-1,1]}|f(x)-p_N(x)|=\\sup_{y\\in[-1,1]}|g(y)-q_m(y)|.\n$$\n\n根据逼近论中经过充分检验的结论，如针对赫尔德函数的Jackson型估计，已知最佳一致误差满足形式为 $E_N\\le C N^{-\\alpha}$ 的界，其中常数 $C$ 依赖于 $\\alpha$。这启发我们定义经验常数\n$$\nK_N = E_N \\,(N+1)^{\\alpha}\n$$\n以考虑低次数情况（特别是 $N=0$）并评估观测到的收敛率。\n\n为了将此与谱方法和间断Galerkin (DG) Hamilton-Jacobi求解器中不可微哈密顿量的正则化联系起来，考虑方程 $u_t+H(u_x)=0$（其中 $H(p)=|p|^{\\alpha}$），并通过添加人工粘性 $\\nu u_{xx}$ 来逼近 $H$ 为一个次数至多为 $N$ 的多项式 $P_N$。一致哈密顿量误差贡献了一个大小至多为 $E_N$ 的相容性误差，而一个确保收敛到粘性解的充分稳定性准则是选择粘性来支配离散残差中的那个误差。一个简单的充分选择是\n$$\n\\nu_N^\\star = E_N.\n$$\n在当前纯数学的设定下，这个准则是无量纲的，它捕捉了基于最佳一致哈密顿量逼近误差的消失粘性方法论。\n\n算法设计：\n\n- 计算 $m=\\lfloor N/2\\rfloor$。\n- 构建具有 $M=2049$ 个点的切比雪夫-洛巴托网格 $\\{y_j\\}_{j=0}^{M-1}$，并计算 $g_j=\\left(\\frac{1+y_j}{2}\\right)^{\\alpha/2}$。\n- 构造切比雪夫范德蒙矩阵 $V\\in\\mathbb{R}^{M\\times(m+1)}$，其元素为 $V_{jk}=T_k(y_j)$，$0\\le k\\le m$。\n- 构造线性规划，变量为 $(c_0,\\dots,c_m,t)$，目标为最小化 $t$，约束为 $V c - t\\mathbf{1}\\le g$ 和 $-V c - t\\mathbf{1}\\le -g$，界限为 $t\\ge 0, c_k\\in\\mathbb{R}$。\n- 使用可靠的线性规划求解器求解该线性规划。\n- 在一个大小为 $M_{\\mathrm{eval}}=20001$ 的 $y\\in[-1,1]$ 均匀网格上通过计算 $g$ 和 $q_m(y)=\\sum_{k=0}^m c_k T_k(y)$ 之间的最大绝对偏差来评估 $E_N$。\n- 计算 $K_N=E_N (N+1)^{\\alpha}$ 并设置 $\\nu_N^\\star=E_N$。\n- 对指定的测试用例重复以上步骤。\n\n测试套件和输出：\n\n- 对于 $(\\alpha,N)=(0.25,8)$, $(0.5,16)$, $(0.9,32)$, $(0.75,0)$，计算 $[E_N,K_N,\\nu_N^\\star]$。\n- 程序打印单行 $[[E_1,K_1,\\nu_1],[E_2,K_2,\\nu_2],[E_3,K_3,\\nu_3],[E_4,K_4,\\nu_4]]$，不含空格，其中每个条目都是一个浮点数。\n\n该方法从最佳一致逼近的基本定义出发，使用一个离散线性规划公式，该公式在采样网格加密时收敛到极小化极大解。切比雪夫基利用了切比雪夫多项式经过充分检验的性质，而经验常数 $K_N$ 展示了预期的赫尔德率。诱导粘性 $\\nu_N^\\star=E_N$ 是一个有原则的充分选择，用于控制在谱方法和间断Galerkin求解器中由哈密顿量逼近误差引起的残差，从而契合了收敛到粘性解所需的消失粘性框架。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom numpy.polynomial.chebyshev import chebvander\n\ndef chebyshev_lobatto_grid(M: int) -> np.ndarray:\n    # M must be odd; returns y_j = cos(pi * j / (M-1)), j=0..M-1\n    j = np.arange(M, dtype=float)\n    return np.cos(np.pi * j / (M - 1))\n\ndef build_lp_matrices(y: np.ndarray, m: int, alpha: float):\n    # Build Vandermonde in Chebyshev basis and LP constraints\n    V = chebvander(y, m)  # shape (M, m+1), columns are T_k(y)\n    g = ((1.0 + y) / 2.0) ** (alpha / 2.0)\n    M = y.shape[0]\n    # Inequalities: V c - t = g  and  -V c - t = -g\n    A1 = np.hstack([V, -np.ones((M, 1))])\n    A2 = np.hstack([-V, -np.ones((M, 1))])\n    A_ub = np.vstack([A1, A2])\n    b_ub = np.concatenate([g, -g])\n    # Objective: minimize t\n    c_obj = np.zeros(m + 2)\n    c_obj[-1] = 1.0\n    # Bounds: c_k free, t >= 0\n    bounds = [(None, None)] * (m + 1) + [(0.0, None)]\n    return c_obj, A_ub, b_ub, bounds\n\ndef solve_minimax_even(alpha: float, N: int, M: int = 2049, M_eval: int = 20001):\n    # m is degree in y for the even polynomial space\n    m = N // 2\n    # Build Chebyshev-Lobatto grid for LP\n    y = chebyshev_lobatto_grid(M)\n    c_obj, A_ub, b_ub, bounds = build_lp_matrices(y, m, alpha)\n    # Solve LP\n    res = linprog(c=c_obj, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method=\"highs\")\n    if not res.success:\n        raise RuntimeError(f\"Linear program failed to solve: {res.message}\")\n    coeffs = res.x[:m + 1]\n    # Evaluate uniform error on a fine uniform grid\n    y_eval = np.linspace(-1.0, 1.0, M_eval)\n    V_eval = chebvander(y_eval, m)\n    q_eval = V_eval @ coeffs\n    g_eval = ((1.0 + y_eval) / 2.0) ** (alpha / 2.0)\n    E = np.max(np.abs(g_eval - q_eval))\n    return coeffs, E\n\ndef format_results(results):\n    # Format as [[a,b,c],[...]] with no spaces, numbers in scientific notation\n    parts = []\n    for triple in results:\n        nums = \",\".join(f\"{v:.12e}\" for v in triple)\n        parts.append(f\"[{nums}]\")\n    return \"[\" + \",\".join(parts) + \"]\"\n\ndef solve():\n    # Define test cases: (alpha, N)\n    test_cases = [\n        (0.25, 8),\n        (0.5, 16),\n        (0.9, 32),\n        (0.75, 0),\n    ]\n    M = 2049\n    M_eval = 20001\n    results = []\n    for alpha, N in test_cases:\n        _, E_N = solve_minimax_even(alpha, N, M=M, M_eval=M_eval)\n        K_N = E_N * (N + 1) ** alpha\n        nu_star = E_N\n        results.append([E_N, K_N, nu_star])\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}