{
    "hands_on_practices": [
        {
            "introduction": "Weierstrass 定理保证了多项式可以逼近任何连续函数，但在实践中，我们需要具体的逼近策略。本练习探讨了两种定义“最佳”逼近的核心方法：最小化最大误差（$L^\\infty$ 范数或极小极大逼近）和最小化加权平方误差（$L^2_w$ 范数或正交投影）。通过对经典非光滑函数 $f(x)=|x|$ 进行分析，您将亲手计算并比较这两种逼近的误差，从而深刻理解不同范数在谱方法中的意义和选择。",
            "id": "3428460",
            "problem": "令 $f(x)=|x|$ 于 $[-1,1]$ 上。Weierstrass 逼近定理保证了多项式在一致范数下在 $C([-1,1])$ 中是稠密的，这是支撑使用多项式基的谱方法和不连续 Galerkin (DG) 方法的一个基本事实。考虑两种不同的逼近策略，每种策略都是使用 Chebyshev 多项式进行谱分析的基础：\n\n1. 在 $\\mathbb{P}_{1}$（次数至多为 $1$ 的多项式空间）中的极小化极大（一致范数）逼近，其中误差由一致范数 $\\|g\\|_{\\infty}=\\sup_{x\\in[-1,1]}|g(x)|$ 度量。\n\n2. 到 $\\mathbb{P}_{1}$ 上的 Chebyshev 加权 Lebesgue $L^{2}$ 投影，权重为 $w(x)=(1-x^{2})^{-1/2}$，即关于内积 $\\langle g,h\\rangle_{w}=\\int_{-1}^{1}g(x)h(x)w(x)\\,dx$ 的正交投影。\n\n任务：\n- 计算精确的极小化极大一致范数误差 $E_{\\infty}=\\inf_{p\\in\\mathbb{P}_{1}}\\|f-p\\|_{\\infty}$ 并确定极小值点 $p^{\\star}\\in\\mathbb{P}_{1}$。\n- 计算精确的 Chebyshev 加权 $L^{2}$ 投影 $P_{1}^{w}f\\in\\mathbb{P}_{1}$ 和精确的加权 $L^{2}$ 误差 $\\|f-P_{1}^{w}f\\|_{L^{2}_{w}}=\\big(\\int_{-1}^{1}(f-p)^{2}w\\,dx\\big)^{1/2}$。\n- 使用 $f$ 的 Chebyshev 级数，推导 $f$ 的 $N$ 次截断 Chebyshev 级数的一致误差的一个严格上界，该上界通过其 Chebyshev 系数的尾部以 $N$ 的形式表示。明确写出结果上界，其常数需为闭合形式。\n\n最后，报告比率\n$$\nR=\\frac{E_{\\infty}}{\\|f-P_{1}^{w}f\\|_{L^{2}_{w}}}\n$$\n的精确解析表达式。\n最终比率无需四舍五入，也不应使用任何单位。",
            "solution": "该问题经评估具有科学性、良定性、客观性，并符合所有其他验证标准。因此，该问题是有效的，下面提供了完整的解答。\n\n该问题要求分析函数 $f(x)=|x|$ 在区间 $[-1,1]$ 上的两种不同次数至多为 $1$ 的多项式逼近，并求出截断 Chebyshev 级数误差的一个界。\n\n**第1部分：极小化极大逼近**\n\n我们寻求多项式 $p(x) \\in \\mathbb{P}_1$ 以最小化误差的一致范数 $\\|f-p\\|_{\\infty}$。设 $p(x) = ax+b$。我们想要找到 $a, b \\in \\mathbb{R}$ 来最小化 $E(a,b) = \\sup_{x \\in [-1,1]} ||x| - (ax+b)|$。所得的最小误差为 $E_{\\infty}$。\n\n函数 $f(x)=|x|$ 在对称区间 $[-1,1]$ 上是偶函数。逼近论中的一个已知结果是，在 $[-1,1]$ 上对偶函数的 $\\mathbb{P}_n$ 中最佳一致逼近多项式 $p^{\\star}(x)$ 也是一个偶多项式。对于 $p(x)=ax+b \\in \\mathbb{P}_1$ 来说，要使其为偶函数，必须有 $p(-x)=p(x)$，这意味着 $a(-x)+b = ax+b$。这对于所有 $x \\in [-1,1]$ 都意味着 $-ax=ax$，因此要求 $a=0$。于是，最佳逼近必须是一个常数多项式，$p^{\\star}(x)=b$。\n\n我们现在需要找到常数 $b$ 以最小化 $\\sup_{x \\in [-1,1]} ||x|-b|$。设误差函数为 $e(x) = |x|-b$。$|e(x)|$ 在 $[-1,1]$ 上的极值将出现在 $e(x)$ 的临界点，即端点 $x=\\pm 1$ 和 $|x|$ 的导数未定义的点 $x=0$。\n在这些点上的误差值为：\n$e(-1) = |-1| - b = 1-b$\n$e(0) = |0| - b = -b$\n$e(1) = |1| - b = 1-b$\n\n根据 Chebyshev 等振荡定理，对于一个次数为 $n=0$ 的多项式（一个常数），必须至少有 $n+2=2$ 个点，在这些点上误差达到其最大绝对值且符号交替。对于 $n=1$（我们最初的搜索空间），我们需要 $3$ 个点。使用我们的三个候选点 $x_0=-1$, $x_1=0$, $x_2=1$，我们试图满足等振荡条件。误差必须满足 $|e(x_0)|=|e(x_1)|=|e(x_2)|=E_{\\infty}$ 且符号必须交替，例如，$e(x_0) = -e(x_1) = e(x_2)$。\n我们设 $e(-1) = -e(0)$ 和 $e(1) = -e(0)$。\n第一个条件给出 $1-b = -(-b) = b$，这意味着 $2b=1$，所以 $b=1/2$。\n第二个条件是相同的，同样得出 $b=1/2$。\n当 $b=1/2$ 时，多项式为 $p^{\\star}(x) = 1/2$。\n在等振荡点处的误差为：\n$e(-1) = 1 - 1/2 = 1/2$\n$e(0) = -1/2$\n$e(1) = 1 - 1/2 = 1/2$\n最大误差绝对值为 $E_{\\infty} = 1/2$。我们必须验证对于所有其他 $x \\in [-1,1]$，误差绝对值不超过这个值。对于 $x \\in [-1,1]$，我们有 $0 \\le |x| \\le 1$。因此，误差函数 $e(x)=|x|-1/2$ 的范围从 $-1/2$（在 $x=0$ 处）到 $1/2$（在 $x=\\pm 1$ 处）。所以，对于所有 $x \\in [-1,1]$，都有 $|e(x)| = ||x|-1/2| \\le 1/2$。\n等振荡定理的条件对于 $n=0$ 成立，也对于 $n=1$ 成立（因为 $p^\\star \\in \\mathbb{P}_1$ 并且我们有3个等振荡点）。\n$\\mathbb{P}_1$ 中的极小化极大逼近多项式是 $p^{\\star}(x) = 1/2$。\n极小化极大一致范数误差是 $E_{\\infty} = 1/2$。\n\n**第2部分：Chebyshev 加权 $L^2$ 投影**\n\n我们寻求 $f(x)=|x|$ 到 $\\mathbb{P}_1$ 上关于内积 $\\langle g,h\\rangle_w = \\int_{-1}^1 g(x)h(x)(1-x^2)^{-1/2} dx$ 的正交投影 $P_1^w f$。\n空间 $\\mathbb{P}_1$ 由前两个 Chebyshev 多项式 $T_0(x)=1$ 和 $T_1(x)=x$ 张成，它们构成一个正交基。\n该投影由 $P_1^w f(x) = c_0 T_0(x) + c_1 T_1(x)$ 给出，其中系数为 $c_k = \\frac{\\langle f, T_k \\rangle_w}{\\langle T_k, T_k \\rangle_w}$。\n基函数的范数是众所周知的：\n$\\langle T_0, T_0 \\rangle_w = \\int_{-1}^1 1^2 \\frac{dx}{\\sqrt{1-x^2}} = [\\arcsin x]_{-1}^1 = \\pi$。\n$\\langle T_1, T_1 \\rangle_w = \\int_{-1}^1 x^2 \\frac{dx}{\\sqrt{1-x^2}} = \\pi/2$。\n\n对于 $c_0$：\n$\\langle f, T_0 \\rangle_w = \\int_{-1}^1 |x| \\frac{dx}{\\sqrt{1-x^2}}$。被积函数是偶函数，所以这等于 $2 \\int_0^1 \\frac{x}{\\sqrt{1-x^2}} dx$。\n使用换元法 $u=1-x^2$, $du=-2xdx$：$2 \\int_1^0 \\frac{-du/2}{\\sqrt{u}} = \\int_0^1 u^{-1/2} du = [2\\sqrt{u}]_0^1 = 2$。\n所以，$c_0 = \\frac{2}{\\pi}$。\n\n对于 $c_1$：\n$\\langle f, T_1 \\rangle_w = \\int_{-1}^1 |x|x \\frac{dx}{\\sqrt{1-x^2}}$。被积函数 $g(x)=\\frac{x|x|}{\\sqrt{1-x^2}}$ 是一个奇函数，因为 $g(-x) = \\frac{(-x)|-x|}{\\sqrt{1-(-x)^2}} = -\\frac{x|x|}{\\sqrt{1-x^2}} = -g(x)$。奇函数在对称区间 $[-1,1]$ 上的积分为 $0$。\n所以，$\\langle f, T_1 \\rangle_w = 0$，这给出 $c_1 = 0$。\n\n投影是 $P_1^w f(x) = \\frac{2}{\\pi} T_0(x) + 0 \\cdot T_1(x) = \\frac{2}{\\pi}$。\n\n接下来，我们计算加权 $L^2$ 误差 $\\|f - P_1^w f\\|_{L^2_w}$。\n根据 Hilbert 空间中的勾股定理，对于正交投影：\n$\\|f - P_1^w f\\|_{L^2_w}^2 = \\|f\\|_{L^2_w}^2 - \\|P_1^w f\\|_{L^2_w}^2$。\n第一项：\n$\\|f\\|_{L^2_w}^2 = \\int_{-1}^1 |x|^2 \\frac{dx}{\\sqrt{1-x^2}} = \\int_{-1}^1 \\frac{x^2}{\\sqrt{1-x^2}} dx$。这个积分等于 $\\langle T_1, T_1 \\rangle_w$，我们已知其值为 $\\pi/2$。\n第二项：\n$\\|P_1^w f\\|_{L^2_w}^2 = \\|\\frac{2}{\\pi} T_0\\|_{L^2_w}^2 = (\\frac{2}{\\pi})^2 \\langle T_0, T_0 \\rangle_w = \\frac{4}{\\pi^2} \\cdot \\pi = \\frac{4}{\\pi}$。\n所以，误差的平方是 $\\|f - P_1^w f\\|_{L^2_w}^2 = \\frac{\\pi}{2} - \\frac{4}{\\pi} = \\frac{\\pi^2 - 8}{2\\pi}$。\n加权 $L^2$ 误差是 $\\|f - P_1^w f\\|_{L^2_w} = \\sqrt{\\frac{\\pi^2 - 8}{2\\pi}}$。\n\n**第3部分：截断 Chebyshev 级数的一致误差界**\n\n$f(x)=|x|$ 的 Chebyshev 级数是 $f(x) = \\sum_{k=0}^\\infty a_k T_k(x)$，其中 $a_k = \\frac{\\langle f, T_k \\rangle_w}{\\langle T_k, T_k \\rangle_w}$。\n我们已经求得 $a_0 = c_0 = 2/\\pi$ 和 $a_1 = c_1 = 0$。由于 $f(x)$ 是偶函数，所有奇数 $k$ 的 $a_k$ 均为 $0$。\n对于偶数 $k=2m$ ($m \\ge 1$)：\n$a_{2m} = \\frac{\\langle f, T_{2m} \\rangle_w}{\\langle T_{2m}, T_{2m} \\rangle_w} = \\frac{1}{\\pi/2} \\int_{-1}^1 \\frac{|x|T_{2m}(x)}{\\sqrt{1-x^2}} dx = \\frac{4}{\\pi} \\int_0^1 \\frac{x T_{2m}(x)}{\\sqrt{1-x^2}} dx$。\n令 $x=\\cos\\theta$, $dx=-\\sin\\theta d\\theta$：积分变为 $\\int_{\\pi/2}^0 \\frac{\\cos\\theta \\cos(2m\\theta)}{ \\sin\\theta} (-\\sin\\theta d\\theta) = \\int_0^{\\pi/2} \\cos\\theta \\cos(2m\\theta) d\\theta$。\n使用恒等式 $2\\cos A \\cos B = \\cos(A-B)+\\cos(A+B)$：\n$\\frac{1}{2} \\int_0^{\\pi/2} [\\cos((2m-1)\\theta) + \\cos((2m+1)\\theta)] d\\theta = \\frac{1}{2} \\left[ \\frac{\\sin((2m-1)\\theta)}{2m-1} + \\frac{\\sin((2m+1)\\theta)}{2m+1} \\right]_0^{\\pi/2}$\n$= \\frac{1}{2} \\left( \\frac{\\sin(m\\pi-\\pi/2)}{2m-1} + \\frac{\\sin(m\\pi+\\pi/2)}{2m+1} \\right) = \\frac{1}{2} \\left( \\frac{(-1)^{m+1}}{2m-1} + \\frac{(-1)^m}{2m+1} \\right) = \\frac{(-1)^{m+1}}{2} \\left( \\frac{1}{2m-1} - \\frac{1}{2m+1} \\right)$\n$= \\frac{(-1)^{m+1}}{2} \\frac{(2m+1)-(2m-1)}{4m^2-1} = \\frac{(-1)^{m+1}}{4m^2-1}$。\n所以，$\\langle f, T_{2m} \\rangle_w = 2 \\int_0^{\\pi/2} \\cos\\theta \\cos(2m\\theta) d\\theta = 2 \\frac{(-1)^{m+1}}{4m^2-1}$。\n$a_{2m} = \\frac{2(-1)^{m+1}/(4m^2-1)}{\\pi/2} = \\frac{4}{\\pi} \\frac{(-1)^{m+1}}{4m^2-1}$ 对于 $m \\ge 1$。\n\n$N$ 次截断 Chebyshev 级数为 $S_N f = \\sum_{k=0}^N a_k T_k(x)$。一致误差由系数的尾部界定：\n$\\|f - S_N f\\|_{\\infty} = \\|\\sum_{k=N+1}^\\infty a_k T_k(x)\\|_{\\infty} \\le \\sum_{k=N+1}^\\infty |a_k|$，因为 $|T_k(x)|\\le 1$。\n求和是对于偶数索引 $2m  N$ 进行的，即 $m  N/2$。第一个整数是 $m_{min} = \\lfloor N/2 \\rfloor + 1$。\n上界是 $\\sum_{m=\\lfloor N/2 \\rfloor+1}^\\infty |a_{2m}| = \\sum_{m=\\lfloor N/2 \\rfloor+1}^\\infty \\frac{4}{\\pi} \\frac{1}{4m^2-1}$。\n这个和可以通过 $\\frac{1}{4m^2-1} = \\frac{1}{2}(\\frac{1}{2m-1} - \\frac{1}{2m+1})$ 的裂项求和性质精确计算：\n$\\sum_{m=M}^\\infty \\frac{1}{4m^2-1} = \\frac{1}{2(2M-1)}$。\n代入 $M = \\lfloor N/2 \\rfloor + 1$，上界为 $\\frac{4}{\\pi} \\cdot \\frac{1}{2(2(\\lfloor N/2 \\rfloor + 1) - 1)} = \\frac{2}{\\pi(2\\lfloor N/2 \\rfloor + 1)}$。\n这可以为偶数和奇数 $N$ 明确写出：\n如果 $N$ 是偶数，$N=2k$，上界是 $\\frac{2}{\\pi(2k+1)} = \\frac{2}{\\pi(N+1)}$。\n如果 $N$ 是奇数，$N=2k-1$，上界是 $\\frac{2}{\\pi(2(k-1)+1)} = \\frac{2}{\\pi(2k-1)} = \\frac{2}{\\pi N}$。\n一致误差的上界是 $\\frac{2}{\\pi(2\\lfloor N/2 \\rfloor + 1)}$。\n\n**第4部分：最终比率**\n\n最后，我们计算比率 $R = \\frac{E_{\\infty}}{\\|f-P_{1}^{w}f\\|_{L^{2}_{w}}}$。\n使用第1部分和第2部分的结果：\n$E_{\\infty} = 1/2$\n$\\|f-P_{1}^{w}f\\|_{L^{2}_{w}} = \\sqrt{\\frac{\\pi^2 - 8}{2\\pi}}$\n该比率为：\n$$R = \\frac{1/2}{\\sqrt{\\frac{\\pi^2 - 8}{2\\pi}}} = \\frac{1}{2} \\sqrt{\\frac{2\\pi}{\\pi^2-8}} = \\sqrt{\\frac{1}{4} \\frac{2\\pi}{\\pi^2-8}} = \\sqrt{\\frac{\\pi}{2(\\pi^2-8)}}$$",
            "answer": "$$ \\boxed{\\sqrt{\\frac{\\pi}{2(\\pi^{2}-8)}}} $$"
        },
        {
            "introduction": "虽然全局多项式逼近理论上可行，但对于包含局部特征（如尖点或激波）的函数，它可能效率低下。间断 Galerkin (DG) 方法通过分片多项式提供了一个更灵活的框架。这个练习将引导您从理论走向实践，通过选择合适的网格尺寸 $h$ 和局部多项式次数 $p$，为函数 $f(x)=|x|$ 构建一个满足预设误差 $\\epsilon$ 的分片多项式逼近。这个过程将具体展示 $h$-refinement 和 $p$-refinement 这两种自适应策略的基本思想。",
            "id": "3428493",
            "problem": "设函数 $f(x) = |x|$ 定义在紧区间 $[-1,1]$ 上。考虑在间断 Galerkin (DG) 方法中使用的分片多项式空间，\n$$\nV_{h}^{p} := \\left\\{ v \\in L^{\\infty}([-1,1]) \\,\\Big|\\, v|_{K} \\in \\mathbb{P}_{p}(K) \\text{ for each mesh element } K \\text{ of a uniform partition of } [-1,1] \\text{ with element size } h \\right\\},\n$$\n其中 $\\mathbb{P}_{p}(K)$ 表示限制在 $K$ 上的次数至多为 $p$ 的多项式，而 $h$ 是均匀剖分中每个单元的长度。利用紧集上连续性的基本性质和 Weierstrass 逼近定理背后的思想，构造一个显式的 $v_{h}^{p} \\in V_{h}^{p}$，使其达到预定的均匀逼近误差 $\\epsilon  0$，\n$$\n\\|f - v_{h}^{p}\\|_{L^{\\infty}([-1,1])} \\le \\epsilon,\n$$\n通过适当地选择网格尺寸 $h$ 和局部多项式次数 $p$。确定能够实现这种构造的最小整数次数 $p$ 以及在保证误差界的情况下允许的最大均匀单元尺寸 $h$。以 $\\epsilon$ 表示您的最终答案，形式为数对 $(p,h)$。不需要四舍五入，也不涉及物理单位。以单行矩阵的形式提供该数对作为最终答案。",
            "solution": "用户希望解决以下问题：\n设函数 $f(x) = |x|$ 定义在紧区间 $[-1,1]$ 上。考虑在间断 Galerkin (DG) 方法中使用的分片多项式空间，\n$$\nV_{h}^{p} := \\left\\{ v \\in L^{\\infty}([-1,1]) \\,\\Big|\\, v|_{K} \\in \\mathbb{P}_{p}(K) \\text{ for each mesh element } K \\text{ of a uniform partition of } [-1,1] \\text{ with element size } h \\right\\},\n$$\n其中 $\\mathbb{P}_{p}(K)$ 表示限制在 $K$ 上的次数至多为 $p$ 的多项式，而 $h$ 是均匀剖分中每个单元的长度。利用紧集上连续性的基本性质和 Weierstrass 逼近定理背后的思想，构造一个显式的 $v_{h}^{p} \\in V_{h}^{p}$，使其达到预定的均匀逼近误差 $\\epsilon  0$，\n$$\n\\|f - v_{h}^{p}\\|_{L^{\\infty}([-1,1])} \\le \\epsilon,\n$$\n通过适当地选择网格尺寸 $h$ 和局部多项式次数 $p$。确定能够实现这种构造的最小整数次数 $p$ 以及在保证误差界的情况下允许的最大均匀单元尺寸 $h$。以 $\\epsilon$ 表示您的最终答案，形式为数对 $(p,h)$。不需要四舍五入，也不涉及物理单位。以单行矩阵的形式提供该数对作为最终答案。\n\n### 问题验证\n\n1.  **提取已知条件**：\n    -   函数：$f(x) = |x|$ 在区间 $[-1, 1]$ 上。\n    -   逼近空间：$V_{h}^{p}$，由在 $[-1, 1]$ 的均匀剖分（网格单元尺寸为 $h$）上次数至多为 $p$ 的分片多项式组成。\n    -   误差度量：$L^{\\infty}([-1,1])$ 范数，定义为 $\\|g\\|_{L^{\\infty}(I)} = \\sup_{x \\in I} |g(x)|$。\n    -   误差容限：$\\epsilon  0$。\n    -   目标：构造一个逼近函数 $v_h^p \\in V_h^p$ 使得 $\\|f - v_h^p\\|_{L^{\\infty}([-1,1])} \\le \\epsilon$。\n    -   要求输出：数对 $(p, h)$，其中 $p$ 是可能实现的最小整数次数，而 $h$ 是在该最小 $p$ 值下保证误差界的最大单元尺寸。\n\n2.  **使用提取的已知条件进行验证**：\n    -   **科学依据**：该问题在数值分析和逼近理论领域是公认的。函数 $f(x)=|x|$ 是研究非光滑函数逼近的一个典型例子。间断 Galerkin 空间 $V_h^p$ 是一种标准构造。对 Weierstrass 逼近定理的引用指向了使用连续性和局域逼近的基本概念。所有概念在数学上都是合理的。\n    -   **适定性和客观性**：问题的陈述使用了清晰、客观的数学定义。找到“最小”次数 $p$ 和“最大”尺寸 $h$ 的要求定义了一个特定的优化问题，应该会得到一个唯一的答案。\n\n3.  **结论**：\n    -   该问题是有效的。\n\n### 解答\n\n目标是找到最小整数次数 $p$ 和相应的最大网格尺寸 $h$，以确保函数 $f(x)=|x|$ 可以被一个函数 $v_h^p \\in V_h^p$ 在 $L^{\\infty}$ 范数下以不大于 $\\epsilon$ 的误差进行逼近。\n\n空间 $V_h^p$ 由在 $[-1,1]$ 的均匀剖分的每个单元 $K$上次数至多为 $p$ 的多项式函数组成。区间的总长度为 $2$。一个尺寸为 $h$ 的单元的均匀剖分意味着有 $N=2/h$ 个这样的单元。全局逼近误差是所有单元上局部逼近误差的最大值：\n$$\n\\|f - v_{h}^{p}\\|_{L^{\\infty}([-1,1])} = \\max_{K} \\|f - v_{h}^{p}\\|_{L^{\\infty}(K)}.\n$$\n为了构造最优的 $v_h^p$，我们应该在每个单元 $K$ 上选择 $\\mathbb{P}_p(K)$ 中对 $f(x)$ 的最佳 $L^{\\infty}$ 逼近多项式。那么，在一个单元 $K$ 上的误差由 $E_{p,K}(f) = \\inf_{q \\in \\mathbb{P}_p(K)} \\|f - q\\|_{L^{\\infty}(K)}$ 给出。\n\n$f(x)=|x|$ 的关键特征是它在 $x=0$ 处的不可微性。在远离原点的地方，$f(x)$ 要么是 $x$，要么是 $-x$，两者都是次数为 $1$ 的多项式。\n\n我们需要找到能够进行合适构造的最小整数次数 $p$。我们从测试最低的可能的非负整数次数 $p=0$ 开始。\n\n**情况：$p=0$ (分片常数逼近)**\n\n对于 $p=0$，空间 $V_h^0$ 由分片常数函数组成。在每个单元 $K$ 上，我们用一个常数 $c_K$ 来逼近 $f(x)$。对于区间 $K$ 上的函数 $g$，其在 $L^{\\infty}$ 范数下的最佳常数逼近 $c_K$ 由 $c_K = \\frac{1}{2}(\\sup_{x \\in K} g(x) + \\inf_{x \\in K} g(x))$ 给出。在该单元上得到的最小误差为 $E_{0,K}(g) = \\frac{1}{2}(\\sup_{x \\in K} g(x) - \\inf_{x \\in K} g(x))$。\n\n让我们分析 $f(x)=|x|$ 的误差：\n1.  **单元 $K$ 不包含原点 $x=0$**：\n    设 $K = [a, a+h]$ 且 $a0$。在此单元上，$f(x)=x$。该函数是单调的。\n    误差为 $E_{0,K}(f) = \\frac{1}{2}(f(a+h) - f(a)) = \\frac{1}{2}((a+h) - a) = \\frac{h}{2}$。\n    类似地，对于一个单元 $K = [-b-h, -b]$ 且 $b>0$，$f(x)=-x$。该函数在 $K$ 上也是单调的。误差为 $E_{0,K}(f) = \\frac{1}{2}(\\sup_{x \\in K} f(x) - \\inf_{x \\in K} f(x)) = \\frac{1}{2}(f(-b-h) - f(-b)) = \\frac{1}{2}((b+h) - b) = h/2$。\n    对于任何不包含原点的单元，逼近误差恰好是 $h/2$。\n\n2.  **单元 $K$ 包含原点 $x=0$**：\n    对 $[-1,1]$ 的均匀剖分可以将原点置于两个单元之间的边界点（如果单元数 $N$ 是偶数），或者置于一个单元的内部（如果 $N$ 是奇数）。我们必须考虑最坏情况。a) 如果 $K = [0, h]$ 或 $K=[-h, 0]$，分析与情况1相同，误差为 $h/2$。b) 如果 $K=[-h/2, h/2]$，函数 $f(x)=|x|$ 不是单调的。在此区间上，$\\inf_{x \\in K} f(x) = f(0) = 0$ 且 $\\sup_{x \\in K} f(x) = f(h/2) = f(-h/2) = h/2$。\n    误差为 $E_{0,K}(f) = \\frac{1}{2}(\\frac{h}{2} - 0) = \\frac{h}{4}$。\n\n因此，在所有可能的单元上的最大误差是 $\\max(h/2, h/4) = h/2$。\n所以，对于 $p=0$，我们可以构造 $v_h^0$ 使得 $\\|f - v_h^0\\|_{L^{\\infty}([-1,1])} = h/2$。\n为了满足条件 $\\|f - v_h^0\\|_{L^{\\infty}([-1,1])} \\le \\epsilon$，我们必须有：\n$$\n\\frac{h}{2} \\le \\epsilon \\implies h \\le 2\\epsilon.\n$$\n这表明对于 $p=0$ 是可以构造的，只要我们选择 $h \\le 2\\epsilon$。由于 $p$ 必须是一个非负整数，$p=0$是可能的最小次数。\n\n问题要求的是对应于这个最小次数的允许的最大均匀单元尺寸 $h$。从不等式 $h \\le 2\\epsilon$ 可知，$h$ 的最大值为 $2\\epsilon$。\n\n这与关于连续性的提示是一致的。函数 $f(x)=|x|$ 是均匀连续的。事实上，它是 Lipschitz 连续的，Lipschitz 常数为 $1$，即 $||x| - |y|| \\le |x-y|$。在任何长度为 $h$ 的区间上，函数的值域最多为 $h$。对于分片常数逼近，误差受函数值域的限制，我们更精确的计算给出的误差是 $h/2$。\n\n因此，最小整数次数是 $p=0$，允许的最大单元尺寸是 $h=2\\epsilon$。所要求的数对是 $(p, h) = (0, 2\\epsilon)$。\n\n为了完整性，我们考虑 $p=1$ 的情况。在任何不包含原点的单元 $K$ 上，$f(x)$ 是线性的，所以我们可以设置 $v_h^1|_K = f|_K$，误差为 $0$。在一个包含原点的单元上，比如 $K_0=[-h/2, h/2]$，我们需要找到 $|x|$ 的最佳线性逼近。在一个对称区间上，偶函数的最佳 $L^\\infty$ 逼近也是偶函数，因此最佳线性逼近是一个常数。这在 $K_0$ 上退化为 $p=0$ 的情况，误差为 $h/4$。因此，对于 $p=1$，总误差是 $h/4$。条件 $h/4 \\le \\epsilon$ 意味着 $h \\le 4\\epsilon$。虽然这允许更大的 $h$，但问题要求的是与*最小*次数 $p$ 相关联的结果，即 $p=0$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  2\\epsilon \\end{pmatrix} } $$"
        },
        {
            "introduction": "在利用多项式逼近求解微分方程时，一个关键步骤是计算其导数，但这其中暗藏风险。微分是一个不稳定的算子，它会显著放大插值数据中的微小误差，导致灾难性的结果。本练习将引导您推导出一个严格的导数误差上界，揭示误差放大效应与插值节点的选择密切相关。通过对比等距节点和切比雪夫节点的表现，您将理解为何后者的使用对于谱方法和 DG 方法的稳定性和精度至关重要。",
            "id": "3428470",
            "problem": "考虑一个连续函数 $f:[-1,1]\\to\\mathbb{R}$，例如 $f(x)=\\frac{1}{1+25x^{2}}$，并假设我们在谱配置法中，通过其在一组不同节点 $\\{x_{j}\\}_{j=0}^{n}\\subset[-1,1]$ 上的 $n$ 次 Lagrange 插值多项式 $p_{n}$ 来近似 $f$。在实践中，节点采样值通常会受到微小误差的污染，因此我们将观测数据写为 $g_{j}=f(x_{j})+\\delta_{j}$，其中对所有 $j$ 都有 $|\\delta_{j}|\\leq \\varepsilon$。令 $I_{n}$ 表示将节点数据映射到插值多项式的插值算子，令 $\\Lambda_{n}$ 表示节点集的 Lebesgue 常数，定义为将 $I_{n}$ 视为 $C([-1,1])$ 上的算子时的一致范数。对 $f'(x)$ 的谱微分近似是通过对 $p_{n}(x)$ 求导得到的。\n\n仅使用基本定义和公认结果（用于证明多项式近似存在性的 Weierstrass 近似定理、Lebesgue 常数的算子范数解释，以及 $[-1,1]$ 上多项式的 Markov 不等式），推导一个由节点数据扰动纯粹引起的最坏情况导数误差的严格上界，即 $\\|p_{n}'-\\tilde{p}_{n}'\\|_{\\infty}$ 的一个上界，其中 $\\tilde{p}_{n}$ 是精确节点值 $\\{f(x_{j})\\}_{j=0}^{n}$ 的插值多项式。你的界必须用 $n$、$\\Lambda_{n}$ 和 $\\varepsilon$ 来表示。\n\n然后，通过引用标准的 Lebesgue 常数界 $\\Lambda_{n}^{\\mathrm{cheb}}\\leq \\frac{2}{\\pi}\\ln(n+1)+1$，将你的界具体化到 Chebyshev-Gauss-Lobatto 节点 $x_{j}=\\cos\\left(\\frac{j\\pi}{n}\\right)$，$j=0,\\dots,n$ 的情况。以 $n$ 和 $\\varepsilon$ 的单个闭式解析表达式的形式给出最终的界。\n\n最后，简要解释为什么相同的推导可以表明等距节点会遭受更大的误差放大，从而说明在谱方法和间断 Galerkin (DG) 方法中对插值多项式求导时使用 Chebyshev 节点的理由。\n\n你的最终答案必须是关于 $\\|p_{n}'-\\tilde{p}_{n}'\\|_{\\infty}$ 在 Chebyshev 节点下的界的单个解析表达式，表示为 $n$ 和 $\\varepsilon$ 的函数。不包括单位，也不要四舍五入。",
            "solution": "问题要求推导插值多项式导数误差的一个严格上界，该误差由节点数据的扰动引起。设 $p_n(x)$ 是在不同节点 $\\{x_j\\}_{j=0}^n \\subset [-1, 1]$ 上对扰动数据 $\\{g_j\\}_{j=0}^n$ 进行插值的唯一的至多 $n$ 次多项式。扰动数据由 $g_j = f(x_j) + \\delta_j$ 给出，其中 $f(x)$ 是底层的连续函数，且对所有 $j$ 都有 $|\\delta_j| \\leq \\varepsilon$。设 $\\tilde{p}_n(x)$ 是在相同节点上对精确数据 $\\{f(x_j)\\}_{j=0}^n$ 进行插值的唯一的至多 $n$ 次多项式。我们寻求 $\\|p_n' - \\tilde{p}_n'\\|_{\\infty}$ 的一个上界。\n\n我们定义误差多项式 $e_n(x) = p_n(x) - \\tilde{p}_n(x)$。根据多项式插值的线性性质，$e_n(x)$ 本身也是一个至多 $n$ 次的多项式。在插值节点 $x_j$ 处，$e_n(x)$ 的值为：\n$$e_n(x_j) = p_n(x_j) - \\tilde{p}_n(x_j) = (f(x_j) + \\delta_j) - f(x_j) = \\delta_j$$\n因此，$e_n(x)$ 是数据值 $\\{\\delta_j\\}$ 在节点 $\\{x_j\\}$ 上的 Lagrange 插值多项式。我们可以用 Lagrange 基多项式 $L_j(x)$ 来表示 $e_n(x)$：\n$$e_n(x) = \\sum_{j=0}^{n} \\delta_j L_j(x)$$\n其中 $L_j(x_k) = \\delta_{jk}$ (Kronecker delta)。\n\n我们的目标是界定 $\\|p_n' - \\tilde{p}_n'\\|_{\\infty} = \\|e_n'\\|_{\\infty}$。推导过程分为两个主要步骤。首先，我们界定误差多项式的一致范数 $\\|e_n\\|_{\\infty}$，其次，我们利用这个结果和 Markov 不等式来界定其导数的一致范数 $\\|e_n'\\|_{\\infty}$。\n\n步骤 1：界定 $\\|e_n\\|_{\\infty}$。\n对 $e_n(x)$ 的表达式使用三角不等式：\n$$\\|e_n\\|_{\\infty} = \\sup_{x \\in [-1, 1]} \\left| \\sum_{j=0}^{n} \\delta_j L_j(x) \\right| \\leq \\sup_{x \\in [-1, 1]} \\sum_{j=0}^{n} |\\delta_j| |L_j(x)|$$\n因为给定对所有 $j \\in \\{0, 1, \\dots, n\\}$ 都有 $|\\delta_j| \\leq \\varepsilon$，我们可以提出最大可能的扰动：\n$$\\|e_n\\|_{\\infty} \\leq \\sup_{x \\in [-1, 1]} \\sum_{j=0}^{n} \\varepsilon |L_j(x)| = \\varepsilon \\left( \\sup_{x \\in [-1, 1]} \\sum_{j=0}^{n} |L_j(x)| \\right)$$\n括号中的项是节点集 $\\{x_j\\}$ 的 Lebesgue 常数的定义，记为 $\\Lambda_n$。Lebesgue 常数是插值算子 $I_n: C([-1, 1]) \\to C([-1, 1])$ 的算子范数。因此，我们有：\n$$\\|e_n\\|_{\\infty} \\leq \\varepsilon \\Lambda_n$$\n\n步骤 2：利用 $\\|e_n\\|_{\\infty}$ 的界来界定 $\\|e_n'\\|_{\\infty}$。\n多项式 $e_n(x)$ 的次数至多为 $n$。对于区间 $[-1, 1]$ 上的多项式，Markov 不等式指出，如果 $P(x)$ 是一个次数至多为 $n$ 的多项式，那么它的导数有界，满足 $\\|P'\\|_{\\infty} \\leq n^2 \\|P\\|_{\\infty}$。将此不等式应用于 $e_n(x)$，我们得到：\n$$\\|e_n'\\|_{\\infty} \\leq n^2 \\|e_n\\|_{\\infty}$$\n\n结合步骤 1 和步骤 2 的结果，得到由数据扰动引起的导数误差的一般界：\n$$\\|p_n' - \\tilde{p}_n'\\|_{\\infty} = \\|e_n'\\|_{\\infty} \\leq n^2 \\|e_n\\|_{\\infty} \\leq n^2 (\\varepsilon \\Lambda_n) = n^2 \\Lambda_n \\varepsilon$$\n\n现在，我们将此界具体化到 Chebyshev-Gauss-Lobatto 节点的情况，其定义为 $x_j = \\cos\\left(\\frac{j\\pi}{n}\\right)$，其中 $j=0, \\dots, n$。问题提供了这些节点的 Lebesgue 常数的标准界：\n$$\\Lambda_n^{\\mathrm{cheb}} \\leq \\frac{2}{\\pi}\\ln(n+1) + 1$$\n将此代入我们的一般误差界，得到 Chebyshev 节点的特定界：\n$$\\|p_n' - \\tilde{p}_n'\\|_{\\infty} \\leq n^2 \\varepsilon \\left(\\frac{2}{\\pi}\\ln(n+1) + 1\\right)$$\n\n最后，这个推导阐明了为什么在微分方面 Chebyshev 节点优于等距节点。节点误差 $\\varepsilon$ 的总放大由因子 $n^2 \\Lambda_n$ 控制。当 $n$ 增大时，该因子的行为由 Lebesgue 常数 $\\Lambda_n$ 的增长决定，而 $\\Lambda_n$ 是节点集的一个属性。\n对于 Chebyshev 节点，$\\Lambda_n = O(\\ln n)$，导致放大因子为 $O(n^2 \\ln n)$。这种多项式增长对于许多数值应用来说是可以接受的。\n与此形成鲜明对比的是，对于等距节点，数值分析中一个众所周知的结果是 Lebesgue 常数随次数呈指数增长：对于大的 $n$，有 $\\Lambda_n^{\\mathrm{equi}} \\sim \\frac{2^{n+1}}{e n \\ln n}$。相应的误差放大因子为 $n^2 \\Lambda_n^{\\mathrm{equi}} \\sim O(n 2^n / \\ln n)$。这种指数增长意味着，即使对于中等大小的 $n$，微小的数据扰动也会被放大到灾难性的水平，使得计算出的导数毫无意义。这种极端的数值不稳定性使得等距节点不适用于高次多项式插值和微分任务，而这些任务在谱方法和间断 Galerkin (DG) 方法中很常见。使用在边界附近聚集的节点，如 Chebyshev 点或 Gauss-Legendre 点，对于保持稳定性至关重要。\n问题陈述中提到的 Weierstrass 近似定理为整个领域提供了理论基础，它保证了对于任何连续函数，都存在一个多项式序列一致收敛于该函数。谱方法是寻找此类良好多项式近似的一种构造性方法。",
            "answer": "$$\\boxed{n^{2} \\varepsilon \\left( \\frac{2}{\\pi} \\ln(n+1) + 1 \\right)}$$"
        }
    ]
}