{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of spectral methods is the intimate relationship between the smoothness of a function and the decay rate of its Fourier coefficients. This practice provides a direct, computational exploration of this principle by tasking you to generate a synthetic periodic signal with a precisely controlled spectral decay. By implementing trigonometric interpolation via the Discrete Fourier Transform (DFT), you will not only reconstruct the signal but also numerically verify its smoothness and investigate the effects of spectral filtering, solidifying your understanding of these core concepts in a practical setting. ",
            "id": "3284382",
            "problem": "You are asked to design and implement a program that constructs trigonometric interpolation polynomials from equispaced samples of synthetic periodic functions, where the spectral content of these functions is controlled by a tunable decay parameter. The program must then validate smoothness by estimating the decay rate of the Fourier coefficients and quantify the effect of spectral filtering. All angles must be in radians.\n\nFundamental basis and definitions to be used:\n- A real-valued, $2\\pi$-periodic function $f$ can be approximated by a trigonometric polynomial constructed from the basis $\\{1, \\cos(kx), \\sin(kx)\\}$ for $k \\in \\mathbb{N}$. The trigonometric interpolation polynomial of degree at most $\\lfloor (N-1)/2 \\rfloor$ that interpolates $N$ equispaced samples is unique.\n- Using equispaced nodes $x_j = 2\\pi j/N$ with $j = 0, 1, \\dots, N-1$, discrete orthogonality of the complex exponential basis $\\{e^{\\mathrm{i}kx}\\}$ ensures that the discrete Fourier transform coefficients $c_k$ can be computed and the original samples exactly recovered by the inverse transform. For real signals, the amplitude of the harmonic pair at frequency $k$ is related to the magnitude of the complex coefficient.\n- The smoothness of a periodic function is reflected in the decay of its Fourier coefficients; smoother functions exhibit faster decay of harmonic amplitudes as a function of frequency index.\n\nTask:\n1. Synthetic dataset generation with controlled smoothness:\n   - For given integers $N$ and $K$ with $N \\ge 2$ and $1 \\le K < N$, consider the equispaced grid $x_j = 2\\pi j/N$.\n   - Define coefficients $a_k$ and $b_k$ for $k = 1, 2, \\dots, K$ using a decay parameter $p > 0$ as\n     $$a_k = k^{-p} + \\Delta_a(k), \\quad b_k = s_k\\left(\\tfrac{1}{2}k^{-p} + \\Delta_b(k)\\right),$$\n     where $s_k = (-1)^k$, and\n     $$\\Delta_a(k) = \\begin{cases} \\delta, & k \\ge k_0 \\\\ 0, & k < k_0 \\end{cases}, \\quad \\Delta_b(k) = \\begin{cases} \\tfrac{\\delta}{2}, & k \\ge k_0 \\\\ 0, & k < k_0 \\end{cases}.$$\n     The pair $(\\Delta_a(k), \\Delta_b(k))$ introduces a high-frequency plateau of level $\\delta \\ge 0$ starting at index $k_0$ (if $k_0$ is specified), otherwise disabled when $\\delta = 0$ or $k_0$ is not provided.\n   - Construct the synthetic periodic samples\n     $$s_j = \\sum_{k=1}^{K} \\left( a_k \\cos(k x_j) + b_k \\sin(k x_j) \\right), \\quad j = 0, 1, \\dots, N-1.$$\n2. Trigonometric interpolation via discrete Fourier transform:\n   - Compute the discrete Fourier transform coefficients $c_k$ of the sample sequence $\\{s_j\\}$ for $k = 0, 1, \\dots, N-1$ using standard complex-exponential orthogonality on the equispaced grid.\n   - Define the harmonic amplitude envelope for $k = 1, 2, \\dots, m$ where $m = \\lfloor N/2 \\rfloor$ by\n     $$A_k = \\begin{cases} 2|c_k|, & 1 \\le k < m \\\\ |c_m|, & k = m \\text{ and } N \\text{ even} \\end{cases}.$$\n     This convention avoids double-counting the Nyquist frequency when $N$ is even and captures the amplitude of each sine-cosine harmonic pair.\n3. Smoothness validation via coefficient decay:\n   - Estimate the decay rate $p_{\\mathrm{est}}$ by performing least-squares linear regression of $\\log(A_k)$ versus $\\log(k)$ over the indices where $A_k$ is numerically significant (exclude values with $A_k \\le 10^{-12}$) and excluding the Nyquist index when $N$ is even. Specifically, fit\n     $$\\log(A_k) \\approx \\alpha - p_{\\mathrm{est}} \\log(k).$$\n4. Spectral filtering and error quantification:\n   - For a given cutoff $M_{\\mathrm{cut}}$ with $1 \\le M_{\\mathrm{cut}} \\le m$, construct a filtered reconstruction by zeroing all discrete Fourier coefficients $\\{c_k\\}$ with $k > M_{\\mathrm{cut}}$ and $k < N - M_{\\mathrm{cut}}$, and then applying the inverse discrete Fourier transform to obtain filtered samples $\\{\\hat{s}_j\\}$.\n   - Compute the maximum absolute interpolation error\n     $$E_{\\max} = \\max_{0 \\le j < N} | \\hat{s}_j - s_j |.$$\n   - Compute the tail energy ratio beyond the cutoff\n     $$R_{\\mathrm{tail}} = \\frac{ \\sum_{k = M_{\\mathrm{cut}}+1}^{m} A_k^2 }{ \\sum_{k = 1}^{m} A_k^2 }.$$\n5. Validation logic:\n   - The pass/fail criterion combines decay estimation and tail energy behavior:\n     - If the test case specifies no plateau (i.e., expects a decaying spectrum), then declare pass if $|p_{\\mathrm{est}} - p| \\le \\tau_p$ and $R_{\\mathrm{tail}} < \\rho$.\n     - If the test case specifies a plateau (i.e., expects non-decaying high-frequency content), then declare pass if $R_{\\mathrm{tail}} \\ge \\rho$. In this plateau case, no condition is imposed on $p_{\\mathrm{est}}$.\n\nTesting:\nProvide the following test suite, each test case defined by a tuple $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau})$:\n- Case $1$ (happy path, smooth decay): $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau}) = (128, 30, 2.5, 20, \\text{none}, 0.0, 0.1, 0.05, \\text{False})$.\n- Case $2$ (boundary with smaller $N$): $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau}) = (32, 10, 1.0, 8, \\text{none}, 0.0, 0.2, 0.05, \\text{False})$.\n- Case $3$ (edge case with high-frequency plateau): $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau}) = (256, 60, 2.0, 30, 40, 0.1, 0.2, 0.1, \\text{True})$.\n\nFinal output specification:\n- For each test case, produce a sublist $[p_{\\mathrm{est}}, E_{\\max}, R_{\\mathrm{tail}}, \\text{pass}]$ where $p_{\\mathrm{est}}$, $E_{\\max}$, and $R_{\\mathrm{tail}}$ are floats rounded to six decimal places, and $\\text{pass}$ is either $\\text{True}$ or $\\text{False}$.\n- Your program should produce a single line of output containing the results as a comma-separated list of these sublists, enclosed in square brackets, with no spaces. For example, an output for three test cases must look like $[[p_1,E_1,R_1,\\text{True}],[p_2,E_2,R_2,\\text{False}],[p_3,E_3,R_3,\\text{True}]]$ with all floats shown to six decimal places.",
            "solution": "The user-provided problem is evaluated as **valid** because it is scientifically grounded in the principles of Fourier analysis and numerical methods, is well-posed, and provides a complete, consistent, and formalizable set of instructions. The problem asks for the implementation of a numerical procedure involving trigonometric interpolation, spectral analysis, and filtering, which is a standard topic in scientific computing. All provided definitions, formulas, and test cases are consistent and allow for the development of a unique, verifiable solution.\n\nThe solution proceeds by implementing the specified steps for each test case.\n\n**1. Synthetic Dataset Generation**\nFor each test case, we are given parameters $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau})$. We first construct the signal $s_j$ on an equispaced grid of $N$ points $x_j = \\frac{2\\pi j}{N}$ for $j=0, \\dots, N-1$. The signal is a sum of $K$ harmonics:\n$$s_j = \\sum_{k=1}^{K} \\left( a_k \\cos(k x_j) + b_k \\sin(k x_j) \\right)$$\nThe coefficients $a_k$ and $b_k$ are defined to model a power-law spectral decay with a potential high-frequency plateau:\n$$a_k = k^{-p} + \\Delta_a(k), \\quad b_k = (-1)^k\\left(\\tfrac{1}{2}k^{-p} + \\Delta_b(k)\\right)$$\nThe plateau terms $\\Delta_a(k)$ and $\\Delta_b(k)$ are non-zero only if a start index $k_0$ is provided and $\\delta > 0$. Specifically, $\\Delta_a(k) = \\delta$ and $\\Delta_b(k) = \\frac{\\delta}{2}$ for $k \\ge k_0$, and are zero otherwise. This construction can be efficiently implemented using vectorized NumPy operations.\n\n**2. Discrete Fourier Transform and Harmonic Amplitudes**\nThe trigonometric interpolation polynomial is implicitly found by computing the Discrete Fourier Transform (DFT) of the samples $\\{s_j\\}$. The DFT coefficients, which we denote $C_k^{\\text{unnorm}} = \\sum_{j=0}^{N-1} s_j e^{-i k x_j}$, are computed using `numpy.fft.fft`. For theoretical consistency, these are normalized to obtain $c_k = \\frac{1}{N} C_k^{\\text{unnorm}}$.\nFor a real-valued signal, the amplitude of the $k$-th harmonic is related to the magnitude of $c_k$. The harmonic amplitude envelope $A_k$ is defined for the positive frequencies $k=1, \\dots, m$, where $m = \\lfloor N/2 \\rfloor$. As all test cases use an even $N$, $m=N/2$. The definition is:\n$$A_k = \\begin{cases} 2|c_k|, & 1 \\le k < m \\\\ |c_m|, & k = m \\end{cases}$$\nThe factor of $2$ accounts for the energy from both positive ($k$) and negative ($-k \\equiv N-k$) frequency components, which are complex conjugates. The Nyquist frequency component ($k=m$) has no conjugate counterpart in the unique frequency range and is treated separately. Since the input signal has no DC component ($s(x)$ integrates to zero over a period), $c_0=0$.\nA key theoretical insight is that for a signal constructed as above with $K < N/2$, there is no aliasing, and the computed-from-samples amplitude $A_k$ should be directly related to the generating coefficients: $A_k \\approx \\sqrt{a_k^2 + b_k^2}$ for $k \\le K$, and $A_k \\approx 0$ for $k > K$.\n\n**3. Smoothness Validation via Decay Rate Estimation**\nThe smoothness of the underlying continuous function is related to how fast its Fourier coefficients decay. We estimate the decay exponent $p$ by fitting a linear model to the logarithm of the amplitudes:\n$$\\log(A_k) \\approx \\alpha - p_{\\mathrm{est}} \\log(k)$$\nThis is a linear regression of $y = \\log(A_k)$ on $x = \\log(k)$. The estimated decay rate, $p_{\\mathrm{est}}$, is the negative of the slope of this line. The fit is performed using a least-squares method (`numpy.polyfit`) over the frequency range $k=1, \\dots, m-1$. The Nyquist frequency is excluded, a standard practice as it behaves differently. To avoid numerical issues with $\\log(0)$, only amplitudes $A_k > 10^{-12}$ are included in the regression.\n\n**4. Spectral Filtering and Error Analysis**\nTo simulate the effect of a low-pass filter, we truncate the spectrum. A filtered signal $\\{\\hat{s}_j\\}$ is reconstructed by first zeroing out the DFT coefficients $C_k^{\\text{unnorm}}$ for all frequencies with indices $k$ such that $M_{\\mathrm{cut}} < k < N - M_{\\mathrm{cut}}$. Then, the Inverse DFT (`numpy.fft.ifft`) is applied to this modified spectrum. The resulting $\\hat{s}_j$ is the best approximation of $s_j$ using only the first $M_{\\mathrm{cut}}$ harmonics.\nThe filtering error is quantified by the maximum absolute error $E_{\\max} = \\max_{j} | \\hat{s}_j - s_j |$.\nThe energy lost due to filtering is quantified by the tail energy ratio, $R_{\\mathrm{tail}}$. By Parseval's theorem, energy in the signal domain is proportional to the sum of squared amplitudes in the frequency domain. Thus, the ratio is:\n$$R_{\\mathrm{tail}} = \\frac{ \\sum_{k = M_{\\mathrm{cut}}+1}^{m} A_k^2 }{ \\sum_{k = 1}^{m} A_k^2 }$$\nThis measures the fraction of spectral energy contained in frequencies above the cutoff $M_{\\mathrm{cut}}$.\n\n**5. Validation Logic**\nThe final step is to apply the pass/fail criteria based on the problem specification:\n- If a smooth decay is expected (`expect_plateau` is False), the test passes if the estimated decay rate $p_{\\mathrm{est}}$ is close to the true rate $p$ (i.e., $|p_{\\mathrm{est}} - p| \\le \\tau_p$) AND the tail energy $R_{\\mathrm{tail}}$ is small (i.e., $R_{\\mathrm{tail}} < \\rho$).\n- If a high-frequency plateau is expected (`expect_plateau` is True), the test passes if the tail energy $R_{\\mathrm{tail}}$ is significant (i.e., $R_{\\mathrm{tail}} \\ge \\rho$), indicating that the high-frequency components are not negligible.\n\nThe computed values $p_{\\mathrm{est}}$, $E_{\\max}$, and $R_{\\mathrm{tail}}$ are rounded to six decimal places, and the boolean pass/fail result is determined for each case. These results are then formatted into the specified string output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main entry point for solving the problem. It defines the test cases,\n    processes each one, and prints the formatted results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, K, p, M_cut, k0, delta, tau_p, rho, expect_plateau)\n        (128, 30, 2.5, 20, None, 0.0, 0.1, 0.05, False),\n        (32, 10, 1.0, 8, None, 0.0, 0.2, 0.05, False),\n        (256, 60, 2.0, 30, 40, 0.1, 0.2, 0.1, True),\n    ]\n\n    # This list will store the sublist strings for final concatenation.\n    results_as_strings = []\n    \n    for case in test_cases:\n        N, K, p, M_cut, k0, delta, tau_p, rho, expect_plateau = case\n        \n        # 1. Synthetic dataset generation\n        x_j = (2 * np.pi / N) * np.arange(N)\n        k_vals = np.arange(1, K + 1)\n        \n        p_decay = k_vals**(-p)\n        \n        delta_a = np.zeros(K)\n        delta_b = np.zeros(K)\n        if k0 is not None and delta > 0:\n            indices_to_modify = k_vals >= k0\n            delta_a[indices_to_modify] = delta\n            delta_b[indices_to_modify] = delta / 2.0\n            \n        a_k = p_decay + delta_a\n        s_k_sign = (-1)**k_vals\n        b_k = s_k_sign * (0.5 * p_decay + delta_b)\n        \n        outer_prod = np.outer(x_j, k_vals)\n        s_j = np.cos(outer_prod) @ a_k + np.sin(outer_prod) @ b_k\n\n        # 2. Trigonometric interpolation via DFT\n        C_k_unnormalized = np.fft.fft(s_j)\n        c_k = C_k_unnormalized / N\n        \n        m = N // 2\n        \n        # Harmonic amplitude envelope A_k for k=1..m (0-indexed array)\n        A_k = np.zeros(m)\n        if m > 1: # Handles N=2 case\n            A_k[:m-1] = 2 * np.abs(c_k[1:m])\n        A_k[m-1] = np.abs(c_k[m]) # Nyquist frequency (all test cases have even N)\n\n        # 3. Smoothness validation via coefficient decay\n        k_for_fit = np.arange(1, m)\n        A_for_fit = A_k[:m-1]\n        \n        significant_mask = A_for_fit > 1e-12\n        k_reg = k_for_fit[significant_mask]\n        \n        p_est = 0.0\n        if len(k_reg) >= 2:\n            A_reg = A_for_fit[significant_mask]\n            log_k = np.log(k_reg)\n            log_A = np.log(A_reg)\n            slope, _ = np.polyfit(log_k, log_A, 1)\n            p_est = -slope\n\n        # 4. Spectral filtering and error quantification\n        C_filtered = C_k_unnormalized.copy()\n        C_filtered[M_cut + 1 : N - M_cut] = 0.0\n        \n        s_hat_j = np.real(np.fft.ifft(C_filtered))\n        E_max = np.max(np.abs(s_hat_j - s_j))\n\n        # 5. Tail energy ratio\n        numerator = np.sum(A_k[M_cut:]**2)\n        denominator = np.sum(A_k**2)\n        R_tail = numerator / denominator if denominator > 1e-15 else 0.0\n\n        # 6. Validation logic\n        if expect_plateau:\n            is_pass = R_tail >= rho\n        else:\n            is_pass = (np.abs(p_est - p) <= tau_p) and (R_tail < rho)\n        \n        # Format the sublist as a string according to requirements\n        sublist_str = f\"[{p_est:.6f},{E_max:.6f},{R_tail:.6f},{is_pass}]\"\n        results_as_strings.append(sublist_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In modern numerical methods like the Discontinuous Galerkin (DG) method, the domain is often partitioned into multiple elements, each with its own local approximation space. This exercise challenges you to apply the fundamental principles of trigonometric interpolation and aliasing to such a multi-element setting. By deriving the maximum resolvable global wavenumber on a non-uniform mesh, you will gain critical insight into how local approximation choices constrain the global accuracy of the method, a key consideration in designing robust spectral element schemes. ",
            "id": "3387856",
            "problem": "Consider a periodic domain of length $L=2\\pi$ partitioned into $E=3$ elements with lengths $h_{1}=\\frac{\\pi}{3}$, $h_{2}=\\frac{\\pi}{2}$, and $h_{3}=\\frac{7\\pi}{6}$, so that $h_{1}+h_{2}+h_{3}=2\\pi$. On each element $e\\in\\{1,2,3\\}$, define the local angular coordinate $\\theta_{e}=2\\pi\\,(x-x_{e-1})/h_{e}\\in[0,2\\pi)$ where $x_{e-1}$ is the left endpoint of the $e$-th element. The local approximation space is the span of complex exponentials $\\{\\exp(\\mathrm{i}j\\theta_{e})\\}_{j=-N_{e}}^{N_{e}}$, i.e., trigonometric polynomials of degree $N_{e}$, with interpolation at $2N_{e}+1$ equispaced nodes in $\\theta_{e}$. Angles are in radians. Assume the piecewise approximation is assembled with the Discontinuous Galerkin (DG) method, so values are not enforced to be continuous across interfaces.\n\nA global Fourier mode is given by $u_{k}(x)=\\exp(\\mathrm{i}k x)$ with integer wavenumber $k\\geq 0$. Starting from the definitions of trigonometric polynomial interpolation on each element and the sampling theorem for uniform grids, derive the necessary and sufficient condition under which the global mode $u_{k}$ is represented without aliasing on every element. Use this to establish the expression for the maximum resolvable global wavenumber $k_{\\star}$ in terms of the local degrees $N_{e}$ and element lengths $h_{e}$ that ensures no aliasing and, consequently, no interface inconsistency in the element-wise representations.\n\nFinally, specialize your expression to the given mesh and degrees $N_{1}=5$, $N_{2}=3$, and $N_{3}=8$, and compute the largest integer $k_{\\star}$ that satisfies the no-aliasing condition. Provide the single value of $k_{\\star}$ as your final answer. No rounding is required. Angles are in radians.",
            "solution": "The problem requires the derivation of a condition to ensure that a global Fourier mode, $u_{k}(x) = \\exp(\\mathrm{i}k x)$, is represented without aliasing on every element of a non-uniform mesh under a Discontinuous Galerkin (DG) framework. This condition will lead to the maximum resolvable global wavenumber, $k_{\\star}$.\n\nFirst, we must express the global function $u_{k}(x)$ in terms of the local coordinate $\\theta_{e}$ for each element $e$. The problem defines the local angular coordinate on element $e$ as $\\theta_{e} = 2\\pi(x - x_{e-1})/h_{e}$, where $x_{e-1}$ is the left endpoint of the element and $h_e$ is its length. The domain of the local coordinate is $\\theta_{e} \\in [0, 2\\pi)$. We can invert this relationship to express the global coordinate $x$ in terms of the local coordinate $\\theta_{e}$:\n$$\nx = x_{e-1} + \\frac{h_{e}}{2\\pi} \\theta_{e}\n$$\nSubstituting this into the expression for the global Fourier mode $u_{k}(x)$, we obtain its representation in the local coordinate system of element $e$:\n$$\nu_{k}(x(\\theta_e)) = \\exp\\left(\\mathrm{i}k \\left(x_{e-1} + \\frac{h_{e}}{2\\pi} \\theta_{e}\\right)\\right) = \\exp(\\mathrm{i}k x_{e-1}) \\exp\\left(\\mathrm{i} \\frac{kh_{e}}{2\\pi} \\theta_{e}\\right)\n$$\nThe term $\\exp(\\mathrm{i}k x_{e-1})$ is a constant phase factor on element $e$. The functional dependence on the local coordinate is entirely contained in the term $\\exp(\\mathrm{i} J_{e} \\theta_{e})$, where we define the dimensionless local wavenumber on element $e$ as:\n$$\nJ_{e} = \\frac{kh_{e}}{2\\pi}\n$$\nThe local approximation space on element $e$ is the space of trigonometric polynomials of degree $N_{e}$, which is the span of the basis functions $\\{\\exp(\\mathrm{i}j\\theta_{e})\\}_{j=-N_{e}}^{N_{e}}$. This space can uniquely represent any trigonometric polynomial whose frequencies $j$ are within the range $[-N_{e}, N_{e}]$.\n\nThe problem states that the approximation is constructed via interpolation at $2N_{e}+1$ equispaced nodes in $\\theta_{e}$. According to the sampling theorem for trigonometric polynomials, if we sample a function $f(\\theta_e) = \\exp(\\mathrm{i}J_{e}\\theta_{e})$ at $2N_{e}+1$ equispaced points, the resulting trigonometric interpolant will be an aliased version of the original function. The interpolant will exactly match the original function if and only if the frequency $J_e$ lies within the range of uniquely representable frequencies of the polynomial space. For half-open intervals like $[0, 2\\pi)$ and a basis indexed from $-N_e$ to $N_e$, the condition to avoid aliasing is:\n$$\n-N_{e} \\leq J_{e} \\leq N_{e}\n$$\nOr, more compactly, $|J_{e}| \\leq N_{e}$. Since the global wavenumber $k$ is given as a non-negative integer ($k \\geq 0$) and element lengths $h_{e}$ are positive, the local wavenumber $J_{e} = kh_{e}/(2\\pi)$ is also non-negative. The no-aliasing condition simplifies to:\n$$\nJ_{e} \\leq N_{e}\n$$\nSubstituting the definition of $J_{e}$, we obtain the condition on the global wavenumber $k$ for no aliasing on element $e$:\n$$\n\\frac{kh_{e}}{2\\pi} \\leq N_{e}\n$$\nRearranging for $k$, we get:\n$$\nk \\leq \\frac{2\\pi N_{e}}{h_{e}}\n$$\nThis inequality provides the maximum resolvable global wavenumber on a single element $e$. For the global mode $u_{k}(x)$ to be represented without aliasing on *every* element in the mesh, this condition must hold simultaneously for all $e \\in \\{1, 2, ..., E\\}$. Therefore, $k$ must be less than or equal to the minimum of these upper bounds over all elements:\n$$\nk \\leq \\min_{e \\in \\{1, \\dots, E\\}} \\left( \\frac{2\\pi N_{e}}{h_{e}} \\right)\n$$\nThe maximum resolvable global wavenumber, $k_{\\star}$, is the largest integer $k$ that satisfies this condition. This is given by the floor of the minimum value:\n$$\nk_{\\star} = \\left\\lfloor \\min_{e \\in \\{1, \\dots, E\\}} \\left( \\frac{2\\pi N_{e}}{h_{e}} \\right) \\right\\rfloor\n$$\nThis is the general expression for $k_{\\star}$. Now, we specialize this result to the given mesh with $E=3$ elements and the specified parameters. The data are:\n- Element 1: $h_{1} = \\frac{\\pi}{3}$, $N_{1} = 5$\n- Element 2: $h_{2} = \\frac{\\pi}{2}$, $N_{2} = 3$\n- Element 3: $h_{3} = \\frac{7\\pi}{6}$, $N_{3} = 8$\n\nWe compute the maximum resolvable wavenumber for each element:\nFor element 1:\n$$\n\\frac{2\\pi N_{1}}{h_{1}} = \\frac{2\\pi (5)}{\\frac{\\pi}{3}} = \\frac{10\\pi}{\\frac{\\pi}{3}} = 10 \\times 3 = 30\n$$\nFor element 2:\n$$\n\\frac{2\\pi N_{2}}{h_{2}} = \\frac{2\\pi (3)}{\\frac{\\pi}{2}} = \\frac{6\\pi}{\\frac{\\pi}{2}} = 6 \\times 2 = 12\n$$\nFor element 3:\n$$\n\\frac{2\\pi N_{3}}{h_{3}} = \\frac{2\\pi (8)}{\\frac{7\\pi}{6}} = \\frac{16\\pi}{\\frac{7\\pi}{6}} = 16 \\times \\frac{6}{7} = \\frac{96}{7}\n$$\nNow we find the minimum of these three values:\n$$\n\\min\\left(30, 12, \\frac{96}{7}\\right)\n$$\nTo compare the values, we note that $\\frac{96}{7} \\approx 13.714$. The minimum is therefore $12$.\n$$\n\\min\\left(30, 12, \\frac{96}{7}\\right) = 12\n$$\nThe maximum integer wavenumber $k_{\\star}$ that can be represented without aliasing on all three elements is the floor of this minimum value:\n$$\nk_{\\star} = \\lfloor 12 \\rfloor = 12\n$$\nThus, the largest integer global wavenumber that satisfies the no-aliasing condition on every element is $12$.",
            "answer": "$$\n\\boxed{12}\n$$"
        },
        {
            "introduction": "While powerful, truncated Fourier series famously produce spurious Gibbs oscillations near discontinuities, a significant challenge in practical applications. This problem delves into advanced post-processing techniques, such as Fejér and Cesàro summation, which are designed to mitigate these artifacts by filtering the spectral coefficients. By analyzing the properties of these filtering operators, you will explore how to control oscillations and reduce total variation without unduly sacrificing the energy content of the solution, a crucial trade-off in the post-processing of numerical data. ",
            "id": "3387894",
            "problem": "Consider a one-dimensional periodic domain identified with the torus $\\mathbb{T} = \\mathbb{R}/(2\\pi\\mathbb{Z})$, and let $u \\in L^{2}(\\mathbb{T})$ be a function of bounded variation with Fourier series coefficients $\\{\\widehat{u}_{k}\\}_{k \\in \\mathbb{Z}}$. Denote by $S_{N}u$ the $N$-th trigonometric partial sum of $u$, namely $S_{N}u(x) = \\sum_{|k|\\le N} \\widehat{u}_{k} e^{ikx}$. For post-processing of discontinuous Galerkin (DG) solution fields on periodic meshes, one often replaces $S_{N}u$ by Cesàro averages of its partial sums to mitigate Gibbs oscillations. For a positive integer $m$, define the Cesàro $(C,m)$ mean $\\sigma_{N}^{(m)} u$ as the $m$-fold arithmetic averaging of the sequence $\\{S_{n}u\\}_{n=0}^{N}$; equivalently, $\\sigma_{N}^{(m)} u = K_{N}^{(m)} * u$ is the convolution on $\\mathbb{T}$ with a $2\\pi$-periodic kernel $K_{N}^{(m)}$ that depends on $N$ and $m$ and integrates to $1$. The case $m=1$ is the Fejér mean with kernel $K_{N}^{(1)}$ (the Fejér kernel). Another commonly used average is the de la Vallée Poussin mean $V_{N}u$, which is a linear combination of Fejér means at two different cutoffs.\n\nLet $\\|\\cdot\\|_{2}$ denote the $L^{2}(\\mathbb{T})$ norm, and for a function $v$ of bounded variation let $\\mathrm{TV}(v)$ denote its total variation on $\\mathbb{T}$. For a linear energy-conserving DG discretization of a skew-adjoint linear partial differential equation (for example, periodic constant-coefficient advection), the semidiscrete $L^{2}$ energy of the DG state is nonincreasing in time (constant for exact time integration). In practice, one may apply post-processing either purely for diagnostics (not fed back into the evolution) or as a filtering step at each time step (fed back into the state).\n\nUsing only core definitions of Fourier series on $\\mathbb{T}$, convolution, total variation, and the $L^{2}$ inner product, determine which of the following statements are true. Your reasoning should rely on properties of positive kernels, Young’s inequality for convolutions, and the orthogonality underlying Parseval’s identity, not on any special-case shortcut formulas.\n\nA. For every integer $m \\ge 1$ and every $N \\in \\mathbb{N}$, the Cesàro $(C,m)$ mean $\\sigma_{N}^{(m)}$ is convolution with a nonnegative kernel $K_{N}^{(m)}$ of unit mass. Consequently, for every $u \\in BV(\\mathbb{T}) \\cap L^{2}(\\mathbb{T})$ one has $\\mathrm{TV}(\\sigma_{N}^{(m)}u) \\le \\mathrm{TV}(u)$ and $\\|\\sigma_{N}^{(m)}u\\|_{2} \\le \\|u\\|_{2}$. Moreover, among these means the Fejér mean $(m=1)$ induces the least attenuation at each nonzero Fourier mode (i.e., it is the minimal smoother in this family in the sense of spectral multipliers).\n\nB. The Fejér mean $\\sigma_{N}^{(1)}$ preserves the $L^{2}$ norm for every $u \\in L^{2}(\\mathbb{T})$ because its kernel integrates to $1$, so using it in DG post-processing cannot change the energy of the reconstructed field.\n\nC. The de la Vallée Poussin mean $V_{N}u$ is an average of two Fejér means and therefore cannot increase total variation; in particular, for all $u \\in BV(\\mathbb{T})$ one has $\\mathrm{TV}(V_{N}u) \\le \\mathrm{TV}(u)$.\n\nD. For a linear DG semidiscretization that is energy-conserving in $L^{2}$ on $\\mathbb{T}$, applying a linear post-processing operator $P$ that is nonexpansive in $L^{2}$ (i.e., $\\|Pu\\|_{2} \\le \\|u\\|_{2}$ for all $u$) only to diagnostic output does not alter the scheme’s energy balance. However, if the same $P$ is applied at each time step to the evolved state, then exact energy conservation is generally lost unless $P$ is an $L^{2}$-orthogonal projector that leaves the energy inner product invariant on the range of the evolution.\n\nE. Among all Cesàro means, only the Fejér mean $(m=1)$ has a nonnegative kernel; higher-order Cesàro $(C,m)$ kernels change sign, so $\\sigma_{N}^{(m)}$ cannot be total variation diminishing for $m \\ge 2$.\n\nSelect all correct options.",
            "solution": "The user wants me to validate the problem statement and, if valid, solve the problem by analyzing each option.\n\n### Problem Validation\n\nI will first validate the problem statement.\n\n**Step 1: Extract Givens**\n- Domain: $\\mathbb{T} = \\mathbb{R}/(2\\pi\\mathbb{Z})$.\n- Function space: $u \\in L^{2}(\\mathbb{T}) \\cap BV(\\mathbb{T})$, where $BV(\\mathbb{T})$ is the space of functions of bounded variation.\n- Fourier series coefficients: $\\{\\widehat{u}_{k}\\}_{k \\in \\mathbb{Z}}$.\n- Partial sum: $S_{N}u(x) = \\sum_{|k|\\le N} \\widehat{u}_{k} e^{ikx}$.\n- Cesàro $(C,m)$ mean: $\\sigma_{N}^{(m)} u$ is the $m$-fold arithmetic average of $\\{S_{n}u\\}_{n=0}^{N}$. It can be written as a convolution $\\sigma_{N}^{(m)} u = K_{N}^{(m)} * u$.\n- Kernel properties: $K_{N}^{(m)}$ is $2\\pi$-periodic and \"integrates to 1\". This is interpreted as its mean value over the period being $1$, i.e., $\\frac{1}{2\\pi}\\int_{\\mathbb{T}} K_{N}^{(m)}(x) dx = 1$, which is equivalent to its $0$-th Fourier coefficient $\\widehat{K_{N}^{(m)}}_0$ being $1$.\n- Fejér mean: $\\sigma_{N}^{(1)}u$ corresponds to $m=1$.\n- De la Vallée Poussin mean: $V_{N}u$ is a linear combination of Fejér means.\n- Norms: $\\|\\cdot\\|_{2}$ is the $L^{2}(\\mathbb{T})$ norm. $\\mathrm{TV}(v)$ is the total variation of $v$.\n- Context: Post-processing for Discontinuous Galerkin (DG) methods for linear skew-adjoint PDEs, which are energy-conserving in $L^2$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the classical theory of Fourier analysis (Cesàro summation, properties of kernels) and its modern application in numerical analysis (filtering, DG methods). All concepts are standard and well-defined.\n- **Well-Posed:** The problem asks for the evaluation of several distinct mathematical propositions. Each proposition is well-defined and can be rigorously proven or disproven based on the provided definitions and standard mathematical principles.\n- **Objective:** The language is formal and objective. There are no subjective or ambiguous statements that would prevent a rigorous analysis.\n- **Consistency and Completeness:** The definitions provided, such as the Cesàro mean being an $m$-fold average, are standard. The statement that the kernel \"integrates to $1$\" is a common convention meaning its mean value is $1$ ($\\widehat{K_N^{(m)}}(0) = 1$), which ensures that the mean value of the function is preserved under convolution ($\\widehat{\\sigma_N^{(m)}u}(0) = \\widehat{K_N^{(m)}}(0) \\widehat{u}(0) = \\widehat{u}(0)$). The problem statement is self-consistent and contains sufficient information. No flaws from the checklist are present.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. I will proceed to the solution.\n\n### Solution and Option Analysis\n\nLet us define the convolution and $L^2$ norm on $\\mathbb{T} = [0, 2\\pi)$ as follows:\n- $L^2$ inner product: $\\langle f, g \\rangle = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(x) \\overline{g(x)} dx$.\n- $L^2$ norm: $\\|f\\|_2 = \\sqrt{\\langle f, f \\rangle}$.\n- Fourier coefficient: $\\widehat{f}_k = \\langle f, e^{ikx} \\rangle$.\n- Convolution: $(f*g)(x) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(x-y) g(y) dy$.\nWith these definitions, we have Parseval's identity $\\|f\\|_2^2 = \\sum_{k \\in \\mathbb{Z}} |\\widehat{f}_k|^2$ and the convolution theorem $\\widehat{f*g}_k = \\widehat{f}_k \\widehat{g}_k$.\n\nThe operator $\\sigma_{N}^{(m)}$ acts as a Fourier multiplier operator. If $u(x) = \\sum_k \\widehat{u}_k e^{ikx}$, then $\\sigma_{N}^{(m)}u(x) = \\sum_k \\lambda_k^{(N,m)} \\widehat{u}_k e^{ikx}$, where $\\lambda_k^{(N,m)} = \\widehat{K_N^{(m)}}_k$. The multipliers $\\lambda_k^{(N,m)}$ are the $(C,m)$ means of the sequence $\\{1, 1, \\dots, 1, 0, \\dots\\}$, where the $1$s correspond to modes $j$ with $|j| \\le n$ for the partial sum $S_n$. Specifically, for $m=1$, $\\lambda_k^{(N,1)} = \\max(0, 1-\\frac{|k|}{N+1})$. For $m > 1$, the multipliers are given by the recursive average $\\lambda_k^{(N,m)} = \\frac{1}{N+1}\\sum_{n=0}^N \\lambda_k^{(n,m-1)}$.\n\n**Analysis of Option A**\n\nThis option makes three claims.\n\n1.  **Nonnegativity and unit mass of $K_N^{(m)}$**: The $(C,1)$ kernel $K_N^{(1)}$ is the Fejér kernel, which is known to be nonnegative. Based on the definition of $(C,m)$ means, the kernel for $m>1$ is constructed recursively: $K_N^{(m)} = \\frac{1}{N+1} \\sum_{n=0}^N K_n^{(m-1)}$. Since $K_n^{(1)}$ is nonnegative for all $n$, it follows by induction that $K_N^{(m)}$ is nonnegative for all $m \\ge 1$ and $N \\in \\mathbb{N}$, as it is a sum of nonnegative functions. The \"unit mass\" property, $\\frac{1}{2\\pi}\\int_{\\mathbb{T}} K_N^{(m)}(x) dx = 1$, is equivalent to $\\widehat{K_N^{(m)}}(0) = 1$, or $\\lambda_0^{(N,m)}=1$. This is true because the constant term $\\widehat{u}_0$ of $u$ is preserved by any averaging of partial sums.\n\n2.  **Consequences for TV and $L^2$ norm**:\n    - For total variation: Let $v = \\sigma_N^{(m)}u = K_N^{(m)}*u$. For any partition $0=x_0 < x_1 < \\dots < x_p=2\\pi$,\n      $|v(x_i) - v(x_{i-1})| = |\\frac{1}{2\\pi} \\int_{\\mathbb{T}} [u(x_i-y) - u(x_{i-1}-y)] K_N^{(m)}(y) dy|$.\n      Using the triangle inequality and the nonnegativity of $K_N^{(m)}$, we get\n      $|v(x_i) - v(x_{i-1})| \\le \\frac{1}{2\\pi} \\int_{\\mathbb{T}} |u(x_i-y) - u(x_{i-1}-y)| K_N^{(m)}(y) dy$.\n      Summing over $i$ gives $\\sum_i |v(x_i)-v(x_{i-1})| \\le \\frac{1}{2\\pi}\\int_{\\mathbb{T}} \\left(\\sum_i|u(x_i-y)-u(x_{i-1}-y)|\\right) K_N^{(m)}(y) dy$.\n      The inner sum is the variation of a translated version of $u$, which does not exceed $\\mathrm{TV}(u)$. Thus,\n      $\\sum_i |v(x_i)-v(x_{i-1})| \\le \\frac{1}{2\\pi}\\int_{\\mathbb{T}} \\mathrm{TV}(u) K_N^{(m)}(y) dy = \\mathrm{TV}(u) \\cdot 1$.\n      Taking the supremum over all partitions, we find $\\mathrm{TV}(\\sigma_N^{(m)}u) \\le \\mathrm{TV}(u)$. This property is known as being Total Variation Diminishing (TVD).\n    - For the $L^2$ norm: Using Parseval's identity, $\\|\\sigma_N^{(m)}u\\|_2^2 = \\sum_k |\\lambda_k^{(N,m)} \\widehat{u}_k|^2 = \\sum_k |\\lambda_k^{(N,m)}|^2 |\\widehat{u}_k|^2$.\n      The multipliers $\\lambda_k^{(N,m)}$ are real and result from convex combinations of the sequence $\\{1, \\dots, 1, 0, \\dots\\}$. Thus, $0 \\le \\lambda_k^{(N,m)} \\le 1$ for all $k, N, m$. It follows that $|\\lambda_k^{(N,m)}|^2 \\le 1$.\n      Therefore, $\\|\\sigma_N^{(m)}u\\|_2^2 \\le \\sum_k |\\widehat{u}_k|^2 = \\|u\\|_2^2$, which implies $\\|\\sigma_N^{(m)}u\\|_2 \\le \\|u\\|_2$. This can also be shown with Young's inequality for convolution: $\\|\\sigma_N^{(m)}u\\|_2 = \\|K_N^{(m)} * u\\|_2 \\le \\|K_N^{(m)}\\|_1 \\|u\\|_2$. Because $K_N^{(m)} \\ge 0$ and has mean value $1$, $\\|K_N^{(m)}\\|_1 = \\frac{1}{2\\pi}\\int |K_N^{(m)}| dx = \\frac{1}{2\\pi}\\int K_N^{(m)} dx = 1$. So $\\|\\sigma_N^{(m)}u\\|_2 \\le \\|u\\|_2$.\n\n3.  **Minimal smoothing for $m=1$**: This requires comparing the multipliers $\\lambda_k^{(N,m)}$ for different $m$. A smoother filter corresponds to smaller multipliers. We need to show that for a fixed $k \\ne 0$, $\\lambda_k^{(N,1)} \\ge \\lambda_k^{(N,m)}$ for $m > 1$.\n    The sequence $a_n = \\lambda_k^{(n, m-1)}$ is non-decreasing in $n$ (for $n \\ge |k|$). The mean of a non-decreasing sequence up to term $N$ is less than or equal to the last term, i.e., $\\lambda_k^{(N,m)} = \\frac{1}{N+1}\\sum_{n=0}^N \\lambda_k^{(n, m-1)} \\le \\lambda_k^{(N, m-1)}$. By induction, $\\lambda_k^{(N,m)} \\le \\lambda_k^{(N,1)}$ for all $m \\ge 1$. Since for $k \\ne 0$, the multipliers are less than $1$, the Fejér mean $(m=1)$ provides the least attenuation.\n\nAll three parts of the statement are correct.\n**Verdict: Correct.**\n\n**Analysis of Option B**\n\nThis statement claims that $\\|\\sigma_N^{(1)}u\\|_2 = \\|u\\|_2$ because the kernel has unit mass. From the analysis of option A, we have $\\|\\sigma_N^{(1)}u\\|_2^2 = \\sum_k |\\lambda_k^{(N,1)}|^2 |\\widehat{u}_k|^2$.\nThe Fejér multipliers are $\\lambda_k^{(N,1)} = 1 - \\frac{|k|}{N+1}$ for $|k| \\le N$ (and $0$ otherwise). For any $k$ such that $0 < |k| \\le N$, we have $0 < \\lambda_k^{(N,1)} < 1$, so $|\\lambda_k^{(N,1)}|^2 < 1$.\nEquality, $\\|\\sigma_N^{(1)}u\\|_2^2 = \\|u\\|_2^2$, would require $|\\lambda_k^{(N,1)}|^2 = 1$ for all $k$ where $\\widehat{u}_k \\neq 0$. This is only true for $k=0$. If $u$ is not a constant function, it will have nonzero Fourier coefficients $\\widehat{u}_k$ for some $k \\ne 0$. For any such modes with $|k| \\le N$, their energy will be attenuated. Therefore, the $L^2$ norm is strictly decreased, not preserved, unless $u$ is a trigonometric polynomial of degree at most $0$ (i.e., a constant). The statement that this holds \"for every $u \\in L^2(\\mathbb{T})$\" is false. The reasoning \"because its kernel integrates to 1\" is a non-sequitur; this property guarantees contraction in $L^p$ spaces, not isometry in $L^2$.\n**Verdict: Incorrect.**\n\n**Analysis of Option C**\n\nThe de la Vallée Poussin mean is standardly defined by the operator $V_N = 2\\sigma_{2N-1}^{(1)} - \\sigma_{N-1}^{(1)}$. This is a linear combination of two Fejér operators, not an \"average\", as the coefficients ($2$ and $-1$) do not form a convex combination. The convolution kernel for $V_N$ is $K_{V_N} = 2K_{2N-1}^{(1)} - K_{N-1}^{(1)}$. Since $K_{2N-1}^{(1)}$ and $K_{N-1}^{(1)}$ are nonnegative functions, but one is subtracted from the other, the resulting kernel $K_{V_N}$ is not guaranteed to be nonnegative. In fact, it is known to take negative values. For example, for $N=2$, the kernel is $K_{V_2}(x) = 2K_3^{(1)}(x) - K_1^{(1)}(x)$. At $x=\\pi/2$, one can calculate that $K_{V_2}(\\pi/2) < 0$. Since the kernel is not nonnegative, the proof for the TVD property used in option A fails. Operators with kernels that change sign can amplify total variation. Therefore, the claim $\\mathrm{TV}(V_N u) \\le \\mathrm{TV}(u)$ is false in general.\n**Verdict: Incorrect.**\n\n**Analysis of Option D**\n\nThis option discusses the effect of a non-expansive linear operator $P$ (where $\\|Pu\\|_2 \\le \\|u\\|_2$) on an energy-conserving DG scheme.\n\n1.  **Diagnostic post-processing**: The scheme evolves a state $u_h(t)$ according to an energy-conserving law, meaning $\\|u_h(t)\\|_2$ is constant. Applying an operator $P$ to the output $u_h(t)$ to produce a diagnostic quantity $v(t) = P u_h(t)$ does not alter the evolution of $u_h(t)$ itself. The scheme's energy, which is $\\|u_h(t)\\|_2^2$, remains conserved. This part of the statement is correct.\n\n2.  **Filtering step**: If $P$ is applied at each time step, the evolution becomes $u_h(t_{n+1}) = P(u_h^{\\text{evolved}}(t_{n+1}))$. The energy-conserving evolution gives $\\|u_h^{\\text{evolved}}(t_{n+1})\\|_2 = \\|u_h(t_n)\\|_2$. After applying the filter, the new energy is $\\|u_h(t_{n+1})\\|_2^2 = \\|P(u_h^{\\text{evolved}}(t_{n+1}))\\|_2^2$. Since $P$ is non-expansive, $\\|P(u_h^{\\text{evolved}}(t_{n+1}))\\|_2^2 \\le \\|u_h^{\\text{evolved}}(t_{n+1})\\|_2^2 = \\|u_h(t_n)\\|_2^2$. Equality holds only if $P$ acts as an isometry on the evolved state. For a general non-expansive operator like a Cesàro mean, this is not true, and energy is strictly dissipated. Thus, \"exact energy conservation is generally lost\". This is correct.\n\n3.  **The 'unless' clause**: The statement proposes a case where conservation is maintained: if $P$ is an $L^2$-orthogonal projector. An orthogonal projector $P$ onto a subspace $W$ is non-expansive. It preserves the norm of a vector $v$ if and only if $v \\in W$. The phrase \"leaves the energy inner product invariant on the range of the evolution\" is a slightly awkward but interpretable way of saying that $P$ acts as an isometry on the solution space. An orthogonal projector acts as an isometry on its range $W$. So, if the evolved state $u_h^{\\text{evolved}}(t_{n+1})$ is always in the range $W$ of the projector $P$, then $P$ will preserve its norm. This scenario, while specific, is a valid exception where energy would be conserved.\n\nThe overall statement accurately captures the fundamental difference between diagnostic post-processing and filtering within the time-stepping loop of a numerical scheme.\n**Verdict: Correct.**\n\n**Analysis of Option E**\n\nThis option claims that only the Fejér mean ($m=1$) has a nonnegative kernel and that higher-order Cesàro kernels ($m \\ge 2$) change sign. As established in the analysis of option A, this is false. The kernels $K_N^{(m)}$ are derived by repeated averaging: $K_N^{(m)} = \\frac{1}{N+1}\\sum_{n=0}^N K_n^{(m-1)}$. Starting from the nonnegativity of the Fejér kernel $K_n^{(1)}$, a straightforward induction proves that $K_N^{(m)}$ is nonnegative for all integers $m \\ge 1$. The premise of the statement is factually incorrect. Consequently, the conclusion that $\\sigma_N^{(m)}$ for $m \\ge 2$ cannot be TVD is also false. As shown in A, these operators are TVD precisely because their kernels are nonnegative.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}