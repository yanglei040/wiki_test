{
    "hands_on_practices": [
        {
            "introduction": "多项式插值的稳定性并非理所当然，它在很大程度上取决于插值节点的分布。勒贝格常数是量化这种稳定性的关键工具。这项动手实践  将指导你为两种常见的节点集（等距节点和切比雪夫节点）计算该常数，让你对为何某些节点分布因其优越的稳定性而备受青睐有更深刻的理解。",
            "id": "3409339",
            "problem": "设 $\\Lambda_{n}(x)$ 表示在 $[-1,1]$ 上的 $n$ 次多项式插值的勒贝格函数，由与节点 $\\{x_{j}\\}_{j=0}^{n}$ 关联的拉格朗日基多项式 $\\{\\ell_{j}(x)\\}_{j=0}^{n}$ 定义，通过以下方式：\n$$\n\\Lambda_{n}(x) \\equiv \\sum_{j=0}^{n} |\\ell_{j}(x)|, \\quad \\text{其中} \\quad \\ell_{j}(x) \\equiv \\prod_{\\substack{m=0 \\\\ m\\neq j}}^{n} \\frac{x - x_{m}}{x_{j} - x_{m}}.\n$$\n勒贝格常数为 $\\max_{x \\in [-1,1]} \\Lambda_{n}(x)$，它刻画了插值映射在一致范数下的算子范数，是谱方法和间断 Galerkin (DG) 离散化中的一个核心稳定性指标。\n\n仅使用上述基本定义，考虑 $n=3$ 的情况，此时有 $n+1 = 4$ 个节点。对 $[-1,1]$ 上的以下两族节点，显式地计算出 $\\Lambda_{3}(x)$：\n- 等距节点：$x_{0}=-1$, $x_{1}=-\\frac{1}{3}$, $x_{2}=\\frac{1}{3}$, $x_{3}=1$。\n- Chebyshev–Lobatto 节点：$x_{j}=\\cos\\!\\left(\\frac{j\\pi}{3}\\right)$，其中 $j \\in \\{0,1,2,3\\}$，即 $x_{0}=1$, $x_{1}=\\frac{1}{2}$, $x_{2}=-\\frac{1}{2}$, $x_{3}=-1$。\n\n通过构造拉格朗日基多项式，并利用对称性和定义所蕴含的代数恒等式来化简绝对值之和，从而推导出每个网格上 $\\Lambda_{3}(x)$ 的闭式表达式。确定每个节点族在 $[-1,1]$ 上 $\\Lambda_{3}(x)$ 的最大值的精确值。将这两个精确最大值按 (等距节点, Chebyshev–Lobatto 节点) 的顺序，以单行矩阵的形式报告。不允许四舍五入，最终答案必须是无单位的精确解析表达式。",
            "solution": "我们从拉格朗日基多项式的定义开始，\n$$\n\\ell_{j}(x) = \\prod_{\\substack{m=0 \\\\ m \\neq j}}^{3} \\frac{x - x_{m}}{x_{j} - x_{m}},\n$$\n以及勒贝格函数，\n$$\n\\Lambda_{3}(x) = \\sum_{j=0}^{3} |\\ell_{j}(x)|.\n$$\n由于两组节点都关于 $x=0$ 对称，勒贝格函数将是偶函数，因此我们只需分析 $x \\in [0,1]$ 的情况，然后通过对称性进行扩展。\n\n情况 I：Chebyshev–Lobatto 节点 $x \\in \\{-1,-\\frac{1}{2},\\frac{1}{2},1\\}$。将节点标记为 $a=-1$, $b=-\\frac{1}{2}$, $c=\\frac{1}{2}$, $d=1$。直接应用定义可得\n$$\n\\ell_{a}(x) = -\\frac{2}{3}\\,(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})(x-1), \\quad\n\\ell_{b}(x) = \\frac{4}{3}\\,(x+1)(x-\\tfrac{1}{2})(x-1),\n$$\n$$\n\\ell_{c}(x) = -\\frac{4}{3}\\,(x+1)(x+\\tfrac{1}{2})(x-1), \\quad\n\\ell_{d}(x) = \\frac{2}{3}\\,(x+1)(x+\\tfrac{1}{2})(x-\\tfrac{1}{2}).\n$$\n在 $[0,\\frac{1}{2}]$ 上，符号模式为 $\\ell_{a}(x) \\le 0$, $\\ell_{b}(x) \\ge 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\le 0$。因此\n$$\n\\Lambda_{3}(x) = -\\ell_{a}(x) + \\ell_{b}(x) + \\ell_{c}(x) - \\ell_{d}(x) = 1 - 2\\big(\\ell_{a}(x) + \\ell_{d}(x)\\big).\n$$\n一个关键的简化来自于对公因式的分解：\n$$\n\\ell_{a}(x) + \\ell_{d}(x) = -\\frac{2}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})(x-1) + \\frac{2}{3}(x+1)(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})\n$$\n$$\n= \\frac{2}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})\\big(-(x-1)+(x+1)\\big) = \\frac{4}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2}).\n$$\n因此在 $[0,\\frac{1}{2}]$ 上，\n$$\n\\Lambda_{3}(x) = 1 - \\frac{8}{3}\\left(x+\\frac{1}{2}\\right)\\left(x-\\frac{1}{2}\\right) = 1 - \\frac{8}{3}\\left(x^{2}-\\frac{1}{4}\\right) = \\frac{5}{3} - \\frac{8}{3}x^{2}.\n$$\n因此在 $[0,\\frac{1}{2}]$ 上，$\\Lambda_{3}(x)$ 是一个关于 $x^2$ 的凹二次函数，在 $x=0$ 处取得最大值 $\\frac{5}{3}$。\n\n在 $[\\frac{1}{2},1]$ 上，符号模式为 $\\ell_{a}(x) \\ge 0$, $\\ell_{b}(x) \\le 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\ge 0$，所以\n$\n\\Lambda_{3}(x) = \\ell_{a}(x) - \\ell_{b}(x) + \\ell_{c}(x) + \\ell_{d}(x) = 1 - 2\\,\\ell_{b}(x).\n$\n设 $h(x) \\equiv (x+1)(x-\\frac{1}{2})(x-1)$，则 $\\ell_{b}(x) = \\frac{4}{3} h(x)$。然后\n$$\nh(x) = (x^{2}+\\tfrac{1}{2}x-\\tfrac{1}{2})(x-1) = x^{3} - \\frac{1}{2}x^{2} - x + \\frac{1}{2}.\n$$\n其导数 $h'(x) = 3x^{2} - x - 1$ 在 $x^{\\star} = \\frac{1+\\sqrt{13}}{6} \\in (\\tfrac{1}{2},1)$ 处为零，其中 $h''(x^{\\star}) = 6x^{\\star} - 1  0$，所以 $h$ 在此达到一个局部极小值。计算得，\n$$\nh\\!\\left(\\frac{1+\\sqrt{13}}{6}\\right) = \\frac{35 - 13\\sqrt{13}}{108}, \\quad \\Rightarrow \\quad \\ell_{b,\\min} = \\frac{4}{3}\\,h\\!\\left(\\frac{1+\\sqrt{13}}{6}\\right) = \\frac{35 - 13\\sqrt{13}}{81}.\n$$\n因此在 $[\\frac{1}{2},1]$ 上，\n$$\n\\max \\Lambda_{3}(x) = 1 - 2\\,\\ell_{b,\\min} = 1 - \\frac{2(35 - 13\\sqrt{13})}{81} = \\frac{11 + 26\\sqrt{13}}{81},\n$$\n该值严格小于 $\\frac{5}{3}$。因此 Chebyshev–Lobatto 勒贝格常数为\n$$\n\\max_{x \\in [-1,1]} \\Lambda_{3}(x) = \\frac{5}{3}.\n$$\n\n情况 II：等距节点 $x \\in \\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$。将节点标记为 $a=-1$, $b=-\\frac{1}{3}$, $c=\\frac{1}{3}$, $d=1$。根据定义，\n$$\n\\ell_{a}(x) = -\\frac{9}{16}\\,(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})(x-1), \\quad\n\\ell_{b}(x) = \\frac{27}{16}\\,(x+1)(x-\\tfrac{1}{3})(x-1),\n$$\n$$\n\\ell_{c}(x) = -\\frac{27}{16}\\,(x+1)(x+\\tfrac{1}{3})(x-1), \\quad\n\\ell_{d}(x) = \\frac{9}{16}\\,(x+1)(x+\\tfrac{1}{3})(x-\\tfrac{1}{3}).\n$$\n在 $[0,\\frac{1}{3}]$ 上，符号为 $\\ell_{a}(x) \\le 0$, $\\ell_{b}(x) \\ge 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\le 0$，因此\n$$\n\\Lambda_{3}(x) = -\\ell_{a}(x) + \\ell_{b}(x) + \\ell_{c}(x) - \\ell_{d}(x) = 1 - 2\\big(\\ell_{a}(x) + \\ell_{d}(x)\\big).\n$$\n如前所述，会发生一项消去：\n$$\n\\ell_{a}(x) + \\ell_{d}(x) = -\\frac{9}{16}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})(x-1) + \\frac{9}{16}(x+1)(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})\n$$\n$$\n= \\frac{9}{16}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})\\big(-(x-1)+(x+1)\\big) = \\frac{9}{8}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3}).\n$$\n因此在 $[0,\\frac{1}{3}]$ 上，\n$$\n\\Lambda_{3}(x) = 1 - \\frac{9}{4}\\left(x+\\frac{1}{3}\\right)\\left(x-\\frac{1}{3}\\right) = 1 - \\frac{9}{4}\\left(x^{2}-\\frac{1}{9}\\right) = \\frac{5}{4} - \\frac{9}{4}x^{2},\n$$\n所以此处的最大值在 $x=0$ 处取得，其值为 $\\frac{5}{4}$。\n\n在 $[\\frac{1}{3},1]$ 上，符号为 $\\ell_{a}(x) \\ge 0$, $\\ell_{b}(x) \\le 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\ge 0$，因此\n$\n\\Lambda_{3}(x) = 1 - 2\\,\\ell_{b}(x).\n$\n设 $g(x) \\equiv (x+1)(x-\\frac{1}{3})(x-1)$，则 $\\ell_{b}(x) = \\frac{27}{16}g(x)$。展开\n$$\ng(x) = (x^{2} + \\tfrac{2}{3}x - \\tfrac{1}{3})(x-1) = x^{3} - \\frac{1}{3}x^{2} - x + \\frac{1}{3}.\n$$\n临界点满足 $g'(x) = 3x^{2} - \\frac{2}{3}x - 1 = 0$，即\n$$\n9x^{2} - 2x - 3 = 0 \\quad \\Rightarrow \\quad x^{\\star} = \\frac{1 + 2\\sqrt{7}}{9} \\in \\big(\\tfrac{1}{3},1\\big), \\quad g''(x^{\\star}) = 6x^{\\star} - \\frac{2}{3}  0,\n$$\n所以 $g$ 在 $x^{\\star}$ 处达到其最小值。在 $x^{\\star}$ 处求值，设 $s = \\sqrt{7}$ 并计算\n$$\nx^{\\star} = \\frac{1 + 2s}{9}, \\quad (x^{\\star})^{2} = \\frac{29 + 4s}{81}, \\quad (x^{\\star})^{3} = \\frac{85 + 62s}{729}.\n$$\n那么\n$$\ng(x^{\\star}) = (x^{\\star})^{3} - \\frac{1}{3}(x^{\\star})^{2} - x^{\\star} + \\frac{1}{3} = \\frac{160 - 112s}{729} = \\frac{16(10 - 7s)}{729},\n$$\n从而\n$$\n\\ell_{b,\\min} = \\frac{27}{16}\\,g(x^{\\star}) = \\frac{10 - 7\\sqrt{7}}{27}.\n$$\n因此在 $[\\frac{1}{3},1]$ 上，\n$$\n\\max \\Lambda_{3}(x) = 1 - 2\\,\\ell_{b,\\min} = 1 - \\frac{2(10 - 7\\sqrt{7})}{27} = \\frac{7 + 14\\sqrt{7}}{27}.\n$$\n这个值超过了 $\\frac{5}{4}$，所以等距节点的勒贝格常数为\n$$\n\\max_{x \\in [-1,1]} \\Lambda_{3}(x) = \\frac{7 + 14\\sqrt{7}}{27}.\n$$\n\n结论与比较。我们已经确定了 $n=3$ 时勒贝格函数的精确最大值：\n- 等距节点 $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$: $\\max \\Lambda_{3}(x) = \\frac{7 + 14\\sqrt{7}}{27}$。\n- Chebyshev–Lobatto 节点 $\\{-1,-\\frac{1}{2},\\frac{1}{2},1\\}$: $\\max \\Lambda_{3}(x) = \\frac{5}{3}$。\n\n这两个值在数量级上很接近。对于这个低次数，等距节点集产生的勒贝格常数略小，而对于更高次数，已知 Chebyshev 族在稳定性方面具有渐近更优的行为，这反映在勒贝格常数的增长上。按要求的顺序以行矩阵形式报告这两个最大值，即可完成计算。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7\\left(1+2\\sqrt{7}\\right)}{27}  \\frac{5}{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "多项式插值的一个主要应用是近似函数的导数，这构成了谱方法的核心。这项练习  揭示了谱微分的一个强大而优雅的特性。你将验证当它应用于多项式时所具有的精确性，从而直接洞察谱方法为何能达到其标志性的“谱精度”。",
            "id": "3409312",
            "problem": "考虑在区间 $\\left[-1,1\\right]$ 上，使用切比雪夫-高斯-洛巴托（CGL）节点的谱配置离散化。令 $N=7$，因此有 $N+1=8$ 个节点 $x_i=\\cos\\left(\\frac{\\pi i}{N}\\right)$，其中 $i=0,1,\\dots,N$。定义测试多项式\n$$\np(x)=x^{7}-\\frac{3}{5}x^{6}+\\sqrt{2}\\,x^{5}-\\frac{1}{7}x^{4}+\\pi\\,x^{3}-\\exp(1)\\,x^{2}+\\frac{1}{3}x-\\ln(2).\n$$\n使用 CGL 节点上的重心拉格朗日基，从第一性原理构建与这些节点相关的节点微分矩阵 $D$，然后计算离散导数向量 $D\\,\\mathbf{p}$，其中 $\\mathbf{p}=\\left(p(x_0),p(x_1),\\dots,p(x_7)\\right)^{\\top}$。将 $D\\,\\mathbf{p}$ 与精确的节点导数向量 $\\mathbf{p}'=\\left(p'(x_0),p'(x_1),\\dots,p'(x_7)\\right)^{\\top}$ 进行比较，并确定节点误差的最大范数\n$$\nE_{\\infty}=\\max_{0\\leq i\\leq 7}\\left|\\,\\left(D\\,\\mathbf{p}\\right)_i - p'(x_i)\\,\\right|.\n$$\n你的最终答案必须是 $E_{\\infty}$ 的精确值，以单个实数形式给出。不需要四舍五入。在间断伽辽金（DG）和谱方法的背景下，此计算验证了对于此测试多项式，在适当节点上离散导数的谱精度。",
            "solution": "该问题被验证为自洽、有科学依据且适定的。解决该问题所需的所有数据和定义均已提供，不存在内部矛盾或违反既定科学原理的情况。该问题是数值分析领域基本定理的直接应用，特别是关于谱方法和多项式插值的定理。\n\n该问题要求在使用切比雪夫-高斯-洛巴托（CGL）节点上的谱配置方法对特定多项式 $p(x)$ 进行微分时，计算最大节点误差。节点数为 $N+1=8$，对应于最大多项式次数 $N=7$。节点在区间 $[-1, 1]$ 上由公式 $x_i = \\cos(\\frac{\\pi i}{N})$ 定义，其中 $i=0, 1, \\dots, N$。当 $N=7$ 时，节点为 $x_i = \\cos(\\frac{\\pi i}{7})$，其中 $i=0, 1, \\dots, 7$。\n\n待微分的多项式为：\n$$\np(x)=x^{7}-\\frac{3}{5}x^{6}+\\sqrt{2}\\,x^{5}-\\frac{1}{7}x^{4}+\\pi\\,x^{3}-\\exp(1)\\,x^{2}+\\frac{1}{3}x-\\ln(2)\n$$\n该多项式的次数为 $\\deg(p)=7$。\n\n谱微分方法的核心在于多项式插值。给定一组数据点 $(x_i, f(x_i))$，其中 $i=0, \\dots, N$，我们首先构建一个唯一的次数至多为 $N$ 的多项式，称之为 $\\mathcal{I}_N f(x)$，它对数据进行插值，即对所有 $i$ 都有 $\\mathcal{I}_N f(x_i) = f(x_i)$。函数 $f(x)$ 在节点处的导数，则通过计算插值多项式在这些节点处的精确导数值来近似，即 $(\\mathcal{I}_N f)'(x_i)$。\n\n节点微分矩阵 $D$ 是一个 $(N+1) \\times (N+1)$ 的矩阵，用于形式化此操作。如果 $\\mathbf{f}$ 是节点上函数值的向量，即 $\\mathbf{f} = (f(x_0), f(x_1), \\dots, f(x_N))^{\\top}$，那么在这些节点上的近似导数向量由矩阵-向量乘积 $D\\mathbf{f}$ 给出。该矩阵的元素由 $D_{ij} = \\ell_j'(x_i)$ 给出，其中 $\\ell_j(x)$ 是第 $j$ 个拉格朗日基多项式。\n\n该问题要求使用重心拉格朗日基从第一性原理构建 $D$。对于指定的 CGL 节点，重心权重由 $w_j = (-1)^j \\delta_j$ 给出，其中 $\\delta_0 = \\delta_N = 1/2$，对于 $j=1, \\dots, N-1$，$\\delta_j = 1$。对于 $N=7$，这些权重是：\n$$\nw_0 = \\frac{1}{2}, \\quad w_1 = -1, \\quad w_2 = 1, \\quad w_3 = -1, \\quad w_4 = 1, \\quad w_5 = -1, \\quad w_6 = 1, \\quad w_7 = -\\frac{1}{2}\n$$\n使用这些权重，微分矩阵 $D$ 的元素可以如下构建：\n非对角线元素由以下公式给出：\n$$\nD_{ij} = \\frac{w_j/w_i}{x_i - x_j} \\quad \\text{for } i \\neq j\n$$\n对角线元素由 CGL 节点的特定公式给出，以避免数值不稳定性：\n$$\nD_{00} = \\frac{2N^2+1}{6} \\\\\nD_{NN} = -\\frac{2N^2+1}{6} \\\\\nD_{ii} = -\\frac{x_i}{2(1-x_i^2)} \\quad \\text{for } i=1, \\dots, N-1\n$$\n对于 $N=7$，这得出 $D_{00} = \\frac{2(7^2)+1}{6} = \\frac{99}{6} = \\frac{33}{2}$ 和 $D_{77} = -\\frac{33}{2}$。\n\n虽然这些公式允许显式构建矩阵 $D$，但一个关键的理论观察使得直接计算 $D$、$\\mathbf{p}$ 和 $p'(x_i)$ 变得不必要。多项式插值的核心原理是，对于任意一组 $N+1$ 个不同的点，存在一个唯一的次数至多为 $N$ 的多项式穿过这些点。\n\n在这个问题中，待微分的函数 $p(x)$ 本身就是一个多项式。$p(x)$ 的次数是 $7$。谱方法使用一个次数至多为 $N=7$ 的插值多项式。因此，在 $8$ 个不同的 CGL 节点 $(x_i, p(x_i))$ 上插值 $p(x)$ 值的那个唯一的次数至多为 $7$ 的多项式，必定是 $p(x)$ 本身。\n用符号表示，如果我们将插值多项式记为 $\\mathcal{I}_7 p(x)$，我们有：\n$$\n\\mathcal{I}_7 p(x) = p(x)\n$$\n离散微分运算计算的是插值多项式在节点处的导数。因此，离散导数向量 $D\\mathbf{p}$ 的第 $i$ 个分量是：\n$$\n(D\\mathbf{p})_i = (\\mathcal{I}_7 p)'(x_i)\n$$\n由于 $\\mathcal{I}_7 p(x) = p(x)$，因此 $(\\mathcal{I}_7 p)'(x) = p'(x)$。所以，谱方法在每个节点上计算出的值就是导数的精确值：\n$$\n(D\\mathbf{p})_i = p'(x_i)\n$$\n这对所有节点 $i=0, 1, \\dots, 7$ 都成立。\n\n问题要求的是节点误差的最大范数，其定义为：\n$$\nE_{\\infty} = \\max_{0 \\leq i \\leq 7} |(D\\mathbf{p})_i - p'(x_i)|\n$$\n代入我们分析的结果：\n$$\nE_{\\infty} = \\max_{0 \\leq i \\leq 7} |p'(x_i) - p'(x_i)| = \\max_{0 \\leq i \\leq 7} |0|\n$$\n这得出的结论是，在每个节点上的误差都恰好为零。\n\n因此，节点误差的最大范数为：\n$$\nE_{\\infty} = 0\n$$\n这个结果不是近似值。它是多项式插值性质的精确推论。对于任何次数小于或等于 $N$ 的多项式，在 $N+1$ 个节点上的谱微分是精确的。这是谱方法的一个基本性质，也使其区别于像有限差分这样的低阶方法，后者对于一个 7 次多项式不会得出精确的导数。$p(x)$ 中的复杂系数与此结论无关，该结论仅取决于多项式的次数相对于配置点的数量。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在谱方法和间断Galerkin方法中，涉及多项式基函数的积分通常通过数值积分来计算。这个问题  通过探究积分公式的“精确度阶”这一概念，在插值和积分之间建立了一座关键的桥梁。掌握这一概念对于确保数值格式中的离散内积能够被精确计算，从而保持整个方法的准确性至关重要。",
            "id": "3409303",
            "problem": "考虑在区间 $[-1,1]$ 上，使用具有重心权 $\\{\\lambda_i\\}_{i=0}^{n}$ 的 $n+1$ 个不同节点 $\\{x_i\\}_{i=0}^{n}$ 上的Lagrange节点基，对两个足够光滑的函数进行多项式插值。令 $p_n \\in \\mathbb{P}_n$ 和 $q_n \\in \\mathbb{P}_n$ 表示这两个函数的相应次数为 $n$ 的插值多项式，以重心Lagrange形式表示。在谱方法和间断Galerkin (DG) 方法的背景下，诸如 $\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 的内积通常通过使用相同节点 $\\{x_i\\}_{i=0}^{n}$ 和正权重 $\\{w_i\\}_{i=0}^{n}$ 的求积法则来近似，得到近似值 $\\sum_{i=0}^{n} w_i\\,p_n(x_i)\\,q_n(x_i)$。求积法则的代数精度是确定这种离散近似何时与多项式数据的精确积分一致的基本特征。\n\n选择所有正确的陈述。\n\nA. 求积法则的代数精度是这样一个最大的整数 $d$，使得该法则能精确地对 $\\mathbb{P}_d$ 中的每个多项式进行积分。\n\nB. 对于任意一对 $p_n, q_n \\in \\mathbb{P}_n$，积分 $\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 能被一个求积法则精确计算的充要条件是该法则的代数精度至少为 $2n$。\n\nC. 如果求积节点是 $[-1,1]$ 上的 $n+1$ 个Gauss–Legendre点，并使用其标准的正权重，则该法则的代数精度为 $2n+1$，因此对于所有 $p_n, q_n \\in \\mathbb{P}_n$，$\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 的计算是精确的。\n\nD. 如果求积节点是 $[-1,1]$ 上的 $n+1$ 个Gauss–Lobatto–Legendre点，并使用其标准的正权重，则该法则的代数精度为 $2n$，因此对于所有 $p_n, q_n \\in \\mathbb{P}_n$，$\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 的计算是精确的。\n\nE. 对于在任意不同节点上构建的重心Lagrange插值多项式 $p_n, q_n$，其乘积 $p_n(x)\\,q_n(x)$ 本身属于 $\\mathbb{P}_n$，因此代数精度为 $n$ 的求积法则足以精确计算 $\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n- **定义域：** 区间 $[-1,1]$。\n- **函数：** 对两个足够光滑的函数进行插值。\n- **插值节点：** $n+1$ 个不同的节点 $\\{x_i\\}_{i=0}^{n}$。\n- **插值基：** Lagrange节点基，以重心形式表示，权重为 $\\{\\lambda_i\\}_{i=0}^{n}$。\n- **插值多项式：** $p_n \\in \\mathbb{P}_n$ 和 $q_n \\in \\mathbb{P}_n$ 是这两个函数的次数为 $n$ 的多项式插值。$\\mathbb{P}_n$ 是次数至多为 $n$ 的多项式空间。\n- **关注的积分：** $\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$。\n- **近似：** 一个求积法则，其和为 $\\sum_{i=0}^{n} w_i\\,p_n(x_i)\\,q_n(x_i)$。\n- **求积节点与权重：** 节点 $\\{x_i\\}_{i=0}^{n}$ 与插值节点相同。权重 $\\{w_i\\}_{i=0}^{n}$ 为正。\n- **核心概念：** 求积法则的代数精度。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 问题陈述牢固地植根于数值分析的原理，特别是多项式插值（Lagrange、重心形式）和数值求积（Gauss法则、代数精度）。这些是数学和计算科学中的标准课题，是谱方法和间断Galerkin方法等方法的核心。所有概念都有明确定义且符合事实。\n- **良态性：** 问题提供了清晰的背景，并要求对几个明确定义的数学陈述进行评估。给出的信息足以确定每个陈述的正确性。可以进行独特且有意义的分析。\n- **客观性：** 语言正式、精确，没有主观性。诸如“$p_n \\in \\mathbb{P}_n$”、“代数精度”和“Gauss–Legendre点”等术语具有明确的数学定义。\n\n### 步骤3：结论与行动\n问题陈述是有效的。它科学合理、良态、客观且完整。我将继续进行解答。\n\n***\n\n## 解题推导\n\n问题的核心在于确定在何种条件下，两个多项式 $p_n(x)$ 和 $q_n(x)$ 的乘积的积分可以被给定的求积法则精确计算。\n\n令 $p_n, q_n \\in \\mathbb{P}_n$，其中 $\\mathbb{P}_n$ 表示次数至多为 $n$ 的多项式的向量空间。这两个多项式的乘积，我们称之为 $h(x) = p_n(x)q_n(x)$，是一个多项式。$h(x)$ 的次数至多是 $p_n(x)$ 和 $q_n(x)$ 次数之和，即 $n+n=2n$。因此，$h(x) \\in \\mathbb{P}_{2n}$。\n\n所讨论的积分为 $I(h) = \\int_{-1}^{1} h(x)\\,\\mathrm{d}x = \\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$。\n近似是一个求积法则 $Q(h) = \\sum_{i=0}^{n} w_i\\,h(x_i) = \\sum_{i=0}^{n} w_i\\,p_n(x_i)\\,q_n(x_i)$。\n\n我们需要确定在什么条件下 $I(h) = Q(h)$。如果求积法则对多项式 $h(x)$ 是精确的，则该等式成立。\n\n### 逐项分析\n\n**A. 求积法则的代数精度是这样一个最大的整数 $d$，使得该法则能精确地对 $\\mathbb{P}_d$ 中的每个多项式进行积分。**\n\n该陈述提供了一个定义。一个由节点 $\\{x_i\\}_{i=0}^{n}$ 和权重 $\\{w_i\\}_{i=0}^{n}$ 给出的求积法则，如果它能精确计算任何多项式 $P(x) \\in \\mathbb{P}_d$ 的积分，即 $\\int_{-1}^{1} P(x)\\,\\mathrm{d}x = \\sum_{i=0}^{n} w_i P(x_i)$，并且存在至少一个多项式 $P^*(x) \\in \\mathbb{P}_{d+1}$ 使该法则不精确，那么就称该法则具有代数精度 $d$。该陈述准确地概括了这个标准定义。\n\n因此，该陈述是 **正确的**。\n\n**B. 对于任意一对 $p_n, q_n \\in \\mathbb{P}_n$，积分 $\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 能被一个求积法则精确计算的充要条件是该法则的代数精度至少为 $2n$。**\n\n该陈述提出了一个充要条件。我们来分析两个方向的蕴涵关系。\n\n1.  **“如果”方向：** 假设该法则的代数精度至少为 $2n$。这意味着该法则对 $\\mathbb{P}_{2n}$ 中的所有多项式都是精确的。如前所述，对于任意 $p_n, q_n \\in \\mathbb{P}_n$，它们的乘积 $p_n(x)q_n(x)$ 是一个属于 $\\mathbb{P}_{2n}$ 的多项式。因此，该乘积的积分将被该法则精确计算。这个方向是正确的。\n\n2.  **“仅当”方向：** 假设对于*任意*一对 $p_n, q_n \\in \\mathbb{P}_n$，积分都能被精确计算。我们必须证明其代数精度至少为 $2n$。为此，我们需要证明该法则对 $\\mathbb{P}_{2n}$ 中的每个多项式都精确。所有可能的乘积 $\\{p_n(x)q_n(x) \\mid p_n, q_n \\in \\mathbb{P}_n\\}$ 的集合张成了整个空间 $\\mathbb{P}_{2n}$。对于任何单项式 $x^k$（其中 $0 \\le k \\le 2n$），我们可以写成 $x^k = x^i x^j$，其中 $i,j \\le n$。例如，选择 $i=n$ 和 $j=k-n$；因为 $k \\le 2n$，所以 $j \\le n$。因此我们可以设 $p_n(x)=x^n$ 和 $q_n(x)=x^{k-n}$（对于 $k \\le n$ 有更简单的选择）。由于该法则对于这些乘积多项式的所有线性组合都是精确的（根据积分和求积和的线性性），它必须对它们所张成的空间中的任何多项式都精确，而这个空间就是 $\\mathbb{P}_{2n}$。根据定义，这意味着代数精度必须至少为 $2n$。这个方向也是正确的。\n\n该双向蕴含陈述成立。\n\n因此，该陈述是 **正确的**。\n\n**C. 如果求积节点是 $n+1$ 个Gauss–Legendre点，并使用其标准的正权重，则该法则的代数精度为 $2n+1$，因此对于所有 $p_n, q_n \\in \\mathbb{P}_n$，$\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 的计算是精确的。**\n\n数值分析中的一个基本结果指出，一个具有 $N$ 个节点的Gauss求积法则的代数精度为 $2N-1$。对于Gauss-Legendre法则，节点数为 $N=n+1$。因此代数精度为 $2(n+1)-1 = 2n+2-1 = 2n+1$。陈述的第一部分是正确的。\n\n乘积多项式 $p_n(x)q_n(x)$ 属于 $\\mathbb{P}_{2n}$。一个代数精度为 $2n+1$ 的求积法则对 $\\mathbb{P}_{2n+1}$ 中的所有多项式都是精确的，而 $\\mathbb{P}_{2n+1}$ 包含了子空间 $\\mathbb{P}_{2n}$。由于 $p_n(x)q_n(x) \\in \\mathbb{P}_{2n}$，其积分将被精确计算。结论从前提中逻辑地得出。\n\n因此，该陈述是 **正确的**。\n\n**D. 如果求积节点是 $n+1$ 个Gauss–Lobatto–Legendre点，并使用其标准的正权重，则该法则的代数精度为 $2n$，因此对于所有 $p_n, q_n \\in \\mathbb{P}_n$，$\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$ 的计算是精确的。**\n\n一个具有 $N$ 个节点（包括端点 $-1$ 和 $1$）的Gauss-Lobatto-Legendre求积法则的代数精度为 $2N-3$。在这个问题中，节点数为 $N=n+1$。因此，代数精度为 $2(n+1)-3 = 2n+2-3 = 2n-1$。\n\n该陈述声称代数精度为 $2n$。这是错误的。由于代数精度是 $2n-1$，该法则不能保证对所有 $2n$ 次多项式都精确。如选项B的分析所示，要保证对所有乘积 $p_n(x)q_n(x)$ 的精确性，代数精度必须至少为 $2n$。一个代数精度为 $2n-1$ 的法则通常会对某个 $2n$ 次多项式失效。举一个反例，令 $n=2$，则 $N=3$，该法则对次数为 $2(3)-3 = 3$ 的多项式是精确的。如果我们取 $p_2(x)=q_2(x)=L_2(x)$，即 2 次Legendre多项式，它们的乘积是 $(L_2(x))^2 \\in \\mathbb{P}_4$。3点Gauss-Lobatto法则对这个积分不精确。\n\n该陈述的前提在事实上是错误的，其结论也是错误的。\n\n因此，该陈述是 **不正确的**。\n\n**E. 对于在任意不同节点上构建的重心Lagrange插值多项式 $p_n, q_n$，其乘积 $p_n(x)\\,q_n(x)$ 本身属于 $\\mathbb{P}_n$，因此代数精度为 $n$ 的求积法则足以精确计算 $\\int_{-1}^{1} p_n(x)\\,q_n(x)\\,\\mathrm{d}x$。**\n\n用来表示多项式的形式（单项式、Newton、Lagrange或重心Lagrange）不会改变多项式本身或其次数。多项式 $p_n$ 和 $q_n$ 属于 $\\mathbb{P}_n$。它们的乘积 $p_n(x)q_n(x)$ 通常是一个次数最高可达 $2n$ 的多项式。声称该乘积本身属于 $\\mathbb{P}_n$ 是错误的。例如，如果 $n \\geq 1$，令 $p_n(x)=x$ 和 $q_n(x)=x$。两者都属于 $\\mathbb{P}_n$（实际上也属于 $\\mathbb{P}_1$）。它们的乘积是 $x^2$，属于 $\\mathbb{P}_2$，而不属于 $\\mathbb{P}_1$。由于乘积多项式通常属于 $\\mathbb{P}_{2n}$，对于 $n \\ge 1$，代数精度为 $n$ 的求积法则是不足够的。\n\n该陈述的前提是不正确的，这使得整个推理路线无效。\n\n因此，该陈述是 **不正确的**。",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}