{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在阐明谱方法的一个基石：其卓越的精确性。通过构建一个基于多项式插值的微分矩阵，您将验证对于一个多项式函数，其数值导数不仅仅是一个近似，而是解析精确的，这一特性将谱方法与有限差分等方法区分开来。",
            "id": "3409312",
            "problem": "考虑在区间 $\\left[-1,1\\right]$ 上使用 Chebyshev–Gauss–Lobatto (CGL) 节点的谱配置离散化。令 $N=7$，则有 $N+1=8$ 个节点 $x_i=\\cos\\left(\\frac{\\pi i}{N}\\right)$，其中 $i=0,1,\\dots,N$。定义测试多项式\n$$\np(x)=x^{7}-\\frac{3}{5}x^{6}+\\sqrt{2}\\,x^{5}-\\frac{1}{7}x^{4}+\\pi\\,x^{3}-\\exp(1)\\,x^{2}+\\frac{1}{3}x-\\ln(2).\n$$\n使用 CGL 节点上的重心拉格朗日基，从第一性原理构造与这些节点相关的节点微分矩阵 $D$，然后计算离散导数向量 $D\\,\\mathbf{p}$，其中 $\\mathbf{p}=\\left(p(x_0),p(x_1),\\dots,p(x_7)\\right)^{\\top}$。将 $D\\,\\mathbf{p}$ 与精确的节点导数向量 $\\mathbf{p}'=\\left(p'(x_0),p'(x_1),\\dots,p'(x_7)\\right)^{\\top}$ 进行比较，并确定节点误差的最大范数\n$$\nE_{\\infty}=\\max_{0\\leq i\\leq 7}\\left|\\,\\left(D\\,\\mathbf{p}\\right)_i - p'(x_i)\\,\\right|.\n$$\n你的最终答案必须是 $E_{\\infty}$ 的精确值，一个实数。不需要四舍五入。该计算验证了在间断 Galerkin (DG) 和谱方法的背景下，对于此测试多项式，在适当节点上离散导数的谱精度。",
            "solution": "该问题被验证为自洽的、有科学依据且适定的。解决该问题所需的所有数据和定义均已提供，不存在内部矛盾或违反既定科学原理的情况。该问题是数值分析领域基本定理的直接应用，特别是关于谱方法和多项式插值的定理。\n\n该问题要求计算在使用 Chebyshev-Gauss-Lobatto (CGL) 节点上的谱配置法对特定多项式 $p(x)$ 进行微分时产生的最大节点误差。节点数为 $N+1=8$，对应于最高为 $N=7$ 次的多项式。节点定义在区间 $[-1, 1]$ 上，公式为 $x_i = \\cos(\\frac{\\pi i}{N})$，其中 $i=0, 1, \\dots, N$。当 $N=7$ 时，节点为 $x_i = \\cos(\\frac{\\pi i}{7})$，其中 $i=0, 1, \\dots, 7$。\n\n需要微分的多项式是：\n$$\np(x)=x^{7}-\\frac{3}{5}x^{6}+\\sqrt{2}\\,x^{5}-\\frac{1}{7}x^{4}+\\pi\\,x^{3}-\\exp(1)\\,x^{2}+\\frac{1}{3}x-\\ln(2)\n$$\n该多项式的次数为 $\\deg(p)=7$。\n\n谱微分方法的核心在于多项式插值。给定一组数据点 $(x_i, f(x_i))$，其中 $i=0, \\dots, N$，我们首先构造一个唯一的、次数至多为 $N$ 的多项式，记作 $\\mathcal{I}_N f(x)$，该多项式对数据进行插值，即对所有 $i$ 都有 $\\mathcal{I}_N f(x_i) = f(x_i)$。函数 $f(x)$ 在节点处的导数，则通过插值多项式在这些节点处的精确导数 $(\\mathcal{I}_N f)'(x_i)$ 来近似。\n\n节点微分矩阵 $D$ 是一个 $(N+1) \\times (N+1)$ 的矩阵，它将此操作形式化。如果 $\\mathbf{f}$ 是节点处函数值的向量，$\\mathbf{f} = (f(x_0), f(x_1), \\dots, f(x_N))^{\\top}$，那么这些节点处导数的近似向量由矩阵-向量乘积 $D\\mathbf{f}$ 给出。该矩阵的元素由 $D_{ij} = \\ell_j'(x_i)$ 给出，其中 $\\ell_j(x)$ 是第 $j$ 个拉格朗日基多项式。\n\n该问题要求使用重心拉格朗日基从第一性原理构造 $D$。对于指定的 CGL 节点，重心权重由 $w_j = (-1)^j \\delta_j$ 给出，其中 $\\delta_0 = \\delta_N = 1/2$ 且对于 $j=1, \\dots, N-1$ 有 $\\delta_j = 1$。对于 $N=7$，这些权重为：\n$$\nw_0 = \\frac{1}{2}, \\quad w_1 = -1, \\quad w_2 = 1, \\quad w_3 = -1, \\quad w_4 = 1, \\quad w_5 = -1, \\quad w_6 = 1, \\quad w_7 = -\\frac{1}{2}\n$$\n使用这些权重，微分矩阵 $D$ 的元素可以如下构造：\n非对角线元素由以下公式给出：\n$$\nD_{ij} = \\frac{w_j/w_i}{x_i - x_j} \\quad \\text{for } i \\neq j\n$$\n对角线元素由 CGL 节点的特定公式给出，以避免数值不稳定性：\n$$\nD_{00} = \\frac{2N^2+1}{6} \\\\\nD_{NN} = -\\frac{2N^2+1}{6} \\\\\nD_{ii} = -\\frac{x_i}{2(1-x_i^2)} \\quad \\text{for } i=1, \\dots, N-1\n$$\n对于 $N=7$，这得出 $D_{00} = \\frac{2(7^2)+1}{6} = \\frac{99}{6} = \\frac{33}{2}$ 和 $D_{77} = -\\frac{33}{2}$。\n\n尽管这些公式允许显式构造矩阵 $D$，但一个关键的理论观察使得直接计算 $D$、$\\mathbf{p}$ 和 $p'(x_i)$ 变得没有必要。多项式插值的核心原理是，对于任何一组 $N+1$ 个不同的点，存在一个唯一的、次数至多为 $N$ 的多项式穿过这些点。\n\n在本问题中，待微分的函数 $p(x)$ 本身就是一个多项式。$p(x)$ 的次数是 7。谱方法采用的插值多项式次数至多为 $N=7$。因此，在 8 个不同的 CGL 节点 $(x_i, p(x_i))$ 上对 $p(x)$ 的值进行插值的、次数至多为 7 的唯一多项式，必然是 $p(x)$ 本身。\n用符号表示，如果我们将插值多项式记为 $\\mathcal{I}_7 p(x)$，我们有：\n$$\n\\mathcal{I}_7 p(x) = p(x)\n$$\n离散微分运算计算的是插值多项式在节点处的导数。因此，离散导数向量 $D\\mathbf{p}$ 的第 $i$ 个分量是：\n$$\n(D\\mathbf{p})_i = (\\mathcal{I}_7 p)'(x_i)\n$$\n由于 $\\mathcal{I}_7 p(x) = p(x)$，可得 $(\\mathcal{I}_7 p)'(x) = p'(x)$。因此，谱方法在每个节点上计算出的值就是导数的精确值：\n$$\n(D\\mathbf{p})_i = p'(x_i)\n$$\n这对所有节点 $i=0, 1, \\dots, 7$ 都成立。\n\n问题要求节点误差的最大范数，其定义为：\n$$\nE_{\\infty} = \\max_{0 \\leq i \\leq 7} |(D\\mathbf{p})_i - p'(x_i)|\n$$\n代入我们分析得出的结果：\n$$\nE_{\\infty} = \\max_{0 \\leq i \\leq 7} |p'(x_i) - p'(x_i)| = \\max_{0 \\leq i \\leq 7} |0|\n$$\n这得出的结论是，在每个节点上的误差都精确为零。\n\n因此，节点误差的最大范数是：\n$$\nE_{\\infty} = 0\n$$\n这个结果不是一个近似值。它是多项式插值性质的一个精确推论。对于任何次数小于或等于 $N$ 的多项式，在 $N+1$ 个节点上的谱微分是精确的。这是谱方法的一个基本性质，也将其与有限差分等低阶方法区分开来，后者对于一个 7 次多项式不会得出精确的导数。$p(x)$ 中的复杂系数与此结论无关，该结论仅取决于多项式的次数相对于配置点的数量。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "虽然多项式插值可以是精确的，但其稳定性并非必然，并且关键性地取决于节点的选择。本练习通过让您为均匀分布节点和切比雪夫节点显式推导勒贝格函数，提供量化这种稳定性的实践经验，为偏好后者提供了清晰的数学论证。",
            "id": "3409339",
            "problem": "设 $\\Lambda_{n}(x)$ 表示在 $[-1,1]$ 上的 $n$ 次多项式插值的 Lebesgue 函数，它由与节点 $\\{x_{j}\\}_{j=0}^{n}$ 相关的 Lagrange 基多项式 $\\{\\ell_{j}(x)\\}_{j=0}^{n}$ 定义为\n$$\n\\Lambda_{n}(x) \\equiv \\sum_{j=0}^{n} |\\ell_{j}(x)|, \\quad \\text{其中} \\quad \\ell_{j}(x) \\equiv \\prod_{\\substack{m=0 \\\\ m\\neq j}}^{n} \\frac{x - x_{m}}{x_{j} - x_{m}}。\n$$\nLebesgue 常数是 $\\max_{x \\in [-1,1]} \\Lambda_{n}(x)$，它刻画了插值映射在一致范数下的算子范数，是谱方法和间断 Galerkin (DG) 离散化中的核心稳定性指标。\n\n仅使用上述基本定义，考虑 $n=3$ 的情况，此时有 $n+1=4$ 个节点。请针对 $[-1,1]$ 上的以下两种节点族，显式地计算出 $\\Lambda_{3}(x)$：\n- 等距节点：$x_{0}=-1$, $x_{1}=-\\frac{1}{3}$, $x_{2}=\\frac{1}{3}$, $x_{3}=1$。\n- Chebyshev–Lobatto 节点：$x_{j}=\\cos\\!\\left(\\frac{j\\pi}{3}\\right)$，其中 $j \\in \\{0,1,2,3\\}$，即 $x_{0}=1$, $x_{1}=\\frac{1}{2}$, $x_{2}=-\\frac{1}{2}$, $x_{3}=-1$。\n\n通过构造 Lagrange 基多项式，并利用对称性和定义所蕴含的代数恒等式来简化绝对值之和，为每种网格推导出 $\\Lambda_{3}(x)$ 的闭式表达式。确定每种节点族在 $[-1,1]$ 上 $\\Lambda_{3}(x)$ 的最大值的精确值。按（等距节点，Chebyshev–Lobatto 节点）的顺序，将两个精确最大值以单行矩阵的形式报告。不允许四舍五入，最终答案必须是无单位的精确解析表达式。",
            "solution": "我们从 Lagrange 基多项式的定义开始，\n$$\n\\ell_{j}(x) = \\prod_{\\substack{m=0 \\\\ m \\neq j}}^{3} \\frac{x - x_{m}}{x_{j} - x_{m}},\n$$\n以及 Lebesgue 函数的定义，\n$$\n\\Lambda_{3}(x) = \\sum_{j=0}^{3} |\\ell_{j}(x)|.\n$$\n因为两组节点都关于 $x=0$ 对称，所以 Lebesgue 函数是偶函数，因此只需分析 $x \\in [0,1]$ 的情况，然后通过对称性推广即可。\n\n情况 I：Chebyshev–Lobatto 节点 $x \\in \\{-1,-\\frac{1}{2},\\frac{1}{2},1\\}$。将节点标记为 $a=-1$, $b=-\\frac{1}{2}$, $c=\\frac{1}{2}$, $d=1$。直接应用定义可得\n$$\n\\ell_{a}(x) = -\\frac{2}{3}\\,(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})(x-1), \\quad\n\\ell_{b}(x) = \\frac{4}{3}\\,(x+1)(x-\\tfrac{1}{2})(x-1),\n$$\n$$\n\\ell_{c}(x) = -\\frac{4}{3}\\,(x+1)(x+\\tfrac{1}{2})(x-1), \\quad\n\\ell_{d}(x) = \\frac{2}{3}\\,(x+1)(x+\\tfrac{1}{2})(x-\\tfrac{1}{2}).\n$$\n在 $[0,\\frac{1}{2}]$ 上，符号模式为 $\\ell_{a}(x) \\le 0$, $\\ell_{b}(x) \\ge 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\le 0$。因此\n$$\n\\Lambda_{3}(x) = -\\ell_{a}(x) + \\ell_{b}(x) + \\ell_{c}(x) - \\ell_{d}(x) = 1 - 2\\big(\\ell_{a}(x) + \\ell_{d}(x)\\big).\n$$\n一个关键的简化来自于对公因式进行因式分解：\n$$\n\\ell_{a}(x) + \\ell_{d}(x) = -\\frac{2}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})(x-1) + \\frac{2}{3}(x+1)(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})\n$$\n$$\n= \\frac{2}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})\\big(-(x-1)+(x+1)\\big) = \\frac{4}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2}).\n$$\n因此在 $[0,\\frac{1}{2}]$ 上，\n$$\n\\Lambda_{3}(x) = 1 - \\frac{8}{3}\\left(x+\\frac{1}{2}\\right)\\left(x-\\frac{1}{2}\\right) = 1 - \\frac{8}{3}\\left(x^{2}-\\frac{1}{4}\\right) = \\frac{5}{3} - \\frac{8}{3}x^{2}.\n$$\n因此在 $[0,\\frac{1}{2}]$ 上，$\\Lambda_{3}(x)$ 是一个关于 $x^2$ 的凹二次函数，其在 $x=0$ 处取得最大值，为 $\\frac{5}{3}$。\n\n在 $[\\frac{1}{2},1]$ 上，符号模式为 $\\ell_{a}(x) \\ge 0$, $\\ell_{b}(x) \\le 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\ge 0$，所以\n$\n\\Lambda_{3}(x) = \\ell_{a}(x) - \\ell_{b}(x) + \\ell_{c}(x) + \\ell_{d}(x) = 1 - 2\\,\\ell_{b}(x).\n$\n令 $h(x) \\equiv (x+1)(x-\\frac{1}{2})(x-1)$，则 $\\ell_{b}(x) = \\frac{4}{3} h(x)$。于是\n$$\nh(x) = (x^{2}+\\tfrac{1}{2}x-\\tfrac{1}{2})(x-1) = x^{3} - \\frac{1}{2}x^{2} - x + \\frac{1}{2}.\n$$\n其导数 $h'(x) = 3x^{2} - x - 1$ 在 $x^{\\star} = \\frac{1+\\sqrt{13}}{6} \\in (\\tfrac{1}{2},1)$ 处为零，其中 $h''(x^{\\star}) = 6x^{\\star} - 1 > 0$，因此 $h$ 达到一个局部极小值。计算得，\n$$\nh\\!\\left(\\frac{1+\\sqrt{13}}{6}\\right) = \\frac{35 - 13\\sqrt{13}}{108}, \\quad \\Rightarrow \\quad \\ell_{b,\\min} = \\frac{4}{3}\\,h\\!\\left(\\frac{1+\\sqrt{13}}{6}\\right) = \\frac{35 - 13\\sqrt{13}}{81}.\n$$\n因此在 $[\\frac{1}{2},1]$ 上，\n$$\n\\max \\Lambda_{3}(x) = 1 - 2\\,\\ell_{b,\\min} = 1 - \\frac{2(35 - 13\\sqrt{13})}{81} = \\frac{11 + 26\\sqrt{13}}{81},\n$$\n该值严格小于 $\\frac{5}{3}$。因此，Chebyshev–Lobatto Lebesgue 常数为\n$$\n\\max_{x \\in [-1,1]} \\Lambda_{3}(x) = \\frac{5}{3}.\n$$\n\n情况 II：等距节点 $x \\in \\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$。将节点标记为 $a=-1$, $b=-\\frac{1}{3}$, $c=\\frac{1}{3}$, $d=1$。根据定义，\n$$\n\\ell_{a}(x) = -\\frac{9}{16}\\,(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})(x-1), \\quad\n\\ell_{b}(x) = \\frac{27}{16}\\,(x+1)(x-\\tfrac{1}{3})(x-1),\n$$\n$$\n\\ell_{c}(x) = -\\frac{27}{16}\\,(x+1)(x+\\tfrac{1}{3})(x-1), \\quad\n\\ell_{d}(x) = \\frac{9}{16}\\,(x+1)(x+\\tfrac{1}{3})(x-\\tfrac{1}{3}).\n$$\n在 $[0,\\frac{1}{3}]$ 上，符号为 $\\ell_{a}(x) \\le 0$, $\\ell_{b}(x) \\ge 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\le 0$，因此\n$$\n\\Lambda_{3}(x) = -\\ell_{a}(x) + \\ell_{b}(x) + \\ell_{c}(x) - \\ell_{d}(x) = 1 - 2\\big(\\ell_{a}(x) + \\ell_{d}(x)\\big).\n$$\n和之前一样，发生了一次消去：\n$$\n\\ell_{a}(x) + \\ell_{d}(x) = -\\frac{9}{16}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})(x-1) + \\frac{9}{16}(x+1)(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})\n$$\n$$\n= \\frac{9}{16}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})\\big(-(x-1)+(x+1)\\big) = \\frac{9}{8}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3}).\n$$\n因此在 $[0,\\frac{1}{3}]$ 上，\n$$\n\\Lambda_{3}(x) = 1 - \\frac{9}{4}\\left(x+\\frac{1}{3}\\right)\\left(x-\\frac{1}{3}\\right) = 1 - \\frac{9}{4}\\left(x^{2}-\\frac{1}{9}\\right) = \\frac{5}{4} - \\frac{9}{4}x^{2},\n$$\n所以在此区间的最大值在 $x=0$ 处取得，值为 $\\frac{5}{4}$。\n\n在 $[\\frac{1}{3},1]$ 上，符号为 $\\ell_{a}(x) \\ge 0$, $\\ell_{b}(x) \\le 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\ge 0$，因此\n$\n\\Lambda_{3}(x) = 1 - 2\\,\\ell_{b}(x).\n$\n令 $g(x) \\equiv (x+1)(x-\\frac{1}{3})(x-1)$，则 $\\ell_{b}(x) = \\frac{27}{16}g(x)$。展开\n$$\ng(x) = (x^{2} + \\tfrac{2}{3}x - \\tfrac{1}{3})(x-1) = x^{3} - \\frac{1}{3}x^{2} - x + \\frac{1}{3}.\n$$\n临界点满足 $g'(x) = 3x^{2} - \\frac{2}{3}x - 1 = 0$，即\n$$\n9x^{2} - 2x - 3 = 0 \\quad \\Rightarrow \\quad x^{\\star} = \\frac{1 + 2\\sqrt{7}}{9} \\in \\big(\\tfrac{1}{3},1\\big), \\quad g''(x^{\\star}) = 6x^{\\star} - \\frac{2}{3} > 0,\n$$\n因此 $g$ 在 $x^{\\star}$ 处达到其最小值。在 $x^{\\star}$ 处求值，设 $s = \\sqrt{7}$ 并计算\n$$\nx^{\\star} = \\frac{1 + 2s}{9}, \\quad (x^{\\star})^{2} = \\frac{29 + 4s}{81}, \\quad (x^{\\star})^{3} = \\frac{85 + 62s}{729}.\n$$\n那么\n$$\ng(x^{\\star}) = (x^{\\star})^{3} - \\frac{1}{3}(x^{\\star})^{2} - x^{\\star} + \\frac{1}{3} = \\frac{160 - 112s}{729} = \\frac{16(10 - 7s)}{729},\n$$\n因此\n$$\n\\ell_{b,\\min} = \\frac{27}{16}\\,g(x^{\\star}) = \\frac{10 - 7\\sqrt{7}}{27}.\n$$\n因此在 $[\\frac{1}{3},1]$ 上，\n$$\n\\max \\Lambda_{3}(x) = 1 - 2\\,\\ell_{b,\\min} = 1 - \\frac{2(10 - 7\\sqrt{7})}{27} = \\frac{7 + 14\\sqrt{7}}{27}.\n$$\n这个值超过了 $\\frac{5}{4}$，所以等距节点的 Lebesgue 常数为\n$$\n\\max_{x \\in [-1,1]} \\Lambda_{3}(x) = \\frac{7 + 14\\sqrt{7}}{27}.\n$$\n\n结论与比较。我们已经确定了 $n=3$ 时 Lebesgue 函数的精确最大值：\n- 等距节点 $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$：$\\max \\Lambda_{3}(x) = \\frac{7 + 14\\sqrt{7}}{27}$。\n- Chebyshev–Lobatto 节点 $\\{-1,-\\frac{1}{2},\\frac{1}{2},1\\}$：$\\max \\Lambda_{3}(x) = \\frac{5}{3}$。\n\n这两个值在数量级上很接近。对于这个低次数，等距节点集产生了略小的 Lebesgue 常数，而对于更高次数，已知 Chebyshev 族在稳定性方面表现出渐近更优的行为，这体现在 Lebesgue 常数的增长上。按要求的顺序将两个最大值以行矩阵形式报告，即可完成计算。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7\\left(1+2\\sqrt{7}\\right)}{27}  \\frac{5}{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "这项高级实践从理论分析走向实际实现，这是计算科学中的关键一步。您将使用高效的重心坐标公式，在嵌套网格上开发和分析延拓和限制算子，这些算子是诸如 $hp$ 谱元法等高性能自适应算法的基本构建块。",
            "id": "3409351",
            "problem": "要求您形式化、分析并实现用于嵌套 Clenshaw–Curtis 网格之间的延长和限制算子，这些算子使用基于 Lagrange 基和重心基的多项式插值，并适用于 $hp$-自适应谱元代码。您必须从第一性原理推导这些算子，并以多项式插值和节点基的核心定义以及 Clenshaw–Curtis 横坐标点的嵌套性质为推理依据。\n\n令 $[-1,1]$ 为参考单元。对于一个层级 $L \\in \\mathbb{N}$，定义具有 $N_L = 2^L$ 的 Clenshaw–Curtis 网格为节点集 $x_k^{(L)} = \\cos\\left(\\pi k / N_L\\right)$，其中 $k \\in \\{0,1,\\dots,N_L\\}$。这些集合是嵌套的，即 $x_{2k}^{(L+1)} = x_k^{(L)}$。考虑与这些节点相关的 Lagrange 插值基 $\\{\\ell_j^{(L)}(x)\\}_{j=0}^{N_L}$，使得在节点上匹配数据 $u^{(L)} \\in \\mathbb{R}^{N_L+1}$ 的次数至多为 $N_L$ 的多项式插值函数 $p^{(L)}(x)$ 为\n$$\np^{(L)}(x) = \\sum_{j=0}^{N_L} u^{(L)}_j \\, \\ell_j^{(L)}(x),\n$$\n其中对于所有 $i,j$，有 $\\ell_j^{(L)}(x_i^{(L)}) = \\delta_{ij}$。\n\n在目标点 $y \\in [-1,1]$ 处，Lagrange 插值函数的第一重心形式为\n$$\np^{(L)}(y) = \\frac{\\displaystyle \\sum_{j=0}^{N_L} \\frac{w_j^{(L)} \\, u_j^{(L)}}{y - x_j^{(L)}}}{\\displaystyle \\sum_{j=0}^{N_L} \\frac{w_j^{(L)}}{y - x_j^{(L)}}},\n$$\n其中，Clenshaw–Curtis 节点（第二类 Chebyshev 点）的重心权 $w_j^{(L)}$ 为\n$$\nw_j^{(L)} = (-1)^j \\cdot \\gamma_j, \\quad \\gamma_j = \\begin{cases} \\tfrac{1}{2},  j \\in \\{0,N_L\\}, \\\\ 1,  \\text{otherwise.}\\end{cases}\n$$\n这些权重在相差一个公共（非零）缩放因子的情况下是确定的，并且可以稳健地计算。\n\n任务 A（算子构造）：将从层级 $L$ 到层级 $L+1$ 的延长算子定义为矩阵 $P^{L \\to L+1} \\in \\mathbb{R}^{(N_{L+1}+1)\\times(N_L+1)}$，其 $(i,j)$ 元为 $\\ell_j^{(L)}(x_i^{(L+1)})$，这样给定粗网格节点数据 $u^{(L)}$，细网格节点数据为 $u^{(L+1)} = P^{L \\to L+1} \\, u^{(L)}$。使用重心形式高效地计算 $\\ell_j^{(L)}(x_i^{(L+1)})$。利用嵌套性，通过精确注入处理“偶数索引”目标点 $x_{2k}^{(L+1)}$，并仅对“奇数索引”目标点 $x_{2k+1}^{(L+1)}$ 使用重心计算。提出一种跨越 p-加密的重心权增量更新策略，该策略避免对持久节点进行重新计算，并且每个新引入的节点仅需 $O(1)$ 的工作量，并以此论证如何在多个 $hp$-自适应步骤中维护权重。\n\n任务 B（作为稳定左逆的限制）：将限制算子 $R^{L+1 \\to L} \\in \\mathbb{R}^{(N_L+1)\\times(N_{L+1}+1)}$ 定义为延长映射关于细网格上离散欧几里得内积的最小二乘左逆。即，设\n$$\nR^{L+1 \\to L} = \\left((P^{L \\to L+1})^\\top P^{L \\to L+1}\\right)^{-1} (P^{L \\to L+1})^\\top,\n$$\n这样对于任何粗网格向量 $u^{(L)}$，都有 $R^{L+1 \\to L} P^{L \\to L+1} u^{(L)} = u^{(L)}$。讨论该选择与谱元法中的投影有何关系，以及它在概念上与使用求积加权内积相比如何。\n\n任务 C（复杂度和稳定性分析）：从 Lagrange 插值、重心公式和嵌套 Clenshaw–Curtis 网格的定义出发，分析以下操作的算术代价：\n- 用朴素方法以及对偶数索引目标点使用嵌套网格注入法构造 $P^{L \\to L+1}$。\n- 将 $P^{L \\to L+1}$ 和 $R^{L+1 \\to L}$ 应用于向量。\n- 在连续的 p-加密中增量维护重心权。\n讨论在 Chebyshev 类型节点上重心计算的稳定性，并将其与勒贝格函数关联起来\n$$\n\\Lambda^{(L)}(y) = \\sum_{j=0}^{N_L} \\left|\\ell_j^{(L)}(y)\\right|, \\quad \\text{and} \\quad \\|\\Lambda^{(L)}\\|_{\\infty,[-1,1]} = \\max_{y \\in [-1,1]} \\Lambda^{(L)}(y).\n$$\n将此与 $P^{L \\to L+1}$ 在欧几里得范数下的谱条件数以及 $R^{L+1 \\to L} P^{L \\to L+1}$ 与单位矩阵的偏差联系起来。\n\n您必须编写一个程序，该程序：\n- 如上所述，使用重心公式并对偶数索引目标点进行注入来构造 $P^{L \\to L+1}$。\n- 将 $R^{L+1 \\to L}$ 构造为上面定义的稳定左逆。\n- 对于每个测试用例，计算：\n  1. 谱条件数 $\\kappa_2(P^{L \\to L+1})$。\n  2. 勒贝格函数在细网格节点上的最大值，即 $\\max_i \\sum_{j=0}^{N_L} |\\ell_j^{(L)}(x_i^{(L+1)})|$。\n  3. $R^{L+1 \\to L} P^{L+1 \\to L} - I_{N_L+1}$ 的最大绝对值元素。\n\n测试套件：\n- 用例 1：$(L_{\\text{coarse}}, L_{\\text{fine}}) = (2, 3)$，因此 $N_2 = 4$ 且 $N_3 = 8$。\n- 用例 2：$(L_{\\text{coarse}}, L_{\\text{fine}}) = (3, 4)$，因此 $N_3 = 8$ 且 $N_4 = 16$。\n- 用例 3：$(L_{\\text{coarse}}, L_{\\text{fine}}) = (0, 1)$，因此 $N_0 = 1$ 且 $N_1 = 2$。\n\ncosine 的角参数必须以弧度为单位。不涉及物理单位。对于每个用例，您的程序必须输出一个包含三个浮点数的列表，每个数四舍五入到 $10$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有用例的结果，格式为逗号分隔的列表的列表，每个内部列表按 $[\\kappa_2(P^{L \\to L+1}), \\max \\Lambda^{(L)}(x_i^{(L+1)}), \\|R^{L+1 \\to L} P^{L \\to L+1} - I\\|_{\\max}]$ 的顺序排列。例如：\n\"[ [1.234,2.345,0.0], [ ... ], [ ... ] ]\".",
            "solution": "对问题陈述进行了严格审查，并确认其有效性。它在科学上基于已建立的数值分析理论，特别是 Chebyshev 网格上的多项式插值。其定义是标准的，问题是适定的、自洽的，并且在实现和分析数值算子方面提出了一个不平凡的挑战。\n\n解决方案的结构旨在解决三个任务：(A) 算子构造，(B) 限制算子的性质，以及 (C) 复杂度和稳定性分析。\n\n一个参考层级 $L$ 定义了一个包含 $N_L+1$ 个点的 Clenshaw–Curtis 网格，其中 $N_L=2^L$。网格点为 $x_k^{(L)} = \\cos(\\frac{\\pi k}{N_L})$，其中 $k \\in \\{0, 1, \\dots, N_L\\}$。这些网格的一个关键属性是它们的嵌套性：层级 $L$ 的网格是层级 $L+1$ 网格的子集。具体来说，对于 $k \\in \\{0, \\dots, N_L\\}$，有 $x_{2k}^{(L+1)} = \\cos(\\frac{\\pi (2k)}{N_{L+1}}) = \\cos(\\frac{2\\pi k}{2N_L}) = \\cos(\\frac{\\pi k}{N_L}) = x_k^{(L)}$。\n\n延长算子 $P^{L \\to L+1} \\in \\mathbb{R}^{(N_{L+1}+1)\\times(N_L+1)}$ 将节点值从粗网格（层级 $L$）映射到细网格（层级 $L+1$）。它通过在细网格节点上计算粗网格插值函数来定义。该矩阵的 $(i,j)$ 元由 $P_{ij} = \\ell_j^{(L)}(x_i^{(L+1)})$ 给出，其中 $\\{\\ell_j^{(L)}\\}_{j=0}^{N_L}$ 是粗网格的 Lagrange 基多项式族。\n\n### 任务 A：算子构造\n\n$P^{L \\to L+1}$ 的构造涉及在细网格点 $x_i^{(L+1)}$ 上计算 Lagrange 基多项式 $\\ell_j^{(L)}(x)$。直接计算 Lagrange 乘积公式在数值上是不稳定的。第一重心公式提供了一种稳定且高效的替代方法。对于一组通用的节点值 $\\{u_j\\}$，插值函数为 $p^{(L)}(y) = \\left(\\sum_{j=0}^{N_L} \\frac{w_j^{(L)} u_j}{y - x_j^{(L)}}\\right) / \\left(\\sum_{j=0}^{N_L} \\frac{w_j^{(L)}}{y - x_j^{(L)}}\\right)$。\n\n为了找到单个基多项式 $\\ell_j^{(L)}(y)$ 的值，我们将节点数据设为 $u_k = \\delta_{jk}$。这将公式简化为：\n$$\n\\ell_j^{(L)}(y) = \\frac{\\frac{w_j^{(L)}}{y - x_j^{(L)}}}{\\sum_{k=0}^{N_L} \\frac{w_k^{(L)}}{y - x_k^{(L)}}}\n$$\nClenshaw–Curtis 节点 $x_j^{(L)}$ 的重心权由 $w_j^{(L)} = (-1)^j \\gamma_j$ 给出，其中当 $j \\in \\{0, N_L\\}$ 时 $\\gamma_j = 1/2$，否则 $\\gamma_j = 1$。\n\n通过利用网格的嵌套性，可以优化矩阵 $P^{L \\to L+1}$ 的构造。$P$ 的行对应于细网格节点 $x_i^{(L+1)}$。\n\n1.  **偶数索引的细网格节点：** 对于 $i=2k$，其中 $k \\in \\{0, \\dots, N_L\\}$，细网格节点与粗网格节点相同：$x_{2k}^{(L+1)} = x_k^{(L)}$。根据定义，Lagrange 基多项式的求值是平凡的：\n    $$\n    P_{2k, j} = \\ell_j^{(L)}(x_{2k}^{(L+1)}) = \\ell_j^{(L)}(x_k^{(L)}) = \\delta_{jk}\n    $$\n    这意味着 $P^{L \\to L+1}$ 的偶数索引行对应于从粗网格节点索引到细网格节点索引子集的恒等映射（注入）。$P$ 的第 $2k$ 行在第 $k$ 列包含一个 $1$，其他位置为零。\n\n2.  **奇数索引的细网格节点：** 对于 $i=2k+1$，其中 $k \\in \\{0, \\dots, N_L-1\\}$，细网格节点 $y = x_{2k+1}^{(L+1)}$ 不与任何粗网格节点 $x_j^{(L)}$ 重合。对于这些行，我们必须使用重心公式计算每个元素 $P_{i,j}$：\n    $$\n    P_{2k+1, j} = \\ell_j^{(L)}(x_{2k+1}^{(L+1)}) = \\frac{\\frac{w_j^{(L)}}{x_{2k+1}^{(L+1)} - x_j^{(L)}}}{\\sum_{m=0}^{N_L} \\frac{w_m^{(L)}}{x_{2k+1}^{(L+1)} - x_m^{(L)}}}\n    $$\n    对每个目标点 $y=x_{2k+1}^{(L+1)}$ 和每个基函数索引 $j \\in \\{0, \\dots, N_L\\}$ 执行此计算。\n\n关于用于 $hp$-自适应的重心权增量更新：给定的公式 $w_j^{(L)} = (-1)^j \\gamma_j$ 非常简单。为层级 $L$ 的网格计算所有 $N_L+1$ 个权重的成本是 $O(N_L)$。在实际的 $hp$-代码中，不同单元可能具有不同的多项式次数（因此层级 $L$ 也不同），最实用的策略是预先计算并存储所有预期层级的权重。鉴于其计算和存储成本低，从层级 $L$ 到 $L+1$ 的“增量更新”是不必要的，并且比直接使用所需层级的闭式表达式效率更低。“增量更新”的概念对于权重通过乘积定义的一般节点集更为相关，但对于 Clenshaw-Curtis 节点，直接重新计算更优。\n\n### 任务 B：作为稳定左逆的限制\n\n限制算子 $R^{L+1 \\to L}$ 被定义为 $P^{L \\to L+1}$ 的 Moore-Penrose 伪逆：\n$$\nR^{L+1 \\to L} = \\left((P^{L \\to L+1})^\\top P^{L \\to L+1}\\right)^{-1} (P^{L \\to L+1})^\\top\n$$\n由于 $P^{L \\to L+1}$ 的列是线性无关的（因为它们代表在足够稠密的网格上采样的不同 Lagrange 基多项式），矩阵 $(P^{L \\to L+1})^\\top P^{L \\to L+1}$ 是可逆的，并且 $R^{L+1 \\to L}$ 是一个适定的左逆，意味着 $R^{L+1 \\to L} P^{L \\to L+1} = I_{N_L+1}$。\n\n给定细网格数据 $u^{(L+1)}$，应用限制算子 $u^{(L)} = R^{L+1 \\to L} u^{(L+1)}$，可以找到使欧几里得距离 $\\|P^{L \\to L+1} u^{(L)} - u^{(L+1)}\\|_2^2$ 最小化的粗网格数据 $u^{(L)}$。这对应于在由粗网格基函数张成的子空间中寻找细网格数据的最佳逼近，其中“最佳”是在关于细网格节点值向量的标准欧几里得内积的最小二乘投影意义上定义的。\n\n这个选择与使用求积加权内积定义的投影形成对比。在谱元法中，人们经常使用近似连续 $L^2([-1,1])$ 内积 $\\langle f,g \\rangle = \\int_{-1}^1 f(x)g(x)dx$ 的内积。这样的内积可以离散化为 $\\langle u,v \\rangle_W = u^\\top W v$，其中 $W$ 是 Clenshaw-Curtis 求积权重的对角矩阵。相应的限制算子将是 $R_W = (P^\\top W P)^{-1} P^\\top W$。问题中定义的算子 $R$ 使用 $W=I$，即单位矩阵。这是一个代数投影，而不是连续函数空间投影的近似。它的优点是概念简单，并且不依赖于求积规则的细节，从而在纯代数意义上确保了稳定性。\n\n### 任务 C：复杂度和稳定性分析\n\n**复杂度：**\n- **$P^{L \\to L+1}$ 的构造：**\n    - 使用优化方法，大约 $N_L/2$ 个偶数索引行可在 $O(N_L)$ 的总时间内填充。\n    - 对于 $N_L$ 个奇数索引行中的每一行，我们计算一个分母和，需要 $O(N_L)$ 次运算。然后，该行中的 $N_L+1$ 个元素每个需要 $O(1)$ 的工作量。一个奇数行的总工作量是 $O(N_L)$。对于 $N_L$ 个这样的行，复杂度是 $O(N_L^2)$。\n    - 因此，总的构造代价是 $O(N_L^2)$，或者等价地是 $O((N_{L+1})^2)$，因为 $N_{L+1}=2N_L$。\n- **算子的应用：**\n    - 将大小为 $(N_{L+1}+1)\\times(N_L+1)$ 的 $P^{L \\to L+1}$ 应用于一个向量，是一个矩阵向量乘积，代价为 $O(N_{L+1} \\cdot N_L) = O(N_L^2)$。\n    - 将大小为 $(N_L+1)\\times(N_{L+1}+1)$ 的 $R^{L+1 \\to L}$ 应用于一个向量，代价也为 $O(N_L \\cdot N_{L+1}) = O(N_L^2)$。\n- **权重维护：** 如前所述，使用闭式公式计算层级 $L$ 网格的所有权重是一个 $O(N_L)$ 的操作。\n\n**稳定性：**\n- **勒贝格函数：** 多项式插值的稳定性由勒贝格常数来表征。值 $\\max_i \\Lambda^{(L)}(x_i^{(L+1)}) = \\max_i \\sum_{j=0}^{N_L} |\\ell_j^{(L)}(x_i^{(L+1)})|$ 正是矩阵 $P^{L \\to L+1}$ 的无穷范数，即 $\\|P^{L \\to L+1}\\|_\\infty$。对于 Clenshaw-Curtis 节点，勒贝格常数增长非常缓慢，为 $O(\\log N_L)$，这表明其具有出色的稳定性。这种缓慢的增长确保了插值过程不会过度放大输入数据中的误差。\n- **条件数：** 谱条件数 $\\kappa_2(P^{L \\to L+1})$ 衡量了插值映射 $P^{L \\to L+1}$ 对扰动的敏感性。小的条件数（接近于 $1$）是理想的。$\\kappa_2(P)$ 的值与 $P$ 的最小和最大奇异值有关，而这些奇异值又反映了基函数在细网格上采样时的近正交性。\n- **投影误差：** 矩阵 $R^{L+1 \\to L} P^{L \\to L+1} - I_{N_L+1}$ 理想情况下应为零矩阵。在浮点运算中，其非零项源于矩阵求逆和乘法过程中的数值舍入误差。该矩阵的最大绝对值元素 $\\|R P - I\\|_{\\max}$，可作为衡量形成伪逆并验证左逆性质整个过程数值稳定性的实用指标。一个较小的值表明过程是良态的。",
            "answer": "[[1.3255319532, 1.4142135624, 0.0], [1.3486303352, 1.4142135624, 0.0], [1.2247448714, 1.0, 0.0]]"
        }
    ]
}