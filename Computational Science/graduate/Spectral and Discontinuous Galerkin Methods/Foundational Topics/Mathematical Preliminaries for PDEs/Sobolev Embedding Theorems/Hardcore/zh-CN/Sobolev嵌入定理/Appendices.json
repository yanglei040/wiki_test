{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的高维定理之前，从第一性原理出发，亲手推导一个基本结论是巩固理解的关键一步。本练习将引导你证明一个基础的一维Sobolev嵌入，即从 $H^1((0,1))$ 到Hölder连续函数空间 $C^{0,1/2}((0,1))$ 的嵌入，并找出其精确的最佳嵌入常数 。通过仅运用微积分基本定理和柯西-施瓦茨不等式，你将具体地体会到，对函数导数在积分意义下（$L^2$ 范数）的控制，是如何转化为对其逐点振荡行为（Hölder半范数）的约束。",
            "id": "3414907",
            "problem": "设 $\\Omega = (0,1)$，考虑 Sobolev 空间 $H^{1}(\\Omega)$ 和 Hölder 空间 $C^{0,\\alpha}(\\Omega)$，其中指数 $\\alpha \\in (0,1)$。对于一个函数 $f \\in C^{0,\\alpha}(\\Omega)$，定义 Hölder 半范数\n$$\n[f]_{C^{0,\\alpha}(\\Omega)} := \\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{\\alpha}}.\n$$\n在谱方法和间断 Galerkin (DG) 方法的背景下，尖锐嵌入常数用平方可积梯度来控制逐点振荡，并直接影响先验误差估计。假设仅使用 $H^{1}(\\Omega)$ 中函数的基本性质、微积分基本定理和经典不等式。使用对 $H^{1}(\\Omega)$ 函数有效的积分表示和第一性原理推导，确定最小的常数 $C_{\\ast}$，使得不等式\n$$\n[f]_{C^{0,1/2}(\\Omega)} \\leq C_{\\ast} \\,\\|f'\\|_{L^{2}(\\Omega)}\n$$\n对所有 $f \\in H^{1}(\\Omega)$ 均成立。然后，将您得到的一维显式常数与一般 $n$ 维 Morrey 型估计在 $n=1, p=2$ 的单位区间上的特例所预测的标度进行简要比较，但最终答案只需报告 $C_{\\ast}$ 的值。无需四舍五入，也不涉及物理单位。请给出 $C_{\\ast}$ 的精确值。",
            "solution": "该问题要求找到 Sobolev 空间 $H^{1}(\\Omega)$ 嵌入到 Hölder 空间 $C^{0,1/2}(\\Omega)$（在定义域 $\\Omega = (0,1)$上）的最小常数 $C_{\\ast}$，即所谓的尖锐常数。所讨论的不等式为：\n$$\n[f]_{C^{0,1/2}(\\Omega)} \\leq C_{\\ast} \\,\\|f'\\|_{L^{2}(\\Omega)}\n$$\n对所有函数 $f \\in H^{1}(\\Omega)$ 成立，其中 $f'$ 表示 $f$ 的弱导数。Hölder 半范数定义为：\n$$\n[f]_{C^{0,1/2}(\\Omega)} := \\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{1/2}}\n$$\n$L^{2}(\\Omega)$ 中的范数是 $\\|f'\\|_{L^{2}(\\Omega)} = \\left(\\int_{0}^{1} |f'(t)|^2 \\, dt\\right)^{1/2}$。\n\n尖锐常数 $C_{\\ast}$ 是对所有允许的函数取左侧与右侧之比的上确界：\n$$\nC_{\\ast} = \\sup_{f \\in H^{1}(\\Omega), f' \\not\\equiv 0} \\frac{[f]_{C^{0,1/2}(\\Omega)}}{\\|f'\\|_{L^{2}(\\Omega)}}\n$$\n我们将分两步来确定 $C_{\\ast}$：首先，找到该常数的一个上界；其次，证明该上界可以达到或任意逼近。\n\n第一步：推导 $C_{\\ast}$ 的一个上界。\n\n设 $f \\in H^{1}(\\Omega)$。一维区间上的 $H^{1}$ 函数是绝对连续的。因此，对于任意两点 $x, y \\in \\Omega$，我们可以使用微积分基本定理写出：\n$$\nf(x) - f(y) = \\int_{y}^{x} f'(t) \\, dt\n$$\n不失一般性，设 $x > y$。取绝对值，我们得到：\n$$\n|f(x) - f(y)| = \\left| \\int_{y}^{x} f'(t) \\, dt \\right| = \\left| \\int_{y}^{x} 1 \\cdot f'(t) \\, dt \\right|\n$$\n我们对右侧的表达式应用积分形式的 Cauchy-Schwarz 不等式：\n$$\n\\left| \\int_{y}^{x} 1 \\cdot f'(t) \\, dt \\right| \\leq \\left( \\int_{y}^{x} 1^2 \\, dt \\right)^{1/2} \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\n化简后得到：\n$$\n|f(x) - f(y)| \\leq (x-y)^{1/2} \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\n两边同除以 $|x-y|^{1/2} = (x-y)^{1/2}$ (因为 $x \\neq y$)，我们得到：\n$$\n\\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\n在子区间 $[y, x]$ 上的积分受限于在整个定义域 $\\Omega = (0,1)$ 上的积分：\n$$\n\\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2} \\leq \\left( \\int_{0}^{1} |f'(t)|^2 \\, dt \\right)^{1/2} = \\|f'\\|_{L^{2}(\\Omega)}\n$$\n结合这些不等式，我们有对于任意一对 $x, y \\in \\Omega$ 且 $x \\neq y$：\n$$\n\\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\|f'\\|_{L^{2}(\\Omega)}\n$$\n由于这对所有这样的点对都成立，我们可以对所有 $x, y \\in \\Omega$ 且 $x \\neq y$ 取上确界：\n$$\n\\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\|f'\\|_{L^{2}(\\Omega)}\n$$\n这等价于 $[f]_{C^{0,1/2}(\\Omega)} \\leq 1 \\cdot \\|f'\\|_{L^{2}(\\Omega)}$。这个不等式表明常数 $C_{\\ast}$ 必须小于或等于 $1$，即 $C_{\\ast} \\leq 1$。\n\n第二步：证明该上界是尖锐的。\n\n为了证明 $C_{\\ast} = 1$，我们必须证明 $C_{\\ast} \\ge 1$。我们可以通过构造一个函数序列 $f_k \\in H^1(\\Omega)$，使得比值 $\\frac{[f_k]_{C^{0,1/2}(\\Omega)}}{\\|f_k'\\|_{L^2(\\Omega)}}$ 趋近于 $1$，或者通过找到一个使该比值恰好为 $1$ 的函数来实现。\n\n我们选择一个任意子区间 $(a,b) \\subset \\Omega = (0,1)$，其中 $0  a  b  1$。考虑一个函数 $f \\in H^{1}(\\Omega)$，其弱导数 $f'(t)$ 是该区间的特征函数：\n$$\nf'(t) = \\chi_{(a,b)}(t) = \\begin{cases} 1  \\text{if } t \\in (a,b) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n函数 $f'$ 属于 $L^{2}(\\Omega)$。一个原函数是 $f(x) = \\int_0^x f'(t)\\,dt$，它是一个连续的分段线性函数，因此属于 $H^1(\\Omega)$。\n\n我们来计算 $f'$ 的 $L^{2}$-范数：\n$$\n\\|f'\\|_{L^{2}(\\Omega)}^2 = \\int_{0}^{1} |f'(t)|^2 \\, dt = \\int_{a}^{b} 1^2 \\, dt = b-a\n$$\n因此，$\\|f'\\|_{L^{2}(\\Omega)} = \\sqrt{b-a}$。\n\n现在，我们来计算 Hölder 半范数 $[f]_{C^{0,1/2}(\\Omega)}$。对于任意 $x, y \\in \\Omega$ 且 $x>y$：\n$$\n\\frac{|f(x)-f(y)|}{|x-y|^{1/2}} = \\frac{|\\int_y^x f'(t)\\,dt|}{|x-y|^{1/2}} = \\frac{\\int_y^x \\chi_{(a,b)}(t)\\,dt}{\\sqrt{x-y}} = \\frac{\\text{length}((y,x) \\cap (a,b))}{\\sqrt{x-y}}\n$$\n从第一步可知，这个量受 $(\\int_y^x |f'(t)|^2 dt)^{1/2} = \\sqrt{\\text{length}((y,x) \\cap (a,b))}$ 的限制。令 $L_{int} = \\text{length}((y,x))$ 和 $L_{cap} = \\text{length}((y,x) \\cap (a,b))$。这个量就是 $L_{cap}/\\sqrt{L_{int}}$。\n\n我们对 $x=b$ 和 $y=a$ 的特定选择来计算这个值。我们有：\n$$\n\\frac{|f(b)-f(a)|}{|b-a|^{1/2}} = \\frac{\\int_a^b 1 \\, dt}{\\sqrt{b-a}} = \\frac{b-a}{\\sqrt{b-a}} = \\sqrt{b-a}\n$$\n为了求半范数，我们需要对所有点对取上确界。我们来分析函数 $g(x,y) = \\frac{\\text{length}((y,x) \\cap (a,b))}{\\sqrt{x-y}}$。\n如果我们选择区间 $(y,x)$ 恰好为 $(a,b)$，我们已经证明了其值为 $\\sqrt{b-a}$。\n如果我们选择一个区间 $(y,x)$ 是 $(a,b)$ 的子集，那么 $\\text{length}((y,x) \\cap (a,b)) = x-y$。其值为 $\\frac{x-y}{\\sqrt{x-y}} = \\sqrt{x-y}$，当 $x-y$ 尽可能大时，即 $x-y \\to b-a$ 时，该值最大化。\n如果我们选择一个包含 $(a,b)$ 的区间 $(y,x)$，那么 $\\text{length}((y,x) \\cap (a,b)) = b-a$。其值为 $\\frac{b-a}{\\sqrt{x-y}}$。当 $x-y$ 最小时，即当 $(y,x)$ 恰好是 $(a,b)$ 时，该值最大化，使得其值为 $\\frac{b-a}{\\sqrt{b-a}} = \\sqrt{b-a}$。\n更形式化的论证可以证实上确界确实是 $\\sqrt{b-a}$。\n所以，对于这个函数 $f$，我们有 $[f]_{C^{0,1/2}(\\Omega)} = \\sqrt{b-a}$。\n\n现在我们可以计算这个特定函数的比值：\n$$\n\\frac{[f]_{C^{0,1/2}(\\Omega)}}{\\|f'\\|_{L^{2}(\\Omega)}} = \\frac{\\sqrt{b-a}}{\\sqrt{b-a}} = 1\n$$\n由于我们找到了一个非平凡函数 $f \\in H^{1}(\\Omega)$ 使其比值恰好为 $1$，对所有这类函数的上确界必须至少为 $1$。因此，$C_{\\ast} \\ge 1$。\n\n结合我们的两个发现，$C_{\\ast} \\leq 1$ 和 $C_{\\ast} \\ge 1$，我们得出结论，尖锐常数恰好是 $1$。\n\n题目还要求与一般 $n$ 维 Morrey 型估计在我们这种情况下的特例进行简要比较。对于 $W^{1,p}(\\Omega)$ 且 $p>n$，嵌入到 $C^{0,\\alpha}(\\overline{\\Omega})$，其中 $\\alpha = 1 - n/p$。对于我们的问题，空间是 $H^1(\\Omega) = W^{1,2}(\\Omega)$，定义域是一维的，所以 $n=1$ 且 $p=2$。条件 $p>n$ 得到满足，因为 $2 > 1$。预测的 Hölder 指数是 $\\alpha = 1 - 1/2 = 1/2$，这与题目陈述相符。在第一步中进行的，使用微积分基本定理和 Cauchy-Schwarz 不等式的直接推导，是证明 Morrey 不等式一维情形的标准方法。该方法直接得出常数 $C=1$。我们在第二步中发现该常数是尖锐的，这表明对于这个特定情况（$n=1, p=2, \\Omega=(0,1)$），用于一般性定理的最简单证明技巧恰好得出了最优常数。\n\n要求的最终答案是 $C_\\ast$ 的值。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在掌握了一维情况下的基础分析之后，我们现在转向周期性定义域上更一般的Sobolev嵌入定理，并通过计算进行探索。该定理指出，当 $s > n/2$ 时，$H^s(\\mathbb{T}^n)$ 连续嵌入到 $L^\\infty(\\mathbb{T}^n)$ 中，这是证明非线性偏微分方程谱方法稳定性的基石。本练习  要求你通过一个数值实验来验证这一定理，将抽象的、基于傅里叶变换的 $H^s$ 范数定义与具体的、逐点的 $L^\\infty$ 范数联系起来。你将研究当光滑度参数 $s$ 处于临界阈值 $n/2$ 上下时嵌入行为的差异，从而对这一关键条件为何如此重要获得直观的感受。",
            "id": "3414954",
            "problem": "考虑周期环（或环面）$\\mathbb{T}^n$，它被等同于带有周期性边界条件且角度以弧度测量的立方体 $[0,2\\pi]^n$。令 $u_N:\\mathbb{T}^n\\to\\mathbb{C}$ 为一个谱近似，由有限傅里叶级数表示：\n$$\nu_N(x)=\\sum_{k\\in I\\subset\\mathbb{Z}^n}\\hat{u}_k\\,e^{i\\,k\\cdot x},\n$$\n其中 $I$ 是多重指标 $k=(k_1,\\dots,k_n)\\in\\mathbb{Z}^n$ 的一个有限指标集，$x=(x_1,\\dots,x_n)\\in\\mathbb{T}^n$，系数 $\\hat{u}_k\\in\\mathbb{C}$ 是与指数基 $e^{i\\,k\\cdot x}$ 相关联的归一化傅里叶系数。在谱方法和间断 Galerkin (DG) 方法的背景下，一致范数（本质上确界范数）的界被用来控制非线性通量和混叠，而当 $s > \\frac{n}{2}$ 时，Sobolev 嵌入定理提供了必要的估计。\n\n从基本原理出发，使用 Sobolev 空间 $H^s(\\mathbb{T}^n)$ 的定义和 Cauchy–Schwarz 不等式，将 $u_N$ 的 $H^s$ 范数与一个一致范数（本质上确界）界联系起来。具体来说：\n\n- Sobolev 范数 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ 是通过傅里叶系数 $\\hat{u}_k$ 定义的。\n- 一致界 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ 必须通过在 $\\mathbb{T}^n$ 上的一个均匀网格上计算 $u_N$ 并取其最大绝对值来数值地获得。网格分辨率必须足够高以捕捉到上确界；对于一维空间，每个维度使用 $M=4096$ 个网格点，对于二维空间，每个维度使用 $M=512$ 个网格点。\n- 基于嵌入的界是通过应用带有权重 $(1+|k|^2)^{s}$ 的 Cauchy–Schwarz 不等式获得的，其中 $|k|$ 表示 $\\mathbb{R}^n$ 中的欧几里得范数。这将产生一个界，其常数可以通过将完整指标格点截断为对每个分量 $i\\in\\{1,\\dots,n\\}$ 都有 $|k_i|\\leq K_{\\max}$ 来近似。\n\n您的任务是 (i) 从给定的有限傅里叶系数集计算 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，(ii) 通过在均匀网格上采样计算 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ 的数值近似，(iii) 计算一个基于嵌入的界 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq C_{s,n}(K_{\\max})\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，其中\n$$\nC_{s,n}(K_{\\max})=\\left(\\sum_{k\\in\\mathbb{Z}^n,\\;|k_i|\\leq K_{\\max}}\\frac{1}{(1+|k|^2)^s}\\right)^{1/2},\n$$\n以及 (iv) 对每个测试用例数值地验证该不等式。此外，仅使用有限指标集 $I$ 计算精确的指标集界，\n$$\nC_{s,n}(I)=\\left(\\sum_{k\\in I}\\frac{1}{(1+|k|^2)^s}\\right)^{1/2},\n$$\n并验证 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq C_{s,n}(I)\\|u_N\\|_{H^s(\\mathbb{T}^n)}$。\n\n采用以下基本基础：\n- $\\mathbb{T}^n$ 上的傅里叶表示、归一化的傅里叶系数和欧几里得范数 $|k|$。\n- 通过 $\\mathbb{T}^n$ 上的傅里叶系数定义 Sobolev 空间，即由 $(1+|k|^2)^s|\\hat{u}_k|^2$ 的平方可和性定义的 $H^s(\\mathbb{T}^n)$。\n- 应用于由 $k\\in\\mathbb{Z}^n$ 索引的序列的 $\\ell^2$ 空间中的 Cauchy–Schwarz 不等式。\n\n您必须实现一个程序，对于每个测试用例，输出：\n- Sobolev 范数 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，作为一个浮点数。\n- 数值计算的一致范数 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$，作为一个浮点数。\n- 截断格点嵌入界 $B_{\\text{trunc}}=C_{s,n}(K_{\\max})\\,\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，作为一个浮点数。\n- 一个布尔值，指示 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq B_{\\text{trunc}}$ 是否在数值上成立。\n- 有限指标集界 $B_{I}=C_{s,n}(I)\\,\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，作为一个浮点数。\n- 一个布尔值，指示 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq B_{I}$ 是否在数值上成立。\n\n使用以下参数值的测试套件，它涵盖了 $s > \\frac{n}{2}$、边界 $s=\\frac{n}{2}$ 和 $s  \\frac{n}{2}$ 的情况，以及一维和二维两种情况：\n- 测试用例 1：$n=1$，$s=1.0$，$K_{\\max}=64$，指标集 $I=\\{k\\in\\mathbb{Z}:k\\in\\{-2,-1,1,2\\}\\}$，系数为 $\\hat{u}_{-2}=\\hat{u}_{2}=0.25$，$\\hat{u}_{-1}=\\hat{u}_{1}=0.5$。\n- 测试用例 2：$n=2$，$s=1.2$，$K_{\\max}=32$，指标集 $I=\\{(-2,0),(-1,0),(0,-1),(0,1),(1,0),(1,1),(-1,-1),(2,0)\\}$，系数为 $\\hat{u}_{-2,0}=\\hat{u}_{2,0}=0.05$，$\\hat{u}_{-1,0}=\\hat{u}_{1,0}=0.3$，$\\hat{u}_{0,-1}=\\hat{u}_{0,1}=0.2$，$\\hat{u}_{1,1}=\\hat{u}_{-1,-1}=0.1$。\n- 测试用例 3：$n=1$，$s=0.5$，$K_{\\max}=64$，指标集 $I=\\{(-10),(-3),(-1),(1),(3),(10)\\}$，系数为 $\\hat{u}_{-10}=\\hat{u}_{10}=0.02$，$\\hat{u}_{-3}=\\hat{u}_{3}=0.1$，$\\hat{u}_{-1}=\\hat{u}_{1}=0.7$。\n- 测试用例 4：$n=2$，$s=0.4$，$K_{\\max}=32$，指标集 $I=\\{(-5,0),(-1,-2),(0,-5),(0,5),(1,2),(5,0)\\}$，系数为 $\\hat{u}_{-5,0}=\\hat{u}_{5,0}=0.05$，$\\hat{u}_{0,-5}=\\hat{u}_{0,5}=0.05$，$\\hat{u}_{1,2}=\\hat{u}_{-1,-2}=0.03$。\n\n对于每个用例，程序必须：\n- 计算 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}=\\left(\\sum_{k\\in I}(1+|k|^2)^s\\,|\\hat{u}_k|^2\\right)^{1/2}$。\n- 通过在每个维度有 $M$ 个点（$n=1$ 时使用 $M=4096$，$n=2$ 时使用 $M=512$）的均匀网格上对 $u_N$ 进行采样，并取网格上 $|u_N(x)|$ 的最大值来计算 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$。\n- 通过在截断的格点 $\\{k\\in\\mathbb{Z}^n:\\ |k_i|\\leq K_{\\max}\\}$ 上求和来计算 $C_{s,n}(K_{\\max})$。\n- 仅在给定的指标集 $I$ 上求和来计算 $C_{s,n}(I)$。\n\n您的程序应生成单行输出，其中包含一个以方括号括起来的、逗号分隔的列表的列表（例如，$[\\,[r_{11},r_{12},\\dots],\\,[r_{21},r_{22},\\dots]\\,]$），其中每个内部列表对应一个测试用例，并完全按照以下顺序包含六个条目：$\\|u_N\\|_{H^s}$ (浮点数), $\\|u_N\\|_{L^\\infty}$ (浮点数), $B_{\\text{trunc}}$ (浮点数), 使用 $B_{\\text{trunc}}$ 的不等式是否成立 (布尔值), $B_{I}$ (浮点数), 使用 $B_{I}$ 的不等式是否成立 (布尔值)。",
            "solution": "该问题要求对 $n$ 维环面 $\\mathbb{T}^n$ 上的有限傅里叶级数，对 Sobolev 嵌入定理进行数值研究。我们给定一个由其截断傅里叶级数定义的函数 $u_N(x)$：\n$$\nu_N(x) = \\sum_{k \\in I \\subset \\mathbb{Z}^n} \\hat{u}_k \\, e^{i k \\cdot x}\n$$\n其中 $I$ 是一个整数多重指标的有限集，$\\hat{u}_k$ 是相应的复傅里叶系数。目标是计算与 Sobolev 嵌入 $H^s(\\mathbb{T}^n) \\hookrightarrow L^\\infty(\\mathbb{T}^n)$ 相关的几个量，并数值地验证相关的不等式。\n\n任务的核心依赖于 Sobolev $H^s$ 范数和一致 $L^\\infty$ 范数的定义，以及 Cauchy-Schwarz 不等式的应用。\n\n**1. 范数定义**\n\n对于实数 $s$，Sobolev 空间 $H^s(\\mathbbT}^n)$ 包含环面上的函数，其直到 $s$ 阶的导数是平方可积的。对于一个函数 $u(x) = \\sum_{k \\in \\mathbb{Z}^n} \\hat{u}_k e^{i k \\cdot x}$，其 $H^s$ 范数通过其傅里叶系数定义为：\n$$\n\\|u\\|_{H^s(\\mathbb{T}^n)}^2 = \\sum_{k \\in \\mathbb{Z}^n} (1 + |k|^2)^s |\\hat{u}_k|^2\n$$\n其中 $|k| = \\sqrt{k_1^2 + \\dots + k_n^2}$ 是多重指标 $k$ 的欧几里得范数。这个定义对高频模式（大的 $|k|$）赋予了更重的权重，从而捕捉了函数的光滑性。对于我们的有限傅里叶级数 $u_N(x)$，求和仅限于有限指标集 $I$：\n$$\n\\|u_N\\|_{H^s(\\mathbb{T}^n)} = \\left(\\sum_{k \\in I} (1 + |k|^2)^s |\\hat{u}_k|^2\\right)^{1/2}\n$$\n\n一致范数，或称 $L^\\infty$ 范数，测量函数大小的最大值：\n$$\n\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)} = \\sup_{x \\in \\mathbb{T}^n} |u_N(x)|\n$$\n在数值上，这个值通过在环面 $\\mathbb{T}^n \\cong [0, 2\\pi]^n$ 上的一个精细的、$M^n$ 个点的均匀网格上计算 $|u_N(x)|$ 并找到最大值来近似。\n\n**2. Sobolev 嵌入与 Cauchy-Schwarz 不等式**\n\nSobolev 嵌入定理指出，对于 $s > n/2$，空间 $H^s(\\mathbb{T}^n)$ 连续地嵌入到连续函数空间中，这意味着存在一个常数 $C$，使得对于所有 $u \\in H^s(\\mathbb{T}^n)$，都有 $\\|u\\|_{L^\\infty} \\leq C \\|u\\|_{H^s}$。我们可以直接从 Cauchy-Schwarz 不等式为我们的函数 $u_N$ 推导出这个不等式的一个具体实例。\n\n考虑 $u_N(x)$ 的表达式。我们可以将求和重写为：\n$$\nu_N(x) = \\sum_{k \\in I} \\left( (1+|k|^2)^{s/2} \\hat{u}_k \\right) \\cdot \\left( \\frac{e^{i k \\cdot x}}{(1+|k|^2)^{s/2}} \\right)\n$$\n将 Cauchy-Schwarz 不等式应用于这个和（将其视为序列空间 $\\ell^2(I)$ 中的内积），得到：\n$$\n|u_N(x)|^2 \\leq \\left( \\sum_{k \\in I} \\left| (1+|k|^2)^{s/2} \\hat{u}_k \\right|^2 \\right) \\cdot \\left( \\sum_{k \\in I} \\left| \\frac{e^{i k \\cdot x}}{(1+|k|^2)^{s/2}} \\right|^2 \\right)\n$$\n识别各项，我们将其简化为：\n$$\n|u_N(x)|^2 \\leq \\left( \\sum_{k \\in I} (1+|k|^2)^s |\\hat{u}_k|^2 \\right) \\cdot \\left( \\sum_{k \\in I} \\frac{1}{(1+|k|^2)^s} \\right)\n$$\n右边的第一项恰好是 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}^2$。由于右侧与 $x$ 无关，这个不等式对左侧在所有 $x$ 上的上确界也成立。对两边取平方根，我们得到：\n$$\n\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)} \\leq C_{s,n}(I) \\, \\|u_N\\|_{H^s(\\mathbb{T}^n)}\n$$\n其中常数 $C_{s,n}(I)$ 由下式给出：\n$$\nC_{s,n}(I) = \\left( \\sum_{k \\in I} \\frac{1}{(1+|k|^2)^s} \\right)^{1/2}\n$$\n这个不等式是定义的一个代数结果，对于任何有限傅里叶级数 $u_N$ 都必须成立。这给出了界 $B_I = C_{s,n}(I) \\|u_N\\|_{H^s(\\mathbb{T}^n)}$。\n\n问题还引入了第二个常数 $C_{s,n}(K_{\\max})$，它是通过在一个更大的、规则的模式格点上求和计算得出的：\n$$\nC_{s,n}(K_{\\max}) = \\left(\\sum_{k \\in \\mathbb{Z}^n, \\, |k_i| \\leq K_{\\max}} \\frac{1}{(1+|k|^2)^s} \\right)^{1/2}\n$$\n这个常数近似于真正的嵌入常数 $C_{s,n}(\\infty)$，后者的定义级数仅当 $2s > n$，即 $s > n/2$ 时才收敛。由于每个测试用例的指标集 $I$ 都是由 $K_{\\max}$ 定义的格点的子集，因此 $C_{s,n}(I) \\leq C_{s,n}(K_{\\max})$。因此，界 $B_{\\text{trunc}} = C_{s,n}(K_{\\max}) \\|u_N\\|_{H^s(\\mathbb{T}^n)}$ 比 $B_I$ 更宽松，但也必须成立。\n\n**3. 计算流程**\n\n对每个测试用例，我们执行以下计算：\n1.  **计算 $\\|u_N\\|_{H^s}$**：使用给定的指标集 $I$ 和系数 $\\hat{u}_k$ 直接计算和式 $\\left(\\sum_{k \\in I} (1+|k|^2)^s |\\hat{u}_k|^2\\right)^{1/2}$。\n2.  **计算 $\\|u_N\\|_{L^\\infty}$**：在 $[0, 2\\pi]^n$ 上构建一个每个维度有 $M$ 个点的均匀网格（$n=1$ 时 $M=4096$，$n=2$ 时 $M=512$）。在每个网格点上计算复值函数 $u_N(x)$。为了提高效率，使用了向量化计算，即对于每个模式 $k \\in I$，项 $\\hat{u}_k e^{i k \\cdot x}$ 同时为所有网格点 $x$ 计算。然后对所有模式的结果求和。$L^\\infty$ 范数则由网格上 $|u_N(x)|$ 的最大值 $\\max_x |u_N(x)|$ 来近似。\n3.  **计算 $C_{s,n}(K_{\\max})$ 和 $B_{\\text{trunc}}$**：生成所有整数向量 $k \\in \\mathbb{Z}^n$，使得对所有分量 $i=1,\\dots,n$ 都有 $|k_i| \\leq K_{\\max}$。计算定义 $C_{s,n}(K_{\\max})^2$ 的和，取平方根，然后乘以 $\\|u_N\\|_{H^s}$ 得到 $B_{\\text{trunc}}$。\n4.  **计算 $C_{s,n}(I)$ 和 $B_I$**：在给定的稀疏指标集 $I$ 上计算定义 $C_{s,n}(I)^2$ 的和，取平方根，然后乘以 $\\|u_N\\|_{H^s}$ 得到 $B_I$。\n5.  **验证不等式**：检查数值计算的 $\\|u_N\\|_{L^\\infty}$ 是否小于或等于计算出的界 $B_{\\text{trunc}}$ 和 $B_I$。\n\n选择的测试用例旨在探索嵌入定理成立（$s > n/2$，用例1和2）、处于临界边界（$s=n/2$，用例3）和失效（$s  n/2$，用例4）的场景。对于所有情况，由于 $u_N$ 只有有限数量的模式，它是无限可微的，因此是有界的。无论 $s$ 和 $n$ 的值如何，推导出的涉及 $C_{s,n}(I)$ 和 $C_{s,n}(K_{\\max})$ 的代数不等式都应成立。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Sobolev and uniform norms for finite Fourier series on the torus\n    and verifies the Sobolev embedding inequality numerically.\n    \"\"\"\n    test_cases = [\n        {\n            \"n\": 1, \"s\": 1.0, \"K_max\": 64, \"M\": 4096,\n            \"coeffs\": {(-2,): 0.25, (-1,): 0.5, (1,): 0.5, (2,): 0.25}\n        },\n        {\n            \"n\": 2, \"s\": 1.2, \"K_max\": 32, \"M\": 512,\n            \"coeffs\": {\n                (-2, 0): 0.05, (-1, 0): 0.3, (0, -1): 0.2, (0, 1): 0.2,\n                (1, 0): 0.3, (1, 1): 0.1, (-1, -1): 0.1, (2, 0): 0.05\n            }\n        },\n        {\n            \"n\": 1, \"s\": 0.5, \"K_max\": 64, \"M\": 4096,\n            \"coeffs\": {\n                (-10,): 0.02, (-3,): 0.1, (-1,): 0.7,\n                (1,): 0.7, (3,): 0.1, (10,): 0.02\n            }\n        },\n        {\n            \"n\": 2, \"s\": 0.4, \"K_max\": 32, \"M\": 512,\n            \"coeffs\": {\n                (-5, 0): 0.05, (-1, -2): 0.03, (0, -5): 0.05,\n                (0, 5): 0.05, (1, 2): 0.03, (5, 0): 0.05\n            }\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n, s, K_max, M, coeffs = case['n'], case['s'], case['K_max'], case['M'], case['coeffs']\n        \n        I = np.array(list(coeffs.keys()))  # Shape (|I|, n)\n        u_hats = np.array(list(coeffs.values()))  # Shape (|I|,)\n\n        # 1. Compute ||u_N||_{H^s}\n        k_norms_sq = np.sum(I**2, axis=1)\n        h_s_norm_sq_terms = (1 + k_norms_sq)**s * np.abs(u_hats)**2\n        h_s_norm = np.sqrt(np.sum(h_s_norm_sq_terms))\n\n        # 2. Compute ||u_N||_{L^infty} numerically\n        grid_coords_1d = [np.linspace(0, 2 * np.pi, M, endpoint=False) for _ in range(n)]\n        \n        # Vectorized evaluation of u_N on the grid\n        if n == 1:\n            pos_vectors = grid_coords_1d[0][:, np.newaxis]  # Shape (M, 1)\n        else:  # n == 2\n            grid_mesh = np.meshgrid(*grid_coords_1d, indexing='ij')\n            pos_vectors = np.stack(grid_mesh, axis=-1)  # Shape (M, M, n)\n            \n        k_dot_x = np.tensordot(I, pos_vectors, axes=([-1], [-1])) # Shape (|I|, M,...)\n        u_hats_reshaped = u_hats.reshape(u_hats.shape + (1,) * n)\n        u_N_grid = np.sum(u_hats_reshaped * np.exp(1j * k_dot_x), axis=0)\n        l_inf_norm = np.max(np.abs(u_N_grid))\n\n        # 3. Compute C_{s,n}(K_max) and the truncated bound B_trunc\n        if n == 1:\n            k_range = np.arange(-K_max, K_max + 1)\n            k_grid = k_range.reshape(-1, 1)\n        else: # n == 2\n            k_range = np.arange(-K_max, K_max + 1)\n            k_mesh = np.meshgrid(k_range, k_range, indexing='ij')\n            k_grid = np.stack(k_mesh, axis=-1).reshape(-1, 2)\n        \n        k_grid_norms_sq = np.sum(k_grid**2, axis=1)\n        c_trunc_sq_sum = np.sum(1.0 / (1 + k_grid_norms_sq)**s)\n        c_trunc = np.sqrt(c_trunc_sq_sum)\n        b_trunc = c_trunc * h_s_norm\n        ineq_trunc_holds = l_inf_norm = b_trunc\n\n        # 4. Compute C_{s,n}(I) and the exact index-set bound B_I\n        c_I_sq_sum = np.sum(1.0 / (1 + k_norms_sq)**s)\n        c_I = np.sqrt(c_I_sq_sum)\n        b_I = c_I * h_s_norm\n        ineq_I_holds = l_inf_norm = b_I\n\n        results.append([\n            float(h_s_norm), float(l_inf_norm),\n            float(b_trunc), bool(ineq_trunc_holds),\n            float(b_I), bool(ineq_I_holds)\n        ])\n\n    # Format the output as a list of lists.\n    output_str_parts = []\n    for res_list in results:\n        res_str = (\n            f\"[{res_list[0]},{res_list[1]},{res_list[2]},\"\n            f\"{str(res_list[3]).lower()},{res_list[4]},{str(res_list[5]).lower()}]\"\n        )\n        output_str_parts.append(res_str)\n        \n    print(f\"[{','.join(output_str_parts)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在探索了连续函数空间中的嵌入理论后，我们将注意力转向间断Galerkin（DG）和谱方法中使用的有限维多项式空间。虽然在有限维空间中所有范数都是等价的，但等价常数却并非关于多项式次数 $p$ 一致有界。本练习  深入探讨了这一关键问题，要求你分析一个所谓的“反不等式”，它在离散函数空间中用一个较弱的范数（如 $L^2$）来约束一个较强的范数（如 $L^\\infty$）。通过为一系列高阶勒让德多项式计算这个不等式常数，你将亲眼见证它对多项式次数 $p$ 的依赖性，并验证其与Nikolskii标度率的一致性，这是理解 $p$ 型加密DG方法稳定性和精度的关键结论。",
            "id": "3414895",
            "problem": "考虑一个在 $n$ 维空间中用于Discontinuous Galerkin (DG)方法的单个固定超矩形单元 $K = [0,h]^n$，并令 $p$ 表示多项式次数。定义参考单元 $\\hat{K} = [-1,1]^n$ 和仿射映射 $\\Phi : \\hat{K} \\to K$，其分量形式为 $x_i = \\frac{h}{2}(\\xi_i + 1)$，其中 $i = 1,\\dots,n$。令 $P_p(\\xi)$ 表示区间 $[-1,1]$ 上的 $p$ 次Legendre多项式，并在物理单元上定义 $p$ 精化的张量积多项式为\n$$\nu_{p,h,n}(x) = \\prod_{i=1}^n P_p\\big(\\xi_i(x)\\big),\n$$\n其中 $\\xi(x) = \\Phi^{-1}(x)$ 表示从 $K$ 到 $\\hat{K}$ 的逆仿射映射。Lebesgue空间范数定义为\n$$\n\\|v\\|_{L^\\infty(K)} = \\operatorname*{ess\\,sup}_{x\\in K} |v(x)|,\n\\quad\n\\|v\\|_{L^2(K)} = \\left( \\int_K |v(x)|^2 \\, dx \\right)^{1/2}.\n$$\n在Discontinuous Galerkin框架内，对于 $p$ 精化的多项式，$L^\\infty$ 界相对于 $L^2$ 范数的恶化预计与Nikolskii率 $(p/h)^{n/2}$ 一致。\n\n您的任务是构造此序列 $u_{p,h,n}$，通过在 $K$ 上每个坐标维度的 $m$ 个等距点（包括端点）的网格上对 $u_{p,h,n}$ 进行采样来计算 $L^\\infty$ 范数的离散近似值，仅使用Legendre多项式的基本正交性事实计算精确的 $L^2$ 范数，然后计算：\n- 比率\n$$\nR(n,h,p) = \\frac{\\|u_{p,h,n}\\|_{L^\\infty(K)}}{\\|u_{p,h,n}\\|_{L^2(K)}},\n$$\n- 以及经Nikolskii归一化的比率\n$$\n\\mathrm{NR}(n,h,p) = \\frac{R(n,h,p)}{(p/h)^{n/2}}.\n$$\n您必须实现一个完整的、可运行的程序，并使用这些定义作为基本依据。该程序必须为下面的每个测试用例计算 $R(n,h,p)$ 和 $\\mathrm{NR}(n,h,p)$，并将所有结果在单行中输出，形式为用方括号括起来的逗号分隔列表，顺序为 $[R_1,\\mathrm{NR}_1,R_2,\\mathrm{NR}_2,\\dots]$（所有值均为十进制浮点数）。不涉及物理单位。不涉及角度。不得使用百分比。\n\n使用以下测试套件，它涵盖了不同维度、次数和单元尺寸下的正常路径、边界条件和边缘情况：\n- 测试用例 $1$：$n=1$，$h=1.0$，$p=1$，每个维度采样点数为 $m=33$。\n- 测试用例 $2$：$n=1$，$h=1.0$，$p=16$，每个维度采样点数为 $m=65$。\n- 测试用例 $3$：$n=2$，$h=0.5$，$p=6$，每个维度采样点数为 $m=33$。\n- 测试用例 $4$：$n=2$，$h=0.1$，$p=16$，每个维度采样点数为 $m=33$。\n- 测试用例 $5$：$n=3$，$h=0.25$，$p=4$，每个维度采样点数为 $m=33$。\n- 测试用例 $6$：$n=3$，$h=0.1$，$p=10$，每个维度采样点数为 $m=33$。\n\n您的程序应生成单行输出，其中包含以上述六个测试用例的结果，格式为方括号括起来的逗号分隔列表，顺序为 $[R_1,\\mathrm{NR}_1,R_2,\\mathrm{NR}_2,\\dots]$。",
            "solution": "该问题已经过验证，被认为是数值分析领域中一个适定且有科学依据的问题。我们接下来推导计算比率 $R(n,h,p)$ 和 $\\mathrm{NR}(n,h,p)$ 所需的量。\n\n问题的核心是计算函数 $u_{p,h,n}(x) = \\prod_{i=1}^n P_p(\\xi_i(x))$ 的 $L^\\infty(K)$ 和 $L^2(K)$ 范数，其中 $\\xi_i(x) = \\frac{2x_i}{h} - 1$ 是从物理单元 $K=[0,h]^n$ 到参考单元 $\\hat{K}=[-1,1]^n$ 的逆仿射映射。\n\n**1. $L^\\infty$ 范数的计算**\n\n$L^\\infty$ 范数定义为 $\\|v\\|_{L^\\infty(K)} = \\operatorname*{ess\\,sup}_{x\\in K} |v(x)|$。对于我们的函数 $u_{p,h,n}(x)$，这等于：\n$$\n\\|u_{p,h,n}\\|_{L^\\infty(K)} = \\operatorname*{ess\\,sup}_{x\\in K} \\left| \\prod_{i=1}^n P_p\\big(\\xi_i(x)\\big) \\right|\n$$\n由于映射 $\\xi(x)$ 是从 $K$ 到 $\\hat{K}$ 的一个双射，我们可以在参考单元 $\\hat{K}$ 上评估上确界：\n$$\n\\|u_{p,h,n}\\|_{L^\\infty(K)} = \\operatorname*{ess\\,sup}_{\\xi\\in \\hat{K}} \\left| \\prod_{i=1}^n P_p(\\xi_i) \\right| = \\operatorname*{ess\\,sup}_{\\xi\\in [-1,1]^n} \\prod_{i=1}^n \\left| P_p(\\xi_i) \\right|\n$$\n非负函数乘积的上确界是它们各自上确界的乘积。因此，我们可以按坐标分离该表达式：\n$$\n\\|u_{p,h,n}\\|_{L^\\infty(K)} = \\prod_{i=1}^n \\left( \\operatorname*{ess\\,sup}_{\\xi_i\\in [-1,1]} |P_p(\\xi_i)| \\right)\n$$\nLegendre多项式 $P_p(\\xi)$ 的一个基本性质是，对于 $\\xi \\in [-1,1]$，其绝对值以1为界，即 $|P_p(\\xi)| \\le 1$。绝对值的最大值1在区间的端点处取得，因为 $|P_p(\\pm 1)| = 1$。因此，对于每个维度 $i$，我们有：\n$$\n\\operatorname*{ess\\,sup}_{\\xi_i\\in [-1,1]} |P_p(\\xi_i)| = 1\n$$\n将其代回，我们得到精确的 $L^\\infty$ 范数：\n$$\n\\|u_{p,h,n}\\|_{L^\\infty(K)} = \\prod_{i=1}^n 1 = 1\n$$\n问题指定通过在 $K$ 上每个维度 $m$ 个等距点（包括端点）的网格上采样来近似此范数。物理单元 $K$ 的端点 $x_i = 0$ 和 $x_i=h$ 对应于参考区间 $[-1,1]$ 的端点 $\\xi_i=-1$ 和 $\\xi_i=1$。由于网格包含 $K$ 的顶点，它将在函数绝对值达到最大值（1）的点进行采样。因此，离散近似得到的结果即为精确的解析值，$\\|u_{p,h,n}\\|_{L^\\infty(K)}=1$。\n\n**2. $L^2$ 范数的计算**\n\n$L^2$ 范数定义为 $\\|v\\|_{L^2(K)} = \\left( \\int_K |v(x)|^2 \\, dx \\right)^{1/2}$。我们首先计算范数的平方：\n$$\n\\|u_{p,h,n}\\|_{L^2(K)}^2 = \\int_K \\left| \\prod_{i=1}^n P_p\\big(\\xi_i(x)\\big) \\right|^2 \\, dx\n$$\n我们使用映射 $x_i = \\frac{h}{2}(\\xi_i+1)$ 进行变量替换，从 $x \\in K$ 变换到 $\\xi \\in \\hat{K}$。此变换的雅可比矩阵是对角矩阵，其元素为 $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j} = \\delta_{ij} \\frac{h}{2}$。其行列式为 $\\det(J) = (\\frac{h}{2})^n$。积分变为：\n$$\n\\|u_{p,h,n}\\|_{L^2(K)}^2 = \\int_{\\hat{K}} \\left( \\prod_{i=1}^n P_p(\\xi_i) \\right)^2 \\det(J) \\, d\\xi = \\left(\\frac{h}{2}\\right)^n \\int_{[-1,1]^n} \\prod_{i=1}^n \\left(P_p(\\xi_i)\\right)^2 \\, d\\xi_1 \\dots d\\xi_n\n$$\n根据Fubini定理，这个多维积分可以分离为一维积分的乘积：\n$$\n\\|u_{p,h,n}\\|_{L^2(K)}^2 = \\left(\\frac{h}{2}\\right)^n \\prod_{i=1}^n \\int_{-1}^1 \\left(P_p(\\xi_i)\\right)^2 \\, d\\xi_i\n$$\n问题指导我们使用Legendre多项式的基本正交性。关键性质是：\n$$\n\\int_{-1}^1 P_j(\\xi) P_k(\\xi) \\, d\\xi = \\frac{2}{2j+1} \\delta_{jk}\n$$\n在我们的情况中，$j=k=p$，这简化为：\n$$\n\\int_{-1}^1 (P_p(\\xi))^2 \\, d\\xi = \\frac{2}{2p+1}\n$$\n将此结果代入 $n$ 个积分中的每一个：\n$$\n\\|u_{p,h,n}\\|_{L^2(K)}^2 = \\left(\\frac{h}{2}\\right)^n \\left( \\frac{2}{2p+1} \\right)^n = \\frac{h^n}{2^n} \\frac{2^n}{(2p+1)^n} = \\left(\\frac{h}{2p+1}\\right)^n\n$$\n取平方根得到精确的 $L^2$ 范数：\n$$\n\\|u_{p,h,n}\\|_{L^2(K)} = \\left( \\left(\\frac{h}{2p+1}\\right)^n \\right)^{1/2} = \\left(\\frac{h}{2p+1}\\right)^{n/2}\n$$\n\n**3. 比率的计算**\n\n有了两个范数的精确解析表达式，我们现在可以计算所需的比率。\n比率 $R(n,h,p)$ 是：\n$$\nR(n,h,p) = \\frac{\\|u_{p,h,n}\\|_{L^\\infty(K)}}{\\|u_{p,h,n}\\|_{L^2(K)}} = \\frac{1}{\\left(\\frac{h}{2p+1}\\right)^{n/2}} = \\left(\\frac{2p+1}{h}\\right)^{n/2}\n$$\n经Nikolskii归一化的比率 $\\mathrm{NR}(n,h,p)$ 是：\n$$\n\\mathrm{NR}(n,h,p) = \\frac{R(n,h,p)}{(p/h)^{n/2}} = \\frac{\\left(\\frac{2p+1}{h}\\right)^{n/2}}{\\left(\\frac{p}{h}\\right)^{n/2}} = \\left( \\frac{(2p+1)/h}{p/h} \\right)^{n/2} = \\left(\\frac{2p+1}{p}\\right)^{n/2} = \\left(2 + \\frac{1}{p}\\right)^{n/2}\n$$\n这些最终的解析公式用于计算每个测试用例的结果。当 $p \\to \\infty$ 时，项 $(2 + 1/p)^{n/2}$ 趋近于 $2^{n/2}$，这表明Nikolskii缩放捕获了主要行为。参数 $m$ 与最终计算无关，因为精确范数是通过解析方法确定的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the norm ratio R and the Nikolskii-normalized ratio NR\n    for a series of test cases in a Discontinuous Galerkin context.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (n, h, p, m), where n is dimension, h is element size,\n    # p is polynomial degree, and m is samples per dimension.\n    test_cases = [\n        (1, 1.0, 1, 33),\n        (1, 1.0, 16, 65),\n        (2, 0.5, 6, 33),\n        (2, 0.1, 16, 33),\n        (3, 0.25, 4, 33),\n        (3, 0.1, 10, 33),\n    ]\n\n    results = []\n    for n, h, p, m in test_cases:\n        # Based on the analytical derivation:\n        # The L-infinity norm is exactly 1.\n        # The L2 norm is ((h / (2*p + 1))**n)**0.5 = (h / (2*p + 1))**(n/2).\n\n        # R = L_inf / L_2 = 1 / (h / (2*p + 1))**(n/2)\n        # R = ((2*p + 1) / h)**(n / 2.0)\n        ratio_R = ((2 * p + 1) / h)**(n / 2.0)\n\n        # NR = R / (p/h)**(n/2)\n        # NR = (((2*p + 1)/h) / (p/h))**(n/2)\n        # NR = ((2*p + 1)/p)**(n/2) = (2 + 1/p)**(n/2)\n        # The parameter m is not needed for the analytical computation.\n        nikolskii_ratio_NR = (2.0 + 1.0 / p)**(n / 2.0)\n\n        results.append(ratio_R)\n        results.append(nikolskii_ratio_NR)\n\n    # Final print statement in the exact required format.\n    # The format is a single line, comma-separated list enclosed in brackets.\n    # Example: [R_1,NR_1,R_2,NR_2,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}