{
    "hands_on_practices": [
        {
            "introduction": "经典解要求函数具有高度的光滑性（例如，$C^2$），但在许多物理问题中，例如涉及由不同材料组成的复合介质时，这一条件可能不被满足。本练习旨在通过构建一个具体案例，加深您对弱解概念的理解。您将推导出一个在一维椭圆边值问题中存在于索伯列夫空间 $H_0^1(0,1)$ 中，但却不满足经典解所需光滑性条件的解。这个实践突出了弱公式的必要性和力量，因为它扩展了可解问题的范围，使其能更好地模拟物理现实。",
            "id": "3370443",
            "problem": "设 $\\Omega=(0,1)$，考虑关于函数 $u:\\Omega\\to\\mathbb{R}$ 的标量二阶椭圆边值问题，\n$$\n-(a(x)\\,u'(x))'=f(x)\\quad\\text{在 }\\Omega\\text{ 内},\\qquad u(0)=0,\\quad u(1)=0,\n$$\n其中系数为 $a:\\Omega\\to\\mathbb{R}$，右端项为 $f:\\Omega\\to\\mathbb{R}$。从 Sobolev 空间 $H_0^1(0,1)$ 中的弱解、分布导数以及通过分部积分推导出的标准变分形式的定义出发。取\n$$\na(x)=\\begin{cases}\n1,  x\\in(0,\\tfrac{1}{2}) \\\\\n2,  x\\in(\\tfrac{1}{2},1)\n\\end{cases}\n\\qquad f(x)\\equiv 1,\n$$\n因此 $a\\in L^{\\infty}(0,1)$ 且 $f\\in L^2(0,1)$。仅使用这些基本原理，推导弱形式，并通过在子区间上求解并强制施加由弱形式所蕴含的、且与间断 Galerkin (DG) 方法中处理内部界面的方式相一致的界面条件，显式地构造出唯一的弱解 $u\\in H_0^1(0,1)$。证明所得到的 $u$ 在 $(0,1)$ 上不是二次连续可微的。\n\n当 $u'$ 在 $x=\\tfrac{1}{2}$ 处有跳跃时，将在分布二阶导数 $u''$ 中 Dirac 测度 $\\delta_{1/2}$ 的系数定义为内部界面 $x=\\tfrac{1}{2}$ 处的经典可微性缺陷。将此缺陷计算为一个精确的有理数。不需要四舍五入，也不涉及单位。",
            "solution": "### 解题步骤\n\n#### 1. 推导弱形式\n\n首先，我们将强形式的微分方程转化为弱形式。将原方程两边乘以一个检验函数 $v \\in H_0^1(0,1)$，并在定义域 $\\Omega=(0,1)$ 上积分：\n$$\n-\\int_0^1 (a(x)u'(x))' v(x) \\, dx = \\int_0^1 f(x) v(x) \\, dx\n$$\n对左侧进行分部积分，将导数从 $u$ 转移到 $v$ 上：\n$$\n\\int_0^1 a(x)u'(x)v'(x) \\, dx - [a(x)u'(x)v(x)]_0^1 = \\int_0^1 f(x)v(x) \\, dx\n$$\n由于检验函数 $v$ 属于 $H_0^1(0,1)$，它在边界上为零，即 $v(0)=v(1)=0$。因此，边界项 $[a(x)u'(x)v(x)]_0^1$ 消失。这样，我们得到问题的弱形式：寻找 $u \\in H_0^1(0,1)$，使得对于所有 $v \\in H_0^1(0,1)$，下式成立：\n$$\n\\int_0^1 a(x)u'(x)v'(x) \\, dx = \\int_0^1 f(x)v(x) \\, dx\n$$\n\n#### 2. 分段求解并施加界面条件\n\n由于系数 $a(x)$ 是分段常数，解 $u(x)$ 在每个子区间内将是光滑的。设 $u_1(x)$ 为在 $(0, 1/2)$ 上的解， $u_2(x)$ 为在 $(1/2, 1)$ 上的解。\n\n- 在区间 $(0, 1/2)$ 上，方程为 $-(1 \\cdot u_1'(x))' = 1$，即 $-u_1''(x) = 1$。\n- 在区间 $(1/2, 1)$ 上，方程为 $-(2 \\cdot u_2'(x))' = 1$，即 $-2u_2''(x) = 1$ 或 $u_2''(x) = -1/2$。\n\n对以上两个二阶常微分方程进行积分，我们得到解的一般形式：\n- $u_1'(x) = -x + C_1 \\implies u_1(x) = -\\frac{x^2}{2} + C_1 x + C_2$\n- $u_2'(x) = -\\frac{x}{2} + C_3 \\implies u_2(x) = -\\frac{x^2}{4} + C_3 x + C_4$\n\n为了确定四个积分常数 $C_1, C_2, C_3, C_4$，我们需要四个条件：两个边界条件和两个界面条件。\n1.  **边界条件 $u(0)=0$**: $u_1(0) = C_2 = 0$。\n2.  **边界条件 $u(1)=0$**: $u_2(1) = -1/4 + C_3 + C_4 = 0$。\n3.  **界面连续性条件**: 弱解 $u$ 必须属于 $H^1(0,1)$，这意味着 $u$ 在整个定义域上必须是连续的。因此，在界面 $x=1/2$ 处必须有 $u_1(1/2) = u_2(1/2)$。\n    $$-\\frac{(1/2)^2}{2} + C_1(\\frac{1}{2}) = -\\frac{(1/2)^2}{4} + C_3(\\frac{1}{2}) + C_4 \\implies -\\frac{1}{8} + \\frac{C_1}{2} = -\\frac{1}{16} + \\frac{C_3}{2} + C_4$$\n4.  **通量连续性条件**: 这个条件是弱形式所蕴含的。它要求法向通量 $a(x)u'(x)$ 在界面处是连续的。即 $[a u']_{x=1/2} = 0$，或 $a(1/2^-)u_1'(1/2) = a(1/2^+)u_2'(1/2)$。\n    $$1 \\cdot u_1'(1/2) = 2 \\cdot u_2'(1/2) \\implies -1/2 + C_1 = 2(-1/4 + C_3) \\implies -1/2 + C_1 = -1/2 + 2C_3 \\implies C_1 = 2C_3$$\n\n现在我们求解这个由 $C_1, C_3, C_4$ 构成的线性方程组：\n(i) $C_3 + C_4 = 1/4$\n(ii) $-1/8 + C_1/2 = -1/16 + C_3/2 + C_4$\n(iii) $C_1 = 2C_3$\n\n将 (iii) 代入 (ii)：\n$$-1/8 + (2C_3)/2 = -1/16 + C_3/2 + C_4 \\implies -1/8 + C_3 = -1/16 + C_3/2 + C_4$$\n$$C_3/2 - C_4 = 1/8 - 1/16 = 1/16$$\n我们现在有关于 $C_3$ 和 $C_4$ 的方程组：\n$$C_3 + C_4 = 1/4$$\n$$C_3/2 - C_4 = 1/16$$\n两式相加，得到 $3C_3/2 = 1/4 + 1/16 = 5/16$，因此 $C_3 = \\frac{5}{24}$。\n代回可得 $C_1 = 2C_3 = \\frac{10}{24} = \\frac{5}{12}$，以及 $C_4 = 1/4 - C_3 = 6/24 - 5/24 = \\frac{1}{24}$。\n\n因此，唯一的弱解是：\n$$\nu(x) = \\begin{cases}\n-\\frac{1}{2}x^2 + \\frac{5}{12}x,  x\\in[0, \\tfrac{1}{2}] \\\\\n-\\frac{1}{4}x^2 + \\frac{5}{24}x + \\frac{1}{24},  x\\in(\\tfrac{1}{2}, 1]\n\\end{cases}\n$$\n\n#### 3. 验证光滑性并计算缺陷\n\n-   **光滑性**: 解 $u(x)$ 是连续的，但其导数在 $x=1/2$ 处不连续：\n    $u_1'(1/2) = -1/2 + C_1 = -1/2 + 5/12 = -1/12$\n    $u_2'(1/2) = -1/4 + C_3 = -1/4 + 5/24 = -1/24$\n    由于 $u_1'(1/2) \\neq u_2'(1/2)$，函数 $u(x)$ 在 $x=1/2$ 处不是一次连续可微的，因此 $u \\notin C^1(0,1)$，更不可能是 $C^2(0,1)$ 的经典解。\n\n-   **计算缺陷**: 问题要求计算分布二阶导数 $u''$ 中狄拉克测度 $\\delta_{1/2}$ 的系数。这个系数等于 $u'$ 在 $x=1/2$ 处的跳跃 $[u']_{x=1/2}$。\n    $$[u']_{x=1/2} = u'(1/2^+) - u'(1/2^-) = u_2'(1/2) - u_1'(1/2)$$\n    $$= (-1/24) - (-1/12) = -1/24 + 2/24 = \\frac{1}{24}$$\n所以，经典可微性缺陷为 $\\frac{1}{24}$。",
            "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$"
        },
        {
            "introduction": "弱形式不仅是一种理论上的便利，它也是许多强大数值方法（如谱方法和有限元法）的基石。本练习将引导您将泊松方程的抽象弱形式转化为一个具体的线性代数系统。通过使用勒让德多项式作为谱伽辽金方法的基函数，您将亲手推导出刚度矩阵 $A$ 和质量矩阵 $M$。这个过程将揭示基函数的选择如何直接影响离散系统矩阵的结构（例如，对角性或稀疏性），这是理解和设计高效计算方法的关键一步。",
            "id": "3370462",
            "problem": "考虑在区间 $\\Omega = (-1,1)$ 上的二阶泊松边界值问题，其具有齐次狄利克雷边界条件：寻找一个函数 $u$，使得\n- $-u'' = f$ 在 $\\Omega$ 中，\n- $u(-1) = 0$ 且 $u(1) = 0$。\n构建弱问题形式：寻找 $u \\in H_{0}^{1}(-1,1)$，使得对于所有 $v \\in H_{0}^{1}(-1,1)$，\n$$\n\\int_{-1}^{1} u'(x)\\,v'(x)\\,dx \\;=\\; \\int_{-1}^{1} f(x)\\,v(x)\\,dx.\n$$\n使用基于勒让德多项式的基函数构造一个谱伽辽金近似，该基函数强制满足边界条件。令 $\\{P_{n}\\}_{n \\ge 0}$ 表示在 $[-1,1]$ 上的勒让德多项式，并回顾其基本性质：\n- 正交性：$\\displaystyle \\int_{-1}^{1} P_{n}(x)\\,P_{m}(x)\\,dx \\;=\\; \\frac{2}{2n+1}\\,\\delta_{nm}$ 对于所有整数 $n,m \\ge 0$。\n- Sturm–Liouville 方程：$\\displaystyle \\frac{d}{dx}\\Big((1-x^{2})\\,P_{n}'(x)\\Big) + n(n+1)\\,P_{n}(x) \\;=\\; 0$。\n- 端点值：$\\displaystyle P_{n}(1) = 1$，$\\displaystyle P_{n}(-1) = (-1)^{n}$，对于所有整数 $n \\ge 0$。\n定义试验和测试空间 $V_{N} = \\operatorname{span}\\{\\phi_{k}\\}_{k=0}^{N-1}$，其中\n$$\n\\phi_{k}(x) \\;=\\; P_{k+2}(x) - P_{k}(x), \\quad k=0,1,\\dots,N-1,\n$$\n并求解满足伽辽金方程的 $u_{N}(x) = \\sum_{k=0}^{N-1} \\widehat{u}_{k}\\,\\phi_{k}(x) \\in V_{N}$，对于所有 $\\phi_{j} \\in V_{N}$：\n$$\n\\int_{-1}^{1} u_{N}'(x)\\,\\phi_{j}'(x)\\,dx \\;=\\; \\int_{-1}^{1} f(x)\\,\\phi_{j}(x)\\,dx, \\quad j=0,1,\\dots,N-1.\n$$\n- 推导所得的矩阵形式线性系统，其中刚度矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 和质量矩阵 $M \\in \\mathbb{R}^{N \\times N}$ 定义为\n$$\nA_{ij} \\;=\\; \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx, \n\\qquad \nM_{ij} \\;=\\; \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx,\n$$\n并确定它们的稀疏模式。\n- 计算 $A$ 和 $M$ 的矩阵元素关于 $i$ 和 $j$ 的显式解析表达式。\n你最终报告的答案必须是单个闭式解析表达式：通用对角刚度矩阵元素 $A_{nn}$ 作为 $n$ 的函数。不包含单位。不要四舍五入。",
            "solution": "### 解题步骤\n\n本题要求我们使用特定的谱伽辽金方法求解泊松方程，并推导离散系统的刚度矩阵和质量矩阵。\n\n#### 1. 验证基函数\n\n首先，我们验证所选的基函数 $\\phi_k(x) = P_{k+2}(x) - P_k(x)$ 是否满足齐次狄利克雷边界条件，即在 $x=\\pm 1$ 处是否为零。\n利用勒让德多项式的端点值性质：\n- 在 $x=1$ 处：$\\phi_k(1) = P_{k+2}(1) - P_k(1) = 1 - 1 = 0$。\n- 在 $x=-1$ 处：$\\phi_k(-1) = P_{k+2}(-1) - P_k(-1) = (-1)^{k+2} - (-1)^k = (-1)^k - (-1)^k = 0$。\n基函数确实满足边界条件，因此由它们张成的空间 $V_N$ 是 $H_0^1(-1,1)$ 的一个合适的子空间。\n\n#### 2. 计算刚度矩阵 $A$\n\n刚度矩阵的元素定义为 $A_{ij} = \\int_{-1}^{1} \\phi_i'(x)\\,\\phi_j'(x)\\,dx$。\n关键一步是简化基函数的导数 $\\phi_k'(x)$。我们使用勒让德多项式导数的标准三项递推关系：\n$$\n(2n+1)P_n(x) = P'_{n+1}(x) - P'_{n-1}(x)\n$$\n将此关系式中的 $n$ 替换为 $k+1$，得到：\n$$\n(2(k+1)+1)P_{k+1}(x) = P'_{k+2}(x) - P'_{k}(x)\n$$\n这正是我们基函数的导数 $\\phi_k'(x) = P_{k+2}'(x) - P_k'(x)$。因此，我们有一个非常简洁的表达式：\n$$\n\\phi_k'(x) = (2k+3)P_{k+1}(x)\n$$\n现在我们可以计算 $A_{ij}$：\n$$\nA_{ij} = \\int_{-1}^{1} \\left( (2i+3)P_{i+1}(x) \\right) \\left( (2j+3)P_{j+1}(x) \\right) dx\n$$\n$$\nA_{ij} = (2i+3)(2j+3) \\int_{-1}^{1} P_{i+1}(x) P_{j+1}(x) dx\n$$\n利用勒让德多项式的正交性 $\\int_{-1}^{1} P_n(x)P_m(x)dx = \\frac{2}{2n+1}\\delta_{nm}$：\n$$\n\\int_{-1}^{1} P_{i+1}(x)P_{j+1}(x)\\,dx = \\frac{2}{2(i+1)+1}\\,\\delta_{i+1, j+1} = \\frac{2}{2i+3}\\,\\delta_{ij}\n$$\n将此结果代回 $A_{ij}$ 的表达式：\n$$\nA_{ij} = (2i+3)(2j+3) \\left( \\frac{2}{2i+3} \\delta_{ij} \\right) = 2(2j+3)\\delta_{ij}\n$$\n由于克罗内克 $\\delta_{ij}$ 的存在，当 $i=j$ 时，$A_{ii} = 2(2i+3)$；当 $i \\neq j$ 时，$A_{ij} = 0$。\n因此，刚度矩阵 $A$ 是一个**对角矩阵**。其对角元素为：\n$$\nA_{nn} = 2(2n+3) \\quad \\text{对于 } n=0, 1, \\dots, N-1.\n$$\n\n#### 3. 计算质量矩阵 $M$\n\n质量矩阵的元素定义为 $M_{ij} = \\int_{-1}^{1} \\phi_i(x)\\,\\phi_j(x)\\,dx$。\n$$\nM_{ij} = \\int_{-1}^{1} \\left( P_{i+2}(x) - P_i(x) \\right) \\left( P_{j+2}(x) - P_j(x) \\right) dx\n$$\n展开乘积并逐项积分：\n$$\nM_{ij} = \\int_{-1}^{1} P_{i+2}P_{j+2}\\,dx - \\int_{-1}^{1} P_{i+2}P_{j}\\,dx - \\int_{-1}^{1} P_{i}P_{j+2}\\,dx + \\int_{-1}^{1} P_{i}P_{j}\\,dx\n$$\n再次利用正交性：\n$$\nM_{ij} = \\frac{2}{2(i+2)+1}\\delta_{i,j} - \\frac{2}{2(i+2)+1}\\delta_{i+2,j} - \\frac{2}{2i+1}\\delta_{i,j+2} + \\frac{2}{2i+1}\\delta_{i,j}\n$$\n合并含有 $\\delta_{ij}$ 的项：\n$$\nM_{ij} = \\left(\\frac{2}{2i+1} + \\frac{2}{2i+5}\\right)\\delta_{ij} - \\frac{2}{2i+5}\\delta_{j,i+2} - \\frac{2}{2i+1}\\delta_{j,i-2}\n$$\n(注意，我们使用了 $\\delta_{i, j+2} = \\delta_{j, i-2}$)。\n此表达式表明，$M_{ij}$ 仅在 $j=i$，$j=i+2$ 或 $j=i-2$ 时非零。因此，质量矩阵 $M$ 是一个**五对角矩阵**（主对角线、第二超对角线和第二亚对角线非零）。\n其元素为：\n-   对角元素 ($j=i$): $M_{ii} = \\frac{2}{2i+1} + \\frac{2}{2i+5}$\n-   第二超对角线元素 ($j=i+2$): $M_{i,i+2} = -\\frac{2}{2i+5}$\n-   第二亚对角线元素 ($j=i-2$): $M_{i,i-2} = -\\frac{2}{2(i-2)+1} = -\\frac{2}{2i-3}$（这与 $M_{i-2,i}$ 的表达式一致，矩阵是对称的）。\n\n#### 4. 最终答案\n\n问题要求提供通用对角刚度矩阵元素 $A_{nn}$ 的表达式。根据我们的推导，结果是：\n$$A_{nn} = 2(2n+3)$$",
            "answer": "$$\\boxed{2(2n+3)}$$"
        },
        {
            "introduction": "在逼近非光滑函数时，数值解可能会出现吉布斯现象，导致在不连续点附近产生振荡，从而在逐点意义上（即强范数意义下）无法收敛。本练习通过一个计算实验来探讨这一现象，并引入模态滤波这一实用技术来抑制振荡。更重要的是，您将对比分析在强范数（如 $L^{\\infty}$ 范数）和弱范数（如 $H^{-1}$ 型范数）下误差的不同表现。这项实践对于理解不同收敛模式的差异至关重要，并帮助您建立一个更深刻的视角来评估数值弱解的质量。",
            "id": "3370457",
            "problem": "考虑周期区间 $[0,2\\pi)$ 和一个实值分段光滑函数 $u(x)$，该函数至多有有限个跳跃间断点。设 $\\{e^{\\mathrm{i}k x}\\}_{k\\in\\mathbb{Z}}$ 表示 $[0,2\\pi)$ 上的复 Fourier 基，且 $u$ 的 Fourier 系数为 $c_k = \\frac{1}{2\\pi} \\int_0^{2\\pi} u(x)\\,e^{-\\mathrm{i}k x}\\,\\mathrm{d}x$。N-模态截断谱近似是部分和 $u_N(x) = \\sum_{|k|\\le N} c_k e^{\\mathrm{i}k x}$。对于分段光滑的 $u$，经典的逐点收敛在跳跃点处失效（Gibbs 现象），尽管在 $L^2$ 范数意义下 $u_N \\to u$。在谱方法和间断 Galerkin (DG) 方法中，一种标准的稳定化方法是模态滤波：在重构前，通过一个滤波器 $\\varphi(k)$ 应用于模态系数，以衰减高阶模态。\n\n此任务的基础：\n- $[0,2\\pi)$ 上的 Fourier 系数 $c_k$ 和截断 Fourier 级数 $u_N(x)$ 的定义。\n- 弱解的概念：分布与光滑测试函数的配对；弱范数（如负 Sobolev 范数）在弱意义下量化收敛性。\n- $H^{-1}$ 型弱范数由与 $H^1$ 测试函数的对偶配对导出，并且可以通过 Fourier 系数和权重 $1/|k|$（对于 $k\\neq 0$）计算得出。\n\n你的任务是针对几个测试用例，实现以下经典误差和弱一致性误差之间的定量比较，并展示模态滤波的效果。当使用模态基（例如 Legendre 或 Fourier 模态）时，模态滤波是 DG 方法中抑制间断点周围伪高频振荡的标准方法：\n\n1. 域与采样。在周期域 $[0,2\\pi)$ 上进行计算，角度以弧度为单位。使用包含 $G$ 个点的均匀网格，其中 $G=65536$，即在 $x_j = \\frac{2\\pi j}{G}$（$j=0,1,\\dots,G-1$）处采样。\n\n2. 模态近似。对于每个测试用例，通过网格上的离散 Fourier 变换，使用复合梯形法则数值近似 Fourier 系数 $c_k$。通过截断至模态 $|k|\\le N$ 来构造 $u_N(x)$。\n\n3. 模态滤波。定义一个模态滤波器为 $\\varphi(k) = \\exp\\!\\big(-\\alpha \\, (|k|/N)^s\\big)$（对于 $|k|\\le N$）和 $\\varphi(k)=0$（对于 $|k|>N$），其中 $\\alpha>0$ 是滤波器强度，$s$ 是滤波器阶数。在重构之前，将此 $\\varphi(k)$ 应用于离散 Fourier 系数，以获得滤波后的近似 $u_N^{\\mathrm{f}}(x)$。\n\n4. 需要量化的误差。\n   - 经典逐点误差（网格上的上确界范数）：$E_{\\infty}(u_N) = \\max_j |u_N(x_j) - u(x_j)|$ 和 $E_{\\infty}(u_N^{\\mathrm{f}}) = \\max_j |u_N^{\\mathrm{f}}(x_j) - u(x_j)|$。\n   - 由离散 Fourier 系数计算的 $H^{-1}$ 型范数所表示的弱一致性误差。如果 $e(x)=u_{\\star}(x)-u(x)$ 表示误差，设 $\\widehat{e}_k$ 表示 $e$ 的离散 Fourier 系数（其近似于连续的 $c_k$）；然后计算\n     $$\\|e\\|_{H^{-1}} \\approx \\left(\\sum_{k\\in\\mathbb{Z}\\setminus\\{0\\}} \\frac{|\\widehat{e}_k|^2}{k^2}\\right)^{1/2}.$$\n     报告以此方式计算的 $E_{-1}(u_N)$ 和 $E_{-1}(u_N^{\\mathrm{f}})$。这是分布意义上的弱误差，因为它通过 $1/|k|$ 降低了高频内容的权重，并对应于对光滑函数的梯度进行检验，这反映了 DG 方法中的弱形式。\n\n5. 测试套件。实现以下四个测试用例，每个用例都在包含 $G=65536$ 个点的相同网格上执行：\n   - 测试用例 1：$u_1(x) = \\sin(x) + H(x-\\pi)$，其中当 $y0$ 时 $H(y)=0$，当 $y\\ge 0$ 时 $H(y)=1$；参数为 $N=8$, $s=8$, $\\alpha=36$。\n   - 测试用例 2：$u_1(x)$ 同上；参数为 $N=64$, $s=8$, $\\alpha=36$。\n   - 测试用例 3：$u_2(x) = |\\sin(x)|$；参数为 $N=16$, $s=8$, $\\alpha=36$。\n   - 测试用例 4：$u_3(x) = \\begin{cases}-1,  x\\in[0,\\pi)\\\\ 1,  x\\in[\\pi,2\\pi)\\end{cases}$；参数为 $N=32$, $s=8$, $\\alpha=36$。\n\n6. 输出规范。对于每个测试用例，按顺序计算四个浮点数\n   $[E_{\\infty}(u_N),\\, E_{\\infty}(u_N^{\\mathrm{f}}),\\, E_{-1}(u_N),\\, E_{-1}(u_N^{\\mathrm{f}})]$。\n   你的程序应生成单行输出，其中包含所有四个测试用例的结果，格式为一个由这些列表组成的逗号分隔列表，并用方括号括起来。例如，输出格式必须与\n   $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4],[d_1,d_2,d_3,d_4]]$\n   完全一样，不得包含任何额外文本。所有数值均为无单位的实数。",
            "solution": "### 解题步骤\n\n此问题要求通过一个计算实验，比较截断傅里叶级数和滤波后傅里叶级数在逼近非光滑函数时的两种不同误差度量：经典的逐点上确界范数 ($E_{\\infty}$) 和一种弱 $H^{-1}$ 型范数 ($E_{-1}$)。\n\n#### 1. 离散化与傅里叶系数\n\n我们在周期域 $[0, 2\\pi)$ 上工作，使用 $G=65536$ 个均匀采样点 $x_j = 2\\pi j/G$。精确函数 $u(x)$ 的傅里叶系数 $c_k$ 可由离散傅里叶变换 (DFT) 近似得到。对于网格上的采样值 $u(x_j)$，其离散傅里叶系数 $\\widehat{c}_k$ 计算如下：\n$$\n\\widehat{c}_k = \\frac{1}{G} \\sum_{j=0}^{G-1} u(x_j) e^{-2\\pi\\mathrm{i}kj/G}\n$$\n这可以通过快速傅里叶变换 (FFT) 算法高效完成。\n\n#### 2. 谱近似的构造\n\n- **截断近似 $u_N(x)$**: 这是通过仅保留傅里叶级数中波数满足 $|k| \\le N$ 的项得到的。在系数层面，这意味着将 $|k| > N$ 的所有系数 $\\widehat{c}_k$ 置为零。\n  $$\n  \\widehat{(u_N)}_k = \\begin{cases} \\widehat{c}_k  \\text{若 } |k| \\le N \\\\ 0  \\text{若 } |k| > N \\end{cases}\n  $$\n  然后通过逆快速傅里叶变换 (IFFT) 从这些截断的系数重构空间函数 $u_N(x_j)$。这种急剧的截断会在不连续点附近导致吉布斯现象。\n\n- **滤波近似 $u_N^{\\mathrm{f}}(x)$**: 为了抑制吉布斯振荡，我们在重构前对截断的系数应用一个指数滤波器。\n  $$\n  \\varphi(k) = \\exp\\left(-\\alpha \\left(\\frac{|k|}{N}\\right)^s\\right) \\quad \\text{对于 } |k| \\le N\n  $$\n  滤波后近似的系数为：\n  $$\n  \\widehat{(u_N^{\\mathrm{f}})}_k = \\varphi(k) \\widehat{(u_N)}_k = \\begin{cases} \\widehat{c}_k \\exp\\left(-\\alpha \\left(\\frac{|k|}{N}\\right)^s\\right)  \\text{若 } |k| \\le N \\\\ 0  \\text{若 } |k| > N \\end{cases}\n  $$\n  这个滤波器平滑地衰减了高频模态，从而减少了空间域中的振荡。同样，通过 IFFT 重构空间函数 $u_N^{\\mathrm{f}}(x_j)$。\n\n#### 3. 误差量化\n\n- **逐点误差 $E_{\\infty}$**: 该误差在离散上确界范数中度量，捕捉了近似函数与精确函数在所有网格点上的最大绝对偏差。\n  $$\n  E_{\\infty}(u_{\\star}) = \\max_{j} |u_{\\star}(x_j) - u(x_j)|\n  $$\n  其中 $u_{\\star}$ 代表 $u_N$ 或 $u_N^{\\mathrm{f}}$。\n\n- **弱一致性误差 $E_{-1}$**: 该误差在一个离散的 $H^{-1}$ 型范数中度量。它通过误差函数 $e(x) = u_{\\star}(x) - u(x)$ 的傅里叶系数 $\\widehat{e}_k$ 来计算。$1/k^2$ 的权重因子显著降低了高频分量的影响。\n  $$\n  E_{-1}(u_{\\star}) = \\|e\\|_{H^{-1}} \\approx \\left(\\sum_{k\\in\\mathbb{Z}\\setminus\\{0\\}} \\frac{|\\widehat{e}_k|^2}{k^2}\\right)^{1/2}\n  $$\n  我们需要分别推导两种近似的误差系数 $\\widehat{e}_k$：\n  -   对于**截断近似** $u_N$，误差仅存在于被截断的模态中：\n      $$ \\widehat{e}_k = \\widehat{(u_N)}_k - \\widehat{c}_k = \\begin{cases} 0  \\text{若 } |k| \\le N \\\\ -\\widehat{c}_k  \\text{若 } |k| > N \\end{cases} $$\n      因此，其 $H^{-1}$ 误差为：\n      $$ E_{-1}(u_N) = \\left(\\sum_{|k|>N, k\\neq 0} \\frac{|-\\widehat{c}_k|^2}{k^2}\\right)^{1/2} $$\n  -   对于**滤波近似** $u_N^{\\mathrm{f}}$，误差来源于两个部分：被修改的低频模态和被截断的高频模态。\n      $$ \\widehat{e^{\\mathrm{f}}}_k = \\widehat{(u_N^{\\mathrm{f}})}_k - \\widehat{c}_k = \\begin{cases} (\\varphi(k) - 1)\\widehat{c}_k  \\text{若 } |k| \\le N \\\\ -\\widehat{c}_k  \\text{若 } |k| > N \\end{cases} $$\n      其 $H^{-1}$ 误差为：\n      $$ E_{-1}(u_N^{\\mathrm{f}}) = \\left(\\sum_{0|k|\\le N} \\frac{|(\\varphi(k)-1)\\widehat{c}_k|^2}{k^2} + \\sum_{|k|>N} \\frac{|-\\widehat{c}_k|^2}{k^2}\\right)^{1/2} $$\n      此公式揭示了滤波的关键权衡：它通过修改低频模态（第一项）来减小逐点误差 $E_{\\infty}$，但这可能会增加弱范数误差 $E_{-1}$。\n\n根据上述步骤，我们将对问题中指定的四个测试用例进行计算，并为每个用例生成包含四个误差值的列表 $[E_{\\infty}(u_N), E_{\\infty}(u_N^{\\mathrm{f}}), E_{-1}(u_N), E_{-1}(u_N^{\\mathrm{f}})]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares classical pointwise and weak consistency errors for\n    spectral approximations of piecewise smooth functions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (case_id, N, s, alpha)\n        (1, 8, 8, 36),\n        (1, 64, 8, 36),\n        (2, 16, 8, 36),\n        (3, 32, 8, 36),\n    ]\n\n    G = 65536\n    # Define the computational grid on [0, 2*pi)\n    x = (2 * np.pi / G) * np.arange(G)\n\n    # Define the test functions\n    def u1(x_grid):\n        # u(x) = sin(x) + H(x-pi), where H is the Heaviside step function.\n        # H(y) = 1 for y >= 0.\n        return np.sin(x_grid) + (x_grid >= np.pi).astype(float)\n\n    def u2(x_grid):\n        # u(x) = |sin(x)|\n        return np.abs(np.sin(x_grid))\n\n    def u3(x_grid):\n        # u(x) = -1 for x in [0, pi), 1 for x in [pi, 2pi)\n        # On the grid, x=pi corresponds to index j=G/2.\n        # j  G/2 corresponds to x  pi.\n        res = np.ones_like(x_grid)\n        res[:G // 2] = -1.0\n        return res\n\n    u_funcs = {1: u1, 2: u2, 3: u3}\n    \n    all_results = []\n\n    for case_id, N, s, alpha in test_cases:\n        # 1. Sample the exact function on the grid\n        u_func = u_funcs[case_id]\n        u_grid = u_func(x)\n\n        # 2. Compute discrete Fourier coefficients (c_k) via FFT\n        # c_k = (1/G) * sum(u_j * exp(-i*k*x_j))\n        c_hat = np.fft.fft(u_grid) / G\n        \n        # Get integer wavenumbers k corresponding to FFT output\n        k_vec = np.fft.fftfreq(G) * G\n\n        # For easier indexing and filtering, shift frequencies to be monotonic\n        k_shifted = np.fft.fftshift(k_vec)\n        c_hat_shifted = np.fft.fftshift(c_hat)\n\n        # 3. Construct the truncated approximation u_N(x)\n        mask_le_N = np.abs(k_shifted) = N\n        c_N_shifted = np.zeros_like(c_hat_shifted, dtype=complex)\n        c_N_shifted[mask_le_N] = c_hat_shifted[mask_le_N]\n        \n        # Inverse shift and inverse FFT to get spatial representation\n        c_N = np.fft.ifftshift(c_N_shifted)\n        # The result must be real since input u(x) is real and spectrum is conjugate symmetric\n        u_N_grid = np.real(np.fft.ifft(c_N * G))\n\n        # 4. Construct the filtered approximation u_N^f(x)\n        # The filter is applied to the truncated coefficient set\n        k_to_filter = k_shifted[mask_le_N]\n        phi_filter_values = np.exp(-alpha * (np.abs(k_to_filter) / N)**s)\n        \n        c_N_f_shifted = np.copy(c_N_shifted)\n        c_N_f_shifted[mask_le_N] *= phi_filter_values\n        \n        # Inverse shift and inverse FFT\n        c_N_f = np.fft.ifftshift(c_N_f_shifted)\n        u_N_f_grid = np.real(np.fft.ifft(c_N_f * G))\n\n        # 5. Compute the four specified error metrics\n        \n        # 5a. Pointwise supremum error (E_infinity)\n        e_inf_uN = np.max(np.abs(u_N_grid - u_grid))\n        e_inf_uNf = np.max(np.abs(u_N_f_grid - u_grid))\n        \n        # 5b. Weak H^-1-type error (E_-1)\n        # Isolate non-zero wavenumbers for the sum\n        nonzero_k_mask = k_shifted != 0\n        k_nonzero = k_shifted[nonzero_k_mask]\n        c_hat_nonzero = c_hat_shifted[nonzero_k_mask]\n\n        # Squared terms for the norm calculation: |c_k|^2 / k^2\n        sq_terms_H_minus_1 = (np.abs(c_hat_nonzero)**2) / (k_nonzero**2)\n\n        # E_-1 for the truncated approximation u_N\n        # Error coefficients are -c_k for |k|>N\n        mask_gt_N_in_nonzero = np.abs(k_nonzero) > N\n        e_minus1_uN_sq = np.sum(sq_terms_H_minus_1[mask_gt_N_in_nonzero])\n        e_minus1_uN = np.sqrt(e_minus1_uN_sq)\n\n        # E_-1 for the filtered approximation u_N^f\n        # The error has two parts\n        # Part 1: Error from filtering on |k| = N. Coefficients are (phi(k)-1)*c_k\n        mask_le_N_in_nonzero = (np.abs(k_nonzero) = N)\n        \n        k_part1 = k_nonzero[mask_le_N_in_nonzero]\n        c_hat_part1 = c_hat_nonzero[mask_le_N_in_nonzero]\n        phi_part1 = np.exp(-alpha * (np.abs(k_part1) / N)**s)\n        \n        terms_part1 = (np.abs((phi_part1 - 1) * c_hat_part1)**2) / (k_part1**2)\n        sum1_sq = np.sum(terms_part1)\n\n        # Part 2: Error from truncation |k| > N. Same as for u_N.\n        sum2_sq = e_minus1_uN_sq\n        \n        e_minus1_uNf = np.sqrt(sum1_sq + sum2_sq)\n\n        all_results.append([e_inf_uN, e_inf_uNf, e_minus1_uN, e_minus1_uNf])\n\n    # Final print statement in the exact required format.\n    # The repr().replace() trick generates a space-free list-of-lists string.\n    print(repr(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}