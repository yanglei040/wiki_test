{
    "hands_on_practices": [
        {
            "introduction": "Numerical methods for partial differential equations, such as spectral and discontinuous Galerkin methods, are built upon a common framework: computations are performed on a standardized *reference element* and then mapped to the physical elements of the computational mesh. A crucial skill for analyzing these methods is understanding how function norms transform under these geometric mappings. This exercise  guides you through the foundational derivations for the scaling of $L^2$, $H^1$, and $H^{1/2}$ norms, which are the building blocks for proving the stability and convergence of virtually any modern finite element method.",
            "id": "3415344",
            "problem": "Let $\\hat K \\subset \\mathbb{R}^d$ be a fixed reference element with Lipschitz boundary $\\partial \\hat K$, where $d \\geq 2$. Let $F_K:\\hat K \\to K \\subset \\mathbb{R}^d$ be an orientation-preserving $C^1$ bijection onto its image, with Jacobian matrix $J(\\hat x) = \\nabla_{\\hat x} F_K(\\hat x)$, determinant $\\det(J(\\hat x)) > 0$, and metric tensor $G(\\hat x) = J(\\hat x)^{\\top} J(\\hat x)$. Let $u:K \\to \\mathbb{R}$ be a scalar field and let $\\hat u = u \\circ F_K$ denote its pullback to $\\hat K$. Denote by $\\partial K$ the boundary of $K$ and by $F_F = F_K|_{\\hat F}$ the restriction of $F_K$ to a $(d-1)$-dimensional face $\\hat F \\subset \\partial \\hat K$, with tangential differential $B(\\hat \\xi)$ from the tangent space at $\\hat \\xi \\in \\hat F$ to the tangent space at $x = F_F(\\hat \\xi) \\in \\partial K$, and induced surface metric $G_{\\tau}(\\hat \\xi) = B(\\hat \\xi)^{\\top} B(\\hat \\xi)$. Assume standard Sobolev spaces $H^s$ on bulk and boundary are defined in the usual way, with the $H^{1/2}$ norm on $\\partial K$ taken in the Slobodeckij sense.\n\nStarting from the change-of-variables formula and the chain rule, and using only the foundational definitions of $H^s$ norms and seminorms, perform the following tasks:\n\n1. Derive an exact expression for the $L^2$ norm of $u$ on $K$ in terms of an integral over $\\hat K$, the pullback $\\hat u$, and the geometric quantities associated with $F_K$. Your expression must be valid for curvilinear $F_K$ and must explicitly exhibit the dependence on $J$ and $G$.\n\n2. Derive an exact expression for the $H^1$ seminorm of $u$ on $K$ in terms of an integral over $\\hat K$, the gradient of $\\hat u$ with respect to the reference coordinates, and the geometric quantities associated with $F_K$. Your expression must be valid for curvilinear $F_K$ and must explicitly exhibit the dependence on $J$ and $G$.\n\n3. Derive an exact expression for the $H^{1/2}$ norm of the trace of $u$ on $\\partial K$ in terms of an integral over $\\partial \\hat K$, the pullback $\\hat u$ restricted to $\\partial \\hat K$, and the geometric quantities associated with $F_K$ on the boundary. Your expression must be valid for curvilinear $F_K$ and must explicitly exhibit the dependence on $F_K$, $G_{\\tau}$, and the Euclidean distance in the physical coordinates.\n\n4. Specialize to the affine isotropic case $F_K(\\hat x) = x_0 + h R \\hat x$ with $h>0$ and $R \\in \\mathbb{R}^{d \\times d}$ orthogonal. For this case, simplify your expressions from parts 1–3 and determine the scaling of the norms $\\|u\\|_{L^2(K)}$, $|u|_{H^1(K)}$, and $\\|u\\|_{H^{1/2}(\\partial K)}$ purely in terms of $h$ and $d$.\n\n5. Briefly discuss consequences of your results for polynomial-degree-robustness (also called $p$-robustness) of spectral methods and Discontinuous Galerkin (DG) methods, focusing on how bounds on $G$ and $G^{-1}$ and on the surface metric $G_{\\tau}$ influence the $h$- and $p$-independence of constants in approximation, inverse, and trace inequalities.\n\nReport, as your final boxed answer, the row vector containing the three isotropic affine scaling factors of the norms from part 4, in the order $\\|u\\|_{L^2(K)}$, $|u|_{H^1(K)}$, $\\|u\\|_{H^{1/2}(\\partial K)}$, expressed as powers of $h$ with parameters $d$.",
            "solution": "The user has provided a problem that is a standard, well-posed exercise in the mathematical analysis of finite element methods. The problem is scientifically grounded, objective, and contains all necessary information for its resolution. The tasks involve deriving the transformation rules for Sobolev norms under a change of variables and analyzing their scaling in a specific case, which is fundamental to understanding the stability and convergence properties of numerical methods like the Discontinuous Galerkin (DG) and spectral methods. The problem is therefore deemed **valid**.\n\nThe solution proceeds by addressing each of the five tasks in the specified order.\n\n### Part 1: $L^2(K)$ Norm\n\nWe begin with the definition of the $L^2$ norm of the function $u$ on the domain $K$:\n$$\n\\|u\\|_{L^2(K)}^2 = \\int_K u(x)^2 \\, dx\n$$\nHere, $dx$ is the standard Lebesgue measure on $\\mathbb{R}^d$. We perform a change of variables using the mapping $x = F_K(\\hat x)$, where $\\hat x \\in \\hat K$. The differential volume element transforms according to the rule:\n$$\ndx = |\\det(J(\\hat x))| \\, d\\hat x\n$$\nwhere $J(\\hat x) = \\nabla_{\\hat x} F_K(\\hat x)$ is the Jacobian matrix of the transformation. Since the mapping $F_K$ is given as orientation-preserving, its Jacobian determinant is strictly positive, i.e., $\\det(J(\\hat x)) > 0$. Therefore, the absolute value is redundant, and we have $dx = \\det(J(\\hat x)) \\, d\\hat x$.\nThe function $u$ on $K$ is related to its pullback $\\hat u$ on $\\hat K$ by the definition $\\hat u(\\hat x) = u(F_K(\\hat x))$. Substituting these relations into the norm definition, we get:\n$$\n\\|u\\|_{L^2(K)}^2 = \\int_{\\hat K} u(F_K(\\hat x))^2 \\det(J(\\hat x)) \\, d\\hat x = \\int_{\\hat K} \\hat u(\\hat x)^2 \\det(J(\\hat x)) \\, d\\hat x\n$$\nThe problem requires the expression to depend on the metric tensor $G(\\hat x) = J(\\hat x)^{\\top} J(\\hat x)$. We use the property of determinants that $\\det(A^{\\top}) = \\det(A)$ and $\\det(AB) = \\det(A)\\det(B)$.\n$$\n\\det(G(\\hat x)) = \\det(J(\\hat x)^{\\top} J(\\hat x)) = \\det(J(\\hat x)^{\\top}) \\det(J(\\hat x)) = (\\det(J(\\hat x)))^2\n$$\nSince $\\det(J(\\hat x)) > 0$, we can write $\\det(J(\\hat x)) = \\sqrt{\\det(G(\\hat x))}$.\nSubstituting this into our expression for the squared $L^2$ norm gives the final result for Part $1$:\n$$\n\\|u\\|_{L^2(K)}^2 = \\int_{\\hat K} \\hat u(\\hat x)^2 \\sqrt{\\det(G(\\hat x))} \\, d\\hat x\n$$\n\n### Part 2: $H^1(K)$ Seminorm\n\nThe $H^1$ seminorm of $u$ on $K$ is defined by the $L^2$ norm of its gradient:\n$$\n|u|_{H^1(K)}^2 = \\int_K \\|\\nabla_x u(x)\\|_2^2 \\, dx = \\int_K (\\nabla_x u(x))^{\\top} (\\nabla_x u(x)) \\, dx\n$$\nTo transform this integral to the reference element $\\hat K$, we first need to relate the gradient in physical coordinates, $\\nabla_x u$, to the gradient in reference coordinates, $\\nabla_{\\hat x} \\hat u$. We apply the chain rule to the definition $\\hat u(\\hat x) = u(F_K(\\hat x))$:\n$$\n\\nabla_{\\hat x} \\hat u(\\hat x) = \\nabla_{\\hat x} (u(F_K(\\hat x))) = (\\nabla_x F_K(\\hat x))^{\\top} (\\nabla_x u)(F_K(\\hat x)) = J(\\hat x)^{\\top} \\nabla_x u(x)\n$$\nSince the mapping $F_K$ is a $C^1$ bijection, the Jacobian $J(\\hat x)$ is invertible. We can solve for $\\nabla_x u(x)$:\n$$\n\\nabla_x u(x) = (J(\\hat x)^{\\top})^{-1} \\nabla_{\\hat x} \\hat u(\\hat x) = (J^{-1}(\\hat x))^{\\top} \\nabla_{\\hat x} \\hat u(\\hat x)\n$$\nNow we express the squared Euclidean norm of this gradient:\n$$\n\\|\\nabla_x u(x)\\|_2^2 = \\left( (J^{-1})^{\\top} \\nabla_{\\hat x} \\hat u \\right)^{\\top} \\left( (J^{-1})^{\\top} \\nabla_{\\hat x} \\hat u \\right) = (\\nabla_{\\hat x} \\hat u)^{\\top} J^{-1} (J^{-1})^{\\top} (\\nabla_{\\hat x} \\hat u)\n$$\nThe metric tensor $G$ is $G = J^{\\top}J$. Its inverse is $G^{-1} = (J^{\\top}J)^{-1} = J^{-1}(J^{\\top})^{-1} = J^{-1}(J^{-1})^{\\top}$. Thus, the quadratic form for the squared norm becomes:\n$$\n\\|\\nabla_x u(x)\\|_2^2 = (\\nabla_{\\hat x} \\hat u(\\hat x))^{\\top} G^{-1}(\\hat x) (\\nabla_{\\hat x} \\hat u(\\hat x))\n$$\nFinally, we substitute this and the change of measure $dx = \\sqrt{\\det(G(\\hat x))} \\, d\\hat x$ into the seminorm definition:\n$$\n|u|_{H^1(K)}^2 = \\int_{\\hat K} \\left( (\\nabla_{\\hat x} \\hat u(\\hat x))^{\\top} G^{-1}(\\hat x) (\\nabla_{\\hat x} \\hat u(\\hat x)) \\right) \\sqrt{\\det(G(\\hat x))} \\, d\\hat x\n$$\n\n### Part 3: $H^{1/2}(\\partial K)$ Norm\n\nThe $H^{1/2}(\\partial K)$ norm is defined as $\\|u\\|_{H^{1/2}(\\partial K)}^2 = \\|u\\|_{L^2(\\partial K)}^2 + |u|_{H^{1/2}(\\partial K)}^2$. We derive the expressions for both terms.\n\nThe $L^2$ norm on the boundary $\\partial K$ is:\n$$\n\\|u\\|_{L^2(\\partial K)}^2 = \\int_{\\partial K} u(x)^2 \\, dS_x\n$$\nwhere $dS_x$ is the surface measure on $\\partial K$. The change of variables for a surface integral is $dS_x = \\sqrt{\\det(G_{\\tau}(\\hat x))} \\, dS_{\\hat x}$, where $\\hat x \\in \\partial \\hat K$ and $G_{\\tau}$ is the surface metric tensor induced by the mapping $F_K$. With $\\hat u = u \\circ F_K$, this becomes:\n$$\n\\|u\\|_{L^2(\\partial K)}^2 = \\int_{\\partial \\hat K} \\hat u(\\hat x)^2 \\sqrt{\\det(G_{\\tau}(\\hat x))} \\, dS_{\\hat x}\n$$\n\nThe $H^{1/2}(\\partial K)$ seminorm, in its Slobodeckij-Gagliardo definition, is:\n$$\n|u|_{H^{1/2}(\\partial K)}^2 = \\int_{\\partial K} \\int_{\\partial K} \\frac{|u(x) - u(y)|^2}{\\|x-y\\|_2^{(d-1)+2(1/2)}} \\, dS_x \\, dS_y = \\int_{\\partial K} \\int_{\\partial K} \\frac{|u(x)-u(y)|^2}{\\|x - y\\|_2^d} \\, dS_x \\, dS_y\n$$\nWe perform a change of variables for both integration variables, $x = F_K(\\hat x)$ and $y = F_K(\\hat y)$, where $\\hat x, \\hat y \\in \\partial \\hat K$.\nThe terms in the integrand transform as:\n- Numerator: $|u(x) - u(y)|^2 = |\\hat u(\\hat x) - \\hat u(\\hat y)|^2$.\n- Denominator: $\\|x - y\\|_2^d = \\|F_K(\\hat x) - F_K(\\hat y)\\|_2^d$.\n- Surface elements: $dS_x = \\sqrt{\\det(G_\\tau(\\hat x))} \\, dS_{\\hat x}$ and $dS_y = \\sqrt{\\det(G_\\tau(\\hat y))} \\, dS_{\\hat y}$.\n\nSubstituting these into the double integral yields:\n$$\n|u|_{H^{1/2}(\\partial K)}^2 = \\int_{\\partial \\hat K} \\int_{\\partial \\hat K} \\frac{|\\hat u(\\hat x) - \\hat u(\\hat y)|^2}{\\|F_K(\\hat x) - F_K(\\hat y)\\|_2^d} \\sqrt{\\det(G_{\\tau}(\\hat x))} \\sqrt{\\det(G_{\\tau}(\\hat y))} \\, dS_{\\hat x} \\, dS_{\\hat y}\n$$\nCombining the $L^2$ and seminorm parts gives the full expression for the squared $H^{1/2}(\\partial K)$ norm:\n$$\n\\|u\\|_{H^{1/2}(\\partial K)}^2 = \\int_{\\partial \\hat K} \\hat u(\\hat x)^2 \\sqrt{\\det(G_{\\tau}(\\hat x))} \\, dS_{\\hat x} + \\int_{\\partial \\hat K} \\int_{\\partial \\hat K} \\frac{|\\hat u(\\hat x) - \\hat u(\\hat y)|^2}{\\|F_K(\\hat x) - F_K(\\hat y)\\|_2^d} \\sqrt{\\det(G_{\\tau}(\\hat x))} \\sqrt{\\det(G_{\\tau}(\\hat y))} \\, dS_{\\hat x} \\, dS_{\\hat y}\n$$\n\n### Part 4: Isotropic Affine Scaling\n\nWe now specialize to the affine mapping $F_K(\\hat x) = x_0 + h R \\hat x$, where $h>0$ is a scaling parameter and $R$ is an orthogonal matrix ($R^{\\top}R=I$). The Jacobian of this map is constant:\n$$\nJ = \\nabla_{\\hat x} (x_0 + h R \\hat x) = h R\n$$\nSince $R$ is orthogonal, $\\det(R) = \\pm 1$. For an orientation-preserving map, $\\det(J) = h^d \\det(R) > 0$, compelling $\\det(R) = 1$. The geometric quantities become:\n- Bulk metric tensor: $G = J^{\\top}J = (hR)^{\\top}(hR) = h^2 R^{\\top}R = h^2 I$, where $I$ is the $d \\times d$ identity matrix.\n- Inverse metric: $G^{-1} = (h^2 I)^{-1} = h^{-2} I$.\n- Volume scaling factor: $\\sqrt{\\det(G)} = \\sqrt{\\det(h^2 I)} = \\sqrt{(h^2)^d} = h^d$.\n- Surface metric tensor: The tangential derivative $B$ is the restriction of $J$ to the tangent space of $\\partial \\hat K$. Thus, $G_{\\tau} = B^{\\top}B = h^2 I_{\\tau}$, where $I_{\\tau}$ is the identity on the $(d-1)$-dimensional tangent space.\n- Surface scaling factor: $\\sqrt{\\det(G_\\tau)} = \\sqrt{\\det(h^2 I_\\tau)} = \\sqrt{(h^2)^{d-1}} = h^{d-1}$.\n\nWe substitute these into our derived expressions:\n\n- **$\\|u\\|_{L^2(K)}$ scaling:**\n  $\\|u\\|_{L^2(K)}^2 = \\int_{\\hat K} \\hat u^2 (h^d) \\, d\\hat x = h^d \\|\\hat u\\|_{L^2(\\hat K)}^2$.\n  Taking the square root, we find the scaling relationship: $\\|u\\|_{L^2(K)} = h^{d/2} \\|\\hat u\\|_{L^2(\\hat K)}$. The scaling factor is $h^{d/2}$.\n\n- **$|u|_{H^1(K)}$ scaling:**\n  $|u|_{H^1(K)}^2 = \\int_{\\hat K} (\\nabla_{\\hat x} \\hat u)^{\\top} (h^{-2}I) (\\nabla_{\\hat x} \\hat u) (h^d) \\, d\\hat x = h^{d-2} \\int_{\\hat K} \\|\\nabla_{\\hat x} \\hat u\\|_2^2 \\, d\\hat x = h^{d-2} |\\hat u|_{H^1(\\hat K)}^2$.\n  Taking the square root, we find: $|u|_{H^1(K)} = h^{(d-2)/2} |\\hat u|_{H^1(\\hat K)} = h^{d/2-1} |\\hat u|_{H^1(\\hat K)}$. The scaling factor is $h^{d/2-1}$.\n\n- **$\\|u\\|_{H^{1/2}(\\partial K)}$ scaling:**\n  We analyze the two components of the norm separately.\n  $\\|u\\|_{L^2(\\partial K)}^2 = \\int_{\\partial \\hat K} \\hat u^2 (h^{d-1}) \\, dS_{\\hat x} = h^{d-1} \\|\\hat u\\|_{L^2(\\partial \\hat K)}^2$.\n  For the seminorm, the denominator distance term is $\\|F_K(\\hat x) - F_K(\\hat y)\\|_2 = \\|hR(\\hat x - \\hat y)\\|_2 = h\\|\\hat x - \\hat y\\|_2$ since $R$ is orthogonal.\n  $|u|_{H^{1/2}(\\partial K)}^2 = \\int_{\\partial \\hat K} \\int_{\\partial \\hat K} \\frac{|\\hat u(\\hat x) - \\hat u(\\hat y)|^2}{(h\\|\\hat x - \\hat y\\|_2)^d} (h^{d-1})(h^{d-1}) \\, dS_{\\hat x} \\, dS_{\\hat y} = \\frac{h^{2d-2}}{h^d} |\\hat u|_{H^{1/2}(\\partial \\hat K)}^2$.\n  $|u|_{H^{1/2}(\\partial K)}^2 = h^{d-2} |\\hat u|_{H^{1/2}(\\partial \\hat K)}^2$.\n  So, $\\|u\\|_{H^{1/2}(\\partial K)}^2 = h^{d-1} \\|\\hat u\\|_{L^2(\\partial \\hat K)}^2 + h^{d-2} |\\hat u|_{H^{1/2}(\\partial \\hat K)}^2$.\n  For $h \\to 0$, the scaling of the sum is dominated by the term with the algebraically smallest exponent. Since $d \\ge 2$, we have $d-2  d-1$. The dominant term is $h^{d-2}$. Therefore, the overall norm scales as $\\|u\\|_{H^{1/2}(\\partial K)} \\sim \\sqrt{h^{d-2}} = h^{(d-2)/2} = h^{d/2-1}$. The scaling factor is $h^{d/2-1}$.\n\nThe three scaling factors for $\\|u\\|_{L^2(K)}$, $|u|_{H^1(K)}$, and $\\|u\\|_{H^{1/2}(\\partial K)}$ are $h^{d/2}$, $h^{d/2-1}$, and $h^{d/2-1}$, respectively.\n\n### Part 5: Discussion of Consequences\n\nThe preceding derivations are central to the analysis of finite element methods, especially concerning how element geometry affects accuracy and stability.\n\nThe equivalence between norms on the physical element $K$ and the reference element $\\hat K$ is governed by constants that depend on the geometric quantities derived: $\\sqrt{\\det(G)}$, $G^{-1}$, and $\\sqrt{\\det(G_\\tau)}$. For example, from Part $2$:\n$$\n|u|_{H^1(K)}^2 \\le \\sup_{\\hat x \\in \\hat K} \\left( \\lambda_{\\max}(G^{-1}(\\hat x)) \\sqrt{\\det(G(\\hat x))} \\right) \\cdot |\\hat u|_{H^1(\\hat K)}^2\n$$\nwhere $\\lambda_{\\max}$ denotes the maximum eigenvalue.\nThe constants in fundamental inequalities of numerical analysis—such as approximation, inverse, and trace inequalities—depend directly on these geometric factors.\n\n**$p$-robustness** refers to the requirement that these constants remain bounded, or grow controllably, as the polynomial degree $p$ of the approximation is increased.\n\n1.  **Influence of $G$ and $G^{-1}$:** In standard $h$-version FEM with affine elements, shape regularity conditions guarantee that the eigenvalues of $G$ and $G^{-1}$ are bounded uniformly in $h$. However, for high-order ($p$-version) or spectral methods on meshes with **curvilinear** elements, $J(\\hat x)$ is a non-constant polynomial. If the boundary of $K$ is sharply curved, $J(\\hat x)$ can become nearly singular in some regions of $\\hat K$. This leads to a large condition number for $G(\\hat x)$, meaning a large ratio $\\lambda_{\\max}(G) / \\lambda_{\\min}(G)$, and large norms for $G$ and $G^{-1}$. This \"geometric pollution\" causes the constants in approximation and inverse inequalities to degrade, potentially destroying $p$-robustness. For example, an inverse inequality $|u|_{H^1(K)} \\le C_{inv} \\|u\\|_{L^2(K)}$ will have a constant $C_{inv}$ that depends on these geometric factors. If $C_{inv}$ blows up, the stability of a DG method, which relies on penalty terms sized by this constant, is compromised.\n\n2.  **Influence of $G_{\\tau}$:** The surface metric $G_\\tau$ plays an analogous role for boundary and interface terms, which are critical in DG methods. If a face of an element is highly curved, $\\det(G_\\tau)$ can vary dramatically, and the ratio of the true curved surface area to the area of a reference flat face can become large. This directly affects trace inequalities, such as $\\|u\\|_{L^2(\\partial K)}^2 \\le C_T (h^{-1}\\|u\\|_{L^2(K)}^2 + h|u|_{H^1(K)}^2)$. The trace constant $C_T$ depends on the geometric factors. If $C_T$ is not well-controlled, it can lead to suboptimal error estimates and poor stability, particularly for penalty and flux terms computed on element interfaces.\n\nIn summary, for spectral and DG methods to be robust with respect to the polynomial degree $p$, especially on non-affine meshes, the geometric map $F_K$ must be chosen such that the metric tensors $G$ and $G_{\\tau}$ remain well-conditioned across the entire mesh. This is a primary challenge in high-order mesh generation.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nh^{\\frac{d}{2}}  h^{\\frac{d}{2} - 1}  h^{\\frac{d}{2} - 1}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The theory of Sobolev spaces extends beyond integer-order derivatives to include fractional and even negative orders, which correspond to spaces of distributions. The space $H^{-1}(\\Omega)$, defined as the dual space of $H_{0}^{1}(\\Omega)$, is especially important as it represents the natural space for the source term in many elliptic partial differential equations. This practice problem  provides a concrete opportunity to demystify the abstract definition of a dual norm by using the Riesz representation theorem to compute the $H^{-1}$ norm of a function through the solution of the Poisson equation.",
            "id": "3415331",
            "problem": "Let $\\Omega = (0,\\pi) \\times (0,\\pi)$ and consider the Hilbert space $H_{0}^{1}(\\Omega)$ equipped with the inner product $(\\nabla u,\\nabla v)_{L^{2}(\\Omega)} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\,\\mathrm{d}x$. The dual space $H^{-1}(\\Omega)$ is defined as the set of continuous linear functionals on $H_{0}^{1}(\\Omega)$, with the dual norm given by\n$$\n\\|f\\|_{H^{-1}(\\Omega)} = \\sup_{0 \\neq v \\in H_{0}^{1}(\\Omega)} \\frac{\\langle f, v \\rangle}{\\|\\nabla v\\|_{L^{2}(\\Omega)}},\n$$\nwhere $\\langle f, v \\rangle$ denotes the duality pairing between $H^{-1}(\\Omega)$ and $H_{0}^{1}(\\Omega)$ that coincides with the $L^{2}(\\Omega)$ inner product when $f \\in L^{2}(\\Omega)$.\n\nUsing the Riesz representation theorem and the homogeneous Dirichlet boundary value problem for the Laplace operator, one may compute $\\|f\\|_{H^{-1}(\\Omega)}$ by solving the weak formulation of the Partial Differential Equation (PDE) $-\\Delta u = f$ in $\\Omega$ with $u|_{\\partial\\Omega} = 0$.\n\nLet $f \\in L^{2}(\\Omega)$ be given by\n$$\nf(x,y) = 2\\,\\sin(2x)\\sin(3y) \\;-\\; 5\\,\\sin(4x)\\sin(y) \\;+\\; 7\\,\\sin(5x)\\sin(5y).\n$$\nStarting from the dual norm definition and the Riesz map characterization on $H_{0}^{1}(\\Omega)$, derive a closed-form analytic expression for $\\|f\\|_{H^{-1}(\\Omega)}$ and evaluate it exactly. Your final answer must be a single closed-form expression. No rounding is required and no units are involved.",
            "solution": "The problem asks for the computation of the dual norm $\\|f\\|_{H^{-1}(\\Omega)}$ for a given function $f \\in L^{2}(\\Omega)$. The domain is $\\Omega = (0,\\pi) \\times (0,\\pi)$. The space $H_{0}^{1}(\\Omega)$ is equipped with the inner product $(u,v)_{H_{0}^{1}(\\Omega)} = (\\nabla u, \\nabla v)_{L^{2}(\\Omega)} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\,\\mathrm{d}x$ and the corresponding norm $\\|u\\|_{H_{0}^{1}(\\Omega)} = \\|\\nabla u\\|_{L^{2}(\\Omega)}$. This is a valid norm on $H_{0}^{1}(\\Omega)$ due to the Poincaré inequality.\n\nThe dual space $H^{-1}(\\Omega)$ consists of all continuous linear functionals on $H_{0}^{1}(\\Omega)$. The norm of a functional $f \\in H^{-1}(\\Omega)$ is defined as\n$$\n\\|f\\|_{H^{-1}(\\Omega)} = \\sup_{0 \\neq v \\in H_{0}^{1}(\\Omega)} \\frac{\\langle f, v \\rangle}{\\|\\nabla v\\|_{L^{2}(\\Omega)}}\n$$\nwhere $\\langle f, v \\rangle$ is the duality pairing. Since the given function $f$ is in $L^2(\\Omega)$, this pairing is the standard $L^2$ inner product: $\\langle f, v \\rangle = (f,v)_{L^{2}(\\Omega)} = \\int_{\\Omega} fv \\,\\mathrm{d}x$.\n\nAccording to the Riesz representation theorem, for any continuous linear functional $f$ on the Hilbert space $H_{0}^{1}(\\Omega)$, there exists a unique element $u \\in H_{0}^{1}(\\Omega)$ such that the functional is represented by the inner product of the space. That is, for our $f$, there exists a unique $u \\in H_{0}^{1}(\\Omega)$ satisfying\n$$\n\\langle f, v \\rangle = (\\nabla u, \\nabla v)_{L^{2}(\\Omega)} \\quad \\forall v \\in H_{0}^{1}(\\Omega).\n$$\nSubstituting $(f,v)_{L^{2}(\\Omega)}$ for the duality pairing, we get the weak formulation of the Poisson equation with homogeneous Dirichlet boundary conditions:\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\,\\mathrm{d}x = \\int_{\\Omega} f v \\,\\mathrm{d}x \\quad \\forall v \\in H_{0}^{1}(\\Omega).\n$$\nThis corresponds to the strong form $-\\Delta u = f$ in $\\Omega$ with $u=0$ on $\\partial\\Omega$.\n\nWith this representation, the dual norm can be expressed in terms of $u$. Substituting $\\langle f, v \\rangle = (\\nabla u, \\nabla v)_{L^{2}(\\Omega)}$ into the norm definition gives\n$$\n\\|f\\|_{H^{-1}(\\Omega)} = \\sup_{0 \\neq v \\in H_{0}^{1}(\\Omega)} \\frac{(\\nabla u, \\nabla v)_{L^{2}(\\Omega)}}{\\|\\nabla v\\|_{L^{2}(\\Omega)}}.\n$$\nBy the Cauchy-Schwarz inequality for the inner product $(\\cdot, \\cdot)_{H_{0}^{1}(\\Omega)}$, the supremum is attained when $v$ is proportional to $u$. By choosing $v=u$ (and assuming $u \\neq 0$, which is true if $f \\neq 0$), we find\n$$\n\\|f\\|_{H^{-1}(\\Omega)} = \\frac{(\\nabla u, \\nabla u)_{L^{2}(\\Omega)}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}} = \\frac{\\|\\nabla u\\|_{L^{2}(\\Omega)}^2}{\\|\\nabla u\\|_{L^{2}(\\Omega)}} = \\|\\nabla u\\|_{L^{2}(\\Omega)}.\n$$\nThus, computing the $H^{-1}(\\Omega)$ norm of $f$ is equivalent to finding the solution $u$ to $-\\Delta u = f$ and then computing its $H_{0}^{1}(\\Omega)$ norm, $\\|\\nabla u\\|_{L^{2}(\\Omega)}$.\n\nTo solve the PDE, we use an eigenfunction expansion. The eigenfunctions of the negative Laplacian $-\\Delta$ on the square domain $\\Omega=(0,\\pi) \\times (0,\\pi)$ with homogeneous Dirichlet boundary conditions are\n$$\n\\phi_{m,n}(x,y) = \\sin(mx)\\sin(ny) \\quad \\text{for integers } m, n \\ge 1.\n$$\nThe corresponding eigenvalues are $\\lambda_{m,n} = m^2 + n^2$, such that $-\\Delta \\phi_{m,n} = (m^2+n^2)\\phi_{m,n}$. These eigenfunctions form an orthogonal basis of $L^2(\\Omega)$.\n\nLet's expand $f$ and $u$ in this basis:\n$$\nf(x,y) = \\sum_{m,n=1}^{\\infty} c_{m,n} \\phi_{m,n}(x,y)\n$$\n$$\nu(x,y) = \\sum_{m,n=1}^{\\infty} d_{m,n} \\phi_{m,n}(x,y)\n$$\nApplying the Laplacian to the series for $u$ yields\n$$\n-\\Delta u = -\\sum_{m,n=1}^{\\infty} d_{m,n} \\Delta \\phi_{m,n} = \\sum_{m,n=1}^{\\infty} d_{m,n} (m^2+n^2) \\phi_{m,n}(x,y).\n$$\nEquating the coefficients of the series for $-\\Delta u$ and $f$, we find the relationship between the coefficients:\n$$\nd_{m,n}(m^2+n^2) = c_{m,n} \\implies d_{m,n} = \\frac{c_{m,n}}{m^2+n^2}.\n$$\nThe given function is\n$$\nf(x,y) = 2\\,\\sin(2x)\\sin(3y) \\;-\\; 5\\,\\sin(4x)\\sin(y) \\;+\\; 7\\,\\sin(5x)\\sin(5y).\n$$\nThis is a finite sum of eigenfunctions. By direct comparison, we identify the non-zero coefficients $c_{m,n}$ of $f$:\n$$\nc_{2,3} = 2, \\quad c_{4,1} = -5, \\quad c_{5,5} = 7.\n$$\nAll other coefficients $c_{m,n}$ are zero.\n\nThe corresponding coefficients $d_{m,n}$ for the solution $u$ are:\n$$\nd_{2,3} = \\frac{c_{2,3}}{2^2+3^2} = \\frac{2}{13}, \\quad d_{4,1} = \\frac{c_{4,1}}{4^2+1^2} = \\frac{-5}{17}, \\quad d_{5,5} = \\frac{c_{5,5}}{5^2+5^2} = \\frac{7}{50}.\n$$\nNow we compute $\\|f\\|_{H^{-1}(\\Omega)} = \\|\\nabla u\\|_{L^{2}(\\Omega)}$. The squared norm is $\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = (\\nabla u, \\nabla u)_{L^{2}(\\Omega)}$. Using the weak formulation with $v=u$, we have\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = (f, u)_{L^{2}(\\Omega)} = \\int_{\\Omega} f(x,y)u(x,y)\\,\\mathrm{d}x\\mathrm{d}y.\n$$\nWe substitute the eigenfunction expansions for $f$ and $u$:\n$$\n(f, u)_{L^{2}(\\Omega)} = \\int_{\\Omega} \\left(\\sum_{m,n} c_{m,n} \\phi_{m,n}\\right) \\left(\\sum_{k,l} d_{k,l} \\phi_{k,l}\\right) \\,\\mathrm{d}x\\mathrm{d}y.\n$$\nThe eigenfunctions are orthogonal: $\\int_{\\Omega} \\phi_{m,n}\\phi_{k,l}\\,\\mathrm{d}x\\mathrm{d}y = 0$ unless $(m,n)=(k,l)$. The norm squared of an eigenfunction is\n$$\n\\|\\phi_{m,n}\\|_{L^2(\\Omega)}^2 = \\int_0^{\\pi}\\int_0^{\\pi} \\sin^2(mx)\\sin^2(ny)\\,\\mathrm{d}x\\mathrm{d}y = \\left(\\int_0^\\pi \\sin^2(mx)dx\\right)\\left(\\int_0^\\pi \\sin^2(ny)dy\\right) = \\left(\\frac{\\pi}{2}\\right)\\left(\\frac{\\pi}{2}\\right) = \\frac{\\pi^2}{4}.\n$$\nThe inner product becomes a sum over the coefficients:\n$$\n(f, u)_{L^{2}(\\Omega)} = \\sum_{m,n=1}^{\\infty} c_{m,n}d_{m,n} \\|\\phi_{m,n}\\|_{L^2(\\Omega)}^2 = \\frac{\\pi^2}{4} \\sum_{m,n=1}^{\\infty} c_{m,n}d_{m,n}.\n$$\nSubstituting $d_{m,n} = c_{m,n}/(m^2+n^2)$, we get\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{4} \\sum_{m,n=1}^{\\infty} \\frac{c_{m,n}^2}{m^2+n^2}.\n$$\nNow we plug in the specific non-zero coefficients for our function $f$:\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{4} \\left( \\frac{c_{2,3}^2}{2^2+3^2} + \\frac{c_{4,1}^2}{4^2+1^2} + \\frac{c_{5,5}^2}{5^2+5^2} \\right)\n$$\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{4} \\left( \\frac{2^2}{4+9} + \\frac{(-5)^2}{16+1} + \\frac{7^2}{25+25} \\right)\n$$\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{4} \\left( \\frac{4}{13} + \\frac{25}{17} + \\frac{49}{50} \\right).\n$$\nTo evaluate the sum, we find a common denominator for $13$, $17$, and $50$: $13 \\times 17 \\times 50 = 221 \\times 50 = 11050$.\n$$\n\\frac{4}{13} + \\frac{25}{17} + \\frac{49}{50} = \\frac{4 \\times (17 \\times 50) + 25 \\times (13 \\times 50) + 49 \\times (13 \\times 17)}{11050}\n$$\n$$\n= \\frac{4 \\times 850 + 25 \\times 650 + 49 \\times 221}{11050}\n$$\n$$\n= \\frac{3400 + 16250 + 10829}{11050}\n$$\n$$\n= \\frac{30479}{11050}.\n$$\nTherefore, the squared norm is\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{4} \\frac{30479}{11050}.\n$$\nFinally, the desired norm is the square root of this value:\n$$\n\\|f\\|_{H^{-1}(\\Omega)} = \\|\\nabla u\\|_{L^{2}(\\Omega)} = \\sqrt{\\frac{\\pi^2}{4} \\frac{30479}{11050}} = \\frac{\\pi}{2} \\sqrt{\\frac{30479}{11050}}.\n$$",
            "answer": "$$\\boxed{\\frac{\\pi}{2} \\sqrt{\\frac{30479}{11050}}}$$"
        },
        {
            "introduction": "High-order numerical methods can achieve remarkable accuracy, but their efficiency often relies on the assumption that the solution to the underlying PDE is sufficiently smooth. This assumption can fail on domains with geometric peculiarities, such as re-entrant corners, which introduce singularities that limit the solution's regularity. This seminal problem  explores a classic example of such a corner singularity, challenging you to quantify the precise Sobolev regularity of the solution and thereby understand the theoretical barrier that prevents the exponential convergence of $p$-refinement strategies.",
            "id": "3415325",
            "problem": "Consider the sector domain $\\Omega = \\{(r,\\theta) \\,:\\, 0r1,\\; 0\\theta\\omega\\}$ in two spatial dimensions, with a fixed opening angle $\\omega \\in (0,2\\pi)$. Let $u:\\Omega \\to \\mathbb{R}$ be the function defined in polar coordinates by $u(r,\\theta) = r^{\\lambda} \\sin(\\lambda \\theta)$, where $\\lambda = \\pi/\\omega$. This $u$ is a classical harmonic function in $\\Omega$ and satisfies homogeneous Dirichlet boundary conditions on the rays $\\theta=0$ and $\\theta=\\omega$. In the context of high-order polynomial approximation (commonly referred to as $p$-refinement) in Discontinuous Galerkin (DG) and spectral element methods, functions with corner singularities are known to impede exponential $p$-convergence.\n\nStarting only from the definition of the Laplace operator in polar coordinates, the definition of Sobolev spaces $H^{t}(\\Omega)$ and the classical characterization of $H^{m}(\\Omega)$ for integer $m$ via square integrability of weak derivatives, construct this setting as a counterexample in which $p$-refinement stagnates due to the non-analytic behavior of $u$ at the corner $r=0$. Specifically, quantify the Sobolev regularity threshold that limits convergence by determining the largest exponent $s_{\\max}$ such that $u \\in H^{t}(\\Omega)$ holds for all $ts_{\\max}$ but fails for $t \\ge s_{\\max}$. Express your final answer as a closed-form analytic expression in terms of $\\omega$. No numerical approximation is required.",
            "solution": "The Sobolev regularity of the function $u(r,\\theta) = r^{\\lambda} \\sin(\\lambda \\theta)$ is determined by the square-integrability of its derivatives near the corner singularity at the origin ($r=0$). We need to find the largest real number $s_{\\max}$ such that all weak derivatives of $u$ up to order $t$ are in $L^2(\\Omega)$ for any $t  s_{\\max}$.\n\nA function $v$ belongs to the integer-order Sobolev space $H^m(\\Omega)$ if all its weak derivatives $D^\\alpha v$ for multi-indices $|\\alpha| \\le m$ are square-integrable. The norm is defined by $\\|v\\|_{H^m(\\Omega)}^2 = \\sum_{|\\alpha| \\le m} \\|D^\\alpha v\\|_{L^2(\\Omega)}^2$. To determine the regularity of $u$, we analyze the behavior of its derivatives.\n\nIn polar coordinates, the Cartesian derivative operators $\\partial_x$ and $\\partial_y$ have the form $\\partial_x = \\cos\\theta \\partial_r - \\frac{\\sin\\theta}{r} \\partial_\\theta$ and $\\partial_y = \\sin\\theta \\partial_r + \\frac{\\cos\\theta}{r} \\partial_\\theta$. Notice that each application of a Cartesian derivative operator on a function of the form $f(r)g(\\theta)$ effectively reduces the power of $r$ by one, due to either the $\\partial_r$ term or the $1/r$ factor in the $\\partial_\\theta$ term.\n\nThe given function is $u(r,\\theta) = r^{\\lambda} \\sin(\\lambda \\theta)$. Any $k$-th order derivative, $D^k u$, will be a sum of terms that behave like $r^{\\lambda-k}$ near the origin. More formally, the magnitude of any $k$-th derivative is bounded by $|D^k u(r,\\theta)| \\le C_k r^{\\lambda-k}$ for some constant $C_k$ that is independent of $r$.\n\nTo check if $u \\in H^k(\\Omega)$ for an integer $k$, we must check if its $k$-th order derivatives are in $L^2(\\Omega)$. We test the convergence of the integral of $|D^k u|^2$ over $\\Omega$. Using polar coordinates, the volume element is $dA = r \\, dr \\, d\\theta$.\n$$\n\\|D^k u\\|_{L^2(\\Omega)}^2 = \\int_{\\Omega} |D^k u|^2 \\, dA = \\int_0^\\omega \\int_0^1 |D^k u(r,\\theta)|^2 r \\, dr \\, d\\theta\n$$\nThe integrand's radial part is bounded by $(C_k r^{\\lambda-k})^2 \\cdot r = C_k^2 r^{2(\\lambda-k)+1} = C_k^2 r^{2\\lambda - 2k + 1}$. The integral over $\\theta$ is finite since the domain is bounded. The convergence of the norm is therefore determined by the convergence of the radial integral near $r=0$:\n$$\n\\int_0^\\epsilon r^{2\\lambda - 2k + 1} \\, dr \\quad \\text{for some small } \\epsilon > 0.\n$$\nThis integral converges if and only if the exponent of $r$ is greater than $-1$:\n$$\n2\\lambda - 2k + 1 > -1 \\implies 2\\lambda - 2k > -2 \\implies \\lambda - k > -1 \\implies k  \\lambda + 1.\n$$\nThis shows that $u$ belongs to the integer-order Sobolev space $H^k(\\Omega)$ if and only if $k  \\lambda + 1$. If $k \\ge \\lambda + 1$, the integral diverges, and thus $u \\notin H^k(\\Omega)$.\n\nThe Sobolev regularity $s_{\\max}$ is the supremum of all real numbers $t$ such that $u \\in H^t(\\Omega)$. Based on the analysis for integer orders, which can be extended to fractional orders via interpolation theory, the regularity is limited by this condition. Therefore, $u \\in H^t(\\Omega)$ for all $t  \\lambda + 1$, but $u \\notin H^t(\\Omega)$ for $t \\ge \\lambda+1$.\n\nThe threshold is thus $s_{\\max} = \\lambda + 1$. Substituting the given expression $\\lambda = \\pi/\\omega$, we obtain the final answer. For a re-entrant corner ($\\omega > \\pi$), we have $\\lambda  1$, which implies $s_{\\max}  2$. The solution is not in $H^2(\\Omega)$, and its second derivatives are singular. This limited regularity prevents the exponential convergence rates typically expected from $p$-refinement methods, which require analytic solutions.",
            "answer": "$$\n\\boxed{1 + \\frac{\\pi}{\\omega}}\n$$"
        }
    ]
}