{
    "hands_on_practices": [
        {
            "introduction": "在我们将泛函分析问题离散化时，基函数的选择不仅仅是为了方便，它对最终线性系统的结构和计算成本有着深远的影响。这个练习将引导你比较勒让德 (Legendre) 基和切比雪夫 (Chebyshev) 基在标准 $L^2$ 内积下的表现，让你亲身体会这一原理。通过分析格兰姆 (Gram) 矩阵的结构，你将理解为什么在特定内积下选择“正确”的正交基是高效计算的关键 。",
            "id": "3413340",
            "problem": "在区间 $[-1,1]$ 上的高阶谱方法和间断 Galerkin (DG) 方法中，通常在赋有标准 $L^2$ 内积的有限维多项式空间中近似函数。设 $V_N$ 表示 $(N+1)$ 维空间 $V_N=\\operatorname{span}\\{\\varphi_0,\\dots,\\varphi_N\\}$，其上配备内积 $\\langle u,v\\rangle=\\int_{-1}^1 u(x)\\,v(x)\\,dx$。考虑 $V_N$ 的两种基的选择：由 Legendre 多项式构成的 Legendre 基 $\\{\\varphi_n\\}=\\{P_n\\}_{n=0}^N$ 和由第一类 Chebyshev 多项式构成的 Chebyshev 基 $\\{\\varphi_n\\}=\\{T_n\\}_{n=0}^N$。对于由 $F(u)=u(0)$ 定义的线性泛函 $F:V_N\\to\\mathbb{R}$，Riesz 表示定理保证了存在唯一的 $r\\in V_N$ 使得对所有 $v\\in V_N$ 都有 $\\langle r, v\\rangle = F(v)$。\n\n设 $G\\in\\mathbb{R}^{(N+1)\\times(N+1)}$ 表示 Gram 矩阵，其元素为 $G_{ij}=\\langle \\varphi_i,\\varphi_j\\rangle$；设 $c\\in\\mathbb{R}^{N+1}$ 表示 $r$ 在所选基下的系数向量，使得 $r=\\sum_{j=0}^N c_j \\varphi_j$；并设 $b\\in\\mathbb{R}^{N+1}$ 表示数据向量 $b_j=F(\\varphi_j)=\\varphi_j(0)$。那么 $c$ 是线性系统 $G c = b$ 的解。\n\n仅使用以下基本性质：(i) Legendre 多项式在 $[-1,1]$ 上关于权重 $w(x)=1$ 正交，(ii) 第一类 Chebyshev 多项式在 $[-1,1]$ 上关于权重 $w(x)=(1-x^2)^{-1/2}$ 正交，但关于权重 $w(x)=1$ 不正交，以及 (iii) $P_n$ 和 $T_n$ 都具有宇称性 $P_n(-x)=(-1)^n P_n(x)$ 和 $T_n(-x)=(-1)^n T_n(x)$，比较在相同的标准 $L^2$ 内积 $\\langle\\cdot,\\cdot\\rangle$ 下，这两种基的 Gram 矩阵 $G$ 的稀疏模式和系数向量 $c$ 的结构。\n\n选择所有正确的陈述。\n\nA. 对于使用标准 $L^2([-1,1])$ 内积的 Legendre 基 $\\{P_n\\}_{n=0}^N$，$G$ 是对角矩阵，且 Riesz 表示元的系数满足 $c_{2k+1}=0$ 和 $c_{2k} = \\frac{P_{2k}(0)}{\\|P_{2k}\\|_{L^2([-1,1])}^2}$，对所有满足 $0\\le 2k\\le N$ 的整数 $k$ 成立。\n\nB. 对于使用标准 $L^2([-1,1])$ 内积的 Chebyshev 基 $\\{T_n\\}_{n=0}^N$，$G$ 是对角矩阵，因此对所有满足 $0\\le n\\le N$ 的整数 $n$，$c_n = \\frac{T_n(0)}{\\|T_n\\|_{L^2([-1,1])}^2}$。\n\nC. 对于使用标准 $L^2([-1,1])$ 内积的 Chebyshev 基 $\\{T_n\\}_{n=0}^N$，当 $i+j$ 为奇数时 $G_{ij}=0$，但偶-偶和奇-奇块通常是稠密的；Riesz 表示元具有 $c_{2k+1}=0$，并且偶数系数 $c_{2k}$ 是在偶-偶块上建立的耦合线性系统的解。\n\nD. 在两种基下，Riesz 表示元 $r$ 都与限制在 $V_N$ 上的位于 $x=0$ 的 Dirac 分布重合。\n\nE. 在两种基下，宇称性意味着 $G$ 相对于偶次和奇次的分解是块对角矩阵；因此，对于 $F(u)=u(0)$，$G c = b$ 的奇数块是齐次的，并强制使得对所有满足 $2k+1\\le N$ 的整数 $k$ 都有 $c_{2k+1}=0$。",
            "solution": "首先将验证问题陈述的科学合理性、一致性和清晰性。\n\n### 步骤 1：提取已知条件\n- **问题域：** 区间为 $[-1, 1]$。\n- **函数空间：** $V_N = \\operatorname{span}\\{\\varphi_0, \\dots, \\varphi_N\\}$，一个 $(N+1)$ 维多项式空间。\n- **内积：** 标准 $L^2$ 内积，$\\langle u, v \\rangle = \\int_{-1}^1 u(x)v(x)dx$。\n- **$V_N$ 的基**:\n    1. Legendre 基: $\\{\\varphi_n\\} = \\{P_n\\}_{n=0}^N$。\n    2. Chebyshev 基 (第一类): $\\{\\varphi_n\\} = \\{T_n\\}_{n=0}^N$。\n- **线性泛函：** $F: V_N \\to \\mathbb{R}$ 定义为 $F(u) = u(0)$。\n- **Riesz 表示元：** 一个唯一的元素 $r \\in V_N$ 使得对所有 $v \\in V_N$ 都有 $\\langle r, v \\rangle = F(v)$。\n- **系统表示：** 表示元 $r = \\sum_{j=0}^N c_j \\varphi_j$ 的系数向量 $c \\in \\mathbb{R}^{N+1}$ 是线性系统 $Gc = b$ 的解，其中：\n    - Gram 矩阵: $G_{ij} = \\langle \\varphi_i, \\varphi_j \\rangle$。\n    - 数据向量: $b_j = F(\\varphi_j) = \\varphi_j(0)$。\n- **陈述的性质：**\n    - (i) Legendre 多项式 $\\{P_n\\}$ 在 $[-1, 1]$ 上关于权重函数 $w(x)=1$ 正交。\n    - (ii) Chebyshev 多项式 $\\{T_n\\}$ 在 $[-1, 1]$ 上关于权重函数 $w(x)=(1-x^2)^{-1/2}$ 正交，但关于 $w(x)=1$ 不正交。\n    - (iii) 两种基都具有确定的宇称性：$P_n(-x) = (-1)^n P_n(x)$ 和 $T_n(-x) = (-1)^n T_n(x)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在泛函分析和偏微分方程数值方法领域内是良定义的。\n- **科学基础：** 该问题使用了多项式空间、 $L^2$ 内积、Legendre 和 Chebyshev 多项式以及 Riesz 表示定理的标准定义。所有概念和陈述的性质在数学上都是合理的，并且是文献中的标准内容。\n- **适定性：** 在有限维 Hilbert 空间 $(V_N, \\langle \\cdot, \\cdot \\rangle)$ 中，Riesz 表示元 $r$ 的存在性和唯一性是有保证的。线性系统 $Gc=b$ 有唯一解，因为对于任何线性无关函数的基，Gram 矩阵 $G$ 都是对称正定的。问题要求比较结构性质，这是一个有意义的数学探究。\n- **客观性：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n- **完整性和一致性：** 提供了所有必要的定义和性质。没有矛盾之处。明确并正确地指出了 Chebyshev 多项式的正交权重与内积中使用的权重之间的关键区别。\n\n### 步骤 3：结论和行动\n问题陈述是有效的。我将继续推导解答。\n\n### 推导\n问题的核心在于，在相同的内积 $\\langle u, v \\rangle = \\int_{-1}^1 u(x)v(x)dx$ 下，分析对于两种不同基 $\\{\\varphi_n\\}$ 的选择，线性系统 $Gc = b$ 的结构。\n\n**基于宇称性的一般分析（适用于两种基）**\n问题指出，Legendre ($P_n$) 和 Chebyshev ($T_n$) 多项式都具有确定的宇称性：$\\varphi_n(-x) = (-1)^n \\varphi_n(x)$。这个性质对系统 $Gc=b$ 的结构有深远的影响。\n\n1.  **Gram 矩阵 $G$ 的结构**：\n    元素为 $G_{ij} = \\int_{-1}^1 \\varphi_i(x) \\varphi_j(x) dx$。被积函数是两个宇称性分别为 $(-1)^i$ 和 $(-1)^j$ 的多项式的乘积，所以被积函数的宇称性为 $(-1)^{i+j}$。积分区间是关于原点对称的区间 $[-1, 1]$。\n    如果 $i+j$ 是奇数（即，一个索引是偶数，另一个是奇数），被积函数 $\\varphi_i(x) \\varphi_j(x)$ 是一个奇函数。奇函数在对称区间上的积分为零。\n    $$ G_{ij} = 0 \\quad \\text{如果 } i+j \\text{ 是奇数。} $$\n    这意味着 Gram 矩阵 $G$ 是块对角矩阵，其中一个块耦合偶数索引的基函数，另一个块耦合奇数索引的基函数。\n\n2.  **数据向量 $b$ 的结构**：\n    元素为 $b_j = F(\\varphi_j) = \\varphi_j(0)$。\n    在 $x=0$ 处使用宇称性：$\\varphi_j(0) = (-1)^j \\varphi_j(0)$。\n    如果 $j$ 是奇数，这变成 $\\varphi_j(0) = - \\varphi_j(0)$，这意味着 $\\varphi_j(0) = 0$。\n    因此，对于任何奇数索引 $j=2k+1$，我们有 $b_{2k+1} = 0$。\n\n3.  **系数向量 $c$ 的结构**：\n    将索引划分为偶数（$E$）和奇数（$O$）。系统 $Gc=b$ 解耦为两个独立的系统：\n    $$ G_{EE} c_E = b_E $$\n    $$ G_{OO} c_O = b_O $$\n    根据我们对 $b$ 的分析，向量 $b_O$ 是零向量。所以，第二个系统是一个齐次系统：\n    $$ G_{OO} c_O = 0 $$\n    函数 $\\{\\varphi_j\\}_{j \\in O}$ 是线性无关的。因此，由它们构造的 Gram 矩阵 $G_{OO}$ 是可逆的。齐次系统的唯一解是平凡解：$c_O = 0$。\n    这意味着所有对应于奇数索引基函数的系数都为零：\n    $$ c_{2k+1} = 0 \\quad \\text{对所有满足 } 2k+1 \\le N \\text{ 的 } k。$$\n    这个结论对 Legendre 基和 Chebyshev 基都成立，因为它只依赖于它们共有的宇称性。\n\n**具体分析：Legendre 基 $\\{P_n\\}$**\n-   **Gram 矩阵：** 根据性质 (i)，Legendre 多项式关于权重 $w(x)=1$ 正交。这意味着对于 $i \\neq j$，有 $\\langle P_i, P_j \\rangle = \\int_{-1}^1 P_i(x)P_j(x)dx = 0$。因此，$G$ 是一个对角矩阵。对角线元素为 $G_{nn} = \\langle P_n, P_n \\rangle = \\|P_n\\|_{L^2([-1,1])}^2$。\n-   **系统求解：** 由于 $G$ 是对角矩阵，系统 $Gc=b$ 的求解非常简单：$G_{nn}c_n = b_n$，这给出 $c_n = b_n/G_{nn} = \\frac{P_n(0)}{\\|P_n\\|_{L^2([-1,1])}^2}$。\n-   **系数：** 如一般推导所示，$P_{2k+1}(0)=0$，所以 $c_{2k+1}=0$。对于偶数索引，公式成立为 $c_{2k} = \\frac{P_{2k}(0)}{\\|P_{2k}\\|_{L^2([-1,1])}^2}$。\n\n**具体分析：Chebyshev 基 $\\{T_n\\}$**\n-   **Gram 矩阵：** 根据性质 (ii)，Chebyshev 多项式关于权重 $w(x)=1$ *不*正交。因此，对于 $i \\neq j$，$G_{ij} = \\int_{-1}^1 T_i(x) T_j(x) dx$ 通常不为零。Gram 矩阵 $G$ **不是**对角矩阵。\n    如一般分析所示，$G$ 是块对角矩阵。偶-偶块 $G_{EE}$ 和奇-奇块 $G_{OO}$ 将是非对角的（通常是稠密的）。例如，$T_0(x)=1, T_2(x)=2x^2-1$，所以 $G_{02} = \\int_{-1}^1 T_0(x)T_2(x)dx = \\int_{-1}^1 (2x^2-1)dx = [2x^3/3 - x]_{-1}^1 = -2/3 \\neq 0$。\n-   **系统求解：** 系统解耦为 $G_{EE} c_E = b_E$ 和 $G_{OO} c_O = b_O$。\n-   **系数：** 如一般推导所示，$b_O=0$ 因此 $c_O = 0$ (即 $c_{2k+1}=0$)。偶数系数 $c_E$ 必须通过求解耦合线性系统 $G_{EE} c_E = b_E$ 来找到，其中 $b_E$ 包含元素 $T_{2k}(0)$。\n\n### 逐项分析\n\n**A. 对于使用标准 $L^2([-1,1])$ 内积的 Legendre 基 $\\{P_n\\}_{n=0}^N$，$G$ 是对角矩阵，且 Riesz 表示元的系数满足 $c_{2k+1}=0$ 和 $c_{2k} = \\frac{P_{2k}(0)}{\\|P_{2k}\\|_{L^2([-1,1])}^2}$，对所有满足 $0\\le 2k\\le N$ 的整数 $k$ 成立。**\n该陈述与我们对 Legendre 基的具体分析完全一致。Legendre 多项式关于权重 $w(x)=1$ 的正交性使得标准 $L^2$ 内积的 Gram 矩阵 $G$ 是一个对角矩阵。随后的系数公式是其直接结果。\n**结论：正确。**\n\n**B. 对于使用标准 $L^2([-1,1])$ 内积的 Chebyshev 基 $\\{T_n\\}_{n=0}^N$，$G$ 是对角矩阵，因此对所有满足 $0\\le n\\le N$ 的整数 $n$，$c_n = \\frac{T_n(0)}{\\|T_n\\|_{L^2([-1,1])}^2}$。**\n这个陈述的前提就是错误的。问题明确指出（这也是一个已知事实）Chebyshev 多项式关于权重 $w(x)=1$ 不正交。因此，标准 $L^2$ 内积的 Gram 矩阵 $G$ 不是对角矩阵。结论是基于一个错误的前提。\n**结论：错误。**\n\n**C. 对于使用标准 $L^2([-1,1])$ 内积的 Chebyshev 基 $\\{T_n\\}_{n=0}^N$，当 $i+j$ 为奇数时 $G_{ij}=0$，但偶-偶和奇-奇块通常是稠密的；Riesz 表示元具有 $c_{2k+1}=0$，并且偶数系数 $c_{2k}$ 是在偶-偶块上建立的耦合线性系统的解。**\n该陈述与我们对 Chebyshev 基的具体分析完全一致。宇称性导致当 $i+j$ 为奇数时 $G_{ij}=0$。缺少标准 $L^2$ 正交性意味着块不是对角的（通常是稠密的）。基函数在 $x=0$ 处的宇称性保证了 $b_{2k+1}=0$，这迫使 $c_{2k+1}=0$。然后，偶数系数 $c_{2k}$ 由涉及 $G$ 的偶-偶块的耦合系统确定。\n**结论：正确。**\n\n**D. 在两种基下，Riesz 表示元 $r$ 都与限制在 $V_N$ 上的位于 $x=0$ 的 Dirac 分布重合。**\n这个陈述犯了范畴错误。Riesz 表示元 $r$ 是 $V_N$ 的一个元素，这意味着它是一个次数最多为 $N$ 的多项式。而 Dirac 分布 $\\delta_0$ 不是 $L^2([-1,1])$ 中的函数，更不用说多项式了。两个数学对象“重合”意味着它们是相同的。一个多项式不可能与一个不是函数的分布相同。虽然 $r$ 确实是 $V_N$ 中满足对所有 $v \\in V_N$ 都有 $\\langle r, v \\rangle = v(0)$ 的唯一元素，这模拟了 Dirac delta 泛函在子空间 $V_N$ 上的作用，但“重合”一词是对术语的滥用，字面上是错误的。\n**结论：错误。**\n\n**E. 在两种基下，宇称性意味着 $G$ 相对于偶次和奇次的分解是块对角矩阵；因此，对于 $F(u)=u(0)$，$G c = b$ 的奇数块是齐次的，并强制使得对所有满足 $2k+1\\le N$ 的整数 $k$ 都有 $c_{2k+1}=0$。**\n这个陈述是对两种基所观察到的现象的正确概括。我们的一般分析表明，两种基共有的宇称性 $\\varphi_n(-x)=(-1)^n\\varphi_n(x)$ 足以证明 $G$ 是块对角矩阵。同样的宇称性也意味着对于奇数 $j$，$b_j = \\varphi_j(0) = 0$。这使得针对奇数索引系数的线性系统 $G_{OO}c_O = b_O$ 成为齐次的（$b_O=0$）。由于奇数基函数是线性无关的，$G_{OO}$ 是可逆的，从而迫使解为 $c_O=0$，即 $c_{2k+1}=0$。该陈述完全正确且逻辑上合理。\n**结论：正确。**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "Riesz 表示定理指出，对于给定的希尔伯特空间及其内积，线性泛函的表示是唯一的。这个练习  有力地揭示了这种依赖关系，它要求你为*同一个*线性泛函在两个*不同*的希尔伯特空间中寻找其表示。你会发现，改变几何“视角”（即内积）如何能将一个简单的代数解转变为一个微分方程的解，从而深化对该定理核心思想的理解。",
            "id": "3413314",
            "problem": "考虑张量积谱元的一维参考边 $[-1,1]$。令 $w(x)=(1-x^2)^{-1/2}$ 为 Chebyshev 权重，并定义 Hilbert 空间 $L^2_w([-1,1])$，其内积为 $(u,v)_w=\\int_{-1}^1 u(x)\\,v(x)\\,w(x)\\,dx$。令 $\\{T_n\\}_{n\\ge 0}$ 和 $\\{U_n\\}_{n\\ge 0}$ 分别表示第一类和第二类 Chebyshev 多项式。对于整数 $m\\ge 1$，考虑定义在 $L^2_w([-1,1])$ 上的连续线性泛函 $F:L^2_w([-1,1])\\to\\mathbb{R}$，其定义为\n$$\nF(u)=\\int_{-1}^1 u(x)\\,T_m(x)\\,dx.\n$$\n任务 A（在 $L^2_w$ 中的存在性、有界性和表示）：从 Hilbert 空间的 Riesz 表示定理、加权 $L^2$ 空间的基本性质以及第一类和第二类 Chebyshev 多项式（带各自权重）的正交性事实出发，(i) 证明 $F$ 在 $L^2_w([-1,1])$ 上是有界的，(ii) 推导唯一的 Riesz 表示子 $g_{L^2}\\in L^2_w([-1,1])$，使得对所有 $u\\in L^2_w([-1,1])$ 都有 $(u,g_{L^2})_w=F(u)$，以及 (iii) 写出 $g_{L^2}$ 的一个显式利用 Chebyshev 正交性的封闭形式。\n\n任务 B（与 $H^1$ 情形的对比）：在同一区间 $[-1,1]$ 上，定义 Sobolev 空间 $H^1([-1,1])$，其内积为 $(u,v)_{H^1}=\\int_{-1}^1 u(x)\\,v(x)\\,dx+\\int_{-1}^1 u'(x)\\,v'(x)\\,dx$。仅使用 Riesz 表示定理和分部积分法，推导由 $F$ 关于 $(\\cdot,\\cdot)_{H^1}$ 的唯一 Riesz 表示子 $g_{H^1}\\in H^1([-1,1])$ 所满足的强形式微分方程和自然边界条件。你不需要显式求解此边值问题。\n\n答案要求：你的最终数值或符号答案必须是任务 A 中 $g_{L^2}(x)$ 的显式封闭形式表达式。不需要单位，也不需要四舍五入。你的其余推理过程应出现在解答部分，但只有所要求的封闭形式表达式应出现在最终答案部分。",
            "solution": "此问题在数学上和科学上均被评估为有效。它提法恰当、自洽，且没有矛盾或歧义。它是在泛函分析及其在数值分析和微分方程问题中应用方面的一个标准的、非平凡的练习。\n\n解答过程首先处理任务 A，关于 Hilbert 空间 $L^2_w([-1,1])$，然后处理任务 B，关于 Sobolev 空间 $H^1([-1,1])$。\n\n### 任务 A：在 $L^2_w$ 中的存在性、有界性和表示\n\n问题要求找到线性泛函 $F:L^2_w([-1,1])\\to\\mathbb{R}$ 的 Riesz 表示子，其定义为\n$$\nF(u) = \\int_{-1}^1 u(x)\\,T_m(x)\\,dx,\n$$\n其中 $L^2_w([-1,1])$ 上的内积是 $(u,v)_w = \\int_{-1}^1 u(x)v(x)w(x)dx$，$w(x)=(1-x^2)^{-1/2}$。\n\n**i. 泛函 $F$ 的有界性**\n\n根据 Riesz 表示定理，Hilbert 空间中存在唯一的表示子，当且仅当该泛函是线性的且有界的。$F$ 的线性性从积分的线性性中是显而易见的。为了证明 $F$ 是 $L^2_w([-1,1])$ 上的有界泛函，我们必须证明存在一个常数 $C > 0$，使得对所有 $u \\in L^2_w([-1,1])$ 都有 $|F(u)| \\le C \\|u\\|_{L^2_w}$。\n\n我们可以重写 $F(u)$ 的表达式以引入权重函数 $w(x)$:\n$$\nF(u) = \\int_{-1}^1 u(x) T_m(x) dx = \\int_{-1}^1 u(x) \\left(\\frac{T_m(x)}{w(x)}\\right) w(x) dx.\n$$\n此表达式恰好是函数 $u(x)$ 与函数 $h(x) = T_m(x)/w(x)$ 在 $L^2_w([-1,1])$ 中的内积。\n$$\nF(u) = \\left(u, \\frac{T_m}{w}\\right)_w.\n$$\n对内积 $(\\cdot, \\cdot)_w$ 应用 Cauchy-Schwarz 不等式：\n$$\n|F(u)| = \\left|\\left(u, \\frac{T_m}{w}\\right)_w\\right| \\le \\|u\\|_{L^2_w} \\left\\|\\frac{T_m}{w}\\right\\|_{L^2_w}.\n$$\n泛函 $F$ 有界当且仅当 $\\|T_m/w\\|_{L^2_w}$ 是有限的。我们来计算它的平方：\n$$\n\\left\\|\\frac{T_m}{w}\\right\\|_{L^2_w}^2 = \\int_{-1}^1 \\left(\\frac{T_m(x)}{w(x)}\\right)^2 w(x) dx = \\int_{-1}^1 \\frac{T_m(x)^2}{w(x)} dx.\n$$\n代入 $w(x) = (1-x^2)^{-1/2}$，我们得到：\n$$\n\\left\\|\\frac{T_m}{w}\\right\\|_{L^2_w}^2 = \\int_{-1}^1 T_m(x)^2 \\sqrt{1-x^2} dx.\n$$\n这个积分表示 $T_m(x)$ 在加权空间 $L^2_{\\sqrt{1-x^2}}([-1,1])$ 中的范数的平方，而第二类 Chebyshev 多项式 $\\{U_n\\}_{n\\ge 0}$ 在这个空间中构成一个正交基。$U_n$ 的正交关系是 $\\int_{-1}^1 U_n(x) U_k(x) \\sqrt{1-x^2} dx = \\frac{\\pi}{2}\\delta_{nk}$。\n\n为了计算该积分，我们将 $T_m(x)$ 用 $U_k(x)$ 表示。\n对于 $m=1$，我们有 $T_1(x) = x$ 和 $U_1(x) = 2x$，因此 $T_1(x) = \\frac{1}{2}U_1(x)$。\n对于 $m \\ge 2$，我们使用恒等式 $T_m(x) = \\frac{1}{2}(U_m(x) - U_{m-2}(x))$。\n\n情形 $m=1$:\n$$\n\\int_{-1}^1 T_1(x)^2 \\sqrt{1-x^2} dx = \\int_{-1}^1 \\left(\\frac{1}{2}U_1(x)\\right)^2 \\sqrt{1-x^2} dx = \\frac{1}{4} \\int_{-1}^1 U_1(x)^2 \\sqrt{1-x^2} dx = \\frac{1}{4} \\left(\\frac{\\pi}{2}\\right) = \\frac{\\pi}{8}.\n$$\n情形 $m \\ge 2$:\n\\begin{align*}\n\\int_{-1}^1 T_m(x)^2 \\sqrt{1-x^2} dx = \\int_{-1}^1 \\left(\\frac{1}{2}(U_m(x) - U_{m-2}(x))\\right)^2 \\sqrt{1-x^2} dx \\\\\n= \\frac{1}{4} \\int_{-1}^1 (U_m(x)^2 - 2U_m(x)U_{m-2}(x) + U_{m-2}(x)^2) \\sqrt{1-x^2} dx.\n\\end{align*}\n由于 $U_k$ 多项式的正交性（因为 $m \\ne m-2$），交叉项积分为零。\n$$\n\\int_{-1}^1 T_m(x)^2 \\sqrt{1-x^2} dx = \\frac{1}{4} \\left( \\int_{-1}^1 U_m(x)^2 \\sqrt{1-x^2} dx + \\int_{-1}^1 U_{m-2}(x)^2 \\sqrt{1-x^2} dx \\right) = \\frac{1}{4} \\left( \\frac{\\pi}{2} + \\frac{\\pi}{2} \\right) = \\frac{\\pi}{4}.\n$$\n因为对于所有 $m \\ge 1$ 的情况，范数 $\\|T_m/w\\|_{L^2_w}$ 都是有限的，所以泛函 $F$ 是有界的。\n\n**ii. 和 iii. Riesz 表示子 $g_{L^2}$**\n\nRiesz 表示定理保证了存在唯一的元素 $g_{L^2} \\in L^2_w([-1,1])$，使得对所有 $u \\in L^2_w([-1,1])$ 都有 $F(u) = (u, g_{L^2})_w$。从第 (i) 部分的分析中，我们发现\n$$\nF(u) = \\left(u, \\frac{T_m}{w}\\right)_w.\n$$\n根据 Riesz 表示子的唯一性，我们可以直接确定 $g_{L^2}$ 为：\n$$\ng_{L^2}(x) = \\frac{T_m(x)}{w(x)} = \\frac{T_m(x)}{(1-x^2)^{-1/2}} = T_m(x)\\sqrt{1-x^2}.\n$$\n这就是表示子的封闭形式表达式。使用 Chebyshev 正交性（对于第二类多项式）是必要的，以证明该函数确实是 Hilbert 空间 $L^2_w([-1,1])$ 的一个元素，从而严格地证明了其作为表示子的作用。\n\n### 任务 B：在 $H^1$ 中的表示\n\n问题要求给出相同泛函 $F$ 的 Riesz 表示子 $g_{H^1} \\in H^1([-1,1])$ 所满足的强形式微分方程和自然边界条件，但这是相对于 $H^1$ 内积而言：\n$$\n(u,v)_{H^1} = \\int_{-1}^1 u(x)v(x)dx + \\int_{-1}^1 u'(x)v'(x)dx.\n$$\n首先，我们确认 $F$ 是 $H^1([-1,1])$ 上的有界线性泛函。线性性是平凡的。对于有界性，我们对标准 $L^2$ 内积使用 Cauchy-Schwarz 不等式：\n$$\n|F(u)| = \\left|\\int_{-1}^1 u(x)T_m(x)dx\\right| \\le \\|u\\|_{L^2([-1,1])}\\|T_m\\|_{L^2([-1,1])}.\n$$\n由于 $\\|u\\|_{L^2([-1,1])}^2 \\le \\|u\\|_{L^2([-1,1])}^2 + \\|u'\\|_{L^2([-1,1])}^2 = \\|u\\|_{H^1([-1,1])}^2$，我们有 $\\|u\\|_{L^2} \\le \\|u\\|_{H^1}$。因此，\n$$\n|F(u)| \\le \\|T_m\\|_{L^2([-1,1])} \\|u\\|_{H^1([-1,1])}.\n$$\n由于 $T_m$ 是紧区间上的多项式，其 $L^2$ 范数是有限的。所以 $F$ 在 $H^1([-1,1])$ 上是有界的。\n\n根据 Riesz 表示定理，存在唯一的 $g_{H^1} \\in H^1([-1,1])$，使得对于所有测试函数 $u \\in H^1([-1,1])$，我们有：\n$$\n(u, g_{H^1})_{H^1} = F(u).\n$$\n代入定义，我们得到 $g_{H^1}$ 的弱形式：\n$$\n\\int_{-1}^1 u(x)g_{H^1}(x)dx + \\int_{-1}^1 u'(x)g_{H^1}'(x)dx = \\int_{-1}^1 u(x)T_m(x)dx.\n$$\n为了找到强形式，我们假设 $g_{H^1}$ 足够光滑（具体来说是 $g_{H^1} \\in H^2([-1,1])$）并对包含导数的项应用分部积分法：\n$$\n\\int_{-1}^1 u'(x)g_{H^1}'(x)dx = \\left[ u(x)g_{H^1}'(x) \\right]_{-1}^1 - \\int_{-1}^1 u(x)g_{H^1}''(x)dx.\n$$\n将此代入弱形式得到：\n$$\n\\int_{-1}^1 u(x)g_{H^1}(x)dx + u(1)g_{H^1}'(1) - u(-1)g_{H^1}'(-1) - \\int_{-1}^1 u(x)g_{H^1}''(x)dx = \\int_{-1}^1 u(x)T_m(x)dx.\n$$\n重新整理各项：\n$$\n\\int_{-1}^1 u(x) \\left[ g_{H^1}(x) - g_{H^1}''(x) - T_m(x) \\right] dx + u(1)g_{H^1}'(1) - u(-1)g_{H^1}'(-1) = 0.\n$$\n该方程必须对所有 $u \\in H^1([-1,1])$ 成立。首先将 $u$ 限制在子空间 $H^1_0([-1,1])$ 中（即测试函数满足 $u(1)=u(-1)=0$），边界项消失。根据变分法基本引理，被积函数必须为零：\n$$\ng_{H^1}(x) - g_{H^1}''(x) - T_m(x) = 0 \\quad \\text{for } x \\in (-1, 1).\n$$\n这就是**强形式微分方程**：\n$$\n-g_{H^1}''(x) + g_{H^1}(x) = T_m(x).\n$$\n在满足微分方程的情况下，对于任何 $u \\in H^1([-1,1])$，变分方程中的积分项为零。该方程简化为边界项：\n$$\nu(1)g_{H^1}'(1) - u(-1)g_{H^1}'(-1) = 0.\n$$\n由于这对任何 $u \\in H^1([-1,1])$ 都必须成立，我们可以选择 $u(1)$ 和 $u(-1)$ 为任意值的测试函数。例如，选择一个 $u$ 使得 $u(1)=1$ 和 $u(-1)=0$，得到 $g_{H^1}'(1)=0$。选择一个 $u$ 使得 $u(1)=0$ 和 $u(-1)=1$，得到 $-g_{H^1}'(-1)=0$。这些就是**自然边界条件**：\n$$\ng_{H^1}'(1)=0 \\quad \\text{and} \\quad g_{H^1}'(-1)=0.\n$$",
            "answer": "$$\\boxed{T_m(x)\\sqrt{1-x^2}}$$"
        },
        {
            "introduction": "Riesz 表示定理在数值方法中的真正威力，在于它为处理弱形式中的各种项（如体积力、边界条件和数值通量）提供了一个统一的框架。最后的这个动手实践  是一个编码练习，你将实现一个通用算法，为间断 Galerkin 方法中常见的几种不同类型的线性泛函找到其多项式 Riesz 表示。这个练习将展示这一抽象概念在化繁为简、统一处理问题上的优雅与实用性。",
            "id": "3413278",
            "problem": "给定参考一维单元 $K = [-1,1]$ 以及局部非连续 Galerkin (DG) 有限维空间 $V_p(K) = \\mathbb{P}_p(K)$，该空间由次数至多为 $p$ 的多项式组成。考虑配备有内积 $(u,v)_K = \\int_{K} u(x)\\,v(x)\\,dx$ 的希尔伯特空间 $(V_p(K),(\\cdot,\\cdot)_K)$。根据 Riesz 表示定理，对于每个有界线性泛函 $L: V_p(K)\\to\\mathbb{R}$，存在一个唯一的表示子 $r \\in V_p(K)$，使得对于所有 $v \\in V_p(K)$，都有 $(r,v)_K = L(v)$。你的任务是针对非连续 Galerkin (DG) 方法中常见的几种黑箱线性泛函，在每个单元上局部地通过算法计算这个离散 Riesz 表示子，并对计算结果进行数值验证和分析。\n\n基本基底与设置：\n- 使用 $K$ 上的 $L^2$ 内积定义以及多项式空间 $V_p(K)$ 的性质。\n- 在 $K$ 上的数值积分必须使用具有 $n_q$ 个点的 Gauss–Legendre 求积，它对次数高达 $2n_q-1$ 的多项式是精确的。你必须确保所选的 $n_q$ 足以精确计算次数 $\\leq 2p$ 的多项式所需积分，并能稳健地构建验证积分。\n- 使用 $[-1,1]$ 上的 Legendre 多项式基 $\\{P_n\\}_{n=0}^p$ 来表示 $V_p(K)$ 中的函数。\n\n需要考虑的黑箱线性泛函：\n1. 体泛函：$L_{\\mathrm{vol}}(v) = \\int_K g(x)\\,v(x)\\,dx$，其中 $g(x)$ 显式地给定为 $g(x) = x^2$。\n2. 左端点边值泛函：$L_{\\mathrm{face}}(v) = v(-1)$。\n3. 两点数值通量泛函：$L_{\\mathrm{flux}}(v) = \\alpha\\,v(-1) + \\beta\\,v(1)$，其中 $\\alpha$ 和 $\\beta$ 是实数参数。\n\n算法要求：\n- 将每个泛函视为一个黑箱，可以在基函数上对其进行查询，以形成计算其在 $V_p(K)$ 中离散 Riesz 表示子所需的数据。\n- 在单个参考单元 $K$ 上，组装计算唯一 $r \\in V_p(K)$ 所需的离散对象，该 $r$ 满足对所有 $v \\in V_p(K)$ 都有 $(r,v)_K = L(v)$。\n- 在每个单元上局部求解 $r$ 在 Legendre 基下的系数。\n\n测试套件：\n实现以下测试用例以验证正确性并研究复杂度。每个测试按规定产生一个布尔值或一个浮点数。\n- A 类（正常路径，精确可表示性）：次数 $p=3$，体泛函 $g(x)=x^2$。计算其离散 Riesz 表示子 $r_{\\mathrm{vol}}$。在 $[-1,1]$ 上的 $201$ 个等距点上计算 $r_{\\mathrm{vol}}(x)$ 和 $g(x)$ 的值，并计算最大绝对点态误差。返回一个布尔值，指示此误差是否小于 $\\varepsilon = 10^{-12}$。\n- B 类（边值泛函）：次数 $p=4$，边值泛函 $L_{\\mathrm{face}}(v)=v(-1)$。通过为每个基函数计算 $(r_{\\mathrm{face}},\\phi_j)_K - L_{\\mathrm{face}}(\\phi_j)$ 的值来验证 Riesz 恒等式，计算使用具有足够多点数的 Gauss–Legendre 求积。返回一个布尔值，指示在所有基函数索引上的最大绝对值是否小于 $\\varepsilon = 10^{-12}$。\n- C 类（通量泛函，通用情况）：次数 $p=2$，通量参数 $(\\alpha,\\beta)=(2,-1)$。像 B 类一样验证 $(r_{\\mathrm{flux}},\\phi_j)_K - L_{\\mathrm{flux}}(\\phi_j)$，并返回一个布尔值，指示最大绝对值是否小于 $\\varepsilon = 10^{-12}$。\n- D 类（通量泛函，边界情况）：次数 $p=0$（常数），通量参数 $(\\alpha,\\beta)=(3,5)$。计算 Riesz 表示子在基 $\\{P_0\\}$ 中的系数 $c_0$。返回一个布尔值，指示 $|c_0 - (\\alpha+\\beta)/2|  10^{-15}$ 是否成立。\n- E 类（关于 $p$ 的复杂度）：使用反映每个单元局部组装加直接稠密求解的成本模型，将每单元成本定义为 $C(p) = (p+1)^2\\,(p+3) + (p+1)^3$，其中第一项对应于使用 $n_q = p+3$ 个求积点组装内积和右端项，第二项对应于稠密线性求解。对于次数集合 $\\{2,4,6,8,10,12\\}$，计算 $\\log C(p)$ 相对于 $\\log p$ 的最小二乘斜率 $\\gamma$，并将此 $\\gamma$ 作为四舍五入到两位小数的浮点数返回。\n\n数值细节：\n- 在 $[-1,1]$ 上使用 Legendre 多项式 $\\{P_n\\}_{n=0}^p$ 和具有 $n_q=p+3$ 个点的 Gauss–Legendre 求积进行组装。对于 B 类和 C 类中的验证积分，使用一个更大的求积，其大小为 $n_q^{\\mathrm{check}} = 2p+9$。\n- A-C 类的容差为 $\\varepsilon = 10^{-12}$，D 类的容差为 $10^{-15}$。\n- 所有角度（如果有的话）必须以弧度为单位；但此处不需要角度。\n- 不涉及物理单位。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含按 A-E 类顺序排列的结果，形式为方括号括起来的逗号分隔列表。例如，一个有效的输出看起来像 $[{\\rm True},{\\rm True},{\\rm True},{\\rm True},2.98]$。",
            "solution": "该问题要求为给定的有界线性泛函 $L: V_p(K) \\to \\mathbb{R}$ 计算其 Riesz 表示子 $r \\in V_p(K)$，其中 $V_p(K) = \\mathbb{P}_p(K)$ 是参考单元 $K = [-1,1]$ 上次数至多为 $p$ 的多项式空间。该空间赋有 $L^2$ 内积 $(u,v)_K = \\int_{-1}^1 u(x)v(x)dx$。Riesz 表示定理保证了唯一 $r \\in V_p(K)$ 的存在性，使得对于所有 $v \\in V_p(K)$，以下恒等式成立：\n$$\n(r, v)_K = L(v)\n$$\n\n为了通过算法找到 $r$，我们采用 Galerkin 方法。我们在 $V_p(K)$ 的一个基中表示未知多项式 $r$。问题指定了使用 Legendre 多项式基 $\\{\\phi_j(x)\\}_{j=0}^p = \\{P_j(x)\\}_{j=0}^p$。因此，我们可以将 $r(x)$ 写成这些基函数的线性组合：\n$$\nr(x) = \\sum_{i=0}^p c_i \\phi_i(x)\n$$\n其中 $\\mathbf{c} = [c_0, c_1, \\dots, c_p]^T$ 是未知系数向量。\n\n将此展开式代入 Riesz 恒等式，并利用内积的线性性，我们得到：\n$$\n\\left(\\sum_{i=0}^p c_i \\phi_i, v\\right)_K = \\sum_{i=0}^p c_i (\\phi_i, v)_K = L(v)\n$$\n此方程必须对所有 $v \\in V_p(K)$ 成立。我们只需对 $V_p(K)$ 的一组基强制其成立即可。我们选择与基函数相同的测试函数，即 $v = \\phi_j$，其中 $j=0, 1, \\dots, p$。这样可以得到一个关于 $p+1$ 个未知系数 $c_i$ 的包含 $p+1$ 个线性方程的方程组：\n$$\n\\sum_{i=0}^p c_i (\\phi_i, \\phi_j)_K = L(\\phi_j), \\quad \\text{for } j=0, 1, \\dots, p\n$$\n该方程组可以写成矩阵形式：\n$$\nM \\mathbf{c} = \\mathbf{b}\n$$\n其中：\n-   $M$ 是 $(p+1) \\times (p+1)$ 的**质量矩阵**，其元素为 $M_{ji} = (\\phi_i, \\phi_j)_K$。\n-   $\\mathbf{c}$ 是未知系数向量。\n-   $\\mathbf{b}$ 是 $(p+1) \\times 1$ 的**载荷向量**，其元素为 $b_j = L(\\phi_j)$。\n\nLegendre 多项式 $\\{P_n\\}$ 在区间 $[-1,1]$ 上是正交的，这极大地简化了质量矩阵。其正交性质为：\n$$\n(P_i, P_j)_K = \\int_{-1}^1 P_i(x) P_j(x) dx = \\frac{2}{2i+1} \\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是 Kronecker delta 符号。因此，质量矩阵 $M$ 是对角的：\n$$\nM_{ji} = \\frac{2}{2j+1} \\delta_{ij}\n$$\n线性系统 $M\\mathbf{c}=\\mathbf{b}$ 因此解耦为 $p+1$ 个独立的标量方程：\n$$\nM_{jj} c_j = b_j \\implies \\frac{2}{2j+1} c_j = b_j\n$$\n系数的解可以直接求得：\n$$\nc_j = \\frac{2j+1}{2} b_j = \\frac{2j+1}{2} L(\\phi_j)\n$$\n这避免了使用通用线性求解器的需要。主要计算任务简化为通过在每个基函数 $\\phi_j = P_j$ 上计算泛函 $L$ 的值来组装载荷向量 $\\mathbf{b}$。\n\n**各泛函的载荷向量组装：**\n1.  **体泛函**：$L_{\\mathrm{vol}}(v) = \\int_K g(x)v(x)dx$。载荷向量的分量为 $b_j = L_{\\mathrm{vol}}(P_j) = \\int_{-1}^1 g(x)P_j(x)dx$。对于 $g(x)=x^2$，被积函数为 $x^2 P_j(x)$，是一个 $j+2$ 次多项式。指定的具有 $n_q = p+3$ 个点的 Gauss-Legendre 求积对次数高达 $2(p+3)-1 = 2p+5$ 的多项式是精确的。这对于所有 $j \\le p$ 都足以精确计算该积分，因为对于 $p \\ge -3$，有 $j+2 \\le p+2 \\le 2p+5$。\n\n2.  **边值泛函**：$L_{\\mathrm{face}}(v) = v(-1)$。载荷向量的分量为 $b_j = L_{\\mathrm{face}}(P_j) = P_j(-1)$。这依赖于 Legendre 多项式的已知性质 $P_j(-1) = (-1)^j$。无需数值积分。\n\n3.  **两点数值通量泛函**：$L_{\\mathrm{flux}}(v) = \\alpha v(-1) + \\beta v(1)$。分量为 $b_j = L_{\\mathrm{flux}}(P_j) = \\alpha P_j(-1) + \\beta P_j(1)$。利用性质 $P_j(-1)=(-1)^j$ 和 $P_j(1)=1$，我们得到 $b_j = \\alpha(-1)^j + \\beta$。\n\n**测试用例分析：**\n\n-   **A 类 ($p=3, g(x)=x^2$)**：函数 $g(x)=x^2$ 是一个 2 次多项式，因此它位于空间 $V_3(K)$ 内。对于任何 $v \\in V_3(K)$，该泛函为 $L_{\\mathrm{vol}}(v) = (g,v)_K$。根据 Riesz 表示子的定义，满足对所有 $v \\in V_3(K)$ 都有 $(r,v)_K = (g,v)_K$ 的唯一元素 $r \\in V_3(K)$ 必须是 $r=g$。因此，计算出的 Riesz 表示子 $r_{\\mathrm{vol}}(x)$ 必须与 $g(x)=x^2$ 完全相同。该测试验证了计算出的多项式与 $x^2$ 之间的点态误差低于一个很小的容差，从而证实了实现的正确性。\n\n-   **B 类 ($p=4, L_{\\mathrm{face}}(v)=v(-1)$)**：这个泛函不能表示为与某个多项式的 $L^2$ 内积，因为它对应于一个 Dirac delta 分布。然而，在有限维空间 $V_p(K)$ 内，存在一个唯一的多项式表示子。该测试用例通过检查 $(r_{\\mathrm{face}}, P_j)_K - L_{\\mathrm{face}}(P_j)$ 对于所有基函数 $P_j$ 是否接近于零，来验证计算出的表示子 $r_{\\mathrm{face}}$ 的基本定义性质。此计算使用一个高阶求积法则 ($n_q^{\\mathrm{check}} = 2p+9$) 来确保积分以高精度计算，从而将任何误差隔离到底层的浮点运算中。\n\n-   **C 类 ($p=2, L_{\\mathrm{flux}}(v)$)**：与 B 类相似，该泛函涉及点值求值，并在 $V_2(K)$ 中有一个唯一的表示子。测试过程是相同的：对所有基函数数值验证其 Riesz 定义恒等式。\n\n-   **D 类 ($p=0, L_{\\mathrm{flux}}(v)$)**：此案例提供了一个简单的解析基准。对于 $p=0$，空间 $V_0(K)$ 由常数函数组成，基为 $\\{P_0(x)=1\\}$。表示子是 $r(x) = c_0 P_0(x) = c_0$。Riesz 恒等式变为 $(c_0, P_0)_K = L_{\\mathrm{flux}}(P_0)$。左边是 $\\int_{-1}^1 c_0 \\cdot 1 dx = 2c_0$。右边是 $\\alpha P_0(-1) + \\beta P_0(1) = \\alpha + \\beta$。令它们相等得到 $2c_0 = \\alpha + \\beta$，所以 $c_0 = (\\alpha+\\beta)/2$。该测试证实了通用算法能够再现此解析结果。\n\n-   **E 类（复杂度）**：此案例分析计算成本的缩放规律。提供的成本模型是 $C(p) = (p+1)^2(p+3) + (p+1)^3$。第一项模拟了使用具有 $p+3$ 个求积点的求积法则组装一个稠密质量矩阵和载荷向量的成本，而第二项模拟了一个稠密线性求解的成本。尽管我们使用正交基使得求解步骤的复杂度为 $\\mathcal{O}(p+1)$，但这个成本模型反映了一个更通用的实现。简化模型得到 $C(p) = (p+1)^2((p+3)+(p+1)) = 2(p+1)^3$。我们预期 $C(p)$ 的缩放规律为 $\\mathcal{O}(p^3)$。为了找到经验缩放指数 $\\gamma$，我们对给定 $p$ 值集合的数据点 $(\\log p, \\log C(p))$ 进行线性拟合。这条线的斜率就是所求的指数 $\\gamma$。由于 $\\log C(p) = \\log 2 + 3 \\log(p+1)$，且对于大的 $p$，$\\log(p+1) \\approx \\log p$，斜率 $\\gamma$ 应该接近 3。该计算通过执行线性最小二乘拟合来数值地找到这个斜率。",
            "answer": "```python\nimport numpy as np\nfrom scipy import special\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the Riesz representer for several linear functionals and performs validation tests.\n    \"\"\"\n    \n    results = []\n\n    # Case A: Happy path, exact representability\n    p_A = 3\n    # Assemble load vector b_j = integral(x^2 * P_j(x) dx)\n    n_q_A = p_A + 3\n    xq, wq = np.polynomial.legendre.leggauss(n_q_A)\n    b_A = np.zeros(p_A + 1)\n    g_vals = xq**2\n    for j in range(p_A + 1):\n        P_j_vals = np.polynomial.legendre.legval(xq, [1.0 if i == j else 0.0 for i in range(p_A + 1)])\n        b_A[j] = np.sum(wq * g_vals * P_j_vals)\n    \n    # Compute coefficients c_j = ((2j+1)/2) * b_j\n    j_vals = np.arange(p_A + 1)\n    c_A = (2 * j_vals + 1) / 2.0 * b_A\n    \n    # Evaluate error\n    x_eval = np.linspace(-1, 1, 201)\n    r_vol_eval = np.polynomial.legendre.legval(x_eval, c_A)\n    g_eval = x_eval**2\n    max_err_A = np.max(np.abs(r_vol_eval - g_eval))\n    results.append(max_err_A  1e-12)\n\n    # Case B: Face functional\n    p_B = 4\n    # Assemble load vector b_j = P_j(-1)\n    b_B = np.array([(-1)**j for j in range(p_B + 1)], dtype=float)\n    \n    # Compute coefficients\n    j_vals = np.arange(p_B + 1)\n    c_B = (2 * j_vals + 1) / 2.0 * b_B\n    \n    # Verify Riesz identity\n    n_q_B_check = 2 * p_B + 9\n    xq_check, wq_check = np.polynomial.legendre.leggauss(n_q_B_check)\n    r_face_eval = np.polynomial.legendre.legval(xq_check, c_B)\n    \n    errors_B = []\n    for j in range(p_B + 1):\n        P_j_vals = np.polynomial.legendre.legval(xq_check, [1.0 if i == j else 0.0 for i in range(p_B + 1)])\n        inner_prod = np.sum(wq_check * r_face_eval * P_j_vals)\n        L_val = (-1)**j\n        errors_B.append(np.abs(inner_prod - L_val))\n    \n    max_err_B = np.max(errors_B)\n    results.append(max_err_B  1e-12)\n\n    # Case C: Flux functional, general\n    p_C = 2\n    alpha_C, beta_C = 2.0, -1.0\n    # Assemble load vector b_j = alpha*P_j(-1) + beta*P_j(1)\n    b_C = np.array([alpha_C * (-1)**j + beta_C * 1 for j in range(p_C + 1)], dtype=float)\n\n    # Compute coefficients\n    j_vals = np.arange(p_C + 1)\n    c_C = (2 * j_vals + 1) / 2.0 * b_C\n    \n    # Verify Riesz identity\n    n_q_C_check = 2 * p_C + 9\n    xq_check, wq_check = np.polynomial.legendre.leggauss(n_q_C_check)\n    r_flux_eval = np.polynomial.legendre.legval(xq_check, c_C)\n    \n    errors_C = []\n    for j in range(p_C + 1):\n        P_j_vals = np.polynomial.legendre.legval(xq_check, [1.0 if i == j else 0.0 for i in range(p_C + 1)])\n        inner_prod = np.sum(wq_check * r_flux_eval * P_j_vals)\n        L_val = alpha_C * (-1)**j + beta_C * 1\n        errors_C.append(np.abs(inner_prod - L_val))\n    \n    max_err_C = np.max(errors_C)\n    results.append(max_err_C  1e-12)\n\n    # Case D: Flux functional, boundary case\n    p_D = 0\n    alpha_D, beta_D = 3.0, 5.0\n    # Assemble load vector\n    b_D = np.array([alpha_D * (-1)**0 + beta_D * 1])\n    \n    # Compute coefficients\n    j_vals = np.arange(p_D + 1)\n    c_D0 = ((2 * j_vals + 1) / 2.0 * b_D)[0]\n    \n    # Check against analytical result\n    analytical_c0 = (alpha_D + beta_D) / 2.0\n    results.append(abs(c_D0 - analytical_c0)  1e-15)\n\n    # Case E: Complexity in p\n    p_vals = np.array([2, 4, 6, 8, 10, 12], dtype=float)\n    cost = (p_vals + 1)**2 * (p_vals + 3) + (p_vals + 1)**3\n    \n    log_p = np.log(p_vals)\n    log_cost = np.log(cost)\n    \n    # Perform linear least-squares fit (degree 1 polynomial)\n    gamma, _ = np.polyfit(log_p, log_cost, 1)\n    \n    results.append(round(gamma, 2))\n\n    # Format final output\n    str_results = []\n    for res in results:\n        if isinstance(res, bool):\n            str_results.append(str(res))\n        else:\n            str_results.append(f\"{res:.2f}\" if isinstance(res, float) and res > 2.9 else str(res))\n\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        }
    ]
}