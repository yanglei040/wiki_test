{
    "hands_on_practices": [
        {
            "introduction": "The Riesz representation theorem is not just an abstract existence result; it provides a concrete blueprint for discretizing operators and functionals in numerical methods. This first exercise translates theory into practice by guiding you through the computation of the discrete Riesz representer for functionals that are the building blocks of Discontinuous Galerkin (DG) methods, such as volume integrals and boundary fluxes . By implementing the algorithm in an orthogonal Legendre basis, you will see how the problem elegantly reduces to a simple coefficient-wise calculation, avoiding a costly linear solve.",
            "id": "3413278",
            "problem": "You are given the reference one-dimensional element $K = [-1,1]$ and the local Discontinuous Galerkin (DG) finite-dimensional space $V_p(K) = \\mathbb{P}_p(K)$ of polynomials of degree at most $p$. Consider the Hilbert space $(V_p(K),(\\cdot,\\cdot)_K)$ equipped with the inner product $(u,v)_K = \\int_{K} u(x)\\,v(x)\\,dx$. By the Riesz representation theorem, for every bounded linear functional $L: V_p(K)\\to\\mathbb{R}$ there exists a unique representer $r \\in V_p(K)$ such that $(r,v)_K = L(v)$ for all $v \\in V_p(K)$. Your task is to algorithmically compute this discrete Riesz representer locally per element for several black-box linear functionals commonly arising in the Discontinuous Galerkin (DG) method, and to validate and analyze the computations numerically.\n\nFundamental basis and setting:\n- Use the definition of the $L^2$ inner product over $K$ and properties of polynomial spaces $V_p(K)$.\n- For numerical integration on $K$, you must use Gauss–Legendre quadrature with $n_q$ points, which is exact for polynomials up to degree $2n_q-1$. You must ensure that your chosen $n_q$ is sufficient to evaluate the needed integrals exactly for polynomials of degree $\\leq 2p$ and to build the verification integrals robustly.\n- Represent functions in $V_p(K)$ with respect to the Legendre polynomial basis $\\{P_n\\}_{n=0}^p$ on $[-1,1]$.\n\nBlack-box linear functionals to consider:\n1. Volume functional: $L_{\\mathrm{vol}}(v) = \\int_K g(x)\\,v(x)\\,dx$ with $g(x)$ given explicitly as $g(x) = x^2$.\n2. Face evaluation functional at the left endpoint: $L_{\\mathrm{face}}(v) = v(-1)$.\n3. Two-point numerical flux functional: $L_{\\mathrm{flux}}(v) = \\alpha\\,v(-1) + \\beta\\,v(1)$, where $\\alpha$ and $\\beta$ are real parameters.\n\nAlgorithmic requirements:\n- Treat each functional as a black box that can be queried on basis functions to form the data needed to compute its discrete Riesz representer in $V_p(K)$.\n- Assemble, on the single reference element $K$, the discrete objects required to compute the unique $r \\in V_p(K)$ satisfying $(r,v)_K = L(v)$ for all $v \\in V_p(K)$.\n- Solve locally per element for the coefficients of $r$ in the Legendre basis.\n\nTest suite:\nImplement the following test cases to validate correctness and investigate complexity. Each test produces a boolean or a float as specified.\n- Case A (happy path, exact representability): Degree $p=3$ and the volume functional with $g(x)=x^2$. Compute its discrete Riesz representer $r_{\\mathrm{vol}}$. Evaluate $r_{\\mathrm{vol}}(x)$ and $g(x)$ at $201$ equispaced points in $[-1,1]$ and compute the maximum absolute pointwise error. Return a boolean indicating whether this error is less than $\\varepsilon = 10^{-12}$.\n- Case B (face functional): Degree $p=4$ and the face functional $L_{\\mathrm{face}}(v)=v(-1)$. Verify the Riesz identity by computing, for each basis function, the quantity $(r_{\\mathrm{face}},\\phi_j)_K - L_{\\mathrm{face}}(\\phi_j)$ using Gauss–Legendre quadrature with sufficiently many points. Return a boolean indicating whether the maximum absolute value over all basis indices is less than $\\varepsilon = 10^{-12}$.\n- Case C (flux functional, general): Degree $p=2$ with flux parameters $(\\alpha,\\beta)=(2,-1)$. Verify $(r_{\\mathrm{flux}},\\phi_j)_K - L_{\\mathrm{flux}}(\\phi_j)$ as in Case B and return a boolean indicating whether the maximum absolute value is less than $\\varepsilon = 10^{-12}$.\n- Case D (flux functional, boundary case): Degree $p=0$ (constants) with flux parameters $(\\alpha,\\beta)=(3,5)$. Compute the coefficient $c_0$ of the Riesz representer in the basis $\\{P_0\\}$. Return a boolean indicating whether $|c_0 - (\\alpha+\\beta)/2| < 10^{-15}$.\n- Case E (complexity in $p$): Using a cost model that reflects local assembly plus direct dense solve per element, define the per-element cost as $C(p) = (p+1)^2\\,(p+3) + (p+1)^3$, where the first term corresponds to assembling inner products and right-hand sides with $n_q = p+3$ quadrature points, and the second term corresponds to a dense linear solve. For the set of degrees $\\{2,4,6,8,10,12\\}$, compute the least-squares slope $\\gamma$ of $\\log C(p)$ versus $\\log p$ and return this $\\gamma$ as a floating-point number rounded to two decimals.\n\nNumerical details:\n- Use Legendre polynomials $\\{P_n\\}_{n=0}^p$ on $[-1,1]$ and Gauss–Legendre quadrature with $n_q=p+3$ points for assembly. For verification integrals in Cases B and C, use a larger quadrature of size $n_q^{\\mathrm{check}} = 2p+9$.\n- The tolerance is $\\varepsilon = 10^{-12}$ for Cases A–C and $10^{-15}$ for Case D.\n- All angles, if any, must be in radians; however, no angles are needed here.\n- No physical units are involved.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases A–E. For example, a valid output would look like $[{\\rm True},{\\rm True},{\\rm True},{\\rm True},2.98]$.",
            "solution": "The problem requires the computation of the Riesz representer $r \\in V_p(K)$ for a given bounded linear functional $L: V_p(K) \\to \\mathbb{R}$, where $V_p(K) = \\mathbb{P}_p(K)$ is the space of polynomials of degree at most $p$ on the reference element $K = [-1,1]$. The space is endowed with the $L^2$ inner product, $(u,v)_K = \\int_{-1}^1 u(x)v(x)dx$. The Riesz representation theorem guarantees the existence of a unique $r \\in V_p(K)$ such that for all $v \\in V_p(K)$, the following identity holds:\n$$\n(r, v)_K = L(v)\n$$\n\nTo find $r$ algorithmically, we employ a Galerkin method. We represent the unknown polynomial $r$ in a basis of $V_p(K)$. The problem specifies the basis of Legendre polynomials, $\\{\\phi_j(x)\\}_{j=0}^p = \\{P_j(x)\\}_{j=0}^p$. Thus, we can write $r(x)$ as a linear combination of these basis functions:\n$$\nr(x) = \\sum_{i=0}^p c_i \\phi_i(x)\n$$\nwhere $\\mathbf{c} = [c_0, c_1, \\dots, c_p]^T$ is the vector of unknown coefficients.\n\nSubstituting this expansion into the Riesz identity and using the linearity of the inner product, we get:\n$$\n\\left(\\sum_{i=0}^p c_i \\phi_i, v\\right)_K = \\sum_{i=0}^p c_i (\\phi_i, v)_K = L(v)\n$$\nThis equation must hold for all $v \\in V_p(K)$. It is sufficient to enforce it for a basis of $V_p(K)$. We choose the test functions to be the same as the basis functions, $v = \\phi_j$ for $j=0, 1, \\dots, p$. This yields a system of $p+1$ linear equations for the $p+1$ unknown coefficients $c_i$:\n$$\n\\sum_{i=0}^p c_i (\\phi_i, \\phi_j)_K = L(\\phi_j), \\quad \\text{for } j=0, 1, \\dots, p\n$$\nThis system can be written in matrix form as:\n$$\nM \\mathbf{c} = \\mathbf{b}\n$$\nwhere:\n-   $M$ is the $(p+1) \\times (p+1)$ **mass matrix** with entries $M_{ji} = (\\phi_i, \\phi_j)_K$.\n-   $\\mathbf{c}$ is the vector of unknown coefficients.\n-   $\\mathbf{b}$ is the $(p+1) \\times 1$ **load vector** with entries $b_j = L(\\phi_j)$.\n\nThe Legendre polynomials $\\{P_n\\}$ are orthogonal on the interval $[-1,1]$, which greatly simplifies the mass matrix. Their orthogonality property is:\n$$\n(P_i, P_j)_K = \\int_{-1}^1 P_i(x) P_j(x) dx = \\frac{2}{2i+1} \\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. Consequently, the mass matrix $M$ is diagonal:\n$$\nM_{ji} = \\frac{2}{2j+1} \\delta_{ij}\n$$\nThe linear system $M\\mathbf{c}=\\mathbf{b}$ thus decouples into $p+1$ independent scalar equations:\n$$\nM_{jj} c_j = b_j \\implies \\frac{2}{2j+1} c_j = b_j\n$$\nThe solution for the coefficients is found directly:\n$$\nc_j = \\frac{2j+1}{2} b_j = \\frac{2j+1}{2} L(\\phi_j)\n$$\nThis avoids the need for a general-purpose linear solver. The primary computational task is reduced to assembling the load vector $\\mathbf{b}$ by evaluating the functional $L$ on each basis function $\\phi_j = P_j$.\n\n**Assembly of the Load Vector for each Functional:**\n1.  **Volume Functional**: $L_{\\mathrm{vol}}(v) = \\int_K g(x)v(x)dx$.\n    The load vector components are $b_j = L_{\\mathrm{vol}}(P_j) = \\int_{-1}^1 g(x)P_j(x)dx$. For $g(x)=x^2$, the integrand is $x^2 P_j(x)$, a polynomial of degree $j+2$. The specified Gauss-Legendre quadrature with $n_q = p+3$ points is exact for polynomials of degree up to $2(p+3)-1 = 2p+5$. This is sufficient to compute the integral exactly for all $j \\le p$, since $j+2 \\le p+2 \\le 2p+5$ for $p \\ge -3$.\n\n2.  **Face Evaluation Functional**: $L_{\\mathrm{face}}(v) = v(-1)$.\n    The load vector components are $b_j = L_{\\mathrm{face}}(P_j) = P_j(-1)$. This relies on the known property of Legendre polynomials that $P_j(-1) = (-1)^j$. No numerical integration is required.\n\n3.  **Two-Point Numerical Flux Functional**: $L_{\\mathrm{flux}}(v) = \\alpha v(-1) + \\beta v(1)$.\n    The components are $b_j = L_{\\mathrm{flux}}(P_j) = \\alpha P_j(-1) + \\beta P_j(1)$. Using the properties $P_j(-1)=(-1)^j$ and $P_j(1)=1$, we have $b_j = \\alpha(-1)^j + \\beta$.\n\n**Analysis of Test Cases:**\n\n-   **Case A ($p=3, g(x)=x^2$)**: The function $g(x)=x^2$ is a polynomial of degree $2$, so it lies within the space $V_3(K)$. For any $v \\in V_3(K)$, the functional is $L_{\\mathrm{vol}}(v) = (g,v)_K$. By definition of the Riesz representer, the unique element $r \\in V_3(K)$ satisfying $(r,v)_K = (g,v)_K$ for all $v \\in V_3(K)$ must be $r=g$. Therefore, the computed Riesz representer $r_{\\mathrm{vol}}(x)$ must be identical to $g(x)=x^2$. The test verifies that the pointwise error between the computed polynomial and $x^2$ is below a small tolerance, confirming the correctness of the implementation.\n\n-   **Case B ($p=4, L_{\\mathrm{face}}(v)=v(-1)$)**: This functional is not representable as an $L^2$ inner product with a polynomial, as it corresponds to a Dirac delta distribution. However, within the finite-dimensional space $V_p(K)$, a unique polynomial representer exists. The test case verifies the fundamental defining property of the computed representer $r_{\\mathrm{face}}$ by checking if $(r_{\\mathrm{face}}, P_j)_K - L_{\\mathrm{face}}(P_j)$ is close to zero for all basis functions $P_j$. This is evaluated using a high-order quadrature rule ($n_q^{\\mathrm{check}} = 2p+9$) to ensure the integral is computed with high accuracy, isolating any errors to the underlying floating-point arithmetic.\n\n-   **Case C ($p=2, L_{\\mathrm{flux}}(v)$)**: Similar to Case B, this functional involves evaluations at points and has a unique representer in $V_2(K)$. The test procedure is identical: verify the defining Riesz identity numerically for all basis functions.\n\n-   **Case D ($p=0, L_{\\mathrm{flux}}(v)$)**: This case provides a simple analytical benchmark. For $p=0$, the space $V_0(K)$ consists of constant functions, with basis $\\{P_0(x)=1\\}$. The representer is $r(x) = c_0 P_0(x) = c_0$. The Riesz identity becomes $(c_0, P_0)_K = L_{\\mathrm{flux}}(P_0)$. The left-hand side is $\\int_{-1}^1 c_0 \\cdot 1 dx = 2c_0$. The right-hand side is $\\alpha P_0(-1) + \\beta P_0(1) = \\alpha + \\beta$. Equating them gives $2c_0 = \\alpha + \\beta$, so $c_0 = (\\alpha+\\beta)/2$. The test confirms that the general algorithm reproduces this analytical result.\n\n-   **Case E (Complexity)**: This case analyzes the computational cost scaling. The provided cost model is $C(p) = (p+1)^2(p+3) + (p+1)^3$. The first term models the assembly of a dense mass matrix and load vector using a quadrature rule with $p+3$ points, while the second term models a dense linear solve. Although our use of an orthogonal basis makes the solve step $\\mathcal{O}(p+1)$, this cost model reflects a more general implementation. Simplifying the model gives $C(p) = (p+1)^2((p+3)+(p+1)) = 2(p+1)^3$. We expect $C(p)$ to scale as $\\mathcal{O}(p^3)$. To find the empirical scaling exponent $\\gamma$, we fit a line to the data $(\\log p, \\log C(p))$ for the given set of $p$ values. The slope of this line is the desired exponent $\\gamma$. Since $\\log C(p) = \\log 2 + 3 \\log(p+1)$, and for large $p$, $\\log(p+1) \\approx \\log p$, the slope $\\gamma$ should approach $3$. The calculation performs a linear least-squares fit to find this slope numerically.",
            "answer": "```python\nimport numpy as np\nfrom scipy import special\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the Riesz representer for several linear functionals and performs validation tests.\n    \"\"\"\n    \n    results = []\n\n    # Case A: Happy path, exact representability\n    p_A = 3\n    # Assemble load vector b_j = integral(x^2 * P_j(x) dx)\n    n_q_A = p_A + 3\n    xq, wq = np.polynomial.legendre.leggauss(n_q_A)\n    b_A = np.zeros(p_A + 1)\n    g_vals = xq**2\n    for j in range(p_A + 1):\n        P_j_vals = np.polynomial.legendre.legval(xq, [1.0 if i == j else 0.0 for i in range(p_A + 1)])\n        b_A[j] = np.sum(wq * g_vals * P_j_vals)\n    \n    # Compute coefficients c_j = ((2j+1)/2) * b_j\n    j_vals = np.arange(p_A + 1)\n    c_A = (2 * j_vals + 1) / 2.0 * b_A\n    \n    # Evaluate error\n    x_eval = np.linspace(-1, 1, 201)\n    r_vol_eval = np.polynomial.legendre.legval(x_eval, c_A)\n    g_eval = x_eval**2\n    max_err_A = np.max(np.abs(r_vol_eval - g_eval))\n    results.append(max_err_A < 1e-12)\n\n    # Case B: Face functional\n    p_B = 4\n    # Assemble load vector b_j = P_j(-1)\n    b_B = np.array([(-1)**j for j in range(p_B + 1)], dtype=float)\n    \n    # Compute coefficients\n    j_vals = np.arange(p_B + 1)\n    c_B = (2 * j_vals + 1) / 2.0 * b_B\n    \n    # Verify Riesz identity\n    n_q_B_check = 2 * p_B + 9\n    xq_check, wq_check = np.polynomial.legendre.leggauss(n_q_B_check)\n    r_face_eval = np.polynomial.legendre.legval(xq_check, c_B)\n    \n    errors_B = []\n    for j in range(p_B + 1):\n        P_j_vals = np.polynomial.legendre.legval(xq_check, [1.0 if i == j else 0.0 for i in range(p_B + 1)])\n        inner_prod = np.sum(wq_check * r_face_eval * P_j_vals)\n        L_val = (-1)**j\n        errors_B.append(np.abs(inner_prod - L_val))\n    \n    max_err_B = np.max(errors_B)\n    results.append(max_err_B < 1e-12)\n\n    # Case C: Flux functional, general\n    p_C = 2\n    alpha_C, beta_C = 2.0, -1.0\n    # Assemble load vector b_j = alpha*P_j(-1) + beta*P_j(1)\n    b_C = np.array([alpha_C * (-1)**j + beta_C * 1 for j in range(p_C + 1)], dtype=float)\n\n    # Compute coefficients\n    j_vals = np.arange(p_C + 1)\n    c_C = (2 * j_vals + 1) / 2.0 * b_C\n    \n    # Verify Riesz identity\n    n_q_C_check = 2 * p_C + 9\n    xq_check, wq_check = np.polynomial.legendre.leggauss(n_q_C_check)\n    r_flux_eval = np.polynomial.legendre.legval(xq_check, c_C)\n    \n    errors_C = []\n    for j in range(p_C + 1):\n        P_j_vals = np.polynomial.legendre.legval(xq_check, [1.0 if i == j else 0.0 for i in range(p_C + 1)])\n        inner_prod = np.sum(wq_check * r_flux_eval * P_j_vals)\n        L_val = alpha_C * (-1)**j + beta_C * 1\n        errors_C.append(np.abs(inner_prod - L_val))\n    \n    max_err_C = np.max(errors_C)\n    results.append(max_err_C < 1e-12)\n\n    # Case D: Flux functional, boundary case\n    p_D = 0\n    alpha_D, beta_D = 3.0, 5.0\n    # Assemble load vector\n    b_D = np.array([alpha_D * (-1)**0 + beta_D * 1])\n    \n    # Compute coefficients\n    j_vals = np.arange(p_D + 1)\n    c_D0 = ((2 * j_vals + 1) / 2.0 * b_D)[0]\n    \n    # Check against analytical result\n    analytical_c0 = (alpha_D + beta_D) / 2.0\n    results.append(abs(c_D0 - analytical_c0) < 1e-15)\n\n    # Case E: Complexity in p\n    p_vals = np.array([2, 4, 6, 8, 10, 12], dtype=float)\n    cost = (p_vals + 1)**2 * (p_vals + 3) + (p_vals + 1)**3\n    \n    log_p = np.log(p_vals)\n    log_cost = np.log(cost)\n    \n    # Perform linear least-squares fit (degree 1 polynomial)\n    gamma, _ = np.polyfit(log_p, log_cost, 1)\n    \n    results.append(round(gamma, 2))\n\n    # Format final output\n    str_results = []\n    for res in results:\n        if isinstance(res, bool):\n            str_results.append(str(res))\n        else:\n            str_results.append(f\"{res:.2f}\" if isinstance(res, float) and res == 2.98 else str(res))\n\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the Riesz representer is a unique polynomial within a given function space, its vector of coefficients is basis-dependent, a fact with significant computational implications. This practice explores the consequences of basis selection by comparing the familiar orthogonal Legendre polynomials with the non-orthogonal (in standard $L^2$) Chebyshev polynomials for representing the point-evaluation functional . You will analyze how the choice of basis transforms the structure of the underlying Gram matrix, changing the problem from a simple scaling to a coupled linear system.",
            "id": "3413340",
            "problem": "In high-order spectral and discontinuous Galerkin (DG) methods on the interval $[-1,1]$, it is common to approximate functions in a finite-dimensional polynomial space endowed with the standard $L^2$ inner product. Let $V_N$ denote the $(N+1)$-dimensional space $V_N=\\operatorname{span}\\{\\varphi_0,\\dots,\\varphi_N\\}$, equipped with the inner product $\\langle u,v\\rangle=\\int_{-1}^1 u(x)\\,v(x)\\,dx$. Consider two choices of bases for $V_N$: the Legendre basis $\\{\\varphi_n\\}=\\{P_n\\}_{n=0}^N$ of Legendre polynomials and the Chebyshev basis $\\{\\varphi_n\\}=\\{T_n\\}_{n=0}^N$ of Chebyshev polynomials of the first kind. For the linear functional $F:V_N\\to\\mathbb{R}$ defined by $F(u)=u(0)$, the Riesz representation theorem guarantees a unique $r\\in V_N$ such that $\\langle r, v\\rangle = F(v)$ for all $v\\in V_N$.\n\nLet $G\\in\\mathbb{R}^{(N+1)\\times(N+1)}$ denote the Gram matrix with entries $G_{ij}=\\langle \\varphi_i,\\varphi_j\\rangle$, let $c\\in\\mathbb{R}^{N+1}$ denote the coefficient vector of $r$ in the chosen basis so that $r=\\sum_{j=0}^N c_j \\varphi_j$, and let $b\\in\\mathbb{R}^{N+1}$ denote the data vector $b_j=F(\\varphi_j)=\\varphi_j(0)$. Then $c$ solves the linear system $G c = b$.\n\nUsing only the fundamental properties that (i) Legendre polynomials are orthogonal on $[-1,1]$ with respect to the weight $w(x)=1$, (ii) Chebyshev polynomials of the first kind are orthogonal on $[-1,1]$ with respect to the weight $w(x)=(1-x^2)^{-1/2}$ but not with respect to $w(x)=1$, and (iii) both $P_n$ and $T_n$ have parity $P_n(-x)=(-1)^n P_n(x)$ and $T_n(-x)=(-1)^n T_n(x)$, compare the sparsity patterns of $G$ and the structure of $c$ for the two bases under the same standard $L^2$ inner product $\\langle\\cdot,\\cdot\\rangle$.\n\nSelect all statements that are true.\n\nA. For the Legendre basis $\\{P_n\\}_{n=0}^N$ with the standard $L^2([-1,1])$ inner product, $G$ is diagonal, and the Riesz representer coefficients satisfy $c_{2k+1}=0$ and $c_{2k} = P_{2k}(0)\\big/\\|P_{2k}\\|_{L^2([-1,1])}^2$ for all integers $k$ with $0\\le 2k\\le N$.\n\nB. For the Chebyshev basis $\\{T_n\\}_{n=0}^N$ with the standard $L^2([-1,1])$ inner product, $G$ is diagonal, hence $c_n = T_n(0)\\big/\\|T_n\\|_{L^2([-1,1])}^2$ for all integers $n$ with $0\\le n\\le N$.\n\nC. For the Chebyshev basis $\\{T_n\\}_{n=0}^N$ with the standard $L^2([-1,1])$ inner product, $G_{ij}=0$ whenever $i+j$ is odd, but the even-even and odd-odd blocks are generally dense; the Riesz representer has $c_{2k+1}=0$, and the even coefficients $c_{2k}$ solve a coupled linear system posed on the even-even block.\n\nD. In both bases, the Riesz representer $r$ coincides with the Dirac distribution at $x=0$ restricted to $V_N$.\n\nE. In both bases, parity implies that $G$ is block diagonal with respect to the decomposition into even and odd degrees; consequently, for $F(u)=u(0)$, the odd block of $G c = b$ is homogeneous and forces $c_{2k+1}=0$ for all integers $k$ with $2k+1\\le N$.",
            "solution": "### Derivation\nThe core of the problem lies in analyzing the structure of the linear system $Gc = b$ for two different choices of basis $\\{\\varphi_n\\}$, under the same inner product $\\langle u, v \\rangle = \\int_{-1}^1 u(x)v(x)dx$.\n\n**General Analysis based on Parity (applies to both bases)**\nThe problem states that both Legendre ($P_n$) and Chebyshev ($T_n$) polynomials have definite parity: $\\varphi_n(-x) = (-1)^n \\varphi_n(x)$. This property has profound structural implications for the system $Gc=b$.\n\n1.  **Structure of the Gram Matrix $G$**:\n    The entries are $G_{ij} = \\int_{-1}^1 \\varphi_i(x) \\varphi_j(x) dx$. The integrand is a product of two polynomials with parities $(-1)^i$ and $(-1)^j$, so the integrand's parity is $(-1)^{i+j}$. The integral is over a symmetric interval $[-1, 1]$.\n    If $i+j$ is odd (i.e., one index is even and the other is odd), the integrand $\\varphi_i(x) \\varphi_j(x)$ is an odd function. The integral of an odd function over a symmetric interval is zero.\n    $$ G_{ij} = 0 \\quad \\text{if } i+j \\text{ is odd.} $$\n    This implies that the Gram matrix $G$ is block diagonal, with one block coupling the even-indexed basis functions and another block coupling the odd-indexed basis functions.\n\n2.  **Structure of the Data Vector $b$**:\n    The entries are $b_j = F(\\varphi_j) = \\varphi_j(0)$.\n    Using the parity property at $x=0$: $\\varphi_j(0) = (-1)^j \\varphi_j(0)$.\n    If $j$ is odd, this becomes $\\varphi_j(0) = - \\varphi_j(0)$, which implies $\\varphi_j(0) = 0$.\n    Therefore, for any odd index $j=2k+1$, we have $b_{2k+1} = 0$.\n\n3.  **Structure of the Coefficient Vector $c$**:\n    Let the indices be partitioned into even ($E$) and odd ($O$). The system $Gc=b$ decouples into two independent systems:\n    $$ G_{EE} c_E = b_E $$\n    $$ G_{OO} c_O = b_O $$\n    From our analysis of $b$, the vector $b_O$ is the zero vector. So, the second system is a homogeneous system:\n    $$ G_{OO} c_O = 0 $$\n    The functions $\\{\\varphi_j\\}_{j \\in O}$ are linearly independent. The Gram matrix $G_{OO}$ constructed from them is therefore invertible. The only solution to the homogeneous system is the trivial one: $c_O = 0$.\n    This means that all coefficients corresponding to odd-indexed basis functions are zero:\n    $$ c_{2k+1} = 0 \\quad \\text{for all } k \\text{ such that } 2k+1 \\le N. $$\n    This conclusion holds for both the Legendre and Chebyshev bases because it depends only on the parity property, which they share.\n\n**Specific Analysis: Legendre Basis $\\{P_n\\}$**\n-   **Gram Matrix:** Per property (i), Legendre polynomials are orthogonal with respect to the weight $w(x)=1$. This means $\\langle P_i, P_j \\rangle = \\int_{-1}^1 P_i(x)P_j(x)dx = 0$ for $i \\neq j$. Thus, $G$ is a diagonal matrix. The diagonal entries are $G_{nn} = \\langle P_n, P_n \\rangle = \\|P_n\\|_{L^2([-1,1])}^2$.\n-   **System Solution:** Since $G$ is diagonal, the system $Gc=b$ is trivial to solve: $G_{nn}c_n = b_n$, which gives $c_n = b_n/G_{nn} = P_n(0) \\big/ \\|P_n\\|_{L^2([-1,1])}^2$.\n-   **Coefficients:** As derived generally, $P_{2k+1}(0)=0$, so $c_{2k+1}=0$. For even indices, the formula holds as $c_{2k} = P_{2k}(0) \\big/ \\|P_{2k}\\|_{L^2([-1,1])}^2$.\n\n**Specific Analysis: Chebyshev Basis $\\{T_n\\}$**\n-   **Gram Matrix:** Per property (ii), Chebyshev polynomials are *not* orthogonal with respect to the weight $w(x)=1$. Therefore, $G_{ij} = \\int_{-1}^1 T_i(x) T_j(x) dx$ will not be zero in general for $i \\neq j$. The Gram matrix $G$ is **not** diagonal.\n    As shown in the general analysis, $G$ is block diagonal. The even-even block $G_{EE}$ and odd-odd block $G_{OO}$ will be non-diagonal (generally dense). For instance, $T_0(x)=1, T_2(x)=2x^2-1$, so $G_{02} = \\int_{-1}^1 T_0(x)T_2(x)dx = \\int_{-1}^1 (2x^2-1)dx = [2x^3/3 - x]_{-1}^1 = -2/3 \\neq 0$.\n-   **System Solution:** The system decouples as $G_{EE} c_E = b_E$ and $G_{OO} c_O = b_O$.\n-   **Coefficients:** As derived generally, $b_O=0$ and thus $c_O = 0$ (i.e., $c_{2k+1}=0$). The even coefficients $c_E$ must be found by solving the coupled linear system $G_{EE} c_E = b_E$, where $b_E$ contains the entries $T_{2k}(0)$.\n\n### Option-by-Option Analysis\n\n**A. For the Legendre basis $\\{P_n\\}_{n=0}^N$ with the standard $L^2([-1,1])$ inner product, $G$ is diagonal, and the Riesz representer coefficients satisfy $c_{2k+1}=0$ and $c_{2k} = P_{2k}(0)\\big/\\|P_{2k}\\|_{L^2([-1,1])}^2$ for all integers $k$ with $0\\le 2k\\le N$.**\nThis statement aligns perfectly with our specific analysis of the Legendre basis. The orthogonality of Legendre polynomials with respect to the weight $w(x)=1$ makes the Gram matrix $G$ for the standard $L^2$ inner product a diagonal matrix. The subsequent formulas for the coefficients are a direct consequence.\n**Verdict: Correct.**\n\n**B. For the Chebyshev basis $\\{T_n\\}_{n=0}^N$ with the standard $L^2([-1,1])$ inner product, $G$ is diagonal, hence $c_n = T_n(0)\\big/\\|T_n\\|_{L^2([-1,1])}^2$ for all integers $n$ with $0\\le n\\le N$.**\nThis statement is false at its premise. The problem explicitly states (and it is a known fact) that Chebyshev polynomials are not orthogonal with respect to the weight $w(x)=1$. Therefore, the Gram matrix $G$ for the standard $L^2$ inner product is not diagonal. The conclusion is based on a false premise.\n**Verdict: Incorrect.**\n\n**C. For the Chebyshev basis $\\{T_n\\}_{n=0}^N$ with the standard $L^2([-1,1])$ inner product, $G_{ij}=0$ whenever $i+j$ is odd, but the even-even and odd-odd blocks are generally dense; the Riesz representer has $c_{2k+1}=0$, and the even coefficients $c_{2k}$ solve a coupled linear system posed on the even-even block.**\nThis statement aligns perfectly with our specific analysis of the Chebyshev basis. The parity property leads to $G_{ij}=0$ for $i+j$ odd. The lack of standard $L^2$ orthogonality means the blocks are not diagonal (generally dense). The parity of the basis functions at $x=0$ ensures $b_{2k+1}=0$, which forces $c_{2k+1}=0$. The even coefficients $c_{2k}$ are then determined by the coupled system involving the even-even block of $G$.\n**Verdict: Correct.**\n\n**D. In both bases, the Riesz representer $r$ coincides with the Dirac distribution at $x=0$ restricted to $V_N$.**\nThis statement commits a category error. The Riesz representer $r$ is an element of $V_N$, which means it is a polynomial of degree at most $N$. The Dirac distribution, $\\delta_0$, is not a function in $L^2([-1,1])$, let alone a polynomial. For two mathematical objects to \"coincide\" implies they are identical. A polynomial cannot be identical to a distribution that is not a function. While it is true that $r$ is the unique element in $V_N$ that satisfies $\\langle r, v \\rangle = v(0)$ for all $v \\in V_N$, which mimics the action of the Dirac delta functional on the subspace $V_N$, the term \"coincides with\" is an abuse of terminology that is literally false.\n**Verdict: Incorrect.**\n\n**E. In both bases, parity implies that $G$ is block diagonal with respect to the decomposition into even and odd degrees; consequently, for $F(u)=u(0)$, the odd block of $G c = b$ is homogeneous and forces $c_{2k+1}=0$ for all integers $k$ with $2k+1\\le N$.**\nThis statement is a correct generalization of the phenomena observed for both bases. Our general analysis showed that the parity property $\\varphi_n(-x)=(-1)^n\\varphi_n(x)$, common to both bases, is sufficient to prove that $G$ is block diagonal. This same parity property implies that $b_j = \\varphi_j(0) = 0$ for odd $j$. This makes the linear system for the odd-indexed coefficients, $G_{OO}c_O = b_O$, homogeneous ($b_O=0$). Since the odd basis functions are linearly independent, $G_{OO}$ is invertible, forcing the solution $c_O=0$, which means $c_{2k+1}=0$. The statement is entirely correct and logically sound.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "The identity of the Riesz representer is fundamentally determined by the inner product defining the Hilbert space. This crucial concept is explored by finding the representer for the exact same linear functional within two different Hilbert spaces: a weighted $L^2$ space and the Sobolev space $H^1$ . This exercise reveals the power and generality of the theorem, showing how a change in the geometric structure of the space—the inner product—transforms the representer from a simple weighted polynomial into the solution of a boundary value problem.",
            "id": "3413314",
            "problem": "Consider the reference one-dimensional edge $[-1,1]$ of a tensor-product spectral element. Let $w(x)=(1-x^2)^{-1/2}$ be the Chebyshev weight and define the Hilbert space $L^2_w([-1,1])$ with inner product $(u,v)_w=\\int_{-1}^1 u(x)\\,v(x)\\,w(x)\\,dx$. Let $\\{T_n\\}_{n\\ge 0}$ and $\\{U_n\\}_{n\\ge 0}$ denote the Chebyshev polynomials of the first and second kind, respectively. For an integer $m\\ge 1$, consider the continuous linear functional $F:L^2_w([-1,1])\\to\\mathbb{R}$ defined by\n$$\nF(u)=\\int_{-1}^1 u(x)\\,T_m(x)\\,dx.\n$$\nTask A (existence, boundedness, and representation in $L^2_w$): Starting from the Riesz representation theorem for Hilbert spaces, fundamental properties of weighted $L^2$ spaces, and the Chebyshev orthogonality facts for the first and second kinds (with their respective weights), (i) prove that $F$ is bounded on $L^2_w([-1,1])$, (ii) derive the unique Riesz representer $g_{L^2}\\in L^2_w([-1,1])$ such that $(u,g_{L^2})_w=F(u)$ for all $u\\in L^2_w([-1,1])$, and (iii) write $g_{L^2}$ in a closed form that makes explicit use of Chebyshev orthogonality.\n\nTask B (contrast with the $H^1$ case): On the same interval $[-1,1]$, define the Sobolev space $H^1([-1,1])$ with inner product $(u,v)_{H^1}=\\int_{-1}^1 u(x)\\,v(x)\\,dx+\\int_{-1}^1 u'(x)\\,v'(x)\\,dx$. Using only the Riesz representation theorem and integration by parts, derive the strong form differential equation and the natural boundary conditions satisfied by the unique Riesz representer $g_{H^1}\\in H^1([-1,1])$ of $F$ with respect to $(\\cdot,\\cdot)_{H^1}$. You do not need to solve this boundary value problem explicitly.\n\nAnswer requirement: Your final numerical or symbolic answer must be the explicit closed-form expression for $g_{L^2}(x)$ from Task A. No units are required, and no rounding is needed. The remainder of your reasoning should appear in the solution section, but only the requested closed-form expression should appear in the final answer section.",
            "solution": "### Task A: Existence, Boundedness, and Representation in $L^2_w$\n\nThe problem asks to find the Riesz representer for the linear functional $F:L^2_w([-1,1])\\to\\mathbb{R}$ defined by\n$$\nF(u) = \\int_{-1}^1 u(x)\\,T_m(x)\\,dx,\n$$\nwhere the inner product on $L^2_w([-1,1])$ is $(u,v)_w = \\int_{-1}^1 u(x)v(x)w(x)dx$ with $w(x)=(1-x^2)^{-1/2}$.\n\n**i. Boundedness of the Functional $F$**\n\nAccording to the Riesz representation theorem, a unique representer exists in the Hilbert space if and only if the functional is linear and bounded. The linearity of $F$ is evident from the linearity of the integral. To prove that $F$ is a bounded functional on $L^2_w([-1,1])$, we must show there exists a constant $C > 0$ such that $|F(u)| \\le C \\|u\\|_{L^2_w}$ for all $u \\in L^2_w([-1,1])$.\n\nWe can rewrite the expression for $F(u)$ to incorporate the weight function $w(x)$:\n$$\nF(u) = \\int_{-1}^1 u(x) T_m(x) dx = \\int_{-1}^1 u(x) \\left(\\frac{T_m(x)}{w(x)}\\right) w(x) dx.\n$$\nThis expression is precisely the inner product in $L^2_w([-1,1])$ of the function $u(x)$ with the function $h(x) = T_m(x)/w(x)$.\n$$\nF(u) = \\left(u, \\frac{T_m}{w}\\right)_w.\n$$\nApplying the Cauchy-Schwarz inequality for the inner product $(\\cdot, \\cdot)_w$:\n$$\n|F(u)| = \\left|\\left(u, \\frac{T_m}{w}\\right)_w\\right| \\le \\|u\\|_{L^2_w} \\left\\|\\frac{T_m}{w}\\right\\|_{L^2_w}.\n$$\nThe functional $F$ is bounded if and only if $\\|T_m/w\\|_{L^2_w}$ is finite. Let us compute its square:\n$$\n\\left\\|\\frac{T_m}{w}\\right\\|_{L^2_w}^2 = \\int_{-1}^1 \\left(\\frac{T_m(x)}{w(x)}\\right)^2 w(x) dx = \\int_{-1}^1 \\frac{T_m(x)^2}{w(x)} dx.\n$$\nSubstituting $w(x) = (1-x^2)^{-1/2}$, we get:\n$$\n\\left\\|\\frac{T_m}{w}\\right\\|_{L^2_w}^2 = \\int_{-1}^1 T_m(x)^2 \\sqrt{1-x^2} dx.\n$$\nThis integral represents the squared norm of $T_m(x)$ in the weighted space $L^2_{\\sqrt{1-x^2}}([-1,1])$, which is the space where the Chebyshev polynomials of the second kind, $\\{U_n\\}_{n\\ge 0}$, form an orthogonal basis. The orthogonality relation for $U_n$ is $\\int_{-1}^1 U_n(x) U_k(x) \\sqrt{1-x^2} dx = \\frac{\\pi}{2}\\delta_{nk}$.\n\nTo evaluate the integral, we express $T_m(x)$ in terms of $U_k(x)$.\nFor $m=1$, we have $T_1(x) = x$ and $U_1(x) = 2x$, so $T_1(x) = \\frac{1}{2}U_1(x)$.\nFor $m \\ge 2$, we use the identity $T_m(x) = \\frac{1}{2}(U_m(x) - U_{m-2}(x))$.\n\nCase $m=1$:\n$$\n\\int_{-1}^1 T_1(x)^2 \\sqrt{1-x^2} dx = \\int_{-1}^1 \\left(\\frac{1}{2}U_1(x)\\right)^2 \\sqrt{1-x^2} dx = \\frac{1}{4} \\int_{-1}^1 U_1(x)^2 \\sqrt{1-x^2} dx = \\frac{1}{4} \\left(\\frac{\\pi}{2}\\right) = \\frac{\\pi}{8}.\n$$\nCase $m \\ge 2$:\n\\begin{align*}\n\\int_{-1}^1 T_m(x)^2 \\sqrt{1-x^2} dx &= \\int_{-1}^1 \\left(\\frac{1}{2}(U_m(x) - U_{m-2}(x))\\right)^2 \\sqrt{1-x^2} dx \\\\\n&= \\frac{1}{4} \\int_{-1}^1 (U_m(x)^2 - 2U_m(x)U_{m-2}(x) + U_{m-2}(x)^2) \\sqrt{1-x^2} dx.\n\\end{align*}\nDue to the orthogonality of the $U_k$ polynomials (since $m \\ne m-2$), the cross-term integral is zero.\n$$\n\\int_{-1}^1 T_m(x)^2 \\sqrt{1-x^2} dx = \\frac{1}{4} \\left( \\int_{-1}^1 U_m(x)^2 \\sqrt{1-x^2} dx + \\int_{-1}^1 U_{m-2}(x)^2 \\sqrt{1-x^2} dx \\right) = \\frac{1}{4} \\left( \\frac{\\pi}{2} + \\frac{\\pi}{2} \\right) = \\frac{\\pi}{4}.\n$$\nSince the norm $\\|T_m/w\\|_{L^2_w}$ is finite in all cases for $m \\ge 1$, the functional $F$ is bounded.\n\n**ii. and iii. Riesz Representer $g_{L^2}$**\n\nThe Riesz representation theorem guarantees the existence of a unique element $g_{L^2} \\in L^2_w([-1,1])$ such that $F(u) = (u, g_{L^2})_w$ for all $u \\in L^2_w([-1,1])$. From the analysis in part (i), we found that\n$$\nF(u) = \\left(u, \\frac{T_m}{w}\\right)_w.\n$$\nBy the uniqueness of the Riesz representer, we can directly identify $g_{L^2}$ as:\n$$\ng_{L^2}(x) = \\frac{T_m(x)}{w(x)} = \\frac{T_m(x)}{(1-x^2)^{-1/2}} = T_m(x)\\sqrt{1-x^2}.\n$$\nThis is the closed-form expression for the representer. The use of Chebyshev orthogonality (for polynomials of the second kind) was necessary to prove that this function is indeed an element of the Hilbert space $L^2_w([-1,1])$, thus rigorously justifying its role as the representer.\n\n### Task B: Representation in $H^1$\n\nThe problem asks for the strong form differential equation and natural boundary conditions for the Riesz representer $g_{H^1} \\in H^1([-1,1])$ of the same functional $F$, but with respect to the $H^1$ inner product:\n$$\n(u,v)_{H^1} = \\int_{-1}^1 u(x)v(x)dx + \\int_{-1}^1 u'(x)v'(x)dx.\n$$\nFirst, we confirm that $F$ is a bounded linear functional on $H^1([-1,1])$. Linearity is trivial. For boundedness, we use the Cauchy-Schwarz inequality on the standard $L^2$ inner product:\n$$\n|F(u)| = \\left|\\int_{-1}^1 u(x)T_m(x)dx\\right| \\le \\|u\\|_{L^2([-1,1])}\\|T_m\\|_{L^2([-1,1])}.\n$$\nSince $\\|u\\|_{L^2([-1,1])}^2 \\le \\|u\\|_{L^2([-1,1])}^2 + \\|u'\\|_{L^2([-1,1])}^2 = \\|u\\|_{H^1([-1,1])}^2$, we have $\\|u\\|_{L^2} \\le \\|u\\|_{H^1}$. Thus,\n$$\n|F(u)| \\le \\|T_m\\|_{L^2([-1,1])} \\|u\\|_{H^1([-1,1])}.\n$$\nAs $T_m$ is a polynomial on a compact interval, its $L^2$ norm is finite. So $F$ is bounded on $H^1([-1,1])$.\n\nBy the Riesz representation theorem, there exists a unique $g_{H^1} \\in H^1([-1,1])$ such that for all test functions $u \\in H^1([-1,1])$, we have:\n$$\n(u, g_{H^1})_{H^1} = F(u).\n$$\nSubstituting the definitions, we obtain the weak formulation for $g_{H^1}$:\n$$\n\\int_{-1}^1 u(x)g_{H^1}(x)dx + \\int_{-1}^1 u'(x)g_{H^1}'(x)dx = \\int_{-1}^1 u(x)T_m(x)dx.\n$$\nTo find the strong form, we assume $g_{H^1}$ is sufficiently smooth (specifically $g_{H^1} \\in H^2([-1,1])$) and apply integration by parts to the term containing the derivatives:\n$$\n\\int_{-1}^1 u'(x)g_{H^1}'(x)dx = \\left[ u(x)g_{H^1}'(x) \\right]_{-1}^1 - \\int_{-1}^1 u(x)g_{H^1}''(x)dx.\n$$\nSubstituting this into the weak form gives:\n$$\n\\int_{-1}^1 u(x)g_{H^1}(x)dx + u(1)g_{H^1}'(1) - u(-1)g_{H^1}'(-1) - \\int_{-1}^1 u(x)g_{H^1}''(x)dx = \\int_{-1}^1 u(x)T_m(x)dx.\n$$\nRearranging the terms:\n$$\n\\int_{-1}^1 u(x) \\left[ g_{H^1}(x) - g_{H^1}''(x) - T_m(x) \\right] dx + u(1)g_{H^1}'(1) - u(-1)g_{H^1}'(-1) = 0.\n$$\nThis equation must hold for all $u \\in H^1([-1,1])$. By first restricting $u$ to the subspace $H^1_0([-1,1])$ (i.e., test functions with $u(1)=u(-1)=0$), the boundary terms vanish. The fundamental lemma of calculus of variations then implies that the integrand must be zero:\n$$\ng_{H^1}(x) - g_{H^1}''(x) - T_m(x) = 0 \\quad \\text{for } x \\in (-1, 1).\n$$\nThis is the **strong form differential equation**:\n$$\n-g_{H^1}''(x) + g_{H^1}(x) = T_m(x).\n$$\nWith the differential equation satisfied, the integral term in the variational equation is zero for any $u \\in H^1([-1,1])$. The equation reduces to the boundary terms:\n$$\nu(1)g_{H^1}'(1) - u(-1)g_{H^1}'(-1) = 0.\n$$\nSince this must hold for any $u \\in H^1([-1,1])$, we can choose test functions where $u(1)$ and $u(-1)$ are arbitrary. For instance, choosing $u$ such that $u(1)=1$ and $u(-1)=0$ yields $g_{H^1}'(1)=0$. Choosing $u$ such that $u(1)=0$ and $u(-1)=1$ yields $-g_{H^1}'(-1)=0$. These are the **natural boundary conditions**:\n$$\ng_{H^1}'(1)=0 \\quad \\text{and} \\quad g_{H^1}'(-1)=0.\n$$",
            "answer": "$$\\boxed{T_m(x)\\sqrt{1-x^2}}$$"
        }
    ]
}