{
    "hands_on_practices": [
        {
            "introduction": "第一个动手实践是一项基础练习，我们将通过它将泊松方程的抽象变分形式转化为一个具体的线性代数系统。这个构建质量矩阵和刚度矩阵的过程是数值分析中的一项基本技能，通过分析它们的性质，我们可以揭示谱方法等先进数值方法的内在优势。",
            "id": "3426358",
            "problem": "考虑一维泊松偏微分方程 (PDE)\n$$\n- u''(x) = f(x), \\quad x \\in (-1,1),\n$$\n其具有齐次狄利克雷边界条件\n$$\nu(-1) = 0, \\quad u(1) = 0.\n$$\n从经典的变分形式出发，该形式旨在寻求 $u \\in H_0^1(-1,1)$ 使得\n$$\n\\int_{-1}^{1} u'(x) \\, v'(x) \\, dx = \\int_{-1}^{1} f(x) \\, v(x) \\, dx \\quad \\text{对所有 } v \\in H_0^1(-1,1),\n$$\n构建一个谱伽辽金方法，使用经过修正以满足边界条件的勒让德多项式基。令 $P_n(x)$ 表示 $n$ 次勒让德多项式，其关于标准 $L^2(-1,1)$ 内积正交，并定义满足狄利克雷条件的 Shen 基函数\n$$\n\\phi_k(x) = P_k(x) - P_{k+2}(x),\n$$\n对于 $k = 0,1,\\dots,p-2$，这些基函数满足 $\\phi_k(\\pm 1) = 0$。\n\n1. 推导质量矩阵 $M \\in \\mathbb{R}^{(p-1)\\times(p-1)}$ 的元素，其定义为\n$$\nM_{kl} = \\int_{-1}^{1} \\phi_k(x) \\, \\phi_l(x) \\, dx,\n$$\n利用勒让德多项式的正交性进行推导。用 $k$ 和 $l$ 明确表示其最终结构。\n\n2. 推导刚度矩阵 $S \\in \\mathbb{R}^{(p-1)\\times(p-1)}$ 的元素，其定义为\n$$\nS_{kl} = \\int_{-1}^{1} \\phi_k'(x) \\, \\phi_l'(x) \\, dx,\n$$\n使用分部积分和勒让德多项式的基本性质（包括其微分方程）。明确展示其最终结构。\n\n3. 使用第2部分中推导出的显式刚度矩阵，分析当多项式次数 $p$ 增加时 $S$ 的条件数。提供谱条件数 $\\kappa(S_p)$ 作为 $p$ 的函数的确切闭式表达式，其中 $\\kappa(S_p)$ 是 $S$ 的最大特征值与最小特征值之比。\n\n你的最终答案必须是 $\\kappa(S_p)$ 的单个闭式解析表达式，不带单位。如果你引入任何近似，请说明其理由并陈述其渐近状态。无需四舍五入。",
            "solution": "首先验证问题，以确保其科学上合理、自洽且适定。\n\n### 步骤 1：提取已知条件\n- **偏微分方程 (PDE)**：$- u''(x) = f(x)$，对于 $x \\in (-1,1)$。\n- **边界条件 (BCs)**：齐次狄利克雷，$u(-1) = 0$ 和 $u(1) = 0$。\n- **变分形式**：寻求 $u \\in H_0^1(-1,1)$ 使得 $\\int_{-1}^{1} u'(x) v'(x) dx = \\int_{-1}^{1} f(x) v(x) dx$ 对所有 $v \\in H_0^1(-1,1)$ 成立。\n- **基函数**：Shen 基，$\\phi_k(x) = P_k(x) - P_{k+2}(x)$，对于 $k = 0, 1, \\dots, p-2$，其中 $P_n(x)$ 是 $n$ 次勒让德多项式。\n- **质量矩阵定义**：$M_{kl} = \\int_{-1}^{1} \\phi_k(x) \\phi_l(x) dx$，其中 $k,l \\in \\{0, 1, \\dots, p-2\\}$。\n- **刚度矩阵定义**：$S_{kl} = \\int_{-1}^{1} \\phi_k'(x) \\phi_l'(x) dx$，其中 $k,l \\in \\{0, 1, \\dots, p-2\\}$。\n- **目标**：\n    1. 推导质量矩阵的元素 $M_{kl}$。\n    2. 推导刚度矩阵的元素 $S_{kl}$。\n    3. 推导刚度矩阵的谱条件数 $\\kappa(S_p)$ 的确切闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n1. **科学依据**：该问题是谱伽辽金方法在著名偏微分方程（泊松方程）上的标准应用。勒让德多项式和特定的 Shen 基的使用是谱方法领域的一个基本课题。所有概念在数学上都是严谨的。\n2. **适定性**：该问题是适定的。给定边界条件的偏微分方程有唯一解。各项任务是具体的数学推导。\n3. **目标**：问题以精确、客观的数学语言陈述。\n4. **自洽性与一致性**：所有必要的定义都已提供。基函数 $\\phi_k(x)$ 的定义正确，能够满足齐次狄利克雷边界条件，因为 $P_n(1) = 1$ 且 $P_n(-1) = (-1)^n$，这意味着 $\\phi_k(1) = P_k(1) - P_{k+2}(1) = 1 - 1 = 0$ 且 $\\phi_k(-1) = P_k(-1) - P_{k+2}(-1) = (-1)^k - (-1)^{k+2} = (-1)^k - (-1)^k = 0$。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n---\n\n谱伽辽金方法旨在寻找形如 $u_p(x) = \\sum_{k=0}^{p-2} c_k \\phi_k(x)$ 的近似解。将此代入变分形式，并选择测试函数 $v(x) = \\phi_l(x)$（其中 $l=0, 1, \\dots, p-2$），可得到线性方程组 $\\sum_{k=0}^{p-2} c_k S_{kl} = f_l$，其中 $S_{kl}$ 是刚度矩阵的元素，而 $f_l = \\int_{-1}^{1} f(x) \\phi_l(x) dx$。\n\n### 第1部分：质量矩阵 $M$ 的推导\n质量矩阵 $M$ 的元素由 $M_{kl} = \\int_{-1}^{1} \\phi_k(x) \\phi_l(x) dx$ 给出。我们代入基函数的定义：\n$$\nM_{kl} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))(P_l(x) - P_{l+2}(x)) dx\n$$\n展开乘积，我们得到：\n$$\nM_{kl} = \\int_{-1}^{1} P_k(x)P_l(x) dx - \\int_{-1}^{1} P_k(x)P_{l+2}(x) dx - \\int_{-1}^{1} P_{k+2}(x)P_l(x) dx + \\int_{-1}^{1} P_{k+2}(x)P_{l+2}(x) dx\n$$\n我们使用勒让德多项式的正交性：$\\int_{-1}^{1} P_m(x) P_n(x) dx = \\frac{2}{2n+1} \\delta_{mn}$，其中 $\\delta_{mn}$ 是克罗内克（Kronecker）符号。只有当多项式的指数相等时，积分才非零。我们分析 $M_{kl}$ 的非零情况：\n\n1.  **对角线元素 ($l=k$)**：\n    $$\n    M_{kk} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))^2 dx = \\int_{-1}^{1} P_k(x)^2 dx + \\int_{-1}^{1} P_{k+2}(x)^2 dx = \\frac{2}{2k+1} + \\frac{2}{2(k+2)+1} = \\frac{2}{2k+1} + \\frac{2}{2k+5}\n    $$\n    由于正交性，交叉项 $\\int_{-1}^{1} -2 P_k(x) P_{k+2}(x) dx$ 为零。\n\n2.  **非对角线元素**：只有当 $\\{k, k+2\\}$ 中的一个指数与 $\\{l, l+2\\}$ 中的一个指数匹配，且 $k \\neq l$ 时，积分才非零。这将非零元素限制在 $l=k\\pm2$ 的位置。\n    -   情况 $l=k+2$：\n        $$\n        M_{k, k+2} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))(P_{k+2}(x) - P_{k+4}(x)) dx\n        $$\n        展开式中唯一的非零项是 $\\int_{-1}^{1} -P_{k+2}(x)^2 dx$：\n        $$\n        M_{k, k+2} = -\\frac{2}{2(k+2)+1} = -\\frac{2}{2k+5}\n        $$\n    -   情况 $l=k-2$：\n        $$\n        M_{k, k-2} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))(P_{k-2}(x) - P_k(x)) dx\n        $$\n        唯一的非零项是 $\\int_{-1}^{1} -P_k(x)^2 dx$：\n        $$\n        M_{k, k-2} = -\\frac{2}{2k+1}\n        $$\n    根据矩阵的对称性 ($M_{kl} = M_{lk}$)，我们可以验证 $M_{k-2, k} = -\\frac{2}{2(k-2)+5} = -\\frac{2}{2k+1}$，结果一致。\n\n质量矩阵 $M$ 是一个对称的五对角矩阵，其元素为：\n$$\nM_{kl} =\n\\begin{cases}\n\\frac{2}{2k+1} + \\frac{2}{2k+5}   \\text{若 } l = k \\\\\n-\\frac{2}{2k+5}   \\text{若 } l = k+2 \\\\\n-\\frac{2}{2k+1}   \\text{若 } l = k-2 \\\\\n0   \\text{其他情况}\n\\end{cases}\n$$\n对于 $k,l \\in \\{0, 1, \\dots, p-2\\}$。\n\n### 第2部分：刚度矩阵 $S$ 的推导\n刚度矩阵 $S$ 的元素由 $S_{kl} = \\int_{-1}^{1} \\phi_k'(x) \\phi_l'(x) dx$ 给出。\n首先，我们求 $\\phi_k'(x)$ 的表达式。我们使用勒让德多项式导数的递推关系：\n$$\nP'_{n+1}(x) - P'_{n-1}(x) = (2n+1)P_n(x)\n$$\n将 $n$ 替换为 $n+1$，我们得到：\n$$\nP'_{n+2}(x) - P'_{n}(x) = (2(n+1)+1)P_{n+1}(x) = (2n+3)P_{n+1}(x)\n$$\n我们的基函数 $\\phi_k(x)$ 的导数是 $\\phi_k'(x) = P_k'(x) - P_{k+2}'(x)$。使用上述恒等式并令 $n=k$：\n$$\n\\phi_k'(x) = P_k'(x) - P_{k+2}'(x) = -(2k+3)P_{k+1}(x)\n$$\n这是一个非常简洁而有力的结果。现在，我们可以计算元素 $S_{kl}$：\n$$\nS_{kl} = \\int_{-1}^{1} (-(2k+3)P_{k+1}(x)) (-(2l+3)P_{l+1}(x)) dx\n$$\n$$\nS_{kl} = (2k+3)(2l+3) \\int_{-1}^{1} P_{k+1}(x)P_{l+1}(x) dx\n$$\n再次使用勒让德多项式的正交性：\n$$\n\\int_{-1}^{1} P_{k+1}(x)P_{l+1}(x) dx = \\frac{2}{2(k+1)+1} \\delta_{k+1, l+1} = \\frac{2}{2k+3} \\delta_{kl}\n$$\n克罗内克符号 $\\delta_{k+1,l+1}$ 仅在 $k+1 = l+1$ 时非零，即 $k=l$。因此，刚度矩阵 $S$ 是对角矩阵。\n对于 $k=l$，对角线元素为：\n$$\nS_{kk} = (2k+3)(2k+3) \\left(\\frac{2}{2k+3}\\right) = 2(2k+3)\n$$\n对于 $k \\neq l$，$S_{kl} = 0$。\n因此，刚度矩阵 $S$ 是一个对角矩阵，其元素为：\n$$\nS_{kl} = 2(2k+3) \\delta_{kl} \\quad \\text{对于 } k,l \\in \\{0, 1, \\dots, p-2\\}\n$$\n显式的对角线元素是 $S_{kk} = 4k+6$。\n\n### 第3部分：条件数 $\\kappa(S_p)$ 的推导\n矩阵的谱条件数是其最大特征值与最小特征值之比，$\\kappa(S_p) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$。\n对于对角矩阵，其特征值就是其对角线上的元素。$S_p$ 的特征值为：\n$$\n\\lambda_k = S_{kk} = 2(2k+3) = 4k+6, \\quad \\text{对于 } k = 0, 1, \\dots, p-2\n$$\n这些特征值构成一个严格递增的等差数列。\n最小特征值 $\\lambda_{\\min}$ 对应于最小的索引 $k=0$：\n$$\n\\lambda_{\\min} = \\lambda_0 = 4(0) + 6 = 6\n$$\n最大特征值 $\\lambda_{\\max}$ 对应于最大的索引 $k=p-2$：\n$$\n\\lambda_{\\max} = \\lambda_{p-2} = 4(p-2) + 6 = 4p - 8 + 6 = 4p - 2\n$$\n因此，刚度矩阵 $S_p$ 的谱条件数为：\n$$\n\\kappa(S_p) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{4p - 2}{6} = \\frac{2(2p-1)}{2 \\cdot 3} = \\frac{2p-1}{3}\n$$\n这个表达式是精确的，不涉及任何近似。刚度矩阵的条件数随多项式次数 $p$ 线性增长，即 $\\kappa(S_p) = O(p)$，与条件数通常按 $O(p^2)$ 比例增长的标准有限差分或有限元离散化方法相比，这是非常有利的。",
            "answer": "$$\n\\boxed{\\frac{2p-1}{3}}\n$$"
        },
        {
            "introduction": "尽管理论上的变分形式是精确的，但其计算机实现通常需要数值求积。本练习将深入探讨非连续伽辽金（DG）方法中这一关键的实现细节，展示如何确定所需的求积精度。理解这一点至关重要，因为不精确的积分（即“欠积分”）可能会破坏整个数值格式的稳定性，即使理论公式本身是稳健的。",
            "id": "3426395",
            "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$ 上带有齐次 Dirichlet 边界条件的标量泊松方程的对称内部罚分片伽辽金 (Symmetric Interior Penalty Galerkin, SIPG) 方法。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 上的一个形状正则网格，具有仿射单元映射和面 $\\mathcal{E}_{h}$。设每个单元 $K \\in \\mathcal{T}_{h}$ 上的离散试验和测试空间为总次数至多为 $p$ 的标量多项式空间，记作 $\\mathbb{P}_{p}(K)$。假设扩散系数为常数 $\\kappa = 1$ 且标准的 SIPG 双线性形式为\n$$\na(u,v) \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x \\;-\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] \\, \\mathrm{d}s \\;-\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!] \\, \\mathrm{d}s \\;+\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!] \\, \\mathrm{d}s,\n$$\n其中 $\\boldsymbol{n}_{e}$ 是面 $e$ 上的固定单位法向量，$h_{e}$ 是面直径，$\\sigma0$ 是罚参数，$[\\![\\cdot]\\!]$ 表示跨面 $e$ 的跳跃，而 $\\{\\!\\{\\cdot\\}\\!\\}$ 表示跨面 $e$ 的平均。所有从参考单元的映射都假设为仿射映射，因此雅可比矩阵是常数。\n\n假设数值积分是逐单元和逐面进行的，使用的求积规则在每个体积 $K$ 上的多项式精确次数为 $q_{\\mathrm{vol}}$，在每个面 $e$ 上的多项式精确次数为 $q_{\\mathrm{face}}$。如果一个集合 $D$ 上的求积规则能精确积分 $D$ 上所有总次数至多为 $q$ 的标量多项式，则其多项式精确次数为 $q$。\n\n从离散空间 $\\mathbb{P}_{p}(K)$、跳跃和平均算子的定义以及 SIPG 双线性形式的结构出发，确定在每个单元上对任意 $u,v \\in \\mathbb{P}_{p}(K)$ 精确积分 $a(u,v)$ 的所有项所需的最小多项式精确次数 $q_{\\mathrm{vol}}$ 和 $q_{\\mathrm{face}}$。将你的结果报告为单个行向量 $(q_{\\mathrm{vol}},\\, q_{\\mathrm{face}})$。\n\n然后，利用双线性形式和离散能量估计的第一性原理，讨论积分不足（即 $q_{\\mathrm{vol}}  2p-2$ 和/或 $q_{\\mathrm{face}}  2p$）如何影响离散双线性形式的对称性以及 $a(\\cdot,\\cdot)$ 在非连续伽辽金能量范数上的矫顽性（正定性）。最终答案不要求数值取整，也不涉及物理单位。",
            "solution": "该问题分为两部分。首先，我们必须确定使用数值求积精确计算对称内部罚分片伽辽金 (SIPG) 双线性形式所需的最小多项式精确次数 $q_{\\mathrm{vol}}$ 和 $q_{\\mathrm{face}}$。其次，我们必须讨论积分不足对所得离散系统的对称性和矫顽性的定性影响。\n\n设试验函数和测试函数的离散空间为 $V_{h}$，其中对于任何 $w \\in V_{h}$，其在单元 $K \\in \\mathcal{T}_{h}$ 上的限制是总次数至多为 $p$ 的多项式，即 $w|_{K} \\in \\mathbb{P}_{p}(K)$。设 $u, v \\in V_{h}$ 是两个这样的函数。SIPG 双线性形式由下式给出：\n$$\na(u,v) = \\underbrace{\\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x}_{\\text{第一项}} \\underbrace{- \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} (\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!]) \\, \\mathrm{d}s}_{\\text{第二项}} \\underbrace{+ \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!] \\, \\mathrm{d}s}_{\\text{第三项}}\n$$\n我们分析每一项的被积函数的多项式次数，以确定所需的求积精确度。\n\n**第一部分：最小求积次数**\n\n**第一项分析（体积项）：**\n此项包含在每个单元 $K \\in \\mathcal{T}_{h}$ 上的积分。\n- 对于函数 $u \\in V_{h}$，其在 $K$ 上的限制为 $u|_{K} \\in \\mathbb{P}_{p}(K)$。\n- 梯度 $\\nabla u$ 是一个向量，其分量是 $u$ 的偏导数。微分算子使多项式次数降低 $1$。因此，$\\nabla u|_{K}$ 的分量是总次数至多为 $p-1$ 的多项式。\n- 被积函数是点积 $\\nabla u \\cdot \\nabla v$。这是一个次数至多为 $p-1$ 的多项式乘积之和。次数为 $d_{1}$ 和 $d_{2}$ 的两个多项式之积是次数为 $d_{1}+d_{2}$ 的多项式。\n- 因此，被积函数 $\\nabla u \\cdot \\nabla v$ 是 $K$ 上的一个标量多项式，其总次数至多为 $(p-1) + (p-1) = 2p-2$。\n- 为确保对任意 $u, v \\in V_{h}$ 的选择都能精确计算此积分，体积求积规则必须对所有次数高达 $2p-2$ 的多项式都精确。\n- 因此，体积积分的最小多项式精确次数为 $q_{\\mathrm{vol}} = 2p-2$。\n\n**第二项和第三项分析（面项）：**\n这些项涉及在网格的面 $e \\in \\mathcal{E}_{h}$ 上的积分。由于单元映射是仿射的，一个面 $e$ 是一个平坦的 $(d-1)$ 维区域。\n- 多项式 $w \\in \\mathbb{P}_{p}(K)$ 在面 $e \\subset \\partial K$ 上的限制是 $e$ 上的一个次数至多为 $p$ 的多项式。\n- 标量函数 $v$ 跨过单元 $K^{+}$ 和 $K^{-}$ 之间的内面 $e$ 的跳跃定义为 $[\\![v]\\!] = v|_{K^{+}} - v|_{K^{-}}$。由于 $v|_{K^{+}}$ 和 $v|_{K^{-}}$ 在 $e$ 上是次数至多为 $p$ 的多项式，它们的差 $[\\![v]\\!]$ 在 $e$ 上也是次数至多为 $p$ 的多项式。对于边界面，跳跃就是 $v$ 的迹。\n- 向量函数 $\\boldsymbol{q}$ 的平均为 $\\{\\!\\{\\boldsymbol{q}\\}\\} = \\frac{1}{2}(\\boldsymbol{q}|_{K^{+}} + \\boldsymbol{q}|_{K^{-}})$。梯度 $\\nabla u$ 的分量在 $\\mathbb{P}_{p-1}(K)$ 中，因此它在 $e$ 上的迹给出一个次数至多为 $p-1$ 的多项式向量。因此，$\\{\\!\\{\\nabla u\\}\\!\\}$ 是 $e$ 上次数至多为 $p-1$ 的多项式向量。\n\n现在我们分析面项的被积函数：\n- **第二项（对称项）：** 被积函数的形式为 $\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!]$。\n    - 由于单元是仿射的，每个面的法向量 $\\boldsymbol{n}_{e}$ 是常数。\n    - $\\{\\!\\{\\nabla u\\}\\!\\}$ 是一个次数至多为 $p-1$ 的多项式向量。\n    - $[\\![v]\\!]$ 是一个次数至多为 $p$ 的标量多项式。\n    - 乘积是 $e$ 上的一个标量多项式，其次数至多为 $(p-1) + p = 2p-1$。\n\n- **第三项（罚项）：** 被积函数为 $\\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!]$。\n    - 罚因子 $\\frac{\\sigma}{h_{e}}$ 在每个面 $e$ 上是常数。\n    - $[\\![u]\\!]$ 是一个次数至多为 $p$ 的多项式。\n    - $[\\![v]\\!]$ 是一个次数至多为 $p$ 的多项式。\n    - 乘积是 $e$ 上的一个标量多项式，其次数至多为 $p + p = 2p$。\n\n- 为了保证所有面项的精确积分，求积规则必须对遇到的最高多项式次数精确。比较次数，我们有对称项的 $2p-1$ 和罚项的 $2p$。最大值为 $2p$。\n- 因此，面积分的最小多项式精确次数为 $q_{\\mathrm{face}} = 2p$。\n\n最小多项式精确次数为 $(q_{\\mathrm{vol}}, q_{\\mathrm{face}}) = (2p-2, 2p)$。\n\n**第二部分：积分不足的影响**\n\n设 $a_{h}(u,v)$ 表示用数值求积和代替积分的双线性形式。如果求积规则的精确次数低于上面导出的最小值，即 $q_{\\mathrm{vol}}  2p-2$ 或 $q_{\\mathrm{face}}  2p$，则发生积分不足。\n\n**对对称性的影响：**\n精确的双线性形式 $a(u,v)$ 在构造上是对称的。体积项 $\\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x$ 和罚项 $\\int_{e} \\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!] \\, \\mathrm{d}s$ 在 $u$ 和 $v$ 中显然是对称的。两个交叉项的组合 $-\\int_{e} (\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!]) \\, \\mathrm{d}s$ 也是对称的。\n当应用数值求积时，每个积分都被替换为被积函数在求积点值的加权和。例如，$\\int_D f(x) dx \\approx \\sum_i w_i f(x_i)$。\n离散形式 $a_{h}(u,v)$ 中的每一项都继承了其对应被积函数的对称性。\n- 离散体积项为 $\\sum_{K} \\sum_{i} w_{K,i} (\\nabla u \\cdot \\nabla v)(x_{K,i})$，它在 $u$ 和 $v$ 中是对称的。\n- 离散罚项为 $\\sum_{e} \\sum_{j} w_{e,j} \\frac{\\sigma}{h_{e}} [\\![u]\\!](x_{e,j}) [\\![v]\\!](x_{e,j})$，它也是对称的。\n- 离散对称项为 $-\\sum_{e} \\sum_{j} w_{e,j} (\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!])(x_{e,j})$，它也是对称的。\n因此，无论求积规则的精确次数如何，$a_{h}(u,v) = a_{h}(v,u)$ 都成立。积分不足不影响双线性形式的对称性。得到的刚度矩阵保持对称。\n\n**对矫顽性（正定性）的影响：**\n矫顽性是指对于某个正常数 $C$ 和一个适当的范数 $\\|v\\|_{\\text{DG}}$，有 $a(v,v) \\ge C \\|v\\|_{\\text{DG}}^2$ 这一性质。它对离散问题的稳定性和适定性至关重要。SIPG 形式的矫顽性依赖于 $a(v,v)$ 中两个关键项的正性：体积项和罚项。\n$$\na(v,v) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} |\\nabla v|^2 \\, \\mathrm{d}x + \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\frac{\\sigma}{h_{e}} |[\\![v]\\!]|^2 \\, \\mathrm{d}s - 2\\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] \\, \\mathrm{d}s\n$$\n前两项是正定的，构成了 DG 范数的主干。对于足够大的罚参数 $\\sigma$，第三项由前两项控制。\n\n当采用积分不足时，离散双线性形式为\n$$\na_{h}(v,v) = \\sum_{K} (\\nabla v, \\nabla v)_{h,K} + \\sum_{e} \\left\\langle \\frac{\\sigma}{h_{e}} [\\![v]\\!], [\\![v]\\!] \\right\\rangle_{h,e} - 2\\sum_{e} \\langle \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e}, [\\![v]\\!] \\rangle_{h,e}\n$$\n其中 $(\\cdot,\\cdot)_{h,K}$ 和 $\\langle \\cdot, \\cdot \\rangle_{h,e}$ 表示由求积近似的内积。\n\n1.  **$q_{\\mathrm{vol}}  2p-2$ 的影响：** 被积函数 $|\\nabla v|^2$ 是一个次数高达 $2p-2$ 的多项式。如果求积规则对此次数不精确，则离散内积 $(\\nabla v, \\nabla v)_{h,K}$ 不保证为正。可以构造一个非零函数 $v \\in V_{h}$，使得 $\\nabla v$ 非零，但在所有体积求积点上 $\\nabla v$ 都为零。对于这样的函数，$(\\nabla v, \\nabla v)_{h,K} = 0$，而 $\\int_K |\\nabla v|^2 \\mathrm{d}x  0$。主矫顽项正性的丧失可能导致 $a_h(\\cdot, \\cdot)$ 整体矫顽性的丧失。\n\n2.  **$q_{\\mathrm{face}}  2p$ 的影响：** 罚项的被积函数 $|[\\![v]\\!]|^2$ 是面 $e$ 上次数高达 $2p$ 的多项式。如果 $q_{\\mathrm{face}}  2p$，离散内积 $\\langle [\\![v]\\!], [\\![v]\\!] \\rangle_{h,e}$ 可能不为正。一个非零跳跃 $[\\![v]\\!] \\in \\mathbb{P}_{p}(e)$ 可能在所有面求积点上为零，使得离散罚项为零，而其精确对应项是严格为正的。这削弱了罚参数 $\\sigma$ 在保证矫顽性方面的作用。\n\n在这两种情况下，双线性形式主对角项上保证正性的丧失意味着标准的矫顽性证明失效。离散形式 $a_{h}(\\cdot, \\cdot)$ 可能不再具有矫顽性（正定性）。这可能导致刚度矩阵奇异或不定，从而使数值方法不稳定且线性系统不可解。因此，积分不足严重危及 SIPG 方法的矫顽性和稳定性。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2p-2  2p \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在前两个练习的基础上，最后一个实践展示了变分框架在更复杂问题中的强大功能和灵活性。我们将构建并分析一个由偏微分方程（PDE）约束的优化问题，并推导其对应的Karush-Kuhn-Tucker（KKT）系统。这个练习引入了伴随状态和鞍点问题等核心概念，这些都是最优控制、反问题和数据同化等领域的基石。",
            "id": "3426340",
            "problem": "考虑一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{1,2,3\\}$），并弱施加齐次狄利克雷边界条件。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 上的一个协调、形状规则的单纯形网格，并设 $V_{h}$ 是 $\\mathcal{T}_{h}$ 上总次数至多为 $k \\geq 1$ 的不连续分片多项式构成的有限维空间。定义与泊松算子相容且在罚参数足够大时强制的对称内部罚双线性形式 $a_{h}(\\cdot,\\cdot)$，并在 $V_{h}$ 上定义 $L^{2}(\\Omega)$ 内积 $(\\cdot,\\cdot)$。\n\n你需要建立并分析一个由线性偏微分方程约束的线性二次优化问题：在服从椭圆方程的约束下，最小化与给定数据 $u_{d} \\in L^{2}(\\Omega)$ 的差异，同时对源项 $f$ 进行惩罚。具体来说，考虑以下问题\n$$\n\\min_{u \\in V_{h},\\, f \\in V_{h}} \\;\\; \\frac{1}{2}\\,(u - u_{d},\\, u - u_{d}) + \\frac{\\beta}{2}\\,(f,\\, f) \\quad \\text{subject to} \\quad a_{h}(u,\\, v) = (f,\\, v)\\quad \\forall v \\in V_{h},\n$$\n其中 $\\beta  0$ 是一个固定的正则化参数。引入一个拉格朗日乘子 $p \\in V_{h}$ 并写出拉格朗日泛函。推导与一阶最优性条件相对应的 Karush-Kuhn-Tucker (KKT) 变分系统。证明在 $V_{h}$ 的一个固定基底中，所得的线性系统可以用代表 $V_{h}$ 上 $(\\cdot,\\cdot)$ 的质量矩阵 $M$ 和代表 $V_{h}$ 上 $a_{h}(\\cdot,\\cdot)$ 的对称内部罚刚度矩阵 $S$ 表示为分块算子形式。描述此分块系统的鞍点特性。\n\n然后，消去主变量 $u$ 和 $f$，得到关于拉格朗日乘子变量 $p$ 的约化方程，并讨论精确舒尔补的结构。在此基础上，提出一个在 $p$-分块中使用精确舒尔补的分块对角预条件子，并假设 $M$ 和 $S$ 是对称正定的，讨论其在算子层面上的谱效应。\n\n你的最终任务是，给出通过从 KKT 系统中消去 $u$ 和 $f$ 所得到的关于拉格朗日乘子变量 $p$ 的舒尔补算子的精确解析表达式，该表达式应以 $M$、$S$ 和 $\\beta$ 表示。最终答案必须是单一的闭式表达式。不需要数值近似或四舍五入。",
            "solution": "用户希望分析一个偏微分方程约束的优化问题，具体来说，是推导 KKT 系统，分析其分块结构，找到舒尔补系统，并提出一个预条件子。\n\n### 步骤1：问题验证\n\n所提供的问题陈述是偏微分方程约束优化的数值分析领域中的一个标准练习。\n给定条件如下：\n- 一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$，$d \\in \\{1,2,3\\}$。\n- $\\Omega$ 上的一个协调、形状规则的单纯形网格 $\\mathcal{T}_{h}$。\n- 一个由次数至多为 $k \\geq 1$ 的不连续分片多项式构成的有限元空间 $V_{h}$。\n- 一个在 $V_{h} \\times V_{h}$ 上的对称内部罚（SIPG）双线性形式 $a_{h}(\\cdot,\\cdot)$，该形式是相容且强制的。\n- $L^{2}(\\Omega)$ 内积 $(\\cdot,\\cdot)$。\n- 一个给定的数据函数 $u_{d} \\in L^{2}(\\Omega)$ 和一个正则化参数 $\\beta  0$。\n- 优化问题：\n$$\n\\min_{u \\in V_{h},\\, f \\in V_{h}} \\;\\; J(u,f) = \\frac{1}{2}\\,(u - u_{d},\\, u - u_{d}) + \\frac{\\beta}{2}\\,(f,\\, f)\n$$\n服从线性约束\n$$\na_{h}(u,\\, v) = (f,\\, v)\\quad \\forall v \\in V_{h}.\n$$\n\n根据标准进行验证：\n- **科学依据**：该问题在最优控制理论及其使用有限元方法（特别是不连续 Galerkin 方法）的数值解法中是公认的。所有概念（SIPG、KKT 条件、舒尔补）都是标准的。\n- **适定性**：目标泛函 $J(u,f)$ 是严格凸的，约束是一个线性系统。对于给定的 $f$，$a_h(\\cdot,\\cdot)$ 的强制性保证了唯一解 $u$ 的存在。整个问题是适定的，并且有唯一解。\n- **客观性**：该问题以精确、形式化的数学语言陈述，没有主观元素。\n\n该问题没有任何无效性缺陷。它是自洽的、科学上合理的且可形式化的。结论是该问题是**有效的**。\n\n### 步骤2：推导与求解\n\n**1. 拉格朗日函数与 KKT 系统**\n\n为了找到一阶最优性条件，我们引入一个拉格朗日乘子 $p \\in V_{h}$ 来施加状态方程约束。拉格朗日泛函 $\\mathcal{L}: V_{h} \\times V_{h} \\times V_{h} \\to \\mathbb{R}$ 由下式给出：\n$$\n\\mathcal{L}(u, f, p) = J(u, f) + \\left( a_{h}(u, p) - (f, p) \\right)\n$$\n$$\n\\mathcal{L}(u, f, p) = \\frac{1}{2}\\,(u - u_{d},\\, u - u_{d}) + \\frac{\\beta}{2}\\,(f,\\, f) + a_{h}(u, p) - (f, p)\n$$\n乘子项的符号是一种约定；这种选择会导出一个对称的 KKT 系统。一阶最优性必要条件是 $\\mathcal{L}$ 关于 $u$、$f$ 和 $p$ 的 Gateaux 导数在所有方向上都必须为零。\n\n- **关于 $u$ 的导数**：对任意测试函数 $w \\in V_h$，\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial u}(w) = (u - u_{d}, w) + a_{h}(w, p) = 0.\n$$\n利用 $a_h(\\cdot,\\cdot)$ 的对称性，我们得到**伴随方程**：\n$$\n(u, w) + a_{h}(p, w) = (u_d, w) \\quad \\forall w \\in V_h.\n$$\n\n- **关于 $f$ 的导数**：对任意测试函数 $z \\in V_h$，\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial f}(z) = \\beta(f, z) - (p, z) = 0.\n$$\n这给出了**最优性条件**：\n$$\n\\beta(f, z) = (p, z) \\quad \\forall z \\in V_h.\n$$\n\n- **关于 $p$ 的导数**：对任意测试函数 $v \\in V_h$，\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p}(v) = a_{h}(u, v) - (f, v) = 0.\n$$\n这就恢复了原始约束，即**状态方程**：\n$$\na_{h}(u, v) = (f, v) \\quad \\forall v \\in V_h.\n$$\n\n完整的 KKT 系统是找到满足这三个变分方程的 $(u, f, p) \\in V_h \\times V_h \\times V_h$。\n\n**2. 分块算子形式**\n\n设 $\\{\\phi_i\\}_{i=1}^{N}$ 是 $V_h$ 的一组基。设 $\\mathbf{u}$、$\\mathbf{f}$ 和 $\\mathbf{p}$ 是相应的系数向量。我们定义质量矩阵 $M$，其元素为 $M_{ij} = (\\phi_j, \\phi_i)$，以及对称内部罚刚度矩阵 $S$，其元素为 $S_{ij} = a_h(\\phi_j, \\phi_i)$。由于内积的性质和 $a_h$ 的强制性，矩阵 $M$ 和 $S$ 都是对称正定（SPD）的。设 $\\mathbf{d}$ 是元素为 $\\mathbf{d}_i = (u_d, \\phi_i)$ 的向量。\n\nKKT 系统可转化为以下矩阵系统：\n1. 伴随方程：$M\\mathbf{u} + S\\mathbf{p} = \\mathbf{d}$\n2. 最优性方程：$\\beta M\\mathbf{f} - M\\mathbf{p} = 0$\n3. 状态方程：$S\\mathbf{u} - M\\mathbf{f} = 0$\n\n这可以写成 $3 \\times 3$ 的分块矩阵形式：\n$$\n\\begin{pmatrix}\nM   0   S \\\\\n0   \\beta M   -M \\\\\nS   -M   0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\n\\mathbf{f} \\\\\n\\mathbf{p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{d} \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这是一个对称但非定的线性系统。为了分析其鞍点特性，我们将主变量 $(\\mathbf{u}, \\mathbf{f})$ 和对偶变量 $\\mathbf{p}$ 分组：\n$$\n\\begin{pmatrix}\nA  B^T \\\\\nB  C\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{x} \\\\\n\\mathbf{p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{F} \\\\\n\\mathbf{G}\n\\end{pmatrix}\n$$\n其中 $\\mathbf{x} = (\\mathbf{u}^T, \\mathbf{f}^T)^T$ 且分块为：\n$$\nA = \\begin{pmatrix} M  0 \\\\ 0  \\beta M \\end{pmatrix}, \\quad B = \\begin{pmatrix} S  -M \\end{pmatrix}, \\quad C = [0], \\quad \\mathbf{F} = \\begin{pmatrix} \\mathbf{d} \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{G} = [0].\n$$\n矩阵 $A$ 是拉格朗日函数关于主变量的海森矩阵。由于 $M$ 是对称正定的且 $\\beta0$，所以 $A$ 也是对称正定的。$C=0$ 分块是带等式约束的标准鞍点问题的特征。整个 KKT 矩阵是非定的，同时拥有正负特征值，这定义了其鞍点性质。\n\n**3. 舒尔补与约化系统**\n\n我们消去主变量 $\\mathbf{u}$ 和 $\\mathbf{f}$，得到关于 $\\mathbf{p}$ 的约化方程。从 KKT 系统可知：\n从最优性方程：$\\beta M\\mathbf{f} = M\\mathbf{p} \\implies \\mathbf{f} = \\frac{1}{\\beta}\\mathbf{p}$，因为 $M$ 是可逆的。\n从状态方程：$S\\mathbf{u} = M\\mathbf{f} = M(\\frac{1}{\\beta}\\mathbf{p}) = \\frac{1}{\\beta}M\\mathbf{p}$。因为 $S$ 是可逆的，所以 $\\mathbf{u} = \\frac{1}{\\beta}S^{-1}M\\mathbf{p}$。\n将这些代入伴随方程：$M\\mathbf{u} + S\\mathbf{p} = \\mathbf{d}$。\n$M(\\frac{1}{\\beta}S^{-1}M\\mathbf{p}) + S\\mathbf{p} = \\mathbf{d}$，这给出 $(\\frac{1}{\\beta}MS^{-1}M + S)\\mathbf{p} = \\mathbf{d}$。\n\n或者，使用形式化定义，鞍点系统中分块 $A$ 的舒尔补由 $\\mathcal{S}_A = C - BA^{-1}B^T$ 给出。这里，$A^{-1} = \\begin{pmatrix} M^{-1}  0 \\\\ 0  \\frac{1}{\\beta}M^{-1} \\end{pmatrix}$。\n$$\n\\mathcal{S}_A = 0 - \\begin{pmatrix} S  -M \\end{pmatrix} \\begin{pmatrix} M^{-1}  0 \\\\ 0  \\frac{1}{\\beta}M^{-1} \\end{pmatrix} \\begin{pmatrix} S \\\\ -M \\end{pmatrix}\n$$\n$$\n= - \\left( \\begin{pmatrix} SM^{-1}  -\\frac{1}{\\beta}I \\end{pmatrix} \\begin{pmatrix} S \\\\ -M \\end{pmatrix} \\right) = - (SM^{-1}S + \\frac{1}{\\beta}M)\n$$\n关于 $\\mathbf{p}$ 的约化系统是 $\\mathcal{S}_A \\mathbf{p} = \\mathbf{G} - BA^{-1}\\mathbf{F}$。\n$BA^{-1}\\mathbf{F} = \\begin{pmatrix} SM^{-1}  -\\frac{1}{\\beta}I \\end{pmatrix} \\begin{pmatrix} \\mathbf{d} \\\\ 0 \\end{pmatrix} = SM^{-1}\\mathbf{d}$。\n所以，$ - (SM^{-1}S + \\frac{1}{\\beta}M) \\mathbf{p} = 0 - SM^{-1}\\mathbf{d}$，可简化为：\n$$\n(SM^{-1}S + \\frac{1}{\\beta}M) \\mathbf{p} = SM^{-1}\\mathbf{d}\n$$\n这两个推导出的约化系统是等价的，因为其中一个可以通过左乘可逆算子 $MS^{-1}$ 从另一个得到。第二种形式中的算子 $\\mathcal{S} = SM^{-1}S + \\frac{1}{\\beta}M$ 是通常通过分块消元公式得到的，并被称为舒尔补算子（相差一个符号）。它是对称正定的，因为它是两个对称正定算子的和（$S M^{-1} S$ 是对称正定的，$\\frac{1}{\\beta} M$ 也是对称正定的）。在连续层面上，这对应于一个形如 $\\Delta^2 + \\text{const}$ 的四阶椭圆算子。\n\n**4. 分块对角预条件子**\n\n对于 KKT 系统 $\\begin{pmatrix} A  B^T \\\\ B  0 \\end{pmatrix}\\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{p} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{F} \\\\ 0 \\end{pmatrix}$，一个有效的分块对角预条件子形如 $\\mathcal{P} = \\begin{pmatrix} A  0 \\\\ 0  -\\mathcal{S}_A \\end{pmatrix}$。按要求使用精确分块：\n$$\n\\mathcal{P} = \\begin{pmatrix} A  0 \\\\ 0  BA^{-1}B^T \\end{pmatrix} = \\begin{pmatrix}\nM  0  0 \\\\\n0  \\beta M  0 \\\\\n0  0  SM^{-1}S + \\frac{1}{\\beta}M\n\\end{pmatrix}\n$$\n预处理算子 $\\mathcal{P}^{-1}\\mathcal{A}$ 的谱性质决定了 Krylov 求解器的收敛性。如鞍点预处理的相关文献所示，该算子的特征值聚集在少数几个值上，且与网格尺寸 $h$ 无关。对于这个具体问题，直接计算表明 $\\mathcal{P}^{-1}\\mathcal{A}$ 的特征值为 $\\{1, \\frac{1+\\sqrt{5}}{2}, \\frac{1-\\sqrt{5}}{2}\\}$。特征值 $1$ 的重数为 $N$，而另外两个特征值的重数也各为 $N$，其中 $N=\\dim(V_h)$。由于特征值包含在一个小集合内，像 GMRES 这样的 Krylov 方法将在少数几次迭代内收敛（在精确算术中最多3次），而与问题规模无关。这使得该预条件子非常有效。\n\n**5. 最终答案的构建**\n\n最终任务是提供通过消去 $u$ 和 $f$ 得到的舒尔补算子的表达式。如前所述，这是作用在约化系统中 $\\mathbf{p}$ 上的算子。根据标准的分块消元公式，该算子是 $SM^{-1}S + \\frac{1}{\\beta}M$。",
            "answer": "$$\n\\boxed{S M^{-1} S + \\frac{1}{\\beta} M}\n$$"
        }
    ]
}