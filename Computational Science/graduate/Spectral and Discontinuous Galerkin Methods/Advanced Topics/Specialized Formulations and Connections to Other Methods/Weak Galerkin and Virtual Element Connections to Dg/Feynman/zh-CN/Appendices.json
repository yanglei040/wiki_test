{
    "hands_on_practices": [
        {
            "introduction": "理解一种数值方法始于其离散能量范数。本练习提供了一个具体的比较，展示了对于一个给定的函数，对称内部罚分间断 Galerkin (SIP-DG)、弱 Galerkin (WG) 和虚拟单元 (VEM) 方法如何定义“能量”，从而揭示了它们底层结构的异同。这种实践对于掌握每种方法的稳定性和收敛性至关重要。",
            "id": "3427872",
            "problem": "考虑单位区间 $[0,1]$ 上带有齐次 Dirichlet 边界数据的标量扩散模型问题。设网格由两个单元 $K_{1}=[0,\\tfrac{1}{2}]$ 和 $K_{2}=[\\tfrac{1}{2},1]$ 组成。定义分片函数 $v$ 如下\n$$\nv(x)=\\begin{cases}\nv_{1}(x):=x+\\sin(\\pi x), & x\\in K_{1}, \\\\\nv_{2}(x):=1-x+\\tfrac{1}{2}\\sin(\\pi x), & x\\in K_{2}.\n\\end{cases}\n$$\n使得 $v(0)=0$ 且 $v(1)=0$。在此网格上，定义三个离散能量泛函：\n\n1. 对称内部罚分断 Galerkin (SIP-DG) 能量（平方），罚参数 $\\sigma=4$，\n$$\n\\|v\\|_{\\mathrm{DG}}^{2} \\;:=\\; \\sum_{K\\in\\{K_{1},K_{2}\\}}\\int_{K} |v'(x)|^{2}\\,dx \\;+\\; \\sum_{e\\in\\{\\tfrac{1}{2}\\}} \\frac{\\sigma}{h_{e}}\\,[v]_{e}^{2},\n$$\n其中 $h_{e}=\\min(|K_{1}|,|K_{2}|)=\\tfrac{1}{2}$ 且 $[v]_{e}=v(1/2^{-})-v(1/2^{+})$ 是界面上的跳跃。\n\n2. 针对最低阶空间的弱 Galerkin (WG) 能量（平方），在每个单元上使用标准弱梯度，\n$$\n\\|v\\|_{\\mathrm{WG}}^{2} \\;:=\\; \\sum_{K\\in\\{K_{1},K_{2}\\}} \\|\\nabla_{w} v\\|_{L^{2}(K)}^{2} \\;+\\; s(v,v),\n$$\n其中在 $K=[x_{L},x_{R}]$ 上的离散弱梯度定义为常数\n$$\n\\nabla_{w} v\\big|_{K} \\;=\\; \\frac{v_{b}(x_{R})-v_{b}(x_{L})}{h_{K}}, \\quad h_{K}=x_{R}-x_{L},\n$$\n以及一个稳定项\n$$\ns(v,v) \\;=\\; \\sum_{K\\in\\{K_{1},K_{2}\\}} h_{K}^{-1}\\Big[(v_{0}(x_{L})-v_{b}(x_{L}))^{2}+(v_{0}(x_{R})-v_{b}(x_{R}))^{2}\\Big].\n$$\n此处，$v_{0}$ 表示 $v$ 在每个单元内部的值，$v_{b}$ 表示边界自由度。选择 $v_{b}(0)=v_{1}(0)$，$v_{b}(1/2)=\\tfrac{1}{2}\\big(v_{1}(1/2)+v_{2}(1/2)\\big)$，$v_{b}(1)=v_{2}(1)$，即：\n$$\nv_{b}(0)=0,\\quad v_{b}\\!\\left(\\tfrac{1}{2}\\right)=\\tfrac{5}{4},\\quad v_{b}(1)=0.\n$$\n\n3. 在每个单元上阶数 $k=1$ 的虚拟元方法 (VEM) 能量（平方），\n$$\n\\|v\\|_{\\mathrm{VEM}}^{2} \\;:=\\; \\sum_{K\\in\\{K_{1},K_{2}\\}} \\Big( \\|\\nabla \\Pi_{K}^{\\nabla} v\\|_{L^{2}(K)}^{2} \\;+\\; S_{K}\\big((I-\\Pi_{K}^{\\nabla})v,(I-\\Pi_{K}^{\\nabla})v\\big) \\Big),\n$$\n其中 $\\Pi_{K}^{\\nabla}v$ 是到 $P_{1}(K)$ 上的 $H^{1}$-椭圆投影子，其定义要求 $\\nabla \\Pi_{K}^{\\nabla} v$ 等于 $v$ 在 $K$ 上的平均梯度，且 $\\int_{K}\\Pi_{K}^{\\nabla}v\\,dx=\\int_{K}v\\,dx$。选择一个基于自由度的稳定项\n$$\nS_{K}(w,w) \\;=\\; h_{K}^{-1}\\sum_{x\\in\\partial K}\\big(w(x)\\big)^{2},\n$$\n应用于 $w=(I-\\Pi_{K}^{\\nabla})v$ 在 $K$ 的两个端点处。\n\n仅使用上述定义和微积分基本定理，计算三个能量 $\\|v\\|_{\\mathrm{DG}}^{2}$、$\\|v\\|_{\\mathrm{WG}}^{2}$ 和 $\\|v\\|_{\\mathrm{VEM}}^{2}$。然后，报告比值\n$$\nR \\;=\\; \\frac{\\|v\\|_{\\mathrm{DG}}^{2}}{\\|v\\|_{\\mathrm{VEM}}^{2}}.\n$$\n将你的答案四舍五入到四位有效数字。",
            "solution": "该问题是适定的，并提供了计算给定函数 $v(x)$ 的三个离散能量泛函所需的所有必要信息。我们按定义计算每个能量项。\n\n函数 $v$ 在网格单元 $K_{1}=[0,\\frac{1}{2}]$ 和 $K_{2}=[\\frac{1}{2},1]$ 上分段定义如下：\n$$\nv(x)=\\begin{cases}\nv_{1}(x):=x+\\sin(\\pi x), & x\\in K_{1},\\\\\nv_{2}(x):=1-x+\\tfrac{1}{2}\\sin(\\pi x), & x\\in K_{2}.\n\\end{cases}\n$$\n\n首先，我们计算对称内部罚分断 Galerkin (SIP-DG) 能量 $\\|v\\|_{\\mathrm{DG}}^{2}$。\n其公式由下式给出\n$$\n\\|v\\|_{\\mathrm{DG}}^{2} \\;:=\\; \\sum_{K\\in\\{K_{1},K_{2}\\}}\\int_{K} |v'(x)|^{2}\\,dx \\;+\\; \\frac{\\sigma}{h_{e}}\\,[v]_{e}^{2},\n$$\n其中罚参数 $\\sigma=4$，界面 $e=\\frac{1}{2}$，单元尺寸 $h_{e}=\\frac{1}{2}$。\n$v$ 在每个单元上的导数是：\n$v_{1}'(x) = 1 + \\pi\\cos(\\pi x)$ 对于 $x \\in K_{1}$。\n$v_{2}'(x) = -1 + \\frac{\\pi}{2}\\cos(\\pi x)$ 对于 $x \\in K_{2}$。\n我们计算导数平方的积分：\n$$\n\\int_{K_{1}} |v_{1}'(x)|^{2}\\,dx = \\int_{0}^{1/2} (1 + 2\\pi\\cos(\\pi x) + \\pi^{2}\\cos^{2}(\\pi x))\\,dx\n$$\n$$\n= \\left[x + 2\\sin(\\pi x) + \\pi^{2}\\left(\\frac{x}{2} + \\frac{\\sin(2\\pi x)}{4\\pi}\\right)\\right]_{0}^{1/2} = \\left(\\frac{1}{2} + 2\\sin\\left(\\frac{\\pi}{2}\\right) + \\frac{\\pi^{2}}{4}\\right) - (0) = \\frac{5}{2} + \\frac{\\pi^{2}}{4}.\n$$\n$$\n\\int_{K_{2}} |v_{2}'(x)|^{2}\\,dx = \\int_{1/2}^{1} \\left(1 - \\pi\\cos(\\pi x) + \\frac{\\pi^{2}}{4}\\cos^{2}(\\pi x)\\right)\\,dx\n$$\n$$\n= \\left[x - \\sin(\\pi x) + \\frac{\\pi^{2}}{4}\\left(\\frac{x}{2} + \\frac{\\sin(2\\pi x)}{4\\pi}\\right)\\right]_{1/2}^{1} = (1 - 0 + \\frac{\\pi^{2}}{8}) - \\left(\\frac{1}{2} - 1 + \\frac{\\pi^{2}}{16}\\right) = \\frac{3}{2} + \\frac{\\pi^{2}}{16}.\n$$\n积分之和为 $\\left(\\frac{5}{2} + \\frac{\\pi^{2}}{4}\\right) + \\left(\\frac{3}{2} + \\frac{\\pi^{2}}{16}\\right) = 4 + \\frac{5\\pi^{2}}{16}$。\n在界面 $e=\\frac{1}{2}$ 上的跳跃是 $[v]_{1/2} = v_{1}(\\frac{1}{2}) - v_{2}(\\frac{1}{2})$。\n$v_{1}(\\frac{1}{2}) = \\frac{1}{2} + \\sin(\\frac{\\pi}{2}) = \\frac{3}{2}$。\n$v_{2}(\\frac{1}{2}) = 1 - \\frac{1}{2} + \\frac{1}{2}\\sin(\\frac{\\pi}{2}) = 1$。\n所以，$[v]_{1/2} = \\frac{3}{2} - 1 = \\frac{1}{2}$。\n罚项为 $\\frac{\\sigma}{h_{e}}[v]_{1/2}^{2} = \\frac{4}{1/2}(\\frac{1}{2})^{2} = 8 \\cdot \\frac{1}{4} = 2$。\n因此，DG 能量为 $\\|v\\|_{\\mathrm{DG}}^{2} = \\left(4 + \\frac{5\\pi^{2}}{16}\\right) + 2 = 6 + \\frac{5\\pi^{2}}{16}$。\n\n第二，我们计算弱 Galerkin (WG) 能量 $\\|v\\|_{\\mathrm{WG}}^{2}$。\n其公式是\n$$\n\\|v\\|_{\\mathrm{WG}}^{2} \\;:=\\; \\sum_{K\\in\\{K_{1},K_{2}\\}} \\|\\nabla_{w} v\\|_{L^{2}(K)}^{2} \\;+\\; s(v,v),\n$$\n边界自由度值为 $v_{b}(0)=0$, $v_{b}(\\frac{1}{2})=\\frac{5}{4}$ 和 $v_{b}(1)=0$。\n在每个尺寸为 $h_K=\\frac{1}{2}$ 的单元 $K$ 上的离散弱梯度是一个常数：\n在 $K_{1} = [0, \\frac{1}{2}]$ 上，$\\nabla_{w} v|_{K_{1}} = \\frac{v_{b}(1/2) - v_{b}(0)}{h_{K_{1}}} = \\frac{5/4 - 0}{1/2} = \\frac{5}{2}$。\n在 $K_{2} = [\\frac{1}{2}, 1]$ 上，$\\nabla_{w} v|_{K_{2}} = \\frac{v_{b}(1) - v_{b}(1/2)}{h_{K_{2}}} = \\frac{0 - 5/4}{1/2} = -\\frac{5}{2}$。\n弱梯度的 $L^{2}$-范数平方和是\n$$\n\\sum_{K} \\|\\nabla_{w} v\\|_{L^{2}(K)}^{2} = |K_{1}|(\\nabla_{w} v|_{K_{1}})^{2} + |K_{2}|(\\nabla_{w} v|_{K_{2}})^{2} = \\frac{1}{2}\\left(\\frac{5}{2}\\right)^{2} + \\frac{1}{2}\\left(-\\frac{5}{2}\\right)^{2} = \\frac{1}{2} \\cdot \\frac{25}{4} + \\frac{1}{2} \\cdot \\frac{25}{4} = \\frac{25}{4}.\n$$\n稳定项是 $s(v,v) = \\sum_{K} h_{K}^{-1}\\Big[(v_{0}(x_{L})-v_{b}(x_{L}))^{2}+(v_{0}(x_{R})-v_{b}(x_{R}))^{2}\\Big]$，其中 $v_{0}$ 是每个单元内部的原始函数 $v$。\n对于 $K_{1}$，其中 $h_{K_{1}}^{-1}=2$：$(v_{0}(0)-v_{b}(0))^{2} = (v_{1}(0)-v_{b}(0))^{2} = (0-0)^{2}=0$。并且 $(v_{0}(\\frac{1}{2})-v_{b}(\\frac{1}{2}))^{2} = (v_{1}(\\frac{1}{2})-v_{b}(\\frac{1}{2}))^{2} = (\\frac{3}{2}-\\frac{5}{4})^{2} = (\\frac{1}{4})^{2}=\\frac{1}{16}$。\n对于 $K_{2}$，其中 $h_{K_{2}}^{-1}=2$：$(v_{0}(\\frac{1}{2})-v_{b}(\\frac{1}{2}))^{2} = (v_{2}(\\frac{1}{2})-v_{b}(\\frac{1}{2}))^{2} = (1-\\frac{5}{4})^{2} = (-\\frac{1}{4})^{2}=\\frac{1}{16}$。并且 $(v_{0}(1)-v_{b}(1))^{2} = (v_{2}(1)-v_{b}(1))^{2} = (0-0)^{2}=0$。\n因此，$s(v,v) = 2\\left(0 + \\frac{1}{16}\\right) + 2\\left(\\frac{1}{16} + 0\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{1}{4}$。\nWG 能量为 $\\|v\\|_{\\mathrm{WG}}^{2} = \\frac{25}{4} + \\frac{1}{4} = \\frac{26}{4} = \\frac{13}{2} = 6.5$。\n\n第三，我们计算虚拟元方法 (VEM) 能量 $\\|v\\|_{\\mathrm{VEM}}^{2}$。\n其公式是 $\\|v\\|_{\\mathrm{VEM}}^{2} = \\sum_{K} \\left( \\|\\nabla \\Pi_{K}^{\\nabla} v\\|_{L^{2}(K)}^{2} + S_{K}((I-\\Pi_{K}^{\\nabla})v,(I-\\Pi_{K}^{\\nabla})v) \\right)$。\n对于每个单元 $K=[x_L, x_R]$，多项式 $\\Pi_K^\\nabla v \\in P_1(K)$ 的定义使其导数 $(\\Pi_K^\\nabla v)'$ 是 $v'$ 在 $K$ 上的平均值，且其在 $K$ 上的积分与 $v$ 的积分相匹配。\n使用微积分基本定理，$(\\Pi_K^\\nabla v)' = \\frac{1}{|K|}\\int_K v'(x)dx = \\frac{v(x_R)-v(x_L)}{|K|}$。\n对于 $K_{1}=[0, \\frac{1}{2}]$，$(\\Pi_{K_{1}}^\\nabla v_{1})' = \\frac{v_{1}(1/2)-v_{1}(0)}{1/2} = \\frac{3/2 - 0}{1/2} = 3$。\n$K_{1}$ 的第一个能量分量是 $\\|\\nabla\\Pi_{K_1}^\\nabla v_1\\|_{L^2(K_1)}^2 = |K_1|(3)^2 = \\frac{1}{2} \\cdot 9 = \\frac{9}{2}$。\n为了求稳定项，令 $w_1 = (I-\\Pi_{K_1}^\\nabla)v_1$。我们需要单元端点处的 $w_1$。根据投影子的定义，$\\int_{K_1} w_1(x)dx=0$。此外，$\\Pi_{K_1}^\\nabla v_1$ 的导数是常数。我们计算出 $\\Pi_{K_1}^{\\nabla}v_1(x)=3x-\\frac{1}{2}+\\frac{2}{\\pi}$。那么 $w_1(x) = (x+\\sin(\\pi x)) - (3x-\\frac{1}{2}+\\frac{2}{\\pi})$。在端点处：$w_1(0) = \\frac{1}{2}-\\frac{2}{\\pi}$ 且 $w_1(\\frac{1}{2}) = (\\frac{1}{2}+1) - (\\frac{3}{2}-\\frac{1}{2}+\\frac{2}{\\pi}) = \\frac{1}{2}-\\frac{2}{\\pi}$。\n$K_1$ 的稳定项是 $S_{K_1}(w_1,w_1) = h_{K_1}^{-1}\\left( (w_1(0))^2 + (w_1(\\frac{1}{2}))^2 \\right) = 2\\left( (\\frac{1}{2}-\\frac{2}{\\pi})^2 + (\\frac{1}{2}-\\frac{2}{\\pi})^2 \\right) = 4(\\frac{1}{4} - \\frac{2}{\\pi} + \\frac{4}{\\pi^2}) = 1 - \\frac{8}{\\pi} + \\frac{16}{\\pi^2}$。\n$K_1$ 上的 VEM 能量是 $\\frac{9}{2} + 1 - \\frac{8}{\\pi} + \\frac{16}{\\pi^2}$。\n\n对于 $K_{2}=[\\frac{1}{2}, 1]$，$(\\Pi_{K_{2}}^\\nabla v_{2})' = \\frac{v_{2}(1)-v_{2}(1/2)}{1/2} = \\frac{0 - 1}{1/2} = -2$。\n$K_{2}$ 的第一个能量分量是 $\\|\\nabla\\Pi_{K_2}^\\nabla v_2\\|_{L^2(K_2)}^2 = |K_2|(-2)^2 = \\frac{1}{2} \\cdot 4 = 2$。\n令 $w_2 = (I-\\Pi_{K_2}^\\nabla)v_2$。我们计算出 $\\Pi_{K_2}^\\nabla v_2(x)=-2x+\\frac{7}{4}+\\frac{1}{\\pi}$。在端点处，$w_2(\\frac{1}{2}) = v_2(\\frac{1}{2})-\\Pi_{K_2}^\\nabla v_2(\\frac{1}{2}) = 1-( -1+\\frac{7}{4}+\\frac{1}{\\pi}) = \\frac{1}{4}-\\frac{1}{\\pi}$，且 $w_2(1) = v_2(1)-\\Pi_{K_2}^\\nabla v_2(1) = 0-( -2+\\frac{7}{4}+\\frac{1}{\\pi}) = \\frac{1}{4}-\\frac{1}{\\pi}$。\n$K_2$ 的稳定项是 $S_{K_2}(w_2,w_2) = h_{K_2}^{-1}\\left( (w_2(\\frac{1}{2}))^2 + (w_2(1))^2 \\right) = 2\\left( (\\frac{1}{4}-\\frac{1}{\\pi})^2 + (\\frac{1}{4}-\\frac{1}{\\pi})^2 \\right) = 4(\\frac{1}{16} - \\frac{1}{2\\pi} + \\frac{1}{\\pi^2}) = \\frac{1}{4} - \\frac{2}{\\pi} + \\frac{4}{\\pi^2}$。\n$K_2$ 上的 VEM 能量是 $2 + \\frac{1}{4} - \\frac{2}{\\pi} + \\frac{4}{\\pi^2}$。\n总 VEM 能量是所有单元上能量的总和：\n$\\|v\\|_{\\mathrm{VEM}}^{2} = \\left(\\frac{9}{2} + 1 - \\frac{8}{\\pi} + \\frac{16}{\\pi^2}\\right) + \\left(2 + \\frac{1}{4} - \\frac{2}{\\pi} + \\frac{4}{\\pi^2}\\right) = \\frac{31}{4} - \\frac{10}{\\pi} + \\frac{20}{\\pi^2}$。\n\n计算出的三个能量是：\n$\\|v\\|_{\\mathrm{DG}}^{2} = 6 + \\frac{5\\pi^{2}}{16}$\n$\\|v\\|_{\\mathrm{WG}}^{2} = \\frac{13}{2} = 6.5$\n$\\|v\\|_{\\mathrm{VEM}}^{2} = \\frac{31}{4} - \\frac{10}{\\pi} + \\frac{20}{\\pi^2}$\n\n最后，我们计算比值 $R = \\frac{\\|v\\|_{\\mathrm{DG}}^{2}}{\\|v\\|_{\\mathrm{VEM}}^{2}}$。\n使用 $\\pi$ 的数值：\n$\\|v\\|_{\\mathrm{DG}}^{2} \\approx 6 + \\frac{5 \\cdot (9.8696044)}{16} \\approx 6 + 3.0842514 = 9.0842514$。\n$\\|v\\|_{\\mathrm{VEM}}^{2} \\approx \\frac{31}{4} - \\frac{10}{3.14159265} + \\frac{20}{9.8696044} \\approx 7.75 - 3.1830989 + 2.0264237 = 6.5933248$。\n该比值为 $R = \\frac{9.0842514}{6.5933248} \\approx 1.377800$。\n四舍五入到四位有效数字，我们得到 $1.378$。",
            "answer": "$$\\boxed{1.378}$$"
        },
        {
            "introduction": "现代 DG 类方法的一个关键实用特性是混合化，它利用静态凝聚将大型的基于单元的系统简化为网格骨架上更小、更高效的系统。本练习将引导您完成弱 Galerkin (WG) 方法和一种相关的混合可断裂 Galerkin (HDG) 方法的这一过程，从而揭示它们之间深刻的代数等价性。这对于理论理解和高效实现都至关重要。",
            "id": "3427857",
            "problem": "考虑区间 $[0,3]$ 上的标量扩散模型问题，其扩散系数 $\\kappa>0$ 为常数，并带有齐次狄利克雷边界条件：\n$$\n- (\\kappa u')' = f \\quad \\text{in } (0,3), \\qquad u(0)=0,\\; u(3)=0.\n$$\n令 $\\mathcal{T}_h$ 为包含 $3$ 个单元 $K_1=[0,1]$、$K_2=[1,2]$ 和 $K_3=[2,3]$ 的均匀网格，因此 $h=1$。使用最低阶弱伽辽金(WG)方法和一阶可杂交间断伽辽金(HDG)方法，两者都使用稳定化参数 $\\tau>0$，并采用以下标准定义。\n\n对于弱伽辽金方法，每个单元 $K$ 上的局部离散空间为：单元未知量取 $P_0(K)$，端点上的迹取 $P_0(\\partial K)$。$K$ 上的离散弱梯度通过对偶性定义：对于任意 $q\\in P_0(K)$，\n$$\n(\\nabla_w u, q)_K = - (u_0, q')_K + \\langle \\hat{u}, q n \\rangle_{\\partial K},\n$$\n双线性形式是所有单元上的离散能量和稳定化项之和，\n$$\na_h(u,v) = \\sum_{K\\in \\mathcal{T}_h} \\left[ (\\kappa \\nabla_w u, \\nabla_w v)_K + s_K(u,v) \\right], \\qquad s_K(u,v)=\\frac{\\tau}{h}\\sum_{s\\subset \\partial K} \\int_s (u_0-\\hat{u})(v_0-\\hat{v}).\n$$\n在 $x=0$ 和 $x=3$ 处的迹上强施加狄利克雷边界条件。\n\n任务 1 (WG局部矩阵和静态凝聚)：\n- 在长度为 $h$ 的一般单元 $K=[x_L,x_R]$ 上，使用上述定义和最低阶多项式选择，推导在有序基 $(u_0,\\hat{u}_L,\\hat{u}_R)$ 下的 $3\\times 3$ 局部单元刚度矩阵 $A_K$。\n- 进行静态凝聚（局部杂交）以消除单元未知量 $u_0$，并获得作用于 $(\\hat{u}_L,\\hat{u}_R)$ 的 $2\\times 2$ 舒尔补 $S_K$。\n- 将结果应用于具有 $h=1$ 和在 $x=0$ 和 $x=3$ 处有齐次狄利克雷边界条件的三单元网格，并组装在内部面迹 $x=1$ 和 $x=2$ 处（按 $\\hat{u}(1)$, $\\hat{u}(2)$ 排序）的全局凝聚WG系统。将得到的 $2\\times 2$ 矩阵表示为 $S^{\\mathrm{WG}}$。\n\n对于可杂交间断伽辽金方法（未知量为 $q \\approx -\\kappa u'$ 和 $u$ 的一阶格式），在每个单元 $K$ 上使用标准的HDG局部方程，其中常数近似为 $q_K\\in P_0(K)$、$u_K\\in P_0(K)$，以及单值面迹 $\\hat{u}\\in P_0(\\partial K)$：\n- 对于任意 $r\\in P_0(K)$，$(\\kappa^{-1} q_K, r)_K - (u_K, r')_K + \\langle \\hat{u}, r n \\rangle_{\\partial K} = 0$。\n- 对于任意 $v\\in P_0(K)$，$-(q_K',v)_K + \\langle q_K n + \\tau (u_K - \\hat{u}), v \\rangle_{\\partial K} = (f,v)_K$。\n通过设置 $\\hat{u}(0)=0$ 和 $\\hat{u}(3)=0$ 来强施加狄利克雷边界条件，并在每个内部面 $s$ 上施加全局守恒性条件：\n$$\n\\sum_{K\\supset s} \\big(q_K n_{K,s} + \\tau (u_K - \\hat{u})\\big)\\big|_{s} = 0.\n$$\n\n任务 2 (HDG局部求解器和全局面系统)：\n- 在长度为 $h$ 的一般单元 $K=[x_L,x_R]$ 上，求解HDG局部方程以用局部面迹 $(\\hat{u}_L,\\hat{u}_R)$ 表示 $q_K$ 和 $u_K$。\n- 使用守恒性条件，在内部迹 $\\hat{u}(1)$ 和 $\\hat{u}(2)$ 上组装全局 $2\\times 2$ 系统，并将得到的矩阵表示为 $S^{\\mathrm{HDG}}$。\n\n任务 3 (稀疏性和带宽比较)：\n- 在全局面未知量排序为 $(\\hat{u}(1),\\hat{u}(2))$ 的情况下，确定 $S^{\\mathrm{WG}}$ 和 $S^{\\mathrm{HDG}}$ 的非零模式，并使用带宽 $B$ 的定义 $B = 1+\\max\\{|i-j|: (i,j)\\text{ 是一个非零元素}\\}$，计算带宽 $B_{\\mathrm{WG}}$ 和 $B_{\\mathrm{HDG}}$。\n- 将比率 $B_{\\mathrm{WG}}/B_{\\mathrm{HDG}}$ 报告为单个实数。最终答案无需四舍五入，也无需物理单位。",
            "solution": "该问题要求对一维扩散问题，比较最低阶弱伽辽金(WG)方法和一阶可杂交间断伽辽金(HDG)方法的全局凝聚刚度矩阵。比较将依据矩阵带宽进行。解答将按要求分三部分进行：首先，推导WG方法；其次，推导HDG方法；最后，比较所得矩阵。\n\n### 任务 1：弱伽辽金(WG)方法\n\n我们首先在一个长度为 $h = x_R - x_L$ 的一般单元 $K=[x_L, x_R]$ 上推导局部刚度矩阵。局部未知量为 $u = \\{u_0, \\hat{u}\\}$，其中 $u_0 \\in P_0(K)$ 是单元上的常数，而 $\\hat{u} \\in P_0(\\partial K)$ 表示端点处的值，我们记为 $\\hat{u}_L = \\hat{u}(x_L)$ 和 $\\hat{u}_R = \\hat{u}(x_R)$。局部自由度是三元组 $(u_0, \\hat{u}_L, \\hat{u}_R)$。\n\n离散弱梯度 $\\nabla_w u \\in P_0(K)$ 是在 $K$ 上的常数，由对偶关系对任意 $q \\in P_0(K)$ 定义：\n$$(\\nabla_w u, q)_K = - (u_0, q')_K + \\langle \\hat{u}, q n \\rangle_{\\partial K}$$\n由于 $q \\in P_0(K)$，$q$ 是一个常数，所以其导数 $q'$ 为 $0$。外法向量为 $n(x_R)=1$ 和 $n(x_L)=-1$。该定义简化为：\n$$\\int_K (\\nabla_w u) q \\,dx = \\hat{u}(x_R) q(x_R) n(x_R) + \\hat{u}(x_L) q(x_L) n(x_L)$$\n令 $q=1$（$P_0(K)$ 的一个基），我们得到：\n$$(\\nabla_w u) \\cdot h = \\hat{u}_R \\cdot 1 + \\hat{u}_L \\cdot (-1) = \\hat{u}_R - \\hat{u}_L$$\n因此，离散弱梯度是中心差分：\n$$\\nabla_w u = \\frac{\\hat{u}_R - \\hat{u}_L}{h}$$\n局部双线性形式为 $a_K(u,v) = (\\kappa \\nabla_w u, \\nabla_w v)_K + s_K(u,v)$。我们分别计算每一项。对于 $u=(u_0, \\hat{u}_L, \\hat{u}_R)$ 和 $v=(v_0, \\hat{v}_L, \\hat{v}_R)$：\n第一项是：\n$$(\\kappa \\nabla_w u, \\nabla_w v)_K = \\int_K \\kappa \\left(\\frac{\\hat{u}_R - \\hat{u}_L}{h}\\right) \\left(\\frac{\\hat{v}_R - \\hat{v}_L}{h}\\right) dx = \\frac{\\kappa}{h} (\\hat{u}_R - \\hat{u}_L)(\\hat{v}_R - \\hat{v}_L)$$\n稳定化项是：\n$$s_K(u,v)=\\frac{\\tau}{h}\\sum_{s\\subset \\partial K} \\int_s (u_0-\\hat{u})(v_0-\\hat{v}) = \\frac{\\tau}{h} \\left[ (u_0 - \\hat{u}_L)(v_0 - \\hat{v}_L) + (u_0 - \\hat{u}_R)(v_0 - \\hat{v}_R) \\right]$$\n结合这些项，局部双线性形式 $a_K(u,v)$ 可以表示为 $V^T A_K U$，其中 $U=(u_0, \\hat{u}_L, \\hat{u}_R)^T$ 且 $V=(v_0, \\hat{v}_L, \\hat{v}_R)^T$。通过识别自由度乘积的系数，我们得到 $3 \\times 3$ 的局部刚度矩阵 $A_K$：\n$$A_K = \\begin{pmatrix} \\frac{2\\tau}{h} & -\\frac{\\tau}{h} & -\\frac{\\tau}{h} \\\\ -\\frac{\\tau}{h} & \\frac{\\kappa}{h} + \\frac{\\tau}{h} & -\\frac{\\kappa}{h} \\\\ -\\frac{\\tau}{h} & -\\frac{\\kappa}{h} & \\frac{\\kappa}{h} + \\frac{\\tau}{h} \\end{pmatrix}$$\n接下来，我们进行静态凝聚以消除单元内部未知量 $u_0$。我们将 $A_K$ 对应于未知量 $(u_0)$ 和 $(\\hat{u}_L, \\hat{u}_R)$ 进行分块：\n$$A_K = \\begin{pmatrix} A_{00} & A_{0\\partial} \\\\ A_{\\partial 0} & A_{\\partial\\partial} \\end{pmatrix} \\quad \\text{其中} \\quad A_{00} = \\frac{2\\tau}{h}, \\quad A_{0\\partial} = \\begin{pmatrix} -\\frac{\\tau}{h} & -\\frac{\\tau}{h} \\end{pmatrix}, \\quad A_{\\partial 0} = \\begin{pmatrix} -\\frac{\\tau}{h} \\\\ -\\frac{\\tau}{h} \\end{pmatrix}, \\quad A_{\\partial\\partial} = \\begin{pmatrix} \\frac{\\kappa+\\tau}{h} & -\\frac{\\kappa}{h} \\\\ -\\frac{\\kappa}{h} & \\frac{\\kappa+\\tau}{h} \\end{pmatrix}$$\n作用于迹未知量的舒尔补 $S_K$ 由 $S_K = A_{\\partial\\partial} - A_{\\partial 0} A_{00}^{-1} A_{0\\partial}$ 给出。\n我们有 $A_{00}^{-1} = \\frac{h}{2\\tau}$。\n$$A_{\\partial 0} A_{00}^{-1} A_{0\\partial} = \\begin{pmatrix} -\\frac{\\tau}{h} \\\\ -\\frac{\\tau}{h} \\end{pmatrix} \\left(\\frac{h}{2\\tau}\\right) \\begin{pmatrix} -\\frac{\\tau}{h} & -\\frac{\\tau}{h} \\end{pmatrix} = \\frac{\\tau}{2h} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$$\n所以，舒尔补是：\n$$S_K = \\begin{pmatrix} \\frac{\\kappa+\\tau}{h} & -\\frac{\\kappa}{h} \\\\ -\\frac{\\kappa}{h} & \\frac{\\kappa+\\tau}{h} \\end{pmatrix} - \\frac{\\tau}{2h} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\kappa}{h} + \\frac{\\tau}{2h} & -\\frac{\\kappa}{h} - \\frac{\\tau}{2h} \\\\ -\\frac{\\kappa}{h} - \\frac{\\tau}{2h} & \\frac{\\kappa}{h} + \\frac{\\tau}{2h} \\end{pmatrix} = \\left(\\frac{\\kappa}{h} + \\frac{\\tau}{2h}\\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n现在，我们为给定的具有 $3$ 个单元和 $h=1$ 的网格组装全局系统。内部面未知量是 $\\hat{u}(1)$ 和 $\\hat{u}(2)$。边界条件是 $\\hat{u}(0)=0$ 和 $\\hat{u}(3)=0$。对于 $h=1$，局部舒尔补是 $S_K = (\\kappa + \\frac{\\tau}{2}) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n全局矩阵 $S^{\\mathrm{WG}}$ 是通过对每个单元的贡献求和来组装的：\n- 单元 $K_1=[0,1]$ 连接节点 $0$ 和 $1$。它对 $(\\hat{u}(1), \\hat{u}(1))$ 项的贡献是 $S_{K_1,22} = \\kappa + \\frac{\\tau}{2}$。\n- 单元 $K_2=[1,2]$ 连接节点 $1$ 和 $2$。它对自由度 $(\\hat{u}(1),\\hat{u}(2))$ 的矩阵贡献是 $(\\kappa + \\frac{\\tau}{2}) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n- 单元 $K_3=[2,3]$ 连接节点 $2$ 和 $3$。它对 $(\\hat{u}(2), \\hat{u}(2))$ 项的贡献是 $S_{K_3,11} = \\kappa + \\frac{\\tau}{2}$。\n对自由度 $(\\hat{u}(1), \\hat{u}(2))$ 的这些贡献求和，我们得到：\n$$S^{\\mathrm{WG}}_{11} = (S_{K_1,22}) + (S_{K_2,11}) = (\\kappa + \\frac{\\tau}{2}) + (\\kappa + \\frac{\\tau}{2}) = 2\\kappa + \\tau$$\n$$S^{\\mathrm{WG}}_{12} = S_{K_2,12} = -(\\kappa + \\frac{\\tau}{2})$$\n$$S^{\\mathrm{WG}}_{21} = S_{K_2,21} = -(\\kappa + \\frac{\\tau}{2})$$\n$$S^{\\mathrm{WG}}_{22} = (S_{K_2,22}) + (S_{K_3,11}) = (\\kappa + \\frac{\\tau}{2}) + (\\kappa + \\frac{\\tau}{2}) = 2\\kappa + \\tau$$\n组装好的全局凝聚WG矩阵是：\n$$S^{\\mathrm{WG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n\n### 任务 2：可杂交间断伽辽金(HDG)方法\n\n在一个长度为 $h$ 的一般单元 $K=[x_L, x_R]$ 上，局部未知量是常数 $q_K, u_K \\in P_0(K)$。局部问题由两个方程定义。\n第一个方程，用 $r=1 \\in P_0(K)$ 测试：\n$$(\\kappa^{-1} q_K, 1)_K - (u_K, 1')_K + \\langle \\hat{u}, 1 \\cdot n \\rangle_{\\partial K} = 0$$\n因为 $1' = 0$，这变成 $\\kappa^{-1} q_K h + (\\hat{u}_R \\cdot 1 + \\hat{u}_L \\cdot (-1)) = 0$，得到：\n$$q_K = -\\kappa \\frac{\\hat{u}_R - \\hat{u}_L}{h}$$\n第二个方程，用 $v=1 \\in P_0(K)$ 测试：\n$$-(q_K', 1)_K + \\langle q_K n + \\tau (u_K - \\hat{u}), 1 \\rangle_{\\partial K} = (f,1)_K$$\n因为 $q_K$ 是常数，所以 $q_K'=0$。这变成：\n$$(q_K n(x_R) + \\tau(u_K - \\hat{u}_R)) + (q_K n(x_L) + \\tau(u_K - \\hat{u}_L)) = \\int_K f dx$$\n$$(q_K + \\tau(u_K - \\hat{u}_R)) + (-q_K + \\tau(u_K - \\hat{u}_L)) = \\int_K f dx$$\n$$2\\tau u_K - \\tau(\\hat{u}_L + \\hat{u}_R) = \\int_K f dx$$\n$$u_K = \\frac{\\hat{u}_L + \\hat{u}_R}{2} + \\frac{1}{2\\tau} \\int_K f dx$$\n全局系统通过在每个内部面 $s$ 上施加数值通量的连续性来形成：$\\sum_{K\\supset s} (q_K n_{K,s} + \\tau (u_K - \\hat{u}))|_s = 0$。\n我们为自由度 $(\\hat{u}(1), \\hat{u}(2))$ 在 $h=1$ 且边界条件为 $\\hat{u}(0)=0, \\hat{u}(3)=0$ 的网格上组装系统。令 $f_i = \\int_{K_i} f dx$。\n\n在界面 $x=1$ 处（$K_1$ 和 $K_2$ 之间）：\n- 来自 $K_1=[0,1]$ 的通量（法向 $n=+1$）：\n  $q_{K_1} = -\\kappa(\\hat{u}(1)-\\hat{u}(0)) = -\\kappa\\hat{u}(1)$。\n  $u_{K_1} = \\frac{\\hat{u}(0)+\\hat{u}(1)}{2} + \\frac{f_1}{2\\tau} = \\frac{\\hat{u}(1)}{2} + \\frac{f_1}{2\\tau}$。\n  通量迹：$q_{K_1}(1) + \\tau(u_{K_1}-\\hat{u}(1)) = -\\kappa\\hat{u}(1) + \\tau(\\frac{\\hat{u}(1)}{2} - \\hat{u}(1)) + \\frac{f_1}{2} = -(\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_1}{2}$。\n- 来自 $K_2=[1,2]$ 的通量（法向 $n=-1$）：\n  $q_{K_2} = -\\kappa(\\hat{u}(2)-\\hat{u}(1))$。\n  $u_{K_2} = \\frac{\\hat{u}(1)+\\hat{u}(2)}{2} + \\frac{f_2}{2\\tau}$。\n  通量迹：$q_{K_2}(-1) + \\tau(u_{K_2}-\\hat{u}(1)) = \\kappa(\\hat{u}(2)-\\hat{u}(1)) + \\tau(\\frac{\\hat{u}(1)+\\hat{u}(2)}{2} - \\hat{u}(1)) + \\frac{f_2}{2} = (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_2}{2}$。\n- 通量之和为零：$( -(\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_1}{2} ) + ( (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_2}{2} ) = 0$。\n这给出了全局系统的第一行：$(2\\kappa+\\tau)\\hat{u}(1) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) = \\frac{1}{2}(f_1+f_2)$。\n\n在界面 $x=2$ 处（$K_2$ 和 $K_3$ 之间）：\n- 来自 $K_2=[1,2]$ 的通量（法向 $n=+1$）：\n  通量迹：$q_{K_2}(1) + \\tau(u_{K_2}-\\hat{u}(2)) = -\\kappa(\\hat{u}(2)-\\hat{u}(1)) + \\tau(\\frac{\\hat{u}(1)+\\hat{u}(2)}{2} - \\hat{u}(2)) + \\frac{f_2}{2} = (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_2}{2}$。\n- 来自 $K_3=[2,3]$ 的通量（法向 $n=-1$）：\n  $q_{K_3} = -\\kappa(\\hat{u}(3)-\\hat{u}(2)) = \\kappa\\hat{u}(2)$。\n  $u_{K_3} = \\frac{\\hat{u}(2)+\\hat{u}(3)}{2} + \\frac{f_3}{2\\tau} = \\frac{\\hat{u}(2)}{2} + \\frac{f_3}{2\\tau}$。\n  通量迹：$q_{K_3}(-1) + \\tau(u_{K_3}-\\hat{u}(2)) = -\\kappa\\hat{u}(2) + \\tau(\\frac{\\hat{u}(2)}{2} - \\hat{u}(2)) + \\frac{f_3}{2} = -(\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_3}{2}$。\n- 通量之和为零：$( (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_2}{2} ) + ( -(\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_3}{2} ) = 0$。\n这给出了第二行：$-(\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + (2\\kappa+\\tau)\\hat{u}(2) = \\frac{1}{2}(f_2+f_3)$。\n\n从全局系统中提取矩阵，我们得到：\n$$S^{\\mathrm{HDG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n\n### 任务 3：稀疏性和带宽比较\n\n我们已经推导出了内部迹未知量 $(\\hat{u}(1), \\hat{u}(2))$ 的全局凝聚矩阵：\n$$S^{\\mathrm{WG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n$$S^{\\mathrm{HDG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n矩阵是相同的，$S^{\\mathrm{WG}} = S^{\\mathrm{HDG}}$。\n\n为了确定带宽，我们首先确定非零模式。由于 $\\kappa>0$ 和 $\\tau>0$，对角线元素 $2\\kappa+\\tau$ 是正的，非对角线元素 $-(\\kappa+\\frac{\\tau}{2})$ 是负的。因此，两个矩阵的所有四个元素都是非零的。这些矩阵是稠密的。\n\n带宽 $B$ 定义为 $B = 1 + \\max\\{|i-j|: (i,j) \\text{ 是一个非零元素}\\}$。对于 $2 \\times 2$ 矩阵，索引 $(i,j)$ 为 $(1,1), (1,2), (2,1), (2,2)$。对应的 $|i-j|$ 值为 $|1-1|=0$, $|1-2|=1$, $|2-1|=1$ 和 $|2-2|=0$。最大值为 $1$。\n因此，两个矩阵的带宽都是：\n$$B_{\\mathrm{WG}} = 1 + 1 = 2$$\n$$B_{\\mathrm{HDG}} = 1 + 1 = 2$$\n带宽的比率是：\n$$\\frac{B_{\\mathrm{WG}}}{B_{\\mathrm{HDG}}} = \\frac{2}{2} = 1$$\n这个结果证明了在这个问题上，这种特定的最低阶WG方法和一阶HDG方法之间的已知等价性。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "数值通量的选择至关重要，尤其对于对流主导问题。本练习通过分析间断 Galerkin (DG) 和弱 Galerkin (WG) 方法各自的数值通量（迎风格式与 Lax-Friedrichs 型格式），研究了这两种方法在线性对流方程上的稳定性。通过推导无振荡解的条件，您将深入了解不同的通量公式如何影响模拟的稳定性和准确性。",
            "id": "3427871",
            "problem": "考虑线性平流方程 $u_{t} + \\boldsymbol{\\beta}\\cdot\\nabla u = 0$，定义在一个一维区域上，该区域被划分为大小为 $h$ 的均匀网格单元，其中对流场为常数 $\\boldsymbol{\\beta} = \\beta \\mathbf{e}_{x}$，且 $\\beta>0$。在每个单元上，用分片常数多项式（$p=0$）来近似 $u$。令 $u_{i}(t)$ 表示单元 $i$ 上的单元平均值，并令 $u^{-}$ 和 $u^{+}$ 分别表示界面上来自左侧和右侧的迹。定义界面上的平均值和跳跃为 $\\{u\\} = \\frac{1}{2}(u^{-}+u^{+})$ 和 $[u] = u^{+}-u^{-}$。\n\n在每个内部界面上考虑两种离散方法：\n\n- 间断 Galerkin (DG) 方法，采用标准的平流迎风数值通量：对于 $\\beta>0$，$\\widehat{F}^{\\mathrm{DG}} = \\beta\\,u^{-}$。\n\n- 弱 Galerkin (WG) 方法，采用单值数值迹，该迹导出带有罚参数 $\\tau \\ge 0$（与 $\\beta$ 具有相同的物理单位）的 Lax-Friedrichs 型界面通量：$\\widehat{F}^{\\mathrm{WG}} = \\beta\\,\\{u\\} - \\left(\\frac{\\beta}{2} + \\frac{\\tau}{2}\\right)[u]$。该形式是相容的、守恒的，并且当 $\\tau=0$ 时退化为 DG 迎风通量。\n\n在每个单元上使用守恒定律，推导每种情况下 $u_{i}(t)$ 的半离散常微分方程，然后考虑时间步长为 $\\Delta t$ 的前向欧拉时间离散，定义 Courant 数 $\\nu = \\beta\\,\\Delta t / h$。\n\n施加离散无振荡（单调性）条件，即 $u_{i}$ 的单步前向欧拉更新是相邻单元值 $u_{i-1}^{n}$、$u_{i}^{n}$ 和 $u_{i+1}^{n}$ 的系数非负的凸组合。在此条件下，确定每种方法允许的最大 Courant 数，记为 $\\nu_{\\max}$，并用 $\\beta$ 和 $\\tau$ 表示。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含 $\\nu_{\\max}^{\\mathrm{WG}}$ 和 $\\nu_{\\max}^{\\mathrm{DG}}$。最终的无量纲结果不需要单位。不要四舍五入，给出精确的符号表达式。",
            "solution": "问题陈述经评估有效。它在偏微分方程数值分析领域，特别是在有限元方法方面，具有科学依据。该问题是适定的，提供了推导唯一解所需的所有必要定义、方程和条件。语言客观、精确。\n\n我们现在开始对每种方法进行推导。\n\n控制偏微分方程是一维线性平流方程：\n$$ u_{t} + \\beta u_{x} = 0 $$\n其中 $\\beta > 0$ 是一个常数。空间域被离散为大小均匀的单元 $K_i = [x_{i-1/2}, x_{i+1/2}]$，其中 $h = x_{i+1/2} - x_{i-1/2}$。解 $u$ 由分片常数函数近似，$u(x,t) \\approx u_i(t)$，对于 $x \\in K_i$。\n\n单元平均值 $u_i$ 的半离散格式是通过在单元 $K_i$ 上对偏微分方程进行积分并使用常数测试函数 $v=1$ 得到的：\n$$ \\int_{K_i} u_t \\,dx + \\int_{K_i} \\beta u_x \\,dx = 0 $$\n$$ \\frac{d}{dt} \\left( \\int_{K_i} u_i(t) \\,dx \\right) + \\beta [u(x,t)]_{x_{i-1/2}}^{x_{i+1/2}} = 0 $$\n$$ h \\frac{du_i}{dt} + \\beta(u(x_{i+1/2}, t) - u(x_{i-1/2}, t)) = 0 $$\n精确解的迹 $u(x_{i \\pm 1/2}, t)$ 被数值通量函数 $\\widehat{F}(u^-, u^+)$ 替代，其中 $u^-$ 和 $u^+$ 分别是界面左侧和右侧的近似解值。这给出了守恒的有限体积型格式：\n$$ h \\frac{du_i}{dt} + \\widehat{F}_{i+1/2} - \\widehat{F}_{i-1/2} = 0 $$\n其中 $\\widehat{F}_{i+1/2}$ 是单元 $i$ 和 $i+1$ 之间界面 $x_{i+1/2}$ 处的通量，$\\widehat{F}_{i-1/2}$ 是单元 $i-1$ 和 $i$ 之间界面 $x_{i-1/2}$ 处的通量。\n\n**第一部分：间断 Galerkin (DG) 方法**\n\n对于 DG 方法，数值通量是迎风通量。由于 $\\beta>0$，流动方向是从左到右，因此迎风值为来自左侧的迹 $u^-$。\n$$ \\widehat{F}^{\\mathrm{DG}}(u^-, u^+) = \\beta u^- $$\n在界面 $x_{i+1/2}$ 处，我们有 $u^- = u_i$ 和 $u^+ = u_{i+1}$。通量为：\n$$ \\widehat{F}_{i+1/2}^{\\mathrm{DG}} = \\beta u_i $$\n在界面 $x_{i-1/2}$ 处，我们有 $u^- = u_{i-1}$ 和 $u^+ = u_i$。通量为：\n$$ \\widehat{F}_{i-1/2}^{\\mathrm{DG}} = \\beta u_{i-1} $$\n将这些通量代入守恒定律：\n$$ h \\frac{du_i}{dt} + (\\beta u_i) - (\\beta u_{i-1}) = 0 $$\nDG 方法的半离散常微分方程 (ODE) 是：\n$$ \\frac{du_i}{dt} = -\\frac{\\beta}{h}(u_i - u_{i-1}) $$\n应用前向欧拉时间离散，$\\frac{u_i^{n+1}-u_i^n}{\\Delta t} = \\frac{du_i}{dt}\\Big|_{t=t^n}$：\n$$ \\frac{u_i^{n+1}-u_i^n}{\\Delta t} = -\\frac{\\beta}{h}(u_i^n - u_{i-1}^n) $$\n$$ u_i^{n+1} = u_i^n - \\frac{\\beta \\Delta t}{h}(u_i^n - u_{i-1}^n) $$\n使用 Courant 数 $\\nu = \\frac{\\beta \\Delta t}{h}$：\n$$ u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n) = (1-\\nu)u_i^n + \\nu u_{i-1}^n $$\n如果系数非负，这就是相邻单元值的凸组合。\n1. $u_{i-1}^n$ 的系数：$\\nu \\ge 0$。由于 $\\beta, \\Delta t, h$ 均为正，此条件满足。\n2. $u_i^n$ 的系数：$1 - \\nu \\ge 0 \\implies \\nu \\le 1$。\n3. $u_{i+1}^n$ 的系数是 $0$，这是非负的。\n\n单调性条件是 $0 \\le \\nu \\le 1$。允许的最大 Courant 数是 $\\nu_{\\max}^{\\mathrm{DG}} = 1$。\n\n**第二部分：弱 Galerkin (WG) 方法**\n\n对于 WG 方法，数值通量由下式给出：\n$$ \\widehat{F}^{\\mathrm{WG}}(u^-, u^+) = \\beta\\{u\\} - \\left(\\frac{\\beta}{2} + \\frac{\\tau}{2}\\right)[u] = \\beta\\frac{u^-+u^+}{2} - \\frac{\\beta+\\tau}{2}(u^+-u^-) $$\n让我们用 $u^-$ 和 $u^+$ 来展开这个式子：\n$$ \\widehat{F}^{\\mathrm{WG}} = u^-\\left(\\frac{\\beta}{2} + \\frac{\\beta+\\tau}{2}\\right) + u^+\\left(\\frac{\\beta}{2} - \\frac{\\beta+\\tau}{2}\\right) = u^-\\left(\\frac{2\\beta+\\tau}{2}\\right) + u^+\\left(-\\frac{\\tau}{2}\\right) $$\n在界面 $x_{i+1/2}$ 处，我们有 $u^- = u_i$ 和 $u^+ = u_{i+1}$：\n$$ \\widehat{F}_{i+1/2}^{\\mathrm{WG}} = u_i\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_{i+1}\\left(\\frac{\\tau}{2}\\right) $$\n在界面 $x_{i-1/2}$ 处，我们有 $u^- = u_{i-1}$ 和 $u^+ = u_i$：\n$$ \\widehat{F}_{i-1/2}^{\\mathrm{WG}} = u_{i-1}\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_i\\left(\\frac{\\tau}{2}\\right) $$\n将这些代入守恒定律 $h \\frac{du_i}{dt} = -(\\widehat{F}_{i+1/2} - \\widehat{F}_{i-1/2})$：\n$$ h \\frac{du_i}{dt} = -\\left[ \\left(u_i\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_{i+1}\\left(\\frac{\\tau}{2}\\right)\\right) - \\left(u_{i-1}\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_i\\left(\\frac{\\tau}{2}\\right)\\right) \\right] $$\n$$ h \\frac{du_i}{dt} = u_{i-1}\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_i\\left(\\frac{2\\beta+\\tau}{2} + \\frac{\\tau}{2}\\right) + u_{i+1}\\left(\\frac{\\tau}{2}\\right) $$\n$$ h \\frac{du_i}{dt} = u_{i-1}\\left(\\beta+\\frac{\\tau}{2}\\right) - u_i(\\beta+\\tau) + u_{i+1}\\left(\\frac{\\tau}{2}\\right) $$\nWG 方法的半离散 ODE 是：\n$$ \\frac{du_i}{dt} = \\frac{1}{h}\\left( \\left(\\beta+\\frac{\\tau}{2}\\right)u_{i-1} - (\\beta+\\tau)u_i + \\frac{\\tau}{2}u_{i+1} \\right) $$\n应用前向欧拉时间离散：\n$$ \\frac{u_i^{n+1}-u_i^n}{\\Delta t} = \\frac{1}{h}\\left( \\left(\\beta+\\frac{\\tau}{2}\\right)u_{i-1}^n - (\\beta+\\tau)u_i^n + \\frac{\\tau}{2}u_{i+1}^n \\right) $$\n$$ u_i^{n+1} = u_i^n + \\frac{\\Delta t}{h}\\left( \\left(\\beta+\\frac{\\tau}{2}\\right)u_{i-1}^n - (\\beta+\\tau)u_i^n + \\frac{\\tau}{2}u_{i+1}^n \\right) $$\n按单元索引对各项进行分组：\n$$ u_i^{n+1} = \\left(\\frac{\\Delta t}{h}\\left(\\beta+\\frac{\\tau}{2}\\right)\\right)u_{i-1}^n + \\left(1 - \\frac{\\Delta t}{h}(\\beta+\\tau)\\right)u_i^n + \\left(\\frac{\\Delta t}{h}\\frac{\\tau}{2}\\right)u_{i+1}^n $$\n要使其成为凸组合，所有系数必须为非负。\n1. $u_{i-1}^n$ 的系数：$\\frac{\\Delta t}{h}(\\beta+\\frac{\\tau}{2}) \\ge 0$。由于 $\\Delta t, h, \\beta > 0$ 且 $\\tau \\ge 0$，此条件满足。\n2. $u_{i+1}^n$ 的系数：$\\frac{\\Delta t}{h}\\frac{\\tau}{2} \\ge 0$。由于 $\\Delta t, h > 0$ 且 $\\tau \\ge 0$，此条件满足。\n3. $u_i^n$ 的系数：$1 - \\frac{\\Delta t}{h}(\\beta+\\tau) \\ge 0$。这给出了稳定性约束：\n$$ 1 \\ge \\frac{\\Delta t}{h}(\\beta+\\tau) $$\n$$ \\Delta t \\le \\frac{h}{\\beta+\\tau} $$\n为了用 Courant 数 $\\nu = \\frac{\\beta \\Delta t}{h}$ 来表示，我们重排不等式：\n$$ \\frac{\\beta \\Delta t}{h} \\le \\frac{\\beta}{\\beta+\\tau} $$\n$$ \\nu \\le \\frac{\\beta}{\\beta+\\tau} $$\nWG 方法允许的最大 Courant 数是 $\\nu_{\\max}^{\\mathrm{WG}} = \\frac{\\beta}{\\beta+\\tau}$。\n\n**结论**\n\n在单调性条件下，每种方法允许的最大 Courant 数为：\n- 对于带迎风通量的 DG 方法：$\\nu_{\\max}^{\\mathrm{DG}} = 1$。\n- 对于给定的 Lax-Friedrichs 型通量的 WG 方法：$\\nu_{\\max}^{\\mathrm{WG}} = \\frac{\\beta}{\\beta+\\tau}$。\n\n最终答案需以单行矩阵形式给出，按顺序包含 $\\nu_{\\max}^{\\mathrm{WG}}$ 和 $\\nu_{\\max}^{\\mathrm{DG}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\beta}{\\beta+\\tau} & 1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}