{
    "hands_on_practices": [
        {
            "introduction": "紧凑非连续伽辽金（CDG）方法的一个决定性特征是其“紧凑模板”，这意味着一个单元的离散算子只与共享同一个面的近邻单元耦合。本练习旨在通过一个基础的二维泊松问题，让学习者直接验证这一关键属性 。通过为最简单的分片常数基函数（$p=0$）组装对称内部罚分（SIPG）格式中的项，你将亲眼见证非相邻单元之间的耦合项是如何精确地为零的，从而加深对CDG方法局部通信结构的理解。",
            "id": "3371791",
            "problem": "考虑在$\\mathbb{R}^{2}$中的一个多边形域上，具有常扩散系数$a=1$的标量泊松问题：求解$u$使得\n$$\n-\\nabla \\cdot \\left( \\nabla u \\right) = f \\quad \\text{in } \\Omega,\n$$\n在下文描述的内部片区之外有适当的边界条件。设$\\mathcal{T}_{h}$为一个协调三角剖分。关注一个由三个三角形$\\{K_{1},K_{2},K_{3}\\}$组成的内部片区，它们在单个内部顶点$\\mathbf{x}_{\\star} \\in \\Omega$处相交，其中$K_{1}$和$K_{2}$共享一个长度为$\\ell_{12}>0$的内部面$f_{12}$，$K_{2}$和$K_{3}$共享一个长度为$\\ell_{23}>0$的内部面$f_{23}$，而$K_{1}$和$K_{3}$不共享面（它们仅在顶点$\\mathbf{x}_{\\star}$处相交）。没有其他单元沿$f_{12}$或$f_{23}$接触此片区。设$h_{12}>0$和$h_{23}>0$分别为与$f_{12}$和$f_{23}$相关联的特征面尺寸。对每个内部面$f$，固定一个方向，其单位法向量$\\mathbf{n}_{f}$从负侧$K^{-}$指向正侧$K^{+}$。定义标量迹$w$穿过$f$的跳跃为$[w] = w^{-} - w^{+}$，向量迹$\\boldsymbol{q}$的平均为$\\{\\!\\{\\boldsymbol{q}\\}\\!\\} = \\frac{1}{2}\\left( \\boldsymbol{q}^{-} + \\boldsymbol{q}^{+} \\right)$。\n\n使用$p=0$次的分片多项式空间（单元常数）进行离散化，每个单元一个基函数，\n$$\n\\varphi_{1} = \\chi_{K_{1}}, \\quad \\varphi_{2} = \\chi_{K_{2}}, \\quad \\varphi_{3} = \\chi_{K_{3}},\n$$\n其中$\\chi_{K}$表示单元$K$的指示函数。考虑对称内部罚伽辽金（SIPG）方法，这是一种紧凑非连续伽辽金格式，其双线性形式为\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\mathbf{x}\n- \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [v] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [u] \\right) \\, \\mathrm{d}s\n+ \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [u] \\, [v] \\, \\mathrm{d}s,\n$$\n其中$\\mathcal{F}_{h}^{\\circ}$表示内部面的集合，$\\sigma_{f}>0$是一个逐面的罚参数。在该片区上，取$\\sigma_{f_{12}} = \\tau / h_{12}$和$\\sigma_{f_{23}} = \\tau / h_{23}$，其中$\\tau>0$是一个固定常数。\n\n使用上述定义以及对于$p=0$在每个单元内部$\\nabla \\varphi_{i} = \\mathbf{0}$这一事实，显式组装在$f_{12}$和$f_{23}$上对局部类刚度矩阵元$A_{ij} = a(\\varphi_{i},\\varphi_{j})$（其中$i,j \\in \\{1,2,3\\}$）的所有面贡献。然后，利用这些组装好的表达式，确定非对角元$A_{13}$的精确值，该值表示不相邻单元$K_{1}$和$K_{3}$之间的任何耦合。\n\n以单个精确值的形式提供最终答案。无需四舍五入。不涉及物理单位。角度单位不适用。",
            "solution": "该问题要求显式计算泊松问题对称内部罚伽辽金（SIPG）离散化的类刚度矩阵的非对角元$A_{13}$。矩阵元$A_{ij}$由双线性形式$a(\\varphi_i, \\varphi_j)$定义，其中$\\varphi_i$和$\\varphi_j$是基函数。具体来说，我们必须确定$A_{13} = a(\\varphi_1, \\varphi_3)$。\n\n给定的双线性形式是：\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\mathbf{x}\n- \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [v] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [u] \\right) \\, \\mathrm{d}s\n+ \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [u] \\, [v] \\, \\mathrm{d}s\n$$\n我们将指定的基函数$u=\\varphi_1$和$v=\\varphi_3$代入测试函数和试探函数。这得到：\n$$\nA_{13} = a(\\varphi_1, \\varphi_3) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla \\varphi_1 \\cdot \\nabla \\varphi_3 \\, \\mathrm{d}\\mathbf{x}\n- \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla \\varphi_1\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_3] + \\{\\!\\{\\nabla \\varphi_3\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_1] \\right) \\, \\mathrm{d}s\n+ \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [\\varphi_1] \\, [\\varphi_3] \\, \\mathrm{d}s\n$$\n分析过程是通过检查$A_{13}$表达式中的三项来进行的。基函数是为$p=0$次的分片多项式空间定义的。这意味着在每个单元$K_i$上，基函数$\\varphi_i = \\chi_{K_i}$是一个常数（在$K_i$上为1，在其他地方为0）。\n\n1.  **体积积分项：**\n    第一项是三角剖分$\\mathcal{T}_h$中所有单元上的体积积分之和。\n    $$\n    \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla \\varphi_1 \\cdot \\nabla \\varphi_3 \\, \\mathrm{d}\\mathbf{x}\n    $$\n    由于$\\varphi_1$和$\\varphi_3$是分片常数函数，它们在任何单元$K \\in \\mathcal{T}_h$内部的梯度都为零。也就是说，对于任何$K$，当$\\mathbf{x} \\in K$时，有$\\nabla \\varphi_1(\\mathbf{x}) = \\mathbf{0}$和$\\nabla \\varphi_3(\\mathbf{x}) = \\mathbf{0}$。因此，被积函数$\\nabla \\varphi_1 \\cdot \\nabla \\varphi_3$处处恒等于零。所以，体积积分项为零。\n\n2.  **一致性（梯度）项：**\n    第二项涉及内部面$\\mathcal{F}_h^\\circ$上的积分。\n    $$\n    - \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla \\varphi_1\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_3] + \\{\\!\\{\\nabla \\varphi_3\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_1] \\right) \\, \\mathrm{d}s\n    $$\n    作用于单元$K^-$和$K^+$之间的面$f$上的向量迹$\\boldsymbol{q}$的平均算子$\\{\\!\\{\\cdot\\}\\!\\}$定义为$\\{\\!\\{\\boldsymbol{q}\\}\\!\\} = \\frac{1}{2}(\\boldsymbol{q}|_{K^-} + \\boldsymbol{q}|_{K^+})$。由于$\\nabla\\varphi_1$和$\\nabla\\varphi_3$在每个单元内都为零，它们在任何面$f$上从两侧的迹也为零。因此，对于任何面$f$，我们有$\\{\\!\\{\\nabla \\varphi_1\\}\\!\\} = \\mathbf{0}$和$\\{\\!\\{\\nabla \\varphi_3\\}\\!\\} = \\mathbf{0}$。所以被积函数对每个面都恒等于零。整个项的计算结果为零。\n\n3.  **罚项：**\n    第三项也是最后一项是罚项，它也涉及内部面上的积分。\n    $$\n    \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [\\varphi_1] \\, [\\varphi_3] \\, \\mathrm{d}s\n    $$\n    这是唯一可能非零的项。让我们分析在任意内部面$f$上跳跃的乘积$[\\varphi_1] \\, [\\varphi_3]$。一个函数$\\psi$穿过分隔单元$K^-$和$K^+$的面$f$的跳跃定义为$[\\psi] = \\psi|_{K^-} - \\psi|_{K^+}$。\n\n    基函数$\\varphi_1 = \\chi_{K_1}$在单元$K_1$上为1，在所有其他单元上为0。穿过面$f$的跳跃$[\\varphi_1]$非零，当且仅当$f$是单元$K_1$的一个面。如果$f$不属于边界$\\partial K_1$的一部分，那么$\\varphi_1$在$f$的两侧都为0，使得$[\\varphi_1] = 0$。\n\n    类似地，基函数$\\varphi_3 = \\chi_{K_3}$在单元$K_3$上为1，在所有其他单元上为0。穿过面$f$的跳跃$[\\varphi_3]$非零，当且仅当$f$是单元$K_3$的一个面。\n\n    要使乘积$[\\varphi_1] \\, [\\varphi_3]$在面$f$上非零，$[\\varphi_1]$和$[\\varphi_3]$必须在该面上都非零。这要求面$f$同时是$K_1$的面和$K_3$的面。换句话说，单元$K_1$和$K_3$必须共享面$f$。\n\n    然而，问题陈述明确指出“$K_{1}$和$K_{3}$不共享面（它们仅在顶点$\\mathbf{x}_{\\star}$处相交）。”这意味着对于任何内部面$f \\in \\mathcal{F}_{h}^{\\circ}$，它不可能是$K_1$和$K_3$的公共边界。因此，对于任何给定的面$f$，跳跃$[\\varphi_1]$或$[\\varphi_3]$中至少有一个必须为零。\n    \n    因此，乘积$[\\varphi_1] \\, [\\varphi_3]$在网格中的每个面$f$上都恒等于零。\n    \n    这对所有面都成立，包括特别提到的面$f_{12}$和$f_{23}$。\n    - 在面$f_{12}$上（在$K_1$和$K_2$之间）：$[\\varphi_1] \\neq 0$但$[\\varphi_3] = 0$。所以贡献为0。\n    - 在面$f_{23}$上（在$K_2$和$K_3$之间）：$[\\varphi_1] = 0$但$[\\varphi_3] \\neq 0$。所以贡献为0。\n    \n    由于对于所有$f \\in \\mathcal{F}_{h}^{\\circ}$，被积函数$\\sigma_{f} \\, [\\varphi_1] \\, [\\varphi_3]$都为零，罚项是零的和：\n    $$\n    \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\cdot 0 \\, \\mathrm{d}s = 0\n    $$\n\n结合这三项的结果，我们发现：\n$$\nA_{13} = 0 - 0 + 0 = 0\n$$\n矩阵元$A_{13}$，它表示不相邻单元$K_1$和$K_3$上基函数之间的耦合，精确地为零。这是非连续伽辽金方法的一个基本性质，其中一个单元的模板仅限于其直接的面相邻单元，这使得最终的系统矩阵是稀疏的。紧凑非连续伽辽金方法中的“紧凑”一词指的就是这个性质。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在理解了紧凑模板的概念之后，一个自然的问题是：这种局部性如何转化为全局刚度矩阵的具体结构？本练习将指导你量化这种结构，即计算与内部单元相关的一个矩阵行中的非零项数量 。通过推导一个以多项式次数 $p$ 和单元面数 $N_{f}$ 表示的封闭形式表达式，你将学会如何将CDG方法的几何模板与线性系统的稀疏度直接联系起来，这是评估计算成本和复杂性的关键一步。",
            "id": "3371779",
            "problem": "考虑一个三维空间中有界多面体域上的协调四面体网格。设未知量通过紧凑非连续伽辽金（Compact Discontinuous Galerkin, CDG）方法进行离散化，该方法用于求解带内部罚分的对称二阶标量椭圆算子，并在每个四面体上使用总次数至多为 $p$ 的多项式空间，记为 $\\mathbb{P}_{p}(K)$。假设满足以下科学上标准的建模条件：(i) 单元内部双线性形式的贡献仅支撑在单个四面体 $K$ 上；(ii) 数值通量和提升算子仅支撑在面上，因此耦合仅发生在共享一个公共面的四面体对之间；(iii) 组装的局部单元块和每个面耦合块在所选的局部基下是代数稠密的。关注一个典型的内部四面体，在一个协调四面体网格中，它有 $N_{f}$ 个面，并忽略边界条件引起的模板规模的减小。令 $N_{p}$ 表示在四面体上对于 $\\mathbb{P}_{p}(K)$ 的局部自由度数量。\n\n从间断伽辽金双线性形式的基本定义和 $\\mathbb{P}_{p}(K)$ 的组合维度出发，推导全局刚度矩阵中与内部四面体上的一个自由度相关联的行中非零项的精确数量。用 $p$ 的闭式解析表达式表示你的最终答案，利用四面体有 $N_{f} = 4$ 个面以及四面体上 $\\mathbb{P}_{p}(K)$ 的标准维度公式。精确地给出最终表达式；无需四舍五入。",
            "solution": "问题要求在使用紧凑非连续伽辽金（CDG）方法时，全局刚度矩阵中与内部四面体上的一个自由度相关联的行中的非零项数量。\n\n令全局刚度矩阵记为 $A$。该矩阵的一个元素 $A_{ij}$ 非零，当且仅当对应于全局自由度 $i$ 和 $j$ 的基函数 $\\phi_i$ 和 $\\phi_j$ 在DG方法的双线性形式中具有相互作用的支撑集。我们需要找到与支撑在内部四面体（我们称之为 $K$）上的基函数 $\\phi_i$ 对应的行中的非零项数量。这等价于找到 $\\phi_i$ 的模板大小。\n\n模板的结构由对DG双线性形式的贡献决定。问题陈述指明了两种耦合来源：\n$1$。单元内部的贡献。\n$2$。基于面的贡献（数值通量和提升算子）。\n\n让我们来分析对于支撑集为四面体 $K$ 的基函数 $\\phi_i$ 的这些贡献。\n\n首先，考虑单元内部的贡献。问题指出这些贡献仅支撑在单个四面体 $K$ 上。这意味着双线性形式的体积积分部分将 $K$ 上的一个基函数 $\\phi_i$ 与同样支撑在同一个四面体 $K$ 上的其他基函数 $\\phi_j$ 耦合起来。问题进一步指明“组装的局部单元块…在所选的局部基下是代数稠密的。” 这是一个关键条件，因为它意味着对应于 $K$ 上自由度的子矩阵是满阵。因此，基函数 $\\phi_i$ 与支撑在 $K$ 上的*每个*基函数（包括其自身）耦合。这样的基函数的数量就是四面体上的局部自由度数量，记为 $N_p$。这种自身单元的耦合为与自由度 $i$ 关联的矩阵 $A$ 的行贡献了 $N_p$ 个非零项。\n\n其次，考虑基于面的贡献。问题指出“数值通量和提升算子仅支撑在面上，因此耦合仅发生在共享一个公共面的四面体对之间。” 我们正在考虑一个内部四面体 $K$。在一个协调四面体网格中，一个四面体有 $N_f = 4$ 个面。由于 $K$ 是一个内部单元，它的4个面中的每一个都与一个唯一的相邻四面体共享。令这些相邻的四面体记为 $K_1, K_2, K_3,$ 和 $K_4$。\n\n双线性形式中基于面的项在 $K$ 上的自由度与它的每个邻居 $K_j$（其中 $j \\in \\{1, 2, 3, 4\\}$）上的自由度之间产生耦合。问题提供了最后一条信息：“每个面耦合块在所选的局部基下是代数稠密的。” 这意味着对于 $K$ 上的一个给定自由度，基于面的项会与跨共享面相邻四面体上的*每个*自由度产生非零耦合。假设整个网格上的多项式次数 $p$ 是统一的，那么每个相邻的四面体 $K_j$ 也具有 $N_p$ 个局部自由度。因此，对于 $N_f=4$ 个邻居中的每一个，都有 $N_p$ 个耦合。这为该行额外贡献了 $N_f \\times N_p = 4N_p$ 个非零项。\n\n非零项的总数是来自中心单元 $K$ 及其 $N_f$ 个邻居的贡献之和。\n每行非零项总数 = (来自自身单元的贡献) + (来自相邻单元的贡献)\n每行非零项总数 = $N_p + N_f \\times N_p = (1 + N_f) N_p$。\n\n代入四面体的给定值 $N_f = 4$：\n每行非零项总数 = $(1+4)N_p = 5 N_p$。\n\n最后一步是确定局部自由度数量 $N_p$ 的表达式。这是多项式空间 $\\mathbb{P}_{p}(K)$ 的维度，该空间由四面体 $K$ 上总次数至多为 $p$ 的多项式组成。一个四面体是一个三维单纯形。在 $d$ 维空间中，总次数至多为 $p$ 的多项式空间的维度 $\\dim(\\mathbb{P}_p(\\mathbb{R}^d))$ 由以下公式给出：\n$$ N_p = \\binom{p+d}{d} $$\n对于三维空间中的四面体，我们有 $d=3$。因此，自由度的数量是：\n$$ N_p = \\binom{p+3}{3} $$\n展开这个二项式系数得到：\n$$ N_p = \\frac{(p+3)!}{3!(p+3-3)!} = \\frac{(p+3)!}{3!p!} = \\frac{(p+3)(p+2)(p+1)p!}{6 p!} = \\frac{(p+1)(p+2)(p+3)}{6} $$\n将 $N_p$ 的这个表达式代入我们关于非零项总数的公式中，我们得到最终结果。\n每行非零项总数 = $5 N_p = 5 \\frac{(p+1)(p+2)(p+3)}{6}$。",
            "answer": "$$\n\\boxed{5 \\frac{(p+1)(p+2)(p+3)}{6}}\n$$"
        },
        {
            "introduction": "紧凑模板不仅仅是一个优雅的数学构造，它还带来了显著的计算优势，尤其是在现代计算机架构上。本练习通过一个简化的数据移动模型，让你从计算效率的角度来审视CDG方法 。通过分析和比较紧凑非连续伽辽金（CDG）算子与局部非连续伽辽金（LDG）算子在应用过程中每自由度所需移动的数据字节数，你将量化CDG方法在减少内存访问方面的优势，并理解为何这种方法对于开发高性能科学计算代码至关重要。",
            "id": "3371774",
            "problem": "考虑在均匀网格上，通过非连续Galerkin方法离散化的二阶扩散算子的无矩阵应用。比较了两种算子构造方法：紧凑非连续Galerkin（CDG）扩散算子和标准的局部非连续Galerkin（LDG）扩散算子。假设存在一个标量未知场 $u$，空间维度为 $d$，多项式阶数为 $p$，单元面数为 $F$，并且网格由形状均匀的单元组成。采用以下基本基底：\n- 对于空间维度为 $d$ 的张量积单元，每个单元的自由度数为 $N_{e} = (p+1)^{d}$，每个面迹的自由度数为 $N_{f} = (p+1)^{d-1}$。\n- 对于空间维度为 $d$ 的单纯形单元，每个单元的自由度数为 $N_{e} = \\binom{p+d}{d}$，每个面迹的自由度数为 $N_{f} = \\binom{p+d-1}{d-1}$。\n- LDG算子引入一个具有 $d$ 个分量的辅助向量场 $\\boldsymbol{q}$，在一个典型的两阶段实现中，该向量场在算子应用过程中被写入内存并从内存中读出。CDG算子通过使用紧凑的面提升操作消除了这个辅助场。\n\n使用以下科学上切合实际的假设来建模数据移动：\n- 每个标量自由度在内存中占用 $b$ 字节。\n- 对于每个单元，一次算子应用会读取一次 $u$ 的体自由度，并写入一次 $u$ 的残差。LDG算子还会写入并随后读取具有 $d$ 个分量的辅助场 $\\boldsymbol{q}$。\n- 面耦合需要读取相邻单元的面迹自由度。如果两个相邻单元被连续处理，面迹数据可以在这对单元之间重用。用面缓存重用因子 $\\eta \\in [\\frac{1}{2}, 1]$ 来对此进行建模，其中 $\\eta = \\frac{1}{2}$ 表示在两个相邻单元间的完美摊销，而 $\\eta = 1$ 表示没有重用。\n\n在这些假设下：\n- 在CDG中，面耦合只使用 $u$ 的迹。每个单元读取的总面迹量与 $\\eta \\, F \\, N_{f}$ 成比例。\n- 在LDG中，面耦合使用 $u$ 和 $\\boldsymbol{q}$ 的迹。每个单元读取的总面迹量与 $\\eta \\, F \\, (N_{f} + d \\, N_{f}) = \\eta \\, F \\, (1+d) \\, N_{f}$ 成比例。\n- 每个单元的每个场只计算一次写入。\n\n从这些基础出发，推导CDG和LDG算子每个自由度移动的字节数的闭式表达式，用 $b$, $p$, $F$, $d$ 以及通过 $N_{e}$ 和 $N_{f}$ 体现的单元形状来表示。然后，将你的结果特化到空间维度 $d=3$、在完美面缓存重用 $\\eta = \\frac{1}{2}$ 条件下的张量积单元上的CDG算子，并给出每个自由度移动的最小字节数的单一闭式解析表达式，用 $b$, $p$, 和 $F$ 表示。最终答案以“字节/自由度”为单位表示。不需要数值取整；请提供一个精确表达式。",
            "solution": "该问题要求在指定的数据移动模型下，为两种非连续Galerkin算子——紧凑非连续Galerkin（CDG）和局部非连续Galerkin（LDG）——推导每个自由度的内存流量（移动的字节数）的闭式表达式。然后，必须在特定条件下将最终结果特化于CDG算子。\n\n首先，我们建立一个计算每个自由度移动字节数的通用框架。这个度量，我们记为 $M$，定义为在单个单元上应用一次算子期间移动的总字节数，除以该单元内的自由度数（$N_e$）。\n$$M = \\frac{B_{\\text{total}}}{N_e}$$\n移动的总字节数 $B_{\\text{total}}$ 是从内存读取的字节数和写入内存的字节数之和。\n$$B_{\\text{total}} = B_{\\text{read}} + B_{\\text{write}}$$\n假设每个标量自由度（DOF）占用 $b$ 字节。\n\n我们分别对每个算子进行分析。\n\n**1. 紧凑非连续Galerkin (CDG) 算子**\n\n根据问题陈述，在单个单元上应用一次CDG算子涉及以下数据移动：\n- **体读取**：单元内解场 $u$ 的 $N_e$ 个自由度被读取一次。读取的字节数为 $b \\cdot N_e$。\n- **面读取**：为了与相邻单元耦合，读取 $u$ 的面迹数据。读取的自由度数由 $\\eta \\, F \\, N_f$ 给出，其中 $F$ 是单元上的面数，$\\eta$ 是面缓存重用因子。读取的字节数为 $b \\cdot \\eta \\, F \\, N_f$。\n- **体写入**：计算出的 $u$ 场的残差（具有 $N_e$ 个自由度）被写入一次。写入的字节数为 $b \\cdot N_e$。\n\nCDG算子移动的总字节数 $B_{\\text{total}}^{\\text{CDG}}$ 是这些量的总和：\n$$B_{\\text{total}}^{\\text{CDG}} = (\\text{读取字节数}) + (\\text{写入字节数})$$\n$$B_{\\text{total}}^{\\text{CDG}} = (b N_e + b \\eta F N_f) + (b N_e) = b(2N_e + \\eta F N_f)$$\n因此，CDG每个自由度移动的字节数 $M_{\\text{CDG}}$ 为：\n$$M_{\\text{CDG}} = \\frac{B_{\\text{total}}^{\\text{CDG}}}{N_e} = \\frac{b(2N_e + \\eta F N_f)}{N_e} = b\\left(2 + \\eta F \\frac{N_f}{N_e}\\right)$$\n\n**2. 局部非连续Galerkin (LDG) 算子**\n\nLDG算子引入一个具有 $d$ 个分量的辅助向量场 $\\boldsymbol{q}$。问题陈述指出，算子的实现涉及写入然后读取该场。这意味着一个两阶段的过程。\n- **$u$ 的数据移动**：$u$ 的体自由度（$N_e$）被读取一次，$u$ 的最终残差（$N_e$）被写入一次。\n- **$\\boldsymbol{q}$ 的数据移动**：辅助场 $\\boldsymbol{q}$ 有 $d$ 个分量，因此它对应于 $d \\cdot N_e$ 个体自由度。这些自由度被写入一次并读取一次。\n- **面数据移动**：面耦合需要读取 $u$ 和 $\\boldsymbol{q}$ 的迹。读取的总面自由度数由 $\\eta \\, F \\, (N_f + d N_f) = \\eta \\, F \\, (1+d) N_f$ 给出。\n\n将这些贡献相加：\n- **总读取**：读取体 $u$ ($bN_e$)、体 $\\boldsymbol{q}$ ($b d N_e$)以及两者的面迹 ($b \\eta F (1+d) N_f$)。\n$$B_{\\text{read}}^{\\text{LDG}} = bN_e + b d N_e + b \\eta F (1+d) N_f = b(1+d)N_e + b\\eta F(1+d)N_f$$\n- **总写入**：写入体 $\\boldsymbol{q}$ ($b d N_e$)和 $u$ 的残差 ($bN_e$)。\n$$B_{\\text{write}}^{\\text{LDG}} = b d N_e + bN_e = b(1+d)N_e$$\nLDG算子移动的总字节数 $B_{\\text{total}}^{\\text{LDG}}$ 是：\n$$B_{\\text{total}}^{\\text{LDG}} = B_{\\text{read}}^{\\text{LDG}} + B_{\\text{write}}^{\\text{LDG}} = \\left( b(1+d)N_e + b\\eta F(1+d)N_f \\right) + b(1+d)N_e$$\n$$B_{\\text{total}}^{\\text{LDG}} = 2b(1+d)N_e + b\\eta F(1+d)N_f = b(1+d)(2N_e + \\eta F N_f)$$\nLDG每个自由度移动的字节数 $M_{\\text{LDG}}$（按主场自由度 $N_e$ 归一化）是：\n$$M_{\\text{LDG}} = \\frac{B_{\\text{total}}^{\\text{LDG}}}{N_e} = \\frac{b(1+d)(2N_e + \\eta F N_f)}{N_e} = b(1+d)\\left(2 + \\eta F \\frac{N_f}{N_e}\\right)$$\n\n**3. CDG 结果的特化**\n\n问题要求将CDG结果特化为空间维度 $d=3$、具有完美面缓存重用（$\\eta = \\frac{1}{2}$）的张量积单元。\n\n首先，我们确定张量积单元的比率 $\\frac{N_f}{N_e}$。使用所提供的定义：\n- $N_{e} = (p+1)^{d}$\n- $N_{f} = (p+1)^{d-1}$\n该比率为：\n$$\\frac{N_f}{N_e} = \\frac{(p+1)^{d-1}}{(p+1)^{d}} = \\frac{1}{p+1}$$\n该比率与空间维度 $d$ 无关。\n\n现在，我们将这个比率和值 $\\eta = \\frac{1}{2}$ 代入 $M_{\\text{CDG}}$ 的通用表达式中：\n$$M_{\\text{CDG}} = b\\left(2 + \\eta F \\frac{N_f}{N_e}\\right)$$\n$$M_{\\text{CDG, specialized}} = b\\left(2 + \\left(\\frac{1}{2}\\right) F \\left(\\frac{1}{p+1}\\right)\\right)$$\n简化表达式得到：\n$$M_{\\text{CDG, specialized}} = b\\left(2 + \\frac{F}{2(p+1)}\\right)$$\n该表达式表示在指定条件下，CDG算子每个自由度移动的最小字节数。它以 $b$, $p$ 和 $F$ 的闭式解析表达式形式给出，符合问题陈述的要求。对于张量积单元，$d=3$ 的条件意味着六面体单元形状，此时 $F=6$，但问题明确要求答案用 $F$ 表示。",
            "answer": "$$\\boxed{b \\left(2 + \\frac{F}{2(p+1)}\\right)}$$"
        }
    ]
}