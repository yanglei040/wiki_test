{
    "hands_on_practices": [
        {
            "introduction": "在处理非协调谱元时，一个核心问题源于相邻单元间多项式次数的差异。这个练习  引导我们直面这一挑战，通过计算因多项式次数跳跃（$p$-jump）而必须施加的约束数量，从而量化自由度的不匹配。理解这一点是掌握砂浆耦合策略的基础。",
            "id": "3403322",
            "problem": "考虑二维空间中两个四边形谱元之间的一个不整合界面。沿共享边的几何映射是仿射的，因此多项式迹是同构映射。左侧（密）元在每个坐标方向上使用多项式阶数为 $p_{f}$ 的分层模态谱基，右侧（疏）元在每个坐标方向上使用多项式阶数为 $p_{c}$ 的分层模态谱基，且 $p_{f} > p_{c}$。沿着它们的公共直边，迹空间分别是参考区间 $[-1,1]$ 上的一维多项式空间 $P_{p_{f}}$ 和 $P_{p_{c}}$。假设边上的分层基的构造使得 $P_{p_{c}} \\subset P_{p_{f}}$ 成立（作为子空间），并且边的自由度恰好是这些分层边基的系数。\n\n跨不整合界面的连续性通过一种经典的砂浆法强制施加，其中疏边为主边，密边为从边：对密边的迹施加弱约束，使其在 $P_{p_{c}}$ 上的投影与疏边的迹相匹配，而任何与 $P_{p_{c}}$ 正交的密边迹分量都必须通过独立的代数约束来消除。两个共享顶点的端点连续性通过网格连接性被强施加，不应单独计算。\n\n仅使用迹空间、多项式阶数和分层子空间嵌套的核心定义，确定当 $p_{f} = 6$ 和 $p_{c} = 3$ 时，仅因 $p$ 阶跳跃而必须施加在密边自由度上的独立代数约束的数量。您的最终答案必须是一个整数，无需四舍五入。",
            "solution": "该问题要求在一种特定的砂浆式耦合策略下，由于多项式阶数的跳跃而施加在密边自由度上的独立代数约束的数量。\n\n单元边上的自由度（DOFs）由该边上多项式迹空间的维度给出。在一维中，次数最多为 $p$ 的多项式空间（记为 $P_p$）的维度为 $p+1$。\n\n对于界面的密边，迹空间是 $P_{p_f}$。这一侧的自由度数量 $N_f$ 是该空间的维度：\n$$N_f = \\dim(P_{p_f}) = p_f + 1$$\n\n对于界面的疏边，迹空间是 $P_{p_c}$。这一侧的自由度数量 $N_c$ 是该空间的维度：\n$$N_c = \\dim(P_{p_c}) = p_c + 1$$\n\n问题指出基是分层的，这确保了疏边上的多项式空间是密边上多项式空间的一个真子空间，因为 $p_f > p_c$。这表示为 $P_{p_c} \\subset P_{p_f}$。\n\n连续性的施加分两部分描述：\n1.  对密边上的迹（$u_f \\in P_{p_f}$）施加约束，使其在疏空间 $P_{p_c}$ 上的投影与疏边上的迹（$u_c \\in P_{p_c}$）相匹配。这是砂浆法的耦合部分。它有效地将密边上等于 $P_{p_c}$ 维度的自由度数量与疏边上相应的自由度联系起来。此类耦合条件的数量为 $\\dim(P_{p_c}) = p_c + 1$。\n\n2.  任何与 $P_{p_c}$ 正交的密边迹分量都必须被消除。这指的是解 $u_f$ 中位于 $P_{p_f}$ 内 $P_{p_c}$ 的补空间中的部分。我们将此补空间表示为 $P_{p_f} \\setminus P_{p_c}$。该补空间的维度是两个空间维度的差：\n$$\\dim(P_{p_f} \\setminus P_{p_c}) = \\dim(P_{p_f}) - \\dim(P_{p_c}) = N_f - N_c$$\n代入维度的表达式：\n$$\\dim(P_{p_f} \\setminus P_{p_c}) = (p_f + 1) - (p_c + 1) = p_f - p_c$$\n“消除”解在该空间中的分量意味着将其约束为零。这需要施加数量等于该空间维度的独立代数约束。这些是仅应用于密边自由度的约束，以处理在疏边上没有对应项的高阶模式。\n\n问题明确要求这些“消除”约束的数量，这些约束“仅仅由于 $p$ 阶跳跃”而产生。关于顶点连续性强施加的说明证实了我们应该关注多项式函数空间本身的不匹配，而不是边的共享端点。我们基于完整多项式空间维度 $\\dim(P_{p_f}) - \\dim(P_{p_c})$ 的计算，正确地分离了多项式阶数不匹配的影响。\n\n因此，所需的独立代数约束的数量是 $p_f - p_c$。\n\n给定具体值 $p_f = 6$ 和 $p_c = 3$，我们可以计算约束的数量：\n$$\\text{约束数量} = p_f - p_c = 6 - 3 = 3$$\n这 $3$ 个约束强制将密边上 $4$ 阶、$5$ 阶和 $6$ 阶的分层基函数的系数设为零。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "理解了需要施加约束后，下一个问题便是砂浆法如何具体实现耦合。该方法的核心是一种基于积分的弱形式投影，即 $L^2$ 投影。此练习  将这个抽象的数学概念变得具体可感，要求您通过显式计算来验证该投影如何精确地传递低阶多项式，并量化其对高阶多项式的逼近误差。",
            "id": "3403327",
            "problem": "考虑一个一维非协调界面（砂浆），它位于一个粗父边和两个细子边之间。令父界面为 $\\Gamma=[-1,1]$，两个子界面为 $\\Gamma_{L}=[-1,0]$ 和 $\\Gamma_{R}=[0,1]$。令父迹空间为 $\\Gamma$ 上所有次数至多为 $3$ 的实多项式构成的多项式空间 $\\mathbb{P}_{3}(\\Gamma)$，并令每个子迹为 $\\mathbb{P}_{3}([-1,1])$ 中的一个多项式在 $\\Gamma_{L}$ 或 $\\Gamma_{R}$ 上的限制。通过变分条件定义典范砂浆投影 $\\Pi_{M}:\\left.\\mathbb{P}_{3}([-1,1])\\right|_{\\Gamma_{L}\\cup\\Gamma_{R}}\\to \\mathbb{P}_{3}(\\Gamma)$\n$$\n\\int_{-1}^{1} (\\Pi_{M} u)(s)\\, v(s)\\, \\mathrm{d}s \\;=\\; \\int_{-1}^{0} u(s)\\, v(s)\\, \\mathrm{d}s \\;+\\; \\int_{0}^{1} u(s)\\, v(s)\\, \\mathrm{d}s\\quad \\text{对所有 } v\\in \\mathbb{P}_{3}(\\Gamma) \\text{ 成立}。\n$$\n假设所有积分都精确计算。\n\n从 $L^{2}$ 内积的定义和 $[-1,1]$ 上正交多项式的基本性质出发，完成以下任务：\n\n- 通过上述变分定义和多项式正交性的明确推理，证明如果 $u\\in \\mathbb{P}_{3}([-1,1])$，则对所有 $s\\in [-1,1]$ 都有 $(\\Pi_{M}u)(s)=u(s)$；也就是说，次数至多为 $3$ 的多项式能精确地通过砂浆。\n\n- 接下来，取 $u(s)=s^{4}$ 并计算 $\\Gamma$ 上的砂浆投影误差 $e(s):=u(s)-(\\Pi_{M}u)(s)$。将 $e(s)$ 表示为关于 $s$ 的单个闭式解析表达式。\n\n你的最终答案应该是 $e(s)$ 作为 $s$ 的函数的简化表达式。不需要四舍五入。",
            "solution": "### 解答\n解答分为两部分，对应于问题陈述中指定的两个任务。\n\n**第 1 部分：砂浆投影对 $u \\in \\mathbb{P}_{3}(\\Gamma)$ 的精确性**\n\n砂浆投影 $\\Pi_{M}$ 的变分定义由下式给出：\n$$\n\\int_{-1}^{1} (\\Pi_{M} u)(s)\\, v(s)\\, \\mathrm{d}s \\;=\\; \\int_{-1}^{0} u(s)\\, v(s)\\, \\mathrm{d}s \\;+\\; \\int_{0}^{1} u(s)\\, v(s)\\, \\mathrm{d}s\n$$\n对所有测试函数 $v \\in \\mathbb{P}_{3}(\\Gamma)$ 成立。\n\n根据定积分的可加性，右侧可以合并为父域 $\\Gamma = [-1, 1]$ 上的单个积分：\n$$\n\\int_{-1}^{0} u(s)\\, v(s)\\, \\mathrm{d}s \\;+\\; \\int_{0}^{1} u(s)\\, v(s)\\, \\mathrm{d}s = \\int_{-1}^{1} u(s)\\, v(s)\\, \\mathrm{d}s\n$$\n因此，变分定义简化为：\n$$\n\\int_{-1}^{1} (\\Pi_{M} u)(s)\\, v(s)\\, \\mathrm{d}s = \\int_{-1}^{1} u(s)\\, v(s)\\, \\mathrm{d}s \\quad \\text{对所有 } v\\in \\mathbb{P}_{3}(\\Gamma) \\text{ 成立}。\n$$\n这可以通过将所有项移到一边来重写：\n$$\n\\int_{-1}^{1} \\left( u(s) - (\\Pi_{M} u)(s) \\right) v(s)\\, \\mathrm{d}s = 0 \\quad \\text{对所有 } v\\in \\mathbb{P}_{3}(\\Gamma) \\text{ 成立}。\n$$\n该方程表明函数 $u(s) - (\\Pi_{M} u)(s)$与空间 $\\mathbb{P}_{3}(\\Gamma)$ 中的每个函数都是 $L^2$-正交的。注意，根据算子陪域的定义，$\\Pi_M u$ 本身就是 $\\mathbb{P}_3(\\Gamma)$ 的一个元素。\n\n现在，考虑输入函数 $u$ 本身就是 $\\mathbb{P}_{3}(\\Gamma)$ 中的一个多项式的情况。在这种情况下，差值，我们称之为 $w(s) = u(s) - (\\Pi_{M} u)(s)$，也是一个次数至多为 $3$ 的多项式，即 $w \\in \\mathbb{P}_{3}(\\Gamma)$。\n\n正交性条件表明，对于所有 $v \\in \\mathbb{P}_{3}(\\Gamma)$，都有 $\\int_{-1}^{1} w(s) v(s) \\mathrm{d}s = 0$。由于 $w(s)$ 本身就是 $\\mathbb{P}_{3}(\\Gamma)$ 的一个元素，我们可以自由选择 $v(s) = w(s)$。代入这个选择可得：\n$$\n\\int_{-1}^{1} (w(s))^2\\, \\mathrm{d}s = 0.\n$$\n被积函数 $(w(s))^2$ 在区间 $[-1, 1]$ 上是一个非负连续函数（因为 $w(s)$ 是一个多项式）。这样一个函数的积分只有在该函数本身在积分区间上处处为零时才可能为零。\n因此，我们必须有对所有 $s \\in [-1, 1]$，$(w(s))^2 = 0$，这意味着对所有 $s \\in [-1, 1]$，$w(s) = 0$。\n\n回顾 $w(s)$ 的定义，这意味着：\n$$\nu(s) - (\\Pi_{M} u)(s) = 0 \\quad \\implies \\quad (\\Pi_{M} u)(s) = u(s) \\quad \\text{对所有 } s \\in [-1, 1] \\text{ 成立}。\n$$\n这证明了对于任何次数至多为 $3$ 的多项式 $u$，砂浆投影是恒等算子，意味着这样的多项式被精确传递。这是 $L^2$-投影的一个基本性质：如果一个函数已经位于目标空间中，它的投影就是该函数本身。\n\n**第 2 部分：计算 $u(s) = s^4$ 的投影误差**\n\n我们被要求计算 $u(s)=s^4$ 的投影误差 $e(s) = u(s) - (\\Pi_{M}u)(s)$。\n从第 1 部分可知，$(\\Pi_M u)(s)$ 是 $u(s)$ 到空间 $\\mathbb{P}_3(\\Gamma)$ 上的 $L^2$-投影。令 $p(s) = (\\Pi_M u)(s) \\in \\mathbb{P}_3(\\Gamma)$。误差 $e(s) = u(s) - p(s) = s^4 - p(s)$ 必须与整个空间 $\\mathbb{P}_3(\\Gamma)$ $L^2$-正交。\n\n为了找到这个投影和误差，我们利用勒让德多项式基 $\\{L_k(s)\\}_{k=0}^\\infty$，它们在区间 $[-1, 1]$ 上关于 $L^2$ 内积是正交的：$\\int_{-1}^1 L_j(s) L_k(s) \\mathrm{d}s = \\frac{2}{2k+1}\\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克 δ。\n\n函数 $u(s)$ 到 $\\mathbb{P}_N(\\Gamma)$ 上的投影 $p(s)$ 是其勒让德级数展开在 $N$ 次的截断。这里，$N=3$。我们将 $u(s)=s^4$ 在勒让德基中展开：\n$$\nu(s) = \\sum_{k=0}^{4} c_k L_k(s), \\quad \\text{其中} \\quad c_k = \\frac{\\langle u, L_k \\rangle}{\\langle L_k, L_k \\rangle} = \\frac{2k+1}{2} \\int_{-1}^1 u(s) L_k(s) \\mathrm{d}s.\n$$\n到 $\\mathbb{P}_3(\\Gamma)$ 上的投影则为 $p(s) = \\sum_{k=0}^{3} c_k L_k(s)$，误差为 $e(s) = u(s) - p(s) = c_4 L_4(s)$。\n\n前几个勒让德多项式是：\n$L_0(s) = 1$\n$L_1(s) = s$\n$L_2(s) = \\frac{1}{2}(3s^2-1)$\n$L_3(s) = \\frac{1}{2}(5s^3-3s)$\n$L_4(s) = \\frac{1}{8}(35s^4 - 30s^2 + 3)$\n\n我们可以通过代数运算找到 $s^4$ 的展开式。根据 $L_4(s)$ 的定义：\n$8 L_4(s) = 35s^4 - 30s^2 + 3$\n$35s^4 = 8L_4(s) + 30s^2 - 3$\n$s^4 = \\frac{8}{35}L_4(s) + \\frac{30}{35}s^2 - \\frac{3}{35} = \\frac{8}{35}L_4(s) + \\frac{6}{7}s^2 - \\frac{3}{35}$\n\n接下来，我们用 $L_2(s)$ 和 $L_0(s)$ 来表示 $s^2$：\n$L_2(s) = \\frac{3}{2}s^2 - \\frac{1}{2} \\implies 3s^2 = 2L_2(s) + 1 \\implies s^2 = \\frac{2}{3}L_2(s) + \\frac{1}{3}L_0(s)$。\n\n将此代入 $s^4$ 的表达式中：\n$s^4 = \\frac{8}{35}L_4(s) + \\frac{6}{7}\\left(\\frac{2}{3}L_2(s) + \\frac{1}{3}L_0(s)\\right) - \\frac{3}{35}L_0(s)$\n$s^4 = \\frac{8}{35}L_4(s) + \\frac{4}{7}L_2(s) + \\frac{2}{7}L_0(s) - \\frac{3}{35}L_0(s)$\n$s^4 = \\frac{8}{35}L_4(s) + \\frac{4}{7}L_2(s) + \\left(\\frac{10}{35} - \\frac{3}{35}\\right)L_0(s)$\n$s^4 = \\frac{8}{35}L_4(s) + \\frac{4}{7}L_2(s) + \\frac{1}{5}L_0(s)$\n\n函数 $u(s) = s^4$ 是一个偶函数，因此其展开式只包含偶数索引的勒让德多项式，这与我们的结果一致。到 $\\mathbb{P}_3(\\Gamma)$ 上的投影是次数小于或等于 $3$ 的项的和：\n$$\np(s) = (\\Pi_M u)(s) = \\frac{1}{5}L_0(s) + \\frac{4}{7}L_2(s)\n$$\n投影误差 $e(s)$ 是展开式的剩余部分：\n$$\ne(s) = u(s) - p(s) = \\frac{8}{35}L_4(s)\n$$\n为了得到关于 $s$ 的 $e(s)$ 的最终表达式，我们代入 $L_4(s)$ 的定义：\n$$\ne(s) = \\frac{8}{35} \\left( \\frac{1}{8}(35s^4 - 30s^2 + 3) \\right)\n$$\n$$\ne(s) = \\frac{1}{35} (35s^4 - 30s^2 + 3)\n$$\n$$\ne(s) = s^4 - \\frac{30}{35}s^2 + \\frac{3}{35}\n$$\n简化分数得到误差的最终解析表达式：\n$$\ne(s) = s^4 - \\frac{6}{7}s^2 + \\frac{3}{35}\n$$\n这就是所要求的砂浆投影误差的闭式表达式。",
            "answer": "$$\\boxed{s^4 - \\frac{6}{7}s^2 + \\frac{3}{35}}$$"
        },
        {
            "introduction": "理论上的 $L^2$ 投影需要精确计算积分，但在实际的谱元程序中，这些积分几乎总是通过数值求积（如高斯求积）来近似计算。这种近似可能引入被称为“变分犯罪”的误差，威胁到方法的稳定性。此练习  探讨了这一关键的实现细节，要求您推导为确保积分精确性所需的最小求积阶数，从而保证砂浆耦合的数学严谨性。",
            "id": "3403345",
            "problem": "考虑两个相邻单元之间一维界面 $\\Gamma$ 的非协调谱元离散化，其中，左迹场由次数为 $p$ 的多项式表示，右迹场由次数为 $q$ 的多项式表示。界面耦合通过沿 $\\Gamma$ 的 $L^{2}$ 内积定义的砂浆投影来强制施加。假设该界面通过仿射映射到参考区间 $[-1,1]$ 上，从而多项式次数在该映射下保持不变。砂浆上的内积使用在 $[-1,1]$ 上具有 $n$ 个点和单位权重的 Gauss–Lobatto–Legendre 求积法则进行计算。仅利用多项式次数、多项式乘积的基本定义，以及经过充分检验的高斯型求积法则的精确性性质，推导为精确积分次数至多为 $p$ 和 $q$ 的任意界面多项式乘积所需的最小求积点数 $n_{\\min}$。然后，说明如果使用低于 $n_{\\min}$ 的求积阶数，对砂浆投影造成的主要后果。你的最终答案必须是仅包含 $n_{\\min}$ 的单一闭式表达式，不带单位。",
            "solution": "该问题要求推导 Gauss–Lobatto–Legendre (GLL) 法则所需的最小求积点数 $n_{\\min}$，以便精确积分两个非协调谱元之间砂浆投影所需的内积。\n\n首先，让我们将需要计算的积分形式化。砂浆耦合由界面 $\\Gamma$ 上的 $L^2$ 内积定义。问题指出，界面左右两侧的迹空间分别由次数至多为 $p$ 和 $q$ 的多项式组成。设 $\\phi_p$ 是来自左迹空间的任意多项式，其次数至多为 $p$，设 $\\psi_q$ 是来自右迹空间的任意多项式，其次数至多为 $q$。它们之间的 $L^2$ 内积由下式给出：\n$$ (\\phi_p, \\psi_q)_{L^2(\\Gamma)} = \\int_{\\Gamma} \\phi_p \\psi_q \\, d\\Gamma $$\n问题指出，界面 $\\Gamma$ 通过仿射映射到参考区间 $[-1, 1]$ 上。仿射映射 $x(\\xi) = a\\xi + b$ 具有一个常数雅可比行列式，$J = \\frac{dx}{d\\xi} = a$。在参考区间上的积分变为：\n$$ \\int_{-1}^{1} \\phi_p(x(\\xi)) \\psi_q(x(\\xi)) J \\, d\\xi $$\n由于多项式次数在仿射映射下保持不变，$\\phi_p(x(\\xi))$ 是一个关于 $\\xi$ 的次数至多为 $p$ 的多项式，而 $\\psi_q(x(\\xi))$ 是一个关于 $\\xi$ 的次数至多为 $q$ 的多项式。被积函数是这两个多项式与常数雅可比 $J$ 的乘积。让我们将被积函数表示为 $F(\\xi)$：\n$$ F(\\xi) = J \\cdot \\phi_p(x(\\xi)) \\cdot \\psi_q(x(\\xi)) $$\n多项式乘积的次数是它们各自次数的和。为了确保对*所有*可能的乘积都能精确积分，我们必须考虑被积函数的最高可能次数。当 $\\phi_p$ 的次数恰好为 $p$ 且 $\\psi_q$ 的次数恰好为 $q$ 时，乘积 $\\phi_p \\cdot \\psi_q$ 的次数达到最大值。\n$$ \\text{degree}(F(\\xi))_{\\max} = \\text{degree}(\\phi_p)_{\\max} + \\text{degree}(\\psi_q)_{\\max} = p + q $$\n该积分使用 $n$ 点 Gauss–Lobatto–Legendre (GLL) 求积法则进行数值计算。一个在区间 $[-1, 1]$ 上具有单位权函数的 $n$ 点 GLL 求积法则的基本性质是，它可以精确积分次数高达 $2n - 3$ 的任意多项式。\n\n为了使求积法则能精确计算内积，被积函数的次数必须小于或等于该法则的精度阶。因此，对于要求最高的情况（即最高次多项式），我们必须满足以下条件：\n$$ p + q \\le 2n - 3 $$\n问题要求满足此条件的最小求积点数 $n_{\\min}$。我们必须重新整理该不等式以求解 $n$：\n$$ 2n \\ge p + q + 3 $$\n$$ n \\ge \\frac{p + q + 3}{2} $$\n由于求积点数 $n$ 必须是整数，最小点数 $n_{\\min}$ 是大于或等于 $\\frac{p + q + 3}{2}$ 的最小整数。这正是向上取整函数的定义。\n$$ n_{\\min} = \\left\\lceil \\frac{p + q + 3}{2} \\right\\rceil $$\n该表达式给出了所需的最小 GLL 点数，以确保由 $L^2$ 投影产生的砂浆质量矩阵在组装时没有任何求积误差。\n\n问题的第二部分询问使用低于 $n_{\\min}$ 的求积阶数（即 $n  n_{\\min}$）的主要后果。如果求积点数 $n$ 小于此最小要求，则不等式 $p + q \\le 2n - 3$ 不能保证成立。具体来说，如果 $p+q > 2n-3$，则对于某些界面多项式的乘积，GLL 求积将无法得出积分的精确值。在弱形式的计算中引入这种求积误差是一种*变分犯罪*。\n\n这种变分犯罪的主要后果是数值格式的**一致性丧失**。离散方程组不再对应于连续问题的精确 Galerkin 投影。这种不一致性可能导致次优的收敛率。更为关键的是，对于许多问题，特别是混合格式和接触力学中常见的鞍点问题，这种一致性的丧失可能导致**稳定性丧失**。离散稳定性条件（如 inf-sup 或 LBB 条件）通常是在精确积分的假设下被证明的。违反这一假设会破坏离散算子的谱性质，可能导致奇异或病态的系统矩阵，以及解中出现虚假的、非物理的振荡。因此，未能满足求积要求会损害整个数值方法的基本稳定性和可靠性。",
            "answer": "$$\\boxed{\\left\\lceil \\frac{p + q + 3}{2} \\right\\rceil}$$"
        }
    ]
}