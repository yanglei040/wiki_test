{
    "hands_on_practices": [
        {
            "introduction": "Understanding the algebraic structure of discrete function spaces is the first step toward building structure-preserving methods. This analytical exercise challenges you to explore a segment of the de Rham complex for spectral elements by deriving the dimension of the kernel of the discrete curl operator . Successfully completing this task requires applying the rank-nullity theorem and grasping the concept of an exact sequence, providing a firm theoretical foundation for the practices that follow.",
            "id": "3380442",
            "problem": "Consider the reference square $\\hat{K} = [-1,1]^{2}$ and the tensor-product polynomial spaces that underpin spectral element subcomplexes in two dimensions. For a fixed polynomial degree $p \\in \\mathbb{N}$ with $p \\geq 1$, define the scalar polynomial space $\\hat{V}^{0}_{p}$ and the vector polynomial space $\\hat{V}^{1}_{p}$ by\n$$\n\\hat{V}^{0}_{p} := \\mathcal{Q}_{p,p}, \\qquad \\hat{V}^{1}_{p} := \\mathcal{Q}_{p-1,p} \\times \\mathcal{Q}_{p,p-1},\n$$\nwhere $\\mathcal{Q}_{a,b}$ denotes the set of all polynomials on $\\hat{K}$ that are of degree at most $a$ in the $x$-variable and at most $b$ in the $y$-variable. Let the discrete differential operators be\n$$\nd^{0} := \\nabla : \\hat{V}^{0}_{p} \\to \\hat{V}^{1}_{p}, \\qquad d^{1} : \\hat{V}^{1}_{p} \\to \\hat{V}^{2}_{p}, \\quad d^{1}\\boldsymbol{v} := \\partial_{x} v_{2} - \\partial_{y} v_{1},\n$$\nmapping into the scalar space $\\hat{V}^{2}_{p} := \\mathcal{Q}_{p-1,p-1}$. Assume that $\\hat{K}$ is simply connected and that the standard spectral element projections induce a discrete de Rham complex with commuting diagram, so $\\nabla \\hat{V}^{0}_{p} \\subset \\hat{V}^{1}_{p}$ and $d^{1} \\circ \\nabla = 0$.\n\nStarting only from the definitions of the tensor-product spaces, the operators $d^{0}$ and $d^{1}$ above, and the fact that on simply connected domains curl-free fields are gradients, derive a closed-form analytic expression for the dimension of the kernel of $d^{1}$ restricted to $\\hat{V}^{1}_{p}$, namely\n$$\n\\dim\\left(\\ker\\left(d^{1}\\big|\\hat{V}^{1}_{p}\\right)\\right).\n$$\nExpress your final answer as a function of $p$ and provide it in exact form. No rounding is needed and no physical units are involved.",
            "solution": "The problem is valid. It is a well-posed mathematical problem in the field of numerical analysis and finite element methods, specifically concerning the properties of discrete de Rham complexes on tensor-product polynomial spaces. All terms are clearly defined, and the premises are scientifically and mathematically sound.\n\nThe objective is to compute the dimension of the kernel of the discrete differential operator $d^{1}$, denoted $\\dim(\\ker(d^{1}))$. The operator $d^{1}$ acts on the vector polynomial space $\\hat{V}^{1}_{p} = \\mathcal{Q}_{p-1,p} \\times \\mathcal{Q}_{p,p-1}$ and is defined as $d^{1}\\boldsymbol{v} := \\partial_{x} v_{2} - \\partial_{y} v_{1}$ for a vector field $\\boldsymbol{v} = (v_1, v_2)$.\n\nThe problem provides a sequence of spaces and operators which form a segment of a discrete de Rham complex:\n$$ \\hat{V}^{0}_{p} \\xrightarrow{d^{0}} \\hat{V}^{1}_{p} \\xrightarrow{d^{1}} \\hat{V}^{2}_{p} $$\nwhere $d^{0} = \\nabla$. The property $d^{1} \\circ d^{0} = 0$ is given, which implies that the image of $d^{0}$ is a subspace of the kernel of $d^{1}$, i.e., $\\text{Im}(d^{0}) \\subseteq \\ker(d^{1})$.\n\nThe problem leverages the fact that on a simply connected domain like the reference square $\\hat{K} = [-1,1]^{2}$, a curl-free vector field is always the gradient of a scalar potential. We will demonstrate that this property holds true exactly for the specified discrete polynomial spaces, meaning the sequence is exact at $\\hat{V}^{1}_{p}$. This establishes the equality $\\text{Im}(d^{0}) = \\ker(d^{1})$.\n\nLet us prove this exactness.\nFirst, we confirm $\\text{Im}(d^{0}) \\subseteq \\ker(d^{1})$. Let $\\phi \\in \\hat{V}^{0}_{p}$. Then $d^{0}\\phi = \\nabla\\phi = (\\partial_{x}\\phi, \\partial_{y}\\phi)$. Applying $d^{1}$ to this vector field gives\n$$ d^{1}(d^{0}\\phi) = \\partial_{x}(\\partial_{y}\\phi) - \\partial_{y}(\\partial_{x}\\phi) = \\frac{\\partial^2 \\phi}{\\partial x \\partial y} - \\frac{\\partial^2 \\phi}{\\partial y \\partial x} $$\nSince $\\phi$ is a polynomial, it is infinitely differentiable, and by Clairaut's theorem on the equality of mixed partials, this expression is identically zero. Thus, any element in the image of $d^{0}$ is in the kernel of $d^{1}$.\n\nNext, we prove the reverse inclusion, $\\ker(d^{1}) \\subseteq \\text{Im}(d^{0})$. Let $\\boldsymbol{v} = (v_{1}, v_{2})$ be an arbitrary element in $\\ker(d^{1})$. By definition, $\\boldsymbol{v} \\in \\hat{V}^{1}_{p}$ and $d^{1}\\boldsymbol{v} = 0$. The condition $d^{1}\\boldsymbol{v} = \\partial_{x}v_{2} - \\partial_{y}v_{1} = 0$ means that $\\boldsymbol{v}$ is a curl-free vector field. Since the domain $\\hat{K}$ is simply connected, there exists a scalar potential $\\phi$ such that $\\boldsymbol{v} = \\nabla\\phi$. We must show that if $\\boldsymbol{v} \\in \\hat{V}^{1}_{p}$, this potential $\\phi$ can be chosen to be in $\\hat{V}^{0}_{p}$.\n\nThe components of $\\boldsymbol{v}$ are $v_1 \\in \\mathcal{Q}_{p-1,p}$ and $v_2 \\in \\mathcal{Q}_{p,p-1}$. We can construct the potential $\\phi$ explicitly, for instance, via integration:\n$$ \\phi(x,y) = \\int_{-1}^{x} v_{1}(\\xi, y) \\,d\\xi + \\int_{-1}^{y} v_{2}(-1, \\eta) \\,d\\eta $$\nLet's verify that $\\nabla\\phi = \\boldsymbol{v}$. Differentiating with respect to $x$:\n$$ \\partial_{x}\\phi(x,y) = v_{1}(x,y) $$\nDifferentiating with respect to $y$:\n$$ \\partial_{y}\\phi(x,y) = \\int_{-1}^{x} \\partial_{y}v_{1}(\\xi, y) \\,d\\xi + v_{2}(-1, y) $$\nSince $\\boldsymbol{v}$ is curl-free, we have $\\partial_{y}v_{1} = \\partial_{x}v_{2}$. Substituting this into the expression for $\\partial_{y}\\phi$:\n$$ \\partial_{y}\\phi(x,y) = \\int_{-1}^{x} \\partial_{\\xi}v_{2}(\\xi, y) \\,d\\xi + v_{2}(-1, y) = \\left[v_{2}(\\xi, y)\\right]_{\\xi=-1}^{x} + v_{2}(-1, y) $$\n$$ \\partial_{y}\\phi(x,y) = (v_{2}(x, y) - v_{2}(-1, y)) + v_{2}(-1, y) = v_{2}(x,y) $$\nThus, we have constructed a potential $\\phi$ such that $\\nabla\\phi = \\boldsymbol{v}$. Now we check if $\\phi \\in \\hat{V}^{0}_{p} = \\mathcal{Q}_{p,p}$.\n1. Since $v_{1}(\\xi, y) \\in \\mathcal{Q}_{p-1,p}$, its integral with respect to $\\xi$ results in a polynomial of degree at most $p$ in $x$ and at most $p$ in $y$. So, $\\int_{-1}^{x} v_{1}(\\xi, y) \\,d\\xi \\in \\mathcal{Q}_{p,p}$.\n2. Since $v_{2}(-1, \\eta) \\in \\mathcal{Q}_{p,p-1}$, evaluating at $x=-1$ gives a polynomial in $\\eta$ of degree at most $p-1$. Its integral with respect to $\\eta$ is a polynomial in $y$ of degree at most $p$, which is independent of $x$. This polynomial belongs to $\\mathcal{Q}_{0,p}$, which is a subspace of $\\mathcal{Q}_{p,p}$.\nThe sum of two polynomials in $\\mathcal{Q}_{p,p}$ is also in $\\mathcal{Q}_{p,p}$. Therefore, $\\phi \\in \\mathcal{Q}_{p,p} = \\hat{V}^{0}_{p}$. This shows that any element $\\boldsymbol{v} \\in \\ker(d^{1})$ can be written as $d^{0}\\phi$ for some $\\phi \\in \\hat{V}^{0}_{p}$. This means $\\ker(d^{1}) \\subseteq \\text{Im}(d^{0})$.\n\nHaving established both inclusions, we conclude that $\\ker(d^{1}) = \\text{Im}(d^{0})$. Consequently, their dimensions are equal:\n$$ \\dim(\\ker(d^{1})) = \\dim(\\text{Im}(d^{0})) $$\nTo find $\\dim(\\text{Im}(d^{0}))$, we apply the rank-nullity theorem to the linear map $d^{0} : \\hat{V}^{0}_{p} \\to \\hat{V}^{1}_{p}$:\n$$ \\dim(\\hat{V}^{0}_{p}) = \\dim(\\ker(d^{0})) + \\dim(\\text{Im}(d^{0})) $$\nRearranging gives:\n$$ \\dim(\\text{Im}(d^{0})) = \\dim(\\hat{V}^{0}_{p}) - \\dim(\\ker(d^{0})) $$\nWe need to compute the dimensions of the space $\\hat{V}^{0}_{p}$ and the kernel of $d^{0}$.\nThe space $\\hat{V}^{0}_{p}$ is defined as $\\mathcal{Q}_{p,p}$, the space of polynomials of degree at most $p$ in $x$ and at most $p$ in $y$. A basis is given by the monomials $\\{x^i y^j\\}_{0 \\le i \\le p, 0 \\le j \\le p}$. The number of basis elements is $(p+1)(p+1) = (p+1)^{2}$. So, $\\dim(\\hat{V}^{0}_{p}) = (p+1)^{2}$.\n\nThe kernel of $d^{0} = \\nabla$ consists of all polynomials $\\phi \\in \\hat{V}^{0}_{p}$ such that $\\nabla\\phi = (\\partial_{x}\\phi, \\partial_{y}\\phi) = (0,0)$. A polynomial has zero partial derivatives with respect to all its variables if and only if it is a constant. The space of constant polynomials is spanned by the single polynomial $1$. Since $p \\geq 1$, the constant function $1$ is an element of $\\mathcal{Q}_{p,p}$. Thus, $\\ker(d^{0})$ is the one-dimensional space of constant functions.\n$$ \\dim(\\ker(d^{0})) = 1 $$\nSubstituting these dimensions into our expression:\n$$ \\dim(\\ker(d^{1})) = \\dim(\\text{Im}(d^{0})) = (p+1)^{2} - 1 $$\n$$ \\dim(\\ker(d^{1})) = (p^{2} + 2p + 1) - 1 = p^{2} + 2p $$\nThis is the final expression for the dimension of the kernel of $d^{1}$.",
            "answer": "$$\n\\boxed{p^2+2p}\n$$"
        },
        {
            "introduction": "The abstract commuting diagram property, which states that $d\\Pi = \\Pi d$, is the discrete expression of the fundamental theorems of vector calculus, such as Stokes' theorem. This coding practice brings the theory to life by having you implement the discrete exterior derivative $d$ as a boundary sum and the projection $\\Pi$ as an integral over a mesh element . You will verify that the diagram commutes numerically, providing a concrete demonstration of how these operators work together to preserve essential geometric and physical structures.",
            "id": "3380459",
            "problem": "Consider the Discontinuous Galerkin (DG) discretization of Maxwell equations formulated via the discrete de Rham complex on a simple oriented mesh. Let the exterior derivative ($d$) map discrete cochains between degrees, and let the commuting projections ($\\Pi_k$) be defined by integrating continuous fields onto $k$-cochains (edges for $k=1$, faces for $k=2$, volumes for $k=3$). The commuting diagram property states that $d\\circ\\Pi_k = \\Pi_{k+1}\\circ d$ on sufficiently smooth fields when $\\Pi_k$ are defined by exact line/surface/volume integrals, and the incidences ($d$) are realized by oriented boundary sums. Using Stokes's theorem and the divergence theorem as the fundamental base, you will verify these properties numerically on a manufactured set of fields while also checking integral identities for Faraday's law and Gauss's law at the cochain level.\n\nGeometry and orientations:\n- Let the oriented triangle (a $2$-simplex) be defined by vertices $v_0=(0,0,0)$, $v_1=(1,0,0)$, $v_2=(0,1,0)$ with a positively oriented normal $\\boldsymbol{n}$ pointing in the $+z$ direction. Its oriented boundary is the counterclockwise edge cycle $(v_0 \\to v_1)$, $(v_1 \\to v_2)$, $(v_2 \\to v_0)$.\n- Let the oriented tetrahedron (a $3$-simplex) be defined by vertices $v_0=(0,0,0)$, $v_1=(1,0,0)$, $v_2=(0,1,0)$, $v_3=(0,0,1)$ with orientation given by the ordered list $[v_0,v_1,v_2,v_3]$. Its oriented boundary consists of the faces with vertex orderings $(v_1,v_2,v_3)$, $(v_0,v_3,v_2)$, $(v_0,v_1,v_3)$, $(v_0,v_2,v_1)$, which correspond to outward normals when computed via the right-hand rule. For a triangle with ordered vertices $(a,b,c)$, let its oriented area vector be $\\boldsymbol{A} = \\frac{1}{2}(b-a)\\times(c-a)$, so that $\\int_{\\text{face}} \\boldsymbol{n}\\, \\mathrm{d}S = \\boldsymbol{A}$. For the tetrahedron, its volume is $V=\\frac{1}{6}\\left|\\det\\left([v_1-v_0, v_2-v_0, v_3-v_0]\\right)\\right|$.\n\nCochain projections and discrete exterior derivative:\n- For a smooth vector field $\\boldsymbol{E}(\\boldsymbol{x},t)$, define the $1$-cochain projection by line integrals on oriented edges: $\\Pi_1 \\boldsymbol{E}(e) = \\int_e \\boldsymbol{E}\\cdot \\mathrm{d}\\boldsymbol{l}$.\n- For a smooth vector field $\\boldsymbol{B}(\\boldsymbol{x},t)$, define the $2$-cochain projection by surface fluxes on oriented faces: $\\Pi_2 \\boldsymbol{B}(f) = \\int_f \\boldsymbol{B}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S$.\n- For a smooth scalar field $q(\\boldsymbol{x},t)$, define the $3$-cochain projection by volume integrals on oriented cells: $\\Pi_3 q(c) = \\int_c q\\,\\mathrm{d}V$.\n- The discrete exterior derivative $d$ acts by oriented boundary sums: for a face $f$ with boundary edges $\\partial f$, $(d\\Pi_1 \\boldsymbol{E})(f) = \\sum_{e\\in \\partial f} \\Pi_1 \\boldsymbol{E}(e)$; for a cell $c$ with boundary faces $\\partial c$, $(d\\Pi_2 \\boldsymbol{B})(c) = \\sum_{f\\in \\partial c} \\Pi_2 \\boldsymbol{B}(f)$.\n\nFundamental identities to verify:\n- Stokes's theorem: $\\int_f (\\nabla\\times \\boldsymbol{E})\\cdot \\boldsymbol{n}\\,\\mathrm{d}S = \\oint_{\\partial f} \\boldsymbol{E}\\cdot \\mathrm{d}\\boldsymbol{l}$, which implies the commuting property $d\\circ\\Pi_1 \\boldsymbol{E} = \\Pi_2 (\\nabla\\times\\boldsymbol{E})$ on faces.\n- The divergence theorem: $\\int_c (\\nabla\\cdot \\boldsymbol{B})\\,\\mathrm{d}V = \\int_{\\partial c} \\boldsymbol{B}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S$, which implies the commuting property $d\\circ\\Pi_2 \\boldsymbol{B} = \\Pi_3 (\\nabla\\cdot\\boldsymbol{B})$ on cells.\n- Faraday’s law in integral form: $\\oint_{\\partial f} \\boldsymbol{E}\\cdot \\mathrm{d}\\boldsymbol{l} + \\frac{\\partial}{\\partial t}\\int_f \\boldsymbol{B}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S = 0$.\n- Gauss’s law for magnetism: $\\int_c (\\nabla\\cdot \\boldsymbol{B})\\,\\mathrm{d}V = 0$.\n\nNumerical realization:\n- Use the midpoint rule for line integrals on segments, which is exact for linear fields: for an oriented edge from $a$ to $b$, $\\int_e \\boldsymbol{E}\\cdot \\mathrm{d}\\boldsymbol{l} = \\boldsymbol{E}\\left(\\frac{a+b}{2},t\\right)\\cdot (b-a)$.\n- Use the centroid rule for triangles for linear fields: for face $(a,b,c)$, $\\int_f \\boldsymbol{F}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S = \\boldsymbol{F}\\left(\\frac{a+b+c}{3},t\\right)\\cdot \\boldsymbol{A}$ for $\\boldsymbol{F}$ linear in space.\n- Use the centroid rule for tetrahedra for linear scalars: $\\int_c q\\,\\mathrm{d}V = q\\left(\\frac{v_0+v_1+v_2+v_3}{4},t\\right)\\, V$ for $q$ linear in space.\n\nTest suite:\nFor each test case, define $\\boldsymbol{E}$, its curl $\\nabla\\times\\boldsymbol{E}$, $\\boldsymbol{B}$, its divergence $\\nabla\\cdot\\boldsymbol{B}$, the time derivative $\\frac{\\partial \\boldsymbol{B}}{\\partial t}$, and the evaluation time $t$. All fields are dimensionless (nondimensionalized), so no physical units are required in the output.\n\n- Case A (nontrivial Maxwell-consistent circulation and zero divergence):\n  - $\\boldsymbol{E}(\\boldsymbol{x},t) = \\left(-\\frac{y}{2}, \\frac{x}{2}, 0\\right)$.\n  - $\\nabla\\times\\boldsymbol{E} = (0,0,1)$.\n  - $\\boldsymbol{B}(\\boldsymbol{x},t) = (0,0,-t)$.\n  - $\\nabla\\cdot\\boldsymbol{B} = 0$.\n  - $\\frac{\\partial \\boldsymbol{B}}{\\partial t} = (0,0,-1)$.\n  - $t=0.3$.\n- Case B (commuting properties hold; Maxwell laws violated):\n  - $\\boldsymbol{E}(\\boldsymbol{x},t) = (x,0,0)$.\n  - $\\nabla\\times\\boldsymbol{E} = (0,0,0)$.\n  - $\\boldsymbol{B}(\\boldsymbol{x},t) = \\left(x, \\frac{y}{2}, -\\frac{z}{4} + \\sin t\\right)$.\n  - $$ \\nabla\\cdot\\boldsymbol{B} = \\frac{\\partial}{\\partial x}x + \\frac{\\partial}{\\partial y}\\left(\\frac{y}{2}\\right) + \\frac{\\partial}{\\partial z}\\left(-\\frac{z}{4} + \\sin t\\right) = 1 + \\frac{1}{2} - \\frac{1}{4} = \\frac{5}{4} $$.\n  - $\\frac{\\partial \\boldsymbol{B}}{\\partial t} = (0,0,\\cos t)$.\n  - $t=0.7$.\n- Case C (zero fields):\n  - $\\boldsymbol{E}(\\boldsymbol{x},t) = (0,0,0)$.\n  - $\\nabla\\times\\boldsymbol{E} = (0,0,0)$.\n  - $\\boldsymbol{B}(\\boldsymbol{x},t) = (0,0,0)$.\n  - $\\nabla\\cdot\\boldsymbol{B} = 0$.\n  - $\\frac{\\partial \\boldsymbol{B}}{\\partial t} = (0,0,0)$.\n  - $t=0$.\n\nProgram requirements:\n- Implement the cochain projections and discrete exterior derivatives on the given oriented triangle and tetrahedron using the rules above.\n- For each case, compute four boolean checks with tolerance $\\varepsilon=10^{-12}$:\n  1. Commuting for curl: $|(d\\circ \\Pi_1 \\boldsymbol{E})(\\text{face}) - \\Pi_2 (\\nabla\\times\\boldsymbol{E})(\\text{face})| \\le \\varepsilon$.\n  2. Faraday integral identity: $|(d\\circ \\Pi_1 \\boldsymbol{E})(\\text{face}) + \\frac{\\partial}{\\partial t}\\Pi_2 \\boldsymbol{B}(\\text{face})| \\le \\varepsilon$.\n  3. Commuting for divergence: $|(d\\circ \\Pi_2 \\boldsymbol{B})(\\text{cell}) - \\Pi_3 (\\nabla\\cdot\\boldsymbol{B})(\\text{cell})| \\le \\varepsilon$.\n  4. Gauss law: $|\\Pi_3 (\\nabla\\cdot\\boldsymbol{B})(\\text{cell})| \\le \\varepsilon$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_{12}]$), where the entries are the twelve booleans for Cases A, B, and C, in the order specified by the four checks per case.\n\nThe solution should rely only on the fundamental theorems (Stokes's theorem and the divergence theorem), the definition of the discrete exterior derivative as oriented boundary sum, and the exact projection operators defined by line/surface/volume integrals. No external input is permitted. Use deterministic arithmetic with the stated tolerance for comparisons.",
            "solution": "The user-provided problem statement has been analyzed and is deemed **valid**. It is scientifically grounded, well-posed, and all necessary data and definitions for a unique solution are provided. The problem asks for the numerical verification of commuting diagram properties and physical laws related to the discrete de Rham complex on a single triangular face and a single tetrahedral cell. The provided fields are linear in spatial variables, for which the specified quadrature rules (midpoint and centroid rules) are exact. This ensures that the numerical projections are not approximations, but exact evaluations of the continuous integrals, allowing for a precise test of the algebraic structure.\n\nThe solution proceeds as follows:\n1.  **Define Geometric Entities**: The vertices for the reference triangle and tetrahedron are defined as `numpy` arrays. From these, the oriented edges of the triangle and the oriented faces of the tetrahedron are constructed, respecting the orientations specified in the problem statement.\n2.  **Implement Auxiliary Geometric Functions**: Functions to compute the oriented area vector of a triangle, $\\boldsymbol{A} = \\frac{1}{2}(b-a)\\times(c-a)$, and the volume of a tetrahedron, $V=\\frac{1}{6}|\\det([v_1-v_0, v_2-v_0, v_3-v_0])|$, are implemented. These are essential for the projection operators.\n3.  **Implement Projection Operators ($\\Pi_k$)**: The projection operators, which map continuous fields to discrete cochains, are implemented based on the provided numerical integration rules:\n    *   $\\Pi_1$: The line integral of a vector field $\\boldsymbol{E}$ over an edge $e=(a,b)$ is calculated using the midpoint rule: $\\Pi_1 \\boldsymbol{E}(e) = \\boldsymbol{E}(\\frac{a+b}{2}, t) \\cdot (b-a)$.\n    *   $\\Pi_2$: The surface integral (flux) of a vector field $\\boldsymbol{F}$ over a triangular face $f=(a,b,c)$ is calculated using the centroid rule: $\\Pi_2 \\boldsymbol{F}(f) = \\boldsymbol{F}(\\frac{a+b+c}{3}, t) \\cdot \\boldsymbol{A}_f$.\n    *   $\\Pi_3$: The volume integral of a scalar field $q$ over a tetrahedral cell $c=(v_0,v_1,v_2,v_3)$ is calculated using the centroid rule: $\\Pi_3 q(c) = q(\\frac{v_0+v_1+v_2+v_3}{4}, t) \\cdot V_c$.\n4.  **Implement Discrete Exterior Derivative ($d$)**: The discrete exterior derivative is implemented as an oriented sum over boundary elements:\n    *   For a $1$-cochain (values on edges), its derivative on a face $f$ is $(d\\Pi_1 \\boldsymbol{E})(f) = \\sum_{e \\in \\partial f} \\Pi_1 \\boldsymbol{E}(e)$. The sum is over the oriented edges forming the boundary of the face.\n    *   For a $2$-cochain (values on faces), its derivative on a cell $c$ is $(d\\Pi_2 \\boldsymbol{B})(c) = \\sum_{f \\in \\partial c} \\Pi_2 \\boldsymbol{B}(f)$. The sum is over the oriented faces forming the boundary of the cell.\n5.  **Define Field Functions**: For each of the three test cases (A, B, C), the vector fields $\\boldsymbol{E}(\\boldsymbol{x},t)$, $\\boldsymbol{B}(\\boldsymbol{x},t)$, their derivatives ($\\nabla\\times\\boldsymbol{E}$, $\\nabla\\cdot\\boldsymbol{B}$, $\\frac{\\partial\\boldsymbol{B}}{\\partial t}$), and the evaluation time $t$ are defined as Python functions.\n6.  **Perform Numerical Verification**: For each test case, the four specified checks are performed using a tolerance of $\\varepsilon = 10^{-12}$.\n    *   **Check 1 (Commuting for curl)**: Verifies $d\\circ\\Pi_1 \\boldsymbol{E} = \\Pi_2(\\nabla\\times\\boldsymbol{E})$ on the triangle. This is the discrete form of Stokes's theorem. As the underlying theorem is true and the projections are exact for the given linear fields, this check is expected to pass for all cases.\n    *   **Check 2 (Faraday's Law)**: Verifies $(d\\circ \\Pi_1 \\boldsymbol{E})(f) + \\Pi_2 (\\frac{\\partial \\boldsymbol{B}}{\\partial t})(f) = 0$. This is the discrete integral form of Faraday's law of induction. It holds only if the provided fields $\\boldsymbol{E}$ and $\\boldsymbol{B}$ satisfy the continuous law, $\\nabla\\times\\boldsymbol{E} = -\\frac{\\partial\\boldsymbol{B}}{\\partial t}$.\n    *   **Check 3 (Commuting for divergence)**: Verifies $d\\circ\\Pi_2 \\boldsymbol{B} = \\Pi_3(\\nabla\\cdot\\boldsymbol{B})$ on the tetrahedron. This is the discrete form of the divergence theorem. Like the first check, this is an algebraic identity that should hold for all cases given the exactness of the projections.\n    *   **Check 4 (Gauss's Law for Magnetism)**: Verifies $\\Pi_3(\\nabla\\cdot\\boldsymbol{B}) = 0$, which is a direct consequence of the continuous law $\\nabla\\cdot\\boldsymbol{B}=0$. This check depends on whether the given $\\boldsymbol{B}$ field is divergence-free.\n7.  **Format Output**: The results of the twelve boolean checks (four for each of the three cases) are collected and formatted into a single string as required.\n\nThe calculations are performed as planned. For Case A, the fields are constructed to satisfy Maxwell's equations, so all four checks pass. For Case B, the fields are chosen to violate Faraday's law and Gauss's law for magnetism, but the commuting diagram properties (which are purely geometric/algebraic) still hold. For Case C, all fields are zero, trivially satisfying all conditions. The final output will reflect these theoretical expectations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the discrete de Rham complex verification problem.\n    \"\"\"\n    TOL = 1e-12\n\n    # --- 1. Define Geometric Entities ---\n    v0 = np.array([0.0, 0.0, 0.0])\n    v1 = np.array([1.0, 0.0, 0.0])\n    v2 = np.array([0.0, 1.0, 0.0])\n    v3 = np.array([0.0, 0.0, 1.0])\n\n    # Oriented triangle face and its boundary edges\n    triangle_face_geom = (v0, v1, v2)\n    triangle_edges_geom = [(v0, v1), (v1, v2), (v2, v0)]\n\n    # Oriented tetrahedron cell and its boundary faces\n    tetra_cell_geom = (v0, v1, v2, v3)\n    tetra_faces_geom = [(v1, v2, v3), (v0, v3, v2), (v0, v1, v3), (v0, v2, v1)]\n\n    # --- 2. Implement Auxiliary Geometric Functions ---\n    def area_vector(v_a, v_b, v_c):\n        return 0.5 * np.cross(v_b - v_a, v_c - v_a)\n\n    def volume(v0, v1, v2, v3):\n        mat = np.array([v1 - v0, v2 - v0, v3 - v0])\n        return np.abs(np.linalg.det(mat)) / 6.0\n\n    # --- 3. Implement Projection Operators ---\n    def pi_1(E_func, edge, t):\n        a, b = edge\n        midpoint = 0.5 * (a + b)\n        dl = b - a\n        E_val = E_func(midpoint, t)\n        return np.dot(E_val, dl)\n\n    def pi_2(F_func, face, t):\n        a, b, c = face\n        centroid = (a + b + c) / 3.0\n        A = area_vector(a, b, c)\n        F_val = F_func(centroid, t)\n        return np.dot(F_val, A)\n\n    def pi_3(q_func, cell, t):\n        v0, v1, v2, v3 = cell\n        centroid = (v0 + v1 + v2 + v3) / 4.0\n        V = volume(v0, v1, v2, v3)\n        q_val = q_func(centroid, t)\n        return q_val * V\n\n    # --- 4. Implement Discrete Exterior Derivative ---\n    def d_pi_1(E_func, edges, t):\n        total = 0.0\n        for edge in edges:\n            total += pi_1(E_func, edge, t)\n        return total\n\n    def d_pi_2(B_func, faces, t):\n        total = 0.0\n        for face in faces:\n            total += pi_2(B_func, face, t)\n        return total\n\n    # --- 5. Define Field Functions ---\n    test_cases = [\n        # Case A\n        {\n            \"E\": lambda x, t: np.array([-x[1]/2.0, x[0]/2.0, 0.0]),\n            \"curl_E\": lambda x, t: np.array([0.0, 0.0, 1.0]),\n            \"B\": lambda x, t: np.array([0.0, 0.0, -t]),\n            \"div_B\": lambda x, t: 0.0,\n            \"dB_dt\": lambda x, t: np.array([0.0, 0.0, -1.0]),\n            \"t\": 0.3\n        },\n        # Case B\n        {\n            \"E\": lambda x, t: np.array([x[0], 0.0, 0.0]),\n            \"curl_E\": lambda x, t: np.array([0.0, 0.0, 0.0]),\n            \"B\": lambda x, t: np.array([x[0], x[1]/2.0, -x[2]/4.0 + np.sin(t)]),\n            \"div_B\": lambda x, t: 1.25,\n            \"dB_dt\": lambda x, t: np.array([0.0, 0.0, np.cos(t)]),\n            \"t\": 0.7\n        },\n        # Case C\n        {\n            \"E\": lambda x, t: np.array([0.0, 0.0, 0.0]),\n            \"curl_E\": lambda x, t: np.array([0.0, 0.0, 0.0]),\n            \"B\": lambda x, t: np.array([0.0, 0.0, 0.0]),\n            \"div_B\": lambda x, t: 0.0,\n            \"dB_dt\": lambda x, t: np.array([0.0, 0.0, 0.0]),\n            \"t\": 0.0\n        }\n    ]\n\n    results = []\n    # --- 6. Perform Numerical Verification ---\n    for case in test_cases:\n        E_func = case[\"E\"]\n        curl_E_func = case[\"curl_E\"]\n        B_func = case[\"B\"]\n        div_B_func = case[\"div_B\"]\n        dB_dt_func = case[\"dB_dt\"]\n        t = case[\"t\"]\n\n        # Check 1: Commuting for curl on the triangle face\n        # | (d o Pi_1 E)(face) - Pi_2(curl E)(face) | <= tol\n        d_pi_1_E_val = d_pi_1(E_func, triangle_edges_geom, t)\n        pi_2_curl_E_val = pi_2(curl_E_func, triangle_face_geom, t)\n        check1 = np.abs(d_pi_1_E_val - pi_2_curl_E_val) <= TOL\n        results.append(check1)\n\n        # Check 2: Faraday integral identity on the triangle face\n        # | (d o Pi_1 E)(face) + d/dt(Pi_2 B)(face) | <= tol\n        # d/dt(Pi_2 B) is implemented as Pi_2(dB/dt)\n        pi_2_dB_dt_val = pi_2(dB_dt_func, triangle_face_geom, t)\n        check2 = np.abs(d_pi_1_E_val + pi_2_dB_dt_val) <= TOL\n        results.append(check2)\n\n        # Check 3: Commuting for divergence on the tetrahedron cell\n        # | (d o Pi_2 B)(cell) - Pi_3(div B)(cell) | <= tol\n        d_pi_2_B_val = d_pi_2(B_func, tetra_faces_geom, t)\n        pi_3_div_B_val = pi_3(div_B_func, tetra_cell_geom, t)\n        check3 = np.abs(d_pi_2_B_val - pi_3_div_B_val) <= TOL\n        results.append(check3)\n\n        # Check 4: Gauss's law for magnetism on the tetrahedron cell\n        # | Pi_3(div B)(cell) | <= tol\n        check4 = np.abs(pi_3_div_B_val) <= TOL\n        results.append(check4)\n\n    # --- 7. Format Output ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Structure-preserving principles are not merely for post-analysis; they are powerful guides for designing robust numerical schemes from the ground up. In this exercise, you will act as a method designer, tasked with determining the correct form of a numerical flux in a discontinuous Galerkin (DG) method . By enforcing that the commuting diagram property must hold at element interfaces, you will see how this abstract requirement uniquely constrains the flux, demonstrating the constructive power of the geometric approach to numerical methods.",
            "id": "3380481",
            "problem": "Consider a bounded Lipschitz polyhedral domain $\\Omega \\subset \\mathbb{R}^{3}$ with a conforming, shape-regular simplicial mesh $\\mathcal{T}_{h}$. Let $V_{h}^{0}$ denote the space of elementwise polynomials of total degree at most $r \\geq 1$ on each $K \\in \\mathcal{T}_{h}$ (with no interelement continuity), and let $V_{h}^{1}$ denote the broken Nédélec space of the first kind of order $r$ on $\\mathcal{T}_{h}$ (again with no interelement continuity). Define the broken gradient operator $\\nabla_{h}$ acting elementwise on $V_{h}^{0}$.\n\nLet $\\Pi_{h}^{0}: L^{2}(\\Omega) \\to V_{h}^{0}$ be the elementwise $L^{2}$ projection onto polynomials of degree at most $r$ on each element, and let $\\Pi_{h}^{1}$ be the canonical Nédélec projection of the first kind onto $V_{h}^{1}$, defined elementwise by the standard edge, face, and interior moment conditions so that, on each $K \\in \\mathcal{T}_{h}$, it preserves the degrees of freedom and is well defined for sufficiently smooth vector fields. Assume the standard elementwise commuting property of the discrete de Rham complex holds on each element: the projection $\\Pi_{h}^{1}$ maps exact gradients to discrete gradients in the sense that, restricted to any element $K$, the operator $\\Pi_{h}^{1}$ sends $\\nabla \\phi$ to a field whose tangential trace on each face of $K$ depends only on the tangential trace of $\\phi$ on that face.\n\nFor any interior face $F = \\partial K^{+} \\cap \\partial K^{-}$ shared by two adjacent elements $K^{+}, K^{-} \\in \\mathcal{T}_{h}$, let $\\boldsymbol{n}$ be a chosen unit normal on $F$ (with the opposite orientation on the other side). For any vector field $\\boldsymbol{E}$ sufficiently smooth on each side, define the tangential trace operator on $F$ by $T_{F}(\\boldsymbol{E}) := \\boldsymbol{n} \\times \\boldsymbol{E}|_{F}$, which is tangential to $F$.\n\nConsider a discontinuous Galerkin numerical flux for $H(\\mathrm{curl})$ fields that, for a broken field $\\boldsymbol{E}_{h}$, prescribes a numerical tangential trace on each interior face $F$ by the convex combination\n$$\nT_{F}(\\boldsymbol{E}_{h})^{*} := \\theta \\, T_{F}(\\boldsymbol{E}_{h}^{+}) + (1 - \\theta) \\, T_{F}(\\boldsymbol{E}_{h}^{-}),\n$$\nwhere $T_{F}(\\boldsymbol{E}_{h}^{\\pm})$ denote the one-sided traces from $K^{\\pm}$ and $\\theta \\in \\mathbb{R}$ is a constant (independent of $F$) to be determined. No additional penalty or stabilization terms are present in the flux.\n\nYou are tasked with enforcing the commuting diagram at interfaces in the following strong tangential-trace sense: for every sufficiently smooth scalar field $\\phi$, the interface numerical tangential trace of the discrete gradient of the projected scalar must coincide with the tangential trace of the projected continuous gradient, that is,\n$$\nT_{F}\\big(\\nabla_{h} \\, \\Pi_{h}^{0} \\phi\\big)^{*} \\;=\\; T_{F}\\big(\\Pi_{h}^{1} \\, \\nabla \\phi\\big)\n\\quad \\text{on each interior face } F \\in \\mathcal{F}_{h}^{\\mathrm{int}},\n$$\nfor all meshes $\\mathcal{T}_{h}$ and all orientations of the unit normal $\\boldsymbol{n}$ on faces. Determine the unique real value of $\\theta$ for which the above identity can hold for all sufficiently smooth $\\phi$. Express your final answer as an exact number. No rounding is required and no physical units are involved.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All concepts used, such as simplicial meshes, broken polynomial spaces, Nédélec elements, and discrete de Rham complexes, are standard in the field of numerical analysis and finite element methods. The problem asks for the unique value of a parameter $\\theta$ that enforces a specific commuting property for a discontinuous Galerkin flux at element interfaces. We proceed to the solution.\n\nLet $\\mathcal{T}_{h}$ be a conforming simplicial mesh of the domain $\\Omega \\subset \\mathbb{R}^{3}$. Consider an interior face $F$ shared by two adjacent elements, which we label $K_1$ and $K_2$. Let $\\phi$ be a sufficiently smooth scalar field. We denote the elementwise $L^2$ projection of $\\phi$ onto the space of polynomials of degree at most $r \\ge 1$ on an element $K$ as $\\Pi_{h,K}^0 \\phi$. Let $\\phi_h^1 = \\Pi_{h,K_1}^0 \\phi$ and $\\phi_h^2 = \\Pi_{h,K_2}^0 \\phi$.\n\nThe problem requires that the following identity holds on any interior face $F$:\n$$\nT_{F}\\big(\\nabla_{h} \\, \\Pi_{h}^{0} \\phi\\big)^{*} \\;=\\; T_{F}\\big(\\Pi_{h}^{1} \\, \\nabla \\phi\\big)\n$$\nThis identity must be satisfied for all sufficiently smooth $\\phi$, all conforming shape-regular simplicial meshes $\\mathcal{T}_h$, and for any choice of orientation for the unit normal vector on the face $F$.\n\nThe term on the right-hand side, $T_{F}\\big(\\Pi_{h}^{1} \\, \\nabla \\phi\\big)$, represents the tangential trace of the Nédélec projection of $\\nabla \\phi$. A fundamental property of the canonical Nédélec projection $\\Pi_h^1$ is that the tangential trace of $\\Pi_{h,K}^1 \\mathbf{u}$ on any face $F \\subset \\partial K$ is uniquely determined by the tangential trace of $\\mathbf{u}$ on $F$. Since the field $\\nabla\\phi$ is continuous, its trace on $F$ is single-valued. Consequently, the tangential trace of its Nédélec projection is also single-valued on $F$, regardless of whether it is viewed from $K_1$ or $K_2$. Let us denote this single-valued tangential field on $F$ as $\\mathbf{U}_F := (\\Pi_{h}^{1} \\, \\nabla \\phi)|_F$. Note that this field is independent of the choice of normal vector, as it is an intrinsic property of $\\nabla\\phi$ on $F$.\n\nThe term on the left-hand side is the numerical flux, defined as:\n$$\nT_{F}(\\boldsymbol{E}_{h})^{*} := \\theta \\, T_{F}(\\boldsymbol{E}_{h}^{+}) + (1 - \\theta) \\, T_{F}(\\boldsymbol{E}_{h}^{-})\n$$\nwhere $\\boldsymbol{E}_{h} = \\nabla_{h} \\, \\Pi_{h}^{0} \\phi$. The superscripts $+$ and $-$ refer to the two sides of the face $F$. The standard convention in discontinuous Galerkin methods, which we adopt here, is that the labels $K^{+}$ and $K^{-}$ are relative to the chosen unit normal $\\boldsymbol{n}$. If $\\boldsymbol{n}$ points from element $K_1$ to element $K_2$, then $K^{+} \\equiv K_1$ and $K^{-} \\equiv K_2$. The tangential trace operator is defined as $T_F(\\mathbf{E}) := \\boldsymbol{n} \\times \\mathbf{E}|_F$.\n\nThe core of the argument lies in the constraint that the identity must hold for any choice of normal vector orientation on $F$. Let's analyze the two possible choices for the normal on the face $F$ shared by $K_1$ and $K_2$.\n\nCase 1: Let the unit normal $\\boldsymbol{n}$ on $F$ be oriented to point from $K_1$ to $K_2$.\nAccording to the convention, we have $K^{+} = K_1$ and $K^{-} = K_2$. The broken gradient field is $\\boldsymbol{E}_{h}^1 = \\nabla \\phi_h^1$ in $K_1$ and $\\boldsymbol{E}_{h}^2 = \\nabla \\phi_h^2$ in $K_2$.\nThe numerical flux is:\n$$\nT_{F}(\\boldsymbol{E}_{h})^{*} = \\theta \\, T_{F}(\\boldsymbol{E}_{h}^{1}) + (1 - \\theta) \\, T_{F}(\\boldsymbol{E}_{h}^{2}) = \\theta (\\boldsymbol{n} \\times \\boldsymbol{E}_{h}^{1}) + (1 - \\theta) (\\boldsymbol{n} \\times \\boldsymbol{E}_{h}^{2})\n$$\nThe right-hand side of the required identity is $T_{F}(\\Pi_{h}^{1} \\, \\nabla \\phi) = \\boldsymbol{n} \\times \\mathbf{U}_F$.\nThus, for this choice of normal, the condition is:\n$$\n\\theta (\\boldsymbol{n} \\times \\nabla \\phi_h^1) + (1 - \\theta) (\\boldsymbol{n} \\times \\nabla \\phi_h^2) = \\boldsymbol{n} \\times \\mathbf{U}_F \\quad (*).\n$$\n\nCase 2: Let the unit normal be $\\boldsymbol{n}' = -\\boldsymbol{n}$, which points from $K_2$ to $K_1$.\nAccording to the convention, we now have $K^{+} = K_2$ and $K^{-} = K_1$. The tangential trace operator is now $T'_F(\\mathbf{E}) := \\boldsymbol{n}' \\times \\mathbf{E}|_F = -\\boldsymbol{n} \\times \\mathbf{E}|_F$.\nThe numerical flux is defined with respect to this new normal and ordering:\n$$\nT'_{F}(\\boldsymbol{E}_{h})^{*} = \\theta \\, T'_{F}(\\boldsymbol{E}_{h}^{2}) + (1 - \\theta) \\, T'_{F}(\\boldsymbol{E}_{h}^{1}) = \\theta (-\\boldsymbol{n} \\times \\boldsymbol{E}_{h}^{2}) + (1 - \\theta) (-\\boldsymbol{n} \\times \\boldsymbol{E}_{h}^{1})\n$$\nThe right-hand side of the required identity is $T'_{F}(\\Pi_{h}^{1} \\, \\nabla \\phi) = \\boldsymbol{n}' \\times \\mathbf{U}_F = -\\boldsymbol{n} \\times \\mathbf{U}_F$.\nThus, for this choice of normal, the condition is:\n$$\n\\theta (-\\boldsymbol{n} \\times \\nabla \\phi_h^2) + (1 - \\theta) (-\\boldsymbol{n} \\times \\nabla \\phi_h^1) = -\\boldsymbol{n} \\times \\mathbf{U}_F\n$$\nMultiplying by $-1$, we obtain:\n$$\n\\theta (\\boldsymbol{n} \\times \\nabla \\phi_h^2) + (1 - \\theta) (\\boldsymbol{n} \\times \\nabla \\phi_h^1) = \\boldsymbol{n} \\times \\mathbf{U}_F \\quad (**).\n$$\n\nFor the problem statement to hold, both equations $(*)$ and $(**)$ must be true for any sufficiently smooth $\\phi$. Equating the left-hand sides of $(*)$ and $(**)$ gives:\n$$\n\\theta (\\boldsymbol{n} \\times \\nabla \\phi_h^1) + (1 - \\theta) (\\boldsymbol{n} \\times \\nabla \\phi_h^2) = (1 - \\theta) (\\boldsymbol{n} \\times \\nabla \\phi_h^1) + \\theta (\\boldsymbol{n} \\times \\nabla \\phi_h^2)\n$$\nSince the cross product with $\\boldsymbol{n}$ is an invertible linear map on the tangent space of the face $F$, this vector equality is equivalent to an equality of the tangential components of the vector fields. We can rearrange the terms:\n$$\n\\big(\\theta - (1-\\theta)\\big)(\\boldsymbol{n} \\times \\nabla \\phi_h^1) - \\big(\\theta - (1-\\theta)\\big)(\\boldsymbol{n} \\times \\nabla \\phi_h^2) = \\mathbf{0}\n$$\n$$\n(2\\theta - 1) \\big( \\boldsymbol{n} \\times \\nabla \\phi_h^1 - \\boldsymbol{n} \\times \\nabla \\phi_h^2 \\big) = \\mathbf{0}\n$$\nThis can be written as:\n$$\n(2\\theta - 1) \\, \\boldsymbol{n} \\times (\\nabla\\phi_h^1 - \\nabla\\phi_h^2) = \\mathbf{0}\n$$\nThis identity must hold for all sufficiently smooth functions $\\phi$ and all meshes $\\mathcal{T}_h$. In general, the $L^2$-projections $\\phi_h^1 = \\Pi_{h,K_1}^{0} \\phi$ and $\\phi_h^2 = \\Pi_{h,K_2}^{0} \\phi$ are different polynomials computed over different domains $K_1$ and $K_2$. Their gradients, $\\nabla\\phi_h^1$ and $\\nabla\\phi_h^2$, will also be different polynomial vector fields. We can always choose a function $\\phi$ and elements $K_1, K_2$ such that the traces of these gradients on the common face $F$ are different. For example, one can choose a function $\\phi$ that is non-zero on $K_1$ and zero on $K_2$, leading to a non-zero $\\nabla\\phi_h^1$ but $\\nabla\\phi_h^2 = \\mathbf{0}$. Therefore, the term $(\\nabla\\phi_h^1 - \\nabla\\phi_h^2)$ is not identically zero on $F$. Consequently, its tangential component $\\boldsymbol{n} \\times (\\nabla\\phi_h^1 - \\nabla\\phi_h^2)$ is also not identically zero in general.\n\nFor the equation $(2\\theta - 1) \\, \\boldsymbol{n} \\times (\\nabla\\phi_h^1 - \\nabla\\phi_h^2) = \\mathbf{0}$ to hold for all valid choices of $\\phi$, the scalar coefficient must be zero:\n$$\n2\\theta - 1 = 0\n$$\nThis yields the unique value for $\\theta$:\n$$\n\\theta = \\frac{1}{2}\n$$\nWith this value, the numerical flux becomes the simple average of the tangential traces from both sides of the face, $T_{F}(\\boldsymbol{E}_{h})^{*} = \\frac{1}{2} (T_{F}(\\boldsymbol{E}_{h}^{+}) + T_{F}(\\boldsymbol{E}_{h}^{-}))$, a common choice for central fluxes in discontinuous Galerkin methods.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        }
    ]
}