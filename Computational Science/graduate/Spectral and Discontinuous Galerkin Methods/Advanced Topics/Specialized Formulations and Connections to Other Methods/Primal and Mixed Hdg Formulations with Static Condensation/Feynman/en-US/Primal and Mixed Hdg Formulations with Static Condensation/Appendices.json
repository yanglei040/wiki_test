{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is foundational to understanding the mechanics of static condensation in Hybridizable Discontinuous Galerkin (HDG) methods. We will derive the explicit form of the local solution operator for a mixed HDG method using the lowest-order polynomials ($k=0$) on a single tetrahedral element. This hands-on calculation demonstrates how interior unknowns, the flux $q_h$ and the scalar $u_h$, can be eliminated by expressing them entirely in terms of the facet-based trace variable $\\widehat{u}_h$ .",
            "id": "3410467",
            "problem": "Consider the steady diffusion model in mixed form on a single tetrahedral element $K \\subset \\mathbb{R}^{3}$ with boundary $\\partial K = \\bigcup_{i=1}^{4} F_{i}$ and outward unit normals $\\boldsymbol{n}_{i}$ on faces $F_{i}$:\n$$\n\\kappa^{-1} \\,\\boldsymbol{q} + \\nabla u = \\boldsymbol{0}, \n\\qquad \\nabla \\cdot \\boldsymbol{q} = f \\quad \\text{in } K,\n$$\nwhere the conductivity $\\kappa>0$ is constant on $K$ and $f \\in L^{2}(K)$ is a given source. Let $|K|$ denote the volume of $K$, $|F_{i}|$ the area of face $F_{i}$, and $\\boldsymbol{n}_{i}$ the outward unit normal to $F_{i}$.\n\nAdopt the mixed Hybridizable Discontinuous Galerkin (HDG) method of degree $k=0$ on $K$, namely take the local approximation spaces $\\boldsymbol{V}_{h}(K) = [\\mathbb{P}_{0}(K)]^{3}$ and $W_{h}(K) = \\mathbb{P}_{0}(K)$ for the flux $\\boldsymbol{q}_{h}$ and scalar $u_{h}$, respectively, and the trace space $M_{h}(F_{i}) = \\mathbb{P}_{0}(F_{i})$ for the facet unknown $\\widehat{u}_{i}$ on each face $F_{i}$. Let the stabilization parameters be $\\tau_{i} > 0$, constant on each face $F_{i}$. The numerical normal flux on face $F_{i}$ is defined by\n$$\n\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} \\;=\\; \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} \\;+\\; \\tau_{i}\\,\\big(u_{h} - \\widehat{u}_{i}\\big).\n$$\nThe local HDG equations on $K$ are: find $(\\boldsymbol{q}_{h}, u_{h}) \\in \\boldsymbol{V}_{h}(K) \\times W_{h}(K)$, given the facet data $\\widehat{u}_{i} \\in M_{h}(F_{i})$ for $i \\in \\{1,2,3,4\\}$, such that for all $\\boldsymbol{r} \\in \\boldsymbol{V}_{h}(K)$ and $w \\in W_{h}(K)$,\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} - \\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} + \\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0,\n$$\n$$\n-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} + \\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K},\n$$\nwith $\\widehat{u}_{h}|_{F_{i}} = \\widehat{u}_{i}$ and $\\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}$ as above. Here $(\\cdot,\\cdot)_{K}$ is the $L^{2}(K)$ inner product and $\\langle \\cdot, \\cdot \\rangle_{\\partial K}$ is the $L^{2}(\\partial K)$ duality pairing.\n\nUsing only foundational definitions and identities, derive the explicit local solution operator on $K$ mapping the four facet trace constants $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ and the source $f$ to the two element unknowns $(\\boldsymbol{q}_{h}, u_{h})$. Express your final result for $(\\boldsymbol{q}_{h}, u_{h})$ solely in terms of $\\kappa$, $|K|$, $\\{|F_{i}|\\}_{i=1}^{4}$, $\\{\\boldsymbol{n}_{i}\\}_{i=1}^{4}$, $\\{\\tau_{i}\\}_{i=1}^{4}$, $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$, and $\\int_{K} f \\, dx$. Your final answer must be a single closed-form analytic expression. Do not perform any numerical evaluation.",
            "solution": "The problem requires the derivation of the explicit local solution operator for the mixed Hybridizable Discontinuous Galerkin (HDG) method of degree $k=0$ on a single tetrahedral element $K$. This operator maps the constant trace values on each face, $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$, and the source function $f$ to the constant-on-element unknowns $(\\boldsymbol{q}_{h}, u_{h})$.\n\nThe local approximation spaces are $\\boldsymbol{V}_{h}(K) = [\\mathbb{P}_{0}(K)]^{3}$ and $W_{h}(K) = \\mathbb{P}_{0}(K)$. This means that the approximate flux $\\boldsymbol{q}_{h}$ is a constant vector on $K$, and the approximate scalar solution $u_{h}$ is a constant scalar on $K$. Similarly, the test functions $\\boldsymbol{r} \\in \\boldsymbol{V}_{h}(K)$ and $w \\in W_{h}(K)$ are a constant vector and a constant scalar, respectively.\n\nLet's analyze the two local HDG equations provided.\n\nThe first equation is:\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} - \\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} + \\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0, \\quad \\forall \\boldsymbol{r} \\in [\\mathbb{P}_{0}(K)]^{3}\n$$\nSince $\\boldsymbol{r}$ is a constant vector on $K$, its divergence is identically zero: $\\nabla \\cdot \\boldsymbol{r} = 0$. Consequently, the second term vanishes: $\\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} = 0$.\n\nThe remaining terms can be simplified. Since $\\kappa^{-1}$, $\\boldsymbol{q}_{h}$, and $\\boldsymbol{r}$ are constant on $K$, the first term is:\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} = \\int_{K} \\kappa^{-1} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{r} \\, dx = \\kappa^{-1} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{r}) |K|\n$$\nThe boundary term is a sum over the four faces $F_{i}$ of the tetrahedron:\n$$\n\\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = \\sum_{i=1}^{4} \\int_{F_{i}} \\widehat{u}_{h} (\\boldsymbol{r} \\cdot \\boldsymbol{n}_{i}) \\, dS\n$$\nOn each face $F_{i}$, the trace approximation $\\widehat{u}_{h}$ is a constant $\\widehat{u}_{i} \\in \\mathbb{P}_{0}(F_{i})$. The test function $\\boldsymbol{r}$ and the normal vector $\\boldsymbol{n}_{i}$ are also constant on $F_{i}$. Therefore, the integral becomes:\n$$\n\\sum_{i=1}^{4} \\widehat{u}_{i} (\\boldsymbol{r} \\cdot \\boldsymbol{n}_{i}) |F_{i}| = \\boldsymbol{r} \\cdot \\left( \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right)\n$$\nSubstituting these simplified terms back into the first HDG equation yields:\n$$\n\\kappa^{-1} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{r}) |K| + \\boldsymbol{r} \\cdot \\left( \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right) = 0\n$$\n$$\n\\boldsymbol{r} \\cdot \\left( \\kappa^{-1} |K| \\boldsymbol{q}_{h} + \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right) = 0\n$$\nThis equation must hold for any constant vector $\\boldsymbol{r} \\in [\\mathbb{P}_{0}(K)]^{3}$. This implies that the term in the parenthesis must be the zero vector:\n$$\n\\kappa^{-1} |K| \\boldsymbol{q}_{h} + \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} = \\boldsymbol{0}\n$$\nSolving for $\\boldsymbol{q}_{h}$ gives the first part of the local solution operator:\n$$\n\\boldsymbol{q}_{h} = - \\frac{\\kappa}{|K|} \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i}\n$$\n\nThe second HDG equation is:\n$$\n-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} + \\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K}, \\quad \\forall w \\in \\mathbb{P}_{0}(K)\n$$\nSince the test function $w$ is a constant scalar on $K$, its gradient is identically zero: $\\nabla w = \\boldsymbol{0}$. Thus, the first term vanishes: $-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} = 0$.\n\nThe equation simplifies to:\n$$\n\\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K}\n$$\nSince $w$ is constant, it can be factored out of the integrals:\n$$\nw \\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = w \\int_{K} f \\, dx\n$$\nAssuming $w \\neq 0$, we can divide by $w$ to get a statement of conservation for the numerical flux:\n$$\n\\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = \\int_{K} f \\, dx\n$$\nLet's expand the left-hand side using the definition of the numerical flux, $\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} = \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})$:\n$$\n\\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = \\sum_{i=1}^{4} \\int_{F_{i}} \\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} \\, dS = \\sum_{i=1}^{4} \\int_{F_{i}} \\big(\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})\\big) \\, dS\n$$\nSince $\\boldsymbol{q}_{h}$, $u_{h}$, $\\tau_{i}$, and $\\widehat{u}_{i}$ are constant on their respective domains, the integral becomes:\n$$\n\\sum_{i=1}^{4} \\big(\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})\\big) |F_{i}| = \\left( \\sum_{i=1}^{4} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i}) |F_{i}| \\right) + \\left( \\sum_{i=1}^{4} \\tau_{i}(u_{h} - \\widehat{u}_{i}) |F_{i}| \\right)\n$$\nThe first summation term can be rewritten as $\\int_{\\partial K} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} \\, dS$. Since $\\boldsymbol{q}_{h}$ is a constant vector, we can apply the divergence theorem:\n$$\n\\sum_{i=1}^{4} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i}) |F_{i}| = \\int_{\\partial K} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} \\, dS = \\int_{K} \\nabla \\cdot \\boldsymbol{q}_{h} \\, dx\n$$\nAs $\\boldsymbol{q}_{h}$ is constant, $\\nabla \\cdot \\boldsymbol{q}_{h} = 0$, so this term is zero. This is a crucial simplification for $\\mathbb{P}_{0}$ elements.\n\nThe conservation equation thus reduces to:\n$$\n\\sum_{i=1}^{4} \\tau_{i}(u_{h} - \\widehat{u}_{i}) |F_{i}| = \\int_{K} f \\, dx\n$$\nWe can now solve for the constant scalar unknown $u_{h}$:\n$$\n\\sum_{i=1}^{4} \\tau_{i} u_{h} |F_{i}| - \\sum_{i=1}^{4} \\tau_{i} \\widehat{u}_{i} |F_{i}| = \\int_{K} f \\, dx\n$$\n$$\nu_{h} \\left( \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\right) = \\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}\n$$\nSince $\\tau_i > 0$ and $|F_i| > 0$, the sum in the parenthesis is strictly positive. Solving for $u_{h}$ gives the second part of the local solution operator:\n$$\nu_{h} = \\frac{\\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}}{\\sum_{j=1}^{4} \\tau_{j} |F_{j}|}\n$$\n(A different summation index $j$ is used in the denominator for clarity.)\n\nCombining the expressions for $\\boldsymbol{q}_{h}$ and $u_{h}$, we obtain the explicit local solution operator that maps $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ and $f$ to $(\\boldsymbol{q}_{h}, u_{h})$.",
            "answer": "$$\n\\boxed{\\left( -\\frac{\\kappa}{|K|} \\sum_{i=1}^{4} |F_{i}| \\widehat{u}_{i} \\boldsymbol{n}_{i}, \\quad \\frac{\\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}}{\\sum_{j=1}^{4} \\tau_{j} |F_{j}|} \\right)}\n$$"
        },
        {
            "introduction": "Building on the concept of the local solver, this practice explores its consequences for the global system. By analyzing a simple one-dimensional problem, we will explicitly construct the element-level Schur complement, or Dirichlet-to-Neumann map, which relates the trace variable $\\widehat{u}_h$ to the numerical fluxes . The goal is to analyze how the properties of this map, specifically its spectrum, depend on the crucial stabilization parameter $\\tau$, revealing important insights into the stability and behavior of the HDG method.",
            "id": "3410511",
            "problem": "Consider the scalar Poisson equation in one spatial dimension on a single element $K=[0,1]$, written in first-order form as $q=\\nabla u$ and $-\\nabla\\cdot q=f$, with $f=0$ on $K$. Use the Hybridizable Discontinuous Galerkin (HDG) method in its mixed formulation and apply static condensation to eliminate local unknowns. Assume the following polynomial spaces for the local interior approximations: $u\\in \\mathcal{P}_{0}(K)$ and $q\\in \\mathcal{P}_{0}(K)$, where $\\mathcal{P}_{0}(K)$ denotes the space of constant polynomials on $K$. On the element boundary $\\partial K=\\{0,1\\}$, take the trace unknown $\\hat{u}$ to be constant per face (i.e., one degree of freedom per endpoint), so that the two face values $\\hat{u}(0)$ and $\\hat{u}(1)$ are distinct unknowns. The stabilization parameter is a constant $\\tau>0$.\n\nAdopt the canonical mixed HDG local formulation:\n- For all test functions $r\\in \\mathcal{P}_{0}(K)$, enforce $(q,r)_{K}=-(u,\\nabla\\cdot r)_{K}+\\langle \\hat{u}, r\\,n\\rangle_{\\partial K}$.\n- For all test functions $v\\in \\mathcal{P}_{0}(K)$, enforce $-(\\nabla\\cdot q,v)_{K}+\\langle \\widehat{q}\\,n, v\\rangle_{\\partial K}=(f,v)_{K}$ with the numerical flux $\\widehat{q}\\,n = q\\,n + \\tau\\,(u - \\hat{u})$.\n\nHere $n$ denotes the outward unit normal on $\\partial K$, $(\\cdot,\\cdot)_{K}$ is the standard $L^{2}(K)$ inner product, and $\\langle\\cdot,\\cdot\\rangle_{\\partial K}$ is the boundary duality pairing which, in one dimension for this element, reduces to weighted point evaluations with $n(0)=-1$ and $n(1)=+1$.\n\nDefine the local Dirichlet-to-Neumann map (the Schur complement) $S(\\tau)$ that sends the trace vector $\\begin{pmatrix}\\hat{u}(0)\\\\ \\hat{u}(1)\\end{pmatrix}$ to the vector of numerical fluxes on the left and right faces, $\\begin{pmatrix}\\lambda_{L}\\\\ \\lambda_{R}\\end{pmatrix}=\\begin{pmatrix}-q(0)+\\tau\\,(u(0)-\\hat{u}(0))\\\\ q(1)+\\tau\\,(u(1)-\\hat{u}(1))\\end{pmatrix}$. Starting only from the stated mixed HDG formulation and spaces, derive $S(\\tau)$ by eliminating the interior unknowns $u$ and $q$ and then determine its spectrum. Compute the unique nonzero eigenvalue $\\lambda(\\tau)$ of $S(\\tau)$ exactly, as a closed-form expression in $\\tau$.\n\nIn your derivation, make explicit use of the first-order system and the mixed HDG weak form, the orientation $n(0)=-1$, $n(1)=+1$, and the stabilization $\\tau$. Study the limits $\\tau\\to 0$ and $\\tau\\to\\infty$ to justify invertibility of the local solver on the non-constant trace subspace. Your final answer must be the analytic expression for the unique nonzero eigenvalue $\\lambda(\\tau)$. No rounding is required and no physical units are involved. Express the final answer in exact form.",
            "solution": "We seek to derive the local Dirichlet-to-Neumann map $S(\\tau)$ by first solving for the local unknowns $(u,q)$ in terms of the trace unknowns $\\hat{u}(0)$ and $\\hat{u}(1)$, and then computing the resulting numerical fluxes.\n\nLet the constant interior unknowns be $u(x)=u_0$ and $q(x)=q_0$ for $x \\in K=[0,1]$. Let the constant trace unknowns be $\\hat{u}_0 = \\hat{u}(0)$ and $\\hat{u}_1 = \\hat{u}(1)$. The test functions $r$ and $v$ are also constants on $K$; we can use the basis function $1$ for both spaces.\n\nFirst, we analyze the local HDG equations.\n\n1.  For the first equation, with $r=1$, we have $\\nabla \\cdot r = (1)' = 0$. The equation becomes:\n    $$\n    (q_0, 1)_K = -(u_0, 0)_K + \\langle \\hat{u}, 1 \\cdot n \\rangle_{\\partial K}\n    $$\n    The integrals become:\n    $$\n    \\int_0^1 q_0 \\,dx = \\hat{u}(1) \\cdot n(1) + \\hat{u}(0) \\cdot n(0)\n    $$\n    With $n(1)=1$ and $n(0)=-1$, this simplifies to:\n    $$\n    q_0 = \\hat{u}_1 - \\hat{u}_0\n    $$\n\n2.  For the second equation, with $v=1$ and $f=0$, and noting that $\\nabla \\cdot q = (q_0)' = 0$, we have:\n    $$\n    -(0, 1)_K + \\langle \\widehat{q}n, 1 \\rangle_{\\partial K} = (0,1)_K\n    $$\n    This simplifies to flux conservation: $\\langle \\widehat{q}n, 1 \\rangle_{\\partial K} = 0$.\n    $$\n    (\\widehat{q}n)|_{x=1} + (\\widehat{q}n)|_{x=0} = 0\n    $$\n    Let's use the definitions of the numerical fluxes $\\lambda_L$ and $\\lambda_R$. The problem states:\n    $\\lambda_R = q(1) + \\tau(u(1)-\\hat{u}(1)) = q_0 + \\tau(u_0 - \\hat{u}_1)$.\n    $\\lambda_L = -q(0) + \\tau(u(0)-\\hat{u}(0)) = -q_0 + \\tau(u_0 - \\hat{u}_0)$.\n    The flux conservation condition $\\langle \\widehat{q}n, 1 \\rangle_{\\partial K} = 0$ is equivalent to $\\lambda_R + \\lambda_L = 0$.\n    Substituting the expressions for $\\lambda_L$ and $\\lambda_R$:\n    $$\n    (q_0 + \\tau(u_0 - \\hat{u}_1)) + (-q_0 + \\tau(u_0 - \\hat{u}_0)) = 0\n    $$\n    $$\n    2\\tau u_0 - \\tau(\\hat{u}_0 + \\hat{u}_1) = 0\n    $$\n    Since $\\tau > 0$, we can solve for $u_0$:\n    $$\n    u_0 = \\frac{\\hat{u}_0 + \\hat{u}_1}{2}\n    $$\n\nNow we have solved for the local unknowns $(u_0, q_0)$ in terms of the traces:\n$$\nq_0 = \\hat{u}_1 - \\hat{u}_0\n$$\n$$\nu_0 = \\frac{1}{2}(\\hat{u}_0 + \\hat{u}_1)\n$$\nThe invertibility of this local solver from $(\\hat{u}_0, \\hat{u}_1)$ to $(u_0, q_0)$ is guaranteed as long as $\\tau>0$.\n\nNext, we construct the Dirichlet-to-Neumann map $S(\\tau)$ which maps $(\\hat{u}_0, \\hat{u}_1)^T$ to $(\\lambda_L, \\lambda_R)^T$. We substitute the expressions for $u_0$ and $q_0$ back into the definitions of $\\lambda_L$ and $\\lambda_R$:\n$$\n\\lambda_L = -q_0 + \\tau(u_0 - \\hat{u}_0) = -(\\hat{u}_1 - \\hat{u}_0) + \\tau\\left(\\frac{\\hat{u}_0 + \\hat{u}_1}{2} - \\hat{u}_0\\right) = (\\hat{u}_0 - \\hat{u}_1) + \\frac{\\tau}{2}(\\hat{u}_1 - \\hat{u}_0) = \\left(1 - \\frac{\\tau}{2}\\right)(\\hat{u}_0 - \\hat{u}_1)\n$$\n$$\n\\lambda_R = q_0 + \\tau(u_0 - \\hat{u}_1) = (\\hat{u}_1 - \\hat{u}_0) + \\tau\\left(\\frac{\\hat{u}_0 + \\hat{u}_1}{2} - \\hat{u}_1\\right) = (\\hat{u}_1 - \\hat{u}_0) + \\frac{\\tau}{2}(\\hat{u}_0 - \\hat{u}_1) = \\left(1 - \\frac{\\tau}{2}\\right)(\\hat{u}_1 - \\hat{u}_0)\n$$\nIn matrix form, this is:\n$$\n\\begin{pmatrix} \\lambda_L \\\\ \\lambda_R \\end{pmatrix} = \\begin{pmatrix} (1-\\frac{\\tau}{2}) & -(1-\\frac{\\tau}{2}) \\\\ -(1-\\frac{\\tau}{2}) & (1-\\frac{\\tau}{2}) \\end{pmatrix} \\begin{pmatrix} \\hat{u}_0 \\\\ \\hat{u}_1 \\end{pmatrix}\n$$\nSo the Dirichlet-to-Neumann map is:\n$$\nS(\\tau) = \\left(1-\\frac{\\tau}{2}\\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nTo find the spectrum of $S(\\tau)$, we find its eigenvalues. The matrix $\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$ is a rank-1 matrix with eigenvalues $0$ and $2$.\n-   The eigenvector for eigenvalue $0$ is $(1, 1)^T$, corresponding to constant traces.\n-   The eigenvector for eigenvalue $2$ is $(1, -1)^T$, corresponding to non-constant (linear) traces.\n\nThe eigenvalues of $S(\\tau)$ are thus $0 \\cdot (1-\\frac{\\tau}{2}) = 0$ and $2 \\cdot (1-\\frac{\\tau}{2}) = 2-\\tau$.\n\nThe unique nonzero eigenvalue is $\\lambda(\\tau) = 2-\\tau$.\n\nRegarding invertibility, the local solver for $(u_0, q_0)$ is always invertible for $\\tau > 0$. The Schur complement $S(\\tau)$ has a nullspace corresponding to constant traces. On the non-constant trace subspace (spanned by $(1, -1)^T$), its action is multiplication by the eigenvalue $\\lambda(\\tau)=2-\\tau$. This operator is invertible on this subspace as long as $\\lambda(\\tau) \\neq 0$, i.e., $\\tau \\neq 2$. In the limits $\\tau \\to 0$ and $\\tau \\to \\infty$, $\\lambda(\\tau)$ is $2$ and $-\\infty$ respectively, so the operator is invertible on the non-constant trace subspace.",
            "answer": "$$\\boxed{2-\\tau}$$"
        },
        {
            "introduction": "A key advantage of discontinuous Galerkin methods is their natural suitability for adaptive mesh refinement. This final practice bridges the gap from merely computing a solution to intelligently assessing its quality by constructing a residual-based a posteriori error estimator . You will learn how to use the computed solution $(q_h, u_h, \\widehat{u}_h)$ to define local error indicators based on how well the strong form of the partial differential equation and the flux continuity conditions are satisfied, forming the basis for efficient, error-driven simulations.",
            "id": "3410464",
            "problem": "Consider the scalar Poisson problem on a bounded, simply connected, polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with homogeneous Dirichlet boundary condition: find $u \\in H_{0}^{1}(\\Omega)$ such that $-\\Delta u = f$ in $\\Omega$, where $f \\in L^{2}(\\Omega)$. Introduce the first-order system $q + \\nabla u = 0$ and $\\nabla \\cdot q = f$. Let $\\mathcal{T}_{h}$ be a shape-regular conforming triangulation of $\\Omega$ into triangles with element diameters $\\{h_{K}\\}_{K \\in \\mathcal{T}_{h}}$ and edge lengths $\\{h_{F}\\}_{F \\in \\mathcal{F}_{h}}$, where $\\mathcal{F}_{h}$ is the set of all open edges.\n\nOn $\\mathcal{T}_{h}$, consider the Hybridizable Discontinuous Galerkin (HDG) method, with local unknowns $(q_{h},u_{h})$ in piecewise polynomial spaces on each $K \\in \\mathcal{T}_{h}$ and a global hybrid trace $\\hat{u}_{h}$ on the mesh skeleton $\\mathcal{F}_{h}$, and stabilization parameter $\\tau_{F} > 0$ on each $F \\in \\mathcal{F}_{h}$. Assume that static condensation is performed so that the global linear system involves only the hybrid trace degrees of freedom, while the elementwise fields $(q_{h},u_{h})$ are recovered locally.\n\nYour tasks are as follows.\n\n1. Starting from the first-order system and the local HDG equations, construct an elementwise residual-based a posteriori error estimator that uses only:\n   - element residuals of the strong equations, and\n   - facet jumps of the normal component of the discrete flux.\n   The estimator must be defined entirely in terms of computable quantities $(q_{h},u_{h},\\hat{u}_{h})$, the data $f$, and the mesh scales $h_{K}$ and $h_{F}$. Use mesh-dependent weights to ensure that the contributions are balanced and dimensionally consistent. Clearly state the definitions of all residuals and jumps you employ.\n\n2. Under standard assumptions (shape-regular meshes, polynomial degree at least one, and $f \\in L^{2}(\\Omega)$), argue that your estimator is reliable and locally efficient up to data oscillation. Specifically, define a natural energy norm for the error in the HDG mixed setting, and justify, from first principles and standard inequalities, that the global estimator controls the energy error from above, and that each local estimator controls the local error from below up to oscillation. Your argument should identify the role of bubble functions, inverse inequalities, and local stability of the HDG method. Explain why static condensation does not impair computability or the validity of the a posteriori bounds.\n\n3. Now specialize to a single element $K_{0} \\in \\mathcal{T}_{h}$ with diameter $h_{K_{0}} = 0.25$. Suppose $K_{0}$ has three edges $F_{1}$, $F_{2}$, and $F_{3}$ with lengths $h_{F_{1}} = 0.25$, $h_{F_{2}} = 0.25$, and $h_{F_{3}} = 0.3535533906$. Assume that the following elementwise and edgewise $L^{2}$-norms of the relevant quantities in your estimator have been computed:\n   - $\\|f + \\nabla \\cdot q_{h}\\|_{0,K_{0}} = 12$,\n   - $\\|q_{h} + \\nabla u_{h}\\|_{0,K_{0}} = 5$,\n   - $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{1}} = 8$, $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{2}} = 6$, and $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{3}} = 10$,\n   where $\\|\\cdot\\|_{0,D}$ denotes the $L^{2}$-norm on a domain $D$, $n$ is the outward unit normal, and $\\llbracket \\cdot \\rrbracket$ denotes the jump across an interior facet (equal to the trace on $F \\subset \\partial \\Omega$ if $F$ is a boundary facet). Using your estimator from Task 1, evaluate the local indicator for $K_{0}$, denoted $\\eta_{K_{0}}$. Round your final numerical answer to four significant figures. No units are required and your answer must be a single real number.",
            "solution": "The solution is presented in three parts, corresponding to the tasks in the problem statement.\n\n**1. Construction of the A Posteriori Error Estimator**\n\nAn a posteriori error estimator provides a computable quantity that measures the discretization error. For the given first-order system, we seek an estimator for the error $(e_q, e_u) = (q-q_h, u-u_h)$. The estimator should be constructed from quantities available from the numerical solution $(q_h, u_h, \\hat{u}_h)$. The problem specifies using strong-form residuals and flux jumps.\n\nThe exact solution $(q, u)$ satisfies:\n$$\nq + \\nabla u = 0 \\quad \\text{in } K\n$$\n$$\n\\nabla \\cdot q = f \\quad \\text{in } K\n$$\nfor every element $K \\in \\mathcal{T}_h$. The discrete solution $(q_h, u_h)$ approximates this, but does not satisfy these equations exactly. This gives rise to element-wise residuals. Additionally, the normal component of the exact flux $q$ is continuous across element boundaries, i.e., $\\llbracket q \\cdot n \\rrbracket = 0$, whereas for the discrete flux $q_h$, this is not true. This gives rise to a facet residual.\n\nWe define the following residuals:\n- The interior element residual for the first equation is $R_{K,1} := q_h + \\nabla u_h$.\n- The interior element residual for the second equation is $R_{K,2} := f - \\nabla \\cdot q_h$.\n- The facet residual on an edge $F$ is the jump in the normal component of the flux, $J_F := \\llbracket q_h \\cdot n \\rrbracket$. For an interior edge $F = \\partial K_1 \\cap \\partial K_2$ with normal $n$ pointing from $K_1$ to $K_2$, $J_F = (q_h|_{K_1} - q_h|_{K_2}) \\cdot n$. For a boundary edge $F \\subset \\partial\\Omega$ belonging to element $K$, $J_F = q_h|_K \\cdot n$.\n\nTo construct the estimator, we combine these residuals with appropriate mesh-dependent weights to ensure dimensional consistency. Based on standard scaling arguments, we define the local error indicator $\\eta_K$ for each element $K \\in \\mathcal{T}_h$ as:\n$$\n\\eta_{K}^2 := \\|q_h + \\nabla u_h\\|_{0,K}^2 + h_{K}^2 \\|f - \\nabla \\cdot q_h\\|_{0,K}^2 + \\sum_{F \\subset \\partial K} h_{F} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F}^2\n$$\nThe global error estimator $\\eta$ is then the Euclidean sum of the local indicators:\n$$\n\\eta := \\left( \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 \\right)^{1/2}\n$$\nFor the purpose of calculation, we note that $\\|f - \\nabla \\cdot q_h\\|_{0,K} = \\|-(f - \\nabla \\cdot q_h)\\|_{0,K} = \\|f + \\nabla \\cdot q_h\\|_{0,K}$.\n\n**2. Reliability, Efficiency, and Static Condensation**\n\nA natural energy norm for the error $(e_q, e_u)=(q-q_h, u-u_h)$ in this mixed setting is given by\n$$\n\\|(e_q, e_u)\\|_{\\text{en}}^2 := \\|q-q_h\\|_{0,\\Omega}^2 + \\sum_{K \\in \\mathcal{T}_h} \\|\\nabla(u-u_h)\\|_{0,K}^2\n$$\n- **Reliability**: The estimator is reliable if it provides an upper bound on the true error, up to data oscillations:\n$$\n\\|(e_q, e_u)\\|_{\\text{en}} \\le C_{\\text{rel}} \\left( \\eta + \\text{osc} \\right)\n$$\nwhere $C_{\\text{rel}}$ is a constant independent of the mesh size $h$ and $\\text{osc}$ represents data oscillation terms. The argument for reliability follows from testing the weak form of the error equations with appropriate functions related to the error itself and using integration by parts, the Cauchy-Schwarz inequality, and trace inequalities.\n\n- **Local Efficiency**: The estimator is locally efficient if the local indicator is controlled by the error in a local patch of elements, up to data oscillations:\n$$\n\\eta_K \\le C_{\\text{eff}} \\left( \\|(e_q, e_u)\\|_{\\text{en}, \\omega_K} + \\text{osc}_K \\right)\n$$\nwhere $\\omega_K$ is a patch of elements including $K$ and its neighbors. The proof relies on using local element and edge bubble functions to show that a non-zero residual implies a non-zero local error, with inverse inequalities providing the correct scaling with the mesh size.\n\n- **Role of Static Condensation**: Static condensation is an algebraic technique for solving the global linear system. It partitions the unknowns into element-local variables and globally coupled interface variables, solves for the interface variables first, and then recovers the local variables via back-substitution. The resulting discrete solution $(q_h, u_h, \\hat{u}_h)$ is identical to that obtained from solving the full, un-condensed system. Since the a posteriori error estimator $\\eta$ is a function of this computed solution, static condensation does not impair its validity or properties. It is simply part of the procedure to obtain the necessary ingredients $(q_h, u_h)$ to evaluate the estimator.\n\n**3. Numerical Evaluation**\n\nWe compute the local error indicator $\\eta_{K_0}$ using the provided formula and data.\n$$\n\\eta_{K_0}^2 = \\|q_h + \\nabla u_h\\|_{0,K_0}^2 + h_{K_0}^2 \\|f + \\nabla \\cdot q_h\\|_{0,K_0}^2 + \\sum_{i=1}^{3} h_{F_i} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_i}^2\n$$\nThe given values are:\n- $\\|q_h + \\nabla u_h\\|_{0,K_0} = 5$\n- $h_{K_0} = 0.25$\n- $\\|f + \\nabla \\cdot q_h\\|_{0,K_0} = 12$\n- $h_{F_1} = 0.25$ and $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_1} = 8$\n- $h_{F_2} = 0.25$ and $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_2} = 6$\n- $h_{F_3} = 0.3535533906$ and $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_3} = 10$\n\nWe substitute these values into the formula.\n\nThe first term (residual of the constitutive relation) squared is:\n$$\n\\|q_h + \\nabla u_h\\|_{0,K_0}^2 = 5^2 = 25\n$$\n\nThe second term (residual of the conservation law) squared is:\n$$\nh_{K_0}^2 \\|f + \\nabla \\cdot q_h\\|_{0,K_0}^2 = (0.25)^2 \\times 12^2 = 0.0625 \\times 144 = 9\n$$\n\nThe third term (sum of weighted facet jump residuals) is:\n$$\nh_{F_1} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_1}^2 = 0.25 \\times 8^2 = 0.25 \\times 64 = 16\n$$\n$$\nh_{F_2} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_2}^2 = 0.25 \\times 6^2 = 0.25 \\times 36 = 9\n$$\n$$\nh_{F_3} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_3}^2 = 0.3535533906 \\times 10^2 = 35.35533906\n$$\nThe sum of the facet contributions is:\n$$\n16 + 9 + 35.35533906 = 60.35533906\n$$\n\nAdding all three terms gives the squared local indicator:\n$$\n\\eta_{K_0}^2 = 25 + 9 + 60.35533906 = 94.35533906\n$$\nThe local indicator $\\eta_{K_0}$ is the square root of this value:\n$$\n\\eta_{K_0} = \\sqrt{94.35533906} \\approx 9.71366750\n$$\nRounding to four significant figures gives $9.714$.",
            "answer": "$$\\boxed{9.714}$$"
        }
    ]
}