{
    "hands_on_practices": [
        {
            "introduction": "HDG方法的效率源于其在局部消除内部变量的能力，这一过程称为静态凝聚。本实践练习旨在通过亲手推导，让学生对这一过程有更根本的理解。通过考虑最简单的情形，即在单个单元上使用最低阶元 $\\mathbb{P}_0$，你将看到局部HDG方程如何被解析求解，从而将内部解完全用边界上的迹变量和源项表达出来，进而揭示局部求解器的核心机制。",
            "id": "3410467",
            "problem": "考虑单个四面体单元 $K \\subset \\mathbb{R}^{3}$ 上的稳态扩散模型的混合形式，其边界为 $\\partial K = \\bigcup_{i=1}^{4} F_{i}$，各个面 $F_i$ 上的外单位法向量为 $\\boldsymbol{n}_{i}$：\n$$\n\\kappa^{-1} \\,\\boldsymbol{q} + \\nabla u = \\boldsymbol{0}, \n\\qquad \\nabla \\cdot \\boldsymbol{q} = f \\quad \\text{in } K,\n$$\n其中传导系数 $\\kappa>0$ 在 $K$ 上为常数，$f \\in L^{2}(K)$ 是给定的源项。令 $|K|$ 表示 $K$ 的体积，$|F_{i}|$ 表示面 $F_{i}$ 的面积，$\\boldsymbol{n}_{i}$ 表示 $F_{i}$ 的外单位法向量。\n\n在 $K$ 上采用阶数 $k=0$ 的混合可杂交间断伽辽金 (HDG) 方法，即分别取局部逼近空间 $\\boldsymbol{V}_{h}(K) = [\\mathbb{P}_{0}(K)]^{3}$ 和 $W_{h}(K) = \\mathbb{P}_{0}(K)$ 用于逼近通量 $\\boldsymbol{q}_{h}$ 和标量 $u_{h}$，并取迹空间 $M_{h}(F_{i}) = \\mathbb{P}_{0}(F_{i})$ 用于逼近每个面 $F_i$ 上的小面未知量 $\\widehat{u}_{i}$。设稳定化参数 $\\tau_{i} > 0$ 在每个面 $F_{i}$ 上为常数。面 $F_i$ 上的数值法向通量定义为\n$$\n\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} \\;=\\; \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} \\;+\\; \\tau_{i}\\,\\big(u_{h} - \\widehat{u}_{i}\\big).\n$$\n$K$ 上的局部HDG方程为：给定小面数据 $\\widehat{u}_{i} \\in M_{h}(F_{i})$（$i \\in \\{1,2,3,4\\}$），求解 $(\\boldsymbol{q}_{h}, u_{h}) \\in \\boldsymbol{V}_{h}(K) \\times W_{h}(K)$，使得对于所有 $\\boldsymbol{r} \\in \\boldsymbol{V}_{h}(K)$ 和 $w \\in W_{h}(K)$，\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} - \\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} + \\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0,\n$$\n$$\n-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} + \\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K},\n$$\n其中 $\\widehat{u}_{h}|_{F_{i}} = \\widehat{u}_{i}$ 且 $\\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}$ 如上定义。这里 $(\\cdot,\\cdot)_{K}$ 是 $L^{2}(K)$ 内积，$\\langle \\cdot, \\cdot \\rangle_{\\partial K}$ 是 $L^{2}(\\partial K)$ 对偶配对。\n\n仅使用基本定义和恒等式，推导 $K$ 上的显式局部求解算子，该算子将四个小面迹常数 $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ 和源项 $f$ 映射到两个单元未知量 $(\\boldsymbol{q}_{h}, u_{h})$。将您关于 $(\\boldsymbol{q}_{h}, u_{h})$ 的最终结果仅用 $\\kappa$、 $|K|$、$\\{|F_{i}|\\}_{i=1}^{4}$、$\\{\\boldsymbol{n}_{i}\\}_{i=1}^{4}$、$\\{\\tau_{i}\\}_{i=1}^{4}$、$\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ 和 $\\int_{K} f \\, dx$ 来表示。您的最终答案必须是单个闭式解析表达式。不要进行任何数值计算。",
            "solution": "该问题要求在单个四面体单元 $K$ 上，为阶数 $k=0$ 的混合可杂交间断伽辽金 (HDG) 方法推导显式的局部求解算子。该算子将每个面上的常数迹值 $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ 和源函数 $f$ 映射到单元上为常数的未知量 $(\\boldsymbol{q}_{h}, u_{h})$。\n\n局部逼近空间为 $\\boldsymbol{V}_{h}(K) = [\\mathbb{P}_{0}(K)]^{3}$ 和 $W_{h}(K) = \\mathbb{P}_{0}(K)$。这意味着近似通量 $\\boldsymbol{q}_{h}$ 在 $K$ 上是一个常向量，近似标量解 $u_{h}$ 在 $K$ 上是一个常标量。类似地，检验函数 $\\boldsymbol{r} \\in \\boldsymbol{V}_{h}(K)$ 和 $w \\in W_{h}(K)$ 分别是一个常向量和一个常标量。\n\n让我们分析所提供的两个局部HDG方程。\n\n第一个方程是：\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} - \\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} + \\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0, \\quad \\forall \\boldsymbol{r} \\in [\\mathbb{P}_{0}(K)]^{3}\n$$\n由于 $\\boldsymbol{r}$ 是 $K$ 上的常向量，其散度恒等于零：$\\nabla \\cdot \\boldsymbol{r} = 0$。因此，第二项 $\\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} = 0$ 消失。\n\n剩下的项可以被简化。由于 $\\kappa^{-1}$、$\\boldsymbol{q}_{h}$ 和 $\\boldsymbol{r}$ 在 $K$ 上是常数，第一项为：\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} = \\int_{K} \\kappa^{-1} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{r} \\, dx = \\kappa^{-1} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{r}) |K|\n$$\n边界项是四面体四个面 $F_{i}$ 上的和：\n$$\n\\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = \\sum_{i=1}^{4} \\int_{F_{i}} \\widehat{u}_{h} (\\boldsymbol{r} \\cdot \\boldsymbol{n}_{i}) \\, dS\n$$\n在每个面 $F_i$ 上，迹近似 $\\widehat{u}_{h}$ 是一个常数 $\\widehat{u}_{i} \\in \\mathbb{P}_{0}(F_{i})$。检验函数 $\\boldsymbol{r}$ 和法向量 $\\boldsymbol{n}_{i}$ 在 $F_i$ 上也为常数。因此，该积分变为：\n$$\n\\sum_{i=1}^{4} \\widehat{u}_{i} (\\boldsymbol{r} \\cdot \\boldsymbol{n}_{i}) |F_{i}| = \\boldsymbol{r} \\cdot \\left( \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right)\n$$\n将这些简化后的项代回第一个HDG方程，得到：\n$$\n\\kappa^{-1} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{r}) |K| + \\boldsymbol{r} \\cdot \\left( \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right) = 0\n$$\n$$\n\\boldsymbol{r} \\cdot \\left( \\kappa^{-1} |K| \\boldsymbol{q}_{h} + \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right) = 0\n$$\n这个方程必须对任意常向量 $\\boldsymbol{r} \\in [\\mathbb{P}_{0}(K)]^{3}$ 成立。这意味着括号中的项必须是零向量：\n$$\n\\kappa^{-1} |K| \\boldsymbol{q}_{h} + \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} = \\boldsymbol{0}\n$$\n求解 $\\boldsymbol{q}_{h}$ 得到局部求解算子的第一部分：\n$$\n\\boldsymbol{q}_{h} = - \\frac{\\kappa}{|K|} \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i}\n$$\n\n第二个HDG方程是：\n$$\n-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} + \\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K}, \\quad \\forall w \\in \\mathbb{P}_{0}(K)\n$$\n由于检验函数 $w$ 是 $K$ 上的常标量，其梯度恒等于零：$\\nabla w = \\boldsymbol{0}$。因此，第一项 $-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} = 0$ 消失。\n\n方程简化为：\n$$\n\\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K}\n$$\n由于 $w$ 是常数，可以将其从积分中提出：\n$$\nw \\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = w \\int_{K} f \\, dx\n$$\n假设 $w \\neq 0$，我们可以两边同除以 $w$ 得到数值通量的守恒陈述：\n$$\n\\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = \\int_{K} f \\, dx\n$$\n让我们使用数值通量的定义 $\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} = \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})$ 来展开左手边：\n$$\n\\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = \\sum_{i=1}^{4} \\int_{F_{i}} \\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} \\, dS = \\sum_{i=1}^{4} \\int_{F_{i}} \\big(\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})\\big) \\, dS\n$$\n由于 $\\boldsymbol{q}_{h}$、$u_{h}$、$\\tau_{i}$ 和 $\\widehat{u}_{i}$ 在它们各自的定义域上是常数，该积分变为：\n$$\n\\sum_{i=1}^{4} \\big(\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})\\big) |F_{i}| = \\left( \\sum_{i=1}^{4} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i}) |F_{i}| \\right) + \\left( \\sum_{i=1}^{4} \\tau_{i}(u_{h} - \\widehat{u}_{i}) |F_{i}| \\right)\n$$\n第一个求和项可以重写为 $\\int_{\\partial K} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} \\, dS$。由于 $\\boldsymbol{q}_{h}$ 是一个常向量，我们可以应用散度定理：\n$$\n\\sum_{i=1}^{4} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i}) |F_{i}| = \\int_{\\partial K} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} \\, dS = \\int_{K} \\nabla \\cdot \\boldsymbol{q}_{h} \\, dx\n$$\n由于 $\\boldsymbol{q}_{h}$ 是常数，$\\nabla \\cdot \\boldsymbol{q}_{h} = 0$，所以此项为零。这对 $\\mathbb{P}_{0}$ 单元来说是一个关键的简化。\n\n因此，守恒方程简化为：\n$$\n\\sum_{i=1}^{4} \\tau_{i}(u_{h} - \\widehat{u}_{i}) |F_{i}| = \\int_{K} f \\, dx\n$$\n我们现在可以求解常标量未知量 $u_{h}$：\n$$\n\\sum_{i=1}^{4} \\tau_{i} u_{h} |F_{i}| - \\sum_{i=1}^{4} \\tau_{i} \\widehat{u}_{i} |F_{i}| = \\int_{K} f \\, dx\n$$\n$$\nu_{h} \\left( \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\right) = \\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}\n$$\n由于 $\\tau_i > 0$ 且 $|F_i| > 0$，括号中的和是严格为正的。求解 $u_{h}$ 得到局部求解算子的第二部分：\n$$\nu_{h} = \\frac{\\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}}{\\sum_{j=1}^{4} \\tau_{j} |F_{j}|}\n$$\n（为清晰起见，分母中使用了不同的求和索引 $j$。）\n\n结合 $\\boldsymbol{q}_{h}$ 和 $u_{h}$ 的表达式，我们获得了将 $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ 和 $f$ 映射到 $(\\boldsymbol{q}_{h}, u_{h})$ 的显式局部求解算子。",
            "answer": "$$\n\\boxed{\\left( -\\frac{\\kappa}{|K|} \\sum_{i=1}^{4} |F_{i}| \\widehat{u}_{i} \\boldsymbol{n}_{i}, \\quad \\frac{\\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}}{\\sum_{j=1}^{4} \\tau_{j} |F_{j}|} \\right)}\n$$"
        },
        {
            "introduction": "有限元方法的一个关键优势是能够通过后验误差估计来评估和控制误差，这对于自适应仿真是至关重要的。本实践练习将指导你为HDG方法构建并应用一个基于残差的误差估计器。你将学习如何识别误差的来源——即单元内部的残差和跨小平面边界的跳跃项——并将它们组合成一个可计算的指标，最后将你的公式应用于一个具体的数值算例。",
            "id": "3410464",
            "problem": "考虑在一个有界、单连通的多边形区域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的标量泊松问题，其带有齐次狄利克雷边界条件：寻找 $u \\in H_{0}^{1}(\\Omega)$ 使得在 $\\Omega$ 中有 $-\\Delta u = f$，其中 $f \\in L^{2}(\\Omega)$。引入一阶系统 $q + \\nabla u = 0$ 和 $\\nabla \\cdot q = f$。令 $\\mathcal{T}_{h}$ 为 $\\Omega$ 的一个形状正则的协调三角剖分，剖分成的三角形单元直径为 $\\{h_{K}\\}_{K \\in \\mathcal{T}_{h}}$，边长为 $\\{h_{F}\\}_{F \\in \\mathcal{F}_{h}}$，其中 $\\mathcal{F}_{h}$ 是所有开边的集合。\n\n在 $\\mathcal{T}_{h}$ 上，考虑可杂交间断Galerkin (HDG) 方法，其局部未知量 $(q_{h},u_{h})$ 在每个 $K \\in \\mathcal{T}_{h}$ 上的分片多项式空间中，全局杂交迹 $\\hat{u}_{h}$ 在网格骨架 $\\mathcal{F}_{h}$ 上，并且在每个 $F \\in \\mathcal{F}_{h}$ 上有稳定化参数 $\\tau_{F} > 0$。假设执行了静态凝聚，使得全局线性系统只涉及杂交迹自由度，而单元场 $(q_{h},u_{h})$ 是局部恢复的。\n\n你的任务如下。\n\n1. 从一阶系统和局部HDG方程出发，构造一个基于单元残差的后验误差估计子，它只使用：\n   - 强形式方程的单元残差，以及\n   - 离散通量法向分量的面跳跃。\n   该估计子必须完全用可计算量 $(q_{h},u_{h},\\hat{u}_{h})$、数据 $f$ 以及网格尺度 $h_{K}$ 和 $h_{F}$ 来定义。使用依赖于网格的权重以确保各项贡献是平衡且量纲一致的。清晰地陈述你所使用的所有残差和跳跃项的定义。\n\n2. 在标准假设下（形状正则的网格、多项式次数至少为一，以及 $f \\in L^{2}(\\Omega)$），论证你的估计子在数据振荡项的意义下是可靠的和局部高效的。具体来说，为HDG混合格式设定下的误差定义一个自然的能量范数，并从第一性原理和标准不等式出发，论证全局估计子从上方控制能量误差，并且每个局部估计子在数据振荡项的意义下从下方控制局部误差。你的论证应指出气泡函数、逆不等式和HDG方法局部稳定性的作用。解释为什么静态凝聚不会损害可计算性或后验界限的有效性。\n\n3. 现在具体到一个单元 $K_{0} \\in \\mathcal{T}_{h}$，其直径为 $h_{K_{0}} = 0.25$。假设 $K_{0}$ 有三条边 $F_{1}$、$F_{2}$ 和 $F_{3}$，其长度分别为 $h_{F_{1}} = 0.25$、$h_{F_{2}} = 0.25$ 和 $h_{F_{3}} = 0.3535533906$。假设你的估计子中相关量的以下单元和边上的 $L^{2}$-范数已被计算出来：\n   - $\\|f + \\nabla \\cdot q_{h}\\|_{0,K_{0}} = 12$，\n   - $\\|q_{h} + \\nabla u_{h}\\|_{0,K_{0}} = 5$，\n   - $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{1}} = 8$，$\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{2}} = 6$，以及 $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{3}} = 10$，\n   其中 $\\|\\cdot\\|_{0,D}$ 表示区域 $D$ 上的 $L^{2}$-范数，$n$ 是单位外法向量，而 $\\llbracket \\cdot \\rrbracket$ 表示跨内部面的跳跃（如果 $F$ 是边界上的面 $F \\subset \\partial \\Omega$，则等于其上的迹）。使用任务1中你的估计子，计算 $K_{0}$ 的局部指示子，记为 $\\eta_{K_{0}}$。将最终数值答案四舍五入到四位有效数字。不需要单位，你的答案必须是一个实数。",
            "solution": "首先将根据科学合理性、适定性和客观性的标准对问题进行验证。\n\n### 步骤1：提取已知条件\n已知条件如下：\n- **问题**：在区域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的标量泊松方程 $-\\Delta u = f$，边界条件为 $u = 0$ on $\\partial\\Omega$。源项为 $f \\in L^{2}(\\Omega)$。\n- **一阶系统**：$q + \\nabla u = 0$ 和 $\\nabla \\cdot q = f$。\n- **离散化**：$\\Omega$ 的一个形状正则的协调三角剖分 $\\mathcal{T}_{h}$。\n- **方法**：一个可杂交间断Galerkin (HDG) 方法，具有局部未知量 $(q_{h}, u_{h})$、全局杂交迹 $\\hat{u}_{h}$ 和稳定化参数 $\\tau_{F} > 0$。采用了静态凝聚。\n- **任务1**：使用单元残差 $(f + \\nabla \\cdot q_{h}, q_{h} + \\nabla u_{h})$ 和法向通量的面跳跃 $\\llbracket q_{h} \\cdot n \\rrbracket$ 构造一个基于残差的后验误差估计子。\n- **任务2**：论证估计子的可靠性和局部高效性，并解释静态凝聚的作用。\n- **任务3数据**：对于一个特定单元 $K_{0}$：\n    - 单元直径给定为 $h_{K_{0}} = 0.25$。\n    - 边长为 $h_{F_{1}} = 0.25$，$h_{F_{2}} = 0.25$ 和 $h_{F_{3}} = 0.3535533906$。\n    - 单元残差1的范数：$\\|f + \\nabla \\cdot q_{h}\\|_{0,K_{0}} = 12$。\n    - 单元残差2的范数：$\\|q_{h} + \\nabla u_{h}\\|_{0,K_{0}} = 5$。\n    - 面跳跃残差的范数：$\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{1}} = 8$，$\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{2}} = 6$，$\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{3}} = 10$。\n- **定义**：跳跃算子 $\\llbracket \\cdot \\rrbracket$ 在内部面上是标准跳跃，在边界上则定义为迹本身。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据、适定且客观。它涉及偏微分方程数值分析中的一个标准课题，即HDG方法的后验误差估计。理论和计算任务定义清晰，并基于既定原则。\n\n然而，任务3提供的数据存在一个微小的不一致之处。三角形的直径是其最长边的长度。对于单元 $K_0$，给定的边长为 $h_{F_1} = 0.25$，$h_{F_2} = 0.25$ 和 $h_{F_3} \\approx 0.35355$。最长的边是 $F_3$，所以 $K_0$ 的几何直径是 $h_{F_3} \\approx 0.35355$。然而，问题陈述明确给出了“直径 $h_{K_{0}} = 0.25$”。这是一个矛盾。在有限元分析的背景下，$h_K$ 是单元K的一个特征长度尺度，它通常但不必然是其几何直径。由于问题为符号 $h_{K_0}$ 提供了明确的值，尽管术语上不精确，我们仍应将其视为计算的定义。这并不会使问题无效，因为一个可解的程序依然存在。因此，该问题被视为有效，并将提供解答。\n\n### 解答\n\n解答分为三部分，与问题陈述中的任务相对应。\n\n**1. 后验误差估计子的构造**\n\n后验误差估计子提供了一个可计算的量来度量离散化误差。对于给定的一阶系统，我们寻求一个关于误差 $(e_q, e_u) = (q-q_h, u-u_h)$ 的估计子。该估计子应由数值解 $(q_h, u_h, \\hat{u}_h)$ 中可用的量构造。问题指定使用强形式残差和通量跳跃。\n\n精确解 $(q, u)$ 满足：\n$$\nq + \\nabla u = 0 \\quad \\text{在 } K \\text{ 内}\n$$\n$$\n\\nabla \\cdot q = f \\quad \\text{在 } K \\text{ 内}\n$$\n对于每个单元 $K \\in \\mathcal{T}_h$。离散解 $(q_h, u_h)$ 近似于此，但并不精确满足这些方程。这就产生了单元残差。此外，精确通量 $q$ 的法向分量在单元边界上是连续的，即 $\\llbracket q \\cdot n \\rrbracket = 0$，而对于离散通量 $q_h$ 则不然。这就产生了一个面残差。\n\n我们定义以下残差：\n- 第一个方程的内部单元残差是 $R_{K,1} := q_h + \\nabla u_h$。\n- 第二个方程的内部单元残差是 $R_{K,2} := f - \\nabla \\cdot q_h$。\n- 边 $F$ 上的面残差是通量法向分量的跳跃，$J_F := \\llbracket q_h \\cdot n \\rrbracket$。问题陈述澄清了，对于内部边 $F = \\partial K_1 \\cap \\partial K_2$，法向量 $n$ 从 $K_1$ 指向 $K_2$，$J_F = (q_h|_{K_1} - q_h|_{K_2}) \\cdot n$。对于属于单元 $K$ 的边界边 $F \\subset \\partial\\Omega$，$J_F = q_h|_K \\cdot n$。\n\n为构造估计子，我们必须将这些残差与适当的权重相结合以确保量纲一致性。令 $[u]$ 为解 $u$ 的物理单位，$[L]$ 为长度单位。那么 $[f] = [u][L]^{-2}$ 且 $[q] = [u][L]^{-1}$。误差的能量范数是无量纲的或具有能量单位，但其平方的单位是 $\\|q\\|^2 \\sim [u]^2$。\n- $\\|R_{K,1}\\|_{0,K}^2 = \\|q_h + \\nabla u_h\\|_{0,K}^2$ 的单位是 $([u][L]^{-1})^2 [L]^2 = [u]^2$。\n- $\\|R_{K,2}\\|_{0,K}^2 = \\|f - \\nabla \\cdot q_h\\|_{0,K}^2$ 的单位是 $([u][L]^{-2})^2 [L]^2 = [u]^2[L]^{-2}$。这必须乘以一个单位为 $[L]^2$ 的因子，即 $h_K^2$。\n- $\\|J_F\\|_{0,F}^2 = \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F}^2$ 的单位是 $([u][L]^{-1})^2 [L] = [u]^2[L]^{-1}$。这必须乘以一个单位为 $[L]$ 的因子，即 $h_F$。\n\n基于此分析，我们定义每个单元 $K \\in \\mathcal{T}_h$ 的局部误差指示子 $\\eta_K$ 为：\n$$\n\\eta_{K}^2 := \\|q_h + \\nabla u_h\\|_{0,K}^2 + h_{K}^2 \\|f - \\nabla \\cdot q_h\\|_{0,K}^2 + \\sum_{F \\subset \\partial K} h_{F} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F}^2\n$$\n全局误差估计子 $\\eta$ 则是局部指示子的欧几里得和：\n$$\n\\eta := \\left( \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 \\right)^{1/2}\n$$\n注意，问题提供了 $f + \\nabla \\cdot q_h$ 的范数，这等价于我们定义的残差 $R_{K,2}$ 的范数，因为 $\\|R_{K,2}\\|_{0,K} = \\|-(f-\\nabla \\cdot q_h)\\|_{0,K} = \\| \\nabla \\cdot q_h-f\\|_{0,K}$。问题数据似乎将残差命名为 $f+\\nabla \\cdot q_h$，但这不影响范数。为了计算的目的，$\\|f - \\nabla \\cdot q_h\\|_{0,K_0} = \\|f + \\nabla \\cdot q_h\\|_{0,K_0} = 12$。\n\n**2. 可靠性、高效性与静态凝聚**\n\n在此混合格式设定下，误差 $(e_q, e_u)=(q-q_h, u-u_h)$ 的一个自然能量范数由下式给出\n$$\n\\|(e_q, e_u)\\|_{\\text{en}}^2 := \\|q-q_h\\|_{0,\\Omega}^2 + \\sum_{K \\in \\mathcal{T}_h} \\|\\nabla(u-u_h)\\|_{0,K}^2\n$$\n这结合了通量的 $L^2$ 误差和主变量的破碎 $H^1$ 半范数误差。\n\n- **可靠性**：如果估计子提供了真实误差的一个上界（在数据振荡项的意义下），那么它就是可靠的。即，\n$$\n\\|(e_q, e_u)\\|_{\\text{en}} \\le C_{\\text{rel}} \\left( \\eta + \\text{osc} \\right)\n$$\n其中 $C_{\\text{rel}}$ 是一个与网格尺寸 $h$ 无关的常数，而 $\\text{osc}$ 代表数据振荡项（例如，$h_K \\|f - \\Pi_k f\\|_{0,K}$，其中 $\\Pi_k f$ 是 $f$ 的一个多项式逼近）。可靠性的论证源于误差方程。通过用与误差本身相关的适当函数（例如，插值函数）来测试误差方程的弱形式，并使用分部积分（格林公式），误差范数可以与单元和面残差的总和联系起来。证明中的关键工具是柯西-施瓦茨不等式、用于界定边界项的迹不等式以及单元上的庞加莱不等式。HDG格式的稳定性，由参数 $\\tau_F$ 的选择所保证（通常 $\\tau_F \\sim h_F^{-1}$），对于控制所有出现的项至关重要。\n\n- **局部高效性**：如果局部指示子被局部单元片上的误差所控制（在数据振荡项的意义下），那么该估计子是局部高效的。对每个单元 $K$，\n$$\n\\eta_K \\le C_{\\text{eff}} \\left( \\|(e_q, e_u)\\|_{\\text{en}, \\omega_K} + \\text{osc}_K \\right)\n$$\n其中 $\\omega_K$ 是包含 $K$ 及其邻居的单元片，而 $\\text{osc}_K$ 是局部数据振荡。高效性的证明依赖于气泡函数。例如，为了界定单元残差 $h_K \\|f - \\nabla \\cdot q_h\\|_{0,K}$，可以构造一个合适的单元气泡函数 $b_K$。通过利用这些气泡函数的性质和有限维空间上的逆不等式（例如，$\\|v_h\\|_{0,K} \\le C h_K^{-1} \\|v_h\\|_{-1,K}$），可以证明残差项被局部误差所界定。一个使用边气泡函数的类似论证适用于面跳跃项。HDG方法的局部稳定性确保了非零残差意味着非零的局部误差。\n\n- **静态凝聚的作用**：静态凝聚是一种求解由HDG格式产生的全局线性系统的代数技术。它将自由度划分为单元局部变量 $((q_h)_K, (u_h)_K)$ 和全局耦合的界面变量 $(\\hat{u}_h)_{\\mathcal{F}_h}$。局部变量用界面变量表示，并从全局系统中消去，之后该系统仅涉及 $\\hat{u}_h$。在解出这个较小系统的 $\\hat{u}_h$ 之后，局部变量 $(q_h, u_h)$ 通过一个局部的回代过程逐单元地被恢复出来。\n\n至关重要的是，这个过程在数学上等同于求解完整的、未凝聚的整体系统。得到的离散解 $(q_h, u_h, \\hat{u}_h)$ 是相同的。后验误差估计子 $\\eta$ 是这个计算解的函数。由于解本身不受求解器选择（凝聚与整体）的影响，静态凝聚不损害后验界限的有效性。事实上，它正是允许估计子进行实际计算的机制：在全局求解 $\\hat{u}_h$ 之后，人们*必须*恢复局部场 $(q_h, u_h)$ 来评估构成 $\\eta_K$ 的残差。静态凝聚提供了完成这一任务的显式局部问题。\n\n**3. 数值计算**\n\n我们现在为指定的单元 $K_0$ 计算局部误差指示子 $\\eta_{K_0}$。指示子平方的公式是：\n$$\n\\eta_{K_0}^2 = \\|q_h + \\nabla u_h\\|_{0,K_0}^2 + h_{K_0}^2 \\|f + \\nabla \\cdot q_h\\|_{0,K_0}^2 + \\sum_{i=1}^{3} h_{F_i} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_i}^2\n$$\n给定以下数值：\n- $\\|q_h + \\nabla u_h\\|_{0,K_0} = 5$\n- $h_{K_0} = 0.25$\n- $\\|f + \\nabla \\cdot q_h\\|_{0,K_0} = 12$\n- $h_{F_1} = 0.25$ 和 $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_1} = 8$\n- $h_{F_2} = 0.25$ 和 $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_2} = 6$\n- $h_{F_3} = 0.3535533906$ 和 $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_3} = 10$\n\n我们将这些值代入公式。\n\n第一项（本构关系的残差）的平方是：\n$$\n\\|q_h + \\nabla u_h\\|_{0,K_0}^2 = 5^2 = 25\n$$\n\n第二项（守恒律的残差）的平方是：\n$$\nh_{K_0}^2 \\|f + \\nabla \\cdot q_h\\|_{0,K_0}^2 = (0.25)^2 \\times 12^2 = 0.0625 \\times 144 = 9\n$$\n\n第三项（加权面跳跃残差之和）计算如下：\n- 来自边 $F_1$ 的贡献：$h_{F_1} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_1}^2 = 0.25 \\times 8^2 = 0.25 \\times 64 = 16$。\n- 来自边 $F_2$ 的贡献：$h_{F_2} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_2}^2 = 0.25 \\times 6^2 = 0.25 \\times 36 = 9$。\n- 来自边 $F_3$ 的贡献：$h_{F_3} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_3}^2 = 0.3535533906 \\times 10^2 = 35.35533906$。\n\n面贡献的总和是：\n$$\n16 + 9 + 35.35533906 = 60.35533906\n$$\n\n将所有三项相加，得到局部指示子的平方：\n$$\n\\eta_{K_0}^2 = 25 + 9 + 60.35533906 = 94.35533906\n$$\n局部指示子 $\\eta_{K_0}$ 是这个值的平方根：\n$$\n\\eta_{K_0} = \\sqrt{94.35533906} \\approx 9.71366750\n$$\n四舍五入到四位有效数字，我们得到 $9.714$。",
            "answer": "$$\\boxed{9.714}$$"
        }
    ]
}