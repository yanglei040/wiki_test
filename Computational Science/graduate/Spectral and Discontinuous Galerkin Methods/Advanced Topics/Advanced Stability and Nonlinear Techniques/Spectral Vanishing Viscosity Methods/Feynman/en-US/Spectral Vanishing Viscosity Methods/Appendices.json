{
    "hands_on_practices": [
        {
            "introduction": "Spectral Vanishing Viscosity is most naturally defined in a modal basis, where it acts as a simple scaling of the coefficients of high-degree basis polynomials. However, many modern high-order methods, such as nodal Discontinuous Galerkin (DG) schemes, operate in a nodal basis for efficiency. This first exercise guides you through the fundamental mechanics of translating the SVV operator from the modal world to the nodal world, a crucial step for practical implementation. By explicitly constructing the nodal SVV matrix and examining its eigenvalues, you will directly verify the method's core principle: the selective damping of high-frequency content .",
            "id": "3419879",
            "problem": "Consider a one-dimensional reference element $[-1,1]$ equipped with the Gauss–Lobatto–Legendre (GLL) nodes and the polynomial space $\\mathbb{P}_{p}$ of degree at most $p$, where $p=6$. In a nodal Discontinuous Galerkin (DG) method using GLL nodes, define a Spectral Vanishing Viscosity (SVV) operator by acting on the modal Legendre polynomial basis $\\{P_{k}(x)\\}_{k=0}^{p}$ through the Sturm–Liouville Legendre operator $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})\\frac{\\mathrm{d}}{\\mathrm{d}x}\\right]$, and applying a spectral cutoff at the modal index $m_{p}=3$ with a smooth kernel $Q(k)$ that is zero on low modes and rises quadratically on high modes. Specifically, take\n$$\nQ(k)=\\begin{cases}\n0, & k\\leq m_{p}, \\\\\n\\left(\\dfrac{k-m_{p}}{p-m_{p}}\\right)^{2}, & k> m_{p}\n\\end{cases}\n$$\nand scale the viscosity with the polynomial degree as $\\nu_{p}=\\nu_{0}/p$, with $\\nu_{0}=1$. The SVV operator is defined on modal coefficients by\n$$\\mathcal{A}_{p} P_{k}=\\nu_{p}\\,Q(k)\\,k(k+1)\\,P_{k},\\quad k=0,1,\\dots,p,$$\nso that in the modal Legendre basis its matrix is diagonal with entries $\\lambda_{k}=\\nu_{p}\\,Q(k)\\,k(k+1)$. Let the GLL nodal basis be the Lagrange polynomials $\\{l_{i}(x)\\}_{i=0}^{p}$ associated with the GLL nodes $\\{x_{i}\\}_{i=0}^{p}$, and denote by $V$ the Vandermonde-like evaluation matrix with entries $V_{i,k}=P_{k}(x_{i})$.\n\n(a) Using only the properties of Legendre polynomials and the definition of the SVV operator above, construct explicitly the discrete SVV matrix in the GLL nodal basis as a similarity transform of the diagonal modal matrix, and explain why the eigenvalues of the nodal SVV matrix coincide with the diagonal entries $\\lambda_{k}$.\n\n(b) For $p=6$, $m_{p}=3$, and $\\nu_{0}=1$, compute the seven eigenvalues $\\{\\lambda_{k}\\}_{k=0}^{6}$ exactly to verify that only the high-degree modal subspace is damped. Express your final answer as an exact analytical row matrix and do not round.",
            "solution": "The problem first requires the construction of the discrete Spectral Vanishing Viscosity (SVV) matrix in the Gauss–Lobatto–Legendre (GLL) nodal basis and an explanation for why its eigenvalues are the given modal values $\\lambda_k$. Second, it asks for the explicit computation of these eigenvalues for the specified parameters.\n\nThe problem is scientifically grounded, well-posed, and contains all necessary information for its resolution. It is a standard problem in the field of numerical methods for partial differential equations, specifically concerning stabilization techniques for spectral methods. Thus, the problem is deemed valid.\n\nPart (a): Construction of the Nodal SVV Matrix and Eigenvalue Analysis\n\nLet the space of polynomials of degree at most $p$ be denoted by $\\mathbb{P}_{p}$. Any polynomial $u(x) \\in \\mathbb{P}_{p}$ can be represented in two different bases relevant to the problem: the modal Legendre basis and the nodal GLL basis.\n\n1.  **Modal Representation**: In the modal basis consisting of Legendre polynomials $\\{P_k(x)\\}_{k=0}^{p}$, the polynomial $u(x)$ is represented as a linear combination:\n    $$u(x) = \\sum_{k=0}^{p} \\hat{u}_k P_k(x)$$\n    The vector of modal coefficients is $\\mathbf{\\hat{u}} = (\\hat{u}_0, \\hat{u}_1, \\dots, \\hat{u}_p)^T \\in \\mathbb{R}^{p+1}$.\n\n2.  **Nodal Representation**: In the nodal basis consisting of Lagrange polynomials $\\{l_i(x)\\}_{i=0}^{p}$ associated with the GLL nodes $\\{x_i\\}_{i=0}^{p}$, the same polynomial $u(x)$ is represented by its values at these nodes:\n    $$u(x) = \\sum_{i=0}^{p} u_i l_i(x)$$\n    where $u_i = u(x_i)$. The vector of nodal values is $\\mathbf{u} = (u_0, u_1, \\dots, u_p)^T \\in \\mathbb{R}^{p+1}$.\n\nThe connection between these two representations is established by evaluating the modal expansion at the GLL nodes:\n$$u_i = u(x_i) = \\sum_{k=0}^{p} \\hat{u}_k P_k(x_i)$$\nThis system of linear equations can be written in matrix form. Let $V$ be the $(p+1) \\times (p+1)$ Vandermonde-like matrix with entries $V_{ik} = P_k(x_i)$. Then, the relationship between the nodal value vector $\\mathbf{u}$ and the modal coefficient vector $\\mathbf{\\hat{u}}$ is:\n$$\\mathbf{u} = V \\mathbf{\\hat{u}}$$\nSince the set of polynomials $\\{P_k(x)\\}_{k=0}^{p}$ forms a basis for $\\mathbb{P}_{p}$, the matrix $V$ is invertible. Therefore, we can transform from nodal values to modal coefficients using the inverse matrix $V^{-1}$:\n$$\\mathbf{\\hat{u}} = V^{-1} \\mathbf{u}$$\n\nThe SVV operator $\\mathcal{A}_p$ is defined by its action on the modal basis functions:\n$$\\mathcal{A}_p P_k = \\nu_p Q(k) k(k+1) P_k = \\lambda_k P_k$$\nThis definition implies that the Legendre polynomials $P_k(x)$ are the eigenfunctions of the operator $\\mathcal{A}_p$ with corresponding eigenvalues $\\lambda_k$. Consequently, the matrix representation of $\\mathcal{A}_p$ in the modal basis is a diagonal matrix $\\Lambda$ with the eigenvalues on its diagonal:\n$$\\Lambda = \\mathrm{diag}(\\lambda_0, \\lambda_1, \\dots, \\lambda_p)$$\nApplying the operator $\\mathcal{A}_p$ to a polynomial $u(x)$ with modal coefficients $\\mathbf{\\hat{u}}$ results in a new polynomial $v(x) = \\mathcal{A}_p u(x)$ whose modal coefficients are $\\mathbf{\\hat{v}} = \\Lambda \\mathbf{\\hat{u}}$.\n\nTo find the matrix representation of $\\mathcal{A}_p$ in the GLL nodal basis, which we will call $A_{nodal}$, we trace the transformation of a nodal vector $\\mathbf{u}$ under the action of the operator.\n1.  Start with a nodal vector $\\mathbf{u}$.\n2.  Transform it to its modal representation: $\\mathbf{\\hat{u}} = V^{-1} \\mathbf{u}$.\n3.  Apply the SVV operator in the modal basis, which is multiplication by $\\Lambda$: $\\mathbf{\\hat{v}} = \\Lambda \\mathbf{\\hat{u}} = \\Lambda V^{-1} \\mathbf{u}$.\n4.  Transform the resulting modal vector $\\mathbf{\\hat{v}}$ back to the nodal basis: $\\mathbf{v} = V \\mathbf{\\hat{v}} = V (\\Lambda V^{-1} \\mathbf{u})$.\n\nThe final nodal vector $\\mathbf{v}$ is related to the initial nodal vector $\\mathbf{u}$ by the matrix $A_{nodal}$:\n$$\\mathbf{v} = A_{nodal} \\mathbf{u}$$\nFrom the derivation above, we can identify the explicit form of the discrete SVV matrix in the GLL nodal basis:\n$$A_{nodal} = V \\Lambda V^{-1}$$\nThis construction expresses the nodal SVV matrix as a similarity transform of the diagonal modal matrix $\\Lambda$.\n\nAccording to a fundamental theorem of linear algebra, similar matrices possess the same set of eigenvalues. Since $A_{nodal}$ and $\\Lambda$ are similar, their eigenvalues must be identical. The matrix $\\Lambda$ is diagonal, and its eigenvalues are simply its diagonal entries. Therefore, the eigenvalues of the nodal SVV matrix $A_{nodal}$ are precisely $\\{\\lambda_k\\}_{k=0}^p$.\n\nPart (b): Computation of Eigenvalues\n\nWe are given the parameters $p=6$, $m_p=3$, and $\\nu_0=1$.\nFirst, we compute the viscosity parameter $\\nu_p$:\n$$\\nu_p = \\frac{\\nu_0}{p} = \\frac{1}{6}$$\nNext, we define the spectral kernel $Q(k)$ for $p=6$ and $m_p=3$:\n$$Q(k)=\\begin{cases}\n0, & k\\leq 3, \\\\\n\\left(\\dfrac{k-3}{6-3}\\right)^{2} = \\left(\\dfrac{k-3}{3}\\right)^{2}, & k>3.\n\\end{cases}$$\nThe eigenvalues are given by the formula $\\lambda_k = \\nu_p Q(k) k(k+1)$ for $k=0, 1, \\dots, 6$. We compute each eigenvalue:\n\nFor $k=0$: $Q(0)=0 \\implies \\lambda_0 = \\frac{1}{6} \\cdot 0 \\cdot 0(1) = 0$.\nFor $k=1$: $Q(1)=0 \\implies \\lambda_1 = \\frac{1}{6} \\cdot 0 \\cdot 1(2) = 0$.\nFor $k=2$: $Q(2)=0 \\implies \\lambda_2 = \\frac{1}{6} \\cdot 0 \\cdot 2(3) = 0$.\nFor $k=3$: $Q(3)=0 \\implies \\lambda_3 = \\frac{1}{6} \\cdot 0 \\cdot 3(4) = 0$.\nThese results show that the low-degree modal subspace (for $k \\leq m_p$) is unaffected by the SVV operator, as expected.\n\nFor $k=4$:\n$Q(4) = \\left(\\frac{4-3}{3}\\right)^2 = \\left(\\frac{1}{3}\\right)^2 = \\frac{1}{9}$.\n$\\lambda_4 = \\frac{1}{6} \\cdot Q(4) \\cdot 4(4+1) = \\frac{1}{6} \\cdot \\frac{1}{9} \\cdot (4 \\cdot 5) = \\frac{20}{54} = \\frac{10}{27}$.\n\nFor $k=5$:\n$Q(5) = \\left(\\frac{5-3}{3}\\right)^2 = \\left(\\frac{2}{3}\\right)^2 = \\frac{4}{9}$.\n$\\lambda_5 = \\frac{1}{6} \\cdot Q(5) \\cdot 5(5+1) = \\frac{1}{6} \\cdot \\frac{4}{9} \\cdot (5 \\cdot 6) = \\frac{4 \\cdot 30}{54} = \\frac{120}{54} = \\frac{20}{9}$.\n\nFor $k=6$:\n$Q(6) = \\left(\\frac{6-3}{3}\\right)^2 = \\left(\\frac{3}{3}\\right)^2 = 1^2 = 1$.\n$\\lambda_6 = \\frac{1}{6} \\cdot Q(6) \\cdot 6(6+1) = \\frac{1}{6} \\cdot 1 \\cdot (6 \\cdot 7) = \\frac{42}{6} = 7$.\n\nThe high-degree modes ($k>m_p$) receive non-zero damping that increases with the mode number, which is the intended effect of the SVV method. The complete set of eigenvalues $\\{\\lambda_k\\}_{k=0}^6$ is $\\{0, 0, 0, 0, \\frac{10}{27}, \\frac{20}{9}, 7\\}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & 0 & 0 & 0 & \\frac{10}{27} & \\frac{20}{9} & 7 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once SVV is implemented, the critical question becomes: how much viscosity should be applied? Choosing the SVV strength parameter, $\\nu_{h,p}$, is a key challenge, as excessive damping can degrade accuracy. This practice moves beyond ad-hoc tuning by demonstrating how to derive a scaling law for $\\nu_{h,p}$ based on physical principles . By balancing the characteristic timescales of advection and artificial diffusion at the limits of the numerical resolution, you will establish a rational foundation for selecting the SVV parameter that properly scales with the mesh size, $h$, and polynomial degree, $p$.",
            "id": "3419847",
            "problem": "Consider the one-dimensional linear advection equation with a constant advective speed $U$ on a periodic domain, discretized by a piecewise polynomial discontinuous Galerkin (DG) method of degree $p$ on elements of physical size $h$. To stabilize the solution and mimic small-scale physical dissipation only at the highest resolvable scales, a Spectral Vanishing Viscosity (SVV) term is added that acts like a diffusion operator on sufficiently high modal or Fourier content. Specifically, for a Fourier mode with wavenumber $k$, the SVV contribution produces an exponential decay with a rate proportional to $\\nu_{h,p}\\,k^{2}$, where $\\nu_{h,p}$ is the (constant) SVV strength applied to the high modes by the SVV kernel, and the kernel is assumed to equal $1$ at the cutoff wavenumber $k_{c}$.\n\nAdopt the following physically motivated resolution model: the smallest resolvable length scale per element is proportional to $h/p$, so that the corresponding cutoff wavenumber is $k_{c}\\approx \\pi p/h$. Using only fundamental balances and standard estimates, determine the explicit scaling of the SVV strength $\\nu_{h,p}$ with the element size $h$ and the polynomial degree $p$ such that the SVV mimics a target physical dissipation at the element resolution in the sense that the advective timescale and the diffusive timescale are equal at the cutoff wavenumber $k_{c}$.\n\nYour final answer must be a single closed-form analytic expression for $\\nu_{h,p}$ in terms of $U$, $h$, $p$, and numerical constants. No rounding is required and no units should be included in the final expression.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of numerical analysis for partial differential equations, specifically concerning discontinuous Galerkin methods and artificial viscosity for stabilization. The problem is well-posed, objective, and contains sufficient information to derive the requested scaling law. All components, such as the linear advection equation, the concept of spectral vanishing viscosity (SVV), and the model for modal resolution, are standard in the field.\n\nThe objective is to determine the scaling of the Spectral Vanishing Viscosity (SVV) strength, denoted as $\\nu_{h,p}$, with the element size $h$ and the polynomial degree $p$. The condition for this determination is that at the cutoff wavenumber $k_c$, the advective timescale must equal the diffusive timescale introduced by the SVV.\n\nFirst, let us define the relevant timescales.\n\nThe advective timescale, $\\tau_{adv}$, is related to the propagation of information by the advective velocity $U$. For a single Fourier mode with wavenumber $k$, represented as $\\exp(i(kx - \\omega t))$, the linear advection equation $\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = 0$ yields the dispersion relation $\\omega = Uk$. The angular frequency $\\omega$ represents the rate of phase change per unit time. The characteristic timescale associated with this process is the inverse of the angular frequency.\n$$\n\\tau_{adv}(k) = \\frac{1}{\\omega} = \\frac{1}{Uk}\n$$\nThis timescale represents the time required for the phase of the wave to change by one radian.\n\nThe diffusive timescale, $\\tau_{diff}$, is related to the dissipation of energy by the SVV mechanism. The problem states that the SVV acts as a diffusion operator for high-frequency modes, and the decay rate is proportional to $\\nu_{h,p}k^2$. This corresponds to a model equation of the form $\\frac{\\partial u}{\\partial t} = \\nu_{h,p} \\frac{\\partial^2 u}{\\partial x^2}$ for the high-frequency content of the solution. For a Fourier mode $\\exp(ikx)$, the diffusion operator acts as $\\frac{\\partial^2}{\\partial x^2} \\exp(ikx) = (ik)^2 \\exp(ikx) = -k^2 \\exp(ikx)$. Substituting this into the model equation for a solution of the form $u(x,t) = \\hat{u}(k) \\exp(-\\gamma t) \\exp(ikx)$, we get:\n$$\n-\\gamma \\hat{u}(k) = \\nu_{h,p} (-k^2) \\hat{u}(k)\n$$\nThis gives a temporal decay rate $\\gamma = \\nu_{h,p} k^2$. The diffusive timescale is the characteristic time for the amplitude of the mode to decay, which is the inverse of this decay rate.\n$$\n\\tau_{diff}(k) = \\frac{1}{\\gamma} = \\frac{1}{\\nu_{h,p} k^2}\n$$\n\nThe problem requires that these two timescales be equal at the cutoff wavenumber $k_c$. This creates a balance where, at the smallest resolvable scale, the advective and dissipative effects are of the same order of magnitude.\n$$\n\\tau_{adv}(k_c) = \\tau_{diff}(k_c)\n$$\nSubstituting the expressions for the timescales:\n$$\n\\frac{1}{U k_c} = \\frac{1}{\\nu_{h,p} k_c^2}\n$$\nWe can solve this equation for the SVV strength $\\nu_{h,p}$. Multiplying both sides by $\\nu_{h,p} U k_c^2$ gives:\n$$\n\\nu_{h,p} k_c = U\n$$\nThus, the required SVV strength is:\n$$\n\\nu_{h,p} = \\frac{U}{k_c}\n$$\n\nThe final step is to substitute the physically motivated resolution model provided in the problem for the cutoff wavenumber $k_c$. The problem states that the smallest resolvable length scale is proportional to $h/p$, which leads to a cutoff wavenumber $k_c \\approx \\pi p/h$. For the purpose of deriving the scaling law, we will use this expression as an equality:\n$$\nk_c = \\frac{\\pi p}{h}\n$$\nSubstituting this into our expression for $\\nu_{h,p}$:\n$$\n\\nu_{h,p} = \\frac{U}{\\frac{\\pi p}{h}}\n$$\nSimplifying this expression gives the final result for the scaling of the SVV strength:\n$$\n\\nu_{h,p} = \\frac{Uh}{\\pi p}\n$$\nThis result shows that the required artificial viscosity is proportional to the element size $h$ and the advective speed $U$, and inversely proportional to the polynomial degree $p$. This is a physically and numerically consistent result, as the artificial dissipation should decrease for finer meshes (smaller $h$) and higher-order approximations (larger $p$).",
            "answer": "$$\\boxed{\\frac{Uh}{\\pi p}}$$"
        },
        {
            "introduction": "The ultimate test of any numerical stabilization technique lies in its practical application, which often involves a delicate balancing act. We want to add just enough dissipation to control spurious oscillations without harming the accuracy of the physically relevant parts of the solution. This final exercise places you in a realistic scenario of calibrating an SVV scheme for an acoustics problem . By evaluating different parameter sets against quantitative metrics for stability and accuracy—namely the quality factor and frequency error—you will gain hands-on experience with the critical trade-offs inherent in using SVV methods.",
            "id": "3419895",
            "problem": "Consider a one-dimensional acoustic cavity modeled on a periodic domain of length $L$ (in meters), with speed of sound $c$ (in meters per second). The baseline dynamics are governed by the linear wave equation $\\partial_{tt} u = c^2 \\partial_{xx} u$. A Spectral Vanishing Viscosity (SVV) mechanism is introduced as an artificial damping term that selectively targets high-wavenumber content. In the Fourier representation, define the SVV operator as the modal damping applied to the time derivative:\n$$\n\\partial_{tt} \\widehat{u}(k,t) = - c^2 k^2 \\widehat{u}(k,t) - \\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2\\,\\partial_t \\widehat{u}(k,t),\n$$\nwhere $\\widehat{u}(k,t)$ is the Fourier mode at wavenumber $k$ (in radians per meter), $\\sigma_{\\mathrm{svv}}$ is the SVV amplitude (in square meters per second), and $\\phi(k)$ is a dimensionless filter function that vanishes at low wavenumbers and ramps up near the maximal resolved wavenumber. For a Fourier discretization with $N$ modes on a periodic domain of length $L$, the highest resolved wavenumber is\n$$\nk_{\\max} = \\frac{\\pi N}{L}.\n$$\nThe physical mode of interest is the fundamental mode\n$$\nk_{\\mathrm{phys}} = \\frac{2\\pi}{L},\n$$\nand a representative spurious mode is taken as the Nyquist mode\n$$\nk_{\\mathrm{spur}} = k_{\\max}.\n$$\nUse a ramp SVV filter parameterized by a cutoff $k_c$ and exponent $p$:\n$$\n\\phi(k) = \n\\begin{cases}\n0, & k \\le k_c, \\\\\n\\left(\\dfrac{k - k_c}{k_{\\max} - k_c}\\right)^{p}, & k > k_c\n\\end{cases}\n\\quad\\text{with}\\quad k_c = r\\,k_{\\max},\n$$\nwhere $r \\in [0,1)$ is the cutoff ratio. For each mode $k$, the resulting linear ordinary differential equation is a damped harmonic oscillator\n$$\n\\ddot{\\widehat{u}}_k + \\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2\\,\\dot{\\widehat{u}}_k + c^2 k^2 \\widehat{u}_k = 0.\n$$\nDefine the modal damping coefficient and undamped angular frequency as\n$$\n\\alpha_k = \\tfrac{1}{2}\\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2,\\qquad \\omega_k = c\\,|k|.\n$$\nFor the underdamped regime (i.e., $\\alpha_k < \\omega_k$), the modal quality factor $Q_k$ and damped angular frequency $\\omega_{d,k}$ are\n$$\nQ_k = \\frac{\\omega_k}{2\\alpha_k},\\qquad \\omega_{d,k} = \\sqrt{\\omega_k^2 - \\alpha_k^2}.\n$$\nWhen $\\phi(k) = 0$, interpret $Q_k$ as $+\\infty$ and $\\omega_{d,k} = \\omega_k$.\n\nCalibration goal: choose $\\sigma_{\\mathrm{svv}}$, $r$, and $p$ to suppress spurious cavity resonances while preserving the physical mode’s quality factor and accuracy. Quantify the trade-off by checking three conditions:\n- Spurious suppression: $Q_{\\mathrm{spur}} \\le Q_{\\max,\\mathrm{spur}}$.\n- Physical mode preservation: $Q_{\\mathrm{phys}} \\ge Q_{\\min}$.\n- Physical frequency accuracy: $\\left|\\omega_{d,\\mathrm{phys}} - \\omega_{\\mathrm{phys}}\\right|/\\omega_{\\mathrm{phys}} \\le \\varepsilon_{\\mathrm{tol}}$, using radians per second.\n\nAdditionally, require the physical mode to be underdamped: $\\alpha_{\\mathrm{phys}} < \\omega_{\\mathrm{phys}}$.\n\nConstants and units:\n- Domain length $L = 1\\,\\mathrm{m}$.\n- Speed of sound $c = 343\\,\\mathrm{m/s}$.\n- Quality factor thresholds: $Q_{\\min} = 200$ (dimensionless) and $Q_{\\max,\\mathrm{spur}} = 5$ (dimensionless).\n- Frequency accuracy tolerance: $\\varepsilon_{\\mathrm{tol}} = 0.01$ (dimensionless, fraction of relative error in radians per second).\n\nImplement a program that, for each test case below, computes a boolean indicating whether all four criteria are simultaneously satisfied:\n1. $N = 64$, $\\sigma_{\\mathrm{svv}} = 0.4\\,\\mathrm{m}^2/\\mathrm{s}$, $r = 0.8$, $p = 8$.\n2. $N = 64$, $\\sigma_{\\mathrm{svv}} = 0.05\\,\\mathrm{m}^2/\\mathrm{s}$, $r = 0.8$, $p = 8$.\n3. $N = 4$, $\\sigma_{\\mathrm{svv}} = 2.0\\,\\mathrm{m}^2/\\mathrm{s}$, $r = 0.1$, $p = 1$.\n4. $N = 64$, $\\sigma_{\\mathrm{svv}} = 0.35\\,\\mathrm{m}^2/\\mathrm{s}$, $r = 0.7$, $p = 6$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_i$ is a boolean. All frequencies must be treated in radians per second and lengths in meters as specified above. No external input is permitted; use the constants and test suite provided here.",
            "solution": "The problem requires the validation of four specific criteria for a spectral vanishing viscosity (SVV) damping scheme applied to a one-dimensional wave equation. For each test case, defined by a set of parameters $(N, \\sigma_{\\mathrm{svv}}, r, p)$, we must determine if all criteria are simultaneously satisfied.\n\nThe governing equation for a single Fourier mode $\\widehat{u}_k(t)$ is given as a damped harmonic oscillator:\n$$\n\\ddot{\\widehat{u}}_k + \\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2\\,\\dot{\\widehat{u}}_k + c^2 k^2 \\widehat{u}_k = 0.\n$$\nThis is of the standard form $\\ddot{x} + 2\\alpha \\dot{x} + \\omega_0^2 x = 0$, where the undamped angular frequency is $\\omega_k = c|k|$ and the damping coefficient is $\\alpha_k = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\phi(k)k^2$.\n\nThe validation process for each test case proceeds as follows:\n\nFirst, we calculate the key wavenumbers based on the provided parameters $N$ and the fixed domain length $L=1\\,\\mathrm{m}$:\nThe physical mode of interest has wavenumber $k_{\\mathrm{phys}} = \\frac{2\\pi}{L} = 2\\pi\\,\\mathrm{rad/m}$.\nThe numerical grid, with $N$ modes, supports a maximal resolved wavenumber $k_{\\max} = \\frac{\\pi N}{L} = N\\pi\\,\\mathrm{rad/m}$.\nThis maximal wavenumber is taken as a representative spurious mode, so $k_{\\mathrm{spur}} = k_{\\max}$.\nThe SVV filter function $\\phi(k)$ depends on a cutoff wavenumber $k_c = r\\,k_{\\max}$.\n\nSecond, we analyze the behavior of the physical mode, $k=k_{\\mathrm{phys}}$.\nThe undamped angular frequency of the physical mode is $\\omega_{\\mathrm{phys}} = c\\,k_{\\mathrm{phys}} = 343 \\cdot 2\\pi\\,\\mathrm{rad/s}$.\nThe SVV filter function $\\phi(k_{\\mathrm{phys}})$ is computed using its definition:\n$$\n\\phi(k_{\\mathrm{phys}}) = \n\\begin{cases}\n0, & k_{\\mathrm{phys}} \\le k_c \\\\\n\\left(\\dfrac{k_{\\mathrm{phys}} - k_c}{k_{\\max} - k_c}\\right)^{p}, & k_{\\mathrm{phys}} > k_c\n\\end{cases}\n$$\nThe damping coefficient for the physical mode is then $\\alpha_{\\mathrm{phys}} = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,\\phi(k_{\\mathrm{phys}})\\,k_{\\mathrm{phys}}^2$.\nWith these values, we check the three criteria pertaining to the physical mode:\n1.  **Underdamped Condition**: We must verify that $\\alpha_{\\mathrm{phys}} < \\omega_{\\mathrm{phys}}$. If this condition is not met, the mode is critically damped or overdamped, and the problem formulation for quality factor and damped frequency for oscillatory systems does not apply as stated.\n2.  **Quality Factor Preservation**: The quality factor is $Q_k = \\frac{\\omega_k}{2\\alpha_k}$. If $\\alpha_{\\mathrm{phys}} = 0$, then $Q_{\\mathrm{phys}} = \\infty$. The condition to check is $Q_{\\mathrm{phys}} \\ge Q_{\\min}$, where $Q_{\\min} = 200$.\n3.  **Frequency Accuracy**: The damped angular frequency is $\\omega_{d,k} = \\sqrt{\\omega_k^2 - \\alpha_k^2}$. If $\\alpha_{\\mathrm{phys}} = 0$, then $\\omega_{d,\\mathrm{phys}} = \\omega_{\\mathrm{phys}}$. The relative frequency error must satisfy $\\frac{|\\omega_{d,\\mathrm{phys}} - \\omega_{\\mathrm{phys}}|}{\\omega_{\\mathrm{phys}}} \\le \\varepsilon_{\\mathrm{tol}}$, where $\\varepsilon_{\\mathrm{tol}} = 0.01$. This inequality can be rewritten as $1 - \\sqrt{1 - (\\alpha_{\\mathrm{phys}}/\\omega_{\\mathrm{phys}})^2} \\le \\varepsilon_{\\mathrm{tol}}$.\n\nThird, we analyze the behavior of the spurious mode, $k=k_{\\mathrm{spur}} = k_{\\max}$.\nThe undamped angular frequency of the spurious mode is $\\omega_{\\mathrm{spur}} = c\\,k_{\\max}$.\nThe filter function is evaluated at $k_{\\mathrm{spur}}$. Since $r \\in [0,1)$, we have $k_c < k_{\\max}$. Therefore, $k_{\\mathrm{spur}} = k_{\\max} > k_c$, and the filter function value is:\n$$\n\\phi(k_{\\mathrm{spur}}) = \\phi(k_{\\max}) = \\left(\\dfrac{k_{\\max} - k_c}{k_{\\max} - k_c}\\right)^{p} = 1^p = 1.\n$$\nThe damping coefficient for the spurious mode is $\\alpha_{\\mathrm{spur}} = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,\\phi(k_{\\mathrm{spur}})\\,k_{\\mathrm{spur}}^2 = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,k_{\\max}^2$.\nWith these values, we check the single criterion for the spurious mode:\n4.  **Spurious Mode Suppression**: The quality factor is $Q_{\\mathrm{spur}} = \\frac{\\omega_{\\mathrm{spur}}}{2\\alpha_{\\mathrm{spur}}}$. Substituting the expressions for $\\omega_{\\mathrm{spur}}$ and $\\alpha_{\\mathrm{spur}}$ gives:\n$$\nQ_{\\mathrm{spur}} = \\frac{c\\,k_{\\max}}{2 \\cdot \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,k_{\\max}^2} = \\frac{c}{\\sigma_{\\mathrm{svv}}\\,k_{\\max}}.\n$$\nThis quality factor must be small, satisfying $Q_{\\mathrm{spur}} \\le Q_{\\max,\\mathrm{spur}}$, where $Q_{\\max,\\mathrm{spur}} = 5$. If the mode is overdamped, i.e., $\\alpha_{\\mathrm{spur}} \\ge \\omega_{\\mathrm{spur}}$, its effective quality factor is less than or equal to $0.5$, which automatically satisfies the condition. The formula for $Q_{\\mathrm{spur}}$ remains valid for this check.\n\nFinally, for a given test case, the result is `True` if and only if all four conditions listed above are met. Otherwise, the result is `False`. This procedure is systematically applied to each of the four test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the SVV validation for all test cases.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    L = 1.0  # m\n    c = 343.0  # m/s\n    Q_min = 200.0  # dimensionless\n    Q_max_spur = 5.0  # dimensionless\n    epsilon_tol = 0.01  # dimensionless\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, sigma_svv, r, p)\n        (64, 0.4, 0.8, 8),\n        (64, 0.05, 0.8, 8),\n        (4, 2.0, 0.1, 1),\n        (64, 0.35, 0.7, 6),\n    ]\n\n    def check_case(N, sigma_svv, r, p):\n        \"\"\"\n        Validates a single set of SVV parameters against the four criteria.\n\n        Args:\n            N (int): Number of Fourier modes.\n            sigma_svv (float): SVV amplitude (m^2/s).\n            r (float): Cutoff ratio for the SVV filter.\n            p (float): Exponent for the SVV filter.\n\n        Returns:\n            bool: True if all criteria are met, False otherwise.\n        \"\"\"\n        # Step 1: Calculate wavenumbers\n        k_max = np.pi * N / L\n        k_phys = 2.0 * np.pi / L\n        k_spur = k_max\n        k_c = r * k_max\n\n        # --- Step 2: Analyze the Physical Mode (k_phys) ---\n\n        # Calculate phi(k_phys)\n        if k_phys <= k_c:\n            phi_phys = 0.0\n        else:\n            phi_phys = ((k_phys - k_c) / (k_max - k_c))**p\n\n        # Calculate omega_phys and alpha_phys\n        omega_phys = c * k_phys\n        alpha_phys = 0.5 * sigma_svv * phi_phys * k_phys**2\n\n        # Criterion 4: Physical mode must be underdamped\n        is_phys_underdamped = (alpha_phys < omega_phys)\n        if not is_phys_underdamped:\n            return False\n\n        # Criterion 2: Physical mode quality factor preservation (Q_phys >= Q_min)\n        if alpha_phys == 0.0:\n            q_phys = float('inf')\n        else:\n            q_phys = omega_phys / (2.0 * alpha_phys)\n        \n        is_q_phys_preserved = (q_phys >= Q_min)\n\n        # Criterion 3: Physical mode frequency accuracy\n        if alpha_phys == 0.0:\n            freq_error_phys = 0.0\n        else:\n            # Using stable formula: 1 - sqrt(1 - (alpha/omega)^2)\n            ratio_sq = (alpha_phys / omega_phys)**2\n            freq_error_phys = 1.0 - np.sqrt(1.0 - ratio_sq)\n        \n        is_freq_accurate = (freq_error_phys <= epsilon_tol)\n\n        # --- Step 3: Analyze the Spurious Mode (k_spur) ---\n\n        # For the spurious mode k_spur = k_max, phi(k_spur) is always 1\n        # Q_spur simplifies to c / (sigma_svv * k_max)\n        q_spur = c / (sigma_svv * k_max)\n\n        # Criterion 1: Spurious mode suppression (Q_spur <= Q_max_spur)\n        is_spur_suppressed = (q_spur <= Q_max_spur)\n\n        # Final check: all conditions must be true\n        return (is_q_phys_preserved and \n                is_freq_accurate and \n                is_spur_suppressed and \n                is_phys_underdamped)\n\n    results = []\n    for case in test_cases:\n        N, sigma_svv, r, p = case\n        result = check_case(N, sigma_svv, r, p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}