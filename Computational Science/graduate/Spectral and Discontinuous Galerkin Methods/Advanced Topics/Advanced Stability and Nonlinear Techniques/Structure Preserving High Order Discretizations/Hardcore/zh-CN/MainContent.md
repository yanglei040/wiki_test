## 引言
在现代科学与工程中，[偏微分方程的数值模拟](@entry_id:752828)是理解复杂物理现象不可或缺的工具。然而，传统数值方法在离散化过程中，往往会无意中破坏控制方程所蕴含的[能量守恒](@entry_id:140514)、熵增、对称性等基本物理或数学结构。这种结构上的不一致性可能导致非物理的数值耗散或增长，使得长时间模拟结果失去可靠性，尤其是在[对流](@entry_id:141806)主导或波动问题中。为了克服这一根本性挑战，保结构[高阶离散化](@entry_id:750302)应运而生。它不是单纯地追求更高的收敛阶，而是致力于构建能够在代数层面精确反映连续物理定律的[数值格式](@entry_id:752822)，从而从根本上提升模拟的鲁棒性、稳定性和长期保真度。

本文旨在系统性地介绍保结构[高阶离散化](@entry_id:750302)的核心思想与前沿应用。在“原理与机制”一章中，我们将深入剖析求和分部（SBP）算子、分裂形式、[熵稳定性](@entry_id:749023)等关键构建模块。随后，在“应用与跨学科联系”一章，我们将展示这些原理如何被应用于解决[流体力学](@entry_id:136788)、等离子体物理和量子力学等不同领域的挑战性问题。最后，通过“动手实践”部分，读者将有机会将理论付诸实践，构建并测试自己的[保结构数值格式](@entry_id:755568)。通过本文的学习，读者将掌握设计和分析能够忠实捕捉物理本质的先进数值方法所需的理论基础和实践洞见。

## 原理与机制

结构保持离散化的核心目标是设计出能够在其[代数结构](@entry_id:137052)中精确反映连续介质[偏微分方程](@entry_id:141332)（PDE）基本物理或数学特性的数值方法。这些特性往往与守恒律、对称性、几何约束或拓扑不变量有关。传统的数值方法可能在离散化过程中无意中破坏这些结构，导致非物理行为的累积，例如[能量漂移](@entry_id:748982)、[伪振荡](@entry_id:152404)或对特定平衡态的破坏。本章将深入探讨几种关键的原理和机制，它们是现代高阶结构保持离散化的基石。

### 核心机制之一：模拟[分部积分](@entry_id:136350)——[分部求和算子](@entry_id:754520)

许多物理守恒律的推导都依赖于一个基本的数学工具：分部积分（Integration-by-Parts, IBP）。对于定义在区间 $[-1, 1]$ 上的两个光滑函数 $u(x)$ 和 $v(x)$，[分部积分公式](@entry_id:145262)为：
$$
\int_{-1}^{1} u(x) v'(x) \,dx = [u(x)v(x)]_{-1}^{1} - \int_{-1}^{1} u'(x) v(x) \,dx
$$
这个恒等式建立了导数运算和积分运算之间的对偶关系，并引出了边界项。为了在离散层面精确地模拟这一特性，**[分部求和](@entry_id:185335)**（**Summation-by-Parts, SBP**）算子应运而生。

考虑一个使用[高斯-洛巴托-勒让德](@entry_id:749736)（GLL）节点 $\{x_i\}_{i=1}^n$ 的一维谱搭配离散。我们可以定义一个离散[内积](@entry_id:158127)，它通过一个对角、正定的**[质量矩阵](@entry_id:177093)**（或称为范数矩阵）$H$ 来逼近连续积分，该矩阵的对角[线元](@entry_id:196833)素是相应的[求积权重](@entry_id:753910) $\{w_i\}$。离散导数由一个**[微分矩阵](@entry_id:149870)** $D$ 表示，其中 $D_{ij}$ 是与节点 $x_j$ 相关的[拉格朗日基](@entry_id:751105)函数在节点 $x_i$ 处的导数值。

一个[微分矩阵](@entry_id:149870) $D$ 和质量矩阵 $H$ 的组合被称为满足SBP性质，如果它们满足以下代数恒等式：
$$
H D + D^{\top} H = B
$$
其中 $B$ 是一个[边界算子](@entry_id:160216)，对于非周期性问题，它通常形式为 $B = e_n e_n^{\top} - e_1 e_1^{\top}$，这里 $e_1$ 和 $e_n$ 是[标准基向量](@entry_id:152417)，用于提取区间端点的值。这个矩阵恒等式是连续[分部积分公式](@entry_id:145262)的直接离散模拟。对于任意两个网格向量 $u$ 和 $v$，它等价于：
$$
u^{\top} H (D v) + (D u)^{\top} H v = u_n v_n - u_1 v_1
$$
左侧两项分别是对 $\int u v' dx$ 和 $\int u' v dx$ 的离散逼近，而右侧精确地表示了边界项 $u(1)v(1) - u(-1)v(-1)$。对于GLL节点，当被积函数是足够低阶的多项式时（例如，当 $u$ 和 $v$ 是次数不超过 $n-1$ 的多项式时），求积是精确的，这意味着离散SBP恒等式不是一个近似，而是一个代数上的精确表示。对于[周期性边界条件](@entry_id:147809)，边界项消失，$B=0$，此时 SBP 性质简化为 $HD + D^\top H = 0$，表明算子 $HD$ 是反对称的。SBP算子是构建稳定和守恒的[高阶格式](@entry_id:150564)，特别是熵稳定和[能量稳定格式](@entry_id:748992)的基石。

### 核心机制之二：分裂形式与[不变量](@entry_id:148850)守恒

即使使用了满足SBP性质的微分算子，对[非线性](@entry_id:637147)项的朴素离散化通常也无法保持连续方程的二次[不变量](@entry_id:148850)（如能量或熵）。例如，考虑无粘性标量 Burgers 方程 $u_t + (\frac{1}{2}u^2)_x = 0$。在连续层面，对于光滑周期解，其动能 $\int \frac{1}{2}u^2 dx$ 是守恒的。

在离散层面，我们可以用多种在数学上等价但在代数上不同的形式来表示[非线性](@entry_id:637147)项 $f(u)_x = u u_x$。两种标准形式是：
- **[守恒形式](@entry_id:747710)**（Conservative form）：直接对通量求导，离散为 $D(\frac{1}{2} u \odot u)$，其中 $\odot$ 表示逐元素相乘。
- **平流形式**（Advective form）：将 $u$ 视为平流速度，离散为 $U D u$，其中 $U = \mathrm{diag}(u)$。

这两种形式通常都不会单独保持离散动能 $K_h(u) = \frac{1}{2} u^\top H u$。然而，通过引入一个参数 $\alpha \in \mathbb{R}$，我们可以构造一个**分裂形式**（**split form**）的离散化，作为这两种形式的线性组合：
$$
S_h^{(\alpha)}(u) := \alpha D\left(\frac{1}{2}u \odot u\right) + (1-\alpha) U D u
$$
为了使离散[动能守恒](@entry_id:177660)，即 $\frac{d}{dt}K_h(u) = -u^\top H S_h^{(\alpha)}(u) = 0$，需要利用周期性边界下的SBP性质（$D^\top H = -HD$）。通过代数推导可以证明，这个守恒条件当且仅当 $\alpha = 2/3$ 时成立。因此，以下分裂形式是保持动能的：
$$
S_h(u) = \frac{2}{3} D\left(\frac{1}{2}u \odot u\right) + \frac{1}{3} U D u
$$
这个例子清楚地表明，通过精心设计[非线性](@entry_id:637147)项的代数形式（即分裂形式），并结合SBP算子的离散[对偶性质](@entry_id:276134)，我们可以构建出能够精确保持连续[不变量](@entry_id:148850)的离散格式。这种思想是发展熵稳定和[能量稳定格式](@entry_id:748992)的核心。

### 应用领域一：守恒律与稳定性

#### 基本量的守恒

对于由[双曲守恒律](@entry_id:147752) $u_t + \nabla \cdot f(u) = 0$ 描述的系统，最基本的结构就是被守恒量 $u$ 的总量。在间断伽辽金（DG）方法中，这一结构可以在离散层面被精确保持。

**局部守恒**（**Local conservation**）指的是在每个单元 $K$ 内，被守恒量的变化率等于通过其边界 $\partial K$ 的数值通量净和。通过在[DG弱形式](@entry_id:748377)中选取常数测试函数 $v_h=1$，可以推导出局部守恒的积分形式：
$$
\frac{\mathrm{d}}{\mathrm{d}t} \int_K u_h \,dx = - \int_{\partial K} \widehat{F}(u_h^-, u_h^+; \mathbf{n}) \,ds
$$
这里，$u_h^-$ 和 $u_h^+$ 分别是单元内外侧的解的迹，$\widehat{F}$ 是**[数值通量](@entry_id:752791)**。

**全局守恒**（**Global conservation**）则是将局部守恒律在所有单元上求和。为了使整个计算域 $\Omega$ 内的总量仅因边界通量而改变，所有内部单元交界面上的通量贡献必须两两抵消。这要求[数值通量](@entry_id:752791) $\widehat{F}$ 必须是单值的，或称为“守恒的”，即在一个共享界面上，从一个单元流出的通量必须等于流入相邻单元的通量。这在代数上表现为一个反对称条件：
$$
\widehat{F}(a, b; \mathbf{n}) = - \widehat{F}(b, a; -\mathbf{n})
$$
此外，为了确保[数值格式](@entry_id:752822)收敛到正确的[偏微分方程解](@entry_id:166250)，[数值通量](@entry_id:752791)还必须满足**一致性**（**consistency**）条件，即当界面两侧状态相同时，它必须退化为物理通量：$\widehat{F}(w, w; \mathbf{n}) = f(w) \cdot \mathbf{n}$。这两个条件是设计守恒[DG格式](@entry_id:178043)的基石。

#### [熵稳定性](@entry_id:749023)

对于[非线性](@entry_id:637147)[双曲守恒律](@entry_id:147752)，仅满足守恒律的[弱解](@entry_id:161732)可能不唯一，物理上相关的解还必须满足一个附加条件——[熵不等式](@entry_id:184404)，它保证了[时间演化](@entry_id:153943)的不可逆性。结构保持离散化的一个更高层次的目标就是要在离散层面模拟这一特性。

这引出了**[熵稳定性](@entry_id:749023)**（**entropy stability**）的概念。其基础是为守恒律系统引入一个**熵对**（**entropy pair**） $(U, F)$，其中 $U(u)$ 是一个标量凸函数（熵函数），$F(u)$ 是相应的熵通量，它们满足[相容性关系](@entry_id:157858) $\nabla U \cdot \nabla f = \nabla F$。对于光滑解，熵密度也满足守恒律 $U(u)_t + F(u)_x = 0$。

在[数值格式](@entry_id:752822)中，熵的演化由[数值通量](@entry_id:752791)和体积积分项共同决定。利用SBP和分裂形式，可以设计出体积积分项对熵的生成贡献为零的格式。此时，总熵的演化完全由界面上的数值通量决定。
- **[熵守恒数值通量](@entry_id:749020)**（**Entropy-conservative numerical flux**）$\widehat{f}^{\mathrm{ec}}$ 是一种特殊的两点通量，它在每个界面上产生的数值熵生成为零。这由 Tadmor 提出的条件定义，该条件将通量与[熵变](@entry_id:138294)量 $v=\nabla U$ 和一个通量[势能](@entry_id:748988) $\psi$ 联系起来。
- **[熵稳定数值通量](@entry_id:749026)**（**Entropy-stable numerical flux**）$\widehat{f}^{\mathrm{es}}$ 通常通过在[熵守恒通量](@entry_id:749013)的基础上添加一个耗散项来构造，该耗散项确保界面上的熵生成非负（即熵只能增加或不变）：
$$
\widehat{f}^{\mathrm{es}}(u_L,u_R) = \widehat{f}^{\mathrm{ec}}(u_L,u_R) - \tfrac{1}{2} D(u_L,u_R) (v_R - v_L)
$$
其中 $D$ 是一个[对称半正定矩阵](@entry_id:163376)。当与[熵守恒](@entry_id:749018)的体积项离散格式结合时，使用[熵守恒通量](@entry_id:749013)可以精确保持离散总熵，而使用[熵稳定通量](@entry_id:749015)则保证离散总熵随时间非增（对于周期性边界）。这为处理带有激波的[非线性](@entry_id:637147)问题提供了强大的[非线性](@entry_id:637147)稳定性。

### 应用领域二：保持物理约束与平衡态

#### 正定性保持

对于许多物理系统，如[可压缩欧拉方程](@entry_id:747588)，解的某些分量必须保持正定才能具有物理意义，例如密度 $\rho > 0$ 和压力 $p > 0$。然而，[高阶数值方法](@entry_id:142601)由于其固有的[振荡](@entry_id:267781)行为（吉布斯现象），可能会在光滑解附近产生负值，导致计算崩溃。

**正定性保持**（**Positivity-preserving**）格式旨在强制数值解停留在物理容许的状态空间内。对于[理想气体](@entry_id:200096)[欧拉方程](@entry_id:177914)，这个容许集 $\mathcal{G} = \{ \mathbf{U} : \rho > 0, p(\mathbf{U}) > 0 \}$ 是一个**[凸集](@entry_id:155617)**。这一[凸性](@entry_id:138568)是设计正定性保持[高阶格式](@entry_id:150564)的关键。

一个广为应用的策略（例如，由 Zhang 和 Shu 发展的）包含两个步骤：
1.  **保持单元平均值的[正定性](@entry_id:149643)**：首先，确保在时间步进后，每个单元的平均状态 $\overline{\mathbf{U}}^{n+1}$ 仍在容许集 $\mathcal{G}$ 内。这通常可以通过使用基于单调通量（如Lax-Friedrichs通量）的一阶格式作为基础，并在满足一个合适的[CFL条件](@entry_id:178032)下实现。由于 $\mathcal{G}$ 的[凸性](@entry_id:138568)，新单元平均值可以表示为旧的、位于 $\mathcal{G}$ 内的相邻单元平均值的[凸组合](@entry_id:635830)，因此也位于 $\mathcal{G}$ 内。
2.  **限制高阶多项式**：即使单元平均值是正定的，单元内部的高阶多项式解 $u_h$ 仍可能在某些点（如求积点）上出现负值。为了修正这一点，可以采用一个保持守恒的**限制器**（**limiter**）。一个常用的技术是[线性缩放](@entry_id:197235)：将有问题的多项式解向单元平均值“[拉回](@entry_id:160816)”，直到所有求积点上的值都满足[正定性](@entry_id:149643)。这个过程之所以有效，正是因为 $\mathcal{G}$ 是[凸集](@entry_id:155617)。

值得注意的是，正定性保持与[标量守恒律](@entry_id:754532)的**[最大值原理](@entry_id:138611)**（**maximum principle**）有本质区别。最大值原理要求解始终位于初始数据的最小和最大值之间（一个双边约束），而正定性是一个单边约束。更重要的是，欧拉方程的压力 $p$ 是[守恒变量](@entry_id:747720)的[非线性](@entry_id:637147)函数，其正定性约束作用于整个状态向量，而非单个变量。

#### 平衡态保持（Well-Balanced）

许多[双曲系统](@entry_id:260647)包含源项，例如带有地形的浅水方程。这些系统常常拥有重要的非平凡[稳态解](@entry_id:200351)，其中通量梯度与[源项](@entry_id:269111)精确平衡。一个经典的例子是**静止湖泊**（**lake-at-rest**）[平衡态](@entry_id:168134)，其中流速为零，水面高程 $\eta = h+b$ 处处为常数。

一个标准的数值格式往往无法精确保持这种平衡，因为离散的通量梯度和离散的源项通常不会代数上精确抵消，即使在连续层面它们是平衡的。这会导致在[平衡态](@entry_id:168134)附近产生虚假的[数值振荡](@entry_id:163720)。

**[平衡态](@entry_id:168134)保持**（**Well-balanced**）格式被专门设计用来精确地保持这些[稳态解](@entry_id:200351)。对于静止湖泊问题，实现这一目标的关键在于对[动量方程](@entry_id:197225)中的压力梯度项和地形[源项](@entry_id:269111)进行特殊处理：
1.  **体积积分的平衡**：不直接离散压力通量 $\frac{1}{2}gh^2$ 的梯度，而是将其改写为 $gh \partial_x h$。然后，将压力梯度项和地形源项的离散化组合成一个“分裂形式”：
    $$
    -g\,\mathrm{diag}(\mathbf{h}) D\mathbf{h} - g\,\mathrm{diag}(\mathbf{h}) D\mathbf{b} = -g\,\mathrm{diag}(\mathbf{h}) D(\mathbf{h}+\mathbf{b}) = -g\,\mathrm{diag}(\mathbf{h}) D\boldsymbol{\eta}
    $$
    当 $\boldsymbol{\eta}$ 是常数向量时，$D\boldsymbol{\eta}=\mathbf{0}$，因此单元内的残差精确为零。
2.  **界面通量的平衡**：仅有体积项的平衡是不够的。数值通量在单元界面的贡献也必须与这种平衡相容。需要设计一种数值通量，使得在静止湖泊条件下（$u_L=u_R=0$ 且 $\eta_L=\eta_R$），它能够精确地平衡两侧的静水压力，从而使得总的动量残差为零。

平衡态保持对于准确模拟物理系统从小扰动开始的演化至关重要。

### 应用领域三：保持几何结构

#### [曲线网格](@entry_id:748122)上的[几何守恒律](@entry_id:170384)

当数值方法应用于[曲线网格](@entry_id:748122)时，必须考虑从物理坐标 $\boldsymbol{x}$ 到参考坐标 $\boldsymbol{\xi}$ 的映射。在一个**等参**（**isoparametric**）框架中，[几何映射](@entry_id:749852)和解的逼近使用相同的多项式[基函数](@entry_id:170178)。这种映射引入了度量项，如雅可比行列式 $J$ 和缩放的[逆变](@entry_id:192290)度量分量 $J a_j^i$。

为了确保格式在[曲线网格](@entry_id:748122)上能够正确地处理最简单的解，例如[均匀流](@entry_id:272775)（常数解），离散化本身必须满足一个一致性条件，即**[几何守恒律](@entry_id:170384)**（**Geometric Conservation Law, GCL**）。在连续层面，度量张量满足一组称为 Piola 恒等式的几何关系，例如 $\sum_{i=1}^d \frac{\partial}{\partial \xi^i}(J a_j^i) = 0$。

离散GCL要求离散微分算子应用于离散的度量项时，也能精确地满足这些恒等式。对于一个使用[微分矩阵](@entry_id:149870) $D_i$ 的节点格式，离散GCL表现为在每个节点上都成立的代数方程：
$$
\sum_{i=1}^d D_i(J a_j^i) = \boldsymbol{0} \quad \text{for each } j=1,\dots,d
$$
满足GCL确保了即使在扭曲的网格上，一个[均匀流](@entry_id:272775)也不会产生虚假的力，这是在复杂几何形状上获得准确解的基本前提。

#### [有限元外微分](@entry_id:174585)

**[有限元外微分](@entry_id:174585)**（**Finite Element Exterior Calculus, FEEC**）提供了一个更为深刻和普适的框架来保持几何和拓扑结构。它将[微分几何](@entry_id:145818)中的 de Rham 复合体思想引入到有限元方法中。在三维空间中，de Rham 复合体表现为人们所熟知的序列：
$$
H^1 \xrightarrow{\nabla} H(\mathrm{curl}) \xrightarrow{\nabla \times} H(\mathrm{div}) \xrightarrow{\nabla \cdot} L^2
$$
这个序列的一个关键性质是**正合性**（**exactness**）：前一个算子的像（image）精确地等于后一个[算子的核](@entry_id:272757)（kernel）。例如，任何[梯度的旋度](@entry_id:274168)为零（$\nabla \times (\nabla \phi) = 0$），任何[旋度的散度](@entry_id:271562)为零（$\nabla \cdot (\nabla \times \mathbf{A}) = 0$）。

FEEC的目标是构造一系列有限元空间 $V_h^k$ 和离散算子 $d_h^k$，使得离散序列也具备正合性。这是通过以下两个核心组件实现的：
1.  **离散外导数 $d_h$**：它完全由网格的拓扑（连接关系）和定向决定，其矩阵表示是符号[伴随矩阵](@entry_id:148203)，元素仅为 $0, \pm 1$。它与单元的几何形状或多项式次数无关，并代数上精确满足 $d_h \circ d_h = 0$。
2.  **离散[霍奇星算子](@entry_id:197539) $*_h$**：它是在有限元空间上的 $L^2$ [内积](@entry_id:158127)的表示，即质量矩阵。它是一个度量相关的算子，其值取决于单元的几何形状和求积公式，但与网格的拓扑无关。

实现离散正合性的关键是构造满足**[交换图](@entry_id:747516)**（**commuting diagram**）性质的投影算子 $\Pi_h^k$ 和离散导数 $d_h$：$\Pi_h^{k+1} \circ d = d_h \circ \Pi_h^k$。对于特定构造的有限元空间（如 Nédélec 空间和 Raviart-Thomas 空间），这一性质成立。在一个拓扑平凡的区域上，这保证了离散序列也是正合的。这意味着像 $\nabla_h \times (\nabla_h \phi_h) = 0$ 这样的基本矢量恒等式在离散层面被精确地保持，从而避免了许多[伪解](@entry_id:275285)的出现。

### 结构保持时间积分

保持结构不仅是[空间离散化](@entry_id:172158)的任务；[时间积分格式](@entry_id:165373)也必须尊重系统的内在结构。

#### [哈密顿系统](@entry_id:143533)与[辛积分](@entry_id:755737)格式

许多物理系统，特别是无耗散的波现象，在经过[空间离散化](@entry_id:172158)后可以写成一个大规模的[常微分方程组](@entry_id:266774)（ODE），该[方程组](@entry_id:193238)具有哈密顿结构：
$$
\dot{y} = J \nabla H(y)
$$
其中 $H(y)$ 是系统的总能量（[哈密顿量](@entry_id:172864)），$J$ 是一个常数[反对称矩阵](@entry_id:155998)。哈密顿系统的精确解流有一个重要的几何性质：它是**辛映射**（**symplectic map**），即它保持了相空间的辛结构。

**[辛积分](@entry_id:755737)格式**（**Symplectic integrators**）是一类其单步演化映射也是辛映射的数值方法。一个著名的例子是高斯-勒让德搭配[龙格-库塔方法](@entry_id:144251)。[辛积分](@entry_id:755737)格式具有以下关键特性：
- 它们通常**不**精确保持[哈密顿量](@entry_id:172864) $H$ 本身（除非 $H$ 是二次函数）。相反，它们精确地保持一个“影子[哈密顿量](@entry_id:172864)”，这导致能量误差在极长时间内保持有界，而不会出现系统性漂移。
- 它们**精确保持**系统的所有**线性和二次[不变量](@entry_id:148850)**。这是一个极其重要的性质。例如，如果[空间离散化](@entry_id:172158)（如使用SBP算子）导致离散 $L^2$ 范数成为一个二次[不变量](@entry_id:148850)，那么使用辛[时间积分格式](@entry_id:165373)（如高斯-勒让德方法）将能精确地保持这个离散范数，杜绝[数值耗散](@entry_id:168584)或增长。

#### 拉格朗日系统与变分积分格式

从[拉格朗日力学](@entry_id:147054)的视角出发，可以通过**离散诺特定理**（**discrete Noether's theorem**）来系统地构造保持守恒量的积分格式。其核心思想是，如果一个系统的拉格朗日量在某个连续对称群（如旋转、平移或相位变换）下不变，那么就存在一个[守恒量](@entry_id:150267)（如角动量、动量或[电荷](@entry_id:275494)）。

**变分积分格式**（**Variational integrators**）通过对[作用量积分](@entry_id:156763)进行离散化，并应用离散的变分原理来推导。离散诺特定理指出：如果离散[拉格朗日量](@entry_id:174593) $L_d$ 在一个[对称群](@entry_id:146083)的离散作用下保持不变，那么由该积分格式生成的数值解将精确地保持一个对应的离散[守恒量](@entry_id:150267)（离散动量映射）。

例如，对于一个具有相位不变性（$U(1)$ 对称性）的系统（如薛定谔方程），其连续解保持总[电荷](@entry_id:275494)（$L^2$ 范数的平方）守恒。如果[空间离散化](@entry_id:172158)（使用对称的数值通量和求积）和[时间离散化](@entry_id:169380)（使用变分积分格式）都尊重这一对称性，那么得到的全离散格式将能精确地保持离散的总[电荷](@entry_id:275494)。这为从第一性原理出发设计[守恒格式](@entry_id:747715)提供了强大的理论工具。