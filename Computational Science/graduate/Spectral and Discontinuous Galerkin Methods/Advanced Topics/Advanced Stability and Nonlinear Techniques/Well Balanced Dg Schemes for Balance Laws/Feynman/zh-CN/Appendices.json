{
    "hands_on_practices": [
        {
            "introduction": "实现格式守恒性的一个关键在于精确抵消离散的通量梯度项和源项。本练习  将要求你确定在浅水方程中，为达到这种平衡所需的最低数值积分精度。通过分析弱形式中被积函数的最高多项式次数，你将具体理解数值积分规则如何成为保持静止平衡态的基石。",
            "id": "3428768",
            "problem": "考虑在一维区域上的一维浅水平衡律，该区域被划分为具有直界面的单元，\n$$\n\\partial_{t}\\begin{pmatrix} h \\\\ hu \\end{pmatrix}\n+ \\partial_{x}\\begin{pmatrix} hu \\\\ \\displaystyle \\frac{(hu)^{2}}{h} + \\frac{g}{2}h^{2} \\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ -g\\,h\\,\\partial_{x}b(x) \\end{pmatrix},\n$$\n其中 $h(x,t)$ 是水深，$u(x,t)$ 是速度，$g$ 是（恒定的）重力加速度，$b(x)$ 是底部地形。静湖稳态由 $u(x,t)=0$ 和 $h(x,t)+b(x)=H$ 给出，其中 $H$ 为常数。\n\n在每个单元上使用多项式次数为 $p=1$ 的间断Galerkin（DG）方法，其测试函数 $\\varphi(x)$ 是次数最多为 $1$ 的多项式。假设底部地形 $b(x)$ 在每个单元上是分段线性的，因此 $\\partial_{x}b$ 在每个单元内部是常数，并可能在界面上发生跳跃。DG格式对每个单元内的通量项应用标准的分部积分（得到一个涉及 $f(q)$ 和测试函数梯度的体积分，以及一个界面上的边界通量项），并在体积内离散化源项。为了实现静湖状态的精确保平衡，对于由地形引起的非守恒耦合，在界面处遵循一种路径守恒的解释：强制实现精确抵消的界面贡献可以写成一个一维路径积分的形式，该积分在一个抽象路径变量 $s\\in[0,1]$ 上进行，路径是在状态空间中连接左右迹线的一条直线段，形式如下\n$$\n\\int_{0}^{1} B\\big(q(s)\\big)\\,\\partial_{s}b(s)\\,ds,\n$$\n其中 $B(q)=g\\,h$，并且 $b(s)$ 沿路径是线性的。在静湖配置中，沿路径有 $h(s)=H-b(s)$。\n\n你需要确定为精确积分以下两项所需的最小高斯-勒让德求积阶数：\n- 为保持静湖平衡，DG格式所需的单元内部（体积）积分，以及\n- 为确保界面处的精确保平衡，所需的界面路径积分。\n\n使用以下基本依据：\n- 静湖状态满足 $u=0$ 和 $h+b=H$，因此如果 $b$ 是分段线性的，那么 $h$ 也是分段线性的。\n- 在每个 $p=1$ 的单元内，任何测试函数 $\\varphi$ 的梯度是常数。\n- 当 $u=0$ 时，动量通量简化为静水压力项 $\\frac{g}{2}h^{2}$。\n- 具有 $N$ 个点的高斯-勒让德求积法可以精确积分其应用区间上次数最多为 $2N-1$ 的任何多项式。\n\n假设每个单元的映射是仿射的，因此在映射下多项式次数得以保持，并且界面路径 $b(s)$ 是线性的。将你的最终答案表示为一个数对，分别给出每个单元的体积分和每个界面的路径积分所需的最小高斯-勒让德点数。以整数行矩阵的形式提供该数对。无需四舍五入，不涉及单位。",
            "solution": "该问题要求确定在浅水方程的间断Galerkin（DG）方法中，为实现两类积分的精确计算所需的最小高斯-勒让德求积点数，特别是在保持静湖稳态的情况下。逼近空间的多项式次数为 $p=1$。\n\n静湖稳态定义为流体速度为零 $u(x,t)=0$，且总水面高程恒定 $h(x,t)+b(x)=H$，其中 $h$ 是水深，$b$ 是底部地形，$H$ 是一个常数。\n\n一个具有 $N$ 个点的高斯-勒让德求积法则能够精确积分次数最多为 $2N-1$ 的多项式。为了找到最小的 $N$，我们必须找出被积函数的最大多项式次数 $d$，并求解不等式 $2N-1 \\ge d$ 以得到最小的整数 $N$。\n\n### 第一部分：单元内部（体积）积分\n\n为了保持稳态，数值格式必须在每个单元内部精确平衡离散化的通量梯度和源项。在静湖状态（$u=0$）下，动量方程得以简化。必须在一个单元体积 $K$ 上积分的项源自动量方程的弱形式：\n$$\n\\int_K \\partial_x \\left( \\frac{g}{2}h^2 \\right) \\varphi \\, dx = \\int_K -g h (\\partial_x b) \\varphi \\, dx\n$$\n经过分部积分后，需要数值求积的相关体积分是：\n1.  通量积分：$\\int_K \\frac{g}{2}h(x)^2 (\\partial_x \\varphi(x)) \\, dx$\n2.  源项积分：$\\int_K g h(x) (\\partial_x b(x)) \\varphi(x) \\, dx$\n\n我们必须确定在给定单元 $K$ 上被积函数的多项式次数。\n-   DG方法使用次数最多为 $p=1$ 的多项式基函数和测试函数。因此，测试函数 $\\varphi(x)$ 是一个次数最多为 $1$ 的多项式。所以，其导数 $\\partial_x \\varphi(x)$ 是一个次数最多为 $0$ 的多项式（一个常数）。\n-   水深 $h(x)$ 的数值解也由一个次数最多为 $p=1$ 的多项式表示。\n-   底部地形 $b(x)$ 被给定为分段线性的。这意味着在任何单个单元 $K$ 上，$b(x)$ 是一个次数最多为 $1$ 的多项式，其导数 $\\partial_x b(x)$ 是一个次数最多为 $0$ 的多项式（一个常数）。\n\n现在，我们来分析每个被积函数的次数：\n1.  **通量被积函数**：项为 $\\frac{g}{2}h(x)^2 (\\partial_x \\varphi(x))$。\n    -   $h(x)^2$ 的次数是 $2 \\times (h \\text{的次数}) = 2 \\times 1 = 2$。\n    -   $\\partial_x \\varphi(x)$ 的次数是 $0$。\n    -   乘积的次数是 $2+0=2$。所以，第一个被积函数是一个次数最多为 $2$ 的多项式。\n\n2.  **源项被积函数**：项为 $g h(x) (\\partial_x b(x)) \\varphi(x)$。\n    -   $h(x)$ 的次数最多为 $1$。\n    -   $\\partial_x b(x)$ 的次数最多为 $0$。\n    -   $\\varphi(x)$ 的次数最多为 $1$。\n    -   乘积的次数是 $1+0+1=2$。所以，第二个被积函数是一个次数最多为 $2$ 的多项式。\n\n两个被积函数都是次数最多为 $d=2$ 的多项式。为了精确地积分它们，我们需要一个具有 $N$ 个点的高斯-勒让德法则，使得：\n$$\n2N-1 \\ge 2 \\implies 2N \\ge 3 \\implies N \\ge 1.5\n$$\n由于 $N$ 必须是整数，所需的最小点数为 $N_{vol} = 2$。\n\n### 第二部分：界面路径积分\n\n问题指明了界面贡献采用路径积分的形式，这对于实现非守恒系统的保平衡格式至关重要：\n$$\nI = \\int_{0}^{1} B\\big(q(s)\\big)\\,\\partial_{s}b(s)\\,ds\n$$\n其中 $s \\in [0,1]$ 是路径参数。我们需要找到被积函数关于 $s$ 的多项式次数。\n\n-   函数 $B(q)$ 被给定为 $B(q) = g\\,h$。\n-   状态空间中的路径 $q(s)$ 是连接左状态 $q_L$ 和右状态 $q_R$ 的一条直线段。这意味着 $q(s)$ 的每个分量都是 $s$ 的线性函数。特别是对于水深 $h$，我们有 $h(s) = (1-s)h_L + s h_R$，这是一个关于 $s$ 的次数最多为 $1$ 的多项式。\n-   问题陈述了底部地形的路径 $b(s)$ 是关于 $s$ 的线性函数。这意味着对于某些值 $b_L$ 和 $b_R$，有 $b(s) = (1-s)b_L + s b_R$。\n-   因此，导数 $\\partial_s b(s) = b_R - b_L$ 是一个常数，即一个关于 $s$ 的次数为 $0$ 的多项式。\n-   被积函数是 $B(q(s)) \\partial_s b(s) = g h(s) \\partial_s b(s)$。\n    -   $g$ 是一个常数。\n    -   $h(s)$ 是一个次数最多为 $1$ 的多项式。\n    -   $\\partial_s b(s)$ 是一个次数为 $0$ 的多项式。\n    -   乘积是一个次数最多为 $1+0=1$ 的多项式。\n\n问题还为静湖状态提供了一个相容性条件：沿路径有 $h(s) = H - b(s)$。这证实了路径之间的关系，并且不改变次数的计算。如果 $h(s)$ 是线性的，那么 $b(s)=H-h(s)$ 也必须是线性的，这与问题陈述是一致的。\n\n因此，被积函数是关于积分变量 $s$ 的次数最多为 $d=1$ 的多项式。为了精确地积分它，我们需要一个具有 $N$ 个点的高斯-勒让德法则，使得：\n$$\n2N-1 \\ge 1 \\implies 2N \\ge 2 \\implies N \\ge 1\n$$\n所需的最小点数为 $N_{int} = 1$。\n\n体积分所需的最小高斯-勒让德点数为 $2$，界面路径积分所需的最小高斯-勒让德点数为 $1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2  1 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个格式在达到守恒性之后，微小扰动将如何演化？本练习  将通过在一个守恒的定常态附近对DG格式进行线性化并执行傅里叶分析来探讨这个问题。你将看到守恒特性如何确保扰动的演化与底层定常态解耦，并量化格式的数值色散和耗散。",
            "id": "3428747",
            "problem": "考虑一维标量平衡律\n$$\nu_{t} + f(u)_{x} = s(x),\n$$\n该方程设于一个周期性区域上，网格均匀，单元宽度为 $h$。假设一个光滑稳态 $u_{0}(x)$ 被离散化精确保持，并满足平衡关系\n$$\n\\frac{d}{dx} f(u_{0}(x)) = s(x).\n$$\n如果对于任意网格分辨率，当 $u = u_{0}$ 时半离散残差为零，则称一个间断 Galerkin (DG) 方法是适定平衡的。\n\n设 $f(u) = a u$，其中平流速度 $a > 0$ 为常数，并设单元界面处的数值通量为迎风通量 $F^{*} = a u^{-}$，其中 $u^{-}$ 表示左迹。假设源项以路径守恒的方式离散化，使得对于 $u_0$ 的离散表示，半离散算子精确为零。考虑多项式次数为 $p=0$（每个单元内为分片常数）的 DG 格式。通过令 $u = u_{0} + v$ 并忽略 $O(|v|^{2})$ 阶项，围绕被保持的稳态对半离散格式进行线性化。将 $v$ 视为在线性化半离散算子下演化的小振幅扰动。\n\n在均匀网格上（单元索引 $j \\in \\mathbb{Z}$，无量纲波数 $\\theta \\in \\mathbb{R}$）使用空间傅里叶模态 $v_{j}(t) = \\hat{v} \\exp(i \\theta j + \\lambda(\\theta) t)$，推导扰动演化的精确半离散傅里叶符号 $\\lambda(\\theta)$。然后，对于小的 $|\\theta|$，展开 $\\lambda(\\theta)$，并通过渐近关系\n$$\n\\operatorname{Im}(\\lambda(\\theta)) = -\\frac{a}{h}\\,\\theta + C_{\\mathrm{disp}}\\,\\frac{a}{h}\\,\\theta^{3} + o(\\theta^{3}),\n\\qquad\n-\\operatorname{Re}(\\lambda(\\theta)) = C_{\\mathrm{diss}}\\,\\frac{a}{h}\\,\\theta^{2} + o(\\theta^{2}).\n$$\n来定义无量纲系数 $C_{\\mathrm{disp}}$ 和 $C_{\\mathrm{diss}}$，以确定主阶色散和耗散误差。\n将主阶系数对 $\\big(C_{\\mathrm{disp}},\\,C_{\\mathrm{diss}}\\big)$ 作为您的最终答案。这些系数是无量纲的，因此不需要单位。请精确表达最终答案，无需四舍五入。",
            "solution": "用户希望分析一个间断 Galerkin (DG) 格式。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **控制方程：** 一维标量平衡律为 $u_{t} + f(u)_{x} = s(x)$。\n*   **通量函数：** 通量是线性的，$f(u) = a u$，其中 $a > 0$ 是恒定的平流速度。\n*   **区域和网格：** 问题设于一个周期性区域上，网格均匀，单元为 $I_j = [x_{j-1/2}, x_{j+1/2}]$，宽度为 $h = x_{j+1/2} - x_{j-1/2}$。\n*   **稳态：** 一个光滑稳态 $u_{0}(x)$ 被精确保持，满足平衡关系 $\\frac{d}{dx} f(u_{0}(x)) = s(x)$，对于给定的通量，该关系变为 $a \\frac{du_0}{dx} = s(x)$。\n*   **数值方法：** 多项式次数为 $p=0$ 的间断 Galerkin (DG) 方法。这意味着解被近似为分片常数函数，$u_h(x,t) = u_j(t)$ for $x \\in I_j$。\n*   **数值通量：** 界面通量为迎风通量。由于 $a > 0$，界面处的通量由左侧状态决定，因此 $F^{*}(u_L, u_R) = f(u_L) = a u_L$。在单元 $I_j$ 的背景下，$x_{j-1/2}$ 处的通量为 $F^*(u_{j-1}, u_j) = a u_{j-1}$，$x_{j+1/2}$ 处的通量为 $F^*(u_j, u_{j+1}) = a u_j$。\n*   **适定平衡性质：** 该格式是适定平衡的，意味着“对于任意网格分辨率，当 $u = u_0$ 时，半离散残差为零”。还指出“源项以路径守恒的方式离散化，使得对于 $u_0$ 的离散表示，半离散算子精确为零”。\n*   **线性化：** 通过设置 $u = u_{0} + v$ 并忽略 $O(|v|^2)$ 阶项来进行扰动分析。\n*   **傅里叶分析：** 对扰动 $v$ 使用空间傅里叶模态 $v_{j}(t) = \\hat{v} \\exp(i \\theta j + \\lambda(\\theta) t)$，其中 $j$ 是单元索引，$\\theta$ 是无量纲波数。\n*   **目标：** 推导半离散傅里叶符号 $\\lambda(\\theta)$，并从小 $\\theta$ 展开中找到主阶色散系数 $C_{\\mathrm{disp}}$ 和耗散系数 $C_{\\mathrm{diss}}$：\n    $$ \\operatorname{Im}(\\lambda(\\theta)) = -\\frac{a}{h}\\,\\theta + C_{\\mathrm{disp}}\\,\\frac{a}{h}\\,\\theta^{3} + o(\\theta^{3}) $$\n    $$ -\\operatorname{Re}(\\lambda(\\theta)) = C_{\\mathrm{diss}}\\,\\frac{a}{h}\\,\\theta^{2} + o(\\theta^{2}) $$\n\n**1.2. 使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题牢固植根于偏微分方程数值分析领域，这是应用数学和计算科学的核心课题。DG 方法、适定平衡、线性化和傅里叶稳定性分析等概念都是标准且科学严谨的。没有伪科学或事实不健全之处。\n*   **适定性：** 问题是适定的。它提供了一个清晰的设置和一个具体、可计算的目标。所有必要信息都已提供。关于适定平衡源项离散化的假设，虽然没有指定离散源项的确切形式，但提供了其关键性质，这对于后续的线性化是足够的。\n*   **客观性：** 问题以精确、客观的数学语言陈述。\n*   **总体结论：** 该问题是守恒律数值分析中的一个标准、有效的练习题。\n\n**1.3. 结论和行动**\n\n问题有效。将进行求解。\n\n### 步骤 2：线性化格式的推导\n\n多项式次数为 $p=0$ 的间断 Galerkin (DG) 方法是通过将偏微分方程乘以一个测试函数 $\\phi(x)$（在每个单元 $I_j$ 上为常数 $\\phi=1$）并在单元上积分来构建的：\n$$\n\\int_{x_{j-1/2}}^{x_{j+1/2}} u_t \\,dx + \\int_{x_{j-1/2}}^{x_{j+1/2}} f(u)_x \\,dx = \\int_{x_{j-1/2}}^{x_{j+1/2}} s(x) \\,dx\n$$\n对于分片常数近似 $u_h(x,t) = u_j(t)$ on cell $I_j$，第一项变为 $h \\frac{du_j}{dt}$。对通量项进行分部积分并引入数值通量 $F^*$ 得到：\n$$\nh \\frac{du_j}{dt} + F^*(u_h(x_{j+1/2}^-), u_h(x_{j+1/2}^+)) - F^*(u_h(x_{j-1/2}^-), u_h(x_{j-1/2}^+)) = \\int_{x_{j-1/2}}^{x_{j+1/2}} s(x) \\,dx\n$$\n对于 $u_h(x_{j+1/2}^-) = u_j$，$u_h(x_{j+1/2}^+) = u_{j+1}$，以及当 $a>0$ 时的迎风通量 $F^*(u_L, u_R) = a u_L$，通量贡献为 $F^*(u_j, u_{j+1}) = a u_j$ 和 $F^*(u_{j-1}, u_j) = a u_{j-1}$。半离散格式为：\n$$\nh \\frac{du_j}{dt} + a u_j - a u_{j-1} = \\int_{x_{j-1/2}}^{x_{j+1/2}} s(x) \\,dx\n$$\n让我们将离散源项表示为 $S_j = \\frac{1}{h} \\int_{x_{j-1/2}}^{x_{j+1/2}} s(x) \\,dx$。该格式为：\n$$\n\\frac{du_j}{dt} = -\\frac{a}{h}(u_j - u_{j-1}) + S_j\n$$\n问题指出，对于稳态的离散表示（我们记为 $u_{0,j}$），该格式是适定平衡的。这意味着当 $u_j = u_{0,j}$ 时，时间导数为零：\n$$\n0 = -\\frac{a}{h}(u_{0,j} - u_{0,j-1}) + S_j\n$$\n这是离散稳态条件。\n\n现在，我们通过代入 $u_j(t) = u_{0,j} + v_j(t)$ 来围绕此稳态对格式进行线性化，其中 $v_j$ 是一个小扰动。由于问题是线性的，这是一个精确分解，而非近似。\n$$\n\\frac{d}{dt}(u_{0,j} + v_j(t)) = -\\frac{a}{h}((u_{0,j} + v_j(t)) - (u_{0,j-1} + v_{j-1}(t))) + S_j\n$$\n由于 $u_{0,j}$ 与时间无关，所以 $\\frac{du_{0,j}}{dt}=0$。展开右侧：\n$$\n\\frac{dv_j}{dt} = \\left[ -\\frac{a}{h}(u_{0,j} - u_{0,j-1}) + S_j \\right] - \\frac{a}{h}(v_j - v_{j-1})\n$$\n由于格式的适定平衡性质，方括号中的项精确为零。因此，扰动 $v_j$ 的演化方程与稳态 $u_0$ 和源项 $s(x)$ 无关：\n$$\n\\frac{dv_j}{dt} = -\\frac{a}{h}(v_j - v_{j-1})\n$$\n\n### 步骤 3：傅里叶分析\n\n现在我们通过将傅里叶模态 $v_j(t) = \\hat{v} \\exp(i \\theta j + \\lambda(\\theta) t)$ 代入线性化方程来分析扰动的演化。\n左侧变为：\n$$\n\\frac{dv_j}{dt} = \\lambda(\\theta) v_j\n$$\n右侧项为：\n$$\nv_j = \\hat{v} \\exp(i \\theta j + \\lambda(\\theta) t)\n$$\n$$\nv_{j-1} = \\hat{v} \\exp(i \\theta (j-1) + \\lambda(\\theta) t) = \\exp(-i\\theta) v_j\n$$\n将这些代入扰动方程得到：\n$$\n\\lambda(\\theta) v_j = -\\frac{a}{h}(v_j - \\exp(-i\\theta) v_j)\n$$\n两边同除以 $v_j$（非零），得到精确的半离散傅里叶符号 $\\lambda(\\theta)$：\n$$\n\\lambda(\\theta) = -\\frac{a}{h}(1 - \\exp(-i\\theta))\n$$\n\n### 步骤 4：渐近展开和系数识别\n\n为了找到色散和耗散系数，我们对小 $|\\theta|$ 的 $\\lambda(\\theta)$ 进行泰勒级数展开。我们使用指数函数的展开式：\n$$\n\\exp(-i\\theta) = 1 - i\\theta + \\frac{(-i\\theta)^2}{2!} + \\frac{(-i\\theta)^3}{3!} + O(\\theta^4) = 1 - i\\theta - \\frac{\\theta^2}{2} + i\\frac{\\theta^3}{6} + O(\\theta^4)\n$$\n将此代入 $\\lambda(\\theta)$ 的表达式：\n$$\n\\lambda(\\theta) = -\\frac{a}{h} \\left[ 1 - \\left(1 - i\\theta - \\frac{\\theta^2}{2} + i\\frac{\\theta^3}{6} + O(\\theta^4)\\right) \\right]\n$$\n$$\n\\lambda(\\theta) = -\\frac{a}{h} \\left( i\\theta + \\frac{\\theta^2}{2} - i\\frac{\\theta^3}{6} + O(\\theta^4) \\right)\n$$\n$$\n\\lambda(\\theta) = -\\frac{a}{h}\\frac{\\theta^2}{2} - i\\frac{a}{h}\\theta + i\\frac{a}{h}\\frac{\\theta^3}{6} + O(\\theta^4)\n$$\n现在我们分离 $\\lambda(\\theta)$ 的实部和虚部：\n$$\n\\operatorname{Re}(\\lambda(\\theta)) = -\\frac{a}{2h}\\theta^2 + O(\\theta^4)\n$$\n$$\n\\operatorname{Im}(\\lambda(\\theta)) = -\\frac{a}{h}\\theta + \\frac{a}{6h}\\theta^3 + O(\\theta^5)\n$$\n问题通过以下渐近关系定义耗散和色散系数。\n\n**耗散系数 ($C_{\\mathrm{diss}}$):**\n耗散关系由下式给出：\n$$\n-\\operatorname{Re}(\\lambda(\\theta)) = C_{\\mathrm{diss}}\\frac{a}{h}\\theta^{2} + o(\\theta^{2})\n$$\n根据我们的展开，我们有：\n$$\n-\\operatorname{Re}(\\lambda(\\theta)) = - \\left(-\\frac{a}{2h}\\theta^2\\right) = \\frac{1}{2}\\frac{a}{h}\\theta^2\n$$\n比较主阶项，我们发现：\n$$\nC_{\\mathrm{diss}}\\frac{a}{h}\\theta^{2} = \\frac{1}{2}\\frac{a}{h}\\theta^2 \\implies C_{\\mathrm{diss}} = \\frac{1}{2}\n$$\n\n**色散系数 ($C_{\\mathrm{disp}}$):**\n色散关系由下式给出：\n$$\n\\operatorname{Im}(\\lambda(\\theta)) = -\\frac{a}{h}\\theta + C_{\\mathrm{disp}}\\frac{a}{h}\\theta^{3} + o(\\theta^{3})\n$$\n根据我们的展开，我们有：\n$$\n\\operatorname{Im}(\\lambda(\\theta)) = -\\frac{a}{h}\\theta + \\frac{1}{6}\\frac{a}{h}\\theta^3 + O(\\theta^5)\n$$\n比较 $\\theta^3$ 项，我们发现：\n$$\nC_{\\mathrm{disp}}\\frac{a}{h}\\theta^{3} = \\frac{1}{6}\\frac{a}{h}\\theta^3 \\implies C_{\\mathrm{disp}} = \\frac{1}{6}\n$$\n\n主阶系数对为 $(C_{\\mathrm{disp}}, C_{\\mathrm{diss}}) = (\\frac{1}{6}, \\frac{1}{2})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{6}  \\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从一维理论走向二维应用，需要将多个概念融合成一个连贯的算法。最后一个练习  将挑战你为二维浅水方程设计一个完整的、先进的守恒DG格式。你需要综合考虑变量的选择、交界面上的静水重构、守恒的限制器以及计算复杂度，以构建一个鲁棒且高效的实现方案。",
            "id": "3428781",
            "problem": "考虑具有地形的二维浅水方程的守恒形式\n$$\n\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{S}(\\boldsymbol{U},\\nabla b),\n$$\n其中 $\\boldsymbol{U} = \\begin{bmatrix} h \\\\ h u \\\\ h v \\end{bmatrix}$，$\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{bmatrix} h u  h v \\\\ h u^2 + \\tfrac{1}{2} g h^2  h u v \\\\ h u v  h v^2 + \\tfrac{1}{2} g h^2 \\end{bmatrix}$，$\\boldsymbol{S}(\\boldsymbol{U},\\nabla b) = \\begin{bmatrix} 0 \\\\ - g h \\, \\partial_x b \\\\ - g h \\, \\partial_y b \\end{bmatrix}$，$h$ 是水深，$\\boldsymbol{u} = (u,v)$ 是速度，$g$ 是重力加速度，$b$ 是地形。全平衡格式是指能够精确保持静湖稳态的格式，该稳态定义为 $u = 0$，$v = 0$，且 $\\eta \\equiv h + b = \\eta_0$（其中 $\\eta_0$ 为常数）。\n\n将在一个形状规则的网格上实现一个间断 Galerkin (DG) 方法。您必须决定一个算法工作流，该工作流要保证在精确积分下，对于光滑的 $b$，在半离散层面上具有全平衡性质；要指定平衡变量、求积和限制器的具体数据结构；并提供关于单元数量 $N_e$ 和多项式次数 $p$ 的每时间步主阶复杂度分析。\n\n选择提供正确且内部一致的工作流的选项，包括：\n- 主变量的选择以及平衡变量的表示和存储方式，\n- 体积项和面积项（包括任何重构或通量修正）的构造，以实现对静湖状态的精确平衡，\n- 限制器策略及其与平衡状态的相互作用，\n- 高效实现所需的未知量、几何和求积的数据结构，\n- 以及在张量积四边形网格上使用和因子分解的节点 DG 方法时，关于 $N_e$ 和 $p$ 的每时间步正确的主阶计算复杂度（和主要内存占用）。\n\n选项：\n\nA) 在张量积四边形网格上，使用自由面高程 $\\eta = h + b$ 和动量 $(h u, h v)$ 作为每个单元的主多项式场，并采用位于 Gauss–Legendre–Lobatto (GLL) 节点的节点基。对于每个单元索引 $e \\in \\{1,\\dots,N_e\\}$，将变量存储在数组 $\\widehat{\\boldsymbol{U}}[e, v, i, j]$ 中，其中 $v \\in \\{1,2,3\\}$ 且 $(i,j) \\in \\{0,\\dots,p\\}^2$ 保存 $(\\eta, h u, h v)$ 的节点系数；将地形存储为相同节点上的节点场 $b[e,i,j]$；存储几何雅可比和度量项 $\\mathcal{J}[e,i,j]$, $(x_\\xi, x_\\eta, y_\\xi, y_\\eta)[e,i,j]$。使用与 GLL 节点配置的体积积分以及位于面上的 GLL 节点的面积积分。在每个 Runge–Kutta 阶段：使用与节点积分一致的分裂形式 DG 算子评估通量散度；使用相同的积分和度量项离散化源项，使得当 $u=v=0$ 且 $\\eta$ 为常数时，离散通量散度能精确抵消所有节点上的离散源项贡献；在界面处，在近似 Riemann 求解器中应用静水重构，通过 $h^\\pm = \\max(0, \\eta^\\pm - \\max(b_L, b_R))$ 重构左右水深，以确保即使 $b$ 不连续也能精确保持静湖状态。对于限制，将状态分解为平衡部分和扰动部分：计算逐单元的平衡态 $\\eta_{eq} = \\overline{\\eta}$ 和零动量，形成扰动 $\\eta' = \\eta - \\eta_{eq}$、$(h u)' = h u$、$(h v)' = h v$，仅对扰动应用总变差有界 (TVB) 限制器和保正限制器，并通过加回平衡部分进行重构；这能保持稳态。对张量积求值使用和因子分解，使得每步成本对于体积项为 $\\mathcal{O}(N_e\\, p^3)$，对于面积项为 $\\mathcal{O}(N_e\\, p^2)$，解和几何存储的内存占用为 $\\mathcal{O}(N_e\\, p^2)$。\n\nB) 在四边形单元上，使用水深 $h$ 和速度 $(u,v)$ 作为模态标准正交基中的主未知量。仅将地形 $b$ 存储为单元平均值 $b[e]$。使用 $p+1$ 阶的单一 Gauss–Legendre 规则计算体积积分，使用中点通量计算面积积分，并通过从相邻单元平均值进行中心有限差分重构来替换 $\\nabla b$ 以离散化源项。不修改界面处的 Riemann 求解器。在每个时间阶段后，直接对 $\\eta = h + b$ 的节点重构应用总变差递减 (TVD) 限制器。每步成本为 $\\mathcal{O}(N_e\\, p^2)$，内存为 $\\mathcal{O}(N_e\\, p)$。\n\nC) 在三角形单元上，使用自由面高程 $\\eta$ 和动量 $(h u, h v)$ 作为具有分层基的模态场。仅在面上插值点处存储地形 $b$ 以减少内存。通过使用对 $p$ 次多项式精确的体积积分将 $-g h \\nabla b$ 投影到 $p$ 次多项式上，并使用无静水重构的标准 Rusanov 求解器计算通量。通过裁剪负节点值并相应调整 $\\eta$ 来对 $h$ 应用保正限制器，但不分解为平衡部分和扰动部分。假设使用和因子分解，声称每步成本为 $\\mathcal{O}(N_e\\, p^3)$，内存为 $\\mathcal{O}(N_e\\, p^2)$。\n\nD) 使用水深 $h$ 和动量作为主变量场，但为自由面高程 $\\eta$ 维护一个独立的节点场以支持平衡检测。在 GLL 节点处存储地形。使用配置的 GLL 积分计算通量和源项，在面上使用未经修改的标准 Harten–Lax–van Leer (HLL) 通量。在评估源项之前，对 $(h u, h v)$ 应用 TVB 限制器，对 $\\eta$ 应用保正限制器，以确保非负性。使用和因子分解，每步复杂度为 $\\mathcal{O}(N_e\\, p^3)$，内存为 $\\mathcal{O}(N_e\\, p^2)$。\n\n哪个选项满足所有指定要求？",
            "solution": "用户要求对问题陈述进行严格验证，然后对为二维浅水方程构建全平衡间断 Galerkin (DG) 格式所提供的选项进行详细推导和评估。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **控制方程：** 具有地形的二维浅水方程以守恒形式给出：$\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{S}(\\boldsymbol{U},\\nabla b)$。\n- **状态向量：** $\\boldsymbol{U} = \\begin{bmatrix} h \\\\ h u \\\\ h v \\end{bmatrix}$，其中 $h$ 是水深，$(u,v)$ 是速度。\n- **通量张量：** $\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{bmatrix} h u  h v \\\\ h u^2 + \\tfrac{1}{2} g h^2  h u v \\\\ h u v  h v^2 + \\tfrac{1}{2} g h^2 \\end{bmatrix}$，其中 $g$ 是重力加速度。\n- **源项：** $\\boldsymbol{S}(\\boldsymbol{U},\\nabla b) = \\begin{bmatrix} 0 \\\\ - g h \\, \\partial_x b \\\\ - g h \\, \\partial_y b \\end{bmatrix}$，其中 $b$ 是地形。\n- **稳态：** “静湖”稳态定义为 $u = 0$，$v = 0$，且 $\\eta \\equiv h + b = \\eta_0$，其中 $\\eta_0$ 是一个常数自由面高程。\n- **数值方法：** 在形状规则网格上的间断 Galerkin (DG) 方法。\n- **目标：** 选择一个算法工作流，该工作流：\n    1. 在精确积分下，对于光滑的 $b$，在半离散层面上对静湖状态是全平衡的。\n    2. 指定变量、求积和限制器的数据结构。\n    3. 提供关于单元数量 $N_e$ 和多项式次数 $p$ 的每时间步主阶复杂度分析。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于流体动力学（浅水方程）和数值分析（间断 Galerkin 方法、全平衡格式）的既定原理。所使用的方程、定义和概念在计算水力学和双曲守恒律数值方法领域都是标准的。该问题在科学上和数学上都是合理的。\n- **适定性：** 该问题要求从一组选项中识别出正确且一致的算法描述。这是一个明确定义的任务，根据指定领域的既定理论和实践，有唯一且有意义的解决方案。\n- **客观性：** 语言精确、技术性强，没有主观或含糊的术语。在 DG 方法的背景下，所有使用的术语都具有特定的、正式的含义。\n- **结论：** 问题陈述未违反任何无效标准。它科学合理、适定、客观、自洽且不平凡。它提出了一个计算科学领域中有效且实质性的问题。\n\n**第 3 步：判定与行动**\n- **判定：** 该问题是 **有效的**。\n- **行动：** 继续进行求解和选项评估。\n\n### 正确工作流的推导\n\n一个用于浅水方程的全平衡 DG 格式必须精确保持静湖稳态，即速度为零且自由面高程 $\\eta = h+b$ 为常数。该状态的特征是通量散度产生的压力梯度项与地形梯度引起的源项之间的精确平衡。\n\n动量方程可以重写以明确显示这种平衡。对于 $x$ 方向动量，通量散度与源项合并为：\n$$\n\\partial_x \\left( \\frac{1}{2} g h^2 \\right) - S_x = g h \\, \\partial_x h - (-g h \\, \\partial_x b) = g h (\\partial_x h + \\partial_x b) = g h \\, \\partial_x \\eta\n$$\n如果一个数值格式对此项的离散近似在 $\\eta$ 为常数时为零，那么该格式就是全平衡的。这要求对所有分量进行仔细、一致的离散化。\n\n一个鲁棒的全平衡 DG 格式包含以下关键要素：\n\n1.  **变量的选择：** 使用自由面高程 $\\eta$ 和动量分量 $(hu, hv)$ 作为主要演化的多项式变量非常有利。在这种表述中，静湖条件简化为 $\\eta$ 是一个常数多项式，动量是每个单元内的零多项式。这自然导致项 $g h \\, \\partial_x \\eta$ 在单元内为零，因为常数的导数为零。\n\n2.  **源项和通量项的离散化：** 为了在单元内部局部保持平衡，通量散度和源项的离散化必须是相容的。对于节点 DG 格式，一种常用且有效的方法是用与解相同次数 $p$ 的多项式来表示地形 $b$，通常通过在解节点（例如 Gauss-Legendre-Lobatto 节点）上存储其值来实现。然后，水深 $h = \\eta - b$ 也是一个 $p$ 次多项式。这样，就可以计算像 $g h \\, \\partial_x \\eta$ 这样的项。如果 $\\eta$ 表示为常数，则在所有求积点上 $\\partial_x \\eta$ 恒为零，从而确保平衡。\n\n3.  **界面通量处理：** 标准的近似 Riemann 求解器（如 Rusanov, HLL, HLLC）在界面处会失效。对于静湖状态，$\\eta_L = \\eta_R = \\eta_0$，但如果 $b_L \\neq b_R$，则 $h_L \\neq h_R$。标准求解器会看到压力项 $\\frac{1}{2} g h^2$ 的跳跃并产生伪动量通量，从而破坏稳态。这通过 **静水重构** 来纠正。在调用 Riemann 求解器之前，左右状态 $(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$ 会被修改。一种常见的重构方法定义了新的水深 $h_L^* = \\eta_L - b^*$ 和 $h_R^* = \\eta_R - b^*$，其中 $b^*$ 是界面处一个经过仔细选择的单一地形值（例如 $b^*=\\max(b_L, b_R)$）。在静湖状态下，这会导致 $h_L^* = h_R^*$。在水深相等且动量为零的情况下，均匀 SWE 的 Riemann 求解器会正确地产生跨界面的零动量通量。\n\n4.  **限制器策略：** 为了在处理激波时不破坏稳态，必须以全平衡的方式应用限制器。对守恒变量 $(h, hu, hv)$ 或原始变量应用标准的 TVD/TVB 限制器会破坏精细的 $h+b=\\text{const}$ 平衡。正确的程序是将解 $\\boldsymbol{U}$ 分解为平衡部分 $\\boldsymbol{U}_{eq}$ 和扰动 $\\boldsymbol{U}'$。平衡部分通常逐单元定义为 $\\eta_{eq} = \\overline{\\eta}$（$\\eta$ 的单元平均值）和零动量。扰动则为 $\\eta' = \\eta - \\eta_{eq}$ 和 $(hu)' = hu, (hv)' = hv$。斜率限制器*仅*应用于扰动 $\\boldsymbol{U}'$。最终的受限解通过加回平衡部分来重构。这确保了限制器不会在平衡态本身上激活。\n\n5.  **复杂度和数据结构：** 对于在张量积四边形网格上，每个方向有 $(p+1)$ 个节点的二维节点 DG 格式，高效实现依赖于 **和因子分解**。\n    - **内存：** 解变量 ($\\eta, hu, hv$)、地形 ($b$) 和几何因子（雅可比、度量项）必须存储在 $N_e \\times (p+1)^2$ 个节点中的每一个上。因此，主要内存占用为 $\\mathcal{O}(N_e p^2)$。\n    - **计算成本：**\n        - **体积项：** 评估如散度之类的算子涉及沿每个张量方向应用一维微分矩阵。使用和因子分解，每个单元的成本为 $\\mathcal{O}(p^3)$，导致总体积成本为 $\\mathcal{O}(N_e p^3)$。\n        - **面积项：** 这些涉及在每个单元的 4 个面上进行计算。每个面有 $(p+1)$ 个求积点。“提升操作”将面积积分传递到体积中，涉及在每个面上进行大小为 $(p+1) \\times (p+1)$ 的矩阵向量乘积。这导致每个单元的成本为 $\\mathcal{O}(p^2)$，总面积成本为 $\\mathcal{O}(N_e p^2)$。\n    - 对于 $p>1$，每时间步的总成本由体积项主导，其规模为 $\\mathcal{O}(N_e p^3)$。\n\n### 逐项分析\n\n**选项 A)**\n此选项提出的工作流与上述推导的原理完全一致。\n- **变量与数据结构：** 正确选择 $(\\eta, hu, hv)$ 作为 GLL 节点上的节点场，地形 $b$ 也作为节点场存储。这是最优选择。\n- **离散化：** 正确指出了需要对源项和通量项进行一致的离散化以实现平衡。\n- **界面通量：** 正确指定了使用静水重构，并提供了一个有效的公式 $h^\\pm = \\max(0, \\eta^\\pm - \\max(b_L, b_R))$，这是一种标准且有效的方法。\n- **限制器：** 正确描述了最先进的全平衡限制程序：分解为平衡和扰动，仅限制扰动，然后重构。\n- **复杂度：** 对于使用和因子分解的四边形节点 DG 格式，正确地陈述了体积成本为 $\\mathcal{O}(N_e p^3)$，面积成本为 $\\mathcal{O}(N_e p^2)$，内存为 $\\mathcal{O}(N_e p^2)$。\n- **判定：** **正确**。\n\n**选项 B)**\n此选项包含多个基本错误。\n- **变量与数据结构：** 使用 $(h, u, v)$ 不是最优选择。仅将地形 $b$ 存储为单元平均值（$p=0$ 的表示）与高阶 ($p>0$) 方法不兼容，并且使得在有坡度的底部上保持稳态变得不可能。\n- **离散化：** 使用有限差分风格的重构来处理 $\\nabla b$ 与 DG 框架不一致，不会产生全平衡格式。\n- **界面通量：** 明确指出“不修改 Riemann 求解器”，这是全平衡格式的致命缺陷。\n- **限制器：** 提议的限制策略非标准，且未使用所需的平衡-扰动分解。\n- **复杂度：** 对于一个 $p$ 次多项式的二维方法，$\\mathcal{O}(N_e p)$ 的内存复杂度是错误的；它应该是 $\\mathcal{O}(N_e p^2)$。\n- **判定：** **不正确**。\n\n**选项 C)**\n此选项也有几个主要缺陷。\n- **数据结构：** 仅在单元面上存储地形不足以平衡体积项，体积项需要在单元内部表示 $b$。\n- **界面通量：** 提议使用“无静水重构”的标准 Rusanov 求解器，如前所述，这会破坏全平衡性质。\n- **限制器：** 未使用平衡-扰动分解，这对于全平衡限制器是必需的。\n- **复杂度：** 错误地将“和因子分解”一词应用于三角形单元，该技术并非为此设计，这表明存在概念性错误。虽然存在针对三角形的快速方法，但此处的理由在技术上是错误的。\n- **判定：** **不正确**。\n\n**选项 D)**\n此选项在其核心算法选择上包含关键错误。\n- **变量与数据结构：** 提议的变量集冗余且笨拙。更重要的是，使用 $h$ 作为主变量使全平衡变得复杂。\n- **界面通量：** 与选项 B 和 C 一样，陷入了使用标准、未经修改的 HLL 通量的陷阱，这种通量不是全平衡的。\n- **限制器：** 提议的限制策略未包含平衡-扰动分解，因此不是全平衡的。为保正性而限制 $\\eta$ 在概念上也是错误的；保正性适用于 $h$。\n- **判定：** **不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}