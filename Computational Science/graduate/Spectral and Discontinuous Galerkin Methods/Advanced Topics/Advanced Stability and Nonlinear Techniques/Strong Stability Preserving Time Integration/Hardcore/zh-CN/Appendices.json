{
    "hands_on_practices": [
        {
            "introduction": "强稳定性保持（SSP）性质可以通过两种互补的视角来理解：一种是分析视角，关注稳定多项式的绝对单调性；另一种是代数视角，关注将方法表示为前向欧拉步的凸组合。本练习以经典的二阶Heun方法为例，从第一性原理出发，推导其绝对单调性半径$R$和其Shu-Osher形式中的SSP系数$C$。通过这个过程，你将亲手验证并理解这两个看似不同的稳定性概念为何对于最优SSP方法是等价的，从而加深对SSP理论核心的认识。",
            "id": "3421294",
            "problem": "考虑一个由线性平流的间断 Galerkin 空间离散产生的半离散系统，其抽象形式写作 $u^{\\prime}(t) = \\mathcal{L}(u(t))$，其中已知前向欧拉法在条件 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$ 下是单调的（例如，总变差递减）。将两步二阶 Heun 格式（也称为显式梯形方法）应用于此系统，其步骤定义如下：\n$$\nu^{(1)} = u^{n} + \\Delta t\\, \\mathcal{L}(u^{n}), \\qquad\nu^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\Big(\\mathcal{L}(u^{n}) + \\mathcal{L}(u^{(1)})\\Big).\n$$\n使用线性测试方程 $y^{\\prime} = \\lambda y$（其中 $z = \\Delta t\\, \\lambda$），从第一性原理出发完成以下任务：\n- 推导该方法的稳定性多项式 $p(z)$，其定义为 $y^{n+1} = p(z)\\, y^{n}$。\n- 使用显式 Runge-Kutta 方法的绝对单调性定义，确定绝对单调半径 $R$，即最大的实数 $R \\ge 0$，使得该方法在区间 $[-R, 0]$ 上是绝对单调的。\n- 将该方法表示为与强稳定性保持 (SSP) 时间积分相关的 Shu-Osher 形式，并确定相应的 SSP 系数 $C$，该系数在 $\\Delta t \\le C\\, \\Delta t_{\\mathrm{FE}}$ 时保证单调性。\n- 在负实轴上比较 $R$ 和 $C$，并仅使用稳定性函数、绝对单调性和 Shu-Osher 表示法的核心定义，来证明你得到的任何等式或不等式。\n\n作为最终报告结果，提供绝对单调半径 $R$ 的值。该量是无量纲的。无需四舍五入，请报告精确值。",
            "solution": "该问题要求在强稳定性保持 (SSP) 时间积分的背景下分析两步二阶 Heun 方法。我们将按顺序完成这四个要求的任务。\n\n数值格式由下式给出：\n$$\nu^{(1)} = u^{n} + \\Delta t\\, \\mathcal{L}(u^{n})\n$$\n$$\nu^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\Big(\\mathcal{L}(u^{n}) + \\mathcal{L}(u^{(1)})\\Big)\n$$\n\n半离散系统为 $u^{\\prime}(t) = \\mathcal{L}(u(t))$，并且假定前向欧拉法 $u^{n+1} = u^n + \\Delta t \\mathcal{L}(u^n)$ 在时间步长 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$ 时是单调的。\n\n**1. 稳定性多项式 $p(z)$ 的推导**\n\n为了找到稳定性多项式，我们将该方法应用于线性测试方程 $y^{\\prime} = \\lambda y$，其中 $\\lambda$ 是一个复常数。在这种情况下，算子 $\\mathcal{L}$ 对应于乘以 $\\lambda$，因此 $\\mathcal{L}(y) = \\lambda y$。我们定义 $z = \\Delta t \\lambda$。\n\n首先，我们计算中间步 $y^{(1)}$：\n$$\ny^{(1)} = y^{n} + \\Delta t (\\lambda y^{n}) = (1 + \\Delta t \\lambda) y^{n} = (1 + z) y^{n}\n$$\n接着，我们计算到下一个时间层 $y^{n+1}$ 的更新：\n$$\ny^{n+1} = y^{n} + \\frac{\\Delta t}{2}\\Big(\\mathcal{L}(y^{n}) + \\mathcal{L}(y^{(1)})\\Big) = y^{n} + \\frac{\\Delta t}{2}\\Big(\\lambda y^{n} + \\lambda y^{(1)}\\Big)\n$$\n代入 $y^{(1)}$ 的表达式：\n$$\ny^{n+1} = y^{n} + \\frac{\\Delta t}{2}\\Big(\\lambda y^{n} + \\lambda (1 + z) y^{n}\\Big)\n$$\n从右侧提出因子 $y^n$：\n$$\ny^{n+1} = \\left[ 1 + \\frac{\\Delta t \\lambda}{2}\\Big(1 + (1 + z)\\Big) \\right] y^{n} = \\left[ 1 + \\frac{z}{2}(2 + z) \\right] y^{n}\n$$\n化简括号中的表达式，得到稳定性多项式 $p(z)$：\n$$\ny^{n+1} = \\left[ 1 + z + \\frac{z^2}{2} \\right] y^{n}\n$$\n因此，稳定性多项式为 $p(z) = 1 + z + \\frac{1}{2}z^2$。这是 $\\exp(z)$ 的二阶泰勒级数展开，与二阶 Runge-Kutta 方法的预期相符。\n\n**2. 绝对单调半径 $R$ 的确定**\n\n一个具有稳定性多项式 $p(z)$ 的显式 Runge-Kutta 方法，如果在区间 $[-R, 0]$ 上对所有的 $z \\in [-R, 0]$，其所有阶导数都是非负的，则称该方法在该区间上是绝对单调的。也就是说，对于所有整数 $k \\ge 0$ 和所有 $z \\in [-R, 0]$，必须有 $p^{(k)}(z) \\ge 0$。\n\n我们计算 $p(z) = 1 + z + \\frac{1}{2}z^2$ 的各阶导数：\n- $p^{(0)}(z) = p(z) = 1 + z + \\frac{1}{2}z^2$\n- $p^{(1)}(z) = p'(z) = 1 + z$\n- $p^{(2)}(z) = p''(z) = 1$\n- 对于 $k \\ge 3$，$p^{(k)}(z) = 0$\n\n现在我们检查在区间 $z \\in [-R, 0]$ 上每个导数的非负性条件：\n- 对于 $k \\ge 2$，导数 $1$ 和 $0$ 总是非负的，因此它们对 $R$ 没有施加任何限制。\n- 对于 $p(z) = 1 + z + \\frac{1}{2}z^2$：这是一个开口向上的抛物线。其顶点（最小值）出现在 $p'(z) = 0$ 处，即 $z=-1$。最小值为 $p(-1) = 1 - 1 + \\frac{1}{2}(-1)^2 = \\frac{1}{2}$。由于该最小值为正，所以对于所有实数 $z$，$p(z)  0$。此条件对 $R$ 没有施加任何限制。\n- 对于 $p'(z) = 1 + z$：我们要求对于所有 $z \\in [-R, 0]$，有 $1 + z \\ge 0$。此区间中最具限制性的点是 $z = -R$。该条件变为 $1 + (-R) \\ge 0$，化简后为 $R \\le 1$。\n\n为了同时满足所有条件，我们必须有 $R \\le 1$。绝对单调半径 $R$ 是满足此条件的最大值，因此 $R=1$。\n\n**3. Shu–Osher 形式和 SSP 系数 $C$**\n\n如果一个方法可以表示为前向欧拉步的凸组合，则该方法是强稳定性保持 (SSP) 的。目标是将 Heun 格式重写为 Shu-Osher 形式：\n$u^{(0)} = u^{n}$\n$u^{(i)} = \\sum_{j=0}^{i-1} \\left( \\alpha_{ij} u^{(j)} + \\Delta t \\beta_{ij} \\mathcal{L}(u^{(j)}) \\right)$，其中 $\\alpha_{ij} \\ge 0, \\beta_{ij} \\ge 0$。\n如果对每个步 $i$，$\\sum_{j=0}^{i-1} \\alpha_{ij} = 1$，则该方法是 SSP 的。SSP 系数 $C$ 则由 $C = \\min_{i,j, \\beta_{ij}0} \\frac{\\alpha_{ij}}{\\beta_{ij}}$ 给出。\n\n让我们对给定的格式进行变换。我们定义 $u^{(0)}=u^n$。第一步是一个前向欧拉步：\n$u^{(1)} = u^n + \\Delta t \\mathcal{L}(u^n) = u^{(0)} + \\Delta t \\mathcal{L}(u^{(0)})$。\n这与 $i=1$ 时的 Shu-Osher 形式相匹配，其中 $\\alpha_{10}=1$ 且 $\\beta_{10}=1$。\n\n现在我们重写最后一步 $u^{n+1}$，我们将其标记为 $u^{(2)}$：\n$u^{n+1} = u^n + \\frac{1}{2}\\Delta t \\mathcal{L}(u^n) + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n我们可以策略性地将其重写为：\n$u^{n+1} = \\frac{1}{2}u^n + \\frac{1}{2}u^n + \\frac{1}{2}\\Delta t \\mathcal{L}(u^n) + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n合并项：\n$u^{n+1} = \\frac{1}{2}u^n + \\frac{1}{2}(u^n + \\Delta t \\mathcal{L}(u^n)) + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n代入 $u^{(0)}=u^n$ 和 $u^{(1)} = u^n + \\Delta t \\mathcal{L}(u^n)$：\n$u^{n+1} = \\frac{1}{2}u^{(0)} + \\frac{1}{2}u^{(1)} + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n我们可以将与 $u^{(1)}$ 相关的项组合起来：\n$u^{n+1} = \\frac{1}{2}u^{(0)} + \\frac{1}{2}(u^{(1)} + \\Delta t \\mathcal{L}(u^{(1)}))$\n\n这个表达式是 $u^{(0)}$ 和应用于 $u^{(1)}$ 的一个前向欧拉步的凸组合。完整的 Shu-Osher 表示法为：\n$u^{(0)} = u^n$\n$u^{(1)} = 1 \\cdot u^{(0)} + \\Delta t \\cdot 1 \\cdot \\mathcal{L}(u^{(0)})$\n$u^{(2)} = u^{n+1} = \\frac{1}{2} u^{(0)} + \\frac{1}{2} u^{(1)} + \\Delta t \\cdot 0 \\cdot \\mathcal{L}(u^{(0)}) + \\Delta t \\cdot \\frac{1}{2} \\mathcal{L}(u^{(1)})$\n系数为：\n- 对于 $i=1$ 步：$\\alpha_{10}=1, \\beta_{10}=1$。\n- 对于 $i=2$ 步：$\\alpha_{20}=1/2, \\alpha_{21}=1/2$，因此 $\\sum \\alpha_{2j} = 1$。并且 $\\beta_{20}=0, \\beta_{21}=1/2$。\n所有系数 $\\alpha_{ij}, \\beta_{ij}$ 均为非负。\nSSP 系数是当 $\\beta_{ij}0$ 时比值 $\\alpha_{ij}/\\beta_{ij}$ 的最小值：\n$C = \\min\\left( \\frac{\\alpha_{10}}{\\beta_{10}}, \\frac{\\alpha_{21}}{\\beta_{21}} \\right) = \\min\\left( \\frac{1}{1}, \\frac{1/2}{1/2} \\right) = \\min(1, 1) = 1$。\nSSP 系数为 $C=1$。在 $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}}$ 时，单调性得到保证。\n\n**4. $R$ 和 $C$ 的比较与证明**\n\n我们发现绝对单调半径为 $R=1$，SSP 系数为 $C=1$。因此，对于该方法，$R=C$。\n\n这个等式并非巧合，它是 SSP 方法理论中的一个基本结果。其证明依赖于 Shu-Osher 表示法与稳定性多项式性质之间的联系。\n如果一个方法有一个 Shu-Osher 表示法，其中所有系数 $\\alpha_{ij}, \\beta_{ij}$ 都是非负的，并且满足 $\\alpha_{ij} \\ge C\\beta_{ij}$，那么该方法是具有系数 $C$ 的 SSP 方法。\n让我们证明这蕴含了在 $[-C, 0]$ 上的绝对单调性。\n每个步的稳定性多项式 $p_i(z)$ 遵循递推关系：\n$p_i(z) = \\sum_{j=0}^{i-1} (\\alpha_{ij} + z\\beta_{ij}) p_j(z)$，其中 $p_0(z)=1$。\n在 SSP 条件 $\\alpha_{ij} \\ge C\\beta_{ij}$ 下，我们可以写出 $\\alpha_{ij} = C\\beta_{ij} + \\gamma_{ij}$，其中 $\\gamma_{ij} \\ge 0$。\n该递推关系变为 $p_i(z) = \\sum_{j=0}^{i-1} [\\beta_{ij}(C+z) + \\gamma_{ij}] p_j(z)$。\n我们可以通过对步数索引 $i$ 进行数学归纳法来证明，对于所有 $k \\ge 0$ 和 $z \\in [-C, 0]$，有 $p_i^{(k)}(z) \\ge 0$。\n- 基础情形 ($i=0$)：$p_0(z)=1$。其所有阶导数都是非负的。\n- 归纳步骤：假设对于所有 $j  i$ 和所有 $k \\ge 0$，在 $[-C, 0]$ 上 $p_j^{(k)}(z) \\ge 0$。那么对于 $p_i(z)$，我们有一个项的和 $[\\beta_{ij}(C+z) + \\gamma_{ij}] p_j(z)$。在 $[-C, 0]$上，我们有 $C+z \\ge 0$。由于 $\\beta_{ij}, \\gamma_{ij} \\ge 0$ 且根据归纳假设 $p_j(z) \\ge 0$，可得出 $p_i(z) \\ge 0$。\n通过将乘积求导法则应用于该递推公式，每个导数 $p_i^{(k)}(z)$ 在 $[-C, 0]$ 上都将是一系列非负项的和。例如，$p_i'(z) = \\sum [\\beta_{ij}p_j(z) + (\\beta_{ij}(C+z) + \\gamma_{ij})p_j'(z)]$，它是一系列非负量的和。\n这就证明了如果一个方法是具有系数 $C$ 的 SSP 方法，那么它在 $[-C, 0]$ 上必须是绝对单调的。根据绝对单调半径 $R$ 的定义，这意味着 $R \\ge C$。\n\n对于最优 SSP 方法，如此处考虑的方法，其 SSP 系数是最大化的，从而导致等式 $R=C$。我们从第一性原理出发的独立计算（从 $p(z)$ 的导数得到 $R=1$，从 Shu-Osher 形式得到 $C=1$）证实了 Heun 方法的这一等式。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在掌握了基本SSP方法分析之后，我们可以进而研究更实用、更广泛应用的高阶格式，例如三阶三级的SSPRK(3,3)方法。本练习的核心任务是从给定的Butcher表中推导出方法的Shu-Osher表示，这是分析或实现任何SSP格式的关键实践技能。通过将每个阶段重写为前向欧拉更新的凸组合，你将确定该方法的SSP系数$C$，并识别出哪个阶段对时间步长施加了最严格的限制，从而决定了最终的稳定性边界。",
            "id": "3421345",
            "problem": "考虑一个由标量守恒律的间断伽辽金 (DG) 离散化产生的半离散演化方程，该离散化使用了单调数值通量和适当的限制器，可写为 $u^{\\prime}(t)=L(u(t))$ 的形式。该方程定义在一个巴拿赫空间上，具有一个凸泛函 $\\|\\cdot\\|$，使得前向欧拉法 $u^{\\mathrm{FE}}=u+\\Delta t\\,L(u)$ 是单调的，即当 $0\\leq \\Delta t \\leq \\Delta t_{\\mathrm{FE}}$ 时，$\\|u+\\Delta t\\,L(u)\\|\\leq\\|u\\|$。一个显式强稳定性保持龙格-库塔 (SSPRK) 方法在时间步长限制 $\\Delta t \\leq C\\,\\Delta t_{\\mathrm{FE}}$ 下是单调的，前提是该方法允许使用 Shu-Osher 表示，其中每个内插步都是具有非负系数的前向欧拉步的凸组合，并且前向欧拉子步的缩放因子不超过 $C$。\n\n给定 $3$ 阶 $3$ 级的强稳定性保持龙格-库塔方法 $\\mathrm{SSPRK}(3,3)$ 的布卓表示图：\n$$\n\\begin{array}{c|ccc}\n0  0  0  0 \\\\\n1  1  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{4}  \\frac{1}{4}  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{6}  \\frac{2}{3}\n\\end{array}\n$$\n从上述定义出发，并仅使用此表示图中的信息，完成以下任务：\n\n1. 将每个步改写为形如 $u+\\gamma\\,\\Delta t\\,L(u)$（其中 $\\gamma\\geq 0$）的前向欧拉更新的凸组合，从而推导此方法的 Shu-Osher 形式，并明确写出所有凸组合系数和前向欧拉缩放因子。\n\n2. 根据你推导的 Shu-Osher 形式，确定 $\\mathrm{SSPRK}(3,3)$ 的强稳定性保持系数 $C$。$C$ 定义为使得该方法在 $0\\leq \\Delta t \\leq C\\,\\Delta t_{\\mathrm{FE}}$ 时保持单调的最大实数。\n\n3. 指出哪个（些）内插步对 $C$ 施加了约束性限制，即前向欧拉缩放因子等于你推导的 Shu-Osher 表示中所有前向欧拉子步中最小值的那个（些）步。\n\n将你的最终答案表示为一个行向量，其中包含 $C$ 以及按升序排列的约束性步的索引。无需四舍五入，不涉及物理单位。",
            "solution": "我们将首先验证问题的前提和结构，然后系统地解答所要求的三个任务。\n\n## 问题验证\n\n### 步骤 1：提取已知条件\n- **控制方程**：半离散系统为 $u^{\\prime}(t)=L(u(t))$。\n- **算子性质**：空间算子 $L$ 使得前向欧拉 (FE) 法 $u^{\\mathrm{FE}}=u+\\Delta t\\,L(u)$ 在时间步长 $0\\leq \\Delta t \\leq \\Delta t_{\\mathrm{FE}}$ 内是单调的。单调性是关于一个凸泛函 $\\|\\cdot\\|$ 定义的，即 $\\|u+\\Delta t\\,L(u)\\|\\leq\\|u\\|$。\n- **SSPRK 定义**：一个显式龙格-库塔方法是强稳定性保持 (SSP) 的，如果它在条件 $\\Delta t \\leq C\\,\\Delta t_{\\mathrm{FE}}$ 下是单调的。如果该方法具有 Shu-Osher 表示，其中每个步都是前向欧拉步的凸组合，则此性质成立。\n- **布卓表示图**：给定的方法是 SSPRK(3,3)，其表示图为：\n$$\n\\begin{array}{c|ccc}\n0  0  0  0 \\\\\n1  1  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{4}  \\frac{1}{4}  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{6}  \\frac{2}{3}\n\\end{array}\n$$\n- **任务**：\n  1. 推导该方法的 Shu-Osher 形式。\n  2. 确定 SSP 系数 $C$。\n  3. 根据给定的定义“前向欧拉缩放因子等于所有前向欧拉子步中的最小值”，确定约束性步。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于微分方程数值方法理论，特别是强稳定性保持时间积分格式。其定义和给定的布卓表示图在该领域都是标准的。任务 1 和任务 2 的提法很明确，属于标准的推导过程。\n\n然而，任务 3 在其“约束性限制”的定义中存在关键的歧义。字面解释会导致科学上的矛盾。SSP 方法的稳定性依赖于确保对于每个形如 $u' = u + \\gamma \\Delta t L(u)$ 的子步，有效时间步长 $\\gamma \\Delta t$ 不超过 $\\Delta t_{\\mathrm{FE}}$。因此，对全局时间步长 $\\Delta t$ 的约束是 $\\Delta t \\le \\Delta t_{\\mathrm{FE}} / \\gamma$。“约束性”限制——即对 $\\Delta t$ 限制最严格的那个——来自于具有*最大*缩放因子 $\\gamma$ 的子步，而非最小的那个。最小的缩放因子（例如 $\\gamma=0$）提供最弱的约束（或根本没有约束），因此不可能是“约束性”的。\n\n问题的定义——“所有前向欧拉子步中的最小值”——指向了非约束性的子步。这是一个缺陷，违反了**科学或事实不健全性**（1），并使任务变得**不适定**（5）。\n\n然而，在合理的解释下，该问题可以被解决。术语“前向欧拉子步”可以被解释为排除了缩放因子 $\\gamma$ 为零的平凡情况，因为这些并非真正的“步”。在此解释下，我们将考虑所有*正*缩放因子中的最小值。对于特定的 SSPRK(3,3) 方法，所有正缩放因子恰好相等，这使得“最小正值”和“最大值”重合。我们采纳此解释继续进行，并指出问题陈述中的缺陷。\n\n### 步骤 3：结论与行动\n在对第三个任务进行特定且必要的解释后，该问题被视为**有效**。我们现在开始进行完整解答。\n\n## 解答\n\n显式 $s$ 级龙格-库塔方法求解 $u' = L(u)$ 的一般形式为：\n$$\nk_i = L\\left(u^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} k_j\\right), \\quad i=1, \\dots, s\n$$\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b_i k_i\n$$\n从给定的 SSPRK(3,3) 布卓表示图可知，$s=3$，系数为 $a_{21}=1$，$a_{31}=1/4$，$a_{32}=1/4$，以及 $b_1=1/6$，$b_2=1/6$，$b_3=2/3$。所有其他 $j \\ge i$ 的 $a_{ij}$ 均为零。\n\n令 $u^{(0)} = u^n$ 为时间步开始时的解。\n\n### 任务 1：推导 Shu–Osher 形式\n\nShu-Osher 表示法将龙格-库塔方法的每个中间步表示为先前步值的凸组合，这些值通过类似前向欧拉的步骤进行更新。我们定义中间步 $u^{(i)}$ 为函数 $L$ 的宗量。\n\n**第 1 步：**\n第一步的向量为 $k_1 = L(u^n) = L(u^{(0)})$。\n用于计算 $k_2$ 的第一个中间步值为：\n$$\nu^{(1)} = u^n + \\Delta t \\, a_{21} k_1 = u^n + \\Delta t \\, L(u^n)\n$$\n用 $u^{(0)}$ 表示：\n$$\nu^{(1)} = u^{(0)} + \\Delta t \\, L(u^{(0)})\n$$\n这已经是一个前向欧拉步的形式。我们可以将其写成一个（平凡的）凸组合：\n$$\nu^{(1)} = 1 \\cdot (u^{(0)} + 1 \\cdot \\Delta t \\, L(u^{(0)}))\n$$\n凸组合系数为 $1$，前向欧拉缩放因子为 $\\gamma=1$。\n\n**第 2 步：**\n第二步的向量为 $k_2 = L(u^{(1)})$。用于计算 $k_3$ 的第二个中间步值为：\n$$\nu^{(2)} = u^n + \\Delta t \\, (a_{31} k_1 + a_{32} k_2) = u^n + \\frac{\\Delta t}{4} L(u^n) + \\frac{\\Delta t}{4} L(u^{(1)})\n$$\n为将其表示为 Shu-Osher 形式，我们必须将其写成先前步（$u^{(0)}$ 和 $u^{(1)}$）的前向欧拉步的凸组合。根据 $u^{(1)}$ 的定义，我们有 $\\Delta t \\, L(u^n) = u^{(1)} - u^n$。代入此式：\n$$\nu^{(2)} = u^n + \\frac{1}{4}(u^{(1)} - u^n) + \\frac{\\Delta t}{4} L(u^{(1)})\n$$\n$$\nu^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}u^{(1)} + \\frac{\\Delta t}{4} L(u^{(1)})\n$$\n整理各项并使用 $u^{(0)}=u^n$：\n$$\nu^{(2)} = \\frac{3}{4}u^{(0)} + \\frac{1}{4}(u^{(1)} + \\Delta t \\, L(u^{(1)}))\n$$\n这是一个凸组合。系数为 $\\frac{3}{4}$ 和 $\\frac{1}{4}$，它们非负且和为 $1$。各项为：\n- 从 $u^{(0)}$ 出发的一步：我们可以将 $\\frac{3}{4}u^{(0)}$ 写为 $\\frac{3}{4}(u^{(0)} + 0 \\cdot \\Delta t \\, L(u^{(0)}))$。缩放因子为 $\\gamma=0$。\n- 从 $u^{(1)}$ 出发的一步：$\\frac{1}{4}(u^{(1)} + 1 \\cdot \\Delta t \\, L(u^{(1)}))$。缩放因子为 $\\gamma=1$。\n\n**第 3 步（最终更新）：**\n最终解为 $u^{n+1}$。为保持一致性，我们将其记为 $u^{(3)}$。步向量 $k_3$ 为 $L(u^{(2)})$。\n$$\nu^{(3)} = u^{n+1} = u^n + \\Delta t (b_1 k_1 + b_2 k_2 + b_3 k_3)\n$$\n$$\nu^{(3)} = u^n + \\frac{\\Delta t}{6} L(u^n) + \\frac{\\Delta t}{6} L(u^{(1)}) + \\frac{2\\Delta t}{3} L(u^{(2)})\n$$\n我们使用之前推导的关系式：$\\Delta t \\, L(u^n) = u^{(1)} - u^n$ 和 $\\Delta t \\, L(u^{(1)}) = 4u^{(2)} - 3u^n - u^{(1)}$。代入这些：\n$$\nu^{(3)} = u^n + \\frac{1}{6}(u^{(1)} - u^n) + \\frac{1}{6}(4u^{(2)} - 3u^n - u^{(1)}) + \\frac{2\\Delta t}{3} L(u^{(2)})\n$$\n合并 $u^n$、$u^{(1)}$ 和 $u^{(2)}$ 的系数：\n- $u^n$ 的系数：$1 - \\frac{1}{6} - \\frac{3}{6} = \\frac{6-1-3}{6} = \\frac{2}{6} = \\frac{1}{3}$。\n- $u^{(1)}$ 的系数：$\\frac{1}{6} - \\frac{1}{6} = 0$。\n- $u^{(2)}$ 的系数：$\\frac{4}{6} = \\frac{2}{3}$。\n表达式简化为：\n$$\nu^{(3)} = \\frac{1}{3}u^n + \\frac{2}{3}u^{(2)} + \\frac{2\\Delta t}{3} L(u^{(2)})\n$$\n整理各项并使用 $u^{(0)}=u^n$：\n$$\nu^{(3)} = \\frac{1}{3}u^{(0)} + \\frac{2}{3}(u^{(2)} + \\Delta t \\, L(u^{(2)}))\n$$\n这是一个凸组合。系数为 $\\frac{1}{3}$ 和 $\\frac{2}{3}$。各项为：\n- 从 $u^{(0)}$ 出发的一步：$\\frac{1}{3}(u^{(0)} + 0 \\cdot \\Delta t \\, L(u^{(0)}))$。缩放因子为 $\\gamma=0$。\n- 从 $u^{(2)}$ 出发的一步：$\\frac{2}{3}(u^{(2)} + 1 \\cdot \\Delta t \\, L(u^{(2)}))$。缩放因子为 $\\gamma=1$。\n\n### 任务 2：确定 SSP 系数 $C$\n\n如果对于每个形如 $u' = u + \\gamma \\Delta t L(u)$ 的子步，都满足条件 $\\gamma \\Delta t \\le \\Delta t_{\\mathrm{FE}}$，则该方法是单调的。这必须对 Shu-Osher 表示中的所有非零缩放因子 $\\gamma$ 都成立。这意味着对于所有 $\\gamma  0$，都有 $\\Delta t \\le \\frac{1}{\\gamma} \\Delta t_{\\mathrm{FE}}$。SSP 系数 $C$ 是使得方法在 $\\Delta t \\le C \\Delta t_{\\mathrm{FE}}$ 时保持单调的最大值。因此，\n$$\nC = \\min_{\\gamma  0} \\frac{1}{\\gamma} = \\frac{1}{\\max(\\gamma)}\n$$\n从上面推导的 Shu-Osher 形式可知，所有前向欧拉缩放因子的集合为 $\\{1, 0, 1, 0, 1\\}$。非零缩放因子都等于 $1$。\n最大缩放因子为 $\\max(\\gamma) = 1$。\n因此，SSP 系数为：\n$$\nC = \\frac{1}{1} = 1\n$$\n\n### 任务 3：确定约束性步\n正如在验证阶段所确立的，我们将“所有前向欧拉子步”解释为那些具有非零缩放因子 $\\gamma  0$ 的子步。问题要求找出缩放因子 $\\gamma$ 等于这组子步中最小值的步。\n正缩放因子集合为 $\\{1, 1, 1\\}$。\n此集合中的最小值为 $1$。\n我们现在找出出现 $\\gamma=1$ 子步的阶段：\n- **第 1 步**：$u^{(1)}$ 的创建涉及子步 $u^{(0)} + 1 \\cdot \\Delta t \\, L(u^{(0)})$。缩放因子为 $1$。这是一个约束性步。\n- **第 2 步**：$u^{(2)}$ 的创建涉及子步 $u^{(1)} + 1 \\cdot \\Delta t \\, L(u^{(1)})$。缩放因子为 $1$。这是一个约束性步。\n- **第 3 步**：$u^{(3)}$ 的创建涉及子步 $u^{(2)} + 1 \\cdot \\Delta t \\, L(u^{(2)})$。缩放因子为 $1$。这是一个约束性步。\n\n因此，在对问题陈述进行必要的解释后，所有三个步（1、2 和 3）都是约束性步。约束性步的索引是 $1, 2, 3$。\n\n最终答案是一个包含 $C$ 和约束性步索引的行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  1  2  3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "前面的练习侧重于分析时间积分器的SSP系数$C$，该系数给出了SSP方法稳定时间步长与前向欧拉稳定时间步长$\\Delta t_{\\mathrm{FE}}$之间的关系。然而，在实践中我们如何确定$\\Delta t_{\\mathrm{FE}}$本身呢？本练习通过一个源自非连续Galerkin（DG）空间离散化的具体线性系统，展示了如何估算$\\Delta t_{\\mathrm{FE}}$。你将使用矩阵范数和矩阵测度等工具，为给定的质量矩阵$M$和刚度矩阵$K$推导出一个严格的$\\ell_{1}$范数下的单调性时间步长上界，从而将抽象的时间积分理论与实际的半离散系统联系起来。",
            "id": "3421337",
            "problem": "考虑一个线性半离散系统，该系统由标量平流方程在参考单元 $[-1,1]$上使用模态Legendre多项式基进行间断Galerkin (DG) 离散化得到。设该半离散系统写为 $M \\, \\frac{d u}{d t} = K \\, u$ 的形式，其中 $M \\in \\mathbb{R}^{3 \\times 3}$ 是对称正定质量矩阵，$K \\in \\mathbb{R}^{3 \\times 3}$ 是由所选数值通量定义的刚度矩阵。假设矩阵为\n$$\nM = \\begin{pmatrix}\n2   0   0 \\\\\n0   \\frac{2}{3}   0 \\\\\n0   0   \\frac{2}{5}\n\\end{pmatrix}, \n\\quad\nK = \\begin{pmatrix}\n-6   6   0 \\\\\n2   -\\frac{16}{3}   \\frac{10}{3} \\\\\n0   2   -2\n\\end{pmatrix}.\n$$\n定义系统矩阵 $A = M^{-1} K$。在强稳定性保持 (SSP) 时间积分的背景下，前向欧拉 (FE) 步长 $\\Delta t_{\\mathrm{FE}}$ 是使得前向欧拉更新 $u^{n+1} = u^{n} + \\Delta t_{\\mathrm{FE}} \\, A \\, u^{n}$ 对于某个凸泛函（此处取为 $\\mathbb{R}^{3}$ 上的 $\\ell_{1}$ 范数）是单调的最大步长。\n\n从线性系统显式时间步进的单调性第一性原理出发，并使用以下两种工具之一：\n- $\\ell_{1}$ 矩阵测度 $\\mu_{1}(A)$，定义为 $\\mu_{1}(A) = \\max_{j} \\left( a_{jj} + \\sum_{i \\neq j} |a_{ij}| \\right)$，或\n- 使用Gershgorin圆盘定理来界定 $A$ 的特征值，以及标量测试方程的前向欧拉绝对稳定域，\n\n推导此系统 $\\Delta t_{\\mathrm{FE}}$ 的一个严格上界，并进行数值计算。最终答案必须是一个实数。不需要物理单位。如果需要四舍五入，则保留四位有效数字；否则提供精确值。",
            "solution": "首先将验证问题的科学合理性、一致性和完整性。\n\n### 步骤 1：提取已知条件\n- 线性半离散系统由 $M \\, \\frac{d u}{d t} = K \\, u$ 给出，其中 $u \\in \\mathbb{R}^{3}$。\n- 质量矩阵 $M$ 为 $M = \\begin{pmatrix} 2   0   0 \\\\ 0   \\frac{2}{3}   0 \\\\ 0   0   \\frac{2}{5} \\end{pmatrix}$。\n- 刚度矩阵 $K$ 为 $K = \\begin{pmatrix} -6   6   0 \\\\ 2   -\\frac{16}{3}   \\frac{10}{3} \\\\ 0   2   -2 \\end{pmatrix}$。\n- 系统矩阵定义为 $A = M^{-1} K$。\n- 时间积分方法是前向欧拉 (FE) 方法：$u^{n+1} = u^{n} + \\Delta t \\, A \\, u^{n}$。\n- 任务是找到最大步长 $\\Delta t_{\\mathrm{FE}}$，使得前向欧拉更新对于 $\\mathbb{R}^{3}$ 上的 $\\ell_{1}$ 范数是单调的。这等价于找到最大的 $\\Delta t$，使得更新在 $\\ell_{1}$ 范数下是收缩的，即 $\\|u^{n+1}\\|_{\\ell_{1}} \\le \\|u^{n}\\|_{\\ell_{1}}$。\n- 推导过程建议使用两种工具：\n    1. $\\ell_{1}$ 矩阵测度 $\\mu_{1}(A) = \\max_{j} \\left( a_{jj} + \\sum_{i \\neq j} |a_{ij}| \\right)$。\n    2. Gershgorin圆盘定理和前向欧拉绝对稳定域。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题设置在偏微分方程数值分析的背景下，特别是间断Galerkin方法和强稳定性保持 (SSP) 时间积分器。矩阵 $M$ 和 $K$、$\\ell_{1}$-范数单调性的概念、矩阵测度以及Gershgorin圆盘定理都是数学和科学计算中的标准且成熟的概念。质量矩阵的元素 $M_{ii} = \\frac{2}{2(i-1)+1}$ 对应于缩放后的Legendre多项式的内积，这与问题描述一致。\n- **适定性：** 该问题提供了计算系统矩阵 $A$ 和推导时间步长限制所需的所有必要数据（$M$ 和 $K$）和定义。目标陈述清晰，并期望得到唯一的数值答案。\n- **客观性：** 问题以精确的数学语言陈述，没有任何主观性或歧义。\n- **完整性与一致性：** 问题是自洽的。质量矩阵 $M$ 是对角的且正定的，因此是可逆的，这确保了系统矩阵 $A$ 的定义是明确的。所提供的信息中没有矛盾之处。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答推导\n目标是找到最大步长 $\\Delta t = \\Delta t_{\\mathrm{FE}}  0$，使得前向欧拉更新在 $\\ell_{1}$ 范数下是收缩的。该更新由 $u^{n+1} = u^{n} + \\Delta t \\, A \\, u^{n} = (I + \\Delta t A) u^{n}$ 给出，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n\n$\\ell_{1}$-收缩性的条件是放大矩阵 $(I + \\Delta t A)$ 的诱导 $\\ell_{1}$-范数小于或等于 $1$：\n$$\n\\|I + \\Delta t A\\|_{\\ell_{1}} \\le 1\n$$\n矩阵 $B \\in \\mathbb{R}^{m \\times m}$ 的诱导 $\\ell_{1}$-范数定义为最大绝对列和：\n$$\n\\|B\\|_{\\ell_{1}} = \\max_{1 \\le j \\le m} \\sum_{i=1}^{m} |b_{ij}|\n$$\n将此应用于矩阵 $B = I + \\Delta t A$，其元素为 $b_{ij} = \\delta_{ij} + \\Delta t a_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数。该条件变为：\n$$\n\\max_{j} \\left( |1 + \\Delta t a_{jj}| + \\sum_{i \\neq j} |\\Delta t a_{ij}| \\right) \\le 1\n$$\n这个不等式必须对每一列 $j$ 都成立。因此，对于所有 $j \\in \\{1, 2, 3\\}$：\n$$\n|1 + \\Delta t a_{jj}| + \\Delta t \\sum_{i \\neq j} |a_{ij}| \\le 1\n$$\n\n首先，我们必须计算系统矩阵 $A = M^{-1} K$。\n质量矩阵为 $M = \\begin{pmatrix} 2  0  0 \\\\ 0  \\frac{2}{3}  0 \\\\ 0  0  \\frac{2}{5} \\end{pmatrix}$。其逆矩阵为 $M^{-1} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{3}{2}  0 \\\\ 0  0  \\frac{5}{2} \\end{pmatrix}$。\n现在，我们计算 $A$：\n$$\nA = M^{-1} K = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{3}{2}  0 \\\\ 0  0  \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} -6  6  0 \\\\ 2  -\\frac{16}{3}  \\frac{10}{3} \\\\ 0  2  -2 \\end{pmatrix}\n$$\n$$\nA = \\begin{pmatrix}\n(\\frac{1}{2})(-6)  (\\frac{1}{2})(6)  (\\frac{1}{2})(0) \\\\\n(\\frac{3}{2})(2)  (\\frac{3}{2})(-\\frac{16}{3})  (\\frac{3}{2})(\\frac{10}{3}) \\\\\n(\\frac{5}{2})(0)  (\\frac{5}{2})(2)  (\\frac{5}{2})(-2)\n\\end{pmatrix}\n= \\begin{pmatrix}\n-3  3  0 \\\\\n3  -8  5 \\\\\n0  5  -5\n\\end{pmatrix}\n$$\n现在我们对 $A$ 的每一列应用 $\\ell_{1}$-收缩性条件。\n\n对于列 $j = 1$：$a_{11} = -3$，$\\sum_{i \\neq 1} |a_{i1}| = |3| + |0| = 3$。\n条件是 $|1 - 3 \\Delta t| + 3 \\Delta t \\le 1$。\n如果 $\\Delta t  1/3$，则 $1 - 3 \\Delta t  0$，所以 $|1 - 3 \\Delta t| = 3 \\Delta t - 1$。不等式变为 $(3 \\Delta t - 1) + 3 \\Delta t = 6 \\Delta t - 1 \\le 1$，这意味着 $6 \\Delta t \\le 2$，即 $\\Delta t \\le 1/3$。这与假设 $\\Delta t  1/3$ 矛盾。\n因此，必须有 $\\Delta t \\le 1/3$。在这种情况下，$1 - 3 \\Delta t \\ge 0$，不等式变为 $(1 - 3 \\Delta t) + 3 \\Delta t = 1 \\le 1$，这总是成立的。\n因此，第一列的约束是 $\\Delta t \\le 1/3$。\n\n对于列 $j = 2$：$a_{22} = -8$，$\\sum_{i \\neq 2} |a_{i2}| = |3| + |5| = 8$。\n条件是 $|1 - 8 \\Delta t| + 8 \\Delta t \\le 1$。\n类似地，如果我们假设 $\\Delta t  1/8$，不等式变为 $(8 \\Delta t - 1) + 8 \\Delta t = 16 \\Delta t - 1 \\le 1$，这意味着 $16 \\Delta t \\le 2$，即 $\\Delta t \\le 1/8$。这是一个矛盾。\n所以我们必须有 $\\Delta t \\le 1/8$。对于这样的 $\\Delta t$，不等式变为 $(1 - 8 \\Delta t) + 8 \\Delta t = 1 \\le 1$，这总是成立的。\n第二列的约束是 $\\Delta t \\le 1/8$。\n\n对于列 $j = 3$：$a_{33} = -5$，$\\sum_{i \\neq 3} |a_{i3}| = |0| + |5| = 5$。\n条件是 $|1 - 5 \\Delta t| + 5 \\Delta t \\le 1$。\n类似地，假设 $\\Delta t  1/5$ 会导致矛盾 ($10 \\Delta t \\le 2 \\implies \\Delta t \\le 1/5$)。\n所以我们必须有 $\\Delta t \\le 1/5$。对于这样的 $\\Delta t$，不等式变为 $(1 - 5 \\Delta t) + 5 \\Delta t = 1 \\le 1$，这总是成立的。\n第三列的约束是 $\\Delta t \\le 1/5$。\n\n为了同时满足所有列的条件，时间步长 $\\Delta t$ 必须小于或等于各个上界的最小值：\n$$\n\\Delta t \\le \\min \\left( \\frac{1}{3}, \\frac{1}{8}, \\frac{1}{5} \\right)\n$$\n这些值中的最小值是 $1/8$。\n$$\n\\Delta t \\le \\frac{1}{8}\n$$\n因此，使前向欧拉方法在 $\\ell_1$-范数下单调的最大可能步长 $\\Delta t_{\\mathrm{FE}}$ 是 $1/8$。其数值为 $0.125$。由于是精确分数，无需四舍五入。",
            "answer": "$$\n\\boxed{\\frac{1}{8}}\n$$"
        }
    ]
}