{
    "hands_on_practices": [
        {
            "introduction": "High-order Discontinuous Galerkin (DG) methods achieve exceptional accuracy for smooth flows but can produce unphysical oscillations near discontinuities like shocks. A common remedy is to employ a subcell finite volume limiter, but activating it indiscriminately would destroy the method's high-order accuracy. This practice challenges you to think critically about the design of a \"troubled-cell indicator\" that can intelligently distinguish between true compressive shocks, which require limiting, and other complex but smooth flow features like vortices, which should be resolved with high-order accuracy .",
            "id": "3421984",
            "problem": "Consider the two-dimensional compressible Euler equations in conservative form for state vector $\\mathbf{U} = (\\rho, \\rho u, \\rho v, \\rho E)^{\\top}$,\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\ndiscretized with a high-order Discontinuous Galerkin (DG) method of polynomial degree $p$ on an unstructured mesh. To ensure robustness in the presence of shocks and contact discontinuities, a subcell finite-volume limiter is available that, when activated in a flagged element, projects the DG polynomial onto $N_{\\text{sub}}$ finite-volume subcells per element, performs a monotone update with Total Variation Diminishing (TVD) fluxes, and reconstructs a conservative polynomial. A troubled-cell indicator decides whether to preemptively activate the limiter, while an a posteriori Multi-dimensional Optimal Order Detection (MOOD) acceptance stage evaluates the high-order or limited update against admissibility criteria.\n\nThree classes of smoothness/compression indicators are available:\n- A modal decay detector à la Persson–Peraire: in each element, define the normalized high-order modal energy fraction $I_{\\text{pp}} \\in [0,1]$ as the ratio of the energy carried by the highest modal block to the total polynomial energy. For sufficiently smooth $\\mathbf{U}$, spectral decay implies small $I_{\\text{pp}}$, whereas loss of smoothness yields larger $I_{\\text{pp}}$.\n- A compression-sensitive shock sensor based on dilatation: define the nondimensional dilatation $d^{*} = -\\frac{h}{a}\\,\\nabla \\cdot \\mathbf{u}$, where $h$ is a characteristic element size, $a$ is the local sound speed, $\\mathbf{u}=(u,v)$, and set $I_{\\text{div}} = \\max(0, d^{*})$. Strong compression gives large $I_{\\text{div}}$, while pure shear and vortical motions have $I_{\\text{div}} \\approx 0$.\n- A vortical activity indicator: define the nondimensional vorticity magnitude $\\omega^{*} = \\frac{h\\,\\lVert \\nabla \\times \\mathbf{u} \\rVert}{\\lVert \\mathbf{u} \\rVert + \\delta}$, with a small $\\delta>0$ to avoid division by zero, and set $I_{\\omega} = \\omega^{*}$. Under-resolved vortices have large $I_{\\omega}$, shocks may have moderate $I_{\\omega}$ due to shear layers but typically exhibit much larger $I_{\\text{div}}$ than $I_{\\omega}$.\n\nThe Multi-dimensional Optimal Order Detection (MOOD) acceptance stage enforces physical admissibility: positivity of density $\\rho$ and pressure $p$, preservation of a relaxed invariant domain for internal energy $e$, and a discrete local maximum principle for selected variables over each element and its immediate neighbors.\n\nYou are asked to compare the behavior of candidate preemptive sensors in a scenario with three representative elements:\n- Element $E_{1}$ (under-resolved isentropic vortex core advected at moderate Mach): $I_{\\text{pp}} = 0.20$, $I_{\\text{div}} = 0.01$, $I_{\\omega} = 1.00$.\n- Element $E_{2}$ (stationary normal shock of Mach $M_{s}$ intersecting the element): $I_{\\text{pp}} = 0.50$, $I_{\\text{div}} = 2.00$, $I_{\\omega} = 0.20$.\n- Element $E_{3}$ (contact/shear layer without net compression): $I_{\\text{pp}} = 0.30$, $I_{\\text{div}} = 0.05$, $I_{\\omega} = 0.40$.\n\nAssume thresholds $0<\\tau_{\\text{pp}},\\tau_{\\text{div}},\\tau<1$ are chosen to trigger preemptive limiting only when an indicator is sufficiently large, and that MOOD acceptance tests are always performed after the update unless explicitly stated otherwise. The goal is to minimize false positives (unnecessary limiting) in under-resolved vortical regions like $E_{1}$ while reliably capturing shocks in $E_{2}$ and avoiding excessive limiting in $E_{3}$.\n\nWhich of the following hybrid sensor designs best achieves the stated goal, based on first principles of spectral decay, compressibility, and vortical discrimination, and in concert with MOOD acceptance?\n\nA. Define the compression–vorticity gate\n$$\nr = \\frac{I_{\\text{div}}}{I_{\\text{div}} + I_{\\omega} + \\varepsilon}, \\quad \\varepsilon = 10^{-3},\n$$\nand the hybrid preemptive sensor\n$$\nS_{A} = I_{\\text{pp}} \\, r.\n$$\nPreemptively limit an element if $S_{A} > \\tau_{\\text{pp}}$; otherwise, accept the high-order update unless MOOD rejects it, in which case fall back to subcell finite-volume. All indicators are nondimensionalized by $h$ and local $a$ to ensure grid- and Mach-number robustness.\n\nB. Define the additive preemptive sensor\n$$\nS_{B} = I_{\\text{pp}} + I_{\\text{div}},\n$$\nand limit an element if $S_{B} > \\tau$. Apply MOOD acceptance only to already-limited elements; if MOOD fails, re-limit with a more diffusive flux.\n\nC. Define the vorticity-amplified smoothness sensor\n$$\nS_{C} = I_{\\text{pp}} \\left(1 + I_{\\omega}\\right),\n$$\nand limit an element if $S_{C} > \\tau$. Rely on MOOD acceptance after the update to catch any residual oscillations.\n\nD. Use a pure dilatation shock sensor\n$$\nS_{D} = I_{\\text{div}},\n$$\nand limit an element if $S_{D} > \\tau_{\\text{div}}$. Disable MOOD acceptance to reduce overhead; trust that compression is the primary hallmark of shocks and discontinuities.\n\nSelect the single best option and justify the choice by analyzing $E_{1}$, $E_{2}$, and $E_{3}$ using the fundamental distinctions between compressive and vortical motions and the spectral decay behavior of smooth versus nonsmooth fields.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the established theory of high-order numerical methods for computational fluid dynamics, specifically concerning shock-capturing techniques for the compressible Euler equations. The problem is well-posed, objective, and provides sufficient, consistent data and definitions to allow for a rigorous evaluation of the proposed options.\n\nThe objective is to identify the best hybrid sensor design that reliably triggers numerical limiting for shocks (element $E_{2}$), avoids unnecessary limiting for under-resolved smooth vortices (element $E_{1}$), and behaves cautiously with contact/shear layers (element $E_{3}$), all within a robust framework that includes an a posteriori Multi-dimensional Optimal Order Detection (MOOD) check for physical admissibility.\n\nWe are given the following data for three representative elements:\n- Element $E_{1}$ (isentropic vortex): $I_{\\text{pp}} = 0.20$, $I_{\\text{div}} = 0.01$, $I_{\\omega} = 1.00$.\n- Element $E_{2}$ (normal shock): $I_{\\text{pp}} = 0.50$, $I_{\\text{div}} = 2.00$, $I_{\\omega} = 0.20$.\n- Element $E_{3}$ (contact/shear layer): $I_{\\text{pp}} = 0.30$, $I_{\\text{div}} = 0.05$, $I_{\\omega} = 0.40$.\n\nLet's analyze each option by calculating the sensor value for each element.\n\n### Analysis of Option A\n\nThe sensor is defined as $S_{A} = I_{\\text{pp}} \\, r$, where the compression–vorticity gate is $r = \\frac{I_{\\text{div}}}{I_{\\text{div}} + I_{\\omega} + \\varepsilon}$ with $\\varepsilon = 10^{-3}$. This sensor design modulates the spectral decay indicator $I_{\\text{pp}}$ with a factor $r$ that is close to $1$ when compression ($I_{\\text{div}}$) dominates vorticity ($I_{\\omega}$) and close to $0$ otherwise.\n\n- **For Element $E_{1}$ (vortex):**\nHere, vorticity dominates compression: $I_{\\text{div}} = 0.01 \\ll I_{\\omega} = 1.00$.\n$$\nr = \\frac{0.01}{0.01 + 1.00 + 0.001} = \\frac{0.01}{1.011} \\approx 0.00989\n$$\n$$\nS_{A} = I_{\\text{pp}} \\cdot r = 0.20 \\times 0.00989 \\approx 0.00198\n$$\nThe sensor value is extremely small. This correctly identifies the element as non-problematic from a shock-capturing perspective, thus avoiding a false positive and preserving the high-order accuracy for the smooth vortex. This behavior meets the stated goal.\n\n- **For Element $E_{2}$ (shock):**\nHere, compression dominates vorticity: $I_{\\text{div}} = 2.00 \\gg I_{\\omega} = 0.20$.\n$$\nr = \\frac{2.00}{2.00 + 0.20 + 0.001} = \\frac{2.00}{2.201} \\approx 0.9087\n$$\n$$\nS_{A} = I_{\\text{pp}} \\cdot r = 0.50 \\times 0.9087 \\approx 0.454\n$$\nThe sensor value is large, close to the original spectral indicator $I_{\\text{pp}}=0.50$. This will reliably trigger preemptive limiting for any reasonable threshold $\\tau_{\\text{pp}} \\in (0,1)$ (e.g., $\\tau_{\\text{pp}} \\sim 0.1-0.2$), correctly capturing the shock. This behavior meets the stated goal.\n\n- **For Element $E_{3}$ (contact/shear layer):**\nHere, vorticity is significant and compression is negligible: $I_{\\text{div}} = 0.05, I_{\\omega} = 0.40$.\n$$\nr = \\frac{0.05}{0.05 + 0.40 + 0.001} = \\frac{0.05}{0.451} \\approx 0.1109\n$$\n$$\nS_{A} = I_{\\text{pp}} \\cdot r = 0.30 \\times 0.1109 \\approx 0.0332\n$$\nThe value is small, much lower than the original $I_{\\text{pp}}=0.30$. The sensor is unlikely to trigger preemptive limiting. This is a desirable outcome. Contact discontinuities do not inherently violate physical admissibility in the same way shocks do. By not preemptively limiting, the decision is passed to the a posteriori MOOD stage. If the high-order update for the contact proves to be physically admissible (e.g., maintains positive $\\rho$ and $p$), the limiter is correctly avoided. If it produces oscillations leading to admissibility violations, MOOD will reject the update and fall back to the limiter. This \"trust but verify\" approach for ambiguous cases is a hallmark of a robust and efficient scheme.\n\nThe overall strategy, coupling this intelligent preemptive sensor with a final MOOD check, is sound and represents a modern, effective approach to shock capturing.\n\n**Verdict: Correct.**\n\n### Analysis of Option B\n\nThe sensor is $S_{B} = I_{\\text{pp}} + I_{\\text{div}}$. The strategy applies MOOD only to already-limited elements.\n\n- **For Element $E_{1}$ (vortex):** $S_{B} = 0.20 + 0.01 = 0.21$. This value is significant and could easily exceed a chosen threshold $\\tau \\in (0,1)$, leading to unnecessary limiting (a false positive).\n- **For Element $E_{2}$ (shock):** $S_{B} = 0.50 + 2.00 = 2.50$. This value is very large and will correctly trigger limiting.\n- **For Element $E_{3}$ (shear layer):** $S_{B} = 0.30 + 0.05 = 0.35$. This value is also significant and likely to trigger limiting.\n\nCritique: The sensor $S_{B}$ does not effectively discriminate between shocks and vortices, failing a primary objective. More critically, the proposed strategy of applying MOOD *only* to limited elements is fundamentally flawed. The essential role of a posteriori schemes like MOOD is to verify the physical admissibility of the high-order, unlimited solution. By skipping this check, the method risks accepting a high-order update that is unphysical (e.g., with negative density), which can lead to catastrophic simulation failure.\n\n**Verdict: Incorrect.**\n\n### Analysis of Option C\n\nThe sensor is $S_{C} = I_{\\text{pp}} \\left(1 + I_{\\omega}\\right)$.\n\n- **For Element $E_{1}$ (vortex):** $S_{C} = 0.20 \\times (1 + 1.00) = 0.40$. This sensor *amplifies* the response in the vortical region, producing a high value. This is the exact opposite of the desired behavior and would lead to high rates of false positives.\n- **For Element $E_{2}$ (shock):** $S_{C} = 0.50 \\times (1 + 0.20) = 0.60$. This high value correctly identifies the shock.\n- **For Element $E_{3}$ (shear layer):** $S_{C} = 0.30 \\times (1 + 0.40) = 0.42$. This high value would likely trigger unnecessary limiting.\n\nCritique: This sensor is designed to be sensitive to vorticity, which directly contradicts the goal of *avoiding* limiting in vortical regions. It is a \"vorticity detector,\" not a selective shock detector.\n\n**Verdict: Incorrect.**\n\n### Analysis of Option D\n\nThe sensor is $S_{D} = I_{\\text{div}}$. The strategy is to disable MOOD entirely.\n\n- **For Element $E_{1}$ (vortex):** $S_{D} = 0.01$. The value is very low, correctly avoiding limiting.\n- **For Element $E_{2}$ (shock):** $S_{D} = 2.00$. The value is very high, correctly triggering limiting.\n- **For Element $E_{3}$ (shear layer):** $S_{D} = 0.05$. The value is very low. This sensor would fail to flag the shear layer. While shear layers are non-compressive, they are sharp discontinuities where high-order methods can create spurious oscillations (Gibbs phenomenon). The non-smoothness is captured by $I_{\\text{pp}} = 0.30$, which this sensor ignores.\n\nCritique: While $S_D$ is effective at distinguishing shocks from vortices, it is blind to non-compressive discontinuities like contacts, which also require stabilization. The most serious flaw is disabling the MOOD acceptance stage. MOOD is the ultimate safety net that guarantees physical admissibility. Removing it for a minor performance gain sacrifices the robustness of the entire numerical scheme, making it prone to failure when encountering phenomena like the shear layer in $E_3$.\n\n**Verdict: Incorrect.**\n\n### Final Conclusion\n\nOption A presents the most sophisticated and appropriate solution. Its hybrid sensor $S_A$ is designed explicitly to address the central challenge: distinguishing compressive discontinuities (shocks) from non-compressive but under-resolved smooth features (vortices). It correctly leverages the spectral indicator $I_{\\text{pp}}$ for general discontinuity detection and uses the compression-vorticity gate $r$ to filter out false positives from vortices. The reliance on the a posteriori MOOD check for ambiguous cases like shear layers and as a general safety net constitutes a robust and well-balanced strategy.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a cell is flagged as \"troubled,\" the DG scheme often switches locally to a more robust finite volume (FV) method operating on a grid of subcells. For this FV update to be conservative, it must be formulated using the true physical volumes (or areas in 2D) of these subcells, which can be complex on curved or distorted meshes. This exercise provides a concrete, hands-on application of multivariate calculus to compute subcell areas within a curved element via an isoparametric mapping, a fundamental skill for implementing conservative schemes on realistic geometries .",
            "id": "3421998",
            "problem": "Consider a two-dimensional isoparametric mapping from the reference quadrilateral with local coordinates $(\\xi,\\eta)\\in[0,1]\\times[0,1]$ to a physical curved quadrilateral $\\Omega_{K}$ defined by bilinear shape functions. Let the physical corner coordinates at the reference nodes $(\\xi,\\eta)=(0,0)$, $(1,0)$, $(0,1)$, $(1,1)$ be $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(3,0)$, $(x_{3},y_{3})=(0,2)$, and $(x_{4},y_{4})=(4,3)$, respectively. The isoparametric mapping is\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4} x_{i} N_{i}(\\xi,\\eta),\\qquad y(\\xi,\\eta)=\\sum_{i=1}^{4} y_{i} N_{i}(\\xi,\\eta),\n$$\nwhere $N_{1}(\\xi,\\eta)=(1-\\xi)(1-\\eta)$, $N_{2}(\\xi,\\eta)=\\xi(1-\\eta)$, $N_{3}(\\xi,\\eta)=(1-\\xi)\\eta$, and $N_{4}(\\xi,\\eta)=\\xi\\eta$. In a high-order Discontinuous Galerkin (DG) method with subcell Finite Volume (FV) limiting for shocks, conservative updates on a subcell partition require using the physical subcell volumes (areas), given by the change-of-variables theorem\n$$\nV_{S}=\\iint_{S} J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\\qquad J(\\xi,\\eta)=\\det\\left(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right).\n$$\nConstruct a uniform $2\\times 2$ subcell partition of the reference element $[0,1]\\times[0,1]$, with subcells $S_{11}=[0,\\tfrac{1}{2}]\\times[0,\\tfrac{1}{2}]$, $S_{12}=[\\tfrac{1}{2},1]\\times[0,\\tfrac{1}{2}]$, $S_{21}=[0,\\tfrac{1}{2}]\\times[\\tfrac{1}{2},1]$, and $S_{22}=[\\tfrac{1}{2},1]\\times[\\tfrac{1}{2},1]$. Starting from the fundamental change-of-variables formula for area, and the definition of the isoparametric bilinear mapping, derive the Jacobian determinant $J(\\xi,\\eta)$ and the expression for the physical subcell volume $V_{S}$ for an arbitrary axis-aligned rectangular subcell $S=[\\xi_{a},\\xi_{b}]\\times[\\eta_{a},\\eta_{b}]$ in the reference space. Then, evaluate the volume $V_{S_{11}}$ exactly for the subcell $S_{11}=[0,\\tfrac{1}{2}]\\times[0,\\tfrac{1}{2}]$. Your final answer must be a single exact number (no rounding).",
            "solution": "The problem requires the derivation of the Jacobian determinant for a specific bilinear isoparametric mapping, followed by the derivation of a general formula for the physical area (volume) of a rectangular subcell in the reference domain, and finally the exact calculation of this area for a specific subcell $S_{11}$.\n\nFirst, we establish the explicit form of the isoparametric mapping from the reference coordinates $(\\xi, \\eta)$ to the physical coordinates $(x, y)$. The mapping is given by:\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4} x_{i} N_{i}(\\xi,\\eta)\n$$\n$$\ny(\\xi,\\eta)=\\sum_{i=1}^{4} y_{i} N_{i}(\\xi,\\eta)\n$$\nThe corner coordinates are $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(3,0)$, $(x_{3},y_{3})=(0,2)$, and $(x_{4},y_{4})=(4,3)$. The bilinear shape functions are $N_{1}(\\xi,\\eta)=(1-\\xi)(1-\\eta)$, $N_{2}(\\xi,\\eta)=\\xi(1-\\eta)$, $N_{3}(\\xi,\\eta)=(1-\\xi)\\eta$, and $N_{4}(\\xi,\\eta)=\\xi\\eta$.\n\nSubstituting the given coordinate values into the mapping equations:\n$$\nx(\\xi,\\eta) = (0)N_{1}(\\xi,\\eta) + (3)N_{2}(\\xi,\\eta) + (0)N_{3}(\\xi,\\eta) + (4)N_{4}(\\xi,\\eta) = 3\\xi(1-\\eta) + 4\\xi\\eta = 3\\xi - 3\\xi\\eta + 4\\xi\\eta = 3\\xi + \\xi\\eta\n$$\n$$\ny(\\xi,\\eta) = (0)N_{1}(\\xi,\\eta) + (0)N_{2}(\\xi,\\eta) + (2)N_{3}(\\xi,\\eta) + (3)N_{4}(\\xi,\\eta) = 2(1-\\xi)\\eta + 3\\xi\\eta = 2\\eta - 2\\xi\\eta + 3\\xi\\eta = 2\\eta + \\xi\\eta\n$$\n\nNext, we compute the Jacobian matrix of the transformation, $\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$. This requires the partial derivatives of $x$ and $y$ with respect to $\\xi$ and $\\eta$.\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(3\\xi + \\xi\\eta) = 3 + \\eta\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(3\\xi + \\xi\\eta) = \\xi\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(2\\eta + \\xi\\eta) = \\eta\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(2\\eta + \\xi\\eta) = 2 + \\xi\n$$\nThe Jacobian matrix is:\n$$\n\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 3+\\eta & \\xi \\\\ \\eta & 2+\\xi \\end{pmatrix}\n$$\nThe Jacobian determinant, $J(\\xi,\\eta)$, is the determinant of this matrix:\n$$\nJ(\\xi,\\eta) = \\det\\left(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right) = (3+\\eta)(2+\\xi) - (\\xi)(\\eta) = 6 + 3\\xi + 2\\eta + \\xi\\eta - \\xi\\eta = 6 + 3\\xi + 2\\eta\n$$\n\nNow we derive the expression for the physical volume (area) $V_{S}$ of an arbitrary axis-aligned rectangular subcell $S=[\\xi_{a},\\xi_{b}]\\times[\\eta_{a},\\eta_{b}]$ in the reference space. The volume is given by the integral of the Jacobian determinant over the subcell $S$.\n$$\nV_{S} = \\iint_{S} J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\int_{\\eta_{a}}^{\\eta_{b}} \\int_{\\xi_{a}}^{\\xi_{b}} (6 + 3\\xi + 2\\eta) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nWe perform the integration, starting with the inner integral with respect to $\\xi$:\n$$\n\\int_{\\xi_{a}}^{\\xi_{b}} (6 + 3\\xi + 2\\eta) \\, \\mathrm{d}\\xi = \\left[ 6\\xi + \\frac{3}{2}\\xi^2 + 2\\eta\\xi \\right]_{\\xi_{a}}^{\\xi_{b}} = (6\\xi_{b} + \\frac{3}{2}\\xi_{b}^2 + 2\\eta\\xi_{b}) - (6\\xi_{a} + \\frac{3}{2}\\xi_{a}^2 + 2\\eta\\xi_{a})\n$$\n$$\n= 6(\\xi_{b} - \\xi_{a}) + \\frac{3}{2}(\\xi_{b}^2 - \\xi_{a}^2) + 2\\eta(\\xi_{b} - \\xi_{a})\n$$\nNext, we integrate this result with respect to $\\eta$ from $\\eta_{a}$ to $\\eta_{b}$:\n$$\nV_{S} = \\int_{\\eta_{a}}^{\\eta_{b}} \\left( 6(\\xi_{b} - \\xi_{a}) + \\frac{3}{2}(\\xi_{b}^2 - \\xi_{a}^2) + 2\\eta(\\xi_{b} - \\xi_{a}) \\right) \\mathrm{d}\\eta\n$$\n$$\nV_{S} = \\left[ \\left( 6(\\xi_{b} - \\xi_{a}) + \\frac{3}{2}(\\xi_{b}^2 - \\xi_{a}^2) \\right)\\eta + \\eta^2(\\xi_{b} - \\xi_{a}) \\right]_{\\eta_{a}}^{\\eta_{b}}\n$$\n$$\nV_{S} = \\left( 6(\\xi_{b} - \\xi_{a}) + \\frac{3}{2}(\\xi_{b}^2 - \\xi_{a}^2) \\right)(\\eta_{b}-\\eta_{a}) + (\\eta_{b}^2 - \\eta_{a}^2)(\\xi_{b} - \\xi_{a})\n$$\nThis is the general expression for the subcell volume.\n\nFinally, we evaluate this expression for the specific subcell $S_{11}=[0,\\tfrac{1}{2}]\\times[0,\\tfrac{1}{2}]$. For this subcell, the integration limits are $\\xi_{a}=0$, $\\xi_{b}=\\frac{1}{2}$, $\\eta_{a}=0$, and $\\eta_{b}=\\frac{1}{2}$. We can substitute these values into the derived general formula or perform the definite integral directly. Let's perform the definite integral:\n$$\nV_{S_{11}} = \\int_{0}^{1/2} \\int_{0}^{1/2} (6 + 3\\xi + 2\\eta) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nThe inner integral is:\n$$\n\\int_{0}^{1/2} (6 + 3\\xi + 2\\eta) \\, \\mathrm{d}\\xi = \\left[ 6\\xi + \\frac{3}{2}\\xi^2 + 2\\eta\\xi \\right]_{0}^{1/2} = \\left(6\\left(\\frac{1}{2}\\right) + \\frac{3}{2}\\left(\\frac{1}{2}\\right)^2 + 2\\eta\\left(\\frac{1}{2}\\right)\\right) - (0) = 3 + \\frac{3}{8} + \\eta\n$$\nThe outer integral is:\n$$\nV_{S_{11}} = \\int_{0}^{1/2} \\left(3 + \\frac{3}{8} + \\eta\\right) \\mathrm{d}\\eta = \\left[ 3\\eta + \\frac{3}{8}\\eta + \\frac{1}{2}\\eta^2 \\right]_{0}^{1/2}\n$$\n$$\nV_{S_{11}} = \\left(3\\left(\\frac{1}{2}\\right) + \\frac{3}{8}\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{2}\\right)^2\\right) - (0) = \\frac{3}{2} + \\frac{3}{16} + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{3}{2} + \\frac{3}{16} + \\frac{1}{8}\n$$\nTo sum these fractions, we find a common denominator, which is $16$:\n$$\nV_{S_{11}} = \\frac{3 \\times 8}{16} + \\frac{3}{16} + \\frac{1 \\times 2}{16} = \\frac{24}{16} + \\frac{3}{16} + \\frac{2}{16} = \\frac{24+3+2}{16} = \\frac{29}{16}\n$$\nThe exact volume for the subcell $S_{11}$ is $\\frac{29}{16}$.",
            "answer": "$$\n\\boxed{\\frac{29}{16}}\n$$"
        },
        {
            "introduction": "After evolving the solution on the subcells using a robust finite volume method, it is often desirable to reconstruct a smooth, high-order DG polynomial that represents the new cell state. This reconstruction is not arbitrary; it must be consistent with the updated subcell data and, crucially, must not violate the underlying conservation law. This problem guides you through the mathematical machinery of a constrained least-squares reconstruction, demonstrating how to find a polynomial that optimally fits the subcell averages while strictly enforcing conservation of the cell-averaged quantity .",
            "id": "3422067",
            "problem": "Consider a scalar conservation law discretized by a discontinuous Galerkin (DG) method on a single reference cell with coordinate $\\xi \\in [-1,1]$. A subcell finite volume (FV) limiter provides piecewise-constant subcell averages $\\{m_{j}\\}_{j=1}^{3}$ on the three equal-sized subcells $I_{1}=[-1,-\\tfrac{1}{3}]$, $I_{2}=[-\\tfrac{1}{3},\\tfrac{1}{3}]$, and $I_{3}=[\\tfrac{1}{3},1]$. You are to reconstruct a degree-$2$ DG polynomial $u_{h}(\\xi)$ in the quadratic Legendre basis on $[-1,1]$, namely $P_{0}(\\xi)=1$, $P_{1}(\\xi)=\\xi$, and $P_{2}(\\xi)=\\tfrac{1}{2}(3\\xi^{2}-1)$, by solving a constrained least-squares problem that enforces conservation of the cell average.\n\nFormally, define the piecewise-constant data function $m(\\xi)$ by $m(\\xi)=m_{j}$ for $\\xi \\in I_{j}$, and seek\n$$\nu_{h}(\\xi)=c_{0}P_{0}(\\xi)+c_{1}P_{1}(\\xi)+c_{2}P_{2}(\\xi)\n$$\nthat minimizes the squared $L^{2}$ discrepancy\n$$\nJ(c_{0},c_{1},c_{2})=\\sum_{j=1}^{3}\\int_{I_{j}}\\left(u_{h}(\\xi)-m(\\xi)\\right)^{2}\\,d\\xi\n$$\nsubject to the conservation constraint that the DG cell average equals the FV-computed cell average,\n$$\n\\frac{1}{2}\\int_{-1}^{1}u_{h}(\\xi)\\,d\\xi=\\bar{m},\\quad \\bar{m}=\\frac{1}{2}\\sum_{j=1}^{3}\\int_{I_{j}}m(\\xi)\\,d\\xi=\\frac{m_{1}+m_{2}+m_{3}}{3}.\n$$\nDerive the unique minimizer and provide the final reconstructed polynomial $u_{h}(\\xi)$ explicitly as a function of $\\xi$, $m_{1}$, $m_{2}$, and $m_{3}$. Your final answer must be a single closed-form analytic expression for $u_{h}(\\xi)$ with no rounding and no units.",
            "solution": "The problem requires finding a quadratic polynomial $u_{h}(\\xi)$ that minimizes a squared $L^{2}$ discrepancy with respect to a piecewise-constant function $m(\\xi)$, subject to an integral constraint on its cell average. This is a constrained optimization problem, which can be solved using the method of Lagrange multipliers or by directly incorporating the constraint to reduce the number of free variables. We shall pursue the latter, more direct approach.\n\nThe polynomial to be reconstructed is of degree $2$ and is expressed in the basis of Legendre polynomials on the interval $[-1,1]$:\n$$\nu_{h}(\\xi) = c_{0}P_{0}(\\xi) + c_{1}P_{1}(\\xi) + c_{2}P_{2}(\\xi)\n$$\nwhere $P_{0}(\\xi)=1$, $P_{1}(\\xi)=\\xi$, and $P_{2}(\\xi)=\\frac{1}{2}(3\\xi^{2}-1)$.\n\nThe constraint enforces the conservation of the cell average:\n$$\n\\frac{1}{2}\\int_{-1}^{1}u_{h}(\\xi)\\,d\\xi = \\bar{m}\n$$\nwhere $\\bar{m}$ is the average of the subcell data $\\{m_{1}, m_{2}, m_{3}\\}$ over the cell $[-1,1]$. As given, $\\bar{m} = \\frac{m_{1}+m_{2}+m_{3}}{3}$. Let us first analyze the constraint. Substituting the expression for $u_{h}(\\xi)$ into the constraint integral:\n$$\n\\frac{1}{2}\\int_{-1}^{1} \\left(c_{0}P_{0}(\\xi) + c_{1}P_{1}(\\xi) + c_{2}P_{2}(\\xi)\\right) \\,d\\xi = \\bar{m}\n$$\nThe Legendre polynomials are orthogonal on $[-1,1]$, with $\\int_{-1}^{1}P_{n}(\\xi)P_{k}(\\xi)\\,d\\xi = \\frac{2}{2n+1}\\delta_{nk}$. We can write the integral as an inner product with $P_{0}(\\xi)=1$.\n$$\n\\frac{1}{2}\\int_{-1}^{1} u_{h}(\\xi)P_{0}(\\xi)\\,d\\xi = \\frac{1}{2} \\left( c_{0}\\int_{-1}^{1}P_{0}^{2}(\\xi)\\,d\\xi + c_{1}\\int_{-1}^{1}P_{1}(\\xi)P_{0}(\\xi)\\,d\\xi + c_{2}\\int_{-1}^{1}P_{2}(\\xi)P_{0}(\\xi)\\,d\\xi \\right) = \\bar{m}\n$$\nDue to orthogonality, the integrals involving $P_1 P_0$ and $P_2 P_0$ are zero. The first integral gives $\\int_{-1}^{1}P_{0}^{2}(\\xi)\\,d\\xi = \\int_{-1}^{1}1^{2}\\,d\\xi = 2$.\nThe constraint simplifies to:\n$$\n\\frac{1}{2} (c_{0} \\cdot 2) = c_{0} = \\bar{m} = \\frac{m_{1}+m_{2}+m_{3}}{3}\n$$\nThus, the conservation constraint directly fixes the first coefficient, $c_{0}$.\n\nThe problem now reduces to finding the coefficients $c_{1}$ and $c_{2}$ that minimize the objective function $J$, with $c_{0}$ held fixed at $\\bar{m}$.\n$$\nJ(c_{1},c_{2}) = \\int_{-1}^{1} \\left(u_{h}(\\xi)-m(\\xi)\\right)^{2}\\,d\\xi\n$$\nFor $J$ to be at a minimum, its partial derivatives with respect to the free variables $c_{1}$ and $c_{2}$ must be zero.\n$$\n\\frac{\\partial J}{\\partial c_{1}} = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)\\frac{\\partial u_{h}}{\\partial c_{1}}\\,d\\xi = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)P_{1}(\\xi)\\,d\\xi = 0\n$$\n$$\n\\frac{\\partial J}{\\partial c_{2}} = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)\\frac{\\partial u_{h}}{\\partial c_{2}}\\,d\\xi = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)P_{2}(\\xi)\\,d\\xi = 0\n$$\nThese conditions yield a system of two linear equations for $c_1$ and $c_2$:\n1. $\\int_{-1}^{1} u_{h}(\\xi)P_{1}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)P_{1}(\\xi)\\,d\\xi$\n2. $\\int_{-1}^{1} u_{h}(\\xi)P_{2}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)P_{2}(\\xi)\\,d\\xi$\n\nLet us evaluate the left-hand side (LHS) of these equations using the orthogonality of Legendre polynomials:\nLHS of (1): $\\int_{-1}^{1} (c_{0}P_{0}+c_{1}P_{1}+c_{2}P_{2})P_{1}\\,d\\xi = c_{1}\\int_{-1}^{1}P_{1}^{2}(\\xi)\\,d\\xi = c_{1}\\frac{2}{2(1)+1} = \\frac{2}{3}c_{1}$.\nLHS of (2): $\\int_{-1}^{1} (c_{0}P_{0}+c_{1}P_{1}+c_{2}P_{2})P_{2}\\,d\\xi = c_{2}\\int_{-1}^{1}P_{2}^{2}(\\xi)\\,d\\xi = c_{2}\\frac{2}{2(2)+1} = \\frac{2}{5}c_{2}$.\n\nNext, we evaluate the right-hand side (RHS) of the equations. The function $m(\\xi)$ is piecewise constant on the subcells $I_{1}=[-1,-\\frac{1}{3}]$, $I_{2}=[-\\frac{1}{3},\\frac{1}{3}]$, and $I_{3}=[\\frac{1}{3},1]$.\nRHS of (1): $\\int_{-1}^{1} m(\\xi)P_{1}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)\\xi\\,d\\xi$\n$$\n= \\int_{-1}^{-1/3} m_{1}\\xi\\,d\\xi + \\int_{-1/3}^{1/3} m_{2}\\xi\\,d\\xi + \\int_{1/3}^{1} m_{3}\\xi\\,d\\xi\n$$\n$$\n= m_{1}\\left[\\frac{\\xi^{2}}{2}\\right]_{-1}^{-1/3} + m_{2}\\left[\\frac{\\xi^{2}}{2}\\right]_{-1/3}^{1/3} + m_{3}\\left[\\frac{\\xi^{2}}{2}\\right]_{1/3}^{1}\n$$\n$$\n= m_{1}\\left(\\frac{1}{18}-\\frac{1}{2}\\right) + m_{2}\\left(\\frac{1}{18}-\\frac{1}{18}\\right) + m_{3}\\left(\\frac{1}{2}-\\frac{1}{18}\\right) = m_{1}\\left(-\\frac{8}{18}\\right) + m_{3}\\left(\\frac{8}{18}\\right) = \\frac{4}{9}(m_{3}-m_{1})\n$$\nEquating LHS and RHS of (1): $\\frac{2}{3}c_{1} = \\frac{4}{9}(m_{3}-m_{1})$, which gives $c_{1} = \\frac{3}{2}\\frac{4}{9}(m_{3}-m_{1}) = \\frac{2}{3}(m_{3}-m_{1})$.\n\nRHS of (2): $\\int_{-1}^{1} m(\\xi)P_{2}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)\\frac{1}{2}(3\\xi^{2}-1)\\,d\\xi$\n$$\n= \\frac{1}{2}\\left( m_{1}\\int_{-1}^{-1/3}(3\\xi^{2}-1)d\\xi + m_{2}\\int_{-1/3}^{1/3}(3\\xi^{2}-1)d\\xi + m_{3}\\int_{1/3}^{1}(3\\xi^{2}-1)d\\xi \\right)\n$$\nThe antiderivative is $\\int(3\\xi^{2}-1)d\\xi = \\xi^{3}-\\xi$. Let $F(\\xi) = \\xi^{3}-\\xi$.\n$$\n\\int_{-1}^{-1/3}(3\\xi^{2}-1)d\\xi = F(-\\tfrac{1}{3}) - F(-1) = (-\\tfrac{1}{27}+\\tfrac{1}{3}) - (-1+1) = \\tfrac{8}{27}\n$$\n$$\n\\int_{-1/3}^{1/3}(3\\xi^{2}-1)d\\xi = F(\\tfrac{1}{3}) - F(-\\tfrac{1}{3}) = (\\tfrac{1}{27}-\\tfrac{1}{3}) - (-\\tfrac{1}{27}+\\tfrac{1}{3}) = 2(\\tfrac{1}{27}-\\tfrac{1}{3}) = -\\tfrac{16}{27}\n$$\n$$\n\\int_{1/3}^{1}(3\\xi^{2}-1)d\\xi = F(1) - F(\\tfrac{1}{3}) = (1-1) - (\\tfrac{1}{27}-\\tfrac{1}{3}) = \\tfrac{8}{27}\n$$\nThe RHS of (2) is therefore:\n$$\n\\frac{1}{2}\\left(m_{1}\\frac{8}{27} + m_{2}\\frac{-16}{27} + m_{3}\\frac{8}{27}\\right) = \\frac{4}{27}(m_{1}-2m_{2}+m_{3})\n$$\nEquating LHS and RHS of (2): $\\frac{2}{5}c_{2} = \\frac{4}{27}(m_{1}-2m_{2}+m_{3})$, which gives $c_{2} = \\frac{5}{2}\\frac{4}{27}(m_{1}-2m_{2}+m_{3}) = \\frac{10}{27}(m_{1}-2m_{2}+m_{3})$.\n\nWe have now determined all coefficients:\n$c_{0} = \\frac{m_{1}+m_{2}+m_{3}}{3}$\n$c_{1} = \\frac{2}{3}(m_{3}-m_{1})$\n$c_{2} = \\frac{10}{27}(m_{1}-2m_{2}+m_{3})$\n\nThe final reconstructed polynomial is $u_{h}(\\xi)=c_{0}P_{0}(\\xi)+c_{1}P_{1}(\\xi)+c_{2}P_{2}(\\xi)$.\nSubstituting the Legendre polynomials and the coefficients:\n$$\nu_{h}(\\xi) = \\left(\\frac{m_{1}+m_{2}+m_{3}}{3}\\right) + \\left(\\frac{2}{3}(m_{3}-m_{1})\\right)\\xi + \\left(\\frac{10}{27}(m_{1}-2m_{2}+m_{3})\\right)\\left(\\frac{3\\xi^{2}-1}{2}\\right)\n$$\nTo obtain the expression as a standard polynomial in $\\xi$, we collect terms with like powers of $\\xi$.\nThe coefficient of $\\xi^2$ is: $\\frac{10}{27}(m_{1}-2m_{2}+m_{3}) \\cdot \\frac{3}{2} = \\frac{5}{9}(m_{1}-2m_{2}+m_{3})$.\nThe coefficient of $\\xi$ is: $\\frac{2}{3}(m_{3}-m_{1})$.\nThe constant term is:\n$$\nc_{0} - \\frac{1}{2}c_{2} = \\frac{m_{1}+m_{2}+m_{3}}{3} - \\frac{1}{2}\\frac{10}{27}(m_{1}-2m_{2}+m_{3})\n$$\n$$\n= \\frac{9(m_{1}+m_{2}+m_{3})}{27} - \\frac{5(m_{1}-2m_{2}+m_{3})}{27}\n$$\n$$\n= \\frac{9m_{1}+9m_{2}+9m_{3} - 5m_{1}+10m_{2}-5m_{3}}{27} = \\frac{4m_{1}+19m_{2}+4m_{3}}{27}\n$$\nCombining these terms, we arrive at the final expression for the reconstructed polynomial:\n$$\nu_{h}(\\xi) = \\left(\\frac{5}{9}(m_{1}-2m_{2}+m_{3})\\right)\\xi^{2} + \\left(\\frac{2}{3}(m_{3}-m_{1})\\right)\\xi + \\frac{4m_{1}+19m_{2}+4m_{3}}{27}\n$$",
            "answer": "$$\n\\boxed{\\left(\\frac{5}{9}(m_{1}-2m_{2}+m_{3})\\right)\\xi^{2} + \\left(\\frac{2}{3}(m_{3}-m_{1})\\right)\\xi + \\frac{4m_{1}+19m_{2}+4m_{3}}{27}}\n$$"
        }
    ]
}