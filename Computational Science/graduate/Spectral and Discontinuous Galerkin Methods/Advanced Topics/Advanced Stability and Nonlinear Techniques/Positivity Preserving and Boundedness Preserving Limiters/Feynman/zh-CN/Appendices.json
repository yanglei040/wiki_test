{
    "hands_on_practices": [
        {
            "introduction": "高阶数值格式（如不连续伽辽金方法）在模拟物理量（如密度或浓度）时，可能会产生非物理的负值。为了解决这个问题，正定性保持限制器是一种关键技术。本练习  将带您实践一种基本的线性缩放限制器的核心思想：通过计算一个缩放因子 $\\theta$，将数值解围绕单元平均值进行重塑，从而在不改变单元总质量的前提下消除负值。这个练习将帮助您掌握限制器机制中最核心的计算步骤。",
            "id": "3409716",
            "problem": "考虑一个用于双曲守恒律的不连续伽辽金 (DG)方法中的单个三角形单元，其中单元上的近似表示一个非负标量场（例如，密度）。该单元是参考三角形，其顶点位于$(0,0)$、$(1,0)$和$(0,1)$。多项式次数为$p=2$。单元上的近似为\n$$\nu_h(x,y) \\;=\\; 1 \\;-\\; \\frac{5}{2}\\,x^2.\n$$\n一个线性缩放保正限制器以围绕单元平均值进行重新缩放的标准形式应用，使得对于一个选定的参数 $\\theta \\in [0,1]$，受限场为\n$$\nu^{\\theta}(x,y) \\;=\\; \\bar{u} \\;+\\; \\theta\\,\\big(u_h(x,y) - \\bar{u}\\big).\n$$\n这里 $\\bar{u}$ 是 $u_h$ 在该单元上的精确单元平均值。该限制器需要在由2次 Dunavant 求积节点给出的体积检验点上强制非负性，即点 $(2/3,1/6,1/6)$ 的三个重心坐标置换，对于此参考三角形，其笛卡尔坐标为\n$$\n(x_1,y_1)=\\Big(\\frac{1}{6},\\frac{1}{6}\\Big),\\quad (x_2,y_2)=\\Big(\\frac{2}{3},\\frac{1}{6}\\Big),\\quad (x_3,y_3)=\\Big(\\frac{1}{6},\\frac{2}{3}\\Big).\n$$\n从线性缩放限制器的第一性原理出发，确定最大的 $\\theta \\in [0,1]$，使得在上面列出的所有三个 Dunavant 节点 $(x_q,y_q)$ 上都有 $u^{\\theta}(x_q,y_q)\\ge 0$。根据其单元平均值的定义精确计算 $\\bar{u}$，并精确执行所有求值。将最终的 $\\theta$ 表示为一个精确的有理数。无需四舍五入，不涉及单位。",
            "solution": "问题要求找到线性缩放保正限制器的最大参数 $\\theta \\in [0,1]$，使得受限近似 $u^{\\theta}(x,y)$ 在一组指定的检验点上保持非负。\n\n给定的单元是参考三角形 $K$，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。它的面积是 $|K| = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2}(1)(1) = \\frac{1}{2}$。\n\n未受限的近似由以下二次多项式给出：\n$$\nu_h(x,y) = 1 - \\frac{5}{2}x^2\n$$\n\n受限近似定义为：\n$$\nu^{\\theta}(x,y) = \\bar{u} + \\theta \\left( u_h(x,y) - \\bar{u} \\right)\n$$\n其中 $\\bar{u}$ 是 $u_h$ 在单元 $K$ 上的单元平均值。\n\n需要强制执行的约束是在三个指定的 Dunavant 求积节点 $(x_q, y_q)$ 上 $u^{\\theta}(x_q,y_q) \\ge 0$。这可以转化为：\n$$\n\\bar{u} + \\theta \\left( u_h(x_q, y_q) - \\bar{u} \\right) \\ge 0\n$$\n对于每个检验点 $q \\in \\{1,2,3\\}$。这个不等式可以被重新整理以找到对 $\\theta$ 的约束。该约束的性质取决于项 $u_h(x_q, y_q) - \\bar{u}$ 的符号。\n\n我们来分析这个不等式：\n1.  如果 $u_h(x_q, y_q) - \\bar{u}  0$，不等式为 $\\theta \\ge \\frac{-\\bar{u}}{u_h(x_q, y_q) - \\bar{u}}$。如果我们发现 $\\bar{u}  0$，这将为 $\\theta$ 提供一个非正的下界。由于 $\\theta \\in [0,1]$，这个条件是平凡满足的，并且不对 $\\theta$ 施加任何上界。\n2.  如果 $u_h(x_q, y_q) - \\bar{u}  0$，我们必须除以一个负数，这会反转不等号的方向：\n    $$\n    \\theta \\le \\frac{-\\bar{u}}{u_h(x_q, y_q) - \\bar{u}} = \\frac{\\bar{u}}{\\bar{u} - u_h(x_q, y_q)}\n    $$\n    这对 $\\theta$ 施加了一个上界。\n\n为了在所有检验点上都满足非负性，$\\theta$ 必须小于或等于所有相关点上所有这些上界的最小值。因此，允许的 $\\theta$ 的最大值是：\n$$\n\\theta_{\\text{max}} = \\min\\left(1, \\min_{q \\text{ s.t. } u_h(x_q,y_q)  \\bar{u}} \\left\\{ \\frac{\\bar{u}}{\\bar{u} - u_h(x_q,y_q)} \\right\\} \\right)\n$$\n\n求解过程分为三个步骤：\n1.  计算精确的单元平均值 $\\bar{u}$。\n2.  在三个检验点上计算 $u_h(x,y)$ 的值。\n3.  使用这些值来确定对 $\\theta$ 的约束，并找到其最大可能值。\n\n**第一步：计算单元平均值 $\\bar{u}$**\n单元平均值定义为 $\\bar{u} = \\frac{1}{|K|} \\int_K u_h(x,y) \\,dA$。\n$$\n\\bar{u} = \\frac{1}{1/2} \\int_0^1 \\int_0^{1-x} \\left(1 - \\frac{5}{2}x^2\\right) \\,dy\\,dx\n$$\n$$\n\\bar{u} = 2 \\int_0^1 \\left[ \\left(1 - \\frac{5}{2}x^2\\right)y \\right]_{y=0}^{y=1-x} \\,dx = 2 \\int_0^1 \\left(1 - \\frac{5}{2}x^2\\right)(1-x) \\,dx\n$$\n展开被积函数：\n$$\n\\bar{u} = 2 \\int_0^1 \\left(1 - x - \\frac{5}{2}x^2 + \\frac{5}{2}x^3\\right) \\,dx\n$$\n逐项积分：\n$$\n\\bar{u} = 2 \\left[ x - \\frac{x^2}{2} - \\frac{5}{2}\\frac{x^3}{3} + \\frac{5}{2}\\frac{x^4}{4} \\right]_0^1 = 2 \\left( 1 - \\frac{1}{2} - \\frac{5}{6} + \\frac{5}{8} \\right)\n$$\n$$\n\\bar{u} = 2 \\left( \\frac{1}{2} - \\frac{5}{6} + \\frac{5}{8} \\right) = 2 \\left( \\frac{12}{24} - \\frac{20}{24} + \\frac{15}{24} \\right) = 2 \\left( \\frac{12 - 20 + 15}{24} \\right) = 2 \\left( \\frac{7}{24} \\right)\n$$\n$$\n\\bar{u} = \\frac{14}{24} = \\frac{7}{12}\n$$\n由于 $\\bar{u} = 7/12  0$，我们对不等式的分析是正确的。\n\n**第二步：在检验点上计算 $u_h(x,y)$ 的值**\n检验点为 $(x_1,y_1)=(1/6,1/6)$、$(x_2,y_2)=(2/3,1/6)$ 和 $(x_3,y_3)=(1/6,2/3)$。\n函数为 $u_h(x,y) = 1 - \\frac{5}{2}x^2$。注意 $u_h$ 与 $y$ 无关。\n\n对于 $(x_1,y_1) = (1/6, 1/6)$：\n$$\nu_{h,1} = u_h\\left(\\frac{1}{6}, \\frac{1}{6}\\right) = 1 - \\frac{5}{2}\\left(\\frac{1}{6}\\right)^2 = 1 - \\frac{5}{2}\\left(\\frac{1}{36}\\right) = 1 - \\frac{5}{72} = \\frac{67}{72}\n$$\n\n对于 $(x_2,y_2) = (2/3, 1/6)$：\n$$\nu_{h,2} = u_h\\left(\\frac{2}{3}, \\frac{1}{6}\\right) = 1 - \\frac{5}{2}\\left(\\frac{2}{3}\\right)^2 = 1 - \\frac{5}{2}\\left(\\frac{4}{9}\\right) = 1 - \\frac{10}{9} = -\\frac{1}{9}\n$$\n\n对于 $(x_3,y_3) = (1/6, 2/3)$：\n$$\nu_{h,3} = u_h\\left(\\frac{1}{6}, \\frac{2}{3}\\right) = 1 - \\frac{5}{2}\\left(\\frac{1}{6}\\right)^2 = 1 - \\frac{5}{72} = \\frac{67}{72}\n$$\n\n**第三步：确定对 $\\theta$ 的约束**\n我们必须找到满足 $u_h(x_q, y_q)  \\bar{u}$ 的点。\n我们有 $\\bar{u} = \\frac{7}{12} = \\frac{42}{72}$。\n检验点处的值为 $u_{h,1} = \\frac{67}{72}$、$u_{h,2} = -\\frac{1}{9} = -\\frac{8}{72}$ 和 $u_{h,3} = \\frac{67}{72}$。\n\n- 对于点1和3：$u_h = \\frac{67}{72}  \\frac{42}{72} = \\bar{u}$。如前所述，这些点不对 $\\theta$ 施加上界。\n\n- 对于点2：$u_{h,2} = -\\frac{8}{72}  \\frac{42}{72} = \\bar{u}$。这个点对 $\\theta$ 施加了一个上界：\n$$\n\\theta \\le \\frac{\\bar{u}}{\\bar{u} - u_{h,2}}\n$$\n代入数值：\n$$\n\\theta \\le \\frac{\\frac{7}{12}}{\\frac{7}{12} - \\left(-\\frac{1}{9}\\right)} = \\frac{\\frac{7}{12}}{\\frac{7}{12} + \\frac{1}{9}}\n$$\n为了计算分母，我们找到12和9的公倍数，即36：\n$$\n\\frac{7}{12} + \\frac{1}{9} = \\frac{7 \\times 3}{36} + \\frac{1 \\times 4}{36} = \\frac{21+4}{36} = \\frac{25}{36}\n$$\n将此结果代回关于 $\\theta$ 的不等式中：\n$$\n\\theta \\le \\frac{\\frac{7}{12}}{\\frac{25}{36}} = \\frac{7}{12} \\times \\frac{36}{25} = \\frac{7 \\times 3}{25} = \\frac{21}{25}\n$$\n\n来自非负性约束的唯一上界是 $\\theta \\le \\frac{21}{25}$。我们还有定义域的约束 $\\theta \\in [0,1]$。\n最终的条件是 $\\theta \\le \\min\\left(1, \\frac{21}{25}\\right)$。由于 $\\frac{21}{25}  1$，所以最小值为 $\\frac{21}{25}$。\n因此，$\\theta$ 的最大允许值为 $\\frac{21}{25}$。",
            "answer": "$$ \\boxed{\\frac{21}{25}} $$"
        },
        {
            "introduction": "在实际应用中，仅在少数几个点上保证正定性可能不足以完全抑制非物理振荡。一个更稳健的方法是要求解在每个子单元上的平均值都保持正定。本练习  旨在演示如何将缩放限制器的思想应用于这一更严格的约束，并引入一个正定性下限 $\\epsilon  0$。通过完成这个练习，您将学会如何为更切合实际的数值模拟需求设计和校准限制器。",
            "id": "3409657",
            "problem": "考虑在多项式阶数 $p=3$ 的不连续伽辽金 (DG) 离散化中，一维参考单元为 $K=[-1,1]$。设标量场由多项式\n$$\nu(x)=\\alpha_{0}+\\alpha_{1}x+\\alpha_{2}x^{2}+\\alpha_{3}x^{3},\n$$\n表示，其系数为 $\\alpha_{0}=\\frac{1}{5}$，$\\alpha_{1}=\\frac{1}{2}$，$\\alpha_{2}=-\\frac{2}{5}$ 和 $\\alpha_{3}=-\\frac{1}{10}$。假设正定性下限指定为 $\\epsilon=0.05$，并且通过一个保守的 Zhang–Shu 型缩放限制器在四个等长的子单元 $K_{1}=[-1,-\\tfrac{1}{2}]$，$K_{2}=[-\\tfrac{1}{2},0]$，$K_{3}=[0,\\tfrac{1}{2}]$ 和 $K_{4}=[\\tfrac{1}{2},1]$ 上强制施加正定性：\n$$\nu^{+}(x)=\\theta\\big(u(x)-\\bar{u}\\big)+\\bar{u},\n$$\n其中 $\\bar{u}$ 是 $K$ 上的单元平均值，缩放因子 $\\theta\\in[0,1]$ 被最小化选择，以使 $u^{+}$ 的每个子单元平均值至少为 $\\epsilon$。\n\n任务：\n- 从单元平均值和子单元平均值作为 $u(x)$ 精确积分的定义出发，计算 $u(x)$ 在 $j=1,2,3,4$ 时的子单元平均值 $U_{j}$，以及在 $K$ 上的单元平均值 $\\bar{u}$。\n- 推导为使所有 $j$ 满足 $U_{j}^{+}\\ge\\epsilon$ 所需的 $\\theta$ 的容许范围，其中 $U_{j}^{+}=\\theta\\big(U_{j}-\\bar{u}\\big)+\\bar{u}$，并确定满足该条件的最小 $\\theta$。\n- 使用 $p=3$ 时的 Legendre–Gauss–Lobatto (LGL) 节点，即 $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$ 和 $x_{3}=1$，验证修正后的节点值 $u^{+}(x_{i})$ 受凸性界\n$$\nu^{+}(x_{i})\\in\\big[\\min\\{u(x_{i}),\\bar{u}\\},\\,\\max\\{u(x_{i}),\\bar{u}\\}\\big],\\quad i=0,1,2,3.\n$$\n所界定。\n\n报告能最小化地强制子单元正定性的缩放因子 $\\theta$。将最终答案四舍五入至四位有效数字。",
            "solution": "问题陈述被认为是有效的，因为它具有科学依据、是适定的且客观的。它提出了守恒律数值方法领域的一个标准问题，特别是关于间断伽辽金方法的保正限制器。所有给定的数据和定义都是一致的，并且足以获得唯一解。\n\n求解过程包括三个主要部分：\n1.  计算给定多项式的单元和子单元平均值。\n2.  确定在所有子单元平均值上强制施加正定性约束的最小缩放因子 $\\theta$。\n3.  在指定节点上验证限制后解的凸性性质。\n\n标量场由多项式 $u(x)=\\alpha_{0}+\\alpha_{1}x+\\alpha_{2}x^{2}+\\alpha_{3}x^{3}$ 在参考单元 $K=[-1,1]$ 上给出。系数为 $\\alpha_{0}=\\frac{1}{5}$，$\\alpha_{1}=\\frac{1}{2}$，$\\alpha_{2}=-\\frac{2}{5}$ 和 $\\alpha_{3}=-\\frac{1}{10}$。正定性下限为 $\\epsilon=0.05$。\n\n**第 1 部分：单元和子单元平均值的计算**\n\n单元 $K=[-1,1]$ 上的单元平均值 $\\bar{u}$ 定义为：\n$$\n\\bar{u} = \\frac{1}{|K|} \\int_{-1}^{1} u(x) \\,dx = \\frac{1}{2} \\int_{-1}^{1} \\left(\\frac{1}{5} + \\frac{1}{2}x - \\frac{2}{5}x^2 - \\frac{1}{10}x^3\\right) \\,dx\n$$\n由于积分区间的对称性，奇次幂项（$x$ 和 $x^3$）的积分为零。\n$$\n\\bar{u} = \\frac{1}{2} \\int_{-1}^{1} \\left(\\frac{1}{5} - \\frac{2}{5}x^2\\right) \\,dx = \\frac{1}{2} \\left[\\frac{1}{5}x - \\frac{2}{15}x^3\\right]_{-1}^{1} = \\frac{1}{2} \\left( \\left(\\frac{1}{5} - \\frac{2}{15}\\right) - \\left(-\\frac{1}{5} + \\frac{2}{15}\\right) \\right) = \\frac{1}{5} - \\frac{2}{15} = \\frac{3-2}{15} = \\frac{1}{15}\n$$\n\n对于 $j=1,2,3,4$，子单元平均值 $U_j$ 在子单元 $K_1=[-1, -\\frac{1}{2}]$，$K_2=[-\\frac{1}{2}, 0]$，$K_3=[0, \\frac{1}{2}]$ 和 $K_4=[\\frac{1}{2}, 1]$ 上计算。每个子单元的长度为 $|K_j| = \\frac{1}{2}$。平均值为 $U_j = \\frac{1}{|K_j|} \\int_{K_j} u(x) \\,dx = 2 \\int_{K_j} u(x) \\,dx$。\n我们首先求出 $u(x)$ 的不定积分：\n$$\nI(x) = \\int \\left(\\frac{1}{5} + \\frac{1}{2}x - \\frac{2}{5}x^2 - \\frac{1}{10}x^3\\right) \\,dx = \\frac{1}{5}x + \\frac{1}{4}x^2 - \\frac{2}{15}x^3 - \\frac{1}{40}x^4 + C\n$$\n现在我们为每个子单元计算定积分。\n对于 $K_1=[-1, -\\frac{1}{2}]$：\n$I(-1) = -\\frac{1}{5} + \\frac{1}{4} + \\frac{2}{15} - \\frac{1}{40} = \\frac{-24+30+16-3}{120} = \\frac{19}{120}$。\n$I(-\\frac{1}{2}) = -\\frac{1}{10} + \\frac{1}{16} + \\frac{2}{120} - \\frac{1}{640} = \\frac{-192+120+32-3}{1920} = -\\frac{43}{1920}$。\n$U_1 = 2 \\left(I(-\\frac{1}{2}) - I(-1)\\right) = 2 \\left(-\\frac{43}{1920} - \\frac{19}{120}\\right) = 2 \\left(-\\frac{43}{1920} - \\frac{304}{1920}\\right) = 2 \\left(-\\frac{347}{1920}\\right) = -\\frac{347}{960}$。\n\n对于 $K_2=[-\\frac{1}{2}, 0]$：\n$I(0) = 0$。\n$U_2 = 2 \\left(I(0) - I(-\\frac{1}{2})\\right) = 2 \\left(0 - (-\\frac{43}{1920})\\right) = \\frac{43}{960}$。\n\n对于 $K_3=[0, \\frac{1}{2}]$：\n$I(\\frac{1}{2}) = \\frac{1}{10} + \\frac{1}{16} - \\frac{2}{120} - \\frac{1}{640} = \\frac{192+120-32-3}{1920} = \\frac{277}{1920}$。\n$U_3 = 2 \\left(I(\\frac{1}{2}) - I(0)\\right) = 2 \\left(\\frac{277}{1920}\\right) = \\frac{277}{960}$。\n\n对于 $K_4=[\\frac{1}{2}, 1]$：\n$I(1) = \\frac{1}{5} + \\frac{1}{4} - \\frac{2}{15} - \\frac{1}{40} = \\frac{24+30-16-3}{120} = \\frac{35}{120} = \\frac{7}{24}$。\n$U_4 = 2 \\left(I(1) - I(\\frac{1}{2})\\right) = 2 \\left(\\frac{7}{24} - \\frac{277}{1920}\\right) = 2 \\left(\\frac{560}{1920} - \\frac{277}{1920}\\right) = 2 \\left(\\frac{283}{1920}\\right) = \\frac{283}{960}$。\n\n平均值总结：\n$\\bar{u} = \\frac{1}{15} = \\frac{64}{960}$。\n$U_1 = -\\frac{347}{960}$。\n$U_2 = \\frac{43}{960}$。\n$U_3 = \\frac{277}{960}$。\n$U_4 = \\frac{283}{960}$。\n\n合理性检查：子单元平均值的平均值必须等于单元平均值。\n$\\frac{1}{4}(U_1+U_2+U_3+U_4) = \\frac{1}{4} \\frac{-347+43+277+283}{960} = \\frac{1}{4} \\frac{256}{960} = \\frac{64}{960} = \\frac{1}{15} = \\bar{u}$。平均值计算正确。\n\n**第 2 部分：缩放因子 $\\theta$ 的确定**\n\n正定性约束要求限制后的子单元平均值 $U_j^+$ 对所有 $j=1,2,3,4$ 满足 $U_j^+ \\ge \\epsilon$。\n限制器定义为 $u^+(x) = \\theta(u(x)-\\bar{u}) + \\bar{u}$。将其应用于子单元平均值可得 $U_j^+ = \\theta(U_j-\\bar{u}) + \\bar{u}$。\n约束为 $\\theta(U_j - \\bar{u}) + \\bar{u} \\ge \\epsilon$，可以重写为 $\\theta(U_j - \\bar{u}) \\ge \\epsilon - \\bar{u}$。\n\n让我们使用公分母 $960$ 来计算相关量。\n$\\epsilon = 0.05 = \\frac{1}{20} = \\frac{48}{960}$。\n$\\bar{u} = \\frac{64}{960}$。\n项 $\\epsilon - \\bar{u} = \\frac{48-64}{960} = -\\frac{16}{960}$。\n差值 $U_j - \\bar{u}$ 为：\n$U_1 - \\bar{u} = -\\frac{347}{960} - \\frac{64}{960} = -\\frac{411}{960}$。\n$U_2 - \\bar{u} = \\frac{43}{960} - \\frac{64}{960} = -\\frac{21}{960}$。\n$U_3 - \\bar{u} = \\frac{277}{960} - \\frac{64}{960} = \\frac{213}{960}$。\n$U_4 - \\bar{u} = \\frac{283}{960} - \\frac{64}{960} = \\frac{219}{960}$。\n\n我们必须找到满足约束条件的 $\\theta \\in [0,1]$。短语“chosen minimally”可能有歧义。在限制器的背景下，这通常指对解的最小修正，即选择满足约束条件的、在 $[0,1]$ 区间内尽可能大的 $\\theta$。任何更小的 $\\theta$ 都将代表一种更激进（非最小化）的限制。\n\n让我们对每个 $j$ 分析不等式 $\\theta(U_j - \\bar{u}) \\ge \\epsilon - \\bar{u}$：\n- 对于 $j=3, 4$，$U_j - \\bar{u}  0$。不等式为 $\\theta \\ge \\frac{\\epsilon-\\bar{u}}{U_j-\\bar{u}}$。由于 $\\epsilon - \\bar{u}  0$，这为 $\\theta$ 产生了一个负的下界。因为 $\\theta \\in [0,1]$，所以这个约束是非约束性的。\n- 对于 $j=1, 2$，$U_j - \\bar{u}  0$。除以一个负数会反转不等号方向：$\\theta \\le \\frac{\\epsilon-\\bar{u}}{U_j-\\bar{u}}$。\n对于 $j=1$：$\\theta \\le \\frac{-16/960}{-411/960} = \\frac{16}{411}$。\n对于 $j=2$：$\\theta \\le \\frac{-16/960}{-21/960} = \\frac{16}{21}$。\n为了同时满足这两个约束，$\\theta$ 必须小于或等于这些上界的最小值：\n$\\theta \\le \\min\\left(\\frac{16}{411}, \\frac{16}{21}\\right)$。由于 $411  21$，我们有 $\\frac{16}{411}  \\frac{16}{21}$。\n对 $\\theta$ 的约束是 $\\theta \\le \\frac{16}{411}$。\n\n为了最小化地修正解，我们选择尽可能大的 $\\theta$，也就是上界本身。\n$$\n\\theta = \\frac{16}{411}\n$$\n这对应于 $\\bar{u}  \\epsilon$ 情况下的标准 Zhang–Shu 限制器公式：$\\theta = \\min\\left(1, \\frac{\\bar{u}-\\epsilon}{\\bar{u}-m}\\right)$，其中 $m=\\min_j U_j = U_1$。\n$\\theta = \\frac{1/15 - 1/20}{1/15 - (-347/960)} = \\frac{(4-3)/60}{(64+347)/960} = \\frac{1/60}{411/960} = \\frac{1}{60} \\frac{960}{411} = \\frac{16}{411}$。\n\n**第 3 部分：凸性界的验证**\n\n任务是验证对于 Legendre-Gauss-Lobatto (LGL) 节点 $x_i$，修正后的节点值满足 $u^{+}(x_{i})\\in\\big[\\min\\{u(x_{i}),\\bar{u}\\},\\,\\max\\{u(x_{i}),\\bar{u}\\}\\big]$。\n修正后的解由下式给出：\n$$\nu^{+}(x_i) = \\theta u(x_i) + (1-\\theta)\\bar{u}\n$$\n我们求得 $\\theta = \\frac{16}{411}$，它在区间 $[0,1]$ 内。因此，$u^+(x_i)$ 是值 $u(x_i)$ 和 $\\bar{u}$ 的一个凸组合。\n根据凸组合的定义，结果值 $u^+(x_i)$ 必须位于 $u(x_i)$ 和 $\\bar{u}$ 之间的闭区间内。这个区间正是 $[\\min\\{u(x_i), \\bar{u}\\}, \\max\\{u(x_i), \\bar{u}\\}]$。\n这个性质对任何 $\\theta \\in [0,1]$ 都成立，因此对于我们计算出的 $\\theta$ 也得以验证，而无需计算 LGL 节点上 $u(x_i)$ 和 $u^+(x_i)$ 的数值。该验证是限制器数学形式的直接推论。\n\n**最终答案计算**\n缩放因子为 $\\theta = \\frac{16}{411}$。为了提供四舍五入到四位有效数字的数值答案：\n$\\theta = \\frac{16}{411} \\approx 0.03892944...$\n前四位有效数字是 $3$、$8$、$9$、$2$。下一位数字是 $9$，大于或等于 $5$，所以我们将最后一位有效数字向上舍入。\n$\\theta \\approx 0.03893$。",
            "answer": "$$\\boxed{0.03893}$$"
        },
        {
            "introduction": "除了对解进行后处理修正，另一种确保物理解有界性的方法是直接在数值格式的演化步骤中构建。本练习  将引导您通过编码来探索单调数值通量与有界性之间的深刻联系。您将实现一个包含局部Lax-Friedrichs通量的有限体积格式，并亲自验证充足的数值耗散是防止产生新极值（从而保证有界性）的关键，从而深刻理解保证数值解物理真实性的底层机制。",
            "id": "3409629",
            "problem": "考虑一维标量守恒律 $u_t + f(u)_x = 0$，该方程在一个尺寸为 $\\Delta x  0$ 的均匀网格上，使用双网格不连续伽辽金 (DG) 方法进行离散。采用分片常数基函数（多项式阶数 $p=0$），因此网格平均值仅通过网格面上的数值通量进行演化。对于任意一个具有左状态 $u^{-}$ 和右状态 $u^{+}$ 的界面，采用局部 Lax–Friedrichs (LLF) 数值通量作为低阶单调通量：\n$$\nF_{\\mathrm{LLF}}(u^{-},u^{+};\\alpha) = \\frac{1}{2}\\left[f(u^{-}) + f(u^{+})\\right] - \\frac{1}{2}\\,\\alpha\\,(u^{+}-u^{-}),\n$$\n其中，逐面耗散参数 $\\alpha$ 的选择必须能够主导跨界面的局部特征速度。在标量情况下，雅可比矩阵为 $f'(u)$，因此一个充分的逐面选择是\n$$\n\\alpha(u^{-},u^{+}) = \\sup_{s \\in [\\min(u^{-},u^{+}),\\,\\max(u^{-},u^{+})]} \\left| f'(s) \\right|.\n$$\n你需要为以下两种通量实现这种逐面 $\\alpha$ 的计算：\n- 线性平流：$f(u) = a\\,u$，其中 $a \\in \\mathbb{R}$ 为常数。\n- 无粘伯格斯方程：$f(u) = \\frac{1}{2}u^2$。\n\n使用一个双网格区域，其状态初始化为黎曼阶跃：网格 $0$ 的值为常数 $u_L$，网格 $1$ 的值为常数 $u_R$。假设左边界的远场状态恒为 $u_L$，右边界的远场状态恒为 $u_R$。在这种 $p=0$ 的设置下，网格平均值在单个时间步长 $\\Delta t$ 内的向前欧拉更新为\n$$\n\\bar{u}_0^{n+1} = \\bar{u}_0^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{\\mathrm{mid}} - f(u_L)\\right),\\qquad\n\\bar{u}_1^{n+1} = \\bar{u}_1^{n} - \\frac{\\Delta t}{\\Delta x}\\left(f(u_R) - F_{\\mathrm{mid}}\\right),\n$$\n其中 $F_{\\mathrm{mid}} = F_{\\mathrm{LLF}}(u_L,u_R;\\alpha_{\\mathrm{mid}})$ 是两个网格之间内部界面上的 LLF 通量，其逐面 $\\alpha$ 值为 $\\alpha_{\\mathrm{mid}}$。对于这种双网格黎曼构型，根据 Courant–Friedrichs–Lewy (CFL) 数 $0  \\mathrm{CFL} \\le 1$ 选择时间步长\n$$\n\\Delta t = \\begin{cases}\n\\mathrm{CFL}\\,\\dfrac{\\Delta x}{\\alpha_{\\mathrm{mid}}},  \\alpha_{\\mathrm{mid}}  0, \\\\[1.0ex]\n\\Delta x,  \\alpha_{\\mathrm{mid}} = 0,\n\\end{cases}\n$$\n注意，如果 $\\alpha_{\\mathrm{mid}}=0$，则 $u_L=u_R$ 且 $F_{\\mathrm{mid}}=f(u_L)$，因此不会发生更新。\n\n你的任务：\n1. 针对每一种通量族，将在连接 $u^{-}$ 和 $u^{+}$ 的区间上 $\\left|f'(s)\\right|$ 的上确界作为逐面计算 $\\alpha(u^{-},u^{+})$ 的方法加以实现。这必须基于上述定义，从第一性原理出发，而不是通过硬编码特定情况的“快捷”值。\n2. 使用计算出的 $\\alpha_{\\mathrm{mid}}$ 和 LLF 通量，为上述双网格问题实现单步向前欧拉更新。\n3. 通过使用 $\\tilde{\\alpha}_{\\mathrm{mid}} = \\sigma\\,\\alpha_{\\mathrm{mid}}$ 重复相同的更新，研究将 $\\alpha$ 以一个因子 $0  \\sigma  1$ 低估所产生的影响。\n4. 对于每次运行，通过检查 $\\bar{u}_0^{n+1}$ 和 $\\bar{u}_1^{n+1}$ 是否都位于闭区间 $[m_0,M_0]$ 内，来验证网格平均值相对于初始全局界\n$$\nm_0 = \\min(u_L,u_R),\\qquad M_0 = \\max(u_L,u_R),\n$$\n的离散保界性。为每次运行报告一个布尔值。\n\n使用以下黎曼问题测试套件，其中 $\\Delta x = 1$，并指定 $\\mathrm{CFL}$ 和低估因子 $\\sigma$：\n- 测试 1：伯格斯通量，$u_L=1.0$，$u_R=2.0$，$\\mathrm{CFL}=0.9$，$\\sigma=0.5$。\n- 测试 2：伯格斯通量，$u_L=2.0$，$u_R=1.0$，$\\mathrm{CFL}=0.9$，$\\sigma=0.5$。\n- 测试 3：线性平流，其中 $a=1.0$，$u_L=1.0$，$u_R=0.0$，$\\mathrm{CFL}=0.9$，$\\sigma=0.5$。\n- 测试 4：伯格斯通量，$u_L=-1.5$，$u_R=-0.5$，$\\mathrm{CFL}=0.9$，$\\sigma=0.5$。\n- 测试 5：伯格斯通量，$u_L=1.234$，$u_R=1.234$，$\\mathrm{CFL}=0.9$，$\\sigma=0.5$。\n\n对于每个测试，按顺序生成两个布尔值：第一个使用如上定义的正确 $\\alpha_{\\mathrm{mid}}$，第二个使用低估的 $\\tilde{\\alpha}_{\\mathrm{mid}}=\\sigma\\,\\alpha_{\\mathrm{mid}}$。因此，对于这五个测试，你的程序应生成单行输出，其中包含一个聚合了十个布尔值的列表。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[true1,false1,true2,false2,...]”）。不允许有其他输出。\n\n角度、单位和物理维度不适用于此纯数学任务；所有量均为无量纲实数。每个测试的最终答案是布尔值。",
            "solution": "该问题要求实现并分析一个用于一维标量守恒律的一阶数值格式，该守恒律由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0\n$$\n空间离散化被指定为使用分片常数基函数（$p=0$）的双网格间断 Galerkin (DG) 方法，这等价于一阶有限体积法。两个网格分别标记为 $0$ 和 $1$，其初始常数状态分别为 $\\bar{u}_0^n = u_L$ 和 $\\bar{u}_1^n = u_R$。该区域定义在单元宽度为 $\\Delta x$ 的均匀网格上。\n\n半离散有限体积公式根据通量平衡来更新网格 $i$ 中的网格平均值 $\\bar{u}_i$：\n$$\n\\frac{d\\bar{u}_i}{dt} = -\\frac{1}{\\Delta x}\\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\n其中 $F_{i\\pm1/2}$ 是网格界面上的数值通量。对于双网格设置，这变为：\n- 网格 $0$：$\\frac{d\\bar{u}_0}{dt} = -\\frac{1}{\\Delta x}\\left( F_{1/2} - F_{-1/2} \\right)$\n- 网格 $1$：$\\frac{d\\bar{u}_1}{dt} = -\\frac{1}{\\Delta x}\\left( F_{3/2} - F_{1/2} \\right)$\n\n通量 $F_{1/2} = F_{\\mathrm{mid}}$ 在网格 $0$ 和网格 $1$ 之间的内部界面上计算。边界通量由 $F_{-1/2} = f(u_L)$ 和 $F_{3/2} = f(u_R)$ 给出，对应于固定的远场边界条件。时间积分通过单步向前欧拉法执行。这导出了问题描述中提供的全离散更新方程：\n$$\n\\bar{u}_0^{n+1} = \\bar{u}_0^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{\\mathrm{mid}} - f(u_L)\\right)\n$$\n$$\n\\bar{u}_1^{n+1} = \\bar{u}_1^{n} - \\frac{\\Delta t}{\\Delta x}\\left(f(u_R) - F_{\\mathrm{mid}}\\right)\n$$\n其中初始状态为 $\\bar{u}_0^n = u_L$ 和 $\\bar{u}_1^n = u_R$。\n\n内部界面上的数值通量 $F_{\\mathrm{mid}}$ 是局部 Lax-Friedrichs (LLF) 通量，它依赖于左状态 $u^{-} = u_L$ 和右状态 $u^{+} = u_R$：\n$$\nF_{\\mathrm{mid}} = F_{\\mathrm{LLF}}(u_L, u_R; \\alpha_{\\mathrm{mid}}) = \\frac{1}{2}\\left[f(u_L) + f(u_R)\\right] - \\frac{1}{2}\\,\\alpha_{\\mathrm{mid}}\\,(u_R - u_L)\n$$\n参数 $\\alpha_{\\mathrm{mid}}$ 代表数值耗散。为使格式是单调的，从而保证不产生新的极值（即具有保界性），$\\alpha_{\\mathrm{mid}}$ 必须足够大。一个充分条件是 $\\alpha_{\\mathrm{mid}}$ 必须大于或等于在界面上相互作用的状态范围内的最大局部波速。对于标量守恒律，波速（特征速度）是 $f'(u)$。因此，逐面耗散参数定义为：\n$$\n\\alpha_{\\mathrm{mid}} = \\alpha(u_L, u_R) = \\sup_{s \\in [\\min(u_L, u_R),\\,\\max(u_L, u_R)]} \\left| f'(s) \\right|\n$$\n\n我们现在来确定两种指定通量函数下 $\\alpha_{\\mathrm{mid}}$ 的表达式。\n1.  **线性平流**：通量为 $f(u) = a u$，其中 $a \\in \\mathbb{R}$ 为某个常数。其导数为 $f'(u) = a$。绝对值为 $|f'(u)| = |a|$，是一个常数。因此，在任何区间上的上确界就是这个常数值：\n    $$\n    \\alpha(u_L, u_R) = \\sup_{s \\in [\\min(u_L, u_R),\\,\\max(u_L, u_R)]} |a| = |a|\n    $$\n2.  **无粘伯格斯方程**：通量为 $f(u) = \\frac{1}{2}u^2$。其导数为 $f'(u) = u$。我们需要在区间 $I = [\\min(u_L, u_R), \\max(u_L, u_R)]$ 上找到 $|f'(s)| = |s|$ 的上确界。函数 $g(s) = |s|$ 是凸函数。凸函数的一个性质是，其在闭区间上的最大值必定出现在区间的某个端点。因此，我们只需要检查在 $s = \\min(u_L, u_R)$ 和 $s = \\max(u_L, u_R)$ 处 $|s|$ 的值，这恰好是 $u_L$ 和 $u_R$（顺序不定）。\n    $$\n    \\alpha(u_L, u_R) = \\max\\left(\\left|\\min(u_L, u_R)\\right|, \\left|\\max(u_L, u_R)\\right|\\right) = \\max(|u_L|, |u_R|)\n    $$\n该逻辑构成了从第一性原理出发的推导，因为它依赖于函数 $|f'(s)|$ 的基本数学性质，而不是一个预先指定的公式。\n\n时间步长 $\\Delta t$ 由 Courant–Friedrichs–Lewy (CFL) 条件确定。对于 $\\alpha_{\\mathrm{mid}}  0$，时间步长为 $\\Delta t = \\mathrm{CFL}\\,\\frac{\\Delta x}{\\alpha_{\\mathrm{mid}}}$。这一选择确保了系数 $\\frac{\\Delta t}{\\Delta x}\\alpha_{\\mathrm{mid}} = \\mathrm{CFL} \\le 1$。根据单调格式理论，只要 LLF 通量本身是单调的（这一点已通过我们对 $\\alpha_{\\mathrm{mid}}$ 的选择得到保证），这个条件就是向前欧拉时间步进格式具有保界性的必要条件。如果 $\\alpha_{\\mathrm{mid}} = 0$，对于给定的通量函数，这当且仅当 $u_L = u_R$ 时发生，此时更新项为零，解是静态的。\n\n任务的核心是验证保界性。初始界为 $m_0 = \\min(u_L, u_R)$ 和 $M_0 = \\max(u_L, u_R)$。在一个时间步之后，我们检查新的网格平均值 $\\bar{u}_0^{n+1}$ 和 $\\bar{u}_1^{n+1}$ 是否保持在这些界内，即 $m_0 \\le \\bar{u}_0^{n+1} \\le M_0$ 且 $m_0 \\le \\bar{u}_1^{n+1} \\le M_0$。此检查在两种情况下进行：\n1.  使用正确计算的耗散 $\\alpha_{\\mathrm{mid}}$。在 $\\mathrm{CFL} \\le 1$ 的条件下，该格式预计是保界的。\n2.  使用低估的耗散 $\\tilde{\\alpha}_{\\mathrm{mid}} = \\sigma \\alpha_{\\mathrm{mid}}$，其中 $0  \\sigma  1$。在这种情况下，数值通量的单调性判据可能被违反，从而可能导致产生新的极值（过冲或下冲），进而违反初始界 $[m_0, M_0]$。时间步长 $\\Delta t$ 使用正确的 $\\alpha_{\\mathrm{mid}}$ 计算，并在两次计算中保持不变，以分离出通量中耗散项的影响。\n\n对每个测试案例执行以下步骤：\n1.  识别通量函数 $f(u)$ 及其导数 $f'(u)$。\n2.  给定 $u_L$ 和 $u_R$，通过在区间 $[\\min(u_L, u_R), \\max(u_L, u_R)]$ 上找到 $|f'(s)|$ 的上确界来计算正确的耗散 $\\alpha_{\\mathrm{mid}}$。\n3.  使用 $\\alpha_{\\mathrm{mid}}$、$\\Delta x$ 和 $\\mathrm{CFL}$ 计算时间步长 $\\Delta t$。如果 $\\alpha_{\\mathrm{mid}}=0$，则不发生更新，解自然是保界的。\n4.  **运行 1 (正确的 $\\alpha$)**：使用 $\\alpha_{\\mathrm{mid}}$ 计算 $F_{\\mathrm{mid}}$。计算 $\\bar{u}_0^{n+1}$ 和 $\\bar{u}_1^{n+1}$。检查两个值是否都在 $[m_0, M_0]$ 内，并记录布尔结果。\n5.  **运行 2 (低估的 $\\alpha$)**：计算 $\\tilde{\\alpha}_{\\mathrm{mid}} = \\sigma \\alpha_{\\mathrm{mid}}$。使用 $\\tilde{\\alpha}_{\\mathrm{mid}}$ 计算新的通量 $\\tilde{F}_{\\mathrm{mid}}$。使用与之前相同的 $\\Delta t$，计算新的状态 $\\bar{u}_0^{n+1}$ 和 $\\bar{u}_1^{n+1}$。检查两个值是否都在 $[m_0, M_0]$ 内，并记录布尔结果。\n该实现将系统地将此过程应用于所有指定的测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the two-cell DG-P0 problem for various test cases, checking for\n    bound-preservation with correct and underestimated numerical dissipation.\n    \"\"\"\n\n    test_cases = [\n        {'flux_type': 'burgers', 'ul': 1.0, 'ur': 2.0, 'cfl': 0.9, 'sigma': 0.5},\n        {'flux_type': 'burgers', 'ul': 2.0, 'ur': 1.0, 'cfl': 0.9, 'sigma': 0.5},\n        {'flux_type': 'linear', 'a': 1.0, 'ul': 1.0, 'ur': 0.0, 'cfl': 0.9, 'sigma': 0.5},\n        {'flux_type': 'burgers', 'ul': -1.5, 'ur': -0.5, 'cfl': 0.9, 'sigma': 0.5},\n        {'flux_type': 'burgers', 'ul': 1.234, 'ur': 1.234, 'cfl': 0.9, 'sigma': 0.5},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Run simulation for one test case and append results\n        res1, res2 = run_test_case(case)\n        results.extend([res1, res2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\n\ndef get_flux_functions(flux_type, a=None):\n    \"\"\"Factory for flux function f and its derivative f_prime.\"\"\"\n    if flux_type == 'burgers':\n        f = lambda u: 0.5 * u**2\n        f_prime = lambda u: u\n    elif flux_type == 'linear':\n        if a is None:\n            raise ValueError(\"Parameter 'a' must be provided for linear advection.\")\n        f = lambda u: a * u\n        f_prime = lambda u: a\n    else:\n        raise ValueError(f\"Unknown flux type: {flux_type}\")\n    return f, f_prime\n\ndef compute_alpha(f_prime, u_minus, u_plus):\n    \"\"\"\n    Computes the facewise dissipation alpha from first principles.\n    alpha = sup |f'(s)| for s in [min(u-,u+), max(u-,u+)].\n    For the monotonic/convex functions |f'| used here, the supremum\n    is at one of the interval endpoints.\n    \"\"\"\n    if u_minus == u_plus:\n        return np.abs(f_prime(u_minus))\n\n    u_min = min(u_minus, u_plus)\n    u_max = max(u_minus, u_plus)\n    \n    # For linear advection, f_prime is constant.\n    # For Burgers, f_prime(s)=s, so |f_prime(s)|=|s| is convex.\n    # Its maximum on an interval [u_min, u_max] is at an endpoint.\n    # This logic is general for any f' where |f'|'s max is at an endpoint.\n    val1 = np.abs(f_prime(u_min))\n    val2 = np.abs(f_prime(u_max))\n    \n    return max(val1, val2)\n\ndef run_test_case(params):\n    \"\"\"Runs a single test case with correct and underestimated alpha.\"\"\"\n    ul, ur = params['ul'], params['ur']\n    cfl, sigma = params['cfl'], params['sigma']\n    flux_type = params['flux_type']\n    a = params.get('a')\n    dx = 1.0\n\n    f, f_prime = get_flux_functions(flux_type, a)\n\n    # Initial bounds for checking preservation\n    m0 = min(ul, ur)\n    M0 = max(ul, ur)\n\n    # Compute correct alpha and the time step\n    alpha_mid_correct = compute_alpha(f_prime, ul, ur)\n\n    if alpha_mid_correct  1e-12: # Use tolerance for float comparison\n        # If alpha is 0, states are equal or flux is constant, no update occurs. Bounds are preserved.\n        return True, True\n\n    dt = cfl * dx / alpha_mid_correct\n\n    # --- Run 1: Correct alpha ---\n    alpha1 = alpha_mid_correct\n    f_mid_1 = 0.5 * (f(ul) + f(ur)) - 0.5 * alpha1 * (ur - ul)\n    \n    u0_new_1 = ul - (dt / dx) * (f_mid_1 - f(ul))\n    u1_new_1 = ur - (dt / dx) * (f(ur) - f_mid_1)\n    \n    # Check bounds for Run 1\n    # Add a small tolerance for floating point comparisons\n    tol = 1e-9\n    bound_preserved_1 = (m0 - tol = u0_new_1 = M0 + tol) and \\\n                        (m0 - tol = u1_new_1 = M0 + tol)\n\n    # --- Run 2: Underestimated alpha ---\n    alpha2 = sigma * alpha_mid_correct\n    f_mid_2 = 0.5 * (f(ul) + f(ur)) - 0.5 * alpha2 * (ur - ul)\n\n    u0_new_2 = ul - (dt / dx) * (f_mid_2 - f(ul))\n    u1_new_2 = ur - (dt / dx) * (f_mid_2 - f(ul))\n    \n    # Check bounds for Run 2\n    bound_preserved_2 = (m0 - tol = u0_new_2 = M0 + tol) and \\\n                        (m0 - tol = u1_new_2 = M0 + tol)\n\n    return bound_preserved_1, bound_preserved_2\n\nsolve()\n```"
        }
    ]
}