## 引言
在高精度[数值模拟](@entry_id:137087)领域，[不连续伽辽金 (DG)](@entry_id:748482) 方法因其处理复杂几何和并行计算的灵活性而备受推崇。然而，其核心优势——高阶[多项式逼近](@entry_id:137391)——也带来了一个固有的挑战：在解的间断或陡峭梯度附近，会不可避免地产生非物理的[振荡](@entry_id:267781)，即[吉布斯现象](@entry_id:138701)。这些[振荡](@entry_id:267781)可能导致密度、压力或浓度等本质上必须为正或有界的物理量出现负值或越界，从而破坏仿真的稳定性和物理真实性。因此，如何在不牺牲DG方法[高阶精度](@entry_id:750325)和守恒性的前提下，严格强制执行这些物理约束，是发展健壮[高阶格式](@entry_id:150564)的关键知识缺口。

本文章旨在系统性地解决这一问题，深入探讨[正定性](@entry_id:149643)保持与有界性保持限制器的设计、原理与应用。通过接下来的内容，读者将全面掌握这一关键数值技术。在“原理与机制”一章中，我们将揭示高阶多项式产生[振荡](@entry_id:267781)的根源，并详细阐述基于[凸集](@entry_id:155617)理论的守恒型限制器是如何巧妙地修正解以恢复其物理性。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示这些限制器如何从基础的[流体力学](@entry_id:136788)问题扩展到处理弯曲网格、复杂边界条件以及耦合了[化学反应](@entry_id:146973)和[辐射输运](@entry_id:151695)的[多物理场](@entry_id:164478)系统。最后，通过“动手实践”部分的具体编程练习，您将有机会亲手实现并验证这些理论，将抽象概念转化为实际的计算能力。让我们一同开始，深入探索构建可靠、高精度[数值模拟](@entry_id:137087)方案的核心技术。

## 原理与机制

高阶不连续伽辽金 (Discontinuous Galerkin, DG) 方法因其在高精度模拟[双曲守恒律](@entry_id:147752)方面的卓越能力而备受青睐。然而，这种[高阶精度](@entry_id:750325)并非没有代价。高阶多项式[基函数](@entry_id:170178)在间断或陡峭梯度附近不可避免地会引入非物理的[振荡](@entry_id:267781)，即吉布斯现象 (Gibbs phenomenon)。这些[振荡](@entry_id:267781)可能导致解超出其物理上应有的界限，例如，密度或压力等内蕴正定(positive)的量可能出现负值。因此，发展能够强制执行这些物理约束的数值技术，同时又不损害方法原有的[高阶精度](@entry_id:750325)和守恒性，是设计健壮[DG格式](@entry_id:178043)的关键挑战。本章将深入探讨为实现这一目标而设计的有界性保持 (boundedness-preserving) 和[正定性](@entry_id:149643)保持 (positivity-preserving) 限制器的基本原理与核心机制。

### 基本挑战：高阶多项式与物理边界

守恒律方程的解通常必须满足某些物理约束。例如，[欧拉方程](@entry_id:177914)中的密度和压力必须为正，浅水方程中的水深不能为负。这些约束定义了一个**可容许状态集 (admissible set of states)**。一个理想的[数值格式](@entry_id:752822)应该能保持这一性质，即如果初始条件位于可容许状态集内，那么在所有后续时间，数值解也应保持在该集合内。这个性质通常被称为**不变域 (invariant domain)** 性质。

对于使用分片常数[基函数](@entry_id:170178)的一阶[有限体积法](@entry_id:749372)，通过使用**单调[数值通量](@entry_id:752791) (monotone numerical flux)**，并在满足一定的 [Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)下，可以保证更新后的单元平均值是其邻近单元旧平均值的[凸组合](@entry_id:635830)，从而自然地保持了解的界。然而，当我们将[基函数](@entry_id:170178)提升为高阶多项式（次数 $p \ge 1$）时，情况变得复杂。即使一个单元内的解的平均值是物理可容的，其多项式表示在单元内部也可能发生[振荡](@entry_id:267781)，从而违反逐点的物理约束。

我们可以通过一个具体的例子来揭示这个问题的本质。考虑在[参考单元](@entry_id:168425) $[-1, 1]$ 上的一个三次多项式 $p(x)$，它由四个[Gauss-Lobatto-Legendre](@entry_id:749736) (GLL) 节点上的值唯一确定。假设节点位置为 $x_0 = -1$, $x_1 = -1/\sqrt{5}$, $x_2 = 1/\sqrt{5}$, $x_3 = 1$，并且在这些节点上的函数值均为正，例如，$u_0 = 10$, $u_1 = 1/5$, $u_2 = 1/5$, $u_3 = 10$。尽管所有给定的节点值都是正的，但通过这些点构造的[拉格朗日插值多项式](@entry_id:176861)在单元中心点 $x=0$ 的值却是 $p(0) = -9/4$ 。这个负值的出现清楚地表明，仅仅控制节点上的值不足以保证整个单元内多项式的正定性。这种现象的根源在于高阶[拉格朗日基](@entry_id:751105)函数自身的[振荡](@entry_id:267781)特性，它们在插值区间内会取到负值，当与特定的节点值组合时，就可能导致解的 undershoot。

这个例子揭示了在高阶DG方法中强制执行**[离散最大值原理](@entry_id:748510) (discrete maximum principle)** 的核心困难：多项式的[局部极值](@entry_id:144991)可以出现在单元内部的任意位置，而不一定在预先定义的节点上 。因此，我们需要一种系统性的方法来修正这些违反物理约束的多项式解，同时严格保持其守恒性。

### 不变域性质与[凸性](@entry_id:138568)的作用

理解限制器机制的关键在于**凸集 (convex set)** 的概念。一个集合 $\mathcal{G}$ 被称为[凸集](@entry_id:155617)，如果对于集合中的任意两个点，连接这两点的线段上的所有点也都在该集合内。数学上，对于任意 $v, w \in \mathcal{G}$ 和 $\theta \in [0,1]$，它们的凸组合 $\theta v + (1-\theta)w$ 也属于 $\mathcal{G}$。

物理上有意义的可容许状态集通常是凸集。例如，对于一个标量问题，要求解 $u$ 满足 $u \ge 0$ 或 $u \in [m, M]$，其对应的可容许状态集 $[0, \infty)$ 和 $[m, M]$ 都是凸集。对于像[可压缩欧拉方程](@entry_id:747588)这样的[方程组](@entry_id:193238)，其可容许状态集（即具有正密度和正压力的状态）同样是一个凸集 。

凸性的威力在于，如果一个数值更新步骤可以表示为对先前状态的[凸组合](@entry_id:635830)，并且所有先前状态都位于一个凸的可容许状态集 $\mathcal{G}$ 中，那么更新后的状态也必然位于 $\mathcal{G}$ 内。这一性质是构建保界格式的理论基石。

### 保证单元平均值的有界性

在深入研究逐点限制器之前，我们首先需要确保单元平均值 $\bar{u}_K$ 自身是满足边界约束的。对于DG方法，其半离散形式的单元平均值[更新方程](@entry_id:264802)为：
$$
\frac{d\bar{u}_K}{dt} = - \frac{1}{|K|} \left( \hat{f}_{R} - \hat{f}_{L} \right)
$$
其中 $\hat{f}_{L}$ 和 $\hat{f}_{R}$ 是单元左右边界上的数值通量。对于[标量守恒律](@entry_id:754532)，如果采用单调数值通量（如Lax-Friedrichs通量），并使用前向欧拉时间步进，在适当的CFL条件下，可以证明更新后的单元平均值 $\bar{u}_K^{n+1}$ 是其自身及邻近单元在 $t^n$ 时刻的某些值的[凸组合](@entry_id:635830)。这些值包括旧的单元平均值和界面上的迹值。如果所有这些值都位于一个凸的可容许集 $\mathcal{G}$ 中，那么 $\bar{u}_K^{n+1}$ 也将位于 $\mathcal{G}$ 中  。

这一结论为我们提供了一个坚实的基础：即使高阶多项式在单元内部可能[振荡](@entry_id:267781)，但其平均值在每个时间步后仍然保持在物理边界内。这使得我们可以将单元平均值作为一个可靠的“锚点”，围绕它来修正多项式的形状。

### 正定性保持限制器：一种守恒的修正方法

限制器的核心任务是修正单元内的多项式 $u_h$，使其在单元内的每一点都满足物理边界，同时严格保持单元平均值 $\bar{u}_K$ 不变，以确保方法的**守恒性 (conservation)** 。

一种被广泛使用且非常有效的限制器是**缩放限制器 (scaling limiter)**。其思想是围绕单元平均值 $\bar{u}_K$ 对多项式的[振荡](@entry_id:267781)部分 $(u_h(x) - \bar{u}_K)$ 进行缩放。修正后的多项式 $\tilde{u}_h(x)$ 定义为：
$$
\tilde{u}_h(x) = \bar{u}_K + \theta_K (u_h(x) - \bar{u}_K), \quad \theta_K \in [0, 1]
$$
其中 $\theta_K$ 是一个在整个单元 $K$ 上唯一的缩放因子。这个形式有一个极好的性质：它自动保持单元平均值。对上式在单元 $K$ 上积分并除以 $|K|$，由于 $\int_K (u_h(x) - \bar{u}_K) dx = 0$，我们得到 $\int_K \tilde{u}_h(x) dx / |K| = \bar{u}_K$。因此，无论 $\theta_K$ 如何选择，守恒性都得到保证。

参数 $\theta_K$ 的选择是限制器的关键。我们的目标是找到最大的 $\theta_K \in [0, 1]$，使得修正后的多项式 $\tilde{u}_h(x)$ 在一组预先选定的**执行点 (enforcement points)**（通常是用于[数值积分](@entry_id:136578)的求积点）$\{x_{K,i}\}$ 上满足边界约束。

让我们首先考虑一个更简单但非常普遍的情况：**正定性保持**，即要求 $\tilde{u}_h(x_{K,i}) \ge \epsilon$，其中 $\epsilon$ 是一个很小的正数（例如机器精度），并且我们已知 $\bar{u}_K \ge \epsilon$。将 $\tilde{u}_h$ 的定义代入该不等式：
$$
\bar{u}_K + \theta_K (u_h(x_{K,i}) - \bar{u}_K) \ge \epsilon
$$
整理后得到 $\theta_K (u_h(x_{K,i}) - \bar{u}_K) \ge \epsilon - \bar{u}_K$。如果一个点的值 $u_h(x_{K,i})$ 低于平均值 $\bar{u}_K$，即 $u_h(x_{K,i})  \bar{u}_K$，这个点就可能违反[正定性](@entry_id:149643)。对于这些点，我们需要一个[上界](@entry_id:274738) $\theta_K \le \frac{\epsilon - \bar{u}_K}{u_h(x_{K,i}) - \bar{u}_K} = \frac{\bar{u}_K - \epsilon}{\bar{u}_K - u_h(x_{K,i})}$。为了满足所有这些点的约束，我们必须选择所有上界中最小的一个。因此，最终的 $\theta_K$ 为 ：
$$
\theta_K = \min\left\{1, \min_{i: u_h(x_{K,i})  \bar{u}_K} \frac{\bar{u}_K - \epsilon}{\bar{u}_K - u_h(x_{K,i})}\right\}
$$
如果所有求积点的值都高于平均值，那么最小化将在一个[空集](@entry_id:261946)上进行，我们取 $\theta_K = 1$，即不进行任何修正。

这个思想可以自然地推广到双边有界性约束，即 $m_K^n \le \tilde{u}_h(x_{K,i}) \le M_K^n$，其中局部边界 $m_K^n$ 和 $M_K^n$ 通常由邻近单元的平均值决定 。通过类似推导，我们可以得到一个更通用的 $\theta_K$ 表达式，它同时考虑了[上界](@entry_id:274738)和下界的约束：
$$
\theta_K = \min\left\{1, \min_{i: u_h(x_{K,i}) > \bar{u}_K} \frac{M_K^n - \bar{u}_K}{u_h(x_{K,i}) - \bar{u}_K}, \min_{i: u_h(x_{K,i})  \bar{u}_K} \frac{m_K^n - \bar{u}_K}{u_h(x_{K,i}) - \bar{u}_K}\right\}
$$
这种限制器机制，因其简洁、高效和守恒的特性，成为构建保界[DG格式](@entry_id:178043)的标准构件。

### 实践考量与实现细节

在实际应用限制器时，一个关键问题是：我们应该在哪些点上强制执行边界约束？通常，这些点选为用于计算[DG格式](@entry_id:178043)中体积积分的**求积点 (quadrature points)**。这一选择引出了一个微妙但至关重要的问题：在求积点上满足[正定性](@entry_id:149643)，是否能保证单元平均值的正定性？

答案取决于[求积法则](@entry_id:753909)的性质。考虑离散的单元平均值 $\overline{u}_K^h := \frac{1}{|K|} \sum_{i=1}^{Q} w_i u_h(\boldsymbol{x}_i)$，这是实际计算中使用的量。如果我们强制 $u_h(\boldsymbol{x}_i) \ge 0$ 对所有求积点 $i$ 成立，那么要保证 $\overline{u}_K^h \ge 0$，一个充分且必要的条件是所有[求积权重](@entry_id:753910) $w_i$ 都必须是正的。如果存在任何一个负权重 $w_j  0$，我们就可以构造一个在所有节点上非负但在该点 $u_h(\boldsymbol{x}_j)$ 处取正值的多项式，导致其离散平均值为负 。

同样，如果我们关心的是**精确的单元平均值** $\bar{u}_h := \frac{1}{|K|} \int_{K} u_h(\boldsymbol{x}) d\boldsymbol{x}$，那么除了要求所有[求积权重](@entry_id:753910)为正之外，还要求[求积法则](@entry_id:753909)对于被积函数 $u_h$ 是精确的。这意味着[求积法则](@entry_id:753909)的**[精确度](@entry_id:143382) (degree of exactness)** $m$ 必须至少等于多项式的次数 $k$ (即 $m \ge k$) 。

因此，选择合适的求积法则是实现保界格式的重要一环。
*   在**一维**中，**[Legendre-Gauss-Lobatto](@entry_id:751235) (LGL)** 和 **Legendre-Gauss (LG)** 求积法则的所有权重均为正，是安全的选择。
*   在**二维三角形**和**三维四面体**上，存在具有正权重的对称求积法则族，如 **Dunavant** 法则、**Keast** 法则或 **Xiao-Gimbutas** 法则，它们是多维DG代码中的常用选择  。
*   与此相反，高阶的**Newton-Cotes** [求积法则](@entry_id:753909)（点数 $n \ge 9$）会出现负权重，因此不适用于设计可证明的保[正定性](@entry_id:149643)格式。使用这类法则可能导致离散平均值为负，即使所有节点值都为正，这会使得基于凸缩放的限制器算法失效 。

### 完整方案：与时间积分的结合

到目前为止，我们的讨论主要集中在一个时间步内的空间离散。为了构建一个在时间和空间上都完全保界的格式，我们必须将空间限制器与[时间积分方法](@entry_id:136323)相结合。

**强稳定性保持 (Strong Stability Preserving, SSP)** Runge-Kutta 方法是为此目的而设计的理想选择。[SSP方法](@entry_id:755294)的一个关键特性是，它们可以被写成一系列前向欧拉步骤的凸组合 (Shu-Osher 表示法)。具体来说，每个[SSP方法](@entry_id:755294)的阶段值都可以表示为先前阶段值和对先前阶段值应用前向欧拉算子的[凸组合](@entry_id:635830) 。

这个[凸组合](@entry_id:635830)结构至关重要。假设我们有一个前向欧拉步，它在时间步长 $\tau \le \Delta t_{\mathrm{FE}}$ 内保持可容许集 $\mathcal{G}$ 不变。由于[SSP方法](@entry_id:755294)是这些保持性质的前向欧拉步的凸组合，并且 $\mathcal{G}$ 是一个凸集，[SSP方法](@entry_id:755294)也将在一个相关的、更大的时间步 $\Delta t \le C \cdot \Delta t_{\mathrm{FE}}$ 内保持 $\mathcal{G}$ 不变。这里的常数 $C$ 是该[SSP方法](@entry_id:755294)的**SSP系数**，它只依赖于[Runge-Kutta方法](@entry_id:144251)本身的系数。

因此，一个完整的、可证明的保界[DG格式](@entry_id:178043)的流程如下：
1.  从一个满足边界约束的解 $u^n$ 开始。
2.  对于SSP-RK方法的每一个阶段：
    a. 计算出临时的阶段解。
    b. 对这个临时解应用保界限制器，强制使其在所有求积点上满足物理边界。
    c. 使用这个被限制过的、物理可容的解来计算空间算子 $L(u)$，用于下一步的计算。
3.  通过这种方式，每个阶段的解都保持在可容许集内，最终的更新解 $u^{n+1}$ 也将满足物理边界。

### 其他方法与背景

值得注意的是，本章讨论的逐点保界限制器只是控制非物理[振荡](@entry_id:267781)的几种策略之一。为了更好地理解其独特性，我们可以将其与其他类型的限制器进行比较。

*   **[通量限制器](@entry_id:171259) (Flux Limiters)**：这种方法（也与[通量修正输运](@entry_id:749476) FCT 方法相关）不直接修改解多项式，而是通过混合一个高阶通量 $F^{HO}$ 和一个低阶单调通量 $F^{LO}$ 来构造一个受限的通量 $F^{\alpha} = \alpha F^{HO} + (1-\alpha) F^{LO}$。通过选择合适的混合因子 $\alpha$，可以确保更新后的**单元平均值**满足边界约束 。这种方法侧重于保证平均值的性质，而不是逐点的值。

*   **[振荡](@entry_id:267781)控制限制器**：如**总变差有界 (Total Variation Bounded, TVB)** [斜率限制器](@entry_id:638003)和**分层矩限制器 (hierarchical moment limiters)**，它们的目标是更普遍地控制或抑制[振荡](@entry_id:267781)，而不是严格强制执行一个“硬”边界。[TVB限制器](@entry_id:756238)通过限制解的斜率来减少总变差，而矩限制器则通过衰减[高阶模](@entry_id:750331)式的系数来平滑解。虽然这些方法能有效减少[吉布斯振荡](@entry_id:749902)，但它们通常不提供对逐点[正定性](@entry_id:149643)或有界性的严格保证 。

与之相比，本章所关注的保界限制器，其设计目标明确而严格：在任何情况下都要强制解位于物理可容许状态集内，这对于许多依赖于解的物理有效性的应用来说是必不可少的。