{
    "hands_on_practices": [
        {
            "introduction": "A discrete entropy analysis often begins by examining how well a numerical scheme reproduces the continuous entropy identity at the element level. A key component of this analysis involves the integration of nonlinear flux terms. This exercise  provides a concrete example of determining the minimum numerical precision required to exactly integrate a critical term in the entropy balance for the Discontinuous Galerkin (DG) method, laying the groundwork for constructing entropy-stable schemes.",
            "id": "3380666",
            "problem": "Consider the scalar one-dimensional inviscid Burgers equation\n$$\nu_{t} + \\partial_{x} f(u) = 0, \\qquad f(u) = \\tfrac{1}{2} u^{2},\n$$\nposed on a partition of the domain into nonoverlapping elements, with an affine mapping from each physical element to the reference element. On each element, approximate the solution by a polynomial $u_{h}$ in the space $\\mathbb{P}^{N}$ of degree at most $N$, with $N \\ge 1$. Let the Discontinuous Galerkin (DG) method be formulated in a standard weak form on each element, and consider the discrete entropy analysis based on a convex entropy $U(u)$ and its associated entropy flux $F(u)$ defined by the relation\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}u} F(u) \\;=\\; \\frac{\\mathrm{d}}{\\mathrm{d}u} U(u) \\; \\frac{\\mathrm{d}}{\\mathrm{d}u} f(u).\n$$\nFor inviscid Burgers, take the canonical quadratic entropy $U(u) = \\tfrac{1}{2} u^{2}$, so that the entropy variable is $v(u) = \\tfrac{\\mathrm{d}}{\\mathrm{d}u}U(u) = u$ and the associated entropy flux satisfies $\\tfrac{\\mathrm{d}}{\\mathrm{d}u}F(u) = u \\cdot \\tfrac{\\mathrm{d}}{\\mathrm{d}u}f(u) = u \\cdot u = u^{2}$.\n\nIn the element-wise discrete entropy balance, a key volume contribution is the integral\n$$\nI \\;=\\; \\int_{K} v(u_{h}) \\, \\partial_{x} f(u_{h}) \\, \\mathrm{d}x \\;=\\; \\int_{K} \\frac{\\mathrm{d}}{\\mathrm{d}u}U(u_{h}) \\; \\frac{\\mathrm{d}}{\\mathrm{d}u}f(u_{h}) \\; \\partial_{x} u_{h} \\, \\mathrm{d}x,\n$$\nwhich equals $\\int_{K} \\partial_{x} F(u_{h}) \\, \\mathrm{d}x$ if the pointwise chain rule is realized. Suppose that this volume integral is evaluated using a Gauss–Legendre quadrature with $Q$ points on the reference element, which is exact for all polynomials of degree up to $2Q-1$, and assume the affine element mapping so that polynomial degrees are preserved.\n\nDetermine, as a function of $N$, the minimal number of Gauss–Legendre points $Q$ needed so that the quadrature exactly integrates the entropy flux contribution $I$ on each element. Express your final answer as a single closed-form analytic expression in terms of $N$.",
            "solution": "The problem is well-posed and scientifically grounded in the field of numerical analysis for conservation laws. It provides a complete and consistent set of definitions and constraints required to determine a unique solution. Therefore, a full analysis is warranted.\n\nThe objective is to find the minimal number of Gauss-Legendre quadrature points, $Q$, required to exactly evaluate the volume integral\n$$\nI = \\int_{K} v(u_{h}) \\, \\partial_{x} f(u_{h}) \\, \\mathrm{d}x\n$$\non a given element $K$. The numerical approximation to the solution, $u_h$, is a polynomial of degree at most $N$ within the space $\\mathbb{P}^{N}$, where $N \\ge 1$.\n\nA Gauss-Legendre quadrature rule with $Q$ points is exact for the integral of any polynomial of degree up to $2Q-1$. To ensure the exact evaluation of $I$, the degree of the integrand must be less than or equal to this value. Let the integrand be denoted by $\\mathcal{I}(x) = v(u_{h}(x)) \\, \\partial_{x} f(u_{h}(x))$. Our first step is to determine the polynomial degree of $\\mathcal{I}(x)$.\n\nThe problem provides the following definitions for the inviscid Burgers' equation:\n1.  The flux function is $f(u) = \\frac{1}{2} u^{2}$.\n2.  The entropy function is $U(u) = \\frac{1}{2} u^{2}$.\n3.  The entropy variable is $v(u) = \\frac{\\mathrm{d}}{\\mathrm{d}u}U(u)$.\n\nFrom these definitions, we can derive the specific forms of the terms in the integrand.\nThe entropy variable is:\n$$\nv(u) = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left( \\frac{1}{2} u^{2} \\right) = u.\n$$\nWhen evaluated for the approximate solution $u_h$, this becomes $v(u_h(x)) = u_h(x)$. Since $u_h(x) \\in \\mathbb{P}^{N}$, the degree of $v(u_h(x))$ is at most $N$. To find the minimal quadrature rule that works for any polynomial in $\\mathbb{P}^N$, we must consider the worst-case scenario where the degree is exactly $N$.\n$\\text{deg}(v(u_h)) = N$.\n\nNext, we analyze the term $\\partial_{x} f(u_{h}(x))$. First, we find the composite function $f(u_h(x))$:\n$$\nf(u_h(x)) = \\frac{1}{2} (u_h(x))^{2}.\n$$\nSince $u_h(x)$ is a polynomial of degree $N$, its square, $(u_h(x))^{2}$, is a polynomial of degree $2N$. Therefore, $\\text{deg}(f(u_h)) = 2N$.\n\nNow we apply the spatial derivative $\\partial_x$. Since $u_h(x)$ is a polynomial, the chain rule applies directly:\n$$\n\\partial_{x} f(u_{h}(x)) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{1}{2} (u_h(x))^{2} \\right) = \\frac{1}{2} \\cdot 2 u_h(x) \\cdot \\frac{\\mathrm{d}u_h(x)}{\\mathrm{d}x} = u_h(x) \\, \\partial_{x} u_h(x).\n$$\nThe degree of $u_h(x)$ is $N$, and the degree of its derivative, $\\partial_{x} u_h(x)$, is $N-1$ (since $N \\ge 1$). The degree of their product is the sum of their degrees:\n$\\text{deg}(\\partial_{x} f(u_h)) = \\text{deg}(u_h) + \\text{deg}(\\partial_{x} u_h) = N + (N-1) = 2N-1$.\n\nNow we can determine the degree of the full integrand $\\mathcal{I}(x) = v(u_h(x)) \\, \\partial_{x} f(u_h(x))$:\n$\\text{deg}(\\mathcal{I}) = \\text{deg}(v(u_h)) + \\text{deg}(\\partial_{x} f(u_h)) = N + (2N-1) = 3N-1$.\n\nAlternatively, one can first construct the full expression for the integrand in terms of $u_h$ and then find its degree:\n$$\n\\mathcal{I}(x) = v(u_h(x)) \\left( u_h(x) \\, \\partial_x u_h(x) \\right) = u_h(x) \\left( u_h(x) \\, \\partial_x u_h(x) \\right) = (u_h(x))^{2} \\, \\partial_x u_h(x).\n$$\nThe degree of $(u_h(x))^2$ is $2N$ and the degree of $\\partial_x u_h(x)$ is $N-1$. The degree of their product is the sum of their degrees:\n$\\text{deg}(\\mathcal{I}) = \\text{deg}((u_h)^2) + \\text{deg}(\\partial_x u_h) = 2N + (N-1) = 3N-1$.\n\nBoth approaches yield the same result. The integrand is a polynomial of degree $3N-1$.\n\nFor the $Q$-point Gauss-Legendre quadrature to be exact, its degree of precision must be at least the degree of the integrand:\n$$\n2Q - 1 \\ge \\text{deg}(\\mathcal{I})\n$$\nSubstituting the degree we found:\n$$\n2Q - 1 \\ge 3N - 1.\n$$\nThis inequality simplifies to:\n$$\n2Q \\ge 3N\n$$\n$$\nQ \\ge \\frac{3N}{2}.\n$$\nThe problem asks for the minimal number of points $Q$, which must be an integer. Therefore, we must take the smallest integer that is greater than or equal to $\\frac{3N}{2}$. This is given by the ceiling function:\n$$\nQ = \\left\\lceil \\frac{3N}{2} \\right\\rceil.\n$$\nThis can also be expressed piecewise. If $N$ is even, say $N=2k$ for some integer $k \\ge 1$, then $Q \\ge \\frac{3(2k)}{2} = 3k = \\frac{3N}{2}$. If $N$ is odd, say $N=2k-1$ for some integer $k \\ge 1$, then $Q \\ge \\frac{3(2k-1)}{2} = 3k - \\frac{3}{2}$. The smallest integer $Q$ is then $3k-1 = \\frac{3(N+1)}{2}-1 = \\frac{3N+1}{2}$. The ceiling function provides a single compact expression for both cases.",
            "answer": "$$\n\\boxed{\\left\\lceil \\frac{3N}{2} \\right\\rceil}\n$$"
        },
        {
            "introduction": "While entropy-conservative or stable fluxes are ideal, strong discontinuities like shocks often require additional stabilization. This practice  walks you through a common and effective technique: modal-based artificial viscosity. You will learn to build a shock sensor from the solution's spectral content and use it to apply targeted dissipation, a cornerstone of modern shock-capturing methods for high-order schemes.",
            "id": "3380709",
            "problem": "Consider the inviscid Burgers equation $u_{t} + \\partial_{x}\\left(\\frac{1}{2}u^{2}\\right) = 0$ on the domain $[0,1]$ discretized by a uniform mesh of $K=10$ elements of size $h=1/10$ using the Discontinuous Galerkin (DG) method with polynomial degree $p=1$. Focus on the single element that contains a stationary discontinuity (shock) located at the element center in reference coordinates $r \\in [-1,1]$. On this shocked element, approximate the solution by the exact $L^{2}$ projection of the piecewise constant function\n$$\nu(r) = \\begin{cases}\n1, & r \\in [-1,0),\\\\\n0, & r \\in (0,1].\n\\end{cases}\n$$\nonto the Legendre polynomial basis $\\{P_{0}(r), P_{1}(r)\\}$ on $[-1,1]$, where $P_{0}(r)=1$ and $P_{1}(r)=r$. Let the modal expansion be $u_{h}(r)=c_{0}P_{0}(r)+c_{1}P_{1}(r)$, where the modal coefficients are defined by the $L^{2}$ projection formula\n$$\nc_{n} = \\frac{2n+1}{2}\\int_{-1}^{1}u(r)\\,P_{n}(r)\\,dr,\\quad n=0,1.\n$$\nDefine the elementwise shock sensor following the Persson–Peraire modal energy ratio\n$$\ns_{k} = \\log_{10}\\left(\\frac{E_{p}}{E_{\\mathrm{tot}}}\\right),\\quad E_{p} = c_{p}^{2}\\int_{-1}^{1}P_{p}(r)^{2}\\,dr,\\quad E_{\\mathrm{tot}} = \\sum_{n=0}^{p} c_{n}^{2}\\int_{-1}^{1}P_{n}(r)^{2}\\,dr,\n$$\nand use the standard Legendre orthogonality $\\int_{-1}^{1}P_{n}(r)^{2}\\,dr = \\frac{2}{2n+1}$. Map the sensor to a viscosity coefficient by the linear clamped map\n$$\n\\widetilde{s} = \\max\\left(0,\\min\\left(1,\\frac{s_{k}-s_{0}}{s_{1}-s_{0}}\\right)\\right),\\qquad s_{0}=-3,\\quad s_{1}=-1,\n$$\nand set the viscosity as\n$$\n\\epsilon_{k} = \\epsilon_{\\max}\\,\\widetilde{s},\\qquad \\epsilon_{\\max} = C_{\\mathrm{vis}}\\,h\\,\\lambda_{\\max},\\qquad C_{\\mathrm{vis}}=\\frac{1}{2},\\quad \\lambda_{\\max}=\\max|u|=1.\n$$\nAssume an entropy pair $(U,F)$ for Burgers given by $U(u)=\\frac{1}{2}u^{2}$ and $F(u)=\\frac{1}{3}u^{3}$, and consider a semi-discrete artificial viscosity contribution $\\partial_{x}(\\epsilon_{k}\\partial_{x}u_{h})$ on the shocked element. Over one explicit time step $\\Delta t$ chosen by the Courant–Friedrichs–Lewy (CFL) condition\n$$\n\\Delta t = C_{\\mathrm{CFL}}\\,\\frac{h}{(2p+1)\\lambda_{\\max}},\\qquad C_{\\mathrm{CFL}}=0.3,\n$$\nthe entropy dissipation contributed by the viscosity term on the shocked element is\n$$\n\\Delta E_{k} = -\\Delta t\\,\\epsilon_{k}\\int_{\\text{elem}}|\\partial_{x}u_{h}(x)|^{2}\\,dx.\n$$\nUse the affine mapping from the reference coordinate $r$ to physical coordinate $x$ on the element, $x(r)=x_{c} + \\frac{h}{2}r$, where $x_{c}$ is the element center, so that $\\partial_{x}=\\frac{2}{h}\\partial_{r}$ and $dx=\\frac{h}{2}\\,dr$. Compute:\n- the sensor value $s_{k}$,\n- the viscosity coefficient $\\epsilon_{k}$,\n- and the entropy dissipation per time step $\\Delta E_{k}$ on the shocked element.\n\nReport the three quantities in the order $(s_{k},\\,\\epsilon_{k},\\,\\Delta E_{k})$ as a single row matrix in the final answer. Do not include any units. No rounding is required; provide exact values or closed-form expressions.",
            "solution": "The problem requires the computation of three quantities in sequence: the shock sensor value $s_k$, the artificial viscosity coefficient $\\epsilon_k$, and the entropy dissipation per time step $\\Delta E_k$.\n\n#### Calculation of Modal Coefficients ($c_0, c_1$)\nThe modal coefficients are calculated using the $L^{2}$ projection formula. The function to be projected is $u(r)$, which is $1$ on $[-1,0)$ and $0$ on $(0,1]$.\nFor the coefficient $c_0$ (with $n=0$):\n$$\nc_{0} = \\frac{2(0)+1}{2}\\int_{-1}^{1}u(r)P_{0}(r)\\,dr = \\frac{1}{2}\\int_{-1}^{1}u(r)(1)\\,dr\n$$\nThe integral is split based on the definition of $u(r)$:\n$$\nc_{0} = \\frac{1}{2}\\left(\\int_{-1}^{0}1\\,dr + \\int_{0}^{1}0\\,dr\\right) = \\frac{1}{2}[r]_{-1}^{0} = \\frac{1}{2}(0 - (-1)) = \\frac{1}{2}.\n$$\nFor the coefficient $c_1$ (with $n=1$):\n$$\nc_{1} = \\frac{2(1)+1}{2}\\int_{-1}^{1}u(r)P_{1}(r)\\,dr = \\frac{3}{2}\\int_{-1}^{1}u(r)(r)\\,dr\n$$\n$$\nc_{1} = \\frac{3}{2}\\left(\\int_{-1}^{0}(1)(r)\\,dr + \\int_{0}^{1}(0)(r)\\,dr\\right) = \\frac{3}{2}\\left[\\frac{r^{2}}{2}\\right]_{-1}^{0} = \\frac{3}{2}\\left(0 - \\frac{(-1)^{2}}{2}\\right) = -\\frac{3}{4}.\n$$\nThe approximate solution on the reference element is $u_{h}(r) = \\frac{1}{2} - \\frac{3}{4}r$.\n\n#### Calculation of the Shock Sensor ($s_k$)\nThe sensor value $s_k$ depends on the ratio of the energy in the highest-degree mode ($p=1$) to the total energy.\nFirst, we find the energy integrals using the orthogonality property $\\int_{-1}^{1}P_{n}(r)^{2}\\,dr = \\frac{2}{2n+1}$:\n$$\n\\int_{-1}^{1}P_{0}(r)^{2}\\,dr = \\frac{2}{2(0)+1} = 2\n$$\n$$\n\\int_{-1}^{1}P_{1}(r)^{2}\\,dr = \\frac{2}{2(1)+1} = \\frac{2}{3}\n$$\nThe energy in the highest mode, $E_p=E_1$, is:\n$$\nE_{1} = c_{1}^{2}\\int_{-1}^{1}P_{1}(r)^{2}\\,dr = \\left(-\\frac{3}{4}\\right)^{2} \\cdot \\frac{2}{3} = \\frac{9}{16} \\cdot \\frac{2}{3} = \\frac{3}{8}.\n$$\nThe total energy, $E_{\\mathrm{tot}}$, is the sum of energies in all modes from $n=0$ to $p=1$:\n$$\nE_{\\mathrm{tot}} = c_{0}^{2}\\int_{-1}^{1}P_{0}(r)^{2}\\,dr + c_{1}^{2}\\int_{-1}^{1}P_{1}(r)^{2}\\,dr = \\left(\\frac{1}{2}\\right)^{2} \\cdot 2 + E_{1} = \\frac{1}{4} \\cdot 2 + \\frac{3}{8} = \\frac{1}{2} + \\frac{3}{8} = \\frac{7}{8}.\n$$\nThe sensor value $s_k$ is the base-10 logarithm of the energy ratio:\n$$\ns_{k} = \\log_{10}\\left(\\frac{E_{p}}{E_{\\mathrm{tot}}}\\right) = \\log_{10}\\left(\\frac{3/8}{7/8}\\right) = \\log_{10}\\left(\\frac{3}{7}\\right).\n$$\n\n#### Calculation of the Viscosity Coefficient ($\\epsilon_k$)\nThe viscosity $\\epsilon_k$ is found by first computing the mapped sensor value $\\widetilde{s}$.\n$$\n\\widetilde{s} = \\max\\left(0,\\min\\left(1,\\frac{s_{k}-s_{0}}{s_{1}-s_{0}}\\right)\\right)\n$$\nUsing the given constants $s_0=-3$ and $s_1=-1$, and our calculated $s_k$:\n$$\n\\frac{s_{k}-s_{0}}{s_{1}-s_{0}} = \\frac{\\log_{10}(3/7) - (-3)}{-1 - (-3)} = \\frac{3 + \\log_{10}(3/7)}{2}.\n$$\nTo evaluate the $\\min$ function, we must check if this quantity is greater than $1$:\n$$\n\\frac{3 + \\log_{10}(3/7)}{2} > 1 \\iff 3 + \\log_{10}(3/7) > 2 \\iff \\log_{10}(3/7) > -1.\n$$\nThis is equivalent to $3/7 > 10^{-1}$, or $3/7 > 1/10$, which simplifies to $30 > 7$. This is true.\nSince the argument of the $\\min$ function is greater than $1$, the $\\min$ evaluates to $1$:\n$$\n\\widetilde{s} = \\max(0, 1) = 1.\n$$\nNow, we calculate $\\epsilon_{\\max}$:\n$$\n\\epsilon_{\\max} = C_{\\mathrm{vis}}\\,h\\,\\lambda_{\\max} = \\frac{1}{2} \\cdot \\frac{1}{10} \\cdot 1 = \\frac{1}{20}.\n$$\nThe viscosity coefficient is therefore:\n$$\n\\epsilon_{k} = \\epsilon_{\\max}\\,\\widetilde{s} = \\frac{1}{20} \\cdot 1 = \\frac{1}{20}.\n$$\n\n#### Calculation of the Entropy Dissipation ($\\Delta E_k$)\nThe entropy dissipation per time step is given by $\\Delta E_{k} = -\\Delta t\\,\\epsilon_{k}\\int_{\\text{elem}}|\\partial_{x}u_{h}(x)|^{2}\\,dx$. We compute each part.\nFirst, the time step $\\Delta t$:\n$$\n\\Delta t = C_{\\mathrm{CFL}}\\frac{h}{(2p+1)\\lambda_{\\max}} = 0.3 \\cdot \\frac{1/10}{(2(1)+1)(1)} = \\frac{3}{10} \\cdot \\frac{1/10}{3} = \\frac{1}{100}.\n$$\nNext, the integral term. We use the coordinate mapping to transform the integral to the reference element $[-1,1]$:\n$$\n\\int_{\\text{elem}}|\\partial_{x}u_{h}(x)|^{2}\\,dx = \\int_{-1}^{1}\\left|\\frac{2}{h}\\partial_{r}u_{h}(r)\\right|^{2}\\left(\\frac{h}{2}\\,dr\\right) = \\frac{2}{h}\\int_{-1}^{1}(\\partial_{r}u_{h}(r))^{2}\\,dr.\n$$\nThe derivative of the solution approximation is $\\partial_{r}u_{h}(r) = \\partial_{r}(\\frac{1}{2} - \\frac{3}{4}r) = -\\frac{3}{4}$. Note that this is equal to $c_1$ since $\\partial_r P_0 = 0$ and $\\partial_r P_1 = 1$.\nThe integral becomes:\n$$\n\\frac{2}{h}\\int_{-1}^{1}\\left(-\\frac{3}{4}\\right)^{2}\\,dr = \\frac{2}{h} \\cdot \\frac{9}{16} \\int_{-1}^{1}dr = \\frac{9}{8h}[r]_{-1}^{1} = \\frac{9}{8h}(1 - (-1)) = \\frac{18}{8h} = \\frac{9}{4h}.\n$$\nSubstituting $h=1/10$:\n$$\n\\int_{\\text{elem}}|\\partial_{x}u_{h}(x)|^{2}\\,dx = \\frac{9}{4(1/10)} = \\frac{90}{4} = \\frac{45}{2}.\n$$\nFinally, we assemble $\\Delta E_k$:\n$$\n\\Delta E_{k} = -\\Delta t \\cdot \\epsilon_{k} \\cdot \\left(\\frac{45}{2}\\right) = -\\left(\\frac{1}{100}\\right) \\cdot \\left(\\frac{1}{20}\\right) \\cdot \\left(\\frac{45}{2}\\right) = -\\frac{45}{4000}.\n$$\nSimplifying the fraction:\n$$\n\\Delta E_{k} = -\\frac{9 \\times 5}{800 \\times 5} = -\\frac{9}{800}.\n$$\n\nThe three computed quantities are $s_k = \\log_{10}(3/7)$, $\\epsilon_k = 1/20$, and $\\Delta E_k = -9/800$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\log_{10}(\\frac{3}{7}) & \\frac{1}{20} & -\\frac{9}{800}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from scalar equations to systems like the compressible Euler equations introduces new challenges, such as maintaining the positivity of density and pressure. This exercise  explores the delicate, and sometimes conflicting, relationship between entropy stability and positivity-preserving limiters. By simulating this interaction, you will gain insight into the subtle ways that different components of a numerical scheme can interfere with one another, a critical consideration in designing robust methods for complex physical models.",
            "id": "3380723",
            "problem": "Consider the one-dimensional compressible Euler equations for a single species ideal gas with ratio of specific heats $\\gamma \\in \\mathbb{R}$, $\\gamma > 1$. Let the conservative variables be $u = [\\rho, m, E]^T$, where $\\rho$ is the mass density, $m = \\rho u$ is the momentum with $u$ the velocity, and $E$ is the total energy. The thermodynamic pressure is given by the equation of state $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\frac{m^2}{\\rho}\\right)$. The physical admissibility constraints require $\\rho > 0$ and $p > 0$. The inviscid flux is $f(u) = [m,\\; \\frac{m^2}{\\rho} + p,\\; (E + p)\\frac{m}{\\rho}]^T$.\n\nFor discrete entropy analysis, define the mathematical entropy (a convex entropy function) for the Euler system as $\\eta(u) = -\\frac{\\rho s}{\\gamma - 1}$, where $s = \\ln(p) - \\gamma \\ln(\\rho)$ is the physical specific entropy. In a semi-discrete entropy-stable scheme, the total discrete entropy should be non-increasing under an update driven by an entropy-stable flux. The Local Lax-Friedrichs (LLF) numerical flux (also known as the Rusanov flux) is given by\n$$\nF_{\\mathrm{LLF}}(u_L, u_R) = \\frac{1}{2}\\left(f(u_L) + f(u_R)\\right) - \\frac{1}{2}\\alpha(u_L, u_R)\\left(u_R - u_L\\right),\n$$\nwhere $\\alpha(u_L, u_R)$ is a bound on the maximum characteristic speed, e.g., $\\alpha(u_L,u_R) = \\max\\left(|u_L| + c_L,\\; |u_R| + c_R\\right)$ with $c = \\sqrt{\\gamma p / \\rho}$ the sound speed computed from the primitive variables associated with $u_L$ and $u_R$. This flux is entropy-stable for the Euler equations when $\\alpha$ is chosen as above.\n\nIn a representative two-cell periodic discretization (as arises from a symmetric nodal Spectral method or from a lowest-order Discontinuous Galerkin method when reduced to a single interface coupling), consider two adjacent cells with states $u_L$ and $u_R$. Let the update for a single forward Euler step of size $\\Delta t$ over uniform grid spacing $\\Delta x$ use the two numerical flux evaluations at the shared interface with reversed arguments:\n$$\nF_{LR} = F_{\\mathrm{LLF}}(u_L, u_R), \\quad F_{RL} = F_{\\mathrm{LLF}}(u_R, u_L).\n$$\nThe periodic two-cell update is\n$$\nu_L^{\\mathrm{new}} = u_L - \\frac{\\Delta t}{\\Delta x}\\left(F_{LR} - F_{RL}\\right), \\quad\nu_R^{\\mathrm{new}} = u_R - \\frac{\\Delta t}{\\Delta x}\\left(F_{RL} - F_{LR}\\right).\n$$\n\nTo enforce positivity of density and pressure after the update, apply a positivity-preserving limiter by convexly blending each candidate updated state $u^{\\mathrm{new}}$ with its original admissible state $u^{\\mathrm{safe}}$ (the pre-update state) as\n$$\nu^{\\mathrm{lim}}(\\theta) = \\theta\\, u^{\\mathrm{new}} + (1 - \\theta)\\, u^{\\mathrm{safe}}, \\quad \\theta \\in [0,1],\n$$\nand choose the largest $\\theta$ that satisfies $\\rho^{\\mathrm{lim}}(\\theta) \\ge \\rho_{\\min}$ and $p^{\\mathrm{lim}}(\\theta) \\ge p_{\\min}$ for given floors $\\rho_{\\min} > 0$ and $p_{\\min} > 0$. The limited states in the two cells are $u_L^{\\mathrm{lim}}$ and $u_R^{\\mathrm{lim}}$ obtained by this procedure.\n\nDefine the \"entropy increase violation\" as the event where the sum of the mathematical entropies across the two cells increases after applying the positivity limiter, that is, where\n$$\n\\eta(u_L^{\\mathrm{lim}}) + \\eta(u_R^{\\mathrm{lim}}) > \\eta(u_L) + \\eta(u_R).\n$$\nIn this setting, investigate the compatibility of the positivity-preserving limiter with the entropy-stable LLF flux and identify scenarios where limiter-induced overshoots cause an increase in the total mathematical entropy.\n\nYour task is to implement a program that, for each test case provided below, performs the following steps:\n- Converts the given primitive variables $(\\rho, u, p)$ to conservative variables $u$.\n- Computes the LLF flux in both argument orders at the shared interface and updates the two cells with the periodic two-cell scheme above.\n- Applies the positivity-preserving limiter with given floors $\\rho_{\\min}$ and $p_{\\min}$ by selecting the largest $\\theta \\in [0,1]$ that enforces the constraints in each cell.\n- Computes the sum of the mathematical entropies before and after the limited update.\n- Returns a boolean indicating whether the total mathematical entropy has increased due to the limited update.\n\nAll quantities are dimensionless. Use the following test suite; each test case is specified by $(\\gamma,\\; \\Delta t,\\; \\Delta x,\\; \\rho_L,\\; u_L,\\; p_L,\\; \\rho_R,\\; u_R,\\; p_R,\\; \\rho_{\\min},\\; p_{\\min})$:\n- Case 1 (baseline smooth states): $(1.4,\\; 0.1,\\; 1.0,\\; 1.0,\\; 0.0,\\; 1.0,\\; 0.9,\\; 0.1,\\; 1.1,\\; 10^{-10},\\; 10^{-10})$.\n- Case 2 (strong jump with potential overshoot): $(1.4,\\; 1.0,\\; 1.0,\\; 0.2,\\; 5.0,\\; 0.01,\\; 1.0,\\; -2.0,\\; 2.0,\\; 10^{-12},\\; 10^{-12})$.\n- Case 3 (shock-like contrast): $(1.4,\\; 0.5,\\; 1.0,\\; 1.0,\\; 3.0,\\; 0.5,\\; 4.0,\\; 0.0,\\; 2.0,\\; 10^{-12},\\; 10^{-12})$.\n- Case 4 (near-vacuum on one side): $(1.4,\\; 0.7,\\; 1.0,\\; 10^{-3},\\; 0.0,\\; 10^{-5},\\; 1.0,\\; 0.0,\\; 1.0,\\; 10^{-12},\\; 10^{-12})$.\n- Case 5 (counter-propagating high Mach): $(1.4,\\; 0.3,\\; 1.0,\\; 0.5,\\; 10.0,\\; 0.1,\\; 0.5,\\; -10.0,\\; 0.1,\\; 10^{-12},\\; 10^{-12})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is a boolean (True or False) indicating whether the total mathematical entropy increased after applying the positivity limiter for that test case.",
            "solution": "The task is to determine if a positivity-preserving limiter, when applied to an entropy-stable numerical scheme, can lead to an increase in the total mathematical entropy of a simple two-cell periodic system. The solution involves a direct simulation of the described process for a set of test cases. The core of the analysis lies in the potential incompatibility between the local, state-wise positivity enforcement and the global, system-wide entropy dissipation property. The entropy function is convex, and while the flux is entropy-stable and the limiter is a convex combination, the fact that the limiter coefficient $\\theta$ can differ between cells ($\\theta_L \\ne \\theta_R$) breaks the simple argument that would guarantee entropy stability of the combined scheme.\n\nThe computational procedure is implemented as follows:\n\n1.  **State Conversion**: The initial states are provided in primitive variables $(\\rho, u, p)$, where $\\rho$ is density, $u$ is velocity, and $p$ is pressure. These are converted to the vector of conservative variables $u = [\\rho, m, E]^T$, where $m = \\rho u$ is the momentum and $E$ is the total energy per unit volume. The conversion for total energy is based on the ideal gas equation of state:\n    $$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2 = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\frac{m^2}{\\rho}$$\n\n2.  **Semi-Discrete Update**: The problem describes a two-cell periodic system, which serves as a minimal model for analyzing the interaction at a single cell interface. The forward Euler time update for the states $u_L$ and $u_R$ is given by:\n    $$\n    u_L^{\\mathrm{new}} = u_L - \\frac{\\Delta t}{\\Delta x}\\left(F_{LR} - F_{RL}\\right) \\\\\n    u_R^{\\mathrm{new}} = u_R - \\frac{\\Delta t}{\\Delta x}\\left(F_{RL} - F_{LR}\\right)\n    $$\n    where $F_{LR} = F_{\\mathrm{LLF}}(u_L, u_R)$ and $F_{RL} = F_{\\mathrm{LLF}}(u_R, u_L)$ are the Local Lax-Friedrichs (LLF) numerical fluxes. The LLF flux is defined as:\n    $$\n    F_{\\mathrm{LLF}}(u_L, u_R) = \\frac{1}{2}\\left(f(u_L) + f(u_R)\\right) - \\frac{1}{2}\\alpha(u_L, u_R)\\left(u_R - u_L\\right)\n    $$\n    The stabilization parameter $\\alpha(u_L, u_R)$ is symmetric, i.e., $\\alpha(u_L, u_R) = \\alpha(u_R, u_L)$. This leads to a significant simplification of the update terms:\n    $$\n    F_{LR} - F_{RL} = -\\alpha(u_L, u_R)(u_R - u_L)\n    $$\n    Thus, the updates for the candidate states $u_L^{\\mathrm{new}}$ and $u_R^{\\mathrm{new}}$ become:\n    $$\n    u_L^{\\mathrm{new}} = u_L + \\frac{\\Delta t}{\\Delta x}\\alpha(u_L, u_R)(u_R - u_L) \\\\\n    u_R^{\\mathrm{new}} = u_R - \\frac{\\Delta t}{\\Delta x}\\alpha(u_L, u_R)(u_R - u_L)\n    $$\n    The wave speed $\\alpha$ is computed as $\\alpha(u_L, u_R) = \\max(|u_L| + c_L, |u_R| + c_R)$, where $u$ is the fluid velocity and $c = \\sqrt{\\gamma p / \\rho}$ is the speed of sound, all derived from the primitive variables corresponding to states $u_L$ and $u_R$.\n\n3.  **Positivity-Preserving Limiter**: The candidate states $u^{\\mathrm{new}}$ may violate the physical admissibility constraints $\\rho > 0$ and $p > 0$. To enforce these, a positivity-preserving limiter is applied. For each cell, we find the largest blending factor $\\theta \\in [0, 1]$ such that the limited state $u^{\\mathrm{lim}}(\\theta) = \\theta u^{\\mathrm{new}} + (1 - \\theta) u^{\\mathrm{safe}}$ is admissible. Here, $u^{\\mathrm{safe}}$ is the state before the update, which is assumed to be admissible.\n    The constraints are $\\rho^{\\mathrm{lim}}(\\theta) \\ge \\rho_{\\min}$ and $p^{\\mathrm{lim}}(\\theta) \\ge p_{\\min}$ for small positive floors $\\rho_{\\min}$ and $p_{\\min}$.\n\n    *   **Density Constraint**: $\\rho^{\\mathrm{lim}}(\\theta) = \\theta \\rho^{\\mathrm{new}} + (1 - \\theta) \\rho^{\\mathrm{safe}} \\ge \\rho_{\\min}$. This is a linear inequality in $\\theta$. If $\\rho^{\\mathrm{new}} < \\rho_{\\min}$, it yields an upper bound $\\theta \\le \\theta_{\\rho} = (\\rho_{\\min} - \\rho^{\\mathrm{safe}})/(\\rho^{\\mathrm{new}} - \\rho^{\\mathrm{safe}})$. Otherwise, any $\\theta \\in [0,1]$ is valid for the density constraint.\n\n    *   **Pressure Constraint**: $p^{\\mathrm{lim}}(\\theta) = (\\gamma-1)(E^{\\mathrm{lim}}(\\theta) - \\frac{1}{2}\\frac{(m^{\\mathrm{lim}}(\\theta))^2}{\\rho^{\\mathrm{lim}}(\\theta)}) \\ge p_{\\min}$. Substituting the linear expressions for $\\rho^{\\mathrm{lim}}$, $m^{\\mathrm{lim}}$, and $E^{\\mathrm{lim}}$ results in a quadratic inequality for $\\theta$ of the form $A\\theta^2 + B\\theta + C \\ge 0$. The coefficients $A, B, C$ are functions of the safe and new states, as well as $\\gamma$ and $p_{\\min}$. If the new state $u^{\\mathrm{new}}$ is already pressure-positive, no blending is needed for this constraint. Otherwise, we solve the quadratic equation $A\\theta^2 + B\\theta + C = 0$ for its roots. Since the safe state is admissible ($p^{\\mathrm{safe}} > p_{\\min}$) and the new state is not ($p^{\\mathrm{new}} < p_{\\min}$), there must be a single root in the interval $(0, 1)$, which provides the upper bound $\\theta_p$. The `numpy.roots` function is employed to robustly find these roots.\n\n    The final blending factor for each cell is $\\theta = \\min(1.0, \\theta_{\\rho}, \\theta_{p})$. This procedure is performed independently for cell $L$ and cell $R$ to find $\\theta_L$ and $\\theta_R$, and then the corresponding limited states $u_L^{\\mathrm{lim}}$ and $u_R^{\\mathrm{lim}}$.\n\n4.  **Entropy Violation Check**: The mathematical entropy for a state $u$ is $\\eta(u) = -\\frac{\\rho s}{\\gamma - 1}$, with the specific physical entropy $s = \\ln(p) - \\gamma \\ln(\\rho)$. The total initial entropy is $\\Sigma \\eta_{\\mathrm{initial}} = \\eta(u_L) + \\eta(u_R)$. The total final entropy, after the limited update, is $\\Sigma \\eta_{\\mathrm{final}} = \\eta(u_L^{\\mathrm{lim}}) + \\eta(u_R^{\\mathrm{lim}})$. The \"entropy increase violation\" occurs if $\\Sigma \\eta_{\\mathrm{final}} > \\Sigma \\eta_{\\mathrm{initial}}$. A boolean value is returned for each test case indicating whether this violation was observed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases.\n    \"\"\"\n    test_cases = [\n        # (gamma, dt, dx, rho_L, u_L, p_L, rho_R, u_R, p_R, rho_min, p_min)\n        (1.4, 0.1, 1.0, 1.0, 0.0, 1.0, 0.9, 0.1, 1.1, 1e-10, 1e-10),\n        (1.4, 1.0, 1.0, 0.2, 5.0, 0.01, 1.0, -2.0, 2.0, 1e-12, 1e-12),\n        (1.4, 0.5, 1.0, 1.0, 3.0, 0.5, 4.0, 0.0, 2.0, 1e-12, 1e-12),\n        (1.4, 0.7, 1.0, 1e-3, 0.0, 1e-5, 1.0, 0.0, 1.0, 1e-12, 1e-12),\n        (1.4, 0.3, 1.0, 0.5, 10.0, 0.1, 0.5, -10.0, 0.1, 1e-12, 1e-12),\n    ]\n\n    results = []\n    for case in test_cases:\n        violation = run_simulation(*case)\n        results.append(violation)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(gamma, dt, dx, rho_L, v_L, p_L, rho_R, v_R, p_R, rho_min, p_min):\n    \"\"\"\n    Runs the simulation for a single test case.\n    \"\"\"\n    # 1. Convert primitive to conservative variables\n    uL_safe = prim_to_cons(rho_L, v_L, p_L, gamma)\n    uR_safe = prim_to_cons(rho_R, v_R, p_R, gamma)\n\n    # 2. Calculate initial total entropy\n    eta_initial = entropy_function(uL_safe, gamma) + entropy_function(uR_safe, gamma)\n\n    # 3. Compute LLF wave speed\n    cL = np.sqrt(gamma * p_L / rho_L)\n    cR = np.sqrt(gamma * p_R / rho_R)\n    alpha = max(abs(v_L) + cL, abs(v_R) + cR)\n    \n    # 4. Compute candidate updated states\n    diff_u = uR_safe - uL_safe\n    uL_new = uL_safe + (dt / dx) * alpha * diff_u\n    uR_new = uR_safe - (dt / dx) * alpha * diff_u\n\n    # 5. Apply positivity-preserving limiter\n    theta_L = find_limiter_theta(uL_new, uL_safe, gamma, rho_min, p_min)\n    uL_lim = theta_L * uL_new + (1 - theta_L) * uL_safe\n\n    theta_R = find_limiter_theta(uR_new, uR_safe, gamma, rho_min, p_min)\n    uR_lim = theta_R * uR_new + (1 - theta_R) * uR_safe\n    \n    # 6. Calculate final total entropy\n    eta_final = entropy_function(uL_lim, gamma) + entropy_function(uR_lim, gamma)\n    \n    # 7. Check for entropy violation\n    return eta_final > eta_initial\n\ndef prim_to_cons(rho, v, p, gamma):\n    \"\"\"Converts primitive variables (rho, v, p) to conservative vector u.\"\"\"\n    m = rho * v\n    E = p / (gamma - 1) + 0.5 * rho * v**2\n    return np.array([rho, m, E])\n\ndef get_pressure(u, gamma):\n    \"\"\"Computes pressure from the conservative state vector.\"\"\"\n    rho, m, E = u\n    if rho <= 0:\n        return -1.0\n    p = (gamma - 1) * (E - 0.5 * m**2 / rho)\n    return p\n\ndef entropy_function(u, gamma):\n    \"\"\"Computes the mathematical entropy eta(u).\"\"\"\n    rho, m, E = u\n    p = get_pressure(u, gamma)\n    if rho <= 0 or p <= 0:\n        # Invalid state, return a large number to signify error\n        return np.inf\n    s = np.log(p) - gamma * np.log(rho)\n    eta = -rho * s / (gamma - 1)\n    return eta\n\ndef find_limiter_theta(u_new, u_safe, gamma, rho_min, p_min):\n    \"\"\"\n    Finds the largest theta in [0, 1] for the positivity-preserving limiter.\n    \"\"\"\n    rho_new, m_new, E_new = u_new\n    rho_safe, m_safe, E_safe = u_safe\n    \n    # --- Density constraint ---\n    theta_rho = 1.0\n    if rho_new < rho_min:\n        # Since rho_safe >= rho_min, rho_new - rho_safe is negative.\n        # This check avoids division by zero if rho_new is somehow equal to rho_safe.\n        if rho_new - rho_safe < -1e-14:\n            theta_rho = (rho_min - rho_safe) / (rho_new - rho_safe)\n        else: # Cannot satisfy constraint if rho_new < rho_min and rho_new >= rho_safe\n            return 0.0\n\n    # --- Pressure constraint ---\n    p_new = get_pressure(u_new, gamma)\n    theta_p = 1.0\n    if p_new < p_min:\n        d_rho = rho_new - rho_safe\n        d_m = m_new - m_safe\n        d_E = E_new - E_safe\n        \n        # Coefficients of the quadratic A*theta^2 + B*theta + C >= 0\n        A = 2 * d_rho * d_E - d_m**2\n        B = 2 * (rho_safe * d_E + E_safe * d_rho) - 2 * m_safe * d_m - (2 * p_min / (gamma - 1)) * d_rho\n        C = 2 * rho_safe * E_safe - m_safe**2 - (2 * p_min / (gamma - 1)) * rho_safe\n\n        # C is guaranteed to be >= 0 because p_safe >= p_min\n        if C < 0: C = 0\n\n        # Find the smallest positive real root of the quadratic.\n        # This root is the upper bound on theta for pressure positivity.\n        if abs(A) < 1e-14:  # Linear case\n            if abs(B) > 1e-14:\n                root = -C / B\n                # If root > 0, it's our candidate theta_p\n                # If root <= 0, and we need to limit, no positive theta will solve it\n                theta_p = root if root > 1e-14 else 0.0\n            else: # B=0, C >= 0, constraint is always satified or never\n                theta_p = 1.0 if C >= 0 else 0.0\n        else:  # Quadratic case\n            roots = np.roots([A, B, C])\n            pos_real_roots = sorted([r.real for r in roots if abs(r.imag) < 1e-14 and r.real > 1e-14])\n            if pos_real_roots:\n                # Theory guarantees a root in (0,1) when p_new < p_min\n                theta_p = pos_real_roots[0]\n            else:\n                # Failsafe: if no positive roots, means parabola is always positive (since C>=0),\n                # which contradicts p_new < p_min. Something is numerically unstable.\n                # Reverting fully is the safest option.\n                theta_p = 0.0\n\n    # The final theta is the minimum of the bounds, clipped to [0, 1]\n    return min(1.0, max(0.0, theta_rho), max(0.0, theta_p))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}