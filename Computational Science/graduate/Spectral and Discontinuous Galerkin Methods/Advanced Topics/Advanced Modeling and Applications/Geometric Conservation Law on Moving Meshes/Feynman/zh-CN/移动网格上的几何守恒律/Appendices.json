{
    "hands_on_practices": [
        {
            "introduction": "为了使离散几何守恒律（GCL）精确成立，网格几何的多项式表示相对于求解的复杂程度不能是任意的。本练习旨在通过分析谱微分算子如何作用于不同阶数的多项式，引导您发现这一基本关系。这个练习揭示了在保证守恒性时，单元映射的阶数（$p_{m}$）和解的阶数（$p$）之间必须满足的约束条件。",
            "id": "3389214",
            "problem": "考虑一个一维任意拉格朗日-欧拉(ALE)映射 $x(\\xi,t)$，它将参考单元 $\\xi \\in [-1,1]$ 映射到物理单元。在每个单元上，$x(\\xi,t)$ 由一个关于 $\\xi$ 的 $p_{m}$ 次多项式表示，该次数可以因单元而异。解通过间断伽辽金(DG)谱元法进行离散化，该方法在勒让德-高斯-洛巴托(LGL)节点上使用 $p$ 次拉格朗日插值多项式，并在相同节点上进行配置求积。关于 $\\xi$ 的微分由与 $p$ 次LGL基相关的节点微分矩阵 $D_{p}$ 执行，该矩阵对次数至多为 $p$ 的任何多项式都能精确再现其导数。体积分使用LGL求积，该求积方法对次数最高为 $2p-1$ 的多项式是精确的。几何项通过使用相同的算子 $D_{p}$ 对插值函数 $x(\\xi,t)$ 进行微分来计算，因此雅可比 $J(\\xi,t)$ 和网格速度 $w(\\xi,t)$ 近似为 $J \\approx D_{p} x$ 和 $w \\approx \\partial x/\\partial t$，它们的 $\\xi$ 导数则近似为 $D_{p} J$ 和 $D_{p} w$。\n\n一维连续几何守恒律(GCL)要求，在网格运动下，通过在连续层面上强制执行恒等式 $\\partial J/\\partial t = \\partial w/\\partial \\xi$，来保持均匀自由流。在上述离散DG配置格式中，如果对于任何空间常数场，当离散几何恒等式 $D_{p} w = \\partial J/\\partial t$ 在离散弱形式中使用并通过LGL求积进行积分时，DG残差精确为零，则称离散GCL在该单元上成立。\n\n假设 $x(\\xi,t)$ 是一个关于 $\\xi$ 的 $p_{m}$ 次多项式，因此 $J(\\xi,t) = \\partial x/\\partial \\xi$ 是 $p_{m}-1$ 次多项式，$w(\\xi,t) = \\partial x/\\partial t$ 是关于 $\\xi$ 的 $p_{m}$ 次多项式。在所述的DG配置和度量计算过程下，确定使得离散GCL在每个单元上都精确成立的最大映射多项式次数 $p_{m}$（表示为 $p$ 的函数），无论网格间的 $p_{m}$ 是否非均匀。请以单个闭式符号表达式 $p_{m}^{\\max}(p)$ 的形式提供最终答案，不带单位，也不加任何限定词。",
            "solution": "该问题要求确定一维多项式坐标映射 $x(\\xi,t)$ 的最大次数 $p_m$，在此次数下，离散几何守恒律(GCL)在间断伽辽金(DG)谱元框架中精确满足。\n\n让我们首先将离散GCL成立的条件形式化。在参考单元 $\\xi \\in [-1, 1]$ 上的任意拉格朗日-欧拉(ALE)框架中，一个普遍的守恒律可以表示为：\n$$\n\\frac{\\partial (Ju)}{\\partial t} + \\frac{\\partial (F(u) - wu)}{\\partial \\xi} = 0\n$$\n其中 $u$ 是守恒变量，$F(u)$ 是参考系中的物理通量，$J(\\xi,t) = \\partial x/\\partial \\xi$ 是映射 $x(\\xi,t)$ 的雅可比，$w(\\xi,t) = \\partial x/\\partial t$ 是网格速度。\n\nGCL是关于保持常数状态（或均匀流）的陈述。假设解在空间上是常数，$u(\\xi,t) = U_0$，其中 $U_0$ 可能依赖于时间。物理通量 $F(U_0)$ 在空间上也是常数。守恒律简化为：\n$$\n\\frac{\\partial (J U_0)}{\\partial t} - \\frac{\\partial (w U_0)}{\\partial \\xi} = 0\n$$\n展开导数项，我们得到：\n$$\nJ \\frac{\\partial U_0}{\\partial t} + U_0 \\frac{\\partial J}{\\partial t} - w \\frac{\\partial U_0}{\\partial \\xi} - U_0 \\frac{\\partial w}{\\partial \\xi} = 0\n$$\n由于 $U_0$ 在空间上是常数，所以 $\\partial U_0 / \\partial \\xi = 0$。如果我们考虑一个定常自由流，其中 $U_0$ 在时间上也是常数，则方程简化为：\n$$\nU_0 \\left( \\frac{\\partial J}{\\partial t} - \\frac{\\partial w}{\\partial \\xi} \\right) = 0\n$$\n这表明连续GCL，即 $\\partial J/\\partial t = \\partial w/\\partial \\xi$，是保持常数状态所需的条件。\n\n在指定的DG格式中，解由属于空间 $P_p(\\xi)$ 的一个 $p$ 次多项式 $u_h(\\xi,t)$ 表示。守恒律的弱形式是通过乘以一个检验函数 $\\phi_h \\in P_p(\\xi)$ 并在单元上积分来创建的。对于常数状态 $u_h = U_0$，DG残差的体积分部分必须为零才能使GCL成立，该部分正比于：\n$$\nR_{vol} = \\int_{-1}^{1} \\phi_h(\\xi) \\left( \\frac{\\partial J_h}{\\partial t} - \\frac{\\partial w_h}{\\partial \\xi} \\right) d\\xi = 0\n$$\n其中 $J_h$ 和 $w_h$ 分别是多项式空间 $P_p(\\xi)$ 内雅可比和网格速度的离散近似。\n\n这个积分可以通过分部积分重写为：\n$$\n\\int_{-1}^{1} \\left( \\phi_h(\\xi) \\frac{\\partial J_h}{\\partial t} + \\frac{\\partial \\phi_h(\\xi)}{\\partial \\xi} w_h(\\xi) \\right) d\\xi - \\left[ \\phi_h(\\xi) w_h(\\xi) \\right]_{-1}^{1} = 0\n$$\n在完整的DG格式中，边界项由数值通量处理。GCL是关于体积分的一个条件。因此，我们要求积分项为零。\n问题陈述该积分是使用具有 $p+1$ 个节点 $\\{\\xi_k\\}_{k=0}^p$ 的勒让德-高斯-洛巴托(LGL)求积来计算的。使用LGL配置的DG方法的一个关键性质是，要求弱形式残差为零等价于方程的强形式在配置节点上得到满足。这是因为质量矩阵是对角的（“集总的”），并且我们可以选择检验函数 $\\phi_h$ 为拉格朗日基多项式 $l_j(\\xi)$，它满足 $l_j(\\xi_k) = \\delta_{jk}$。因此，GCL成立当且仅当强形式的被积函数在每个节点处为零：\n$$\n\\left( \\frac{\\partial J_h}{\\partial t} \\right)(\\xi_k) - \\left( \\frac{\\partial w_h}{\\partial \\xi} \\right)(\\xi_k) = 0 \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n\n现在，我们必须根据问题描述来定义离散量 $J_h$ 和 $w_h$。真实映射 $x(\\xi,t)$ 是一个 $p_m$ 次多项式。真实雅可比 $J = \\partial x/\\partial\\xi$ 是一个 $p_m-1$ 次多项式，真实网格速度 $w = \\partial x/\\partial t$ 是一个 $p_m$ 次多项式。\n\n离散场 $J_h$ 和 $w_h$ 是在 $p+1$ 个LGL节点上插值真实场的、次数最多为 $p$ 的唯一多项式。我们用 $I_p[\\cdot]$ 表示这个插值算子。因此，$J_h = I_p[J]$ 且 $w_h = I_p[w]$。\n\n我们来计算节点GCL条件中的两项：\n1.  时间导数项：离散表示 $J_h$ 由其节点值定义，这些节点值是真实雅可比 $J$ 的节点值。因此，$(\\partial J_h/\\partial t)(\\xi_k) = d/dt (J_h(\\xi_k,t)) = d/dt(J(\\xi_k,t)) = (\\partial J/\\partial t)(\\xi_k,t)$。根据 $J$ 和 $w$ 的定义以及光滑映射 $x(\\xi,t)$ 的混合偏导数相等性，我们有 $\\partial J/\\partial t = \\partial/\\partial t(\\partial x/\\partial\\xi) = \\partial/\\partial\\xi(\\partial x/\\partial t) = \\partial w/\\partial\\xi$。所以，第一项是真实网格速度的精确导数，即 $(\\partial w/\\partial\\xi)(\\xi_k,t)$。\n\n2.  空间导数项：该项是离散网格速度 $w_h = I_p[w]$ 在节点处的导数。根据问题陈述，微分由节点微分矩阵 $D_p$ 执行。该矩阵应用于函数的节点值向量时，可以得到函数导数的精确节点值，前提是该函数是次数至多为 $p$ 的多项式。这里，函数是 $w_h$，它是一个次数至多为 $p$ 的多项式。其在节点处的导数 $(\\partial w_h/\\partial\\xi)$ 是通过将 $D_p$ 应用于 $w_h$ 的节点值来精确计算的。$w_h$ 的节点值就是真实速度 $w$ 的节点值。令 $\\mathbf{w}_{nodes}$ 为向量 $[w(\\xi_0,t), \\dots, w(\\xi_p,t)]^T$。那么 $(\\partial w_h/\\partial\\xi)(\\xi_k) = (D_p \\mathbf{w}_{nodes})_k$。\n\n将这些代入节点GCL条件，我们得到：\n$$\n\\left( \\frac{\\partial w}{\\partial \\xi} \\right)(\\xi_k) = (D_p \\mathbf{w}_{nodes})_k \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n该方程表明，真实网格速度 $w$ 导数的精确节点值必须等于由谱微分矩阵 $D_p$ 计算出的导数的节点值。\n\n问题明确指出矩阵 $D_p$ “对次数至多为 $p$ 的任何多项式都能精确再现其导数”。因此，对于任意多项式 $w$，上述等式成立当且仅当 $w$ 的次数不大于 $p$。\n\n根据题意，$x(\\xi,t)$ 是一个关于 $\\xi$ 的 $p_m$ 次多项式。因此，网格速度 $w(\\xi,t) = \\partial x/\\partial t$ 也是一个关于 $\\xi$ 的 $p_m$ 次多项式。\n为了使GCL精确满足，我们必须有：\n$$\n\\text{degree}(w) \\le p\n$$\n这意味着：\n$$\np_m \\le p\n$$\n因此，使得离散GCL精确成立的最大映射多项式次数 $p_m$ 为 $p$。该结果与其他单元上的 $p_m$ 值无关，因为GCL是一个单元内性质。关于LGL求积对次数最高为 $2p-1$ 的多项式是精确的这一信息，确保了用于将弱形式局部化到节点的“分部求和”性质对次数为 $p$ 的离散多项式是有效的。\n\n因此，最大次数为 $p_m^{\\max}(p) = p$。",
            "answer": "$$\n\\boxed{p}\n$$"
        },
        {
            "introduction": "当第一个练习中的理想条件不被满足，或由于其他数值效应时，离散 GCL 可能会被违反。本练习介绍了一个强大的工具——单元 GCL 残差——来量化这种违反程度。您将从第一性原理出发推导这个诊断量，并将其应用于一个具体例子，从而理解它如何作为网格运动质量的检查标准。",
            "id": "3389201",
            "problem": "考虑一个从一维参考单元到物理直线的时变映射，由 $x(\\xi,t)$ 定义，其中 $\\xi \\in [-1,1]$。令 $J(\\xi,t)$ 表示此映射的雅可比行列式，且 $J(\\xi,t)=\\partial_{\\xi}x(\\xi,t)$。假设网格运动由一个逆变网格速度通量 $w(\\xi,t)$ 表征，该通量与在网格运动下保持均匀解的特性相一致。连续几何守恒律 (GCL) 保证了度量演化与网格运动的相容性，从而使得守恒数值方法能够维持自由流解。\n\n仅从一维变量替换恒等式和标准微积分（莱布尼茨法则和链式法则）出发，推导一个离散的、单元层面的残差诊断式，用以量化多项式谱元上 GCL 的违背程度。该推导必须从移动控制体积上的守恒弱形式出发，并应用与勒让德-高斯-洛巴托 (LGL) 求积及其配置点导数矩阵相关的分部求和 (SBP) 性质。该诊断式必须能够表示为单元内一个逐点残差向量的范数。\n\n然后，对于一个具有 LGL 节点 $\\xi_0=-1$, $\\xi_1=0$, $\\xi_2=1$，LGL 求积权重 $w_0=\\frac{1}{3}$, $w_1=\\frac{4}{3}$, $w_2=\\frac{1}{3}$，以及 LGL 一阶导数配置点矩阵\n$$\nD=\\begin{pmatrix}\n- \\frac{3}{2}  2  - \\frac{1}{2}\\\\\n- \\frac{1}{2}  0  \\frac{1}{2}\\\\\n\\frac{1}{2}  -2  \\frac{3}{2}\n\\end{pmatrix},\n$$\n的多项式映射\n$$\nx(\\xi,t)=a(t)+b(t)\\,\\xi+c(t)\\,\\xi^{2},\n$$\n其中 $a'(t)=0$, $b(t)=1+t$ 且 $c(t)=t$，并在时间 $t=1$ 处进行计算。通过 $w(\\xi,t)=-\\partial_t x(\\xi,t)$ 定义与网格运动一致的网格速度通量，并在节点配置点上近似所有量（即，将 $J_h$ 和 $w_h$ 设置为它们在 LGL 节点上的精确节点值）。使用您推导的诊断式，计算该单元的单元层面残差 $r_K$。将 $r_K$ 表示为一个实数。无需四舍五入。\n\n最后，在方法设计的层面上，解释如何使用这样一个单元层面残差诊断式来调整网格运动求解器中的参数，从而在谱方法或间断伽辽金 (DG) 方法中，将离散 GCL 强制约束在预设的容差范围内。",
            "solution": "该问题要求分三部分作答：首先，推导谱元的离散几何守恒律 (GCL) 残差诊断式；其次，针对一个具体案例计算该残差；第三，解释其在自适应网格运动求解器中的应用。对问题陈述的验证证实了其科学上的合理性和适定性。所提供的勒让德-高斯-洛巴托 (LGL) 格式的数值数据与分部求和 (SBP) 性质一致，而后者是所要求推导的基石。\n\n### 第一部分：GCL 残差诊断式的推导\n\n几何守恒律 (GCL) 为移动网格上的数值格式保持恒定解（自由流）建立了一个必要条件。它将控制体测度的变化率与其边界的速度联系起来。\n\n我们从一个移动单元 $K(t) = [x(\\xi=-1,t), x(\\xi=1,t)]$ 上，从物理坐标 $x$到参考坐标 $\\xi \\in [-1, 1]$ 的变量替换基本恒等式开始：\n$$ \\frac{d}{dt} \\int_{K(t)} dx = \\frac{d}{dt} \\int_{-1}^{1} J(\\xi, t) d\\xi $$\n其中 $J(\\xi,t) = \\partial_{\\xi} x(\\xi, t)$ 是映射 $x(\\xi, t)$ 的雅可比行列式。\n\n左侧代表单元长度的变化率。令 $\\dot{x}(\\xi, t) = \\partial_t x(\\xi, t)$ 为网格速度。根据莱布尼茨积分法则，\n$$ \\frac{d}{dt} \\int_{x(-1,t)}^{x(1,t)} dx = \\dot{x}(1, t) - \\dot{x}(-1, t) $$\n右侧，通过将导数移入积分内部，得到：\n$$ \\frac{d}{dt} \\int_{-1}^{1} J(\\xi, t) d\\xi = \\int_{-1}^{1} \\partial_t J(\\xi, t) d\\xi $$\n令两式相等，得到 GCL 的积分形式：\n$$ \\int_{-1}^{1} \\partial_t J(\\xi, t) d\\xi = \\dot{x}(1, t) - \\dot{x}(-1, t) $$\n使用微积分基本定理，右侧可以写成一个积分：$[\\dot{x}]_{\\xi=-1}^{\\xi=1} = \\int_{-1}^{1} \\partial_{\\xi} \\dot{x}(\\xi, t) d\\xi$。这导出：\n$$ \\int_{-1}^{1} \\left( \\partial_t J - \\partial_{\\xi} \\dot{x} \\right) d\\xi = 0 $$\n由于这对任意单元映射都成立，被积函数必须为零，从而得到 GCL 的强形式：\n$$ \\partial_t J - \\partial_{\\xi} \\dot{x} = 0 $$\n问题定义了一个逆变网格速度通量 $w(\\xi, t) = -\\partial_t x(\\xi, t) = -\\dot{x}(\\xi, t)$。将其代入 GCL 强形式，得到我们将要离散化的控制方程：\n$$ \\partial_t J + \\partial_{\\xi} w = 0 $$\n在使用 LGL 节点 $\\{\\xi_i\\}_{i=0}^{N}$ 的基于配置点的谱元方法中，我们用节点值的向量来表示连续函数。令向量 $\\mathbf{J}(t)$ 和 $\\mathbf{w}(t)$ 分别为 $J(\\xi, t)$ 和 $w(\\xi, t)$ 的节点值向量。时间导数逐点应用于节点值，得到向量 $\\frac{d\\mathbf{J}}{dt}$。空间导数 $\\partial_{\\xi} w$ 通过应用 LGL 一阶导数配置点矩阵 $D$ 在节点上进行近似。因此，节点上 GCL 的离散形式为：\n$$ \\frac{d\\mathbf{J}}{dt} + D\\mathbf{w} \\approx \\mathbf{0} $$\n此等式不被满足的程度构成了离散 GCL 违背。我们定义节点 GCL 残差向量 $\\mathbf{r}$ 为：\n$$ \\mathbf{r} = \\frac{d\\mathbf{J}}{dt} + D\\mathbf{w} $$\n整个单元 $K$ 的单个标量诊断式 $r_K$ 是通过计算该残差向量的范数得到的。一个自然的选择是离散 $L_2$ 范数，由 LGL 求积权重 $w_i$ 加权，这模拟了连续 $L_2$ 积分范数。令 $M$ 为对角质量矩阵，其元素为 $M_{ii} = w_i$。加权范数为：\n$$ r_K = \\| \\mathbf{r} \\|_{M} = \\sqrt{\\mathbf{r}^T M \\mathbf{r}} = \\sqrt{\\sum_{i=0}^{N} r_i^2 w_i} $$\n这个标量值 $r_K$ 量化了单元层面的 GCL 违背。算子对 $(D, M)$ 的分部求和 (SBP) 性质，即 $M D + (M D)^T = B$（其中 $B = \\text{diag}(-1, 0, \\dots, 0, 1)$），确保了如果节点残差 $\\mathbf{r}$ 为零，则离散的全局守恒性能得以保持。\n\n### 第二部分：残差的计算\n\n给定一个单元，有 $N+1=3$ 个 LGL 节点，位于 $\\xi_0 = -1$, $\\xi_1 = 0$, $\\xi_2 = 1$。映射为 $x(\\xi,t)=a(t)+b(t)\\xi+c(t)\\xi^{2}$，系数由 $a'(t)=0$, $b(t)=1+t$ 和 $c(t)=t$ 定义。我们在 $t=1$ 时计算所有量。\n\n1.  **节点雅可比向量 $\\mathbf{J}$**：\n    雅可比行列式为 $J(\\xi, t) = \\partial_{\\xi}x = b(t) + 2c(t)\\xi$。在 $t=1$ 时，我们有 $b(1)=2$ 和 $c(1)=1$。\n    所以，$J(\\xi, 1) = 2 + 2\\xi$。\n    在 LGL 节点上求值：\n    $J_0 = J(-1, 1) = 2 + 2(-1) = 0$\n    $J_1 = J(0, 1) = 2 + 2(0) = 2$\n    $J_2 = J(1, 1) = 2 + 2(1) = 4$\n    节点雅可比向量为 $\\mathbf{J}(1) = \\begin{pmatrix} 0  2  4 \\end{pmatrix}^T$。\n\n2.  **节点雅可比时间导数向量 $\\frac{d\\mathbf{J}}{dt}$**：\n    $\\partial_t J(\\xi, t) = \\partial_t (b(t) + 2c(t)\\xi) = b'(t) + 2c'(t)\\xi$。\n    给定的系数导数为 $b'(t) = 1$ 和 $c'(t) = 1$。\n    所以，$\\partial_t J(\\xi, t) = 1 + 2\\xi$。这与 $t$ 无关。\n    在 LGL 节点上求值：\n    $(\\partial_t J)_0 = 1 + 2(-1) = -1$\n    $(\\partial_t J)_1 = 1 + 2(0) = 1$\n    $(\\partial_t J)_2 = 1 + 2(1) = 3$\n    节点时间导数向量为 $\\frac{d\\mathbf{J}}{dt}\\bigg|_{t=1} = \\begin{pmatrix} -1  1  3 \\end{pmatrix}^T$。\n\n3.  **节点网格速度通量向量 $\\mathbf{w}$**：\n    通量定义为 $w(\\xi, t) = -\\partial_t x(\\xi, t)$。\n    $\\partial_t x = a'(t) + b'(t)\\xi + c'(t)\\xi^2$。\n    由于 $a'(t)=0, b'(t)=1, c'(t)=1$，我们有 $\\partial_t x = \\xi + \\xi^2$。\n    因此，$w(\\xi, t) = -(\\xi + \\xi^2)$。这也与 $t$ 无关。\n    在 LGL 节点上求值：\n    $w_0 = w(-1) = -(-1 + (-1)^2) = -( -1 + 1 ) = 0$\n    $w_1 = w(0) = -(0 + 0^2) = 0$\n    $w_2 = w(1) = -(1 + 1^2) = -2$\n    节点通量向量为 $\\mathbf{w}(1) = \\begin{pmatrix} 0  0  -2 \\end{pmatrix}^T$。\n\n4.  **计算节点残差向量 $\\mathbf{r}$**：\n    残差向量为 $\\mathbf{r} = \\frac{d\\mathbf{J}}{dt} + D\\mathbf{w}$。\n    首先，我们计算 $D\\mathbf{w}$：\n    $$ D\\mathbf{w} = \\begin{pmatrix} - \\frac{3}{2}  2  - \\frac{1}{2}\\\\ - \\frac{1}{2}  0  \\frac{1}{2}\\\\ \\frac{1}{2}  -2  \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} (- \\frac{1}{2})(-2) \\\\ (\\frac{1}{2})(-2) \\\\ (\\frac{3}{2})(-2) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\\\ -3 \\end{pmatrix} $$\n    现在，我们计算 $\\mathbf{r}$：\n    $$ \\mathbf{r} = \\frac{d\\mathbf{J}}{dt} + D\\mathbf{w} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 3 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n    节点残差向量恒为零。这是因为所选的多项式映射 $x(\\xi, t)$ 精确满足连续 GCL，即 $\\partial_t J + \\partial_{\\xi} w = (1+2\\xi) + \\partial_{\\xi}(-\\xi-\\xi^2) = (1+2\\xi) + (-1-2\\xi) = 0$。由于谱微分对于所涉及的多项式是精确的，离散残差也精确为零。\n\n5.  **计算单元层面残差 $r_K$**：\n    使用推导的公式和 LGL 权重 $w_0=\\frac{1}{3}$, $w_1=\\frac{4}{3}$, $w_2=\\frac{1}{3}$：\n    $$ r_K = \\sqrt{r_0^2 w_0 + r_1^2 w_1 + r_2^2 w_2} = \\sqrt{0^2 \\cdot \\frac{1}{3} + 0^2 \\cdot \\frac{4}{3} + 0^2 \\cdot \\frac{1}{3}} = 0 $$\n单元层面残差为 $0$。\n\n### 第三部分：GCL 诊断量在自适应方法中的应用\n\n在具有复杂几何和动力学的实际模拟中，网格运动通常通过一个独立的求解器（例如，基于伪弹性或扩散方程）计算。网格运动的数值离散化和物理守恒律不保证完全兼容，这会导致非零的离散 GCL 残差 $\\mathbf{r} \\neq \\mathbf{0}$。这种违背会引入人为的源项或汇项，破坏格式的守恒性并污染物理-解。单元层面残差诊断式 $r_K$ 是控制此误差的关键工具。其在谱方法或间断伽辽金方法的自适应框架中的应用如下：\n\n1.  **误差监控**：在时变模拟中，每次网格更新后（即在每个时间步），都会为计算域中的每个单元 $K$ 计算 GCL 残差 $r_K$。\n\n2.  **误差识别**：将计算出的 $r_K$ 值与用户定义的容差 $\\epsilon_{GCL}$ 进行比较。任何 $r_K > \\epsilon_{GCL}$ 的单元都会被标记为具有不可接受的 GCL 违背水平。\n\n3.  **自适应控制与修正**：被标记的单元集合及其相应的残差大小指导修正措施。目标是调整网格生成过程，以将残差驱动到容差以下。可以采用几种策略：\n    *   **网格求解器参数自适应**：许多网格运动求解器具有可调参数，如网格刚度、人工粘性或松弛因子。这些参数可以在被标记的单元内部或附近进行局部调整。例如，在 GCL 误差高的区域，可以增加网格刚度以抵抗变形，从而平滑雅可比场 $J(\\xi,t)$ 及其时间导数，这通常会减少 GCL 误差。这可以被构建为一个优化问题，通过调整网格参数场来最小化全局 GCL 误差 $\\sum_K r_K^2$。\n    *   **修正子迭代**：GCL 本身可以被视为对网格位置的约束。在一个时间步内，计算出新的试探网格位置后，可以计算 GCL 残差。如果残差过高，可以计算对网格节点位置的修正（例如，通过类牛顿迭代），以专门消除 GCL 残差。这确保在进行物理求解之前，GCL 被满足到机器精度。\n    *   **时间步长细化**：大的 GCL 误差通常表明，对于给定的时间步长 $\\Delta t$，网格变化过快或不够平滑。如果全局 GCL 误差（例如 $\\max_K r_K$）超过某个阈值，模拟可以拒绝当前时间步，并用一个更小的 $\\Delta t$ 重试。更小的时间步长提供了对网格动力学的更好时间分辨率，通常会导致更小的 GCL 误差。\n\n通过将 GCL 残差诊断式集成到控制网格求解器的反馈循环中，可以确保网格运动与整个格式的离散守恒特性保持一致。这种对 GCL 的主动强制对于移动和变形域上模拟的准确性和鲁棒性至关重要，因为它保证了自由流状态的精确保持。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "最后的这个练习将前面的概念综合到一个高层次的算法设计中。您将扮演一名代码开发者的角色，评估将静态网格 DGSEM 代码扩展以处理移动网格的不同策略。目标是识别出一整套能够保证离散 GCL 得以满足的条件——从度量计算到时间积分——从而确保自由流的精确保持。",
            "id": "3389196",
            "problem": "一个现有的间断Galerkin谱元法 (DGSEM) 代码在固定的曲线六面体网格上运行，该代码采用张量积形式的Legendre–Gauss–Lobatto配置、分部求和 (SBP) 微分算子以及分裂形式的两点数值通量，用于求解在固定物理域上以散度形式写出的守恒律。现需通过任意拉格朗日-欧拉 (ALE) 映射将该代码扩展至移动网格。考虑一个在移动物理域中的守恒律，它通过一个光滑、可逆的映射 $\\mathbf{x}(\\boldsymbol{\\xi},t)$ 映射到一个固定的参考域，其雅可比行列式为 $J(\\boldsymbol{\\xi},t)$，对于每个参考坐标 $\\xi_i$，其逆变基矢量由 $J \\mathbf{a}^i(\\boldsymbol{\\xi},t)$ 编码，网格速度为 $\\mathbf{w}(\\boldsymbol{\\xi},t) = \\partial_t \\mathbf{x}(\\boldsymbol{\\xi},t)$。该固定网格代码能够保持常数自由来流状态至机器精度。为了保持自由来流守恒特性，扩展到移动网格的版本必须满足离散几何守恒律。\n\n从第一性原理出发，从物理坐标与参考坐标之间的变量变换、链式法则和守恒形式开始，论证在半离散层面需要什么样的代数结构，才是当用DGSEM进行离散化时，使常数状态在网格运动下随时间保持不变的充分必要条件。特别地，请论证度量项的计算、由网格运动引起的几何通量的处理，以及几何和解的时间更新同步之间所需的耦合关系。\n\n假设数据光滑且算术精确，以下哪个算法清单足以确保扩展后的DGSEM在移动网格上满足离散几何守恒律至机器精度？\n\nA. \n- 步骤 1：将 $\\mathbf{x}(\\boldsymbol{\\xi},t)$ 在与解相同的节点多项式空间中表示。在每个Runge–Kutta阶段，通过使用与体离散化中相同的SBP微分矩阵的离散旋度形式，在所有体和面节点上计算 $J \\mathbf{a}^i$，从而满足离散度量恒等式。通过从阶段几何构造面法线和表面雅可比行列式，并在相邻单元之间共享它们，来强制实施单值的面度量。\n- 步骤 2：通过将物理项和包含网格速度 $\\mathbf{w}$ 的几何项相结合，形成每个坐标方向上的ALE逆变通量，并使用与定常格式相同的分裂形式通量差分和相同的两点对称数值通量对两者进行离散。特别地，在相同的节点上评估几何通量因子 $G^i = J \\mathbf{a}^i \\cdot \\mathbf{w}$，并对通量使用单值的面值。\n- 步骤 3：通过使用与求解相同的Runge–Kutta阶段积分离散几何守恒律 $\\partial_t J + \\sum_i D_i G^i = 0$，或等效地在每个阶段根据阶段几何评估 $J$、$J \\mathbf{a}^i$ 和 $G^i$，来使几何与解的时间积分器协同推进。从相同的阶段几何计算面面积度量和法线。\n- 步骤 4：对几何和解使用相同的求积和插值算子，以便定常代码中调用的SBP恒等式对于移动网格项保持不变。如果使用过积分，则将其一致地应用于物理和几何贡献。\n- 步骤 5：通过初始化一个常数状态和一个随时间变化的光滑映射，并确认机器精度的不变性，来数值验证自由来流守恒性。\n\nB.\n- 步骤 1：在每个时间步的 $t^n$ 时刻，通过直接节点微分和叉积计算一次 $J$ 和 $J \\mathbf{a}^i$，在所有Runge–Kutta阶段内保持它们固定，并只允许网格速度 $\\mathbf{w}$ 在阶段间变化。\n- 步骤 2：对物理通量使用 $2N-1$ 次的体求积，对几何通量使用 $N$ 次的体求积，并在每个单元侧独立计算面几何项。对几何项应用迎风数值通量以增强稳定性。\n- 步骤 3：不求解或强制执行 $J$ 的离散方程；依赖变换后通量中的几何项来解释网格运动，并仅在每个时间步更新一次面度量。\n- 步骤 4：仅验证定常自由来流守恒性；不强制执行移动网格的自由来流守恒性。\n\nC.\n- 步骤 1：在 $t^n$ 时刻使用离散旋度形式计算 $J \\mathbf{a}^i$ 以在初始时满足离散度量恒等式，但在整个时间步内保持这些度量冻结；在每个Runge–Kutta阶段根据阶段几何重新计算 $\\mathbf{w}$。\n- 步骤 2：使用相同的两点数值通量组合物理和几何通量，但将几何量置于Gauss节点上，解置于Legendre–Gauss–Lobatto节点上，在每次评估时通过插值在它们之间传递数据。\n- 步骤 3：通过设置 $J^{n+1} = J^n$ 在步长内保持 $J$ 不变，假设网格映射平均上近似保体积，并且仅在步长结束时更新面面积。\n\nD.\n- 步骤 1：在每个Runge–Kutta阶段，使用相同的微分矩阵通过节点上的直接微分和叉积计算 $J \\mathbf{a}^i$，并通过平均左右重构来强制实施单值的面法线。\n- 步骤 2：为物理项和涉及 $u$ 与网格速度因子 $G^i$ 的几何贡献分别形成中心两点数值通量，并对两者使用相同的节点。\n- 步骤 3：仅在时间步结束时从映射重新计算 $J$，并且不在Runge–Kutta阶段内积分 $J$ 的离散几何守恒律。\n- 步骤 4：仅对物理通量进行过积分以消除混叠，同时将几何通量保持在节点求积以降低成本。\n\n选择正确的选项，并根据ALE映射下的守恒结构和DGSEM中离散几何守恒律的要求来证明你的选择。",
            "solution": "任务是确定一组算法条件，这些条件足以确保间断Galerkin谱元法 (DGSEM) 在移动网格上满足离散几何守恒律 (GCL)，从而保持常数自由来流状态。\n\n### 第一性原理推导\n\n让我们从物理域 $(\\mathbf{x}, t)$ 中的一个一般守恒律开始：\n$$\n\\frac{\\partial u}{\\partial t} + \\nabla_{\\mathbf{x}} \\cdot \\mathbf{f}(u) = 0\n$$\n其中 $u$ 是守恒变量向量，$\\mathbf{f}(u)$ 是物理通量张量。\n\n我们引入一个从固定参考域 $\\boldsymbol{\\xi}$ 到移动物理域 $\\mathbf{x}$ 的任意拉格朗日-欧拉 (ALE) 映射：\n$$\n\\mathbf{x} = \\mathbf{x}(\\boldsymbol{\\xi}, t)\n$$\n网格速度定义为具有固定参考坐标的点的速度：\n$$\n\\mathbf{w}(\\boldsymbol{\\xi}, t) = \\left. \\frac{\\partial \\mathbf{x}}{\\partial t} \\right|_{\\boldsymbol{\\xi}}\n$$\n为了将守恒律变换到参考域，我们需要映射的雅可比行列式 $J = \\det(\\nabla_{\\boldsymbol{\\xi}} \\mathbf{x})$，以及未缩放的逆变基矢量 $\\mathbf{a}^i$，它们是 $(\\nabla_{\\boldsymbol{\\xi}}\\mathbf{x})^{-T}$ 的列向量。问题中使用了缩放后的逆变矢量 $\\mathbf{A}^i = J\\mathbf{a}^i$。\n\n散度项的变换由Piola恒等式给出：\n$$\nJ \\nabla_{\\mathbf{x}} \\cdot \\mathbf{v} = \\nabla_{\\boldsymbol{\\xi}} \\cdot (J (\\nabla_{\\boldsymbol{\\xi}}\\mathbf{x})^{-T} \\mathbf{v}) = \\sum_i \\frac{\\partial}{\\partial \\xi_i} (\\mathbf{A}^i \\cdot \\mathbf{v})\n$$\n将此应用于通量 $\\mathbf{f}(u)$，我们得到变换后的逆变物理通量 $\\tilde{f}_i = \\mathbf{A}^i \\cdot \\mathbf{f}(u)$。\n\n在固定物理坐标和固定参考坐标下的时间导数之间的关系由函数 $\\phi(\\mathbf{x}(\\boldsymbol{\\xi},t), t)$ 的链式法则给出：\n$$\n\\left. \\frac{\\partial \\phi}{\\partial t} \\right|_{\\boldsymbol{\\xi}} = \\left. \\frac{\\partial \\phi}{\\partial t} \\right|_{\\mathbf{x}} + (\\nabla_{\\mathbf{x}}\\phi) \\cdot \\left. \\frac{\\partial \\mathbf{x}}{\\partial t} \\right|_{\\boldsymbol{\\xi}} \\implies \\left. \\frac{\\partial \\phi}{\\partial t} \\right|_{\\mathbf{x}} = \\left. \\frac{\\partial \\phi}{\\partial t} \\right|_{\\boldsymbol{\\xi}} - \\mathbf{w} \\cdot \\nabla_{\\mathbf{x}}\\phi\n$$\n将 $\\partial_t u$ 代入原始偏微分方程并乘以 $J$ 会得到一个非守恒形式。为了在参考域中获得守恒形式，我们从积分形式开始并应用雷诺输运定理，或者等效地，使用连续GCL。GCL将参考单元体积的变化与其边界的运动联系起来：\n$$\n\\frac{\\partial J}{\\partial t} - \\nabla_{\\boldsymbol{\\xi}} \\cdot (J \\mathbf{w} \\cdot (\\nabla_{\\boldsymbol{\\xi}}\\mathbf{x})^{-T}) = 0 \\quad \\text{或} \\quad \\frac{\\partial J}{\\partial t} - \\sum_i \\frac{\\partial}{\\partial \\xi_i} (\\mathbf{A}^i \\cdot \\mathbf{w}) = 0\n$$\n让我们定义几何通量因子为 $G^i = \\mathbf{A}^i \\cdot \\mathbf{w}$。那么GCL就是 $\\partial_t J - \\nabla_{\\boldsymbol{\\xi}} \\cdot \\mathbf{G} = 0$，其中 $\\mathbf{G}$ 是分量为 $G^i$ 的向量。\n\n使用GCL，原始守恒律可以变换为参考域上的以下守恒形式：\n$$\n\\frac{\\partial (Ju)}{\\partial t} + \\sum_i \\frac{\\partial}{\\partial \\xi_i} (\\tilde{f}_i(u) - u G^i) = 0\n$$\n这就是ALE守恒律。方向 $i$ 上的总逆变通量是 $H^i = \\tilde{f}_i(u) - u G^i$。\n\n### 自由来流守恒性\n\nGCL的主要目标是确保均匀流（自由来流）保持均匀。令 $u(\\mathbf{x}, t) = u_c = \\text{const}$。在这种情况下，物理通量 $\\mathbf{f}(u_c)$ 也是一个常数向量。\n将 $u = u_c$ 代入ALE方程：\n$$\n\\frac{\\partial (J u_c)}{\\partial t} + \\sum_i \\frac{\\partial}{\\partial \\xi_i} (\\mathbf{A}^i \\cdot \\mathbf{f}(u_c) - u_c G^i) = 0\n$$\n$$\nu_c \\frac{\\partial J}{\\partial t} + \\sum_i \\frac{\\partial}{\\partial \\xi_i} (\\mathbf{A}^i \\cdot \\mathbf{f}(u_c)) - u_c \\sum_i \\frac{\\partial G^i}{\\partial \\xi_i} = 0\n$$\n由于 $\\mathbf{f}(u_c)$ 是一个常数向量，第二项是 $\\mathbf{f}(u_c) \\cdot \\left(\\sum_i \\frac{\\partial \\mathbf{A}^i}{\\partial \\xi_i}\\right)$。微分几何的一个基本恒等式（源于 $\\mathbf{A}^i$ 是由映射 $\\mathbf{x}(\\boldsymbol{\\xi})$ 的导数推导出来的事实）是这个和为零：$\\sum_i \\frac{\\partial \\mathbf{A}^i}{\\partial \\xi_i} = 0$。这通常被称为“度量恒等式”。\n自由来流的方程简化为：\n$$\nu_c \\frac{\\partial J}{\\partial t} - u_c \\sum_i \\frac{\\partial G^i}{\\partial \\xi_i} = 0 \\quad \\implies \\quad u_c \\left(\\frac{\\partial J}{\\partial t} - \\nabla_{\\boldsymbol{\\xi}} \\cdot \\mathbf{G} \\right) = 0\n$$\n这表明，如果GCL（$\\partial_t J - \\nabla_{\\boldsymbol{\\xi}} \\cdot \\mathbf{G} = 0$）和度量恒等式（$\\nabla_{\\boldsymbol{\\xi}} \\cdot \\tilde{\\mathbf{f}}_c = 0$）成立，则常数状态保持不变。\n\n### DGSEM的离散要求\n\n为了使DGSEM在移动网格上保持自由来流，这两个条件的离散模拟必须满足到机器精度。设离散空间算子为 $\\text{Div}_h$。\n半离散方程为 $\\frac{d(J_h u_h)}{dt} + \\text{Div}_h(\\mathbf{H}_h) = 0$。对于 $u_h = u_c$：\n$$\nu_c \\frac{d J_h}{dt} + \\text{Div}_h(\\tilde{\\mathbf{f}}_{h,c} - u_c \\mathbf{G}_h) = u_c \\frac{d J_h}{dt} + \\text{Div}_h(\\tilde{\\mathbf{f}}_{h,c}) - u_c \\text{Div}_h(\\mathbf{G}_h)\n$$\n要使此式等于零，我们需要：\n1.  **离散度量恒等式**：$\\text{Div}_h(\\tilde{\\mathbf{f}}_{h,c}) = 0$。对于具有SBP算子的DGSEM，如果度量项 $\\mathbf{A}^i_h$ 是使用与散度算子本身*相同*的SBP微分矩阵的公式（例如，“离散旋度形式”）计算的，则可以实现这一点。这与对称数值通量和单值的面度量相结合，确保了常数向量场的离散散度为零。\n2.  **离散几何守恒律 (DGCL)**：$\\frac{d J_h}{dt} - \\text{Div}_h(\\mathbf{G}_h) = 0$。这要求几何的时间积分与解的时间积分之间存在紧密耦合。项 $J_h$、$\\mathbf{A}^i_h$ 和 $\\mathbf{w}_h$（它们构成了 $\\mathbf{G}_h$）必须在时间积分格式（例如，Runge-Kutta）的每个阶段进行更新。这可以通过使用相同的格式显式积分 $J_h$ 的DGCL方程来实现，或者更稳健地，通过在每个阶段时间直接从网格坐标 $\\mathbf{x}_h$ 重新计算所有几何量（$J_h$, $\\mathbf{A}^i_h$, $\\mathbf{G}_h$）来实现。这需要将几何 $\\mathbf{x}_h$ 表示在与解 $u_h$ 相同的多项式空间中。\n\n此外，总通量 $\\mathbf{H}_h = \\tilde{\\mathbf{f}}_h - u_h \\mathbf{G}_h$ 的所有部分必须由空间离散化同等对待。这意味着使用相同的求积规则、相同的多项式基，并对组合的ALE通量应用相同的数值通量格式。\n\n### 选项评估\n\n**A. 此选项正确列出了一个有效的、满足DGCL的格式所需的所有必要组件：**\n- **步骤 1**：它要求将几何表示在与解相同的多项式空间中。它正确地指出，通过使用与散度算子本身相同的SBP微分矩阵的离散旋度形式来满足离散度量恒等式。它还正确地要求了单值的面度量。\n- **步骤 2**：它正确地要求将物理和几何通量分量组合起来，并使用*相同*的分裂形式通量差分和数值通量进行离散，确保了一致的处理，从而保持了代数抵消的性质。\n- **步骤 3**：它正确地描述了在时间上满足DGCL的两种有效的、等价的方法：要么使用与解相同的RK格式显式地积分GCL，要么在每个阶段根据阶段几何重新计算所有几何项。这确保了所需的紧密耦合。\n- **步骤 4**：它强调了对所有项使用一致算子（求积、插值）的必要性，这对SBP属性和DGCL至关重要。\n- **步骤 5**：这是一个正确的验证程序。\n这个清单是对最先进的保持自由来流的ALE-DGSEM的精确且充分的描述。**正确**。\n\n**B. 此选项存在根本性缺陷：**\n- **步骤 1**：在整个时间步内冻结度量项（$J$, $J\\mathbf{a}^i$），仅在阶段间改变网格速度 $\\mathbf{w}$，是一种“松散耦合”方法。它违反了DGCL，因为雅可比行列式 $J$ 的时间导数将与几何通量 $\\mathbf{G}$ 的散度不一致。\n- **步骤 2**：对物理和几何通量使用不同的求积规则是不一致的，并破坏了SBP属性。对几何项使用不同的数值通量（迎风）也破坏了自由来流守恒所需的抵消性质，因为数值通量必须应用于总的ALE通量 $H^i$。\n- **步骤 3  4**：明确声明不强制执行GCL并且不以移动网格的自由来流守恒为目标，证实了此方法的错误性。\n**不正确**。\n\n**C. 此选项同样存在根本性缺陷：**\n- **步骤 1**：如在B中所述，在一个时间步内冻结度量是不正确的。\n- **步骤 2**：对几何和解使用不同的节点集（Gauss vs. LGL）并在它们之间进行插值，完全破坏了DGSEM的配置结构和SBP算子的代数属性。所有量必须在相同的节点网格上表示。\n- **步骤 3**：假设 $J$ 是常数是一个严重且通常是错误的简化，根据定义它违反了GCL。\n**不正确**。\n\n**D. 此选项包含关键错误：**\n- **步骤 1**：虽然在每个阶段计算度量是正确的，但其余部分是错误的。\n- **步骤 2**：为物理项和几何项分别形成数值通量是不正确的。数值通量必须应用于总的ALE通量 $H^i = \\tilde{f}_i - u G^i$，以确保正确的非线性相互作用和守恒性质。\n- **步骤 3**：仅在时间步结束时重新计算 $J$ 是一种松散耦合形式，违反了DGCL。在每个RK阶段的半离散方程中使用的 $J$ 的值必须与该阶段的几何一致。\n- **步骤 4**：对物理和几何部分使用不同的积分规则是一种不一致的离散化，将无法保持自由来流。\n**不正确**。\n\n基于从第一性原理的严谨推导，选项A提供了一个完整且正确的程序清单，足以确保离散几何守恒律满足到机器精度。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}