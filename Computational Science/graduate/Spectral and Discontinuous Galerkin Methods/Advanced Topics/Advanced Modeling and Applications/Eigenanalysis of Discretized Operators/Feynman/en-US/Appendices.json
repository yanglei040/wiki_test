{
    "hands_on_practices": [
        {
            "introduction": "We begin our exploration with a minimalist system that is simple enough to solve with pen and paper, yet rich enough to reveal a fundamental pathology. By discretizing the linear advection equation with a piecewise-constant Discontinuous Galerkin (DG) method on just two elements and using a non-dissipative central flux, we can analytically compute the system's eigenvalues. This exercise  demonstrates how eigenanalysis can immediately expose the existence of a non-physical, undamped \"jump\" mode, providing a stark lesson on the crucial role of the numerical flux in ensuring a stable discretization.",
            "id": "3382553",
            "problem": "Consider the scalar linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant speed $a>0$ on the periodic domain $x \\in [0,2h]$, partitioned into two elements $E_{1}=[0,h]$ and $E_{2}=[h,2h]$. Use a Discontinuous Galerkin (DG) discretization with polynomial degree $p=0$ (piecewise constant basis on each element). Denote by $u_{1}(t)$ and $u_{2}(t)$ the elementwise constant degrees of freedom on $E_{1}$ and $E_{2}$, respectively, and let the numerical flux at any interface be the Laxâ€“Friedrichs flux\n$$\nf^{*}(u^{-},u^{+}) \\;=\\; \\frac{1}{2}\\,a\\,(u^{-}+u^{+}) \\;-\\; \\frac{1}{2}\\,\\alpha\\,(u^{+}-u^{-}),\n$$\nwhere $\\alpha \\ge 0$ is the penalty (dissipation) parameter. Set the interface penalty to zero, $\\alpha=0$, i.e., use the central flux $f^{*}(u^{-},u^{+}) = \\frac{1}{2}\\,a\\,(u^{-}+u^{+})$. Impose periodic boundary conditions so that the left boundary of $E_{1}$ is identified with the right boundary of $E_{2}$, and the right boundary of $E_{1}$ is identified with the left boundary of $E_{2}$.\n\nStarting from the DG weak form and conservation principles, derive the $2\\times 2$ semi-discrete operator $\\mathbf{L}$ such that $\\frac{d}{dt}\\begin{pmatrix}u_{1}\\\\u_{2}\\end{pmatrix}=\\mathbf{L}\\begin{pmatrix}u_{1}\\\\u_{2}\\end{pmatrix}$. Then, consider the interface-jump mode $\\boldsymbol{w}=\\begin{pmatrix}1\\\\-1\\end{pmatrix}$, which represents an undamped jump across the interface with zero average. Compute the eigenvalue $\\lambda_{J}$ of $\\mathbf{L}$ associated with $\\boldsymbol{w}$, defined by $\\mathbf{L}\\,\\boldsymbol{w}=\\lambda_{J}\\,\\boldsymbol{w}$.\n\nProvide your final answer for $\\lambda_{J}$ as an exact real number. No rounding is required.",
            "solution": "The user wants me to solve a problem related to the Discontinuous Galerkin (DG) method.\n\nHere's my plan:\n1.  **Validate the problem statement**:\n    *   Extract all the given information.\n    *   Check if it is scientifically sound, well-posed, objective, and complete.\n\n2.  **Solve the problem (if valid)**:\n    *   **Step 1: Write down the DG weak formulation.**\n        The partial differential equation is $u_t + a u_x = 0$. To obtain the weak formulation for the Discontinuous Galerkin method, we multiply the PDE by a test function $v$ and integrate over an element $E_k = [x_{k-1/2}, x_{k+1/2}]$.\n        $$\n        \\int_{E_k} \\frac{\\partial u}{\\partial t} v \\,dx + \\int_{E_k} a \\frac{\\partial u}{\\partial x} v \\,dx = 0\n        $$\n        We apply integration by parts to the spatial term:\n        $$\n        \\int_{E_k} a \\frac{\\partial u}{\\partial x} v \\,dx = [a u v]_{x_{k-1/2}}^{x_{k+1/2}} - \\int_{E_k} a u \\frac{\\partial v}{\\partial x} \\,dx\n        $$\n        Substituting this back into the first equation yields:\n        $$\n        \\int_{E_k} \\frac{\\partial u}{\\partial t} v \\,dx + [a u v]_{x_{k-1/2}}^{x_{k+1/2}} - \\int_{E_k} a u \\frac{\\partial v}{\\partial x} \\,dx = 0\n        $$\n        In the DG method, the solution $u_h$ and test function $v_h$ are discontinuous across element boundaries. The flux term $a u$ is replaced by a numerical flux $f^*(u^-, u^+)$, where $u^-$ and $u^+$ are the values of the solution on the left and right sides of an interface, respectively. The weak form for the discrete solution $u_h$ and test function $v_h$ becomes:\n        $$\n        \\int_{E_k} \\frac{\\partial u_h}{\\partial t} v_h \\,dx + f^*(u_h(x_{k+1/2}^-), u_h(x_{k+1/2}^+)) v_h(x_{k+1/2}^-) - f^*(u_h(x_{k-1/2}^-), u_h(x_{k-1/2}^+)) v_h(x_{k-1/2}^-) - \\int_{E_k} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx = 0\n        $$\n\n    *   **Step 2: Apply the piecewise constant basis ($p=0$).**\n        The problem specifies a polynomial degree $p=0$. This means the approximate solution $u_h$ and the test function $v_h$ are piecewise constant on each element. On an element $E_k$ of length $h_k$, we have:\n        $u_h(x, t) = u_k(t)$ for $x \\in E_k$.\n        $v_h(x) = v_k$ (a constant) for $x \\in E_k$.\n        Since $v_h$ is constant within the element, its derivative is zero: $\\frac{\\partial v_h}{\\partial x} = 0$. Consequently, the volume integral involving the derivative of the test function vanishes:\n        $$\n        \\int_{E_k} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx = 0\n        $$\n        Also, the time derivative term simplifies to:\n        $$\n        \\int_{E_k} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = \\int_{E_k} \\frac{d u_k}{dt} v_k \\,dx = \\frac{d u_k}{dt} v_k \\int_{E_k} dx = h_k \\frac{d u_k}{dt} v_k\n        $$\n        The values of the test function at the boundaries are simply $v_h(x_{k+1/2}^-) = v_k$ and $v_h(x_{k-1/2}^-) = v_k$.\n        The weak form for a $p=0$ discretization simplifies to:\n        $$\n        h_k \\frac{d u_k}{dt} v_k + f^*(u_k, u_{k+1}) v_k - f^*(u_{k-1}, u_k) v_k = 0\n        $$\n        where $u_{k+1}$ and $u_{k-1}$ are the solution values in the neighboring elements to the right and left, respectively. Since this must hold for any constant $v_k \\neq 0$, we can divide by $v_k$ to get the semi-discrete equation for element $k$:\n        $$\n        \\frac{d u_k}{dt} = -\\frac{1}{h_k} \\left[ f^*(u_k, u_{k+1}) - f^*(u_{k-1}, u_k) \\right]\n        $$\n\n    *   **Step 3: Construct the semi-discrete system for the given problem.**\n        The domain $[0, 2h]$ is divided into two elements $E_1=[0, h]$ and $E_2=[h, 2h]$. Both elements have length $h_1=h_2=h$. The degrees of freedom are $u_1(t)$ on $E_1$ and $u_2(t)$ on $E_2$. The system is periodic.\n        For element $E_1$ ($k=1$):\n        The right neighbor is $E_2$, so $u_{k+1} = u_2$.\n        Due to periodicity, the left neighbor is $E_2$, so $u_{k-1} = u_2$.\n        The interfaces for $E_1$ are at $x=h$ (right) and $x=0$ (left).\n        At the right interface ($x=h$), the left value is $u_1$ and the right value is $u_2$. The flux is $f^*(u_1, u_2)$.\n        At the left interface ($x=0$), due to periodicity this interface connects to $x=2h$. The left value is $u_2$ and the right value is $u_1$. The flux is $f^*(u_2, u_1)$.\n        The equation for $u_1$ is:\n        $$\n        \\frac{d u_1}{dt} = -\\frac{1}{h} \\left[ f^*(u_1, u_2) - f^*(u_2, u_1) \\right]\n        $$\n        For element $E_2$ ($k=2$):\n        The right neighbor is $E_1$ (periodicity), so $u_{k+1} = u_1$.\n        The left neighbor is $E_1$, so $u_{k-1} = u_1$.\n        The interfaces for $E_2$ are at $x=2h$ (right) and $x=h$ (left).\n        At the right interface ($x=2h$), the left value is $u_2$ and the right value is $u_1$. The flux is $f^*(u_2, u_1)$.\n        At the left interface ($x=h$), the left value is $u_1$ and the right value is $u_2$. The flux is $f^*(u_1, u_2)$.\n        The equation for $u_2$ is:\n        $$\n        \\frac{d u_2}{dt} = -\\frac{1}{h} \\left[ f^*(u_2, u_1) - f^*(u_1, u_2) \\right] = \\frac{1}{h} \\left[ f^*(u_1, u_2) - f^*(u_2, u_1) \\right]\n        $$\n\n    *   **Step 4: Substitute the specified numerical flux.**\n        The problem specifies the Lax-Friedrichs flux with the penalty parameter $\\alpha = 0$. This gives the central flux:\n        $$\n        f^*(u^-, u^+) = \\frac{1}{2} a (u^- + u^+)\n        $$\n        This flux is symmetric, meaning $f^*(u^-, u^+) = f^*(u^+, u^-)$.\n        Let's compute the difference of the flux terms required by the semi-discrete equations:\n        $$\n        f^*(u_1, u_2) - f^*(u_2, u_1) = \\frac{1}{2} a (u_1 + u_2) - \\frac{1}{2} a (u_2 + u_1) = 0\n        $$\n        Substituting this result into the semi-discrete system:\n        $$\n        \\frac{d u_1}{dt} = -\\frac{1}{h} [0] = 0\n        $$\n        $$\n        \\frac{d u_2}{dt} = \\frac{1}{h} [0] = 0\n        $$\n        This can be written in matrix form $\\frac{d}{dt}\\mathbf{u} = \\mathbf{L}\\mathbf{u}$ as:\n        $$\n        \\frac{d}{dt}\\begin{pmatrix}u_{1}\\\\u_{2}\\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix}u_{1}\\\\u_{2}\\end{pmatrix}\n        $$\n        Thus, the semi-discrete operator is the zero matrix: $\\mathbf{L} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$. This is a known pathology of the central flux scheme on a two-element periodic domain, as the scheme becomes equivalent to a central finite difference stencil that only uses points $j-1$ and $j+1$, which are the same point in this configuration.\n\n    *   **Step 5: Compute the eigenvalue for the interface-jump mode.**\n        We are asked to find the eigenvalue $\\lambda_J$ corresponding to the eigenvector $\\boldsymbol{w} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$. The eigenvalue equation is $\\mathbf{L}\\boldsymbol{w} = \\lambda_J \\boldsymbol{w}$.\n        Substituting the derived operator $\\mathbf{L}$ and the given vector $\\boldsymbol{w}$:\n        $$\n        \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\lambda_J \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n        $$\n        The left-hand side evaluates to the zero vector:\n        $$\n        \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\lambda_J \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n        $$\n        $$\n        \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\lambda_J \\\\ -\\lambda_J \\end{pmatrix}\n        $$\n        This equality holds if and only if $\\lambda_J = 0$. The description of the mode as an \"undamped jump\" is consistent with $\\lambda_J=0$, as the amplitude of the mode does not decay over time.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Building on the insight that naive discretization choices can create spurious modes, we now generalize our analysis to a more practical scenario. Instead of a two-element toy problem, we consider a periodic mesh with an arbitrary number of elements and a higher-order ($p=1$) polynomial approximation. This practice  introduces the powerful technique of Fourier analysis to derive the operator's \"symbol,\" which characterizes its behavior for every wavenumber. By evaluating this symbol at the highest resolvable frequency, we will see how the spurious modes from the previous exercise manifest as stationary oscillations at the Nyquist limit.",
            "id": "3382522",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a u_{x} = 0$ with constant speed $a \\in \\mathbb{R}$, posed on a periodic interval partitioned into a uniform mesh of $N$ cells of size $h > 0$. Let $u(x,t)$ be approximated by a Discontinuous Galerkin (DG) method of polynomial degree $p=1$ on each cell, using the orthonormal Legendre basis on the reference element $\\xi \\in [-1,1]$: $\\phi_{0}(\\xi) = 1/\\sqrt{2}$, $\\phi_{1}(\\xi) = \\sqrt{3/2}\\,\\xi$. Use the standard weak DG formulation with central numerical flux, where the numerical flux for the physical flux $f(u) = au$ is defined at an interface as $f^{*} = a U^{*}$ with $U^{*} = \\frac{1}{2}(u^{-} + u^{+})$. Map each physical cell $I_{j}$ to the reference element by $x = x_{j} + (h/2)\\,\\xi$, so that $u_{x} = (2/h)\\,u_{\\xi}$.\n\nStarting from the weak form and the orthonormality of the chosen basis, derive the semi-discrete system for the modal coefficients $u_{j,0}(t)$ and $u_{j,1}(t)$ in each cell $I_{j}$. Then perform a Fourier (plane-wave) ansatz $u_{j,m}(t) = \\hat{u}_{m}\\,\\exp(i \\theta j)\\,\\exp(\\lambda t)$ with dimensionless wavenumber $\\theta = k h$ and unknown growth rate $\\lambda$, to obtain the $2 \\times 2$ symbol of the DG spatial operator. Evaluate this symbol at the Nyquist wavenumber defined by $\\theta = \\pi$ and compute the associated eigenvalues and right eigenvectors. Normalize each eigenvector by setting $\\hat{u}_{0} = 1$ and report the ratio $\\hat{u}_{1}/\\hat{u}_{0}$ for each eigenvector.\n\nProvide your final answer as a single row matrix containing, in order, the two eigenvalues $\\lambda_{+}$, $\\lambda_{-}$ at $\\theta = \\pi$, followed by the corresponding eigenvector ratios $\\hat{u}_{1}/\\hat{u}_{0}$ for each eigenvalue (first for $\\lambda_{+}$, then for $\\lambda_{-}$). No rounding is required and your answer must be expressed in symbolic form in terms of $a$ and $h$.",
            "solution": "The user wants to find the eigenvalues and eigenvectors of a Discontinuous Galerkin (DG) spatial operator for the linear advection equation at the Nyquist wavenumber.\n\n### Step 1: Validate the Problem Statement\n\n**1.1. Extract Givens**\n- **Equation**: One-dimensional linear advection equation, $u_{t} + a u_{x} = 0$, with constant speed $a \\in \\mathbb{R}$.\n- **Domain**: A periodic interval partitioned into a uniform mesh of $N$ cells of size $h > 0$.\n- **Discretization Method**: Discontinuous Galerkin (DG) method with polynomial degree $p=1$.\n- **Basis Functions**: On the reference element $\\xi \\in [-1,1]$, the orthonormal Legendre basis is given by $\\phi_{0}(\\xi) = 1/\\sqrt{2}$ and $\\phi_{1}(\\xi) = \\sqrt{3/2}\\,\\xi$.\n- **Weak Formulation**: Standard weak DG formulation.\n- **Numerical Flux**: Central flux for $f(u) = a u$, defined as $f^{*} = a U^{*}$ with $U^{*} = \\frac{1}{2}(u^{-} + u^{+})$.\n- **Mapping**: The physical cell $I_{j}$ is mapped to the reference element by $x = x_{j} + (h/2)\\,\\xi$, which implies $\\partial_{x} = (2/h)\\,\\partial_{\\xi}$.\n- **Analysis Task**:\n    1. Derive the semi-discrete system for the modal coefficients $u_{j,0}(t)$ and $u_{j,1}(t)$ in cell $I_j$.\n    2. Perform a Fourier analysis using the ansatz $u_{j,m}(t) = \\hat{u}_{m}\\,\\exp(i \\theta j)\\,\\exp(\\lambda t)$ with $\\theta = k h$.\n    3. Find the $2 \\times 2$ symbol of the DG operator.\n    4. Evaluate the symbol at the Nyquist wavenumber $\\theta = \\pi$.\n    5. Compute the eigenvalues and eigenvectors of the resulting matrix.\n    6. Normalize eigenvectors by setting $\\hat{u}_{0} = 1$ and find the ratio $\\hat{u}_{1}/\\hat{u}_{0}$.\n\n**1.2. Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is a standard exercise in the numerical analysis of partial differential equations, specifically focusing on the spectral properties of DG methods. All concepts are well-established within applied mathematics and computational science.\n- **Well-Posed**: The problem provides a complete set of definitions and constraints, leading to a unique and meaningful solution for the specified eigenvalues and eigenvectors.\n- **Objective**: The problem is stated using precise mathematical language, free of ambiguity or subjective claims.\n\n**1.3. Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\n### Step 2: Derivation of the Semi-Discrete System\n\nWe start with the weak formulation of the advection equation on a cell $I_j = [x_{j-1/2}, x_{j+1/2}]$:\n$$\n\\int_{I_j} v (u_t + a u_x) dx = 0\n$$\nfor any test function $v$ in the same polynomial space as the solution approximation $u_h$. Integrating the spatial term by parts gives:\n$$\n\\int_{I_j} v u_t dx - a \\int_{I_j} v_x u_h dx + [a v u_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\nReplacing the boundary term with the numerical flux $f^* = a U^*$:\n$$\n\\int_{I_j} v u_t dx - a \\int_{I_j} v_x u_h dx + a v(x_{j+1/2}) U^*(x_{j+1/2}) - a v(x_{j-1/2}) U^*(x_{j-1/2}) = 0\n$$\nThe solution $u_h$ in cell $I_j$ is expanded in the basis: $u_h(x,t) = u_{j,0}(t)\\phi_0(\\xi(x)) + u_{j,1}(t)\\phi_1(\\xi(x))$. We choose the test function $v$ to be one of the basis functions, $\\phi_k(\\xi(x))$.\n\nWe map the integrals to the reference element $\\xi \\in [-1,1]$ using $x = x_j + \\frac{h}{2}\\xi$, so $dx = \\frac{h}{2}d\\xi$ and $\\partial_x = \\frac{2}{h}\\partial_\\xi$.\n$$\n\\frac{h}{2}\\int_{-1}^{1} \\phi_k u_{ht} d\\xi - a \\int_{-1}^{1} \\frac{2}{h}\\frac{d\\phi_k}{d\\xi} u_h \\frac{h}{2}d\\xi + a \\phi_k(1) U_{j+1/2}^* - a \\phi_k(-1) U_{j-1/2}^* = 0\n$$\n$$\n\\frac{h}{2}\\int_{-1}^{1} \\phi_k \\sum_{m=0}^{1} \\frac{du_{j,m}}{dt}\\phi_m d\\xi - a \\int_{-1}^{1} \\frac{d\\phi_k}{d\\xi} \\sum_{m=0}^{1} u_{j,m}\\phi_m d\\xi + a \\phi_k(1) U_{j+1/2}^* - a \\phi_k(-1) U_{j-1/2}^* = 0\n$$\nUsing the orthonormality of the basis, $\\int_{-1}^1 \\phi_k \\phi_m d\\xi = \\delta_{km}$, the first term simplifies to $\\frac{h}{2}\\frac{du_{j,k}}{dt}$. The equation becomes:\n$$\n\\frac{h}{2}\\frac{du_{j,k}}{dt} = a \\sum_{m=0}^{1} u_{j,m} \\int_{-1}^{1} \\frac{d\\phi_k}{d\\xi} \\phi_m d\\xi - a \\left( \\phi_k(1)U_{j+1/2}^* - \\phi_k(-1)U_{j-1/2}^* \\right)\n$$\nLet's evaluate the integrals and boundary values.\nThe derivatives are $\\frac{d\\phi_0}{d\\xi} = 0$ and $\\frac{d\\phi_1}{d\\xi} = \\sqrt{3/2}$.\nThe stiffness matrix integrals $S_{km} = \\int_{-1}^1 \\frac{d\\phi_k}{d\\xi}\\phi_m d\\xi$ are:\n$S_{00}=S_{01}=0$.\n$S_{10} = \\int_{-1}^1 \\sqrt{3/2} (1/\\sqrt{2}) d\\xi = \\sqrt{3}$.\n$S_{11} = \\int_{-1}^1 \\sqrt{3/2} (\\sqrt{3/2}\\xi) d\\xi = 0$.\n\nThe basis functions at the element boundaries $\\xi=\\pm 1$ are:\n$\\phi_0(1) = 1/\\sqrt{2}$, $\\phi_0(-1) = 1/\\sqrt{2}$.\n$\\phi_1(1) = \\sqrt{3/2}$, $\\phi_1(-1) = -\\sqrt{3/2}$.\n\nThe numerical flux $U_{j+1/2}^* = \\frac{1}{2}(u_h(x_{j+1/2}^-) + u_h(x_{j+1/2}^+))$ involves values from cell $j$ and $j+1$:\n$u_h(x_{j+1/2}^-) = u_{j,0}\\phi_0(1) + u_{j,1}\\phi_1(1)$, and $u_h(x_{j+1/2}^+) = u_{j+1,0}\\phi_0(-1) + u_{j+1,1}\\phi_1(-1)$.\nSimilarly for $U_{j-1/2}^*$ with cells $j-1$ and $j$.\n\nFor $k=0$ (test with $\\phi_0$):\nThe stiffness term is zero.\n$$\n\\frac{h}{2}\\frac{du_{j,0}}{dt} = -a \\left( \\phi_0(1)U_{j+1/2}^* - \\phi_0(-1)U_{j-1/2}^* \\right) = -\\frac{a}{\\sqrt{2}} \\left( U_{j+1/2}^* - U_{j-1/2}^* \\right)\n$$\nSubstituting the expressions for $U^*$ and the basis functions leads to:\n$$\n\\frac{h}{2}\\frac{du_{j,0}}{dt} = -\\frac{a}{4} \\left[ (u_{j+1,0} - u_{j-1,0}) + 2\\sqrt{3}u_{j,1} - \\sqrt{3}(u_{j+1,1} + u_{j-1,1}) \\right]\n$$\n\nFor $k=1$ (test with $\\phi_1$):\n$$\n\\frac{h}{2}\\frac{du_{j,1}}{dt} = a(u_{j,0}S_{10} + u_{j,1}S_{11}) - a(\\phi_1(1)U_{j+1/2}^* - \\phi_1(-1)U_{j-1/2}^*)\n$$\n$$\n\\frac{h}{2}\\frac{du_{j,1}}{dt} = a\\sqrt{3}u_{j,0} - a\\sqrt{3/2}(U_{j+1/2}^* + U_{j-1/2}^*)\n$$\nSubstituting leads to:\n$$\n\\frac{h}{2}\\frac{du_{j,1}}{dt} = \\frac{a\\sqrt{3}}{2}u_{j,0} - \\frac{a\\sqrt{3}}{4}(u_{j+1,0}+u_{j-1,0}) + \\frac{3a}{4}(u_{j+1,1}-u_{j-1,1})\n$$\n\n### Step 3: Fourier Analysis and Symbol Matrix\n\nWe apply the Fourier ansatz $u_{j,m}(t) = \\hat{u}_m \\exp(i\\theta j)\\exp(\\lambda t)$. This implies:\n$\\frac{du_{j,m}}{dt} = \\lambda u_{j,m}$, $u_{j+1,m} = e^{i\\theta}u_{j,m}$, $u_{j-1,m} = e^{-i\\theta}u_{j,m}$.\nThus, $u_{j+1,m} - u_{j-1,m} = 2i\\sin(\\theta)u_{j,m}$ and $u_{j+1,m} + u_{j-1,m} = 2\\cos(\\theta)u_{j,m}$.\nSubstituting these into the semi-discrete equations and dividing by $\\exp(i\\theta j)\\exp(\\lambda t)$:\n\nFor the $\\hat{u}_0$ equation:\n$$\n\\frac{h}{2}\\lambda \\hat{u}_0 = -\\frac{a}{4} \\left[ 2i\\sin(\\theta)\\hat{u}_0 + 2\\sqrt{3}\\hat{u}_1 - \\sqrt{3}(2\\cos(\\theta)\\hat{u}_1) \\right]\n$$\n$$\n\\lambda \\hat{u}_0 = -\\frac{a}{h} \\left[ i\\sin(\\theta)\\hat{u}_0 + \\sqrt{3}(1-\\cos(\\theta))\\hat{u}_1 \\right]\n$$\n\nFor the $\\hat{u}_1$ equation:\n$$\n\\frac{h}{2}\\lambda \\hat{u}_1 = \\frac{a\\sqrt{3}}{2}\\hat{u}_0 - \\frac{a\\sqrt{3}}{4}(2\\cos(\\theta)\\hat{u}_0) + \\frac{3a}{4}(2i\\sin(\\theta)\\hat{u}_1)\n$$\n$$\n\\lambda \\hat{u}_1 = \\frac{a}{h} \\left[ \\sqrt{3}(1-\\cos(\\theta))\\hat{u}_0 + 3i\\sin(\\theta)\\hat{u}_1 \\right]\n$$\n\nThese two equations form a $2 \\times 2$ eigenvalue problem $\\lambda \\mathbf{\\hat{u}} = Z(\\theta) \\mathbf{\\hat{u}}$, where $\\mathbf{\\hat{u}} = [\\hat{u}_0, \\hat{u}_1]^T$ and the symbol matrix $Z(\\theta)$ is:\n$$\nZ(\\theta) = \\frac{a}{h}\n\\begin{pmatrix}\n-i\\sin(\\theta) & -\\sqrt{3}(1-\\cos(\\theta)) \\\\\n\\sqrt{3}(1-\\cos(\\theta)) & 3i\\sin(\\theta)\n\\end{pmatrix}\n$$\n\n### Step 4: Eigenanalysis at the Nyquist Wavenumber\n\nWe now evaluate the symbol at the Nyquist wavenumber $\\theta = \\pi$. At this wavenumber, $\\sin(\\pi) = 0$ and $\\cos(\\pi) = -1$, so $1-\\cos(\\pi) = 2$.\nThe symbol matrix becomes:\n$$\nZ(\\pi) = \\frac{a}{h}\n\\begin{pmatrix}\n0 & -2\\sqrt{3} \\\\\n2\\sqrt{3} & 0\n\\end{pmatrix}\n$$\n\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(Z(\\pi) - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\lambda & -2a\\sqrt{3}/h \\\\ 2a\\sqrt{3}/h & -\\lambda \\end{pmatrix} = (-\\lambda)^2 - \\left(-\\frac{2a\\sqrt{3}}{h}\\right)\\left(\\frac{2a\\sqrt{3}}{h}\\right) = 0\n$$\n$$\n\\lambda^2 + \\frac{4a^2(3)}{h^2} = 0 \\implies \\lambda^2 = -\\frac{12a^2}{h^2}\n$$\nThe eigenvalues are purely imaginary:\n$$\n\\lambda = \\pm i \\sqrt{\\frac{12a^2}{h^2}} = \\pm i \\frac{2a\\sqrt{3}}{h}\n$$\nWe denote them as $\\lambda_{+} = i \\frac{2a\\sqrt{3}}{h}$ and $\\lambda_{-} = -i \\frac{2a\\sqrt{3}}{h}$.\n\nTo find the corresponding eigenvectors $\\mathbf{\\hat{u}} = [\\hat{u}_0, \\hat{u}_1]^T$, we solve $(Z(\\pi) - \\lambda I)\\mathbf{\\hat{u}} = 0$. Using the first row of the matrix equation:\n$$\n-\\lambda \\hat{u}_0 - \\frac{2a\\sqrt{3}}{h} \\hat{u}_1 = 0\n$$\nThis gives the ratio of the eigenvector components:\n$$\n\\frac{\\hat{u}_1}{\\hat{u}_0} = -\\frac{\\lambda h}{2a\\sqrt{3}}\n$$\nWe normalize by setting $\\hat{u}_0 = 1$.\n\nFor the eigenvalue $\\lambda_{+} = i \\frac{2a\\sqrt{3}}{h}$:\nThe ratio is:\n$$\n\\frac{\\hat{u}_1}{\\hat{u}_0} = -\\frac{(i \\frac{2a\\sqrt{3}}{h}) h}{2a\\sqrt{3}} = -i\n$$\nThe eigenvector is proportional to $[1, -i]^T$.\n\nFor the eigenvalue $\\lambda_{-} = -i \\frac{2a\\sqrt{3}}{h}$:\nThe ratio is:\n$$\n\\frac{\\hat{u}_1}{\\hat{u}_0} = -\\frac{(-i \\frac{2a\\sqrt{3}}{h}) h}{2a\\sqrt{3}} = i\n$$\nThe eigenvector is proportional to $[1, i]^T$.\n\nThe final answer requires the two eigenvalues and the two corresponding eigenvector ratios in a specific order.\n- $\\lambda_{+} = i \\frac{2a\\sqrt{3}}{h}$\n- $\\lambda_{-} = -i \\frac{2a\\sqrt{3}}{h}$\n- Ratio for $\\lambda_{+}$: $-i$\n- Ratio for $\\lambda_{-}$: $i$\n\nThese are assembled into a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\ni \\frac{2a\\sqrt{3}}{h} & -i \\frac{2a\\sqrt{3}}{h} & -i & i\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having explored theoretical instabilities, we now turn to a practical computational trade-off central to the efficiency of many DG codes. While using a consistent, or \"exact,\" mass matrix $\\mathbf{M}$ is formally more accurate, it is a dense block matrix that requires an expensive inversion at every time step in an explicit scheme. A common alternative is \"mass lumping,\" which approximates $\\mathbf{M}$ with a diagonal matrix that is trivial to invert. This computational exercise  tasks you with implementing both schemes to quantitatively assess the impact of mass lumping on the operator's spectrum, including its effect on the explicit time-step limit, numerical dispersion, and dissipation.",
            "id": "3382546",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ on the periodic domain $[0,L]$, discretized by a nodal Discontinuous Galerkin Spectral Element Method (DGSEM) with Legendre-Gauss-Lobatto nodes on each element. Let there be $N_e$ uniform elements and polynomial degree $P$ per element, giving $P+1$ nodes per element. Denote the reference element coordinate by $\\xi \\in [-1,1]$ with the affine mapping $x = x_c + \\frac{h}{2}\\,\\xi$, where $h = L/N_e$ is the element size and $x_c$ is the element center, and the Jacobian $J = h/2$.\n\nUse the standard nodal Lagrange basis at the Legendre-Gauss-Lobatto nodes on the reference element. Let $W_{\\hat{}}$ be the diagonal matrix of Legendre-Gauss-Lobatto quadrature weights on the reference element, and let $D$ be the barycentric differentiation matrix associated with these nodes on the reference element. The strong-form DGSEM semi-discrete operator on element $e$ with an upwind numerical flux is given by the block relation\n$$\nJ\\,W_{\\hat{}}\\,\\frac{d u_e}{dt} \\;=\\; a\\,\\left( -\\,W_{\\hat{}}\\,D\\,u_e \\;+\\; \\text{surface injection terms depending on the upwind flux and periodic connectivity} \\right).\n$$\nWith periodic boundary conditions, the surface injection adds one rank-one term to the element block and one rank-one inter-element coupling term per element, with the specific orientation determined by the sign of $a$ (positive velocity selects upwind state from the left neighbor; negative velocity selects upwind state from the right neighbor).\n\nDefine the global operator $\\mathbf{K}$ by assembling the volume contributions $-\\,W_{\\hat{}}\\,D$ and the consistent upwind surface injection contributions across elements with periodic connectivity. Define two mass matrices: the exact mass matrix $\\mathbf{M}_{\\text{exact}}$, constructed by integrating $\\int_{-1}^{1} \\ell_i(\\xi)\\,\\ell_j(\\xi)\\,d\\xi$ exactly for the nodal Lagrange basis $\\ell_i(\\xi)$ using Gauss-Legendre quadrature of sufficient order and then scaling by $J$, and the lumped (diagonal) mass matrix $\\mathbf{M}_{\\text{lumped}} = J\\,W_{\\hat{}}$. Consider the two semi-discrete generators\n$$\n\\mathbf{A}_{\\text{exact}} \\;=\\; a\\,\\mathbf{M}_{\\text{exact}}^{-1}\\,\\mathbf{K}, \n\\qquad\n\\mathbf{A}_{\\text{lumped}} \\;=\\; a\\,\\mathbf{M}_{\\text{lumped}}^{-1}\\,\\mathbf{K}.\n$$\n\nYour task is to implement a program that, for each parameter set in the test suite, constructs $\\mathbf{M}_{\\text{exact}}$, $\\mathbf{M}_{\\text{lumped}}$, and $\\mathbf{K}$, computes the eigenvalues of $\\mathbf{A}_{\\text{exact}}$ and $\\mathbf{A}_{\\text{lumped}}$, and quantifies stability and dispersion changes caused by mass-lumping. Specifically, for each operator:\n\n1. Compute the Forward Euler stability limit $\\,\\Delta t_{\\text{FE}}$ defined by the largest nonnegative $\\,\\Delta t\\,$ such that $\\,|1 + \\Delta t\\,\\lambda| \\le 1\\,$ for all eigenvalues $\\,\\lambda\\,$ of the operator. For each eigenvalue $\\,\\lambda = \\alpha + i\\beta\\,$ with $\\,\\alpha < 0$, the boundary of the stability disk yields\n$$\n\\Delta t_{\\lambda} \\;=\\; -\\,\\frac{2\\,\\alpha}{\\alpha^2 + \\beta^2},\n$$\nand the admissible time step is $\\,\\Delta t_{\\text{FE}} = \\min_{\\lambda:\\,\\Re(\\lambda)<0} \\Delta t_{\\lambda}$, with the convention that if no eigenvalue has negative real part, then $\\,\\Delta t_{\\text{FE}} = 0$.\n\n2. Compute a low-wavenumber dispersion error by selecting the eigenvalue with the smallest nonzero $|\\operatorname{Im}(\\lambda)|$ and comparing its imaginary part magnitude $|\\operatorname{Im}(\\lambda)|$ to the continuous dispersion $|a|\\,k_1$, where $k_1 = 2\\pi/L$ is the fundamental wavenumber. Report the relative dispersion error\n$$\n\\varepsilon_{\\text{disp}} \\;=\\; \\frac{|\\operatorname{Im}(\\lambda)|}{|a|\\,k_1} \\;-\\; 1.\n$$\nIf all eigenvalues have zero imaginary part, set $\\,\\varepsilon_{\\text{disp}} = 0$.\n\n3. Compute the maximum real part $\\,\\max_{\\lambda} \\operatorname{Re}(\\lambda)$ to quantify dissipation (negative real parts contribute to damping; larger maximum real part is less stable).\n\nAssemble the six metrics for each parameter set in the order\n$$\n[\\Delta t_{\\text{FE}}(\\mathbf{A}_{\\text{exact}}),\\;\\Delta t_{\\text{FE}}(\\mathbf{A}_{\\text{lumped}}),\\;\\varepsilon_{\\text{disp}}(\\mathbf{A}_{\\text{exact}}),\\;\\varepsilon_{\\text{disp}}(\\mathbf{A}_{\\text{lumped}}),\\;\\max \\operatorname{Re}(\\mathbf{A}_{\\text{exact}}),\\;\\max \\operatorname{Re}(\\mathbf{A}_{\\text{lumped}})].\n$$\n\nImplementation requirements:\n\n- Construct Legendre-Gauss-Lobatto nodes on the reference element, the barycentric weights, and the barycentric differentiation matrix $D$ using the formulas\n$w_j^{\\text{bary}} \\;=\\; \\frac{1}{\\prod_{k\\ne j} (x_j - x_k)}$, \n$\\qquad\nD_{ij} \\;=\\;\n\\begin{cases}\n\\frac{w_j^{\\text{bary}}}{w_i^{\\text{bary}}}\\,\\frac{1}{x_i - x_j}, & i \\ne j, \\\\\n-\\sum_{k\\ne i} D_{ik}, & i=j.\n\\end{cases}$\n\n- Use the Legendre-Gauss-Lobatto quadrature weights\n$$\n(W_{\\hat{}})_{jj} \\;=\\; w_j^{\\text{LGL}} \\;=\\; \\frac{2}{P(P+1)}\\,\\frac{1}{\\left(L_P(x_j)\\right)^2},\n$$\nwhere $L_P$ is the degree-$P$ Legendre polynomial evaluated at node $x_j$ on $[-1,1]$.\n\n- Build the exact element mass matrix via Gauss-Legendre quadrature with at least $P+2$ points to integrate products of degree-$P$ Lagrange polynomials exactly:\n$$\n(M_{\\text{exact}}^{(e)})_{ij} \\;=\\; J\\,\\sum_{q=1}^{N_q} w_q^{\\text{GL}}\\,\\ell_i(\\xi_q)\\,\\ell_j(\\xi_q),\n$$\nwith $N_q \\ge P+2$, where $(\\xi_q, w_q^{\\text{GL}})$ are the Gauss-Legendre nodes and weights on $[-1,1]$, and $\\ell_j$ is the nodal Lagrange basis associated with the Legendre-Gauss-Lobatto nodes.\n\n- Assemble the global $\\mathbf{K}$ in block form with periodic connectivity. For $a \\ge 0$ (advection to the right), the upwind surface injection in element $e$ contributes $+\\,e^- (e^-)^{\\top}$ to its diagonal block and $-\\,e^- (e^+)^{\\top}$ to the block coupling from element $e-1$ to $e$, where $e^-$ selects the left endpoint node and $e^+$ selects the right endpoint node. For $a < 0$ (advection to the left), use $+\\,e^+ (e^+)^{\\top}$ on the diagonal block and $-\\,e^+ (e^-)^{\\top}$ from element $e+1$ to $e$. In all cases the volume block is $-\\,W_{\\hat{}}\\,D$.\n\nTest suite:\n\n- Case 1 (happy path): $L = 1$, $a = 1$, $N_e = 8$, $P = 4$.\n- Case 2 (low degree boundary): $L = 1$, $a = 1$, $N_e = 2$, $P = 1$.\n- Case 3 (higher degree fewer elements): $L = 1$, $a = 1$, $N_e = 4$, $P = 8$.\n- Case 4 (negative velocity): $L = 1$, $a = -0.7$, $N_e = 6$, $P = 3$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, each inner list ordered as\n$[\\Delta t_{\\text{FE}}(\\mathbf{A}_{\\text{exact}}),\\;\\Delta t_{\\text{FE}}(\\mathbf{A}_{\\text{lumped}}),\\;\\varepsilon_{\\text{disp}}(\\mathbf{A}_{\\text{exact}}),\\;\\varepsilon_{\\text{disp}}(\\mathbf{A}_{\\text{lumped}}),\\;\\max \\operatorname{Re}(\\mathbf{A}_{\\text{exact}}),\\;\\max \\operatorname{Re}(\\mathbf{A}_{\\text{lumped}})]$.\nFor example, the output format must be exactly like\n$$\n[[r_{11},r_{12},r_{13},r_{14},r_{15},r_{16}],[r_{21},r_{22},r_{23},r_{24},r_{25},r_{26}],\\dots]\n$$\nwith each $r_{ij}$ a real number (float).",
            "solution": "The user's request pertains to the eigenanalysis of a Discontinuous Galerkin Spectral Element Method (DGSEM) discretization for the one-dimensional linear advection equation. The problem is scientifically well-posed, providing a complete and consistent set of definitions, parameters, and procedures. No factual unsoundness, ambiguity, or contradiction has been found. Therefore, the problem is deemed valid and a full solution can be provided.\n\nThe solution methodology involves the following steps:\n1.  **Reference Element Construction**: For a given polynomial degree $P$, we first construct the necessary components on the reference element $\\xi \\in [-1,1]$.\n    -   **Legendre-Gauss-Lobatto (LGL) Nodes and Weights**: The $P+1$ LGL nodes are the roots of the polynomial $(1-\\xi^2)L'_P(\\xi)$, where $L_P(\\xi)$ is the Legendre polynomial of degree $P$. The nodes are computed by finding the roots of $L'_P(\\xi)$ for the interior nodes and appending the endpoints $\\{-1, 1\\}$. The corresponding LGL quadrature weights are calculated using the standard formula $w_j = \\frac{2}{P(P+1)}[L_P(\\xi_j)]^{-2}$.\n    -   **Barycentric Differentiation Matrix ($D$)**: A differentiation matrix $D$ is constructed for the LGL nodes using the efficient and accurate barycentric formula. The diagonal elements are determined by the condition that the derivative of a constant must be zero, i.e., $\\sum_j D_{ij} = 0$.\n    -   **Reference Mass Matrices**: Two types of mass matrices are considered on the reference element.\n        -   The lumped mass matrix, $W_{\\hat{}}$, is a diagonal matrix whose entries are the LGL quadrature weights.\n        -   The exact mass matrix, $M_{\\text{exact,ref}}$, is computed by exactly integrating the product of Lagrange basis functions, $(\\ell_i, \\ell_j) = \\int_{-1}^1 \\ell_i(\\xi)\\ell_j(\\xi)d\\xi$. This integral is evaluated numerically using a Gauss-Legendre quadrature rule with a sufficient number of points ($N_q \\ge P+2$) to ensure exactness for polynomials of degree up to $2P$.\n\n2.  **Global Matrix Assembly**: The global matrices are assembled by iterating over the $N_e$ elements in the domain.\n    -   **Global Mass Matrices ($\\mathbf{M}_{\\text{exact}}$, $\\mathbf{M}_{\\text{lumped}}$)**: These are block-diagonal matrices. For each element $e$, the corresponding reference mass matrix ($M_{\\text{exact,ref}}$ or $W_{\\hat{}}$) is scaled by the Jacobian of the transformation, $J=h/2$, and placed on the diagonal block associated with that element.\n    -   **Global Stiffness Matrix ($\\mathbf{K}$)**: The matrix $\\mathbf{K}$ incorporates both volume and surface integral terms.\n        -   **Volume Term**: For each element $e$, the contribution to the diagonal block is $-W_{\\hat{}} D$.\n        -   **Surface Term**: An upwind flux is used at element interfaces to ensure stability. This introduces coupling between adjacent elements. For periodic boundary conditions, this results in specific rank-one updates to the matrix blocks.\n            -   For advection velocity $a \\ge 0$, a flux term couples the right boundary of element $e-1$ to the left boundary of element $e$.\n            -   For $a < 0$, the left boundary of element $e+1$ is coupled to the right boundary of element $e$.\n        These couplings are implemented as specified by the problem statement, considering the periodic nature of the domain.\n\n3.  **System Matrix Formation and Eigenanalysis**: With the global matrices assembled, the two semi-discrete system operators are formed:\n    $$\n    \\mathbf{A}_{\\text{exact}} = a\\,\\mathbf{M}_{\\text{exact}}^{-1}\\,\\mathbf{K} \\qquad \\text{and} \\qquad \\mathbf{A}_{\\text{lumped}} = a\\,\\mathbf{M}_{\\text{lumped}}^{-1}\\,\\mathbf{K}\n    $$\n    The inverse of the dense matrix $\\mathbf{M}_{\\text{exact}}$ is computed using a standard linear solver. The inverse of the diagonal matrix $\\mathbf{M}_{\\text{lumped}}$ is trivially found by taking the reciprocal of its diagonal elements. The eigenvalues of both $\\mathbf{A}_{\\text{exact}}$ and $\\mathbf{A}_{\\text{lumped}}$ are then computed.\n\n4.  **Metric Calculation**: The computed eigenvalue spectra are analyzed to determine the required stability and accuracy metrics for each operator.\n    -   **Forward Euler Stability Limit ($\\Delta t_{\\text{FE}}$)**: This is calculated from the eigenvalues $\\lambda = \\alpha + i\\beta$ with negative real parts ($\\alpha < 0$) as $\\Delta t_{\\text{FE}} = \\min (-2\\alpha / |\\lambda|^2)$. In accordance with the problem's convention, $\\Delta t_{\\text{FE}}$ is set to $0$ if no eigenvalues have a negative real part.\n    -   **Dispersion Error ($\\varepsilon_{\\text{disp}}$)**: This metric quantifies the error in the wave propagation speed for the lowest resolved wavenumber, $k_1 = 2\\pi/L$. It is computed by finding the eigenvalue with the smallest non-zero imaginary part and comparing its magnitude to the exact continuous dispersion relation $|a|k_1$.\n    -   **Maximum Real Part ($\\max \\operatorname{Re}(\\lambda)$)**: This value indicates the inherent stability of the semi-discretization. For a stable scheme, this value should be non-positive. Any positive value signals numerical instability.\n\nThis entire procedure is applied to each test case specified in the problem, and the six resulting metrics are collected and formatted as required.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre, roots_legendre\n\ndef get_lgl_nodes_weights(P):\n    \"\"\"\n    Computes Legendre-Gauss-Lobatto (LGL) nodes and weights for a given polynomial degree P.\n    The nodes are the roots of (1-x^2) * L_P'(x).\n    \"\"\"\n    if P == 0:\n        return np.array([-1.0]), np.array([2.0])\n    \n    # The interior LGL nodes are roots of the derivative of the P-th Legendre polynomial.\n    # For P=1, there are no interior roots.\n    if P == 1:\n        interior_nodes = np.array([])\n    else:\n        L_P_prime = legendre(P).deriv()\n        interior_nodes = L_P_prime.roots\n    \n    nodes = np.concatenate(([-1.0], interior_nodes, [1.0]))\n    nodes = np.sort(np.real(nodes)) # Ensure real and sorted\n    \n    # LGL weights\n    L_P = legendre(P)\n    weights = 2.0 / (P * (P + 1) * (L_P(nodes)**2))\n    \n    return nodes, weights\n\ndef get_barycentric_diff_matrix(nodes):\n    \"\"\"\n    Computes the barycentric differentiation matrix for a given set of nodes.\n    \"\"\"\n    N = len(nodes)\n    D = np.zeros((N, N))\n    \n    bary_weights = np.ones(N)\n    for j in range(N):\n        for k in range(N):\n            if k != j:\n                bary_weights[j] /= (nodes[j] - nodes[k])\n\n    for i in range(N):\n        sum_row_i = 0.0\n        for j in range(N):\n            if i != j:\n                D[i, j] = (bary_weights[j] / bary_weights[i]) / (nodes[i] - nodes[j])\n                sum_row_i += D[i, j]\n        D[i, i] = -sum_row_i\n        \n    return D\n\ndef get_reference_exact_mass_matrix(P, lgl_nodes):\n    \"\"\"\n    Computes the reference element exact mass matrix using Gauss-Legendre quadrature.\n    \"\"\"\n    N_nodes = P + 1\n    # Use N_q points for Gauss-Legendre quadrature. Rule is exact for polys of degree 2*N_q-1.\n    # We integrate products of degree P Lagrange polynomials (total degree 2P).\n    # Need 2*N_q-1 >= 2P => N_q >= P + 1/2.\n    # Problem specifies N_q >= P+2, so we use P+2.\n    N_q = P + 2\n    gl_nodes, gl_weights = roots_legendre(N_q)\n    \n    # Vandermonde-like matrix for Lagrange polynomials evaluated at GL quadrature points\n    V = np.ones((N_q, N_nodes))\n    for j in range(N_nodes):\n        for q in range(N_q):\n            val = 1.0\n            for k in range(N_nodes):\n                if k != j:\n                    val *= (gl_nodes[q] - lgl_nodes[k]) / (lgl_nodes[j] - lgl_nodes[k])\n            V[q, j] = val\n            \n    # M_ref = V^T * diag(gl_weights) * V\n    M_ref = V.T @ np.diag(gl_weights) @ V\n    return M_ref\n\ndef analyze_eigenvalues(lambdas, a, L):\n    \"\"\"\n    Calculates the stability and dispersion metrics from a given set of eigenvalues.\n    \"\"\"\n    tol = 1e-12\n\n    # Metric 1: Forward Euler stability limit\n    reals = np.real(lambdas)\n    dissipative_lambdas = lambdas[reals < -tol]\n    \n    if len(dissipative_lambdas) == 0:\n        dt_fe = 0.0\n    else:\n        dt_vals = -2 * np.real(dissipative_lambdas) / (np.abs(dissipative_lambdas)**2)\n        dt_fe = np.min(dt_vals)\n\n    # Metric 2: Low-wavenumber dispersion error\n    imags = np.imag(lambdas)\n    abs_imags = np.abs(imags)\n    nonzero_imags_mask = abs_imags > tol\n    \n    if not np.any(nonzero_imags_mask):\n        eps_disp = 0.0\n    else:\n        min_abs_imag = np.min(abs_imags[nonzero_imags_mask])\n        k1 = 2 * np.pi / L\n        ideal_phase_speed_mag = np.abs(a) * k1\n        if ideal_phase_speed_mag < tol: # handle a=0 case\n            eps_disp = 0.0 # Or undefined, but 0 is a reasonable convention\n        else:\n            eps_disp = min_abs_imag / ideal_phase_speed_mag - 1.0\n\n    # Metric 3: Maximum real part of eigenvalues\n    max_re = np.max(reals)\n    if abs(max_re) < tol:\n        max_re = 0.0\n\n    return dt_fe, eps_disp, max_re\n\ndef solve_case(L, a, Ne, P):\n    # Derived parameters\n    h = L / Ne\n    J = h / 2\n    N_nodes_per_elem = P + 1\n    Ndof = Ne * N_nodes_per_elem\n\n    # 1. Reference element data\n    lgl_nodes, lgl_weights = get_lgl_nodes_weights(P)\n    D_ref = get_barycentric_diff_matrix(lgl_nodes)\n    M_exact_ref = get_reference_exact_mass_matrix(P, lgl_nodes)\n    W_hat_ref_diag = lgl_weights\n\n    # 2. Global matrix assembly\n    M_exact = np.zeros((Ndof, Ndof))\n    M_lumped_diag = np.zeros(Ndof)\n    K = np.zeros((Ndof, Ndof))\n\n    e_minus = np.zeros(N_nodes_per_elem); e_minus[0] = 1.0\n    e_plus = np.zeros(N_nodes_per_elem); e_plus[-1] = 1.0\n\n    K_vol_ref = -np.diag(W_hat_ref_diag) @ D_ref\n\n    for e in range(Ne):\n        s = slice(e * N_nodes_per_elem, (e + 1) * N_nodes_per_elem)\n        \n        M_exact[s, s] = J * M_exact_ref\n        M_lumped_diag[s] = J * W_hat_ref_diag\n\n        K[s, s] += K_vol_ref\n\n        if a >= 0:\n            K[s, s] += np.outer(e_minus, e_minus)\n            e_prev = (e - 1 + Ne) % Ne\n            s_prev = slice(e_prev * N_nodes_per_elem, (e_prev + 1) * N_nodes_per_elem)\n            K[s, s_prev] += -np.outer(e_minus, e_plus)\n        else: # a < 0\n            K[s, s] += np.outer(e_plus, e_plus)\n            e_next = (e + 1) % Ne\n            s_next = slice(e_next * N_nodes_per_elem, (e_next + 1) * N_nodes_per_elem)\n            K[s, s_next] += -np.outer(e_plus, e_minus)\n\n    # 3. Construct system matrices A\n    M_exact_inv = np.linalg.inv(M_exact)\n    M_lumped_inv = np.diag(1.0 / M_lumped_diag)\n    \n    A_exact = a * (M_exact_inv @ K)\n    A_lumped = a * (M_lumped_inv @ K)\n\n    # 4. Eigenvalue analysis\n    lambdas_exact = np.linalg.eigvals(A_exact)\n    lambdas_lumped = np.linalg.eigvals(A_lumped)\n    \n    # 5. Compute metrics\n    metrics_exact = analyze_eigenvalues(lambdas_exact, a, L)\n    metrics_lumped = analyze_eigenvalues(lambdas_lumped, a, L)\n\n    return [\n        metrics_exact[0], metrics_lumped[0],\n        metrics_exact[1], metrics_lumped[1],\n        metrics_exact[2], metrics_lumped[2]\n    ]\n\ndef solve():\n    test_cases = [\n        (1.0, 1.0, 8, 4),    # Case 1\n        (1.0, 1.0, 2, 1),    # Case 2\n        (1.0, 1.0, 4, 8),    # Case 3\n        (1.0, -0.7, 6, 3),   # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        L, a, Ne, P = case\n        result_case = solve_case(L, a, Ne, P)\n        results.append(result_case)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}