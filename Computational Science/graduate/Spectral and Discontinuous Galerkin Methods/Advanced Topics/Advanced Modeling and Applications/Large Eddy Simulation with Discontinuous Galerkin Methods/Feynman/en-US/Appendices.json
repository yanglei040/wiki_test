{
    "hands_on_practices": [
        {
            "introduction": "To perform a Large Eddy Simulation, we must model the primary effect of the unresolved subgrid scales, which is to drain energy from the largest resolved scales. This hands-on problem grounds this abstract requirement in the fundamental theory of turbulence. By analyzing an idealized turbulent flow with a sharp spectral filter, you will derive the necessary eddy viscosity to properly model the energy cascade and maintain the celebrated Kolmogorov $k^{-5/3}$ energy spectrum, providing a first-principles basis for subgrid-scale modeling .",
            "id": "3394660",
            "problem": "Consider three-dimensional, homogeneous, isotropic turbulence in a periodic cube of side length $L$, simulated by Large Eddy Simulation (LES) with a Discontinuous Galerkin (DG) discretization. The LES filter is implemented as a spectral cutoff: in Fourier space, all modes with wavenumber magnitude $k$ larger than a cutoff $k_c$ are set to zero, and modes with $k \\leq k_c$ are retained. Let $E(k)$ denote the kinetic energy spectrum of the unfiltered turbulent flow, defined so that the resolved kinetic energy per unit mass is $\\int_{0}^{\\infty} E(k)\\,\\mathrm{d}k$. The filtered (resolved) spectrum is denoted $E_r(k)$.\n\nAssume a statistically stationary state with energy input at low wavenumbers and an inertial range described by the Kolmogorov spectrum $E(k) = C_K\\,\\epsilon^{2/3}\\,k^{-5/3}$ for $0<k<k_c$, where $\\epsilon$ is the energy cascade rate (equal to the energy flux across wavenumbers in the inertial range), and $C_K$ is the Kolmogorov constant. The DG discretization provides an effective resolution characterized by a known cutoff $k_c$ determined by the element size and polynomial degree.\n\nTo prevent energy pile-up near $k_c$ and to sustain the $k^{-5/3}$ inertial range for the resolved scales, a modeled dissipation term is added to the filtered momentum equations in the form $-\\nu_m\\,\\Delta \\mathbf{u}$, where $\\nu_m$ is a constant eddy viscosity coefficient to be determined.\n\nTasks:\n- Starting from the definition of the spectral cutoff filter, express $E_r(k)$ in terms of $E(k)$ and $k_c$ using a Heaviside function. Then, using the Fourier representation of $\\Delta$, determine the modeled rate of resolved kinetic energy removal (per unit mass) as an integral over wavenumbers in terms of $\\nu_m$ and $E_r(k)$.\n- Assuming the inertial-range form $E(k) = C_K\\,\\epsilon^{2/3}\\,k^{-5/3}$ for $0<k<k_c$, impose the stationarity condition that the total modeled dissipation of the resolved scales equals the inertial-range energy flux $\\epsilon$. Derive a closed-form analytic expression for $\\nu_m$ in terms of $\\epsilon$, $C_K$, and $k_c$.\n\nYour final answer must be a single closed-form analytic expression for the coefficient $\\nu_m$. No numerical evaluation is required.",
            "solution": "First, we address the expression for the filtered energy spectrum and the modeled rate of energy removal.\nThe LES filter is a sharp spectral cutoff at a wavenumber magnitude $k_c$. This means that Fourier modes of the velocity field are retained for wavenumber magnitudes $k \\leq k_c$ and are set to zero for $k > k_c$. The kinetic energy spectrum of the unfiltered flow is $E(k)$, and the filtered (resolved) spectrum is $E_r(k)$. Based on the filter definition, the resolved spectrum is identical to the unfiltered spectrum up to the cutoff and zero beyond it. This relationship can be expressed using the Heaviside step function, $H(x)$, defined as $H(x) = 1$ for $x \\geq 0$ and $H(x) = 0$ for $x < 0$. The resolved spectrum is thus:\n$$E_r(k) = E(k) H(k_c - k)$$\n\nNext, we determine the rate of kinetic energy removal by the modeled dissipation term. The problem states that a term $-\\nu_m\\,\\Delta \\mathbf{u}$ is added to the filtered momentum equations, where $\\mathbf{u}$ is the resolved velocity field and $\\nu_m$ is a constant eddy viscosity. The purpose of this term is to model the dissipation of energy from the resolved scales to the unresolved (subgrid) scales. The rate of change of resolved kinetic energy per unit mass due to this term is given by the average of its projection onto the velocity field, $\\langle \\mathbf{u} \\cdot (-\\nu_m\\,\\Delta \\mathbf{u}) \\rangle$. The modeled dissipation rate, $\\epsilon_m$, is the negative of this quantity, representing a positive removal of energy:\n$$\\epsilon_m = - \\langle \\mathbf{u} \\cdot (-\\nu_m\\,\\Delta \\mathbf{u}) \\rangle = \\nu_m \\langle \\mathbf{u} \\cdot \\Delta \\mathbf{u} \\rangle$$\nUsing integration by parts over the periodic domain (or Green's first identity), we have $\\langle \\mathbf{u} \\cdot \\Delta \\mathbf{u} \\rangle = - \\langle |\\nabla \\mathbf{u}|^2 \\rangle$. This yields $\\epsilon_m = -\\nu_m \\langle |\\nabla \\mathbf{u}|^2 \\rangle$. A positive definite dissipation requires a different sign convention in the momentum equation, i.e., adding $+\\nu_m \\Delta \\mathbf{u}$. A standard result from turbulence theory is that the total viscous dissipation rate is given by $\\epsilon_{\\nu} = 2\\nu \\int_0^\\infty k^2 E(k) \\, \\mathrm{d}k$. We adopt this form for the modeled dissipation. The discrepancy in sign is a matter of convention for where the term is placed in the momentum equation; the physical effect must be dissipation. Therefore, the modeled rate of kinetic energy removal per unit mass from the resolved scales is:\n$$\\epsilon_m = 2 \\nu_m \\int_{0}^{\\infty} k^2 E_r(k)\\,\\mathrm{d}k$$\nSubstituting the expression for $E_r(k)$, the integral's upper limit becomes $k_c$:\n$$\\epsilon_m = 2 \\nu_m \\int_{0}^{k_c} k^2 E(k)\\,\\mathrm{d}k$$\n\nSecond, we derive the expression for $\\nu_m$.\nThe problem assumes a statistically stationary state where the modeled dissipation rate exactly balances the energy flux $\\epsilon$ cascading through the inertial range. This provides the closure condition:\n$$\\epsilon_m = \\epsilon$$\nWe are given the Kolmogorov inertial-range spectrum for the unfiltered flow for $0 < k < k_c$:\n$$E(k) = C_K\\,\\epsilon^{2/3}\\,k^{-5/3}$$\nwhere $C_K$ is the Kolmogorov constant.\n\nWe substitute this spectral form into the integral for $\\epsilon_m$:\n$$\\epsilon = 2 \\nu_m \\int_{0}^{k_c} k^2 \\left( C_K\\,\\epsilon^{2/3}\\,k^{-5/3} \\right)\\,\\mathrm{d}k$$\nThe terms $C_K$ and $\\epsilon^{2/3}$ are constants with respect to the integration variable $k$ and can be moved outside the integral:\n$$\\epsilon = 2 \\nu_m C_K \\epsilon^{2/3} \\int_{0}^{k_c} k^2 k^{-5/3}\\,\\mathrm{d}k$$\nThe integrand simplifies to $k^{2 - 5/3} = k^{6/3 - 5/3} = k^{1/3}$. The equation becomes:\n$$\\epsilon = 2 \\nu_m C_K \\epsilon^{2/3} \\int_{0}^{k_c} k^{1/3}\\,\\mathrm{d}k$$\nWe now evaluate the definite integral:\n$$\\int_{0}^{k_c} k^{1/3}\\,\\mathrm{d}k = \\left[ \\frac{k^{1/3+1}}{1/3+1} \\right]_{0}^{k_c} = \\left[ \\frac{k^{4/3}}{4/3} \\right]_{0}^{k_c} = \\frac{3}{4} \\left( k_c^{4/3} - 0^{4/3} \\right) = \\frac{3}{4} k_c^{4/3}$$\nSubstituting this result back into the equation for $\\epsilon$:\n$$\\epsilon = 2 \\nu_m C_K \\epsilon^{2/3} \\left( \\frac{3}{4} k_c^{4/3} \\right)$$\n$$\\epsilon = \\frac{3}{2} \\nu_m C_K \\epsilon^{2/3} k_c^{4/3}$$\nFinally, we solve this algebraic equation for the eddy viscosity coefficient $\\nu_m$:\n$$\\nu_m = \\epsilon \\left( \\frac{2}{3 C_K \\epsilon^{2/3} k_c^{4/3}} \\right)$$\nSimplifying the terms involving $\\epsilon$:\n$$\\nu_m = \\frac{2}{3 C_K} \\frac{\\epsilon}{\\epsilon^{2/3}} k_c^{-4/3} = \\frac{2}{3 C_K} \\epsilon^{1 - 2/3} k_c^{-4/3}$$\n$$\\nu_m = \\frac{2}{3 C_K} \\epsilon^{1/3} k_c^{-4/3}$$\nThis is the closed-form analytic expression for the coefficient $\\nu_m$.",
            "answer": "$$ \\boxed{\\frac{2}{3 C_K} \\epsilon^{\\frac{1}{3}} k_c^{-\\frac{4}{3}}} $$"
        },
        {
            "introduction": "Unlike traditional LES which uses an explicit formula for subgrid effects, Implicit LES (ILES) leverages the inherent numerical dissipation of the discretization scheme. This practice offers a tangible way to explore how the Discontinuous Galerkin method acts as an implicit model . By using a reduced-order spectral model, you will investigate the sensitivity of the resolved energy spectrum and dissipation rate to key DG parameters like the polynomial order $p$, revealing how these choices control the scale-selectivity of the ILES approach.",
            "id": "3394693",
            "problem": "Consider the incompressible Navier–Stokes equations for a velocity field $u(x,t)$ in a periodic cubic domain of side length $L$,\n$$\n\\frac{\\partial u}{\\partial t} + (u\\cdot\\nabla)u = -\\nabla p + \\nu \\nabla^2 u,\\quad \\nabla\\cdot u = 0,\n$$\nand the kinetic energy spectrum $E(k,t)$ of homogeneous isotropic turbulence, defined so that the total kinetic energy per unit mass is\n$$\n\\mathcal{E}(t) = \\int_{0}^{\\infty} E(k,t)\\,dk.\n$$\nIn Large Eddy Simulation (LES), subgrid effects appear via a modeled dissipative term. In Implicit Large Eddy Simulation (ILES) using the Discontinuous Galerkin (DG) method, numerical stabilizations introduced by the inter-element flux act as a scale-selective dissipation without an explicit subgrid-scale model. For a polynomial representation of degree $p$ within each element and a monotone numerical flux characterized by a non-dimensional strength parameter $\\alpha$ (for example, a parameter related to the Lax–Friedrichs or Rusanov flux), the ILES mechanism is known to concentrate dissipation at high wavenumbers while leaving large scales comparatively unaffected.\n\nStarting from the energy balance for decaying homogeneous isotropic turbulence in the absence of external forcing, the spectral energy satisfies\n$$\n\\frac{\\partial E(k,t)}{\\partial t} = -2\\,\\nu_{\\mathrm{eff}}(k)\\,k^2\\,E(k,t),\n$$\nwhere $\\nu_{\\mathrm{eff}}(k)$ is an effective viscosity that aggregates physical viscosity and numerical dissipation. In ILES, the dominant contribution is the numerical component arising from DG fluxes and inter-element jumps, which is scale dependent. You are tasked with analyzing the sensitivity of ILES behavior to the polynomial order $p$ and the flux strength parameter $\\alpha$ by quantifying changes in the resolved spectra and dissipation for decaying homogeneous isotropic turbulence. Use the following modeling and numerical protocol:\n\n- Use a dimensionless domain of side length $L = 2\\pi$ and treat all quantities as dimensionless.\n- Represent the spectrum on integer wavenumbers $k \\in \\{1,2,\\dots,K_{\\max}\\}$ with $K_{\\max} = 64$.\n- Choose an initial spectrum of von Kármán form\n$$\nE(k,0) = C\\,k^4 \\exp\\!\\left(-2\\left(\\frac{k}{k_p}\\right)^2\\right),\n$$\nwith $k_p = K_{\\max}/4$ and $C$ selected so that $\\sum_{k=1}^{K_{\\max}} E(k,0) = 1$.\n- Consider a fixed mesh with $N_e = 32$ equally sized elements, so the element size is $h = L/N_e$.\n- Model the ILES effective viscosity due to DG stabilization as a scale-selective function that increases with wavenumber and flux strength while decreasing with polynomial order. Specifically, take\n$$\n\\nu_{\\mathrm{eff}}(k;p,\\alpha) = \\alpha\\,\\frac{h}{L}\\,\\frac{1}{p+1}\\left(\\frac{k}{K_{\\max}}\\right)^{2p+1}.\n$$\n- Evolve the spectrum for a final time $T = 1$ using the exact solution of the linear decay model:\n$$\nE(k,T) = E(k,0)\\,\\exp\\!\\left(-2\\,\\nu_{\\mathrm{eff}}(k;p,\\alpha)\\,k^2\\,T\\right).\n$$\n\nMetrics to compute for each parameter set $(p,\\alpha)$:\n1. A resolved spectral slope $m$ estimated by a least-squares linear fit of $\\log E(k,T)$ versus $\\log k$ over the wavenumber interval $k \\in [\\lfloor 0.2K_{\\max}\\rfloor, \\lfloor 0.5K_{\\max}\\rfloor]$. Report $m$ as a real number (no units).\n2. The total dissipated energy fraction $d$ defined by\n$$\nd = 1 - \\sum_{k=1}^{K_{\\max}} E(k,T),\n$$\nreported as a real number in decimal form.\n\nTest suite:\n- Case $1$: $(p,\\alpha) = (0, 0.3)$.\n- Case $2$: $(p,\\alpha) = (1, 0.3)$.\n- Case $3$: $(p,\\alpha) = (3, 0.3)$.\n- Case $4$: $(p,\\alpha) = (5, 0.3)$.\n- Case $5$: $(p,\\alpha) = (3, 0.9)$.\n\nYour program must:\n- Implement the above spectral model and compute the metrics $m$ and $d$ for each test case.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the metrics in the following order:\n$$\n[m_1, d_1, m_2, d_2, m_3, d_3, m_4, d_4, m_5, d_5],\n$$\nwhere $(m_i, d_i)$ corresponds to Case $i$, $i=1,\\dots,5$.\n\nNo angles are involved. All quantities are dimensionless. The output numbers must be formatted as real numbers (floats). The final time is $T=1$ and must be used exactly as specified.",
            "solution": "We begin with the incompressible Navier–Stokes equations for a velocity field $u(x,t)$ and pressure $p(x,t)$ in a periodic domain,\n$$\n\\frac{\\partial u}{\\partial t} + (u\\cdot\\nabla)u = -\\nabla p + \\nu \\nabla^2 u,\\quad \\nabla\\cdot u=0.\n$$\nFor homogeneous isotropic turbulence, the kinetic energy per unit mass can be represented by the spectral energy density $E(k,t)$, where\n$$\n\\mathcal{E}(t) = \\int_{0}^{\\infty} E(k,t)\\,dk,\n$$\nand the spectrum is typically aggregated over spherical shells of wavenumber magnitude $k$. In Large Eddy Simulation (LES), unresolved scales contribute an effective dissipation; in Implicit Large Eddy Simulation (ILES) with Discontinuous Galerkin (DG) methods, this effect arises from the numerical stabilization (e.g., monotone fluxes and interface penalties), producing an additional dissipative mechanism that is scale selective.\n\nPrinciple-based modeling of the ILES effect: We seek a reduced-order spectral model consistent with DG stabilization’s energy behavior. In DG schemes, the numerical flux at interfaces introduces dissipation proportional to inter-element jumps. For a polynomial degree $p$, the leading truncation error and interface jump amplitudes for a Fourier mode of wavenumber $k$ scale with $(kh)^{p+1}$, where $h$ is the element size. The dissipative term from a monotone flux (such as the Rusanov/Lax–Friedrichs flux) scales with a strength parameter $\\alpha$ times the jump amplitude squared, yielding an energy sink that grows rapidly with $k$. Mapping this into a spectral eddy viscosity concept, we construct a wavenumber-dependent effective viscosity $\\nu_{\\mathrm{eff}}(k)$ that captures the net rate at which the numerical scheme drains energy at scale $k$.\n\nA scale-selective form consistent with these principles is\n$$\n\\nu_{\\mathrm{eff}}(k;p,\\alpha) = \\alpha\\,\\frac{h}{L}\\,\\frac{1}{p+1}\\left(\\frac{k}{K_{\\max}}\\right)^{2p+1},\n$$\nwhere $L$ is the domain size, $h$ is the element size, $K_{\\max}$ is the maximum resolved wavenumber, $\\alpha$ is a non-dimensional flux strength parameter (controlling how aggressively the flux damps inter-element jumps), and $p$ is the polynomial order. The factor $\\left(\\frac{k}{K_{\\max}}\\right)^{2p+1}$ reflects that higher-order DG methods concentrate dissipation at the highest wavenumbers: for fixed $k/K_{\\max}<1$, increasing $p$ reduces $\\nu_{\\mathrm{eff}}$ at moderate wavenumbers but maintains strong dissipation very close to $K_{\\max}$. The prefactor $\\frac{1}{p+1}$ models the well-established trend that higher polynomial order reduces overall numerical dissipation at resolved scales. The factor $\\frac{h}{L}$ ensures consistent dimensionless scaling with mesh refinement within the periodic domain.\n\nEnergy decay model: For decaying homogeneous isotropic turbulence with no forcing, in a reduced model where the nonlinear transfer is not explicitly computed, a first-order approximation to the energy decay at each wavenumber due to viscosity is\n$$\n\\frac{\\partial E(k,t)}{\\partial t} = -2\\,\\nu_{\\mathrm{eff}}(k)\\,k^2\\,E(k,t).\n$$\nThis linear ordinary differential equation in time has an exact solution\n$$\nE(k,T) = E(k,0)\\,\\exp\\!\\left(-2\\,\\nu_{\\mathrm{eff}}(k)\\,k^2\\,T\\right),\n$$\nfor any final time $T$. Although this neglects inter-wavenumber energy transfer, it isolates the sensitivity of the numerical dissipation mechanism to $p$ and $\\alpha$, which is the target of the ILES sensitivity analysis.\n\nInitial spectrum: We choose a von Kármán spectrum\n$$\nE(k,0) = C\\,k^4 \\exp\\!\\left(-2\\left(\\frac{k}{k_p}\\right)^2\\right),\n$$\nwhere $k_p$ is the peak wavenumber and $C$ normalizes the discrete sum to unity:\n$$\n\\sum_{k=1}^{K_{\\max}} E(k,0) = 1.\n$$\nThis spectrum is widely used to represent a physically plausible distribution of energy across scales, with a rise at low $k$, a peak at $k_p$, and a rapid falloff at high $k$.\n\nMetrics: To quantify changes in resolved spectra and dissipation:\n1. The resolved spectral slope $m$ is computed by fitting $\\log E(k,T)$ versus $\\log k$ over an intermediate range $k \\in [\\lfloor 0.2K_{\\max}\\rfloor, \\lfloor 0.5K_{\\max}\\rfloor]$ using least squares. This interval avoids very low $k$ where finite-size effects dominate and very high $k$ where cut-off and extreme damping dominate. The slope $m$ reflects the steepness of the resolved spectrum.\n2. The total dissipated energy fraction $d$ is\n$$\nd = 1 - \\sum_{k=1}^{K_{\\max}} E(k,T),\n$$\nwhich, given the normalization $\\sum_{k=1}^{K_{\\max}} E(k,0) = 1$, measures the fraction of initial energy that has been removed by numerical dissipation by time $T$.\n\nAlgorithmic design:\n- Set $L=2\\pi$, $K_{\\max}=64$, $k_p=K_{\\max}/4$, $N_e=32$, and $h=L/N_e$.\n- Construct the discrete array $k=1,2,\\dots,K_{\\max}$.\n- Form the unnormalized $E(k,0)$ and compute $C$ by dividing by the discrete sum so that the total energy is unity.\n- For each test case $(p,\\alpha)$, compute $\\nu_{\\mathrm{eff}}(k;p,\\alpha)$, then $E(k,T)$ using the exact decay formula with $T=1$.\n- Compute $m$ via least-squares linear regression of $\\log E$ versus $\\log k$ on the specified $k$ interval.\n- Compute $d$ via the discrete sum.\n- Aggregate the outputs in the specified order:\n$$\n[m_1, d_1, m_2, d_2, m_3, d_3, m_4, d_4, m_5, d_5].\n$$\n\nInterpretation: Increasing $\\alpha$ should increase $\\nu_{\\mathrm{eff}}$ across scales, steepening the spectrum and increasing $d$. Increasing $p$ generally reduces dissipation at moderate wavenumbers (due to the $(p+1)^{-1}$ prefactor and the stronger scale selectivity), potentially flattening the resolved spectrum (less steep $m$ in the chosen range) and decreasing $d$, while still concentrating damping near $K_{\\max}$. The chosen test suite covers boundary behavior ($p=0$), the effect of polynomial order ($p=1,3,5$), and a high-flux edge case ($\\alpha=0.9$) at $p=3$.\n\nAll quantities are dimensionless, and no angles are involved. The final time is $T=1$ and is used directly. The program prints a single line containing the metrics for the five cases in the specified order.",
            "answer": "```python\nimport numpy as np\n\ndef initial_spectrum(Kmax, kp):\n    k = np.arange(1, Kmax + 1, dtype=float)\n    E0 = (k**4) * np.exp(-2.0 * (k / kp) ** 2)\n    E0 /= E0.sum()  # Normalize total energy to 1\n    return k, E0\n\ndef nu_eff(k, Kmax, p, alpha, h, L):\n    # Effective viscosity model for ILES-DG:\n    # nu_eff(k; p, alpha) = alpha * (h/L) * 1/(p+1) * (k/Kmax)^(2p+1)\n    scale_selective = (k / Kmax) ** (2 * p + 1)\n    nu = alpha * (h / L) * (scale_selective) / (p + 1)\n    return nu\n\ndef evolve_spectrum(E0, k, nu, T):\n    # Exact solution of dE/dt = -2 * nu(k) * k^2 * E\n    decay = np.exp(-2.0 * nu * (k ** 2) * T)\n    return E0 * decay\n\ndef resolved_slope(E, k, Kmax):\n    # Fit log E vs log k over [floor(0.2*Kmax), floor(0.5*Kmax)]\n    k_min = int(np.floor(0.2 * Kmax))\n    k_max = int(np.floor(0.5 * Kmax))\n    # indices in 1-based k; Python uses 0-based\n    k_slice = np.arange(k_min, k_max + 1)\n    Ek = E[k_slice - 1]\n    kk = k_slice.astype(float)\n    # Guard against numerical underflow: ensure positivity\n    Ek = np.maximum(Ek, np.finfo(float).tiny)\n    x = np.log(kk)\n    y = np.log(Ek)\n    # Least squares fit y = m x + b\n    A = np.vstack([x, np.ones_like(x)]).T\n    m, b = np.linalg.lstsq(A, y, rcond=None)[0]\n    return m\n\ndef total_dissipation_fraction(E):\n    # Initial energy sum is 1 by construction\n    return 1.0 - E.sum()\n\ndef run_case(p, alpha, params):\n    L = params['L']\n    Kmax = params['Kmax']\n    kp = params['kp']\n    Ne = params['Ne']\n    T = params['T']\n    h = L / Ne\n\n    k, E0 = initial_spectrum(Kmax, kp)\n    nu = nu_eff(k, Kmax, p, alpha, h, L)\n    ET = evolve_spectrum(E0, k, nu, T)\n    m = resolved_slope(ET, k, Kmax)\n    d = total_dissipation_fraction(ET)\n    return m, d\n\ndef solve():\n    params = {\n        'L': 2.0 * np.pi,\n        'Kmax': 64,\n        'kp': 64 / 4,\n        'Ne': 32,\n        'T': 1.0,\n    }\n    # Test suite: (p, alpha)\n    test_cases = [\n        (0, 0.3),  # Case 1: boundary polynomial order\n        (1, 0.3),  # Case 2: low order\n        (3, 0.3),  # Case 3: moderate order\n        (5, 0.3),  # Case 4: high order\n        (3, 0.9),  # Case 5: high flux parameter\n    ]\n\n    results = []\n    for p, alpha in test_cases:\n        m, d = run_case(p, alpha, params)\n        results.append(f\"{m:.6f}\")\n        results.append(f\"{d:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "The fidelity of an LES depends critically on ensuring that the numerical method does not introduce non-physical artifacts that corrupt the solution. This exercise focuses on a key challenge in DG methods: the potential for energy generation, or backscatter, arising from the inexact quadrature of nonlinear terms . You will analyze this aliasing effect for the Burgers' equation and design a diagnostic to detect when under-integration leads to a non-physical increase in resolved energy, a crucial skill for developing robust DG-LES solvers.",
            "id": "3394720",
            "problem": "Consider a one-dimensional periodic domain with coordinate $x \\in [0, 2\\pi]$ measured in radians. Let the resolved field be approximated by a Discontinuous Galerkin (DG) polynomial of degree $p$ per element over a uniform mesh of $N$ elements. As a surrogate for the nonlinear convective mechanism in Large Eddy Simulation (LES) with Discontinuous Galerkin methods, use the inviscid Burgers equation\n$$\nu_t + \\left( \\frac{u^2}{2} \\right)_x = 0,\n$$\nposed with periodic boundary conditions and a smooth initial condition\n$$\nu(x,0) = \\sin(x) + 0.25\\sin(3x) + 0.1\\sin(5x).\n$$\nAssume the DG approximation on each element is expressed in the Legendre polynomial basis on the reference interval $r \\in [-1, 1]$ via\n$$\nu_h(x) \\big|_K = \\sum_{n=0}^{p} \\hat{u}_n^{(K)} L_n\\!\\left( r(x) \\right),\n$$\nwhere $L_n(r)$ is the $n$-th Legendre polynomial, $K$ indexes elements, and $r(x)$ is the affine map from the physical element to the reference interval. The element length is $h = \\frac{2\\pi}{N}$, and the Jacobian satisfies $\\mathrm{d}x = \\frac{h}{2}\\,\\mathrm{d}r$ and $\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{2}{h}\\frac{\\mathrm{d}}{\\mathrm{d}r}$.\n\nStart from the conservation law energy identity for smooth periodic solutions:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{0}^{2\\pi} \\frac{u^2}{2}\\,\\mathrm{d}x = \\int_{0}^{2\\pi} \\frac{u^2}{2}\\,u_x\\,\\mathrm{d}x = \\frac{1}{6}\\int_{0}^{2\\pi} (u^3)_x\\,\\mathrm{d}x = 0.\n$$\nIn the DG discretization with test function $v = u_h$, the semi-discrete elementwise energy rate in weak form can be written as\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{K} \\frac{u_h^2}{2}\\,\\mathrm{d}x = \\int_{K} \\frac{u_h^2}{2}\\, (u_h)_x\\,\\mathrm{d}x \\;-\\; \\Big[ f^*(u_h)\\,u_h \\Big]_{\\partial K},\n$$\nwhere $f(u)=\\frac{u^2}{2}$ and $f^*(u_h)$ is a consistent numerical flux. If the approximate solution is globally continuous at element interfaces (as supplied by pointwise interpolation of the smooth initial condition at shared nodes) and the domain is periodic, the sum over elements of the boundary term telescopes, leaving the global resolved energy rate controlled by the volume integrals,\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{0}^{2\\pi} \\frac{u_h^2}{2}\\,\\mathrm{d}x = \\sum_{K} \\int_{K} \\frac{u_h^2}{2}\\, (u_h)_x\\,\\mathrm{d}x.\n$$\nWhen the volume integral is evaluated exactly, smooth periodic solutions yield zero resolved energy change. However, in practical DG-LES, volume integrals are computed using quadrature. Under-integration of the nonlinear volume term can introduce quadrature aliasing and nonphysical energy transfer (backscatter), which manifests as a positive resolved energy increment $\\Delta E > 0$ over a time step.\n\nFor a DG polynomial degree $p$, the integrand $\\frac{u_h^2}{2} (u_h)_x$ is a polynomial of degree $3p-1$ in the reference coordinate. An $n$-point Legendre-Gauss quadrature exactly integrates polynomials up to degree $2n-1$. Therefore, exact evaluation of the volume integral requires $2n-1 \\geq 3p-1$, i.e., $n \\geq \\frac{3p}{2}$, whereas choosing $n  \\frac{3p}{2}$ leads to under-integration and possible backscatter.\n\nYour tasks are:\n1. Derive from first principles the discrete resolved energy rate for the above DG approximation and show how quadrature order determines whether the volume integral is exact or under-integrated.\n2. Design a diagnostic that flags nonphysical energy transfer based on the resolved energy increment\n$$\n\\Delta E = \\Delta t \\sum_{K} \\int_{K} \\frac{u_h^2}{2}\\,(u_h)_x\\,\\mathrm{d}x,\n$$\ncomputed using a specified quadrature of order $q_{\\mathrm{vol}}$. Use a small, dimensionless time step $\\Delta t$ and define the detection rule as “backscatter detected” if and only if $\\Delta E > 0$. Express the resolved energy and the increment in dimensionless units.\n\nImplement a program that:\n- Constructs the polynomial DG approximation via $L^2$ projection of the given initial condition onto the Legendre basis on each element using a sufficiently high-order quadrature for projection.\n- Computes the initial resolved energy\n$$\nE_0 = \\int_{0}^{2\\pi} \\frac{u_h^2}{2}\\,\\mathrm{d}x\n$$\nusing a sufficiently high-order quadrature to represent the “true” resolved energy of the polynomial approximation.\n- Computes the discrete resolved energy production rate\n$$\nR(q_{\\mathrm{vol}}) = \\sum_{K} \\int_{K} \\frac{u_h^2}{2}\\,(u_h)_x\\,\\mathrm{d}x\n$$\nusing an $q_{\\mathrm{vol}}$-point Legendre-Gauss quadrature.\n- Forms $\\Delta E = \\Delta t \\, R(q_{\\mathrm{vol}})$ and the diagnostic flag $d = 1$ if $\\Delta E > 0$ and $d = 0$ otherwise.\n\nUse the following test suite of parameter sets $(p, N, q_{\\mathrm{vol}}, \\Delta t)$:\n- Case A (happy path under-integration): $(3, 8, 4, 10^{-3})$.\n- Case B (over-integration): $(3, 8, 8, 10^{-3})$.\n- Case C (moderate under-integration at higher degree): $(4, 8, 5, 10^{-3})$.\n- Case D (low degree near-exact integration): $(1, 4, 2, 10^{-3})$.\n- Case E (severe under-integration): $(5, 16, 3, 10^{-3})$.\n\nYour program should produce a single line of output containing a comma-separated list of results for these five cases. For each case, output the ordered pair $[\\Delta E, d]$ as a list, with $\\Delta E$ a floating-point number and $d$ an integer $0$ or $1$. The final output format must be a single line of the form\n$$\n\\texttt{[[}\\Delta E_A\\texttt{,}d_A\\texttt{],[}\\Delta E_B\\texttt{,}d_B\\texttt{],[}\\Delta E_C\\texttt{,}d_C\\texttt{],[}\\Delta E_D\\texttt{,}d_D\\texttt{],[}\\Delta E_E\\texttt{,}d_E\\texttt{]]}\n$$\nwith no extra text or spaces.",
            "solution": "The problem requires the validation of a diagnostic for non-physical energy generation (backscatter) in a Discontinuous Galerkin (DG) approximation of the inviscid Burgers' equation. This diagnostic is based on the effect of quadrature order on the semi-discrete energy conservation properties.\n\n### Part 1: Derivation of the Discrete Resolved Energy Rate\n\nThe problem is posed on a periodic domain $x \\in [0, 2\\pi]$ with the inviscid Burgers' equation, a standard model for nonlinear convection:\n$$\nu_t + \\left( \\frac{u^2}{2} \\right)_x = 0\n$$\nFor smooth, periodic solutions, the total kinetic energy $E = \\int_{0}^{2\\pi} \\frac{u^2}{2} dx$ is conserved. This is shown by multiplying the PDE by $u$ and integrating over the domain:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_{0}^{2\\pi} u u_t dx = -\\int_{0}^{2\\pi} u \\left( \\frac{u^2}{2} \\right)_x dx = -\\int_{0}^{2\\pi} \\left( \\frac{u^3}{3} \\right)_x dx = -\\frac{1}{3} \\left[ u^3 \\right]_{0}^{2\\pi} = 0\n$$\nAn alternative grouping leads to the form used in the problem:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_{0}^{2\\pi} u u_t dx = \\int_{0}^{2\\pi} \\frac{(u^2)_t}{2} dx = \\int_{0}^{2\\pi} \\frac{u^2}{2} u_x dx = \\int_{0}^{2\\pi} \\left(\\frac{u^3}{6}\\right)_x dx = \\frac{1}{6} [u^3]_0^{2\\pi} = 0.\n$$\n\nIn a DG method, the solution $u$ is approximated by a piecewise polynomial function $u_h$. To derive the semi-discrete energy rate, we start from a weak formulation. We multiply the PDE by a test function $v_h$ (which is a polynomial in the same space as $u_h$) and integrate by parts over a single element $K$:\n$$\n\\int_K v_h (u_h)_t dx + \\int_K v_h \\left( \\frac{u_h^2}{2} \\right)_x dx = 0\n$$\n$$\n\\int_K v_h (u_h)_t dx = - \\left[ v_h f^*(u_h) \\right]_{\\partial K} + \\int_K (v_h)_x f(u_h) dx\n$$\nwhere $f(u_h) = \\frac{u_h^2}{2}$ and $f^*(u_h)$ is a numerical flux function that couples adjacent elements. To analyze the energy evolution, we choose the test function to be the solution itself, $v_h = u_h$:\n$$\n\\int_K u_h (u_h)_t dx = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K \\frac{u_h^2}{2} dx = \\int_K (u_h)_x \\frac{u_h^2}{2} dx - \\left[ u_h f^*(u_h) \\right]_{\\partial K}\n$$\nThis is the semi-discrete energy rate for a single element, which matches the form given in the problem. The problem then posits a special case where the boundary flux terms telescope away when summed over all elements, isolating the volume integral term as the sole contributor to the global energy change:\n$$\n\\frac{\\mathrm{d}E_h}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{0}^{2\\pi} \\frac{u_h^2}{2} dx = \\sum_K \\int_K \\frac{u_h^2}{2} (u_h)_x dx\n$$\nThis quantity is defined as the discrete resolved energy production rate, $R = \\sum_K \\int_K \\frac{u_h^2}{2} (u_h)_x dx$.\n\nThe effect of quadrature is now critical. On each element, $u_h$ is a polynomial of degree $p$. The spatial derivative $(u_h)_x$ is a polynomial of degree $p-1$. Therefore, the integrand $\\frac{u_h^2}{2} (u_h)_x$ is a polynomial of degree $2p + (p-1) = 3p-1$. A $q$-point Legendre-Gauss quadrature rule integrates polynomials of degree up to $2q-1$ exactly. For exact evaluation of the volume integral, we require:\n$$\n2q - 1 \\geq 3p - 1 \\implies q \\geq \\frac{3p}{2}\n$$\nIf this condition is not met, i.e., $q  \\frac{3p}{2}$, the integral is under-integrated. Aliasing errors can occur, where the energy from high-wavenumber modes in the integrand (which should integrate to zero or a small value) is incorrectly added to lower-wavenumber modes, often manifesting as a net positive energy production, $\\Delta E > 0$.\n\n### Part 2: Diagnostic Design and Implementation\n\nThe diagnostic is designed to quantify this effect. The implementation proceeds as follows:\n\n1.  **Discretization Setup**: The domain $[0, 2\\pi]$ is divided into $N$ elements $K_k$ of length $h = \\frac{2\\pi}{N}$. For each test case $(p, N, q_{\\mathrm{vol}}, \\Delta t)$, the polynomial degree is $p$.\n\n2.  **$L^2$ Projection**: The initial DG approximation $u_h(x,0)$ is constructed by performing an $L^2$ projection of the given initial condition $u(x,0) = \\sin(x) + 0.25\\sin(3x) + 0.1\\sin(5x)$ onto the Legendre polynomial basis on each element $K_k$. The Legendre coefficients $\\{\\hat{u}_n^{(k)}\\}_{n=0}^p$ for element $k$ are computed as:\n    $$\n    \\hat{u}_n^{(k)} = \\frac{\\langle u(x,0), L_n(r(x)) \\rangle}{\\langle L_n(r(x)), L_n(r(x)) \\rangle} = \\frac{\\int_{K_k} u(x,0) L_n(r(x)) dx}{\\int_{K_k} L_n(r(x))^2 dx}\n    $$\n    Transforming to the reference interval $r \\in [-1, 1]$ and using the orthogonality property $\\int_{-1}^1 L_n(r)^2 dr = \\frac{2}{2n+1}$, this becomes:\n    $$\n    \\hat{u}_n^{(k)} = \\frac{2n+1}{2} \\int_{-1}^1 u(x(r), 0) L_n(r) dr\n    $$\n    This integral is computed numerically using a high-order Gauss-Legendre quadrature (with $q_{proj} > p$ points) to ensure an accurate projection.\n\n3.  **Energy Rate Calculation**: The discrete resolved energy production rate $R(q_{\\mathrm{vol}})$ is computed by summing the volume integrals over all elements, where each integral is approximated using a $q_{\\mathrm{vol}}$-point Gauss-Legendre quadrature. For each element $k$, the integral is:\n    $$\n    \\int_{K_k} \\frac{u_h^2}{2} (u_h)_x dx = \\int_{-1}^1 \\frac{u_h^{(k)}(r)^2}{2} \\left( \\frac{2}{h} \\frac{d u_h^{(k)}}{dr} \\right) \\frac{h}{2} dr = \\int_{-1}^1 \\frac{u_h^{(k)}(r)^2}{2} \\frac{d u_h^{(k)}}{dr} dr\n    $$\n    where $u_h^{(k)}(r) = \\sum_{n=0}^p \\hat{u}_n^{(k)} L_n(r)$. The quadrature approximation is:\n    $$\n    R_k(q_{\\mathrm{vol}}) \\approx \\sum_{j=1}^{q_{\\mathrm{vol}}} w_j \\left( \\frac{u_h^{(k)}(r_j)^2}{2} \\frac{d u_h^{(k)}}{dr}(r_j) \\right)\n    $$\n    where $(r_j, w_j)$ are the $q_{\\mathrm{vol}}$ quadrature points and weights. The total rate is $R(q_{\\mathrm{vol}}) = \\sum_{k=0}^{N-1} R_k(q_{\\mathrm{vol}})$.\n\n4.  **Diagnostic Evaluation**: The resolved energy increment is calculated as $\\Delta E = \\Delta t \\cdot R(q_{\\mathrm{vol}})$. The diagnostic flag $d$ is set to $1$ if $\\Delta E > 0$ and $0$ otherwise. This flag signals the detection of backscatter.\n\nThe following Python program implements this procedure for the given test cases. For cases with under-integration (A, C, E), we expect to find $\\Delta E > 0$ and $d=1$. For cases with exact or over-integration (B, D), $\\Delta E$ should be small and its sign will depend on the discretization error from the $L^2$ projection's discontinuities, but it is not expected to show the systematic positive sign of aliasing-induced backscatter.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.legendre import Legendre, leggauss\n\ndef solve():\n    \"\"\"\n    Computes the resolved energy increment and backscatter flag for a DG\n    discretization of the Burgers' equation for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (p, N, q_vol, dt)\n        (3, 8, 4, 1.0e-3),   # Case A: p=3, 3p/2=4.5. q=4  4.5 - under-integration\n        (3, 8, 8, 1.0e-3),   # Case B: p=3, 3p/2=4.5. q=8  4.5 - over-integration\n        (4, 8, 5, 1.0e-3),   # Case C: p=4, 3p/2=6.0. q=5  6.0 - under-integration\n        (1, 4, 2, 1.0e-3),   # Case D: p=1, 3p/2=1.5. q=2  1.5 - exact integration\n        (5, 16, 3, 1.0e-3),  # Case E: p=5, 3p/2=7.5. q=3  7.5 - severe under-integration\n    ]\n\n    results = []\n\n    def u0_func(x):\n        \"\"\"The smooth initial condition u(x,0).\"\"\"\n        return np.sin(x) + 0.25 * np.sin(3 * x) + 0.1 * np.sin(5 * x)\n\n    for p, N, q_vol, dt in test_cases:\n        # Mesh parameters\n        h = 2.0 * np.pi / N\n        \n        # Use a high-order quadrature for accurate L2 projection.\n        # A rule that is exact for polynomials of degree 2p+1 or higher is sufficient\n        # to accurately project a smooth function. 2p+2 points is a safe choice.\n        q_proj = 2 * p + 2\n        r_proj, w_proj = leggauss(q_proj)\n        \n        # Pre-compute Legendre basis polynomial evaluations for projection\n        L_basis_at_proj_pts = np.array([Legendre.basis(n)(r_proj) for n in range(p + 1)])\n\n        u_coeffs_all_elements = np.zeros((N, p + 1))\n\n        # 1. Construct the DG approximation via L^2 projection\n        for k in range(N):\n            x_k = k * h\n            \n            # Map reference coordinates to physical coordinates for this element\n            x_proj_pts = x_k + (h / 2.0) * (r_proj + 1.0)\n            \n            # Evaluate u0 at quadrature points\n            u0_at_pts = u0_func(x_proj_pts)\n            \n            # Project to get Legendre coefficients for element k\n            for n in range(p + 1):\n                # Numerator of projection: u0, L_n\n                # Integral in ref coords: integral(u0(x(r)) * L_n(r) * h/2 dr)\n                # We need integral(u0(x(r)) * L_n(r) dr) for the formula.\n                L_n_at_pts = L_basis_at_proj_pts[n]\n                integral_val = np.sum(w_proj * u0_at_pts * L_n_at_pts)\n                \n                # Formula for L2 projection coefficient: hat_u_n = (2n+1)/2 * integral\n                u_coeffs_all_elements[k, n] = (2 * n + 1) / 2.0 * integral_val\n        \n        # 2. Compute the discrete resolved energy production rate R(q_vol)\n        r_vol, w_vol = leggauss(q_vol)\n        total_energy_rate = 0.0\n        \n        for k in range(N):\n            u_coeffs = u_coeffs_all_elements[k, :]\n            \n            # Create polynomial objects for u_h and its derivative on the element\n            u_h_poly = Legendre(u_coeffs)\n            u_h_deriv_r_poly = u_h_poly.deriv()\n\n            # Evaluate polynomials at the volume quadrature points\n            u_h_vals = u_h_poly(r_vol)\n            u_h_deriv_r_vals = u_h_deriv_r_poly(r_vol)\n            \n            # The integrand is integral[(u_h^2 / 2) * (u_h)_r dr]\n            # (u_h)_x = (2/h) * (u_h)_r, and dx = (h/2) dr\n            # The multiplication of Jacobians (2/h) * (h/2) cancels.\n            integrand_ref_coord = 0.5 * u_h_vals**2 * u_h_deriv_r_vals\n            \n            # Use quadrature to compute the integral over the element\n            element_integral = np.sum(w_vol * integrand_ref_coord)\n            \n            total_energy_rate += element_integral\n            \n        # 3. Calculate Delta_E and the diagnostic flag d\n        delta_E = dt * total_energy_rate\n        d = 1 if delta_E  1e-15 else 0 # Use a small tolerance for floating-point zero.\n        \n        results.append([delta_E, d])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'[{e:.6e},{flag}]' for e, flag in results])}]\")\n\nsolve()\n```"
        }
    ]
}