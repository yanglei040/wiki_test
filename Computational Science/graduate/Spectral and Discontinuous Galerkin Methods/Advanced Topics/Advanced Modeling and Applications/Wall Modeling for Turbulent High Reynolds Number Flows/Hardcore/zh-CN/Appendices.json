{
    "hands_on_practices": [
        {
            "introduction": "壁面模型的核心通常是壁面律。本练习将指导您完成构建一个功能性壁面模型的基本过程，这对于高雷诺数流动的大涡模拟（LES）至关重要。您将推导摩擦速度 $u_{\\tau}$ 的隐式方程并实现一个数值求解器，从而巩固您将物理定律转化为计算工具的理解，并学会分析模型对经验常数的敏感性。",
            "id": "3427246",
            "problem": "考虑一个不可压缩、充分发展的湍流平面槽道流，该流场采用高阶谱元法（SEM, Spectral Element Method）或间断伽辽金法（DG, Discontinuous Galerkin）离散化，并使用大涡模拟（LES, Large Eddy Simulation）进行仿真，其中第一个离壁解点位于壁面单位距离 $y^{+}\\approx 50$ 处。需要一个最小功能性壁面模型，以便在不解析粘性子层的情况下，为数值格式提供壁面剪切应力 $\\tau_{w}$。您需要构建并实现以下模型及相关的敏感度分析，作为一个自包含的程序。\n\n从壁面标度的标准定义出发：\n- 摩擦速度 $u_{\\tau}$ 满足 $\\tau_{w}=\\rho\\,u_{\\tau}^{2}$，\n- 内尺度标度的速度为 $U^{+}=U/u_{\\tau}$，\n- 内尺度标度的法向壁面距离为 $y^{+}=y\\,u_{\\tau}/\\nu$，\n以及重叠层的对数壁面律：\n$$\nU^{+}=\\frac{1}{\\kappa}\\ln(y^{+})+B,\n$$\n推导一个关于未知数 $u_{\\tau}$ 的非线性方程，该方程用可测量的局部LES解析的流向速度大小 $U$、法向壁面距离 $y$、运动粘度 $\\nu$、流体密度 $\\rho$ 以及模型常数 $\\kappa$ 和 $B$ 来表示。通过分析所得标量残差的单调性，确立物理上可接受的解 $u_{\\tau}0$ 的存在性和唯一性。\n\n然后，设计一个仅基于第一性原理的稳健求根算法来计算给定参数下的 $u_{\\tau}$。您的算法必须使用一种区间限定策略，以保证对任何正输入都能收敛，并且可以结合二分法与牛顿更新，或使用受保护的二分法。一旦求得 $u_{\\tau}$，计算以帕斯卡为单位的壁面剪切应力 $\\tau_{w}$（最终的 $\\tau_{w}$ 以 $\\mathrm{Pa}$ 表示），并通过对您的非线性方程进行隐式微分来量化 $\\tau_{w}$ 对模型常数的敏感度，以获得归一化敏感度：\n$$\nS_{\\kappa}=\\frac{\\partial \\ln \\tau_{w}}{\\partial \\kappa},\\qquad S_{B}=\\frac{\\partial \\ln \\tau_{w}}{\\partial B}.\n$$\n清楚地说明这些敏感度的表达式，用收敛的 $u_{\\tau}$ 和输入参数表示。\n\n您的程序必须为每个测试案例实现以下内容：\n1. 根据上述模型，由所提供的 $U$、$y$、$\\nu$、$\\rho$、$\\kappa$ 和 $B$ 构造非线性方程。\n2. 使用具有显式区间限定的全局收敛标量求根程序求解 $u_{\\tau}$。\n3. 计算 $\\tau_{w}=\\rho\\,u_{\\tau}^{2}$，单位为 $\\mathrm{Pa}$。\n4. 使用在收敛的 $u_{\\tau}$ 处求值的解析推导的隐式微分公式，计算归一化敏感度 $S_{\\kappa}$ 和 $S_{B}$。\n\n使用以下参数值测试套件（涵盖一个代表性案例、一个接近缓冲层的低 $y^{+}$ 对数律边缘案例、一个粗糙首点案例，以及用于敏感度评估的模型常数变化案例）。所有量必须以国际单位制（SI）解释：\n- 案例 A（$y^{+}\\approx 50$ 的代表性空气流）：$U=8.0\\,\\mathrm{m/s}$，$y=0.002\\,\\mathrm{m}$，$\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}$，$\\rho=1.2\\,\\mathrm{kg/m^{3}}$，$\\kappa=0.41$，$B=5.2$。\n- 案例 B（水中的近缓冲层边缘案例）：$U=0.608\\,\\mathrm{m/s}$，$y=0.0002\\,\\mathrm{m}$，$\\nu=1.0\\times 10^{-6}\\,\\mathrm{m^{2}/s}$，$\\rho=1000.0\\,\\mathrm{kg/m^{3}}$，$\\kappa=0.41$，$B=5.2$。\n- 案例 C（空气流的粗糙首点案例）：$U=6.08\\,\\mathrm{m/s}$，$y=0.005\\,\\mathrm{m}$，$\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}$，$\\rho=1.2\\,\\mathrm{kg/m^{3}}$，$\\kappa=0.41$，$B=5.2$。\n- 案例 D（用于探究敏感度的模型常数变化）：$U=8.0\\,\\mathrm{m/s}$，$y=0.002\\,\\mathrm{m}$，$\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^{2}/s}$，$\\rho=1.2\\,\\mathrm{kg/m^{3}}$，$\\kappa=0.384$，$B=4.17$。\n\n要求和数值细节：\n- 您的推导必须仅从核心定义 $U^{+}=U/u_{\\tau}$、$y^{+}=y\\,u_{\\tau}/\\nu$、$\\tau_{w}=\\rho u_{\\tau}^{2}$ 和对数律 $U^{+}=(1/\\kappa)\\ln(y^{+})+B$ 开始；不要假设任何其他经验性封闭模型。\n- 对于数值解，确保 $u_{\\tau}$ 的正性，并通过证明残差在 $u_{\\tau}\\to 0^{+}$ 时为正，且对于足够大的 $u_{\\tau}$ 为负，来限定根的区间。\n- 将每个案例的最终输出表示为一个包含三个浮点数 $[\\tau_{w},S_{\\kappa},S_{B}]$ 的列表，其中 $\\tau_{w}$ 的单位是 $\\mathrm{Pa}$，$S_{\\kappa}$ 和 $S_{B}$ 是无量纲的。不涉及角度。不要在数值输出中包含单位。\n- 您的程序应生成单行输出，其中包含所有四个案例的结果，形式为一个逗号分隔的列表，并用方括号括起来，每个案例贡献一个内部列表。例如，您的最终输出必须具有 $[[\\tau_{w}^{(A)},S_{\\kappa}^{(A)},S_{B}^{(A)}],[\\tau_{w}^{(B)},S_{\\kappa}^{(B)},S_{B}^{(B)}],[\\tau_{w}^{(C)},S_{\\kappa}^{(C)},S_{B}^{(C)}],[\\tau_{w}^{(D)},S_{\\kappa}^{(D)},S_{B}^{(D)}]]$ 的形式，其中包含浮点数。",
            "solution": "在进行求解之前，对问题陈述的有效性进行严格评估。\n\n### 步骤 1：提取给定条件\n- **背景**：不可压缩、充分发展的湍流平面槽道流。\n- **模拟方法**：大涡模拟（LES），采用高阶谱元法（SEM）或间断伽辽金法（DG）。\n- **壁面模型位置**：第一个离壁点位于 $y^{+} \\approx 50$。\n- **目标**：构建一个功能性壁面模型以计算壁面剪切应力 $\\tau_{w}$。\n- **基本定义**：\n    1. 摩擦速度定义：$\\tau_{w} = \\rho u_{\\tau}^{2}$。\n    2. 内尺度标度的速度：$U^{+} = U/u_{\\tau}$。\n    3. 内尺度标度的法向壁面距离：$y^{+} = y u_{\\tau}/\\nu$。\n- **经验定律**：对数壁面律，$U^{+} = \\frac{1}{\\kappa}\\ln(y^{+}) + B$。\n- **输入参数**：流向速度 $U$、法向壁面距离 $y$、运动粘度 $\\nu$、流体密度 $\\rho$。\n- **模型常数**：von Kármán 常数 $\\kappa$、对数律截距 $B$。\n- **主要未知数**：摩擦速度 $u_{\\tau}$。\n- **任务**：\n    1. 推导一个关于 $u_{\\tau}$ 的非线性方程。\n    2. 证明物理上可接受的解 $u_{\\tau}  0$ 的存在性和唯一性。\n    3. 设计一个稳健的、基于区间限定的求根算法。\n    4. 计算 $\\tau_{w}$，单位为帕斯卡（$\\mathrm{Pa}$）。\n    5. 推导并计算归一化敏感度 $S_{\\kappa} = \\frac{\\partial \\ln \\tau_{w}}{\\partial \\kappa}$ 和 $S_{B} = \\frac{\\partial \\ln \\tau_{w}}{\\partial B}$。\n- **测试案例（国际单位制）**：\n    - **案例 A**：$U=8.0$, $y=0.002$, $\\nu=1.5 \\times 10^{-5}$, $\\rho=1.2$, $\\kappa=0.41$, $B=5.2$。\n    - **案例 B**：$U=0.608$, $y=0.0002$, $\\nu=1.0 \\times 10^{-6}$, $\\rho=1000.0$, $\\kappa=0.41$, $B=5.2$。\n    - **案例 C**：$U=6.08$, $y=0.005$, $\\nu=1.5 \\times 10^{-5}$, $\\rho=1.2$, $\\kappa=0.41$, $B=5.2$。\n    - **案例 D**：$U=8.0$, $y=0.002$, $\\nu=1.5 \\times 10^{-5}$, $\\rho=1.2$, $\\kappa=0.384$, $B=4.17$。\n- **输出格式**：对每个案例，输出一个包含三个浮点数 $[\\tau_{w}, S_{\\kappa}, S_{B}]$ 的列表。最终输出是包含这些列表的单行列表。\n\n### 步骤 2：使用提取的给定条件进行验证\n根据验证标准评估该问题。\n- **科学依据**：该问题基于湍流边界层理论的基本原理，特别是壁面律，这是LES中壁面建模的基石。所用的定义和关系是流体力学中的标准内容。所有物理参数和常数都是现实的。\n- **适定性**：该问题是适定的（well-posed）。它要求推导并求解一个关于单一未知数 $u_{\\tau}$ 的单一非线性标量方程。计算所需的所有输入（$U$, $y$, $\\nu$, $\\rho$, $\\kappa$, $B$）均已提供。分析解的存在性/唯一性以及计算敏感度是标准的数学步骤。\n- **客观性**：问题以精确、技术性和无偏见的语言陈述，不含任何主观性论断。\n\n该问题没有表现出任何已定义的无效性缺陷。它在科学上是合理的、可形式化的、完整的、现实的且结构良好。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整的解决方案。\n\n### 解的推导与分析\n\n**1. $u_{\\tau}$ 的非线性方程推导**\n\n我们从对数壁面律开始：\n$$\nU^{+} = \\frac{1}{\\kappa}\\ln(y^{+}) + B\n$$\n将内尺度量的定义代入此方程：\n$$\n\\frac{U}{u_{\\tau}} = \\frac{1}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + B\n$$\n其中 $U$、$y$、$\\nu$、$\\kappa$ 和 $B$ 是已知参数，$u_{\\tau}$ 是未知变量。这就是摩擦速度 $u_{\\tau}$ 的隐式非线性方程。为了数值求解，我们定义一个残差函数 $f(u_{\\tau})$，其根即为解。为了稳健性并与问题关于区间限定的建议保持一致，我们将残差定义为：\n$$\nf(u_{\\tau}) = U - u_{\\tau} \\left[ \\frac{1}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + B \\right]\n$$\n壁面模型的解即为使 $f(u_{\\tau}) = 0$ 的 $u_{\\tau}  0$ 值。\n\n**2. 解的存在性与唯一性**\n\n为确立物理上可接受的解（$u_{\\tau}  0$）的存在性和唯一性，我们分析残差函数 $f(u_{\\tau})$ 的行为。\n\n- **当 $u_{\\tau} \\to 0^{+}$ 时的行为**：\n项 $u_{\\tau}\\ln(u_{\\tau})$ 是一个 $0 \\cdot (-\\infty)$ 的不定式。我们使用洛必达法则（L'Hôpital's rule）分析其极限：\n$$\n\\lim_{u_{\\tau} \\to 0^{+}} u_{\\tau}\\ln(u_{\\tau}) = \\lim_{u_{\\tau} \\to 0^{+}} \\frac{\\ln(u_{\\tau})}{1/u_{\\tau}} = \\lim_{u_{\\tau} \\to 0^{+}} \\frac{1/u_{\\tau}}{-1/u_{\\tau}^2} = \\lim_{u_{\\tau} \\to 0^{+}} (-u_{\\tau}) = 0\n$$\n将此结果应用于我们的残差函数：\n$$\n\\lim_{u_{\\tau} \\to 0^{+}} f(u_{\\tau}) = U - \\lim_{u_{\\tau} \\to 0^{+}} \\left[ \\frac{u_{\\tau}}{\\kappa} \\left(\\ln\\left(\\frac{y}{\\nu}\\right) + \\ln(u_{\\tau})\\right) + B u_{\\tau} \\right] = U - 0 = U\n$$\n由于速度 $U$ 是严格为正的，所以当 $u_{\\tau}$ 从右侧趋近于 $0$ 时，$f(u_{\\tau})$ 是正的。\n\n- **当 $u_{\\tau} \\to \\infty$ 时的行为**：\n当 $u_{\\tau}$ 变得非常大时，对数项 $\\ln(u_{\\tau})$ 也会增长，但比 $u_{\\tau}$ 慢。乘积 $u_{\\tau}\\ln(u_{\\tau})$ 增长到无穷大。因此：\n$$\n\\lim_{u_{\\tau} \\to \\infty} f(u_{\\tau}) = U - \\infty = -\\infty\n$$\n\n- **单调性**：\n我们考察 $f(u_{\\tau})$ 对 $u_{\\tau}$ 的导数：\n$$\nf'(u_{\\tau}) = \\frac{d}{du_{\\tau}} \\left( U - \\frac{u_{\\tau}}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) - B u_{\\tau} \\right)\n$$\n对 $\\frac{u_{\\tau}}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right)$ 项使用乘积法则：\n$$\nf'(u_{\\tau}) = - \\left[ \\left(\\frac{1}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + \\frac{u_{\\tau}}{\\kappa}\\frac{1}{u_{\\tau}}\\right) + B \\right] = - \\left[ \\frac{1}{\\kappa}\\ln(y^{+}) + \\frac{1}{\\kappa} + B \\right]\n$$\n对数律应用于重叠层，其中 $y^{+}$ 足够大（例如 $y^{+}  30$）以使 $\\ln(y^{+})$ 为正。模型常数 $\\kappa$ 和 $B$ 也为正。因此，对于任何物理相关的 $u_{\\tau}$，方括号内的项都严格为正。这意味着对于所有 $u_{\\tau}  0$，都有 $f'(u_{\\tau})  0$。\n\n- **结论**：\n函数 $f(u_{\\tau})$ 在 $u_{\\tau}  0$ 上连续，当 $u_{\\tau} \\to 0^{+}$ 时为正，当 $u_{\\tau} \\to \\infty$ 时趋于 $-\\infty$，并且是严格单调递减的。根据介值定理（Intermediate Value Theorem），必须至少存在一个根。因为函数是严格单调的，所以这个根是唯一的。这保证了物理上可接受的解 $u_{\\tau}  0$ 的存在性和唯一性。\n\n**3. 敏感度表达式推导**\n\n我们需要求归一化敏感度 $S_{\\kappa} = \\frac{\\partial \\ln \\tau_{w}}{\\partial \\kappa}$ 和 $S_{B} = \\frac{\\partial \\ln \\tau_{w}}{\\partial B}$。\n由 $\\tau_{w} = \\rho u_{\\tau}^2$ 可得 $\\ln \\tau_{w} = \\ln \\rho + 2 \\ln u_{\\tau}$。对参数 $p$（$p$ 为 $\\kappa$ 或 $B$）求导，得到：\n$$\n\\frac{\\partial \\ln \\tau_{w}}{\\partial p} = \\frac{2}{u_{\\tau}} \\frac{\\partial u_{\\tau}}{\\partial p}\n$$\n我们通过对控制方程 $G(u_{\\tau}, \\kappa, B) = 0$ 进行隐式微分来找到 $\\frac{\\partial u_{\\tau}}{\\partial p}$：\n$$\nG = \\frac{U}{u_{\\tau}} - \\frac{1}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) - B = 0\n$$\n隐式微分的一般公式为 $\\frac{\\partial u_{\\tau}}{\\partial p} = - \\frac{\\partial G/\\partial p}{\\partial G/\\partial u_{\\tau}}$。\n首先，我们计算关于 $u_{\\tau}$ 的偏导数：\n$$\n\\frac{\\partial G}{\\partial u_{\\tau}} = -\\frac{U}{u_{\\tau}^2} - \\frac{1}{\\kappa u_{\\tau}} = -\\frac{1}{u_{\\tau}} \\left(\\frac{U}{u_{\\tau}} + \\frac{1}{\\kappa}\\right)\n$$\n接下来，我们计算关于 $\\kappa$ 和 $B$ 的偏导数：\n$$\n\\frac{\\partial G}{\\partial \\kappa} = \\frac{1}{\\kappa^2}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right)\n\\quad , \\quad\n\\frac{\\partial G}{\\partial B} = -1\n$$\n现在我们可以求出敏感度。\n\n- **对 $B$ 的敏感度**：\n$$\n\\frac{\\partial u_{\\tau}}{\\partial B} = - \\frac{-1}{-\\frac{1}{u_{\\tau}} \\left(\\frac{U}{u_{\\tau}} + \\frac{1}{\\kappa}\\right)} = -\\frac{u_{\\tau}}{U/u_{\\tau} + 1/\\kappa}\n$$\n归一化敏感度 $S_B$ 则为：\n$$\nS_{B} = \\frac{2}{u_{\\tau}} \\frac{\\partial u_{\\tau}}{\\partial B} = \\frac{2}{u_{\\tau}} \\left( -\\frac{u_{\\tau}}{U/u_{\\tau} + 1/\\kappa} \\right) = -\\frac{2}{U/u_{\\tau} + 1/\\kappa}\n$$\n\n- **对 $\\kappa$ 的敏感度**：\n$$\n\\frac{\\partial u_{\\tau}}{\\partial \\kappa} = - \\frac{\\frac{1}{\\kappa^2}\\ln(y u_{\\tau}/\\nu)}{-\\frac{1}{u_{\\tau}} \\left(\\frac{U}{u_{\\tau}} + \\frac{1}{\\kappa}\\right)} = \\frac{u_{\\tau} \\ln(y u_{\\tau}/\\nu)}{\\kappa^2 (U/u_{\\tau} + 1/\\kappa)}\n$$\n为简化起见，我们利用在解处 $\\frac{1}{\\kappa}\\ln(y u_{\\tau}/\\nu) = U/u_{\\tau} - B$ 这一事实。\n$$\n\\frac{\\partial u_{\\tau}}{\\partial \\kappa} =  \\frac{u_{\\tau} \\kappa(U/u_{\\tau} - B)}{\\kappa^2 (U/u_{\\tau} + 1/\\kappa)} = \\frac{u_{\\tau}(U/u_{\\tau} - B)}{\\kappa (U/u_{\\tau} + 1/\\kappa)}\n$$\n归一化敏感度 $S_\\kappa$ 则为：\n$$\nS_{\\kappa} = \\frac{2}{u_{\\tau}} \\frac{\\partial u_{\\tau}}{\\partial \\kappa} = \\frac{2(U/u_{\\tau} - B)}{\\kappa (U/u_{\\tau} + 1/\\kappa)}\n$$\n这些 $S_B$ 和 $S_\\kappa$ 的最终表达式仅依赖于收敛解 $u_{\\tau}$ 和输入参数，并且计算效率高。\n\n**4. 数值实现策略**\n$f(u_{\\tau})=0$ 的唯一根可以使用区间限定算法稳健地找到。\n- **区间**：我们已经确定当 $u_{\\tau} \\to 0^{+}$ 时 $f(u_{\\tau})0$，而当 $u_{\\tau}$ 很大时 $f(u_{\\tau})0$。一个合适的区间是 $[u_{low}, u_{high}]$。我们可以为 $u_{low}$ 选择一个小的正数（例如，$10^{-8}$），为 $u_{high}$ 选择可测量的速度 $U$，因为物理上预期 $u_{\\tau} \\ll U$。测试计算证实，对于给定的参数范围，$f(U)0$。\n- **算法**：像 Brent 法这样的标准全局收敛算法是理想的。该方法在 `SciPy` 中以 `scipy.optimize.brentq` 的形式提供，它结合了二分法的安全性与割线法和反二次插值法的速度，使其既稳健又高效。\n- **流程**：对于每个测试案例，程序将：\n    1. 定义残差函数 $f(u_{\\tau})$。\n    2. 使用 `brentq` 在区间 $[10^{-8}, U]$ 内求解 $u_{\\tau}$。\n    3. 计算 $\\tau_{w} = \\rho u_{\\tau}^2$。\n    4. 使用在计算出的 $u_{\\tau}$ 处求值的解析公式计算 $S_{\\kappa}$ 和 $S_{B}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for wall shear stress and model sensitivities for a series of test cases\n    based on a logarithmic law of the wall model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (U, y, nu, rho, kappa, B) in SI units.\n    test_cases = [\n        # Case A: representative air flow\n        (8.0, 0.002, 1.5e-5, 1.2, 0.41, 5.2),\n        # Case B: near-buffer edge case in water\n        (0.608, 0.0002, 1.0e-6, 1000.0, 0.41, 5.2),\n        # Case C: coarse first-point air case\n        (6.08, 0.005, 1.5e-5, 1.2, 0.41, 5.2),\n        # Case D: model-constant variation to probe sensitivity\n        (8.0, 0.002, 1.5e-5, 1.2, 0.384, 4.17),\n    ]\n\n    results = []\n    \n    # Machine epsilon can be used for a robust lower bound close to zero.\n    machine_epsilon = np.finfo(float).eps\n\n    for case in test_cases:\n        U, y, nu, rho, kappa, B = case\n\n        # 1. Form the nonlinear equation f(u_tau) = 0\n        # The residual function f(u_tau) = U - u_tau * ( (1/kappa)*ln(y*u_tau/nu) + B )\n        # is defined for u_tau > 0.\n        def residual(u_tau):\n            # Check for domain of log\n            if u_tau = 0:\n                # Return a large positive value to guide the solver away from non-physical domain,\n                # consistent with the limit of the function as u_tau -> 0+.\n                return U\n            \n            y_plus_term = y * u_tau / nu\n            log_term = np.log(y_plus_term)\n            u_plus = (1.0 / kappa) * log_term + B\n            \n            return U - u_tau * u_plus\n\n        # 2. Solve for u_tau using a globally convergent scalar root-finding procedure.\n        # We bracket the root. As shown in the derivation, the residual is positive\n        # for u_tau -> 0+ and becomes negative for large u_tau. U itself serves\n        # as a safe upper bound, since u_tau  U in all physical flows.\n        lower_bound = machine_epsilon # A small positive number\n        upper_bound = U # Physical upper bound\n        \n        try:\n            # Brent's method is robust and guarantees convergence if the root is bracketed.\n            u_tau = optimize.brentq(residual, lower_bound, upper_bound, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This should not happen given the analysis of the residual function.\n            # However, it is good practice to handle potential solver failures.\n            u_tau = np.nan\n            tau_w = np.nan\n            S_kappa = np.nan\n            S_B = np.nan\n            results.append([tau_w, S_kappa, S_B])\n            continue\n\n        # 3. Compute tau_w in Pascals.\n        tau_w = rho * u_tau**2\n\n        # 4. Compute the normalized sensitivities S_kappa and S_B.\n        # These formulas were derived via implicit differentiation.\n        U_over_u_tau = U / u_tau\n        \n        # Denominator for both sensitivities\n        common_denominator = U_over_u_tau + (1.0 / kappa)\n        \n        # Sensitivity to B\n        S_B = -2.0 / common_denominator\n        \n        # Sensitivity to kappa\n        # This form is computationally efficient as it reuses U_over_u_tau\n        S_kappa = (2.0 * (U_over_u_tau - B)) / (kappa * common_denominator)\n        \n        results.append([tau_w, S_kappa, S_B])\n\n    # Format the final output string as per the problem specification.\n    # e.g., [[val1,val2,val3],[val4,val5,val6],...]\n    results_str_parts = []\n    for res in results:\n        # Format each float to a reasonable precision for clean output.\n        results_str_parts.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    final_output_str = f\"[{','.join(results_str_parts)}]\"\n\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在实现了数值方法后，对照已知的物理原理验证其结果至关重要。本练习将对比在槽道流中计算壁面剪切应力的两种不同方法。通过比较由全局动量平衡（通过压力梯度）和由局部速度梯度（通过您的数值解）推导出的壁面应力 $\\tau_w$，您将深入理解离散化的自洽性与准确性，这是计算流体力学中一项关键的验证技能。",
            "id": "3427267",
            "problem": "考虑一个统计定常、充分发展的不可压缩平面槽道湍流，其半高为 $\\delta$，由流向上恒定的平均压力梯度 $\\mathrm{d}p/\\mathrm{d}x$ 驱动。该流动在一个邻近壁面的仿射映射壁面法向单元上，使用高阶间断Galerkin (DG) 方法进行解析。给定空气的以下数据：密度 $\\rho$、动力粘度 $\\mu$、体速度 $U_{b}$、槽道半高 $\\delta$ 和压力梯度 $\\mathrm{d}p/\\mathrm{d}x$：\n- $\\rho = 1.20$,\n- $\\mu = 1.80 \\times 10^{-5}$,\n- $U_{b} = 10.0$,\n- $\\delta = 0.05$,\n- $\\mathrm{d}p/\\mathrm{d}x = -4.00$,\n所有量均采用国际单位制 (SI)，压力梯度与流向一致，因此 $x$ 沿下游方向增加。\n\n根据第一性原理，对于充分发展的槽道流，平均总剪切应力 $\\langle \\tau_{\\text{tot}} \\rangle(y)$ 满足 $\\mathrm{d}\\langle \\tau_{\\text{tot}} \\rangle/\\mathrm{d}y = \\mathrm{d}p/\\mathrm{d}x$，壁面剪切应力 $\\tau_{w}$ 通过 $\\tau_{w} = \\delta \\left(-\\mathrm{d}p/\\mathrm{d}x\\right)$ 与压力梯度相关。摩擦速度定义为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，槽道流的表面摩擦系数定义为 $C_{f} = 2 \\tau_{w}/\\left(\\rho U_{b}^{2}\\right)$。\n\n另外，DG壁面邻近单元的物理厚度为 $h_{e} = 1.00 \\times 10^{-3}$，通过 $y(\\xi) = \\frac{h_{e}}{2}(\\xi+1)$ 从参考坐标 $\\xi \\in [-1,1]$ 映射到物理坐标 $y$。该单元上的平均流向速度在 Legendre 多项式模态基中表示为\n$$\nu_{h}(\\xi) = \\sum_{k=0}^{3} a_{k} P_{k}(\\xi),\n$$\n其中 $P_{k}$ 是 Legendre 多项式，满足 $P_{0}(\\xi) = 1$、$P_{1}(\\xi) = \\xi$、$P_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2}-1\\right)$ 和 $P_{3}(\\xi) = \\frac{1}{2}\\left(5\\xi^{3} - 3\\xi\\right)$。模态系数指定为\n- $a_{0} = \\frac{991}{180}$,\n- $a_{1} = \\frac{50}{9}$,\n- $a_{2} = \\frac{1}{20}$,\n- $a_{3} = 0$,\n需要理解的是，无滑移边界条件通过数值通量在壁面处被弱施加，使得在 $\\xi=-1$ 处的多项式迹与壁面值一致。\n\n仅使用上述定义和平衡关系，按以下步骤进行：\n1) 计算基于压力梯度的摩擦速度 $u_{\\tau}^{(p)}$ 和相关的表面摩擦系数 $C_{f}^{(p)}$。\n2) 使用 DG 多项式，通过映射和 Legendre 基，计算在 $\\xi=-1$ 处壁面上的壁面法向速度梯度 $\\left.\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right|_{w}$。然后估算基于梯度的壁面剪切应力 $\\tau_{w}^{(g)} = \\mu \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right|_{w}$ 以及相应的摩擦速度 $u_{\\tau}^{(g)} = \\sqrt{\\tau_{w}^{(g)}/\\rho}$ 和表面摩擦系数 $C_{f}^{(g)}$。\n3) 定义无量纲比 $R = u_{\\tau}^{(p)}/u_{\\tau}^{(g)}$。报告 $R$ 的值，四舍五入到四位有效数字。你最终报告的量必须是单个数字 $R$，并且必须是无量纲的。不要在最终答案中报告任何单位。",
            "solution": "用户提供了一个计算流体力学领域的良态问题，要求比较从两个不同物理原理导出的壁面剪切应力量：全局动量平衡和来自数值近似的局部速度梯度。该问题是有效的，因为它具有科学依据、内容自洽，并提供了所有必要数据。我们将按要求分三部分进行求解。\n\n所有量均以国际单位制 (SI) 表示。给定的参数是：\n- 密度: $\\rho = 1.20$\n- 动力粘度: $\\mu = 1.80 \\times 10^{-5}$\n- 体速度: $U_{b} = 10.0$\n- 槽道半高: $\\delta = 0.05$\n- 平均压力梯度: $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -4.00$\n- DG 单元厚度: $h_{e} = 1.00 \\times 10^{-3}$\n\n目标是计算比率 $R = u_{\\tau}^{(p)}/u_{\\tau}^{(g)}$，其中 $u_{\\tau}^{(p)}$ 是从压力梯度导出的摩擦速度，而 $u_{\\tau}^{(g)}$ 是从 DG 近似的近壁速度梯度导出的摩擦速度。\n\n**1. 基于压力梯度的量计算**\n\n在充分发展的平面槽道流中，壁面剪切应力 $\\tau_{w}$ 通过积分动量平衡与平均压力梯度相关。问题给出了直接关系式：\n$$\n\\tau_{w}^{(p)} = \\delta \\left(-\\frac{\\mathrm{d}p}{\\mathrm{d}x}\\right)\n$$\n代入 $\\delta$ 和 $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$ 的给定值：\n$$\n\\tau_{w}^{(p)} = (0.05) \\left(-(-4.00)\\right) = 0.05 \\times 4.00 = 0.20\n$$\n单位是帕斯卡，或 $\\mathrm{N}/\\mathrm{m}^2$。\n\n摩擦速度 $u_{\\tau}$ 定义为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$。使用基于压力梯度的壁面剪切应力，我们求得 $u_{\\tau}^{(p)}$：\n$$\nu_{\\tau}^{(p)} = \\sqrt{\\frac{\\tau_{w}^{(p)}}{\\rho}} = \\sqrt{\\frac{0.20}{1.20}} = \\sqrt{\\frac{1}{6}}\n$$\n\n**2. 基于梯度的量计算**\n\n第二种方法假设流体为牛顿流体，从壁面处的局部速度梯度估算壁面剪切应力：\n$$\n\\tau_{w}^{(g)} = \\mu \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right|_{w}\n$$\n速度剖面 $u_{h}$ 作为参考坐标 $\\xi \\in [-1,1]$ 的函数给出：\n$$\nu_{h}(\\xi) = \\sum_{k=0}^{3} a_{k} P_{k}(\\xi)\n$$\n物理坐标 $y$ 通过 $y(\\xi) = \\frac{h_{e}}{2}(\\xi+1)$ 从 $\\xi$ 映射而来，壁面位于 $y=0$，对应于 $\\xi=-1$。\n\n为求物理梯度 $\\frac{\\mathrm{d}u}{\\mathrm{d}y}$，我们应用链式法则：\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}y} = \\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi} \\frac{\\mathrm{d}\\xi}{\\mathrm{d}y}\n$$\n首先，我们求映射导数，即变换的雅可比：\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}\\xi} = \\frac{\\mathrm{d}}{\\mathrm{d}\\xi}\\left(\\frac{h_{e}}{2}(\\xi+1)\\right) = \\frac{h_{e}}{2}\n$$\n这是一个常数。其逆为 $\\frac{\\mathrm{d}\\xi}{\\mathrm{d}y} = \\frac{2}{h_{e}}$。\n\n接下来，我们求速度剖面关于 $\\xi$ 的导数：\n$$\n\\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi} = \\sum_{k=0}^{3} a_{k} \\frac{\\mathrm{d}P_{k}}{\\mathrm{d}\\xi}(\\xi)\n$$\n给定 Legendre 多项式的导数是：\n$P'_{0}(\\xi) = 0$, $P'_{1}(\\xi) = 1$, $P'_{2}(\\xi) = 3\\xi$, $P'_{3}(\\xi) = \\frac{1}{2}(15\\xi^2 - 3)$.\n我们计算此导数在壁面处 $\\xi=-1$ 的值：\n$$\n\\left.\\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = a_{0}P'_{0}(-1) + a_{1}P'_{1}(-1) + a_{2}P'_{2}(-1) + a_{3}P'_{3}(-1)\n$$\n$$\n\\left.\\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = a_{0}(0) + a_{1}(1) + a_{2}(3(-1)) + a_{3}\\left(\\frac{1}{2}(15(-1)^2 - 3)\\right)\n$$\n$$\n\\left.\\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = a_{1} - 3a_{2} + a_{3}\\left(\\frac{15 - 3}{2}\\right) = a_{1} - 3a_{2} + 6a_{3}\n$$\n代入给定的模态系数 $a_{1} = \\frac{50}{9}$、$a_{2} = \\frac{1}{20}$ 和 $a_{3} = 0$：\n$$\n\\left.\\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\frac{50}{9} - 3\\left(\\frac{1}{20}\\right) + 6(0) = \\frac{50}{9} - \\frac{3}{20} = \\frac{50 \\times 20 - 3 \\times 9}{180} = \\frac{1000 - 27}{180} = \\frac{973}{180}\n$$\n现在，我们计算壁面处的物理速度梯度：\n$$\n\\left.\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right|_{w} = \\left(\\left.\\frac{\\mathrm{d}u_h}{\\mathrm{d}\\xi}\\right|_{\\xi=-1}\\right) \\left(\\frac{\\mathrm{d}\\xi}{\\mathrm{d}y}\\right) = \\left(\\frac{973}{180}\\right) \\left(\\frac{2}{h_{e}}\\right)\n$$\n当 $h_{e} = 1.00 \\times 10^{-3}$ 时：\n$$\n\\left.\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right|_{w} = \\frac{973}{180} \\times \\frac{2}{1.00 \\times 10^{-3}} = \\frac{973}{90} \\times 10^{3} = \\frac{97300}{9}\n$$\n那么，基于梯度的壁面剪切应力是：\n$$\n\\tau_{w}^{(g)} = \\mu \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right|_{w} = (1.80 \\times 10^{-5}) \\left(\\frac{97300}{9}\\right)\n$$\n$$\n\\tau_{w}^{(g)} = \\left(\\frac{1.80}{9}\\right) \\times 10^{-5} \\times 97300 = 0.20 \\times 10^{-5} \\times 97300 = 0.20 \\times 0.973 = 0.1946\n$$\n基于梯度的摩擦速度 $u_{\\tau}^{(g)}$ 是：\n$$\nu_{\\tau}^{(g)} = \\sqrt{\\frac{\\tau_{w}^{(g)}}{\\rho}} = \\sqrt{\\frac{0.1946}{1.20}}\n$$\n\n**3. 比率 R 的计算**\n\n最后一步是计算无量纲比 $R$：\n$$\nR = \\frac{u_{\\tau}^{(p)}}{u_{\\tau}^{(g)}} = \\frac{\\sqrt{\\tau_{w}^{(p)}/\\rho}}{\\sqrt{\\tau_{w}^{(g)}/\\rho}} = \\sqrt{\\frac{\\tau_{w}^{(p)}}{\\tau_{w}^{(g)}}}\n$$\n代入两种壁面剪切应力的计算值：\n$$\nR = \\sqrt{\\frac{0.20}{0.1946}} \\approx \\sqrt{1.027749229} \\approx 1.01377967\n$$\n问题要求将此值四舍五入到四位有效数字。\n$$\nR \\approx 1.014\n$$\n这个接近 1 的值表明，施加于流场的压力梯度与壁面处速度场的局部数值表示所预测的剪切应力之间具有良好的一致性。",
            "answer": "$$\n\\boxed{1.014}\n$$"
        },
        {
            "introduction": "正如前一个练习所示，近壁面梯度的计算精度至关重要，但它可能受到数值伪影的影响。本练习深入探讨了混淆（aliasing），这是基于多项式的方法中常见的误差来源。通过一个构造解，您将亲眼看到不充分的数值积分如何导致投影量出现虚假误差，从而学会诊断此类问题并选择合适的数值策略（如超积分）来确保高阶模拟的保真度。",
            "id": "3427163",
            "problem": "考虑邻近固壁的第一个单元内的一维壁面法向流，该流动由坐标 $y \\in [0,1]$ 参数化，其中壁面位于 $y=0$ 处。设该单元内的近壁速度剖面由以下人工场表示\n$$\nu(y) = u_{1}\\, y + c\\, \\phi_{2p}(y),\n$$\n其中 $u_{1}  0$ 和 $c \\neq 0$ 是常数，$p \\in \\mathbb{N}$ 是局部逼近空间选定的多项式次数，$\\phi_{n}(y) = P_{n}(2y-1)$ 表示由 $[-1,1]$ 上的勒让德多项式 $P_{n}(x)$ 构成的 $n$ 次移位勒让德多项式。此单元中的间断伽辽金 (DG) 逼近使用模态基 $\\{\\phi_{n}\\}_{n=0}^{p}$ 并计算 $L^{2}$ 投影系数\n$$\na_{n} = \\frac{\\int_{0}^{1} u(y)\\, \\phi_{n}(y)\\, dy}{\\int_{0}^{1} \\phi_{n}(y)^{2}\\, dy}, \\quad n=0,1,\\dots,p,\n$$\n通过使用具有 $N_{q}$ 个点的高斯-洛巴托-勒让德 (GLL) 求积来代替积分。已知具有 $N_{q}$ 个点的 GLL 法则能够精确积分最高为 $2N_{q}-3$ 次的任意多项式被积函数。从投影多项式 $u_{p}(y)=\\sum_{n=0}^{p} a_{n}\\, \\phi_{n}(y)$ 推断出的壁面法向梯度为\n$$\n\\left.\\frac{\\partial u_{p}}{\\partial y}\\right|_{y=0} = \\sum_{n=0}^{p} a_{n}\\, \\phi'_{n}(0).\n$$\n\n从勒让德多项式在 $[0,1]$ 上关于标准 $L^{2}$ 内积的正交性出发，以及精确积分得出对于 $m \\neq n$ 有 $\\int_{0}^{1} \\phi_{m}(y)\\, \\phi_{n}(y)\\, dy = 0$ 这一事实，完成以下任务：\n\n1. 证明在精确积分下，未解析分量 $\\phi_{2p}(y)$ 与所有 $n \\leq p$ 的 $\\phi_{n}(y)$ 正交，因此 $c\\, \\phi_{2p}(y)$ 对 DG 投影系数 $a_{n}$ 的贡献对于所有 $n \\leq p$ 均为零，从而 $y=0$ 处的壁面法向梯度恰好等于 $u_{1}$。\n\n2. 证明当使用具有 $N_{q} = p+1$ 个点（次数为 $p$ 时的标准配置点选择）的 GLL 求积计算投影积分时，对于 $n \\leq p$ 的正交性积分 $\\int_{0}^{1} \\phi_{2p}(y)\\, \\phi_{n}(y)\\, dy$ 不必被精确积分，因为对于某些 $n$，被积函数次数为 $2p+n$，超过了精确度次数 $2N_{q}-3=2p-1$。由此得出结论：混叠会产生虚假的非零 $a_{n}$ ($n \\leq p$)，从而污染 $\\left.\\partial u_{p}/\\partial y\\right|_{y=0}$。\n\n3. 推导所需的 GLL 求积点最小数量 $N_{q}$，以保证对于所有 $n=0,1,\\dots,p$ 的内积 $\\int_{0}^{1} \\phi_{2p}(y)\\, \\phi_{n}(y)\\, dy$ 都能被精确积分，使得 $c\\, \\phi_{2p}(y)$ 对投影多项式的混叠贡献消失，且 $\\left.\\partial u_{p}/\\partial y\\right|_{y=0}$ 保持等于 $u_{1}$。将 $N_{q}$ 表示为 $p$ 的闭式函数。\n\n此外，从一个模型非线性守恒律（如通量为 $f(u)=\\tfrac{1}{2}u^{2}$ 的粘性 Burgers 方程）的弱形式出发，概述单元内的一种对称分裂形式（通量差分）如何通过用一个强制执行离散分部求和性质的斜对称离散替换 $\\partial_{y} f(u)$ 来消除体项中的二次混叠。您的推导必须从弱形式以及 DG 体项和面项的定义开始。任何简化公式未经推导不得假定使用。最终需要报告的数值答案仅为最小 $N_{q}$ 作为 $p$ 的函数。最终答案无需四舍五入，也不涉及单位。",
            "solution": "问题陈述已经过验证，被认为是偏微分方程数值分析领域中一个适定、有科学依据的问题。所有必要信息均已提供，问题结构逻辑清晰，可通过严格的数学推导得到解答。\n\n该问题研究了间断伽辽金(DG)方法中因人工解的表示和投影所用求积法而产生的混叠误差。它包括三个部分，分析了壁面法向速度梯度计算中的混叠误差，第四部分概述了一种减轻非线性问题中混叠的技术。\n\n**第1部分：精确积分**\n\nDG 逼近计算人工速度场 $u(y) = u_{1}\\, y + c\\, \\phi_{2p}(y)$ 在基 $\\{\\phi_{n}\\}_{n=0}^{p}$ 上的 $L^{2}$ 投影系数 $a_{n}$。在精确积分下，系数的公式为：\n$$\na_{n} = \\frac{\\int_{0}^{1} u(y)\\, \\phi_{n}(y)\\, dy}{\\int_{0}^{1} \\phi_{n}(y)^{2}\\, dy}\n$$\n代入 $u(y)$ 的表达式，我们得到：\n$$\na_{n} = \\frac{\\int_{0}^{1} (u_{1}\\, y + c\\, \\phi_{2p}(y))\\, \\phi_{n}(y)\\, dy}{\\int_{0}^{1} \\phi_{n}(y)^{2}\\, dy} = \\frac{u_{1} \\int_{0}^{1} y\\, \\phi_{n}(y)\\, dy}{\\int_{0}^{1} \\phi_{n}(y)^{2}\\, dy} + \\frac{c \\int_{0}^{1} \\phi_{2p}(y)\\, \\phi_{n}(y)\\, dy}{\\int_{0}^{1} \\phi_{n}(y)^{2}\\, dy}\n$$\n基函数 $\\phi_{n}(y) = P_{n}(2y-1)$ 是移位勒让德多项式，它们在区间 $[0,1]$ 上关于权重 $1$ 是正交的。正交性表明对于 $m \\neq n$：\n$$\n\\int_{0}^{1} \\phi_{m}(y)\\, \\phi_{n}(y)\\, dy = 0\n$$\n我们考虑的是在基上的投影，其中 $n=0, 1, \\dots, p$。速度场的未解析分量是 $c\\, \\phi_{2p}(y)$。由于 $p \\in \\mathbb{N}$，我们有 $p \\geq 1$，这意味着 $2p  p$。因此，对于任何 $n \\in \\{0, 1, \\dots, p\\}$，都有 $n \\neq 2p$。因此，由于正交性，第二项中的积分为零：\n$$\n\\int_{0}^{1} \\phi_{2p}(y)\\, \\phi_{n}(y)\\, dy = 0, \\quad \\forall n \\in \\{0, 1, \\dots, p\\}\n$$\n这表明在精确积分下，$c\\, \\phi_{2p}(y)$ 分量对所有 $n \\leq p$ 的投影系数 $a_{n}$ 的贡献恰好为零。\n\n因此，系数完全由线性项 $u_{1} y$ 的投影决定：\n$$\na_{n} = \\frac{u_{1} \\int_{0}^{1} y\\, \\phi_{n}(y)\\, dy}{\\int_{0}^{1} \\phi_{n}(y)^{2}\\, dy}\n$$\n投影多项式为 $u_{p}(y)=\\sum_{n=0}^{p} a_{n}\\, \\phi_{n}(y)$。这是函数 $u_{1} y$ 在最高次数为 $p$ 的多项式空间 $\\mathbb{P}_{p}$ 中的最佳 $L^{2}$ 逼近。由于函数 $u_{1} y$ 本身是一个次数为 $1$ 的多项式，对于任何 $p \\geq 1$，它都是逼近空间 $\\mathbb{P}_{p}$ 的一个元素。对于一个已经存在于空间中的函数，其最佳逼近就是该函数本身。因此，通过精确积分，投影多项式恰好是人工解的线性部分：\n$$\nu_{p}(y) = u_{1}\\, y\n$$\n壁面处（$y=0$）的壁面法向梯度则计算为：\n$$\n\\left.\\frac{\\partial u_{p}}{\\partial y}\\right|_{y=0} = \\left.\\frac{\\partial}{\\partial y}(u_{1}\\, y)\\right|_{y=0} = u_{1}\n$$\n这证明了在精确积分下，DG 方法能够完美地恢复速度剖面线性部分的壁面梯度，而不受更高次项的影响。\n\n**第2部分：使用标准求积 ($N_{q} = p+1$) 的混叠**\n\n当使用具有 $N_{q}$ 个点的高斯-洛巴托-勒让德 (GLL) 求积计算积分时，对于次数最高为 $2N_{q}-3$ 的多项式被积函数，积分是精确的。对于标准选择 $N_{q} = p+1$，精确积分的最大次数是 $2(p+1)-3 = 2p-1$。\n\n混叠误差源于涉及未解析分量 $\\phi_{2p}(y)$ 的积分的数值计算：\n$$\n\\int_{0}^{1} c\\, \\phi_{2p}(y)\\, \\phi_{n}(y)\\, dy, \\quad n \\in \\{0, 1, \\dots, p\\}\n$$\n被积函数是一个次数为 $2p+n$ 的多项式。为了使该积分能被 GLL 法则精确计算，被积函数的次数不能超过该法则的精确度：\n$$\n2p+n \\leq 2p-1 \\implies n \\leq -1\n$$\n这个条件永远不会满足，因为 $n$ 的范围是从 $0$ 到 $p$。被积函数的次数范围从 $2p$（对于 $n=0$）到 $3p$（对于 $n=p$），对于 $p \\geq 1$，这些次数都严格大于 $2p-1$。\n\n因为 GLL 求积法则对这些被积函数不是精确的，所以由于混叠，积分的计算值通常会非零。这意味着数值投影将从 $c\\, \\phi_{2p}(y)$ 项中产生对系数 $a_{n}$ 的虚假、非零的贡献。我们把这些虚假贡献记作 $a_{n}^{\\text{alias}}$。计算出的系数将是 $a_{n} = a_{n}^{\\text{exact}} + a_{n}^{\\text{alias}}$，其中 $a_{n}^{\\text{exact}}$ 是投影 $u_1 y$ 得到的系数。\n\n得到的投影多项式为 $u_{p}(y) = u_{1} y + \\sum_{n=0}^{p} a_{n}^{\\text{alias}}\\, \\phi_{n}(y)$。计算出的壁面法向梯度则为：\n$$\n\\left.\\frac{\\partial u_{p}}{\\partial y}\\right|_{y=0} = u_{1} + \\sum_{n=0}^{p} a_{n}^{\\text{alias}}\\, \\phi'_{n}(0)\n$$\n由于 $a_{n}^{\\text{alias}}$ 通常不为零，求和项 $\\sum_{n=0}^{p} a_{n}^{\\text{alias}}\\, \\phi'_{n}(0)$ 构成了一个混叠误差，污染了计算出的壁面梯度，使其不再等于 $u_{1}$。\n\n**第3部分：为保证精确性的最小求积点数**\n\n为了消除这种混叠误差，GLL 求积点数 $N_{q}$ 必须足以精确积分所有对于 $n=0, 1, \\dots, p$ 的内积 $\\int_{0}^{1} \\phi_{2p}(y)\\, \\phi_{n}(y)\\, dy$。\n\n被积函数是多项式 $\\phi_{2p}(y)\\, \\phi_{n}(y)$，其次数为 $2p+n$。为确保所有这些积分都是精确的，求积法则必须对这组积分中出现的最高次多项式是精确的。最高次数出现在 $n$ 取最大值时，即 $n=p$。\n$$\n\\text{deg}_{\\max} = 2p + p = 3p\n$$\n具有 $N_{q}$ 个点的 GLL 求积法则对次数最高为 $2N_{q}-3$ 的多项式是精确的。为保证对最高次多项式的精确积分，我们必须满足：\n$$\n2N_{q}-3 \\geq 3p\n$$\n解出 $N_{q}$：\n$$\n2N_{q} \\geq 3p+3\n$$\n$$\nN_{q} \\geq \\frac{3p+3}{2}\n$$\n由于求积点数 $N_{q}$ 必须是整数，所需的最小点数是满足此不等式的最小整数，由向上取整函数给出：\n$$\nN_{q, \\min} = \\left\\lceil \\frac{3p+3}{2} \\right\\rceil\n$$\n该公式给出了消除投影混叠并确保计算出的壁面梯度恰好为 $u_{1}$ 所需的最小 GLL 求积点数。\n\n**第4部分：用于非线性混叠的分裂形式 DG 概述**\n\n对于像粘性 Burgers 方程这样的模型非线性守恒律，$\\partial_{t} u + \\partial_{y} f(u) - \\nu \\partial_{y}^2 u = 0$ 且通量 $f(u) = \\frac{1}{2}u^{2}$，非线性对流项 $\\partial_{y} f(u)$ 是标准 DG 方法中由混叠引起的不稳定性的来源。对称分裂形式，也称为斜对称格式，可以消除由体项中的二次混叠引起的不稳定性。\n\n1.  **弱形式和标准 DG 离散**：我们从对流项的弱形式开始，通过乘以测试函数 $v$ 并在单元 $\\Omega_j$ 上积分得到：$\\int_{\\Omega_j} v\\, \\partial_{y}f(u)\\, dy$。标准 DG 方法应用分部积分 (IBP)，得到两个项：一个体积分和一个面积分。\n    $$\n    \\int_{\\Omega_j} v\\, \\partial_{y}f(u)\\, dy = -\\int_{\\Omega_j} (\\partial_y v)\\, f(u)\\, dy + [v f(u)]_{\\partial\\Omega_j}\n    $$\n    体积分是 $-\\int_{\\Omega_j} (\\partial_y v)\\, f(u)\\, dy$。对于 $u \\in \\mathbb{P}_p$，$f(u)=u^2/2 \\in \\mathbb{P}_{2p}$ 且 $\\partial_y v \\in \\mathbb{P}_{p-1}$。被积函数的次数为 $3p-1$。使用标准的 $N_q=p+1$ GLL求积（精确至 $2p-1$ 次）对 $p \\ge 2$ 会导致混叠误差，从而引发数值不稳定性。\n\n2.  **对称分裂形式**：为解决此问题，重写对流项的弱形式。注意 $\\partial_y f(u) = \\partial_y(u^2/2) = u \\partial_y u$。我们不使用 $\\int v u \\partial_y u\\, dy$，而是采用一个展现离散守恒性质的等价形式。对称分裂形式基于创建一个斜对称的被积函数。对于两个函数 $u$ 和 $v$，表达式 $v u \\partial_y u - u u \\partial_y v$ 是斜对称的。我们构造积分：\n    $$\n    V_{\\text{split}}(u,v) = \\int_{\\Omega_j} \\frac{1}{2}(v u \\partial_y u - u^2 \\partial_y v) dy\n    $$\n    此形式与原始体积分等价，差异在于边界项（因为 $\\int (v u u_y - u^2 v_y) dy = \\int v u u_y dy - \\int u^2 v_y dy = \\int v u u_y dy + \\int (u^2)_y v dy - [vu^2]_\\text{bdy}$，这与 $\\int v u u_y dy$ 及另一副本相关）。边界项的差异被吸收到单元界面处的数值通量定义中。\n\n3.  **消除二次混叠**：分裂形式的关键优势在数值求积时显现。设积分由任意节点求积法则（如 GLL）近似，其点为 $\\{y_i\\}$，权重为 $\\{w_i\\}$：\n    $$\n    V_{\\text{split}} \\approx \\sum_{i} w_i \\frac{1}{2} \\left[ v(y_i) u(y_i) \\frac{\\partial u}{\\partial y}(y_i) - u(y_i)^2 \\frac{\\partial v}{\\partial y}(y_i) \\right]\n    $$\n    为分析稳定性，我们考察能量的离散变化率 $\\frac{1}{2}\\frac{d}{dt}\\int u^2 dy$，这需要将测试函数 $v$ 设置为等于解 $u$。将 $v=u$ 代入离散求和中得到：\n    $$\n    \\sum_{i} w_i \\frac{1}{2} \\left[ u(y_i) u(y_i) \\frac{\\partial u}{\\partial y}(y_i) - u(y_i)^2 \\frac{\\partial u}{\\partial y}(y_i) \\right] = \\sum_i w_i \\frac{1}{2} \\left[ u(y_i)^2 \\frac{\\partial u}{\\partial y}(y_i) - u(y_i)^2 \\frac{\\partial u}{\\partial y}(y_i) \\right]\n    $$\n    方括号内的项在*每个求积点* $y_i$ 处都恒等于零。因此，整个求和为零。\n\n4.  **结论**：这种逐点抵消意味着离散的体积分对单元的能量收支没有贡献。无论求积法则的精确度如何，此性质都成立。由分裂形式的各项产生的混叠误差会完美地相互抵消。这强制执行了原始偏微分方程能量守恒/耗散性质的离散版本，从而确保了非线性稳定性，而无需昂贵的过积分（即增加 $N_q$）。这就是“斜对称离散”如何消除二次混叠带来的不稳定性的方式。",
            "answer": "$$\n\\boxed{\\left\\lceil \\frac{3p+3}{2} \\right\\rceil}\n$$"
        }
    ]
}