{
    "hands_on_practices": [
        {
            "introduction": "非侵入式随机配置方法的核心在于用求积规则来近似期望积分。高斯求积，特别是高斯-厄米特（Gauss-Hermite）求积，是处理高斯随机变量的基石。这个练习  将引导你从正交多项式的基本原理出发，亲手推导一个三点高斯-厄米特求积规则的节点和权重，从而揭示这些“神奇数字”的来源，并加深对方法基础的理解。",
            "id": "3403692",
            "problem": "考虑在谱方法和间断伽辽金 (DG) 离散化中用于不确定性量化的非侵入式随机配置法，其中关于高斯测度的期望通过高斯求积法则来近似。设权重为 $(-\\infty,\\infty)$ 上的非归一化高斯权重 $w(x)=\\exp(-x^{2})$，并考虑一个 $n=3$ 阶高斯-埃尔米特法则。从正交多项式和带权内积的基本事实出发，即埃尔米特多项式（物理学家约定）$\\{H_{k}(x)\\}_{k\\geq 0}$ 在 $(-\\infty,\\infty)$ 上关于 $w(x)$ 正交，并且通过在 $n$ 次正交多项式的零点处选取 $n$ 个横坐标并通过矩匹配求解 $n$ 个权重来强制实现直到 $2n-1$ 次的精确性，推导 $n=3$ 阶高斯-埃尔米特求积的横坐标和权重，要求对所有次数最高为 $2n-1=5$ 的多项式都精确成立。\n\n具体来说：\n- 使用关于 $w(x)=\\exp(-x^{2})$ 的埃尔米特多项式定义及其递推关系，确定 3 次正交多项式及其零点，即为横坐标。\n- 使用 $k=0,1,2,3,4,5$ 时的矩约束 $\\int_{-\\infty}^{\\infty} x^{k} \\exp(-x^{2})\\,dx$ 来确定并验证与这些横坐标相关联的权重，确保对总次数最高为 5 的多项式精确成立。\n- 将横坐标按升序排列，后跟对应的权重，以单行矩阵的形式给出，不进行四舍五入。\n\n你的最终答案必须是单个解析表达式。无需单位。",
            "solution": "用户希望推导 $n=3$ 阶高斯-埃尔米特求积法则的横坐标和权重。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **主题：** 用于谱方法和间断伽辽金 (DG) 方法的非侵入式随机配置法。\n- **近似方法：** 使用高斯求积法则近似关于高斯测度的期望。\n- **权重函数：** 非归一化高斯权重 $w(x) = \\exp(-x^2)$。\n- **定义域：** $(-\\infty, \\infty)$。\n- **求积法则阶数：** $n=3$ 阶高斯-埃尔米特法则。\n- **正交多项式：** 埃尔米特多项式（物理学家约定），$\\{H_k(x)\\}_{k\\ge 0}$，在 $(-\\infty, \\infty)$ 上关于 $w(x)$ 正交。\n- **求积法则构建原理：** 对于一个 $n$ 阶法则，其 $n$ 个横坐标是 $n$ 次正交多项式的零点。通过对一组基函数强制精确性来找到 $n$ 个权重。\n- **要求的精确性：** 该求积法则必须对所有次数最高为 $2n-1 = 2(3)-1 = 5$ 的多项式都精确。\n- **具体任务：**\n    1. 确定 3 次埃尔米特多项式 $H_3(x)$ 并找到其零点（即横坐标）。\n    2. 使用 $k=0,1,2,3,4,5$ 时的矩约束 $\\int_{-\\infty}^{\\infty} x^k \\exp(-x^2) dx$ 来确定权重。\n    3. 报告横坐标（按升序排列）及其对应的权重。\n- **最终答案格式：** 一个单行矩阵，先是横坐标，然后是权重。不进行四舍五入。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它是数值分析中的一个标准问题，并且与所陈述的不确定性量化领域直接相关。所有必要信息都已提供，前提条件真实正确，所要求的推导是一个不平凡但可行的数学练习。不存在矛盾、歧义或不合理之处。\n\n**步骤 3：结论与行动**\n问题是**有效的**。将提供详细的解决方案。\n\n### 横坐标和权重的推导\n\n问题要求构建一个形式为\n$$\n\\int_{-\\infty}^{\\infty} f(x) \\exp(-x^2) \\,dx \\approx \\sum_{i=1}^{3} w_i f(x_i)\n$$\n的高斯-埃尔米特求积法则，其中 $\\{x_i\\}_{i=1}^3$ 是横坐标，$\\{w_i\\}_{i=1}^3$ 是权重。该法则必须对所有次数最高为 $2n-1 = 2(3)-1 = 5$ 的多项式 $f(x)$ 都精确。\n\n**1. 确定横坐标**\n\n根据高斯求积理论，对于权重函数 $w(x) = \\exp(-x^2)$，横坐标是 $n$ 次正交多项式的根。在本例中，$n=3$，相关的正交多项式是埃尔米特多项式（物理学家约定），记为 $H_k(x)$。\n\n前几个埃尔米特多项式由递推关系 $H_{k+1}(x) = 2x H_k(x) - 2k H_{k-1}(x)$ 生成，初始多项式为 $H_0(x) = 1$ 和 $H_1(x) = 2x$。\n- $k=0$: $H_0(x) = 1$\n- $k=1$: $H_1(x) = 2x$\n- $k=2$: $H_2(x) = 2x H_1(x) - 2(1) H_0(x) = 2x(2x) - 2(1) = 4x^2 - 2$\n- $k=3$: $H_3(x) = 2x H_2(x) - 2(2) H_1(x) = 2x(4x^2 - 2) - 4(2x) = 8x^3 - 4x - 8x = 8x^3 - 12x$\n\n横坐标 $\\{x_i\\}$ 是 $H_3(x) = 0$ 的根：\n$$\n8x^3 - 12x = 0\n$$\n提出因子 $4x$：\n$$\n4x(2x^2 - 3) = 0\n$$\n根是 $x=0$ 和 $2x^2-3=0$，后者给出 $x^2 = \\frac{3}{2}$，因此 $x = \\pm \\sqrt{\\frac{3}{2}}$。\n将横坐标按升序排列：\n$$\nx_1 = -\\sqrt{\\frac{3}{2}}, \\quad x_2 = 0, \\quad x_3 = \\sqrt{\\frac{3}{2}}\n$$\n\n**2. 确定权重**\n\n权重 $\\{w_i\\}$ 是通过要求求积法则对次数最高为 $2n-1=5$ 的多项式精确来确定的。我们通过匹配矩来实现这一点，即确保该公式对 $k=0, 1, 2, \\dots, 5$ 时的 $f(x) = x^k$ 精确。\n控制方程组为：\n$$\n\\sum_{i=1}^{3} w_i x_i^k = \\int_{-\\infty}^{\\infty} x^k \\exp(-x^2) \\,dx = M_k\n$$\n首先，我们计算矩 $M_k$。当 $k$ 为奇数时，被积函数 $x^k \\exp(-x^2)$ 是一个奇函数，因此其在对称区间 $(-\\infty, \\infty)$ 上的积分为零。\n$$\nM_k = 0 \\quad \\text{for } k=1, 3, 5\n$$\n对于偶数 $k=2m$，矩与伽玛函数 $\\Gamma(z) = \\int_0^{\\infty} t^{z-1} e^{-t} dt$ 相关。\n$$\nM_{2m} = \\int_{-\\infty}^{\\infty} x^{2m} \\exp(-x^2) \\,dx = 2 \\int_0^{\\infty} x^{2m} \\exp(-x^2) \\,dx\n$$\n使用换元法 $u=x^2$（因此 $x=u^{1/2}$ 且 $dx = \\frac{1}{2}u^{-1/2}du$）：\n$$\nM_{2m} = 2 \\int_0^{\\infty} u^m \\exp(-u) \\frac{1}{2} u^{-1/2} \\,du = \\int_0^{\\infty} u^{m-1/2} \\exp(-u) \\,du = \\Gamma\\left(m + \\frac{1}{2}\\right)\n$$\n使用 $\\Gamma(1/2) = \\sqrt{\\pi}$ 和 $\\Gamma(z+1) = z\\Gamma(z)$，我们找到所需的偶数阶矩：\n- $k=0$ ($m=0$) 时：$M_0 = \\Gamma(1/2) = \\sqrt{\\pi}$\n- $k=2$ ($m=1$) 时：$M_2 = \\Gamma(3/2) = \\frac{1}{2}\\Gamma(1/2) = \\frac{\\sqrt{\\pi}}{2}$\n- $k=4$ ($m=2$) 时：$M_4 = \\Gamma(5/2) = \\frac{3}{2}\\Gamma(3/2) = \\frac{3}{2} \\frac{\\sqrt{\\pi}}{2} = \\frac{3\\sqrt{\\pi}}{4}$\n\n现在我们建立权重 $w_1$, $w_2$ 和 $w_3$ 的方程组：\n- 对于 $k=0$：$w_1 + w_2 + w_3 = M_0 = \\sqrt{\\pi}$\n- 对于 $k=1$：$w_1 x_1 + w_2 x_2 + w_3 x_3 = M_1 = 0$\n  $w_1 \\left(-\\sqrt{\\frac{3}{2}}\\right) + w_2(0) + w_3 \\left(\\sqrt{\\frac{3}{2}}\\right) = 0 \\implies w_1=w_3$\n- 对于 $k=2$：$w_1 x_1^2 + w_2 x_2^2 + w_3 x_3^2 = M_2 = \\frac{\\sqrt{\\pi}}{2}$\n  $w_1 \\left(\\frac{3}{2}\\right) + w_2(0) + w_3 \\left(\\frac{3}{2}\\right) = \\frac{\\sqrt{\\pi}}{2}$\n\n由于 $w_1=w_3$，对于 $k=2$ 的方程变为：\n$$\n2 w_1 \\left(\\frac{3}{2}\\right) = \\frac{\\sqrt{\\pi}}{2} \\implies 3w_1 = \\frac{\\sqrt{\\pi}}{2} \\implies w_1 = \\frac{\\sqrt{\\pi}}{6}\n$$\n因此，$w_3 = w_1 = \\frac{\\sqrt{\\pi}}{6}$。\n\n将 $w_1$ 和 $w_3$ 代入 $k=0$ 的方程：\n$$\n\\frac{\\sqrt{\\pi}}{6} + w_2 + \\frac{\\sqrt{\\pi}}{6} = \\sqrt{\\pi}\n$$\n$$\n\\frac{\\sqrt{\\pi}}{3} + w_2 = \\sqrt{\\pi} \\implies w_2 = \\sqrt{\\pi} - \\frac{\\sqrt{\\pi}}{3} = \\frac{2\\sqrt{\\pi}}{3}\n$$\n所以权重为：\n$$\nw_1 = \\frac{\\sqrt{\\pi}}{6}, \\quad w_2 = \\frac{2\\sqrt{\\pi}}{3}, \\quad w_3 = \\frac{\\sqrt{\\pi}}{6}\n$$\n\n**3. 验证**\n\n问题要求验证到 5 次。我们使用了 $k=0,1,2$ 的矩。我们必须检查我们的法则对于 $k=3, 4, 5$ 是否精确。\n- 对于 $k=3$：求积和为 $\\sum_{i=1}^3 w_i x_i^3 = w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3$。\n$$\n\\frac{\\sqrt{\\pi}}{6}\\left(-\\sqrt{\\frac{3}{2}}\\right)^3 + \\frac{2\\sqrt{\\pi}}{3}(0)^3 + \\frac{\\sqrt{\\pi}}{6}\\left(\\sqrt{\\frac{3}{2}}\\right)^3 = \\frac{\\sqrt{\\pi}}{6} \\left[ -\\left(\\frac{3}{2}\\right)^{3/2} + \\left(\\frac{3}{2}\\right)^{3/2} \\right] = 0\n$$\n这与 $M_3=0$ 匹配。该法则对 $x^3$ 精确。\n\n- 对于 $k=4$：求积和为 $\\sum_{i=1}^3 w_i x_i^4 = w_1 x_1^4 + w_2 x_2^4 + w_3 x_3^4$。\n$$\n\\frac{\\sqrt{\\pi}}{6}\\left(-\\sqrt{\\frac{3}{2}}\\right)^4 + \\frac{2\\sqrt{\\pi}}{3}(0)^4 + \\frac{\\sqrt{\\pi}}{6}\\left(\\sqrt{\\frac{3}{2}}\\right)^4 = 2 \\left( \\frac{\\sqrt{\\pi}}{6} \\right) \\left( \\frac{3}{2} \\right)^2 = \\frac{\\sqrt{\\pi}}{3} \\frac{9}{4} = \\frac{3\\sqrt{\\pi}}{4}\n$$\n这与 $M_4 = \\frac{3\\sqrt{\\pi}}{4}$ 匹配。该法则对 $x^4$ 精确。\n\n- 对于 $k=5$：求积和为 $\\sum_{i=1}^3 w_i x_i^5 = w_1 x_1^5 + w_2 x_2^5 + w_3 x_3^5$。\n$$\n\\frac{\\sqrt{\\pi}}{6}\\left(-\\sqrt{\\frac{3}{2}}\\right)^5 + \\frac{2\\sqrt{\\pi}}{3}(0)^5 + \\frac{\\sqrt{\\pi}}{6}\\left(\\sqrt{\\frac{3}{2}}\\right)^5 = \\frac{\\sqrt{\\pi}}{6} \\left[ -\\left(\\frac{3}{2}\\right)^{5/2} + \\left(\\frac{3}{2}\\right)^{5/2} \\right] = 0\n$$\n这与 $M_5=0$ 匹配。该法则对 $x^5$ 精确。\n\n推导完成并已验证。按升序排列的横坐标是 $-\\sqrt{3/2}$, $0$, $\\sqrt{3/2}$，对应的权重是 $\\sqrt{\\pi}/6$, $2\\sqrt{\\pi}/3$, $\\sqrt{\\pi}/6$。\n\n**最终结果**\n横坐标和相应的权重按要求汇集在一个单行矩阵中。\n横坐标：$x_1 = -\\sqrt{\\frac{3}{2}}$，$x_2 = 0$，$x_3 = \\sqrt{\\frac{3}{2}}$。\n权重：$w_1 = \\frac{\\sqrt{\\pi}}{6}$，$w_2 = \\frac{2\\sqrt{\\pi}}{3}$，$w_3 = \\frac{\\sqrt{\\pi}}{6}$。\n最终矩阵是 $(x_1, x_2, x_3, w_1, w_2, w_3)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\sqrt{\\frac{3}{2}}  0  \\sqrt{\\frac{3}{2}}  \\frac{\\sqrt{\\pi}}{6}  \\frac{2\\sqrt{\\pi}}{3}  \\frac{\\sqrt{\\pi}}{6} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "伪谱投影法是计算广义多项式混沌（gPC）展开系数的常用技术，但它有一个潜在的陷阱：混叠误差（aliasing）。当配置点数量不足时，模型响应中的高阶分量可能会“伪装”成低阶分量，从而污染计算结果。这个练习  将帮助你从根本上理解混叠现象，推导出确保计算精度的求积阶数条件，这是任何从业者在应用该方法时都必须掌握的关键技能。",
            "id": "3403735",
            "problem": "考虑一个针对一维随机输入的非侵入式随机配置方法，该随机输入在区间 $[-1,1]$ 上服从均匀分布。设 $\\{\\psi_{k}(x)\\}_{k \\geq 0}$ 表示勒让德多项式基，其在区间 $[-1,1]$ 上关于权重函数 $\\rho(x)=\\frac{1}{2}$ 是标准正交的。在伪谱投影中，广义多项式混沌 (gPC) 系数通过近似内积来计算\n$$\na_{k}=\\int_{-1}^{1} f(x)\\,\\psi_{k}(x)\\,\\rho(x)\\,dx\n$$\n该近似使用具有节点 $\\{x_{j}\\}_{j=1}^{n}$ 和正权重 $\\{w_{j}\\}_{j=1}^{n}$ 的 $n$ 点高斯-勒让德求积，得到离散和\n$$\n\\widehat{a}_{k}=\\sum_{j=1}^{n} w_{j} \\, f(x_{j})\\,\\psi_{k}(x_{j}).\n$$\n假设由间断伽辽金方法中一个 $r$ 次多项式离散的非线性通量所产生的确定性关注量 $f(x)$ 本身是一个 $x$ 的 $r$ 次多项式，并假设我们寻求阶数至多为 $p$ 的 gPC 系数；也就是说，$k$ 的范围是 $0\\leq k \\leq p$。高斯-勒让德求积法则对于阶数至多为 $2n-1$ 的多项式积分是精确的。\n\n从勒让德多项式的正交性和高斯-勒让德求积的多项式精确性等第一性原理出发，推导伪谱投影错误估计系数 $a_{k}$ (其中 $k0$) 时所满足的混叠条件。明确地刻画出由于有限精确性而导致混叠的阶数 $(r,k)$，并解释当 $r+k$ 超过求积精度时，高阶项如何污染低阶系数。\n\n然后，提出一种基于 Smolyak 构造的稀疏网格的基于原理的补救方法：解释如何选择一维嵌套规则，以便当通过 Smolyak 方法扩展到 $d$ 个独立的均匀随机变量时，多维配置能够对所有总阶数至多为 $p$ 的多重指标系数避免混叠。您的补救方法必须根据每个坐标的一维多项式精度要求以及这些要求如何通过 Smolyak 组合进行传播来陈述。\n\n最后，以 $r$ 和 $p$ 的闭式解析表达式形式，给出保证一维伪谱投影能够精确计算（即无混叠）所有系数 $a_k$ (其中 $0 \\leq k \\leq p$) 所需的最小高斯-勒让德点数 $n_{\\min}$。将您的最终答案表示为解析表达式。无需数值舍入。",
            "solution": "该问题陈述被评估为有效。它在科学上基于数值分析理论，特别是非侵入式谱方法和求积法。该问题是适定的、客观的，并包含足够的信息来推导所要求的条件和表达式。\n\n问题的核心涉及伪谱投影方法中的混叠误差。当一个连续积分由一个对被积函数缺乏足够多项式精度的离散和（求积）来近似时，就会产生这种误差。我们将首先在一维情况下分析这一现象，然后通过稀疏网格将该原理扩展到多维，最后推导在一维情况下避免混叠的条件。\n\n设关注量 $f(x)$ 是一个 $r$ 次多项式。因此，它在标准正交勒让德基 $\\{\\psi_{k}(x)\\}_{k \\geq 0}$ 中有一个有限的精确展开式：\n$$\nf(x) = \\sum_{l=0}^{r} c_{l} \\psi_{l}(x)\n$$\n系数 $\\{c_l\\}$ 是 $f(x)$ 的真实广义多项式混沌 (gPC) 系数。精确系数 $a_k$ 由内积定义：\n$$\na_{k} = \\int_{-1}^{1} f(x) \\psi_{k}(x) \\rho(x) dx\n$$\n代入 $f(x)$ 的展开式并利用基的标准正交性，其中 $\\int_{-1}^{1} \\psi_{l}(x) \\psi_{k}(x) \\rho(x) dx = \\delta_{lk}$，我们得到：\n$$\na_{k} = \\int_{-1}^{1} \\left( \\sum_{l=0}^{r} c_{l} \\psi_{l}(x) \\right) \\psi_{k}(x) \\rho(x) dx = \\sum_{l=0}^{r} c_{l} \\int_{-1}^{1} \\psi_{l}(x) \\psi_{k}(x) \\rho(x) dx = \\sum_{l=0}^{r} c_{l} \\delta_{lk}\n$$\n这表明当 $0 \\leq k \\leq r$ 时，$a_k = c_k$，当 $k  r$ 时，$a_k = 0$。\n\n伪谱投影使用一个 $n$ 点高斯-勒让德求积法则计算近似值 $\\widehat{a}_k$：\n$$\n\\widehat{a}_{k} = \\sum_{j=1}^{n} w_{j} f(x_{j}) \\psi_{k}(x_{j})\n$$\n这个和是 $a_k$ 积分的求积近似，其中被积函数是 $g_k(x) = f(x) \\psi_k(x)$。问题陈述指出，$n$ 点高斯-勒让德求积法则对阶数至多为 $2n-1$ 的任何多项式都是精确的。被积函数 $g_k(x)$ 的阶数是 $\\deg(f) + \\deg(\\psi_k) = r+k$。因此，$\\widehat{a}_k = a_k$ 当且仅当 $r+k \\leq 2n-1$。\n\n当这个条件被违反时，即 $r+k  2n-1$，求积不再精确，混叠就会发生。为了刻画这个误差，我们将 $f(x)$ 的展开式代入 $\\widehat{a}_k$ 的公式中：\n$$\n\\widehat{a}_{k} = \\sum_{j=1}^{n} w_{j} \\left( \\sum_{l=0}^{r} c_{l} \\psi_{l}(x_j) \\right) \\psi_{k}(x_{j}) = \\sum_{l=0}^{r} c_{l} \\left( \\sum_{j=1}^{n} w_{j} \\psi_{l}(x_j) \\psi_{k}(x_j) \\right)\n$$\n内部的和是 $\\int_{-1}^{1} \\psi_{l}(x) \\psi_{k}(x) \\rho(x) dx = \\delta_{lk}$ 的求积近似。如果 $\\deg(\\psi_l \\psi_k) = l+k \\leq 2n-1$，这个近似是精确的。如果 $l+k  2n-1$，这个离散和不必然为零（当 $l \\neq k$ 时）或一（当 $l=k$ 时）。\n\n因此，计算出的系数 $\\widehat{a}_k$ 是：\n$$\n\\widehat{a}_{k} = \\sum_{l \\in \\{0, \\dots, r\\} \\text{ s.t. } l+k \\leq 2n-1} c_l \\delta_{lk} + \\sum_{l \\in \\{0, \\dots, r\\} \\text{ s.t. } l+k  2n-1} c_l \\left( \\sum_{j=1}^{n} w_{j} \\psi_{l}(x_j) \\psi_{k}(x_j) \\right)\n$$\n假设 $k \\leq 2n-1$，第一项简化为 $c_k = a_k$。第二项代表混叠误差。\n$$\n\\widehat{a}_k = a_k + \\sum_{l \\in \\{0, \\dots, r\\}, l \\neq k, l+k  2n-1} c_l \\left( \\sum_{j=1}^{n} w_{j} \\psi_{l}(x_j) \\psi_{k}(x_j) \\right)\n$$\n这个方程明确地显示了 $f(x)$ 中高阶基函数的系数 $c_l$（其中 $l$ 足够大以至于 $l+k  2n-1$）如何被混叠并污染低阶系数 $a_k$ 的估计。任何满足 $r+k  2n-1$ 的阶数对 $(r,k)$ 都有可能导致混叠，因为 $f(x)$ 的展开式可能包含阶数 $l$ 足够高的项 $\\psi_l(x)$，导致被积函数的阶数 $l+k$ 超过求积的精确度。对于本问题，我们关心的是 $k0$。该混叠条件是通用的，对任何 $k \\geq 0$ 都成立。\n\n接下来，我们考虑对一个具有 $d$ 个独立均匀随机变量的 $d$ 维问题，使用稀疏网格的补救方法。目标是计算总阶数 $|\\mathbf{k}|_1 = \\sum_{i=1}^d k_i \\leq p$ 的多重指标 $\\mathbf{k}$ 的系数 $a_{\\mathbf{k}}$。关注量 $f(\\mathbf{x})$ 被假设为一个总阶数为 $r$ 的多项式。用于计算 $a_{\\mathbf{k}}$ 的被积函数是 $f(\\mathbf{x}) \\Psi_{\\mathbf{k}}(\\mathbf{x})$，其中 $\\Psi_{\\mathbf{k}}(\\mathbf{x})$ 是在每个坐标 $x_i$ 上阶数为 $k_i$ 的张量积勒让德多项式。为避免所有总阶数至多为 $p$ 的系数发生混叠，求积法则必须对所有 $|\\mathbf{k}|_1 \\leq p$ 的被积函数 $f(\\mathbf{x}) \\Psi_{\\mathbf{k}}(\\mathbf{x})$ 都是精确的。这要求该法则对所有总阶数至多为 $r+p$ 的多项式都是精确的。\n\nSmolyak 构造提供了一种从一系列一维规则构建多维求积法则的方法。补救方法是选择一维规则和 Smolyak 构造的层级，以达到所需的多项式精确度。一个基于原理的选择如下：\n1.  对每个维度，定义一个由层级 $i \\in \\{1, 2, \\dots\\}$ 索引的一维求积法则序列。为确保高阶精确性，应选择层级为 $i$ 的规则 $\\mathcal{Q}_i$ 为 $i$ 点高斯-勒让德规则。这个一维规则的多项式精确度为 $2i-1$。\n2.  使用 Smolyak 算法在选定的层级 $L$ 构建一个多维求积法则 $\\mathcal{A}(L,d)$。该算法组合了满足特定标准（通常是 $|\\mathbf{i}|_1 \\leq L$ 或 $L-d+1 \\leq |\\mathbf{i}|_1 \\leq L$）的层级为 $i_1, \\dots, i_d$ 的一维规则 $\\mathcal{Q}_i$ 的张量积。\n3.  关键步骤是选择一个足够高的层级 $L$，以保证对总阶数至多为 $r+p$ 的多项式具有精确性。对于选择 $\\mathcal{Q}_i$ 为 $i$ 点高斯规则的一维规则，一个标准结果表明，建立在层级 $|\\mathbf{i}|_1 \\le L$ 上的 Smolyak 规则对所有总阶数至多为 $2(L-d)+1$ 的多项式都是精确的。\n4.  因此，为避免所有总阶数至多为 $p$ 的系数发生混叠，所选层级 $L$ 必须满足：$2(L-d)+1 \\geq r+p$。这个不等式决定了所需的最小 Smolyak 层级。在实践中，为了效率，人们通常会使用嵌套规则（例如 Clenshaw-Curtis 或 Gauss-Patterson），它们具有不同的精确性属性（$d_i$），但原理相同：必须选择 Smolyak 构造层级以确保最终的多维规则对所有总阶数至多为 $r+p$ 的多项式都是精确的。\n\n最后，我们推导在一维情况下保证对所有 $0 \\leq k \\leq p$ 的系数 $a_k$ 不发生混叠所需的最小高斯-勒让德点数 $n_{\\min}$。\n如前所述，如果 $n$ 点求积法则对被积函数 $f(x)\\psi_k(x)$ 是精确的，则在计算特定系数 $a_k$ 时可以避免混叠。条件是：\n$$\n\\deg(f \\psi_k) \\leq 2n-1\n$$\n这可以转化为：\n$$\nr + k \\leq 2n-1\n$$\n这个不等式必须对我们希望精确计算的所有系数都成立，即对整个范围 $k \\in \\{0, 1, \\dots, p\\}$。为确保这一点，我们必须对最严格的情况强制执行该条件，这对应于该范围中 $k$ 的最大值，即 $k=p$。\n因此，条件变为：\n$$\nr + p \\leq 2n-1\n$$\n我们寻求满足此不等式的最小整数 $n$。我们重新排列不等式以求解 $n$：\n$$\n2n \\geq r+p+1\n$$\n$$\nn \\geq \\frac{r+p+1}{2}\n$$\n由于求积点数 $n$ 必须是整数，所以最小点数 $n_{\\min}$ 是大于或等于 $\\frac{r+p+1}{2}$ 的最小整数。这由向上取整函数（ceiling function）给出：\n$$\nn_{\\min} = \\left\\lceil \\frac{r+p+1}{2} \\right\\rceil\n$$\n该表达式给出了在为阶数为 $r$ 的多项式关注量计算所有阶数至多为 $p$ 的 gPC 系数时，防止混叠所需的最小高斯-勒让德点数。",
            "answer": "$$\\boxed{\\left\\lceil \\frac{r+p+1}{2} \\right\\rceil}$$"
        },
        {
            "introduction": "在将随机配置方法从一维推广到多维时，我们面临着“维度灾难”的挑战，即全张量积网格的计算成本会呈指数增长。稀疏网格是一种巧妙而高效的替代方案，它通过Smolyak算法明智地组合低维求积规则来构建。这个练习  将让你亲手实践构建稀疏网格的组合过程，通过确定多指标集并计算总节点数，具体地理解稀疏网格是如何有效控制计算量的。",
            "id": "3403649",
            "problem": "考虑一种针对3维参数输入向量 $\\boldsymbol{\\xi} = (\\xi_1,\\xi_2,\\xi_3)$ 的非侵入式随机配置法 (SC)，该向量的分量在区间 $[-1,1]$ 上独立且均匀分布。您将使用嵌套的一维 Clenshaw–Curtis 配置规则，基于 Smolyak 算子 $\\mathcal{A}(q,d)$（其中 $q=3$ 且 $d=3$）构建一个用于插值的稀疏网格节点集。\n\n使用以下基本定义：\n\n- 一维层级 $\\ell$ 配置规则具有一个嵌套节点集 $\\mathcal{X}_\\ell$，其基数为 $N_\\ell$，其中 $N_1 = 1$，$N_2 = 3$，$N_3 = 5$，并且对于 $\\ell \\geq 2$，$N_\\ell = 2^{\\ell-1} + 1$。通过 $\\Delta \\mathcal{X}_1 := \\mathcal{X}_1$ 定义层级增量集，并且对于 $\\ell \\geq 2$，定义 $\\Delta \\mathcal{X}_\\ell := \\mathcal{X}_\\ell \\setminus \\mathcal{X}_{\\ell-1}$，其增量基数为 $M_\\ell := |\\Delta \\mathcal{X}_\\ell|$。根据定义，$M_1 = 1$，$M_2 = 2$，并且对于 $\\ell \\geq 3$，$M_\\ell = N_\\ell - N_{\\ell-1} = 2^{\\ell-2}$。\n\n- 带有嵌套规则的 Smolyak 插值算子由张量积层级增量构成。其多指标集为\n$$\n\\mathcal{I}(q,d) := \\left\\{ \\boldsymbol{i} = (i_1,i_2,i_3) \\in \\mathbb{N}^3 \\;:\\; \\sum_{k=1}^3 i_k \\leq q + d - 1,\\;\\; i_k \\geq 1 \\right\\}.\n$$\n相关的稀疏网格节点集是张量积增量集的不相交并集，\n$$\n\\mathcal{S}(q,d) := \\bigcup_{\\boldsymbol{i} \\in \\mathcal{I}(q,d)} \\left( \\Delta \\mathcal{X}_{i_1} \\times \\Delta \\mathcal{X}_{i_2} \\times \\Delta \\mathcal{X}_{i_3} \\right),\n$$\n其不同节点的总数为\n$$\n|\\mathcal{S}(q,d)| = \\sum_{\\boldsymbol{i} \\in \\mathcal{I}(q,d)} \\prod_{k=1}^3 M_{i_k}.\n$$\n\n任务：\n1. 列出所有对 Smolyak 算子有贡献的多指标组合 $\\boldsymbol{i} \\in \\mathcal{I}(q=3,d=3)$。\n2. 使用上述定义，计算稀疏网格 $\\mathcal{S}(3,3)$ 中不同配置节点的总数。\n\n您的最终答案必须是等于 $|\\mathcal{S}(3,3)|$ 的单个整数。",
            "solution": "问题陈述已经过验证，并被认为是合理的。这是一个基于数值分析领域（特别是稀疏网格方法）中标准定义的良构数学问题。所有必要的数据和定义都已提供，并且内部一致，没有歧义。\n\n目标是计算使用 Smolyak 算子构建的稀疏网格中不同配置节点的总数，记为 $|\\mathcal{S}(q,d)|$。给定的参数是层级-精度参数 $q=3$ 和输入维度 $d=3$。\n\n节点总数由以下公式给出：\n$$\n|\\mathcal{S}(q,d)| = \\sum_{\\boldsymbol{i} \\in \\mathcal{I}(q,d)} \\prod_{k=1}^d M_{i_k}\n$$\n对于本问题，$d=3$，因此公式为：\n$$\n|\\mathcal{S}(3,3)| = \\sum_{\\boldsymbol{i} \\in \\mathcal{I}(3,3)} M_{i_1} M_{i_2} M_{i_3}\n$$\n\n第一步是确定多指标集 $\\mathcal{I}(q,d)$。提供的定义是：\n$$\n\\mathcal{I}(q,d) := \\left\\{ \\boldsymbol{i} = (i_1, \\dots, i_d) \\in \\mathbb{N}^d \\;:\\; \\sum_{k=1}^d i_k \\leq q + d - 1,\\;\\; i_k \\geq 1 \\right\\}\n$$\n当 $q=3$ 和 $d=3$ 时，指标和的条件变为：\n$$\n\\sum_{k=1}^3 i_k \\leq 3 + 3 - 1 = 5\n$$\n所以，我们必须找到所有和小于或等于5的正整数三元组 $\\boldsymbol{i} = (i_1, i_2, i_3)$。我们可以根据它们的和 $|\\boldsymbol{i}|_1 = i_1+i_2+i_3$ 对这些多指标进行分组枚举。\n\n任务 1：列出所有多指标组合 $\\boldsymbol{i} \\in \\mathcal{I}(3,3)$。\n\n-   情况 $|\\boldsymbol{i}|_1 = 3$：\n    三个正整数之和为3的唯一组合是 $(1,1,1)$。\n    多指标：$(1,1,1)$。\n\n-   情况 $|\\boldsymbol{i}|_1 = 4$：\n    我们需要和为4的三个正整数的组合。将4划分为三部分的唯一方式是 $2+1+1$。$(2,1,1)$ 的排列是：\n    多指标：$(2,1,1)$、$(1,2,1)$、$(1,1,2)$。\n\n-   情况 $|\\boldsymbol{i}|_1 = 5$：\n    我们需要和为5的三个正整数的组合。将5划分为三部分的方式有 $3+1+1$ 和 $2+2+1$。\n    $(3,1,1)$ 的排列：$(3,1,1)$、$(1,3,1)$、$(1,1,3)$。\n    $(2,2,1)$ 的排列：$(2,2,1)$、$(2,1,2)$、$(1,2,2)$。\n\n总共，集合 $\\mathcal{I}(3,3)$ 包含 $1+3+3+3 = 10$ 个多指标：\n$$\n\\mathcal{I}(3,3) = \\{ (1,1,1), (2,1,1), (1,2,1), (1,1,2), (3,1,1), (1,3,1), (1,1,3), (2,2,1), (2,1,2), (1,2,2) \\}\n$$\n\n任务 2：计算不同配置节点的总数 $|\\mathcal{S}(3,3)|$。\n\n接下来，我们需要计算出现在 $\\mathcal{I}(3,3)$ 中的指标 $\\ell \\in \\{1,2,3\\}$ 的增量基数 $M_\\ell = |\\Delta\\mathcal{X}_\\ell|$ 的值。\n根据问题陈述：\n-   $M_1 = 1$\n-   $M_2 = 2$\n-   对于 $\\ell \\geq 3$，$M_\\ell = 2^{\\ell-2}$。对于 $\\ell=3$，这给出 $M_3 = 2^{3-2} = 2^1 = 2$。\n\n现在我们可以计算总和 $\\sum_{\\boldsymbol{i} \\in \\mathcal{I}(3,3)} M_{i_1} M_{i_2} M_{i_3}$。我们可以按多指标 $\\boldsymbol{i}$ 的结构对各项进行分组：\n\n-   对于 $\\boldsymbol{i} = (1,1,1)$：\n    只有一个这样的指标。其贡献为 $M_1 M_1 M_1 = 1 \\cdot 1 \\cdot 1 = 1$。\n\n-   对于 $(2,1,1)$ 的排列：\n    有3个这样的指标：$(2,1,1)$、$(1,2,1)$ 和 $(1,1,2)$。对每一个，基数之积为 $M_2 M_1 M_1 = 2 \\cdot 1 \\cdot 1 = 2$。\n    该组的总贡献为 $3 \\times 2 = 6$。\n\n-   对于 $(3,1,1)$ 的排列：\n    有3个这样的指标：$(3,1,1)$、$(1,3,1)$ 和 $(1,1,3)$。对每一个，基数之积为 $M_3 M_1 M_1 = 2 \\cdot 1 \\cdot 1 = 2$。\n    该组的总贡献为 $3 \\times 2 = 6$。\n\n-   对于 $(2,2,1)$ 的排列：\n    有3个这样的指标：$(2,2,1)$、$(2,1,2)$ 和 $(1,2,2)$。对每一个，基数之积为 $M_2 M_2 M_1 = 2 \\cdot 2 \\cdot 1 = 4$。\n    该组的总贡献为 $3 \\times 4 = 12$。\n\n最后，节点的总数是这些贡献的总和：\n$$\n|\\mathcal{S}(3,3)| = 1 + 6 + 6 + 12 = 25\n$$\n因此，稀疏网格 $\\mathcal{S}(3,3)$ 中不同配置节点的总数为 $25$。",
            "answer": "$$\\boxed{25}$$"
        }
    ]
}