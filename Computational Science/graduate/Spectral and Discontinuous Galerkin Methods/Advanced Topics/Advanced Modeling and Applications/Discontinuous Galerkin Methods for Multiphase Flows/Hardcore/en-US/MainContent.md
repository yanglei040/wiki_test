## Introduction
Simulating multiphase flows—systems involving distinct, interacting fluids like gas bubbles in water or fuel sprays in air—is a cornerstone of modern engineering and science. However, these flows present formidable computational challenges, including dynamically [moving interfaces](@entry_id:141467), large density contrasts, and complex geometries. Traditional numerical methods often struggle to capture these features with both accuracy and robustness, creating a critical need for a more advanced computational framework.

The discontinuous Galerkin (DG) method has emerged as a powerful and versatile solution to these challenges. By combining the strengths of finite element and [finite volume methods](@entry_id:749402), DG provides a rigorous mathematical structure for handling discontinuities, achieving [high-order accuracy](@entry_id:163460) on unstructured meshes, and flexibly adapting to local solution features. This article offers a comprehensive exploration of DG methods tailored for [multiphase flow simulation](@entry_id:752305), guiding you from fundamental theory to state-of-the-art applications.

You will begin by learning the core **Principles and Mechanisms** of the DG method, from its fundamental mathematical formulation and the pivotal role of [numerical fluxes](@entry_id:752791) to the implementation details that ensure stability and efficiency. Next, the article explores **Applications and Interdisciplinary Connections**, demonstrating how the DG framework is used to model complex [interface physics](@entry_id:143998), enforce physical laws like [thermodynamic consistency](@entry_id:138886), and solve coupled problems in fields ranging from [phase change](@entry_id:147324) to non-Newtonian fluid dynamics. Finally, a series of **Hands-On Practices** will provide you with the opportunity to implement and test key DG concepts, cementing your understanding of how to build robust and accurate [multiphase flow](@entry_id:146480) solvers.

## Principles and Mechanisms

The Discontinuous Galerkin (DG) method offers a powerful and flexible framework for the [numerical simulation](@entry_id:137087) of multiphase flows, adeptly handling complex geometries, sharp interface dynamics, and the disparate physical scales inherent in these systems. This chapter elucidates the core principles and mechanisms of DG methods as applied to [multiphase flow](@entry_id:146480), progressing from the fundamental formulation for simple transport to advanced techniques for ensuring stability, accuracy, and efficiency in complex, realistic scenarios.

### The Discontinuous Galerkin Formulation

The foundation of the DG method lies in its unique combination of finite element and [finite volume](@entry_id:749401) concepts. We begin by deriving its structure for a general [scalar conservation law](@entry_id:754531), a ubiquitous component in multiphase models for quantities such as volume fraction or species concentration. Consider a [scalar conservation law](@entry_id:754531) on a domain $\Omega$:
$$
\frac{\partial u}{\partial t} + \nabla \cdot \mathbf{f}(u, \mathbf{x}) = 0
$$
The domain $\Omega$ is partitioned into a mesh of non-overlapping elements, $K$. The core idea of the DG method is to seek an approximate solution $u_h$ that is a polynomial within each element but is allowed to be discontinuous across element boundaries. This is in stark contrast to continuous [finite element methods](@entry_id:749389), where continuity is enforced across element boundaries.

To derive the [weak formulation](@entry_id:142897), we multiply the PDE by a test function $v_h$, which belongs to the same space of [piecewise polynomials](@entry_id:634113) as $u_h$, and integrate over a single element $K$:
$$
\int_{K} \frac{\partial u_h}{\partial t} v_h \, \mathrm{d}\mathbf{x} + \int_{K} (\nabla \cdot \mathbf{f}(u_h, \mathbf{x})) v_h \, \mathrm{d}\mathbf{x} = 0
$$
Applying the divergence theorem (integration by parts) to the flux term transfers the spatial derivative from the potentially discontinuous flux $\mathbf{f}(u_h, \mathbf{x})$ to the smooth test function $v_h$:
$$
\int_{K} \frac{\partial u_h}{\partial t} v_h \, \mathrm{d}\mathbf{x} - \int_{K} \mathbf{f}(u_h, \mathbf{x}) \cdot \nabla v_h \, \mathrm{d}\mathbf{x} + \int_{\partial K} (\mathbf{n}_K \cdot \mathbf{f}(u_h, \mathbf{x})) v_h \, \mathrm{d}s = 0
$$
Here, $\partial K$ is the boundary of element $K$ and $\mathbf{n}_K$ is its unit outward normal. The central challenge and defining feature of the DG method emerges in the boundary integral. Because $u_h$ is discontinuous, the value of the flux trace $\mathbf{n}_K \cdot \mathbf{f}(u_h, \mathbf{x})$ is ambiguous at an interface shared by two elements.

To resolve this ambiguity and define a coupling between elements, the physical flux trace is replaced by a **[numerical flux](@entry_id:145174)**, denoted $\widehat{\mathbf{f}}$. The numerical flux is a single-valued function defined on each face of the mesh, which depends on the two states on either side of the face, typically denoted $u_h^{-}$ (the interior trace) and $u_h^{+}$ (the exterior trace from the neighboring element). The DG weak formulation thus becomes:
$$
\int_{K} \frac{\partial u_h}{\partial t} v_h \, \mathrm{d}\mathbf{x} - \int_{K} \mathbf{f}(u_h, \mathbf{x}) \cdot \nabla v_h \, \mathrm{d}\mathbf{x} + \int_{\partial K} (\mathbf{n}_K \cdot \widehat{\mathbf{f}}(u_h^{-}, u_h^{+})) v_h^{-} \, \mathrm{d}s = 0
$$
For the method to be valid, the numerical flux must satisfy two key properties:
1.  **Consistency**: If the states on both sides of the interface are identical, $u^{-} = u^{+} = u$, the numerical flux must revert to the physical flux: $\widehat{\mathbf{f}}(u, u) = \mathbf{f}(u)$.
2.  **Conservation**: On any interior face shared by elements $K^{-}$ and $K^{+}$, the flux seen by $K^{-}$ must be equal and opposite to the flux seen by $K^{+}$ (accounting for the opposite normal vectors). This ensures that when the [weak form](@entry_id:137295) is summed over all elements, the interior face contributions cancel perfectly, leading to global conservation of the quantity $u$. 

By choosing a basis for the [polynomial space](@entry_id:269905) within each element (e.g., modal or nodal), this [integral equation](@entry_id:165305) is transformed into a system of ordinary differential equations (ODEs) for the time-dependent coefficients of the solution. This is known as the **semi-discrete** formulation. For example, considering the variable-density advection equation $(\rho u)_t + \nabla \cdot (\rho \mathbf{a} u) = 0$ with a piecewise constant density $\rho$ and basis functions $\phi_{K,i}$, the evolution equation for the $i$-th modal coefficient $U_{K,i}$ on element $K$ takes the form of a residual that must be driven to zero. This residual consists of three distinct parts: a **[mass matrix](@entry_id:177093)** term from the time derivative, an **interior advection** contribution from the [volume integral](@entry_id:265381), and the **face flux contributions** from the boundary integral involving the [numerical flux](@entry_id:145174). 

### Numerical Fluxes for Multiphase Systems

The choice of numerical flux is paramount to the stability and accuracy of a DG scheme, particularly for multiphase flows where sharp gradients, discontinuous material properties, and complex wave structures are prevalent.

#### Foundational Numerical Fluxes

For many problems, simple and robust numerical fluxes suffice. The **[upwind flux](@entry_id:143931)** is a natural choice for [advection-dominated problems](@entry_id:746320). It selects the flux based on the direction of information flow, given by the sign of the normal velocity. For the variable-density advection equation with flux $\mathbf{f} = \rho \mathbf{a} u$, the normal component of the upwind [numerical flux](@entry_id:145174) is given by:
$$
\mathbf{n} \cdot \widehat{\mathbf{f}} = \begin{cases} (\mathbf{a} \cdot \mathbf{n}) \rho^{-} u^{-}  \text{if } \mathbf{a} \cdot \mathbf{n} \ge 0 \\ (\mathbf{a} \cdot \mathbf{n}) \rho^{+} u^{+}  \text{if } \mathbf{a} \cdot \mathbf{n}  0 \end{cases}
$$
where the superscripts $-$ and $+$ denote the states on the upwind and downwind sides relative to the normal vector $\mathbf{n}$. 

A more general and highly robust option is the **Local Lax-Friedrichs (LLF) flux**, also known as the **Rusanov flux**. It is constructed by averaging the physical fluxes from both sides of the interface and adding a dissipative term proportional to the jump in the solution variables. For a scalar problem, its normal component is:
$$
\mathbf{n}\cdot \widehat{\mathbf{f}}(u^{-},u^{+}) = \frac{1}{2}\left(\mathbf{n}\cdot \mathbf{f}(u^{-}) + \mathbf{n}\cdot \mathbf{f}(u^{+})\right) - \frac{1}{2} s_{e} \left(u^{+} - u^{-}\right)
$$
The [stabilization parameter](@entry_id:755311) $s_e$ must be an upper bound on the fastest local characteristic wave speed, $s_e \ge \max(|\lambda^{-}|, |\lambda^{+}|)$. This diffusive term ensures stability by penalizing discontinuities but can also introduce unwanted [numerical smearing](@entry_id:168584) if $s_e$ is excessively large. Even when material properties, such as the advective [velocity field](@entry_id:271461), are discontinuous across an interface, the LLF flux provides a consistent and [conservative coupling](@entry_id:747708) mechanism. 

#### Advanced Fluxes for Compressible Multiphase Flow

For complex systems like the compressible Euler equations, which govern the dynamics of compressible multiphase mixtures, more sophisticated [numerical fluxes](@entry_id:752791) are required. These are often based on **approximate Riemann solvers**, which provide a more detailed and physically accurate description of the wave structure at an interface.

A powerful choice for multiphase flows is the **HLLC (Harten-Lax-van Leer-Contact)** approximate Riemann solver. The standard HLL solver approximates the Riemann fan with two outer waves (left- and right-going shocks or rarefactions). The HLLC solver extends this by adding a third, middle wave representing the [contact discontinuity](@entry_id:194702). This is crucial for [multiphase flow](@entry_id:146480) because [material interfaces](@entry_id:751731) behave as [contact discontinuities](@entry_id:747781). By explicitly resolving this wave, the HLLC solver can accurately advect interfaces with minimal smearing. A key design principle is the enforcement of continuous pressure and velocity across the contact wave, a property derived from the Rankine-Hugoniot jump conditions. This leads to a specific formula for the contact [wave speed](@entry_id:186208), $S_*$, in terms of the initial left and right states and the outer wave speed estimates.  For robustness, especially when dealing with large density and sound speed contrasts (e.g., a liquid-gas interface), these outer wave speeds are often chosen using conservative estimates like the Einfeldt bounds. 

Even with advanced solvers, a significant challenge remains at [material interfaces](@entry_id:751731) where different [equations of state](@entry_id:194191) (EOS) are used. Consider a stationary [contact discontinuity](@entry_id:194702) where pressure and velocity are in equilibrium. Due to different material properties (e.g., the stiffness parameter $\pi_\infty$ in a stiffened-gas EOS), the total energy $E$ can be discontinuous. A standard [conservative scheme](@entry_id:747714) will interpret this jump in $E$ as a non-[equilibrium state](@entry_id:270364) and generate spurious pressure oscillations. The **Double-Flux method** is a specialized technique designed to mitigate this issue. It modifies the dissipation term of an LLF-type flux. Instead of applying dissipation to the jump in total energy, $(E^{+} - E^{-})$, it is applied to the jump in a modified energy-like variable, $Q = E - \frac{\gamma \pi_{\infty}}{\gamma - 1}$. This variable $Q$ is constructed to be more continuous across a [contact discontinuity](@entry_id:194702) than $E$. This targeted modification significantly reduces non-physical pressure waves. Critically, the Double-Flux method is provably **consistent**: in regions with a single material, the modified flux identically reduces to the standard conservative flux, ensuring the scheme is not altered away from [material interfaces](@entry_id:751731). 

### Implementation, Stability, and Efficiency

Moving from theory to a practical high-order DG implementation requires addressing several key aspects related to stability, efficiency, and geometric flexibility.

#### High-Order Basis, Quadrature, and Aliasing

The [spectral accuracy](@entry_id:147277) of DG methods is achieved by using high-order polynomials, such as the orthogonal **Legendre polynomials**, as a basis within each element. In a modal DG framework, the solution is represented as a sum of these basis functions. The resulting semi-discrete system involves elemental matrices, such as the **[mass matrix](@entry_id:177093)** $M_{ij} = \int_{K} P_i P_j \,dx$ and the **[stiffness matrix](@entry_id:178659)** $S_{ij} = \int_{K} P_i P'_j \,dx$. Due to the orthogonality of Legendre polynomials, the [mass matrix](@entry_id:177093) is diagonal, which greatly simplifies inverting it for [explicit time-stepping](@entry_id:168157) schemes. The [stiffness matrix](@entry_id:178659) is non-zero only for basis functions of different parity, giving it a sparse, structured form. 

The integrals required to form these matrices and evaluate the [weak form](@entry_id:137295) are computed using [numerical quadrature](@entry_id:136578). For nonlinear fluxes $\mathbf{f}(u)$, the integrand in the volume term, $\mathbf{f}(u_h) \cdot \nabla v_h$, is a polynomial of higher degree than the basis itself. For example, if $u_h$ and $v_h$ are degree-$p$ polynomials and the flux is quadratic (e.g., $f(u)=u^2$), the integrand can be of degree up to $3p-1$. If the quadrature rule is not accurate enough to integrate this polynomial exactly, a phenomenon known as **aliasing** occurs. The quadrature rule misinterprets the high-frequency content of the integrand as low-frequency information, introducing errors that can violate discrete conservation properties and lead to catastrophic [numerical instability](@entry_id:137058). 

To prevent this, DG methods for nonlinear problems employ **over-integration** (or [de-aliasing](@entry_id:748234)), where a [quadrature rule](@entry_id:175061) is chosen to be exact for the true polynomial degree of the nonlinear integrand. For instance, a Gauss-Legendre quadrature with $N_q$ points is exact for polynomials of degree up to $2N_q-1$. To exactly integrate a cubic nonlinearity from a degree-$p$ basis (an integrand of degree up to $3p-1$), one requires $2N_q-1 \ge 3p-1$, which implies a minimum of $N_q = \lceil 3p/2 \rceil$ quadrature points. This is a higher number than required for linear problems ($N_q = p+1$) but is essential for the stability of the simulation.  

#### Computational Efficiency and Geometric Flexibility

While [high-order methods](@entry_id:165413) offer superior accuracy, their computational cost can be prohibitive, especially in multiple dimensions. A naive evaluation of the [volume integrals](@entry_id:183482) on a $d$-dimensional tensor-product element using degree-$p$ polynomials involves operators of size $(p+1)^d \times (p+1)^d$, leading to a computational cost that scales as $\mathcal{O}(p^{2d})$. A key algorithmic innovation that makes high-order DG practical is **sum-factorization**. This technique exploits the tensor-product structure of the basis functions and quadrature points on quadrilateral and [hexahedral elements](@entry_id:174602). Instead of applying a large, dense $d$-dimensional operator, the operation is broken down into a sequence of $d$ one-dimensional operations along each coordinate axis. This reduces the computational complexity for [volume integrals](@entry_id:183482) to a much more manageable $\mathcal{O}(p^{d+1})$, enabling efficient high-order simulations in 2D and 3D. 

Another primary advantage of DG methods is their flexibility in handling complex geometries. For domains with **[curved elements](@entry_id:748117)**, an [isoparametric mapping](@entry_id:173239) $\mathbf{x}(\boldsymbol{\xi})$ is used to transform a simple [reference element](@entry_id:168425) (e.g., a square or cube) into the curved physical element. All calculations are then performed on the reference element. This transformation introduces geometric factors, or **metric terms**, such as the Jacobian determinant $J$ and the components of the inverse Jacobian matrix, into the [weak formulation](@entry_id:142897). The conservation laws must be transformed into the reference coordinate system, resulting in a formulation involving contravariant fluxes. A subtle but critical requirement for accuracy on curved or moving meshes is the satisfaction of the **Geometric Conservation Law (GCL)**. The GCL is an identity that the [discrete metric](@entry_id:154658) terms must satisfy to ensure that the scheme can exactly preserve a simple free-stream or constant state. Analytically, the GCL holds if the mapping is sufficiently smooth. Numerically, it requires a consistent computation of the geometric factors and integrals to avoid introducing artificial source terms that can degrade accuracy and stability. 

### Advanced Interface Capturing and Treatment

Finally, we consider specialized DG techniques for the primary task in [multiphase flow](@entry_id:146480): capturing the motion and dynamics of the interface between phases.

#### Bound-Preserving Volume Fraction Methods

One major class of interface-capturing methods is based on the transport of a **volume fraction** field, $\alpha$, which is typically 1 in one phase and 0 in the other. A key physical constraint is that $\alpha$ must remain within the bounds $[0,1]$. Standard DG schemes do not automatically enforce this. To ensure physical solutions, the DG scheme must be augmented with a **bound-preserving limiter**. A common approach is the scaling limiter of Zhang and Shu, which modifies the polynomial solution at the end of a time step to satisfy the bounds at specific quadrature nodes while conserving the cell average.

For such a limiter to be applicable, the underlying DG scheme must first produce a cell average that is within the physical bounds. This imposes a constraint on the time step, known as a **Courant-Friedrichs-Lewy (CFL) condition**. A sufficient CFL condition can be derived by analyzing the forward Euler update and requiring that it can be written as a convex combination of values from the previous time step. For a 1D DG scheme with polynomials of degree $p$ and a local Lax-Friedrichs flux, this condition takes the form $\Delta t \cdot s_{\text{LF}} / h \le 1/(2p+1)$, where $s_{\text{LF}}$ is the maximum [wave speed](@entry_id:186208) (the Lipschitz constant of the flux function). This condition links the time step $\Delta t$, mesh size $h$, polynomial degree $p$, and the physics of the problem (via $s_{\text{LF}}$) to guarantee the robustness of the scheme. This framework can be applied even to complex nonlinear models, such as those including **interface-compression** terms designed to counteract [numerical diffusion](@entry_id:136300) and maintain sharp interfaces. 

#### The Level Set Method

An alternative and widely used interface-capturing strategy is the **[level set method](@entry_id:137913)**. Here, the interface is implicitly represented as the zero contour of a smooth, continuous function $\phi(\mathbf{x}, t)$, typically a [signed distance function](@entry_id:144900). The evolution of the interface is then governed by the advection of this [level set](@entry_id:637056) function: $\phi_t + \mathbf{u} \cdot \nabla \phi = 0$. The DG method can be readily applied to discretize this [linear advection equation](@entry_id:146245). 

A practical issue with the [level set method](@entry_id:137913) is that the advection can distort the field $\phi$ such that it no longer represents a signed distance. To maintain accuracy, a **[reinitialization](@entry_id:143014)** step is periodically performed, which reshapes $\phi$ back into a [signed distance function](@entry_id:144900) without moving the interface (the zero [level set](@entry_id:637056)). This is achieved by solving a Hamilton-Jacobi equation in pseudo-time $\tau$:
$$
\phi_{\tau} + S(\phi^0)(|\nabla\phi| - 1) = 0
$$
Here, $\phi^0$ is the [level set](@entry_id:637056) field before [reinitialization](@entry_id:143014) and $S$ is a sign function. The crucial feature is that at the interface, where $\phi^0=0$, the sign function $S(0)=0$. This makes the evolution term vanish, and the equation becomes $\phi_{\tau} = 0$. Consequently, the value of $\phi$ at the interface does not change during [reinitialization](@entry_id:143014), and the interface geometry is perfectly conserved. This property is respected by consistent DG discretizations of the [reinitialization](@entry_id:143014) equation, making the combination of DG and the [level set method](@entry_id:137913) a powerful and geometrically faithful approach for complex interface dynamics. 