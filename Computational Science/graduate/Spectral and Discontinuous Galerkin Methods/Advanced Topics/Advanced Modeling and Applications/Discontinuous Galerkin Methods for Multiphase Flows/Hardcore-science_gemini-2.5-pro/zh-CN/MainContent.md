## 引言
[多相流](@entry_id:146480)现象在自然界和工业应用中无处不在，从沸腾的水到燃料喷雾，再到生物系统中的血液流动。精确地模拟这些流动是工程设计和科学研究的关键，但其本身也充满了挑战。[多相流](@entry_id:146480)的核心难点在于如何准确地捕捉和演化不同相之间的尖锐界面，以及如何处理跨越界面时流体属性（如密度和粘度）的剧烈变化。传统的数值方法在同时保证[高阶精度](@entry_id:750325)和严格守恒性方面常常捉襟见肘，尤其是在处理复杂的界面[拓扑变化](@entry_id:136654)时。

为了应对这些挑战，间断伽辽金（Discontinuous Galerkin, DG）方法作为一种强大的高阶数值框架应运而生。DG方法巧妙地结合了[有限元法](@entry_id:749389)的灵活性（适用于复杂几何）和[有限体积法](@entry_id:749372)的守恒性与处理间断的能力。它通过在计算单元的边界上允许解存在间断，并利用黎曼问题的思想设计“[数值通量](@entry_id:752791)”来连接相邻单元，从而为[多相流模拟](@entry_id:752305)提供了一个既精确又稳健的数学基础。

本文将系统性地引导读者深入了解用于[多相流](@entry_id:146480)的DG方法。在接下来的章节中，我们将：
- 在 **“原理与机制”** 中，奠定[DG方法](@entry_id:748369)的理论基石，详细解析其弱形式、处理物质间断性的[数值通量](@entry_id:752791)设计，以及[界面追踪](@entry_id:750734)和捕捉的关键技术。
- 在 **“应用与交叉学科联系”** 中，展示[DG方法](@entry_id:748369)在解决真实世界问题中的强大能力，从提升界面模拟保真度到处理[相变](@entry_id:147324)和[湍流](@entry_id:151300)等复杂物理，并探讨其在化学工程、[材料科学](@entry_id:152226)等领域的交叉应用。
- 在 **“动手实践”** 中，提供一系列精心设计的编程练习，帮助读者将理论知识转化为实践技能，亲手实现和测试DG方法的核心组件。

通过这三个部分的学习，读者将能够全面掌握DG方法在[多相流](@entry_id:146480)领域的理论精髓、应用广度与实践深度。

## 原理与机制

本章深入探讨了用于[多相流](@entry_id:146480)问题的间断伽辽金（DG）方法的核心原理和关键机制。我们从建立控制方程的[DG弱形式](@entry_id:748377)化出发，重点讨论确保跨物质界面守恒性的数值通量。随后，我们将研究为可压缩[多相流](@entry_id:146480)设计的先进[数值通量](@entry_id:752791)，以及用于[界面追踪](@entry_id:750734)和捕捉的特定方法。最后，本章将介绍一些有关实现、稳定性和[计算效率](@entry_id:270255)的高级主题，包括[非线性](@entry_id:637147)稳定性的求积法则、高维单元上的高效算子求值以及在复杂几何中的应用。

### [DG离散化](@entry_id:748366)的核心：[弱形式](@entry_id:142897)与[数值通量](@entry_id:752791)

[间断伽辽金方法](@entry_id:748369)的基础在于其单元（element-wise）弱形式的构建。考虑一个定义在有界域 $\Omega$ 上的[标量守恒律](@entry_id:754532)，这可以代表[多相流](@entry_id:146480)中的一个输运量，如体积分数：
$$
\frac{\partial u}{\partial t} + \nabla \cdot \mathbf{f}(u, \mathbf{x}) = 0
$$
[DG方法](@entry_id:748369)首先将计算域 $\Omega$ 剖分为一个由互不重叠的单元 $K$ 组成的网格 $\mathcal{T}_h$。与连续有限元方法不同，DG方法的解 $u_h$ 在单元边界上可以是间断的。在一个任意单元 $K$ 上，我们将上述[偏微分方程](@entry_id:141332)乘以一个取自相同间断[多项式空间](@entry_id:144410)的测试函数 $v_h$，然后进行积分：
$$
\int_{K} \frac{\partial u_h}{\partial t} v_h \, \mathrm{d}\mathbf{x} + \int_{K} (\nabla \cdot \mathbf{f}(u_h, \mathbf{x})) v_h \, \mathrm{d}\mathbf{x} = 0
$$
应用散度定理（或[分部积分](@entry_id:136350)）于第二个通量项，我们得到：
$$
\int_{K} \frac{\partial u_h}{\partial t} v_h \, \mathrm{d}\mathbf{x} - \int_{K} \mathbf{f}(u_h, \mathbf{x}) \cdot \nabla v_h \, \mathrm{d}\mathbf{x} + \int_{\partial K} (\mathbf{f}(u_h, \mathbf{x}) \cdot \mathbf{n}_{K}) v_h \, \mathrm{d}s = 0
$$
其中 $\partial K$ 是单元 $K$ 的边界，$\mathbf{n}_{K}$ 是其单位外法向向量。

这个公式的核心挑战在于边界积分项 $\int_{\partial K} (\mathbf{f} \cdot \mathbf{n}_{K}) v_h \, \mathrm{d}s$。由于解 $u_h$ 在单元间是间断的，在任意一个内部界面 $e$ 上，存在两个[迹线](@entry_id:261720)值：来自单元内部的 $u_h^-$ 和来自相邻单元的 $u_h^+$。这使得物理通量 $\mathbf{f} \cdot \mathbf{n}_{K}$ 的定义变得模糊。[DG方法](@entry_id:748369)的关键思想是用一个单值的**数值通量 (numerical flux)** $\widehat{\mathbf{f}}$ 来替代不明确的物理通量。这个数值通量依赖于界面两侧的状态，即 $\widehat{\mathbf{f}}(u_h^-, u_h^+)$。因此，[DG弱形式](@entry_id:748377)写为：
$$
\int_{K} \frac{\partial u_h}{\partial t} v_h \, \mathrm{d}\mathbf{x} - \int_{K} \mathbf{f}(u_h, \mathbf{x}) \cdot \nabla v_h \, \mathrm{d}\mathbf{x} + \int_{\partial K} (\widehat{\mathbf{f}}(u_h^-, u_h^+) \cdot \mathbf{n}_{K}) v_h^- \, \mathrm{d}s = 0
$$
为了确保全局守恒性，[数值通量](@entry_id:752791)必须是**守恒的**。这意味着在一个共享界面上，相邻两个单元使用的数值通量大小相等、方向相反。这样，当我们将所有单元的[弱形式](@entry_id:142897)方程相加时，所有内部界面的通量贡献会精确抵消，从而保证了离散解在全局意义上是守恒的 。

### 处理物质间断性

[多相流](@entry_id:146480)的一个显著特征是流体属性（如密度、粘度或状态方程参数）在物质界面上可能存在剧烈跳跃。[DG方法](@entry_id:748369)通过数值通量的设计，能够自然地处理这些间断性。

一个基本的例子是考虑一个变密度平流方程 $(\rho u)_t + \nabla \cdot (\rho \mathbf{a} u) = 0$，其中密度 $\rho(\mathbf{x})$ 是分片常数，而速度场 $\mathbf{a}(\mathbf{x})$ 是给定的连续场 。这里的守恒通量是 $\mathbf{F} = \rho \mathbf{a} u$。一个简单而有效的数值通量是**[迎风通量](@entry_id:143931) (upwind flux)**。其思想是通量的值应由信息传播方向上游的状态决定。对于平流问题，传播方向由法向速度 $\mathbf{a} \cdot \mathbf{n}$ 的符号确定。在单元 $K$ 的一个界面上，其法向为 $\mathbf{n}_K$，[迎风通量](@entry_id:143931)可以写为：
$$
\widehat{\mathbf{F}}_n = (\rho \mathbf{a} u \cdot \mathbf{n}_K)^* = (\mathbf{a} \cdot \mathbf{n}_K) \times \begin{cases} (\rho u)^{\text{int}}  \text{若 } \mathbf{a} \cdot \mathbf{n}_K \ge 0 \\ (\rho u)^{\text{ext}}  \text{若 } \mathbf{a} \cdot \mathbf{n}_K \lt 0 \end{cases}
$$
其中 $(\rho u)^{\text{int}}$ 和 $(\rho u)^{\text{ext}}$ 分别是来自单元内部和外部的[迹线](@entry_id:261720)值。这种选择确保了数值格式的稳定性，因为它天然地引入了耗散，以抑制由离散化引起的非物理[振荡](@entry_id:267781)。

对于更一般的[非线性](@entry_id:637147)[双曲系统](@entry_id:260647)，一个常用的选择是**局部Lax-Friedrichs (LFF) 通量**，也称为[Rusanov通量](@entry_id:637224) 。它在两个物理通量的平均值基础上，增加了一个与解的跳跃成正比的[人工耗散](@entry_id:746522)项：
$$
\mathbf{n} \cdot \widehat{\mathbf{f}}(u^-, u^+) = \frac{1}{2}\left(\mathbf{n} \cdot \mathbf{f}(u^{-}) + \mathbf{n} \cdot \mathbf{f}(u^{+})\right) - \frac{1}{2} s_e (u^{+} - u^{-})
$$
稳定化参数 $s_e$ 必须大于或等于界面两侧法向特征速度的[绝对值](@entry_id:147688)的最大值，即 $s_e = \max(|\lambda^{-}|, |\lambda^{+}|)$，其中 $\lambda^{\pm} = |\mathbf{n} \cdot \frac{\partial \mathbf{f}}{\partial u}(u^{\pm})|$。这个参数确保了数值区域的依赖性包含了物理区域的依赖性，从而保证了稳定性。例如，对于平流问题 $\mathbf{f}(u, \mathbf{x}) = \mathbf{v}(\mathbf{x}) u$，特征速度就是法向速度 $|\mathbf{n} \cdot \mathbf{v}|$。即使[速度场](@entry_id:271461) $\mathbf{v}$ 本身是间断的，只要我们为每个单元界面定义一个统一的 $s_e$ 和数值通量，DG方法就能严格保证跨物质界面的通量守恒 。

### 用于可压缩[多相流](@entry_id:146480)的先进数值通量

对于更复杂的可压缩[多相流](@entry_id:146480)，简单的数值通量可能不足以精确捕捉关键的物理现象。特别是在物质界面处，压力和速度可能连续，但密度和能量会发生剧烈跳跃。

**HLLC [近似黎曼求解器](@entry_id:267136)**
为了准确模拟这类接触间断，需要使用更精密的[数值通量](@entry_id:752791)，如 **HLLC（Harten-Lax-van Leer-Contact）[近似黎曼求解器](@entry_id:267136)** 。[HLLC求解器](@entry_id:750352)假设[黎曼问题](@entry_id:171440)的解由三道波构成：一道左行波（速度 $S_L$）、一道右[行波](@entry_id:185008)（速度 $S_R$）和中间的一道[接触间断](@entry_id:194702)（速度 $S_*$）。这种结构可以精确地保持压力和法向速度在接触间断上的连续性。接触波速度 $S_*$ 可以通过在左右两道波上应用Rankine-Hugoniot跳跃关系推导得出。在初始压力平衡（$p_L = p_R$）的常见情况下，其表达式为：
$$
S_* = \frac{\rho_R u_R (S_R - u_R) - \rho_L u_L (S_L - u_L)}{\rho_R (S_R - u_R) - \rho_L (S_L - u_L)}
$$
[HLLC通量](@entry_id:750350)的使用对于避免在物质界面（如气液界面）产生非物理的压力[振荡](@entry_id:267781)至关重要。

**双通量方法 (Double-Flux Method)**
当使用刚性气体状态方程（stiffened-gas EOS）模拟具有较大密度比的材料（如水和空气）时，即使是[HLLC求解器](@entry_id:750352)也可能在静止的接触间断处产生虚假的压力[振荡](@entry_id:267781)。这是因为不同材料的刚度参数 $\pi_\infty$ 会导致总能量 $E$ 在界面上存在巨大的跳跃，即使压力和速度是连续的。**双通量方法**  旨在解决此问题。它通过修改能量方程的耗散项来发挥作用。该方法引入了一个修正的能量类变量 $Q = E - \frac{\gamma \pi_\infty}{\gamma - 1}$。这个变量 $Q$ 与压力的关系更直接，且不受 $\pi_\infty$ 影响。在数值通量中，用 $Q_R - Q_L$ 替代标准的 $E_R - E_L$ 来计算[能量耗散](@entry_id:147406)。
$$
\widehat{\mathbf{F}}_{\mathrm{DF}} = \tfrac{1}{2}(\mathbf{F}_L + \mathbf{F}_R) - \tfrac{1}{2} a_{\max} 
\begin{bmatrix}
\rho_R - \rho_L \\
(\rho u)_R - (\rho u)_L \\
Q_R - Q_L
\end{bmatrix}
$$
这种修正能够显著减少由于不同材料EO[S参数](@entry_id:754557)失配而引入的非物理[能量耗散](@entry_id:147406)，从而在保持界面压[力平衡](@entry_id:267186)方面表现出色。重要的是，可以证明在单一材料区域，$\gamma$ 和 $\pi_\infty$ 是常数，此时 $Q_R - Q_L = E_R - E_L$，双通量格式自动退化为标准格式，保证了方法的一致性 。

### [界面追踪](@entry_id:750734)与捕捉方法

在许多[多相流](@entry_id:146480)应用中，明确地追踪或捕捉[相界面](@entry_id:172947)的位置和形状至关重要。[DG方法](@entry_id:748369)可与多种界面处理技术相结合。

**[流体体积法](@entry_id:756561) (Volume-of-Fluid, VOF)**
VOF方法通过求解一个[体积分数](@entry_id:756566)场 $\alpha$ 的输运方程来捕捉界面。$\alpha$ 代表计算单元中某一相所占的体积分数，其值在0和1之间。一个关键挑战是，[数值耗散](@entry_id:168584)会使原本清晰的界面（$\alpha$ 从0到1的阶跃）变得模糊。为了对抗这种模糊，可以在[输运方程](@entry_id:756133)中引入一个[非线性](@entry_id:637147)的**界面压缩项** ，例如：
$$
\partial_t \alpha + \partial_x (u \alpha) + \partial_x (\kappa |u| s(x,t) \alpha (1-\alpha)) = 0
$$
这里的第三项是一个人工通量，仅在界面区域（即 $\alpha$ 介于0和1之间）起作用，其效果是将弥散的界面“压缩”回更清晰的形态。

另一个挑战是确保 $\alpha$ 的值始终保持在物理区间 $[0, 1]$ 内。高阶[DG方法](@entry_id:748369)即使对于线性问题也可能产生超调和下冲，导致非物理的 $\alpha$ 值。一种有效的策略是采用**保界限幅器 (bound-preserving limiter)**。例如，Zhang-Shu限制器可以在每个时间步结束后，在不改变单元平均值的前提下，对单元内的多项式解进行缩放，以确保在特定求积节点上的值满足物理界限。为了使这种限制器有效，必须保证单元平均值本身在更新后仍在 $[0, 1]$ 内。这通常可以通过一个充分的CFL条件来保证。对于一个$p$阶[DG格式](@entry_id:178043)，该条件的形式通常为 $\frac{\Delta t \cdot s_{\mathrm{LF}}}{h} \le \frac{1}{2p+1}$，其中 $s_{\mathrm{LF}}$ 是与总通量相关的最大波速 。

**[水平集方法](@entry_id:165633) (Level Set Method, LSM)**
[水平集方法](@entry_id:165633)将界面隐式地表示为一个[连续函数](@entry_id:137361) $\phi$ 的零[等值面](@entry_id:196027)（zero level set）。界面的演化通过求解 $\phi$ 的平流方程来实现：
$$
\phi_t + \mathbf{u} \cdot \nabla \phi = 0
$$
该方程可以用标准的[DG方法](@entry_id:748369)进行离散化 。[水平集方法](@entry_id:165633)的一个优点是它能自然地处理复杂的[拓扑变化](@entry_id:136654)，如界面的合并与分裂。然而，在[平流](@entry_id:270026)过程中，$\phi$ 场可能会发生畸变，不再保持其作为[符号距离函数](@entry_id:754834)的理想属性（即 $|\nabla \phi| = 1$）。

为了恢复这一属性，需要周期性地进行**重新初始化 (reinitialization)**。这通过在伪时间 $\tau$ 中求解一个[Hamilton-Jacobi方程](@entry_id:145701)来实现：
$$
\phi_{\tau} + S_{\epsilon}(\phi^0) (|\nabla \phi| - 1) = 0
$$
其中 $\phi^0$ 是重新初始化之前的水平集场，$S_{\epsilon}$ 是一个光滑的[符号函数](@entry_id:167507)。这个过程的关键在于，在界面上（$\phi^0=0$），$S_{\epsilon}(0)=0$，因此方程退化为 $\phi_{\tau}=0$。这意味着在重新初始化过程中，零[等值面](@entry_id:196027)的位置保持不变，从而保证了界面几何的守恒性。当用DG方法离散化该方程时，只要使用一致的数值通量，这一重要性质同样能在离散层面得到保持 。

### 实现、稳定性与效率

将DG方法应用于实际[多相流](@entry_id:146480)问题时，必须考虑其实现细节、[数值稳定性](@entry_id:146550)及[计算效率](@entry_id:270255)。

**[非线性](@entry_id:637147)稳定性与求积**
[DG弱形式](@entry_id:748377)中的积分通常采用[高斯求积](@entry_id:146011)等数值方法计算。对于[非线性](@entry_id:637147)问题，如果求积的精度不足，会导致**混淆误差 (aliasing error)**，这可能破坏离散算子的对称性或反对称性，从而引入虚假的能量产生，导致[数值不稳定性](@entry_id:137058)。例如，考虑一个[非线性](@entry_id:637147)平流通量 $f(u) = \alpha u$ ，其在[弱形式](@entry_id:142897)的体积项中表现为 $(\alpha_h u_h)(\partial_x v_h)$。如果 $\alpha_h, u_h, v_h$ 都是 $p$ 阶多项式，那么被积函数将是一个最高达 $(p+p+(p-1)) = 3p-1$ 阶的多项式。为了精确计算该积分，避免混淆误差，高斯求积规则需要至少 $\lceil \frac{3p}{2} \rceil$ 个求积点。这种使用比线性问题所需更多的求积点的做法被称为**[过积分](@entry_id:753033) (over-integration)** 或去混淆 (de-aliasing)，对于确保[非线性](@entry_id:637147)问题的[能量稳定性](@entry_id:748991)至关重要  。

**[计算效率](@entry_id:270255)：求和分解**
高阶DG方法的计算成本可能很高。一个 $d$ 维单元上的 $p$ 阶多项式[基函数](@entry_id:170178)有 $\mathcal{O}((p+1)^d)$ 个自由度。若直接计算体积项积分，例如使用一个密集的[刚度矩阵](@entry_id:178659)，其操作数可达 $\mathcal{O}((p+1)^{2d})$。对于在四边形或六面体等张量积单元上的[高阶谱](@entry_id:191458)[DG方法](@entry_id:748369)，可以采用**求和分解 (sum-factorization)** 技术来大幅降低计算成本 。其核心思想是将多维算子（如插值或[微分](@entry_id:158718)）的张量积结构分解为一系列一维算子。例如，将节点值插值到求积点的操作可以沿每个坐标轴顺序执行。这种方法将计算复杂度从 $\mathcal{O}((p+1)^{2d})$ 降低到 $\mathcal{O}(d(p+1)^{d+1})$，使得高阶方法在计算上变得可行。

**复杂几何：弯曲单元与[几何守恒律](@entry_id:170384)**
为了模拟复杂的几何[外形](@entry_id:146590)，DG方法常使用**弯曲单元 (curved elements)**。这通常通过一个从标准[参考单元](@entry_id:168425)（如正方形或立方体）到物理弯曲单元的**[等参映射](@entry_id:173239)** $\mathbf{x}(\boldsymbol{\xi})$ 来实现。在进行这种坐标变换后，[DG弱形式](@entry_id:748377)中的所有积分都在[参考单元](@entry_id:168425)上进行。变换会引入映射的**[雅可比行列式](@entry_id:137120) (Jacobian determinant)** $J$ 和**度量张量 (metric terms)** 。例如，物理[散度算子](@entry_id:265975) $\nabla_x \cdot \mathbf{F}$ 变换为 $\frac{1}{J} \nabla_\xi \cdot (J \mathbf{J}^{-1} \mathbf{F})$，其中 $\mathbf{J}$ 是映射的[雅可比矩阵](@entry_id:264467)。

在离散格式中，度量张量和[雅可比](@entry_id:264467)必须被精确计算和处理。一个关键要求是离散格式必须满足**[几何守恒律](@entry_id:170384) (Geometric Conservation Law, GCL)**。GCL要求，即使在弯曲网格上，一个常数流场（例如，均匀来流）也应该被精确地保持。在分析上，这要求映射的二阶[混合偏导数相等](@entry_id:138898)（例如，$x_{\xi\eta} = x_{\eta\xi}$），这对于[光滑映射](@entry_id:203730)是自然成立的。然而，在离散层面，如果度量张量的计算、求积法则和离散算子不兼容，这个守恒律可能被违反，从而产生非物理的源项，破坏自由流保持特性并可能导致不稳定性。因此，对弯曲单元上的[DG格式](@entry_id:178043)，必须精心设计以满足离散GCL 。