## 引言
在计算科学与工程领域，精确模拟波动现象是众多前沿研究（如地震勘探、[气动声学](@entry_id:266763)和医学成像）的核心。[声波方程](@entry_id:746230)作为描述这些现象的基本模型，其数值求解方法的发展至关重要。传统低阶方法在处理复杂几何和长时程模拟时往往面临精度不足或计算成本过高的问题。因此，学术界和工业界对能够同时提供[高阶精度](@entry_id:750325)、几何灵活性和强大稳定性的数值方法有着迫切的需求。间断伽辽金（DG）方法正是在这一背景下脱颖而出，成为求解[双曲型方程](@entry_id:145657)（如[声波方程](@entry_id:746230)）的首选工具之一。

本文旨在系统性地介绍[声波方程](@entry_id:746230)的[DG格式](@entry_id:178043)。我们将不仅仅停留在理论层面，而是将理论与实践紧密结合，为读者构建一个完整的知识体系。通过学习本文，您将掌握[DG方法](@entry_id:748369)的核心思想，并了解其如何应用于解决复杂的科学与工程问题。

文章将分为三个核心章节。在“原理与机制”一章中，我们将深入探讨DG方法的数学基础，从[声波方程](@entry_id:746230)的物理性质出发，推导其[能量守恒](@entry_id:140514)定律，并展示如何通过精心设计的数值通量来构建能量稳定的离散格式。随后，在“应用与交叉学科联系”一章中，我们将展示DG方法的强大功能和灵活性，通过一系列实例说明如何处理复杂的物理边界、[异质介质](@entry_id:750241)，并将其与自适应、[并行计算](@entry_id:139241)等高性能计算策略相结合。最后，“动手实践”部分将提供一系列编程练习，引导您将理论知识转化为实际的计算能力。现在，让我们从[DG方法](@entry_id:748369)最根本的数学原理开始探索。

## 原理与机制

本章深入探讨[声波方程](@entry_id:746230)的间断伽辽金（DG）方法的数学原理和核心机制。我们将从一阶[声波方程](@entry_id:746230)的物理解构开始，推导其[能量守恒](@entry_id:140514)定律，这是后续数值方法稳定性的理论基石。随后，我们将详细阐述DG方法的基本框架，重点讨论其核心构件——数值通量。通过对[能量稳定性](@entry_id:748991)的离散分析，我们将揭示如何设计出可靠的[DG格式](@entry_id:178043)。最后，本章将讨论几个高级主题，包括[色散](@entry_id:263750)与耗散分析、变系数介质处理以及[曲线网格](@entry_id:748122)上的[几何守恒律](@entry_id:170384)，这些是[DG方法](@entry_id:748369)在实际复杂问题中取得成功的关键。

### 一阶声波系统及其性质

声波现象本质上是[可压缩流体](@entry_id:164617)中微小扰动的传播。为了建立一个适合[数值模拟](@entry_id:137087)的数学模型，我们通常从[可压缩欧拉方程](@entry_id:747588)出发，围绕一个均匀、静止的背景状态进行线性化。假设背景密度为 $\rho_0 > 0$，压力为 $p_0 > 0$，速度为 $\boldsymbol{u}_0 = \boldsymbol{0}$。我们引入小的扰动量，即声压 $p'$ 和[粒子速度](@entry_id:196946) $\boldsymbol{u}'$。在等熵扰动的假设下，可以推导出一阶声学系统：

$$
\frac{\partial p'}{\partial t} + \rho_0 c^2 \nabla \cdot \boldsymbol{u}' = 0
$$

$$
\rho_0 \frac{\partial \boldsymbol{u}'}{\partial t} + \nabla p' = \boldsymbol{0}
$$

这里，$c$ 是在背景状态下定义的等熵声速，满足 $c^2 = (\partial p / \partial \rho)_s$。这个[方程组](@entry_id:193238)是一个线性[双曲系统](@entry_id:260647)，描述了声压和速度扰动的耦合演化。为了方便分析，我们可以将这个系统写成更紧凑的[守恒形式](@entry_id:747710)。定义状态向量 $w = (p', u'_1, \dots, u'_d)^\top$，其中 $d$ 是空间维度。该系统可以表示为：

$$
\partial_t w + \sum_{j=1}^{d} A_j \partial_{x_j} w = 0
$$

其中 $A_j$ 是[常系数](@entry_id:269842)的通量雅可比矩阵。例如，在三维情况下，$d=3$，[状态向量](@entry_id:154607)为 $w = (p', u'_{1}, u'_{2}, u'_{3})^{\top}$，则矩阵 $A_1$ 为：

$$
A_{1} = \begin{pmatrix} 0  & \rho_{0}c^{2} & 0 & 0 \\ 1/\rho_{0} & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \end{pmatrix}
$$

$A_2$ 和 $A_3$ 的结构与此类似。

[双曲系统](@entry_id:260647)的核心特征是信息的波动式传播。这一点在一维情况下看得最清楚。在一维空间中，[方程组](@entry_id:193238)简化为：

$$
\frac{\partial p'}{\partial t} + \rho_0 c^2 \frac{\partial u'}{\partial x} = 0
$$

$$
\frac{\partial u'}{\partial t} + \frac{1}{\rho_0} \frac{\partial p'}{\partial x} = 0
$$

通过引入**[特征变量](@entry_id:747282)**（characteristic variables），我们可以将这个耦合系统[解耦](@entry_id:637294)为两个独立的[平流方程](@entry_id:144869)。定义[声阻抗](@entry_id:267232) $Z \equiv \rho_0 c$，并构造新的变量 $w^{\pm} = p' \pm Z u'$。直接从原[方程组](@entry_id:193238)出发，可以证明这些[特征变量](@entry_id:747282)满足：

$$
\frac{\partial w^+}{\partial t} + c \frac{\partial w^+}{\partial x} = 0
$$

$$
\frac{\partial w^-}{\partial t} - c \frac{\partial w^-}{\partial x} = 0
$$

这表明，$w^+$ 是一个以速度 $+c$ 向右传播的波，而 $w^-$ 是一个以速度 $-c$ 向左传播的波。整个[声学](@entry_id:265335)解可以看作是这两个方向相反的波的线性叠加。理解这种[特征分解](@entry_id:181333)是构造迎风格式（upwind schemes）等物理[数值通量](@entry_id:752791)的关键。

### 连续[能量守恒](@entry_id:140514)

一个设计良好的[数值格式](@entry_id:752822)应该在离散层面模仿原[偏微分方程](@entry_id:141332)（PDE）的重要物理性质。对于[声波方程](@entry_id:746230)而言，最重要的性质之一就是[能量守恒](@entry_id:140514)。在没有能量输入或耗散的[封闭系统](@entry_id:139565)中，总声能应保持不变。

总**声能**（acoustic energy）定义为动能和势能密度在整个区域 $\Omega$ 上的积分：

$$
E(t) = \int_{\Omega} \left( \frac{(p')^{2}}{2 \rho_0 c^{2}} + \frac{\rho_0 |\boldsymbol{u}'|^{2}}{2} \right) \, \mathrm{d}x
$$

第一项代表与流体压缩相关的势能，第二项代表粒子运动的动能。为了考察能量如何随时间变化，我们对 $E(t)$ 求时间导数。利用[链式法则](@entry_id:190743)和一阶[声学](@entry_id:265335)系统方程，经过一系列推导，我们可以得到能量变化率与边界上的[能量通量](@entry_id:266056)之间的关系：

$$
\frac{\mathrm{d}E}{\mathrm{d}t} = - \int_{\partial \Omega} p' (\boldsymbol{u}' \cdot \boldsymbol{n}) \, \mathrm{d}S
$$

其中 $\partial \Omega$ 是区域的边界，$\boldsymbol{n}$ 是边界上的单位外法向量。$p' (\boldsymbol{u}' \cdot \boldsymbol{n})$ 被称为**声强**（acoustic intensity），代表了穿过边界的能量通量密度。这个方程表明，系统总能量的变化率完全取决于通过边界流进或流出的能量。

对于一个[封闭系统](@entry_id:139565)，例如在边界上施加刚性壁条件（$\boldsymbol{u}' \cdot \boldsymbol{n}|_{\partial \Omega} = 0$）或压力释放条件（$p'|_{\partial \Omega} = 0$），边界积分项为零。此时，$\frac{\mathrm{d}E}{\mathrm{d}t} = 0$，意味着总声能 $E(t)$ 守恒。

[能量守恒](@entry_id:140514)的性质与[双曲系统](@entry_id:260647)的**可对称化**（symmetrizability）密切相关。存在一个对称正定的**对称化矩阵**（symmetrizer）$H$，使得能量泛函可以表示为状态向量 $w$ 的二次型 $\frac{1}{2} \int w^\top H w \, \mathrm{d}x$，并且矩阵 $H A_j$ 对所有 $j$ 都是对称的。对于声学系统，这个对称化矩阵 $H$ 是一个[对角矩阵](@entry_id:637782)：

$$
H = \begin{pmatrix} \frac{1}{\rho_0 c^2} & 0 & 0 & 0 \\ 0 & \rho_0 & 0 & 0 \\ 0 & 0 & \rho_0 & 0 \\ 0 & 0 & 0 & \rho_0 \end{pmatrix}
$$

这个矩阵的存在保证了[能量守恒](@entry_id:140514)定律的成立，并为离散格式的稳定性分析提供了理论基础。一个稳定的[数值格式](@entry_id:752822)应在离散层面上保持能量有界，最好是能量不增（耗散）或守恒。

### 间断伽辽金离散框架

间断伽辽金（DG）方法是一种功能强大的[高阶数值方法](@entry_id:142601)，尤其适用于求解[双曲型方程](@entry_id:145657)。其核心思想是将求解域 $\Omega$ 分割成一系列不重叠的网格单元 $K$，并在每个单元内部使用多项式来逼近真实解。

与传统的有限元方法不同，[DG方法](@entry_id:748369)允许近似解在单元边界上是间断的。DG方法的[函数空间](@entry_id:143478) $V_h$ 由分片多项式构成。在一个单元 $K$ 上，这个空间可以是单纯形（如三角形或四面体）上的**总阶多项式** $\mathbb{P}^p(K)$，也可以是[张量积](@entry_id:140694)单元（如四边形或六面体）上的**张量积多项式** $\mathbb{Q}^p(K)$，其中 $p$ 是多项式的阶数。

在每个单元内，多项式解可以通过一组[基函数](@entry_id:170178)来表示。两种常见的[基函数](@entry_id:170178)选择是：
1.  **[模态基](@entry_id:752055)**（Modal Basis）：由在一系列标准[正交多项式](@entry_id:146918)（如勒让德多项式）构成的[基函数](@entry_id:170178)。对于[仿射映射](@entry_id:746332)的单元，使用[模态基](@entry_id:752055)可以得到一个对角化的**[质量矩阵](@entry_id:177093)**（mass matrix）$M^{(K)}_{ij} = \int_K \phi_i \phi_j \, \mathrm{d}x$，这在求解时间演化问题时非常有利。然而，对于曲线单元（非[仿射映射](@entry_id:746332)），由于[雅可比行列式](@entry_id:137120) $J$ 是非均匀的，质量矩阵通常不再是严格对角的。

2.  **[节点基](@entry_id:752522)**（Nodal Basis）：由与单元内一组特定节点（如[Legendre-Gauss-Lobatto](@entry_id:751235), LGL节点）相关联的[拉格朗日多项式](@entry_id:142463)构成。这种[基函数](@entry_id:170178)在节点上具有插值性质，即 $\phi_i(x_j) = \delta_{ij}$。虽然其[精确质量](@entry_id:746222)矩阵是满的，但如果采用与节点位置匹配的[求积法则](@entry_id:753909)（quadrature rule）来近似计算积分，得到的离散[质量矩阵](@entry_id:177093)会变成对角矩阵。这个过程被称为**[质量集中](@entry_id:175432)**（mass lumping），其对角线元素正比于[求积权重](@entry_id:753910)。[质量集中](@entry_id:175432)极大地提高了[计算效率](@entry_id:270255)，因为它避免了求解大型线性方程组，使得时间步进可以显式进行。

[DG方法](@entry_id:748369)的弱形式是在每个单元 $K$ 上独立建立的。将PDE乘以一个检验函数 $v_h \in V_h$，然后在单元 $K$ 上积分，并使用分部积分（[格林公式](@entry_id:173118)），可以得到：

$$
\int_K \frac{\partial w_h}{\partial t} v_h \, \mathrm{d}x - \int_K \boldsymbol{F}(w_h) \cdot \nabla v_h \, \mathrm{d}x + \int_{\partial K} (\hat{\boldsymbol{F}} \cdot \boldsymbol{n}) v_h \, \mathrm{d}S = 0
$$

这里 $w_h$ 是多项式近似解，$\boldsymbol{F}$ 是PDE的通量张量，$\hat{\boldsymbol{F}} \cdot \boldsymbol{n}$ 是出现在单元边界 $\partial K$ 上的**[数值通量](@entry_id:752791)**（numerical flux）。由于解在单元间是间断的，边界上的值是不唯一的，因此必须引入一个确定的[数值通量](@entry_id:752791)来连接相邻单元并确保[解的唯一性](@entry_id:143619)和稳定性。

### [数值通量](@entry_id:752791)：[DG方法](@entry_id:748369)的核心

[数值通量](@entry_id:752791)的选择是[DG方法](@entry_id:748369)设计的核心，它决定了格式的稳定性、精度和耗散/[色散](@entry_id:263750)性质。数值通量 $\hat{\boldsymbol{F}} \cdot \boldsymbol{n}$ 是一个依赖于界面两侧状态（记为 $w^-$ 和 $w^+$）的函数。一个好的[数值通量](@entry_id:752791)应该满足两个基本条件：
1.  **一致性**（Consistency）：当两侧状态相同时（$w^- = w^+ = w$），[数值通量](@entry_id:752791)应退化为物理通量，即 $\hat{\boldsymbol{F}}(w, w) \cdot \boldsymbol{n} = \boldsymbol{F}(w) \cdot \boldsymbol{n}$。
2.  **守恒性**（Conservation）：在任意一个内部界面上，从一个单元流出的通量必须等于流入相邻单元的通量，即 $\hat{\boldsymbol{F}}(w^-, w^+) \cdot \boldsymbol{n}^- = - \hat{\boldsymbol{F}}(w^+, w^-) \cdot \boldsymbol{n}^+$。由于 $\boldsymbol{n}^- = -\boldsymbol{n}^+$，这等价于 $\hat{\boldsymbol{F}}(w^-, w^+) = \hat{\boldsymbol{F}}(w^+, w^-)$。

以下是两种经典的[数值通量](@entry_id:752791)构造方法：

#### [迎风通量](@entry_id:143931)
[迎风通量](@entry_id:143931)（Upwind Flux）是一种基于物理的通量，它利用了[双曲系统](@entry_id:260647)的特征信息传播特性。其核心思想是，在界面上的通量应该由信息“来源”一侧的状态决定。在一维声学问题中，我们已经知道 $w^+ = p' + Zu'$ 是右[行波](@entry_id:185008)，$w^- = p' - Zu'$ 是左行波。因此，在界面处，右行波的信息应来自左侧单元，左[行波](@entry_id:185008)的信息应来自右侧单元。这给出了界面上的虚拟状态 $(p^*, u^*)$ 所需满足的条件：

$$
p^* + Z u^* = p'^{-} + Z u'^{-}
$$
$$
p^* - Z u^* = p'^{+} - Z u'^{+}
$$

解出 $(p^*, u^*)$ 后，就可以构造出相应的[数值通量](@entry_id:752791)。例如，对于一个从左向右（$p'_L=p_0, u'_L=0$）冲击静止介质（$p'_R=0, u'_R=0$）的黎曼问题，界面上的压力会是 $p^* = p_0/2$。[迎风通量](@entry_id:143931)通过引入物理上正确的耗散来保证格式的稳定性。

#### 局部Lax-Friedrichs通量
局部Lax-Friedrichs（LLF）通量，也称为[Rusanov通量](@entry_id:637224)，是另一种广泛使用的数值通量。它的构造方式更为通用和简单，不依赖于对系统进行完整的[特征分解](@entry_id:181333)。LLF通量由两部分组成：[中心通量](@entry_id:747204)（即界面两侧通量的平均值）和一个正比于解的跳跃量的[人工耗散](@entry_id:746522)项：

$$
\hat{\boldsymbol{F}}_{\text{LLF}} \cdot \boldsymbol{n} = \frac{1}{2} \left( \boldsymbol{F}(w^-) + \boldsymbol{F}(w^+) \right) \cdot \boldsymbol{n} - \frac{\alpha}{2} (w^+ - w^-)
$$

这里的 $\alpha$ 是耗散系数。为了保证数值格式的[能量稳定性](@entry_id:748991)，这个耗散项必须足够强，以抵消[中心通量](@entry_id:747204)可能产生的任何非物理能量增长。理论分析表明，$\alpha$ 必须大于或等于沿界面[法线](@entry_id:167651)方向传播的最快特征[波速](@entry_id:186208)的[绝对值](@entry_id:147688)。对于声学系统，特征波速为 $\pm c$，因此，为保证稳定性，必须满足 $\alpha_{\min} = c$。

### 离散[能量稳定性](@entry_id:748991)

离散[能量稳定性](@entry_id:748991)是验证数值格式可靠性的关键。我们的目标是证明所构造的[DG格式](@entry_id:178043)的总离散能量是随时间不增的，即 $\frac{dE_h}{dt} \le 0$。

离散能量 $E_h$ 是连续能量在每个单元上的[多项式逼近](@entry_id:137391)之和。通过在[DG弱形式](@entry_id:748377)中[选择检验](@entry_id:182706)函数为（加权的）解本身，并对所有单元求和，可以推导出离散能量的变化率。经过一系列代数运算，可以证明，对于守恒型[双曲系统](@entry_id:260647)，离散能量的变化完全由界面上的[数值通量](@entry_id:752791)贡献决定。

界面上的能量变化可以表示为界面两侧物理解与数值解之间不匹配的产物。对于一个包含参数 $\alpha$ 的通用[数值通量](@entry_id:752791)族，可以推导出界面上的[能量耗散](@entry_id:147406)率是一个关于解在界面处跳跃量 $[p']$ 和 $[u']$ 的二次型。

以一个单参数通量族为例，其界面贡献的能量变化率可以表示为：
$$
\frac{dE_h}{dt}\bigg|_{\text{interface}} = -\left(\frac{\alpha}{Z}[p']^2 + \alpha Z[u']^2\right)
$$
为了保证能量不增，这个表达式必须小于等于零。由于 $[p']^2, [u']^2, Z$ 均非负，这要求耗散参数 $\alpha \ge 0$。

当采用[迎风通量](@entry_id:143931)时，其等效的耗散参数 $\alpha = 1/2$。此时，界面上的能量耗散率为：
$$
D_{\text{upwind}} = \frac{1}{2Z}[p']^2 + \frac{Z}{2}[u']^2
$$
由于这是一个正定二次型，$\frac{dE_h}{dt} = -D_{\text{upwind}} \le 0$，这严格证明了使用[迎风通量](@entry_id:143931)的[DG格式](@entry_id:178043)是能量稳定的。

另一种构建稳定格式的强大理论框架是**[分部求和-同步近似项](@entry_id:754519)**（Summation-by-Parts - Simultaneous Approximation Term, SBP-SAT）方法。SBP算子是满足离散[分部积分法](@entry_id:136350)则的差分算子，而SAT项则通过在方程右端添加罚项来弱施加边界或[界面条件](@entry_id:750725)。通过精心选择SAT罚项，可以精确地控制能量的产生或耗散，从而系统地构造出能量稳定的[高阶格式](@entry_id:150564)。SBP-[SAT方法](@entry_id:754511)与[DG方法](@entry_id:748369)在本质上是紧密相关的，它们都通过模仿连续的[分部积分](@entry_id:136350)来实现稳定性。

### 高级主题与实践考量

#### [色散](@entry_id:263750)与耗散分析
稳定性保证了数值解不会发散，但精度则与格式的**[色散](@entry_id:263750)**（dispersion）和**耗散**（dissipation）性质有关。[色散](@entry_id:263750)是指不同频率（或[波数](@entry_id:172452)）的波以不同的速度传播，导致波形变形。耗散则是指[数值格式](@entry_id:752822)会人为地衰减波的振幅。

通过对均匀网格上的[半离散格式](@entry_id:165671)进行离散傅里叶（或布洛赫）分析，可以得到数值频散关系 $\omega(\kappa)$，其中 $\omega$ 是频率，$\kappa$ 是[波数](@entry_id:172452)。数值相速度 $v_p(\kappa) = \text{Re}(\omega(\kappa))/\kappa$ 描述了[波数](@entry_id:172452)为 $\kappa$ 的波的传播速度。对于一维声学方程的DG-P0格式（分片常数逼近）和[迎风通量](@entry_id:143931)，可以推导出归一化相速度为：
$$
\frac{v_p(\kappa)}{c} = \frac{\sin(\kappa h)}{\kappa h}
$$
其中 $h$ 是网格尺寸。由于 $\sin(x)/x \le 1$，这表明所有数值波的传播速度都慢于真实的声速 $c$，并且短波（$\kappa h$ 较大）的[传播速度](@entry_id:189384)更慢，这种现象称为数值色散。频散关系中的虚部 $\text{Im}(\omega(\kappa))$ 则对应数值耗散，它会导致波幅衰减。[迎风格式](@entry_id:756374)所引入的耗散主要作用于高频（短波）模式，有助于抑制[振荡](@entry_id:267781)。

#### 变系数与混淆误差
当介质不均匀时，声速 $c(\boldsymbol{x})$ 和密度 $\rho(\boldsymbol{x})$ 会随空间变化。在[DG弱形式](@entry_id:748377)中，这会导致需要计算形如 $\int_K K(\boldsymbol{x}) (\nabla \cdot \boldsymbol{u}_h) \phi_h \, \mathrm{d}\boldsymbol{x}$ 的体积积分。如果我们将变系数 $K(\boldsymbol{x})$ 也用 $M$ 阶多项式 $K_h(\boldsymbol{x})$ 逼近，而解和检验函数是 $N$ 阶多项式，那么被积函数的阶数将是 $M + (N-1) + N = M + 2N - 1$。

标准的[求积法则](@entry_id:753909)通常被设计为能精确积分某个特定阶数的多项式。如果[求积法则](@entry_id:753909)的精度不足以精确计算上述被积函数（即 $Q  M+2N-1$），就会产生**混淆误差**（aliasing error）。这种误差源于高阶多项式的行为在有限的求积点上被“误认”为低阶多项式，从而导致积分计算不准确。混淆误差不仅会降低格式的[收敛阶](@entry_id:146394)，还可能破坏其稳定性。因此，在变系数问题中，必须使用足够高阶的[求积法则](@entry_id:753909)（即进行所谓的“过积分”）来避免或减小混淆误差。

#### [曲线网格](@entry_id:748122)与[几何守恒律](@entry_id:170384)
为了模拟复杂[外形](@entry_id:146590)，通常需要使用[曲线网格](@entry_id:748122)。这在DG[谱元法](@entry_id:755171)（DGSEM）中通过将物理单元从一个标准的参考单元（如正方形）通过一个光滑的[非线性映射](@entry_id:272931) $\boldsymbol{x}(\xi, \eta)$ 变换而来。这个变换会在控制方程中引入与几何相关的度量项，如[雅可比行列式](@entry_id:137120) $J$ 和度量张量。

一个关键问题是，[数值格式](@entry_id:752822)是否能在[曲线网格](@entry_id:748122)上精确地保持一个非常简单的解，比如一个常数状态（例如，静止的均匀流体）。如果格式不能做到这一点，它就会从一个本应无任何变化的物理状态中人为地产生“能量”或“涡量”，这严重破坏了数值解的可靠性。保持常数解的能力要求离散算子满足所谓的**[几何守恒律](@entry_id:170384)**（Geometric Conservation Law, GCL）。

对于DGSEM，GCL体现为离散导数算子和离散几何度量项之间必须满足一个特定的代数关系，即**[离散度量](@entry_id:154658)恒等式**。例如，在二维情况下，这个恒等式为：
$$
\mathbf{D}_{\xi} \left( \boldsymbol{J} \boldsymbol{a}_{\xi} \right) + \mathbf{D}_{\eta} \left( \boldsymbol{J} \boldsymbol{a}_{\eta} \right) = \boldsymbol{0}
$$
其中 $\mathbf{D}_{\xi}, \mathbf{D}_{\eta}$ 是离散导数矩阵，$\boldsymbol{J}$ 和 $\boldsymbol{a}_{\xi}, \boldsymbol{a}_{\eta}$ 是在节点上求值的几何量。如果这个恒等式不成立，即存在一个非零的度量残差 $\boldsymbol{r}$，那么即使在常数[自由流](@entry_id:159506)（$p=p_0, \boldsymbol{u}=\boldsymbol{u}_0$）中，格式也会产生一个虚假的源项，导致非物理的能量产生。其能量产生率正比于度量残差和[自由流](@entry_id:159506)速度的[点积](@entry_id:149019)，具体为 $-p_{0} \boldsymbol{1}^{T} \mathbf{M} (\boldsymbol{r} \cdot \boldsymbol{u}_{0})$。因此，在[曲线网格](@entry_id:748122)上构造[DG格式](@entry_id:178043)时，必须确保离散几何量和导数算子被一致地定义，以满足GCL。