{
    "hands_on_practices": [
        {
            "introduction": "在解决复杂的流固耦合（FSI）问题之前，我们必须首先理解间断Galerkin（DG）方法的基础：基函数的选择。本练习将探讨DG方法中一种流行的选择——勒让德多项式的性质，并揭示为何它们能够带来对角质量矩阵这一实现计算效率的关键特性。通过推导正交归一化所需的缩放因子，您将亲手实践DG空间离散化的基本构成单元。",
            "id": "3379597",
            "problem": "在一个使用间断Galerkin（DG）方法的一维整体式流固耦合（FSI）公式中，考虑参考界面单元 $K_{\\text{ref}} = [-1,1]$，其上具有标准勒让德多项式模态基 $\\{P_{n}(x)\\}_{n=0}^{N}$，其中 $P_{n}$ 表示第 $n$ 阶勒让德多项式，并被归一化为 $P_{n}(1)=1$。将参考单元上的单元 $L^{2}$ 内积定义为\n$$\n(u,v)_{K_{\\text{ref}}} \\equiv \\int_{-1}^{1} u(x)\\,v(x)\\,dx,\n$$\n以及相应的模态质量矩阵项定义为\n$$\nM_{ij} \\equiv \\left(P_{i},P_{j}\\right)_{K_{\\text{ref}}} = \\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx,\\quad 0\\leq i,j\\leq N.\n$$\n从勒让德多项式的基本性质和 $L^{2}$ 内积的定义出发，推导在 $K_{\\text{ref}}$ 上的矩阵项 $M_{ij}$ 的闭式表达式，并用它来确定一个与阶数相关的缩放因子 $s(n)0$，使得重新缩放后的模态基\n$$\n\\phi_{n}(x) \\equiv s(n)\\,P_{n}(x)\n$$\n在 $K_{\\text{ref}}$ 上关于 $(\\cdot,\\cdot)_{K_{\\text{ref}}}$ 是标准正交的，即\n$$\n\\left(\\phi_{n},\\phi_{m}\\right)_{K_{\\text{ref}}} = \\delta_{nm}\n$$\n对于所有整数 $0\\leq n,m\\leq N$，其中 $\\delta_{nm}$ 是克罗内克δ函数。明确展示勒让德基的质量矩阵如何呈现对角结构，以及 $s(n)$ 的选择如何产生一个对角线元素为1的对角质量矩阵。最后，给出 $s(n)$ 作为 $n$ 的函数的闭式解析表达式。\n\n请以 $n$ 的单一闭式解析表达式的形式提供您的最终答案。不要包含单位。如果引入任何角度，请以弧度表示。无需四舍五入。",
            "solution": "用户希望我解决这个问题。我需要输出解答。\n首先对问题陈述进行严格的验证过程。\n\n### 第一步：提取已知条件\n-   **背景**：一个使用间断Galerkin（DG）方法的一维整体式流固耦合（FSI）公式。\n-   **参考单元**：$K_{\\text{ref}} = [-1,1]$。\n-   **模态基**：在 $K_{\\text{ref}}$ 上的标准勒让德多项式模态基 $\\{P_{n}(x)\\}_{n=0}^{N}$。\n-   **归一化**：勒让德多项式 $P_{n}(x)$ 被归一化，使得 $P_{n}(1)=1$。\n-   **内积**：参考单元上的单元 $L^{2}$ 内积定义为 $(u,v)_{K_{\\text{ref}}} \\equiv \\int_{-1}^{1} u(x)\\,v(x)\\,dx$。\n-   **质量矩阵**：模态质量矩阵的项由 $M_{ij} \\equiv \\left(P_{i},P_{j}\\right)_{K_{\\text{ref}}} = \\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx$ 给出，其中 $0\\leq i,j\\leq N$。\n-   **重新缩放的基**：一个新的基 $\\phi_{n}(x)$ 定义为 $\\phi_{n}(x) \\equiv s(n)\\,P_{n}(x)$，其中缩放因子 $s(n)$ 为正，即 $s(n)0$。\n-   **标准正交条件**：重新缩放的基必须关于定义的内积是标准正交的，即对于所有整数 $0\\leq n,m\\leq N$，都有 $(\\phi_{n},\\phi_{m})_{K_{\\text{ref}}} = \\delta_{nm}$，其中 $\\delta_{nm}$ 是克罗内克δ函数。\n\n### 第二步：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n-   **科学依据**：该问题在正交多项式（特别是勒让德多项式）的数学理论及其在偏微分方程数值方法（如间断Galerkin方法）中的应用方面有坚实的基础。所有定义和概念在数值分析和应用数学中都是标准的。\n-   **适定性**：问题陈述清晰，要求推导一个标准结果。归一化 $P_{n}(1)=1$ 和要求 $s(n)0$ 确保了 $s(n)$ 存在唯一的、定义明确的解。\n-   **客观性**：问题使用精确的数学语言表达，没有任何歧义、主观性或观点。\n-   **完整性与一致性**：问题提供了所有必要信息。基、内积和标准正交条件的定义是自洽且一致的。\n\n### 第三步：结论与行动\n问题是**有效的**。这是一个标准的、适定的数学练习。现在开始解答过程。\n\n---\n\n目标是找到一个缩放因子 $s(n)$，使得基函数 $\\phi_{n}(x) = s(n)P_{n}(x)$ 在参考单元 $K_{\\text{ref}} = [-1,1]$ 上关于内积 $(u,v)_{K_{\\text{ref}}} = \\int_{-1}^{1} u(x)v(x)dx$ 是标准正交的。\n\n首先，我们分析原始基 $\\{P_{n}(x)\\}$ 的质量矩阵 $M_{ij}$。其矩阵项定义为：\n$$\nM_{ij} = (P_{i}, P_{j})_{K_{\\text{ref}}} = \\int_{-1}^{1} P_{i}(x)P_{j}(x)dx\n$$\n勒让德多项式的一个基本性质是它们在区间 $[-1,1]$ 上关于 $L^2$ 内积的正交性。该性质表明：\n$$\n\\int_{-1}^{1} P_{i}(x)P_{j}(x)dx = 0 \\quad \\text{for } i \\neq j\n$$\n这直接意味着质量矩阵的非对角线项为零：\n$$\nM_{ij} = 0 \\quad \\text{for } i \\neq j\n$$\n这就是为什么勒让德多项式基的质量矩阵是对角矩阵的原因。这个性质是在谱方法和DG方法中使用此类基的基石，因为它解耦了不同模态的方程，从而显著简化了计算。\n\n接下来，我们计算对角线项 $M_{nn}$，它们是基函数的 $L^2$ 范数的平方。对于标准归一化 $P_n(1)=1$ 的勒让德多项式 $P_n(x)$，该积分的值是一个众所周知的结果：\n$$\nM_{nn} = (P_{n}, P_{n})_{K_{\\text{ref}}} = \\int_{-1}^{1} [P_{n}(x)]^2 dx = \\frac{2}{2n+1}\n$$\n结合这两个结果，我们可以写出质量矩阵项的单一闭式表达式：\n$$\nM_{ij} = \\frac{2}{2i+1}\\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ函数。\n\n现在，我们对重新缩放的基 $\\{\\phi_{n}(x)\\}$ 施加标准正交条件。条件是：\n$$\n(\\phi_{n}, \\phi_{m})_{K_{\\text{ref}}} = \\delta_{nm}\n$$\n让我们使用定义 $\\phi_{n}(x) = s(n)P_{n}(x)$ 展开左侧：\n$$\n(\\phi_{n}, \\phi_{m})_{K_{\\text{ref}}} = \\int_{-1}^{1} \\phi_{n}(x)\\phi_{m}(x)dx = \\int_{-1}^{1} [s(n)P_{n}(x)][s(m)P_{m}(x)]dx\n$$\n由于 $s(n)$ 和 $s(m)$ 相对于积分变量 $x$ 是常数，我们可以将它们提出来：\n$$\n(\\phi_{n}, \\phi_{m})_{K_{\\text{ref}}} = s(n)s(m) \\int_{-1}^{1} P_{n}(x)P_{m}(x)dx = s(n)s(m) M_{nm}\n$$\n现在我们将其等同于克罗内克δ函数 $\\delta_{nm}$。\n\n对于 $n \\neq m$ 的情况：\n$$\ns(n)s(m)M_{nm} = s(n)s(m) \\cdot 0 = 0\n$$\n因此，对于 $n \\neq m$ 的情况，条件 $(\\phi_{n}, \\phi_{m})_{K_{\\text{ref}}} = \\delta_{nm} = 0$ 由于勒让德多项式的内在正交性而自动满足，无论缩放因子 $s(n)$ 如何选择。\n\n对于 $n = m$ 的情况：\n条件是 $(\\phi_{n}, \\phi_{n})_{K_{\\text{ref}}} = \\delta_{nn} = 1$。展开得到：\n$$\ns(n)s(n)M_{nn} = [s(n)]^2 M_{nn} = 1\n$$\n我们代入先前建立的 $M_{nn}$ 的表达式：\n$$\n[s(n)]^2 \\left(\\frac{2}{2n+1}\\right) = 1\n$$\n现在，我们求解 $s(n)$。整理方程得到：\n$$\n[s(n)]^2 = \\frac{2n+1}{2}\n$$\n问题指定 $s(n)  0$。因此，我们必须取正平方根：\n$$\ns(n) = \\sqrt{\\frac{2n+1}{2}}\n$$\n这就是将勒让德基 $\\{P_n(x)\\}$ (满足 $P_n(1)=1$) 变换为在 $K_{\\text{ref}} = [-1,1]$ 上的标准正交基 $\\{\\phi_n(x)\\}$ 的缩放因子 $s(n)$ 的闭式解析表达式。通过这种缩放，基 $\\{\\phi_n(x)\\}$ 的质量矩阵成为单位矩阵，因为 $(\\phi_n, \\phi_m) = \\delta_{nm}$。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{2n+1}{2}}}\n$$"
        },
        {
            "introduction": "分区流固耦合算法的一个核心挑战是“附加质量效应”，它可能导致严重的数值不稳定性。本实践采用一个简化的模型来研究这一现象，并推导显式耦合格式的稳定性极限。理解这一限制对于在FSI模拟中选择合适的时间步进策略至关重要。",
            "id": "3379632",
            "problem": "考虑一个长度为 $L$、横截面积为 $A$、密度为 $\\rho$ 的一维（$1$D）无粘、不可压缩流体柱，它被限制在 $x \\in [0,L]$ 范围内的刚性管道中。管道在 $x=0$ 处的末端是固定的，而在 $x=L$ 处的末端是一个活塞，该活塞连接到一个质量为 $m_{s}$、刚度为 $k_{s}$ 的线性弹簧-质量结构模型上，其位移为 $x_{s}(t)$。流体和结构在交界面处满足运动学连续性条件，因此活塞在 $x=L$ 处的速度等于流体速度。流体在空间上通过单个单元上的间断 Galerkin (DG) 方法和迎风数值通量进行离散化，而结构则被建模为集总自由度。\n\n从动量守恒和牛顿第二定律出发，在不可压缩极限下将流体视为附加到结构上的附加质量 $m_{a}$，并取流体对结构的反作用力为 $F_{f}(t) = - m_{a}\\,\\ddot{x}_{s}(t)$。证明对于所述的一维流体柱，$m_{a} = \\rho A L$。\n\n现在考虑一种分区显式时间耦合方法，其中：\n- 结构通过二阶中心差分法进行推进，\n- 流体反作用力使用前一个时间层级的 $\\ddot{x}_{s}$ 的中心差分近似，滞后一步进行计算。\n\n具体来说，设 $\\Delta t$ 为恒定时间步长，并用 $x^{n} \\approx x_{s}(t^{n})$ 表示，其中 $t^{n} = n \\Delta t$。该显式耦合通过以下方式推进结构：\n$$\nm_{s}\\,\\frac{x^{n+1} - 2 x^{n} + x^{n-1}}{\\Delta t^{2}} + k_{s}\\,x^{n} \\;=\\; F_{f}^{n},\n$$\n流体反作用力的计算方式为：\n$$\nF_{f}^{n} \\;=\\; - m_{a}\\,\\frac{x^{n} - 2 x^{n-1} + x^{n-2}}{\\Delta t^{2}}.\n$$\n\n通过寻找 $x^{n} = r^{n}$ 形式的解，对该递推关系进行线性稳定性分析，并以 $m_{s}$、$k_{s}$ 和 $m_{a}$ 的形式，确定最大稳定时间步长 $\\Delta t_{\\max}$ 的闭式解析表达式。\n\n最后，将此显式耦合的限制与应用于耦合的质量-弹簧-附加质量系统的整体式全隐式格式的稳定性进行比较，但不要为此比较提供数值。\n\n以秒为单位，给出 $\\Delta t_{\\max}$ 的单个解析表达式作为最终答案，不进行四舍五入，也不进行数值代入。",
            "solution": "该问题包含三个部分。首先，我们必须推导附加质量 $m_a$ 的表达式。其次，我们需要对给定的分区显式时间耦合格式进行线性稳定性分析，以找到最大稳定时间步长 $\\Delta t_{\\max}$。第三，我们需要将此稳定性限制与整体式全隐式格式的稳定性进行比较。\n\n第1部分：附加质量 $m_{a}$ 的推导\n\n问题要求证明对于一维流体柱，附加质量为 $m_a = \\rho A L$。我们被要求从动量守恒和牛顿第二定律出发，并在不可压缩极限下将流体视为附加质量。\n\n在问题陈述中存在一个微妙的物理不一致性。对于一维不可压缩流体，连续性方程 $\\frac{\\partial u}{\\partial x} = 0$ 意味着流体速度 $u$ 只能是时间的函数，即 $u(t)$。这与给定的边界条件——一端是固定壁面 $u(0, t) = 0$，另一端是移动活塞 $u(L, t) = \\dot{x}_s(t)$——相冲突，除非活塞是静止的。\n\n然而，问题指示我们“将流体视为附加质量”，这表明应采用一个简化的集总参数模型。在这种情况下，最直接的解释是“刚性块”模型，其中质量为 $M_{\\text{fluid}} = \\rho A L$ 的整个流体柱被假定具有与活塞加速度相等的单一、均匀的加速度 $\\ddot{x}_s(t)$。这种简化实际上忽略了内部速度分布和在 $x=0$ 处的边界条件，只关注活塞必须移动的流体的总惯性。\n\n遵循这种解释，我们将牛顿第二定律应用于流体柱。流体的总质量为 $M_{\\text{fluid}} = \\rho A L$。假设它与活塞一起作为刚体加速，其加速度为 $a_{\\text{fluid}} = \\ddot{x}_s(t)$。产生这种加速度所需的合力为：\n$$ F_{\\text{net on fluid}} = M_{\\text{fluid}} \\, a_{\\text{fluid}} = (\\rho A L) \\ddot{x}_s(t) $$\n问题将流体对结构（活塞）的反作用力定义为 $F_f(t) = -m_a \\ddot{x}_s(t)$。根据牛顿第三定律，活塞施加在流体上的力为 $F_{\\text{piston on fluid}} = -F_f(t) = m_a \\ddot{x}_s(t)$。如果我们假设这是加速流体块的唯一作用力（即，它代表合力），我们可以将这两个表达式等同起来：\n$$ F_{\\text{net on fluid}} = F_{\\text{piston on fluid}} $$\n$$ (\\rho A L) \\ddot{x}_s(t) = m_a \\ddot{x}_s(t) $$\n这直接意味着：\n$$ m_a = \\rho A L $$\n这就在指定的集总参数解释下完成了所要求的推导。\n\n第2部分：线性稳定性分析\n\n耦合数值格式由两个方程定义：\n结构运动方程：\n$$ m_{s}\\,\\frac{x^{n+1} - 2 x^{n} + x^{n-1}}{\\Delta t^{2}} + k_{s}\\,x^{n} \\;=\\; F_{f}^{n} $$\n滞后一步的流体反作用力：\n$$ F_{f}^{n} \\;=\\; - m_{a}\\,\\frac{x^{n} - 2 x^{n-1} + x^{n-2}}{\\Delta t^{2}} $$\n将 $F_{f}^{n}$ 的表达式代入结构方程，我们得到关于结构位移 $x^n$ 的单一递推关系：\n$$ m_{s}\\,\\frac{x^{n+1} - 2 x^{n} + x^{n-1}}{\\Delta t^{2}} + k_{s}\\,x^{n} \\;=\\; - m_{a}\\,\\frac{x^{n} - 2 x^{n-1} + x^{n-2}}{\\Delta t^{2}} $$\n为简化起见，我们将整个方程乘以 $\\Delta t^2$ 并将所有项移到左侧：\n$$ m_{s}(x^{n+1} - 2 x^{n} + x^{n-1}) + k_{s}\\Delta t^{2} x^{n} + m_{a}(x^{n} - 2 x^{n-1} + x^{n-2}) = 0 $$\n按时间层级（$n+1, n, n-1, n-2$）对各项进行分组：\n$$ m_{s}x^{n+1} + (m_{a} - 2m_{s} + k_{s}\\Delta t^{2})x^{n} + (m_{s} - 2m_{a})x^{n-1} + m_{a}x^{n-2} = 0 $$\n为了进行线性稳定性分析，我们寻找形式为 $x^{n} = r^{n}$ 的解，其中 $r$ 是放大因子。将其代入递推关系可得：\n$$ m_{s}r^{n+1} + (m_{a} - 2m_{s} + k_{s}\\Delta t^{2})r^{n} + (m_{s} - 2m_{a})r^{n-1} + m_{a}r^{n-2} = 0 $$\n除以 $r^{n-2}$（对于 $r \\neq 0$），我们得到特征多项式 $P(r)$：\n$$ P(r) = m_{s}r^{3} + (m_{a} - 2m_{s} + k_{s}\\Delta t^{2})r^{2} + (m_{s} - 2m_{a})r + m_{a} = 0 $$\n为使数值格式稳定，该三次多项式的所有根 $r_i$ 必须满足根条件：$|r_i| \\le 1$。任何位于单位圆（$|r_i| = 1$）上的根必须是单根。稳定性边界通过确定根何时位于单位圆上找到。从 Jury 稳定性判据导出的一个稳定性必要条件是，对于 $r=-1$ 处的根，$P(-1)=0$。让我们在 $r=-1$ 处计算多项式的值：\n$$ P(-1) = m_{s}(-1)^{3} + (m_{a} - 2m_{s} + k_{s}\\Delta t^{2})(-1)^{2} + (m_{s} - 2m_{a})(-1) + m_{a} $$\n$$ P(-1) = -m_{s} + (m_{a} - 2m_{s} + k_{s}\\Delta t^{2}) - (m_{s} - 2m_{a}) + m_{a} $$\n$$ P(-1) = -m_{s} + m_{a} - 2m_{s} + k_{s}\\Delta t^{2} - m_{s} + 2m_{a} + m_{a} $$\n$$ P(-1) = -4m_{s} + 4m_{a} + k_{s}\\Delta t^{2} $$\n在稳定性极限处，一个根会跃出单位圆，通常是穿过 $r=-1$。令 $P(-1)=0$ 得到一个关于时间步长的条件：\n$$ -4m_{s} + 4m_{a} + k_{s}\\Delta t^{2} = 0 $$\n$$ k_{s}\\Delta t^{2} = 4(m_{s} - m_{a}) $$\n$$ \\Delta t^{2} = \\frac{4(m_{s} - m_{a})}{k_{s}} $$\n该关系定义了一个临界时间步长。对于一个稳定的格式，其中 $\\Delta t$ 可以是实数和正数，我们必须有 $m_s  m_a$。如果 $m_s \\le m_a$，则对于任何 $\\Delta t  0$，该格式都是无条件不稳定的。这是一个众所周知的现象，称为人为附加质量不稳定性。对于一个稳定的三次多项式（假设 $m_s0$），Jury 判据要求 $P(-1)  0$，这给出了稳定性条件：\n$$ -4m_{s} + 4m_{a} + k_{s}\\Delta t^{2}  0 \\quad \\implies \\quad k_{s}\\Delta t^{2}  4(m_{s} - m_{a}) $$\n$$ \\Delta t  2\\sqrt{\\frac{m_{s} - m_{a}}{k_{s}}} $$\n虽然完整的 Jury 判据涉及更多不等式，但这个由根穿过 $r=-1$ 引起的条件通常是此类显式耦合格式的限制因素。可以证明，在 $m_s  m_a$ 的条件下，其他条件对 $\\Delta t$ 产生的界限较不严格。因此，最大稳定时间步长由等式给出：\n$$ \\Delta t_{\\max} = 2\\sqrt{\\frac{m_{s} - m_{a}}{k_{s}}} $$\n\n第3部分：与整体式隐式格式的比较\n\n整体式全隐式格式将耦合的流固系统视为一个单一实体，并同时求解其控制方程。耦合系统的控制方程为：\n$$ m_{s}\\ddot{x}_{s}(t) + k_{s}x_{s}(t) = F_{f}(t) $$\n使用附加质量模型 $F_{f}(t) = -m_{a}\\ddot{x}_{s}(t)$，我们得到：\n$$ m_{s}\\ddot{x}_{s}(t) + k_{s}x_{s}(t) = -m_{a}\\ddot{x}_{s}(t) $$\n$$ (m_{s} + m_{a})\\ddot{x}_{s}(t) + k_{s}x_{s}(t) = 0 $$\n这是简谐振子的方程，其总有效质量为 $M_{\\text{total}} = m_{s} + m_{a}$。\n当使用“全隐式”格式（如梯形法则，也称为 $\\gamma=1/2, \\beta=1/4$ 的 Newmark 方法）来积分这个二阶常微分方程时，得到的数值方法是无条件稳定的。这意味着无论系统参数 $m_s$, $m_a$ 和 $k_s$ 如何，该格式对于任何时间步长 $\\Delta t  0$ 的选择都是稳定的。\n\n总之，比较如下：\n- 分区显式格式是条件稳定的。它要求物理质量大于附加质量（$m_s  m_a$），并且时间步长小于一个临界值，即 $\\Delta t \\le \\Delta t_{\\max}$。\n- 整体式全隐式格式是无条件稳定的。它对稳定性的时间步长没有上限要求，尽管精度考虑可能仍会决定 $\\Delta t$ 的选择。",
            "answer": "$$\\boxed{2\\sqrt{\\frac{m_{s} - m_{a}}{k_{s}}}}$$"
        },
        {
            "introduction": "当模拟具有大变形的FSI问题时，流体网格必须随结构运动而变形，这通常通过任意拉格朗日-欧拉（ALE）方法实现。一个关键的实际问题是防止网格单元发生翻转或“缠结”，因为这会导致模拟中断。本练习将指导您推导一个保证网格雅可比行列式为正的时间步长充分条件，从而确保在整个模拟过程中网格的有效性。",
            "id": "3379679",
            "problem": "考虑一个在多面体网格上使用间断伽辽金 (DG) 方法的流固耦合离散化。移动网格由一个任意拉格朗日-欧拉 (ALE) 映射 $\\Phi^{n} : \\hat{\\Omega} \\rightarrow \\Omega^{n}$ 在时间 $t^{n}$ 描述，其中 $\\hat{\\Omega}$ 是一个固定的参考域。在每个单元 $\\hat{E} \\subset \\hat{\\Omega}$ 上，变形梯度为 $F^{n}(\\mathbf{X}) = \\nabla \\Phi^{n}(\\mathbf{X}) = I + \\nabla \\chi^{n}(\\mathbf{X})$，其中 $\\chi^{n}$ 是网格位移。网格运动通过以下方式显式更新：\n$$\n\\Phi^{n+1}(\\mathbf{X}) = \\Phi^{n}(\\mathbf{X}) + \\Delta t\\, v^{n}(\\mathbf{X}),\n$$\n其中 $v^{n}$ 是从耦合的流固模型中获得的网格速度，表示在一个次数为 $p$ 的分片多项式 DG 空间中。\n\n假设如下：\n- 当前网格是保定向的且在时间上连续，即单元上 $\\det(F^{n})  0$ 并且 $F^{n}$ 关于 $t$ 连续变化。\n- 存在一个常数 $\\gamma  0$ 使得 $F^{n}$ 的最小奇异值满足 $s_{\\min}(F^{n}(\\mathbf{X})) \\ge \\gamma$ 对于所有 $\\mathbf{X} \\in \\hat{\\Omega}$。\n- 对于每个直径为 $h_{\\hat{E}}$、测度为 $|\\hat{E}|$ 的单元 $\\hat{E}$，DG 表示和一个反估计给出了 $\\nabla v^{n}$ 谱范数的本性上确界的一个上界，形式如下\n$$\n\\|\\nabla v^{n}\\|_{L^{\\infty}(\\hat{E})} \\le \\kappa_{p}\\,\\frac{p(p+1)}{h_{\\hat{E}}}\\,\\frac{\\|v^{n}\\|_{L^{2}(\\hat{E})}}{\\sqrt{|\\hat{E}|}},\n$$\n其中 $\\kappa_{p}$ 是一个已知的常数，仅取决于参考形状的正则性和多项式次数 $p$。定义\n$$\n\\alpha := \\operatorname*{ess\\,sup}_{\\mathbf{X} \\in \\hat{\\Omega}} \\|\\nabla v^{n}(\\mathbf{X})\\|_{2} \\le \\max_{\\hat{E}} \\left(\\kappa_{p}\\,\\frac{p(p+1)}{h_{\\hat{E}}}\\,\\frac{\\|v^{n}\\|_{L^{2}(\\hat{E})}}{\\sqrt{|\\hat{E}|}}\\right),\n$$\n其中 $\\|\\cdot\\|_{2}$ 表示谱范数。\n\n直接根据这些假设和奇异值的变分特征，推导一个关于时间步长 $\\Delta t$ 的充分条件，以保证在新时刻雅可比行列式在单元上为正，即 $\\det(F^{n+1})  0$，其中 $F^{n+1} = \\nabla \\Phi^{n+1} = F^{n} + \\Delta t\\,\\nabla v^{n}$。你的推导必须从第一性原理出发：$F^{n+1}$ 的定义、奇异值特征 $s_{\\min}(A) = \\min_{\\|\\mathbf{x}\\|=1}\\|A\\mathbf{x}\\|$、三角不等式，以及对于保定向变形的行列式与奇异值之间的关系。此外，解释当 $F^{n+1} = I + \\nabla \\chi^{n+1}$ 时，对 $\\|\\nabla \\chi^{n+1}\\|_{2}$ 进行界定如何有助于保持雅可比行列式的正性。\n\n在这些假设下，给出你能得到的以 $\\gamma$ 和 $\\alpha$ 表示的最大允许时间步长 $\\Delta t_{\\max}$ 的最精确的闭式表达式。以秒为单位表示最终的步长。不需要进行数值计算，你的最终答案必须是单个解析表达式。",
            "solution": "问题要求推导时间步长 $\\Delta t$ 的一个充分条件，以确保更新后的网格构型的雅可比行列式保持为正，即 $\\det(F^{n+1})  0$。推导过程必须基于指定的第一性原理。\n\n$t^{n+1}$ 时刻的变形梯度由应用于 ALE 映射 $\\Phi^{n+1}(\\mathbf{X}) = \\Phi^{n}(\\mathbf{X}) + \\Delta t\\, v^{n}(\\mathbf{X})$ 的显式更新规则给出。对参考坐标 $\\mathbf{X}$ 求梯度，得到变形梯度张量的更新公式：\n$$\nF^{n+1} = \\nabla \\Phi^{n+1} = \\nabla \\Phi^{n} + \\Delta t\\,\\nabla v^{n} = F^{n} + \\Delta t\\,\\nabla v^{n}\n$$\n给定在 $t^n$ 时刻网格是保定向的，这意味着对于所有 $\\mathbf{X} \\in \\hat{\\Omega}$，$\\det(F^{n}(\\mathbf{X}))  0$。我们需要找到一个关于 $\\Delta t$ 的条件来保证 $\\det(F^{n+1}(\\mathbf{X}))  0$。\n\n矩阵的行列式是其奇异值的乘积（可能差一个符号）。对于一个从保定向状态（其中 $\\det(F)  0$）连续演化而来的变形梯度 $F$，其行列式 $\\det(F)$ 只能通过穿过零点而变为非正。一个矩阵的行列式为零当且仅当该矩阵是奇异的，这意味着它的最小奇异值为零。因此，维持 $\\det(F^{n+1})  0$ 的一个充分条件是确保 $F^{n+1}$ 的最小奇异值保持严格为正，即 $s_{\\min}(F^{n+1})  0$。\n\n我们通过寻找 $s_{\\min}(F^{n+1})$ 的一个下界来继续。矩阵 $A$ 的最小奇异值由变分特征定义：\n$$\ns_{\\min}(A) = \\min_{\\|\\mathbf{x}\\|_{2}=1} \\|A\\mathbf{x}\\|_{2}\n$$\n其中 $\\|\\cdot\\|_{2}$ 表示欧几里得向量范数。\n\n将此定义应用于 $F^{n+1} = F^{n} + \\Delta t\\,\\nabla v^{n}$，我们有：\n$$\ns_{\\min}(F^{n+1}) = \\min_{\\|\\mathbf{x}\\|_{2}=1} \\|(F^{n} + \\Delta t\\,\\nabla v^{n})\\mathbf{x}\\|_{2}\n$$\n对任意向量 $\\mathbf{x}$ 且 $\\|\\mathbf{x}\\|_{2} = 1$，使用反三角不等式 $\\|a+b\\| \\ge \\|a\\| - \\|b\\|$：\n$$\n\\|(F^{n} + \\Delta t\\,\\nabla v^{n})\\mathbf{x}\\|_{2} \\ge \\|F^{n}\\mathbf{x}\\|_{2} - \\|\\Delta t\\,\\nabla v^{n}\\mathbf{x}\\|_{2}\n$$\n由于 $\\Delta t  0$，我们可以写成 $\\|\\Delta t\\,\\nabla v^{n}\\mathbf{x}\\|_{2} = \\Delta t\\,\\|\\nabla v^{n}\\mathbf{x}\\|_{2}$。该不等式对所有单位向量 $\\mathbf{x}$ 成立，因此它也必须对所有这些向量的最小值成立：\n$$\ns_{\\min}(F^{n+1}) \\ge \\min_{\\|\\mathbf{x}\\|_{2}=1} \\left( \\|F^{n}\\mathbf{x}\\|_{2} - \\Delta t\\,\\|\\nabla v^{n}\\mathbf{x}\\|_{2} \\right)\n$$\n最小化的一个通用性质是 $\\min(f(x) - g(x)) \\ge \\min(f(x)) - \\max(g(x))$。应用这个性质，我们得到：\n$$\ns_{\\min}(F^{n+1}) \\ge \\left( \\min_{\\|\\mathbf{x}\\|_{2}=1} \\|F^{n}\\mathbf{x}\\|_{2} \\right) - \\left( \\max_{\\|\\mathbf{x}\\|_{2}=1} \\Delta t\\,\\|\\nabla v^{n}\\mathbf{x}\\|_{2} \\right)\n$$\n第一项是 $F^{n}$ 的最小奇异值 $s_{\\min}(F^n)$ 的定义。第二项是矩阵 $\\Delta t\\,\\nabla v^{n}$ 的谱范数（或最大奇异值）的定义：\n$$\n\\max_{\\|\\mathbf{x}\\|_{2}=1} \\Delta t\\,\\|\\nabla v^{n}\\mathbf{x}\\|_{2} = \\Delta t \\left( \\max_{\\|\\mathbf{x}\\|_{2}=1} \\|\\nabla v^{n}\\mathbf{x}\\|_{2} \\right) = \\Delta t\\,\\|\\nabla v^{n}\\|_{2}\n$$\n这导出了著名的关于奇异值的韦尔(Weyl)不等式：\n$$\ns_{\\min}(F^{n+1}) \\ge s_{\\min}(F^{n}) - \\Delta t\\,\\|\\nabla v^{n}\\|_{2}\n$$\n这个不等式对所有 $\\mathbf{X} \\in \\hat{\\Omega}$ 逐点成立。现在我们可以使用问题的假设。给定存在一个常数 $\\gamma  0$，使得对所有 $\\mathbf{X} \\in \\hat{\\Omega}$ 有 $s_{\\min}(F^{n}(\\mathbf{X})) \\ge \\gamma$。我们还被给予了速度梯度谱范数的一致界：对于几乎所有 $\\mathbf{X} \\in \\hat{\\Omega}$，有 $\\|\\nabla v^{n}(\\mathbf{X})\\|_{2} \\le \\alpha$。\n\n将这些界代入我们的不等式，我们得到一个在 $\\hat{\\Omega}$ 上一致的 $s_{\\min}(F^{n+1})$ 的下界：\n$$\ns_{\\min}(F^{n+1}(\\mathbf{X})) \\ge \\gamma - \\Delta t\\,\\alpha\n$$\n为保证网格不发生缠绕，我们施加充分条件 $s_{\\min}(F^{n+1}(\\mathbf{X}))  0$。这要求：\n$$\n\\gamma - \\Delta t\\,\\alpha  0\n$$\n对时间步长 $\\Delta t$ 求解这个不等式：\n$$\n\\Delta t\\,\\alpha  \\gamma \\implies \\Delta t  \\frac{\\gamma}{\\alpha}\n$$\n这就是时间步长的充分条件。满足此条件的最精确上界是 $\\frac{\\gamma}{\\alpha}$。因此，在此推导下，最大允许时间步长为 $\\Delta t_{\\max} = \\frac{\\gamma}{\\alpha}$。问题指出单位应为秒。常数 $\\gamma = s_{\\min}(F^n)$ 是无量纲的，因为它是长度的比值。常数 $\\alpha$ 的单位是 $\\|\\nabla v^n\\|_2$ 的单位，即（速度/长度），或 $([L][T]^{-1})/[L] = [T]^{-1}$。因此，$\\frac{\\gamma}{\\alpha}$ 的单位是 $[T]$，在国际单位制中是秒，符合要求。\n\n关于问题的第二部分，我们要解释对 $\\|\\nabla \\chi^{n+1}\\|_{2}$ 进行界定如何有助于保持雅可比行列式的正性。变形梯度通过 $F^{n+1} = I + \\nabla \\chi^{n+1}$ 与网格位移 $\\chi^{n+1}$ 相关联。必须维持条件 $\\det(F^{n+1})  0$。与前面的推导类似，我们可以通过确保 $s_{\\min}(F^{n+1})  0$ 来保证这一点。\n我们将相同的奇异值不等式应用于表达式 $F^{n+1} = I + \\nabla \\chi^{n+1}$：\n$$\ns_{\\min}(F^{n+1}) = s_{\\min}(I + \\nabla \\chi^{n+1}) \\ge s_{\\min}(I) - \\| \\nabla \\chi^{n+1} \\|_{2}\n$$\n单位矩阵 $I$ 的所有奇异值都等于 $1$。因此，$s_{\\min}(I) = 1$。不等式变为：\n$$\ns_{\\min}(F^{n+1}) \\ge 1 - \\| \\nabla \\chi^{n+1} \\|_{2}\n$$\n为了确保 $s_{\\min}(F^{n+1})  0$，施加条件 $1 - \\| \\nabla \\chi^{n+1} \\|_{2}  0$ 是充分的，这等价于：\n$$\n\\| \\nabla \\chi^{n+1} \\|_{2}  1\n$$\n这就证明了其作用：如果从参考构型算起的总位移梯度的谱范数保持严格小于 $1$，那么变形梯度 $F^{n+1}$ 的最小奇异值就能保证为正。这反过来又保证了从参考域 $\\hat{\\Omega}$ 到当前域 $\\Omega^{n+1}$ 的映射是保定向的，即 $\\det(F^{n+1})  0$。这个条件对网格畸变的幅度提供了一个直接的几何约束，以防止单元相对于初始未变形构型发生翻转。",
            "answer": "$$\n\\boxed{\\frac{\\gamma}{\\alpha}}\n$$"
        }
    ]
}