{
    "hands_on_practices": [
        {
            "introduction": "在区域分解中，处理非协调网格是核心挑战之一，这通常需要用到“砂浆法”(mortar method)。当相邻子区域的界面上的离散不匹配时（例如，使用不同阶次的多项式），我们就必须将一个空间中的信息投影到另一个空间中。本练习将引导你推导将一个高阶多项式解投影到一个低阶“砂浆”空间时产生的精确误差，这是分析此类方法精度的基本技能。",
            "id": "3381380",
            "problem": "考虑一维谱元间断伽辽金 (DG) 区域分解设置中的非协调界面（砂浆）。令物理界面（面）为参考区间 $[-1,1]$ 在具有常数雅可比行列式 $J$ 的仿射映射下的像，其中 $J = h/2$，$h>0$ 是物理面的长度。砂浆空间是多项式空间 $\\mathbb{P}_{q}$，其中 $q  p$。考虑一个迹函数 $u(\\xi) = 7\\xi^{3}$，它是参考区间上一个 $p=3$ 次的多项式。计算 $u$ 到 $\\mathbb{P}_{q}$ 的 $L^{2}$ 投影所产生的误差 $\\|u - \\Pi_q u\\|_{L^2(\\Gamma)}$，并将其表示为关于物理面长度 $h$ 的函数。对于该问题，假设 $q=1$。答案应为单个代数表达式。",
            "solution": "该问题要求计算一个 $p$ 次多项式 $u$ 在 $L^2$ 范数下到 $\\mathbb{P}_q$ 空间（其中 $q  p$）的最佳逼近误差。\n\n**第1步：理解 $L^2$ 投影**\n\n设 $u(\\xi)$ 是定义在参考区间 $[-1, 1]$ 上的函数。它到多项式空间 $\\mathbb{P}_q$ 的 $L^2$ 投影 $\\Pi_q u$ 是 $\\mathbb{P}_q$ 中唯一满足以下条件的多项式：\n$$\n\\int_{-1}^{1} (u(\\xi) - \\Pi_q u(\\xi)) v(\\xi) \\, d\\xi = 0, \\quad \\forall v(\\xi) \\in \\mathbb{P}_q\n$$\n这表明误差向量 $u - \\Pi_q u$ 与空间 $\\mathbb{P}_q$ 中的所有向量正交。$\\Pi_q u$ 是 $u$ 在 $\\mathbb{P}_q$ 中的最佳逼近。\n\n如果使用标准正交勒让德基 $\\{L_k(\\xi)\\}_{k=0}^{\\infty}$，其中 $\\int_{-1}^{1} L_k(\\xi) L_m(\\xi) \\, d\\xi = \\delta_{km}$，则 $u$ 可以展开为 $u(\\xi) = \\sum_{k=0}^{\\infty} a_k L_k(\\xi)$，其中 $a_k = \\int_{-1}^{1} u(\\xi) L_k(\\xi) \\, d\\xi$。\n投影 $\\Pi_q u$ 就是这个级数的前 $q+1$ 项：$\\Pi_q u(\\xi) = \\sum_{k=0}^{q} a_k L_k(\\xi)$。\n投影误差为 $u - \\Pi_q u = \\sum_{k=q+1}^{\\infty} a_k L_k(\\xi)$。\n\n**第2步：计算特定情况下的投影误差**\n\n给定参数：\n- 解函数：$u(\\xi) = 7\\xi^3$\n- 空间次数：$p=3$，砂浆空间次数 $q=1$\n- 物理面长度：$h$\n- 雅可比行列式：$J = h/2$\n\n我们需要计算 $\\|u - \\Pi_1 u\\|_{L^2(\\Gamma)}$。\n首先，我们将 $u(\\xi)$ 用标准（非正交）勒让德多项式 $P_k(\\xi)$ 表示。我们知道 $P_1(\\xi) = \\xi$ 和 $P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi)$。\n从中可以解出 $\\xi^3 = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi)$。\n因此，$u(\\xi) = 7\\xi^3 = 7\\left(\\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi)\\right) = \\frac{14}{5}P_3(\\xi) + \\frac{21}{5}P_1(\\xi)$。\n\n由于 $u(\\xi)$ 是 $\\mathbb{P}_3$ 中的一个奇函数，其到 $\\mathbb{P}_1$ 的 $L^2$ 投影恰好是其 $P_1$ 分量：\n$$\n\\Pi_1 u(\\xi) = \\frac{21}{5}P_1(\\xi) = \\frac{21}{5}\\xi\n$$\n投影误差为：\n$$\nu(\\xi) - \\Pi_1 u(\\xi) = \\frac{14}{5}P_3(\\xi)\n$$\n\n**第3步：计算误差的 $L^2$ 范数**\n\n物理界面 $\\Gamma$ 上的 $L^2$ 范数由下式给出：\n$$\n\\|e\\|_{L^2(\\Gamma)}^2 = \\int_{\\Gamma} e(x)^2 \\, dx = \\int_{-1}^{1} e(\\xi(x))^2 J \\, d\\xi = J \\int_{-1}^{1} e(\\xi)^2 \\, d\\xi\n$$\n其中 $e(\\xi) = u(\\xi) - \\Pi_1 u(\\xi)$。\n$$\n\\|u - \\Pi_1 u\\|_{L^2(\\Gamma)}^2 = J \\int_{-1}^{1} \\left(\\frac{14}{5}P_3(\\xi)\\right)^2 \\, d\\xi = \\frac{h}{2} \\left(\\frac{14}{5}\\right)^2 \\int_{-1}^{1} P_3(\\xi)^2 \\, d\\xi\n$$\n使用勒让德多项式的正交性关系 $\\int_{-1}^{1} P_k(\\xi)^2 \\, d\\xi = \\frac{2}{2k+1}$，对于 $k=3$ 我们有：\n$$\n\\int_{-1}^{1} P_3(\\xi)^2 \\, d\\xi = \\frac{2}{2(3)+1} = \\frac{2}{7}\n$$\n代入范数计算：\n$$\n\\|u - \\Pi_1 u\\|_{L^2(\\Gamma)}^2 = \\frac{h}{2} \\cdot \\frac{196}{25} \\cdot \\frac{2}{7} = h \\cdot \\frac{196}{25 \\cdot 7} = h \\cdot \\frac{28}{25}\n$$\n因此，投影误差的范数为：\n$$\n\\|u - \\Pi_1 u\\|_{L^2(\\Gamma)} = \\sqrt{\\frac{28h}{25}} = \\frac{\\sqrt{28h}}{5} = \\frac{2\\sqrt{7h}}{5}\n$$\n最终答案应以 $h$ 表示。",
            "answer": "$$\\boxed{\\frac{2\\sqrt{7h}}{5}}$$"
        },
        {
            "introduction": "在界面投影的理论基础上，本练习将深入探讨一个关键的实施细节：数值积分。虽然投影在数学上由积分定义，但在计算机程序中，它们是通过求积法则来近似计算的。本练习将揭示，在处理非线性物理通量时，求积法则的选择如何引入“混淆误差”(aliasing error)，这是确保高阶方法稳定性和准确性的一个虽细微却至关重要的考量。",
            "id": "3381360",
            "problem": "考虑一个标量守恒律谱元离散化中，由区域分解产生的一维界面。在该界面上，通量连续性由间断伽辽金 (DG) 方法中的砂浆投影强制施加。设砂浆空间为标准区间 $[-1,1]$ 上最高次数为 $m=2$ 的勒让德多项式的生成空间，其基函数为 $P_{0}(s)$、$P_{1}(s)$ 和 $P_{2}(s)$，其中 $P_{2}(s) = \\frac{1}{2}\\left(3 s^{2} - 1\\right)$。考虑非线性通量 $F(u) = u^{3}$，并设界面迹为多项式 $u(s) = \\alpha s + \\beta$，其中 $\\alpha$ 和 $\\beta$ 为实数参数。与 $P_{2}$ 相关的砂浆投影系数 $c_{2}$ 由 $L^{2}$ 内积定义\n$$\nc_{2} = \\int_{-1}^{1} F\\!\\left(u(s)\\right) P_{2}(s) \\, ds.\n$$\n在实践中，此积分通过求积法则进行计算。$[-1,1]$ 上的 3 点高斯-勒让德求积对于最高 5 次的多项式是精确的，而 $[-1,1]$ 上节点为 $s \\in \\{-1, 0, 1\\}$、权重为 $w \\in \\left\\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\right\\}$ 的 3 点高斯-洛巴托求积对于最高 3 次的多项式是精确的。将在计算 $c_{2}$ 时，因使用高斯-洛巴托求积而非高斯-勒让德求积而产生的混叠误差定义为\n$$\nE = Q_{\\mathrm{GLob}}\\!\\left(g\\right) - Q_{\\mathrm{Gauss}}\\!\\left(g\\right),\n$$\n其中 $g(s) = F\\!\\left(u(s)\\right) P_{2}(s)$，$Q_{\\mathrm{GLob}}$ 表示 3 点高斯-洛巴托求积，$Q_{\\mathrm{Gauss}}$ 表示 3 点高斯-勒让德求积。计算 $E$ 关于 $\\alpha$ 和 $\\beta$ 的封闭形式解析表达式。将最终答案表示为单个表达式。无需四舍五入，答案不带单位。",
            "solution": "该问题要求计算在间断伽辽金方法中，针对一个特定的砂浆投影积分，因使用 3 点高斯-洛巴托求积法则而非 3 点高斯-勒让德求积法则所产生的混叠误差 $E$。\n\n问题首先通过验证阶段。\n- **已知条件**：\n    - 非线性通量：$F(u) = u^{3}$\n    - 界面迹：$u(s) = \\alpha s + \\beta$\n    - 2 次勒让德多项式：$P_{2}(s) = \\frac{1}{2}(3s^{2} - 1)$\n    - 被积函数：$g(s) = F(u(s)) P_{2}(s)$\n    - 求积法则：\n        - $Q_{\\mathrm{Gauss}}$，3 点高斯-勒让德，对最高 5 次多项式精确。\n        - $Q_{\\mathrm{GLob}}$，3 点高斯-洛巴托，节点为 $s \\in \\{-1, 0, 1\\}$，权重为 $w \\in \\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\}$，对最高 3 次多项式精确。\n    - 混叠误差：$E = Q_{\\mathrm{GLob}}(g) - Q_{\\mathrm{Gauss}}(g)$\n\n- **验证结论**：该问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。所有概念均为偏微分方程数值分析中的标准概念。该问题被认定为有效。\n\n解题过程如下。\n\n首先，我们定义被积函数 $g(s)$。\n在界面迹上计算的通量为：\n$$\nF(u(s)) = (\\alpha s + \\beta)^{3}\n$$\n被积函数是该通量与勒让德多项式 $P_{2}(s)$ 的乘积：\n$$\ng(s) = F(u(s)) P_{2}(s) = (\\alpha s + \\beta)^{3} \\left( \\frac{1}{2}(3s^{2} - 1) \\right)\n$$\n多项式 $F(u(s))$ 的次数为 3，$P_{2}(s)$ 的次数为 2。因此，被积函数 $g(s)$ 是一个次数为 $3 + 2 = 5$ 的多项式。\n\n混叠误差定义为 $E = Q_{\\mathrm{GLob}}(g) - Q_{\\mathrm{Gauss}}(g)$。\n问题陈述 3 点高斯-勒让德求积 $Q_{\\mathrm{Gauss}}$ 对最高 5 次的多项式是精确的。由于 $\\deg(g) = 5$，该求积法则得出积分的精确值：\n$$\nQ_{\\mathrm{Gauss}}(g) = \\int_{-1}^{1} g(s) \\, ds\n$$\n因此，误差表达式简化为：\n$$\nE = Q_{\\mathrm{GLob}}(g) - \\int_{-1}^{1} g(s) \\, ds\n$$\n这恰好是 3 点高斯-洛巴托法则应用于函数 $g(s)$ 时的求积误差。\n\n为了计算 $E$，我们必须计算右侧的两项。\n\n**1. 精确积分 $\\int_{-1}^{1} g(s) \\, ds$ 的计算**\n\n首先，我们展开多项式 $g(s)$：\n$$\nF(u(s)) = (\\alpha s + \\beta)^{3} = \\alpha^{3}s^{3} + 3\\alpha^{2}\\beta s^{2} + 3\\alpha\\beta^{2}s + \\beta^{3}\n$$\n然后，乘以 $P_{2}(s) = \\frac{3}{2}s^{2} - \\frac{1}{2}$：\n$$\ng(s) = \\left( \\alpha^{3}s^{3} + 3\\alpha^{2}\\beta s^{2} + 3\\alpha\\beta^{2}s + \\beta^{3} \\right) \\left( \\frac{3}{2}s^{2} - \\frac{1}{2} \\right)\n$$\n$$\ng(s) = \\frac{3}{2}\\alpha^{3}s^{5} + \\frac{9}{2}\\alpha^{2}\\beta s^{4} + \\left( \\frac{9}{2}\\alpha\\beta^{2} - \\frac{1}{2}\\alpha^{3} \\right)s^{3} + \\left( \\frac{3}{2}\\beta^{3} - \\frac{3}{2}\\alpha^{2}\\beta \\right)s^{2} - \\frac{3}{2}\\alpha\\beta^{2}s - \\frac{1}{2}\\beta^{3}\n$$\n在对称区间 $[-1, 1]$ 上对多项式进行积分时，所有含 $s$ 的奇次幂项的积分都为零。我们只需要考虑偶次幂项：\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\int_{-1}^{1} \\left( \\frac{9}{2}\\alpha^{2}\\beta s^{4} + \\left( \\frac{3}{2}\\beta^{3} - \\frac{3}{2}\\alpha^{2}\\beta \\right)s^{2} - \\frac{1}{2}\\beta^{3} \\right) \\, ds\n$$\n对偶数 $n$ 使用公式 $\\int_{-1}^{1} s^{n} \\, ds = \\frac{2}{n+1}$：\n$$\n\\int_{-1}^{1} s^{4} \\, ds = \\frac{2}{5}, \\quad \\int_{-1}^{1} s^{2} \\, ds = \\frac{2}{3}, \\quad \\int_{-1}^{1} 1 \\, ds = 2\n$$\n将这些代入 $g(s)$ 的积分中：\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\frac{9}{2}\\alpha^{2}\\beta \\left(\\frac{2}{5}\\right) + \\left( \\frac{3}{2}\\beta^{3} - \\frac{3}{2}\\alpha^{2}\\beta \\right)\\left(\\frac{2}{3}\\right) - \\frac{1}{2}\\beta^{3}(2)\n$$\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\frac{9}{5}\\alpha^{2}\\beta + (\\beta^{3} - \\alpha^{2}\\beta) - \\beta^{3}\n$$\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\left(\\frac{9}{5} - 1\\right)\\alpha^{2}\\beta = \\frac{4}{5}\\alpha^{2}\\beta\n$$\n所以，$Q_{\\mathrm{Gauss}}(g) = \\frac{4}{5}\\alpha^{2}\\beta$。\n\n**2. 高斯-洛巴托求积 $Q_{\\mathrm{GLob}}(g)$ 的计算**\n\n$[-1, 1]$ 上的 3 点高斯-洛巴托求积法则由下式给出：\n$$\nQ_{\\mathrm{GLob}}(g) = w_{1}g(s_{1}) + w_{2}g(s_{2}) + w_{3}g(s_{3})\n$$\n节点为 $s_{1}=-1$，$s_{2}=0$，$s_{3}=1$，权重为 $w_{1}=\\frac{1}{3}$，$w_{2}=\\frac{4}{3}$，$w_{3}=\\frac{1}{3}$。\n我们需要计算 $g(s)$ 在这些节点上的值：\n$$\ng(s) = (\\alpha s + \\beta)^{3} \\left( \\frac{1}{2}(3s^{2} - 1) \\right)\n$$\n在 $s = -1$ 处：\n$$\ng(-1) = (\\beta - \\alpha)^{3} \\left( \\frac{1}{2}(3(-1)^{2} - 1) \\right) = (\\beta - \\alpha)^{3} \\left( \\frac{1}{2}(2) \\right) = (\\beta - \\alpha)^{3}\n$$\n在 $s = 0$ 处：\n$$\ng(0) = (\\beta)^{3} \\left( \\frac{1}{2}(3(0)^{2} - 1) \\right) = \\beta^{3} \\left( -\\frac{1}{2} \\right) = -\\frac{1}{2}\\beta^{3}\n$$\n在 $s = 1$ 处：\n$$\ng(1) = (\\alpha + \\beta)^{3} \\left( \\frac{1}{2}(3(1)^{2} - 1) \\right) = (\\alpha + \\beta)^{3} \\left( \\frac{1}{2}(2) \\right) = (\\alpha + \\beta)^{3}\n$$\n现在，我们应用求积公式：\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3}g(-1) + \\frac{4}{3}g(0) + \\frac{1}{3}g(1)\n$$\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3}(\\beta - \\alpha)^{3} + \\frac{4}{3}\\left(-\\frac{1}{2}\\beta^{3}\\right) + \\frac{1}{3}(\\alpha + \\beta)^{3}\n$$\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3} \\left( (\\beta - \\alpha)^{3} + (\\beta + \\alpha)^{3} \\right) - \\frac{2}{3}\\beta^{3}\n$$\n我们使用二项式展开恒等式 $(x-y)^{3} + (x+y)^{3} = 2x^{3} + 6xy^{2}$。令 $x=\\beta$，$y=\\alpha$：\n$$\n(\\beta - \\alpha)^{3} + (\\beta + \\alpha)^{3} = 2\\beta^{3} + 6\\beta\\alpha^{2}\n$$\n将此代回 $Q_{\\mathrm{GLob}}(g)$ 的表达式中：\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3}(2\\beta^{3} + 6\\beta\\alpha^{2}) - \\frac{2}{3}\\beta^{3} = \\frac{2}{3}\\beta^{3} + 2\\beta\\alpha^{2} - \\frac{2}{3}\\beta^{3}\n$$\n$$\nQ_{\\mathrm{GLob}}(g) = 2\\alpha^{2}\\beta\n$$\n\n**3. 混叠误差 $E$ 的最终计算**\n\n最后，我们计算差值：\n$$\nE = Q_{\\mathrm{GLob}}(g) - Q_{\\mathrm{Gauss}}(g) = 2\\alpha^{2}\\beta - \\frac{4}{5}\\alpha^{2}\\beta\n$$\n$$\nE = \\left(2 - \\frac{4}{5}\\right)\\alpha^{2}\\beta = \\left(\\frac{10}{5} - \\frac{4}{5}\\right)\\alpha^{2}\\beta = \\frac{6}{5}\\alpha^{2}\\beta\n$$\n混叠误差为 $\\frac{6}{5}\\alpha^{2}\\beta$。",
            "answer": "$$\n\\boxed{\\frac{6}{5}\\alpha^{2}\\beta}\n$$"
        },
        {
            "introduction": "最后的这个练习将界面耦合和数值积分的概念融合到一个更复杂、更真实的场景中：弯曲几何。在弯曲单元上，要同时保证计算的准确性（通过避免混淆误差）和物理量的离散守恒变得极具挑战性。通过解决这个问题，你将分析几何、非线性通量和求积格式三者如何相互作用，并学习如何运用“过积分”(over-integration)等策略来维持模拟的稳健性和物理保真度。",
            "id": "3381427",
            "problem": "考虑一个二维空间中的标量守恒律 $u_t + \\nabla \\cdot \\mathbf{f}(u) = 0$，该守恒律在一个分解为曲线四边形单元的区域上，通过一个$p$次多项式的间断Galerkin (DG) 方法进行离散。假设两个相邻单元共享一个曲面 $\\Gamma$，该曲面由一个公共参考坐标 $s \\in [-1,1]$ 参数化。DG半离散弱形式贡献了一个界面积分，其形式为\n$$\n\\int_{\\Gamma} \\hat{\\mathbf{f}}\\big(u^-(s),u^+(s),\\mathbf{n}(s)\\big)\\cdot \\mathbf{n}(s)\\, J_f(s)\\, ds,\n$$\n其中 $\\hat{\\mathbf{f}}$ 是一个一致性数值通量，$\\mathbf{n}(s)$ 是单位法向量，$J_f(s)$ 是面雅可比（将参考面上的 $ds$ 映射到 $\\Gamma$ 上弧长的度量因子）。假设几何是等参的，并且在实现中，面雅可比 $J_f(s)$ 是通过投影到单元迹空间上得到的$r$次多项式（这在高阶谱方法和DG程序中是一种常见做法）。左右迹 $u^-(s)$ 和 $u^+(s)$ 是面上的$p$次多项式。界面积分通过具有$n$个点的Gauss–Lobatto–Legendre (GLL) 求积进行计算。关于求积的一个经过充分检验的事实是，具有$n$个点的GLL求积可以精确积分最高为 $2n - 3$ 次的任何多项式被积函数。\n\n在曲面上，当每个单元使用其自身的面参数化和逐单元的GLL节点与权重时，两侧通常会沿着$\\Gamma$采用不同的离散测度 $J_f^\\pm(s)$ 和不同的物理求积节点。这可能导致混叠（积分不足）和跨界面的离散守恒性丧失，尤其对于非线性通量或高阶弯曲几何。\n\n设 $p=3$ 且 $r=3$。考虑两种通量模型：\n1) 具有恒定速度矢量的线性平流，$\\mathbf{f}(u) = \\mathbf{a}\\,u$，以及一个一致的线性数值通量，使得 $\\hat{\\mathbf{f}} \\cdot \\mathbf{n}$ 线性依赖于 $u^\\pm$。\n2) 无粘Burgers方程，$f(u) = \\tfrac{1}{2}u^2$，以及一个一致的数值通量，使得 $\\hat{f}$ 是 $u^\\pm$ 的二次函数。\n\n分析面被积函数的多项式次数以及使用 $n=p+1$ 个点的逐单元GLL求积实现精确积分的条件，并提出一种在共享面求积上使用过积分的去混叠策略。下列哪个陈述是正确的？\n\nA) 对于线性平流，当 $p=3$ 和 $r=3$ 时，面被积函数是 $p+r$ 次多项式，因此使用 $n=p+1=4$ 个点的逐单元GLL会产生混叠，因为 $p+r2n-3$；而使用 $n=5$ 个点的共享面求积可以消除混叠；在两侧使用相同的节点、权重和面测度可以保持跨界面的离散守恒性。\n\nB) 对于Burgers通量，当 $p=3$ 和 $r=3$ 时，使用 $n=5$ 个点的过积分足以通过精确积分面被积函数来消除混叠。\n\nC) 对于Burgers通量，当 $p=3$ 和 $r=3$ 时，使用 $n=6$ 个点的共享面求积可以消除混叠，因为 $2n-3$ 达到或超过了面被积函数的次数；此外，通过 $L^2$ 投影将计算出的通量投影回 $p$ 次面多项式空间，可以在两个单元间产生一个守恒的界面项。\n\nD) 因为Gauss–Lobatto求积包含面的端点，所以逐单元GLL积分在任何曲面界面上都是自动守恒的，与通量非线性和几何阶数无关；混叠不能破坏守恒性。\n\nE) 将求积与每个单元自身的面参数化对齐，并在两侧使用不同的节点和权重，同时将 $n$ 增加到6，可以在不需要共享面求积或公共面测度的情况下保证守恒性。\n\n选择所有适用项。",
            "solution": "用户希望我分析在曲线单元上对守恒律进行的间断Galerkin (DG) 离散，并评估关于求积、混叠和守恒性的几个陈述。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n-   **方程**：二维空间中的标量守恒律，$u_t + \\nabla \\cdot \\mathbf{f}(u) = 0$。\n-   **方法**：多项式次数为$p$的间断Galerkin (DG)方法。\n-   **区域**：分解为曲线四边形单元。\n-   **界面积分**：$\\int_{\\Gamma} \\hat{\\mathbf{f}}\\big(u^-(s),u^+(s),\\mathbf{n}(s)\\big)\\cdot \\mathbf{n}(s)\\, J_f(s)\\, ds$。\n-   **变量**：\n    -   $\\hat{\\mathbf{f}}$：一个一致性数值通量。\n    -   $u^-(s), u^+(s)$：参考面 $s \\in [-1,1]$ 上的$p$次多项式迹。\n    -   $\\mathbf{n}(s)$：曲面 $\\Gamma$ 上的单位法向量。\n    -   $J_f(s)$：面雅可比，表示为$r$次多项式。\n-   **几何**：等参（意味着几何映射使用$p$次多项式）。\n-   **求积**：具有$n$个点的Gauss–Lobatto–Legendre (GLL) 求积，对于最高为 $2n - 3$ 次的多项式被积函数是精确的。\n-   **关键问题**：在曲面上，逐单元求积（不同的节点/权重/雅可比）可能导致混叠和离散守恒性的丧失。\n-   **参数**：$p=3$，$r=3$。\n-   **通量模型**：\n    1.  线性平流：$\\mathbf{f}(u) = \\mathbf{a}\\,u$。数值通量的法向分量 $\\hat{\\mathbf{f}} \\cdot \\mathbf{n}$ 线性依赖于 $u^\\pm$。\n    2.  无粘Burgers方程：$f(u) = \\tfrac{1}{2}u^2$。数值通量 $\\hat{f}$ 是 $u^\\pm$ 的二次函数。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题坚实地植根于偏微分方程高阶数值方法的理论，特别是DG和谱方法。所有概念——DG公式、数值通量、等参单元、求积法则、混叠以及在弯曲网格上的离散守恒性——都是该领域的标准和关键主题。\n-   **适定性**：该问题是适定的。它提供了具体参数（$p=3$，$r=3$），清晰的通量函数描述（线性和二次），以及精确的求积法则（$n$点GLL，对于最高为$2n-3$次的函数是精确的）。这种设置允许对所涉及的多项式次数和精确积分所需的求积点数进行明确的分析。\n-   **客观性**：语言是技术性的、精确的和客观的。没有会妨碍严谨分析的主观或模糊陈述。\n\n**步骤3：结论和行动**\n问题陈述是有效的。它在科学上是合理的、适定的、客观的，并包含进行严谨分析所需的所有信息。我将继续进行求解。\n\n### 求解推导\n\n问题的核心是确定面被积函数 $\\mathcal{I}(s) = \\hat{\\mathbf{f}}\\big(u^-(s),u^+(s),\\mathbf{n}(s)\\big)\\cdot \\mathbf{n}(s)\\, J_f(s)$ 的多项式次数，并将其与GLL求积可以精确积分的次数进行比较。\n\n迹函数 $u^-(s)$ 和 $u^+(s)$ 是$p$次多项式。面雅可比 $J_f(s)$ 被给定为$r$次多项式。数值通量的法向分量 $\\hat{F}(s) = \\hat{\\mathbf{f}}\\cdot\\mathbf{n}$ 通过 $\\mathbf{n}(s)$ 依赖于 $u^\\pm$ 和几何形状。一个稳健且常用的被积函数总次数模型是：\n$$\n\\text{被积函数次数} = (\\text{u的通量函数次数}) \\times (\\text{解的次数 } p) + (\\text{几何因子次数})\n$$\n问题指定了等参映射（几何阶数与解的阶数$p$匹配），但将面雅可比$J_f(s)$表示为$r$次多项式。这表明几何复杂性被封装在$r$中。通量项$\\hat{F}$依赖于$u^\\pm$（$p$次）以及可能依赖于$s$的其他几何因子。一个简化但标准的、与问题措辞一致的工作模型是，假设通量项本身$\\hat{F}(s)$的次数主要由解多项式驱动。那么，总被积函数的次数就是通量项的次数加上雅可比的次数。\n-   对于线性通量函数（$\\mathbf{f}(u) \\propto u$），数值通量的法向分量 $\\hat{F}(s)$ 将是一个多项式，其次数由 $u^\\pm(s)$ 主导，即$p$次。\n-   对于二次通量函数（$f(u) \\propto u^2$），$\\hat{F}(s)$将是一个由类似$(u^\\pm(s))^2$的项主导的多项式，即$2p$次。\n\n因此，我们可以为被积函数 $\\mathcal{I}(s) = \\hat{F}(s)J_f(s)$ 建立以下次数模型：\n1.  **线性平流**：$\\text{degree}(\\mathcal{I}_{\\text{linear}}) = \\text{degree}(\\hat{F}) + \\text{degree}(J_f) = p + r$。\n2.  **Burgers方程**：$\\text{degree}(\\mathcal{I}_{\\text{Burgers}}) = \\text{degree}(\\hat{F}) + \\text{degree}(J_f) = 2p + r$。\n\n给定$p=3$和$r=3$。\n-   对于线性平流，$\\text{degree}(\\mathcal{I}_{\\text{linear}}) = 3 + 3 = 6$。\n-   对于Burgers方程，$\\text{degree}(\\mathcal{I}_{\\text{Burgers}}) = 2(3) + 3 = 9$。\n\n具有$n$个点的GLL求积对于最高为 $2n - 3$ 次的多项式是精确的。如果 $2n - 3 \\ge \\text{degree}(\\mathcal{I})$，则可以避免混叠。\n\n**逐项分析**\n\n**A) 对于线性平流，当 $p=3$ 和 $r=3$ 时，面被积函数是 $p+r$ 次多项式，因此使用 $n=p+1=4$ 个点的逐单元GLL会产生混叠，因为 $p+r2n-3$，而使用 $n=5$ 个点的共享面求积可以消除混叠；在两侧使用相同的节点、权重和面测度可以保持跨界面的离散守恒性。**\n-   **被积函数次数与 $n=4$ 时的混叠**：如前所述，线性平流的被积函数次数为 $p+r = 3+3=6$。标准的求积选择是 $n=p+1=4$。对于 $n=4$ 个点，GLL对于最高为 $2n-3 = 2(4)-3=5$ 次的多项式是精确的。由于被积函数次数为6，而 $6  5$，所以求积不精确并引入了混叠误差。陈述中的推理是正确的。\n-   **使用 $n=5$ 进行过积分**：如果我们使用 $n=5$ 个点，GLL对于最高为 $2n-3 = 2(5)-3=7$ 次的多项式是精确的。由于被积函数次数为6，而 $6 \\le 7$，这个求积法则足以精确积分该项，从而消除混叠。陈述的这一部分也是正确的。\n-   **守恒性**：当相邻单元使用各自不匹配的求积点和几何因子时，在曲面界面上离散守恒性会丧失。为了恢复守恒性，共享同一面的两个单元必须使用一套公共（共享）的求积点、权重和几何因子（法向量、雅可比）。这确保了从两侧计算的数值通量是相同的（除了法向量的符号），从而在全局求和中可以抵消。这个原则陈述正确。\n\n因此，陈述A完全正确。\n**结论：正确**\n\n**B) 对于Burgers通量，当 $p=3$ 和 $r=3$ 时，使用 $n=5$ 个点的过积分足以通过精确积分面被积函数来消除混叠。**\n-   **被积函数次数**：对于Burgers方程（一个二次通量），被积函数次数为 $2p+r = 2(3)+3=9$。\n-   **使用 $n=5$ 进行求积**：对于 $n=5$ 个点，GLL对于最高为 $2n-3 = 2(5)-3=7$ 次的多项式是精确的。\n-   **结论**：由于精确积分所需的次数是9，而 $n=5$ 个点只提供最高7次的精确性，这种程度的过积分是不够的。混叠仍然会发生。该陈述是错误的。\n\n因此，陈述B不正确。\n**结论：不正确**\n\n**C) 对于Burgers通量，当 $p=3$ 和 $r=3$ 时，使用 $n=6$ 个点的共享面求积可以消除混叠，因为 $2n-3$ 达到或超过了面被积函数的次数；此外，通过 $L^2$ 投影将计算出的通量投影回 $p$ 次面多项式空间，可以在两个单元间产生一个守恒的界面项。**\n-   **被积函数次数与 $n=6$ 时的混叠**：Burgers通量的被积函数次数为 $2p+r=9$。如果我们使用 $n=6$ 个点，GLL对于最高为 $2n-3 = 2(6)-3=9$ 次的多项式是精确的。由于被积函数次数为9，而求积法则对于9次是精确的，这足以消除被积函数的混叠。陈述的第一部分是正确的。\n-   **守恒性与投影**：该陈述提出了一个涉及共享求积法则和投影的程序。正如在A的分析中所确立的，“共享面求积”的使用是确保界面项守恒的关键机制。将计算出的通量（在共享求积点上评估）投影回$p$次多项式空间的额外步骤，是一种已知的去混叠和确保稳定性的技术（例如，在分裂形式的DG方法中）。这整个程序（用于守恒的共享法则，用于稳定性/去混叠的过积分和投影）是一种有效且守恒的方法。\n\n因此，陈述C正确。\n**结论：正确**\n\n**D) 因为Gauss–Lobatto求积包含面的端点，所以逐单元GLL积分在任何曲面界面上都是自动守恒的，与通量非线性和几何阶数无关；混叠不能破坏守恒性。**\n-   这个陈述有根本性的缺陷。虽然参考区间端点（$s=\\pm 1$）的GLL节点对应于协调单元的相同物理顶点，但是当面是弯曲的并且每个单元使用自己的映射时，所有内部GLL节点在物理空间中并不会对齐。例如，单元A的参考坐标中的点$s_k$映射到曲线上的物理点与单元B的参考坐标中的点$s_k$映射到的物理点不同。这种在求积点、权重和几何因子（$J_f(s)$，$\\mathbf{n}(s)$）上的不匹配正是破坏离散守恒性的原因。混叠进一步加剧了误差。守恒性不是自动的。\n\n因此，陈述D不正确。\n**结论：不正确**\n\n**E) 将求积与每个单元自身的面参数化对齐，并在两侧使用不同的节点和权重，同时将 $n$ 增加到6，可以在不需要共享面求积或公共面测度的情况下保证守恒性。**\n-   这个陈述描述了非守恒方法，并错误地声称它能保证守恒性。“在两侧使用不同的节点和权重”正是导致守恒误差的问题的定义。增加求积点的数量（$n=6$）使每一侧的积分近似更准确（减少混叠误差），这可能会减小守恒误差的大小，但不能消除它。为了保证守恒性，界面两侧的离散求和必须精确抵消，这需要一个共享的、公共的求积法则。\n\n因此，陈述E不正确。\n**结论：不正确**",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}