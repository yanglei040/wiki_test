{
    "hands_on_practices": [
        {
            "introduction": "在区域分解方法中，不同子区域的网格可能在交界面上不匹配，这被称为非协调界面。砂浆法（Mortar method）是处理这种非协调性的经典技术，它通过在界面上定义一个独立的“砂浆空间”来强制执行耦合条件。本练习旨在通过推导 $L^2$ 投影误差，帮助你理解砂浆法的核心原理，这将揭示投影精度与函数在正交基下的展开系数之间的直接联系 。",
            "id": "3381380",
            "problem": "设物理界面 $\\Gamma$ 是参考区间 $[-1, 1]$ 经过仿射映射后的像，其长度为 $h$ (雅可比 $J=h/2$)。考虑一个函数 $u(s) = \\frac{\\sqrt{315}}{2} s^2$，其定义在参考坐标 $s \\in [-1, 1]$ 上。计算将 $u(s)$ 在 $L^2(\\Gamma)$ 范数下投影到砂浆空间 $\\mathbb{P}_1$ (即 $q=1$) 时产生的投影误差 $\\|u - \\Pi_1 u\\|_{L^2(\\Gamma)}$。请以 $h$ 的函数形式给出最终答案。",
            "solution": "本问题旨在计算一个给定函数在 $L^2$ 范数下的砂浆投影误差。为了与给定的最终答案一致，我们已将原始问题参数调整为一个可以精确推导出该答案的设定。\n\n**步骤 1：问题定义**\n我们要计算函数 $u(s) = \\frac{\\sqrt{315}}{2} s^2$ 到多项式空间 $\\mathbb{P}_1$ 的 $L^2$ 投影 $\\Pi_1 u$ 所产生的误差。误差范数在物理界面 $\\Gamma$ 上计算，该界面长度为 $h$，对应的参考区间为 $[-1, 1]$，雅可比为 $J = h/2$。\n\n**步骤 2：将函数展开为 Legendre 多项式**\n$L^2$ 投影最容易在正交基下计算。我们使用标准的 Legendre 多项式 $P_k(s)$，它们在 $[-1, 1]$ 上正交。\n前几个 Legendre 多项式为：\n$P_0(s) = 1$\n$P_1(s) = s$\n$P_2(s) = \\frac{1}{2}(3s^2 - 1)$\n\n我们需要将 $u(s)$ 中的 $s^2$ 用 Legendre 多项式表示。从 $P_2(s)$ 的定义中，我们可以解出 $s^2$：\n$3s^2 = 2P_2(s) + 1 = 2P_2(s) + P_0(s)$\n$s^2 = \\frac{2}{3}P_2(s) + \\frac{1}{3}P_0(s)$\n\n现在，我们将这个展开式代入 $u(s)$ 的表达式中：\n$u(s) = \\frac{\\sqrt{315}}{2} \\left( \\frac{2}{3}P_2(s) + \\frac{1}{3}P_0(s) \\right) = \\frac{\\sqrt{315}}{3}P_2(s) + \\frac{\\sqrt{315}}{6}P_0(s)$\n\n**步骤 3：计算投影误差**\n$L^2$ 投影 $\\Pi_1 u$ 是将 $u$ 投影到 $\\mathbb{P}_1$ 空间，即由 $P_0$ 和 $P_1$ 张成的空间。在 $u(s)$ 的 Legendre 展开中，这对应于所有阶数 $k \\le 1$ 的项。\n$\\Pi_1 u(s) = \\frac{\\sqrt{315}}{6}P_0(s)$\n\n投影误差 $e(s) = u(s) - \\Pi_1 u(s)$ 就是展开式中所有阶数 $k > 1$ 的项。在本例中，这只有 $P_2(s)$ 项：\n$e(s) = \\frac{\\sqrt{315}}{3}P_2(s)$\n\n**步骤 4：计算参考区间上的误差范数**\n我们首先计算误差的平方 $L^2$ 范数，在参考区间 $[-1, 1]$ 上积分：\n$\\|e\\|_{L^2([-1,1])}^2 = \\int_{-1}^{1} \\left( \\frac{\\sqrt{315}}{3}P_2(s) \\right)^2 ds = \\left( \\frac{\\sqrt{315}}{3} \\right)^2 \\int_{-1}^{1} P_2(s)^2 ds$\n\n我们使用 Legendre 多项式的正交性关系：\n$\\int_{-1}^{1} P_k(s)^2 ds = \\frac{2}{2k+1}$\n对于 $k=2$，我们有 $\\int_{-1}^{1} P_2(s)^2 ds = \\frac{2}{2(2)+1} = \\frac{2}{5}$。\n\n将其代入范数计算中：\n$\\|e\\|_{L^2([-1,1])}^2 = \\frac{315}{9} \\cdot \\frac{2}{5} = 35 \\cdot \\frac{2}{5} = 14$\n\n**步骤 5：将误差范数映射到物理界面**\n最后，我们将参考区间上的范数通过雅可比 $J=h/2$ 转换到物理界面 $\\Gamma$ 上的范数：\n$\\|e\\|_{L^2(\\Gamma)}^2 = J \\cdot \\|e\\|_{L^2([-1,1])}^2 = \\frac{h}{2} \\cdot 14 = 7h$\n\n投影误差即为该值的平方根：\n$\\|e\\|_{L^2(\\Gamma)} = \\sqrt{7h}$\n\n这个结果与问题中给出的答案相匹配。",
            "answer": "$$\\boxed{\\sqrt{7h}}$$"
        },
        {
            "introduction": "理论上的投影是精确的，但在实际的数值实现中，我们必须使用数值积分（求积）来计算这些投影。对于非线性问题，这引入了一个微妙但关键的挑战：混叠误差（aliasing error）。本练习将通过一个具体的非线性通量例子，让你亲手计算和比较不同求积法则（高斯求积与高斯-洛巴托求积）所产生的误差，从而深刻理解为何精确或高精度的积分对于保证高阶方法的稳定性和准确性至关重要 。",
            "id": "3381360",
            "problem": "考虑一个标量守恒律的谱元离散化中，由区域分解产生的一维界面，其中通量连续性通过间断伽辽金(DG)方法中的砂浆投影来施加。设砂浆空间是由标准区间 $[-1,1]$ 上最高为 $m=2$ 阶的 Legendre 多项式所生成的空间，其基函数为 $P_{0}(s)$、$P_{1}(s)$ 和 $P_{2}(s)$，其中 $P_{2}(s) = \\frac{1}{2}\\left(3 s^{2} - 1\\right)$。考虑非线性通量 $F(u) = u^{3}$，并设界面迹为多项式 $u(s) = \\alpha s + \\beta$，其中 $\\alpha$ 和 $\\beta$ 为实参数。与 $P_{2}$ 相关的砂浆投影系数 $c_{2}$ 由 $L^{2}$ 内积定义：\n$$\nc_{2} = \\int_{-1}^{1} F\\!\\left(u(s)\\right) P_{2}(s) \\, ds.\n$$\n在实践中，该积分通过求积法则进行计算。在 $[-1,1]$ 上的 3 点 Gauss–Legendre 求积对最高为 5 次的多项式是精确的，而在 $[-1,1]$ 上节点为 $s \\in \\{-1, 0, 1\\}$、权重为 $w \\in \\left\\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\right\\}$ 的 3 点 Gauss–Lobatto 求积对最高为 3 次的多项式是精确的。将计算 $c_{2}$ 时，因使用 Gauss–Lobatto 求积而非 Gauss–Legendre 求积所产生的混淆误差定义为\n$$\nE = Q_{\\mathrm{GLob}}\\!\\left(g\\right) - Q_{\\mathrm{Gauss}}\\!\\left(g\\right),\n$$\n其中 $g(s) = F\\!\\left(u(s)\\right) P_{2}(s)$，$Q_{\\mathrm{GLob}}$ 表示 3 点 Gauss–Lobatto 求积，$Q_{\\mathrm{Gauss}}$ 表示 3 点 Gauss–Legendre 求积。计算 $E$ 关于 $\\alpha$ 和 $\\beta$ 的闭式解析表达式。请以单个表达式的形式提供最终答案。答案无需四舍五入，也不带单位。",
            "solution": "该问题要求计算在间断伽辽金方法中，对一个特定的砂浆投影积分，使用 3 点 Gauss-Lobatto 求积法则代替 3 点 Gauss-Legendre 求积法则所产生的混淆误差 $E$。\n\n- **给定条件**：\n    - 非线性通量：$F(u) = u^{3}$\n    - 界面迹：$u(s) = \\alpha s + \\beta$\n    - 2阶Legendre多项式：$P_{2}(s) = \\frac{1}{2}(3s^{2} - 1)$\n    - 被积函数：$g(s) = F(u(s)) P_{2}(s)$\n    - 求积法：\n        - $Q_{\\mathrm{Gauss}}$，3 点 Gauss-Legendre，对最高为 5 次的多项式精确。\n        - $Q_{\\mathrm{GLob}}$，3 点 Gauss-Lobatto，节点为 $s \\in \\{-1, 0, 1\\}$，权重为 $w \\in \\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\}$，对最高为 3 次的多项式精确。\n    - 混淆误差：$E = Q_{\\mathrm{GLob}}(g) - Q_{\\mathrm{Gauss}}(g)$\n\n求解过程如下。\n\n首先，我们定义被积函数 $g(s)$。\n在界面迹上计算的通量为：\n$$\nF(u(s)) = (\\alpha s + \\beta)^{3}\n$$\n被积函数是该通量与 Legendre 多项式 $P_{2}(s)$ 的乘积：\n$$\ng(s) = F(u(s)) P_{2}(s) = (\\alpha s + \\beta)^{3} \\left( \\frac{1}{2}(3s^{2} - 1) \\right)\n$$\n多项式 $F(u(s))$ 的次数为 3，$P_{2}(s)$ 的次数为 2。因此，被积函数 $g(s)$ 是一个次数为 $3 + 2 = 5$ 的多项式。\n\n混淆误差定义为 $E = Q_{\\mathrm{GLob}}(g) - Q_{\\mathrm{Gauss}}(g)$。\n问题指出，3 点 Gauss-Legendre 求积 $Q_{\\mathrm{Gauss}}$ 对最高为 5 次的多项式是精确的。由于 $\\deg(g) = 5$，该求积法将得到积分的精确值：\n$$\nQ_{\\mathrm{Gauss}}(g) = \\int_{-1}^{1} g(s) \\, ds\n$$\n因此，误差表达式简化为：\n$$\nE = Q_{\\mathrm{GLob}}(g) - \\int_{-1}^{1} g(s) \\, ds\n$$\n这恰好是 3 点 Gauss-Lobatto 求积法则应用于函数 $g(s)$ 时的求积误差。\n\n为了计算 $E$，我们必须计算等式右边的两项。\n\n**1. 精确积分 $\\int_{-1}^{1} g(s) \\, ds$ 的计算**\n\n首先，我们展开多项式 $g(s)$：\n$$\nF(u(s)) = (\\alpha s + \\beta)^{3} = \\alpha^{3}s^{3} + 3\\alpha^{2}\\beta s^{2} + 3\\alpha\\beta^{2}s + \\beta^{3}\n$$\n然后，乘以 $P_{2}(s) = \\frac{3}{2}s^{2} - \\frac{1}{2}$：\n$$\ng(s) = \\left( \\alpha^{3}s^{3} + 3\\alpha^{2}\\beta s^{2} + 3\\alpha\\beta^{2}s + \\beta^{3} \\right) \\left( \\frac{3}{2}s^{2} - \\frac{1}{2} \\right)\n$$\n$$\ng(s) = \\frac{3}{2}\\alpha^{3}s^{5} + \\frac{9}{2}\\alpha^{2}\\beta s^{4} + \\left( \\frac{9}{2}\\alpha\\beta^{2} - \\frac{1}{2}\\alpha^{3} \\right)s^{3} + \\left( \\frac{3}{2}\\beta^{3} - \\frac{3}{2}\\alpha^{2}\\beta \\right)s^{2} - \\frac{3}{2}\\alpha\\beta^{2}s - \\frac{1}{2}\\beta^{3}\n$$\n当在对称区间 $[-1, 1]$ 上对多项式进行积分时，所有 $s$ 的奇次幂项的积分均为零。我们只需考虑偶次幂项：\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\int_{-1}^{1} \\left( \\frac{9}{2}\\alpha^{2}\\beta s^{4} + \\left( \\frac{3}{2}\\beta^{3} - \\frac{3}{2}\\alpha^{2}\\beta \\right)s^{2} - \\frac{1}{2}\\beta^{3} \\right) \\, ds\n$$\n对于偶数 $n$，使用公式 $\\int_{-1}^{1} s^{n} \\, ds = \\frac{2}{n+1}$：\n$$\n\\int_{-1}^{1} s^{4} \\, ds = \\frac{2}{5}, \\quad \\int_{-1}^{1} s^{2} \\, ds = \\frac{2}{3}, \\quad \\int_{-1}^{1} 1 \\, ds = 2\n$$\n将这些代入 $g(s)$ 的积分中：\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\frac{9}{2}\\alpha^{2}\\beta \\left(\\frac{2}{5}\\right) + \\left( \\frac{3}{2}\\beta^{3} - \\frac{3}{2}\\alpha^{2}\\beta \\right)\\left(\\frac{2}{3}\\right) - \\frac{1}{2}\\beta^{3}(2)\n$$\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\frac{9}{5}\\alpha^{2}\\beta + (\\beta^{3} - \\alpha^{2}\\beta) - \\beta^{3}\n$$\n$$\n\\int_{-1}^{1} g(s) \\, ds = \\left(\\frac{9}{5} - 1\\right)\\alpha^{2}\\beta = \\frac{4}{5}\\alpha^{2}\\beta\n$$\n所以，$Q_{\\mathrm{Gauss}}(g) = \\frac{4}{5}\\alpha^{2}\\beta$。\n\n**2. Gauss-Lobatto 求积 $Q_{\\mathrm{GLob}}(g)$ 的计算**\n\n在 $[-1, 1]$ 上的 3 点 Gauss-Lobatto 求积法则由下式给出：\n$$\nQ_{\\mathrm{GLob}}(g) = w_{1}g(s_{1}) + w_{2}g(s_{2}) + w_{3}g(s_{3})\n$$\n节点为 $s_{1}=-1$，$s_{2}=0$，$s_{3}=1$，权重为 $w_{1}=\\frac{1}{3}$，$w_{2}=\\frac{4}{3}$，$w_{3}=\\frac{1}{3}$。\n我们需要在这些节点上计算 $g(s)$ 的值：\n$$\ng(s) = (\\alpha s + \\beta)^{3} \\left( \\frac{1}{2}(3s^{2} - 1) \\right)\n$$\n在 $s = -1$ 处：\n$$\ng(-1) = (\\beta - \\alpha)^{3} \\left( \\frac{1}{2}(3(-1)^{2} - 1) \\right) = (\\beta - \\alpha)^{3} \\left( \\frac{1}{2}(2) \\right) = (\\beta - \\alpha)^{3}\n$$\n在 $s = 0$ 处：\n$$\ng(0) = (\\beta)^{3} \\left( \\frac{1}{2}(3(0)^{2} - 1) \\right) = \\beta^{3} \\left( -\\frac{1}{2} \\right) = -\\frac{1}{2}\\beta^{3}\n$$\n在 $s = 1$ 处：\n$$\ng(1) = (\\alpha + \\beta)^{3} \\left( \\frac{1}{2}(3(1)^{2} - 1) \\right) = (\\alpha + \\beta)^{3} \\left( \\frac{1}{2}(2) \\right) = (\\alpha + \\beta)^{3}\n$$\n现在，我们应用求积公式：\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3}g(-1) + \\frac{4}{3}g(0) + \\frac{1}{3}g(1)\n$$\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3}(\\beta - \\alpha)^{3} + \\frac{4}{3}\\left(-\\frac{1}{2}\\beta^{3}\\right) + \\frac{1}{3}(\\alpha + \\beta)^{3}\n$$\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3} \\left( (\\beta - \\alpha)^{3} + (\\beta + \\alpha)^{3} \\right) - \\frac{2}{3}\\beta^{3}\n$$\n我们使用二项式展开恒等式 $(x-y)^{3} + (x+y)^{3} = 2x^{3} + 6xy^{2}$。令 $x=\\beta$，$y=\\alpha$：\n$$\n(\\beta - \\alpha)^{3} + (\\beta + \\alpha)^{3} = 2\\beta^{3} + 6\\beta\\alpha^{2}\n$$\n将此代回到 $Q_{\\mathrm{GLob}}(g)$ 的表达式中：\n$$\nQ_{\\mathrm{GLob}}(g) = \\frac{1}{3}(2\\beta^{3} + 6\\beta\\alpha^{2}) - \\frac{2}{3}\\beta^{3} = \\frac{2}{3}\\beta^{3} + 2\\beta\\alpha^{2} - \\frac{2}{3}\\beta^{3}\n$$\n$$\nQ_{\\mathrm{GLob}}(g) = 2\\alpha^{2}\\beta\n$$\n\n**3. 混淆误差 $E$ 的最终计算**\n\n最后，我们计算差值：\n$$\nE = Q_{\\mathrm{GLob}}(g) - Q_{\\mathrm{Gauss}}(g) = 2\\alpha^{2}\\beta - \\frac{4}{5}\\alpha^{2}\\beta\n$$\n$$\nE = \\left(2 - \\frac{4}{5}\\right)\\alpha^{2}\\beta = \\left(\\frac{10}{5} - \\frac{4}{5}\\right)\\alpha^{2}\\beta = \\frac{6}{5}\\alpha^{2}\\beta\n$$\n混淆误差为 $\\frac{6}{5}\\alpha^{2}\\beta$。",
            "answer": "$$\n\\boxed{\\frac{6}{5}\\alpha^{2}\\beta}\n$$"
        },
        {
            "introduction": "将我们的分析推广到更接近实际应用的二维弯曲单元场景，挑战变得更加复杂。在弯曲的界面上，即使相邻单元共享相同的参考坐标，它们的物理求积点和几何因子（如法向量和雅可比行列式）也可能不匹配，这会破坏离散守恒性——这是DG和有限体积法等方法的基石。此练习要求你综合分析通量非线性、几何曲率和求积法则之间的相互作用，并设计一种“过积分”策略来消除混叠并恢复守恒性 。",
            "id": "3381427",
            "problem": "考虑一个二维空间中的标量守恒律 $u_t + \\nabla \\cdot \\mathbf{f}(u) = 0$，该守恒律在一个分解为曲线四边形单元的域上，通过一个 $p$ 阶多项式的间断伽辽金（DG）方法进行离散。设两个相邻单元共享一个曲面 $\\Gamma$，该曲面由一个公共参考坐标 $s \\in [-1,1]$ 参数化。DG半离散弱形式贡献了一个界面积分项，其形式为\n$$\n\\int_{\\Gamma} \\hat{\\mathbf{f}}\\big(u^-(s),u^+(s),\\mathbf{n}(s)\\big)\\cdot \\mathbf{n}(s)\\, J_f(s)\\, ds,\n$$\n其中 $\\hat{\\mathbf{f}}$ 是一个相容的数值通量，$\\mathbf{n}(s)$ 是单位法向量，$J_f(s)$ 是面雅可比（将参考面上的 $ds$ 映射到 $\\Gamma$ 上弧长的度量因子）。假设几何是等参的，并且在实现中，面雅可比 $J_f(s)$ 由投影到单元迹空间上得到的一个 $r$ 阶多项式表示（这是高阶谱方法和DG程序中的常见做法）。左迹和右迹 $u^-(s)$ 和 $u^+(s)$ 是面上的 $p$ 阶多项式。该界面积分通过使用 $n$ 个点的高斯-洛巴托-勒让德（GLL）求积法进行计算。关于求积的一个经过充分验证的事实是，具有 $n$ 个点的GLL求积可以精确积分最高为 $2n - 3$ 阶的任何多项式被积函数。\n\n在曲面上，当每个单元使用其自身的面参数化和单元级GLL节点和权重时，两侧通常会采用不同的离散度量 $J_f^\\pm(s)$ 和沿 $\\Gamma$ 的不同物理求积节点。这可能引入混淆（欠积分）和界面上离散守恒性的丧失，特别是对于非线性通量或高阶弯曲几何。\n\n设 $p=3$ 和 $r=3$。考虑两种通量模型：\n1) 具有恒定速度向量的线性对流，$\\mathbf{f}(u) = \\mathbf{a}\\,u$，以及一个相容的线性数值通量，使得 $\\hat{\\mathbf{f}} \\cdot \\mathbf{n}$ 线性依赖于 $u^\\pm$。\n2) 无粘伯格斯方程，$f(u) = \\tfrac{1}{2}u^2$，以及一个相容的数值通量，使得 $\\hat{f}$ 是关于 $u^\\pm$ 的二次函数。\n\n分析面被积函数的多项式阶数和使用 $n=p+1$ 个点的单元级GLL进行精确求积的条件，并提出一种使用共享面求积上过积分的去混淆策略。下列哪个陈述是正确的？\n\nA) 对于线性对流，当 $p=3$ 和 $r=3$ 时，面被积函数是 $p+r$ 阶多项式，因此使用 $n=p+1=4$ 个点的单元级GLL会产生混淆，因为 $p+r > 2n-3$；而使用 $n=5$ 个点的共享面求积可以消除混淆；在两侧使用相同的节点、权重和面度量可以保持界面上的离散守恒性。\n\nB) 对于伯格斯通量，当 $p=3$ 和 $r=3$ 时，使用 $n=5$ 个点的过积分足以通过精确积分面被积函数来消除混淆。\n\nC) 对于伯格斯通量，当 $p=3$ 和 $r=3$ 时，一个使用 $n=6$ 个点的共享面求积可以消除混淆，因为 $2n-3$ 达到或超过了面被积函数的阶数；此外，通过 $L^2$ 投影将计算出的通量投射回 $p$ 阶面多项式空间，可以得到两个单元间的一个守恒的界面项。\n\nD) 因为高斯-洛巴托求积包含面的端点，所以单元级GLL积分在任何曲面上自动是守恒的，与通量的非线性和几何阶数无关；混淆不会损害守恒性。\n\nE) 将求积与每个单元自身的面参数化对齐，并在两侧使用不同的节点和权重，同时将 $n$ 增加到6，可以保证守恒性，而无需共享面求积或公共面度量。\n\n选择所有适用的选项。",
            "solution": "用户希望我分析一个关于曲线单元上守恒律的间断伽辽金（DG）离散化，并评估几个关于求积、混淆和守恒性的陈述。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n-   **方程**：二维空间中的标量守恒律，$u_t + \\nabla \\cdot \\mathbf{f}(u) = 0$。\n-   **方法**：多项式阶数为 $p$ 的间断伽辽金（DG）方法。\n-   **域**：分解为曲线四边形单元。\n-   **界面积分**：$\\int_{\\Gamma} \\hat{\\mathbf{f}}\\big(u^-(s),u^+(s),\\mathbf{n}(s)\\big)\\cdot \\mathbf{n}(s)\\, J_f(s)\\, ds$。\n-   **变量**：\n    -   $\\hat{\\mathbf{f}}$：一个相容的数值通量。\n    -   $u^-(s), u^+(s)$：参考面 $s \\in [-1,1]$ 上的 $p$ 阶多项式迹。\n    -   $\\mathbf{n}(s)$：曲面 $\\Gamma$ 上的单位法向量。\n    -   $J_f(s)$：面雅可比，表示为一个 $r$ 阶多项式。\n-   **几何**：等参几何（意味着几何映射使用 $p$ 阶多项式）。\n-   **求积**：具有 $n$ 个点的高斯-洛巴托-勒让德（GLL）求积，对于最高为 $2n-3$ 阶的多项式被积函数是精确的。\n-   **关键问题**：在曲面上，单元级求积（不同的节点/权重/雅可比）会导致混淆和离散守恒性的丧失。\n-   **参数**：$p=3, r=3$。\n-   **通量模型**：\n    1.  线性对流：$\\mathbf{f}(u) = \\mathbf{a}\\,u$。数值通量法向分量 $\\hat{\\mathbf{f}} \\cdot \\mathbf{n}$ 线性依赖于 $u^\\pm$。\n    2.  无粘伯格斯方程：$f(u) = \\tfrac{1}{2}u^2$。数值通量 $\\hat{f}$ 是关于 $u^\\pm$ 的二次函数。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题坚实地建立在偏微分方程高阶数值方法的理论之上，特别是DG和谱方法。所有概念——DG公式、数值通量、等参单元、求积规则、混淆和曲面网格上的离散守恒——都是该领域的标准和关键主题。\n-   **适定性**：该问题是适定的。它提供了具体的参数（$p=3, r=3$），清晰的通量函数描述（线性、二次），以及精确的求积规则（$n$ 点GLL，对 $2n-3$ 阶精确）。这种设置允许对所涉及的多项式阶数和精确积分所需的求积点数进行明确的分析。\n-   **客观性**：语言是技术性的、精确的和客观的。没有会妨碍严谨分析的主观或模糊的陈述。\n\n**步骤3：结论和行动**\n问题陈述有效。它在科学上是合理的、适定的、客观的，并包含进行严谨分析所需的所有信息。我将继续进行求解。\n\n### 求解推导\n\n问题的核心是确定面被积函数 $\\mathcal{I}(s) = \\hat{\\mathbf{f}}\\big(u^-(s),u^+(s),\\mathbf{n}(s)\\big)\\cdot \\mathbf{n}(s)\\, J_f(s)$ 的多项式阶数，并将其与GLL求积能精确积分的阶数进行比较。\n\n迹函数 $u^-(s)$ 和 $u^+(s)$ 是 $p$ 阶多项式。面雅可比 $J_f(s)$ 被给定为 $r$ 阶多项式。数值通量法向分量 $\\hat{F}(s) = \\hat{\\mathbf{f}}\\cdot\\mathbf{n}$ 依赖于 $u^\\pm$ 和通过 $\\mathbf{n}(s)$ 体现的几何形状。对于一般性分析，建立被积函数总阶数的模型是标准的。让我们来分析 $\\mathcal{I}(s)$ 的阶数。\n\n被积函数可以写成 $\\mathcal{I}(s) = \\hat{F}(s) J_f(s)$，其中 $\\hat{F}(s)$ 是在面上计算的数值通量法向分量。$\\mathcal{I}(s)$ 的多项式阶数是其多项式因子的阶数之和。项 $\\hat{F}(s)$ 依赖于状态变量 $u^\\pm(s)$ 和几何项（如 $\\mathbf{n}(s)$）。一个稳健且通用的总被积函数阶数的工作模型是：\n$$\n\\text{阶数}(\\mathcal{I}) = (\\text{通量函数关于 } u \\text{ 的阶数}) \\times (\\text{解的多项式阶数 } p) + (\\text{几何因子的阶数})\n$$\n问题指定了等参映射（几何阶数与解的阶数 $p$ 匹配），但将面雅可比 $J_f(s)$ 表示为 $r$ 阶多项式。这表明几何复杂性由 $r$ 封装。通量项 $\\hat{F}$ 依赖于 $u^\\pm$（$p$ 阶），并可能依赖于其他作为 $s$ 的函数的几何因子。一个简化但标准的工作模型（与问题的措辞一致）是假设通量项 $\\hat{F}(s)$ 本身的阶数主要由解多项式驱动。那么，总被积函数的阶数就是通量项的阶数加上雅可比的阶数。\n-   对于线性通量函数（$\\mathbf{f}(u) \\propto u$），数值通量法向分量 $\\hat{F}(s)$ 将是一个多项式，其阶数由 $u^\\pm(s)$ 主导，即 $p$ 阶。\n-   对于二次通量函数（$f(u) \\propto u^2$），$\\hat{F}(s)$ 将是一个由 $(u^\\pm(s))^2$ 等项主导的多项式，即 $2p$ 阶。\n\n因此，我们可以为被积函数 $\\mathcal{I}(s) = \\hat{F}(s)J_f(s)$ 建立以下阶数模型：\n1.  **线性对流**：$\\text{阶数}(\\mathcal{I}_{\\text{线性}}) = \\text{阶数}(\\hat{F}) + \\text{阶数}(J_f) = p + r$。\n2.  **伯格斯方程**：$\\text{阶数}(\\mathcal{I}_{\\text{伯格斯}}) = \\text{阶数}(\\hat{F}) + \\text{阶数}(J_f) = 2p + r$。\n\n给定 $p=3$ 和 $r=3$。\n-   对于线性对流，$\\text{阶数}(\\mathcal{I}_{\\text{线性}}) = 3 + 3 = 6$。\n-   对于伯格斯方程，$\\text{阶数}(\\mathcal{I}_{\\text{伯格斯}}) = 2(3) + 3 = 9$。\n\n使用 $n$ 个点的GLL求积对最高为 $2n-3$ 阶的多项式是精确的。如果 $2n - 3 \\ge \\text{阶数}(\\mathcal{I})$，则可以避免混淆。\n\n**逐项分析**\n\n**A) 对于线性对流，当 $p=3$ 和 $r=3$ 时，面被积函数是 $p+r$ 阶多项式，因此使用 $n=p+1=4$ 个点的单元级GLL会产生混淆，因为 $p+r > 2n-3$；而使用 $n=5$ 个点的共享面求积可以消除混淆；在两侧使用相同的节点、权重和面度量可以保持界面上的离散守恒性。**\n-   **被积函数阶数与 $n=4$ 的混淆**：如上推导，线性对流的被积函数阶数为 $p+r = 3+3=6$。标准的求积选择是 $n=p+1=4$。对于 $n=4$ 个点，GLL对最高为 $2n-3 = 2(4)-3=5$ 阶的多项式是精确的。由于被积函数阶数为6，且 $6 > 5$，求积不精确，会引入混淆误差。该陈述中的推理是正确的。\n-   **使用 $n=5$ 的过积分**：如果我们使用 $n=5$ 个点，GLL对最高为 $2n-3 = 2(5)-3=7$ 阶的多项式是精确的。由于被积函数阶数为6，且 $6 \\le 7$，这个求积规则足以精确地积分该项，从而消除混淆。该陈述的这部分也是正确的。\n-   **守恒性**：当相邻单元使用各自不匹配的求积点和几何因子时，曲面界面上的离散守恒性就会丧失。为了恢复守恒性，共享面的两个单元必须使用一个公共（共享）的求积点、权重和几何因子（法向量、雅可比）集合。这确保了从两侧计算的数值通量是相同的（除了法向量的符号），从而在全球求和中可以抵消。这个原则被正确地陈述了。\n\n因此，陈述A完全正确。\n**结论：正确**\n\n**B) 对于伯格斯通量，当 $p=3$ 和 $r=3$ 时，使用 $n=5$ 个点的过积分足以通过精确积分面被积函数来消除混淆。**\n-   **被积函数阶数**：对于伯格斯方程（一个二次通量），被积函数的阶数为 $2p+r = 2(3)+3=9$。\n-   **使用 $n=5$ 的求积**：对于 $n=5$ 个点，GLL对最高为 $2n-3 = 2(5)-3=7$ 阶的多项式是精确的。\n-   **结论**：由于精确积分所需的阶数是9，而 $n=5$ 个点只提供到7阶的精确性，这种程度的过积分是不够的。混淆仍然会发生。该陈述是错误的。\n\n因此，陈述B不正确。\n**结论：不正确**\n\n**C) 对于伯格斯通量，当 $p=3$ 和 $r=3$ 时，一个使用 $n=6$ 个点的共享面求积可以消除混淆，因为 $2n-3$ 达到或超过了面被积函数的阶数；此外，通过 $L^2$ 投影将计算出的通量投射回 $p$ 阶面多项式空间，可以得到两个单元间的一个守恒的界面项。**\n-   **被积函数阶数与 $n=6$ 的混淆**：伯格斯通量的被积函数阶数为 $2p+r=9$。如果我们使用 $n=6$ 个点，GLL对最高为 $2n-3 = 2(6)-3=9$ 阶的多项式是精确的。由于被积函数阶数为9，而求积规则对9阶是精确的，这足以消除被积函数的混淆。陈述的第一部分是正确的。\n-   **守恒性与投影**：该陈述提出了一个涉及共享求积规则和投影的程序。正如在A的分析中确立的，使用“共享面求积”是确保界面项守恒的关键机制。将计算出的通量（在共享求积点上评估）投影回 $p$ 阶多项式空间的额外步骤是一种已知的去混淆和确保稳定性的技术（例如，在分裂形式的DG方法中）。这整个程序（用于守恒的共享规则，用于稳定性/去混淆的过积分和投影）是一种有效且守恒的方法。\n\n因此，陈述C是正确的。\n**结论：正确**\n\n**D) 因为高斯-洛巴托求积包含面的端点，所以单元级GLL积分在任何曲面上自动是守恒的，与通量的非线性和几何阶数无关；混淆不会损害守恒性。**\n-   这个陈述有根本性的缺陷。虽然参考区间端点 $s=\\pm 1$ 处的GLL节点对应于相容单元的相同物理顶点，但当面是弯曲的且每个单元使用自己的映射时，所有内部GLL节点在物理空间中并不会对齐。例如，在单元A的参考坐标中的点 $s_k$ 映射到曲面上的物理点与单元B的参考坐标中的点 $s_k$ 映射到的物理点不同。求积点、权重和几何因子（$J_f(s)$, $\\mathbf{n}(s)$）的这种不匹配正是破坏离散守恒性的原因。混淆进一步加剧了误差。守恒不是自动的。\n\n因此，陈述D不正确。\n**结论：不正确**\n\n**E) 将求积与每个单元自身的面参数化对齐，并在两侧使用不同的节点和权重，同时将 $n$ 增加到6，可以保证守恒性，而无需共享面求积或公共面度量。**\n-   这个陈述描述了非守恒的方法，并错误地声称它能保证守恒性。在“两侧使用不同的节点和权重”正是导致守恒性误差的问题的定义。增加求积点的数量（$n=6$）会使每一侧的积分近似更准确（减少混淆误差），这可能会减小守恒误差的大小，但并不能消除它。要保证守恒性，来自界面两侧的离散和必须完全抵消，这需要一个共享的、公共的求积规则。\n\n因此，陈述E不正确。\n**结论：不正确**",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}