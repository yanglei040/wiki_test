{
    "hands_on_practices": [
        {
            "introduction": "在应用谱递延修正（SDC）迭代之前，我们必须首先理解它旨在解决的基本问题：配置问题（collocation problem）。本练习 () 将指导您从第一性原理出发，针对一个简单的测试方程构建此问题。您将推导离散化积分的求积矩阵 $Q$，并了解它如何导出一个关于配置节点解值的线性方程组。掌握这一过程对于理解SDC方法的构建方式及其属性（如稳定性）的分析至关重要。",
            "id": "3416861",
            "problem": "考虑标量初值问题 $y^{\\prime}(t)=\\lambda\\,y(t)$，在长度为 $\\Delta t0$ 的单个步长 $[t_{n},t_{n+1}]$ 上，已知值 $y_{n}=y(t_{n})$ 和 $z=\\lambda\\,\\Delta t$。设 $m$ 个配置点 $c_1, \\dots, c_m$ 满足 $0\\le c_1  \\dots  c_m \\le 1$。",
            "solution": "该问题是有效的，因为它在常微分方程数值方法的理论中有科学依据，是适定的、客观的且内部一致的。\n\n该问题包含两部分。第一部分是推导控制配置方法的线性系统，第二部分是针对3点Lobatto节点的具体计算。\n\n**第1部分：配置系统的推导**\n\n我们从第 $i$ 个阶段的残差定义开始：\n$$\nr_{i}(y) = y_{i} - y_{n} - \\int_{t_{n}}^{\\tau_{i}} \\lambda y(\\theta) d\\theta\n$$\n其中 $\\tau_i = t_n + c_i \\Delta t$。配置假设指出，在区间 $[t_n, t_{n+1}]$ 内的解 $y(\\theta)$ 由一个唯一的、次数最多为 $m-1$ 的多项式来近似，该多项式在阶段时间 $\\{\\tau_j\\}_{j=1}^m$ 对阶段值 $\\{y_j\\}_{j=1}^m$ 进行插值。这个多项式，我们称之为 $p(\\theta)$，满足 $p(\\tau_j) = y_j$（对于 $j=1, \\dots, m$）。我们可以使用与时间节点 $\\{\\tau_j\\}_{j=1}^m$ 相关的拉格朗日基多项式 $\\{\\mathcal{L}_j(\\theta)\\}_{j=1}^m$ 来表示 $p(\\theta)$：\n$$\ny(\\theta) \\approx p(\\theta) = \\sum_{j=1}^{m} y_{j} \\mathcal{L}_{j}(\\theta)\n$$\n将这个多项式近似代入残差表达式的积分中，得到：\n$$\n\\int_{t_{n}}^{\\tau_{i}} \\lambda y(\\theta) d\\theta \\approx \\int_{t_{n}}^{\\tau_{i}} \\lambda \\left( \\sum_{j=1}^{m} y_{j} \\mathcal{L}_{j}(\\theta) \\right) d\\theta = \\lambda \\sum_{j=1}^{m} y_{j} \\int_{t_{n}}^{\\tau_{i}} \\mathcal{L}_{j}(\\theta) d\\theta\n$$\n为了简化积分，我们使用变换 $\\theta = t_n + s \\Delta t$ 进行变量代换，从 $\\theta \\in [t_n, t_{n+1}]$ 换到 $s \\in [0, 1]$。这意味着 $d\\theta = \\Delta t ds$。积分上限 $\\theta = \\tau_i = t_n + c_i \\Delta t$ 对应于 $s = c_i$。节点 $\\{\\tau_k\\}$ 上的拉格朗日多项式 $\\mathcal{L}_j(\\theta)$ 变为节点 $\\{c_k\\}$ 上的拉格朗日多项式 $\\ell_j(s)$：$\\ell_j(s) = \\mathcal{L}_j(t_n + s \\Delta t)$。积分变为：\n$$\n\\lambda \\sum_{j=1}^{m} y_{j} \\int_{0}^{c_{i}} \\ell_{j}(s) (\\Delta t ds) = (\\lambda \\Delta t) \\sum_{j=1}^{m} y_{j} \\int_{0}^{c_{i}} \\ell_{j}(s) ds\n$$\n使用给定的定义 $z = \\lambda \\Delta t$ 和 $Q_{ij} = \\int_{0}^{c_i} \\ell_j(s) ds$，该表达式简化为：\n$$\nz \\sum_{j=1}^{m} Q_{ij} y_{j}\n$$\n这是矩阵-向量乘积 $zQy$ 的第 $i$ 个分量。将其代回残差定义，我们得到残差向量的分量表达式：\n$$\nr_i(y) = y_i - y_n - (zQy)_i\n$$\n其向量形式为：\n$$\nr(y) = y - y_n \\mathbf{1} - zQy\n$$\n其中 $\\mathbf{1}$ 是所有元素均为1的向量。配置条件要求在所有阶段时间点残差为零，即 $r(y) = 0$。这得到：\n$$\ny - y_n \\mathbf{1} - zQy = 0\n$$\n整理各项，我们得到所需的线性系统：\n$$\n(I - zQ)y = y_n \\mathbf{1}\n$$\n问题的第一部分到此结束。\n\n**第2部分：特化到 $m=3$ 的 Lobatto 节点**\n\n给定 $m=3$ 和 Lobatto 节点 $c_1=0$、$c_2=\\frac{1}{2}$ 和 $c_3=1$。\n\n首先，我们构造节点 $\\{0, \\frac{1}{2}, 1\\}$ 上的拉格朗日基多项式 $\\ell_j(s)$：\n$$\n\\ell_1(s) = \\frac{(s-c_2)(s-c_3)}{(c_1-c_2)(c_1-c_3)} = \\frac{(s-\\frac{1}{2})(s-1)}{(0-\\frac{1}{2})(0-1)} = \\frac{s^2 - \\frac{3}{2}s + \\frac{1}{2}}{\\frac{1}{2}} = 2s^2 - 3s + 1\n$$\n$$\n\\ell_2(s) = \\frac{(s-c_1)(s-c_3)}{(c_2-c_1)(c_2-c_3)} = \\frac{(s-0)(s-1)}{(\\frac{1}{2}-0)(\\frac{1}{2}-1)} = \\frac{s^2 - s}{-\\frac{1}{4}} = -4s^2 + 4s\n$$\n$$\n\\ell_3(s) = \\frac{(s-c_1)(s-c_2)}{(c_3-c_1)(c_3-c_2)} = \\frac{(s-0)(s-\\frac{1}{2})}{(1-0)(1-\\frac{1}{2})} = \\frac{s^2 - \\frac{1}{2}s}{\\frac{1}{2}} = 2s^2 - s\n$$\n\n接下来，我们计算求积矩阵的元素 $Q_{ij} = \\int_0^{c_i} \\ell_j(s) ds$。\n\n对于 $i=1$，$c_1=0$。积分区间长度为零，因此 $Q$ 的第一行全为零：\n$Q_{11} = Q_{12} = Q_{13} = 0$。\n\n对于 $i=2$，$c_2=\\frac{1}{2}$：\n$$\nQ_{21} = \\int_0^{1/2} (2s^2 - 3s + 1) ds = \\left[ \\frac{2}{3}s^3 - \\frac{3}{2}s^2 + s \\right]_0^{1/2} = \\frac{2}{3}\\left(\\frac{1}{8}\\right) - \\frac{3}{2}\\left(\\frac{1}{4}\\right) + \\frac{1}{2} = \\frac{1}{12} - \\frac{3}{8} + \\frac{1}{2} = \\frac{2-9+12}{24} = \\frac{5}{24}\n$$\n$$\nQ_{22} = \\int_0^{1/2} (-4s^2 + 4s) ds = \\left[ -\\frac{4}{3}s^3 + 2s^2 \\right]_0^{1/2} = -\\frac{4}{3}\\left(\\frac{1}{8}\\right) + 2\\left(\\frac{1}{4}\\right) = -\\frac{1}{6} + \\frac{1}{2} = \\frac{2}{6} = \\frac{1}{3}\n$$\n$$\nQ_{23} = \\int_0^{1/2} (2s^2 - s) ds = \\left[ \\frac{2}{3}s^3 - \\frac{1}{2}s^2 \\right]_0^{1/2} = \\frac{2}{3}\\left(\\frac{1}{8}\\right) - \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{12} - \\frac{1}{8} = \\frac{2-3}{24} = -\\frac{1}{24}\n$$\n\n对于 $i=3$，$c_3=1$：\n$$\nQ_{31} = \\int_0^1 (2s^2 - 3s + 1) ds = \\left[ \\frac{2}{3}s^3 - \\frac{3}{2}s^2 + s \\right]_0^1 = \\frac{2}{3} - \\frac{3}{2} + 1 = \\frac{4-9+6}{6} = \\frac{1}{6}\n$$\n$$\nQ_{32} = \\int_0^1 (-4s^2 + 4s) ds = \\left[ -\\frac{4}{3}s^3 + 2s^2 \\right]_0^1 = -\\frac{4}{3} + 2 = \\frac{2}{3}\n$$\n$$\nQ_{33} = \\int_0^1 (2s^2 - s) ds = \\left[ \\frac{2}{3}s^3 - \\frac{1}{2}s^2 \\right]_0^1 = \\frac{2}{3} - \\frac{1}{2} = \\frac{1}{6}\n$$\n\n组合成矩阵 $Q$：\n$$\nQ = \\begin{pmatrix} 0  0  0 \\\\ \\frac{5}{24}  \\frac{1}{3}  -\\frac{1}{24} \\\\ \\frac{1}{6}  \\frac{2}{3}  \\frac{1}{6} \\end{pmatrix}\n$$\n\n最后，我们计算配置矩阵 $I - zQ$ 的行列式：\n$$\nI - zQ = \\begin{pmatrix} 1  0  0 \\\\ -\\frac{5}{24}z  1 - \\frac{1}{3}z  \\frac{1}{24}z \\\\ -\\frac{1}{6}z  -\\frac{2}{3}z  1 - \\frac{1}{6}z \\end{pmatrix}\n$$\n行列式可以通过沿第一行的代数余子式展开来计算：\n$$\n\\det(I - zQ) = 1 \\cdot \\det \\begin{pmatrix} 1 - \\frac{1}{3}z  \\frac{1}{24}z \\\\ -\\frac{2}{3}z  1 - \\frac{1}{6}z \\end{pmatrix} - 0 + 0\n$$\n$$\n\\det(I - zQ) = \\left(1 - \\frac{1}{3}z\\right)\\left(1 - \\frac{1}{6}z\\right) - \\left(\\frac{1}{24}z\\right)\\left(-\\frac{2}{3}z\\right)\n$$\n$$\n\\det(I - zQ) = 1 - \\frac{1}{6}z - \\frac{1}{3}z + \\frac{1}{18}z^2 + \\frac{2}{72}z^2\n$$\n$$\n\\det(I - zQ) = 1 - \\left(\\frac{1}{6} + \\frac{2}{6}\\right)z + \\left(\\frac{1}{18} + \\frac{1}{36}\\right)z^2\n$$\n$$\n\\det(I - zQ) = 1 - \\frac{3}{6}z + \\left(\\frac{2}{36} + \\frac{1}{36}\\right)z^2\n$$\n$$\n\\det(I - zQ) = 1 - \\frac{1}{2}z + \\frac{3}{36}z^2 = 1 - \\frac{1}{2}z + \\frac{1}{12}z^2\n$$\n得到的关于 $z$ 的多项式是 $1 - \\frac{1}{2}z + \\frac{1}{12}z^2$。",
            "answer": "$$\\boxed{1 - \\frac{1}{2}z + \\frac{1}{12}z^2}$$"
        },
        {
            "introduction": "SDC方法的一个关键理论特性是，在适当条件下，其扫描算子是一个收缩映射。这个特性不仅仅是一个抽象概念，它对算法的稳健性有着深远的实际意义。本练习 () 通过分析一种使用混合精度算法实现的SDC方法，来探讨其带来的影响，这是一种在现代硬件上提高性能的常用策略。您将推导经过多次扫描后舍入误差累积的严格上界。这项动手推导将加深您对收缩映射抽象理论与有限精度误差下数值算法具体行为之间联系的理解。",
            "id": "3416879",
            "problem": "考虑在长度为 $h0$ 的单个时间步 $[t_n,t_{n+1}]$ 上的常微分方程 $y'(t)=f(y(t))$ 的初值问题，其中 $f:\\mathbb{R}\\to\\mathbb{R}$ 是 Lipschitz 连续的，Lipschitz 常数为 $L0$。令 $M\\in\\mathbb{N}$ 表示用于在 $[t_n,t_{n+1}]$ 上定义配置问题的配置点数量，并令相应的谱延迟修正 (SDC) 迭代定义一个阶段向量序列 $\\{Y^{(m)}\\}_{m\\ge 0}\\in\\mathbb{R}^M$，该序列旨在收敛到配置解 $Y^{\\star}\\in\\mathbb{R}^M$。\n\n假设以下标准事实成立，这些事实对于足够小的 $hL$ 和常用的 SDC 预条件子是成立的：存在一个相容的向量范数 $\\|\\cdot\\|$ 和一个收缩常数 $\\sigma\\in(0,1)$，使得一次精确的 SDC 扫描（视为一个映射 $\\mathcal{S}:\\mathbb{R}^M\\to\\mathbb{R}^M$）对于所有 $U,V\\in\\mathbb{R}^M$ 满足收缩性质 $\\|\\mathcal{S}(U)-\\mathcal{S}(V)\\|\\le \\sigma \\|U-V\\|$，并且 $\\mathcal{S}(Y^{\\star})=Y^{\\star}$。此外，假设对于某个有限的 $B0$，对所有 $m\\ge 0$ 都存在一个先验界 $\\|Y^{(m)}\\|\\le B$。\n\n设计一个混合精度 SDC 扫描，该扫描计算：\n- 在单位舍入误差为 $u_{\\ell}\\in(0,1)$ 的低精度算術中，显式构造配置残差（即，通过函数求值和求积法构建用于修正的右端项的向量），以及\n- 在单位舍入误差为 $u_{h}\\in(0,1)$ 的高精度算術中，求解线性修正方程和所有向量更新，\n\n在标准浮点模型下：每次基本算术运算 $\\circ\\in\\{+,-,\\times,\\div\\}$ 都满足 $\\mathrm{fl}(a\\circ b)=(a\\circ b)(1+\\delta)$，其中 $|\\delta|\\le u$，$u$ 是执行该运算所用算术的相应单位舍入误差。\n\n假设每次扫描中，低精度残差构造引入一个加性扰动向量 $r_{\\ell}^{(m)}$，其范数界为 $\\|r_{\\ell}^{(m)}\\|\\le \\alpha\\,u_{\\ell}$；高精度修正求解和向量更新引入一个加性扰动向量 $r_{h}^{(m)}$，其范数界为 $\\|r_{h}^{(m)}\\|\\le \\beta\\,u_{h}$，其中常数 $\\alpha,\\beta\\ge 0$ 仅依赖于 $h$、$L$、求积和预条件子矩阵以及界 $B$，而不依赖于 $m$ 或精度参数 $u_{\\ell}, u_h$。假设 $\\{r_{\\ell}^{(m)}\\}$ 和 $\\{r_{h}^{(m)}\\}$ 在此意义上是对抗性的但有界。\n\n设混合精度 SDC 扫描从精确的初始猜测 $Y^{(0)}=Y^{\\star}$ 开始应用 $k\\in\\mathbb{N}$ 次，因此所有误差都源于有限精度。仅使用精确 SDC 扫描的收缩性质以及所述的浮点模型和 $\\|r_{\\ell}^{(m)}\\|$ 与 $\\|r_{h}^{(m)}\\|$ 的界，推导出一个关于 $k$ 次扫描后总舍入误差范数 $\\|Y^{(k)}-Y^{\\star}\\|$ 的严格上界，该上界应为一个用 $\\sigma$、$k$、$\\alpha$、$\\beta$、$u_{\\ell}$ 和 $u_{h}$ 表示的闭式解析表达式。你的最终答案必须是单个解析表达式。不要引入任何未声明的假设。如果使用几何级数，请根据给定数据证明其收敛性。请精确表达你的答案，不需要进行数值舍入。",
            "solution": "该问题要求推导混合精度谱延迟修正(SDC)方法在进行 $k$ 次扫描后的总舍入误差的严格上界。分析将基于所提供的精确 SDC 扫描的收缩性质和给定的浮点扰动模型。\n\n令 $\\tilde{Y}^{(m)} \\in \\mathbb{R}^M$ 表示混合精度 SDC 算法经过 $m$ 次扫描后计算得到的阶段向量。精确的配置解表示为 $Y^{\\star} \\in \\mathbb{R}^M$。$m$ 次扫描后的误差向量定义为 $e^{(m)} = \\tilde{Y}^{(m)} - Y^{\\star}$。问题陈述迭代从精确的初始猜测开始，因此我们有 $\\tilde{Y}^{(0)} = Y^{\\star}$，这意味着初始误差为零：$e^{(0)} = 0$。我们的目标是找到给定扫描次数 $k \\in \\mathbb{N}$ 后 $\\|e^{(k)}\\|$ 的一个上界。\n\n一次精确的 SDC 扫描由一个映射 $\\mathcal{S}: \\mathbb{R}^M \\to \\mathbb{R}^M$ 表示。问题描述了一个混合精度实现，其中每次扫描都受到两个舍入误差源的影响：来自低精度残差构造的加性扰动 $r_{\\ell}^{(m)}$ 和来自高精度修正求解和向量更新的加性扰动 $r_{h}^{(m)}$。我们可以将对当前近似 $\\tilde{Y}^{(m)}$ 应用一次扫描的计算结果建模为精确扫描算子的结果加上该次扫描的总扰动项。令从 $\\tilde{Y}^{(m)}$ 计算 $\\tilde{Y}^{(m+1)}$ 的扫描的总加性扰动为 $r^{(m)} = r_{\\ell}^{(m)} + r_{h}^{(m)}$。因此，浮点迭代由以下递推关系建模：\n$$\n\\tilde{Y}^{(m+1)} = \\mathcal{S}(\\tilde{Y}^{(m)}) + r^{(m)} \\quad \\text{对于 } m = 0, 1, \\dots, k-1\n$$\n\n我们现在可以推导误差向量范数 $\\|e^{(m)}\\|$ 的递推关系。根据定义，$e^{(m+1)} = \\tilde{Y}^{(m+1)} - Y^{\\star}$。代入混合精度扫描的模型得到：\n$$\ne^{(m+1)} = \\left( \\mathcal{S}(\\tilde{Y}^{(m)}) + r^{(m)} \\right) - Y^{\\star}\n$$\n问题陈述 $Y^{\\star}$ 是精确扫描算子 $\\mathcal{S}$ 的一个不动点，这意味着 $\\mathcal{S}(Y^{\\star}) = Y^{\\star}$。我们可以将此代入方程：\n$$\ne^{(m+1)} = \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) + r^{(m)}\n$$\n现在，我们对两边取向量范数并应用三角不等式：\n$$\n\\|e^{(m+1)}\\| = \\| \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) + r^{(m)} \\| \\le \\| \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) \\| + \\|r^{(m)}\\|\n$$\n我们已知 $\\mathcal{S}$ 是一个收缩常数为 $\\sigma \\in (0,1)$ 的收缩，意味着对于任何向量 $U,V \\in \\mathbb{R}^M$，都有 $\\|\\mathcal{S}(U) - \\mathcal{S}(V)\\| \\le \\sigma \\|U - V\\|$。将此性质应用于 $U = \\tilde{Y}^{(m)}$ 和 $V = Y^{\\star}$：\n$$\n\\| \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) \\| \\le \\sigma \\| \\tilde{Y}^{(m)} - Y^{\\star} \\| = \\sigma \\|e^{(m)}\\|\n$$\n将此代入 $\\|e^{(m+1)}\\|$ 的不等式中，得到以下关于误差范数的递归不等式：\n$$\n\\|e^{(m+1)}\\| \\le \\sigma \\|e^{(m)}\\| + \\|r^{(m)}\\|\n$$\n接下来，我们需要界定扰动项 $\\|r^{(m)}\\|$。我们已知对于每次扫描 $m$，低精度扰动的范数由 $\\|r_{\\ell}^{(m)}\\| \\le \\alpha u_{\\ell}$ 界定，高精度扰动的范数由 $\\|r_{h}^{(m)}\\| \\le \\beta u_{h}$ 界定。对 $\\|r^{(m)}\\| = \\|r_{\\ell}^{(m)} + r_{h}^{(m)}\\|$ 使用三角不等式，我们得到：\n$$\n\\|r^{(m)}\\| \\le \\|r_{\\ell}^{(m)}\\| + \\|r_{h}^{(m)}\\| \\le \\alpha u_{\\ell} + \\beta u_{h}\n$$\n由于 $\\alpha$、$\\beta$、$u_{\\ell}$ 和 $u_{h}$ 是常数，我们可以为每次扫描的扰动范数定义一个常数上界 $\\Delta = \\alpha u_{\\ell} + \\beta u_{h}$。问题陈述中扰动是对抗性的，这意味着我们必须使用这个最坏情况的界。误差范数的递推关系变为：\n$$\n\\|e^{(m+1)}\\| \\le \\sigma \\|e^{(m)}\\| + \\Delta\n$$\n我们可以通过从初始条件 $\\|e^{(0)}\\| = 0$ 开始展开来解这个关于 $\\|e^{(k)}\\|$ 的线性递推关系：\n当 $m=0$ 时：\n$$\n\\|e^{(1)}\\| \\le \\sigma \\|e^{(0)}\\| + \\Delta = \\sigma(0) + \\Delta = \\Delta\n$$\n当 $m=1$ 时：\n$$\n\\|e^{(2)}\\| \\le \\sigma \\|e^{(1)}\\| + \\Delta \\le \\sigma(\\Delta) + \\Delta = \\Delta(1 + \\sigma)\n$$\n当 $m=2$ 时：\n$$\n\\|e^{(3)}\\| \\le \\sigma \\|e^{(2)}\\| + \\Delta \\le \\sigma(\\Delta(1+\\sigma)) + \\Delta = \\Delta(1 + \\sigma + \\sigma^2)\n$$\n通过归纳法，经过 $k$ 次扫描后（即，对于从 $m=0$ 迭代到 $m=k-1$ 产生的误差 $e^{(k)}$），其界为：\n$$\n\\|e^{(k)}\\| \\le \\Delta \\sum_{j=0}^{k-1} \\sigma^j\n$$\n该和是一个有限几何级数。有限几何级数的求和公式是 $\\sum_{j=0}^{n-1} r^j = \\frac{1-r^n}{1-r}$，它对任何 $r \\ne 1$ 都有效。在我们的例子中，公比是 $\\sigma$，并且我们已知 $\\sigma \\in (0,1)$，这确保了 $\\sigma \\ne 1$。因此，我们可以写出：\n$$\n\\sum_{j=0}^{k-1} \\sigma^j = \\frac{1 - \\sigma^k}{1 - \\sigma}\n$$\n将此代回 $\\|e^{(k)}\\|$ 的界中，并用其定义替换 $\\Delta$，便得到了 $k$ 次扫描后总舍入误差的最终上界：\n$$\n\\|Y^{(k)} - Y^{\\star}\\| = \\|e^{(k)}\\| \\le (\\alpha u_{\\ell} + \\beta u_{h}) \\frac{1 - \\sigma^k}{1 - \\sigma}\n$$\n这个表达式是仅根据问题陈述中提供的性质和界推導出的严格上界。",
            "answer": "$$\n\\boxed{(\\alpha u_{\\ell} + \\beta u_{h}) \\frac{1 - \\sigma^k}{1 - \\sigma}}\n$$"
        },
        {
            "introduction": "在理解了SDC的基础知识后，我们现在可以将其作为一个强大的工具来解决更复杂的科学计算问题。这个综合性练习 () 将SDC应用于求解偏微分方程（PDE）的时间周期解，这是流体力学和非线性振动等领域的常见任务。您将在“打靶法”（shooting method）框架内实现一个基于SDC的时间步进器。这涉及到使用SDC积分器来数值构造系统的庞加莱映射（monodromy matrix），其性质决定了周期解的存在性和稳定性。这个综合性问题融合了数值线性代数、ODE/PDE理论和高级时间积分等概念，展示了SDC如何作为复杂数值模拟的高阶、稳健引擎。",
            "id": "3416865",
            "problem": "考虑在周期性空间域 $x \\in [0,2\\pi]$ 上，具有周期为 $T$ 的时间依赖性的线性抛物型偏微分方程 (PDE)，由下式给出：\n$$\nu_t(x,t) = u_{xx}(x,t) + a \\cos(\\omega t)\\,u(x,t) + f(x,t),\n$$\n其中 $a \\in \\mathbb{R}$ 是一个常数振幅，$\\omega = \\frac{2\\pi}{T}$ 是角频率，$f(x,t)$ 是一个在时间上 $T$ 周期的指定强迫项。假设解在一个具有 $N$ 个模态的截断傅里叶余弦基（偶延拓）中表示，\n$$\nu(x,t) \\approx \\sum_{k=1}^{N} y_k(t)\\,\\cos(k x),\n$$\n使得截断的谱系数 $y_k(t)$ 满足一个常微分方程组 (ODE)。傅里叶拉普拉斯算子产生 $u_{xx} \\mapsto -k^2 y_k$。设强迫项是按模态指定的，并且与解具有相同的时间周期性，具体为\n$$\nf(x,t) = \\sum_{k=1}^N g_k \\sin(\\omega t)\\,\\cos(k x),\n$$\n对于给定的振幅 $g_k$。\n\n1) 推导谱系数向量 $y(t) \\in \\mathbb{R}^N$ 的 $N$ 维 ODE 系统，并将其写成仿射线性形式\n$$\ny'(t) = A(t)\\,y(t) + b(t),\n$$\n其中 $A(t)$ 是一个时间周期矩阵，$b(t)$ 是一个时间周期向量。请用问题中的参数明确地表示 $A(t)$ 和 $b(t)$。\n\n2) 周期为 $T$ 的时间周期解可以通过单值（单周期）映射 $\\Phi_T$ 的一个不动点来刻画，该映射定义为 $y(T) = \\Phi_T(y(0))$。对于该仿射线性系统，存在一个矩阵 $M$（线性单值矩阵）和一个向量 $d$，使得\n$$\n\\Phi_T(y_0) = M\\,y_0 + d.\n$$\n从第一性原理出发解释为什么不动点条件 $y_{\\star} = \\Phi_T(y_{\\star})$ 等价于线性系统\n$$\n(I - M)\\,y_{\\star} = d.\n$$\n将 Floquet 乘子定义为 $M$ 的特征值，并解释为什么谱半径 $\\rho(M)$ 在不动点 $y_{\\star}$ 存在时，控制着 Picard 不动点迭代 $y^{(n+1)} = \\Phi_T(y^{(n)})$ 朝向 $y_{\\star}$ 的线性收敛。\n\n3) 如下所述，构建一个在一个完整周期 $[0,T]$ 上的谱延迟修正 (SDC) 时间积分方法。使用 $K$ 个 Chebyshev–Gauss–Lobatto 节点 $0 = t_0  t_1  \\cdots  t_{K-1} = T$，这些节点由 $[0,1]$ 上的 Chebyshev–Lobatto 点通过 $t_j = T\\,c_j$ 映射得到，其中 $c_j = \\frac{1}{2}\\bigl(1 - \\cos(\\frac{\\pi j}{K-1})\\bigr)$。设 $\\{\\ell_j(s)\\}_{j=0}^{K-1}$ 表示 $[0,1]$ 上的相关 Lagrange 基多项式。定义子区间求积权重为\n$$\nS_{m,j} = T \\int_{c_{m-1}}^{c_m} \\ell_j(s)\\,ds,\\quad m=1,\\dots,K-1,\\;\\; j=0,\\dots,K-1.\n$$\n从一个通过在节点上进行单次后向 Euler 预测得到的初始猜测开始，对线性右端项 $F(t,y) = A(t)\\,y + b(t)$ 应用 $S$ 次基于全隐式后向 Euler 基方法的 SDC 修正扫描。证明从节点 $m-1$ 到 $m$ 的一次 SDC 修正扫描通过求解以下线性系统来更新 $y_m$：\n$$\n\\bigl(I - \\Delta t_m\\,A(t_m)\\bigr)\\,y_m^{k+1}\n=\ny_{m-1}^{k+1}\n- \\Delta t_m\\,A(t_m)\\,y_m^{k}\n+ \\sum_{j=0}^{K-1} S_{m,j}\\,F(t_j, y_j^{k}),\n$$\n对于 $m=1,\\dots,K-1$，其中 $\\Delta t_m = t_m - t_{m-1}$，$k$ 是扫描索引。解释为什么这个公式可以通过对配置方程加上和减去后向 Euler 亏格来直接得到。\n\n4) 实现一个基于 SDC 的打靶法程序来数值构造单值映射。具体来说：\n- 对于给定的 $N$、$K$ 和 $S$，通过将 SDC 积分器应用于齐次系统 $y' = A(t)\\,y$ 一个周期，并使用 $\\mathbb{R}^N$ 中的标准基向量作为 $N$ 个线性无关的初始条件，来构造 $N\\times N$ 的单值矩阵 $M$。\n- 通过将相同的 SDC 积分器应用于从零向量开始的非齐次系统，来构造仿射项 $d$。\n\n然后：\n- 使用直接线性求解器求解 $(I - M)\\,y_{\\star} = d$，以得到时间周期初始向量 $y_{\\star}$。\n- 计算残差范数 $\\| \\Phi_T(y_{\\star}) - y_{\\star} \\|_2$，其中 $\\Phi_T$ 通过相同的 SDC 积分器进行评估。\n- 计算 $M$ 的特征值作为 Floquet 乘子，并报告它们的最大模 $\\rho(M)$。\n\n角度必须以弧度处理。不需要物理单位。\n\n测试套件。您的程序必须运行以下三个测试用例，并将输出聚合到单行中。在每个测试中，强迫项振幅为 $g_k = \\gamma/k$ 或 $g_k = \\gamma/k^2$（根据指定），其中 $k=1,\\dots,N$：\n- 测试 1 (一般情况): $N=5$, $K=5$, $S=3$, $T=1.0$, $a=1.0$, $\\omega = 2\\pi/T$, $g_k = 1/k^2$。\n- 测试 2 (更短的周期，更强的参数系数): $N=4$, $K=4$, $S=2$, $T=0.7$, $a=3.0$, $\\omega = 2\\pi/T$, $g_k = 0.5/k$。\n- 测试 3 (更长的周期，一个周期内更强的扩散): $N=3$, $K=6$, $S=4$, $T=2.0$, $a=0.5$, $\\omega = 2\\pi/T$, $g_k = 1.0/k$。\n\n对于每个测试，按此顺序输出以下三个量：\n- 谱半径 $\\rho(M)$，浮点数。\n- 周期性残差范数 $\\| \\Phi_T(y_{\\star}) - y_{\\star} \\|_2$，浮点数。\n- 一个布尔值，指示收缩条件 $\\rho(M)  1$ 是否成立。\n\n最终输出格式。您的程序应生成单行输出，其中包含三个测试的九个结果，按顺序串联在一个逗号分隔的 Python 风格列表中，例如，\"[rho1,res1,contract1,rho2,res2,contract2,rho3,res3,contract3]\"。角度必须是弧度，不应打印任何额外文本。",
            "solution": "该问题要求推导和数值求解一个常微分方程组 (ODE)，该方程组源于一个带时间周期系数的线性抛物型偏微分方程 (PDE) 的谱离散化。解决方案涉及应用傅里叶分析、周期系数线性 ODE 理论 (Floquet 理论) 以及高级时间积分数值方法，特别是谱延迟修正 (SDC) 的概念。\n\n### 第1部分：ODE 系统的推导\n\n控制 PDE 如下：\n$$\nu_t(x,t) = u_{xx}(x,t) + a \\cos(\\omega t)\\,u(x,t) + f(x,t)\n$$\n其中 $x \\in [0, 2\\pi]$ (周期性)，时间周期为 $T$，$\\omega = 2\\pi/T$。\n\n解 $u(x,t)$ 和强迫项 $f(x,t)$ 由具有 $N$ 个模态的截断傅里葉余弦级数表示：\n$$\nu(x,t) \\approx \\sum_{k=1}^{N} y_k(t)\\,\\cos(k x)\n$$\n$$\nf(x,t) = \\sum_{k=1}^{N} g_k \\sin(\\omega t)\\,\\cos(k x)\n$$\n$u(x,t)$ 对 $t$ 和 $x$ 的偏导数可以通过对级数逐项求导得到：\n$$\nu_t(x,t) \\approx \\sum_{k=1}^{N} y'_k(t)\\,\\cos(k x)\n$$\n$$\nu_x(x,t) \\approx \\sum_{k=1}^{N} -k\\,y_k(t)\\,\\sin(k x)\n$$\n$$\nu_{xx}(x,t) \\approx \\sum_{k=1}^{N} -k^2\\,y_k(t)\\,\\cos(k x)\n$$\n将这些表达式代入 PDE，我们得到：\n$$\n\\sum_{k=1}^{N} y'_k(t)\\,\\cos(k x) = \\sum_{k=1}^{N} -k^2 y_k(t)\\,\\cos(k x) + a \\cos(\\omega t) \\sum_{k=1}^{N} y_k(t)\\,\\cos(k x) + \\sum_{k=1}^{N} g_k \\sin(\\omega t)\\,\\cos(k x)\n$$\n可以通过收集与每个基函数 $\\cos(k x)$ 相关的项来重新整理此方程：\n$$\n\\sum_{k=1}^{N} \\left[ y'_k(t) - \\left(-k^2 + a \\cos(\\omega t)\\right) y_k(t) - g_k \\sin(\\omega t) \\right] \\cos(k x) = 0\n$$\n由于基函数 $\\{\\cos(k x)\\}_{k=1}^N$ 在区间 $[0, 2\\pi]$ 上的正交性，每个 $\\cos(k x)$ 的系数必须为零。此投影产生一个包含 $N$ 个解耦的一阶线性 ODE 的系统，每个谱系数 $y_k(t)$ 对应一个方程：\n$$\ny'_k(t) = (-k^2 + a \\cos(\\omega t)) y_k(t) + g_k \\sin(\\omega t), \\quad k=1, \\dots, N\n$$\n我们可以将此系统写成所需的仿射线性形式 $y'(t) = A(t)\\,y(t) + b(t)$，其中 $y(t) = [y_1(t), y_2(t), \\dots, y_N(t)]^T \\in \\mathbb{R}^N$。矩阵 $A(t)$ 和向量 $b(t)$ 可确定为：\n$$\nA(t) = \\text{diag}\\left(-1^2 + a \\cos(\\omega t), -2^2 + a \\cos(\\omega t), \\dots, -N^2 + a \\cos(\\omega t)\\right)\n$$\n$$\nb(t) = \\begin{pmatrix} g_1 \\sin(\\omega t) \\\\ g_2 \\sin(\\omega t) \\\\ \\vdots \\\\ g_N \\sin(\\omega t) \\end{pmatrix}\n$$\n$A(t)$ 是一个周期为 $T$ 的对角时间周期矩阵，$b(t)$ 是一个时间周期向量，周期也为 $T$。\n\n### 第2部分：不动点条件与收敛性\n\n初始值问题 $y'(t) = A(t)\\,y(t) + b(t)$ 在 $y(0) = y_0$ 条件下的解，可以使用常数变易法公式正式写出。设 $\\Psi(t,s)$ 为齐次系统 $y' = A(t)y$ 的状态转移矩阵（或基本矩阵），它满足 $\\frac{d}{dt}\\Psi(t,s) = A(t)\\Psi(t,s)$ 和 $\\Psi(s,s) = I$。在时间 $t$ 的解为：\n$$\ny(t) = \\Psi(t,0)y_0 + \\int_0^t \\Psi(t,s) b(s) ds\n$$\n单值映射 $\\Phi_T$ 将解推进一个周期，$y(T) = \\Phi_T(y(0))$。在 $t=T$ 处评估解可得：\n$$\ny(T) = \\Psi(T,0)y_0 + \\int_0^T \\Psi(T,s) b(s) ds\n$$\n通过将其与给定的仿射形式 $\\Phi_T(y_0) = M y_0 + d$ 进行比较，我们确定线性单值矩阵 $M = \\Psi(T,0)$ 和仿射向量 $d = \\int_0^T \\Psi(T,s) b(s) ds$。\n\n一个解 $y(t)$ 是周期为 $T$ 的周期解，当且仅当 $y(T) = y(0)$。设 $y_\\star = y(0)$ 是产生这样一个周期解的初始条件。这个条件 $y(T) = y(0)$ 转化为 $y_\\star = \\Phi_T(y_\\star)$，这意味着 $y_\\star$ 必须是单值映射的不动点。使用该映射的仿射形式，我们得到：\n$$\ny_\\star = M y_\\star + d\n$$\n重新整理此方程可得到关于未知初始条件 $y_\\star$ 的一个线性系统：\n$$\nI y_\\star - M y_\\star = d \\implies (I - M) y_\\star = d\n$$\n唯一的周期解存在当且仅当矩阵 $(I - M)$ 是可逆的，这等价于 $1$ 不是 $M$ 的特征值的条件。\n\n用于寻找 $y_\\star$ 的 Picard 不动点迭代由 $y^{(n+1)} = \\Phi_T(y^{(n)})$ 给出。为了分析其收敛性，我们考察误差 $e^{(n)} = y^{(n)} - y_\\star$ 的演化。\n$$\ne^{(n+1)} = y^{(n+1)} - y_\\star = \\Phi_T(y^{(n)}) - y_\\star = (M y^{(n)} + d) - (M y_\\star + d) = M(y^{(n)} - y_\\star) = M e^{(n)}\n$$\n这表明 $e^{(n)} = M^n e^{(0)}$。对于任何初始误差 $e^{(0)}$，该迭代收敛当且仅当 $\\lim_{n \\to \\infty} M^n = 0$。这种情况发生当且仅当 $M$ 的谱半径 $\\rho(M) = \\max_i |\\lambda_i(M)|$ 严格小于 $1$。单值矩阵 $M$ 的特征值 $\\lambda_i(M)$ 被称为系统的 Floquet 乘子。因此，Picard 迭代的线性收敛条件是 $\\rho(M)  1$。\n\n### 第3部分：谱延迟修正 (SDC) 公式\n\nSDC 是一种求解 ODE 的迭代方法，它系统地提高精度阶数。它从一个低阶近似开始，并使用基于高阶求积规则的残差来迭代地修正它。\n在子区间 $[t_{m-1}, t_m]$ 上，ODE 的积分形式为：\n$$\ny(t_m) = y(t_{m-1}) + \\int_{t_{m-1}}^{t_m} F(s, y(s)) ds\n$$\n其中 $F(t,y) = A(t)y + b(t)$。SDC 使用基于全部 $K$ 个节点 $\\{t_j\\}_{j=0}^{K-1}$ 的求积规则来近似该积分。从扫描 $k$ 到 $k+1$ 的更新是通过加上和减去一个低阶（例如，后向 Euler）积分近似来构造的。\n基于配置的高阶求积公式为 $\\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j)$，其中 $S_{m,j} = T \\int_{c_{m-1}}^{c_m} \\ell_j(s) ds$。低阶后向 Euler 近似为 $\\Delta t_m F(t_m, y_m)$，其中 $\\Delta t_m = t_m - t_{m-1}$。\n\nSDC 方法迭代地求解配置方程。可以为误差修正构建一个隐式扫描。其核心思想是，新迭代值相对于低阶方法的亏格应等于前一个迭代值相对于高阶求积的误差（残差）。\n设 $y_m^k$ 为扫描 $k$ 次后在节点 $t_m$ 处的解。从 $m-1$到 $m$ 的类 Gauss-Seidel 扫描的更新规则是：\n$$\ny_m^{k+1} - \\Delta t_m F(t_m, y_m^{k+1}) = y_{m-1}^{k+1} + \\left[ \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k) - \\Delta t_m F(t_m, y_m^k) \\right]\n$$\n左边是应用于新迭代值 $y_m^{k+1}$ 的隐式后向 Euler 算子，使用了刚计算出的前一个节点的值 $y_{m-1}^{k+1}$。右边由 $y_{m-1}^{k+1}$ 加上“谱积分残差”组成，该残差是高阶求积与积分的低阶近似之间的差值，使用前一次扫描的值 $y^k$ 进行评估。\n对于线性 ODE $F(t,y) = A(t)y + b(t)$，我们将其代入公式：\n$$\ny_m^{k+1} - \\Delta t_m (A(t_m)y_m^{k+1} + b(t_m)) = y_{m-1}^{k+1} + \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k) - \\Delta t_m (A(t_m)y_m^k + b(t_m))\n$$\n项 $\\Delta t_m b(t_m)$ 在两边被消掉了。将涉及 $y_m^{k+1}$ 的项移到左边得到：\n$$\ny_m^{k+1} - \\Delta t_m A(t_m)y_m^{k+1} = y_{m-1}^{k+1} - \\Delta t_m A(t_m)y_m^k + \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k)\n$$\n将 $y_m^{k+1}$ 因子提出来，得到问题中陈述的线性系统：\n$$\n\\bigl(I - \\Delta t_m A(t_m)\\bigr) y_m^{k+1} = y_{m-1}^{k+1} - \\Delta t_m A(t_m) y_m^k + \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k)\n$$\n这是一个线性系统，需要在扫描的每一步 $m=1, \\dots, K-1$ 求解 $y_m^{k+1}$。\n\n### 第4部分：通过基于 SDC 的打靶法实现\n\n数值程序将遵循所提供的指令。\n1.  **定义系统和离散化**：对于每个测试用例，设置参数 $N$、$K$、$S$、$T$、$a$以及 $g_k$ 的规则。计算角频率 $\\omega=2\\pi/T$、时间节点 $\\{t_j\\}$ 和时间步长 $\\{\\Delta t_m\\}$。\n2.  **求积权重**：通过对与 Chebyshev 节点相关的 Lagrange 基多项式在每个子区间 $[t_{m-1}, t_m]$ 上进行解析积分，来预计算求积矩阵 $S_{m,j}$。\n3.  **SDC 积分器**：实现一个函数来执行在 $[0,T]$ 上的时间积分。它接受一个初始条件 $y(0)$，并应用一个后向 Euler 预测步骤，然后进行 $S$ 次 SDC 修正扫描，如第 3 部分所推导。\n4.  **构造单值映射**：\n    -   单值矩阵 $M$ 是逐列构造的。$M$ 的第 $j$ 列是将 SDC 积分器应用于齐次系统（$b(t)=0$），并以第 $j$ 个标准基向量 $e_j$作为初始条件的结果。\n    -   仿射向量 $d$ 是通过将 SDC 积分器应用于完整的非齐次系统，并以零向量作为初始条件来构造的。\n5.  **求解周期解**：\n    -   周期解的初始条件 $y_\\star$ 通过求解线性系统 $(I - M)y_\\star = d$ 得到。\n    -   为了验证解，计算周期性残差 $\\|\\Phi_T(y_\\star) - y_\\star\\|_2$。这是通过以初始条件 $y_\\star$ 再次应用 SDC 积分器得到 $\\Phi_T(y_\\star)$ 并将其与 $y_\\star$ 进行比较来完成的。由于有限精度算术和离散化误差，该范数将很小但非零。\n6.  **分析稳定性**：Floquet 乘子作为 $M$ 的特征值被计算出来。找到并报告它们的最大模，即谱半径 $\\rho(M)$，以及收缩条件 $\\rho(M)  1$ 是否满足。\n\n这个结构化的过程允许对周期解进行稳健的数值近似，并分析其稳定性特征。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import lagrange\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        {'N': 5, 'K': 5, 'S': 3, 'T': 1.0, 'a': 1.0, 'g_rule': lambda k: 1.0 / k**2},\n        {'N': 4, 'K': 4, 'S': 2, 'T': 0.7, 'a': 3.0, 'g_rule': lambda k: 0.5 / k},\n        {'N': 3, 'K': 6, 'S': 4, 'T': 2.0, 'a': 0.5, 'g_rule': lambda k: 1.0 / k},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        rho_M, residual_norm, is_contraction = run_test_case(**params)\n        all_results.extend([rho_M, residual_norm, is_contraction])\n\n    # Format and print the final output string\n    print(f\"[{','.join(map(str, all_results))}]\")\n\n\ndef run_test_case(N, K, S, T, a, g_rule):\n    \"\"\"\n    Executes a single test case for the given parameters.\n    \"\"\"\n    # ====== 1. Setup Discretization and System Parameters ======\n    omega = 2.0 * np.pi / T\n    ks = np.arange(1, N + 1)\n    gs = g_rule(ks)\n\n    # Chebyshev-Gauss-Lobatto nodes mapped to [0, T]\n    c_nodes = 0.5 * (1.0 - np.cos(np.pi * np.arange(K) / (K - 1)))\n    t_nodes = T * c_nodes\n    delta_ts = np.diff(t_nodes)\n\n    # Define the system functions A(t) and b(t)\n    def A_func(t):\n        diag_vals = -ks**2 + a * np.cos(omega * t)\n        return np.diag(diag_vals)\n\n    def b_func(t):\n        return gs * np.sin(omega * t)\n\n    def F_func(t, y):\n        return A_func(t) @ y + b_func(t)\n\n    # ====== 2. Pre-compute SDC Quadrature Matrix S_m,j ======\n    S_mat = np.zeros((K - 1, K))\n    id_matrix_K = np.eye(K)\n    for j in range(K):\n        # Lagrange polynomial for node j on [0,1]\n        l_j_poly = lagrange(c_nodes, id_matrix_K[:, j])\n        # Integral of the polynomial\n        l_j_integral = l_j_poly.integ()\n        for m in range(1, K):\n            integral_val = l_j_integral(c_nodes[m]) - l_j_integral(c_nodes[m-1])\n            S_mat[m - 1, j] = T * integral_val\n\n    # ====== 3. SDC Integrator over one period [0, T] ======\n    def sdc_integrate(y0, b_func_local):\n        # Initialize solution at nodes\n        Y = np.zeros((K, N))\n        Y[0] = y0\n\n        # Predictor step (k=0): Backward Euler\n        for m in range(1, K):\n            dt = delta_ts[m - 1]\n            LHS_mat = np.eye(N) - dt * A_func(t_nodes[m])\n            RHS = Y[m - 1] + dt * b_func_local(t_nodes[m])\n            Y[m] = np.linalg.solve(LHS_mat, RHS)\n        \n        # Corrector sweeps\n        for _ in range(S):\n            Y_new = np.copy(Y)\n            for m in range(1, K):\n                dt = delta_ts[m - 1]\n                \n                # Compute integral term from previous sweep k\n                integral_term = np.zeros(N)\n                for j in range(K):\n                    F_j = A_func(t_nodes[j]) @ Y[j] + b_func_local(t_nodes[j])\n                    integral_term += S_mat[m - 1, j] * F_j\n                \n                # Form RHS of the linear system for y_m^(k+1)\n                RHS = Y_new[m - 1] - dt * A_func(t_nodes[m]) @ Y[m] + integral_term\n\n                # Form LHS and solve\n                LHS_mat = np.eye(N) - dt * A_func(t_nodes[m])\n                Y_new[m] = np.linalg.solve(LHS_mat, RHS)\n            \n            Y = Y_new # Update for next sweep\n        \n        return Y[-1]\n\n    # ====== 4. Construct Monodromy Matrix M and Affine Vector d ======\n    M = np.zeros((N, N))\n    I_N = np.eye(N)\n    b_zero = lambda t: np.zeros(N)\n    \n    for j in range(N):\n        e_j = I_N[:, j]\n        M[:, j] = sdc_integrate(e_j, b_zero)\n\n    d = sdc_integrate(np.zeros(N), b_func)\n\n    # ====== 5. Solve for Periodic Solution and Compute Residual ======\n    try:\n        y_star = np.linalg.solve(np.eye(N) - M, d)\n    except np.linalg.LinAlgError:\n        # Handle case where (I-M) is singular (1 is an eigenvalue)\n        return np.inf, np.inf, False\n\n    # Compute Phi_T(y_star) to find the residual\n    yT_star = sdc_integrate(y_star, b_func)\n    residual_norm = np.linalg.norm(yT_star - y_star)\n\n    # ====== 6. Compute Floquet Multipliers and Spectral Radius ======\n    floquet_multipliers = np.linalg.eigvals(M)\n    rho_M = np.max(np.abs(floquet_multipliers))\n    is_contraction = rho_M  1.0\n\n    return rho_M, residual_norm, is_contraction\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}