{
    "hands_on_practices": [
        {
            "introduction": "本练习将从最简单的一维系统入手，巩固乘性协方差膨胀对卡尔曼增益和后验方差的核心数学影响。通过分析膨胀因子趋于无穷时的极限情况，我们将直观地理解膨胀如何调节系统对预报和观测的信任权重。这项基础练习 () 是理解更复杂系统中协方差膨胀行为的基石。",
            "id": "3372953",
            "problem": "考虑一个 $1$-维线性高斯数据同化问题，其中观测算子为 $H=1$。预报（先验）状态 $x$ 被建模为均值为 $\\mu_f$、方差为 $P_f=p$ 的高斯分布，观测模型为 $y = x + \\varepsilon$，其中观测误差 $\\varepsilon \\sim \\mathcal{N}(0,r)$ 是独立的，且 $r0$。对预报方差应用乘性协方差膨胀，使得膨胀后的先验变为 $x \\sim \\mathcal{N}(\\mu_f,\\lambda p)$，其中膨胀因子 $\\lambda \\ge 1$。后验分布为高斯分布，$x \\mid y \\sim \\mathcal{N}(\\mu_a, P_a(\\lambda))$。对于此标量问题，通过关系式 $\\mu_a = \\mu_f + K(\\lambda)\\,(y-\\mu_f)$ 定义卡尔曼增益 $K(\\lambda)$。\n\n仅从贝叶斯定理、高斯密度形式和给定的概率模型出发，推导 $K(\\lambda)$ 和 $P_a(\\lambda)$ 关于 $\\lambda$、$p$ 和 $r$ 的闭式表达式。然后分析这些表达式在 $\\lambda \\to \\infty$ 时的极限。以解析表达式的形式给出最终答案。不需要数值近似。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 问题类型：$1$-维线性高斯数据同化。\n- 观测算子：$H=1$。\n- 预报（先验）状态模型：$x \\sim \\mathcal{N}(\\mu_f, P_f)$，其中均值为 $\\mu_f$，方差为 $P_f=p$。\n- 观测模型：$y = x + \\varepsilon$。\n- 观测误差模型：$\\varepsilon \\sim \\mathcal{N}(0, r)$，其中 $r0$。误差 $\\varepsilon$ 与状态 $x$ 独立。\n- 协方差膨胀：预报方差被一个因子 $\\lambda \\ge 1$ 膨胀。\n- 膨胀后的先验模型：$x \\sim \\mathcal{N}(\\mu_f, \\lambda p)$。\n- 后验模型：$x \\mid y \\sim \\mathcal{N}(\\mu_a, P_a(\\lambda))$。\n- 卡尔曼增益的定义：$\\mu_a = \\mu_f + K(\\lambda)\\,(y-\\mu_f)$。\n- 目标：使用贝叶斯定理推导 $K(\\lambda)$ 和 $P_a(\\lambda)$ 的闭式表达式，然后求它们在 $\\lambda \\to \\infty$ 时的极限。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学上成立：** 该问题是线性高斯系统贝叶斯推断的一个标准练习，是统计信号处理和数据同化的基石，广为人知为卡尔曼滤波更新步骤。使用乘性协方差膨胀是一种标准技术。所有概念在数学和工程领域都已得到充分确立。\n- **适定性：** 问题提供了所有必要信息：先验概率分布和似然函数，这足以确定唯一的后验分布。任务定义清晰。\n- **客观性：** 问题以精确、客观的数学语言表述，没有歧义或主观论断。\n- **完整性和一致性：** 问题是自洽的，没有内部矛盾。\n- **现实性和可行性：** 该设置代表了一个在无数实际应用中使用的简化但基础的模型。\n\n### 步骤 3：结论与行动\n该问题有效，因为它科学上成立、适定、客观且完整。将按要求从第一性原理推导求解。\n\n### 求解推导\n解法是使用贝叶斯定理推导得出的，该定理指出后验概率密度函数 (PDF) 正比于似然 PDF 和先验 PDF 的乘积：\n$$p(x \\mid y) \\propto p(y \\mid x) \\, p(x)$$\n\n状态 $x$ 的膨胀后的先验分布为 $x \\sim \\mathcal{N}(\\mu_f, \\lambda p)$。其 PDF 为：\n$$p(x) = \\frac{1}{\\sqrt{2\\pi\\lambda p}} \\exp\\left(-\\frac{(x-\\mu_f)^2}{2\\lambda p}\\right)$$\n\n观测模型 $y = x + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, r)$，意味着对于给定的状态 $x$，观测值 $y$ 是一个随机变量，其分布为 $y \\mid x \\sim \\mathcal{N}(x, r)$。似然函数是此分布的 PDF，看作是对于固定观测值 $y$ 的关于 $x$ 的函数：\n$$p(y \\mid x) = \\frac{1}{\\sqrt{2\\pi r}} \\exp\\left(-\\frac{(y-x)^2}{2r}\\right)$$\n\n应用贝叶斯定理，后验 PDF $p(x \\mid y)$ 正比于以下乘积：\n$$p(x \\mid y) \\propto \\exp\\left(-\\frac{(x-\\mu_f)^2}{2\\lambda p}\\right) \\exp\\left(-\\frac{(y-x)^2}{2r}\\right)$$\n$$p(x \\mid y) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(x-\\mu_f)^2}{\\lambda p} + \\frac{(y-x)^2}{r} \\right] \\right)$$\n\n为了确定后验分布的参数，我们通过对 $x$ 进行配方来分析指数项。令方括号中的项为 $J(x)$：\n$$J(x) = \\frac{x^2 - 2x\\mu_f + \\mu_f^2}{\\lambda p} + \\frac{x^2 - 2xy + y^2}{r}$$\n我们按 $x$ 的幂次收集项：\n$$J(x) = x^2 \\left(\\frac{1}{\\lambda p} + \\frac{1}{r}\\right) - 2x \\left(\\frac{\\mu_f}{\\lambda p} + \\frac{y}{r}\\right) + \\left(\\frac{\\mu_f^2}{\\lambda p} + \\frac{y^2}{r}\\right)$$\n\n后验分布是高斯分布，$x \\mid y \\sim \\mathcal{N}(\\mu_a, P_a(\\lambda))$，所以其 PDF 的形式为：\n$$p(x \\mid y) \\propto \\exp\\left(-\\frac{(x-\\mu_a)^2}{2P_a(\\lambda)}\\right) \\propto \\exp\\left(-\\frac{1}{2} \\left[ \\frac{x^2}{P_a(\\lambda)} - \\frac{2x\\mu_a}{P_a(\\lambda)} + \\frac{\\mu_a^2}{P_a(\\lambda)} \\right] \\right)$$\n\n通过比较 $J(x)$ 中 $x^2$ 项的系数与一般形式，我们确定后验方差 $P_a(\\lambda)$ 的倒数：\n$$\\frac{1}{P_a(\\lambda)} = \\frac{1}{\\lambda p} + \\frac{1}{r} = \\frac{r + \\lambda p}{\\lambda p r}$$\n对此表达式求逆，得到后验方差：\n$$P_a(\\lambda) = \\frac{\\lambda p r}{\\lambda p + r}$$\n\n接下来，我们比较 $x$ 的线性项的系数。从 $J(x)$ 可知，$-2x$ 的系数是 $(\\frac{\\mu_f}{\\lambda p} + \\frac{y}{r})$。从一般后验形式可知，$-2x$ 的系数是 $\\frac{\\mu_a}{P_a(\\lambda)}$。令两者相等可得：\n$$\\frac{\\mu_a}{P_a(\\lambda)} = \\frac{\\mu_f}{\\lambda p} + \\frac{y}{r}$$\n求解后验均值 $\\mu_a$：\n$$\\mu_a = P_a(\\lambda) \\left(\\frac{\\mu_f}{\\lambda p} + \\frac{y}{r}\\right) = \\frac{\\lambda p r}{\\lambda p + r} \\left(\\frac{\\mu_f r + y \\lambda p}{\\lambda p r}\\right) = \\frac{\\mu_f r + y \\lambda p}{\\lambda p + r}$$\n\n现在，我们使用其定义 $\\mu_a = \\mu_f + K(\\lambda)(y-\\mu_f)$ 来推导卡尔曼增益 $K(\\lambda)$。我们重新整理 $\\mu_a$ 的表达式：\n$$\\mu_a = \\frac{\\mu_f r + \\mu_f \\lambda p - \\mu_f \\lambda p + y \\lambda p}{\\lambda p + r} = \\frac{\\mu_f(r + \\lambda p) + \\lambda p(y - \\mu_f)}{\\lambda p + r}$$\n$$\\mu_a = \\frac{\\mu_f(r + \\lambda p)}{\\lambda p + r} + \\frac{\\lambda p(y - \\mu_f)}{\\lambda p + r} = \\mu_f + \\left(\\frac{\\lambda p}{\\lambda p + r}\\right)(y - \\mu_f)$$\n通过将其与卡尔曼增益的定义进行比较，我们得到：\n$$K(\\lambda) = \\frac{\\lambda p}{\\lambda p + r}$$\n\n最后，我们分析当膨胀因子 $\\lambda$ 趋于无穷大时，$K(\\lambda)$ 和 $P_a(\\lambda)$ 的极限。\n对于卡尔曼增益 $K(\\lambda)$：\n$$\\lim_{\\lambda \\to \\infty} K(\\lambda) = \\lim_{\\lambda \\to \\infty} \\frac{\\lambda p}{\\lambda p + r} = \\lim_{\\lambda \\to \\infty} \\frac{1}{1 + \\frac{r}{\\lambda p}} = \\frac{1}{1 + 0} = 1$$\n\n对于后验方差 $P_a(\\lambda)$：\n$$\\lim_{\\lambda \\to \\infty} P_a(\\lambda) = \\lim_{\\lambda \\to \\infty} \\frac{\\lambda p r}{\\lambda p + r} = \\lim_{\\lambda \\to \\infty} \\frac{r}{1 + \\frac{r}{\\lambda p}} = \\frac{r}{1 + 0} = r$$\n\n$\\lambda \\to \\infty$ 的极限对应于无穷大的先验不确定性。在这种情况下，先验分布变为无信息量的，而后验分布完全由观测（似然）决定。后验均值变为观测值 $y$（因为 $K(\\lambda) \\to 1$，$\\mu_a \\to \\mu_f + 1(y-\\mu_f) = y$），后验方差变为观测误差方差 $r$。这证实了结果的物理解释。\n\n所要求的四个解析表达式为：\n1. $K(\\lambda) = \\frac{\\lambda p}{\\lambda p + r}$\n2. $P_a(\\lambda) = \\frac{\\lambda p r}{\\lambda p + r}$\n3. $\\lim_{\\lambda \\to \\infty} K(\\lambda) = 1$\n4. $\\lim_{\\lambda \\to \\infty} P_a(\\lambda) = r$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\lambda p}{\\lambda p + r}  \\frac{\\lambda p r}{\\lambda p + r}  1  r\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基本原理之后，我们将进入一个更接近实际应用的二维系统，其中不同状态分量的观测质量存在差异。这个练习 () 引入了一种更精巧的混合加性-乘性膨胀模型。通过推导，你将揭示为何各向同性的加性膨胀能够选择性地增强在观测不足方向上的分析更新，这是防止滤波器发散的一项关键技术。",
            "id": "3372955",
            "problem": "考虑一个二维线性高斯逆问题，其状态向量为 $x \\in \\mathbb{R}^{2}$，预报（先验）均值为 $m^{f} \\in \\mathbb{R}^{2}$，预报协方差 $P^{f}(\\alpha,\\beta) \\in \\mathbb{R}^{2 \\times 2}$ 由协方差膨胀模型给出\n$$\nP^{f}(\\alpha,\\beta) = \\alpha\\,P_{0} + \\beta\\,I ,\n$$\n其中 $\\alpha  0$ 是乘性膨胀因子，$\\beta \\ge 0$ 是各向同性加性膨胀大小，$I$ 是 $2 \\times 2$ 单位矩阵，$P_{0} = \\operatorname{diag}(\\lambda_{1},\\lambda_{2})$ 且 $\\lambda_{1}  0$ 和 $\\lambda_{2}  0$。观测值 $y \\in \\mathbb{R}^{2}$ 由线性模型给出\n$$\ny = H x + v ,\n$$\n其中观测算子为 $H = \\operatorname{diag}(1,\\varepsilon)$，这里的 $0  \\varepsilon  1$ 表征了一个敏感度较弱的方向（一个观测不足的方向），观测误差 $v \\sim \\mathcal{N}(0,R)$，其中 $R = \\operatorname{diag}(\\sigma_{1}^{2},\\sigma_{2}^{2})$ 且 $\\sigma_{1}^{2}  0$，$\\sigma_{2}^{2}  0$。从数据同化的贝叶斯线性高斯表述及其相关的正规方程出发，推导卡尔曼增益 $K(\\alpha,\\beta)$ 关于 $\\alpha$、$\\beta$、$\\lambda_{1}$、$\\lambda_{2}$、$\\varepsilon$、$\\sigma_{1}^{2}$ 和 $\\sigma_{2}^{2}$ 的闭式解析表达式。然后，利用你推导出的表达式和基于 $H$ 和 $R$ 结构的方向性推理，解释各向同性项 $\\beta I$ 为什么以及如何选择性地增加与较小敏感度参数 $\\varepsilon$ 相关的观测不足方向上的更新影响。最终答案必须是 $K(\\alpha,\\beta)$ 的完全简化解析表达式；不需要进行数值计算。",
            "solution": "该问题要求做两件事：首先，对于一个给定的二维线性高斯系统，推导卡尔曼增益 $K(\\alpha,\\beta)$ 的解析表达式；其次，解释各向同性加性膨胀项 $\\beta I$ 如何选择性地增加观测不足方向上观测更新的影响。\n\n首先，我们推导卡尔曼增益 $K(\\alpha,\\beta)$。卡尔曼增益 $K$ 的标准公式如下：\n$$\nK = P^{f} H^{T} (H P^{f} H^{T} + R)^{-1}\n$$\n我们已知这个方程的各个组成部分。下面我们来计算每一项。\n\n预报（或先验）协方差矩阵 $P^{f}$ 由膨胀模型给出：\n$$\nP^{f}(\\alpha,\\beta) = \\alpha P_{0} + \\beta I\n$$\n由于 $P_{0} = \\operatorname{diag}(\\lambda_{1}, \\lambda_{2})$ 且 $I$ 是 $2 \\times 2$ 单位矩阵，我们有：\n$$\nP^{f}(\\alpha,\\beta) = \\alpha \\begin{pmatrix} \\lambda_{1}  0 \\\\ 0  \\lambda_{2} \\end{pmatrix} + \\beta \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta  0 \\\\ 0  \\alpha\\lambda_{2} + \\beta \\end{pmatrix}\n$$\n由于 $P^f$ 是一个对角矩阵，我们将其对角元素表示为 $p^f_{11} = \\alpha\\lambda_{1} + \\beta$ 和 $p^f_{22} = \\alpha\\lambda_{2} + \\beta$。\n\n观测算子为 $H = \\operatorname{diag}(1, \\varepsilon)$，所以其转置为 $H^{T} = \\operatorname{diag}(1, \\varepsilon) = H$。\n\n观测误差协方差矩阵为 $R = \\operatorname{diag}(\\sigma_{1}^{2}, \\sigma_{2}^{2})$。\n\n现在，我们计算卡尔曼增益公式中的各项。所有涉及的矩阵都是对角矩阵，这简化了乘法和求逆运算。\n\n$P^{f} H^{T}$ 项为：\n$$\nP^{f} H^{T} = \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta  0 \\\\ 0  \\alpha\\lambda_{2} + \\beta \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix} = \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta  0 \\\\ 0  \\varepsilon(\\alpha\\lambda_{2} + \\beta) \\end{pmatrix}\n$$\n\n新息协方差矩阵 $S = H P^{f} H^{T} + R$ 为：\n$$\nS = \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix} \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta  0 \\\\ 0  \\varepsilon(\\alpha\\lambda_{2} + \\beta) \\end{pmatrix} + \\begin{pmatrix} \\sigma_{1}^{2}  0 \\\\ 0  \\sigma_{2}^{2} \\end{pmatrix}\n$$\n$$\nS = \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta  0 \\\\ 0  \\varepsilon^{2}(\\alpha\\lambda_{2} + \\beta) \\end{pmatrix} + \\begin{pmatrix} \\sigma_{1}^{2}  0 \\\\ 0  \\sigma_{2}^{2} \\end{pmatrix} = \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta + \\sigma_{1}^{2}  0 \\\\ 0  \\varepsilon^{2}(\\alpha\\lambda_{2} + \\beta) + \\sigma_{2}^{2} \\end{pmatrix}\n$$\n对角矩阵 $S$ 的逆矩阵是其对角元素取倒数后得到的矩阵：\n$$\nS^{-1} = (H P^{f} H^{T} + R)^{-1} = \\begin{pmatrix} \\frac{1}{\\alpha\\lambda_{1} + \\beta + \\sigma_{1}^{2}}  0 \\\\ 0  \\frac{1}{\\varepsilon^{2}(\\alpha\\lambda_{2} + \\beta) + \\sigma_{2}^{2}} \\end{pmatrix}\n$$\n最后，我们计算卡尔曼增益 $K(\\alpha,\\beta) = (P^{f} H^{T}) S^{-1}$：\n$$\nK(\\alpha,\\beta) = \\begin{pmatrix} \\alpha\\lambda_{1} + \\beta  0 \\\\ 0  \\varepsilon(\\alpha\\lambda_{2} + \\beta) \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\alpha\\lambda_{1} + \\beta + \\sigma_{1}^{2}}  0 \\\\ 0  \\frac{1}{\\varepsilon^{2}(\\alpha\\lambda_{2} + \\beta) + \\sigma_{2}^{2}} \\end{pmatrix}\n$$\n$$\nK(\\alpha,\\beta) = \\begin{pmatrix} \\frac{\\alpha\\lambda_{1} + \\beta}{\\alpha\\lambda_{1} + \\beta + \\sigma_{1}^{2}}  0 \\\\ 0  \\frac{\\varepsilon(\\alpha\\lambda_{2} + \\beta)}{\\varepsilon^{2}(\\alpha\\lambda_{2} + \\beta) + \\sigma_{2}^{2}} \\end{pmatrix}\n$$\n这是卡尔曼增益的闭式解析表达式。我们将其分量表示为 $k_{11}(\\alpha,\\beta)$ 和 $k_{22}(\\alpha,\\beta)$。\n\n接下来，我们解释为什么以及如何让各向同性项 $\\beta I$ 选择性地增加在观测不足方向上的更新影响。\n每个状态分量的“更新影响”由卡尔曼增益矩阵对应对角元素的大小 $k_{11}$ 和 $k_{22}$ 决定。较大的增益值意味着来自观测的修正更强。“观测不足的方向”对应于状态向量的第二个分量，因为观测算子 $H = \\operatorname{diag}(1, \\varepsilon)$ 对该分量有一个小的敏感度参数 $0  \\varepsilon  1$。\n\n加性膨胀项 $\\beta I$ 使预报协方差 $P^f$ 的对角元素增加了 $\\beta$。这表示状态空间中方差的各向同性增加。我们希望证明这种各向同性膨胀对观测不足方向的增益影响更大。为此，我们比较引入 $\\beta$ 时（即 $\\beta  0$ 相对于 $\\beta=0$），$k_{22}$ 的相对增量与 $k_{11}$ 的相对增量。\n\n设 $p_1 = \\alpha\\lambda_1$ 和 $p_2 = \\alpha\\lambda_2$ 为没有加性膨胀时的预报方差。\n没有加性膨胀时，第一个分量的增益为 $k_{11}(0) = \\frac{p_1}{p_1 + \\sigma_1^2}$。有膨胀时，增益为 $k_{11}(\\beta) = \\frac{p_1+\\beta}{p_1+\\beta+\\sigma_1^2}$。\n没有加性膨胀时，第二个分量的增益为 $k_{22}(0) = \\frac{\\varepsilon p_2}{\\varepsilon^2 p_2 + \\sigma_2^2}$。有膨胀时，增益为 $k_{22}(\\beta) = \\frac{\\varepsilon(p_2+\\beta)}{\\varepsilon^2(p_2+\\beta) + \\sigma_2^2}$。\n\n为了量化“选择性”增加，我们考察每个分量有膨胀与无膨胀时增益的比率。设 $R_1 = k_{11}(\\beta)/k_{11}(0)$ 和 $R_2 = k_{22}(\\beta)/k_{22}(0)$。\n对于第一个分量：\n$$\nR_1 = \\frac{\\frac{p_1+\\beta}{p_1+\\beta+\\sigma_1^2}}{\\frac{p_1}{p_1+\\sigma_1^2}} = \\frac{(p_1+\\beta)(p_1+\\sigma_1^2)}{p_1(p_1+\\beta+\\sigma_1^2)}\n$$\n对于第二个分量：\n$$\nR_2 = \\frac{\\frac{\\varepsilon(p_2+\\beta)}{\\varepsilon^2(p_2+\\beta)+\\sigma_2^2}}{\\frac{\\varepsilon p_2}{\\varepsilon^2 p_2+\\sigma_2^2}} = \\frac{(p_2+\\beta)(\\varepsilon^2 p_2+\\sigma_2^2)}{p_2(\\varepsilon^2(p_2+\\beta)+\\sigma_2^2)}\n$$\n为了最清楚地展示选择性效应，我们暂时假设两个方向的系统参数相似，即 $p_1=p_2=p$ 和 $\\sigma_1^2=\\sigma_2^2=\\sigma^2$。这样可以分离出敏感度参数 $\\varepsilon$ 的影响。\n在此简化下，我们有：\n$$\nR_1 = \\frac{(p+\\beta)(p+\\sigma^2)}{p(p+\\beta+\\sigma^2)} \\quad \\text{和} \\quad R_2 = \\frac{(p+\\beta)(\\varepsilon^2 p+\\sigma^2)}{p(\\varepsilon^2(p+\\beta)+\\sigma^2)}\n$$\n我们想确定是否 $R_2  R_1$。由于项 $(p+\\beta)/p$ 是公共的正项，这等价于比较：\n$$\n\\frac{\\varepsilon^2 p+\\sigma^2}{\\varepsilon^2 p+\\varepsilon^2\\beta+\\sigma^2} \\quad \\text{vs.} \\quad \\frac{p+\\sigma^2}{p+\\beta+\\sigma^2}\n$$\n令 $f(x) = \\frac{x}{x+c}$，其中 $c0$。当 $x0$ 时，该函数单调递增。我们正在比较 $f_A(A) = \\frac{A}{A+\\varepsilon^2\\beta}$ 与 $f_B(B) = \\frac{B}{B+\\beta}$，其中 $A = \\varepsilon^2 p + \\sigma^2$，$B = p+\\sigma^2$。\n让我们对不等式 $R_2  R_1$ 进行交叉相乘：\n$$\n\\frac{(\\varepsilon^2 p+\\sigma^2)}{(\\varepsilon^2 p+\\varepsilon^2\\beta+\\sigma^2)}  \\frac{(p+\\sigma^2)}{(p+\\beta+\\sigma^2)}\n$$\n$$\n(\\varepsilon^2 p+\\sigma^2)(p+\\beta+\\sigma^2)  (p+\\sigma^2)(\\varepsilon^2 p+\\varepsilon^2\\beta+\\sigma^2)\n$$\n展开两边：\n$$\n\\varepsilon^2 p^2 + \\varepsilon^2 p\\beta + \\varepsilon^2 p\\sigma^2 + p\\sigma^2 + \\beta\\sigma^2 + \\sigma^4  \\varepsilon^2 p^2 + \\varepsilon^2 p\\beta + p\\sigma^2 + \\varepsilon^2 p\\sigma^2 + \\varepsilon^2\\beta\\sigma^2 + \\varepsilon^2\\sigma^4\n$$\n消去两边的公共项得到：\n$$\n\\beta\\sigma^2 + \\sigma^4  \\varepsilon^2\\beta\\sigma^2 + \\varepsilon^2\\sigma^4\n$$\n$$\n\\sigma^2(\\beta+\\sigma^2)  \\varepsilon^2 \\sigma^2(\\beta+\\sigma^2)\n$$\n因为 $\\sigma^2  0$ 且 $\\beta \\ge 0$，所以 $\\sigma^2(\\beta+\\sigma^2)$ 项为正，我们可以用它来除：\n$$\n1  \\varepsilon^2\n$$\n这个不等式是成立的，因为题目陈述指明了 $0  \\varepsilon  1$。\n\n这证明了卡尔曼增益的相对增加对于观测不足的分量 ($R_2  R_1$) 严格大于观测良好的分量。因此，状态空间中的加性各向同性膨胀 $\\beta I$ 转化为对观测较弱方向上增益的各向异性、选择性提升。这有助于防止滤波器发散，通过确保分析对观测保持敏感，即使在预报模型倾向于低估其不确定性且观测敏感度较低的方向上也是如此。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{\\alpha\\lambda_{1} + \\beta}{\\alpha\\lambda_{1} + \\beta + \\sigma_{1}^{2}}  0 \\\\ 0  \\frac{\\varepsilon(\\alpha\\lambda_{2} + \\beta)}{\\varepsilon^{2}(\\alpha\\lambda_{2} + \\beta) + \\sigma_{2}^{2}} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的练习探讨了一个兼具实用性和警示性的场景，即协方差膨胀与观测算子自身误差之间的复杂相互作用。这项挑战 () 要求你推导在特定条件下，如何调整膨胀因子来抵消分析偏差。这个过程揭示了膨胀的双重角色：它既是方差校正工具，也可能是管理其他模型误差的潜在（但有风险的）手段。",
            "id": "3373008",
            "problem": "考虑一个标量线性高斯数据同化问题，其中真实观测模型由 $y = H x^{\\star} + \\varepsilon$ 给出，其中 $x^{\\star}$ 是真实状态，$H$ 是真实观测算子，$\\varepsilon$ 是均值为零、方差为 $R$ 的高斯观测噪声。该数据同化系统在其分析步骤中错误地使用了一个有偏观测算子 $\\tilde{H} = H + \\Delta H$，并对预报误差方差应用了一个因子为 $\\gamma  0$ 的乘性协方差膨胀。在同化 $y$ 之前的预报分布具有均值 $m_{f}$ 和方差 $P_{f}$，其预报均值偏差为 $b_{f} = m_{f} - x^{\\star}$。假设分析是通过使用有偏算子 $\\tilde{H}$ 和膨胀后的预报方差 $\\gamma P_{f}$ 的标准线性高斯更新计算得出的。\n\n从上述高斯线性贝叶斯更新原理和定义出发，推导期望分析均值偏差 $b_{a}(\\gamma) = \\mathbb{E}[m_{a} - x^{\\star}]$，其中期望是关于观测噪声 $\\varepsilon$ 计算的。将 $b_{a}(\\gamma)$ 显式地表示为 $\\gamma$、$H$、$\\Delta H$、$x^{\\star}$、$b_{f}$、$P_{f}$ 和 $R$ 的函数。然后，对于具体的数值\n$H = 1$，$\\Delta H = 0.5$，$x^{\\star} = 1$，$m_{f} = 1.8$，$P_{f} = 1$，和 $R = 1$，\n确定唯一的正值 $\\gamma^{\\star}$，使得期望分析均值偏差恰好为零，即 $b_{a}(\\gamma^{\\star}) = 0$。将您的答案四舍五入到四位有效数字。最终答案必须是一个不带单位的实数。",
            "solution": "该问题要求推导期望分析均值偏差 $b_a(\\gamma)$，然后计算一个特定的乘性协方差膨胀因子 $\\gamma^{\\star}$，使该偏差为零。\n\n首先，我们验证问题陈述。\n步骤1：提取已知条件。\n- 真实观测模型：$y = H x^{\\star} + \\varepsilon$\n- 真实状态：$x^{\\star}$\n- 真实观测算子：$H$\n- 观测噪声：$\\varepsilon$，均值 $\\mathbb{E}[\\varepsilon] = 0$，方差 $R$。\n- 同化中使用的有偏观测算子：$\\tilde{H} = H + \\Delta H$\n- 乘性协方差膨胀因子：$\\gamma  0$\n- 预报均值：$m_f$\n- 预报方差：$P_f$\n- 预报均值偏差：$b_f = m_f - x^{\\star}$\n- 分析是使用有偏算子 $\\tilde{H}$ 和膨胀后的预报方差 $\\gamma P_f$ 通过标准线性高斯更新计算的。\n- 目标量是期望分析均值偏差：$b_a(\\gamma) = \\mathbb{E}[m_{a} - x^{\\star}]$，其中期望 $\\mathbb{E}[\\cdot]$ 是关于观测噪声 $\\varepsilon$ 计算的。\n- 提供的数值：$H = 1$，$\\Delta H = 0.5$，$x^{\\star} = 1$，$m_{f} = 1.8$，$P_{f} = 1$，和 $R = 1$。\n- 目标是找到 $\\gamma^{\\star}  0$，使得 $b_a(\\gamma^{\\star}) = 0$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，是适定且客观的。这是数据同化理论中的一个标准练习，分析了观测算子误差和协方差膨胀之间的相互作用。该问题是自洽的，所有必要的变量和关系都已定义。定义是一致的，没有违反任何数学或物理原理。该问题是可形式化的，并且与协方差膨胀的主题直接相关。未发现任何缺陷。\n\n步骤3：结论和行动。\n问题有效。我们继续进行求解。\n\n分析均值 $m_a$ 是使用标准线性高斯（卡尔曼）更新公式计算的。由于问题是标量的，所有量都是标量。预报方差被 $\\gamma$ 膨胀，因此我们在更新方程中使用 $\\gamma P_f$。系统使用有偏算子 $\\tilde{H}$。\n\n分析均值由下式给出：\n$$m_a = m_f + K(y - \\tilde{H} m_f)$$\n其中 $K$ 是卡尔曼增益。增益是使用有偏算子 $\\tilde{H}$ 和膨胀后的预报误差方差 $\\gamma P_f$ 计算的：\n$$K = (\\gamma P_f) \\tilde{H} ( \\tilde{H} (\\gamma P_f) \\tilde{H} + R )^{-1} = \\frac{\\gamma P_f \\tilde{H}}{\\gamma P_f (\\tilde{H})^2 + R}$$\n\n分析均值偏差为 $m_a - x^{\\star}$。我们关心的是它关于观测噪声 $\\varepsilon$ 的期望。\n$$b_a(\\gamma) = \\mathbb{E}[m_a - x^{\\star}]$$\n为了计算这个值，我们首先通过将真实观测模型 $y = H x^{\\star} + \\varepsilon$ 代入 $m_a$ 的方程，将 $m_a$ 表示为真实状态 $x^{\\star}$ 和噪声 $\\varepsilon$ 的函数：\n$$m_a = m_f + K( (H x^{\\star} + \\varepsilon) - \\tilde{H} m_f )$$\n对 $\\varepsilon$ 取期望，并注意到所有其他量（$m_f, K, H, x^{\\star}, \\tilde{H}$）相对于观测噪声被认为是确定性的，我们得到：\n$$\\mathbb{E}[m_a] = \\mathbb{E}[m_f + K( H x^{\\star} + \\varepsilon - \\tilde{H} m_f )]$$\n$$\\mathbb{E}[m_a] = m_f + K( H x^{\\star} + \\mathbb{E}[\\varepsilon] - \\tilde{H} m_f )$$\n鉴于噪声是零均值的，即 $\\mathbb{E}[\\varepsilon] = 0$，上式简化为：\n$$\\mathbb{E}[m_a] = m_f + K( H x^{\\star} - \\tilde{H} m_f )$$\n那么，期望分析均值偏差为：\n$$b_a(\\gamma) = \\mathbb{E}[m_a] - x^{\\star} = (m_f - x^{\\star}) + K(H x^{\\star} - \\tilde{H} m_f)$$\n使用预报偏差的定义 $b_f = m_f - x^{\\star}$，我们有：\n$$b_a(\\gamma) = b_f + K(H x^{\\star} - \\tilde{H} m_f)$$\n为了用偏差来表示括号中的项，我们代入 $m_f = x^{\\star} + b_f$ 和 $\\tilde{H} = H + \\Delta H$：\n$$H x^{\\star} - \\tilde{H} m_f = H x^{\\star} - (H + \\Delta H)(x^{\\star} + b_f)$$\n$$= H x^{\\star} - (H x^{\\star} + H b_f + \\Delta H x^{\\star} + \\Delta H b_f)$$\n$$= - H b_f - \\Delta H x^{\\star} - \\Delta H b_f$$\n$$= -( (H + \\Delta H) b_f + \\Delta H x^{\\star} ) = -(\\tilde{H} b_f + \\Delta H x^{\\star})$$\n将此代回 $b_a(\\gamma)$ 的表达式中：\n$$b_a(\\gamma) = b_f - K(\\tilde{H} b_f + \\Delta H x^{\\star})$$\n最后，我们代入卡尔曼增益 $K$ 的表达式：\n$$b_a(\\gamma) = b_f - \\frac{\\gamma P_f \\tilde{H}}{\\gamma P_f (\\tilde{H})^2 + R} (\\tilde{H} b_f + \\Delta H x^{\\star})$$\n这就是推导出的期望分析均值偏差作为给定参数函数的表达式。\n\n现在，我们必须找到值 $\\gamma^{\\star}  0$ 使得 $b_a(\\gamma^{\\star}) = 0$。\n$$b_f - \\frac{\\gamma^{\\star} P_f \\tilde{H}}{\\gamma^{\\star} P_f (\\tilde{H})^2 + R} (\\tilde{H} b_f + \\Delta H x^{\\star}) = 0$$\n$$b_f = \\frac{\\gamma^{\\star} P_f \\tilde{H}}{\\gamma^{\\star} P_f (\\tilde{H})^2 + R} (\\tilde{H} b_f + \\Delta H x^{\\star})$$\n我们可以解出 $\\gamma^{\\star}$。\n$$b_f (\\gamma^{\\star} P_f (\\tilde{H})^2 + R) = \\gamma^{\\star} P_f \\tilde{H} (\\tilde{H} b_f + \\Delta H x^{\\star})$$\n$$b_f \\gamma^{\\star} P_f (\\tilde{H})^2 + b_f R = \\gamma^{\\star} P_f (\\tilde{H})^2 b_f + \\gamma^{\\star} P_f \\tilde{H} \\Delta H x^{\\star}$$\n项 $b_f \\gamma^{\\star} P_f (\\tilde{H})^2$ 出现在等式两边，可以消去：\n$$b_f R = \\gamma^{\\star} P_f \\tilde{H} \\Delta H x^{\\star}$$\n解出 $\\gamma^{\\star}$，我们得到一个通用表达式：\n$$\\gamma^{\\star} = \\frac{b_f R}{P_f \\tilde{H} \\Delta H x^{\\star}}$$\n该公式在分母不为零的情况下有效。\n\n现在我们代入给定的数值：\n$H = 1$，$\\Delta H = 0.5$，$x^{\\star} = 1$，$m_{f} = 1.8$，$P_{f} = 1$，$R = 1$。\n\n首先，计算相关量 $b_f$ 和 $\\tilde{H}$：\n$$b_f = m_f - x^{\\star} = 1.8 - 1 = 0.8$$\n$$\\tilde{H} = H + \\Delta H = 1 + 0.5 = 1.5$$\n\n现在，将这些值代入 $\\gamma^{\\star}$ 的表达式中：\n$$\\gamma^{\\star} = \\frac{(0.8)(1)}{(1)(1.5)(0.5)(1)} = \\frac{0.8}{0.75}$$\n$$\\gamma^{\\star} = \\frac{80}{75} = \\frac{16}{15}$$\n为了获得数值，我们进行除法运算：\n$$\\gamma^{\\star} = 1.06666...$$\n问题要求将答案四舍五入到四位有效数字。\n$$\\gamma^{\\star} \\approx 1.067$$\n该值为正，符合要求。它代表了为精确抵消由预报偏差和观测算子偏差共同引起的期望分析偏差所需的膨胀因子。",
            "answer": "$$\\boxed{1.067}$$"
        }
    ]
}