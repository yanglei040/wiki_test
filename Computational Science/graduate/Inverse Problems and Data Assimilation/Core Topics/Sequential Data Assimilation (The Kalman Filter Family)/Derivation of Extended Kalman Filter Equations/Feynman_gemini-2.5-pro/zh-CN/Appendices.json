{
    "hands_on_practices": [
        {
            "introduction": "标准的扩展卡尔曼滤波器（EKF）的精度受到其一阶泰勒级数近似的限制，在处理高度非线性模型时，这会引入显著的偏差。本实践练习要求你推导二阶EKF的量测更新方程 。通过将模型中的二阶导数（曲率）信息直接纳入计算，你将学习如何构建一个更精确的滤波器，并量化这些高阶项对滤波器增益的影响。",
            "id": "3375506",
            "problem": "考虑一个非线性贝叶斯数据同化问题中的单步测量更新。设状态为标量，其先验分布为 $x \\sim \\mathcal{N}(m, P)$，测量模型为 $y = h(x) + v$，其中 $v \\sim \\mathcal{N}(0, R)$ 且与 $x$ 独立。您的任务是，从第一性原理出发，使用二阶泰勒展开和高斯矩恒等式，推导二阶扩展卡尔曼滤波器（EKF）的测量更新量。具体而言：\n\n1. 对 $h(x)$ 在先验均值 $m$ 处进行二阶泰勒展开，推导预测测量均值和新息方差的表达式，要求精确到包含二阶导数 $h''(m)$ 的项。您必须展示 $h$ 的二阶导数如何影响新息均值和协方差，并利用高斯中心矩的性质来证明任何消失项的合理性。\n2. 证明在此阶精度下，用于计算卡尔曼增益的状态-测量互协方差仍为 $P h'(m)$。\n3. 将二阶 EKF 增益 $K_{2}$ 定义为您在第1部分中推导的互协方差与新息方差之比。\n4. 现在，将问题具体化到二次测量函数 $h(x) = c x^{2}$，其中 $c \\in \\mathbb{R}$ 是一个固定的非零常数。计算此测量模型下的 $K_{2}$，并为了比较，计算通过在一阶导数后截断展开式得到的一阶 EKF 增益 $K_{1}$。\n\n请给出比率 $K_{2}/K_{1}$ 关于 $c$、$m$、$P$ 和 $R$ 的封闭形式解析表达式作为最终答案。不需要进行数值计算，也不需要单位。请将您的最终答案表示为单个简化的代数表达式。",
            "solution": "该问题要求推导二阶扩展卡尔曼滤波器（EKF）的测量更新量，并随后计算二次测量模型下特定增益比。问题的验证证实了其科学上的合理性、适定性、客观性和完整性。我们开始进行求解。\n\n状态是一个标量随机变量 $x$，其先验高斯分布为 $x \\sim \\mathcal{N}(m, P)$，其中 $m$ 是先验均值， $P$ 是先验方差。测量模型由 $y = h(x) + v$ 给出，其中测量噪声 $v$ 也是高斯分布，$v \\sim \\mathcal{N}(0, R)$，且与 $x$ 独立。\n\n二阶 EKF 的核心是使用在先验均值 $m$ 附近的二阶泰勒级数展开来近似非线性函数 $h(x)$：\n$$\nh(x) \\approx h(m) + h'(m)(x-m) + \\frac{1}{2}h''(m)(x-m)^2\n$$\n其中 $h'(m)$ 和 $h''(m)$ 是 $h(x)$ 在 $x=m$ 处的一阶和二阶导数。\n\n### 第1部分：预测测量均值和新息方差\n\n首先，我们推导预测测量均值 $\\mu_y = E[y]$。由于 $y = h(x) + v$，且 $v$ 的均值为零并与 $x$ 独立，我们有 $E[y] = E[h(x)] + E[v] = E[h(x)]$。使用 $h(x)$ 的泰勒展开式：\n$$\n\\mu_y = E[y] \\approx E\\left[h(m) + h'(m)(x-m) + \\frac{1}{2}h''(m)(x-m)^2\\right]\n$$\n根据期望算子的线性性质：\n$$\n\\mu_y \\approx h(m) + h'(m)E[x-m] + \\frac{1}{2}h''(m)E[(x-m)^2]\n$$\n我们使用高斯分布 $x \\sim \\mathcal{N}(m, P)$ 的性质。其中心矩为：\n1.  $E[x-m] = 0$（一阶中心矩为零）。\n2.  $E[(x-m)^2] = P$（二阶中心矩是方差）。\n将这些代入 $\\mu_y$ 的表达式中：\n$$\n\\mu_y \\approx h(m) + h'(m)(0) + \\frac{1}{2}h''(m)P = h(m) + \\frac{1}{2}h''(m)P\n$$\n这表明，与一阶 EKF（其预测均值仅为 $h(m)$）相比，二阶导数 $h''(m)$ 为预测测量均值引入了一个偏差修正项 $\\frac{1}{2}h''(m)P$。\n\n接下来，我们推导新息方差 $S = \\text{Var}(y)$。由于 $x$ 和 $v$ 独立， $h(x)$ 和 $v$ 也独立。因此，它们和的方差等于它们方差的和：\n$$\nS = \\text{Var}(y) = \\text{Var}(h(x) + v) = \\text{Var}(h(x)) + \\text{Var}(v)\n$$\n我们知道 $\\text{Var}(v) = R$。我们需要计算 $\\text{Var}(h(x))$。使用定义 $\\text{Var}(Z) = E[(Z - E[Z])^2]$：\n$$\n\\text{Var}(h(x)) \\approx E\\left[ \\left( h(x) - E[h(x)] \\right)^2 \\right]\n$$\n根据我们之前关于泰勒展开和均值的结果：\n$$\nh(x) - E[h(x)] \\approx \\left(h(m) + h'(m)(x-m) + \\frac{1}{2}h''(m)(x-m)^2\\right) - \\left(h(m) + \\frac{1}{2}h''(m)P\\right)\n$$\n$$\nh(x) - E[h(x)] \\approx h'(m)(x-m) + \\frac{1}{2}h''(m)\\left((x-m)^2 - P\\right)\n$$\n现在我们将此表达式平方并取期望：\n$$\n\\text{Var}(h(x)) \\approx E\\left[ \\left( h'(m)(x-m) + \\frac{1}{2}h''(m)\\left((x-m)^2 - P\\right) \\right)^2 \\right]\n$$\n展开平方项得到三项：\n$$\nE\\left[ (h'(m))^2(x-m)^2 + h'(m)h''(m)(x-m)((x-m)^2 - P) + \\frac{1}{4}(h''(m))^2((x-m)^2 - P)^2 \\right]\n$$\n我们计算每一项的期望：\n1.  第一项： $E[(h'(m))^2(x-m)^2] = (h'(m))^2 E[(x-m)^2] = (h'(m))^2 P$。\n2.  交叉项： $E[h'(m)h''(m)(x-m)((x-m)^2 - P)] = h'(m)h''(m) \\left( E[(x-m)^3] - P E[x-m] \\right)$。对于高斯分布，所有奇数阶中心矩均为零。因此，$E[x-m]=0$ 且 $E[(x-m)^3]=0$。该项完全消失。\n3.  第三项： $E[\\frac{1}{4}(h''(m))^2((x-m)^2 - P)^2] = \\frac{1}{4}(h''(m))^2 E[(x-m)^4 - 2P(x-m)^2 + P^2]$。高斯分布的四阶中心矩是 $E[(x-m)^4] = 3P^2$。代入此值：\n    $$\n    \\frac{1}{4}(h''(m))^2 (3P^2 - 2P(P) + P^2) = \\frac{1}{4}(h''(m))^2 (2P^2) = \\frac{1}{2}(h''(m))^2 P^2\n    $$\n结合这些结果，$h(x)$ 的方差为：\n$$\n\\text{Var}(h(x)) \\approx (h'(m))^2 P + \\frac{1}{2}(h''(m))^2 P^2\n$$\n因此，总的新息方差为：\n$$\nS = \\text{Var}(y) \\approx (h'(m))^2 P + \\frac{1}{2}(h''(m))^2 P^2 + R\n$$\n二阶导数项对新息方差的贡献为 $\\frac{1}{2}(h''(m))^2 P^2$，这解释了由测量函数曲率引入的不确定性。\n\n### 第2部分：状态-测量互协方差\n\n我们需要计算互协方差 $\\text{Cov}(x, y)$。\n$$\n\\text{Cov}(x, y) = \\text{Cov}(x, h(x) + v) = \\text{Cov}(x, h(x)) + \\text{Cov}(x, v)\n$$\n由于 $x$ 和 $v$ 独立，$\\text{Cov}(x, v) = 0$。我们使用定义 $\\text{Cov}(A, B) = E[(A-E[A])(B-E[B])]$。\n$$\n\\text{Cov}(x, y) = \\text{Cov}(x, h(x)) = E[(x-m)(h(x) - E[h(x)])]\n$$\n代入 $h(x) - E[h(x)]$ 的近似表达式：\n$$\n\\text{Cov}(x, y) \\approx E\\left[ (x-m) \\left( h'(m)(x-m) + \\frac{1}{2}h''(m)\\left((x-m)^2 - P\\right) \\right) \\right]\n$$\n$$\n\\text{Cov}(x, y) \\approx E[h'(m)(x-m)^2] + E\\left[\\frac{1}{2}h''(m)(x-m)\\left((x-m)^2 - P\\right)\\right]\n$$\n1.  第一项： $E[h'(m)(x-m)^2] = h'(m)E[(x-m)^2] = h'(m)P$。\n2.  第二项： $\\frac{1}{2}h''(m) E[(x-m)^3 - P(x-m)] = \\frac{1}{2}h''(m) (E[(x-m)^3] - P E[x-m])$。如前所述，由于高斯分布的奇数阶中心矩为零，此项为 $0$。\n\n因此，在此近似阶下，互协方差为：\n$$\n\\text{Cov}(x, y) \\approx P h'(m)\n$$\n这表明，在我们所做的近似下，$h(x)$ 的二阶导数对状态-测量互协方差没有贡献。\n\n### 第3部分：二阶 EKF 增益\n\n卡尔曼增益 $K$ 是状态-测量互协方差与新息方差之比。因此，二阶 EKF 增益 $K_2$ 为：\n$$\nK_2 = \\frac{\\text{Cov}(x, y)}{S} \\approx \\frac{P h'(m)}{(h'(m))^2 P + \\frac{1}{2}(h''(m))^2 P^2 + R}\n$$\n\n### 第4部分：具体化到 $h(x) = c x^2$\n\n我们现在具体化到测量函数 $h(x) = c x^2$，其中 $c$ 是一个非零常数。我们计算在 $x=m$ 处所需的导数：\n-   $h'(x) = 2cx \\implies h'(m) = 2cm$\n-   $h''(x) = 2c \\implies h''(m) = 2c$\n\n将这些代入 $K_2$ 的表达式中：\n$$\nK_2 = \\frac{P (2cm)}{(2cm)^2 P + \\frac{1}{2}(2c)^2 P^2 + R} = \\frac{2cmP}{4c^2m^2P + \\frac{1}{2}(4c^2)P^2 + R} = \\frac{2cmP}{4c^2m^2P + 2c^2P^2 + R}\n$$\n\n为了比较，我们计算一阶 EKF 增益 $K_1$。该增益仅使用一阶泰勒展开推导，这意味着新息方差 $S_1$ 省略了包含 $h''$ 的项。\n$$\nS_1 = (h'(m))^2 P + R\n$$\n互协方差仍然是 $P h'(m)$。因此，一阶增益为：\n$$\nK_1 = \\frac{P h'(m)}{(h'(m))^2 P + R}\n$$\n代入 $h(x) = c x^2$ 的导数：\n$$\nK_1 = \\frac{P(2cm)}{(2cm)^2 P + R} = \\frac{2cmP}{4c^2m^2P + R}\n$$\n\n最后，我们计算比率 $K_2 / K_1$：\n$$\n\\frac{K_2}{K_1} = \\frac{\\frac{2cmP}{4c^2m^2P + 2c^2P^2 + R}}{\\frac{2cmP}{4c^2m^2P + R}}\n$$\n假设 $c \\neq 0$，$m \\neq 0$ 且 $P \\neq 0$，则分子 $2cmP$ 非零，可以消去：\n$$\n\\frac{K_2}{K_1} = \\frac{4c^2m^2P + R}{4c^2m^2P + 2c^2P^2 + R}\n$$\n这就是该比率的最终简化代数表达式。",
            "answer": "$$\n\\boxed{\\frac{4c^2m^2P + R}{4c^2m^2P + 2c^2P^2 + R}}\n$$"
        },
        {
            "introduction": "在实现任何滤波器之后，一个关键步骤是验证其是否正确运行，以及其基本假设是否得到满足。本实践聚焦于一个核心诊断工具：新息分析（innovation analysis）。你将探索新息序列（即实际量测与模型预测之差）的统计特性，并理解为什么将其转换为“白化新息”（whitened innovation）能为滤波器的统计自洽性提供一个强有力的检验。",
            "id": "3375490",
            "problem": "考虑数据同化中使用的非线性离散时间状态空间模型，\n$$\nx_k = f(x_{k-1}) + w_k,\\quad y_k = h(x_k) + v_k,\n$$\n其中 $x_k \\in \\mathbb{R}^n$ 是状态，$y_k \\in \\mathbb{R}^m$ 是观测，$f$ 和 $h$ 是可微映射，$w_k \\sim \\mathcal{N}(0,Q_k)$ 是过程噪声，$v_k \\sim \\mathcal{N}(0,R_k)$ 是观测噪声。假设 $w_k$ 和 $v_k$ 相互独立，且与过去的状态和观测独立。在扩展卡尔曼滤波器（EKF）中，我们处理预测（先验）状态分布 $x_k \\mid y_{1:k-1}$，该分布被近似为均值为 $\\hat{x}_k^{-}$、协方差为 $P_k^{-}$ 的高斯分布，并对观测模型 $h$ 在 $\\hat{x}_k^{-}$ 附近进行一阶线性化。\n\n定义时刻 $k$ 的新息为\n$$\nr_k = y_k - h(\\hat{x}_k^{-}),\n$$\n并令 $S_k$ 表示在 EKF 线性化和高斯假设下 $r_k$ 的协方差。定义白化新息\n$$\nz_k = S_k^{-1/2}\\, r_k,\n$$\n其中 $S_k^{-1/2}$ 是满足 $S_k^{-1/2}\\, S_k\\, S_k^{-1/2} = I_m$ 的任意矩阵，而 $I_m$ 是 $m \\times m$ 的单位矩阵。\n\n在 EKF 的假设下，哪个选项正确解释了为何 $z_k$ 近似服从标准正态分布，并指出了相关的协方差结构？\n\nA. 在 $w_k$ 和 $v_k$ 的独立性和高斯假设下，并进行一阶线性化 $h(x_k) \\approx h(\\hat{x}_k^{-}) + H_k (x_k - \\hat{x}_k^{-})$（其中 $H_k = \\nabla h(\\hat{x}_k^{-})$），新息满足 $r_k \\approx H_k (x_k - \\hat{x}_k^{-}) + v_k$，其均值为 $0$，协方差为 $S_k = H_k P_k^{-} H_k^\\top + R_k$。由于 $r_k$ 近似为高斯分布，应用 $S_k^{-1/2}$ 可得 $z_k$ 近似服从 $\\mathcal{N}(0, I_m)$ 分布。\n\nB. 无论 $h$ 的非线性程度如何，中心极限定理确保 $r_k$ 精确地服从高斯分布，因此对于任意 $S_k$，$z_k$ 都精确地服从 $\\mathcal{N}(0, I_m)$ 分布。\n\nC. 正确的白化是 $z_k = S_k^{-1}\\, r_k$，这保证了 $\\operatorname{Cov}(z_k) = I_m$，因此 $z_k \\sim \\mathcal{N}(0, I_m)$。\n\nD. 新息协方差为 $S_k = P_k^{-} + R_k$，所以在乘以 $S_k^{-1/2}$ 后，$z_k$ 近似服从标准正态分布。\n\nE. 为使 $z_k$ 近似服从标准正态分布，过程噪声协方差必须满足 $Q_k = 0$；否则，$z_k$ 无法被白化以获得单位协方差。",
            "solution": "用户希望我验证关于扩展卡尔曼滤波器（EKF）中白化新息性质的问题陈述，然后从选项列表中找出正确的解释。\n\n### 第 1 步：提取已知条件\n- 状态空间模型：\n  - 状态方程：$x_k = f(x_{k-1}) + w_k$\n  - 观测方程：$y_k = h(x_k) + v_k$\n- 变量和函数定义：\n  - $x_k \\in \\mathbb{R}^n$：时刻 $k$ 的状态向量。\n  - $y_k \\in \\mathbb{R}^m$：时刻 $k$ 的观测向量。\n  - $f, h$：可微映射。\n- 噪声特性：\n  - 过程噪声：$w_k \\sim \\mathcal{N}(0, Q_k)$。\n  - 观测噪声：$v_k \\sim \\mathcal{N}(0, R_k)$。\n  - 独立性：$w_k$ 和 $v_k$ 相互独立，且与过去的状态和观测独立。\n- EKF 假设：\n  - 状态的预测（先验）分布 $x_k \\mid y_{1:k-1}$ 被近似为均值为 $\\hat{x}_k^{-}$、协方差为 $P_k^{-}$ 的高斯分布。\n  - 使用对观测模型 $h$ 在 $\\hat{x}_k^{-}$ 附近的一阶线性化。\n- 定义：\n  - 新息：$r_k = y_k - h(\\hat{x}_k^{-})$。\n  - 新息协方差：$S_k = \\operatorname{Cov}(r_k)$，在 EKF 假设下。\n  - 白化新息：$z_k = S_k^{-1/2}\\, r_k$。\n  - 矩阵平方根的逆：$S_k^{-1/2}$ 是一个矩阵，满足 $S_k^{-1/2}\\, S_k\\, S_k^{-1/2} = I_m$，其中 $I_m$ 是 $m \\times m$ 的单位矩阵。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题陈述在科学上是合理且表述清晰的。它提出了非线性离散时间系统的标准形式，并询问应用于该系统的扩展卡尔曼滤波器的一个基本性质，即白化新息序列的统计特性。所有术语（$f, h, w_k, v_k, \\hat{x}_k^{-}, P_k^{-}$）都以标准且数学上精确的方式定义。问题清晰、客观，直接涉及 EKF 的核心概念。该问题没有违反任何科学有效性、完整性或客观性原则。这是反演问题和数据同化领域的一个标准问题。\n\n### 第 3 步：结论和行动\n问题有效。我将进行推导和选项分析。\n\n### 推导\n目标是确定白化新息 $z_k$ 的近似分布。这需要首先求出新息 $r_k$ 的近似均值和协方差。\n\n1.  **新息表达式**：新息定义为 $r_k = y_k - h(\\hat{x}_k^{-})$。代入观测模型 $y_k = h(x_k) + v_k$，我们得到：\n    $$r_k = (h(x_k) + v_k) - h(\\hat{x}_k^{-})$$\n\n2.  **线性化**：EKF 使用围绕先验状态估计 $\\hat{x}_k^{-}$ 的一阶泰勒展开来近似非线性函数 $h(x_k)$：\n    $$h(x_k) \\approx h(\\hat{x}_k^{-}) + H_k (x_k - \\hat{x}_k^{-})$$\n    其中 $H_k = \\frac{\\partial h}{\\partial x} \\Big|_{x=\\hat{x}_k^{-}}$ 是 $h$ 在 $\\hat{x}_k^{-}$ 处求值的雅可比矩阵。\n\n3.  **近似新息**：将线性化结果代入 $r_k$ 的表达式中：\n    $$r_k \\approx (h(\\hat{x}_k^{-}) + H_k (x_k - \\hat{x}_k^{-})) + v_k - h(\\hat{x}_k^{-})$$\n    $$r_k \\approx H_k (x_k - \\hat{x}_k^{-}) + v_k$$\n    我们定义先验误差为 $e_k^{-} = x_k - \\hat{x}_k^{-}$。那么，$r_k \\approx H_k e_k^{-} + v_k$。\n\n4.  **新息的均值**：我们计算 $r_k$ 的期望值。根据定义，$\\hat{x}_k^{-}$ 是 $x_k$ 的近似分布的均值，因此先验误差的期望值近似为零：$E[e_k^{-}] = E[x_k - \\hat{x}_k^{-}] \\approx \\hat{x}_k^{-} - \\hat{x}_k^{-} = 0$。观测噪声 $v_k$ 给定为零均值，$E[v_k]=0$。\n    $$E[r_k] \\approx E[H_k e_k^{-} + v_k] = H_k E[e_k^{-}] + E[v_k] \\approx H_k \\cdot 0 + 0 = 0$$\n    新息是一个近似零均值的随机变量。\n\n5.  **新息的协方差**：新息的协方差 $S_k$ 是使用 $r_k$ 的近似表达式求得的。\n    $$S_k = \\operatorname{Cov}(r_k) \\approx \\operatorname{Cov}(H_k e_k^{-} + v_k)$$\n    先验状态 $x_k$（以及误差 $e_k^{-}$）是过去状态和噪声（$w_{k-1}, w_{k-2}, \\dots$）的函数。假设它与当前的观测噪声 $v_k$ 独立。因此，和的协方差等于协方差的和：\n    $$S_k \\approx \\operatorname{Cov}(H_k e_k^{-}) + \\operatorname{Cov}(v_k)$$\n    使用协方差的性质 $\\operatorname{Cov}(AX) = A \\operatorname{Cov}(X) A^\\top$，我们有：\n    $$ \\operatorname{Cov}(H_k e_k^{-}) = H_k \\operatorname{Cov}(e_k^{-}) H_k^\\top $$\n    根据先验协方差矩阵的定义，$\\operatorname{Cov}(e_k^{-}) = \\operatorname{Cov}(x_k - \\hat{x}_k^{-}) = P_k^{-}$。观测噪声的协方差给定为 $\\operatorname{Cov}(v_k) = R_k$。\n    将这些结合起来，我们得到新息协方差：\n    $$S_k \\approx H_k P_k^{-} H_k^\\top + R_k$$\n\n6.  **新息和白化新息的分布**：在 EKF 假设下，先验状态 $x_k$ 由高斯分布 $\\mathcal{N}(\\hat{x}_k^{-}, P_k^{-})$ 近似，这意味着先验误差 $e_k^{-}$ 近似服从 $\\mathcal{N}(0, P_k^{-})$。观测噪声 $v_k$ 给定为 $\\mathcal{N}(0, R_k)$。由于 $r_k$ 是这两个（近似）高斯变量的近似线性组合，因此 $r_k$ 本身也近似服从高斯分布：\n    $$r_k \\sim \\mathcal{N}(0, S_k) \\quad \\text{近似地}$$\n    白化新息为 $z_k = S_k^{-1/2} r_k$。对于任意均值为 $\\mu$、协方差为 $S$ 的随机向量 $r$，变换后的向量 $z = M r$ 的均值为 $M \\mu$，协方差为 $M S M^\\top$。\n    这里，$\\mu \\approx 0$ 且 $S \\approx S_k$。变换矩阵为 $M = S_k^{-1/2}$。\n    $$E[z_k] = S_k^{-1/2} E[r_k] \\approx S_k^{-1/2} \\cdot 0 = 0$$\n    $$\\operatorname{Cov}(z_k) = S_k^{-1/2} \\operatorname{Cov}(r_k) (S_k^{-1/2})^\\top \\approx S_k^{-1/2} S_k (S_k^{-1/2})^\\top$$\n    问题陈述定义了 $S_k^{-1/2}$ 满足 $S_k^{-1/2}\\, S_k\\, S_k^{-1/2} = I_m$。如果我们假设 $S_k^{-1/2}$ 是对称的（矩阵平方根的标准选择），那么 $(S_k^{-1/2})^\\top = S_k^{-1/2}$，并且 $\\operatorname{Cov}(z_k) \\approx I_m$。\n    由于 $z_k$ 是近似高斯分布的 $r_k$ 的线性变换，所以 $z_k$ 也近似服从高斯分布。因此，$z_k$ 近似服从标准正态分布：\n    $$z_k \\sim \\mathcal{N}(0, I_m) \\quad \\text{近似地}$$\n\n### 逐项分析\n\n**A. 在 $w_k$ 和 $v_k$ 的独立性和高斯假设下，并进行一阶线性化 $h(x_k) \\approx h(\\hat{x}_k^{-}) + H_k (x_k - \\hat{x}_k^{-})$（其中 $H_k = \\nabla h(\\hat{x}_k^{-})$），新息满足 $r_k \\approx H_k (x_k - \\hat{x}_k^{-}) + v_k$，其均值为 $0$，协方差为 $S_k = H_k P_k^{-} H_k^\\top + R_k$。由于 $r_k$ 近似为高斯分布，应用 $S_k^{-1/2}$ 可得 $z_k$ 近似服从 $\\mathcal{N}(0, I_m)$ 分布。**\n该陈述准确地总结了整个推导过程。它正确地说明了 $r_k$ 的线性化近似、其产生的近似均值和协方差 $S_k$、其近似高斯性质以及白化新息 $z_k$ 的最终分布。每个步骤都与扩展卡尔曼滤波器的标准理论一致。\n**结论：正确**\n\n**B. 无论 $h$ 的非线性程度如何，中心极限定理确保 $r_k$ 精确地服从高斯分布，因此对于任意 $S_k$，$z_k$ 都精确地服从 $\\mathcal{N}(0, I_m)$ 分布。**\n该陈述在多个方面都是不正确的。首先，由于 $h$ 的线性化和先验状态分布的近似， $r_k$ 的分布只是*近似*高斯分布。对于高度非线性的 $h$，这种近似可能很差。其次，通过中心极限定理进行论证是完全错误的；中心极限定理涉及许多独立随机变量的和，这并非新息的结构。第三，声称结果是“精确”高斯分布是不正确的。第四，白化性质需要一个特定的 $S_k$，即 $r_k$ 的协方差，而不是“任意 $S_k$”。\n**结论：不正确**\n\n**C. 正确的白化是 $z_k = S_k^{-1}\\, r_k$，这保证了 $\\operatorname{Cov}(z_k) = I_m$，因此 $z_k \\sim \\mathcal{N}(0, I_m)$。**\n该陈述提出了一个不正确的白化变换。如果 $z_k = S_k^{-1} r_k$，则协方差为 $\\operatorname{Cov}(z_k) = S_k^{-1} \\operatorname{Cov}(r_k) (S_k^{-1})^\\top \\approx S_k^{-1} S_k (S_k^{-1})^\\top = (S_k^{-1})^\\top = S_k^{-1}$，因为 $S_k$ 是对称的。得到的协方差是 $S_k^{-1}$，而不是 $I_m$。正确的变换涉及矩阵平方根的逆 $S_k^{-1/2}$，而不是常规的逆 $S_k^{-1}$。\n**结论：不正确**\n\n**D. 新息协方差为 $S_k = P_k^{-} + R_k$，所以在乘以 $S_k^{-1/2}$ 后，$z_k$ 近似服从标准正态分布。**\n此选项提供了不正确的新息协方差公式。正确的公式 $S_k = H_k P_k^{-} H_k^\\top + R_k$ 解释了状态误差协方差 $P_k^{-}$ 通过雅可比矩阵 $H_k$ 到观测空间的转换。简化的形式 $S_k = P_k^{-} + R_k$ 仅在观测模型为线性 $h(x_k) = x_k$（即 $H_k = I$ 且 $n=m$）时有效。对于一般的非线性 $h$，这是错误的。\n**结论：不正确**\n\n**E. 为使 $z_k$ 近似服从标准正态分布，过程噪声协方差必须满足 $Q_k = 0$；否则，$z_k$ 无法被白化以获得单位协方差。**\n该陈述是错误的。过程噪声协方差 $Q_k$（更准确地说是 $Q_{k-1}$）通过预测步骤对先验状态协方差 $P_k^{-}$ 产生影响：$P_k^{-} = F_{k-1} P_{k-1}^{+} F_{k-1}^\\top + Q_{k-1}$。一个非零的 $Q_{k-1}$ 对于滤波器考虑模型不确定性并防止发散至关重要。过程噪声的存在并不妨碍对新息进行白化的数学操作。白化过程适用于任何良定义（即可逆）的新息协方差矩阵 $S_k$，而 $Q_{k-1}$ 的值只是通过 $P_k^{-}$ 影响 $S_k$ 的数值。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然标准的基于协方差的EKF在概念上很清晰，但其计算和内存成本使其不适用于气象预报或机器人等领域中具有数百万变量的大规模系统。本练习介绍了一种替代方案——信息滤波器（Information Filter），它通常在处理具有稀疏结构的大规模问题时效率更高 。你将分析这种形式如何利用系统稀疏性来实现可行的计算，从而使数据同化能够应用于高维度的现实世界问题。",
            "id": "3375519",
            "problem": "考虑在标准数据同化假设下，$k$ 时刻的扩展卡尔曼滤波器 (EKF) 测量更新：一个高斯先验状态，其均值为 $\\,\\hat{x}_{k\\mid k-1}\\,$，协方差为 $\\,P_{k\\mid k-1}\\,$；一个非线性观测模型 $\\,y_k = h_k(x_k) + v_k\\,$，其中 $\\,v_k \\sim \\mathcal{N}(0, R_k)\\,$；以及 $\\,h_k(\\cdot)\\,$ 在预测状态 $\\,\\hat{x}_{k\\mid k-1}\\,$ 附近的线性化，得到雅可比矩阵 $\\,H_k = \\left.\\frac{\\partial h_k}{\\partial x}\\right|_{\\hat{x}_{k\\mid k-1}}\\,$。假设 $\\,H_k\\,$ 是稀疏的，$\\,R_k\\,$ 是块对角的，其块 $\\,R_k^{(i)}\\,$ 对应于不相交的测量子集。你的推理必须从高斯模型的贝叶斯法则、线性化性质以及稀疏线性代数出发，而不是从任何预先给出的 EKF 更新公式出发。\n\n在所述的稀疏性和块结构假设下，下列哪个陈述正确描述了 EKF 测量更新的信息（正则）形式在内存占用和分解方面的计算优势？\n\nA. 在信息形式中，测量更新为先验精度贡献一个加性项，其稀疏性由 $\\,H_k^\\top R_k^{-1} H_k\\,$ 决定；当 $\\,H_k\\,$ 是稀疏的且 $\\,R_k\\,$ 是块对角时，该贡献项是稀疏的，从而能够进行稀疏 Cholesky 分解，与协方差形式下的操作相比，减少了填充并降低了内存使用。\n\nB. 在协方差形式中，只要 $\\,R_k\\,$ 是块对角的，新息协方差 $\\,S_k = H_k P_{k\\mid k-1} H_k^\\top + R_k\\,$ 就可以在没有块间耦合的情况下逐块求逆，因此协方差形式在测量更新方面享有与信息形式相同的逐块并行性。\n\nC. 信息形式允许对测量块进行流式同化：可以累积形如 $\\,H_k^{(i)\\top} {R_k^{(i)}}^{-1} H_k^{(i)}\\,$ 和 $\\,H_k^{(i)\\top} {R_k^{(i)}}^{-1} y_k^{(i)}\\,$ 的逐块贡献，而无需保留完整的测量向量，从而在保持稀疏性的同时减少峰值内存占用。\n\nD. 如果 $\\,H_k\\,$ 是稀疏的，那么协方差形式中的卡尔曼增益 $\\,K_k\\,$ 保证是稀疏的，因此协方差形式的更新具有与信息形式相当的内存和分解优势。\n\nE. 对于动力学中具有稀疏马尔可夫结构的大规模模型，先验精度 $\\,P_{k\\mid k-1}^{-1}\\,$ 通常是稀疏的；在信息形式中，分解更新后的精度矩阵时可以跨时间重用符号稀疏模式，从而分摊分解成本。这种重用在协方差形式中通常不可用，因为在测量更新下 $\\,P_{k\\mid k}\\,$ 趋于稠密化。\n\n选择所有适用项。",
            "solution": "问题陈述的有效性得到确认。背景是在数据同化中使用的标准扩展卡尔曼滤波器（EKF）。关于高斯先验、非线性观测模型，以及雅可比矩阵（$H_k$）和观测误差协方差（$R_k$）的特定稀疏性/块对角结构的假设，都是明确定义的，并且在大规模应用中很常见。问题是客观的，其解决需要基于第一性原理的严格数学推导，这是一个适定（well-posed）的任务。\n\n我们首先从贝叶斯法则推导测量更新方程。$k$ 时刻状态 $x_k$ 的后验概率，在给定直到 $k$ 时刻的所有测量值的条件下，与测量值 $y_k$ 的似然和状态 $x_k$ 的先验概率的乘积成正比：\n$$p(x_k | y_{1:k}) \\propto p(y_k | x_k) \\, p(x_k | y_{1:k-1})$$\n先验分布给定为高斯分布：$p(x_k | y_{1:k-1}) = \\mathcal{N}(x_k; \\hat{x}_{k|k-1}, P_{k|k-1})$。\n似然由观测模型 $y_k = h_k(x_k) + v_k$（其中 $v_k \\sim \\mathcal{N}(0, R_k)$）导出，因此 $p(y_k | x_k) = \\mathcal{N}(y_k; h_k(x_k), R_k)$。\n\n由于我们处理的是高斯分布，使用概率的负对数会很方便。后验负对数似然（在相差一个常数的情况下）是先验和似然的负对数似然之和：\n$$J(x_k) = \\frac{1}{2} (x_k - \\hat{x}_{k|k-1})^\\top P_{k|k-1}^{-1} (x_k - \\hat{x}_{k|k-1}) + \\frac{1}{2} (y_k - h_k(x_k))^\\top R_k^{-1} (y_k - h_k(x_k))$$\nEKF 将非线性函数 $h_k(x_k)$ 在先验均值 $\\hat{x}_{k|k-1}$ 附近进行线性化：\n$$h_k(x_k) \\approx h_k(\\hat{x}_{k|k-1}) + H_k (x_k - \\hat{x}_{k|k-1})$$\n其中 $H_k = \\left.\\frac{\\partial h_k}{\\partial x}\\right|_{\\hat{x}_{k|k-1}}$。将此代入代价函数 $J(x_k)$，得到 EKF 的近似后验负对数似然：\n$$J(x_k) \\approx \\frac{1}{2} (x_k - \\hat{x}_{k|k-1})^\\top P_{k|k-1}^{-1} (x_k - \\hat{x}_{k|k-1}) + \\frac{1}{2} (y_k - h_k(\\hat{x}_{k|k-1}) - H_k(x_k - \\hat{x}_{k|k-1}))^\\top R_k^{-1} (y_k - h_k(\\hat{x}_{k|k-1}) - H_k(x_k - \\hat{x}_{k|k-1}))$$\n这个代价函数是关于 $x_k$ 的二次函数，这意味着后验分布是高斯分布，$p(x_k|y_{1:k}) \\approx \\mathcal{N}(x_k; \\hat{x}_{k|k}, P_{k|k})$。后验均值 $\\hat{x}_{k|k}$ 是使 $J(x_k)$ 最小化的 $x_k$ 的值，后验协方差 $P_{k|k}$ 是 $J(x_k)$ 的 Hessian 矩阵的逆。\n\n**信息形式的推导**\n滤波器的信息形式传递的是精度矩阵 $Y = P^{-1}$ 和信息向量 $\\eta = Y\\hat{x} = P^{-1}\\hat{x}$。设先验精度为 $Y_{k|k-1} = P_{k|k-1}^{-1}$，先验信息向量为 $\\eta_{k|k-1} = Y_{k|k-1}\\hat{x}_{k|k-1}$。\n$J(x_k)$ 关于 $x_k$ 的 Hessian 矩阵就是后验精度矩阵 $Y_{k|k} = P_{k|k}^{-1}$：\n$$\\frac{\\partial^2 J(x_k)}{\\partial x_k^2} = Y_{k|k} = P_{k|k-1}^{-1} + H_k^\\top R_k^{-1} H_k = Y_{k|k-1} + H_k^\\top R_k^{-1} H_k$$\n这个方程表明，精度矩阵的测量更新是加性的。来自测量的贡献是 $\\Delta Y_k = H_k^\\top R_k^{-1} H_k$。\n后验信息向量 $\\eta_{k|k}$ 可以通过展开 $J(x_k)$ 中关于 $x_k$ 的线性项来找到。$J(x_k)$ 的最小值在 $\\nabla_{x_k} J(x_k) = 0$ 处找到。\n$\\nabla_{x_k} J(x_k) = Y_{k|k} x_k - \\eta_{k|k} = 0$。\n从 $J(x_k)$ 的表达式中，我们可以识别出项来找到 $\\eta_{k|k}$：\n$$\\eta_{k|k} = P_{k|k-1}^{-1}\\hat{x}_{k|k-1} + H_k^\\top R_k^{-1}( y_k - h_k(\\hat{x}_{k|k-1}) + H_k\\hat{x}_{k|k-1})$$\n$$\\eta_{k|k} = \\eta_{k|k-1} + \\Delta\\eta_k, \\quad \\text{其中 } \\Delta\\eta_k = H_k^\\top R_k^{-1}( y_k - h_k(\\hat{x}_{k|k-1}) + H_k\\hat{x}_{k|k-1})$$\n更新是一个简单的加法。通过求解线性系统 $Y_{k|k} \\hat{x}_{k|k} = \\eta_{k|k}$ 来恢复后验状态。\n\n**协方差形式的推导**\n标准的协方差形式方程可以从信息形式方程通过对 $P_{k|k} = (P_{k|k-1}^{-1} + H_k^\\top R_k^{-1} H_k)^{-1}$ 使用 Sherman-Morrison-Woodbury 矩阵求逆引理来推导。这得到：\n$$P_{k|k} = (I - K_k H_k) P_{k|k-1}$$\n其中卡尔曼增益 $K_k$ 由下式给出：\n$$K_k = P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top + R_k)^{-1}$$\n状态更新则为：\n$$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k (y_k - h_k(\\hat{x}_{k|k-1}))$$\n项 $S_k = H_k P_{k|k-1} H_k^\\top + R_k$ 是新息协方差。\n\n在完成这些推导之后，我们现在评估每个选项。\n\n**选项 A 评估**\n该陈述声称，在信息形式中，测量更新为先验精度增加了一个项 $H_k^\\top R_k^{-1} H_k$，当 $H_k$ 是稀疏的且 $R_k$ 是块对角时，该项是稀疏的，从而能够进行高效的稀疏分解。\n我们的推导证实了更新方程：$Y_{k|k} = Y_{k|k-1} + H_k^\\top R_k^{-1} H_k$。\n稀疏性分析：\n- 根据假设，$H_k$ 是稀疏的。\n- $R_k$ 是块对角的，因此其逆 $R_k^{-1}$ 也是块对角的，因此是稀疏的。\n- 矩阵 $H_k^\\top R_k^{-1} H_k$ 的稀疏模式取决于哪些状态变量对 $(x_i, x_j)$ 被同一个测量所观测。如果每个测量（$H_k$ 的每一行）只涉及少数几个状态变量（很少的非零元），那么这种共同观测的对的数量就很少。这使得最终的矩阵 $H_k^\\top R_k^{-1} H_k$ 是稀疏的。\n如果先验精度 $Y_{k|k-1}$ 也是稀疏的（这是系统动力学中局部相互作用的常见结果），那么后验精度 $Y_{k|k}$ 是两个稀疏矩阵之和，因此也是稀疏的。求解系统 $Y_{k|k} \\hat{x}_{k|k} = \\eta_{k|k}$ 可以使用稀疏 Cholesky 分解高效完成，其计算成本和内存占用远低于稠密矩阵分解，特别是当通过重排序算法最小化填充时。相比之下，协方差矩阵 $P_{k|k-1}$ 作为稀疏矩阵的逆，通常是稠密的，这使得协方差形式的计算成本更高。该陈述与我们的推导和对稀疏线性代数的理解完全一致。\n结论：**正确**。\n\n**选项 B 评估**\n该陈述声称协方差形式享有逐块并行性，因为当 $R_k$ 是块对角时，新息协方差 $S_k = H_k P_{k|k-1} H_k^\\top + R_k$ 可以逐块求逆。\n稀疏矩阵（例如，$P_{k|k-1}^{-1}$）的逆通常是一个稠密矩阵。因此，先验协方差 $P_{k|k-1}$ 通常是稠密的。乘积 $H_k P_{k|k-1} H_k^\\top$ 涉及一个稠密矩阵 $P_{k|k-1}$，因此其本身也将是稠密的。将块对角矩阵 $R_k$ 加到稠密矩阵 $H_k P_{k|k-1} H_k^\\top$ 上，会得到一个稠密矩阵 $S_k$。一个通用的稠密矩阵不能逐块求逆。由于 $P_{k|k-1}$ 引入的耦合， $R_k$ 的块对角结构在求和中丢失了。相比之下，信息更新是来自测量块的贡献之和，这允许并行或顺序处理。因此，该说法是错误的。\n结论：**不正确**。\n\n**选项 C 评估**\n该陈述声称信息形式允许通过累积逐块贡献来对测量块进行流式同化，从而减少峰值内存。\n假设测量值被划分为不相交的块，即 $y_k = [y_k^{(i)\\top}]^\\top$，$H_k = [H_k^{(i)\\top}]^\\top$，$R_k = \\text{diag}(R_k^{(i)})$。对信息矩阵的加性贡献为 $\\Delta Y_k = H_k^\\top R_k^{-1} H_k$。这可以写成各块之和：\n$$\\Delta Y_k = \\sum_{i} H_k^{(i)\\top} (R_k^{(i)})^{-1} H_k^{(i)}$$\n类似地，信息向量更新中与测量相关的部分 $\\Delta\\eta_k^{data} = H_k^\\top R_k^{-1} y_k$，也可以写成一个和：\n$$\\Delta\\eta_k^{data} = \\sum_{i} H_k^{(i)\\top} (R_k^{(i)})^{-1} y_k^{(i)}$$\n完整的信息向量更新也可以逐块分解和累积。这种结构证明了可以遍历测量块，计算它们对 $Y_{k|k}$ 和 $\\eta_{k|k}$ 的各自贡献，并将它们加到一个运行总和中。在任何时候，除了全状态信息矩阵和向量外，只需要将单个块的数据（$y_k^{(i)}$, $H_k^{(i)}$, $R_k^{(i)}$）保留在活动内存中。这种“流式”或“顺序”更新显著减少了所需的峰值内存，因为不需要组装完整的测量向量 $y_k$ 和雅可比矩阵 $H_k$。\n结论：**正确**。\n\n**选项 D 评估**\n该陈述声称如果 $H_k$ 是稀疏的，卡尔曼增益 $K_k$ 保证是稀疏的。\n卡尔曼增益为 $K_k = P_{k|k-1} H_k^\\top S_k^{-1}$。正如在选项 A 和 B 的评估中确立的，先验协方差 $P_{k|k-1}$ 通常是一个稠密矩阵。一个稠密矩阵（$P_{k|k-1}$）和一个稀疏矩阵（$H_k^\\top$）的乘积通常是稠密的。此外，新息协方差 $S_k$ 通常也是稠密的，使其逆 $S_k^{-1}$ 也是稠密的。两个稠密矩阵 $(P_{k|k-1} H_k^\\top)$ 和 $S_k^{-1}$ 的乘积是稠密的。因此，卡尔曼增益 $K_k$ 不是稀疏的；它通常是一个稠密矩阵。该陈述的前提是错误的。\n结论：**不正确**。\n\n**选项 E 评估**\n该陈述假设，对于具有稀疏马尔可夫结构的系统，先验精度 $P_{k|k-1}^{-1}$ 通常是稀疏的，并且信息形式允许在跨时间进行 Cholesky 分解时重用符号稀疏模式，这在协方差形式中是不可能的。\n动力学中的稀疏马尔可夫结构（例如，稀疏的状态转移矩阵）通常会导致稀疏的先验精度矩阵 $Y_{k|k-1} = P_{k|k-1}^{-1}$，因为条件依赖性保持局部性。后验精度为 $Y_{k|k} = Y_{k|k-1} + H_k^\\top R_k^{-1} H_k$。$Y_{k|k}$ 的稀疏模式是 $Y_{k|k-1}$ 和 $H_k^\\top R_k^{-1} H_k$ 模式的并集。如果系统和观测结构是平稳的或周期性的，那么这个最终的模式可以是静态的，或者由一个已知的静态模式界定。稀疏 Cholesky 分解中计算密集型的步骤是排序和符号分解（确定因子的非零模式）。如果矩阵模式是静态的，这些步骤可以执行一次，并在所有后续时间步中重用，从而分摊其成本。只需要重复成本较低的数值分解。在协方差形式中，操作对象是协方差矩阵 $P_{k|k}$，它是 $Y_{k|k}$ 的逆，通常是稠密的。没有可以利用的稀疏结构，因此重用符号分解的概念不适用。该陈述是对信息滤波器在大型时序应用中的一个主要计算优势的正确而精辟的描述。\n结论：**正确**。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}