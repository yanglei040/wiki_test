{
    "hands_on_practices": [
        {
            "introduction": "许多物理系统，如车辆或航天器的运动，本质上是用连续时间微分方程来描述的。然而，卡尔曼滤波器在数字计算机上实现时，需要一个离散时间的模型。这个练习将引导你完成一个至关重要的转换过程：将一个由连续白噪声驱动的系统，精确地转换为其离散时间的等效形式，特别是推导离散过程噪声协方差矩阵 $Q_d$。掌握这一技能是将在物理系统上应用卡尔曼滤波器的基础。",
            "id": "2753297",
            "problem": "使用离散时间卡尔曼滤波器（KF）对一个一维点质量进行状态估计建模。其连续时间运动学由位置 $p(t)$ 和速度 $v(t)$ 定义，动力学方程为\n$$\\frac{d}{dt}\\begin{pmatrix} p(t) \\\\ v(t) \\end{pmatrix} = \\underbrace{\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}}_{F} \\begin{pmatrix} p(t) \\\\ v(t) \\end{pmatrix} + \\underbrace{\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}}_{L} a(t),$$\n其中 $a(t)$ 是一个零均值、标量、白高斯加速度过程，其单边功率谱密度为常数 $q$，单位为 $\\mathrm{m}^{2}\\mathrm{s}^{-3}$。系统以周期 $\\Delta t = 0.1\\,\\mathrm{s}$ 进行采样。测量模型仅包含位置，其模型为\n$$y_{k} = \\underbrace{\\begin{pmatrix}1  0\\end{pmatrix}}_{H} \\begin{pmatrix} p_{k} \\\\ v_{k} \\end{pmatrix} + r_{k},$$\n其中 $r_{k}$ 是零均值白高斯测量噪声，其方差为 $R = \\mathrm{diag}(0.04)$，单位为 $\\mathrm{m}^{2}$。\n\n从线性时不变状态转移概念出发，并根据连续时间白高斯过程噪声在有限采样间隔内如何通过连续时间系统传播的定义，推导由白噪声加速度驱动的采样系统的离散时间过程噪声协方差矩阵 $Q_{d}$。然后，使用 $q = 0.5$ 和 $\\Delta t = 0.1\\,\\mathrm{s}$ 数值计算 $Q_{d}$。\n\n所有量均使用国际单位制（SI）（米和秒）。以数值形式报告 $Q_{d}$ 的各项，并将每项四舍五入到四位有效数字。最终答案中不要包含单位。",
            "solution": "所述问题提法恰当，有科学依据，并为获得唯一解提供了所有必要信息。我们开始推导。\n\n系统的连续时间动力学由以下线性时不变（LTI）随机微分方程给出：\n$$ \\frac{d}{dt} x(t) = F x(t) + L w(t) $$\n其中状态向量为 $x(t) = \\begin{pmatrix} p(t) \\\\ v(t) \\end{pmatrix}$，状态动力学矩阵为 $F = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$，噪声输入矩阵为 $L = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，且 $w(t) = a(t)$ 是零均值的连续时间白高斯噪声，其功率谱密度（PSD）为 $q$。该噪声过程的自相关为 $E[w(t)w(\\tau)] = q \\delta(t-\\tau)$，其中 $\\delta(\\cdot)$ 是狄拉克δ函数。\n\n该微分方程的解，即将状态从时间 $t_k$ 传播到 $t_{k+1} = t_k + \\Delta t$ 的解，由常数变易法公式给出：\n$$ x(t_{k+1}) = e^{F(t_{k+1}-t_k)} x(t_k) + \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau)} L w(\\tau) d\\tau $$\n这可以写成标准离散时间形式 $x_{k+1} = A_d x_k + w_{dk}$，其中 $x_k \\equiv x(t_k)$，离散时间状态转移矩阵为 $A_d = e^{F\\Delta t}$，离散时间过程噪声向量为：\n$$ w_{dk} = \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau)} L w(\\tau) d\\tau $$\n目标是求出这个离散时间过程噪声的协方差矩阵 $Q_d$，定义为 $Q_d = E[w_{dk}w_{dk}^T]$。\n\n我们计算期望值：\n$$ Q_d = E\\left[ \\left( \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau_1)} L w(\\tau_1) d\\tau_1 \\right) \\left( \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau_2)} L w(\\tau_2) d\\tau_2 \\right)^T \\right] $$\n$$ Q_d = E\\left[ \\int_{t_k}^{t_{k+1}} \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau_1)} L w(\\tau_1) w(\\tau_2) L^T e^{F^T(t_{k+1}-\\tau_2)} d\\tau_1 d\\tau_2 \\right] $$\n通过将期望算子移到积分内部，并使用性质 $E[w(\\tau_1)w(\\tau_2)] = q \\delta(\\tau_1-\\tau_2)$，我们得到：\n$$ Q_d = \\int_{t_k}^{t_{k+1}} \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau_1)} L (q \\delta(\\tau_1-\\tau_2)) L^T e^{F^T(t_{k+1}-\\tau_2)} d\\tau_1 d\\tau_2 $$\n使用狄拉克δ函数的筛选性质来计算关于 $\\tau_2$ 的积分：\n$$ Q_d = q \\int_{t_k}^{t_{k+1}} e^{F(t_{k+1}-\\tau)} L L^T e^{F^T(t_{k+1}-\\tau)} d\\tau $$\n为了简化积分，我们进行变量替换。令 $s = t_{k+1} - \\tau$。则 $ds = -d\\tau$。积分限从 $\\tau=t_k$ 变为 $s=\\Delta t$，从 $\\tau=t_{k+1}$ 变为 $s=0$。\n$$ Q_d = q \\int_{\\Delta t}^{0} e^{Fs} L L^T e^{F^T s} (-ds) = q \\int_{0}^{\\Delta t} e^{Fs} L L^T e^{F^T s} ds $$\n为了计算这个积分，我们必须首先计算矩阵指数 $e^{Fs}$。矩阵 $F$ 是幂零矩阵，因为 $F^2 = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$。因此，指数的泰勒级数在一次项后截断：\n$$ e^{Fs} = I + Fs + \\frac{1}{2!} (Fs)^2 + \\dots = I + Fs = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 0  s \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  s \\\\ 0  1 \\end{pmatrix} $$\n其转置为 $e^{F^T s} = (e^{Fs})^T = \\begin{pmatrix} 1  0 \\\\ s  1 \\end{pmatrix}$。\n项 $L L^T$ 为：\n$$ L L^T = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} $$\n现在我们组装被积函数：\n$$ e^{Fs} L L^T e^{F^T s} = \\begin{pmatrix} 1  s \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ s  1 \\end{pmatrix} = \\begin{pmatrix} 0  s \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ s  1 \\end{pmatrix} = \\begin{pmatrix} s^2  s \\\\ s  1 \\end{pmatrix} $$\n现在我们将此矩阵从 $s=0$ 积分到 $s=\\Delta t$：\n$$ \\int_{0}^{\\Delta t} \\begin{pmatrix} s^2  s \\\\ s  1 \\end{pmatrix} ds = \\begin{pmatrix} \\int_{0}^{\\Delta t} s^2 ds  \\int_{0}^{\\Delta t} s ds \\\\ \\int_{0}^{\\Delta t} s ds  \\int_{0}^{\\Delta t} 1 ds \\end{pmatrix} = \\begin{pmatrix} \\left[\\frac{s^3}{3}\\right]_{0}^{\\Delta t}  \\left[\\frac{s^2}{2}\\right]_{0}^{\\Delta t} \\\\ \\left[\\frac{s^2}{2}\\right]_{0}^{\\Delta t}  \\left[s\\right]_{0}^{\\Delta t} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\Delta t^3}{3}  \\frac{\\Delta t^2}{2} \\\\ \\frac{\\Delta t^2}{2}  \\Delta t \\end{pmatrix} $$\n最后，乘以标量功率谱密度 $q$，我们得到离散时间过程噪声协方差矩阵的解析表达式：\n$$ Q_d = q \\begin{pmatrix} \\frac{\\Delta t^3}{3}  \\frac{\\Delta t^2}{2} \\\\ \\frac{\\Delta t^2}{2}  \\Delta t \\end{pmatrix} $$\n现在，我们代入指定的数值：$q = 0.5$ 和 $\\Delta t = 0.1\\,\\mathrm{s}$。\n$$ \\Delta t^3 = (0.1)^3 = 0.001 $$\n$$ \\Delta t^2 = (0.1)^2 = 0.01 $$\n$$ \\Delta t = 0.1 $$\n$$ Q_d = 0.5 \\begin{pmatrix} \\frac{0.001}{3}  \\frac{0.01}{2} \\\\ \\frac{0.01}{2}  0.1 \\end{pmatrix} = 0.5 \\beginpmatrix} 0.0003333...  0.005 \\\\ 0.005  0.1 \\end{pmatrix} $$\n$$ Q_d = \\begin{pmatrix} 0.0001666...  0.0025 \\\\ 0.0025  0.05 \\end{pmatrix} $$\n按要求将每个元素四舍五入到四位有效数字：\n元素 $Q_{d,11}$ 为 $0.0001666...$，四舍五入到 $0.0001667$。\n元素 $Q_{d,12} = Q_{d,21}$ 为 $0.0025$，写作 $0.002500$ 以表示四位有效数字。\n元素 $Q_{d,22}$ 为 $0.05$，写作 $0.05000$ 以表示四位有效数字。\n因此，最终的数值矩阵为：\n$$ Q_d = \\begin{pmatrix} 0.0001667  0.002500 \\\\ 0.002500  0.05000 \\end{pmatrix} $$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0001667  0.002500 \\\\ 0.002500  0.05000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "卡尔曼滤波器并非一个万能的“黑匣子”，其稳定性依赖于系统模型的内在属性。本练习探讨了一种关键的失效模式：即使有测量数据，滤波器的误差协方差也可能无限增长。这种情况发生在系统存在一个传感器无法“看到”的不稳定模式时（即系统不可检测）。通过推导特定状态分量的方差增长，你将深刻理解可观测性、可检测性等概念及其对滤波器收敛的重要性。",
            "id": "3424989",
            "problem": "考虑离散时间线性时不变 (LTI) 线性高斯状态空间模型\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad y_{k} = C x_{k} + v_{k},\n$$\n其中 $x_{k} \\in \\mathbb{R}^{2}$，$y_{k} \\in \\mathbb{R}$，过程噪声 $w_{k} \\sim \\mathcal{N}(0,Q)$，观测噪声 $v_{k} \\sim \\mathcal{N}(0,R)$，且 $\\{w_{k}\\}$ 和 $\\{v_{k}\\}$ 相互独立，并与 $x_{0}$ 独立。设\n$$\nA = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 0  1 \\end{pmatrix}, \\quad\nQ = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nR = 1,\n$$\n且初始后验协方差为\n$$\nP_{0|0} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n应用卡尔曼滤波器 (KF) 进行常规的预测和更新步骤。由于 $A$ 的不稳定特征值对应于一个不可观测的模式，因此状态对 $(A,C)$ 是不可检测的。尽管观测噪声协方差 $R$ 非零，这种不可检测性仍会导致该模式上的协方差无界增长。\n\n从卡尔曼滤波器预测协方差和更新协方差递归的基础定义以及给定的模型结构出发，推导第一个状态分量的后验方差（表示为 $[P_{k|k}]_{11}$）在 $k$ 个完整的预测-更新周期后，关于整数 $k \\ge 0$ 的闭式解析表达式。请以精确形式表示最终答案。不需要四舍五入，也不需要报告单位。",
            "solution": "该问题是有效的，因为它是适定的，科学上基于卡尔曼滤波理论，并且包含了一套完整且一致的给定条件。\n\n在离散时间卡尔曼滤波器中，后验误差协方差矩阵 $P_{k|k}$ 的演化由每个时间步 $k \\ge 1$ 的两步递归控制：一个预测步骤后跟一个更新步骤。\n\n状态空间模型由以下公式给出：\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad w_{k} \\sim \\mathcal{N}(0, Q)\n$$\n$$\ny_{k} = C x_{k} + v_{k}, \\quad v_{k} \\sim \\mathcal{N}(0, R)\n$$\n指定的矩阵为：\n$$\nA = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0  1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = 1\n$$\n初始后验协方差为：\n$$\nP_{0|0} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n我们寻求 $[P_{k|k}]_{11}$ 关于 $k \\ge 0$ 的闭式表达式。\n\n卡尔曼滤波器协方差方程为：\n1.  **预测：** 步骤 $k$ 的先验协方差由步骤 $k-1$ 的后验协方差预测得出：\n    $$\n    P_{k|k-1} = A P_{k-1|k-1} A^T + Q\n    $$\n2.  **更新：** 步骤 $k$ 的后验协方差使用先验协方差 $P_{k|k-1}$ 计算得出：\n    $$\n    K_k = P_{k|k-1} C^T (C P_{k|k-1} C^T + R)^{-1}\n    $$\n    $$\n    P_{k|k} = (I - K_k C) P_{k|k-1}\n    $$\n由于矩阵 $A$、$Q$ 和初始协方差 $P_{0|0}$ 的对角结构，问题被显著简化了。我们将通过归纳法证明，对于所有 $k \\ge 0$，协方差矩阵 $P_{k|k-1}$ 和 $P_{k|k}$ 始终保持为对角矩阵。\n\n设 $P_{k|k} = \\begin{pmatrix} [P_{k|k}]_{11}  [P_{k|k}]_{12} \\\\ [P_{k|k}]_{21}  [P_{k|k}]_{22} \\end{pmatrix}$。为简洁起见，我们记 $p_{11}(k) = [P_{k|k}]_{11}$ 和 $p_{22}(k) = [P_{k|k}]_{22}$。\n\n**对角结构的归纳证明：**\n**基础情况 ($k=0$)：** 给定的初始协方差 $P_{0|0} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$ 是对角矩阵。\n\n**归纳步骤：** 假设对于某个 $k \\ge 1$，$P_{k-1|k-1}$ 是对角矩阵。设 $P_{k-1|k-1} = \\begin{pmatrix} p_{11}(k-1)  0 \\\\ 0  p_{22}(k-1) \\end{pmatrix}$。\n\n首先，我们计算预测协方差 $P_{k|k-1}$：\n$$\nP_{k|k-1} = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} p_{11}(k-1)  0 \\\\ 0  p_{22}(k-1) \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}^T + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nP_{k|k-1} = \\begin{pmatrix} (\\frac{3}{2})^2 p_{11}(k-1)  0 \\\\ 0  (\\frac{1}{2})^2 p_{22}(k-1) \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{4} p_{11}(k-1) + 1  0 \\\\ 0  \\frac{1}{4} p_{22}(k-1) + 1 \\end{pmatrix}\n$$\n因此，$P_{k|k-1}$ 也是对角矩阵。我们将其分量表示为 $p'_{11} = \\frac{9}{4} p_{11}(k-1) + 1$ 和 $p'_{22} = \\frac{1}{4} p_{22}(k-1) + 1$。\n\n接下来，我们计算更新后的协方差 $P_{k|k}$。我们首先求出新息协方差 $S_k$ 和卡尔曼增益 $K_k$：\n$$\nS_k = C P_{k|k-1} C^T + R = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} p'_{11}  0 \\\\ 0  p'_{22} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 1 = p'_{22} + 1\n$$\n由于 $S_k$ 是一个标量，其逆就是 $1/S_k$。\n$$\nK_k = P_{k|k-1} C^T S_k^{-1} = \\begin{pmatrix} p'_{11}  0 \\\\ 0  p'_{22} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (p'_{22} + 1)^{-1} = \\begin{pmatrix} 0 \\\\ \\frac{p'_{22}}{p'_{22}+1} \\end{pmatrix}\n$$\n现在我们计算更新后的协方差 $P_{k|k}$：\n$$\nP_{k|k} = (I - K_k C) P_{k|k-1}\n$$\n$$\nI - K_k C = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ \\frac{p'_{22}}{p'_{22}+1} \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ 0  \\frac{p'_{22}}{p'_{22}+1} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{p'_{22}+1} \\end{pmatrix}\n$$\n$$\nP_{k|k} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{p'_{22}+1} \\end{pmatrix} \\begin{pmatrix} p'_{11}  0 \\\\ 0  p'_{22} \\end{pmatrix} = \\begin{pmatrix} p'_{11}  0 \\\\ 0  \\frac{p'_{22}}{p'_{22}+1} \\end{pmatrix}\n$$\n这表明 $P_{k|k}$ 是对角矩阵。根据数学归纳法原理，对于所有 $k \\ge 0$，$P_{k|k}$ 都是对角矩阵。\n\n对角元素的递归是解耦的：\n$$\np_{11}(k) = [P_{k|k}]_{11} = p'_{11} = \\frac{9}{4} p_{11}(k-1) + 1\n$$\n$$\np_{22}(k) = [P_{k|k}]_{22} = \\frac{p'_{22}}{p'_{22}+1} = \\frac{\\frac{1}{4} p_{22}(k-1) + 1}{(\\frac{1}{4} p_{22}(k-1) + 1) + 1} = \\frac{\\frac{1}{4} p_{22}(k-1) + 1}{\\frac{1}{4} p_{22}(k-1) + 2}\n$$\n我们只需要解出 $p_{11}(k)$ 的递归关系。这是一个形如 $z_k = a z_{k-1} + b$ 的线性一阶非齐次递推关系，其中 $a = \\frac{9}{4}$ 且 $b=1$。初始条件为 $p_{11}(0) = [P_{0|0}]_{11} = 0$。\n\n对于 $a \\neq 1$，$z_k = a z_{k-1} + b$ 的通解是 $z_k = a^k z_0 + b \\frac{a^k-1}{a-1}$。\n代入 $z_k = p_{11}(k)$，$a = \\frac{9}{4}$，$b=1$ 和 $p_{11}(0)=0$：\n$$\np_{11}(k) = \\left(\\frac{9}{4}\\right)^k \\cdot 0 + 1 \\cdot \\frac{\\left(\\frac{9}{4}\\right)^k - 1}{\\frac{9}{4} - 1}\n$$\n$$\np_{11}(k) = \\frac{\\left(\\frac{9}{4}\\right)^k - 1}{\\frac{5}{4}}\n$$\n$$\np_{11}(k) = \\frac{4}{5} \\left( \\left(\\frac{9}{4}\\right)^k - 1 \\right)\n$$\n此表达式对所有整数 $k \\ge 0$ 均有效。对于 $k=0$，它正确地得出 $p_{11}(0) = \\frac{4}{5}(1-1) = 0$。这种方差的无界增长是第一个状态分量与一个不稳定的特征值（$|\\frac{3}{2}|  1$）相关联，并且是不可观测的（因为 $C$ 在第一个位置上为零）的直接结果。\n因此，第一个状态分量的后验方差的最终闭式表达式为：\n$$\n[P_{k|k}]_{11} = \\frac{4}{5} \\left( \\left(\\frac{9}{4}\\right)^k - 1 \\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{4}{5} \\left( \\left(\\frac{9}{4}\\right)^k - 1 \\right)}\n$$"
        },
        {
            "introduction": "理论公式是一回事，但在有限精度算术的计算机上实现它们是另一回事。本练习揭示了一个经典且危险的数值问题：递归更新的协方差矩阵可能会失去其必须具备的正半定性，从而导致滤波器崩溃。通过一个精心构造的反例，你将親眼见证为何“朴素”的协方差更新公式在数值上是不稳定的，并体会到为何需要像平方根滤波器这样更稳健的实现方法。",
            "id": "3424957",
            "problem": "考虑一个线性、时不变、离散时间的高斯状态空间模型。在给定的时间步，一步预测状态 $x_{k|k-1}$ 是高斯分布的，其均值为 $m_{k|k-1}$，协方差为 $P_{k|k-1}$。根据 $y_k = H x_k + v_k$ 获得测量值 $y_k$，其中 $v_k$ 是高斯分布的，零均值，与 $x_k$ 独立，协方差为 $R$。除非另有说明，否则在精确算术下进行运算。\n\nA部分（精确算术，基础推导）：从 $(x_k, y_k)$ 的联合高斯性以及联合高斯变量的条件协方差定义出发，推导后验协方差 $P_{k|k}$ 的解析表达式，并解释为什么在精确算术下 $P_{k|k}$ 是半正定的（PSD）。您的推导必须基于分块矩阵求逆恒等式和半正定性的舒尔补表征。\n\nB部分（有限精度反例）：定义一个有限精度算术模型如下：每个标量乘积和标量和都立即四舍五入到4位有效数字，并且 $2 \\times 2$ 矩阵的求逆通过伴随矩阵公式执行，同样的舍入规则应用于所有中间的标量乘积、和以及倒数。在此有限精度模型中，考虑\n$$\nP_{k|k-1} = \\begin{pmatrix} 1.000  0.9990 \\\\ 0.9990  0.9980 \\end{pmatrix}, \\quad\nH = I_2, \\quad\nR = 0.0010\\, I_2.\n$$\n计算新息协方差 $S = H P_{k|k-1} H^{\\top} + R$、其逆矩阵 $S^{-1}$、卡尔曼增益 $K = P_{k|k-1} H^{\\top} S^{-1}$，然后使用朴素协方差更新公式 $P_{k|k} = (I - K H) P_{k|k-1}$ 计算后验协方差，所有计算均在所述的舍入模型下进行。然后通过 $\\tfrac{1}{2}\\big(P_{k|k} + P_{k|k}^{\\top}\\big)$ 对结果进行对称化。通过计算其最小特征值，证明对称化后的矩阵不是半正定的。\n\nC部分（通过平方根滤波器的补救措施）：基于数值线性代数和协方差分解的基本原理，概述平方根卡尔曼滤波器如何通过传播一个Cholesky因子 $S_{k|k}$（其中 $P_{k|k} = S_{k|k} S_{k|k}^{\\top}$）并通过正交三角（QR）分解对其进行更新，来缓解与朴素协方差更新相比在有限精度下半正定性丧失的问题。\n\n答案规格：将B部分中对称化后的后验协方差的最小特征值作为最终答案报告。将您的答案四舍五入到四位有效数字。答案是无单位的，并且必须是单个实数。",
            "solution": "该问题经验证是自洽的、有科学依据且适定的。所提供的先验协方差矩阵 $P_{k|k-1}$ 在指定的有限精度算术模型内是半正定的，因此构成一个有效的前提。\n\nA部分：基础推导与半正定性证明\n\n我们首先建立状态 $x_k$ 和测量值 $y_k$ 的联合分布。状态 $x_k$ 被假定具有来自预测步骤的先验高斯分布，$x_k \\sim \\mathcal{N}(m_{k|k-1}, P_{k|k-1})$。测量值 $y_k$ 通过线性模型 $y_k = H x_k + v_k$ 与状态相关，其中噪声 $v_k$ 是一个独立的、零均值的高斯过程，$v_k \\sim \\mathcal{N}(0, R)$。\n\n由于 $x_k$ 和 $y_k$ 是联合高斯的，我们可以通过其均值向量和协方差矩阵来刻画它们的联合分布。令联合向量为 $Z = \\begin{pmatrix} x_k \\\\ y_k \\end{pmatrix}$。\n\n联合向量的均值为：\n$$\n\\mathbb{E}[Z] = \\begin{pmatrix} \\mathbb{E}[x_k] \\\\ \\mathbb{E}[y_k] \\end{pmatrix} = \\begin{pmatrix} m_{k|k-1} \\\\ \\mathbb{E}[H x_k + v_k] \\end{pmatrix} = \\begin{pmatrix} m_{k|k-1} \\\\ H m_{k|k-1} + \\mathbb{E}[v_k] \\end{pmatrix} = \\begin{pmatrix} m_{k|k-1} \\\\ H m_{k|k-1} \\end{pmatrix}\n$$\n\n联合向量的协方差矩阵是一个分块矩阵：\n$$\n\\text{Cov}(Z) = \\begin{pmatrix} \\text{Cov}(x_k)  \\text{Cov}(x_k, y_k) \\\\ \\text{Cov}(y_k, x_k)  \\text{Cov}(y_k) \\end{pmatrix}\n$$\n各分块计算如下：\n- $\\text{Cov}(x_k) = P_{k|k-1}$\n- $\\text{Cov}(x_k, y_k) = \\text{Cov}(x_k, H x_k + v_k) = \\text{Cov}(x_k, H x_k) + \\text{Cov}(x_k, v_k)$。由于 $x_k$ 和 $v_k$ 是独立的，$\\text{Cov}(x_k, v_k)=0$。因此，$\\text{Cov}(x_k, y_k) = \\text{Cov}(x_k, x_k) H^{\\top} = P_{k|k-1} H^{\\top}$。\n- $\\text{Cov}(y_k, x_k) = \\left(\\text{Cov}(x_k, y_k)\\right)^{\\top} = H P_{k|k-1}$。\n- $\\text{Cov}(y_k) = \\text{Cov}(H x_k + v_k) = \\text{Cov}(H x_k) + \\text{Cov}(v_k) = H \\text{Cov}(x_k) H^{\\top} + R = H P_{k|k-1} H^{\\top} + R$。这就是新息协方差，记为 $S_k$。\n\n所以，联合协方差矩阵是：\n$$\n\\text{Cov}(Z) = \\begin{pmatrix} P_{k|k-1}  P_{k|k-1} H^{\\top} \\\\ H P_{k|k-1}  S_k \\end{pmatrix}\n$$\n后验协方差 $P_{k|k}$ 是在给定测量值 $y_k$ 的条件下 $x_k$ 的条件协方差。对于一个联合高斯分块向量 $\\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix}$，其协方差为 $\\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix}$，给定 $X_2$ 的条件下 $X_1$ 的条件协方差由 $\\Sigma_{22}$ 的舒尔补给出：\n$$\n\\text{Cov}(X_1 | X_2) = \\Sigma_{11} - \\Sigma_{12} \\Sigma_{22}^{-1} \\Sigma_{21}\n$$\n通过将 $X_1$ 等同于 $x_k$、将 $X_2$ 等同于 $y_k$，我们代入 $\\text{Cov}(Z)$ 中的分块：\n$$\nP_{k|k} = P_{k|k-1} - (P_{k|k-1} H^{\\top}) S_k^{-1} (H P_{k|k-1})\n$$\n这是更新后协方差的标准形式。\n\n为了证明在精确算术下 $P_{k|k}$ 是半正定的（PSD），我们使用PSD矩阵的舒尔补表征。一个对称分块矩阵 $M = \\begin{pmatrix} A  B \\\\ B^{\\top}  D \\end{pmatrix}$ 是PSD的，当且仅当 $D \\succeq 0$ 并且其舒尔补 $A - B D^{-1} B^{\\top} \\succeq 0$（假设 $D$ 是可逆的，即正定的）。\n根据定义，联合协方差矩阵 $\\text{Cov}(Z)$ 是一个协方差矩阵，因此必须是PSD的。我们来分析其分块：\n- $A = P_{k|k-1}$，作为协方差矩阵是PSD的。\n- $B = P_{k|k-1} H^{\\top}$。\n- $D = S_k = H P_{k|k-1} H^{\\top} + R$。由于 $P_{k|k-1} \\succeq 0$，则 $H P_{k|k-1} H^{\\top} \\succeq 0$。由于 $R$ 是一个协方差矩阵，$R \\succeq 0$。两个PSD矩阵的和是PSD的，所以 $S_k \\succeq 0$。通常假设 $R$ 是正定的，这使得 $S_k$ 也是正定的，因而是可逆的。\n\n由于 $\\text{Cov}(Z)$ 是PSD的并且 $S_k$ 是正定的，那么 $\\text{Cov}(Z)$ 中 $S_k$ 的舒尔补也必须是PSD的。这个舒尔补恰好是我们为后验协方差推导出的表达式：\n$$\nP_{k|k} = P_{k|k-1} - P_{k|k-1} H^{\\top} S_k^{-1} H P_{k|k-1} \\succeq 0\n$$\n因此，在精确算术中，后验协方差 $P_{k|k}$ 被保证是半正定的。\n\nB部分：有限精度反例\n\n我们使用指定的有限精度算术模型（将每个标量乘积和和都四舍五入到4位有效数字）进行计算。\n给定：\n$P_{k|k-1} = \\begin{pmatrix} 1.000  0.9990 \\\\ 0.9990  0.9980 \\end{pmatrix}$，$H = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$，$R = \\begin{pmatrix} 0.0010  0 \\\\ 0  0.0010 \\end{pmatrix}$。\n\n1.  计算新息协方差 $S = H P_{k|k-1} H^{\\top} + R = P_{k|k-1} + R$：\n    $S = \\begin{pmatrix} 1.000+0.0010  0.9990+0 \\\\ 0.9990+0  0.9980+0.0010 \\end{pmatrix} = \\begin{pmatrix} 1.0010  0.9990 \\\\ 0.9990  0.9990 \\end{pmatrix}$。\n    将和 $1.0010$ 四舍五入到4位有效数字得到 $1.001$。\n    $S = \\begin{pmatrix} 1.001  0.9990 \\\\ 0.9990  0.9990 \\end{pmatrix}$。\n\n2.  使用伴随矩阵公式 $S^{-1} = \\frac{1}{\\det(S)} \\text{adj}(S)$ 计算 $S^{-1}$：\n    - $\\det(S) = (1.001 \\times 0.9990) - (0.9990 \\times 0.9990)$。\n    - 乘积1：$1.001 \\times 0.9990 = 0.999999 \\to 1.000$。\n    - 乘积2：$0.9990 \\times 0.9990 = 0.998001 \\to 0.9980$。\n    - 和：$1.000 - 0.9980 = 0.0020$。四舍五入到4位有效数字 - $0.002000$。\n    - $1 / \\det(S) = 1 / 0.002000 = 500.0$。\n    - adj$(S) = \\begin{pmatrix} 0.9990  -0.9990 \\\\ -0.9990  1.001 \\end{pmatrix}$。\n    - $S^{-1} = 500.0 \\times \\begin{pmatrix} 0.9990  -0.9990 \\\\ -0.9990  1.001 \\end{pmatrix} = \\begin{pmatrix} 500.0 \\times 0.9990  500.0 \\times -0.9990 \\\\ 500.0 \\times -0.9990  500.0 \\times 1.001 \\end{pmatrix}$。\n    - 元素(1,1)：$499.5$。元素(1,2)：$-499.5$。元素(2,1)：$-499.5$。元素(2,2)：$500.5$。\n    - $S^{-1} = \\begin{pmatrix} 499.5  -499.5 \\\\ -499.5  500.5 \\end{pmatrix}$。\n\n3.  计算卡尔曼增益 $K = P_{k|k-1} H^{\\top} S^{-1} = P_{k|k-1} S^{-1}$：\n    $K = \\begin{pmatrix} 1.000  0.9990 \\\\ 0.9990  0.9980 \\end{pmatrix} \\begin{pmatrix} 499.5  -499.5 \\\\ -499.5  500.5 \\end{pmatrix}$。\n    - $K_{11} = (1.000 \\times 499.5) + (0.9990 \\times -499.5) = (499.5) + (-499.0005 \\to -499.0) = 0.5 \\to 0.5000$。\n    - $K_{12} = (1.000 \\times -499.5) + (0.9990 \\times 500.5) = (-499.5) + (499.9995 \\to 500.0) = 0.5 \\to 0.5000$。\n    - $K_{21} = (0.9990 \\times 499.5) + (0.9980 \\times -499.5) = (499.0005 \\to 499.0) + (-498.501 \\to -498.5) = 0.5 \\to 0.5000$。\n    - $K_{22} = (0.9990 \\times -499.5) + (0.9980 \\times 500.5) = (-499.0005 \\to -499.0) + (499.499 \\to 499.5) = 0.5 \\to 0.5000$。\n    - $K = \\begin{pmatrix} 0.5000  0.5000 \\\\ 0.5000  0.5000 \\end{pmatrix}$。\n\n4.  计算后验协方差 $P_{k|k} = (I - K H) P_{k|k-1} = (I-K)P_{k|k-1}$：\n    - $I - K = \\begin{pmatrix} 1.000 - 0.5000  0 - 0.5000 \\\\ 0 - 0.5000  1.000 - 0.5000 \\end{pmatrix} = \\begin{pmatrix} 0.5000  -0.5000 \\\\ -0.5000  0.5000 \\end{pmatrix}$。\n    - $P_{k|k} = \\begin{pmatrix} 0.5000  -0.5000 \\\\ -0.5000  0.5000 \\end{pmatrix} \\begin{pmatrix} 1.000  0.9990 \\\\ 0.9990  0.9980 \\end{pmatrix}$。\n    - $P_{11} = (0.5000 \\times 1.000) + (-0.5000 \\times 0.9990) = (0.5000) + (-0.4995) = 0.0005 \\to 0.0005000$。\n    - $P_{12} = (0.5000 \\times 0.9990) + (-0.5000 \\times 0.9980) = (0.4995) + (-0.4990) = 0.0005 \\to 0.0005000$。\n    - $P_{21} = (-0.5000 \\times 1.000) + (0.5000 \\times 0.9990) = (-0.5000) + (0.4995) = -0.0005 \\to -0.0005000$。\n    - $P_{22} = (-0.5000 \\times 0.9990) + (0.5000 \\times 0.9980) = (-0.4995) + (0.4990) = -0.0005 \\to -0.0005000$。\n    - $P_{k|k} = \\begin{pmatrix} 0.0005000  0.0005000 \\\\ -0.0005000  -0.0005000 \\end{pmatrix}$。\n\n5.  对结果进行对称化：$P_{k|k}^{\\text{sym}} = \\frac{1}{2}\\big(P_{k|k} + P_{k|k}^{\\top}\\big)$：\n    - $P_{k|k} + P_{k|k}^{\\top} = \\begin{pmatrix} 0.0005000  0.0005000 \\\\ -0.0005000  -0.0005000 \\end{pmatrix} + \\begin{pmatrix} 0.0005000  -0.0005000 \\\\ 0.0005000  -0.0005000 \\end{pmatrix} = \\begin{pmatrix} 0.001000  0 \\\\ 0  -0.001000 \\end{pmatrix}$。\n    - $P_{k|k}^{\\text{sym}} = \\frac{1}{2} \\begin{pmatrix} 0.001000  0 \\\\ 0  -0.001000 \\end{pmatrix} = \\begin{pmatrix} 0.0005000  0 \\\\ 0  -0.0005000 \\end{pmatrix}$。\n\n6.  计算最小特征值：由于对称化后的矩阵是对角矩阵，其特征值即为其对角线元素：$\\lambda_1 = 0.0005000$ 和 $\\lambda_2 = -0.0005000$。最小特征值为 $-0.0005000$。这个负特征值表明所得矩阵不是半正定的，这是朴素更新公式在有限精度下的一个失效案例。\n\nC部分：通过平方根滤波器的补救措施\n\n平方根卡尔曼滤波器通过传播协方差的矩阵平方根而非协方差矩阵本身，来缓解半正定性的丧失。其基本思想是维护一个因子，例如Cholesky因子 $S_{k|k}$，它是一个下三角矩阵，使得 $P_{k|k} = S_{k|k} S_{k|k}^{\\top}$。\n\n这种方法的关键优势在于：\n1.  **保证半正定性**：从构造上看，对于任何实矩阵 $A$，形如 $A A^{\\top}$ 的矩阵总是半正定的。这是因为对于任何向量 $x$，二次型 $x^{\\top}(A A^{\\top})x = (A^{\\top}x)^{\\top}(A^{\\top}x) = \\|A^{\\top}x\\|_2^2$ 总是非负的。只要滤波器计算出实值的Cholesky因子 $S_{k|k}$，那么得到的完整协方差矩阵 $P_{k|k} = S_{k|k} S_{k|k}^{\\top}$ 就保证是PSD的。这完全避免了B部分中观察到的失效模式，即计算出的协方差变得不定。\n2.  **改善的数值稳定性**：矩阵 $P$ 的条件数与其Cholesky因子 $S$ 的条件数相关，关系为 $\\kappa(P) = \\kappa(S)^2$。涉及平方根因子 $S$ 的数值运算是在一个通常比 $P$ 条件好得多的矩阵上执行的，从而减少了舍入误差的影响。在B部分中观察到的灾难性抵消，特别是在减法 $(I-KH)P_{k|k-1}$ 中，是在病态矩阵上进行运算的症状。\n3.  **使用稳定的数值技术**：从先验因子 $S_{k|k-1}$ 到后验因子 $S_{k|k}$ 的更新步骤是使用数值稳定的算法实现的，最著名的是基于QR分解等正交变换的算法。测量更新可以被表述为寻找矩阵和或差的Cholesky因子的问题，这可以通过构建一个辅助数组并应用一系列高度稳定的Givens旋转或Householder反射来将其三角化来完成。这些正交变换是完美条件的，不会放大数值误差，从而保持了因子的准确性，并因此保证了协方差表示的完整性。",
            "answer": "$$\\boxed{-0.0005000}$$"
        }
    ]
}