{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的检验方式就是动手实践。这个练习将带领我们从一个简单的二维线性高斯问题入手，通过具体计算后验均值和协方差，来直观地理解贝叶斯更新的核心机制。特别地，我们将探讨一个组件的观测如何通过先验协方差来更新另一个未被直接观测的组件，这是理解数据同化中信息传播的关键一步 ()。",
            "id": "3380095",
            "problem": "考虑一个在 Bayes 框架下建立的线性逆问题。未知状态为 $x \\in \\mathbb{R}^{2}$，其高斯先验分布为 $x \\sim \\mathcal{N}(m_{0}, C_{0})$。单个标量观测值 $y \\in \\mathbb{R}$ 通过一个带有加性高斯噪声的线性正演算子与该状态相关联，即 $y = H x + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, R)$ 且独立于 $x$。维度为 $n = 2$ 和 $p = 1$。假设给定以下数据：$H = [\\,1 \\; 0\\,]$，$m_{0} = [\\,0,\\,0\\,]^{\\top}$，$C_{0} = \\mathrm{diag}(1, 10)$，$R = 1$，以及一个已实现的观测值 $y = 1$。\n\n仅使用适用于线性高斯 Bayes 逆问题和基于集合的不确定性传播的基本原理，完成以下任务：\n- 从第一性原理出发，推导后验分布 $x \\mid y \\sim \\mathcal{N}(m_{a}, C_{a})$，得到以给定数据表示的 $m_{a}$ 和 $C_{a}$ 的闭式表达式。\n- 根据交叉协方差及其在基于集合的更新中的作用，解释在给定先验条件下，未观测分量 $x_{2}$ 是否被观测值更新。\n\n作为对您推导的单个标量检验，报告观测分量 $x_{1}$ 的后验方差作为您的最终答案。最终答案应为一个精确数值，不带单位。无需四舍五入。",
            "solution": "我们从线性高斯 Bayes 逆问题的设定开始。状态的先验分布为 $x \\sim \\mathcal{N}(m_{0}, C_{0})$，其中 $m_{0} \\in \\mathbb{R}^{2}$ 且 $C_{0} \\in \\mathbb{R}^{2 \\times 2}$ 为对称正定矩阵，数据模型为 $y = H x + \\eta$，其中 $H \\in \\mathbb{R}^{1 \\times 2}$，$\\eta \\sim \\mathcal{N}(0, R)$ 独立于 $x$，且 $R \\in \\mathbb{R}^{1 \\times 1}$ 为正数。$(x, y)$ 的联合分布是高斯分布，因此后验分布 $x \\mid y$ 也是高斯分布。获取后验参数的标准方法是使用 Bayes 定理和多元正态分布的性质，这可以通过在联合高斯密度的指数项中配方法推导得出。\n\n将先验密度写为\n$$\n\\pi(x) \\propto \\exp\\left( -\\tfrac{1}{2} (x - m_{0})^{\\top} C_{0}^{-1} (x - m_{0}) \\right),\n$$\n并将似然函数写为\n$$\n\\mathcal{L}(y \\mid x) \\propto \\exp\\left( -\\tfrac{1}{2} (y - H x)^{\\top} R^{-1} (y - H x) \\right).\n$$\n后验密度在忽略比例常数的情况下为\n$$\n\\pi(x \\mid y) \\propto \\exp\\left( -\\tfrac{1}{2} (x - m_{0})^{\\top} C_{0}^{-1} (x - m_{0}) - \\tfrac{1}{2} (y - H x)^{\\top} R^{-1} (y - H x) \\right).\n$$\n展开关于 $x$ 的二次型并配方，后验分布是高斯的，其精度（协方差的逆）为\n$$\nC_{a}^{-1} = C_{0}^{-1} + H^{\\top} R^{-1} H,\n$$\n均值为\n$$\nm_{a} = C_{a} \\left( C_{0}^{-1} m_{0} + H^{\\top} R^{-1} y \\right).\n$$\n等价地，可以使用 Kalman 增益 $K$ 来表示后验均值，\n$$\nK = C_{0} H^{\\top} \\left( H C_{0} H^{\\top} + R \\right)^{-1},\n$$\n为\n$$\nm_{a} = m_{0} + K \\left( y - H m_{0} \\right),\n$$\n后验协方差为\n$$\nC_{a} = C_{0} - K H C_{0}.\n$$\n\n现在我们使用给定的数据进行计算。维度为 $n = 2$，$p = 1$，且\n$$\nH = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad m_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}, \\quad C_{0} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 10 \\end{bmatrix}, \\quad R = 1, \\quad y = 1.\n$$\n计算新息协方差：\n$$\nS = H C_{0} H^{\\top} + R = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 10 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + 1 = 1 + 1 = 2.\n$$\n计算 Kalman 增益：\n$$\nK = C_{0} H^{\\top} S^{-1} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 10 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\cdot \\frac{1}{2} = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix}.\n$$\n计算后验均值：\n$$\nm_{a} = m_{0} + K (y - H m_{0}) = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} \\left( 1 - \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\right) = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix}.\n$$\n计算后验协方差：\n$$\nC_{a} = C_{0} - K H C_{0}.\n$$\n首先，计算 $K H$：\n$$\nK H = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{bmatrix}.\n$$\n然后，\n$$\nK H C_{0} = \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 10 \\end{bmatrix} = \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{bmatrix}.\n$$\n因此，\n$$\nC_{a} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 10 \\end{bmatrix} - \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 10 \\end{bmatrix}.\n$$\n\n根据交叉协方差和基于集合的不确定性传播进行解释：在线性高斯设定中，状态-观测交叉协方差为 $C_{x y} = C_{0} H^{\\top}$。在这里，\n$$\nC_{x y} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 10 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n$C_{x y}$ 的第二个分量为 $0$，表明未观测的状态分量 $x_{2}$ 与观测值之间没有先验交叉协方差。在基于集合的方法中，例如集合 Kalman 滤波器 (Ensemble Kalman Filter, EnKF)，每个状态分量的更新量与其和预测观测值之间的样本交叉协方差成正比。当该交叉协方差为零时，相应分量不会从数据中获得更新。与此原理一致，我们得到 $K = [\\,1/2,\\,0\\,]^{\\top}$，因此只有 $x_{1}$ 被更新，而 $x_{2}$ 的后验均值和方差分别保持为 $0$ 和 $10$。\n\n所要求的标量检验是 $x_{1}$ 的后验方差，从 $C_{a}$ 中可知，即其 $(1,1)$ 元素，等于 $1/2$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在掌握了基本的后验计算后，我们可以进一步探索后验分布的深层结构。这个练习引入了“先验白化的数据失配算子”（prior-whitened data-misfit operator），并利用其谱分解来识别数据能够提供信息的参数子空间 ()。通过分析该算子的特征值，我们可以量化数据对减少不确定性的贡献，从而更深刻地理解哪些参数方向能被观测所约束。",
            "id": "3367453",
            "problem": "考虑一个线性逆问题，其未知参数为 $x \\in \\mathbb{R}^n$，观测数据为 $y \\in \\mathbb{R}^m$，由模型 $y = G x + \\varepsilon$ 生成。其中，$G \\in \\mathbb{R}^{m \\times n}$ 是线性的，噪声 $\\varepsilon$ 是高斯的，$\\varepsilon \\sim \\mathcal{N}(0, \\Gamma)$，其协方差 $\\Gamma \\in \\mathbb{R}^{m \\times m}$ 是对称正定（SPD）的。假设参数 $x$ 服从高斯先验 $x \\sim \\mathcal{N}(m_0, C_0)$，其协方差 $C_0 \\in \\mathbb{R}^{n \\times n}$ 是对称正定的。定义先验白化的数据失配算子\n$$\nH \\;=\\; C_0^{1/2}\\, G^\\top \\Gamma^{-1} G \\, C_0^{1/2} \\;\\in\\; \\mathbb{R}^{n \\times n},\n$$\n其中 $C_0^{1/2}$ 是 $C_0$ 唯一的对称平方根，$(\\cdot)^\\top$ 表示转置。设 $H = U \\Lambda U^\\top$ 是 $H$ 的特征分解，其中 $U \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_n)$，且 $\\lambda_i \\ge 0$。\n\n仅使用适用于贝叶斯逆问题的第一性原理和高斯条件化的性质，判断下列关于 $H$ 的特征分解如何识别数据信息子空间以及谱 $\\{\\lambda_i\\}$ 如何与后验方差减少相关联的陈述中，哪些是正确的。选择所有适用项。\n\nA. 在此线性高斯设置中，后验协方差 $C_{\\mathrm{post}}$ 满足 $C_{\\mathrm{post}} = C_0^{1/2} (I + H)^{-1} C_0^{1/2}$。\n\nB. 似然信息子空间（LIS）是 $\\mathrm{span}\\{ C_0^{1/2} u_i : \\lambda_i > 0 \\}$；此外，在先验白化坐标中，沿每个特征向量 $u_i$ 的后验方差为 $(1 + \\lambda_i)^{-1}$。\n\nC. 如果 $\\lambda_i = 0$，那么在先验白化坐标中，沿 $u_i$ 的后验方差严格大于先验方差。\n\nD. 算子 $H$ 是对称半正定的，其秩满足 $\\mathrm{rank}(H) \\le \\mathrm{rank}(G) \\le m$。\n\nE. 在先验白化坐标中，总方差减少量，度量为 $\\mathrm{tr}(I) - \\mathrm{tr}((I + H)^{-1})$，等于 $\\sum_{i=1}^n \\frac{\\lambda_i}{1 + \\lambda_i}$。",
            "solution": "### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题陈述提供了以下信息：\n- 一个未知参数为 $x \\in \\mathbb{R}^n$ 的线性逆问题。\n- 观测数据 $y \\in \\mathbb{R}^m$。\n- 一个线性正演模型：$y = G x + \\varepsilon$，其中 $G \\in \\mathbb{R}^{m \\times n}$。\n- 加性高斯噪声：$\\varepsilon \\sim \\mathcal{N}(0, \\Gamma)$，其中 $\\Gamma \\in \\mathbb{R}^{m \\times m}$ 是一个对称正定（SPD）的协方差矩阵。\n- 参数的高斯先验分布：$x \\sim \\mathcal{N}(m_0, C_0)$，其中 $m_0 \\in \\mathbb{R}^n$ 是先验均值，$C_0 \\in \\mathbb{R}^{n \\times n}$ 是对称正定的先验协方差矩阵。\n- 一个已定义的算子：先验白化的数据失配算子 $H = C_0^{1/2}\\, G^\\top \\Gamma^{-1} G \\, C_0^{1/2} \\in \\mathbb{R}^{n \\times n}$，其中 $C_0^{1/2}$ 是 $C_0$ 的唯一对称平方根。\n- $H$ 的特征分解：$H = U \\Lambda U^\\top$，其中 $U \\in \\mathbb{R}^{n \\times n}$ 是一个正交矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_1, \\dots, \\lambda_n)$ 是一个由特征值 $\\lambda_i \\ge 0$ 构成的对角矩阵。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n问题陈述描述了一个典型的线性高斯贝叶斯逆问题。这是计算科学、工程和统计学中一个基础且完善的框架。\n\n- **科学上合理：** 该设置基于贝叶斯定理，应用于一个先验和测量噪声均为高斯分布的线性模型。这是逆问题和数据同化中一个标准且广泛使用的模型。所有数学对象（对称正定矩阵、高斯分布、矩阵平方根）都有明确的定义。\n- **适定性：** 问题是适定的。高斯先验和似然的假设确保了后验分布也是高斯的，并且可以唯一确定。$\\Gamma$ 是对称正定保证了 $\\Gamma^{-1}$ 的存在，$C_0$ 是对称正定保证了唯一的对称 $C_0^{1/2}$ 的存在。问题要求推导和验证后验的性质，这是一个明确定义的数学任务。\n- **客观性：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n\n问题陈述是**有效的**。它在科学上是合理的、自洽的、适定的和客观的。它代表了贝叶斯逆问题领域的一个标准场景。我将继续进行推导和分析。\n\n### 从第一性原理推导\n\n在贝叶斯框架中，给定数据 $y$ 的参数 $x$ 的后验分布 $p(x|y)$，与似然 $p(y|x)$ 和先验 $p(x)$ 的乘积成正比。\n$$\np(x|y) \\propto p(y|x) p(x)\n$$\n根据问题陈述，先验为 $x \\sim \\mathcal{N}(m_0, C_0)$，似然由噪声模型 $\\varepsilon = y - Gx \\sim \\mathcal{N}(0, \\Gamma)$ 导出，这意味着 $y|x \\sim \\mathcal{N}(Gx, \\Gamma)$。相应的概率密度函数为：\n$$\np(x) \\propto \\exp\\left(-\\frac{1}{2}(x - m_0)^\\top C_0^{-1} (x - m_0)\\right)\n$$\n$$\np(y|x) \\propto \\exp\\left(-\\frac{1}{2}(y - Gx)^\\top \\Gamma^{-1} (y - Gx)\\right)\n$$\n因此，后验密度为：\n$$\np(x|y) \\propto \\exp\\left(-\\frac{1}{2}\\left[(y - Gx)^\\top \\Gamma^{-1} (y - Gx) + (x - m_0)^\\top C_0^{-1} (x - m_0)\\right]\\right)\n$$\n这表明后验也是一个高斯分布，$x|y \\sim \\mathcal{N}(m_{\\mathrm{post}}, C_{\\mathrm{post}})$。后验协方差矩阵 $C_{\\mathrm{post}}$ 是负对数后验参数的海森矩阵的逆。令 $J(x) = \\frac{1}{2}(y - Gx)^\\top \\Gamma^{-1} (y - Gx) + \\frac{1}{2}(x - m_0)^\\top C_0^{-1} (x - m_0)$。其海森矩阵为：\n$$\n\\nabla_x^2 J(x) = G^\\top \\Gamma^{-1} G + C_0^{-1}\n$$\n因此，后验精度矩阵为 $C_{\\mathrm{post}}^{-1} = C_0^{-1} + G^\\top \\Gamma^{-1} G$。\n为了将其与算子 $H$ 联系起来，我们可以分解出涉及 $C_0$ 的项：\n$$\nC_{\\mathrm{post}}^{-1} = C_0^{-1/2} C_0^{-1/2} + G^\\top \\Gamma^{-1} G = C_0^{-1/2} \\left(I + C_0^{1/2} G^\\top \\Gamma^{-1} G C_0^{1/2}\\right) C_0^{-1/2}\n$$\n使用定义 $H = C_0^{1/2}\\, G^\\top \\Gamma^{-1} G \\, C_0^{1/2}$，我们有：\n$$\nC_{\\mathrm{post}}^{-1} = C_0^{-1/2} (I + H) C_0^{-1/2}\n$$\n对此表达式求逆，得到后验协方差 $C_{\\mathrm{post}}$：\n$$\nC_{\\mathrm{post}} = \\left(C_0^{-1/2} (I + H) C_0^{-1/2}\\right)^{-1} = (C_0^{-1/2})^{-1} (I + H)^{-1} (C_0^{-1/2})^{-1}\n$$\n由于 $C_0^{1/2}$ 是对称的，所以 $(C_0^{-1/2})^{-1} = C_0^{1/2}$。因此：\n$$\nC_{\\mathrm{post}} = C_0^{1/2} (I + H)^{-1} C_0^{1/2}\n$$\n这个基本结果将用于评估各个选项。\n\n### 逐项分析\n\n**A. 在此线性高斯设置中，后验协方差 $C_{\\mathrm{post}}$ 满足 $C_{\\mathrm{post}} = C_0^{1/2} (I + H)^{-1} C_0^{1/2}$。**\n\n该陈述与上面直接从线性高斯问题的贝叶斯推断第一性原理推导出的结果相符。\n**结论：正确。**\n\n**B. 似然信息子空间（LIS）是 $\\mathrm{span}\\{ C_0^{1/2} u_i : \\lambda_i > 0 \\}$；此外，在先验白化坐标中，沿每个特征向量 $u_i$ 的后验方差为 $(1 + \\lambda_i)^{-1}$。**\n\n这个选项有两部分。\n首先，我们来分析似然信息子空间（LIS）。LIS 是参数空间中数据提供信息从而导致方差减少的子空间。方差减少由差值 $C_0 - C_{\\mathrm{post}}$ 来表征。\n$$\nC_0 - C_{\\mathrm{post}} = C_0 - C_0^{1/2} (I + H)^{-1} C_0^{1/2} = C_0^{1/2} \\left(I - (I+H)^{-1}\\right) C_0^{1/2}\n$$\n$$\nI - (I+H)^{-1} = (I+H-I)(I+H)^{-1} = H(I+H)^{-1}\n$$\n所以，$C_0 - C_{\\mathrm{post}} = C_0^{1/2} H (I+H)^{-1} C_0^{1/2}$。方差减少发生在该算子值域所张成的方向上。$C_0^{1/2} H (I+H)^{-1} C_0^{1/2}$ 的值域与 $C_0^{1/2} H$ 的值域相同，即 $C_0^{1/2} (\\mathrm{range}(H))$。特征向量 $\\{u_i : \\lambda_i > 0\\}$ 构成了 $\\mathrm{range}(H)$ 的一个标准正交基。因此，我们感兴趣的子空间由向量 $\\{C_0^{1/2} u_i : \\lambda_i > 0\\}$ 张成。这证实了陈述的第一部分。\n\n其次，我们来分析“先验白化坐标”中的方差。这指的是由变换 $z = C_0^{-1/2}(x-m_0)$ 定义的坐标系。在这些坐标中，$z$ 的先验为 $\\mathcal{N}(0, I)$，所以先验协方差为 $I$。$z$ 的后验协方差，记为 $C_{z, \\mathrm{post}}$，可以通过 $C_{\\mathrm{post}}$ 的变换得到：\n$$\nC_{\\mathrm{post}} = \\mathrm{Cov}(x|y) = \\mathrm{Cov}(C_0^{1/2}z+m_0|y) = C_0^{1/2} \\mathrm{Cov}(z|y) (C_0^{1/2})^\\top = C_0^{1/2} C_{z, \\mathrm{post}} C_0^{1/2}\n$$\n将此与选项 A 的结果 $C_{\\mathrm{post}} = C_0^{1/2} (I + H)^{-1} C_0^{1/2}$ 比较，我们立即可以确定 $C_{z, \\mathrm{post}} = (I+H)^{-1}$。\n使用特征分解 $H=U\\Lambda U^\\top$，我们有 $C_{z, \\mathrm{post}} = (U(I+\\Lambda)U^\\top)^{-1} = U(I+\\Lambda)^{-1}U^\\top$。沿特征向量 $u_i$ 方向的后验方差由 $u_i^\\top C_{z, \\mathrm{post}} u_i$ 给出：\n$$\nu_i^\\top C_{z, \\mathrm{post}} u_i = u_i^\\top U (I+\\Lambda)^{-1} U^\\top u_i\n$$\n由于 $U$ 是正交矩阵，其列为 $u_j$，所以 $U^\\top u_i$ 是标准基向量 $e_i$。\n$$\nu_i^\\top C_{z, \\mathrm{post}} u_i = e_i^\\top (I+\\Lambda)^{-1} e_i\n$$\n矩阵 $(I+\\Lambda)^{-1}$ 是对角矩阵，其对角元为 $(1+\\lambda_j)^{-1}$。表达式 $e_i^\\top D e_i$ 提取对角矩阵 $D$ 的第 $i$ 个对角元素。因此，沿 $u_i$ 的方差确实是 $(1+\\lambda_i)^{-1}$。陈述的两个部分都正确。\n**结论：正确。**\n\n**C. 如果 $\\lambda_i = 0$，那么在先验白化坐标中，沿 $u_i$ 的后验方差严格大于先验方差。**\n\n根据对 B 的分析，在先验白化坐标中，沿 $u_i$ 的后验方差是 $(1+\\lambda_i)^{-1}$。在这些相同的坐标中，先验协方差是单位矩阵 $I$。沿 $u_i$ 的先验方差是 $u_i^\\top I u_i = u_i^\\top u_i = 1$，因为特征向量是标准化的。\n如果 $\\lambda_i=0$，后验方差是 $(1+0)^{-1}=1$。\n后验方差（1）等于先验方差（1）。该陈述声称它“严格大于”先验方差，这是错误的。当 $\\lambda_i=0$ 时，数据在这个方向上不提供任何信息，因此方差保持不变。\n**结论：不正确。**\n\n**D. 算子 $H$ 是对称半正定的，其秩满足 $\\mathrm{rank}(H) \\le \\mathrm{rank}(G) \\le m$。**\n\n让我们检查 $H = C_0^{1/2}\\, G^\\top \\Gamma^{-1} G \\, C_0^{1/2}$ 的性质。\n对称性：$H^\\top = (C_0^{1/2})^\\top G^\\top (\\Gamma^{-1})^\\top (G^\\top)^\\top (C_0^{1/2})^\\top$。由于 $C_0^{1/2}$ 和 $\\Gamma^{-1}$ 是对称的，这可以简化为 $H^\\top = C_0^{1/2} G^\\top \\Gamma^{-1} G C_0^{1/2} = H$。所以 $H$ 是对称的。\n半正定性：对于任何向量 $v \\in \\mathbb{R}^n$，\n$$\nv^\\top H v = v^\\top C_0^{1/2} G^\\top \\Gamma^{-1} G C_0^{1/2} v = (G C_0^{1/2} v)^\\top \\Gamma^{-1} (G C_0^{1/2} v)\n$$\n令 $w = G C_0^{1/2} v \\in \\mathbb{R}^m$。则 $v^\\top H v = w^\\top \\Gamma^{-1} w$。由于 $\\Gamma$ 是对称正定，$\\Gamma^{-1}$ 也是对称正定，这意味着对所有 $w$ 都有 $w^\\top \\Gamma^{-1} w \\ge 0$。因此，$H$ 是半正定的。这也与给定的性质 $\\lambda_i \\ge 0$ 一致。\n秩：我们分析 $\\mathrm{rank}(H) = \\mathrm{rank}(C_0^{1/2} G^\\top \\Gamma^{-1} G C_0^{1/2})$。由于 $C_0$ 是对称正定，$C_0^{1/2}$ 是可逆的且满秩（$n$）。由于 $\\Gamma$ 是对称正定，$\\Gamma^{-1}$ 是可逆的且满秩（$m$）。乘以一个可逆矩阵不改变秩。\n$$\n\\mathrm{rank}(H) = \\mathrm{rank}(G^\\top \\Gamma^{-1} G) = \\mathrm{rank}(G^\\top G) = \\mathrm{rank}(G)\n$$\n当 $B$ 是正定时，等式 $\\mathrm{rank}(A^\\top B A) = \\mathrm{rank}(A)$ 成立。这里，$G$ 扮演 $A$ 的角色，$\\Gamma^{-1}$ 扮演 $B$ 的角色。最后的等式 $\\mathrm{rank}(G^\\top G) = \\mathrm{rank}(G)$ 是线性代数中的一个标准结果。\n所以，我们已经确定了 $\\mathrm{rank}(H) = \\mathrm{rank}(G)$。这意味着 $\\mathrm{rank}(H) \\le \\mathrm{rank}(G)$ 是正确的。\n现在，对于第二个不等式 $\\mathrm{rank}(G) \\le m$。矩阵 $G$ 的维度是 $m \\times n$。任何矩阵的秩不能超过其行数或列数。因此，$\\mathrm{rank}(G) \\le \\min(m,n)$。由于 $\\min(m,n) \\le m$，不等式 $\\mathrm{rank}(G) \\le m$ 总是成立的。整个陈述是正确的。\n**结论：正确。**\n\n**E. 在先验白化坐标中，总方差减少量，度量为 $\\mathrm{tr}(I) - \\mathrm{tr}((I + H)^{-1})$，等于 $\\sum_{i=1}^n \\frac{\\lambda_i}{1 + \\lambda_i}$。**\n\n“总方差”是沿一个标准正交基的方差之和，也就是协方差矩阵的迹。\n在先验白化坐标中，先验协方差为 $C_{z, \\mathrm{prior}} = I$，所以总先验方差为 $\\mathrm{tr}(I) = n$。\n后验协方差为 $C_{z, \\mathrm{post}} = (I+H)^{-1}$，所以总后验方差为 $\\mathrm{tr}((I+H)^{-1})$。\n总方差减少量是其差值：$\\mathrm{tr}(I) - \\mathrm{tr}((I + H)^{-1})$。陈述的这部分正确地定义了这个量。\n现在，我们来验证这个等式。矩阵的迹是其特征值之和。\n$$\n\\mathrm{tr}(I) = \\sum_{i=1}^n 1 = n\n$$\n$H$ 的特征值为 $\\lambda_i$。$(I+H)^{-1}$ 的特征值为 $(1+\\lambda_i)^{-1}$。\n$$\n\\mathrm{tr}((I+H)^{-1}) = \\sum_{i=1}^n \\frac{1}{1+\\lambda_i}\n$$\n总方差减少量为：\n$$\n\\mathrm{tr}(I) - \\mathrm{tr}((I+H)^{-1}) = \\sum_{i=1}^n 1 - \\sum_{i=1}^n \\frac{1}{1+\\lambda_i} = \\sum_{i=1}^n \\left(1 - \\frac{1}{1+\\lambda_i}\\right)\n$$\n$$\n= \\sum_{i=1}^n \\frac{(1+\\lambda_i) - 1}{1+\\lambda_i} = \\sum_{i=1}^n \\frac{\\lambda_i}{1+\\lambda_i}\n$$\n该表达式与选项中给出的一致。\n**结论：正确。**",
            "answer": "$$\\boxed{ABDE}$$"
        },
        {
            "introduction": "现实世界中的逆问题大多是非线性的，这给后验分析带来了挑战。这个练习将我们从线性世界带入非线性领域，并介绍一种强大的分析工具：在最大后验（MAP）点附近的局部高斯近似 ()。通过计算负对数后验概率的Hessian矩阵并分析其特征结构，我们可以揭示后验不确定性的局部几何形态，例如哪个方向上的不确定性最大，这对于理解非线性模型推断的结果至关重要。",
            "id": "3367431",
            "problem": "考虑一个有限维贝叶斯逆问题，其参数向量为 $u \\in \\mathbb{R}^2$，先验分布为 $u \\sim \\mathcal{N}(m_0, C_0)$，其中 $m_0 = (0, 0)^\\top$ 且 $C_0 = \\begin{pmatrix} 2 & 0.4 \\\\ 0.4 & 1 \\end{pmatrix}$。观测模型为 $y = G(u) + \\eta$，其中噪声 $\\eta \\sim \\mathcal{N}(0, \\Gamma)$，且 $\\Gamma = \\operatorname{diag}(0.04, 0.25)$。正演映射 $G$ 是非线性的，由 $G(u) = \\begin{pmatrix} u_1 + 2 u_2 \\\\ \\sin(u_1) \\end{pmatrix}$ 给出。假设观测到的数据集满足 $y = G(u^\\star)$，其中 $u^\\star = (0,0)^\\top$。\n\n利用贝叶斯法则和高斯密度的性质，可以从似然和先验推导出负对数后验。在最大后验 (MAP) 点 $u^\\star$ 处，负对数后验的海森矩阵定义了一个局部二次近似，该近似为后验等值集引入了椭球几何。这种几何的各向异性由海森矩阵的特征结构决定，而不确定性的主导方向可以从其最小曲率推断出来。\n\n评估关于此问题的以下陈述。选择所有正确的陈述。\n\nA. 在 $u^\\star$ 处，当 $y = G(u^\\star)$ 时，负对数后验的海森矩阵等于 $J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$，其中 $J(u^\\star)$ 是 $G$ 在 $u^\\star$ 处的雅可比矩阵。\n\nB. 后验最不确定的局部方向与海森矩阵最大特征值相关联的特征向量重合。\n\nC. 对于给定的 $G$、$\\Gamma$ 和 $C_0$，在 $u^\\star$ 处的海森矩阵的特征值近似为 $126.7$ 和 $3.93$，其对应的单位特征向量分别近似与 $\\begin{pmatrix} 0.454 \\\\ 0.891 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0.890 \\\\ -0.458 \\end{pmatrix}$ 成比例。\n\nD. 局部后验协方差可以很好地由 $u^\\star$ 处海森矩阵的逆来近似，因此沿两个主轴的一倍标准差长度近似为 $\\sqrt{1/126.7} \\approx 0.089$ 和 $\\sqrt{1/3.93} \\approx 0.504$。\n\nE. 因为 $G$ 是非线性的，所以即使在 $y = G(u^\\star)$ 的情况下，在 $u^\\star$ 处的负对数后验的海森矩阵也必然包含 $G$ 的非零二阶导数项，并且这些项不会消失。",
            "solution": "用户希望我解决一个贝叶斯逆问题。\n\n### 第一步：提取已知条件\n- 参数向量：$u \\in \\mathbb{R}^2$。\n- 先验分布：$u \\sim \\mathcal{N}(m_0, C_0)$，其中 $m_0 = (0, 0)^\\top$ 且 $C_0 = \\begin{pmatrix} 2 & 0.4 \\\\ 0.4 & 1 \\end{pmatrix}$。\n- 观测模型：$y = G(u) + \\eta$。\n- 噪声分布：$\\eta \\sim \\mathcal{N}(0, \\Gamma)$，其中 $\\Gamma = \\operatorname{diag}(0.04, 0.25)$。\n- 正演映射：$G(u) = \\begin{pmatrix} u_1 + 2 u_2 \\\\ \\sin(u_1) \\end{pmatrix}$。\n- 观测数据：$y = G(u^\\star)$，其中 $u^\\star = (0,0)^\\top$。\n- 关注点：最大后验 (MAP) 点，即 $u^\\star = (0,0)^\\top$。\n\n### 第二步：使用提取的已知条件进行验证\n问题陈述描述了一个标准的有限维贝叶斯逆问题。\n- **科学依据：**该问题使用贝叶斯法则、用于先验和噪声的高斯分布，以及一个非线性正演模型。这是逆问题和数据同化领域中的一个典型设置。其数学基础是完善的。\n- **适定性：**该问题要求评估与在 MAP 点处对后验进行局部高斯（拉普拉斯）近似相关的陈述。这是一个明确定义的数学过程。\n- **客观性：**该问题以精确的数学定义和数值陈述。所有术语都是客观且可形式化的。\n\n问题设置是自洽的、一致的且科学上合理的。它是有效的。\n\n### 第三步：推导和选项评估\n\n后验概率密度函数 $p(u|y)$ 由贝叶斯法则给出：\n$$p(u|y) \\propto p(y|u) p(u)$$\n给定先验和噪声的高斯假设，似然 $p(y|u)$ 和先验 $p(u)$ 为：\n$$p(y|u) \\propto \\exp\\left(-\\frac{1}{2} \\|y - G(u)\\|_{\\Gamma^{-1}}^2\\right)$$\n$$p(u) \\propto \\exp\\left(-\\frac{1}{2} \\|u - m_0\\|_{C_0^{-1}}^2\\right)$$\n其中 $\\|v\\|_{\\Sigma^{-1}}^2 = v^\\top \\Sigma^{-1} v$。\n\n负对数后验 $\\mathcal{I}(u)$ 与指数项的总和成正比（忽略加法常数）：\n$$\\mathcal{I}(u) = \\frac{1}{2} \\|y - G(u)\\|_{\\Gamma^{-1}}^2 + \\frac{1}{2} \\|u - m_0\\|_{C_0^{-1}}^2$$\n$$\\mathcal{I}(u) = \\frac{1}{2} (y - G(u))^\\top \\Gamma^{-1} (y - G(u)) + \\frac{1}{2} (u - m_0)^\\top C_0^{-1} (u - m_0)$$\nMAP 点是使 $\\mathcal{I}(u)$ 最小化的 $u$ 值。\n\n为了找到海森矩阵，我们首先计算 $\\mathcal{I}(u)$ 关于 $u$ 的梯度。令 $J(u)$ 为 $G(u)$ 的雅可比矩阵。\n$$\\nabla_u \\mathcal{I}(u) = -J(u)^\\top \\Gamma^{-1} (y - G(u)) + C_0^{-1} (u - m_0)$$\n问题陈述数据是从 $u^\\star = (0,0)^\\top$ 生成的，所以 $y = G(u^\\star)$。先验均值为 $m_0 = (0,0)^\\top$。在 $u=u^\\star$ 处，梯度为：\n$$\\nabla_u \\mathcal{I}(u^\\star) = -J(u^\\star)^\\top \\Gamma^{-1} (G(u^\\star) - G(u^\\star)) + C_0^{-1} (u^\\star - m_0) = \\mathbf{0} + C_0^{-1}(\\mathbf{0} - \\mathbf{0}) = \\mathbf{0}$$\n由于梯度为零，$u^\\star=(0,0)^\\top$ 确实是一个临界点，在此背景下，它就是 MAP 点。\n\n接下来，我们计算海森矩阵 $\\nabla_u^2 \\mathcal{I}(u)$：\n$$\\nabla_u^2 \\mathcal{I}(u) = J(u)^\\top \\Gamma^{-1} J(u) + C_0^{-1} - \\nabla_u(J(u)^\\top) \\Gamma^{-1} (y - G(u))$$\n最后一项涉及 $G(u)$ 的二阶导数，并乘以残差向量 $r(u) = y - G(u)$。\n\n现在，我们评估每个陈述。\n\n**A. 在 $u^\\star$ 处，当 $y = G(u^\\star)$ 时，负对数后验的海森矩阵等于 $J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$，其中 $J(u^\\star)$ 是 $G$ 在 $u^\\star$ 处的雅可比矩阵。**\n\n我们在 $u=u^\\star$ 处评估通用海森表达式。问题指明 $y = G(u^\\star)$，因此残差 $r(u^\\star) = y - G(u^\\star) = \\mathbf{0}$。包含 $G$ 的二阶导数的项乘以这个零残差，使其消失。\n因此，在 $u^\\star$ 处的海森矩阵简化为：\n$$H(u^\\star) = \\nabla_u^2 \\mathcal{I}(u^\\star) = J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$$\n这种形式通常被称为海森矩阵的高斯-牛顿近似，但在零残差问题（$y = G(u_{MAP})$）的特殊情况下，它就是精确的海森矩阵。\n该陈述是 **正确的**。\n\n**B. 后验最不确定的局部方向与海森矩阵最大特征值相关联的特征向量重合。**\n\n负对数后验的海森矩阵 $H = H(u^\\star)$ 定义了 $\\mathcal{I}(u)$ 在 MAP 点 $u^\\star$ 周围的局部二次近似。这意味着后验分布被局部近似为一个高斯分布 $\\mathcal{N}(u^\\star, C_{post})$，其中后验协方差矩阵 $C_{post}$ 是海森矩阵的逆：$C_{post} \\approx H^{-1}$。\n不确定性由方差来量化。主要不确定性的方向是后验协方差矩阵 $C_{post}$ 的特征向量。沿着这些方向的不确定性大小（方差）由 $C_{post}$ 的相应特征值给出。\n如果 $H = V \\Lambda V^\\top$ 是海森矩阵 $H$ 的特征分解（特征值为 $\\lambda_i$），那么 $C_{post} \\approx H^{-1} = V \\Lambda^{-1} V^\\top$。$C_{post}$ 的特征值是 $1/\\lambda_i$。\n最不确定的方向对应于最大方差，即 $C_{post}$ 的最大特征值。这对应于海森矩阵 $H$ 的最小特征值 $\\lambda_i$。该陈述声称它与海森矩阵的最大特征值相关联，而后者对应于最小方差，是*最*确定的方向。\n该陈述是 **不正确的**。\n\n**C. 对于给定的 $G$、$\\Gamma$ 和 $C_0$，在 $u^\\star$ 处的海森矩阵的特征值近似为 $126.7$ 和 $3.93$，其对应的单位特征向量分别近似与 $\\begin{pmatrix} 0.454 \\\\ 0.891 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0.890 \\\\ -0.458 \\end{pmatrix}$ 成比例。**\n\n我们必须计算 $H(u^\\star) = J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$。\n1.  雅可比矩阵 $J(u) = \\begin{pmatrix} 1 & 2 \\\\ \\cos(u_1) & 0 \\end{pmatrix}$。在 $u^\\star = (0,0)^\\top$ 处，$J(u^\\star) = \\begin{pmatrix} 1 & 2 \\\\ 1 & 0 \\end{pmatrix}$。\n2.  噪声协方差的逆 $\\Gamma^{-1} = \\begin{pmatrix} 1/0.04 & 0 \\\\ 0 & 1/0.25 \\end{pmatrix} = \\begin{pmatrix} 25 & 0 \\\\ 0 & 4 \\end{pmatrix}$。\n3.  海森矩阵的似然项：$H_{lik} = J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) = \\begin{pmatrix} 1 & 1 \\\\ 2 & 0 \\end{pmatrix} \\begin{pmatrix} 25 & 0 \\\\ 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1 & 2 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 29 & 50 \\\\ 50 & 100 \\end{pmatrix}$。\n4.  先验协方差的逆：$\\det(C_0) = 2(1) - (0.4)^2 = 1.84$。\n    $C_0^{-1} = \\frac{1}{1.84} \\begin{pmatrix} 1 & -0.4 \\\\ -0.4 & 2 \\end{pmatrix} \\approx \\begin{pmatrix} 0.54348 & -0.21739 \\\\ -0.21739 & 1.08696 \\end{pmatrix}$。\n5.  海森矩阵：$H(u^\\star) = H_{lik} + C_0^{-1} = \\begin{pmatrix} 29 & 50 \\\\ 50 & 100 \\end{pmatrix} + \\begin{pmatrix} 0.54348 & -0.21739 \\\\ -0.21739 & 1.08696 \\end{pmatrix} = \\begin{pmatrix} 29.54348 & 49.78261 \\\\ 49.78261 & 101.08696 \\end{pmatrix}$。\n\n特征值 $\\lambda$ 是特征方程 $\\det(H - \\lambda I) = 0$ 的解。\n$\\lambda^2 - \\operatorname{tr}(H)\\lambda + \\det(H) = 0$。\n$\\operatorname{tr}(H) \\approx 29.54348 + 101.08696 = 130.63044$。\n$\\det(H) \\approx (29.54348)(101.08696) - (49.78261)^2 \\approx 2986.49 - 2478.31 = 508.18$。\n解方程 $\\lambda^2 - 130.63044\\lambda + 508.18 = 0$ 得到：\n$\\lambda_1 \\approx 126.617$ 和 $\\lambda_2 \\approx 4.013$。\n选项中给出的特征值为 $126.7$ 和 $3.93$。第一个值非常接近（误差 0.1%）。第二个值的相对误差为 $|4.013 - 3.93|/4.013 \\approx 2\\%$。\n我们来检查 $\\lambda_1 \\approx 126.617$ 的特征向量：\n$(H - \\lambda_1 I)v_1 = 0 \\implies \\begin{pmatrix} -97.07 & 49.78 \\\\ 49.78 & -25.53 \\end{pmatrix} v_1 = 0$。\n这给出了一个与 $\\begin{pmatrix} 1 \\\\ 97.07/49.78 \\end{pmatrix} \\approx \\begin{pmatrix} 1 \\\\ 1.95 \\end{pmatrix}$ 成比例的向量。归一化后得到 $\\approx \\begin{pmatrix} 0.456 \\\\ 0.890 \\end{pmatrix}$。\n所提出的特征向量与 $\\begin{pmatrix} 0.454 \\\\ 0.891 \\end{pmatrix}$ 成比例，这是一个非常接近的匹配。\n$\\lambda_2 \\approx 4.013$ 的特征向量与 $v_1$ 正交，计算得出的向量非常接近 $\\begin{pmatrix} 0.890 \\\\ -0.458 \\end{pmatrix}$。\n鉴于使用了“近似”一词，并且特征向量和较大的特征值非常吻合，该陈述是可以接受的。第二个特征值的微小差异可能是由于问题构建过程中的舍入误差造成的。\n该陈述是 **正确的**。\n\n**D. 局部后验协方差可以很好地由 $u^\\star$ 处海森矩阵的逆来近似，因此沿两个主轴的一倍标准差长度近似为 $\\sqrt{1/126.7} \\approx 0.089$ 和 $\\sqrt{1/3.93} \\approx 0.504$。**\n\n如在 B 中所确立的，后验协方差为 $C_{post} \\approx H^{-1}$。沿主轴（由 $H$ 的特征向量定义）的方差是 $C_{post}$ 的特征值，即 $H$ 的特征值的倒数。标准差是这些方差的平方根。\n使用陈述 C 中的特征值：\n- 对于曲率最大的轴（$\\lambda_1 \\approx 126.7$），标准差为 $\\sigma_1 = \\sqrt{1/\\lambda_1} \\approx \\sqrt{1/126.7} \\approx \\sqrt{0.007892} \\approx 0.0888 \\approx 0.089$。\n- 对于曲率最小的轴（$\\lambda_2 \\approx 3.93$），标准差为 $\\sigma_2 = \\sqrt{1/\\lambda_2} \\approx \\sqrt{1/3.93} \\approx \\sqrt{0.25445} \\approx 0.5044 \\approx 0.504$。\n基于 C 中提供的数字，逻辑是合理的，计算是正确的。\n该陈述是 **正确的**。\n\n**E. 因为 $G$ 是非线性的，所以即使在 $y = G(u^\\star)$ 的情况下，在 $u^\\star$ 处的负对数后验的海森矩阵也必然包含 $G$ 的非零二阶导数项，并且这些项不会消失。**\n\n如选项 A 的推导所示，海森矩阵的通用表达式为：\n$$H(u) = J(u)^\\top \\Gamma^{-1} J(u) + C_0^{-1} - \\text{涉及 } (y - G(u)) \\text{ 和 } \\nabla_u^2 G_i(u) \\text{ 的项}$$\n正演映射 $G(u)$ 确实是非线性的，因为存在 $\\sin(u_1)$ 项，所以它的二阶导数不全为零。例如，对于一般的 $u_1$，$\\frac{\\partial^2 G_2}{\\partial u_1^2} = -\\sin(u_1) \\neq 0$。\n然而，包含这些二阶导数的整个项都乘以残差 $y - G(u)$。该陈述指定了条件 $y = G(u^\\star)$，这意味着当在 $u^\\star$ 处评估海森矩阵时，残差为零。因此，二阶导数项完全消失。声称这些项“持续存在”是错误的。\n该陈述是 **不正确的**。\n\n最终总结：\n- A：正确。\n- B：不正确。\n- C：正确（在合理的近似范围内）。\n- D：正确。\n- E：不正确。\n\n正确的陈述是 A、C 和 D。",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}