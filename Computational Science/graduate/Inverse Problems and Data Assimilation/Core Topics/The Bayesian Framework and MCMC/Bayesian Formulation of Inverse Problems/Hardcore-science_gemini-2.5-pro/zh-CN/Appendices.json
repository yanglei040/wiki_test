{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在搭建统计贝叶斯公式与数值优化实践之间的桥梁。我们将从第一性原理（贝叶斯定理）出发，推导用于最大后验（MAP）估计的目标函数，并揭示其与吉洪诺夫正则化的等价性。此练习的重点是推导大规模优化问题的基本工具——梯度和海森向量积——并以“无矩阵”形式表示，这对于解决高维逆问题至关重要。",
            "id": "3401544",
            "problem": "考虑一个反问题和数据同化背景下的线性观测模型。令未知状态向量为 $x \\in \\mathbb{R}^{n}$，观测数据为 $y \\in \\mathbb{R}^{m}$。观测算子是线性映射 $A : \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$。观测噪声 $\\varepsilon \\in \\mathbb{R}^{m}$ 被建模为一个零均值高斯随机变量的实现，其协方差矩阵 $R \\in \\mathbb{R}^{m \\times m}$ 是对称正定的。状态 $x$ 的高斯先验由 $x \\sim \\mathcal{N}(x_{b}, B)$ 给出，其中 $x_{b} \\in \\mathbb{R}^{n}$ 是背景（先验均值），$B \\in \\mathbb{R}^{n \\times n}$ 是对称正定的。假设可以进行 $A$、其伴随算子 $A^{T}$ 以及逆 $R^{-1}$ 和 $B^{-1}$ 的无矩阵算子作用，但不假设可以获取任何显式的矩阵分解或矩阵元素。\n\n从贝叶斯准则和高斯概率密度函数的定义出发，推导用于最大后验（MAP）估计的负对数后验目标函数，并证明其与 Tikhonov 正则化的等价性。然后，推导该目标函数的梯度和 Hessian-向量积的表达式，并用可用的算子作用 $A$、$A^{T}$、$R^{-1}$ 和 $B^{-1}$ 明确表示。您的推导必须从高斯似然和先验的基本定义开始，并且过程中不得引用任何预先推导出的公式。\n\n您必须将最终的梯度表示为 $x$ 的函数，将 Hessian-向量积表示为任意向量 $v \\in \\mathbb{R}^{n}$ 的函数，两者都只使用可用算子作用的组合。不要引入除指定矩阵之外的任何其他矩阵。目标是给出一个无矩阵实现的描述：表达式的写法应使每一项都对应于将算子 $A$、$A^{T}$、$R^{-1}$ 和 $B^{-1}$ 作用于向量。\n\n以两个闭式解析表达式的形式提供您的最终答案：一个用于梯度，一个用于 Hessian-向量积。最终答案必须是包含这两个表达式的单行矩阵。不需要进行数值计算。",
            "solution": "首先将根据指定标准验证问题陈述。\n\n### 问题验证\n\n#### 第1步：提取已知条件\n- 未知状态向量：$x \\in \\mathbb{R}^{n}$\n- 观测数据：$y \\in \\mathbb{R}^{m}$\n- 观测算子（线性映射）：$A : \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$\n- 线性观测模型：$y = Ax + \\varepsilon$\n- 观测噪声：$\\varepsilon \\in \\mathbb{R}^{m}$ 是一个零均值高斯随机变量的实现，所以 $\\varepsilon \\sim \\mathcal{N}(0, R)$。\n- 噪声协方差矩阵：$R \\in \\mathbb{R}^{m \\times m}$，对称正定。\n- 状态的先验分布：$x \\sim \\mathcal{N}(x_{b}, B)$。\n- 先验均值（背景状态）：$x_{b} \\in \\mathbb{R}^{n}$。\n- 先验协方差矩阵：$B \\in \\mathbb{R}^{n \\times n}$，对称正定。\n- 可用的算子作用：将 $A$、$A^T$、$R^{-1}$ 和 $B^{-1}$ 作用于向量。\n\n#### 第2步：使用提取的已知条件进行验证\n- **科学基础：** 该问题是贝叶斯反问题和数据同化中的一个标准公式，构成了像 3D-Var 和 4D-Var 等方法的基础。高斯先验和噪声的假设是这些领域中基本且广泛使用的。该问题在科学上是合理的。\n- **适定性：** 该问题要求推导标准结果。$R$ 和 $B$ 是对称正定的假设确保了概率密度函数有良好定义，并且由此产生的优化问题是严格凸的，具有唯一最小值。该问题是适定的。\n- **客观性：** 该问题以精确的数学语言陈述，没有主观性或模糊性。\n\n该问题未违反任何列出的不合格标准（科学上不合理、非形式化、设置不完整、不切实际、不适定、伪深刻、无法验证）。这是一个计算科学中标准的、定义明确的理论问题。\n\n#### 第3步：结论与行动\n问题有效。将提供一个完整、合理的解答。\n\n### MAP 目标函数的推导及其与 Tikhonov 正则化的等价性\n\n最大后验（MAP）估计的目标是找到在给定观测值 $y$ 的情况下，使后验概率密度函数（PDF）$p(x|y)$ 最大化的状态 $x$。根据贝叶斯准则，后验概率与似然和先验的乘积成正比：\n$$p(x|y) \\propto p(y|x) p(x)$$\n最大化 $p(x|y)$ 等价于最大化其对数 $\\ln(p(x|y))$，而这又等价于最小化其负对数 $-\\ln(p(x|y))$。因此，MAP 估计由下式给出：\n$$x_{\\text{MAP}} = \\arg\\max_{x} p(x|y) = \\arg\\min_{x} [-\\ln(p(y|x)) - \\ln(p(x))]$$\n现在我们根据给定的高斯分布来定义似然项和先验项。对于一个均值为 $\\mu$、协方差为 $\\Sigma$ 的通用多元高斯随机变量 $z \\in \\mathbb{R}^k$，其 PDF 为：\n$$p(z) = \\frac{1}{\\sqrt{(2\\pi)^k \\det(\\Sigma)}} \\exp\\left(-\\frac{1}{2} (z-\\mu)^T \\Sigma^{-1} (z-\\mu)\\right)$$\n\n**1. 似然项：**\n似然 $p(y|x)$ 是给定状态 $x$ 时观测值 $y$ 的 PDF。观测模型为 $y = Ax + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, R)$。这意味着对于给定的 $x$，$y$ 是一个高斯随机变量，其均值为 $E[y|x] = E[Ax + \\varepsilon] = Ax + E[\\varepsilon] = Ax$，协方差为 $\\text{Cov}(y|x) = \\text{Cov}(Ax + \\varepsilon) = \\text{Cov}(\\varepsilon) = R$。因此，$y|x \\sim \\mathcal{N}(Ax, R)$。似然函数为：\n$$p(y|x) \\propto \\exp\\left(-\\frac{1}{2} (y-Ax)^T R^{-1} (y-Ax)\\right)$$\n忽略常数项，负对数似然为：\n$$-\\ln(p(y|x)) = \\frac{1}{2} (y-Ax)^T R^{-1} (y-Ax) + C_1$$\n\n**2. 先验项：**\n状态 $x$ 的先验分布由 $x \\sim \\mathcal{N}(x_{b}, B)$ 给出。其 PDF 为：\n$$p(x) \\propto \\exp\\left(-\\frac{1}{2} (x-x_{b})^T B^{-1} (x-x_{b})\\right)$$\n忽略常数项，负对数先验为：\n$$-\\ln(p(x)) = \\frac{1}{2} (x-x_{b})^T B^{-1} (x-x_{b}) + C_2$$\n\n**3. MAP 目标函数：**\n结合负对数似然和负对数先验，我们得到需要最小化的目标函数 $J(x)$：\n$$J(x) = \\frac{1}{2} (y-Ax)^T R^{-1} (y-Ax) + \\frac{1}{2} (x-x_{b})^T B^{-1} (x-x_{b})$$\n这就是用于 MAP 估计的负对数后验目标函数（相差一个加性常数和一个比例因子 $2$）。\n\n**与 Tikhonov 正则化的等价性：**\nTikhonov 正则化是一种求解不适定反问题（通常形式为 $Ax=y$）的方法。正则化解是通过最小化一个结合了数据保真项和正则化项的目标函数来找到的：\n$$\\min_{x} \\left( \\|Ax - y\\|^2_{W} + \\|\\mathcal{L}(x - x_0)\\|^2_{P} \\right)$$\n其中 $\\|\\cdot\\|_M$ 表示由 $\\|v\\|_M^2 = v^T M v$ 定义的加权范数，$\\mathcal{L}$ 是一个正则化算子。\n\nMAP 目标函数 $J(x)$ 可以用这种范数符号写出。通过将数据保真项的权重矩阵设为 $W=R^{-1}$，正则化算子设为单位算子 $\\mathcal{L}=I$，参考解设为先验均值 $x_0 = x_b$，以及正则化权重矩阵设为 $P=B^{-1}$，我们的目标函数变为：\n$$2J(x) = \\|Ax - y\\|^2_{R^{-1}} + \\|x - x_{b}\\|^2_{B^{-1}}$$\n这表明在高斯假设下的 MAP 估计在数学上等价于 Tikhonov 正则化。第一项 $\\|Ax - y\\|^2_{R^{-1}}$ 衡量了模型预测 $Ax$ 和数据 $y$ 之间的失配度，并由观测误差协方差的逆加权。第二项 $\\|x - x_{b}\\|^2_{B^{-1}}$ 是一个正则化项，它惩罚偏离先验信念 $x_b$ 的解，并由先验协方差的逆加权。\n\n### 梯度和 Hessian-向量积的推导\n\n**1. 目标函数的梯度：**\n梯度 $\\nabla J(x)$ 是通过对 $J(x)$ 关于向量 $x$ 求导得到的。我们分别对 $J(x)$ 的两项进行求导。\n令 $J_d(x) = \\frac{1}{2} (y-Ax)^T R^{-1} (y-Ax)$ 和 $J_b(x) = \\frac{1}{2} (x-x_{b})^T B^{-1} (x-x_{b})$。\n\n对于数据项 $J_d(x)$，我们考虑一个小扰动 $x \\to x + \\delta x$。\n残差的变化为 $y - A(x+\\delta x) = (y-Ax) - A\\delta x$。\n$$J_d(x+\\delta x) = \\frac{1}{2} ((y-Ax) - A\\delta x)^T R^{-1} ((y-Ax) - A\\delta x)$$\n$$J_d(x+\\delta x) = \\frac{1}{2} (y-Ax)^T R^{-1} (y-Ax) - \\frac{1}{2} (A\\delta x)^T R^{-1} (y-Ax) - \\frac{1}{2} (y-Ax)^T R^{-1} (A\\delta x) + O(\\|\\delta x\\|^2)$$\n由于 $R$ 及其逆 $R^{-1}$ 都是对称的，这两个线性项是相等的。\n$$J_d(x+\\delta x) = J_d(x) - (y-Ax)^T R^{-1} A \\delta x + O(\\|\\delta x\\|^2)$$\n方向导数为 $\\nabla J_d(x)^T \\delta x = (A^T R^{-1} (Ax-y))^T \\delta x$。因此，数据项的梯度是：\n$$\\nabla J_d(x) = A^T R^{-1} (Ax - y)$$\n\n对于背景项 $J_b(x)$，类似的推导得出：\n$$\\nabla J_b(x) = B^{-1} (x - x_b)$$\n\n目标函数的总梯度是其各部分梯度之和：\n$$\\nabla J(x) = \\nabla J_d(x) + \\nabla J_b(x) = A^T R^{-1} (Ax - y) + B^{-1} (x - x_b)$$\n这个表达式的结构适合于无矩阵实现。例如，计算 $A^T R^{-1} (Ax - y)$ 涉及将 $A$ 作用于 $x$，进行向量减法，将 $R^{-1}$ 作用于结果，最后再作用 $A^T$。\n\n**2. Hessian-向量积：**\nHessian 矩阵 $H(x) = \\nabla^2 J(x)$ 是通过对梯度 $\\nabla J(x)$ 关于 $x$ 求导得到的。对于任意向量 $v \\in \\mathbb{R}^n$ 的 Hessian-向量积 $H(x)v$ 可以通过求梯度的方向导数来推导，即 $H(x)v = \\frac{d}{d\\epsilon} [\\nabla J(x + \\epsilon v)]_{\\epsilon=0}$。\n\n我们来计算 $\\nabla J(x+\\epsilon v)$：\n$$\\nabla J(x+\\epsilon v) = A^T R^{-1} (A(x+\\epsilon v) - y) + B^{-1} ((x+\\epsilon v) - x_b)$$\n$$\\nabla J(x+\\epsilon v) = A^T R^{-1} (Ax - y) + \\epsilon A^T R^{-1} Av + B^{-1} (x - x_b) + \\epsilon B^{-1} v$$\n$$\\nabla J(x+\\epsilon v) = \\nabla J(x) + \\epsilon (A^T R^{-1} Av + B^{-1} v)$$\n现在，我们对 $\\epsilon$ 求导：\n$$\\frac{d}{d\\epsilon} [\\nabla J(x + \\epsilon v)] = A^T R^{-1} Av + B^{-1} v$$\n这个表达式与 $\\epsilon$ 无关，因此令 $\\epsilon=0$ 即可得到 Hessian-向量积：\n$$H(x)v = A^T R^{-1} Av + B^{-1} v$$\nHessian 矩阵本身是 $H(x) = A^T R^{-1} A + B^{-1}$，它相对于 $x$ 是一个常数。对于一个二次目标函数，这是预期的结果。$H(x)v$ 的计算是无矩阵的：它涉及将 $A$ 作用于 $v$，然后作用 $R^{-1}$，再作用 $A^T$，然后将结果与将 $B^{-1}$ 作用于 $v$ 的结果相加。",
            "answer": "$$\\boxed{\\begin{pmatrix} A^T R^{-1} (Ax - y) + B^{-1} (x - x_{b})  A^T R^{-1} Av + B^{-1}v \\end{pmatrix}}$$"
        },
        {
            "introduction": "在建立了寻找后验众数的通用优化框架之后，通过解析地解决一个简单问题来获得关于贝叶斯更新的直观理解是很有启发性的。本练习将研究一个线性高斯问题，在此问题中我们可以精确计算后验均值和协方差。它清晰地展示了观测如何减少不确定性，以及先验相关性（或其缺乏）如何影响状态向量中已观测和未观测分量的更新。",
            "id": "3380095",
            "problem": "考虑一个在贝叶斯框架下提出的线性逆问题。未知状态为 $x \\in \\mathbb{R}^{2}$，其先验分布为高斯分布 $x \\sim \\mathcal{N}(m_{0}, C_{0})$。单个标量观测值 $y \\in \\mathbb{R}$ 通过一个带有加性高斯噪声的线性正演算子与状态相关联，即 $y = H x + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, R)$ 且独立于 $x$。维度为 $n = 2$ 和 $p = 1$。假设给定以下数据：$H = \\begin{bmatrix} 1  0 \\end{bmatrix}$，$m_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，$C_{0} = \\mathrm{diag}(1, 10)$，$R = 1$，以及一个实现的观测值 $y = 1$。\n\n仅使用适用于线性高斯贝叶斯逆问题和基于集合的不确定性传播的基本原理，完成以下任务：\n- 从第一性原理出发，推导后验分布 $x | y \\sim \\mathcal{N}(m_{a}, C_{a})$，并根据给定数据得出 $m_{a}$ 和 $C_{a}$ 的闭式表达式。\n- 根据交叉协方差及其在基于集合的更新中的作用，解释在给定先验条件下，未观测分量 $x_{2}$ 是否被观测值更新。\n\n作为对您推导的单个标量检验，请报告观测分量 $x_{1}$ 的后验方差作为您的最终答案。请以精确数值形式提供最终答案，不带单位。无需四舍五入。",
            "solution": "我们从线性高斯贝叶斯逆问题的设定开始。状态的先验分布为 $x \\sim \\mathcal{N}(m_{0}, C_{0})$，其中 $m_{0} \\in \\mathbb{R}^{2}$，$C_{0} \\in \\mathbb{R}^{2 \\times 2}$ 为对称正定矩阵；数据模型为 $y = H x + \\eta$，其中 $H \\in \\mathbb{R}^{1 \\times 2}$，$\\eta \\sim \\mathcal{N}(0, R)$ 独立于 $x$，且 $R \\in \\mathbb{R}^{1 \\times 1}$ 为正值。$(x, y)$ 的联合分布是高斯的，因此后验分布 $x | y$ 也是高斯的。获取后验参数的标准方法是使用贝叶斯定理和多元正态分布的性质，这可以通过在联合高斯密度的指数部分进行配方法来推导。\n\n先验密度写为\n$$\n\\pi(x) \\propto \\exp\\left( -\\tfrac{1}{2} (x - m_{0})^{\\top} C_{0}^{-1} (x - m_{0}) \\right),\n$$\n似然函数写为\n$$\n\\mathcal{L}(y \\mid x) \\propto \\exp\\left( -\\tfrac{1}{2} (y - H x)^{\\top} R^{-1} (y - H x) \\right).\n$$\n后验密度，在忽略比例常数的情况下，为\n$$\n\\pi(x \\mid y) \\propto \\exp\\left( -\\tfrac{1}{2} (x - m_{0})^{\\top} C_{0}^{-1} (x - m_{0}) - \\tfrac{1}{2} (y - H x)^{\\top} R^{-1} (y - H x) \\right).\n$$\n展开 $x$ 的二次型并配方，后验分布为高斯分布，其精度（协方差的逆）为\n$$\nC_{a}^{-1} = C_{0}^{-1} + H^{\\top} R^{-1} H,\n$$\n均值为\n$$\nm_{a} = C_{a} \\left( C_{0}^{-1} m_{0} + H^{\\top} R^{-1} y \\right).\n$$\n等价地，可以使用卡尔曼增益 $K$ 来表示后验均值，\n$$\nK = C_{0} H^{\\top} \\left( H C_{0} H^{\\top} + R \\right)^{-1},\n$$\n为\n$$\nm_{a} = m_{0} + K \\left( y - H m_{0} \\right),\n$$\n后验协方差为\n$$\nC_{a} = C_{0} - K H C_{0}.\n$$\n\n我们现在将这些公式应用于给定的数据。维度为 $n = 2$, $p = 1$，且\n$$\nH = \\begin{bmatrix} 1  0 \\end{bmatrix}, \\quad m_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}, \\quad C_{0} = \\begin{bmatrix} 1  0 \\\\ 0  10 \\end{bmatrix}, \\quad R = 1, \\quad y = 1.\n$$\n计算新息协方差：\n$$\nS = H C_{0} H^{\\top} + R = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  10 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + 1 = 1 + 1 = 2.\n$$\n计算卡尔曼增益：\n$$\nK = C_{0} H^{\\top} S^{-1} = \\begin{bmatrix} 1  0 \\\\ 0  10 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\cdot \\frac{1}{2} = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix}.\n$$\n计算后验均值：\n$$\nm_{a} = m_{0} + K (y - H m_{0}) = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} \\left( 1 - \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\right) = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix}.\n$$\n计算后验协方差：\n$$\nC_{a} = C_{0} - K H C_{0}.\n$$\n首先，计算 $K H$：\n$$\nK H = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} 1/2  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n然后，\n$$\nK H C_{0} = \\begin{bmatrix} 1/2  0 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  10 \\end{bmatrix} = \\begin{bmatrix} 1/2  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n因此，\n$$\nC_{a} = \\begin{bmatrix} 1  0 \\\\ 0  10 \\end{bmatrix} - \\begin{bmatrix} 1/2  0 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 1/2  0 \\\\ 0  10 \\end{bmatrix}.\n$$\n\n从交叉协方差和基于集合的不确定性传播的角度进行解释：在线性高斯设定中，状态-观测交叉协方差为 $C_{x y} = C_{0} H^{\\top}$。这里，\n$$\nC_{x y} = \\begin{bmatrix} 1  0 \\\\ 0  10 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n$C_{x y}$ 的第二个分量为 $0$，这表明未观测的状态分量 $x_{2}$ 与观测值之间具有零先验交叉协方差。在基于集合的方法中，例如集合卡尔曼滤波器 (EnKF)，每个状态分量的更新量与其与预测观测值的样本交叉协方差成正比。当该交叉协方差为零时，相应的分量不会从数据中获得任何更新。与此原理一致，我们发现 $K = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix}$，因此只有 $x_{1}$ 被更新，而 $x_{2}$ 的后验均值和方差分别保持为 $0$ 和 $10$。\n\n所要求的标量检验是 $x_{1}$ 的后验方差，根据 $C_{a}$，它是 $(1,1)$ 项，等于 $1/2$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "现实世界中的逆问题通常是非线性的，这使得后验分布呈非高斯性且难以解析处理。一个常用且强大的方法是，用一个高斯分布在其众数（MAP 点）附近对后验进行局部近似。本实践问题将指导您完成这一过程，即拉普拉斯近似，通过分析负对数后验在 MAP 点的海森矩阵，来刻画后验不确定性的几何形状和主方向。",
            "id": "3367431",
            "problem": "考虑一个有限维贝叶斯逆问题，其参数向量为 $u \\in \\mathbb{R}^2$，先验分布为 $u \\sim \\mathcal{N}(m_0, C_0)$，其中 $m_0 = (0, 0)^\\top$ 且 $C_0 = \\begin{pmatrix} 2  0.4 \\\\ 0.4  1 \\end{pmatrix}$，观测模型为 $y = G(u) + \\eta$，其中噪声 $\\eta \\sim \\mathcal{N}(0, \\Gamma)$ 且 $\\Gamma = \\operatorname{diag}(0.04, 0.25)$。正向映射是非线性的，由 $G(u) = \\begin{pmatrix} u_1 + 2 u_2 \\\\ \\sin(u_1) \\end{pmatrix}$ 给出。假设观测到的数据集满足 $y = G(u^\\star)$，其中 $u^\\star = (0,0)^\\top$。\n\n使用贝叶斯法则和高斯密度的性质，可以从似然和先验推导出负对数后验。在最大后验 (MAP) 点 $u^\\star$ 处，负对数后验的海森矩阵定义了一个局部二次近似，该近似为后验等值集引入了椭球几何。这种几何的各向异性由海森矩阵的特征结构决定，而不确定性的主导方向可以从其最小曲率推断出来。\n\n评估关于此问题的以下陈述。选择所有正确的选项。\n\nA. 在 $u^\\star$ 处，当 $y = G(u^\\star)$ 时，负对数后验的海森矩阵等于 $J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$，其中 $J(u^\\star)$ 是 $G$ 在 $u^\\star$ 处的雅可比矩阵。\n\nB. 后验的最不确定的局部方向与海森矩阵最大特征值相关联的特征向量重合。\n\nC. 对于给定的 $G$、$\\Gamma$ 和 $C_0$，在 $u^\\star$ 处海森矩阵的特征值近似为 $126.7$ 和 $3.93$，其对应的单位特征向量分别近似正比于 $\\begin{pmatrix} 0.454 \\\\ 0.891 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0.890 \\\\ -0.458 \\end{pmatrix}$。\n\nD. 局部后验协方差可由 $u^\\star$ 处的海森矩阵的逆很好地近似，因此沿两个主轴的单标准差长度近似为 $\\sqrt{1/126.7} \\approx 0.089$ 和 $\\sqrt{1/3.93} \\approx 0.504$。\n\nE. 因为 $G$ 是非线性的，所以在 $u^\\star$ 处的负对数后验的海森矩阵必然包含 $G$ 的非零二阶导数项，即使当 $y = G(u^\\star)$ 时这些项也持续存在。",
            "solution": "用户希望我解决一个贝叶斯逆问题。\n\n### 步骤 1：提取已知条件\n- 参数向量：$u \\in \\mathbb{R}^2$。\n- 先验分布：$u \\sim \\mathcal{N}(m_0, C_0)$，其中 $m_0 = (0, 0)^\\top$ 且 $C_0 = \\begin{pmatrix} 2  0.4 \\\\ 0.4  1 \\end{pmatrix}$。\n- 观测模型：$y = G(u) + \\eta$。\n- 噪声分布：$\\eta \\sim \\mathcal{N}(0, \\Gamma)$，其中 $\\Gamma = \\operatorname{diag}(0.04, 0.25)$。\n- 正向映射：$G(u) = \\begin{pmatrix} u_1 + 2 u_2 \\\\ \\sin(u_1) \\end{pmatrix}$。\n- 观测数据：$y = G(u^\\star)$，其中 $u^\\star = (0,0)^\\top$。\n- 关注点：最大后验 (MAP) 点，即 $u^\\star = (0,0)^\\top$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述描述了一个标准的有限维贝叶斯逆问题。\n- **科学依据：**该问题使用了贝叶斯法则、用于先验和噪声的高斯分布以及一个非线性正向模型。这是逆问题和数据同化领域中的一个典型设置。其数学基础是完善的。\n- **良态性：**该问题要求评估关于在 MAP 点处后验的局部高斯（拉普拉斯）近似的陈述。这是一个定义明确的数学过程。\n- **客观性：**该问题用精确的数学定义和数值来陈述。所有术语都是客观且可形式化的。\n\n该问题设置是自洽的、一致的且科学上合理的。它是有效的。\n\n### 步骤 3：推导与选项评估\n\n后验概率密度函数 $p(u|y)$ 由贝叶斯法则给出：\n$$p(u|y) \\propto p(y|u) p(u)$$\n给定先验和噪声的高斯假设，似然 $p(y|u)$ 和先验 $p(u)$ 为：\n$$p(y|u) \\propto \\exp\\left(-\\frac{1}{2} \\|y - G(u)\\|_{\\Gamma^{-1}}^2\\right)$$\n$$p(u) \\propto \\exp\\left(-\\frac{1}{2} \\|u - m_0\\|_{C_0^{-1}}^2\\right)$$\n其中 $\\|v\\|_{\\Sigma^{-1}}^2 = v^\\top \\Sigma^{-1} v$。\n\n负对数后验 $\\mathcal{I}(u)$ 与指数项的和成正比（忽略加性常数）：\n$$\\mathcal{I}(u) = \\frac{1}{2} \\|y - G(u)\\|_{\\Gamma^{-1}}^2 + \\frac{1}{2} \\|u - m_0\\|_{C_0^{-1}}^2$$\n$$\\mathcal{I}(u) = \\frac{1}{2} (y - G(u))^\\top \\Gamma^{-1} (y - G(u)) + \\frac{1}{2} (u - m_0)^\\top C_0^{-1} (u - m_0)$$\nMAP 点是使 $\\mathcal{I}(u)$ 最小化的 $u$ 的值。\n\n为了找到海森矩阵，我们首先计算 $\\mathcal{I}(u)$ 关于 $u$ 的梯度。令 $J(u)$ 为 $G(u)$ 的雅可比矩阵。\n$$\\nabla_u \\mathcal{I}(u) = -J(u)^\\top \\Gamma^{-1} (y - G(u)) + C_0^{-1} (u - m_0)$$\n问题陈述数据是由 $u^\\star = (0,0)^\\top$ 生成的，因此 $y = G(u^\\star)$。先验均值为 $m_0 = (0,0)^\\top$。在 $u=u^\\star$ 处，梯度为：\n$$\\nabla_u \\mathcal{I}(u^\\star) = -J(u^\\star)^\\top \\Gamma^{-1} (G(u^\\star) - G(u^\\star)) + C_0^{-1} (u^\\star - m_0) = \\mathbf{0} + C_0^{-1}(\\mathbf{0} - \\mathbf{0}) = \\mathbf{0}$$\n由于梯度为零，$u^\\star=(0,0)^\\top$ 确实是一个临界点，并且在此背景下，它就是 MAP 点。\n\n接下来，我们计算海森矩阵 $\\nabla_u^2 \\mathcal{I}(u)$：\n$$\\nabla_u^2 \\mathcal{I}(u) = J(u)^\\top \\Gamma^{-1} J(u) + C_0^{-1} - \\nabla_u(J(u)^\\top) \\Gamma^{-1} (y - G(u))$$\n最后一项涉及 $G(u)$ 的二阶导数，并乘以残差向量 $r(u) = y - G(u)$。\n\n现在，我们评估每个陈述。\n\n**A. 在 $u^\\star$ 处，当 $y = G(u^\\star)$ 时，负对数后验的海森矩阵等于 $J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$，其中 $J(u^\\star)$ 是 $G$ 在 $u^\\star$ 处的雅可比矩阵。**\n\n我们在 $u=u^\\star$ 处评估海森矩阵的一般表达式。问题指明 $y = G(u^\\star)$，因此残差 $r(u^\\star) = y - G(u^\\star) = \\mathbf{0}$。包含 $G$ 的二阶导数的项乘以这个零残差，导致该项消失。\n因此，在 $u^\\star$ 处的海森矩阵简化为：\n$$H(u^\\star) = \\nabla_u^2 \\mathcal{I}(u^\\star) = J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$$\n这种形式通常被称为海森矩阵的高斯-牛顿近似，但在零残差问题（$y = G(u_{MAP})$）的特殊情况下，它就是精确的海森矩阵。\n该陈述是 **正确的**。\n\n**B. 后验的最不确定的局部方向与海森矩阵最大特征值相关联的特征向量重合。**\n\n负对数后验的海森矩阵 $H = H(u^\\star)$ 定义了 MAP 点 $u^\\star$ 附近 $\\mathcal{I}(u)$ 的一个局部二次近似。这意味着后验分布被局部近似为一个高斯分布 $\\mathcal{N}(u^\\star, C_{post})$，其中后验协方差矩阵 $C_{post}$ 是海森矩阵的逆：$C_{post} \\approx H^{-1}$。\n不确定性由方差量化。主要不确定性的方向是后验协方差矩阵 $C_{post}$ 的特征向量。沿着这些方向的不确定性大小（方差）由 $C_{post}$ 的相应特征值给出。\n如果 $H = V \\Lambda V^\\top$ 是海森矩阵 $H$ 的特征分解（特征值为 $\\lambda_i$），那么 $C_{post} \\approx H^{-1} = V \\Lambda^{-1} V^\\top$。$C_{post}$ 的特征值是 $1/\\lambda_i$。\n最不确定的方向对应于最大的方差，即 $C_{post}$ 的最大特征值。这对应于海森矩阵 $H$ 的最小特征值 $\\lambda_i$。该陈述声称它与海森矩阵的最大特征值相关，而这对应于最小的方差，是*最不*不确定的方向。\n该陈述是 **不正确的**。\n\n**C. 对于给定的 $G$、$\\Gamma$ 和 $C_0$，在 $u^\\star$ 处海森矩阵的特征值近似为 $126.7$ 和 $3.93$，其对应的单位特征向量分别近似正比于 $\\begin{pmatrix} 0.454 \\\\ 0.891 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0.890 \\\\ -0.458 \\end{pmatrix}$。**\n\n我们必须计算 $H(u^\\star) = J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) + C_0^{-1}$。\n1.  雅可比矩阵 $J(u) = \\begin{pmatrix} 1  2 \\\\ \\cos(u_1)  0 \\end{pmatrix}$。在 $u^\\star = (0,0)^\\top$ 处，$J(u^\\star) = \\begin{pmatrix} 1  2 \\\\ 1  0 \\end{pmatrix}$。\n2.  逆噪声协方差 $\\Gamma^{-1} = \\begin{pmatrix} 1/0.04  0 \\\\ 0  1/0.25 \\end{pmatrix} = \\begin{pmatrix} 25  0 \\\\ 0  4 \\end{pmatrix}$。\n3.  海森矩阵的似然项：$H_{lik} = J(u^\\star)^\\top \\Gamma^{-1} J(u^\\star) = \\begin{pmatrix} 1  1 \\\\ 2  0 \\end{pmatrix} \\begin{pmatrix} 25  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} 1  2 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 25  4 \\\\ 50  0 \\end{pmatrix} \\begin{pmatrix} 1  2 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 29  50 \\\\ 50  100 \\end{pmatrix}$。\n4.  逆先验协方差：$\\det(C_0) = 2(1) - (0.4)^2 = 1.84$。\n    $C_0^{-1} = \\frac{1}{1.84} \\begin{pmatrix} 1  -0.4 \\\\ -0.4  2 \\end{pmatrix} \\approx \\begin{pmatrix} 0.54348  -0.21739 \\\\ -0.21739  1.08696 \\end{pmatrix}$。\n5.  海森矩阵：$H(u^\\star) = H_{lik} + C_0^{-1} = \\begin{pmatrix} 29  50 \\\\ 50  100 \\end{pmatrix} + \\begin{pmatrix} 0.54348  -0.21739 \\\\ -0.21739  1.08696 \\end{pmatrix} = \\begin{pmatrix} 29.54348  49.78261 \\\\ 49.78261  101.08696 \\end{pmatrix}$。\n\n特征值 $\\lambda$ 是特征方程 $\\det(H - \\lambda I) = 0$ 的解。\n$\\lambda^2 - \\operatorname{tr}(H)\\lambda + \\det(H) = 0$。\n$\\operatorname{tr}(H) \\approx 29.54348 + 101.08696 = 130.63044$。\n$\\det(H) \\approx (29.54348)(101.08696) - (49.78261)^2 \\approx 2986.49 - 2478.31 = 508.18$。\n求解 $\\lambda^2 - 130.63044\\lambda + 508.18 = 0$ 得到：\n$\\lambda_1 \\approx 126.617$ 和 $\\lambda_2 \\approx 4.013$。\n选项中给出的特征值是 $126.7$ 和 $3.93$。第一个值非常接近（误差  0.1%）。第二个值的相对误差为 $|4.013 - 3.93|/4.013 \\approx 2\\%$。\n我们来检查 $\\lambda_1 \\approx 126.617$ 的特征向量：\n$(H - \\lambda_1 I)v_1 = 0 \\implies \\begin{pmatrix} -97.07  49.78 \\\\ 49.78  -25.53 \\end{pmatrix} v_1 = 0$。\n这给出了一个与 $\\begin{pmatrix} 1 \\\\ 97.07/49.78 \\end{pmatrix} \\approx \\begin{pmatrix} 1 \\\\ 1.95 \\end{pmatrix}$ 成正比的向量。归一化后得到 $\\approx \\begin{pmatrix} 0.456 \\\\ 0.890 \\end{pmatrix}$。\n所提出的特征向量与 $\\begin{pmatrix} 0.454 \\\\ 0.891 \\end{pmatrix}$ 成正比，这是一个非常接近的匹配。\n$\\lambda_2 \\approx 4.013$ 的特征向量与 $v_1$ 正交，计算得出的向量非常接近于 $\\begin{pmatrix} 0.890 \\\\ -0.458 \\end{pmatrix}$。\n鉴于使用了‘近似’一词，并且特征向量和较大的特征值吻合得很好，该陈述是可以接受的。第二个特征值的微小差异可能是由于问题构造过程中的四舍五入造成的。\n该陈述是 **正确的**。\n\n**D. 局部后验协方差可由 $u^\\star$ 处的海森矩阵的逆很好地近似，因此沿两个主轴的单标准差长度近似为 $\\sqrt{1/126.7} \\approx 0.089$ 和 $\\sqrt{1/3.93} \\approx 0.504$。**\n\n如在 B 中所确立的，后验协方差为 $C_{post} \\approx H^{-1}$。沿主轴（由 $H$ 的特征向量定义）的方差是 $C_{post}$ 的特征值，它们是 $H$ 特征值的倒数。标准差是这些方差的平方根。\n使用陈述 C 中的特征值：\n- 对于曲率最大的轴（$\\lambda_1 \\approx 126.7$），标准差是 $\\sigma_1 = \\sqrt{1/\\lambda_1} \\approx \\sqrt{1/126.7} \\approx \\sqrt{0.007892} \\approx 0.0888 \\approx 0.089$。\n- 对于曲率最小的轴（$\\lambda_2 \\approx 3.93$），标准差是 $\\sigma_2 = \\sqrt{1/\\lambda_2} \\approx \\sqrt{1/3.93} \\approx \\sqrt{0.25445} \\approx 0.5044 \\approx 0.504$。\n逻辑是合理的，并且基于 C 中提供的数字，计算是正确的。\n该陈述是 **正确的**。\n\n**E. 因为 $G$ 是非线性的，所以在 $u^\\star$ 处的负对数后验的海森矩阵必然包含 $G$ 的非零二阶导数项，即使当 $y = G(u^\\star)$ 时这些项也持续存在。**\n\n正如为选项 A 推导的那样，海森矩阵的一般表达式是：\n$$H(u) = J(u)^\\top \\Gamma^{-1} J(u) + C_0^{-1} - \\text{term involving } (y - G(u)) \\text{ and } \\nabla_u^2 G_i(u)$$\n正向映射 $G(u)$ 确实是非线性的，因为有 $\\sin(u_1)$ 项，所以它的二阶导数不全为零。例如，对于一般的 $u_1$，$\\frac{\\partial^2 G_2}{\\partial u_1^2} = -\\sin(u_1) \\neq 0$。\n然而，包含这些二阶导数的整个项都乘以残差 $y - G(u)$。该陈述指定了条件 $y = G(u^\\star)$，这意味着当海森矩阵在 $u^\\star$ 处求值时，残差为零。因此，二阶导数项完全消失。声称这些项“持续存在”是错误的。\n该陈述是 **不正确的**。\n\n最终总结：\n- A: 正确。\n- B: 不正确。\n- C: 正确（在合理近似范围内）。\n- D: 正确。\n- E: 不正确。\n\n正确的陈述是 A、C 和 D。",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}