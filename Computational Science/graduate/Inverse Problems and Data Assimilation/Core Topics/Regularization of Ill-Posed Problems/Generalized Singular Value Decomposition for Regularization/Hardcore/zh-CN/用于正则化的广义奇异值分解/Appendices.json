{
    "hands_on_practices": [
        {
            "introduction": "在理解了如何用 GSVD 构建解之后，一个关键的实践问题随之而来：解如何依赖于数据拟合项和正则化项的相对尺度？此练习探讨吉洪诺夫泛函的尺度不变性。您将研究当算子 $A$ 和 $L$ 被重新缩放时，广义奇异值以及更重要的正则化参数 $\\lambda$ 必须如何变换才能保持解不变。",
            "id": "3386267",
            "problem": "考虑一个带吉洪诺夫 (Tikhonov) 正则化的线性逆问题：给定矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和 $L \\in \\mathbb{R}^{p \\times n}$ 以及数据 $b \\in \\mathbb{R}^{m}$，定义吉洪诺夫正则化解\n$$\nx_{\\lambda} \\in \\arg\\min_{x \\in \\mathbb{R}^{n}} \\left\\{ \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|L x\\|_{2}^{2} \\right\\},\n$$\n其中 $\\lambda > 0$ 是正则化参数。假设矩阵对 $(A,L)$ 允许广义奇异值分解 (GSVD)，即存在正交矩阵 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{p \\times p}$、一个可逆矩阵 $X \\in \\mathbb{R}^{n \\times n}$，以及满足 $C^{\\top}C + S^{\\top}S = I$ 的非负对角矩阵 $C$ 和 $S$（尺寸兼容），使得\n$$\nA = U \\begin{bmatrix} C  0 \\end{bmatrix} Q X^{-1}, \n\\qquad\nL = V \\begin{bmatrix} S  0 \\end{bmatrix} Q X^{-1},\n$$\n其中 $Q$ 是某个尺寸合适的正交矩阵。广义奇异值定义为 $\\gamma_{i} = c_{i}/s_{i}$，适用于所有 $s_{i} > 0$ 的索引 $i$。\n\n现在考虑用正常数 $\\alpha > 0$ 和 $\\beta > 0$ 对算子进行正向缩放：\n$$\n\\tilde{A} = \\alpha A, \n\\qquad \n\\tilde{L} = \\beta L.\n$$\n令 $\\tilde{\\gamma}_{i}$ 表示矩阵对 $(\\tilde{A},\\tilde{L})$ 的广义奇异值，其通过 $(\\tilde{A},\\tilde{L})$ 的GSVD进行类似定义。对于一个数据向量 $\\tilde{b} \\in \\mathbb{R}^{m}$，定义\n$$\n\\tilde{x}_{\\tilde{\\lambda}} \\in \\arg\\min_{x \\in \\mathbb{R}^{n}} \\left\\{ \\|\\tilde{A} x - \\tilde{b}\\|_{2}^{2} + \\tilde{\\lambda}^{2} \\|\\tilde{L} x\\|_{2}^{2} \\right\\}.\n$$\n\n任务：\n1. 从GSVD定义和正规方程出发，说明广义奇异值在缩放 $(\\tilde{A},\\tilde{L}) = (\\alpha A,\\beta L)$ 下如何变换，并用 $\\gamma_{i}$、$\\alpha$ 和 $\\beta$ 表示 $\\tilde{\\gamma}_{i}$。\n2. 确定 $\\tilde{b}$ 的选择和一个显式变换 $\\tilde{\\lambda} = \\tilde{\\lambda}(\\lambda,\\alpha,\\beta)$，使得对于任意数据向量 $b$，都有 $\\tilde{x}_{\\tilde{\\lambda}} = x_{\\lambda}$ 成立。你的最终答案必须是 $\\tilde{\\lambda}$ 作为 $\\lambda$、$\\alpha$ 和 $\\beta$ 的函数的单个显式闭式表达式（无单位）。",
            "solution": "问题陈述经分析后被认为是有效的。它在科学上基于逆问题和数值线性代数的理论，特别是吉洪诺夫正则化和广义奇异值分解（GSVD）。该问题是适定的、客观的，并包含足够的信息来推导所要求的量。GSVD的表述方式虽然包含了一个正交矩阵 $Q$ 而略显非标准，但在数学上等同于标准定义，且不引入矛盾。\n\n解答过程按问题陈述的要求分为两部分。\n\n第1部分：广义奇异值 $\\gamma_i$ 的变换。\n\n矩阵对 $(A, L)$ 的广义奇异值 $\\gamma_i$ 定义为矩阵束 $(A^{\\top}A, L^{\\top}L)$ 的广义特征值 $\\mu_i = \\gamma_i^2$ 的平方根。这些特征值是广义特征值问题的解\n$$\nA^{\\top}A v_i = \\mu_i L^{\\top}L v_i\n$$\n其中 $v_i \\in \\mathbb{R}^n$ 是某个广义特征向量。\n\n现在，考虑缩放后的矩阵 $\\tilde{A} = \\alpha A$ 和 $\\tilde{L} = \\beta L$，其中 $\\alpha > 0$ 且 $\\beta > 0$。新的广义奇异值，记为 $\\tilde{\\gamma}_i$，对应于新矩阵束 $(\\tilde{A}^{\\top}\\tilde{A}, \\tilde{L}^{\\top}\\tilde{L})$ 的广义特征值 $\\tilde{\\mu}_i = \\tilde{\\gamma}_i^2$。新的广义特征值问题是\n$$\n\\tilde{A}^{\\top}\\tilde{A} w_i = \\tilde{\\mu}_i \\tilde{L}^{\\top}\\tilde{L} w_i.\n$$\n代入 $\\tilde{A}$ 和 $\\tilde{L}$ 的定义，我们得到\n$$\n(\\alpha A)^{\\top}(\\alpha A) w_i = \\tilde{\\mu}_i (\\beta L)^{\\top}(\\beta L) w_i\n$$\n$$\n\\alpha^2 (A^{\\top}A) w_i = \\tilde{\\mu}_i \\beta^2 (L^{\\top}L) w_i.\n$$\n因为 $\\alpha$ 和 $\\beta$ 非零，我们可以将方程重新排列为\n$$\nA^{\\top}A w_i = \\left( \\frac{\\beta^2}{\\alpha^2} \\tilde{\\mu}_i \\right) L^{\\top}L w_i.\n$$\n该方程与原始的广义特征值问题具有相同的形式。这意味着广义特征向量是相同的（即，我们可以选择 $w_i = v_i$），并且广义特征值之间有如下关系\n$$\n\\mu_i = \\frac{\\beta^2}{\\alpha^2} \\tilde{\\mu}_i.\n$$\n求解 $\\tilde{\\mu}_i$ 可得\n$$\n\\tilde{\\mu}_i = \\frac{\\alpha^2}{\\beta^2} \\mu_i.\n$$\n广义奇异值是广义特征值的正平方根，因此 $\\gamma_i = \\sqrt{\\mu_i}$ 且 $\\tilde{\\gamma}_i = \\sqrt{\\tilde{\\mu}_i}$。对上述关系式两边取平方根，得到\n$$\n\\tilde{\\gamma}_i = \\sqrt{\\frac{\\alpha^2}{\\beta^2} \\mu_i} = \\frac{\\alpha}{\\beta} \\sqrt{\\mu_i} = \\frac{\\alpha}{\\beta} \\gamma_i,\n$$\n因为 $\\alpha, \\beta, \\gamma_i, \\tilde{\\gamma}_i$ 都被定义为非负（且在数值有意义时为正）。\n\n第2部分：为保证解不变性而确定 $\\tilde{b}$ 和 $\\tilde{\\lambda}$。\n\n原始的吉洪诺夫正则化解 $x_{\\lambda}$ 是目标泛函的最小化子\n$$\nJ(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|L x\\|_{2}^{2}.\n$$\n缩放后的问题旨在寻找目标泛函的最小化子 $\\tilde{x}_{\\tilde{\\lambda}}$\n$$\n\\tilde{J}(x) = \\|\\tilde{A} x - \\tilde{b}\\|_{2}^{2} + \\tilde{\\lambda}^{2} \\|\\tilde{L} x\\|_{2}^{2}.\n$$\n我们的任务是找到 $\\tilde{b}$ 的一个选择和 $\\tilde{\\lambda}$ 的一个关系式，使得对于任意数据向量 $b$，都有 $\\tilde{x}_{\\tilde{\\lambda}} = x_{\\lambda}$。这意味着对于任何 $b$，$J(x)$ 和 $\\tilde{J}(x)$ 的最小化子集合必须相同。如果两个目标泛函中的一个是另一个的正数倍加上一个不依赖于优化变量 $x$ 的常数项，那么它们具有相同的最小化子。\n\n让我们将 $\\tilde{A} = \\alpha A$ 和 $\\tilde{L} = \\beta L$ 代入 $\\tilde{J}(x)$：\n$$\n\\tilde{J}(x) = \\|\\alpha A x - \\tilde{b}\\|_{2}^{2} + \\tilde{\\lambda}^{2} \\|\\beta L x\\|_{2}^{2}.\n$$\n从范数中提出缩放常数 $\\alpha$ 和 $\\beta$，我们得到\n$$\n\\tilde{J}(x) = \\alpha^2 \\|A x - \\frac{1}{\\alpha}\\tilde{b}\\|_{2}^{2} + \\beta^2 \\tilde{\\lambda}^{2} \\|L x\\|_{2}^{2}.\n$$\n为了使 $J(x)$ 和 $\\tilde{J}(x)$ 的最小化子相同，这两个泛函必须在结构上等价。我们来比较一下 $J(x)$ 和 $\\tilde{J}(x)$。\n$$\nJ(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|L x\\|_{2}^{2}\n$$\n$$\n\\tilde{J}(x) = \\alpha^2 \\|A x - \\frac{1}{\\alpha}\\tilde{b}\\|_{2}^{2} + \\beta^2 \\tilde{\\lambda}^{2} \\|L x\\|_{2}^{2}\n$$\n确保这两个泛函等价的最直接方法是使 $\\tilde{J}(x)$ 成为 $J(x)$ 的常数倍。我们尝试使 $\\tilde{J}(x) = \\alpha^2 J(x)$。\n这需要匹配相应的项。\n首先，对于数据保真项（第一项），我们需要\n$$\n\\alpha^2 \\|A x - \\frac{1}{\\alpha}\\tilde{b}\\|_{2}^{2} = \\alpha^2 \\|A x - b\\|_{2}^{2}.\n$$\n如果我们选择，这个条件就满足\n$$\n\\frac{1}{\\alpha}\\tilde{b} = b \\implies \\tilde{b} = \\alpha b.\n$$\n这是一个有效的 $\\tilde{b}$ 选择，它依赖于 $b$，这是允许的。通过这个选择，保真项相匹配。\n\n接下来，我们匹配正则化项（第二项）：\n$$\n\\beta^2 \\tilde{\\lambda}^{2} \\|L x\\|_{2}^{2} = \\alpha^2 (\\lambda^{2} \\|L x\\|_{2}^{2}).\n$$\n这个等式必须对任何 $x$ 都成立，所以我们必须使系数相等：\n$$\n\\beta^2 \\tilde{\\lambda}^{2} = \\alpha^2 \\lambda^{2}.\n$$\n因为 $\\alpha, \\beta, \\lambda, \\tilde{\\lambda}$ 都是正数，我们可以对两边取平方根：\n$$\n\\beta \\tilde{\\lambda} = \\alpha \\lambda.\n$$\n求解 $\\tilde{\\lambda}$ 得到所需的变换：\n$$\n\\tilde{\\lambda} = \\lambda \\frac{\\alpha}{\\beta}.\n$$\n通过选择 $\\tilde{b} = \\alpha b$ 和 $\\tilde{\\lambda} = \\lambda \\frac{\\alpha}{\\beta}$，缩放后的泛函变为 $\\tilde{J}(x) = \\alpha^2 J(x)$。由于 $\\alpha^2 > 0$，最小化 $\\tilde{J}(x)$ 等价于最小化 $J(x)$，因此对于任何数据向量 $b$，都有 $\\tilde{x}_{\\tilde{\\lambda}} = x_{\\lambda}$。\n\n问题要求给出 $\\tilde{\\lambda}$ 的单个显式闭式表达式。",
            "answer": "$$\n\\boxed{\\lambda \\frac{\\alpha}{\\beta}}\n$$"
        },
        {
            "introduction": "正则化方法的最终目标是从含噪数据中找到一个有意义的解。GSVD 提供了一个理想的框架，在此框架下，信号和噪声的贡献可以被逐分量分析。这个实践问题要求您从代数计算转向统计推断，设计一个诊断程序，以确定数据中的哪些分量主要由噪声构成。这个练习展示了如何将 GSVD 框架与基本的统计原理相结合，从而在从真实世界测量中提取可靠估计时，做出关于截断或滤波解的明智决策。",
            "id": "3386249",
            "problem": "考虑一个带 Tikhonov 型正则化的线性逆问题，其中矩阵对 $(A,L) \\in \\mathbb{R}^{6 \\times 6} \\times \\mathbb{R}^{6 \\times 6}$ 具有广义奇异值分解 (GSVD) 形式 $A = U C Z^{-1}$ 和 $L = V S Z^{-1}$，其中 $U, V \\in \\mathbb{R}^{6 \\times 6}$ 是正交矩阵，$Z \\in \\mathbb{R}^{6 \\times 6}$ 是可逆矩阵，以及 $C = \\operatorname{diag}(c_{1},\\dots,c_{6})$, $S = \\operatorname{diag}(s_{1},\\dots,s_{6})$ 是对角矩阵，且对所有 $i$ 都有 $c_{i}^{2} + s_{i}^{2} = 1$。在本问题中，假设一个特别简单的 GSVD 三元组，由 $U = I_{6}$，$V = I_{6}$，$Z = I_{6}$ 给出，并且\n$$\nC = \\operatorname{diag}(c_{1},\\dots,c_{6}), \\quad c = \\big(0.98,\\,0.80,\\,0.50,\\,0.25,\\,0.10,\\,0.05\\big),\n$$\n以及 $S = \\operatorname{diag}(s_{1},\\dots,s_{6})$ 由 $s_{i} = \\sqrt{1 - c_{i}^{2}}$ 决定。\n\n你观测到形式为 $y = A x_{\\text{true}} + e$ 的含噪数据 $y \\in \\mathbb{R}^{6}$，其中 $x_{\\text{true}} \\in \\mathbb{R}^{6}$ 是未知的，噪声 $e$ 是零均值高斯噪声，协方差为 $\\sigma^{2} I_{6}$。噪声水平为 $\\sigma = 0.05$，实现的（观测到的）数据为\n$$\ny = \\begin{pmatrix} 0.82 \\\\ 0.56 \\\\ 0.17 \\\\ 0.06 \\\\ 0.03 \\\\ 0.02 \\end{pmatrix}.\n$$\n\n在由 $U$ 定义的 GSVD 数据基中进行计算，数据系数为 $\\widehat{y}_{i} = u_{i}^{\\top} y$，其中 $i \\in \\{1,\\dots,6\\}$（$u_{i}$ 表示 $U$ 的第 $i$ 列）。仅使用关于高斯噪声的基本概率事实和适用于独立高斯变量最大值的初等界限，设计一个诊断方法，以确定一个过渡指数 $k^{\\star}$，使得在总体族系错误率（family-wise false-alarm probability）最多为 $\\alpha = 0.05$ 的情况下，所有系数 $\\{ \\widehat{y}_{i} \\}_{i \\ge k^{\\star}}$ 都与以噪声为主导的情况一致。然后将你的诊断方法应用于给定的 $y$，并计算得到的整数指数 $k^{\\star}$。报告 $k^{\\star}$ 的单一整数值；无需四舍五入，不涉及单位。",
            "solution": "问题陈述已通过验证并被认为是有效的。它在科学上植根于线性逆问题和统计学领域，是适定的、客观的，并包含构建和解决问题所需的所有必要信息。\n\n该问题要求我们设计一种诊断方法，为一组数据系数找到一个过渡指数 $k^{\\star}$。该指数应标记一个点，此后的所有系数都与被噪声主导的情况一致。该诊断必须遵循指定的族系错误率。\n\n数据模型由 $y = A x_{\\text{true}} + e$ 给出，其中 $A \\in \\mathbb{R}^{6 \\times 6}$，$x_{\\text{true}} \\in \\mathbb{R}^{6}$，并且 $e \\in \\mathbb{R}^{6}$ 是一个噪声分量向量。噪声 $e$ 被指定为零均值高斯噪声，协方差为 $\\sigma^{2} I_{6}$，且 $\\sigma = 0.05$。这意味着 $e$ 的分量（表示为 $e_i$）是来自正态分布 $\\mathcal{N}(0, \\sigma^2)$ 的独立同分布（i.i.d.）随机变量。\n\n数据系数在 GSVD 基中定义为 $\\widehat{y}_{i} = u_{i}^{\\top} y$，其中 $u_i$ 是正交矩阵 $U$ 的第 $i$ 列。问题指定了一个简化的 GSVD，其中 $U=I_{6}$。单位矩阵 $I_6$ 的列是标准基向量 $u_i = e_i$。因此，数据系数就是数据向量本身的分量：\n$$\n\\widehat{y}_{i} = e_{i}^{\\top} y = y_i\n$$\n观测到的数据向量为 $y = \\begin{pmatrix} 0.82  0.56  0.17  0.06  0.03  0.02 \\end{pmatrix}^{\\top}$。因此，系数为 $|\\widehat{y}_1| = 0.82$, $|\\widehat{y}_2| = 0.56$, $|\\widehat{y}_3| = 0.17$, $|\\widehat{y}_4| = 0.06$, $|\\widehat{y}_5| = 0.03$ 和 $|\\widehat{y}_6| = 0.02$。\n\n我们需要为每个系数 $\\widehat{y}_i$ 确定它是否“与被噪声主导的情况一致”。我们将其形式化为统计假设检验。对于每个指数 $i \\in \\{1, \\dots, 6\\}$，我们陈述原假设 $H_{0,i}$，即第 $i$ 个系数仅由噪声组成。\n第 $i$ 个系数的完整表达式是 $\\widehat{y}_i = u_i^\\top(A x_{\\text{true}} + e)$。给定 $A = U C Z^{-1}$ 以及具体值 $U=I_6, Z=I_6$，表达式变为 $\\widehat{y}_i = e_i^\\top(C x_{\\text{true}} + e) = c_i x_{\\text{true},i} + e_i$。\n因此，原假设 $H_{0,i}$ 对应于信号部分为零：$c_i x_{\\text{true},i} = 0$。在 $H_{0,i}$ 下，系数 $\\widehat{y}_i = e_i$ 是一个从 $\\mathcal{N}(0, \\sigma^2)$ 中抽取的随机变量。\n\n任务要求诊断方法的“总体族系错误率最多为 $\\alpha = 0.05$”。当我们拒绝 $H_{0,i}$（即，我们将系数归类为信号），而它实际上为真（该系数只是噪声）时，就会发生假警报。族系I类错误率（FWER）是在整个 $N=6$ 次检验中犯下一次或多次此类假警报的概率。\n\n为了将 FWER 控制在水平 $\\alpha$，我们采用 Bonferroni 校正。这是联合界（布尔不等式）的直接应用，与问题中提示的“使用适用于独立高斯变量最大值的初等界限”相符。Bonferroni 方法要求对于 $N$ 个检验中的每一个，显著性水平均必须设置为 $\\alpha/N$。\n\n对于单个系数 $\\widehat{y}_i$，我们进行双边检验。如果 $|\\widehat{y}_i|$ 异常大，我们就拒绝 $H_{0,i}$。在 $H_{0,i}$ 下，量 $\\widehat{y}_i/\\sigma$ 服从标准正态分布，$Z \\sim \\mathcal{N}(0,1)$。对于第 $i$ 个检验，假警报的概率是 $P(|\\widehat{y}_i| > T)$，其中 $T$ 是某个阈值。我们将此概率设置为 $\\alpha/N$。\n$$\nP(|\\widehat{y}_i| > T \\mid H_{0,i}) = P\\left(\\left|\\frac{\\widehat{y}_i}{\\sigma}\\right| > \\frac{T}{\\sigma}\\right) = P\\left(|Z| > \\frac{T}{\\sigma}\\right) = \\frac{\\alpha}{N}\n$$\n这意味着 $2 \\left(1 - \\Phi\\left(\\frac{T}{\\sigma}\\right)\\right) = \\frac{\\alpha}{N}$，其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。求解阈值 $T$：\n$$\n\\Phi\\left(\\frac{T}{\\sigma}\\right) = 1 - \\frac{\\alpha}{2N} \\implies T = \\sigma \\cdot \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2N}\\right)\n$$\n我们现在使用给定的值计算这个阈值 $T$：\n- 噪声水平 $\\sigma = 0.05$。\n- 检验次数 $N = 6$。\n- 族系显著性水平 $\\alpha = 0.05$。\n\n逆 CDF 的参数是 $1 - \\frac{0.05}{2 \\times 6} = 1 - \\frac{0.05}{12} \\approx 1 - 0.0041667 = 0.9958333$。\n使用标准统计软件或表格查找逆正态 CDF，我们找到临界值：\n$$\nz_{\\text{crit}} = \\Phi^{-1}(0.9958333) \\approx 2.638\n$$\n现在我们可以计算决策阈值 $T$：\n$$\nT = \\sigma \\cdot z_{\\text{crit}} = 0.05 \\times 2.638 = 0.1319\n$$\n诊断方法如下：如果 $|\\widehat{y}_i| > T$，则系数 $\\widehat{y}_i$ 被归类为信号主导；如果 $|\\widehat{y}_i| \\le T$，则与噪声一致。\n\n我们将此诊断应用于我们的数据系数 $|\\widehat{y}_i| = |y_i|$：\n- $|\\widehat{y}_1| = 0.82 > 0.1319$ (信号)\n- $|\\widehat{y}_2| = 0.56 > 0.1319$ (信号)\n- $|\\widehat{y}_3| = 0.17 > 0.1319$ (信号)\n- $|\\widehat{y}_4| = 0.06 \\le 0.1319$ (噪声)\n- $|\\widehat{y}_5| = 0.03 \\le 0.1319$ (噪声)\n- $|\\widehat{y}_6| = 0.02 \\le 0.1319$ (噪声)\n\n问题将过渡指数 $k^{\\star}$ 定义为最小的整数指数，使得所有系数 $\\{\\widehat{y}_i\\}_{i \\ge k^{\\star}}$ 都与被噪声主导的情况一致。这意味着我们正在寻找最小的 $k$，使得对于所有 $i \\ge k$，条件 $|\\widehat{y}_i| \\le T$ 都成立。\n\n- 对于 $k=1$，条件不成立，因为 $|\\widehat{y}_1| > T$。\n- 对于 $k=2$，条件不成立，因为 $|\\widehat{y}_2| > T$。\n- 对于 $k=3$，条件不成立，因为 $|\\widehat{y}_3| > T$。\n- 对于 $k=4$，条件要求 $|\\widehat{y}_4| \\le T$，$|\\widehat{y}_5| \\le T$ 和 $|\\widehat{y}_6| \\le T$。这三个条件都成立。\n\n由于 $k=4$ 是使该条件成立的最小指数，因此过渡指数为 $k^{\\star} = 4$。",
            "answer": "$$\n\\boxed{4}\n$$"
        }
    ]
}