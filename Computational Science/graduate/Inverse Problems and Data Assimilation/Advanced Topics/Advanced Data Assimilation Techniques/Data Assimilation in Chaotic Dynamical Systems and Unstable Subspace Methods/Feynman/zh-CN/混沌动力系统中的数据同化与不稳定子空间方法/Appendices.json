{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个实践练习将问题简化至其核心。我们通过一个标量（一维）不稳定系统，来分析求解数据同化过程中的稳态估计误差。这个练习对于建立直观理解至关重要，它揭示了滤波器如何在由不稳定动力学导致的误差增长和由新观测数据带来的误差减小之间取得平衡 。",
            "id": "3374492",
            "problem": "考虑一个标量、离散时间的线性高斯动力学系统，该系统旨在表示混沌流的一个局部不稳定方向。状态根据 $x_{k+1}=a x_k+\\eta_k$ 演化，其中 $|a|>1$，$\\{\\eta_k\\}$ 是独立同分布的零均值高斯随机变量序列，其方差为 $Q>0$。观测由 $y_k=x_k+\\epsilon_k$ 给出，其中 $\\{\\epsilon_k\\}$ 是独立同分布的零均值高斯随机变量序列，其方差为 $R>0$。假设 $\\{\\eta_k\\}$, $\\{\\epsilon_k\\}$ 和初始状态 $x_0$ 相互独立，并且在高斯假设下，使用最优线性最小方差估计器（卡尔曼滤波器）对数据进行同化。令 $P_k$ 表示在时间 $k$ 的状态估计的后验（更新后）误差方差。在估计器达到稳态的假设下，定义稳态后验误差方差 $P=\\lim_{k\\to\\infty}P_k$。\n\n从条件高斯定律和线性系统的基于新息的贝叶斯更新出发，推导刻画 $P$ 的不动点方程，并求解其闭式解，从而得到 $P$ 作为 $a$、$Q$ 和 $R$ 的显式函数。然后，通过讨论当 $R\\to 0$，$Q\\to 0$ 和 $|a|\\to\\infty$ 时的极限行为，并解释 $P$ 随每个参数是增加还是减少，来分析 $P$ 对 $a$、$Q$ 和 $R$ 的依赖性。将最终的 $P$ 表示为关于 $a$、$Q$ 和 $R$ 的单个闭式解析表达式。不需要进行数值计算，也不需要进行四舍五入。最终答案必须是 $P$ 的单个解析表达式。",
            "solution": "用户希望求解一个一维、不稳定、线性高斯系统的卡尔曼滤波器的稳态后验误差方差。\n\n首先验证问题陈述。\n\n### 步骤1：提取已知条件\n- 状态演化模型：$x_{k+1}=a x_k+\\eta_k$，其中 $|a|>1$。\n- 状态噪声：$\\{\\eta_k\\}$ 是一个独立同分布(i.i.d.)随机变量序列，$\\eta_k \\sim \\mathcal{N}(0, Q)$，其中 $Q>0$。\n- 观测模型：$y_k=x_k+\\epsilon_k$。\n- 观测噪声：$\\{\\epsilon_k\\}$ 是一个独立同分布(i.i.d.)随机变量序列，$\\epsilon_k \\sim \\mathcal{N}(0, R)$，其中 $R>0$。\n- 独立性：$\\{\\eta_k\\}$, $\\{\\epsilon_k\\}$ 和 $x_0$ 相互独立。\n- 估计器：最优线性最小方差估计器（卡尔曼滤波器）。\n- 定义：$P_k$ 是在时间 $k$ 的状态估计的后验（更新后）误差方差。\n- 定义：$P = \\lim_{k\\to\\infty} P_k$ 是稳态后验误差方差。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个标准的离散时间卡尔曼滤波器，它是数据同化、估计理论和控制论中的一个基本工具。系统是线性的，噪声是高斯的，这些是卡尔曼滤波器达到最优性的经典假设。关注一个不稳定模式（$|a|>1$）及其稳态误差方差是混沌系统和数据同化研究中的一个经典问题。该问题在科学和数学上是合理的。\n- **适定性**：问题是适定的。对于一个时不变、可检测、可稳定的系统，代数Riccati方程存在唯一的正稳态解，这是一个标准结果。这里，系统是标量的，观测矩阵 $H=1$（因此总是可观测的，从而也是可检测的），过程噪声 $Q>0$（因此是可稳定的）。存在一个唯一的、稳定的、有意义的 $P$ 的解。\n- **客观性**：问题以精确、客观的数学语言陈述。\n- **完整性**：所有必要的参数（$a, Q, R$）和统计性质都已定义。问题是自洽的。\n- **未检测到其他缺陷。** 该问题非平凡，需要进行推导和代数运算。\n\n### 步骤3：结论和行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n\n卡尔曼滤波器在预测（预报）和更新（分析）两个步骤的循环中运行。令 $x_k^a$ 为同化观测 $y_k$ 后的状态估计（后验估计），$P_k$ 为其误差方差。令 $x_k^f$ 为基于截至时间 $k-1$ 的信息对时间 $k$ 的状态所做的预报，$P_k^f$ 为其误差方差。\n\n**1. 预测步骤：**\n状态通过动力学模型向前传播。\n状态预报为 $x_k^f = a x_{k-1}^a$。\n预报误差方差传播为：\n$$P_k^f = a^2 P_{k-1} + Q$$\n这里，我们使用 $P_{k-1}$ 表示时间 $k-1$ 的后验方差。\n\n**2. 更新步骤：**\n问题要求从条件高斯定律开始。预报为状态 $x_k$ 提供了一个高斯先验，即 $p(x_k|y_{1:k-1}) = \\mathcal{N}(x_k; x_k^f, P_k^f)$。观测 $y_k$ 提供了一个似然，即 $p(y_k|x_k) = \\mathcal{N}(y_k; x_k, R)$。后验分布 $p(x_k|y_{1:k})$ 与先验和似然的乘积成正比。对于高斯分布，这种贝叶斯更新可以方便地用精度（方差的倒数）来表示。后验精度是先验精度和数据精度（来自似然）之和：\n$$(P_k)^{-1} = (P_k^f)^{-1} + R^{-1}$$\n这是信息滤波器形式下的误差方差更新方程。它等价于更标准的协方差更新形式 $P_k = (1 - K_k)P_k^f$，其中 $K_k = P_k^f(P_k^f+R)^{-1}$ 是卡尔曼增益。\n\n**3. Riccati 递推关系：**\n结合预测和更新步骤，我们得到后验方差 $P_k$ 的一个递推关系：\n$$P_k = \\left( (P_k^f)^{-1} + R^{-1} \\right)^{-1} = \\left( (a^2 P_{k-1} + Q)^{-1} + R^{-1} \\right)^{-1}$$\n这是该标量系统的离散时间代数 Riccati 方程。\n\n**4. 稳态不动点方程：**\n在稳态下，方差变为常数：$\\lim_{k\\to\\infty} P_k = \\lim_{k\\to\\infty} P_{k-1} = P$。递推关系变成一个关于 $P$ 的不动点方程：\n$$P = \\left( (a^2 P + Q)^{-1} + R^{-1} \\right)^{-1}$$\n为了求解 $P$，我们可以对两边取倒数：\n$$P^{-1} = (a^2 P + Q)^{-1} + R^{-1}$$\n$$\\frac{1}{P} = \\frac{1}{a^2 P + Q} + \\frac{1}{R}$$\n我们重新整理各项以求解 $P$：\n$$\\frac{1}{P} - \\frac{1}{R} = \\frac{1}{a^2 P + Q}$$\n$$\\frac{R - P}{PR} = \\frac{1}{a^2 P + Q}$$\n$$(R - P)(a^2 P + Q) = PR$$\n$$a^2 RP + QR - a^2 P^2 - QP = PR$$\n整理成标准二次型 $A P^2 + B P + C = 0$：\n$$-a^2 P^2 + (a^2 R - Q - R)P + QR = 0$$\n$$a^2 P^2 - (a^2 R - R - Q)P - QR = 0$$\n$$a^2 P^2 + (Q + R - a^2 R)P - QR = 0$$\n这就是刻画 $P$ 的不动点方程。\n\n**5. 求解二次方程：**\n我们使用二次公式 $P = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解 $P$，其中系数为：\n$A = a^2$\n$B = Q + (1-a^2)R$\n$C = -QR$\n判别式 $\\Delta$ 为：\n$$\\Delta = B^2 - 4AC = (Q + (1-a^2)R)^2 - 4(a^2)(-QR) = (Q + (1-a^2)R)^2 + 4a^2QR$$\n$P$ 的解为：\n$$P = \\frac{-(Q + (1-a^2)R) \\pm \\sqrt{(Q + (1-a^2)R)^2 + 4a^2QR}}{2a^2}$$\n$$P = \\frac{(a^2-1)R - Q \\pm \\sqrt{\\Delta}}{2a^2}$$\n由于 $P$ 是误差方差，它必须是一个正实数，$P > 0$。分母 $2a^2$ 是正的。我们必须分析分子。令 $Y = (a^2-1)R - Q$。分子是 $Y \\pm \\sqrt{(Q - Y)^2+4a^2QR} = Y \\pm \\sqrt{Y^2+4a^2QR}$。因为 $a^2>0$, $Q>0$, 且 $R>0$，所以项 $4a^2QR$ 严格为正。因此，$\\sqrt{Y^2+4a^2QR} > \\sqrt{Y^2} = |Y|$。\n- 如果我们选择 '$-$' 号，分子是 $Y - \\sqrt{Y^2+4a^2QR}$，它总是负的。这将导致一个负的 $P$，这在物理上是不可能的。\n- 因此，我们必须选择 '$+$' 号。\n\n唯一具有物理意义的解是：\n$$P = \\frac{(a^2-1)R - Q + \\sqrt{(Q + (1-a^2)R)^2 + 4a^2QR}}{2a^2}$$\n这就是稳态后验误差方差 $P$ 的闭式解析表达式。该表达式依赖于 $a^2$，因此与 $a$ 的符号无关，仅与其大小有关。\n\n**6. 依赖性分析：**\n- **当 $R \\to 0$ (完美观测)时：**\n  $P \\to \\frac{-Q + \\sqrt{Q^2}}{2a^2} = \\frac{-Q+Q}{2a^2} = 0$。\n  这是符合预期的，因为完美观测（$R=0$）意味着状态被精确知道，因此其误差方差为零。\n- **当 $Q \\to 0$ (完美模型)时：**\n  $P \\to \\frac{(a^2-1)R + \\sqrt{((1-a^2)R)^2}}{2a^2} = \\frac{(a^2-1)R + \\sqrt{(a^2-1)^2R^2}}{2a^2}$。\n  因为 $|a|>1$，所以 $a^2-1>0$，因此 $\\sqrt{(a^2-1)^2R^2} = (a^2-1)R$。\n  $P \\to \\frac{(a^2-1)R + (a^2-1)R}{2a^2} = \\frac{2(a^2-1)R}{2a^2} = (1 - \\frac{1}{a^2})R$。\n  滤波器达到一个非零的误差方差，因为不稳定的动力学会放大任何初始不确定性，而这种不确定性随后被观测所抵消。\n- **当 $|a| \\to \\infty$ (高度不稳定的系统)时：**\n  我们将分子和分母同除以 $a^2$：\n  $$P = \\frac{(1-1/a^2)R - Q/a^2 + \\sqrt{(Q/a^2 + (1/a^2-1)R)^2 + 4QR/a^2}}{2}$$\n  当 $a^2 \\to \\infty$ 时，分母中带有 $a^2$ 的项趋于零：\n  $$P \\to \\frac{(1-0)R - 0 + \\sqrt{((0-1)R)^2 + 0}}{2} = \\frac{R + \\sqrt{R^2}}{2} = \\frac{R+R}{2} = R$$\n  如果系统极度不稳定，预报误差 $P_k^f$ 会变得非常大，使得先验信息可以忽略不计。后验估计几乎完全由观测决定，因此其误差方差接近观测误差方差 $R$。\n- **对参数的依赖性：**\n  通过对二次方程进行隐式微分，可以证明 $\\frac{\\partial P}{\\partial a^2} > 0$，$\\frac{\\partial P}{\\partial Q} > 0$ 和 $\\frac{\\partial P}{\\partial R} > 0$。这意味着后验误差方差 $P$ 随着不稳定性 $|a|$、模型噪声方差 $Q$ 和观测噪声方差 $R$ 的增加而增加。这在直觉上是正确的，因为这些因素中的每一个都会增加系统的不确定性。",
            "answer": "$$\\boxed{\\frac{(a^2-1)R - Q + \\sqrt{(Q + (1-a^2)R)^2 + 4a^2QR}}{2a^2}}$$"
        },
        {
            "introduction": "在第一个练习的基础上，我们现在转向一个更复杂的多维系统，其中并非所有状态变量都能被直接观测到。这个实践练习介绍了可观测性这一基本概念，并利用可观测性矩阵来判断是否可以从有限的观测时间序列中重构出完整的系统状态。对于任何成功的数据同化方案而言，确保系统的可观测性都是一个关键的先决条件 。",
            "id": "3374524",
            "problem": "考虑一个混沌动力系统沿给定轨迹的离散时间切线性模型，\n$$\nx_{k+1} = A x_k, \\quad y_k = H x_k,\n$$\n其中 $x_k \\in \\mathbb{R}^3$ 且 $y_k \\in \\mathbb{R}$。状态转移矩阵 $A$ 包含一个不稳定、一个中性和一个稳定的方向，其形式为\n$$\nA = \\begin{pmatrix}\n1.5  1  0 \\\\\n0  1  0.5 \\\\\n0  0  0.3\n\\end{pmatrix},\n$$\n且观测算子为\n$$\nH = \\begin{pmatrix} 0  1  0 \\end{pmatrix}.\n$$\n假设在时间 $k = 0, 1, 2$ 采集标量观测值 $y_k$。使用 $n$ 步可观测性矩阵的定义，\n$$\n\\mathcal{O}_n = \\begin{pmatrix}\nH \\\\\nH A \\\\\n\\vdots \\\\\nH A^{n-1}\n\\end{pmatrix},\n$$\n构造 $\\mathcal{O}_3$，并从线性时不变系统可观测性的基本定义出发，计算 $\\operatorname{rank}(\\mathcal{O}_3)$。然后，仅基于此秩以及不可观测子空间是 $\\mathcal{O}_3$ 的零空间的定义，判断是否有任何初始未被观测到的状态分量可以通过这 $3$ 步的观测被辨识出来。请给出秩 $\\operatorname{rank}(\\mathcal{O}_3)$ 作为你的最终数值答案。",
            "solution": "该问题要求在一个有限时间窗口内验证给定线性时不变系统的可观测性。我们得到的状态空间模型为：\n$$\nx_{k+1} = A x_k\n$$\n$$\ny_k = H x_k\n$$\n其中状态向量 $x_k \\in \\mathbb{R}^3$ 且标量观测 $y_k \\in \\mathbb{R}$。状态转移矩阵 $A$ 和观测算子 $H$ 如下所示：\n$$\nA = \\begin{pmatrix}\n1.5  1  0 \\\\\n0  1  0.5 \\\\\n0  0  0.3\n\\end{pmatrix}, \\quad H = \\begin{pmatrix} 0  1  0 \\end{pmatrix}\n$$\n问题要求构造一个观测窗口为 $n=3$ 步（时间为 $k=0, 1, 2$）的可观测性矩阵 $\\mathcal{O}_3$，计算其秩，并讨论其对初始状态分量 $x_0$ 可辨识性的影响。\n\n$n=3$ 的可观测性矩阵定义为：\n$$\n\\mathcal{O}_3 = \\begin{pmatrix}\nH \\\\\nHA \\\\\nHA^2\n\\end{pmatrix}\n$$\n我们来计算这个矩阵的各行。\n\n第一行就是观测算子 $H$：\n$$\nH = \\begin{pmatrix} 0  1  0 \\end{pmatrix}\n$$\n\n第二行是乘积 $HA$：\n$$\nHA = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix}\n1.5  1  0 \\\\\n0  1  0.5 \\\\\n0  0  0.3\n\\end{pmatrix} = \\begin{pmatrix}\n(0)(1.5) + (1)(0) + (0)(0) & (0)(1) + (1)(1) + (0)(0) & (0)(0) + (1)(0.5) + (0)(0.3)\n\\end{pmatrix}\n$$\n$$\nHA = \\begin{pmatrix} 0  1  0.5 \\end{pmatrix}\n$$\n\n第三行是 $HA^2$。首先，我们计算 $A^2$：\n$$\nA^2 = A \\cdot A = \\begin{pmatrix}\n1.5  1  0 \\\\\n0  1  0.5 \\\\\n0  0  0.3\n\\end{pmatrix} \\begin{pmatrix}\n1.5  1  0 \\\\\n0  1  0.5 \\\\\n0  0  0.3\n\\end{pmatrix}\n$$\n$$\nA^2 = \\begin{pmatrix}\n(1.5)(1.5) + (1)(0) + (0)(0) & (1.5)(1) + (1)(1) + (0)(0) & (1.5)(0) + (1)(0.5) + (0)(0.3) \\\\\n(0)(1.5) + (1)(0) + (0.5)(0) & (0)(1) + (1)(1) + (0.5)(0) & (0)(0) + (1)(0.5) + (0.5)(0.3) \\\\\n(0)(1.5) + (0)(0) + (0.3)(0) & (0)(1) + (0)(1) + (0.3)(0) & (0)(0) + (0)(0.5) + (0.3)(0.3)\n\\end{pmatrix}\n$$\n$$\nA^2 = \\begin{pmatrix}\n2.25 & 1.5 + 1 & 0.5 \\\\\n0 & 1 & 0.5 + 0.15 \\\\\n0 & 0 & 0.09\n\\end{pmatrix} = \\begin{pmatrix}\n2.25 & 2.5 & 0.5 \\\\\n0 & 1 & 0.65 \\\\\n0 & 0 & 0.09\n\\end{pmatrix}\n$$\n现在，我们可以计算 $HA^2$：\n$$\nHA^2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix}\n2.25 & 2.5 & 0.5 \\\\\n0 & 1 & 0.65 \\\\\n0 & 0 & 0.09\n\\end{pmatrix} = \\begin{pmatrix}\n(0)(2.25) + (1)(0) + (0)(0) & (0)(2.5) + (1)(1) + (0)(0) & (0)(0.5) + (1)(0.65) + (0)(0.09)\n\\end{pmatrix}\n$$\n$$\nHA^2 = \\begin{pmatrix} 0  1  0.65 \\end{pmatrix}\n$$\n现在我们组合可观测性矩阵 $\\mathcal{O}_3$：\n$$\n\\mathcal{O}_3 = \\begin{pmatrix}\n0  1  0 \\\\\n0  1  0.5 \\\\\n0  1  0.65\n\\end{pmatrix}\n$$\n为了计算 $\\mathcal{O}_3$ 的秩，我们可以使用高斯消元法求其行阶梯形。设 $R_1, R_2, R_3$ 表示 $\\mathcal{O}_3$ 的各行。\n矩阵为 $\\begin{pmatrix} 0  1  0 \\\\ 0  1  0.5 \\\\ 0  1  0.65 \\end{pmatrix}$。\n执行行变换 $R_2 \\leftarrow R_2 - R_1$：\n$$\n\\begin{pmatrix} 0  1  0 \\\\ 0  1-1  0.5-0 \\\\ 0  1  0.65 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0.5 \\\\ 0  1  0.65 \\end{pmatrix}\n$$\n执行行变换 $R_3 \\leftarrow R_3 - R_1$：\n$$\n\\begin{pmatrix} 0  1  0 \\\\ 0  0  0.5 \\\\ 0  1-1  0.65-0 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0.5 \\\\ 0  0  0.65 \\end{pmatrix}\n$$\n最后，执行行变换 $R_3 \\leftarrow R_3 - (\\frac{0.65}{0.5})R_2 = R_3 - 1.3 R_2$：\n$$\n\\begin{pmatrix} 0  1  0 \\\\ 0  0  0.5 \\\\ 0  0  0.65 - 1.3(0.5) \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0.5 \\\\ 0  0  0.65 - 0.65 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0.5 \\\\ 0  0  0 \\end{pmatrix}\n$$\n行阶梯形有两个非零行。因此，该矩阵的秩为 $2$。\n$$\n\\operatorname{rank}(\\mathcal{O}_3) = 2\n$$\n根据可观测性的基本定义，一个状态维数为 $n$ 的线性时不变系统是可观测的，当且仅当其可观测性矩阵 $\\mathcal{O}_n$ 具有满列秩，即 $\\operatorname{rank}(\\mathcal{O}_n) = n$。在本例中，状态维数为 $n=3$，但我们发现 $\\operatorname{rank}(\\mathcal{O}_3) = 2$。由于 $2 < 3$，该系统在 $3$ 步观测窗口内不是完全可观测的。\n\n不可观测子空间是 $\\mathcal{O}_3$ 的零空间。该子空间的维数由秩-零度定理给出：$\\dim(\\operatorname{null}(\\mathcal{O}_3)) = n - \\operatorname{rank}(\\mathcal{O}_3) = 3 - 2 = 1$。这意味着存在一个一维的初始状态 $x_0$ 子空间，它在所有时间内都产生零观测值，因此无法通过测量来确定。\n让我们通过求解 $\\mathcal{O}_3 x_0 = 0$ 来找到零空间，其中 $x_0 = (x_{0,1}, x_{0,2}, x_{0,3})^T$：\n$$\n\\begin{pmatrix} 0  1  0 \\\\ 0  1  0.5 \\\\ 0  1  0.65 \\end{pmatrix} \\begin{pmatrix} x_{0,1} \\\\ x_{0,2} \\\\ x_{0,3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到方程组：$x_{0,2} = 0$, $x_{0,2} + 0.5 x_{0,3} = 0$ 和 $x_{0,2} + 0.65 x_{0,3} = 0$。\n第一个方程给出 $x_{0,2} = 0$。将其代入第二个和第三个方程，得到 $0.5 x_{0,3} = 0$ 和 $0.65 x_{0,3} = 0$，这两个方程都意味着 $x_{0,3} = 0$。变量 $x_{0,1}$ 不受约束。因此，零空间是所有形式为 $(c, 0, 0)^T$ 的向量的集合，其中 $c \\in \\mathbb{R}$ 是任意标量。不可观测子空间是 $\\operatorname{span}\\{(1, 0, 0)^T\\}$。\n\n问题询问是否有任何*初始未被观测到*的状态分量是可辨识的。在时间 $k=0$ 时，观测值为 $y_0 = H x_0 = x_{0,2}$。这意味着分量 $x_{0,1}$ 和 $x_{0,3}$ 在初始时刻未被直接观测到。观测序列通过 $Y = \\mathcal{O}_3 x_0$ 与初始状态相关联，其中 $Y = (y_0, y_1, y_2)^T$。\n$$\n\\begin{pmatrix} y_0 \\\\ y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} x_{0,2} \\\\ x_{0,2} + 0.5 x_{0,3} \\\\ x_{0,2} + 0.65 x_{0,3} \\end{pmatrix}\n$$\n从这个方程组中，我们可以直接从 $y_0$ 确定 $x_{0,2}$。然后，利用 $y_1$，我们可以确定 $x_{0,3}$ 为 $x_{0,3} = (y_1 - x_{0,2})/0.5 = 2(y_1 - y_0)$。然而，观测值中没有任何信息可以用来确定 $x_{0,1}$。\n\n因此，初始未被观测到的分量之一 $x_{0,3}$，通过观测序列变得可辨识，而另一个分量 $x_{0,1}$ 仍然不可观测。由 $\\mathcal{O}_3$ 的秩确定的一维不可观测子空间的存在，证实了并非所有分量都是可辨识的。\n\n最终的数值答案就是这个秩本身。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "最后的这个练习深入到不稳定子空间方法的核心。它探讨了一个关键且实际的问题：如果我们对不稳定子空间的估计本身存在偏差，将会发生什么？通过推导子空间方向的微小误差如何影响最终的分析误差，这个实践为理解该高级技术的鲁棒性和潜在的失效模式提供了深刻的洞见 。",
            "id": "3374551",
            "problem": "考虑一个吸引子附近的二维线性化混沌动力系统，其切动力学具有一个不稳定方向和一个稳定方向。设真实的不稳定单位向量为 $e_{u} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，稳定的单位向量为 $e_{s} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。假设预报（背景）误差 $e^{f} \\in \\mathbb{R}^{2}$ 是一个零均值高斯随机向量，其协方差与真实的李雅普诺夫方向对齐，\n$$\n\\operatorname{Cov}(e^{f}) = S = \\begin{pmatrix} \\sigma_{u}^{2} & 0 \\\\ 0 & \\sigma_{s}^{2} \\end{pmatrix},\n$$\n满足 $\\sigma_{u}^{2} > \\sigma_{s}^{2} > 0$。假设我们同化一个完整观测 $y = x + v$，其中观测噪声 $v$ 是一个零均值高斯随机向量，与 $e^{f}$ 独立，其协方差为 $R = r I_{2}$，其中 $r > 0$ 且 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵。\n\n应用一种不稳定子空间分析更新作为线性估计器，\n$$\nx^{a} = x^{f} + K \\left(y - x^{f}\\right),\n$$\n其增益被限制在一个估计的一维不稳定子空间内。估计的不稳定单位向量是由真实不稳定向量旋转角度 $\\theta$（以弧度为单位）得到的，\n$$\n\\hat{e}_{u}(\\theta) = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix},\n$$\n相关的投影算子为 $P_{u}(\\theta) = \\hat{e}_{u}(\\theta)\\,\\hat{e}_{u}(\\theta)^{\\top}$。增益为 $K = \\gamma P_{u}(\\theta)$，其中 $\\gamma \\in \\mathbb{R}$ 是一个满足 $0 < \\gamma < 2$ 的固定标量。定义分析误差 $e^{a} = x^{a} - x^{\\text{true}}$。\n\n仅使用上述给出的基本定义，并假设 $\\mathbb{R}^{2}$ 上的欧几里得范数，推导误差放大因子作为旋转角 $\\theta$ 的函数的闭式解析表达式，\n$$\nA(\\theta) = \\frac{\\mathbb{E}\\!\\left[\\|e^{a}(\\theta)\\|^{2}\\right]}{\\mathbb{E}\\!\\left[\\|e^{a}(0)\\|^{2}\\right]},\n$$\n其中期望是关于 $e^{f}$ 和 $v$ 的联合分布计算的。将您的最终结果用 $\\sigma_{u}^{2}$、$\\sigma_{s}^{2}$、$r$、$\\gamma$ 和 $\\theta$ 表示。角度必须以弧度表示。您的最终答案必须是一个单一的闭式解析表达式。不需要单位。",
            "solution": "首先验证问题，以确保其是适定的、有科学依据的，并且包含得出唯一解所需的所有必要信息。\n\n### 步骤 1: 提取已知条件\n-   系统：二维线性化混沌动力系统。\n-   真实的不稳定单位向量：$e_{u} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$。\n-   真实的稳定单位向量：$e_{s} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。\n-   预报误差：$e^{f} \\in \\mathbb{R}^{2}$，一个零均值高斯随机向量。\n-   预报误差协方差：$\\operatorname{Cov}(e^{f}) = S = \\begin{pmatrix} \\sigma_{u}^{2} & 0 \\\\ 0 & \\sigma_{s}^{2} \\end{pmatrix}$，满足 $\\sigma_{u}^{2} > \\sigma_{s}^{2} > 0$。\n-   观测：$y = x^{\\text{true}} + v$。\n-   观测噪声：$v$，一个零均值高斯随机向量，与 $e^{f}$ 独立。\n-   观测噪声协方差：$R = r I_{2}$，其中 $r > 0$ 且 $I_{2}$ 是 $2 \\times 2$ 单位矩阵。\n-   分析更新公式：$x^{a} = x^{f} + K \\left(y - x^{f}\\right)$。\n-   估计的不稳定单位向量：$\\hat{e}_{u}(\\theta) = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$。\n-   到估计的不稳定子空间上的投影算子：$P_{u}(\\theta) = \\hat{e}_{u}(\\theta)\\,\\hat{e}_{u}(\\theta)^{\\top}$。\n-   增益矩阵：$K = \\gamma P_{u}(\\theta)$，其中 $\\gamma \\in \\mathbb{R}$ 是一个满足 $0 < \\gamma < 2$ 的固定标量。\n-   分析误差：$e^{a} = x^{a} - x^{\\text{true}}$。\n-   目标：推导误差放大因子 $A(\\theta) = \\frac{\\mathbb{E}\\!\\left[\\|e^{a}(\\theta)\\|^{2}\\right]}{\\mathbb{E}\\!\\left[\\|e^{a}(0)\\|^{2}\\right]}$。\n\n### 步骤 2: 使用提取的已知条件进行验证\n该问题具有科学依据，植根于数据同化和线性估计理论的既定原则。该场景描述了一个不稳定子空间数据同化方法的简化但概念上合理的模型。该问题是适定的，提供了推导所求量所需的所有必要定义、分布和约束。语言客观且数学上精确。所有参数都有明确定义。该问题是自洽的，不违反任何物理或数学原理。\n\n### 步骤 3: 结论与行动\n问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n分析误差 $e^{a}$ 定义为 $e^{a} = x^{a} - x^{\\text{true}}$。我们首先用预报误差 $e^{f} = x^{f} - x^{\\text{true}}$ 和观测噪声 $v$ 来表示 $e^{a}$。\n将分析更新公式代入 $e^{a}$ 的定义中：\n$$e^{a} = x^{f} + K(y - x^{f}) - x^{\\text{true}}$$\n使用观测的定义 $y = x^{\\text{true}} + v$：\n$$e^{a} = x^{f} + K(x^{\\text{true}} + v - x^{f}) - x^{\\text{true}}$$\n整理各项：\n$$e^{a} = (I_{2} - K)(x^{f} - x^{\\text{true}}) + K v$$\n其中 $I_2$ 是 $2 \\times 2$ 单位矩阵。这可以简化为：\n$$e^{a} = (I_{2} - K)e^{f} + K v$$\n我们感兴趣的量是分析误差的欧几里得范数的平方期望值，即 $\\mathbb{E}\\!\\left[\\|e^{a}\\|^{2}\\right]$。这等价于分析误差协方差矩阵 $P^{a} = \\mathbb{E}[e^{a}(e^{a})^{\\top}]$ 的迹。\n$$P^{a} = \\mathbb{E}\\![((I_{2} - K)e^{f} + K v)((I_{2} - K)e^{f} + K v)^{\\top}]$$\n展开表达式：\n$$P^{a} = \\mathbb{E}\\![ (I_{2} - K)e^{f}(e^{f})^{\\top}(I_{2} - K)^{\\top} + (I_{2} - K)e^{f}v^{\\top}K^{\\top} + K v (e^{f})^{\\top}(I_{2} - K)^{\\top} + K v v^{\\top}K^{\\top} ]$$\n因为 $e^{f}$ 和 $v$ 相互独立且均值为零，所以交叉项的期望为零。因此，我们有：\n$$P^{a} = (I_{2} - K)\\mathbb{E}[e^{f}(e^{f})^{\\top}](I_{2} - K)^{\\top} + K\\mathbb{E}[v v^{\\top}]K^{\\top}$$\n代入给定的协方差矩阵 $S = \\mathbb{E}[e^{f}(e^{f})^{\\top}]$ 和 $R = \\mathbb{E}[v v^{\\top}]$：\n$$P^{a} = (I_{2} - K)S(I_{2} - K)^{\\top} + KRK^{\\top}$$\n增益矩阵为 $K = \\gamma P_{u}(\\theta)$。投影算子 $P_{u}(\\theta)$ 是对称的（$P_{u}(\\theta)^{\\top} = P_{u}(\\theta)$），因此 $K$ 也是对称的（$K^{\\top} = K$）。代入 $K$ 和 $K^{\\top}$：\n$$P^{a} = (I_{2} - \\gamma P_{u}(\\theta))S(I_{2} - \\gamma P_{u}(\\theta)) + (\\gamma P_{u}(\\theta))R(\\gamma P_{u}(\\theta))$$\n$$P^{a} = S - \\gamma P_{u}(\\theta)S - \\gamma S P_{u}(\\theta) + \\gamma^{2} P_{u}(\\theta)SP_{u}(\\theta) + \\gamma^{2} P_{u}(\\theta)RP_{u}(\\theta)$$\n期望平方误差为 $J(\\theta) = \\mathbb{E}\\!\\left[\\|e^{a}(\\theta)\\|^{2}\\right] = \\operatorname{trace}(P^{a})$。利用迹算子的线性和循环性质（$\\operatorname{trace}(AB) = \\operatorname{trace}(BA)$）：\n$$J(\\theta) = \\operatorname{trace}(S) - 2\\gamma\\operatorname{trace}(P_{u}(\\theta)S) + \\gamma^{2}\\operatorname{trace}(P_{u}(\\theta)SP_{u}(\\theta)) + \\gamma^{2}\\operatorname{trace}(P_{u}(\\theta)RP_{u}(\\theta))$$\n我们使用投影算子 $P_{u}(\\theta) = \\hat{e}_{u}(\\theta)\\hat{e}_{u}(\\theta)^{\\top}$ 的性质。对于任意矩阵 $M$：\n$\\operatorname{trace}(P_{u}(\\theta)M) = \\operatorname{trace}(\\hat{e}_{u}(\\theta)\\hat{e}_{u}(\\theta)^{\\top}M) = \\operatorname{trace}(\\hat{e}_{u}(\\theta)^{\\top}M\\hat{e}_{u}(\\theta)) = \\hat{e}_{u}(\\theta)^{\\top}M\\hat{e}_{u}(\\theta)$。\n此外，由于 $P_{u}(\\theta)^{2}=P_{u}(\\theta)$，$\\operatorname{trace}(P_{u}(\\theta)MP_{u}(\\theta)) = \\operatorname{trace}(P_{u}(\\theta)M) = \\hat{e}_{u}(\\theta)^{\\top}M\\hat{e}_{u}(\\theta)$。\n应用这些性质：\n$$J(\\theta) = \\operatorname{trace}(S) - (2\\gamma - \\gamma^{2})\\hat{e}_{u}(\\theta)^{\\top}S\\hat{e}_{u}(\\theta) + \\gamma^{2}\\hat{e}_{u}(\\theta)^{\\top}R\\hat{e}_{u}(\\theta)$$\n现在，我们计算二次型：\n$\\hat{e}_{u}(\\theta)^{\\top}S\\hat{e}_{u}(\\theta) = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} \\sigma_{u}^{2} & 0 \\\\ 0 & \\sigma_{s}^{2} \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\sigma_{u}^{2}\\cos^{2}\\theta + \\sigma_{s}^{2}\\sin^{2}\\theta$。\n$\\hat{e}_{u}(\\theta)^{\\top}R\\hat{e}_{u}(\\theta) = \\hat{e}_{u}(\\theta)^{\\top}(rI_{2})\\hat{e}_{u}(\\theta) = r\\,\\hat{e}_{u}(\\theta)^{\\top}\\hat{e}_{u}(\\theta) = r\\|\\hat{e}_{u}(\\theta)\\|^{2} = r$。\n并且 $\\operatorname{trace}(S) = \\sigma_{u}^{2} + \\sigma_{s}^{2}$。\n将这些代入 $J(\\theta)$ 的表达式中：\n$$J(\\theta) = (\\sigma_{u}^{2} + \\sigma_{s}^{2}) - (2\\gamma - \\gamma^{2})(\\sigma_{u}^{2}\\cos^{2}\\theta + \\sigma_{s}^{2}\\sin^{2}\\theta) + \\gamma^{2}r$$\n这是放大因子的分子。分母是 $J(0)$，它对应于没有角度误差的情况，即 $\\theta = 0$。当 $\\theta=0$ 时，$\\cos(0)=1$ 且 $\\sin(0)=0$：\n$$J(0) = (\\sigma_{u}^{2} + \\sigma_{s}^{2}) - (2\\gamma - \\gamma^{2})\\sigma_{u}^{2} + \\gamma^{2}r$$\n我们可以进一步简化 $J(0)$：\n$$J(0) = \\sigma_{u}^{2} - 2\\gamma\\sigma_{u}^{2} + \\gamma^{2}\\sigma_{u}^{2} + \\sigma_{s}^{2} + \\gamma^{2}r = (1 - 2\\gamma + \\gamma^{2})\\sigma_{u}^{2} + \\sigma_{s}^{2} + \\gamma^{2}r = (1-\\gamma)^{2}\\sigma_{u}^{2} + \\sigma_{s}^{2} + \\gamma^{2}r$$\n为了简化比率 $A(\\theta) = J(\\theta)/J(0)$，我们用 $J(0)$ 来重写 $J(\\theta)$。\n$$J(\\theta) = (\\sigma_{u}^{2} + \\sigma_{s}^{2}) - (2\\gamma - \\gamma^{2})(\\sigma_{u}^{2}(1-\\sin^{2}\\theta) + \\sigma_{s}^{2}\\sin^{2}\\theta) + \\gamma^{2}r$$\n$$J(\\theta) = (\\sigma_{u}^{2} + \\sigma_{s}^{2}) - (2\\gamma - \\gamma^{2})\\sigma_{u}^{2} + (2\\gamma - \\gamma^{2})\\sigma_{u}^{2}\\sin^{2}\\theta - (2\\gamma - \\gamma^{2})\\sigma_{s}^{2}\\sin^{2}\\theta + \\gamma^{2}r$$\n对各项进行分组以分离出 $J(0)$：\n$$J(\\theta) = \\left[(\\sigma_{u}^{2} + \\sigma_{s}^{2}) - (2\\gamma - \\gamma^{2})\\sigma_{u}^{2} + \\gamma^{2}r\\right] + (2\\gamma - \\gamma^{2})(\\sigma_{u}^{2} - \\sigma_{s}^{2})\\sin^{2}\\theta$$\n$$J(\\theta) = J(0) + (2\\gamma - \\gamma^{2})(\\sigma_{u}^{2} - \\sigma_{s}^{2})\\sin^{2}\\theta$$\n误差放大因子 $A(\\theta)$ 是比率 $J(\\theta)/J(0)$：\n$$A(\\theta) = \\frac{J(0) + (2\\gamma - \\gamma^{2})(\\sigma_{u}^{2} - \\sigma_{s}^{2})\\sin^{2}\\theta}{J(0)} = 1 + \\frac{(2\\gamma - \\gamma^{2})(\\sigma_{u}^{2} - \\sigma_{s}^{2})\\sin^{2}\\theta}{J(0)}$$\n代入 $J(0)$ 的简化表达式：\n$$A(\\theta) = 1 + \\frac{(2\\gamma - \\gamma^{2})(\\sigma_{u}^{2} - \\sigma_{s}^{2})\\sin^{2}\\theta}{(1-\\gamma)^{2}\\sigma_{u}^{2} + \\sigma_{s}^{2} + \\gamma^{2}r}$$\n这就是误差放大因子的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{1 + \\frac{(2\\gamma - \\gamma^{2})(\\sigma_{u}^{2} - \\sigma_{s}^{2})\\sin^{2}\\theta}{(1-\\gamma)^{2}\\sigma_{u}^{2} + \\sigma_{s}^{2} + \\gamma^{2}r}}\n$$"
        }
    ]
}