{
    "hands_on_practices": [
        {
            "introduction": "维度灾难是粒子方法面临的根本挑战，它直接导致重要性权重的退化。本练习旨在通过一个经典的高斯设定，严格地推导并揭示重要性权重的方差如何随状态空间维度的增加呈指数级增长 。掌握这一推导过程，对于深刻理解为何权重退化在高维问题中几乎不可避免至关重要。",
            "id": "3417360",
            "problem": "设 $d \\in \\mathbb{N}$ 为维度，并考虑一个与逆问题和数据同化相关的线性高斯设定中的重要性采样。设建议密度为 $p(x)$，其中 $x \\sim \\mathcal{N}(0, I_d)$，$I_d$ 为 $d \\times d$ 的单位矩阵。目标密度与 $\\exp\\!\\big(-\\frac{1}{2}\\|x - \\mu\\|^2\\big)$ 成正比，其中平移向量 $\\mu \\in \\mathbb{R}^d$ 满足 $\\|\\mu\\| = c\\sqrt{d}$，对于一个不依赖于 $d$ 的固定常数 $c > 0$。你可以假设目标是高斯密度 $\\pi(x) = \\mathcal{N}(\\mu, I_d)$，因此重要性权重为 $w(x) = \\pi(x)/p(x)$。\n\n从高斯密度、两个具有相同协方差的高斯测度之间的拉东-尼科迪姆导数以及变异系数的定义出发，推导出重要性权重的变异系数，\n$$\n\\mathrm{CV}(w) \\equiv \\frac{\\sqrt{\\mathrm{Var}_p(w)}}{\\mathbb{E}_p[w]},\n$$\n作为 $c$ 和 $d$ 的显式闭式表达式。你的推导应仅使用高斯分布的基本性质，例如高斯线性形式的矩生成函数。请以 $c$ 和 $d$ 的单一闭式表达式形式给出最终答案。不需要进行数值计算或四舍五入。",
            "solution": "问题陈述已经过验证，并被确定为统计分析中一个有效、自洽且具有科学依据的问题，具体涉及高维重要性采样的性能。我们开始进行推导。\n\n设 $x \\in \\mathbb{R}^d$ 为一个随机向量。问题定义了一个建议分布 $p(x)$ 和一个目标分布 $\\pi(x)$。\n建议分布是 $d$ 维的标准正态分布，$x \\sim \\mathcal{N}(0, I_d)$，其中 $I_d$ 是 $d \\times d$ 的单位矩阵。其概率密度函数 (PDF) 为：\n$$\np(x) = \\frac{1}{(2\\pi)^{d/2} \\det(I_d)^{1/2}} \\exp\\left(-\\frac{1}{2} x^T I_d^{-1} x\\right) = \\frac{1}{(2\\pi)^{d/2}} \\exp\\left(-\\frac{1}{2} \\|x\\|^2\\right)\n$$\n目标分布是均值为 $\\mu \\in \\mathbb{R}^d$、协方差为 $I_d$ 的多元正态分布，记作 $\\pi(x) = \\mathcal{N}(\\mu, I_d)$。其 PDF 为：\n$$\n\\pi(x) = \\frac{1}{(2\\pi)^{d/2} \\det(I_d)^{1/2}} \\exp\\left(-\\frac{1}{2} (x-\\mu)^T I_d^{-1} (x-\\mu)\\right) = \\frac{1}{(2\\pi)^{d/2}} \\exp\\left(-\\frac{1}{2} \\|x-\\mu\\|^2\\right)\n$$\n重要性权重 $w(x)$ 定义为目标密度与建议密度的比值，即拉东-尼科迪姆导数 $\\frac{d\\Pi}{dP}(x)$，其中 $\\Pi$ 和 $P$ 分别是对应于密度 $\\pi$ 和 $p$ 的测度。\n$$\nw(x) = \\frac{\\pi(x)}{p(x)} = \\frac{\\frac{1}{(2\\pi)^{d/2}} \\exp\\left(-\\frac{1}{2} \\|x-\\mu\\|^2\\right)}{\\frac{1}{(2\\pi)^{d/2}} \\exp\\left(-\\frac{1}{2} \\|x\\|^2\\right)} = \\exp\\left(-\\frac{1}{2} \\|x-\\mu\\|^2 + \\frac{1}{2} \\|x\\|^2\\right)\n$$\n我们展开指数中的平方范数：$\\|x-\\mu\\|^2 = (x-\\mu)^T(x-\\mu) = x^T x - 2x^T\\mu + \\mu^T\\mu = \\|x\\|^2 - 2x^T\\mu + \\|\\mu\\|^2$。\n将此代入 $w(x)$ 的表达式中，得到：\n$$\nw(x) = \\exp\\left(-\\frac{1}{2} (\\|x\\|^2 - 2x^T\\mu + \\|\\mu\\|^2) + \\frac{1}{2} \\|x\\|^2\\right) = \\exp\\left(x^T\\mu - \\frac{1}{2}\\|\\mu\\|^2\\right)\n$$\n变异系数定义为 $\\mathrm{CV}(w) = \\frac{\\sqrt{\\mathrm{Var}_p(w)}}{\\mathbb{E}_p[w]}$。我们必须计算 $w(x)$ 相对于建议分布 $p(x)$ 的一阶矩和二阶矩。\n\n权重的一阶矩（或期望）为：\n$$\n\\mathbb{E}_p[w(x)] = \\int_{\\mathbb{R}^d} w(x) p(x) dx = \\int_{\\mathbb{R}^d} \\frac{\\pi(x)}{p(x)} p(x) dx = \\int_{\\mathbb{R}^d} \\pi(x) dx = 1\n$$\n这个结果是符合预期的，因为任何有效的概率密度函数在其支撑集上的积分都等于 $1$。\n\n接下来，我们计算二阶矩 $\\mathbb{E}_p[w(x)^2]$。\n$$\nw(x)^2 = \\left(\\exp\\left(x^T\\mu - \\frac{1}{2}\\|\\mu\\|^2\\right)\\right)^2 = \\exp\\left(2x^T\\mu - \\|\\mu\\|^2\\right)\n$$\n这个量的期望为：\n$$\n\\mathbb{E}_p[w(x)^2] = \\mathbb{E}_p\\left[\\exp\\left(2x^T\\mu - \\|\\mu\\|^2\\right)\\right] = \\exp\\left(-\\|\\mu\\|^2\\right) \\mathbb{E}_p\\left[\\exp\\left(2\\mu^T x\\right)\\right]\n$$\n项 $\\mathbb{E}_p[\\exp(2\\mu^T x)]$ 是随机变量 $x$ 的矩生成函数 (MGF)，记为 $M_x(t) = \\mathbb{E}_p[\\exp(t^T x)]$，在 $t=2\\mu$ 处求值。\n由于 $x \\sim p = \\mathcal{N}(0, I_d)$，其 MGF 由下式给出：\n$$\nM_x(t) = \\exp\\left(t^T 0 + \\frac{1}{2}t^T I_d t\\right) = \\exp\\left(\\frac{1}{2}\\|t\\|^2\\right)\n$$\n在 $t=2\\mu$ 处对 MGF 求值：\n$$\n\\mathbb{E}_p\\left[\\exp(2\\mu^T x)\\right] = M_x(2\\mu) = \\exp\\left(\\frac{1}{2}\\|2\\mu\\|^2\\right) = \\exp\\left(\\frac{1}{2} \\cdot 4 \\|\\mu\\|^2\\right) = \\exp(2\\|\\mu\\|^2)\n$$\n将此结果代回二阶矩的表达式中：\n$$\n\\mathbb{E}_p[w(x)^2] = \\exp(-\\|\\mu\\|^2) \\cdot \\exp(2\\|\\mu\\|^2) = \\exp(\\|\\mu\\|^2)\n$$\n权重的方差计算如下：\n$$\n\\mathrm{Var}_p(w) = \\mathbb{E}_p[w^2] - (\\mathbb{E}_p[w])^2 = \\exp(\\|\\mu\\|^2) - 1^2 = \\exp(\\|\\mu\\|^2) - 1\n$$\n现在我们来组合变异系数：\n$$\n\\mathrm{CV}(w) = \\frac{\\sqrt{\\mathrm{Var}_p(w)}}{\\mathbb{E}_p[w]} = \\frac{\\sqrt{\\exp(\\|\\mu\\|^2) - 1}}{1} = \\sqrt{\\exp(\\|\\mu\\|^2) - 1}\n$$\n最后，我们使用关于平移向量范数的给定条件 $\\|\\mu\\| = c\\sqrt{d}$。这意味着 $\\|\\mu\\|^2 = (c\\sqrt{d})^2 = c^2 d$。将此代入我们的变异系数表达式中，得出最终结果。\n$$\n\\mathrm{CV}(w) = \\sqrt{\\exp(c^2 d) - 1}\n$$\n这个表达式就是以常数 $c$ 和维度 $d$ 表示的闭式解。",
            "answer": "$$\n\\boxed{\\sqrt{\\exp(c^2 d) - 1}}\n$$"
        },
        {
            "introduction": "既然我们已经认识到权重趋于坍缩，就需要一种方法来量化这一现象，以便决定何时进行重采样。本练习引入了有效样本量（Effective Sample Size, $N_{\\mathrm{eff}}$），这是诊断权重退化的标准指标 。通过在一个简化的典型场景中推导其解析表达式，您将具体地理解 $N_{\\mathrm{eff}}$ 是如何定量地反映粒子集健康状况的。",
            "id": "3417298",
            "problem": "考虑一个用于求解逆问题的数据同化场景中的序贯蒙特卡洛（SMC）粒子滤波器，该滤波器包含 $N$ 个粒子。在同化单个观测值后，假设（非负的）重要性权重为 $\\{w_{i}\\}_{i=1}^{N}$，并且权重向量表现出单一主导权重，即其中一个权重 $w_{1}$ 大于其余的 $N-1$ 个权重。假设这 $N-1$ 个非主导权重相等。定义归一化权重为 $\\tilde{w}_{i} = w_{i} / \\sum_{j=1}^{N} w_{j}$，定义主导水平为 $\\rho = w_{1} / \\sum_{j=1}^{N} w_{j}$，并考虑将有效样本量（ESS），即 $N_{\\mathrm{eff}}$，作为序贯蒙特卡洛中标准的退化诊断指标。\n\n从粒子滤波中基于归一化权重的退化问题的经典定义出发，在假设 $N-1$ 个非主导归一化权重相等的情况下，推导 $N_{\\mathrm{eff}}$ 作为粒子数 $N$ 和主导水平 $\\rho$ 的函数的闭式解析表达式。然后，通过刻画当 $\\rho$ 在 $[0,1]$ 区间变化时 $N_{\\mathrm{eff}}$ 的单调性和极值，来分析 $N_{\\mathrm{eff}}$ 对 $\\rho$ 的敏感性，并解释其对权重退化和维度灾难的影响。\n\n将 $N_{\\mathrm{eff}}$ 的最终答案表示为关于 $N$ 和 $\\rho$ 的单个闭式解析表达式。无需进行数值计算或四舍五入。",
            "solution": "首先验证问题陈述，以确保其科学上合理、良定且客观。\n\n### 第一步：提取已知条件\n- 考虑一个序贯蒙特卡洛（SMC）粒子滤波器。\n- 粒子数量为 $N$。\n- 非负重要性权重集合为 $\\{w_{i}\\}_{i=1}^{N}$。\n- 权重向量有一个单一主导权重 $w_{1}$，其值大于其他 $N-1$ 个权重。\n- $N-1$ 个非主导权重彼此相等。\n- 归一化权重定义为 $\\tilde{w}_{i} = w_{i} / \\sum_{j=1}^{N} w_{j}$。\n- 主导水平定义为 $\\rho = w_{1} / \\sum_{j=1}^{N} w_{j}$。\n- 有效样本量 $N_{\\mathrm{eff}}$ 用作退化诊断指标。\n- 任务是使用退化的经典定义，推导 $N_{\\mathrm{eff}}$ 作为 $N$ 和 $\\rho$ 的函数的闭式表达式。\n- 任务包括通过刻画当 $\\rho \\in [0,1]$ 时 $N_{\\mathrm{eff}}$ 的单调性和极值来分析其对 $\\rho$ 的敏感性。\n- 任务要求在权重退化和维度灾难的背景下解释结果。\n\n### 第二步：使用已知条件进行验证\n1.  **科学或事实合理性**：该问题在科学上是合理的。它基于数据同化和统计信号处理领域的标准基本概念，特别是序贯蒙特卡洛方法（粒子滤波器）。归一化权重、有效样本量、权重退化和维度灾难的定义在该领域都是经典定义。$N_{\\mathrm{eff}}$ 的经典定义是 $N_{\\mathrm{eff}} = (\\sum_{i=1}^{N} \\tilde{w}_{i}^{2})^{-1}$。\n2.  **非形式化或不相关**：该问题高度相关且可直接形式化。它在指定主题内提出了一个精确的数学问题。\n3.  **不完整或矛盾的设置**：设置是完整的且内部一致。所提供的定义和假设足以推导出所要求的表达式。$w_1$ 是最大权重的假设意味着对于 $j \\neq 1$，有 $\\tilde{w}_1 > \\tilde{w}_j$。这意味着 $\\rho > (1-\\rho)/(N-1)$，简化后为 $\\rho > 1/N$。要求在 $\\rho \\in [0,1]$ 上分析该函数是一个标准的数学练习，旨在理解函数的行为，即使子区间 $\\rho \\in [0, 1/N]$ 与“主导”假设相矛盾。这并不会使问题无效，但这是在分析过程中需要注意的一点。核心推导不受影响。\n4.  **不切实际或不可行**：所描述的场景非常现实。在粒子滤波器的实际应用中，尤其是在高维系统中，权重坍缩到单个或少数几个粒子上是一个常见且关键的问题。\n5.  **不适定或结构不良**：问题是良定的。所给假设导向一个唯一的解析解。术语定义明确。\n6.  **伪深刻、琐碎或同义反复**：问题并非琐碎。它需要基于该方法的第一性原理进行形式推导和分析推理。\n7.  **超出科学可验证性**：该问题完全是数学性的，其解可通过逻辑推演和计算来验证。\n\n### 第三步：结论与行动\n该问题被判定为**有效**。我们可以继续进行求解。\n\n### $N_{\\mathrm{eff}}$ 表达式的推导\n\n基于归一化重要性权重 $\\{\\tilde{w}_{i}\\}_{i=1}^{N}$ 的有效样本量 $N_{\\mathrm{eff}}$ 的经典定义由下式给出：\n$$N_{\\mathrm{eff}} = \\frac{1}{\\sum_{i=1}^{N} \\tilde{w}_{i}^{2}}$$\n归一化权重之和必须等于 $1$：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i} = 1$$\n根据问题陈述，主导水平 $\\rho$ 是第一个粒子的归一化权重：\n$$\\tilde{w}_{1} = \\rho$$\n问题还指出，其余 $N-1$ 个非主导权重是相等的。让我们用 $\\tilde{w}_{k}$ 表示这些权重的值，其中 $k \\in \\{2, 3, \\ldots, N\\}$。我们可以用 $\\rho$ 和 $N$ 来表示 $\\tilde{w}_{k}$。\n使用归一化条件：\n$$\\tilde{w}_{1} + \\sum_{k=2}^{N} \\tilde{w}_{k} = 1$$\n代入 $\\tilde{w}_{1} = \\rho$ 并注意到其他 $N-1$ 个权重相等：\n$$\\rho + (N-1)\\tilde{w}_{k} = 1$$\n求解 $\\tilde{w}_{k}$（假设 $N > 1$，这在问题的措辞中是隐含的）：\n$$\\tilde{w}_{k} = \\frac{1-\\rho}{N-1}$$\n现在，我们可以计算归一化权重的平方和 $\\sum_{i=1}^{N} \\tilde{w}_{i}^{2}$：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\tilde{w}_{1}^{2} + \\sum_{k=2}^{N} \\tilde{w}_{k}^{2}$$\n代入 $\\tilde{w}_{1}$ 和 $\\tilde{w}_{k}$ 的表达式：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\rho^{2} + (N-1) \\left( \\frac{1-\\rho}{N-1} \\right)^{2}$$\n简化表达式：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\rho^{2} + (N-1) \\frac{(1-\\rho)^{2}}{(N-1)^{2}} = \\rho^{2} + \\frac{(1-\\rho)^{2}}{N-1}$$\n为了合并这些项，我们找到一个公分母：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\frac{(N-1)\\rho^{2} + (1-\\rho)^{2}}{N-1} = \\frac{(N-1)\\rho^{2} + (1 - 2\\rho + \\rho^{2})}{N-1}$$\n$$= \\frac{N\\rho^{2} - \\rho^{2} + 1 - 2\\rho + \\rho^{2}}{N-1} = \\frac{N\\rho^{2} - 2\\rho + 1}{N-1}$$\n最后，我们将此结果代回 $N_{\\mathrm{eff}}$ 的定义中：\n$$N_{\\mathrm{eff}} = \\frac{1}{\\frac{N\\rho^{2} - 2\\rho + 1}{N-1}} = \\frac{N-1}{N\\rho^{2} - 2\\rho + 1}$$\n这就是 $N_{\\mathrm{eff}}$ 作为 $N$ 和 $\\rho$ 的函数的闭式解析表达式。\n\n### 敏感性分析与解释\n\n为了分析 $N_{\\mathrm{eff}}$ 对 $\\rho$ 的敏感性，我们计算一阶导数 $\\frac{d N_{\\mathrm{eff}}}{d \\rho}$。设分母为 $f(\\rho) = N\\rho^{2} - 2\\rho + 1$。\n$$\\frac{d N_{\\mathrm{eff}}}{d \\rho} = \\frac{d}{d\\rho} \\left( (N-1) (N\\rho^{2} - 2\\rho + 1)^{-1} \\right)$$\n使用链式法则：\n$$\\frac{d N_{\\mathrm{eff}}}{d \\rho} = (N-1) (-1) (N\\rho^{2} - 2\\rho + 1)^{-2} (2N\\rho - 2)$$\n$$\\frac{d N_{\\mathrm{eff}}}{d \\rho} = -2(N-1) \\frac{N\\rho - 1}{(N\\rho^{2} - 2\\rho + 1)^{2}}$$\n分母 $(N\\rho^{2} - 2\\rho + 1)^{2}$ 总是非负的。当 $N>1$ 时，其根是复数，因此它严格为正。所以导数的符号由分子中非常数项 $-(N\\rho - 1)$ 的符号决定。\n1.  如果 $N\\rho - 1 > 0 \\implies \\rho > 1/N$，那么 $\\frac{d N_{\\mathrm{eff}}}{d \\rho}  0$。$N_{\\mathrm{eff}}$ 是 $\\rho$ 的单调递减函数。\n2.  如果 $N\\rho - 1  0 \\implies \\rho  1/N$，那么 $\\frac{d N_{\\mathrm{eff}}}{d \\rho} > 0$。$N_{\\mathrm{eff}}$ 是 $\\rho$ 的单调递增函数。\n3.  如果 $N\\rho - 1 = 0 \\implies \\rho = 1/N$，那么 $\\frac{d N_{\\mathrm{eff}}}{d \\rho} = 0$。这表示一个临界点。\n\n分析表明，在 $\\rho = 1/N$ 处存在一个极值。由于导数在该点从正变为负，因此它是一个局部最大值。让我们在区间 $[0,1]$ 的边界和这个临界点上计算 $N_{\\mathrm{eff}}$ 的值。\n\n-   **最大值**：当 $\\rho = 1/N$ 时，\n    $$N_{\\mathrm{eff}}\\left(\\rho = \\frac{1}{N}\\right) = \\frac{N-1}{N\\left(\\frac{1}{N}\\right)^{2} - 2\\left(\\frac{1}{N}\\right) + 1} = \\frac{N-1}{\\frac{1}{N} - \\frac{2}{N} + 1} = \\frac{N-1}{\\frac{N-1}{N}} = N$$\n    这种情况对应于所有权重都相等，即对所有 $i$ 都有 $\\tilde{w}_{i} = 1/N$，表示没有发生退化。有效样本量等于粒子的实际数量。\n\n-   **最小值**：当 $\\rho = 1$ 时，\n    $$N_{\\mathrm{eff}}(\\rho = 1) = \\frac{N-1}{N(1)^{2} - 2(1) + 1} = \\frac{N-1}{N-1} = 1$$\n    这种情况对应于完全退化，即一个粒子拥有全部权重（$\\tilde{w}_{1} = 1$），而所有其他粒子的权重为零。有效样本量坍缩为 1。\n\n-   当 $\\rho = 0$ 时：\n    $$N_{\\mathrm{eff}}(\\rho = 0) = \\frac{N-1}{N(0)^{2} - 2(0) + 1} = N-1$$\n    这对应于主导粒子的权重为零，而权重在其余 $N-1$ 个粒子中均匀分布。\n\n考虑到 $\\tilde{w}_1$ 是最大权重，$\\rho$ 的物理上有意义的定义域是 $[\\frac{1}{N}, 1]$。在此定义域上，$N_{\\mathrm{eff}}$ 是 $\\rho$ 的严格单调递减函数。\n\n**解释**：\n-   **权重退化**：推导出的表达式及其分析在数学上形式化了权重退化的概念。当权重分布变得更加倾斜时（即，当 $\\rho$ 从其最均匀的值 $1/N$ 增加到 $1$ 时），对后验分布的近似做出贡献的有效粒子数量从 $N$ 急剧下降到 $1$。一个低的 $N_{\\mathrm{eff}}$ 是一个信号，表明粒子表示很差，需要进行重采样步骤，通过消除低权重粒子并复制高权重粒子来减轻退化。\n-   **维度灾难**：在高维状态空间中，众所周知，似然函数 $p(\\text{observation}|\\text{state})$ 往往高度集中在空间的一个小体积内。在更新粒子权重时，粒子落入这个高似然区域变得极其罕见。因此，更新后，大多数粒子的权重接近于零，而恰好位于正确位置的一个或极少数粒子几乎占据了全部权重。这种情况直接导致 $\\rho$ 值接近 1。我们的分析表明，当 $\\rho \\to 1$ 时，$N_{\\mathrm{eff}} \\to 1$，而这与粒子总数 $N$ 无关。这说明了粒子滤波器维度灾难的一个关键方面：简单地增加 $N$ 并不是一个有效的解决方案，因为要充分采样高似然区域（从而避免权重坍缩）所需的粒子数量通常随状态空间的维度呈指数增长。",
            "answer": "$$\n\\boxed{\\frac{N-1}{N\\rho^2 - 2\\rho + 1}}\n$$"
        },
        {
            "introduction": "当我们使用有效样本量 $N_{\\mathrm{eff}}$ 检测到严重的权重退化时，标准的补救措施是重采样。本练习将带您从理论走向实践，亲手执行系统重采样（systematic resampling）算法，这是一种应用最广泛的高效方案 。通过为一个给定的权重集手动计算重采样指数，您将掌握该算法的运作机制，并理解其为何通常比简单方法更能保持粒子多样性。",
            "id": "3417312",
            "problem": "考虑一个应用于数据同化中贝叶斯逆问题的序列蒙特卡洛（SMC）粒子方法，该方法有$N$个粒子和归一化的重要性权重$\\{w_i\\}_{i=1}^N$，其和为$1$。粒子按标量状态坐标的升序索引，因此相邻的索引对应于相邻的状态。SMC算法采用系统重采样方案，定义如下：从$[0, 1/N)$上的均匀分布中抽取一个$U$，并形成阈值序列$t_k = U + (k-1)/N$，其中$k = 1, \\dots, N$。令$c_j = \\sum_{i=1}^j w_i$表示权重的累积和。位置$k$处的重采样祖先索引定义为$a_k = \\min\\{j \\in \\{1,\\dots,N\\} : c_j \\ge t_k\\}$。\n\n给定$N = 10$，归一化的权重为\n$$\n(w_1, \\dots, w_{10}) = (0.24, 0.01, 0.01, 0.18, 0.18, 0.20, 0.05, 0.03, 0.05, 0.05),\n$$\n以及一个固定的$U = 0.07$。请根据上述系统重采样的定义，计算完整的选择索引向量$(a_1, \\dots, a_{10})$。\n\n为了量化索引空间中相邻选择的一致性程度（反映了系统重采样众所周知的相关结构），定义相邻一致性指数\n$$\n\\kappa = \\frac{1}{N-1} \\sum_{k=1}^{N-1} \\mathbf{1}\\left(|a_{k+1} - a_k| \\le 1\\right),\n$$\n其中$\\mathbf{1}(\\cdot)$是指示函数。请以$\\kappa$的值作为最终答案。最终答案请表示为最简分数。在您的推导中，请将相邻一致性的概念与权重退化情况下的粒子多样性联系起来，并讨论其在高维逆问题中对维度灾难的影响。最终答案必须是一个无单位的单一数字，且必须表示为最简分数。",
            "solution": "首先根据所需准则对问题进行验证。问题陈述是自洽的，在科学上基于序列蒙特卡洛方法的理论，并且在算法上是适定的。所有必要的数据都已提供，包括粒子数$N=10$、归一化权重$\\{w_i\\}$以及随机抽取的特定值$U=0.07$。所提供权重的总和确实为$0.24 + 0.01 + 0.01 + 0.18 + 0.18 + 0.20 + 0.05 + 0.03 + 0.05 + 0.05 = 1.00$，证实了它们的归一化。值$U=0.07$与所需分布$\\mathcal{U}[0, 1/N) = \\mathcal{U}[0, 0.1)$一致。系统重采样和相邻一致性指数$\\kappa$的定义是精确的，并允许唯一的解。因此，该问题被认为是有效的，有必要给出完整解答。\n\n解答过程分三步：首先，我们计算祖先索引向量$(a_1, \\dots, a_{10})$；其次，我们用这个向量计算相邻一致性指数$\\kappa$；最后，我们讨论这个结果的更广泛含义。\n\n第一步：计算祖先索引向量$(a_1, \\dots, a_{10})$。\n\n根据系统重采样的定义，我们必须首先计算权重的累积和$c_j = \\sum_{i=1}^j w_i$，以及阈值序列$t_k = U + (k-1)/N$。\n\n给定的权重是：\n$$ (w_1, \\dots, w_{10}) = (0.24, 0.01, 0.01, 0.18, 0.18, 0.20, 0.05, 0.03, 0.05, 0.05) $$\n累积和$c_j$是：\n\\begin{align*}\nc_1 = 0.24 \\\\\nc_2 = 0.24 + 0.01 = 0.25 \\\\\nc_3 = 0.25 + 0.01 = 0.26 \\\\\nc_4 = 0.26 + 0.18 = 0.44 \\\\\nc_5 = 0.44 + 0.18 = 0.62 \\\\\nc_6 = 0.62 + 0.20 = 0.82 \\\\\nc_7 = 0.82 + 0.05 = 0.87 \\\\\nc_8 = 0.87 + 0.03 = 0.90 \\\\\nc_9 = 0.90 + 0.05 = 0.95 \\\\\nc_{10} = 0.95 + 0.05 = 1.00\n\\end{align*}\n\n粒子数为$N=10$，随机抽取值为$U=0.07$。阈值序列$t_k = 0.07 + (k-1)/10$ for $k=1, \\dots, 10$是：\n\\begin{align*}\nt_1 = 0.07 + 0.0 = 0.07 \\\\\nt_2 = 0.07 + 0.1 = 0.17 \\\\\nt_3 = 0.07 + 0.2 = 0.27 \\\\\nt_4 = 0.07 + 0.3 = 0.37 \\\\\nt_5 = 0.07 + 0.4 = 0.47 \\\\\nt_6 = 0.07 + 0.5 = 0.57 \\\\\nt_7 = 0.07 + 0.6 = 0.67 \\\\\nt_8 = 0.07 + 0.7 = 0.77 \\\\\nt_9 = 0.07 + 0.8 = 0.87 \\\\\nt_{10} = 0.07 + 0.9 = 0.97\n\\end{align*}\n\n祖先索引$a_k$是满足$c_j \\ge t_k$的最小索引$j$。我们通过比较$t_k$和累积权重序列$c_j$来找到每个$a_k$：\n\\begin{itemize}\n    \\item 对于$t_1 = 0.07$：第一个累积权重$c_1=0.24$大于$0.07$。因此，$a_1=1$。\n    \\item 对于$t_2 = 0.17$：第一个累积权重$c_1=0.24$大于$0.17$。因此，$a_2=1$。\n    \\item 对于$t_3 = 0.27$：$c_3=0.26  0.27$，但$c_4=0.44 \\ge 0.27$。因此，$a_3=4$。\n    \\item 对于$t_4 = 0.37$：$c_3=0.26  0.37$，但$c_4=0.44 \\ge 0.37$。因此，$a_4=4$。\n    \\item 对于$t_5 = 0.47$：$c_4=0.44  0.47$，但$c_5=0.62 \\ge 0.47$。因此，$a_5=5$。\n    \\item 对于$t_6 = 0.57$：$c_4=0.44  0.57$，但$c_5=0.62 \\ge 0.57$。因此，$a_6=5$。\n    \\item 对于$t_7 = 0.67$：$c_5=0.62  0.67$，但$c_6=0.82 \\ge 0.67$。因此，$a_7=6$。\n    \\item 对于$t_8 = 0.77$：$c_5=0.62  0.77$，但$c_6=0.82 \\ge 0.77$。因此，$a_8=6$。\n    \\item 对于$t_9 = 0.87$：$c_6=0.82  0.87$，但$c_7=0.87 \\ge 0.87$。因此，$a_9=7$。\n    \\item 对于$t_{10} = 0.97$：$c_9=0.95  0.97$，但$c_{10}=1.00 \\ge 0.97$。因此，$a_{10}=10$。\n\\end{itemize}\n完整的选择索引向量是$(a_1, \\dots, a_{10}) = (1, 1, 4, 4, 5, 5, 6, 6, 7, 10)$。\n\n第二步：计算相邻一致性指数$\\kappa$。\n\n该指数定义为$\\kappa = \\frac{1}{N-1} \\sum_{k=1}^{N-1} \\mathbf{1}\\left(|a_{k+1} - a_k| \\le 1\\right)$。当$N=10$时，我们有$N-1=9$。我们对向量$a$中的每个相邻对评估指示函数$\\mathbf{1}(\\cdot)$：\n\\begin{itemize}\n    \\item $k=1$: $|a_2 - a_1| = |1 - 1| = 0 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=2$: $|a_3 - a_2| = |4 - 1| = 3 > 1 \\implies \\mathbf{1}(\\cdot) = 0$。\n    \\item $k=3$: $|a_4 - a_3| = |4 - 4| = 0 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=4$: $|a_5 - a_4| = |5 - 4| = 1 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=5$: $|a_6 - a_5| = |5 - 5| = 0 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=6$: $|a_7 - a_6| = |6 - 5| = 1 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=7$: $|a_8 - a_7| = |6 - 6| = 0 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=8$: $|a_9 - a_8| = |7 - 6| = 1 \\le 1 \\implies \\mathbf{1}(\\cdot) = 1$。\n    \\item $k=9$: $|a_{10} - a_9| = |10 - 7| = 3 > 1 \\implies \\mathbf{1}(\\cdot) = 0$。\n\\end{itemize}\n指示函数值的总和是$1 + 0 + 1 + 1 + 1 + 1 + 1 + 1 + 0 = 7$。\n因此，相邻一致性指数是：\n$$ \\kappa = \\frac{7}{9} $$\n\n第三步：讨论。\n\n计算出的值$\\kappa = 7/9$很高，表明重采样序列中的大多数相邻索引对应的祖先要么是相同的，要么是原始有序粒子集中的直接邻居。这种高一致性是系统重采样的一个标志。与多项式重采样中每个新粒子都是独立抽取不同，系统重采样通过一次随机抽取$U$就固定了整个选择模式。阈值$t_k$是等间距的，因此它们倾向于选择连续的祖先块，从而保留了局部结构。\n\n这直接关系到**权重退化**问题。在SMC中，一个常见的问题是重要性权重集中在少数几个粒子上，而其余粒子的权重可以忽略不计。这就是**权重退化**。重采样是标准的补救措施，旨在丢弃低权重的粒子并复制高权重的粒子，从而将计算精力集中在状态空间中有希望的区域。给定的权重中，$w_1=0.24$, $w_4=0.18$, $w_5=0.18$, 和$w_6=0.20$显示出中等程度的退化。\n\n重采样虽然必要，但会引入其自身的问题：**粒子多样性**的损失，因为重采样集合中唯一祖先的数量少于$N$。样本的这种贫化是粒子方法的关键限制。由$\\kappa$测量的高一致性体现了系统重采样如何处理这种权衡。通过保留邻域结构，它避免了独立重采样可能导致的粒子位置完全随机化，如果高权重粒子在状态空间中形成一个“簇”，这可能是有益的。\n\n整个这种动态被**维度灾难**严重加剧，这是高维逆问题中的一个关键问题。随着状态空间维度的增长，空间的体积呈指数增长。SMC采样器所针对的后验分布通常集中在该体积中一个极小的部分。因此，固定数量的随机粒子$N$落入这个高概率区域的可能性越来越小。这导致极端的权重退化，通常在更新步骤之后只有一个粒子具有非零权重。在这种灾难性的崩溃中，任何重采样方案，包括系统重采样，都只会选择那一个粒子$N$次。得到的重采样集合将是$(a_1, \\dots, a_N) = (j, j, \\dots, j)$，其中$j$是某个索引。在这种情况下，$\\kappa$将为$1$，但这将意味着多样性的完全丧失，而不是健康的结构保留。因此，系统重采样的一致性特性并非解决维度灾难的灵丹妙药；它只是反映了其所处理的权重的结构。根本问题在于重要性采样无法有效探索高维空间，这一挑战需要比简单重采样更先进的技术。",
            "answer": "$$ \\boxed{\\frac{7}{9}} $$"
        }
    ]
}