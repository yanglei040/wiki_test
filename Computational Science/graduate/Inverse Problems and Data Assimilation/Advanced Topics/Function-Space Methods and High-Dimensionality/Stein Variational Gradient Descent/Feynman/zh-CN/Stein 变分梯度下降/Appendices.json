{
    "hands_on_practices": [
        {
            "introduction": "理论是抽象的，而实践是理解算法最有效的方式。此练习旨在将斯坦因变分梯度下降（SVGD）的抽象更新规则具体化。通过为一个简单的双粒子系统手工计算单步迭代，我们可以清晰地看到核函数、核梯度、目标得分函数以及步长如何协同作用，驱动粒子向目标分布移动。这有助于我们对 SVGD 的核心机制建立一个坚实的、可计算的直观认识 ()。",
            "id": "3348310",
            "problem": "考虑斯坦因变分梯度下降 (Stein Variational Gradient Descent, SVGD)，该方法通过在再生核希尔伯特空间 (Reproducing Kernel Hilbert Space, RKHS) 中利用速度场输运粒子分布，对 Kullback–Leibler 散度执行函数梯度下降。在一维情况下，对于一个可微的目标密度 $p(x)$，作用于标量测试函数 $f$ 的斯坦因算子为 $T_{p} f(x) = f^{\\prime}(x) + f(x)\\,\\nabla_{x} \\ln p(x)$。设目标为标准正态密度 $p(x) = \\mathcal{N}(0,1)$，且 RKHS 由带宽参数为 $h > 0$ 的径向基函数 (Radial Basis Function, RBF) 核 $k_{h}(x,x^{\\prime}) = \\exp\\!\\big(-\\frac{(x-x^{\\prime})^{2}}{2 h^{2}}\\big)$ 导出。给定两个初始粒子，其位置为 $x_{1}^{(0)} = -1$ 和 $x_{2}^{(0)} = 2$。使用 SVGD 框架，从斯坦因算子定义和 RKHS 表示定理属性出发（不假设任何预先给定的闭式更新），推导单次迭代（步长为 $\\epsilon > 0$）的经验 SVGD 粒子更新，然后计算更新后的粒子位置 $x_{1}^{(1)}$ 和 $x_{2}^{(1)}$，并将其明确表示为 $h$ 和 $\\epsilon$ 的解析函数。请以精确的闭式形式（无四舍五入）表达您的最终结果。最终答案必须是包含 $x_{1}^{(1)}$ 和 $x_{2}^{(1)}$（作为 $h$ 和 $\\epsilon$ 的函数）的单行向量。",
            "solution": "首先，我们从一般形式推导 SVGD 的更新规则，然后将其应用于本问题的具体情况。\n\n### 步骤 1：SVGD 更新规则的推导\n\nSVGD 的目标是通过对粒子施加一个速度场 $\\phi(x)$，将初始粒子分布 $q_0$ 输运到目标分布 $p$。粒子更新方式为 $x' = x + \\epsilon \\phi(x)$。最优速度场 $\\phi(x)$ 是在每一步中能最大程度减小 Kullback–Leibler (KL) 散度 $KL(q_k || p)$ 的那个。这对应于在 RKHS $\\mathcal{H}$ 中对 KL 散度执行函数梯度下降。\n\nKL 散度在 $\\phi$ 方向上的扰动下的方向导数由下式给出：\n$$ \\nabla_{\\phi} KL(q || p) = - \\mathbb{E}_{x \\sim q}[T_p \\phi(x)] $$\n其中 $T_p$ 是斯坦因算子。为实现最速下降，我们必须选择 $\\phi$ 来最大化 $\\mathbb{E}_{x \\sim q}[T_p \\phi(x)]$，同时满足 $\\phi$ 位于 RKHS 单位球内的约束，即 $\\|\\phi\\|_{\\mathcal{H}} \\le 1$。\n\n表达式 $F[\\phi] = \\mathbb{E}_{x \\sim q}[T_p \\phi(x)]$ 是 $\\phi$ 的一个线性泛函。根据 Riesz 表示定理，对于 RKHS 上的任何此类线性泛函，都存在一个唯一的元素 $\\psi_q \\in \\mathcal{H}$，使得对所有 $\\phi \\in \\mathcal{H}$ 都有 $F[\\phi] = \\langle \\phi, \\psi_q \\rangle_{\\mathcal{H}}$。在范数约束下最大化该内积的函数是 $\\phi = \\psi_q / \\|\\psi_q\\|_{\\mathcal{H}}$。因此，最速上升方向由 $\\psi_q$ 给出。\n\n我们可以利用核函数 $k(x, x')$ 的再生性质来找到 $\\psi_q$。对于任意函数 $f \\in \\mathcal{H}$ 和点 $y$，我们有 $f(y) = \\langle f(\\cdot), k(y, \\cdot) \\rangle_{\\mathcal{H}}$。将此应用于 $\\psi_q$：\n$$ \\psi_q(y) = \\langle \\psi_q(\\cdot), k(y, \\cdot) \\rangle_{\\mathcal{H}} $$\n由于内积是对称的，$\\langle f, g \\rangle_{\\mathcal{H}} = \\langle g, f \\rangle_{\\mathcal{H}}$，并且根据 $\\psi_q$ 的定义，我们有 $\\langle k(y, \\cdot), \\psi_q(\\cdot) \\rangle_{\\mathcal{H}} = F[k(y, \\cdot)]$。因此：\n$$ \\psi_q(y) = F[k(y, \\cdot)] = \\mathbb{E}_{x \\sim q}[T_{p,x} k(y, x)] $$\n这里，$T_{p,x}$ 表示斯坦因算子作用于 $k(y,x)$，视其为第二个参数 $x$ 的函数。\n对于对称核 $k(y,x) = k(x,y)$，在点 $y$ 处的最优速度场为：\n$$ \\phi^*(y) = \\psi_q(y) = \\mathbb{E}_{x \\sim q}[T_{p,x} k(x,y)] = \\mathbb{E}_{x \\sim q}[\\nabla_x k(x,y) + k(x,y) \\nabla_x \\ln p(x)] $$\n在实践中，对 $q$ 的期望由当前 $N$ 个粒子集合 $\\{x_i\\}_{i=1}^N$ 的经验平均来近似：\n$$ \\phi(y) \\approx \\frac{1}{N} \\sum_{i=1}^N [\\nabla_{x_i} k(x_i, y) + k(x_i, y) \\nabla_{x_i} \\ln p(x_i)] $$\n粒子 $x_j$ 的 SVGD 更新为 $x_j^{(t+1)} = x_j^{(t)} + \\epsilon \\phi(x_j^{(t)})$，其中速度场在粒子的当前位置 $x_j^{(t)}$ 处求值：\n$$ \\phi(x_j^{(t)}) = \\frac{1}{N} \\sum_{i=1}^N [\\nabla_{x_i} k(x_i^{(t)}, x_j^{(t)}) + k(x_i^{(t)}, x_j^{(t)}) \\nabla_{x_i} \\ln p(x_i^{(t)})] $$\n\n### 步骤 2：应用于给定问题\n\n我们将推导出的更新规则应用于该问题的具体情况。\n1.  **目标分布**：$p(x) = \\mathcal{N}(0,1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-\\frac{x^2}{2})$。\n    对数密度为 $\\ln p(x) = -\\frac{x^2}{2} - \\frac{1}{2}\\ln(2\\pi)$。\n    分数函数（对数密度的梯度）为 $\\nabla_x \\ln p(x) = -x$。\n\n2.  **核函数**：RBF 核为 $k(x, x') = \\exp(-\\frac{(x-x')^2}{2h^2})$。\n    其关于第一个参数的梯度为：\n    $$ \\nabla_x k(x, x') = \\frac{\\partial}{\\partial x} \\exp\\left(-\\frac{(x-x')^2}{2h^2}\\right) = \\exp\\left(-\\frac{(x-x')^2}{2h^2}\\right) \\cdot \\left(-\\frac{2(x-x')}{2h^2}\\right) = -k(x,x') \\frac{x-x'}{h^2} $$\n\n3.  **粒子更新方程**：设迭代 $t=0$ 时的粒子位置为 $\\{x_i^{(0)}\\}_{i=1}^N$。粒子 $x_j^{(0)}$ 的速度场为：\n    $$ \\phi(x_j^{(0)}) = \\frac{1}{N} \\sum_{i=1}^N \\left[ -k(x_i^{(0)}, x_j^{(0)}) \\frac{x_i^{(0)} - x_j^{(0)}}{h^2} + k(x_i^{(0)}, x_j^{(0)}) (-x_i^{(0)}) \\right] $$\n    $$ \\phi(x_j^{(0)}) = \\frac{1}{N} \\sum_{i=1}^N k(x_i^{(0)}, x_j^{(0)}) \\left( -\\frac{x_i^{(0)} - x_j^{(0)}}{h^2} - x_i^{(0)} \\right) $$\n\n4.  **初始条件**：我们有两个粒子 ($N=2$)，位于 $x_1^{(0)} = -1$ 和 $x_2^{(0)} = 2$。\n\n5.  **计算 $x_1^{(1)}$ 的更新**：令 $j=1$。\n    $$ \\phi(x_1^{(0)}) = \\frac{1}{2} \\left[ k(x_1^{(0)}, x_1^{(0)}) \\left( -\\frac{x_1^{(0)} - x_1^{(0)}}{h^2} - x_1^{(0)} \\right) + k(x_2^{(0)}, x_1^{(0)}) \\left( -\\frac{x_2^{(0)} - x_1^{(0)}}{h^2} - x_2^{(0)} \\right) \\right] $$\n    我们计算各项：\n    -   $x_1^{(0)} = -1$, $x_2^{(0)} = 2$。\n    -   $k(x_1^{(0)}, x_1^{(0)}) = \\exp(0) = 1$。\n    -   $k(x_2^{(0)}, x_1^{(0)}) = \\exp\\left(-\\frac{(2 - (-1))^2}{2h^2}\\right) = \\exp\\left(-\\frac{9}{2h^2}\\right)$。\n    -   $i=1$ 的项：$1 \\cdot (0 - (-1)) = 1$。\n    -   $i=2$ 的项：$\\exp\\left(-\\frac{9}{2h^2}\\right) \\left( -\\frac{2 - (-1)}{h^2} - 2 \\right) = \\exp\\left(-\\frac{9}{2h^2}\\right) \\left( -\\frac{3}{h^2} - 2 \\right)$。\n    速度为：\n    $$ \\phi(x_1^{(0)}) = \\frac{1}{2} \\left[ 1 - \\left( \\frac{3}{h^2} + 2 \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) \\right] $$\n    更新后的粒子位置为：\n    $$ x_1^{(1)} = x_1^{(0)} + \\epsilon \\phi(x_1^{(0)}) = -1 + \\frac{\\epsilon}{2} \\left[ 1 - \\left( 2 + \\frac{3}{h^2} \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) \\right] $$\n\n6.  **计算 $x_2^{(1)}$ 的更新**：令 $j=2$。\n    $$ \\phi(x_2^{(0)}) = \\frac{1}{2} \\left[ k(x_1^{(0)}, x_2^{(0)}) \\left( -\\frac{x_1^{(0)} - x_2^{(0)}}{h^2} - x_1^{(0)} \\right) + k(x_2^{(0)}, x_2^{(0)}) \\left( -\\frac{x_2^{(0)} - x_2^{(0)}}{h^2} - x_2^{(0)} \\right) \\right] $$\n    我们计算各项：\n    -   $k(x_1^{(0)}, x_2^{(0)}) = \\exp\\left(-\\frac{(-1 - 2)^2}{2h^2}\\right) = \\exp\\left(-\\frac{9}{2h^2}\\right)$。\n    -   $k(x_2^{(0)}, x_2^{(0)}) = 1$。\n    -   $i=1$ 的项：$\\exp\\left(-\\frac{9}{2h^2}\\right) \\left( -\\frac{-1 - 2}{h^2} - (-1) \\right) = \\exp\\left(-\\frac{9}{2h^2}\\right) \\left( \\frac{3}{h^2} + 1 \\right)$。\n    -   $i=2$ 的项：$1 \\cdot (0 - 2) = -2$。\n    速度为：\n    $$ \\phi(x_2^{(0)}) = \\frac{1}{2} \\left[ \\left( \\frac{3}{h^2} + 1 \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) - 2 \\right] $$\n    更新后的粒子位置为：\n    $$ x_2^{(1)} = x_2^{(0)} + \\epsilon \\phi(x_2^{(0)}) = 2 + \\frac{\\epsilon}{2} \\left[ \\left( 1 + \\frac{3}{h^2} \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) - 2 \\right] $$\n    这可以简化为：\n    $$ x_2^{(1)} = 2 - \\epsilon + \\frac{\\epsilon}{2} \\left( 1 + \\frac{3}{h^2} \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) $$\n更新后的粒子位置的最终表达式为：\n$$ x_1^{(1)} = -1 + \\frac{\\epsilon}{2} \\left[ 1 - \\left( 2 + \\frac{3}{h^2} \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) \\right] $$\n$$ x_2^{(1)} = 2 - \\epsilon + \\frac{\\epsilon}{2} \\left( 1 + \\frac{3}{h^2} \\right) \\exp\\left(-\\frac{9}{2h^2}\\right) $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1 + \\frac{\\epsilon}{2} \\left( 1 - \\left(2 + \\frac{3}{h^2}\\right) \\exp\\left(-\\frac{9}{2h^2}\\right) \\right)  2 - \\epsilon + \\frac{\\epsilon}{2} \\left( 1 + \\frac{3}{h^2} \\right) \\exp\\left(-\\frac{9}{2h^2}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "SVGD 的一个显著优势是能够维持一个多样化的粒子集合，从而有效避免“模式坍塌”（mode collapse）。此练习深入探究了这一特性的内在机理：即粒子受到的两种力的精妙平衡——一种是来自目标分布高密度区域的“引力”，另一种是来自核函数的粒子间“斥力”。通过分析一个对称的双粒子系统，并计算出引力与斥力达到平衡的临界距离，我们可以从量上理解 SVGD 是如何通过粒子间的相互作用来近似目标分布的 ()。",
            "id": "3348300",
            "problem": "考虑斯坦因变分梯度下降（SVGD），它由一个泛函梯度流定义，该梯度流输运一组粒子以逼近目标密度 $p(x)$。对于 $\\mathbb{R}^{d}$ 中的一个包含 $n$ 个粒子的有限集合 $\\{x_{i}\\}_{i=1}^{n}$，粒子 $x_{i}$ 处的经验 SVGD 速度为\n$$\n\\phi(x_{i}) \\;=\\; \\frac{1}{n} \\sum_{j=1}^{n} \\Big( k(x_{j},x_{i}) \\,\\nabla \\ln p(x_{j}) \\;+\\; \\nabla_{x_{j}} k(x_{j},x_{i}) \\Big),\n$$\n其中 $k(x,y)$ 是一个正定核，$\\nabla$ 表示关于其参数的梯度。在 SVGD 中，第一项是朝向高密度区域的吸引力，第二项是使粒子散开的排斥力。令核函数为带宽 $h0$ 的高斯径向基函数（RBF）核 $k(x,y) = \\exp\\!\\big(-\\|x-y\\|^{2}/(2 h^{2})\\big)$。\n\n任务 A（排斥力的尺度变化）：在一维（$d=1$）情况下，对于位于 $x_{1}$ 和 $x_{2}$ 处、粒子间距离为 $d = |x_{1}-x_{2}|$ 的 $n=2$ 个粒子，推导由 $x_{2}$ 对 $x_{1}$ 速度产生的两两排斥贡献的幅值，该幅值是 $d$ 和 $h$ 的函数。您必须仅使用 $d$ 和 $h$ 将其表示为闭式形式。\n\n任务 B（模式坍塌的量化避免）：考虑方差为 $\\sigma^{2}  0$ 的一维高斯目标 $p(x) = \\mathcal{N}(0,\\sigma^{2})$。将 $n=2$ 个粒子对称地放置在 $x_{1}=a$ 和 $x_{2}=-a$ 处，其中 $a0$。仅使用上述 SVGD 定义和给定的 RBF 核，计算 $x_{1}$ 处 SVGD 速度的径向分量指向外部（即增大 $|a|$）的确切条件。然后，求解唯一的临界分离距离 $a_{c}(h,\\sigma)$，在该距离下 $x_{1}$ 处的径向 SVGD 速度恰好为零。您的最终答案必须是 $a_{c}(h,\\sigma)$ 的单个闭式解析表达式，不含未求值的极限或隐式定义。\n\n答案格式要求：仅提供 $a_{c}(h,\\sigma)$ 的解析表达式作为您的最终答案。不包括单位。无需四舍五入。",
            "solution": "我们首先建立求解此问题所需的数学组件，然后按顺序解决两个任务，以得出最终所需的临界分离距离 $a_{c}(h, \\sigma)$ 的表达式。\n\n首先，我们建立必要的数学组件。\n粒子 $x_i$ 处的 SVGD 速度由下式给出：\n$$ \\phi(x_{i}) = \\frac{1}{n} \\sum_{j=1}^{n} \\left( k(x_{j},x_{i}) \\nabla \\ln p(x_{j}) + \\nabla_{x_{j}} k(x_{j},x_{i}) \\right) $$\n核函数是一维（$d=1$）高斯 RBF 核：\n$$ k(x,y) = \\exp\\left(-\\frac{(x-y)^2}{2h^2}\\right) $$\n核函数关于其第一个参数 $x_j$ 的梯度是：\n$$ \\nabla_{x_{j}} k(x_{j},x_{i}) = \\frac{\\partial}{\\partial x_j} \\exp\\left(-\\frac{(x_j-x_i)^2}{2h^2}\\right) = \\exp\\left(-\\frac{(x_j-x_i)^2}{2h^2}\\right) \\cdot \\left(-\\frac{2(x_j-x_i)}{2h^2}\\right) = -\\frac{x_j-x_i}{h^2} k(x_j,x_i) $$\n\n**任务 A：排斥力的尺度变化**\n\n此任务要求计算粒子 $x_2$ 对粒子 $x_1$ 速度产生的两两排斥贡献的幅值。粒子数量为 $n=2$。排斥贡献是速度更新中涉及核梯度的部分。对于速度 $\\phi(x_1)$，对应于 $j=2$ 的项包含了来自 $x_2$ 的排斥力。该贡献由 $\\frac{1}{n} \\nabla_{x_2} k(x_2, x_1)$ 给出。\n\n使用 $n=2$ 和上面计算的导数：\n$$ \\text{Repulsion from } x_2 \\text{ on } x_1 = \\frac{1}{2} \\nabla_{x_2} k(x_2, x_1) = \\frac{1}{2} \\left( -\\frac{x_2-x_1}{h^2} k(x_2, x_1) \\right) = \\frac{x_1-x_2}{2h^2} k(x_1, x_2) $$\n问题要求此项的幅值。令 $d = |x_1 - x_2|$。核函数 $k(x_1, x_2)$ 始终为正。\n$$ k(x_1, x_2) = \\exp\\left(-\\frac{(x_1-x_2)^2}{2h^2}\\right) = \\exp\\left(-\\frac{d^2}{2h^2}\\right) $$\n因此，幅值为：\n$$ \\left| \\frac{x_1-x_2}{2h^2} k(x_1, x_2) \\right| = \\frac{|x_1-x_2|}{2h^2} k(x_1, x_2) = \\frac{d}{2h^2} \\exp\\left(-\\frac{d^2}{2h^2}\\right) $$\n该表达式表示一个粒子对另一个粒子施加的排斥力的大小，它是它们之间分离距离 $d$ 和核带宽 $h$ 的函数。\n\n**任务 B：模式坍塌的量化避免**\n\n此任务要求我们针对一个特定设置找到临界分离距离 $a_c(h, \\sigma)$。\n给定的设置是：\n- 维度：$d=1$。\n- 粒子数：$n=2$。\n- 粒子位置：$x_1 = a$ 和 $x_2 = -a$，其中 $a  0$。\n- 目标密度：$p(x) = \\mathcal{N}(0, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$。\n\n我们首先计算对数目标密度的梯度：\n$$ \\ln p(x) = -\\ln(\\sqrt{2\\pi}\\sigma) - \\frac{x^2}{2\\sigma^2} $$\n$$ \\nabla \\ln p(x) = \\frac{d}{dx} \\ln p(x) = -\\frac{x}{\\sigma^2} $$\n在粒子位置处，我们有：\n$$ \\nabla \\ln p(x_1) = \\nabla \\ln p(a) = -\\frac{a}{\\sigma^2} $$\n$$ \\nabla \\ln p(x_2) = \\nabla \\ln p(-a) = -\\frac{-a}{\\sigma^2} = \\frac{a}{\\sigma^2} $$\n\n接下来，我们计算 $x_1 = a$ 处的 SVGD 速度。速度表达式为：\n$$ \\phi(x_1) = \\frac{1}{2} \\left[ \\left( k(x_1, x_1) \\nabla\\ln p(x_1) + \\nabla_{x_1} k(x_1, x_1) \\right) + \\left( k(x_2, x_1) \\nabla\\ln p(x_2) + \\nabla_{x_2} k(x_2, x_1) \\right) \\right] $$\n我们计算和中的每一项：\n\n第 1 项（与自身的相互作用，$j=1$）：\n- $k(x_1, x_1) = k(a,a) = \\exp(0) = 1$。\n- $\\nabla\\ln p(x_1) = -a/\\sigma^2$。\n- $\\nabla_{x_1} k(x_1, x_1) = -\\frac{x_1-x_1}{h^2} k(x_1,x_1) = 0$。\n因此，方括号中的第一项是 $(1 \\cdot (-a/\\sigma^2) + 0) = -a/\\sigma^2$。\n\n第 2 项（与 $x_2$ 的相互作用，$j=2$）：\n- $x_2 - x_1 = -a - a = -2a$。\n- $k(x_2, x_1) = k(-a, a) = \\exp\\left(-\\frac{(-2a)^2}{2h^2}\\right) = \\exp\\left(-\\frac{2a^2}{h^2}\\right)$。\n- $\\nabla\\ln p(x_2) = a/\\sigma^2$。\n- $\\nabla_{x_2} k(x_2, x_1) = -\\frac{x_2-x_1}{h^2} k(x_2, x_1) = -\\frac{-2a}{h^2} \\exp\\left(-\\frac{2a^2}{h^2}\\right) = \\frac{2a}{h^2} \\exp\\left(-\\frac{2a^2}{h^2}\\right)$。\n因此，方括号中的第二项是：\n$$ \\exp\\left(-\\frac{2a^2}{h^2}\\right) \\cdot \\left(\\frac{a}{\\sigma^2}\\right) + \\frac{2a}{h^2} \\exp\\left(-\\frac{2a^2}{h^2}\\right) = \\exp\\left(-\\frac{2a^2}{h^2}\\right) \\left( \\frac{a}{\\sigma^2} + \\frac{2a}{h^2} \\right) $$\n\n现在，我们组合出 $\\phi(x_1)$ 的完整表达式：\n$$ \\phi(x_1) = \\frac{1}{2} \\left[ -\\frac{a}{\\sigma^2} + \\exp\\left(-\\frac{2a^2}{h^2}\\right) \\left( \\frac{a}{\\sigma^2} + \\frac{2a}{h^2} \\right) \\right] $$\n提出因子 $a/2$：\n$$ \\phi(x_1) = \\frac{a}{2} \\left[ -\\frac{1}{\\sigma^2} + \\exp\\left(-\\frac{2a^2}{h^2}\\right) \\left( \\frac{1}{\\sigma^2} + \\frac{2}{h^2} \\right) \\right] $$\n临界分离距离 $a_c$ 定义为使速度为零的 $a$ 值，即 $\\phi(x_1) = 0$。由于给定 $a0$，我们需要方括号中的项为零。令 $a = a_c$：\n$$ -\\frac{1}{\\sigma^2} + \\exp\\left(-\\frac{2a_c^2}{h^2}\\right) \\left( \\frac{1}{\\sigma^2} + \\frac{2}{h^2} \\right) = 0 $$\n$$ \\exp\\left(-\\frac{2a_c^2}{h^2}\\right) \\left( \\frac{1}{\\sigma^2} + \\frac{2}{h^2} \\right) = \\frac{1}{\\sigma^2} $$\n$$ \\exp\\left(-\\frac{2a_c^2}{h^2}\\right) = \\frac{1/\\sigma^2}{1/\\sigma^2 + 2/h^2} $$\n为简化右侧，我们通分：\n$$ \\frac{1/\\sigma^2}{(h^2 + 2\\sigma^2)/(\\sigma^2 h^2)} = \\frac{1}{\\sigma^2} \\cdot \\frac{\\sigma^2 h^2}{h^2 + 2\\sigma^2} = \\frac{h^2}{h^2 + 2\\sigma^2} $$\n$a_c$ 的方程是：\n$$ \\exp\\left(-\\frac{2a_c^2}{h^2}\\right) = \\frac{h^2}{h^2 + 2\\sigma^2} $$\n为了求解 $a_c$，我们对两边取自然对数：\n$$ -\\frac{2a_c^2}{h^2} = \\ln\\left(\\frac{h^2}{h^2 + 2\\sigma^2}\\right) $$\n使用性质 $\\ln(x/y) = -\\ln(y/x)$：\n$$ \\frac{2a_c^2}{h^2} = \\ln\\left(\\frac{h^2 + 2\\sigma^2}{h^2}\\right) = \\ln\\left(1 + \\frac{2\\sigma^2}{h^2}\\right) $$\n现在，我们求解 $a_c^2$：\n$$ a_c^2 = \\frac{h^2}{2} \\ln\\left(1 + \\frac{2\\sigma^2}{h^2}\\right) $$\n由于 $a  0$，我们取正平方根：\n$$ a_c(h, \\sigma) = \\sqrt{\\frac{h^2}{2} \\ln\\left(1 + \\frac{2\\sigma^2}{h^2}\\right)} $$\n这可以写成：\n$$ a_c(h, \\sigma) = h \\sqrt{\\frac{1}{2} \\ln\\left(1 + \\frac{2\\sigma^2}{h^2}\\right)} $$\n这是使得 $x_1=a$ 处 SVGD 速度为零的唯一临界分离距离。对于 $a  a_c$，项 $\\exp(-2a^2/h^2)$ 更大，使得速度为正（向外的排斥力占主导）。对于 $a > a_c$，速度为负（向 $x=0$ 处模式的吸引力占主导）。",
            "answer": "$$ \\boxed{h \\sqrt{\\frac{1}{2} \\ln\\left(1 + \\frac{2\\sigma^2}{h^2}\\right)}} $$"
        }
    ]
}