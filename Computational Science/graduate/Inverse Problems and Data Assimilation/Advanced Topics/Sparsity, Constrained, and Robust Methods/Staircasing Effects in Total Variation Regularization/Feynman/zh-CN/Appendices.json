{
    "hands_on_practices": [
        {
            "introduction": "当全变分（TV）正则化应用于平滑信号时，阶梯效应表现得最为清晰。在本练习中，我们将考虑一个典型案例：逼近线性斜坡函数 $f(x)=x$。通过从第一性原理出发最小化TV正则化目标函数，您将推导出最优的双平台“阶梯”解，从而具体理解TV正则化是如何将平滑的梯度转化为分段常数区域的。",
            "id": "3420945",
            "problem": "考虑在区间 $[0,1]$ 上的一个一维数据同化问题，其确定性观测值为 $f(x) = x$。我们寻求一个具有两个平稳段的阶梯解，即一个分段常数函数 $u$，其形式为\n$$\nu(x) = \\begin{cases}\nc_{1},  & x \\in [0,s),\\\\\nc_{2},  & x \\in [s,1],\n\\end{cases}\n$$\n其中 $s \\in (0,1)$ 为某个断点，$c_{1}, c_{2} \\in \\mathbb{R}$ 为平稳段的值。该估计量是通过最小化逆问题中使用的标准Tikhonov型 $L^{2}$ 保真度与全变分（TV）正则化来选择的：\n$$\n\\min_{c_{1},c_{2},s} \\ \\frac{1}{2} \\int_{0}^{1} \\big(u(x)-f(x)\\big)^{2} \\,\\mathrm{d}x \\ + \\ \\lambda \\, TV(u),\n$$\n其中 $TV$ 表示全变分，对于这样一个在 $x=s$ 处有单次跳跃的分段常数函数 $u$，我们有 $TV(u) = |c_{2} - c_{1}|$。常数 $\\lambda>0$ 是正则化参数。\n\n仅从 $L^{2}$ 范数和全变分的基本定义出发，推导出联合最小化以下表达式的最优平稳段值 $c_{1}^{\\star}$ 和 $c_{2}^{\\star}$ 以及最优断点 $s^{\\star}$：\n$$\n\\frac{1}{2}\\left(\\int_{0}^{s} (c_{1}-x)^{2}\\,\\mathrm{d}x + \\int_{s}^{1} (c_{2}-x)^{2}\\,\\mathrm{d}x\\right) + \\lambda |c_{2}-c_{1}|,\n$$\n假设 $0 < \\lambda < \\frac{1}{8}$，以使最小化子呈现两个不同的平稳段。你的最终答案必须是给出 $c_{1}^{\\star}$、$c_{2}^{\\star}$ 和 $s^{\\star}$ 的单一闭式解析表达式。",
            "solution": "问题在于找到最优参数 $c_1$、$c_2$ 和 $s$，以最小化目标泛函 $J(c_1, c_2, s)$。该泛函由一个 $L^2$ 数据保真项和一个全变分（TV）正则化项组成。观测值为区间 $[0,1]$ 上的 $f(x) = x$。所求的解 $u(x)$ 是一个具有两个平稳段 $c_1$ 和 $c_2$ 的分段常数函数，其断点为 $s$。\n\n目标泛函由下式给出：\n$$\nJ(c_1, c_2, s) = \\frac{1}{2} \\int_{0}^{1} \\big(u(x)-f(x)\\big)^{2} \\,\\mathrm{d}x \\ + \\ \\lambda \\, TV(u)\n$$\n代入 $u(x)$、$f(x)$ 和 $TV(u)$ 的给定形式，我们得到：\n$$\nJ(c_1, c_2, s) = \\frac{1}{2}\\left(\\int_{0}^{s} (c_{1}-x)^{2}\\,\\mathrm{d}x + \\int_{s}^{1} (c_{2}-x)^{2}\\,\\mathrm{d}x\\right) + \\lambda |c_{2}-c_{1}|\n$$\n此最小化是相对于 $c_1 \\in \\mathbb{R}$、$c_2 \\in \\mathbb{R}$ 和 $s \\in (0,1)$ 进行的。问题陈述指明我们要寻找一个具有两个不同平稳段的解，这意味着 $c_1 \\neq c_2$。数据函数 $f(x)=x$ 是严格递增的。可以合理预期最优近似 $u(x)$ 是非递减的，这意味着我们可以假设 $c_1 \\le c_2$。条件 $0  \\lambda  1/8$ 确保了 $c_1  c_2$，因此我们可以将 $|c_2 - c_1|$ 替换为 $c_2 - c_1$。目标泛函变为：\n$$\nJ(c_1, c_2, s) = \\frac{1}{2}\\left(\\int_{0}^{s} (c_{1}-x)^{2}\\,\\mathrm{d}x + \\int_{s}^{1} (c_{2}-x)^{2}\\,\\mathrm{d}x\\right) + \\lambda (c_{2}-c_{1})\n$$\n为了找到最优值 $(c_1^{\\star}, c_2^{\\star}, s^{\\star})$，我们使用最小化的一阶必要条件。这包括将 $J$ 关于 $c_1$、$c_2$ 和 $s$ 的偏导数设为零。\n\n首先，对于一个固定的 $s$ 值，我们求最优的 $c_1$ 和 $c_2$。我们计算 $J$ 关于 $c_1$ 和 $c_2$ 的偏导数：\n$$\n\\frac{\\partial J}{\\partial c_1} = \\frac{\\partial}{\\partial c_1} \\left[ \\frac{1}{2} \\int_{0}^{s} (c_{1}-x)^{2}\\,\\mathrm{d}x - \\lambda c_1 \\right] = \\int_{0}^{s} (c_1 - x)\\,\\mathrm{d}x - \\lambda\n$$\n$$\n\\frac{\\partial J}{\\partial c_2} = \\frac{\\partial}{\\partial c_2} \\left[ \\frac{1}{2} \\int_{s}^{1} (c_{2}-x)^{2}\\,\\mathrm{d}x + \\lambda c_2 \\right] = \\int_{s}^{1} (c_2 - x)\\,\\mathrm{d}x + \\lambda\n$$\n将这些导数设为零，得到：\n$$\n\\int_{0}^{s} (c_1 - x)\\,\\mathrm{d}x = \\lambda \\implies \\left[ c_1 x - \\frac{x^2}{2} \\right]_0^s = \\lambda \\implies c_1 s - \\frac{s^2}{2} = \\lambda\n$$\n$$\n\\int_{s}^{1} (c_2 - x)\\,\\mathrm{d}x = -\\lambda \\implies \\left[ c_2 x - \\frac{x^2}{2} \\right]_s^1 = -\\lambda \\implies (c_2 - \\frac{1}{2}) - (c_2 s - \\frac{s^2}{2}) = -\\lambda\n$$\n从第一个方程中，我们将 $c_1$ 解为 $s$ 的函数：\n$$\nc_1(s) = \\frac{s}{2} + \\frac{\\lambda}{s}\n$$\n从第二个方程中，我们将 $c_2$ 解为 $s$ 的函数：\n$$\nc_2(1-s) - \\frac{1-s^2}{2} = -\\lambda \\implies c_2(1-s) = \\frac{(1-s)(1+s)}{2} - \\lambda \\implies c_2(s) = \\frac{1+s}{2} - \\frac{\\lambda}{1-s}\n$$\n这些表达式给出了对于任意给定断点 $s$ 的最优平稳段值。\n\n接下来，我们寻找最优断点 $s^{\\star}$。我们将 $c_1(s)$ 和 $c_2(s)$ 代入 $J$ 中，得到一个仅关于 $s$ 的函数，然后对其进行最小化。一个更直接的方法是，使用我们刚刚找到的 $c_1$ 和 $c_2$ 的值，求出 $J(c_1, c_2, s)$ 关于 $s$ 的偏导数并将其设为零。根据包络定理，对于最优函数 $c_1(s)$ 和 $c_2(s)$，全导数 $\\frac{dJ}{ds}$ 简化为偏导数 $\\frac{\\partial J}{\\partial s}$。\n$$\n\\frac{dJ}{ds} = \\frac{\\partial J}{\\partial c_1}\\frac{dc_1}{ds} + \\frac{\\partial J}{\\partial c_2}\\frac{dc_2}{ds} + \\frac{\\partial J}{\\partial s}\n$$\n由于 $c_1(s)$ 和 $c_2(s)$ 的定义使得 $\\frac{\\partial J}{\\partial c_1} = 0$ 和 $\\frac{\\partial J}{\\partial c_2} = 0$，这可以简化为 $\\frac{dJ}{ds} = \\frac{\\partial J}{\\partial s}$。\n\n使用莱布尼茨积分法则，$J$ 关于 $s$ 的偏导数为：\n$$\n\\frac{\\partial J}{\\partial s} = \\frac{1}{2}(c_1-s)^2 - \\frac{1}{2}(c_2-s)^2\n$$\n将其设为零以找到最优的 $s$：\n$$\n\\frac{1}{2}(c_1-s)^2 - \\frac{1}{2}(c_2-s)^2 = 0 \\implies (c_1-s)^2 = (c_2-s)^2\n$$\n这意味着 $c_1-s = \\pm(c_2-s)$。\n情况1：$c_1-s = c_2-s \\implies c_1=c_2$。这意味着没有跳跃，是单个平稳段的解。这种情况在 $\\lambda \\ge 1/8$ 时发生，但问题指定了 $\\lambda  1/8$。因此我们舍弃这种情况。\n情况2：$c_1-s = -(c_2-s) \\implies c_1-s = s-c_2 \\implies c_1+c_2 = 2s$。\n这个条件意味着最优断点 $s$ 是平稳段值 $c_1$ 和 $c_2$ 的算术平均值。\n\n现在我们有一个包含三个未知数 $c_1, c_2, s$ 的三方程系统：\n1. $c_1 = \\frac{s}{2} + \\frac{\\lambda}{s}$\n2. $c_2 = \\frac{1+s}{2} - \\frac{\\lambda}{1-s}$\n3. $c_1+c_2 = 2s$\n\n将(1)和(2)代入(3)：\n$$\n\\left(\\frac{s}{2} + \\frac{\\lambda}{s}\\right) + \\left(\\frac{1+s}{2} - \\frac{\\lambda}{1-s}\\right) = 2s\n$$\n$$\ns + \\frac{1}{2} + \\lambda\\left(\\frac{1}{s} - \\frac{1}{1-s}\\right) = 2s\n$$\n$$\n\\frac{1}{2} - s + \\lambda\\left(\\frac{1-s-s}{s(1-s)}\\right) = 0\n$$\n$$\n\\frac{1-2s}{2} + \\lambda\\frac{1-2s}{s(1-s)} = 0\n$$\n$$\n(1-2s)\\left(\\frac{1}{2} + \\frac{\\lambda}{s(1-s)}\\right) = 0\n$$\n这个方程有两个可能的解。\n可能性A：$1-2s=0 \\implies s = 1/2$。这个解在有效区间 $(0,1)$ 内。\n可能性B：$\\frac{1}{2} + \\frac{\\lambda}{s(1-s)} = 0 \\implies s(1-s) = -2\\lambda$。这是一个二次方程 $s^2-s-2\\lambda=0$。其解为 $s = \\frac{1 \\pm \\sqrt{1+8\\lambda}}{2}$。对于 $\\lambda0$，有 $\\sqrt{1+8\\lambda}1$。因此，根 $\\frac{1+\\sqrt{1+8\\lambda}}{2}  1$，而根 $\\frac{1-\\sqrt{1+8\\lambda}}{2}  0$。两个根都不在区间 $(0,1)$ 内。\n\n因此，唯一有效的最优断点是 $s^{\\star} = 1/2$。\n\n最后，我们将 $s^{\\star}=1/2$ 代入其表达式中，求出最优平稳段值 $c_1^{\\star}$ 和 $c_2^{\\star}$：\n$$\nc_1^{\\star} = c_1(1/2) = \\frac{1/2}{2} + \\frac{\\lambda}{1/2} = \\frac{1}{4} + 2\\lambda\n$$\n$$\nc_2^{\\star} = c_2(1/2) = \\frac{1+1/2}{2} - \\frac{\\lambda}{1-1/2} = \\frac{3/2}{2} - \\frac{\\lambda}{1/2} = \\frac{3}{4} - 2\\lambda\n$$\n我们检查我们最初的假设 $c_1  c_2$：\n$$\nc_2^{\\star} - c_1^{\\star} = \\left(\\frac{3}{4} - 2\\lambda\\right) - \\left(\\frac{1}{4} + 2\\lambda\\right) = \\frac{1}{2} - 4\\lambda\n$$\n条件 $c_2^{\\star}  c_1^{\\star}$ 要求 $\\frac{1}{2} - 4\\lambda  0 \\implies \\lambda  \\frac{1}{8}$。这与问题的假设一致，从而证明了我们将 $|c_2-c_1|$ 替换为 $c_2-c_1$ 的合理性。\n\n最优参数为：\n$c_1^{\\star} = \\frac{1}{4} + 2\\lambda$\n$c_2^{\\star} = \\frac{3}{4} - 2\\lambda$\n$s^{\\star} = \\frac{1}{2}$",
            "answer": "$$\n\\boxed{\nc_1^{\\star} = \\frac{1}{4} + 2\\lambda, \\quad\nc_2^{\\star} = \\frac{3}{4} - 2\\lambda, \\quad\ns^{\\star} = \\frac{1}{2}\n}\n$$"
        },
        {
            "introduction": "正则化的强度由参数 $\\lambda$ 控制，它决定了阶梯效应的严重程度。本实践将通过一个简单的离散去噪问题，对这一关系进行详细的、分步的分析。通过为不同的 $\\lambda$ 区间显式地构造解，您将精确地看到增大该参数是如何迫使不同的信号水平融合成更大的平台的。",
            "id": "3420941",
            "problem": "考虑一个在区间 $[0,1]$ 上的一维离散去噪问题，该区间上有一个包含 $n=4$ 个点的均匀网格，点的位置为 $t_{i} \\in \\{0, \\tfrac{1}{3}, \\tfrac{2}{3}, 1\\}$。观测数据为带噪声的阶梯值\n$$\nf_{1} = 0.02,\\quad f_{2} = 0.08,\\quad f_{3} = 0.95,\\quad f_{4} = 1.10.\n$$\n对于正则化参数 $\\lambda \\ge 0$，考虑一维 Rudin–Osher–Fatemi (ROF) 全变分 (TV) 正则化问题\n$$\n\\min_{u \\in \\mathbb{R}^{4}} \\ \\frac{1}{2}\\sum_{i=1}^{4} (u_{i} - f_{i})^{2} \\ + \\ \\lambda \\sum_{i=1}^{3} |u_{i+1} - u_{i}|.\n$$\n从一维全变分去噪的拉紧弦特性可知，其解可以通过对一条最短路径求离散导数得到。该最短路径位于数据累积和曲线周围一个半宽为 $\\lambda$ 的带状区域内，并连接该累积和曲线的两个端点。仅使用基本原理（凸优化最优性条件和 TV 项的次梯度条件）以及将拉紧弦特性作为定义，完成以下任务：\n\n- 对于 $\\lambda$ 的每一种情况，显式地构造与累积数据 $F_{k} := \\sum_{i=1}^{k} f_{i}$（$k=0,1,2,3,4$，且 $F_{0} := 0$）相对应的拉紧弦，并由此获得 TV 去噪解 $u_{\\lambda}$。\n- 确定平台区域的数量（$u_{\\lambda}$ 保持恒定的最大连续索引集）及其位置（每个平台包含哪些索引），并将其表示为 $\\lambda$ 的函数。\n\n最后，令 $N(\\lambda)$ 表示 $u_{\\lambda}$ 中平台区域的数量。将 $N(\\lambda)$ 表示为关于 $\\lambda$ 的单个分段解析表达式。无需四舍五入。",
            "solution": "我们从以下凸优化问题开始\n$$\n\\min_{u \\in \\mathbb{R}^{4}} \\ J_{\\lambda}(u) := \\frac{1}{2}\\sum_{i=1}^{4} (u_{i} - f_{i})^{2} + \\lambda \\sum_{i=1}^{3} |u_{i+1} - u_{i}|.\n$$\n全变分 (TV) 项是一阶差分的 $\\ell^{1}$ 范数。最优性条件的一个标准表述使用离散差分算子 $D \\in \\mathbb{R}^{3 \\times 4}$，其中 $(Du)_{i} = u_{i+1} - u_{i}$ 对于 $i \\in \\{1,2,3\\}$，以及其转置 $D^{\\top}$。TV 项的次微分为 $D^{\\top}s$，其中 $s \\in \\mathbb{R}^{3}$ 满足 $s_{i} \\in \\partial |(Du)_{i}|$，即 $s_{i} \\in [-1,1]$ 且当 $(Du)_{i} \\neq 0$ 时 $s_{i} = \\operatorname{sign}((Du)_{i})$。一阶最优性条件是\n$$\nu - f + \\lambda D^{\\top} s = 0.\n$$\n一个对偶且等价的公式，有时也称为离散拉紧弦方法，引入了 $p \\in \\mathbb{R}^{3}$，满足 $|p_{i}| \\le \\lambda$ 和 $p_{0} := 0$, $p_{4} := 0$，使得唯一的最小化子 $u_{\\lambda}$ 满足\n$$\nu = f + D^{\\top} p, \\quad \\text{也就是} \\quad\n\\begin{cases}\nu_{1} = f_{1} + p_{0} - p_{1} = f_{1} - p_{1},\\\\\nu_{2} = f_{2} + p_{1} - p_{2},\\\\\nu_{3} = f_{3} + p_{2} - p_{3},\\\\\nu_{4} = f_{4} + p_{3} - p_{4} = f_{4} + p_{3},\n\\end{cases}\n$$\n以及互补条件，即当且仅当 $u_{i+1} = u_{i}$（索引 $i$ 和 $i+1$ 之间存在一个平台）时，有 $|p_{i}|  \\lambda$；而当 $u_{i+1} \\neq u_{i}$ 时，有 $|p_{i}| = \\lambda$ 且 $p_{i} = \\lambda \\operatorname{sign}(u_{i+1} - u_{i})$。对偶变量 $p$ 最小化以下严格凸二次型\n$$\n\\min_{|p_{i}| \\le \\lambda} \\ \\frac{1}{2}\\sum_{i=1}^{4} (f_{i} + p_{i-1} - p_{i})^{2}.\n$$\n无约束最小化子 $p^{\\star}$ 通过将梯度设为零求解线性系统得到。记 $g_{i}(p) := \\partial/\\partial p_{i} \\ \\tfrac{1}{2}\\sum_{k=1}^{4} (f_{k} + p_{k-1} - p_{k})^{2}$ 并令 $g_{i}(p) = 0$ 可得\n$$\n\\begin{aligned}\n2 p_{1} - p_{2} + (f_{2} - f_{1}) = 0,\\\\\n-p_{1} + 2 p_{2} - p_{3} + (f_{3} - f_{2}) = 0,\\\\\n-p_{2} + 2 p_{3} + (f_{4} - f_{3}) = 0.\n\\end{aligned}\n$$\n使用给定数据 $f_{1} = 0.02$, $f_{2} = 0.08$, $f_{3} = 0.95$, $f_{4} = 1.10$，方程组变为\n$$\n\\begin{aligned}\n2 p_{1} - p_{2} + 0.06 = 0,\\\\\n-p_{1} + 2 p_{2} - p_{3} + 0.87 = 0,\\\\\n-p_{2} + 2 p_{3} + 0.15 = 0.\n\\end{aligned}\n$$\n求解这个三对角系统，得到无约束解\n$$\np^{\\star} = \\begin{pmatrix} -0.5175 \\\\ -0.975 \\\\ -0.5625 \\end{pmatrix}.\n$$\n随着 $\\lambda$ 的增加，箱式约束 $|p_{i}| \\le \\lambda$ 定义了不同的情况。对于每个 $\\lambda$，Karush–Kuhn–Tucker (KKT) 条件为：\n- 如果 $p_{i} \\in (-\\lambda,\\lambda)$，则 $g_{i}(p) = 0$ (内部)。\n- 如果 $p_{i} = -\\lambda$，则 $g_{i}(p) \\ge 0$。\n- 如果 $p_{i} = \\lambda$，则 $g_{i}(p) \\le 0$。\n由于对所有 $i$ 都有 $p^{\\star}_{i}  0$，因此下界 $p_{i} = -\\lambda$ 是相关的活动面。我们现在追踪随着 $\\lambda$ 的增长，哪些坐标达到了边界。\n\n明确定义梯度：\n$$\ng_{1}(p) = 2 p_{1} - p_{2} + 0.06,\\quad\ng_{2}(p) = -p_{1} + 2 p_{2} - p_{3} + 0.87,\\quad\ng_{3}(p) = -p_{2} + 2 p_{3} + 0.15.\n$$\n\n情况 I：$0 \\le \\lambda \\le 0.06$。\n假设 $p = (-\\lambda,-\\lambda,-\\lambda)$。那么\n$$\ng_{1} = -\\lambda + 0.06 \\ge 0,\\quad g_{2} = 0.87 \\ge 0,\\quad g_{3} = -\\lambda + 0.15 \\ge 0,\n$$\n该条件在 $\\lambda \\le 0.06$ 时成立。因此 $p = (-\\lambda,-\\lambda,-\\lambda)$。解为\n$$\n\\begin{aligned}\nu_{1} = f_{1} - p_{1} = 0.02 + \\lambda,\\\\\nu_{2} = f_{2} + p_{1} - p_{2} = 0.08,\\\\\nu_{3} = f_{3} + p_{2} - p_{3} = 0.95,\\\\\nu_{4} = f_{4} + p_{3} = 1.10 - \\lambda.\n\\end{aligned}\n$$\n差值为 $u_{2} - u_{1} = 0.06 - \\lambda \\ge 0$，$u_{3} - u_{2} = 0.87 > 0$，$u_{4} - u_{3} = 0.15 - \\lambda \\ge 0$，其中当 $0 \\le \\lambda  0.06$ 时为严格不等式。因此，对于 $0 \\le \\lambda  0.06$，存在四个不同的水平（索引间没有平台）。\n\n拉紧弦是累积和 $U_{k} := \\sum_{i=1}^{k} u_{i}$：\n$$\nU_{0} = 0,\\quad U_{1} = 0.02 + \\lambda,\\quad U_{2} = 0.10 + \\lambda,\\quad U_{3} = 1.05 + \\lambda,\\quad U_{4} = 2.15,\n$$\n它位于 $F_{k} := \\sum_{i=1}^{k} f_{i}$ 周围半宽为 $\\lambda$ 的带状区域内，在每一步都接触下壁。\n\n情况 II：$0.06 \\le \\lambda \\le 0.15$。\n此时 $p_{1}$ 离开边界，而 $p_{2} = -\\lambda$，$p_{3} = -\\lambda$ 仍保持在边界上。令 $g_{1} = 0$ 来求解 $p_{1}$：\n$$\n2 p_{1} - (-\\lambda) + 0.06 = 0 \\ \\Rightarrow \\ p_{1} = -\\frac{\\lambda + 0.06}{2}.\n$$\n对于 $\\lambda > 0.06$，检查 $|p_{1}|  \\lambda$，并对边界坐标进行检查：\n$$\ng_{2} = -p_{1} - \\lambda + 0.87 = -\\left(-\\frac{\\lambda + 0.06}{2}\\right) - \\lambda + 0.87 = -\\frac{\\lambda}{2} + 0.90 \\ge 0,\n$$\n这在此情况下成立，并且\n$$\ng_{3} = -(-\\lambda) + 2(-\\lambda) + 0.15 = -\\lambda + 0.15 \\ge 0,\n$$\n在 $\\lambda \\le 0.15$ 时有效。因此\n$$\n\\begin{aligned}\nu_{1} = 0.02 - p_{1} = 0.05 + 0.5 \\lambda,\\\\\nu_{2} = 0.08 + p_{1} - p_{2} = 0.05 + 0.5 \\lambda,\\\\\nu_{3} = 0.95,\\\\\nu_{4} = 1.10 - \\lambda.\n\\end{aligned}\n$$\n因此在索引 $\\{1,2\\}$ 上形成一个平台，在 $\\{3\\}$ 和 $\\{4\\}$ 处有单点平台。拉紧弦的累积和为\n$$\nU_{0} = 0,\\quad U_{1} = 0.05 + 0.5\\lambda,\\quad U_{2} = 0.10 + \\lambda,\\quad U_{3} = 1.05 + \\lambda,\\quad U_{4} = 2.15.\n$$\n\n情况 III：$0.15 \\le \\lambda \\le 0.975$。\n现在 $p_{3}$ 也离开边界，而 $p_{2} = -\\lambda$ 保持在边界上。令 $g_{1} = 0$，$g_{3} = 0$：\n$$\np_{1} = -\\frac{\\lambda + 0.06}{2},\\qquad p_{3} = -\\frac{\\lambda + 0.15}{2}.\n$$\n检查 $p_{2}$ 的边界 KKT 条件：\n$$\ng_{2} = -p_{1} + 2(-\\lambda) - p_{3} + 0.87 = -\\lambda + 0.975 \\ge 0 \\quad \\text{对于} \\quad \\lambda \\le 0.975.\n$$\n因此\n$$\n\\begin{aligned}\nu_{1} = 0.05 + 0.5 \\lambda,\\\\\nu_{2} = 0.05 + 0.5 \\lambda,\\\\\nu_{3} = 0.95 - \\frac{\\lambda}{2} + 0.075 = 1.025 - 0.5 \\lambda,\\\\\nu_{4} = 1.10 - \\frac{\\lambda + 0.15}{2} = 1.025 - 0.5 \\lambda.\n\\end{aligned}\n$$\n因此有两个平台区域：$\\{1,2\\}$ 和 $\\{3,4\\}$。拉紧弦的累积和为\n$$\nU_{0} = 0,\\quad U_{1} = 0.05 + 0.5\\lambda,\\quad U_{2} = 0.10 + \\lambda,\\quad U_{3} = 1.125 + 0.5\\lambda,\\quad U_{4} = 2.15.\n$$\n\n情况 IV：$\\lambda \\ge 0.975$。\n所有坐标都变为内部点；最小化子与无约束解 $p^{\\star}$ 一致。由于当 $\\lambda \\ge 0.975$ 时有 $|p^{\\star}_{i}| \\le \\lambda$，我们得到 $p = p^{\\star}$ 且\n$$\nu = f + D^{\\top} p^{\\star} = \\begin{pmatrix} 0.5375 \\\\ 0.5375 \\\\ 0.5375 \\\\ 0.5375 \\end{pmatrix}.\n$$\n这是一个跨越所有索引的单一平台，其值等于样本均值 $\\bar{f} = \\tfrac{1}{4}\\sum_{i=1}^{4} f_{i} = 0.5375$。拉紧弦是一条直线 $U_{k} = 0.5375 \\, k$。\n\n平台数量和位置总结：\n- 当 $0 \\le \\lambda  0.06$ 时：四个不同的水平（没有合并的平台），索引为 $\\{1\\}$, $\\{2\\}$, $\\{3\\}$, $\\{4\\}$。\n- 当 $0.06 \\le \\lambda  0.15$ 时：三个平台，索引为 $\\{1,2\\}$, $\\{3\\}$, $\\{4\\}$。\n- 当 $0.15 \\le \\lambda  0.975$ 时：两个平台，索引为 $\\{1,2\\}$, $\\{3,4\\}$。\n- 当 $\\lambda \\ge 0.975$ 时：一个平台，索引为 $\\{1,2,3,4\\}$。\n\n因此，平台区域的数量 $N(\\lambda)$ 是如下的分段函数\n$$\nN(\\lambda) =\n\\begin{cases}\n4,  0 \\le \\lambda  0.06,\\\\\n3,  0.06 \\le \\lambda  0.15,\\\\\n2,  0.15 \\le \\lambda  0.975,\\\\\n1,  \\lambda \\ge 0.975.\n\\end{cases}\n$$\n这种分段特性与拉紧弦的构造是一致的：随着 $\\lambda$ 的增长，拉紧弦在对应于平台之间界面的接触点处脱离管壁，使得平台数量从四个单调减少到一个。",
            "answer": "$$\\boxed{N(\\lambda)=\\begin{cases}\n4,  0 \\le \\lambda  0.06,\\\\\n3,  0.06 \\le \\lambda  0.15,\\\\\n2,  0.15 \\le \\lambda  0.975,\\\\\n1,  \\lambda \\ge 0.975.\n\\end{cases}}$$"
        },
        {
            "introduction": "理论通过实现而变得鲜活。这最后一个动手练习旨在挑战您将在数据同化中常见的计算环境中应用您的理解。您将实现一个标准的优化算法来解决一个TV正则化的反问题，并观察在一个更复杂的信号上阶梯效应的出现，从而巩固数学模型与其在实践中行为之间的联系。",
            "id": "3420901",
            "problem": "考虑一个长度为 $N = 64$ 的均匀网格上的一维周期性平流系统。设初始状态为一个向量 $x \\in \\mathbb{R}^{N}$。定义线性平流算子 $H \\in \\mathbb{R}^{N \\times N}$ 为周期性右移 $s = 9$ 个网格点，即对于所有索引 $i$，有 $(Hx)_i = x_{(i - s) \\pmod N}$。我们通过以下公式生成一个确定性的合成真值 $x^{\\star} \\in \\mathbb{R}^{N}$：\n$$\nx^{\\star}_i = 0.4 + 0.3 \\sin\\left(\\frac{2\\pi i}{N}\\right) + 0.3 \\cos\\left(\\frac{4\\pi i}{N}\\right), \\quad \\text{for } i = 0, 1, \\dots, N-1,\n$$\n其中角度以弧度为单位。我们还定义一个确定性的振荡扰动 $\\eta \\in \\mathbb{R}^{N}$：\n$$\n\\eta_i = \\sigma \\sin\\left(\\frac{2\\pi k i}{N}\\right), \\quad \\sigma = 0.05,\\; k = 7,\n$$\n同样，角度以弧度为单位。观测状态为\n$$\ny = H x^{\\star} + \\eta.\n$$\n\n我们提出以下带有全变分（TV）正则化惩罚项的数据同化问题：\n$$\n\\min_{x \\in \\mathbb{R}^{N}} \\; J_{\\lambda}(x) := \\frac{1}{2}\\,\\|H x - y\\|_2^2 + \\lambda \\sum_{i=0}^{N-2} \\left|x_{i+1} - x_i\\right|,\n$$\n其中 $\\lambda \\ge 0$ 是正则化参数，离散各向异性全变分是一阶差分绝对值之和。算子 $H$ 是正交的，因为它是一个置换矩阵，即 $H^{\\top} H = I$。\n\n您的任务是，对于几个不同的 $\\lambda$ 值，计算 $J_{\\lambda}(x)$ 的最小值点 $x_{\\lambda}^{\\star}$，然后通过计算 $x_{\\lambda}^{\\star}$ 中分段常数平台（plateau）的数量来量化阶梯效应。一个平台定义为一个最大的连续索引区间 $[i_{\\text{start}}, i_{\\text{end}}]$，在该区间内的所有连续索引，其绝对差值满足 $\\left|x_{j+1} - x_j\\right| \\le \\varepsilon$，其中容差为 $\\varepsilon = 10^{-3}$。平台计数即为从左到右扫描 $x_{\\lambda}^{\\star}$ 时此类区间的数量。\n\n您必须使用一种基于第一原理的有原则的优化方法来解决这个凸问题。您可以使用任何适用于凸复合优化的正确算法方法，只要它在该设置下是数学上合理的。所有角度都以弧度为单位，没有需要报告的物理单位。\n\n测试套件：\n- 使用上文定义的 $N = 64$，$s = 9$，$\\sigma = 0.05$，$k = 7$ 和 $\\varepsilon = 10^{-3}$。\n- 评估以下正则化强度的平台计数：\n$$\n\\lambda \\in \\{0,\\; 0.05,\\; 0.2,\\; 1.0,\\; 5.0\\}.\n$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含上述 $\\lambda$ 值的平台计数，顺序相同，形式为逗号分隔的列表，并用方括号括起来，例如 $[c_1,c_2,c_3,c_4,c_5]$，其中每个 $c_j$ 是一个整数。",
            "solution": "该问题要求我们解决一个带全变分（TV）正则化惩罚项的一维数据同化问题。目标是找到一个目标函数的最小值点，然后通过计算分段常数平台的数量来分析其结构。\n\n首先，我们验证问题陈述。所有参数（$N=64$，$s=9$，$\\sigma=0.05$，$k=7$，$\\varepsilon=10^{-3}$）、定义（函数 $x^{\\star}$、$\\eta$；算子 $H$；目标函数 $J_{\\lambda}(x)$；平台定义）和测试用例（$\\lambda \\in \\{0, 0.05, 0.2, 1.0, 5.0\\}$）都已明确给出。该问题在反问题和凸优化这一成熟领域有其科学依据。该公式是一个标准公式，已知是适定的（well-posed），对于任何 $\\lambda \\ge 0$ 都有唯一解。其语言客观且数学上精确。因此，该问题被视为 **有效**。\n\n需要最小化的目标函数是：\n$$\nJ_{\\lambda}(x) = \\frac{1}{2}\\|H x - y\\|_2^2 + \\lambda \\sum_{i=0}^{N-2} |x_{i+1} - x_i|\n$$\n该函数是两个凸项之和：一个光滑的数据保真项 $f(x) = \\frac{1}{2}\\|H x - y\\|_2^2$ 和一个非光滑的正则化项 $g(x) = \\lambda \\sum_{i=0}^{N-2} |x_{i+1} - x_i|$。这种结构非常适合凸复合优化算法。我们将使用交替方向乘子法（ADMM），它非常适合此类问题。\n\n为应用 ADMM，我们引入一个辅助变量 $z \\in \\mathbb{R}^{N-1}$ 和一个有限差分算子 $D \\in \\mathbb{R}^{(N-1) \\times N}$，其中 $(Dx)_i = x_{i+1} - x_i$。该优化问题被重构为：\n$$\n\\min_{x, z} \\; \\frac{1}{2}\\|H x - y\\|_2^2 + \\lambda \\|z\\|_1 \\quad \\text{subject to} \\quad Dx = z\n$$\n这个约束问题的增广拉格朗日函数是：\n$$\nL_{\\rho}(x, z, u) = \\frac{1}{2}\\|H x - y\\|_2^2 + \\lambda \\|z\\|_1 + \\frac{\\rho}{2}\\|Dx - z + u\\|_2^2 - \\frac{\\rho}{2}\\|u\\|_2^2\n$$\n其中 $\\rho  0$ 是一个惩罚参数，$u \\in \\mathbb{R}^{N-1}$ 是缩放的对偶变量。ADMM 通过交替最小化关于 $x$ 和 $z$ 的 $L_{\\rho}$，然后更新 $u$ 来进行迭代。对于迭代次数 $k=0, 1, 2, \\dots$，步骤如下：\n\n1.  **$x$-更新**：我们通过最小化关于 $x$ 的 $L_{\\rho}(x, z^k, u^k)$ 来求解 $x^{k+1}$：\n    $$\n    x^{k+1} = \\arg\\min_x \\left( \\frac{1}{2}\\|Hx - y\\|_2^2 + \\frac{\\rho}{2}\\|Dx - z^k + u^k\\|_2^2 \\right)\n    $$\n    这是一个二次优化问题，通过将梯度设为零来找到最小值：\n    $$\n    H^{\\top}(Hx^{k+1} - y) + \\rho D^{\\top}(Dx^{k+1} - z^k + u^k) = 0\n    $$\n    利用给定的 $H$ 是正交的性质（$H^{\\top}H = I$，其中 $I$ 是单位矩阵），我们得到线性系统：\n    $$\n    (I + \\rho D^{\\top}D) x^{k+1} = H^{\\top}y + \\rho D^{\\top}(z^k - u^k)\n    $$\n    矩阵 $(I + \\rho D^{\\top}D)$ 是对称、正定且三对角的，因为 $D$ 是一阶差分算子。这个系统可以在每次迭代中使用带状线性求解器高效地求解。\n\n2.  **$z$-更新**：我们通过最小化关于 $z$ 的 $L_{\\rho}(x^{k+1}, z, u^k)$ 来求解 $z^{k+1}$：\n    $$\n    z^{k+1} = \\arg\\min_z \\left( \\lambda \\|z\\|_1 + \\frac{\\rho}{2}\\|z - (Dx^{k+1} + u^k)\\|_2^2 \\right)\n    $$\n    这是 $\\ell_1$-范数的近端算子（proximal operator），其闭式解由分量的软阈值函数 $S_{\\alpha}(\\cdot)$ 给出：\n    $$\n    z_i^{k+1} = S_{\\lambda/\\rho}\\left((Dx^{k+1} + u^k)_i\\right) = \\text{sign}\\left((Dx^{k+1} + u^k)_i\\right) \\max\\left(\\left|(Dx^{k+1} + u^k)_i\\right| - \\frac{\\lambda}{\\rho}, 0\\right)\n    $$\n\n3.  **$u$-更新**：更新对偶变量以强制执行约束 $Dx=z$：\n    $$\n    u^{k+1} = u^k + Dx^{k+1} - z^{k+1}\n    $$\n重复这些迭代，直到满足收敛准则或达到足够大的步数。\n\n对于 $\\lambda = 0$ 的特殊情况，问题简化为一个无正则化的最小二乘问题：\n$$\n\\min_x J_0(x) = \\frac{1}{2}\\|H x - y\\|_2^2\n$$\n将梯度 $\\nabla J_0(x) = H^{\\top}(Hx - y)$ 设为零，并使用 $H^{\\top}H=I$，得到显式解 $x_0^{\\star} = H^{\\top}y$。由于 $H$ 是周期性右移 $s$ 个单位，其转置 $H^{\\top}$ 是周期性左移 $s$ 个单位。\n\n最后，为了量化阶梯效应，我们计算优化后信号 $x_{\\lambda}^{\\star}$ 中的平台数量。平台被定义为信号中的一个最大连续块，其中相邻值是“接近的”，即 $|x_{i+1} - x_i| \\le \\varepsilon$。一种等效的计数方法是识别所有发生“跳跃”的位置 $i$，即 $|x_{i+1} - x_i|  \\varepsilon$。平台的数量就是跳跃次数加一。该算法是计算 $x_{\\lambda}^{\\star}$ 相邻元素之间的绝对差，统计有多少个差值超过容差 $\\varepsilon$，然后将该计数加 1。",
            "answer": "[25,12,5,1,1]"
        }
    ]
}