{
    "hands_on_practices": [
        {
            "introduction": "许多边界约束优化算法的基石是投影算子，它通过在约束集中寻找最近点来强制实现可行性。本练习提供了一个具体的数值计算，要求将一个向量欧几里得投影到一个长方体（box）上，这是一个可分离且计算高效的操作。通过这个例子，您将亲手熟悉这一基本工具，并验证其定义的变分不等式性质 。",
            "id": "3369454",
            "problem": "设给定 $y \\in \\mathbb{R}^{6}$ 为 $y = (3.7,\\,-5.2,\\,-3.0,\\,9.1,\\,-2.3,\\,14.8)^{\\top}$。考虑将 $y$ 投影到盒子 $[l,u] := \\{x \\in \\mathbb{R}^{6} : l \\le x \\le u\\}$ 上的带边界约束的最小二乘投影，其中边界由分量形式指定为\n$l = (0,\\,-\\infty,\\,-1,\\,4,\\,-\\infty,\\,10)^{\\top}$ 和 $u = (2,\\,0,\\,\\infty,\\,\\infty,\\,1,\\,12)^{\\top}$。这里 $-\\infty$ 和 $\\infty$ 分别表示不存在下界或上界。\n\n欧几里得投影 $P_{[l,u]}(y)$ 定义为严格凸问题\n$\\min\\{ \\tfrac{1}{2}\\|x - y\\|_{2}^{2} : l \\le x \\le u \\}$ 的唯一极小值点。\n\n任务：\n1. 计算 $P_{[l,u]}(y)$。\n2. 从投影是上述问题的唯一极小值点的定义出发，并仅使用凸性的基本性质和一阶最优性条件，验证变分不等式刻画成立：对所有 $z \\in [l,u]$，\n$\\langle y - P_{[l,u]}(y),\\, z - P_{[l,u]}(y) \\rangle \\le 0$。\n3. 报告欧几里得距离平方 $\\|y - P_{[l,u]}(y)\\|_{2}^{2}$ 的精确值。\n\n请将任务3的最终数值答案以精确值（不四舍五入）的形式提供。",
            "solution": "首先根据指定标准对用户提供的问题进行验证。\n\n### 步骤 1：提取已知条件\n- 给定向量 $y \\in \\mathbb{R}^{6}$ 为 $y = (3.7,\\,-5.2,\\,-3.0,\\,9.1,\\,-2.3,\\,14.8)^{\\top}$。\n- 可行集是一个盒子 $[l,u] := \\{x \\in \\mathbb{R}^{6} : l \\le x \\le u\\}$。\n- 下界为 $l = (0,\\,-\\infty,\\,-1,\\,4,\\,-\\infty,\\,10)^{\\top}$。\n- 上界为 $u = (2,\\,0,\\,\\infty,\\,\\infty,\\,1,\\,12)^{\\top}$。\n- 欧几里得投影 $P_{[l,u]}(y)$ 定义为问题 $\\min\\{ \\tfrac{1}{2}\\|x - y\\|_{2}^{2} : l \\le x \\le u \\}$ 的唯一极小值点。\n- 需要验证的变分不等式是 $\\langle y - P_{[l,u]}(y),\\, z - P_{[l,u]}(y) \\rangle \\le 0$，对所有 $z \\in [l,u]$ 成立。\n- 最后的任务是报告 $\\|y - P_{[l,u]}(y)\\|_{2}^{2}$ 的精确值。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题是凸优化中的一个标准练习，具体涉及到一个凸集（一个盒子）上的投影。所有概念都植根于分析和优化中公认的数学原理。该问题是科学合理的。\n2.  **适定性：** 目标函数 $f(x) = \\frac{1}{2}\\|x - y\\|_{2}^{2}$ 是严格凸且连续的。可行集 $[l,u]$ 是一个闭合的凸集（一个超矩形）。一个连续的严格凸函数在一个非空的闭凸集上会达到唯一的最小值。该问题是适定的。\n3.  **客观性：** 问题使用精确的数学语言和定义进行陈述。没有主观或基于观点的陈述。\n4.  **完整性和一致性：** 提供了所有必要的数据（$y$，$l$，$u$）和定义。设置中没有矛盾之处。\n该问题被认为是**有效的**。\n\n### 解答\n问题要求完成三个任务。设 $x^* = P_{[l,u]}(y)$。\n\n**任务1：计算 $P_{[l,u]}(y)$**\n\n需要最小化的目标函数是 $L(x) = \\frac{1}{2} \\|x - y\\|_{2}^{2} = \\frac{1}{2} \\sum_{i=1}^{6} (x_i - y_i)^2$。约束条件是对于每个分量 $i=1, \\dots, 6$，都有 $l_i \\le x_i \\le u_i$。由于目标函数和约束都是可分的，这个6维优化问题可以分解为6个独立的1维问题：\n$$\n\\min_{x_i} \\frac{1}{2} (x_i - y_i)^2 \\quad \\text{subject to} \\quad l_i \\le x_i \\le u_i\n$$\n对于每个 $i \\in \\{1, 2, 3, 4, 5, 6\\}$。\n\n每个一维问题的解是标量 $y_i$ 在区间 $[l_i, u_i]$ 上的投影。这由以下公式给出：\n$$\nx_i^* = \\max(l_i, \\min(u_i, y_i))\n$$\n\n我们将此公式应用于每个分量：\n- 对 $i=1$：$y_1=3.7$，$[l_1, u_1] = [0, 2]$。\n  $x_1^* = \\max(0, \\min(2, 3.7)) = \\max(0, 2) = 2$。\n- 对 $i=2$：$y_2=-5.2$，$[l_2, u_2] = [-\\infty, 0]$。\n  $x_2^* = \\max(-\\infty, \\min(0, -5.2)) = \\min(0, -5.2) = -5.2$。\n- 对 $i=3$：$y_3=-3.0$，$[l_3, u_3] = [-1, \\infty]$。\n  $x_3^* = \\max(-1, \\min(\\infty, -3.0)) = \\max(-1, -3.0) = -1$。\n- 对 $i=4$：$y_4=9.1$，$[l_4, u_4] = [4, \\infty]$。\n  $x_4^* = \\max(4, \\min(\\infty, 9.1)) = \\max(4, 9.1) = 9.1$。\n- 对 $i=5$：$y_5=-2.3$，$[l_5, u_5] = [-\\infty, 1]$。\n  $x_5^* = \\max(-\\infty, \\min(1, -2.3)) = \\min(1, -2.3) = -2.3$。\n- 对 $i=6$：$y_6=14.8$，$[l_6, u_6] = [10, 12]$。\n  $x_6^* = \\max(10, \\min(12, 14.8)) = \\max(10, 12) = 12$。\n\n结合这些分量，投影为：\n$$\nx^* = P_{[l,u]}(y) = (2, -5.2, -1, 9.1, -2.3, 12)^{\\top}\n$$\n\n**任务2：验证变分不等式**\n\n问题是在一个凸集 $C = [l,u]$ 上最小化一个可微凸函数 $f(x) = \\frac{1}{2}\\|x-y\\|_2^2$。凸分析中的一个基本结果指出，一个点 $x^* \\in C$ 是 $f$ 在 $C$ 上的极小值点，当且仅当它满足一阶最优性条件：\n$$\n\\langle \\nabla f(x^*), z - x^* \\rangle \\ge 0, \\quad \\forall z \\in C\n$$\n$f(x)$ 的梯度是 $\\nabla f(x) = x - y$。将其代入最优性条件，我们得到：\n$$\n\\langle x^* - y, z - x^* \\rangle \\ge 0, \\quad \\forall z \\in C\n$$\n将内积乘以 $-1$ 会反转不等式：\n$$\n\\langle -(x^* - y), z - x^* \\rangle \\le 0\n$$\n$$\n\\langle y - x^*, z - x^* \\rangle \\le 0, \\quad \\forall z \\in C\n$$\n这正是投影的变分不等式刻画。这个从一阶原理出发的推导验证了该刻画对于任何到凸集上的投影都成立。\n\n我们也可以对投影到盒子的具体情况进行分量验证。不等式为 $\\sum_{i=1}^{6} (y_i - x_i^*)(z_i - x_i^*) \\le 0$。我们证明和中的每一项都是非正的。对于任意 $i$，考虑项 $(y_i - x_i^*)(z_i - x_i^*)$，其中 $z_i \\in [l_i, u_i]$。\n- 情况1：$l_i  y_i  u_i$。点 $y_i$ 在区间的内部。投影是 $x_i^* = y_i$。该项为 $(y_i - y_i)(z_i - y_i) = 0$。\n- 情况2：$y_i \\le l_i$。投影是 $x_i^* = l_i$。因子 $y_i - x_i^* = y_i - l_i \\le 0$。对于任意 $z_i \\in [l_i, u_i]$，我们有 $z_i \\ge l_i$，所以因子 $z_i - x_i^* = z_i - l_i \\ge 0$。乘积为非正。\n- 情况3：$y_i \\ge u_i$。投影是 $x_i^* = u_i$。因子 $y_i - x_i^* = y_i - u_i \\ge 0$。对于任意 $z_i \\in [l_i, u_i]$，我们有 $z_i \\le u_i$，所以因子 $z_i - x_i^* = z_i - u_i \\le 0$。乘积为非正。\n在所有情况下，$(y_i - x_i^*)(z_i - x_i^*) \\le 0$。对所有 $i$ 求和证实了变分不等式。\n\n**任务3：报告欧几里得距离的平方**\n\n我们需要计算 $\\|y - x^*\\|_{2}^{2}$。首先，我们计算差分向量 $d = y - x^*$：\n$d = (3.7 - 2, -5.2 - (-5.2), -3.0 - (-1), 9.1 - 9.1, -2.3 - (-2.3), 14.8 - 12)^{\\top}$\n$d = (1.7, 0, -2.0, 0, 0, 2.8)^{\\top}$\n\n欧几里得距离的平方是 $d$ 各分量平方的和：\n$$\n\\|y - x^*\\|_{2}^{2} = d_1^2 + d_2^2 + d_3^2 + d_4^2 + d_5^2 + d_6^2\n$$\n$$\n\\|y - x^*\\|_{2}^{2} = (1.7)^2 + (0)^2 + (-2.0)^2 + (0)^2 + (0)^2 + (2.8)^2\n$$\n我们计算各个平方项：\n- $(1.7)^2 = 2.89$\n- $(0)^2 = 0$\n- $(-2.0)^2 = 4.0$\n- $(2.8)^2 = 7.84$\n\n将这些值相加：\n$$\n\\|y - x^*\\|_{2}^{2} = 2.89 + 0 + 4.0 + 0 + 0 + 7.84 = 14.73\n$$\n欧几里得距离平方的精确值是 $14.73$。",
            "answer": "$$\n\\boxed{14.73}\n$$"
        },
        {
            "introduction": "在应用复杂算法之前，理解约束条件的影响至关重要。本练习利用 Karush-Kuhn-Tucker (KKT) 条件，探讨了无约束与有约束最小二乘解之间的关系，以确定约束在解处何时是非激活的。您还将推导并计算“残差膨胀”，该值量化了施加边界约束在目标函数上所付出的代价 。",
            "id": "3369377",
            "problem": "考虑带边界约束的线性最小二乘问题：在简单边界约束下，最小化欧几里得残差的平方范数，\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ \\|A x - b\\|_{2}^{2} \\quad \\text{subject to} \\quad l \\leq x \\leq u,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 是列满秩矩阵，$b \\in \\mathbb{R}^{m}$，且 $l,u \\in \\mathbb{R}^{n}$ 对所有 $i$ 满足 $l_{i}  u_{i}$。令 $x^{\\dagger}$ 表示唯一的无约束最小二乘极小值点，其定义为正规方程 $A^{\\top} A x = A^{\\top} b$ 的唯一解。假设 $A$ 是列满秩的，因此 $A^{\\top} A$ 是正定的，并且 Moore–Penrose 伪逆满足 $x^{\\dagger} = (A^{\\top} A)^{-1} A^{\\top} b$。\n\n任务：\n- 仅使用最小二乘的核心定义、无约束最小二乘的正规方程以及带边界约束的凸二次规划的 Karush–Kuhn–Tucker (KKT) 条件，建立关于 $(A,b,l,u)$ 的充要条件，使得无约束极小值点满足严格的逐分量不等式 $l  x^{\\dagger}  u$，并因此也是唯一的有约束极小值点。\n- 从 $b$ 在 $A$ 的列空间及其正交补中的分量的正交分解出发，并且不调用任何现成的投影公式，推导出“残差膨胀”\n$$\n\\|A x^{\\star} - b\\|_{2}^{2} - \\|A x^{\\dagger} - b\\|_{2}^{2}\n$$\n的精确表达式，其中 $x^{\\star}$ 是有约束极小值点，表达式需要用 $A$，$x^{\\dagger}$ 和 $x^{\\star}$ 来表示。\n\n然后，考虑以下具体实例：\n$$\nA \\,=\\, \\begin{pmatrix} 1  0 \\\\[4pt] 0  1 \\\\[4pt] 0  0 \\end{pmatrix}, \\quad\nb \\,=\\, \\begin{pmatrix} 3 \\\\[4pt] -1 \\\\[4pt] 4 \\end{pmatrix}, \\quad\nl \\,=\\, \\begin{pmatrix} 0 \\\\[4pt] -2 \\end{pmatrix}, \\quad\nu \\,=\\, \\begin{pmatrix} 2 \\\\[4pt] 0 \\end{pmatrix}.\n$$\n计算该实例的残差膨胀 $\\|A x^{\\star} - b\\|_{2}^{2} - \\|A x^{\\dagger} - b\\|_{2}^{2}$。将最终答案表示为一个精确的实数，无需四舍五入。",
            "solution": "首先验证该问题，以确保其是适定的、有科学依据的，并包含足够的信息以得到唯一解。该问题是一个标准的带边界约束的二次规划问题。目标函数 $f(x) = \\|Ax - b\\|_{2}^{2}$ 是严格凸的，因为矩阵 $A$ 是列满秩的，这意味着 $A^{\\top}A$ 是正定的。由超矩形 $l \\leq x \\leq u$ 定义的可行域是一个非空、闭合的凸集。一个定义在非空、闭合、凸集上的严格凸函数有唯一的极小值。因此，该问题是适定的，并且存在唯一的有约束极小值点 $x^{\\star}$。所提供的具体实例的数据在维度上是一致的 ($m=3, n=2$)。该问题是有效的。\n\n### 第1部分：无约束极小值点成为有约束极小值点的条件\n\n该优化问题为：\n$$ \\min_{x \\in \\mathbb{R}^{n}} f(x) = \\|Ax - b\\|_{2}^{2} \\quad \\text{subject to} \\quad l \\leq x \\leq u $$\n通过展开目标函数，可以将其写成一个二次规划：\n$$ f(x) = x^{\\top}A^{\\top}Ax - 2b^{\\top}Ax + b^{\\top}b $$\n目标函数的梯度为 $\\nabla f(x) = 2A^{\\top}Ax - 2A^{\\top}b$。无约束极小值点 $x^{\\dagger}$ 是通过将梯度设为零得到的，这就产生了正规方程 $A^{\\top}A x^{\\dagger} = A^{\\top}b$。根据定义，$\\nabla f(x^{\\dagger}) = 0$。\n\n约束条件可以写成 $g_i(x) = l_i - x_i \\leq 0$ 和 $h_i(x) = x_i - u_i \\leq 0$，其中 $i=1, \\dots, n$。一个点 $x^{\\star}$ 成为极小值点的 Karush-Kuhn-Tucker (KKT) 条件是：\n1.  **平稳性 (Stationarity)：** $\\nabla f(x^{\\star}) - \\mu^{\\star} + \\lambda^{\\star} = 0$，其中 $\\mu^{\\star}, \\lambda^{\\star} \\in \\mathbb{R}^{n}$ 是拉格朗日乘子向量。\n2.  **原始可行性 (Primal Feasibility)：** $l \\leq x^{\\star} \\leq u$。\n3.  **对偶可行性 (Dual Feasibility)：** 对所有 $i$，$\\mu_i^{\\star} \\geq 0$ 且 $\\lambda_i^{\\star} \\geq 0$。\n4.  **互补松弛性 (Complementary Slackness)：** 对所有 $i$，$\\mu_i^{\\star}(l_i - x_i^{\\star}) = 0$ 且 $\\lambda_i^{\\star}(x_i^{\\star} - u_i) = 0$。\n\n我们想找到使得无约束极小值点 $x^{\\dagger}$ 同时也是唯一的有约束极小值点，并满足严格不等式 $l  x^{\\dagger}  u$ 的条件。让我们假设 $x^{\\star} = x^{\\dagger}$ 并且 $l  x^{\\dagger}  u$。\n\n根据原始可行性条件，$l \\leq x^{\\dagger} \\leq u$ 在我们的假设下是满足的。\n\n根据平稳性条件，使用 $\\nabla f(x^{\\dagger})=0$，我们有：\n$$ 0 - \\mu^{\\star} + \\lambda^{\\star} = 0 \\implies \\mu^{\\star} = \\lambda^{\\star} $$\n下界和上界的拉格朗日乘子必须逐分量相等。\n\n根据互补松弛性条件，对于每个分量 $i$：\n由于 $l_i  x^{\\dagger}_i  u_i$，我们有 $l_i - x^{\\dagger}_i  0$ 和 $x^{\\dagger}_i - u_i  0$。\n条件 $\\mu_i^{\\star}(l_i - x^{\\dagger}_i) = 0$ 和 $\\lambda_i^{\\star}(x^{\\dagger}_i - u_i) = 0$ 意味着对所有 $i=1, \\dots, n$，都有 $\\mu_i^{\\star}=0$ 和 $\\lambda_i^{\\star}=0$。因此，$\\mu^{\\star} = 0$ 和 $\\lambda^{\\star} = 0$。\n\n这种乘子的选择满足了平稳性条件 ($\\mu^{\\star}=\\lambda^{\\star}$) 和对偶可行性条件 ($\\mu^{\\star} \\geq 0, \\lambda^{\\star} \\geq 0$)。由于所有 KKT 条件都得到满足，并且问题是严格凸的，因此 $x^{\\dagger}$ 确实是唯一的有约束极小值点。\n\n因此，我们所做的假设 $l  x^{\\dagger}  u$ 本身就是条件。无约束极小值点是唯一的有约束极小值点并满足严格不等式的充要条件是它严格位于可行盒内部。用问题数据 $(A, b, l, u)$ 表示，该条件是：\n$$ l  (A^{\\top}A)^{-1}A^{\\top}b  u \\quad (\\text{逐分量}) $$\n\n### 第2部分：残差膨胀的推导\n\n我们想要推导 $\\|A x^{\\star} - b\\|_{2}^{2} - \\|A x^{\\dagger} - b\\|_{2}^{2}$ 的表达式。\n向量 $b$ 可以分解为 $A$ 的列空间 $\\mathcal{R}(A)$ 中的一个分量，以及其正交补 $\\mathcal{R}(A)^{\\perp}$ 中的一个分量。到 $\\mathcal{R}(A)$ 上的正交投影算子是 $P_A = A(A^{\\top}A)^{-1}A^{\\top}$。\n$b$ 在 $\\mathcal{R}(A)$ 中的分量是 $P_A b = A(A^{\\top}A)^{-1}A^{\\top}b = A x^{\\dagger}$。\n$b$ 在 $\\mathcal{R}(A)^{\\perp}$ 中的分量是 $(I-P_A)b = b - Ax^{\\dagger} = -(Ax^{\\dagger} - b)$。\n向量 $Ax^{\\dagger}-b$ 是无约束问题的残差。\n\n我们来分析任意向量 $x$ 的残差：$Ax - b$。我们可以通过加上和减去 $Ax^{\\dagger}$ 来重写它：\n$$ Ax - b = (Ax - Ax^{\\dagger}) + (Ax^{\\dagger} - b) = A(x-x^{\\dagger}) + (Ax^{\\dagger} - b) $$\n项 $A(x-x^{\\dagger})$ 在 $\\mathcal{R}(A)$ 中，因为它是 $A$ 的列的线性组合。项 $(Ax^{\\dagger} - b)$ 在 $\\mathcal{R}(A)^{\\perp}$ 中。\n根据勾股定理，对于任意两个正交向量 $v_1, v_2$，有 $\\|v_1+v_2\\|^2 = \\|v_1\\|^2 + \\|v_2\\|^2$。将其应用于此：\n$$ \\|Ax - b\\|_{2}^{2} = \\|A(x-x^{\\dagger})\\|_{2}^{2} + \\|Ax^{\\dagger} - b\\|_{2}^{2} $$\n这个恒等式对任意 $x \\in \\mathbb{R}^n$ 都成立。特别地，它对有约束极小值点 $x^{\\star}$ 也成立：\n$$ \\|A x^{\\star} - b\\|_{2}^{2} = \\|A(x^{\\star}-x^{\\dagger})\\|_{2}^{2} + \\|A x^{\\dagger} - b\\|_{2}^{2} $$\n重新整理此方程，即可得到所需的残差膨胀表达式：\n$$ \\|A x^{\\star} - b\\|_{2}^{2} - \\|A x^{\\dagger} - b\\|_{2}^{2} = \\|A(x^{\\star} - x^{\\dagger})\\|_{2}^{2} $$\n\n### 第3部分：具体实例的计算\n\n给定：\n$$ A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix}, \\quad l = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix}, \\quad u = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} $$\n\n**第1步：计算无约束极小值点 $x^{\\dagger}$。**\n我们首先计算 $A^{\\top}A$ 和 $A^{\\top}b$：\n$$ A^{\\top}A = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2 $$\n$$ A^{\\top}b = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix} $$\n正规方程为 $I_2 x = \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}$，由此得到无约束解：\n$$ x^{\\dagger} = \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix} $$\n\n**第2步：计算有约束极小值点 $x^{\\star}$。**\n需要最小化的目标函数是：\n$$ \\|Ax - b\\|_{2}^{2} = \\left\\| \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ -1 \\\\ 4 \\end{pmatrix} \\right\\|_{2}^{2} = \\left\\| \\begin{pmatrix} x_1 - 3 \\\\ x_2 + 1 \\\\ -4 \\end{pmatrix} \\right\\|_{2}^{2} = (x_1 - 3)^{2} + (x_2 + 1)^{2} + 16 $$\n约束条件为 $0 \\leq x_1 \\leq 2$ 和 $-2 \\leq x_2 \\leq 0$。该问题是可分离的，意味着我们可以分别对 $x_1$ 和 $x_2$ 进行最小化。\n- 对于 $x_1$：在 $0 \\leq x_1 \\leq 2$ 的约束下最小化 $g_1(x_1) = (x_1 - 3)^{2}$。无约束极小值点是 $x_1 = 3$，它在区间 $[0, 2]$ 之外。函数 $g_1(x_1)$ 在 $[0, 2]$ 上是递减的。因此，最小值在右端点处取得，$x^{\\star}_1 = 2$。\n- 对于 $x_2$：在 $-2 \\leq x_2 \\leq 0$ 的约束下最小化 $g_2(x_2) = (x_2 + 1)^{2}$。无约束极小值点是 $x_2 = -1$，它位于区间 $[-2, 0]$ 内。因此，最小值在 $x^{\\star}_2 = -1$ 处取得。\n\n有约束极小值点是：\n$$ x^{\\star} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} $$\n\n**第3步：计算残差膨胀。**\n使用推导出的公式，残差膨胀为 $\\|A(x^{\\star} - x^{\\dagger})\\|_{2}^{2}$。\n首先，求出差向量：\n$$ x^{\\star} - x^{\\dagger} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} $$\n接下来，乘以 $A$：\n$$ A(x^{\\star} - x^{\\dagger}) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n最后，计算欧几里得范数的平方：\n$$ \\|A(x^{\\star} - x^{\\dagger})\\|_{2}^{2} = (-1)^{2} + 0^{2} + 0^{2} = 1 $$\n残差膨胀为 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "本练习从分析转向实践，指导您完成一次完整的投影梯度法迭代，这是解决边界约束问题的核心算法之一。您需要将梯度计算与 Armijo 回溯线搜索相结合以找到合适的步长，然后应用投影算子确保下一次迭代保持可行。这个练习模拟了一个实用优化求解器的核心逻辑 。",
            "id": "3369390",
            "problem": "考虑一个线性数据同化设定，其状态向量为 $\\boldsymbol{x} \\in \\mathbb{R}^{3}$，线性观测算子为 $\\boldsymbol{A} \\in \\mathbb{R}^{3 \\times 3}$，其中观测值被建模为 $\\boldsymbol{y} \\approx \\boldsymbol{A}\\boldsymbol{x}$，观测数据为 $\\boldsymbol{b} \\in \\mathbb{R}^{3}$。我们寻求在边界约束下最小化最小二乘失配。目标函数为\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2}\\|\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}\\|^{2},\n$$\n可行集为方箱 $\\mathcal{B} = \\{\\boldsymbol{x} \\in \\mathbb{R}^{3} : \\boldsymbol{l} \\le \\boldsymbol{x} \\le \\boldsymbol{u}\\}$，其中不等式为分量式边界。\n\n严格从 $f(\\boldsymbol{x})$ 的定义以及线性映射和二次型复合的求导法则出发，推导梯度 $\\nabla f(\\boldsymbol{x})$。然后，使用带有 Armijo 回溯线搜索的投影梯度（PG）法，从当前状态 $\\boldsymbol{x}^{(0)}$ 执行一次迭代，数据如下：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix}, \\quad\n\\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix}, \\quad\n\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix},\n$$\n边界为\n$$\n\\boldsymbol{l} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}, \\quad\n\\boldsymbol{u} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}.\n$$\n对方箱 $\\mathcal{B}$ 的投影 $P_{[\\boldsymbol{l},\\boldsymbol{u}]}(\\boldsymbol{z}) = \\min(\\max(\\boldsymbol{z}, \\boldsymbol{l}), \\boldsymbol{u})$ 按分量定义，其中最小值和最大值是按分量计算的。使用初始步长 $\\alpha_{0} = 1$，回溯因子 $\\gamma = \\frac{1}{2}$，以及 Armijo 常数 $\\sigma = \\frac{1}{10}$。在当前迭代点 $\\boldsymbol{x}$，梯度为 $\\boldsymbol{g} = \\nabla f(\\boldsymbol{x})$，定义步长为 $\\alpha$ 的试验点为\n$$\n\\boldsymbol{y}(\\alpha) = P_{[\\boldsymbol{l},\\boldsymbol{u}]}\\big(\\boldsymbol{x} - \\alpha \\boldsymbol{g}\\big).\n$$\n如果 Armijo 条件\n$$\nf\\big(\\boldsymbol{y}(\\alpha)\\big) \\le f(\\boldsymbol{x}) + \\sigma\\, \\nabla f(\\boldsymbol{x})^{\\top}\\big(\\boldsymbol{y}(\\alpha) - \\boldsymbol{x}\\big)\n$$\n满足，则接受步长 $\\alpha$；否则，令 $\\alpha \\leftarrow \\gamma \\alpha$ 并重复，直至条件被接受。从 $\\boldsymbol{x}^{(0)}$ 开始，使用上述数值执行此过程一次迭代，并将得到的下一个迭代点 $\\boldsymbol{x}^{(1)} = \\boldsymbol{y}(\\alpha)$ 作为您的最终答案。无需四舍五入。将最终答案表示为行向量。",
            "solution": "该问题要求对一个有界约束的最小二乘问题执行一次投影梯度（PG）法的迭代。该过程首先包括推导目标函数的梯度，然后应用带有 Armijo 回溯线搜索的 PG 算法。\n\n首先，我们推导目标函数 $f(\\boldsymbol{x}) = \\frac{1}{2}\\|\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}\\|^{2}$ 的梯度。\n平方欧几里得范数可以写成内积形式：\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2} (\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b})^{\\top}(\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b})\n$$\n展开此表达式得到：\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2} \\left( (\\boldsymbol{A}\\boldsymbol{x})^{\\top} - \\boldsymbol{b}^{\\top} \\right) (\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}) = \\frac{1}{2} \\left( \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{b} - \\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x} + \\boldsymbol{b}^{\\top}\\boldsymbol{b} \\right)\n$$\n由于 $\\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x}$ 是一个标量，它等于其自身的转置，即 $(\\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x})^{\\top} = \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{b}$。因此，表达式简化为：\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2} \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x} + \\frac{1}{2} \\boldsymbol{b}^{\\top}\\boldsymbol{b}\n$$\n为了求梯度 $\\nabla f(\\boldsymbol{x})$，我们对 $\\boldsymbol{x}$ 求导。使用向量微积分的法则，特别是 $\\nabla_{\\boldsymbol{x}}(\\boldsymbol{x}^{\\top}\\boldsymbol{Q}\\boldsymbol{x}) = (\\boldsymbol{Q} + \\boldsymbol{Q}^{\\top})\\boldsymbol{x}$ 和 $\\nabla_{\\boldsymbol{x}}(\\boldsymbol{c}^{\\top}\\boldsymbol{x}) = \\boldsymbol{c}$，我们得到：\n$$\n\\nabla f(\\boldsymbol{x}) = \\frac{1}{2} (\\boldsymbol{A}^{\\top}\\boldsymbol{A} + (\\boldsymbol{A}^{\\top}\\boldsymbol{A})^{\\top})\\boldsymbol{x} - (\\boldsymbol{b}^{\\top}\\boldsymbol{A})^{\\top}\n$$\n矩阵 $\\boldsymbol{A}^{\\top}\\boldsymbol{A}$ 是对称的，所以 $(\\boldsymbol{A}^{\\top}\\boldsymbol{A})^{\\top} = \\boldsymbol{A}^{\\top}\\boldsymbol{A}$。同时，$(\\boldsymbol{b}^{\\top}\\boldsymbol{A})^{\\top} = \\boldsymbol{A}^{\\top}\\boldsymbol{b}$。因此，梯度为：\n$$\n\\nabla f(\\boldsymbol{x}) = \\frac{1}{2} (2\\boldsymbol{A}^{\\top}\\boldsymbol{A})\\boldsymbol{x} - \\boldsymbol{A}^{\\top}\\boldsymbol{b} = \\boldsymbol{A}^{\\top}\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{A}^{\\top}\\boldsymbol{b} = \\boldsymbol{A}^{\\top}(\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b})\n$$\n这就是所要求的梯度表达式。\n\n现在，我们从 $\\boldsymbol{x}^{(0)}$ 开始执行一次 PG 方法的迭代。\n当前迭代点是 $\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix}$。矩阵和向量如下：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix}, \\quad \\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix}, \\quad \\boldsymbol{l} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}, \\quad \\boldsymbol{u} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n首先，我们计算梯度 $\\boldsymbol{g}^{(0)} = \\nabla f(\\boldsymbol{x}^{(0)})$。\n残差为 $\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b}$：\n$$\n\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1.6 \\\\ -0.5 \\\\ 5.4 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0.6 \\\\ 0.5 \\\\ 2.4 \\end{pmatrix}\n$$\n矩阵 $\\boldsymbol{A}$ 是对角矩阵，因此是对称的，所以 $\\boldsymbol{A}^{\\top} = \\boldsymbol{A}$。\n$$\n\\boldsymbol{g}^{(0)} = \\boldsymbol{A}^{\\top}(\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b}) = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0.6 \\\\ 0.5 \\\\ 2.4 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 0.5 \\\\ 7.2 \\end{pmatrix}\n$$\n接下来，我们从 $\\alpha_0 = 1$ 开始执行 Armijo 回溯线搜索。试验点是 $\\boldsymbol{y}(\\alpha) = P_{[\\boldsymbol{l},\\boldsymbol{u}]}(\\boldsymbol{x}^{(0)} - \\alpha \\boldsymbol{g}^{(0)})$。我们必须检查当 $\\alpha = 1$ 时 Armijo 条件是否满足：\n$$\nf\\big(\\boldsymbol{y}(1)\\big) \\le f(\\boldsymbol{x}^{(0)}) + \\sigma\\, (\\boldsymbol{g}^{(0)})^{\\top}\\big(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)}\\big)\n$$\n让我们为 $\\alpha = 1$ 计算每一项。首先，试验点 $\\boldsymbol{y}(1)$：\n未投影的点是 $\\boldsymbol{x}^{(0)} - 1 \\cdot \\boldsymbol{g}^{(0)}$：\n$$\n\\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix} - \\begin{pmatrix} 1.2 \\\\ 0.5 \\\\ 7.2 \\end{pmatrix} = \\begin{pmatrix} -0.4 \\\\ -1.0 \\\\ -5.4 \\end{pmatrix}\n$$\n将此点投影到由 $\\boldsymbol{l}$ 和 $\\boldsymbol{u}$ 定义的方箱 $\\mathcal{B}$ 上：\n$$\n\\boldsymbol{y}(1) = P_{[\\boldsymbol{l},\\boldsymbol{u}]}\\left(\\begin{pmatrix} -0.4 \\\\ -1.0 \\\\ -5.4 \\end{pmatrix}\\right) = \\begin{pmatrix} \\min(\\max(-0.4, 0), 1) \\\\ \\min(\\max(-1.0, -1), 2) \\\\ \\min(\\max(-5.4, 0.5), 2) \\end{pmatrix} = \\begin{pmatrix} \\min(0, 1) \\\\ \\min(-1, 2) \\\\ \\min(0.5, 2) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}\n$$\n现在，我们计算 Armijo 不等式的两边。\n对于左侧（LHS），我们计算 $f(\\boldsymbol{y}(1))$：\n$$\n\\boldsymbol{A}\\boldsymbol{y}(1) - \\boldsymbol{b} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ -1.5 \\end{pmatrix}\n$$\n$$\nf(\\boldsymbol{y}(1)) = \\frac{1}{2}\\left\\| \\begin{pmatrix} -1 \\\\ 0 \\\\ -1.5 \\end{pmatrix} \\right\\|^2 = \\frac{1}{2}((-1)^2 + 0^2 + (-1.5)^2) = \\frac{1}{2}(1 + 2.25) = \\frac{1}{2}(3.25) = 1.625\n$$\n对于右侧（RHS），我们首先需要 $f(\\boldsymbol{x}^{(0)})$ 和方向导数项。\n$$\nf(\\boldsymbol{x}^{(0)}) = \\frac{1}{2}\\|\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b}\\|^2 = \\frac{1}{2}\\left\\| \\begin{pmatrix} 0.6 \\\\ 0.5 \\\\ 2.4 \\end{pmatrix} \\right\\|^2 = \\frac{1}{2}(0.6^2 + 0.5^2 + 2.4^2) = \\frac{1}{2}(0.36 + 0.25 + 5.76) = \\frac{1}{2}(6.37) = 3.185\n$$\n方向导数项是 $\\sigma\\, (\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)})$。向量差为：\n$$\n\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix} - \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix} = \\begin{pmatrix} -0.8 \\\\ -0.5 \\\\ -1.3 \\end{pmatrix}\n$$\n与梯度的点积为：\n$$\n(\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)}) = \\begin{pmatrix} 1.2  0.5  7.2 \\end{pmatrix} \\begin{pmatrix} -0.8 \\\\ -0.5 \\\\ -1.3 \\end{pmatrix} = (1.2)(-0.8) + (0.5)(-0.5) + (7.2)(-1.3) = -0.96 - 0.25 - 9.36 = -10.57\n$$\nArmijo 不等式的右侧是，其中 $\\sigma = \\frac{1}{10} = 0.1$：\n$$\nf(\\boldsymbol{x}^{(0)}) + \\sigma\\, (\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)}) = 3.185 + 0.1(-10.57) = 3.185 - 1.057 = 2.128\n$$\n现在我们检查条件：是否 $f(\\boldsymbol{y}(1)) \\le 2.128$？\n$$\n1.625 \\le 2.128\n$$\n不等式成立。因此，步长 $\\alpha=1$ 被接受。下一个迭代点是 $\\boldsymbol{x}^{(1)} = \\boldsymbol{y}(1)$。\n$$\n\\boldsymbol{x}^{(1)} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}\n$$\n问题要求将结果表示为行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -1  0.5 \\end{pmatrix}}\n$$"
        }
    ]
}