## 引言
卡茨马兹（Kaczmarz）方法及其推广形式——[代数重建技术](@entry_id:746352)（ART），是现代科学与工程计算中用于求解大规模线性方程组的基石性迭代算法。尤其在[计算机断层扫描](@entry_id:747638)（CT）等[逆问题](@entry_id:143129)领域，由于测量数据构成的[系统矩阵](@entry_id:172230)通常维度巨大、结构稀疏，使得传统直接求解方法（如矩阵求逆）变得不切实际，这些行处理（row-action）方法的重要性愈发凸显。本文旨在系统性地剖析这一强大工具，不仅阐明其数学原理，更揭示其在多学科[交叉](@entry_id:147634)应用中的广度和深度。本文旨在弥合理论与实践之间的鸿沟，为读者提供一个从基本机制到前沿应用的全面视角。

在接下来的内容中，您将踏上一段结构化的学习之旅。第一章“原理与机制”将深入其核心，从优雅的几何投影视角出发，探讨其收敛性质、与经典[优化算法](@entry_id:147840)的关联，并重点分析在实际应用中必不可少的正则化策略。第二章“应用与跨学科联系”将视野扩展至现实世界，展示该方法如何在层析成像、信号处理乃至机器学习等领域解决具体问题，并如何与其他理论（如贝叶斯推断、[凸优化](@entry_id:137441)）融合。最后，在“动手实践”部分，您将通过具体的计算和编程练习，将理论知识转化为解决问题的实践能力，从而真正掌握这一方法的精髓。

## 原理与机制

在上一章引言中，我们介绍了[代数重建技术](@entry_id:746352)（Algebraic Reconstruction Technique, ART）及其在[层析成像](@entry_id:756051)等[逆问题](@entry_id:143129)领域的重要性。本章将深入探讨这些方法的核心原理与工作机制。我们将从其几何基础出发，逐步分析其收敛性、与经典[优化方法](@entry_id:164468)的关系、正则化策略，并最终考察其在[非线性](@entry_id:637147)问题和特定应用中的扩展。

### 几何基础：[超平面](@entry_id:268044)上的投影

[线性逆问题](@entry_id:751313)的核心是求解一个[线性方程组](@entry_id:148943) $A x = b$，其中 $A \in \mathbb{R}^{m \times n}$ 是系统矩阵，$x \in \mathbb{R}^{n}$ 是待求的未知参数向量（例如图像的像素值），$b \in \mathbb{R}^{m}$ 是观测数据向量。从几何角度看，这个[方程组](@entry_id:193238)的每一个独立方程 $a_i^\top x = b_i$（其中 $a_i^\top$ 是矩阵 $A$ 的第 $i$ 行）在 $n$ 维空间 $\mathbb{R}^n$ 中定义了一个**超平面** $H_i$。因此，[求解方程组](@entry_id:152624) $A x = b$ 等价于寻找所有这些超平面的交点，即 $x \in \bigcap_{i=1}^m H_i$。

当 $m$ 和 $n$ 非常大时，直接求解（例如通过[矩阵求逆](@entry_id:636005)）往往是不可行的。**[Kaczmarz方法](@entry_id:195677)**，作为[代数重建技术](@entry_id:746352)的基础，提供了一种优雅的迭代求解策略。其核心思想并非一次性处理所有方程，而是采用所谓的**行处理（row-action）**方法：从一个初始猜测 $x_0$ 开始，算法在每次迭代中只选择一个方程（比如第 $i$ 个方程），然后将当前的解估计 $x_k$ **[正交投影](@entry_id:144168)**到该方程对应的[超平面](@entry_id:268044) $H_i$ 上，从而得到新的解估计 $x_{k+1}$。通过循环或随机地选择不同的[超平面](@entry_id:268044)进行投影，迭代序列 $x_k$ 将逐步逼近最终的解。

具体而言，从点 $x_k$ 到超平面 $H_i = \{ x \in \mathbb{R}^n : a_i^\top x = b_i \}$ 的正交投影 $x_{k+1}$，可以通过将 $x_k$ 沿超平面的法向量 $a_i$ 方向移动得到。移动的距离恰好使得新点 $x_{k+1}$ 满足方程 $a_i^\top x_{k+1} = b_i$。该投影的数学表达式为：

$$
x_{k+1} = x_k - \frac{a_i^\top x_k - b_i}{\|a_i\|_2^2} a_i
$$

这个公式是 Kaczmarz 方法的核心。其中，$a_i^\top x_k - b_i$ 是当前点 $x_k$ 对于第 $i$ 个方程的**残差**，它度量了 $x_k$ 偏离[超平面](@entry_id:268044) $H_i$ 的程度。分母 $\|a_i\|_2^2$ 是对法向量 $a_i$ 长度的归一化。整个分式决定了沿[法向量](@entry_id:264185)方向移动的步长。这个步骤保证了新的迭代点 $x_{k+1}$ 精确地落在超平面 $H_i$ 上，即第 $i$ 个方程的残差在这一步之后为零 。

理解这一几何本质至关重要。它揭示了一个深刻的性质：Kaczmarz 方法的迭代过程只依赖于超平面本身，而与定义这些[超平面](@entry_id:268044)的具体方程形式无关。例如，方程 $a_i^\top x = b_i$ 和 $c \cdot (a_i^\top x) = c \cdot b_i$（其中 $c$ 为任意非零常数）定义的是完全相同的[超平面](@entry_id:268044)。如果我们对后者应用 Kaczmarz 更新公式，会发现其结果与对前者应用完全一致 。这意味着，对[系统矩阵](@entry_id:172230) $A$ 的行进行任意的非零缩放（即 $A \to DA$, $b \to Db$，其中 $D$ 是正[对角矩阵](@entry_id:637782)），并不会改变确定性 Kaczmarz 方法生成的迭代序列。然而，正如我们稍后将看到的，这种缩放预处理会影响到依赖于行范数的随机 Kaczmarz 方法的收敛行为。

### 收敛性质与速率

Kaczmarz 方法的收敛性是其理论保证的关键。对于一个**相容（consistent）**的线性系统（即解存在），标准的循环 Kaczmarz 方法被证明可以收敛到解集中的一个解。具体来说，它会收敛到距离初始猜测 $x_0$ 最近的那个解。

然而，收敛的**速率**则依赖于[系统矩阵](@entry_id:172230) $A$ 的几何结构。一个关键的衡量指标是**行相干性（row coherence）**，它描述了不同超平[面[法向](@entry_id:749211)量](@entry_id:264185)之间的夹角。行相干性 $\mu$ 定义为：

$$
\mu = \max_{i \neq j} \frac{|a_i^\top a_j|}{\|a_i\| \cdot \|a_j\|} \in [0,1]
$$

这个值是任意两个不同行的[单位法向量](@entry_id:178851)之间[内积](@entry_id:158127)的[绝对值](@entry_id:147688)的最大值。当 $\mu$ 接近 1 时，意味着至少有两个[超平面](@entry_id:268044)几乎平行，它们的法向量方向非常接近。在这种情况下，从一个[超平面](@entry_id:268044)投影到另一个几乎平行的[超平面](@entry_id:268044)，迭代点的移动距离会非常小，导致收敛极其缓慢。一个精细的分析可以表明，在考虑两个相干性最高的[超平面](@entry_id:268044) $H_p$ 和 $H_q$ 的两步迭代循环中，误差的缩减因子在最坏情况下就是由[相干性](@entry_id:268953) $\mu$ 决定的 。具体来说，[误差范数](@entry_id:176398)在这样一个两步循环后最多只能缩减为原来的 $\mu$ 倍。因此，高相干性（$\mu \to 1$）是 Kaczmarz 方法收敛缓慢的直接原因。

当系统**不相容（inconsistent）**时（例如，由于测量数据中存在噪声），超平面没有公共交点。此时，标准的循环 Kaczmarz 方法通常不会收敛到一个唯一的点，而可能在一个[极限环](@entry_id:274544)（limit cycle）中[振荡](@entry_id:267781)。为了解决这个问题，**随机 Kaczmarz（Randomized Kaczmarz, RK）**方法被提出。该方法在每次迭[代时](@entry_id:173412)，不是按照固定的顺序选择行，而是根据一个[概率分布](@entry_id:146404)来随机选取。一个重要的理论结果表明，如果以正比于行范数平方（即 $p_i \propto \|a_i\|_2^2$）的概率来选择行，那么对于不[相容系统](@entry_id:153969)，RK 方法的迭代序列在期望意义上会收敛到唯一的**[最小二乘解](@entry_id:152054)**，即最小化 $\|A x - b\|_2^2$ 的解 。这一发现极大地扩展了 Kaczmarz 方法的适用范围。在此框架下，之前提到的行归一化[预处理](@entry_id:141204)就显得尤为重要：如果将所有行都归一化为单位长度，那么 $p_i \propto \|a_i\|_2^2$ 的[采样策略](@entry_id:188482)就退化为均匀采样，这虽然不改变单步投影的结果，但改变了迭代的[随机过程](@entry_id:159502)，从而可能影响期望[收敛率](@entry_id:146534) 。

### [Kaczmarz方法](@entry_id:195677)在优化领域的视角

将 Kaczmarz 方法与更传统的优化算法进行比较，可以获得更深刻的理解。求解最小二乘问题 $\min \frac{1}{2}\|A x - b\|_2^2$ 的一个标准方法是**梯度下降法（Gradient Descent）**。其迭代方向由整个目标函数的梯度决定，即 $ \nabla f(x) = A^\top(Ax - b)$。这个梯度是所有单个方程残差的加权和，代表了使总平方误差下降最快的“全局”方向。

相比之下，Kaczmarz 方法可以被看作是一种**[随机坐标下降](@entry_id:636716)**或**分量梯度法**。每一步投影只考虑一个方程（一个数据点），并完全满足该方程，其更新方向仅为 $a_i$。这两种方法的区别至关重要 ：
1.  **几何行为**：[梯度下降法](@entry_id:637322)使总残差下降，但通常不会在单步内完全满足任何一个方程。Kaczmarz 方法则在单步内精确满足一个方程，但可能导致其他方程的残差增大。
2.  **计算代价**：梯度下降法需要计算 $A^\top(Ax-b)$，这在 $A$ 规模巨大时可能非常耗时。Kaczmarz 方法每次迭代只涉及矩阵的一行，计算量要小得多，特别适合于大规模和流式数据。
3.  **条件数影响**：梯度下降法收敛速度依赖于[海森矩阵](@entry_id:139140) $A^\top A$ 的[条件数](@entry_id:145150) $\kappa(A^\top A) = \kappa(A)^2$。如果原始矩阵 $A$ 是病态的（$\kappa(A) \gg 1$），那么 $\kappa(A^\top A)$ 会变得非常大，导致[梯度下降法](@entry_id:637322)收敛极为缓慢。Kaczmarz 方法直接作用于 $A$，避免了与 $A^\top A$ 相关的条件数平方问题，因此对于[病态问题](@entry_id:137067)通常表现出更好的鲁棒性 。

与现代优化理论的联系不止于此。可以为 Kaczmarz 方法引入**动量（momentum）**来加速收敛，这借鉴了[凸优化](@entry_id:137441)中的 Nesterov 加速或[重球法](@entry_id:637899)（heavy-ball method）。例如，一个带有重球动量的 Kaczmarz 更新可以表述为在标准投影步骤之后，再沿上一步的更新方向移动一小段距离。对于良态问题，这种加速策略有望通过改进收敛常数来加快[收敛速度](@entry_id:636873)。将随机 Kaczmarz 解释为[随机梯度下降](@entry_id:139134)（SGD）的观点尤其富有成果，这意味着我们可以将用于 SGD 的各种加速技术（如 Nesterov 动量）应用于 RK，从而得到一类**加速[随机梯度下降](@entry_id:139134)（Accelerated SGD）**算法 。这些高级技术打破了传统 Kaczmarz 方法的逐次迭代误差不增的 Fejér [单调性](@entry_id:143760)，但通过更复杂的机制实现了更快的总体收敛。

### [代数重建技术](@entry_id:746352)（ART）与正则化

在实际应用中，尤其是在医学成像等[逆问题](@entry_id:143129)中，Kaczmarz 方法通常以其推广形式——**[代数重建技术](@entry_id:746352)（ART）**——出现。ART 的一个关键特征是引入了**松弛参数（relaxation parameter）** $\omega$（在某些文献中也记为 $\lambda$）：

$$
x_{k+1} = x_k - \omega \frac{a_i^\top x_k - b_i}{\|a_i\|_2^2} a_i
$$

其中 $\omega \in (0, 2)$。当 $\omega = 1$ 时，即为标准 Kaczmarz 投影。当 $\omega  1$ 时，称为**[欠松弛](@entry_id:756302)（under-relaxation）**，迭代点不会完全投影到超平面上，而是在靠近超平面的地方停下。当 $\omega  1$ 时，称为**超松弛（over-relaxation）**，迭代点会穿过[超平面](@entry_id:268044)到达另一侧。在处理带噪数据时，[欠松弛](@entry_id:756302)（例如 $\omega=0.8$）是一种常见的策略，它能抑制算法对噪声的过度拟合，起到稳定迭代的作用  。

在处理**病态（ill-posed）**逆问题时，即使数据中的噪声很小，直接求解也可能导致解被噪声严重污染。ART 迭代过程会表现出一种称为**[半收敛](@entry_id:754688)（semi-convergence）**的现象：在迭代初期，解的质量不断提高，因为算法主要在拟合信号；但超过某个点后，算法开始过度拟合数据中的噪声，导致解的质量急剧下降。因此，正则化是必不可少的。

#### 通过提前终止实现的[隐式正则化](@entry_id:187599)

最简单也最经典的[正则化方法](@entry_id:150559)就是**提前终止（early stopping）**。我们不在迭代完全收敛时停止，而是在解的质量达到最佳（即噪声放大效应开始显现之前）的某个时刻 $k_*$ 停止迭代。

决定何时停止需要一个**[停止准则](@entry_id:136282)（stopping rule）**。一个广泛使用的准则是**差异原则（Discrepancy Principle）**。该原则指出，如果已知数据中的噪声水平为 $\delta$（即 $\|A x^\dagger - b^\delta\|_2 \leq \delta$），那么我们就不应该期望算法找到一个解 $x_k$ 使得残差 $\|A x_k - b^\delta\|_2$ 远小于 $\delta$，因为这意味着算法正在拟合噪声。因此，我们可以在[残差范数](@entry_id:754273)下降到与噪声水平相当时停止迭代。具体而言，我们寻找最小的迭代次数 $k_*$ 使得：

$$
\|A x_{k_*} - b^\delta\|_2 \leq \tau \delta
$$

其中 $\tau  1$ 是一个安全因子（例如 $\tau=1.1$），以防止对噪声水平的低估。例如，对于一个初始猜测为 $x_0=0$ 的一维问题，系统为 $A = \begin{pmatrix} 1 \\ 1 \end{pmatrix}$，观测数据为 $b^\delta = \begin{pmatrix} 1.5 \\ 1.8 \end{pmatrix}$，噪声水平 $\delta=0.3$，松弛参数 $\omega=0.8$，我们可以通过逐次计算迭代点 $x_k$ 及其对应的[残差范数](@entry_id:754273)，来确定满足差异原则的最小循环次数 $k_*$。一次完整的计算表明，仅需 $k_*=1$ 次循环即可满足该准则 。

提前终止这种**[隐式正则化](@entry_id:187599)**方法与经典的**显式正则化**方法（如 Tikhonov 正则化）之间存在深刻的联系。通过分析迭代过程在[谱域](@entry_id:755169)中的滤波效应，可以导出一个**指标函数（index function）** $\alpha(k)$，它将迭代次数 $k$ 与一个等效的 Tikhonov 正则化参数 $\alpha$ 联系起来。例如，通过匹配两种方法的[谱滤波](@entry_id:755173)器在半响应点（即滤波器函数值为 $0.5$）的位置，可以推导出 $\alpha(k) = \frac{1}{\tau} (1 - (0.5)^{1/k})$（其中 $\tau$ 为等效的 Landweber 迭代步长），这为在两种[正则化方法](@entry_id:150559)之间建立起定量的对应关系提供了理论依据 。

#### 通过邻近算子实现的显式正则化

现代[图像重建](@entry_id:166790)更倾向于使用**显式正则化**，即在优化目标中加入一个惩罚项来约束解的性质。对于图像问题，**全变分（Total Variation, TV）**正则化是一种极其有效的方法，它倾向于产生具有清晰边缘的分段常数图像。

将 TV 正则化与 ART 相结合的一种先进策略是交错迭代：在每一步 ART 投影（旨在满足[数据一致性](@entry_id:748190)）之后，立即应用一个 TV 相关的**邻近算子（proximal operator）**步骤（旨在对图像进行去噪和正则化）。具体来说，该两步迭代过程如下：
1.  **ART 更新**: $x^{k+\frac{1}{2}} = x^{k} + \omega \frac{b^\delta_i - \langle a_i, x^{k} \rangle}{\|a_i\|_2^2} a_i$
2.  **TV 邻近映射**: $x^{k+1} = \operatorname{prox}_{\alpha \mathrm{TV}}(x^{k+\frac{1}{2}})$

这种方法与仅使用提前终止的 ART 在重建结果上表现出显著的质的差异 ：
-   **提前终止的 ART** 倾向于产生模糊的边缘和残留的条状伪影（streaking artifacts），这是因为迭代在能完全解析高频信息和消除由数据不完备性（如稀疏视角）引起的伪影之前就停止了。
-   **TV 正则化的 ART** 则能有效地抑制噪声和条状伪影，并保持边缘的锐利。其代价是可能引入“[阶梯效应](@entry_id:755345)”（staircasing），即平滑变化的区域被近似为一系列小平台，并且可能会抑制掉一些低对比度的细微特征。

选择哪种正则化策略，取决于对重建[图像质量](@entry_id:176544)的具体要求——是更看重边缘的锐利度，还是更关注低对比度细节的保真度。

### 扩展与应用

Kaczmarz 方法的几何投影思想具有很强的普适性，可以被推广和应用于更广泛的场景。

#### 面向特定应用的变体：与 MLEM 的对比

在某些应用中，数据的噪声统计特性是已知的。例如，在发射型断层成像（Emission Tomography, ET）中，探测器计数服从泊松分布。在这种情况下，我们可以设计出统计上最优的重建算法。**最大似然[期望最大化](@entry_id:273892)（Maximum Likelihood Expectation Maximization, MLEM）**算法就是专门为泊松数据设计的，其目标是最大化泊松[对数似然函数](@entry_id:168593)。

对比 MLEM 和 ART ：
-   **ART** 是一个纯代数方法，其目标是求解线性方程组 $Ax = b$（在欧几里得范数意义下）。它不考虑噪声的具体[统计分布](@entry_id:182030)。其更新是加性的，并且除非显式强制，否则不保证解的非负性。
-   **MLEM** 则是一个统计方法。它的更新法则通过 EM 算法导出，形式上是乘性的，可以自然地保持图像非负性，并且保证了每一步迭代都会增加（或至少不减少）泊松对数似然值。在理想条件下，MLEM 收敛到的解是统计上[渐近有效](@entry_id:167883)的。

当面对泊松噪声时，MLEM 因其统计最优性而成为首选。这提醒我们，虽然 ART 是一种强大的通用工具，但在特定问题中，考虑数据统计特性的专用算法可能会有更优越的表现。

#### [非线性](@entry_id:637147) Kaczmarz 方法

Kaczmarz 方法的几何思想可以优雅地推广到[求解非线性方程](@entry_id:177343)组 $f(x) = y$ 的问题，其中 $f: \mathbb{R}^n \to \mathbb{R}^m$ 是一个非线性算子。在这种情况下，约束 $f_i(x) = y_i$ 定义的是一个**[超曲面](@entry_id:159491)**而非[超平面](@entry_id:268044)。

**[非线性](@entry_id:637147) Kaczmarz 方法**的核心思想是在当前迭代点 $x^k$ 处，用该点的**切超平面**来线性近似超曲面 $f_i(x) = y_i$。然后，将 $x^k$ 投影到这个切超平面上。该切超平面的方程为 $f_i(x^k) + \nabla f_i(x^k)^\top(x - x^k) = y_i$。求解最小范数校正并引入松弛参数 $\lambda$ 后，可以得到[非线性](@entry_id:637147) Kaczmarz 的更新法则 ：

$$
x^{k+1} = x^k + \lambda \frac{y_i - f_i(x^k)}{\|\nabla f_i(x^k)\|_2^2} \nabla f_i(x^k)
$$

这个形式与线性 Kaczmarz 惊人地相似，只是将常向量 $a_i$ 替换为了依赖于当前位置的[梯度向量](@entry_id:141180) $\nabla f_i(x^k)$。对该迭代的局部[收敛性分析](@entry_id:151547)表明，在解 $x^*$ 的邻域内，迭代映射的收敛性由其在 $x^*$ 处的 Fréchet 导数（[雅可比矩阵](@entry_id:264467)）的[谱半径](@entry_id:138984)决定。与线性情况类似，为了保证该映射的局部非扩[张性](@entry_id:141857)（nonexpansivity），松弛参数 $\lambda$ 需要满足一定条件。一个细致的分析表明，这个范围是 $\lambda \in [0, 2]$，与线性 Kaczmarz 方法的经典[收敛区间](@entry_id:146678)完全一致 。这一结果展示了从线性到[非线性](@entry_id:637147)优美而深刻的类比。