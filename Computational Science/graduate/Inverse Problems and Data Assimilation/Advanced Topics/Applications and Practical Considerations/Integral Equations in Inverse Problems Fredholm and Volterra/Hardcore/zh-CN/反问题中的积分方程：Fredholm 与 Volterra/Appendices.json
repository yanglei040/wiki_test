{
    "hands_on_practices": [
        {
            "introduction": "此练习深入探讨了 Fredholm 理论的核心。我们将构造一个简单的积分算子，亲身体验二类 Fredholm 方程 $(I-\\lambda K)f = g$ 的标准解法在何种情况下会失效。通过探索算子的零空间和值域，您将对 Fredholm 择一性理论（Fredholm alternative）有一个直观的理解，该理论为解的存在性提供了精确的条件。",
            "id": "3391730",
            "problem": "考虑希尔伯特空间 $L^{2}(0,1)$，它在一个带有积分观测算子的典型数据同化反问题中表示空间区间 $[0,1]$ 上的一个一维状态变量 $f$。你需要显式地构造一个可测核 $k:[0,1]\\times[0,1]\\to\\mathbb{R}$ 和一个标量 $\\lambda\\in\\mathbb{R}$，使得相关的积分算子 $(Kf)(x)=\\int_{0}^{1}k(x,t)f(t)\\,dt$ 产生一个不可逆算子 $I-\\lambda K:L^{2}(0,1)\\to L^{2}(0,1)$。仅使用基本的算子理论原理和积分恒等式，确定 $I-\\lambda K$ 的零空间和值域的结构，并为给定的 $g\\in L^{2}(0,1)$ 推导出第二类弗雷德霍姆积分方程\n$$\nf-\\lambda Kf=g,\n$$\n的可解的充分必要条件。然后，针对你显式构造的 $k$ 和 $\\lambda$，令 $g(x)=x-\\frac{1}{2}$，并确定方程 $f-\\lambda Kf=g$ 在 $L^{2}(0,1)$ 中的唯一最小范数解。给出此最小范数解 $f(x)$ 的显式解析表达式。不需要进行数值舍入。将你的最终答案表示为不带单位的关于 $x$ 的闭式表达式。",
            "solution": "本题要求构造一个特定的第二类弗雷德霍姆积分方程 $(I-\\lambda K)f=g$，该方程通常是不可逆的。然后，我们必须确定其可解性条件，并对给定的函数 $g(x)$ 求出其唯一的最小范数解。\n\n首先，我们构造积分算子 $K$ 并选择标量 $\\lambda$，使得 $I-\\lambda K$ 是不可逆的。实现这一目标的最简单方法是选择一个秩为一的退化核。令核为 $k(x,t) = 1$，对所有 $(x,t) \\in [0,1] \\times [0,1]$ 成立。相应的积分算子由下式给出：\n$$\n(Kf)(x) = \\int_{0}^{1} 1 \\cdot f(t) \\, dt\n$$\n该算子将任意函数 $f \\in L^2(0,1)$ 映射为一个常数函数，其值等于 $f$ 在区间 $[0,1]$ 上的积分。为了分析 $I-\\lambda K$ 的可逆性，我们考察 $K$ 的谱。一个特征值 $\\mu$ 和相应的特征函数 $\\phi$ 必须满足 $K\\phi = \\mu\\phi$。\n$$\n\\int_{0}^{1} \\phi(t) \\, dt = \\mu \\phi(x)\n$$\n左边是一个常数，我们称之为 $C$。因此，$\\mu \\phi(x) = C$。如果 $\\mu \\neq 0$，那么 $\\phi(x) = C/\\mu$ 必须是一个常数函数。我们测试一个非零常数函数，比如 $\\phi(x) = A$ (对于某个 $A \\neq 0$) 。\n$$\n(KA)(x) = \\int_{0}^{1} A \\, dt = A\n$$\n特征值方程为 $A = \\mu A$，对于 $A \\neq 0$ 这意味着 $\\mu = 1$。因此，算子 $K$ 有一个唯一的非零特征值 $\\mu=1$，其对应的特征空间是所有常数函数的集合，由函数 $\\phi(x)=1$ 张成。\n\n算子 $I-\\lambda K$ 不可逆当且仅当 $1$ 是算子 $\\lambda K$ 的一个特征值。$\\lambda K$ 的特征值是 $\\lambda\\mu$。要使 $1$ 成为 $\\lambda K$ 的一个特征值，我们必须有 $\\lambda\\mu=1$。由于 $K$ 唯一的非零特征值是 $\\mu=1$，我们必须选择 $\\lambda=1$。\n作出此选择后，我们的问题变成求解方程 $(I-K)f=g$，即：\n$$\nf(x) - \\int_{0}^{1} f(t) \\, dt = g(x)\n$$\n算子 $K$ 是一个希尔伯特-施密特算子，因为它的核是平方可积的：$\\int_0^1\\int_0^1 |k(x,t)|^2 \\,dx\\,dt = \\int_0^1\\int_0^1 1^2 \\,dx\\,dt = 1  \\infty$。因此，$K$ 是 $L^2(0,1)$ 上的一个紧算子。弗雷德霍姆择一性定理适用于算子 $I-K$。\n\n根据弗雷德霍姆择一性定理，由于齐次方程 $(I-K)\\phi=0$ 有非平凡解（即任意常数函数），非齐次方程 $(I-K)f=g$ 有解当且仅当 $g$ 与伴随算子 $(I-K^*)$ 的零空间正交。核是实且对称的，$k(x,t) = 1 = k(t,x)$，所以算子 $K$ 是自伴的，即 $K^*=K$。\n$I-K$ 的零空间是 $K$ 对应于特征值 $1$ 的特征空间，即 $\\mathcal{N}(I-K) = \\text{span}\\{1\\}$。\n由于 $K^*=K$，伴随算子的零空间是相同的：$\\mathcal{N}(I-K^*) = \\text{span}\\{1\\}$。\n$f-Kf=g$ 的可解性条件是 $g$ 必须与 $\\mathcal{N}(I-K^*)$ 中的每一个函数正交。只需检验与基函数 $\\psi(x)=1$ 的正交性即可：\n$$\n\\langle g, \\psi \\rangle = \\int_{0}^{1} g(x) \\overline{\\psi(x)} \\, dx = \\int_{0}^{1} g(x) \\cdot 1 \\, dx = 0\n$$\n因此，解存在当且仅当 $g(x)$ 在 $[0,1]$ 上的积分为零。这对应于条件 $g$ 必须位于算子 $I-K$ 的值域中，该值域是伴随算子零空间的正交补，即 $\\mathcal{R}(I-K) = (\\mathcal{N}(I-K^*))^{\\perp} = (\\text{span}\\{1\\})^{\\perp}$。\n\n我们给定的函数是 $g(x) = x - \\frac{1}{2}$。我们检验可解性条件：\n$$\n\\int_{0}^{1} g(x) \\, dx = \\int_{0}^{1} \\left(x - \\frac{1}{2}\\right) \\, dx = \\left[\\frac{x^2}{2} - \\frac{x}{2}\\right]_{0}^{1} = \\left(\\frac{1}{2} - \\frac{1}{2}\\right) - 0 = 0\n$$\n条件满足，因此解存在。为了找到解，令 $C = \\int_{0}^{1} f(t) \\, dt$。方程变为：\n$$\nf(x) - C = x - \\frac{1}{2} \\implies f(x) = x - \\frac{1}{2} + C\n$$\n这表示任意解的一般形式。将此形式代回 $C$ 的定义中，得到 $C = \\int_{0}^{1} (t - \\frac{1}{2} + C) \\, dt = \\int_{0}^{1} (t - \\frac{1}{2}) \\, dt + \\int_{0}^{1} C \\, dt = 0 + C$，即 $C=C$。这证实了任意常数 $C \\in \\mathbb{R}$ 都能得到一个有效解。所有解的集合是仿射子空间 $f_p + \\mathcal{N}(I-K)$，其中 $f_p(x) = x-\\frac{1}{2}$ 是一个特解，且 $\\mathcal{N}(I-K)=\\text{span}\\{C \\cdot 1\\}$。\n\n问题要求唯一的最小范数解。在希尔伯特空间中，一个仿射子空间里范数最小的元素是与该子空间的方向空间正交的那个元素。在这里，方向空间是零空间 $\\mathcal{N}(I-K)=\\text{span}\\{1\\}$。因此，最小范数解（我们称之为 $f_m$）必须与零空间的基函数正交，即 $\\langle f_m, 1 \\rangle = 0$。\n我们需要找到 $C$ 的值，使得解 $f(x) = x - \\frac{1}{2} + C$ 满足此正交条件：\n$$\n\\int_{0}^{1} \\left(x - \\frac{1}{2} + C\\right) \\, dx = 0\n$$\n$$\n\\int_{0}^{1} \\left(x - \\frac{1}{2}\\right) \\, dx + \\int_{0}^{1} C \\, dx = 0\n$$\n如前所算，第一个积分为 $0$。第二个积分为 $C$。所以我们有 $0 + C = 0$，这意味着 $C=0$。\n因此，通过在通解中令 $C=0$ 即可获得唯一的最小范数解。\n\n最小范数解是 $f(x) = x - \\frac{1}{2}$。",
            "answer": "$$\n\\boxed{x-\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "从连续理论转向数值实践，本练习探讨了将一类 Fredholm 方程离散化所带来的后果。您将应用 Nyström 方法于一个积分算子，并分析得到的线性系统。关键的洞见来自于将连续算子的谱性质与其离散矩阵近似的条件数联系起来，从而揭示了为何这类问题是内在地不适定的（ill-conditioned）。",
            "id": "3391739",
            "problem": "考虑区间 $[0,1]$ 上的第一类 Fredholm 积分方程，\n$$\n(Kf)(s) = \\int_{0}^{1} k(s,t)\\,f(t)\\,dt = g(s),\n$$\n其中 $k(s,t)$ 是一个连续对称核，$g(s)$ 是一个已知函数。在反问题中，通过 Nyström 方法进行离散化会生成一个近似该积分算子的线性系统。您的任务如下：\n\n1. 使用核函数\n$$\nk(s,t) = \\min(s,t) - s\\,t,\n$$\n推导在 $[0,1]$ 上使用中点求积法则的 Nyström 离散化。设求积节点为 $t_{j} = \\frac{j-\\frac{1}{2}}{N}$（$j=1,\\dots,N$），权重为 $w_{j} = \\frac{1}{N}$。在同一组点 $s_{i} = t_{i}$（$i=1,\\dots,N$）上对积分方程进行配置，以获得线性系统 $A\\mathbf{f} \\approx \\mathbf{g}$，其中 $\\mathbf{f} = \\big(f(t_{1}),\\dots,f(t_{N})\\big)^{\\top}$ 且 $\\mathbf{g} = \\big(g(s_{1}),\\dots,g(s_{N})\\big)^{\\top}$。写出矩阵元素 $A_{ij}$ 关于 $s_{i}$、$t_{j}$ 和 $w_{j}$ 的显式表达式。\n\n2. 从积分算子 $K$ 的特征对 $(\\lambda,\\varphi)$ 的定义出发，即\n$$\n\\int_{0}^{1} \\big(\\min(s,t) - s\\,t\\big)\\,\\varphi(t)\\,dt = \\lambda\\,\\varphi(s),\n$$\n通过对 $s$ 求导并使用由核函数所蕴含的适当边界条件，推导 $\\varphi(s)$ 满足的常微分方程，并确定特征值 $\\lambda_{n}$ 和特征函数 $\\varphi_{n}(s)$。\n\n3. 利用第2部分的谱特征，以及 Nyström 离散化（使用一致的求积法则）会产生一个对称正定矩阵，其谱收敛于连续算子的谱这一事实，来论证当 $N$ 增大时，Nyström 矩阵 $A$ 的条件数 $\\kappa(A)$ 的渐近行为。此处的条件数定义为 $\\kappa(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$，其中 $\\sigma_{\\max}(A)$ 和 $\\sigma_{\\min}(A)$ 分别表示 $A$ 的最大和最小奇异值。\n\n请以关于 $N$ 的闭式解析表达式给出 $\\kappa(A)$ 的主阶渐近表达式。无需单位。不要提供不等式。如果必须进行近似，仅提供主阶项，不含低阶修正项。",
            "solution": "### 解答\n\n**第1部分：Nyström 离散化**\n\n给定的 Fredholm 积分方程为\n$$\n\\int_{0}^{1} k(s,t)\\,f(t)\\,dt = g(s).\n$$\nNyström 方法使用求积法则来近似积分。使用给定的中点法则，其节点为 $t_j$，权重为 $w_j$，积分可近似为：\n$$\n\\int_{0}^{1} k(s,t)\\,f(t)\\,dt \\approx \\sum_{j=1}^{N} w_j k(s, t_j) f(t_j).\n$$\n为了获得一个线性系统，我们在点 $s_i = t_i$ 处对该方程进行配置。这得到：\n$$\n\\sum_{j=1}^{N} w_j k(s_i, t_j) f(t_j) \\approx g(s_i), \\quad \\text{对于 } i=1,\\dots,N.\n$$\n这是一个形如 $A\\mathbf{f} \\approx \\mathbf{g}$ 的线性系统，其中 $\\mathbf{f}$ 是元素为 $f_j = f(t_j)$ 的向量，$\\mathbf{g}$ 是元素为 $g_i = g(s_i)$ 的向量。矩阵 $A$ 的元素由下式给出\n$$\nA_{ij} = w_j k(s_i, t_j).\n$$\n代入给定的核函数、权重、节点和配置点的表达式：\n-   $k(s_i, t_j) = \\min(s_i, t_j) - s_i t_j$\n-   $w_j = \\frac{1}{N}$\n-   $s_i = t_i = \\frac{i-\\frac{1}{2}}{N}$\n-   $t_j = \\frac{j-\\frac{1}{2}}{N}$\n\n矩阵元素 $A_{ij}$ 为：\n$$\nA_{ij} = \\frac{1}{N} \\left[ \\min\\left(\\frac{i-\\frac{1}{2}}{N}, \\frac{j-\\frac{1}{2}}{N}\\right) - \\left(\\frac{i-\\frac{1}{2}}{N}\\right)\\left(\\frac{j-\\frac{1}{2}}{N}\\right) \\right].\n$$\n这就是 Nyström 矩阵 $A$ 元素的显式表达式。\n\n**第2部分：积分算子的特征值问题**\n\n我们的任务是求解积分算子 $K$ 的特征值问题：\n$$\n\\lambda \\varphi(s) = \\int_{0}^{1} (\\min(s,t) - st) \\varphi(t) dt.\n$$\n为了将此积分方程转换为微分方程，我们首先在 $t=s$ 处拆分积分：\n$$\n\\lambda \\varphi(s) = \\int_{0}^{s} (t - st) \\varphi(t) dt + \\int_{s}^{1} (s - st) \\varphi(t) dt.\n$$\n$$\n\\lambda \\varphi(s) = (1-s) \\int_{0}^{s} t \\varphi(t) dt + s \\int_{s}^{1} (1-t) \\varphi(t) dt.\n$$\n我们使用 Leibniz 积分法则对该方程关于 $s$ 求导：\n$$\n\\lambda \\varphi'(s) = \\frac{d}{ds} \\left[ (1-s) \\int_{0}^{s} t \\varphi(t) dt + s \\int_{s}^{1} (1-t) \\varphi(t) dt \\right]\n$$\n$$\n\\lambda \\varphi'(s) = -\\int_{0}^{s} t\\varphi(t)dt + (1-s)(s\\varphi(s)) + \\int_{s}^{1}(1-t)\\varphi(t)dt + s(-(1-s)\\varphi(s))\n$$\n$$\n\\lambda \\varphi'(s) = -\\int_{0}^{s} t\\varphi(t)dt + s(1-s)\\varphi(s) + \\int_{s}^{1}(1-t)\\varphi(t)dt - s(1-s)\\varphi(s)\n$$\n$$\n\\lambda \\varphi'(s) = \\int_{s}^{1} (1-t)\\varphi(t)dt - \\int_{0}^{s} t\\varphi(t)dt.\n$$\n第二次对 $s$ 求导：\n$$\n\\lambda \\varphi''(s) = \\frac{d}{ds} \\left[ \\int_{s}^{1} (1-t)\\varphi(t)dt - \\int_{0}^{s} t\\varphi(t)dt \\right]\n$$\n$$\n\\lambda \\varphi''(s) = -(1-s)\\varphi(s) - s\\varphi(s) = -s\\varphi(s) - \\varphi(s) + s\\varphi(s) = -\\varphi(s).\n$$\n这给出了常微分方程：\n$$\n\\varphi''(s) + \\frac{1}{\\lambda} \\varphi(s) = 0.\n$$\n接下来，我们确定边界条件。从 $\\lambda \\varphi(s)$ 的表达式出发，我们在 $s=0$ 处求值：\n$$\n\\lambda \\varphi(0) = (1-0) \\int_{0}^{0} t \\varphi(t) dt + 0 \\cdot \\int_{0}^{1} (1-t) \\varphi(t) dt = 0.\n$$\n对于非平凡特征解，必须有 $\\lambda \\neq 0$，这意味着 $\\varphi(0)=0$。\n在 $s=1$ 处求值：\n$$\n\\lambda \\varphi(1) = (1-1) \\int_{0}^{1} t \\varphi(t) dt + 1 \\cdot \\int_{1}^{1} (1-t) \\varphi(t) dt = 0.\n$$\n这意味着 $\\varphi(1)=0$。\n我们现在得到了一个 Sturm-Liouville 问题，它由常微分方程 $\\varphi''(s) + \\mu \\varphi(s) = 0$（其中 $\\mu=1/\\lambda$）和边界条件 $\\varphi(0)=0$、$\\varphi(1)=0$ 组成。\n该常微分方程的通解是 $\\varphi(s) = C_1 \\cos(\\sqrt{\\mu}s) + C_2 \\sin(\\sqrt{\\mu}s)$。\n应用边界条件：\n-   $\\varphi(0) = 0 \\implies C_1 \\cos(0) + C_2 \\sin(0) = C_1 = 0$。\n-   $\\varphi(s)$ 必须具有形式 $\\varphi(s) = C_2 \\sin(\\sqrt{\\mu}s)$。\n-   $\\varphi(1) = 0 \\implies C_2 \\sin(\\sqrt{\\mu}) = 0$。\n对于非平凡解（$C_2 \\neq 0$），我们需要 $\\sin(\\sqrt{\\mu})=0$。这在 $\\sqrt{\\mu} = n\\pi$（对于任意整数 $n$）时成立。我们取 $n=1, 2, 3, \\dots$ 以获得不同的非平凡解。\n微分算子的特征值是 $\\mu_n = (n\\pi)^2$。\n由于 $\\lambda = 1/\\mu$，积分算子 $K$ 的特征值为：\n$$\n\\lambda_n = \\frac{1}{(n\\pi)^2}, \\quad n=1, 2, 3, \\dots\n$$\n相应的未归一化特征函数是：\n$$\n\\varphi_n(s) = \\sin(n\\pi s).\n$$\n归一化后的特征函数是 $\\sqrt{2}\\sin(n\\pi s)$。\n\n**第3部分：条件数的渐近行为**\n\n矩阵 $A$ 的条件数定义为 $\\kappa(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$，其中 $\\sigma_{\\max}(A)$ 和 $\\sigma_{\\min}(A)$ 是 $A$ 的最大和最小奇异值。\n核函数 $k(s,t)$ 是对称的。求积法则使用相等的权重 $w_j = 1/N$。矩阵元素为 $A_{ij} = \\frac{1}{N}k(s_i, t_j)$。当 $s_i=t_i$ 时，我们有 $A_{ij} = \\frac{1}{N}k(t_i, t_j)$。由于 $k(t_i, t_j)=k(t_j, t_i)$，矩阵 $A$ 是对称的。\n积分算子 $K$ 在与其零空间（此处仅为零函数）正交的函数空间上是正定的，因为其特征值 $\\lambda_n = 1/(n\\pi)^2$ 均为正数。对于足够大的 $N$，离散近似矩阵 $A$ 也将是正定的。对于对称正定矩阵，其奇异值就是其特征值。因此，$\\kappa(A) = \\nu_{\\max}(A)/\\nu_{\\min}(A)$，其中 $\\nu$ 表示 $A$ 的特征值。\n\n问题指出 Nyström 矩阵 $A$ 的谱收敛于连续算子 $K$ 的谱。这是数值积分方程理论中的一个关键结果。这意味着对于大的 $N$，矩阵 $A$ 的 $N$ 个特征值集合（我们按降序记为 $\\{\\nu_k\\}_{k=1}^N$）可以很好地近似算子 $K$ 的前 $N$ 个特征值 $\\{\\lambda_k\\}_{k=1}^N$。\n\n1.  **最大特征值：** $A$ 的最大特征值 $\\nu_{\\max}(A) = \\nu_1$ 将近似于 $K$ 的最大（主）特征值。根据第2部分的结果，此值为 $\\lambda_1$。\n    $$\n    \\sigma_{\\max}(A) = \\nu_1 \\approx \\lambda_1 = \\frac{1}{\\pi^2}.\n    $$\n2.  **最小特征值：** 离散系统的 $N$ 个特征值对应于网格上可以分辨的 $N$ 个模态。$A$ 的最小特征值 $\\nu_{\\min}(A)=\\nu_N$ 对应于离散化可表示的最高频率模态。因此，用连续算子的第 $N$ 个特征值 $\\lambda_N$ 来近似 $\\nu_N$ 是合理的。\n    $$\n    \\sigma_{\\min}(A) = \\nu_N \\approx \\lambda_N = \\frac{1}{(N\\pi)^2}.\n    $$\n3.  **条件数：** 使用这些渐近近似，我们可以找到条件数 $\\kappa(A)$ 的主阶行为：\n    $$\n    \\kappa(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)} \\approx \\frac{\\lambda_1}{\\lambda_N} = \\frac{1/(\\pi^2)}{1/((N\\pi)^2)} = \\frac{(N\\pi)^2}{\\pi^2} = N^2.\n    $$\n这种随 $N$ 呈二次方增长的严重病态是具有光滑核的第一类 Fredholm 积分方程离散化的典型特征（即所谓的“不适定问题”）。条件数的主阶渐近表达式为 $N^2$。",
            "answer": "$$\\boxed{N^2}$$"
        },
        {
            "introduction": "最后的这个练习是一个理论与计算相遇的数值实验室。在理解了可解性条件和不适定性的基础上，您将编写代码来数值化地研究 Fredholm 择一性。通过使用位于算子值域内部和外部的右端项数据来测试求解器，您将观察并量化当理论可解性条件不满足时，最小二乘解和正则化解所产生的伪影（artifacts）。",
            "id": "3391694",
            "problem": "你的任务是数值研究定义在区间 $[0,1]$ 上的一个紧的第一类 Fredholm 积分算子的离散近似的 Fredholm 择一性。目标是构造位于该算子值域内和不位于其值域内的右端项 $f$，测试常用求解器的行为，并在可解性条件 $\\langle f, \\psi \\rangle = 0$ 对 $\\psi \\in \\ker(A^\\ast)$ 不成立时，计算其定量的人为误差。\n\n基本原理：\n- 第一类 Fredholm 积分算子定义为 $(A u)(x) = \\int_{0}^{1} k(x,y) u(y) \\, dy$，其中 $k(x,y)$ 是一个平方可积的核函数，$u$ 是一个未知函数。\n- 对于希尔伯特空间上的一个紧算子 $A$，Fredholm 择一性指出，方程 $A u = f$ 可解的充要条件是 $f$ 与其伴随算子的核正交，即对于所有 $\\psi \\in \\ker(A^\\ast)$ 都有 $\\langle f, \\psi \\rangle = 0$。当可解性条件不满足时，方程无解；最小二乘或正则化求解器会产生投影和偏差所导致的人为误差。\n\n离散化：\n- 考虑可分离核 $k(x,y) = p(x) q(y)$，其中 $p(x) = \\sin(\\pi x)$ 且 $q(y) = 1$，这会产生秩一算子 $(A u)(x) = p(x) \\int_{0}^{1} u(y) \\, dy$。\n- 使用复合梯形法则对区间 $[0,1]$ 进行均匀离散化，取 $N=200$ 个网格点 $x_i = \\frac{i}{N-1}$（$i=0,1,\\dots,N-1$），间距为 $h = \\frac{1}{N-1}$，求积权重为 $w_0 = w_{N-1} = \\frac{h}{2}$ 以及 $w_i = h$（$i=1,\\dots,N-2$）。\n- 定义离散算子矩阵 $A \\in \\mathbb{R}^{N \\times N}$，其元素为 $A_{ij} = p(x_i) w_j$，从而有 $(A u)_i \\approx p(x_i) \\sum_{j=0}^{N-1} w_j u_j$。\n- 在 $\\mathbb{R}^N$ 中使用标准欧几里得内积，即 $\\langle a, b \\rangle = a^\\top b$。在此离散设置下，伴随矩阵为 $A^\\top$，$A^\\top$ 的核等于与非零奇异值相关联的左奇异向量的正交补。\n\n求解器与诊断：\n- 使用奇异值分解构造 Moore–Penrose 伪逆 $A^+$，并对每个 $f$ 计算最小范数最小二乘解 $u^\\dagger = A^+ f$ 及其残差 $\\|A u^\\dagger - f\\|_2$。\n- 使用 Tikhonov 正则化，参数为 $\\alpha = 10^{-3}$，求解 $(A^\\top A + \\alpha I) u_{\\alpha} = A^\\top f$ 以得到 $u_{\\alpha}$，并计算其残差 $\\|A u_{\\alpha} - f\\|_2$。\n- 从对应于零奇异值的左奇异向量构造 $\\ker(A^\\top)$ 的一个标准正交基 $\\{\\psi_k\\}$，并计算可解性度量 $S(f) = \\sum_k |\\langle f, \\psi_k \\rangle|^2$，该度量量化了对可解性条件的违反程度。对于值域 $A$ 内的 $f$，$S(f)$ 在数值上应为零；否则为正。\n\n测试套件：\n- 三个右端项 $f^{(m)} \\in \\mathbb{R}^N$：\n    1. 情况1（值域内）：$f^{(1)}_i = p(x_i)$。\n    2. 情况2（值域外）：$f^{(2)}_i = p(x_i) + 0.7 \\cos(2\\pi x_i)$。\n    3. 情况3（接近值域）：$f^{(3)}_i = p(x_i) + 10^{-3} \\cos(2\\pi x_i)$。\n- 对于每种情况，计算以下五个量：\n    1. $S(f^{(m)})$。\n    2. $\\|A u^\\dagger - f^{(m)}\\|_2$。\n    3. $\\|u^\\dagger\\|_2$。\n    4. $\\|A u_{\\alpha} - f^{(m)}\\|_2$。\n    5. $\\|u_{\\alpha}\\|_2$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按如下顺序排列\n$$[S(f^{(1)}), \\|A u^\\dagger - f^{(1)}\\|_2, \\|u^\\dagger\\|_2, \\|A u_{\\alpha} - f^{(1)}\\|_2, \\|u_{\\alpha}\\|_2, S(f^{(2)}), \\|A u^\\dagger - f^{(2)}\\|_2, \\|u^\\dagger\\|_2, \\|A u_{\\alpha} - f^{(2)}\\|_2, \\|u_{\\alpha}\\|_2, S(f^{(3)}), \\|A u^\\dagger - f^{(3)}\\|_2, \\|u^\\dagger\\|_2, \\|A u_{\\alpha} - f^{(3)}\\|_2, \\|u_{\\alpha}\\|_2].$$\n- 所有值必须以实数（浮点数）形式打印。不需要单位，因为在此离散设置下所有量都是无量纲的。\n\n设计注意事项：\n- 通过使用与最大奇异值成比例的容差来检测零奇异值，确保数值稳健性。\n- 在单次运行中提供所有三种情况的结果，并仅以指定格式打印最终列表。",
            "solution": "### 1. 积分算子的离散化\n\n连续的第一类 Fredholm 积分算子由下式给出：\n$$ (A u)(x) = \\int_{0}^{1} k(x,y) u(y) \\, dy $$\n使用指定的可分离核 $k(x,y) = p(x)q(y)$，其中 $p(x) = \\sin(\\pi x)$ 且 $q(y) = 1$，该算子变为：\n$$ (A u)(x) = \\sin(\\pi x) \\int_{0}^{1} u(y) \\, dy $$\n这表明算子 $A$ 的值域是由函数 $p(x) = \\sin(\\pi x)$ 张成的空间。任何使得方程 $Au=f$ 有解的函数 $f(x)$ 都必须是 $\\sin(\\pi x)$ 的标量倍数。\n\n为了离散化该算子，我们在一个包含 $N=200$ 个点的均匀网格上表示函数 $x_i = \\frac{i}{N-1}$，其中 $i=0, 1, \\dots, N-1$。积分使用复合梯形法则进行近似，步长为 $h = \\frac{1}{N-1}$，权重为 $w_j$。权重为 $w_0 = w_{N-1} = \\frac{h}{2}$ 以及 $w_j = h$（$j=1, \\dots, N-2$）。\n\n函数 $u(x)$ 由一个向量 $u \\in \\mathbb{R}^N$ 表示，其分量为 $u_j = u(x_j)$。积分的离散形式为 $\\sum_{j=0}^{N-1} w_j u_j$。离散算子作用于向量 $u$ 会产生一个向量 $f = Au$，其第 $i$ 个分量为：\n$$ (Au)_i = p(x_i) \\sum_{j=0}^{N-1} w_j u_j $$\n这可以表示为矩阵-向量乘积 $f = \\mathbf{A}u$，其中矩阵 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 的元素为：\n$$ A_{ij} = p(x_i) w_j = \\sin\\left(\\frac{\\pi i}{N-1}\\right) w_j $$\n这个矩阵 $\\mathbf{A}$ 是一个秩一矩阵，因为它是两个向量的外积：一个分量为 $p_i = \\sin(\\pi x_i)$ 的向量 $p$ 和求积权重向量 $w$。\n\n### 2. 使用奇异值分解 (SVD) 进行分析\n\n矩阵 $\\mathbf{A}$ 的奇异值分解 (SVD) 为 $\\mathbf{A} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^\\top$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是正交矩阵，$\\mathbf{\\Sigma}$ 是由奇异值 $s_k \\ge 0$ 构成的对角矩阵。\n- $\\mathbf{U}$ 的列是左奇异向量，记为 $\\{u_k\\}$。\n- $\\mathbf{V}$ 的列是右奇异向量，记为 $\\{v_k\\}$。\n\n对于像 $\\mathbf{A}$ 这样的秩一矩阵，只有一个奇异值 $s_0$ 是非零的。所有其他奇异值 $s_1, \\dots, s_{N-1}$ 均为零。\n- $\\mathbf{A}$ 的值域 $R(\\mathbf{A})$ 由第一个左奇异向量 $u_0$ 张成。\n- 伴随矩阵 $\\mathbf{A}^\\top$ 的核（零空间）（使用标准欧几里得点积 $\\langle a, b \\rangle = a^\\top b$），记为 $\\ker(\\mathbf{A}^\\top)$，是 $R(\\mathbf{A})$ 的正交补。它由与零奇异值相对应的左奇异向量 $u_1, \\dots, u_{N-1}$ 张成。问题将 $\\ker(\\mathbf{A}^\\top)$ 的这个标准正交基记为 $\\{\\psi_k\\}$。\n\n### 3. Fredholm 择一性与可解性度量\n\nFredholm 择一性指出，线性系统 $\\mathbf{A}u = f$ 有解的充要条件是右端项 $f$ 与伴随算子核 $\\ker(\\mathbf{A}^\\top)$ 中的每个向量都正交。\n$$ \\langle f, \\psi \\rangle = 0 \\quad \\forall \\psi \\in \\ker(\\mathbf{A}^\\top) $$\n可解性度量 $S(f)$ 量化了对这一条件的违反程度。它是 $f$ 到 $\\ker(\\mathbf{A}^\\top)$ 上的投影的范数平方：\n$$ S(f) = \\sum_{k=1}^{N-1} |\\langle f, \\psi_k \\rangle|^2 = \\left\\| \\text{proj}_{\\ker(\\mathbf{A}^\\top)} f \\right\\|_2^2 $$\n其中基向量 $\\psi_k$ 是左奇异向量 $u_1, \\dots, u_{N-1}$。如果 $f \\in R(\\mathbf{A})$，则它与 $\\ker(\\mathbf{A}^\\top)$ 正交，因此 $S(f) = 0$。否则，$S(f)  0$。\n\n### 4. 数值求解器\n\n#### a. 伪逆解\n\n当 $S(f)  0$ 时，不存在精确解。Moore-Penrose 伪逆 $\\mathbf{A}^+$ 提供了最小范数最小二乘解 $u^\\dagger = \\mathbf{A}^+ f$。该解最小化了残差范数 $\\|\\mathbf{A}u - f\\|_2$。伪逆由 SVD 构造：\n$$ \\mathbf{A}^+ = \\mathbf{V} \\mathbf{\\Sigma}^+ \\mathbf{U}^\\top $$\n其中 $\\mathbf{\\Sigma}^+$ 是通过对 $\\mathbf{\\Sigma}$ 中的非零奇异值取倒数并保持零值不变而得到的。对于我们的秩一情况，在 $\\mathbf{\\Sigma}^+$ 中只有 $1/s_0$ 是非零的。该解的残差是 $f$ 到 $\\ker(\\mathbf{A}^\\top)$ 上的投影的范数：\n$$ \\|\\mathbf{A}u^\\dagger - f\\|_2 = \\left\\| \\text{proj}_{\\ker(\\mathbf{A}^\\top)} f \\right\\|_2 = \\sqrt{S(f)} $$\n这为我们的计算提供了一个关键的一致性检查。\n\n#### b. Tikhonov 正则化\n\nTikhonov 正则化通过求解一个相关的适定问题来找到一个近似解。给定正则化参数 $\\alpha  0$，Tikhonov 正则化解 $u_\\alpha$ 通过求解正则化法方程得到：\n$$ (\\mathbf{A}^\\top \\mathbf{A} + \\alpha \\mathbf{I}) u_\\alpha = \\mathbf{A}^\\top f $$\n即使对于不适定问题，该方法也能产生稳定的解，但会引入偏差。解 $u_\\alpha$ 最小化了泛函 $\\|\\mathbf{A}u - f\\|_2^2 + \\alpha \\|u\\|_2^2$。\n\n### 5. 测试案例分析\n\n我们将此框架应用于三个指定的右端向量 $f^{(m)}$。\n\n1.  **情况1：$f^{(1)}_i = p(x_i) = \\sin(\\pi x_i)$**。\n    这个向量 $f^{(1)}$ 恰好是张成 $\\mathbf{A}$ 值域的向量。因此，它位于 $R(\\mathbf{A})$ 中，并与 $\\ker(\\mathbf{A}^\\top)$ 正交。我们预期 $S(f^{(1)}) \\approx 0$ 且最小二乘残差 $\\|\\mathbf{A}u^\\dagger - f^{(1)}\\|_2 \\approx 0$。存在精确解。\n\n2.  **情况2：$f^{(2)}_i = p(x_i) + 0.7 \\cos(2\\pi x_i)$**。\n    该向量有一个分量 $g_i = 0.7 \\cos(2\\pi x_i)$ 不在 $p(x_i)$ 的张成空间内。因此，$f^{(2)}$ 不在 $R(\\mathbf{A})$ 中。我们预期会有一个非零的可解性度量 $S(f^{(2)})  0$ 和一个相应的非零残差 $\\|\\mathbf{A}u^\\dagger - f^{(2)}\\|_2  0$。\n\n3.  **情况3：$f^{(3)}_i = p(x_i) + 10^{-3} \\cos(2\\pi x_i)$**。\n    这种情况与第二种类似，代表了一个带有小幅度噪声或与理想模型有偏差的场景。其值域外的分量很小，因此我们预期 $S(f^{(3)})$ 和 $\\|\\mathbf{A}u^\\dagger - f^{(3)}\\|_2$ 为正，但比情况2中的值要小得多。\n\n现在，数值实现将为这三种情况中的每一种计算五个指定的量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Numerically investigates the Fredholm alternative for a discrete integral operator.\n    \"\"\"\n    # 1. Define problem parameters and discretize the domain\n    N = 200\n    alpha = 1e-3\n    x = np.linspace(0, 1, N)\n    h = 1.0 / (N - 1)\n\n    # 2. Construct the discrete operator matrix A\n    # Quadrature weights for the composite trapezoidal rule\n    w = np.full(N, h)\n    w[0] = h / 2.0\n    w[-1] = h / 2.0\n    \n    # Kernel functions p(x) and q(y)=1\n    p_vec = np.sin(np.pi * x)\n    \n    # The matrix A with entries A_ij = p(x_i) * w_j\n    A = np.outer(p_vec, w)\n\n    # 3. Analyze the operator using SVD\n    U, s, Vt = np.linalg.svd(A, full_matrices=True)\n\n    # The basis for ker(A^T) is the set of left singular vectors \n    # corresponding to zero singular values.\n    # For this rank-1 matrix, these are all columns of U from the second one on.\n    Psi_basis = U[:, 1:]\n\n    # 4. Construct the Moore-Penrose pseudoinverse A_plus\n    # Set a tolerance for determining zero singular values\n    tol = s[0] * N * np.finfo(float).eps\n    s_inv = np.zeros_like(s)\n    # The matrix is rank-1, so only handle the first singular value\n    if s[0]  tol:\n        s_inv[0] = 1.0 / s[0]\n    \n    Sigma_plus_diag = np.zeros((N, N))\n    Sigma_plus_diag[0, 0] = s_inv[0]\n    \n    A_plus = Vt.T @ Sigma_plus_diag @ U.T\n\n    # 5. Define the test cases for the right-hand side f\n    f1 = p_vec  # Case 1: In-range\n    noise_vec = np.cos(2 * np.pi * x)\n    f2 = p_vec + 0.7 * noise_vec  # Case 2: Out-of-range\n    f3 = p_vec + 1e-3 * noise_vec # Case 3: Nearly in-range\n    \n    test_cases = [f1, f2, f3]\n    results = []\n\n    for f in test_cases:\n        # 6. Compute the required quantities for each case\n\n        # a. Solvability metric S(f)\n        # S(f) is the squared norm of the projection of f onto ker(A^T)\n        # Using f @ Psi_basis computes dot products of f with each basis vector\n        proj_coeffs = f @ Psi_basis\n        S_f = np.sum(proj_coeffs**2)\n\n        # b. Pseudoinverse solution and its residual\n        u_dagger = A_plus @ f\n        residual_dagger = np.linalg.norm(A @ u_dagger - f)\n        norm_u_dagger = np.linalg.norm(u_dagger)\n\n        # c. Tikhonov regularized solution and its residual\n        # Solve (A^T A + alpha*I) u = A^T f\n        LHS = A.T @ A + alpha * np.identity(N)\n        RHS = A.T @ f\n        u_alpha = linalg.solve(LHS, RHS, assume_a='sym')\n        \n        residual_alpha = np.linalg.norm(A @ u_alpha - f)\n        norm_u_alpha = np.linalg.norm(u_alpha)\n\n        # Append the five diagnostics to the results list\n        results.extend([\n            S_f,\n            residual_dagger,\n            norm_u_dagger,\n            residual_alpha,\n            norm_u_alpha\n        ])\n    \n    # 7. Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}