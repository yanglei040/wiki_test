{
    "hands_on_practices": [
        {
            "introduction": "一切计算建模的基础是确保我们所构建的正向求解器能够准确地反映其所描述的物理过程。本练习将指导您从基本原理出发，为光声断层成像中的声波传播建立一个数值模型。通过采用“制造解方法”(Method of Manufactured Solutions)这一严谨的科学计算验证技术，您将能够量化并验证您所编写的求解器的收敛阶数，从而确保其计算结果的可靠性与精确性。",
            "id": "3410161",
            "problem": "考虑在小信号、无损、均匀介质假设下的光声断层成像（PAT）的标准正向模型。声压场满足线性波动方程\n$$\n\\partial_{tt} p(x,t) - c^2 \\partial_{xx} p(x,t) = 0 \\quad \\text{for } x \\in [0,L], \\ t \\ge 0,\n$$\n在空间区间上具有周期性边界条件，初始位移为 $p(x,0) = p_0(x)$，初始速度为 $\\partial_t p(x,0) = v_0(x)$。此处 $c$ 是（恒定的）声速。在光声断层成像中，由于短脉冲光照后热弹性膨胀的特性，初始压力 $p_0(x)$ 与吸收的光能密度成正比，且 $v_0(x)=0$。\n\n你将使用人造解方法来验证一个数值正向求解器。所有量都是无量纲的（没有单位）。求解器必须在空间和时间上都达到二阶精度。你必须从基本守恒定律和本构关系（质量守恒、动量守恒和线性状态方程）出发进行推导，而不是从预先推导的离散化公式开始。\n\n人造解：\n\n1) 齐次波动方程：选择一个光滑周期解\n$$\np(x,t) = \\sin(k x)\\cos(c k t),\n$$\n其中 $k = 2\\pi m$，$m$ 是一个正整数。这个解满足初始数据为 $p(x,0) = \\sin(k x)$ 和 $\\partial_t p(x,0)=0$ 的齐次波动方程。\n\n2) 强迫波动方程：为了独立于空间离散误差来分离时间收敛性，使用一个空间均匀的人造解\n$$\np(x,t) = \\cos(\\omega t),\n$$\n它满足\n$$\n\\partial_{tt} p(x,t) - c^2 \\partial_{xx} p(x,t) = S(x,t),\n$$\n其中人造源项为\n$$\nS(x,t) = -\\omega^2 \\cos(\\omega t).\n$$\n使用初始数据 $p(x,0)=\\cos(0)=1$ 和 $\\partial_t p(x,0)=0$。\n\n你的任务：\n\n- 从基本声学方程推导出，对于PAT，压力场满足上述给定的波动方程和初始数据。\n\n- 构建一个在一维空间上具有周期性边界条件的、相容的二阶精度数值方法。该方法必须是时间显式的，并且在应用于光滑数据时，在空间和时间上都具有二阶精度。使用一个具有 $N$ 个点的固定空间网格和均匀的时间步长 $\\Delta t$。最终时间 $T$ 必须可以精确地表示为 $\\Delta t$ 的整数倍。\n\n- 实现该求解器，使其既能处理齐次方程，也能处理带有通用源项 $S(x,t)$ 的强迫方程，并且支持上述初始条件。程序必须计算在时间 $T$ 时的解，并将其与精确的人造解进行比较以产生误差。\n\n- 使用由以下公式定义的离散 $L^2$ 误差\n$$\nE = \\left( \\sum_{i=0}^{N-1} \\left[p_i^{\\mathrm{num}}(T) - p^{\\mathrm{exact}}(x_i,T)\\right]^2 \\Delta x \\right)^{1/2},\n$$\n其中 $\\Delta x = L/N$ 且 $x_i = i \\Delta x$。\n\n- 经验收敛率：给定两个误差 $E_1$ 和 $E_2$，它们对应于将相关步长（例如，将 $\\Delta x$ 或 $\\Delta t$ 减半，因此 $r=2$）加密因子 $r$ 后得到的结果，计算观测阶数\n$$\nq = \\frac{\\log(E_1/E_2)}{\\log(r)}.\n$$\n\n测试套件和要求输出：\n\n实现以下测试套件，每个测试产生一个浮点数误差，并在适用时产生一个经验阶数。所有量都是无量纲的。\n\n- 测试A（空间收敛主导）：齐次情况，参数为 $c=1$, $L=1$, $m=3$, $k=2\\pi m$，最终时间 $T=0.01$。使用三个网格，其中 $N \\in \\{50, 100, 200\\}$。对于时间步进，选择 $\\Delta t = \\alpha (\\Delta x)^2$，其中 $\\alpha=0.2$。这确保了在这些分辨率下，时间截断误差相对于空间截断误差可以忽略不计。计算每个 $N$ 的离散 $L^2$ 误差 $E_N$，然后使用以下公式计算观测阶数 $q_{\\text{space}} = \\frac{1}{2}\\left( \\frac{\\log(E_{50}/E_{100})}{\\log 2} + \\frac{\\log(E_{100}/E_{200})}{\\log 2} \\right)$。\n\n- 测试B（仅通过人造源测试时间收敛）：强迫情况，参数为 $c=1$, $L=1$，空间均匀的人造解 $p(x,t)=\\cos(\\omega t)$，$\\omega=7$。使用固定的空间网格 $N=64$（这样常数场的空间拉普拉斯算子在周期性网格上精确为零，从而消除空间误差）。最终时间 $T=0.2$。使用三个时间步长 $\\Delta t \\in \\{0.02, 0.01, 0.005\\}$，每个步长的选择都确保 $T$ 是 $\\Delta t$ 的整数倍。计算离散 $L^2$ 误差 $E_{\\Delta t}$ 和观测到的时间阶数\n$$\nq_{\\text{time}} = \\frac{1}{2}\\left( \\frac{\\log(E_{0.02}/E_{0.01})}{\\log 2} + \\frac{\\log(E_{0.01}/E_{0.005})}{\\log 2} \\right).\n$$\n\n- 测试C（边界情况一致性）：齐次情况，参数与测试A相同，但 $T=0$。数值解必须等于初始条件，因此离散 $L^2$ 误差必须在数值上为零。以布尔值的形式报告误差是否小于容差 $\\varepsilon=10^{-12}$。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n- 来自测试A的观测空间收敛阶数 $q_{\\text{space}}$（浮点数）。\n- 来自测试B的观测时间收敛阶数 $q_{\\text{time}}$（浮点数）。\n- 一个布尔值，指示 $q_{\\text{space}} \\ge 1.8$ 是否成立。\n- 一个布尔值，指示 $q_{\\text{time}} \\ge 1.8$ 是否成立。\n- 来自测试C的一个布尔值，指示 $T=0$ 时的误差是否小于 $\\varepsilon$。\n\n例如，输出格式必须与 \"[2.01,1.99,True,True,True]\" 完全相同。\n\n所有计算量均为无量纲。三角函数中出现的角度以弧度为单位。观测阶数的最终答案必须打印为普通十进制浮点数（而非百分比），布尔值必须是Python风格的True或False。",
            "solution": "该问题是有效的。它提出了计算物理学中一个适定的、有科学依据的任务：推导、实现并验证一个用于光声断层成像（PAT）正向模型的一维声学波动方程的数值求解器。使用人造解方法进行验证是科学计算中的一种标准且严谨的方法。所有参数和测试用例都定义清晰，并且在物理上和数值上都是一致的。\n\n### 1. 控制方程的推导\n\n流体中声波的行为由质量和动量守恒的基本原理以及一个关联压力和密度的状态方程来描述。对于小信号假设下的无损、均匀介质，这些原理表示为线性化声学方程。在一维空间 $x$ 中，它们是：\n\n1.  **质量守恒（连续性方程）：** 该原理指出，一个体积内质量的变化率等于流入该体积的净质量通量。对于小扰动，它线性化为：\n    $$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_a \\frac{\\partial v}{\\partial x} = 0 $$\n    此处，$\\rho'(x,t)$ 是声学密度扰动， $v(x,t)$ 是流体质点速度，而 $\\rho_a$ 是环境流体密度。\n\n2.  **动量守恒（欧拉方程）：** 这是牛顿第二定律应用于流体元。由压力梯度产生的净力使流体加速。其线性化形式为：\n    $$ \\rho_a \\frac{\\partial v}{\\partial t} = -\\frac{\\partial p}{\\partial x} $$\n    此处，$p(x,t)$ 是声压。\n\n3.  **状态方程：** 对于一个快速的声学过程（近似为绝热过程），压力和密度是相关的。对于小扰动，这种关系是线性的：\n    $$ p = c^2 \\rho' $$\n    比例常数 $c^2$ 由介质的属性定义，其中 $c$ 是声速，由 $c = \\sqrt{(\\partial P / \\partial \\rho)_S}$ 在环境条件下求值得到。\n\n为了推导压力 $p$ 的波动方程，我们将这三个方程结合起来。首先，我们对动量方程求关于 $x$ 的导数，对连续性方程求关于 $t$ 的导数：\n$$ \\rho_a \\frac{\\partial^2 v}{\\partial t \\partial x} = -\\frac{\\partial^2 p}{\\partial x^2} $$\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_a \\frac{\\partial^2 v}{\\partial x \\partial t} = 0 $$\n假设函数足够光滑，微分的顺序无关紧要（$\\partial_{tx}v = \\partial_{xt}v$）。我们可以将第一个方程中 $\\rho_a \\partial_{tx}v$ 的表达式代入第二个方程：\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} + \\left( -\\frac{\\partial^2 p}{\\partial x^2} \\right) = 0 \\implies \\frac{\\partial^2 \\rho'}{\\partial t^2} = \\frac{\\partial^2 p}{\\partial x^2} $$\n现在，使用状态方程，我们将 $\\rho'$ 替换为 $p/c^2$。由于 $c$ 是一个常数，我们可以写出 $\\partial_{tt}\\rho' = (1/c^2) \\partial_{tt}p$。代入此式可得：\n$$ \\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} = \\frac{\\partial^2 p}{\\partial x^2} $$\n重新整理后得到标准的齐次线性波动方程：\n$$ \\frac{\\partial^2 p}{\\partial t^2} - c^2 \\frac{\\partial^2 p}{\\partial x^2} = 0 $$\n在光声断层成像中，组织被短激光脉冲照射。吸收的能量导致快速的局部加热和热弹性膨胀，从而产生一个初始压力分布 $p(x,0) = p_0(x)$。因为假定这个过程发生在任何显著的物质运动之前，所以初始流体速度为零，即 $v(x,0)=0$。从连续性方程和状态方程，我们有 $\\partial_t p = c^2 \\partial_t \\rho' = -c^2 \\rho_a \\partial_x v$。在 $t=0$ 时求值，我们得到 $\\partial_t p(x,0) = -c^2 \\rho_a \\partial_x v(x,0)$。由于对所有 $x$ 都有 $v(x,0)=0$，其空间导数也为零，这导致了初始条件 $\\partial_t p(x,0) = 0$。\n\n### 2. 数值离散化\n\n我们的任务是为波动方程构建一个二阶精度的显式有限差分格式，可能包含一个源项 $S(x,t)$：\n$$ \\partial_{tt} p - c^2 \\partial_{xx} p = S(x,t) $$\n我们定义一个离散网格，网格点为 $(x_i, t_n)$，其中 $x_i = i \\Delta x$（$i=0, \\dots, N-1$），$t_n = n \\Delta t$。在这些点上的数值解记为 $p_i^n \\approx p(x_i, t_n)$。\n\n使用中心差分可以得到空间和时间导数的二阶精度近似：\n$$ \\partial_{xx} p \\bigg|_{(x_i, t_n)} \\approx \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^2} + \\mathcal{O}((\\Delta x)^2) $$\n$$ \\partial_{tt} p \\bigg|_{(x_i, t_n)} \\approx \\frac{p_i^{n+1} - 2p_i^n + p_i^{n-1}}{(\\Delta t)^2} + \\mathcal{O}((\\Delta t)^2) $$\n将这些代入波动方程得到离散形式：\n$$ \\frac{p_i^{n+1} - 2p_i^n + p_i^{n-1}}{(\\Delta t)^2} - c^2 \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^2} = S_i^n $$\n对下一个时间步的压力 $p_i^{n+1}$ 求解，得到显式时间推进公式：\n$$ p_i^{n+1} = 2p_i^n - p_i^{n-1} + \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 (p_{i+1}^n - 2p_i^n + p_{i-1}^n) + (\\Delta t)^2 S_i^n $$\n这是一个三层格式，需要来自前两个时间层 $t_n$ 和 $t_{n-1}$ 的数据。为保证数值稳定性，必须满足 Courant-Friedrichs-Lewy (CFL) 条件：$\\sigma = c\\Delta t/\\Delta x \\le 1$。\n\n为了启动模拟，我们需要 $p^0$ 和 $p^1$。初始条件 $p(x,0)=p_0(x)$ 给出 $p_i^0 = p_0(x_i)$。为了在保持二阶精度的同时找到 $p_i^1$，我们使用初始条件 $\\partial_t p(x,0) = 0$。在 $t=0$ 时，该导数的二阶中心差分为 $(\\frac{p_i^1 - p_i^{-1}}{2\\Delta t}) = 0$，这意味着 $p_i^1 = p_i^{-1}$。将此代入 $n=0$ 时的通用格式：\n$$ p_i^1 = 2p_i^0 - p_i^{-1} + \\sigma^2 (p_{i+1}^0 - 2p_i^0 + p_{i-1}^0) + (\\Delta t)^2 S_i^0 $$\n$$ p_i^1 = 2p_i^0 - p_i^1 + \\sigma^2 (p_{i+1}^0 - 2p_i^0 + p_{i-1}^0) + (\\Delta t)^2 S_i^0 $$\n对 $p_i^1$ 求解，得到二阶精度的启动公式：\n$$ p_i^1 = p_i^0 + \\frac{1}{2} \\sigma^2 (p_{i+1}^0 - 2p_i^0 + p_{i-1}^0) + \\frac{1}{2}(\\Delta t)^2 S_i^0 $$\n在 $[0,L]$ 上的周期性边界条件意味着 $p(x,t) = p(x+L,t)$，这在离散网格上意味着 $p_N^n = p_0^n$ 和 $p_{-1}^n = p_{N-1}^n$。这些可以通过对索引进行模运算来处理。\n\n### 3. 验证策略\n\n该数值求解器使用人造解方法和一套测试用例进行验证。\n- **测试A（空间收敛）：** 使用具有光滑正弦初始条件的齐次情况。时间步长选择为 $\\Delta t = \\alpha (\\Delta x)^2$，其中 $\\alpha=0.2$ 是一个小数。这使得随 $(\\Delta t)^2$ 变化的时间截断误差远小于随 $(\\Delta x)^2$ 变化的空间误差。该测试有效地分离并测量了空间精度阶数。对于我们的格式，我们期望误差 $E$ 按 $(\\Delta x)^2$ 的比例变化，所以观测到的阶数 $q_{\\text{space}}$ 应该接近于2。\n- **测试B（时间收敛）：** 使用具有空间均匀人造解 $p(x,t) = \\cos(\\omega t)$ 的强迫情况。由于解和源项在空间上是常数，离散空间拉普拉斯项 $(p_{i+1}^n - 2p_i^n + p_{i-1}^n)$ 在所有时间步上都恒等于零。这完全消除了空间离散误差，从而分离出时间误差。这也绕过了CFL稳定性约束，因为格式中导致不稳定性的部分被置为零。我们期望误差 $E$ 按 $(\\Delta t)^2$ 的比例变化，所以观测到的阶数 $q_{\\text{time}}$ 应该接近于2。\n- **测试C（一致性检查）：** 此测试在 $T=0$ 时对求解器进行测试。数值解必须就是初始条件，误差应该为零（或在机器精度范围内）。这是对实现的一个基本合理性检查。\n\n离散 $L^2$ 误差范数 $E = \\left( \\sum_{i=0}^{N-1} \\left[p_i^{\\mathrm{num}}(T) - p^{\\mathrm{exact}}(x_i,T)\\right]^2 \\Delta x \\right)^{1/2}$ 用于量化数值解和精确解之间的差异，并由此为加密因子 $r$ 计算经验收敛阶数 $q = \\log(E_1/E_2)/\\log(r)$。",
            "answer": "```python\nimport numpy as np\n\ndef wave_solver(L, N, c, T, dt, p0_func, S_func=None):\n    \"\"\"\n    Solves the 1D wave equation partial_tt p - c^2 partial_xx p = S(x,t)\n    using a second-order finite difference scheme with periodic boundary conditions.\n    \"\"\"\n    dx = L / N\n    x = np.arange(N) * dx\n\n    num_steps = int(round(T / dt))\n\n    if num_steps == 0:\n        return p0_func(x), x\n\n    # Initialize pressure fields at t=0 and t=-dt (by convention)\n    # p_curr is p^n, p_prev is p^(n-1)\n    p_curr = p0_func(x)  # p^0\n\n    # Courant number squared\n    sigma_sq = (c * dt / dx)**2\n\n    # First time step (n=0) to calculate p^1 using second-order starter.\n    # p^1 = p^0 + dt*v_0 + 0.5*dt^2*(c^2*laplacian(p^0) + S^0). Here v_0=0.\n    lap_p0 = np.roll(p_curr, -1) - 2 * p_curr + np.roll(p_curr, 1)\n    \n    S_at_0 = np.zeros(N)\n    if S_func:\n        S_at_0 = S_func(x, 0.0)\n    \n    p_next = p_curr + 0.5 * sigma_sq * lap_p0 + 0.5 * dt**2 * S_at_0\n\n    p_prev = p_curr\n    p_curr = p_next\n\n    # Main time-stepping loop (n=1 to num_steps-1)\n    for n in range(1, num_steps):\n        t = n * dt\n        \n        lap_p_curr = np.roll(p_curr, -1) - 2 * p_curr + np.roll(p_curr, 1)\n\n        S_at_t = np.zeros(N)\n        if S_func:\n            S_at_t = S_func(x, t)\n\n        p_next = 2 * p_curr - p_prev + sigma_sq * lap_p_curr + dt**2 * S_at_t\n\n        p_prev = p_curr\n        p_curr = p_next\n\n    return p_curr, x\n\ndef calculate_l2_error(p_num, p_exact, dx):\n    \"\"\"Calculates the discrete L2 error.\"\"\"\n    return np.sqrt(np.sum((p_num - p_exact)**2) * dx)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    results = []\n\n    # --- Test A: Spatial Convergence ---\n    c_A = 1.0\n    L_A = 1.0\n    m_A = 3\n    k_A = 2 * np.pi * m_A\n    T_A = 0.01\n    alpha_A = 0.2\n    Ns_A = [50, 100, 200]\n    errors_A = []\n\n    def p0_A(x):\n        return np.sin(k_A * x)\n\n    for N_val in Ns_A:\n        dx_val = L_A / N_val\n        dt_val = alpha_A * (dx_val)**2\n        \n        p_num, x_grid = wave_solver(L_A, N_val, c_A, T_A, dt_val, p0_A)\n        p_exact = np.sin(k_A * x_grid) * np.cos(c_A * k_A * T_A)\n        \n        error = calculate_l2_error(p_num, p_exact, dx_val)\n        errors_A.append(error)\n\n    # Calculate observed order of convergence\n    q_50_100 = np.log(errors_A[0] / errors_A[1]) / np.log(2)\n    q_100_200 = np.log(errors_A[1] / errors_A[2]) / np.log(2)\n    q_space = 0.5 * (q_50_100 + q_100_200)\n    \n    results.append(q_space)\n\n    # --- Test B: Temporal Convergence ---\n    c_B = 1.0\n    L_B = 1.0\n    N_B = 64\n    omega_B = 7.0\n    T_B = 0.2\n    dts_B = [0.02, 0.01, 0.005]\n    errors_B = []\n\n    def p0_B(x):\n        return np.ones_like(x)\n\n    def S_B(x, t):\n        # x is unused since source is spatially uniform\n        return -omega_B**2 * np.cos(omega_B * t) * np.ones_like(x)\n\n    for dt_val in dts_B:\n        p_num, x_grid = wave_solver(L_B, N_B, c_B, T_B, dt_val, p0_B, S_func=S_B)\n        p_exact = np.cos(omega_B * T_B) * np.ones_like(x_grid)\n        dx_val = L_B / N_B\n        \n        error = calculate_l2_error(p_num, p_exact, dx_val)\n        errors_B.append(error)\n\n    # Calculate observed order of convergence\n    q_1 = np.log(errors_B[0] / errors_B[1]) / np.log(2)\n    q_2 = np.log(errors_B[1] / errors_B[2]) / np.log(2)\n    q_time = 0.5 * (q_1 + q_2)\n\n    results.append(q_time)\n\n    # --- Append boolean checks for Test A and B ---\n    results.append(q_space >= 1.8)\n    results.append(q_time >= 1.8)\n\n    # --- Test C: Edge Case Consistency (T=0) ---\n    N_C = 50 \n    dx_C = L_A / N_C\n    dt_C = alpha_A * dx_C**2\n    \n    p_num_C, x_grid_C = wave_solver(L_A, N_C, c_A, 0.0, dt_C, p0_A)\n    p_exact_C = p0_A(x_grid_C)\n\n    error_C = calculate_l2_error(p_num_C, p_exact_C, dx_C)\n    \n    results.append(error_C  1e-12)\n\n    # --- Final Output ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "一个成功的成像系统不仅需要精确的物理模型，还需要对数据采集的极限有深刻的理解。本练习将引导您探索成像物体的空间分辨率与探测器所需的时间采样率之间的内在联系。通过运用声波的色散关系和奈奎斯特-香农采样定理，您将推导出一个关键的设计准则，它决定了为了无失真地重建特定尺寸的特征，我们必须以多快的速度来采集光声信号。",
            "id": "3410220",
            "problem": "考虑光声断层成像（PAT），其中初始压力分布 $p_{0}(\\mathbf{x})$ 由光脉冲引起，随后在声速恒为 $c$ 的均匀、各向同性、无损介质中作为声场 $p(\\mathbf{x}, t)$ 传播。声学传播由标量波动方程控制，其初始条件为 $p(\\mathbf{x}, 0) = p_{0}(\\mathbf{x})$ 和 $\\partial_{t} p(\\mathbf{x}, 0) = 0$。位于测量表面位置 $\\mathbf{y}$ 的探测器记录时间序列 $p(\\mathbf{y}, t)$，您打算以时间采样间隔 $\\Delta t$ 对其进行均匀的时间采样。\n\n从基本原理出发，论述 $p(\\mathbf{y}, t)$ 的频率内容与 $p_{0}(\\mathbf{x})$ 的空间带宽之间的关系。具体而言：\n\n- 使用声波的色散关系，将 $p(\\mathbf{y}, t)$ 的时间频率内容与 $p_{0}(\\mathbf{x})$ 的空间波数内容联系起来。\n- 将 $p(\\mathbf{y}, t)$ 中的最大有效时间频率 $f_{\\max}$ 与 $p_{0}(\\mathbf{x})$ 中的最小特征尺寸 $\\ell$ 联系起来。\n- 使用 Nyquist–Shannon 采样定理，确定避免 $p(\\mathbf{y}, t)$ 中出现混叠的最小均匀时间采样间隔 $\\Delta t_{\\min}$。\n\n将 $\\Delta t_{\\min}$ 的最终答案表示为关于 $c$ 和 $\\ell$ 的封闭形式解析表达式。以秒为单位表示 $\\Delta t_{\\min}$。无需数值近似或四舍五入。",
            "solution": "问题要求计算在不对光声信号 $p(\\mathbf{y}, t)$ 进行采样时避免混叠所需的最小均匀时间采样间隔 $\\Delta t_{\\min}$，并用声速 $c$ 和初始压力分布 $p_{0}(\\mathbf{x})$ 的最小特征尺寸 $\\ell$ 来表示。\n\n该问题将按照提示分三步解决：\n1.  使用声学波动方程的色散关系建立时间频率和空间频率之间的关系。\n2.  将测量信号中的最大时间频率 $f_{\\max}$ 与初始源中的最小特征尺寸 $\\ell$ 联系起来。\n3.  应用 Nyquist–Shannon 采样定理确定所需的采样间隔。\n\n首先，在均匀、各向同性、无损介质中，声压场 $p(\\mathbf{x}, t)$ 的传播由标量波动方程控制：\n$$ \\nabla^2 p(\\mathbf{x}, t) - \\frac{1}{c^2} \\frac{\\partial^2 p(\\mathbf{x}, t)}{\\partial t^2} = 0 $$\n其中 $c$ 是恒定的声速。为了分析频率内容，我们考虑一个平面波解，形式为 $p(\\mathbf{x}, t) = A \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))$，其中 $\\mathbf{k}$ 是空间波数矢量，$\\omega$ 是时间角频率。将其代入波动方程得到：\n$$ \\nabla^2 (A e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}) = (i\\mathbf{k}) \\cdot (i\\mathbf{k}) (A e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}) = -|\\mathbf{k}|^2 p(\\mathbf{x}, t) $$\n$$ \\frac{\\partial^2}{\\partial t^2} (A e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}) = (-i\\omega)^2 (A e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}) = -\\omega^2 p(\\mathbf{x}, t) $$\n因此，波动方程变为：\n$$ -|\\mathbf{k}|^2 p(\\mathbf{x}, t) - \\frac{1}{c^2} (-\\omega^2 p(\\mathbf{x}, t)) = 0 $$\n对于非平凡解（$p(\\mathbf{x}, t) \\neq 0$），系数必须为零：\n$$ -|\\mathbf{k}|^2 + \\frac{\\omega^2}{c^2} = 0 $$\n这就得到了该介质中声波的色散关系：\n$$ \\omega^2 = c^2 |\\mathbf{k}|^2 $$\n由于物理频率是非负的，我们取正根：\n$$ \\omega = c |\\mathbf{k}| $$\n这个基本关系直接将波分量的时间角频率 $\\omega$ 与其空间波数的大小 $|\\mathbf{k}|$ 联系起来。这意味着传播波场 $p(\\mathbf{x}, t)$ 的时间频率内容完全由初始压力分布 $p_{0}(\\mathbf{x})$ 的空间频率（波数）内容决定。\n\n第二，我们将测量信号 $p(\\mathbf{y}, t)$ 中的最大有效时间频率 $f_{\\max}$ 与初始压力分布 $p_{0}(\\mathbf{x})$ 中的最小特征尺寸 $\\ell$ 联系起来。最小特征尺寸 $\\ell$ 决定了其表示所需的最高空间频率。在信号处理和成像中，空间分辨率 $\\ell$ 与所需的最大空间波数 $k_{\\max} = |\\mathbf{k}|_{\\max}$ 相关。一个源于空间采样定理的标准惯例将分辨率极限定义为最高频率分量波长的一半。空间波长 $\\lambda_{\\text{sp}}$ 通过 $\\lambda_{\\text{sp}} = 2\\pi/k$ 与波数 $k$ 相关。因此，最小波长 $\\lambda_{\\text{sp, min}}$ 对应于最大波数 $k_{\\max}$。关系式为：\n$$ \\ell = \\frac{\\lambda_{\\text{sp, min}}}{2} = \\frac{1}{2} \\frac{2\\pi}{k_{\\max}} = \\frac{\\pi}{k_{\\max}} $$\n由此，我们可以将初始压力分布 $p_{0}(\\mathbf{x})$ 中的最大有效空间波数表示为：\n$$ k_{\\max} = \\frac{\\pi}{\\ell} $$\n使用色散关系 $\\omega = c |\\mathbf{k}|$，传播波中的最大时间角频率 $\\omega_{\\max}$ 由 $k_{\\max}$ 决定：\n$$ \\omega_{\\max} = c k_{\\max} = c \\frac{\\pi}{\\ell} $$\n最大时间频率 $f_{\\max}$ 通过 $\\omega_{\\max} = 2\\pi f_{\\max}$ 与角频率相关。因此：\n$$ 2\\pi f_{\\max} = c \\frac{\\pi}{\\ell} $$\n$$ f_{\\max} = \\frac{c}{2\\ell} $$\n\n第三，我们应用 Nyquist–Shannon 采样定理来找到所需的采样间隔。该定理指出，为避免混叠，信号的采样频率 $f_s$ 必须至少是其最大频率分量 $f_{\\max}$ 的两倍。\n$$ f_s \\ge 2 f_{\\max} $$\n采样间隔 $\\Delta t$ 是采样频率的倒数，即 $\\Delta t = 1/f_s$。将此代入不等式，得到采样间隔的条件：\n$$ \\frac{1}{\\Delta t} \\ge 2 f_{\\max} \\implies \\Delta t \\le \\frac{1}{2 f_{\\max}} $$\n问题要求的是“最小”采样间隔 $\\Delta t_{\\min}$。在 Nyquist 准则的背景下，这被解释为对应于避免混叠的最小采样率（即 Nyquist 率 $f_s = 2f_{\\max}$）的采样间隔。这对应于允许的最大采样间隔。任何小于此值的间隔也能避免混叠，但会构成过采样。充分采样的临界情况是：\n$$ \\Delta t_{\\max} = \\frac{1}{2 f_{\\max}} $$\n代入我们对 $f_{\\max}$ 的表达式：\n$$ \\Delta t_{\\max} = \\frac{1}{2 \\left( \\frac{c}{2\\ell} \\right)} = \\frac{1}{\\frac{c}{\\ell}} $$\n这简化为最大采样间隔的最终表达式：\n$$ \\Delta t_{\\max} = \\frac{\\ell}{c} $$\n这个表达式的单位是（长度）/（长度/时间）= 时间，这对于采样间隔是正确的。从物理上看，这个结果表明采样间隔不能大于声音传播等于物体中最小特征尺寸的距离所需的时间。这是解析该特征的一个直观且基本的要求。尽管问题要求$\\Delta t_{\\min}$，但从物理和信号处理的角度来看，它指的是避免混叠所允许的最大采样间隔。因此，我们提供的答案是这个临界值。",
            "answer": "$$\\boxed{\\frac{\\ell}{c}}$$"
        }
    ]
}