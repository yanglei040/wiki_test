{
    "hands_on_practices": [
        {
            "introduction": "盲反卷积的核心挑战在于其固有的不适定性——仅从观测数据出发，通常无法唯一确定信号 $x$ 和模糊核 $k$。本练习将通过一个简洁的实例，直观地揭示这一难题。您将发现，即使施加了非负性这样看似合理的约束，解的模糊性依然存在，从而产生多个与观测完全一致的可能解。此练习的第二部分将引导您探索如何通过引入更强的、具有物理意义的先验知识（例如针对点扩散函数的凸约束）来消除这种模糊性，并获得唯一的、有意义的解。",
            "id": "3369032",
            "problem": "考虑有限支撑序列上的一维无噪声离散盲反卷积模型，其中观测值为 $y = x * k$，并且 $x \\in \\mathbb{R}_{\\ge 0}^{2}$，$k \\in \\mathbb{R}_{\\ge 0}^{2}$，$*$ 表示离散卷积。卷积定义为 $y_{j} = \\sum_{i} x_{i} k_{j-i}$，其中支撑范围外的索引值被视为零。假设测量数据为 $y = [2, 5, 2]$，它被解释为两个长度为2的序列 $x = [x_{0}, x_{1}]$ 和 $k = [k_{0}, k_{1}]$ 的完全线性卷积。利用离散卷积是双线性和交换性的基本事实，以及非负约束是凸的这一性质，完成以下任务：构建一个反事实，证明仅施加 $x \\ge 0$ 和 $k \\ge 0$ 的约束条件，存在与 $y$ 一致的多个解。然后，对 $k$ 提出额外的、对于点扩散函数（PSF）而言在科学上是现实的凸约束，例如和为一约束 $\\sum_{i} k_{i} = 1$ 和单调性约束 $k_{0} \\ge k_{1}$，并解释为什么这些约束是凸的。在这些约束下，确定能通过 $y = x * k$ 精确再现 $y$ 的唯一 $(x, k)$ 对。将您的最终答案表示为一个单行矩阵，其中按顺序包含 $x_{0}$、$x_{1}$、$k_{0}$、$k_{1}$。不需要四舍五入，也不涉及单位。",
            "solution": "该问题是有效的，因为它在盲反卷积这一成熟领域具有科学依据，在添加标准约束后是良定的，并且使用客观、正式的语言表述。我们可以着手求解。\n\n序列 $x = [x_{0}, x_{1}]$ 和序列 $k = [k_{0}, k_{1}]$ 的一维离散卷积由 $y = x * k$ 给出。得到的序列 $y$ 的长度为 $2+2-1 = 3$。$y$ 的分量为：\n$$y_{0} = x_{0}k_{0}$$\n$$y_{1} = x_{0}k_{1} + x_{1}k_{0}$$\n$$y_{2} = x_{1}k_{1}$$\n给定测量数据 $y = [2, 5, 2]$，我们建立以下非线性方程组：\n$$\n\\begin{cases}\nx_{0}k_{0} = 2  (1) \\\\\nx_{0}k_{1} + x_{1}k_{0} = 5  (2) \\\\\nx_{1}k_{1} = 2  (3)\n\\end{cases}\n$$\n问题最初只施加非负约束：$x_{0}, x_{1}, k_{0}, k_{1} \\ge 0$。\n\n首先，我们构建一个反事实来证明仅凭这些约束不足以保证唯一解。\n从方程 $(1)$ 和 $(3)$ 可以看出 $x_{0}k_{0} = x_{1}k_{1} = 2$。由于 $y_{0}=2$ 和 $y_{2}=2$，所以 $x_{0}, x_{1}, k_{0}, k_{1}$ 都不能为零。我们可以用 $k_{0}$ 和 $k_{1}$ 来表示 $x_{0}$ 和 $x_{1}$：\n$$x_{0} = \\frac{2}{k_{0}}$$\n$$x_{1} = \\frac{2}{k_{1}}$$\n将这些代入方程 $(2)$：\n$$\\left(\\frac{2}{k_{0}}\\right)k_{1} + \\left(\\frac{2}{k_{1}}\\right)k_{0} = 5$$\n两边乘以 $k_{0}k_{1}$（非零）得到：\n$$2k_{1}^{2} + 2k_{0}^{2} = 5k_{0}k_{1}$$\n两边除以 $k_{1}^{2}$（也非零）得到一个关于比率 $r = k_{0}/k_{1}$ 的二次方程：\n$$2\\left(\\frac{k_{0}}{k_{1}}\\right)^{2} - 5\\left(\\frac{k_{0}}{k_{1}}\\right) + 2 = 0$$\n$$2r^2 - 5r + 2 = 0$$\n对这个二次方程进行因式分解，我们得到 $(2r-1)(r-2) = 0$。两个可能的根是 $r=2$ 和 $r=1/2$。这意味着对于核 $k$ 存在两族解。\n\n情况 A：$k_{0}/k_{1} = 2$。\n让我们为 $k$ 选择一个尺度。例如，令 $k_{1}=1$。那么 $k_{0}=2$，所以 $k = [2, 1]$。\n对应的信号 $x$ 计算如下：$x_{0} = 2/k_{0} = 2/2 = 1$ 和 $x_{1} = 2/k_{1} = 2/1 = 2$。所以 $x = [1, 2]$。\n这给出了一个解对 $(x, k) = ([1, 2], [2, 1])$。$x$ 和 $k$ 都满足非负约束。快速检验可验证 $x*k = [1, 2] * [2, 1] = [2, 1 \\cdot 1 + 2 \\cdot 2, 2] = [2, 5, 2]$。\n\n情况 B：$k_{0}/k_{1} = 1/2$。\n让我们再次选择一个尺度，比如令 $k_{1}=2$。那么 $k_{0}=1$，所以 $k=[1, 2]$。\n对应的信号 $x$ 为 $x_{0} = 2/k_{0} = 2/1 = 2$ 和 $x_{1} = 2/k_{1} = 2/2 = 1$。所以 $x = [2, 1]$。\n这给出了第二个解对 $(x, k) = ([2, 1], [1, 2])$。这个解也满足非负约束，并得到相同的观测值 $y$。\n\n由于我们找到了至少两个不同的解 $([1, 2], [2, 1])$ 和 $([2, 1], [1, 2])$，我们证明了在仅有非负约束的情况下，问题的解不是唯一的。\n\n接下来，我们对模糊核 $k$（通常解释为点扩散函数 PSF）提出额外的凸约束。科学上符合实际的 PSF 通常被归一化以保持能量守恒，并且通常在中心处达到峰值。\n1.  **和为一约束**：$\\sum_{i} k_{i} = k_{0} + k_{1} = 1$。这强制了能量守恒。\n2.  **单调性约束**：$k_{0} \\ge k_{1}$。这模拟了一个以原点为中心或从原点开始衰减的 PSF。\n\n这些约束是凸的。如果一个集合中的任意两点，连接它们的线段也完全包含在该集合内，那么定义该集合的约束就是凸的。\n- 对于约束 $k_{0} + k_{1} = 1$，令 $k_{a}$ 和 $k_{b}$ 是满足该约束的两个向量。对于任意 $\\lambda \\in [0, 1]$，其凸组合 $k_{c} = \\lambda k_{a} + (1-\\lambda)k_{b}$ 的分量之和为 $\\sum (k_{c})_i = \\lambda \\sum (k_{a})_i + (1-\\lambda) \\sum (k_{b})_i = \\lambda(1) + (1-\\lambda)(1) = 1$。满足此约束的点集是一个仿射子空间，它是凸的。\n- 对于约束 $k_{0} \\ge k_{1}$，即 $k_{0} - k_{1} \\ge 0$，令 $k_{a}$ 和 $k_{b}$ 满足该约束。其凸组合 $k_{c}$ 的分量满足 $(k_{c})_{0} - (k_{c})_{1} = \\lambda((k_{a})_{0}-(k_{a})_{1}) + (1-\\lambda)((k_{b})_{0}-(k_{b})_{1})$。由于 $\\lambda \\ge 0$，$1-\\lambda \\ge 0$，$(k_{a})_{0}-(k_{a})_{1} \\ge 0$ 且 $(k_{b})_{0}-(k_{b})_{1} \\ge 0$，结果是非负的。这证实了 $(k_{c})_{0} \\ge (k_{c})_{1}$。该约束定义了一个闭半空间，它是一个凸集。\n\n这些凸集与非负象限（$k_{0} \\ge 0, k_{1} \\ge 0$）的交集为 $k$ 定义了一个凸可行集。现在，我们应用这些新约束来寻找唯一解。\n\n我们重新审视从代数系统中导出的两种情况。\n情况 A: $k_{0} = 2k_{1}$。\n应用和为一约束：$2k_{1} + k_{1} = 1 \\implies 3k_{1} = 1 \\implies k_{1} = 1/3$。\n这给出 $k_{0} = 2/3$。候选核为 $k = [2/3, 1/3]$。\n让我们检查 $k$ 上的所有约束：\n- $k_{0} = 2/3 \\ge 0$, $k_{1} = 1/3 \\ge 0$ (非负性：满足)。\n- $k_{0} + k_{1} = 2/3 + 1/3 = 1$ (和为一：满足)。\n- $k_{0} \\ge k_{1} \\implies 2/3 \\ge 1/3$ (单调性：满足)。\n这种情况是有效的。我们找到对应的信号 $x$：\n$x_{0} = 2/k_{0} = 2/(2/3) = 3$。\n$x_{1} = 2/k_{1} = 2/(1/3) = 6$。\n信号为 $x = [3, 6]$。非负约束 $x_{0} \\ge 0$ 和 $x_{1} \\ge 0$ 得到满足。\n因此，$(x, k) = ([3, 6], [2/3, 1/3])$ 是一个有效的解。\n\n情况 B: $k_{0} = k_{1}/2$。\n应用和为一约束：$k_{1}/2 + k_{1} = 1 \\implies (3/2)k_{1} = 1 \\implies k_{1} = 2/3$。\n这给出 $k_{0} = (1/2)(2/3) = 1/3$。候选核为 $k = [1/3, 2/3]$。\n让我们检查单调性约束：$k_{0} \\ge k_{1} \\implies 1/3 \\ge 2/3$。这是不成立的。\n因此，这种情况被所施加的约束排除了。\n\n满足所有方程和约束的唯一解是在情况 A 中找到的解。唯一解是 $x_{0}=3$，$x_{1}=6$，$k_{0}=2/3$，$k_{1}=1/3$。\n最终答案要求以单行矩阵的形式给出，按顺序包含 $x_{0}$、$x_{1}$、$k_{0}$、$k_{1}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  6  \\frac{2}{3}  \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "上一个练习展示了通过对模糊核 $k$ 施加约束来确保解的唯一性。然而，另一条同样强大且富有成效的路径是利用信号 $x$ 自身的结构先验。本练习将引导您探索当信号 $x$ 是稀疏的（即大部分为零）这一常见假设时，盲反卷积的可辨识性问题。通过从第一性原理出发进行分析，您将推导出一个关于稀疏信号非零元素之间最小间隔 $\\Delta$ 的精确数学条件，一旦满足该条件，信号 $x$ 和模糊核 $k$ 就能被唯一地确定。这个练习揭示了信号的几何属性与逆问题可解性之间的深刻联系。",
            "id": "3369057",
            "problem": "考虑在零填充下进行线性卷积的离散时间、有限长度实数序列。令 $n \\in \\mathbb{N}$ 足够大，使得在下文的分析中可以忽略边界效应。你观察到\n$$\ny = k * x + \\eta,\n$$\n其中 $k \\in \\mathbb{R}^{n}$ 是一个具有紧支撑的未知模糊核，$x \\in \\mathbb{R}^{n}$ 是一个未知的 $k$-稀疏信号，$\\eta \\in \\mathbb{R}^{n}$ 是加性噪声。为进行可辨识性分析，假设数据无噪声，即 $\\eta = 0$。为了消除平凡的尺度和平移模糊性，我们施加一个规范，要求\n$$\n\\operatorname{supp}(k) \\subseteq \\{0,1,\\dots,s-1\\} \\quad \\text{和} \\quad k[0] = 1,\n$$\n对于一个已知的支撑大小 $s \\in \\mathbb{N}$ 且 $s \\geq 2$。信号 $x$ 是 $k$-稀疏的，其支撑集为 $T \\subset \\{0,1,\\dots,n-1\\}$，最小间隔为\n$$\n\\Delta = \\min_{\\substack{t,t' \\in T\\\\ t \\neq t'}} |t - t'|,\n$$\n使得 $x$ 的任意两个非零项的索引至少相隔 $\\Delta$。\n\n仅从线性卷积的定义、支撑集的概念以及上述规范出发，分析在何种情况下 $(k,x)$ 可以从 $y$ 中辨识，即前向映射 $(k,x) \\mapsto y$ 在该模型类上是单射的。具体来说：\n- 从第一性原理出发，推导一个阈值 $\\Delta_{\\star} = \\Delta_{\\star}(s)$，使得当 $\\Delta \\geq \\Delta_{\\star}$ 时，$(k,x)$ 在所述规范下由 $y$ 唯一确定。\n- 通过构建一个当间隔条件被违反时破坏可辨识性的显式反例，来证明你所给出的阈值的最小性。具体地，对于 $s=2$，$k=2$ 和 $\\Delta=1$ 的情况，构建两个满足相同规范但不同的对 $(k,x)$ 和 $(\\tilde k,\\tilde x)$，使得它们产生相同的 $y$，但 $(k,x) \\neq (\\tilde k,\\tilde x)$。\n\n以 $s$ 的闭式解析表达式报告你的阈值 $\\Delta_{\\star}$。你的最终答案必须是单个解析表达式。无需四舍五入，也没有单位。",
            "solution": "该问题要求找出稀疏信号 $x$ 的最小间隔 $\\Delta$ 需要满足什么条件，才能保证在给定滤波器 $k$ 的特定规范下，从其卷积 $y=k*x$ 中唯一地辨识出对 $(k,x)$。我们将首先推导可辨识性的一个充分条件，然后通过构建一个可辨识性失效的反例来证明其必要性（并因此证明其最小性）。\n\n设问题是为长度为 $n$ 的离散时间序列定义的。观测信号为 $y = k * x$，其中 $*$ 表示线性卷积。序列 $k \\in \\mathbb{R}^{n}$ 和 $x \\in \\mathbb{R}^{n}$ 是未知的。\n\n$(k,x)$ 的约束如下：\n1.  滤波器 $k$ 的支撑大小至多为 $s$，且 $\\operatorname{supp}(k) \\subseteq \\{0, 1, \\dots, s-1\\}$，对于一个已知的整数 $s \\geq 2$。\n2.  对 $k$ 施加一个规范：$k[0]=1$。\n3.  信号 $x$ 是 $k$-稀疏的，意味着它恰好有 $k$ 个非零项。设其支撑集为 $T = \\{t_1, t_2, \\dots, t_k\\}$，其中 $0 \\leq t_1  t_2  \\dots  t_k \\leq n-1$。\n4.  $x$ 的非零项之间的最小间隔为 $\\Delta = \\min_{i \\neq j} |t_i - t_j|$。\n\n可辨识性意味着前向映射 $(k,x) \\mapsto y$ 在允许的对的集合上是单射的。假设我们有两个不同的对 $(k,x)$ 和 $(\\tilde{k},\\tilde{x})$，它们都满足给定的约束，并产生相同的输出：\n$$\nk * x = \\tilde{k} * \\tilde{x}\n$$\n我们的目标是找到关于 $\\Delta$ 的条件，该条件强制 $(k,x) = (\\tilde{k},\\tilde{x})$。\n\n让我们分析输出 $y$ 的结构。根据卷积的定义，\n$$\ny[j] = (k * x)[j] = \\sum_{m=0}^{n-1} k[m] x[j-m]\n$$\n由于 $x$ 仅在其支撑集 $T=\\{t_1, \\dots, t_k\\}$ 上非零，我们可以将 $x$ 写成缩放后的 Dirac 脉冲之和：$x = \\sum_{i=1}^{k} x_i \\delta_{t_i}$，其中 $x_i = x[t_i]$。那么卷积为：\n$$\ny = k * \\left( \\sum_{i=1}^{k} x_i \\delta_{t_i} \\right) = \\sum_{i=1}^{k} x_i (k * \\delta_{t_i}) = \\sum_{i=1}^{k} x_i k(\\cdot - t_i)\n$$\n这表明 $y$ 是滤波器 $k$ 的 $k$ 个副本的线性组合，每个副本都按相应的位置 $t_i \\in T$ 进行移位，并按幅度 $x_i$ 进行缩放。\n\n第 $i$ 个移位副本 $k(\\cdot - t_i)$ 的支撑集是 $\\{t_i, t_i+1, \\dots, t_i+s-1\\}$，这是一个长度为 $s$ 的区间。$y$ 的支撑集是这些区间的并集：$\\operatorname{supp}(y) \\subseteq \\bigcup_{i=1}^k [t_i, t_i+s-1]$。\n\n现在，我们对最小间隔 $\\Delta$ 施加一个条件。让我们假设 $\\Delta \\geq s$。\n第 $i$ 个副本支撑的起始点与第 $(i+1)$ 个副本支撑的起始点之间的间隔是 $t_{i+1} - t_i \\geq \\Delta$。\n如果 $\\Delta \\geq s$，则 $t_{i+1} - t_i \\geq s$。\n第 $i$ 个副本的支撑在 $t_i+s-1$ 处结束。\n第 $(i+1)$ 个副本的支撑从 $t_{i+1}$ 开始。\n条件 $t_{i+1} \\geq t_i+s$ 意味着 $t_{i+1} > t_i+s-1$。\n这意味着对于所有的 $i$，支撑区间 $[t_i, t_i+s-1]$ 和 $[t_{i+1}, t_{i+1}+s-1]$ 是不相交的。\n\n在条件 $\\Delta \\geq s$ 下，输出 $y$ 是一系列 $k$ 个不相交的块。对于第一个块中的任何索引 $j \\in [t_1, t_1+s-1]$，对 $y[j]$ 的和的唯一非零贡献来自第一项，即 $i=1$：\n$$\ny[j] = x_1 k[j-t_1] \\quad \\text{对于 } j \\in \\{t_1, t_1+1, \\dots, t_1+s-1\\}\n$$\n对于 $i > 1$ 的所有其他项 $x_i k[j-t_i]$ 都为零，因为 $j-t_i  (t_1+s)-t_i \\leq (t_1+s)-t_2 \\leq (t_1+s)-(t_1+s) = 0$，所以 $j-t_i$ 在 $k$ 的支撑集之外。\n\n现在，考虑方程 $k*x = \\tilde{k} * \\tilde{x}$。设 $T=\\{t_i\\}$ 和 $\\tilde{T}=\\{\\tilde{t}_i\\}$ 分别是 $x$ 和 $\\tilde{x}$ 的支撑集。假设两者都满足间隔条件 $\\Delta \\geq s$。$y=k*x$ 的支撑集是区间 $\\bigcup_{i=1}^k [t_i, t_i+s-1]$ 的不交并。类似地，$y=\\tilde{k}*\\tilde{x}$ 的支撑集是不交并 $\\bigcup_{i=1}^k [\\tilde{t}_i, \\tilde{t}_i+s-1]$。要使它们相等，这些区间集合必须完全相同。这意味着对所有 $i=1, \\dots, k$ 都有 $t_i = \\tilde{t}_i$。因此，脉冲位置是可辨识的，即 $T = \\tilde{T}$。\n\n现在，让我们检查一下值。在第一个区间 $[t_1, t_1+s-1]$ 上：\n$$\ny[j] = x_1 k[j-t_1] \\quad \\text{和} \\quad y[j] = \\tilde{x}_1 \\tilde{k}[j-t_1]\n$$\n在第一个点 $j=t_1$ 处，我们有：\n$$\ny[t_1] = x_1 k[0] \\quad \\text{和} \\quad y[t_1] = \\tilde{x}_1 \\tilde{k}[0]\n$$\n使用规范 $k[0]=1$ 和 $\\tilde{k}[0]=1$，我们发现 $y[t_1] = x_1$ 和 $y[t_1] = \\tilde{x}_1$。这意味着 $x_1 = \\tilde{x}_1$。由于 $x_1$ 必须是非零的，我们可以用它来除。\n对于任何 $j \\in [t_1, t_1+s-1]$，我们有 $x_1 k[j-t_1] = x_1 \\tilde{k}[j-t_1]$，这意味着 $k[j-t_1] = \\tilde{k}[j-t_1]$。令 $l=j-t_1$，这意味着对于所有 $l \\in \\{0, 1, \\dots, s-1\\}$，都有 $k[l] = \\tilde{k}[l]$。这证明了 $k=\\tilde{k}$。\n\n在确定了 $k=\\tilde{k}$ 和 $T=\\tilde{T}$ 之后，原始方程变为 $k*x = k*\\tilde{x}$，或 $k*(x-\\tilde{x})=0$。在 Z 变换域中，这表示为 $K(z) (X(z) - \\tilde{X}(z)) = 0$。$k$ 的 Z 变换是 $K(z) = \\sum_{l=0}^{s-1} k[l]z^{-l}$，它是一个关于 $z^{-1}$ 的多项式。由于 $k[0]=1$，$K(z)$ 不是零多项式。多项式环是一个整环，所以如果一个乘积为零，其中一个因子必须为零。因此，$X(z) - \\tilde{X}(z) = 0$，这意味着 $X(z) = \\tilde{X}(z)$，从而 $x = \\tilde{x}$。\n\n因此，如果 $\\Delta \\geq s$，对 $(k,x)$ 是唯一可辨识的。这确立了 $\\Delta \\geq s$ 是一个充分条件。\n\n接下来，我们必须证明这个阈值是最小的。我们需要证明如果 $\\Delta  s$，可辨识性可能会失败。构造一个反例就足够了。我们选择 $\\Delta = s-1$。问题特别要求为 $s=2$，$k=2$ 和 $\\Delta=1$ 构建一个反例。这里，$\\Delta = 1 = 2-1 = s-1$，这违反了充分条件 $\\Delta \\geq s$。\n\n令 $(k,x)$ 和 $(\\tilde{k},\\tilde{x})$ 为两个不同的对。\n对于 $s=2$，滤波器 $k$ 的支撑在 $\\{0,1\\}$ 中。规范给出 $k=[1, k_1]$。\n对于 $k=2, \\Delta=1$，信号 $x$ 有两个相邻的非零项。不失一般性，设支撑集为 $T=\\{0,1\\}$。所以 $x$ 有非零项 $x_0 = x[0]$ 和 $x_1 = x[1]$。\n\n我们要求 $k*x = \\tilde{k}*\\tilde{x}$。让我们在多项式域中分析这个问题（对于有限信号，这等价于 Z 变换）。\n设 $K(z) = 1 + k_1 z^{-1}$ 和 $X(z) = x_0 + x_1 z^{-1}$。\n输出是 $Y(z) = K(z)X(z) = (1+k_1 z^{-1})(x_0+x_1 z^{-1})$。\n\n我们寻找一个不同的因式分解 $Y(z) = \\tilde{K}(z)\\tilde{X}(z)$，其中 $\\tilde{K}(z)$ 和 $\\tilde{X}(z)$ 对应于一个有效的对 $(\\tilde{k},\\tilde{x})$。\n$Y(z) = x_0 + (x_1+k_1 x_0) z^{-1} + k_1 x_1 z^{-2}$。\n多项式乘积中一个已知的模糊性是交换因子。我们可以将 $X(z)$ 写为 $x_0(1 + \\frac{x_1}{x_0} z^{-1})$。那么 $Y(z) = x_0 (1+k_1 z^{-1})(1+\\frac{x_1}{x_0} z^{-1})$。\n让我们通过交换多项式因子来定义一个新的对：\n$$\n\\tilde{K}(z) = 1 + \\frac{x_1}{x_0} z^{-1}\n$$\n$$\n\\tilde{X}(z) = x_0(1 + k_1 z^{-1}) = x_0 + x_0 k_1 z^{-1}\n$$\n根据构造，$\\tilde{K}(z)\\tilde{X}(z) = Y(z)$。现在我们检查 $(\\tilde{k},\\tilde{x})$ 是否是一个有效且不同的对。\n\n从 $\\tilde{K}(z)$，我们得到 $\\tilde{k} = [1, x_1/x_0]$。这满足规范 $\\tilde{k}[0]=1$ 且 $\\operatorname{supp}(\\tilde{k}) \\subseteq \\{0,1\\}$，这对于 $s=2$ 是有效的。\n从 $\\tilde{X}(z)$，我们得到 $\\tilde{x}$，其在位置 $\\{0,1\\}$ 的非零项为 $\\tilde{x}_0 = x_0$ 和 $\\tilde{x}_1 = x_0 k_1$。这是一个间隔为 $\\Delta=1$ 的 2-稀疏信号，对于 $k=2, \\Delta=1$ 是有效的。\n\n如果 $k \\neq \\tilde{k}$ 或 $x \\neq \\tilde{x}$，则对 $(\\tilde{k},\\tilde{x})$ 与 $(k,x)$ 是不同的。\n$k = \\tilde{k} \\implies [1, k_1] = [1, x_1/x_0] \\implies k_1 = x_1/x_0$。\n$x = \\tilde{x} \\implies$ 项 $(x_0, x_1)$ 等于 $(\\tilde{x}_0, \\tilde{x}_1) = (x_0, x_0 k_1) \\implies x_1 = x_0 k_1$。\n如果我们选择 $k_1 \\neq x_1/x_0$，这对将会是不同的。\n\n让我们构建一个数值例子。\n设 $k=[1, 2]$，所以 $k_1=2$。这是一个对于 $s=2$ 有效的滤波器。\n设 $x$ 的支撑集在 $\\{0,1\\}$，其值为 $x_0=3$ 和 $x_1=3$。所以 $(k,x) = ([1,2], [3,3,0,\\dots])$。这里 $k=2, \\Delta=1$。并且 $k_1 = 2 \\neq x_1/x_0 = 3/3 = 1$。这对将会是不同的。\n\n原始对：$(k,x)$\n- $k = [1, 2]$\n- $x$ 的项为 $(x_0, x_1) = (3, 3)$\n卷积 $y=k*x$ 得到 $[1,2]*[3,3] = [3, 3+6, 6] = [3, 9, 6]$。\n\n构造的对：$(\\tilde{k},\\tilde{x})$\n- $\\tilde{k} = [1, x_1/x_0] = [1, 3/3] = [1, 1]$\n- $\\tilde{x}$ 的项为 $(\\tilde{x}_0, \\tilde{x}_1) = (x_0, x_0 k_1) = (3, 3 \\cdot 2) = (3, 6)$\n这对是有效的：$\\tilde{k}[0]=1$，$\\operatorname{supp}(\\tilde{k}) \\subseteq \\{0,1\\}$；$\\tilde{x}$ 是 2-稀疏的且 $\\Delta=1$。\n对 $([1,2], [3,3,\\dots])$ 显然不同于 $([1,1], [3,6,\\dots])$。\n卷积 $\\tilde{y}=\\tilde{k}*\\tilde{x}$ 得到 $[1,1]*[3,6] = [3, 6+3, 6] = [3, 9, 6]$。\n\n由于 $y=\\tilde{y}$，我们找到了两个满足问题约束但产生相同输出的不同对。这证明了当 $\\Delta=1$ 和 $s=2$ 时存在不可辨识性。这个逻辑可以推广到，对于任何 $s \\geq 2$，如果 $\\Delta \\leq s-1$，都可以构造一个类似的多项式因子交换模糊性。\n\n因此，条件 $\\Delta \\geq s$ 是充分且必要的。保证可辨识性的最小阈值 $\\Delta_\\star$（使得 $\\Delta \\geq \\Delta_\\star$）是 $\\Delta_\\star = s$。",
            "answer": "$$\\boxed{s}$$"
        },
        {
            "introduction": "前面的练习在理想化的无噪声环境中探讨了解的唯一性和可辨识性条件。然而，在实际应用中，我们必须处理带有噪声的观测数据，并在信号 $x$ 和核 $k$ 都存在不确定性的情况下进行推理。本练习将带您从理论分析走向算法实践，学习如何构建一个能够在更现实场景下工作的稳健算法。我们将采用变分贝叶斯（Variational Bayes）这一强大的近似推断框架，它旨在逼近未知的信号 $x$ 与核 $k$ 的完整后验概率分布。您将亲手推导此框架下坐标上升算法的核心迭代更新方程，为解决复杂的盲反卷积问题奠定算法基础。",
            "id": "3369047",
            "problem": "考虑一个一维离散盲反卷积模型，其中包含未知信号 $x \\in \\mathbb{R}^{n}$ 和未知模糊核 $k \\in \\mathbb{R}^{m}$。设观测值 $y \\in \\mathbb{R}^{n}$ 由 $x$ 和 $k$ 的线性卷积在加性高斯噪声下生成，如下所示：\n$$\ny = k * x + \\varepsilon,\n$$\n其中 $*$ 表示长度为 $n$ 的零填充线性卷积，$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$ 且噪声方差 $\\sigma^{2}  0$ 已知。为 $x$ 和 $k$ 设置独立的高斯先验，\n$$\nx \\sim \\mathcal{N}(0, \\alpha_{x}^{-1} I_{n}), \\quad k \\sim \\mathcal{N}(0, \\alpha_{k}^{-1} I_{m}),\n$$\n其中 $\\alpha_{x}  0$ 和 $\\alpha_{k}  0$ 是已知的先验精度。令 $K(k) \\in \\mathbb{R}^{n \\times n}$ 为托普利茨（或循环，与所选边界条件一致）卷积矩阵，使得 $K(k) x = k * x$，并令 $X(x) \\in \\mathbb{R}^{n \\times m}$ 为卷积设计矩阵，使得 $X(x) k = k * x$。$K(k)$ 和 $X(x)$ 均线性依赖于其参数。定义线性算子基 $\\{B_{j}\\}_{j=1}^{m}$ 和 $\\{A_{i}\\}_{i=1}^{n}$ 使得\n$$\nK(k) = \\sum_{j=1}^{m} k_{j} B_{j}, \\quad X(x) = \\sum_{i=1}^{n} x_{i} A_{i},\n$$\n其中 $B_{j} \\in \\mathbb{R}^{n \\times n}$ 将 $x$ 映射到与单位核 $e_{j} \\in \\mathbb{R}^{m}$ 的卷积 $e_{j} * x$，而 $A_{i} \\in \\mathbb{R}^{n \\times m}$ 将 $k$ 映射到与单位信号 $e_{i} \\in \\mathbb{R}^{n}$ 的卷积 $k * e_{i}$。\n\n使用变分贝叶斯（VB），特别是对后验概率 $p(x, k \\mid y)$ 的平均场近似 $q(x) q(k)$，提出高斯因子\n$$\nq(x) = \\mathcal{N}(m_{x}, S_{x}), \\quad q(k) = \\mathcal{N}(m_{k}, S_{k}),\n$$\n并以 $y$、$\\sigma^{2}$、$\\alpha_{x}$、$\\alpha_{k}$ 以及算子基 $\\{B_{j}\\}$ 和 $\\{A_{i}\\}$ 的形式，推导出均值向量 $m_{x} \\in \\mathbb{R}^{n}$、$m_{k} \\in \\mathbb{R}^{m}$ 和协方差矩阵 $S_{x} \\in \\mathbb{R}^{n \\times n}$、$S_{k} \\in \\mathbb{R}^{m \\times m}$ 的坐标上升更新的闭式解。您的最终表达式必须使用当前变分因子下的二阶矩期望来书写。不要假设协方差是对角阵。\n\n将您的最终答案表示为四个更新量 $S_{x}$、$m_{x}$、$S_{k}$、$m_{k}$ 的解析表达式。无需进行数值计算。",
            "solution": "标签必须清晰并构建逻辑。我将遵循我规划的推导路径。我已经准备好了所有组件，现在我将编写最终输出。详细程度应该适合教授向研究生解释。我不会跳过主要步骤。我们首先建立概率模型。所有变量的联合概率分布由似然和先验的乘积给出：\n$p(y, x, k) = p(y | x, k) p(x) p(k)$。\n根据问题陈述，这些因子是：\n$p(y | x, k) = \\mathcal{N}(y | k*x, \\sigma^2 I_n) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2} \\|y - k*x\\|_2^2\\right)$\n$p(x) = \\mathcal{N}(x | 0, \\alpha_x^{-1} I_n) \\propto \\exp\\left(-\\frac{\\alpha_x}{2} \\|x\\|_2^2\\right)$\n$p(k) = \\mathcal{N}(k | 0, \\alpha_k^{-1} I_m) \\propto \\exp\\left(-\\frac{\\alpha_k}{2} \\|k\\|_2^2\\right)$\n联合分布的对数，忽略常数项，为：\n$\\ln p(y, x, k) = -\\frac{1}{2\\sigma^2} \\|y - k*x\\|_2^2 - \\frac{\\alpha_x}{2} \\|x\\|_2^2 - \\frac{\\alpha_k}{2} \\|k\\|_2^2 + C$。\n在具有平均场近似 $q(x,k) = q(x)q(k)$ 的变分贝叶斯框架中，因子 $q(x)$ 和 $q(k)$ 的最优更新通过坐标上升法找到。因子 $q_i(z_i)$ 的通用更新规则由下式给出：\n$\\ln q_i^*(z_i) = \\mathbb{E}_{j \\neq i}[\\ln p(y, x, k)] + \\text{const}_{z_i}$，\n其中期望是针对所有其他变量，根据它们当前的变分分布计算的。\n\n$q(x) = \\mathcal{N}(m_x, S_x)$ 的更新推导：\n最优分布 $q^*(x)$ 由下式给出：\n$\\ln q^*(x) = \\mathbb{E}_{q(k)}[\\ln p(y, x, k)] + \\text{const}_x$\n$\\ln q^*(x) = \\mathbb{E}_{q(k)}[\\ln p(y|x,k) + \\ln p(x) + \\ln p(k)] + \\text{const}_x$\n由于 $\\ln p(k)$ 不依赖于 $x$，我们有：\n$\\ln q^*(x) = \\mathbb{E}_{q(k)}[-\\frac{1}{2\\sigma^2} \\|y - K(k)x\\|_2^2] - \\frac{\\alpha_x}{2} \\|x\\|_2^2 + \\text{const}_x$\n我们在期望内部展开二次项：\n$\\|y - K(k)x\\|_2^2 = (y - K(k)x)^T(y - K(k)x) = y^T y - 2y^T K(k)x + x^T K(k)^T K(k)x$。\n对 $q(k)$ 取期望：\n$\\mathbb{E}_{q(k)}[\\|y - K(k)x\\|_2^2] = y^T y - 2y^T \\mathbb{E}_{q(k)}[K(k)]x + x^T \\mathbb{E}_{q(k)}[K(k)^T K(k)]x$。\n将其代回 $\\ln q^*(x)$ 的表达式中，并舍去不依赖于 $x$ 的项：\n$\\ln q^*(x) \\propto -\\frac{1}{2\\sigma^2} \\left( -2y^T \\mathbb{E}_{q(k)}[K(k)]x + x^T \\mathbb{E}_{q(k)}[K(k)^T K(k)]x \\right) - \\frac{\\alpha_x}{2} x^T x$\n$\\ln q^*(x) \\propto x^T \\left(\\frac{1}{\\sigma^2} \\mathbb{E}_{q(k)}[K(k)]^T y \\right) - \\frac{1}{2} x^T \\left(\\frac{1}{\\sigma^2} \\mathbb{E}_{q(k)}[K(k)^T K(k)] + \\alpha_x I_n \\right) x$。\n该表达式是关于 $x$ 的二次型，这表明 $q^*(x)$ 是一个高斯分布。通过将其与多元高斯分布 $\\mathcal{N}(x|m_x, S_x)$ 的对数密度（正比于 $-\\frac{1}{2}(x-m_x)^T S_x^{-1} (x-m_x) = -\\frac{1}{2}x^T S_x^{-1} x + x^T S_x^{-1}m_x + \\text{const}$）进行比较，我们可以确定精度矩阵 $S_x^{-1}$ 和均值 $m_x$。\n精度矩阵是：\n$S_x^{-1} = \\frac{1}{\\sigma^2} \\mathbb{E}_{q(k)}[K(k)^T K(k)] + \\alpha_x I_n$。\n均值由下式确定：\n$S_x^{-1} m_x = \\frac{1}{\\sigma^2} \\mathbb{E}_{q(k)}[K(k)]^T y$。\n这得出了 $q(x)$ 参数的更新方程：\n$S_x = \\left(\\frac{1}{\\sigma^2}\\mathbb{E}_{q(k)}[K(k)^T K(k)] + \\alpha_x I_n\\right)^{-1}$\n$m_x = S_x \\left(\\frac{1}{\\sigma^2} \\mathbb{E}_{q(k)}[K(k)]^T y\\right)$。\n\n$q(k) = \\mathcal{N}(m_k, S_k)$ 的更新推导：\n该推导与 $q(x)$ 的推导对称。我们使用卷积的另一种表示法 $k*x = X(x)k$。\n$\\ln q^*(k) = \\mathbb{E}_{q(x)}[\\ln p(y, x, k)] + \\text{const}_k$\n$\\ln q^*(k) = \\mathbb{E}_{q(x)}[-\\frac{1}{2\\sigma^2} \\|y - X(x)k\\|_2^2] - \\frac{\\alpha_k}{2} \\|k\\|_2^2 + \\text{const}_k$。\n遵循相同的步骤，即展开二次项，对 $q(x)$ 取期望，并与高斯分布 $\\mathcal{N}(k|m_k, S_k)$ 的对数密度进行比较，我们得到：\n$S_k^{-1} = \\frac{1}{\\sigma^2} \\mathbb{E}_{q(x)}[X(x)^T X(x)] + \\alpha_k I_m$\n$S_k^{-1} m_k = \\frac{1}{\\sigma^2} \\mathbb{E}_{q(x)}[X(x)]^T y$。\n这给出了 $q(k)$ 参数的更新方程：\n$S_k = \\left(\\frac{1}{\\sigma^2}\\mathbb{E}_{q(x)}[X(x)^T X(x)] + \\alpha_k I_m\\right)^{-1}$\n$m_k = S_k \\left(\\frac{1}{\\sigma^2} \\mathbb{E}_{q(x)}[X(x)]^T y\\right)$。\n\n使用算子基表示期望：\n最后一步是使用算子基 $\\{A_i\\}$ 和 $\\{B_j\\}$ 以及当前变分分布的参数来表示所需的期望。\n对于 $q(x)$ 的更新，我们需要对 $q(k) = \\mathcal{N}(k|m_k, S_k)$ 取期望。\n$\\mathbb{E}_{q(k)}[K(k)] = \\mathbb{E}_{q(k)}\\left[\\sum_{j=1}^{m} k_j B_j\\right] = \\sum_{j=1}^{m} \\mathbb{E}_{q(k)}[k_j] B_j$。\n$\\mathbb{E}_{q(k)}[K(k)^T K(k)] = \\mathbb{E}_{q(k)}\\left[\\left(\\sum_{j=1}^{m} k_j B_j\\right)^T \\left(\\sum_{l=1}^{m} k_l B_l\\right)\\right] = \\sum_{j=1}^{m}\\sum_{l=1}^{m} \\mathbb{E}_{q(k)}[k_j k_l] B_j^T B_l$。\n这里，$\\mathbb{E}_{q(k)}[k_j]$ 是均值向量 $m_k$ 的第 $j$ 个分量，而 $\\mathbb{E}_{q(k)}[k_j k_l]$ 是二阶矩矩阵 $\\mathbb{E}_{q(k)}[kk^T] = S_k + m_k m_k^T$ 的第 $(j,l)$ 个元素。\n\n对于 $q(k)$ 的更新，我们需要对 $q(x) = \\mathcal{N}(x|m_x, S_x)$ 取期望。\n$\\mathbb{E}_{q(x)}[X(x)] = \\mathbb{E}_{q(x)}\\left[\\sum_{i=1}^{n} x_i A_i\\right] = \\sum_{i=1}^{n} \\mathbb{E}_{q(x)}[x_i] A_i$。\n$\\mathbb{E}_{q(x)}[X(x)^T X(x)] = \\mathbb{E}_{q(x)}\\left[\\left(\\sum_{i=1}^{n} x_i A_i\\right)^T \\left(\\sum_{p=1}^{n} x_p A_p\\right)\\right] = \\sum_{i=1}^{n}\\sum_{p=1}^{n} \\mathbb{E}_{q(x)}[x_i x_p] A_i^T A_p$。\n这里，$\\mathbb{E}_{q(x)}[x_i]$ 是均值向量 $m_x$ 的第 $i$ 个分量，而 $\\mathbb{E}_{q(x)}[x_i x_p]$ 是二阶矩矩阵 $\\mathbb{E}_{q(x)}[xx^T] = S_x + m_x m_x^T$ 的第 $(i,p)$ 个元素。\n\n将这些代入更新规则，即可得到所要求的最终闭式表达式。\n$S_x$ 的更新为：\n$S_x = \\left(\\frac{1}{\\sigma^2} \\sum_{j=1}^{m}\\sum_{l=1}^{m} \\mathbb{E}_{q(k)}[k_j k_l] B_j^T B_l + \\alpha_x I_n\\right)^{-1}$。\n$m_x$ 的更新为：\n$m_x = S_x \\left(\\frac{1}{\\sigma^2} \\left(\\sum_{j=1}^{m}\\mathbb{E}_{q(k)}[k_j]B_j\\right)^T y\\right)$。\n$S_k$ 的更新为：\n$S_k = \\left(\\frac{1}{\\sigma^2} \\sum_{i=1}^{n}\\sum_{p=1}^{n} \\mathbb{E}_{q(x)}[x_i x_p] A_i^T A_p + \\alpha_k I_m\\right)^{-1}$。\n$m_k$ 的更新为：\n$m_k = S_k \\left(\\frac{1}{\\sigma^2} \\left(\\sum_{i=1}^{n}\\mathbb{E}_{q(x)}[x_i]A_i\\right)^T y\\right)$。\n这些表达式满足了问题陈述的所有条件。期望 $\\mathbb{E}_{q(k)}[\\cdot]$ 和 $\\mathbb{E}_{q(x)}[\\cdot]$ 是使用坐标上升算法上一步的变分分布参数计算的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nS_{x} = \\left(\\frac{1}{\\sigma^{2}} \\sum_{j=1}^{m} \\sum_{l=1}^{m} \\mathbb{E}_{q(k)}[k_{j}k_{l}] B_{j}^T B_{l} + \\alpha_{x} I_{n}\\right)^{-1} \\\\\nm_{x} = S_{x} \\left(\\frac{1}{\\sigma^{2}} \\left(\\sum_{j=1}^{m} \\mathbb{E}_{q(k)}[k_{j}] B_{j}\\right)^{T} y\\right) \\\\\nS_{k} = \\left(\\frac{1}{\\sigma^{2}} \\sum_{i=1}^{n} \\sum_{p=1}^{n} \\mathbb{E}_{q(x)}[x_{i}x_{p}] A_{i}^T A_{p} + \\alpha_{k} I_{m}\\right)^{-1} \\\\\nm_{k} = S_{k} \\left(\\frac{1}{\\sigma^{2}} \\left(\\sum_{i=1}^{n} \\mathbb{E}_{q(x)}[x_{i}] A_{i}\\right)^{T} y\\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}