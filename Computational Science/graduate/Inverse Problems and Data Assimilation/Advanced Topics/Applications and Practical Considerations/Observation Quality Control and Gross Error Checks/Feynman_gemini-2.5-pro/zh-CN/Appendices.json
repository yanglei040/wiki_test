{
    "hands_on_practices": [
        {
            "introduction": "质量控制最基本的检查是将观测值与其模型预测的对应值进行比较。本练习具体演练了卡方检验（Chi-squared test），这是统计数据验证的基石。通过计算新息方差（innovation variance）和由此产生的检验统计量，您将亲手实践总误差检测的核心逻辑。",
            "id": "3406849",
            "problem": "考虑一个变分资料同化系统中的单观测质量控制任务。设模型状态的维度为 $n=3$，观测算子在背景态 $x_b$ 处可微且线性化，其雅可比（行）向量为 $H \\in \\mathbb{R}^{1 \\times 3}$。背景误差 $x - x_b$ 被建模为一个零均值随机向量，其协方差矩阵为 $B \\in \\mathbb{R}^{3 \\times 3}$。观测误差是仪器误差和代表性误差之和，两者均被建模为零均值、相互独立的随机变量，且与背景误差独立。新息（观测空间中的观测减背景）为 $d = y - \\mathcal{H}(x_b)$，其中 $\\mathcal{H}$ 是非线性观测算子，$H$ 是其在 $x_b$ 处的雅可比矩阵。仅使用方差的线性化误差传播法则和独立性假设，推导标量新息方差 $S = \\operatorname{Var}(d)$，然后计算卡方大误差检验统计量 $z = d^2 / S$。\n\n给定：\n- 线性化观测算子的雅可比矩阵为 $H = \\begin{bmatrix} 0.5  -1.2  0.3 \\end{bmatrix}$。\n- 背景误差协方差\n$$\nB = \\begin{bmatrix}\n1.0  0.2  -0.1 \\\\\n0.2  2.0  0.4 \\\\\n-0.1  0.4  1.5\n\\end{bmatrix}.\n$$\n- 仪器误差方差 $R = 0.49$。\n- 代表性误差方差 $R_{\\text{rep}} = 0.36$。\n- 实现的新息 $d = 5.0$。\n- 对于一个自由度，预设的标量卡方阈值为 $\\gamma = 6.635$。\n\n从所述的建模假设和线性化出发，首先推导标量新息方差 $S$，然后计算统计量 $z = d^2 / S$。在你的推理中，通过比较 $z$ 和 $\\gamma$，说明残差是否与假设的误差统计量相符。仅报告 $z$ 的值作为最终答案。将你的数值答案四舍五入到四位有效数字。不需要单位。",
            "solution": "该问题要求在资料同化背景下，计算单个观测的卡方大误差检验统计量。该统计量定义为 $z = d^2 / S$，其中 $d$ 是新息，$S$ 是新息方差。\n\n首先，我们必须推导新息方差 $S$ 的表达式。新息是观测值 $y$ 与模式对观测值的预报 $\\mathcal{H}(x_b)$ 之间的差，其中 $\\mathcal{H}$ 是（可能为非线性的）观测算子，$x_b$ 是背景态。\n$$d = y - \\mathcal{H}(x_b)$$\n观测值 $y$ 通过观测算子和一个观测误差 $\\epsilon_o$ 与真实态 $x_t$ 相关联：\n$$y = \\mathcal{H}(x_t) + \\epsilon_o$$\n背景态 $x_b$ 是对真实态的估计，两者之差为背景误差 $\\epsilon_b = x_b - x_t$。用问题陈述中代表真实态的变量 $x$ 来表示，背景误差为 $x-x_b$。我们将采用常用约定 $\\epsilon_b = x_b-x_t$，因此 $x_t - x_b = -\\epsilon_b$。\n\n将 $y$ 的表达式代入 $d$ 的定义中：\n$$d = (\\mathcal{H}(x_t) + \\epsilon_o) - \\mathcal{H}(x_b)$$\n我们使用一阶泰勒展开，将算子 $\\mathcal{H}$ 在背景态 $x_b$ 附近进行线性化：\n$$\\mathcal{H}(x_t) \\approx \\mathcal{H}(x_b) + H(x_t - x_b)$$\n其中 $H$ 是在 $x_b$ 处计算的 $\\mathcal{H}$ 的雅可比矩阵。将此近似代入 $d$ 的表达式中：\n$$d \\approx (\\mathcal{H}(x_b) + H(x_t - x_b) + \\epsilon_o) - \\mathcal{H}(x_b) = H(x_t - x_b) + \\epsilon_o = -H\\epsilon_b + \\epsilon_o$$\n新息方差 $S$ 是新息平方的期望值，$S = \\operatorname{Var}(d) = E[d^2]$，因为题目说明 $\\epsilon_b$ 和 $\\epsilon_o$ 均为零均值，这意味着 $E[d]=0$。\n$$S = E[(-H\\epsilon_b + \\epsilon_o)(-H\\epsilon_b + \\epsilon_o)^T]$$\n注意，对于标量新息，转置是多余的，但为了在一般情况下的正确性而保留。展开表达式：\n$$S = E[H\\epsilon_b\\epsilon_b^T H^T - H\\epsilon_b\\epsilon_o^T - \\epsilon_o\\epsilon_b^T H^T + \\epsilon_o\\epsilon_o^T]$$\n利用期望算子的线性性质：\n$$S = H E[\\epsilon_b\\epsilon_b^T] H^T - H E[\\epsilon_b\\epsilon_o^T] - E[\\epsilon_o\\epsilon_b^T] H^T + E[\\epsilon_o\\epsilon_o^T]$$\n问题陈述背景误差和观测误差是独立的。由于它们也都是零均值，它们的协方差为零：$E[\\epsilon_b\\epsilon_o^T] = E[\\epsilon_b]E[\\epsilon_o^T] = 0$。交叉项消失。\n$$S = H E[\\epsilon_b\\epsilon_b^T] H^T + E[\\epsilon_o\\epsilon_o^T]$$\n根据定义，背景误差协方差矩阵为 $B = E[\\epsilon_b\\epsilon_b^T]$。标量观测的总观测误差方差为 $R_o = E[\\epsilon_o\\epsilon_o^T]$。因此，新息方差为：\n$$S = HBH^T + R_o$$\n总观测误差 $\\epsilon_o$ 是仪器误差 $\\epsilon_{inst}$ 和代表性误差 $\\epsilon_{rep}$ 之和。题目说明它们是零均值且相互独立的。因此，总观测误差方差 $R_o$ 是各部分方差之和：\n$$R_o = \\operatorname{Var}(\\epsilon_{inst}) + \\operatorname{Var}(\\epsilon_{rep}) = R + R_{\\text{rep}}$$\n新息方差的最终公式为：\n$$S = HBH^T + R + R_{\\text{rep}}$$\n现在，我们将给定值代入此公式。\n给定：\n$H = \\begin{bmatrix} 0.5  -1.2  0.3 \\end{bmatrix}$\n$B = \\begin{bmatrix} 1.0  0.2  -0.1 \\\\ 0.2  2.0  0.4 \\\\ -0.1  0.4  1.5 \\end{bmatrix}$\n$R = 0.49$\n$R_{\\text{rep}} = 0.36$\n$d = 5.0$\n\n首先，计算项 $HBH^T$。\n$$H B = \\begin{bmatrix} 0.5  -1.2  0.3 \\end{bmatrix} \\begin{bmatrix} 1.0  0.2  -0.1 \\\\ 0.2  2.0  0.4 \\\\ -0.1  0.4  1.5 \\end{bmatrix}$$\n$$H B = \\begin{bmatrix} (0.5)(1.0) + (-1.2)(0.2) + (0.3)(-0.1)  (0.5)(0.2) + (-1.2)(2.0) + (0.3)(0.4)  (0.5)(-0.1) + (-1.2)(0.4) + (0.3)(1.5) \\end{bmatrix}$$\n$$H B = \\begin{bmatrix} 0.5 - 0.24 - 0.03  0.1 - 2.4 + 0.12  -0.05 - 0.48 + 0.45 \\end{bmatrix}$$\n$$H B = \\begin{bmatrix} 0.23  -2.18  -0.08 \\end{bmatrix}$$\n接下来，我们计算 $HBH^T = (HB)H^T$：\n$$HBH^T = \\begin{bmatrix} 0.23  -2.18  -0.08 \\end{bmatrix} \\begin{bmatrix} 0.5 \\\\ -1.2 \\\\ 0.3 \\end{bmatrix}$$\n$$HBH^T = (0.23)(0.5) + (-2.18)(-1.2) + (-0.08)(0.3)$$\n$$HBH^T = 0.115 + 2.616 - 0.024 = 2.707$$\n现在，计算总观测误差方差 $R_o$：\n$$R_o = R + R_{\\text{rep}} = 0.49 + 0.36 = 0.85$$\n总新息方差 $S$ 为：\n$$S = HBH^T + R_o = 2.707 + 0.85 = 3.557$$\n最后，我们计算卡方统计量 $z$：\n$$z = \\frac{d^2}{S} = \\frac{(5.0)^2}{3.557} = \\frac{25}{3.557} \\approx 7.028394436...$$\n四舍五入到四位有效数字，我们得到 $z = 7.028$。\n\n问题要求通过将 $z$ 与阈值 $\\gamma$ 进行比较，来说明残差是否与假设的误差统计量相符。\n计算出的统计量为 $z \\approx 7.028$。\n预设的阈值为 $\\gamma = 6.635$。\n由于 $z > \\gamma$，在与此阈值相对应的显著性水平下（对于自由度为1的 $\\chi^2$ 分布，该水平为 $1\\%$），观测值与背景和观测误差统计量一致的原假设被拒绝。因此，该新息被认为在统计上过大，该观测将被标记为大误差。残差与假设的误差统计量不符。最终答案仅需要 $z$ 的值。",
            "answer": "$$\\boxed{7.028}$$"
        },
        {
            "introduction": "在上一个练习的基础上，我们从单个观测扩展到一个观测系统。本实践探讨了一个更复杂的场景，即观测算子本身存在结构性限制。它论证了仅对观测向量中模型“可见”或可解释的分量进行检验的重要性，引入了在加权内积空间中进行投影的概念，并展示了如何正确确定检验的统计自由度。",
            "id": "3406890",
            "problem": "考虑一个线性逆问题，其观测方程为 $y = H x + e$，其中 $y \\in \\mathbb{R}^{m}$ 是观测向量，$x \\in \\mathbb{R}^{n}$ 是未知状态，$H \\in \\mathbb{R}^{m \\times n}$ 是线性观测算子，$e \\in \\mathbb{R}^{m}$ 是加性观测噪声。假设 $e$ 是零均值高斯噪声，其协方差 $R \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵。数据同化系统通过最小化一个 Tikhonov 正则化的最小二乘代价泛函来估计 $x$，其惩罚项由线性算子 $L \\in \\mathbb{R}^{p \\times n}$ 和正则化参数 $\\lambda > 0$ 定义，因此先验协方差为 $B = \\lambda^{-1} (L^{\\top} L)^{-1}$，当 $L$ 为满列秩时，该矩阵是对称正定的。\n\n在质量控制 (QC) 中，我们通过检验新息 $v = y - H x_{\\mathrm{b}}$（其中 $x_{\\mathrm{b}}$ 为背景状态）与一个阈值来检测粗大误差，该阈值的推导旨在使其仅对 $v$ 中可被正则化模型解释的观测子空间内的分量敏感。异常值可能会利用与 $\\operatorname{range}(H)$ 正交的方向（即在观测内积下 $H^{\\top}$ 的零空间），因此，检验必须将 $v$ 在 $R^{-1}$ 加权内积下投影到 $\\operatorname{range}(H)$ 上，以避免对不可达分量进行惩罚。\n\n从上述假设以及高斯随机向量、加权内积空间中的正交投影和线性逆问题的标准性质出发，推导一个感知正则化的标量 QC 阈值 $\\tau_{\\alpha}$。该阈值是针对 $v$ 在给定拒真水平 $\\alpha \\in (0,1)$ 下投影到 $\\operatorname{range}(H)$ 上的 $R^{-1}$ 加权平方范数。您的推导必须确定投影二次型的正确参考分布，并根据相应算子的秩来确定其自由度。\n\n然后，将您的结果应用于以下具体实例，其中 $m = 4$ 且 $n = 3$：\n- $H = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 1  -1  0 \\\\ 0  0  0 \\end{pmatrix}$，\n- $R = \\operatorname{diag}(0.04, 0.04, 0.09, 0.25)$，\n- $L = \\operatorname{diag}(1, 2, 3)$，\n- $\\lambda = 0.5$，\n- 使用显著性水平 $\\alpha = 0.05$，\n- 假设 $x_{\\mathrm{b}}$ 使得在零假设（无粗大误差）下，$v$ 的分布与 $e$ 相同。\n\n计算适用于此检验的阈值 $\\tau_{\\alpha}$ 的数值。将最终阈值表示为一个纯数（无量纲）。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求在线性逆问题背景下，为新息向量的统计检验推导一个质量控制 (QC) 阈值。此过程始于验证问题陈述，经判断其科学上合理、适定、客观且自洽。关于正则化算子 $L$ 和参数 $\\lambda$ 的信息为更广泛的数据同化系统提供了背景，但对于计算指定的背景 QC 检验统计量并非直接必需，因为该统计量基于同化前的新息 $v = y - H x_{\\mathrm{b}}$。\n\n在零假设 $H_0$（无粗大误差）下，假定新息 $v$ 的分布与观测误差 $e$ 相同。问题陈述 $e$ 是一个零均值高斯随机向量，其协方差为 $R$，因此 $v \\sim \\mathcal{N}(0, R)$。QC 检验是针对一个标量统计量 $T$ 进行的，该统计量定义为 $v$ 到观测算子值域 $\\operatorname{range}(H)$ 上的正交投影的 $R^{-1}$ 加权平方范数。\n\n观测空间 $\\mathbb{R}^m$ 中的内积是 $R^{-1}$ 加权内积，对任意向量 $a, b \\in \\mathbb{R}^m$ 定义为 $\\langle a, b \\rangle_{R^{-1}} = a^{\\top} R^{-1} b$。向量 $a$ 的平方范数为 $\\|a\\|_{R^{-1}}^2 = a^{\\top} R^{-1} a$。\n\n令 $P_H$ 为在该内积下到子空间 $\\mathcal{S} = \\operatorname{range}(H)$ 上的正交投影算子。检验统计量则为 $T = \\|P_H v\\|_{R^{-1}}^2$。我们的目标是求出在 $H_0$ 下 $T$ 的分布。\n\n为简化分析，我们进行“白化”变换。由于 $R$ 是对称正定矩阵，其逆矩阵 $R^{-1}$ 和平方根 $R^{-1/2}$ 存在且也为对称正定矩阵。我们定义一个白化新息向量 $v' = R^{-1/2} v$。随机向量 $v'$ 是高斯的，其均值为 $\\mathbb{E}[v'] = R^{-1/2} \\mathbb{E}[v] = 0$，协方差矩阵为 $\\operatorname{Cov}(v') = \\mathbb{E}[v' v'^{\\top}] = \\mathbb{E}[R^{-1/2} v v^{\\top} R^{-1/2}] = R^{-1/2} \\mathbb{E}[v v^{\\top}] R^{-1/2} = R^{-1/2} R R^{-1/2} = I_m$。因此，$v' \\sim \\mathcal{N}(0, I_m)$，其中 $I_m$ 是 $m \\times m$ 的单位矩阵。\n\n检验统计量 $T$ 可以用 $v'$ 来表示。投影 $P_H v$ 是 $\\operatorname{range}(H)$ 中使得到 $v$ 的 $R^{-1}$ 加权距离最小的向量。这等价于求白化向量 $v'$ 在标准欧几里得内积下到变换后的子空间 $\\operatorname{range}(R^{-1/2} H)$ 上的投影。令 $H' = R^{-1/2} H$。在标准欧几里得内积下，到 $\\operatorname{range}(H')$ 上的正交投影算子由 $P' = H'(H'^{\\top}H')^{+}H'^{\\top}$ 给出，其中 $(\\cdot)^{+}$ 表示 Moore-Penrose 伪逆，这是必需的，因为 $H$（以及 $H'$）可能不是满列秩的。矩阵 $P'$ 是对称的（$P'^{\\top} = P'$）和幂等的（$P'^2 = P'$）。\n\n投影向量的平方范数为 $T = (P_H v)^{\\top} R^{-1} (P_H v)$。我们可以证明这等价于投影白化向量的欧几里得平方范数 $\\|P'v'\\|^2$：\n通过求解正规方程 $H^{\\top}R^{-1}Hx = H^{\\top}R^{-1}v$ 可以得到 $T = \\|P_H v\\|_{R^{-1}}^2 = \\min_{x \\in \\mathbb{R}^n} \\|v-Hx\\|_{R^{-1}}^2$。令 $x_{LS}$ 为其解，则 $P_Hv=Hx_{LS}$。\n$T = (Hx_{LS})^{\\top} R^{-1} (Hx_{LS}) = x_{LS}^{\\top} H^{\\top} R^{-1} H x_{LS} = x_{LS}^{\\top} H^{\\top} R^{-1} v$。\n在白化空间中，正规方程为 $H'^{\\top}H'x=H'^{\\top}v'$，其解为 $x_{LS}=(H'^{\\top}H')^{+} H'^{\\top}v'$。\n平方范数为 $\\|P'v'\\|^2 = \\|H'x_{LS}\\|^2 = x_{LS}^{\\top} H'^{\\top} H' x_{LS} = x_{LS}^{\\top} H'^{\\top}v' = ( (H'^{\\top}H')^{+} H'^{\\top}v' )^{\\top} H'^{\\top} v' = v'^{\\top} H' (H'^{\\top}H')^{+} H'^{\\top} v' = v'^{\\top} P' v'$。\n或者，更直接地，$T = (P_H v)^{\\top}R^{-1}(P_H v)$。算子 $P_H$ 通过 $P_H=R^{1/2}P'R^{-1/2}$ 与 $P'$ 相关联。\n$T = (R^{1/2}P'R^{-1/2}v)^\\top R^{-1} (R^{1/2}P'R^{-1/2}v) = v^\\top R^{-1/2} P'^\\top R^{1/2} R^{-1} R^{1/2} P' R^{-1/2} v = v^\\top R^{-1/2} P' P' R^{-1/2} v = (R^{-1/2}v)^\\top P' (R^{-1/2}v) = v'^\\top P' v'$。\n\n因此，统计量是 $T = v'^{\\top} P' v'$，这是一个标准正态向量 $v' \\sim \\mathcal{N}(0, I_m)$ 的二次型。根据 Cochran 定理，由于 $P'$ 是一个对称幂等矩阵，统计量 $T$ 服从卡方分布，$T \\sim \\chi^2_d$。自由度 $d$ 是投影矩阵 $P'$ 的秩，等于它所投影到的子空间的维度。\n$d = \\operatorname{rank}(P') = \\operatorname{dim}(\\operatorname{range}(H')) = \\operatorname{rank}(H')$。\n由于 $R^{-1/2}$ 是一个可逆矩阵，乘以它不会改变矩阵的秩。因此，\n$d = \\operatorname{rank}(H') = \\operatorname{rank}(R^{-1/2} H) = \\operatorname{rank}(H)$。\n\n现在我们将此结果应用于给定的具体实例。观测算子为：\n$$H = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 1  -1  0 \\\\ 0  0  0 \\end{pmatrix}$$\n$H$ 的列向量为 $c_1 = (1, 0, 1, 0)^{\\top}$，$c_2 = (0, 1, -1, 0)^{\\top}$ 和 $c_3 = (0, 0, 0, 0)^{\\top}$。前两列是线性无关的，第三列是零向量。$H$ 的列空间由 $\\{c_1, c_2\\}$ 张成，因此其维数为 2。\n因此，$H$ 的秩为 $d = \\operatorname{rank}(H) = 2$。\n检验统计量 $T$ 服从自由度为 2 的卡方分布，$T \\sim \\chi^2_2$。\n\nQC 阈值 $\\tau_{\\alpha}$ 由指定的拒真水平 $\\alpha$ 决定。如果 $T > \\tau_{\\alpha}$，我们拒绝零假设 $H_0$。发生错误拒绝（第一类错误）的概率是 $P(T > \\tau_{\\alpha} | H_0) = \\alpha$。\n因此，$\\tau_{\\alpha}$ 是 $\\chi^2_2$ 分布的上 $\\alpha$-分位数，由 $F_{\\chi^2_2}(\\tau_{\\alpha}) = 1 - \\alpha$ 定义，其中 $F_{\\chi^2_2}$ 是 $\\chi^2_2$ 分布的累积分布函数 (CDF)。\n\n$\\chi^2_d$ 分布的概率密度函数 (PDF) 是 $f(x; d) = \\frac{1}{2^{d/2}\\Gamma(d/2)} x^{d/2 - 1} \\exp(-x/2)$。对于自由度 $d=2$，我们有 $\\Gamma(d/2) = \\Gamma(1) = 1$。PDF 变为：\n$$f(x; 2) = \\frac{1}{2^{2/2}\\Gamma(1)} x^{2/2 - 1} \\exp(-x/2) = \\frac{1}{2} \\exp(-x/2)$$\n这是一个速率参数为 $1/2$ 的指数分布的 PDF。其 CDF 为：\n$$F(x; 2) = \\int_0^x \\frac{1}{2} \\exp(-t/2) dt = \\left[ -\\exp(-t/2) \\right]_0^x = 1 - \\exp(-x/2)$$\n我们需要求解当 $\\alpha = 0.05$ 时的 $\\tau_{\\alpha}$。我们将 CDF 设为 $1-\\alpha = 0.95$：\n$$1 - \\exp(-\\tau_{\\alpha}/2) = 1 - 0.05$$\n$$\\exp(-\\tau_{\\alpha}/2) = 0.05$$\n两边取自然对数：\n$$-\\frac{\\tau_{\\alpha}}{2} = \\ln(0.05)$$\n$$\\tau_{\\alpha} = -2 \\ln(0.05) = -2 \\ln\\left(\\frac{1}{20}\\right) = 2 \\ln(20)$$\n现在我们计算数值：\n$$\\tau_{\\alpha} = 2 \\ln(20) \\approx 2 \\times 2.99573227 \\approx 5.99146454$$\n根据题目要求，四舍五入到四位有效数字，我们得到 $\\tau_{\\alpha} \\approx 5.991$。\n这个值 $\\tau_{0.05} = 5.991$ 就是阈值。如果对一个给定的观测计算出的统计量 $T$ 大于此值，该观测将被标记为可能存在粗大误差。",
            "answer": "$$\\boxed{5.991}$$"
        },
        {
            "introduction": "作为本章的收尾，我们将视角从简单地检测和拒绝异常值，转移到在同化过程中“容纳”它们。本练习通过休伯（Huber）加权方案的实际应用，介绍了稳健的M估计方法。通过计算权重以降低大误差观测值的影响，并执行加权最小二乘更新，您将学到一种使数据同化系统对总误差更具韧性的强大技术。",
            "id": "3406858",
            "problem": "在一个一维变分数据同化步骤中，考虑有 $n=6$ 个独立的传感器通过线性观测算子 $\\mathcal{H}_i(x)=h_i x$ 观测同一标量状态 $x$。在第 $t$ 次迭代时，当前估计值为 $x^{(t)}=1.0$，标量残差 $r_i=y_i-\\mathcal{H}_i(x^{(t)})$ 可用于质量控制。为使用 Huber 权重方案进行稳健的粗差检查，请使用以下基本定义：\n- 残差定义为 $r_i=y_i-\\mathcal{H}_i(x^{(t)})$。\n- 提供了残差的稳健尺度 $\\sigma$。\n- Huber 阈值为 $\\delta=k\\sigma$，其中 $k$ 为选定参数。\n- Huber 权重 $w_i$ 遵循标准的 M-估计规则 $w_i=\\psi(r_i)/r_i$，其中 Huber 得分函数为：若 $|r|\\le \\delta$，则 $\\psi(r)=r$；若 $|r|>\\delta$，则 $\\psi(r)=\\delta\\operatorname{sign}(r)$。由此得出：若 $|r_i|\\le \\delta$，则 $w_i=1$；若 $|r_i|>\\delta$，则 $w_i=\\delta/|r_i|$。\n- 加权最小二乘（WLS）更新求解 $x^{(t+1)}=\\arg\\min_x \\sum_{i=1}^{n} w_i \\left(y_i-\\mathcal{H}_i(x)\\right)^2$。\n\n假设传感器灵敏度为 $(h_1,h_2,h_3,h_4,h_5,h_6)=(1.0,0.8,1.2,0.6,1.5,0.7)$，第 $t$ 次迭代时的残差为 $(r_1,r_2,r_3,r_4,r_5,r_6)=(0.2,-0.1,0.5,-0.4,4.0,-3.5)$，稳健尺度为 $\\sigma=0.3$。选择 $k=2$，因此 $\\delta=k\\sigma$。使用所提供的 $r_i$、$\\sigma$、$k$ 和 $h_i$ 来：\n\n1. 计算 Huber 权重 $w_i$。\n2. 从 $r_i=y_i-h_i x^{(t)}$ 中恢复观测值 $y_i$。\n3. 执行一次 WLS 更新以获得 $x^{(t+1)}$。\n\n将最终的 $x^{(t+1)}$ 报告为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "用户要求我使用 Huber 权重方案解决一个用于稳健质量控制的一维变分数据同化问题。\n\n### 第一步：提取已知条件\n- 传感器数量：$n=6$。\n- 观测模型：线性，$\\mathcal{H}_i(x) = h_i x$。\n- 状态的当前估计值：$x^{(t)} = 1.0$。\n- 传感器灵敏度：$(h_1, h_2, h_3, h_4, h_5, h_6) = (1.0, 0.8, 1.2, 0.6, 1.5, 0.7)$。\n- 第 $t$ 次迭代时的残差：$(r_1, r_2, r_3, r_4, r_5, r_6) = (0.2, -0.1, 0.5, -0.4, 4.0, -3.5)$。\n- 残差的稳健尺度：$\\sigma = 0.3$。\n- Huber 阈值参数：$k = 2$。\n- Huber 阈值定义：$\\delta = k \\sigma$。\n- Huber 权重定义：若 $|r_i| \\le \\delta$ 则 $w_i=1$；若 $|r_i| > \\delta$ 则 $w_i=\\delta/|r_i|$。\n- 加权最小二乘（WLS）更新规则：$x^{(t+1)} = \\arg\\min_x \\sum_{i=1}^{n} w_i \\left(y_i - \\mathcal{H}_i(x)\\right)^2$。\n- 残差定义：$r_i = y_i - \\mathcal{H}_i(x^{(t)})$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，其操作基于稳健统计学（M-估计）应用于反演问题和数据同化的既定框架。在加权最小二乘最小化中使用 Huber 权重方案来降低离群值（粗差）的权重是一种标准且有据可查的技术。\n\n该问题是适定的。它提供了计算 $x^{(t+1)}$ 唯一解所需的所有数据和定义。数据是自洽且一致的。语言客观而精确。该问题是一个标准算法的具体数值应用，既不简单也不过分复杂。它没有违反任何科学原理，不是隐喻性的，是完整的，并且是可行的。\n\n### 第三步：结论与行动\n问题有效。将提供解答。\n\n### 求解推导\n\n求解过程遵循问题陈述中列出的三个任务。\n\n**1. 计算 Huber 权重 $w_i$。**\n\n首先，根据给定的稳健尺度 $\\sigma$ 和参数 $k$ 计算 Huber 阈值 $\\delta$。\n$$\n\\delta = k \\sigma = 2 \\times 0.3 = 0.6\n$$\n接下来，我们将每个残差的绝对值 $|r_i|$ 与此阈值 $\\delta=0.6$ 进行比较，以确定相应的权重 $w_i$。\n- 对于 $i=1$：$|r_1| = |0.2| = 0.2 \\le 0.6$，所以 $w_1 = 1$。\n- 对于 $i=2$：$|r_2| = |-0.1| = 0.1 \\le 0.6$，所以 $w_2 = 1$。\n- 对于 $i=3$：$|r_3| = |0.5| = 0.5 \\le 0.6$，所以 $w_3 = 1$。\n- 对于 $i=4$：$|r_4| = |-0.4| = 0.4 \\le 0.6$，所以 $w_4 = 1$。\n- 对于 $i=5$：$|r_5| = |4.0| = 4.0 > 0.6$，所以 $w_5 = \\frac{\\delta}{|r_5|} = \\frac{0.6}{4.0} = 0.15$。\n- 对于 $i=6$：$|r_6| = |-3.5| = 3.5 > 0.6$，所以 $w_6 = \\frac{\\delta}{|r_6|} = \\frac{0.6}{3.5} = \\frac{6}{35}$。\n\n因此，Huber 权重的向量是 $(w_1, w_2, w_3, w_4, w_5, w_6) = (1, 1, 1, 1, 0.15, \\frac{6}{35})$。\n\n**2. 恢复观测值 $y_i$。**\n\n观测值 $y_i$ 可以从残差的定义中恢复：$r_i = y_i - \\mathcal{H}_i(x^{(t)})$。已知 $\\mathcal{H}_i(x) = h_i x$ 和 $x^{(t)}=1.0$，我们有 $y_i = r_i + h_i x^{(t)}$。\n- $y_1 = r_1 + h_1 x^{(t)} = 0.2 + 1.0 \\times 1.0 = 1.2$。\n- $y_2 = r_2 + h_2 x^{(t)} = -0.1 + 0.8 \\times 1.0 = 0.7$。\n- $y_3 = r_3 + h_3 x^{(t)} = 0.5 + 1.2 \\times 1.0 = 1.7$。\n- $y_4 = r_4 + h_4 x^{(t)} = -0.4 + 0.6 \\times 1.0 = 0.2$。\n- $y_5 = r_5 + h_5 x^{(t)} = 4.0 + 1.5 \\times 1.0 = 5.5$。\n- $y_6 = r_6 + h_6 x^{(t)} = -3.5 + 0.7 \\times 1.0 = -2.8$。\n\n观测值的向量是 $(y_1, y_2, y_3, y_4, y_5, y_6) = (1.2, 0.7, 1.7, 0.2, 5.5, -2.8)$。\n\n**3. 执行一次 WLS 更新以获得 $x^{(t+1)}$。**\n\n更新后的状态估计 $x^{(t+1)}$ 是使加权最小二乘成本函数 $J(x)$ 最小化的 $x$ 值：\n$$\nJ(x) = \\sum_{i=1}^{n} w_i (y_i - h_i x)^2\n$$\n为了找到最小值，我们对 $J(x)$ 求关于 $x$ 的导数，并令其为零。\n$$\n\\frac{dJ}{dx} = \\sum_{i=1}^{n} w_i \\cdot 2(y_i - h_i x) \\cdot (-h_i) = -2 \\sum_{i=1}^{n} w_i h_i (y_i - h_i x) = -2 \\left( \\sum_{i=1}^{n} w_i h_i y_i - x \\sum_{i=1}^{n} w_i h_i^2 \\right)\n$$\n令 $\\frac{dJ}{dx} = 0$：\n$$\n\\sum_{i=1}^{n} w_i h_i y_i - x \\sum_{i=1}^{n} w_i h_i^2 = 0\n$$\n求解 $x$（即我们的新估计值 $x^{(t+1)}$），可得：\n$$\nx^{(t+1)} = \\frac{\\sum_{i=1}^{n} w_i h_i y_i}{\\sum_{i=1}^{n} w_i h_i^2}\n$$\n现在我们分别计算分子和分母。\n\n分母：$\\sum_{i=1}^{6} w_i h_i^2$\n- $w_1 h_1^2 = 1 \\cdot (1.0)^2 = 1.0$\n- $w_2 h_2^2 = 1 \\cdot (0.8)^2 = 0.64$\n- $w_3 h_3^2 = 1 \\cdot (1.2)^2 = 1.44$\n- $w_4 h_4^2 = 1 \\cdot (0.6)^2 = 0.36$\n- $w_5 h_5^2 = 0.15 \\cdot (1.5)^2 = 0.15 \\cdot 2.25 = 0.3375$\n- $w_6 h_6^2 = \\frac{6}{35} \\cdot (0.7)^2 = \\frac{6}{35} \\cdot 0.49 = \\frac{6}{35} \\cdot \\frac{49}{100} = \\frac{6 \\cdot 7}{5 \\cdot 100} = \\frac{42}{500} = 0.084$\n总和 = $1.0 + 0.64 + 1.44 + 0.36 + 0.3375 + 0.084 = 3.8615$。\n\n分子：$\\sum_{i=1}^{6} w_i h_i y_i$\n- $w_1 h_1 y_1 = 1 \\cdot 1.0 \\cdot 1.2 = 1.2$\n- $w_2 h_2 y_2 = 1 \\cdot 0.8 \\cdot 0.7 = 0.56$\n- $w_3 h_3 y_3 = 1 \\cdot 1.2 \\cdot 1.7 = 2.04$\n- $w_4 h_4 y_4 = 1 \\cdot 0.6 \\cdot 0.2 = 0.12$\n- $w_5 h_5 y_5 = 0.15 \\cdot 1.5 \\cdot 5.5 = 0.225 \\cdot 5.5 = 1.2375$\n- $w_6 h_6 y_6 = \\frac{6}{35} \\cdot 0.7 \\cdot (-2.8) = \\frac{6}{35} \\cdot \\frac{7}{10} \\cdot (-\\frac{28}{10}) = \\frac{6}{50} \\cdot (-\\frac{28}{10}) = \\frac{-16.8}{50} = -0.336$\n总和 = $1.2 + 0.56 + 2.04 + 0.12 + 1.2375 - 0.336 = 4.8215$。\n\n最后，我们计算 $x^{(t+1)}$：\n$$\nx^{(t+1)} = \\frac{4.8215}{3.8615} \\approx 1.24860805...\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nx^{(t+1)} \\approx 1.249\n$$",
            "answer": "$$\n\\boxed{1.249}\n$$"
        }
    ]
}