{
    "hands_on_practices": [
        {
            "introduction": "全波形反演（Full Waveform Inversion, FWI）的目标是最小化观测数据与合成数据之间的差异，但其目标函数具有高度非线性。本练习通过一个简化的理想模型，揭示了这种非线性如何导致目标函数出现多个局部极小值，从而引发“周波跳跃”（cycle skipping）问题。通过分析这个基本场景 ，您将深入理解FWI面临的核心挑战，并为后续更复杂的优化策略打下基础。",
            "id": "3392074",
            "problem": "在全波形反演（FWI）的背景下，考虑一个程式化的一维地震道模型，其中预测的位移信号为 $u(t)=\\sin(\\omega t)$，观测的位移信号为 $v(t)=\\sin(\\omega(t-\\tau))$，其中角频率 $\\omega>0$，时间偏移 $\\tau \\in \\mathbb{R}$ 未知。假设采集时间窗口恰好为 $T=N \\cdot \\frac{2\\pi}{\\omega}$，其中 $N \\in \\mathbb{N}$，并且在区间 $t \\in [0,T]$ 上进行计算。FWI 的 $L_{2}$ 残差定义为数据差值的 $L_{2}$ 范数的平方，即\n$$\nJ(\\tau)=\\frac{1}{2}\\int_{0}^{T}\\big(u(t)-v(t)\\big)^{2}\\,\\mathrm{d}t.\n$$\n从 $L_{2}$ 范数的定义和基本三角恒等式出发，推导 $J(\\tau)$ 作为 $\\tau$、$\\omega$ 和 $T$ 的函数的闭式表达式。然后，分析 $J(\\tau)$ 关于 $\\tau$ 的驻点的位置和性质（局部最小值与局部最大值），并解释这些如何导致 FWI 中的周波跳跃。\n\n所有角度均以弧度表示。无需进行数值计算或四舍五入。您的最终答案必须是 $J(\\tau)$ 以 $\\tau$、$\\omega$ 和 $T$ 表示的单个闭式解析表达式。",
            "solution": "该问题陈述被认为是有效的，因为它具有科学依据、适定且客观。它提出了一个用于分析全波形反演（FWI）中目标函数的程式化但标准的模型，并且没有说明中列出的使其无效的缺陷。\n\n我们首先陈述给定的量。\n预测位移为 $u(t) = \\sin(\\omega t)$。\n观测位移为 $v(t) = \\sin(\\omega(t - \\tau))$。\n采集时间区间为 $[0, T]$，其中 $T = N \\cdot \\frac{2\\pi}{\\omega}$，对于某个整数 $N \\in \\mathbb{N}$。\n$L_2$ 残差函数由下式给出\n$$\nJ(\\tau) = \\frac{1}{2} \\int_{0}^{T} (u(t) - v(t))^2 \\, \\mathrm{d}t\n$$\n代入 $u(t)$ 和 $v(t)$ 的表达式，我们得到\n$$\nJ(\\tau) = \\frac{1}{2} \\int_{0}^{T} (\\sin(\\omega t) - \\sin(\\omega(t - \\tau)))^2 \\, \\mathrm{d}t\n$$\n为了推导 $J(\\tau)$ 的闭式表达式，我们首先展开被积函数：\n$$\n(\\sin(\\omega t) - \\sin(\\omega(t - \\tau)))^2 = \\sin^2(\\omega t) - 2\\sin(\\omega t)\\sin(\\omega(t - \\tau)) + \\sin^2(\\omega(t - \\tau))\n$$\n现在我们可以将 $J(\\tau)$ 写成三个积分的和：\n$$\nJ(\\tau) = \\frac{1}{2} \\left[ \\int_{0}^{T} \\sin^2(\\omega t) \\, \\mathrm{d}t - 2\\int_{0}^{T} \\sin(\\omega t)\\sin(\\omega(t - \\tau)) \\, \\mathrm{d}t + \\int_{0}^{T} \\sin^2(\\omega(t - \\tau)) \\, \\mathrm{d}t \\right]\n$$\n我们分别计算每个积分。\n\n对于第一个积分，我们使用恒等式 $\\sin^2(x) = \\frac{1}{2}(1 - \\cos(2x))$：\n$$\n\\int_{0}^{T} \\sin^2(\\omega t) \\, \\mathrm{d}t = \\int_{0}^{T} \\frac{1}{2}(1 - \\cos(2\\omega t)) \\, \\mathrm{d}t = \\frac{1}{2} \\left[ t - \\frac{\\sin(2\\omega t)}{2\\omega} \\right]_{0}^{T}\n$$\n在积分上下限处求值，我们得到：\n$$\n\\frac{1}{2} \\left( T - \\frac{\\sin(2\\omega T)}{2\\omega} - (0 - 0) \\right) = \\frac{T}{2} - \\frac{\\sin(2\\omega T)}{4\\omega}\n$$\n使用给定条件 $T = N \\frac{2\\pi}{\\omega}$，我们有 $2\\omega T = 2\\omega (N \\frac{2\\pi}{\\omega}) = 4\\pi N$。由于 $N$ 是整数，$\\sin(4\\pi N) = 0$。因此，第一个积分为：\n$$\n\\int_{0}^{T} \\sin^2(\\omega t) \\, \\mathrm{d}t = \\frac{T}{2}\n$$\n第三个积分的计算结果相同。函数 $\\sin^2(\\omega(t-\\tau))$ 只是 $\\sin^2(\\omega t)$ 的一个时间平移版本，并且由于积分区间的长度 $T$ 是信号周期（$P = 2\\pi/\\omega$）的整数倍，这个周期函数的积分值是相同的。严格来说，将 $\\sin^2(x)$ 在任何长度等于其周期 $\\pi$ 的整数倍的区间上积分，得到的是区间长度乘以该函数的平均值（$1/2$）。$\\sin^2(\\omega t)$ 的周期是 $\\pi/\\omega$，而 $T=2N(\\pi/\\omega)$，所以我们是在 $2N$ 个周期上进行积分。\n$$\n\\int_{0}^{T} \\sin^2(\\omega(t - \\tau)) \\, \\mathrm{d}t = \\frac{T}{2}\n$$\n对于第二个积分，即交叉项，我们使用积化和差三角恒等式 $\\sin(A)\\sin(B) = \\frac{1}{2}(\\cos(A-B) - \\cos(A+B))$：\n$$\n\\int_{0}^{T} \\sin(\\omega t)\\sin(\\omega(t - \\tau)) \\, \\mathrm{d}t = \\int_{0}^{T} \\frac{1}{2}(\\cos(\\omega t - \\omega(t - \\tau)) - \\cos(\\omega t + \\omega(t - \\tau))) \\, \\mathrm{d}t\n$$\n$$\n= \\frac{1}{2} \\int_{0}^{T} (\\cos(\\omega\\tau) - \\cos(2\\omega t - \\omega\\tau)) \\, \\mathrm{d}t\n$$\n由于 $\\cos(\\omega\\tau)$ 相对于 $t$ 是常数，我们可以分离积分：\n$$\n= \\frac{1}{2} \\left( \\int_{0}^{T} \\cos(\\omega\\tau) \\, \\mathrm{d}t - \\int_{0}^{T} \\cos(2\\omega t - \\omega\\tau) \\, \\mathrm{d}t \\right)\n$$\n第一部分是 $\\int_{0}^{T} \\cos(\\omega\\tau) \\, \\mathrm{d}t = T\\cos(\\omega\\tau)$。\n对于第二部分，被积函数 $\\cos(2\\omega t - \\omega\\tau)$ 是一个关于 $t$ 的正弦函数，其周期为 $P' = 2\\pi/(2\\omega) = \\pi/\\omega$。积分区间为 $T = N(2\\pi/\\omega) = 2N P'$。由于我们在整数个（$2N$）完整周期上进行积分，积分为零。\n$$\n\\int_{0}^{T} \\cos(2\\omega t - \\omega\\tau) \\, \\mathrm{d}t = 0\n$$\n因此，交叉项积分的计算结果为：\n$$\n\\int_{0}^{T} \\sin(\\omega t)\\sin(\\omega(t - \\tau)) \\, \\mathrm{d}t = \\frac{1}{2} (T\\cos(\\omega\\tau) - 0) = \\frac{T}{2}\\cos(\\omega\\tau)\n$$\n现在，我们将这些结果代回 $J(\\tau)$ 的表达式中：\n$$\nJ(\\tau) = \\frac{1}{2} \\left[ \\frac{T}{2} - 2\\left(\\frac{T}{2}\\cos(\\omega\\tau)\\right) + \\frac{T}{2} \\right] = \\frac{1}{2} [T - T\\cos(\\omega\\tau)]\n$$\n这给出了残差函数的最终闭式表达式：\n$$\nJ(\\tau) = \\frac{T}{2}(1 - \\cos(\\omega\\tau))\n$$\n接下来，我们通过寻找 $J(\\tau)$ 关于 $\\tau$ 的导数为零的点来分析其驻点。\n$$\n\\frac{\\mathrm{d}J}{\\mathrm{d}\\tau} = \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\left[ \\frac{T}{2}(1 - \\cos(\\omega\\tau)) \\right] = \\frac{T}{2}(-(-\\omega\\sin(\\omega\\tau))) = \\frac{T\\omega}{2}\\sin(\\omega\\tau)\n$$\n将导数设为零，$\\frac{\\mathrm{d}J}{\\mathrm{d}\\tau} = 0$，意味着 $\\sin(\\omega\\tau) = 0$，因为 $T > 0$ 且 $\\omega > 0$。当 $\\omega\\tau = k\\pi$（其中 $k \\in \\mathbb{Z}$ 为任意整数）时，该条件成立。因此，驻点为 $\\tau_k = \\frac{k\\pi}{\\omega}$。\n\n为了对这些点进行分类，我们使用二阶导数检验。\n$$\n\\frac{\\mathrm{d}^2J}{\\mathrm{d}\\tau^2} = \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\left[ \\frac{T\\omega}{2}\\sin(\\omega\\tau) \\right] = \\frac{T\\omega^2}{2}\\cos(\\omega\\tau)\n$$\n我们在驻点 $\\tau_k$ 处计算二阶导数：\n$$\n\\left. \\frac{\\mathrm{d}^2J}{\\mathrm{d}\\tau^2} \\right|_{\\tau=\\tau_k} = \\frac{T\\omega^2}{2}\\cos\\left(\\omega \\frac{k\\pi}{\\omega}\\right) = \\frac{T\\omega^2}{2}\\cos(k\\pi)\n$$\n- 如果 $k$ 是偶数（$k=2m$，$m \\in \\mathbb{Z}$），则 $\\cos(k\\pi)=1$。二阶导数为 $\\frac{T\\omega^2}{2} > 0$，表示这是一个**局部最小值**。这些点出现在 $\\tau = \\frac{2m\\pi}{\\omega}$。这些点对应于等于信号周期 $P = 2\\pi/\\omega$ 整数倍的时间偏移。在这些点上，$u(t) = v(t)$ 且残差 $J(\\tau)=0$，所以它们是全局最小值。\n- 如果 $k$ 是奇数（$k=2m+1$，$m \\in \\mathbb{Z}$），则 $\\cos(k\\pi)=-1$。二阶导数为 $-\\frac{T\\omega^2}{2}  0$，表示这是一个**局部最大值**。这些点出现在 $\\tau = \\frac{(2m+1)\\pi}{\\omega}$。这些点对应于等于周期半整数倍的时间偏移，此时信号完全反相，残差达到最大值。\n\n这个分析揭示了 FWI 中**周波跳跃**的原因。目标函数 $J(\\tau)$ 是周期性的，并拥有多个局部极小值。FWI 中标准的基于梯度的优化算法会沿残差曲面迭代下降以寻找一个极小值。如果模型参数 $\\tau$ 的初始猜测距离真实值太远，算法将收敛到最近的局部极小值，而不一定是全局极小值（即真实解）。\n\n在一般情况下，如果真实时间偏移是 $\\tau_{true}$，则模型参数为 $\\tau_{model}$ 的残差函数为 $J(\\tau_{model}) \\propto 1 - \\cos(\\omega(\\tau_{model} - \\tau_{true}))$。极小值位于 $\\tau_{model} - \\tau_{true} = \\frac{2m\\pi}{\\omega}$。只有当初始误差 $|\\tau_{model,0} - \\tau_{true}|$ 小于半个周期，即 $|\\tau_{model,0} - \\tau_{true}|  \\frac{\\pi}{\\omega}$ 时，局部优化方法才会收敛到真实解 $\\tau_{model} = \\tau_{true}$（即 $m=0$）。如果初始误差更大，梯度将指向一个“错误”的极小值（其中 $m \\neq 0$），算法会陷入困境。这就是周波跳跃：反演跳过了一个或多个波的周期，并收敛到一个物理上不正确但仍能产生较低残差的模型。",
            "answer": "$$\n\\boxed{\\frac{T}{2}(1 - \\cos(\\omega\\tau))}\n$$"
        },
        {
            "introduction": "在求解反问题时，重新参数化是一种改善问题性质、提升优化效率的有效策略。本练习将探讨地球物理反演中广泛使用的对数变换，您将推导速度模型在对数参数化下的梯度表达式，并分析其对梯度的缩放效应。通过这项实践 ，您会发现一个简单的变量替换不仅能保证参数的物理约束（如速度为正），还能有效调整梯度各分量的权重，从而改善优化算法的收敛性。",
            "id": "3392093",
            "problem": "考虑一个标准的声波全波形反演 (FWI) 设置，在一个有界空间域 $\\Omega \\subset \\mathbb{R}^{d}$ 和有限时间窗口 $[0,T]$ 上，其中声波方程\n$$\n\\frac{1}{v(x)^{2}} \\,\\partial_{tt} u(x,t) - \\Delta u(x,t) = q(x,t)\n$$\n控制着波场 $u(x,t)$，源为 $q(x,t)$，波速 $v(x)  0$ 与位置相关。拟合泛函定义为\n$$\n\\phi(v) = \\frac{1}{2} \\int_{0}^{T} \\| P u(v;\\cdot,t) - d(t) \\|_{2}^{2} \\, dt,\n$$\n其中 $P$ 表示将波场映射到接收点位置的线性采样算子，$d(t)$ 表示观测数据。假设在标准条件下，Fréchet 导数 $D\\phi$ 和 $L^{2}(\\Omega)$ 梯度存在，并将 $L^{2}(\\Omega)$ 内积写作 $\\langle f, g \\rangle = \\int_{\\Omega} f(x) g(x) \\, dx$。\n\n引入对数参数化 $\\theta(x) = \\ln v(x)$，因此 $v(x) = \\exp(\\theta(x))$。对于 $v$ 和 $\\theta$，都在参数空间 $L^{2}(\\Omega)$ 中进行操作。您的任务是：\n\n1. 从 Fréchet 导数的定义和梯度的 $L^{2}(\\Omega)$ Riesz 表示出发，推导拟合关于对数参数 $\\theta$ 的梯度与关于物理参数 $v$ 的梯度之间的表达式。\n\n2. 令 $T_{v}: L^{2}(\\Omega) \\to L^{2}(\\Omega)$ 是由 $(T_{v} w)(x) = v(x) \\, w(x)$ 定义的乘法算子。利用在 $\\Omega$ 上的本性上确界，证明 $T_{v}$ 是有界的，并用 $v$ 表示其算子范数。\n\n3. 假设 $v$ 是严格为正且本性有界的，讨论此变换对对数参数化中梯度的有界性和缩放的影响。特别地，将变换后梯度的范数与算子 $T_{v}$ 的范数联系起来。\n\n4. 考虑一维域 $\\Omega = [0,1]$ 和波速剖面\n$$\nv(x) = 2000 + 500 \\,\\sin(2\\pi x),\n$$\n其中 $v$ 的单位是米/秒。计算此 $v(x)$ 对应的算子 $T_{v}$ 的范数，并以米/秒为单位给出最终值。将您的答案四舍五入到四位有效数字。以米/秒为单位表示最终值。",
            "solution": "该问题是有效的，因为它基于反问题理论和泛函分析，是适定的，并且所有提供的信息对于求解都是一致和充分的。\n\n解答分为四个部分，与问题陈述中列出的任务相对应。\n\n### 第1部分：对数参数化中的梯度\n\n令关于物理参数 $v$ 的拟合泛函表示为 $\\phi(v)$。我们引入一个新的泛函 $\\tilde{\\phi}$，它依赖于对数参数 $\\theta(x) = \\ln v(x)$，即 $\\tilde{\\phi}(\\theta) = \\phi(v(\\theta))$，其中 $v(\\theta) = \\exp(\\theta)$。我们的目标是找到 $L^2(\\Omega)$ 梯度 $\\nabla_v \\phi$ 和 $\\nabla_\\theta \\tilde{\\phi}$ 之间的关系。\n\n一个泛函的 Fréchet 导数由其对小扰动的作用定义。根据 Fréchet 导数的链式法则，$\\tilde{\\phi}$ 在 $\\theta$ 处沿扰动方向 $\\delta\\theta$ 的导数由下式给出：\n$$\nD\\tilde{\\phi}(\\theta)[\\delta\\theta] = D\\phi(v(\\theta))[Dv(\\theta)[\\delta\\theta]]\n$$\n这里，$Dv(\\theta)[\\delta\\theta]$ 是映射 $v(\\theta) = \\exp(\\theta)$ 应用于 $\\delta\\theta$ 的 Fréchet 导数。为了求这个导数，我们考虑一个小扰动：\n$$\nv(\\theta + \\delta\\theta) = \\exp(\\theta + \\delta\\theta) = \\exp(\\theta) \\exp(\\delta\\theta)\n$$\n使用指数函数 $\\exp(\\delta\\theta) = 1 + \\delta\\theta + O((\\delta\\theta)^2)$ 的泰勒级数展开，我们得到：\n$$\nv(\\theta + \\delta\\theta) \\approx \\exp(\\theta)(1 + \\delta\\theta) = v(\\theta) + v(\\theta)\\delta\\theta\n$$\n$v$ 相对于 $\\delta\\theta$ 变化的线性部分是 $v(\\theta)\\delta\\theta$。因此，Fréchet 导数的作用是乘法：\n$$\n\\delta v = Dv(\\theta)[\\delta\\theta] = v(\\theta)\\delta\\theta(x)\n$$\n将此代入链式法则表达式，得到：\n$$\nD\\tilde{\\phi}(\\theta)[\\delta\\theta] = D\\phi(v)[v\\delta\\theta]\n$$\n一个泛函的 $L^2(\\Omega)$ 梯度是通过 Riesz 表示定理定义的。对于 $\\phi(v)$ 和 $\\tilde{\\phi}(\\theta)$，它们的梯度 $\\nabla_v \\phi$ 和 $\\nabla_\\theta \\tilde{\\phi}$ 满足：\n$$\nD\\phi(v)[\\delta v] = \\langle \\nabla_v \\phi, \\delta v \\rangle = \\int_{\\Omega} (\\nabla_v \\phi)(x) \\delta v(x) \\, dx\n$$\n$$\nD\\tilde{\\phi}(\\theta)[\\delta\\theta] = \\langle \\nabla_\\theta \\tilde{\\phi}, \\delta\\theta \\rangle = \\int_{\\Omega} (\\nabla_\\theta \\tilde{\\phi})(x) \\delta\\theta(x) \\, dx\n$$\n对于任何扰动 $\\delta v, \\delta\\theta \\in L^2(\\Omega)$。\n\n使用这些定义，我们可以重写链式法则方程。左边是 $\\langle \\nabla_\\theta \\tilde{\\phi}, \\delta\\theta \\rangle$。右边是：\n$$\nD\\phi(v)[v\\delta\\theta] = \\langle \\nabla_v \\phi, v\\delta\\theta \\rangle = \\int_{\\Omega} (\\nabla_v \\phi)(x) (v(x)\\delta\\theta(x)) \\, dx\n$$\n通过重新排列积分内的项，我们得到：\n$$\n\\int_{\\Omega} (v(x) (\\nabla_v \\phi)(x)) \\delta\\theta(x) \\, dx = \\langle v \\nabla_v \\phi, \\delta\\theta \\rangle\n$$\n令 $D\\tilde{\\phi}(\\theta)[\\delta\\theta]$ 的两种形式相等，可得：\n$$\n\\langle \\nabla_\\theta \\tilde{\\phi}, \\delta\\theta \\rangle = \\langle v \\nabla_v \\phi, \\delta\\theta \\rangle\n$$\n由于这个等式必须对所有 $\\delta\\theta \\in L^2(\\Omega)$ 成立，所以内积中的函数必须几乎处处相等。因此，两个梯度之间的关系是：\n$$\n\\nabla_\\theta \\tilde{\\phi}(x) = v(x) \\nabla_v \\phi(x)\n$$\n\n### 第2部分：算子 $T_v$ 的有界性和范数\n\n线性算子 $T_v: L^2(\\Omega) \\to L^2(\\Omega)$ 通过乘法定义：$(T_v w)(x) = v(x)w(x)$。要证明 $T_v$ 是有界的，我们必须证明存在一个常数 $C \\ge 0$，使得对所有 $w \\in L^2(\\Omega)$，都有 $\\|T_v w\\|_{L^2} \\le C \\|w\\|_{L^2}$。\n\n$T_v w$ 范数的平方是：\n$$\n\\|T_v w\\|_{L^2}^2 = \\int_{\\Omega} |(T_v w)(x)|^2 \\, dx = \\int_{\\Omega} |v(x)w(x)|^2 \\, dx = \\int_{\\Omega} |v(x)|^2 |w(x)|^2 \\, dx\n$$\n问题假设 $v$ 是本性有界的，这意味着它的 $L^\\infty$ 范数 $\\|v\\|_{L^\\infty} = \\text{ess sup}_{x \\in \\Omega} |v(x)|$ 是有限的。根据本性上确界的定义，对于几乎每个 $x \\in \\Omega$，都有 $|v(x)| \\le \\|v\\|_{L^\\infty}$。因此：\n$$\n\\int_{\\Omega} |v(x)|^2 |w(x)|^2 \\, dx \\le \\int_{\\Omega} (\\|v\\|_{L^\\infty})^2 |w(x)|^2 \\, dx = (\\|v\\|_{L^\\infty})^2 \\int_{\\Omega} |w(x)|^2 \\, dx = \\|v\\|_{L^\\infty}^2 \\|w\\|_{L^2}^2\n$$\n两边取平方根，我们得到：\n$$\n\\|T_v w\\|_{L^2} \\le \\|v\\|_{L^\\infty} \\|w\\|_{L^2}\n$$\n这个不等式对所有 $w \\in L^2(\\Omega)$ 都成立，证明了 $T_v$ 是一个有界算子，其算子范数 $\\|T_v\\| \\le \\|v\\|_{L^\\infty}$。\n\n为了确定算子范数 $\\|T_v\\| = \\sup_{\\|w\\|_{L^2}=1} \\|T_v w\\|_{L^2}$，我们需要证明这个界是紧的。设 $M = \\|v\\|_{L^\\infty}$。根据本性上确界的定义，对于任何 $\\epsilon  0$，集合 $S_\\epsilon = \\{x \\in \\Omega : |v(x)|  M-\\epsilon\\}$ 的测度为正，即 $\\mu(S_\\epsilon)  0$。\n\n考虑归一化函数序列 $w_\\epsilon(x) = \\frac{1}{\\sqrt{\\mu(S_\\epsilon)}} \\chi_{S_\\epsilon}(x)$，其中 $\\chi_{S_\\epsilon}$ 是集合 $S_\\epsilon$ 的特征函数。$w_\\epsilon$ 的 $L^2$ 范数是：\n$$\n\\|w_\\epsilon\\|_{L^2}^2 = \\int_{\\Omega} \\left(\\frac{1}{\\sqrt{\\mu(S_\\epsilon)}} \\chi_{S_\\epsilon}(x)\\right)^2 \\, dx = \\frac{1}{\\mu(S_\\epsilon)} \\int_{S_\\epsilon} 1 \\, dx = 1\n$$\n现在，我们将 $T_v$ 应用于 $w_\\epsilon$：\n$$\n\\|T_v w_\\epsilon\\|_{L^2}^2 = \\int_{\\Omega} |v(x)|^2 |w_\\epsilon(x)|^2 \\, dx = \\frac{1}{\\mu(S_\\epsilon)} \\int_{S_\\epsilon} |v(x)|^2 \\, dx\n$$\n由于对所有 $x \\in S_\\epsilon$，都有 $|v(x)|  M-\\epsilon$，我们得到 $|v(x)|^2  (M-\\epsilon)^2$。因此：\n$$\n\\|T_v w_\\epsilon\\|_{L^2}^2  \\frac{1}{\\mu(S_\\epsilon)} \\int_{S_\\epsilon} (M-\\epsilon)^2 \\, dx = \\frac{(M-\\epsilon)^2}{\\mu(S_\\epsilon)} \\mu(S_\\epsilon) = (M-\\epsilon)^2\n$$\n这意味着 $\\|T_v w_\\epsilon\\|_{L^2}  M-\\epsilon$。由于 $\\|w_\\epsilon\\|_{L^2}=1$，算子范数必须满足 $\\|T_v\\| \\ge \\|T_v w_\\epsilon\\|_{L^2}  M-\\epsilon$。因为这对任意小的 $\\epsilon  0$ 都成立，我们必然有 $\\|T_v\\| \\ge M$。\n\n结合这两个不等式 $\\|T_v\\| \\le M$ 和 $\\|T_v\\| \\ge M$，我们得出结论，算子 $T_v$ 的范数恰好是 $|v(x)|$ 的本性上确界：\n$$\n\\|T_v\\| = \\|v\\|_{L^\\infty(\\Omega)} = \\text{ess sup}_{x \\in \\Omega} |v(x)|\n$$\n\n### 第3部分：对数参数化的影响\n\n从物理参数梯度 $\\nabla_v \\phi$ 到对数参数梯度 $\\nabla_\\theta \\tilde{\\phi}$ 的变换由第1部分推导出的关系给出：\n$$\n\\nabla_\\theta \\tilde{\\phi} = v \\nabla_v \\phi\n$$\n使用第2部分的算子 $T_v$，这可以表示为：\n$$\n\\nabla_\\theta \\tilde{\\phi} = T_v(\\nabla_v \\phi)\n$$\n这个关系对有界性和缩放有几个重要的影响：\n\n1.  **有界性**: 由于假设 $v$ 是本性有界的（$v \\in L^\\infty(\\Omega)$）并且 $\\nabla_v\\phi$ 属于 $L^2(\\Omega)$，那么乘积 $v \\nabla_v\\phi$ 也属于 $L^2(\\Omega)$。这是由 $T_v$ 是从 $L^2(\\Omega)$到 $L^2(\\Omega)$ 的有界算子这一事实保证的。因此，对数参数化将一个有效的 $L^2$ 梯度映射到另一个有效的 $L^2$ 梯度。\n\n2.  **缩放**: 变换后梯度的范数与原始梯度的范数相关：\n    $$\n    \\|\\nabla_\\theta \\tilde{\\phi}\\|_{L^2} = \\|T_v(\\nabla_v \\phi)\\|_{L^2} \\le \\|T_v\\| \\|\\nabla_v \\phi\\|_{L^2}\n    $$\n    使用第2部分的结果，我们有：\n    $$\n    \\|\\nabla_\\theta \\tilde{\\phi}\\|_{L^2} \\le \\|v\\|_{L^\\infty} \\|\\nabla_v \\phi\\|_{L^2}\n    $$\n    这表明，在对数参数空间中，梯度的大小被速度场缩放。该变换起到一个空间变化的缩放因子的作用，或者在离散化设置中作为一个对角预条件子。\n\n3.  **对优化的影响**: 在地球物理FWI中，波场敏感度（以及梯度 $\\nabla_v \\phi$）通常随深度衰减。同时，背景速度 $v(x)$ 通常随深度增加。因此，在 $\\nabla_\\theta \\tilde{\\phi} = v \\nabla_v \\phi$ 中乘以 $v(x)$ 可以抵消这种衰减，放大更深、高速区域的梯度。这种对梯度分量的重新平衡可以导致整个区域内更均匀的模型更新，并通常能改善基于梯度的优化算法的收敛速度和稳定性。\n\n### 第4部分：算子范数的计算\n\n对于一维域 $\\Omega = [0,1]$，我们给出的波速剖面为：\n$$\nv(x) = 2000 + 500 \\sin(2\\pi x) \\quad (\\text{单位：米/秒})\n$$\n根据第2部分，算子 $T_v$ 的范数是 $\\|T_v\\| = \\text{ess sup}_{x \\in [0,1]} |v(x)|$。由于 $v(x)$ 是紧区间 $[0,1]$ 上的连续函数，其本性上确界就是它的最大值。\n函数 $v(x)$ 总是正的，因为 $\\sin(2\\pi x)$ 的范围是 $[-1, 1]$，所以：\n$$\nv_{min} = 2000 + 500(-1) = 1500 \\, \\text{m/s}\n$$\n$$\nv_{max} = 2000 + 500(1) = 2500 \\, \\text{m/s}\n$$\n由于对所有 $x \\in [0,1]$，$v(x)  0$，我们有 $|v(x)| = v(x)$。$v(x)$ 的最大值决定了算子范数。$v(x)$ 的最大值是 $v_{max}$。\n因此，算子范数为：\n$$\n\\|T_v\\| = \\max_{x \\in [0,1]} v(x) = 2500\n$$\n算子范数的单位与 $v(x)$ 的单位相同，即米/秒。问题要求将答案四舍五入到四位有效数字。精确答案是 $2500$。为了用四位有效数字表示，我们可以写成 $2.500 \\times 10^3$。",
            "answer": "$$\n\\boxed{2.500 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "获得一个模型估计并非反演工作的终点，我们还必须理解其可靠性以及模型的哪些部分能被数据有效约束。本练习在一个线性化的贝叶斯框架下，推导模型分辨率算子和后验协方差。通过分析它们的性质 ，您将洞察模型分辨率与不确定性之间受正则化调控的基本权衡关系，这对于解释反演结果至关重要。",
            "id": "3392079",
            "problem": "考虑地震成像中关于背景模型的一个线性化全波形反演 (FWI) 步骤，其中数据残差建模为 $d = G \\, \\delta m + \\varepsilon$。这里，$G$ 是在背景模型处计算的线性化弗雷歇导数（雅可比矩阵），$\\delta m$ 是模型扰动，$\\varepsilon$ 是加性观测噪声。假设 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma_{d}^{2} I)$ 的高斯似然和 $\\delta m \\sim \\mathcal{N}(0, \\sigma_{m}^{2} I)$ 的独立高斯先验。关于 $\\delta m$ 的后验分布是高斯的。在此线性高斯设定中，模型分辨率算子量化了真实模型的各分量如何映射到 $\\delta m$ 的后验均值估计量中。\n\n仅使用这些假设，并从第一性原理（贝叶斯线性高斯推断和 $G$ 的奇异值分解 (SVD)）出发，完成以下任务：\n\n1) 在与 $G$ 的右奇异向量对齐的基中，推导后验协方差算子和模型分辨率算子。设奇异值分解为 $G = U \\Sigma V^{\\top}$，其中 $U$ 和 $V$ 是正交矩阵，$\\Sigma$ 是对角矩阵，其对角线上的非负项为 $\\{\\sigma_{i}\\}$。引入标量 $\\lambda^{2} = \\sigma_{d}^{2} / \\sigma_{m}^{2}$，并用 $\\{\\sigma_{i}\\}$ 和 $\\lambda$ 表示模型分辨率算子的特征值和沿右奇异向量方向的后验方差。\n\n2) 解释增加先验精度（等价于减小 $\\sigma_{m}^{2}$，从而在固定的 $\\sigma_{d}^{2}$ 下增大 $\\lambda^{2}$）如何影响沿每个奇异方向的后验方差和模型分辨率特征值。\n\n3) 现在，特化到一个有限维情景，其中 $G$ 的秩 $r=4$，奇异值为 $\\{\\sigma_{1}, \\sigma_{2}, \\sigma_{3}, \\sigma_{4}\\} = \\{20, 5, 1, 0.2\\}$。设 $\\sigma_{d} = 0.5$ 和 $\\sigma_{m} = 2$，并取模型维度等于秩，因此没有零空间贡献。计算模型分辨率算子的迹。你的最终答案必须是一个无量纲的实数，并四舍五入到四位有效数字。",
            "solution": "首先验证问题，发现其有效、适定且有科学依据。它代表了一个标准的线性高斯贝叶斯反问题。我们着手求解。\n\n该问题要求从第一性原理出发，对一个线性化的贝叶斯反问题进行三部分分析。联系数据残差 $d$ 与模型扰动 $\\delta m$ 的模型由 $d = G \\delta m + \\varepsilon$ 给出。\n\n似然基于高斯噪声的假设，$\\varepsilon \\sim \\mathcal{N}(0, \\sigma_{d}^{2} I)$，这意味着给定模型 $\\delta m$ 的数据 $d$ 的概率密度函数 (PDF) 为：\n$$p(d|\\delta m) \\propto \\exp\\left(-\\frac{1}{2\\sigma_{d}^{2}} \\|d - G\\delta m\\|^2\\right)$$\n模型扰动的先验也是高斯的，$\\delta m \\sim \\mathcal{N}(0, \\sigma_{m}^{2} I)$，其概率密度函数为：\n$$p(\\delta m) \\propto \\exp\\left(-\\frac{1}{2\\sigma_{m}^{2}} \\|\\delta m\\|^2\\right)$$\n\n根据贝叶斯定理，后验概率密度函数 $p(\\delta m|d)$ 正比于似然和先验的乘积：\n$$p(\\delta m|d) \\propto p(d|\\delta m) \\, p(\\delta m)$$\n$$p(\\delta m|d) \\propto \\exp\\left(-\\frac{1}{2\\sigma_{d}^{2}} \\|d - G\\delta m\\|^2\\right) \\exp\\left(-\\frac{1}{2\\sigma_{m}^{2}} \\|\\delta m\\|^2\\right)$$\n合并指数项，我们得到：\n$$p(\\delta m|d) \\propto \\exp\\left\\{ -\\frac{1}{2} \\left( \\frac{1}{\\sigma_{d}^{2}} \\|d - G\\delta m\\|^2 + \\frac{1}{\\sigma_{m}^{2}} \\|\\delta m\\|^2 \\right) \\right\\}$$\n这是 $\\delta m$ 的一个多元高斯分布的概率密度函数。对于均值为 $\\mu$、协方差为 $\\Sigma_{cov}$ 的向量 $x$，其一般的多元高斯概率密度函数正比于 $\\exp\\left(-\\frac{1}{2}(x - \\mu)^{\\top} \\Sigma_{cov}^{-1} (x - \\mu)\\right)$。展开我们指数中的二次型，可以识别出后验协方差 $C_{post}$ 和后验均值 $\\delta m_{post}$。指数中关于 $\\delta m$ 的二次项是：\n$$\\frac{1}{\\sigma_{d}^{2}}(G\\delta m)^{\\top}(G\\delta m) + \\frac{1}{\\sigma_{m}^{2}} \\delta m^{\\top}\\delta m = \\delta m^{\\top} \\left( \\frac{1}{\\sigma_{d}^{2}}G^{\\top}G + \\frac{1}{\\sigma_{m}^{2}}I \\right) \\delta m$$\n由此，我们识别出后验协方差矩阵的逆：\n$$C_{post}^{-1} = \\frac{1}{\\sigma_{d}^{2}}G^{\\top}G + \\frac{1}{\\sigma_{m}^{2}}I = \\frac{1}{\\sigma_{d}^{2}}\\left(G^{\\top}G + \\frac{\\sigma_{d}^{2}}{\\sigma_{m}^{2}}I\\right)$$\n使用定义 $\\lambda^{2} = \\sigma_{d}^{2} / \\sigma_{m}^{2}$，我们有：\n$$C_{post}^{-1} = \\frac{1}{\\sigma_{d}^{2}}(G^{\\top}G + \\lambda^2 I)$$\n因此，后验协方差算子为：\n$$C_{post} = \\sigma_{d}^{2}(G^{\\top}G + \\lambda^2 I)^{-1}$$\n\n**第一部分：SVD基中的后验协方差和模型分辨率算子**\n\n我们引入 $G$ 的奇异值分解 (SVD)：$G = U \\Sigma V^{\\top}$，其中 $U$ 和 $V$ 是正交矩阵，$\\Sigma$ 是奇异值 $\\{\\sigma_i\\}$ 构成的对角矩阵。我们有 $G^{\\top}G = (V \\Sigma^{\\top} U^{\\top})(U \\Sigma V^{\\top}) = V \\Sigma^{\\top}\\Sigma V^{\\top} = V \\Sigma^2 V^{\\top}$。\n\n将此代入 $C_{post}$ 的表达式中：\n$$C_{post} = \\sigma_{d}^{2}(V \\Sigma^2 V^{\\top} + \\lambda^2 V V^{\\top})^{-1} = \\sigma_{d}^{2}(V(\\Sigma^2 + \\lambda^2 I)V^{\\top})^{-1}$$\n使用性质 $(ABC)^{-1} = C^{-1}B^{-1}A^{-1}$ 和 $V^{-1}=V^{\\top}$，我们得到：\n$$C_{post} = \\sigma_{d}^{2}V(\\Sigma^2 + \\lambda^2 I)^{-1}V^{\\top}$$\n此表达式表明，后验协方差算子在 $G$ 的右奇异向量 $\\{v_i\\}$ 构成的基中是对角的。$C_{post}$ 的特征值，代表了沿这些主方向的后验方差，是矩阵 $\\sigma_{d}^{2}(\\Sigma^2 + \\lambda^2 I)^{-1}$ 的对角线元素。沿第 $i$ 个右奇异向量 $v_i$ 方向的后验方差为：\n$$ \\text{Var}(\\delta m_i) = \\frac{\\sigma_{d}^{2}}{\\sigma_i^2 + \\lambda^2} $$\n\n模型分辨率算子 $R$ 将真实模型扰动 $\\delta m_{true}$ 映射到后验均值估计 $\\delta m_{post}$。后验均值是最小化负对数后验的 $\\delta m$ 的值，这给出了标准的吉洪诺夫正则化解：$\\delta m_{post} = (G^{\\top}G + \\lambda^2 I)^{-1}G^{\\top}d$。为定义 $R$，我们考虑估计量如何作用于真实模型，即我们代入 $d=G \\delta m_{true}$：\n$$\\delta m_{post} = (G^{\\top}G + \\lambda^2 I)^{-1}G^{\\top}G \\delta m_{true}$$\n因此，模型分辨率算子为 $R = (G^{\\top}G + \\lambda^2 I)^{-1}G^{\\top}G$。\n将SVD代入此表达式：\n$$R = (V \\Sigma^2 V^{\\top} + \\lambda^2 I)^{-1}(V \\Sigma^2 V^{\\top}) = (V(\\Sigma^2 + \\lambda^2 I)V^{\\top})^{-1}(V \\Sigma^2 V^{\\top})$$\n$$R = V(\\Sigma^2 + \\lambda^2 I)^{-1}V^{\\top}V \\Sigma^2 V^{\\top} = V \\left[ (\\Sigma^2 + \\lambda^2 I)^{-1} \\Sigma^2 \\right] V^{\\top}$$\n这表明 $R$ 在右奇异向量 $\\{v_i\\}$ 构成的基中也是对角的。模型分辨率算子 $\\{\\mu_i\\}$ 的特征值是矩阵 $(\\Sigma^2 + \\lambda^2 I)^{-1}\\Sigma^2$ 的对角线元素。第 $i$ 个特征值为：\n$$ \\mu_i = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2} $$\n\n**第二部分：增加先验精度的解释**\n\n增加先验精度意味着减小先验方差 $\\sigma_m^2$。对于固定的数据噪声方差 $\\sigma_d^2$，这会导致正则化参数 $\\lambda^2 = \\sigma_d^2 / \\sigma_m^2$ 的增加。我们分析 $\\lambda^2 \\to \\infty$ 时的效应。\n\n对于沿方向 $v_i$ 的后验方差：\n$$ \\lim_{\\lambda^2 \\to \\infty} \\frac{\\sigma_{d}^{2}}{\\sigma_i^2 + \\lambda^2} = 0 $$\n更强的先验（更小的 $\\sigma_m^2$）会更强力地将后验分布拉向先验均值（即0），从而将后验不确定性（方差）减小到零。解变得由先验主导，与数据无关。\n\n对于模型分辨率特征值：\n$$ \\lim_{\\lambda^2 \\to \\infty} \\mu_i = \\lim_{\\lambda^2 \\to \\infty} \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2} = 0 $$\n分辨率特征值，通常称为滤波因子，量化了真实模型沿方向 $v_i$ 的分量在解中被恢复的程度。$\\mu_i$ 的值接近1表示分辨率好，而接近0表示分辨率差。随着先验精度的增加，$\\lambda^2$ 增大，所有分辨率特征值都趋向于0。这意味着估计的模型扰动 $\\delta m_{post}$ 对真实模型扰动 $\\delta m_{true}$ 变得不敏感，而是被收缩到先验均值0。高正则化牺牲分辨率以减小方差。\n\n**第三部分：模型分辨率算子迹的计算**\n\n矩阵的迹是其特征值的总和。因此，模型分辨率算子 $\\text{Tr}(R)$ 的迹是其特征值 $\\mu_i$ 的总和：\n$$\\text{Tr}(R) = \\sum_{i} \\mu_i = \\sum_{i} \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$$\n我们已知以下数值：\n奇异值：$\\{\\sigma_1, \\sigma_2, \\sigma_3, \\sigma_4\\} = \\{20, 5, 1, 0.2\\}$\n数据标准差：$\\sigma_d = 0.5$\n先验标准差：$\\sigma_m = 2$\n模型维度等于秩，$r=4$，因此求和是针对这4个模式。\n\n首先，我们计算 $\\lambda^2$：\n$$\\lambda^2 = \\frac{\\sigma_d^2}{\\sigma_m^2} = \\frac{(0.5)^2}{2^2} = \\frac{0.25}{4} = 0.0625$$\n接下来，我们计算奇异值的平方：\n$\\sigma_1^2 = 20^2 = 400$\n$\\sigma_2^2 = 5^2 = 25$\n$\\sigma_3^2 = 1^2 = 1$\n$\\sigma_4^2 = 0.2^2 = 0.04$\n\n现在我们计算 $R$ 的特征值之和：\n$$\\text{Tr}(R) = \\frac{400}{400 + 0.0625} + \\frac{25}{25 + 0.0625} + \\frac{1}{1 + 0.0625} + \\frac{0.04}{0.04 + 0.0625}$$\n$$\\text{Tr}(R) = \\frac{400}{400.0625} + \\frac{25}{25.0625} + \\frac{1}{1.0625} + \\frac{0.04}{0.1025}$$\n$$\\text{Tr}(R) \\approx 0.99984377 + 0.99750623 + 0.94117647 + 0.39024390$$\n$$\\text{Tr}(R) \\approx 3.32877037$$\n四舍五入到四位有效数字，我们得到 $3.329$。",
            "answer": "$$\\boxed{3.329}$$"
        }
    ]
}