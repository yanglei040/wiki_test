{
    "hands_on_practices": [
        {
            "introduction": "理解随机数生成器的循环结构是评估其质量的基础。一个过快重复或陷入短循环的生成器不适合大多数模拟。此练习  提供了一个亲手剖析具有复合模数的线性同余生成器 (LCG) 行为的机会。通过应用中国剩余定理，您将看到整体动力学是如何由在更小的素数幂模数上的更简单动力学组合而成的，这是分析 LCG 的一种强大技术。",
            "id": "3332055",
            "problem": "考虑定义在模 $m$ 整数环上的混合线性同余生成器 (LCG)，其递推关系为\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{m},\n$$\n参数为 $a=8$，$c=11$，$m=225$，种子为 $X_0=172$。请从第一性原理出发：仅使用核心定义（例如，轨道的周期、不动点、有限集上排列的循环分解）和公认的事实（例如，中国剩余定理 (CRT) 和欧拉$\\phi$函数 (totient function)的性质），并推导任何必要的中间结论。在未从这些基础出发进行推导的情况下，请勿假设或引用关于LCG周期的专门“捷径”定理。\n\n任务：\n1. 确定从给定种子 $X_0$ 开始的轨道的精确周期 $L$。\n2. 找出在 $\\mathbb{Z}_m$ 上诱导的状态转移的所有“短”周期和不动点，其中“短”周期指长度严格小于5的周期。特别地，确定在整个状态空间 $\\{0,1,\\dots,m-1\\}$ 上，长度分别为 $1$、$2$、$3$ 和 $4$ 的不同周期的数量 $N_1$、$N_2$、$N_3$ 和 $N_4$。\n\n将最终答案以行向量 $(L, N_1, N_2, N_3, N_4)$ 的形式报告。无需四舍五入。不涉及物理单位。",
            "solution": "用户希望分析一个由递推关系 $X_{n+1} \\equiv a X_n + c \\pmod{m}$ 定义的混合线性同余生成器 (LCG) 的性质，其参数为 $a=8$，$c=11$，$m=225$，初始种子为 $X_0=172$。问题要求找到从 $X_0$ 开始的序列的周期，并计算在整个状态空间 $\\mathbb{Z}_{225}$ 上短周期（长度为1到4）的数量。解答必须从第一性原理推导得出。\n\n分析的核心依赖于中国剩余定理 (CRT)，因为模数 $m=225$ 是一个合数：$m = 9 \\times 25 = 3^2 \\times 5^2$。\n设状态转移函数为 $f(x) = 8x + 11 \\pmod{225}$。\n根据CRT，环 $\\mathbb{Z}_{225}$ 同构于积环 $\\mathbb{Z}_9 \\times \\mathbb{Z}_{25}$。$\\mathbb{Z}_{225}$ 中的一个元素 $x$ 对应于一个数对 $(y, z)$，其中 $y = x \\pmod 9$ 且 $z = x \\pmod{25}$。\n函数 $f(x)$可以分解为两个独立的函数：\n$f_1(y) = 8y + 11 \\pmod 9$\n$f_2(z) = 8z + 11 \\pmod{25}$\n\n简化这些表达式：\n$f_1(y) \\equiv -y + 2 \\pmod 9$\n$f_2(z) \\equiv 8z + 11 \\pmod{25}$\n\n$f$ 在 $\\mathbb{Z}_{225}$ 上的动力学行为由 $f_1$ 在 $\\mathbb{Z}_9$ 上的动力学行为和 $f_2$ 在 $\\mathbb{Z}_{25}$ 上的动力学行为所决定。具体来说，如果一个元素 $y \\in \\mathbb{Z}_9$ 在 $f_1$ 下处于一个长度为 $k_1$ 的周期中，而一个元素 $z \\in \\mathbb{Z}_{25}$ 在 $f_2$ 下处于一个长度为 $k_2$ 的周期中，那么对应的元素 $x \\in \\mathbb{Z}_{225}$ 就处于一个长度为 $k = \\text{lcm}(k_1, k_2)$ 的周期中。\n\n**任务1：确定从 $X_0=172$ 开始的轨道的周期 $L$。**\n\n首先，我们将种子 $X_0=172$ 分解到其在 $\\mathbb{Z}_9 \\times \\mathbb{Z}_{25}$ 中的分量：\n$Y_0 = 172 \\pmod 9$。因为 $172 = 19 \\times 9 + 1$，我们得到 $Y_0 = 1$。\n$Z_0 = 172 \\pmod{25}$。因为 $172 = 6 \\times 25 + 22$，我们得到 $Z_0 = 22$。\n\n接着，我们求解在 $f_1(y) = -y+2 \\pmod 9$ 下从 $Y_0=1$ 开始的序列 $\\{Y_n\\}$ 的周期。\n$Y_1 = f_1(Y_0) = f_1(1) = -1+2 = 1$。\n由于 $Y_1=Y_0$，该序列是常数序列：$1, 1, 1, \\dots$。此分量的周期为 $L_1=1$。\n\n然后，我们求解在 $f_2(z) = 8z+11 \\pmod{25}$ 下从 $Z_0=22$ 开始的序列 $\\{Z_n\\}$ 的周期。\n周期 $L_2$ 是使得 $f_2^{L_2}(Z_0) = Z_0$ 成立的最小正整数。\n仿射映射 $f(x)=ax+c$ 的迭代可以写作 $f^n(x) = a^n(x-p)+p$，其中 $p$ 是满足 $p=ap+c$ 的不动点，因此 $p=c(1-a)^{-1}$。\n对于 $f_2(z)$，其不动点 $p_2$ 满足 $p_2(1-8) \\equiv 11 \\pmod{25}$，即 $-7p_2 \\equiv 11 \\pmod{25}$。\n为了求 $(-7)^{-1} \\pmod{25}$，我们注意到 $-7 \\equiv 18 \\pmod{25}$。我们需要求 $18^{-1} \\pmod{25}$。通过观察或扩展欧几里得算法，可知 $18 \\times 7 = 126 = 5 \\times 25 + 1$，因此 $18^{-1} \\equiv 7 \\pmod{25}$。\n因此，$p_2 \\equiv 11 \\times 7 = 77 \\equiv 2 \\pmod{25}$。\n第 $k$ 次迭代的公式为 $f_2^k(z) = 8^k(z-p_2)+p_2 = 8^k(z-2)+2 \\pmod{25}$。\n我们需要找到最小的正整数 $k>0$ 使得 $f_2^k(22)=22$。\n$8^k(22-2)+2 \\equiv 22 \\pmod{25}$\n$8^k(20) \\equiv 20 \\pmod{25}$\n此同余式等价于 $25 | 20(8^k-1)$。两边除以 $5$，得到 $5 | 4(8^k-1)$。因为 $\\gcd(4,5)=1$，这意味着 $5 | (8^k-1)$。\n所以，我们需要 $8^k \\equiv 1 \\pmod 5$。由于 $8 \\equiv 3 \\pmod 5$，我们需要 $3^k \\equiv 1 \\pmod 5$。\n$3$ 模 $5$ 的幂为：$3^1 \\equiv 3$, $3^2 \\equiv 9 \\equiv 4$, $3^3 \\equiv 12 \\equiv 2$, $3^4 \\equiv 6 \\equiv 1$。\n最小的正整数 $k$ 是 $4$。因此，第二个分量的周期是 $L_2=4$。\n\n序列 $\\{X_n\\}$ 的周期 $L$ 是各分量周期的最小公倍数：\n$L = \\text{lcm}(L_1, L_2) = \\text{lcm}(1, 4) = 4$。\n\n**任务2：找出所有“短”周期和不动点 ($N_1, N_2, N_3, N_4$)**\n\n为此，我们必须首先确定分量映射 $f_1$ 和 $f_2$ 的完整循环结构。设 $C(k, g)$ 为函数 $g$ 的长度为 $k$ 的周期中的元素数量。\n\n**$f_1(y) = -y+2 \\pmod 9$ 的循环结构：**\n如果 $y = -y+2 \\pmod 9$，那么点 $y$ 是一个不动点，该式可简化为 $2y \\equiv 2 \\pmod 9$。因为 $\\gcd(2,9)=1$，两边可以除以 $2$ 得到唯一解 $y=1$。所以，存在一个不动点。$C(1, f_1)=1$。\n对于任何其他点 $y \\neq 1$，我们来考察 $f_1^2(y)$：\n$f_1^2(y) = f_1(-y+2) = -(-y+2)+2 = y-2+2 = y$。\n这表明每个元素 $y \\in \\mathbb{Z}_9$ 都满足 $f_1^2(y)=y$。因此，不是不动点的元素必定属于长度为 $2$ 的周期。\n长度为2的周期中的元素数量：$C(2, f_1) = |\\mathbb{Z}_9| - C(1, f_1) = 9-1=8$。\n$f_1$ 的周期长度为 $1$ 和 $2$。\n\n**$f_2(z) = 8z+11 \\pmod{25}$ 的循环结构：**\n如果 $k$ 是使 $f_2^k(z)=z$ 成立的最小正整数，则元素 $z$ 属于长度为 $k$ 的周期。使用公式 $f_2^k(z)=8^k(z-2)+2$，该条件为 $8^k(z-2)+2=z$，整理后得到 $(8^k-1)(z-2) \\equiv 0 \\pmod{25}$。\n包含 $z$ 的周期的长度取决于 $\\gcd(z-2, 25)$。\n1. 如果 $z=2$ (不动点)，我们得到一个长度为1的周期。$C(1, f_2)=1$。\n2. 如果 $\\gcd(z-2, 25) = 5$，那么 $z-2$ 是 $5$ 的倍数但不是 $25$ 的倍数。$z-2$ 的值为 $\\{5, 10, 15, 20\\}$，因此 $z \\in \\{7, 12, 17, 22\\}$。共有 $4$ 个这样的值。条件变为 $\\frac{z-2}{5}(8^k-1) \\equiv 0 \\pmod 5$。由于 $\\gcd(\\frac{z-2}{5}, 5)=1$，该式简化为 $8^k-1 \\equiv 0 \\pmod 5$，我们已经解得 $k=4$。这 $4$ 个元素处于长度为 $4$ 的周期中。因此，$C(4, f_2)=4$。\n3. 如果 $\\gcd(z-2, 25)=1$，条件要求 $8^k-1 \\equiv 0 \\pmod{25}$。这意味着 $k$ 必须是 $8$ 模 $25$ 的乘法阶。单位群 $(\\mathbb{Z}/25\\mathbb{Z})^\\times$ 的阶为 $\\phi(25) = 25(1 - 1/5) = 20$。我们来计算 $8 \\pmod{25}$ 的幂：$8^1=8, 8^2=64 \\equiv 14, 8^4 \\equiv 14^2 = 196 \\equiv 21 \\equiv -4, 8^5 \\equiv -4 \\times 8 = -32 \\equiv 18, 8^{10} \\equiv 18^2 = 324 = 12 \\times 25 + 24 \\equiv -1, 8^{20} \\equiv (-1)^2=1$。阶是 $20$。\n满足 $\\gcd(z-2, 25)=1$ 的元素 $z$ 的数量，等于 $\\{0, \\dots, 24\\}$ 中不具有 $5j+2$ 形式的整数的数量，即 $25-5=20$。这 $20$ 个元素处于长度为 $20$ 的周期中。$C(20, f_2)=20$。\n检验：$C(1, f_2) + C(4, f_2) + C(20, f_2) = 1+4+20=25$。所有元素都已计算在内。\n\n**结合循环结构以求解 $f(x)$ 的 $N_k$：**\n长度为 $k=\\text{lcm}(k_1,k_2)$ 的周期中的元素数量，是各分量周期中元素数量的乘积，即 $C(k_1,f_1) \\times C(k_2,f_2)$。长度为 $k$ 的周期数量是此类周期中元素总数除以 $k$。\n\n$N_1$ (长度为1的周期，不动点)：\n需要 $\\text{lcm}(k_1, k_2)=1$，这意味着 $k_1=1$ 且 $k_2=1$。\n元素数量：$C(1, f_1) \\times C(1, f_2) = 1 \\times 1 = 1$。\n周期数量：$N_1 = 1/1 = 1$。\n\n$N_2$ (长度为2的周期)：\n需要 $\\text{lcm}(k_1, k_2)=2$。可能的分量周期长度为 $k_1 \\in \\{1,2\\}$ 和 $k_2 \\in \\{1,4,20\\}$。唯一能使最小公倍数为2的组合是 $(k_1, k_2) = (2, 1)$。\n元素数量：$C(2, f_1) \\times C(1, f_2) = 8 \\times 1 = 8$。\n周期数量：$N_2 = 8/2 = 4$。\n\n$N_3$ (长度为3的周期)：\n需要 $\\text{lcm}(k_1, k_2)=3$。除了 $1$ 之外，没有任何分量周期长度 ($k_1, k_2$) 是 $3$ 的因子。因此不可能得到最小公倍数为 $3$。\n元素数量：$0$。\n周期数量：$N_3 = 0/3 = 0$。\n\n$N_4$ (长度为4的周期)：\n需要 $\\text{lcm}(k_1, k_2)=4$。可能的组合 $(k_1, k_2)$ 有：\n- $(k_1, k_2)=(1,4)$：元素数量 = $C(1, f_1) \\times C(4, f_2) = 1 \\times 4 = 4$。\n- $(k_1, k_2)=(2,4)$：元素数量 = $C(2, f_1) \\times C(4, f_2) = 8 \\times 4 = 32$。\n长度为4的周期中的元素总数为 $4+32=36$。\n周期数量：$N_4 = 36/4 = 9$。\n\n最终结果为 $L=4$，$N_1=1$，$N_2=4$，$N_3=0$，$N_4=9$。所要求的答案是行向量 $(L, N_1, N_2, N_3, N_4)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  1  4  0  9\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "尽管在计算上很方便，但模数为2的幂的 LCG 隐藏着一个众所周知且至关重要的弱点：它们的低位比特远非随机。此练习  将引导您从第一性原理出发进行推导，以揭示这一结构性缺陷。通过分析单个比特序列的行为，您将证明它们的周期短得危险，这对于随机数生成器的实际应用和选择是至关重要的一课。",
            "id": "3332070",
            "problem": "考虑一个定义在模2的幂的整数环上的线性同余生成器 (LCG)，其递推关系为\n$$\nX_{n+1} \\equiv a\\,X_n + c \\pmod{2^{w}},\n$$\n其中 $a$ 和 $c$ 是整数，$w \\geq 1$，且 $X_0 \\in \\{0,1,\\dots,2^{w}-1\\}$。假设 $a$ 和 $c$ 满足在环 $\\mathbb{Z}/2^{w}\\mathbb{Z}$ 上模 $2^{w}$ 的LCG达到满周期的标准充要条件，即 $c$ 为奇数且 $a \\equiv 1 \\pmod{4}$，因此 $(X_n)$ 的周期等于 $2^{w}$。\n\n定义截断至 $r$ 个最低有效位的序列为 $Y_n \\equiv X_n \\pmod{2^{r}}$，其中 $1 \\leq r \\leq w$。并定义 $X_n$ 的第 $k$ 位（最低有效位索引为 $k=0$）为 $b_k(n) \\in \\{0,1\\}$，使得\n$$\nX_n \\equiv \\sum_{j=0}^{w-1} b_j(n)\\,2^j, \\quad \\text{所以 } b_k(n) = \\left\\lfloor \\frac{X_n}{2^k} \\right\\rfloor \\bmod 2,\n$$\n对于 $0 \\leq k \\leq r-1$。\n\n从模算术的核心定义和 $\\mathbb{Z}/2^{q}\\mathbb{Z}$ 上LCG的结构出发，并仅使用经过充分检验的结果（包括模2的幂的满周期LCG的刻画以及2-adic赋值的基本性质），完成以下任务：\n\n- 从第一性原理出发，证明 $(Y_n)$ 是一个以 $a$ 和 $c$ 为相同参数、模为 $2^{r}$ 的LCG。\n- 利用 $a$ 和 $c$ 的结构条件以及 $\\mathbb{Z}/2^{r}\\mathbb{Z}$ 的性质，推导 $(Y_n)$ 的精确周期。\n- 对于固定的比特索引 $k$（其中 $0 \\leq k \\leq r-1$），分析在 $\\mathbb{Z}/2^{k+1}\\mathbb{Z}$ 上控制 $b_k(n)$ 的导出映射，并推导比特序列 $(b_k(n))$ 的精确周期 $T_k$。你的推导必须是显式的，并且必须清楚地说明为什么低位比特会呈现短周期。\n- 将你的最终答案表示为 $(Y_n)$ 的周期和 $T_k$ 作为 $k$ 的函数的闭式解析表达式。\n\n不需要进行数值舍入。提供最终表达式，不带单位。对于多个所求量，请将它们一起以单行矩阵的形式呈现在你的最终答案中。",
            "solution": "### 解题推导\n\n解答将分为三个部分，对应于问题陈述中指定的任务。\n\n**第1部分：截断序列 $(Y_n)$**\n\n原始LCG由递推关系定义\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{2^w}\n$$\n该同余关系意味着存在一个整数 $k_n$ 使得 $X_{n+1} = a X_n + c + k_n 2^w$。\n截断序列定义为 $Y_n = X_n \\pmod{2^r}$，对于 $1 \\leq r \\leq w$。这意味着 $Y_n$ 是 $X_n$ 除以 $2^r$ 的余数。根据定义，$X_n \\equiv Y_n \\pmod{2^r}$。\n为了找到 $(Y_n)$ 的递推关系，我们考虑主递推关系模 $2^r$ 的情况。由于 $r \\leq w$，$2^w$ 是 $2^r$ 的倍数，所以 $2^w \\equiv 0 \\pmod{2^r}$。\n将方程 $X_{n+1} = a X_n + c + k_n 2^w$ 对 $2^r$ 取模，我们得到：\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{2^r}\n$$\n使用 $Y_n$ 的定义，我们有 $X_{n+1} \\equiv Y_{n+1} \\pmod{2^r}$ 和 $X_n \\equiv Y_n \\pmod{2^r}$。将这些代入同余式中得到：\n$$\nY_{n+1} \\equiv a Y_n + c \\pmod{2^r}\n$$\n这表明序列 $(Y_n)$ 本身就是一个线性同余生成器，其乘数 $a$ 和增量 $c$ 相同，但模数减小为 $2^r$。\n\n**第2部分：$(Y_n)$ 的周期**\n\n我们已经确定 $(Y_n)$ 是一个模为 $2^r$ 的LCG。这种生成器的周期是满足 $Y_{n+p} \\equiv Y_n \\pmod{2^r}$ 的最小正整数 $p$，该条件对所有可能的初始状态 $Y_0$ 和所有 $n \\geq 0$ 都成立。\nLCG递推关系的通解为 $Y_n \\equiv a^n Y_0 + c \\frac{a^n-1}{a-1} \\pmod{2^r}$。\n为了使周期为 $p$，我们需要对所有 $n$ 都有 $Y_{n+p} \\equiv Y_n \\pmod{2^r}$。这变成\n$$\na^{n+p} Y_0 + c \\frac{a^{n+p}-1}{a-1} \\equiv a^n Y_0 + c \\frac{a^n-1}{a-1} \\pmod{2^r}\n$$\n$a^n (a^p-1) Y_0 + c \\frac{a^n(a^p-1)}{a-1} \\equiv 0 \\pmod{2^r}$。\n由于 $a$ 是奇数（因为 $a \\equiv 1 \\pmod{4}$），所以 $a$ 在模 $2^r$ 下是可逆的。此式必须对任何 $Y_0$ 都成立。这意味着两个条件：\n1. $a^p \\equiv 1 \\pmod{2^r}$。\n2. $c \\frac{a^p-1}{a-1} \\equiv 0 \\pmod{2^r}$。\n由于已知 $c$ 是奇数，它在模 $2^r$ 下也是可逆的。第二个条件简化为 $\\frac{a^p-1}{a-1} \\equiv 0 \\pmod{2^r}$，或者 $v_2(\\frac{a^p-1}{a-1}) \\geq r$，其中 $v_2(z)$ 是 $z$ 的2-adic赋值（即能整除 $z$ 的2的最高次幂的指数）。\n这第二个条件比第一个更严格。周期 $p$ 是满足 $v_2( (a^p-1)/(a-1) ) \\geq r$ 的最小正整数。\n\n为了继续，我们使用一个关于当 $a \\equiv 1 \\pmod 4$ 时 $a^n-1$ 的2-adic赋值的关键引理。\n**引理：** 如果整数 $a$ 满足 $a \\equiv 1 \\pmod{4}$，那么对于任何整数 $n \\geq 1$，有 $v_2(a^n-1) = v_2(a-1) + v_2(n)$。\n**引理证明：** 已知 $a \\equiv 1 \\pmod 4$，所以 $v_2(a-1) \\ge 2$。我们对 $v_2(n)$ 进行归纳。\n基础情况：$v_2(n) = 0$，所以 $n$ 是奇数。那么 $a^n-1 = (a-1)(a^{n-1} + a^{n-2} + \\dots + 1)$。由于 $a$ 是奇数，第二个因子中的 $n$ 个项每一项都是奇数。因为 $n$ 是奇数，它们的和也是奇数。因此，$v_2(a^n-1) = v_2(a-1) = v_2(a-1) + 0 = v_2(a-1) + v_2(n)$。\n归纳步骤：假设引理对所有满足 $v_2(m) = k$ 的整数 $m$ 成立（其中 $k \\geq 0$）。设 $n$ 是一个整数，满足 $v_2(n) = k+1$。那么我们可以写成 $n=2m$，其中 $v_2(m)=k$。\n我们有 $a^n - 1 = a^{2m} - 1 = (a^m - 1)(a^m + 1)$。\n根据归纳假设，$v_2(a^m-1) = v_2(a-1) + v_2(m)$。由于 $v_2(a-1) \\ge 2$ 且 $v_2(m) \\ge 0$，我们有 $v_2(a^m-1) \\ge 2$，这意味着 $a^m \\equiv 1 \\pmod 4$。\n那么 $a^m+1 \\equiv 1+1 \\equiv 2 \\pmod 4$，这意味着 $v_2(a^m+1) = 1$。\n因此，$v_2(a^n-1) = v_2(a^{2m}-1) = v_2(a^m-1) + v_2(a^m+1) = (v_2(a-1)+v_2(m)) + 1 = v_2(a-1) + (v_2(m)+1) = v_2(a-1) + v_2(2m) = v_2(a-1) + v_2(n)$。\n引理通过归纳法得证。\n\n使用该引理，周期 $p$ 的条件变为：\n$v_2(a^p-1) - v_2(a-1) \\geq r$\n$(v_2(a-1) + v_2(p)) - v_2(a-1) \\geq r$\n$v_2(p) \\geq r$\n满足此条件的最小正整数 $p$ 是 $p=2^r$。\n因此，序列 $(Y_n)$ 的周期是 $2^r$。\n\n**第3部分：比特序列 $(b_k(n))$ 的周期**\n\n我们想要找到对于固定的 $k$（其中 $0 \\leq k \\leq r-1$），序列 $(b_k(n))$ 的周期 $T_k$。比特 $b_k(n)$ 由 $X_n \\pmod{2^{k+1}}$ 的值决定。设 $Y_n^{(j)} = X_n \\pmod{2^j}$。根据第2部分，序列 $(Y_n^{(k+1)})$ 的周期为 $2^{k+1}$。\n比特 $b_k(n)$ 由 $b_k(n) = \\lfloor Y_n^{(k+1)}/2^k \\rfloor$ 给出。\n\n让我们分析序列 $(Y_n^{(k+1)})$ 经过 $2^k$ 步的演化。其递推关系为 $Y_{n+1}^{(k+1)} \\equiv a Y_n^{(k+1)} + c \\pmod{2^{k+1}}$。\n将此递推关系迭代 $T = 2^k$ 次得到：\n$$\nY_{n+2^k}^{(k+1)} \\equiv a^{2^k} Y_n^{(k+1)} + c \\frac{a^{2^k}-1}{a-1} \\pmod{2^{k+1}}\n$$\n让我们分析 $a^{2^k}$ 和 $\\frac{a^{2^k}-1}{a-1}$ 模 $2^{k+1}$ 的值。我们使用第2部分的引理。\n设 $s = v_2(a-1)$。已知 $a \\equiv 1 \\pmod 4$，所以 $s \\ge 2$。\n$v_2(a^{2^k}-1) = v_2(a-1) + v_2(2^k) = s+k$。\n由于 $s \\ge 2$，有 $s+k \\ge k+2 > k+1$。这意味着 $a^{2^k} \\equiv 1 \\pmod{2^{k+1}}$。\n\n对于第二项，我们有：\n$v_2\\left(\\frac{a^{2^k}-1}{a-1}\\right) = v_2(a^{2^k}-1) - v_2(a-1) = (s+k) - s = k$。\n这意味着 $\\frac{a^{2^k}-1}{a-1} = M \\cdot 2^k$，其中 $M$ 是某个奇数。\n因此，$c \\frac{a^{2^k}-1}{a-1} = c M 2^k$。由于 $c$ 和 $M$ 都是奇数，它们的乘积 $cM$ 也是奇数。\n所以，$c \\frac{a^{2^k}-1}{a-1} \\equiv 2^k \\pmod{2^{k+1}}$。\n\n将这些发现代回到 $Y_{n+2^k}^{(k+1)}$ 的递推关系中：\n$$\nY_{n+2^k}^{(k+1)} \\equiv 1 \\cdot Y_n^{(k+1)} + 2^k \\pmod{2^{k+1}}\n$$\n这个关系是核心。现在，我们将 $Y_n^{(k+1)}$ 分解为其第 $k$ 位和更低的位：\n$Y_n^{(k+1)} = b_k(n) 2^k + (Y_n^{(k+1)} \\bmod 2^k)$。\n该关系变为：\n$$\nb_k(n+2^k) 2^k + (Y_{n+2^k}^{(k+1)} \\bmod 2^k) \\equiv \\left(b_k(n) 2^k + (Y_n^{(k+1)} \\bmod 2^k)\\right) + 2^k \\pmod{2^{k+1}}\n$$\n这个方程意味着模 $2^k$ 的同余关系以及关于 $2^k$ 系数的关系。\n模 $2^k$：$Y_{n+2^k}^{(k+1)} \\bmod 2^k \\equiv Y_n^{(k+1)} \\bmod 2^k$。这意味着 $Y_{n+2^k}^{(k)} \\equiv Y_n^{(k)}$。这与 $(Y_n^{(k)})$ 的周期为 $2^k$ 的事实相符。\n\n通过比较 $2^k$ 的系数，我们得到比特的关系：\n$$\nb_k(n+2^k) \\equiv b_k(n) + 1 \\pmod 2\n$$\n这表明比特 $b_k(n)$ 在 $2^k$ 步后会翻转。因此，比特序列 $(b_k(n))$ 的周期不是 $2^k$。为了回到其原始状态，我们必须将此变换应用两次：\n$$\nb_k(n+2 \\cdot 2^k) = b_k(n+2^{k+1}) \\equiv b_k(n+2^k)+1 \\equiv (b_k(n)+1)+1 \\equiv b_k(n) \\pmod 2\n$$\n序列 $(b_k(n))$ 在 $2^{k+1}$ 步后首次重复。周期不是 $2^k$ 的因子，因此周期必须恰好是 $T_k = 2^{k+1}$。这个结果清楚地说明了为什么模为2的幂的LCG的低位比特（小的 $k$）具有非常短的周期（$T_0=2$，$T_1=4$，等等），这使得它们不适用于需要高质量随机性的应用。\n\n### 结果总结\n-   截断序列 $(Y_n) = (X_n \\pmod{2^r})$ 的周期是 $2^r$。\n-   第 $k$ 个比特序列 $(b_k(n))$ 的周期是 $T_k = 2^{k+1}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2^{r}  2^{k+1} \\end{pmatrix}}$$"
        },
        {
            "introduction": "真正随机的多维数点应该均匀地填充空间，但来自 LCG 的数点并非如此。相反，连续的输出值落在数量相对较少的平行超平面上，这种结构被称为格 (lattice)。此练习  通过引导您完成“谱测试”，将这一抽象的几何概念具体化。您将推导出生成器的格基并计算这些超平面之间的最大距离，这是衡量其在高维中质量的关键指标。",
            "id": "3332090",
            "problem": "考虑一个由递归式 $x_{n+1} \\equiv a x_{n} + c \\pmod m$ 定义的线性同余生成器 (LCG)，其中 $a \\in \\mathbb{Z}$，$c \\in \\mathbb{Z}$，且 $m \\in \\mathbb{Z}_{0}$。定义归一化输出 $U_{n} = x_{n} / m \\in [0,1)$。对于一个固定的维度 $k \\in \\mathbb{Z}_{\\ge 2}$，考虑 $k$维点集 $P_{k} = \\{(U_{n}, U_{n+1}, \\dots, U_{n+k-1}) : n \\in \\mathbb{Z}\\} \\subset [0,1)^{k}$。\n\n在 $m = 31$，$a = 3$，$c = 0$ 和 $k = 3$ 的具体情况下进行计算。仅使用 LCG、模算术、欧几里得格和对偶格的基本定义，完成以下任务：\n\n1) 推导一个满秩格 $L \\subset \\mathbb{R}^{3}$，该格由一个基矩阵 $B \\in \\mathbb{R}^{3 \\times 3}$ 明确给出，使得从 $P_{3}$ 获得的 $\\mathbb{R}^{3}$ 中的提升点集位于 $L$ 经过 $\\mathbb{Z}^{3}$ 中向量平移的有限并集之内。你的推导必须从定义 $x_{n}$ 的递归式以及当 $c = 0$ 时 $x_{n+j} \\equiv a^{j} x_{n} \\pmod m$ 这一事实开始。\n\n2) 根据对偶格的定义 $L^{\\ast} = \\{h \\in \\mathbb{R}^{3} : h \\cdot y \\in \\mathbb{Z} \\text{ for all } y \\in L\\}$，推导所有整数向量 $h = (h_{1}, h_{2}, h_{3}) \\in \\mathbb{Z}^{3}$ 的明确表征，这些向量通过条件 $h \\cdot u \\in \\mathbb{Z}$ 对所有 $u \\in P_{3}$ 定义了平行超平面族。将此表征表示为 $\\mathbb{Z}/m\\mathbb{Z}$ 中的一个同余式。\n\n3) 在满足第 2 部分同余式的所有非零 $h \\in \\mathbb{Z}^{3}$ 中，确定一个欧几里得范数最小的向量。然后，利用几何事实——点所在的、与h垂直的连续平行超平面之间的距离等于欧几里得范数 $\\|h\\|_{2}$ 的倒数——计算此 LCG 在 $k=3$ 维度下可能的最大平面间距。\n\n给出你的最终答案，形式为一个单一的精确解析表达式。不要对结果进行四舍五入，也不要包含单位。",
            "solution": "### 第一部分：格 L 的推导\n\n由 LCG 生成的点，在按模 m 进行缩放后，位于一个整数格中。归一化点 $P_3 = \\{(U_n, U_{n+1}, U_{n+2})\\}$ 是该整数格的一个缩放版本的子集，以整数向量为模。\n\n整数状态序列 $(x_n, x_{n+1}, x_{n+2})$ 由递归式 $x_{j+1} \\equiv a x_j \\pmod m$ 生成。对于 $k=3$ 和 $c=0$，这给出了以下关系：\n$x_{n+1} \\equiv 3 x_n \\pmod{31}$\n$x_{n+2} \\equiv 3 x_{n+1} \\pmod{31}$\n\n该问题要求一个格 $L \\subset \\mathbb{R}^3$。LCG 的点 $u_n = (x_n/m, x_{n+1}/m, x_{n+2}/m)$ 已知位于一个格结构上。我们首先确定整数格 $\\Lambda \\subset \\mathbb{Z}^3$，它包含所有满足与 LCG 状态相同递推关系的整数向量 $y=(y_1, y_2, y_3)$：\n$y_2 \\equiv 3 y_1 \\pmod{31}$\n$y_3 \\equiv 3 y_2 \\pmod{31}$\n\n这个同余方程组定义了整数格 $\\Lambda$。我们可以找到 $\\Lambda$ 的一个基。$\\Lambda$ 中的任意向量 $y$ 都可以表示为基向量的整数线性组合。\n这些同余式的一个通解可以写成：\n$y_2 = 3y_1 + 31j_1$\n$y_3 = 3y_2 + 31j_2 = 3(3y_1 + 31j_1) + 31j_2 = 9y_1 + 93j_1 + 31j_2$\n其中 $y_1, j_1, j_2$ 是任意整数。\n\n我们可以将 $\\Lambda$ 中的任意向量 $y$ 表示为：\n$y = (y_1, 3y_1 + 31j_1, 9y_1 + 93j_1 + 31j_2)$\n$y = y_1(1, 3, 9) + j_1(0, 31, 93) + j_2(0, 0, 31)$\n这表明向量 $b_1' = (1, 3, 9)$、$b_2' = (0, 31, 93)$ 和 $b_3' = (0, 0, 31)$ 构成了 $\\Lambda$ 的一个基。\n\n问题中描述的格 $L \\subset \\mathbb{R}^3$ 是整数格 $\\Lambda$ 按因子 $1/m = 1/31$ 缩放得到的。L 的一个基可以通过将 $\\Lambda$ 的基向量缩放 $1/31$ 得到：\n$b_1 = \\frac{1}{31} b_1' = (\\frac{1}{31}, \\frac{3}{31}, \\frac{9}{31})$\n$b_2 = \\frac{1}{31} b_2' = (0, 1, 3)$\n$b_3 = \\frac{1}{31} b_3' = (0, 0, 1)$\n\n格 L 的基矩阵 $B$ 由这些基向量作为行构成：\n$$B = \\begin{pmatrix} \\frac{1}{31}  \\frac{3}{31}  \\frac{9}{31} \\\\ 0  1  3 \\\\ 0  0  1 \\end{pmatrix}$$\n任何 LCG 点 $u_n = (\\frac{x_n}{31}, \\frac{x_{n+1}}{31}, \\frac{x_{n+2}}{31})$ 都可以被证明是 $L$ 中的一个点，并且所有这些点的集合 $P_3$ 是 $L$ 的一个子集。问题中关于“平移的并集”的措辞是关于 LCG 的一般性陈述，但在这种标准构造中，点直接位于 L 中。\n\n### 第二部分：整数对偶格向量的表征\n\n对偶格 $L^*$ 定义为 $L^* = \\{ h \\in \\mathbb{R}^3 : h \\cdot y \\in \\mathbb{Z} \\text{ for all } y \\in L \\}$。\n$L^*$ 的一个基由矩阵 $B^* = (B^{-1})^T = (B^T)^{-1}$ 的行向量给出。\n我们的基矩阵 B 的转置是：\n$$B^T = \\begin{pmatrix} \\frac{1}{31}  0  0 \\\\ \\frac{3}{31}  1  0 \\\\ \\frac{9}{31}  3  1 \\end{pmatrix}$$\n$B^T$ 的逆是：\n$$B^* = (B^T)^{-1} = \\begin{pmatrix} 31  0  0 \\\\ -3  1  0 \\\\ 0  -3  1 \\end{pmatrix}$$\n$B^*$ 的行构成了 $L^*$ 的一个基。$L^*$ 中的任意向量 $h$ 是这些基向量的整数线性组合：\n$h = n_1(31, 0, 0) + n_2(-3, 1, 0) + n_3(0, -3, 1)$，其中 $n_1, n_2, n_3$ 为整数。\n\n我们感兴趣的是同时也在 $\\mathbb{Z}^3$ 中的向量 $h = (h_1, h_2, h_3)$。\n$h_1 = 31n_1 - 3n_2$\n$h_2 = n_2 - 3n_3$\n$h_3 = n_3$\n要使 h 成为整数向量，其分量必须是整数。由于 $n_1, n_2, n_3$ 是整数，这总是成立的。我们需要找到一个整数向量 $(h_1, h_2, h_3)$ 能以这种形式表示的条件。\n从上面的方程中，我们可以用分量 $h_i$ 表示系数 $n_i$：\n$n_3 = h_3$\n$n_2 = h_2 + 3n_3 = h_2 + 3h_3$\n$31n_1 = h_1 + 3n_2 = h_1 + 3(h_2 + 3h_3) = h_1 + 3h_2 + 9h_3$\n要使 $n_1$ 是整数，等式右边必须能被 $31$ 整除。这就给出了整数向量 h 属于 $L^*$ 的充要条件：\n$$h_1 + 3h_2 + 9h_3 \\equiv 0 \\pmod{31}$$\n这就是所要求的明确表征。\n\n### 第三部分：最小范数向量和最大平面间距\n\n我们必须找到一个非零整数向量 $h=(h_1, h_2, h_3)$，它满足 $h_1 + 3h_2 + 9h_3 \\equiv 0 \\pmod{31}$ 并使欧几里得范数 $\\|h\\|_2 = \\sqrt{h_1^2 + h_2^2 + h_3^2}$ 最小化。这等价于最小化范数平方 $\\|h\\|_2^2 = h_1^2+h_2^2+h_3^2$。\n\n这是一个在由同余式定义的格中的最短向量问题。我们可以通过测试具有较小整数分量的向量来搜索解。对于任意选择的 $h_2$ 和 $h_3$，$h_1$ 的值受 $h_1 \\equiv -(3h_2 + 9h_3) \\pmod{31}$ 的约束。为了最小化 $|h_1|$，我们选择该同余类中绝对值最小的代表元。\n\n让我们测试 $(h_2, h_3)$ 的一些小值：\n- $(h_2,h_3) = (1,0) \\implies h_1 \\equiv -3 \\pmod{31}$。我们选择 $h_1=-3$。向量是 $h=(-3,1,0)$。$\\|h\\|_2^2 = (-3)^2+1^2+0^2 = 10$。\n- $(h_2,h_3) = (0,1) \\implies h_1 \\equiv -9 \\pmod{31}$。我们选择 $h_1=-9$。向量是 $h=(-9,0,1)$。$\\|h\\|_2^2 = (-9)^2+0^2+1^2 = 82$。\n- $(h_2,h_3) = (1,1) \\implies h_1 \\equiv -12 \\pmod{31}$。我们选择 $h_1=-12$。向量是 $h=(-12,1,1)$。$\\|h\\|_2^2 = (-12)^2+1^2+1^2 = 146$。\n- $(h_2,h_3) = (1,-1) \\implies h_1 \\equiv - (3-9) = 6 \\pmod{31}$。我们选择 $h_1=6$。向量是 $h=(6,1,-1)$。$\\|h\\|_2^2 = 6^2+1^2+(-1)^2 = 38$。\n- $(h_2,h_3) = (2,-1) \\implies h_1 \\equiv -(6-9) = 3 \\pmod{31}$。我们选择 $h_1=3$。向量是 $h=(3,2,-1)$。$\\|h\\|_2^2 = 3^2+2^2+(-1)^2 = 14$。\n- $(h_2,h_3) = (3,-1) \\implies h_1 \\equiv -(9-9)=0 \\pmod{31}$。我们选择 $h_1=0$。向量是 $h=(0,3,-1)$。$\\|h\\|_2^2 = 0^2+3^2+(-1)^2 = 10$。\n\n系统的搜索显示，最小的非零范数平方是 10。达到这个最小值的两个向量是 $h=(-3,1,0)$ 和 $h=(0,3,-1)$ 等。\n因此，满足条件的非零整数向量 h 的最小欧几里得范数是 $\\|h\\|_{\\text{min}} = \\sqrt{10}$。\n\nLCG 点 $u_n$ 都位于由 $h \\cdot x = j$（其中 j 为整数）定义的平行超平面族上。谱测试的几何解释指出，这些连续超平面之间的最大距离是这样一个非零整数向量 h 的最小范数的倒数。这个距离是衡量 LCG 输出“粒度”或“粗糙度”的指标。\n\n可能的最大平面间距是：\n$$d_{\\text{max}} = \\frac{1}{\\|h\\|_{\\text{min}}} = \\frac{1}{\\sqrt{10}}$$\n这就是最终答案，一个精确的解析表达式。",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{10}}}$$"
        }
    ]
}