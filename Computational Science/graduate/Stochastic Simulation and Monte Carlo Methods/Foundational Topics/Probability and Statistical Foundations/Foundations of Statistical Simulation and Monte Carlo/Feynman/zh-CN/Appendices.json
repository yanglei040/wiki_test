{
    "hands_on_practices": [
        {
            "introduction": "蒙特卡洛方法始于高质量的伪随机数。线性同余生成器 (LCG) 是最基础的随机数生成算法之一，其序列的周期长度是衡量其质量的关键指标。本练习  将引导你应用数论中的深刻结论，为一个给定的模数设计一个具有最大可能周期的乘法同余生成器，从而将抽象的数学理论与仿真科学中的具体工程目标联系起来。",
            "id": "3308890",
            "problem": "考虑由以下递推关系定义的线性同余生成器 (LCG)\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m},$$\n其模数为 $m$，乘数为 $a$，增量为 $c$。状态序列 $\\{X_{n}\\}$ 的周期是满足对于所有 $n$ 都有 $X_{n+T} \\equiv X_{n} \\pmod{m}$ 的最小正整数 $T$。假设存在一个硬件施加的约束，即 $c = 0$，且模数固定为\n$$m = 2^{11} \\cdot 3^{4} \\cdot 5^{2}.$$\n你可以选择乘数 $a$ 和初始种子 $X_{0}$，但必须满足约束条件 $0  a  m$、$0  X_{0}  m$ 和 $\\gcd(X_{0}, m) = 1$。\n\n仅使用数论和模算术中的基本定义和经过充分验证的事实，构造一个 $a$ 和 $X_{0}$ 的选择，以在这些约束条件下最大化 LCG 序列 $\\{X_{n}\\}$ 的周期。通过分析模 $m$ 的乘法结构及任何必要的分解，严格证明你的构造如何在该模数下达到可能的最大周期。然后，计算可实现的最大周期长度，结果为一个整数。\n\n你的最终答案必须是最大周期长度。不要提供中间值。不要包含单位。无需四舍五舍。",
            "solution": "所述问题是有效的。这是一个适定的数论问题，直接应用于伪随机数生成器的分析，特别是乘法同余生成器。该问题具有科学依据、客观性，并包含进行严格求解所需的所有信息。我们开始求解。\n\n线性同余生成器 (LCG) 由以下递推关系定义\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m}.$$\n问题施加了约束条件 $c=0$，从而得到一个乘法同余生成器 (MCG)：\n$$X_{n+1} \\equiv a X_{n} \\pmod{m}.$$\n通过归纳法，该序列由 $X_{n} \\equiv a^{n} X_{0} \\pmod{m}$ 给出。序列的周期 $T$ 是对于所有非负整数 $n$ 满足 $X_{n+T} \\equiv X_{n} \\pmod{m}$ 的最小正整数。当 $n=0$ 时，此条件变为 $X_{T} \\equiv X_{0} \\pmod{m}$，可转换成\n$$a^{T} X_{0} \\equiv X_{0} \\pmod{m}.$$\n我们被给予约束条件 $\\gcd(X_{0}, m) = 1$。这意味着 $X_{0}$ 存在一个模 $m$ 的乘法逆元。我们可以在同余式两边乘以 $X_{0}^{-1}$ 得到\n$$a^{T} \\equiv 1 \\pmod{m}.$$\n这个方程表明，周期 $T$ 是乘数 $a$ 在模 $m$ 的单位群 $(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 中的乘法阶。因此，最大化周期 $T$ 的问题等价于找到该群中元素可能的最大阶。这个最大阶被称为群的指数。\n\n群 $(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 的指数由 Carmichael 函数 $\\lambda(m)$ 给出。为了达到最大周期，我们必须选择一个乘数 $a$，使其模 $m$ 的阶为 $\\lambda(m)$。这样的元素 $a$ 通常被称为模 $m$ 的本原元。这种元素的存在性是有保证的。种子 $X_{0}$ 的选择可以是任何满足 $0  X_{0}  m$ 和 $\\gcd(X_{0}, m) = 1$ 的整数；例如，$X_{0}=1$ 就是一个有效的选择。$X_{0}$ 的具体值不影响周期的长度，只影响状态序列本身。\n\n我们的任务简化为计算给定模数 $m = 2^{11} \\cdot 3^{4} \\cdot 5^{2}$ 的 $\\lambda(m)$。Carmichael 函数有一个与其参数的素数分解相关的关键性质。如果 $m = p_1^{k_1} p_2^{k_2} \\cdots p_r^{k_r}$ 是 $m$ 的素数分解，那么\n$$\\lambda(m) = \\text{lcm}(\\lambda(p_1^{k_1}), \\lambda(p_2^{k_2}), \\dots, \\lambda(p_r^{k_r})).$$\n函数 $\\lambda(p^k)$ 定义如下：\n\\begin{itemize}\n    \\item $\\lambda(1) = 1$\n    \\item $\\lambda(2) = 1$\n    \\item $\\lambda(4) = 2$\n    \\item $\\lambda(2^k) = 2^{k-2}$ for $k \\ge 3$\n    \\item $\\lambda(p^k) = \\phi(p^k) = p^{k-1}(p-1)$，其中 $p$ 为奇素数，$\\phi$ 是欧拉函数。\n\\end{itemize}\n对于我们给定的模数 $m = 2^{11} \\cdot 3^{4} \\cdot 5^{2}$，我们将这些规则应用于每个素数幂因子：\n\\begin{enumerate}\n    \\item 对于因子 $2^{11}$：由于指数 $11 \\ge 3$，我们有\n    $$\\lambda(2^{11}) = 2^{11-2} = 2^{9} = 512.$$\n    \\item 对于因子 $3^{4}$：由于 $3$ 是一个奇素数，我们有\n    $$\\lambda(3^{4}) = \\phi(3^{4}) = 3^{4-1}(3-1) = 3^{3} \\cdot 2 = 27 \\cdot 2 = 54.$$\n    \\item 对于因子 $5^{2}$：由于 $5$ 是一个奇素数，我们有\n    $$\\lambda(5^{2}) = \\phi(5^{2}) = 5^{2-1}(5-1) = 5^{1} \\cdot 4 = 20.$$\n\\end{enumerate}\n最大周期是这些值的最小公倍数 (lcm)：\n$$T_{\\text{max}} = \\lambda(m) = \\text{lcm}(\\lambda(2^{11}), \\lambda(3^{4}), \\lambda(5^{2})) = \\text{lcm}(512, 54, 20).$$\n为了计算 lcm，我们找出每个数的素数分解：\n\\begin{itemize}\n    \\item $512 = 2^9$\n    \\item $54 = 2 \\cdot 27 = 2^{1} \\cdot 3^{3}$\n    \\item $20 = 4 \\cdot 5 = 2^{2} \\cdot 5^{1}$\n\\end{itemize}\nlcm 是所有出现的素因子的最高次幂的乘积：\n$$T_{\\text{max}} = \\text{lcm}(2^9, 2^1 \\cdot 3^3, 2^2 \\cdot 5^1) = 2^{\\max(9,1,2)} \\cdot 3^{\\max(0,3,0)} \\cdot 5^{\\max(0,0,1)} = 2^9 \\cdot 3^3 \\cdot 5^1.$$\n现在我们计算这个值：\n$$T_{\\text{max}} = 512 \\cdot 27 \\cdot 5 = 13824 \\cdot 5 = 69120.$$\n因此，可实现的最大周期是 $69120$。\n\n为了证明这个周期是可以实现的，我们必须证明存在一个具有此阶的乘数 $a$。根据中国剩余定理，群 $(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 同构于其分量群的直积：\n$$(\\mathbb{Z}/m\\mathbb{Z})^{\\times} \\cong (\\mathbb{Z}/2^{11}\\mathbb{Z})^{\\times} \\times (\\mathbb{Z}/3^{4}\\mathbb{Z})^{\\times} \\times (\\mathbb{Z}/5^{2}\\mathbb{Z})^{\\times}.$$\n一个元素 $a \\in (\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 对应一个元组 $(a_1, a_2, a_3)$，其中 $a_1 \\in (\\mathbb{Z}/2^{11}\\mathbb{Z})^{\\times}$，$a_2 \\in (\\mathbb{Z}/3^{4}\\mathbb{Z})^{\\times}$，以及 $a_3 \\in (\\mathbb{Z}/5^{2}\\mathbb{Z})^{\\times}$。$a$ 的阶是其分量阶的最小公倍数。为了最大化这个阶，我们必须选择分量 $a_1, a_2, a_3$，使它们在各自的群中都具有可能的最大阶。\n\\begin{itemize}\n    \\item 在 $(\\mathbb{Z}/2^{11}\\mathbb{Z})^{\\times}$ 中，存在最大阶为 $\\lambda(2^{11}) = 512$ 的元素（例如，$a_1=3$ 或 $a_1=5$）。\n    \\item 在 $(\\mathbb{Z}/3^{4}\\mathbb{Z})^{\\times}$（一个循环群）中，存在最大阶为 $\\lambda(3^4) = 54$ 的元素（一个模 $3^4$ 的原根，例如 $a_2=2$）。\n    \\item 在 $(\\mathbb{Z}/5^{2}\\mathbb{Z})^{\\times}$（也是一个循环群）中，存在最大阶为 $\\lambda(5^2) = 20$ 的元素（一个模 $5^2$ 的原根，例如 $a_3=2$）。\n\\end{itemize}\n使用中国剩余定理，我们可以解这个同余方程组：\n$$a \\equiv a_1 \\pmod{2^{11}}$$\n$$a \\equiv a_2 \\pmod{3^{4}}$$\n$$a \\equiv a_3 \\pmod{5^{2}}$$\n一个模 $m$ 的唯一解 $a$ 是存在的。这个构造出的 $a$ 的阶将是 $\\text{lcm}(\\text{ord}(a_1), \\text{ord}(a_2), \\text{ord}(a_3)) = \\text{lcm}(512, 54, 20) = 69120$。\n因此，可以构造一个乘数 $a$ 来达到最大周期。如前所述，任何满足 $\\gcd(X_0,m)=1$ 的种子 $X_0$ 都可以完成这个构造。因此，最大周期长度被确认为 $69120$。",
            "answer": "$$\\boxed{69120}$$"
        },
        {
            "introduction": "重要性采样 (IS) 是一种强大的蒙特卡洛技术，但当提议分布与目标分布严重不匹配时，其估计量可能具有极高的方差。本练习  探讨了一种实用的补救措施——权重截断，并要求你严格分析该技术在控制方差和引入估计偏差之间所做的权衡。通过推导偏差的上界，你将深化对统计估计中基本偏差-方差困境的理解。",
            "id": "3308916",
            "problem": "考虑 $\\;\\mathbb{R}^{d}\\;$ 上的一个目标概率密度 $\\;p\\;$ 和一个提议概率密度 $\\;q\\;$，使得 $\\;p\\;$ 关于 $\\;q\\;$ 是绝对连续的，并且重要性权重 $\\;w(x) = \\frac{p(x)}{q(x)}\\;$ 是 $\\;q$-几乎必然有限的。设 $\\;h:\\mathbb{R}^{d}\\to\\mathbb{R}\\;$ 是一个可测函数，满足对所有 $\\;x\\in\\mathbb{R}^{d}\\;$ 都有 $\\;|h(x)| \\le B\\;$，其中 $\\;B\\in(0,\\infty)\\;$ 是一个已知常数，并定义目标期望为 $\\;\\mu = \\mathbb{E}_{p}[h(X)]\\;$，其中 $\\;X\\sim p\\;$。根据测度变换恒等式，$\\;\\mu = \\mathbb{E}_{q}[w(X)\\,h(X)]\\;$，其中 $\\;X\\sim q\\;$。考虑对于一个阈值 $\\;T \\ge 1\\;$ 的截断重要性权重 $\\;w_{T}(x) = \\min\\{w(x),\\,T\\}\\;$，以及相应的截断估计量均值 $\\;\\mu_{T} = \\mathbb{E}_{q}[w_{T}(X)\\,h(X)]\\;$。\n\n要求您从第一性原理和核心定义出发，分析蒙特卡洛（MC）重要性采样中截断对偏差和方差的影响。具体来说：\n\n1. 仅使用期望、偏差和方差的基本定义，表达由截断引入的偏差，并将其简化为一个在分布 $\\;q\\;$ 下涉及 $\\;w\\;$ 尾部的期望。\n\n2. 假设权重满足以下多项式尾部条件：存在常数 $\\;C0\\;$ 和 $\\;\\beta1\\;$，使得对所有 $\\;t \\ge T\\;$，都有\n$$\n\\mathbb{P}_{q}\\!\\big(w(X)  t\\big) \\le C\\,t^{-\\beta}.\n$$\n仅使用关于期望和尾部概率的公认事实，推导出绝对偏差 $\\;|\\mu - \\mu_{T}|\\;$ 的一个闭式上界，该上界用 $\\;B,\\;C,\\;\\beta,\\;$ 和 $\\;T\\;$ 表示。\n\n3. 从第一性原理出发，简要地为截断估计量的单样本方差定界。也就是说，给出 $\\;\\mathrm{Var}_{q}\\!\\big(w_{T}(X)\\,h(X)\\big)\\;$ 的一个用 $\\;B\\;$ 和 $\\;T\\;$ 表示的有限上界。\n\n将您的最终答案表示为在第2部分中推导出的偏差界的单一解析表达式。无需进行数值舍入。在首次使用时定义任何缩略语；例如，重要性采样（IS）和蒙特卡洛（MC）。",
            "solution": "该问题是有效的，因为它在科学上基于蒙特卡洛（MC）方法的理论，是适定的，具有足够的信息以获得唯一解，并且陈述客观。我们开始进行解答。\n\n问题要求分析一个截断重要性采样（IS）估计量。给定 $\\mathbb{R}^{d}$ 上的目标概率密度 $p$ 和提议概率密度 $q$。重要性权重为 $w(x) = \\frac{p(x)}{q(x)}$。我们希望对一个有界测试函数 $h$（即 $|h(x)| \\le B$）估计其期望 $\\mu = \\mathbb{E}_{p}[h(X)] = \\int_{\\mathbb{R}^d} h(x)p(x)dx$。通过测度变换，这等价于 $\\mu = \\mathbb{E}_{q}[w(X)h(X)]$。截断估计量引入了对于某个阈值 $T \\ge 1$ 的截断权重 $w_{T}(x) = \\min\\{w(x), T\\}$，从而得到有偏的估计量均值 $\\mu_{T} = \\mathbb{E}_{q}[w_{T}(X)h(X)]$。\n\n第1部分：偏差分析。\n截断估计量的偏差是真实期望 $\\mu$ 与截断估计量均值 $\\mu_T$ 之间的差。根据所给定义：\n$$\n\\text{Bias} = \\mu - \\mu_{T} = \\mathbb{E}_{q}[w(X)h(X)] - \\mathbb{E}_{q}[w_{T}(X)h(X)]\n$$\n根据期望的线性性质，我们可以合并这些项：\n$$\n\\text{Bias} = \\mathbb{E}_{q}\\big[ (w(X) - w_{T}(X)) h(X) \\big]\n$$\n项 $w(x) - w_{T}(x)$ 取决于 $w(x)$ 是否超过阈值 $T$。根据定义，$w_{T}(x) = \\min\\{w(x), T\\}$。\n如果 $w(x) \\le T$，则 $w_{T}(x) = w(x)$，且 $w(x) - w_{T}(x) = 0$。\n如果 $w(x)  T$，则 $w_{T}(x) = T$，且 $w(x) - w_{T}(x) = w(x) - T$。\n这使我们可以使用示性函数 $\\mathbb{I}(A)$ 来表示这个差值，如果事件 $A$ 为真，则 $\\mathbb{I}(A)$ 为 $1$，否则为 $0$：\n$$\nw(x) - w_{T}(x) = (w(x) - T) \\mathbb{I}(w(x)  T)\n$$\n将此代入偏差的表达式中，我们得到：\n$$\n\\text{Bias} = \\mathbb{E}_{q}\\big[ (w(X) - T) h(X) \\mathbb{I}(w(X)  T) \\big]\n$$\n这个表达式将偏差表示为在提议分布 $q$ 下的期望，具体来说，它与权重分布中 $w(X)  T$ 的“尾部”有关。\n\n第2部分：绝对偏差的上界。\n我们希望使用多项式尾部条件 $\\mathbb{P}_{q}(w(X)  t) \\le C t^{-\\beta}$（对于 $t \\ge T$，其中 $C  0$ 且 $\\beta  1$），来找到绝对偏差 $|\\mu - \\mu_{T}|$ 的一个上界。\n从偏差的表达式开始：\n$$\n|\\mu - \\mu_{T}| = \\left| \\mathbb{E}_{q}\\big[ (w(X) - T) h(X) \\mathbb{I}(w(X)  T) \\big] \\right|\n$$\n使用性质 $|\\mathbb{E}[Y]| \\le \\mathbb{E}[|Y|]$ 以及 $|ab| = |a||b|$：\n$$\n|\\mu - \\mu_{T}| \\le \\mathbb{E}_{q}\\big[ |(w(X) - T) h(X) \\mathbb{I}(w(X)  T)| \\big] = \\mathbb{E}_{q}\\big[ |w(X) - T| \\cdot |h(X)| \\cdot |\\mathbb{I}(w(X)  T)| \\big]\n$$\n在期望的定义域内，$w(X)  T$，这意味着 $|w(X) - T| = w(X) - T$。示性函数是非负的，所以其绝对值是其自身。我们已知一致界 $|h(x)| \\le B$。代入这些界：\n$$\n|\\mu - \\mu_{T}| \\le \\mathbb{E}_{q}\\big[ (w(X) - T) \\cdot B \\cdot \\mathbb{I}(w(X)  T) \\big]\n$$\n由于 $B$ 是一个正常数，可以将其从期望中提出：\n$$\n|\\mu - \\mu_{T}| \\le B \\cdot \\mathbb{E}_{q}\\big[ (w(X) - T) \\mathbb{I}(w(X)  T) \\big]\n$$\n为了计算剩余的期望，我们使用非负随机变量 $Y$ 的期望恒等式，即 $\\mathbb{E}[Y] = \\int_{0}^{\\infty} \\mathbb{P}(Y  y) dy$。令随机变量为 $Y = (w(X) - T) \\mathbb{I}(w(X)  T)$。对于 $y \\ge 0$，事件 $\\{Y  y\\}$ 等价于事件 $\\{w(X) - T  y\\}$ 和 $\\{w(X)  T\\}$，这可以简化为 $\\{w(X)  T + y\\}$。\n因此，期望为：\n$$\n\\mathbb{E}_{q}\\big[ (w(X) - T) \\mathbb{I}(w(X)  T) \\big] = \\int_{0}^{\\infty} \\mathbb{P}_{q}(w(X)  T + y) dy\n$$\n我们进行变量替换，令 $t = T + y$，因此 $y = t - T$ 且 $dy = dt$。积分限从 $y=0$ 变为 $t=T$，从 $y \\to \\infty$ 变为 $t \\to \\infty$。\n$$\n\\mathbb{E}_{q}\\big[ (w(X) - T) \\mathbb{I}(w(X)  T) \\big] = \\int_{T}^{\\infty} \\mathbb{P}_{q}(w(X)  t) dt\n$$\n现在我们应用给定的多项式尾部条件 $\\mathbb{P}_{q}(w(X)  t) \\le C t^{-\\beta}$，该条件对 $t \\ge T$ 成立：\n$$\n\\int_{T}^{\\infty} \\mathbb{P}_{q}(w(X)  t) dt \\le \\int_{T}^{\\infty} C t^{-\\beta} dt\n$$\n我们计算该积分：\n$$\n\\int_{T}^{\\infty} C t^{-\\beta} dt = C \\left[ \\frac{t^{-\\beta+1}}{-\\beta+1} \\right]_{T}^{\\infty}\n$$\n由于 $\\beta  1$，指数 $1-\\beta$ 是负的。因此，当 $t \\to \\infty$ 时，$t^{1-\\beta} \\to 0$。该积分的计算结果为：\n$$\nC \\left( 0 - \\frac{T^{1-\\beta}}{1-\\beta} \\right) = C \\frac{T^{1-\\beta}}{\\beta-1}\n$$\n将此结果与绝对偏差的界相结合：\n$$\n|\\mu - \\mu_{T}| \\le B \\cdot \\frac{C T^{1-\\beta}}{\\beta-1}\n$$\n这就是所求的闭式上界。\n\n第3部分：单样本方差的上界。\n我们需要给出 $\\mathrm{Var}_{q}(w_{T}(X)h(X))$ 的一个有限上界。令 $Z(X) = w_{T}(X)h(X)$。方差定义为 $\\mathrm{Var}_{q}(Z(X)) = \\mathbb{E}_{q}[Z(X)^2] - (\\mathbb{E}_{q}[Z(X)])^2$。由于方差是非负的，一个简单的方差上界是二阶矩：\n$$\n\\mathrm{Var}_{q}(Z(X)) \\le \\mathbb{E}_{q}[Z(X)^2]\n$$\n我们来分析 $Z(x)^2$ 这一项：\n$$\nZ(x)^2 = (w_{T}(x)h(x))^2 = w_{T}(x)^2 h(x)^2\n$$\n根据定义，$w_{T}(x) = \\min\\{w(x), T\\}$。由于 $w(x) = p(x)/q(x) \\ge 0$，我们有 $0 \\le w_{T}(x) \\le T$。将其平方得到 $w_{T}(x)^2 \\le T^2$。\n我们还已知 $|h(x)| \\le B$，这意味着 $h(x)^2 \\le B^2$。\n结合这些界，我们找到了 $Z(x)^2$ 的一个一致界：\n$$\nZ(x)^2 = w_{T}(x)^2 h(x)^2 \\le T^2 B^2\n$$\n这个不等式对所有 $x \\in \\mathbb{R}^d$ 都成立。因此，其期望也是有界的：\n$$\n\\mathbb{E}_{q}[Z(X)^2] = \\mathbb{E}_{q}[w_{T}(X)^2 h(X)^2] \\le \\mathbb{E}_{q}[T^2 B^2] = T^2 B^2\n$$\n因此，我们得到了方差的一个上界：\n$$\n\\mathrm{Var}_{q}(w_{T}(X)h(X)) \\le B^2 T^2\n$$\n这表明截断重要性权重使得单样本估计量的方差变为有限且有界，这是该技术的一个关键动机。",
            "answer": "$$\\boxed{\\frac{B C T^{1-\\beta}}{\\beta - 1}}$$"
        },
        {
            "introduction": "当无法从目标分布直接采样时，马尔可夫链蒙特卡洛 (MCMC) 方法便成为核心工具，但其有效性依赖于马尔可夫链的收敛性质。本练习  提出了一个关键的案例研究：一个随机游走Metropolis算法，其目标是一个重尾分布。通过这个练习，你将分析为何几何遍历性等强收敛保证会失效，以及这对MCMC估计量的中心极限定理的有效性意味着什么，从而揭示在应用高级模拟算法时审慎检验其理论前提的重要性。",
            "id": "3308869",
            "problem": "考虑实轴上的一个随机游走 Metropolis (RWM) 马尔可夫链，其目标分布的密度与自由度为 $\\nu0$ 的标准学生t分布成正比，即目标密度为 $\\pi(x) \\propto \\left(1 + \\frac{x^{2}}{\\nu}\\right)^{-\\frac{\\nu+1}{2}}$，定义在 $\\mathbb{R}$ 上。提议分布为高斯分布：给定当前状态 $X_{n}=x$，从 $q(\\cdot \\mid x) = \\mathcal{N}(x,\\sigma^{2})$ 中抽取提议 $Y$，其中 $0\\sigma\\infty$ 为固定值，并使用标准的 Metropolis 接受概率。\n\n从马尔可夫链的几何遍历性定义、随机游走 Metropolis 核的形式以及中心极限定理 (CLT) 下遍历均值的渐近正态性出发，完成以下任务：\n\n(i) 利用 $\\pi$ 的尾部行为，从第一性原理出发，论证为何对于任何 $\\nu0$，该 RWM 链的几何遍历性都会失效。\n\n(ii) 令 $f(x)=x$。考虑由马尔可夫链的样本均值给出的 $\\mathbb{E}_{\\pi}[f(X)]$ 的蒙特卡洛估计量。仅使用遍历均值的 CLT 可能成立的必要矩条件，确定最小的自由度阈值 $\\nu_{\\star}$，使得当 $\\nu\\nu_{\\star}$ 时，关于 $f(X)$ 样本均值的 CLT 可能成立。请以单个实数的形式给出 $\\nu_{\\star}$。\n\n(iii) 简要解释几何遍历性的失效对以下两方面的影响：(a) 在 $\\nu \\le \\nu_{\\star}$ 和 $\\nu\\nu_{\\star}$ 的情况下，$f(X)$ 样本均值的 CLT 的有效性；(b) 当诸如分批均值法这类用于估计渐近方差的方法依赖于几何遍历性时，其一致性。\n\n你的最终答案必须是 $\\nu_{\\star}$ 的精确值，以单个实数的形式写出。不涉及单位，也無需进行数值舍入。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **马尔可夫链类型**：随机游走 Metropolis (RWM) 马尔可夫链。\n- **状态空间**：实轴 $\\mathbb{R}$。\n- **目标分布密度**：$\\pi(x) \\propto \\left(1 + \\frac{x^{2}}{\\nu}\\right)^{-\\frac{\\nu+1}{2}}$，其中 $\\nu0$。这是标准学生t分布的核。\n- **提议分布**：给定当前状态 $X_{n}=x$，从高斯分布 $q(\\cdot \\mid x) = \\mathcal{N}(x,\\sigma^{2})$ 中抽取提议 $Y$，其中 $0\\sigma\\infty$ 为固定值。\n- **接受概率**：标准的 Metropolis 接受概率，对于对称的高斯提议，其形式为 $\\alpha(x,y) = \\min\\left(1, \\frac{\\pi(y)}{\\pi(x)}\\right)$。\n- **关注的函数**：$f(x)=x$。\n- **估计量**：马尔可夫链的样本均值，$\\frac{1}{ N} \\sum_{n=1}^N f(X_n)$。\n- **任务**：\n  (i) 从第一性原理出发，论证为何对于任何 $\\nu0$，几何遍历性都会失效。\n  (ii) 找到最小阈值 $\\nu_{\\star}$，使得当 $\\nu\\nu_{\\star}$ 时，关于 $f(x)=x$ 样本均值的中心极限定理 (CLT) 可能成立。\n  (iii) 解释几何遍历性的失效对 CLT 和方差估计的影响。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础扎实**：该问题基于马尔可夫链蒙特卡洛 (MCMC) 方法理论中的标准、成熟概念，特别是随机游走 Metropolis 算法及其收敛性质。学生t分布是标准的概率分布。几何遍历性和马尔可夫链的中心极限定理是该领域的核心概念。该问题在科学和数学上是合理的。\n- **定义明确**：问题陈述清晰。目标分布和提议分布都已完全指定。任务精确，并能基于既定理论得出唯一的、有意义的答案。\n- **客观性**：语言正式、 unambiguous。没有提出主观论断。\n- **完整性和一致性**：问题提供了所有必要信息。设置中没有矛盾之处。\n- **现实性和可行性**：该场景是计算统计学中的常见设置，并提出了一个“重尾”目标分布的典型例子，这在理论上和实践中都非常重要。\n- **无其他缺陷**：问题并非微不足道、隐喻性或故作高深。它探讨了 MCMC 理论中的一个核心概念挑战。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 解答\n\n这个问题涉及以学生t分布为目标的随机游走 Metropolis (RWM) 算法的长期行为。该目标分布的关键特征是其“重尾”，即多项式衰减，这与高斯分布等分布的“轻尾”（指数衰减）形成对比。\n\n**(i) 几何遍历性的失效**\n\n如果一个马尔可夫链以指数速率收敛到其平稳分布 $\\pi$，则称其为几何遍历的。形式上，如果 $P^n(x, \\cdot)$ 是从 $X_0=x$ 开始的 $X_n$ 的分布，那么几何遍历性意味着存在一个函数 $M(x)$ 和一个速率 $\\rho \\in (0,1)$，使得对于所有 $n$，$\\| P^n(x, \\cdot) - \\pi(\\cdot) \\|_{\\text{TV}} \\le M(x) \\rho^n$ 成立，其中 $\\|\\cdot\\|_{\\text{TV}}$ 是全变差范数。对于 RWM 算法，决定收敛速率的一个关键因素是目标密度 $\\pi(x)$ 在尾部（即对于大的 $|x|$）的行为。\n\n直觉上，一个从远离分布主要质量区域开始的链，必须被足够强地“拉回”中心。这种“拉力”是由提议机制和接受概率引起的。在 RWM 中，提议是局部的。给定 $X_n=x$，提出一个提议 $Y=x+Z\\sigma$，其中 $Z \\sim \\mathcal{N}(0,1)$。接受概率为 $\\alpha(x, Y) = \\min\\left(1, \\frac{\\pi(Y)}{\\pi(x)}\\right)$。\n\n我们来分析当 $x  0$ 且很大时的这种情况。目标密度为 $\\pi(x) \\propto \\left(1 + \\frac{x^2}{\\nu}\\right)^{-(\\frac{\\nu+1}{2})}$。对于大的 $x$，其行为近似为 $\\pi(x) \\approx C x^{-(\\nu+1)}$，其中 $C$ 是某个常数。\n对于提议 $y=x+z$，密度比为：\n$$ \\frac{\\pi(y)}{\\pi(x)} = \\left(\\frac{1+x^2/\\nu}{1+y^2/\\nu}\\right)^{(\\frac{\\nu+1}{2})} \\approx \\left(\\frac{x^2}{y^2}\\right)^{(\\frac{\\nu+1}{2})} = \\left(\\frac{x}{x+z}\\right)^{\\nu+1} = \\left(1+\\frac{z}{x}\\right)^{-(\\nu+1)} $$\n对小的 $z/x$ 使用泰勒展开，这近似于 $1 - (\\nu+1)\\frac{z}{x}$。\n\n链在一个大状态 $x$ 的期望漂移近似为 $\\mathbb{E}[X_{n+1}-X_n | X_n=x]$。一个移动以概率 $\\alpha(x,Y)$ 被接受。期望的变化是 $\\mathbb{E}[(Y-x)\\alpha(x,Y)|X_n=x]$。对于大的 $x$，目标密度局部是平坦的，这意味着对于典型的提议 $Y$（其中 $|Y-x|$ 是 $\\sigma$ 的量级），$\\pi(y)/\\pi(x) \\approx 1$。因此，接受概率 $\\alpha(x,Y)$ 接近于 1。链的局部行为模仿了一个简单的对称随机游走。$\\mathbb{R}$ 上的简单随机游走是零常返的，并且探索空间的速度很慢。\n\n为了实现几何遍历性，链必须有朝向原点的强漂移。此链的漂移量级为 $O(1/x)$。这可以通过更仔细地计算位置的期望单步变化来看出。这种漂移太弱，无法确保指数级地返回中心。作为对比，如果目标分布有指数尾，例如 $\\pi(x) \\propto \\exp(-|x|)$，漂移将是一个常数，这是一个强得多的恢复力。\n\n这种弱恢复力意味着当链游荡到尾部时，它需要多项式级的 $x$ 时间才能返回中心，而不是几何遍历性所要求的对数级时间。理论证实了这一点：对于具有高斯提议的 RWM 算法，几何遍历性成立当且仅当目标密度具有比指数更轻的尾部（例如 $\\pi(x) \\propto \\exp(-c|x|^\\beta)$，其中 $\\beta  1$）。学生t分布具有多项式尾，比指数尾更重，因此对于任何 $\\nu0$ 和 $\\sigma0$ 都排除了几何遍历性。\n\n**(ii) 中心极限定理 (CLT) 的阈值**\n\n对于马尔可夫链，关于函数 $f$ 的遍历均值的中心极限定理通常表述为 $\\sqrt{N}(\\bar{f}_N - \\mathbb{E}_{\\pi}[f]) \\xrightarrow{d} \\mathcal{N}(0, \\sigma_f^2)$，其中 $\\bar{f}_N = \\frac{1}{N}\\sum_{n=1}^N f(X_n)$，$\\sigma_f^2$ 是渐近方差。\n这样的 CLT 要以有限、非零的渐近方差 $\\sigma_f^2$ 成立，一个基本的必要条件是 $f(X)$ 在平稳分布 $\\pi$ 下的方差必须是有限的：\n$$ \\text{Var}_{\\pi}(f(X)) = \\mathbb{E}_{\\pi}[f(X)^2] - (\\mathbb{E}_{\\pi}[f(X)])^2  \\infty $$\n如果 $\\text{Var}_{\\pi}(f(X))$ 是无限的，样本均值可能仍然在不同的归一化下收敛（例如，收敛到一个稳定律），但具有 $\\sqrt{N}$ 尺度和高斯极限的标准 CLT 会失效。\n\n在这个问题中，函数是 $f(x)=x$，平稳分布 $\\pi$ 是自由度为 $\\nu$ 的学生t分布。我们必须找到使 $\\text{Var}_{\\pi}(X)  \\infty$ 成立的 $\\nu$ 的条件。\n\n学生t分布关于 0 对称。要使其均值存在，我们需要 $\\mathbb{E}_\\pi[|X|]  \\infty$。当 $\\nu1$ 时这是成立的。如果成立，则 $\\mathbb{E}_\\pi[X]=0$。\n方差为 $\\text{Var}_{\\pi}(X) = \\mathbb{E}_{\\pi}[X^2] - (\\mathbb{E}_{\\pi}[X])^2 = \\mathbb{E}_{\\pi}[X^2]$。\n我们需要确定对于哪些 $\\nu$，二阶矩 $\\mathbb{E}_{\\pi}[X^2]$ 是有限的。\n$$ \\mathbb{E}_{\\pi}[X^2] = C_\\nu \\int_{-\\infty}^{\\infty} x^2 \\left(1 + \\frac{x^2}{\\nu}\\right)^{-\\frac{\\nu+1}{2}} dx $$\n其中 $C_\\nu$ 是归一化常数。为了使这个积分收敛，当 $|x| \\to \\infty$ 时，被积函数必须足够快地衰减。对于大的 $|x|$，被积函数的行为类似于：\n$$ x^2 \\left(\\frac{x^2}{\\nu}\\right)^{-\\frac{\\nu+1}{2}} \\propto x^2 |x|^{-(\\nu+1)} = |x|^{2 - (\\nu+1)} = |x|^{1-\\nu} $$\n积分 $\\int_a^\\infty x^{p} dx$ 收敛当且仅当 $p  -1$。在我们的例子中，指数是 $p = 1-\\nu$。所以我们需要：\n$$ 1 - \\nu  -1 \\implies 2  \\nu $$\n因此，学生t分布的方差有限当且仅当 $\\nu > 2$。这为 $f(x)=x$ 的样本均值的 CLT 可能成立建立了最小矩条件。RWM 链是可逆的，对于可逆链，条件 $\\text{Var}_\\pi(f(X))  \\infty$ 通常足以使 CLT 成立，即使链不是几何遍历的。\n\n因此，最小的自由度阈值是 $\\nu_{\\star} = 2$。\n\n**(iii) 几何遍历性失效的影响**\n\n(a) **对 $f(X)$ 样本均值的 CLT 有效性的影响**：\n- 在 $\\nu  \\nu_{\\star} = 2$ 的情况下，条件 $\\text{Var}_{\\pi}(X)  \\infty$ 得到满足。对于像这个 RWM 这样的可逆马尔可夫链，这个条件足以使 CLT 成立。所以，尽管几何遍历性失效，CLT 仍然是有效的。缺少几何遍历性意味着自协方差 $\\text{Cov}(X_n, X_0)$ 是多项式衰减而不是指数衰减，但它们的衰减速度仍然足以使渐近方差公式中的和收敛。\n- 在 $\\nu \\le \\nu_{\\star} = 2$ 的情况下，方差 $\\text{Var}_{\\pi}(X)$ 是无限的。具有 $\\sqrt{N}$ 尺度和高斯极限的标准 CLT 不能成立。样本均值在适当缩放后，将依分布收敛到一个非高斯的稳定律。在这里，几何遍历性的失效是次要问题；主要障碍是目标分布的方差无限。\n\n(b) **对用于估计方差的方法的一致性的影响**：\n几何遍历性的失效对于估计 CLT 中出现的渐近方差 $\\sigma_f^2$ 具有严重的实际后果。用于估计 $\\sigma_f^2$ 的标准方法，如分批均值法或谱方差估计量，都依赖于相关性快速衰减的假设。\n这些估计量一致性（即当样本量 $N \\to \\infty$ 时，估计值收敛到真实的 $\\sigma_f^2$）的理论证明几乎总是假设几何遍历性或类似的强混合条件。当一个链仅仅是多项式遍历的，如此处的情况，长程相关性会更持久。\n这种相关性的缓慢衰减意味着，对于分批均值法，要获得近似独立的批次，批量大小必须比几何遍历情况下大得多。标准的批量大小增长率选择（例如 $b_N \\propto N^{1/2}$）可能不足，导致方差估计量有偏或不一致。本质上，虽然当 $\\nu2$ 时 CLT 可能成立，但几何遍历性的失效使得使用标准的 MCMC 输出分析工具来可靠地估计极限正态分布的方差变得极其困难。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}