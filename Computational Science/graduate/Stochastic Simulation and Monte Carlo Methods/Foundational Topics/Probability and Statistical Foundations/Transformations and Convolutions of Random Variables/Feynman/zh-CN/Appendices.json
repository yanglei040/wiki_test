{
    "hands_on_practices": [
        {
            "introduction": "变量变换是概率论中的一个基本工具，它允许我们从一组已知随机变量的分布推导出另一组相关变量的分布。一个极具启发性的例子是从笛卡尔坐标系到其他坐标系的变换。这项练习将探讨如何将两个独立的标准正态变量从笛卡尔坐标 $(X_1, X_2)$ 变换到一个类极坐标系统 $(S, T)$。通过应用多变量的变量变换公式，您将发现一个深刻而优雅的性质：对于二维高斯分布，其径向分量和角度分量是独立的，这源于其分布的旋转对称性。这项练习旨在磨练您处理雅可比行列式以及非单射（多对一）映射的技巧 。",
            "id": "3357876",
            "problem": "考虑一个随机向量 $(X_1, X_2)$，其分量是独立同分布 (i.i.d.) 的标准正态随机变量。定义变换\n$$\nS = X_1^2 + X_2^2, \\qquad T = \\arctan\\!\\left(\\frac{X_2}{X_1}\\right),\n$$\n其中反正切函数取其主值分支，因此 $T \\in \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$。从 $(X_1, X_2)$ 的联合概率密度函数 (PDF) 出发，利用多元变量变换定理，推导 $(S,T)$ 的联合概率密度函数 $f_{S,T}(s,t)$。你的推导必须明确说明变换的雅可比行列式，并严格处理映射 $\\Theta \\mapsto T = \\arctan(\\tan(\\Theta))$ 的多对一性质。\n\n证明联合概率密度函数 $f_{S,T}(s,t)$ 可以分解为边际概率密度函数 $f_S(s)$ 和 $f_T(t)$ 的乘积，明确指出 $f_S(s)$ 和 $f_T(t)$，并解释为什么这种分解成立。你的最终答案必须是 $f_{S,T}(s,t)$ 在其支撑集上的单一闭式表达式；在支撑集之外，密度应被理解为零。无需进行数值四舍五入。",
            "solution": "用户希望推导两个独立同分布 (i.i.d.) 的标准正态随机变量经过变换后的联合概率密度函数 (PDF)。\n\n### 步骤 1：初始设置与问题验证\n这个问题是适定的，并且在概率论中有坚实的科学基础。\n随机向量为 $(X_1, X_2)$，其中 $X_1$ 和 $X_2$ 是独立同分布的标准正态随机变量，$X_i \\sim \\mathcal{N}(0, 1)$，对于 $i \\in \\{1, 2\\}$。单个标准正态变量的 PDF 为 $f_X(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right)$。由于独立性，它们的联合 PDF 是其边际 PDF 的乘积：\n$$\nf_{X_1, X_2}(x_1, x_2) = f_{X_1}(x_1) f_{X_2}(x_2) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x_1^2}{2}\\right) \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x_2^2}{2}\\right) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{x_1^2 + x_2^2}{2}\\right).\n$$\n$(X_1, X_2)$ 的定义域是整个平面 $\\mathbb{R}^2$。\n\n新的随机变量由以下变换定义：\n$$\nS = X_1^2 + X_2^2, \\qquad T = \\arctan\\left(\\frac{X_2}{X_1}\\right).\n$$\n$S$ 的支撑集是 $s  0$，因为 $X_1$ 和 $X_2$ 是连续随机变量，所以 $X_1^2 + X_2^2 = 0$ 的概率为零。反正切函数的主值将 $T$ 的支撑集限制在 $t \\in \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$。因此，$(S,T)$ 的联合分布的支撑集是半无限带 $(0, \\infty) \\times \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$。\n\n### 步骤 2：逆变换与雅可比行列式\n我们必须使用多元变量变换定理。从 $(x_1, x_2)$ 到 $(s, t)$ 的变换在整个 $\\mathbb{R}^2$ 上不是一对一的。对于目标空间中的一个给定点 $(s, t)$，我们需要找到所有对应的点 $(x_1, x_2)$。\n根据 $s$ 和 $t$ 的定义：\n$$\n\\tan(t) = \\frac{x_2}{x_1} \\implies x_2 = x_1 \\tan(t).\n$$\n将此代入 $s$ 的表达式中：\n$$\ns = x_1^2 + (x_1 \\tan(t))^2 = x_1^2 (1 + \\tan^2(t)) = x_1^2 \\sec^2(t).\n$$\n由于 $t \\in \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$，所以 $\\sec^2(t) \\ge 1$。这得到 $x_1^2 = s \\cos^2(t)$。\n这个方程对 $x_1$ 产生两个可能的解：\n$$\nx_1 = \\pm \\sqrt{s} \\cos(t).\n$$\n由于 $t \\in \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$，所以 $\\cos(t)  0$。$x_1$ 的符号决定了我们考虑的是哪个解。\n\n$(X_1, X_2)$ 的定义域 $\\mathbb{R}^2$ 可以被划分为两个不相交的区域（忽略测度为零的直线 $x_1=0$）：\n1.  $\\mathcal{D}_1 = \\{ (x_1, x_2) \\in \\mathbb{R}^2 \\mid x_1  0 \\}$ (右半平面)。\n2.  $\\mathcal{D}_2 = \\{ (x_1, x_2) \\in \\mathbb{R}^2 \\mid x_1  0 \\}$ (左半平面)。\n\n对于每个区域，变换都是一对一的。我们可以为每个区域找到逆变换。\n\n**$\\mathcal{D}_1$ ($x_1  0$) 的逆变换：**\n我们必须取 $x_1$ 的正根：\n$$\nx_1 = \\sqrt{s} \\cos(t).\n$$\n那么 $x_2$ 是：\n$$\nx_2 = x_1 \\tan(t) = (\\sqrt{s} \\cos(t)) \\tan(t) = \\sqrt{s} \\sin(t).\n$$\n所以第一个逆变换是 $\\mathbf{h}_1(s,t) = (\\sqrt{s} \\cos(t), \\sqrt{s} \\sin(t))$。\n\n**$\\mathcal{D}_2$ ($x_1  0$) 的逆变换：**\n我们必须取 $x_1$ 的负根：\n$$\nx_1 = -\\sqrt{s} \\cos(t).\n$$\n那么 $x_2$ 是：\n$$\nx_2 = x_1 \\tan(t) = (-\\sqrt{s} \\cos(t)) \\tan(t) = -\\sqrt{s} \\sin(t).\n$$\n所以第二个逆变换是 $\\mathbf{h}_2(s,t) = (-\\sqrt{s} \\cos(t), -\\sqrt{s} \\sin(t))$。\n\n现在我们为每个逆变换计算雅可比行列式。逆函数 $\\mathbf{h}(s,t) = (x_1(s,t), x_2(s,t))$ 的雅可比矩阵是：\n$$\nJ_{\\mathbf{h}}(s,t) = \\begin{pmatrix} \\frac{\\partial x_1}{\\partial s}  \\frac{\\partial x_1}{\\partial t} \\\\ \\frac{\\partial x_2}{\\partial s}  \\frac{\\partial x_2}{\\partial t} \\end{pmatrix}.\n$$\n\n**$\\mathbf{h}_1$ 的雅可比行列式：**\n$x_1 = s^{1/2} \\cos(t)$, $x_2 = s^{1/2} \\sin(t)$.\n$$\n\\frac{\\partial x_1}{\\partial s} = \\frac{1}{2}s^{-1/2} \\cos(t), \\quad \\frac{\\partial x_1}{\\partial t} = -s^{1/2} \\sin(t)\n$$\n$$\n\\frac{\\partial x_2}{\\partial s} = \\frac{1}{2}s^{-1/2} \\sin(t), \\quad \\frac{\\partial x_2}{\\partial t} = s^{1/2} \\cos(t)\n$$\n行列式为：\n$$\n\\det(J_{\\mathbf{h}_1}) = \\left(\\frac{1}{2}s^{-1/2} \\cos(t)\\right)\\left(s^{1/2} \\cos(t)\\right) - \\left(-s^{1/2} \\sin(t)\\right)\\left(\\frac{1}{2}s^{-1/2} \\sin(t)\\right) = \\frac{1}{2}\\cos^2(t) + \\frac{1}{2}\\sin^2(t) = \\frac{1}{2}.\n$$\n所以，$| \\det(J_{\\mathbf{h}_1}) | = \\frac{1}{2}$。\n\n**$\\mathbf{h}_2$ 的雅可比行列式：**\n$x_1 = -s^{1/2} \\cos(t)$, $x_2 = -s^{1/2} \\sin(t)$.\n$$\n\\frac{\\partial x_1}{\\partial s} = -\\frac{1}{2}s^{-1/2} \\cos(t), \\quad \\frac{\\partial x_1}{\\partial t} = s^{1/2} \\sin(t)\n$$\n$$\n\\frac{\\partial x_2}{\\partial s} = -\\frac{1}{2}s^{-1/2} \\sin(t), \\quad \\frac{\\partial x_2}{\\partial t} = -s^{1/2} \\cos(t)\n$$\n行列式为：\n$$\n\\det(J_{\\mathbf{h}_2}) = \\left(-\\frac{1}{2}s^{-1/2} \\cos(t)\\right)\\left(-s^{1/2} \\cos(t)\\right) - \\left(s^{1/2} \\sin(t)\\right)\\left(-\\frac{1}{2}s^{-1/2} \\sin(t)\\right) = \\frac{1}{2}\\cos^2(t) + \\frac{1}{2}\\sin^2(t) = \\frac{1}{2}.\n$$\n所以，$| \\det(J_{\\mathbf{h}_2}) | = \\frac{1}{2}$。\n\n### 步骤 3：联合 PDF 的推导\n对于多对一映射，变量变换定理指出，新的 PDF 是在每个原像点上计算的原始 PDF 与相应的雅可比行列式绝对值的乘积之和：\n$$\nf_{S,T}(s,t) = \\sum_{i=1}^2 f_{X_1, X_2}(\\mathbf{h}_i(s,t)) \\left| \\det(J_{\\mathbf{h}_i}(s,t)) \\right|.\n$$\n对于两个逆变换 $\\mathbf{h}_1$ 和 $\\mathbf{h}_2$，项 $x_1^2 + x_2^2$ 都变为：\n$$\n(\\pm\\sqrt{s}\\cos(t))^2 + (\\pm\\sqrt{s}\\sin(t))^2 = s\\cos^2(t) + s\\sin^2(t) = s.\n$$\n因此，对于 $i=1$ 和 $i=2$：\n$$\nf_{X_1, X_2}(\\mathbf{h}_i(s,t)) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right).\n$$\n现在，我们可以计算 $f_{S,T}(s,t)$：\n$$\nf_{S,T}(s,t) = f_{X_1, X_2}(\\mathbf{h}_1(s,t)) | \\det(J_{\\mathbf{h}_1}) | + f_{X_1, X_2}(\\mathbf{h}_2(s,t)) | \\det(J_{\\mathbf{h}_2}) |\n$$\n$$\nf_{S,T}(s,t) = \\left(\\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right)\\right) \\cdot \\frac{1}{2} + \\left(\\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right)\\right) \\cdot \\frac{1}{2}\n$$\n$$\nf_{S,T}(s,t) = 2 \\cdot \\left(\\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right) \\cdot \\frac{1}{2}\\right) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right).\n$$\n这个表达式在 $s0$ 和 $t \\in \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$ 时有效。在其他地方，$f_{S,T}(s,t)=0$。\n\n### 步骤 4：分解与解释\n联合 PDF 可以分解为：\n$$\nf_{S,T}(s,t) = \\left(\\frac{1}{2} \\exp\\left(-\\frac{s}{2}\\right)\\right) \\cdot \\left(\\frac{1}{\\pi}\\right).\n$$\n这种分解的形式为 $f_{S,T}(s,t) = f_S(s)f_T(t)$，这表明随机变量 $S$ 和 $T$ 是独立的。让我们来确定边际 PDF。\n\n$S$ 的边际 PDF 是：\n$$\nf_S(s) = \\frac{1}{2} \\exp\\left(-\\frac{s}{2}\\right), \\quad \\text{for } s  0.\n$$\n这是自由度为 $k=2$ 的卡方分布 $\\chi^2(2)$ 的 PDF，它等价于速率参数为 $\\lambda = \\frac{1}{2}$ 的指数分布。这是正确的，因为 $S = X_1^2 + X_2^2$，其中 $X_1, X_2$ 是独立同分布的 $\\mathcal{N}(0,1)$ 变量，而 $k$ 个标准正态变量的平方和服从 $\\chi^2(k)$ 分布。\n\n$T$ 的边际 PDF 是：\n$$\nf_T(t) = \\frac{1}{\\pi}, \\quad \\text{for } t \\in \\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right).\n$$\n这是在区间 $\\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$ 上的均匀分布的 PDF。该区间的长度是 $\\pi$，所以常数密度确实是 $\\frac{1}{\\pi}$。\n\n分解为边际 PDF，以及由此得出的 $S$ 和 $T$ 的独立性，是联合标准正态分布的圆形对称性的一个基本结果。$f_{X_1, X_2}(x_1, x_2)$ 的值仅取决于与原点的距离的平方，$x_1^2 + x_2^2$。变量 $S$ 是这个距离的平方，而 $T$ 与距原点的角度或方向有关。对于一个在旋转下不变（各向同性）的分布，其幅度和方向是独立的随机变量。我们的推导在这个具体案例中证实了这一普遍原理。\n\n$(S,T)$ 在其支撑集上的最终联合 PDF 是：\n$$\nf_{S,T}(s,t) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right).\n$$",
            "answer": "$$\\boxed{\\frac{1}{2\\pi} \\exp\\left(-\\frac{s}{2}\\right)}$$"
        },
        {
            "introduction": "在掌握了单变量变换之后，我们进而探讨卷积，它描述了独立随机变量之和的分布。本练习将研究两个独立柯西（Cauchy）随机变量之和，柯西分布以其重尾特性和不存在定义的均值而闻名。您将使用特征函数——一种处理卷积的强大工具——来从理论上推导该和的分布形式。为了连接理论与实践，您需要设计并实施一个蒙特卡洛模拟，以经验性地验证您的理论发现。这项练习展示了分析推导与计算验证之间的协同作用，这是现代随机方法的一个基石 。",
            "id": "3357841",
            "problem": "考虑独立随机变量 $X$ 和 $Y$，它们满足 $X \\sim \\mathrm{Cauchy}(0,\\gamma_1)$ 和 $Y \\sim \\mathrm{Cauchy}(0,\\gamma_2)$，其中记号 $\\mathrm{Cauchy}(\\mu,\\gamma)$ 表示位置参数为 $\\mu$、尺度参数为 $\\gamma$ 的柯西分布 (Cauchy distribution)。在随机模拟和蒙特卡洛 (MC) 方法中，人们使用诸如特征函数和基于分位数的估计量等基本工具来研究随机变量的变换和卷积。实值随机变量 $W$ 的特征函数定义为 $\\varphi_W(t) = \\mathbb{E}[e^{itW}]$，对于独立的 $X$ 和 $Y$，其和的特征函数满足 $\\varphi_{X+Y}(t) = \\varphi_X(t)\\,\\varphi_Y(t)$。\n\n您的任务是：\n- 从第一性原理出发，使用特征函数和独立性，推导当 $X$ 和 $Y$ 是位置参数为零、尺度参数为正值 $\\gamma_1$ 和 $\\gamma_2$ 的独立柯西随机变量时，$Z = X+Y$ 的分布形式。明确指出 $Z$ 的分布是什么，并用 $\\gamma_1$ 和 $\\gamma_2$ 表示其尺度参数。\n- 设计一个基于顺序统计量的蒙特卡洛估计量，用于估计位置参数为零的柯西随机变量的尺度参数。仅从分位数的定义和柯西分布的性质出发，论证您的选择，不假设任何关于尺度的闭式估计量。\n- 实现一个完整、可运行的程序，对下面的每个测试用例，执行以下步骤：\n  1. 使用可复现的伪随机数生成器生成 $N$ 个独立的 $X$ 和 $Y$ 样本，其中 $X \\sim \\mathrm{Cauchy}(0,\\gamma_1)$ 和 $Y \\sim \\mathrm{Cauchy}(0,\\gamma_2)$，并构成 $Z = X + Y$。\n  2. 使用您上面推导的基于分位数的估计量来估计 $Z$ 的尺度。\n  3. 计算估计尺度与您为 $Z$ 推导出的理论尺度之间的绝对相对误差。绝对相对误差必须按 $|\\widehat{\\gamma} - \\gamma_{\\text{theory}}|/\\gamma_{\\text{theory}}$ 计算。\n- 输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其中每个条目是相应测试用例的绝对相对误差，表示为浮点数。本问题不涉及单位。\n\n使用以下测试套件，每个测试用例由 $(\\gamma_1,\\gamma_2,N,\\text{seed})$ 指定，其中 $\\gamma_1$ 和 $\\gamma_2$ 是严格正实数，$N$ 是正整数样本量，`seed` 是用于为随机数生成器提供种子的非负整数：\n- 测试用例 1：$(\\gamma_1,\\gamma_2,N,\\text{seed}) = (0.5, 1.5, 400000, 12345)$\n- 测试用例 2：$(\\gamma_1,\\gamma_2,N,\\text{seed}) = (10^{-6}, 3\\cdot 10^{-6}, 400000, 54321)$\n- 测试用例 3：$(\\gamma_1,\\gamma_2,N,\\text{seed}) = (100, 250, 400000, 11111)$\n- 测试用例 4：$(\\gamma_1,\\gamma_2,N,\\text{seed}) = (0.1, 0.1, 400000, 22222)$\n\n您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中 $r_k$ 是根据上述模拟计算出的第 $k$ 个测试用例的绝对相对误差。",
            "solution": "经评估，该问题是有效的，因为它在概率论中有科学依据，问题设定良好，目标明确，数据充分，并且没有任何事实错误、主观论断或含糊不清之处。它提出了一个随机模拟领域中标准的、可验证的问题。\n\n按要求，解答分为两部分：第一部分是两个独立柯西变量之和的分布的理论推导；第二部分是基于分位数的尺度参数蒙特卡洛估计量的设计。\n\n### 第一部分：独立柯西随机变量之和的分布\n\n设 $X$ 和 $Y$ 是独立随机变量，满足 $X \\sim \\mathrm{Cauchy}(0, \\gamma_1)$ 和 $Y \\sim \\mathrm{Cauchy}(0, \\gamma_2)$，其中 $\\gamma_1  0$ 和 $\\gamma_2  0$ 是尺度参数。我们想要找出它们的和 $Z = X+Y$ 的分布。\n\n服从位置参数为 $\\mu$、尺度参数为 $\\gamma$ 的柯西分布的随机变量 $W$，记作 $W \\sim \\mathrm{Cauchy}(\\mu, \\gamma)$，其特征函数由下式给出：\n$$ \\varphi_W(t) = \\mathbb{E}[e^{itW}] = e^{i\\mu t - \\gamma|t|} $$\n对于给定的随机变量 $X \\sim \\mathrm{Cauchy}(0, \\gamma_1)$，其位置参数为 $\\mu_X = 0$，尺度为 $\\gamma_1$。它的特征函数是：\n$$ \\varphi_X(t) = e^{i(0)t - \\gamma_1|t|} = e^{-\\gamma_1|t|} $$\n类似地，对于随机变量 $Y \\sim \\mathrm{Cauchy}(0, \\gamma_2)$，其位置参数为 $\\mu_Y = 0$，尺度为 $\\gamma_2$。它的特征函数是：\n$$ \\varphi_Y(t) = e^{i(0)t - \\gamma_2|t|} = e^{-\\gamma_2|t|} $$\n如问题所述，对于独立随机变量 $X$ 和 $Y$，它们的和 $Z = X+Y$ 的特征函数是它们各自特征函数的乘积：\n$$ \\varphi_Z(t) = \\varphi_{X+Y}(t) = \\varphi_X(t) \\varphi_Y(t) $$\n代入 $\\varphi_X(t)$ 和 $\\varphi_Y(t)$ 的表达式，我们得到：\n$$ \\varphi_Z(t) = (e^{-\\gamma_1|t|}) (e^{-\\gamma_2|t|}) = e^{-\\gamma_1|t| - \\gamma_2|t|} = e^{-(\\gamma_1 + \\gamma_2)|t|} $$\n这个得到的特征函数 $\\varphi_Z(t) = e^{-(\\gamma_1 + \\gamma_2)|t|}$ 具有 $e^{i\\mu_Z t - \\gamma_Z|t|}$ 的形式，其中位置参数为 $\\mu_Z = 0$，尺度参数为 $\\gamma_Z = \\gamma_1 + \\gamma_2$。\n\n根据特征函数的唯一性定理，该定理指出概率分布由其特征函数唯一确定，我们可以得出结论，随机变量 $Z$ 也服从柯西分布。具体来说，$Z$ 服从位置参数为0、尺度参数为各个尺度参数之和的柯西分布。\n\n因此，$Z$ 的分布是：\n$$ Z \\sim \\mathrm{Cauchy}(0, \\gamma_1 + \\gamma_2) $$\n$Z$ 的理论尺度参数，我们记作 $\\gamma_{\\text{theory}}$，是 $\\gamma_{\\text{theory}} = \\gamma_1 + \\gamma_2$。这个性质表明柯西分布是一种稳定分布。\n\n### 第二部分：基于分位数的尺度参数估计量的设计\n\n任务是为位置参数为零的柯西随机变量 $W \\sim \\mathrm{Cauchy}(0, \\gamma)$ 设计一个基于顺序统计量的蒙特卡洛估计量来估计其尺度参数 $\\gamma$。我们从分位数的定义开始。\n\n随机变量 $W \\sim \\mathrm{Cauchy}(\\mu, \\gamma)$ 的累积分布函数 (CDF) 是：\n$$ F_W(w) = P(W \\le w) = \\frac{1}{2} + \\frac{1}{\\pi}\\arctan\\left(\\frac{w-\\mu}{\\gamma}\\right) $$\n分位数函数 $Q_W(p) = F_W^{-1}(p)$ 给出值 $w$，使得对于概率 $p \\in (0, 1)$ 有 $F_W(w)=p$。我们可以通过对CDF求逆来推导此函数：\n$$ p = \\frac{1}{2} + \\frac{1}{\\pi}\\arctan\\left(\\frac{Q_W(p)-\\mu}{\\gamma}\\right) $$\n$$ \\pi\\left(p - \\frac{1}{2}\\right) = \\arctan\\left(\\frac{Q_W(p)-\\mu}{\\gamma}\\right) $$\n$$ \\tan\\left(\\pi\\left(p - \\frac{1}{2}\\right)\\right) = \\frac{Q_W(p)-\\mu}{\\gamma} $$\n$$ Q_W(p) = \\mu + \\gamma \\tan\\left(\\pi\\left(p - \\frac{1}{2}\\right)\\right) $$\n对于指定的位置参数为零的柯西分布情况，我们设 $\\mu=0$：\n$$ Q_W(p) = \\gamma \\tan\\left(\\pi\\left(p - \\frac{1}{2}\\right)\\right) $$\n为了构造 $\\gamma$ 的估计量，我们可以使用两个不同分位数之间的关系。一个稳健且常见的选择是使用第一和第三四分位数，它们对应于 $p_1 = 0.25$ 和 $p_2 = 0.75$。\n设 $Q_1 = Q_W(0.25)$ 和 $Q_3 = Q_W(0.75)$。\n对于第三四分位数 ($p=0.75$):\n$$ Q_3 = \\gamma \\tan\\left(\\pi\\left(0.75 - 0.5\\right)\\right) = \\gamma \\tan\\left(\\frac{\\pi}{4}\\right) = \\gamma \\cdot 1 = \\gamma $$\n对于第一四分位数 ($p=0.25$):\n$$ Q_1 = \\gamma \\tan\\left(\\pi\\left(0.25 - 0.5\\right)\\right) = \\gamma \\tan\\left(-\\frac{\\pi}{4}\\right) = \\gamma \\cdot (-1) = -\\gamma $$\n这两个分位数之差是四分位距 (IQR):\n$$ \\mathrm{IQR} = Q_3 - Q_1 = \\gamma - (-\\gamma) = 2\\gamma $$\n根据这个关系，我们可以将尺度参数 $\\gamma$ 表示为四分位距的一半：\n$$ \\gamma = \\frac{Q_3 - Q_1}{2} = \\frac{\\mathrm{IQR}}{2} $$\n这提供了一种估计 $\\gamma$ 的直接方法。给定从 $Z$ 的分布中抽取的 $N$ 个样本集合 $\\{z_1, z_2, \\dots, z_N\\}$，我们可以计算样本四分位数。样本分位数由顺序统计量（排序后的样本）导出，是真实分位数的估计量。设 $\\widehat{Q}_Z(p)$ 是数据的样本 $p$-分位数。我们对 $\\gamma_Z$ 的估计量，记作 $\\widehat{\\gamma}$，是：\n$$ \\widehat{\\gamma} = \\frac{\\widehat{Q}_Z(0.75) - \\widehat{Q}_Z(0.25)}{2} $$\n这个估计量如要求一样，是基于顺序统计量的，并且它被认为是柯西分布尺度参数的一个稳健估计量。蒙特卡洛模拟将使用此公式来估计生成的 $Z$ 样本的尺度参数。\n程序将实现这个估计量来求得 $\\widehat{\\gamma}$，计算理论尺度 $\\gamma_{\\text{theory}} = \\gamma_1 + \\gamma_2$，然后计算绝对相对误差 $|\\widehat{\\gamma} - \\gamma_{\\text{theory}}|/\\gamma_{\\text{theory}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Monte Carlo simulations to estimate the scale parameter of the sum\n    of two independent Cauchy random variables and calculates the relative error.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (gamma1, gamma2, N, seed)\n    test_cases = [\n        (0.5, 1.5, 400000, 12345),\n        (1e-6, 3e-6, 400000, 54321),\n        (100.0, 250.0, 400000, 11111),\n        (0.1, 0.1, 400000, 22222),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma1, gamma2, N, seed = case\n\n        # Step 1: Generate N independent samples of X and Y and form Z = X + Y.\n        \n        # Initialize a reproducible pseudorandom number generator.\n        rng = np.random.default_rng(seed)\n\n        # Generate standard Cauchy(0, 1) samples.\n        # Note: If S ~ Cauchy(0, 1), then mu + gamma * S ~ Cauchy(mu, gamma).\n        # Since mu=0, we only need to scale the standard samples.\n        x_samples = gamma1 * rng.standard_cauchy(size=N)\n        y_samples = gamma2 * rng.standard_cauchy(size=N)\n\n        # The sum of independent samples is a sample of the sum Z = X + Y.\n        z_samples = x_samples + y_samples\n\n        # Step 2: Estimate the scale of Z using the quantile-based estimator.\n        # The estimator is based on the interquartile range (IQR).\n        # gamma_hat = (Q3 - Q1) / 2\n        q75 = np.quantile(z_samples, 0.75)\n        q25 = np.quantile(z_samples, 0.25)\n        \n        gamma_hat = (q75 - q25) / 2.0\n\n        # Step 3: Compute the absolute relative error.\n        \n        # The theoretical scale of Z = X + Y is gamma_theory = gamma1 + gamma2.\n        gamma_theory = gamma1 + gamma2\n        \n        # Calculate the absolute relative error.\n        # error = |estimated - theoretical| / theoretical\n        absolute_relative_error = np.abs(gamma_hat - gamma_theory) / gamma_theory\n        \n        results.append(absolute_relative_error)\n\n    # Final print statement in the exact required format.\n    # The output is a single line with a comma-separated list of errors.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际应用中，理论上的卷积积分通常需要通过数值方法进行近似计算，尤其是在随机模拟中，而快速傅里叶变换（FFT）是实现这一目标的首选工具。这项练习深入探讨了我们希望得到的数学概念——线性卷积——与FFT算法自然计算的循环卷积之间的关键区别。您将学习标准的“零填充”（zero-padding）技术，以利用FFT正确计算线性卷积，并量化在没有足够填充时出现的“环绕”（wrap-around）误差。对于任何需要精确模拟随机变量求和或实现其他统计算法的人来说，掌握这项计算技术至关重要 。",
            "id": "3357868",
            "problem": "给定两个独立的随机变量，其概率密度定义在实轴上，记为 $X$（密度为 $f_X$）和 $Y$（密度为 $f_Y$）。和 $Z = X + Y$ 的密度是 $f_X$ 和 $f_Y$ 在 $\\mathbb{R}$ 上的线性卷积，由积分 $f_Z(z) = \\int_{\\mathbb{R}} f_X(x) f_Y(z - x)\\,dx$ 定义。在计算中，通常通过在均匀离散网格上采样来近似 $f_X$ 和 $f_Y$，然后使用离散傅里叶变换计算卷积的近似值，该变换原生实现在离散网格上的循环卷积。在有限周期离散网格上的循环卷积与在 $\\mathbb{R}$ 上的线性卷积之间存在概念上和实践上的差异。您的任务是：从第一性原理出发，精确阐述这种差异；设计一种补零策略，以使用循环卷积来近似线性卷积；并量化当补零不足时引入的环绕误差。\n\n仅从核心定义出发（不得假定任何专门的卷积定理），按以下步骤进行：\n\n1. 定义 $\\mathbb{R}$ 上两个可积函数的线性卷积，并解释在间距为 $h  0$ 的均匀网格上采样且函数具有限支撑如何导向两个有限序列的离散线性卷积。将两个长度同为 $N$ 的有限序列的离散循环卷积定义为模 $N$（即在离散环面上）执行的卷积。解释为什么循环卷积对应于序列的 $N$-周期延拓的卷积。\n\n2. 提出一种补零策略，该策略使用对序列补零后的循环卷积，来精确恢复原始有限序列的离散线性卷积。您的推导必须陈述一个关于补零长度的充分必要条件，以保证计算出的样本中不发生环绕失真。\n\n3. 对于一对普通有限支撑、非负、可和的序列 $(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$，它们代表离散化的概率质量函数（即 $\\sum_k x_k = 1$ 和 $\\sum_k y_k = 1$），令 $c^{\\mathrm{lin}}$ 表示它们长度为 $L = n + m - 1$ 的离散线性卷积，令 $c^{\\mathrm{circ}}_N$ 表示以长度 $N \\in \\mathbb{N}$ 计算的离散循环卷积。通过对 $c^{\\mathrm{circ}}_N$ 进行周期性平铺并截断为前 $L$ 个样本，来定义线性卷积的环绕近似。将环绕误差定义为此近似与 $c^{\\mathrm{lin}}$ 之间的 $\\ell_1$ 距离。推导此误差关于 $c^{\\mathrm{lin}}$ 的 $N$-周期化的表达式，并获得一个仅依赖于 $c^{\\mathrm{lin}}$ 超出索引 $N - 1$ 的尾部质量的界。\n\n4. 实现一个程序，该程序：\n   - 构建下面指定的测试序列。\n   - 直接计算离散线性卷积 $c^{\\mathrm{lin}}$。\n   - 使用快速傅里叶变换（FFT；必须使用FFT以保证循环卷积的效率和清晰度）计算离散循环卷积 $c^{\\mathrm{circ}}_N$。\n   - 通过对 $c^{\\mathrm{circ}}_N$ 进行周期性平铺和截断，形成长度为 $L$ 的环绕近似。\n   - 输出环绕近似与 $c^{\\mathrm{lin}}$ 之间的 $\\ell_1$ 距离作为环绕误差。\n\n仅使用纯数学量；不涉及物理单位。所有角度（如有）在此不适用。所有答案必须是数值浮点数。\n\n测试套件（构建这些确切的案例；每个案例需要计算一个等于环绕误差的浮点数）：\n- 案例 $1\\mathrm{a}$：$x$ 在 $\\{0,\\dots,9\\}$ 上均匀分布，即对于 $k \\in \\{0,\\dots,9\\}$，$x_k = 1/10$；$y$ 在 $\\{0,\\dots,4\\}$ 上均匀分布，即对于 $k \\in \\{0,\\dots,4\\}$，$y_k = 1/5$；循环长度 $N = 10$。\n- 案例 $1\\mathrm{b}$：与案例 $1\\mathrm{a}$ 相同的 $x$ 和 $y$；循环长度 $N = 14$。\n- 案例 $2\\mathrm{a}$：$x$ 是在 $\\{0,\\dots,7\\}$ 上的克罗内克 δ 函数，其中 $x_7 = 1$ 且对于 $k \\neq 7$，$x_k = 0$；$y$ 是在 $\\{0,\\dots,7\\}$ 上的对称三角序列，与 $\\{1,2,3,4,4,3,2,1\\}$ 成比例并归一化以使总和为 $1$；循环长度 $N = 8$。\n- 案例 $2\\mathrm{b}$：与案例 $2\\mathrm{a}$ 相同的 $x$ 和 $y$；循环长度 $N = 15$。\n- 案例 $3\\mathrm{a}$：$x$ 是在 $\\{0,\\dots,63\\}$ 上的几何分布，参数为 $p_X = 0.2$，即 $x_k \\propto p_X (1 - p_X)^k$，然后在 $\\{0,\\dots,63\\}$ 上重新归一化以使 $\\sum_k x_k = 1$；$y$ 是在 $\\{0,\\dots,63\\}$ 上的几何分布，参数为 $p_Y = 0.35$，并类似地重新归一化；循环长度 $N = 64$。\n- 案例 $3\\mathrm{b}$：与案例 $3\\mathrm{a}$ 相同的 $x$ 和 $y$；循环长度 $N = 127$。\n- 案例 $3\\mathrm{c}$：与案例 $3\\mathrm{a}$ 相同的 $x$ 和 $y$；循环长度 $N = 128$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如，\"[r1,r2,...,r7]\"），其中每个条目按顺序对应于案例 $1\\mathrm{a}$、$1\\mathrm{b}$、$2\\mathrm{a}$、$2\\mathrm{b}$、$3\\mathrm{a}$、$3\\mathrm{b}$ 和 $3\\mathrm{c}$ 的环绕误差。",
            "solution": "该问题陈述是计算数学和数字信号处理领域的一个有效练习，具体涉及线性和循环卷积之间的关系。它具有科学依据，是良定的、客观的，并包含了进行研究所需的所有信息。\n\n解决方案将分三部分呈现，对应于问题中要求的理论阐述，随后是为最终程序提供信息的实现细节。\n\n**1. 定义：线性和循环卷积**\n\n令 $f, g: \\mathbb{R} \\to \\mathbb{R}$ 为两个可积函数。它们的**线性卷积**，记为 $(f * g)$，是定义在 $\\mathbb{R}$ 上的一个函数，由以下积分定义：\n$$ (f * g)(z) = \\int_{-\\infty}^{\\infty} f(x) g(z-x) \\,dx $$\n在概率论的背景下，如果 $X$ 和 $Y$ 是具有概率密度函数 (PDF) $f_X$ 和 $f_Y$ 的独立随机变量，则它们的和 $Z = X+Y$ 的PDF由线性卷积 $f_Z = f_X * f_Y$ 给出。\n\n为了在计算上近似这个过程，我们在间距为 $h  0$ 的均匀网格上对函数进行采样。令 $x_k = f(kh)$ 和 $y_k = g(kh)$。假设函数具有限支撑，我们得到两个有限序列，$(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$。积分转化为求和，定义了序列的**离散线性卷积**，记为 $c^{\\mathrm{lin}} = x * y$：\n$$ c^{\\mathrm{lin}}_k = (x * y)_k = \\sum_{j=-\\infty}^{\\infty} x_j y_{k-j} $$\n鉴于当 $j \\notin \\{0, \\dots, n-1\\}$ 时 $x_j=0$，当 $j \\notin \\{0, \\dots, m-1\\}$ 时 $y_j=0$，该和可简化为 $c^{\\mathrm{lin}}_k = \\sum_{j=0}^{n-1} x_j y_{k-j}$。所得序列 $c^{\\mathrm{lin}}$ 仅在索引 $k$ 从 $0 + 0 = 0$ 到 $(n-1) + (m-1) = n+m-2$ 的范围内非零。因此，离散线性卷积产生一个长度为 $L = n+m-1$ 的序列。\n\n**离散循环卷积**是为两个相同长度的序列定义的，例如 $(a_k)_{k=0}^{N-1}$ 和 $(b_k)_{k=0}^{N-1}$。它们的循环卷积，记为 $c^{\\mathrm{circ}}_N = a \\circledast_N b$，是一个长度为 $N$ 的序列，定义为：\n$$ c^{\\mathrm{circ}}_{N,k} = (a \\circledast_N b)_k = \\sum_{j=0}^{N-1} a_j b_{(k-j) \\pmod N} $$\n其中 $(k-j) \\pmod N$ 是 $k-j$ 除以 $N$ 的余数。这个操作在数学上是在模N整数循环群 $\\mathbb{Z}_N$ 上的卷积。\n\n这等价于序列的 $N$-周期延拓的卷积。令 $\\tilde{a}$ 和 $\\tilde{b}$ 为 $N$-周期延拓，即对于所有 $k \\in \\mathbb{Z}$，有 $\\tilde{a}_k = a_{k \\pmod N}$ 和 $\\tilde{b}_k = b_{k \\pmod N}$。那么，这些周期序列的线性卷积的一个周期就产生循环卷积：\n$$ c^{\\mathrm{circ}}_{N,k} = \\sum_{j=0}^{N-1} \\tilde{a}_j \\tilde{b}_{k-j} \\quad \\text{for } k \\in \\{0, \\dots, N-1\\} $$\n离散傅里叶变换 (DFT) 自然地计算循环卷积。DFT的卷积定理指出 $\\text{DFT}(a \\circledast_N b) = \\text{DFT}(a) \\cdot \\text{DFT}(b)$，其中乘积是逐元素的。一种高效的实现使用快速傅里叶变换 (FFT) 算法：$a \\circledast_N b = \\text{IDFT}(\\text{FFT}(a) \\cdot \\text{FFT}(b))$。\n\n**2. 用于线性卷积的补零策略**\n\n为了使用循环卷积计算两个序列 $(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$ 的离散线性卷积 $c^{\\mathrm{lin}}$，我们必须防止循环操作中固有的“环绕”或“混叠”效应。线性卷积的结果 $c^{\\mathrm{lin}}$ 的长度为 $L = n+m-1$。\n\n当线性卷积的结果长于循环卷积的周期 $N$ 时，就会发生混叠。具体来说，循环卷积结果 $c^{\\mathrm{circ}}_N$ 与线性卷积 $c^{\\mathrm{lin}}$ 通过混叠公式相关联：\n$$ c^{\\mathrm{circ}}_{N,k} = \\sum_{j=-\\infty}^{\\infty} c^{\\mathrm{lin}}_{k+jN} $$\n为了使循环卷积与线性卷积完全匹配，我们需要对于所有相关索引 $k$，都有 $c^{\\mathrm{circ}}_{N,k} = c^{\\mathrm{lin}}_k$。由于 $c^{\\mathrm{lin}}_k$ 仅在 $k \\in \\{0, \\dots, L-1\\}$ 时非零，该和简化为 $c^{\\mathrm{circ}}_{N,k} = c^{\\mathrm{lin}}_k + c^{\\mathrm{lin}}_{k+N} + c^{\\mathrm{lin}}_{k+2N} + \\dots$。为了使等式成立，对于 $j \\ge 1$ 的所有项 $c^{\\mathrm{lin}}_{k+jN}$ 都必须为零。\n\n这要求 $c^{\\mathrm{lin}}$ 的支撑集，即 $[0, L-1]$，不能“环绕”长度为 $N$ 的周期。当且仅当周期 $N$ 至少与线性卷积的支撑集长度 $L$ 一样长时，才能保证这一点。\n\n策略如下：\n1.  选择一个卷积长度 $N$。\n2.  对序列 $x$ 补零以创建一个长度为 $N$ 的新序列 $x'$。\n3.  对序列 $y$ 补零以创建一个长度为 $N$ 的新序列 $y'$。\n4.  计算循环卷积 $c' = x' \\circledast_N y'$。\n\n当且仅当没有发生混叠时，结果 $c'$ 将与线性卷积 $c^{\\mathrm{lin}}$（补零至长度 $N$）相同。当且仅当长度 $N$ 大于或等于线性卷积结果的长度时，才能避免混叠。\n\n为精确恢复长度为 $n$ 和 $m$ 的序列的离散线性卷积，关于补零长度 $N$ 的充分必要条件是：\n$$ N \\ge n+m-1 $$\n\n如果满足此条件，补零序列的循环卷积的前 $L=n+m-1$ 个样本将与原始序列的离散线性卷积的样本相同。如果 $N  n+m-1$，则会发生环绕失真。\n\n**3. 环绕误差量化**\n\n令 $(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$ 为非负序列。它们的离散线性卷积是 $c^{\\mathrm{lin}}$，一个长度为 $L=n+m-1$ 的序列。我们计算 $c^{\\mathrm{circ}}_N$ 作为对 $x$ 和 $y$ 补零至长度 $N$ 后的循环卷积。长度为 $L$ 的“环绕近似” $\\hat{c}$ 是通过周期性重复 $c^{\\mathrm{circ}}_N$ 形成的：\n$$ \\hat{c}_k = c^{\\mathrm{circ}}_{N, k \\pmod N} \\quad \\text{for } k \\in \\{0, \\dots, L-1\\} $$\n环绕误差是近似与真实线性卷积之间的 $\\ell_1$ 距离：\n$$ E = ||\\hat{c} - c^{\\mathrm{lin}}||_1 = \\sum_{k=0}^{L-1} |\\hat{c}_k - c^{\\mathrm{lin}}_k| $$\n使用混叠公式，对于 $i \\in \\{0, \\dots, N-1\\}$，有 $c^{\\mathrm{circ}}_{N, i} = \\sum_{j=0}^{\\infty} c^{\\mathrm{lin}}_{i+jN}$。将此代入 $\\hat{c}_k$ 的定义中，误差表达式变为：\n$$ E = \\sum_{k=0}^{L-1} \\left| \\left( \\sum_{j=0}^{\\infty} c^{\\mathrm{lin}}_{(k \\pmod N) + jN} \\right) - c^{\\mathrm{lin}}_k \\right| $$\n由于所有序列都是非负的，所以对于所有 $k$，都有 $c^{\\mathrm{lin}}_k \\ge 0$。\n我们可以将 $E$ 的和分为两部分：索引小于 $N$ 的部分和索引从 $N$ 到 $L-1$ 的部分。\n\n对于 $k \\in \\{0, \\dots, N-1\\}$（假设 $LN$）：\n$k \\pmod N = k$。误差项为 $|\\hat{c}_k - c^{\\mathrm{lin}}_k| = |(\\sum_{j=0}^{\\infty} c^{\\mathrm{lin}}_{k+jN}) - c^{\\mathrm{lin}}_k| = |\\sum_{j=1}^{\\infty} c^{\\mathrm{lin}}_{k+jN}| = \\sum_{j=1}^{\\infty} c^{\\mathrm{lin}}_{k+jN}$，因为 $c^{\\mathrm{lin}} \\ge 0$。\n这些贡献的总和是 $\\sum_{k=0}^{N-1} \\sum_{j=1}^{\\infty} c^{\\mathrm{lin}}_{k+jN}$。这个和涵盖了 $c^{\\mathrm{lin}}$ 中所有索引大于或等于 $N$ 的元素。令 $S_{\\mathrm{tail}} = \\sum_{m=N}^{L-1} c^{\\mathrm{lin}}_m$ 为线性卷积的“尾部质量”。前 $N$ 个元素的误差贡献恰好是 $S_{\\mathrm{tail}}$。\n\n对于 $k \\in \\{N, \\dots, L-1\\}$：\n误差贡献为 $\\sum_{k=N}^{L-1} |\\hat{c}_k - c^{\\mathrm{lin}}_k|$。这些项代表用周期性重复的混叠值 $\\hat{c}_k$ 替换真实尾部值 $c^{\\mathrm{lin}}_k$ 所产生的误差。\n\n总误差是来自所有索引 $k \\in \\{0, \\dots, L-1\\}$ 的贡献之和。虽然完整表达式的封闭形式简化很复杂，但可以获得一个简单的界。被错位的总质量为 $S_{\\mathrm{tail}}$。这部分质量从尾部（索引 $k \\ge N$）移除，并加到头部（索引 $k  N$）。$\\ell_1$ 误差是所有这些变化的绝对值之和。加到头部的质量总和是 $S_{\\mathrm{tail}}$。从尾部移除的质量总和也是 $S_{\\mathrm{tail}}$。这表明总变化量为 $2S_{\\mathrm{tail}}$。一个更严谨的论证表明 $E \\le 2S_{\\mathrm{tail}}$。这提供了一个有用的界：环绕误差受线性卷积尾部超出长度为 $N$ 的循环卷积窗口的质量所控制。在下面的实现中，我们计算的是由求和定义的精确误差 $E$，而不是该界限。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.fft import fft, ifft\n\ndef solve():\n    \"\"\"\n    Computes the wrap-around error for several test cases of discrete convolution.\n    \"\"\"\n\n    test_cases = []\n\n    # Case 1a: Uniform distributions, N  L\n    x1 = np.full(10, 1/10)\n    y1 = np.full(5, 1/5)\n    test_cases.append({'x': x1, 'y': y1, 'N': 10, 'name': '1a'})\n\n    # Case 1b: Uniform distributions, N = L\n    test_cases.append({'x': x1, 'y': y1, 'N': 14, 'name': '1b'})\n\n    # Case 2a: Delta and Triangular, N  L\n    x2 = np.zeros(8)\n    x2[7] = 1.0\n    y2_unnormalized = np.array([1, 2, 3, 4, 4, 3, 2, 1])\n    y2 = y2_unnormalized / np.sum(y2_unnormalized)\n    test_cases.append({'x': x2, 'y': y2, 'N': 8, 'name': '2a'})\n\n    # Case 2b: Delta and Triangular, N = L\n    test_cases.append({'x': x2, 'y': y2, 'N': 15, 'name': '2b'})\n\n    # Case 3: Geometric distributions\n    n_geom = 64\n    p_x = 0.2\n    k = np.arange(n_geom)\n    x3_unnormalized = p_x * (1 - p_x)**k\n    x3 = x3_unnormalized / np.sum(x3_unnormalized)\n    \n    p_y = 0.35\n    y3_unnormalized = p_y * (1 - p_y)**k\n    y3 = y3_unnormalized / np.sum(y3_unnormalized)\n\n    # Case 3a: Geometric, N  L\n    test_cases.append({'x': x3, 'y': y3, 'N': 64, 'name': '3a'})\n\n    # Case 3b: Geometric, N = L\n    test_cases.append({'x': x3, 'y': y3, 'N': 127, 'name': '3b'})\n    \n    # Case 3c: Geometric, N > L\n    test_cases.append({'x': x3, 'y': y3, 'N': 128, 'name': '3c'})\n\n    results = []\n    for case in test_cases:\n        x, y, N = case['x'], case['y'], case['N']\n        n = len(x)\n        m = len(y)\n        L = n + m - 1\n\n        # 1. Compute discrete linear convolution (ground truth)\n        c_lin = np.convolve(x, y)\n\n        # 2. Compute discrete circular convolution using FFT\n        # Pad original sequences to length N for circular convolution\n        x_pad = np.zeros(N)\n        y_pad = np.zeros(N)\n        x_pad[:n] = x\n        y_pad[:m] = y\n        \n        # Use FFT to compute circular convolution\n        c_circ_N = np.real(ifft(fft(x_pad) * fft(y_pad)))\n\n        # 3. Form the wrap-around approximation of length L\n        # This is done by tiling c_circ_N periodically\n        indices = np.arange(L) % N\n        c_approx = c_circ_N[indices]\n\n        # 4. Compute the wrap-around error (L1 distance)\n        error = np.sum(np.abs(c_approx - c_lin))\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}