{
    "hands_on_practices": [
        {
            "introduction": "吉布斯采样功能强大，但并非万无一失，特定的状态空间结构可能会使其失效。这个练习  展示了一个经典的失败案例：在一个受约束的支撑集上，一个朴素的坐标式采样器会完全“卡住”。通过分析其失败的原因，您将更深刻地理解马尔可夫链不可约性（irreducibility）的重要性，并学会如何使用块采样（block sampling）这一关键方法来恢复采样器的遍历性。",
            "id": "3352921",
            "problem": "考虑一个定义在一维流形所构成的约束支撑集上的目标概率分布\n$$\n\\mathcal{S} \\equiv \\{(x_{1},x_{2}) \\in [0,1]^{2} : x_{1}+x_{2}=1\\}.\n$$\n设 $\\mathcal{S}$ 上的未归一化密度由下式给出\n$$\n\\tilde{\\pi}(x_{1},x_{2}) = x_{1}^{\\alpha_{1}-1} x_{2}^{\\alpha_{2}-1} \\mathbf{1}\\{(x_{1},x_{2}) \\in \\mathcal{S}\\},\n$$\n其中 $\\alpha_{1} > 0$ 和 $\\alpha_{2} > 0$ 是固定的形状参数。这就在线段 $\\mathcal{S}$ 上，相对于一维勒贝格测度，导出了一个正常的概率分布 $\\pi$。你需要分析在此约束下吉布斯采样方案的不可约性，并构建一个可行的替代方案。\n\n任务：\n1) 使用从联合密度导出的条件分布的定义，以及一般状态空间上马尔可夫链的不可约性定义，论证一个朴素的单坐标吉布斯采样器在 $\\mathcal{S}$ 上是否是不可约的。该采样器交替更新 $x_{1}$（给定 $x_{2}$）和 $x_{2}$（给定 $x_{1}$），每次都从精确的满条件分布中抽样。你的分析必须从第一性原理出发，不得假定超出这些定义之外的任何特例结果。\n\n2) 提出一种块吉布斯更新方法，以在 $\\mathcal{S}$ 上恢复不可约性。从不可约性的定义（以及块条件分布的支撑集）出发，论证为什么你的块吉布斯核相对于 $\\mathcal{S}$ 上的一维勒贝格测度是不可约的。\n\n3) 在你提出的有效块吉布斯方案下，平稳分布为 $\\pi$。设 $\\alpha_{1}=2$ 和 $\\alpha_{2}=3$。计算平稳期望\n$$\n\\mathbb{E}_{\\pi}\\!\\left[x_{1}^{2} x_{2}\\right].\n$$\n你的最终答案必须是单个精确数值或单个封闭形式的表达式。不需要四舍五入。",
            "solution": "本题要求分析一个在约束状态空间上的吉布斯采样方案，提出一个有效的替代方案，并计算所得平稳分布下的一个期望值。验证和求解过程如下。\n\n该问题被认为是有效的。它在科学上基于马尔可夫链蒙特卡洛方法的理论，特别是吉布斯采样。问题陈述清晰，目标分布和状态空间定义明确，各项任务都有唯一的可推导解。语言客观、正式。该问题虽然说明了在流形上使用朴素吉布斯采样的一个基本问题，但并非微不足道，需要对条件概率和马尔可夫链不可约性的定义有深入的理解。\n\n解答分为与任务相对应的三个部分。\n\n1) 对朴素单坐标吉布斯采样器的分析。\n\n吉布斯采样是一种马尔可夫链蒙特卡洛算法，用于在直接采样困难时，从一个指定的多变量概率分布中获得一个近似的观测序列。链的状态通过从每个变量（或坐标）的满条件分布中采样来更新，该条件分布是给定所有其他变量当前值的分布。\n\n目标分布 $\\pi$ 的支撑集为 $\\mathcal{S} \\equiv \\{(x_{1},x_{2}) \\in [0,1]^{2} : x_{1}+x_{2}=1\\}$。未归一化密度由 $\\tilde{\\pi}(x_{1},x_{2}) = x_{1}^{\\alpha_{1}-1} x_{2}^{\\alpha_{2}-1}$（对于 $(x_{1},x_{2}) \\in \\mathcal{S}$）给出，否则 $\\tilde{\\pi}(x_{1},x_{2})=0$。\n\n我们来分析满条件分布。给定 $x_{2}$ 时 $x_{1}$ 的满条件分布具有密度 $p(x_{1}|x_{2})$，该密度与联合密度 $\\pi(x_{1},x_{2})$ 成正比。\n$$\np(x_{1}|x_{2}) \\propto \\tilde{\\pi}(x_{1},x_{2}) = x_{1}^{\\alpha_{1}-1} x_{2}^{\\alpha_{2}-1} \\mathbf{1}\\{(x_{1},x_{2}) \\in \\mathcal{S}\\}\n$$\n指示函数 $\\mathbf{1}\\{(x_{1},x_{2}) \\in \\mathcal{S}\\}$ 至关重要。给定一个值 $x_{2} \\in [0,1]$，该指示函数仅在 $x_{1} \\in [0,1]$ 且 $x_{1}+x_{2}=1$ 时非零。这确定性地将 $x_{1}$ 的值固定为 $x_{1}=1-x_{2}$。因此，条件分布 $p(x_{1}|x_{2})$ 的支撑集是单点 $\\{1-x_{2}\\}$。该条件分布是在 $x_{1}=1-x_{2}$ 处的一个点质量（或狄拉克δ测度）。这里没有通常意义上的“采样”；其值是完全确定的。\n\n类似地，给定 $x_{1}$ 时 $x_2$ 的满条件分布 $p(x_{2}|x_{1})$ 是在 $x_{2}=1-x_{1}$ 处的一个点质量。\n\n单坐标吉布斯采样器的过程如下。从第 $t$ 次迭代的状态 $(x_{1}^{(t)}, x_{2}^{(t)}) \\in \\mathcal{S}$ 开始：\ni) 从 $p(x_{1}|x_{2}^{(t)})$ 中采样 $x_{1}^{(t+1)}$。根据推导，这意味着我们设 $x_{1}^{(t+1)} = 1 - x_{2}^{(t)}$。\nii) 从 $p(x_{2}|x_{1}^{(t+1)})$ 中采样 $x_{2}^{(t+1)}$。这意味着我们设 $x_{2}^{(t+1)} = 1 - x_{1}^{(t+1)}$。\n\n由于起始点 $(x_{1}^{(t)}, x_{2}^{(t)})$ 在支撑集 $\\mathcal{S}$ 上，我们知道 $x_{1}^{(t)}+x_{2}^{(t)}=1$，这意味着 $x_{1}^{(t)} = 1-x_{2}^{(t)}$。\n将此代入步骤 (i)，我们得到 $x_{1}^{(t+1)} = x_{1}^{(t)}$。\n然后，对于步骤 (ii)，我们有 $x_{2}^{(t+1)} = 1 - x_{1}^{(t+1)} = 1 - x_{1}^{(t)} = x_{2}^{(t)}$。\n最终得到的状态是 $(x_{1}^{(t+1)}, x_{2}^{(t+1)}) = (x_{1}^{(t)}, x_{2}^{(t)})$。马尔可夫链永远不会离开其初始状态。\n\n一个具有转移核 $K$ 的马尔可夫链，如果对于任何起始状态 $x \\in \\mathcal{S}$ 和任何满足 $\\pi(A)>0$ 的集合 $A \\subseteq \\mathcal{S}$，都存在一个整数 $n \\ge 1$ 使得 $n$ 步转移概率 $K^n(x,A) > 0$，则称该链相对于其平稳分布 $\\pi$ 是不可约的（或 $\\pi$-不可约）。\n在我们的例子中，采样器如果从点 $y \\in \\mathcal{S}$ 开始，将在所有后续迭代中停留在 $y$。设 $z \\in \\mathcal{S}$ 为任何其他点，使得 $z \\neq y$。考虑 $z$ 周围一个不包含 $y$ 的小开邻域 $A$。由于 $\\pi$ 在 $\\mathcal{S}$ 的内部具有正密度，所以 $\\pi(A)>0$。然而，链从 $y$ 到达 $A$ 的概率对于所有 $n \\ge 1$ 都是 $K^n(y, A) = 0$。\n这违反了不可约性的定义。朴素的单坐标吉布斯采样器在 $\\mathcal{S}$ 上不是不可约的。\n\n2) 采用块吉布斯更新以恢复不可约性。\n\n单坐标采样器的失败是由于约束条件所施加的 $x_{1}$ 和 $x_{2}$ 之间的完全确定性依赖关系。处理这种情况的正确方法是将相关的变量分组到一个“块”中并联合更新它们。在这里，这个块必须是 $(x_{1}, x_{2})$。\n\n对于块 $(x_{1}, x_{2})$ 的块吉布斯采样器，将通过从其联合分布（以所有其他变量为条件）中采样一个新的点对 $(x_{1}', x_{2}')$ 来更新状态。由于该模型中没有其他变量，这仅仅意味着直接从目标分布 $\\pi(x_{1}, x_{2})$ 中抽取一个新状态。这种新状态从目标分布中独立于当前状态抽取的MCMC方法，被称为独立采样器。\n\n此采样器的转移核是 $K((x_{1}',x_{2}') | (x_{1},x_{2})) = \\pi(x_{1}',x_{2}')$。\n\n为了证明不可约性，我们使用与之前相同的定义。设 $\\lambda_1$ 是线段 $\\mathcal{S}$ 上的一维勒贝格测度。目标分布 $\\pi$ 相对于 $\\lambda_1$ 有一个密度。对于 $\\alpha_{1}>0$ 和 $\\alpha_{2}>0$，这个密度在 $\\mathcal{S}$ 的内部是正的。\n设 $x = (x_1, x_2)$ 是 $\\mathcal{S}$ 中的任意起始点。设 $A$ 是 $\\mathcal{S}$ 的任意子集，其在 $\\pi$ 下的测度为正，这意味着 $\\lambda_1(A)>0$。从 $x$ 一步转移到集合 $A$ 的概率是：\n$$\nK(x, A) = \\int_{A} K(y | x) d\\lambda_1(y) = \\int_{A} \\pi(y) d\\lambda_1(y) = \\pi(A)\n$$\n由于根据我们的假设 $\\pi(A) > 0$，因此当 $n=1$ 时转移概率 $K(x, A)$ 是正的。这对任何起始点 $x \\in \\mathcal{S}$ 和任何满足 $\\pi(A)>0$ 的集合 $A$ 都成立。因此，块吉布斯采样器（在本例中是独立采样器）相对于 $\\pi$ 是不可约的。\n\n3) 期望值的计算。\n\n我们需要计算当 $\\alpha_{1}=2$ 和 $\\alpha_{2}=3$ 时的 $\\mathbb{E}_{\\pi}[x_{1}^{2} x_{2}]$。该分布位于一维流形 $\\mathcal{S}$ 上。我们可以用单个变量来参数化这个流形。设 $x_{1} = u$。由于约束条件 $x_1+x_2=1$，我们有 $x_{2}=1-u$。因为 $x_1, x_2 \\in [0,1]$，所以必须有 $u \\in [0,1]$。\n将此代入未归一化的密度，我们得到 $u$ 的一个密度：\n$$\n\\tilde{p}(u) \\propto u^{\\alpha_{1}-1} (1-u)^{\\alpha_{2}-1} \\quad \\text{for } u \\in [0,1]\n$$\n这是Beta分布的核。因此，对应于 $x_1$ 的随机变量 $u$ 服从Beta分布，即 $u \\sim \\text{Beta}(\\alpha_{1}, \\alpha_{2})$。\n使用给定的参数 $\\alpha_{1}=2$ 和 $\\alpha_{2}=3$，我们有 $u \\sim \\text{Beta}(2, 3)$。\n我们需要计算的期望是 $\\mathbb{E}_{\\pi}[x_{1}^{2} x_{2}]$，用 $u$ 表示则为 $\\mathbb{E}[u^2(1-u)]$。\n$$\n\\mathbb{E}[u^{2}(1-u)] = \\mathbb{E}[u^{2} - u^{3}] = \\mathbb{E}[u^{2}] - \\mathbb{E}[u^{3}]\n$$\n我们使用$\\text{Beta}(\\alpha,\\beta)$随机变量的 $k$ 阶原矩公式：\n$$\n\\mathbb{E}[u^{k}] = \\frac{\\Gamma(\\alpha+k)\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\alpha+\\beta+k)}\n$$\n对于 $\\alpha=2$ 和 $\\beta=3$，我们有 $\\alpha+\\beta=5$。公式简化为：\n$$\n\\mathbb{E}[u^{k}] = \\frac{\\Gamma(2+k)\\Gamma(5)}{\\Gamma(2)\\Gamma(5+k)}\n$$\n当 $k=2$ 时：\n$$\n\\mathbb{E}[u^{2}] = \\frac{\\Gamma(4)\\Gamma(5)}{\\Gamma(2)\\Gamma(7)} = \\frac{3! \\cdot 4!}{1! \\cdot 6!} = \\frac{6 \\cdot 24}{720} = \\frac{144}{720} = \\frac{1}{5}\n$$\n当 $k=3$ 时：\n$$\n\\mathbb{E}[u^{3}] = \\frac{\\Gamma(5)\\Gamma(5)}{\\Gamma(2)\\Gamma(8)} = \\frac{4! \\cdot 4!}{1! \\cdot 7!} = \\frac{24 \\cdot 24}{5040} = \\frac{576}{5040} = \\frac{4}{35}\n$$\n将两个矩相减，我们得到最终结果：\n$$\n\\mathbb{E}_{\\pi}[x_{1}^{2} x_{2}] = \\mathbb{E}[u^{2}] - \\mathbb{E}[u^{3}] = \\frac{1}{5} - \\frac{4}{35} = \\frac{7}{35} - \\frac{4}{35} = \\frac{3}{35}\n$$",
            "answer": "$$\\boxed{\\frac{3}{35}}$$"
        },
        {
            "introduction": "我们已经看到块采样在某些情况下是必要的，但如何设计好的块并量化其好处呢？在这个练习中 ，我们将探讨变量之间的高度相关性如何减慢坐标式采样器的收敛速度。您将学习如何通过巧妙的重参数化来设计一个近乎完美的高效块采样器，并利用谱隙（spectral gap）这一理论工具来精确量化其相对于标准采样器的性能提升。",
            "id": "3352929",
            "problem": "考虑一个二元目标分布，其密度正比于 $p(x,y)\\propto \\exp\\left\\{-\\tfrac{1}{2}\\left(x^2 + y^2 - 2\\rho xy\\right)\\right\\}$，其中 $\\rho\\in(-1,1)$ 且 $(x,y)\\in\\mathbb{R}^2$。这定义了一个高斯马尔可夫随机场，其精度矩阵为 $Q=\\begin{pmatrix}1  -\\rho \\\\ -\\rho  1\\end{pmatrix}$，因此具有唯一的归一化常数。从吉布斯采样器、多元正态分布和马尔可夫链谱隙的基本定义出发，完成以下任务：\n\n$1.$ 通过直接操作联合二次型，推导全条件分布 $p(x\\mid y)$ 和 $p(y\\mid x)$，而不调用预先推导的快捷公式。你可以使用关于配方法和多元正态分布性质的标准事实作为基础工具。\n\n$2.$ 引入由 $u=x+y$ 和 $v=x-y$ 定义的重参数化 $(u,v)$。利用协方差变换的线性代数性质来刻画 $(u,v)$ 的联合分布，并确定在目标分布下 $u$ 和 $v$ 是否独立。设计一个分块吉布斯采样器，在一个块中更新 $(u,v)$，并通过逆线性变换 $x=(u+v)/2$，$y=(u-v)/2$ 映射回 $(x,y)$。\n\n$3.$ 对于执行完整扫描 $(x\\to y\\to x)$ 的坐标级吉布斯采样器，将其作用于相对于平稳分布的平方可积函数上的马尔可夫转移算子形式化。使用第一性原理，确定该算子的第二大特征值模，从而得出其谱隙。将谱隙定义为 $1-\\lambda_{\\star}$，其中 $\\lambda_{\\star}$ 是算子限制在 $L^2(\\pi)$ 中零均值函数上的最大特征值模，$\\pi$ 为平稳分布。\n\n$4.$ 对于在 $(u,v)$ 中（联合更新）的重参数化分块吉布斯采样器，类似地通过分析变换后坐标中的转移算子来确定谱隙，然后将结果转换回 $(x,y)$。\n\n$5.$ 实现一个自包含的程序，对于一组给定的相关系数值 $\\rho$，为每个 $\\rho$ 计算一对浮点数：坐标级吉布斯采样器在 $(x,y)$ 中的谱隙和分块吉布斯采样器在 $(u,v)$ 中的谱隙，使用你推导出的表达式。不需要模拟；根据你的推导精确计算谱隙。\n\n测试套件：\n在以下 $\\rho$ 值集合上评估你的程序，以检验各种情况：\n- $\\rho = 0$\n- $\\rho = 0.3$\n- $\\rho = 0.9$\n- $\\rho = 0.99$\n- $\\rho = -0.9$\n- $\\rho = 0.999$\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例一个条目。每个条目必须是一个包含两个元素的列表，其中包含 $(x,y)$ 中坐标级吉布斯采样器的谱隙，后跟 $(u,v)$ 中分块吉布斯采样器的谱隙。例如，输出应类似于 $[[g_{xy,1},g_{uv,1}],[g_{xy,2},g_{uv,2}],\\dots]$，其中 $g_{xy,i}$ 和 $g_{uv,i}$ 是第 $i$ 个 $\\rho$ 值的标准十进制表示法的浮点数。",
            "solution": "该问题被评估为有效。它在科学上基于马尔可夫链蒙特卡洛方法的理论，特别是针对二元正态分布的吉布斯采样器分析。问题是适定的，提供了所有必要的定义和约束，并且没有歧义或矛盾。参数限制 $\\rho \\in (-1, 1)$ 确保精度矩阵 $Q$ 是正定的，从而定义了一个正常的概率分布。各项任务是序贯的，并导向一组独特且可验证的解析结果。\n\n### 第 1 部分：全条件分布的推导\n\n目标分布的概率密度函数 $p(x, y)$ 与给定表达式成正比。令 $\\mathbf{z} = (x, y)^T$。密度具有 $p(\\mathbf{z}) \\propto \\exp\\left(-\\frac{1}{2}\\mathbf{z}^T Q \\mathbf{z}\\right)$ 的形式，其中 $Q = \\begin{pmatrix} 1  -\\rho \\\\ -\\rho  1 \\end{pmatrix}$ 是精度矩阵。未归一化的密度为：\n$$\np(x,y) \\propto \\exp\\left\\{-\\frac{1}{2}\\left(x^2 + y^2 - 2\\rho xy\\right)\\right\\}\n$$\n要推导全条件分布 $p(x \\mid y)$，我们将 $y$ 视为常数，并将表达式看作 $x$ 的函数。任何不含 $x$ 的项都被吸收到归一化常数中。\n$$\np(x \\mid y) \\propto \\exp\\left\\{-\\frac{1}{2}\\left(x^2 - 2\\rho yx + y^2\\right)\\right\\} \\propto \\exp\\left\\{-\\frac{1}{2}\\left(x^2 - 2(\\rho y)x\\right)\\right\\}\n$$\n指数中的项是关于 $x$ 的二次型。我们对 $x$ 进行配方：\n$$\nx^2 - 2(\\rho y)x = (x - \\rho y)^2 - (\\rho y)^2 = (x - \\rho y)^2 - \\rho^2 y^2\n$$\n将其代回 $p(x \\mid y)$ 的表达式中：\n$$\np(x \\mid y) \\propto \\exp\\left\\{-\\frac{1}{2}\\left((x - \\rho y)^2 - \\rho^2 y^2\\right)\\right\\} = \\exp\\left\\{-\\frac{1}{2}(x - \\rho y)^2\\right\\} \\exp\\left\\{\\frac{1}{2}\\rho^2 y^2\\right\\}\n$$\n项 $\\exp\\left\\{\\frac{1}{2}\\rho^2 y^2\\right\\}$ 相对于 $x$ 是常数，可以被吸收到归一化常数中。我们剩下：\n$$\np(x \\mid y) \\propto \\exp\\left\\{-\\frac{(x - \\rho y)^2}{2}\\right\\}\n$$\n这是一个均值为 $\\mu = \\rho y$、方差为 $\\sigma^2 = 1$ 的正态分布的核。因此，$x$ 的全条件分布为：\n$$\nx \\mid y \\sim \\mathcal{N}(\\rho y, 1)\n$$\n根据联合分布的二次型对于 $x$ 和 $y$ 的对称性，通过交换它们的作用，可以得到给定 $x$ 时 $y$ 的全条件分布：\n$$\ny \\mid x \\sim \\mathcal{N}(\\rho x, 1)\n$$\n\n### 第 2 部分：重参数化与分块吉布斯采样器\n\n目标分布是一个零均值的二元正态分布，$\\mathbf{z} = (x, y)^T \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$，其中协方差矩阵 $\\Sigma$ 是精度矩阵 $Q$ 的逆：\n$$\n\\Sigma = Q^{-1} = \\begin{pmatrix}1  -\\rho \\\\ -\\rho  1\\end{pmatrix}^{-1} = \\frac{1}{\\det(Q)}\\begin{pmatrix}1  \\rho \\\\ \\rho  1\\end{pmatrix} = \\frac{1}{1-\\rho^2}\\begin{pmatrix}1  \\rho \\\\ \\rho  1\\end{pmatrix}\n$$\n我们通过线性变换 $\\mathbf{w} = A\\mathbf{z}$ 引入重参数化 $\\mathbf{w} = (u,v)^T$，其中 $A = \\begin{pmatrix}1  1 \\\\ 1  -1\\end{pmatrix}$。\n由于 $\\mathbf{z}$ 是多元正态的，变换后的向量 $\\mathbf{w}$ 也是多元正态的。其均值为 $E[\\mathbf{w}] = A E[\\mathbf{z}] = A\\mathbf{0} = \\mathbf{0}$。其协方差矩阵 $\\Sigma_{\\mathbf{w}}$ 由变换法则 $\\Sigma_{\\mathbf{w}} = A \\Sigma A^T$ 给出。\n$$\n\\Sigma_{\\mathbf{w}} = \\begin{pmatrix}1  1 \\\\ 1  -1\\end{pmatrix} \\left(\\frac{1}{1-\\rho^2}\\begin{pmatrix}1  \\rho \\\\ \\rho  1\\end{pmatrix}\\right) \\begin{pmatrix}1  1 \\\\ 1  -1\\end{pmatrix}^T\n$$\n$$\n\\Sigma_{\\mathbf{w}} = \\frac{1}{1-\\rho^2} \\begin{pmatrix}1+\\rho  1+\\rho \\\\ 1-\\rho  \\rho-1\\end{pmatrix} \\begin{pmatrix}1  1 \\\\ 1  -1\\end{pmatrix}\n$$\n$$\n\\Sigma_{\\mathbf{w}} = \\frac{1}{1-\\rho^2} \\begin{pmatrix}(1+\\rho)+(1+\\rho)  (1+\\rho)-(1+\\rho) \\\\ (1-\\rho)+(\\rho-1)  (1-\\rho)-(\\rho-1)\\end{pmatrix} = \\frac{1}{(1-\\rho)(1+\\rho)} \\begin{pmatrix}2(1+\\rho)  0 \\\\ 0  2(1-\\rho)\\end{pmatrix}\n$$\n$$\n\\Sigma_{\\mathbf{w}} = \\begin{pmatrix}\\frac{2}{1-\\rho}  0 \\\\ 0  \\frac{2}{1+\\rho}\\end{pmatrix}\n$$\n协方差矩阵 $\\Sigma_{\\mathbf{w}}$ 是对角的，这意味着随机变量 $u$ 和 $v$ 是不相关的。因为它们是联合高斯的，这也意味着它们是独立的。它们的边缘分布是：\n$$\nu \\sim \\mathcal{N}\\left(0, \\frac{2}{1-\\rho}\\right) \\quad \\text{和} \\quad v \\sim \\mathcal{N}\\left(0, \\frac{2}{1+\\rho}\\right)\n$$\n一个联合更新 $(u,v)$ 的分块吉布斯采样器会从它们的联合分布 $p(u,v)$ 中抽取一个新的对 $(u', v')$。由于 $u$ 和 $v$ 是独立的，这等价于从它们各自的边缘分布中独立地抽取 $u'$ 和 $v'$。实际上，这个过程是从以 $(u,v)$ 坐标表示的目标分布中进行独立采样。在抽取 $(u', v')$ 之后，采样器使用逆变换映射回原始坐标：$x' = (u'+v')/2$ 和 $y' = (u'-v')/2$。\n\n### 第 3 部分：坐标级吉布斯采样器的谱隙\n\n坐标级吉布斯采样器通过序贯更新分量来执行一次完整扫描。对于状态 $(x_k, y_k)$，下一个状态 $(x_{k+1}, y_{k+1})$ 通过以下方式生成：\n1. 从 $p(y \\mid x_k) = \\mathcal{N}(\\rho x_k, 1)$ 中抽取 $y'$。\n2. 从 $p(x \\mid y') = \\mathcal{N}(\\rho y', 1)$ 中抽取 $x_{k+1}$。\n3. 令 $y_{k+1} = y'$。\n\n所以，更新方程为：\n$y_{k+1} = \\rho x_k + \\epsilon_{y,k}$，其中 $\\epsilon_{y,k} \\sim \\mathcal{N}(0, 1)$。\n$x_{k+1} = \\rho y_{k+1} + \\epsilon_{x,k} = \\rho(\\rho x_k + \\epsilon_{y,k}) + \\epsilon_{x,k} = \\rho^2 x_k + \\rho\\epsilon_{y,k} + \\epsilon_{x,k}$，其中 $\\epsilon_{x,k} \\sim \\mathcal{N}(0, 1)$ 独立于 $\\epsilon_{y,k}$ 和过去的状态。\n\n谱隙为 $1 - \\lambda_\\star$，其中 $\\lambda_\\star$ 是马尔可夫转移算子 $K$ 的第二大特征值模。对于高斯系统，混合最慢的模式（对应于 $\\lambda_\\star$）通常是状态变量的线性函数。链的收敛速率由状态的自相关性决定。让我们计算 $x$ 分量在滞后为 1 时的自相关。在平稳状态下，$\\text{Var}(x_k) = \\text{Var}(x_{k+1}) = \\sigma_x^2 = 1/(1-\\rho^2)$。协方差为：\n$$\n\\text{Cov}(x_k, x_{k+1}) = \\text{Cov}(x_k, \\rho^2 x_k + \\rho\\epsilon_{y,k} + \\epsilon_{x,k})\n$$\n由于噪声项独立于 $x_k$，这可以简化为：\n$$\n\\text{Cov}(x_k, x_{k+1}) = \\rho^2 \\text{Cov}(x_k, x_k) = \\rho^2 \\text{Var}(x_k)\n$$\n因此，自相关为：\n$$\n\\text{Corr}(x_k, x_{k+1}) = \\frac{\\text{Cov}(x_k, x_{k+1})}{\\sqrt{\\text{Var}(x_k)\\text{Var}(x_{k+1})}} = \\frac{\\rho^2 \\text{Var}(x_k)}{\\text{Var}(x_k)} = \\rho^2\n$$\n这个自相关是完整扫描的转移算子的第二大特征值模，$\\lambda_\\star$。\n$$\n\\lambda_\\star = \\rho^2\n$$\n坐标级采样器的谱隙则为：\n$$\ng_{xy} = 1 - \\lambda_\\star = 1 - \\rho^2\n$$\n\n### 第 4 部分：分块吉布斯采样器的谱隙\n\n在 $(u,v)$ 中的分块吉布斯采样器通过从边缘分布 $u' \\sim \\mathcal{N}(0, 2/(1-\\rho))$ 和 $v' \\sim \\mathcal{N}(0, 2/(1+\\rho))$ 中独立抽样来生成新状态 $(u', v')$。生成的状态 $(x', y')$ 与前一个状态 $(x, y)$ 完全独立。\n\n令 $K_{uv}$ 为此采样器的转移算子，作用于平方可积函数 $f \\in L^2(\\pi)$，其中 $\\pi$ 是平稳分布。根据定义，$(K_{uv}f)(\\mathbf{z}) = E[f(\\mathbf{z}') \\mid \\mathbf{z}]$，其中 $\\mathbf{z}=(x,y)^T$。由于下一个状态 $\\mathbf{z}'$ 是从 $\\pi$ 中独立于 $\\mathbf{z}$ 抽取的，该期望为：\n$$\n(K_{uv}f)(\\mathbf{z}) = \\int f(\\mathbf{z}') \\pi(\\mathbf{z}') d\\mathbf{z}' = E_{\\pi}[f]\n$$\n现在，假设 $f$ 是 $K_{uv}$ 的一个特征函数，其特征值为 $\\lambda$，因此 $K_{uv}f = \\lambda f$。这意味着：\n$$\n\\lambda f(\\mathbf{z}) = E_{\\pi}[f]\n$$\n右边是一个常数，我们称之为 $C$。所以，$\\lambda f(\\mathbf{z}) = C$。\n如果 $\\lambda=1$（最大特征值），那么 $f(\\mathbf{z}) = C$，这意味着 $f$ 是一个常数函数。这对应于与平稳分布相关联的平凡特征函数。\n如果 $f$ 是任何非常数函数（例如，零均值函数子空间 $L_0^2(\\pi)$ 中的任何函数），那么 $f(\\mathbf{z})$ 不是常数。要使方程 $\\lambda f(\\mathbf{z}) = C$ 对所有 $\\mathbf{z}$ 成立，我们必须有 $\\lambda=0$（这意味着 $C=0$，这与 $f$ 的均值为零一致）。\n因此，任何对应于非常数特征函数的特征值 $\\lambda$ 都必须是 $0$。第二大特征值模是 $L_0^2(\\pi)$ 中函数的所有特征值中的最大模，即：\n$$\n\\lambda_\\star = 0\n$$\n分块采样器的谱隙为：\n$$\ng_{uv} = 1 - \\lambda_\\star = 1 - 0 = 1\n$$\n谱隙为 1 表示链在一步内完美混合，这对于独立采样器是预期的。\n\n### 第 5 部分：实现\n推导出的谱隙公式为：\n- 坐标级采样器：$g_{xy}(\\rho) = 1 - \\rho^2$\n- 分块采样器：$g_{uv}(\\rho) = 1$\n\n将实现这些公式来计算给定 $\\rho$ 值测试套件所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the spectral gaps for a coordinate-wise Gibbs sampler and a\n    blocked Gibbs sampler for a bivariate normal distribution.\n    \"\"\"\n    # Define the test cases for the correlation parameter rho from the problem statement.\n    test_cases = [\n        0.0,\n        0.3,\n        0.9,\n        0.99,\n        -0.9,\n        0.999,\n    ]\n\n    results = []\n    for rho in test_cases:\n        # The target distribution is p(x,y) proportional to\n        # exp{-0.5 * (x^2 + y^2 - 2*rho*x*y)}.\n\n        # 1. Spectral gap for the coordinate-wise Gibbs sampler in (x, y).\n        # The sampler performs a full sweep, e.g., sampling y | x then x | y.\n        # The second-largest eigenvalue modulus of the transition operator\n        # for this sampler on a bivariate normal is rho^2.\n        # The spectral gap is defined as 1 - lambda_star, where lambda_star\n        # is the second-largest eigenvalue modulus.\n        lambda_star_xy = rho**2\n        g_xy = 1.0 - lambda_star_xy\n\n        # 2. Spectral gap for the blocked Gibbs sampler in (u, v).\n        # The reparameterization u = x+y, v = x-y diagonalizes the covariance\n        # matrix, making u and v independent.\n        # A blocked sampler on (u,v) draws from their joint (and in this case,\n        # product of marginals) distribution. This is equivalent to drawing\n        # directly from the target distribution, an independent sampler.\n        # An independent sampler has no memory, so all non-trivial eigenvalues\n        # of its transition operator are 0.\n        # Thus, the second-largest eigenvalue modulus is 0.\n        lambda_star_uv = 0.0\n        g_uv = 1.0 - lambda_star_uv\n\n        results.append([g_xy, g_uv])\n\n    # Final print statement in the exact required format.\n    # e.g., [[g_xy_1, g_uv_1],[g_xy_2, g_uv_2],...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "除了块采样，折叠（collapsing）是另一种提升吉布斯采样器效率的强大策略，它是Rao-Blackwellization思想的一个实际应用。本练习  引导您在一个标准的贝叶斯线性回归模型中，通过解析地积分掉方差参数来推导一个折叠吉布斯采样器。您将通过分析比较标准采样器与折叠采样器的效率，并学习如何使用积分自相关时间（Integrated Autocorrelation Time, IACT）来量化这种降维采样带来的性能增益。",
            "id": "3352946",
            "problem": "考虑一个具有两个预测变量的线性回归模型，其中观测数据向量 $y \\in \\mathbb{R}^{n}$ 被建模为 $y \\mid \\beta, \\sigma^{2} \\sim \\mathcal{N}(X \\beta, \\sigma^{2} I_{n})$，设计矩阵 $X \\in \\mathbb{R}^{n \\times 2}$ 为满列秩。假设使用共轭的正态-逆伽马 (NIG) 先验设定\n- $\\beta \\mid \\sigma^{2} \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2} \\Lambda_{0}^{-1})$，其中先验精度矩阵 $\\Lambda_{0} \\in \\mathbb{R}^{2 \\times 2}$ 是正定的，\n- $\\sigma^{2} \\sim \\mathrm{IG}(a_{0}, b_{0})$，其中 $\\mathrm{IG}(a, b)$ 表示形状参数为 $a$、尺度参数为 $b$ 的逆伽马分布。\n\n从高斯似然和正态-逆伽马先验的共轭性基本原理出发，完成以下任务：\n\n1.  推导 $(\\beta, \\sigma^{2})$ 的标准吉布斯采样器更新：\n    -   全条件分布 $p(\\beta \\mid \\sigma^{2}, y)$。\n    -   全条件分布 $p(\\sigma^{2} \\mid \\beta, y)$。\n    然后将 $p(\\beta \\mid \\sigma^{2}, y)$ 具体化为其按坐标的条件分布 $p(\\beta_{1} \\mid \\beta_{2}, \\sigma^{2}, y)$ 和 $p(\\beta_{2} \\mid \\beta_{1}, \\sigma^{2}, y)$。\n\n2.  通过解析地对 $\\sigma^{2}$ 进行积分来推导 $\\beta$ 的塌缩吉布斯更新，以获得边际后验 $p(\\beta \\mid y)$，并明确地用 $X$、$y$、$\\mu_{0}$、$\\Lambda_{0}$、$a_{0}$ 和 $b_{0}$ 来识别其参数形式和参数。\n\n3.  考虑以下两种用于在 $\\beta$ 上生成马尔可夫链的算法：\n    -   采用系统扫描坐标更新的标准吉布斯采样：在第 $t$ 次迭代中，采样 $\\beta_{1}^{(t+1)} \\sim p(\\beta_{1} \\mid \\beta_{2}^{(t)}, \\sigma^{2\\,(t)}, y)$，然后采样 $\\beta_{2}^{(t+1)} \\sim p(\\beta_{2} \\mid \\beta_{1}^{(t+1)}, \\sigma^{2\\,(t)}, y)$，最后采样 $\\sigma^{2\\,(t+1)} \\sim p(\\sigma^{2} \\mid \\beta^{(t+1)}, y)$。\n    -   采用块更新的塌缩吉布斯采样：在第 $t$ 次迭代中，联合采样 $\\beta^{(t+1)} \\sim p(\\beta \\mid y)$（此步不采样 $\\sigma^{2}$；如果需要，可以在采样 $\\beta$ 之后再抽取 $\\sigma^{2}$，这不影响 $\\beta$ 的边际链）。\n\n    将第一个回归系数的标量时间序列的积分自相关时间 (IACT) 定义为 $\\tau = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_{k}$，其中 $\\rho_{k}$ 是平稳链 $\\{\\beta_{1}^{(t)}\\}_{t \\geq 0}$ 的滞后 $k$ 阶自相关。\n\n    令 $\\Lambda = \\Lambda_{0} + X^{\\top} X$ 并将 $p(\\beta \\mid \\sigma^{2}, y)$ 下 $\\beta$ 的两个坐标之间的相关性表示为\n    $$\\rho \\;=\\; \\frac{\\left(\\Lambda^{-1}\\right)_{12}}{\\sqrt{\\left(\\Lambda^{-1}\\right)_{11}\\,\\left(\\Lambda^{-1}\\right)_{22}}}.$$\n    仅使用条件高斯分布的基本性质和 IACT 的定义，通过推导比率\n    $$\\frac{\\tau_{\\mathrm{std}}}{\\tau_{\\mathrm{coll}}}$$\n    的闭式表达式（用 $\\rho$ 表示），解析地比较标准吉布斯链和塌缩吉布斯链对于 $\\beta_{1}$ 的 IACT。\n\n你的最终答案必须是关于 $\\rho$ 的单个闭式解析表达式。无需四舍五入。最终答案无需单位。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。这是一个关于贝叶斯计算中比较吉布斯采样算法的标准理论问题。所有必要信息均已提供，任务也已明确定义。\n\n解答过程按指定顺序处理这三个任务。\n\n**第1部分：推导标准吉布斯采样器更新**\n\n贝叶斯模型由似然和先验指定。\n似然为 $p(y \\mid \\beta, \\sigma^{2}) \\sim \\mathcal{N}(X \\beta, \\sigma^{2} I_{n})$，其中 $y \\in \\mathbb{R}^{n}$，$\\beta \\in \\mathbb{R}^{2}$，且 $X \\in \\mathbb{R}^{n \\times 2}$。其密度正比于：\n$$p(y \\mid \\beta, \\sigma^{2}) \\propto (\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^{2}} (y - X\\beta)^{\\top}(y - X\\beta)\\right)$$\n在给定 $\\sigma^2$ 的条件下，$\\beta$ 的先验为 $p(\\beta \\mid \\sigma^{2}) \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2} \\Lambda_{0}^{-1})$，其中 $\\mu_0 \\in \\mathbb{R}^{2}$，$\\Lambda_0 \\in \\mathbb{R}^{2 \\times 2}$ 是正定的。其密度正比于：\n$$p(\\beta \\mid \\sigma^{2}) \\propto (\\sigma^2)^{-2/2} \\exp\\left(-\\frac{1}{2\\sigma^{2}} (\\beta - \\mu_{0})^{\\top}\\Lambda_{0}(\\beta - \\mu_{0})\\right)$$\n$\\sigma^2$ 的先验为 $p(\\sigma^{2}) \\sim \\mathrm{IG}(a_{0}, b_{0})$，其密度正比于：\n$$p(\\sigma^{2}) \\propto (\\sigma^{2})^{-a_{0}-1} \\exp\\left(-\\frac{b_{0}}{\\sigma^{2}}\\right)$$\n\n**$\\beta$ 的全条件分布：$p(\\beta \\mid \\sigma^{2}, y)$**\n\n$\\beta$ 的全条件后验分布正比于似然与 $\\beta$ 的先验之积：\n$$p(\\beta \\mid \\sigma^{2}, y) \\propto p(y \\mid \\beta, \\sigma^{2}) p(\\beta \\mid \\sigma^{2})$$\n$$p(\\beta \\mid \\sigma^{2}, y) \\propto \\exp\\left(-\\frac{1}{2\\sigma^{2}} (y - X\\beta)^{\\top}(y - X\\beta)\\right) \\exp\\left(-\\frac{1}{2\\sigma^{2}} (\\beta - \\mu_{0})^{\\top}\\Lambda_{0}(\\beta - \\mu_{0})\\right)$$\n我们关注指数部分，忽略因子 $-1/(2\\sigma^2)$：\n$$ (y - X\\beta)^{\\top}(y - X\\beta) + (\\beta - \\mu_{0})^{\\top}\\Lambda_{0}(\\beta - \\mu_{0}) $$\n$$ = y^{\\top}y - 2\\beta^{\\top}X^{\\top}y + \\beta^{\\top}X^{\\top}X\\beta + \\beta^{\\top}\\Lambda_{0}\\beta - 2\\beta^{\\top}\\Lambda_{0}\\mu_{0} + \\mu_{0}^{\\top}\\Lambda_{0}\\mu_{0} $$\n按 $\\beta$ 的幂次对各项进行分组：\n$$ = \\beta^{\\top}(X^{\\top}X + \\Lambda_{0})\\beta - 2\\beta^{\\top}(X^{\\top}y + \\Lambda_{0}\\mu_{0}) + \\text{const} $$\n该表达式是 $\\beta$ 的一个二次型。令 $\\Lambda_{n} = \\Lambda_{0} + X^{\\top}X$。指数部分的形式为 $\\beta^{\\top}\\Lambda_n\\beta - 2\\beta^{\\top}(\\Lambda_n\\mu_n) + \\text{const}$，这是精度矩阵为 $\\Lambda_n$、均值为 $\\mu_n$ 的高斯分布的核。通过配方，我们确定后验精度矩阵为 $\\Lambda_{n}$，后验均值 $\\mu_n$ 满足 $\\Lambda_{n}\\mu_{n} = X^{\\top}y + \\Lambda_{0}\\mu_{0}$。\n因此，$\\mu_{n} = \\Lambda_{n}^{-1}(X^{\\top}y + \\Lambda_{0}\\mu_{0})$。问题陈述中定义了 $\\Lambda = \\Lambda_0 + X^{\\top}X$，所以 $\\Lambda_n=\\Lambda$。\n$\\beta$ 的全条件分布是一个多元正态分布：\n$$p(\\beta \\mid \\sigma^{2}, y) = \\mathcal{N}(\\mu_{n}, \\sigma^{2}\\Lambda^{-1})$$\n其中 $\\mu_{n} = \\Lambda^{-1}(X^{\\top}y + \\Lambda_{0}\\mu_{0})$ 且 $\\Lambda = \\Lambda_{0} + X^{\\top}X$。\n\n**$\\sigma^2$ 的全条件分布：$p(\\sigma^{2} \\mid \\beta, y)$**\n\n$\\sigma^2$ 的全条件分布正比于似然与所有涉及 $\\sigma^2$ 的先验之积：\n$$p(\\sigma^{2} \\mid \\beta, y) \\propto p(y \\mid \\beta, \\sigma^{2}) p(\\beta \\mid \\sigma^{2}) p(\\sigma^{2})$$\n$$ \\propto (\\sigma^2)^{-n/2} \\exp\\left(-\\frac{SSR}{2\\sigma^{2}}\\right) \\times (\\sigma^2)^{-2/2} \\exp\\left(-\\frac{Q_{\\beta}}{2\\sigma^{2}}\\right) \\times (\\sigma^{2})^{-a_{0}-1} \\exp\\left(-\\frac{b_{0}}{\\sigma^{2}}\\right) $$\n其中 $SSR = (y - X\\beta)^{\\top}(y - X\\beta)$ 且 $Q_{\\beta} = (\\beta - \\mu_{0})^{\\top}\\Lambda_{0}(\\beta - \\mu_{0})$。\n合并各项：\n$$ p(\\sigma^{2} \\mid \\beta, y) \\propto (\\sigma^{2})^{-(a_{0} + \\frac{n+2}{2}) - 1} \\exp\\left(-\\frac{1}{\\sigma^{2}}\\left[b_{0} + \\frac{1}{2}\\left(SSR + Q_{\\beta}\\right)\\right]\\right) $$\n这是一个逆伽马分布 $\\mathrm{IG}(a_n, b_n)$ 的核。参数为：\n$$ a_{n} = a_{0} + \\frac{n+2}{2} $$\n$$ b_{n} = b_{0} + \\frac{1}{2}\\left( (y - X\\beta)^{\\top}(y - X\\beta) + (\\beta - \\mu_{0})^{\\top}\\Lambda_{0}(\\beta - \\mu_{0}) \\right) $$\n所以，$\\sigma^{2} \\mid \\beta, y \\sim \\mathrm{IG}(a_{n}, b_{n})$。\n\n**$\\beta$ 的按坐标条件分布**\n\n我们从 $p(\\beta \\mid \\sigma^{2}, y) = \\mathcal{N}(\\mu_{n}, \\sigma^{2}\\Lambda^{-1})$ 推导 $p(\\beta_{1} \\mid \\beta_{2}, \\sigma^{2}, y)$。设该分布的精度矩阵为 $P = (\\sigma^2\\Lambda^{-1})^{-1} = \\frac{1}{\\sigma^2}\\Lambda$。\n$$ P = \\frac{1}{\\sigma^2}\\begin{pmatrix} \\Lambda_{11}  \\Lambda_{12} \\\\ \\Lambda_{21}  \\Lambda_{22} \\end{pmatrix} $$\n对于一个多元正态分布，$\\beta_1$ 给定 $\\beta_2$ 的条件分布也是正态分布。其均值为 $E[\\beta_1|\\beta_2] = \\mu_{n1} - P_{11}^{-1}P_{12}(\\beta_2 - \\mu_{n2})$，方差为 $\\mathrm{Var}(\\beta_1|\\beta_2) = P_{11}^{-1}$。\n代入 $P$ 的分量：\n$$ E[\\beta_1 \\mid \\beta_2, \\sigma^2, y] = \\mu_{n1} - \\left(\\frac{\\Lambda_{11}}{\\sigma^2}\\right)^{-1}\\left(\\frac{\\Lambda_{12}}{\\sigma^2}\\right)(\\beta_2 - \\mu_{n2}) = \\mu_{n1} - \\frac{\\Lambda_{12}}{\\Lambda_{11}}(\\beta_2 - \\mu_{n2}) $$\n$$ \\mathrm{Var}(\\beta_1 \\mid \\beta_2, \\sigma^2, y) = \\left(\\frac{\\Lambda_{11}}{\\sigma^2}\\right)^{-1} = \\frac{\\sigma^2}{\\Lambda_{11}} $$\n所以，$\\beta_1 \\mid \\beta_2, \\sigma^{2}, y \\sim \\mathcal{N} \\left( \\mu_{n1} - \\frac{\\Lambda_{12}}{\\Lambda_{11}}(\\beta_2 - \\mu_{n2}), \\frac{\\sigma^2}{\\Lambda_{11}} \\right)$。\n通过对称性，$\\beta_2$ 给定 $\\beta_1$ 的条件分布为：\n$\\beta_2 \\mid \\beta_1, \\sigma^{2}, y \\sim \\mathcal{N} \\left( \\mu_{n2} - \\frac{\\Lambda_{21}}{\\Lambda_{22}}(\\beta_1 - \\mu_{n1}), \\frac{\\sigma^2}{\\Lambda_{22}} \\right)$。\n\n**第2部分：推导塌缩吉布斯更新**\n\n为了求边际后验 $p(\\beta \\mid y)$，我们将联合后验 $p(\\beta, \\sigma^{2} \\mid y)$ 对 $\\sigma^2$ 进行积分：\n$$ p(\\beta \\mid y) = \\int_{0}^{\\infty} p(\\beta, \\sigma^{2} \\mid y) \\,d\\sigma^{2} \\propto \\int_{0}^{\\infty} p(y \\mid \\beta, \\sigma^2) p(\\beta \\mid \\sigma^2) p(\\sigma^2) \\,d\\sigma^2$$\n从 $p(\\sigma^2 \\mid \\beta, y)$ 的推导中，我们有：\n$$ p(\\beta, \\sigma^{2} \\mid y) \\propto (\\sigma^{2})^{-(a_{0} + \\frac{n+2}{2}) - 1} \\exp\\left(-\\frac{b_n(\\beta)}{\\sigma^{2}}\\right) $$\n其中 $b_n(\\beta) = b_{0} + \\frac{1}{2}\\left( (y - X\\beta)^{\\top}(y - X\\beta) + (\\beta - \\mu_{0})^{\\top}\\Lambda_{0}(\\beta - \\mu_{0}) \\right)$。\n对 $\\sigma^2$ 的积分是逆伽马分布的核，其计算结果为 $\\Gamma(a_n)/b_n(\\beta)^{a_n}$。\n$$ p(\\beta \\mid y) \\propto [b_n(\\beta)]^{-(a_0+\\frac{n+2}{2})} $$\n通过像第1部分那样在 $b_n(\\beta)$ 内部对 $\\beta$ 配方，我们得到：\n$$ b_n(\\beta) = \\text{const} + \\frac{1}{2}(\\beta - \\mu_n)^\\top \\Lambda (\\beta - \\mu_n) $$\n这使得 $p(\\beta \\mid y)$ 具有多元t分布的形式。具体来说，$p(\\beta \\mid y)$ 是一个二维多元t分布，其参数为：\n-   自由度：$\\nu = 2a_0 + n$。\n-   位置向量：$\\mu_n = (\\Lambda_0 + X^\\top X)^{-1}(X^\\top y + \\Lambda_0 \\mu_0)$。\n-   尺度矩阵：$S = \\frac{2b_{post}}{2a_0+n} (\\Lambda_0 + X^\\top X)^{-1}$，其中 $b_{post} = b_0 + \\frac{1}{2}(y^\\top y + \\mu_0^\\top \\Lambda_0 \\mu_0 - \\mu_n^\\top(\\Lambda_0+X^\\top X)\\mu_n)$。\n\n**第3部分：积分自相关时间 (IACT) 的比较**\n\n**塌缩吉布斯采样器的IACT ($\\tau_{\\mathrm{coll}}$)**\n\n塌缩吉布斯算法直接从其边际后验分布 $p(\\beta \\mid y)$ 中采样 $\\beta^{(t+1)}$。这会产生一个独立同分布 (i.i.d.) 的向量序列 $\\{\\beta^{(t)}\\}_{t \\geq 0}$。因此，标量分量序列 $\\{\\beta_{1}^{(t)}\\}_{t \\geq 0}$ 也是独立同分布的。对于一个独立同分布序列，对所有 $k \\ge 1$，滞后k阶自相关 $\\rho_k$ 均为 $0$。因此，IACT 为：\n$$ \\tau_{\\mathrm{coll}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_{k} = 1 + 2 \\sum_{k=1}^{\\infty} 0 = 1 $$\n\n**标准吉布斯采样器的IACT ($\\tau_{\\mathrm{std}}$)**\n\n标准吉布斯采样器生成的马尔可夫链 $\\{\\beta_1^{(t)}\\}_{t \\geq 0}$ 不是独立同分布的。为了找到其 IACT，我们分析其自相关结构。该过程是 AR(1) 过程，我们通过计算条件期望 $E[\\beta_1^{(t+1)} \\mid \\beta_1^{(t)}]$ 来证明。令 $\\beta_i' = \\beta_i - \\mu_{ni}$ 为中心化变量，注意到 $E_{p(\\beta|y)}[\\beta_i] = \\mu_{ni}$。\n一步转移涉及在给定 $(\\beta_2^{(t)}, \\sigma^{2(t)})$ 的条件下采样 $\\beta_1^{(t+1)}$。条件均值为：\n$$ E[\\beta_1^{(t+1)} \\mid \\beta_2^{(t)}, \\sigma^{2(t)}, y] = \\mu_{n1} - \\frac{\\Lambda_{12}}{\\Lambda_{11}}(\\beta_2^{(t)} - \\mu_{n2}) $$\n用中心化变量表示：\n$$ E[\\beta_1'^{(t+1)} \\mid \\beta_2'^{(t)}, \\sigma^{2(t)}] = -\\frac{\\Lambda_{12}}{\\Lambda_{11}}\\beta_2'^{(t)} $$\n在第1部分推导出的一个关键性质是，该条件均值与 $\\sigma^2$ 无关。精度矩阵 $\\Lambda$ 与其逆矩阵 $\\Lambda^{-1}$ 之间的关系是 $\\Lambda^{-1} = (\\det \\Lambda)^{-1} \\begin{pmatrix} \\Lambda_{22}  -\\Lambda_{12} \\\\ -\\Lambda_{21}  \\Lambda_{11} \\end{pmatrix}$。这意味着 $-\\frac{\\Lambda_{12}}{\\Lambda_{11}} = \\frac{(\\Lambda^{-1})_{12}}{(\\Lambda^{-1})_{22}}$。\n问题中定义的相关性 $\\rho$ 是 $\\beta_1, \\beta_2$ 在条件高斯后验 $p(\\beta|\\sigma^2,y)$ 下的相关性：\n$$ \\rho = \\frac{(\\Lambda^{-1})_{12}}{\\sqrt{(\\Lambda^{-1})_{11}(\\Lambda^{-1})_{22}}} $$\n现在，我们求 $\\beta_1'^{(t+1)}$ 对 $\\beta_1'^{(t)}$ 的回归：\n$$ E[\\beta_1'^{(t+1)} \\mid \\beta_1'^{(t)}] = E\\left[ E[\\beta_1'^{(t+1)} \\mid \\beta_2'^{(t)}, \\sigma^{2(t)}] \\mid \\beta_1'^{(t)} \\right] $$\n$$ = E\\left[ -\\frac{\\Lambda_{12}}{\\Lambda_{11}}\\beta_2'^{(t)} \\mid \\beta_1'^{(t)} \\right] = -\\frac{\\Lambda_{12}}{\\Lambda_{11}} E[\\beta_2'^{(t)} \\mid \\beta_1'^{(t)}] $$\n条件期望 $E[\\beta_2' \\mid \\beta_1']$ 是关于边际平稳分布 $p(\\beta \\mid y)$ 求得的，该分布是一个多元t分布。对于此类分布，条件期望是线性的：$E[\\beta_2' \\mid \\beta_1'] = \\frac{\\mathrm{Cov}(\\beta_1, \\beta_2)}{\\mathrm{Var}(\\beta_1)} \\beta_1'$。在 $p(\\beta \\mid y)$ 下，$\\beta$ 的协方差矩阵正比于 $\\Lambda^{-1}$，所以 $\\mathrm{Cov}(\\beta|y) = C \\Lambda^{-1}$ 对于某个常数 $C>0$ 成立。\n$$ E[\\beta_2' \\mid \\beta_1'] = \\frac{C(\\Lambda^{-1})_{21}}{C(\\Lambda^{-1})_{11}}\\beta_1' = \\frac{(\\Lambda^{-1})_{12}}{(\\Lambda^{-1})_{11}}\\beta_1' $$\n将此代回：\n$$ E[\\beta_1'^{(t+1)} \\mid \\beta_1'^{(t)}] = \\left(-\\frac{\\Lambda_{12}}{\\Lambda_{11}}\\right) \\left(\\frac{(\\Lambda^{-1})_{12}}{(\\Lambda^{-1})_{11}}\\right) \\beta_1'^{(t)} $$\n使用矩阵求逆恒等式 $\\frac{(\\Lambda^{-1})_{12}}{(\\Lambda^{-1})_{11}} = -\\frac{\\Lambda_{12}}{\\Lambda_{22}}$：\n$$ E[\\beta_1'^{(t+1)} \\mid \\beta_1'^{(t)}] = \\left(-\\frac{\\Lambda_{12}}{\\Lambda_{11}}\\right) \\left(-\\frac{\\Lambda_{12}}{\\Lambda_{22}}\\right) \\beta_1'^{(t)} = \\frac{\\Lambda_{12}^2}{\\Lambda_{11}\\Lambda_{22}} \\beta_1'^{(t)} $$\n我们还有 $\\rho^2 = \\left(\\frac{-\\Lambda_{12}}{\\sqrt{\\Lambda_{11}\\Lambda_{22}}}\\right)^2 = \\frac{\\Lambda_{12}^2}{\\Lambda_{11}\\Lambda_{22}}$。\n因此，$E[\\beta_1'^{(t+1)} \\mid \\beta_1'^{(t)}] = \\rho^2 \\beta_1'^{(t)}$。这表明序列 $\\{\\beta_1^{(t)}\\}$ 是一个自相关系数为 $\\rho^2$ 的 AR(1) 过程。滞后 $k$ 阶自相关为 $\\rho_{k, \\mathrm{std}} = (\\rho^2)^k$。\n标准吉布斯采样器的 IACT 则是几何级数的和：\n$$ \\tau_{\\mathrm{std}} = 1 + 2 \\sum_{k=1}^{\\infty} (\\rho^2)^k = 1 + 2 \\frac{\\rho^2}{1-\\rho^2} = \\frac{1-\\rho^2+2\\rho^2}{1-\\rho^2} = \\frac{1+\\rho^2}{1-\\rho^2} $$\n\n**IACT 的比率**\nIACT 的比率为：\n$$ \\frac{\\tau_{\\mathrm{std}}}{\\tau_{\\mathrm{coll}}} = \\frac{\\frac{1+\\rho^2}{1-\\rho^2}}{1} = \\frac{1+\\rho^2}{1-\\rho^2} $$\n这一结果表明，标准吉布斯采样器的效率低于（即具有更高的IACT）塌缩吉布斯采样器，并且其低效率程度随着条件后验相关性 $|\\rho|$ 的绝对值趋近于1而增加。",
            "answer": "$$\\boxed{\\frac{1+\\rho^2}{1-\\rho^2}}$$"
        }
    ]
}