{
    "hands_on_practices": [
        {
            "introduction": "吉布斯采样器的效率是MCMC方法中的一个核心问题。本练习旨在通过一个基础但极具启发性的二维高斯模型，来建立采样器性能的分析基础。通过推导采样序列的自相关函数，您将亲手揭示目标分布中的变量相关性（由 $\\rho$ 表示）是如何直接影响马尔可夫链的混合速度的，这是诊断MCMC收敛性的关键一步。",
            "id": "3358507",
            "problem": "考虑一个以中心化的二元正态分布为目标分布的双变量吉布斯采样器。设 $(X,Y) \\sim \\mathcal{N}(\\boldsymbol{0}, \\Sigma)$，其协方差矩阵为\n$$\n\\Sigma \\;=\\; \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix},\n$$\n其中 $|\\rho| < 1$。吉布斯采样器在每次迭代 $t$ 中执行一次确定性扫描：首先从给定当前 $Y$ 的 $X$ 的条件分布中抽取 $X$，然后从给定新更新的 $X$ 的 $Y$ 的条件分布中抽取 $Y$。设 $x_t$ 表示在第 $t$ 次迭代中完成完整的双变量吉布斯扫描后 $X$ 的值，因此序列 $\\{x_t\\}_{t \\geq 0}$ 构成一个嵌入在完整吉布斯链中的单变量马尔可夫链。\n\n仅使用多元正态分布的基本性质（特别是条件分布的形式）和马尔可夫链蒙特卡洛（MCMC）的基本定义，推导在平稳状态下 $\\{x_t\\}$ 在滞后 $k$ 时的自相关函数（ACF）。将 ACF（记为 $\\mathrm{acf}(k) = \\mathrm{Corr}(x_t, x_{t+k})$）表示为关于 $\\rho$ 和 $k$ 的闭式解析表达式。你的最终答案必须是单个解析表达式。不需要数值近似。",
            "solution": "用户要求推导由一个以中心化二元正态分布为目标分布的双变量吉布斯采样器所生成的一个分量的序列的自相关函数。\n\n该问题具有科学依据、是良定的、客观的，并包含得出唯一解所需的所有信息。这是马尔可夫链蒙特卡洛方法理论中的一个标准问题。因此，该问题是有效的，我们可以进行求解。\n\n目标分布是随机向量 $(X, Y)$ 的二元正态分布，由 $(X,Y) \\sim \\mathcal{N}(\\boldsymbol{0}, \\Sigma)$ 给出，其中均值向量为 $\\boldsymbol{\\mu} = \\boldsymbol{0}$，协方差矩阵为\n$$\n\\Sigma = \\begin{pmatrix} \\sigma_X^2 & \\rho \\sigma_X \\sigma_Y \\\\ \\rho \\sigma_X \\sigma_Y & \\sigma_Y^2 \\end{pmatrix} = \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}\n$$\n这意味着边缘分布是标准正态分布，$X \\sim \\mathcal{N}(0,1)$ 和 $Y \\sim \\mathcal{N}(0,1)$，且 $\\sigma_X^2 = \\sigma_Y^2 = 1$。参数 $\\rho$ 是 $X$ 和 $Y$ 之间的相关系数，约束条件 $|\\rho| < 1$ 确保协方差矩阵是正定的。\n\n主要步骤是确定吉布斯采样器所需的条件分布。对于上述指定的一般二元正态分布，给定 $Y=y$ 时 $X$ 的条件分布也是正态分布：\n$$\nX | Y=y \\sim \\mathcal{N}\\left(\\mu_X + \\frac{\\rho \\sigma_X}{\\sigma_Y}(y - \\mu_Y), \\sigma_X^2(1-\\rho^2)\\right)\n$$\n在我们的特定情况下，由于 $\\mu_X = \\mu_Y = 0$ 和 $\\sigma_X = \\sigma_Y = 1$，条件分布大大简化。\n给定 $Y=y$ 时 $X$ 的条件分布为：\n$$\np(x|y) \\sim \\mathcal{N}(\\rho y, 1-\\rho^2)\n$$\n根据对称性，给定 $X=x$ 时 $Y$ 的条件分布为：\n$$\np(y|x) \\sim \\mathcal{N}(\\rho x, 1-\\rho^2)\n$$\n\n吉布斯采样算法迭代进行。设 $(X_t, Y_t)$ 是第 $t$ 次迭代后链的状态。问题陈述定义了一个确定性扫描，其中为从状态 $t$ 转换到 $t+1$，我们首先更新 $X$，然后更新 $Y$。设第 $t+1$ 次迭代开始时的状态为 $(X_t, Y_t)$。更新步骤如下：\n$1$. 从给定 $Y_t$ 的 $X$ 的条件分布中抽取一个中间值 $X'_{t+1}$：$X'_{t+1} \\sim p(X | Y=Y_t)$。\n$2$. 从给定这个新值 $X'_{t+1}$ 的 $Y$ 的条件分布中抽取新值 $Y_{t+1}$：$Y_{t+1} \\sim p(Y | X=X'_{t+1})$。\n完整扫描后的状态是 $(X'_{t+1}, Y_{t+1})$。问题指定我们感兴趣的序列是 $\\{x_t\\}_{t \\geq 0}$，其中 $x_t$ 是第 $t$ 次迭代扫描后 $X$ 分量的值。采用此记法，我们设 $X_t = X'_t$。因此，从第 $t$ 次迭代到第 $t+1$ 次迭代的转移涉及到状态序列 $(X_t, Y_t) \\rightarrow (X_{t+1}, Y_{t+1})$，其生成过程如下：\n$$\nX_{t+1} \\sim p(X | Y=Y_t)\n$$\n$$\nY_{t+1} \\sim p(Y | X=X_{t+1})\n$$\n我们寻求平稳序列 $\\{X_t\\}$ 的自相关函数 $\\mathrm{acf}(k) = \\mathrm{Corr}(X_t, X_{t+k})$。在平稳状态下，分布的矩不随时间变化。特别地，从目标分布我们可知，对于所有 $t$，有 $E[X_t] = 0$ 和 $\\mathrm{Var}(X_t) = E[X_t^2] = 1$。\n\n滞后 $k$ 的自相关定义为：\n$$\n\\mathrm{acf}(k) = \\mathrm{Corr}(X_t, X_{t+k}) = \\frac{\\mathrm{Cov}(X_t, X_{t+k})}{\\sqrt{\\mathrm{Var}(X_t) \\mathrm{Var}(X_{t+k})}}\n$$\n由于在平稳状态下 $\\mathrm{Var}(X_t) = \\mathrm{Var}(X_{t+k}) = 1$，自相关等于自协方差：\n$$\n\\mathrm{acf}(k) = \\mathrm{Cov}(X_t, X_{t+k}) = E[X_t X_{t+k}] - E[X_t]E[X_{t+k}] = E[X_t X_{t+k}]\n$$\n为了求 $E[X_t X_{t+k}]$，我们可以使用重复期望定律。首先，我们建立 $X_{t+1}$ 和 $X_t$ 之间的关系。更新过程可以由基于条件分布的生成模型来描述：\n$$\nX_{t+1} = \\rho Y_t + \\varepsilon_{t+1}, \\quad \\text{其中 } \\varepsilon_{t+1} \\sim \\mathcal{N}(0, 1-\\rho^2)\n$$\n从前一步（或从 $(X_t, Y_t)$ 的平稳分布），我们知道 $Y_t$ 和 $X_t$ 通过以下方式相关：\n$$\nY_t = \\rho X_t + \\delta_t, \\quad \\text{其中 } \\delta_t \\sim \\mathcal{N}(0, 1-\\rho^2)\n$$\n噪声项 $\\delta_t$ 独立于 $X_t$，而 $\\varepsilon_{t+1}$ 独立于 $Y_t$（因此也独立于 $X_t$ 和 $\\delta_t$）。\n将 $Y_t$ 的表达式代入 $X_{t+1}$ 的表达式，我们得到：\n$$\nX_{t+1} = \\rho(\\rho X_t + \\delta_t) + \\varepsilon_{t+1} = \\rho^2 X_t + \\rho \\delta_t + \\varepsilon_{t+1}\n$$\n这表明序列 $\\{X_t\\}$ 服从一阶自回归过程，即 AR(1)。我们利用这个结构来求条件期望 $E[X_{t+1} | X_t]$。\n$$\nE[X_{t+1} | X_t=x_t] = E[\\rho^2 x_t + \\rho \\delta_t + \\varepsilon_{t+1} | X_t=x_t] = \\rho^2 x_t + \\rho E[\\delta_t] + E[\\varepsilon_{t+1}] = \\rho^2 x_t\n$$\n所以，$E[X_{t+1} | X_t] = \\rho^2 X_t$。\n现在，我们可以求滞后 $k=1$ 的自协方差：\n$$\nE[X_t X_{t+1}] = E[E[X_t X_{t+1} | X_t]] = E[X_t E[X_{t+1} | X_t]] = E[X_t (\\rho^2 X_t)] = \\rho^2 E[X_t^2] = \\rho^2 \\mathrm{Var}(X_t) = \\rho^2\n$$\n因此，$\\mathrm{acf}(1) = \\rho^2$。\n\n为了求任意滞后 $k$ 的 ACF，我们通过一次一步地迭代条件期望来求条件期望 $E[X_{t+k} | X_t]$：\n$$\nE[X_{t+k} | X_t] = E[E[X_{t+k} | X_{t+k-1}] | X_t] = E[\\rho^2 X_{t+k-1} | X_t] = \\rho^2 E[X_{t+k-1} | X_t]\n$$\n这给出了一个递归关系。展开这个递归，我们得到：\n$$\nE[X_{t+k} | X_t] = \\rho^2 E[X_{t+k-1} | X_t] = (\\rho^2)^2 E[X_{t+k-2} | X_t] = \\dots = (\\rho^2)^k E[X_t | X_t] = (\\rho^2)^k X_t\n$$\n现在我们可以计算滞后 $k$ 的自协方差：\n$$\n\\mathrm{Cov}(X_t, X_{t+k}) = E[X_t X_{t+k}] = E[E[X_t X_{t+k} | X_t]] = E[X_t E[X_{t+k} | X_t]]\n$$\n代入条件期望的结果：\n$$\n\\mathrm{Cov}(X_t, X_{t+k}) = E[X_t ((\\rho^2)^k X_t)] = (\\rho^2)^k E[X_t^2] = (\\rho^2)^k \\mathrm{Var}(X_t) = (\\rho^2)^k \\cdot 1 = \\rho^{2k}\n$$\n由于在这种情况下自相关等于自协方差，我们得到了最终结果。嵌入的马尔可夫链 $\\{x_t\\}$ 在滞后 $k$ 时的自相关函数是：\n$$\n\\mathrm{acf}(k) = \\rho^{2k}\n$$\n这个结果表明样本之间的相关性呈几何级数衰减。衰减率由 $\\rho^2$ 决定。当 $\\rho$ 的值接近 $\\pm 1$ 时，意味着目标分布中存在高相关性，这会导致缓慢的衰减（$\\rho^2$ 接近 $1$），从而导致吉布斯采样器对于 $X$ 分量的混合速度变慢。相反，当 $\\rho$ 接近 $0$ 时，变量近乎独立，吉布斯采样器生成的样本也近乎独立（$\\rho^2$ 接近 $0$）。",
            "answer": "$$\n\\boxed{\\rho^{2k}}\n$$"
        },
        {
            "introduction": "在掌握了基础理论之后，我们将转向一个在贝叶斯统计中普遍存在的实际挑战：混合模型中的“标签切换”（label switching）问题。此问题源于后验分布的非可识别性，它会导致多模态并严重阻碍标准吉布斯采样器的混合。本练习将引导您分析这种现象的根本原因，并批判性地评估各种应对策略，从而培养您在复杂模型中诊断和解决MCMC病态行为的能力。",
            "id": "3358492",
            "problem": "考虑一个用于观测数据 $x_1,\\dots,x_n$ 的贝叶斯有限混合模型，该模型包含 $2$ 个正态分量，其中每个 $x_i \\in \\mathbb{R}$。其抽样模型为\n$$\nx_i \\mid z_i,\\mu_1,\\mu_2,\\sigma^2 \\sim \\mathcal{N}\\big(\\mu_{z_i},\\sigma^2\\big), \\quad z_i \\in \\{1,2\\},\n$$\n其中 $z_1,\\dots,z_n$ 为潜变量分配，$\\sigma^2>0$ 为已知方差，$\\mu_1,\\mu_2 \\in \\mathbb{R}$ 为分量均值。混合权重 $\\pi \\in (0,1)$ 满足\n$$\n\\mathbb{P}(z_i=1\\mid \\pi) = \\pi,\\quad \\mathbb{P}(z_i=2\\mid \\pi) = 1-\\pi,\n$$\n且先验是对称的：\n$$\n\\pi \\sim \\text{Beta}(\\alpha,\\alpha),\\quad \\mu_1 \\stackrel{\\text{ind}}{\\sim} \\mathcal{N}(0,\\tau^2),\\quad \\mu_2 \\stackrel{\\text{ind}}{\\sim} \\mathcal{N}(0,\\tau^2),\n$$\n其中 $\\alpha>0$ 和 $\\tau^2>0$ 是固定的超参数。一个数据增广吉布斯采样器循环更新：给定 $(\\pi,\\mu_1,\\mu_2)$ 和 $x_{1:n}$ 更新 $(z_1,\\dots,z_n)$，然后给定 $(z_{1:n},x_{1:n})$ 更新 $(\\mu_1,\\mu_2)$，再给定 $z_{1:n}$ 更新 $\\pi$，并重复此过程。假设观测数据显示出两个分离良好的经验簇，即对于某个 $a>0$，在 $-a$ 和 $+a$ 附近的两个不同位置参数下的似然远大于单簇解释的似然，且先验如上所述。\n\n根据贝叶斯定理和吉布斯采样（从全条件分布中抽样以保持目标后验不变）的基本定义，分析在给定对称性条件下该吉布斯采样器的后验结构和混合行为。选择所有正确的陈述。\n\nA. 因为先验在 $(\\mu_1,\\mu_2)$ 上是可交换的，并且似然仅通过对 $(\\{\\mu_1,\\mu_2\\},\\{z_i\\})$ 依赖于标签，所以联合后验在重新标记映射 $(\\mu_1,\\mu_2,\\pi,z_{1:n}) \\mapsto (\\mu_2,\\mu_1,1-\\pi,\\tilde z_{1:n})$（其中 $\\tilde z_i = 3-z_i$）下是不变的，并且对于分离良好的簇，$(\\mu_1,\\mu_2)$ 的边际后验是双峰的，具有两个由标签切换相关的对称众数。\n\nB. 在大 $n$ 和分离良好的簇的情况下，单点数据增广吉布斯采样器在两个标签之间快速混合，因为每次扫描都会更新所有 $z_i$，因此可以有效地以大于0的概率将分配向量翻转到相反的标签。\n\nC. 通过拒绝任何违反 $\\mu_1 \\le \\mu_2$ 可识别性约束的提议更新来强制执行该约束，既消除了标签切换导致的多峰性，又保持了 $(\\mu_1,\\mu_2,\\pi,z_{1:n})$ 上的无约束后验不变。\n\nD. 一种回火转移或并行回火方案，引入逆温度参数 $\\beta \\in (0,1]$ 以在 $\\beta<1$ 时使似然函数扁平化，同时保持温度内部和温度之间转换的细致平衡，可以显著增加在 $\\beta=1$ 的基础链中标签切换的频率，而不改变其不变分布。\n\nE. 通过交换分量标签对保存的抽样进行后验重新标记以强制执行 $\\mu_1 \\le \\mu_2$ 的顺序，可以为任何满足 $f(\\mu_1,\\mu_2)=f(\\mu_2,\\mu_1)$ 的可交换函数 $f(\\mu_1,\\mu_2)$ 的期望提供有效估计，但这种后处理不会改变底层马尔可夫链的混合性质。\n\nF. 通过解析地边缘化掉 $(\\pi,\\mu_1,\\mu_2)$ 以获得一个关于 $z_{1:n}$ 的吉布斯采样器，可以消除标签切换对称性，并在给定的对称先验下产生一个关于 $z_{1:n}$ 的单峰后验。\n\n选择所有适用项。",
            "solution": "下面对问题陈述和所给选项进行分析。\n\n### 问题陈述的验证\n\n**步骤1：提取已知条件**\n-   **模型：** 包含 $k=2$ 个正态分量的贝叶斯有限混合模型。\n-   **数据：** $x_1, \\dots, x_n$，其中 $x_i \\in \\mathbb{R}$。\n-   **抽样模型（似然）：** $x_i \\mid z_i, \\mu_1, \\mu_2, \\sigma^2 \\sim \\mathcal{N}(\\mu_{z_i}, \\sigma^2)$，其中 $z_i \\in \\{1, 2\\}$ 是一个潜分配变量。\n-   **已知参数：** 方差 $\\sigma^2 > 0$ 是已知的。\n-   **混合权重：** $\\mathbb{P}(z_i = 1 \\mid \\pi) = \\pi$ 且 $\\mathbb{P}(z_i = 2 \\mid \\pi) = 1 - \\pi$，对于 $\\pi \\in (0, 1)$。\n-   **先验：**\n    -   $\\pi \\sim \\text{Beta}(\\alpha, \\alpha)$，对于固定的 $\\alpha > 0$。\n    -   $\\mu_1 \\stackrel{\\text{ind}}{\\sim} \\mathcal{N}(0, \\tau^2)$，对于固定的 $\\tau^2 > 0$。\n    -   $\\mu_2 \\stackrel{\\text{ind}}{\\sim} \\mathcal{N}(0, \\tau^2)$。\n    -   $\\pi, \\mu_1, \\mu_2$ 上的先验是相互独立的。\n-   **算法：** 一个数据增广吉布斯采样器，循环更新：\n    1.  给定 $(\\pi, \\mu_1, \\mu_2)$ 和数据，更新 $(z_1, \\dots, z_n)$。\n    2.  给定 $(z_1, \\dots, z_n)$ 和数据，更新 $(\\mu_1, \\mu_2)$。\n    3.  给定 $(z_1, \\dots, z_n)$，更新 $\\pi$。\n-   **假设：** 数据 $x_{1:n}$ 表现出两个分离良好的经验簇。\n-   **任务：** 分析吉布斯采样器的后验结构和混合行为。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学上合理：** 该问题描述了一个标准的贝叶斯高斯混合模型。所指定的先验（正态、贝塔）和数据增广吉布斯采样策略是贝叶斯统计和机器学习中的基础且广泛使用的。没有违反科学或数学原理。\n-   **适定的：** 该问题是适定的。模型使用正常的先验进行了完全指定，确保了正常的后验分布。任务是分析此标准模型和采样器的已知属性和行为，这是一个有意义且可解的统计理论问题。\n-   **客观性：** 该问题以贝叶斯统计中精确、客观和标准的术语陈述。“分离良好的簇”的假设是研究混合模型行为时一个常见且清晰的理论条件。\n\n**步骤3：结论和行动**\n问题陈述是有效的。它在科学上是合理的、适定的和客观的。没有歧义、矛盾或谬误。我现在将继续进行解答。\n\n### 推导与选项分析\n\n这个问题的核心是“标签切换”现象，它源于混合模型分量的不可识别性。如果其他参数也相应地进行排列，那么模型的似然对于分量标签的排列是不变的。\n\n令 $\\theta = (\\pi, \\mu_1, \\mu_2)$ 为边际似然（在对 $z_{1:n}$ 积分后）的参数向量。单个观测值的似然为 $p(x_i | \\theta) = \\pi \\mathcal{N}(x_i | \\mu_1, \\sigma^2) + (1-\\pi) \\mathcal{N}(x_i | \\mu_2, \\sigma^2)$。\n如果我们定义一个排列后的参数向量 $\\theta' = (1-\\pi, \\mu_2, \\mu_1)$，似然保持不变：\n$p(x_i | \\theta') = (1-\\pi) \\mathcal{N}(x_i | \\mu_2, \\sigma^2) + \\pi \\mathcal{N}(x_i | \\mu_1, \\sigma^2) = p(x_i | \\theta)$。\n由于完整似然是 $L(\\theta | x_{1:n}) = \\prod_i p(x_i | \\theta)$，它对这种排列也是不变的。\n\n先验分布为 $p(\\theta) = p(\\pi) p(\\mu_1) p(\\mu_2)$。$\\mu_1, \\mu_2$ 上的先验是 $p(\\mu_1, \\mu_2) = \\mathcal{N}(\\mu_1 | 0, \\tau^2) \\mathcal{N}(\\mu_2 | 0, \\tau^2)$，这是对称的：$p(\\mu_1, \\mu_2) = p(\\mu_2, \\mu_1)$。$\\pi$ 上的先验是 $p(\\pi) = \\text{Beta}(\\pi | \\alpha, \\alpha)$，它关于0.5对称，意味着 $p(\\pi) = p(1-\\pi)$。\n因此，先验密度在这种排列下也是不变的：$p(\\theta') = p(\\theta)$。\n\n由于后验正比于似然和先验的乘积，$p(\\theta | x_{1:n}) \\propto L(\\theta | x_{1:n}) p(\\theta)$，后验也是不变的：$p(\\theta | x_{1:n}) = p(\\theta' | x_{1:n})$。这意味着如果 $(\\hat{\\pi}, \\hat{\\mu}_1, \\hat{\\mu}_2)$ 是后验的一个众数，那么 $(1-\\hat{\\pi}, \\hat{\\mu}_2, \\hat{\\mu}_1)$ 也必定是另一个众数。\n\n**A. 因为先验在 $(\\mu_1,\\mu_2)$ 上是可交换的，并且似然仅通过对 $(\\{\\mu_1,\\mu_2\\},\\{z_i\\})$ 依赖于标签，所以联合后验在重新标记映射 $(\\mu_1,\\mu_2,\\pi,z_{1:n}) \\mapsto (\\mu_2,\\mu_1,1-\\pi,\\tilde z_{1:n})$（其中 $\\tilde z_i = 3-z_i$）下是不变的，并且对于分离良好的簇，$(\\mu_1,\\mu_2)$ 的边际后验是双峰的，具有两个由标签切换相关的对称众数。**\n\n我们来检查数据和参数的完整联合分布 $p(x_{1:n}, z_{1:n}, \\mu_1, \\mu_2, \\pi)$ 的不变性。这可以分解为 $p(x_{1:n}|z_{1:n},\\mu_1,\\mu_2)p(z_{1:n}|\\pi)p(\\pi)p(\\mu_1)p(\\mu_2)$。\n我们应用这个变换：$(\\mu_1,\\mu_2,\\pi,z_{1:n}) \\mapsto (\\mu_1',\\mu_2',\\pi',\\tilde{z}_{1:n}) = (\\mu_2,\\mu_1,1-\\pi,\\tilde{z}_{1:n})$。\n1.  **似然：** $p(x_{1:n}| \\tilde{z}_{1:n}, \\mu_1', \\mu_2') = \\prod_i \\mathcal{N}(x_i | \\mu'_{\\tilde{z}_i}, \\sigma^2)$。如果 $z_i=1$，那么 $\\tilde{z}_i=2$，所以均值是 $\\mu'_2 = \\mu_1$。如果 $z_i=2$，那么 $\\tilde{z}_i=1$，所以均值是 $\\mu'_1 = \\mu_2$。在这两种情况下，均值都是 $\\mu_{z_i}$。所以 $p(x_{1:n}|\\tilde{z}_{1:n},\\mu_2,\\mu_1) = p(x_{1:n}|z_{1:n},\\mu_1,\\mu_2)$。\n2.  **分配先验：** $p(\\tilde{z}_{1:n}|\\pi') = \\prod_i (\\pi')^{\\mathbb{I}(\\tilde{z}_i=1)} (1-\\pi')^{\\mathbb{I}(\\tilde{z}_i=2)} = \\prod_i (1-\\pi)^{\\mathbb{I}(z_i=2)} (\\pi)^{\\mathbb{I}(z_i=1)} = p(z_{1:n}|\\pi)$。\n3.  **参数先验：** $p(\\pi')p(\\mu_1')p(\\mu_2') = p(1-\\pi)p(\\mu_2)p(\\mu_1)$。由于对称的贝塔先验和独立同分布的正态先验，这等于 $p(\\pi)p(\\mu_1)p(\\mu_2)$。\n\n联合分布是不变的，这意味着完整后验 $p(\\mu_1, \\mu_2, \\pi, z_{1:n} | x_{1:n})$ 在此映射下是不变的。将 $\\pi$ 和 $z_{1:n}$ 边缘化掉，得到边际后验 $p(\\mu_1, \\mu_2 | x_{1:n})$，它必须是对称的，即 $p(\\mu_1, \\mu_2 | x_{1:n}) = p(\\mu_2, \\mu_1 | x_{1:n})$。对于分离良好的簇，数据将强烈支持均值的不同取值，比如在位置 $a$ 和 $b$ 附近（$a \\neq b$）。这在 $(\\mu_1, \\mu_2) = (a, b)$ 附近创建了一个后验众数。由于对称性，在 $(b, a)$ 附近必然存在一个相应的众数。因此，$(\\mu_1, \\mu_2)$ 的边际后验是双峰的。\n**结论：正确。**\n\n**B. 在大 $n$ 和分离良好的簇的情况下，单点数据增广吉布斯采样器在两个标签之间快速混合，因为每次扫描都会更新所有 $z_i$，因此可以有效地以大于0的概率将分配向量翻转到相反的标签。**\n\n吉布斯采样器从它们的完全条件分布中更新变量。考虑状态接近一个后验众数：$(\\mu_1, \\mu_2) \\approx (a,b)$，其中 $a$ 和 $b$ 是两个分离良好的簇的中心。当为来自第一个簇的数据点 $x_i$（即 $x_i \\approx a$）更新 $z_i$ 时，条件概率为 $\\mathbb{P}(z_i=1|\\dots) \\propto \\pi \\mathcal{N}(x_i|a, \\sigma^2)$ 和 $\\mathbbP(z_i=2|\\dots) \\propto (1-\\pi) \\mathcal{N}(x_i|b, \\sigma^2)$。由于簇是分离良好的，$\\mathcal{N}(x_i|a, \\sigma^2) \\gg \\mathcal{N}(x_i|b, \\sigma^2)$，所以 $\\mathbb{P}(z_i=1|\\dots) \\approx 1$。要切换到另一个标签模式，第一个簇的所有 $z_i$ 都必须翻转到标签2，第二个簇的所有 $z_i$ 都必须翻转到标签1。一次吉布斯扫描独立地（在给定参数的情况下）更新每个 $z_i$，因此所有 $z_i$ 都翻转到“错误”分量的概率小到可以忽略。采样器会被困在一个众数中，并且跨越分隔它们的低概率壁垒转换到另一个众数的概率极低。因此，采样器混合得非常慢。\n**结论：不正确。**\n\n**C. 通过拒绝任何违反 $\\mu_1 \\le \\mu_2$ 可识别性约束的提议更新来强制执行该约束，既消除了标签切换导致的多峰性，又保持了 $(\\mu_1,\\mu_2,\\pi,z_{1:n})$ 上的无约束后验不变。**\n\n通过对吉布斯更新进行拒绝抽样来施加约束 $\\mu_1 \\le \\mu_2$ 会修改采样器的转移核。原始的吉布斯采样器被设计为以无约束后验 $p(\\theta|x_{1:n})$ 为其平稳分布。修改后的采样器的状态空间被限制在子空间 $\\mathcal{S} = \\{(\\mu_1,\\mu_2,\\pi,z_{1:n}) : \\mu_1 \\le \\mu_2 \\}$。这个新马尔可夫链的不变分布是该子空间上的条件后验，即 $p(\\theta|x_{1:n}, \\theta \\in \\mathcal{S})$，它正比于 $p(\\theta|x_{1:n})\\mathbb{I}(\\mu_1 \\le \\mu_2)$。这与无约束后验是不同的分布。声称该过程“保持无约束后验 ... 不变”是错误的。该过程改变了采样器的不变分布。\n**结论：不正确。**\n\n**D. 一种回火转移或并行回火方案，引入逆温度参数 $\\beta \\in (0,1]$ 以在 $\\beta<1$ 时使似然函数扁平化，同时保持温度内部和温度之间转换的细致平衡，可以显著增加在 $\\beta=1$ 的基础链中标签切换的频率，而不改变其不变分布。**\n\n并行回火（或Metropolis耦合MCMC）并行运行多个马尔可夫链，目标是幂次后验 $p_\\beta(\\theta|x_{1:n}) \\propto [L(\\theta|x_{1:n})]^\\beta p(\\theta)$，对于一系列逆温度 $1 = \\beta_1 > \\beta_2 > \\dots > \\beta_M > 0$。对于 $\\beta < 1$，后验景观被扁平化，降低了众数之间的概率壁垒。在高温（低 $\\beta$）下的链可以轻易地在标签切换的众数之间跳跃。该算法包括在相邻温度的链之间进行交换移动，这些移动以维持联合系统细致平衡的Metropolis-Hastings概率被接受或拒绝。这使得冷链（$\\beta=1$）能够访问由热链发现的其他众数的状态。这个过程是一个有效的MCMC算法，并且根据构造，$\\beta=1$ 处的链的边际平稳分布是原始的目标后验 $p(\\theta|x_{1:n})$。该方法专门设计用于改善多峰分布中的混合情况，它通过增加众数之间（标签切换）的跳跃频率来实现这一点。\n**结论：正确。**\n\n**E. 通过交换分量标签对保存的抽样进行后验重新标记以强制执行 $\\mu_1 \\le \\mu_2$ 的顺序，可以为任何满足 $f(\\mu_1,\\mu_2)=f(\\mu_2,\\mu_1)$ 的可交换函数 $f(\\mu_1,\\mu_2)$ 的期望提供有效估计，但这种后处理不会改变底层马尔可夫链的混合性质。**\n\n这个陈述有两部分。\n1. “这种后处理不会改变底层马尔可夫链的混合性质”：这是正确的。后处理应用于链保存的输出。它对马尔可夫链本身生成样本的过程没有影响。如果链混合不佳并卡在一个众数中，后处理无法解决这个问题。\n2. “为任何可交换函数 $f(\\mu_1,\\mu_2)$ 的期望提供有效估计”：一个可交换函数是像 $f(\\mu_1, \\mu_2) = \\mu_1+\\mu_2$ 或 $f(\\mu_1, \\mu_2) = \\mu_1^2 + \\mu_2^2$ 这样的函数，其中 $f(\\mu_1, \\mu_2) = f(\\mu_2, \\mu_1)$。真实的期望是 $\\mathbb{E}[f] = \\int f(\\mu_1, \\mu_2) p(\\mu_1, \\mu_2|x_{1:n}) d\\mu_1 d\\mu_2$。因为 $f$ 和 $p(\\mu_1, \\mu_2|x_{1:n})$ 在交换 $\\mu_1$ 和 $\\mu_2$ 时都是对称的，所以在整个空间上的期望等于在其中一个众数（例如，$\\mu_1 \\le \\mu_2$ 的区域）上的期望，只差一个归一化常数。事实上，即使采样器停留在一个众数中，对于 $f$ 的MCMC平均值也是正确的，因为来自另一个众数的样本损失被 $f$ 的对称性完全补偿了。对于这类函数，后处理是不必要的，但对估计没有坏处。对于不可交换的函数（例如，$f(\\mu_1, \\mu_2) = \\mu_1$），这一点不成立。该陈述被谨慎地限制在可交换函数上，对于这类函数它是正确的。\n**结论：正确。**\n\n**F. 通过解析地边缘化掉 $(\\pi,\\mu_1,\\mu_2)$ 以获得一个关于 $z_{1:n}$ 的吉布斯采样器，可以消除标签切换对称性，并在给定的对称先验下产生一个关于 $z_{1:n}$ 的单峰后验。**\n\n一个折叠式吉布斯采样器作用于分配的边际后验 $p(z_{1:n}|x_{1:n})$。这正比于 $p(x_{1:n}|z_{1:n}) p(z_{1:n})$。我们需要检查对称性是否被消除。\n令 $\\tilde{z}_{1:n}$ 为标签交换后的分配向量，$\\tilde{z}_i = 3-z_i$。\n分配的积分先验是 $p(z_{1:n}) = \\int p(z_{1:n}|\\pi)p(\\pi)d\\pi = \\frac{B(n_1+\\alpha, n_2+\\alpha)}{B(\\alpha,\\alpha)}$，其中 $n_k$ 是分配到分量 $k$ 的计数。由于 $B(a,b)=B(b,a)$，并且交换标签意味着交换 $n_1$ 和 $n_2$，所以 $p(\\tilde{z}_{1:n}) = p(z_{1:n})$。分配上的先验是对称的。\n边际似然是 $p(x_{1:n}|z_{1:n}) = \\int p(x_{1:n}|z_{1:n}, \\mu_1, \\mu_2)p(\\mu_1,\\mu_2)d\\mu_1 d\\mu_2$。由于 $\\mu_1, \\mu_2$ 上的独立同分布先验，这可以分解为两个形式相同的积分的乘积，一个是对分量1中的数据积分，另一个是对分量2中的数据积分。交换标签 $z_{1:n} \\to \\tilde{z}_{1:n}$ 等价于交换输入到这两个积分中的数据集，这使其乘积保持不变。因此，$p(x_{1:n}|\\tilde{z}_{1:n}) = p(x_{1:n}|z_{1:n})$。\n由于两项都是对称的，后验 $p(z_{1:n}|x_{1:n})$ 也是对称的。标签切换对称性没有被消除；它被 $z_{1:n}$ 的边际后验所继承。因此，如果存在一个众数分配 $z^*$，也存在一个对称的众数 $\\tilde{z}^*$。后验不是单峰的。\n**结论：不正确。**",
            "answer": "$$\\boxed{ADE}$$"
        },
        {
            "introduction": "最后，我们来探讨一个在设计高级吉布斯采样方案时常会遇到的微妙陷阱。虽然标准的吉布斯采样器具有很强的鲁棒性，但其变种，如部分折叠采样（partially collapsed sampling），要求更精细的设计。本练习通过一个具体的例子展示，采样步骤的组合顺序可以决定一个采样器是否有效，即其是否能维持目标分布为平稳分布。这个实践将促使您超越简单的“套用公式”，深入理解维持马尔可夫链不变性的根本原则。",
            "id": "3358515",
            "problem": "考虑以下针对三个实值变量 $x$、$y$ 和 $z$ 的线性高斯分层模型：\n- $z$ 的先验分布为 $z \\sim \\mathcal{N}(0,\\tau^{2})$。\n- 给定 $z$ 时，$y$ 的条件分布为 $y \\mid z \\sim \\mathcal{N}(\\alpha z,\\sigma_{y}^{2})$。\n- 给定 $y$ 和 $z$ 时，$x$ 的条件分布为 $x \\mid y,z \\sim \\mathcal{N}(\\beta y + \\gamma z,\\sigma_{x}^{2})$。\n\n因此，联合分布 $\\pi(x,y,z)$ 对于所有 $(x,y,z) \\in \\mathbb{R}^{3}$ 都是良定义且严格为正的。\n\n通过将一个全条件更新替换为一个对无关变量进行积分（边缘化）的折叠更新，构建了一个部分折叠吉布斯采样器。具体来说，考虑基于 $p(z \\mid x)$ 对 $z$ 进行的折叠更新，该更新是通过从联合分布 $\\pi(x,y,z)$ 中对 $y$ 进行边缘化得到的。\n\n提出了两种部分折叠吉布斯采样器的不同组合顺序：\n\n- 方案 A（先更新 $y$）：从 $(x^{(t)},y^{(t)},z^{(t)})$ 开始，执行\n  1. 采样 $y^{(t+1)} \\sim p(y \\mid z^{(t)})$，\n  2. 采样 $z^{(t+1)} \\sim p(z \\mid x^{(t)})$，\n  3. 采样 $x^{(t+1)} \\sim p(x \\mid y^{(t+1)}, z^{(t+1)})$。\n\n- 方案 B（先更新 $z$）：从 $(x^{(t)},y^{(t)},z^{(t)})$ 开始，执行\n  1. 采样 $z^{(t+1)} \\sim p(z \\mid x^{(t)})$，\n  2. 采样 $y^{(t+1)} \\sim p(y \\mid z^{(t+1)})$，\n  3. 采样 $x^{(t+1)} \\sim p(x \\mid y^{(t+1)}, z^{(t+1)})$。\n\n仅使用吉布斯采样、马尔可夫链平稳性和高斯条件化的基本定义，完成以下任务：\n\n1. 通过从联合分布 $\\pi(x,y,z)$ 中边缘化 $y$，以闭合形式推导折叠条件分布 $p(z \\mid x)$。用 $(\\alpha,\\beta,\\gamma,\\tau^{2},\\sigma_{y}^{2},\\sigma_{x}^{2})$ 明确表示其均值和方差。\n\n2. 通过显式地评估作用于 $\\pi(x,y,z)$ 的组合马尔可夫核的不变性条件，分析方案 A 和方案 B 的平稳性。精确解释为什么其中一个顺序未能保持 $\\pi(x,y,z)$ 作为平稳分布，而另一个则保持平稳性。\n\n3. 对于保持平稳性的正确排序方案，在平稳分布 $\\pi(x,y,z)$ 下，使用以下参数值计算 $x$ 的边际方差：\n$$\n\\alpha = 0.7,\\quad \\beta = 1.2,\\quad \\gamma = -0.5,\\quad \\tau^{2} = 2.5,\\quad \\sigma_{y}^{2} = 1.3,\\quad \\sigma_{x}^{2} = 0.9.\n$$\n将 $x$ 的边际方差的最终数值结果四舍五入到四位有效数字。不需要物理单位。",
            "solution": "该问题要求对一个用于线性高斯分层模型的部分折叠吉布斯采样器进行三部分分析。首先，我们验证问题陈述的有效性。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- 分层模型结构：\n  - $p(z) = \\mathcal{N}(z \\mid 0, \\tau^{2})$\n  - $p(y \\mid z) = \\mathcal{N}(y \\mid \\alpha z, \\sigma_{y}^{2})$\n  - $p(x \\mid y, z) = \\mathcal{N}(x \\mid \\beta y + \\gamma z, \\sigma_{x}^{2})$\n- 联合分布 $\\pi(x,y,z) = p(x \\mid y,z) p(y \\mid z) p(z)$ 是严格为正的。\n- 采样方案 A：\n  1. 采样 $y^{(t+1)} \\sim p(y \\mid z^{(t)})$\n  2. 采样 $z^{(t+1)} \\sim p(z \\mid x^{(t)})$\n  3. 采样 $x^{(t+1)} \\sim p(x \\mid y^{(t+1)}, z^{(t+1)})$\n- 采样方案 B：\n  1. 采样 $z^{(t+1)} \\sim p(z \\mid x^{(t)})$\n  2. 采样 $y^{(t+1)} \\sim p(y \\mid z^{(t+1)})$\n  3. 采样 $x^{(t+1)} \\sim p(x \\mid y^{(t+1)}, z^{(t+1)})$\n- 任务 1：推导折叠条件分布 $p(z \\mid x)$ 的均值和方差。\n- 任务 2：分析方案 A 和 B 相对于 $\\pi(x,y,z)$ 的平稳性。\n- 任务 3：对于平稳方案，在 $\\pi(x,y,z)$ 下，使用参数 $\\alpha = 0.7$, $\\beta = 1.2$, $\\gamma = -0.5$, $\\tau^{2} = 2.5$, $\\sigma_{y}^{2} = 1.3$, $\\sigma_{x}^{2} = 0.9$ 计算 $x$ 的边际方差 $Var(x)$，并四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。这是计算统计学（MCMC 方法）领域的一个标准问题，涉及线性高斯模型的吉布斯采样器性质。所有必要的定义和参数都已提供，并且没有内部矛盾。任务是具体的，并能得出唯一的、可验证的数学结果。该问题不违反任何无效性标准。\n\n**第 3 步：结论和行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n**1. 折叠条件分布 $p(z \\mid x)$ 的推导**\n\n要推导 $p(z \\mid x)$，我们首先需要 $(x, z)$ 的联合分布，该分布通过从完整联合分布 $\\pi(x, y, z)$ 中边缘化 $y$ 得到。该模型可以写成一个带高斯噪声的线性方程组：\n$z = \\epsilon_z$，其中 $\\epsilon_z \\sim \\mathcal{N}(0, \\tau^2)$。\n$y = \\alpha z + \\epsilon_y$，其中 $\\epsilon_y \\sim \\mathcal{N}(0, \\sigma_y^2)$。\n$x = \\beta y + \\gamma z + \\epsilon_x$，其中 $\\epsilon_x \\sim \\mathcal{N}(0, \\sigma_x^2)$。\n噪声项 $\\epsilon_z$、$\\epsilon_y$、$\\epsilon_x$ 相互独立。\n\n通过将 $y$ 的表达式代入 $x$ 的表达式，我们可以用 $z$ 和独立的噪声项来表示 $x$：\n$$ x = \\beta(\\alpha z + \\epsilon_y) + \\gamma z + \\epsilon_x = (\\alpha\\beta + \\gamma)z + \\beta\\epsilon_y + \\epsilon_x $$\n由于 $x$ 和 $z$ 是高斯随机变量的线性组合，它们服从联合高斯分布。我们现在可以求出这个联合分布 $\\pi(x,z)$ 的参数。均值为 $E[z]=0$ 和 $E[x] = E[(\\alpha\\beta + \\gamma)z + \\beta\\epsilon_y + \\epsilon_x] = 0$。\n\n方差和协方差为：\n$Var(z) = E[z^2] = \\tau^2$。\n$Var(x) = Var((\\alpha\\beta + \\gamma)z + \\beta\\epsilon_y + \\epsilon_x)$。由于 $z$（即 $\\epsilon_z$）、$\\epsilon_y$ 和 $\\epsilon_x$ 的独立性：\n$$ Var(x) = (\\alpha\\beta + \\gamma)^2 Var(z) + \\beta^2 Var(\\epsilon_y) + Var(\\epsilon_x) = (\\alpha\\beta + \\gamma)^2 \\tau^2 + \\beta^2 \\sigma_y^2 + \\sigma_x^2 $$\n$Cov(x, z) = E[xz] = E[ ((\\alpha\\beta + \\gamma)z + \\beta\\epsilon_y + \\epsilon_x) z ] = E[(\\alpha\\beta + \\gamma)z^2 + \\beta\\epsilon_y z + \\epsilon_x z]$。\n利用期望的线性和独立性（$E[\\epsilon_y z] = E[\\epsilon_y]E[z] = 0$，$E[\\epsilon_x z] = 0$）：\n$$ Cov(x, z) = (\\alpha\\beta + \\gamma)E[z^2] = (\\alpha\\beta + \\gamma)\\tau^2 $$\n所以，$(z, x)$ 的联合分布为：\n$$ \\begin{pmatrix} z \\\\ x \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\tau^2 & (\\alpha\\beta + \\gamma)\\tau^2 \\\\ (\\alpha\\beta + \\gamma)\\tau^2 & (\\alpha\\beta + \\gamma)^2 \\tau^2 + \\beta^2 \\sigma_y^2 + \\sigma_x^2 \\end{pmatrix} \\right) $$\n使用条件高斯分布的标准公式，$z$ 给定 $x$ 的分布，记为 $p(z \\mid x)$，是一个高斯分布 $\\mathcal{N}(\\mu_{z|x}, \\sigma_{z|x}^2)$，其参数为：\n$$ \\mu_{z|x} = E[z \\mid x] = E[z] + \\frac{Cov(z,x)}{Var(x)}(x - E[x]) = \\frac{(\\alpha\\beta + \\gamma)\\tau^2}{(\\alpha\\beta + \\gamma)^2 \\tau^2 + \\beta^2 \\sigma_y^2 + \\sigma_x^2} x $$\n$$ \\sigma_{z|x}^2 = Var(z \\mid x) = Var(z) - \\frac{Cov(z,x)^2}{Var(x)} = \\tau^2 - \\frac{\\left((\\alpha\\beta + \\gamma)\\tau^2\\right)^2}{(\\alpha\\beta + \\gamma)^2 \\tau^2 + \\beta^2 \\sigma_y^2 + \\sigma_x^2} $$\n\n**2. 平稳性分析**\n\n一个具有转移核 $K(s' \\mid s)$ 的马尔可夫链，如果满足不变性条件 $\\int K(s' \\mid s) \\pi(s) ds = \\pi(s')$，则其具有平稳分布 $\\pi(s)$。对于吉布斯采样，总的转移核是各个更新核的组合。\n\n**方案 B 分析：** 从状态 $s^{(t)}=(x^{(t)},y^{(t)},z^{(t)})$ 到 $s^{(t+1)}=(x^{(t+1)},y^{(t+1)},z^{(t+1)})$ 的转移是由一系列三次采样定义的。组合转移概率（即转移核）为：\n$$ K_B(x',y',z' \\mid x,y,z) = p(x' \\mid y',z') p(y' \\mid z') p(z' \\mid x) $$\n为了清晰起见，我们用撇号重新标记了下一个状态的变量。旧状态是 $(x,y,z)$，新状态是 $(x',y',z')$。\n\n为了检验不变性，我们计算积分：\n$$ \\int \\pi(x,y,z) K_B(x',y',z' \\mid x,y,z) \\,dx\\,dy\\,dz $$\n代入转移核和联合分布 $\\pi(x,y,z) = p(x|y,z)p(y|z)p(z)$：\n$$ \\int p(x|y,z)p(y|z)p(z) \\cdot p(x' \\mid y',z') p(y' \\mid z') p(z' \\mid x) \\,dx\\,dy\\,dz $$\n项 $p(x' \\mid y',z')$ 和 $p(y' \\mid z')$ 可以移到积分外面：\n$$ p(x' \\mid y',z') p(y' \\mid z') \\int p(z' \\mid x) \\, [p(x|y,z)p(y|z)p(z)] \\,dx\\,dy\\,dz $$\n方括号中的项是 $\\pi(x,y,z)$。积分变为：\n$$ \\int p(z' \\mid x) \\pi(x,y,z) \\,dx\\,dy\\,dz = \\int_x p(z' \\mid x) \\left( \\int_y \\int_z \\pi(x,y,z) \\,dz\\,dy \\right) \\,dx = \\int_x p(z' \\mid x) \\pi(x) \\,dx $$\n其中 $\\pi(x)$ 是 $x$ 的边际分布。根据条件概率的定义，$p(z' \\mid x) = \\frac{\\pi(x,z')}{\\pi(x)}$。\n因此，积分为 $\\int_x \\frac{\\pi(x,z')}{\\pi(x)} \\pi(x) \\,dx = \\int_x \\pi(x,z') \\,dx = \\pi(z')$，即 $z'$ 的边际分布。\n所以，下一状态分布的完整表达式是：\n$$ p(x' \\mid y',z') p(y' \\mid z') \\pi(z') $$\n根据模型定义，$\\pi(z')$ 与先验分布 $p(z')$ 相同。因此，这个表达式正是联合分布 $\\pi(x',y',z') = p(x'|y',z')p(y'|z')p(z')$ 的定义。\n因此，方案 B 保持 $\\pi(x,y,z)$ 作为其平稳分布。它是一个有效的采样器。这个结构是有效的，因为它代表了联合分布 $(x',y',z')$ 的一个祖先采样方案，其中根节点 $z'$ 是从一个折叠条件分布 $p(z'|x)$ 中抽取的，而这个分布本身也保持了边际分布 $\\pi(x,z)$。\n\n**方案 A 分析：** 该方案的转移核为：\n$$ K_A(x',y',z' \\mid x,y,z) = p(x' \\mid y',z') p(z' \\mid x) p(y' \\mid z) $$\n关键的区别在于，新的采样值 $y'$ 依赖于旧的状态变量 $z$，而不是新的 $z'$。\n我们来检验不变性条件：\n$$ \\int \\pi(x,y,z) K_A(x',y',z' \\mid x,y,z) \\,dx\\,dy\\,dz $$\n$$ = p(x' \\mid y',z') \\int p(z' \\mid x) p(y' \\mid z) \\pi(x,y,z) \\,dx\\,dy\\,dz $$\n积分项没有像期望的那样简化为 $\\pi(y', z')$。我们来分析它：\n$$ \\int_x \\int_y \\int_z p(z' \\mid x) p(y' \\mid z) p(x|y,z) p(y|z) p(z) \\,dz\\,dy\\,dx $$\n重新排列积分顺序得到：\n$$ \\int_x p(z'|x) \\left( \\int_z p(y'|z) p(z) \\left( \\int_y p(x|y,z)p(y|z) \\,dy \\right) \\,dz \\right) \\,dx $$\n最内层的积分是 $\\int_y p(x,y|z) \\,dy = p(x|z)$，其中 $p(x|z) = \\int p(x|y,z)p(y|z) \\text{d}y$。所以表达式变为：\n$$ \\int_x p(z'|x) \\left( \\int_z p(y'|z) p(x|z) p(z) \\,dz \\right) \\,dx $$\n项 $\\int_z p(y'|z) p(x,z) \\,dz$ 无法简化为像 $\\pi(x,y')$ 这样的便捷形式。它表示一个关于 $\\pi(z)$ 的期望，并且同时依赖于 $x$ 和 $y'$。因为这个积分的结果不是 $\\pi(y',z')$，所以整个表达式不能简化为 $\\pi(x',y',z')$。\n方案 A 的结构性缺陷在于条件链断裂。$y'$ 的采样使用了“过时”的信息（$z=z^{(t)}$），而随后的 $x'$ 的采样则使用了“更新后”的信息（$z'=z^{(t+1)}$）。这种在每一步都未能传递最新信息的失败，使得组合核无法保持目标平稳分布。因此，方案 A 不是针对目标分布 $\\pi(x,y,z)$ 的有效吉布斯采样器。\n\n**3. $x$ 的边际方差**\n\n保持平稳性的正确排序方案是方案 B。问题要求计算在平稳分布 $\\pi(x,y,z)$ 下 $x$ 的边际方差。这个量 $Var(x)$ 是目标分布本身的属性，而不是采样器动态特性的属性。我们已经在第 1 部分推导出了 $Var(x)$ 的表达式。\n$$ Var(x) = (\\alpha\\beta + \\gamma)^2 \\tau^2 + \\beta^2 \\sigma_y^2 + \\sigma_x^2 $$\n我们代入给定的参数值：\n$\\alpha = 0.7$\n$\\beta = 1.2$\n$\\gamma = -0.5$\n$\\tau^{2} = 2.5$\n$\\sigma_{y}^{2} = 1.3$\n$\\sigma_{x}^{2} = 0.9$\n\n首先，计算项 $\\alpha\\beta + \\gamma$：\n$$ \\alpha\\beta + \\gamma = (0.7)(1.2) + (-0.5) = 0.84 - 0.5 = 0.34 $$\n现在，将这个值和其他值代入方差公式：\n$$ Var(x) = (0.34)^2 (2.5) + (1.2)^2 (1.3) + 0.9 $$\n$$ Var(x) = (0.1156)(2.5) + (1.44)(1.3) + 0.9 $$\n$$ Var(x) = 0.289 + 1.872 + 0.9 $$\n$$ Var(x) = 3.061 $$\n问题要求将结果四舍五入到四位有效数字。计算出的值 $3.061$ 已经有四位有效数字。",
            "answer": "$$\\boxed{3.061}$$"
        }
    ]
}