{
    "hands_on_practices": [
        {
            "introduction": "为了有效地减少偏差，我们首先必须理解其数学结构。本练习通过一个简单且易于处理的马尔可夫链模型，引导你从第一性原理推导初始偏差。通过求解泊松方程，你将精确地看到初始状态如何影响长期平均值，以及这种影响是如何以 $O(1/n)$ 的速度随时间衰减的 。",
            "id": "3347939",
            "problem": "考虑一个离散时间、时齐、不可约且非周期的马尔可夫链，其状态空间为有限集 $\\{0,1\\}$，转移矩阵为\n$$\nP \\;=\\; \\begin{pmatrix} 1-p  p \\\\ q  1-q \\end{pmatrix},\n$$\n其中 $p \\in (0,1)$ 且 $q \\in (0,1)$。设 $X_0$ 表示初始状态，$\\{X_k\\}_{k \\geq 0}$ 表示该链的轨迹。定义性能函数 $f:\\{0,1\\}\\to\\mathbb{R}$ 为 $f(0)=0$ 和 $f(1)=1$，并定义时间平均\n$$\n\\bar{f}_n \\;=\\; \\frac{1}{n} \\sum_{k=0}^{n-1} f(X_k).\n$$\n设 $\\pi$ 表示该马尔可夫链的唯一平稳分布，并记 $\\pi(f) = \\sum_{x \\in \\{0,1\\}} \\pi(x) f(x)$。稳态模拟中的初始偏差是由初始条件 $X_0=0$ 引起的偏差 $\\mathbb{E}[\\bar{f}_n] - \\pi(f)$。\n\n从平稳分布和马尔可夫性质的核心定义出发，并利用泊松方程的解 $h:\\{0,1\\}\\to\\mathbb{R}$ 满足 $h - P h = f - \\pi(f)$ 以及归一化条件 $\\sum_{x \\in \\{0,1\\}} \\pi(x) h(x) = 0$ 这一特征，完成以下步骤：\n\n- 推导平稳分布 $\\pi$ 并计算 $\\pi(f)$。\n- 在给定的归一化条件下求解 $h$ 的泊松方程。\n- 从第一性原理出发，推导初始条件为 $X_0=0$ 时初始偏差的渐近展开式中首项系数 $C(p,q)$ 的显式表达式，\n$$\n\\mathbb{E}[\\bar{f}_n] - \\pi(f) \\;=\\; \\frac{C(p,q)}{n} + o\\!\\left(\\frac{1}{n}\\right) \\quad \\text{当 } n \\to \\infty.\n$$\n\n请给出 $C(p,q)$ 的单一闭式解析表达式作为最终答案。无需四舍五入，不涉及物理单位。",
            "solution": "问题要求解一个二状态马尔可夫链初始偏差的渐近展开式中的首项系数 $C(p,q)$。分析将按照问题中概述的三个步骤进行：首先，我们推导平稳分布 $\\pi$ 和稳态性能 $\\pi(f)$；其次，我们求解势函数 $h$ 的泊松方程；最后，我们利用这个解来求得渐近偏差。\n\n**第1步：平稳分布和稳态性能**\n\n设平稳分布用行向量 $\\pi = (\\pi_0, \\pi_1)$ 表示，其中 $\\pi_x = \\pi(x)$ 是处于状态 $x \\in \\{0, 1\\}$ 的平稳概率。根据定义，平稳分布满足方程 $\\pi P = \\pi$ 以及归一化条件 $\\sum_{x \\in \\{0,1\\}} \\pi_x = 1$。\n\n方程 $\\pi P = \\pi$ 为：\n$$\n(\\pi_0, \\pi_1) \\begin{pmatrix} 1-p  p \\\\ q  1-q \\end{pmatrix} = (\\pi_0, \\pi_1)\n$$\n这给出了一个由两个线性方程组成的方程组：\n$$\n\\pi_0 (1-p) + \\pi_1 q = \\pi_0 \\\\\n\\pi_0 p + \\pi_1 (1-q) = \\pi_1\n$$\n由第一个方程，我们得到 $-\\pi_0 p + \\pi_1 q = 0$，这意味着 $\\pi_0 p = \\pi_1 q$。第二个方程也给出同样的关系。由于 $p,q \\in (0,1)$，这表明 $\\pi_0$ 和 $\\pi_1$ 之间存在一个非平凡的关系。\n\n利用归一化条件 $\\pi_0 + \\pi_1 = 1$，我们可以将 $\\pi_1 = 1 - \\pi_0$ 代入关系式 $\\pi_0 p = \\pi_1 q$ 中：\n$$\n\\pi_0 p = (1-\\pi_0) q = q - \\pi_0 q\n$$\n$$\n\\pi_0 p + \\pi_0 q = q\n$$\n$$\n\\pi_0 (p+q) = q\n$$\n由于 $p,q \\in (0,1)$，$p+q  0$，因此我们可以解出 $\\pi_0$：\n$$\n\\pi_0 = \\frac{q}{p+q}\n$$\n以及 $\\pi_1$：\n$$\n\\pi_1 = 1 - \\pi_0 = 1 - \\frac{q}{p+q} = \\frac{p+q-q}{p+q} = \\frac{p}{p+q}\n$$\n所以平稳分布为 $\\pi = \\left(\\frac{q}{p+q}, \\frac{p}{p+q}\\right)$。\n\n稳态性能 $\\pi(f)$ 是函数 $f$ 在平稳分布下的期望值：\n$$\n\\pi(f) = \\sum_{x \\in \\{0,1\\}} \\pi(x) f(x) = \\pi_0 f(0) + \\pi_1 f(1)\n$$\n使用给定的值 $f(0)=0$ 和 $f(1)=1$：\n$$\n\\pi(f) = \\left(\\frac{q}{p+q}\\right) \\cdot 0 + \\left(\\frac{p}{p+q}\\right) \\cdot 1 = \\frac{p}{p+q}\n$$\n\n**第2步：求解泊松方程**\n\n泊松方程为 $h - P h = f - \\pi(f)$，其中 $h$ 和 $f$ 被理解为由状态空间 $\\{0,1\\}$ 索引的列向量。我们将其写作 $(I-P)h = f - \\pi(f)\\mathbf{1}$，其中 $I$ 是单位矩阵，$\\mathbf{1}$ 是元素全为1的列向量。\n\n向量为：\n$h = \\begin{pmatrix} h(0) \\\\ h(1) \\end{pmatrix}$，$f = \\begin{pmatrix} f(0) \\\\ f(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n等式右边是：\n$$\nf - \\pi(f)\\mathbf{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} - \\frac{p}{p+q} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{p}{p+q} \\\\ 1 - \\frac{p}{p+q} \\end{pmatrix} = \\begin{pmatrix} -\\frac{p}{p+q} \\\\ \\frac{q}{p+q} \\end{pmatrix}\n$$\n矩阵 $(I-P)$ 是：\n$$\nI-P = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1-p  p \\\\ q  1-q \\end{pmatrix} = \\begin{pmatrix} p  -p \\\\ -q  q \\end{pmatrix}\n$$\n泊松方程变为：\n$$\n\\begin{pmatrix} p  -p \\\\ -q  q \\end{pmatrix} \\begin{pmatrix} h(0) \\\\ h(1) \\end{pmatrix} = \\begin{pmatrix} -\\frac{p}{p+q} \\\\ \\frac{q}{p+q} \\end{pmatrix}\n$$\n这个矩阵方程产生两个相关的线性方程：\n1. $p \\cdot h(0) - p \\cdot h(1) = -\\frac{p}{p+q}$\n2. $-q \\cdot h(0) + q \\cdot h(1) = \\frac{q}{p+q}$\n\n由于 $p, q \\in (0,1)$，我们可以将第一个方程除以 $p$，第二个方程除以 $q$，两者都得到相同的关系：\n$$\nh(0) - h(1) = -\\frac{1}{p+q}\n$$\n如预期的那样，这个方程组是欠定的。我们使用指定的归一化条件 $\\sum_{x \\in \\{0,1\\}} \\pi(x) h(x) = 0$：\n$$\n\\pi_0 h(0) + \\pi_1 h(1) = 0\n$$\n$$\n\\frac{q}{p+q} h(0) + \\frac{p}{p+q} h(1) = 0\n$$\n$$\nq h(0) + p h(1) = 0\n$$\n现在我们求解由两个独立的线性方程组成的方程组，以求得 $h(0)$ 和 $h(1)$：\n(a) $h(0) - h(1) = -\\frac{1}{p+q}$\n(b) $q h(0) + p h(1) = 0$\n\n从 (b) 式中，我们将 $h(0)$ 表示为 $h(1)$ 的函数：$h(0) = -\\frac{p}{q}h(1)$。将此代入 (a) 式：\n$$\n-\\frac{p}{q}h(1) - h(1) = -\\frac{1}{p+q}\n$$\n$$\n-h(1)\\left(\\frac{p}{q} + 1\\right) = -\\frac{1}{p+q}\n$$\n$$\n-h(1)\\left(\\frac{p+q}{q}\\right) = -\\frac{1}{p+q}\n$$\n$$\nh(1) = \\frac{q}{(p+q)^2}\n$$\n现在我们求 $h(0)$：\n$$\nh(0) = -\\frac{p}{q} h(1) = -\\frac{p}{q} \\left(\\frac{q}{(p+q)^2}\\right) = -\\frac{p}{(p+q)^2}\n$$\n因此，在给定归一化条件下，泊松方程的解为 $h(0) = -\\frac{p}{(p+q)^2}$ 和 $h(1) = \\frac{q}{(p+q)^2}$。\n\n**第3步：初始偏差常数的推导**\n\n设 $\\tilde{f}(x) = f(x) - \\pi(f)$。泊松方程为 $h(x) - \\mathbb{E}[h(X_{k+1})|X_k=x] = \\tilde{f}(x)$。\n我们将此关系式对 $k$ 从 $0$ 到 $n-1$ 求和：\n$$\n\\sum_{k=0}^{n-1} \\tilde{f}(X_k) = \\sum_{k=0}^{n-1} \\left( h(X_k) - \\mathbb{E}[h(X_{k+1})|X_k] \\right)\n$$\n取以初始状态 $X_0=x_0$ 为条件的期望：\n$$\n\\mathbb{E}_{x_0}\\left[\\sum_{k=0}^{n-1} \\tilde{f}(X_k)\\right] = \\sum_{k=0}^{n-1} \\left(\\mathbb{E}_{x_0}[h(X_k)] - \\mathbb{E}_{x_0}[\\mathbb{E}[h(X_{k+1})|X_k]]\\right)\n$$\n根据全期望定律，$\\mathbb{E}_{x_0}[\\mathbb{E}[h(X_{k+1})|X_k]] = \\mathbb{E}_{x_0}[h(X_{k+1})]$。该和式成为一个伸缩级数：\n$$\n\\sum_{k=0}^{n-1} (\\mathbb{E}_{x_0}[h(X_k)] - \\mathbb{E}_{x_0}[h(X_{k+1})]) = \\mathbb{E}_{x_0}[h(X_0)] - \\mathbb{E}_{x_0}[h(X_n)]\n$$\n由于 $X_0=x_0$ 是固定的，$\\mathbb{E}_{x_0}[h(X_0)] = h(x_0)$。等式左边为 $\\mathbb{E}_{x_0}\\left[n \\bar{f}_n - n\\pi(f)\\right] = n(\\mathbb{E}_{x_0}[\\bar{f}_n] - \\pi(f))$。因此，\n$$\nn\\left(\\mathbb{E}_{x_0}[\\bar{f}_n] - \\pi(f)\\right) = h(x_0) - \\mathbb{E}_{x_0}[h(X_n)]\n$$\n两边除以 $n$：\n$$\n\\mathbb{E}_{x_0}[\\bar{f}_n] - \\pi(f) = \\frac{h(x_0)}{n} - \\frac{\\mathbb{E}_{x_0}[h(X_n)]}{n}\n$$\n对于有限状态空间上的不可约且非周期的马尔可夫链，$X_n$ 的分布以指数速度收敛于平稳分布 $\\pi$。因此，\n$$\n\\mathbb{E}_{x_0}[h(X_n)] = \\sum_{y \\in \\{0,1\\}} \\mathbb{P}(X_n = y | X_0=x_0)h(y) \\to \\sum_{y \\in \\{0,1\\}} \\pi(y)h(y) \\quad \\text{当 } n \\to \\infty\n$$\n根据我们对 $h$ 的归一化，此极限为 $\\sum_y \\pi(y)h(y) = 0$。收敛是指数级的，意味着对于某个 $|\\lambda|1$，有 $\\mathbb{E}_{x_0}[h(X_n)] = O(\\lambda^n)$。因此，项 $\\frac{1}{n}\\mathbb{E}_{x_0}[h(X_n)]$ 的衰减速度快于 $\\frac{1}{n}$，是 $o(1/n)$ 阶的。\n渐近展开式为：\n$$\n\\mathbb{E}_{x_0}[\\bar{f}_n] - \\pi(f) = \\frac{h(x_0)}{n} + o\\left(\\frac{1}{n}\\right)\n$$\n问题指定了初始条件 $X_0=0$。因此，常数 $C(p,q)$ 就是 $h(0)$。\n使用我们从第2步得到的结果：\n$$\nC(p,q) = h(0) = -\\frac{p}{(p+q)^2}\n$$\n这就是初始偏差中首项系数的最终表达式。",
            "answer": "$$\\boxed{-\\frac{p}{(p+q)^{2}}}$$"
        },
        {
            "introduction": "初始暂态删除 (Initial Transient Deletion, ITD) 是一种减少偏差的常用启发式方法。然而，简单地丢弃数据并非没有代价。本练习探讨了在减少偏差和增加最终估计量方差之间的关键权衡，揭示了过于激进的数据删除策略实际上可能通过增大方差而损害估计的整体精度 。",
            "id": "3347933",
            "problem": "一个稳态仿真生成了一个时间序列 $\\{X_t\\}_{t=1}^{n}$，旨在估计一个平稳遍历过程的稳态均值 $\\mu$。该过程的方差为 $\\sigma^{2}$。该序列的自相关函数为 $\\rho_k = \\beta^{k}$（对于 $k \\geq 1$），其中 $0  \\beta  1$。有效样本量 (ESS) 定义为与相关样本产生相同样本均值方差的独立同分布样本的大小。一种初始瞬态删除 (ITD) 策略移除了前 $m$ 个观测值，并使用剩余 $n-m$ 个观测值的均值来估计 $\\mu$。\n\n假设：\n- 序列长度为 $n = 10^{5}$。\n- 自相关参数为 $\\beta = 0.99$。\n- 删除长度为 $m = \\lfloor n^{1/2} \\rfloor$。\n- 仿真是从一个确定性初始条件开始的，其均值与 $\\mu$ 的偏差为 $\\delta$，因此瞬态均值偏差按 $\\delta \\beta^{t-1}$ 几何衰减。\n\n任务：\n1. 从平稳时间序列样本均值方差的定义和上述ESS的定义出发，推导出长度为 $n$ 的完整序列和长度为 $n-m$ 的删除后序列的ESS表达式，两者都应是 $n$、$m$ 和 $\\beta$ 的显式函数。\n2. 对于 $n = 10^{5}$、$\\beta = 0.99$ 和 $m = \\lfloor n^{1/2} \\rfloor$，对这些表达式进行数值评估，并计算删除后的ESS与删除前的ESS之比 $R$。\n3. 使用几何均值回归下初始化偏差的第一性原理，分析删除 $m = \\lfloor n^{1/2} \\rfloor$ 个观测值相对于其实现的偏差减少是否合理。你的论证应基于偏差平方和时间平均估计量的方差如何随 $n$、$m$ 和 $\\beta$ 变化，而无需假设 $\\delta$ 的任何值。\n\n将比率 $R$ 作为你的最终答案。将最终答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于随机仿真输出分析的原理，问题设定良好，给出的条件完整且一致，并以客观、正式的语言表达。因此，我们可以进行完整解答。\n\n该问题要求完成三项任务：首先，推导初始瞬态删除前后有效样本量 (ESS) 的表达式；其次，对这些表达式及其比率进行数值评估；第三，基于偏差-方差权衡分析删除策略的合理性。\n\n### 任务1：有效样本量 (ESS) 表达式的推导\n\n设 $\\{Y_t\\}_{t=1}^{N}$ 是一个弱平稳时间序列，其均值为 $\\mu$，方差为 $\\sigma^2$，自相关函数为 $\\rho_k = \\text{Corr}(Y_t, Y_{t+k})$。样本均值 $\\bar{Y}_N = \\frac{1}{N}\\sum_{t=1}^{N} Y_t$ 的方差由下式给出：\n$$\n\\text{Var}(\\bar{Y}_N) = \\text{Var}\\left(\\frac{1}{N}\\sum_{t=1}^{N} Y_t\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\text{Cov}(Y_i, Y_j)\n$$\n由于过程是平稳的，$\\text{Cov}(Y_i, Y_j) = \\sigma^2 \\rho_{|i-j|}$。通过将具有相同滞后 $k = |i-j|$ 的项分组，可以重写该双重求和：\n$$\n\\text{Var}(\\bar{Y}_N) = \\frac{\\sigma^2}{N^2} \\left[ N\\rho_0 + 2\\sum_{k=1}^{N-1}(N-k)\\rho_k \\right]\n$$\n当 $\\rho_0 = 1$ 时，上式简化为：\n$$\n\\text{Var}(\\bar{Y}_N) = \\frac{\\sigma^2}{N} \\left[ 1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\rho_k \\right]\n$$\n问题指定了自相关函数为 $\\rho_k = \\beta^k$（对于 $k \\geq 1$）。将此代入方差公式：\n$$\n\\text{Var}(\\bar{Y}_N) = \\frac{\\sigma^2}{N} \\left[ 1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\beta^k \\right]\n$$\n有效样本量 $\\text{ESS}_N$ 定义为能够产生相同样本均值方差的独立同分布 (i.i.d.) 样本的大小。对于大小为 $\\text{ESS}_N$ 的 i.i.d. 样本，其均值的方差为 $\\frac{\\sigma^2}{\\text{ESS}_N}$。令两个方差表达式相等：\n$$\n\\frac{\\sigma^2}{\\text{ESS}_N} = \\frac{\\sigma^2}{N} \\left[ 1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\beta^k \\right]\n$$\n解出 $\\text{ESS}_N$：\n$$\n\\text{ESS}_N = \\frac{N}{1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\beta^k} = \\frac{N^2}{N + 2\\sum_{k=1}^{N-1}(N-k)\\beta^k}\n$$\n为了得到显式函数，我们必须计算和式 $S = \\sum_{k=1}^{N-1}(N-k)\\beta^k$：\n$$\nS = N\\sum_{k=1}^{N-1}\\beta^k - \\sum_{k=1}^{N-1}k\\beta^k\n$$\n第一项是几何级数：$\\sum_{k=1}^{N-1}\\beta^k = \\frac{\\beta(1-\\beta^{N-1})}{1-\\beta}$。\n第二项是算术-几何级数，其和为 $\\sum_{k=1}^{M} kx^k = \\frac{x(1-(M+1)x^M + Mx^{M+1})}{(1-x)^2}$。设 $M=N-1$ 和 $x=\\beta$：\n$$\n\\sum_{k=1}^{N-1}k\\beta^k = \\frac{\\beta(1-N\\beta^{N-1} + (N-1)\\beta^N)}{(1-\\beta)^2}\n$$\n组合这些项：\n$$\nS = N\\frac{\\beta(1-\\beta^{N-1})}{1-\\beta} - \\frac{\\beta(1-N\\beta^{N-1} + (N-1)\\beta^N)}{(1-\\beta)^2}\n$$\n$$\nS = \\frac{N\\beta(1-\\beta^{N-1})(1-\\beta) - \\beta(1-N\\beta^{N-1} + (N-1)\\beta^N)}{(1-\\beta)^2}\n$$\n分子可简化为：\n$$\n(N\\beta - N\\beta^2 - N\\beta^N + N\\beta^{N+1}) - (\\beta - N\\beta^N + N\\beta^{N+1} - \\beta^{N+1}) = N\\beta - N\\beta^2 - \\beta + \\beta^{N+1} = N\\beta(1-\\beta) - \\beta + \\beta^{N+1}\n$$\n所以，和为 $S = \\frac{N\\beta(1-\\beta) - \\beta + \\beta^{N+1}}{(1-\\beta)^2}$。\n将此代回 $\\text{ESS}_N$ 的表达式中：\n$$\n\\text{ESS}_N = \\frac{N^2}{N + \\frac{2(N\\beta(1-\\beta) - \\beta + \\beta^{N+1})}{(1-\\beta)^2}}\n$$\n这可以重写为：\n$$\n\\text{ESS}_N = \\frac{N^2}{N + \\frac{2N\\beta}{1-\\beta} - \\frac{2\\beta}{(1-\\beta)^2} + \\frac{2\\beta^{N+1}}{(1-\\beta)^2}}\n$$\n这就是在给定自相关结构下，样本大小为 $N$ 的ESS的通用表达式。\n\n1.  **完整序列的ESS**：完整序列的长度为 $n$。因此，我们设 $N=n$。\n    $$\n    \\text{ESS}_{\\text{full}}(n, \\beta) = \\frac{n^2}{n + \\frac{2n\\beta}{1-\\beta} - \\frac{2\\beta}{(1-\\beta)^2} + \\frac{2\\beta^{n+1}}{(1-\\beta)^2}}\n    $$\n\n2.  **删除后序列的ESS**：删除后序列移除了前 $m$ 个观测值，留下一个长度为 $n-m$ 的序列。由于原始过程是平稳的，剩余序列在统计上等同于一个长度为 $N = n-m$ 的平稳序列。\n    $$\n    \\text{ESS}_{\\text{deleted}}(n, m, \\beta) = \\frac{(n-m)^2}{(n-m) + \\frac{2(n-m)\\beta}{1-\\beta} - \\frac{2\\beta}{(1-\\beta)^2} + \\frac{2\\beta^{(n-m)+1}}{(1-\\beta)^2}}\n    $$\n\n### 任务2：数值评估与比率计算\n\n给定 $n = 10^5$，$\\beta = 0.99$，以及 $m = \\lfloor n^{1/2} \\rfloor$。首先，计算 $m$：\n$$\nm = \\lfloor(10^5)^{1/2}\\rfloor = \\lfloor 100\\sqrt{10} \\rfloor \\approx \\lfloor 316.2277 \\rfloor = 316\n$$\n删除后序列的长度为 $n-m = 10^5 - 316 = 99684$。\n$1-\\beta$ 的值为 $1 - 0.99 = 0.01$。\n\n现在，我们来评估ESS公式中的各项。\n对于 $N=n$ 或 $N=n-m$ 的情况，$\\beta^{N+1}$ 这一项非常小。例如，$(0.99)^{100001} \\approx \\exp(-1000.01) \\approx 0$，所以在数值计算中可以安全地忽略此项。\n\n对于完整序列 ($N=n=10^5$)：\n分母为 $D_{\\text{full}} = n + \\frac{2n\\beta}{1-\\beta} - \\frac{2\\beta}{(1-\\beta)^2}$。\n$$\nD_{\\text{full}} = 10^5 + \\frac{2(10^5)(0.99)}{0.01} - \\frac{2(0.99)}{(0.01)^2} = 100000 + 19800000 - 19800 = 19880200\n$$\n$$\n\\text{ESS}_{\\text{full}} = \\frac{(10^5)^2}{19880200} = \\frac{10^{10}}{19880200} \\approx 503.0130\n$$\n\n对于删除后序列 ($N=n-m=99684$)：\n分母为 $D_{\\text{deleted}} = (n-m) + \\frac{2(n-m)\\beta}{1-\\beta} - \\frac{2\\beta}{(1-\\beta)^2}$。\n$$\nD_{\\text{deleted}} = 99684 + \\frac{2(99684)(0.99)}{0.01} - 19800 = 99684 + 19737432 - 19800 = 19817316\n$$\n$$\n\\text{ESS}_{\\text{deleted}} = \\frac{(99684)^2}{19817316} = \\frac{9936899856}{19817316} \\approx 501.4285\n$$\n\n比率 $R$ 为：\n$$\nR = \\frac{\\text{ESS}_{\\text{deleted}}}{\\text{ESS}_{\\text{full}}} = \\frac{501.4285}{503.0130} \\approx 0.99684999\n$$\n四舍五入到四位有效数字，得到 $R = 0.9968$。\n\n### 任务3：删除策略的合理性分析\n\n删除初始数据的理由在于减少初始化偏差和增加估计量方差之间的权衡。一个参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的均方误差 (MSE) 为 $\\text{MSE}(\\hat{\\theta}) = \\text{Var}(\\hat{\\theta}) + [\\text{Bias}(\\hat{\\theta})]^2$。\n\n设 $\\bar{X}_{m,n} = \\frac{1}{n-m} \\sum_{t=m+1}^n X_t$ 是删除 $m$ 个点后 $\\mu$ 的估计量。\n问题陈述了瞬态均值为 $E[X_t] = \\mu + \\delta\\beta^{t-1}$。该估计量的偏差为：\n$$\n\\text{Bias}(\\bar{X}_{m,n}) = E[\\bar{X}_{m,n}] - \\mu = \\frac{1}{n-m}\\sum_{t=m+1}^{n} (\\mu + \\delta\\beta^{t-1}) - \\mu = \\frac{\\delta}{n-m}\\sum_{t=m+1}^{n}\\beta^{t-1}\n$$\n该和式是一个几何级数：$\\sum_{j=m}^{n-1}\\beta^j = \\frac{\\beta^m(1-\\beta^{n-m})}{1-\\beta}$。对于大的 $n$，$1-\\beta^{n-m} \\approx 1$。\n$$\n\\text{Bias}(\\bar{X}_{m,n}) \\approx \\frac{\\delta \\beta^m}{(n-m)(1-\\beta)}\n$$\n因此，偏差平方的变化趋势为 $[\\text{Bias}(\\bar{X}_{m,n})]^2 \\propto (n-m)^{-2}\\beta^{2m}$。\n\n估计量的方差，假设瞬态部分不影响协方差结构，是长度为 $N=n-m$ 的平稳序列样本均值的方差。对于大的 $N$ 和接近 $1$ 的 $\\beta$，$\\text{ESS}_N \\approx N \\frac{1-\\beta}{1+\\beta}$。\n$$\n\\text{Var}(\\bar{X}_{m,n}) = \\frac{\\sigma^2}{\\text{ESS}_{n-m}} \\approx \\frac{\\sigma^2(1+\\beta)}{(n-m)(1-\\beta)}\n$$\n方差的变化趋势为 $\\text{Var}(\\bar{X}_{m,n}) \\propto (n-m)^{-1}$。\n\n现在，我们比较 $m=0$（不删除）和 $m=\\lfloor n^{1/2} \\rfloor \\approx n^{1/2}$ 时的MSE。\n\n情况 $m=0$:\n- $\\text{Var} \\propto n^{-1}$。\n- $[\\text{Bias}]^2 \\propto n^{-2}$。\n对于大的 $n$，方差项 $O(n^{-1})$ 主导偏差平方项 $O(n^{-2})$。偏差已经是一个高阶误差项。\n\n情况 $m \\approx n^{1/2}$:\n- $\\text{Var} \\propto (n-n^{1/2})^{-1} \\approx n^{-1}(1+n^{-1/2})$。相对于 $m=0$ 的情况，方差项增加了。\n- $[\\text{Bias}]^2 \\propto (n-n^{1/2})^{-2} \\beta^{2n^{1/2}} \\approx n^{-2} \\beta^{2\\sqrt{n}}$。偏差被一个指数因子 $\\beta^{2\\sqrt{n}}$ 减小，该因子极快地趋于零。\n\n让我们分析MSE的变化。\n方差的增加量为：\n$$\n\\Delta\\text{Var} = \\text{Var}_{m=\\sqrt{n}} - \\text{Var}_{m=0} \\approx \\frac{C_V}{n-\\sqrt{n}} - \\frac{C_V}{n} = \\frac{C_V\\sqrt{n}}{n(n-\\sqrt{n})} \\approx C_V n^{-3/2}\n$$\n其中 $C_V = \\frac{\\sigma^2(1+\\beta)}{1-\\beta}$。方差的增加量是 $O(n^{-3/2})$ 阶的。\n\n偏差平方的减少量为：\n$$\n\\Delta[\\text{Bias}]^2 = [\\text{Bias}]_{m=0}^2 - [\\text{Bias}]_{m=\\sqrt{n}}^2 \\approx \\frac{C_B}{n^2} - \\frac{C_B \\beta^{2\\sqrt{n}}}{n^2} \\approx \\frac{C_B}{n^2}\n$$\n其中 $C_B = (\\frac{\\delta}{1-\\beta})^2$。偏差平方的减少量是 $O(n^{-2})$ 阶的。\n\n对于大的 $n$，$n^{-3/2}$ 项渐近地大于 $n^{-2}$。这意味着删除 $\\sqrt{n}$ 个样本所导致的方差增加量，渐近地大于相应的偏差平方减少量。因此，这种删除策略会增加总的MSE。\n\n结论：对于大的运行长度 $n$，从MSE的角度来看，删除策略 $m=\\lfloor n^{1/2} \\rfloor$ 是**不合理的**。它以主导的方差项更显著的增加为代价，过度地减少了一个已经是高阶的偏差项。一个更小的删除长度，例如 $m=O(1)$ 或 $m=O(\\ln n)$，对于最小化总MSE会更合适。",
            "answer": "$$\n\\boxed{0.9968}\n$$"
        },
        {
            "introduction": "稳态模拟的最终目标通常不只是一个点估计，而是一个能够量化不确定性的置信区间。本练习将引导你完成构建置信区间的标准流程，该流程结合了使用预热期删除来处理偏差，以及使用批均值法 (batch means method) 来处理输出数据中的自相关性。它还强调了在有限样本情况下使用学生 $t$ 分布进行修正是更为严谨的做法 。",
            "id": "3347878",
            "problem": "考虑一个在一般状态空间上具有不变分布 $\\pi$ 的哈里斯遍历非周期马尔可夫链 $\\{X_t\\}_{t \\ge 0}$。设 $f$ 为一个可测函数，使得 $E_{\\pi}[|f(X)|]  \\infty$，并定义稳态均值 $\\pi f = \\int f(x)\\,\\pi(dx)$。假设该链在非稳态下初始化，$X_0 \\sim \\mu \\neq \\pi$，并模拟了 $n$ 步，生成时间序列 $Y_t = f(X_t)$，其中 $t = 1, \\dots, n$。为减轻初始化偏差，您丢弃了 $w$ 个观测值的预热期，并保留了 $n' = n - w$ 个观测值 $\\{Y_{w+1}, \\dots, Y_{n}\\}$。将预热后的平均值表示为 $\\bar{f}_{n'} = \\frac{1}{n'} \\sum_{t=w+1}^{n} Y_t$。在标准的强混合条件下，平稳序列的中心极限定理 (CLT) 断言 $\\sqrt{n'}(\\bar{f}_{n'} - \\pi f) \\Rightarrow \\mathcal{N}(0, \\tau^2)$，其中时间平均方差常数 $\\tau^2$ 是有限的，并且等于零频率下的谱密度，或者等价地，当序列是绝对可和时，等于协方差之和 $\\tau^2 = \\sum_{h=-\\infty}^{\\infty} \\operatorname{Cov}_{\\pi}(Y_0, Y_h)$。\n\n为了估计 $\\tau^2$，您应用非重叠批次均值法：选择一个正整数批次大小 $k$，使得 $n' = b k$（其中 $b \\ge 2$ 是一个整数），形成批次均值 $M_j = \\frac{1}{k} \\sum_{t=(j-1)k + w + 1}^{j k + w} Y_t$（其中 $j = 1, \\dots, b$），并计算它们的经验平均值 $\\bar{M} = \\frac{1}{b} \\sum_{j=1}^{b} M_j$ 和样本方差 $s_b^2 = \\frac{1}{b-1} \\sum_{j=1}^{b} (M_j - \\bar{M})^2$。在确保弱依赖性和足够大的 $k$ 的标准条件下，批次均值估计量 $\\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2$ 是 $\\tau^2$ 的一致估计量，批次均值 $M_j$ 近似独立且近似正态，并且根据构造有 $\\bar{M} = \\bar{f}_{n'}$。\n\n以下哪个选项基于 $\\bar{f}_{n'}$ 和 $\\tau^2$ 的批次均值估计量，正确地构建了 $\\pi f$ 的 $(1-\\alpha)$ 置信区间，并为在有限样本中使用学生t分布或标准正态分位数提供了最有原则的理由？\n\nA. 使用完整的序列，不删除预热期，并直接调用中心极限定理：区间为 $\\bar{f}_{n} \\pm z_{1-\\alpha/2}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n}}$，其中 $z_{1-\\alpha/2}$ 是 $(1-\\alpha/2)$ 标准正态分位数，$\\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2$ 是根据所有 $n$ 个观测值划分的 $b$ 个批次计算得出的。理由：中心极限定理提供了渐近正态性，因此即使在有限样本中，正态分位数也是合适的。\n\nB. 删除 $w$ 个观测值的预热期，并将剩余的 $n' = b k$ 个观测值划分为 $b$ 个大小为 $k$ 的非重叠批次。根据这 $b$ 个批次均值形成 $\\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2$，并使用区间 $\\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, b-1}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}}$，其中 $t_{1-\\alpha/2,\\, b-1}$ 是自由度为 $b-1$ 的学生t分布的 $(1-\\alpha/2)$ 分位数。理由：删除预热期后，批次近似独立且近似正态；由于 $\\tau^2$ 是从 $b$ 个批次均值估计的，使用自由度为 $b-1$ 的学生化方法可以得到相对于正态极限的有限样本修正，并且当 $b \\to \\infty$ 时，渐近等价于正态分位数。\n\nC. 删除预热期后，将预热期后的原始观测值视为独立的，并使用自由度为 $n'-1$ 的常规t区间：区间为 $\\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, n'-1}\\,\\frac{s_{n'}}{\\sqrt{n'}}$，其中 $s_{n'}^2 = \\frac{1}{n'-1} \\sum_{t=w+1}^{n} (Y_t - \\bar{f}_{n'})^2$。理由：从所有 $n'$ 个相关的观测值估计方差会产生一个自由度为 $n'-1$ 的学生t枢轴量。\n\nD. 删除预热期，并使用带有批次均值一致估计量的渐近中心极限定理，但保留正态分位数：区间为 $\\bar{f}_{n'} \\pm z_{1-\\alpha/2}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}}$，其中 $\\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2$。理由：无论方差估计如何，中心极限定理都意味着渐近正态性，因此正态分位数在有限样本中仍然有效；在没有精确正态性和独立性的情况下，使用学生t分布是不必要的。\n\nE. 删除预热期，并使用自由度为 $b-1$ 的学生t分布，但通过 $\\hat{\\tau}_{\\mathrm{BM}}^2 = \\frac{s_b^2}{k}$ 来估计 $\\tau^2$。理由：批次均值近似独立，因此除以批次大小 $k$ 可以校正 $s_b^2$ 中的膨胀，而学生t分布则考虑了有限样本的不确定性。",
            "solution": "我们从基本定义和经过充分检验的结果开始。我们关心的稳态量是 $\\pi f = E_{\\pi}[f(X)]$。对于从哈里斯遍历马尔可夫链导出的相关序列 $\\{Y_t\\}$ 的稳态模拟，标准的强混合条件和平稳序列的中心极限定理 (CLT) 得出\n$$\n\\sqrt{n'}\\left(\\bar{f}_{n'} - \\pi f\\right) \\Rightarrow \\mathcal{N}(0, \\tau^2),\n$$\n其中 $\\bar{f}_{n'} = \\frac{1}{n'} \\sum_{t=w+1}^{n} Y_t$，$n' = n - w$ 反映了预热期的删除，而 $\\tau^2$ 等于零频率下的谱密度（当自协方差绝对可和时，等价于 $\\tau^2 = \\sum_{h=-\\infty}^{\\infty}\\operatorname{Cov}_{\\pi}(Y_0,Y_h)$）。中心极限定理是基本依据：它决定了样本均值的渐近行为，并为置信区间的构建提供了动机。\n\n初始化偏差的产生是因为 $X_0 \\sim \\mu \\neq \\pi$。在几何遍历性下，$E_{\\mu}[f(X_t)]$ 以几何速率收敛到 $E_{\\pi}[f(X)]$，并且 $\\bar{f}_{n}$ 的偏差以 $O(1/n)$ 的阶数衰减；然而，在有限样本中，特别是中等大小的 $n$ 时，这种偏差可能不可忽略。因此，删除 $w$ 个观测值的预热期是一种有原则的方法，以确保保留的序列近似平稳，从而使 $\\bar{f}_{n'}$ 的有限样本分布更接近中心极限定理的平稳性前提。\n\n为了估计时间平均方差常数 $\\tau^2$，非重叠批次均值法将预热期后的序列划分为 $b$ 个大小为 $k$ 的连续批次，其中 $n' = b k$。对于批次 $j$，定义\n$$\nM_j = \\frac{1}{k} \\sum_{t=(j-1)k+w+1}^{jk+w} Y_t, \\quad j = 1, \\dots, b.\n$$\n令 $\\bar{M} = \\frac{1}{b} \\sum_{j=1}^{b} M_j$ 且\n$$\ns_b^2 = \\frac{1}{b-1}\\sum_{j=1}^{b} \\left(M_j - \\bar{M}\\right)^2.\n$$\n在混合条件下且 $k$ 足够大时，每个 $M_j$ 近似服从正态分布，其方差为\n$$\n\\operatorname{Var}(M_j) \\approx \\frac{\\tau^2}{k}.\n$$\n因此，$s_b^2$ 估计了 $\\operatorname{Var}(M_j)$，并且批次均值估计量\n$$\n\\hat{\\tau}_{\\mathrm{BM}}^2 = k\\, s_b^2\n$$\n是 $\\tau^2$ 的一致估计量。此外，根据构造，有 $\\bar{M} = \\bar{f}_{n'}$。\n\n$\\pi f$ 的置信区间可以从中心极限定理和 $\\tau^2$ 的一个一致估计量得出。当 $n' \\to \\infty$（等价于 $b \\to \\infty$ 且 $k \\to \\infty$）时，标准化统计量\n$$\nZ_{n'} = \\frac{\\bar{f}_{n'} - \\pi f}{\\hat{\\tau}_{\\mathrm{BM}}/\\sqrt{n'}}\n$$\n依分布收敛于 $\\mathcal{N}(0,1)$，从而得到渐近有效的区间\n$$\n\\bar{f}_{n'} \\pm z_{1-\\alpha/2}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}}.\n$$\n然而，在有限样本中，由于从有限数量 $b$ 的批次均值来估计 $\\tau^2$ 会引入额外的不确定性。当 $M_j$ 近似独立且近似正态（这一前提在 $k$ 较大和混合充分的条件下得到加强）时，对 $b$ 个近乎独立的正态量使用样本方差 $s_b^2$ 进行学生化处理，会得到一个近似自由度为 $b-1$ 的学生t分布：\n$$\nT_{b} = \\frac{\\bar{M} - \\pi f}{\\sqrt{s_b^2/b}} \\approx t_{b-1}.\n$$\n等价地，\n$$\n\\frac{\\bar{f}_{n'} - \\pi f}{\\hat{\\tau}_{\\mathrm{BM}}/\\sqrt{n'}} = \\frac{\\bar{M} - \\pi f}{\\sqrt{s_b^2/b}} \\approx t_{b-1}.\n$$\n当 $b$ 不大时，这种有限样本修正会相对于 $z_{1-\\alpha/2}$ 增大分位数，通过考虑方差估计量的变异性来提供更可靠的覆盖率。当 $b \\to \\infty$ 时，$t_{b-1} \\to z$，恢复到渐近正态区间。\n\n我们现在分析每个选项：\n\nA. 提议的区间是\n$$\n\\bar{f}_{n} \\pm z_{1-\\alpha/2}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n}}.\n$$\n这通过使用所有 $n$ 个观测值而不删除预热期来忽略初始化偏差，违反了中心极限定理在有限样本中适用所需的平稳性前提。此外，它依赖于标准正态分位数，而没有解决从有限数量的批次估计 $\\tau^2$ 所带来的有限样本不确定性。在小到中等的 $b$ 值下，这可能导致覆盖率不足。结论：不正确。\n\nB. 提议的区间是\n$$\n\\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, b-1}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}}, \\quad \\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2,\n$$\n其中有 $n' = b k$ 个预热期后的观测值。此构造通过删除预热期来处理初始化偏差，使用从批次均值的方差导出的一致估计量 $\\hat{\\tau}_{\\mathrm{BM}}^2$，并采用自由度为 $b-1$ 的学生t分位数来解决因从 $b$ 个近似独立且近似正态的批次均值估计方差而产生的有限样本不确定性。随着 $b$ 的增长，t分位数趋近于正态分位数，确保了渐近有效性。结论：正确。\n\nC. 提议的区间是\n$$\n\\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, n'-1}\\,\\frac{s_{n'}}{\\sqrt{n'}}, \\quad s_{n'}^2 = \\frac{1}{n'-1}\\sum_{t=w+1}^{n} \\left(Y_t - \\bar{f}_{n'}\\right)^2.\n$$\n这将自相关序列 $\\{Y_t\\}$ 视为独立的，并基于原始相关数据的样本方差进行方差估计，该方差估计的是 $\\operatorname{Var}(Y_t)$，而不是支配 $\\bar{f}_{n'}$ 的中心极限定理的时间平均方差常数 $\\tau^2$。精确的t枢轴量需要观测值是独立且服从正态分布的，这在这里不成立。结论：不正确。\n\nD. 提议的区间是\n$$\n\\bar{f}_{n'} \\pm z_{1-\\alpha/2}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}}, \\quad \\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2.\n$$\n这删除了预热期并使用了正确的批次均值估计量，得出了一个渐近有效的区间。然而，其理由明确声称正态分位数在有限样本中有效，而没有考虑从 $b$ 个批次均值估计 $\\tau^2$ 时的额外不确定性。在实践中，对于中等大小的 $b$，使用 $t_{b-1}$ 更有原则，并能产生更好的有限样本覆盖率。题目明确要求为在有限样本中选择学生t分位数还是正态分位数提供理由；此选项未能提供有限样本修正。结论：对于既定目标而言不正确。\n\nE. 提议的区间使用t分位数，但设置\n$$\n\\hat{\\tau}_{\\mathrm{BM}}^2 = \\frac{s_b^2}{k},\n$$\n因此区间是\n$$\n\\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, b-1}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}} = \\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, b-1}\\,\\frac{\\sqrt{s_b^2/k}}{\\sqrt{n'}}.\n$$\n这颠倒了正确的缩放关系：由于 $\\operatorname{Var}(M_j) \\approx \\tau^2/k$，我们有 $s_b^2 \\approx \\tau^2/k$，所以一致估计量是 $\\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2$，而不是 $s_b^2/k$。所提出的缩放低估了方差，并导致覆盖率不足。结论：不正确。\n\n总之，有原则的有限样本构造方法是删除适当的预热期，通过批次均值法使用 $\\hat{\\tau}_{\\mathrm{BM}}^2 = k s_b^2$ 来估计 $\\tau^2$，并使用自由度为 $b-1$ 的学生t分位数：\n$$\n\\text{CI}_{1-\\alpha}: \\quad \\bar{f}_{n'} \\pm t_{1-\\alpha/2,\\, b-1}\\,\\frac{\\hat{\\tau}_{\\mathrm{BM}}}{\\sqrt{n'}}.\n$$\n对于中等大小的 $b$，这会产生保守的覆盖率，并且当 $b \\to \\infty$ 时恢复为渐近正态区间。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}