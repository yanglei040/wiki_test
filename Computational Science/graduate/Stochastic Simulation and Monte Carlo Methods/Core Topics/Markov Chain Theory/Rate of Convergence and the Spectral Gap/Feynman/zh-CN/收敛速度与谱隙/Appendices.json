{
    "hands_on_practices": [
        {
            "introduction": "我们从最简单的情形开始：一个有限状态马尔可夫链。这个练习提供了一个具体的机会，让你可以应用平稳分布、可逆性和特征值的核心定义，直接从转移矩阵计算谱隙。在进入更复杂的场景之前，这个练习将巩固基本概念。",
            "id": "3335415",
            "problem": "考虑一个定义在状态空间 $\\{1,2,3,4\\}$ 上的有限状态时齐马尔可夫链，其转移矩阵 $P \\in \\mathbb{R}^{4 \\times 4}$ 为\n$$\nP \\;=\\; \\begin{pmatrix}\n\\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}\n\\end{pmatrix}.\n$$\n设概率向量 $\\pi \\in \\mathbb{R}^{4}$ 由 $\\pi_i = \\frac{1}{4}$ 对每个 $i \\in \\{1,2,3,4\\}$ 给出。在由 $P$ 诱导的 $L^2(\\pi)$ 算子的意义下，谱隙定义为 $P$ 的最大特征值与次大特征值之差（对于可逆链，当特征值排序为 $1 = \\lambda_1 \\ge \\lambda_2 \\ge \\cdots$ 时，这等于 $1 - \\lambda_2$）。\n\n仅从平稳分布、可逆性和线性算子谱分解的核心定义出发，完成以下任务：\n1. 验证 $\\pi$ 是 $P$ 的一个平稳分布。\n2. 证明该链关于 $\\pi$ 是可逆的。\n3. 计算 $P$ 的所有特征值，并按非增顺序排列以确定 $\\lambda_2$。\n4. 使用上述定义，计算 $P$ 的谱隙 $\\gamma$。\n\n将谱隙 $\\gamma$ 的最终答案表示为一个精确的有理数。",
            "solution": "该问题要求对给定的马尔可夫链进行四部分分析：验证平稳分布、证明可逆性、计算转移矩阵的特征值以及计算谱隙。我们将按照指定的顺序，从基本定义出发，依次解决每个部分。\n\n状态空间为 $S = \\{1, 2, 3, 4\\}$。转移矩阵为：\n$$\nP \\;=\\; \\begin{pmatrix}\n\\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}\n\\end{pmatrix}\n$$\n提议的平稳分布是均匀分布 $\\pi = \\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\end{pmatrix}$。\n\n**1. 验证平稳分布**\n\n如果概率分布 $\\pi$ 是转移矩阵为 $P$ 的马尔可夫链的平稳分布，那么它必须是 $P$ 的对应于特征值 $1$ 的左特征向量。核心定义是条件 $\\pi P = \\pi$。我们计算行向量 $\\pi$ 与矩阵 $P$ 的乘积：\n$$\n\\pi P = \\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix}\n\\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}\n\\end{pmatrix}\n$$\n结果向量的第 $j$ 个分量由 $(\\pi P)_j = \\sum_{i=1}^{4} \\pi_i P_{ij}$ 给出。由于对所有 $i \\in \\{1, 2, 3, 4\\}$ 都有 $\\pi_i = \\frac{1}{4}$，这可以简化为：\n$$\n(\\pi P)_j = \\frac{1}{4} \\sum_{i=1}^{4} P_{ij}\n$$\n这是 $\\frac{1}{4}$ 乘以 $P$ 的第 $j$ 列元素之和。\n对于 $j=1$：$\\sum_{i=1}^{4} P_{i1} = \\frac{7}{10} + \\frac{1}{10} + \\frac{1}{10} + \\frac{1}{10} = \\frac{10}{10} = 1$。所以，$(\\pi P)_1 = \\frac{1}{4} \\cdot 1 = \\frac{1}{4}$。\n由于矩阵 $P$ 的对称性，所有列的和都是相同的。对于任何 $j \\in \\{1, 2, 3, 4\\}$：\n$$\n\\sum_{i=1}^{4} P_{ij} = \\frac{7}{10} + 3 \\times \\frac{1}{10} = 1\n$$\n因此，对所有 $j$，我们有 $(\\pi P)_j = \\frac{1}{4} \\cdot 1 = \\frac{1}{4} = \\pi_j$。这证实了 $\\pi P = \\pi$，因此 $\\pi$ 是该马尔可夫链的一个平稳分布。\n\n**2. 证明可逆性**\n\n如果一个马尔可夫链满足细致平衡条件，则称其关于平稳分布 $\\pi$ 是可逆的。细致平衡的定义是：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{for all } i, j \\in S\n$$\n在这个问题中，平稳分布是均匀的，即对所有 $i$ 都有 $\\pi_i = \\frac{1}{4}$。将此代入细致平衡方程，我们得到：\n$$\n\\frac{1}{4} P_{ij} = \\frac{1}{4} P_{ji}\n$$\n这个方程简化为 $P_{ij} = P_{ji}$。这个条件要求转移矩阵 $P$ 是对称的。观察给定的矩阵 $P$，我们看到它确实是对称的（$P = P^T$）。对于任何一对索引 $(i, j)$，元素 $P_{ij}$ 等于元素 $P_{ji}$。因此，细致平衡条件成立，该马尔可夫链关于 $\\pi$ 是可逆的。\n\n**3. 计算特征值**\n\n矩阵 $P$ 的特征值 $\\lambda$ 是特征方程 $\\det(P - \\lambda I) = 0$ 的根，其中 $I$ 是 $4 \\times 4$ 的单位矩阵。矩阵 $P$ 具有一种特殊的结构，可以简化此计算。它可以表示为单位矩阵 $I$ 和全一矩阵 $J$ 的线性组合。\n$$\nP = \\frac{6}{10} I + \\frac{1}{10} J = \\frac{3}{5} I + \\frac{1}{10} J\n$$\n其中 $I$ 是单位矩阵，$J$ 是所有元素都为 $1$ 的 $4 \\times 4$ 矩阵。形如 $aI + bJ$ 的 $n \\times n$ 矩阵的特征值是已知的。矩阵 $J$ 有两个不同的特征值：$n$（重数为 $1$，特征向量是全一向量）和 $0$（重数为 $n-1$，特征空间是分量和为零的向量集合）。\n对于 $J$ 的一个特征值为 $\\lambda_J$ 的特征向量 $v$，我们有：\n$$\n(aI + bJ)v = aIv + bJv = av + b\\lambda_J v = (a + b\\lambda_J)v\n$$\n所以，$aI + bJ$ 的特征值是 $a + b\\lambda_J$。\n在我们的例子中，$n=4$，$a = \\frac{6}{10}$，以及 $b = \\frac{1}{10}$。$J$ 的特征值是 $4$（重数为 $1$）和 $0$（重数为 $3$）。\n因此，$P$ 的特征值为：\n- 一个对应于 $\\lambda_J=4$ 的特征值：\n$$\n\\lambda_1 = a + b \\cdot 4 = \\frac{6}{10} + \\frac{1}{10} \\cdot 4 = \\frac{6+4}{10} = \\frac{10}{10} = 1\n$$\n- 三个对应于 $\\lambda_J=0$ 的特征值：\n$$\n\\lambda_{2,3,4} = a + b \\cdot 0 = \\frac{6}{10} + 0 = \\frac{6}{10}\n$$\n$P$ 的特征值是 $\\{1, \\frac{6}{10}, \\frac{6}{10}, \\frac{6}{10}\\}$。\n将它们按非增顺序排列为 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3 \\ge \\lambda_4$：\n$\\lambda_1 = 1$\n$\\lambda_2 = \\frac{6}{10} = \\frac{3}{5}$\n$\\lambda_3 = \\frac{6}{10} = \\frac{3}{5}$\n$\\lambda_4 = \\frac{6}{10} = \\frac{3}{5}$\n次大特征值是 $\\lambda_2 = \\frac{3}{5}$。\n\n**4. 计算谱隙**\n\n问题将谱隙 $\\gamma$ 定义为 $P$ 的最大特征值与次大特征值之差。这对应于 $\\gamma = \\lambda_1 - \\lambda_2$。\n使用上面计算的特征值：\n$\\lambda_1 = 1$\n$\\lambda_2 = \\frac{3}{5}$\n谱隙 $\\gamma$ 是：\n$$\n\\gamma = 1 - \\frac{3}{5} = \\frac{5}{5} - \\frac{3}{5} = \\frac{2}{5}\n$$\n谱隙是一个精确的有理数，符合要求。",
            "answer": "$$\n\\boxed{\\frac{2}{5}}\n$$"
        },
        {
            "introduction": "接下来，我们将从有限状态空间过渡到连续状态空间，并分析最常见的MCMC算法之一——吉布斯采样器。这个问题揭示了目标分布的统计特性（特别是相关性）与算法收敛速度之间的深刻联系。通过推导这个典型例子的谱隙，你将对“为什么从高度相关的分布中采样具有挑战性”获得定量的理解。",
            "id": "3335418",
            "problem": "考虑一个目标分布，它是一个以 $\\Sigma$ 为协方差矩阵的零均值二元正态分布，\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n\\sigma_{x}^{2}  \\rho\\,\\sigma_{x}\\sigma_{y} \\\\\n\\rho\\,\\sigma_{x}\\sigma_{y}  \\sigma_{y}^{2}\n\\end{pmatrix},\n$$\n其中 $\\sigma_{x} > 0$，$\\sigma_{y} > 0$，且 $|\\rho|  1$。令 $(X,Y) \\sim \\mathcal{N}\\!\\left((0,0)^{\\top}, \\Sigma\\right)$ 为目标分布。考虑用于马尔可夫链蒙特卡洛 (MCMC) 的双坐标系统性吉布斯采样器，在每次迭代中，该采样器首先从其全条件分布中根据给定的 $Y$ 更新 $X$，然后从其全条件分布中根据新采样的 $X$ 更新 $Y$。令 $K$ 表示作用于相对于目标分布的平方可积函数的单步马尔可夫算子，其定义为\n$$\n(K f)(x,y) \\;=\\; \\mathbb{E}\\!\\left[\\, f\\!\\left(X',Y'\\right) \\,\\middle|\\, (X,Y)=(x,y) \\right],\n$$\n其中 $(X',Y')$ 是由一次完整的吉布斯扫描生成的下一个状态。令 $L_{2}(\\pi)$ 表示相对于目标密度 $\\pi$ 的平方可积函数的希尔伯特空间，并令 $L_{2}^{0}(\\pi)$ 为零均值函数的子空间。$L_{2}$ 谱隙定义为\n$$\n\\gamma \\;:=\\; 1 - \\|K\\|_{L_{2}^{0}(\\pi)} \\;=\\; 1 \\;-\\; \\sup_{f \\in L_{2}^{0}(\\pi),\\, f \\neq 0} \\frac{\\|K f\\|_{2}}{\\|f\\|_{2}}.\n$$\n\n从基本原理出发，即多元正态分布的全条件分布以及马尔可夫算子和 $L_{2}$ 谱隙的定义，推导在一次完整的吉布斯扫描下 $Y$ 边际的诱导自回归表示，用它来刻画 $K$ 在 $L_{2}^{0}(\\pi)$ 上的作用，并以 $\\rho$ 的函数形式计算谱隙 $\\gamma$ 的闭式解。将你的最终答案表示为关于 $\\rho$ 的闭式解析表达式。无需四舍五入。",
            "solution": "用户想要寻找一个用于二元正态分布的系统性吉布斯采样器的谱隙。\n\n### 第1步：验证问题陈述\n该问题在马尔可夫链蒙特卡洛 (MCMC) 理论的背景下是定义良好的。\n- **已知条件**：\n    - 目标分布：$(X,Y) \\sim \\mathcal{N}((0,0)^{\\top}, \\Sigma)$，其中 $\\Sigma = \\begin{pmatrix} \\sigma_{x}^{2}  \\rho\\,\\sigma_{x}\\sigma_{y} \\\\ \\rho\\,\\sigma_{x}\\sigma_{y}  \\sigma_{y}^{2} \\end{pmatrix}$。\n    - 参数：$\\sigma_{x} > 0$，$\\sigma_{y} > 0$，$|\\rho|  1$。\n    - 算法：系统性吉布斯采样器，先更新 $X$ 再更新 $Y$。\n    - 马尔可夫算子：$(K f)(x,y) = \\mathbb{E}[f(X',Y') | (X,Y)=(x,y)]$。\n    - 谱隙定义：$\\gamma = 1 - \\|K\\|_{L_{2}^{0}(\\pi)}$。\n- **验证**：\n    - 该问题具有科学依据。它是 MCMC 算法分析中的一个典型问题。\n    - 该问题是适定的。所有必要的定义和约束都已提供，以确保一个唯一且有意义的解。\n    - 它是客观的。语言是形式化和数学化的。\n    - 该问题不违反任何无效性标准。\n- **结论**：该问题有效。\n\n### 第2步：全条件分布\n目标概率密度函数是二元正态分布 $\\pi(x,y)$。为了实现吉布斯采样器，我们首先需要全条件分布。对于多元正态分布，其条件分布也是正态的。\n\n令状态向量为 $\\mathbf{z} = (x,y)^{\\top}$。均值为 $\\boldsymbol{\\mu} = (0,0)^{\\top}$。\n给定 $Y=y$ 时 $X$ 的条件分布是一个正态分布 $\\mathcal{N}(\\mu_{X|Y}, \\sigma_{X|Y}^2)$，其中：\n- 条件均值为 $\\mu_{X|Y} = \\mu_X + \\Sigma_{XY} \\Sigma_{YY}^{-1} (y - \\mu_Y) = 0 + (\\rho\\sigma_x\\sigma_y)(\\sigma_y^2)^{-1}(y-0) = \\rho\\frac{\\sigma_x}{\\sigma_y} y$。\n- 条件方差为 $\\sigma_{X|Y}^2 = \\Sigma_{XX} - \\Sigma_{XY} \\Sigma_{YY}^{-1} \\Sigma_{YX} = \\sigma_x^2 - (\\rho\\sigma_x\\sigma_y)(\\sigma_y^2)^{-1}(\\rho\\sigma_x\\sigma_y) = \\sigma_x^2(1-\\rho^2)$。\n\n因此，$X$ 的全条件分布是 $p(x|y) = \\mathcal{N}(\\rho\\frac{\\sigma_x}{\\sigma_y} y, \\sigma_x^2(1-\\rho^2))$。\n根据对称性，交换 $x$ 和 $y$，得到 $Y$ 的全条件分布是 $p(y|x) = \\mathcal{N}(\\rho\\frac{\\sigma_y}{\\sigma_x} x, \\sigma_y^2(1-\\rho^2))$。\n\n### 第3步：吉布斯采样器和自回归表示\n系统性吉布斯采样器顺序更新坐标。给定第 $n$ 次迭代的状态 $(X_n, Y_n)$，生成 $(X_{n+1}, Y_{n+1})$ 的一次完整扫描按以下方式进行：\n1. 从分布 $p(x | Y_n=y_n)$ 中采样 $X_{n+1}$。\n2. 从分布 $p(y | X_{n+1}=x_{n+1})$ 中采样 $Y_{n+1}$。\n\n我们可以使用随机变量来写出这些步骤：\n1. $X_{n+1} = \\rho\\frac{\\sigma_x}{\\sigma_y} Y_n + \\sigma_x\\sqrt{1-\\rho^2} Z_1$，其中 $Z_1 \\sim \\mathcal{N}(0,1)$。\n2. $Y_{n+1} = \\rho\\frac{\\sigma_y}{\\sigma_x} X_{n+1} + \\sigma_y\\sqrt{1-\\rho^2} Z_2$，其中 $Z_2 \\sim \\mathcal{N}(0,1)$ 独立于 $Z_1$ 和 $(X_n, Y_n)$。\n\n为了推导 $Y$ 边际的诱导自回归表示，我们将 $X_{n+1}$ 的表达式代入 $Y_{n+1}$ 的表达式中：\n$$\nY_{n+1} = \\rho\\frac{\\sigma_y}{\\sigma_x} \\left( \\rho\\frac{\\sigma_x}{\\sigma_y} Y_n + \\sigma_x\\sqrt{1-\\rho^2} Z_1 \\right) + \\sigma_y\\sqrt{1-\\rho^2} Z_2\n$$\n$$\nY_{n+1} = \\rho^2 Y_n + \\rho \\sigma_y \\sqrt{1-\\rho^2} Z_1 + \\sigma_y\\sqrt{1-\\rho^2} Z_2\n$$\n令 $\\epsilon_{n+1} = \\rho \\sigma_y \\sqrt{1-\\rho^2} Z_1 + \\sigma_y\\sqrt{1-\\rho^2} Z_2$。这是一个噪声项。由于 $Z_1$ 和 $Z_2$ 独立于 $Y_n$，所以 $\\epsilon_{n+1}$ 也独立于 $Y_n$。$Y$ 边际的过程是一个一阶自回归过程，AR(1)：\n$$\nY_{n+1} = \\rho^2 Y_n + \\epsilon_{n+1}\n$$\n假设过程平稳，该过程在滞后为1时的自相关为 $\\text{Corr}(Y_{n+1}, Y_n) = \\rho^2$。\n\n### 第4步：马尔可夫算子的作用和谱隙\n马尔可夫算子 $K$ 描述了状态空间上的函数在马尔可夫链一步演化下的变化。对于任何函数 $f \\in L_2(\\pi)$，其在下一步的值为 $(Kf)(x,y) = \\mathbb{E}[f(X_{n+1}, Y_{n+1}) | (X_n, Y_n)=(x,y)]$。该期望是针对吉布斯更新中的随机性计算的。\n我们可以将其写成迭代期望的形式：\n$$\n(Kf)(x,y) = \\mathbb{E}_{X'|y} \\left[ \\mathbb{E}_{Y'|X'} [f(X', Y')] \\right]\n$$\n其中 $X' \\sim p(\\cdot|y)$ 且 $Y' \\sim p(\\cdot|X')$。\n\n让我们来刻画 $K$ 在简单线性函数上的作用，由于目标分布是零均值的，这些函数属于 $L_2^0(\\pi)$。\n考虑函数 $f(x,y) = y$。\n$$\n(Ky)(x,y) = \\mathbb{E}[Y' | (X,Y)=(x,y)] = \\mathbb{E}_{X'|y} \\left[ \\mathbb{E}[Y' | X'] \\right]\n$$\n根据条件分布，内部期望为 $\\mathbb{E}[Y'|X'] = \\rho\\frac{\\sigma_y}{\\sigma_x}X'$。\n将其代入，我们得到：\n$$\n(Ky)(x,y) = \\mathbb{E}_{X'|y} \\left[ \\rho\\frac{\\sigma_y}{\\sigma_x}X' \\right] = \\rho\\frac{\\sigma_y}{\\sigma_x} \\mathbb{E}[X'|y]\n$$\n条件分布 $p(x'|y)$ 的期望是 $\\mathbb{E}[X'|y] = \\rho\\frac{\\sigma_x}{\\sigma_y}y$。\n因此：\n$$\n(Ky)(x,y) = \\rho\\frac{\\sigma_y}{\\sigma_x} \\left( \\rho\\frac{\\sigma_x}{\\sigma_y}y \\right) = \\rho^2 y\n$$\n这表明函数 $f(x,y)=y$ 是马尔可夫算子 $K$ 的一个特征函数，其特征值为 $\\lambda = \\rho^2$。\n\n算子 $K$ 在零均值函数空间上的范数 $\\|K\\|_{L_{2}^{0}(\\pi)}$，也被称为 $K$ 的第二大特征值模（最大的是对应于常数特征函数的1）。这个值决定了 MCMC 算法的渐近收敛速率。\n$$\n\\|K\\|_{L_{2}^{0}(\\pi)} = \\sup_{\\lambda \\in \\text{spectrum}(K) \\setminus \\{1\\}} |\\lambda|\n$$\n由于我们找到了一个特征值为 $\\rho^2$ 的特征函数 $y \\in L_2^0(\\pi)$，因此必然有 $\\|K\\|_{L_{2}^{0}(\\pi)} \\ge |\\rho^2| = \\rho^2$。\n\n对于二元正态目标分布这个特定情况，一个已知的结果是，系统性扫描吉布斯采样器的特征值为 $\\{ \\rho^{2k} \\}_{k=1}^{\\infty}$，每个特征值的重数为2。衰减最慢的模式（即那些具有最大特征值模的模式）由坐标的线性函数捕获。因此，模小于1的最大特征值为 $\\rho^2$。\n因此，我们得出结论 $\\|K\\|_{L_{2}^{0}(\\pi)} = \\rho^2$。\n\n谱隙 $\\gamma$ 定义为 $\\gamma = 1 - \\|K\\|_{L_{2}^{0}(\\pi)}$。\n代入我们找到的值：\n$$\n\\gamma = 1 - \\rho^2\n$$\n这个结果与 $\\sigma_x$ 和 $\\sigma_y$ 无关，仅取决于相关系数 $\\rho$。当 $|\\rho| \\to 1$ 时，谱隙 $\\gamma \\to 0$，表明采样器收敛缓慢，这是预料之中的，因为此时变量变得高度相关。",
            "answer": "$$\n\\boxed{1 - \\rho^2}\n$$"
        },
        {
            "introduction": "最后的练习将深入探讨一种更强大的连续空间链分析技术：特征函数展开。通过分析自回归(AR(1))过程，你将使用埃尔米特多项式来找到马尔可夫算子的完整谱，并将谱隙与另一个关键的诊断工具——积分自相关时间(IACT)联系起来。这个练习突显了MCMC收敛理论背后丰富的数学结构。",
            "id": "3335482",
            "problem": "考虑由随机递归 $X_{n+1}=a X_{n}+\\xi_{n}$ (对 $n\\geq 0$) 定义的一阶自回归(AR(1))马尔可夫链，其中 $a\\in\\mathbb{R}$ 满足 $|a|1$，且 $(\\xi_{n})_{n\\geq 0}$ 是一个独立同分布序列，$\\xi_{n}\\sim \\mathcal{N}(0,\\sigma_{\\xi}^{2})$。假设链从其平稳分布初始化，因此对所有 $n$，$X_{n}\\sim \\mathcal{N}(0,\\sigma^{2})$，其中 $\\sigma^{2}=\\sigma_{\\xi}^{2}/(1-a^{2})$。令 $\\pi$ 表示此平稳高斯分布。定义与链的一步相关的马尔可夫算子 $P$ 为 $(Pf)(x)=\\mathbb{E}[f(a x+\\xi)]$，其中期望是关于 $\\xi\\sim \\mathcal{N}(0,\\sigma_{\\xi}^{2})$ 且独立于 $x$ 计算的。该链对于 $\\pi$ 是可逆的。\n\n从可逆性、马尔可夫算子和 $L^{2}(\\pi)$ 上的谱隙的核心定义出发，使用适合于 $\\pi$ 的标准正交多项式基推导 $P$ 的谱，并计算谱隙 $\\gamma$（最大特征值1与零均值子空间上绝对值第二大特征值之差）。接下来，对于可观测量 $f(x)=x$，定义自相关函数 $\\rho_{k}=\\mathrm{Cov}_{\\pi}(f(X_{0}),f(X_{k}))/\\mathrm{Var}_{\\pi}(f)$ 和积分自相关时间 $\\tau_{\\mathrm{int}}(f)=1+2\\sum_{k=1}^{\\infty}\\rho_{k}$，并显式计算 $\\tau_{\\mathrm{int}}(f)$。\n\n最后，使用这些量，验证一个联系此设定中谱隙与积分自相关时间的非渐近界，即对于所有满足 $|a|1$ 的 $a$， $f(x)=x$ 的积分自相关时间满足 $\\tau_{\\mathrm{int}}(f)\\leq \\dfrac{2}{\\gamma}-1$。请以 $a$ 的闭式解析表达式形式给出 $\\gamma$ 和 $\\tau_{\\mathrm{int}}(f)$ 的最终答案。不需要数值近似或四舍五入。",
            "solution": "首先验证问题以确保其科学上合理、自洽且适定。\n\n### 步骤 1：提取已知条件\n-   马尔可夫链是一个由递归式 $X_{n+1}=a X_{n}+\\xi_{n}$（对 $n\\geq 0$）定义的一阶自回归(AR(1))过程。\n-   参数 $a$ 是满足 $|a|1$ 的实数。\n-   噪声序列 $(\\xi_{n})_{n\\geq 0}$ 是独立同分布的(i.i.d.)，且 $\\xi_{n}\\sim \\mathcal{N}(0,\\sigma_{\\xi}^{2})$。\n-   该链处于其平稳分布 $\\pi$ 中，该分布为高斯分布 $\\mathcal{N}(0,\\sigma^{2})$，其中 $\\sigma^{2}=\\sigma_{\\xi}^{2}/(1-a^{2})$。\n-   马尔可夫算子 $P$ 定义为 $(Pf)(x)=\\mathbb{E}[f(a x+\\xi)]$，其中 $\\xi\\sim \\mathcal{N}(0,\\sigma_{\\xi}^{2})$。\n-   该链被说明是关于 $\\pi$ 可逆的。\n-   可观测量为 $f(x)=x$。\n-   自相关函数为 $\\rho_{k}=\\mathrm{Cov}_{\\pi}(f(X_{0}),f(X_{k}))/\\mathrm{Var}_{\\pi}(f)$。\n-   积分自相关时间为 $\\tau_{\\mathrm{int}}(f)=1+2\\sum_{k=1}^{\\infty}\\rho_{k}$。\n-   谱隙为 $\\gamma$。\n-   需要验证的不等式是 $\\tau_{\\mathrm{int}}(f)\\leq \\dfrac{2}{\\gamma}-1$。\n-   要求的最终答案是 $\\gamma$ 和 $\\tau_{\\mathrm{int}}(f)$ 关于 $a$ 的表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了 AR(1) 过程，这是时间序列分析和随机过程中的一个标准模型。所提供的平稳分布、马尔可夫算子以及谱隙和自相关时间的概念都是马尔可夫链和蒙特卡洛方法理论中公认的。建议使用埃尔米特多项式是分析具有高斯测度的过程的标准方法。该问题在根本上是合理的。\n-   **适定性**：该问题要求基于一套完整的定义推导特定量。目标明确，且可通过标准数学技术获得唯一解。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观成分。\n-   **不完整或矛盾的设置**：设置是完整且一致的。给定的平稳方差 $\\sigma^{2}=\\sigma_{\\xi}^{2}/(1-a^{2})$ 与过程定义一致：在平稳状态下，$\\mathrm{Var}(X_{n+1})=\\mathrm{Var}(X_n)=\\sigma^2$，所以 $\\sigma^2 = \\mathrm{Var}(aX_n+\\xi_n) = a^2\\mathrm{Var}(X_n) + \\mathrm{Var}(\\xi_n) = a^2\\sigma^2 + \\sigma_\\xi^2$，由此可得 $\\sigma^2(1-a^2)=\\sigma_\\xi^2$。\n-   **其他缺陷**：该问题没有清单上的任何其他缺陷。这是一个应用数学中重要的、结构良好的问题。\n\n### 步骤 3：结论和行动\n问题有效。有必要给出完整解答。\n\n### 解答推导\n\n解答过程分为四个阶段：\n1.  马尔可夫算子 $P$ 的谱的推导。\n2.  谱隙 $\\gamma$ 的计算。\n3.  对 $f(x)=x$ 的积分自相关时间 $\\tau_{\\mathrm{int}}(f)$ 的计算。\n4.  验证关联 $\\tau_{\\mathrm{int}}(f)$ 和 $\\gamma$ 的不等式。\n\n**1. 马尔可夫算子 $P$ 的谱**\n平稳分布 $\\pi$ 是一个高斯测度 $\\mathcal{N}(0, \\sigma^2)$。空间 $L^2(\\pi)$ 是关于此测度平方可积的函数空间。$L^2(\\pi)$ 的一个自然标准正交基由适当缩放的埃尔米特多项式给出。令 $He_k(z)$ 为第 $k$ 阶（概率论者的）埃尔米特多项式，它关于标准正态分布 $\\mathcal{N}(0,1)$ 是正交的。$L^2(\\pi)$ 的标准正交基由 $H_k(x) = (k!)^{-1/2} He_k(x/\\sigma)$ 给出。\n\n为了找到 $P$ 的谱，我们研究它在这些基函数上的作用。考虑未归一化的多项式 $p_k(x) = He_k(x/\\sigma)$ 就足够了，因为它们张成相同的特征空间。\n根据算子 $P$ 的定义，我们有：\n$$(P p_k)(x) = \\mathbb{E}[p_k(ax+\\xi)] = \\mathbb{E}[He_k((ax+\\xi)/\\sigma)]$$\n期望是关于 $\\xi \\sim \\mathcal{N}(0, \\sigma_\\xi^2)$ 计算的。我们来分析埃尔米特多项式的自变量。它是一个随机变量 $(ax+\\xi)/\\sigma$。其均值为 $\\mathbb{E}[(ax+\\xi)/\\sigma] = ax/\\sigma$。其方差为 $\\mathrm{Var}[(ax+\\xi)/\\sigma] = \\sigma_\\xi^2/\\sigma^2$。使用给定的关系式 $\\sigma^2 = \\sigma_\\xi^2/(1-a^2)$，我们得到 $\\sigma_\\xi^2/\\sigma^2 = 1-a^2$。\n所以，我们可以将自变量表示为：\n$$\\frac{ax+\\xi}{\\sigma} = \\frac{ax}{\\sigma} + \\frac{\\xi}{\\sigma}$$\n其中 $\\xi/\\sigma \\sim \\mathcal{N}(0, 1-a^2)$。我们可以写成 $\\xi/\\sigma = \\sqrt{1-a^2} W$，其中 $W \\sim \\mathcal{N}(0,1)$ 且与 $x$ 无关。令 $z = x/\\sigma$，我们需要计算：\n$$(P p_k)(x) = \\mathbb{E}_{W \\sim \\mathcal{N}(0,1)}[He_k(az + \\sqrt{1-a^2}W)]$$\n我们使用埃尔米特多项式的生成函数：$\\sum_{k=0}^{\\infty} \\frac{t^k}{k!} He_k(y) = \\exp(ty - t^2/2)$。\n\\begin{align*}\n\\sum_{k=0}^{\\infty} \\frac{t^k}{k!} \\mathbb{E}_W[He_k(az + \\sqrt{1-a^2}W)] = \\mathbb{E}_W\\left[ \\sum_{k=0}^{\\infty} \\frac{t^k}{k!} He_k(az + \\sqrt{1-a^2}W) \\right] \\\\\n= \\mathbb{E}_W[\\exp(t(az+\\sqrt{1-a^2}W) - t^2/2)] \\\\\n= \\exp(taz - t^2/2) \\mathbb{E}_W[\\exp(t\\sqrt{1-a^2}W)] \\\\\n= \\exp(taz - t^2/2) \\exp\\left(\\frac{1}{2}(t\\sqrt{1-a^2})^2\\right) \\\\\n= \\exp(taz - t^2/2) \\exp\\left(\\frac{t^2(1-a^2)}{2}\\right) \\\\\n= \\exp\\left(taz - \\frac{t^2}{2} + \\frac{t^2}{2} - \\frac{a^2t^2}{2}\\right) \\\\\n= \\exp\\left((at)z - \\frac{(at)^2}{2}\\right) \\\\\n= \\sum_{k=0}^{\\infty} \\frac{(at)^k}{k!} He_k(z) = \\sum_{k=0}^{\\infty} \\frac{t^k}{k!} a^k He_k(z)\n\\end{align*}\n通过比较两边 $t^k/k!$ 的系数，我们发现：\n$$\\mathbb{E}_W[He_k(az + \\sqrt{1-a^2}W)] = a^k He_k(z)$$\n将 $z=x/\\sigma$ 和 $p_k(x) = He_k(x/\\sigma)$ 代回，我们得到：\n$$(P p_k)(x) = a^k He_k(x/\\sigma) = a^k p_k(x)$$\n因此，多项式 $p_k(x)$（以及标准正交多项式 $H_k(x)$）是算子 $P$ 的特征函数，对应的特征值为 $\\lambda_k = a^k$，其中 $k \\in \\{0, 1, 2, ...\\}$。$L^2(\\pi)$ 上 $P$ 的谱是这些特征值的集合：$\\mathrm{spec}(P) = \\{a^k\\}_{k=0}^{\\infty}$。\n\n**2. 谱隙 $\\gamma$**\n最大特征值为 $\\lambda_0 = a^0 = 1$，对应于常数特征函数 $H_0(x)=1$。谱隙定义在零均值函数子空间 $L_0^2(\\pi) = (\\mathrm{span}\\{1\\})^\\perp$ 上，该子空间由 $\\{H_k(x)\\}_{k\\geq 1}$ 张成。$P$ 限制在该子空间上的谱是 $\\{\\lambda_k\\}_{k=1}^{\\infty}=\\{a, a^2, a^3, ...\\}$。\n谱隙 $\\gamma$ 是最大特征值（1）与绝对值第二大特征值之差：\n$$\\gamma = 1 - \\sup_{k \\ge 1} |\\lambda_k| = 1 - \\sup_{k \\ge 1} |a^k|$$\n因为 $|a|1$，序列 $|a^k|$ 对 $k \\ge 1$ 是严格递减的。因此，其上确界是第一项 $|a|$。\n$$\\gamma = 1 - |a|$$\n\n**3. 积分自相关时间 $\\tau_{\\mathrm{int}}(f)$**\n对于可观测量 $f(x)=x$，自相关函数为 $\\rho_k = \\mathrm{Cov}_{\\pi}(X_0, X_k) / \\mathrm{Var}_{\\pi}(X_0)$。由于链是平稳的，对所有 $n$ 有 $\\mathbb{E}_\\pi[X_n]=0$。\n方差为 $\\mathrm{Var}_{\\pi}(X_0) = \\mathbb{E}_\\pi[X_0^2] = \\sigma^2$。\n协方差为 $\\mathrm{Cov}_{\\pi}(X_0, X_k) = \\mathbb{E}_\\pi[X_0 X_k]$。\n我们可以通过迭代递归将 $X_k$ 用 $X_0$ 表示：\n$$X_k = a X_{k-1} + \\xi_{k-1} = a(aX_{k-2}+\\xi_{k-2}) + \\xi_{k-1} = \\dots = a^k X_0 + \\sum_{j=0}^{k-1} a^j \\xi_{k-1-j}$$\n现在我们计算协方差：\n$$\\mathrm{Cov}_{\\pi}(X_0, X_k) = \\mathbb{E}_\\pi\\left[X_0\\left(a^k X_0 + \\sum_{j=0}^{k-1} a^j \\xi_{k-1-j}\\right)\\right]$$\n$$= a^k \\mathbb{E}_\\pi[X_0^2] + \\sum_{j=0}^{k-1} a^j \\mathbb{E}_\\pi[X_0 \\xi_{k-1-j}]$$\n在平稳 AR(1) 模型中，$X_0$ 是过去噪声 $(\\xi_n)_{n0}$ 的函数。噪声 $(\\xi_n)_{n \\geq 0}$ 与 $X_0$ 无关。因此，对于任何 $m \\ge 0$，有 $\\mathbb{E}_\\pi[X_0 \\xi_m] = \\mathbb{E}_\\pi[X_0]\\mathbb{E}[\\xi_m] = 0 \\cdot 0 = 0$。因为对于 $j \\in \\{0, ..., k-1\\}$，有 $k-1-j \\ge 0$，所以上述表达式中的和为零。\n$$\\mathrm{Cov}_{\\pi}(X_0, X_k) = a^k \\mathbb{E}_\\pi[X_0^2] = a^k \\sigma^2$$\n因此自相关函数为：\n$$\\rho_k = \\frac{a^k \\sigma^2}{\\sigma^2} = a^k$$\n积分自相关时间为：\n$$\\tau_{\\mathrm{int}}(f) = 1 + 2\\sum_{k=1}^{\\infty} \\rho_k = 1 + 2\\sum_{k=1}^{\\infty} a^k$$\n这是一个几何级数。由于 $|a|1$，该级数收敛：$\\sum_{k=1}^{\\infty} a^k = \\frac{a}{1-a}$。\n$$\\tau_{\\mathrm{int}}(f) = 1 + 2\\frac{a}{1-a} = \\frac{1-a+2a}{1-a} = \\frac{1+a}{1-a}$$\n\n**4. 不等式的验证**\n我们必须验证对于所有 $|a|1$ 的 $a$，$\\tau_{\\mathrm{int}}(f) \\leq \\frac{2}{\\gamma}-1$。\n代入推导出的 $\\tau_{\\mathrm{int}}(f)$ 和 $\\gamma$ 的表达式：\n$$\\frac{1+a}{1-a} \\leq \\frac{2}{1-|a|} - 1$$\n我们考虑 $a$ 的两种情况：\n\n情况 1：$a \\in [0, 1)$。此时 $|a|=a$。不等式变为：\n$$\\frac{1+a}{1-a} \\leq \\frac{2}{1-a} - 1 \\implies \\frac{1+a}{1-a} \\leq \\frac{2-(1-a)}{1-a} \\implies \\frac{1+a}{1-a} \\leq \\frac{1+a}{1-a}$$\n这是一个等式，所以不等式成立。\n\n情况 2：$a \\in (-1, 0)$。此时 $|a|=-a$。不等式变为：\n$$\\frac{1+a}{1-a} \\leq \\frac{2}{1-(-a)} - 1 \\implies \\frac{1+a}{1-a} \\leq \\frac{2}{1+a} - 1$$\n$$\\frac{1+a}{1-a} \\leq \\frac{2-(1+a)}{1+a} \\implies \\frac{1+a}{1-a} \\leq \\frac{1-a}{1+a}$$\n由于 $a \\in (-1, 0)$， $1-a$ 和 $1+a$ 均为正。我们可以将两边同乘以 $(1-a)(1+a) > 0$ 而不改变不等号方向：\n$$(1+a)^2 \\leq (1-a)^2$$\n$$1+2a+a^2 \\leq 1-2a+a^2$$\n$$2a \\leq -2a \\implies 4a \\leq 0 \\implies a \\leq 0$$\n这对区间 $a \\in (-1, 0)$ 成立。当 $a0$ 时不等式是严格的，在 $a=0$ 时成为等式。\n\n该不等式对所有 $a \\in (-1, 1)$ 均成立。\n\n要求的最终答案是 $\\gamma$ 和 $\\tau_{\\mathrm{int}}(f)$ 的表达式。\n谱隙：$\\gamma=1-|a|$。\n对于 $f(x)=x$ 的积分自相关时间：$\\tau_{\\mathrm{int}}(f) = \\frac{1+a}{1-a}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1-|a|  \\frac{1+a}{1-a}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}