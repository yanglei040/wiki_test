{
    "hands_on_practices": [
        {
            "introduction": "要真正理解谱隙等抽象概念，最好的方法莫过于通过具体例子进行计算。这个练习提供了一个基础的起点，我们将在一个简单的有限状态马尔可夫链上进行操作。通过直接计算转移矩阵的特征值，我们可以明确地找出谱隙，从而为这一核心定义建立坚实的直观认识 。",
            "id": "3335415",
            "problem": "考虑一个在状态空间 $\\{1,2,3,4\\}$ 上的有限状态时齐马尔可夫链，其转移矩阵 $P \\in \\mathbb{R}^{4 \\times 4}$ 为\n$$\nP \\;=\\; \\begin{pmatrix}\n\\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}\n\\end{pmatrix}.\n$$\n设概率向量 $\\pi \\in \\mathbb{R}^{4}$ 由 $\\pi_i = \\frac{1}{4}$ 给出，其中 $i \\in \\{1,2,3,4\\}$。在由 $P$ 导出的 $L^2(\\pi)$ 算子的意义下，谱隙定义为 $P$ 的最大特征值与次大特征值之差（对于可逆链，当特征值排序为 $1 = \\lambda_1 \\ge \\lambda_2 \\ge \\cdots$ 时，这等于 $1 - \\lambda_2$）。\n\n仅从平稳分布、可逆性和线性算子谱分解的核心定义出发，完成以下任务：\n1. 验证 $\\pi$ 是 $P$ 的一个平稳分布。\n2. 证明该链关于 $\\pi$ 是可逆的。\n3. 计算 $P$ 的所有特征值，并按非递增顺序排列以确定 $\\lambda_2$。\n4. 使用上述定义，计算 $P$ 的谱隙 $\\gamma$。\n\n将谱隙 $\\gamma$ 的最终答案表示为一个精确的有理数。",
            "solution": "该问题要求对给定的马尔可夫链进行四部分分析：验证平稳分布、证明可逆性、计算转移矩阵的特征值以及计算谱隙。我们将按照指定，从基本定义出发，依次解决每个部分。\n\n状态空间为 $S = \\{1, 2, 3, 4\\}$。转移矩阵为：\n$$\nP \\;=\\; \\begin{pmatrix}\n\\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}\n\\end{pmatrix}\n$$\n给出的平稳分布是均匀分布 $\\pi = \\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\end{pmatrix}$。\n\n**1. 验证平稳分布**\n\n如果概率分布 $\\pi$ 是转移矩阵为 $P$ 的马尔可夫链的平稳分布，那么它必须是 $P$ 的对应于特征值 $1$ 的左特征向量。核心定义是条件 $\\pi P = \\pi$。我们计算行向量 $\\pi$ 与矩阵 $P$ 的乘积：\n$$\n\\pi P = \\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix}\n\\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}  \\frac{1}{10} \\\\\n\\frac{1}{10}  \\frac{1}{10}  \\frac{1}{10}  \\frac{7}{10}\n\\end{pmatrix}\n$$\n结果向量的第 $j$ 个分量由 $(\\pi P)_j = \\sum_{i=1}^{4} \\pi_i P_{ij}$ 给出。由于对所有 $i \\in \\{1, 2, 3, 4\\}$ 都有 $\\pi_i = \\frac{1}{4}$，这可以简化为：\n$$\n(\\pi P)_j = \\frac{1}{4} \\sum_{i=1}^{4} P_{ij}\n$$\n这是 $P$ 的第 $j$ 列元素之和的 $\\frac{1}{4}$。\n对于 $j=1$：$\\sum_{i=1}^{4} P_{i1} = \\frac{7}{10} + \\frac{1}{10} + \\frac{1}{10} + \\frac{1}{10} = \\frac{10}{10} = 1$。所以，$(\\pi P)_1 = \\frac{1}{4} \\cdot 1 = \\frac{1}{4}$。\n由于矩阵 $P$ 的对称性，所有列的和都相同。对于任意 $j \\in \\{1, 2, 3, 4\\}$：\n$$\n\\sum_{i=1}^{4} P_{ij} = \\frac{7}{10} + 3 \\times \\frac{1}{10} = 1\n$$\n因此，对于所有 $j$，我们有 $(\\pi P)_j = \\frac{1}{4} \\cdot 1 = \\frac{1}{4} = \\pi_j$。\n这证实了 $\\pi P = \\pi$，因此 $\\pi$ 是该马尔可夫链的平稳分布。\n\n**2. 证明可逆性**\n\n如果一个马尔可夫链满足细致平衡条件，那么它关于平稳分布 $\\pi$ 是可逆的。细致平衡的定义是：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{for all } i, j \\in S\n$$\n在这个问题中，平稳分布是均匀的，即对所有 $i$ 都有 $\\pi_i = \\frac{1}{4}$。将此代入细致平衡方程得到：\n$$\n\\frac{1}{4} P_{ij} = \\frac{1}{4} P_{ji}\n$$\n该方程简化为 $P_{ij} = P_{ji}$。这个条件要求转移矩阵 $P$ 是对称的。观察给定的矩阵 $P$，我们发现它确实是对称的 ($P = P^T$)。对于任意一对索引 $(i, j)$，元素 $P_{ij}$ 等于元素 $P_{ji}$。因此，细致平衡条件成立，该马尔可夫链关于 $\\pi$ 是可逆的。\n\n**3. 计算特征值**\n\n矩阵 $P$ 的特征值 $\\lambda$ 是特征方程 $\\det(P - \\lambda I) = 0$ 的根，其中 $I$ 是 $4 \\times 4$ 的单位矩阵。矩阵 $P$ 具有一种特殊的结构，可以简化此计算。它可以表示为单位矩阵 $I$ 和全1矩阵 $J$ 的线性组合。\n$$\nP = \\frac{6}{10} I + \\frac{1}{10} J = \\frac{3}{5} I + \\frac{1}{10} J\n$$\n其中 $I$ 是单位矩阵，$J$ 是所有元素均为 $1$ 的 $4 \\times 4$ 矩阵。形如 $aI + bJ$ 的 $n \\times n$ 矩阵的特征值是已知的。矩阵 $J$ 有两个不同的特征值：$n$（重数为 $1$，特征向量是全1向量）和 $0$（重数为 $n-1$，特征空间是分量之和为零的向量集合）。\n对于 $J$ 的一个特征值为 $\\lambda_J$ 的特征向量 $v$，我们有：\n$$\n(aI + bJ)v = aIv + bJv = av + b\\lambda_J v = (a + b\\lambda_J)v\n$$\n所以，$aI + bJ$ 的特征值为 $a + b\\lambda_J$。\n在我们的例子中，$n=4$，$a = \\frac{6}{10}$，且 $b = \\frac{1}{10}$。$J$ 的特征值为 $4$（重数为 $1$）和 $0$（重数为 $3$）。\n因此，$P$ 的特征值为：\n- 一个对应于 $\\lambda_J=4$ 的特征值：\n$$\n\\lambda_1 = a + b \\cdot 4 = \\frac{6}{10} + \\frac{1}{10} \\cdot 4 = \\frac{6+4}{10} = \\frac{10}{10} = 1\n$$\n- 三个对应于 $\\lambda_J=0$ 的特征值：\n$$\n\\lambda_{2,3,4} = a + b \\cdot 0 = \\frac{6}{10} + 0 = \\frac{6}{10}\n$$\n$P$ 的特征值为 $\\{1, \\frac{6}{10}, \\frac{6}{10}, \\frac{6}{10}\\}$。\n将它们按非递增顺序排列为 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3 \\ge \\lambda_4$：\n$\\lambda_1 = 1$\n$\\lambda_2 = \\frac{6}{10} = \\frac{3}{5}$\n$\\lambda_3 = \\frac{6}{10} = \\frac{3}{5}$\n$\\lambda_4 = \\frac{6}{10} = \\frac{3}{5}$\n次大特征值为 $\\lambda_2 = \\frac{3}{5}$。\n\n**4. 计算谱隙**\n\n问题将谱隙 $\\gamma$ 定义为 $P$ 的最大特征值与次大特征值之差。这对应于 $\\gamma = \\lambda_1 - \\lambda_2$。\n使用上面计算出的特征值：\n$\\lambda_1 = 1$\n$\\lambda_2 = \\frac{3}{5}$\n谱隙 $\\gamma$ 是：\n$$\n\\gamma = 1 - \\frac{3}{5} = \\frac{5}{5} - \\frac{3}{5} = \\frac{2}{5}\n$$\n谱隙是一个精确的有理数，符合要求。",
            "answer": "$$\n\\boxed{\\frac{2}{5}}\n$$"
        },
        {
            "introduction": "在掌握了有限状态空间的基础后，我们将注意力转向在科学计算中更常见的连续状态空间。本练习将分析吉布斯采样器（Gibbs sampler）这一基础MCMC算法，并将其应用于一个二元正态分布。这个实践揭示了一个至关重要的关系：目标分布中变量间的相关性如何直接影响谱隙，进而决定采样器的收敛速度 。",
            "id": "3335418",
            "problem": "考虑一个目标分布，它是一个以原点为中心的二元正态分布，其协方差矩阵为 $\\Sigma$，\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n\\sigma_{x}^{2}  \\rho\\,\\sigma_{x}\\sigma_{y} \\\\\n\\rho\\,\\sigma_{x}\\sigma_{y}  \\sigma_{y}^{2}\n\\end{pmatrix},\n$$\n其中 $\\sigma_{x}  0$，$\\sigma_{y}  0$ 且 $|\\rho|  1$。令 $(X,Y) \\sim \\mathcal{N}\\!\\left((0,0)^{\\top}, \\Sigma\\right)$ 为目标定律。考虑用于马尔可夫链蒙特卡洛（MCMC）的双坐标系统吉布斯采样器，在每次迭代中，首先根据其完全条件分布在给定 $Y$ 的情况下更新 $X$，然后根据新采样的 $X$ 在给定 $X$ 的情况下从其完全条件分布更新 $Y$。令 $K$ 表示作用于关于目标分布的平方可积函数上的一步马尔可夫算子，定义为\n$$\n(K f)(x,y) \\;=\\; \\mathbb{E}\\!\\left[\\, f\\!\\left(X',Y'\\right) \\,\\middle|\\, (X,Y)=(x,y) \\right],\n$$\n其中 $(X',Y')$ 是由一次完整的吉布斯扫描生成的下一个状态。令 $L_{2}(\\pi)$ 表示关于目标密度 $\\pi$ 的平方可积函数的希尔伯特空间，并令 $L_{2}^{0}(\\pi)$ 为零均值函数的子空间。$L_{2}$ 谱隙定义为\n$$\n\\gamma \\;:=\\; 1 - \\|K\\|_{L_{2}^{0}(\\pi)} \\;=\\; 1 \\;-\\; \\sup_{f \\in L_{2}^{0}(\\pi),\\, f \\neq 0} \\frac{\\|K f\\|_{2}}{\\|f\\|_{2}}.\n$$\n\n从第一性原理出发，即多元正态分布的完全条件分布以及马尔可夫算子和 $L_{2}$ 谱隙的定义，推导在一次完整吉布斯扫描下 $Y$-边缘分布的诱导自回归表示，用它来刻画 $K$ 在 $L_{2}^{0}(\\pi)$ 上的作用，并以 $\\rho$ 的函数形式计算谱隙 $\\gamma$ 的闭式解。将你的最终答案表示为关于 $\\rho$ 的闭式解析表达式。不需要四舍五入。",
            "solution": "用户想要找到用于二元正态分布的系统吉布斯采样器的谱隙。\n\n### 第 1 步：问题陈述的验证\n在马尔可夫链蒙特卡洛（MCMC）理论的背景下，该问题是良定义的。\n- **给定条件**：\n    - 目标分布：$(X,Y) \\sim \\mathcal{N}((0,0)^{\\top}, \\Sigma)$，其中 $\\Sigma = \\begin{pmatrix} \\sigma_{x}^{2}  \\rho\\,\\sigma_{x}\\sigma_{y} \\\\ \\rho\\,\\sigma_{x}\\sigma_{y}  \\sigma_{y}^{2} \\end{pmatrix}$。\n    - 参数：$\\sigma_{x}  0$，$\\sigma_{y}  0$， $|\\rho|  1$。\n    - 算法：先更新 X 再更新 Y 的系统吉布斯采样器。\n    - 马尔可夫算子：$(K f)(x,y) = \\mathbb{E}[f(X',Y') | (X,Y)=(x,y)]$。\n    - 谱隙定义：$\\gamma = 1 - \\|K\\|_{L_{2}^{0}(\\pi)}$。\n- **验证**：\n    - 该问题具有**科学依据**。它是 MCMC 算法分析中的一个典型问题。\n    - 它是**适定的**。所有必要的定义和约束都已提供，以确保得到唯一且有意义的解。\n    - 它是**客观的**。语言是形式化和数学化的。\n    - 该问题不违反任何无效性标准。\n- **结论**：该问题是有效的。\n\n### 第 2 步：完全条件分布\n目标概率密度函数是二元正态分布 $\\pi(x,y)$。为了实现吉布斯采样器，我们首先需要完全条件分布。对于多元正态分布，其条件分布也是正态分布。\n\n令状态向量为 $\\mathbf{z} = (x,y)^{\\top}$。均值为 $\\boldsymbol{\\mu} = (0,0)^{\\top}$。\n在给定 $Y=y$ 的情况下，$X$ 的条件分布是一个正态分布 $\\mathcal{N}(\\mu_{X|Y}, \\sigma_{X|Y}^2)$，其中：\n- 条件均值为 $\\mu_{X|Y} = \\mu_X + \\Sigma_{XY} \\Sigma_{YY}^{-1} (y - \\mu_Y) = 0 + (\\rho\\sigma_x\\sigma_y)(\\sigma_y^2)^{-1}(y-0) = \\rho\\frac{\\sigma_x}{\\sigma_y} y$。\n- 条件方差为 $\\sigma_{X|Y}^2 = \\Sigma_{XX} - \\Sigma_{XY} \\Sigma_{YY}^{-1} \\Sigma_{YX} = \\sigma_x^2 - (\\rho\\sigma_x\\sigma_y)(\\sigma_y^2)^{-1}(\\rho\\sigma_x\\sigma_y) = \\sigma_x^2(1-\\rho^2)$。\n\n因此，$X$ 的完全条件分布为 $p(x|y) = \\mathcal{N}(\\rho\\frac{\\sigma_x}{\\sigma_y} y, \\sigma_x^2(1-\\rho^2))$。\n根据对称性，交换 $x$ 和 $y$，$Y$ 的完全条件分布为 $p(y|x) = \\mathcal{N}(\\rho\\frac{\\sigma_y}{\\sigma_x} x, \\sigma_y^2(1-\\rho^2))$。\n\n### 第 3 步：吉布斯采样器和自回归表示\n系统吉布斯采样器按顺序更新坐标。给定第 $n$ 次迭代的状态 $(X_n, Y_n)$，生成 $(X_{n+1}, Y_{n+1})$ 的一次完整扫描过程如下：\n1. 从分布 $p(x | Y_n=y_n)$ 中采样 $X_{n+1}$。\n2. 从分布 $p(y | X_{n+1}=x_{n+1})$ 中采样 $Y_{n+1}$。\n\n我们可以用随机变量来写出这些步骤：\n1. $X_{n+1} = \\rho\\frac{\\sigma_x}{\\sigma_y} Y_n + \\sigma_x\\sqrt{1-\\rho^2} Z_1$，其中 $Z_1 \\sim \\mathcal{N}(0,1)$。\n2. $Y_{n+1} = \\rho\\frac{\\sigma_y}{\\sigma_x} X_{n+1} + \\sigma_y\\sqrt{1-\\rho^2} Z_2$，其中 $Z_2 \\sim \\mathcal{N}(0,1)$ 独立于 $Z_1$ 和 $(X_n, Y_n)$。\n\n为了推导 $Y$-边缘分布的诱导自回归表示，我们将 $X_{n+1}$ 的表达式代入 $Y_{n+1}$ 的表达式中：\n$$\nY_{n+1} = \\rho\\frac{\\sigma_y}{\\sigma_x} \\left( \\rho\\frac{\\sigma_x}{\\sigma_y} Y_n + \\sigma_x\\sqrt{1-\\rho^2} Z_1 \\right) + \\sigma_y\\sqrt{1-\\rho^2} Z_2\n$$\n$$\nY_{n+1} = \\rho^2 Y_n + \\rho \\sigma_y \\sqrt{1-\\rho^2} Z_1 + \\sigma_y\\sqrt{1-\\rho^2} Z_2\n$$\n令 $\\epsilon_{n+1} = \\rho \\sigma_y \\sqrt{1-\\rho^2} Z_1 + \\sigma_y\\sqrt{1-\\rho^2} Z_2$。这是一个噪声项。由于 $Z_1$ 和 $Z_2$ 独立于 $Y_n$，所以 $\\epsilon_{n+1}$ 也独立于 $Y_n$。$Y$-边缘分布的过程是一个一阶自回归过程，即 AR(1)：\n$$\nY_{n+1} = \\rho^2 Y_n + \\epsilon_{n+1}\n$$\n假设该过程是平稳的，其滞后1的自相关为 $\\text{Corr}(Y_{n+1}, Y_n) = \\rho^2$。\n\n### 第 4 步：马尔可夫算子的作用和谱隙\n马尔可夫算子 $K$ 描述了状态空间上的函数在马尔可夫链一步演化下的变化。对于任何函数 $f \\in L_2(\\pi)$，其在下一步的值为 $(Kf)(x,y) = \\mathbb{E}[f(X_{n+1}, Y_{n+1}) | (X_n, Y_n)=(x,y)]$。期望是针对吉布斯更新中的随机性计算的。\n我们可以将其写成迭代期望的形式：\n$$\n(Kf)(x,y) = \\mathbb{E}_{X'|y} \\left[ \\mathbb{E}_{Y'|X'} [f(X', Y')] \\right]\n$$\n其中 $X' \\sim p(\\cdot|y)$ 且 $Y' \\sim p(\\cdot|X')$。\n\n让我们来刻画 $K$ 在简单线性函数上的作用，由于目标分布是中心化的，这些函数属于 $L_2^0(\\pi)$。\n考虑函数 $f(x,y) = y$。\n$$\n(Ky)(x,y) = \\mathbb{E}[Y' | (X,Y)=(x,y)] = \\mathbb{E}_{X'|y} \\left[ \\mathbb{E}[Y' | X'] \\right]\n$$\n根据条件分布，内部期望为 $\\mathbb{E}[Y'|X'] = \\rho\\frac{\\sigma_y}{\\sigma_x}X'$。\n将此代入，我们得到：\n$$\n(Ky)(x,y) = \\mathbb{E}_{X'|y} \\left[ \\rho\\frac{\\sigma_y}{\\sigma_x}X' \\right] = \\rho\\frac{\\sigma_y}{\\sigma_x} \\mathbb{E}[X'|y]\n$$\n条件分布 $p(x'|y)$ 的期望为 $\\mathbb{E}[X'|y] = \\rho\\frac{\\sigma_x}{\\sigma_y}y$。\n因此：\n$$\n(Ky)(x,y) = \\rho\\frac{\\sigma_y}{\\sigma_x} \\left( \\rho\\frac{\\sigma_x}{\\sigma_y}y \\right) = \\rho^2 y\n$$\n这表明函数 $f(x,y)=y$ 是马尔可夫算子 $K$ 的一个特征函数，其特征值为 $\\lambda = \\rho^2$。\n\n算子 $K$ 在零均值函数空间上的范数平方 $\\|K\\|_{L_{2}^{0}(\\pi)}$，也被称为 $K$ 的第二大特征值模长（最大的是对应于常数特征函数的1）。这个值决定了 MCMC 算法的渐近收敛速率。\n$$\n\\|K\\|_{L_{2}^{0}(\\pi)} = \\sup_{\\lambda \\in \\text{spectrum}(K) \\setminus \\{1\\}} |\\lambda|\n$$\n由于我们已经找到了一个特征函数 $y \\in L_2^0(\\pi)$，其特征值为 $\\rho^2$，因此必然有 $\\|K\\|_{L_{2}^{0}(\\pi)} \\ge |\\rho^2| = \\rho^2$。\n\n对于二元正态目标分布的特定情况，一个已知的结果是，系统扫描吉布斯采样器的特征值为 $\\{ \\rho^{2k} \\}_{k=1}^{\\infty}$，每个特征值的重数为 2。衰减最慢的模式（即具有最大特征值模长的模式）由坐标的线性函数捕获。因此，模长小于1的最大特征值为 $\\rho^2$。\n因此，我们得出结论 $\\|K\\|_{L_{2}^{0}(\\pi)} = \\rho^2$。\n\n谱隙 $\\gamma$ 定义为 $\\gamma = 1 - \\|K\\|_{L_{2}^{0}(\\pi)}$。\n代入我们找到的值：\n$$\n\\gamma = 1 - \\rho^2\n$$\n这个结果与 $\\sigma_x$ 和 $\\sigma_y$ 无关，仅取决于相关系数 $\\rho$。当 $|\\rho| \\to 1$ 时，谱隙 $\\gamma \\to 0$，表明采样器收敛缓慢，这是预期的，因为变量变得高度相关。",
            "answer": "$$\n\\boxed{1 - \\rho^2}\n$$"
        },
        {
            "introduction": "最后，我们将探讨一个更高级且极具实用价值的主题：MCMC算法的设计。本练习聚焦于随机游走梅特罗波利斯（Random Walk Metropolis）算法，并研究在高维问题中如何设置其关键参数（如提议方差）。这个实践将演示，如何通过对高维极限下谱隙的理论分析，推导出一条著名的实用法则，从而优化算法的性能 。",
            "id": "3335442",
            "problem": "考虑在 $\\mathbb{R}^{d}$ 上以标准高斯分布 $\\mathcal{N}(0, I_{d})$ 为目标分布的随机游走梅特罗波利斯 (Random Walk Metropolis, RWM) 算法。其提议为 $Y = X + \\sigma Z$，其中 $Z \\sim \\mathcal{N}(0, I_{d})$，$ \\sigma^{2}  0$ 是提议方差。Metropolis–Hastings 接受概率为 $a(X, Y) = \\min\\{1, \\exp(-\\frac{1}{2}(|Y|^{2} - |X|^{2}))\\}$，所得到的马尔可夫链对于目标分布是可逆的。\n\n从以下几点出发：\n- 通过可逆马尔可夫链的狄利克雷形式 (Dirichlet form) 定义其谱隙 $\\gamma$；\n- 对于不变分布 $\\mathcal{N}(0, 1)$，在 $\\mathbb{R}$ 上 Ornstein–Uhlenbeck (OU) 半群的谱隙特征；\n- 以及一个科学上标准的高维尺度调整机制 $\\sigma = \\ell / \\sqrt{d}$，其中 $\\ell  0$ 为固定值，\n\n推导在高维极限 $d \\to \\infty$ 下，离散时间谱隙 $\\gamma(\\sigma, d)$ 对 $\\sigma$ 的主阶依赖关系。您的推导应从第一性原理出发：确定渐近接受行为，将梅特罗波利斯核的小步长狄利克雷形式与作用于单一坐标的 OU 狄利克雷形式联系起来，并一致地考虑为获得非退化极限生成元所需的时间重缩放。然后，确定平衡移动大小和接受率以最大化谱隙的机制，并求解作为 $d$ 函数的最优提议尺度。\n\n请以 $d$ 的表达式给出您的最终答案，即最优提议标准差 $\\sigma_{\\mathrm{opt}}(d)$。将最终答案四舍五入至三位有效数字。此问题不涉及物理单位，也不出现角度。",
            "solution": "用户希望推导针对高维标准高斯分布的随机游走梅特罗波利斯 (RWM) 算法的最优提议标准差。推导必须从第一性原理出发，将离散时间链的谱隙与其连续时间扩散极限的谱隙联系起来。\n\n**1. 问题设置与渐近分析**\n\nRWM 算法提议从状态 $X \\in \\mathbb{R}^d$ 移动到 $Y = X + \\sigma Z$，其中 $Z \\sim \\mathcal{N}(0, I_d)$。目标分布是标准的 $d$ 维高斯分布 $\\pi(x) \\propto \\exp(-|x|^2/2)$。Metropolis-Hastings 接受概率为 $a(X,Y) = \\min\\{1, R\\}$，其中密度比为 $R = \\frac{\\pi(Y)}{\\pi(X)} = \\exp(-\\frac{1}{2}(|Y|^2 - |X|^2))$。\n\n我们关心在尺度调整 $\\sigma = \\ell / \\sqrt{d}$（其中 $\\ell  0$ 为固定常数）下的高维极限 $d \\to \\infty$。让我们分析密度比的对数 $\\ln R$。\n$$\n\\ln R = -\\frac{1}{2} \\left(|X+\\sigma Z|^2 - |X|^2\\right) = -\\frac{1}{2} \\left(2\\sigma \\langle X, Z \\rangle + \\sigma^2 |Z|^2\\right) = -\\sigma \\langle X, Z \\rangle - \\frac{1}{2}\\sigma^2 |Z|^2\n$$\n这里，$X$ 是从平稳分布 $\\pi = \\mathcal{N}(0, I_d)$ 中抽取的样本，$Z$ 是从 $\\mathcal{N}(0, I_d)$ 中抽取的独立样本。对于一个从 $\\pi$ 中抽取的典型 $X$，根据大数定律，有 $|X|^2 = \\sum_{i=1}^d X_i^2 \\approx d \\mathbb{E}[X_1^2] = d$。\n在给定 $X$ 的条件下，项 $\\langle X, Z \\rangle = \\sum_{i=1}^d X_i Z_i$ 是独立随机变量之和，服从高斯分布 $\\mathcal{N}(0, |X|^2)$。渐近地，$\\langle X, Z \\rangle \\sim \\mathcal{N}(0, d)$。\n此外， $|Z|^2 = \\sum_{i=1}^d Z_i^2$ 是一个自由度为 $d$ 的卡方随机变量。对于大的 $d$，中心极限定理表明 $(|Z|^2 - d)/\\sqrt{2d}$ 收敛于标准正态分布，并且根据大数定律， $|Z|^2/d \\to 1$ （依概率收敛）。\n\n代入尺度调整 $\\sigma = \\ell/\\sqrt{d}$：\n$$\n\\ln R = -\\frac{\\ell}{\\sqrt{d}}\\langle X, Z \\rangle - \\frac{\\ell^2}{2d}|Z|^2\n$$\n第一项 $-\\frac{\\ell}{\\sqrt{d}}\\langle X, Z \\rangle$ 依分布收敛于 $\\mathcal{N}(0, \\ell^2)$。第二项 $-\\frac{\\ell^2}{2d}|Z|^2$ 依概率收敛于 $-\\ell^2/2$。因此，$\\ln R$ 依分布收敛于一个随机变量 $S \\sim \\mathcal{N}(-\\ell^2/2, \\ell^2)$。\n\n渐近平均接受率 $A(\\ell)$ 是 $\\min\\{1, \\exp(S)\\}$ 的期望值。设 $S \\sim \\mathcal{N}(\\mu, \\nu^2)$。\n$$\nA(\\ell) = \\mathbb{E}[\\min\\{1, \\exp(S)\\}] = \\int_{-\\infty}^{0} \\exp(s) \\phi_{\\mu, \\nu^2}(s) ds + \\int_{0}^{\\infty} \\phi_{\\mu, \\nu^2}(s) ds\n$$\n其中 $\\phi_{\\mu, \\nu^2}$ 是 $\\mathcal{N}(\\mu, \\nu^2)$ 的概率密度函数 (PDF)。第二项是 $P(S0) = \\Phi(\\mu/\\nu)$。第一项可以通过在指数上配方法来计算：\n$$\n\\int_{-\\infty}^{0} \\exp(s) \\phi_{\\mu, \\nu^2}(s) ds = \\exp(\\mu + \\nu^2/2) \\Phi\\left(\\frac{0 - (\\mu+\\nu^2)}{\\nu}\\right) = \\exp(\\mu + \\nu^2/2) \\Phi(-\\mu/\\nu - \\nu)\n$$\n因此，$A(\\ell) = \\Phi(\\mu/\\nu) + \\exp(\\mu+\\nu^2/2) \\Phi(-\\mu/\\nu - \\nu)$。\n当 $\\mu = -\\ell^2/2$ 且 $\\nu=\\ell$ 时，这变为：\n$$\nA(\\ell) = \\Phi\\left(\\frac{-\\ell^2/2}{\\ell}\\right) + \\exp\\left(-\\frac{\\ell^2}{2} + \\frac{\\ell^2}{2}\\right) \\Phi\\left(-\\frac{-\\ell^2/2}{\\ell} - \\ell\\right) = \\Phi(-\\ell/2) + \\Phi(\\ell/2 - \\ell) = 2\\Phi(-\\ell/2)\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n\n**2. 谱隙与连续时间极限**\n\n可逆马尔可夫链的收敛速率由其谱隙 $\\gamma_d = 1-\\lambda_2$ 决定，其中 $\\lambda_2$ 是转移算子 $P_d$ 的第二大特征值。对于小谱隙，$\\gamma_d \\approx -\\ln(\\lambda_2)$。\n\n在具有指定尺度调整的高维极限中，当在单个坐标上观察并按因子 $d$ 进行时间重缩放时，离散时间链弱收敛于一维 Ornstein-Uhlenbeck (OU) 过程。可以证明，该极限扩散的生成元形式为 $\\mathcal{L}_{\\text{lim}} = c(\\ell) \\mathcal{L}_{\\text{Langevin},1}$，其中 $\\mathcal{L}_{\\text{Langevin},1} = \\frac{1}{2}(\\frac{d^2}{dx^2} - x\\frac{d}{dx})$ 是 Langevin SDE $dX_t = -\\frac{1}{2}X_t dt + dW_t$ 的生成元，其不变分布为 $\\mathcal{N}(0,1)$。前置因子 $c(\\ell)$ 表示极限过程的速度。\n\n$\\mathcal{L}_{\\text{Langevin},1}$ 的谱隙是 $1/2$。因此，极限过程的谱隙是 $c(\\ell)/2$。时间尺度调整意味着离散链的一步对应于连续过程的时间间隔 $\\Delta t = 1/d$。离散和连续谱隙之间的关系是 $\\lambda_2 \\approx \\exp(-\\text{Gap}(\\mathcal{L}_{\\text{lim}})\\Delta t)$，因此：\n$$\n\\gamma_d \\approx \\frac{\\text{Gap}(\\mathcal{L}_{\\text{lim}})}{d} = \\frac{c(\\ell)}{2d}\n$$\n速度函数 $c(\\ell)$ 由离散链的性质决定。它由 $c(\\ell) = \\ell^2 A(\\ell)$ 给出。该量表示单个维度中经过 $d$ 重缩放的提议步长的平方，再乘以接受该步的概率。\n$$\n\\gamma_d \\approx \\frac{\\ell^2 A(\\ell)}{2d} = \\frac{\\ell^2 \\cdot 2\\Phi(-\\ell/2)}{2d} = \\frac{\\ell^2 \\Phi(-\\ell/2)}{d}\n$$\n\n**3. 优化**\n\n为了最大化收敛速率，我们必须最大化谱隙 $\\gamma_d$。由于 $d$ 是一个固定（尽管很大）的维度，这等价于关于 $\\ell$ 最大化函数 $I(\\ell) = \\ell^2 \\Phi(-\\ell/2)$。我们计算其导数并令其为零：\n$$\n\\frac{dI}{d\\ell} = 2\\ell \\Phi(-\\ell/2) + \\ell^2 \\phi(-\\ell/2) \\cdot \\left(-\\frac{1}{2}\\right) = 0\n$$\n其中 $\\phi(\\cdot)$ 是标准正态概率密度函数。对于 $\\ell  0$，我们可以除以 $\\ell$：\n$$\n2\\Phi(-\\ell/2) - \\frac{\\ell}{2}\\phi(-\\ell/2) = 0\n$$\n由于 $\\phi$ 是偶函数，$\\phi(-x)=\\phi(x)$。令 $x = \\ell/2$。方程变为：\n$$\n2\\Phi(-x) = x\\phi(x)\n$$\n这个超越方程没有闭式解析解，必须进行数值求解。已知对于 $x0$ 的数值解为 $x_{\\text{opt}} \\approx 1.1907$。\n\n因此，$\\ell$ 的最优值为 $\\ell_{\\text{opt}} = 2x_{\\text{opt}} \\approx 2 \\times 1.1907 = 2.3814$。\n将此最优 $\\ell$ 代入尺度调整规则，即可得到最优提议标准差 $\\sigma_{\\text{opt}}(d)$：\n$$\n\\sigma_{\\text{opt}}(d) = \\frac{\\ell_{\\text{opt}}}{\\sqrt{d}} \\approx \\frac{2.3814}{\\sqrt{d}}\n$$\n\n**4. 最终结果**\n\n将系数 $\\ell_{\\text{opt}}$ 四舍五入至三位有效数字，得到 $2.38$。作为维度 $d$ 函数的最优提议标准差为：\n$$\n\\sigma_{\\text{opt}}(d) = \\frac{2.38}{\\sqrt{d}}\n$$\n这一结果表明，对于高维高斯目标分布，提议方差 $\\sigma^2$ 应按 $1/d$ 的比例进行缩放，并采用一个特定的比例常数以最大化算法效率。相应的最优接受率为 $A(\\ell_{\\text{opt}}) = 2\\Phi(-x_{\\text{opt}}) \\approx 2\\Phi(-1.1907) \\approx 0.234$。",
            "answer": "$$\n\\boxed{\\frac{2.38}{\\sqrt{d}}}\n$$"
        }
    ]
}