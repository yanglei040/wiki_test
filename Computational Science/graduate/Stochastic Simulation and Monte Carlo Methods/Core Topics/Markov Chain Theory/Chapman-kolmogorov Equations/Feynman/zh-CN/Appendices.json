{
    "hands_on_practices": [
        {
            "introduction": "Chapman-Kolmogorov 方程是理解马尔可夫过程多步演化的基石。第一个练习  提供了一个具体而直观的情景——学生的注意力状态转移，用以演示如何从单步转移矩阵计算未来状态的概率。这是一个应用离散形式 Chapman-Kolmogorov 方程的基础性练习，旨在帮助你掌握其核心计算方法。",
            "id": "1347960",
            "problem": "一位认知科学家使用离散时间随机过程来模拟学生在讲座期间的注意力水平。在任何给定时刻，学生可以处于以下三种状态之一：状态 1 (专注)，状态 2 (分心) 或 状态 3 (走神)。这些状态之间的转换是在固定的 5 分钟间隔内观察到的。一步转移概率 $P_{ij}$ 表示在一次 5 分钟的间隔内从状态 $i$ 转移到状态 $j$ 的概率，其具体数值如下：\n\n-   一名专注（状态 1）的学生有 0.6 的概率保持专注，0.3 的概率变得分心，以及 0.1 的概率开始走神。\n-   一名分心（状态 2）的学生有 0.4 的概率变得专注，0.4 的概率保持分心，以及 0.2 的概率开始走神。\n-   一名走神（状态 3）的学生有 0.1 的概率变得专注，0.5 的概率变得分心，以及 0.4 的概率保持走神状态。\n\n假设在观察开始时（时间 $t=0$），一名学生处于专注状态。那么，在两个 5 分钟间隔后（即时间 $t=10$ 分钟时），该学生处于走神状态的概率是多少？\n\n将您的最终答案四舍五入到三位有效数字。",
            "solution": "我们将学生的注意力建模为一个时间齐次的离散时间马尔可夫链，其状态空间为 $\\{1,2,3\\}$，分别对应专注、分心和走神。一步转移矩阵 $P=\\left(P_{ij}\\right)$，其中行表示当前状态，列表示下一个状态，其形式为\n$$\nP=\\begin{pmatrix}\n0.6 & 0.3 & 0.1\\\\\n0.4 & 0.4 & 0.2\\\\\n0.1 & 0.5 & 0.4\n\\end{pmatrix}.\n$$\n根据查普曼-科尔莫戈罗夫方程，两步转移概率由 $P^{(2)}=P^{2}$ 给出。具体来说，从状态1经过两步到达状态3的概率 $P^{(2)}_{13}$ 是矩阵 $P^2$ 的 (1,3) 元素，它等于 $P$ 的第一行与第三列的点积：\n$$\nP^{(2)}_{13}=\\sum_{k=1}^{3}P_{1k}P_{k3}.\n$$\n由于学生在 $t=0$ 时从状态 1 开始，因此在两步之后（在 $t=10$ 分钟时）处于状态 3 的概率是 $P^{(2)}_{13}$。逐项计算，\n$$\nP^{(2)}_{13}=P_{11}P_{13}+P_{12}P_{23}+P_{13}P_{33}\n=0.6\\cdot 0.1+0.3\\cdot 0.2+0.1\\cdot 0.4\n=0.06+0.06+0.04\n=0.16.\n$$\n四舍五入到三位有效数字得到 $0.160$。",
            "answer": "$$\\boxed{0.160}$$"
        },
        {
            "introduction": "Chapman-Kolmogorov 方程不仅是一个计算工具，更是一个深刻的自洽性约束，它决定了随机过程的基本形态。这个练习  挑战我们将关注点从计算转向推导。通过要求一个普遍的高斯过程必须满足该方程，我们将揭示其一个深刻且本质的属性：过程的方差必须随时间线性增长，这是扩散过程的标志性特征。",
            "id": "731491",
            "problem": "一个一维、时间齐次、中心化（无漂移）的马尔可夫随机过程由其转移概率密度 $P(x_f, t_f | x_i, t_i) = P(x_f | x_i; \\tau)$ 来表征，其中 $\\tau = t_f - t_i > 0$。对于任何满足 $t_i < t_m < t_f$ 的中间时刻 $t_m$，该密度必须满足查普曼-柯尔莫哥洛夫方程：\n$$ P(x_f | x_i; t_f - t_i) = \\int_{-\\infty}^{\\infty} P(x_f | x_m; t_f - t_m) P(x_m | x_i; t_m - t_i) \\, dx_m $$\n考虑此类过程的一个族，其转移核为高斯形式：\n$$ P(x_f | x_i; \\tau) = \\frac{1}{\\sqrt{2\\pi V(\\tau)}} \\exp\\left(-\\frac{(x_f - x_i)^2}{2V(\\tau)}\\right) $$\n此处，$V(\\tau)$ 是在时间间隔 $\\tau$ 内位移的方差。对于 $\\tau > 0$，它是一个未知的正连续函数，并且我们知道当 $\\tau \\to 0$ 时，$V(\\tau) \\to 0$。通过要求此高斯形式对所有时间间隔都一致地满足查普曼-柯尔莫哥洛夫方程，推导出对于 $t > 0$ 时 $V(t)$ 的一般函数形式。请用一个任意正常数 $D$ 来表示你的答案。",
            "solution": "1.  我们将时间间隔设为 $\\tau_1 = t_m - t_i$ 和 $\\tau_2 = t_f - t_m$。查普曼-柯尔莫哥洛夫方程指出，时间 $\\tau_1 + \\tau_2$ 内从 $x_i$ 到 $x_f$ 的总概率密度，是通过对所有可能的中间位置 $x_m$ 进行积分得到的。\n    $$P(x_f|x_i;\\tau_1+\\tau_2)\n    =\\int_{-\\infty}^\\infty P(x_f|x_m;\\tau_2)\\,P(x_m|x_i;\\tau_1)\\,dx_m.$$\n2.  该积分表示两个高斯概率密度的卷积。第一个高斯分布描述了从 $x_i$ 到 $x_m$ 的位移，其均值为0，方差为 $V(\\tau_1)$。第二个高斯分布描述了从 $x_m$ 到 $x_f$ 的位移，其均值为0，方差为 $V(\\tau_2)$。两个独立高斯随机变量之和的分布是另一个高斯分布，其均值是两个均值之和，方差是两个方差之和。因此，卷积的结果是一个均值为0，方差为 $V(\\tau_1) + V(\\tau_2)$ 的高斯分布。\n3.  将此结果与方程左侧的 $P(x_f|x_i;\\tau_1+\\tau_2)$（一个方差为 $V(\\tau_1+\\tau_2)$ 的高斯分布）进行比较，我们必须有方差相等：\n    $$V(\\tau_1+\\tau_2)=V(\\tau_1)+V(\\tau_2).$$\n4.  这是一个著名的柯西函数方程。对于一个在 $\\tau > 0$ 上连续且满足 $V(\\tau) \\to 0$ 作为 $\\tau \\to 0$ 的函数，该方程的唯一解是线性形式。因此，存在一个正常数 $a$，使得：\n    $$V(t)=a\\,t, \\quad \\text{for } t>0.$$\n    按照题意，我们将这个比例常数表示为 $D$（通常代表扩散系数），得到最终形式：\n    $$V(t)=D t.$$",
            "answer": "$$\\boxed{Dt}$$"
        },
        {
            "introduction": "在现代科学与金融领域，Chapman-Kolmogorov 方程在复杂模拟的设计与验证中扮演着核心角色。这个高级练习  以 Ornstein-Uhlenbeck 过程——一个用于模拟均值回归系统的基石模型——为例，阐释了理论与实践的联系。它将引导我们设计一个基于马尔可夫性质的模拟方案（祖先采样），并进而分析模拟输出的统计特性，从而展示该方程在算法设计和数据分析中的双重作用。",
            "id": "3293504",
            "problem": "考虑由随机微分方程(SDE) $dX_{u}=-\\theta\\,(X_{u}-\\mu)\\,du+\\sigma\\,dW_{u}$（其中 $u\\geq 0$，$X_{0}=x_{0}$，$\\theta>0$，$\\sigma>0$，$\\mu\\in\\mathbb{R}$，且 $W_{u}$ 为标准布朗运动 (BM)）定义的一维Ornstein–Uhlenbeck (OU) 扩散。令 $0<t_1<\\dots<t_N=t$ 为固定的时间点。\n1.  **转移密度**：推导从 $(x_0, 0)$ 到 $(x, t)$ 的转移概率密度 $p(x,t|x_0,0)$。\n2.  **模拟方案**：基于马尔可夫性质，设计一个“祖先采样”方案，从 $p(x_{t_1}, \\dots, x_{t_N}|x_0)$ 中生成一个轨迹 $(X_{t_1}, \\dots, X_{t_N})$。\n3.  **统计分析**：假设我们从该过程中生成了 $M$ 个独立的样本 $X_t^{(1)}, \\dots, X_t^{(M)}$。我们使用带有高斯核 $K(z)=(2\\pi)^{-1/2}e^{-z^2/2}$ 和最优带宽 $h=cN^{-1/5}$ 的核密度估计器 (KDE) 来估计 $t$ 时刻的密度。求此估计器在点 $x$ 处的渐近偏差 (asymptotic bias) 的表达式。",
            "solution": "该问题分为三个部分：推导OU过程的转移密度，设计模拟方案，以及计算KDE的渐近偏差。\n\n### 第1部分：转移密度的推导\n\nOrnstein–Uhlenbeck (OU) 过程由以下线性SDE描述：\n$$dX_{u} = -\\theta(X_{u} - \\mu)du + \\sigma dW_{u}, \\quad X_0=x_0$$\n为求解该方程，我们对 $e^{\\theta u}(X_u-\\mu)$ 应用伊藤引理（Itô's Lemma）：\n$$d(e^{\\theta u}(X_u-\\mu)) = \\theta e^{\\theta u}(X_u-\\mu)du + e^{\\theta u}dX_u = \\theta e^{\\theta u}(X_u-\\mu)du + e^{\\theta u}(-\\theta(X_u-\\mu)du + \\sigma dW_u) = \\sigma e^{\\theta u}dW_u$$\n从时间0到 $t$ 积分：\n$$e^{\\theta t}(X_t-\\mu) - e^0(X_0-x_0) = \\int_0^t \\sigma e^{\\theta u}dW_u$$\n$$X_t - \\mu = e^{-\\theta t}(x_0-\\mu) + \\sigma \\int_0^t e^{-\\theta(t-u)}dW_u$$\n给定 $X_0=x_0$，$X_t$ 是一个高斯随机变量，因为它是常数加上一个伊藤积分（高斯过程）。\n其条件均值为：\n$$m(t) = \\mathbb{E}[X_t|X_0=x_0] = \\mu + (x_0-\\mu)e^{-\\theta t}$$\n其条件方差为（使用伊藤等距性质）：\n$$V(t) = \\text{Var}(X_t|X_0=x_0) = \\sigma^2 \\text{Var}\\left(\\int_0^t e^{-\\theta(t-u)}dW_u\\right) = \\sigma^2 \\int_0^t e^{-2\\theta(t-u)}du = \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t})$$\n因此，转移概率密度 $p(x,t|x_0,0)$ 是正态分布 $N(m(t), V(t))$ 的概率密度函数：\n$$p(x,t|x_0,0) = \\frac{1}{\\sqrt{2\\pi V(t)}} \\exp\\left(-\\frac{(x-m(t))^2}{2V(t)}\\right)$$\n\n### 第2部分：模拟方案的设计\n\n由于OU过程是马尔可夫过程，一个轨迹的联合概率密度可以分解为一系列条件概率的乘积：\n$$p(x_{t_1}, \\dots, x_{t_N}|x_0) = p(x_{t_N}|x_{t_{N-1}}) \\dots p(x_{t_2}|x_{t_1})p(x_{t_1}|x_0)$$\n这启发了以下“祖先采样”算法：\n1.  **初始化**：令 $X_0 = x_0$。\n2.  **迭代**：对于 $k=1, \\dots, N$：\n    a. 计算从 $X_{t_{k-1}}$ 到时间 $t_k$ 的转移分布的参数。时间间隔为 $\\Delta t_k = t_k - t_{k-1}$。\n    b. 均值：$m_k = \\mu + (X_{t_{k-1}}-\\mu)e^{-\\theta \\Delta t_k}$。\n    c. 方差：$V_k = \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta \\Delta t_k})$。\n    d. 从正态分布 $N(m_k, V_k)$ 中抽取一个样本，并将其设为 $X_{t_k}$。\n3.  **输出**：返回序列 $(X_{t_1}, \\dots, X_{t_N})$。\n\n### 第3部分：KDE偏差的推导\n\n核密度估计器在点 $x$ 的渐近偏差由下式给出：\n$$\\text{Bias}(\\hat{f}_h(x)) \\approx \\frac{1}{2}h^2 f''(x) \\int z^2 K(z)dz$$\n对于高斯核 $K(z)$，$\\int z^2 K(z)dz = 1$。因此，偏差为 $\\frac{1}{2}h^2 f''(x)$，其中 $f(x) = p(x,t|x_0,0)$。\n我们需要计算 $f(x)$ 的二阶导数。为简化符号，令 $m=m(t)$ 和 $V=V(t)$。\n$$f(x) = (2\\pi V)^{-1/2} \\exp\\left(-\\frac{(x-m)^2}{2V}\\right)$$\n一阶导数：\n$$f'(x) = f(x) \\cdot \\left(-\\frac{x-m}{V}\\right)$$\n二阶导数（使用乘积法则）：\n$$f''(x) = f'(x) \\cdot \\left(-\\frac{x-m}{V}\\right) + f(x) \\cdot \\left(-\\frac{1}{V}\\right) = f(x)\\left(\\frac{(x-m)^2}{V^2} - \\frac{1}{V}\\right) = \\frac{f(x)}{V^2}\\left((x-m)^2 - V\\right)$$\n将 $h = cM^{-1/5}$（题目使用$N$作为时间步数，$M$作为样本数，但意图应为样本数）代入偏差公式，我们得到：\n$$\\text{Bias}(\\hat{f}_h(x)) \\approx \\frac{1}{2} (cM^{-1/5})^2 \\frac{f(x)}{V^2}\\left((x-m)^2 - V\\right)$$\n$$= \\frac{c^2 M^{-2/5}}{2} \\frac{(x-m)^2 - V}{V^2} \\frac{1}{\\sqrt{2\\pi V}} \\exp\\left(-\\frac{(x-m)^2}{2V}\\right)$$\n将 $m=m(t)$ 和 $V=V(t)$ 的表达式代回，即得到答案中给出的公式。",
            "answer": "$$ \\boxed{ \\frac{c^2 M^{-2/5}}{2} \\frac{(x - (\\mu + (x_0-\\mu)e^{-\\theta t}))^2 - \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t})}{(\\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t}))^2} \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t})}} \\exp\\left(-\\frac{(x-(\\mu + (x_0-\\mu)e^{-\\theta t}))^2}{2 \\frac{\\sigma^2}{2\\theta}(1-e^{-2\\theta t})}\\right) } $$"
        }
    ]
}