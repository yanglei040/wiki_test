{
    "hands_on_practices": [
        {
            "introduction": "理解马尔可夫链如何随时间演化是掌握其理论的第一步。本练习通过一个基础的高斯随机游走模型，直观地展示了链的状态分布如何通过转移核的重复应用而扩展。通过从基本定义出发推导第 $n$ 步的分布、均值和方差，您将深入理解查普曼-科尔莫戈罗夫方程的实际应用，并体会到链的不确定性是如何随时间累积的 。",
            "id": "3319838",
            "problem": "考虑一个在 $\\mathbb{R}$ 上的时间齐次马尔可夫链 $\\{X_{n}\\}_{n \\geq 0}$，其转移核为 $P(x, \\cdot) = \\mathcal{N}(x, \\sigma^{2})$，其中 $\\sigma^{2} \\in (0, \\infty)$ 是一个固定的常数，且具有确定性初始化 $X_{0} = x_{0} \\in \\mathbb{R}$。也就是说，对于每个 $n \\in \\mathbb{N}$ 和每个博雷尔集 $A \\subset \\mathbb{R}$，其单步转移概率满足 $P(x, A) = \\int_{A} \\varphi_{\\sigma}(y - x) \\, dy$，其中 $\\varphi_{\\sigma}(u) = (2 \\pi \\sigma^{2})^{-1/2} \\exp\\!\\big(-u^{2}/(2 \\sigma^{2})\\big)$。仅从时间齐次马尔可夫链的基本定义、Chapman–Kolmogorov 方程以及关于正态分布和独立随机变量卷积的基本事实出发，推导 $P^{n}(x_{0}, \\cdot)$ 下 $X_{n}$ 的 $n$ 步律，确定其分布的闭式形式，并用 $x_{0}$、$n$ 和 $\\sigma^{2}$ 表示其均值和方差。\n\n你最终报告的答案必须是序偶 $\\big(\\mathbb{E}[X_{n}], \\operatorname{Var}(X_{n})\\big)$，并使用 $\\mathrm{pmatrix}$ 环境写成单行矩阵的形式。最终答案中不要包含分布形式；请在推导过程中提供。无需四舍五入。请使用精确的符号量 $x_{0}$、$n$ 和 $\\sigma^{2}$ 表示最终答案。",
            "solution": "我们从 $\\mathbb{R}$ 上具有转移核 $P(x, \\cdot)$ 的时间齐次马尔可夫链的定义开始。该链满足，对于所有 $n \\in \\mathbb{N}$、所有有界可测函数 $f$ 以及所有 $x \\in \\mathbb{R}$，\n$$\n\\mathbb{E}\\!\\left[f(X_{n+1}) \\mid X_{n} = x \\right] \\equiv \\int_{\\mathbb{R}} f(y) \\, P(x, dy).\n$$\n这里的核是 $P(x, \\cdot) = \\mathcal{N}(x, \\sigma^{2})$，这意味着在给定 $X_{n} = x$ 的条件下，下一个状态 $X_{n+1}$ 服从均值为 $x$、方差为 $\\sigma^{2}$ 的正态分布。等价地，我们可以通过引入一个独立同分布的序列 $\\{Z_{k}\\}_{k \\geq 1}$ 来实现这个动态过程，其中 $Z_{k} \\sim \\mathcal{N}(0, \\sigma^{2})$，且独立于 $X_{0}$，并写出\n$$\nX_{n+1} = X_{n} + Z_{n+1}, \\quad n \\geq 0.\n$$\n这个表示与 $P(x, \\cdot)$ 是一致的，因为对于任何博雷尔集 $A \\subset \\mathbb{R}$，\n$$\n\\mathbb{P}\\!\\left(X_{n+1} \\in A \\mid X_{n} = x \\right) = \\mathbb{P}\\!\\left(x + Z_{n+1} \\in A \\right) = \\int_{A} \\varphi_{\\sigma}(y - x) \\, dy = P(x, A),\n$$\n其中 $\\varphi_{\\sigma}(u) = (2 \\pi \\sigma^{2})^{-1/2} \\exp\\!\\big(-u^{2}/(2 \\sigma^{2})\\big)$ 是均值为 $0$、方差为 $\\sigma^{2}$ 的正态密度函数。\n\n迭代更新过程表明，对于任何 $n \\in \\mathbb{N}$，\n$$\nX_{n} = X_{0} + \\sum_{k=1}^{n} Z_{k} = x_{0} + \\sum_{k=1}^{n} Z_{k}.\n$$\n由于 $\\{Z_{k}\\}_{k \\geq 1}$ 是独立的，且每个 $Z_{k} \\sim \\mathcal{N}(0, \\sigma^{2})$，它们的和 $\\sum_{k=1}^{n} Z_{k}$ 服从均值为 $0$、方差为 $n \\sigma^{2}$ 的正态分布。有几种等价的基本方法可以证明这一点：\n\n- 独立正态分布的卷积：$\\mathcal{N}(0, \\sigma^{2})$ 与自身的 $n$ 次卷积是 $\\mathcal{N}(0, n \\sigma^{2})$。\n\n- 特征函数：$Z_{k}$ 的特征函数是 $\\phi_{Z}(t) = \\mathbb{E}[\\exp(i t Z_{k})] = \\exp\\!\\big(-\\tfrac{1}{2} \\sigma^{2} t^{2}\\big)$，对于 $t \\in \\mathbb{R}$。由独立性可得\n$$\n\\phi_{\\sum_{k=1}^{n} Z_{k}}(t) = \\prod_{k=1}^{n} \\phi_{Z}(t) = \\left(\\exp\\!\\big(-\\tfrac{1}{2} \\sigma^{2} t^{2}\\big)\\right)^{n} = \\exp\\!\\big(-\\tfrac{1}{2} n \\sigma^{2} t^{2}\\big),\n$$\n这是 $\\mathcal{N}(0, n \\sigma^{2})$ 的特征函数。\n\n加上常数位移 $x_{0}$ 会使分布平移 $x_{0}$。因此 $X_{n}$ 的法则是\n$$\nX_{n} \\sim \\mathcal{N}\\!\\big(x_{0}, \\, n \\sigma^{2}\\big).\n$$\n这确定了 $n$ 步转移核为\n$$\nP^{n}(x_{0}, \\cdot) = \\mathcal{N}\\!\\big(x_{0}, \\, n \\sigma^{2}\\big),\n$$\n这也可以通过将单步核与自身进行 $n$ 重卷积，从 Chapman–Kolmogorov 方程推导得出。\n\n从已确定的分布中，均值和方差可以立即得出：\n$$\n\\mathbb{E}[X_{n}] = x_{0}, \\qquad \\operatorname{Var}(X_{n}) = n \\sigma^{2}.\n$$\n这些公式与 $n=0$ 的基例一致，此时 $X_{0}=x_{0}$ 是一个方差为 $0$ 的退化分布，并且它们满足了由 $n$ 个方差均为 $\\sigma^{2}$ 的独立增量之和所预期的方差可加性增长。\n\n因此，所求的序偶 $\\big(\\mathbb{E}[X_{n}], \\operatorname{Var}(X_{n})\\big)$ 是 $\\big(x_{0}, \\, n \\sigma^{2}\\big)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} x_{0} & n \\sigma^{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在 MCMC 方法中，我们的核心目标是构造一个马尔可夫链，使其平稳分布是我们想要采样的目标分布。这个练习将带您实践如何通过细致平衡条件（detailed balance condition）来推导一个链的不变测度，这是构建如 Metropolis-Hastings 等诸多 MCMC 算法的基石。通过分析一个具体的生灭过程，您不仅能掌握不变测度的求解方法，还将探讨其何时能构成一个合法的概率分布 。",
            "id": "3319836",
            "problem": "考虑一个在可数状态空间 $\\{0,1,2,\\dots\\}$ 上的离散时间生灭马尔可夫链，它在马尔可夫链蒙特卡洛 (MCMC) 算法中用作提议核。其转移概率为最近邻转移，并满足 $P(i,i+1)=\\lambda_{i}$，$P(i,i-1)=\\mu_{i}$ (对于 $i\\geq 1$)，以及 $P(0,1)=\\lambda_{0}$，$P(0,0)=1-\\lambda_{0}$。假设参数化族为\n$$\n\\lambda_{i}=p \\quad \\text{对所有 } i\\geq 0, \\qquad \\mu_{0}=0, \\qquad \\mu_{i}=q\\,\\frac{i}{i+1} \\quad \\text{对 } i\\geq 1,\n$$\n其中 $p,q\\in(0,1)$ 满足 $p+q \\le 1$ 以确保对所有 $i$ 都有 $P(i,i)\\geq 0$。从马尔可夫链不变测度的定义出发，推导该链的一个不变测度（不计归一化常数），并精确确定对于参数 $p$ 和 $q$ 的哪些值，该不变测度是可和的（即，在归一化后定义了一个正则概率分布）。\n\n最后，计算归一化常数的闭式解析表达式\n$$\nS(p,q)=\\sum_{i=0}^{\\infty} w_{i},\n$$\n其中 $(w_{i})_{i\\geq 0}$ 是你推导出的不变测度（不计归一化常数）。你的最终答案必须是 $S(p,q)$ 的单一解析表达式。不需要四舍五入，也不涉及物理单位。",
            "solution": "对于一个在状态空间 $S$ 上、转移矩阵为 $P$ 的马尔可夫链，其不变测度 $(w_i)_{i\\geq 0}$ 是一组满足全局平衡方程 $w = wP$ 的非负数。写成分量形式，即对每个状态 $k \\in S$ 都有 $w_k = \\sum_{j \\in S} w_j P(j,k)$。对于生灭过程（一种转移仅限于最近邻的整数上的特殊类型马尔可夫链），一个测度成为不变测度的充分条件是它满足细致平衡方程：\n$$\nw_i P(i, j) = w_j P(j, i) \\quad \\text{ 对于所有相邻状态 } i, j.\n$$\n在这个问题中，状态空间是 $S = \\{\\,0, 1, 2, \\dots\\,\\}$，且唯一允许的转移发生在 $i$ 和 $i+1$ 之间。因此，细致平衡方程的形式为：\n$$\nw_i P(i, i+1) = w_{i+1} P(i+1, i) \\quad \\text{对于所有 } i \\geq 0.\n$$\n这些方程是充分的，因为它们蕴含了全局平衡方程。对于任意状态 $i \\ge 1$，全局平衡方程为 $w_i = w_{i-1}P(i-1,i) + w_i P(i,i) + w_{i+1}P(i+1,i)$。利用概率和为一的事实，即 $P(i,i) = 1 - P(i,i-1) - P(i,i+1)$，上式可简化为 $w_i(P(i,i-1) + P(i,i+1)) = w_{i-1}P(i-1,i) + w_{i+1}P(i+1,i)$。对于状态对 $(i-1, i)$ 的细致平衡条件是 $w_{i-1}P(i-1,i) = w_i P(i, i-1)$。将此代入简化的全局平衡方程，得到 $w_i P(i,i+1) = w_{i+1}P(i+1,i)$，这正是状态对 $(i, i+1)$ 的细致平衡条件。对于状态 $i=0$，全局平衡方程为 $w_0 = w_0 P(0,0) + w_1 P(1,0)$。这可以简化为 $w_0(1-P(0,0)) = w_1 P(1,0)$，即 $w_0 P(0,1) = w_1 P(1,0)$，这恰好是状态对 $(0,1)$ 的细致平衡方程。因此，解细致平衡方程就足够了。\n\n使用问题中的记号 $\\lambda_i = P(i,i+1)$ 和 $\\mu_i = P(i,i-1)$，细致平衡方程变为 $w_i \\lambda_i = w_{i+1} \\mu_{i+1}$ (对于 $i \\geq 0$）。这给出了不变测度各分量的递推关系：\n$$\nw_{i+1} = w_i \\frac{\\lambda_i}{\\mu_{i+1}} \\quad \\text{对于 } i \\geq 0.\n$$\n问题定义了转移参数为 $\\lambda_i = p$ (对所有 $i \\ge 0$)，以及 $\\mu_i = q\\,\\frac{i}{i+1}$ (对 $i \\ge 1$)。我们有 $\\mu_0=0$。\n我们可以迭代求解 $w_i$。为求得该测度（不计乘法常数），我们设 $w_0 = 1$。\n对于 $i=0$: $w_1 = w_0 \\frac{\\lambda_0}{\\mu_1} = 1 \\cdot \\frac{p}{q\\,\\frac{1}{1+1}} = \\frac{p}{q/2} = 2 \\frac{p}{q}$。\n对于 $i=1$: $w_2 = w_1 \\frac{\\lambda_1}{\\mu_2} = \\left(2 \\frac{p}{q}\\right) \\frac{p}{q\\,\\frac{2}{2+1}} = \\left(2 \\frac{p}{q}\\right) \\frac{3p}{2q} = 3 \\left(\\frac{p}{q}\\right)^2$。\n对于 $i=2$: $w_3 = w_2 \\frac{\\lambda_2}{\\mu_3} = \\left(3 \\left(\\frac{p}{q}\\right)^2\\right) \\frac{p}{q\\,\\frac{3}{3+1}} = \\left(3 \\left(\\frac{p}{q}\\right)^2\\right) \\frac{4p}{3q} = 4 \\left(\\frac{p}{q}\\right)^3$。\n出现的规律表明其一般形式为 $w_i = (i+1) \\left(\\frac{p}{q}\\right)^i$ (对于 $i \\ge 0$）。我们可以用数学归纳法来验证这个公式。基础情形 $i=0$ 给出 $w_0 = (0+1)\\left(\\frac{p}{q}\\right)^0 = 1$，这与我们的初始选择相符。\n假设该公式对索引 $i$ 成立。对于索引 $i+1$，递推关系给出：\n$$\nw_{i+1} = w_i \\frac{\\lambda_i}{\\mu_{i+1}} = \\left((i+1) \\left(\\frac{p}{q}\\right)^i\\right) \\frac{p}{q\\frac{i+1}{i+2}} = (i+1) \\left(\\frac{p}{q}\\right)^i \\frac{p}{q} \\frac{i+2}{i+1} = (i+2) \\left(\\frac{p}{q}\\right)^{i+1}.\n$$\n这正是索引 $i+1$ 的猜想公式。因此，通过归纳法，未归一化的不变测度为 $w_i = C \\cdot (i+1) \\left(\\frac{p}{q}\\right)^i$，其中 $C$ 是任意常数。在后续计算中，我们取 $C=1$。\n\n要使该不变测度是可和的（这是其在归一化后能对应于一个正则平稳概率分布的条件），级数 $S(p,q) = \\sum_{i=0}^{\\infty} w_i$ 必须收敛。\n$$\nS(p,q) = \\sum_{i=0}^{\\infty} (i+1) \\left(\\frac{p}{q}\\right)^i.\n$$\n令 $x = p/q$。该级数是一个算术几何级数，$\\sum_{i=0}^{\\infty} (i+1) x^i$。这种形式的幂级数收敛当且仅当 $|x|1$。因为问题指明 $p, q \\in (0,1)$，我们有 $x = p/q > 0$。因此，收敛条件为 $x  1$，即 $p/q  1$，或 $p  q$。\n\n当 $p  q$ 时，我们计算和 $S(p,q)$。我们知道对于 $|x|  1$，有几何级数公式 $\\sum_{i=0}^{\\infty} x^i = \\frac{1}{1-x}$。对这个等式两边关于 $x$ 求导，我们得到\n$$\n\\frac{d}{dx} \\sum_{i=0}^{\\infty} x^i = \\sum_{i=1}^{\\infty} i x^{i-1} = \\frac{1}{(1-x)^2}.\n$$\n我们想要计算的级数与此密切相关。令 $j = i+1$，我们的级数为 $\\sum_{j=1}^{\\infty} j x^{j-1}$。这正是上面求导的结果。\n因此，\n$$\nS(p,q) = \\sum_{i=0}^{\\infty} (i+1) \\left(\\frac{p}{q}\\right)^i = \\frac{1}{\\left(1 - \\frac{p}{q}\\right)^2}.\n$$\n将表达式化简：\n$$\nS(p,q) = \\frac{1}{\\left(\\frac{q-p}{q}\\right)^2} = \\frac{q^2}{(q-p)^2}.\n$$\n所以，不变测度是可和的当且仅当 $p  q$，在这种情况下，归一化常数为 $S(p,q) = \\frac{q^2}{(q-p)^2}$。",
            "answer": "$$\\boxed{\\frac{q^2}{(q-p)^2}}$$"
        },
        {
            "introduction": "一旦我们构建了一个收敛到目标分布的马尔可夫链，下一个关键问题便是评估其效率。这个练习将理论与计算相结合，指导您利用可逆链的谱理论来精确计算 MCMC 估计量的渐近方差。通过在一个简单的二状态模型上完成这一计算，您将具体地看到链的特征值（混合速度的体现）如何直接决定我们通过模拟所得结果的统计精度 。",
            "id": "3319839",
            "problem": "考虑一个时间齐次、不可约、非周期的马尔可夫链，其状态空间为有限集 $\\mathcal{X}$，转移核为 $P(x,y)$，平稳分布为 $\\pi$。假设 $P$ 相对于 $\\pi$ 是可逆的，即 $P$ 满足细致平衡条件：对于所有 $x,y \\in \\mathcal{X}$，有 $\\pi(x) P(x,y) = \\pi(y) P(y,x)$。令 $P$ 通过 $(P g)(x) = \\sum_{y \\in \\mathcal{X}} P(x,y) g(y)$ 作用于 $L^{2}(\\pi)$，并定义 $L^{2}(\\pi)$ 内积为 $\\langle g, h \\rangle_{\\pi} = \\sum_{x \\in \\mathcal{X}} \\pi(x) g(x) h(x)$。对于一个可测函数 $f : \\mathcal{X} \\to \\mathbb{R}$，其期望 $\\mathbb{E}_{\\pi}[f] = \\sum_{x \\in \\mathcal{X}} \\pi(x) f(x)$ 有限，考虑遍历均值 $\\bar{f}_{n} = \\frac{1}{n} \\sum_{t=1}^{n} f(X_{t})$，其中 $(X_{t})$ 是从平稳状态开始、转移核为 $P$ 的马尔可夫链。\n\n假设马尔可夫链的中心极限定理适用于 $f$，使得 $\\sqrt{n}(\\bar{f}_{n} - \\mathbb{E}_{\\pi}[f])$ 依分布收敛于一个中心正态随机变量，其渐近方差为 $\\sigma^{2}_{f}$。从上述定义出发，仅使用关于 Hilbert 空间上的自伴线性算子和谱测度的基础事实，推导 $\\sigma^{2}_{f}$ 的一个表达式，该表达式用与 $P$ 相关的谱测度和中心化函数 $g = f - \\mathbb{E}_{\\pi}[f]$ 来表示。\n\n然后，将问题具体化到一个两状态可逆链 $\\mathcal{X} = \\{0,1\\}$，其转移矩阵为\n$$\nP = \\begin{pmatrix}\n1 - \\alpha  \\alpha \\\\\n\\beta  1 - \\beta\n\\end{pmatrix},\n$$\n其中 $\\alpha \\in (0,1)$ 且 $\\beta \\in (0,1)$，因此平稳分布为 $\\pi(0) = \\frac{\\beta}{\\alpha + \\beta}$ 和 $\\pi(1) = \\frac{\\alpha}{\\alpha + \\beta}$。令 $f(0) = u$ 和 $f(1) = v$，其中 $u, v \\in \\mathbb{R}$。计算 $\\bar{f}_{n}$ 的渐近方差 $\\sigma^{2}_{f}$ 的一个闭式表达式，该表达式是 $\\alpha$、$\\beta$、$u$ 和 $v$ 的函数。将最终答案表示为单个解析表达式。如果进行任何中间简化，请确保所有步骤对 $\\alpha \\in (0,1)$ 和 $\\beta \\in (0,1)$ 均有效。",
            "solution": "### 第一部分：渐近方差的谱形式推导\n\n遍历均值 $\\bar{f}_n$ 的渐近方差由自协方差之和给出：\n$$ \\sigma_f^2 = \\sum_{k=-\\infty}^{\\infty} \\text{Cov}_{\\pi}(f(X_0), f(X_k)) $$\n由于链是平稳的，$\\text{Cov}_{\\pi}(f(X_0), f(X_k)) = \\text{Cov}_{\\pi}(f(X_0), f(X_{-k}))$，所以我们可以写成：\n$$ \\sigma_f^2 = \\text{Var}_{\\pi}(f(X_0)) + 2 \\sum_{k=1}^{\\infty} \\text{Cov}_{\\pi}(f(X_0), f(X_k)) $$\n令 $g = f - \\mathbb{E}_{\\pi}[f]$ 为中心化函数。我们有 $\\mathbb{E}_{\\pi}[g] = 0$，所以 $\\sigma_f^2 = \\sigma_g^2$。方差和协方差项可以用 $L^2(\\pi)$ 内积表示。\n$\\text{Var}_{\\pi}(f(X_0)) = \\mathbb{E}_{\\pi}[g(X_0)^2] = \\sum_x \\pi(x) g(x)^2 = \\langle g, g \\rangle_{\\pi}$。\n协方差为 $\\text{Cov}_{\\pi}(f(X_0), f(X_k)) = \\mathbb{E}_{\\pi}[g(X_0) g(X_k)]$。根据全期望定律和算子 $P$ 的定义：\n$$ \\mathbb{E}_{\\pi}[g(X_0) g(X_k)] = \\mathbb{E}_{\\pi} \\left[ g(X_0) \\mathbb{E}[g(X_k) | X_0] \\right] = \\mathbb{E}_{\\pi} [g(X_0) (P^k g)(X_0)] = \\langle g, P^k g \\rangle_{\\pi} $$\n因此，渐近方差可以用算子符号写成：\n$$ \\sigma_f^2 = \\langle g, g \\rangle_{\\pi} + 2 \\sum_{k=1}^{\\infty} \\langle g, P^k g \\rangle_{\\pi} = \\left\\langle g, \\left(I + 2 \\sum_{k=1}^{\\infty} P^k \\right) g \\right\\rangle_{\\pi} $$\n可逆性条件意味着算子 $P$ 在 Hilbert 空间 $L^2(\\pi)$ 上是自伴的。由于状态空间 $\\mathcal{X}$ 是有限的，$L^2(\\pi)$ 是有限维的。根据谱定理，存在一个由特征函数组成标准正交基 $\\{\\psi_i\\}_{i=1}^{|\\mathcal{X}|}$，使得 $P\\psi_i = \\lambda_i \\psi_i$ 且 $\\langle \\psi_i, \\psi_j \\rangle_{\\pi} = \\delta_{ij}$。特征值 $\\lambda_i$ 是实的。\n对于不可约、非周期的链，特征值 $\\lambda_1=1$ 是单的，对应的特征函数是一个常数，我们可以取为 $\\psi_1(x) = 1$。所有其他特征值都满足 $|\\lambda_i|  1$。\n中心化函数 $g$ 与常数函数空间正交：\n$$ \\langle g, \\psi_1 \\rangle_{\\pi} = \\sum_x \\pi(x) g(x) \\psi_1(x) = \\sum_x \\pi(x) g(x) = \\mathbb{E}_{\\pi}[g] = 0 $$\n我们可以在特征基中展开 $g$：$g = \\sum_{i=1}^{|\\mathcal{X}|} \\langle g, \\psi_i \\rangle_{\\pi} \\psi_i$。由于 $\\langle g, \\psi_1 \\rangle_{\\pi} = 0$，这个求和实际上是从 $i=2$ 到 $|\\mathcal{X}|$。\n使用这个展开，我们计算 $\\langle g, P^k g \\rangle_{\\pi}$：\n$$ \\langle g, P^k g \\rangle_{\\pi} = \\left\\langle \\sum_i \\langle g, \\psi_i \\rangle_{\\pi} \\psi_i, \\sum_j \\langle g, \\psi_j \\rangle_{\\pi} \\lambda_j^k \\psi_j \\right\\rangle_{\\pi} = \\sum_{i,j} \\langle g, \\psi_i \\rangle_{\\pi} \\langle g, \\psi_j \\rangle_{\\pi} \\lambda_j^k \\langle \\psi_i, \\psi_j \\rangle_{\\pi} $$\n利用标准正交性 $\\langle \\psi_i, \\psi_j \\rangle_{\\pi} = \\delta_{ij}$，上式简化为：\n$$ \\langle g, P^k g \\rangle_{\\pi} = \\sum_{i=2}^{|\\mathcal{X}|} (\\langle g, \\psi_i \\rangle_{\\pi})^2 \\lambda_i^k $$\n将此代入 $\\sigma_f^2$ 的表达式中：\n$$ \\sigma_f^2 = \\sum_{i=2}^{|\\mathcal{X}|} (\\langle g, \\psi_i \\rangle_{\\pi})^2 + 2 \\sum_{k=1}^{\\infty} \\sum_{i=2}^{|\\mathcal{X}|} (\\langle g, \\psi_i \\rangle_{\\pi})^2 \\lambda_i^k = \\sum_{i=2}^{|\\mathcal{X}|} (\\langle g, \\psi_i \\rangle_{\\pi})^2 \\left( 1 + 2 \\sum_{k=1}^{\\infty} \\lambda_i^k \\right) $$\n对于每个 $i \\ge 2$，有 $|\\lambda_i|  1$，所以几何级数收敛：$\\sum_{k=1}^{\\infty} \\lambda_i^k = \\frac{\\lambda_i}{1 - \\lambda_i}$。括号中的项变为：\n$$ 1 + 2 \\frac{\\lambda_i}{1 - \\lambda_i} = \\frac{1 - \\lambda_i + 2\\lambda_i}{1 - \\lambda_i} = \\frac{1 + \\lambda_i}{1 - \\lambda_i} $$\n所以渐近方差的谱表示为：\n$$ \\sigma_f^2 = \\sum_{i=2}^{|\\mathcal{X}|} \\frac{1 + \\lambda_i}{1 - \\lambda_i} (\\langle g, \\psi_i \\rangle_{\\pi})^2 $$\n这可以用 $P$ 的投影值谱测度 $E$ 来表示。$P = \\int \\lambda dE(\\lambda)$。测度 $\\mu_g(A) = \\langle g, E(A)g \\rangle_{\\pi} = \\|E(A)g\\|_{\\pi}^2$ 捕捉了 $g$ 在谱上的分布。由于 $E(\\{\\lambda_i\\})$ 是到 $\\lambda_i$-特征空间 $\\Pi_i$ 的投影算子，对于单特征值，我们有 $\\|\\Pi_i g\\|_{\\pi}^2 = (\\langle g, \\psi_i \\rangle_{\\pi})^2$。求和变成了在 $P$ 的谱上的积分，不包括特征值 $1$，因为 $g$ 在该特征空间中没有分量：\n$$ \\sigma_f^2 = \\int_{\\sigma(P) \\setminus \\{1\\}} \\frac{1+\\lambda}{1-\\lambda} \\, d\\mu_g(\\lambda) $$\n\n### 第二部分：两状态链的计算\n\n我们将结果具体化到给定的两状态链。状态空间为 $\\mathcal{X}=\\{0,1\\}$。\n首先，我们求转移矩阵 $P = \\begin{pmatrix} 1-\\alpha  \\alpha \\\\ \\beta  1-\\beta \\end{pmatrix}$ 的特征值。特征方程为 $\\det(P - \\lambda I)=0$：\n$$ (1-\\alpha-\\lambda)(1-\\beta-\\lambda) - \\alpha\\beta = \\lambda^2 - (2-\\alpha-\\beta)\\lambda + (1-\\alpha-\\beta) = 0 $$\n这个方程可以因式分解为 $(\\lambda-1)(\\lambda - (1-\\alpha-\\beta)) = 0$。特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = 1-\\alpha-\\beta$。由于 $\\alpha, \\beta \\in (0,1)$，我们有 $-1  \\lambda_2  1$。\n\n对于两状态空间，$|\\mathcal{X}|=2$，$\\sigma_f^2$ 的求和只有一项，即 $i=2$ 的项：\n$$ \\sigma_f^2 = \\frac{1+\\lambda_2}{1-\\lambda_2} (\\langle g, \\psi_2 \\rangle_{\\pi})^2 $$\n其中 $\\psi_2$ 是对应于 $\\lambda_2$ 的归一化特征函数。\n由于 $g$ 与常数特征函数 $\\psi_1$ 正交，它必须完全位于 $\\lambda_2$ 的特征空间中。因此，系数的平方 $(\\langle g, \\psi_2 \\rangle_{\\pi})^2$ 就是 $g$ 的总范数的平方，即 $\\|g\\|_{\\pi}^2 = \\langle g, g \\rangle_{\\pi}$。\n所以，我们得到简化公式：\n$$ \\sigma_f^2 = \\frac{1+\\lambda_2}{1-\\lambda_2} \\|g\\|_{\\pi}^2 $$\n接下来，我们计算这个公式的两个部分。涉及特征值的项是：\n$$ \\frac{1+\\lambda_2}{1-\\lambda_2} = \\frac{1+(1-\\alpha-\\beta)}{1-(1-\\alpha-\\beta)} = \\frac{2-\\alpha-\\beta}{\\alpha+\\beta} $$\n接下来，我们计算 $\\|g\\|_{\\pi}^2$。首先，我们求 $g = f - \\mathbb{E}_{\\pi}[f]$。期望是：\n$$ \\mathbb{E}_{\\pi}[f] = \\pi(0)f(0) + \\pi(1)f(1) = \\frac{\\beta}{\\alpha+\\beta} u + \\frac{\\alpha}{\\alpha+\\beta} v = \\frac{\\beta u + \\alpha v}{\\alpha+\\beta} $$\n中心化函数 $g$ 的分量是：\n$g(0) = f(0) - \\mathbb{E}_{\\pi}[f] = u - \\frac{\\beta u + \\alpha v}{\\alpha+\\beta} = \\frac{(\\alpha+\\beta)u - \\beta u - \\alpha v}{\\alpha+\\beta} = \\frac{\\alpha(u-v)}{\\alpha+\\beta}$。\n$g(1) = f(1) - \\mathbb{E}_{\\pi}[f] = v - \\frac{\\beta u + \\alpha v}{\\alpha+\\beta} = \\frac{(\\alpha+\\beta)v - \\beta u - \\alpha v}{\\alpha+\\beta} = \\frac{-\\beta(u-v)}{\\alpha+\\beta}$。\n范数的平方 $\\|g\\|_{\\pi}^2 = \\pi(0)g(0)^2 + \\pi(1)g(1)^2$ 是：\n$$ \\|g\\|_{\\pi}^2 = \\frac{\\beta}{\\alpha+\\beta} \\left(\\frac{\\alpha(u-v)}{\\alpha+\\beta}\\right)^2 + \\frac{\\alpha}{\\alpha+\\beta} \\left(\\frac{-\\beta(u-v)}{\\alpha+\\beta}\\right)^2 $$\n$$ = \\frac{(u-v)^2}{(\\alpha+\\beta)^3} \\left( \\beta\\alpha^2 + \\alpha\\beta^2 \\right) = \\frac{(u-v)^2}{(\\alpha+\\beta)^3} \\alpha\\beta(\\alpha+\\beta) = \\frac{\\alpha\\beta(u-v)^2}{(\\alpha+\\beta)^2} $$\n最后，我们结合这两个部分来求 $\\sigma_f^2$：\n$$ \\sigma_f^2 = \\left(\\frac{2-\\alpha-\\beta}{\\alpha+\\beta}\\right) \\left(\\frac{\\alpha\\beta(u-v)^2}{(\\alpha+\\beta)^2}\\right) = \\frac{\\alpha\\beta(2-\\alpha-\\beta)(u-v)^2}{(\\alpha+\\beta)^3} $$\n这就是渐近方差的闭式表达式。",
            "answer": "$$\\boxed{\\frac{\\alpha\\beta(2 - \\alpha - \\beta)(u-v)^2}{(\\alpha+\\beta)^3}}$$"
        }
    ]
}