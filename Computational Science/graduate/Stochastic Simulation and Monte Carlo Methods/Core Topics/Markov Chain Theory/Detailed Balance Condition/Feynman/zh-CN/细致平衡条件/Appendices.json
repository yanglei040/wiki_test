{
    "hands_on_practices": [
        {
            "introduction": "细致平衡是确保马尔可夫链蒙特卡洛（MCMC）方法收敛到正确平稳分布的一个充分条件。本练习将理论付诸实践，要求您使用 Kolmogorov 循环判据，这是一个直接检验可逆性的强大工具。通过在一个简单的三状态马尔可夫链上应用该判据 ，您将巩固对细致平衡条件的理解，并练习如何从基本原理出发求解平稳分布。",
            "id": "3302632",
            "problem": "考虑一个状态空间为 $\\{1,2,3\\}$ 的离散时间马尔可夫链 (MC)，其转移概率由以下随机矩阵 $P = (P_{ij})$ 给出：\n$$\nP \\;=\\;\n\\begin{pmatrix}\nP_{11}  P_{12}  P_{13} \\\\\nP_{21}  P_{22}  P_{23} \\\\\nP_{31}  P_{32}  P_{33}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\frac{2}{5}  \\frac{2}{5}  \\frac{1}{5} \\\\\n\\frac{1}{2}  \\frac{1}{6}  \\frac{1}{3} \\\\\n\\frac{3}{10}  \\frac{2}{5}  \\frac{3}{10}\n\\end{pmatrix}.\n$$\n关于一个严格正的不变分布 $\\pi = (\\pi_{1},\\pi_{2},\\pi_{3})$ 的可逆性（细致平衡）意味着对于所有 $i,j \\in \\{1,2,3\\}$，有 $\\pi_{i} P_{ij} = \\pi_{j} P_{ji}$。一个经典的可逆性准则涉及沿闭环的环路约束。从离散时间马尔可夫链、平稳性和细致平衡的核心定义出发，推导三状态链的环路准则，然后用它来判断对于上述矩阵 $P$，是否存在某个严格正的 $\\pi$ 使得细致平衡成立。如果可以，求解满足归一化条件 $\\sum_{i=1}^{3} \\pi_{i} = 1$ 的 $\\pi$。如果细致平衡不成立，请用环路准则证明其结论。将你的最终答案表示为归一化向量 $\\pi$；不需要四舍五入，答案必须是精确的。",
            "solution": "该问题陈述是离散时间马尔可夫链理论中的一个有效练习。它自成一体、数学上合理且提法得当。我们将着手进行解答。\n\n首先，我们按照问题陈述的要求，建立理论基础。\n\n在有限状态空间 $\\mathcal{S}$ 上的一个离散时间马尔可夫链是一个取值于 $\\mathcal{S}$ 的随机变量序列 $\\{X_n\\}_{n \\ge 0}$，它满足马尔可夫性质：对于任何状态 $i, j, i_0, \\ldots, i_{n-1} \\in \\mathcal{S}$，\n$$\nP(X_{n+1}=j | X_n=i, X_{n-1}=i_{n-1}, \\dots, X_0=i_0) = P(X_{n+1}=j | X_n=i).\n$$\n对于时间齐次链，这个概率与 $n$无关，并用转移概率 $P_{ij} = P(X_{n+1}=j | X_n=i)$ 表示。这些概率构成了转移矩阵 $P = (P_{ij})$。\n\n一个概率分布 $\\pi = (\\pi_i)_{i \\in \\mathcal{S}}$ 如果是转移算子的不动点，则被称为平稳分布或不变分布。也就是说，如果在时间 $n$ 链处于状态 $i$ 的概率为 $\\pi_i$，那么在时间 $n+1$ 它将处于状态 $j$ 的概率为 $\\pi_j$。这由方程 $\\pi = \\pi P$ 表示，其分量形式为：\n$$\n\\pi_j = \\sum_{i \\in \\mathcal{S}} \\pi_i P_{ij} \\quad \\text{for all } j \\in \\mathcal{S}.\n$$\n\n如果对于所有状态 $i, j \\in \\mathcal{S}$，马尔可夫链满足以下条件，则称其为可逆的，或称其关于分布 $\\pi$ 满足细致平衡条件：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji}.\n$$\n细致平衡条件是平稳性的一个充分但不必要条件。为了证明这一点，我们将细致平衡方程对所有状态 $j$ 求和：\n$$\n\\sum_{j \\in \\mathcal{S}} \\pi_i P_{ij} = \\sum_{j \\in \\mathcal{S}} \\pi_j P_{ji}.\n$$\n左边化简为 $\\pi_i \\sum_{j \\in \\mathcal{S}} P_{ij} = \\pi_i \\cdot 1 = \\pi_i$，因为随机矩阵的行和为 $1$。因此方程变为 $\\pi_i = \\sum_{j \\in \\mathcal{S}} \\pi_j P_{ji}$。通过令 $i \\to j$ 和 $j \\to i$ 重新标记索引，得到 $\\pi_j = \\sum_{i \\in \\mathcal{S}} \\pi_i P_{ij}$，这正是平稳性条件。\n\n接着，我们推导环路准则（Kolmogorov's criterion for reversibility）。假设细致平衡条件 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 对于一个严格正分布 $\\pi > 0$ 成立。考虑任意一个状态的闭环（环路） $i_1, i_2, \\ldots, i_k, i_1$。根据细致平衡条件，我们可以写出：\n$$\n\\frac{P_{i_m i_{m+1}}}{P_{i_{m+1} i_m}} = \\frac{\\pi_{i_{m+1}}}{\\pi_{i_m}}\n$$\n对于环路中任意相邻的一对状态，只要分母中的转移概率非零。\n将环路 $i_1 \\to i_2 \\to \\dots \\to i_k \\to i_1$ （其中 $i_{k+1}=i_1$）的各项相乘：\n$$\n\\prod_{m=1}^{k} \\frac{P_{i_m i_{m+1}}}{P_{i_{m+1} i_m}} = \\frac{P_{i_1 i_2}}{P_{i_2 i_1}} \\cdot \\frac{P_{i_2 i_3}}{P_{i_3 i_2}} \\cdots \\frac{P_{i_k i_1}}{P_{i_1 i_k}} = \\frac{\\pi_{i_2}}{\\pi_{i_1}} \\cdot \\frac{\\pi_{i_3}}{\\pi_{i_2}} \\cdots \\frac{\\pi_{i_1}}{\\pi_{i_k}} = 1.\n$$\n这意味着沿任意环路的转移概率之积必须等于沿同一环路反方向的转移概率之积：\n$$\nP_{i_1 i_2} P_{i_2 i_3} \\cdots P_{i_k i_1} = P_{i_1 i_k} P_{i_k i_{k-1}} \\cdots P_{i_2 i_1}.\n$$\n对于 $\\mathcal{S}=\\{1, 2, 3\\}$ 上的三状态链，任何长度大于3的环路都由更小的环路组成。长度为2的环路（例如，$1 \\to 2 \\to 1$）给出平凡的恒等式 $P_{12}P_{21} = P_{12}P_{21}$。因此，只需检查长度为3的环路 $1 \\to 2 \\to 3 \\to 1$ 的条件。该准则为：\n$$\nP_{12} P_{23} P_{31} = P_{13} P_{32} P_{21}.\n$$\n左边的乘积对应于路径 $1 \\to 2 \\to 3 \\to 1$，右边的乘积对应于反向路径 $1 \\to 3 \\to 2 \\to 1$。\n\n我们现在将此准则应用于给定的转移矩阵：\n$$\nP =\n\\begin{pmatrix}\n\\frac{2}{5}  \\frac{2}{5}  \\frac{1}{5} \\\\\n\\frac{1}{2}  \\frac{1}{6}  \\frac{1}{3} \\\\\n\\frac{3}{10}  \\frac{2}{5}  \\frac{3}{10}\n\\end{pmatrix}.\n$$\n相关的转移概率是：\n$P_{12} = \\frac{2}{5}$， $P_{23} = \\frac{1}{3}$， $P_{31} = \\frac{3}{10}$。\n$P_{13} = \\frac{1}{5}$， $P_{32} = \\frac{2}{5}$， $P_{21} = \\frac{1}{2}$。\n\n我们计算环路 $1 \\to 2 \\to 3 \\to 1$ 的乘积：\n$$\nP_{12} P_{23} P_{31} = \\left(\\frac{2}{5}\\right) \\left(\\frac{1}{3}\\right) \\left(\\frac{3}{10}\\right) = \\frac{6}{150} = \\frac{1}{25}.\n$$\n接下来，我们计算反向环路 $1 \\to 3 \\to 2 \\to 1$ 的乘积：\n$$\nP_{13} P_{32} P_{21} = \\left(\\frac{1}{5}\\right) \\left(\\frac{2}{5}\\right) \\left(\\frac{1}{2}\\right) = \\frac{2}{50} = \\frac{1}{25}.\n$$\n由于 $P_{12} P_{23} P_{31} = P_{13} P_{32} P_{21}$，环路准则得到满足。因此，对于此马尔可夫链，存在一个满足细致平衡条件的严格正不变分布 $\\pi$。\n\n我们现在来求解这个分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$。细致平衡方程为：\n1. $\\pi_1 P_{12} = \\pi_2 P_{21} \\implies \\pi_1 \\left(\\frac{2}{5}\\right) = \\pi_2 \\left(\\frac{1}{2}\\right)$\n2. $\\pi_2 P_{23} = \\pi_3 P_{32} \\implies \\pi_2 \\left(\\frac{1}{3}\\right) = \\pi_3 \\left(\\frac{2}{5}\\right)$\n\n从方程(1)，我们将 $\\pi_2$ 用 $\\pi_1$ 表示：\n$$\n\\pi_2 = \\pi_1 \\frac{2/5}{1/2} = \\pi_1 \\left(\\frac{4}{5}\\right).\n$$\n从方程(2)，我们将 $\\pi_3$ 用 $\\pi_2$ 表示：\n$$\n\\pi_3 = \\pi_2 \\frac{1/3}{2/5} = \\pi_2 \\left(\\frac{5}{6}\\right).\n$$\n代入 $\\pi_2$ 的表达式：\n$$\n\\pi_3 = \\left(\\frac{4}{5}\\pi_1\\right) \\left(\\frac{5}{6}\\right) = \\frac{4}{6}\\pi_1 = \\frac{2}{3}\\pi_1.\n$$\n现在我们有 $\\pi_2 = \\frac{4}{5}\\pi_1$ 和 $\\pi_3 = \\frac{2}{3}\\pi_1$。我们使用归一化条件 $\\sum_{i=1}^{3} \\pi_i = 1$：\n$$\n\\pi_1 + \\pi_2 + \\pi_3 = 1\n$$\n$$\n\\pi_1 + \\frac{4}{5}\\pi_1 + \\frac{2}{3}\\pi_1 = 1\n$$\n$$\n\\pi_1 \\left(1 + \\frac{4}{5} + \\frac{2}{3}\\right) = 1\n$$\n为了对分数求和，我们找到公分母，即 $15$：\n$$\n\\pi_1 \\left(\\frac{15}{15} + \\frac{12}{15} + \\frac{10}{15}\\right) = 1\n$$\n$$\n\\pi_1 \\left(\\frac{15+12+10}{15}\\right) = 1\n$$\n$$\n\\pi_1 \\left(\\frac{37}{15}\\right) = 1 \\implies \\pi_1 = \\frac{15}{37}.\n$$\n现在我们求 $\\pi_2$ 和 $\\pi_3$：\n$$\n\\pi_2 = \\frac{4}{5}\\pi_1 = \\frac{4}{5} \\left(\\frac{15}{37}\\right) = \\frac{12}{37}.\n$$\n$$\n\\pi_3 = \\frac{2}{3}\\pi_1 = \\frac{2}{3} \\left(\\frac{15}{37}\\right) = \\frac{10}{37}.\n$$\n因此，满足细致平衡的唯一归一化平稳分布是 $\\pi = \\left(\\frac{15}{37}, \\frac{12}{37}, \\frac{10}{37}\\right)$。所有分量都严格为正，符合要求。最后检查归一化：$\\frac{15}{37} + \\frac{12}{37} + \\frac{10}{37} = \\frac{37}{37} = 1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{15}{37}  \\frac{12}{37}  \\frac{10}{37}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实现 Metropolis-Hastings 算法时，一个常见的陷阱是未能正确处理非对称的提议分布。本练习设计了一个场景 ，其中一个看似合理的“朴素”接受概率实际上破坏了细致平衡。您将首先通过计算证明这种不平衡，然后从细致平衡的定义出发，推导出正确的接受概率，从而恢复算法的正确性。这个练习对于培养严谨的算法设计和调试能力至关重要。",
            "id": "3302655",
            "problem": "考虑一个在状态空间 $\\{0,1,2\\}$ 上的有限状态马尔可夫链蒙特卡洛 (MCMC) 方法，其目标分布为 $\\pi$，其中 $\\pi(0)=\\frac{1}{2}$，$\\pi(1)=\\frac{1}{3}$，以及 $\\pi(2)=\\frac{1}{6}$。有两个可用的确定性提议核：一个顺时针核 $K^{+}$，定义为若 $y\\equiv x+1\\ (\\mathrm{mod}\\ 3)$ 则 $K^{+}(x,y)=1$，否则 $K^{+}(x,y)=0$；以及一个逆时针核 $K^{-}$，定义为若 $y\\equiv x-1\\ (\\mathrm{mod}\\ 3)$ 则 $K^{-}(x,y)=1$，否则 $K^{-}(x,y)=0$。提议机制是一个依赖于状态的混合：在当前状态 $x$，$K^{+}$ 以权重 $w(x)$ 被选择，$K^{-}$ 以权重 $1-w(x)$ 被选择，其中 $w(0)=\\frac{3}{4}$，$w(1)=\\frac{1}{2}$，以及 $w(2)=\\frac{1}{4}$。因此，单步提议概率为 $q(x,y)=w(x)K^{+}(x,y)+\\big(1-w(x)\\big)K^{-}(x,y)$。\n\n假设一个实践者实现了一个朴素的接受规则，该规则错误地假设提议是对称的，并对所有 $x\\neq y$ 使用 $\\alpha_{\\mathrm{naive}}(x,y)=\\min\\!\\big(1,\\frac{\\pi(y)}{\\pi(x)}\\big)$。仅使用细致平衡的定义，即对于所有状态 $x,y$ 且 $x \\neq y$，有 $\\pi(x)P(x,y)=\\pi(y)P(y,x)$，其中 $P(x,y)=q(x,y)\\alpha(x,y)$ 表示转移核，并利用概率法则，计算比率\n$$\\rho=\\frac{\\pi(0)\\,q(0,1)\\,\\alpha_{\\mathrm{naive}}(0,1)}{\\pi(1)\\,q(1,0)\\,\\alpha_{\\mathrm{naive}}(1,0)}$$\n以证明在该朴素规则下，状态对 $(0,1)$ 的细致平衡被破坏。\n\n然后，从细致平衡的相同基本定义出发，且不假设任何快捷公式，推导在给定的依赖于状态的混合提议 $q(x,y)$ 下，能够恢复从 $0$ 到 $1$ 转移的可逆性的接受概率 $\\alpha_{\\mathrm{corr}}(0,1)$。将你的最终答案表示为一个最简分数。无需四舍五入。",
            "solution": "本题的分析将分两部分进行。首先，我们将通过计算指定的比率 $\\rho$ 来证明朴素接受规则违反了细致平衡条件。其次，我们将推导正确的接受概率 $\\alpha_{\\mathrm{corr}}(0,1)$，以恢复从状态 $0$ 到 $1$ 转移的细致平衡。\n\n给定的参数如下：\n状态空间: $S = \\{0, 1, 2\\}$\n目标分布: $\\pi(0) = \\frac{1}{2}$，$\\pi(1) = \\frac{1}{3}$，$\\pi(2) = \\frac{1}{6}$\n顺时针提议: $K^{+}(x,y)=1$ 若 $y \\equiv x+1 \\pmod{3}$\n逆时针提议: $K^{-}(x,y)=1$ 若 $y \\equiv x-1 \\pmod{3}$\n依赖于状态的混合权重: $w(0)=\\frac{3}{4}$，$w(1)=\\frac{1}{2}$，$w(2)=\\frac{1}{4}$\n组合提议概率: $q(x,y)=w(x)K^{+}(x,y)+\\big(1-w(x)\\big)K^{-}(x,y)$\n\n细致平衡（可逆性）的基本条件指出，对于一个具有平稳分布 $\\pi$ 和转移概率 $P(x,y)$ 的马尔可夫链，在平衡状态下，从状态 $x$ 到 $y$ 的转移速率必须等于从 $y$ 到 $x$ 的转移速率。对于任意一对不同状态 $x, y \\in S$，这表示为：\n$$ \\pi(x) P(x,y) = \\pi(y) P(y,x) $$\n对于 Metropolis-Hastings 类算法，当 $x \\neq y$ 时，转移概率由 $P(x,y) = q(x,y)\\alpha(x,y)$ 给出，其中 $q(x,y)$ 是提议概率，$\\alpha(x,y)$ 是接受概率。\n\n### 第一部分：使用朴素规则对细致平衡的违反\n\n我们被要求计算比率 $\\rho = \\frac{\\pi(0)\\,q(0,1)\\,\\alpha_{\\mathrm{naive}}(0,1)}{\\pi(1)\\,q(1,0)\\,\\alpha_{\\mathrm{naive}}(1,0)}$ 以表明对于状态对 $(0,1)$，细致平衡被破坏。细致平衡成立当且仅当此比率等于 $1$。\n\n首先，我们计算必要的提议概率 $q(0,1)$ 和 $q(1,0)$。\n对于转移 $0 \\to 1$：\n提议的状态 $y=1$ 相对于当前状态 $x=0$ 是顺时针方向，因为 $1 \\equiv 0+1 \\pmod{3}$。因此，$K^{+}(0,1)=1$ 且 $K^{-}(0,1)=0$。\n提议概率为：\n$q(0,1) = w(0)K^{+}(0,1) + (1-w(0))K^{-}(0,1) = w(0) \\cdot 1 + (1-w(0)) \\cdot 0 = w(0) = \\frac{3}{4}$。\n\n对于转移 $1 \\to 0$：\n提议的状态 $y=0$ 相对于当前状态 $x=1$ 是逆时针方向，因为 $0 \\equiv 1-1 \\pmod{3}$。因此，$K^{+}(1,0)=0$ 且 $K^{-}(1,0)=1$。\n提议概率为：\n$q(1,0) = w(1)K^{+}(1,0) + (1-w(1))K^{-}(1,0) = w(1) \\cdot 0 + (1-w(1)) \\cdot 1 = 1-w(1) = 1-\\frac{1}{2} = \\frac{1}{2}$。\n\n接下来，我们使用朴素规则 $\\alpha_{\\mathrm{naive}}(x,y)=\\min\\left(1,\\frac{\\pi(y)}{\\pi(x)}\\right)$ 计算接受概率。\n对于转移 $0 \\to 1$：\n$\\alpha_{\\mathrm{naive}}(0,1) = \\min\\left(1, \\frac{\\pi(1)}{\\pi(0)}\\right) = \\min\\left(1, \\frac{1/3}{1/2}\\right) = \\min\\left(1, \\frac{2}{3}\\right) = \\frac{2}{3}$。\n\n对于转移 $1 \\to 0$：\n$\\alpha_{\\mathrm{naive}}(1,0) = \\min\\left(1, \\frac{\\pi(0)}{\\pi(1)}\\right) = \\min\\left(1, \\frac{1/2}{1/3}\\right) = \\min\\left(1, \\frac{3}{2}\\right) = 1$。\n\n现在我们可以计算 $\\rho$ 的分子和分母。\n正向通量（与从 $0$ 到 $1$ 的概率流成正比）为：\n$\\pi(0)\\,q(0,1)\\,\\alpha_{\\mathrm{naive}}(0,1) = \\frac{1}{2} \\cdot \\frac{3}{4} \\cdot \\frac{2}{3} = \\frac{6}{24} = \\frac{1}{4}$。\n\n反向通量（与从 $1$ 到 $0$ 的概率流成正比）为：\n$\\pi(1)\\,q(1,0)\\,\\alpha_{\\mathrm{naive}}(1,0) = \\frac{1}{3} \\cdot \\frac{1}{2} \\cdot 1 = \\frac{1}{6}$。\n\n因此，比率 $\\rho$ 为：\n$$ \\rho = \\frac{1/4}{1/6} = \\frac{6}{4} = \\frac{3}{2} $$\n由于 $\\rho = \\frac{3}{2} \\neq 1$，正向和反向通量不平衡。这表明，忽略了提议分布 $q(x,y)$ 中不对称性的朴素接受规则，未能满足状态对 $(0,1)$ 的细致平衡条件。\n\n### 第二部分：正确接受概率的推导\n\n为恢复细致平衡，必须选择接受概率 $\\alpha_{\\mathrm{corr}}(x,y)$，使得对于所有 $x \\neq y$：\n$$ \\pi(x) q(x,y) \\alpha_{\\mathrm{corr}}(x,y) = \\pi(y) q(y,x) \\alpha_{\\mathrm{corr}}(y,x) $$\n我们必须找到满足此方程的 $\\alpha_{\\mathrm{corr}}(x,y)$ 和 $\\alpha_{\\mathrm{corr}}(y,x)$ 的解，同时遵守接受概率必须在区间 $[0,1]$ 内的约束。一种最大化接受率的标准方法是将其中一个概率设置为其可能的最大值 $1$。\n\n让我们重排该方程：\n$$ \\frac{\\alpha_{\\mathrm{corr}}(x,y)}{\\alpha_{\\mathrm{corr}}(y,x)} = \\frac{\\pi(y) q(y,x)}{\\pi(x) q(x,y)} $$\n定义 Metropolis-Hastings 比率 $R_{xy} = \\frac{\\pi(y) q(y,x)}{\\pi(x) q(x,y)}$。\n情况1：$R_{xy} \\le 1$。我们希望最大化接受概率。我们可以将两者中较大的 $\\alpha_{\\mathrm{corr}}(y,x)$ 设置为其最大值 $1$。该方程则要求 $\\alpha_{\\mathrm{corr}}(x,y) = R_{xy}$。由于 $R_{xy} \\le 1$，这个选择是有效的。所以，$\\alpha_{\\mathrm{corr}}(x,y) = R_{xy}$ 且 $\\alpha_{\\mathrm{corr}}(y,x) = 1$。\n\n情况2：$R_{xy} > 1$。在这种情况下，$\\frac{1}{R_{xy}} < 1$。我们可以将 $\\alpha_{\\mathrm{corr}}(x,y)$ 设置为其最大值 $1$。该方程则要求 $1 = R_{xy} \\cdot \\alpha_{\\mathrm{corr}}(y,x)$，这给出 $\\alpha_{\\mathrm{corr}}(y,x) = \\frac{1}{R_{xy}}$。由于 $\\frac{1}{R_{xy}} < 1$，这个选择是有效的。所以，$\\alpha_{\\mathrm{corr}}(x,y) = 1$ 且 $\\alpha_{\\mathrm{corr}}(y,x) = \\frac{1}{R_{xy}}$。\n\n这两种情况可以用最小值函数紧凑地表示为：\n$$ \\alpha_{\\mathrm{corr}}(x,y) = \\min\\left(1, R_{xy}\\right) = \\min\\left(1, \\frac{\\pi(y) q(y,x)}{\\pi(x) q(x,y)}\\right) $$\n这是 Metropolis-Hastings 接受概率的一般形式。\n\n我们现在应用这个公式来寻找 $\\alpha_{\\mathrm{corr}}(0,1)$ 的具体值。我们需要计算比率 $R_{01}$：\n$$ R_{01} = \\frac{\\pi(1) q(1,0)}{\\pi(0) q(0,1)} $$\n使用我们已经计算出的值：\n$\\pi(0) = \\frac{1}{2}$\n$\\pi(1) = \\frac{1}{3}$\n$q(0,1) = \\frac{3}{4}$\n$q(1,0) = \\frac{1}{2}$\n\n分子是 $\\pi(1) q(1,0) = \\frac{1}{3} \\cdot \\frac{1}{2} = \\frac{1}{6}$。\n分母是 $\\pi(0) q(0,1) = \\frac{1}{2} \\cdot \\frac{3}{4} = \\frac{3}{8}$。\n\n该比率为：\n$$ R_{01} = \\frac{1/6}{3/8} = \\frac{1}{6} \\cdot \\frac{8}{3} = \\frac{8}{18} = \\frac{4}{9} $$\n最后，从 $0$ 到 $1$ 转移的正确接受概率是：\n$$ \\alpha_{\\mathrm{corr}}(0,1) = \\min\\left(1, \\frac{4}{9}\\right) = \\frac{4}{9} $$\n在 MCMC 模拟中使用这个值，将确保状态对 $(0,1)$ 的细致平衡条件得到满足。",
            "answer": "$$ \\boxed{\\frac{4}{9}} $$"
        },
        {
            "introduction": "满足细致平衡条件可确保 MCMC 算法以目标分布为平稳分布，但这并不保证算法的效率。本练习探讨了一个更深层次的问题：即使算法在理论上是正确的，其性能也可能因提议分布与目标分布之间的不匹配而严重下降。通过分析重尾目标分布和轻尾提议分布的组合 ，您将理解为何细致平衡是必要但不充分的，并探索遍历性、混合时间等高级概念对 MCMC 性能的影响。",
            "id": "3302604",
            "problem": "考虑一个在 $\\mathbb{R}$ 上的目标概率密度 $\\,\\pi(x)\\,$，它是重尾的，例如自由度为 $\\,\\nu>0\\,$ 的学生t分布密度，因此对于大的 $\\,|x|\\,$，有 $\\,\\pi(x)\\asymp c\\,|x|^{-(\\nu+1)}\\,$，其中 $\\,c>0\\,$ 是某个常数。令 $\\,q(x)\\,$ 为一个轻尾的提议密度，例如高斯密度 $\\,\\mathcal{N}(0,1)\\,$。考虑在马尔可夫链蒙特卡洛（MCMC）中使用的独立Metropolis–Hastings核：给定当前状态 $\\,X=x\\,$，独立于 $\\,x\\,$ 提议 $\\,Y\\sim q(\\cdot)\\,$，并使用一个接受准则接受 $\\,Y\\,$，该准则的选择使得得到的马尔可夫转移核相对于 $\\,\\pi\\,$ 是可逆的。用 $\\,P(x,\\mathrm{d}y)\\,$ 表示一步转移核。\n\n从细致平衡（可逆性）的定义出发，即对于所有可测集 $\\,A,B\\subset\\mathbb{R}\\,$，\n$$\n\\int_A \\pi(x) P(x,B)\\,\\mathrm{d}x \\;=\\; \\int_B \\pi(y) P(y,A)\\,\\mathrm{d}y,\n$$\n以及重尾函数与轻尾函数的基本性质，分析以下陈述。选择所有正确的陈述，并通过基于上述定义和独立提议结构的推理来证明您的选择。\n\nA. 对于任何在 $\\,\\mathbb{R}\\,$ 上具有全支撑的提议密度 $\\,q\\,$，如果选择接受准则以满足细致平衡所蕴含的可逆性对称，那么得到的独立Metropolis–Hastings核 $\\,P\\,$ 相对于 $\\,\\pi\\,$ 是可逆的，不论 $\\,q\\,$ 比 $\\,\\pi\\,$ 是轻尾还是重尾。\n\nB. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么当马尔可夫链当前处于一个远尾状态 $\\,x\\,$（即 $\\,|x|\\to\\infty\\,$）时，对于一个落在中心附近的典型提议 $\\,y\\sim q(\\cdot)\\,$，其接受概率随着 $\\,|x|\\to\\infty\\,$ 趋于 $\\,0\\,$。因此，链在尾部会变得极其“粘滞”。\n\nC. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么链的不变分布将不再是 $\\,\\pi\\,$，因为在这种不匹配下，从中心到尾部的提议总是被拒绝。\n\nD. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾但在 $\\,\\mathbb{R}\\,$ 上有全支撑，那么尽管 $\\,\\pi\\,$ 是平穩的，链不可能是Harris常返的。\n\nE. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么链不可能是一致遍历的，因为在这种情况下 $\\,\\sup_{x\\in\\mathbb{R}} \\pi(x)/q(x) = \\infty\\,$，这排除了一个全局次要化条件。",
            "solution": "该问题要求分析关于独立Metropolis-Hastings (M-H)算法的几个陈述，其中目标分布 $\\pi(x)$ 是重尾的，而提议分布 $q(x)$ 是轻尾的。\n\n首先，让我们形式化独立Metropolis-Hastings核的组成部分。\n从状态 $x$ 到新状态 $y$ 的提议是从密度 $q(y)$ 中抽取的，所以提议核密度是 $q(x,y) = q(y)$。\n接受概率 $\\alpha(x,y)$ 被选择以满足关于 $\\pi$ 的细致平衡条件。标准的选择是：\n$$ \\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y) q(y, x)}{\\pi(x) q(x, y)} \\right) $$\n对于独立采样器，这变为：\n$$ \\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y) q(x)}{\\pi(x) q(y)} \\right) $$\n一步转移核 $P(x, \\mathrm{d}y)$ 可以表示为：\n$$ P(x, \\mathrm{d}y) = \\alpha(x, y) q(y) \\mathrm{d}y + \\left(1 - \\int_{\\mathbb{R}} \\alpha(x, z) q(z) \\mathrm{d}z \\right) \\delta_x(\\mathrm{d}y) $$\n其中 $\\delta_x$ 是在 $x$ 处的狄拉克测度。\n\n问题陈述 $\\pi(x)$ 是重尾的，例如对于大的 $|x|$，$\\pi(x) \\asymp c|x|^{-(\\nu+1)}$。提议 $q(x)$ 是轻尾的，例如高斯分布 $\\mathcal{N}(0,1)$，其中 $q(x) \\propto \\exp(-x^2/2)$。这种不匹配的一个关键后果是比率 $w(x) = \\pi(x)/q(x)$ 的行为。对于大的 $|x|$，这个比率趋于无穷大：\n$$ \\lim_{|x|\\to\\infty} \\frac{\\pi(x)}{q(x)} = \\infty $$\n我们现在逐一分析每个陈述。\n\n**A. 对于任何在 $\\,\\mathbb{R}\\,$ 上具有全支撑的提议密度 $\\,q\\,$，如果选择接受准则以满足细致平衡所蕴含的可逆性对称，那么得到的独立Metropolis–Hastings核 $\\,P\\,$ 相对于 $\\,\\pi\\,$ 是可逆的，不论 $\\,q\\,$ 比 $\\,\\pi\\,$ 是轻尾还是重尾。**\n\n这个陈述是正确的。可逆性（也称为满足细致平衡条件）是Metropolis-Hastings算法构造的基础。问题陈述本身就指明了接受准则的选择是为了确保可逆性。标准的M-H接受概率 $\\alpha(x, y)$ 是专门设计用来强制执行非对角转移概率的细致平衡条件的，即 $\\pi(x) q(x,y) \\alpha(x,y) = \\pi(y) q(y,x) \\alpha(y,x)$。这反过来保证了完整的核 $P(x, \\mathrm{d}y)$ 关于 $\\pi$ 是可逆的，意味着 $\\int_A \\pi(x) P(x,B)\\,\\mathrm{d}x = \\int_B \\pi(y) P(y,A)\\,\\mathrm{d}y$。这是算法设计的结构性属性，不依赖于 $\\pi$ 和 $q$ 的尾部性质，而是依赖于 $\\alpha(x,y)$ 的函数形式。尾部性质影响的是链的*性能*和遍历性质（例如收敛速度），而不是 $\\pi$ 是所构造核的可逆分布这一事实。因此，该陈述是关于M-H算法的一个正确断言。\n\n**结论：正确**\n\n**B. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么当马尔可夫链当前处于一个远尾状态 $\\,x\\,$（即 $\\,|x|\\to\\infty\\,$）时，对于一个落在中心附近的典型提议 $\\,y\\sim q(\\cdot)\\,$，其接受概率随着 $\\,|x|\\to\\infty\\,$ 趋于 $\\,0\\,$。因此，链在尾部会变得极其“粘滞”。**\n\n这个陈述是正确的。让我们分析接受概率 $\\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y) q(x)}{\\pi(x) q(y)} \\right)$。我们可以将比率重写为 $\\frac{\\pi(y)/q(y)}{\\pi(x)/q(x)}$。\n设 $x$ 是一个远尾状态，所以 $|x| \\to \\infty$。一个“典型”的提议 $y$ 是从轻尾密度 $q(\\cdot)$ 中抽取的，所以 $y$ 很可能位于一个中心区域，其中 $\\pi(y)$ 和 $q(y)$ 都是不可忽略的，因此比率 $\\pi(y)/q(y)$ 是一个有限正常数。\n如前所述，由于 $q$ 比 $\\pi$ 轻尾，比率 $\\pi(x)/q(x) \\to \\infty$ 当 $|x| \\to \\infty$ 时。\n因此，最小值内的项的行为如下：\n$$ \\lim_{|x|\\to\\infty} \\frac{\\pi(y) q(x)}{\\pi(x) q(y)} = \\frac{\\pi(y)}{q(y)} \\lim_{|x|\\to\\infty} \\frac{q(x)}{\\pi(x)} = \\frac{\\pi(y)}{q(y)} \\cdot 0 = 0 $$\n所以，$\\lim_{|x|\\to\\infty} \\alpha(x, y) = 0$。接受一个离开状态 $x$ 的移动的总概率是 $\\int_{\\mathbb{R}} \\alpha(x, y) q(y) \\mathrm{d}y$，当 $|x| \\to \\infty$ 时，这个概率也趋于 $0$。这意味着如果链漫游到远尾，它将几乎总是拒绝提议并停留在状态 $x$。这种行为被恰当地描述为“粘滯的”。\n\n**结论：正确**\n\n**C. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么链的不变分布将不再是 $\\,\\pi\\,$，因为在这种不匹配下，从中心到尾部的提议总是被拒绝。**\n\n这个陈述是不正确的。正如在对陈述A的分析中所阐明的，M-H核被构造为相对于 $\\pi$ 是可逆的。相对于分布 $\\pi$ 的可逆性的一个推论是，$\\pi$ 是链的一个平稳（或不变）分布。由尾部不匹配引起的问题关系到链有效探索状态空间并收敛到 $\\pi$ 的能力，而不是不变分布本身的身份。\n此外，所提供的推理是有缺陷的。一个从中心（状态 $x$）到尾部（状态 $y$，其中 $|y|\\to\\infty$）的提议的接受概率是 $\\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y)/q(y)}{\\pi(x)/q(x)} \\right)$。对于一个固定的中心状态 $x$，$\\pi(x)/q(x)$ 是一个有限常数。当 $|y|\\to\\infty$ 时，$\\pi(y)/q(y) \\to \\infty$。因此，最小值内的比率趋于 $\\infty$，并且 $\\alpha(x,y) \\to 1$。移动到尾部的提议实际上以趋近于1的概率被接受。问题不是拒绝；而是这种移动几乎从未被*提议*，因为 $y$ 是从轻尾分布 $q$ 中抽取的。\n\n**结论：不正确**\n\n**D. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾但在 $\\,\\mathbb{R}\\,$ 上有全支撑，那么尽管 $\\,\\pi\\,$ 是平穩的，链不可能是Harris常返的。**\n\n这个陈述是不正确的。如果一个马尔可夫链从任何起点 $x_0$ 出发，到达任何集合 $A$（其中 $\\pi(A) > 0$）的概率为正，则该链是 $\\pi$-不可约的。对于独立采样器，如果提议密度 $q(y)$ 在所有 $\\pi(y)$ 为正的地方都为正（这里满足这个条件，因为高斯分布和学生t分布在 $\\mathbb{R}$ 上都有全支撑），那么链就是 $\\pi$-不可约的。MCMC理论中的标准结果（例如，Mengersen 和 Tweedie, 1996）指出，一个 $\\pi$-不可约的M-H链是Harris常返的。Harris常返意味着链保证会无限次访问任何具有正$\\pi$-测度的集合。陈述B中描述的“粘滞性”影响了收敛和探索的*速率*（即链不是几何遍历的），但它并不阻止链最终离开尾部并探索整个空间。因此，链实际上是Harris常返的。\n\n**结论：不正确**\n\n**E. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么链不可能是一致遍历的，因为在这种情况下 $\\,\\sup_{x\\in\\mathbb{R}} \\pi(x)/q(x) = \\infty\\,$，这排除了一个全局次要化条件。**\n\n这个陈述是正确的。如果一个马尔可夫链在全变差距离下到平稳分布 $\\pi$ 的收敛是一致快速的，即对于某个与初始状态 $x$ 无关的 $R < \\infty$ 和 $\\rho < 1$，有 $\\|P^n(x, \\cdot) - \\pi(\\cdot)\\|_{TV} \\le R \\rho^n$，则该链是一致遍历的。独立采样器是一致遍历的一个充分必要条件是目标密度与提议密度的比率是一致有界的：\n$$ \\sup_{x\\in\\mathbb{R}} \\frac{\\pi(x)}{q(x)} < \\infty $$\n如前所述，当 $\\pi$ 是重尾而 $q$ 是轻尾时，这个条件被违反了；上确界是无穷大。这个条件之所以必要，是因为一致遍历性等价于存在一个全局次要化条件，形式为 $P(x, \\mathrm{d}y) \\ge \\epsilon \\nu(\\mathrm{d}y)$，其中 $\\epsilon > 0$ 且 $\\nu$ 是一个概率测度。如果 $\\sup_x \\pi(x)/q(x) = \\infty$，可以证明对于任何潜在的次要化测度，当 $x$ 被带到尾部时，转移核的下界必须趋于 $0$，从而排除了一个一致的（即独立于 $x$ 的）次要化。因此，链不可能是一致遍历的，所提供的推理是合理的。\n\n**结论：正确**",
            "answer": "$$\\boxed{ABE}$$"
        }
    ]
}