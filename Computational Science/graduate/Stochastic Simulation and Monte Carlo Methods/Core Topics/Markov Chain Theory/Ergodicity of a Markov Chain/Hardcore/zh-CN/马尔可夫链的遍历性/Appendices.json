{
    "hands_on_practices": [
        {
            "introduction": "分析任何马尔可夫链的第一步是理解其状态空间的结构。本练习提供了一个直接的机会，来实践识别马尔可夫链的互通类，并理解链的可约性如何影响其长期行为。通过计算一个具有多个闭集的可约链的极限行为，你将加深对遍历性定理在更一般情况下应用的理解。",
            "id": "3305963",
            "problem": "考虑一个时间齐次的离散时间马尔可夫链，其有限状态空间为 $\\mathcal{X} = \\{1,2,3,4,5,6,7\\}$。转移概率矩阵 $P$ 由以下各行给出（每行元素之和为 $1$）：\n$$\nP(1,\\cdot) = \\left(\\tfrac{1}{2}, \\tfrac{1}{2}, 0, 0, 0, 0, 0\\right),\\quad\nP(2,\\cdot) = \\left(\\tfrac{1}{3}, \\tfrac{2}{3}, 0, 0, 0, 0, 0\\right),\n$$\n$$\nP(3,\\cdot) = \\left(0, 0, \\tfrac{1}{2}, \\tfrac{1}{4}, \\tfrac{1}{4}, 0, 0\\right),\\quad\nP(4,\\cdot) = \\left(0, 0, \\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}, 0, 0\\right),\n$$\n$$\nP(5,\\cdot) = \\left(0, 0, \\tfrac{1}{4}, \\tfrac{1}{2}, \\tfrac{1}{4}, 0, 0\\right),\\quad\nP(6,\\cdot) = \\left(\\tfrac{1}{4}, \\tfrac{1}{4}, \\tfrac{1}{2}, 0, 0, 0, 0\\right),\n$$\n$$\nP(7,\\cdot) = \\left(0, 0, 0, \\tfrac{3}{5}, \\tfrac{1}{5}, 0, \\tfrac{1}{5}\\right).\n$$\n你可以假定以下标准定义：马尔可夫链是具有马尔可夫性质的随机变量序列 $(X_{n})_{n \\geq 0}$；如果状态 $i$ 能在有限步内以正概率到达状态 $j$，并且状态 $j$ 也能在有限步内以正概率到达状态 $i$，则两个状态 $i,j \\in \\mathcal{X}$ 互通；如果链一旦进入一个互通类就无法离开，则该互通类是闭的；如果链只有一个互通类，则该链是不可约的；一个类上的平稳分布 $\\pi$ 满足 $\\pi = \\pi P$ 且 $\\sum_{x} \\pi(x) = 1$；马尔可夫链的遍历定理保证了对于一个正常返、非周期、不可约的类，时间平均几乎必然收敛到其平稳分布下的期望值。\n\n定义函数 $g:\\mathcal{X}\\to\\mathbb{R}$ 为 $g(1)=0$, $g(2)=2$, $g(3)=3$, $g(4)=4$, $g(5)=5$, $g(6)=6$, $g(7)=7$。初始分布集中在状态 $6$ 和 $7$上：$\\mathbb{P}(X_{0}=6)=\\tfrac{2}{3}$ 且 $\\mathbb{P}(X_{0}=7)=\\tfrac{1}{3}$。\n\n任务：\n- 仅使用上述核心定义，确定链的互通类并指出哪些是闭的。判断该链是不可约的还是可约的。\n- 对每个闭类，直接根据给定的 $P$ 证明其正常返和非周期性，并从定义方程 $\\pi=\\pi P$ 和 $\\sum \\pi = 1$ 导出其平稳分布。\n- 利用这些结构性事实和基础性结果，确定经验时间平均的几乎必然极限\n$$\n\\lim_{n\\to\\infty}\\frac{1}{n}\\sum_{k=0}^{n-1} g\\!\\left(X_{k}\\right).\n$$\n将你的最终答案表示为单个精确实数。无需四舍五入。",
            "solution": "用户希望我解决一个关于离散时间马尔可夫链的问题。\n\n### 步骤1：提取已知条件\n- **状态空间**：$\\mathcal{X} = \\{1, 2, 3, 4, 5, 6, 7\\}$。\n- **转移概率** $P(i, j)$:\n  - $P(1, \\cdot) = (\\frac{1}{2}, \\frac{1}{2}, 0, 0, 0, 0, 0)$\n  - $P(2, \\cdot) = (\\frac{1}{3}, \\frac{2}{3}, 0, 0, 0, 0, 0)$\n  - $P(3, \\cdot) = (0, 0, \\frac{1}{2}, \\frac{1}{4}, \\frac{1}{4}, 0, 0)$\n  - $P(4, \\cdot) = (0, 0, \\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}, 0, 0)$\n  - $P(5, \\cdot) = (0, 0, \\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}, 0, 0)$\n  - $P(6, \\cdot) = (\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{2}, 0, 0, 0, 0)$\n  - $P(7, \\cdot) = (0, 0, 0, \\frac{3}{5}, \\frac{1}{5}, 0, \\frac{1}{5})$\n- **函数** $g:\\mathcal{X} \\to \\mathbb{R}$:\n  - $g(1)=0$, $g(2)=2$, $g(3)=3$, $g(4)=4$, $g(5)=5$, $g(6)=6$, $g(7)=7$。\n- **初始分布**：\n  - $\\mathbb{P}(X_0=6) = \\frac{2}{3}$\n  - $\\mathbb{P}(X_0=7) = \\frac{1}{3}$\n- **定义**：\n  - 时间齐次的离散时间马尔可夫链，有限状态空间。\n  - 互通状态。\n  - 互通类。\n  - 闭类。\n  - 不可约链与可约链。\n  - 平稳分布 $\\pi = \\pi P$。\n  - 马尔可夫链的遍历定理。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上和数学上是合理的。这是马尔可夫链理论中的一个标准练习。每行的转移概率之和为 $1$。状态空间是有限的。在随机过程的背景下，所有术语都有明确的定义。任务是具体的，并且可以使用所提供的信息来解决。该问题是自洽的、一致的且适定的。尽管链是可约的，但要求最终答案为单个实数，这暗示着需要求解该随机极限的期望值，这是在此背景下的标准解释。\n\n### 步骤3：结论与行动\n问题有效。我将继续提供完整解答。\n\n### 解答\n\n解答按要求分为三部分：确定链的结构，分析其闭类，以及计算所要求的极限。\n\n**1. 互通类与可约性**\n我们通过分析状态转移来确定互通类。如果存在整数 $n, m \\ge 0$ 使得 $P^n(i, j)  0$ 且 $P^m(j, i)  0$，则称两个状态 $i$ 和 $j$ 互通，记为 $i \\leftrightarrow j$。\n\n- **状态 $1$ 和 $2$**：$P(1, 2) = \\frac{1}{2}  0$ 且 $P(2, 1) = \\frac{1}{3}  0$。因此，$1 \\leftrightarrow 2$。这构成一个互通类 $\\mathcal{C}_1 = \\{1, 2\\}$。对于任何 $i \\in \\mathcal{C}_1$ 和 $j \\notin \\mathcal{C}_1$，$P(i, j) = 0$。因此，$\\mathcal{C}_1$ 是一个闭类。\n\n- **状态 $3, 4, 5$**：\n  - $P(3, 4) = \\frac{1}{4}  0$ 且 $P(4, 3) = \\frac{1}{3}  0$，所以 $3 \\leftrightarrow 4$。\n  - $P(3, 5) = \\frac{1}{4}  0$ 且 $P(5, 3) = \\frac{1}{4}  0$，所以 $3 \\leftrightarrow 5$。\n  - 根据传递性，状态 $\\{3, 4, 5\\}$ 构成一个单一的互通类，$\\mathcal{C}_2 = \\{3, 4, 5\\}$。对于任何 $i \\in \\mathcal{C}_2$ 和 $j \\notin \\mathcal{C}_2$，$P(i, j) = 0$。因此，$\\mathcal{C}_2$ 是一个闭类。\n\n- **状态 $6$**：状态 $6$ 可以转移到状态 $1 \\in \\mathcal{C}_1$（因为 $P(6, 1) = \\frac{1}{4}  0$），也可以转移到状态 $3 \\in \\mathcal{C}_2$（因为 $P(6, 3) = \\frac{1}{2}  0$）。一旦链进入一个闭类，它就无法离开。因此，$\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 都不能转移回状态 $6$。所以状态 $6$ 是一个暂留态。\n\n- **状态 $7$**：状态 $7$ 可以转移到状态 $4 \\in \\mathcal{C}_2$（因为 $P(7, 4) = \\frac{3}{5}  0$）。由于 $\\mathcal{C}_2$ 是一个闭类，链在进入 $\\mathcal{C}_2$ 后无法返回状态 $7$。所以状态 $7$ 是一个暂留态。\n\n状态空间被划分为两个闭的互通类 $\\mathcal{C}_1 = \\{1, 2\\}$ 和 $\\mathcal{C}_2 = \\{3, 4, 5\\}$，以及一个暂留态集合 $\\mathcal{T} = \\{6, 7\\}$。由于该链拥有不止一个互通类，因此它是**可约的**。\n\n**2. 闭类的分析**\n\n对于每个闭类，我们分析其性质并找到其唯一的平稳分布。\n\n**对 $\\mathcal{C}_1 = \\{1, 2\\}$ 的分析：**\n这个类的子随机矩阵是 $P_1 = \\begin{pmatrix} \\frac{1}{2}   \\frac{1}{2} \\\\ \\frac{1}{3}   \\frac{2}{3} \\end{pmatrix}$。\n- **正常返**：一个有限状态空间上的马尔可夫链是正常返的当且仅当它是不可约的。在 $\\mathcal{C}_1$ 上的子链是不可约的且状态数有限，因此它是正常返的。\n- **非周期性**：状态 $i$ 的周期是所有满足 $P^n(i, i)  0$ 的 $n \\ge 1$ 的最大公约数。因为 $P(1, 1) = \\frac{1}{2}  0$，状态 $1$ 的周期是 $d(1) = \\text{gcd}(1, \\dots) = 1$。由于同一互通类中的所有状态共享相同的周期，所以类 $\\mathcal{C}_1$ 是非周期的。\n- **平稳分布**：设 $\\pi_1 = (\\pi_1(1), \\pi_1(2))$ 是平稳分布。它必须满足 $\\pi_1 = \\pi_1 P_1$ 和 $\\pi_1(1) + \\pi_1(2) = 1$。\n$$ (\\pi_1(1), \\pi_1(2)) = (\\pi_1(1), \\pi_1(2)) \\begin{pmatrix} \\frac{1}{2}   \\frac{1}{2} \\\\ \\frac{1}{3}   \\frac{2}{3} \\end{pmatrix} $$\n这给出了方程 $\\pi_1(1) = \\frac{1}{2}\\pi_1(1) + \\frac{1}{3}\\pi_1(2)$，简化为 $\\frac{1}{2}\\pi_1(1) = \\frac{1}{3}\\pi_1(2)$，即 $3\\pi_1(1) = 2\\pi_1(2)$。\n使用 $\\pi_1(2) = 1 - \\pi_1(1)$，我们有 $3\\pi_1(1) = 2(1 - \\pi_1(1)) = 2 - 2\\pi_1(1)$。\n这得到 $5\\pi_1(1) = 2$，所以 $\\pi_1(1) = \\frac{2}{5}$。因此，$\\pi_1(2) = 1 - \\frac{2}{5} = \\frac{3}{5}$。\n$\\mathcal{C}_1$ 的平稳分布是 $\\pi_1 = (\\frac{2}{5}, \\frac{3}{5})$。\n\n**对 $\\mathcal{C}_2 = \\{3, 4, 5\\}$ 的分析：**\n其子随机矩阵为 $P_2 = \\begin{pmatrix} \\frac{1}{2}   \\frac{1}{4}   \\frac{1}{4} \\\\ \\frac{1}{3}   \\frac{1}{3}   \\frac{1}{3} \\\\ \\frac{1}{4}   \\frac{1}{2}   \\frac{1}{4} \\end{pmatrix}$。\n- **正常返**：与 $\\mathcal{C}_1$ 相同，这是一个有限、不可约的子链，因此是正常返的。\n- **非周期性**：因为 $P(3, 3) = \\frac{1}{2}  0$，状态 $3$ 的周期为 $1$，所以类 $\\mathcal{C}_2$ 是非周期的。\n- **平稳分布**：设 $\\pi_2 = (\\pi_2(3), \\pi_2(4), \\pi_2(5))$ 是平稳分布。我们求解 $\\pi_2 = \\pi_2 P_2$ 并满足 $\\sum_{i=3}^5 \\pi_2(i) = 1$。\n\\begin{align*} \\pi_2(3) = \\frac{1}{2}\\pi_2(3) + \\frac{1}{3}\\pi_2(4) + \\frac{1}{4}\\pi_2(5) \\\\ \\pi_2(4) = \\frac{1}{4}\\pi_2(3) + \\frac{1}{3}\\pi_2(4) + \\frac{1}{2}\\pi_2(5) \\\\ \\pi_2(5) = \\frac{1}{4}\\pi_2(3) + \\frac{1}{3}\\pi_2(4) + \\frac{1}{4}\\pi_2(5) \\end{align*}\n简化这些方程得到：\n\\begin{align*} \\frac{1}{2}\\pi_2(3) = \\frac{1}{3}\\pi_2(4) + \\frac{1}{4}\\pi_2(5) \\implies 6\\pi_2(3) = 4\\pi_2(4) + 3\\pi_2(5) \\\\ \\frac{2}{3}\\pi_2(4) = \\frac{1}{4}\\pi_2(3) + \\frac{1}{2}\\pi_2(5) \\implies 8\\pi_2(4) = 3\\pi_2(3) + 6\\pi_2(5) \\end{align*}\n使用归一化条件 $\\pi_2(5) = 1 - \\pi_2(3) - \\pi_2(4)$，我们代入简化后的方程：\n$6\\pi_2(3) = 4\\pi_2(4) + 3(1 - \\pi_2(3) - \\pi_2(4)) \\implies 9\\pi_2(3) = \\pi_2(4) + 3 \\implies \\pi_2(4) = 9\\pi_2(3) - 3$。\n$8\\pi_2(4) = 3\\pi_2(3) + 6(1 - \\pi_2(3) - \\pi_2(4)) \\implies 14\\pi_2(4) = 6 - 3\\pi_2(3)$。\n将 $\\pi_2(4)$ 的表达式代入第二个方程：\n$14(9\\pi_2(3) - 3) = 6 - 3\\pi_2(3) \\implies 126\\pi_2(3) - 42 = 6 - 3\\pi_2(3) \\implies 129\\pi_2(3) = 48$。\n$\\pi_2(3) = \\frac{48}{129} = \\frac{16}{43}$。\n然后 $\\pi_2(4) = 9(\\frac{16}{43}) - 3 = \\frac{144 - 129}{43} = \\frac{15}{43}$。\n并且 $\\pi_2(5) = 1 - \\frac{16}{43} - \\frac{15}{43} = \\frac{43 - 31}{43} = \\frac{12}{43}$。\n$\\mathcal{C}_2$ 的平稳分布是 $\\pi_2 = (\\frac{16}{43}, \\frac{15}{43}, \\frac{12}{43})$。\n\n**3. 长期时间平均极限**\n极限 $L = \\lim_{n\\to\\infty}\\frac{1}{n}\\sum_{k=0}^{n-1} g(X_k)$ 的值取决于链被哪个闭类吸收。在暂留态上花费的有限时间的贡献在极限中消失。根据马尔可夫链的遍历定理，如果链被类 $\\mathcal{C}_i$ 吸收，极限将是 $\\mathbb{E}_{\\pi_i}[g(X)] = \\sum_{j \\in \\mathcal{C}_i} g(j)\\pi_i(j)$。\n问题要求一个单一的数值答案，这意味着我们应该计算这个随机极限的期望值 $\\mathbb{E}[L]$，给定 $X_0$ 的初始分布。\n$$ \\mathbb{E}[L] = \\mathbb{P}(\\text{在 } \\mathcal{C}_1 \\text{ 中被吸收}) \\cdot \\mathbb{E}_{\\pi_1}[g] + \\mathbb{P}(\\text{在 } \\mathcal{C}_2 \\text{ 中被吸收}) \\cdot \\mathbb{E}_{\\pi_2}[g] $$\n设 $h_i = \\mathbb{P}(\\text{在 } \\mathcal{C}_1 \\text{ 中被吸收} | X_0 = i)$。对于 $i \\in \\mathcal{C}_1$，$h_i=1$。对于 $i \\in \\mathcal{C}_2$，$h_i=0$。对于暂留态 $i \\in \\mathcal{T}$，$h_i = \\sum_{j \\in \\mathcal{X}} P(i,j)h_j$。\n$h_6 = P(6,1)h_1 + P(6,2)h_2 + P(6,3)h_3 = \\frac{1}{4}(1) + \\frac{1}{4}(1) + \\frac{1}{2}(0) = \\frac{1}{2}$。\n$h_7 = P(7,4)h_4 + P(7,5)h_5 + P(7,7)h_7 = \\frac{3}{5}(0) + \\frac{1}{5}(0) + \\frac{1}{5}h_7 \\implies \\frac{4}{5}h_7 = 0 \\implies h_7 = 0$。\n\n被 $\\mathcal{C}_1$ 吸收的总概率是：\n$\\mathbb{P}(\\text{在 } \\mathcal{C}_1 \\text{ 中被吸收}) = \\mathbb{P}(X_0=6)h_6 + \\mathbb{P}(X_0=7)h_7 = \\frac{2}{3} \\cdot \\frac{1}{2} + \\frac{1}{3} \\cdot 0 = \\frac{1}{3}$。\n被 $\\mathcal{C}_2$ 吸收的概率是 $1 - \\frac{1}{3} = \\frac{2}{3}$。\n\n现在我们计算在每个平稳分布下 $g$ 的期望值：\n$\\mathbb{E}_{\\pi_1}[g] = g(1)\\pi_1(1) + g(2)\\pi_1(2) = 0 \\cdot \\frac{2}{5} + 2 \\cdot \\frac{3}{5} = \\frac{6}{5}$。\n$\\mathbb{E}_{\\pi_2}[g] = g(3)\\pi_2(3) + g(4)\\pi_2(4) + g(5)\\pi_2(5) = 3 \\cdot \\frac{16}{43} + 4 \\cdot \\frac{15}{43} + 5 \\cdot \\frac{12}{43} = \\frac{48 + 60 + 60}{43} = \\frac{168}{43}$。\n\n最后，我们计算该极限的期望值：\n$\\mathbb{E}[L] = \\left(\\frac{1}{3}\\right) \\cdot \\mathbb{E}_{\\pi_1}[g] + \\left(\\frac{2}{3}\\right) \\cdot \\mathbb{E}_{\\pi_2}[g]$\n$\\mathbb{E}[L] = \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{6}{5}\\right) + \\left(\\frac{2}{3}\\right) \\cdot \\left(\\frac{168}{43}\\right)$\n$\\mathbb{E}[L] = \\frac{2}{5} + \\frac{2 \\cdot 168}{3 \\cdot 43} = \\frac{2}{5} + \\frac{336}{129}$\n由于 $129 = 3 \\cdot 43$ 且 $336 = 3 \\cdot 112$，第二项可以简化：\n$\\mathbb{E}[L] = \\frac{2}{5} + \\frac{112}{43}$\n为了对这些分数求和，我们找到一个公分母，即 $5 \\cdot 43 = 215$。\n$\\mathbb{E}[L] = \\frac{2 \\cdot 43}{5 \\cdot 43} + \\frac{112 \\cdot 5}{43 \\cdot 5} = \\frac{86}{215} + \\frac{560}{215} = \\frac{86 + 560}{215} = \\frac{646}{215}$。\n这个分数是不可约的，因为 $646 = 2 \\cdot 17 \\cdot 19$ 且 $215 = 5 \\cdot 43$。\n最终结果是几乎必然极限的期望值。",
            "answer": "$$\\boxed{\\frac{646}{215}}$$"
        },
        {
            "introduction": "理论上的遍历性并不能保证在实际模拟中取得成功，尤其是在面对多模态分布时。本练习使用一个物理类比——双势阱中的粒子——来量化“亚稳态”这一概念，它揭示了指数级增长的等待时间如何使一个理论上遍历的链在有限时间内表现出非遍历性。通过推导平均隧穿时间，你将对蒙特卡洛模拟中的混合时间挑战有更深刻的直观认识。",
            "id": "3305937",
            "problem": "考虑一个一维目标分布，其密度为 $\\pi(x) \\propto \\exp(-\\beta V(x))$，其中势 $V:\\mathbb{R}\\to\\mathbb{R}$ 为双阱势\n$$\nV(x) = \\frac{(x^{2}-a^{2})^{2}}{4},\n$$\n其中 $a0$ 为固定值，$\\beta0$ 为逆温度。设 $\\{X_{n}\\}_{n\\geq 0}$ 是一个以 $\\pi$ 为目标分布、步长为 $h0$ 的Metropolis调整朗之万算法 (MALA, Metropolis Adjusted Langevin Algorithm) 马尔可夫链，其提议由下式定义\n$$\nY = X_{n} - h\\,\\nabla V(X_{n}) + \\sqrt{\\frac{2h}{\\beta}}\\,\\xi_{n}, \\quad \\xi_{n}\\sim \\mathcal{N}(0,1),\n$$\n并以保证 $\\pi$ 不变的 标准Metropolis–Hastings接受概率被接受。假设在小步长和低噪声的情况下，即 $h\\to 0$ 且 $\\beta\\to\\infty$，其中 $h$ 足够小，使得在势阱中的接受率接近于1，并且该链可以由过阻尼朗之万扩散很好地近似\n$$\n\\mathrm{d}X_{t} = -\\nabla V(X_{t})\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\beta}}\\,\\mathrm{d}W_{t},\n$$\n并且认定一次MALA迭代对应于该扩散的Euler–Maruyama时间增量 $\\Delta t \\approx h$。\n\n设 $\\tau_{h}$ 为从右阱到左阱邻域的首次到达时间（以MALA迭代次数计算），其定义为从集中在 $x=+a$ 附近的 $X_{0}$ 开始\n$$\n\\tau_{h} = \\inf\\{n\\geq 1: X_{n}\\in (-\\infty,-a+\\delta)\\}\n$$\n其中 $\\delta\\in(0,a)$ 是某个固定的很小的值，并且我们知道势垒穿越是通过 $x=0$ 处的鞍点发生的。使用适用于过阻尼扩散的势论大偏差思想（Eyring–Kramers论证），推导当 $\\beta\\to\\infty$ 和 $h\\to 0$ 时，平均隧穿时间 $\\mathbb{E}[\\tau_{h}]$ 的领头阶渐近表达式（以闭式形式），并用 $a$、$\\beta$ 和 $h$ 表示。然后简要解释该渐近表达式如何导致有限时间马尔可夫链蒙特卡洛（MCMC, Markov Chain Monte Carlo）采样中的亚稳态和表观非遍历性。请以单个解析表达式的形式提供 $\\mathbb{E}[\\tau_{h}]$ 的最终答案。无需进行四舍五入。",
            "solution": "该问题陈述是随机过程理论在分析马尔可夫链蒙特卡洛（MCMC）算法性能方面的一个有效应用。所有提供的信息都是自洽的，在统计力学和随机微积分领域具有科学依据，并且在数学上是适定的。我们开始进行解答。\n\n该问题要求推导 Metropolis调整朗之万算法（MALA）链在双阱势的两个势阱之间跃遷所需的平均迭代次数 $\\mathbb{E}[\\tau_h]$ 的领头阶渐近表达式。分析将在低噪声（$\\beta \\to \\infty$）和小步长（$h \\to 0$）的情况下进行，此时MALA动力学可以由过阻尼朗之万扩散很好地近似。\n\n目标分布的概率密度为 $\\pi(x) \\propto \\exp(-\\beta V(x))$，其中势由下式给出\n$$\nV(x) = \\frac{(x^{2}-a^{2})^{2}}{4}.\n$$\n相应的过阻尼朗之万扩散为\n$$\n\\mathrm{d}X_{t} = -\\nabla V(X_{t})\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\beta}}\\,\\mathrm{d}W_{t},\n$$\n其中 $W_t$ 是标准维纳过程。问题陈述指出，步长为 $h$ 的单次MALA迭代对应于此扩散过程的时间增量 $\\Delta t = h$。\n\n这样一个过程从势阱中逃逸的平均时间可以使用Eyring-Kramers公式计算。首先，我们必须确定势 $V(x)$ 的极小值点（稳定态）和鞍点（过渡态）。通过将势的一阶导数设为零来找到临界点。\n势的梯度（在一维情况下即为导数）是\n$$\n\\nabla V(x) = V'(x) = \\frac{d}{dx}\\left[\\frac{(x^{2}-a^{2})^{2}}{4}\\right] = \\frac{1}{4} \\cdot 2(x^{2}-a^{2}) \\cdot (2x) = x(x^{2}-a^{2}).\n$$\n令 $V'(x)=0$ 可得到临界点 $x=0$、$x=a$ 和 $x=-a$。\n\n为了对这些点进行分类，我们计算二阶导数：\n$$\nV''(x) = \\frac{d}{dx}[x^{3}-a^{2}x] = 3x^{2}-a^{2}.\n$$\n我们在每个临界点计算 $V''(x)$ 的值：\n- 在 $x = \\pm a$ 处：$V''(\\pm a) = 3(\\pm a)^{2} - a^{2} = 2a^{2}$。由于 $a0$，有 $V''(\\pm a)  0$，这表明 $x=\\pm a$ 是局部极小值点，对应于两个勢阱的底部。\n- 在 $x=0$ 处：$V''(0) = 3(0)^{2} - a^{2} = -a^{2}$。由于 $V''(0)  0$，$x=0$ 是一个局部极大值点，它作为两个勢阱之间跃迁的鞍点。\n\n从右阱（$x=a$ 附近）到左阱（$x=-a$ 附近）的跃迁需要系统克服位于 $x=0$ 的势垒。这个势垒的高度 $\\Delta V$ 是鞍点处的势与极小值点处的势之差：\n$$\nV(a) = \\frac{(a^{2}-a^{2})^{2}}{4} = 0.\n$$\n$$\nV(0) = \\frac{(0^{2}-a^{2})^{2}}{4} = \\frac{(-a^{2})^{2}}{4} = \\frac{a^{4}}{4}.\n$$\n$$\n\\Delta V = V(0) - V(a) = \\frac{a^{4}}{4} - 0 = \\frac{a^{4}}{4}.\n$$\n\n对于由给定朗之万方程描述的一维系统，从极小值点 $x_{min}$ 越过鞍点 $x_{sad}$ 逃逸的平均首次穿越时间 $\\mathbb{E}[\\tau_{cont}]$ 的Eyring-Kramers公式为：\n$$\n\\mathbb{E}[\\tau_{cont}] \\approx \\frac{2\\pi}{\\sqrt{V''(x_{min})|V''(x_{sad})|}} \\exp(\\beta \\Delta V).\n$$\n在我们的问题中，起始极小值点是 $x_{min}=a$，鞍点是 $x_{sad}=0$。代入我们之前计算的值：\n- $V''(x_{min}) = V''(a) = 2a^{2}$\n- $|V''(x_{sad})| = |V''(0)| = |-a^{2}| = a^{2}$\n- $\\Delta V = a^{4}/4$\n\n因此，在连续时间扩散模型中的平均跃迁时间为：\n$$\n\\mathbb{E}[\\tau_{cont}] \\approx \\frac{2\\pi}{\\sqrt{(2a^{2})(a^{2})}} \\exp\\left(\\beta \\frac{a^{4}}{4}\\right) = \\frac{2\\pi}{\\sqrt{2a^{4}}} \\exp\\left(\\frac{\\beta a^{4}}{4}\\right) = \\frac{2\\pi}{a^{2}\\sqrt{2}} \\exp\\left(\\frac{\\beta a^{4}}{4}\\right).\n$$\n简化指前因子得到：\n$$\n\\mathbb{E}[\\tau_{cont}] \\approx \\frac{\\pi\\sqrt{2}}{a^{2}} \\exp\\left(\\frac{\\beta a^{4}}{4}\\right).\n$$\n这个表达式表示的是以连续朗之万过程的时间单位计量的平均时间。问题要求的是MALA的平均迭代次数 $\\mathbb{E}[\\tau_{h}]$。我们已知一次MALA迭代对应于一个时间步长 $\\Delta t = h$。因此，为了求得迭代次数，我们将总连续时间除以每次迭代的时间：\n$$\n\\mathbb{E}[\\tau_{h}] = \\frac{\\mathbb{E}[\\tau_{cont}]}{\\Delta t} = \\frac{\\mathbb{E}[\\tau_{cont}]}{h}.\n$$\n代入 $\\mathbb{E}[\\tau_{cont}]$ 的表达式，我们得到以Mala迭代次数计量的平均隧穿时间的最终渐近表达式：\n$$\n\\mathbb{E}[\\tau_{h}] \\approx \\frac{\\pi\\sqrt{2}}{h a^{2}} \\exp\\left(\\frac{\\beta a^{4}}{4}\\right).\n$$\n\n这个渐近结果解释了MCMC模拟中的亚稳态和表观非遍历性现象。\n\n亚稳态：平均跃迁时间 $\\mathbb{E}[\\tau_{h}]$ 随 $\\beta a^{4}$ 项呈指数增长。在低噪声情况（$\\beta \\gg 1$）下，这个时间变得极长。如果一个系统一旦进入某个状态，会在很长时间内保持在该状态，然后才跃迁到更稳定或稳定性相似的其他状态，则该状态被称为亚稳态。在这里，$x=\\pm a$ 处的势阱邻域就是亞稳态。\n\n表观非遍历性：一个MCMC采样器如果能在足够长的时间内，按照目标分布 $\\pi(x)$ 探索整个状态空间，则它是遍历的。对于这个问题，$\\pi(x)$ 是双峰的，在 $x=\\pm a$ 处有对称的峰。一个真正的遍历采样器应该访问两个势阱，并根据模态的相等权重在它们之间分配样本。然而，看到一次势阱间跃迁所需的迭代次数 $\\mathbb{E}[\\tau_{h}]$ 很容易超过任何实际MCMC运行的总迭代次数。对于一个长度为 $N$ 的模拟，如果 $N \\ll \\mathbb{E}[\\tau_{h}]$，那么一个在一个势阱（例如，$x=a$附近）初始化的链将在整个模拟过程中被困在那里。它将无法对 $x=-a$ 附近分布的另一个模态进行采样。从此类运行计算出的经验平均值将不会收敛到 $\\pi(x)$ 下的真实期望。这造成了非遍历性的表象，因为链未能在实际的时间尺度上全局探索其状态空间。该链理论上是遍历的，但其混合时间是指数级大的，这使得它对于多峰分布的有限时间采样是无效的。",
            "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{2}}{h a^{2}} \\exp\\left(\\frac{\\beta a^{4}}{4}\\right)}\n$$"
        },
        {
            "introduction": "除了诊断遍历性，我们常常还需要分析收敛的“质量”，例如遍历均值的方差。这项高级练习引入了泊松方程，这是一个用于分析马尔可夫链核心性质的关键理论工具。通过为一个自回归过程求解该方程，你不仅能练习这一技术，还能将其与方差缩减等计算方法联系起来，并巩固几何遍历性等基本条件的重要性。",
            "id": "3305949",
            "problem": "考虑一个定义在 $\\mathbb{R}$ 上的时间齐次马尔可夫链，它由一阶自回归 (AR(1)) 更新式 $X_{n+1}=\\rho\\,X_n+\\xi_{n+1}$ 定义，其中 $\\{\\xi_n\\}_{n\\geq 1}$ 是一个独立同分布序列，满足 $\\xi_n\\sim\\mathcal{N}(0,\\tau^2)$，$\\rho\\in(-1,1)$ 且 $\\tau0$。设 $\\pi$ 表示唯一的平稳分布，设 $\\Pi$ 表示相关的马尔可夫核，它作用于有界可测函数 $g$ 的方式为 $\\Pi g(x)=\\mathbb{E}[g(\\rho x+\\xi)]$，其中 $\\xi\\sim\\mathcal{N}(0,\\tau^2)$ 且与 $x$ 无关。对于可观测量 $f(x)=x^2$，考虑该链的泊松方程，\n$$\ng-\\Pi g=f-\\pi(f),\n$$\n其中 $\\pi(f)=\\int_{\\mathbb{R}} f(x)\\,\\pi(\\mathrm{d}x)$ 表示在平稳分布下的期望。\n\n从平稳性、马尔可夫核和条件期望的基本定义出发，并且不使用超出这些定义的任何现成公式，完成以下任务：\n\n1. 通过应用平稳性的分布不动点性质以及随机变量仿射变换的基本矩关系，推导 $\\pi(f)$。\n2. 在次数最多为二的多项式函数类中求解上述关于 $g$ 的泊松方程，并通过施加归一化条件 $\\pi(g)=0$ 来确定典范解。\n3. 利用解的正则性，定义控制变量 $h(x)=g(x)-\\Pi g(x)$ 并分析调整后的估计量 $\\widehat{\\mu}_n(\\beta)=\\frac{1}{n}\\sum_{k=1}^{n} f(X_k)-\\beta\\,\\frac{1}{n}\\sum_{k=1}^{n} h(X_k)$，找出原则上能产生零方差的 $\\beta$ 值。解释解 $g$ 的存在性及其在 $\\pi$ 下的平方可积性如何依赖于由 $|\\rho|1$ 引起的几何遍历性，以及为何当 $|\\rho|\\geq 1$ 时可解性不成立。\n\n你的最终答案必须是步骤2中找到的典范解 $g(x)$ 的显式闭式解析表达式。不需要四舍五入。将你的最终答案表示为单个闭式表达式。",
            "solution": "所述问题具有科学依据、是适定的，并且包含足够的信息以获得唯一解。我们开始推导。\n\n问题要求针对一个由 AR($1$) 过程 $X_{n+1}=\\rho\\,X_n+\\xi_{n+1}$ 定义在状态空间 $\\mathbb{R}$ 上的时间齐次马尔可夫链，给出一个包含三部分的解答。参数被约束为 $\\rho\\in(-1,1)$ 且 $\\tau0$，其中 $\\{\\xi_n\\}$ 是一个服从分布 $\\mathcal{N}(0,\\tau^2)$ 的独立同分布随机变量序列。\n\n**1. 平稳期望 $\\pi(f)$ 的推导**\n\n平稳分布 $\\pi$ 是一个概率分布，满足如果 $X_n \\sim \\pi$，那么 $X_{n+1} = \\rho X_n + \\xi_{n+1}$ 也服从分布 $\\pi$。这就是分布不动点性质。设 $X \\sim \\pi$。我们可以通过应用此性质来求 $\\pi$ 的前两阶矩。\n\n在 $\\pi$ 下 $X$ 的均值为 $\\mu_\\pi = \\mathbb{E}_\\pi[X]$。对 AR($1$) 方程取期望，我们有：\n$$\n\\mathbb{E}_\\pi[X_{n+1}] = \\mathbb{E}_\\pi[\\rho X_n + \\xi_{n+1}]\n$$\n由于 $X_n$ 和 $X_{n+1}$ 都服从分布 $\\pi$，它们的期望相等，即 $\\mathbb{E}_\\pi[X_{n+1}] = \\mathbb{E}_\\pi[X_n] = \\mu_\\pi$。噪声项 $\\xi_{n+1}$ 与 $X_n$ 无关，且均值为 $\\mathbb{E}[\\xi_{n+1}]=0$。\n$$\n\\mu_\\pi = \\rho\\,\\mathbb{E}_\\pi[X_n] + \\mathbb{E}[\\xi_{n+1}] = \\rho\\,\\mu_\\pi + 0\n$$\n这得到方程 $\\mu_\\pi(1-\\rho) = 0$。因为 $\\rho \\in (-1,1)$，所以 $1-\\rho \\neq 0$，这意味着 $\\mu_\\pi = 0$。\n\n在 $\\pi$ 下 $X$ 的方差为 $\\sigma_\\pi^2 = \\text{Var}_\\pi(X) = \\mathbb{E}_\\pi[X^2] - (\\mathbb{E}_\\pi[X])^2$。由于 $\\mu_\\pi=0$，方差就是二阶矩：$\\sigma_\\pi^2 = \\mathbb{E}_\\pi[X^2]$。我们计算 $X_{n+1}$ 的方差：\n$$\n\\text{Var}_\\pi(X_{n+1}) = \\text{Var}_\\pi(\\rho X_n + \\xi_{n+1})\n$$\n由于 $X_n$ 与 $\\xi_{n+1}$ 无关，和的方差等于方差的和：\n$$\n\\text{Var}_\\pi(X_{n+1}) = \\text{Var}_\\pi(\\rho X_n) + \\text{Var}(\\xi_{n+1}) = \\rho^2 \\text{Var}_\\pi(X_n) + \\tau^2\n$$\n根据平稳性，$\\text{Var}_\\pi(X_{n+1}) = \\text{Var}_\\pi(X_n) = \\sigma_\\pi^2$。\n$$\n\\sigma_\\pi^2 = \\rho^2 \\sigma_\\pi^2 + \\tau^2\n$$\n整理得 $\\sigma_\\pi^2(1-\\rho^2) = \\tau^2$。由于 $|\\rho|1$，有 $1-\\rho^2  0$，我们可以解出方差：\n$$\n\\sigma_\\pi^2 = \\frac{\\tau^2}{1-\\rho^2}\n$$\n可观测量由 $f(x)=x^2$ 给出。量 $\\pi(f)$ 是 $f(X)$ 在平稳分布 $\\pi$ 下的期望：\n$$\n\\pi(f) = \\mathbb{E}_\\pi[f(X)] = \\mathbb{E}_\\pi[X^2]\n$$\n如前所述，这恰好是平稳分布的方差，因为其均值为零。\n$$\n\\pi(f) = \\sigma_\\pi^2 = \\frac{\\tau^2}{1-\\rho^2}\n$$\n这是一个已知的性质，对于具有高斯新息的AR($1$)过程，其唯一的平稳分布也是高斯分布。因此，$\\pi \\sim \\mathcal{N}(0, \\frac{\\tau^2}{1-\\rho^2})$。\n\n**2. 泊松方程的求解**\n\n我们必须求解泊松方程 $g-\\Pi g=f-\\pi(f)$，其中函数 $g$ 是一个次数最多为二的多项式。我们设 $g(x) = ax^2 + bx + c$，其中 $a, b, c$ 是待定常数。\n\n首先，我们计算马尔可夫核 $\\Pi$ 对 $g$ 的作用。该核定义为 $\\Pi g(x)=\\mathbb{E}[g(\\rho x+\\xi)]$，其中 $\\xi\\sim\\mathcal{N}(0,\\tau^2)$。\n$$\n\\Pi g(x) = \\mathbb{E}[a(\\rho x+\\xi)^2 + b(\\rho x+\\xi) + c]\n$$\n利用期望的线性性，并将 $x$ 视为关于 $\\xi$ 的期望的常数：\n$$\n\\Pi g(x) = a\\,\\mathbb{E}[(\\rho x+\\xi)^2] + b\\,\\mathbb{E}[\\rho x+\\xi] + c\n$$\n我们计算涉及 $\\xi$ 的期望。我们知道 $\\mathbb{E}[\\xi]=0$ 和 $\\mathbb{E}[\\xi^2]=\\text{Var}(\\xi)=\\tau^2$。\n$$\n\\mathbb{E}[\\rho x+\\xi] = \\rho x + \\mathbb{E}[\\xi] = \\rho x\n$$\n$$\n\\mathbb{E}[(\\rho x+\\xi)^2] = \\mathbb{E}[\\rho^2 x^2 + 2\\rho x \\xi + \\xi^2] = \\rho^2 x^2 + 2\\rho x \\mathbb{E}[\\xi] + \\mathbb{E}[\\xi^2] = \\rho^2 x^2 + \\tau^2\n$$\n将这些结果代回 $\\Pi g(x)$ 的表达式中：\n$$\n\\Pi g(x) = a(\\rho^2 x^2 + \\tau^2) + b(\\rho x) + c = a\\rho^2 x^2 + b\\rho x + (a\\tau^2 + c)\n$$\n现在我们计算泊松方程的左侧，$g(x) - \\Pi g(x)$：\n$$\ng(x) - \\Pi g(x) = (ax^2 + bx + c) - (a\\rho^2 x^2 + b\\rho x + a\\tau^2 + c)\n$$\n$$\ng(x) - \\Pi g(x) = (a-a\\rho^2)x^2 + (b-b\\rho)x - a\\tau^2 = a(1-\\rho^2)x^2 + b(1-\\rho)x - a\\tau^2\n$$\n泊松方程的右侧是 $f(x) - \\pi(f) = x^2 - \\frac{\\tau^2}{1-\\rho^2}$。\n令两个多项式相等，我们匹配 $x$ 各次幂的系数：\n$$\na(1-\\rho^2)x^2 + b(1-\\rho)x - a\\tau^2 = 1 \\cdot x^2 + 0 \\cdot x - \\frac{\\tau^2}{1-\\rho^2}\n$$\n- $x^2$ 的系数：$a(1-\\rho^2) = 1$。由于 $|\\rho|1$，$1-\\rho^2 \\neq 0$，所以 $a = \\frac{1}{1-\\rho^2}$。\n- $x$ 的系数：$b(1-\\rho) = 0$。由于 $|\\rho|1$，$1-\\rho \\neq 0$，所以 $b = 0$。\n- 常数项：$-a\\tau^2 = -\\frac{\\tau^2}{1-\\rho^2}$。代入我们求得的 $a$ 值：$-\\frac{1}{1-\\rho^2} \\tau^2 = -\\frac{\\tau^2}{1-\\rho^2}$。这是一致的，因此多项式形式是有效的。\n\n解的形式为 $g(x) = \\frac{1}{1-\\rho^2}x^2 + c$。为了找到典范解，我们施加归一化条件 $\\pi(g)=0$。\n$$\n\\pi(g) = \\mathbb{E}_\\pi[g(X)] = \\mathbb{E}_\\pi\\left[\\frac{1}{1-\\rho^2}X^2 + c\\right] = \\frac{1}{1-\\rho^2}\\mathbb{E}_\\pi[X^2] + c\n$$\n我们之前已经求得 $\\mathbb{E}_\\pi[X^2] = \\pi(f) = \\frac{\\tau^2}{1-\\rho^2}$。\n$$\n\\pi(g) = \\frac{1}{1-\\rho^2}\\left(\\frac{\\tau^2}{1-\\rho^2}\\right) + c = \\frac{\\tau^2}{(1-\\rho^2)^2} + c\n$$\n令 $\\pi(g)=0$ 可得 $c = -\\frac{\\tau^2}{(1-\\rho^2)^2}$。\n因此，典范解是：\n$$\ng(x) = \\frac{x^2}{1-\\rho^2} - \\frac{\\tau^2}{(1-\\rho^2)^2}\n$$\n\n**3. 控制变量分析及 $|\\rho|1$ 的作用**\n\n控制变量定义为 $h(x) = g(x) - \\Pi g(x)$。根据泊松方程，这恰好是 $h(x) = f(x) - \\pi(f)$。$\\pi(f)$ 的调整后估计量是 $\\widehat{\\mu}_n(\\beta)=\\frac{1}{n}\\sum_{k=1}^{n} f(X_k)-\\beta\\,\\frac{1}{n}\\sum_{k=1}^{n} h(X_k)$。代入 $h(X_k)$ 的表达式：\n$$\n\\widehat{\\mu}_n(\\beta)=\\frac{1}{n}\\sum_{k=1}^{n} f(X_k)-\\beta\\,\\frac{1}{n}\\sum_{k=1}^{n} (f(X_k) - \\pi(f))\n$$\n$$\n\\widehat{\\mu}_n(\\beta) = (1-\\beta)\\left(\\frac{1}{n}\\sum_{k=1}^{n} f(X_k)\\right) + \\beta\\,\\pi(f)\n$$\n该估计量的误差是 $\\widehat{\\mu}_n(\\beta) - \\pi(f) = (1-\\beta)\\left(\\frac{1}{n}\\sum_{k=1}^{n} f(X_k) - \\pi(f)\\right)$。误差的方差是 $(1-\\beta)^2 \\text{Var}\\left(\\frac{1}{n}\\sum_{k=1}^{n} f(X_k)\\right)$。为了实现零方差，我们必须选择 $\\beta=1$。当 $\\beta=1$ 时，估计量变为 $\\widehat{\\mu}_n(1) = \\pi(f)$，这正是精确值。这表明泊松方程的解提供了一个“完美”的控制变量，它在原则上将方差减小到零。这是理论上的，因为使用它需要知道 $\\pi(f)$，而这正是我们希望估计的量。\n\n条件 $|\\rho|1$ 确保了马尔可夫链是几何遍历的。该性质保证了对于任何中心化的可观测量 $\\phi$（即 $\\pi(\\phi)=0$）且在 $\\pi$ 下平方可积（即 $\\phi \\in L^2(\\pi)$），泊松方程 $\\ g-\\Pi g = \\phi$ 存在唯一的解 $g \\in L^2(\\pi)$（在归一化常数内）。在我们的例子中，$\\phi = f - \\pi(f) = x^2 - \\frac{\\tau^2}{1-\\rho^2}$。由于平稳分布 $\\pi$ 是高斯分布，其所有矩都是有限的，这意味着 $\\phi \\in L^2(\\pi)$ 并且我们的显式解 $g(x)$ 也在 $L^2(\\pi)$ 中。\n\n如果 $|\\rho| \\geq 1$，该链不再是几何遍历的（只要 $\\tau0$，当 $|\\rho|1$ 时是暂留的，当 $|\\rho|=1$ 时是零常返的）。不存在不变概率分布 $\\pi$。因此，$\\pi(f)$ 是未定义的。此外，从代数推导来看，$g(x)$ 中 $x^2$ 项的系数是 $a=\\frac{1}{1-\\rho^2}$。如果 $|\\rho|=1$，这个表达式是未定义的，表明不存在次数为2的多项式解。更根本地，算子 $(I-\\Pi)$ 在相关的函数空间上是不可逆的，这意味着泊松方程是病态的，对于给定的 $\\phi$ 通常没有解。形式级数解 $g = \\sum_{k=0}^\\infty \\Pi^k \\phi$ 的收敛性依赖于 $\\Pi$ 是一个压缩映射，这一性质与条件 $|\\rho|1$ 相关联。",
            "answer": "$$\n\\boxed{\\frac{x^2}{1-\\rho^2} - \\frac{\\tau^2}{(1-\\rho^2)^2}}\n$$"
        }
    ]
}