## 引言
[马尔可夫链](@entry_id:150828)的遍历性是[随机过程](@entry_id:159502)理论的基石，对于依赖模拟进行推断的现代计算科学，尤其是[马尔可夫链蒙特卡洛](@entry_id:138779)（MCMC）方法，具有不可或缺的重要性。它从根本上回答了一个关键问题：我们如何能确信一个[随机模拟](@entry_id:168869)过程在长时间运行后，能够充分探索其可能的状态，并稳定地反映出我们想要研究的那个目标系统的真实统计特性？若缺乏遍历性的保证，MCMC的输出可能仅仅是初始状态的偶然产物，无法提供可靠的科学结论。本文旨在系统性地梳理遍历性的理论、应用与实践，填补理论与应用之间的知识鸿沟。

为实现这一目标，本文将分为三个核心章节。首先，在“原理与机制”中，我们将深入剖析遍历性的数学构造，从不可约性、非周期性到[平稳分布](@entry_id:194199)，并阐明保证[MCMC方法](@entry_id:137183)有效性的[遍历定理](@entry_id:261967)与[中心极限定理](@entry_id:143108)。接着，在“应用与跨学科联系”中，我们将展示遍历性思想如何作为一种统一的语言，贯穿于物理、生物、计算机科学和经济学等多个领域，为各种复杂系统的长期行为建模提供理论支撑。最后，通过一系列精心设计的“动手实践”，您将有机会亲手解决与遍历性诊断、收敛速度分析和实际模拟挑战相关的问题，将抽象理论转化为具体的计算技能。通过这一结构化的学习路径，读者将全面掌握[马尔可夫链](@entry_id:150828)遍历性的精髓，并能够充满信心地将其应用于自己的研究与实践中。

## 原理与机制

在本章中，我们将深入探讨[马尔可夫链](@entry_id:150828)遍历性的核心原理与机制。遍历性是马尔可夫链蒙特卡洛（MCMC）方法成功的理论基石，它保证了模拟过程最终能够充分探索整个状态空间，并收敛到我们期望的目标分布。我们将从遍历性的基本构成要素（不可约性、[非周期性](@entry_id:275873)和[正常返](@entry_id:195139)）开始，逐步建立起[遍历定理](@entry_id:261967)的理论框架，并介绍一系列用于分析[收敛速度](@entry_id:636873)和诊断遍历性问题的强大工具。本章旨在通过严谨的定义和具体的计算实例，为您揭示遍历性理论的深度与广度。

### 遍历性层次：基本概念

[马尔可夫链的长期行为](@entry_id:272323)由其状态空间的结构特性决定。遍历性并非单一属性，而是由一系列相互关联的概念构成的层次结构。理解这些基本概念是掌握马尔可夫链理论的关键。

#### 不可约性与互通

**不可约性 (Irreducibility)** 是遍历性最基本的要求。它确保了[马尔可夫链](@entry_id:150828)可以从任何状态出发，在有限步内以正概率到达任何其他状态。换言之，状态空间中不存在链无法进入的“孤岛”。

为了形式化地定义不可约性，我们首先引入**互通 (communicate)** 的概念。如果状态 $i$ 可以在有限步内以正概率到达状态 $j$（记作 $i \to j$），并且状态 $j$ 也能在有限步内以正概率返回状态 $i$（记作 $j \to i$），我们就称状态 $i$ 和 $j$ 是互通的（记作 $i \leftrightarrow j$）。互通是一种等价关系，它将[状态空间](@entry_id:177074)划分为若干个不相交的**[互通类](@entry_id:267280) (communicating classes)**。

一个马尔可夫链被称为**不可约的**，如果其整个状态空间构成一个单一的[互通类](@entry_id:267280)。反之，如果[状态空间](@entry_id:177074)包含多个[互通类](@entry_id:267280)，则该链被称为**可约的 (reducible)**。

在一个可约的马尔可夫链中，某些[互通类](@entry_id:267280)可能是**[闭集](@entry_id:136446) (closed)**，意味着一旦链进入该类，就再也无法离开。

考虑一个具体例子以阐明这些概念 。一个具有状态空间 $\mathcal{X} = \{1,2,3,4,5,6,7\}$ 的[马尔可夫链](@entry_id:150828)，其转移矩阵 $P$ 的结构使得：
- 状态 $\{1, 2\}$ 之间可以相互转移，但不能转移到任何其他状态。因此，$\mathcal{C}_1 = \{1, 2\}$ 构成一个[闭互通类](@entry_id:273537)。
- 状态 $\{3, 4, 5\}$ 之间可以相互转移，但也不能转移到任何其他状态。因此，$\mathcal{C}_2 = \{3, 4, 5\}$ 构成另一个[闭互通类](@entry_id:273537)。
- 状态 $6$ 可以转移到类 $\mathcal{C}_1$ 和 $\mathcal{C}_2$ 中的状态，但一旦离开，便无法返回。
- 状态 $7$ 可以转移到类 $\mathcal{C}_2$ 中的状态，但同样无法返回。

在这个例子中，[状态空间](@entry_id:177074)被分解为两个[闭互通类](@entry_id:273537)（$\mathcal{C}_1$ 和 $\mathcal{C}_2$）以及一个由**瞬时状态 (transient states)** 组成的集合 $\mathcal{T} = \{6, 7\}$。由于存在多个[互通类](@entry_id:267280)，该[马尔可夫链](@entry_id:150828)是可约的。这种结构在MCMC中可能出现，例如，当目标分布具有多个被低概率区域隔开的模式（modes）时，模拟算法可能被困在其中一个模式内，无法有效地探索整个[分布](@entry_id:182848) 。

#### 周期性与非周期性

**周期性 (Periodicity)** 描述了马尔可夫链返回某个状态的规律性。一个状态 $i$ 的**周期 (period)** $d(i)$ 定义为所有可能从 $i$ 出发经过 $n$ 步后首次返回 $i$ 的步数 $n$ 的[最大公约数](@entry_id:142947)。在同一个[互通类](@entry_id:267280)中，所有[状态的周期](@entry_id:276903)都相同。

如果一个不可约[马尔可夫链的周期](@entry_id:265835)为 $1$，我们称之为**非周期的 (aperiodic)**。非周期性排除了链的行为被困在一个固定的循环模式中的可能性。一个简单的判断非周期性的充分条件是链中存在**[自环](@entry_id:274670) (self-loops)**，即对于至少一个状态 $i$（对于不[可约链](@entry_id:200553)，则是所有状态），其一步转移回自身的概率 $P(i,i) > 0$。例如，在前述例子  的[闭互通类](@entry_id:273537)中，以及在对高维超立方体进行坐标更新的[吉布斯采样器](@entry_id:265671)中 ，每个状态都存在正的自返概率，因此这些子链都是非周期的。

#### [正常返](@entry_id:195139)与瞬时

**[正常返](@entry_id:195139) (Recurrence)** 和**瞬时 (Transience)** 描述了链从一个状态出发后是否必然会返回。如果从状态 $i$ 出发，最终返回状态 $i$ 的概率为 $1$，则称状态 $i$ 是**常返的 (recurrent)**；否则为瞬时的。对于一个常返状态 $i$，我们还关心其平均返回时间。如果平均返回时间是有限的，则称该状态为**[正常返](@entry_id:195139)的 (positive recurrent)**；否则为**[零常返的](@entry_id:201833) (null recurrent)**。

在有限[状态空间](@entry_id:177074)中，这些概念得到了简化：一个不可约马尔可夫链中的所有状态要么都是[正常返](@entry_id:195139)的，要么都是瞬时的（后者仅在链不封闭时可能发生）。因此，对于一个有限、不可约的[马尔可夫链](@entry_id:150828)，所有状态都是[正常返](@entry_id:195139)的。对于一般（可能为不可数）的[状态空间](@entry_id:177074)，[正常返](@entry_id:195139)的概念被推广为**Harris[正常返](@entry_id:195139) (Harris positive recurrence)**。

#### 平稳分布

[马尔可夫链](@entry_id:150828)理论的核心是**[平稳分布](@entry_id:194199) (stationary distribution)** 的概念。一个[概率分布](@entry_id:146404) $\pi$ 被称为马尔可夫链（以转移核 $P$ 表示）的平稳分布，如果它在链的一次转移后保持不变，即满足方程：
$$
\pi P = \pi
$$
这等价于，如果链的初始状态 $X_0$ 是根据 $\pi$ 抽取的，那么在任何时刻 $t$，$X_t$ 的[分布](@entry_id:182848)都将是 $\pi$。

[平稳分布的存在性](@entry_id:272084)和唯一性与我们之前讨论的性质密切相关：
- 一个不可约、[正常返](@entry_id:195139)的马尔可夫链**存在唯一**的[平稳分布](@entry_id:194199)。
- 对于一个[可约链](@entry_id:200553)，情况则更为复杂。如果链有多个[闭互通类](@entry_id:273537) $\mathcal{C}_1, \mathcal{C}_2, \dots, \mathcal{C}_k$，每个类 $\mathcal{C}_i$ 内部的子链都是不可约且[正常返](@entry_id:195139)的，那么每个子链都有其唯一的平稳分布 $\pi_i$。此时，整个链的任何平稳分布都可以表示为这些子[分布](@entry_id:182848)的凸组合 ：
$$
\pi = \sum_{i=1}^k \alpha_i \pi_i, \quad \text{其中 } \alpha_i \ge 0 \text{ 且 } \sum_{i=1}^k \alpha_i = 1
$$
这意味着[可约链](@entry_id:200553)存在无穷多个平稳分布。这也与线性代数中的一个结论相呼应：[转移矩阵](@entry_id:145510)的[特征值](@entry_id:154894) $1$ 的[几何重数](@entry_id:155584)等于链中[闭互通类](@entry_id:273537)的数量。因此，对于一个[可约链](@entry_id:200553)，其[谱隙](@entry_id:144877)（定义为 $1 - |\lambda_2|$，其中 $\lambda_2$ 是模第二大的[特征值](@entry_id:154894)）为零 。

例如，对于一个具有[转移矩阵](@entry_id:145510) $P = \begin{pmatrix} 1-\alpha  & \alpha \\ \beta  & 1-\beta \end{pmatrix}$ 的双状态马尔可夫链（其中 $\alpha, \beta \in (0,1)$），其唯一的[平稳分布](@entry_id:194199) $\pi = (\pi_0, \pi_1)$ 可以通过求解 $\pi_0 \alpha = \pi_1 \beta$ 和 $\pi_0 + \pi_1 = 1$ 得到，结果为 $\pi = \left(\frac{\beta}{\alpha+\beta}, \frac{\alpha}{\alpha+\beta}\right)$ 。

综合来看，一个**遍历的 (ergodic)** [马尔可夫链](@entry_id:150828)是指一个不可约、非周期且[正常返](@entry_id:195139)的链。这样的链拥有唯一的平稳分布，并且其长期行为表现出稳定的统计规律性。

### 收敛到平稳及[遍历定理](@entry_id:261967)

遍历性的核心价值在于它保证了马尔可夫链的行为会收敛到其唯一的[平稳分布](@entry_id:194199)。这种收敛性体现在两个核心的[极限定理](@entry_id:188579)中：[大数定律](@entry_id:140915)和中心极限定理。

#### [遍历定理](@entry_id:261967)（大数定律）

[马尔可夫链](@entry_id:150828)的**[遍历定理](@entry_id:261967) (Ergodic Theorem)**，本质上是其版本的[大数定律](@entry_id:140915)。它指出，对于一个遍历的[马尔可夫链](@entry_id:150828) $\{X_t\}$ 及其唯一的平稳分布 $\pi$，对于任何一个关于状态的函数 $f$（在 $\pi$ 下可积），其在链轨迹上的时间平均将[几乎必然](@entry_id:262518)地收敛到该函数在[平稳分布](@entry_id:194199)下的空间平均（[期望值](@entry_id:153208)）：
$$
\lim_{n \to \infty} \frac{1}{n} \sum_{t=1}^n f(X_t) = \mathbb{E}_{\pi}[f(X)] = \int f(x) \pi(dx)
$$
这个定理是[MCMC方法](@entry_id:137183)的理论基石。它意味着我们通过模拟一条足够长的马尔可夫链轨迹，计算函数 $f$ 的样本均值，就可以得到对[期望值](@entry_id:153208) $\mathbb{E}_{\pi}[f(X)]$ 的一个强一致估计。

然而，如果链不是不可约的，[遍历定理](@entry_id:261967)的[标准形式](@entry_id:153058)就不再成立。此时，[时间平均](@entry_id:267915)的极限将依赖于链的初始状态。对于一个[可约链](@entry_id:200553)，如果从瞬时状态出发，链最终会被某个[闭互通类](@entry_id:273537)吸收。极限值将是该类对应平稳分布下的期望。例如，在之前提到的具有状态 $\{1, ..., 7\}$ 的[可约链](@entry_id:200553)中 ，如果链从状态 $6$ 或 $7$ 开始，它最终会分别以一定概率被类 $\mathcal{C}_1$ 或 $\mathcal{C}_2$ 吸收。因此，[时间平均](@entry_id:267915)的极限是一个[随机变量](@entry_id:195330)，其[期望值](@entry_id:153208)是各个[闭互通类](@entry_id:273537)对应极限的加权平均，权重为相应的[吸收概率](@entry_id:265511)。

#### 全变分收敛与[几何遍历性](@entry_id:191361)

除了[时间平均](@entry_id:267915)的收敛，我们还关心链的[分布](@entry_id:182848)本身的收敛。我们使用**全变分距离 (total variation distance)** 来度量在第 $n$ 步的[分布](@entry_id:182848) $P^n(x, \cdot)$（从状态 $x$ 出发）与[平稳分布](@entry_id:194199) $\pi$ 之间的差异：
$$
\|P^n(x, \cdot) - \pi(\cdot)\|_{\mathrm{TV}} = \sup_{A \in \mathcal{B}} |P^n(x, A) - \pi(A)|
$$
其中 $\mathcal{B}$ 是[状态空间](@entry_id:177074)上的一个合适的 $\sigma$-代数。对于一个遍历链，对于任意初始状态 $x$，这个距离会随着 $n \to \infty$ 而趋于 $0$。

收敛的速度是衡量[MCMC算法](@entry_id:751788)效率的关键。如果[收敛速度](@entry_id:636873)是指数级的，即存在常数 $C(x)  \infty$ 和 $\rho \in (0,1)$ 使得：
$$
\|P^n(x, \cdot) - \pi(\cdot)\|_{\mathrm{TV}} \le C(x) \rho^n
$$
则称该链是**几何遍历的 (geometrically ergodic)**。如果 $C(x)$ 可以取一个与 $x$ 无关的常数 $C$，则称链是**一致遍历的 (uniformly ergodic)**。

一个典型的一致遍历链的例子是Doeblin或混合核 。考虑一个转移核 $P_\alpha(x,A) = \alpha\nu(A) + (1-\alpha)\delta_x(A)$，其中 $\nu$ 是一个概率测度，$\alpha \in (0,1)$。这个核在每一步都有 $\alpha$ 的概率“忘记”当前状态 $x$ 并从一个固定的[分布](@entry_id:182848) $\nu$ 中重新抽样。可以证明，如果 $\nu$ 是[平稳分布](@entry_id:194199)，那么从任何状态 $x$ 出发的链[分布](@entry_id:182848)将以指数速率 $(1-\alpha)^n$ 收敛到 $\nu$：
$$
\sup_{x \in \mathsf{X}} \|P_\alpha^n(x, \cdot) - \nu(\cdot)\|_{\mathrm{TV}} \le (1-\alpha)^n
$$
这种快速收敛是MCMC中非常理想的性质。

#### [中心极限定理](@entry_id:143108)

[遍历定理](@entry_id:261967)告诉我们样本[均值收敛](@entry_id:269534)到何处，而马尔可夫链的**[中心极限定理](@entry_id:143108) (Central Limit Theorem, CLT)** 则描述了围绕该极限的波动的[分布](@entry_id:182848)。对于一个遍历链和函数 $f$，在一定[正则性条件](@entry_id:166962)下，归一化的样本均值误差会收敛到一个[正态分布](@entry_id:154414)：
$$
\sqrt{n} \left( \frac{1}{n} \sum_{t=1}^n f(X_t) - \mathbb{E}_{\pi}[f(X)] \right) \xrightarrow{d} \mathcal{N}(0, \sigma_f^2)
$$
这里的 $\sigma_f^2$ 被称为**[渐近方差](@entry_id:269933) (asymptotic variance)**。它不仅取决于函数 $f$ 在[平稳分布](@entry_id:194199)下的[方差](@entry_id:200758)，还取决于链的自相关结构。其经典表达式为所有[自协方差](@entry_id:270483)项的总和：
$$
\sigma_f^2 = \sum_{k=-\infty}^{\infty} \mathrm{Cov}_{\pi}(f(X_0), f(X_k)) = \mathrm{Var}_{\pi}(f(X_0)) + 2 \sum_{k=1}^{\infty} \mathrm{Cov}_{\pi}(f(X_0), f(X_k))
$$
其中假设链从[平稳分布](@entry_id:194199) $\pi$ 开始。[渐近方差](@entry_id:269933) $\sigma_f^2$ 是衡量MCMC估计量精度的核心指标：$\sigma_f^2$ 越小，获得同样精度估计所需的样本量就越少。

为了具体理解[渐近方差](@entry_id:269933)的计算，让我们回到双状态马尔可夫链的例子 。该链的转移矩阵 $P$ 的[特征值](@entry_id:154894)为 $\lambda_1 = 1$ 和 $\lambda_2 = 1 - (\alpha+\beta)$。对于函数 $f(0)=0, f(1)=1$，其[自协方差函数](@entry_id:262114)可以被证明具有几何衰减的形式 $\gamma(k) = \mathrm{Cov}_{\pi}(f(X_0), f(X_k)) = \gamma(0) \lambda_2^{|k|}$。其中 $\gamma(0) = \mathrm{Var}_{\pi}(f)$。将此代入求和公式，得到一个[几何级数](@entry_id:158490)，其和为：
$$
\sigma_f^2 = \gamma(0) \frac{1+\lambda_2}{1-\lambda_2}
$$
代入 $\gamma(0) = \frac{\alpha\beta}{(\alpha+\beta)^2}$ 和 $\lambda_2 = 1 - (\alpha+\beta)$，我们得到[渐近方差](@entry_id:269933)的显式表达式：
$$
\sigma_f^2 = \frac{\alpha\beta(2 - \alpha - \beta)}{(\alpha+\beta)^3}
$$
这个例子清晰地展示了链的谱结构（通过 $\lambda_2$）如何直接决定了其[统计效率](@entry_id:164796)（通过 $\sigma_f^2$）。值得注意的是，除非函数 $f$ 是常数，否则[渐近方差](@entry_id:269933)通常为正 。

### 分析遍历性与[收敛速度](@entry_id:636873)的工具

判断一个马尔可夫链是否遍历并量化其收敛速度，是MCMC理论研究和应用的核心任务。本节介绍几种关键的分析工具。

#### [可逆性](@entry_id:143146)与细致平衡

在[MCMC算法](@entry_id:751788)设计中，一个常用且强大的工具是**可逆性 (reversibility)**，也称为**[细致平衡条件](@entry_id:265158) (detailed balance condition)**。一个马尔可夫链如果满足关于某个[分布](@entry_id:182848) $\pi$ 的[细致平衡条件](@entry_id:265158)，即对于任意状态 $i, j$：
$$
\pi(i) P(i,j) = \pi(j) P(j,i)
$$
那么 $\pi$ 一定是该链的一个平稳分布。这个条件比平稳方程 $\pi P = \pi$ 更强，它直观地表示在[稳态](@entry_id:182458)下，从 $i$ 流向 $j$ 的“概率流量”等于从 $j$ 流向 $i$ 的流量。[Metropolis-Hastings算法](@entry_id:146870)的核心就是通过精心设计接受概率来强制构造一个满足细致平衡的可逆链。

例如，前面提到的Doeblin核  和双状态模型  都可以被验证是关于其[平稳分布](@entry_id:194199)可逆的。

然而，必须强调的是，**可逆性本身并不保证遍历性**。一个链可以是可逆的，但却是可约的。例如，如果一个链的[转移矩阵](@entry_id:145510)是块对角的，且每个块内部都满足[细致平衡](@entry_id:145988)，那么整个链也满足细致平衡。但由于块之间没有转移，链是可约的，因此非遍历 。

#### [Foster-Lyapunov漂移条件](@entry_id:749534)

对于状态空间为无限或不可数的马尔可夫链（如在连续空间中的MCMC），我们无法像有限情况那样通过检查所有状态对来判断不可约性。此时，**[Foster-Lyapunov漂移条件](@entry_id:749534) (Foster-Lyapunov drift conditions)** 提供了一个强有力的分析工具。

其基本思想是找到一个“能量”函数或**Lyapunov函数** $V(x)$，该函数在状态空间的“中心”区域取值较小，而在“尾部”区域取值较大（通常 $V(x) \to \infty$ 当 $x$ 趋于无穷时）。然后我们考察从状态 $x$ 出发，经过一步转移后 $V$ 的[期望值](@entry_id:153208) $\mathsf{P}V(x) = \mathbb{E}[V(X_{n+1}) | X_n = x]$。如果对于[状态空间](@entry_id:177074)尾部的所有 $x$，这个[期望值](@entry_id:153208)都倾向于“向内漂移”，即 $\mathsf{P}V(x)$ 系统性地小于 $V(x)$，那么链就不太可能逃逸到无穷远处，而是会被[拉回](@entry_id:160816)到中心区域。

一个典型的漂移条件是几何漂移条件。它要求存在常数 $\lambda \in (0,1)$、$b  \infty$ 和一个“小集合”$C$，使得：
$$
\mathsf{P}V(x) \le (1 - \lambda) V(x) + b \cdot \mathbf{1}_C(x)
$$
其中 $\mathbf{1}_C(x)$ 是集合 $C$ 的[示性函数](@entry_id:261577)。满足此条件的链通常是几何遍历的。

例如，考虑一个由 $X_{n+1} = \alpha X_n + \varepsilon_{n+1}$ (以概率 $1-p$) 或 $X_{n+1}=X_n$ (以概率 $p$) 定义的[自回归过程](@entry_id:264527) 。使用[Lyapunov函数](@entry_id:273986) $V(x) = 1+x^2$，我们可以计算一步期望漂移：
$$
\mathsf{P}V(x) = (p + (1-p)\alpha^2)V(x) + (1-p)(1 - \alpha^2 + \sigma^2)
$$
通过比较，我们可以发现该链满足几何漂移条件，漂移速率为 $\lambda = (1-p)(1-\alpha^2)$。

漂移条件也可以用来证明较弱的[收敛模式](@entry_id:189917)，如**多项式遍历性 (polynomial ergodicity)**，此时漂移形式通常为 $\mathsf{P}V(x) - V(x) \le -c V(x)^q$ 。

#### [耦合方法](@entry_id:195982)

**耦合 (Coupling)** 是一种优雅而强大的[概率方法](@entry_id:197501)，用于证明收敛性并提供显式的收敛速度界。其核心思想是，在同一个[概率空间](@entry_id:201477)上构造两条马尔可夫链 $\{X_t\}$ 和 $\{Y_t\}$，它们分别从不同的初始状态 $x$ 和 $y$ 出发，但共享某些随机源。我们的目标是设计一种耦合机制，使得这两条链能够尽快地“相遇”（即 $X_t = Y_t$）。一旦相遇，它们就会永远保持一致。

**耦合不等式 (Coupling Inequality)** 将两条链的相遇概率与它们各自[边际分布](@entry_id:264862)的全变分距离联系起来：
$$
\| \mathbb{P}(X_t \in \cdot) - \mathbb{P}(Y_t \in \cdot) \|_{\mathrm{TV}} \le \mathbb{P}(X_t \neq Y_t)
$$
这个不等式意味着，如果我们能证明两条链在时间 $t$ 之前相遇的概率很高，那么它们在时间 $t$ 的[分布](@entry_id:182848)就一定非常接近。

一个经典的例子是分析在 $d$ 维[超立方体](@entry_id:273913) $\{0,1\}^d$ 上的[吉布斯采样器](@entry_id:265671) 。我们可以构造一个**[同步耦合](@entry_id:181753) (synchronous coupling)**：对于从 $x$ 和 $y$ 开始的两条链 $X_t$ 和 $Y_t$，在每一步我们都选择相同的坐标进行更新，并使用相同的随机数来生成新值。如果两条链在某个坐标上的值不同，而该坐标被选中更新，那么更新后它们在该坐标上的值将变得相同。

通过分析**[汉明距离](@entry_id:157657) (Hamming distance)** $D(X_t, Y_t)$ 的[期望值](@entry_id:153208)，可以证明它在每一步都会以因子 $(1 - 1/d)$ 收缩：
$$
\mathbb{E}[D(X_{t+1}, Y_{t+1}) | X_t, Y_t] = \left(1 - \frac{1}{d}\right) D(X_t, Y_t)
$$
结合耦合不等式和[马尔可夫不等式](@entry_id:266353)，我们可以得到一个关于收敛速度的显式上界：
$$
\sup_{x,y} \| \mathbb{P}(X_t \in \cdot | X_0=x) - \mathbb{P}(Y_t \in \cdot | Y_0=y) \|_{\mathrm{TV}} \le d \left(1 - \frac{1}{d}\right)^t
$$
这个结果表明链以几何速率收敛，并且收敛速度随着维度 $d$ 的增加而变慢。

#### 谱隙与导通率

对于[可逆马尔可夫链](@entry_id:198392)，其[收敛速度](@entry_id:636873)与转移矩阵 $P$ 的谱性质密切相关。**[谱隙](@entry_id:144877) (spectral gap)**，定义为 $1 - \lambda_2$（其中 $\lambda_2$ 是 $P$ 的第二大[特征值](@entry_id:154894)），直接控制了收敛到平稳分布的速率。[谱隙](@entry_id:144877)越大，收敛越快。一个非遍历（可约或周期）的链，其 $\lambda_2=1$，因此[谱隙](@entry_id:144877)为零 。

谱隙是一个代数概念，而**导通率 (conductance)** 或**[Cheeger常数](@entry_id:262211)** $\Phi$ 则从几何角度描述了状态空间的“瓶颈”程度。导通率被定义为在所有可能的将状态空间划分为两部分 $S$ 和 $S^c$ 的方式中，跨越边界的[概率流](@entry_id:150949)量与较小部分的总概率质量之比的最小值：
$$
\Phi = \min_{S: 0  \pi(S) \le 1/2} \frac{Q(S, S^c)}{\pi(S)}
$$
其中 $Q(S, S^c) = \sum_{i \in S, j \in S^c} \pi(i) P(i,j)$ 是从 $S$ 到 $S^c$ 的总流量。导通率小意味着状态空间中存在一个瓶颈：一个小的[概率流](@entry_id:150949)量连接了两个相当大的概率质量区域，链很难跨越这个瓶颈，因此混合缓慢。

**[Cheeger不等式](@entry_id:275795)**将这两个概念联系起来，为[谱隙](@entry_id:144877)提供了一个下界：
$$
1 - \lambda_2 \ge \frac{\Phi^2}{2}
$$
这个不等式意义重大，因为它告诉我们，一个几何上没有明显瓶颈的图（$\Phi$ 较大）必然对应一个[快速混合](@entry_id:274180)的[马尔可夫链](@entry_id:150828)（谱隙较大）。

考虑一个由两个团（完全图）$K_a$ 和 $K_b$ 通过一条边连接而成的图 。这个结构显然存在一个瓶颈，即连接两个团的唯一桥梁。通过识别这个瓶颈划分（将[状态空间](@entry_id:177074)分为 $K_a$ 和 $K_b$ 的顶点），我们可以计算出导通率 $\Phi = \frac{1}{2(a^2-a+1)}$（假设 $a \le b$）。利用[Cheeger不等式](@entry_id:275795)，我们可以立即得到[谱隙](@entry_id:144877)的一个下界，从而量化了这个瓶颈对[收敛速度](@entry_id:636873)的影响。

### 实践中的遍历性：[MCMC诊断](@entry_id:751792)与挑战

理论上的遍历性保证是[MCMC方法](@entry_id:137183)的基础，但在实际应用中，我们面临着更复杂的挑战。一个链可能在理论上是遍历的，但在实践中其[收敛速度](@entry_id:636873)可能慢到无法接受。

#### 亚稳态与表观非遍历性

在许多实际问题中，尤其是在物理系统或复杂的贝叶斯模型中，目标分布可能具有多个被高能量（低概率）势垒隔开的模式。尽管一个设计良好的[MCMC采样](@entry_id:751801)器在理论上是遍历的，能够跨越这些势垒，但平均跨越时间可能呈指数级增长。

考虑一个在双阱势 $V(x) = (x^2 - a^2)^2/4$ 中运动的粒子，由[Metropolis调整的Langevin算法](@entry_id:751937)（MALA）模拟 。这个系统有两个稳定状态（[势阱](@entry_id:151413)底部），分别位于 $x = \pm a$，中间被一个位于 $x=0$ 的势垒隔开。根据物理化学中的**Eyring-Kramers公式**，从一个[势阱](@entry_id:151413)隧穿到另一个[势阱](@entry_id:151413)的平均时间（以MALA迭代次数计）近似为：
$$
\mathbb{E}[\tau_h] \approx \frac{C}{h} \exp\left(\beta \Delta V\right)
$$
其中 $C$ 是一个与[势阱](@entry_id:151413)曲率相关的常数，$\beta$ 是[逆温](@entry_id:140086)度（控制噪声水平），$\Delta V = a^4/4$ 是势垒高度，$h$ 是步长。

这个结果揭示了一个关键问题：平均过渡时间随着势垒高度和[逆温](@entry_id:140086)度的乘积呈指数增长。当势垒很高或噪声很低（$\beta \to \infty$）时，这个时间可以轻易地超过任何实际模拟的总时长。因此，从一个[势阱](@entry_id:151413)开始的链会在该区域停留极长的时间，这种现象被称为**亚稳态 (metastability)**。在有限的模拟时间内，链无法探索到其他的模式，其样本均值会收敛到该模式局部的均值，而不是全局的真实均值。这给出了**表观非遍历性 (apparent non-ergodicity)** 的印象，尽管链在无限长时间的极限下仍然是遍历的。

#### 比较采样器效率

即使两个不同的[MCMC算法](@entry_id:751788)都能遍历同一个目标分布，它们的效率也可能大相径庭。比较和选择更高效的采样器是MCMC实践中的一个重要方面。

例如，在处理[重尾](@entry_id:274276)[目标分布](@entry_id:634522) $\pi(x) \propto (1+|x|)^{-\alpha}$ 时，我们可以比较标准的Metropolis-Hastings（MH）接受规则和Barker接受规则 。虽然两者都能产生遍历链，但它们的表现有所不同。一个有用的局部性能度量是**期望平方跳跃距离 (Expected Squared Jump Distance, ESJD)**，它衡量了链在一步内平均移动的距离的平方。分析表明，在[分布](@entry_id:182848)的尾部（大 $x$ 区域），MH算法的ESJD大约是Barker算法的两倍。这意味着MH链在低概率的尾部区域更具移动性，能够更有效地探索这些对某些期望（如[高阶矩](@entry_id:266936)）有重要贡献的区域。

这个观察结果与**Peskun序**的理论相符。Peskun序指出，对于两个可逆的[MCMC采样](@entry_id:751801)器，如果一个采样器的所有非对角转移概率都大于或等于另一个采样器，那么前者对于任何函数的估计都具有更小的（或相等的）[渐近方差](@entry_id:269933)。MH接受概率总是大于或等于Barker接受概率，因此MH采样器在统计上更为高效。

#### [自适应MCMC](@entry_id:746254)的挑战

为了提高效率，研究人员开发了**[自适应MCMC](@entry_id:746254) (Adaptive MCMC)** 算法，其转移核会随着模拟的进行而“学习”和“调整”（例如，调整[提议分布](@entry_id:144814)的参数）。然而，这种自适应性破坏了链的时间齐次性，使得标准[遍历定理](@entry_id:261967)不再直接适用。

对自适应方案的遍历性分析要微妙得多。一个常见的错误是，如果用于自适应的每个核本身都是遍历的，那么自适应方案也一定是遍历的。事实并非如此。考虑一个简单的自适应方案，它在两个固定的遍历核 $K_1$ 和 $K_2$ 之间确定性地交替 。我们可以通过分析两步转移核 $K_{12}=K_1K_2$ 和 $K_{21}=K_2K_1$ 来研究这个系统的[长期行为](@entry_id:192358)。通常情况下，$K_{12}$ 和 $K_{21}$ 会有各自不同的唯一平稳分布 $v_1$ 和 $v_2$。结果，链的[边际分布](@entry_id:264862)不会收敛到单一的平稳分布，而是在奇数时刻收敛到 $v_1$，在偶数时刻收敛到 $v_2$。因此，[时间平均](@entry_id:267915)将收敛到 $\frac{1}{2}(\mathbb{E}_{v_1}[f] + \mathbb{E}_{v_2}[f])$，这通常不是我们期望的目标[期望值](@entry_id:153208)。

这个例子说明，为了保证[自适应MCMC](@entry_id:746254)的遍历性，自适应必须是“递减的 (diminishing)”，即随着时间的推移，转移核的变化必须越来越小，最终稳定下来。否则，持续的、非递减的自适应可能会阻止链收敛到单一的平稳分布。另一方面，诸如**温度循环 (Tempered Transitions)** 或并行[回火](@entry_id:182408)等先进技术，通过在扩展的[状态空间](@entry_id:177074)上构造一个遍历链来解决原始空间中的非遍历性问题，为处理多模态和亚稳态问题提供了有效的途径 。