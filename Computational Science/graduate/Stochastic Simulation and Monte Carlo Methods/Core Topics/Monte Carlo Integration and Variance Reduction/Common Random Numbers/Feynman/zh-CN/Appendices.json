{
    "hands_on_practices": [
        {
            "introduction": "要有效运用通用随机数（CRN）技术，我们必须首先掌握其数学原理。本练习旨在剖析CRN的核心机制，推导输出结果之间的相关性与它们差值方差之间的精确关系。通过解决这个问题，你不仅能推导出方差缩减的基本公式，还能学习如何构建具有特定相关性的随机变量，从而更深刻地理解该技术的内在机理。",
            "id": "3297387",
            "problem": "考虑两个备选的模拟估计量，每个估计量都旨在估计一个未知的实值性能度量。对于重复索引 $i \\in \\{1,\\dots,n\\}$，定义每次重复的输出为\n$$Y_{1,i} = f_1\\!\\left(U_{2i-1},U_{2i}\\right), \\quad Y_{2,i} = f_2\\!\\left(U_{2i-1},U_{2i}\\right),$$\n其中 $\\{U_k\\}_{k \\ge 1}$ 是一个由独立同分布的 $\\mathrm{Uniform}(0,1)$ 随机变量组成的共享随机数流，而 $f_1,f_2$ 是可测函数。相应的样本均值估计量为\n$$\\hat{\\mu}_1 = \\frac{1}{n}\\sum_{i=1}^n Y_{1,i}, \\qquad \\hat{\\mu}_2 = \\frac{1}{n}\\sum_{i=1}^n Y_{2,i}.$$\n假设对于每个 $i$，随机变量对 $(Y_{1,i},Y_{2,i})$ 具有有限二阶矩，其边际标准差 $\\sigma_1>0$ 和 $\\sigma_2>0$ 不依赖于 $i$，并且相关系数为\n$$\\rho \\equiv \\mathrm{corr}\\!\\left(Y_{1,i},Y_{2,i}\\right) = \\mathrm{corr}\\!\\left(f_1\\!\\left(U_{2i-1},U_{2i}\\right), f_2\\!\\left(U_{2i-1},U_{2i}\\right)\\right),$$\n其中 $\\rho \\in (-1,1)$ 在所有重复中保持不变。不同重复之间（即对于不同的 $i$）是独立的。\n\n任务 A。从方差、协方差和相关系数的基本定义出发，推导在使用公共随机数的情况下，$\\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right)$ 关于 $n$、$\\sigma_1$、$\\sigma_2$ 和 $\\rho$ 的精确表达式。\n\n任务 B。构造显式函数 $f_1$ 和 $f_2$，使得对于给定的目标相关系数 $\\rho \\in (-1,1)$ 和给定的边际参数 $(m_1,\\sigma_1)$ 和 $(m_2,\\sigma_2)$（其中 $\\sigma_1>0$ 且 $\\sigma_2>0$），能够产生单次重复输出 $Y_{1,i} \\sim \\mathcal{N}(m_1,\\sigma_1^2)$ 和 $Y_{2,i} \\sim \\mathcal{N}(m_2,\\sigma_2^2)$，并实现 $\\mathrm{corr}(Y_{1,i},Y_{2,i})=\\rho$。你的构造必须仅使用共享的随机数流 $\\{U_k\\}_{k\\ge 1}$，并且在第 $i$ 次重复中，$f_1$ 和 $f_2$ 都必须使用相同的随机数对 $\\left(U_{2i-1},U_{2i}\\right)$。\n\n任务 C。简要说明 $\\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right)$ 如何依赖于 $\\rho$，并找出在 $\\rho \\in (-1,1)$ 的约束下，使该方差最小化或最大化的 $\\rho$ 值。\n\n作为最终答案，提供任务 A 中得到的 $\\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right)$ 作为 $n$、$\\sigma_1$、$\\sigma_2$ 和 $\\rho$ 的函数的封闭形式表达式。不需要进行数值四舍五入，也不涉及物理单位。",
            "solution": "所述问题是有效的。它在科学上基于随机模拟和概率论的原理，特别是用于方差缩减的公共随机数（CRN）方法。该问题是适定的（well-posed），提供了所有必要的数据和条件，并以客观、形式化的数学语言表述。它不包含任何科学缺陷、歧义或矛盾。因此，我们可以着手求解。\n\n问题分为三个任务。我们依次解决每个任务。\n\n任务 A：推导 $\\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right)$ 的精确表达式。\n\n我们需要求两个样本均值估计量之差的方差，这两个估计量为 $\\hat{\\mu}_1 = \\frac{1}{n}\\sum_{i=1}^n Y_{1,i}$ 和 $\\hat{\\mu}_2 = \\frac{1}{n}\\sum_{i=1}^n Y_{2,i}$。我们首先用每次重复的输出来表示估计量之差。\n$$ \\hat{\\mu}_1 - \\hat{\\mu}_2 = \\frac{1}{n}\\sum_{i=1}^n Y_{1,i} - \\frac{1}{n}\\sum_{i=1}^n Y_{2,i} = \\frac{1}{n}\\sum_{i=1}^n \\left(Y_{1,i} - Y_{2,i}\\right) $$\n现在我们计算这个差的方差。利用性质 $\\mathrm{Var}(cZ) = c^2\\mathrm{Var}(Z)$（其中 $c$ 为常数），我们有：\n$$ \\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right) = \\mathrm{Var}\\!\\left(\\frac{1}{n}\\sum_{i=1}^n \\left(Y_{1,i} - Y_{2,i}\\right)\\right) = \\frac{1}{n^2}\\mathrm{Var}\\!\\left(\\sum_{i=1}^n \\left(Y_{1,i} - Y_{2,i}\\right)\\right) $$\n问题陈述，对于不同的索引 $i$，各次重复是独立的。这意味着对 $i \\ne j$，随机变量对 $(Y_{1,i}, Y_{2,i})$ 与 $(Y_{1,j}, Y_{2,j})$ 是独立的。因此，表示每次重复内部差异的随机变量 $D_i = Y_{1,i} - Y_{2,i}$ 在不同的 $i$ 之间是独立的。对于独立的随机变量，其和的方差等于方差的和。\n$$ \\mathrm{Var}\\!\\left(\\sum_{i=1}^n \\left(Y_{1,i} - Y_{2,i}\\right)\\right) = \\sum_{i=1}^n \\mathrm{Var}\\!\\left(Y_{1,i} - Y_{2,i}\\right) $$\n将此代入估计量之差的方差表达式中：\n$$ \\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right) = \\frac{1}{n^2}\\sum_{i=1}^n \\mathrm{Var}\\!\\left(Y_{1,i} - Y_{2,i}\\right) $$\n问题指明，边际标准差 $\\sigma_1$、$\\sigma_2$ 和相关系数 $\\rho$ 在所有重复 $i$ 中都是固定的。这意味着 $\\mathrm{Var}\\!\\left(Y_{1,i} - Y_{2,i}\\right)$ 对所有 $i$ 都是常数。我们来计算这个公共的方差项。使用两个随机变量之差的方差公式 $\\mathrm{Var}(A-B) = \\mathrm{Var}(A) + \\mathrm{Var}(B) - 2\\mathrm{Cov}(A,B)$，我们得到：\n$$ \\mathrm{Var}\\!\\left(Y_{1,i} - Y_{2,i}\\right) = \\mathrm{Var}(Y_{1,i}) + \\mathrm{Var}(Y_{2,i}) - 2\\mathrm{Cov}(Y_{1,i}, Y_{2,i}) $$\n已知 $\\mathrm{Var}(Y_{1,i}) = \\sigma_1^2$ 且 $\\mathrm{Var}(Y_{2,i}) = \\sigma_2^2$。协方差可以用相关系数 $\\rho$ 和标准差来表示：\n$$ \\rho = \\mathrm{corr}(Y_{1,i}, Y_{2,i}) = \\frac{\\mathrm{Cov}(Y_{1,i}, Y_{2,i})}{\\sqrt{\\mathrm{Var}(Y_{1,i})}\\sqrt{\\mathrm{Var}(Y_{2,i})}} = \\frac{\\mathrm{Cov}(Y_{1,i}, Y_{2,i})}{\\sigma_1 \\sigma_2} $$\n因此，$\\mathrm{Cov}(Y_{1,i}, Y_{2,i}) = \\rho \\sigma_1 \\sigma_2$。将这些代入方差表达式中：\n$$ \\mathrm{Var}\\!\\left(Y_{1,i} - Y_{2,i}\\right) = \\sigma_1^2 + \\sigma_2^2 - 2\\rho \\sigma_1 \\sigma_2 $$\n由于这个项对于所有 $n$ 次重复都是相同的，所以求和结果为：\n$$ \\sum_{i=1}^n \\mathrm{Var}\\!\\left(Y_{1,i} - Y_{2,i}\\right) = n \\left(\\sigma_1^2 + \\sigma_2^2 - 2\\rho \\sigma_1 \\sigma_2\\right) $$\n最后，我们将此结果代回到 $\\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right)$ 的表达式中：\n$$ \\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right) = \\frac{1}{n^2} \\left[ n \\left(\\sigma_1^2 + \\sigma_2^2 - 2\\rho \\sigma_1 \\sigma_2\\right) \\right] = \\frac{\\sigma_1^2 + \\sigma_2^2 - 2\\rho \\sigma_1 \\sigma_2}{n} $$\n这就是所求的精确表达式。\n\n任务 B：构造显式函数 $f_1$ 和 $f_2$。\n\n我们需要构造函数 $f_1(u,v)$ 和 $f_2(u,v)$，使得在给定的重复 $i$ 中，当 $u = U_{2i-1}$ 和 $v = U_{2i}$ 时，输出 $Y_{1,i} = f_1(u,v)$ 和 $Y_{2,i} = f_2(u,v)$ 服从一个均值向量为 $(m_1, m_2)$、方差为 $(\\sigma_1^2, \\sigma_2^2)$、相关系数为 $\\rho$ 的二元正态分布。\n\n标准流程包括三个步骤：\n1.  从一对独立的均匀分布随机变量 $U_{2i-1}, U_{2i}$ 生成一对独立的标准正态随机变量 $Z_1, Z_2 \\sim \\mathcal{N}(0,1)$。一个常用的方法是 Box-Muller 变换：\n    $$ Z_1 = \\sqrt{-2\\ln(U_{2i-1})} \\cos(2\\pi U_{2i}) $$\n    $$ Z_2 = \\sqrt{-2\\ln(U_{2i-1})} \\sin(2\\pi U_{2i}) $$\n2.  将独立的标准正态变量 $(Z_1, Z_2)$ 变换为一对相关系数为 $\\rho$ 的相关标准正态变量 $(W_1, W_2)$。这可以通过一个线性变换来实现，该变换等价于对目标相关矩阵进行 Cholesky 分解：\n    $$ W_1 = Z_1 $$\n    $$ W_2 = \\rho Z_1 + \\sqrt{1-\\rho^2} Z_2 $$\n    根据构造，$(W_1, W_2)$ 服从均值为 $(0,0)$、方差为 $(1,1)$、协方差为 $\\mathrm{Cov}(W_1,W_2) = \\rho$ 的二元正态分布。\n3.  应用最后的仿射变换来缩放和平移 $(W_1, W_2)$，以匹配所需的边际参数 $(m_1, \\sigma_1)$ 和 $(m_2, \\sigma_2)$：\n    $$ Y_{1,i} = m_1 + \\sigma_1 W_1 $$\n    $$ Y_{2,i} = m_2 + \\sigma_2 W_2 $$\n通过组合这些步骤，我们可以定义所需的函数 $f_1$ 和 $f_2$。对于与 $(U_{2i-1}, U_{2i})$ 对应的任意输入对 $(u,v)$：\n$$ f_1(u,v) = m_1 + \\sigma_1 \\left( \\sqrt{-2\\ln(u)} \\cos(2\\pi v) \\right) $$\n$$ f_2(u,v) = m_2 + \\sigma_2 \\left( \\rho \\left(\\sqrt{-2\\ln(u)} \\cos(2\\pi v)\\right) + \\sqrt{1-\\rho^2} \\left(\\sqrt{-2\\ln(u)} \\sin(2\\pi v)\\right) \\right) $$\n这个构造满足了任务的所有要求。\n\n任务 C：说明 $\\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right)$ 对 $\\rho$ 的依赖关系，并找出极值。\n\n从任务 A 可知，差的方差由下式给出：\n$$ V(\\rho) = \\mathrm{Var}\\!\\left(\\hat{\\mu}_1 - \\hat{\\mu}_2\\right) = \\frac{1}{n}\\left(\\sigma_1^2 + \\sigma_2^2 - 2\\rho \\sigma_1 \\sigma_2\\right) $$\n参数 $n, \\sigma_1, \\sigma_2$ 都是正常数。因此，$V(\\rho)$ 是相关系数 $\\rho$ 的一个线性函数。为了分析其对 $\\rho$ 的依赖性，我们可以考察它关于 $\\rho$ 的导数：\n$$ \\frac{d V}{d\\rho} = \\frac{d}{d\\rho}\\left[\\frac{\\sigma_1^2 + \\sigma_2^2}{n} - \\frac{2\\sigma_1\\sigma_2}{n}\\rho\\right] = -\\frac{2\\sigma_1\\sigma_2}{n} $$\n由于 $\\sigma_1 > 0$，$\\sigma_2 > 0$ 且 $n \\ge 1$，导数 $\\frac{dV}{d\\rho}$ 是一个负常数。这证明了 $V(\\rho)$ 在其整个定义域 $\\rho \\in (-1,1)$ 上是 $\\rho$ 的严格递减函数。\n\n为了最小化方差，必须选择 $\\rho$ 的最大可能值。当 $\\rho$ 趋近其上界 $1$ 时，方差被最小化。方差的下确界是：\n$$ \\lim_{\\rho \\to 1^{-}} V(\\rho) = \\frac{\\sigma_1^2 + \\sigma_2^2 - 2\\sigma_1\\sigma_2}{n} = \\frac{(\\sigma_1 - \\sigma_2)^2}{n} $$\n这展示了公共随机数（CRN）方法的威力：如果两个模拟系统是强正相关的，它们性能估计量之差的方差可以被显著减小。\n\n相反，为了最大化方差，必须选择 $\\rho$ 的最小可能值。当 $\\rho$ 趋近其下界 $-1$ 时，方差被最大化。方差的上确界是：\n$$ \\lim_{\\rho \\to -1^{+}} V(\\rho) = \\frac{\\sigma_1^2 + \\sigma_2^2 + 2\\sigma_1\\sigma_2}{n} = \\frac{(\\sigma_1 + \\sigma_2)^2}{n} $$\n总之，当 $\\rho$ 的值趋近于 $1$ 时，方差最小化；当 $\\rho$ 的值趋近于 $-1$ 时，方差最大化。",
            "answer": "$$\\boxed{\\frac{\\sigma_1^2 + \\sigma_2^2 - 2\\rho\\sigma_1\\sigma_2}{n}}$$"
        },
        {
            "introduction": "理论是理解的基础，但通过实践来验证理论能让知识更加巩固。本练习将理论与实践相结合，要求你设计一个蒙特卡洛实验来量化CRN的有效性。你将首先从理论上推导方差缩减率，然后通过编写代码，在多种情景下进行模拟，以验证你的理论结果——这些情景包括CRN有效、无效甚至有害的典型案例。这项实践将锻炼你进行解析建模和经验验证的核心能力。",
            "id": "3297426",
            "problem": "要求您设计并分析一个蒙特卡洛实验，以量化公共随机数技术在缩减方差方面的有效性。该分析必须基于概率论和统计学的第一性原理，并以单个可运行程序的形式实现。目标是估计通过使用共享随机源配对输出所实现的方差缩减，并将其与独立生成输出时的方差进行比较。该实验还必须表征在公共随机数设置下，配对输出之间产生的诱导相关性。三角函数中的所有角度都必须以弧度为单位。不涉及物理单位。\n\n从以下基本框架开始。\n\n设 $W$ 为一个随机输入，$X = f_1(W)$ 和 $Y = f_2(W)$ 是根据 $W$ 计算的两个输出。目标量是均值差 $\\Delta = \\mathbb{E}[X] - \\mathbb{E}[Y]$。考虑 $\\Delta$ 的两种单样本估计量：\n- 独立配对估计量使用 $X^{\\mathrm{ind}} = f_1(W_1)$ 和 $Y^{\\mathrm{ind}} = f_2(W_2)$，其中 $W_1$ 和 $W_2$ 是独立同分布的，产生单样本差 $D^{\\mathrm{ind}} = X^{\\mathrm{ind}} - Y^{\\mathrm{ind}}$。\n- 公共随机数估计量使用相同的共享输入 $W$ 来产生 $X^{\\mathrm{crn}} = f_1(W)$ 和 $Y^{\\mathrm{crn}} = f_2(W)$，产生单样本差 $D^{\\mathrm{crn}} = X^{\\mathrm{crn}} - Y^{\\mathrm{crn}}$。\n\n利用以下事实：对于任意随机变量 $U$ 和 $V$，有 $\\mathrm{Var}(U - V) = \\mathrm{Var}(U) + \\mathrm{Var}(V) - 2 \\mathrm{Cov}(U,V)$，并且如果 $U$ 和 $V$ 是独立的，则 $\\mathrm{Cov}(U,V) = 0$。$U$ 和 $V$ 之间的 Pearson 相关系数为 $\\rho(U,V) = \\mathrm{Cov}(U,V) / \\sqrt{\\mathrm{Var}(U)\\mathrm{Var}(V)}$。\n\n将方差缩减比 $\\mathrm{VRR}$ 定义为 $D^{\\mathrm{ind}}$ 的单样本方差与 $D^{\\mathrm{crn}}$ 的单样本方差之比。即 $\\mathrm{VRR} = \\mathrm{Var}(D^{\\mathrm{ind}}) / \\mathrm{Var}(D^{\\mathrm{crn}})$，其中方差是按单个配对观测来解释的。$\\mathrm{VRR} > 1$ 的值表示公共随机数相对于独立抽样减少了差值估计量的方差，$\\mathrm{VRR} = 1$ 表示没有变化，而 $\\mathrm{VRR}  1$ 表示公共随机数增加了方差。\n\n您的任务是：\n- 推导 $\\mathrm{Var}(D^{\\mathrm{ind}})$ 和 $\\mathrm{Var}(D^{\\mathrm{crn}})$ 关于 $\\mathrm{Var}(X)$、$\\mathrm{Var}(Y)$ 和 $\\mathrm{Cov}(X,Y)$ 的表达式。\n- 对每个测试用例，根据 $W$ 的分布以及函数 $f_1$ 和 $f_2$ 推导出 $\\mathrm{Var}(X)$、$\\mathrm{Var}(Y)$ 和 $\\mathrm{Cov}(X,Y)$ 的闭式表达式，从而推导出 $\\mathrm{VRR}$ 和 $\\rho(X,Y)$ 的理论值。\n- 实现一个蒙特卡洛程序，通过使用公共随机数和独立配对进行仿真，来估计 $\\mathrm{VRR}$ 和 $\\rho(X,Y)$ 的经验值。使用单个共享的伪随机数生成器种子，以使实验可复现。每个测试用例使用 $n = 200000$ 个独立样本。\n\n测试套件规范。分析以下四种情况，它们共同涵盖了一般情况、无方差缩减的边界情况以及公共随机数有益或有害的两种重要边缘情况：\n- 案例 1：$W \\sim \\mathcal{N}(0,1)$，$X = \\exp(a W)$，其中 $a = 0.8$，$Y = \\exp(b W + c)$，其中 $b = 0.6$，$c = 0.2$。\n- 案例 2：$W \\sim \\mathcal{N}(0,1)$，$X = \\exp(a W)$，其中 $a = 0.8$，$Y = \\exp(-b W + c)$，其中 $b = 0.6$，$c = 0.2$。\n- 案例 3：$W \\sim \\mathrm{Uniform}(0,1)$，$X = \\sin(2 \\pi W)$，$Y = \\cos(2 \\pi W)$。\n- 案例 4：$W \\sim \\mathcal{N}(0,1)$，$X = W + W^2$，$Y = W - W^2$。\n\n对于三角函数，将 $2 \\pi W$ 解释为弧度。对于仿真，使用单个伪随机种子 $42$ 和每个案例 $n = 200000$ 个样本。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含一个含四个子列表的列表，每个子列表按上述顺序对应一个测试用例。每个子列表必须按 $[\\mathrm{VRR}_{\\mathrm{emp}}, \\mathrm{VRR}_{\\mathrm{theory}}, \\rho_{\\mathrm{emp}}, \\rho_{\\mathrm{theory}}]$ 的顺序包含四个浮点数。整个输出必须是方括号括起来的逗号分隔列表，例如 $[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],[z_1,z_2,z_3,z_4],[w_1,w_2,w_3,w_4]]$，不含其他文本。",
            "solution": "此问题要求对公共随机数（CRN）方差缩减技术进行理论和实证分析。该分析将针对四个不同的案例进行，以说明 CRN 在何种条件下是有益的、中性的或有害的。\n\n首先，我们为分析建立通用理论框架。设 $X = f_1(W)$ 和 $Y = f_2(W)$ 是两个随机变量，它们是共同的底层随机变量 $W$ 的函数。我们感兴趣的是估计它们均值的差异，即 $\\Delta = \\mathbb{E}[X] - \\mathbb{E}[Y]$。\n\n单个样本的独立配对估计量是 $D^{\\mathrm{ind}} = X^{\\mathrm{ind}} - Y^{\\mathrm{ind}} = f_1(W_1) - f_2(W_2)$，其中 $W_1$ 和 $W_2$ 是 $W$ 的独立同分布副本。因此，$X^{\\mathrm{ind}}$ 和 $Y^{\\mathrm{ind}}$ 是独立的。该估计量的方差由下式给出：\n$$\n\\mathrm{Var}(D^{\\mathrm{ind}}) = \\mathrm{Var}(X^{\\mathrm{ind}} - Y^{\\mathrm{ind}})\n$$\n使用属性 $\\mathrm{Var}(U - V) = \\mathrm{Var}(U) + \\mathrm{Var}(V) - 2 \\mathrm{Cov}(U,V)$，以及由于独立性而导致的 $\\mathrm{Cov}(X^{\\mathrm{ind}}, Y^{\\mathrm{ind}}) = 0$，我们有：\n$$\n\\mathrm{Var}(D^{\\mathrm{ind}}) = \\mathrm{Var}(X^{\\mathrm{ind}}) + \\mathrm{Var}(Y^{\\mathrm{ind}})\n$$\n由于 $W_1$ 和 $W_2$ 与 $W$ 具有相同的分布，我们有 $\\mathrm{Var}(X^{\\mathrm{ind}}) = \\mathrm{Var}(X)$ 和 $\\mathrm{Var}(Y^{\\mathrm{ind}}) = \\mathrm{Var}(Y)$。因此，\n$$\n\\mathrm{Var}(D^{\\mathrm{ind}}) = \\mathrm{Var}(X) + \\mathrm{Var}(Y)\n$$\n\n单个样本的公共随机数（CRN）估计量是 $D^{\\mathrm{crn}} = X^{\\mathrm{crn}} - Y^{\\mathrm{crn}} = f_1(W) - f_2(W)$。在这里，$X^{\\mathrm{crn}}$ 和 $Y^{\\mathrm{crn}}$ 源自相同的随机输入 $W$，因此通常是相关的。该估计量的方差为：\n$$\n\\mathrm{Var}(D^{\\mathrm{crn}}) = \\mathrm{Var}(X^{\\mathrm{crn}} - Y^{\\mathrm{crn}}) = \\mathrm{Var}(X) + \\mathrm{Var}(Y) - 2 \\mathrm{Cov}(X,Y)\n$$\n其中 $\\mathrm{Cov}(X,Y)$ 是 $X=f_1(W)$ 和 $Y=f_2(W)$ 之间的协方差。\n\n方差缩减比（VRR）定义为这两个方差的比率：\n$$\n\\mathrm{VRR} = \\frac{\\mathrm{Var}(D^{\\mathrm{ind}})}{\\mathrm{Var}(D^{\\mathrm{crn}})} = \\frac{\\mathrm{Var}(X) + \\mathrm{Var}(Y)}{\\mathrm{Var}(X) + \\mathrm{Var}(Y) - 2 \\mathrm{Cov}(X,Y)}\n$$\n正协方差 $\\mathrm{Cov}(X,Y) > 0$ 会导致 $\\mathrm{VRR} > 1$，表示方差缩减。负协方差 $\\mathrm{Cov}(X,Y)  0$ 会导致 $\\mathrm{VRR}  1$，表示方差膨胀。如果 $\\mathrm{Cov}(X,Y) = 0$，则 $\\mathrm{VRR} = 1$，CRN 无效果。这种效应的强度与 Pearson 相关系数 $\\rho(X,Y) = \\mathrm{Cov}(X,Y) / \\sqrt{\\mathrm{Var}(X)\\mathrm{Var}(Y)}$ 有关。\n\n现在我们开始推导四个指定案例中每一个的理论值。\n\n**案例 1：$W \\sim \\mathcal{N}(0,1)$，$X = \\exp(a W)$，其中 $a = 0.8$，$Y = \\exp(b W + c)$，其中 $b = 0.6, c = 0.2$。**\n对于一个随机变量 $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其矩生成函数为 $\\mathbb{E}[e^{tZ}] = e^{t\\mu + \\frac{1}{2}t^2\\sigma^2}$。对于 $W \\sim \\mathcal{N}(0,1)$，我们有 $\\mathbb{E}[e^{tW}] = e^{t^2/2}$。\n所需的矩为：\n$\\mathbb{E}[X] = \\mathbb{E}[e^{aW}] = e^{a^2/2}$\n$\\mathbb{E}[X^2] = \\mathbb{E}[e^{2aW}] = e^{(2a)^2/2} = e^{2a^2}$\n$\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = e^{2a^2} - e^{a^2} = e^{a^2}(e^{a^2}-1)$。\n对于 $Y = e^c e^{bW}$，类似地：\n$\\mathbb{E}[Y] = e^c \\mathbb{E}[e^{bW}] = e^c e^{b^2/2}$\n$\\mathbb{E}[Y^2] = e^{2c} \\mathbb{E}[e^{2bW}] = e^{2c} e^{2b^2}$\n$\\mathrm{Var}(Y) = e^{2c}e^{2b^2} - (e^c e^{b^2/2})^2 = e^{2c}(e^{2b^2} - e^{b^2}) = e^{2c}e^{b^2}(e^{b^2}-1)$。\n对于协方差：\n$\\mathbb{E}[XY] = \\mathbb{E}[e^{aW}e^{bW+c}] = e^c \\mathbb{E}[e^{(a+b)W}] = e^c e^{(a+b)^2/2}$。\n$\\mathrm{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y] = e^c e^{(a+b)^2/2} - (e^{a^2/2})(e^c e^{b^2/2}) = e^c e^{(a^2+b^2)/2}(e^{ab} - 1)$。\n相关系数为 $\\rho(X,Y) = \\frac{\\mathrm{Cov}(X,Y)}{\\sqrt{\\mathrm{Var}(X)\\mathrm{Var}(Y)}} = \\frac{e^c e^{(a^2+b^2)/2}(e^{ab} - 1)}{\\sqrt{e^{a^2}(e^{a^2}-1) \\cdot e^{2c}e^{b^2}(e^{b^2}-1)}} = \\frac{e^{ab}-1}{\\sqrt{(e^{a^2}-1)(e^{b^2}-1)}}$。\n代入 $a=0.8$ 和 $b=0.6$：\n$\\rho_{\\mathrm{theory}} = \\frac{e^{0.48}-1}{\\sqrt{(e^{0.64}-1)(e^{0.36}-1)}} \\approx 0.98844$。\n$\\mathrm{VRR}_{\\mathrm{theory}}$ 使用推导出的方差和协方差计算。由于 $X$ 和 $Y$ 都是 $W$ 的增函数，我们预期会存在强正相关和显著的方差缩减。\n\n**案例 2：$W \\sim \\mathcal{N}(0,1)$，$X = \\exp(a W)$，其中 $a = 0.8$，$Y = \\exp(-b W + c)$，其中 $b = 0.6, c = 0.2$。**\n这个案例与案例1相似，只是将 $b$ 替换为 $-b$。方差 $\\mathrm{Var}(X)$ 和 $\\mathrm{Var}(Y)$ 保持不变，因为它们依赖于 $b^2$。\n协方差项发生变化：\n$\\mathrm{Cov}(X,Y) = e^c e^{(a^2+(-b)^2)/2}(e^{a(-b)}-1) = e^c e^{(a^2+b^2)/2}(e^{-ab}-1)$。\n相关系数变为：\n$\\rho(X,Y) = \\frac{e^{-ab}-1}{\\sqrt{(e^{a^2}-1)(e^{b^2}-1)}}$。\n代入 $a=0.8$ 和 $b=0.6$：\n$\\rho_{\\mathrm{theory}} = \\frac{e^{-0.48}-1}{\\sqrt{(e^{0.64}-1)(e^{0.36}-1)}} \\approx -0.61163$。\n在这里，$X$ 是 $W$ 的增函数，而 $Y$ 是减函数。这会引发负相关，从而使 VRR 公式的分母大于分子，导致 $\\mathrm{VRR}  1$。\n\n**案例 3：$W \\sim \\mathrm{Uniform}(0,1)$，$X = \\sin(2 \\pi W)$，$Y = \\cos(2 \\pi W)$。**\n我们通过在 $[0,1]$ 上积分来计算矩。\n$\\mathbb{E}[X] = \\int_0^1 \\sin(2\\pi w) \\,dw = 0$。\n$\\mathbb{E}[Y] = \\int_0^1 \\cos(2\\pi w) \\,dw = 0$。\n$\\mathbb{E}[X^2] = \\int_0^1 \\sin^2(2\\pi w) \\,dw = \\int_0^1 \\frac{1-\\cos(4\\pi w)}{2} \\,dw = \\frac{1}{2}$。\n$\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = 1/2$。\n$\\mathbb{E}[Y^2] = \\int_0^1 \\cos^2(2\\pi w) \\,dw = \\int_0^1 \\frac{1+\\cos(4\\pi w)}{2} \\,dw = \\frac{1}{2}$。\n$\\mathrm{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2 = 1/2$。\n$\\mathbb{E}[XY] = \\int_0^1 \\sin(2\\pi w)\\cos(2\\pi w) \\,dw = \\int_0^1 \\frac{1}{2}\\sin(4\\pi w) \\,dw = 0$。\n$\\mathrm{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y] = 0$。\n因此，$\\rho_{\\mathrm{theory}} = 0$ 且 $\\mathrm{VRR}_{\\mathrm{theory}} = \\frac{1/2 + 1/2}{1/2 + 1/2 - 0} = 1$。在这种情况下，输出是不相关的，CRN 不提供方差缩减。\n\n**案例 4：$W \\sim \\mathcal{N}(0,1)$，$X = W + W^2$，$Y = W - W^2$。**\n我们使用标准正态分布的矩：$\\mathbb{E}[W]=0$，$\\mathbb{E}[W^2]=1$，$\\mathbb{E}[W^3]=0$，$\\mathbb{E}[W^4]=3$。\n$\\mathbb{E}[X] = \\mathbb{E}[W+W^2] = \\mathbb{E}[W]+\\mathbb{E}[W^2] = 0+1=1$。\n$\\mathbb{E}[Y] = \\mathbb{E}[W-W^2] = \\mathbb{E}[W]-\\mathbb{E}[W^2] = 0-1=-1$。\n$\\mathbb{E}[X^2] = \\mathbb{E}[(W+W^2)^2] = \\mathbb{E}[W^2+2W^3+W^4] = 1+0+3=4$。\n$\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = 4-1^2=3$。\n$\\mathbb{E}[Y^2] = \\mathbb{E}[(W-W^2)^2] = \\mathbb{E}[W^2-2W^3+W^4] = 1-0+3=4$。\n$\\mathrm{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2 = 4-(-1)^2=3$。\n$\\mathbb{E}[XY] = \\mathbb{E}[(W+W^2)(W-W^2)] = \\mathbb{E}[W^2 - W^4] = 1-3=-2$。\n$\\mathrm{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y] = -2 - (1)(-1) = -1$。\n$\\rho_{\\mathrm{theory}} = \\frac{-1}{\\sqrt{3 \\cdot 3}} = -1/3$。\n$\\mathrm{VRR}_{\\mathrm{theory}} = \\frac{3+3}{3+3-2(-1)} = \\frac{6}{8} = 0.75$。\n与案例2类似，负相关导致方差膨胀，即 $\\mathrm{VRR}  1$。\n\n蒙特卡洛仿真将凭经验估计这些量。对于每个案例，我们将生成 $n = 200000$ 个样本。\n1. 为了估计 $\\mathrm{Var}(D^{\\mathrm{crn}})$ 和 $\\rho(X,Y)$，我们生成 $n$ 个 $W$ 的样本，表示为 $\\{w_i\\}_{i=1}^n$。我们计算配对输出 $\\{x_i = f_1(w_i), y_i = f_2(w_i)\\}_{i=1}^n$ 和差值 $\\{d_i^{\\mathrm{crn}} = x_i - y_i\\}_{i=1}^n$。$\\{d_i^{\\mathrm{crn}}\\}$ 的样本方差可估计 $\\mathrm{Var}(D^{\\mathrm{crn}})$，$\\{x_i\\}$ 和 $\\{y_i\\}$ 之间的样本相关性可估计 $\\rho(X,Y)$。\n2. 为了估计 $\\mathrm{Var}(D^{\\mathrm{ind}})$，我们生成两组独立的 $n$ 个样本，$\\{w_{1,i}\\}_{i=1}^n$ 和 $\\{w_{2,i}\\}_{i=1}^n$。我们计算独立的输出 $\\{x_i^{\\mathrm{ind}} = f_1(w_{1,i}), y_i^{\\mathrm{ind}} = f_2(w_{2,i})\\}_{i=1}^n$ 和差值 $\\{d_i^{\\mathrm{ind}} = x_i^{\\mathrm{ind}} - y_i^{\\mathrm{ind}}\\}_{i=1}^n$。$\\{d_i^{\\mathrm{ind}}\\}$ 的样本方差可估计 $\\mathrm{Var}(D^{\\mathrm{ind}})$。\n3. 经验 VRR 是这些估计方差的比率。\n使用固定的伪随机数生成器种子可确保实验的可复现性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Performs theoretical and empirical analysis of the Common Random Numbers\n    (CRN) variance reduction technique for four test cases.\n    \"\"\"\n    seed = 42\n    n_samples = 200000\n    rng = np.random.default_rng(seed)\n\n    test_cases = [\n        {'id': 1, 'dist': 'normal', 'params': {'a': 0.8, 'b': 0.6, 'c': 0.2}},\n        {'id': 2, 'dist': 'normal', 'params': {'a': 0.8, 'b': -0.6, 'c': 0.2}}, # Effective b is -0.6\n        {'id': 3, 'dist': 'uniform', 'params': {}},\n        {'id': 4, 'dist': 'normal', 'params': {}}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # --- Theoretical Calculations ---\n        if case['id'] == 1 or case['id'] == 2:\n            a = case['params']['a']\n            b_val = case['params']['b'] # Use b_val to distinguish from variable b in formulas\n            c = case['params']['c']\n            \n            # Var(X)\n            var_x_theory = np.exp(a**2) * (np.exp(a**2) - 1)\n            \n            # Var(Y) - depends on b^2, so same for case 1 and 2\n            b_sq = b_val**2\n            var_y_theory = np.exp(2 * c) * np.exp(b_sq) * (np.exp(b_sq) - 1)\n            \n            # Cov(X,Y)\n            cov_xy_theory = np.exp(c) * np.exp((a**2 + b_sq) / 2) * (np.exp(a * b_val) - 1)\n            \n            # rho(X,Y)\n            rho_theory = (np.exp(a * b_val) - 1) / np.sqrt((np.exp(a**2) - 1) * (np.exp(b_sq) - 1))\n            \n            # VRR\n            vrr_theory = (var_x_theory + var_y_theory) / (var_x_theory + var_y_theory - 2 * cov_xy_theory)\n\n        elif case['id'] == 3:\n            var_x_theory = 0.5\n            var_y_theory = 0.5\n            cov_xy_theory = 0.0\n            rho_theory = 0.0\n            vrr_theory = 1.0\n\n        elif case['id'] == 4:\n            var_x_theory = 3.0\n            var_y_theory = 3.0\n            cov_xy_theory = -1.0\n            rho_theory = -1.0 / 3.0\n            vrr_theory = 6.0 / 8.0\n\n        # --- Empirical (Simulation) Calculations ---\n        # Generate random numbers based on distribution\n        if case['dist'] == 'normal':\n            w_crn = rng.normal(size=n_samples)\n            w1_ind = rng.normal(size=n_samples)\n            w2_ind = rng.normal(size=n_samples)\n        elif case['dist'] == 'uniform':\n            w_crn = rng.uniform(size=n_samples)\n            w1_ind = rng.uniform(size=n_samples)\n            w2_ind = rng.uniform(size=n_samples)\n\n        # Define functions f1(w) and f2(w) per case\n        if case['id'] == 1:\n            a, b, c = case['params']['a'], case['params']['b'], case['params']['c']\n            f1 = lambda w: np.exp(a * w)\n            f2 = lambda w: np.exp(b * w + c)\n        elif case['id'] == 2:\n            a, b, c = case['params']['a'], 0.6, case['params']['c'] # b is positive 0.6 here\n            f1 = lambda w: np.exp(a * w)\n            f2 = lambda w: np.exp(-b * w + c)\n        elif case['id'] == 3:\n            f1 = lambda w: np.sin(2 * np.pi * w)\n            f2 = lambda w: np.cos(2 * np.pi * w)\n        elif case['id'] == 4:\n            f1 = lambda w: w + w**2\n            f2 = lambda w: w - w**2\n            \n        # CRN part\n        x_crn = f1(w_crn)\n        y_crn = f2(w_crn)\n        d_crn = x_crn - y_crn\n        var_d_crn_emp = np.var(d_crn, ddof=1)\n        \n        # Independent sampling part\n        x_ind = f1(w1_ind)\n        y_ind = f2(w2_ind)\n        d_ind = x_ind - y_ind\n        var_d_ind_emp = np.var(d_ind, ddof=1)\n        \n        # Empirical results\n        vrr_emp = var_d_ind_emp / var_d_crn_emp\n        rho_emp = np.corrcoef(x_crn, y_crn)[0, 1]\n        \n        results.append([vrr_emp, vrr_theory, rho_emp, rho_theory])\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "虽然CRN是一个强大的方差缩减工具，但它并非万能。理解其应用的边界条件至关重要。本练习通过一个精心设计的场景，揭示了CRN在特定条件下可能产生与直觉相反的效果——即增加而非减少方差。通过分析这个反直觉的例子，你将能更深刻地体会CRN有效性的前提条件，特别是仿真输入和输出之间单调关系的重要性。这项练习旨在培养你的批判性思维，帮助你在应用方差缩减技术时避免常见误区。",
            "id": "3297431",
            "problem": "考虑一个参数化模拟器，它通过一个确定性规则将单个均匀随机变量转换为离散输出。令 $U$ 为 $[0,1)$ 上均匀分布的一次抽样，记为 $U \\sim \\mathrm{Uniform}(0,1)$。对于参数值 $\\theta$，该模拟器输出 $X(\\theta,U)$，其取值于一个有限集合。在本问题中，您将分析使用通用随机数 (Common Random Numbers, CRN) 对指示响应的差分估计量的方差产生的影响。您将构建一个具体示例，该示例由于输出分布中质量点的不连续性，在 CRN 下表现出方差增加。\n\n定义三个数值水平 $L=0.0$、$m=0.5$ 和 $H=1.0$，其中 $L  m  H$。考虑两个参数值 $\\theta_1$ 和 $\\theta_2$，它们按如下方式将 $U$ 映射到 $X(\\theta,U)$：\n- 对于 $\\theta_1$：\n  - 如果 $0 \\le U  0.5$，则 $X(\\theta_1,U) = H$。\n  - 如果 $0.5 \\le U  0.75$，则 $X(\\theta_1,U) = m$。\n  - 如果 $0.75 \\le U  1$，则 $X(\\theta_1,U) = L$。\n- 对于 $\\theta_2$：\n  - 如果 $0 \\le U  0.4$，则 $X(\\theta_2,U) = m$。\n  - 如果 $0.4 \\le U  0.9$，则 $X(\\theta_2,U) = H$。\n  - 如果 $0.9 \\le U  1$，则 $X(\\theta_2,U) = L$。\n\n对于一个实数阈值 $c \\in \\mathbb{R}$，定义指示响应\n$$\nY_k(c,U) \\equiv \\mathbf{1}\\{X(\\theta_k,U) \\ge c\\}, \\quad k \\in \\{1,2\\}.\n$$\n我们关心的是期望的差值 $\\Delta(c) \\equiv \\mathbb{E}[Y_1(c,U)] - \\mathbb{E}[Y_2(c,U)]$ 以及基于 $n$ 次独立重复的 $\\Delta(c)$ 的蒙特卡洛估计量。令 $D(c,U) \\equiv Y_1(c,U) - Y_2(c,U)$ 表示每次重复的贡献，因此样本均值差的方差为 $\\mathrm{Var}(\\bar{D}(c)) = \\mathrm{Var}(D(c,U))/n$。\n\n考虑两种耦合机制来为每次重复生成配对 $(Y_1(c,U),Y_2(c,U))$：\n- 通用随机数 (CRN)：对 $\\theta_1$ 和 $\\theta_2$ 使用相同的底层 $U$。\n- 独立流 (IND)：分别为 $\\theta_1$ 和 $\\theta_2$ 使用独立的 $U_1$ 和 $U_2$。\n\n从期望、方差和协方差的基本概率定义出发，并仅使用上述映射和 $[0,1)$ 上均匀分布的性质，推导出以下各项的精确、闭式表达式（作为 $c$ 的函数）：\n- 成功概率 $p_1(c) \\equiv \\mathbb{P}\\{Y_1(c,U)=1\\}$ 和 $p_2(c) \\equiv \\mathbb{P}\\{Y_2(c,U)=1\\}$。\n- CRN下的重叠概率 $p_{12}(c) \\equiv \\mathbb{P}\\{Y_1(c,U)=1 \\text{ and } Y_2(c,U)=1\\}$。\n- 协方差 $\\mathrm{Cov}_{\\mathrm{CRN}}(c) \\equiv \\mathrm{Cov}(Y_1(c,U),Y_2(c,U)) = p_{12}(c) - p_1(c)p_2(c)$。\n- 每次重复的方差\n  $$\n  V_{\\mathrm{CRN}}(c) \\equiv \\mathrm{Var}(Y_1(c,U) - Y_2(c,U)) \\quad \\text{在 CRN 下},\n  $$\n  $$\n  V_{\\mathrm{IND}}(c) \\equiv \\mathrm{Var}(Y_1(c,U) - Y_2(c,U)) \\quad \\text{在 IND 下}.\n  $$\n从第一性原理出发解释为什么 $V_{\\mathrm{CRN}}(c) - V_{\\mathrm{IND}}(c) = -2\\,\\mathrm{Cov}_{\\mathrm{CRN}}(c)$，并分析质量点 $m$ 处的不连续性如何导致当 $c$ 穿过 $m$ 时 $\\mathrm{Cov}_{\\mathrm{CRN}}(c)$ 的符号翻转。\n\n您的程序必须使用上述构造，为以下阈值测试套件计算 $V_{\\mathrm{CRN}}(c) - V_{\\mathrm{IND}}(c)$ 的精确值：\n- $c_1 = 0.3$，\n- $c_2 = 0.5$，\n- $c_3 = 0.7$，\n- $c_4 = 1.0$，\n- $c_5 = 1.1$，\n- $c_6 = -0.1$。\n\n为覆盖率而设计：\n- 案例 $c_1$ 和 $c_2$ 探测低于和位于质量点 $m$ 处的行为。\n- 案例 $c_3$ 和 $c_4$ 探测严格高于 $m$（包括在 $H$ 处）的行为。\n- 案例 $c_5$ 和 $c_6$ 是支撑集之外的边界/极端条件。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔的列表形式的结果（例如，“[r1,r2,r3,r4,r5,r6]”），其中每个 $r_i$ 等于按给定顺序计算的 $V_{\\mathrm{CRN}}(c_i) - V_{\\mathrm{IND}}(c_i)$ 的精确浮点值。不涉及物理单位。不使用角度。如果出现百分比，必须表示为小数，但此处不需要。程序不得执行蒙特卡洛模拟；它必须根据所提供的定义和映射计算精确值。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确、客观且内部一致。它提出了随机模拟领域中一个可解决的挑战，可以使用概率论的基本原理解答。\n\n目标是分析在两种抽样策略下——通用随机数 (CRN) 和独立流 (IND)——差分估计量的方差。我们被要求为一组指定的阈值 $c$ 计算 $V_{\\mathrm{CRN}}(c) - V_{\\mathrm{IND}}(c)$ 的精确值。\n\n令 $U \\sim \\mathrm{Uniform}(0,1)$。模拟器的输出是 $X(\\theta_1, U)$ 和 $X(\\theta_2, U)$，它们在集合 $\\{L, m, H\\}$ 中取值，其中 $L=0.0$，$m=0.5$，$H=1.0$。指示响应为 $Y_k(c,U) = \\mathbf{1}\\{X(\\theta_k, U) \\ge c\\}$，其中 $k \\in \\{1,2\\}$。这些是伯努利随机变量。\n\n首先，我们建立 CRN 下方差差异与协方差之间的关系。两个随机变量 $A$ 和 $B$ 之差的方差由 $\\mathrm{Var}(A - B) = \\mathrm{Var}(A) + \\mathrm{Var}(B) - 2\\mathrm{Cov}(A,B)$ 给出。\n\n在 CRN 机制下，使用相同的随机数 $U$ 生成 $Y_1(c,U)$ 和 $Y_2(c,U)$。它们差值的方差是：\n$$V_{\\mathrm{CRN}}(c) = \\mathrm{Var}(Y_1(c,U) - Y_2(c,U)) = \\mathrm{Var}(Y_1(c,U)) + \\mathrm{Var}(Y_2(c,U)) - 2\\mathrm{Cov}(Y_1(c,U), Y_2(c,U))$$\n\n在 IND 机制下，使用独立的随机数 $U_1$ 和 $U_2$。令 $Y_1' = Y_1(c,U_1)$ 和 $Y_2' = Y_2(c,U_2)$。由于 $U_1$ 和 $U_2$ 是独立的，$Y_1'$ 和 $Y_2'$ 也是独立的，这意味着它们的协方差为零：$\\mathrm{Cov}(Y_1', Y_2') = 0$。差值的方差是：\n$$V_{\\mathrm{IND}}(c) = \\mathrm{Var}(Y_1' - Y_2') = \\mathrm{Var}(Y_1') + \\mathrm{Var}(Y_2')$$\n$Y_1$ 和 $Y_1'$ 的边际分布是相同的，同样 $Y_2$ 和 $Y_2'$ 的边际分布也相同。因此，$\\mathrm{Var}(Y_1(c,U)) = \\mathrm{Var}(Y_1')$ 且 $\\mathrm{Var}(Y_2(c,U)) = \\mathrm{Var}(Y_2')$。\n从 $V_{\\mathrm{CRN}}(c)$ 中减去 $V_{\\mathrm{IND}}(c)$ 得到：\n$$V_{\\mathrm{CRN}}(c) - V_{\\mathrm{IND}}(c) = -2\\mathrm{Cov}(Y_1(c,U), Y_2(c,U)) = -2\\mathrm{Cov}_{\\mathrm{CRN}}(c)$$\n此关系表明，由 CRN 引起的方差变化完全由两个输出之间的协方差决定。正协方差导致方差减小，而负协方差导致方差增加。\n\n为了计算 $\\mathrm{Cov}_{\\mathrm{CRN}}(c)$，我们使用公式 $\\mathrm{Cov}_{\\mathrm{CRN}}(c) = \\mathbb{E}[Y_1 Y_2] - \\mathbb{E}[Y_1]\\mathbb{E}[Y_2]$。由于 $Y_k$ 是指示变量，我们有 $\\mathbb{E}[Y_k] = \\mathbb{P}\\{Y_k=1\\} = p_k(c)$ 和 $\\mathbb{E}[Y_1 Y_2] = \\mathbb{P}\\{Y_1=1 \\text{ and } Y_2=1\\} = p_{12}(c)$。\n因此，$\\mathrm{Cov}_{\\mathrm{CRN}}(c) = p_{12}(c) - p_1(c)p_2(c)$。\n\n我们现在推导概率 $p_1(c)$、$p_2(c)$ 和 $p_{12}(c)$，作为阈值 $c$ 的分段函数。\n\n我们用符号表示与每个输出水平相对应的 $U$ 值集合：\n对于 $\\theta_1$：$S_{1,H} = [0, 0.5)$，$S_{1,m} = [0.5, 0.75)$，$S_{1,L} = [0.75, 1)$。\n对于 $\\theta_2$：$S_{2,m} = [0, 0.4)$，$S_{2,H} = [0.4, 0.9)$，$S_{2,L} = [0.9, 1)$。\n\n成功概率 $p_1(c) = \\mathbb{P}\\{X(\\theta_1, U) \\ge c\\}$ 是条件成立的 $U$ 集合的测度。\n- 如果 $c > H=1.0$：条件永远不满足。$p_1(c)=0$。\n- 如果 $m  c \\le H$ ($0.5  c \\le 1.0$)：当 $X(\\theta_1,U)=H$ 时条件满足。这对应 $U \\in S_{1,H}$。测度是 $0.5$。所以 $p_1(c)=0.5$。\n- 如果 $L  c \\le m$ ($0  c \\le 0.5$)：当 $X(\\theta_1,U) \\in \\{m,H\\}$ 时条件满足。这对应 $U \\in S_{1,H} \\cup S_{1,m} = [0, 0.75)$。测度是 $0.75$。所以 $p_1(c)=0.75$。\n- 如果 $c \\le L=0.0$：条件总是满足。测度是 $1.0$。所以 $p_1(c)=1.0$。\n\n成功概率 $p_2(c) = \\mathbb{P}\\{X(\\theta_2, U) \\ge c\\}$ 的计算方法类似。\n- 如果 $c > H=1.0$：$p_2(c)=0$。\n- 如果 $m  c \\le H$ ($0.5  c \\le 1.0$)：当 $X(\\theta_2,U)=H$ 时条件满足。这对应 $U \\in S_{2,H} = [0.4, 0.9)$。测度是 $0.5$。所以 $p_2(c)=0.5$。\n- 如果 $L  c \\le m$ ($0  c \\le 0.5$)：当 $X(\\theta_2,U) \\in \\{m,H\\}$ 时条件满足。这对应 $U \\in S_{2,m} \\cup S_{2,H} = [0, 0.9)$。测度是 $0.9$。所以 $p_2(c)=0.9$。\n- 如果 $c \\le L=0.0$：$p_2(c)=1.0$。\n\n重叠概率 $p_{12}(c) = \\mathbb{P}\\{X(\\theta_1, U) \\ge c \\text{ and } X(\\theta_2, U) \\ge c\\}$ 是相应 $U$ 集合交集的测度。\n- 如果 $c > H=1.0$：交集为空。$p_{12}(c)=0$。\n- 如果 $m  c \\le H$ ($0.5  c \\le 1.0$)：集合为 $S_{1,H}$ 和 $S_{2,H}$。交集是 $[0, 0.5) \\cap [0.4, 0.9) = [0.4, 0.5)$。测度是 $0.1$。所以 $p_{12}(c)=0.1$。\n- 如果 $L  c \\le m$ ($0  c \\le 0.5$)：集合为 $S_{1,H} \\cup S_{1,m}$ 和 $S_{2,m} \\cup S_{2,H}$。交集是 $[0, 0.75) \\cap [0, 0.9) = [0, 0.75)$。测度是 $0.75$。所以 $p_{12}(c)=0.75$。\n- 如果 $c \\le L=0.0$：交集是 $[0,1)$。测度是 $1.0$。所以 $p_{12}(c)=1.0$。\n\n现在我们计算 $\\mathrm{Cov}_{\\mathrm{CRN}}(c) = p_{12}(c) - p_1(c)p_2(c)$。\n- 如果 $c > 1.0$：$\\mathrm{Cov}_{\\mathrm{CRN}}(c) = 0 - (0)(0) = 0$。\n- 如果 $0.5  c \\le 1.0$：$\\mathrm{Cov}_{\\mathrm{CRN}}(c) = 0.1 - (0.5)(0.5) = 0.1 - 0.25 = -0.15$。\n- 如果 $0  c \\le 0.5$：$\\mathrm{Cov}_{\\mathrm{CRN}}(c) = 0.75 - (0.75)(0.9) = 0.75 - 0.675 = 0.075$。\n- 如果 $c \\le 0.0$：$\\mathrm{Cov}_{\\mathrm{CRN}}(c) = 1.0 - (1.0)(1.0) = 0$。\n\n当阈值 $c$ 穿过质量点 $m=0.5$ 时，协方差表现出急剧的不连续性和符号翻转。\n对于 $c \\le m=0.5$ (但 $c>L=0.0$)，事件 $\\{X(\\theta_1,U)\\ge c\\}$ 和 $\\{X(\\theta_2,U)\\ge c\\}$ 是正相关的。满足这些条件的 $U$ 的集合 $[0, 0.75)$ 和 $[0, 0.9)$ 有很大的重叠。这种正相关性 $\\mathrm{Cov}_{\\mathrm{CRN}}(c) = 0.075$ 意味着 CRN 减少了方差。\n对于 $c > m=0.5$，事件变为 $\\{X(\\theta_1,U)=H\\}$ 和 $\\{X(\\theta_2,U)=H\\}$。对应的 $U$ 的集合 $[0, 0.5)$ 和 $[0.4, 0.9)$ 现在出现了显著的错位。这种错位导致重叠概率 $p_{12}(c) = 0.1$ 小于边际概率的乘积 $p_1(c)p_2(c)=0.25$，从而导致负相关 $\\mathrm{Cov}_{\\mathrm{CRN}}(c) = -0.15$。在这种机制下，CRN 增加了方差。\n这种符号翻转是 $X(\\theta_1,U)$ 和 $X(\\theta_2,U)$ 在 $U$ 的定义域上的非单调关系的直接结果，也是指示函数阈值 $c$ 如何与输出的不连续结构相互作用的结果。\n\n最后，我们计算方差差值，$V_{\\mathrm{CRN}}(c) - V_{\\mathrm{IND}}(c) = -2\\mathrm{Cov}_{\\mathrm{CRN}}(c)$。\n- 对于 $c_1=0.3$：($0  c \\le 0.5$)，差值 = $-2(0.075) = -0.15$。\n- 对于 $c_2=0.5$：($0  c \\le 0.5$)，差值 = $-2(0.075) = -0.15$。\n- 对于 $c_3=0.7$：($0.5  c \\le 1.0$)，差值 = $-2(-0.15) = 0.3$。\n- 对于 $c_4=1.0$：($0.5  c \\le 1.0$)，差值 = $-2(-0.15) = 0.3$。\n- 对于 $c_5=1.1$：($c > 1.0$)，差值 = $-2(0) = 0.0$。\n- 对于 $c_6=-0.1$：($c \\le 0.0$)，差值 = $-2(0) = 0.0$。\n这些值将由程序计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this exact computation.\n\ndef solve():\n    \"\"\"\n    Computes the exact variance difference V_CRN(c) - V_IND(c) for a suite of thresholds c.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.3,),\n        (0.5,),\n        (0.7,),\n        (1.0,),\n        (1.1,),\n        (-0.1,),\n    ]\n\n    results = []\n    # Define the numerical levels from the problem statement.\n    L, m, H = 0.0, 0.5, 1.0\n\n    for case in test_cases:\n        c = case[0]\n        \n        # Calculate p1(c) = P(X(theta_1, U) >= c)\n        # The mapping for theta_1 is:\n        # [0, 0.5) -> H=1.0\n        # [0.5, 0.75) -> m=0.5\n        # [0.75, 1) -> L=0.0\n        if c > H:\n            p1_c = 0.0\n        elif c > m:  # c is in (0.5, 1.0]\n            # X >= c only if X=H. P(X=H) = measure of [0, 0.5) = 0.5\n            p1_c = 0.5\n        elif c > L:  # c is in (0.0, 0.5]\n            # X >= c if X=H or X=m. P(X=H or X=m) = measure of [0, 0.75) = 0.75\n            p1_c = 0.75\n        else: # c = 0.0\n            # X >= c always true since all outputs are non-negative.\n            p1_c = 1.0\n\n        # Calculate p2(c) = P(X(theta_2, U) >= c)\n        # The mapping for theta_2 is:\n        # [0, 0.4) -> m=0.5\n        # [0.4, 0.9) -> H=1.0\n        # [0.9, 1) -> L=0.0\n        if c > H:\n            p2_c = 0.0\n        elif c > m:  # c is in (0.5, 1.0]\n            # X >= c only if X=H. P(X=H) = measure of [0.4, 0.9) = 0.5\n            p2_c = 0.5\n        elif c > L:  # c is in (0.0, 0.5]\n            # X >= c if X=H or X=m. P(X=H or X=m) = measure of [0, 0.9) = 0.9\n            p2_c = 0.9\n        else: # c = 0.0\n            p2_c = 1.0\n\n        # Calculate p12(c) = P(X1 >= c and X2 >= c)\n        if c > H:\n            p12_c = 0.0\n        elif c > m:  # c is in (0.5, 1.0]\n            # Need X1=H and X2=H. Intersection of [0, 0.5) and [0.4, 0.9) is [0.4, 0.5).\n            # Measure = 0.1\n            p12_c = 0.1\n        elif c > L:  # c is in (0.0, 0.5]\n            # Need (X1=H or X1=m) and (X2=H or X2=m).\n            # Intersection of [0, 0.75) and [0, 0.9) is [0, 0.75).\n            # Measure = 0.75\n            p12_c = 0.75\n        else: # c = 0.0\n            p12_c = 1.0\n        \n        # Calculate the covariance under CRN\n        cov_crn_c = p12_c - p1_c * p2_c\n        \n        # The variance difference is -2 * covariance\n        variance_diff = -2.0 * cov_crn_c\n        \n        results.append(variance_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}