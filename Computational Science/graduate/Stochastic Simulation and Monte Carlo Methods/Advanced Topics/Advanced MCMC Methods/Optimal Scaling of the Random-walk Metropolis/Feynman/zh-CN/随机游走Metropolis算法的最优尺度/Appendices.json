{
    "hands_on_practices": [
        {
            "introduction": "这个首个练习为随机游走Metropolis算法的最优缩放奠定了理论基础。我们将首先通过对称性论证，对于一个通用的多变量高斯目标，为何提议协方差矩阵应与目标的协方差矩阵成正比。这个原则是在实践中构建高效采样器的基础。",
            "id": "3325167",
            "problem": "考虑马尔可夫链蒙特卡洛 (MCMC) 中的随机游走 Metropolis (RWM) 算法，其目标分布为密度 $\\pi(x) \\propto \\exp\\!\\big(-\\tfrac{1}{2} x^{\\top} \\Sigma^{-1} x\\big)$ 的 $d$ 维高斯分布，即 $\\mathcal{N}(0,\\Sigma)$，其中 $\\Sigma$ 是一个对称正定协方差矩阵。提议的生成形式为 $Y = X + \\xi$，其中 $\\xi \\sim \\mathcal{N}(0,C)$，接受概率为 $\\alpha(X,Y) = \\min\\!\\big\\{1, \\exp\\!\\big(\\log \\pi(Y) - \\log \\pi(X)\\big)\\big\\}$。将期望平方跳跃距离 (ESJD) 定义为\n$$\n\\mathrm{ESJD}(C) = \\mathbb{E}\\Big[ \\|Y - X\\|^{2} \\, \\mathbf{1}\\{\\text{move accepted}\\} \\Big],\n$$\n其中期望是关于平稳分布 $\\pi$ 和提议机制计算的，$\\mathbf{1}\\{\\cdot\\}$ 表示指示函数。\n\n(a) 使用第一性原理（线性变换和旋转不变性），证明在提议协方差的标量缩放范围内，通过选择与目标协方差成比例的提议协方差（即 $C$ 与 $\\Sigma$ 成比例），可以最大化 ESJD。\n\n(b) 现在将注意力限制在高维小步长机制下，其中提议的形式为\n$$\nY = X + \\frac{l}{\\sqrt{d}} \\, \\Sigma^{1/2} Z, \\quad Z \\sim \\mathcal{N}(0,I_{d}),\n$$\n其中 $l > 0$ 是一个无量纲的步长参数。在此机制下，针对高斯目标，推导渐近接受率 $\\alpha(l)$（以 $l$ 表示），并确定使接受率达到标准目标值 $0.234$ 的 $l$ 值。将最终的 $l$ 数值四舍五入到四位有效数字。你的最终答案必须是单个实数 $l$。",
            "solution": "该问题包含两部分。第 (a) 部分要求证明针对多元高斯分布的随机游走 Metropolis (RWM) 采样器的最优提议协方差。第 (b) 部分要求在高维机制下推导渐近接受率，并计算能产生特定接受率的步长参数 $l$。\n\n### 第 (a) 部分：最优提议协方差\n\n目标是通过选择提议协方差矩阵 $C$ 来最大化期望平方跳跃距离 (ESJD)，其定义为\n$$\n\\mathrm{ESJD}(C) = \\mathbb{E}\\Big[ \\|Y - X\\|^{2} \\, \\mathbf{1}\\{\\text{move accepted}\\} \\Big] = \\mathbb{E}\\Big[ \\|Y - X\\|^{2} \\, \\alpha(X,Y) \\Big]\n$$\n期望是基于平稳分布 $X \\sim \\pi = \\mathcal{N}(0,\\Sigma)$ 和提议 $Y = X + \\xi$（其中 $\\xi \\sim \\mathcal{N}(0,C)$）计算的。接受概率为 $\\alpha(X,Y) = \\min\\{1, \\pi(Y)/\\pi(X)\\}$。\n\n我们利用线性变换和旋转不变性的原理来解决这个问题。核心思想是将问题变换到一个目标分布呈球对称的空间，从而简化分析。\n\n1.  **线性变换（白化）：**\n    令 $\\Sigma^{1/2}$ 为 $\\Sigma$ 的对称正定平方根。我们通过线性变换 $x' = \\Sigma^{-1/2}x$ 定义一组新的坐标。如果 $X \\sim \\mathcal{N}(0, \\Sigma)$，则变换后的变量 $X' = \\Sigma^{-1/2}X$ 服从标准多元正态分布，即 $X' \\sim \\mathcal{N}(0, I_d)$，其中 $I_d$ 是 $d \\times d$ 的单位矩阵。$X'$ 的概率密度为 $\\pi'(x') \\propto \\exp(-\\frac{1}{2} x'^{\\top}x')$，这是球对称的（即在旋转下不变）。\n\n2.  **变换后的提议：**\n    提议机制 $Y = X + \\xi$ 被变换到新的坐标系中。令 $Y' = \\Sigma^{-1/2}Y$ 且 $\\xi' = \\Sigma^{-1/2}\\xi$。\n    $$\n    Y' = \\Sigma^{-1/2}(X+\\xi) = \\Sigma^{-1/2}X + \\Sigma^{-1/2}\\xi = X' + \\xi'\n    $$\n    由于 $\\xi \\sim \\mathcal{N}(0, C)$，变换后的新息项 $\\xi'$ 也服从正态分布，其均值为 $\\mathbb{E}[\\xi'] = \\Sigma^{-1/2}\\mathbb{E}[\\xi] = 0$，协方差为\n    $$\n    C' = \\mathrm{Cov}(\\xi') = \\mathbb{E}[\\xi' \\xi'^{\\top}] = \\mathbb{E}[\\Sigma^{-1/2}\\xi (\\Sigma^{-1/2}\\xi)^{\\top}] = \\Sigma^{-1/2} \\mathbb{E}[\\xi\\xi^{\\top}] \\Sigma^{-1/2} = \\Sigma^{-1/2}C\\Sigma^{-1/2}\n    $$\n    因此，在白化空间中，提议为 $Y' = X' + \\xi'$，其中 $\\xi' \\sim \\mathcal{N}(0, C')$。\n\n3.  **接受概率的不变性：**\n    接受概率 $\\alpha(X,Y)$ 取决于密度比 $\\pi(Y)/\\pi(X)$。让我们用变换后的变量来表示它：\n    $$\n    \\log\\left(\\frac{\\pi(Y)}{\\pi(X)}\\right) = -\\frac{1}{2}Y^{\\top}\\Sigma^{-1}Y - \\left(-\\frac{1}{2}X^{\\top}\\Sigma^{-1}X\\right) = -\\frac{1}{2}(Y'^{\\top}Y' - X'^{\\top}X') = -\\frac{1}{2}(\\|Y'\\|^2 - \\|X'\\|^2)\n    $$\n    因此，接受概率 $\\alpha$ 仅取决于白化空间中状态和提议的欧几里得范数的平方。\n\n4.  **旋转对称性论证：**\n    使用 RWM 算法从标准正态目标 $\\mathcal{N}(0, I_d)$ 进行高效采样的问题现在是变换后的提议协方差 $C'$ 的函数。目标分布 $\\mathcal{N}(0, I_d)$ 在任何正交变换（旋转）$O$ 下都是不变的。也就是说，如果 $X' \\sim \\mathcal{N}(0,I_d)$，那么 $OX' \\sim \\mathcal{N}(0,I_d)$。\n\n    ESJD 是采样器效率的一种度量。让我们将白化空间中的 ESJD，$\\mathrm{ESJD}'(C') = \\mathbb{E}\\left[ \\|Y' - X'\\|^2 \\alpha(X',Y') \\right]$，视为效率的代理指标。此空间中的整个采样问题是旋转对称的。如果一个提议协方差 $C'_{\\text{opt}}$ 能最大化此效率指标（在固定尺度下，例如 $\\det(C')=\\text{constant}$），那么它的任何旋转版本 $O C'_{\\text{opt}} O^{\\top}$ 也必须是最优的。这是因为对提议的旋转不会影响从球对称目标中采样的效率。\n\n    如果我们假设协方差矩阵存在唯一的最佳形状，那么它必须在所有旋转下保持不变。也就是说，对于所有正交矩阵 $O$，都有 $C'_{\\text{opt}} = O C'_{\\text{opt}} O^{\\top}$。根据舒尔引理 (Schur's Lemma)，一个与所有正交矩阵都可交换的矩阵必须是单位矩阵的标量倍数。因此，白化空间中的最优提议协方差形式必为 $C'_{\\text{opt}} = c I_d$，其中 $c > 0$ 是某个标量。对于各向同性的目标，各向同性的提议是最优的。\n\n5.  **变换回原始空间：**\n    既然已经确定 $C'$ 的最优选择是 $c I_d$，我们就可以找到原始空间中对应的最优 $C$：\n    $$\n    C' = \\Sigma^{-1/2} C \\Sigma^{-1/2} = c I_d\n    $$\n    用 $\\Sigma^{1/2}$ 左乘，用 $\\Sigma^{1/2}$ 右乘，我们得到：\n    $$\n    \\Sigma^{1/2}(\\Sigma^{-1/2} C \\Sigma^{-1/2})\\Sigma^{1/2} = \\Sigma^{1/2}(c I_d)\\Sigma^{1/2}\n    $$\n    $$\n    I_d C I_d = c \\Sigma^{1/2}\\Sigma^{1/2}\n    $$\n    $$\n    C = c \\Sigma\n    $$\n    这表明，要最大化以 ESJD 衡量的采样器效率，提议协方差 $C$ 必须与目标协方差 $\\Sigma$ 成比例。\n\n### 第 (b) 部分：渐近接受率和最优步长\n\n我们已知在高维 ($d \\to \\infty$) 小步长机制下的提议形式为：\n$$\nY = X + \\frac{l}{\\sqrt{d}} \\Sigma^{1/2} Z, \\quad Z \\sim \\mathcal{N}(0,I_{d})\n$$\n接受概率为 $\\alpha(X,Y) = \\min\\{1, \\exp(\\Delta E)\\}$，其中 $\\Delta E = \\log \\pi(Y) - \\log \\pi(X)$。\n\n1.  **$\\Delta E$ 的推导：**\n    如第 (a) 部分所示，$\\Delta E = -\\frac{1}{2}(\\|Y'\\|^2 - \\|X'\\|^2)$，其中 $X' = \\Sigma^{-1/2}X$ 且 $Y' = \\Sigma^{-1/2}Y$。\n    在白化空间中的提议是 $Y' = X' + \\frac{l}{\\sqrt{d}} Z$。\n    将此代入 $\\Delta E$ 的表达式中：\n    $$\n    \\Delta E = -\\frac{1}{2}\\left(\\left\\|X' + \\frac{l}{\\sqrt{d}} Z\\right\\|^2 - \\|X'\\|^2\\right)\n    $$\n    $$\n    = -\\frac{1}{2}\\left(\\|X'\\|^2 + 2\\frac{l}{\\sqrt{d}} X'^{\\top}Z + \\frac{l^2}{d}\\|Z\\|^2 - \\|X'\\|^2\\right)\n    $$\n    $$\n    = -\\frac{l}{\\sqrt{d}} X'^{\\top}Z - \\frac{l^2}{2d}\\|Z\\|^2\n    $$\n\n2.  **渐近行为 ($d \\to \\infty$)：**\n    我们分析 $\\Delta E$ 的极限分布。\n    - 由于我们处于平稳状态，变量 $X'$ 服从 $\\mathcal{N}(0,I_d)$ 分布。分量 $X'_i$ 是独立同分布的 $\\mathcal{N}(0,1)$。根据大数定律 (LLN)，$\\frac{1}{d}\\|X'\\|^2 = \\frac{1}{d}\\sum_{i=1}^d (X'_i)^2 \\xrightarrow{p} \\mathbb{E}[(X'_1)^2] = 1$。\n    - 同样地，$Z \\sim \\mathcal{N}(0,I_d)$，所以根据大数定律，$\\frac{1}{d}\\|Z\\|^2 \\xrightarrow{p} 1$。\n    - 考虑项 $W_d = \\frac{1}{\\sqrt{d}}X'^{\\top}Z = \\frac{1}{\\sqrt{d}}\\sum_{i=1}^d X'_i Z_i$。在给定 $X'$ 的条件下，$W_d$ 是一个均值为 $0$、方差为 $\\frac{1}{d} \\sum_{i=1}^d (X'_i)^2 \\mathrm{Var}(Z_i) = \\frac{1}{d}\\|X'\\|^2$ 的正态随机变量。由于当 $d \\to \\infty$ 时 $\\frac{1}{d}\\|X'\\|^2 \\xrightarrow{p} 1$，$W_d$ 的条件分布收敛于标准正态分布 $\\mathcal{N}(0,1)$。这意味着 $W_d$ 的无条件分布也收敛于 $\\mathcal{N}(0,1)$。我们用 $\\mathcal{G}$ 表示这个极限标准正态变量。\n\n    将这些渐近结果代入 $\\Delta E$ 的表达式中：\n    $$\n    \\Delta E \\xrightarrow{d} -l\\mathcal{G} - \\frac{l^2}{2}\n    $$\n    $\\Delta E$ 的极限分布是一个均值为 $-l^2/2$、方差为 $l^2$ 的正态分布。\n\n3.  **渐近接受率 $\\alpha(l)$：**\n    渐近接受率是接受概率关于 $\\Delta E$ 极限分布的期望：\n    $$\n    \\alpha(l) = \\mathbb{E}_{\\mathcal{G}}\\left[\\min\\left\\{1, \\exp\\left(-l\\mathcal{G} - \\frac{l^2}{2}\\right)\\right\\}\\right]\n    $$\n    令 $\\phi(g)$ 为 $\\mathcal{G} \\sim \\mathcal{N}(0,1)$ 的概率密度函数。\n    当表达式 $\\exp(-l\\mathcal{G} - l^2/2)$ 的指数为负时，即 $-l\\mathcal{G} - l^2/2  0$ 时，该表达式的值小于 $1$。这可以简化为 $\\mathcal{G} > -l/2$（因为 $l>0$）。\n    我们可以将期望积分拆分为：\n    $$\n    \\alpha(l) = \\int_{-\\infty}^{-l/2} 1 \\cdot \\phi(g) \\,dg + \\int_{-l/2}^{\\infty} \\exp\\left(-lg - \\frac{l^2}{2}\\right) \\phi(g) \\,dg\n    $$\n    第一个积分是标准正态分布的累积分布函数 (CDF)，即 $\\Phi(-l/2)$。\n    对于第二个积分，我们代入 $\\phi(g) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-g^2/2)$：\n    $$\n    \\int_{-l/2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-lg - \\frac{l^2}{2} - \\frac{g^2}{2}\\right) \\,dg\n    $$\n    我们对指数部分进行配方：$-(\\frac{g^2}{2} + lg + \\frac{l^2}{2}) = -\\frac{1}{2}(g^2 + 2lg + l^2) = -\\frac{1}{2}(g+l)^2$。\n    积分变为：\n    $$\n    \\int_{-l/2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(g+l)^2}{2}\\right) \\,dg\n    $$\n    令 $u = g+l$，则 $du=dg$。积分下限变为 $-l/2 + l = l/2$。\n    $$\n    \\int_{l/2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) \\,du = 1 - \\Phi(l/2)\n    $$\n    利用正态分布的对称性，$1 - \\Phi(z) = \\Phi(-z)$，该积分等于 $\\Phi(-l/2)$。\n    将两部分合并，渐近接受率为：\n    $$\n    \\alpha(l) = \\Phi(-l/2) + \\Phi(-l/2) = 2\\Phi(-l/2)\n    $$\n\n4.  **求解 $l$：**\n    我们需要找到使接受率达到标准值 $0.234$ 的 $l$ 值。\n    $$\n    \\alpha(l) = 2\\Phi(-l/2) = 0.234\n    $$\n    $$\n    \\Phi(-l/2) = \\frac{0.234}{2} = 0.117\n    $$\n    为了求解 $l$，我们使用标准正态分布的反累积分布函数 $\\Phi^{-1}$：\n    $$\n    -l/2 = \\Phi^{-1}(0.117)\n    $$\n    $$\n    l = -2 \\Phi^{-1}(0.117)\n    $$\n    使用统计计算器或软件，我们找到分位数函数的值 $\\Phi^{-1}(0.117) \\approx -1.19015$。\n    因此，\n    $$\n    l \\approx -2 \\times (-1.19015) = 2.3803\n    $$\n    四舍五入到四位有效数字，我们得到 $l \\approx 2.380$。",
            "answer": "$$\\boxed{2.380}$$"
        },
        {
            "introduction": "在理论见解的基础上，本实践转向数值实现和验证。您将推导采样器的渐近速度函数，并编写一个程序来寻找最大化该函数的缩放参数。这个练习让您对提议步长和接受率之间的权衡有一个具体的感受，并让您能够通过数值方式确认著名的最优接受率约为 $0.234$。",
            "id": "3325139",
            "problem": "考虑 Markov chain Monte Carlo (MCMC) 中的 Random-Walk Metropolis (RWM) 算法，该算法的目标是$d$维标准正态分布，其坐标独立同分布，密度表示为 $\\pi_d(\\mathbf{x}) \\propto \\exp\\!\\left(-\\frac{1}{2}\\lVert \\mathbf{x} \\rVert^2\\right)$，其中 $\\mathbf{x} \\in \\mathbb{R}^d$。提议的生成方式为 $\\mathbf{Y} = \\mathbf{X} + s \\mathbf{Z}$，其中 $\\mathbf{Z} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}_d)$ 且与 $\\mathbf{X}$ 独立，$s = \\frac{l}{\\sqrt{d}}$ 并且 $l  0$ 是一个无量纲缩放参数。Metropolis 接受概率为 $\\alpha(\\mathbf{X}, \\mathbf{Y}) = \\min\\!\\left\\{1, \\frac{\\pi_d(\\mathbf{Y})}{\\pi_d(\\mathbf{X})}\\right\\}$，且算法在平稳状态下运行，此时 $\\mathbf{X} \\sim \\pi_d$。\n\n将渐进接受率函数 $a(l)$ 定义为当 $d \\to \\infty$ 时，平稳状态下期望接受概率的极限；并将渐进速度函数 $h(l)$ 定义为当 $d \\to \\infty$ 时，极限期望平方跳跃距离（经过适当缩放以捕捉扩散极限）。$a(l)$ 和 $h(l)$ 都是无量纲缩放参数 $l$ 的函数。\n\n从上述基本定义（目标分布、提议机制和接受概率）出发，且不使用任何预先给出的优化公式，推导出在高维极限 $d \\to \\infty$ 下出现的 $a(l)$ 和 $h(l)$ 的表达式。然后，实现一个程序，对不同 $l$ 值数值计算这些函数，并找出使 $h(l)$ 最大化的 $l$ 值。最后，通过数值方法确认，在这个使函数最大化的 $l$ 值处的接受率接近常数 0.234。\n\n您的程序必须：\n- 在指定的 $l$ 网格上计算 $a(l)$ 和 $h(l)$。\n- 通过网格搜索找到使 $h(l)$ 最大化的 $l$。\n- 报告在使函数最大化的 $l$ 处的接受率。\n- 为指定的接近或不等式条件提供布尔确认。\n\n测试套件：\n对于以下每种情况，在指定的区间和点数上执行网格搜索，计算在该网格上使 $h(l)$ 最大化的 $l^\\star$ 处的接受率 $a(l^\\star)$，并返回指定的结果。\n\n1. 情况 A（大范围搜索）：在区间 $[0.01, 10.0]$ 上使用 $5001$ 个均匀间隔的点。返回接受率 $a(l^\\star)$（浮点数），以及一个布尔值，表示 $\\lvert a(l^\\star) - 0.234 \\rvert \\leq 0.01$ 是否成立。\n2. 情况 B（小步长机制）：在区间 $[0.001, 0.3]$ 上使用 $1000$ 个点。返回接受率 $a(l^\\star)$（浮点数），以及一个布尔值，表示 $a(l^\\star) \\geq 0.5$ 是否成立。\n3. 情况 C（大步长机制）：在区间 $[5.0, 15.0]$ 上使用 $1000$ 个点。返回接受率 $a(l^\\star)$（浮点数），以及一个布尔值，表示 $a(l^\\star) \\leq 0.05$ 是否成立。\n4. 情况 D（聚焦搜索）：在区间 $[0.05, 5.0]$ 上使用 $2000$ 个点。返回接受率 $a(l^\\star)$（浮点数），以及一个布尔值，表示 $\\lvert a(l^\\star) - 0.234 \\rvert \\leq 0.005$ 是否成立。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况 A–D 的顺序排列：$[a_A,\\text{close}_A,a_B,\\text{cond}_B,a_C,\\text{cond}_C,a_D,\\text{close}_D]$，其中每个 $a_\\cdot$ 是一个浮点数，每个 $\\text{close}_\\cdot$ 或 $\\text{cond}_\\cdot$ 是一个布尔值。此问题不涉及任何物理单位或角度。",
            "solution": "用户提供的问题经评估有效。这是一个来自 Markov chain Monte Carlo 方法领域的适定、有科学依据的问题，具体涉及高维情况下 Random-Walk Metropolis 算法的最优缩放问题。该问题是自洽的，没有矛盾或歧义。我现在将进行形式化的推导和求解。\n\n目标是推导以$d$维标准正态分布为目标的 Random-Walk Metropolis (RWM) 算法的接受率 $a(l)$ 和缩放速度函数 $h(l)$ 的渐进形式，然后对速度进行数值优化。\n\n设 $\\mathbb{R}^d$ 中的目标分布为 $\\pi_d(\\mathbf{x}) = (2\\pi)^{-d/2} \\exp(-\\frac{1}{2}\\lVert \\mathbf{x} \\rVert^2)$。从当前状态 $\\mathbf{X}$ 生成提议 $\\mathbf{Y} = \\mathbf{X} + s \\mathbf{Z}$，其中 $\\mathbf{Z} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}_d)$，步长为 $s = l/\\sqrt{d}$，缩放参数 $l  0$。假设算法处于平稳状态，因此当前状态 $\\mathbf{X}$ 是从目标分布中抽取的样本，即 $\\mathbf{X} \\sim \\pi_d$。\n\nMetropolis 接受概率由下式给出：$\\alpha(\\mathbf{X}, \\mathbf{Y}) = \\min\\left\\{1, \\frac{\\pi_d(\\mathbf{Y})}{\\pi_d(\\mathbf{X})}\\right\\}$。\n密度比为：\n$$\n\\frac{\\pi_d(\\mathbf{Y})}{\\pi_d(\\mathbf{X})} = \\frac{\\exp(-\\frac{1}{2}\\lVert \\mathbf{Y} \\rVert^2)}{\\exp(-\\frac{1}{2}\\lVert \\mathbf{X} \\rVert^2)} = \\exp\\left(-\\frac{1}{2}(\\lVert \\mathbf{Y} \\rVert^2 - \\lVert \\mathbf{X} \\rVert^2)\\right)\n$$\n我们分析指数中的项 $\\lVert \\mathbf{Y} \\rVert^2 - \\lVert \\mathbf{X} \\rVert^2$。代入提议表达式：\n$$\n\\lVert \\mathbf{Y} \\rVert^2 = \\left\\lVert \\mathbf{X} + \\frac{l}{\\sqrt{d}}\\mathbf{Z} \\right\\rVert^2 = \\left(\\mathbf{X} + \\frac{l}{\\sqrt{d}}\\mathbf{Z}\\right)^T\\left(\\mathbf{X} + \\frac{l}{\\sqrt{d}}\\mathbf{Z}\\right) = \\lVert \\mathbf{X} \\rVert^2 + \\frac{2l}{\\sqrt{d}}\\mathbf{X}^T\\mathbf{Z} + \\frac{l^2}{d}\\lVert \\mathbf{Z} \\rVert^2\n$$\n因此，差值为：\n$$\n\\lVert \\mathbf{Y} \\rVert^2 - \\lVert \\mathbf{X} \\rVert^2 = \\frac{2l}{\\sqrt{d}}\\mathbf{X}^T\\mathbf{Z} + \\frac{l^2}{d}\\lVert \\mathbf{Z} \\rVert^2\n$$\n为了找到当 $d \\to \\infty$ 时的渐进行为，我们逐项考察。\n第一项涉及 $\\mathbf{X}^T\\mathbf{Z} = \\sum_{i=1}^d X_i Z_i$。由于 $\\mathbf{X} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}_d)$ 和 $\\mathbf{Z} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}_d)$ 是独立的，它们的分量 $X_i$ 和 $Z_i$ 是独立同分布的标准正态随机变量。乘积的期望是 $\\mathbb{E}[X_i Z_i] = \\mathbb{E}[X_i]\\mathbb{E}[Z_i] = 0 \\cdot 0 = 0$。方差是 $\\text{Var}(X_i Z_i) = \\mathbb{E}[(X_i Z_i)^2] - (\\mathbb{E}[X_i Z_i])^2 = \\mathbb{E}[X_i^2]\\mathbb{E}[Z_i^2] = 1 \\cdot 1 = 1$。\n根据中心极限定理，归一化和依分布收敛于一个标准正态随机变量：\n$$\n\\frac{1}{\\sqrt{d}}\\mathbf{X}^T\\mathbf{Z} = \\frac{1}{\\sqrt{d}}\\sum_{i=1}^d X_i Z_i \\xrightarrow{d} W \\sim \\mathcal{N}(0, 1) \\quad \\text{as } d \\to \\infty\n$$\n\n第二项涉及 $\\lVert \\mathbf{Z} \\rVert^2 = \\sum_{i=1}^d Z_i^2$。这是 $d$ 个独立同分布随机变量 $Z_i^2$ 的和，其中 $Z_i \\sim \\mathcal{N}(0,1)$，因此 $\\mathbb{E}[Z_i^2] = 1$。根据大数定律：\n$$\n\\frac{1}{d}\\lVert \\mathbf{Z} \\rVert^2 = \\frac{1}{d}\\sum_{i=1}^d Z_i^2 \\xrightarrow{p} \\mathbb{E}[Z_1^2] = 1 \\quad \\text{as } d \\to \\infty\n$$\n其中 $\\xrightarrow{p}$ 表示依概率收敛。\n\n令 $\\Delta_d = -\\frac{1}{2}(\\lVert \\mathbf{Y} \\rVert^2 - \\lVert \\mathbf{X} \\rVert^2)$。代入各分量的极限：\n$$\n\\Delta_d = -\\frac{1}{2}\\left(\\frac{2l}{\\sqrt{d}}\\mathbf{X}^T\\mathbf{Z} + \\frac{l^2}{d}\\lVert \\mathbf{Z} \\rVert^2\\right) \\xrightarrow{d} -lW - \\frac{l^2}{2} \\quad \\text{as } d \\to \\infty\n$$\n接受概率 $\\alpha_d = \\min\\{1, \\exp(\\Delta_d)\\}$ 是 $\\Delta_d$ 的一个连续函数。根据连续映射定理，其极限分布为：\n$$\n\\alpha_d \\xrightarrow{d} \\alpha(l, W) = \\min\\left\\{1, \\exp\\left(-lW - \\frac{l^2}{2}\\right)\\right\\}\n$$\n渐进接受率 $a(l)$ 是这个极限随机变量关于 $W \\sim \\mathcal{N}(0,1)$ 的期望：\n$$\na(l) = \\mathbb{E}_W\\left[\\min\\left\\{1, \\exp\\left(-lW - \\frac{l^2}{2}\\right)\\right\\}\\right]\n$$\n当指数为负时，即 $-lW - l^2/2  0$，最小值内的表达式小于 1。对于 $l>0$，这等价于 $W > -l/2$。我们将期望在实数轴上分段：\n$$\na(l) = \\int_{-\\infty}^{-l/2} 1 \\cdot \\phi(w) \\,dw + \\int_{-l/2}^{\\infty} \\exp\\left(-lw - \\frac{l^2}{2}\\right) \\phi(w) \\,dw\n$$\n其中 $\\phi(w) = (2\\pi)^{-1/2}\\exp(-w^2/2)$ 是标准正态概率密度函数（PDF）。\n第一个积分是标准正态累积分布函数（CDF）的定义，即 $\\Phi(-l/2)$。\n对于第二个积分，我们对指数部分进行配方：\n$$\n-lw - \\frac{l^2}{2} - \\frac{w^2}{2} = -\\frac{1}{2}(w^2 + 2lw + l^2) = -\\frac{1}{2}(w+l)^2\n$$\n该积分变为：\n$$\n\\int_{-l/2}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(w+l)^2}{2}\\right) \\,dw\n$$\n令 $u = w+l$，则 $du = dw$。积分下限变为 $-l/2 + l = l/2$。根据正态分布的对称性，该积分为 $\\int_{l/2}^{\\infty} \\phi(u) \\,du = 1 - \\Phi(l/2) = \\Phi(-l/2)$。\n将两部分结合起来，我们得到渐进接受率：\n$$\na(l) = \\Phi(-l/2) + \\Phi(-l/2) = 2\\Phi(-l/2)\n$$\n\n接下来，我们定义渐进速度函数 $h(l)$。这是算法效率的一个度量，定义为（经过缩放的）期望平方跳跃距离（ESJD）。跳跃是 $\\mathbf{X}_{k+1} - \\mathbf{X}_k$。如果提议被接受，则跳跃为 $\\mathbf{Y} - \\mathbf{X} = s\\mathbf{Z}$；如果被拒绝，则为 $\\mathbf{0}$。\n$$\n\\text{ESJD}_d = \\mathbb{E}[\\lVert \\mathbf{X}_{k+1} - \\mathbf{X}_k \\rVert^2] = \\mathbb{E}[\\alpha(\\mathbf{X}, \\mathbf{Y}) \\lVert s\\mathbf{Z} \\rVert^2]\n$$\n此处，$\\mathbf{X}$ 是平稳状态下的状态。由于 $\\mathbf{Z}$ 与 $\\mathbf{X}$ 独立，我们可以分离期望：\n$$\n\\text{ESJD}_d = \\mathbb{E}[\\alpha(\\mathbf{X}, \\mathbf{Y})] \\cdot \\mathbb{E}[s^2 \\lVert \\mathbf{Z} \\rVert^2] = \\mathbb{E}[\\alpha(\\mathbf{X}, \\mathbf{Y})] \\cdot \\frac{l^2}{d} \\cdot d = l^2 \\mathbb{E}[\\alpha(\\mathbf{X}, \\mathbf{Y})]\n$$\n量 $\\mathbb{E}[\\alpha(\\mathbf{X}, \\mathbf{Y})]$ 是有限维度 $d$ 的期望接受率。在 $d \\to \\infty$ 的极限下，它收敛于 $a(l)$。因此，极限 ESJD，我们称之为速度函数 $h(l)$，是：\n$$\nh(l) = l^2 a(l) = 2l^2\\Phi(-l/2)\n$$\n这个函数 $h(l)$ 表示在提出大方差提议（大的 $l^2$）和使其被接受（大的 $a(l)$）之间的权衡。为了优化 RWM 算法在高维下的性能，必须找到使 $h(l)$ 最大化的 $l$ 值，记为 $l^\\star$。这个优化问题通常通过数值方法求解。相应的接受率 $a(l^\\star)$ 对于这类问题是一个普适常数，已知约为 0.234。\n\n计算任务是实现函数 $a(l)$ 和 $h(l)$，在指定的 $l$ 区间上执行网格搜索以找到 $h(l)$ 的近似最大化值 $l^\\star$，并报告接受率 $a(l^\\star)$ 以及其他指定的逻辑条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Analyzes the optimal scaling of the Random-Walk Metropolis algorithm.\n\n    This function implements the derived asymptotic acceptance rate a(l) and\n    speed function h(l) for the RWM algorithm in high dimensions. It performs\n    a grid search to find the scaling parameter l that maximizes the speed\n    for different regimes, and reports the corresponding acceptance rates\n    and boolean checks as per the problem specification.\n    \"\"\"\n    \n    # Test cases defined in the problem statement\n    # Each case is a tuple: (l_min, l_max, num_points, check_type, check_value, check_tol)\n    # check_type: 1 for |a - val| = tol, 2 for a >= val, 3 for a = val\n    test_cases = [\n        # Case A: Wide search\n        (0.01, 10.0, 5001, 1, 0.234, 0.01),\n        # Case B: Small-step regime\n        (0.001, 0.3, 1000, 2, 0.5, None),\n        # Case C: Large-step regime\n        (5.0, 15.0, 1000, 3, 0.05, None),\n        # Case D: Focused search\n        (0.05, 5.0, 2000, 1, 0.234, 0.005),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        l_min, l_max, num_points, check_type, check_val, check_tol = case\n\n        # Create the grid of l values\n        l_grid = np.linspace(l_min, l_max, num_points, dtype=np.float64)\n\n        # Calculate the asymptotic acceptance rate a(l)\n        # a(l) = 2 * Phi(-l/2), where Phi is the standard normal CDF.\n        a_values = 2.0 * norm.cdf(-l_grid / 2.0)\n\n        # Calculate the asymptotic speed function h(l)\n        # h(l) = l^2 * a(l)\n        h_values = l_grid**2 * a_values\n\n        # Find the index of the maximum value of h(l) on the grid\n        idx_max = np.argmax(h_values)\n\n        # Get the acceptance rate at the l that maximizes h(l)\n        a_star = a_values[idx_max]\n        results.append(a_star)\n\n        # Perform the boolean check for the current case\n        if check_type == 1:\n            # Check if |a_star - check_val| = check_tol\n            condition_met = np.abs(a_star - check_val) = check_tol\n        elif check_type == 2:\n            # Check if a_star >= check_val\n            condition_met = a_star >= check_val\n        elif check_type == 3:\n            # Check if a_star = check_val\n            condition_met = a_star = check_val\n        \n        results.append(condition_met)\n\n    # Format the results into the required string format\n    # [a_A, close_A, a_B, cond_B, a_C, cond_C, a_D, close_D]\n    final_output_str = f\"[{','.join(map(str, results))}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "我们最后的实践探讨了最优缩放的原理如何从简单的高斯目标推广到具有更重尾部的目标，例如学生t分布。您将研究算法收敛到扩散极限所需的正则性条件，并计算费雪信息（Fisher information），这是一个控制采样器速度的关键量。这个练习揭示了目标分布的几何形状与MCMC算法效率之间更深层次的联系。",
            "id": "3325158",
            "problem": "考虑一个维度为 $d$ 的乘积形式目标序列，其形式为 $\\pi_{d}(x_{1},\\dots,x_{d})=\\prod_{i=1}^{d} f_{\\nu}(x_{i})$，其中 $f_{\\nu}$ 是 $\\mathbb{R}$ 上自由度为 $\\nu0$ 的标准学生t分布（Student-$t$）密度。使用一个带有各向同性高斯提议的随机游走梅特罗波利斯（Random-Walk Metropolis, RWM）算法：从当前状态 $x\\in\\mathbb{R}^{d}$ 提议 $x'=x+\\sigma_{d} Z$，其中 $Z\\sim \\mathcal{N}(0,I_{d})$，并以标准的梅特罗波利斯-黑斯廷斯（Metropolis–Hastings）概率接受。假设提议按 $\\sigma_{d}=\\ell/\\sqrt{d}$ 进行缩放，其中 $\\ell0$ 为一个固定值。\n\n从马尔可夫链蒙特卡洛（MCMC）的随机过程极限的有效基础理论出发，分析为确保在上述缩放条件下 RWM 链单个坐标的弱扩散极限存在，Student-$t_{\\nu}$ 族所需的正则性，并由此分析渐近最优接受率 $0.234$ 的普适性。具体来说：\n\n- 令 $g(x)=\\log f_{\\nu}(x)$ 且 $X\\sim f_{\\nu}$。解释对 $g'(X)$、$g''(X)$ 和 $g'''(X)$ 的可积性与平滑性要求，如何与重缩放后第一个坐标的扩散极限的存在性，以及最优缩放下 $0.234$ 接受率规则的有效性相关联。\n- 确定参数 $\\nu$ 需满足的条件，以保证这些要求对 Student-$t_{\\nu}$ 目标成立。\n- 以闭合形式计算在扩散极限表征中出现的费雪信息量（Fisher information）$I(\\nu)=\\mathbb{E}\\!\\left[(g'(X))^{2}\\right]$。\n\n你的最终答案必须仅为 $I(\\nu)$ 的精确解析表达式，不含任何额外文本。无需四舍五入。",
            "solution": "我们考虑一个乘积目标 $\\pi_{d}(x)=\\prod_{i=1}^{d} f_{\\nu}(x_{i})$，其中 $f_{\\nu}$ 是 $\\mathbb{R}$ 上自由度为 $\\nu0$ 的标准学生t分布（Student-$t$）密度，\n$$\nf_{\\nu}(x)=c_{\\nu}\\left(1+\\frac{x^{2}}{\\nu}\\right)^{-(\\nu+1)/2},\\qquad c_{\\nu}=\\frac{\\Gamma\\!\\left(\\frac{\\nu+1}{2}\\right)}{\\sqrt{\\nu\\pi}\\,\\Gamma\\!\\left(\\frac{\\nu}{2}\\right)}.\n$$\n我们运行一个随机游走梅特罗波利斯（RWM）算法，其提议为 $x'=x+\\sigma_{d}Z$，$Z\\sim \\mathcal{N}(0,I_{d})$，并按 $\\sigma_{d}=\\ell/\\sqrt{d}$ 进行缩放。\n\n关于独立同分布（i.i.d.）乘积目标上的 RWM 的基础扩散极限理论指出，在一维对数密度 $g=\\log f$ 的正则性条件（某些导数相对于 $f$ 的平滑性和可积性）下，第一个坐标过程经过适当的连续时间插值和重缩放后，弱收敛于一个朗之万扩散（Langevin diffusion），其漂移和扩散系数依赖于费雪信息\n$$\nI=\\mathbb{E}\\!\\left[(g'(X))^{2}\\right],\\qquad X\\sim f.\n$$\n在 $\\sigma_{d}=\\ell/\\sqrt{d}$ 缩放下的渐近平均接受概率是 $\\ell\\sqrt{I}$ 的函数，而最大化极限扩散速度的最优缩放会产生一个普适的最优平均接受率，其值为 $0.234$。因此，为确保扩散极限存在且 $0.234$ 规则成立，只需验证 $f_{\\nu}$ 所需的可微性和可积性条件，包括 $I(\\nu)=\\mathbb{E}[(g'(X))^{2}]$ 的有限性以及 $g''$ 和 $g'''$ 在 $f_{\\nu}$ 下的适当可积性。\n\n我们推导 $f_{\\nu}$ 的对数密度 $g$ 及其导数。在相差一个加性常数的情况下，\n$$\ng(x)=\\log f_{\\nu}(x)=-\\frac{\\nu+1}{2}\\,\\log\\!\\left(1+\\frac{x^{2}}{\\nu}\\right).\n$$\n求导可得，\n$$\ng'(x)=-\\frac{\\nu+1}{2}\\cdot \\frac{1}{1+x^{2}/\\nu}\\cdot \\frac{2x}{\\nu}= -\\,\\frac{\\nu+1}{\\nu+x^{2}}\\,x,\n$$\n$$\ng''(x)=-\\,\\frac{\\nu+1}{\\nu+x^{2}}+\\frac{2(\\nu+1)x^{2}}{(\\nu+x^{2})^{2}}=-\\,(\\nu+1)\\,\\frac{\\nu - x^{2}}{(\\nu+x^{2})^{2}},\n$$\n$$\ng'''(x)=-\\,(\\nu+1)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\nu - x^{2}}{(\\nu+x^{2})^{2}}\\right) = -\\,(\\nu+1)\\,\\frac{-2x(\\nu+x^{2})^{2}-(\\nu - x^{2})\\cdot 2(\\nu+x^{2})\\cdot 2x}{(\\nu+x^{2})^{4}}.\n$$\n从 $|x|$ 较大时的行为来看，当 $|x|\\to\\infty$ 时，我们有 $g'(x)\\sim -(\\nu+1)/x$，$g''(x)\\sim (\\nu+1)/x^{2}$，以及 $g'''(x)\\sim \\mathrm{const}\\cdot 1/x^{3}$。Student-$t_{\\nu}$ 密度的尾部是多项式的，即当 $|x|\\to\\infty$ 时，$f_{\\nu}(x)\\asymp |x|^{-(\\nu+1)}$。因此，对于我们关心的期望值：\n- $\\mathbb{E}\\!\\left[(g'(X))^{2}\\right]$ 在尾部的行为类似于 $\\int |x|^{-2}\\cdot |x|^{-(\\nu+1)}\\,\\mathrm{d}x=\\int |x|^{-(\\nu+3)}\\,\\mathrm{d}x$，该积分对所有 $\\nu0$ 收敛。\n- $\\mathbb{E}\\!\\left[|g''(X)|\\right]$ 的行为类似于 $\\int |x|^{-2}\\cdot |x|^{-(\\nu+1)}\\,\\mathrm{d}x$，同样对所有 $\\nu0$ 都是有限的。\n- $\\mathbb{E}\\!\\left[|g'''(X)|\\right]$ 的行为类似于 $\\int |x|^{-3}\\cdot |x|^{-(\\nu+1)}\\,\\mathrm{d}x$，对所有 $\\nu0$ 都是有限的。\n\n在原点附近，$g'$ 及其高阶导数是有界且平滑的，因此它们的期望也是有限的。所以，对于所有 $\\nu0$，RWM 扩散极限的标准正则性条件都得到满足。因此，在 $\\sigma_{d}=\\ell/\\sqrt{d}$ 缩放条件下，对于所有 $\\nu0$，扩散极限存在，且渐近最优平均接受率等于 $0.234$。\n\n剩下的任务是显式地计算费雪信息\n$$\nI(\\nu)=\\mathbb{E}\\!\\left[(g'(X))^{2}\\right]=(\\nu+1)^{2}\\,\\mathbb{E}\\!\\left[\\frac{X^{2}}{(\\nu+X^{2})^{2}}\\right],\\qquad X\\sim t_{\\nu}.\n$$\n我们以闭合形式计算该期望值。使用表示 $f_{\\nu}(x)\\propto \\left(1+\\frac{x^{2}}{\\nu}\\right)^{-(\\nu+1)/2}$ 和代换 $x=\\sqrt{\\nu}\\,\\tan\\theta$（其中 $\\theta\\in(-\\pi/2,\\pi/2)$），我们得到\n$$\n\\nu+x^{2}=\\nu\\sec^{2}\\theta,\\qquad \\frac{x^{2}}{(\\nu+x^{2})^{2}}=\\frac{\\nu\\tan^{2}\\theta}{\\nu^{2}\\sec^{4}\\theta}=\\frac{1}{\\nu}\\,\\sin^{2}\\theta\\,\\cos^{2}\\theta,\n$$\n和\n$$\nf_{\\nu}(x)\\,\\mathrm{d}x \\propto \\left(\\sec^{2}\\theta\\right)^{-(\\nu+1)/2}\\cdot \\sqrt{\\nu}\\sec^{2}\\theta\\,\\mathrm{d}\\theta = \\sqrt{\\nu}\\,\\cos^{\\nu-1}\\theta\\,\\mathrm{d}\\theta.\n$$\n因此，\n$$\n\\mathbb{E}\\!\\left[\\frac{X^{2}}{(\\nu+X^{2})^{2}}\\right]=\\frac{1}{\\nu}\\cdot \\frac{\\int_{-\\pi/2}^{\\pi/2} \\sin^{2}\\theta\\,\\cos^{\\nu+1}\\theta\\,\\mathrm{d}\\theta}{\\int_{-\\pi/2}^{\\pi/2} \\cos^{\\nu-1}\\theta\\,\\mathrm{d}\\theta}.\n$$\n根据对称性，两个积分都是在 $(0,\\pi/2)$ 上积分值的两倍，并使用对于 $a,b0$ 的贝塔函数（Beta-function）恒等式 $\\int_{0}^{\\pi/2}\\sin^{a-1}\\theta\\,\\cos^{b-1}\\theta\\,\\mathrm{d}\\theta=\\tfrac{1}{2}\\,B\\!\\left(\\tfrac{a}{2},\\tfrac{b}{2}\\right)$，我们得到\n$$\n\\int_{0}^{\\pi/2} \\sin^{2}\\theta\\,\\cos^{\\nu+1}\\theta\\,\\mathrm{d}\\theta=\\frac{1}{2}\\,B\\!\\left(\\frac{3}{2},\\frac{\\nu+2}{2}\\right),\\qquad\n\\int_{0}^{\\pi/2} \\cos^{\\nu-1}\\theta\\,\\mathrm{d}\\theta=\\frac{1}{2}\\,B\\!\\left(\\frac{1}{2},\\frac{\\nu}{2}\\right).\n$$\n于是，\n$$\n\\mathbb{E}\\!\\left[\\frac{X^{2}}{(\\nu+X^{2})^{2}}\\right]=\\frac{1}{\\nu}\\cdot \\frac{B\\!\\left(\\frac{3}{2},\\frac{\\nu+2}{2}\\right)}{B\\!\\left(\\frac{1}{2},\\frac{\\nu}{2}\\right)}.\n$$\n使用 $B(a,b)=\\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}$，$\\Gamma\\!\\left(\\tfrac{3}{2}\\right)=\\tfrac{\\sqrt{\\pi}}{2}$，$\\Gamma\\!\\left(\\tfrac{1}{2}\\right)=\\sqrt{\\pi}$，$\\Gamma\\!\\left(\\tfrac{\\nu+2}{2}\\right)=\\tfrac{\\nu}{2}\\,\\Gamma\\!\\left(\\tfrac{\\nu}{2}\\right)$，以及 $\\Gamma\\!\\left(\\tfrac{\\nu+5}{2}\\right)=\\tfrac{\\nu+3}{2}\\cdot \\tfrac{\\nu+1}{2}\\,\\Gamma\\!\\left(\\tfrac{\\nu+1}{2}\\right)$，我们简化如下：\n\\begin{align*}\n\\mathbb{E}\\!\\left[\\frac{X^{2}}{(\\nu+X^{2})^{2}}\\right]\n=\\frac{1}{\\nu}\\cdot \\frac{\\Gamma\\!\\left(\\tfrac{3}{2}\\right)\\Gamma\\!\\left(\\tfrac{\\nu+2}{2}\\right)\\Gamma\\!\\left(\\tfrac{\\nu+1}{2}\\right)}{\\Gamma\\!\\left(\\tfrac{1}{2}\\right)\\Gamma\\!\\left(\\tfrac{\\nu}{2}\\right)\\Gamma\\!\\left(\\tfrac{\\nu+5}{2}\\right)}\\\\\n=\\frac{1}{\\nu}\\cdot \\frac{\\tfrac{\\sqrt{\\pi}}{2}\\cdot \\tfrac{\\nu}{2}\\,\\Gamma\\!\\left(\\tfrac{\\nu}{2}\\right)\\Gamma\\!\\left(\\tfrac{\\nu+1}{2}\\right)}{\\sqrt{\\pi}\\,\\Gamma\\!\\left(\\tfrac{\\nu}{2}\\right)\\cdot \\tfrac{\\nu+3}{2}\\cdot \\tfrac{\\nu+1}{2}\\,\\Gamma\\!\\left(\\tfrac{\\nu+1}{2}\\right)}\\\\\n=\\frac{1}{\\nu}\\cdot \\frac{\\tfrac{\\nu}{4}}{\\tfrac{(\\nu+3)(\\nu+1)}{4}}=\\frac{1}{(\\nu+3)(\\nu+1)}.\n\\end{align*}\n因此，\n$$\nI(\\nu)=(\\nu+1)^{2}\\,\\mathbb{E}\\!\\left[\\frac{X^{2}}{(\\nu+X^{2})^{2}}\\right]=(\\nu+1)^{2}\\cdot \\frac{1}{(\\nu+3)(\\nu+1)}=\\frac{\\nu+1}{\\nu+3}.\n$$\n我们已经证明：\n- 由于 $g',g'',g'''$ 的函数的所需期望是有限的，因此在 $\\sigma_{d}=\\ell/\\sqrt{d}$ 下 RWM 的扩散极限所需的正则性条件以及最优接受率 $0.234$ 的普适性对所有 $\\nu0$ 都成立。\n- 进入极限的费雪信息为 $I(\\nu)=\\frac{\\nu+1}{\\nu+3}$。\n\n根据题目要求，我们仅报告 $I(\\nu)$ 的精确解析表达式作为最终答案。",
            "answer": "$$\\boxed{\\frac{\\nu+1}{\\nu+3}}$$"
        }
    ]
}