{
    "hands_on_practices": [
        {
            "introduction": "理解边缘似然最直接的方式是从一个可以精确求解的案例入手。这个练习使用一个简单的正态-正态模型，这是一个共轭设定，允许我们通过解析方法直接推导出边缘似然和贝叶斯因子 $BF_{12}$。通过这个实践，你将建立关于先验选择如何直接影响模型证据的直观理解，这是贝叶斯模型选择中的一个核心概念。",
            "id": "3319160",
            "problem": "考虑一个具有已知方差的单参数正态似然。您观测到来自抽样模型 $y_{i} \\mid \\mu \\sim \\mathcal{N}(\\mu,\\sigma^{2})$ 的 $n$ 个独立同分布（i.i.d.）样本 $y_{1},\\dots,y_{n}$，其中 $\\sigma^{2}  0$ 已知。为未知均值 $\\mu$ 假定了两个贝叶斯模型：\n- 模型 $\\mathcal{M}_{1}$：$\\mu \\sim \\mathcal{N}(m_{0},\\tau_{1}^{2})$，其中 $\\tau_{1}^{2}  0$，\n- 模型 $\\mathcal{M}_{2}$：$\\mu \\sim \\mathcal{N}(m_{0},\\tau_{2}^{2})$，其中 $\\tau_{2}^{2}  0$，\n\n其中 $m_{0} \\in \\mathbb{R}$ 是一个共同的先验均值，$\\tau_{1}^{2} \\neq \\tau_{2}^{2}$ 是不同的先验方差。令 $\\bar{y} \\equiv \\frac{1}{n}\\sum_{i=1}^{n} y_{i}$ 表示样本均值，令 $R \\equiv \\sum_{i=1}^{n} (y_{i}-\\bar{y})^{2}$ 表示样本内平方和。支持 $\\mathcal{M}_{1}$ 而非 $\\mathcal{M}_{2}$ 的贝叶斯因子（BF）定义为边际似然的比值，\n$$\nBF_{12} \\equiv \\frac{p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{1})}{p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{2})},\n$$\n其中，对于每个模型 $\\mathcal{M}_{j}$（$j \\in \\{1,2\\}$），边际似然 $p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{j})$ 由似然函数对先验的积分给出。\n\n仅从边际似然作为积分的定义和高斯密度的性质出发，完成以下任务：\n- 通过在每个模型下对 $\\mu$ 进行解析积分，推导 $p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{j})$ 的闭式表达式，并用 $n$、$\\sigma^{2}$、$\\tau_{j}^{2}$、$m_{0}$、$\\bar{y}$ 和 $R$ 表示您的结果。\n- 使用您的结果，以闭式形式计算 $BF_{12}$ 并尽可能地简化它。\n\n然后，通过分析 $\\ln BF_{12}$ 关于 $\\tau_{1}^{2}$ 和 $\\tau_{2}^{2}$ 的偏导数的符号，评估当先验方差 $\\tau_{1}^{2}$ 和 $\\tau_{2}^{2}$ 变化时 $BF_{12}$ 如何变化。简要解释样本量 $n$、已知方差 $\\sigma^{2}$ 以及差异 $|\\bar{y}-m_{0}|$ 在此敏感性中的作用。\n\n答案形式要求：仅报告 $BF_{12}$ 的最终简化解析表达式。不要近似。您的最终方框答案必须是单个闭式解析表达式，不带单位，也无额外评注。",
            "solution": "该问题要求推导贝叶斯因子 $BF_{12}$，用于比较两个模型 $\\mathcal{M}_{1}$ 和 $\\mathcal{M}_{2}$，这两个模型仅在参数 $\\mu$ 的先验方差上有所不同。这首先涉及为通用模型 $\\mathcal{M}_{j}$ 找到边际似然 $p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{j})$ 的闭式表达式。\n\n### 步骤1：边际似然 $p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{j})$ 的推导\n\n模型 $\\mathcal{M}_{j}$ 的边际似然定义为似然函数乘以参数 $\\mu$ 的先验概率密度的积分：\n$$ p(y_{1},\\dots,y_{n} \\mid \\mathcal{M}_{j}) = \\int_{-\\infty}^{\\infty} p(y_{1},\\dots,y_{n} \\mid \\mu, \\sigma^{2}) p(\\mu \\mid \\mathcal{M}_{j}) d\\mu $$\n令数据由向量 $\\mathbf{y} = (y_{1},\\dots,y_{n})$ 表示。\n\n似然函数 $p(\\mathbf{y} \\mid \\mu, \\sigma^{2})$ 由 $n$ 个独立高斯密度的乘积给出，因为样本是来自 $\\mathcal{N}(\\mu, \\sigma^{2})$ 的独立同分布样本：\n$$ p(\\mathbf{y} \\mid \\mu, \\sigma^{2}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}} \\exp\\left(-\\frac{(y_{i} - \\mu)^{2}}{2\\sigma^{2}}\\right) = (2\\pi\\sigma^{2})^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{n} (y_{i} - \\mu)^{2}\\right) $$\n指数中的平方和可以使用样本均值 $\\bar{y} = \\frac{1}{n}\\sum_{i=1}^{n} y_{i}$ 和样本内平方和 $R = \\sum_{i=1}^{n} (y_{i}-\\bar{y})^{2}$ 进行分解：\n$$ \\sum_{i=1}^{n} (y_{i} - \\mu)^{2} = \\sum_{i=1}^{n} ((y_{i} - \\bar{y}) + (\\bar{y} - \\mu))^{2} = \\sum_{i=1}^{n} (y_{i} - \\bar{y})^{2} + n(\\bar{y} - \\mu)^{2} = R + n(\\bar{y} - \\mu)^{2} $$\n将其代回似然函数可得：\n$$ p(\\mathbf{y} \\mid \\mu, \\sigma^{2}) = (2\\pi\\sigma^{2})^{-n/2} \\exp\\left(-\\frac{R}{2\\sigma^{2}}\\right) \\exp\\left(-\\frac{n(\\mu - \\bar{y})^{2}}{2\\sigma^{2}}\\right) $$\n模型 $\\mathcal{M}_{j}$ 中 $\\mu$ 的先验为 $p(\\mu \\mid \\mathcal{M}_{j}) \\sim \\mathcal{N}(m_{0}, \\tau_{j}^{2})$：\n$$ p(\\mu \\mid \\mathcal{M}_{j}) = \\frac{1}{\\sqrt{2\\pi\\tau_{j}^{2}}} \\exp\\left(-\\frac{(\\mu - m_{0})^{2}}{2\\tau_{j}^{2}}\\right) $$\n现在，我们可以写出边际似然的积分。我们可以将不依赖于 $\\mu$ 的项提取出来：\n$$ p(\\mathbf{y} \\mid \\mathcal{M}_{j}) = (2\\pi\\sigma^{2})^{-n/2} (2\\pi\\tau_{j}^{2})^{-1/2} \\exp\\left(-\\frac{R}{2\\sigma^{2}}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{n(\\mu - \\bar{y})^{2}}{2\\sigma^{2}} - \\frac{(\\mu - m_{0})^{2}}{2\\tau_{j}^{2}}\\right) d\\mu $$\n为求解此积分，我们对指数中的 $\\mu$ 进行配方。令指数的参数为 $-\\frac{1}{2}Q(\\mu)$：\n$$ Q(\\mu) = \\frac{n(\\mu - \\bar{y})^{2}}{\\sigma^{2}} + \\frac{(\\mu - m_{0})^{2}}{\\tau_{j}^{2}} $$\n展开平方项：\n$$ Q(\\mu) = \\mu^{2}\\left(\\frac{n}{\\sigma^{2}} + \\frac{1}{\\tau_{j}^{2}}\\right) - 2\\mu\\left(\\frac{n\\bar{y}}{\\sigma^{2}} + \\frac{m_{0}}{\\tau_{j}^{2}}\\right) + \\left(\\frac{n\\bar{y}^{2}}{\\sigma^{2}} + \\frac{m_{0}^{2}}{\\tau_{j}^{2}}\\right) $$\n这是一个关于 $\\mu$ 的二次式，形式为 $A\\mu^{2} - 2B\\mu + C$。我们可以写成 $A(\\mu - B/A)^{2} - B^{2}/A + C$。\n$\\mu$ 的后验精度为 $A = \\frac{1}{\\tau_{jn}^{2}} = \\frac{n}{\\sigma^{2}} + \\frac{1}{\\tau_{j}^{2}} = \\frac{n\\tau_{j}^{2} + \\sigma^{2}}{\\sigma^{2}\\tau_{j}^{2}}$。\n后验均值为 $m_{jn} = B/A = \\left(\\frac{n\\bar{y}}{\\sigma^{2}} + \\frac{m_{0}}{\\tau_{j}^{2}}\\right) \\tau_{jn}^{2} = \\frac{n\\tau_{j}^{2}\\bar{y} + \\sigma^{2}m_{0}}{n\\tau_{j}^{2} + \\sigma^{2}}$。\n该积分是高斯核的形式：\n$$ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(\\mu - m_{jn})^{2}}{2\\tau_{jn}^{2}}\\right) \\exp\\left(-\\frac{1}{2}(C - B^{2}/A)\\right) d\\mu $$\n项 $C - B^{2}/A$ 简化为 $\\frac{n(\\bar{y}-m_{0})^{2}}{n\\tau_{j}^{2} + \\sigma^{2}}$。\n该积分的计算结果为 $\\sqrt{2\\pi\\tau_{jn}^{2}}$。\n所以完整的积分是：\n$$ I = \\sqrt{2\\pi\\tau_{jn}^{2}} \\exp\\left(-\\frac{n(\\bar{y}-m_{0})^{2}}{2(n\\tau_{j}^{2} + \\sigma^{2})}\\right) = \\sqrt{2\\pi \\frac{\\sigma^{2}\\tau_{j}^{2}}{n\\tau_{j}^{2} + \\sigma^{2}}} \\exp\\left(-\\frac{n(\\bar{y}-m_{0})^{2}}{2(n\\tau_{j}^{2} + \\sigma^{2})}\\right) $$\n将其代回 $p(\\mathbf{y} \\mid \\mathcal{M}_{j})$ 的表达式中：\n$$ p(\\mathbf{y} \\mid \\mathcal{M}_{j}) = (2\\pi\\sigma^{2})^{-n/2} (2\\pi\\tau_{j}^{2})^{-1/2} \\exp\\left(-\\frac{R}{2\\sigma^{2}}\\right) \\sqrt{2\\pi \\frac{\\sigma^{2}\\tau_{j}^{2}}{n\\tau_{j}^{2} + \\sigma^{2}}} \\exp\\left(-\\frac{n(\\bar{y}-m_{0})^{2}}{2(n\\tau_{j}^{2} + \\sigma^{2})}\\right) $$\n简化常数前置因子：\n$$ (2\\pi)^{-n/2}(\\sigma^{2})^{-n/2}(2\\pi)^{-1/2}(\\tau_{j}^{2})^{-1/2}(2\\pi)^{1/2}\\frac{\\sigma\\tau_{j}}{\\sqrt{n\\tau_{j}^{2} + \\sigma^{2}}} = (2\\pi)^{-n/2}(\\sigma^{2})^{-(n-1)/2}(n\\tau_{j}^{2} + \\sigma^{2})^{-1/2} $$\n因此，边际似然的最终表达式为：\n$$ p(\\mathbf{y} \\mid \\mathcal{M}_{j}) = (2\\pi)^{-n/2} (\\sigma^{2})^{-(n-1)/2} (n\\tau_{j}^{2} + \\sigma^{2})^{-1/2} \\exp\\left(-\\frac{R}{2\\sigma^{2}}\\right) \\exp\\left(-\\frac{n(\\bar{y}-m_{0})^{2}}{2(n\\tau_{j}^{2} + \\sigma^{2})}\\right) $$\n\n### 步骤2：贝叶斯因子 $BF_{12}$ 的计算\n\n贝叶斯因子 $BF_{12}$ 是模型 $\\mathcal{M}_{1}$ 和 $\\mathcal{M}_{2}$ 的边际似然之比：\n$$ BF_{12} = \\frac{p(\\mathbf{y} \\mid \\mathcal{M}_{1})}{p(\\mathbf{y} \\mid \\mathcal{M}_{2})} $$\n使用上面推导的表达式，我们构建这个比率。所有不依赖于模型索引 $j$ 的项都将抵消。这些项是 $(2\\pi)^{-n/2}$、$(\\sigma^{2})^{-(n-1)/2}$ 和 $\\exp\\left(-R/(2\\sigma^{2})\\right)$。\n$$ BF_{12} = \\frac{(n\\tau_{1}^{2} + \\sigma^{2})^{-1/2} \\exp\\left(-\\frac{n(\\bar{y}-m_{0})^{2}}{2(n\\tau_{1}^{2} + \\sigma^{2})}\\right)}{(n\\tau_{2}^{2} + \\sigma^{2})^{-1/2} \\exp\\left(-\\frac{n(\\bar{y}-m_{0})^{2}}{2(n\\tau_{2}^{2} + \\sigma^{2})}\\right)} $$\n这可以简化为：\n$$ BF_{12} = \\left(\\frac{n\\tau_{2}^{2} + \\sigma^{2}}{n\\tau_{1}^{2} + \\sigma^{2}}\\right)^{1/2} \\exp\\left( \\frac{n(\\bar{y}-m_{0})^{2}}{2} \\left[ \\frac{1}{n\\tau_{2}^{2} + \\sigma^{2}} - \\frac{1}{n\\tau_{1}^{2} + \\sigma^{2}} \\right] \\right) $$\n为指数括号中的项找到一个共同的分母：\n$$ \\frac{1}{n\\tau_{2}^{2} + \\sigma^{2}} - \\frac{1}{n\\tau_{1}^{2} + \\sigma^{2}} = \\frac{(n\\tau_{1}^{2} + \\sigma^{2}) - (n\\tau_{2}^{2} + \\sigma^{2})}{(n\\tau_{1}^{2} + \\sigma^{2})(n\\tau_{2}^{2} + \\sigma^{2})} = \\frac{n(\\tau_{1}^{2} - \\tau_{2}^{2})}{(n\\tau_{1}^{2} + \\sigma^{2})(n\\tau_{2}^{2} + \\sigma^{2})} $$\n将其代回，得到贝叶斯因子的最终简化表达式：\n$$ BF_{12} = \\left(\\frac{n\\tau_{2}^{2} + \\sigma^{2}}{n\\tau_{1}^{2} + \\sigma^{2}}\\right)^{1/2} \\exp\\left( \\frac{n^{2}(\\bar{y}-m_{0})^{2}(\\tau_{1}^{2} - \\tau_{2}^{2})}{2(n\\tau_{1}^{2} + \\sigma^{2})(n\\tau_{2}^{2} + \\sigma^{2})} \\right) $$\n\n### 步骤3：敏感性分析\n\n为分析 $BF_{12}$ 如何随先验方差变化，我们考察其自然对数 $\\ln(BF_{12})$ 的偏导数。\n$$ \\ln(BF_{12}) = \\frac{1}{2}\\ln(n\\tau_{2}^{2}+\\sigma^{2}) - \\frac{1}{2}\\ln(n\\tau_{1}^{2}+\\sigma^{2}) + \\frac{n(\\bar{y}-m_{0})^{2}}{2}\\left(\\frac{1}{n\\tau_{2}^{2}+\\sigma^{2}} - \\frac{1}{n\\tau_{1}^{2}+\\sigma^{2}}\\right) $$\n关于 $\\tau_{1}^{2}$ 的偏导数是：\n$$ \\frac{\\partial \\ln(BF_{12})}{\\partial \\tau_{1}^{2}} = -\\frac{n}{2(n\\tau_{1}^{2}+\\sigma^{2})} + \\frac{n(\\bar{y}-m_{0})^{2}}{2} \\left(\\frac{n}{(n\\tau_{1}^{2}+\\sigma^{2})^{2}}\\right) = \\frac{n}{2(n\\tau_{1}^{2}+\\sigma^{2})^{2}} \\left[ n(\\bar{y}-m_{0})^{2} - (n\\tau_{1}^{2}+\\sigma^{2}) \\right] $$\n该导数的符号由方括号中的项决定。$\\frac{\\partial \\ln(BF_{12})}{\\partial \\tau_{1}^{2}}  0$ 当且仅当 $n(\\bar{y}-m_{0})^{2}  n\\tau_{1}^{2}+\\sigma^{2}$，即 $(\\bar{y}-m_{0})^{2}  \\tau_{1}^{2} + \\frac{\\sigma^{2}}{n}$。这意味着当数据与先验的差异的平方 $|\\bar{y}-m_{0}|^{2}$ 大于 $\\mathcal{M}_{1}$ 下 $\\bar{y}$ 的预测方差时，增加先验方差 $\\tau_{1}^{2}$ 会增加支持 $\\mathcal{M}_{1}$ 的证据。\n\n关于 $\\tau_{2}^{2}$ 的偏导数是：\n$$ \\frac{\\partial \\ln(BF_{12})}{\\partial \\tau_{2}^{2}} = \\frac{n}{2(n\\tau_{2}^{2}+\\sigma^{2})} - \\frac{n(\\bar{y}-m_{0})^{2}}{2} \\left(\\frac{n}{(n\\tau_{2}^{2}+\\sigma^{2})^{2}}\\right) = \\frac{n}{2(n\\tau_{2}^{2}+\\sigma^{2})^{2}} \\left[ (n\\tau_{2}^{2}+\\sigma^{2}) - n(\\bar{y}-m_{0})^{2} \\right] $$\n该导数为正当且仅当 $n\\tau_{2}^{2}+\\sigma^{2}  n(\\bar{y}-m_{0})^{2}$，即 $\\tau_{2}^{2} + \\frac{\\sigma^{2}}{n}  (\\bar{y}-m_{0})^{2}$。这意味着当 $\\mathcal{M}_{2}$ 下 $\\bar{y}$ 的预测方差大于数据与先验差异的平方时，增加先验方差 $\\tau_{2}^{2}$ 会增加支持 $\\mathcal{M}_{1}$ 的证据（通过减少支持 $\\mathcal{M}_{2}$ 的证据）。\n\n**参数的作用：** 贝叶斯因子对先验方差的敏感性由项 $\\tau_{j}^{2} + \\sigma^{2}/n$（即模型 $\\mathcal{M}_{j}$ 下 $\\bar{y}$ 的预测方差）调节。\n- **$|\\bar{y}-m_{0}|$**：数据与先验均值之间的较大差异有利于具有更**大**先验方差的模型，因为这些模型会为更极端的观测值分配更高的似然。\n- **$n$**：随着样本量 $n$ 的增加，项 $\\sigma^{2}/n$ 减小。数据变得更具信息量，预测方差趋近于先验方差 $\\tau_{j}^{2}$。贝叶斯因子对 $\\tau_{j}^{2}$ 的选择变得更加敏感。\n- **$\\sigma^{2}$**：较大的数据方差 $\\sigma^{2}$ 会增加两个模型的预测方差，使它们更难区分，并降低贝叶斯因子对 $\\tau_{j}^{2}$ 具体选择的敏感性。",
            "answer": "$$ \\boxed{ \\left(\\frac{n\\tau_{2}^{2} + \\sigma^{2}}{n\\tau_{1}^{2} + \\sigma^{2}}\\right)^{1/2} \\exp\\left( \\frac{n^{2}(\\bar{y}-m_{0})^{2}(\\tau_{1}^{2} - \\tau_{2}^{2})}{2(n\\tau_{1}^{2} + \\sigma^{2})(n\\tau_{2}^{2} + \\sigma^{2})} \\right) } $$"
        },
        {
            "introduction": "在现实世界中，大多数贝叶斯模型的边缘似然 $Z$ 无法解析求解，这使得我们必须依赖数值方法。重要性抽样（Importance Sampling）是估计边缘似然最基础的蒙特卡洛技术之一。本练习不仅关注如何应用该估计量 $\\widehat{Z}_{n}$，更深入地通过推导其对数形式 $\\ell_{n} = \\ln(\\widehat{Z}_{n})$ 的方差来分析其统计性质，为在实践中可靠地应用该方法提供了关键的指导。",
            "id": "3319185",
            "problem": "考虑一个贝叶斯模型，其观测数据为 $y$，潜变量为 $x$，先验密度为 $p(x)$，似然为 $p(y \\mid x)$。边缘似然是归一化常数\n$$\nZ \\equiv \\int p(y \\mid x)\\,p(x)\\,dx.\n$$\n令 $q(x)$ 为一个提议密度，其支撑集覆盖 $p(y \\mid x)\\,p(x)$ 的支撑集。从 $q$ 中独立同分布地抽取样本 $X_{1},\\dots,X_{n} \\stackrel{\\text{i.i.d.}}{\\sim} q$，并定义重要性采样 (IS) 权重 $w(X_{i}) \\equiv \\frac{p(y \\mid X_{i})\\,p(X_{i})}{q(X_{i})}$ 和 $Z$ 的 IS 估计量\n$$\n\\widehat{Z}_{n} \\equiv \\frac{1}{n}\\sum_{i=1}^{n} w(X_{i}).\n$$\n假设 $Z \\in (0,\\infty)$，二阶矩 $m_{2} \\equiv \\mathbb{E}_{q}\\!\\left[w(X)^{2}\\right]$ 是有限的，并且方差 $\\sigma^{2} \\equiv \\mathrm{Var}_{q}\\!\\left(w(X)\\right)= m_{2} - Z^{2}$ 是正且有限的。考虑对数-IS 估计量 $\\ell_{n} \\equiv \\ln\\!\\left(\\widehat{Z}_{n}\\right)$。\n\n仅使用诸如大数定律、中心极限定理和一阶Delta方法等基础性结果，推导 $\\ell_{n}$ 的大样本方差，其闭式形式需表示为关于 $n$、$Z$ 和 $m_{2}$ 的表达式。清晰地陈述您在推导过程中所引用的正则性条件。\n\n然后，基于您的推导，并且不依赖未经证实的启发式方法，给出一个有原则的建议，说明何时在对数尺度上汇总独立运行的估计值（即，对 $\\ell_{n}$ 求平均后取指数）优于在线性尺度上汇总（即，对 $\\widehat{Z}_{n}$ 求平均）。\n\n您的最终答案必须是 $\\ell_{n}$ 的渐近方差的单个闭式表达式，用 $n$、$Z$ 和 $m_{2}$ 表示。无需进行四舍五入。",
            "solution": "目标是推导对数-IS 估计量 $\\ell_{n} = \\ln(\\widehat{Z}_{n})$ 的大样本方差。\nIS 估计量 $\\widehat{Z}_{n} = \\frac{1}{n}\\sum_{i=1}^{n} w(X_{i})$ 是 $n$ 个独立同分布 (i.i.d.) 的随机变量 $w(X_i)$ 的样本均值。这些变量的分布是通过抽取 $X_i \\sim q(x)$ 得到的。\n\n首先，我们确定随机变量 $w(X)$ 的性质。其在提议分布 $q(x)$下的期望是：\n$$\n\\mathbb{E}_{q}[w(X)] = \\int w(x) q(x) dx = \\int \\frac{p(y \\mid x) p(x)}{q(x)} q(x) dx = \\int p(y \\mid x) p(x) dx = Z.\n$$\n这表明 IS 估计量 $\\widehat{Z}_n$ 是 $Z$ 的一个无偏估计量，因为 $\\mathbb{E}_{q}[\\widehat{Z}_n] = \\frac{1}{n}\\sum_{i=1}^{n}\\mathbb{E}_{q}[w(X_i)] = Z$。\n\n$w(X)$ 的方差在问题陈述中给出为 $\\sigma^2 = \\mathrm{Var}_{q}(w(X))$，其中 $\\sigma^2 = m_2 - Z^2$。由于权重 $w(X_i)$ 是独立同分布的，IS 估计量的方差为：\n$$\n\\mathrm{Var}_{q}(\\widehat{Z}_{n}) = \\mathrm{Var}_{q}\\left(\\frac{1}{n}\\sum_{i=1}^{n} w(X_i)\\right) = \\frac{1}{n^2} \\sum_{i=1}^n \\mathrm{Var}_q(w(X_i)) = \\frac{n \\sigma^2}{n^2} = \\frac{\\sigma^2}{n} = \\frac{m_{2} - Z^{2}}{n}.\n$$\n问题陈述指出 $Z$ 是有限的，$\\sigma^2$ 也是有限的，这些是中心极限定理 (CLT) 适用于样本均值 $\\widehat{Z}_n$ 的充分条件。中心极限定理指出：\n$$\n\\sqrt{n}(\\widehat{Z}_n - Z) \\xrightarrow{d} \\mathcal{N}(0, \\sigma^2),\n$$\n其中 $\\xrightarrow{d}$ 表示依分布收敛，$\\mathcal{N}(0, \\sigma^2)$ 是一个均值为 $0$、方差为 $\\sigma^2 = m_2 - Z^2$ 的正态分布。\n\n我们关心的是 $\\ell_n = \\ln(\\widehat{Z}_n)$ 的渐近分布。这可以使用一阶Delta方法求得。令 $g(z) = \\ln(z)$。Delta方法指出，对于一个随机变量序列 $T_n$，满足 $\\sqrt{n}(T_n - \\theta) \\xrightarrow{d} \\mathcal{N}(0, \\tau^2)$，并且对于一个在 $\\theta$ 处可微且 $g'(\\theta) \\neq 0$ 的函数 $g$，以下结论成立：\n$$\n\\sqrt{n}(g(T_n) - g(\\theta)) \\xrightarrow{d} \\mathcal{N}(0, [g'(\\theta)]^2 \\tau^2).\n$$\n在我们的情况下，$T_n = \\widehat{Z}_n$，$\\theta = Z$，且 $\\tau^2 = \\sigma^2 = m_2 - Z^2$。函数是 $g(z) = \\ln(z)$，其导数为 $g'(z) = 1/z$。\nDelta方法的正则性条件得到满足：\n1.  问题陈述指出 $Z \\in (0, \\infty)$，因此 $g(z) = \\ln(z)$ 在 $z=Z$ 处是良定义的且连续可微。\n2.  在 $Z$ 处的导数是 $g'(Z) = 1/Z$，由于 $Z \\neq 0$，该导数非零。\n\n应用Delta方法：\n$$\n\\sqrt{n}(\\ln(\\widehat{Z}_n) - \\ln(Z)) \\xrightarrow{d} \\mathcal{N}\\left(0, [g'(Z)]^2 \\sigma^2\\right).\n$$\n代入 $g'(Z)$ 和 $\\sigma^2$ 的表达式：\n$$\n\\sqrt{n}(\\ell_n - \\ln(Z)) \\xrightarrow{d} \\mathcal{N}\\left(0, \\left(\\frac{1}{Z}\\right)^2 (m_2 - Z^2)\\right).\n$$\n$\\sqrt{n}(\\ell_n - \\ln(Z))$ 的渐近方差是 $\\frac{m_2 - Z^2}{Z^2}$。这意味着对于大的 $n$，$\\ell_n$ 的分布可以用一个正态分布来近似：\n$$\n\\ell_n \\approx \\mathcal{N}\\left(\\ln(Z), \\frac{1}{n}\\frac{m_2 - Z^2}{Z^2}\\right).\n$$\n因此，$\\ell_n$ 的大样本方差为：\n$$\n\\mathrm{Var}(\\ell_n) \\approx \\frac{m_2 - Z^2}{nZ^2}.\n$$\n\n对于问题的第二部分，我们必须提供一个关于如何汇总估计值的建议。在线性尺度上汇总 $K$ 个独立的估计值意味着计算算术平均值 $\\frac{1}{K}\\sum_{k=1}^K \\widehat{Z}_{n,k}$。在对数尺度上汇总然后转换回去，意味着计算 $\\exp\\left(\\frac{1}{K}\\sum_{k=1}^K \\ell_{n,k}\\right) = \\left(\\prod_{k=1}^K \\widehat{Z}_{n,k}\\right)^{1/K}$，这是各个估计值的几何平均值。\n\n推导出的 $\\ell_n$ 的大样本方差可以重写为：\n$$\n\\mathrm{Var}(\\ell_n) \\approx \\frac{1}{n} \\left(\\frac{m_2}{Z^2} - 1\\right) = \\frac{1}{n} \\left(\\frac{\\mathbb{E}_q[w(X)^2]}{(\\mathbb{E}_q[w(X)])^2} - 1\\right) = \\frac{1}{n} \\frac{\\mathrm{Var}_q(w(X))}{(\\mathbb{E}_q[w(X)])^2} = \\frac{1}{n} [\\mathrm{CV}_q(w(X))]^2,\n$$\n其中 $\\mathrm{CV}_q(w(X))$ 是重要性权重的变异系数 (CV)。\n\n一个有原则的建议是基于估计量的性质。实践中的重要性采样通常以高度右偏的权重分布为特征，这意味着少数权重比其余权重大了几个数量级。当提议密度 $q(x)$ 在高概率区域与目标密度 $p(y|x)p(x)$ 匹配不佳时，就会发生这种情况。高度的偏度对应于大的变异系数。\n\n当权重的变异系数很大时，对于有限的 $n$，估计量 $\\widehat{Z}_n$ 的分布也是偏斜的，并且根据中心极限定理其向正态性的收敛速度很慢。这种估计值的算术平均值对因离群权重而导致的任何单个异常大的估计值都高度敏感。\n\n对数函数 $g(z)=\\ln(z)$ 是一个压缩大值的凹函数。对 $\\widehat{Z}_n$ 应用对数函数产生统计量 $\\ell_n$，其分布通常比 $\\widehat{Z}_n$ 的分布更对称、更接近正态，特别是当底层权重具有高方差时。对数尺度上的中心极限定理（由Delta方法建立）对于有限的 $n$ 来说，通常比原始尺度上的中心极限定理提供更好的近似。\n\n在对数尺度上求平均（即，对 $\\ell_n$ 求平均）更稳健，因为这是在对性质更好、分布更接近对称的量求平均。这对应于取几何平均值，众所周知，几何平均值比算术平均值对极端离群值更不敏感。\n\n因此，建议如下：当重要性权重的方差相对于其均值较大时，优先选择在对数尺度上进行汇总。这种情况可以通过一个较大的变异系数平方值 $\\frac{m_2 - Z^2}{Z^2}$ 来量化，而这个项（按 $1/n$ 缩放后）正是我们上面推导出的决定对数估计量 $\\ell_n$ 方差的项。在这种高方差的情况下，对数变换提供了稳定化和对称化的效应，从而得到更稳健和可靠的汇总估计值。",
            "answer": "$$\n\\boxed{\\frac{m_2 - Z^2}{n Z^2}}\n$$"
        },
        {
            "introduction": "对于更复杂的问题，我们需要更精密的工具，如热力学积分（Thermodynamic Integration）或更广义的路径抽样（Path Sampling）。这些方法的关键挑战之一在于如何选择积分路径 $\\phi(t)$。本高级练习直面这一问题，通过推导一个能使估计量方差在整个路径上保持恒定的最优积分方案，展示了如何设计高效且量身定制的蒙特卡洛估计器，从而显著提升估计效率。",
            "id": "3319187",
            "problem": "考虑一个贝叶斯模型，其数据 $y = (y_{1}, \\dots, y_{n})$ 假定在给定参数 $\\theta \\in \\mathbb{R}$ 的条件下是条件独立同分布的，似然为 $p(y \\mid \\theta)$，先验为 $p(\\theta)$。定义一个由 $t \\in [0,1]$ 索引的未归一化密度族 $q_{t}(\\theta) = p(\\theta)\\, p(y \\mid \\theta)^{\\phi(t)}$，其中 $\\phi : [0,1] \\to [0,1]$ 是一个连续可微的调度函数，满足边界条件 $\\phi(0) = 0$ 和 $\\phi(1) = 1$。令 $Z(t) = \\int q_{t}(\\theta)\\, d\\theta$ 且 $p_{t}(\\theta) = q_{t}(\\theta)/Z(t)$ 表示归一化分布。边际似然（也称为证据）为 $p(y) = Z(1)$。\n\n任务：\n- 从 $Z(t)$ 和 $p_{t}(\\theta)$ 的定义出发，推导一个恒等式，将 $\\ln p(y)$ 表示为一个在 $p_{t}(\\theta)$ 下的期望的积分，该积分依赖于 $\\phi'(t)$ 和 $\\ln p(y \\mid \\theta)$。\n- 假设我们在每个 $t$ 处通过从 $p_{t}(\\theta)$ 中进行蒙特卡洛采样（例如，通过马尔可夫链蒙特卡洛（MCMC））来估计此积分，并且我们希望选择 $\\phi$，使得被积函数的逐点蒙特卡洛方差在 $t$ 上是恒定的。通过施加 $(\\phi'(t))^{2}\\, \\mathrm{Var}_{p_{t}}[\\ln p(y \\mid \\theta)]$ 在 $t$ 上为常数的条件来将其形式化，并写出 $\\phi$ 的相应常微分方程。\n- 现在将问题特化到共轭正态模型，其观测方差已知：对于 $i \\in \\{1,\\dots,n\\}$，假设 $y_{i} \\mid \\theta \\sim \\mathcal{N}(\\theta, \\sigma^{2})$，其中 $\\sigma^{2}  0$ 已知；先验为 $\\theta \\sim \\mathcal{N}(\\mu_{0}, \\tau_{0}^{2})$，其中 $\\tau_{0}^{2}  0$ 已知。令 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_{i}$ 并假设 $\\mu_{0} = \\bar{y}$。在幂后验 $p_{\\beta}(\\theta) \\propto p(\\theta)\\, p(y \\mid \\theta)^{\\beta}$（其中 $\\beta \\in [0,1]$）下，计算 $\\mathrm{Var}_{p_{\\beta}}[\\ln p(y \\mid \\theta)]$ 作为 $\\beta$、$n$、$\\sigma^{2}$ 和 $\\tau_{0}^{2}$ 的函数。\n- 使用该方差表达式和恒定方差条件，以闭式解的形式求解所得的关于 $\\phi(t)$ 的微分方程，并满足 $\\phi(0) = 0$ 和 $\\phi(1) = 1$。\n\n你的最终答案必须是 $\\phi(t)$ 的一个单一显式闭式表达式，用 $t$、$n$、$\\sigma^{2}$ 和 $\\tau_{0}^{2}$ 表示，不含未定义常数。不包含任何单位。无需进行数值计算。",
            "solution": "### 第1部分：热力学积分恒等式的推导\n\n边际似然由 $p(y) = Z(1)$ 给出，其中 $Z(t) = \\int q_{t}(\\theta)\\, d\\theta = \\int p(\\theta)\\, p(y \\mid \\theta)^{\\phi(t)}\\, d\\theta$。调度函数 $\\phi(t)$ 满足 $\\phi(0) = 0$ 和 $\\phi(1) = 1$。\n\n在 $t=0$ 时，我们有 $\\phi(0)=0$，所以 $q_{0}(\\theta) = p(\\theta) p(y \\mid \\theta)^{0} = p(\\theta)$。归一化常数为 $Z(0) = \\int p(\\theta) \\, d\\theta = 1$，因为 $p(\\theta)$ 是一个有效的概率密度。\n\n我们可以使用微积分基本定理来表示 $\\ln p(y)$：\n$$ \\ln p(y) = \\ln Z(1) = \\ln Z(1) - \\ln Z(0) = \\int_{0}^{1} \\frac{d}{dt} \\ln Z(t) \\, dt $$\n$\\ln Z(t)$ 关于 $t$ 的导数是：\n$$ \\frac{d}{dt} \\ln Z(t) = \\frac{1}{Z(t)} \\frac{dZ(t)}{dt} $$\n我们通过在积分号下求导（莱布尼茨积分法则）来计算 $Z(t)$ 的导数，这是允许的，因为 $\\phi(t)$ 是连续可微的：\n$$ \\frac{dZ(t)}{dt} = \\frac{d}{dt} \\int p(\\theta)\\, p(y \\mid \\theta)^{\\phi(t)}\\, d\\theta = \\int p(\\theta)\\, \\frac{\\partial}{\\partial t} \\exp\\left( \\phi(t) \\ln p(y \\mid \\theta) \\right) \\, d\\theta $$\n$$ = \\int p(\\theta)\\, \\exp\\left( \\phi(t) \\ln p(y \\mid \\theta) \\right) \\cdot \\left( \\phi'(t) \\ln p(y \\mid \\theta) \\right) \\, d\\theta $$\n$$ = \\phi'(t) \\int p(\\theta)\\, p(y \\mid \\theta)^{\\phi(t)} \\ln p(y \\mid \\theta) \\, d\\theta = \\phi'(t) \\int q_{t}(\\theta) \\ln p(y \\mid \\theta) \\, d\\theta $$\n将此代回 $\\frac{d}{dt} \\ln Z(t)$ 的表达式中：\n$$ \\frac{d}{dt} \\ln Z(t) = \\frac{1}{Z(t)} \\phi'(t) \\int q_{t}(\\theta) \\ln p(y \\mid \\theta) \\, d\\theta = \\phi'(t) \\int \\frac{q_{t}(\\theta)}{Z(t)} \\ln p(y \\mid \\theta) \\, d\\theta $$\n根据定义，$p_{t}(\\theta) = q_{t}(\\theta)/Z(t)$，所以该积分是 $\\ln p(y \\mid \\theta)$ 关于 $p_{t}(\\theta)$ 的期望：\n$$ \\frac{d}{dt} \\ln Z(t) = \\phi'(t) \\, \\mathbb{E}_{p_{t}}[\\ln p(y \\mid \\theta)] $$\n最后，将此式从 $t=0$ 积分到 $t=1$，得到所需的恒等式，即热力学积分或路径采样恒等式：\n$$ \\ln p(y) = \\int_{0}^{1} \\phi'(t) \\, \\mathbb{E}_{p_{t}}[\\ln p(y \\mid \\theta)] \\, dt $$\n\n### 第2部分：恒定方差常微分方程\n\n上面推导的恒等式的被积函数是 $t$ 的一个函数，其在每个 $t$ 处的值通过蒙特卡洛方法估计。在固定的 $t$ 处被估计的量是 $\\phi'(t) \\mathbb{E}_{p_{t}}[\\ln p(y \\mid \\theta)]$。蒙特卡洛估计基于样本 $\\theta_i \\sim p_t(\\theta)$，通过计算 $\\phi'(t) \\ln p(y \\mid \\theta_i)$ 的平均值得到。被积函数 $\\phi'(t) \\ln p(y \\mid \\theta)$ 的单个样本在分布 $p_t(\\theta)$ 下的方差是：\n$$ \\mathrm{Var}_{p_{t}} [ \\phi'(t) \\ln p(y \\mid \\theta) ] = (\\phi'(t))^{2} \\mathrm{Var}_{p_{t}} [ \\ln p(y \\mid \\theta) ] $$\n问题要求这个逐点方差关于 $t$ 是恒定的。设这个常数为 $C$。\n$$ (\\phi'(t))^{2} \\mathrm{Var}_{p_{t}} [ \\ln p(y \\mid \\theta) ] = C $$\n这就是关于 $\\phi(t)$ 的常微分方程（ODE）。注意，方差项通过分布 $p_t(\\theta)$ 依赖于 $t$，而 $p_t(\\theta)$ 又依赖于 $\\phi(t)$。我们记 $V(\\beta) = \\mathrm{Var}_{p_{\\beta}}[\\ln p(y \\mid \\theta)]$，其中 $p_{\\beta}(\\theta) \\propto p(\\theta) p(y \\mid \\theta)^{\\beta}$。那么对于 $p_t(\\theta)$，我们有 $\\beta=\\phi(t)$，所以ODE为：\n$$ (\\phi'(t))^{2} V(\\phi(t)) = C $$\n\n### 第3部分：共轭正态模型的方差计算\n\n给定 $y_{i} \\mid \\theta \\sim \\mathcal{N}(\\theta, \\sigma^{2})$（$i=1,\\dots,n$）和 $\\theta \\sim \\mathcal{N}(\\mu_{0}, \\tau_{0}^{2})$。对数似然为：\n$$ \\ln p(y \\mid \\theta) = \\sum_{i=1}^{n} \\ln p(y_i \\mid \\theta) = \\sum_{i=1}^{n} \\left( -\\frac{1}{2} \\ln(2\\pi\\sigma^{2}) - \\frac{(y_i - \\theta)^{2}}{2\\sigma^{2}} \\right) $$\n$$ = -\\frac{n}{2} \\ln(2\\pi\\sigma^{2}) - \\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{n} (y_i^{2} - 2y_i\\theta + \\theta^{2}) $$\n$$ = -\\frac{n}{2\\sigma^{2}}\\theta^{2} + \\frac{n\\bar{y}}{\\sigma^{2}}\\theta - \\left( \\frac{n}{2} \\ln(2\\pi\\sigma^{2}) + \\frac{1}{2\\sigma^{2}}\\sum y_i^2 \\right) $$\n其中 $\\bar{y} = \\frac{1}{n} \\sum y_i$。这是一个关于 $\\theta$ 的二次函数，我们写作 $U(\\theta) = A\\theta^{2} + B\\theta + D$，其中 $A = -\\frac{n}{2\\sigma^{2}}$，$B = \\frac{n\\bar{y}}{\\sigma^{2}}$，$D$ 是常数项。注意 $B = -2A\\bar{y}$。\n\n接下来，我们刻画分布 $p_{\\beta}(\\theta) \\propto p(\\theta) p(y \\mid \\theta)^{\\beta}$。这是一个正态-正态模型的后验分布。\n$$ p_{\\beta}(\\theta) \\propto \\exp\\left(-\\frac{(\\theta-\\mu_{0})^{2}}{2\\tau_{0}^{2}}\\right) \\exp\\left(\\beta \\ln p(y \\mid \\theta)\\right) $$\n指数部分是 $\\theta$ 的一个二次式。其 $\\theta^2$ 的系数是 $-\\frac{1}{2}\\left(\\frac{1}{\\tau_0^2} + \\frac{\\beta n}{\\sigma^2}\\right)$，其 $\\theta$ 的系数是 $\\left(\\frac{\\mu_0}{\\tau_0^2} + \\frac{\\beta n \\bar{y}}{\\sigma^2}\\right)$。因此，$p_{\\beta}(\\theta)$ 是一个正态分布，$\\theta \\sim \\mathcal{N}(\\mu_{\\beta}, \\tau_{\\beta}^{2})$，其中精度为 $\\frac{1}{\\tau_{\\beta}^{2}} = \\frac{1}{\\tau_{0}^{2}} + \\frac{\\beta n}{\\sigma^{2}}$，所以方差是：\n$$ \\tau_{\\beta}^{2} = \\left(\\frac{1}{\\tau_{0}^{2}} + \\frac{\\beta n}{\\sigma^{2}}\\right)^{-1} = \\frac{\\sigma^{2}\\tau_{0}^{2}}{\\sigma^{2} + \\beta n \\tau_{0}^{2}} $$\n均值 $\\mu_{\\beta}$ 由 $\\mu_{\\beta} = \\tau_{\\beta}^{2} \\left(\\frac{\\mu_0}{\\tau_0^2} + \\frac{\\beta n \\bar{y}}{\\sigma^2}\\right)$ 给出。使用关键假设 $\\mu_{0}=\\bar{y}$：\n$$ \\mu_{\\beta} = \\tau_{\\beta}^{2} \\left(\\frac{\\bar{y}}{\\tau_0^2} + \\frac{\\beta n \\bar{y}}{\\sigma^2}\\right) = \\tau_{\\beta}^{2} \\bar{y} \\left(\\frac{1}{\\tau_0^2} + \\frac{\\beta n}{\\sigma^2}\\right) = \\tau_{\\beta}^{2} \\bar{y} \\frac{1}{\\tau_{\\beta}^{2}} = \\bar{y} $$\n对于所有 $\\beta \\in [0,1]$，均值为 $\\mu_{\\beta} = \\bar{y}$。\n\n现在我们计算 $V(\\beta) = \\mathrm{Var}_{p_{\\beta}}[\\ln p(y \\mid \\theta)] = \\mathrm{Var}_{p_{\\beta}}[A\\theta^{2} + B\\theta + D] = \\mathrm{Var}_{p_{\\beta}}[A\\theta^{2} + B\\theta]$。\n对于一个随机变量 $X \\sim \\mathcal{N}(\\mu, \\tau^{2})$ 和一个二次函数 $f(X) = aX^2+bX+c$，其方差为 $\\mathrm{Var}[f(X)] = \\mathrm{Var}[aX^2+bX] = 2a^2\\tau^4 + (2a\\mu+b)^2\\tau^2$。\n在我们的情况中，$\\theta \\sim \\mathcal{N}(\\mu_{\\beta}, \\tau_{\\beta}^{2})$，$a=A$，$b=B$，$\\mu = \\mu_\\beta = \\bar{y}$，以及 $\\tau^2 = \\tau_\\beta^2$。我们来计算 $2A\\mu_{\\beta}+B$ 项：\n$$ 2A\\mu_{\\beta}+B = 2 \\left(-\\frac{n}{2\\sigma^{2}}\\right) \\bar{y} + \\frac{n\\bar{y}}{\\sigma^{2}} = -\\frac{n\\bar{y}}{\\sigma^{2}} + \\frac{n\\bar{y}}{\\sigma^{2}} = 0 $$\n方差计算被大大简化：\n$$ V(\\beta) = 2A^{2}(\\tau_{\\beta}^{2})^{2} $$\n代入 $A$ 和 $\\tau_{\\beta}^{2}$ 的表达式：\n$$ V(\\beta) = 2 \\left(-\\frac{n}{2\\sigma^{2}}\\right)^{2} \\left(\\frac{\\sigma^{2}\\tau_{0}^{2}}{\\sigma^{2} + \\beta n \\tau_{0}^{2}}\\right)^{2} = 2 \\frac{n^{2}}{4\\sigma^{4}} \\frac{\\sigma^{4}\\tau_{0}^{4}}{(\\sigma^{2} + \\beta n \\tau_{0}^{2})^{2}} $$\n$$ V(\\beta) = \\frac{n^{2}\\tau_{0}^{4}}{2(\\sigma^{2} + \\beta n \\tau_{0}^{2})^{2}} $$\n\n### 第4部分：求解微分方程\n\n我们将方差表达式代入第2部分的ODE中，并令 $\\beta = \\phi(t)$：\n$$ (\\phi'(t))^{2} \\frac{n^{2}\\tau_{0}^{4}}{2(\\sigma^{2} + \\phi(t) n \\tau_{0}^{2})^{2}} = C $$\n两边开方（我们假设 $\\phi'(t) \\ge 0$，因为 $\\phi$ 从0增加到1）：\n$$ \\phi'(t) \\frac{n\\tau_{0}^{2}}{\\sqrt{2}(\\sigma^{2} + \\phi(t) n \\tau_{0}^{2})} = \\sqrt{C} $$\n这是一个可分离的ODE。令 $\\phi'(t) = d\\phi/dt$。我们可以将其写作：\n$$ \\frac{d\\phi}{\\sigma^{2} + \\phi n \\tau_{0}^{2}} = K \\, dt $$\n其中 $K = \\frac{\\sqrt{2C}}{n\\tau_{0}^{2}}$ 是一个常数。我们对两边进行积分。使用定积分是最直接的方法。我们从 $t'=0$ 积分到 $t$，此时函数值从 $\\phi(0)=0$ 变化到 $\\phi(t)$：\n$$ \\int_{0}^{\\phi(t)} \\frac{d\\beta}{\\sigma^{2} + \\beta n \\tau_{0}^{2}} = \\int_{0}^{t} K \\, dt' $$\n$$ \\left[ \\frac{1}{n\\tau_{0}^{2}} \\ln(\\sigma^{2} + \\beta n \\tau_{0}^{2}) \\right]_{0}^{\\phi(t)} = K t $$\n$$ \\frac{1}{n\\tau_{0}^{2}} \\left( \\ln(\\sigma^{2} + \\phi(t) n \\tau_{0}^{2}) - \\ln(\\sigma^{2}) \\right) = K t $$\n$$ \\frac{1}{n\\tau_{0}^{2}} \\ln\\left( \\frac{\\sigma^{2} + \\phi(t) n \\tau_{0}^{2}}{\\sigma^{2}} \\right) = K t $$\n为了求出常数 $K$，我们使用另一个边界条件 $\\phi(1)=1$：\n$$ K = \\frac{1}{n\\tau_{0}^{2}} \\ln\\left( \\frac{\\sigma^{2} + n \\tau_{0}^{2}}{\\sigma^{2}} \\right) $$\n将 $K$ 代回关于 $\\phi(t)$ 的方程中：\n$$ \\frac{1}{n\\tau_{0}^{2}} \\ln\\left( \\frac{\\sigma^{2} + \\phi(t) n \\tau_{0}^{2}}{\\sigma^{2}} \\right) = \\frac{t}{n\\tau_{0}^{2}} \\ln\\left( \\frac{\\sigma^{2} + n \\tau_{0}^{2}}{\\sigma^{2}} \\right) $$\n两边乘以 $n\\tau_{0}^{2}$ 并利用对数性质：\n$$ \\ln\\left( 1 + \\phi(t) \\frac{n \\tau_{0}^{2}}{\\sigma^{2}} \\right) = t \\ln\\left( 1 + \\frac{n \\tau_{0}^{2}}{\\sigma^{2}} \\right) = \\ln\\left( \\left(1 + \\frac{n \\tau_{0}^{2}}{\\sigma^{2}}\\right)^{t} \\right) $$\n对两边取指数得到：\n$$ 1 + \\phi(t) \\frac{n \\tau_{0}^{2}}{\\sigma^{2}} = \\left(1 + \\frac{n \\tau_{0}^{2}}{\\sigma^{2}}\\right)^{t} - 1 $$\n最后，解出 $\\phi(t)$：\n$$ \\phi(t) \\frac{n \\tau_{0}^{2}}{\\sigma^{2}} = \\left(1 + \\frac{n \\tau_{0}^{2}}{\\sigma^{2}}\\right)^{t} - 1 $$\n$$ \\phi(t) = \\frac{\\sigma^{2}}{n \\tau_{0}^{2}} \\left[ \\left(1 + \\frac{n \\tau_{0}^{2}}{\\sigma^{2}}\\right)^{t} - 1 \\right] $$\n这就是在恒定方差准则下最优调度函数 $\\phi(t)$ 的闭式表达式。",
            "answer": "$$ \\boxed{\\frac{\\sigma^{2}}{n \\tau_{0}^{2}} \\left[ \\left(1 + \\frac{n \\tau_{0}^{2}}{\\sigma^{2}}\\right)^{t} - 1 \\right]} $$"
        }
    ]
}