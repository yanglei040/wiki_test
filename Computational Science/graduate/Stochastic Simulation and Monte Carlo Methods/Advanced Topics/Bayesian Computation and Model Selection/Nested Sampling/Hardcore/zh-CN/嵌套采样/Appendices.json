{
    "hands_on_practices": [
        {
            "introduction": "由于嵌套采样是一种随机算法，验证其结果的可靠性至关重要。一种直接的方法是进行两次独立的运行并比较它们的结果。本练习  引导您设计一个配对运行一致性检验，利用中心极限定理的假设和每次运行内部提供的方差估计，来构建一个统计量（$z$-分数），以确定两次运行的证据估计在统计上是否一致。",
            "id": "3323388",
            "problem": "考虑通过嵌套采样进行贝叶斯证据估计，其中证据定义为 $Z = \\int L(\\theta)\\,\\pi(\\theta)\\,d\\theta$，其中 $L(\\theta)$ 表示似然，$\\pi(\\theta)$ 表示先验密度。每次独立的嵌套采样运行都会产生一个估计量 $\\hat{Z}$，以及证据对数 $\\ln \\hat{Z}$ 的内部方差估计。假设对于足够大的活点数和表现良好的似然函数，中心极限定理（CLT）确保单次运行的对数证据估计量 $\\ln \\hat{Z}^{(i)}$ 近似服从均值为 $\\ln Z$、方差为 $V^{(i)}$ 的正态分布，并且两次运行是独立的。\n\n给定在同一后验目标上的两次独立运行，其输出如下：\n- 运行 $1$：$\\ln \\hat{Z}^{(1)} = -123.45$，方差估计 $V^{(1)} = 0.04$。\n- 运行 $2$：$\\ln \\hat{Z}^{(2)} = -123.90$，方差估计 $V^{(2)} = 0.0625$。\n\n设计一个配对运行一致性检验，在假设 $H_0:\\ln Z^{(1)}=\\ln Z^{(2)}$（运行结果一致）下，仅使用独立性和方差估计推导出 $z$-分数。然后，使用双边显著性水平 $\\alpha = 0.05$，对上述数据评估该检验统计量。为了做出决策，您可以使用双边标准正态临界值 $c_{0.05} = 1.959964$。计算 $z$-分数并根据检验规则说明两次运行是否一致，但最终答案只报告 $z$-分数的数值。将最终的 $z$-分数四舍五入到四位有效数字。",
            "solution": "该问题要求设计并应用一种统计检验，以检查两次独立的嵌套采样运行之间的一致性。该检验基于贝叶斯证据的对数估计量 $\\ln \\hat{Z}$ 及其相关方差。\n\n令 $X_1 = \\ln \\hat{Z}^{(1)}$ 和 $X_2 = \\ln \\hat{Z}^{(2)}$ 分别为代表运行 $1$ 和运行 $2$ 的对数证据估计量的随机变量。问题指出，根据中心极限定理，这些估计量近似服从正态分布。令它们的真实均值为 $\\mu_1$ 和 $\\mu_2$，真实方差为 $\\sigma_1^2$ 和 $\\sigma_2^2$。\n问题提供了以下假设和数据：\n$1$. 估计量服从正态分布：$X_1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$ 和 $X_2 \\sim \\mathcal{N}(\\mu_2, \\sigma_2^2)$。\n$2$. 两次运行是独立的。\n$3$. 观测值为 $x_1 = -123.45$ 和 $x_2 = -123.90$。\n$4$. 方差估计为 $\\sigma_1^2 \\approx V^{(1)} = 0.04$ 和 $\\sigma_2^2 \\approx V^{(2)} = 0.0625$。\n\n一致性检验的原假设 $H_0$ 是两次运行都是从具有相同真实证据 $Z$ 的后验中采样的。这意味着对数证据估计量的真实均值相等：\n$$H_0: \\mu_1 = \\mu_2$$\n为了检验这个假设，我们考虑两个估计量之差的分布，$\\Delta X = X_1 - X_2$。\n\n在原假设 $H_0$ 下，差值的期望为：\n$$E[\\Delta X] = E[X_1 - X_2] = E[X_1] - E[X_2] = \\mu_1 - \\mu_2 = 0$$\n因为两次运行是独立的，所以差值的方差是它们各自方差的和：\n$$\\text{Var}(\\Delta X) = \\text{Var}(X_1 - X_2) = \\text{Var}(X_1) + \\text{Var}(X_2) = \\sigma_1^2 + \\sigma_2^2$$\n由于 $X_1$ 和 $X_2$ 是正态随机变量，它们的差 $\\Delta X$ 也是一个正态随机变量。因此，在 $H_0$ 下，差值的分布为：\n$$\\Delta X \\sim \\mathcal{N}(0, \\sigma_1^2 + \\sigma_2^2)$$\n检验统计量是观测差值 $\\Delta x = x_1 - x_2$ 的标准分数（$z$-分数）。$z$-分数的定义是观测值减去均值，再除以标准差。\n$$z = \\frac{\\Delta x - E[\\Delta X]}{\\sqrt{\\text{Var}(\\Delta X)}} = \\frac{(x_1 - x_2) - 0}{\\sqrt{\\sigma_1^2 + \\sigma_2^2}}$$\n我们将观测值和给定的方差估计代入此公式：\n$$x_1 = -123.45$$\n$$x_2 = -123.90$$\n$$\\sigma_1^2 = V^{(1)} = 0.04$$\n$$\\sigma_2^2 = V^{(2)} = 0.0625$$\n分子是观测到的对数证据值的差：\n$$\\Delta x = -123.45 - (-123.90) = -123.45 + 123.90 = 0.45$$\n总方差是各个方差的和：\n$$\\sigma_1^2 + \\sigma_2^2 = 0.04 + 0.0625 = 0.1025$$\n差值的标准差是总方差的平方根：\n$$\\sqrt{\\sigma_1^2 + \\sigma_2^2} = \\sqrt{0.1025}$$\n现在，我们计算 $z$-分数：\n$$z = \\frac{0.45}{\\sqrt{0.1025}} \\approx \\frac{0.45}{0.3201562} \\approx 1.405565$$\n问题要求将结果四舍五入到四位有效数字。\n$$z \\approx 1.406$$\n为了做出决策，我们将计算出的 $z$-分数的绝对值与显著性水平 $\\alpha = 0.05$ 的双边检验的临界值 $c_{0.05} = 1.959964$ 进行比较。\n$$|z| \\approx 1.406$$\n由于 $|z|  c_{0.05}$（即 $1.406  1.959964$），我们没有足够的证据拒绝原假设 $H_0$。这意味着在指定的显著性水平下，两次运行被认为是一致的。然而，问题只要求提供 $z$-分数的数值。",
            "answer": "$$\\boxed{1.406}$$"
        },
        {
            "introduction": "在贝叶斯推断中，一个核心问题是我们的结论在多大程度上依赖于先验分布的选择。简单地用不同的先验多次运行算法是昂贵的。本练习  介绍了一种更高效的灵敏度分析技术，它要求您推导证据 $Z$ 关于先验微小扰动的响应（Gâteaux导数），并构建一个仅使用单次嵌套采样运行的“死亡点”输出即可计算该导数的蒙特卡洛估计量。",
            "id": "3323423",
            "problem": "设 $y$ 为观测数据，$\\Theta \\subset \\mathbb{R}^{d}$ 为参数空间，$\\pi(\\theta)$ 为 $\\Theta$ 上的先验密度，以及 $L(\\theta) = p(y \\mid \\theta)$ 为一个严格为正的似然函数。贝叶斯证据为 $Z = \\int_{\\Theta} L(\\theta) \\,\\pi(\\theta)\\,\\mathrm{d}\\theta$。考虑一个沿着由下式定义的指数倾斜得分方向的先验扰动：\n$$\n\\pi_{\\epsilon}(\\theta) = \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta) - \\kappa(\\epsilon)\\big),\n$$\n其中 $h:\\Theta \\to \\mathbb{R}$ 在先验 $\\pi$ 下是可积的，并且 $\\kappa(\\epsilon) = \\ln \\int_{\\Theta} \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta$ 确保了对于所有足够小的 $\\epsilon$，$\\pi_{\\epsilon}$ 都是归一化的。定义 $Z(\\epsilon) = \\int_{\\Theta} L(\\theta)\\,\\pi_{\\epsilon}(\\theta)\\,\\mathrm{d}\\theta$。假设 $h$ 在 $\\epsilon=0$ 时的先验下是中心化的，即 $\\int_{\\Theta} h(\\theta)\\,\\pi(\\theta)\\,\\mathrm{d}\\theta = 0$，因此 $\\kappa'(0) = 0$。\n\n一次包含 $n_{\\mathrm{live}} \\in \\mathbb{N}$ 个活点的嵌套采样运行，会产生一个由 $m \\in \\mathbb{N}$ 个死点组成的序列 $\\{(\\theta_{i}, L_{i})\\}_{i=1}^{m}$，其中 $L_{1} \\leq L_{2} \\leq \\cdots \\leq L_{m}$，以及相关的求积权重 $\\{w_{i}\\}_{i=1}^{m}$，由 $w_{i} = X_{i-1} - X_{i}$ 给出，其中 $X_{0} = 1$，$X_{i} = \\prod_{j=1}^{i} T_{j}$，且 $T_{j} \\sim \\mathrm{Beta}(n_{\\mathrm{live}}, 1)$ 是独立的收缩因子。证据的标准嵌套采样估计量为 $\\widehat{Z} = \\sum_{i=1}^{m} w_{i}\\,L_{i}$。\n\n仅从上述定义以及 Gâteaux 导数和期望的基本性质出发，推导 $Z(\\epsilon)$ 在 $\\epsilon=0$ 时沿方向 $h$ 的一阶灵敏度（Gâteaux 导数），然后仅使用死点 $\\{(\\theta_{i}, L_{i})\\}_{i=1}^{m}$ 及其权重 $\\{w_{i}\\}_{i=1}^{m}$ 来表示该导数的嵌套采样蒙特卡洛估计量。你的最终答案必须是仅用 $\\{(\\theta_{i}, L_{i}, w_{i})\\}_{i=1}^{m}$ 和 $h(\\cdot)$ 表示的单个闭式解析表达式。不要引入任何额外的量。不需要四舍五入，也不涉及单位。请按要求提供最终表达式。",
            "solution": "该问题要求一个两部分的解答：首先，推导贝叶斯证据 $Z(\\epsilon)$ 关于在 $\\epsilon=0$ 处的先验扰动的 Gâteaux 导数；其次，利用嵌套采样算法的输出为该导数构建一个蒙特卡洛估计量。\n\n### 第一部分：证据的 Gâteaux 导数\n\n贝叶斯证据 $Z$ 定义为数据 $y$ 的边际似然：\n$$\nZ = \\int_{\\Theta} L(\\theta) \\,\\pi(\\theta)\\,\\mathrm{d}\\theta\n$$\n其中 $L(\\theta)$ 是似然函数，$\\pi(\\theta)$ 是参数空间 $\\Theta$ 上的先验概率密度。\n\n该问题引入了一个通过对基准先验 $\\pi(\\theta)$ 进行指数倾斜而定义的受扰动的先验密度 $\\pi_{\\epsilon}(\\theta)$：\n$$\n\\pi_{\\epsilon}(\\theta) = \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta) - \\kappa(\\epsilon)\\big)\n$$\n此处，$h(\\theta)$ 是一个得分函数，$\\epsilon$ 是一个小的扰动参数，而 $\\kappa(\\epsilon)$ 是 $h(\\theta)$ 在 $\\pi(\\theta)$ 下的累积量生成函数，它充当一个归一化常数：\n$$\n\\kappa(\\epsilon) = \\ln \\int_{\\Theta} \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta\n$$\n受扰动的证据 $Z(\\epsilon)$ 是用受扰动的先验计算出的证据：\n$$\nZ(\\epsilon) = \\int_{\\Theta} L(\\theta)\\,\\pi_{\\epsilon}(\\theta)\\,\\mathrm{d}\\theta = \\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta) - \\kappa(\\epsilon)\\big)\\,\\mathrm{d}\\theta\n$$\n我们可以通过提出不依赖于积分变量 $\\theta$ 的项来重写此式：\n$$\nZ(\\epsilon) = \\exp\\!\\big(-\\kappa(\\epsilon)\\big) \\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta\n$$\n$Z(\\epsilon)$ 关于 $\\epsilon$ 的一阶灵敏度是其 Gâteaux 导数，我们可以通过对 $Z(\\epsilon)$ 关于 $\\epsilon$ 求导来得到。假设有足够的正则性允许在积分号下进行微分（莱布尼茨积分法则），我们应用乘法法则：\n$$\n\\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} = \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\Big( \\exp\\!\\big(-\\kappa(\\epsilon)\\big) \\Big) \\left( \\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta \\right) + \\exp\\!\\big(-\\kappa(\\epsilon)\\big) \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\left( \\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta \\right)\n$$\n让我们计算各个部分的导数。\n归一化因子的导数是：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\exp\\!\\big(-\\kappa(\\epsilon)\\big) = -\\kappa'(\\epsilon)\\,\\exp\\!\\big(-\\kappa(\\epsilon)\\big)\n$$\n积分项的导数是：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta = \\int_{\\Theta} L(\\theta) \\pi(\\theta) h(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta\n$$\n将这些代回 $\\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon}$ 的表达式中：\n$$\n\\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} = -\\kappa'(\\epsilon)\\,\\exp\\!\\big(-\\kappa(\\epsilon)\\big) \\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta + \\exp\\!\\big(-\\kappa(\\epsilon)\\big) \\int_{\\Theta} L(\\theta) \\pi(\\theta) h(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta\n$$\n我们可以识别出第一个积分与 $Z(\\epsilon)$ 相关：\n$$\n\\int_{\\Theta} L(\\theta) \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta)\\big)\\,\\mathrm{d}\\theta = Z(\\epsilon) / \\exp\\!\\big(-\\kappa(\\epsilon)\\big)\n$$\n代入此式简化了第一项：\n$$\n\\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} = -\\kappa'(\\epsilon) Z(\\epsilon) + \\int_{\\Theta} L(\\theta) h(\\theta) \\left( \\pi(\\theta)\\,\\exp\\!\\big(\\epsilon\\,h(\\theta) - \\kappa(\\epsilon)\\big) \\right) \\mathrm{d}\\theta\n$$\n括号中的项就是受扰动的先验 $\\pi_{\\epsilon}(\\theta)$。所以，\n$$\n\\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} = -\\kappa'(\\epsilon) Z(\\epsilon) + \\int_{\\Theta} L(\\theta) h(\\theta) \\pi_{\\epsilon}(\\theta) \\mathrm{d}\\theta\n$$\n题目要求的是在 $\\epsilon=0$ 处的导数。我们计算表达式在 $\\epsilon=0$ 时的值。此时：\n1.  $\\pi_{0}(\\theta) = \\pi(\\theta)\\,\\exp(0 - \\kappa(0))$。由于 $\\kappa(0) = \\ln \\int \\pi(\\theta)\\,\\exp(0)\\,\\mathrm{d}\\theta = \\ln(1) = 0$，我们有 $\\pi_{0}(\\theta) = \\pi(\\theta)$。\n2.  $Z(0) = \\int L(\\theta)\\pi(\\theta)\\mathrm{d}\\theta = Z$。\n3.  问题中说明 $h$ 在先验下是中心化的，即 $\\int_{\\Theta} h(\\theta)\\,\\pi(\\theta)\\,\\mathrm{d}\\theta = 0$。这意味着 $\\kappa'(0)=0$，这一点也已给出。要证明这一点：$\\kappa'(\\epsilon) = \\frac{\\int \\pi(\\theta)h(\\theta)\\exp(\\epsilon h(\\theta)) d\\theta}{\\int \\pi(\\theta)\\exp(\\epsilon h(\\theta)) d\\theta} = \\mathbb{E}_{\\pi_\\epsilon}[h(\\theta)]$。在 $\\epsilon=0$ 时，$\\kappa'(0) = \\mathbb{E}_{\\pi_0}[h(\\theta)] = \\mathbb{E}_{\\pi}[h(\\theta)] = 0$。\n\n将这些条件代入导数的表达式中：\n$$\n\\left. \\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} \\right|_{\\epsilon=0} = -\\kappa'(0) Z(0) + \\int_{\\Theta} L(\\theta) h(\\theta) \\pi_{0}(\\theta) \\mathrm{d}\\theta\n$$\n$$\n\\left. \\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} \\right|_{\\epsilon=0} = -0 \\cdot Z + \\int_{\\Theta} L(\\theta) h(\\theta) \\pi(\\theta) \\mathrm{d}\\theta\n$$\n因此，证据在方向 $h$ 上的一阶灵敏度由以下积分给出：\n$$\n\\left. \\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} \\right|_{\\epsilon=0} = \\int_{\\Theta} L(\\theta) h(\\theta) \\pi(\\theta) \\mathrm{d}\\theta\n$$\n\n### 第二部分：嵌套采样估计量\n\n嵌套采样算法为估计形如 $\\int_{\\Theta} g(\\theta)\\,\\pi(\\theta)\\,\\mathrm{d}\\theta$ 的积分提供了一个框架。该算法生成一个由 $m$ 个死点 $\\{\\theta_i\\}_{i=1}^m$ 及其相关似然 $\\{L_i\\}_{i=1}^m$ 组成的序列，并按似然值排序，使得 $L_1 \\leq L_2 \\leq \\cdots \\leq L_m$。这些点定义了一系列嵌套的先验体积 $X_i = \\int_{L(\\theta)>L_i} \\pi(\\theta)\\,\\mathrm{d}\\theta$，其中 $X_0=1  X_1  \\cdots  X_m$。\n\n该积分被重写为参数空间中不相交壳层上的和。参数空间 $\\Theta$ 被划分为多个壳层 $\\mathcal{C}_i = \\{\\theta \\in \\Theta \\mid L_{i-1}  L(\\theta) \\ge L_i\\}$ (其中 $i=1,\\ldots,m$ 且 $L_0 \\equiv \\infty$)，再加上活点所占的剩余体积。函数 $g(\\theta)$ 在先验上的积分可以写为：\n$$\n\\int_{\\Theta} g(\\theta) \\pi(\\theta) \\mathrm{d}\\theta = \\sum_{i=1}^m \\int_{\\mathcal{C}_i} g(\\theta) \\pi(\\theta) \\mathrm{d}\\theta + \\int_{L(\\theta) \\ge L_m} g(\\theta) \\pi(\\theta) \\mathrm{d}\\theta\n$$\n嵌套采样估计量近似了每个壳层 $\\mathcal{C}_i$ 上的积分。壳层 $\\mathcal{C}_i$ 的先验质量是 $\\int_{\\mathcal{C}_i} \\pi(\\theta) \\mathrm{d}\\theta = X_{i-1} - X_i$，这正是求积权重 $w_i$ 的定义。点 $\\theta_i$ (其似然为 $L_i$) 被视为壳层 $\\mathcal{C}_i$ 的一个代表性样本。因此，$g(\\theta)$ 在该壳层上的积分近似为：\n$$\n\\int_{\\mathcal{C}_i} g(\\theta) \\pi(\\theta) \\mathrm{d}\\theta \\approx g(\\theta_i) \\int_{\\mathcal{C}_i} \\pi(\\theta) \\mathrm{d}\\theta = g(\\theta_i) w_i\n$$\n对所有对应于死点的壳层进行求和（并通常忽略最后那组活点的微小贡献），我们得到 $g(\\theta)$ 积分的通用嵌套采样估计量：\n$$\n\\widehat{I}_g = \\sum_{i=1}^m w_i g(\\theta_i)\n$$\n在我们的情况中，我们需要估计灵敏度导数，也就是函数 $g(\\theta) = L(\\theta)h(\\theta)$ 的积分。\n$$\nS = \\left. \\frac{\\mathrm{d}Z}{\\mathrm{d}\\epsilon} \\right|_{\\epsilon=0} = \\int_{\\Theta} L(\\theta) h(\\theta) \\pi(\\theta) \\mathrm{d}\\theta\n$$\n应用嵌套采样估计公式，并令 $g(\\theta_i) = L(\\theta_i)h(\\theta_i) = L_i h(\\theta_i)$，我们得到 $S$ 的估计量：\n$$\n\\widehat{S} = \\sum_{i=1}^{m} w_i L_i h(\\theta_i)\n$$\n该表达式仅使用了嵌套采样运行中可获得的量：死点 $\\{\\theta_i\\}_{i=1}^m$、它们的似然 $\\{L_i\\}_{i=1}^m$、求积权重 $\\{w_i\\}_{i=1}^m$ 以及得分函数 $h(\\cdot)$。这就是所求的蒙特卡洛估计量。",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{m} w_{i} L_{i} h(\\theta_{i})}\n$$"
        },
        {
            "introduction": "嵌套采样算法的效率在很大程度上取决于“活点”数量 $N$ 的选择。与其在整个运行过程中使用固定的 $N$，动态调整它可以显著提高性能。本练习  深入探讨了动态嵌套采样的理论基础，要求您在连续极限下，为给定的计算预算推导出最小化证据估计量方差的最优活点调度方案 $N^{\\star}(X)$，从而揭示算法中高效资源分配的基本原则。",
            "id": "3323439",
            "problem": "考虑嵌套采样 (NS) 中的证据（边缘似然）积分，该积分在剩余先验质量坐标 $X \\in [0,1]$ 上定义为 $Z = \\int_{0}^{1} L(X)\\, dX$，其中 $L(X)$ 是作为 $X$ 函数的似然。假设一个理想化的 NS 过程，其中活点数允许根据一个调度 $N(X)$ 随 $X$ 连续变化，并且约束采样是精确的，因此每个 NS 迭代恰好需要一次新的似然评估。在连续统极限下进行研究，其中每次迭代的收缩是无穷小的，且 $N(X)$ 变化得足够慢，以至于局部平稳性近似有效。\n\n仅从以下基本事实和定义出发：\n- 从 $[0,1]$ 上的均匀分布中抽取的 $N$ 个独立样本中的最大值，其概率密度函数为 $p(t) = N\\, t^{N-1}$（对于 $t \\in (0,1)$），以及积分恒等式 $\\int_{0}^{1} t^{a-1} (-\\ln t)\\, dt = 1/a^{2}$ 和 $\\int_{0}^{1} t^{a-1} (\\ln t)^{2}\\, dt = 2/a^{3}$（对于 $a0$）。\n- 变量替换 $\\Lambda = -\\ln X$ 意味着 $dX = -X\\, d\\Lambda$ 和 $Z = \\int_{0}^{\\infty} L(X(\\Lambda))\\, X(\\Lambda)\\, d\\Lambda$。\n\n从第一性原理推导，在一个通用动态调度 $N(X)$ 下，NS 证据估计量的预期计算成本（似然评估次数）与主阶方差之间的关系，并用函数 $f(\\Lambda) = L(X(\\Lambda))\\, X(\\Lambda)$ 表示。然后，在似然评估的固定预期预算 $B$ 下，当 $L(X) = X^{\\beta}$ 且 $\\beta  -1$ 时，解析地求得能最小化主阶方差的最优调度 $N^{\\star}(X)$。将最终答案表示为用 $B$、$\\beta$ 和 $X$ 表示的 $N^{\\star}(X)$ 的闭式表达式。不需要进行数值近似，且最终表达式中不应包含任何单位。",
            "solution": "该问题陈述被验证为具有科学依据、良构、客观且自洽。它提出了一个嵌套采样领域内可解的理论问题，没有任何明显缺陷。我们可以开始求解。\n\n该问题需要一个分为两部分的推导。首先，我们必须建立预期计算成本与证据估计量主阶方差之间的关系。其次，我们必须利用这个关系，在一个固定的计算预算下，为一个特定的似然函数找到最优活点调度 $N^{\\star}(X)$。\n\n**第 1 部分：成本和方差泛函的推导**\n\n令 $X$ 为先验体积，其中 $X \\in [0,1]$。证据积分为 $Z = \\int_{0}^{1} L(X) dX$。我们在嵌套采样的连续统极限下进行研究。关键的随机步骤是先验体积从 $X_{i-1}$ 收缩到 $X_i$。收缩比 $t = X_i / X_{i-1}$ 是从 $[0,1]$ 上的均匀分布中抽取的 $N$ 个独立样本中的最大值，其中 $N$ 是活点数。问题陈述指出其概率密度函数为 $p(t|N) = N t^{N-1}$（对于 $t \\in (0,1)$）。\n\n我们进行变量替换，令 $\\Lambda = -\\ln X$。这将积分域从 $[0,1]$ 变换到 $[0,\\infty)$。微分元变为 $dX = -\\exp(-\\Lambda) d\\Lambda = -X d\\Lambda$。证据积分现在是 $Z = \\int_0^\\infty L(X(\\Lambda)) X(\\Lambda) d\\Lambda$。我们定义后验质量元函数为 $f(\\Lambda) = L(X(\\Lambda)) X(\\Lambda)$，因此 $Z = \\int_0^\\infty f(\\Lambda) d\\Lambda$。\n\n在嵌套采样过程的每一步中，我们在 $\\Lambda$ 上前进。增量为 $\\Delta \\Lambda = \\Lambda_i - \\Lambda_{i-1} = -\\ln(X_i) - (-\\ln(X_{i-1})) = -\\ln(X_i/X_{i-1}) = -\\ln t$。由于 $t$ 是一个随机变量，$\\Delta \\Lambda$ 也是。我们可以计算对于给定活点数 $N$ 时它的期望值和方差。\n\n在 $\\Lambda$ 中的预期步长是 $\\mathbb{E}[\\Delta \\Lambda | N] = \\mathbb{E}[-\\ln t | N]$。\n$$ \\mathbb{E}[\\Delta \\Lambda | N] = \\int_{0}^{1} (-\\ln t) p(t|N) dt = \\int_{0}^{1} (-\\ln t) N t^{N-1} dt $$\n使用提供的积分恒等式 $\\int_{0}^{1} t^{a-1} (-\\ln t) dt = 1/a^2$ 并令 $a=N$，我们得到：\n$$ \\mathbb{E}[\\Delta \\Lambda | N] = N \\left( \\frac{1}{N^2} \\right) = \\frac{1}{N} $$\n每一步（一次似然评估）使 $\\Lambda$ 前进的预期量为 $1/N$。因此，遍历一个无穷小区间 $d\\Lambda$ 所需的步数是 $dN_{steps} = d\\Lambda / \\mathbb{E}[\\Delta \\Lambda] = d\\Lambda / (1/N(\\Lambda)) = N(\\Lambda) d\\Lambda$。总预期计算成本 $B$（似然评估总次数）是在 $\\Lambda$ 的整个范围上的积分：\n$$ B = \\int_{0}^{\\infty} N(\\Lambda) d\\Lambda $$\n这是第一个所需的关系。\n\n接下来，我们推导证据估计量 $\\hat{Z}$ 的主阶方差。$Z$ 的嵌套采样估计是 $Z = \\int f(\\Lambda) d\\Lambda$ 的一个数值积分，其中积分点是随机的。不确定性源于先验体积 $X_i$ 的随机性，这又转化为步长 $\\Delta \\Lambda_i$ 的随机性。\n\n步长 $\\Delta \\Lambda$ 的方差是 $\\text{Var}(\\Delta \\Lambda | N) = \\mathbb{E}[(\\Delta \\Lambda)^2 | N] - (\\mathbb{E}[\\Delta \\Lambda | N])^2$。我们首先计算二阶矩：\n$$ \\mathbb{E}[(\\Delta \\Lambda)^2 | N] = \\mathbb{E}[(-\\ln t)^2 | N] = \\int_{0}^{1} (\\ln t)^2 N t^{N-1} dt $$\n使用提供的恒等式 $\\int_{0}^{1} t^{a-1} (\\ln t)^2 dt = 2/a^3$ 并令 $a=N$：\n$$ \\mathbb{E}[(\\Delta \\Lambda)^2 | N] = N \\left( \\frac{2}{N^3} \\right) = \\frac{2}{N^2} $$\n单步的方差是：\n$$ \\text{Var}(\\Delta \\Lambda | N) = \\frac{2}{N^2} - \\left(\\frac{1}{N}\\right)^2 = \\frac{1}{N^2} $$\n在位置 $\\Lambda$ 处，单步对证据积分的贡献近似为 $f(\\Lambda) \\Delta \\Lambda$。假设 $f(\\Lambda)$ 是局部常数，则此贡献的方差为 $\\text{Var}(f(\\Lambda) \\Delta \\Lambda) = f(\\Lambda)^2 \\text{Var}(\\Delta \\Lambda | N) = \\frac{f(\\Lambda)^2}{N^2}$。\n为了找到来自区间 $d\\Lambda$ 的方差贡献，我们将该区间内各个步骤的方差相加。在 $d\\Lambda$ 中的步数是 $N(\\Lambda) d\\Lambda$。假设连续步骤的误差是独立的，则来自区间 $d\\Lambda$ 的总方差贡献 $dV$ 为：\n$$ dV = (\\text{每步方差}) \\times (\\text{步数}) = \\left(\\frac{f(\\Lambda)^2}{N(\\Lambda)^2}\\right) \\times (N(\\Lambda) d\\Lambda) = \\frac{f(\\Lambda)^2}{N(\\Lambda)} d\\Lambda $$\n总主阶方差 $V = \\text{Var}(\\hat{Z})$ 是这些贡献在所有 $\\Lambda$ 上的积分：\n$$ V = \\int_{0}^{\\infty} \\frac{f(\\Lambda)^2}{N(\\Lambda)} d\\Lambda $$\n这是第二个所需的关系。\n\n**第 2 部分：调度 $N(X)$ 的优化**\n\n我们希望在固定总预算 $B$ 的约束下最小化方差 $V$。这是一个可以使用变分法解决的约束优化问题。我们定义一个带有拉格朗日乘子 $\\lambda$ 的拉格朗日泛函 $\\mathcal{F}$：\n$$ \\mathcal{F}[N(\\Lambda)] = V + \\lambda(B - \\int N(\\Lambda) d\\Lambda) = \\int_{0}^{\\infty} \\left( \\frac{f(\\Lambda)^2}{N(\\Lambda)} + \\lambda N(\\Lambda) \\right) d\\Lambda - \\lambda B $$\n为了找到最优调度 $N^{\\star}(\\Lambda)$，我们将被积函数关于 $N(\\Lambda)$ 的泛函导数设为零。令被积函数为 $\\mathcal{L}(N, \\Lambda) = \\frac{f(\\Lambda)^2}{N(\\Lambda)} + \\lambda N(\\Lambda)$。欧拉-拉格朗日方程简化为 $\\frac{\\partial \\mathcal{L}}{\\partial N} = 0$：\n$$ \\frac{\\partial}{\\partial N} \\left( \\frac{f(\\Lambda)^2}{N} + \\lambda N \\right) = -\\frac{f(\\Lambda)^2}{N^2} + \\lambda = 0 $$\n解出 $N$ 即可得到最优调度的形式：\n$$ N^{\\star}(\\Lambda)^2 = \\frac{f(\\Lambda)^2}{\\lambda} \\implies N^{\\star}(\\Lambda) = \\frac{|f(\\Lambda)|}{\\sqrt{\\lambda}} $$\n由于活点数 $N$ 必须为正，且 $f(\\Lambda) = L(X)X \\ge 0$，我们有 $N^{\\star}(\\Lambda) = \\frac{f(\\Lambda)}{\\sqrt{\\lambda}}$。\n\n我们通过将此最优形式代回预算约束来确定拉格朗日乘子 $\\lambda$：\n$$ B = \\int_{0}^{\\infty} N^{\\star}(\\Lambda) d\\Lambda = \\int_{0}^{\\infty} \\frac{f(\\Lambda)}{\\sqrt{\\lambda}} d\\Lambda = \\frac{1}{\\sqrt{\\lambda}} \\int_{0}^{\\infty} f(\\Lambda) d\\Lambda $$\n积分 $\\int_{0}^{\\infty} f(\\Lambda) d\\Lambda$ 就是总证据 $Z$。\n$$ B = \\frac{Z}{\\sqrt{\\lambda}} \\implies \\sqrt{\\lambda} = \\frac{Z}{B} $$\n将此代回 $N^{\\star}(\\Lambda)$ 的表达式中：\n$$ N^{\\star}(\\Lambda) = \\frac{f(\\Lambda)}{Z/B} = \\frac{B f(\\Lambda)}{Z} $$\n为了用原始坐标 $X$ 来表示，我们代入 $f(\\Lambda) = L(X)X$：\n$$ N^{\\star}(X) = \\frac{B L(X) X}{Z} $$\n\n**应用于 $L(X) = X^{\\beta}$**\n\n现在我们将这个一般性结果应用于指定的似然函数 $L(X) = X^{\\beta}$，其中 $\\beta  -1$。首先，我们计算证据 $Z$：\n$$ Z = \\int_{0}^{1} L(X) dX = \\int_{0}^{1} X^{\\beta} dX = \\left[ \\frac{X^{\\beta+1}}{\\beta+1} \\right]_{0}^{1} $$\n由于 $\\beta  -1$，我们有 $\\beta+1  0$，所以在 $X=0$ 处的极限是 $0$。\n$$ Z = \\frac{1^{\\beta+1}}{\\beta+1} - 0 = \\frac{1}{\\beta+1} $$\n现在我们将 $L(X) = X^\\beta$ 和 $Z = 1/(\\beta+1)$ 代入我们的最优调度 $N^{\\star}(X)$ 表达式中：\n$$ N^{\\star}(X) = \\frac{B (X^\\beta) X}{1/(\\beta+1)} = B (\\beta+1) X^{\\beta+1} $$\n这就是对于固定的计算预算 $B$，能最小化证据估计方差的最优活点调度的闭式表达式。",
            "answer": "$$\\boxed{B (\\beta+1) X^{\\beta+1}}$$"
        }
    ]
}