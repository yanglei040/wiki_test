{
    "hands_on_practices": [
        {
            "introduction": "为了理解退火重要性采样（AIS），最好从一个理想化的场景开始，在该场景中我们可以精确地计算所有量。这个练习剥离了MCMC采样误差的复杂性，让我们专注于AIS的核心：退火路径本身。通过处理简单的高斯分布，你将能够解析地计算出预期的增量权重，在完美混合的假设下，它等于配分函数的比率，从而为退火路径的几何性质如何决定重要性权重行为建立基础直觉。",
            "id": "3288040",
            "problem": "考虑以下退火重要性采样（Annealed Importance Sampling, AIS）的设置，这里正式介绍为带有几何路径的退火重要性采样（AIS）。设目标能量为 $E(x)=\\lambda x^2$，其中 $x\\in\\mathbb{R}$ 且 $\\lambda0$ 为一个固定的常数。定义基础分布 $b(x)$ 为均值为零、方差为 $s^2$ 的高斯分布，即 $b(x)=\\frac{1}{\\sqrt{2\\pi}\\,s}\\exp\\left(-\\frac{x^2}{2s^2}\\right)$，目标分布 $t(x)$ 为与能量 $E(x)$ 相关联的归一化吉布斯分布，由 $t(x)=\\sqrt{\\frac{\\lambda}{\\pi}}\\exp(-\\lambda x^2)$ 给出。考虑由逆温度序列 $\\{\\beta_k\\}_{k=0}^K$（其中 $0=\\beta_0  \\beta_1  \\dots  \\beta_K=1$）参数化的中间未归一化密度 $u_\\beta(x)=b(x)^{1-\\beta}t(x)^{\\beta}$ 的几何退火路径。\n\n从重要性采样和归一化常数的基本原理出发：对于任何具有归一化常数 $Z=\\int_\\mathbb{R}u(x)\\,\\mathrm{d}x$ 的未归一化密度 $u(x)$，其归一化密度为 $p(x)=\\frac{u(x)}{Z}$。在具有几何路径且每个阶段都完美混合的 AIS 中，从阶段 $k$ 到阶段 $k+1$ 的期望增量权重等于归一化常数之比 $\\frac{Z_{\\beta_{k+1}}}{Z_{\\beta_k}}$，其中 $Z_\\beta=\\int_\\mathbb{R}u_\\beta(x)\\,\\mathrm{d}x$。你的任务是，从第一性原理出发，为给定的 $b(x)$ 和 $t(x)$ 推导出归一化常数 $Z_\\beta$，然后实现一个程序，该程序在给定 $(\\lambda,s,\\{\\beta_k\\}_{k=0}^K)$ 的情况下，计算每个阶段的期望增量权重，定义为 $\\frac{Z_{\\beta_{k+1}}}{Z_{\\beta_k}}$，其中 $k=0,1,\\dots,K-1$。\n\n推导过程必须从 $b(x)$、$t(x)$、几何路径 $u_\\beta(x)$ 和归一化常数 $Z_\\beta$ 的定义开始，并且只能使用代数变换和关于高斯积分的公认事实，避免使用任何未在你解答中推导出的简化公式。\n\n你的程序必须处理以下参数集的测试套件，每个参数集以 $(\\lambda,s,\\text{schedule})$ 的形式提供：\n- 测试用例1：$(\\lambda,s,\\{\\beta_k\\})=\\left(0.7,1.5,\\{0.0,0.2,0.5,0.9,1.0\\}\\right)$。\n- 测试用例2（基础分布等于目标分布的边界情况）：$(\\lambda,s,\\{\\beta_k\\})=\\left(0.5,1.0,\\{0.0,0.3,0.6,0.9,1.0\\}\\right)$。\n- 测试用例3（小能量尺度和宽基础分布）：$(\\lambda,s,\\{\\beta_k\\})=\\left(10^{-6},100.0,\\{0.0,0.01,0.1,0.5,1.0\\}\\right)$。\n- 测试用例4（尖锐目标分布和窄基础分布）：$(\\lambda,s,\\{\\beta_k\\})=\\left(10.0,0.1,\\{0.0,0.4,0.8,1.0\\}\\right)$。\n\n对于每个测试用例，计算期望增量权重的列表 $\\left[\\frac{Z_{\\beta_1}}{Z_{\\beta_0}},\\frac{Z_{\\beta_2}}{Z_{\\beta_1}},\\dots,\\frac{Z_{\\beta_K}}{Z_{\\beta_{K-1}}}\\right]$。本问题不涉及物理单位。你的程序应该生成单行输出，包含一个用方括号括起来的、以逗号分隔的列表的列表，其中不含空格。每个内部列表对应于上面列出的一个测试用例，例如 $[[w_{1,1},w_{1,2}], [w_{2,1},\\dots]]$ 但不带空格：$[[w_{1,1},w_{1,2}],[w_{2,1},\\dots]]$。每个 $w$ 必须是十进制表示的浮点数。你的实现必须是一个完整、可运行的程序。",
            "solution": "该问题是有效的，因为它具有科学依据、问题设定良好、客观且内部一致。它提出了一个计算统计学领域的标准理论练习，特别涉及退火重要性采样（AIS）。所有提供的定义和参数都是标准的，并且足以推导出唯一解。\n\n任务是推导 AIS 方案中中间分布的归一化常数 $Z_\\beta$，然后用它来计算期望增量权重。推导过程按规定从第一性原理出发。\n\n设基础分布为均值为零、方差为 $s^2$ 的高斯分布，其概率密度函数（PDF）由下式给出：\n$$\nb(x) = \\frac{1}{\\sqrt{2\\pi}s} \\exp\\left(-\\frac{x^2}{2s^2}\\right)\n$$\n目标分布是能量为 $E(x) = \\lambda x^2$（$\\lambda  0$）的归一化吉布斯分布。未归一化的吉布斯分布是 $\\exp(-E(x)) = \\exp(-\\lambda x^2)$。为了将其归一化，我们计算积分 $\\int_{-\\infty}^{\\infty} \\exp(-\\lambda x^2) \\mathrm{d}x$。这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\mathrm{d}x = \\sqrt{\\pi/a}$ 的标准高斯积分，当 $a=\\lambda$ 时，结果为 $\\sqrt{\\pi/\\lambda}$。因此，归一化的目标概率密度函数是：\n$$\nt(x) = \\frac{\\exp(-\\lambda x^2)}{\\sqrt{\\pi/\\lambda}} = \\sqrt{\\frac{\\lambda}{\\pi}} \\exp(-\\lambda x^2)\n$$\n这与为 $t(x)$ 提供的表达式相匹配。\n\n几何退火路径为序列 $0 = \\beta_0  \\beta_1  \\dots  \\beta_K = 1$ 定义了一系列未归一化的中间密度 $u_\\beta(x)$：\n$$\nu_\\beta(x) = b(x)^{1-\\beta} t(x)^\\beta\n$$\n我们的第一步是将 $b(x)$ 和 $t(x)$ 的表达式代入此定义中：\n$$\nu_\\beta(x) = \\left[ \\frac{1}{\\sqrt{2\\pi}s} \\exp\\left(-\\frac{x^2}{2s^2}\\right) \\right]^{1-\\beta} \\left[ \\sqrt{\\frac{\\lambda}{\\pi}} \\exp(-\\lambda x^2) \\right]^{\\beta}\n$$\n我们可以将相对于 $x$ 为常数的项与包含 $x$ 的指数项分开：\n$$\nu_\\beta(x) = \\left( (\\sqrt{2\\pi}s)^{-1} \\right)^{1-\\beta} \\left( (\\pi/\\lambda)^{-1/2} \\right)^{\\beta} \\times \\exp\\left(-\\frac{x^2}{2s^2}\\right)^{1-\\beta} \\exp(-\\lambda x^2)^{\\beta}\n$$\n我们分别简化常数前置因子和指数部分。\n常数部分是：\n$$\nC_\\beta = (2\\pi s^2)^{-(1-\\beta)/2} (\\pi/\\lambda)^{-\\beta/2}\n$$\n指数部分是：\n$$\n\\exp\\left( -(1-\\beta)\\frac{x^2}{2s^2} - \\beta\\lambda x^2 \\right) = \\exp\\left( -x^2 \\left[ \\frac{1-\\beta}{2s^2} + \\beta\\lambda \\right] \\right)\n$$\n所以，未归一化密度 $u_\\beta(x)$ 是一个形式为 $u_\\beta(x) = C_\\beta \\exp(-A_\\beta x^2)$ 的未归一化高斯分布，其中指数中的系数 $A_\\beta$ 是：\n$$\nA_\\beta = \\frac{1-\\beta}{2s^2} + \\beta\\lambda\n$$\n归一化常数 $Z_\\beta$ 定义为 $u_\\beta(x)$ 在其定义域 $\\mathbb{R}$ 上的积分：\n$$\nZ_\\beta = \\int_{-\\infty}^{\\infty} u_\\beta(x) \\, \\mathrm{d}x = \\int_{-\\infty}^{\\infty} C_\\beta \\exp(-A_\\beta x^2) \\, \\mathrm{d}x = C_\\beta \\int_{-\\infty}^{\\infty} \\exp(-A_\\beta x^2) \\, \\mathrm{d}x\n$$\n由于 $\\lambda  0$，$s^2  0$ 且 $\\beta \\in [0, 1]$，系数 $A_\\beta$ 总是正的。这使我们可以使用前面提到的高斯积分公式 $\\int_{-\\infty}^{\\infty} e^{-ax^2} \\mathrm{d}x = \\sqrt{\\pi/a}$，其中 $a = A_\\beta$：\n$$\nZ_\\beta = C_\\beta \\sqrt{\\frac{\\pi}{A_\\beta}}\n$$\n代入 $C_\\beta$ 的表达式：\n$$\nZ_\\beta = (2\\pi s^2)^{-(1-\\beta)/2} (\\pi/\\lambda)^{-\\beta/2} \\pi^{1/2} A_\\beta^{-1/2}\n$$\n我们来简化常数的幂：\n$$\nZ_\\beta = 2^{-(1-\\beta)/2} \\pi^{-(1-\\beta)/2} s^{-(1-\\beta)} \\pi^{-\\beta/2} \\lambda^{\\beta/2} \\pi^{1/2} A_\\beta^{-1/2}\n$$\n$$\nZ_\\beta = 2^{-(1-\\beta)/2} s^{-(1-\\beta)} \\lambda^{\\beta/2} \\pi^{(-1+\\beta-\\beta+1)/2} A_\\beta^{-1/2}\n$$\n$\\pi$ 的指数简化为 $0$，所以 $\\pi^0=1$：\n$$\nZ_\\beta = 2^{-(1-\\beta)/2} s^{-(1-\\beta)} \\lambda^{\\beta/2} A_\\beta^{-1/2}\n$$\n现在，代入 $A_\\beta = \\frac{1-\\beta}{2s^2} + \\beta\\lambda = \\frac{1-\\beta + 2s^2\\beta\\lambda}{2s^2}$ 的表达式：\n$$\nZ_\\beta = 2^{-(1-\\beta)/2} s^{-(1-\\beta)} \\lambda^{\\beta/2} \\left( \\frac{1-\\beta + 2s^2\\beta\\lambda}{2s^2} \\right)^{-1/2}\n$$\n$$\nZ_\\beta = 2^{-(1-\\beta)/2} s^{-(1-\\beta)} \\lambda^{\\beta/2} \\left( \\frac{2s^2}{1-\\beta + 2s^2\\beta\\lambda} \\right)^{1/2}\n$$\n$$\nZ_\\beta = 2^{-1/2+\\beta/2} s^{-1+\\beta} \\lambda^{\\beta/2} \\cdot 2^{1/2} s^1 \\cdot (1-\\beta + 2s^2\\beta\\lambda)^{-1/2}\n$$\n合并同底项：\n$$\nZ_\\beta = 2^{\\beta/2} s^\\beta \\lambda^{\\beta/2} (1-\\beta + 2s^2\\beta\\lambda)^{-1/2}\n$$\n$$\nZ_\\beta = (2s^2\\lambda)^{\\beta/2} (1 - \\beta + (2s^2\\lambda)\\beta)^{-1/2}\n$$\n我们定义一个常数 $\\alpha = 2s^2\\lambda$。$Z_\\beta$ 的表达式变得非常简洁：\n$$\nZ_\\beta = \\alpha^{\\beta/2} (1 - \\beta + \\alpha\\beta)^{-1/2} = \\sqrt{\\frac{\\alpha^\\beta}{1 + (\\alpha-1)\\beta}}\n$$\n我们验证该公式的边界情况。对于 $\\beta=0$，$u_0(x) = b(x)$，它是归一化的，所以 $Z_0=1$。我们的公式给出 $Z_0 = \\sqrt{\\frac{\\alpha^0}{1+(\\alpha-1)0}} = \\sqrt{\\frac{1}{1}} = 1$。对于 $\\beta=1$，$u_1(x) = t(x)$，它也是归一化的，所以 $Z_1=1$。我们的公式给出 $Z_1 = \\sqrt{\\frac{\\alpha^1}{1+(\\alpha-1)1}} = \\sqrt{\\frac{\\alpha}{1+\\alpha-1}} = \\sqrt{\\frac{\\alpha}{\\alpha}} = 1$。该公式是正确的。\n\n从阶段 $k$到阶段 $k+1$ 的期望增量权重是归一化常数之比 $W_k = \\frac{Z_{\\beta_{k+1}}}{Z_{\\beta_k}}$。使用我们推导出的 $Z_\\beta$ 表达式：\n$$\nW_k = \\frac{\\sqrt{\\frac{\\alpha^{\\beta_{k+1}}}{1 + (\\alpha-1)\\beta_{k+1}}}}{\\sqrt{\\frac{\\alpha^{\\beta_k}}{1 + (\\alpha-1)\\beta_k}}} = \\sqrt{\\frac{\\alpha^{\\beta_{k+1}}}{1 + (\\alpha-1)\\beta_{k+1}} \\cdot \\frac{1 + (\\alpha-1)\\beta_k}{\\alpha^{\\beta_k}}}\n$$\n$$\nW_k = \\sqrt{\\alpha^{\\beta_{k+1}-\\beta_k} \\frac{1 + (\\alpha-1)\\beta_k}{1 + (\\alpha-1)\\beta_{k+1}}}\n$$\n这就是需要实现的最终表达式。项 $\\alpha = 2s^2\\lambda$ 在每个测试用例中计算一次。对于退火序列中从 $\\beta_k$ 到 $\\beta_{k+1}$ 的每一步，都使用此公式计算权重 $W_k$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected incremental weights for Annealed Importance Sampling (AIS)\n    with a geometric path between two Gaussian distributions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (lambda, s, schedule)\n        (0.7, 1.5, [0.0, 0.2, 0.5, 0.9, 1.0]),\n        (0.5, 1.0, [0.0, 0.3, 0.6, 0.9, 1.0]),\n        (1e-6, 100.0, [0.0, 0.01, 0.1, 0.5, 1.0]),\n        (10.0, 0.1, [0.0, 0.4, 0.8, 1.0]),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        lam, s, schedule = case\n        \n        # The derived formula depends on the constant alpha = 2 * s^2 * lambda.\n        alpha = 2.0 * s**2 * lam\n        \n        case_weights = []\n        # Iterate through the annealing schedule to compute each incremental weight.\n        for i in range(len(schedule) - 1):\n            beta_k = schedule[i]\n            beta_k_plus_1 = schedule[i+1]\n            \n            # The incremental weight from beta_k to beta_k_plus_1 is Z_{k+1}/Z_k.\n            # Handle the special case where alpha is 1, which means the base and\n            # target distributions are identical, so all weights are 1.\n            if np.isclose(alpha, 1.0):\n                weight = 1.0\n            else:\n                # Derived formula:\n                # W_k = sqrt(alpha^(beta_{k+1}-beta_k) * (1+(alpha-1)beta_k) / (1+(alpha-1)beta_{k+1}))\n                beta_diff = beta_k_plus_1 - beta_k\n                term1 = alpha**beta_diff\n                \n                numerator = 1.0 + (alpha - 1.0) * beta_k\n                denominator = 1.0 + (alpha - 1.0) * beta_k_plus_1\n                \n                # As derived, with alpha  0 and beta in [0, 1], the denominator is always positive.\n                term2 = numerator / denominator\n                \n                weight = np.sqrt(term1 * term2)\n            \n            case_weights.append(weight)\n        \n        all_results.append(case_weights)\n\n    # Final print statement in the exact required format:\n    # A single line, comma-separated list of lists, with no spaces.\n    # Example: [[w1,w2],[w3,w4,w5]]\n    inner_lists_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "虽然几何路径很简单，但在常见情况下可能会导致灾难性的失败，例如在处理重尾分布时。这个练习探讨了AIS的一个关键失效模式，即权重简并，当重要性权重的方差变为无穷大时就会发生。你将诊断为什么当目标分布具有重尾时，标准的基于高斯分布的路径会失败，并了解精心设计的“尾部感知”路径如何解决这个问题，从而学会分析AIS实现的稳定性。",
            "id": "3288124",
            "problem": "您需要研究 Annealed Importance Sampling (AIS) 在从指数轻尾基分布过渡到重尾目标分布时的失效模式，并设计一种尾部感知的替代方案。下面的所有数学定义都使用 AIS 的标准设置和未归一化密度。\n\n令 $d \\in \\mathbb{N}$ 表示维度。考虑 $\\mathbb{R}^d$ 上的一个基密度 $p_0(x) \\propto f_0(x)$ 和一个目标密度 $p_1(x) \\propto f_1(x)$。AIS 构建了一个中间未归一化密度序列 $\\{f_k\\}_{k=0}^K$，其中 $f_0=f_0$ 且 $f_K=f_1$，以及相应的归一化密度 $p_k(x) \\propto f_k(x)$。对于一个退火时间表 $\\{\\beta_k\\}_{k=0}^K$，其中 $\\beta_0=0$，$\\beta_K=1$，且 $\\beta_k$ 递增，标准的几何退火为 $f_k(x) = f_0(x)^{1-\\beta_k} f_1(x)^{\\beta_k}$。从 $k$ 到 $k+1$ 的 AIS 增量权重为 $r_{k \\to k+1}(x_k) = f_{k+1}(x_k)/f_k(x_k)$。当二阶矩 $\\mathbb{E}_{p_k}[r_{k \\to k+1}(X)^2]$ 在某个步骤 $k$ 为无穷大时，会发生灾难性的权重退化，导致重要性权重的方差为无穷大，并使得有效样本量在极限情况下任意接近于零。\n\n在本问题中，您将研究重尾目标的情况\n$$\np_1(x) \\propto f_1(x) \\propto \\left(1 + \\lVert x \\rVert^2 \\right)^{-\\nu},\n$$\n其中参数 $\\nu  d/2$ 以确保可归一化。您将比较两种 AIS 路径：\n\n- 从高斯基分布开始的标准几何退火：\n  $$\n  f_0(x) \\propto \\exp\\!\\left(-\\frac{\\lVert x \\rVert^2}{2}\\right), \\quad f_k(x) = f_0(x)^{1-\\beta_k} f_1(x)^{\\beta_k}, \\quad \\beta_k = \\frac{k}{K}.\n  $$\n- 一种尾部感知的多项式路径，它将基分布替换为重尾的类学生t分布密度：\n  $$\n  q_\\kappa(x) \\propto \\left(1 + \\lVert x \\rVert^2 \\right)^{-\\kappa}, \\quad \\kappa  d/2, \\quad \\tilde f_k(x) = q_\\kappa(x)^{1-\\beta_k} f_1(x)^{\\beta_k}, \\quad \\beta_k = \\frac{k}{K}.\n  $$\n\n您的任务是纯数学和算法性的：\n- 从重要性采样矩的基本定义出发，为每条路径推导在最后一步 $k=K-1$ 时增量权重二阶矩的有限性所需的尾部条件。对于标准几何退火，展示指数因子如何导致发散。对于尾部感知的多项式路径，推导一个涉及 $d$、$\\nu$、$\\kappa$ 和 $\\beta_{K-1}$ 的有限性条件。\n- 使用这些条件编写一个程序，为每个指定的测试用例计算：\n  1. 一个布尔值，指示在标准几何路径下，最终增量权重的二阶矩是否为无穷大。\n  2. 一个布尔值，指示在尾部感知的多项式路径下，最终增量权重的二阶矩是否为无穷大。\n  3. 一个非负实值的“指数发散系数”，用于标准几何路径的最后一步，定义为\n     $$\n     \\theta_{\\mathrm{geo}} := \\frac{a(\\beta_{K-1})}{2} - a(\\beta_{K}), \\quad a(\\beta) := 1 - \\beta,\n     $$\n     其中 $a(\\beta)$ 参数化了几何路径中的高斯因子 $\\exp(-a(\\beta)\\lVert x \\rVert^2/2)$。正的 $\\theta_{\\mathrm{geo}}$ 意味着被积函数的指数爆炸和无穷大的二阶矩。\n  4. 一个实值的“多项式可积性余量”，用于尾部感知路径的最后一步，定义为\n     $$\n     \\rho_{\\mathrm{poly}} := \\bigl(2 m(\\beta_K) - m(\\beta_{K-1})\\bigr) - \\frac{d}{2}, \\quad m(\\beta) := \\nu \\beta + \\kappa (1 - \\beta).\n     $$\n     正的余量意味着增量权重平方的积分是有限的；非正值则标志着发散或临界发散。\n\n实现细节：\n- 对于给定的整数 $K \\ge 2$，使用线性时间表 $\\beta_k = k/K$。\n- 使用以下测试套件，每个套件指定为一个元组 $(d,\\nu,\\kappa,K)$：\n  - 测试用例 1：$(2, 1.1, 1.5, 10)$。\n  - 测试用例 2：$(10, 6.0, 6.0, 20)$。\n  - 测试用例 3：$(50, 26.0, 26.0, 30)$。\n- 对于每个测试用例，按上述顺序计算并返回一个包含四个条目的列表：$[\\text{geo\\_inf}, \\text{poly\\_inf}, \\theta_{\\mathrm{geo}}, \\rho_{\\mathrm{poly}}]$，其中 $\\text{geo\\_inf}$ 和 $\\text{poly\\_inf}$ 是布尔值，$\\theta_{\\mathrm{geo}}$ 和 $\\rho_{\\mathrm{poly}}$ 是浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表由三个每个测试用例的列表组成，并用方括号括起来，例如\n$$\n[[\\text{geo\\_inf}_1, \\text{poly\\_inf}_1, \\theta_{\\mathrm{geo},1}, \\rho_{\\mathrm{poly},1}],[\\text{geo\\_inf}_2, \\text{poly\\_inf}_2, \\theta_{\\mathrm{geo},2}, \\rho_{\\mathrm{poly},2}],[\\text{geo\\_inf}_3, \\text{poly\\_inf}_3, \\theta_{\\mathrm{geo},3}, \\rho_{\\mathrm{poly},3}]].\n$$\n不应打印任何额外文本。不涉及任何物理单位。所有角度（如有）都应以弧度为单位。所有数字必须以Python对浮点数和布尔值的默认字符串转换所固有的标准十进制表示法打印。",
            "solution": "该问题要求通过检验最终增量重要性权重的二阶矩来分析 Annealed Importance Sampling (AIS) 的失效模式。该矩的有限性是 AIS 估计器稳定性和效率的关键诊断指标。我们将分析两种退火路径：从轻尾高斯分布到重尾目标的标准几何路径，以及从一个重尾分布到另一个的尾部感知路径。\n\n关注的核心量是从中间分布 $p_k$ 更新到 $p_{k+1}$ 的增量权重的二阶矩，由 $\\mathbb{E}_{p_k}[r_{k \\to k+1}(X)^2]$ 给出。增量权重定义为 $r_{k \\to k+1}(x) = f_{k+1}(x)/f_k(x)$，其中对任何 $j$ 都有 $p_j(x) \\propto f_j(x)$。期望是关于归一化密度 $p_k(x) = f_k(x) / Z_k$ 计算的，其中 $Z_k = \\int f_k(x) dx$。\n\n二阶矩的表达式为：\n$$\n\\mathbb{E}_{p_k}[r_{k \\to k+1}(X)^2] = \\int p_k(x) \\left(\\frac{f_{k+1}(x)}{f_k(x)}\\right)^2 dx = \\int \\frac{f_k(x)}{Z_k} \\frac{f_{k+1}(x)^2}{f_k(x)^2} dx = \\frac{1}{Z_k} \\int \\frac{f_{k+1}(x)^2}{f_k(x)} dx\n$$\n二阶矩是有限的，当且仅当积分 $\\int \\frac{f_{k+1}(x)^2}{f_k(x)} dx$ 是有限的，因为 $Z_k$ 是一个有限的归一化常数（假设 $p_k$ 是一个正常分布）。我们特别关注退火时间表的最后一步，即从 $k=K-1$ 到 $k=K$。因此，需要分析的积分是 $\\int \\frac{f_K(x)^2}{f_{K-1}(x)} dx$。\n\n退火时间表由 $\\{\\beta_k\\}_{k=0}^K$ 给出，其中 $\\beta_0=0$ 且 $\\beta_K=1$。中间密度构造为 $f_k \\propto f_{\\text{base}}^{1-\\beta_k} f_{\\text{target}}^{\\beta_k}$。对于最后一步，$f_K(x) \\propto f_{\\text{base}}^{1-\\beta_K} f_{\\text{target}}^{\\beta_K} = f_{\\text{base}}^{0} f_{\\text{target}}^{1} = f_1(x)$。因此，控制二阶矩的积分简化为：\n$$\nI = \\int \\frac{f_1(x)^2}{f_{K-1}(x)} dx\n$$\n\n我们现在将为指定的两条路径分析这个积分。\n\n### 标准几何退火路径\n对于此路径，基分布和目标的未归一化密度为：\n- 基分布: $f_0(x) \\propto \\exp(-\\frac{\\lVert x \\rVert^2}{2})$\n- 目标: $f_1(x) \\propto (1 + \\lVert x \\rVert^2)^{-\\nu}$\n\n在步骤 $k=K-1$ 处的中间密度是 $f_{K-1}(x) = f_0(x)^{1-\\beta_{K-1}} f_1(x)^{\\beta_{K-1}}$。\n将此代入积分 $I$：\n$$\nI_{\\text{geo}} = \\int \\frac{f_1(x)^2}{f_0(x)^{1-\\beta_{K-1}} f_1(x)^{\\beta_{K-1}}} dx = \\int f_0(x)^{-(1-\\beta_{K-1})} f_1(x)^{2-\\beta_{K-1}} dx\n$$\n现在，代入 $f_0$ 和 $f_1$ 的函数形式：\n$$\nI_{\\text{geo}} \\propto \\int \\left( \\exp\\left(-\\frac{\\lVert x \\rVert^2}{2}\\right) \\right)^{-(1-\\beta_{K-1})} \\left( (1 + \\lVert x \\rVert^2)^{-\\nu} \\right)^{2-\\beta_{K-1}} dx\n$$\n$$\nI_{\\text{geo}} \\propto \\int \\exp\\left(\\frac{1-\\beta_{K-1}}{2} \\lVert x \\rVert^2\\right) (1 + \\lVert x \\rVert^2)^{-\\nu(2-\\beta_{K-1})} dx\n$$\n为了使积分收敛，当 $\\lVert x \\rVert \\to \\infty$ 时，被积函数必须足够快地衰减到零。然而，由于 $\\beta_k$ 是一个递增时间表且 $\\beta_K=1$，我们有 $\\beta_{K-1}  1$。这意味着指数项中的系数 $1-\\beta_{K-1}$ 是严格为正的。当 $\\lVert x \\rVert \\to \\infty$ 时，项 $\\exp(\\frac{1-\\beta_{K-1}}{2} \\lVert x \\rVert^2)$ 呈指数级增长。这种指数增长将总是超过 $(1 + \\lVert x \\rVert^2)^{-\\nu(2-\\beta_{K-1})}$ 的多项式衰减。被积函数发散，因此积分 $I_{\\text{geo}}$ 是无穷大。\n这展示了当从轻尾（高斯）基分布过渡到重尾（类学生t分布）目标时，标准 AIS 会发生灾难性失效。最终增量权重的二阶矩总是无穷大。因此，布尔值 `geo_inf` 总是 `True`。\n\n“指数发散系数”定义为 $\\theta_{\\mathrm{geo}} := \\frac{a(\\beta_{K-1})}{2} - a(\\beta_{K})$。其中 $a(\\beta) = 1-\\beta$，我们有 $a(\\beta_{K-1})=1-\\beta_{K-1}$ 和 $a(\\beta_K)=a(1)=0$。所以，$\\theta_{\\mathrm{geo}} = \\frac{1-\\beta_{K-1}}{2}$。这正是发散指数项中 $\\lVert x \\rVert^2$ 的正系数，证实了它在导致积分爆炸中的作用。对于线性时间表 $\\beta_k = k/K$，我们有 $\\beta_{K-1}=(K-1)/K$，所以 $\\theta_{\\mathrm{geo}} = \\frac{1-(K-1)/K}{2} = \\frac{1/K}{2} = \\frac{1}{2K}$。\n\n### 尾部感知的多项式路径\n对于此路径，基分布和目标的未归一化密度为：\n- 基分布: $q_\\kappa(x) \\propto (1 + \\lVert x \\rVert^2)^{-\\kappa}$\n- 目标: $f_1(x) \\propto (1 + \\lVert x \\rVert^2)^{-\\nu}$\n\n中间密度为 $\\tilde f_{K-1}(x) = q_\\kappa(x)^{1-\\beta_{K-1}} f_1(x)^{\\beta_{K-1}}$。\n需要分析的积分为：\n$$\nI_{\\text{poly}} = \\int \\frac{f_1(x)^2}{\\tilde f_{K-1}(x)} dx = \\int q_\\kappa(x)^{-(1-\\beta_{K-1})} f_1(x)^{2-\\beta_{K-1}} dx\n$$\n代入函数形式：\n$$\nI_{\\text{poly}} \\propto \\int \\left( (1 + \\lVert x \\rVert^2)^{-\\kappa} \\right)^{-(1-\\beta_{K-1})} \\left( (1 + \\lVert x \\rVert^2)^{-\\nu} \\right)^{2-\\beta_{K-1}} dx\n$$\n$$\nI_{\\text{poly}} \\propto \\int (1 + \\lVert x \\rVert^2)^{\\kappa(1-\\beta_{K-1})} (1 + \\lVert x \\rVert^2)^{-\\nu(2-\\beta_{K-1})} dx\n$$\n$$\nI_{\\text{poly}} \\propto \\int (1 + \\lVert x \\rVert^2)^{-\\left[\\nu(2-\\beta_{K-1}) - \\kappa(1-\\beta_{K-1})\\right]} dx\n$$\n这是一个在 $\\mathbb{R}^d$ 上的形式为 $\\int (1+r^2)^{-p} d^d x$ 的积分，其中 $r = \\lVert x \\rVert$。使用超球面坐标，该积分是有限的当且仅当被积函数衰减得足够快。对于大的 $r$，其渐进行为是 $r^{-2p}$。在 $\\mathbb{R}^d$ 上的积分行为类似于 $\\int^\\infty r^{-2p} r^{d-1} dr = \\int^\\infty r^{d-1-2p} dr$。该积分收敛当且仅当指数小于 $-1$，即 $d-1-2p  -1$，简化为 $2p > d$。\n\n在我们的例子中，指数是 $p = \\nu(2-\\beta_{K-1}) - \\kappa(1-\\beta_{K-1})$。因此，二阶矩有限的条件是：\n$$\n2\\left[\\nu(2-\\beta_{K-1}) - \\kappa(1-\\beta_{K-1})\\right] > d\n$$\n我们将其与“多项式可积性余量”$\\rho_{\\mathrm{poly}} := (2 m(\\beta_K) - m(\\beta_{K-1})) - d/2$ 联系起来，其中 $m(\\beta) := \\nu \\beta + \\kappa (1 - \\beta)$。\n我们来展开项 $2 m(\\beta_K) - m(\\beta_{K-1})$：\n- $m(\\beta_K) = m(1) = \\nu(1) + \\kappa(1-1) = \\nu$。\n- $m(\\beta_{K-1}) = \\nu \\beta_{K-1} + \\kappa (1 - \\beta_{K-1})$。\n- $2 m(\\beta_K) - m(\\beta_{K-1}) = 2\\nu - (\\nu \\beta_{K-1} + \\kappa(1-\\beta_{K-1})) = 2\\nu - \\nu\\beta_{K-1} - \\kappa + \\kappa\\beta_{K-1} = \\nu(2-\\beta_{K-1}) - \\kappa(1-\\beta_{K-1})$。\n这正是我们推导中得到的指数 $p$。\n\n收敛条件 $2p > d$ 可以重写为 $p > d/2$。代入 $p = 2 m(\\beta_K) - m(\\beta_{K-1})$，条件变为：\n$$\n(2 m(\\beta_K) - m(\\beta_{K-1})) > \\frac{d}{2} \\iff (2 m(\\beta_K) - m(\\beta_{K-1})) - \\frac{d}{2} > 0\n$$\n这恰好是条件 $\\rho_{\\mathrm{poly}} > 0$。因此，增量权重的二阶矩是有限的当且仅当多项式可积性余量为正。如果 $\\rho_{\\mathrm{poly}} \\le 0$，则发生发散。如果 $\\rho_{\\mathrm{poly}} \\le 0$，布尔值 `poly_inf` 为 `True`，否则为 `False`。\n\n根据这些推导，我们现在可以实现一个程序来为给定的测试用例计算所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes AIS failure diagnostics for given test cases.\n\n    For each test case (d, nu, kappa, K), this function calculates four values:\n    1. geo_inf: Boolean, True if the second moment of the final incremental weight\n                under the standard geometric path is infinite.\n    2. poly_inf: Boolean, True if the second moment of the final incremental weight\n                 under the tail-aware polynomial path is infinite.\n    3. theta_geo: The exponential divergence coefficient for the geometric path.\n    4. rho_poly: The polynomial integrability margin for the polynomial path.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (d, nu, kappa, K).\n    test_cases = [\n        (2, 1.1, 1.5, 10),\n        (10, 6.0, 6.0, 20),\n        (50, 26.0, 26.0, 30),\n    ]\n\n    results = []\n    for case in test_cases:\n        d, nu, kappa, K = case\n\n        # --- Standard Geometric Path Analysis ---\n        \n        # As derived, bridging a light-tailed exponential base to a heavy-tailed\n        # polynomial target always results in an infinite second moment for the\n        # final importance weight. The integrand contains a term exp(c*||x||^2)\n        # where c  0, which causes divergence.\n        geo_inf = True\n\n        # Calculate the exponential divergence coefficient theta_geo.\n        # beta_k = k / K. beta_{K-1} = (K-1)/K.\n        # theta_geo = (1 - beta_{K-1}) / 2 = (1 - (K-1)/K) / 2 = (1/K) / 2 = 1 / (2*K).\n        theta_geo = 1.0 / (2.0 * K)\n\n        # --- Tail-Aware Polynomial Path Analysis ---\n\n        # Calculate the polynomial integrability margin rho_poly.\n        # beta_K = 1\n        # beta_{K-1} = (K-1)/K\n        # m(beta) = nu*beta + kappa*(1-beta)\n        # m(beta_K) = nu\n        # m(beta_{K-1}) = nu * (K-1)/K + kappa * (1 - (K-1)/K) = nu * (K-1)/K + kappa/K\n        # rho_poly = (2*m(beta_K) - m(beta_{K-1})) - d/2\n        #          = (2*nu - (nu*(K-1)/K + kappa/K)) - d/2\n        #          = nu*(2 - (K-1)/K) - kappa/K - d/2\n        #          = nu*( (2K - K + 1)/K ) - kappa/K - d/2\n        #          = nu*(K+1)/K - kappa/K - d/2\n        \n        rho_poly = nu * (K + 1.0) / K - kappa / K - d / 2.0\n        \n        # The second moment is infinite if and only if rho_poly is non-positive.\n        poly_inf = rho_poly = 0\n\n        # Append the results for the current test case.\n        results.append([geo_inf, poly_inf, theta_geo, rho_poly])\n\n    # Final print statement in the exact required format.\n    # Convert each inner list to its string representation and join them.\n    # Python's default string conversion for bools and floats is used as required.\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]},{res[3]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一旦我们有了一条稳定的退火路径，一个关键的实际问题是如何对其进行离散化：我们应该使用多少个中间步骤？这个练习深入探讨了统计效率和计算成本之间的权衡。使用更多的中间步骤（$T$）会降低单次运行中AIS权重的方差，但会增加每次运行的成本，这意味着在固定预算下能够执行的独立运行次数（$N$）会减少。通过分析这一权衡的理论模型，你将推导出总均方误差如何依赖于步骤数，从而深入了解如何优化AIS以实现最高效率。",
            "id": "3288053",
            "problem": "考虑使用退火重要性采样 (Annealed Importance Sampling, AIS) 方法来估计一个可解的基本密度和一个难解的目标密度之间归一化常数的比率。令 $\\tilde{p}_{\\lambda}(x) = \\exp(-U_{\\lambda}(x))$ 表示由退火参数 $\\lambda \\in [0,1]$ 索引的一个平滑的未归一化密度族，其对应的归一化密度为 $p_{\\lambda}(x) = \\tilde{p}_{\\lambda}(x) / Z_{\\lambda}$，其中 $Z_{\\lambda}$ 是在 $\\lambda$ 处的归一化常数。AIS 通过为 $t = 0,1,\\dots,T$ 选择一个退火方案 $\\lambda_{t} = t/T$ 来构建一系列中间分布，并在每个中间分布上应用一步马尔可夫链蒙特卡洛 (MCMC) 转移核 $K_{\\lambda_{t}}$，该转移核使 $p_{\\lambda_{t}}$ 保持不变。单个轨迹的 AIS 权重 $W$ 是整个退火方案中未归一化密度增量比率的乘积，而比率 $R = Z_{1} / Z_{0}$ 的 AIS 估计量是 $N$ 个独立 AIS 轨迹的样本均值 $\\hat{R} = \\frac{1}{N} \\sum_{i=1}^{N} W^{(i)}$。\n\n对于适用于小退火步长和每个中间分布一次 MCMC 转移的高级渐近分析，我们做出以下模型假设：\n- AIS 权重的对数，记为 $\\ell = \\ln W$，在中间步骤上满足中心极限定理 (Central Limit Theorem, CLT)，其渐近方差 $v(T)$ 遵循 $v(T) = \\Theta / T$，其中常数 $\\Theta  0$ 由下式给出\n$$\n\\Theta \\equiv \\int_{0}^{1} \\operatorname{Var}_{p_{\\lambda}}\\!\\left( \\partial_{\\lambda} \\ln \\tilde{p}_{\\lambda}(X) \\right) \\, \\tau_{\\mathrm{int}}(\\lambda) \\, d\\lambda,\n$$\n其中 $\\tau_{\\mathrm{int}}(\\lambda)$ 是单步 MCMC 核 $K_{\\lambda}$ 在传播相关的类分数可观测量 $\\partial_{\\lambda} \\ln \\tilde{p}_{\\lambda}(X)$ 时的积分自相关时间。\n- $\\ell$ 的分布可以很好地用一个正态分布来近似，其均值的选择使得 $\\mathbb{E}[W] = R$，从而保证了 $\\hat{R}$ 的无偏性。\n- 总计算预算固定为 $B  0$ 个单位，每个 AIS 轨迹的成本为 $c_{0} + c_{1} T$，其中 $c_{0}  0$ 表示与轨迹无关的开销（例如，初始化或基本密度采样），$c_{1}  0$ 是每个中间分布的成本（例如，单次 MCMC 转移和密度评估）。在此预算模型下，轨迹数量为 $N = B / (c_{0} + c_{1} T)$，忽略整数取整。\n\n基于这些假设，并且仅使用基本的概率定义和由中心极限定理所蕴含的对数正态近似，完成以下任务：\n1. 推导 AIS 估计量的均方误差 (MSE) $\\operatorname{MSE}(T) = \\operatorname{Var}(\\hat{R})$ 的显式表达式，该表达式是关于 $T$、$R$、$\\Theta$、$B$、$c_{0}$ 和 $c_{1}$ 的函数。\n2. 对你的表达式关于 $T$ 求导，并确定一个参数条件，在该条件下增加中间分布的数量 $T$ 会减小均方误差。你的条件必须在此模型内从第一性原理推导得出，并且必须指明当 $T$ 增加时，造成单调改进或缺乏改进的数学结构。\n3. 在相同的假设下，计算当 $T \\to \\infty$ 时 $\\operatorname{MSE}(T)$ 的极限值，并用封闭形式表示该极限。这个极限值代表了在给定固定预算模型下，对于任意精细的退火方案可实现的最小均方误差。\n\n你的最终答案必须是第 3 部分推导出的极限最小均方误差的单个封闭形式解析表达式。不需要四舍五入，也不涉及物理单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **密度**：$\\tilde{p}_{\\lambda}(x) = \\exp(-U_{\\lambda}(x))$，$p_{\\lambda}(x) = \\tilde{p}_{\\lambda}(x) / Z_{\\lambda}$，对于 $\\lambda \\in [0,1]$。\n- **目标比率**：$R = Z_{1} / Z_{0}$。\n- **退火方案**：$\\lambda_{t} = t/T$ 对于 $t = 0,1,\\dots,T$。\n- **MCMC 核**：$K_{\\lambda_{t}}$ 使 $p_{\\lambda_{t}}$ 保持不变；每个中间分布应用一步。\n- **AIS 估计量**：$\\hat{R} = \\frac{1}{N} \\sum_{i=1}^{N} W^{(i)}$，其中 $W^{(i)}$ 是独立同分布的 AIS 权重。\n- **渐近假设**：\n    1. 对数权重 $\\ell = \\ln W$ 遵循中心极限定理。\n    2. 对数权重的方差为 $v(T) = \\operatorname{Var}(\\ell) = \\Theta / T$，其中 $\\Theta \\equiv \\int_{0}^{1} \\operatorname{Var}_{p_{\\lambda}}\\!\\left( \\partial_{\\lambda} \\ln \\tilde{p}_{\\lambda}(X) \\right) \\, \\tau_{\\mathrm{int}}(\\lambda) \\, d\\lambda  0$。\n    3. $\\ell$ 的分布近似为正态分布 $\\ell \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其中 $\\sigma^2 = \\Theta/T$。\n    4. 估计量是无偏的：$\\mathbb{E}[W] = R$。\n- **成本模型**：\n    1. 总预算是一个固定常数 $B  0$。\n    2. 每个轨迹的成本是 $c_{0} + c_{1} T$，其中 $c_{0}  0$ 且 $c_{1}  0$。\n    3. 轨迹数量为 $N = B / (c_{0} + c_{1} T)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在高等蒙特卡洛方法的理论中有充分的依据。关于对数权重的中心极限定理以及渐近方差 $\\Theta/T$ 形式的假设，是关于 AIS 及类似路径采样算法分析文献中的标准结果。\n- **适定性**：该问题是适定的，提供了推导所要求量所需的所有必要定义和变量之间的关系。它要求推导、条件和极限，所有这些在给定模型下都是标准的数学任务。\n- **客观性**：该问题以精确、客观的数学语言陈述。\n- **一致性与完整性**：该问题是自洽的，其约束条件是一致的。所有常数（$B, \\Theta, c_0, c_1$）的正值在预算、成本和统计方差的背景下具有物理意义。该模型是分析算法效率的标准简化框架。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n本解答将按照题目要求分三部分进行。\n\n**第 1 部分：均方误差 (MSE) 的推导**\n\n比率 $R$ 的估计量由 $\\hat{R} = \\frac{1}{N} \\sum_{i=1}^{N} W^{(i)}$ 给出，其中权重 $W^{(i)}$ 是独立同分布 (i.i.d.) 的随机变量。题目指出该估计量是无偏的，即 $\\mathbb{E}[\\hat{R}] = R$。这与给定的假设 $\\mathbb{E}[W] = R$ 一致。\n\n对于一个无偏估计量，其均方误差 ($\\operatorname{MSE}$) 等于其方差：\n$$\n\\operatorname{MSE}(T) = \\mathbb{E}[(\\hat{R} - R)^2] = \\operatorname{Var}(\\hat{R})\n$$\n由于 $W^{(i)}$ 是独立同分布的，其样本均值的方差为：\n$$\n\\operatorname{Var}(\\hat{R}) = \\operatorname{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} W^{(i)}\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\operatorname{Var}(W^{(i)}) = \\frac{N \\operatorname{Var}(W)}{N^2} = \\frac{\\operatorname{Var}(W)}{N}\n$$\n下一步是求出 $\\operatorname{Var}(W)$ 的表达式。我们已知权重的对数 $\\ell = \\ln W$ 近似服从正态分布：$\\ell \\sim \\mathcal{N}(\\mu, \\sigma^2)$。这意味着 $W = \\exp(\\ell)$ 服从对数正态分布。该分布的方差为 $\\sigma^2 = \\Theta/T$。\n\n对数正态随机变量 $W = \\exp(\\ell)$ 的均值和方差由下式给出：\n$$\n\\mathbb{E}[W] = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)\n$$\n$$\n\\operatorname{Var}(W) = \\left(\\exp(\\sigma^2) - 1\\right) \\exp(2\\mu + \\sigma^2) = \\left(\\exp(\\sigma^2) - 1\\right) \\left(\\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)\\right)^2\n$$\n使用给定条件 $\\mathbb{E}[W] = R$，我们可以写出：\n$$\n\\operatorname{Var}(W) = (\\exp(\\sigma^2) - 1) (\\mathbb{E}[W])^2 = R^2 (\\exp(\\sigma^2) - 1)\n$$\n代入 $\\sigma^2 = \\Theta/T$，我们得到单个 AIS 权重的方差：\n$$\n\\operatorname{Var}(W) = R^2 \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) - 1\\right)\n$$\n现在，我们可以组装出 $\\operatorname{MSE}(T)$ 的表达式。我们将 $\\operatorname{Var}(W)$ 和给定的轨迹数表达式 $N = B / (c_{0} + c_{1} T)$ 代入公式 $\\operatorname{MSE}(T) = \\operatorname{Var}(W)/N$：\n$$\n\\operatorname{MSE}(T) = \\frac{R^2 \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) - 1\\right)}{B / (c_{0} + c_{1} T)} = \\frac{R^2 (c_{0} + c_{1} T)}{B} \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) - 1\\right)\n$$\n这就是 MSE 作为模型参数函数的显式表达式。\n\n**第 2 部分：随着 T 增加 MSE 减小的条件**\n\n为了确定增加 $T$ 会使 MSE 减小的条件，我们必须分析导数 $\\frac{d}{dT} \\operatorname{MSE}(T)$ 的符号。因子 $R^2/B$ 是一个正常数，因此我们只需要分析函数 $f(T) = (c_{0} + c_{1} T) \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) - 1\\right)$ 的导数符号。\n\n使用乘法法则求导，$(uv)' = u'v + uv'$：\n$$\n\\frac{d f}{d T} = c_{1} \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) - 1\\right) + (c_{0} + c_{1} T) \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) \\cdot \\left(-\\frac{\\Theta}{T^2}\\right)\\right)\n$$\n$$\n\\frac{d f}{d T} = c_{1} \\exp\\left(\\frac{\\Theta}{T}\\right) - c_{1} - \\left(\\frac{c_{0}\\Theta}{T^2} + \\frac{c_{1}\\Theta}{T}\\right) \\exp\\left(\\frac{\\Theta}{T}\\right)\n$$\n$$\n\\frac{d f}{d T} = \\exp\\left(\\frac{\\Theta}{T}\\right) \\left(c_{1} - \\frac{c_{1}\\Theta}{T} - \\frac{c_{0}\\Theta}{T^2}\\right) - c_{1}\n$$\n我们想找到 $\\frac{d f}{d T}  0$ 的条件。令 $y = \\Theta/T$。由于 $T>0$ 且 $\\Theta>0$，我们有 $y > 0$。导数可以写成 $y$ 的函数：\n$$\ng(y) = \\exp(y) \\left(c_{1} - c_{1}y - \\frac{c_{0}}{\\Theta}y^2\\right) - c_{1}\n$$\n当且仅当对于 $y>0$ 有 $g(y)  0$ 时，MSE 随 $T$ 的增加而减小。\n我们来分析函数 $g(y)$。首先，在它定义域的边界 $y=0$ 处求值：\n$$\ng(0) = \\exp(0) (c_{1} - 0 - 0) - c_{1} = c_{1} - c_{1} = 0\n$$\n接下来，我们考察它的导数 $g'(y)$：\n$$\ng'(y) = \\frac{d}{dy} \\left[\\exp(y) \\left(c_{1} - c_{1}y - \\frac{c_{0}}{\\Theta}y^2\\right) - c_{1}\\right]\n$$\n$$\ng'(y) = \\exp(y)\\left(c_{1} - c_{1}y - \\frac{c_{0}}{\\Theta}y^2\\right) + \\exp(y)\\left(-c_{1} - \\frac{2c_{0}}{\\Theta}y\\right)\n$$\n$$\ng'(y) = \\exp(y) \\left[ \\left(c_{1} - c_{1}y - \\frac{c_{0}}{\\Theta}y^2\\right) + \\left(-c_{1} - \\frac{2c_{0}}{\\Theta}y\\right) \\right]\n$$\n$$\ng'(y) = \\exp(y) \\left[ -c_{1}y - \\frac{3c_{0}}{\\Theta}y - \\frac{c_{0}}{\\Theta}y^2 \\right] = -y\\exp(y) \\left[ c_{1} + \\frac{3c_{0}}{\\Theta} + \\frac{c_{0}}{\\Theta}y \\right]\n$$\n根据题目陈述，参数 $c_{0}$、$c_{1}$ 和 $\\Theta$ 均为正。对于 $y > 0$，项 $y\\exp(y)$ 是正的，方括号中的项 $\\left[ c_{1} + \\frac{3c_{0}}{\\Theta} + \\frac{c_{0}}{\\Theta}y \\right]$ 也是正数之和，因此是正的。所以，$g'(y)$ 是一个前导负号与三个正项的乘积，这意味着对于所有 $y > 0$，$g'(y)  0$。\n\n由于 $g(0)=0$ 并且 $g(y)$ 是一个在 $y>0$ 上严格递减的函数，因此对于所有 $y>0$，$g(y)  0$。这意味着对于所有 $T>0$，$\\frac{d}{dT} \\operatorname{MSE}(T)  0$。\n因此，在此模型下，增加中间分布的数量 $T$ 总是会减小 MSE。唯一需要的条件是参数 $c_0, c_1, \\Theta$ 为正，这已在题目陈述中明确。造成这种单调改进的数学结构是：控制导数符号的函数 $g(y)$ 在原点（$T \\to \\infty$）处为零，并对所有正的 $y$（有限的 $T$）严格递减。这是由于成本随 $T$ 线性增长与方差类指数衰减之间的特定相互作用所致，其中方差减小的效应总是超过每个轨迹成本的增加。\n\n**第 3 部分：当 T 趋于无穷大时 MSE 的极限值**\n\n我们需要计算当 $T \\to \\infty$ 时 MSE 的极限。\n$$\n\\lim_{T\\to\\infty} \\operatorname{MSE}(T) = \\lim_{T\\to\\infty} \\frac{R^2 (c_{0} + c_{1} T)}{B} \\left(\\exp\\left(\\frac{\\Theta}{T}\\right) - 1\\right)\n$$\n这个极限是 $\\infty \\cdot 0$ 的不定形式。我们可以通过重新整理表达式并使用导数的标准极限定义或泰勒展开来解决它。\n我们使用 $\\exp(x)$ 在 $x=0$ 附近的泰勒展开。对于小的 $x$，$\\exp(x) \\approx 1 + x$。当 $T \\to \\infty$ 时，$\\Theta/T \\to 0$，所以我们可以写出：\n$$\n\\exp\\left(\\frac{\\Theta}{T}\\right) - 1 = \\left(1 + \\frac{\\Theta}{T} + O\\left(\\frac{1}{T^2}\\right)\\right) - 1 = \\frac{\\Theta}{T} + O\\left(\\frac{1}{T^2}\\right)\n$$\n将此代入 MSE 的表达式中：\n$$\n\\operatorname{MSE}(T) \\approx \\frac{R^2 (c_{0} + c_{1} T)}{B} \\left(\\frac{\\Theta}{T}\\right) = \\frac{R^2 \\Theta}{B} \\left(\\frac{c_{0}}{T} + c_{1}\\right)\n$$\n取 $T \\to \\infty$ 的极限：\n$$\n\\lim_{T\\to\\infty} \\operatorname{MSE}(T) = \\lim_{T\\to\\infty} \\frac{R^2 \\Theta}{B} \\left(\\frac{c_{0}}{T} + c_{1}\\right)\n$$\n当 $T \\to \\infty$ 时，项 $c_{0}/T$ 趋于 $0$。因此极限为：\n$$\n\\lim_{T\\to\\infty} \\operatorname{MSE}(T) = \\frac{R^2 \\Theta c_{1}}{B}\n$$\n这是在给定固定预算模型下，对于任意精细的退火方案可实现的最小 MSE。开销成本 $c_0$ 没有出现在极限中，因为对于大的 $T$，与 $c_1 T$ 项相比，它变得可以忽略不计。",
            "answer": "$$\\boxed{\\frac{R^{2} c_{1} \\Theta}{B}}$$"
        }
    ]
}