{
    "hands_on_practices": [
        {
            "introduction": "掌握一个新概念的最佳方式是从最简单的例子入手。本练习 () 将使用作为许多离散模型基础的伯努利分布，从第一性原理推导得分函数以及核心的似然比恒等式，为你理解和应用得分函数法打下坚实的基础。",
            "id": "3337816",
            "problem": "考虑一个单个随机变量 $X$，其服从参数为 $p \\in (0,1)$ 的伯努利分布，概率质量函数为 $f_{p}(x) = p^{x} (1-p)^{1-x}$，其中 $x \\in \\{0,1\\}$。令得分函数定义为 $S_{p}(X) = \\partial_{p} \\ln f_{p}(X)$。从对数似然的定义出发，并且不使用任何与似然比方法相关的预先给定的公式，首先推导出一个用 $X$ 和 $p$ 表示的 $S_{p}(X)$ 的显式表达式。接下来，仅使用期望的定义 $\\mathbb{E}_{p}[h(X)] = \\sum_{x \\in \\{0,1\\}} h(x) f_{p}(x)$ 以及在适当的正则性条件下微分和求和可以互换的有效性，对于一个通用的可测函数 $h$，推导一个将 $\\partial_{p} \\mathbb{E}_{p}[h(X)]$ 与一个涉及 $S_{p}(X)$ 的期望联系起来的恒等式。最后，将 $h(X)$ 特化为 $\\mathbf{1}\\{X=1\\}$，并使用你推导出的似然比(LR)恒等式来计算 $\\partial_{p} \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\}]$。将你的最终答案以单个精确的实数形式给出，不带单位。",
            "solution": "用户提供的问题被评估为有效。其科学基础在于概率论和统计学，问题表述清晰，包含所有必要信息，并以客观、正式的语言陈述。该问题要求从第一性原理出发，为伯努利随机变量推导得分函数和似然比恒等式，然后应用该恒等式。这是随机模拟领域一个标准且可验证的练习。我们现在开始解答。\n\n这个问题分为三个部分。首先，我们必须推导得分函数 $S_{p}(X)$ 的一个显式表达式。其次，我们推导似然比(LR)恒等式，它将一个期望的导数与一个涉及得分函数的期望联系起来。第三，我们将此恒等式应用于特定函数 $h(X) = \\mathbf{1}\\{X=1\\}$ 来计算该导数。\n\n**第一部分：得分函数 $S_{p}(X)$ 的推导**\n\n随机变量 $X$ 服从参数为 $p \\in (0,1)$ 的伯努利分布。其概率质量函数(PMF)由下式给出：\n$$f_{p}(x) = p^{x} (1-p)^{1-x}, \\quad \\text{for } x \\in \\{0, 1\\}$$\n得分函数 $S_{p}(X)$ 定义为对数似然函数关于参数 $p$ 的偏导数。首先，我们求对数似然函数 $\\ln f_{p}(x)$：\n$$ \\ln f_{p}(x) = \\ln(p^{x} (1-p)^{1-x}) $$\n利用对数的性质，上式可简化为：\n$$ \\ln f_{p}(x) = x \\ln(p) + (1-x) \\ln(1-p) $$\n现在，我们对这个表达式关于 $p$ 求导：\n$$ \\partial_{p} \\ln f_{p}(x) = \\partial_{p} [x \\ln(p) + (1-x) \\ln(1-p)] $$\n$$ \\partial_{p} \\ln f_{p}(x) = x \\cdot \\frac{1}{p} + (1-x) \\cdot \\frac{1}{1-p} \\cdot (-1) $$\n$$ \\partial_{p} \\ln f_{p}(x) = \\frac{x}{p} - \\frac{1-x}{1-p} $$\n根据定义，得分函数为 $S_{p}(X) = \\partial_{p} \\ln f_{p}(X)$。因此，将具体结果 $x$ 替换为随机变量 $X$，我们得到得分函数的表达式：\n$$ S_{p}(X) = \\frac{X}{p} - \\frac{1-X}{1-p} $$\n\n**第二部分：似然比(LR)恒等式的推导**\n\n题目要求我们对于一个通用的可测函数 $h$，推导一个将 $\\partial_{p} \\mathbb{E}_{p}[h(X)]$ 与一个涉及 $S_{p}(X)$ 的期望联系起来的恒等式。我们从 $h(X)$ 的期望的定义开始：\n$$ \\mathbb{E}_{p}[h(X)] = \\sum_{x \\in \\{0,1\\}} h(x) f_{p}(x) $$\n然后我们对这个表达式关于 $p$ 求导：\n$$ \\partial_{p} \\mathbb{E}_{p}[h(X)] = \\partial_{p} \\left[ \\sum_{x \\in \\{0,1\\}} h(x) f_{p}(x) \\right] $$\n题目说明我们可以交换微分和求和的运算。这是一个关键步骤，被称为“对数求导技巧”或“似然比方法”：\n$$ \\partial_{p} \\mathbb{E}_{p}[h(X)] = \\sum_{x \\in \\{0,1\\}} h(x) \\left( \\partial_{p} f_{p}(x) \\right) $$\n我们可以使用应用于对数的链式求导法则来重写PMF的导数 $\\partial_{p} f_{p}(x)$：$\\partial_z \\ln(y) = \\frac{1}{y} \\partial_z y$，这意味着 $\\partial_z y = y \\cdot (\\partial_z \\ln y)$。应用该法则，我们得到：\n$$ \\partial_{p} f_{p}(x) = f_{p}(x) \\cdot (\\partial_{p} \\ln f_{p}(x)) $$\n项 $\\partial_{p} \\ln f_{p}(x)$ 正是在 $x$ 处求值的得分函数，我们将其记为 $S_p(x)$。将其代回求和式中，得到：\n$$ \\partial_{p} \\mathbb{E}_{p}[h(X)] = \\sum_{x \\in \\{0,1\\}} h(x) f_{p}(x) S_{p}(x) $$\n根据定义，右侧的表达式是随机变量 $h(X)S_p(X)$ 的期望。因此，我们推导出了通用的似然比恒等式：\n$$ \\partial_{p} \\mathbb{E}_{p}[h(X)] = \\mathbb{E}_{p}[h(X) S_{p}(X)] $$\n\n**第三部分：特化与最终计算**\n\n最后，我们必须使用在第二部分推导出的LR恒等式来计算 $\\partial_{p} \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\}]$。令 $h(X) = \\mathbf{1}\\{X=1\\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n应用LR恒等式，我们有：\n$$ \\partial_{p} \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\}] = \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\} S_{p}(X)] $$\n我们使用其定义来计算右侧的期望：\n$$ \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\} S_{p}(X)] = \\sum_{x \\in \\{0,1\\}} \\mathbf{1}\\{x=1\\} S_{p}(x) f_{p}(x) $$\n项 $\\mathbf{1}\\{x=1\\}$ 在 $x=0$ 时为零，在 $x=1$ 时为一。因此，求和式简化为对应于 $x=1$ 的单个项：\n$$ \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\} S_{p}(X)] = \\mathbf{1}\\{0=1\\} S_{p}(0) f_{p}(0) + \\mathbf{1}\\{1=1\\} S_{p}(1) f_{p}(1) $$\n$$ = (0) \\cdot S_{p}(0) f_{p}(0) + (1) \\cdot S_{p}(1) f_{p}(1) = S_{p}(1) f_{p}(1) $$\n现在我们需要 $S_{p}(1)$ 和 $f_{p}(1)$ 的具体值。\n从第一部分可知，得分函数为 $S_{p}(x) = \\frac{x}{p} - \\frac{1-x}{1-p}$。当 $x=1$ 时，得到：\n$$ S_{p}(1) = \\frac{1}{p} - \\frac{1-1}{1-p} = \\frac{1}{p} - 0 = \\frac{1}{p} $$\n当 $x=1$ 时的PMF为：\n$$ f_{p}(1) = p^{1} (1-p)^{1-1} = p \\cdot (1-p)^{0} = p $$\n将这些结果代回我们的表达式中：\n$$ \\partial_{p} \\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\}] = S_{p}(1) f_{p}(1) = \\left(\\frac{1}{p}\\right) \\cdot (p) = 1 $$\n结果是一个与 $p$ 无关的常数。这可以通过直接计算来验证：$\\mathbb{E}_{p}[\\mathbf{1}\\{X=1\\}] = P(X=1) = p$，且 $\\partial_{p}(p) = 1$。我们使用得分函数方法的推导得出了正确的结果。最终的数值答案是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在掌握了离散情形后，下一步自然是探究得分函数法如何应用于连续随机变量。本练习 () 将采用无处不在的正态分布，计算其二阶矩的导数，这不仅展示了该方法的多功能性，也将在积分的背景下巩固你对核心“对数导数技巧”的理解。",
            "id": "3337798",
            "problem": "考虑一个单参数概率密度族，用于实值随机变量 $X$。该族由均值参数为 $\\mu \\in \\mathbb{R}$、方差为已知常数 $\\sigma^{2} \\in (0,\\infty)$ 的正态分布给出，其密度为\n$$\nf_{\\mu}(x) \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right), \\quad x \\in \\mathbb{R}.\n$$\n参数 $\\mu$ 的得分函数（似然比）定义为 $S_{\\mu}(x) \\equiv \\partial_{\\mu}\\ln f_{\\mu}(x)$。仅使用得分函数的定义、期望的表示 $\\mathbb{E}_{\\mu}[h(X)] = \\int_{\\mathbb{R}} h(x) f_{\\mu}(x)\\,dx$，以及在适当的正则性条件下微分与积分可交换的合理假设，完成以下任务：\n\n- 显式计算 $S_{\\mu}(X)$。\n- 应用得分函数法推导 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$ 的精确表达式，该表达式仅用 $\\mu$ 和 $\\sigma$ 表示。\n\n假设对于所考虑的正态分布族和被积函数，交换微分和积分所需的任何正则性条件均已满足。最终答案仅报告 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$ 的值。请用精确的封闭形式表示你的答案，无需四舍五入。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   一个用于实值随机变量 $X$ 的单参数概率密度族是正态分布 $N(\\mu, \\sigma^2)$，其密度为：\n    $$f_{\\mu}(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right), \\quad x \\in \\mathbb{R}$$\n-   均值参数为 $\\mu \\in \\mathbb{R}$。\n-   方差为已知常数 $\\sigma^{2} \\in (0,\\infty)$。\n-   得分函数定义为 $S_{\\mu}(x) \\equiv \\partial_{\\mu}\\ln f_{\\mu}(x)$。\n-   期望定义为 $\\mathbb{E}_{\\mu}[h(X)] = \\int_{\\mathbb{R}} h(x) f_{\\mu}(x)\\,dx$。\n-   假设交换微分和积分所需的任何正则性条件均已满足。\n-   任务是计算 $S_{\\mu}(X)$，然后使用得分函数法推导 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$ 的表达式。\n-   最终报告的答案应仅为 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$ 的值。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题基于概率论和统计学中基本且公认的概念，即正态分布、期望和得分函数（似然比）法。这些是数理统计和随机模拟中的标准课题。\n-   **适定性**：问题陈述清晰。所有必要的定义都已提供，待计算的量是明确的。正则性条件的假设简化了分析，并确保可以应用标准方法，而无需证明底层的测度论条件，从而使问题自洽且可解。存在唯一解。\n-   **客观性**：问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n\n该问题没有验证清单中列出的任何缺陷。它科学合理、适定、客观，并与得分函数法的主题直接相关。\n\n**步骤3：结论与行动**\n\n该问题被判定为**有效**。将提供完整解答。\n\n### 解答\n\n解答过程按问题要求分为两部分。首先，我们计算得分函数 $S_{\\mu}(X)$。其次，我们应用得分函数法求出 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$ 的表达式。\n\n**第一部分：计算得分函数**\n\n得分函数定义为 $S_{\\mu}(x) = \\partial_{\\mu}\\ln f_{\\mu}(x)$。我们首先对概率密度函数 $f_{\\mu}(x)$ 取自然对数：\n$$ \\ln f_{\\mu}(x) = \\ln\\left( \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right) \\right) $$\n利用对数的性质，我们可以简化此表达式：\n$$ \\ln f_{\\mu}(x) = \\ln\\left((2\\pi\\sigma^2)^{-1/2}\\right) - \\frac{(x-\\mu)^2}{2\\sigma^2} = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(x-\\mu)^2}{2\\sigma^2} $$\n现在，我们对 $\\ln f_{\\mu}(x)$ 关于参数 $\\mu$ 求导。由于 $\\sigma^2$ 是已知的，项 $-\\frac{1}{2}\\ln(2\\pi\\sigma^2)$ 关于 $\\mu$ 是常数。\n$$ S_{\\mu}(x) = \\partial_{\\mu} \\left( -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(x-\\mu)^2}{2\\sigma^2} \\right) = 0 - \\frac{1}{2\\sigma^2} \\partial_{\\mu}\\left((x-\\mu)^2\\right) $$\n使用链式法则求导，我们有 $\\partial_{\\mu}(x-\\mu)^2 = 2(x-\\mu) \\cdot (-1) = -2(x-\\mu)$。\n将其代回，我们得到得分函数：\n$$ S_{\\mu}(x) = -\\frac{1}{2\\sigma^2}(-2(x-\\mu)) = \\frac{x-\\mu}{\\sigma^2} $$\n在随机变量 $X$ 处取值，得分函数为 $S_{\\mu}(X) = \\frac{X-\\mu}{\\sigma^2}$。\n\n**第二部分：应用得分函数法**\n\n问题要求使用得分函数法推导 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$。该方法，也称为似然比法，将期望的导数表示为另一个期望。我们从 $\\mathbb{E}_{\\mu}[h(X)]$ 的定义出发，并对 $\\mu$ 求导：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[h(X)] = \\partial_{\\mu} \\int_{\\mathbb{R}} h(x) f_{\\mu}(x)\\,dx $$\n问题陈述中说明，我们可以假设正则性条件已满足，从而可以交换导数和积分（莱布尼茨积分法则）：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[h(X)] = \\int_{\\mathbb{R}} h(x) \\left(\\partial_{\\mu}f_{\\mu}(x)\\right)\\,dx $$\n使用恒等式 $\\partial_{\\mu}f_{\\mu}(x) = f_{\\mu}(x) \\cdot \\partial_{\\mu}\\ln f_{\\mu}(x) = f_{\\mu}(x)S_{\\mu}(x)$，我们可以重写该积分：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[h(X)] = \\int_{\\mathbb{R}} h(x) S_{\\mu}(x) f_{\\mu}(x)\\,dx $$\n根据定义，此积分为乘积 $h(X)S_{\\mu}(X)$ 关于密度 $f_{\\mu}(x)$ 的期望。因此，我们得到得分函数恒等式：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[h(X)] = \\mathbb{E}_{\\mu}[h(X)S_{\\mu}(X)] $$\n对于本题，我们关心的是 $h(X) = X^2$。应用该恒等式：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = \\mathbb{E}_{\\mu}[X^2 S_{\\mu}(X)] $$\n代入 $S_{\\mu}(X) = \\frac{X-\\mu}{\\sigma^2}$ 的表达式：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = \\mathbb{E}_{\\mu}\\left[X^2 \\left(\\frac{X-\\mu}{\\sigma^2}\\right)\\right] = \\frac{1}{\\sigma^2}\\mathbb{E}_{\\mu}[X^2(X-\\mu)] $$\n利用期望的线性性质：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = \\frac{1}{\\sigma^2}\\left(\\mathbb{E}_{\\mu}[X^3] - \\mu\\mathbb{E}_{\\mu}[X^2]\\right) $$\n为了继续，我们需要正态分布 $X \\sim N(\\mu, \\sigma^2)$ 的二阶矩和三阶矩。\n二阶矩 $\\mathbb{E}_{\\mu}[X^2]$ 可以从方差的定义 $\\text{Var}_{\\mu}(X) = \\mathbb{E}_{\\mu}[X^2] - (\\mathbb{E}_{\\mu}[X])^2$ 中求得。已知 $\\mathbb{E}_{\\mu}[X] = \\mu$ 和 $\\text{Var}_{\\mu}(X) = \\sigma^2$，我们有：\n$$ \\mathbb{E}_{\\mu}[X^2] = \\text{Var}_{\\mu}(X) + (\\mathbb{E}_{\\mu}[X])^2 = \\sigma^2 + \\mu^2 $$\n三阶矩 $\\mathbb{E}_{\\mu}[X^3]$ 可以通过考虑中心矩来计算。我们展开 $X^3 = ((X-\\mu)+\\mu)^3$：\n$$ \\mathbb{E}_{\\mu}[X^3] = \\mathbb{E}_{\\mu}[((X-\\mu)+\\mu)^3] = \\mathbb{E}_{\\mu}[(X-\\mu)^3 + 3\\mu(X-\\mu)^2 + 3\\mu^2(X-\\mu) + \\mu^3] $$\n根据期望的线性性质：\n$$ \\mathbb{E}_{\\mu}[X^3] = \\mathbb{E}_{\\mu}[(X-\\mu)^3] + 3\\mu\\mathbb{E}_{\\mu}[(X-\\mu)^2] + 3\\mu^2\\mathbb{E}_{\\mu}[X-\\mu] + \\mathbb{E}_{\\mu}[\\mu^3] $$\n我们使用正态分布的以下标准性质：\n-   一阶中心矩为 $\\mathbb{E}_{\\mu}[X-\\mu] = \\mathbb{E}_{\\mu}[X] - \\mu = \\mu - \\mu = 0$。\n-   二阶中心矩是方差，$\\mathbb{E}_{\\mu}[(X-\\mu)^2] = \\sigma^2$。\n-   三阶中心矩 $\\mathbb{E}_{\\mu}[(X-\\mu)^3]$ 为零，因为正态分布是关于其均值对称的。对称分布的所有奇数阶中心矩均为零。\n代入这些值：\n$$ \\mathbb{E}_{\\mu}[X^3] = 0 + 3\\mu(\\sigma^2) + 3\\mu^2(0) + \\mu^3 = 3\\mu\\sigma^2 + \\mu^3 $$\n现在我们将二阶矩和三阶矩的表达式代回到我们关于 $\\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}]$ 的方程中：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = \\frac{1}{\\sigma^2}\\left( (3\\mu\\sigma^2 + \\mu^3) - \\mu(\\sigma^2 + \\mu^2) \\right) $$\n展开括号内的项：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = \\frac{1}{\\sigma^2}\\left( 3\\mu\\sigma^2 + \\mu^3 - \\mu\\sigma^2 - \\mu^3 \\right) $$\n$\\mu^3$ 项相互抵消，我们合并 $\\mu\\sigma^2$ 项：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = \\frac{1}{\\sigma^2}\\left( 2\\mu\\sigma^2 \\right) $$\n最后，简化表达式得到结果：\n$$ \\partial_{\\mu}\\,\\mathbb{E}_{\\mu}[X^{2}] = 2\\mu $$\n这个结果可以通过直接对二阶矩的表达式 $\\mathbb{E}_{\\mu}[X^2] = \\sigma^2 + \\mu^2$ 关于 $\\mu$ 求导来验证，得到 $\\partial_{\\mu}(\\sigma^2 + \\mu^2) = 2\\mu$。这证实了我们使用得分函数法的推导是正确的。",
            "answer": "$$\\boxed{2\\mu}$$"
        },
        {
            "introduction": "得分函数法的一个众所周知的挑战是其估计量可能具有很高的方差。这项进阶练习 () 介绍了一种使用恒定基线的强大方差缩减技术，你将通过推导最小化估计量方差的最优基线，掌握一个使蒙特卡洛估计更高效、更可靠的关键工具。",
            "id": "3337807",
            "problem": "考虑一个实值随机变量 $X$ 的单参数概率密度族，由正态分布 $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$ 给出，其中 $\\mu \\in \\mathbb{R}$ 是均值，$\\sigma^{2}  0$ 是方差。令 $h(X) = X^3$ 并定义参数期望 $\\mathbb{E}_{\\mu}[h(X)] = \\int h(x) f_{\\mu}(x) \\,\\mathrm{d}x$，其中 $f_{\\mu}(x)$ 是均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态密度。\n\n使用得分函数（似然比）方法，可以通过将积分项 $h(X)$ 与得分函数 $s_{\\mu}(X) = \\partial_{\\mu} \\ln f_{\\mu}(X)$ 相乘，来通过蒙特卡洛方法估计梯度 $\\partial_{\\mu} \\mathbb{E}_{\\mu}[h(X)]$。一种常见的方差缩减技术是从 $h(X)$ 中减去一个常数基线 $b$，并使用估计量 $(h(X) - b) \\, s_{\\mu}(X)$；基线 $b$ 不依赖于样本 $X$。\n\n从第一性原理出发——即得分函数的定义、参数化期望微分的似然比恒等式以及正态分布矩的性质——推导出在此设置下，能使 $\\partial_{\\mu} \\mathbb{E}_{\\mu}[h(X)]$ 的似然比估计量方差最小化的常数基线 $b^{\\star}(\\mu,\\sigma)$ 的表达式。然后，为 $h(X) = X^3$ 和 $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$ 的情况，显式计算这个最优基线。\n\n你的最终答案必须是关于 $\\mu$ 和 $\\sigma$ 的单一闭式解析表达式，不得有任何数值近似。",
            "solution": "该问题要求推导最优常数基线 $b^{\\star}$，该基线能最小化参数期望梯度的得分函数估计量的方差，然后针对一个具体案例计算该基线。\n\n这个问题是有效的，因为它在科学上基于蒙特卡洛方法的理论，问题提法良好，并且提供了所有必要的信息。我们可以开始求解。\n\n首先，我们推导最优基线 $b^{\\star}$ 的一般表达式。设 $X$ 是一个随机变量，其概率密度函数 $f_{\\theta}(x)$ 依赖于参数 $\\theta$。这里，参数是均值 $\\mu$，因此密度是 $f_{\\mu}(x)$。得分函数定义为 $s_{\\mu}(X) = \\partial_{\\mu} \\ln f_{\\mu}(X)$。似然比方法用于估计期望的梯度 $\\partial_{\\mu} \\mathbb{E}_{\\mu}[h(X)]$。其恒等式为 $\\partial_{\\mu} \\mathbb{E}_{\\mu}[h(X)] = \\mathbb{E}_{\\mu}[h(X)s_{\\mu}(X)]$。\n\n一种方差缩减技术引入了一个常数基线 $b$，得到一个新的估计量，其随机变量为 $Y(b) = (h(X) - b) s_{\\mu}(X)$。我们寻求找到 $b$ 的值，记为 $b^{\\star}$，使得方差 $\\mathrm{Var}_{\\mu}[Y(b)]$ 最小。\n\n首先，我们计算该估计量的期望。\n$$\n\\mathbb{E}_{\\mu}[Y(b)] = \\mathbb{E}_{\\mu}[(h(X) - b) s_{\\mu}(X)] = \\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)] - b \\mathbb{E}_{\\mu}[s_{\\mu}(X)]\n$$\n得分函数的一个基本性质是其期望为零。我们从第一性原理证明这一点。在允许交换微分和积分的正则性条件下（正态分布族对其均值满足此条件），我们有：\n$$\n\\mathbb{E}_{\\mu}[s_{\\mu}(X)] = \\int_{-\\infty}^{\\infty} s_{\\mu}(x) f_{\\mu}(x) \\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\partial_{\\mu} f_{\\mu}(x)}{f_{\\mu}(x)}\\right) f_{\\mu}(x) \\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\partial_{\\mu} f_{\\mu}(x) \\,\\mathrm{d}x\n$$\n$$\n= \\partial_{\\mu} \\int_{-\\infty}^{\\infty} f_{\\mu}(x) \\,\\mathrm{d}x = \\partial_{\\mu} (1) = 0\n$$\n因此，我们估计量的期望是：\n$$\n\\mathbb{E}_{\\mu}[Y(b)] = \\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)] - b \\cdot 0 = \\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)] = \\partial_{\\mu} \\mathbb{E}_{\\mu}[h(X)]\n$$\n这证实了对于任何常数基线 $b$，该估计量都是无偏的。\n\n该估计量的方差由 $\\mathrm{Var}_{\\mu}[Y(b)] = \\mathbb{E}_{\\mu}[Y(b)^2] - (\\mathbb{E}_{\\mu}[Y(b)])^2$ 给出。由于均值 $\\mathbb{E}_{\\mu}[Y(b)]$ 不依赖于 $b$，最小化方差等价于最小化二阶矩 $\\mathbb{E}_{\\mu}[Y(b)^2]$。我们将这个二阶矩定义为 $b$ 的函数：\n$$\nM_2(b) = \\mathbb{E}_{\\mu}[Y(b)^2] = \\mathbb{E}_{\\mu}[((h(X) - b)s_{\\mu}(X))^2] = \\mathbb{E}_{\\mu}[(h(X)^2 - 2bh(X) + b^2) s_{\\mu}(X)^2]\n$$\n根据期望的线性性质，我们可以展开这个表达式：\n$$\nM_2(b) = \\mathbb{E}_{\\mu}[h(X)^2 s_{\\mu}(X)^2] - 2b \\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)^2] + b^2 \\mathbb{E}_{\\mu}[s_{\\mu}(X)^2]\n$$\n这是关于 $b$ 的二次函数。为了找到最小值，我们对 $b$ 求导并令其为零：\n$$\n\\frac{\\mathrm{d} M_2(b)}{\\mathrm{d}b} = -2 \\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)^2] + 2b \\mathbb{E}_{\\mu}[s_{\\mu}(X)^2] = 0\n$$\n解出 $b$ 得到最优基线 $b^{\\star}$：\n$$\nb^{\\star} = \\frac{\\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)^2]}{\\mathbb{E}_{\\mu}[s_{\\mu}(X)^2]}\n$$\n这就是最优常数基线的一般表达式。\n\n现在，我们将此公式应用于 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，$h(X) = X^3$，且感兴趣的参数是 $\\mu$ 的具体情况。\n\n1.  **计算得分函数 $s_{\\mu}(X)$**。\n    $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数是：\n    $$\n    f_{\\mu}(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)\n    $$\n    对数似然是：\n    $$\n    \\ln f_{\\mu}(x) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(x - \\mu)^2}{2\\sigma^2}\n    $$\n    得分函数是关于 $\\mu$ 的偏导数：\n    $$\n    s_{\\mu}(x) = \\partial_{\\mu} \\ln f_{\\mu}(x) = -\\frac{1}{2\\sigma^2} \\partial_{\\mu}[ (x - \\mu)^2 ] = -\\frac{1}{2\\sigma^2} [2(x-\\mu)(-1)] = \\frac{x - \\mu}{\\sigma^2}\n    $$\n    因此，对于随机变量 $X$，我们有 $s_{\\mu}(X) = \\frac{X - \\mu}{\\sigma^2}$。\n\n2.  **计算分母 $\\mathbb{E}_{\\mu}[s_{\\mu}(X)^2]$**。\n    $$\n    \\mathbb{E}_{\\mu}[s_{\\mu}(X)^2] = \\mathbb{E}_{\\mu}\\left[\\left(\\frac{X - \\mu}{\\sigma^2}\\right)^2\\right] = \\frac{1}{\\sigma^4} \\mathbb{E}_{\\mu}[(X - \\mu)^2]\n    $$\n    项 $\\mathbb{E}_{\\mu}[(X - \\mu)^2]$ 是 $X$ 的方差的定义，即 $\\sigma^2$。\n    $$\n    \\mathbb{E}_{\\mu}[s_{\\mu}(X)^2] = \\frac{\\sigma^2}{\\sigma^4} = \\frac{1}{\\sigma^2}\n    $$\n\n3.  **计算分子 $\\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)^2]$**。\n    当 $h(X) = X^3$ 时，表达式为：\n    $$\n    \\mathbb{E}_{\\mu}[X^3 s_{\\mu}(X)^2] = \\mathbb{E}_{\\mu}\\left[X^3 \\left(\\frac{X - \\mu}{\\sigma^2}\\right)^2\\right] = \\frac{1}{\\sigma^4} \\mathbb{E}_{\\mu}[X^3 (X - \\mu)^2]\n    $$\n    展开期望内的项：\n    $$\n    \\mathbb{E}_{\\mu}[X^3 (X^2 - 2\\mu X + \\mu^2)] = \\mathbb{E}_{\\mu}[X^5 - 2\\mu X^4 + \\mu^2 X^3]\n    $$\n    利用期望的线性性质，我们需要计算 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的三阶、四阶和五阶矩。令 $Z \\sim \\mathcal{N}(0, 1)$ 为标准正态变量。那么 $X = \\mu + \\sigma Z$。$Z$ 的原点矩为 $\\mathbb{E}[Z]=0, \\mathbb{E}[Z^2]=1, \\mathbb{E}[Z^3]=0, \\mathbb{E}[Z^4]=3, \\mathbb{E}[Z^5]=0$。\n\n    -   **X 的三阶矩**:\n        $\\mathbb{E}_{\\mu}[X^3] = \\mathbb{E}[(\\mu + \\sigma Z)^3] = \\mathbb{E}[\\mu^3 + 3\\mu^2\\sigma Z + 3\\mu\\sigma^2 Z^2 + \\sigma^3 Z^3]$\n        $= \\mu^3 + 3\\mu^2\\sigma \\mathbb{E}[Z] + 3\\mu\\sigma^2 \\mathbb{E}[Z^2] + \\sigma^3 \\mathbb{E}[Z^3] = \\mu^3 + 0 + 3\\mu\\sigma^2(1) + 0 = \\mu^3 + 3\\mu\\sigma^2$。\n\n    -   **X 的四阶矩**:\n        $\\mathbb{E}_{\\mu}[X^4] = \\mathbb{E}[(\\mu + \\sigma Z)^4] = \\mathbb{E}[\\mu^4 + 4\\mu^3\\sigma Z + 6\\mu^2\\sigma^2 Z^2 + 4\\mu\\sigma^3 Z^3 + \\sigma^4 Z^4]$\n        $= \\mu^4 + 6\\mu^2\\sigma^2 \\mathbb{E}[Z^2] + \\sigma^4 \\mathbb{E}[Z^4] = \\mu^4 + 6\\mu^2\\sigma^2(1) + \\sigma^4(3) = \\mu^4 + 6\\mu^2\\sigma^2 + 3\\sigma^4$。\n\n    -   **X 的五阶矩**:\n        $\\mathbb{E}_{\\mu}[X^5] = \\mathbb{E}[(\\mu + \\sigma Z)^5] = \\mathbb{E}[\\binom{5}{0}\\mu^5 Z^0 + \\binom{5}{1}\\mu^4\\sigma Z^1 + \\binom{5}{2}\\mu^3\\sigma^2 Z^2 + \\binom{5}{3}\\mu^2\\sigma^3 Z^3 + \\binom{5}{4}\\mu\\sigma^4 Z^4 + \\binom{5}{5}\\sigma^5 Z^5]$\n        $= \\mu^5 + 10\\mu^3\\sigma^2 \\mathbb{E}[Z^2] + 5\\mu\\sigma^4 \\mathbb{E}[Z^4] = \\mu^5 + 10\\mu^3\\sigma^2(1) + 5\\mu\\sigma^4(3) = \\mu^5 + 10\\mu^3\\sigma^2 + 15\\mu\\sigma^4$。\n\n    现在，将这些矩代回：\n    $$\n    \\mathbb{E}_{\\mu}[X^5 - 2\\mu X^4 + \\mu^2 X^3] = (\\mu^5 + 10\\mu^3\\sigma^2 + 15\\mu\\sigma^4) - 2\\mu(\\mu^4 + 6\\mu^2\\sigma^2 + 3\\sigma^4) + \\mu^2(\\mu^3 + 3\\mu\\sigma^2)\n    $$\n    $$\n    = \\mu^5 + 10\\mu^3\\sigma^2 + 15\\mu\\sigma^4 - 2\\mu^5 - 12\\mu^3\\sigma^2 - 6\\mu\\sigma^4 + \\mu^5 + 3\\mu^3\\sigma^2\n    $$\n    按 $\\mu$ 和 $\\sigma$ 的幂次分组：\n    $$\n    = (\\mu^5 - 2\\mu^5 + \\mu^5) + (10\\mu^3\\sigma^2 - 12\\mu^3\\sigma^2 + 3\\mu^3\\sigma^2) + (15\\mu\\sigma^4 - 6\\mu\\sigma^4)\n    $$\n    $$\n    = 0 + \\mu^3\\sigma^2 + 9\\mu\\sigma^4 = \\mu^3\\sigma^2 + 9\\mu\\sigma^4\n    $$\n    那么分子是：\n    $$\n    \\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)^2] = \\frac{1}{\\sigma^4}(\\mu^3\\sigma^2 + 9\\mu\\sigma^4) = \\frac{\\mu^3}{\\sigma^2} + 9\\mu\n    $$\n\n4.  **结合分子和分母求得 $b^{\\star}$**。\n    $$\n    b^{\\star} = \\frac{\\mathbb{E}_{\\mu}[h(X) s_{\\mu}(X)^2]}{\\mathbb{E}_{\\mu}[s_{\\mu}(X)^2]} = \\frac{\\frac{\\mu^3}{\\sigma^2} + 9\\mu}{\\frac{1}{\\sigma^2}}\n    $$\n    分子和分母同乘以 $\\sigma^2$ 得到最优基线的最终表达式：\n    $$\n    b^{\\star} = \\mu^3 + 9\\mu\\sigma^2\n    $$",
            "answer": "$$\\boxed{\\mu^3 + 9\\mu\\sigma^2}$$"
        }
    ]
}