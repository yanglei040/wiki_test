{
    "hands_on_practices": [
        {
            "introduction": "Thinning 算法是模拟泊松随机测度 (Poisson Random Measure) 的一种强大通用方法，而泊松随机测度是纯跳跃 Lévy 过程的基础。在实施复杂的模拟之前，理解其计算成本至关重要。本练习  要求您推导特定 thinning 方案的期望提议数，从而将 Lévy 测度的理论参数与模拟的实际成本直接联系起来。",
            "id": "3342818",
            "problem": "考虑乘积空间 $[0,t] \\times \\mathbb{R} \\setminus \\{0\\}$ 上的一个泊松随机测度 (PRM)，其强度测度为 $\\mathrm{d}s \\, \\nu(\\mathrm{d}x)$，其中 Lévy 密度由下式给出\n$$\n\\nu(\\mathrm{d}x) = \\left( C |x|^{-1-\\alpha} \\mathbf{1}_{\\{|x|1\\}} + D \\, e^{-\\lambda |x|} \\mathbf{1}_{\\{|x|\\ge 1\\}} \\right) \\mathrm{d}x,\n$$\n其中参数 $C0$，$\\alpha0$，$D \\ge 0$ 且 $\\lambda0$。当 $C0$ 和 $\\alpha0$ 时，该 PRM 生成一个在原点附近具有无限活动性的纯跳 Lévy 过程的跳跃。为了进行模拟，通常会引入一个截断阈值 $\\varepsilon \\in (0,1)$，并且只模拟幅度至少为 $\\varepsilon$ 的跳跃，而对小跳 $\\{|x|\\varepsilon\\}$ 的贡献则通过近似处理，这超出了本任务的范围。\n\n请根据以下原则，构建一个自适应细化算法，以模拟在时间窗口 $[0,t]$ 内，对于 $|x|\\ge \\varepsilon$ 的跳跃大小：\n\n- 基本定义：一个在 $[0,t]\\times E$ 上，强度为 $\\mathrm{d}s\\,\\lambda(\\mathrm{d}x)$ 的泊松随机测度，可以通过从一个控制测度 $\\mathrm{d}s\\,\\mu(\\mathrm{d}x)$（其中 $\\mu(\\mathrm{d}x)\\ge \\lambda(\\mathrm{d}x)$）进行细化来模拟，即提出平均数量为 $t\\,\\mu(E)$ 的泊松数量个点，并以在 $x$ 处求值的概率 $\\lambda(\\mathrm{d}x)/\\mu(\\mathrm{d}x)$ 接受每个提出的点 $(s,x)$。\n\n- 状态变量中的自适应包络设计：\n  1. 在尾部区域 $\\{|x|\\ge 1\\}$，使用与 Lévy 密度相等的精确包络，$\\mu_{\\text{tail}}(\\mathrm{d}x) = D e^{-\\lambda |x|} \\mathbf{1}_{\\{|x|\\ge 1\\}} \\mathrm{d}x$。\n  2. 在截断的小跳区域 $\\{\\varepsilon \\le |x|  1\\}$，使用一个根据截断水平调整的分段常数包络，$\\mu_{\\text{small}}(\\mathrm{d}x) = C \\varepsilon^{-1-\\alpha} \\mathbf{1}_{\\{\\varepsilon \\le |x|  1\\}} \\mathrm{d}x$。\n\n在 $\\{|x|\\ge \\varepsilon\\}$ 上的组合包络为\n$$\n\\mu_\\varepsilon(\\mathrm{d}x) = C \\varepsilon^{-1-\\alpha} \\mathbf{1}_{\\{\\varepsilon \\le |x|  1\\}} \\mathrm{d}x \\;+\\; D e^{-\\lambda |x|} \\mathbf{1}_{\\{|x|\\ge 1\\}} \\mathrm{d}x,\n$$\n它在 $\\{|x|\\ge \\varepsilon\\}$ 上满足 $\\mu_\\varepsilon(\\mathrm{d}x) \\ge \\nu(\\mathrm{d}x)$。候选点从强度为 $\\mathrm{d}s\\,\\mu_\\varepsilon(\\mathrm{d}x)$ 的 PRM 中生成，并以接受概率 $\\nu(x)/\\mu_\\varepsilon(x)$ 进行细化。\n\n你的任务是，根据此算法，从第一性原理分析候选点的期望数量作为时间范围 $t$ 的函数，并实现一个程序，对每个指定的参数集，返回在 $[0,t]$ 内候选点的期望数量。分析必须从泊松随机测度的定义和细化原则开始。使用候选点的期望数量等于包络测度在 $[0,t]\\times \\{|x|\\ge \\varepsilon\\}$ 上的总质量这一性质。\n\n对于上面给出的自适应包络，推导一个关于 $[0,t]$ 上候选点期望数量的闭式表达式，该表达式是 $t$、$C$、$\\alpha$、$D$、$\\lambda$ 和 $\\varepsilon$ 的函数。然后，实现一个程序，为以下每个测试用例计算该值：\n\n- 测试用例 1：$(C,\\alpha,D,\\lambda,t,\\varepsilon) = (\\,0.5,\\,0.7,\\,0.8,\\,1.2,\\,3.5,\\,0.01\\,)$。\n- 测试用例 2：$(C,\\alpha,D,\\lambda,t,\\varepsilon) = (\\,1.2,\\,1.5,\\,0.3,\\,0.9,\\,1.0,\\,0.001\\,)$。\n- 测试用例 3：$(C,\\alpha,D,\\lambda,t,\\varepsilon) = (\\,0.0,\\,1.0,\\,1.0,\\,2.0,\\,10.0,\\,0.1\\,)$。\n- 测试用例 4：$(C,\\alpha,D,\\lambda,t,\\varepsilon) = (\\,1.0,\\,0.3,\\,0.0,\\,1.0,\\,2.0,\\,0.2\\,)$。\n- 测试用例 5：$(C,\\alpha,D,\\lambda,t,\\varepsilon) = (\\,2.0,\\,0.9,\\,0.5,\\,1.5,\\,0.75,\\,0.99\\,)$。\n\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中 $r_i$ 是测试用例 $i$ 的候选点期望数量，以浮点数表示。不涉及物理单位。不涉及角度。不要打印任何额外文本。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定且客观的。它植根于 Lévy 过程及其通过泊松随机测度模拟的成熟数学理论，提出了一个随机模拟领域的标准学术问题。所有参数和条件都已明确定义，且前提条件是内部一致的。因此，我们可以着手进行推导和求解。\n\n目标是找出通过自适应细化算法模拟 Lévy 过程在时间区间 $[0,t]$ 内的跳跃所生成的候选点的期望数量。该算法模拟幅度为 $|x| \\ge \\varepsilon$ 的跳跃，其中 $\\varepsilon \\in (0,1)$ 是一个截断阈值。\n\n根据泊松过程的基本原理，由一个在空间 $S$ 上强度测度为 $\\Lambda$ 的泊松随机测度 (PRM) 生成的点的期望数量，等于该测度的总质量，由积分 $\\int_S \\mathrm{d}\\Lambda$ 给出。\n\n在本问题中，候选点是从空间 $[0,t] \\times \\{x \\in \\mathbb{R} : |x| \\ge \\varepsilon\\}$ 上的一个 PRM 生成的。这些候选点的强度测度被指定为 $\\mathrm{d}s\\,\\mu_\\varepsilon(\\mathrm{d}x)$，其中 $\\mu_\\varepsilon(\\mathrm{d}x)$ 是对应于一个控制包络密度的测度。候选点的期望数量，记为 $\\mathbb{E}[N_{\\text{prop}}]$，是此强度测度在整个模拟域上的积分：\n$$\n\\mathbb{E}[N_{\\text{prop}}] = \\int_{0}^{t} \\int_{\\{x : |x| \\ge \\varepsilon\\}} \\mu_\\varepsilon(\\mathrm{d}x) \\, \\mathrm{d}s\n$$\n包络密度 $\\mu_\\varepsilon(x)$ 是给定的，并且不依赖于时间变量 $s$。因此，在时间区间 $[0,t]$ 上的积分可以分离出来，其值为 $t$：\n$$\n\\mathbb{E}[N_{\\text{prop}}] = t \\int_{\\{x : |x| \\ge \\varepsilon\\}} \\mu_\\varepsilon(\\mathrm{d}x)\n$$\n现在的任务简化为计算空间包络测度 $\\mu_\\varepsilon(\\mathrm{d}x)$ 在域 $\\{x : |x| \\ge \\varepsilon\\}$ 上的总质量。我们用 $\\Lambda_\\varepsilon$ 表示这个总质量，或总候选点率：\n$$\n\\Lambda_\\varepsilon = \\int_{\\{x : |x| \\ge \\varepsilon\\}} \\mu_\\varepsilon(\\mathrm{d}x)\n$$\n控制包络测度由其密度分段定义：\n$$\n\\mu_\\varepsilon(\\mathrm{d}x) = \\left( C \\varepsilon^{-1-\\alpha} \\mathbf{1}_{\\{\\varepsilon \\le |x|  1\\}} + D e^{-\\lambda |x|} \\mathbf{1}_{\\{|x|\\ge 1\\}} \\right) \\mathrm{d}x\n$$\n其中 $\\mathbf{1}_{A}$ 是集合 $A$ 的指示函数。积分域 $\\{x : |x| \\ge \\varepsilon\\}$ 是两个不相交集合的并集：$\\{\\varepsilon \\le |x|  1\\}$ 和 $\\{|x| \\ge 1\\}$。因此，我们可以将 $\\Lambda_\\varepsilon$ 的积分分成两部分：\n$$\n\\Lambda_\\varepsilon = \\int_{\\{\\varepsilon \\le |x|  1\\}} C \\varepsilon^{-1-\\alpha} \\mathrm{d}x + \\int_{\\{|x| \\ge 1\\}} D e^{-\\lambda |x|} \\mathrm{d}x\n$$\n我们分别计算每个积分。\n\n对于第一个积分，对应于截断的小跳区域，被积函数 $C \\varepsilon^{-1-\\alpha}$ 相对于积分变量 $x$ 是一个常数。积分域 $\\{\\varepsilon \\le |x|  1\\}$ 是 $(-1, -\\varepsilon] \\cup [\\varepsilon, 1)$。这个域的总长度（勒贝格测度）是 $(1 - \\varepsilon) + (1 - \\varepsilon) = 2(1-\\varepsilon)$。\n或者，我们可以利用被积函数的对称性，明确地表示积分：\n$$\n\\int_{\\{\\varepsilon \\le |x|  1\\}} C \\varepsilon^{-1-\\alpha} \\mathrm{d}x = 2 \\int_{\\varepsilon}^{1} C \\varepsilon^{-1-\\alpha} \\mathrm{d}x = 2 C \\varepsilon^{-1-\\alpha} \\int_{\\varepsilon}^{1} 1 \\, \\mathrm{d}x = 2 C \\varepsilon^{-1-\\alpha} [x]_{\\varepsilon}^{1} = 2 C \\varepsilon^{-1-\\alpha} (1-\\varepsilon)\n$$\n\n对于第二个积分，对应于大跳尾部区域，我们再次使用被积函数 $e^{-\\lambda |x|}$ 的对称性：\n$$\n\\int_{\\{|x| \\ge 1\\}} D e^{-\\lambda |x|} \\mathrm{d}x = 2 \\int_{1}^{\\infty} D e^{-\\lambda x} \\mathrm{d}x\n$$\n这是一个标准的指数积分：\n$$\n2 D \\int_{1}^{\\infty} e^{-\\lambda x} \\mathrm{d}x = 2 D \\left[ -\\frac{1}{\\lambda} e^{-\\lambda x} \\right]_{1}^{\\infty} = 2 D \\left( \\lim_{x\\to\\infty} \\left(-\\frac{e^{-\\lambda x}}{\\lambda}\\right) - \\left(-\\frac{e^{-\\lambda \\cdot 1}}{\\lambda}\\right) \\right)\n$$\n由于 $\\lambda > 0$，极限为 $0$。该积分的计算结果为：\n$$\n= 2 D \\left( 0 + \\frac{e^{-\\lambda}}{\\lambda} \\right) = \\frac{2D}{\\lambda}e^{-\\lambda}\n$$\n\n结合这两个结果，总空间候选点率 $\\Lambda_\\varepsilon$ 为：\n$$\n\\Lambda_\\varepsilon = 2 C (1-\\varepsilon) \\varepsilon^{-1-\\alpha} + \\frac{2D}{\\lambda}e^{-\\lambda}\n$$\n\n最后，将总空间候选点率 $\\Lambda_\\varepsilon$ 乘以时间长度 $t$，即可得到在时间区间 $[0,t]$ 内候选点的期望数量：\n$$\n\\mathbb{E}[N_{\\text{prop}}] = t \\, \\Lambda_\\varepsilon = t \\left( 2 C (1-\\varepsilon) \\varepsilon^{-1-\\alpha} + \\frac{2D}{\\lambda}e^{-\\lambda} \\right)\n$$\n这就是所要求的闭式表达式。提供的参数为 $C>0$ (或 $C=0$)，$\\alpha>0$，$D \\ge 0$，$\\lambda>0$，$t>0$ 和 $\\varepsilon \\in (0,1)$。该公式对于所有这些参数值都是良定义的。如果 $C=0$，第一项消失。如果 $D=0$，第二项消失。这两种情况都可由推导出的表达式正确处理。我们现在将实现此公式来计算给定测试用例的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected number of proposals for a Lévy process simulation\n    using an adaptive thinning algorithm based on a derived closed-form expression.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (C, alpha, D, lambda, t, epsilon)\n    test_cases = [\n        (0.5, 0.7, 0.8, 1.2, 3.5, 0.01),\n        (1.2, 1.5, 0.3, 0.9, 1.0, 0.001),\n        (0.0, 1.0, 1.0, 2.0, 10.0, 0.1),\n        (1.0, 0.3, 0.0, 1.0, 2.0, 0.2),\n        (2.0, 0.9, 0.5, 1.5, 0.75, 0.99),\n    ]\n\n    results = []\n    for case in test_cases:\n        C, alpha, D, lambda_param, t, epsilon = case\n\n        # The derived closed-form formula for the expected number of proposals is:\n        # E[N_prop] = t * (Lambda_small + Lambda_large)\n        # where Lambda_small = 2 * C * (1 - epsilon) * epsilon**(-1 - alpha)\n        # and Lambda_large = (2 * D / lambda) * exp(-lambda)\n\n        # Term for the small-jump region {epsilon = |x|  1}\n        # This term is zero if C is zero.\n        if C > 0:\n            term_small_jumps = 2 * C * (1 - epsilon) * (epsilon ** (-1 - alpha))\n        else:\n            term_small_jumps = 0.0\n        \n        # Term for the large-jump region {|x| >= 1}\n        # This term is zero if D is zero.\n        if D > 0:\n            term_large_jumps = (2 * D / lambda_param) * np.exp(-lambda_param)\n        else:\n            term_large_jumps = 0.0\n\n        # Total spatial proposal rate\n        total_spatial_rate = term_small_jumps + term_large_jumps\n        \n        # Expected number of proposals over time interval [0, t]\n        expected_proposals = t * total_spatial_rate\n        \n        results.append(expected_proposals)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于无限活动过程，我们无法模拟所有跳跃，这使得近似成为必要，例如截断，但这会引入系统误差（偏差）。本练习  提出了一个典型场景：从业者必须选择截断水平 $ \\varepsilon $。其目标是通过在忽略小跳跃产生的偏差与统计方差之间进行权衡，来最小化总误差，而统计方差取决于在固定计算预算下可承担的蒙特卡洛路径数量。",
            "id": "3342762",
            "problem": "考虑一个在固定时间域 $[0,T]$ 上的对称纯跳跃Lévy过程 $X = \\{X_t\\}_{t \\in [0,T]}$，其Lévy测度由 $\\nu(dx) = c\\,|x|^{-1-\\alpha}\\,\\mathbf{1}_{\\{|x|1\\}}\\,dx$ 给出，其中 $c0$ 和 $0\\alpha2$ 为常数。Lévy-Itô分解将 $X$ 表示为关于与 $\\nu$ 相关的泊松随机测度的随机积分，并且在 $[0,T]$ 上的跳跃贡献可以通过强度为 $T\\,\\nu(dx)$ 的泊松随机测度来描述。\n\n您的任务是通过蒙特卡洛模拟来估计在 $[0,T]$ 上的二次跳跃变差泛函，其定义为 $J_T = \\sum_{0s\\le T} (\\Delta X_s)^2$。由于该过程是无限活动性的，我们无法对所有跳跃求和，因此使用截断估计量 $J_T^\\varepsilon = \\sum_{0s\\le T, |\\Delta X_s| \\ge \\varepsilon} (\\Delta X_s)^2$ 来近似 $J_T$，其中 $\\varepsilon  0$ 是一个小的截断水平。\n该估计量 $\\hat{J}_T^\\varepsilon$ 的均方误差 (MSE) 由偏差的平方和方差组成：\n$$\n\\operatorname{MSE}(\\varepsilon) = (\\mathbb{E}[\\hat{J}_T^\\varepsilon] - J_T)^2 + \\operatorname{Var}(\\hat{J}_T^\\varepsilon)\n$$\n我们有以下标度关系：\n1.  **偏差**：截断引入的偏差来自于忽略小跳跃。对于小的 $\\varepsilon$，偏差的平方满足 $\\text{Bias}(\\varepsilon)^2 = (\\mathbb{E}[J_T^\\varepsilon] - J_T)^2 \\propto (\\varepsilon^{2-\\alpha})^2 = \\varepsilon^{4-2\\alpha}$。\n2.  **方差**：蒙特卡洛估计量的方差为 $\\operatorname{Var}(\\hat{J}_T^\\varepsilon) = \\frac{\\operatorname{Var}(J_T^\\varepsilon)}{N}$，其中 $N$ 是模拟路径的数量。我们假设对于小的 $\\varepsilon$，$\\operatorname{Var}(J_T^\\varepsilon)$ 近似为一个常数 $c_1$。\n3.  **成本**：总计算预算 $B$ 是固定的。假设每次模拟的计算成本 $C(\\varepsilon)$ 与模拟的跳跃率成正比。对于小的 $\\varepsilon$，跳跃率由最小的跳跃主导，因此 $C(\\varepsilon) \\propto \\int_{|x|\\ge\\varepsilon} \\nu(dx) \\propto \\varepsilon^{-\\alpha}$。因此，模拟路径的数量为 $N = B/C(\\varepsilon) \\propto B \\varepsilon^{\\alpha}$。\n\n结合这些关系，推导最佳截断水平 $\\varepsilon_{\\text{opt}}$，以 $\\alpha$ 和一些通用比例常数表示，该水平通过平衡偏差和方差来最小化总均方误差。",
            "solution": "### 问题分析与修正\n此问题旨在找到一个最佳截断水平 $\\varepsilon_{\\text{opt}}$，以最小化蒙特卡洛估计的均方误差(MSE)。MSE由两部分组成：偏差的平方和方差。\n\n1.  **偏差的平方 (Squared Bias)**\n    根据问题陈述和Lévy过程的性质，忽略大小在 $[-\\varepsilon, \\varepsilon]$ 内的跳跃所引入的偏差平方为：\n    $$ \\text{Bias}(\\varepsilon)^2 \\propto (\\varepsilon^{2-\\alpha})^2 = \\varepsilon^{4-2\\alpha} $$\n    我们可以将其写为 $\\text{Bias}(\\varepsilon)^2 = K_B \\varepsilon^{4-2\\alpha}$，其中 $K_B$ 是一个正的比例常数，依赖于 $c, T, \\alpha$。\n\n2.  **方差 (Variance)**\n    蒙特卡洛估计量的方差为：\n    $$ \\operatorname{Var}(\\hat{J}_T^\\varepsilon) = \\frac{\\operatorname{Var}(J_T^\\varepsilon)}{N} $$\n    问题假设 $\\operatorname{Var}(J_T^\\varepsilon) \\approx c_1$（一个常数）。\n    总预算 $B$ 是固定的，路径数量 $N$ 与单次模拟成本 $C(\\varepsilon)$ 的关系是 $N=B/C(\\varepsilon)$。\n    问题陈-述给出的成本模型是 $C(\\varepsilon) \\propto \\varepsilon^{-\\alpha}$，这是一个标准的物理模型，因为模拟更小的跳跃（即 $\\varepsilon \\to 0$）需要考虑更多的事件，从而增加计算成本。\n    所以，我们可以写出 $C(\\varepsilon) = K_C \\varepsilon^{-\\alpha}$，其中 $K_C$ 是成本比例常数。\n    因此，路径数量 $N = \\frac{B}{K_C \\varepsilon^{-\\alpha}} = \\frac{B}{K_C}\\varepsilon^\\alpha$。\n    将这些代入方差表达式：\n    $$ \\operatorname{Var}(\\hat{J}_T^\\varepsilon) \\approx \\frac{c_1}{N} = \\frac{c_1 K_C}{B} \\varepsilon^{-\\alpha} $$\n    我们可以将其写为 $\\operatorname{Var}(\\hat{J}_T^\\varepsilon) = K_V \\varepsilon^{-\\alpha}$，其中 $K_V = \\frac{c_1 K_C}{B}$ 是另一个正的比例常数。\n\n### 最小化均方误差\n现在，总的均方误差(MSE)是偏差平方和方差之和：\n$$ \\operatorname{MSE}(\\varepsilon) = K_B \\varepsilon^{4-2\\alpha} + K_V \\varepsilon^{-\\alpha} $$\n为了找到最小化 MSE 的 $\\varepsilon_{\\text{opt}}$，我们对 $\\operatorname{MSE}(\\varepsilon)$ 关于 $\\varepsilon$ 求导，并令其等于零。\n$$ \\frac{d}{d\\varepsilon} \\operatorname{MSE}(\\varepsilon) = \\frac{d}{d\\varepsilon} (K_B \\varepsilon^{4-2\\alpha} + K_V \\varepsilon^{-\\alpha}) = 0 $$\n$$ K_B (4-2\\alpha) \\varepsilon^{3-2\\alpha} + K_V (-\\alpha) \\varepsilon^{-\\alpha-1} = 0 $$\n由于我们要寻找一个权衡点，我们将两项移到等式两边：\n$$ K_B (4-2\\alpha) \\varepsilon^{3-2\\alpha} = K_V \\alpha \\varepsilon^{-\\alpha-1} $$\n由于 $0  \\alpha  2$，我们知道 $(4-2\\alpha)=2(2-\\alpha)0$ 且 $\\alpha0$。所有常数都是正的。现在，我们求解 $\\varepsilon$：\n$$ \\frac{\\varepsilon^{3-2\\alpha}}{\\varepsilon^{-\\alpha-1}} = \\frac{K_V \\alpha}{K_B (4-2\\alpha)} $$\n$$ \\varepsilon^{(3-2\\alpha) - (-\\alpha-1)} = \\frac{K_V \\alpha}{K_B (4-2\\alpha)} $$\n$$ \\varepsilon^{4-\\alpha} = \\frac{K_V \\alpha}{K_B (4-2\\alpha)} $$\n最后，我们得到最佳截断水平 $\\varepsilon_{\\text{opt}}$：\n$$ \\varepsilon_{\\text{opt}} = \\left( \\frac{K_V \\alpha}{K_B (4-2\\alpha)} \\right)^{\\frac{1}{4-\\alpha}} $$\n这个结果表达了最佳截断水平与过程参数 $\\alpha$ 以及偏差与方差的相对权重的关系，体现了偏差-方差权衡的本质。 $K_B$ 和 $K_V$ 是概括了过程参数（$c, T$）、模拟设置（$B$）和统计特性（$c_1$）的比例常数。",
            "answer": "$$\\boxed{ \\left( \\frac{K_V \\alpha}{K_B (4-2\\alpha)} \\right)^{\\frac{1}{4-\\alpha}} }$$"
        },
        {
            "introduction": "没有任何一种模拟方法是普遍最优的；最佳选择取决于 Lévy 过程的具体性质。本练习  探讨了重尾 $ \\alpha $-稳定过程的情况，在这种情况下，像快速傅里叶变换 (FFT) 反演这样的常用方法可能会完全失效。它促使您批判性地思考算法的失效模式，并确定对过程的关键特征（如其尾部行为）敏感的稳健替代算法和原则性验证技术。",
            "id": "3342722",
            "problem": "考虑一个对称$\\alpha$-稳定Lévy过程 $\\{X_t\\}_{t \\ge 0}$，其尺度参数为 $\\sigma0$，在时间步长 $\\Delta t0$ 内的增量的特征函数由 $\\phi_{\\Delta t}(u)=\\mathbb{E}[\\exp(\\mathrm{i} u X_{\\Delta t})]=\\exp(-\\Delta t\\,\\sigma^{\\alpha}|u|^{\\alpha})$ 给出，其中 $\\alpha \\in (0,2)$。您的目标是针对一系列 $\\Delta t$ 值，在 $\\alpha=1.1$ 和 $\\sigma=1$ 的条件下模拟 $X_{\\Delta t}$，以对不同的模拟方法进行基准测试。一种候选方法通过傅里叶逆变换计算概率密度，并在宽度为 $L$、间距为 $\\Delta x$ 的有限网格上实现快速傅里叶变换 (FFT) 反演。\n\n根据基本定义，Lévy过程具有平稳独立的增量，并由其Lévy–Khintchine指数刻画；一个对称$\\alpha$-稳定增量具有幂律密度尾部，其衰减阶数为 $|x|^{-1-\\alpha}$，这意味着对于 $\\alpha \\in (0,2)$ 且 $\\alpha2$ 的情况，尾部衰减缓慢且方差无穷大。当在有限计算域上使用FFT反演时，截断的逆变换实际上会使密度周期化，产生混叠误差，该误差取决于截断域外的质量以及在 $x=0$ 附近的网格分辨率。\n\n您通过比较不同离散化方案的输出以及计算与$\\alpha$-稳定律的定义性质（例如，尾指数、特征函数行为）相关的诊断指标来进行交叉验证。在基准测试期间，您观察到对于 $\\alpha=1.1$，FFT反演方法的表现不佳：尾部分位数存在偏差，并且诊断指标表明存在周期化伪影。\n\n以下哪些组合策略和诊断方法是科学上合理的备用方案，能够专门解决重尾失效模式，并为正确性提供有原则的交叉验证？选择所有适用项。\n\nA. 用Chambers–Mallows–Stuck (CMS) 方法替代FFT反演来对$\\alpha$-稳定增量进行抽样，并通过在一个有界的 $u$ 值网格上估计经验特征函数 (ECF) $\\hat{\\phi}(u)=\\frac{1}{n}\\sum_{k=1}^{n}\\exp(\\mathrm{i} u X_{\\Delta t}^{(k)})$，然后通过上确界范数 $\\sup_{u \\in \\mathcal{U}}|\\hat{\\phi}(u)-\\phi_{\\Delta t}(u)|$ 将其与 $\\phi_{\\Delta t}(u)=\\exp(-\\Delta t\\,\\sigma^{\\alpha}|u|^{\\alpha})$ 进行比较来进行验证。\n\nB. 保留FFT反演，但引入参数为 $\\theta0$ 的指数倾斜来处理目标密度 $f(x)$ 以加速尾部衰减，在倾斜下执行反演，然后通过重要性权重将样本转换回原始分布；通过倾斜分布和原始分布之间的Kolmogorov–Smirnov (KS) 统计量进行验证。\n\nC. 通过对Lévy测度在 $|x|\\varepsilon$ 上的泊松细化来模拟大跳跃，并将小跳跃的累积效应近似为一个方差等于小跳跃积分方差的高斯分布，从而混合该过程；通过将样本方差与 $X_{\\Delta t}$ 的理论方差进行匹配来验证。\n\nD. 使用级数表示（例如，用于$\\alpha$-稳定过程的LePage或Rosiński级数）将 $X_{\\Delta t}$ 模拟为一个带有原则性残差校正的截断随机级数，并通过在 $|X_{\\Delta t}|$ 上使用Hill估计量来估计尾指数，并检查其是否收敛到真实的$\\alpha$来进行验证。\n\nE. 增加FFT网格大小 $N$ 并应用零填充和汉宁窗；通过将前四个样本累积量与$\\alpha$-稳定增量分布的相应理论累积量进行匹配来验证。",
            "solution": "我们从Lévy过程的Lévy–Khintchine公式的基本刻画以及$\\alpha$-稳定增量的定义特征出发。一个对称$\\alpha$-稳定增量 $X_{\\Delta t}$ 的特征函数为 $\\phi_{\\Delta t}(u)=\\exp(-\\Delta t\\,\\sigma^{\\alpha}|u|^{\\alpha})$。当 $|x|\\to\\infty$ 时，其密度以 $|x|^{-1-\\alpha}$ 的速度衰减，因此对于 $\\alpha=1.1$，其尾部是重尾，并且增量分布具有无穷方差。当在有限区间 $[-L/2,L/2]$ 上使用间距为 $\\Delta x$ 的FFT反演时，由于截断，逆变换实际上会使密度周期化。对于重尾分布，区间 $[-L/2,L/2]$ 之外的尾部质量可能不可忽略，这部分质量会混叠回中心区域，从而在尾部分位数上产生偏差，并在估计的密度中产生伪影。此外，要同时解析 $x=0$ 附近的尖点和重尾，既需要小的 $\\Delta x$ 也需要大的 $L$，这意味着需要大量的网格点 $N=L/\\Delta x$ 和高昂的计算成本，同时对加窗和截断的选择也很敏感。\n\n在此背景下，一个科学上合理的备用方案必须直接针对重尾特性，而不依赖于周期化，而一个有原则的交叉验证诊断方法必须与核心定义性质（例如，特征函数的一致性或尾指数的一致性）相关联。我们现在分析每个选项。\n\n选项A：用Chambers–Mallows–Stuck (CMS) 方法替代FFT反演来对$\\alpha$-稳定增量进行抽样，并通过经验特征函数进行验证。\nChambers–Mallows–Stuck (CMS) 方法是一种经典的、用于$\\alpha$-稳定随机变量的精确抽样方案，它不依赖于通过FFT反演密度。因此，它避免了截断傅里叶反演所固有的重尾混叠问题。通过经验特征函数进行交叉验证是有原则的：对于任何具有已知特征函数 $\\phi_{\\Delta t}(u)$ 的Lévy增量，在一个有界网格 $\\mathcal{U}$ 上将 $\\hat{\\phi}(u)$ 与 $\\phi_{\\Delta t}(u)$ 进行核对，为分布的正确性提供了直接的诊断，并通过频域捕捉了中心和尾部的特性。上确界范数 $\\sup_{u \\in \\mathcal{U}}|\\hat{\\phi}(u)-\\phi_{\\Delta t}(u)|$ 是一个可解释的差异度量。该选项提供了一个稳健的备用方案和一个有效的诊断方法。结论：正确。\n\n选项B：倾斜密度以加速尾部衰减，在倾斜下进行反演，然后使用重要性权重恢复原始分布；通过倾斜分布和原始分布之间的Kolmogorov–Smirnov (KS) 统计量进行验证。\n指数倾斜是用于方差缩减和在估计期望值时进行测度变换的工具，但它并没有提供一个直接的机制，可以通过简单的重加权将从倾斜分布中抽取的样本转换回原始分布的样本。重要性抽样权重转换的是一个分布到另一个分布的期望值，而不是样本实现。在倾斜下使用FFT反演产生的是倾斜分布的样本；没有有效的一对一映射可以将这些样本转换为目标分布的无偏样本。此外，通过倾斜分布和原始分布之间的KS统计量进行验证在概念上是不一致的，因为KS统计量比较的是两个经验分布；将倾斜分布与原始分布进行比较并不能验证目标抽样的正确性。该选项没有提供科学上合理的抽样备用方案，并提出了一个无效的诊断方法。结论：不正确。\n\n选项C：通过泊松细化模拟大跳跃，并用高斯分布近似小跳跃；通过匹配样本方差进行验证。\n将大跳跃 ($|x|\\varepsilon$) 与小跳跃分开的混合模拟是一个标准的想法。然而，用高斯分布近似小跳跃的累积效应要求小跳跃分量具有有限方差。对于 $\\alpha=1.1$，对称$\\alpha$-稳定过程具有无穷方差，且小跳跃分量不具有有限的二阶矩。因此，高斯近似是不合理的，而匹配样本方差也不是一个有效的诊断方法，因为 $X_{\\Delta t}$ 的理论方差不存在。该选项在方法和诊断上都失败了。结论：不正确。\n\n选项D：使用级数表示（LePage/Rosiński）并带有原则性残差校正；通过Hill估计量对尾指数进行验证。\n$\\alpha$-稳定过程的级数表示（例如，LePage、Rosiński）将 $X_{\\Delta t}$ 表示为一个涉及加权指数或泊松点的随机级数，该级数几乎必然收敛到稳定律。在 $N$ 项处截断并加上残差校正，可以得到一种可实现的模拟方法，该方法自然地尊重重尾特性而无需周期化。通过在 $|X_{\\Delta t}|$ 上使用Hill估计量对尾指数进行交叉验证是恰当的：定义性的重尾指数 $\\alpha$ 可以从高阶顺序统计量中得到一致估计，验证其是否收敛到真实的$\\alpha$可以检查模拟的尾部行为是否正确。这是一个科学上合理的备用方法和一个有原则的诊断方法。结论：正确。\n\n选项E：增加FFT网格大小并应用加窗；通过匹配前四个累积量进行验证。\n虽然增加 $N$、进行零填充和应用平滑窗（例如，汉宁窗）可以减少数值伪影，但加窗会引入偏差，并且对于具有缓慢衰减的重尾，除非 $L$ 极大，否则周期化误差仍然是个问题。更关键的是，对于 $\\alpha=1.1$，增量分布具有无穷方差和未定义的更高阶累积量。通过匹配前四个累积量进行验证是没有意义的，因为这些累积量不存在。因此，对于 $\\alpha2$ 的$\\alpha$-稳定增量，这不是一个科学上合理的诊断方法，并且该策略不能从根本上消除重尾混叠。结论：不正确。\n\n因此，在所述的重尾情况下，科学上合理的备用方案和交叉验证诊断方法是选项A和D中的那些。这些方法避免了周期化伪影，并针对核心定义性质（特征函数和尾指数）进行验证。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}