{
    "hands_on_practices": [
        {
            "introduction": "重采样是SMC中对抗权重退化的关键步骤，但它本身会引入随机性，从而增加估计量的方差。不同的重采样方案在控制这种额外方差方面表现各异。本练习 () 提供了一个直接的、动手计算的机会，通过计算并比较不同方案下单个粒子的后代数量方差，将高级重采样方案的理论优势具体化。",
            "id": "3345072",
            "problem": "考虑一个用于静态目标分布的序贯蒙特卡洛（SMC）采样器。在某一次迭代中，假设一个加权粒子系统对于 $K=5$ 个不同的粒子，其粒子权重为 $\\mathbf{w} = (0.10,\\,0.25,\\,0.05,\\,0.30,\\,0.30)$，并且要生成的后代总数为 $N=12$。令 $N_i$ 表示在重采样步骤中，给定权重向量 $\\mathbf{w}$ 的条件下，分配给粒子 $i$ 的后代的随机数量。我们关注粒子 $i=3$，其权重为 $w_3 = 0.05$。使用多项式重采样、分层重采样、残差重采样和系统重采样的标准定义，计算每种方案下的条件方差 $\\operatorname{Var}(N_3 \\mid \\mathbf{w})$。\n\n以精确值的形式给出这四个方差，然后按条件方差的升序对这些方案进行排序。将最终答案表示为一个单行矩阵，按升序列出这四个方差（从左到右），其中的条目对应于方差升序排列的方案。不需要四舍五入。不涉及物理单位。",
            "solution": "该问题要求在一个序贯蒙特卡洛（SMC）框架下，计算并比较特定粒子（记为 $N_3$）的后代数量在四种不同重采样方案下的条件方差。给定的参数是要生成的后代总数 $N=12$，以及 $K=5$ 个粒子的归一化粒子权重向量 $\\mathbf{w} = (0.10, 0.25, 0.05, 0.30, 0.30)$。我们关注的是粒子 $i=3$，其权重为 $w_3 = 0.05$。权重之和为 $\\sum_{i=1}^5 w_i = 0.10 + 0.25 + 0.05 + 0.30 + 0.30 = 1.00$，这证实了它们是归一化的。我们将为四种指定的重采样方案中的每一种计算量 $\\operatorname{Var}(N_3 \\mid \\mathbf{w})$。\n\n**1. 多项式重采样**\n在多项式重采样中，后代计数向量 $(N_1, N_2, \\dots, N_K)$ 是从一个多项式分布中随机抽取的，该分布有 $N$ 次试验，成功概率由权重向量 $\\mathbf{w}$ 给出。\n$$\n(N_1, N_2, \\dots, N_K) \\sim \\text{Multinomial}(N, \\mathbf{w})\n$$\n单个粒子 $i$ 的后代数量 $N_i$ 的边际分布是一个二项分布，有 $N$ 次试验，成功概率为 $w_i$。\n$$\nN_i \\sim \\text{Binomial}(N, w_i)\n$$\n二项分布 $\\text{Binomial}(n, p)$ 的方差由 $np(1-p)$ 给出。因此，$N_i$ 的条件方差为：\n$$\n\\operatorname{Var}(N_i \\mid \\mathbf{w}) = N w_i (1-w_i)\n$$\n对于粒子 $i=3$，$N=12$ 且 $w_3=0.05$，方差为：\n$$\n\\operatorname{Var}(N_3 \\mid \\mathbf{w}) = 12 \\times 0.05 \\times (1 - 0.05) = 12 \\times 0.05 \\times 0.95 = 0.6 \\times 0.95 = 0.57\n$$\n\n**2. 分层重采样**\n在分层重采样中，区间 $[0,1)$ 被划分为 $N$ 个长度相等的层，每层长度为 $1/N$。从每个层中抽取一个均匀分布的随机数。然后使用这 $N$ 个有序的指针来选择祖先。粒子 $i$ 的后代数量 $N_i$ 是一个随机变量，它只能取两个相邻的整数值：$\\lfloor N w_i \\rfloor$ 或 $\\lceil N w_i \\rceil$。\n令 $N w_i = I_i + f_i$，其中 $I_i = \\lfloor N w_i \\rfloor$ 是整数部分，$f_i = \\{N w_i\\}$ 是小数部分。后代数量由 $N_i = I_i$（概率为 $1-f_i$）和 $N_i = I_i+1$（概率为 $f_i$）给出。这意味着随机变量 $N_i - I_i$ 服从参数为 $f_i$ 的伯努利分布。\n$$\nN_i - \\lfloor N w_i \\rfloor \\sim \\text{Bernoulli}(\\{N w_i\\})\n$$\n参数为 $p$ 的伯努利试验的方差是 $p(1-p)$。因此，$N_i$ 的方差仅取决于其乘以 $N$ 后的非整数部分：\n$$\n\\operatorname{Var}(N_i \\mid \\mathbf{w}) = \\operatorname{Var}(N_i - I_i) = f_i(1-f_i) = \\{N w_i\\}(1 - \\{N w_i\\})\n$$\n对于粒子 $i=3$，我们首先计算 $N w_3 = 12 \\times 0.05 = 0.6$。小数部分为 $f_3 = \\{0.6\\} = 0.6$。方差为：\n$$\n\\operatorname{Var}(N_3 \\mid \\mathbf{w}) = 0.6 \\times (1 - 0.6) = 0.6 \\times 0.4 = 0.24\n$$\n\n**3. 系统重采样**\n系统重采样与分层重采样类似，但不是抽取 $N$ 个独立的随机数，而是抽取一个单一的随机数 $u \\sim U[0,1)$ 来定义一个指针网格 $\\{ \\frac{u}{N}, \\frac{u+1}{N}, \\dots, \\frac{u+N-1}{N} \\}$。这会在后代计数 $N_i$ 之间引入强烈的负相关。然而，单个计数 $N_i$ 的边际分布与分层重采样中的相同。后代数量 $N_i$ 仍然只能是 $\\lfloor N w_i \\rfloor$ 或 $\\lceil N w_i \\rceil$，并且 $N_i = \\lfloor N w_i \\rfloor + 1$ 的概率为 $\\{N w_i\\}$。\n因此，$N_i$ 的边际方差公式与分层重采样的公式相同：\n$$\n\\operatorname{Var}(N_i \\mid \\mathbf{w}) = \\{N w_i\\}(1 - \\{N w_i\\})\n$$\n对于粒子 $i=3$，计算过程与分层重采样的情况相同：\n$$\n\\operatorname{Var}(N_3 \\mid \\mathbf{w}) = 0.24\n$$\n\n**4. 残差重采样**\n残差重采样是一个旨在减少采样方差的两阶段过程。\n在第一阶段，确定性数量的后代 $\\tilde{N}_i = \\lfloor N w_i \\rfloor$ 被分配给每个粒子 $i$。\n确定性分配的后代总数为 $N_{det} = \\sum_{i=1}^K \\tilde{N}_i$。\n在第二阶段，剩余的 $N_{res} = N - N_{det}$ 个后代被随机分配。这是通过对 $N_{res}$ 个新粒子执行重采样（通常是多项式重采样）来完成的，使用一组新的权重 $\\mathbf{w}'$，其中每个 $w'_i$ 与原始权重的残差部分成正比，即 $w'_i \\propto N w_i - \\lfloor N w_i \\rfloor = \\{N w_i\\}$。正确归一化的权重为 $w'_i = \\frac{\\{N w_i\\}}{\\sum_{j=1}^K \\{N w_j\\}} = \\frac{\\{N w_i\\}}{N_{res}}$。\n粒子 $i$ 的后代总数为 $N_i = \\tilde{N}_i + R_i$，其中 $R_i$ 是来自第二阶段的后代的随机数量。由于 $\\tilde{N}_i$ 是确定性的，所以 $\\operatorname{Var}(N_i \\mid \\mathbf{w}) = \\operatorname{Var}(R_i \\mid \\mathbf{w})$。向量 $(R_1, \\dots, R_K)$ 服从 $\\text{Multinomial}(N_{res}, \\mathbf{w}')$ 分布。\n因此 $R_i$ 的边际方差为 $\\operatorname{Var}(R_i \\mid \\mathbf{w}) = N_{res} w'_i (1-w'_i)$。\n\n让我们计算所有粒子的必要数量：\n缩放后的权重为 $N\\mathbf{w} = (1.2, 3.0, 0.6, 3.6, 3.6)$。\n确定性计数为 $\\tilde{\\mathbf{N}} = (\\lfloor 1.2 \\rfloor, \\lfloor 3.0 \\rfloor, \\lfloor 0.6 \\rfloor, \\lfloor 3.6 \\rfloor, \\lfloor 3.6 \\rfloor) = (1, 3, 0, 3, 3)$。\n$N_{det} = 1+3+0+3+3 = 10$。\n$N_{res} = N - N_{det} = 12 - 10 = 2$。\n小数部分为 $\\{\\mathbf{Nw}\\} = (0.2, 0.0, 0.6, 0.6, 0.6)$。它们的和是 $0.2+0.0+0.6+0.6+0.6 = 2.0$，这与 $N_{res}$ 相等，是正确的。\n用于残差重采样的新权重为 $\\mathbf{w}' = \\frac{1}{2.0}(0.2, 0.0, 0.6, 0.6, 0.6) = (0.1, 0.0, 0.3, 0.3, 0.3)$。\n对于粒子 $i=3$，我们有 $w'_3 = 0.3$。方差为：\n$$\n\\operatorname{Var}(N_3 \\mid \\mathbf{w}) = N_{res} w'_3 (1-w'_3) = 2 \\times 0.3 \\times (1 - 0.3) = 2 \\times 0.3 \\times 0.7 = 0.42\n$$\n\n**总结与排序**\n计算出的 $N_3$ 的条件方差为：\n- 多项式重采样：$0.57$\n- 分层重采样：$0.24$\n- 系统重采样：$0.24$\n- 残差重采样：$0.42$\n\n按 $N_3$ 的条件方差升序对重采样方案进行排序：\n1. 分层重采样（方差 = $0.24$）\n1. 系统重采样（方差 = $0.24$）\n3. 残差重采样（方差 = $0.42$）\n4. 多项式重采样（方差 = $0.57$）\n\n排序后的方差列表为 $(0.24, 0.24, 0.42, 0.57)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.24 & 0.24 & 0.42 & 0.57 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在上一个练习中，我们看到某些重采样方案能产生更低的方差。但这在整体估计中究竟有多重要？本练习 () 将探讨这一问题对最终估计器误差的*渐近*影响。通过分析一个简化的双状态系统，你将推导出一个关于收敛速度的惊人结论，揭示为何精巧的重采样设计不仅仅是微小的调整，而是一种根本性的改进。",
            "id": "3345037",
            "problem": "考虑一个序贯蒙特卡罗 (SMC; Sequential Monte Carlo) 采样器，其目标是一个静态概率测度。设静态目标测度 $\\pi$ 的支撑集为两个原子 $\\{x_{1}, x_{2}\\}$，其中 $\\pi(\\{x_{1}\\}) = p \\in (0,1)$ 且 $\\pi(\\{x_{2}\\}) = 1-p$。设 $f$ 是一个有界可测函数，满足 $f(x_{1}) = f_{1} \\in \\mathbb{R}$ 且 $f(x_{2}) = f_{2} \\in \\mathbb{R}$。假设SMC采样器使用恒等变异核（即马尔可夫转移不移动粒子），并应用单个重采样步骤将加权粒子系统转换为大小为 $N$ 的无权粒子系统，从而得到估计量 $\\hat{\\pi}_{t}^{N}(f)$，其定义为 $f$ 在重采样后的粒子上的样本均值。\n\n假设在重采样之前，加权粒子系统被理想化如下：位于 $x_{1}$ 的粒子集合共同携带的归一化总权重为 $p$，而位于 $x_{2}$ 的粒子集合共同携带的归一化总权重为 $1-p$。因此，在任何一次重采样抽选中，从 $x_{1}$ 抽取一个父粒子的概率为 $p$，从 $x_{2}$ 抽取的概率为 $1-p$。\n\n考虑两种重采样方案：\n- 多项式重采样：进行 $N$ 次独立的父粒子抽取，其中在 $x_{1}$ 处的概率为 $p$，在 $x_{2}$ 处的概率为 $1-p$。\n- 残差重采样：每个位置分别接收 $\\lfloor N p \\rfloor$ 和 $\\lfloor N(1-p) \\rfloor$ 个确定性副本，剩余的 $R = N - \\lfloor N p \\rfloor - \\lfloor N(1-p) \\rfloor$ 个副本（在此双原子情况下 $R \\in \\{0,1\\}$）通过一次随机抽取进行分配，抽取概率与残余小数权重成正比。\n\n仅从这些定义以及二项和伯努利方差的标准性质出发，为每种重采样方案推导中心极限定理 (CLT; Central Limit Theorem) 中的渐近方差常数 $\\sigma^{2}$，其形式为\n$$\n\\sqrt{N}\\big(\\hat{\\pi}_{t}^{N}(f) - \\pi(f)\\big) \\Longrightarrow \\mathcal{N}(0,\\sigma^{2}),\n$$\n其中 $\\Longrightarrow$ 表示依分布收敛。然后计算差值\n$$\n\\Delta \\sigma^{2} \\equiv \\sigma^{2}_{\\text{multinomial}} - \\sigma^{2}_{\\text{residual}}\n$$\n作为一个关于 $p$、$f_{1}$ 和 $f_{2}$ 的封闭形式解析表达式。将您的最终答案表示为单个封闭形式表达式。不需要四舍五入，该量没有单位。",
            "solution": "我们寻求推导两种重采样方案（多项式和残差）下，对函数 $f$ 的SMC估计量的渐近方差，并计算它们的差值。\n\n$f$ 关于目标测度 $\\pi$ 的真实期望值为：\n$$\n\\pi(f) = E_{\\pi}[f(X)] = f(x_1) \\pi(\\{x_1\\}) + f(x_2) \\pi(\\{x_2\\}) = p f_1 + (1-p) f_2.\n$$\n中心极限定理 (CLT) 中的渐近方差常数 $\\sigma^2$ 由以下极限给出：\n$$\n\\sigma^2 = \\lim_{N\\to\\infty} \\text{Var}\\left[\\sqrt{N}\\left(\\hat{\\pi}_{t}^{N}(f) - \\pi(f)\\right)\\right] = \\lim_{N\\to\\infty} N \\text{Var}\\left[\\hat{\\pi}_{t}^{N}(f)\\right].\n$$\n\n### 多项式重采样的渐近方差\n在多项式重采样中，我们从一个在 $\\{x_1, x_2\\}$ 上概率为 $(p, 1-p)$ 的分类分布中独立抽取 $N$ 个粒子。设这些新粒子为 $\\{X_i\\}_{i=1}^N$。估计量是这些独立同分布（i.i.d.）随机变量的样本均值：\n$$\n\\hat{\\pi}_{\\text{multi}}^{N}(f) = \\frac{1}{N} \\sum_{i=1}^{N} f(X_i).\n$$\n每个 $f(X_i)$ 是一个随机变量，我们称之为 $Z_i$，它以概率 $p$ 取值 $f_1$，以概率 $1-p$ 取值 $f_2$。\n$Z_i$ 的均值为 $E[Z_i] = p f_1 + (1-p) f_2 = \\pi(f)$。\n$Z_i$ 的方差为：\n$$\n\\text{Var}(Z_i) = E[Z_i^2] - (E[Z_i])^2 = (p f_1^2 + (1-p) f_2^2) - (p f_1 + (1-p) f_2)^2.\n$$\n展开并化简此表达式，我们得到：\n$$\n\\text{Var}(Z_i) = p(1-p)(f_1^2 - 2f_1 f_2 + f_2^2) = p(1-p)(f_1 - f_2)^2.\n$$\n根据标准中心极限定理，对于i.i.d.样本，$\\sqrt{N}(\\hat{\\pi}_{\\text{multi}}^{N}(f) - \\pi(f)) \\Longrightarrow \\mathcal{N}(0, \\text{Var}(Z_i))$。\n因此，多项式重采样的渐近方差为：\n$$\n\\sigma^2_{\\text{multinomial}} = p(1-p)(f_1 - f_2)^2.\n$$\n\n### 残差重采样的渐近方差\n设 $M_1$ 是残差重采样后位于位置 $x_1$ 的粒子数，则位于 $x_2$ 的粒子数是 $M_2 = N - M_1$。估计量为：\n$$\n\\hat{\\pi}_{\\text{res}}^{N}(f) = \\frac{1}{N}(M_1 f_1 + M_2 f_2) = \\frac{1}{N}(M_1 f_1 + (N-M_1)f_2) = \\frac{M_1}{N}(f_1-f_2) + f_2.\n$$\n$M_1$ 由确定性部分和随机部分组成：\n$$\nM_1 = \\lfloor Np \\rfloor + R_1,\n$$\n其中 $R_1$ 是分配给 $x_1$ 的残差粒子数。残差粒子的总数是 $R = N - \\lfloor Np \\rfloor - \\lfloor N(1-p) \\rfloor$。由于 $Np + N(1-p) = N$，且 $\\{x\\} + \\{-x\\}$ 在 $x$ 不是整数时为 $1$，在 $x$ 是整数时为 $0$，我们可以推断 $R \\in \\{0, 1\\}$。\n如果 $R=1$，这个残差粒子以与残差小数权重 $\\{Np\\}$ 和 $\\{N(1-p)\\}$ 成正比的概率被分配。分配给 $x_1$ 的概率是 $\\{Np\\}/(\\{Np\\}+\\{N(1-p)\\}) = \\{Np\\}/R = \\{Np\\}$。\n因此，$R_1$ 是一个伯努利随机变量，$R_1 \\sim \\text{Bernoulli}(\\{Np\\})$。\n$M_1$ 的方差为 $\\text{Var}[M_1] = \\text{Var}[\\lfloor Np \\rfloor + R_1] = \\text{Var}[R_1] = \\{Np\\}(1-\\{Np\\})$。\n\n估计量的方差为：\n$$\n\\text{Var}\\left[\\hat{\\pi}_{\\text{res}}^{N}(f)\\right] = \\text{Var}\\left[\\frac{M_1}{N}(f_1-f_2) + f_2\\right] = \\frac{(f_1-f_2)^2}{N^2} \\text{Var}[M_1] = \\frac{(f_1-f_2)^2}{N^2} \\{Np\\}(1-\\{Np\\}).\n$$\n渐近方差常数为：\n$$\n\\sigma^2_{\\text{residual}} = \\lim_{N\\to\\infty} N \\text{Var}\\left[\\hat{\\pi}_{\\text{res}}^{N}(f)\\right] = \\lim_{N\\to\\infty} N \\frac{(f_1-f_2)^2}{N^2} \\{Np\\}(1-\\{Np\\})\n$$\n$$\n= \\lim_{N\\to\\infty} \\frac{(f_1-f_2)^2}{N} \\{Np\\}(1-\\{Np\\}).\n$$\n由于 $\\{Np\\}(1-\\{Np\\})$ 是有界的（在 $[0, 1/4]$ 区间内），而分母 $N$ 趋于无穷大，所以极限为零。\n$$\n\\sigma^2_{\\text{residual}} = 0.\n$$\n零渐近方差常数意味着 $\\sqrt{N}(\\hat{\\pi}_{\\text{res}}^{N}(f) - \\pi(f))$ 依概率收敛于 0。极限分布是在 0 处的点质量，即一个零方差的高斯分布 $\\mathcal{N}(0,0)$。\n\n### 渐近方差的差值\n现在我们计算差值 $\\Delta \\sigma^{2} = \\sigma^{2}_{\\text{multinomial}} - \\sigma^{2}_{\\text{residual}}$。\n代入上面推导出的结果：\n$$\n\\Delta \\sigma^{2} = p(1-p)(f_1 - f_2)^2 - 0\n$$\n$$\n\\Delta \\sigma^{2} = p(1-p)(f_1 - f_2)^2.\n$$\n这个结果量化了在这种理想化设置下，使用残差重采样替代多项式重采样所实现的渐近方差的减少。",
            "answer": "$$\n\\boxed{p(1-p)(f_1-f_2)^2}\n$$"
        },
        {
            "introduction": "SMC采样器是一个复杂的多阶段算法，包含温度退火、重加权、重采样和MCMC更新等多个环节。本练习 () 将重点转向实时监控算法的“健康状况”。它要求你将关键的性能指标——如有效样本量(ESS)、MCMC接受率和粒子多样性——与它们背后的数学原理联系起来，从而培养在实际应用中成功部署SMC所必需的批判性判断力。",
            "id": "3345061",
            "problem": "考虑一个序贯蒙特卡洛（SMC）采样器，其目标是静态目标，其密度与后验分布成正比，即在可测空间上的密度 $\\pi(x) \\propto p(x)L(x)$，其中 $p(x)$ 是先验密度，$L(x)$ 是似然函数。针对静态目标的一种常用策略是使用退火路径 $\\{\\pi_t\\}_{t=0}^T$，定义为 $\\pi_t(x) \\propto p(x)L(x)^{\\lambda_t}$，其中 $0=\\lambda_0 < \\lambda_1 < \\dots < \\lambda_T=1$，增量退火步长为 $\\delta_t=\\lambda_{t+1}-\\lambda_t$。在迭代 $t\\to t+1$ 中，粒子 $\\{X_t^{(i)}\\}_{i=1}^N$ 通过与 $L(X_t^{(i)})^{\\delta_t}$ 成正比的增量重要性权重进行重加权，归一化得到 $\\{W_{t+1}^{(i)}\\}_{i=1}^N$，可选择性地进行重采样，然后通过一个保持 $\\pi_{t+1}$ 不变的马尔可夫链蒙特卡洛（MCMC）核 $K_{t+1}$ 进行更新。假设 $K_{t+1}$ 是一个随机游走 Metropolis–Hastings 核，其提议分布为 $q_{t+1}(x'\\mid x)=\\mathcal{N}(x, \\sigma_{t+1}^2 I)$，接受概率为 $\\alpha_{t+1}(x,x')=\\min\\{1, \\pi_{t+1}(x')/\\pi_{t+1}(x)\\}$。\n\n在实践中，会使用一些诊断指标在每次迭代中监控算法的健康状况，包括有效样本量（ESS）、更新步骤的 Metropolis–Hastings 接受率、归一化权重的熵（通常用困惑度概括），以及重采样后唯一粒子的比例。每个诊断指标都可以与重要性采样、重采样和马尔可夫链蒙特卡洛的基本定义联系起来。\n\n以下哪个陈述正确地定义了这些诊断指标，并为其在上述 SMC 设置中作为健康状况指标的使用提供了有效的分析性论证？\n\nA. 在增量指数为 $\\delta_t$ 的退火步骤中，对于 $X\\sim \\pi_t$，定义增量对数似然 $Z=\\log L(X)$。对于大的 $N$ 和小的 $\\delta_t$，期望的归一化有效样本量比率满足\n$$\n\\mathbb{E}\\left[\\frac{\\mathrm{ESS}_{t+1}}{N}\\right]\\approx \\exp\\left(-\\kappa_2\\,\\delta_t^2\\right)+\\mathcal{O}(\\delta_t^3),\\quad \\text{其中 }\\kappa_2=\\mathrm{Var}_{\\pi_t}[Z],\n$$\n因此，控制 $\\mathrm{ESS}$ 在 $t$ 上的下降能有效控制增量对数权重的方差，并减轻权重退化。\n\nB. 由于 Metropolis–Hastings 接受概率是移动质量的度量，接近 $1$ 的接受率总是对混合最优的；因此，在更新步骤中，无论维度或目标几何形状如何，都应调整提议尺度以将接受率推高至 $0.9$ 以上。\n\nC. 令 $H_{t+1}=-\\sum_{i=1}^N W_{t+1}^{(i)}\\log W_{t+1}^{(i)}$ 表示归一化权重的香农熵，$P_{t+1}=\\exp(H_{t+1})$ 表示困惑度。那么 $\\mathrm{ESS}_{t+1}\\le P_{t+1}\\le N$，所以 $P_{t+1}$ 对少数极端权重比 $\\mathrm{ESS}_{t+1}$ 更不敏感。此外，在多项式重采样后，$P_{t+1}/N$ 和 $\\mathrm{ESS}_{t+1}/N$ 都等于唯一粒子的期望比例。\n\nD. 在权重为 $\\{W_{t+1}^{(i)}\\}_{i=1}^N$ 的多项式重采样下，如果 $U_{t+1}$ 表示被选中的唯一祖先索引的数量，则\n$$\n\\mathbb{E}\\left[\\frac{U_{t+1}}{N}\\right]=\\frac{1}{N}\\sum_{i=1}^N \\left(1-(1-W_{t+1}^{(i)})^N\\right).\n$$\n因此，当权重近似均匀时，$\\mathbb{E}[U_{t+1}/N]\\approx 1-e^{-1}$，而如果单个权重占主导地位，则 $\\mathbb{E}[U_{t+1}/N]\\approx 1/N$。因此，唯一粒子的比例直接量化了因重采样导致的多样性损失。\n\nE. 对于迭代 $t+1$ 中的随机游走 Metropolis 更新核，处于 $0.2$–$0.4$ 范围内的接受率，并伴有非零的经验均方跳跃距离，表明混合良好；单独的接受率可能具有误导性，因为它可以通过缩小提议方差任意提高，而这种情况下链只会进行非常小的移动。\n\nF. 对于归一化权重 $\\{W_{t+1}^{(i)}\\}_{i=1}^N$，Rényi 熵排序意味着\n$$\n\\mathrm{ESS}_{t+1}=\\frac{1}{\\sum_{i=1}^N (W_{t+1}^{(i)})^2}\\le \\exp(H_{t+1})\\le N.\n$$\n在完全均匀的权重（两边都等于 $N$）和完全退化的权重（两边都等于 $1$）的极端情况下等式成立。因此，归一化的困惑度 $\\exp(H_{t+1})/N$ 是 $\\mathrm{ESS}_{t+1}/N$ 的上界，并为权重退化提供了一个更平滑的替代指标。",
            "solution": "此问题要求评估关于 SMC 采样器诊断指标的六个陈述的正确性。\n\n**A. ESS 与增量权重方差的关系**\n此陈述给出了期望归一化 ESS 比率关于退火步长 $\\delta_t$ 的二阶近似。该公式是 SMC 理论中的一个标准结果，它将 ESS 的下降与增量对数权重的方差 ($\\kappa_2$) 直接联系起来。该公式的推导基于对矩生成函数的泰勒展开，如问题解答的详细分析所示，其结果是正确的。这个关系是自适应 SMC 算法的基础，其中选择步长 $\\delta_t$ 来维持 ESS 在一个可接受的水平，从而控制权重退化。**因此，陈述 A 是正确的。**\n\n**B. 关于 MCMC 接受率的陈述**\n此陈述声称接近 1 的接受率总是最优的。这是一个根本性的误解。在随机游走 Metropolis-Hastings (RWMH) 中，接受率可以通过无限缩小提议步长来任意提高至接近 1。然而，这将导致链的移动非常小，探索效率极低（混合性差）。最优的混合是在移动大小和接受概率之间取得平衡。对于高维 RWMH，理论上的最优接受率约为 0.234。**因此，陈述 B 是错误的。**\n\n**C. 关于困惑度和唯一粒子比例的陈述**\n此陈述提出了三个论点。第一个不等式链 $\\mathrm{ESS}_{t+1}\\le P_{t+1}\\le N$ 是正确的（见 F 的分析）。第二个关于敏感度的论断是定性的。然而，第三个论断是错误的：它声称在多项式重采样后，归一化的困惑度和 ESS 都等于唯一粒子的期望比例。一个简单的反例是均匀权重 $W_i = 1/N$，此时 $\\mathrm{ESS}/N = 1$ 且 $P/N=1$，而唯一粒子的期望比例为 $1-(1-1/N)^N \\approx 1-e^{-1} \\approx 0.632$。由于这个关键部分不正确，**因此，陈述 C 是错误的。**\n\n**D. 唯一粒子的期望比例**\n此陈述给出了在多项式重采样后唯一粒子期望比例的正确公式。该公式是通过考虑单个粒子*不*被选中的概率 $(1-W_i)^N$，然后求和并取平均得到的。陈述中对极限情况（均匀权重和退化权重）的分析也是正确的，它们分别得到 $\\approx 1-e^{-1}$ 和 $\\approx 1/N$ 的比例。这个指标直接量化了由于重采样引入的“瓶颈效应”所导致的多样性损失。**因此，陈述 D 是正确的。**\n\n**E. 对 MCMC 接受率的细致解读**\n此陈述提供了对 MCMC 接受率的正确且实用的解释。它正确地指出，单独的接受率可能具有误导性，必须与移动的大小（例如，通过均方跳跃距离来衡量）一起考虑。一个在理论指导范围（如 0.2-0.4）内的接受率，加上足够大的移动，才是良好混合的标志。**因此，陈述 E 是正确的。**\n\n**F. ESS 与困惑度的关系**\n此陈述正确地指出 ESS 和困惑度 $P = \\exp(H)$ 之间的关系，其中 $H$ 是香农熵。不等式链 $\\mathrm{ESS} \\le P \\le N$ 是 Rényi 熵 $H_\\alpha$ 性质的一个结果，即 $H_\\alpha$ 是 $\\alpha$ 的一个非增函数（ESS 对应于 $\\alpha=2$，P 对应于 $\\alpha=1$）。陈述中对极端情况（均匀和退化权重）的验证也是正确的，在这些情况下等式成立。这个关系表明，困惑度是 ESS 的一个上界，并且由于其对数形式，通常被认为是对权重退化的一个更平滑的度量。**因此，陈述 F 是正确的。**\n\n综上所述，正确的陈述是 A、D、E 和 F。",
            "answer": "$$\\boxed{ADEF}$$"
        }
    ]
}