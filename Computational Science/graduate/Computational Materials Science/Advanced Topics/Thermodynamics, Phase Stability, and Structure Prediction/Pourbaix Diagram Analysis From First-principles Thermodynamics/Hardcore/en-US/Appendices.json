{
    "hands_on_practices": [
        {
            "introduction": "The bridge between quantum mechanical calculations and macroscopic electrochemical conditions is a central concept in computational materials science. This exercise provides a foundational, hands-on experience with the Computational Hydrogen Electrode (CHE) model, a cornerstone of modern computational electrochemistry. By calculating the free energy of a surface proton-electron transfer step, you will learn how to combine raw DFT energies with thermodynamic corrections for electrode potential ($U$) and acidity ($\\mathrm{pH}$) to predict reaction spontaneity .",
            "id": "3480091",
            "problem": "A single hydrogen adsorption step on a metal-oxide surface can be written as the half-reaction $* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$, where $*$ denotes an empty surface site. Starting only from the definition of reaction free energy in terms of chemical potentials and the equilibrium condition of the hydrogen redox couple, derive the expression for the electrochemical free energy change of this proton–electron transfer at finite electrode potential and acidity using the Computational Hydrogen Electrode (CHE) formalism. Then evaluate it numerically from first-principles inputs.\n\nAssume the following data are obtained from Density Functional Theory (DFT) at temperature $T = 298.15$ K for one surface unit cell:\n- Total energies: $E_{\\mathrm{DFT}}(*) = -385.000$ eV, $E_{\\mathrm{DFT}}(*\\mathrm{H}) = -388.750$ eV, $E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) = -7.000$ eV.\n- Finite-temperature free-energy corrections (zero-point energy plus thermal vibrational contributions for adsorbates; tabulated zero-point plus entropic correction for $\\mathrm{H}_{2}$ at $1$ bar): $\\Delta G_{\\mathrm{corr}}(*) = 0.000$ eV, $\\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) = 0.290$ eV, $\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) = -0.160$ eV.\n\nTake the electrode potential to be $U = -0.200$ V relative to the Standard Hydrogen Electrode (SHE), and the acidity to be $\\mathrm{pH} = 3$. Use Boltzmann’s constant $k_{B} = 8.617333262145 \\times 10^{-5}$ eV K$^{-1}$ and the mathematical constant $\\ln 10$. Treat the elementary charge $e$ implicitly so that $eU$ in electronvolts equals $U$ in volts.\n\nExpress the final reaction free energy for $* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$ in electronvolts. Round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the electrochemical free energy change, $\\Delta G$, for a single hydrogen adsorption step on a surface, followed by its numerical evaluation. The reaction is given by:\n$$* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$$\nwhere $*$ represents an empty surface site and $*\\mathrm{H}$ represents a hydrogen atom adsorbed on that site.\n\nThe derivation begins from the fundamental definition of the reaction free energy, which is the difference between the chemical potentials ($\\mu$) of the products and the reactants:\n$$ \\Delta G = \\mu_{*\\mathrm{H}} - (\\mu_{*} + \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}}) $$\n\nIn computational materials science, the chemical potentials of the surface species (the bare site $*$ and the adsorbed hydrogen site $*\\mathrm{H}$) are approximated by their Gibbs free energies ($G$). These are calculated by adding a finite-temperature free-energy correction, $\\Delta G_{\\mathrm{corr}}$, to the total energy obtained from Density Functional Theory (DFT), $E_{\\mathrm{DFT}}$.\n$$ \\mu_{*} \\approx G_{*} = E_{\\mathrm{DFT}}(*) + \\Delta G_{\\mathrm{corr}}(*) $$\n$$ \\mu_{*\\mathrm{H}} \\approx G_{*\\mathrm{H}} = E_{\\mathrm{DFT}}(*\\mathrm{H}) + \\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) $$\n\nThe main challenge is to determine the chemical potential of the proton-electron pair, $\\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}}$, in an electrochemical environment. The Computational Hydrogen Electrode (CHE) formalism provides a robust method for this. The CHE model links the chemical potential of the $(\\mathrm{H}^{+} + e^{-})$ pair to that of gaseous hydrogen, $\\mathrm{H}_{2}$, by considering the equilibrium of the hydrogen evolution/oxidation reaction:\n$$ \\mathrm{H}^{+} + e^{-} \\leftrightarrow \\frac{1}{2} \\mathrm{H}_{2}(\\mathrm{g}) $$\nBy definition of the Standard Hydrogen Electrode (SHE), this reaction is at equilibrium under standard conditions: electrode potential $U = 0$ V vs. SHE, acidity $\\mathrm{pH} = 0$ (which corresponds to a proton activity $a_{\\mathrm{H}^{+}} = 1$), and hydrogen gas pressure $p_{\\mathrm{H}_{2}} = 1$ bar, at a given temperature $T$. At equilibrium, the chemical potentials of the reactants and products are equal. Thus, at standard conditions:\n$$ \\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0) = \\frac{1}{2}\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} $$\nThe chemical potential of hydrogen gas under standard conditions, $\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ}$, is computed similarly to the surface species:\n$$ \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} = E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) + \\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) $$\nTherefore, under standard conditions:\n$$ \\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0) = \\frac{1}{2} \\left[ E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) + \\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) \\right] $$\n\nNow, we introduce the effects of a non-standard electrode potential $U$ and acidity $\\mathrm{pH}$.\nThe chemical potential of an electron at a potential $U$ relative to the SHE is shifted by $-eU$, where $e$ is the elementary charge:\n$$ \\mu_{e^{-}}(U) = \\mu_{e^{-}}(U=0) - eU $$\nThe chemical potential of a proton is dependent on its activity $a_{\\mathrm{H}^{+}}$:\n$$ \\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} + k_{B} T \\ln(a_{\\mathrm{H}^{+}}) $$\nUsing the definition of acidity, $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$, we can write $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}} = \\exp(-\\mathrm{pH} \\ln 10)$. Substituting this into the expression for $\\mu_{\\mathrm{H}^{+}}$ gives:\n$$ \\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} - k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\nCombining these terms, the chemical potential of the $(\\mathrm{H}^{+} + e^{-})$ pair at arbitrary $U$ and $\\mathrm{pH}$ is:\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = (\\mu_{\\mathrm{H}^{+}}^{\\circ} + k_{B} T \\ln(a_{\\mathrm{H}^{+}})) + (\\mu_{e^{-}}(U=0) - eU) $$\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = (\\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0)) - eU + k_{B} T \\ln(a_{\\mathrm{H}^{+}}) $$\nSubstituting the CHE equilibrium condition and the expression for $a_{\\mathrm{H}^{+}}$:\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} - eU - k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\nFinally, we substitute this expression back into the original equation for the reaction free energy $\\Delta G$:\n$$ \\Delta G = (\\mu_{*\\mathrm{H}} - \\mu_{*}) - \\left( \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} - eU - k_{B} T \\ln(10) \\cdot \\mathrm{pH} \\right) $$\nRearranging the terms, we get:\n$$ \\Delta G = \\left( \\mu_{*\\mathrm{H}} - \\mu_{*} - \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} \\right) + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\nThe term in the parentheses is the Gibbs free energy of hydrogen adsorption from gaseous $\\mathrm{H}_{2}$ at standard conditions, commonly denoted as $\\Delta G_{*\\mathrm{H}}^{\\circ}$:\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = (\\mu_{*\\mathrm{H}} - \\mu_{*}) - \\frac{1}{2}\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} $$\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = \\left[E_{\\mathrm{DFT}}(*\\mathrm{H}) - E_{\\mathrm{DFT}}(*) - \\frac{1}{2}E_{\\mathrm{DFT}}(\\mathrm{H}_{2})\\right] + \\left[\\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) - \\Delta G_{\\mathrm{corr}}(*) - \\frac{1}{2}\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2})\\right] $$\nThus, the final expression for the electrochemical free energy change is:\n$$ \\Delta G(U, \\mathrm{pH}) = \\Delta G_{*\\mathrm{H}}^{\\circ} + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\nNow, we evaluate this expression numerically using the provided data.\nThe problem specifies treating the elementary charge $e$ such that $eU$ in electronvolts (eV) is numerically equal to $U$ in volts (V).\n\nFirst, we calculate the DFT energy contribution to $\\Delta G_{*\\mathrm{H}}^{\\circ}$, which is the adsorption energy $\\Delta E_{\\text{ads}}$:\n$$ \\Delta E_{\\text{ads}} = E_{\\mathrm{DFT}}(*\\mathrm{H}) - E_{\\mathrm{DFT}}(*) - \\frac{1}{2}E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) $$\n$$ \\Delta E_{\\text{ads}} = -388.750 \\, \\text{eV} - (-385.000 \\, \\text{eV}) - \\frac{1}{2}(-7.000 \\, \\text{eV}) $$\n$$ \\Delta E_{\\text{ads}} = (-388.750 + 385.000 + 3.500) \\, \\text{eV} = -0.250 \\, \\text{eV} $$\n\nSecond, we calculate the free-energy correction contribution, $\\Delta(\\Delta G_{\\mathrm{corr}})$:\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = \\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) - \\Delta G_{\\mathrm{corr}}(*) - \\frac{1}{2}\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) $$\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = 0.290 \\, \\text{eV} - 0.000 \\, \\text{eV} - \\frac{1}{2}(-0.160 \\, \\text{eV}) $$\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = (0.290 + 0.080) \\, \\text{eV} = 0.370 \\, \\text{eV} $$\n\nThird, we calculate $\\Delta G_{*\\mathrm{H}}^{\\circ}$:\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = \\Delta E_{\\text{ads}} + \\Delta(\\Delta G_{\\mathrm{corr}}) = -0.250 \\, \\text{eV} + 0.370 \\, \\text{eV} = 0.120 \\, \\text{eV} $$\n\nFourth, we calculate the potential and pH dependent terms.\nThe potential-dependent term is $eU$. Given $U = -0.200$ V, this term is:\n$$ eU = -0.200 \\, \\text{eV} $$\nThe pH-dependent term is $k_{B} T \\ln(10) \\cdot \\mathrm{pH}$. Given $T = 298.15$ K, $k_B=8.617333262145 \\times 10^{-5}$ eV K$^{-1}$, and $\\mathrm{pH} = 3$:\n$$ k_{B} T \\ln(10) \\cdot \\mathrm{pH} = (8.617333262145 \\times 10^{-5} \\, \\text{eV K}^{-1})(298.15 \\, \\text{K})(\\ln 10)(3) $$\n$$ k_{B} T \\ln(10) \\cdot \\mathrm{pH} \\approx (0.02569256 \\, \\text{eV})(2.302585)(3) \\approx 0.177479 \\, \\text{eV} $$\n\nFinally, we sum all components to find the total reaction free energy $\\Delta G$:\n$$ \\Delta G = \\Delta G_{*\\mathrm{H}}^{\\circ} + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n$$ \\Delta G \\approx 0.120 \\, \\text{eV} + (-0.200 \\, \\text{eV}) + 0.177479 \\, \\text{eV} $$\n$$ \\Delta G \\approx 0.097479 \\, \\text{eV} $$\n\nRounding the final result to four significant figures, we obtain:\n$$ \\Delta G \\approx 0.09748 \\, \\text{eV} $$",
            "answer": "$$\n\\boxed{0.09748}\n$$"
        },
        {
            "introduction": "Pourbaix diagrams are typically constructed for standard temperature ($298.15\\,\\mathrm{K}$), but real-world processes often operate under different conditions. This practice delves into the physical meaning of the lines on a Pourbaix diagram by exploring their response to changes in temperature. By deriving and quantifying the change in the potential–pH slope, you will gain a deeper intuition for the Nernst equation and how fundamental thermodynamic variables shape the regions of material stability .",
            "id": "3480073",
            "problem": "Aqueous electrochemical stability and metal–water equilibria are represented on potential–pH (Pourbaix) diagrams by lines whose slope arises from the coupling between proton activity and electron transfer. Consider a generic half-reaction that consumes or produces $m$ protons and transfers $n$ electrons. At equilibrium, the electrochemical potential is related to the Gibbs free energy change by $\\Delta G = -n F E$, where $F$ is the Faraday constant. The Gibbs free energy at nonstandard conditions is $\\Delta G = \\Delta G^{\\circ} + R T \\ln Q$, where $R$ is the ideal gas constant, $T$ is the absolute temperature, and $Q$ is the reaction quotient constructed from activities, including $a_{\\mathrm{H}^{+}}^{m}$ for protons. The acidity measure is defined by $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^{+}})$, so that $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$.\n\nStarting from these relations, derive the dependence of the equilibrium potential $E$ on $\\mathrm{pH}$ and temperature $T$ for fixed activities of all nonproton species, and then determine how the slope $dE/d(\\mathrm{pH})$ changes with temperature. Using this framework, compute the change in the $\\mathrm{pH}$-slope between $T_{0} = 298.15\\,\\mathrm{K}$ and $T = 350\\,\\mathrm{K}$ for a reaction with $m=1$ and $n=1$.\n\nUse the constants $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$, and $\\ln 10 = 2.302585093$. Assume ideal solution behavior so that activities of all nonproton species are temperature-independent and equal to unity, and neglect pressure and ionic strength effects. Round your final answer to four significant figures. Express the final change in slope in volts per $\\mathrm{pH}$ unit ($\\mathrm{V/pH}$).",
            "solution": "The thermodynamic basis for the equilibrium potential of an electrochemical half-reaction is given by the relation between Gibbs free energy and potential,\n$$\n\\Delta G = - n F E,\n$$\nwhere $n$ is the number of electrons transferred and $F$ is the Faraday constant. The nonstandard Gibbs free energy is related to the standard Gibbs free energy by\n$$\n\\Delta G = \\Delta G^{\\circ} + R T \\ln Q,\n$$\nwhere $R$ is the ideal gas constant, $T$ is the absolute temperature, and $Q$ is the reaction quotient constructed from activities of reactants and products. Combining these and solving for E, we get the Nernst equation:\n$$\nE = E^{\\circ} - \\frac{R T}{n F} \\ln Q,\n$$\nwith $E^{\\circ} \\equiv \\frac{-\\Delta G^{\\circ}}{n F}$.\n\nFor a generic half-reaction that involves $m$ protons as reactants, the reaction quotient contains a factor $a_{\\mathrm{H}^{+}}^{-m}$. If all other activities are held at unity and temperature-independent, then the only $\\mathrm{pH}$-dependent contribution to $\\ln Q$ arises from $a_{\\mathrm{H}^{+}}$. Using the definition $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^{+}})$, one has\n$$\na_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}},\n$$\nand therefore\n$$\n\\ln a_{\\mathrm{H}^{+}} = \\ln\\!\\left(10^{-\\mathrm{pH}}\\right) = -\\mathrm{pH}\\,\\ln 10.\n$$\nSince $Q$ contains $a_{\\mathrm{H}^{+}}^{-m}$, the $\\mathrm{pH}$-dependent part of $\\ln Q$ is $-m \\ln a_{\\mathrm{H}^{+}} = m\\,\\mathrm{pH}\\,\\ln 10$. Substituting into the Nernst relation yields\n$$\nE(\\mathrm{pH},T) = E^{\\circ}(T) - \\frac{R T}{n F}\\left[ \\text{constant terms} + m\\,\\mathrm{pH}\\,\\ln 10 \\right].\n$$\nAbsorbing all $\\mathrm{pH}$-independent terms into an effective intercept, the $\\mathrm{pH}$-dependence of the potential is\n$$\nE(\\mathrm{pH},T) = \\text{intercept}(T) - \\frac{m R T \\ln 10}{n F} \\;\\mathrm{pH}.\n$$\nThus, the slope of $E$ with respect to $\\mathrm{pH}$ at fixed $T$ is\n$$\n\\frac{dE}{d(\\mathrm{pH})} = - \\frac{m R T \\ln 10}{n F}.\n$$\nThe temperature dependence of the slope is therefore linear in $T$. The change in slope between temperatures $T_{0}$ and $T$ is\n$$\n\\Delta S \\equiv \\left.\\frac{dE}{d(\\mathrm{pH})}\\right|_{T} - \\left.\\frac{dE}{d(\\mathrm{pH})}\\right|_{T_{0}} = - \\frac{m R \\ln 10}{n F}\\,(T - T_{0}).\n$$\n\nFor the specific case $m=1$ and $n=1$, with $T_{0} = 298.15\\,\\mathrm{K}$ and $T = 350\\,\\mathrm{K}$, we compute\n$$\n\\Delta T = T - T_{0} = 350 - 298.15 = 51.85\\,\\mathrm{K}.\n$$\nDefine the constant\n$$\nC \\equiv \\frac{R \\ln 10}{F}.\n$$\nUsing the provided constants,\n$$\nC = \\frac{8.314462618 \\times 2.302585093}{96485.33212} \\approx 1.984214 \\times 10^{-4}\\,\\mathrm{V\\,K^{-1}}.\n$$\nThus,\n$$\n\\Delta S = - C \\,\\Delta T = - \\left(1.984214 \\times 10^{-4}\\right) \\times 51.85 = -0.01028815...\n$$\nRounding to four significant figures as requested gives\n$$\n\\Delta S \\approx -0.01029.\n$$\nThe negative sign indicates that the slope becomes more negative (its magnitude increases) as temperature increases from $298.15\\,\\mathrm{K}$ to $350\\,\\mathrm{K}$ for $m=1$ and $n=1$. The numerical value represents the change in volts per $\\mathrm{pH}$ unit.",
            "answer": "$$\\boxed{-0.01029}$$"
        },
        {
            "introduction": "Transitioning from analyzing single reactions to mapping the complete stability of a material requires a systematic and automated workflow. This capstone exercise challenges you to synthesize the concepts from the previous practices into a functional computational tool. You will implement a program that ingests first-principles data and constructs the full set of equilibrium lines for a metal-oxide-water system, effectively building a custom Pourbaix diagram generator from the ground up .",
            "id": "3480020",
            "problem": "You are tasked with writing a complete, runnable program that implements a principled computational workflow to construct electrochemical reaction lines for a Pourbaix (potential–pH) diagram from first-principles thermodynamics. The program must ingest input data consisting of Density Functional Theory (DFT) total energies, thermochemical corrections, and solution activities, and then assemble candidate reactions and compute their corresponding $E$–$\\mathrm{pH}$ line equations. The workflow must be grounded in the equilibrium condition for electrochemical reactions and the thermodynamic definition of chemical potentials. The derivation must start from the following foundations:\n- For an oxidation half-reaction of the form $\\text{Red} \\rightarrow \\text{Ox} + n e^-$, the change in Gibbs free energy is related to the electrode potential $E$ by $\\Delta G = +nFE$.\n- The Gibbs free energy change of a reaction satisfies $\\Delta G = \\Delta G^{\\circ} + R T \\ln Q$, where $R$ is the gas constant, $T$ is the absolute temperature, $Q$ is the reaction quotient constructed from species activities, and $\\Delta G^{\\circ}$ is the standard Gibbs free energy change computed from standard chemical potentials.\n- The chemical potential of a species $i$ is $\\mu_i = \\mu_i^{\\circ} + R T \\ln a_i$, where $a_i$ is the activity of species $i$.\n- The electron electrochemical potential is $\\mu_e = - F E$, where $F$ is the Faraday constant and $E$ is the electrode potential versus the Standard Hydrogen Electrode (SHE).\n- The resulting Nernst relation for an oxidation half-reaction is $E = \\Delta G^{\\circ} / (n F) + (R T / (n F)) \\ln Q$, where $n$ is the number of electrons transferred in the reaction.\n\nYou must implement the following scientifically realistic and self-consistent modeling assumptions:\n1. Standard chemical potentials for condensed phases and molecules are computed from DFT energies plus thermochemical corrections at a specified temperature. For species $i$, use $\\mu_i^{\\circ}(T) = E_i^{\\mathrm{DFT}} + \\Delta_i^{\\mathrm{corr}}(T)$, provided in electronvolt per formula unit. Your code must convert electronvolt to joule per mole using $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$ and Avogadro’s number $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$.\n2. Use the Computational Hydrogen Electrode (CHE) convention to avoid the need for an explicit $\\mu_{\\mathrm{H^+}}^{\\circ}$: at $E = 0$ relative to the Standard Hydrogen Electrode and $\\mathrm{pH} = 0$, $\\mu_{\\mathrm{H^+}}^{\\circ} + \\mu_e^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$. With $\\mu_e^{\\circ} = 0$ at $E = 0$, this sets $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$ for the computation of $\\Delta G^{\\circ}$.\n3. For activities, set $a_{\\mathrm{H_2O}} = 1$ (pure liquid) and $a_{\\mathrm{H_2}} = 1$ at $1\\,\\mathrm{bar}$; for aqueous ions, use the provided activities $a_i$ as inputs; for solids, set activity to $1$.\n\nYour program must assemble candidate reactions of the following types from the provided phases and energies:\n- Water-coupled oxygen-exchange between two metal oxides with oxygen count difference $\\Delta O$: For solids $A$ and $B$ with the same metal stoichiometry and oxygen counts $O_A$ and $O_B$, define $\\Delta O = O_B - O_A$. If $\\Delta O  0$, construct the oxidation half-reaction $A + \\Delta O\\,\\mathrm{H_2O} \\rightarrow B + 2 \\Delta O\\,\\mathrm{H^+} + 2 \\Delta O\\, e^-$. If $\\Delta O  0$, construct the corresponding reduction half-reaction $A + 2 (-\\Delta O)\\,\\mathrm{H^+} + 2 (-\\Delta O)\\, e^- \\rightarrow B + (-\\Delta O)\\,\\mathrm{H_2O}$. These reactions have $n = 2 \\lvert \\Delta O \\rvert$ electrons and net proton stoichiometry $s_{\\mathrm{H}} = \\nu_{\\mathrm{H^+}}^{\\mathrm{products}} - \\nu_{\\mathrm{H^+}}^{\\mathrm{reactants}} = \\pm 2 \\lvert \\Delta O \\rvert$.\n- Metal dissolution to aqueous cation: $M \\rightarrow M^{2+} + 2 e^-$, which has $n = 2$ and $s_{\\mathrm{H}} = 0$.\n\nGiven a reaction, define the reaction quotient excluding the $\\mathrm{H^+}$ activity as $Q_{\\mathrm{nonH}}$, constructed from all non-proton species activities with the usual products-over-reactants convention and stoichiometric powers. Write the $E$–$\\mathrm{pH}$ line as $E(\\mathrm{pH}) = b + m \\,\\mathrm{pH}$ with intercept $b$ and slope $m$:\n- $b = \\Delta G^{\\circ} / (n F) + (R T / (n F)) \\ln Q_{\\mathrm{nonH}}$,\n- $m = - (R T \\ln 10 / (n F))\\, s_{\\mathrm{H}}$, using $\\ln a_{\\mathrm{H^+}} = - \\mathrm{pH} \\ln 10$.\n\nYour program must implement the above and compute $b$ and $m$ for each test reaction, and then evaluate $E(\\mathrm{pH})$ at the specified $\\mathrm{pH}$.\n\nConstants to use:\n- $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$,\n- $F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$,\n- $T = 298.15\\,\\mathrm{K}$.\n\nSpecies data (all energies and corrections are given per formula unit in electronvolt; your program must convert to joule per mole internally):\n- Solid metal $M$: $E_M^{\\mathrm{DFT}} = -6.00$, $\\Delta_M^{\\mathrm{corr}} = +0.05$,\n- Oxide $MO$: $E_{MO}^{\\mathrm{DFT}} = -12.50$, $\\Delta_{MO}^{\\mathrm{corr}} = +0.20$,\n- Oxide $MO_2$: $E_{MO_2}^{\\mathrm{DFT}} = -19.80$, $\\Delta_{MO_2}^{\\mathrm{corr}} = +0.30$,\n- Liquid water $\\mathrm{H_2O}$: $E_{\\mathrm{H_2O}}^{\\mathrm{DFT}} = -14.20$, $\\Delta_{\\mathrm{H_2O}}^{\\mathrm{corr}} = +0.56$,\n- Hydrogen gas $\\mathrm{H_2}$: $E_{\\mathrm{H_2}}^{\\mathrm{DFT}} = -6.80$, $\\Delta_{\\mathrm{H_2}}^{\\mathrm{corr}} = +0.41$,\n- Aqueous cation $M^{2+}$: $E_{M^{2+}}^{\\mathrm{DFT}} = -2.00$, solvation and thermochemical correction $\\Delta_{M^{2+}}^{\\mathrm{corr}} = -4.00$ (combined, yielding a total $\\mu_{M^{2+}}^{\\circ}$ in electronvolt).\n\nAssume oxygen stoichiometries $O_M = 0$, $O_{MO} = 1$, $O_{MO_2} = 2$.\n\nTest suite and required outputs:\n- Test Case 1: Reaction $R_1$: $M + \\mathrm{H_2O} \\rightarrow MO + 2 \\mathrm{H^+} + 2 e^-$, use $\\mathrm{pH} = 7$, $a_{M^{2+}}$ not involved. Output the list $[m, b, E(7)]$ with all values in volt and $m$ in volt per $\\mathrm{pH}$ unit.\n- Test Case 2: Reaction $R_2$: $MO + \\mathrm{H_2O} \\rightarrow MO_2 + 2 \\mathrm{H^+} + 2 e^-$, use $\\mathrm{pH} = 14$, $a_{M^{2+}}$ not involved. Output $[m, b, E(14)]$.\n- Test Case 3: Reaction $R_3$: $MO + 2 \\mathrm{H^+} + 2 e^- \\rightarrow M + \\mathrm{H_2O}$, use $\\mathrm{pH} = 0$, $a_{M^{2+}}$ not involved. Output $[m, b, E(0)]$.\n- Test Case 4: Reaction $R_4$: $M \\rightarrow M^{2+} + 2 e^-$, use $\\mathrm{pH} = 7$, $a_{M^{2+}} = 10^{-6}$. Output $[m, b, E(7)]$.\n- Test Case 5: Reaction $R_4$ again at $\\mathrm{pH} = 7$, but with $a_{M^{2+}} = 1$. Output $[m, b, E(7)]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[m1,b1,E1],[m2,b2,E2],...]\"). Express all potentials in volt and the slopes in volt per $\\mathrm{pH}$ unit. All outputs must be floating-point numbers. The code must be self-contained and must not require any input.",
            "solution": "The core of the computational workflow follows from setting the total electrochemical Gibbs free energy change of a half reaction to zero at equilibrium and separating contributions from standard chemical potentials and activities. For an oxidation half-reaction, $\\text{Red} \\rightarrow \\text{Ox} + n e^-$, the equilibrium condition is $\\Delta G = +nFE$. Using $\\Delta G = \\Delta G^{\\circ} + RT \\ln Q$, we obtain the Nernst relation for the oxidation potential:\n$$\nE = \\frac{\\Delta G^{\\circ}}{n F} + \\frac{R T}{n F} \\ln Q.\n$$\nTo isolate the $\\mathrm{pH}$-dependence, we separate the reaction quotient into proton and non-proton contributions: $\\ln Q = \\ln Q_{\\mathrm{nonH}} + s_{\\mathrm{H}} \\ln a_{\\mathrm{H^+}}$, where $s_{\\mathrm{H}} = \\nu_{\\mathrm{H^+}}^{\\mathrm{products}} - \\nu_{\\mathrm{H^+}}^{\\mathrm{reactants}}$ is the net stoichiometric coefficient of $\\mathrm{H^+}$ and $\\ln a_{\\mathrm{H^+}} = - \\mathrm{pH} \\ln 10$. Hence, the potential can be written as a line in $\\mathrm{pH}$:\n$$\nE(\\mathrm{pH}) = \\left[ \\frac{\\Delta G^{\\circ}}{n F} + \\frac{R T}{n F} \\ln Q_{\\mathrm{nonH}} \\right] - \\left( \\frac{R T \\ln 10}{n F} s_{\\mathrm{H}} \\right) \\mathrm{pH} \\equiv b + m\\,\\mathrm{pH},\n$$\nwith intercept $b = \\Delta G^{\\circ} /(n F) + (R T /(n F)) \\ln Q_{\\mathrm{nonH}}$ and slope $m = - (R T \\ln 10 /(n F)) s_{\\mathrm{H}}$. The sign of $m$ is determined by $s_{\\mathrm{H}}$: if protons are net products, $s_{\\mathrm{H}}  0$ and $m  0$; if protons are net reactants, $s_{\\mathrm{H}}  0$ and $m  0$; if protons do not appear, $s_{\\mathrm{H}} = 0$ and $m = 0$.\n\nThe standard-state Gibbs free energies $\\mu_i^{\\circ}$ are computed from first-principles as $\\mu_i^{\\circ}(T) = E_i^{\\mathrm{DFT}} + \\Delta_i^{\\mathrm{corr}}(T)$, using DFT total energies and thermochemical corrections at temperature $T$. Because inputs are given in electronvolt per formula unit, the code must convert to joule per mole via $1\\,\\mathrm{eV}/\\text{formula unit} \\mapsto (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}) \\approx 96485.33212\\,\\mathrm{J/mol}$. The Computational Hydrogen Electrode (CHE) convention sets the standard chemical potential of the proton without direct DFT evaluation by enforcing the equilibrium with hydrogen gas at $E = 0$ and $\\mathrm{pH} = 0$: $\\mu_{\\mathrm{H^+}}^{\\circ} + \\mu_e^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$ and $\\mu_e^{\\circ} = 0$, giving $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$. This convention allows $\\Delta G^{\\circ}$ for any reaction to be computed entirely from the provided DFT-based energies of solids and molecules.\n\nReaction assembly follows physics-based stoichiometry for oxygen exchange via water:\n- For solids $A$ and $B$ with oxygen counts $O_A$ and $O_B$, define $\\Delta O = O_B - O_A$. If $\\Delta O  0$, construct $A + \\Delta O\\,\\mathrm{H_2O} \\rightarrow B + 2\\Delta O\\,\\mathrm{H^+} + 2\\Delta O\\,e^-$ with $n = 2 \\Delta O$ and $s_{\\mathrm{H}} = + 2 \\Delta O$. If $\\Delta O  0$, construct $A + 2 (-\\Delta O)\\,\\mathrm{H^+} + 2 (-\\Delta O)\\,e^- \\rightarrow B + (-\\Delta O)\\,\\mathrm{H_2O}$ with $n = 2 (-\\Delta O)$ and $s_{\\mathrm{H}} = - 2 (-\\Delta O)$.\n- For metal dissolution, $M \\rightarrow M^{2+} + 2 e^-$, we have $n = 2$ and $s_{\\mathrm{H}} = 0$.\n\nThe standard reaction free energy is computed as\n$$\n\\Delta G^{\\circ} = \\sum_{i \\in \\text{products}} \\nu_i \\mu_i^{\\circ} - \\sum_{j \\in \\text{reactants}} \\nu_j \\mu_j^{\\circ},\n$$\nwith $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$ included where applicable. The non-proton reaction quotient is\n$$\n\\ln Q_{\\mathrm{nonH}} = \\sum_{i \\in \\text{products, } i \\neq \\mathrm{H^+}} \\nu_i \\ln a_i - \\sum_{j \\in \\text{reactants, } j \\neq \\mathrm{H^+}} \\nu_j \\ln a_j,\n$$\nwhere activities $a_i$ for solids and pure liquids are $1$, for $\\mathrm{H_2}$ are $1$ at $1\\,\\mathrm{bar}$, and aqueous ions use provided values.\n\nAlgorithmic steps:\n1. Parse species data and compute $\\mu_i^{\\circ}$ for all species in electronvolt, then convert to joule per mole.\n2. Set $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$ using the CHE convention.\n3. Assemble reactions:\n   - $R_1$: $M + \\mathrm{H_2O} \\rightarrow MO + 2 \\mathrm{H^+} + 2 e^-$ with $n = 2$, $s_{\\mathrm{H}} = +2$.\n   - $R_2$: $MO + \\mathrm{H_2O} \\rightarrow MO_2 + 2 \\mathrm{H^+} + 2 e^-$ with $n = 2$, $s_{\\mathrm{H}} = +2$.\n   - $R_3$: $MO + 2 \\mathrm{H^+} + 2 e^- \\rightarrow M + \\mathrm{H_2O}$ with $n = 2$, $s_{\\mathrm{H}} = -2$.\n   - $R_4$: $M \\rightarrow M^{2+} + 2 e^-$ with $n = 2$, $s_{\\mathrm{H}} = 0$.\n4. For each reaction, compute $\\Delta G^{\\circ}$ in joule per mole from stoichiometric sums, compute $\\ln Q_{\\mathrm{nonH}}$ from the activity map, and form $b$ and $m$ via $b = \\Delta G^{\\circ} /(n F) + (R T /(n F)) \\ln Q_{\\mathrm{nonH}}$ and $m = - (R T \\ln 10 /(n F))\\, s_{\\mathrm{H}}$.\n5. Evaluate $E(\\mathrm{pH}) = b + m\\,\\mathrm{pH}$ at the specified $\\mathrm{pH}$ for each test case.\n6. Output the results as a single line in the required format.\n\nNotably, at $T = 298.15\\,\\mathrm{K}$, one has $(R T / F) \\approx 0.025693\\,\\mathrm{V}$ and $(R T \\ln 10 / F) \\approx 0.05916\\,\\mathrm{V}$. Hence, for the water-coupled reactions with $s_{\\mathrm{H}} = \\pm 2$ and $n = 2$, the slope magnitude is approximately $0.05916\\,\\mathrm{V}$ per $\\mathrm{pH}$ unit, with the sign determined by whether protons are produced (negative slope) or consumed (positive slope). The dissolution reaction has $m = 0$ and its intercept shifts with the aqueous cation activity via $(R T /(n F)) \\ln a_{M^{2+}}$.\n\nThe program implements these steps and produces floating-point outputs in volt with slopes in volt per $\\mathrm{pH}$ unit, aggregated into a single bracketed list per the specification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Physical constants\n    R = 8.314462618  # J/mol/K\n    F = 96485.33212  # C/mol\n    T = 298.15       # K\n    LN10 = np.log(10.0)\n\n    # Conversion: 1 eV per formula unit - J/mol\n    EV_TO_J_PER_MOL = 1.602176634e-19 * 6.02214076e23  # ~96485.33212 J/mol\n\n    # Species standard chemical potentials (mu^0) in eV per formula unit\n    # DFT energies + corrections\n    species_mu0_eV = {\n        \"M(s)\": -6.00 + 0.05,          # -5.95 eV\n        \"MO(s)\": -12.50 + 0.20,        # -12.30 eV\n        \"MO2(s)\": -19.80 + 0.30,       # -19.50 eV\n        \"H2O(l)\": -14.20 + 0.56,       # -13.64 eV\n        \"H2(g)\": -6.80 + 0.41,         # -6.39 eV\n        \"M2+(aq)\": -2.00 + (-4.00),    # -6.00 eV\n        # H+(aq) is set via CHE below\n    }\n\n    # CHE convention: mu^0(H+) = 0.5 * mu^0(H2)\n    species_mu0_eV[\"H+(aq)\"] = 0.5 * species_mu0_eV[\"H2(g)\"]\n\n    # Convert to J/mol\n    species_mu0_Jmol = {k: v * EV_TO_J_PER_MOL for k, v in species_mu0_eV.items()}\n\n    # Activities (defaults; solids and pure liquids have activity 1)\n    default_activities = {\n        \"M(s)\": 1.0,\n        \"MO(s)\": 1.0,\n        \"MO2(s)\": 1.0,\n        \"H2O(l)\": 1.0,\n        \"H2(g)\": 1.0,\n        \"H+(aq)\": None,   # handled via pH\n        \"M2+(aq)\": None,  # set per test case where relevant\n    }\n\n    # Reaction representation: dict with reactants/products lists of (species, coeff),\n    # electron count n, and net proton coefficient s_H = nu_H+_prod - nu_H+_react.\n    def reaction(name, reactants, products, n):\n        # Compute s_H from stoichiometry\n        def coeff_in(side):\n            for sp, nu in side:\n                if sp == \"H+(aq)\":\n                    return nu\n            return 0.0\n        s_H = coeff_in(products) - coeff_in(reactants)\n        return {\"name\": name, \"reactants\": reactants, \"products\": products, \"n\": n, \"s_H\": s_H}\n\n    # Assemble the specific test reactions\n    # R1: M + H2O - MO + 2 H+ + 2 e-\n    R1 = reaction(\n        \"R1\",\n        reactants=[(\"M(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        products=[(\"MO(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        n=2\n    )\n    # R2: MO + H2O - MO2 + 2 H+ + 2 e-\n    R2 = reaction(\n        \"R2\",\n        reactants=[(\"MO(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        products=[(\"MO2(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        n=2\n    )\n    # R3: MO + 2 H+ + 2 e- - M + H2O\n    R3 = reaction(\n        \"R3\",\n        reactants=[(\"MO(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        products=[(\"M(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        n=2\n    )\n    # R4: M - M2+ + 2 e-\n    R4 = reaction(\n        \"R4\",\n        reactants=[(\"M(s)\", 1.0)],\n        products=[(\"M2+(aq)\", 1.0)],\n        n=2\n    )\n\n    reactions = {\"R1\": R1, \"R2\": R2, \"R3\": R3, \"R4\": R4}\n\n    # Compute Delta G^0 (J/mol) and ln Q_nonH for a given reaction given activities\n    def compute_deltaG0_and_lnQ_nonH(rx, activities):\n        # Sum mu^0 for products and reactants\n        G_products = 0.0\n        G_reactants = 0.0\n        for sp, nu in rx[\"products\"]:\n            mu0 = species_mu0_Jmol[sp]\n            G_products += nu * mu0\n        for sp, nu in rx[\"reactants\"]:\n            mu0 = species_mu0_Jmol[sp]\n            G_reactants += nu * mu0\n        deltaG0 = G_products - G_reactants  # J/mol\n\n        # ln Q excluding H+; solids and pure liquids default to activity 1\n        lnQ_nonH = 0.0\n        # Products\n        for sp, nu in rx[\"products\"]:\n            if sp == \"H+(aq)\":\n                continue\n            a = activities.get(sp, default_activities.get(sp, 1.0))\n            if a is None:\n                # If not specified, treat as unity activity\n                a = 1.0\n            lnQ_nonH += nu * np.log(a)\n        # Reactants\n        for sp, nu in rx[\"reactants\"]:\n            if sp == \"H+(aq)\":\n                continue\n            a = activities.get(sp, default_activities.get(sp, 1.0))\n            if a is None:\n                a = 1.0\n            lnQ_nonH -= nu * np.log(a)\n\n        return deltaG0, lnQ_nonH\n\n    # Compute line parameters (slope m and intercept b) and E at given pH\n    def compute_line(rx, pH, activities):\n        deltaG0, lnQ_nonH = compute_deltaG0_and_lnQ_nonH(rx, activities)\n        n = rx[\"n\"]\n        s_H = rx[\"s_H\"]\n        # Intercept and slope\n        b = deltaG0 / (n * F) + (R * T / (n * F)) * lnQ_nonH\n        m = - (R * T / (n * F)) * s_H * LN10\n        E_pH = b + m * pH\n        return m, b, E_pH\n\n    # Define test cases: (reaction_key, pH, activity overrides)\n    test_cases = [\n        (\"R1\", 7.0, {}),                      # R1 at pH 7\n        (\"R2\", 14.0, {}),                     # R2 at pH 14\n        (\"R3\", 0.0, {}),                      # R3 at pH 0\n        (\"R4\", 7.0, {\"M2+(aq)\": 1e-6}),       # R4 at pH 7, trace cation activity\n        (\"R4\", 7.0, {\"M2+(aq)\": 1.0}),        # R4 at pH 7, unit cation activity\n    ]\n\n    results = []\n    for key, pH, acts in test_cases:\n        rx = reactions[key]\n        m, b, E_pH = compute_line(rx, pH, acts)\n        results.append([m, b, E_pH])\n\n    # Final print statement in the exact required format.\n    # Ensure pure Python float serialization without extra text.\n    def format_list(lst):\n        return \"[\" + \",\".join(map(lambda x: str(x), lst)) + \"]\"\n    print(\"[\" + \",\".join(format_list(res) for res in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}