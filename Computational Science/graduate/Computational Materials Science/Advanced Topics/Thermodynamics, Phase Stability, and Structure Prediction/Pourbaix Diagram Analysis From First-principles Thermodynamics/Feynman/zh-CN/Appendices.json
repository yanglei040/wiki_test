{
    "hands_on_practices": [
        {
            "introduction": "电位-pH图上的线条斜率由能斯特方程决定，它将电化学势与质子和电子的转移联系起来。虽然我们常在室温下使用 $- \\frac{m}{n} \\times 59 \\,\\mathrm{mV/pH}$ 这一近似值，但理解该斜率如何随温度变化，对于在非标准条件下（例如在高温腐蚀或电催化中）的应用至关重要。本练习旨在通过一个基础的计算，深化我们对控制电化学平衡的基本热力学参数的理解。",
            "id": "3480073",
            "problem": "水溶液的电化学稳定性和金属-水平衡在电位-pH图（Pourbaix图）上用线表示，其斜率源于质子活度和电子转移之间的耦合。考虑一个消耗或产生 $m$ 个质子并转移 $n$ 个电子的通用半反应。在平衡状态下，电化学电位与 Gibbs 自由能变的关系为 $\\Delta G = -n F E$，其中 $F$ 是 Faraday 常数。在非标准条件下，Gibbs 自由能为 $\\Delta G = \\Delta G^{\\circ} + R T \\ln Q$，其中 $R$ 是理想气体常数，$T$ 是绝对温度，$Q$ 是由包括质子的 $a_{\\mathrm{H}^{+}}^{m}$ 在内的各种物质的活度构成的反应商。酸度的度量定义为 $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^{+}})$，因此 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$。\n\n从这些关系出发，对于所有非质子物种活度固定的情况，推导平衡电位 $E$ 对 $\\mathrm{pH}$ 和温度 $T$ 的依赖关系，然后确定斜率 $dE/d(\\mathrm{pH})$ 如何随温度变化。使用此框架，计算一个 $m=1$ 且 $n=1$ 的反应在 $T_{0} = 298.15\\,\\mathrm{K}$ 和 $T = 350\\,\\mathrm{K}$ 之间，pH斜率的变化量。\n\n使用常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$ 和 $\\ln 10 = 2.302585093$。假设理想溶液行为，因此所有非质子物种的活度均不依赖于温度且等于1，并忽略压力和离子强度的影响。将最终答案四舍五入至四位有效数字。以伏特每pH单位（$\\mathrm{V/pH}$）表示最终的斜率变化。",
            "solution": "电化学半反应平衡电位的热力学基础由 Gibbs 自由能和电位之间的关系给出，\n$$\n\\Delta G = - n F E,\n$$\n其中 $n$ 是转移的电子数，$F$ 是 Faraday 常数。非标准 Gibbs 自由能与标准 Gibbs 自由能的关系为\n$$\n\\Delta G = \\Delta G^{\\circ} + R T \\ln Q,\n$$\n其中 $R$ 是理想气体常数，$T$ 是绝对温度，$Q$ 是由反应物和产物的活度构成的反应商。在平衡状态下，我们得到\n$$\nE = E^{\\circ} - \\frac{R T}{n F} \\ln Q,\n$$\n其中 $E^{\\circ} \\equiv \\frac{\\Delta G^{\\circ}}{-n F}$。\n\n对于一个涉及 $m$ 个质子的通用半反应，反应商包含因子 $a_{\\mathrm{H}^{+}}^{m}$。如果所有其他活度都保持为1且不随温度变化，那么 $\\ln Q$ 中唯一依赖于pH的贡献来自于 $a_{\\mathrm{H}^{+}}$。使用定义 $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^{+}})$，我们有\n$$\na_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}},\n$$\n因此\n$$\n\\ln a_{\\mathrm{H}^{+}} = \\ln\\!\\left(10^{-\\mathrm{pH}}\\right) = -\\mathrm{pH}\\,\\ln 10.\n$$\n假设质子是反应物，反应商 $Q$ 中包含 $1/a_{\\mathrm{H}^{+}}^{m}$ 因子。因此 $\\ln Q$ 中依赖于pH的部分是 $-m \\ln a_{\\mathrm{H}^{+}} = m\\,\\mathrm{pH}\\,\\ln 10$。将其代入 Nernst 关系得到\n$$\nE(\\mathrm{pH},T) = E^{\\circ}(T) - \\frac{R T}{n F}\\left[ \\text{常数项} + m\\,\\mathrm{pH}\\,\\ln 10 \\right].\n$$\n将所有不依赖于pH的项吸收到一个有效截距中，电位对pH的依赖关系为\n$$\nE(\\mathrm{pH},T) = \\text{截距}(T) - \\frac{m R T}{n F}\\,\\ln 10 \\cdot \\mathrm{pH}.\n$$\n因此，在固定温度 $T$ 下，$E$ 相对于 $\\mathrm{pH}$ 的斜率为\n$$\n\\frac{dE}{d(\\mathrm{pH})} = - \\frac{m R T}{n F}\\,\\ln 10.\n$$\n因此，斜率对温度的依赖性是线性的。在温度 $T_{0}$ 和 $T$ 之间，斜率的变化量为\n$$\n\\Delta S \\equiv \\left.\\frac{dE}{d(\\mathrm{pH})}\\right|_{T} - \\left.\\frac{dE}{d(\\mathrm{pH})}\\right|_{T_{0}} = - \\frac{m R \\ln 10}{n F}\\,(T - T_{0}).\n$$\n\n对于 $m=1$ 和 $n=1$ 的特定情况，当 $T_{0} = 298.15\\,\\mathrm{K}$ 且 $T = 350\\,\\mathrm{K}$ 时，我们计算\n$$\n\\Delta T = T - T_{0} = 350 - 298.15 = 51.85\\,\\mathrm{K}.\n$$\n定义常数\n$$\nC \\equiv \\frac{R \\ln 10}{F}.\n$$\n使用给定的常数，\n$$\nC = \\frac{8.314462618 \\times 2.302585093}{96485.33212}.\n$$\n首先计算分子：\n$$\n8.314462618 \\times 2.302585093 = 19.14480608.\n$$\n然后除以 $96485.33212$：\n$$\nC = \\frac{19.14480608}{96485.33212} \\approx 1.9842143 \\times 10^{-4}.\n$$\n因此，\n$$\n\\Delta S = - C \\,\\Delta T = - \\left(1.9842143 \\times 10^{-4}\\right) \\times 51.85 = -0.0102881512.\n$$\n按要求四舍五入到四位有效数字，得到\n$$\n\\Delta S \\approx -0.01029.\n$$\n负号表示对于 $m=1$ 和 $n=1$ 的情况，当温度从 $298.15\\,\\mathrm{K}$ 升高到 $350\\,\\mathrm{K}$ 时，斜率变得更负（其绝对值增大）。该数值代表每pH单位的伏特数变化量。",
            "answer": "$$\\boxed{-0.01029}$$"
        },
        {
            "introduction": "为了从第一性原理构建电位-pH图，我们需要一个可靠的方法来从量子力学模拟中计算反应自由能。计算氢电极 (Computational Hydrogen Electrode, CHE) 模型是为此目的而设的标准方法，它能够一致地定义质子-电子对在任意电极电位 $U$ 和酸度 $\\mathrm{pH}$ 下的化学势。本练习将引导你推导并应用CHE模型于一个基本的表面吸附反应，这是计算电化学领域的一项核心技能。",
            "id": "3480091",
            "problem": "金属氧化物表面上的单氢吸附步骤可以写为半反应 $* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$，其中 $*$ 表示一个空的表面位点。仅从以化学势表示的反应自由能的定义以及氢氧化还原电对的平衡条件出发，使用计算氢电极 (Computational Hydrogen Electrode, CHE) 形式论，推导在有限电极电势和酸度下此质子-电子转移的电化学自由能变化表达式。然后根据第一性原理的输入数据对其进行数值计算。\n\n假设在温度 $T = 298.15$ K 下，通过密度泛函理论 (Density Functional Theory, DFT) 获得了一个表面晶胞的以下数据：\n- 总能量：$E_{\\mathrm{DFT}}(*) = -385.000$ eV, $E_{\\mathrm{DFT}}(*\\mathrm{H}) = -388.750$ eV, $E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) = -7.000$ eV。\n- 有限温度自由能校正（吸附物的零点能加热振动贡献；在 1 bar 下 $\\mathrm{H}_{2}$ 的表格化零点能加熵校正）：$\\Delta G_{\\mathrm{corr}}(*) = 0.000$ eV, $\\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) = 0.290$ eV, $\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) = -0.160$ eV。\n\n设电极电势相对于标准氢电极 (Standard Hydrogen Electrode, SHE) 为 $U = -0.200$ V，酸度为 $\\mathrm{pH} = 3$。使用 Boltzmann 常数 $k_{B} = 8.617333262145 \\times 10^{-5}$ eV K$^{-1}$ 和数学常数 $\\ln 10$。将基本电荷 $e$ 进行隐式处理，使得以电子伏特为单位的 $eU$ 在数值上等于以伏特为单位的 $U$。\n\n以电子伏特表示 $* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$ 的最终反应自由能。将你的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导表面单氢吸附步骤的电化学自由能变化 $\\Delta G$，然后进行数值计算。反应式如下：\n$$* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$$\n其中 $*$ 代表一个空的表面位点，而 $*\\mathrm{H}$ 代表吸附在该位点上的一个氢原子。\n\n推导从反应自由能的基本定义开始，即产物和反应物的化学势 ($\\mu$) 之差：\n$$ \\Delta G = \\mu_{*\\mathrm{H}} - (\\mu_{*} + \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}}) $$\n\n在计算材料科学中，表面物种（裸位点 $*$ 和吸附氢位点 $*\\mathrm{H}$）的化学势近似为其吉布斯自由能 ($G$)。这些自由能通过将有限温度自由能校正 $\\Delta G_{\\mathrm{corr}}$ 加到由密度泛函理论 (DFT) 得到的总能量 $E_{\\mathrm{DFT}}$ 上来计算。\n$$ \\mu_{*} \\approx G_{*} = E_{\\mathrm{DFT}}(*) + \\Delta G_{\\mathrm{corr}}(*) $$\n$$ \\mu_{*\\mathrm{H}} \\approx G_{*\\mathrm{H}} = E_{\\mathrm{DFT}}(*\\mathrm{H}) + \\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) $$\n\n主要的挑战是在电化学环境中确定质子-电子对的化学势 $\\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}}$。计算氢电极 (CHE) 形式论为此提供了一种可靠的方法。CHE 模型通过考虑析氢/氧化反应的平衡，将 $(\\mathrm{H}^{+} + e^{-})$ 对的化学势与气态氢 $\\mathrm{H}_{2}$ 的化学势联系起来：\n$$ \\mathrm{H}^{+} + e^{-} \\leftrightarrow \\frac{1}{2} \\mathrm{H}_{2}(\\mathrm{g}) $$\n根据标准氢电极 (SHE) 的定义，该反应在标准条件下达到平衡：电极电势 $U = 0$ V vs. SHE，酸度 $\\mathrm{pH} = 0$（对应于质子活度 $a_{\\mathrm{H}^{+}} = 1$），以及在给定温度 $T$ 下氢气压力 $p_{\\mathrm{H}_{2}} = 1$ bar。在平衡状态下，反应物和产物的化学势相等。因此，在标准条件下：\n$$ \\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0) = \\frac{1}{2}\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} $$\n标准条件下氢气的化学势 $\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ}$ 的计算方式与表面物种类似：\n$$ \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} = E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) + \\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) $$\n因此，在标准条件下：\n$$ \\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0) = \\frac{1}{2} \\left[ E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) + \\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) \\right] $$\n\n现在，我们引入非标准电极电势 $U$ 和酸度 $\\mathrm{pH}$ 的影响。\n相对于 SHE，在电势 $U$ 下的电子的化学势会移动 $-eU$，其中 $e$ 是基本电荷：\n$$ \\mu_{e^{-}}(U) = \\mu_{e^{-}}(U=0) - eU $$\n质子的化学势取决于其活度 $a_{\\mathrm{H}^{+}}$：\n$$ \\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} + k_{B} T \\ln(a_{\\mathrm{H}^{+}}) $$\n使用酸度的定义 $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$，我们可以写出 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}} = \\exp(-\\mathrm{pH} \\ln 10)$。将其代入 $\\mu_{\\mathrm{H}^{+}}$ 的表达式中得到：\n$$ \\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} - k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\n结合这些项，在任意 $U$ 和 $\\mathrm{pH}$ 下，$(\\mathrm{H}^{+} + e^{-})$ 对的化学势为：\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = (\\mu_{\\mathrm{H}^{+}}^{\\circ} + k_{B} T \\ln(a_{\\mathrm{H}^{+}})) + (\\mu_{e^{-}}(U=0) - eU) $$\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = (\\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0)) - eU + k_{B} T \\ln(a_{\\mathrm{H}^{+}}) $$\n代入 CHE 平衡条件和 $a_{\\mathrm{H}^{+}}$ 的表达式：\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} - eU - k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\n最后，我们将此表达式代回到反应自由能 $\\Delta G$ 的原始方程中：\n$$ \\Delta G = (\\mu_{*\\mathrm{H}} - \\mu_{*}) - \\left( \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} - eU - k_{B} T \\ln(10) \\cdot \\mathrm{pH} \\right) $$\n整理各项，我们得到：\n$$ \\Delta G = \\left( \\mu_{*\\mathrm{H}} - \\mu_{*} - \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} \\right) + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n括号中的项是在标准条件下从气态 $\\mathrm{H}_{2}$ 吸附氢的吉布斯自由能，通常表示为 $\\Delta G_{*\\mathrm{H}}^{\\circ}$：\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = (\\mu_{*\\mathrm{H}} - \\mu_{*}) - \\frac{1}{2}\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} $$\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = \\left[E_{\\mathrm{DFT}}(*\\mathrm{H}) - E_{\\mathrm{DFT}}(*) - \\frac{1}{2}E_{\\mathrm{DFT}}(\\mathrm{H}_{2})\\right] + \\left[\\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) - \\Delta G_{\\mathrm{corr}}(*) - \\frac{1}{2}\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2})\\right] $$\n因此，电化学自由能变化的最终表达式为：\n$$ \\Delta G(U, \\mathrm{pH}) = \\Delta G_{*\\mathrm{H}}^{\\circ} + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\n现在，我们使用所提供的数据对该表达式进行数值计算。\n问题指明，将基本电荷 $e$ 进行处理，使得以电子伏特 (eV) 为单位的 $eU$ 在数值上等于以伏特 (V) 为单位的 $U$。\n\n首先，我们计算对 $\\Delta G_{*\\mathrm{H}}^{\\circ}$ 的 DFT 能量贡献，即吸附能 $\\Delta E_{\\text{ads}}$：\n$$ \\Delta E_{\\text{ads}} = E_{\\mathrm{DFT}}(*\\mathrm{H}) - E_{\\mathrm{DFT}}(*) - \\frac{1}{2}E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) $$\n$$ \\Delta E_{\\text{ads}} = -388.750 \\, \\text{eV} - (-385.000 \\, \\text{eV}) - \\frac{1}{2}(-7.000 \\, \\text{eV}) $$\n$$ \\Delta E_{\\text{ads}} = (-388.750 + 385.000 + 3.500) \\, \\text{eV} = -0.250 \\, \\text{eV} $$\n\n其次，我们计算自由能校正的贡献 $\\Delta(\\Delta G_{\\mathrm{corr}})$：\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = \\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) - \\Delta G_{\\mathrm{corr}}(*) - \\frac{1}{2}\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) $$\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = 0.290 \\, \\text{eV} - 0.000 \\, \\text{eV} - \\frac{1}{2}(-0.160 \\, \\text{eV}) $$\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = (0.290 + 0.080) \\, \\text{eV} = 0.370 \\, \\text{eV} $$\n\n第三，我们计算 $\\Delta G_{*\\mathrm{H}}^{\\circ}$：\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = \\Delta E_{\\text{ads}} + \\Delta(\\Delta G_{\\mathrm{corr}}) = -0.250 \\, \\text{eV} + 0.370 \\, \\text{eV} = 0.120 \\, \\text{eV} $$\n\n第四，我们计算与电势和 pH 相关的项。\n与电势相关的项是 $eU$。给定 $U = -0.200$ V，该项为：\n$$ eU = -0.200 \\, \\text{eV} $$\n与 pH 相关的项是 $k_{B} T \\ln(10) \\cdot \\mathrm{pH}$。给定 $T = 298.15$ K， $k_B=8.617333262145 \\times 10^{-5}$ eV K$^{-1}$，以及 $\\mathrm{pH} = 3$：\n$$ k_{B} T \\ln(10) \\cdot \\mathrm{pH} = (8.617333262145 \\times 10^{-5} \\, \\text{eV K}^{-1})(298.15 \\, \\text{K})(\\ln 10)(3) $$\n$$ k_{B} T \\ln(10) \\cdot \\mathrm{pH} \\approx (0.02569256 \\, \\text{eV})(2.302585)(3) \\approx 0.177479 \\, \\text{eV} $$\n\n最后，我们对所有分量求和，以求得总反应自由能 $\\Delta G$：\n$$ \\Delta G = \\Delta G_{*\\mathrm{H}}^{\\circ} + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n$$ \\Delta G \\approx 0.120 \\, \\text{eV} + (-0.200 \\, \\text{eV}) + 0.177479 \\, \\text{eV} $$\n$$ \\Delta G \\approx 0.097479 \\, \\text{eV} $$\n\n将最终结果四舍五入到四位有效数字，我们得到：\n$$ \\Delta G \\approx 0.09748 \\, \\text{eV} $$",
            "answer": "$$\n\\boxed{0.09748}\n$$"
        },
        {
            "introduction": "现在，我们将综合前面练习中的概念，构建一个完整的计算程序，将理论付诸实践。本练习要求你编写一个工作流，该工作流能够接收各种物种的原始DFT能量和热化学数据，并自动为它们之间的电化学平衡线生成线性方程（$E = b + m \\cdot \\mathrm{pH}$）。掌握此工作流将使你能够从第一性原理数据出发，系统地构建整个电位-pH图，这是预测和设计功能材料的一个强大工具。",
            "id": "3480020",
            "problem": "您的任务是编写一个完整、可运行的程序，该程序实现一个基于第一性原理的计算工作流，用于从第一性原理热力学构建普尔拜（电势-pH）图的电化学反应线。该程序必须接收输入数据，包括密度泛函理论（DFT）总能量、热化学修正和溶液活度，然后组合候选反应并计算它们相应的 $E$–$\\mathrm{pH}$ 线性方程。该工作流必须基于电化学反应的平衡条件和化学势的热力学定义。推导必须从以下基础出发：\n- 反应的吉布斯自由能变化满足 $\\Delta G = \\Delta G^{\\circ} + R T \\ln Q$，其中 $R$ 是气体常数，$T$ 是绝对温度，$Q$ 是由物种活度构成的反应商，$\\Delta G^{\\circ}$ 是由标准化学势计算出的标准吉布斯自由能变化。\n- 物种 $i$ 的化学势为 $\\mu_i = \\mu_i^{\\circ} + R T \\ln a_i$，其中 $a_i$ 是物种 $i$ 的活度。\n- 电子的电化学势为 $\\mu_e = - F E$，其中 $F$ 是法拉第常数，$E$ 是相对于标准氢电极（SHE）的电极电势。\n- 将平衡电势与反应热力学联系起来的能斯特关系为 $E = - \\Delta G^{\\circ} / (n F) - (R T / (n F)) \\ln Q$，其中 $n$ 是反应中转移的电子数。\n\n您必须实现以下科学上真实且自洽的建模假设：\n1. 凝聚相和分子的标准化学势由DFT能量加上指定温度下的热化学修正计算得出。对于物种 $i$，使用 $\\mu_i^{\\circ}(T) = E_i^{\\mathrm{DFT}} + \\Delta_i^{\\mathrm{corr}}(T)$，单位为电子伏特每化学式单位。您的代码必须使用 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$ 和阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$ 将电子伏特转换为焦耳每摩尔。\n2. 使用计算氢电极（CHE）约定，以避免需要显式的 $\\mu_{\\mathrm{H^+}}^{\\circ}$：在相对于标准氢电极 $E = 0$ 和 $\\mathrm{pH} = 0$ 时，$\\mu_{\\mathrm{H^+}}^{\\circ} + \\mu_e^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。由于在 $E = 0$ 时 $\\mu_e^{\\circ} = 0$，这设定了用于计算 $\\Delta G^{\\circ}$ 的 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。\n3. 对于活度，设定 $a_{\\mathrm{H_2O}} = 1$（纯液体）和 $a_{\\mathrm{H_2}} = 1$（在 $1\\,\\mathrm{bar}$ 下）；对于水合离子，使用提供的活度 $a_i$ 作为输入；对于固体，将活度设为 $1$。\n\n您的程序必须根据所提供的相和能量，组合以下类型的候选反应：\n- 两个金属氧化物之间与水耦合的氧交换反应，氧数差异为 $\\Delta O$：对于具有相同金属化学计量和氧数 $O_A$ 和 $O_B$ 的固体 $A$ 和 $B$，定义 $\\Delta O = O_B - O_A$。如果 $\\Delta O > 0$，构建氧化半反应 $A + \\Delta O\\,\\mathrm{H_2O} \\rightarrow B + 2 \\Delta O\\,\\mathrm{H^+} + 2 \\Delta O\\, e^-$。如果 $\\Delta O  0$，构建相应的还原半反应 $A + 2 (-\\Delta O)\\,\\mathrm{H^+} + 2 (-\\Delta O)\\, e^- \\rightarrow B + (-\\Delta O)\\,\\mathrm{H_2O}$。这些反应转移 $n = 2|\\Delta O|$ 个电子，其净质子化学计量为 $s_{\\mathrm{H}} = \\nu_{\\mathrm{H^+}}^{\\text{products}} - \\nu_{\\mathrm{H^+}}^{\\text{reactants}} = 2\\Delta O$。\n- 金属溶解为水合阳离子：$M \\rightarrow M^{2+} + 2 e^-$，该反应有 $n = 2$ 和 $s_{\\mathrm{H}} = 0$。\n\n给定一个反应，将排除 $\\mathrm{H^+}$ 活度的反应商定义为 $Q_{\\mathrm{nonH}}$，其由所有非质子物种的活度按照常规的产物与反应物之比以及化学计量幂次构建。将 $E$–$\\mathrm{pH}$ 线性方程写为 $E(\\mathrm{pH}) = b + m \\,\\mathrm{pH}$，其中截距为 $b$，斜率为 $m$：\n- $b = - \\Delta G^{\\circ} / (n F) - (R T / (n F)) \\ln Q_{\\mathrm{nonH}}$，\n- $m = \\frac{R T \\ln 10}{n F} s_{\\mathrm{H}}$，使用 $\\ln a_{\\mathrm{H^+}} = - \\mathrm{pH} \\ln 10$。\n\n您的程序必须实现以上内容，并为每个测试反应计算 $b$ 和 $m$，然后在指定的 $\\mathrm{pH}$ 值下计算 $E(\\mathrm{pH})$。\n\n使用的常数：\n- $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，\n- $F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$，\n- $T = 298.15\\,\\mathrm{K}$。\n\n物种数据（所有能量和修正均以电子伏特每化学式单位给出；您的程序必须在内部将其转换为焦耳每摩尔）：\n- 固体金属 $M$：$E_M^{\\mathrm{DFT}} = -6.00$，$\\Delta_M^{\\mathrm{corr}} = +0.05$，\n- 氧化物 $MO$：$E_{MO}^{\\mathrm{DFT}} = -12.50$，$\\Delta_{MO}^{\\mathrm{corr}} = +0.20$，\n- 氧化物 $MO_2$：$E_{MO_2}^{\\mathrm{DFT}} = -19.80$，$\\Delta_{MO_2}^{\\mathrm{corr}} = +0.30$，\n- 液态水 $\\mathrm{H_2O}$：$E_{\\mathrm{H_2O}}^{\\mathrm{DFT}} = -14.20$，$\\Delta_{\\mathrm{H_2O}}^{\\mathrm{corr}} = +0.56$，\n- 氢气 $\\mathrm{H_2}$：$E_{\\mathrm{H_2}}^{\\mathrm{DFT}} = -6.80$，$\\Delta_{\\mathrm{H_2}}^{\\mathrm{corr}} = +0.41$，\n- 水合阳离子 $M^{2+}$：$E_{M^{2+}}^{\\mathrm{DFT}} = -2.00$，溶剂化和热化学修正 $\\Delta_{M^{2+}}^{\\mathrm{corr}} = -4.00$（合并后，以电子伏特为单位得到总的 $\\mu_{M^{2+}}^{\\circ}$）。\n\n假设氧的化学计量为 $O_M = 0$，$O_{MO} = 1$，$O_{MO_2} = 2$。\n\n测试套件和要求的输出：\n- 测试用例 1：反应 $R_1$：$M + \\mathrm{H_2O} \\rightarrow MO + 2 \\mathrm{H^+} + 2 e^-$，使用 $\\mathrm{pH} = 7$，不涉及 $a_{M^{2+}}$。输出列表 $[m, b, E(7)]$，所有值以伏特为单位，$m$ 的单位为伏特每pH单位。\n- 测试用例 2：反应 $R_2$：$MO + \\mathrm{H_2O} \\rightarrow MO_2 + 2 \\mathrm{H^+} + 2 e^-$，使用 $\\mathrm{pH} = 14$，不涉及 $a_{M^{2+}}$。输出 $[m, b, E(14)]$。\n- 测试用例 3：反应 $R_3$：$MO + 2 \\mathrm{H^+} + 2 e^- \\rightarrow M + \\mathrm{H_2O}$，使用 $\\mathrm{pH} = 0$，不涉及 $a_{M^{2+}}$。输出 $[m, b, E(0)]$。\n- 测试用例 4：反应 $R_4$：$M \\rightarrow M^{2+} + 2 e^-$，使用 $\\mathrm{pH} = 7$，$a_{M^{2+}} = 10^{-6}$。输出 $[m, b, E(7)]$。\n- 测试用例 5：再次测试反应 $R_4$，$\\mathrm{pH} = 7$，但 $a_{M^{2+}} = 1$。输出 $[m, b, E(7)]$。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表（例如，“[[m1,b1,E1],[m2,b2,E2],...]”）。所有电势以伏特表示，斜率以伏特每pH单位表示。所有输出必须是浮点数。代码必须是自包含的，且不应需要任何输入。",
            "solution": "计算工作流的核心在于，在平衡状态下，将半反应的总电化学吉布斯自由能变化设为零，并分离标准化学势和活度的贡献。对于一个转移了 $n$ 个电子的半反应，其电化学反应的平衡条件是 $\\sum_i \\nu_i \\mu_i + n \\mu_e = 0$，其中 $\\nu_i$ 是物种 $i$ 的化学计量系数，按照惯例，产物的系数为正，反应物的系数为负，$\\mu_i$ 是物种 $i$ 的化学势，$\\mu_e$ 是电子的电化学势。使用 $\\mu_i = \\mu_i^{\\circ} + R T \\ln a_i$ 和 $\\mu_e = - F E$，我们可以写出\n$$\n\\sum_i \\nu_i \\mu_i^{\\circ} + R T \\sum_i \\nu_i \\ln a_i - n F E = 0.\n$$\n将标准态项 $\\sum_i \\nu_i \\mu_i^{\\circ} \\equiv \\Delta G^{\\circ}$ 和活度项 $R T \\sum_i \\nu_i \\ln a_i \\equiv R T \\ln Q$ 收集起来，并利用能斯特关系，我们得到\n$$\nE = \\frac{\\Delta G^{\\circ}}{-n F} + \\frac{R T \\ln Q}{-n F}.\n$$\n为了分离对 $\\mathrm{pH}$ 的依赖性，将反应商分为质子和非质子贡献：$\\ln Q = \\ln Q_{\\mathrm{nonH}} + s_{\\mathrm{H}} \\ln a_{\\mathrm{H^+}}$，其中 $s_{\\mathrm{H}} = \\nu_{\\mathrm{H^+}}^{\\mathrm{products}} - \\nu_{\\mathrm{H^+}}^{\\mathrm{reactants}}$ 是出现在商中的 $\\mathrm{H^+}$ 的净化学计量系数，且 $\\ln a_{\\mathrm{H^+}} = - \\mathrm{pH} \\ln 10$。因此，电势可以写成关于 $\\mathrm{pH}$ 的线性方程：\n$$\nE(\\mathrm{pH}) = \\left[ - \\frac{\\Delta G^{\\circ}}{n F} - \\frac{R T}{n F} \\ln Q_{\\mathrm{nonH}} \\right] + \\left( \\frac{R T s_{\\mathrm{H}} \\ln 10}{n F} \\right) \\mathrm{pH} \\equiv b + m\\,\\mathrm{pH},\n$$\n其中截距 $b = - \\Delta G^{\\circ} /(n F) - (R T /(n F)) \\ln Q_{\\mathrm{nonH}}$，斜率 $m = \\frac{R T s_{\\mathrm{H}} \\ln 10}{n F}$。$m$ 的符号由 $s_{\\mathrm{H}}$ 决定：如果质子是净产物，$s_{\\mathrm{H}} > 0$ 且 $m > 0$；如果质子是净反应物，$s_{\\mathrm{H}}  0$ 且 $m  0$；如果反应中没有质子，$s_{\\mathrm{H}} = 0$ 且 $m = 0$。\n\n标准态吉布斯自由能 $\\mu_i^{\\circ}$ 是从第一性原理计算得出的，即 $\\mu_i^{\\circ}(T) = E_i^{\\mathrm{DFT}} + \\Delta_i^{\\mathrm{corr}}(T)$，使用DFT总能量和在温度 $T$ 下的热化学修正。因为输入是以电子伏特每化学式单位给出的，代码必须通过 $1\\,\\mathrm{eV}/\\text{formula unit} \\mapsto (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}) \\approx 96485.33212\\,\\mathrm{J/mol}$ 转换为焦耳每摩尔。计算氢电极（CHE）约定通过在 $E = 0$ 和 $\\mathrm{pH} = 0$ 时强制与氢气达到平衡来设定质子的标准化学势，而无需直接进行DFT评估：$\\mu_{\\mathrm{H^+}}^{\\circ} + \\mu_e^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$ 且 $\\mu_e^{\\circ} = 0$，从而得到 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。这个约定使得 $\\Delta G^{\\circ}$ 可以完全由所提供的固体和分子的基于DFT的能量计算出来。\n\n反应的组合遵循基于物理的、通过水进行氧交换的化学计量：\n- 对于氧数为 $O_A$ 和 $O_B$ 的固体 $A$ 和 $B$，定义 $\\Delta O = O_B - O_A$。如果 $\\Delta O > 0$，构建 $A + \\Delta O\\,\\mathrm{H_2O} \\rightarrow B + 2\\Delta O\\,\\mathrm{H^+} + 2\\Delta O\\,e^-$，其中 $n = 2 \\Delta O$ 且 $s_{\\mathrm{H}} = + 2 \\Delta O$。如果 $\\Delta O  0$，构建 $A + 2 (-\\Delta O)\\,\\mathrm{H^+} + 2 (-\\Delta O)\\,e^- \\rightarrow B + (-\\Delta O)\\,\\mathrm{H_2O}$，其中 $n = 2 (-\\Delta O)$ 且 $s_{\\mathrm{H}} = - 2 (-\\Delta O)$。\n- 对于金属溶解，$M \\rightarrow M^{2+} + 2 e^-$，我们有 $n = 2$ 和 $s_{\\mathrm{H}} = 0$。\n\n标准反应自由能计算如下：\n$$\n\\Delta G^{\\circ} = \\sum_{i \\in \\text{products}} \\nu_i \\mu_i^{\\circ} - \\sum_{j \\in \\text{reactants}} \\nu_j \\mu_j^{\\circ},\n$$\n在适用时包括 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。非质子反应商为\n$$\n\\ln Q_{\\mathrm{nonH}} = \\sum_{i \\in \\text{products, } i \\neq \\mathrm{H^+}} \\nu_i \\ln a_i - \\sum_{j \\in \\text{reactants, } j \\neq \\mathrm{H^+}} \\nu_j \\ln a_j,\n$$\n其中固体和纯液体的活度 $a_i$ 为 $1$，$\\mathrm{H_2}$ 在 $1\\,\\mathrm{bar}$ 下的活度为 $1$，水合离子使用提供的值。\n\n算法步骤：\n1. 解析物种数据，计算所有物种的 $\\mu_i^{\\circ}$（单位：电子伏特），然后转换为焦耳每摩尔。\n2. 使用CHE约定，设置 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。\n3. 组合反应：\n   - $R_1$: $M + \\mathrm{H_2O} \\rightarrow MO + 2 \\mathrm{H^+} + 2 e^-$，其中 $n = 2$, $s_{\\mathrm{H}} = +2$。\n   - $R_2$: $MO + \\mathrm{H_2O} \\rightarrow MO_2 + 2 \\mathrm{H^+} + 2 e^-$，其中 $n = 2$, $s_{\\mathrm{H}} = +2$。\n   - $R_3$: $MO + 2 \\mathrm{H^+} + 2 e^- \\rightarrow M + \\mathrm{H_2O}$，其中 $n = 2$, $s_{\\mathrm{H}} = -2$。\n   - $R_4$: $M \\rightarrow M^{2+} + 2 e^-$，其中 $n = 2$, $s_{\\mathrm{H}} = 0$。\n4. 对每个反应，从化学计量总和计算 $\\Delta G^{\\circ}$（单位：焦耳每摩尔），从活度映射计算 $\\ln Q_{\\mathrm{nonH}}$，并通过 $b = - \\Delta G^{\\circ} /(n F) - (R T /(n F)) \\ln Q_{\\mathrm{nonH}}$ 和 $m = \\frac{R T s_{\\mathrm{H}} \\ln 10}{n F}$ 构建 $b$ 和 $m$。\n5. 对每个测试用例，在指定的 $\\mathrm{pH}$ 值下计算 $E(\\mathrm{pH}) = b + m\\,\\mathrm{pH}$。\n6. 按要求的格式将结果作为单行输出。\n\n值得注意的是，在 $T = 298.15\\,\\mathrm{K}$ 时，有 $(R T / F) \\approx 0.025693\\,\\mathrm{V}$ 和 $(R T / F)\\ln 10 \\approx 0.05916\\,\\mathrm{V}$。因此，对于水耦合反应，当 $s_{\\mathrm{H}} = \\pm 2$ 和 $n = 2$ 时，斜率的绝对值约为 $0.05916\\,\\mathrm{V}$ 每pH单位，其符号取决于质子是产生还是消耗。溶解反应的 $m = 0$，其截距随水合阳离子活度通过 $-(R T /(n F)) \\ln a_{M^{2+}}$ 而移动。\n\n该程序实现了这些步骤，并以伏特为单位生成浮点数输出，斜率单位为伏特每pH单位，并按照规范聚合到一个方括号列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Physical constants\n    R = 8.314462618  # J/mol/K\n    F = 96485.33212  # C/mol\n    T = 298.15       # K\n    LN10 = np.log(10.0)\n\n    # Conversion: 1 eV per formula unit - J/mol\n    EV_TO_J_PER_MOL = 1.602176634e-19 * 6.02214076e23  # ~96485.33212 J/mol\n\n    # Species standard chemical potentials (mu^0) in eV per formula unit\n    # DFT energies + corrections\n    species_mu0_eV = {\n        \"M(s)\": -6.00 + 0.05,          # -5.95 eV\n        \"MO(s)\": -12.50 + 0.20,        # -12.30 eV\n        \"MO2(s)\": -19.80 + 0.30,       # -19.50 eV\n        \"H2O(l)\": -14.20 + 0.56,       # -13.64 eV\n        \"H2(g)\": -6.80 + 0.41,         # -6.39 eV\n        \"M2+(aq)\": -2.00 + (-4.00),    # -6.00 eV\n        # H+(aq) is set via CHE below\n    }\n\n    # CHE convention: mu^0(H+) = 0.5 * mu^0(H2)\n    species_mu0_eV[\"H+(aq)\"] = 0.5 * species_mu0_eV[\"H2(g)\"]\n\n    # Convert to J/mol\n    species_mu0_Jmol = {k: v * EV_TO_J_PER_MOL for k, v in species_mu0_eV.items()}\n\n    # Activities (defaults; solids and pure liquids have activity 1)\n    default_activities = {\n        \"M(s)\": 1.0,\n        \"MO(s)\": 1.0,\n        \"MO2(s)\": 1.0,\n        \"H2O(l)\": 1.0,\n        \"H2(g)\": 1.0,\n        \"H+(aq)\": None,   # handled via pH\n        \"M2+(aq)\": None,  # set per test case where relevant\n    }\n\n    # Reaction representation: dict with reactants/products lists of (species, coeff),\n    # electron count n, and net proton coefficient s_H = nu_H+_prod - nu_H+_react.\n    def reaction(name, reactants, products, n):\n        # Compute s_H from stoichiometry\n        def coeff_in(side):\n            for sp, nu in side:\n                if sp == \"H+(aq)\":\n                    return nu\n            return 0.0\n        s_H = coeff_in(products) - coeff_in(reactants)\n        return {\"name\": name, \"reactants\": reactants, \"products\": products, \"n\": n, \"s_H\": s_H}\n\n    # Assemble the specific test reactions\n    # R1: M + H2O - MO + 2 H+ + 2 e-\n    R1 = reaction(\n        \"R1\",\n        reactants=[(\"M(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        products=[(\"MO(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        n=2\n    )\n    # R2: MO + H2O - MO2 + 2 H+ + 2 e-\n    R2 = reaction(\n        \"R2\",\n        reactants=[(\"MO(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        products=[(\"MO2(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        n=2\n    )\n    # R3: MO + 2 H+ + 2 e- - M + H2O\n    R3 = reaction(\n        \"R3\",\n        reactants=[(\"MO(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        products=[(\"M(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        n=2\n    )\n    # R4: M - M2+ + 2 e-\n    R4 = reaction(\n        \"R4\",\n        reactants=[(\"M(s)\", 1.0)],\n        products=[(\"M2+(aq)\", 1.0)],\n        n=2\n    )\n\n    reactions = {\"R1\": R1, \"R2\": R2, \"R3\": R3, \"R4\": R4}\n\n    # Compute Delta G^0 (J/mol) and ln Q_nonH for a given reaction given activities\n    def compute_deltaG0_and_lnQ_nonH(rx, activities):\n        # Sum mu^0 for products and reactants\n        G_products = 0.0\n        G_reactants = 0.0\n        for sp, nu in rx[\"products\"]:\n            mu0 = species_mu0_Jmol[sp]\n            G_products += nu * mu0\n        for sp, nu in rx[\"reactants\"]:\n            mu0 = species_mu0_Jmol[sp]\n            G_reactants += nu * mu0\n        deltaG0 = G_products - G_reactants  # J/mol\n\n        # ln Q excluding H+; solids and pure liquids default to activity 1\n        lnQ_nonH = 0.0\n        # Products\n        for sp, nu in rx[\"products\"]:\n            if sp == \"H+(aq)\":\n                continue\n            a = activities.get(sp, default_activities.get(sp, 1.0))\n            if a is None:\n                # If not specified, treat as unity activity\n                a = 1.0\n            lnQ_nonH += nu * np.log(a)\n        # Reactants\n        for sp, nu in rx[\"reactants\"]:\n            if sp == \"H+(aq)\":\n                continue\n            a = activities.get(sp, default_activities.get(sp, 1.0))\n            if a is None:\n                a = 1.0\n            lnQ_nonH -= nu * np.log(a)\n\n        return deltaG0, lnQ_nonH\n\n    # Compute line parameters (slope m and intercept b) and E at given pH\n    def compute_line(rx, pH, activities):\n        deltaG0, lnQ_nonH = compute_deltaG0_and_lnQ_nonH(rx, activities)\n        n = rx[\"n\"]\n        s_H = rx[\"s_H\"]\n        # Intercept and slope\n        b = - deltaG0 / (n * F) - (R * T / (n * F)) * lnQ_nonH\n        m = (R * T / (n * F)) * s_H * LN10\n        E_pH = b + m * pH\n        return m, b, E_pH\n\n    # Define test cases: (reaction_key, pH, activity overrides)\n    test_cases = [\n        (\"R1\", 7.0, {}),                      # R1 at pH 7\n        (\"R2\", 14.0, {}),                     # R2 at pH 14\n        (\"R3\", 0.0, {}),                      # R3 at pH 0\n        (\"R4\", 7.0, {\"M2+(aq)\": 1e-6}),       # R4 at pH 7, trace cation activity\n        (\"R4\", 7.0, {\"M2+(aq)\": 1.0}),        # R4 at pH 7, unit cation activity\n    ]\n\n    results = []\n    for key, pH, acts in test_cases:\n        rx = reactions[key]\n        m, b, E_pH = compute_line(rx, pH, acts)\n        results.append([m, b, E_pH])\n\n    # Final print statement in the exact required format.\n    # Ensure pure Python float serialization without extra text.\n    def format_list(lst):\n        return \"[\" + \",\".join(map(lambda x: str(x), lst)) + \"]\"\n    print(\"[\" + \",\".join(format_list(res) for res in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}