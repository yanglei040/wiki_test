{
    "hands_on_practices": [
        {
            "introduction": "A fundamental task in materials science is to describe how a solid's volume responds to external pressure, a relationship encapsulated by its equation of state (EOS). This exercise provides hands-on practice in fitting several common EOS models to pressure-volume data, going beyond simple curve fitting to critically evaluate which model is most physically reliable. By comparing models based not only on their fit to the data but also on their behavior when extrapolated to extreme conditions, you will develop the crucial skill of selecting a model that is both accurate and physically meaningful .",
            "id": "3461383",
            "problem": "You are given three independent static-compression datasets for a cubic crystalline solid, each consisting of measured volumes and corresponding pressures. Assume a cubic lattice with one atom per primitive cell, so that the lattice parameter is related to the volume by $a = V^{1/3}$. Your task is to determine, for each dataset, the most appropriate equation of state fit among three widely used models, determine the zero-pressure lattice parameter, and quantify the quality of fit. The three models are to be treated as three hypotheses for the pressure–volume relationship and must be fitted by nonlinear least squares under thermodynamic constraints. The selection must be based on the interplay of residuals across the measured data, behavior when extrapolated to high compression, and physical plausibility at high pressure.\n\nFundamental principles you may use:\n- The equation of state is a constitutive relation between pressure and volume for hydrostatic compression, grounded in the definition $P = -\\partial E/\\partial V$, where $P$ is pressure, $E$ is internal energy, and $V$ is volume.\n- For a cubic crystal with one atom per primitive cell, the lattice parameter $a$ and volume $V$ satisfy $V = a^3$.\n- The isothermal bulk modulus at zero pressure $B_0$ and its pressure derivative $B_0'$ are strictly positive for stable solids and typically satisfy $B_0' > 1$.\n\nTask requirements for each dataset:\n1. Fit the three widely used equations of state (treated as three distinct hypotheses) to the given pressure–volume data by minimizing the sum of squared residuals between measured $P$ and model $P(V)$ over the dataset, subject to constraints $V_0 > 0$, $B_0 > 0$, and $B_0' > 1$, where $V_0$ is the zero-pressure volume, $B_0$ is the zero-pressure bulk modulus, and $B_0'$ is its pressure derivative. The specific functional forms of the three models are to be considered part of standard computational materials science knowledge and are not provided here; you must implement them based on first principles and accepted literature.\n2. Compute the root-mean-square error (RMSE) of the fit in units of gigapascal (GPa).\n3. Evaluate high-pressure extrapolation to a compression state of $V/V_0 = 0.5$. Determine whether the extrapolated pressure is finite and positive and whether the pressure increases monotonically with increasing compression locally near that state (for example, check that $P(V=0.50\\,V_0) > P(V=0.52\\,V_0)$). If any of these physical plausibility conditions fail, penalize that model heavily in the selection.\n4. Select the “best” model as the one that minimizes a composite metric that prioritizes low RMSE while disqualifying non-physical extrapolation behavior by a large penalty.\n5. From the best-fit model, report the fitted zero-pressure lattice parameter $a_0$ in angstroms, computed as $a_0 = V_0^{1/3}$. Express $a_0$ in $\\text{\\AA}$ rounded to four decimal places.\n6. Report the RMSE of the best-fit model in $\\text{GPa}$ rounded to three decimal places.\n\nAngle units are not applicable. All reported physical quantities must be in the following units:\n- Volume $V$ in $\\text{\\AA}^3$ (cubic angstrom), pressure $P$ in $\\text{GPa}$ (gigapascal), and lattice parameter $a$ in $\\text{\\AA}$ (angstrom).\n\nYour program must implement the above selection logic and apply it to the following three datasets (the datasets span compressions down to approximately $V/V_0 \\approx 0.6$):\n\nDataset 1:\n- Volumes $V_i$ in $\\text{\\AA}^3$: $[16.0,\\,15.2,\\,14.4,\\,13.6,\\,12.8,\\,12.0,\\,11.2,\\,10.4,\\,9.6]$.\n- Pressures $P_i$ in $\\text{GPa}$: $[0.0,\\,9.75,\\,22.68,\\,38.91,\\,60.83,\\,90.53,\\,130.8,\\,182.0,\\,257.8]$.\n\nDataset 2:\n- Volumes $V_i$ in $\\text{\\AA}^3$: $[10.0,\\,9.5,\\,9.0,\\,8.5,\\,8.0,\\,7.5,\\,7.0,\\,6.5,\\,6.0]$.\n- Pressures $P_i$ in $\\text{GPa}$: $[0.0,\\,16.81,\\,38.6,\\,65.4,\\,101.1,\\,148.5,\\,213.6,\\,301.5,\\,426.5]$.\n\nDataset 3:\n- Volumes $V_i$ in $\\text{\\AA}^3$: $[20.0,\\,19.0,\\,18.0,\\,17.0,\\,16.0,\\,15.0,\\,14.0,\\,13.0,\\,12.0]$.\n- Pressures $P_i$ in $\\text{GPa}$: $[0.0,\\,2.651,\\,6.30,\\,11.34,\\,18.22,\\,28.03,\\,41.6,\\,59.3,\\,85.5]$.\n\nModel indexing for output:\n- Index $0$: Murnaghan equation of state.\n- Index $1$: third-order Birch–Murnaghan equation of state.\n- Index $2$: Vinet equation of state.\n\nTest suite and output specification:\n- Apply your procedure to all three datasets.\n- For each dataset, output a triple consisting of the integer index of the selected best model, the fitted $a_0$ in $\\text{\\AA}$ (rounded to four decimals), and the RMSE in $\\text{GPa}$ (rounded to three decimals).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the datasets, for a total of nine values. For example, an output line of the form $[i_1, a_{0,1}, \\mathrm{RMSE}_1, i_2, a_{0,2}, \\mathrm{RMSE}_2, i_3, a_{0,3}, \\mathrm{RMSE}_3]$ where $i_k$ is an integer and the others are floats.\n\nThere is no user input. All constants and arrays are specified above. Ensure that your optimization imposes the stated thermodynamic constraints and that you enforce the physical plausibility checks in the high-compression extrapolation regime $V/V_0 \\approx 0.5$.",
            "solution": "The problem requires a comprehensive analysis of three pressure-volume ($P$-$V$) datasets for a cubic crystalline solid. The objective is to determine the most suitable equation of state (EOS) from a set of three standard models—Murnaghan, third-order Birch-Murnaghan, and Vinet—for each dataset. The selection must be based on a quantitative procedure that involves data fitting, evaluation of residuals, and assessment of physical plausibility under high compression.\n\nThe methodological approach is structured as follows:\n1.  For each dataset, fit the three specified EOS models to the given pressure-volume data.\n2.  Evaluate each fit based on a composite metric that combines the goodness of fit (RMSE) with a penalty for non-physical behavior upon extrapolation.\n3.  Select the model that minimizes this metric.\n4.  Report the integer index of the chosen model, its fitted zero-pressure lattice parameter ($a_0$), and its root-mean-square error (RMSE).\n\n**1. Equations of State (EOS)**\n\nThe relationship between pressure $P$ and volume $V$ is described by an EOS, derived from the internal energy $E$ via the thermodynamic relation $P = -\\partial E / \\partial V$. The three models to be tested are defined by their respective parameters: the zero-pressure volume $V_0$, the zero-pressure bulk modulus $B_0 = -V (\\partial P / \\partial V)|_{V=V_0}$, and the first pressure derivative of the bulk modulus at zero pressure, $B_0' = (\\partial B / \\partial P)|_{P=0}$.\n\nThe functional forms are:\n- **Murnaghan EOS (Index $0$):** This model is derived by assuming a linear relationship between the bulk modulus and pressure, $B(P) = B_0 + B_0' P$. Integration leads to the pressure-volume relation:\n$$\nP(V) = \\frac{B_0}{B_0'} \\left[ \\left( \\frac{V_0}{V} \\right)^{B_0'} - 1 \\right]\n$$\n\n- **Third-Order Birch-Murnaghan EOS (Index $1$):** This model is based on expanding the Helmholtz free energy in powers of the Eulerian finite strain, $f_E = \\frac{1}{2} [ (V_0/V)^{2/3} - 1 ]$. Truncating the expansion at the third order yields the following expression for pressure:\n$$\nP(V) = \\frac{3 B_0}{2} \\left[ \\left( \\frac{V_0}{V} \\right)^{7/3} - \\left( \\frac{V_0}{V} \\right)^{5/3} \\right] \\left\\{ 1 + \\frac{3}{4} (B_0' - 4) \\left[ \\left( \\frac{V_0}{V} \\right)^{2/3} - 1 \\right] \\right\\}\n$$\n\n- **Vinet EOS (Index $2$):** This \"universal\" EOS is derived from interatomic potential considerations and is known for its robustness over a wide range of compressions. Its form is:\n$$\nP(V) = 3 B_0 \\frac{1 - (V/V_0)^{1/3}}{(V/V_0)^{2/3}} \\exp\\left[\\frac{3}{2}(B_0' - 1)\\left(1 - (V/V_0)^{1/3}\\right)\\right]\n$$\n\n**2. Optimization and Fitting Procedure**\n\nFor each model and dataset, the optimal parameters ($V_0$, $B_0$, $B_0'$) are determined by minimizing the sum of squared residuals ($S$) between the measured pressures $P_{i, \\text{data}}$ and the pressures predicted by the model $P_{\\text{model}}$:\n$$\nS = \\sum_{i} \\left[ P_{i, \\text{data}} - P_{\\text{model}}(V_i; V_0, B_0, B_0') \\right]^2\n$$\nThis is a nonlinear least-squares optimization problem. The algorithm is implemented using `scipy.optimize.least_squares` with the Trust Region Reflective (`trf`) method, which is suitable for bound-constrained problems.\n\nThe optimization is subject to thermodynamic constraints required for a stable solid: $V_0 > 0$, $B_0 > 0$, and $B_0' > 1$. These are enforced by setting lower bounds on the parameters during the optimization. Initial guesses for the parameters are estimated from the data: $V_0$ is approximated by the volume at zero pressure, $B_0$ is estimated from the initial slope of the $P$-$V$ curve, and $B_0'$ is set to a typical value of $4$.\n\n**3. Model Selection Protocol**\n\nA simple comparison of goodness of fit is insufficient, as an EOS must also be physically meaningful outside the range of the fitted data. Therefore, a two-part selection protocol is implemented.\n\n- **Goodness of Fit:** The primary measure of fit quality is the Root-Mean-Square Error (RMSE), calculated as:\n$$\n\\text{RMSE} = \\sqrt{\\frac{S}{N}}\n$$\nwhere $N$ is the number of data points.\n\n- **High-Pressure Plausibility Test:** Each fitted EOS is extrapolated to a high-compression state of $V/V_0 = 0.5$. The physical plausibility is tested against two criteria:\n    1.  The extrapolated pressure must be finite and positive ($P > 0$).\n    2.  The pressure must increase monotonically with compression. This is equivalent to the bulk modulus $B = -V(dP/dV)$ being positive. This condition is verified by checking that $P(V=0.50 V_0) > P(V=0.52 V_0)$.\n\n- **Composite Metric:** A composite metric $M$ is defined to select the best model:\n$$\nM = \\text{RMSE} + \\text{Penalty}\n$$\nIf a model fails the plausibility test, a large penalty (e.g., $10^{10}$) is added to its RMSE. This effectively disqualifies any model that exhibits unphysical behavior at high compression. The model with the minimum value of $M$ is selected as the most appropriate one for the given dataset.\n\n**4. Calculation of Final Results**\n\nOnce the best model is identified for a given dataset, the final results are computed from its fitted parameters.\n- **Zero-Pressure Lattice Parameter ($a_0$):** For a cubic crystal with one atom per primitive cell, the volume is $V = a^3$. The zero-pressure lattice parameter is therefore calculated as:\n$$\na_0 = (V_0)^{1/3}\n$$\nThis value is reported in angstroms ($\\text{\\AA}$) rounded to four decimal places.\n- **RMSE:** The RMSE of the best-fit model is reported in gigapascals (GPa) rounded to three decimal places.\n\nThis entire procedure is automated and applied sequentially to the three provided datasets to generate the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# ##############################################################################\n# EQUATION OF STATE (EOS) MODEL IMPLEMENTATIONS\n# ##############################################################################\n\ndef p_murnaghan(V, params):\n    \"\"\"Calculates pressure using the Murnaghan EOS.\"\"\"\n    V0, B0, B0_prime = params\n    # Ensure numerical stability for V>0\n    ratio = V0 / V\n    pressure = (B0 / B0_prime) * (np.power(ratio, B0_prime) - 1.0)\n    return pressure\n\ndef p_bm3(V, params):\n    \"\"\"Calculates pressure using the 3rd-order Birch-Murnaghan EOS.\"\"\"\n    V0, B0, B0_prime = params\n    # Ensure numerical stability for V>0\n    ratio = V0 / V\n    term1 = np.power(ratio, 7./3.) - np.power(ratio, 5./3.)\n    term2 = 1.0 + 0.75 * (B0_prime - 4.0) * (np.power(ratio, 2./3.) - 1.0)\n    pressure = 1.5 * B0 * term1 * term2\n    return pressure\n\ndef p_vinet(V, params):\n    \"\"\"Calculates pressure using the Vinet EOS.\"\"\"\n    V0, B0, B0_prime = params\n    # Ensure numerical stability for V>0\n    x = np.power(V / V0, 1./3.)\n    eta = 1.5 * (B0_prime - 1.0)\n    pressure = 3.0 * B0 * ((1.0 - x) / (x**2)) * np.exp(eta * (1.0 - x))\n    return pressure\n\n# List of EOS functions dispatchable by index\nEOS_MODELS = [p_murnaghan, p_bm3, p_vinet]\n\n# ##############################################################################\n# CORE LOGIC FOR DATASET PROCESSING\n# ##############################################################################\n\ndef residuals(params, V_data, P_data, model_index):\n    \"\"\"Residuals function for the least-squares solver.\"\"\"\n    try:\n        P_model = EOS_MODELS[model_index](V_data, params)\n        # Handle non-finite results from the model, which can occur with\n        # extreme parameter values explored by the optimizer.\n        if not np.all(np.isfinite(P_model)):\n            return np.full_like(P_data, 1e12) # Return a large error\n        return P_model - P_data\n    except (ValueError, OverflowError, ZeroDivisionError):\n        return np.full_like(P_data, 1e12) # Return a large error on numerical failure\n\n\ndef process_dataset(V_data, P_data):\n    \"\"\"\n    Fits all three EOS models to a dataset, selects the best one based on\n    a composite metric, and returns the required results.\n    \"\"\"\n    models_results = []\n    \n    for i in range(len(EOS_MODELS)):\n        # Initial guess for parameters (V0, B0, B0_prime)\n        v0_guess = V_data[0]\n        # Estimate B0 from the first two points: B0 ~ -V * dP/dV\n        if len(V_data) > 1 and (V_data[1] - V_data[0]) != 0:\n            b0_guess = -v0_guess * (P_data[1] - P_data[0]) / (V_data[1] - V_data[0])\n        else:\n            b0_guess = 100.0 # A generic fallback value\n        # Ensure guess is positive\n        b0_guess = max(b0_guess, 1.0)\n        p0 = [v0_guess, b0_guess, 4.0] # B0'~4 is a common starting point\n\n        # Parameter bounds: V0 > 0, B0 > 0, B0' > 1\n        bounds = ([1e-9, 1e-9, 1.0], [np.inf, np.inf, np.inf])\n\n        # Perform the non-linear least squares fit\n        fit_result = least_squares(\n            residuals,\n            p0,\n            bounds=bounds,\n            args=(V_data, P_data, i),\n            method='trf'\n        )\n\n        if not fit_result.success:\n            models_results.append({'metric': np.inf, 'index': i})\n            continue\n\n        fit_params = fit_result.x\n        V0_fit, _, _ = fit_params\n\n        # Calculate RMSE\n        P_pred = EOS_MODELS[i](V_data, fit_params)\n        rmse = np.sqrt(np.mean((P_data - P_pred)**2))\n\n        # High-pressure extrapolation check\n        penalty = 0.0\n        try:\n            V_extrap1 = 0.50 * V0_fit\n            V_extrap2 = 0.52 * V0_fit\n            P_extrap1 = EOS_MODELS[i](V_extrap1, fit_params)\n            P_extrap2 = EOS_MODELS[i](V_extrap2, fit_params)\n            \n            # 1. Check for finite and positive pressure\n            if not np.isfinite(P_extrap1) or P_extrap1 <= 0:\n                penalty = 1e10\n            # 2. Check for monotonic pressure increase with compression\n            elif not np.isfinite(P_extrap2) or P_extrap1 <= P_extrap2:\n                penalty = 1e10\n        except (ValueError, OverflowError, ZeroDivisionError):\n             penalty = 1e10 # Penalize on any numerical failure during extrapolation\n\n        models_results.append({\n            'metric': rmse + penalty,\n            'index': i,\n            'V0': V0_fit,\n            'rmse': rmse\n        })\n\n    # Select the best model (the one with the minimum composite metric)\n    best_model = min(models_results, key=lambda x: x['metric'])\n    \n    # Calculate a0 from the best fit's V0\n    best_a0 = best_model['V0']**(1./3.)\n\n    return [\n        best_model['index'],\n        round(best_a0, 4),\n        round(best_model['rmse'], 3)\n    ]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on all specified datasets and print\n    the final formatted output.\n    \"\"\"\n    # Define the datasets from the problem statement.\n    test_cases = [\n        (\n            np.array([16.0, 15.2, 14.4, 13.6, 12.8, 12.0, 11.2, 10.4, 9.6]),\n            np.array([0.0, 9.75, 22.68, 38.91, 60.83, 90.53, 130.8, 182.0, 257.8])\n        ),\n        (\n            np.array([10.0, 9.5, 9.0, 8.5, 8.0, 7.5, 7.0, 6.5, 6.0]),\n            np.array([0.0, 16.81, 38.6, 65.4, 101.1, 148.5, 213.6, 301.5, 426.5])\n        ),\n        (\n            np.array([20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0]),\n            np.array([0.0, 2.651, 6.30, 11.34, 18.22, 28.03, 41.6, 59.3, 85.5])\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        V_data, P_data = case\n        result_triple = process_dataset(V_data, P_data)\n        results.extend(result_triple)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While simple cubic crystals compress uniformly, most materials have lower symmetry, allowing their internal structure to change under pressure. This practice addresses this complexity by exploring a hexagonal crystal, where the axial ratio $\\eta = c/a$ is an additional degree of freedom that must be optimized alongside the volume $V$. You will learn to model the energy as a two-dimensional surface $E(V, \\eta)$ and use the principle of enthalpy minimization to determine how both volume and the crystal's shape evolve with pressure .",
            "id": "3461409",
            "problem": "You are given a synthetic dataset of total energies for a hexagonal close-packed metal as a function of atomic volume and axial ratio, intended to emulate a converged electronic-structure calculation. The axial ratio is defined as $\\eta = c/a$. The goal is to jointly optimize the atomic volume $V$ and $\\eta$ under an external pressure $P$ by fitting a smooth energy surface $E(V,\\eta)$ and then minimizing the enthalpy $H(V,\\eta;P)$ to obtain the equilibrium values $(V(P),\\eta(P))$. The pressure enters thermodynamics through the definition of enthalpy $H=E+PV$, and the mechanical equilibrium under an imposed external pressure is uniquely determined by minimizing $H$ with respect to $V$ and $\\eta$ at fixed $P$. The fundamental principle to be used is the definition of pressure as the negative derivative of energy with respect to volume at fixed $\\eta$, namely $P=-\\partial E/\\partial V$, and the thermodynamic minimum principle that the stable state of a system in a pressure reservoir minimizes the enthalpy.\n\nUse the provided dataset of energies $E(V,\\eta)$ to construct a least-squares fit to a bivariate polynomial in $V$ and $\\eta$ up to second order, including cross terms. Then, for each specified pressure $P$, determine the pair $(V(P),\\eta(P))$ by minimizing the enthalpy $H(V,\\eta;P)$. From these minimized pairs, extract $\\eta(P)$ and report its values.\n\nUnits and fixed constants:\n- Energies $E$ are in electronvolts per atom, denoted $\\text{eV}$.\n- Volumes $V$ are in cubic angstroms per atom, denoted $\\text{\\AA}^3$.\n- Pressures $P$ are in gigapascals, denoted $\\text{GPa}$.\n- To combine $P$ and $V$ consistently in $H=E+PV$, use the conversion factor $C = 160.21766208$ with units $\\text{GPa}\\cdot\\text{\\AA}^3/\\text{eV}$, so that $PV/C$ has units of energy in $\\text{eV}$.\n\nData grid:\n- Volumes $V$ at five values: $\\{14.5,\\,15.5,\\,16.5,\\,17.5,\\,18.5\\}$ $\\text{\\AA}^3$.\n- Axial ratios $\\eta$ at five values: $\\{1.55,\\,1.58,\\,1.60,\\,1.62,\\,1.65\\}$ (dimensionless).\n- Energies $E(V,\\eta)$ in $\\text{eV}$ at the $5\\times 5$ grid points ordered by the nested loops $V$ outer, $\\eta$ inner (i.e., for each $V$ in ascending order, list the $5$ energies for the $\\eta$ values in ascending order):\n\nFor $V=14.5$: $\\{-3.00084,\\,-3.00000,\\,-2.99904,\\,-2.99840,\\,-2.99524\\}$\n\nFor $V=15.5$: $\\{-4.50024,\\,-4.50000,\\,-4.49944,\\,-4.49856,\\,-4.49664\\}$\n\nFor $V=16.5$: $\\{-4.99964,\\,-5.00000,\\,-4.99984,\\,-4.99936,\\,-4.99804\\}$\n\nFor $V=17.5$: $\\{-4.49904,\\,-4.50000,\\,-4.50024,\\,-4.50016,\\,-4.49944\\}$\n\nFor $V=18.5$: $\\{-2.99844,\\,-3.00000,\\,-3.00064,\\,-3.00096,\\,-3.00084\\}$\n\nAlgorithmic requirements:\n1. Fit $E(V,\\eta)$ by least squares to a bivariate polynomial including constant, linear, quadratic, and cross terms in $V$ and $\\eta$, without assuming any particular equation of state functional form beyond smoothness. Specifically, fit coefficients for the set of basis functions $\\{1,\\,V,\\,\\eta,\\,V^2,\\,V\\eta,\\,\\eta^2\\}$ so that the fitted model is $E_{\\text{fit}}(V,\\eta)$.\n2. For a given external pressure $P$ in $\\text{GPa}$, define the enthalpy as $H(V,\\eta;P) = E_{\\text{fit}}(V,\\eta) + (P/C)\\,V$ with the above $C$. Determine $(V(P),\\eta(P))$ by minimizing $H$ with respect to $V$ and $\\eta$. Treat $\\eta$ as dimensionless and $V$ in $\\text{\\AA}^3$.\n3. Extract $\\eta(P)$ for each pressure.\n\nTest suite of pressures:\n- $P_1 = 0.0$ $\\text{GPa}$ (ambient).\n- $P_2 = 10.0$ $\\text{GPa}$ (moderate compression).\n- $P_3 = 60.0$ $\\text{GPa}$ (high compression).\n- $P_4 = 120.0$ $\\text{GPa}$ (very high compression).\n- $P_5 = -2.0$ $\\text{GPa}$ (weak tension).\n\nAnswer specification:\n- Report the axial ratios $\\eta(P_i)$ (dimensionless) for $i\\in\\{1,2,3,4,5\\}$ rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\eta(P_1),\\eta(P_2),\\eta(P_3),\\eta(P_4),\\eta(P_5)]$ with each entry printed as a decimal number rounded to six decimal places.",
            "solution": "The problem requires the determination of the equilibrium axial ratio, $\\eta$, of a hexagonal close-packed metal under various external pressures, $P$. The methodological approach is prescribed: first, to model the total energy surface, $E(V, \\eta)$, as a function of atomic volume, $V$, and axial ratio, $\\eta$, by fitting a polynomial to a given synthetic dataset; and second, to find the equilibrium state $(V(P), \\eta(P))$ by minimizing the enthalpy, $H = E + PV$, for each given pressure.\n\nThe fundamental principle governing the system's equilibrium state at constant temperature and pressure is the minimization of the appropriate thermodynamic potential, which in this case is the enthalpy. The enthalpy per atom is defined as:\n$$H(V, \\eta; P) = E(V, \\eta) + PV$$\nwhere $E$ is the internal energy per atom. To maintain consistency of units between the energy term ($E$, in electronvolts, $\\text{eV}$) and the pressure-volume term ($PV$, where $P$ is in gigapascals, $\\text{GPa}$, and $V$ is in cubic angstroms, $\\text{\\AA}^3$), a conversion factor, $C = 160.21766208 \\, \\text{GPa}\\cdot\\text{\\AA}^3/\\text{eV}$, is used. The enthalpy expression to be minimized is therefore:\n$$H(V, \\eta; P) = E(V, \\eta) + \\frac{P}{C}V$$\n\nThe first step is to obtain a continuous analytical form for the energy surface, $E(V, \\eta)$, from the discrete set of $N=25$ data points provided. As per the problem statement, we fit the data to a second-order bivariate polynomial:\n$$E_{\\text{fit}}(V, \\eta) = c_0 + c_1 V + c_2 \\eta + c_3 V^2 + c_4 V\\eta + c_5 \\eta^2$$\nThe six unknown coefficients, $\\boldsymbol{c} = [c_0, c_1, c_2, c_3, c_4, c_5]^T$, are determined via a linear least-squares regression. For each of the $N$ data points $(V_j, \\eta_j, E_j)$, a linear equation is formed. This set of equations can be expressed in matrix form as $\\boldsymbol{A}\\boldsymbol{c} \\approx \\boldsymbol{b}$, where $\\boldsymbol{b}$ is the $N \\times 1$ vector of energy values and $\\boldsymbol{A}$ is the $N \\times 6$ design matrix whose $j$-th row is $[1, V_j, \\eta_j, V_j^2, V_j\\eta_j, \\eta_j^2]$. The least-squares solution minimizes the sum of squared residuals, $||\\boldsymbol{A}\\boldsymbol{c} - \\boldsymbol{b}||^2$, and is found by solving the normal equations $(\\boldsymbol{A}^T\\boldsymbol{A})\\boldsymbol{c} = \\boldsymbol{A}^T\\boldsymbol{b}$.\n\nOnce the coefficients $\\boldsymbol{c}$ are determined, we have an analytical expression for the enthalpy:\n$$H(V, \\eta; P) = (c_0 + c_1 V + c_2 \\eta + c_3 V^2 + c_4 V\\eta + c_5 \\eta^2) + \\frac{P}{C}V$$\nTo find the equilibrium state $(V(P), \\eta(P))$ that minimizes $H$, we set the partial derivatives of $H$ with respect to $V$ and $\\eta$ to zero:\n$$\\frac{\\partial H}{\\partial V} = \\frac{\\partial E_{\\text{fit}}}{\\partial V} + \\frac{P}{C} = (c_1 + 2c_3 V + c_4 \\eta) + \\frac{P}{C} = 0$$\n$$\\frac{\\partial H}{\\partial \\eta} = \\frac{\\partial E_{\\text{fit}}}{\\partial \\eta} = c_2 + c_4 V + 2c_5 \\eta = 0$$\nThis constitutes a system of two linear equations for the variables $V$ and $\\eta$:\n$$2c_3 V + c_4 \\eta = -c_1 - \\frac{P}{C}$$\n$$c_4 V + 2c_5 \\eta = -c_2$$\nThis system can be written in matrix form as $\\boldsymbol{M}\\boldsymbol{x} = \\boldsymbol{d}$, where $\\boldsymbol{x} = [V, \\eta]^T$, $\\boldsymbol{d} = [-c_1 - P/C, -c_2]^T$, and $\\boldsymbol{M}$ is the Hessian matrix of $E_{\\text{fit}}(V, \\eta)$:\n$$\\boldsymbol{M} = \\begin{pmatrix} \\frac{\\partial^2 E_{\\text{fit}}}{\\partial V^2} & \\frac{\\partial^2 E_{\\text{fit}}}{\\partial V \\partial \\eta} \\\\ \\frac{\\partial^2 E_{\\text{fit}}}{\\partial \\eta \\partial V} & \\frac{\\partial^2 E_{\\text{fit}}}{\\partial \\eta^2} \\end{pmatrix} = \\begin{pmatrix} 2c_3 & c_4 \\\\ c_4 & 2c_5 \\end{pmatrix}$$\nFor the solution to correspond to a minimum, the Hessian matrix $\\boldsymbol{M}$ must be positive definite, which physically corresponds to the stability of the crystal structure. The equilibrium state is then found by solving this linear system for $(V, \\eta)$ for each given pressure $P$.\n\nThe computational procedure is as follows:\n1.  Construct the $25 \\times 6$ design matrix $\\boldsymbol{A}$ and the $25 \\times 1$ energy vector $\\boldsymbol{b}$ from the provided data.\n2.  Solve for the coefficient vector $\\boldsymbol{c}$ using a numerical linear least-squares solver.\n3.  For each pressure $P$ in the test suite $\\{0.0, 10.0, 60.0, 120.0, -2.0\\}\\,\\text{GPa}$:\n    a. Form the Hessian matrix $\\boldsymbol{M}$ and the right-hand-side vector $\\boldsymbol{d}$.\n    b. Solve the $2 \\times 2$ linear system $\\boldsymbol{M}[V, \\eta]^T = \\boldsymbol{d}$ to find the equilibrium pair $(V(P), \\eta(P))$.\n    c. Extract and store the value of $\\eta(P)$.\n4.  Report the list of calculated $\\eta(P)$ values, each rounded to six decimal places, according to the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of determining equilibrium axial ratio as a function of pressure\n    for a hexagonal metal, based on a synthetic energy-volume-eta dataset.\n    \"\"\"\n\n    # --- Step 0: Define Givens and Constants ---\n    \n    # Grid points for Volume (V) in Angstrom^3\n    V_data = np.array([14.5, 15.5, 16.5, 17.5, 18.5])\n    \n    # Grid points for axial ratio (eta = c/a), dimensionless\n    eta_data = np.array([1.55, 1.58, 1.60, 1.62, 1.65])\n    \n    # Energy E(V, eta) in eV, ordered with V as outer loop, eta as inner loop\n    E_data_raw = np.array([\n        -3.00084, -3.00000, -2.99904, -2.99840, -2.99524,  # V=14.5\n        -4.50024, -4.50000, -4.49944, -4.49856, -4.49664,  # V=15.5\n        -4.99964, -5.00000, -4.99984, -4.99936, -4.99804,  # V=16.5\n        -4.49904, -4.50000, -4.50024, -4.50016, -4.49944,  # V=17.5\n        -2.99844, -3.00000, -3.00064, -3.00096, -3.00084   # V=18.5\n    ])\n\n    # Conversion factor from GPa*A^3 to eV\n    C = 160.21766208\n    \n    # Test suite of pressures in GPa\n    pressures_GPa = np.array([0.0, 10.0, 60.0, 120.0, -2.0])\n\n    # --- Step 1: Fit Energy Surface E(V, eta) ---\n\n    # Generate the full grid of (V, eta) points corresponding to the energy data\n    V_grid, eta_grid = np.meshgrid(V_data, eta_data, indexing='ij')\n    V_flat = V_grid.flatten()\n    eta_flat = eta_grid.flatten()\n    E_flat = E_data_raw\n\n    # Construct the design matrix A for the polynomial model:\n    # E_fit = c0*1 + c1*V + c2*eta + c3*V^2 + c4*V*eta + c5*eta^2\n    A = np.column_stack([\n        np.ones_like(V_flat),\n        V_flat,\n        eta_flat,\n        V_flat**2,\n        V_flat * eta_flat,\n        eta_flat**2\n    ])\n\n    # Solve the linear least-squares problem Ac = E to find the coefficients\n    coeffs, _, _, _ = np.linalg.lstsq(A, E_flat, rcond=None)\n    c0, c1, c2, c3, c4, c5 = coeffs\n\n    # --- Step 2: Minimize Enthalpy H(V, eta; P) for Each Pressure ---\n\n    # The minimization condition leads to a 2x2 linear system M * [V, eta]^T = d\n    # The matrix M is the Hessian of the fitted energy E_fit\n    Hessian_E = np.array([\n        [2 * c3, c4],\n        [c4, 2 * c5]\n    ])\n\n    results_eta = []\n    for P in pressures_GPa:\n        # The right-hand-side vector d depends on pressure P\n        d = np.array([\n            -(c1 + P / C),\n            -c2\n        ])\n        \n        # Solve the linear system for the equilibrium (V, eta) at the given pressure\n        try:\n            V_eq, eta_eq = np.linalg.solve(Hessian_E, d)\n            results_eta.append(eta_eq)\n        except np.linalg.LinAlgError:\n            # This case should not be reached with the given valid problem data\n            results_eta.append(np.nan)\n        \n    # --- Step 3: Format and Print the Final Answer ---\n    \n    # Format the list of eta values as specified in the problem\n    formatted_results = [f\"{eta:.6f}\" for eta in results_eta]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "First-principles calculations are computationally expensive, making it essential to design simulations that yield the most information for a given budget. This advanced practice moves beyond data analysis to the realm of experimental design, showing how to intelligently select which calculations to perform. By applying a Bayesian framework and the Fisher Information Matrix, you will develop a strategy to sequentially choose volume points that most efficiently reduce the uncertainty in the determined equation of state parameters .",
            "id": "3461390",
            "problem": "You are tasked with writing a complete, runnable program that designs a sequential (adaptive) experiment to select volume points $V$ for fitting the third-order Birch–Murnaghan equation of state to total energy as a function of volume $E(V)$. Your program must implement an adaptive, information-theoretic strategy that, under a fixed Density Functional Theory (DFT) budget, selects $V$ points to minimize the posterior uncertainty in the lattice parameter and elastic properties, specifically the parameter triplet $(V_0, B_0, B_0')$, where $V_0$ is the equilibrium volume, $B_0$ is the zero-pressure bulk modulus, and $B_0'$ is its first pressure derivative.\n\nThe design must be derived from first principles as follows: start from the definition of hydrostatic pressure $P(V) = -\\partial E/\\partial V$ and the finite-strain expansion that yields the third-order Birch–Murnaghan form for the equation of state, and then obtain the energy form $E(V)$ by integrating $P(V)$ with respect to $V$ consistently. Assume additive, independent, identically distributed Gaussian noise on energy with zero mean and known variance $\\sigma_E^2$. Use the Fisher information matrix for the parameter vector $\\boldsymbol{\\theta} = (E_0, V_0, B_0, B_0')$ to perform design selection, where $E_0$ is an energy offset (a nuisance parameter). At each candidate $V$, the single-observation Fisher information contribution is $I(V) = \\sigma_E^{-2}\\,\\boldsymbol{j}(V)\\,\\boldsymbol{j}(V)^\\top$, where $\\boldsymbol{j}(V) = \\partial E(V;\\boldsymbol{\\theta})/\\partial \\boldsymbol{\\theta}$ is the Jacobian row vector evaluated at a nominal parameter value. Assume a Gaussian prior $\\mathcal{N}(\\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$ for $\\boldsymbol{\\theta}$ and define the posterior precision after selecting a set $\\mathcal{S}$ of volumes as $\\boldsymbol{P}_{\\text{post}} = \\boldsymbol{\\Sigma}_0^{-1} + \\sum_{V\\in\\mathcal{S}} I(V)$. The posterior covariance is then $\\boldsymbol{\\Sigma}_{\\text{post}} = \\boldsymbol{P}_{\\text{post}}^{-1}$. Your goal is to greedily select volumes to minimize the posterior uncertainty in the subvector $(V_0, B_0, B_0')$, quantified by the determinant of the corresponding $3\\times 3$ posterior covariance submatrix, i.e., perform a sequential $D$-optimal design on that sub-block.\n\nYour program must:\n- Derive and implement the third-order Birch–Murnaghan energy $E(V)$ consistently from $P(V) = -\\partial E/\\partial V$ and finite-strain theory, so that it is a function of $\\boldsymbol{\\theta} = (E_0, V_0, B_0, B_0')$ and $V$.\n- Derive and implement the analytic gradient $\\boldsymbol{j}(V) = \\partial E/\\partial \\boldsymbol{\\theta}$ with respect to all four parameters.\n- Implement a sequential greedy selection rule over a finite candidate set $\\mathcal{C}$, where at each step, among the remaining candidates, you add the $V$ that minimizes $\\log\\det\\big(\\boldsymbol{\\Sigma}_{\\text{sub}}(V)\\big)$, where $\\boldsymbol{\\Sigma}_{\\text{sub}}(V)$ is the $(V_0,B_0,B_0')$ sub-block of the updated posterior covariance after hypothetically adding that $V$.\n- Use nominal parameters equal to the prior mean $\\boldsymbol{\\mu}_0$ when evaluating $\\boldsymbol{j}(V)$ at all steps.\n- Disallow reselecting the same $V$.\n\nPhysical and numerical units:\n- Express energy in electronvolts (eV), volume in cubic angstroms ($\\text{\\AA}^3$), and bulk modulus $B_0$ internally in $\\text{eV}/\\text{\\AA}^3$ for all model evaluations. For reporting posterior uncertainty, convert the standard deviation of $B_0$ to gigapascals (GPa) using the constant conversion $1\\,\\text{eV}/\\text{\\AA}^3 = 160.21766208\\,\\text{GPa}$. The reported standard deviations must be in the units: $V_0$ in $\\text{\\AA}^3$, $B_0$ in $\\text{GPa}$, and $B_0'$ dimensionless.\n\nTest suite and parameter specifications:\n- Use a Gaussian prior with mean vector $\\boldsymbol{\\mu}_0 = (E_0^\\mu, V_0^\\mu, B_0^\\mu, B_0'{}^\\mu)$ and diagonal covariance $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(\\sigma_{E_0}^2, \\sigma_{V_0}^2, \\sigma_{B_0}^2, \\sigma_{B_0'}^2)$ with the following values:\n  - $E_0^\\mu = -7.5$ (eV), $V_0^\\mu = 16.5$ ($\\text{\\AA}^3$), $B_0^\\mu = 170/160.21766208$ ($\\text{eV}/\\text{\\AA}^3$), $B_0'{}^\\mu = 4.0$.\n  - $\\sigma_{E_0} = 0.1$ (eV), $\\sigma_{V_0} = 1.0$ ($\\text{\\AA}^3$), $\\sigma_{B_0} = 0.5$ ($\\text{eV}/\\text{\\AA}^3$), $\\sigma_{B_0'} = 1.0$.\n- Use a uniform candidate set $\\mathcal{C}$ of $M$ points linearly spaced in $V$ from $0.85\\,V_0^\\mu$ to $1.15\\,V_0^\\mu$ inclusive.\n- Assume independent, identically distributed Gaussian noise on energy with standard deviation $\\sigma_E$ (in eV).\n- For each test case, perform the greedy selection for $N$ points within budget and report the selected volumes and posterior uncertainties.\n\nProvide three test cases to cover different regimes:\n1. Case A (happy path): $N = 6$, $M = 41$, $\\sigma_E = 0.002$ (eV).\n2. Case B (low-budget, higher noise): $N = 3$, $M = 41$, $\\sigma_E = 0.010$ (eV).\n3. Case C (larger budget, low noise): $N = 9$, $M = 41$, $\\sigma_E = 0.001$ (eV).\n\nAll three cases share the same prior as specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing a list with one entry per test case. Each entry must itself be a list of two elements: the first is the selected volumes as a list of floats (in $\\text{\\AA}^3$), and the second is a list of three floats giving the posterior standard deviations for $(V_0, B_0, B_0')$ in the units $(\\text{\\AA}^3, \\text{GPa}, 1)$, in that order.\n- The output must contain no spaces. For example, the shape is $[[[v_1,\\dots,v_N],[s_{V_0},s_{B_0},s_{B_0'}]],\\dots]$ with all numbers in decimal notation and the entire structure printed on a single line without any additional text.\n\nYour program must be self-contained and must not read input or write files. It must be deterministic. Implement the entire solution in a single Python file using only the specified libraries.",
            "solution": "The solution involves three main parts: formulating the third-order Birch-Murnaghan equation of state $E(V)$ and its Jacobian with respect to the model parameters, defining the Bayesian experimental design framework, and implementing the sequential greedy algorithm to select volume points.\n\nThe third-order Birch-Murnaghan equation of state is derived from an expansion of the free energy in powers of the Eulerian finite strain, $f_E$. The strain is defined as:\n$$ f_E(V) = \\frac{1}{2} \\left[ \\left(\\frac{V_0}{V}\\right)^{2/3} - 1 \\right] $$\nwhere $V_0$ is the equilibrium volume. The energy $E(V)$ is then expressed as a function of the parameters $\\boldsymbol{\\theta} = (E_0, V_0, B_0, B_0')$, where $E_0$ is the minimum energy at $V_0$, $B_0$ is the bulk modulus at zero pressure, and $B_0'$ is its pressure derivative. The energy is given by:\n$$ E(V; \\boldsymbol{\\theta}) = E_0 + \\frac{9 V_0 B_0}{2} f_E^2 \\left[ 1 + (B_0' - 4) f_E \\right] $$\nThis form is consistent with the requirement of deriving the energy by integrating the pressure $P(V) = -\\partial E/\\partial V$.\n\nTo apply the Fisher information framework, we need the Jacobian vector $\\boldsymbol{j}(V) = \\nabla_{\\boldsymbol{\\theta}} E(V; \\boldsymbol{\\theta})$, whose components are the partial derivatives of $E(V)$ with respect to each parameter in $\\boldsymbol{\\theta}$.\n1.  **Derivative with respect to $E_0$**:\n    $$ \\frac{\\partial E}{\\partial E_0} = 1 $$\n\n2.  **Derivative with respect to $B_0$**: Let $E_{strain} = E(V) - E_0$.\n    $$ \\frac{\\partial E}{\\partial B_0} = \\frac{E_{strain}}{B_0} = \\frac{9 V_0}{2} f_E^2 \\left[ 1 + (B_0' - 4) f_E \\right] $$\n\n3.  **Derivative with respect to $B_0'$**:\n    $$ \\frac{\\partial E}{\\partial B_0'} = \\frac{9 V_0 B_0}{2} f_E^3 $$\n\n4.  **Derivative with respect to $V_0$**: This is the most involved derivative, obtained using the chain rule.\n    $$ \\frac{\\partial f_E}{\\partial V_0} = \\frac{1}{3V_0}\\left(\\frac{V_0}{V}\\right)^{2/3} $$\n    $$ \\frac{\\partial E}{\\partial V_0} = \\frac{E_{strain}}{V_0} + \\frac{9V_0B_0}{2}\\left(2f_E + 3(B_0'-4)f_E^2\\right)\\frac{\\partial f_E}{\\partial V_0} \\\\ = \\frac{E_{strain}}{V_0} + \\frac{3B_0}{2}\\left(\\frac{V_0}{V}\\right)^{2/3}\\left(2f_E + 3(B_0'-4)f_E^2\\right) $$\nThese analytical derivatives are evaluated at the nominal parameter values given by the prior mean, $\\boldsymbol{\\mu}_0$.\n\nThe problem is cast in a Bayesian framework. We begin with a Gaussian prior on the parameters, $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$. The prior uncertainty is encoded in the prior precision matrix $\\boldsymbol{P}_0 = \\boldsymbol{\\Sigma}_0^{-1}$. Each energy calculation at a volume $V_i$ provides information that updates our knowledge about $\\boldsymbol{\\theta}$. Assuming a Gaussian likelihood for the energy measurements, the information from one measurement is captured by the Fisher Information Matrix (FIM), $I(V_i)$. For a linear model and Gaussian noise, the FIM is the outer product of the gradients scaled by the noise variance:\n$$ I(V) = \\frac{1}{\\sigma_E^2} \\boldsymbol{j}(V)^\\top \\boldsymbol{j}(V) $$\nAfter selecting a set of $N$ volumes $\\mathcal{S} = \\{V_1, \\dots, V_N\\}$, the posterior precision matrix is the sum of the prior precision and the information from each measurement:\n$$ \\boldsymbol{P}_{\\text{post}} = \\boldsymbol{P}_0 + \\sum_{i=1}^N I(V_i) $$\nThe posterior uncertainty is given by the posterior covariance matrix, $\\boldsymbol{\\Sigma}_{\\text{post}} = \\boldsymbol{P}_{\\text{post}}^{-1}$. Our goal is to minimize the uncertainty in the parameters of physical interest $(V_0, B_0, B_0')$. We quantify this uncertainty using the determinant of the corresponding $3 \\times 3$ submatrix of $\\boldsymbol{\\Sigma}_{\\text{post}}$, denoted $\\boldsymbol{\\Sigma}_{\\text{sub}}$. Minimizing $\\det(\\boldsymbol{\\Sigma}_{\\text{sub}})$ is known as a D-optimal design criterion for a subset of parameters. For numerical stability, we equivalently minimize its logarithm, $\\log\\det(\\boldsymbol{\\Sigma}_{\\text{sub}})$.\n\nSince finding the globally optimal set of $N$ points is computationally intractable, we employ a sequential greedy strategy.\n1.  **Initialization**: The candidate set of volumes $\\mathcal{C}$ is generated. All Jacobians $\\boldsymbol{j}(V)$ and single-observation FIMs $I(V)$ for each $V \\in \\mathcal{C}$ are pre-computed using the prior mean parameters $\\boldsymbol{\\mu}_0$. The posterior precision is initialized to the prior precision: $\\boldsymbol{P}_{\\text{current}} = \\boldsymbol{P}_0$. The set of selected volumes $\\mathcal{S}$ is initialized as empty.\n2.  **Iterative Selection**: The algorithm proceeds iteratively for $k=1, \\dots, N$ steps:\n    a. For each available candidate volume $V_c \\in \\mathcal{C} \\setminus \\mathcal{S}$:\n        i. Form a hypothetical posterior precision matrix: $\\boldsymbol{P}_{\\text{hypo}} = \\boldsymbol{P}_{\\text{current}} + I(V_c)$.\n        ii. Invert it to find the hypothetical posterior covariance: $\\boldsymbol{\\Sigma}_{\\text{hypo}} = \\boldsymbol{P}_{\\text{hypo}}^{-1}$.\n        iii. Extract the $3\\times3$ submatrix $\\boldsymbol{\\Sigma}_{\\text{sub}}$ corresponding to $(V_0, B_0, B_0')$.\n        iv. Calculate the objective function score: $s_c = \\log\\det(\\boldsymbol{\\Sigma}_{\\text{sub}})$.\n    b. Identify the best candidate $V^*$ that yields the minimum score: $V^* = \\arg\\min_{V_c} s_c$.\n    c. Update the state by adding $V^*$ to the selected set $\\mathcal{S}$ and permanently updating the precision matrix: $\\boldsymbol{P}_{\\text{current}} \\leftarrow \\boldsymbol{P}_{\\text{current}} + I(V^*)$.\n3.  **Finalization**: After $N$ points have been selected, the final posterior covariance matrix is $\\boldsymbol{\\Sigma}_{\\text{post}} = \\boldsymbol{P}_{\\text{current}}^{-1}$. The posterior standard deviations for $(V_0, B_0, B_0')$ are the square roots of the diagonal elements of the corresponding submatrix. The standard deviation for $B_0$, which is in units of $\\text{eV}/\\text{\\AA}^3$, is converted to GPa using the provided conversion factor. The final output consists of the list of selected volumes $\\mathcal{S}$ and the calculated posterior standard deviations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a sequential D-optimal experimental design to select volume points\n    for fitting the third-order Birch-Murnaghan equation of state.\n    \"\"\"\n\n    # --- Physical Constants and Prior Specification ---\n    GPA_CONVERSION = 160.21766208  # 1 eV/A^3 to GPa\n\n    # Prior mean mu_0 = (E0_mu, V0_mu, B0_mu, B0_prime_mu)\n    E0_mu = -7.5  # eV\n    V0_mu = 16.5  # A^3\n    B0_mu_gpa = 170.0\n    B0_mu = B0_mu_gpa / GPA_CONVERSION  # eV/A^3\n    B0_prime_mu = 4.0\n    mu0 = np.array([E0_mu, V0_mu, B0_mu, B0_prime_mu])\n\n    # Prior standard deviations\n    sigma_E0 = 0.1\n    sigma_V0 = 1.0\n    sigma_B0 = 0.5  # eV/A^3\n    sigma_B0_prime = 1.0\n    \n    # Prior covariance matrix (diagonal)\n    Sigma0 = np.diag([sigma_E0**2, sigma_V0**2, sigma_B0**2, sigma_B0_prime**2])\n    # Prior precision matrix\n    P0 = np.linalg.inv(Sigma0)\n\n    # --- Model and Jacobian Functions ---\n    def birch_murnaghan_E(V, E0, V0, B0, B0_prime):\n        \"\"\"Calculates energy E(V) using the 3rd order Birch-Murnaghan EOS.\"\"\"\n        term_V = (V0 / V)**(2.0 / 3.0)\n        f_E = 0.5 * (term_V - 1.0)\n        E_strain = (9.0 * V0 * B0 / 2.0) * f_E**2 * (1.0 + (B0_prime - 4.0) * f_E)\n        return E0 + E_strain\n\n    def birch_murnaghan_jacobian(V, E0, V0, B0, B0_prime):\n        \"\"\"Calculates the Jacobian of E(V) w.r.t. parameters (E0, V0, B0, B0_prime).\"\"\"\n        j = np.zeros(4)\n        \n        # Intermediate terms evaluated at nominal parameters\n        v_ratio_2_3 = (V0 / V)**(2.0 / 3.0)\n        f_E = 0.5 * (v_ratio_2_3 - 1.0)\n        E_strain = (9.0 * V0 * B0 / 2.0) * f_E**2 * (1.0 + (B0_prime - 4.0) * f_E)\n\n        # dE/dE0\n        j[0] = 1.0\n\n        # dE/dV0\n        dfE_dV0 = (1.0 / (3.0 * V0)) * v_ratio_2_3\n        dEstrain_dfE = (9.0 * V0 * B0 / 2.0) * (2.0 * f_E + 3.0 * (B0_prime - 4.0) * f_E**2)\n        j[1] = E_strain / V0 + dEstrain_dfE * dfE_dV0\n\n        # dE/dB0\n        j[2] = E_strain / B0\n\n        # dE/dB0_prime\n        j[3] = (9.0 * V0 * B0 / 2.0) * f_E**3\n\n        return j\n\n    # --- Test Cases ---\n    test_cases = [\n        # (N, M, sigma_E)\n        (6, 41, 0.002), # Case A\n        (3, 41, 0.010), # Case B\n        (9, 41, 0.001), # Case C\n    ]\n\n    all_results = []\n\n    for N, M, sigma_E in test_cases:\n        # --- Algorithm Setup ---\n        # Candidate set\n        candidate_volumes = np.linspace(0.85 * V0_mu, 1.15 * V0_mu, M)\n        \n        # Pre-compute Jacobians and FIM contributions for all candidates\n        all_I = []\n        for V in candidate_volumes:\n            j_v = birch_murnaghan_jacobian(V, *mu0)\n            I_v = (1.0 / sigma_E**2) * np.outer(j_v, j_v)\n            all_I.append(I_v)\n        \n        # --- Greedy Selection Loop ---\n        P_current = P0.copy()\n        selected_indices = []\n        available_indices = list(range(M))\n\n        for _ in range(N):\n            best_idx = -1\n            min_log_det = float('inf')\n            \n            for idx in available_indices:\n                P_hypo = P_current + all_I[idx]\n                \n                try:\n                    # Invert precision for covariance\n                    Sigma_hypo = np.linalg.inv(P_hypo)\n                except np.linalg.LinAlgError:\n                    # Should not happen with non-singular prior\n                    continue\n                \n                # Submatrix for (V0, B0, B0_prime)\n                Sigma_sub = Sigma_hypo[1:, 1:]\n                \n                # Objective a.k.a score\n                sign, log_det = np.linalg.slogdet(Sigma_sub)\n                \n                if sign > 0 and log_det < min_log_det:\n                    min_log_det = log_det\n                    best_idx = idx\n\n            # Update state with the best found candidate\n            if best_idx != -1:\n                P_current += all_I[best_idx]\n                selected_indices.append(best_idx)\n                available_indices.remove(best_idx)\n\n        # --- Final Results Calculation ---\n        # Final posterior covariance\n        Sigma_post = np.linalg.inv(P_current)\n        \n        # Extract selected volumes\n        selected_volumes = [candidate_volumes[i] for i in selected_indices]\n        \n        # Extract posterior standard deviations\n        post_stdevs = np.sqrt(np.diag(Sigma_post))\n        \n        s_V0 = post_stdevs[1]\n        s_B0 = post_stdevs[2] * GPA_CONVERSION  # Convert to GPa\n        s_B0_prime = post_stdevs[3]\n\n        final_stdevs_list = [s_V0, s_B0, s_B0_prime]\n        \n        all_results.append([selected_volumes, final_stdevs_list])\n\n    # Format output to be a single line with no spaces\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}