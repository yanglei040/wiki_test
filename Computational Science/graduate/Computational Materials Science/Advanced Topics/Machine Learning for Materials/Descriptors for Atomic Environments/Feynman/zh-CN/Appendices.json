{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践将让你亲自动手，从零开始构建原子环境描述符。你将通过数值化实现两种流行的描述符——光滑原子位置重叠（SOAP）和以原子为中心对称函数（ACSF）——来加深对它们核心数学结构的理解。此练习旨在通过编码实践，验证描述符的基本性质，例如旋转不变性，这是描述符在材料科学中应用的基础 。",
            "id": "3443939",
            "problem": "要求您实现并数值验证局部原子环境的描述符，重点是原子位置光滑重叠（SOAP）和原子中心对称函数（ACSF），从原子中心密度和旋转不变性的基本定义开始。实现必须严格遵循以下说明，并为指定的测试套件生成一个单行输出，该输出汇总了数值结果。\n\n基本基础如下。考虑一个位于原点的中心原子和一组邻近原子，其位置由笛卡尔坐标给出。距离以埃（Angstroms）为单位。角度必须以弧度计算。定义一个各向同性截断函数以确保局域性。环境的密度由点贡献表示，描述符必须在全局旋转和平移下保持不变。您的程序应实现：\n\n- 一个光滑的径向截断函数 $f_c(r)$，满足当 $r \\le r_c$ 时 $f_c(r) = \\frac{1}{2}\\left[\\cos\\left(\\frac{\\pi r}{r_c}\\right) + 1\\right]$，当 $r > r_c$ 时 $f_c(r) = 0$，其中 $r_c$ 的单位为埃。\n- 一个近似的 SOAP 描述符，通过将点密度投影到标准正交径向基和球谐函数上构建，然后形成旋转不变的功率谱，并通过其欧几里得范数进行归一化。点密度近似对应于高斯平滑密度在 $\\sigma \\to 0$ 时的极限，对于本数值练习的目的是可接受的。\n- ACSF 径向和角向函数，设计为在平移、旋转和相同邻居的排列下保持不变。\n\n所有角度必须以弧度计算，所有距离必须以埃为单位。描述符应按如下方式定义：\n\n- 对于截断，使用 $r_c = 3.0$ 埃，并如上定义 $f_c(r)$。\n- 对于 SOAP，通过对高斯径向探针 $g_k(r) = \\exp\\left( -\\frac{(r - R_k)^2}{2\\sigma_r^2} \\right)$ 使用 Gram-Schmidt 方法，关于在均匀径向网格上离散化的加权内积 $\\langle u, v \\rangle = \\int_{0}^{r_c} u(r)\\,v(r)\\,r^2 \\,\\mathrm{d}r$ 进行标准正交化，构建一个标准正交径向基 $\\{\\phi_n(r)\\}_{n=0}^{N_n-1}$。使用 $N_n = 3$ 个径向函数，$\\sigma_r = 0.3$ 埃，以及中心 $R_k = r_c \\cdot \\frac{k+1}{N_n+1}$（对于 $k \\in \\{0,1,2\\}$）。在 $[0,r_c]$ 上使用具有 $N_r = 400$ 个点的均匀径向网格。设角向基为复球谐函数 $Y_{\\ell m}(\\theta,\\phi)$，最高到 $\\ell_{\\max} = 2$。对于相对于中心原子的位置向量为 $\\mathbf{r}_j$ 的邻居，定义 $r_j = \\|\\mathbf{r}_j\\|$，$\\theta_j$ 为余纬，$\\phi_j$ 为方位角。近似展开系数为\n$$\nc_{n \\ell m} = \\sum_{j} \\phi_n(r_j)\\, Y_{\\ell m}(\\theta_j,\\phi_j)\\, f_c(r_j),\n$$\n其中求和遍历截断范围内的所有邻居。旋转不变的功率谱分量为\n$$\np_{n n' \\ell} = \\sum_{m=-\\ell}^{\\ell} c_{n \\ell m}\\, c_{n' \\ell m}^*,\n$$\n描述符是 $p_{n n' \\ell}$ 在 $\\ell \\in \\{0,1,2\\}$ 和 $0 \\le n \\le n' \\le N_n-1$ 上的串联，如果其欧几里得范数非零，则进行归一化。\n- 对于中心原子的 ACSF 径向函数 $G^{(2)}$（邻居索引为 $j$），使用以下族\n$$\nG^{(2)}(\\eta, R_s) = \\sum_{j} \\exp\\left( -\\eta\\, (r_{j} - R_s)^2 \\right)\\, f_c(r_{j}),\n$$\n参数为 $\\eta = 1.0$ 和 $R_s \\in \\{0.5, 1.0, 1.5, 2.0, 2.5\\}$（单位为埃）；报告这个 5 分量向量的和。\n- 对于不同邻居对 $(j,k)$（其中 $j \\ne k$）的 ACSF 角向函数 $G^{(4)}$，使用\n$$\nG^{(4)}(\\eta, \\zeta, \\lambda) = 2^{1-\\zeta} \\sum_{j  k} (1 + \\lambda \\cos\\theta_{ijk})^{\\zeta} \\exp(-\\eta(r_{ij}^2 + r_{ik}^2)) f_c(r_{ij})f_c(r_{ik})\n$$\n参数为 $\\eta=0.5, \\zeta=4.0, \\lambda=-1.0$；报告单个标量值。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于计算材料科学的原理，自洽地包含了所有必要的参数和定义，并且是适定的（well-posed），允许一个唯一的、可验证的数值解。因此，我们可以进行正式的求解。\n\n目标是实现并数值评估两种用于局部原子环境的描述符：原子位置光滑重叠（SOAP）和原子中心对称函数（ACSF）。这些描述符旨在提供一个原子局部环境的数值指纹，该指纹对相同邻近原子的平移、旋转和排列具有不变性。\n\n### 1. 基本定义\n\n我们从两种描述符类型共有的基本元素开始。局部环境是为中心原子（我们将其置于原点 $\\mathbf{0}$）和一组位于位置 $\\{\\mathbf{r}_j\\}$ 的邻近原子定义的。\n\n一个关键组成部分是光滑截断函数 $f_c(r)$，它确保只有在某个半径 $r_c$ 内的原子才对描述符有贡献。这种局域性对于计算效率和物理相关性至关重要。指定的截断函数为：\n$$\nf_c(r) = \\begin{cases} \\frac{1}{2}\\left[\\cos\\left(\\frac{\\pi r}{r_c}\\right) + 1\\right]  \\text{if } r \\le r_c \\\\ 0  \\text{if } r > r_c \\end{cases}\n$$\n截断半径为 $r_c = 3.0$ 埃。这里，$r = \\|\\mathbf{r}\\|$ 是径向距离。\n\n### 2. 原子位置光滑重叠（SOAP）描述符\n\nSOAP 描述符是通过在函数基上展开局部原子密度，然后形成一个旋转不变的功率谱来构建的。问题指定了一种近似形式，其中原子密度是狄拉克δ函数的和，$\\rho(\\mathbf{r}) = \\sum_j \\delta(\\mathbf{r} - \\mathbf{r}_j)$。\n\n**步骤 2.1：标准正交径向基 $\\{\\phi_n(r)\\}$**\n第一步是为展开的径向部分构建一个标准正交基。我们从一组非正交的高斯函数开始：\n$$\ng_k(r) = \\exp\\left( -\\frac{(r - R_k)^2}{2\\sigma_r^2} \\right)\n$$\n对于 $k \\in \\{0, 1, ..., N_n-1\\}$。问题指定了 $N_n = 3$ 个径向函数，$\\sigma_r = 0.3$ 埃，以及中心 $R_k = r_c \\cdot \\frac{k+1}{N_n+1}$。\n\n这些函数使用 Gram-Schmidt 过程相对于加权内积 $\\langle u, v \\rangle = \\int_{0}^{r_c} u(r)\\,v(r)\\,r^2 \\,\\mathrm{d}r$ 进行正交化。在数值上，这个积分在从 $r=0$ 到 $r=r_c$ 的一个包含 $N_r = 400$ 个点的均匀径向网格上进行离散化。设网格点为 $\\{r_i\\}$，间距为 $\\Delta r$。内积通过以下求和来近似：\n$$\n\\langle u, v \\rangle \\approx \\sum_{i=0}^{N_r-1} u(r_i)v(r_i)r_i^2 \\Delta r\n$$\n然后将 Gram-Schmidt 过程应用于集合 $\\{g_k(r)\\}$ 以获得标准正交基 $\\{\\phi_n(r)\\}$。\n\n**步骤 2.2：展开系数 $c_{n \\ell m}$**\n原子环境被投影到一个由我们的径向基函数 $\\phi_n(r)$ 和复球谐函数 $Y_{\\ell m}(\\theta, \\phi)$ 的乘积构成的基上，其中 $\\theta$ 是余纬，$\\phi$ 是方位角。展开系数通过对截断半径内每个邻居 $j$ 的贡献求和得到：\n$$\nc_{n \\ell m} = \\sum_{j} \\phi_n(r_j)\\, Y_{\\ell m}(\\theta_j,\\phi_j)\\, f_c(r_j)\n$$\n其中 $(r_j, \\theta_j, \\phi_j)$ 是位置为 $\\mathbf{r}_j$ 的邻居的球坐标。$\\phi_n(r_j)$ 的值通过在距离 $r_j$ 处评估数值定义的基函数来获得，对此，在径向网格上进行线性插值是一种合适的方法。角分辨率受限于 $\\ell_{\\max} = 2$。\n\n**步骤 2.3：功率谱 $p_{n n' \\ell}$ 和最终描述符**\n为实现旋转不变性，我们通过对磁量子数 $m$ 求和来构建功率谱：\n$$\np_{n n' \\ell} = \\sum_{m=-\\ell}^{\\ell} c_{n \\ell m}\\, c_{n' \\ell m}^*\n$$\n其中 $c^*$ 表示复共轭。分量 $p_{n n' \\ell}$ 在坐标系旋转下是不变的。最终的 SOAP 描述符是一个向量，由所有 $\\ell \\in \\{0, 1, 2\\}$ 和所有唯一对 $0 \\le n \\le n' \\le N_n-1$ 的实值分量 $p_{n n' \\ell}$ 串联而成。如果范数非零，则该向量通过除以其欧几里得范数被归一化为单位长度。\n\n### 3. 原子中心对称函数 (ACSF)\n\nACSF 是另一类描述符，它直接由几何量（距离和角度）构建，以通过构造确保不变性。\n\n**步骤 3.1：径向函数 $G^{(2)}$**\n径向对称函数 $G^{(2)}$ 探测邻居的径向分布。它被定义为对所有邻居 $j$ 的求和：\n$$\nG^{(2)}(\\eta, R_s) = \\sum_{j} \\exp\\left( -\\eta\\, (r_{j} - R_s)^2 \\right)\\, f_c(r_{j})\n$$\n其中 $\\eta$ 控制高斯函数的宽度，$R_s$ 是一个可变中心。问题要求计算一组 $G^{(2)}$ 值的向量，参数为 $\\eta = 1.0$ 和 $R_s \\in \\{0.5, 1.0, 1.5, 2.0, 2.5\\}$，并报告这五个分量的总和。\n\n**步骤 3.2：角向函数 $G^{(4)}$**\n角向对称函数 $G^{(4)}$ 探测邻居的角向分布，考虑原子三元组（中心原子和两个邻居 $j$ 和 $k$）。它被定义为：\n$$\nG^{(4)}(\\eta, \\zeta, \\lambda) = 2^{1-\\zeta} \\sum_{j  k} (1 + \\lambda \\cos\\theta_{ijk})^{\\zeta} \\exp(-\\eta(r_{ij}^2 + r_{ik}^2)) f_c(r_{ij})f_c(r_{ik})\n$$\n其中 $\\theta_{ijk}$ 是中心原子 $i$ 与邻居 $j$ 和 $k$ 形成的角。求和遍历所有唯一的邻居对 $(j,k)$。我们使用给定的参数 $\\eta=0.5, \\zeta=4.0, \\lambda=-1.0$ 来计算这个标量值。",
            "answer": "[0.0000000000,0.0000000000,0.0000000000,1.9961166318,0.4138407316]"
        },
        {
            "introduction": "既然你已经了解了如何构建描述符，现在让我们来探索它们的分辨能力。这个练习将挑战你构建一些特殊的原子环境：它们拥有完全相同的对分布函数，但在结构上却截然不同。你将需要确定区分这些“结构异构体”所需的最低角动量分辨率（$l_{\\max}$），从而揭示高阶角关联信息在区分复杂结构时的关键作用 。",
            "id": "3443973",
            "problem": "您的任务是构建并分析两个三维局域原子环境，它们具有相同的对分布，但不能通过任何刚性旋转或反射相互重合。目标是确定一个基于原子位置平滑重叠 (SOAP) 的旋转不变描述符区分这些环境所需的最小角分辨率，该分辨率表示为最小非负整数 $l_{\\max}$。目标描述符必须直接由邻居分布的角分解构建，并且在每个角阶 $l$ 上都必须是旋转不变的。\n\n此任务的基础如下：\n- 中心原子周围的对分布，记为 $g(r)$，仅取决于到中心原子的邻居距离的多重集，并舍弃所有角度信息。\n- 球谐函数构成单位球面上的一个标准正交基，由 $(l,m)$ 索引，其中 $l \\in \\{0,1,2,\\dots\\}$ 且 $m \\in \\{-l,-l+1,\\dots,l\\}$。\n- 旋转不变性是通过以不依赖于方向的方式聚合角模态的幅度来获得的；具体而言，在固定的 $l$ 下对 $m$ 求和会产生旋转不变量。\n\n您必须实现一个程序，对于下面提供的每个测试用例，执行以下步骤：\n- 将中心原子周围的两个局域环境构建为邻居向量的有限集。每个邻居向量是一个三维笛卡尔向量，指示相对于中心原子的邻居位置。所有角度都必须以弧度处理。\n- 通过在每个环境中使用相同的邻居半径多重集，确保该对中的两个环境具有相同的对分布 $g(r)$，从而仅有角度信息不同。\n- 采用标准 SOAP 原子密度的零宽度极限（因此每个邻居贡献为单位球面上的一个方向点），并使用与将半径划分为壳层一致的正交径向通道方案。在指定的壳层上使用分段常数、相互正交的径向通道来分离来自不同半径的贡献；在单壳层情况下，只有一个壳层。对于多壳层情况，通过指定的分割半径定义两个壳层。\n- 对于选定的非负搜索上限 $L_{\\text{search}}$，通过将每个径向壳层内的邻居方向投影到球谐函数上，并对 $m$ 的幅度进行聚合，为每个 $l$ 形成旋转不变量，从而计算每个角阶 $l \\in \\{0,1,\\dots,L_{\\text{search}}\\}$ 上的旋转不变描述符。对于多壳层情况，在每个 $l$ 处包含壳层之间的交叉通道相关性以形成描述符。\n- 确定两个环境的描述符在哪个最小的 $l_{\\max} \\in \\{0,1,\\dots,L_{\\text{search}}\\}$ 上差异超过固定的数值容差，如果对于所有 $l \\le L_{\\text{search}}$ 均未检测到差异，则返回 $-1$。\n\n您的程序必须使用以下内容实现上述功能：\n- 以弧度为参数计算的球谐函数。\n- 用于判断描述符相等性的数值容差 $10^{-12}$。\n- 搜索上限 $L_{\\text{search}} = 12$。\n\n在以下测试套件中设计环境。在所有情况下，邻居半径不带物理单位，是纯数字，所有角度量均以弧度为单位。\n\n- 测试用例 1（单壳层）：环境 $\\mathcal{A}_1$ 有 4 个邻居，半径为 1，位于内接于单位球的正四面体的顶点上（使用四个方向 $(\\pm 1,\\pm 1,\\pm 1)/\\sqrt{3}$，其中负号数量为偶数）。环境 $\\mathcal{B}_1$ 有 4 个邻居，半径为 1，位于赤道平面上，方向为 $(1,0,0)$、$(-1,0,0)$、$(0,1,0)$、$(0,-1,0)$。由于所有邻居半径均为 1，两者具有相同的 $g(r)$。\n- 测试用例 2（单壳层）：环境 $\\mathcal{A}_2$ 有 6 个邻居，半径为 1，方向为 $(\\pm 1,0,0)$、$(0,\\pm 1,0)$、$(0,0,\\pm 1)$（八面体排列）。环境 $\\mathcal{B}_2$ 有 6 个邻居，半径为 1，均匀分布在赤道圆上，方位角为 $0$、$\\pi/3$、$2\\pi/3$、$\\pi$、$4\\pi/3$、$5\\pi/3$，极角为 $\\pi/2$。由于所有邻居半径均为 1，两者具有相同的 $g(r)$。\n- 测试用例 3（单壳层）：环境 $\\mathcal{A}_3$ 与 $\\mathcal{A}_1$ 相同。环境 $\\mathcal{B}_3$ 是将 $\\mathcal{A}_1$ 绕 $z$ 轴旋转 $0.37$ 弧度得到的。这两个环境通过旋转是同构的，因此它们的旋转不变描述符应对所有 $l$ 都一致。\n- 测试用例 4（双壳层）：环境 $\\mathcal{A}_4$ 有 5 个邻居，半径为 $\\{1,1,1.5,1.5,1.5\\}$。将两个半径为 1 的邻居放置在 $(0,0,1)$ 和 $(0,0,-1)$ 上。将三个半径为 1.5 的邻居放置在赤道平面上，方位角为 $0$、$2\\pi/3$、$4\\pi/3$，极角为 $\\pi/2$。环境 $\\mathcal{B}_4$ 具有相同的半径多重集 $\\{1,1,1.5,1.5,1.5\\}$，其中两个半径为 1 的邻居也位于 $(0,0,1)$ 和 $(0,0,-1)$ 上，但三个半径为 1.5 的邻居排列在赤道平面之外，具有共同的极角 $1.0$ 和方位角 $0$、$2\\pi/3$、$4\\pi/3$。使用分割半径为 $1.25$ 的双壳层径向方案，使得半径 1 属于内壳层，半径 1.5 属于外壳层。\n\n对于每个测试用例，从 $l=0$ 搜索到 $L_{\\text{search}}$，并报告两个环境的旋转不变描述符差异超过容差时的最小 $l_{\\max}$，如果在搜索范围内未检测到差异，则报告 $-1$。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$），其中每个条目是 $\\{-1,0,1,\\dots,12\\}$ 中的一个整数。",
            "solution": "该问题要求确定最小角分辨率，记为整数 $l_{\\max}$，用以区分成对的三维局域原子环境。这些环境被构建为具有相同的对分布，但具有不同的高阶（角度）相关性。该描述符基于原子位置平滑重叠 (SOAP) 形式体系，并简化为原子邻居的零宽度极限情况。\n\n### 数学框架\n一个局域原子环境由一组相对于中心原子的邻居位置向量 $\\{\\vec{r}_i\\}$ 定义。原子邻居密度 $\\rho(\\vec{r})$ 是以每个邻居位置为中心的狄拉克δ函数的总和：\n$$\n\\rho(\\vec{r}) = \\sum_i \\delta(\\vec{r} - \\vec{r}_i)\n$$\n该密度在球谐函数基 $Y_{lm}(\\hat{r})$（用于角度部分）和径向基 $g_n(r)$（用于径向部分）中展开。问题指定了一个简化的径向方案，其中邻居被划分到不相交的壳层中。特定壳层 $n$ 内的密度展开系数由下式给出：\n$$\nc_{nlm} = \\int \\rho(\\vec{r}) g_n(r) Y_{lm}^*(\\hat{r}) d\\vec{r}\n$$\n对于δ函数密度和一个划分方案（其中 $g_n(r)$ 实际上是壳层 $n$ 的指示函数），该积分简化为对属于该壳层的邻居 $\\{i\\}$（我们用集合 $I_n$ 表示）的求和：\n$$\nc_{nlm} = \\sum_{i \\in I_n} Y_{lm}^*(\\theta_i, \\phi_i)\n$$\n其中 $(\\theta_i, \\phi_i)$ 是邻居向量 $\\vec{r}_i$ 的极角和方位角。球谐函数 $Y_{lm}(\\theta, \\phi)$ 使用标准的物理学约定进行计算，其中 $\\theta \\in [0, \\pi]$ 且 $\\phi \\in [0, 2\\pi)$。\n\n### 旋转不变描述符\n为了实现旋转不变性，我们从展开系数构建功率谱。对于给定的角动量通道 $l$，功率谱分量是通过耦合来自两个径向壳层 $n_1$ 和 $n_2$ 的系数并对磁量子数 $m$ 求和形成的：\n$$\np_{n_1 n_2 l} = \\sum_{m=-l}^{l} c_{n_1 l m}^* c_{n_2 l m}\n$$\n这些量在原子环境的刚性旋转下是不变的。对于给定的 $l$，这些值的集合构成了该角阶的描述符。\n\n-   **单壳层情况**：我们只有一个壳层（$n_1=n_2=1$）。在阶 $l$ 上的描述符是标量值 $p_{11l} = \\sum_{m=-l}^{l} |c_{1lm}|^2$。\n-   **双壳层情况**：对于两个壳层（$n \\in \\{1, 2\\}$），在阶 $l$ 上的描述符必须包括所有自相关（$p_{11l}, p_{22l}$）和互相关（$p_{12l}, p_{21l}$）。由于 $p_{21l} = p_{12l}^*$，对于给定的 $l$，其独特信息由实数向量 $(p_{11l}, p_{22l}, \\text{Re}(p_{12l}), \\text{Im}(p_{12l}))$ 捕获。\n\n### 寻找 $l_{\\max}$ 的算法\n对于每对环境 $\\mathcal{A}$ 和 $\\mathcal{B}$，我们搜索使其描述符出现差异的最小非负整数 $l_{\\max}$。\n\n1.  对于每个角阶 $l$ 从 $0$到 $L_{\\text{search}} = 12$：\n    a.  计算环境 $\\mathcal{A}$ 的描述符向量，记为 $D_l^{(\\mathcal{A})}$。\n    b.  计算环境 $\\mathcal{B}$ 的描述符向量，记为 $D_l^{(\\mathcal{B})}$。\n    c.  如果欧几里得距离 $\\|D_l^{(\\mathcal{A})} - D_l^{(\\mathcal{B})}\\| > 10^{-12}$，则 $l$ 是最小的可区分角阶。我们设置 $l_{\\max} = l$ 并终止对该对的搜索。\n2.  如果循环完成而未发现任何差异，则说明在 $L_{\\text{search}}$ 的范围内，这些环境是不可区分的。在这种情况下，我们设置 $l_{\\max} = -1$。\n\n### 测试用例分析\n\n-   **测试用例 1**：一个正四面体（$\\mathcal{A}_1$，对称群 $T_d$）与一个方形平面排列（$\\mathcal{B}_1$，对称性 $D_{4h}$）。由于其高对称性，四面体环境的 $l=1$（偶极）和 $l=2$（四极）多极矩为零。方形平面结构对称性较低，具有非零的四极矩。因此，它们的功率谱将是 $p_{11,2}^{(\\mathcal{A}_1)} = 0$ 但 $p_{11,2}^{(\\mathcal{B}_1)} \\neq 0$。预期结果是 $l_{\\max}=2$。\n\n-   **测试用例 2**：一个八面体（$\\mathcal{A}_2$，对称性 $O_h$）与一个平面正六边形（$\\mathcal{B}_2$，对称性 $D_{6h}$）。两种结构都具有反演对称性，导致功率谱的所有奇数 $l$ 分量都为零。八面体几何结构高度对称，其第一个非零多极矩出现在 $l=4$ 处。平面六边形具有非零的四极矩（$l=2$）。因此，我们预期 $p_{11,2}^{(\\mathcal{A}_2)} = 0$ 且 $p_{11,2}^{(\\mathcal{B}_2)} \\neq 0$，导致 $l_{\\max}=2$。\n\n-   **测试用例 3**：一个正四面体（$\\mathcal{A}_3$）与同一个四面体旋转 $0.37$ 弧度（$\\mathcal{B}_3$）的比较。该描述符被设计为旋转不变的。因此，$\\mathcal{A}_3$ 和 $\\mathcal{B}_3$ 的描述符在数值精度范围内对所有 $l$ 都应相同。预期结果是 $l_{\\max}=-1$。\n\n-   **测试用例 4**：一个具有 $D_{3h}$ 对称性的双壳层环境（$\\mathcal{A}_4$）与一个具有 $C_{3v}$ 对称性的环境（$\\mathcal{B}_4$）的比较。两个环境的内壳层是相同的。$\\mathcal{A}_4$ 的外壳层由赤道平面上的三个原子组成，其矢量和为零，导致偶极矩为零（$c_{2,1,m}^{(\\mathcal{A}_4)}=0$）。$\\mathcal{B}_4$ 的外壳层中的三个原子位于极角为 1.0 弧度的位置，导致沿 z 轴的净矢量和不为零。这意味着存在非零偶极矩（$c_{2,1,0}^{(\\mathcal{B}_4)} \\neq 0$）。因此，功率谱项 $p_{22,1}$ 对于 $\\mathcal{A}_4$ 将为零，但对于 $\\mathcal{B}_4$ 则非零。预计这两个环境将在 $l=1$ 处被区分开。",
            "answer": "[2,2,-1,1]"
        },
        {
            "introduction": "描述符的设计选择会直接影响其在实际应用中的表现，尤其是在构建机器学习原子间势时。最后的这个练习将深入探讨一个关键的数学性质——光滑性。你将分析不同光滑度的截断函数如何影响力的连续性，而这对于实现稳定且能量守恒的分子动力学模拟至关重要 。",
            "id": "3443993",
            "problem": "考虑一个用于机器学习原子间势的以原子为中心的径向描述符，其定义为 $G(r) = \\phi(r)\\,f_c(r)$，其中 $r$ 是中心原子与其邻近原子之间的标量原子间距离，$\\phi(r)$ 是一个平滑径向基，而 $f_c(r)$ 是一个截断函数，它通过在有限的截断距离 $r_c$ 处将贡献逐渐衰减至零来强制实现局域性。这种构造在以原子为中心的对称函数（Atom-Centered Symmetry Functions, ACSF）中是标准的，并且也类似于在原子位置的平滑重叠（Smooth Overlap of Atomic Positions, SOAP）方法中使用的局域化核函数。\n\n假设径向基为高斯函数 $\\phi(r) = \\exp\\!\\left(-\\eta\\,(r - R_s)^2\\right)$，其参数为 $\\eta > 0$ 和 $R_s \\ge 0$。截断函数 $f_c(r)$ 从三个类别中选取，每个类别在截断点 $r = r_c$ 处具有不同的平滑度：\n\n1. $C^0$ 连续线性锥削：\n   $$ f_c^{(0)}(r) = \\begin{cases} 1 - \\dfrac{r}{r_c},  0 \\le r  r_c, \\\\ 0,  r \\ge r_c. \\end{cases} $$\n   该函数是连续的，且 $f_c^{(0)}(r_c)=0$，但其一阶导数在 $r_c$ 处不连续。\n\n2. $C^1$ 连续余弦锥削：\n   $$ f_c^{(1)}(r) = \\begin{cases} \\dfrac{1}{2}\\left[1 + \\cos\\!\\left(\\dfrac{\\pi\\,r}{r_c}\\right)\\right],  0 \\le r \\le r_c, \\\\ 0,  r \\ge r_c. \\end{cases} $$\n   该函数及其一阶导数在 $r_c$ 处均是连续的，且 $f_c^{(1)}(r_c)=0$ 和 $\\dfrac{d}{dr}f_c^{(1)}(r_c)=0$。\n\n3. $C^\\infty$ 平滑紧支集凸点函数：\n   $$ f_c^{(\\infty)}(r) = \\begin{cases} \\exp\\!\\left(-\\dfrac{r^2}{r_c^2 - r^2}\\right),  0 \\le r  r_c, \\\\ 0,  r \\ge r_c. \\end{cases} $$\n   该函数是无限可微的，在截断点处，从左侧逼近时，有 $f_c^{(\\infty)}(r_c)=0$ 且所有阶导数均为零；从右侧看，该函数恒等于零。\n\n从单变量微积分的基本法则（包括乘法法则和链式法则）出发，针对 $f_c(r) \\in \\{f_c^{(0)}, f_c^{(1)}, f_c^{(\\infty)}\\}$ 的每一种选择，推导在 $r=r_c$ 处径向导数 $\\dfrac{\\partial G}{\\partial r}$ 的左右极限的解析表达式。通过跳变幅度来明确量化导数的不连续性：\n$$ \\Delta\\left(\\dfrac{\\partial G}{\\partial r}\\right)\\Big|_{r_c} \\equiv \\left|\\lim_{r \\to r_c^-} \\dfrac{\\partial G}{\\partial r} - \\lim_{r \\to r_c^+} \\dfrac{\\partial G}{\\partial r}\\right|. $$\n\n为了将导数的不连续性与分子动力学（MD）的稳定性联系起来，考虑一个简单的能量映射 $E(G) = a\\,G$，其中 $a$ 是一个常数系数（为归一化设 $a=1$）。径向力投影为 $F_r = -\\dfrac{\\partial E}{\\partial r} = -\\dfrac{\\partial G}{\\partial r}$。使用 $\\dfrac{\\partial G}{\\partial r}$ 在 $r_c$ 处的跳变幅度作为力噪声的代理，并定义一个稳定性判据：对于给定的截断函数选择，如果 $\\Delta\\!\\left(\\dfrac{\\partial G}{\\partial r}\\right)\\big|_{r_c} \\le T$，则认为 MD 是稳定的，其中 $T$ 是每个测试用例提供的预设阈值。\n\n你的程序必须实现这些推导，并为每个提供的测试用例计算所有三类截断函数的跳变幅度以及在给定阈值下的相应稳定性布尔值。在此问题中，所有量都是无量纲的。\n\n测试套件参数是元组 $(\\eta, R_s, r_c, T)$：\n\n- 案例 1（一般情况，截断点附近有非平凡重叠）：$(\\eta=2.0, R_s=4.5, r_c=5.0, T=0.05)$。\n- 案例 2（基函数中心远离截断点，强衰减）：$(\\eta=10.0, R_s=0.0, r_c=5.0, T=10^{-8})$。\n- 案例 3（基函数中心位于截断点，较小的 $r_c$）：$(\\eta=0.5, R_s=1.0, r_c=1.0, T=0.5)$。\n- 案例 4（基函数中心位于截断点，较大的 $r_c$）：$(\\eta=1.0, R_s=8.0, r_c=8.0, T=0.2)$。\n\n最终输出格式要求：你的程序应生成单行输出，包含一个列表的列表，其中每个内部列表对应一个测试用例，并按以下顺序排列：\n$$[\\Delta_0,\\ \\Delta_1,\\ \\Delta_\\infty,\\ \\text{stable}_0,\\ \\text{stable}_1,\\ \\text{stable}_\\infty],$$\n其中 $\\Delta_0$、$\\Delta_1$、$\\Delta_\\infty$ 分别是 $f_c^{(0)}$、$f_c^{(1)}$、$f_c^{(\\infty)}$ 的跳变幅度，而 $\\text{stable}_\\ast$ 是满足给定阈值 $T$ 判据的布尔值。打印的单行必须具有确切的 Python 列表格式，例如：\n$$[[0.1,0.0,0.0,False,True,True],[\\dots]].$$",
            "solution": "问题要求推导并计算径向描述符函数 $G(r)$ 在截断半径 $r_c$ 处一阶导数的不连续性。此不连续性用于评估分子动力学模拟中相应简化力模型的数值稳定性。\n\n径向描述符由乘积 $G(r) = \\phi(r) f_c(r)$ 给出，其中径向基是高斯函数 $\\phi(r) = \\exp(-\\eta(r - R_s)^2)$，$f_c(r)$ 是三种指定的截断函数之一。\n\n首先，我们推导 $G(r)$ 相对于原子间距离 $r$ 的导数的一般表达式。使用微分的乘法法则，我们得到：\n$$ \\frac{\\partial G}{\\partial r} = \\frac{\\partial}{\\partial r} \\left[ \\phi(r) f_c(r) \\right] = \\frac{\\partial \\phi}{\\partial r} f_c(r) + \\phi(r) \\frac{\\partial f_c}{\\partial r} $$\n高斯基函数 $\\phi(r)$ 的导数使用链式法则求得：\n$$ \\frac{\\partial \\phi}{\\partial r} = \\frac{d}{dr} \\left( -\\eta(r-R_s)^2 \\right) \\cdot \\exp\\!\\left(-\\eta(r - R_s)^2\\right) = -2\\eta(r-R_s) \\exp\\!\\left(-\\eta(r - R_s)^2\\right) $$\n让我们记 $\\phi'(r) \\equiv \\frac{\\partial \\phi}{\\partial r}$ 和 $f_c'(r) \\equiv \\frac{\\partial f_c}{\\partial r}$。那么描述符的导数是：\n$$ \\frac{\\partial G}{\\partial r} = \\phi'(r) f_c(r) + \\phi(r) f_c'(r) $$\n在 $r=r_c$ 处，该导数的不连续性或跳变幅度定义为：\n$$ \\Delta\\left(\\dfrac{\\partial G}{\\partial r}\\right)\\Big|_{r_c} = \\left|\\lim_{r \\to r_c^-} \\dfrac{\\partial G}{\\partial r} - \\lim_{r \\to r_c^+} \\dfrac{\\partial G}{\\partial r}\\right| $$\n我们必须对每种情况计算其左右极限。\n\n对于所有三种截断函数，当 $r \\ge r_c$ 时，$f_c(r) = 0$。这意味着对于 $r > r_c$，$f_c(r)$ 是一个常数函数，其导数 $f_c'(r)$ 也为 $0$。因此，对于 $r > r_c$，描述符 $G(r) = \\phi(r) \\cdot 0 = 0$，其导数 $\\frac{\\partial G}{\\partial r}$ 也为 $0$。所以，右极限普遍为零：\n$$ \\lim_{r \\to r_c^+} \\dfrac{\\partial G}{\\partial r} = \\lim_{r \\to r_c^+} 0 = 0 $$\n跳变幅度简化为左极限的绝对值：\n$$ \\Delta\\left(\\dfrac{\\partial G}{\\partial r}\\right)\\Big|_{r_c} = \\left|\\lim_{r \\to r_c^-} \\dfrac{\\partial G}{\\partial r}\\right| $$\n我们现在为三种截断函数分别计算这个极限。\n\n1.  **$C^0$ 连续线性锥削，$f_c^{(0)}(r)$**：\n    对于 $0 \\le r  r_c$，我们有 $f_c^{(0)}(r) = 1 - \\frac{r}{r_c}$，其导数为 $f_c^{(0)'}(r) = -\\frac{1}{r_c}$。\n    对于 $r  r_c$，描述符的导数为：\n    $$ \\frac{\\partial G^{(0)}}{\\partial r} = \\phi'(r) \\left(1 - \\frac{r}{r_c}\\right) + \\phi(r) \\left(-\\frac{1}{r_c}\\right) $$\n    我们取 $r \\to r_c^-$ 的极限。由于 $\\phi(r)$ 和 $\\phi'(r)$ 是连续函数，我们可以直接代入 $r=r_c$：\n    $$ \\lim_{r \\to r_c^-} \\frac{\\partial G^{(0)}}{\\partial r} = \\phi'(r_c) \\left(1 - \\frac{r_c}{r_c}\\right) - \\frac{\\phi(r_c)}{r_c} = \\phi'(r_c) \\cdot 0 - \\frac{\\phi(r_c)}{r_c} = -\\frac{\\phi(r_c)}{r_c} $$\n    跳变幅度 $\\Delta_0$ 为：\n    $$ \\Delta_0 = \\left|-\\frac{\\phi(r_c)}{r_c}\\right| = \\frac{\\phi(r_c)}{r_c} = \\frac{\\exp(-\\eta(r_c-R_s)^2)}{r_c} $$\n    导数是不连续的，因为尽管 $\\lim_{r \\to r_c^-} f_c^{(0)}(r) = 0$，但其导数 $\\lim_{r \\to r_c^-} f_c^{(0)'}(r) = -1/r_c$ 是非零的，这在乘法法则展开式的第二项中造成了不连续性。\n\n2.  **$C^1$ 连续余弦锥削，$f_c^{(1)}(r)$**：\n    对于 $0 \\le r \\le r_c$，我们有 $f_c^{(1)}(r) = \\frac{1}{2}\\left[1 + \\cos\\left(\\frac{\\pi r}{r_c}\\right)\\right]$。其导数为 $f_c^{(1)'}(r) = -\\frac{\\pi}{2r_c}\\sin\\left(\\frac{\\pi r}{r_c}\\right)$。\n    对于 $r \\le r_c$，描述符的导数为：\n    $$ \\frac{\\partial G^{(1)}}{\\partial r} = \\phi'(r) \\cdot \\frac{1}{2}\\left[1 + \\cos\\left(\\frac{\\pi r}{r_c}\\right)\\right] - \\phi(r) \\cdot \\frac{\\pi}{2r_c}\\sin\\left(\\frac{\\pi r}{r_c}\\right) $$\n    取 $r \\to r_c^-$ 的极限：\n    $$ \\lim_{r \\to r_c^-} \\frac{\\partial G^{(1)}}{\\partial r} = \\phi'(r_c) \\cdot \\frac{1}{2}\\left[1 + \\cos(\\pi)\\right] - \\phi(r_c) \\cdot \\frac{\\pi}{2r_c}\\sin(\\pi) $$\n    $$ = \\phi'(r_c) \\cdot \\frac{1}{2}\\left[1 - 1\\right] - \\phi(r_c) \\cdot \\frac{\\pi}{2r_c} \\cdot 0 = \\phi'(r_c) \\cdot 0 - \\phi(r_c) \\cdot 0 = 0 $$\n    跳变幅度 $\\Delta_1$ 为：\n    $$ \\Delta_1 = |0 - 0| = 0 $$\n    导数是连续的，这对于一个平滑函数 $\\phi(r)$ 与一个 $C^1$ 连续函数 $f_c^{(1)}(r)$ 的乘积是符合预期的，因为后者及其一阶导数在 $r_c$ 处都为零。\n\n3.  **$C^\\infty$ 平滑紧支集凸点函数，$f_c^{(\\infty)}(r)$**：\n    对于 $0 \\le r  r_c$，$f_c^{(\\infty)}(r) = \\exp\\left(-\\frac{r^2}{r_c^2 - r^2}\\right)$。这个函数被构造成在其定义域上无限可微，并且在 $r=r_c$ 处从左侧逼近时所有阶导数均为零。\n    让我们对一阶导数进行验证。对于 $r  r_c$，$f_c^{(\\infty)'}(r) = f_c^{(\\infty)}(r) \\left( -\\frac{2rr_c^2}{(r_c^2 - r^2)^2} \\right)$。\n    当 $r \\to r_c^-$ 时，这个表达式的极限由指数项主导，该项趋于零的速度比任何多项式项的发散速度都快。因此，$\\lim_{r \\to r_c^-} f_c^{(\\infty)}(r) = 0$ 且 $\\lim_{r \\to r_c^-} f_c^{(\\infty)'}(r) = 0$。\n    对于 $r  r_c$，描述符的导数为：\n    $$ \\frac{\\partial G^{(\\infty)}}{\\partial r} = \\phi'(r) f_c^{(\\infty)}(r) + \\phi(r) f_c^{(\\infty)'}(r) $$\n    取 $r \\to r_c^-$ 的极限：\n    $$ \\lim_{r \\to r_c^-} \\frac{\\partial G^{(\\infty)}}{\\partial r} = \\phi'(r_c) \\cdot \\lim_{r \\to r_c^-} f_c^{(\\infty)}(r) + \\phi(r_c) \\cdot \\lim_{r \\to r_c^-} f_c^{(\\infty)'}(r) $$\n    $$ = \\phi'(r_c) \\cdot 0 + \\phi(r_c) \\cdot 0 = 0 $$\n    跳变幅度 $\\Delta_\\infty$ 为：\n    $$ \\Delta_\\infty = |0 - 0| = 0 $$\n    导数是连续的，这对于涉及 $C^\\infty$ 函数的乘积是符合预期的。\n\n总而言之，跳变幅度的公式为：\n-   $\\Delta_0 = \\frac{1}{r_c} \\exp(-\\eta(r_c-R_s)^2)$\n-   $\\Delta_1 = 0$\n-   $\\Delta_\\infty = 0$\n\n每种截断函数选择的稳定性判据是通过将其跳变幅度与阈值 $T$ 进行比较来确定的。如果 $\\Delta \\le T$，则模拟是稳定的。对于 $C^1$ 和 $C^\\infty$ 截断函数，跳变始终为零，因此对于任何非负阈值 $T$，它们将始终满足稳定性判据。",
            "answer": "[[0.1213061319421832,0.0,0.0,False,True,True],[4.990425127520113e-110,0.0,0.0,True,True,True],[1.0,0.0,0.0,False,True,True],[0.125,0.0,0.0,True,True,True]]"
        }
    ]
}