{
    "hands_on_practices": [
        {
            "introduction": "本次练习是本次探索的基石。我们将使用从第一性原理密度泛函理论（DFT）到经典势函数的多种计算工具，来计算一种特定晶界——镍中的$Σ3$相干孪晶界——的能量。更重要的是，本练习将指导你完成一个关键过程：如何用实验数据验证和协调这些理论预测，并引入强大的统计技术以得出稳健的科学结论。",
            "id": "3455409",
            "problem": "您的任务是开发一个完整、可运行的程序，该程序使用两种密度泛函理论 (DFT) 泛函和两种经典原子间势来估算面心立方镍 (Ni) $\\,\\Sigma 3\\,$ 共格孪晶界的晶界能，量化源于基础能量输入的不确定性，并通过一种基于原则的模型平均程序，将这些计算结果与热刻蚀测量值进行协调。程序必须从基本定义和经过充分检验的物理关系出发，推导出必要的表达式。最终输出必须以毫焦耳/平方米 (mJ/m$^2$) 为单位。\n\n计算场景如下：\n- 晶界能定义为单位面积的界面过剩自由能。在一个包含两个相同晶界的周期性双晶超胞中，界面过剩能由双晶的总能量与等量原子在体相参考态中的能量之差，除以总界面面积和相同界面的数量得到。\n- 在与晶界相交的自由表面上进行的热刻蚀测量，得出一个几何平衡条件，该条件将晶界能与镍的表面能以及沟槽根部的二面角联系起来。角度单位指定为度。\n\n您的程序必须：\n- 推导计算每种方法的晶界能以及从给定能量输入传播不确定性所需的表达式。\n- 推导从热刻蚀数据计算晶界能所需的关系式，并传播其相对于表面能和测量角度的不确定性。\n- 使用一个基于统计学原理的加权平均法来协调所有估算值，该方法既考虑了方法内部的不确定性，也考虑了方法间的潜在离散。\n\n所有输入均以物理上合理、内部一致的值提供。对于每个测试用例，会给出双晶的面积（单位为平方埃）、双晶中的原子数，以及两种密度泛函理论 (DFT) 泛函——Perdew–Burke–Ernzerhof (PBE) 和 Strongly Constrained and Appropriately Normed (SCAN)——以及两种经典势——嵌入原子方法 (EAM) 和修正嵌入原子方法 (MEAM) 的能量数据。每种方法都包括双晶总能量、单个原子的体相能量（用于定义体相参考态）以及这些能量的不确定性。热刻蚀数据集包括镍的表面能及其不确定性、在沟槽交点处测得的二面角（单位为度）及其不确定性（单位为度）。最终晶界能的单位必须是毫焦耳/平方米 (mJ/m$^2$)。\n\n角度单位必须以度处理。您的程序必须仅计算并按指定格式输出所要求的值。\n\n使用以下包含三组参数的测试套件：\n\n- 测试用例 $1$：\n  - 双晶几何：面积 $A = 800$ $\\text{\\AA}^2$，原子数 $N = 480$。\n  - DFT (PBE): $E_{\\text{bulk,atom}} = -4.30$ $\\text{eV}$, $E_{\\text{cell}} = -2060.8064$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.015$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0001$ $\\text{eV}$。\n  - DFT (SCAN): $E_{\\text{bulk,atom}} = -4.45$ $\\text{eV}$, $E_{\\text{cell}} = -2132.5072$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.020$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0001$ $\\text{eV}$。\n  - EAM: $E_{\\text{bulk,atom}} = -4.44$ $\\text{eV}$, $E_{\\text{cell}} = -2128.4080$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.050$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0010$ $\\text{eV}$。\n  - MEAM: $E_{\\text{bulk,atom}} = -4.42$ $\\text{eV}$, $E_{\\text{cell}} = -2118.3072$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.050$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0010$ $\\text{eV}$。\n  - 热刻蚀: $\\,\\gamma_s = 1800$ $\\text{mJ/m}^2$, $\\sigma_{\\gamma_s} = 50$ $\\text{mJ/m}^2$, $\\alpha = 178.9$ 度, $\\sigma_{\\alpha} = 0.1$ 度。\n\n- 测试用例 $2$：\n  - 双晶几何：面积 $A = 600$ $\\text{\\AA}^2$，原子数 $N = 360$。\n  - DFT (PBE): $E_{\\text{bulk,atom}} = -4.30$ $\\text{eV}$, $E_{\\text{cell}} = -1546.6524$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.015$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0001$ $\\text{eV}$。\n  - DFT (SCAN): $E_{\\text{bulk,atom}} = -4.45$ $\\text{eV}$, $E_{\\text{cell}} = -1600.5024$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.020$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0001$ $\\text{eV}$。\n  - EAM: $E_{\\text{bulk,atom}} = -4.44$ $\\text{eV}$, $E_{\\text{cell}} = -1597.2768$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.050$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0010$ $\\text{eV}$。\n  - MEAM: $E_{\\text{bulk,atom}} = -4.42$ $\\text{eV}$, $E_{\\text{cell}} = -1589.5524$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.050$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0010$ $\\text{eV}$。\n  - 热刻蚀: $\\,\\gamma_s = 1800$ $\\text{mJ/m}^2$, $\\sigma_{\\gamma_s} = 50$ $\\text{mJ/m}^2$, $\\alpha = 179.5$ 度, $\\sigma_{\\alpha} = 0.2$ 度。\n\n- 测试用例 $3$：\n  - 双晶几何：面积 $A = 900$ $\\text{\\AA}^2$，原子数 $N = 520$。\n  - DFT (PBE): $E_{\\text{bulk,atom}} = -4.30$ $\\text{eV}$, $E_{\\text{cell}} = -2232.2956$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.015$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0001$ $\\text{eV}$。\n  - DFT (SCAN): $E_{\\text{bulk,atom}} = -4.45$ $\\text{eV}$, $E_{\\text{cell}} = -2309.9570$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.020$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0001$ $\\text{eV}$。\n  - EAM: $E_{\\text{bulk,atom}} = -4.44$ $\\text{eV}$, $E_{\\text{cell}} = -2305.5438$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.050$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0010$ $\\text{eV}$。\n  - MEAM: $E_{\\text{bulk,atom}} = -4.42$ $\\text{eV}$, $E_{\\text{cell}} = -2294.9188$ $\\text{eV}$, $\\sigma_{E_{\\text{cell}}} = 0.050$ $\\text{eV}$, $\\sigma_{E_{\\text{bulk}}} = 0.0010$ $\\text{eV}$。\n  - 热刻蚀: $\\,\\gamma_s = 1800$ $\\text{mJ/m}^2$, $\\sigma_{\\gamma_s} = 50$ $\\text{mJ/m}^2$, $\\alpha = 178.0$ 度, $\\sigma_{\\alpha} = 0.1$ 度。\n\n您的程序必须为每个测试用例实现以下计算步骤：\n- 根据双晶总能量和体相参考态，计算每种方法的晶界能，并确认双晶胞包含两个相同的晶界。\n- 将所提供能量不确定性传播到每种方法的晶界能不确定性上。\n- 根据热刻蚀数据计算晶界能，并传播其相对于表面能和角度的不确定性（角度必须以度处理）。\n- 对所有五个估算值（两种 DFT 泛函、两种经典势和热刻蚀）进行随机效应模型平均，以得出一个协调后的平均值和不确定性，该结果同时考虑了方法内方差和方法间离散。\n- 将所有晶界能和不确定性以 mJ/m$^2$ 表示。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例对应一个子列表，包含三个浮点数（单位为 mJ/m$^2$），顺序为 $[$合并平均值$, $合并标准差$, $热刻蚀能量$]$。\n- 所有角度均使用度为单位。\n- 将最终输出中的每个浮点数四舍五入到一位小数。\n- 包含三个测试用例的所需输出格式示例：$[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$，其中所有 $x_i$、$y_i$、$z_i$ 均为浮点数，单位是 mJ/m$^2$。\n\n所有计算都必须在不读取外部文件、没有任何用户输入的情况下执行。程序必须是确定性的和自包含的。",
            "solution": "该问题要求使用多种理论和实验方法，计算镍 (Ni) 中 $\\Sigma 3$ 共格孪晶界的晶界能，然后使用基于统计学原理的模型来协调这些估算值。解决方案分为四个部分：从原子模拟推导晶界能，从热刻蚀实验推导晶界能，用于数据协调的统计模型，以及必要的单位转换。\n\n将使用以下物理常数和转换因子：\n- 基本电荷, $e = 1.602176634 \\times 10^{-19}$ C。\n- $1$ eV $= 1.602176634 \\times 10^{-19}$ J。\n- $1$ Angstrom ($\\text{\\AA}$) = $10^{-10}$ m。\n\n### 1. 基于原子模拟的晶界能\n\n晶界能 $\\gamma_{gb}$ 定义为界面单位面积的过剩自由能。对于一个横截面积为 $A$、包含 $N$ 个原子和两个相同晶界的周期性双晶超胞，$\\gamma_{gb}$ 的计算方法是：从超胞的总能量 ($E_{\\text{cell}}$) 中减去等量原子在完美体相晶体中的能量 ($N E_{\\text{bulk,atom}}$)，然后除以两个界面的总面积 ($2A$)。\n\n$$ \\gamma_{gb} = \\frac{E_{\\text{cell}} - N E_{\\text{bulk,atom}}}{2A} $$\n\n此处，$E_{\\text{bulk,atom}}$ 是体相参考态中每个原子的能量。\n\n$\\gamma_{gb}$ 的不确定性是通过传播输入能量的不确定性 $\\sigma_{E_{\\text{cell}}}$ 和 $\\sigma_{E_{\\text{bulk,atom}}}$ 来确定的。假设这些不确定性是独立的，$\\gamma_{gb}$ 的方差由标准误差传播公式给出：\n\n$$ \\sigma_{\\gamma_{gb}}^2 = \\left(\\frac{\\partial \\gamma_{gb}}{\\partial E_{\\text{cell}}}\\right)^2 \\sigma_{E_{\\text{cell}}}^2 + \\left(\\frac{\\partial \\gamma_{gb}}{\\partial E_{\\text{bulk,atom}}}\\right)^2 \\sigma_{E_{\\text{bulk,atom}}}^2 $$\n\n偏导数是：\n$$ \\frac{\\partial \\gamma_{gb}}{\\partial E_{\\text{cell}}} = \\frac{1}{2A} $$\n$$ \\frac{\\partial \\gamma_{gb}}{\\partial (N E_{\\text{bulk,atom}})} = -\\frac{1}{2A} \\implies \\frac{\\partial \\gamma_{gb}}{\\partial E_{\\text{bulk,atom}}} = -\\frac{N}{2A} $$\n\n将这些代入方差方程：\n$$ \\sigma_{\\gamma_{gb}}^2 = \\left(\\frac{1}{2A}\\right)^2 \\sigma_{E_{\\text{cell}}}^2 + \\left(-\\frac{N}{2A}\\right)^2 \\sigma_{E_{\\text{bulk,atom}}}^2 $$\n$$ \\sigma_{\\gamma_{gb}}^2 = \\frac{\\sigma_{E_{\\text{cell}}}^2 + N^2 \\sigma_{E_{\\text{bulk,atom}}}^2}{4A^2} $$\n\n标准差是方差的平方根：\n$$ \\sigma_{\\gamma_{gb}} = \\frac{\\sqrt{\\sigma_{E_{\\text{cell}}}^2 + N^2 \\sigma_{E_{\\text{bulk,atom}}}^2}}{2A} $$\n\n这些公式应用于来自两种密度泛函理论 (DFT) 泛函 (PBE, SCAN) 和两种经典原子间势 (EAM, MEAM) 的数据。\n\n### 2. 基于热刻蚀的晶界能\n\n热刻蚀方法将晶界能 $\\gamma_{gb}$ 与表面能 $\\gamma_s$ 以及晶界与自由表面相交处沟槽根部的平衡二面角 $\\alpha$ 联系起来。该关系源于三相线处界面张力的平衡，对于对称晶界，这被称为 Young-Dupré 方程：\n\n$$ \\gamma_{gb} = 2 \\gamma_s \\cos\\left(\\frac{\\alpha}{2}\\right) $$\n\n角度 $\\alpha$ 以度为单位给出，在使用三角函数时必须转换为弧度。\n\n通过该方法计算出的 $\\gamma_{gb}$ 的不确定性，是通过传播 $\\gamma_s$ 和 $\\alpha$ 的不确定性（分别为 $\\sigma_{\\gamma_s}$ 和 $\\sigma_{\\alpha}$）得到的。假设它们是独立的，方差 $\\sigma_{\\gamma_{gb}}^2$ 为：\n\n$$ \\sigma_{\\gamma_{gb}}^2 = \\left(\\frac{\\partial \\gamma_{gb}}{\\partial \\gamma_s}\\right)^2 \\sigma_{\\gamma_s}^2 + \\left(\\frac{\\partial \\gamma_{gb}}{\\partial \\alpha}\\right)^2 \\sigma_{\\alpha}^2 $$\n\n偏导数是：\n$$ \\frac{\\partial \\gamma_{gb}}{\\partial \\gamma_s} = 2 \\cos\\left(\\frac{\\alpha}{2}\\right) $$\n$$ \\frac{\\partial \\gamma_{gb}}{\\partial \\alpha} = 2 \\gamma_s \\left(-\\sin\\left(\\frac{\\alpha}{2}\\right) \\cdot \\frac{1}{2}\\right) = -\\gamma_s \\sin\\left(\\frac{\\alpha}{2}\\right) $$\n\n对于关于 $\\alpha$ 的导数，角度及其不确定性必须以弧度为单位。设 $\\alpha_{rad}$ 和 $\\sigma_{\\alpha,rad}$ 分别为以弧度表示的角度及其不确定性。转换公式为 $\\sigma_{\\alpha,rad} = \\sigma_{\\alpha,deg} \\cdot \\frac{\\pi}{180}$。因此，方差为：\n\n$$ \\sigma_{\\gamma_{gb}}^2 = \\left[2 \\cos\\left(\\frac{\\alpha_{rad}}{2}\\right)\\right]^2 \\sigma_{\\gamma_s}^2 + \\left[-\\gamma_s \\sin\\left(\\frac{\\alpha_{rad}}{2}\\right)\\right]^2 \\sigma_{\\alpha,rad}^2 $$\n\n### 3. 通过随机效应模型进行统计协调\n\n我们有 $k=5$ 个 $\\gamma_{gb}$ 的估算值，记为 $y_i$，每个值都有一个对应的方差 $v_i = \\sigma_i^2$，其中 $i=1, \\dots, k$。这些估算值源自不同的物理模型和一项实验，因此除了每个估算值内部的统计不确定性外，预计它们之间还会存在系统性差异（异质性）。随机效应荟萃分析模型适合用于合并这些结果。该模型假设每项研究估算出一个略有不同的真实值 $\\mu_i$，其中 $\\mu_i$ 从一个均值为 $\\mu$、方差为 $\\tau^2$ 的共同分布中抽取。参数 $\\tau^2$ 代表方法间方差（或离散）。\n\n步骤如下：\n1.  **估算方法间方差 ($\\tau^2$)**: 使用 DerSimonian-Laird 方法。首先，我们计算 Cochran's $Q$ 统计量，它衡量总的加权变异：\n    $$ Q = \\sum_{i=1}^{k} w_i^{FE}(y_i - \\hat{\\mu}_{FE})^2 $$\n    其中 $w_i^{FE} = 1/v_i$ 是固定效应权重，$\\hat{\\mu}_{FE} = \\frac{\\sum w_i^{FE}y_i}{\\sum w_i^{FE}}$ 是固定效应均值。\n    $\\tau^2$ 的估算量为：\n    $$ \\hat{\\tau}^2 = \\max\\left(0, \\frac{Q - (k-1)}{C}\\right) \\quad \\text{其中} \\quad C = \\sum w_i^{FE} - \\frac{\\sum (w_i^{FE})^2}{\\sum w_i^{FE}} $$\n\n2.  **计算合并均值和不确定性**: 计算新的权重（随机效应权重），这些权重同时包含了方法内方差 ($v_i$) 和方法间方差 ($\\hat{\\tau}^2$)：\n    $$ w_i^{RE} = \\frac{1}{v_i + \\hat{\\tau}^2} $$\n    合并均值（随机效应均值）是使用这些新权重的加权平均值：\n    $$ \\hat{\\mu}_{RE} = \\frac{\\sum_{i=1}^{k} w_i^{RE} y_i}{\\sum_{i=1}^{k} w_i^{RE}} $$\n    此合并均值的方差为：\n    $$ v_{\\hat{\\mu}_{RE}} = \\frac{1}{\\sum_{i=1}^{k} w_i^{RE}} $$\n    合并标准差为 $\\sigma_{\\hat{\\mu}_{RE}} = \\sqrt{v_{\\hat{\\mu}_{RE}}}$。值 $\\hat{\\mu}_{RE}$ 和 $\\sigma_{\\hat{\\mu}_{RE}}$ 是最终协调后的估算值及其不确定性。\n\n### 4. 单位转换\n\n原子模拟计算得出的 $\\gamma_{gb}$ 单位是 eV/$\\text{\\AA}^2$。最终结果必须以毫焦耳/平方米 (mJ/m$^2$) 为单位。转换因子的推导如下：\n$$ 1 \\frac{\\text{eV}}{\\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19} \\text{ J}}{(10^{-10} \\text{ m})^2} = \\frac{1.602176634 \\times 10^{-19} \\text{ J}}{10^{-20} \\text{ m}^2} = 16.02176634 \\frac{\\text{J}}{\\text{m}^2} $$\n要将 J/m$^2$ 转换为 mJ/m$^2$，我们乘以 $1000$：\n$$ 1 \\frac{\\text{eV}}{\\text{\\AA}^2} = 16021.76634 \\frac{\\text{mJ}}{\\text{m}^2} $$\n此转换因子应用于从原子模拟中获得的晶界能值及其标准差。热刻蚀计算使用单位为 mJ/m$^2$ 的 $\\gamma_s$，因此其结果已经是正确的最终单位。在传递给随机效应模型之前，所有五个估算值的单位都是 mJ/m$^2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grain boundary energy problem for all test cases.\n    \"\"\"\n    \n    # Fundamental constants and conversion factors\n    EV_PER_A2_TO_MJ_PER_M2 = 16021.76634\n\n    # Test cases as provided in the problem description\n    test_cases = [\n        # Test case 1\n        {\n            \"geometry\": {\"A\": 800.0, \"N\": 480},\n            \"methods\": {\n                \"PBE\": {\"E_bulk_atom\": -4.30, \"E_cell\": -2060.8064, \"sigma_E_cell\": 0.015, \"sigma_E_bulk\": 0.0001},\n                \"SCAN\": {\"E_bulk_atom\": -4.45, \"E_cell\": -2132.5072, \"sigma_E_cell\": 0.020, \"sigma_E_bulk\": 0.0001},\n                \"EAM\": {\"E_bulk_atom\": -4.44, \"E_cell\": -2128.4080, \"sigma_E_cell\": 0.050, \"sigma_E_bulk\": 0.0010},\n                \"MEAM\": {\"E_bulk_atom\": -4.42, \"E_cell\": -2118.3072, \"sigma_E_cell\": 0.050, \"sigma_E_bulk\": 0.0010},\n            },\n            \"grooving\": {\"gamma_s\": 1800.0, \"sigma_gamma_s\": 50.0, \"alpha_deg\": 178.9, \"sigma_alpha_deg\": 0.1},\n        },\n        # Test case 2\n        {\n            \"geometry\": {\"A\": 600.0, \"N\": 360},\n            \"methods\": {\n                \"PBE\": {\"E_bulk_atom\": -4.30, \"E_cell\": -1546.6524, \"sigma_E_cell\": 0.015, \"sigma_E_bulk\": 0.0001},\n                \"SCAN\": {\"E_bulk_atom\": -4.45, \"E_cell\": -1600.5024, \"sigma_E_cell\": 0.020, \"sigma_E_bulk\": 0.0001},\n                \"EAM\": {\"E_bulk_atom\": -4.44, \"E_cell\": -1597.2768, \"sigma_E_cell\": 0.050, \"sigma_E_bulk\": 0.0010},\n                \"MEAM\": {\"E_bulk_atom\": -4.42, \"E_cell\": -1589.5524, \"sigma_E_cell\": 0.050, \"sigma_E_bulk\": 0.0010},\n            },\n            \"grooving\": {\"gamma_s\": 1800.0, \"sigma_gamma_s\": 50.0, \"alpha_deg\": 179.5, \"sigma_alpha_deg\": 0.2},\n        },\n        # Test case 3\n        {\n            \"geometry\": {\"A\": 900.0, \"N\": 520},\n            \"methods\": {\n                \"PBE\": {\"E_bulk_atom\": -4.30, \"E_cell\": -2232.2956, \"sigma_E_cell\": 0.015, \"sigma_E_bulk\": 0.0001},\n                \"SCAN\": {\"E_bulk_atom\": -4.45, \"E_cell\": -2309.9570, \"sigma_E_cell\": 0.020, \"sigma_E_bulk\": 0.0001},\n                \"EAM\": {\"E_bulk_atom\": -4.44, \"E_cell\": -2305.5438, \"sigma_E_cell\": 0.050, \"sigma_E_bulk\": 0.0010},\n                \"MEAM\": {\"E_bulk_atom\": -4.42, \"E_cell\": -2294.9188, \"sigma_E_cell\": 0.050, \"sigma_E_bulk\": 0.0010},\n            },\n            \"grooving\": {\"gamma_s\": 1800.0, \"sigma_gamma_s\": 50.0, \"alpha_deg\": 178.0, \"sigma_alpha_deg\": 0.1},\n        },\n    ]\n    \n    all_results = []\n\n    for case in test_cases:\n        estimates = []\n        uncertainties = []\n\n        # Part 1: Atomistic calculations\n        A = case[\"geometry\"][\"A\"]\n        N = case[\"geometry\"][\"N\"]\n        \n        for method_name, params in case[\"methods\"].items():\n            E_cell = params[\"E_cell\"]\n            E_bulk_atom = params[\"E_bulk_atom\"]\n            sigma_E_cell = params[\"sigma_E_cell\"]\n            sigma_E_bulk = params[\"sigma_E_bulk\"]\n\n            # Calculate gamma_gb in eV/A^2\n            gamma_gb_raw = (E_cell - N * E_bulk_atom) / (2 * A)\n            \n            # Propagate uncertainty for gamma_gb in eV/A^2\n            sigma_gamma_gb_raw = np.sqrt(sigma_E_cell**2 + (N * sigma_E_bulk)**2) / (2 * A)\n            \n            # Convert to mJ/m^2\n            estimates.append(gamma_gb_raw * EV_PER_A2_TO_MJ_PER_M2)\n            uncertainties.append(sigma_gamma_gb_raw * EV_PER_A2_TO_MJ_PER_M2)\n\n        # Part 2: Thermal grooving calculation\n        g = case[\"grooving\"]\n        gamma_s, sigma_gamma_s = g[\"gamma_s\"], g[\"sigma_gamma_s\"]\n        alpha_deg, sigma_alpha_deg = g[\"alpha_deg\"], g[\"sigma_alpha_deg\"]\n        \n        alpha_rad = np.deg2rad(alpha_deg)\n        sigma_alpha_rad = np.deg2rad(sigma_alpha_deg)\n        \n        # Calculate gamma_gb\n        gamma_gb_tg = 2 * gamma_s * np.cos(alpha_rad / 2)\n        \n        # Propagate uncertainty\n        d_gamma_s = 2 * np.cos(alpha_rad / 2)\n        d_alpha = -gamma_s * np.sin(alpha_rad / 2)\n        sigma_gamma_gb_tg = np.sqrt((d_gamma_s * sigma_gamma_s)**2 + (d_alpha * sigma_alpha_rad)**2)\n        \n        estimates.append(gamma_gb_tg)\n        uncertainties.append(sigma_gamma_gb_tg)\n        \n        # Part 3: Random-effects model averaging\n        y = np.array(estimates)\n        sigma = np.array(uncertainties)\n        v = sigma**2\n        k = len(y)\n        \n        # Fixed-effect calculations\n        w_fe = 1 / v\n        mu_fe = np.sum(w_fe * y) / np.sum(w_fe)\n        \n        # Cochran's Q and tau^2\n        q_stat = np.sum(w_fe * (y - mu_fe)**2)\n        \n        c_denom = np.sum(w_fe)\n        c_val = c_denom - (np.sum(w_fe**2) / c_denom)\n\n        if c_val > 0:\n            tau2 = max(0, (q_stat - (k - 1)) / c_val)\n        else:\n            tau2 = 0\n\n        # Random-effects calculations\n        w_re = 1 / (v + tau2)\n        mu_re = np.sum(w_re * y) / np.sum(w_re)\n        v_mu_re = 1 / np.sum(w_re)\n        sigma_mu_re = np.sqrt(v_mu_re)\n        \n        all_results.append([mu_re, sigma_mu_re, gamma_gb_tg])\n\n    # Final print statement in the exact required format.\n    output_str = \",\".join(f\"[{v[0]:.1f},{v[1]:.1f},{v[2]:.1f}]\" for v in all_results)\n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在我们初步计算的基础上，现在我们来处理模拟中一个至关重要的系统误差：有限尺寸效应。本次练习将深入探讨模拟单元中晶界与其周期性镜像之间人为相互作用的弹性起源。你将学习如何应用标准的理论校正，将你的结果外推到无限大系统尺寸的极限（$L \\to \\infty$），这是获得具有物理意义的晶界能的关键一步。",
            "id": "3455328",
            "problem": "考虑一个双晶体，其包含两个相同的平面晶界，并在周期性边界条件（PBC）下进行模拟。垂直于晶界平面的双晶体长度用 $L$ 表示。在计算材料科学中，计算得到的单位面积晶界能（记为 $\\gamma(L)$）中的有限尺寸效应，源于两个晶界与其周期性镜像之间的弹性相互作用。目标是计算几个不同 $L$ 值下的 $\\gamma(L)$，并外推至无限尺寸极限 $L \\to \\infty$，以获得 $\\gamma(\\infty)$。\n\n使用连续、各向同性、线性弹性的表示方法来描述晶界。将晶界建模为一个平面弹性偶极子层，其单位面积的有效偶极子密度为 $p$。在平面应变极限下对双晶体板进行分析，并设材料的杨氏模量为 $E$，泊松比为 $\\nu$。从各向同性线弹性理论的基础出发：胡克定律 $\\sigma_{ij} = \\lambda \\delta_{ij} \\epsilon_{kk} + 2 \\mu \\epsilon_{ij}$，其中 $\\lambda$ 和 $\\mu$ 为拉梅参数，以及应变能密度 $u = \\tfrac{1}{2} \\sigma_{ij} \\epsilon_{ij}$（此处默认为爱因斯坦求和约定）。在平面应变条件下，通过 $E^\\star = \\dfrac{E}{1-\\nu^2}$ 定义有效模量 $E^\\star$。基于弹性格林函数框架，推导在周期性边界条件下，各向同性介质中两个相距为 $L$ 的相同平面偶极子层相互作用的弹性镜像相互作用修正项 $\\Delta \\gamma(L)$，对于大的 $L$ 值，其对单位面積晶界能的领头阶渐近依赖关系。将此修正项与内在（核心）贡献 $\\gamma_{\\mathrm{core}}$ 相结合，形成 $\\gamma(L) = \\gamma_{\\mathrm{core}} + \\Delta \\gamma(L)$，单位为焦耳/平方米。\n\n实现所推导的领头阶修正，并为指定的测试用例计算 $\\gamma(L)$，然后根据你推导的领头阶定律所蕴含的适当预测变量，对 $\\gamma(L)$ 进行基于回归的外推，以估计在无限长度极限下的截距，即 $\\gamma(\\infty)$。清晰说明并使用一致的物理单位。将 $L$ 的单位纳米转换为米，将 $E$ 的单位吉帕斯卡转换为帕斯卡，$p$ 的单位为牛顿/米，能量以焦耳/平方米报告。本问题不使用角度。最终答案以焦耳/平方米表示，四舍五入到六位小数。\n\n使用以下包含三种物理上合理的场景的测试套件，这些场景旨在探测一般情况、边缘情况和敏感性情况。对于每个案例，计算所有列出的 $L$ 值对应的 $\\gamma(L)$，并执行外推以获得单一的 $\\gamma(\\infty)$ 值：\n\n- 案例1：$E = 200$ 吉帕斯卡，$\\nu = 0.30$，$p = 50$ 牛顿/米，$\\gamma_{\\mathrm{core}} = 0.7$ 焦耳/平方米，$L \\in \\{10, 15, 30, 60\\}$ 纳米。\n- 案例2：$E = 70$ 吉帕斯卡，$\\nu = 0.33$，$p = 40$ 牛顿/米，$\\gamma_{\\mathrm{core}} = 0.5$ 焦耳/平方米，$L \\in \\{5, 10, 20\\}$ 纳米。\n- 案例3：$E = 120$ 吉帕斯卡，$\\nu = 0.25$，$p = 0$ 牛顿/米，$\\gamma_{\\mathrm{core}} = 0.4$ 焦耳/平方米，$L \\in \\{10, 20, 40\\}$ 纳米。\n\n你的程序应产生单行输出，其中包含三个外推得到的 $\\gamma(\\infty)$ 值，格式为方括号内以逗号分隔的列表，每个值四舍五入到六位小数（例如，$[\\gamma_\\infty^{(1)},\\gamma_\\infty^{(2)},\\gamma_\\infty^{(3)}]$）。不應打印任何其他文本。",
            "solution": "该问题要求推导并应用一个模型，用于描述计算模拟中晶界能的有限尺寸效应，然后通过基于回归的外推法确定无限系统极限下的能量 $\\gamma(\\infty)$。\n\n### 步骤1：理论推导\n\n该问题在连续各向同性线弹性理论的框架内进行处理。晶界被建模为一个平面弹性偶极子层。在一个沿垂直于晶界平面方向（称其为 $z$ 方向）采用周期性边界条件（PBC）的模拟中，长度为 $L$ 的双晶体包含两个晶界。模拟晶胞的有限尺寸 $L$ 导致了晶界与其周期性镜像之间的人为弹性相互作用。这种相互作用能 $\\Delta \\gamma_{el}(L)$ 对计算得到的单位面积总晶界能 $\\gamma(L)$ 有贡献。\n\n总能量表示为与系统尺寸无关的內禀核心能 $\\gamma_{\\mathrm{core}}$ 与依赖于尺寸的弹性相互作用能之和：\n$$ \\gamma(L) = \\gamma_{\\mathrm{core}} + \\Delta \\gamma_{el}(L) $$\n我们的目标是推导当 $L$ 较大时 $\\Delta \\gamma_{el}(L)$ 的领头阶函数形式。\n\n弹性相互作用能源于一个晶界的应力场对另一个晶界的应变场做的功。在周期性系统中，这涉及对所有周期性镜像的相互作用求和。对于较大的 $L$，主要贡献来自最近的镜像晶界，其距离为 $L$。因此，问题可以简化为求解两个相距为 $L$ 的相同平行偶极子层之间的相互作用能。\n\n推导从弹性格林函数开始，它给出了弹性介质中点力引起的位移场。通过对格林函数及其导数进行积分，可以从任意力密度分布中求出应力场和应变场。晶界是一个晶格严重畸变的区域，可以用力偶极子的分布来表示。问题指定了一个平面偶极子层，其有效偶极子密度（单位面积的力矩）大小为 $p$。\n\n两个此类层之间的单位面积相互作用能 $\\Delta\\gamma_{el}(L)$，是通过计算将第二个层引入第一个层的应力场中所做的功来求得的。这涉及到在体积上对第一个晶界的应力张量与第二个晶界的应变张量的乘积进行积分。使用傅里葉空间方法，这种方法特别适用于周期性系统，可以计算出这种相互作用能。\n\n对于各向同性材料中平面应变条件的特定情况，大间距 $L$ 的领头阶结果是：\n$$ \\Delta \\gamma_{el}(L) = \\frac{p^2}{2 \\pi E^\\star L} $$\n这里，$p$ 是有效偶极子密度，$E^\\star$ 是平面应变弹性模量，定义为：\n$$ E^\\star = \\frac{E}{1 - \\nu^2} $$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。这种 $1/L$ 的依赖关系是在周期性边界条件下，晶界和位错等缺陷弹性相互作用的一个公认结果。\n\n### 步骤2：外推过程\n\n结合推导出的各项，总晶界能作为系统尺寸 $L$ 的函数为：\n$$ \\gamma(L) = \\gamma_{\\mathrm{core}} + \\frac{p^2}{2 \\pi E^\\star L} $$\n目标是估计 $\\gamma(\\infty)$。从方程中可以明显看出，当 $L \\to \\infty$ 时，相互作用项消失，$\\gamma(L) \\to \\gamma_{\\mathrm{core}}$。因此，$\\gamma(\\infty) = \\gamma_{\\mathrm{core}}$。\n\n然而，问题指示我们执行基于回归的外推。这模拟了一个真实世界的场景，即拥有一组计算出的数据点 $\\gamma(L_i)$，并试图找到无限尺寸的极限。该模型方程显示了 $\\gamma(L)$ 与预测变量 $x = 1/L$ 之间的线性关系：\n$$ \\gamma(L) = \\gamma(\\infty) + C \\cdot \\frac{1}{L} $$\n其中常数 $C = p^2 / (2 \\pi E^\\star)$ 是斜率，$\\gamma(\\infty)$ 是截距。\n\n因此，指定的过程如下：\n1.  对于每个测试用例和每个给定的长度 $L_i$，使用上面推导的公式和提供的 $\\gamma_{\\mathrm{core}}$ 来计算“模拟”的晶界能 $\\gamma(L_i)$。\n2.  创建一组数据对 $(x_i, y_i)$，其中 $x_i = 1/L_i$，$y_i = \\gamma(L_i)$。\n3.  对这些数据点进行线性回归，以拟合模型 $y = mx + b$。\n4.  确定的截距 $b$ 是 $\\gamma(\\infty)$ 的外推估计值。\n\n鉴于数据点是由一个完美的线性模型生成的，线性回归将产生一个截距，在数值精度范围内，该截距与用于生成数据的 $\\gamma_{\\mathrm{core}}$ 值相同。对于 $p=0$ 的特殊情况，相互作用项为零，对于所有的 $L$，$\\gamma(L)$ 都是常数，回归将轻易地返回这个常数值作为截距。\n\n### 步骤3：计算实现\n\n每个测试用例的算法如下：\n1.  分配输入参数：$E$, $\\nu$, $p$, $\\gamma_{\\mathrm{core}}$ 以及长度列表 $\\{L_i\\}$。\n2.  将单位转换为一致的国际单位制（SI）基本单位：$E$ 从 GPa 转换为 Pa（$1 \\text{ GPa} = 10^9 \\text{ Pa}$），$L$ 从 nm 转换为 m（$1 \\text{ nm} = 10^{-9} \\text{ m}$）。\n3.  计算平面应变模量：$E^\\star = E / (1 - \\nu^2)$。\n4.  计算斜率系数：$C = p^2 / (2 \\pi E^\\star)$。\n5.  生成预测变量 $x_i = 1/L_i$ 和响应变量 $y_i = \\gamma_{\\mathrm{core}} + C / L_i$。\n6.  使用数值线性回归工具（例如 `numpy.polyfit`）找到穿过数据点 $(x_i, y_i)$ 的最佳拟合线的截距。\n7.  所得截距即为该案例的 $\\gamma(\\infty)$ 值。每个案例的最终结果按要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Note: scipy is listed as available but numpy.polyfit is sufficient for this task.\n# from scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the grain boundary energy extrapolation problem for the given test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing all necessary parameters.\n    test_cases = [\n        {\n            \"E_GPa\": 200, \"nu\": 0.30, \"p_Nm\": 50, \"gamma_core_Jm2\": 0.7,\n            \"L_nm\": [10, 15, 30, 60]\n        },\n        {\n            \"E_GPa\": 70, \"nu\": 0.33, \"p_Nm\": 40, \"gamma_core_Jm2\": 0.5,\n            \"L_nm\": [5, 10, 20]\n        },\n        {\n            \"E_GPa\": 120, \"nu\": 0.25, \"p_Nm\": 0, \"gamma_core_Jm2\": 0.4,\n            \"L_nm\": [10, 20, 40]\n        },\n    ]\n\n    extrapolated_gammas = []\n\n    for case in test_cases:\n        # Step 1: Extract parameters and convert to base SI units.\n        E = case[\"E_GPa\"] * 1e9  # GPa to Pa\n        nu = case[\"nu\"]\n        p = case[\"p_Nm\"]  # Already in N/m\n        gamma_core = case[\"gamma_core_Jm2\"]  # Already in J/m^2\n        L_values = np.array(case[\"L_nm\"]) * 1e-9  # nm to m\n\n        # Step 2: Calculate the plane-strain modulus E*\n        # E_star = E / (1 - nu^2)\n        E_star = E / (1 - nu**2)\n\n        # Step 3: Calculate the coefficient C for the 1/L term.\n        # This coefficient is the slope of the gamma vs. 1/L line.\n        # C = p^2 / (2 * pi * E_star)\n        # Handle the p=0 case to avoid division by zero if E_star were zero.\n        if E_star == 0:\n            C = 0.0\n        else:\n            C = p**2 / (2 * np.pi * E_star)\n\n        # Step 4: Generate the \"simulated\" data points (x, y) for regression.\n        # x is the predictor variable, 1/L.\n        # y is the response variable, gamma(L).\n        x_data = 1 / L_values\n        y_data = gamma_core + C / L_values\n\n        # Step 5: Perform a linear regression (polynomial fit of degree 1).\n        # np.polyfit returns coefficients [slope, intercept].\n        # We need the intercept, which corresponds to gamma(infinity).\n        # Since the data is generated from a perfect line, the regression will\n        # perfectly recover the intercept, which is gamma_core.\n        # The procedure is followed as per the problem statement.\n        if len(x_data) < 2:\n            # A regression is not possible with fewer than 2 points.\n            # In this problem, all cases have at least 3 points.\n            # If a single point (L) were given, the only \"estimate\" would be gamma(L) itself.\n            # For a single point, intercept is just the y-value if slope is assumed 0.\n            # Here, we can just use the y-value.\n            gamma_infinity = y_data[0]\n        else:\n            slope, intercept = np.polyfit(x_data, y_data, 1)\n            gamma_infinity = intercept\n        \n        # Step 6: Store the result, rounded to six decimal places.\n        extrapolated_gammas.append(round(gamma_infinity, 6))\n\n    # Final print statement in the exact required format.\n    # The format is a list of comma-separated values in square brackets.\n    # The map(str, ...) converts each float to a string.\n    # The round() has already taken care of the precision. We need to ensure\n    # that trailing zeros are printed correctly for a fixed format.\n    formatted_results = [f\"{val:.6f}\" for val in extrapolated_gammas]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们的最终练习旨在弥合原子尺度不确定性与宏观性能预测之间的鸿沟。我们将采用贝叶斯框架，探索DFT计算中的收敛误差如何转化为晶界能本身的不确定性。随后，你将通过一个晶粒长大的物理模型来传播这种不确定性，从而预测晶界迁移速率的可能分布，这突显了在原子尺度上量化不确定性对于可靠的材料建模是何等重要。",
            "id": "3455319",
            "problem": "给定一项计算材料科学任务，您需要将密度泛函理论(DFT)收敛参数的不确定性传播到晶界能的后验分布上，然后量化这种不确定性如何影响介观尺度模型中预测的晶界迁移速度分布。目标是从第一性原理出发推导并实现计算，并为指定的测试套件生成数值结果。\n\n考虑一个晶界，其单位面积能量表示为 $ \\gamma $ (单位为 $\\mathrm{J/m^2}$)。在DFT计算中，有限的$k$点取样和有限的平面波截断能会引入系统性收敛误差。晶界能在$k$点分辨率 $ m_i $ (使用的$k$点总数) 和平面波截断能 $ c_i $ (单位为 $\\mathrm{eV}$) 下的DFT观测值 $ y_i $ 可由以下模型表示\n$$\ny_i = \\gamma + \\beta_k \\, m_i^{-p_k} + \\beta_c \\, c_i^{-p_c} + \\varepsilon_i,\n$$\n其中 $ \\beta_k $ 和 $ \\beta_c $ 是未知的偏差系数，$ p_k $ 和 $ p_c $ 是已知的反映收敛速率的正指数，$ \\varepsilon_i $ 是独立的观测误差，建模为均值为零、方差为 $ \\sigma^2 $ 的高斯随机变量。\n\n对参数矢量 $ \\theta = (\\gamma, \\beta_k, \\beta_c)^\\top $ 采用高斯先验，给定为 $ \\theta \\sim \\mathcal{N}(\\mu_0, \\Sigma_0) $，其中 $ \\mu_0 \\in \\mathbb{R}^3 $ 且 $ \\Sigma_0 \\in \\mathbb{R}^{3 \\times 3} $ 是对称正定矩阵。\n\n在介观尺度曲率驱动的晶界迁移中，法向速度 $ v $ (单位为 $ \\mathrm{m/s} $) 遵循Mullins关系式\n$$\nv = M \\, \\gamma \\, \\kappa,\n$$\n其中 $ M $ 是晶界迁移率 (单位为 $ \\mathrm{m^4/(J\\,s)} $)，$ \\kappa $ 是平均曲率 (单位为 $ \\mathrm{m^{-1}} $)。假设迁移率具有Arrhenius形式，\n$$\nM(T) = M_0 \\exp\\!\\left(-\\frac{Q}{k_{\\mathrm{B}} T}\\right),\n$$\n其中 $ T $ 是绝对温度 (单位为 $ \\mathrm{K} $)，$ Q $ 是活化能 (单位为 $ \\mathrm{eV} $)，$ M_0 $ 是指前因子 (单位为 $ \\mathrm{m^4/(J\\,s)} $)，$ k_{\\mathrm{B}} $ 是玻尔兹曼常数 (单位为 $ \\mathrm{eV/K} $)。\n\n您的任务如下：\n- 使用指定的DFT数据集和先验分布，计算 $ \\theta $ 的高斯后验分布，并提取 $ \\gamma $ 的边缘后验分布。\n- 将 $ \\gamma $ 的后验不确定性通过介观尺度速度关系式进行传播，以获得在给定 $ \\kappa $ 和 $ T $ 下 $ v $ 的诱导分布。\n- 对于每个测试用例，计算三个量：$ v $ 的均值 (单位为 $ \\mathrm{m/s} $)，$ v $ 的标准差 (单位为 $ \\mathrm{m/s} $)，以及 $ v $ 超过指定阈值 $ v_{\\mathrm{th}} $ 的概率 (以小数表示的无量纲概率，而非百分比)。\n- 所有涉及物理量的答案必须使用上述单位表示。\n\n使用的基本原理：\n- 晶界能 $ \\gamma $ 定义为单位面积的能量。\n- DFT可观测量相对于$k$点取样和平面波截断能的收敛行为，由 $ m_i $ 和 $ c_i $ 的逆幂律标度关系概括。\n- 对于线性模型，高斯先验和高斯似然将导出高斯后验。\n- 用于曲率驱动迁移的Mullins关系式 $ v = M \\gamma \\kappa $，以及 $ M(T) $ 的Arrhenius形式。\n\n所有测试用例的通用参数：\n- 先验均值 $ \\mu_0 = (1.0, 0.0, 0.0)^\\top $。\n- 先验协方差 $ \\Sigma_0 = \\operatorname{diag}(0.2^2, 0.5^2, 0.5^2) $。\n- 收敛指数 $ p_k = 2 $ 和 $ p_c = 1 $。\n- Arrhenius参数 $ M_0 = 1.0 \\times 10^{-8} \\, \\mathrm{m^4/(J\\,s)} $，$ Q = 1.0 \\, \\mathrm{eV} $，以及 $ k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5} \\, \\mathrm{eV/K} $。\n\nDFT数据集 (每个观测值为一个三元组 $ (m_i, c_i, y_i) $):\n- 数据集A (中等收敛)：六个观测值\n  1. $ (4, 300, 1.0490) $\n  2. $ (4, 400, 1.028125) $\n  3. $ (9, 300, 1.03641975308642) $\n  4. $ (9, 500, 1.0030864197530864) $\n  5. $ (16, 400, 1.0134765625) $\n  6. $ (16, 600, 0.9926432291666667) $\n- 数据集B (接近收敛)：六个观测值\n  1. $ (20, 800, 0.981875) $\n  2. $ (30, 1000, 0.9752777777777778) $\n  3. $ (40, 1200, 0.9709895833333334) $\n  4. $ (20, 1200, 0.9714583333333334) $\n  5. $ (30, 800, 0.9815277777777777) $\n  6. $ (40, 1000, 0.97515625) $\n\n测试套件：\n- 用例 $ 1 $：使用数据集A，观测噪声标准差 $ \\sigma = 0.01 \\, \\mathrm{J/m^2} $，曲率 $ \\kappa = 1.0 \\times 10^{4} \\, \\mathrm{m^{-1}} $，温度 $ T = 1200 \\, \\mathrm{K} $，阈值 $ v_{\\mathrm{th}} = 1.0 \\times 10^{-8} \\, \\mathrm{m/s} $。\n- 用例 $ 2 $：使用数据集A，观测噪声标准差 $ \\sigma = 0.01 \\, \\mathrm{J/m^2} $，曲率 $ \\kappa = 0 \\, \\mathrm{m^{-1}} $ (边界条件)，温度 $ T = 1200 \\, \\mathrm{K} $，阈值 $ v_{\\mathrm{th}} = 1.0 \\times 10^{-8} \\, \\mathrm{m/s} $。\n- 用例 $ 3 $：使用数据集B，观测噪声标准差 $ \\sigma = 0.005 \\, \\mathrm{J/m^2} $，曲率 $ \\kappa = 1.0 \\times 10^{4} \\, \\mathrm{m^{-1}} $，温度 $ T = 1200 \\, \\mathrm{K} $，阈值 $ v_{\\mathrm{th}} = 1.0 \\times 10^{-8} \\, \\mathrm{m/s} $。\n- 用例 $ 4 $：使用数据集A，观测噪声标准差 $ \\sigma = 0.01 \\, \\mathrm{J/m^2} $，曲率 $ \\kappa = 1.0 \\times 10^{4} \\, \\mathrm{m^{-1}} $，低温 $ T = 800 \\, \\mathrm{K} $，阈值 $ v_{\\mathrm{th}} = 1.0 \\times 10^{-10} \\, \\mathrm{m/s} $。\n\n计算要求：\n- 给定高斯先验和上述线性观测模型，推导 $ \\theta $ 的高斯后验分布。提取 $ \\gamma $ 的边缘后验分布 (一个具有特定均值和方差的单变量高斯分布)。\n- 在固定的 $ \\kappa $ 和 $ T $下，将 $ v $ 视为 $ \\gamma $ 的线性变换，并据此获得 $ v $ 的均值和标准差。\n- 在 $ v $ 的诱导高斯分布下，计算超出概率 $ \\mathbb{P}(v > v_{\\mathrm{th}}) $。\n- 将 $ v $ 以 $ \\mathrm{m/s} $ 表示，概率以小数表示。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，格式为逗号分隔的列表的列表，其中每个内部列表为 $ [p, \\mu_v, \\sigma_v] $，其中 $ p = \\mathbb{P}(v > v_{\\mathrm{th}}) $ (小数)，$ \\mu_v $ 为平均速度 (单位为 $ \\mathrm{m/s} $)，$ \\sigma_v $ 为速度的标准差 (单位为 $ \\mathrm{m/s} $)。例如，输出应类似于 $ [[p_1,\\mu_1,\\sigma_1],[p_2,\\mu_2,\\sigma_2],[p_3,\\mu_3,\\sigma_3],[p_4,\\mu_4,\\sigma_4]] $。",
            "solution": "我们首先形式化DFT观测模型及其贝叶斯推断，然后将不确定性传播到介观尺度的速度预测中。\n\n观测模型对于参数 $ \\theta = (\\gamma, \\beta_k, \\beta_c)^\\top $ 是线性的。对于每个由索引 $ i $ 标记的观测，其$k$点分辨率为 $ m_i $，平面波截断能为 $ c_i $，观测值 $ y_i $ 满足\n$$\ny_i = \\gamma + \\beta_k m_i^{-p_k} + \\beta_c c_i^{-p_c} + \\varepsilon_i,\n$$\n其中 $ \\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2) $ 且相互独立。将 $ n $ 个观测值堆叠成一个向量 $ y \\in \\mathbb{R}^n $，并定义设计矩阵 $ X \\in \\mathbb{R}^{n \\times 3} $ 如下\n$$\nX = \\begin{bmatrix}\n1  m_1^{-p_k}  c_1^{-p_c} \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  m_n^{-p_k}  c_n^{-p_c}\n\\end{bmatrix}.\n$$\n那么其紧凑形式为\n$$\ny = X \\theta + \\varepsilon, \\quad \\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_n).\n$$\n\n先验分布为 $ \\theta \\sim \\mathcal{N}(\\mu_0, \\Sigma_0) $。对于线性高斯模型，后验分布 $ p(\\theta \\mid y) $ 也是高斯分布，由以下公式给出\n$$\n\\Sigma_n = \\left( \\Sigma_0^{-1} + \\frac{1}{\\sigma^2} X^\\top X \\right)^{-1}, \\quad\n\\mu_n = \\Sigma_n \\left( \\Sigma_0^{-1} \\mu_0 + \\frac{1}{\\sigma^2} X^\\top y \\right),\n$$\n其中 $ \\Sigma_n \\in \\mathbb{R}^{3 \\times 3} $ 是对称正定矩阵，$ \\mu_n \\in \\mathbb{R}^3 $。$ \\gamma $ 的边缘后验分布是此多元高斯分布的第一个分量：\n$$\n\\gamma \\mid y \\sim \\mathcal{N}(\\mu_{\\gamma}, \\sigma_{\\gamma}^2), \\quad \\mu_{\\gamma} = [\\mu_n]_1, \\quad \\sigma_{\\gamma}^2 = [\\Sigma_n]_{11},\n$$\n其中 $ [\\cdot]_1 $ 表示第一个分量，$ [\\cdot]_{11} $ 表示协方差矩阵的左上角元素。\n\n为与介观尺度动力学联系起来，我们使用曲率驱动晶界迁移的Mullins关系式 $ v = M \\, \\gamma \\, \\kappa $。迁移率遵循Arrhenius定律\n$$\nM(T) = M_0 \\exp\\!\\left(-\\frac{Q}{k_{\\mathrm{B}} T}\\right),\n$$\n其中 $ M_0 $ 单位为 $ \\mathrm{m^4/(J\\,s)} $，$ Q $ 单位为 $ \\mathrm{eV} $，$ k_{\\mathrm{B}} $ 单位为 $ \\mathrm{eV/K} $，$ T $ 单位为 $ \\mathrm{K} $。对于任意固定的曲率 $ \\kappa $ 和温度 $ T $，从 $ \\gamma $ 到 $ v $ 的映射是线性的：\n$$\nv = a \\, \\gamma, \\quad a = M(T) \\, \\kappa.\n$$\n高斯变量的线性变换仍然是高斯变量。因此，\n$$\nv \\mid y \\sim \\mathcal{N}\\big( \\mu_v, \\sigma_v^2 \\big), \\quad \\mu_v = a \\, \\mu_{\\gamma}, \\quad \\sigma_v^2 = a^2 \\, \\sigma_{\\gamma}^2.\n$$\n这保持了物理单位的一致性：$ \\gamma $ 的单位是 $ \\mathrm{J/m^2} $，$ \\kappa $ 的单位是 $ \\mathrm{m^{-1}} $，$ M $ 的单位是 $ \\mathrm{m^4/(J\\,s)} $，因此 $ v $ 的单位是 $ \\mathrm{m/s} $。\n\n为了量化不确定性对预测迁移速度分布的影响，我们计算超过指定阈值 $ v_{\\mathrm{th}} $ 的超出概率：\n$$\n\\mathbb{P}(v > v_{\\mathrm{th}}) = 1 - \\Phi\\!\\left( \\frac{v_{\\mathrm{th}} - \\mu_v}{\\sigma_v} \\right),\n$$\n其中 $ \\Phi $ 是标准正态分布的累积分布函数。使用互补误差函数 $ \\operatorname{erfc} $，我们可以写为\n$$\n\\mathbb{P}(v > v_{\\mathrm{th}}) = \\frac{1}{2} \\operatorname{erfc}\\!\\left( \\frac{v_{\\mathrm{th}} - \\mu_v}{\\sqrt{2} \\, \\sigma_v} \\right),\n$$\n按照惯例，如果 $ \\sigma_v = 0 $，则分布退化为点质量分布，$ \\mathbb{P}(v > v_{\\mathrm{th}}) $ 的值为 $ 0 $ 或 $ 1 $，具体取决于 $ \\mu_v $ 是否超过 $ v_{\\mathrm{th}} $。特殊的边界条件情况 $ \\kappa = 0 $ 会导致 $ a = 0 $，因此 $ v \\equiv 0 $ 是确定性的，这意味着 $ \\mu_v = 0 $，$ \\sigma_v = 0 $，并且对于任何正的 $ v_{\\mathrm{th}} $，$ \\mathbb{P}(v > v_{\\mathrm{th}}) = 0 $。\n\n每个测试用例的算法步骤：\n1. 使用 $ p_k = 2 $ 和 $ p_c = 1 $，根据指定的 $ (m_i, c_i) $ 对构建 $ X $。\n2. 根据给定的 $ y_i $ 观测值构建 $ y $。\n3. 使用上述公式计算 $ \\Sigma_0^{-1} $，然后计算 $ \\Sigma_n $ 和 $ \\mu_n $。\n4. 从 $ \\mu_n $ 和 $ \\Sigma_n $ 中提取 $ \\mu_{\\gamma} $ 和 $ \\sigma_{\\gamma}^2 $。\n5. 使用提供的 $ M_0 $、$ Q $ 和 $ k_{\\mathrm{B}} $，通过Arrhenius关系式计算 $ M(T) $。\n6. 计算 $ a = M(T) \\kappa $，然后计算 $ \\mu_v = a \\mu_{\\gamma} $ 和 $ \\sigma_v = |a| \\sqrt{\\sigma_{\\gamma}^2} $。\n7. 使用互补误差函数表达式计算 $ \\mathbb{P}(v > v_{\\mathrm{th}}) $。如果 $ \\sigma_v = 0 $，则相应地返回 $ 0 $ 或 $ 1 $。\n8. 为每个用例报告 $ [p, \\mu_v, \\sigma_v] $，其中 $ \\mu_v $ 和 $ \\sigma_v $ 的单位为 $ \\mathrm{m/s} $，$ p $ 为小数。\n\n该测试套件涵盖：\n- 一个具有中等DFT不确定性以及物理上合理的曲率和温度的通用情况。\n- 一个零曲率的边界条件情况，用于验证确定性的零速度。\n- 一个接近收敛的DFT情况，显示出 $ \\gamma $ 的后验分布更窄，相应地 $ v $ 的分布也更窄。\n- 一个低温情况，说明迁移率降低如何强烈抑制速度并改变超出概率。\n\n程序将计算这些量，并以指定的格式 $ [[p_1,\\mu_1,\\sigma_1],[p_2,\\mu_2,\\sigma_2],[p_3,\\mu_3,\\sigma_3],[p_4,\\mu_4,\\sigma_4]] $ 打印包含所有四个用例结果列表的单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import erfc, sqrt, exp\n\ndef bayes_posterior_gamma(dataset, sigma_obs, mu0, Sigma0, p_k, p_c):\n    \"\"\"\n    Compute posterior mean and variance for gamma under Gaussian prior and linear-Gaussian model.\n    dataset: list of tuples (m_i, c_i, y_i)\n    sigma_obs: observation noise standard deviation\n    mu0: prior mean vector shape (3,)\n    Sigma0: prior covariance matrix shape (3,3)\n    p_k, p_c: positive exponents\n    Returns: (mu_gamma, var_gamma)\n    \"\"\"\n    # Build design matrix X and observation vector y\n    X_rows = []\n    y_vals = []\n    for (m_i, c_i, y_i) in dataset:\n        X_rows.append([1.0, m_i ** (-p_k), c_i ** (-p_c)])\n        y_vals.append(y_i)\n    X = np.array(X_rows, dtype=float)  # shape (n,3)\n    y = np.array(y_vals, dtype=float)  # shape (n,)\n    # Posterior covariance and mean\n    Sigma0_inv = np.linalg.inv(Sigma0)\n    XtX = X.T @ X\n    Sigma_n = np.linalg.inv(Sigma0_inv + XtX / (sigma_obs**2))\n    mu_n = Sigma_n @ (Sigma0_inv @ mu0 + (X.T @ y) / (sigma_obs**2))\n    mu_gamma = float(mu_n[0])\n    var_gamma = float(Sigma_n[0, 0])\n    return mu_gamma, var_gamma\n\ndef mobility_arrhenius(T, M0, Q_eV, kB_eV_per_K):\n    \"\"\"\n    Compute mobility M(T) = M0 * exp(-Q / (kB * T)).\n    All inputs in their specified units; output in m^4/(J s).\n    \"\"\"\n    return M0 * exp(-Q_eV / (kB_eV_per_K * T))\n\ndef gaussian_exceedance_prob(mu, sigma, threshold):\n    \"\"\"\n    Compute P(X > threshold) for X ~ N(mu, sigma^2).\n    Handles sigma == 0 as a degenerate case.\n    \"\"\"\n    if sigma == 0.0:\n        return float(1.0 if mu > threshold else 0.0)\n    z = (threshold - mu) / (sqrt(2.0) * sigma)\n    return 0.5 * erfc(z)\n\ndef solve():\n    # Prior parameters\n    mu0 = np.array([1.0, 0.0, 0.0], dtype=float)\n    Sigma0 = np.diag([0.2**2, 0.5**2, 0.5**2])\n\n    # Convergence exponents\n    p_k = 2\n    p_c = 1\n\n    # Arrhenius parameters\n    M0 = 1.0e-8  # m^4/(J s)\n    Q = 1.0      # eV\n    kB = 8.617333262e-5  # eV/K\n\n    # Datasets\n    dataset_A = [\n        (4, 300, 1.0490),\n        (4, 400, 1.028125),\n        (9, 300, 1.03641975308642),\n        (9, 500, 1.0030864197530864),\n        (16, 400, 1.0134765625),\n        (16, 600, 0.9926432291666667),\n    ]\n    dataset_B = [\n        (20, 800, 0.981875),\n        (30, 1000, 0.9752777777777778),\n        (40, 1200, 0.9709895833333334),\n        (20, 1200, 0.9714583333333334),\n        (30, 800, 0.9815277777777777),\n        (40, 1000, 0.97515625),\n    ]\n\n    # Test cases: (dataset_id, sigma_obs, kappa, T, v_th)\n    test_cases = [\n        (\"A\", 0.01, 1.0e4, 1200.0, 1.0e-8),    # Case 1\n        (\"A\", 0.01, 0.0,    1200.0, 1.0e-8),    # Case 2\n        (\"B\", 0.005, 1.0e4, 1200.0, 1.0e-8),    # Case 3\n        (\"A\", 0.01, 1.0e4,  800.0,  1.0e-10),   # Case 4\n    ]\n\n    results = []\n    for ds_id, sigma_obs, kappa, T, v_th in test_cases:\n        dataset = dataset_A if ds_id == \"A\" else dataset_B\n        mu_gamma, var_gamma = bayes_posterior_gamma(dataset, sigma_obs, mu0, Sigma0, p_k, p_c)\n        M_T = mobility_arrhenius(T, M0, Q, kB)\n        a = M_T * kappa\n        mu_v = a * mu_gamma\n        sigma_v = abs(a) * sqrt(var_gamma)\n        p_exceed = gaussian_exceedance_prob(mu_v, sigma_v, v_th)\n        results.append([p_exceed, mu_v, sigma_v])\n\n    # Final print statement in the exact required format.\n    # Convert inner lists to string without extra spaces for consistency.\n    def list_to_str(lst):\n        return \"[\" + \",\".join(f\"{x}\" for x in lst) + \"]\"\n    print(\"[\" + \",\".join(list_to_str(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}