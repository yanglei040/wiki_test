{
    "hands_on_practices": [
        {
            "introduction": "过渡路径采样（TPS）的核心在于其能够在复杂的路径空间中进行有效的蒙特卡洛抽样。打靶算法（shooting move）是 TPS 中最基本也是最重要的路径生成机制。为了确保我们采样的路径系综收敛到正确的平衡分布，算法的每一步都必须满足细致平衡条件。这个练习将引导你推导在一个特定的有偏打靶算法中，如何根据细致平衡原理精确地构造出路径的接受概率，这是理解和实现任何 TPS 算法的基石。",
            "id": "1195098",
            "problem": "在过渡路径采样 (Transition Path Sampling, TPS) 中，使用蒙特卡洛方法来采样连接两个稳定态 A 和 B 的反应轨迹系综。一个从现有轨迹生成新的试探轨迹的常用算法是“打靶移动”。\n\n考虑一个由时间可逆、确定性、能量守恒的动力学（例如，哈密顿动力学）支配的系统。我们感兴趣的系综是时长固定为 $T$ 的过渡路径轨迹 $x(t) = (\\mathbf{q}(t), \\mathbf{p}(t))$ 系综。在此系综中，给定轨迹 $x$ 的概率由下式给出\n$$\nP_{TP}[x] \\propto h_A(\\mathbf{q}(0)) h_B(\\mathbf{q}(T)) \\exp(-\\beta H[x])\n$$\n其中 $h_A$ 和 $h_B$ 是特征函数，如果轨迹分别始于区域 A 并终于区域 B，则其值为 1，否则为 0。$H[x]$ 是轨迹的总能量（沿路径为常数），$\\beta$ 是逆温度。\n\n为了从旧路径 $x_{old}$ 生成新的试探路径 $x_{new}$，提出了一种有偏双向打靶移动：\n1.  从旧路径 $x_{old}$ 中选择一个时间为 $t_s \\in [0, T]$ 的“打靶点”。该选择受到沿路径的势能 $U(\\mathbf{q}(t))$ 的偏置，选择 $t_s$ 的概率密度由下式给出：\n    $$\n    p_{sel}(t_s|x) = \\frac{\\exp(\\gamma U(\\mathbf{q}(t_s)))}{W[x]}\n    $$\n    此处，$\\gamma$ 是一个常数偏置参数，而 $W[x] = \\int_0^T \\exp(\\gamma U(\\mathbf{q}(t'))) dt'$ 是一个依赖于路径的归一化因子。\n\n2.  在选定的相空间点 $(\\mathbf{q}_{old}(t_s), \\mathbf{p}_{old}(t_s))$ 处，通过添加一个随机向量 $\\delta \\mathbf{p}$ 来扰动动量，即 $\\mathbf{p}'(t_s) = \\mathbf{p}_{old}(t_s) + \\delta \\mathbf{p}$。扰动 $\\delta \\mathbf{p}$ 从一个对称的概率分布 $\\pi_{gen}(\\delta \\mathbf{p})$ 中抽取，即 $\\pi_{gen}(\\delta \\mathbf{p}) = \\pi_{gen}(-\\delta \\mathbf{p})$。\n\n3.  从新的相空间点 $(\\mathbf{q}_{old}(t_s), \\mathbf{p}'(t_s))$ 出发，通过在时间上向前和向后积分运动方程，生成一条新的轨迹 $x_{new}$。注意，在打靶时间 $t_s$ 处，新旧路径共享相同的构型，$\\mathbf{q}_{new}(t_s) = \\mathbf{q}_{old}(t_s)$。只有当新路径也连接 A 和 B 时，该移动才被接受。\n\n为确保采样收敛到正确的分布 $P_{TP}[x]$，接受概率必须满足细致平衡条件。对于 $x_{old} \\to x_{new}$ 这一移动，Metropolis-Hastings 接受概率由 $P_{acc} = \\min(1, \\alpha)$ 给出。\n\n推导这种有偏打靶移动的接受率 $\\alpha$ 的表达式。用能量 $H[x_{old}]$、$H[x_{new}]$，归一化因子 $W[x_{old}]$、$W[x_{new}]$ 和逆温度 $\\beta$ 来表示你的答案。",
            "solution": "1. 过渡路径系综权重为\n$$P_{TP}[x]\\propto h_A(\\mathbf q(0))\\,h_B(\\mathbf q(T))\\,e^{-\\beta H[x]}\\,. $$  \n2. Metropolis–Hastings 的细致平衡要求\n$$P_{TP}[x_{old}]\\,p_{prop}(x_{old}\\to x_{new})\\,P_{acc}  =  P_{TP}[x_{new}]\\,p_{prop}(x_{new}\\to x_{old})\\,P_{acc}^{\\rm rev}\\,. $$  \n由于我们有偏地选择 $t_s$\n$$p_{sel}(t_s|x)=\\frac{e^{\\gamma U(\\mathbf q(t_s))}}{W[x]}\\,,\\quad W[x]=\\int_0^T e^{\\gamma U(\\mathbf q(t'))}\\,dt'\\,, $$  \n并用对称的 $\\pi_{gen}(\\delta p)=\\pi_{gen}(-\\delta p)$ 扰动动量，正向和反向的提议概率密度为\n$$p_{prop}(x_{old}\\to x_{new})=p_{sel}(t_s|x_{old})\\,\\pi_{gen}(\\delta p),\\quad p_{prop}(x_{new}\\to x_{old})=p_{sel}(t_s|x_{new})\\,\\pi_{gen}(-\\delta p)\\,. $$  \n3. 提议概率密度之比为\n$$\\frac{p_{prop}(x_{new}\\to x_{old})}{p_{prop}(x_{old}\\to x_{new})} \n=\\frac{p_{sel}(t_s|x_{new})}{p_{sel}(t_s|x_{old})}\n=\\frac{e^{\\gamma U(\\mathbf q(t_s))}/W[x_{new}]}{e^{\\gamma U(\\mathbf q(t_s))}/W[x_{old}]}\n=\\frac{W[x_{old}]}{W[x_{new}]}\\,. $$  \n4. 于是 Metropolis 比率为\n$$\n\\alpha\n=\\frac{P_{TP}[x_{new}]\\,p_{prop}(x_{new}\\to x_{old})}{P_{TP}[x_{old}]\\,p_{prop}(x_{old}\\to x_{new})}\n=\\frac{e^{-\\beta H[x_{new}]}}{e^{-\\beta H[x_{old}]}}\n\\;\\frac{W[x_{old}]}{W[x_{new}]}\n=\\exp\\!\\bigl(-\\beta(H[x_{new}]-H[x_{old}])\\bigr)\\,\\frac{W[x_{old}]}{W[x_{new}]}\\,. $$",
            "answer": "$$\\boxed{\\exp\\bigl(-\\beta\\bigl(H[x_{new}]-H[x_{old}]\\bigr)\\bigr)\\,\\frac{W[x_{old}]}{W[x_{new}]}}$$"
        },
        {
            "introduction": "理解了如何生成和接受新的路径之后，下一个关键问题是：我们采样的目标分布究竟是什么？一条路径的概率由其“作用量”（action）决定，而作用量的具体形式则取决于系统底层的动力学。本练习将探讨在计算材料科学和化学物理中极为常见的过阻尼朗之万动力学情形。你将从离散化的动力学方程出发，推导出连续时间极限下的路径作用量，即著名的翁萨格-马赫卢普泛函（Onsager-Machlup functional），从而深刻理解在扩散主导的系统中，路径概率的理论根源。",
            "id": "3498770",
            "problem": "在计算材料科学中，对于稀有事件动力学的过渡路径采样 (Transition Path Sampling, TPS) 方法而言，一维空间中的过阻尼朗之万动力学常被用作受热涨落影响的原子或集体坐标的基本模型。考虑一个坐标为 $x(t)$ 的粒子，在绝对温度 $T$ 下，于势能 $V(x)$ 中演化。在过阻尼极限下，其迁移率为 $\\mu$，扩散系数为 $D$。该动力学由随机微分方程 $dx(t) = -\\mu\\,\\partial_{x}V(x(t))\\,dt + \\sqrt{2D}\\,dW_{t}$ 定义，其中 $W_{t}$ 是一个标准维纳过程，$D$ 和 $\\mu$ 满足爱因斯坦关系式 $D = \\mu k_{B} T$，$k_{B}$ 为玻尔兹曼常数。在固定的观测时间 $\\tau$ 内，将此动力学进行离散化，时间步长为 $\\Delta t$，总步数为 $N = \\tau/\\Delta t$，其欧拉-丸山格式为 $x_{n+1} = x_{n} - \\mu\\,\\partial_{x}V(x_{n})\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\eta_{n}$，其中 $\\eta_{n}$ 是独立的标准正态随机变量。对于具有固定端点 $x(0) = x_{A}$ 和 $x(\\tau) = x_{B}$ 的离散路径 $\\{x_{0}, x_{1}, \\dots, x_{N}\\}$，其 TPS 路径权重可以写成路径泛函 $S[x]$（作用量）的指数形式。在连续时间极限下，该泛函定义了与路径系综的采样和重加权相关的 Onsager–Machlup 泛函。\n\n从上述欧拉-丸山格式和爱因斯坦关系式所隐含的离散时间转移核出发，推导在谐振势 $V(x) = \\frac{1}{2}k x^{2}$（其中 $k  0$ 为恒定刚度）下，作用量 $S[x]$ 的显式连续时间形式。仅使用给定的基本动力学和关系式来构建路径概率密度，并在 $\\Delta t$ 趋于无穷小（$\\tau$ 固定）的极限下确定 $S[x]$。然后，通过分析离散时间转移核，验证路径测度在其增量上是高斯的，并且在 $\\Delta t$ 趋于无穷小的极限下是可归一化的。\n\n将最终的作用量 $S[x]$ 表示为关于 $x(t)$、$\\mu$、$D$、$k$ 和 $\\tau$ 的单一闭式解析泛函。无需进行数值计算。",
            "solution": "满足 $D = \\mu k_{B} T$ 的过阻尼朗之万动力学 $dx(t) = -\\mu\\,\\partial_{x}V(x(t))\\,dt + \\sqrt{2D}\\,dW_{t}$ 定义了一个马尔可夫过程。通过欧拉-丸山格式对其进行离散时间近似，得到 $x_{n+1} = x_{n} - \\mu\\,\\partial_{x}V(x_{n})\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\eta_{n}$，其中 $\\eta_{n}$ 是独立的标准正态随机变量。单步的条件转移密度是高斯形式的，由下式给出：\n$$\np(x_{n+1}\\,|\\,x_{n}) = \\frac{1}{\\sqrt{4\\pi D\\,\\Delta t}} \\exp\\!\\left(-\\frac{\\left[x_{n+1} - x_{n} + \\mu\\,\\partial_{x}V(x_{n})\\,\\Delta t\\right]^{2}}{4D\\,\\Delta t}\\right).\n$$\n这是由 $\\eta_{n}$ 的分布以及在 $x_{n}$ 固定时连接 $\\eta_{n}$ 与 $x_{n+1}$ 的仿射变换得出的。对于一个具有固定端点的路径 $\\{x_{0}, x_{1}, \\dots, x_{N}\\}$，其（未归一化的）路径概率密度是逐步条件密度的乘积，\n$$\n\\mathcal{P}[\\{x_{n}\\}] \\propto \\prod_{n=0}^{N-1} \\exp\\!\\left(-\\frac{\\left[x_{n+1} - x_{n} + \\mu\\,\\partial_{x}V(x_{n})\\,\\Delta t\\right]^{2}}{4D\\,\\Delta t}\\right),\n$$\n除去一个归一化因子 $\\left(4\\pi D\\,\\Delta t\\right)^{-N/2}$。当视为给定 $x_n$ 时关于后续 $x_{n+1}$ 的条件密度时，该因子与特定路径无关。通过 $\\mathcal{P}[\\{x_{n}\\}] \\propto \\exp(-S[\\{x_{n}\\}])$ 确定作用量 $S[x]$，我们可以直接写出离散时间作用量：\n$$\nS[\\{x_{n}\\}] = \\sum_{n=0}^{N-1} \\frac{\\left[x_{n+1} - x_{n} + \\mu\\,\\partial_{x}V(x_{n})\\,\\Delta t\\right]^{2}}{4D\\,\\Delta t}.\n$$\n现在我们将其应用于谐振势 $V(x) = \\frac{1}{2}k x^{2}$，此时 $\\partial_{x}V(x) = k x$。离散作用量变为：\n$$\nS[\\{x_{n}\\}] = \\sum_{n=0}^{N-1} \\frac{\\left[x_{n+1} - x_{n} + \\mu k x_{n}\\,\\Delta t\\right]^{2}}{4D\\,\\Delta t}.\n$$\n为了得到连续时间作用量，我们考虑 $\\Delta t \\to 0$ 而 $\\tau = N\\,\\Delta t$ 保持固定的极限。在此极限下，$x_{n+1} - x_{n} \\approx \\dot{x}(t_{n})\\,\\Delta t$，其中 $t_{n} = n\\,\\Delta t$。将求和重写为黎曼和，然后转为时间积分，我们得到：\n$$\nS[x] = \\int_{0}^{\\tau} \\frac{\\left[\\dot{x}(t) + \\mu k x(t)\\right]^{2}}{4D}\\,dt.\n$$\n此表达式是在谐振势中、具有恒定扩散系数的过阻尼粒子的 Onsager–Machlup 作用量。它捕捉了偏离确定性漂移 $\\dot{x}(t) = -\\mu k x(t)$ 的二次惩罚，该惩罚由噪声强度 $D$ 进行缩放。\n\n现在我们验证在 $\\Delta t$ 趋于无穷小的极限下，路径测度是高斯的且可归一化的。逐步条件密度 $p(x_{n+1}\\,|\\,x_{n})$ 是关于变量 $x_{n+1}$ 的高斯函数，其均值为：\n$$\nm_{n} = x_{n} - \\mu\\,\\partial_{x}V(x_{n})\\,\\Delta t = x_{n} - \\mu k x_{n}\\,\\Delta t,\n$$\n方差为：\n$$\n\\sigma^{2} = 2D\\,\\Delta t.\n$$\n其高斯形式是明确的，并且对于每一步，\n$$\n\\int_{-\\infty}^{\\infty} p(x_{n+1}\\,|\\,x_{n})\\,dx_{n+1} = 1,\n$$\n因为对于任何 $\\Delta t  0$，归一化因子 $1/\\sqrt{4\\pi D\\,\\Delta t}$ 和二次指数项都定义了一个正确归一化的高斯函数。在 $\\Delta t \\to 0$ 的极限下，方差 $\\sigma^{2} = 2D\\,\\Delta t$ 趋于 0，这反映了每个时间步长的弱噪声标度。但是，序列乘积结构确保了整体的路径测度（视为归一化条件密度的复合）在具有固定端点和马尔可夫演化的轨迹空间上保持归一化。增量 $x_{n+1} - x_{n}$ 的高斯特性（均值为 $-\\mu k x_{n}\\,\\Delta t$，方差为 $2D\\,\\Delta t$）确保了离散路径权重具有用于定义 $S[\\{x_{n}\\}]$ 的二次形式，而过渡到连续极限则得到了上面推导出的二次 Onsager–Machlup 泛函 $S[x]$。与漂移的散度相关的任何附加项（对于伊藤诠释）将是 $\\frac{\\mu}{2}\\int_{0}^{\\tau} \\partial_{x}^{2}V(x(t))\\,dt = \\frac{\\mu}{2}\\int_{0}^{\\tau} k\\,dt = \\frac{\\mu k \\tau}{2}$。该项与路径无关，因此只对路径测度的整体归一化有贡献；它既不改变高斯特性也不改变可归一化性，在关注相对路径权重时可以从 $S[x]$ 中省略。\n\n因此，对于谐振势，显式的连续时间作用量泛函为：\n$$\nS[x] = \\int_{0}^{\\tau} \\frac{\\left[\\dot{x}(t) + \\mu k x(t)\\right]^{2}}{4D}\\,dt,\n$$\n并且，离散时间路径测度在其增量上是高斯的，方差为 $2D\\,\\Delta t$，这使得在每一步都有一个归一化的条件转移核，并在无穷小 $\\Delta t$ 极限下得到一个可归一化的路径概率密度。",
            "answer": "$$\\boxed{S[x]=\\int_{0}^{\\tau}\\frac{\\left[\\dot{x}(t)+\\mu\\,k\\,x(t)\\right]^{2}}{4D}\\,dt}$$"
        },
        {
            "introduction": "在处理具有非常高能垒的稀有事件时，标准的过渡路径采样效率可能会变得很低。为了解决这个问题，研究者们常常会引入一个人为的偏置势（bias potential）来增强对过渡区域的采样，这与伞形采样或元动力学等增强采样方法的思想一致。然而，引入偏置势后，我们必须对采样结果进行校正才能得到无偏的物理量。这个高级练习将指导你推导如何通过“重加权”（reweighting）技术从有偏的模拟中恢复无偏的系综平均值，并进一步分析该方法的统计效率，这对于在实际研究中可靠地应用增强的路径采样方法至关重要。",
            "id": "3498791",
            "problem": "考虑一个分子系统中的反应路径系综，该系统在温度 $T$ 下以过阻尼 Langevin 动力学演化，逆温度为 $\\beta = 1/(k_{B} T)$，其中 $k_{B}$ 是 Boltzmann 常数。设离散时间路径表示为 $\\omega = (x_{0}, x_{1}, \\dots, x_{M})$，并设无偏路径概率密度（限于从盆 $A$ 开始并在盆 $B$ 结束的路径）为 $P_{0}(\\omega \\mid A \\to B) \\propto \\rho_{\\text{eq}}(x_{0}) \\prod_{t=0}^{M-1} p(x_{t+1} \\mid x_{t})$，其中 $\\rho_{\\text{eq}}(x) \\propto \\exp(-\\beta V(x))$ 是与势能 $V(x)$ 相关的正则平衡分布，而 $p(x' \\mid x)$ 是相对于 $\\rho_{\\text{eq}}(x)$ 满足细致平衡条件的单步 Markov 转移核。定义一个时间平均的序参量 $\\Lambda(\\omega) = \\frac{1}{M+1} \\sum_{t=0}^{M} \\lambda(x_{t})$。\n\n为了提高过渡路径采样中的采样效率，考虑从一个具有以下概率密度的有偏反应路径系综中采样：\n$$\nP_{\\text{b}}(\\omega \\mid A \\to B) = \\frac{1}{Z_{\\text{b}}} \\, P_{0}(\\omega \\mid A \\to B) \\, \\exp\\!\\big(-\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega))\\big),\n$$\n其中 $U_{\\text{bias}}(\\Lambda)$ 是作用于路径泛函 $\\Lambda(\\omega)$ 的一个预设偏置势，$Z_{\\text{b}}$ 是确保 $P_{\\text{b}}$ 在反应路径空间上积分为 $1$ 的归一化因子。\n\n任务：\n- 从重要性采样的定义和上述路径测度出发，推导重加权因子 $w(\\omega)$，该因子允许使用从 $P_{\\text{b}}(\\omega \\mid A \\to B)$ 得到的样本对 $P_{0}(\\omega \\mid A \\to B)$ 下的任意路径可观测量 $O(\\omega)$ 进行无偏估计。写出 $\\langle O \\rangle_{0} \\equiv \\int \\mathrm{d}\\omega \\, P_{0}(\\omega \\mid A \\to B) \\, O(\\omega)$ 相应的自归一化估计量，以对有偏系综的平均值表示。\n- 现在假设，在有偏系综 $P_{\\text{b}}$ 下，随机变量 $Y(\\omega) \\equiv U_{\\text{bias}}(\\Lambda(\\omega))$ 近似服从均值为 $\\mu$、方差为 $s^{2}$ 的高斯分布（两者均为有限值且与样本大小无关），即 $Y \\sim \\mathcal{N}(\\mu, s^{2})$。利用此假设和你的重加权因子，推导权重的变异系数平方，\n$$\n\\mathrm{CV}^{2} \\equiv \\frac{\\operatorname{Var}_{\\text{b}}[w(\\omega)]}{\\big(\\mathbb{E}_{\\text{b}}[w(\\omega)]\\big)^{2}},\n$$\n作为 $\\beta$ 和 $s$ 的显式闭合形式函数。从物理上解释，在何种情况下，就 $P_{0}$ 和 $P_{\\text{b}}$ 之间的重叠以及有效样本大小随独立路径数 $N$ 的缩放而言，重加权可观测量的方差会变得过大。\n你最终报告的答案必须是 $\\mathrm{CV}^{2}$ 作为 $\\beta$ 和 $s$ 的函数的显式解析表达式。该表达式是无量纲的；报告时无需单位。",
            "solution": "问题陈述已经过验证，被确定为计算统计力学中一个适定、有科学依据的问题。它要求在过渡路径系综的背景下推导与重要性采样相关的标准结果，并在特定假设下分析采样效率。\n\n第一个任务是推导重加权因子 $w(\\omega)$ 和可观测量在无偏系综上平均值 $\\langle O \\rangle_{0}$ 的自归一化估计量，该估计量使用从有偏系综中获得的样本。\n\n可观测量 $O(\\omega)$ 在无偏路径概率分布 $P_{0}(\\omega \\mid A \\to B)$ 上的期望值定义为：\n$$\n\\langle O \\rangle_{0} = \\int \\mathrm{d}\\omega \\, P_{0}(\\omega \\mid A \\to B) \\, O(\\omega)\n$$\n其中积分遍及所有从状态空间区域 $A$ 开始并在区域 $B$ 结束的路径 $\\omega$。为了使用从有偏分布 $P_{\\text{b}}(\\omega \\mid A \\to B)$ 中抽取的样本来评估该期望，我们采用重要性采样的原理。我们通过乘以和除以 $P_{\\text{b}}(\\omega \\mid A \\to B)$ 来重写积分：\n$$\n\\langle O \\rangle_{0} = \\int \\mathrm{d}\\omega \\, \\frac{P_{0}(\\omega \\mid A \\to B)}{P_{\\text{b}}(\\omega \\mid A \\to B)} \\, P_{\\text{b}}(\\omega \\mid A \\to B) \\, O(\\omega)\n$$\n这可以表示为对有偏系综的期望值：\n$$\n\\langle O \\rangle_{0} = \\mathbb{E}_{\\text{b}} \\left[ w(\\omega) O(\\omega) \\right]\n$$\n其中重加权因子 $w(\\omega)$ 定义为概率密度的比值：\n$$\nw(\\omega) \\equiv \\frac{P_{0}(\\omega \\mid A \\to B)}{P_{\\text{b}}(\\omega \\mid A \\to B)}\n$$\n使用给定的 $P_{\\text{b}}(\\omega \\mid A \\to B)$ 定义：\n$$\nP_{\\text{b}}(\\omega \\mid A \\to B) = \\frac{1}{Z_{\\text{b}}} \\, P_{0}(\\omega \\mid A \\to B) \\, \\exp(-\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))\n$$\n我们可以找到重加权因子的显式表达式：\n$$\nw(\\omega) = \\frac{P_{0}(\\omega \\mid A \\to B)}{\\frac{1}{Z_{\\text{b}}} \\, P_{0}(\\omega \\mid A \\to B) \\, \\exp(-\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))} = Z_{\\text{b}} \\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))\n$$\n归一化常数 $Z_{\\text{b}}$ 通常是未知的。为了解决这个问题，我们使用自归一化估计量。我们可以将 $\\langle O \\rangle_{0}$ 写成期望的比值：\n$$\n\\langle O \\rangle_{0} = \\frac{\\int \\mathrm{d}\\omega \\, O(\\omega) P_{0}(\\omega)}{\\int \\mathrm{d}\\omega \\, P_{0}(\\omega)} = \\frac{\\int \\mathrm{d}\\omega \\, O(\\omega) w(\\omega) P_{\\text{b}}(\\omega)}{\\int \\mathrm{d}\\omega \\, w(\\omega) P_{\\text{b}}(\\omega)} = \\frac{\\mathbb{E}_{\\text{b}}[O(\\omega)w(\\omega)]}{\\mathbb{E}_{\\text{b}}[w(\\omega)]}\n$$\n代入 $w(\\omega)$ 的表达式，未知的常数 $Z_{\\text{b}}$ 被消去：\n$$\n\\langle O \\rangle_{0} = \\frac{\\mathbb{E}_{\\text{b}}[O(\\omega) Z_{\\text{b}} \\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))]}{\\mathbb{E}_{\\text{b}}[Z_{\\text{b}} \\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))]} = \\frac{\\mathbb{E}_{\\text{b}}[O(\\omega) \\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))]}{\\mathbb{E}_{\\text{b}}[\\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega)))]}\n$$\n这就是用有偏系综 $P_{\\text{b}}$ 上的平均值表示的 $\\langle O \\rangle_{0}$ 的自归一化估计量。如果有一组从 $P_{\\text{b}}$ 中抽取的 $N$ 条路径 $\\{\\omega_i\\}_{i=1}^N$，则该估计量计算如下：\n$$\n\\langle O \\rangle_{0} \\approx \\frac{\\sum_{i=1}^{N} O(\\omega_i) \\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega_i)))}{\\sum_{i=1}^{N} \\exp(\\beta \\, U_{\\text{bias}}(\\Lambda(\\omega_i)))}\n$$\n\n第二个任务是推导权重的变异系数平方 $\\mathrm{CV}^{2}$，其假设是当从有偏系综 $P_{\\text{b}}$ 中采样时，$Y(\\omega) \\equiv U_{\\text{bias}}(\\Lambda(\\omega))$ 服从高斯分布 $Y \\sim \\mathcal{N}(\\mu, s^{2})$。\n\n变异系数平方定义为：\n$$\n\\mathrm{CV}^{2} \\equiv \\frac{\\operatorname{Var}_{\\text{b}}[w(\\omega)]}{\\left(\\mathbb{E}_{\\text{b}}[w(\\omega)]\\right)^{2}}\n$$\n使用恒等式 $\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$，我们可以写出：\n$$\n\\mathrm{CV}^{2} = \\frac{\\mathbb{E}_{\\text{b}}[w(\\omega)^2] - \\left(\\mathbb{E}_{\\text{b}}[w(\\omega)]\\right)^{2}}{\\left(\\mathbb{E}_{\\text{b}}[w(\\omega)]\\right)^{2}} = \\frac{\\mathbb{E}_{\\text{b}}[w(\\omega)^2]}{\\left(\\mathbb{E}_{\\text{b}}[w(\\omega)]\\right)^{2}} - 1\n$$\n我们需要计算 $w(\\omega)$ 关于有偏分布 $P_{\\text{b}}$ 的一阶矩和二阶矩。权重为 $w(\\omega) = Z_{\\text{b}} \\exp(\\beta Y(\\omega))$。\n期望值为：\n$$\n\\mathbb{E}_{\\text{b}}[w(\\omega)] = \\mathbb{E}_{\\text{b}}[Z_{\\text{b}} \\exp(\\beta Y)] = Z_{\\text{b}} \\mathbb{E}_{\\text{b}}[\\exp(\\beta Y)]\n$$\n$$\n\\mathbb{E}_{\\text{b}}[w(\\omega)^2] = \\mathbb{E}_{\\text{b}}[(Z_{\\text{b}} \\exp(\\beta Y))^2] = Z_{\\text{b}}^2 \\mathbb{E}_{\\text{b}}[\\exp(2\\beta Y)]\n$$\n期望 $\\mathbb{E}_{\\text{b}}[\\exp(k Y)]$ 是随机变量 $Y$ 的矩。由于 $Y$ 是高斯分布的，即 $Y \\sim \\mathcal{N}(\\mu, s^{2})$，我们可以使用其矩生成函数的公式，$M_Y(t) = \\mathbb{E}[\\exp(tY)] = \\exp(\\mu t + \\frac{1}{2}\\sigma^2 t^2)$。在我们的例子中，方差是 $\\sigma^2 = s^2$。\n\n对于 $w$ 的一阶矩，我们令 $t = \\beta$：\n$$\n\\mathbb{E}_{\\text{b}}[\\exp(\\beta Y)] = M_Y(\\beta) = \\exp\\left(\\mu \\beta + \\frac{1}{2}s^2 \\beta^2\\right)\n$$\n因此，\n$$\n\\mathbb{E}_{\\text{b}}[w(\\omega)] = Z_{\\text{b}} \\exp\\left(\\mu \\beta + \\frac{1}{2}s^2 \\beta^2\\right)\n$$\n对于 $w$ 的二阶矩，我们需要 $\\exp(2\\beta Y)$ 的期望，所以我们令 $t = 2\\beta$：\n$$\n\\mathbb{E}_{\\text{b}}[\\exp(2\\beta Y)] = M_Y(2\\beta) = \\exp\\left(\\mu (2\\beta) + \\frac{1}{2}s^2 (2\\beta)^2\\right) = \\exp\\left(2\\mu\\beta + 2s^2\\beta^2\\right)\n$$\n因此，\n$$\n\\mathbb{E}_{\\text{b}}[w(\\omega)^2] = Z_{\\text{b}}^2 \\exp\\left(2\\mu\\beta + 2s^2\\beta^2\\right)\n$$\n现在，我们将这些矩代回 $\\mathrm{CV}^{2}$ 的表达式中：\n$$\n\\mathrm{CV}^{2} = \\frac{Z_{\\text{b}}^2 \\exp(2\\mu\\beta + 2s^2\\beta^2)}{\\left(Z_{\\text{b}} \\exp(\\mu \\beta + \\frac{1}{2}s^2 \\beta^2)\\right)^2} - 1\n$$\n$$\n\\mathrm{CV}^{2} = \\frac{Z_{\\text{b}}^2 \\exp(2\\mu\\beta + 2s^2\\beta^2)}{Z_{\\text{b}}^2 \\exp(2(\\mu \\beta + \\frac{1}{2}s^2 \\beta^2))} - 1 = \\frac{\\exp(2\\mu\\beta + 2s^2\\beta^2)}{\\exp(2\\mu\\beta + s^2\\beta^2)} - 1\n$$\n$$\n\\mathrm{CV}^{2} = \\exp(2\\mu\\beta + 2s^2\\beta^2 - (2\\mu\\beta + s^2\\beta^2)) - 1 = \\exp(s^2\\beta^2) - 1\n$$\n这就是所求的权重变异系数平方作为 $\\beta$ 和 $s$ 的函数的闭合形式表达式。\n\n最后，我们解释这个结果。量 $\\mathrm{CV}^{2}$ 是重要性采样过程统计效率低下的一个度量。大的 $\\mathrm{CV}^{2}$ 表明权重的方差很大，这意味着可观测量的估计将由少数具有大权重的轨迹主导，导致收敛性差和统计误差高。采样效率的一个常用度量是有效样本大小 $N_{\\text{eff}}$，对于一组 $N$ 个独立样本，它通常近似为 $N_{\\text{eff}} \\approx \\frac{N}{1 + \\mathrm{CV}^2}$。代入我们的结果：\n$$\nN_{\\text{eff}} \\approx \\frac{N}{1 + (\\exp(s^2\\beta^2) - 1)} = \\frac{N}{\\exp(s^2\\beta^2)} = N \\exp(-s^2\\beta^2)\n$$\n该表达式表明，有效样本数量随参数 $s^2\\beta^2$呈指数下降。项 $s^2$ 是有偏系综中路径所经历的偏置势能 $U_{\\text{bias}}$ 的方差，而 $\\beta^2 = (1/k_B T)^2$。因此，$s^2\\beta^2$ 是以 $(k_B T)^2$ 为单位测量的偏置势能的方差。\n当 $s^2\\beta^2 \\gtrsim 1$ 时，重加权可观测量的方差变得过大。这个条件意味着偏置能量的标准差 $s$ 与热能 $k_B T$ 处于同一数量级或更大。偏置能量的这种宽泛波动意味着有偏采样探索的路径空间区域在无偏分布 $P_0$ 下具有截然不同的概率。采样分布 $P_{\\text{b}}$ 与目标分布 $P_0$ 之间缺乏重叠是导致权重方差大以及重加权方案效率低下的根本原因。",
            "answer": "$$\\boxed{\\exp(s^{2}\\beta^{2}) - 1}$$"
        }
    ]
}