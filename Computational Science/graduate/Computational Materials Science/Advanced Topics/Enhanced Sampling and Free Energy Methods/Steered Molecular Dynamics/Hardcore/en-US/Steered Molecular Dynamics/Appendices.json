{
    "hands_on_practices": [
        {
            "introduction": "Steered Molecular Dynamics can be implemented using different protocols, most commonly by applying a constant force or by pulling a harmonic trap at a constant velocity. This exercise provides a foundational analysis of these two approaches by solving the governing equation of motion for a simple, yet illustrative, model system . By deriving the average trajectory $\\langle x(t) \\rangle$ and the resulting lag, you will gain a quantitative understanding of how a system responds to external driving and why constant velocity pulling leads to a steady-state lag.",
            "id": "3490235",
            "problem": "A single adsorption reaction coordinate $x(t)$ describes the center-of-mass approach of a molecule toward a flat substrate in Steered Molecular Dynamics (SMD). Assume the overdamped regime and linear response near an adsorption site located at $x=0$, so that the background adsorption free energy can be locally approximated by a harmonic potential with stiffness $k_{a}$, i.e., $U(x) \\approx \\frac{1}{2} k_{a} x^{2}$. The dynamics in one dimension are modeled by the overdamped Langevin equation\n$$\n\\gamma \\,\\frac{dx}{dt} \\;=\\; -\\frac{dU}{dx} \\;+\\; f_{\\mathrm{ext}}(t) \\;+\\; \\xi(t),\n$$\nwhere $\\gamma$ is the friction coefficient and $\\xi(t)$ is a zero-mean thermal noise with $\\langle \\xi(t) \\rangle = 0$. As a result, the ensemble average $\\langle x(t) \\rangle$ obeys a deterministic linear ordinary differential equation.\n\nConsider two common SMD steering protocols applied for $t \\geq 0$ with the initial condition $\\langle x(0) \\rangle = 0$:\n\n1. Constant force steering: a constant external force $f_{\\mathrm{ext}}(t) = F_{0}$.\n2. Constant velocity steering with a harmonic restraint: a moving harmonic reference $x_{0}(t) = v t$ with steering stiffness $k$, producing an external force $f_{\\mathrm{ext}}(t) = -\\frac{\\partial}{\\partial x}\\left[\\frac{1}{2}k\\left(x - x_{0}(t)\\right)^{2}\\right]$.\n\nStarting from the overdamped Langevin equation and the linear response approximation described above, perform the following:\n\n- Derive the closed-form expression of $\\langle x(t) \\rangle$ under constant force steering in terms of $F_{0}$, $k_{a}$, and $\\gamma$.\n- Derive the closed-form expression of $\\langle x(t) \\rangle$ under constant velocity steering in terms of $k$, $k_{a}$, $v$, and $\\gamma$.\n- Define the time-dependent lag $\\Delta(t) \\equiv x_{0}(t) - \\langle x(t) \\rangle$ under constant velocity steering and express $\\Delta(t)$ in closed form in terms of $k$, $k_{a}$, $v$, $\\gamma$, and $t$.\n\nFinally, for constant velocity steering, evaluate the lag $\\Delta(t^{\\ast})$ at a specified time $t^{\\ast} = 0.5\\,\\mathrm{ns}$ using the following parameter values:\n- Friction coefficient $\\gamma = 3.0 \\times 10^{-12}\\,\\mathrm{kg/s}$,\n- Adsorption stiffness $k_{a} = 200\\,\\mathrm{pN/nm}$,\n- Steering stiffness $k = 100\\,\\mathrm{pN/nm}$,\n- Pulling velocity $v = 5\\,\\mathrm{nm/ns}$.\n\nExpress the final lag in nanometers (nm) and round your answer to four significant figures. The final answer must be a single real-valued number.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided model, the overdamped Langevin equation, is a cornerstone of statistical mechanics for describing Brownian motion in a potential. The use of a harmonic approximation for the free energy landscape and the application of standard constant force and constant velocity steering protocols are standard, well-established techniques in the field of computational materials science and biophysics, specifically in Steered Molecular Dynamics (SMD). All parameters, initial conditions, and objectives are clearly defined, constituting a solvable initial value problem for a linear ordinary differential equation. The parameter values are physically realistic for molecular-scale simulations. Thus, the problem is deemed valid and a full solution can be derived.\n\nThe dynamics of the system are governed by the one-dimensional overdamped Langevin equation:\n$$\n\\gamma \\frac{dx}{dt} = -\\frac{dU}{dx} + f_{\\mathrm{ext}}(t) + \\xi(t)\n$$\nwhere $U(x) = \\frac{1}{2} k_{a} x^{2}$, $\\gamma$ is the friction coefficient, $f_{\\mathrm{ext}}(t)$ is the time-dependent external steering force, and $\\xi(t)$ is a thermal noise term with zero mean, $\\langle \\xi(t) \\rangle = 0$. The force derived from the background potential is $-\\frac{dU}{dx} = -k_a x$.\n\nAs stated in the problem, the ensemble average $\\langle x(t) \\rangle$ obeys a deterministic equation. We find this equation by taking the ensemble average of the Langevin equation. Due to the linearity of the averaging operator and the force terms, and given $\\langle \\xi(t) \\rangle = 0$, we have:\n$$\n\\left\\langle \\gamma \\frac{dx}{dt} \\right\\rangle = \\left\\langle -k_a x + f_{\\mathrm{ext}}(t) + \\xi(t) \\right\\rangle\n$$\n$$\n\\gamma \\frac{d\\langle x(t) \\rangle}{dt} = -k_a \\langle x(t) \\rangle + \\langle f_{\\mathrm{ext}}(t) \\rangle\n$$\nThis is the general first-order linear ordinary differential equation (ODE) for the ensemble-averaged position $\\langle x(t) \\rangle$. We now solve this equation for the two specified protocols with the initial condition $\\langle x(0) \\rangle = 0$.\n\n**1. Constant Force Steering**\n\nFor this protocol, the external force is a constant, $f_{\\mathrm{ext}}(t) = F_{0}$. This force term is independent of the coordinate $x$, so its ensemble average is simply $\\langle f_{\\mathrm{ext}}(t) \\rangle = F_{0}$. The ODE for $\\langle x(t) \\rangle$ becomes:\n$$\n\\gamma \\frac{d\\langle x \\rangle}{dt} + k_a \\langle x \\rangle = F_0\n$$\nThis is a first-order linear inhomogeneous ODE. The general solution is the sum of the homogeneous solution $\\langle x_h(t) \\rangle$ and a particular solution $\\langle x_p(t) \\rangle$. The homogeneous equation is $\\gamma \\frac{d\\langle x_h \\rangle}{dt} + k_a \\langle x_h \\rangle = 0$, which has the solution $\\langle x_h(t) \\rangle = C \\exp\\left(-\\frac{k_a}{\\gamma}t\\right)$, where $C$ is a constant. For the particular solution, since the right-hand side is a constant, we try a constant solution $\\langle x_p(t) \\rangle = A$. Substituting this into the ODE gives $k_a A = F_0$, so $A = \\frac{F_0}{k_a}$.\nThe general solution is:\n$$\n\\langle x(t) \\rangle = C \\exp\\left(-\\frac{k_a}{\\gamma}t\\right) + \\frac{F_0}{k_a}\n$$\nApplying the initial condition $\\langle x(0) \\rangle = 0$:\n$$\n0 = C \\exp(0) + \\frac{F_0}{k_a} \\implies C = -\\frac{F_0}{k_a}\n$$\nTherefore, the closed-form expression for $\\langle x(t) \\rangle$ under constant force steering is:\n$$\n\\langle x(t) \\rangle = \\frac{F_0}{k_a} \\left(1 - \\exp\\left(-\\frac{k_a}{\\gamma}t\\right)\\right)\n$$\n\n**2. Constant Velocity Steering**\n\nFor this protocol, the external force is generated by a harmonic potential whose minimum moves at a constant velocity $v$, with $x_0(t) = vt$. The force is $f_{\\mathrm{ext}}(t) = -\\frac{\\partial}{\\partial x}\\left[\\frac{1}{2}k(x - x_0(t))^2\\right] = -k(x - vt)$. The force is linear in $x$, so its ensemble average is $\\langle f_{\\mathrm{ext}}(t) \\rangle = \\langle -k(x - vt) \\rangle = -k\\langle x(t) \\rangle + kvt$.\nSubstituting this into the general ODE for $\\langle x(t) \\rangle$:\n$$\n\\gamma \\frac{d\\langle x \\rangle}{dt} = -k_a \\langle x \\rangle - k\\langle x \\rangle + kvt\n$$\n$$\n\\gamma \\frac{d\\langle x \\rangle}{dt} + (k_a + k) \\langle x \\rangle = kvt\n$$\nThis is another first-order linear inhomogeneous ODE. Let $k_{tot} = k_a + k$. The homogeneous solution is $\\langle x_h(t) \\rangle = C \\exp\\left(-\\frac{k_{tot}}{\\gamma}t\\right)$. For the particular solution, we try a linear function of time, $\\langle x_p(t) \\rangle = At + B$. Substituting into the ODE:\n$$\n\\gamma A + k_{tot}(At+B) = kvt \\implies (k_{tot}A)t + (\\gamma A + k_{tot}B) = kvt\n$$\nEquating coefficients of powers of $t$:\n- $t^1: \\quad k_{tot}A = kv \\implies A = \\frac{kv}{k_{tot}} = \\frac{kv}{k_a+k}$\n- $t^0: \\quad \\gamma A + k_{tot}B = 0 \\implies B = -\\frac{\\gamma A}{k_{tot}} = -\\frac{\\gamma}{k_a+k} \\left( \\frac{kv}{k_a+k} \\right) = -\\frac{\\gamma k v}{(k_a+k)^2}$\nThe general solution is:\n$$\n\\langle x(t) \\rangle = C \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right) + \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\n$$\nApplying the initial condition $\\langle x(0) \\rangle = 0$:\n$$\n0 = C \\exp(0) + 0 - \\frac{\\gamma k v}{(k_a+k)^2} \\implies C = \\frac{\\gamma k v}{(k_a+k)^2}\n$$\nThus, the closed-form expression for $\\langle x(t) \\rangle$ under constant velocity steering is:\n$$\n\\langle x(t) \\rangle = \\frac{\\gamma k v}{(k_a+k)^2} \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right) + \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\n$$\nThis can be written more compactly as:\n$$\n\\langle x(t) \\rangle = \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n\n**3. Time-Dependent Lag $\\Delta(t)$**\n\nThe lag is defined as $\\Delta(t) \\equiv x_0(t) - \\langle x(t) \\rangle$. With $x_0(t) = vt$, we have:\n$$\n\\Delta(t) = vt - \\left( \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right] \\right)\n$$\n$$\n\\Delta(t) = \\left( v - \\frac{kv}{k_a+k} \\right)t + \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n$$\n\\Delta(t) = \\frac{v(k_a+k) - kv}{k_a+k}t + \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\nThe closed-form expression for the lag $\\Delta(t)$ is:\n$$\n\\Delta(t) = \\frac{k_a v}{k_a+k}t + \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n\n**4. Numerical Evaluation of the Lag**\n\nWe are asked to evaluate $\\Delta(t^{\\ast})$ at $t^{\\ast} = 0.5\\,\\mathrm{ns}$ with the given parameters. First, we must ensure consistent units. We shall work in a system of units based on piconevtons ($\\mathrm{pN}$), nanometers ($\\mathrm{nm}$), and nanoseconds ($\\mathrm{ns}$).\nThe parameters are:\n- $k_{a} = 200\\,\\mathrm{pN/nm}$\n- $k = 100\\,\\mathrm{pN/nm}$\n- $v = 5\\,\\mathrm{nm/ns}$\n- $t^{\\ast} = 0.5\\,\\mathrm{ns}$\n- $\\gamma = 3.0 \\times 10^{-12}\\,\\mathrm{kg/s}$\n\nWe convert $\\gamma$ to our chosen units:\n$1\\,\\mathrm{kg} = 1\\,\\mathrm{N} \\cdot \\mathrm{s}^2/\\mathrm{m} = (10^{12}\\,\\mathrm{pN}) \\cdot (10^9\\,\\mathrm{ns})^2 / (10^9\\,\\mathrm{nm}) = 10^{21}\\,\\mathrm{pN} \\cdot \\mathrm{ns}^2/\\mathrm{nm}$.\n$1\\,\\mathrm{s} = 10^9\\,\\mathrm{ns}$.\nSo, $\\gamma = 3.0 \\times 10^{-12} \\frac{\\mathrm{kg}}{\\mathrm{s}} = 3.0 \\times 10^{-12} \\frac{10^{21}\\,\\mathrm{pN} \\cdot \\mathrm{ns}^2/\\mathrm{nm}}{10^9\\,\\mathrm{ns}} = 3.0\\,\\mathrm{pN} \\cdot \\mathrm{ns}/\\mathrm{nm}$.\n\nNow, we compute the components of the expression for $\\Delta(t^{\\ast})$:\n- $k_a+k = 200\\,\\mathrm{pN/nm} + 100\\,\\mathrm{pN/nm} = 300\\,\\mathrm{pN/nm}$.\nThe argument of the exponential is:\n$$\n\\frac{k_a+k}{\\gamma}t^{\\ast} = \\frac{300\\,\\mathrm{pN/nm}}{3.0\\,\\mathrm{pN \\cdot ns/nm}} \\times 0.5\\,\\mathrm{ns} = 100\\,\\mathrm{ns}^{-1} \\times 0.5\\,\\mathrm{ns} = 50\n$$\nThe first term in $\\Delta(t^{\\ast})$ is:\n$$\n\\frac{k_a v}{k_a+k}t^{\\ast} = \\frac{200\\,\\mathrm{pN/nm} \\times 5\\,\\mathrm{nm/ns}}{300\\,\\mathrm{pN/nm}} \\times 0.5\\,\\mathrm{ns} = \\frac{2}{3} \\times 5 \\times 0.5\\,\\mathrm{nm} = \\frac{5}{3}\\,\\mathrm{nm}\n$$\nThe coefficient of the second term is:\n$$\n\\frac{\\gamma k v}{(k_a+k)^2} = \\frac{(3.0\\,\\mathrm{pN \\cdot ns/nm}) (100\\,\\mathrm{pN/nm}) (5\\,\\mathrm{nm/ns})}{(300\\,\\mathrm{pN/nm})^2} = \\frac{1500}{90000}\\,\\mathrm{nm} = \\frac{1}{60}\\,\\mathrm{nm}\n$$\nCombining these parts to find $\\Delta(t^{\\ast})$:\n$$\n\\Delta(t^{\\ast}) = \\frac{5}{3}\\,\\mathrm{nm} + \\frac{1}{60}\\,\\mathrm{nm} \\left[1 - \\exp(-50)\\right]\n$$\nThe value of $\\exp(-50)$ is approximately $1.9 \\times 10^{-22}$, which is negligible. Therefore, the term in brackets is effectively $1$.\n$$\n\\Delta(t^{\\ast}) \\approx \\frac{5}{3}\\,\\mathrm{nm} + \\frac{1}{60}\\,\\mathrm{nm} = \\left(\\frac{100}{60} + \\frac{1}{60}\\right)\\,\\mathrm{nm} = \\frac{101}{60}\\,\\mathrm{nm}\n$$\nCalculating the numerical value:\n$$\n\\Delta(t^{\\ast}) \\approx 1.68333... \\,\\mathrm{nm}\n$$\nRounding to four significant figures, the lag is $1.683\\,\\mathrm{nm}$.",
            "answer": "$$\n\\boxed{1.683}\n$$"
        },
        {
            "introduction": "A central challenge in SMD is choosing a pulling speed $v$ that is slow enough to allow the system to relax, ensuring the process remains close to equilibrium, yet fast enough to be computationally feasible. This practice focuses on this trade-off by first deriving the system's characteristic relaxation time, $\\tau_{\\text{relax}}$ . You will then use this to establish a practical criterion for selecting a maximum pulling speed, a critical step in setting up physically meaningful SMD simulations.",
            "id": "3490247",
            "problem": "Consider a one-dimensional collective variable $\\xi$ describing a soft-material reaction coordinate in Steered Molecular Dynamics (SMD), where a harmonic steering potential of stiffness $k_{s}$ is attached to the system and its minimum is translated at a constant speed $v$ according to $\\lambda(t)=\\lambda_{0}+v t$. The underlying equilibrium free energy near a local minimum is well approximated by a quadratic form $U_{0}(\\xi)\\approx \\tfrac{1}{2}\\kappa_{0}(\\xi-\\xi_{\\mathrm{eq}})^{2}$ with curvature $\\kappa_{0}>0$. The dynamics of $\\xi$ are overdamped with scalar friction coefficient $\\gamma$ so that, in the high-friction limit, the equation of motion is the overdamped Langevin equation for the steered coordinate,\n$\\gamma\\,\\dot{\\xi}(t)=-\\partial_{\\xi}U_{0}(\\xi)-k_{s}\\big(\\xi-\\lambda(t)\\big)+\\zeta(t)$,\nwhere $\\zeta(t)$ is a zero-mean Gaussian noise representing thermal fluctuations. Assume linear response about the minimum and focus on deterministic relaxation (i.e., analyze the mean dynamics, ignoring fluctuations).\n\n1. Starting from the above equation and the quadratic approximation of $U_{0}(\\xi)$, derive the linear ordinary differential equation governing the deviation of $\\xi$ from its instantaneous steady state under a fixed trap position and identify the overdamped relaxation time $\\tau_{\\mathrm{relax}}$ of the steered coordinate in terms of $\\gamma$, $\\kappa_{0}$, and $k_{s}$.\n\n2. For a system characterized by $\\gamma=2.0\\times 10^{4}\\ \\mathrm{pN\\cdot ps/nm}$, $\\kappa_{0}=2.0\\times 10^{2}\\ \\mathrm{pN/nm}$, and $k_{s}=1.0\\times 10^{3}\\ \\mathrm{pN/nm}$, compute the numerical value of $\\tau_{\\mathrm{relax}}$.\n\n3. To maintain near-equilibrium conditions during pulling, impose the criterion $v\\,\\tau_{\\mathrm{relax}}\\ll \\Delta \\xi$ by enforcing a safety factor $\\epsilon=0.10$ via the equality $v\\,\\tau_{\\mathrm{relax}}=\\epsilon\\,\\Delta \\xi$. Given a characteristic length scale $\\Delta \\xi=1.0\\times 10^{-1}\\ \\mathrm{nm}$, determine the maximum pulling speed $v_{\\max}$ that satisfies this near-equilibrium criterion.\n\nExpress the final answer as the numerical value of $v_{\\max}$ in $\\mathrm{nm/ps}$, rounded to four significant figures. Only $v_{\\max}$ is to be reported as the final answer.",
            "solution": "The appropriate starting point for the dynamics of a steered collective variable in the overdamped regime is the overdamped Langevin equation, which encodes force balance between viscous drag, conservative forces, and thermal noise. In one dimension for the collective variable $\\xi$, this reads\n$\\gamma\\,\\dot{\\xi}(t)=-\\partial_{\\xi}U_{0}(\\xi)-k_{s}\\big(\\xi-\\lambda(t)\\big)+\\zeta(t)$,\nwhere $\\gamma$ is the scalar friction coefficient coupling velocity to viscous drag, and $U_{0}(\\xi)$ is the underlying conservative potential. Near a local minimum, $U_{0}(\\xi)$ may be approximated quadratically as $U_{0}(\\xi)\\approx \\tfrac{1}{2}\\kappa_{0}(\\xi-\\xi_{\\mathrm{eq}})^{2}$ with curvature $\\kappa_{0}>0$, so that $\\partial_{\\xi}U_{0}(\\xi)\\approx \\kappa_{0}(\\xi-\\xi_{\\mathrm{eq}})$.\n\nSubstituting the quadratic approximation and taking the mean (so that $\\langle \\zeta(t)\\rangle=0$) yields a linear deterministic equation for the mean coordinate, which we denote by $\\xi(t)$ for brevity:\n$\\gamma\\,\\dot{\\xi}(t)=-\\kappa_{0}\\big(\\xi(t)-\\xi_{\\mathrm{eq}}\\big)-k_{s}\\big(\\xi(t)-\\lambda(t)\\big)$.\nRearranging terms gives\n$\\gamma\\,\\dot{\\xi}(t)+(\\kappa_{0}+k_{s})\\,\\xi(t)=\\kappa_{0}\\,\\xi_{\\mathrm{eq}}+k_{s}\\,\\lambda(t)$.\nThis is a first-order inhomogeneous linear ordinary differential equation with constant coefficients. Its homogeneous part is\n$\\gamma\\,\\dot{\\xi}_{h}(t)+(\\kappa_{0}+k_{s})\\,\\xi_{h}(t)=0$,\nwhose solution is an exponential relaxation,\n$\\xi_{h}(t)=C\\,\\exp\\!\\big(-t/\\tau_{\\mathrm{relax}}\\big)$,\nwhere the time constant $\\tau_{\\mathrm{relax}}$ is given by the reciprocal of the homogeneous decay rate:\n$\\tau_{\\mathrm{relax}}=\\dfrac{\\gamma}{\\kappa_{0}+k_{s}}$.\nThis time constant characterizes the relaxation of deviations from the instantaneous steady state, independent of the particular driving protocol $\\lambda(t)$, because the homogeneous operator is set by the total curvature $\\kappa_{0}+k_{s}$.\n\nFor the given numerical parameters, $\\gamma=2.0\\times 10^{4}\\ \\mathrm{pN\\cdot ps/nm}$, $\\kappa_{0}=2.0\\times 10^{2}\\ \\mathrm{pN/nm}$, and $k_{s}=1.0\\times 10^{3}\\ \\mathrm{pN/nm}$, the sum of curvatures is\n$\\kappa_{0}+k_{s}=2.0\\times 10^{2}+1.0\\times 10^{3}=1.2\\times 10^{3}\\ \\mathrm{pN/nm}$.\nHence,\n$\\tau_{\\mathrm{relax}}=\\dfrac{2.0\\times 10^{4}\\ \\mathrm{pN\\cdot ps/nm}}{1.2\\times 10^{3}\\ \\mathrm{pN/nm}}=1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}$,\nthat is,\n$\\tau_{\\mathrm{relax}}=1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}$.\n\nTo ensure near-equilibrium pulling, we impose $v\\,\\tau_{\\mathrm{relax}}=\\epsilon\\,\\Delta \\xi$ with $\\epsilon=0.10$ as a safety factor and $\\Delta \\xi=1.0\\times 10^{-1}\\ \\mathrm{nm}$. Solving for the maximum admissible pulling speed gives\n$v_{\\max}=\\dfrac{\\epsilon\\,\\Delta \\xi}{\\tau_{\\mathrm{relax}}}$.\nSubstituting the numerical values,\n$v_{\\max}=\\dfrac{1.0\\times 10^{-1}\\times 1.0\\times 10^{-1}\\ \\mathrm{nm}}{1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}}=\\dfrac{1.0\\times 10^{-2}\\ \\mathrm{nm}}{1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}}$.\nRecognizing $1.666666\\ldots\\times 10^{1}=50/3$, we find\n$v_{\\max}=\\left(1.0\\times 10^{-2}\\right)\\times \\dfrac{3}{50}\\ \\mathrm{nm/ps}=6.0\\times 10^{-4}\\ \\mathrm{nm/ps}$.\nRounded to four significant figures and expressed in $\\mathrm{nm/ps}$, this is\n$v_{\\max}=6.000\\times 10^{-4}\\ \\mathrm{nm/ps}$.\n\nTherefore, the maximum pulling speed consistent with the specified near-equilibrium criterion is $6.000\\times 10^{-4}\\ \\mathrm{nm/ps}$.",
            "answer": "$$\\boxed{6.000\\times 10^{-4}}$$"
        },
        {
            "introduction": "Beyond simply driving a system between two states, SMD can be used as a powerful tool to probe the energetic landscape and dissipative properties of a system. This advanced practice explores the concept of hysteresis by analyzing the work done in a forward-and-reverse pulling cycle . You will derive the relationship between the total dissipated work and the pulling speed, demonstrating how data from such non-equilibrium simulations can be used to extract a fundamental material property, the friction coefficient $\\zeta$.",
            "id": "3490224",
            "problem": "Consider a one-dimensional overdamped coordinate subject to Steered Molecular Dynamics (SMD) pulling. The control parameter (trap center) is driven as a piecewise-constant-speed protocol: first forward at speed $v$ over a displacement $L$ and then immediately reversed at the same speed $v$ back to the origin. The system is harmonic with an effective stiffness $k$ and obeys overdamped dynamics with friction coefficient $\\zeta$. The conservative potential at time $t$ is $U(x,t)=\\tfrac{1}{2}k\\left(x-\\lambda(t)\\right)^{2}$ with $\\lambda(t)$ the externally imposed trap position. Assume initial equilibrium at $t=0$ with $\\lambda(0)=0$, and a forward pulling segment of duration $T=L/v$ followed immediately by a reverse segment of the same duration.\n\nStarting from the overdamped Langevin equation and the standard definition of thermodynamic work done by changing a control parameter, derive the mean dissipated work $\\langle W_{\\text{diss}}\\rangle$ for each segment in terms of $k$, $\\zeta$, $L$, and $v$, without assuming any limiting regime a priori. Then, by combining the forward and reverse segments into a full loop, express the hysteresis loop area (equal to the total dissipated work over the closed protocol) $\\mathcal{A}(v)$ as a function of $k$, $\\zeta$, $L$, and $v$. Use a small-$v$ expansion to determine how $\\mathcal{A}(v)$ scales with $v$ and identify the leading-order coefficient. Based on this, design a linear-regression analysis to extract $\\zeta$ from the slope $s$ of the mean dissipated work versus speed at small $v$ for fixed $L$. Specifically, define an estimator $\\hat{\\zeta}=s/(2L)$ valid in the linear-response regime.\n\nYour task is to implement a complete, runnable program that:\n- Computes the exact mean hysteresis area $\\mathcal{A}(v)$ for each specified $v$ using your derived expressions, for each test-case parameter set below.\n- Performs an ordinary least squares fit of $\\mathcal{A}(v)$ versus $v$ to obtain the slope $s$ and then computes $\\hat{\\zeta}=s/(2L)$ for that test case.\n- Aggregates the results across all test cases and prints them as a single line containing a comma-separated list of floats in square brackets. Each float must be the estimated friction coefficient $\\hat{\\zeta}$ expressed in pN路ps/nm, rounded to six decimal places.\n\nAll quantities use the following units throughout: $k$ in pN/nm, $\\zeta$ in pN路ps/nm, $L$ in nm, $v$ in nm/ps, time in ps, and work in pN路nm. Angles are not involved. There are no percentages in this problem.\n\nTest suite of parameter sets:\n- Case $1$: $k=50$, $\\zeta=5$, $L=5$, $v\\in\\{0.02,0.04,0.06,0.08\\}$.\n- Case $2$: $k=10$, $\\zeta=1$, $L=10$, $v\\in\\{0.005,0.01,0.02\\}$.\n- Case $3$: $k=200$, $\\zeta=20$, $L=1$, $v\\in\\{0.5,1.0,2.0\\}$.\n- Case $4$: $k=30$, $\\zeta=3$, $L=0.5$, $v\\in\\{0.01,0.02,0.05,0.1\\}$.\n\nYour program should produce a single line of output containing the estimated frictions for Cases $1$ through $4$ in order, as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places in pN路ps/nm (e.g., \"[$\\hat{\\zeta}_1,\\hat{\\zeta}_2,\\hat{\\zeta}_3,\\hat{\\zeta}_4$]\" but printed as plain numbers without units). No other output should be produced.",
            "solution": "The user-provided problem has been evaluated and is determined to be **valid**. It is scientifically grounded in non-equilibrium statistical mechanics, is well-posed with a complete and consistent set of parameters, and is expressed in objective, formal language. The task is to derive the mean dissipated work in a cycle for a harmonically trapped particle under a specific pulling protocol and then to implement a numerical analysis based on the derived expression.\n\nThe derivation proceeds as follows.\n\n**1. Equation of Motion and Mean Position**\n\nThe system is described by a one-dimensional coordinate $x$ governed by the overdamped Langevin equation:\n$$ \\zeta \\frac{dx}{dt} = -\\frac{\\partial U(x,t)}{\\partial x} + \\eta(t) $$\nwhere $\\zeta$ is the friction coefficient, $\\eta(t)$ is a thermal noise term with $\\langle \\eta(t) \\rangle = 0$, and the potential is $U(x,t) = \\frac{1}{2}k(x-\\lambda(t))^2$. The conservative force is $-\\frac{\\partial U}{\\partial x} = -k(x-\\lambda(t))$.\n\nAveraging the Langevin equation over noise realizations yields an equation for the mean position $\\langle x(t) \\rangle$:\n$$ \\zeta \\frac{d\\langle x \\rangle}{dt} = -k(\\langle x \\rangle - \\lambda(t)) $$\nThis can be written in terms of the relaxation time $\\tau_R = \\zeta/k$ as:\n$$ \\frac{d\\langle x \\rangle}{dt} + \\frac{1}{\\tau_R} \\langle x \\rangle = \\frac{1}{\\tau_R} \\lambda(t) $$\nThe problem defines the lag between the mean position and the trap center as $\\delta(t) = \\langle x(t) \\rangle - \\lambda(t)$. Differentiating $\\delta(t)$ with respect to time leads to a direct equation for the lag:\n$$ \\frac{d\\delta}{dt} = \\frac{d\\langle x \\rangle}{dt} - \\frac{d\\lambda}{dt} = \\frac{1}{\\tau_R}(\\lambda(t) - \\langle x(t) \\rangle) - \\dot{\\lambda}(t) = -\\frac{1}{\\tau_R}\\delta(t) - \\dot{\\lambda}(t) $$\n$$ \\frac{d\\delta}{dt} + \\frac{1}{\\tau_R}\\delta(t) = -\\dot{\\lambda}(t) $$\n\n**2. Mean Work and Dissipated Work**\n\nThe work done on the system by the external protocol is given by:\n$$ W = \\int \\frac{\\partial U}{\\partial\\lambda} \\dot{\\lambda}(t) dt = \\int -k(x(t)-\\lambda(t))\\dot{\\lambda}(t) dt $$\nThe mean work is obtained by averaging over the noise:\n$$ \\langle W \\rangle = \\int -k(\\langle x(t) \\rangle - \\lambda(t))\\dot{\\lambda}(t) dt = \\int -k\\delta(t)\\dot{\\lambda}(t) dt $$\nThe mean dissipated work is $\\langle W_{\\text{diss}} \\rangle = \\langle W \\rangle - \\Delta F$, where $\\Delta F$ is the change in the system's equilibrium free energy. For a harmonic potential, the free energy is independent of the trap position $\\lambda$. Thus, $\\Delta F = 0$ for any process, and $\\langle W_{\\text{diss}} \\rangle = \\langle W \\rangle$.\n\n**3. Forward Pulling Segment ($0 \\le t \\le T$)**\n\nFor the forward segment, the trap moves from $\\lambda=0$ to $\\lambda=L$ at constant speed $v$. Thus, $\\lambda(t) = vt$ and $\\dot{\\lambda}(t)=v$. The duration is $T=L/v$. The system starts at equilibrium, so $\\langle x(0) \\rangle=0$ and $\\lambda(0)=0$, which implies an initial lag of $\\delta(0)=0$. The ODE for the forward lag $\\delta_F(t)$ is:\n$$ \\frac{d\\delta_F}{dt} + \\frac{1}{\\tau_R}\\delta_F = -v $$\nWith the initial condition $\\delta_F(0)=0$, the solution is:\n$$ \\delta_F(t) = -v\\tau_R(1 - e^{-t/\\tau_R}) $$\nThe mean work for the forward segment is:\n$$ \\langle W_F \\rangle = \\int_0^T -k\\delta_F(t)v dt = kv\\int_0^T v\\tau_R(1-e^{-t/\\tau_R})dt = kv^2\\tau_R \\left[t+\\tau_Re^{-t/\\tau_R}\\right]_0^T $$\n$$ \\langle W_F \\rangle = kv^2\\tau_R \\left(T - \\tau_R(1-e^{-T/\\tau_R})\\right) $$\nSubstituting $T=L/v$ and $\\tau_R=\\zeta/k$:\n$$ \\langle W_F \\rangle = \\zeta v L - \\frac{\\zeta^2v^2}{k}\\left(1-e^{-kL/(v\\zeta)}\\right) $$\n\n**4. Reverse Pulling Segment ($T \\le t \\le 2T$)**\n\nFor the reverse segment, the trap moves from $\\lambda=L$ back to $\\lambda=0$ at speed $v$. Let $t' = t-T$ for $0 \\le t' \\le T$. Then $\\lambda(t') = L-vt'$ and $\\dot{\\lambda}(t')=-v$. The ODE for the reverse lag $\\delta_R(t')$ is:\n$$ \\frac{d\\delta_R}{dt'} + \\frac{1}{\\tau_R}\\delta_R = v $$\nThe initial condition for this segment is the final state of the forward segment: $\\delta_R(t'=0) = \\delta_F(t=T) = -v\\tau_R(1-e^{-T/\\tau_R})$. The solution is:\n$$ \\delta_R(t') = \\left(\\delta_R(0) - v\\tau_R\\right)e^{-t'/\\tau_R} + v\\tau_R = \\left(-2v\\tau_R + v\\tau_Re^{-T/\\tau_R}\\right)e^{-t'/\\tau_R} + v\\tau_R $$\nThe mean work for the reverse segment is:\n$$ \\langle W_R \\rangle = \\int_0^T -k\\delta_R(t')(-v) dt' = kv\\int_0^T \\delta_R(t') dt' $$\nEvaluating the integral gives:\n$$ \\int_0^T \\delta_R(t')dt' = v\\tau_R \\left[ T - 2\\tau_R + 3\\tau_Re^{-T/\\tau_R} - \\tau_R e^{-2T/\\tau_R} \\right] $$\nSo the work is:\n$$ \\langle W_R \\rangle = kv^2\\tau_R \\left( T - \\tau_R(2 - 3e^{-T/\\tau_R} + e^{-2T/\\tau_R}) \\right) $$\nSubstituting $T=L/v$ and $\\tau_R=\\zeta/k$:\n$$ \\langle W_R \\rangle = \\zeta v L - \\frac{\\zeta^2v^2}{k}\\left(2 - 3e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)}\\right) $$\n\n**5. Hysteresis Loop Area and Linear Response**\n\nThe total dissipated work over the closed loop, which equals the hysteresis area $\\mathcal{A}(v)$, is the sum of the work done in the forward and reverse segments:\n$$ \\mathcal{A}(v) = \\langle W_F \\rangle + \\langle W_R \\rangle $$\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{\\zeta^2 v^2}{k} \\left( (1-e^{-kL/(v\\zeta)}) + (2 - 3e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)}) \\right) $$\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{\\zeta^2 v^2}{k} \\left( 3 - 4e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)} \\right) $$\nThis is the exact expression for the mean hysteresis area.\n\nFor the analysis, we consider the small speed limit ($v \\to 0$). In this limit, the argument of the exponentials $u = kL/(v\\zeta) \\to \\infty$, so $e^{-u} \\to 0$. The expression for $\\mathcal{A}(v)$ can be expanded for small $v$:\n$$ \\mathcal{A}(v) \\approx 2\\zeta v L - \\frac{3\\zeta^2}{k}v^2 + \\mathcal{O}(v^2e^{-u}) $$\nThe leading-order term is linear in $v$:\n$$ \\mathcal{A}(v) \\approx 2\\zeta L v $$\nThis linear relationship holds in the quasi-static or linear-response regime ($v \\ll kL/\\zeta$). The slope of $\\mathcal{A}(v)$ versus $v$ at $v=0$ is $s = 2\\zeta L$. This suggests an estimator for the friction coefficient $\\zeta$ based on a linear regression of experimental or simulation data of $\\mathcal{A}$ vs. $v$:\n$$ \\hat{\\zeta} = \\frac{s}{2L} $$\nwhere $s$ is the empirically determined slope.\n\nThe following program implements this analysis by first computing the exact hysteresis area $\\mathcal{A}(v)$ for a series of speeds $v$ and then performing an ordinary least squares fit to determine the slope $s$ and the estimate $\\hat{\\zeta}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Steered Molecular Dynamics problem by calculating the estimated\n    friction coefficient for several test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k, zeta_true, L, list_of_v)\n    test_cases = [\n        (50.0, 5.0, 5.0, [0.02, 0.04, 0.06, 0.08]),\n        (10.0, 1.0, 10.0, [0.005, 0.01, 0.02]),\n        (200.0, 20.0, 1.0, [0.5, 1.0, 2.0]),\n        (30.0, 3.0, 0.5, [0.01, 0.02, 0.05, 0.1]),\n    ]\n\n    results = []\n    for k, zeta_true, L, v_values in test_cases:\n        # Array of pulling speeds for the current test case\n        v_points = np.array(v_values, dtype=np.float64)\n        A_points = []\n\n        # Calculate the exact mean hysteresis area A(v) for each speed v\n        for v in v_points:\n            # The argument of the exponential terms\n            u = k * L / (v * zeta_true)\n            \n            # The exact expression for the hysteresis area A(v)\n            term_in_paren = 3.0 - 4.0 * np.exp(-u) + np.exp(-2.0 * u)\n            A_v = 2.0 * zeta_true * v * L - (zeta_true**2 * v**2 / k) * term_in_paren\n            A_points.append(A_v)\n\n        A_points = np.array(A_points, dtype=np.float64)\n        \n        # Perform Ordinary Least Squares (OLS) regression to find the slope s of A(v) vs v.\n        # The slope s is given by cov(v, A) / var(v).\n        v_mean = np.mean(v_points)\n        A_mean = np.mean(A_points)\n        \n        # Using a numerically stable formula for the slope\n        numerator = np.sum((v_points - v_mean) * (A_points - A_mean))\n        denominator = np.sum((v_points - v_mean)**2)\n        \n        if denominator == 0:\n            # This case occurs if all v_points are the same.\n            # While not in the test suite, it's good practice for robustness.\n            slope_s = 0.0\n        else:\n            slope_s = numerator / denominator\n\n        # Calculate the estimated friction coefficient zeta_hat from the slope\n        zeta_hat = slope_s / (2.0 * L)\n        results.append(zeta_hat)\n\n    # Final print statement in the exact required format.\n    # The output is a single line with a comma-separated list of floats in square brackets,\n    # with each float rounded to six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n\n```"
        }
    ]
}