{
    "hands_on_practices": [
        {
            "introduction": "我们将从计算 $Z_2$ 拓扑不变量最直接的方法入手，该方法适用于具有反演对称性的材料。这个练习将能带结构在高对称性点上的对称性特性与材料的拓扑分类联系起来，提供了一个具体的连接 。这是许多真实材料计算中执行的一项基本检查，可以帮助你掌握 Fu-Kane-Mele 判据的应用。",
            "id": "3497696",
            "problem": "一个中心对称的自 spin-orbit 耦合绝缘体由一个三维紧束缚哈密顿量建模，该模型建立在一个简单立方布拉维格子上，其原胞格矢沿笛卡尔坐标轴方向。体系同时具有时间反演对称性（TRS）和空间反演对称性。布里渊区中的八个时间反演不变动量点（TRIM）位于 $\\mathbf{k}=(n_{1}\\pi,n_{2}\\pi,n_{3}\\pi)$，其中 $n_{i}\\in\\{0,1\\}$。\n\n通过一个计算材料学工作流，您构建了保持对称性的最大局域化瓦尼尔函数，并在每个TRIM点对角化了哈密顿量，从而获得了四个已占据克拉默斯对在每个TRIM点的反演宇称本征值。对于这四个克拉默斯对，其宇称本征值在每个TRIM点被记为 $\\xi_1, \\xi_2, \\xi_3, \\xi_4$。其数值列表如下：\n\n- 在 $\\mathbf{k}=(0,0,0)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,+1,+1\\right)$。\n- 在 $\\mathbf{k}=(\\pi,0,0)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,+1,+1\\right)$。\n- 在 $\\mathbf{k}=(0,\\pi,0)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,-1,-1\\right)$。\n- 在 $\\mathbf{k}=(0,0,\\pi)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,-1,+1,-1\\right)$。\n- 在 $\\mathbf{k}=(\\pi,\\pi,0)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,-1,-1\\right)$。\n- 在 $\\mathbf{k}=(\\pi,0,\\pi)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,+1,-1\\right)$。\n- 在 $\\mathbf{k}=(0,\\pi,\\pi)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,-1,-1\\right)$。\n- 在 $\\mathbf{k}=(\\pi,\\pi,\\pi)$ 处：$\\left(\\xi_{1},\\xi_{2},\\xi_{3},\\xi_{4}\\right)=\\left(+1,+1,+1,+1\\right)$。\n\n仅使用给定的对称性（时间反演对称性和反演对称性）以及上述的宇称数据，计算强三维$\\mathbb{Z}_{2}$指标 $\\nu_{0}$ 和定义在垂直于原胞倒格矢的倒格平面上的三个弱指标 $\\left(\\nu_{1},\\nu_{2},\\nu_{3}\\right)$。以四个指标 $\\left(\\nu_{0},\\nu_{1},\\nu_{2},\\nu_{3}\\right)$ 的形式给出最终答案。无需四舍五入。最终答案没有物理单位，应表示为整数。",
            "solution": "任务是为一个具有时间反演对称性的中心对称绝缘体确定其强和弱三维$\\mathbb{Z}_{2}$拓扑不变量，分别用 $\\nu_{0}$ 和 $(\\nu_{1},\\nu_{2},\\nu_{3})$ 表示。计算基于在时间反演不变动量点（TRIMs）处已占据电子能带的宇称本征值。\n\n此计算的基本原理是针对中心对称体系的Fu-Kane-Mele判据。在此类体系中，$\\mathbb{Z}_{2}$不变量完全由已占据态的宇称本征值决定。该体系有4对已占据的克拉默斯对，意味着在每个晶体动量 $\\mathbf{k}$ 处有 $2 \\times 4 = 8$ 个已占据的电子能带。\n\n简单立方布里渊区中的八个TRIM由 $\\mathbf{k}_{(n_{1},n_{2},n_{3})} = (n_{1}\\pi, n_{2}\\pi, n_{3}\\pi)$ 给出，其中每个 $n_{i} \\in \\{0,1\\}$。对于这8个TRIM中的每一个，我们必须计算一个量 $\\delta(\\mathbf{k}_{*}) \\in \\{+1, -1\\}$。这个量由具有奇宇称（本征值为-1）的已占据克拉默斯对的数量决定。设 $N_{-}(\\mathbf{k}_{*})$ 为在TRIM点 $\\mathbf{k}_{*}$ 处宇称本征值为-1的已占据克拉默斯对的数量。$\\delta(\\mathbf{k}_{*})$ 的计算公式为：\n$$\n\\delta(\\mathbf{k}_{*}) = (-1)^{N_{-}(\\mathbf{k}_{*})}\n$$\n这等价于计算4个指定的克拉默斯对的宇称本征值 $\\xi_{m}$ 的乘积：\n$$\n\\delta(\\mathbf{k}_{*}) = \\prod_{m=1}^{4} \\xi_{m}(\\mathbf{k}_{*})\n$$\n因为偶数个-1的乘积是+1，奇数个-1的乘积是-1。\n\n我们现在使用给定的宇称数据为8个TRIM中的每一个计算 $\\delta(\\mathbf{k}_{*})$。\n\n1.  $\\mathbf{k}=(0,0,0)$: 宇称为 $(+1,+1,+1,+1)$。负宇称的数量为 $N_{-} = 0$。\n    $\\delta(0,0,0) = (-1)^{0} = +1$。\n\n2.  $\\mathbf{k}=(\\pi,0,0)$: 宇称为 $(+1,+1,+1,+1)$。负宇称的数量为 $N_{-} = 0$。\n    $\\delta(\\pi,0,0) = (-1)^{0} = +1$。\n\n3.  $\\mathbf{k}=(0,\\pi,0)$: 宇称为 $(+1,+1,-1,-1)$。负宇称的数量为 $N_{-} = 2$。\n    $\\delta(0,\\pi,0) = (-1)^{2} = +1$。\n\n4.  $\\mathbf{k}=(0,0,\\pi)$: 宇称为 $(+1,-1,+1,-1)$。负宇称的数量为 $N_{-} = 2$。\n    $\\delta(0,0,\\pi) = (-1)^{2} = +1$。\n\n5.  $\\mathbf{k}=(\\pi,\\pi,0)$: 宇称为 $(+1,+1,-1,-1)$。负宇称的数量为 $N_{-} = 2$。\n    $\\delta(\\pi,\\pi,0) = (-1)^{2} = +1$。\n\n6.  $\\mathbf{k}=(\\pi,0,\\pi)$: 宇称为 $(+1,+1,+1,-1)$。负宇称的数量为 $N_{-} = 1$。\n    $\\delta(\\pi,0,\\pi) = (-1)^{1} = -1$。\n\n7.  $\\mathbf{k}=(0,\\pi,\\pi)$: 宇称为 $(+1,+1,-1,-1)$。负宇称的数量为 $N_{-} = 2$。\n    $\\delta(0,\\pi,\\pi) = (-1)^{2} = +1$。\n\n8.  $\\mathbf{k}=(\\pi,\\pi,\\pi)$: 宇称为 $(+1,+1,+1,+1)$。负宇称的数量为 $N_{-} = 0$。\n    $\\delta(\\pi,\\pi,\\pi) = (-1)^{0} = +1$。\n\n在计算出所有TRIM的 $\\delta$ 值之后，我们现在可以计算 $\\mathbb{Z}_{2}$ 不变量。\n\n强拓扑指标 $\\nu_{0}$ 由所有8个TRIM的 $\\delta$ 值的乘积决定：\n$$\n(-1)^{\\nu_{0}} = \\prod_{n_{1},n_{2},n_{3} \\in \\{0,1\\}} \\delta(n_{1}\\pi, n_{2}\\pi, n_{3}\\pi)\n$$\n代入计算出的值：\n$$\n(-1)^{\\nu_{0}} = (+1) \\cdot (+1) \\cdot (+1) \\cdot (+1) \\cdot (+1) \\cdot (-1) \\cdot (+1) \\cdot (+1) = -1\n$$\n这意味着 $\\nu_{0} = 1$，表明该材料是一个强拓扑绝缘体。\n\n三个弱拓扑指标 $(\\nu_{1},\\nu_{2},\\nu_{3})$ 由位于平面 $k_j = \\pi$（其中 $j=1,2,3$）上的四个TRIM的 $\\delta$ 值的乘积决定：\n$$\n(-1)^{\\nu_{j}} = \\prod_{n_{j}=1, n_{i \\ne j} \\in \\{0,1\\}} \\delta(n_{1}\\pi, n_{2}\\pi, n_{3}\\pi)\n$$\n\n对于弱指标 $\\nu_{1}$，我们考虑平面 $k_x = \\pi$。相关的TRIM是 $(\\pi,0,0)$、$(\\pi,\\pi,0)$、$(\\pi,0,\\pi)$ 和 $(\\pi,\\pi,\\pi)$。\n$$\n(-1)^{\\nu_{1}} = \\delta(\\pi,0,0) \\cdot \\delta(\\pi,\\pi,0) \\cdot \\delta(\\pi,0,\\pi) \\cdot \\delta(\\pi,\\pi,\\pi)\n$$\n$$\n(-1)^{\\nu_{1}} = (+1) \\cdot (+1) \\cdot (-1) \\cdot (+1) = -1\n$$\n这意味着 $\\nu_{1} = 1$。\n\n对于弱指标 $\\nu_{2}$，我们考虑平面 $k_y = \\pi$。相关的TRIM是 $(0,\\pi,0)$、$(\\pi,\\pi,0)$、$(0,\\pi,\\pi)$ 和 $(\\pi,\\pi,\\pi)$。\n$$\n(-1)^{\\nu_{2}} = \\delta(0,\\pi,0) \\cdot \\delta(\\pi,\\pi,0) \\cdot \\delta(0,\\pi,\\pi) \\cdot \\delta(\\pi,\\pi,\\pi)\n$$\n$$\n(-1)^{\\nu_{2}} = (+1) \\cdot (+1) \\cdot (+1) \\cdot (+1) = +1\n$$\n这意味着 $\\nu_{2} = 0$。\n\n对于弱指标 $\\nu_{3}$，我们考虑平面 $k_z = \\pi$。相关的TRIM是 $(0,0,\\pi)$、$(\\pi,0,\\pi)$、$(0,\\pi,\\pi)$ 和 $(\\pi,\\pi,\\pi)$。\n$$\n(-1)^{\\nu_{3}} = \\delta(0,0,\\pi) \\cdot \\delta(\\pi,0,\\pi) \\cdot \\delta(0,\\pi,\\pi) \\cdot \\delta(\\pi,\\pi,\\pi)\n$$\n$$\n(-1)^{\\nu_{3}} = (+1) \\cdot (-1) \\cdot (+1) \\cdot (+1) = -1\n$$\n这意味着 $\\nu_{3} = 1$。\n\n结合这些结果，这组四个$\\mathbb{Z}_{2}$拓扑不变量是 $(\\nu_{0}, \\nu_{1}, \\nu_{2}, \\nu_{3})$。\n计算出的值为 $\\nu_{0}=1$，$\\nu_{1}=1$，$\\nu_{2}=0$ 和 $\\nu_{3}=1$。\n最终答案是元组 $(1, 1, 0, 1)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "宇称快捷方式虽然强大但有其局限性。当反演对称性破缺时我们应该怎么做？这个关键问题是本练习的核心 。我们将分析宇称方法失效的原因，并设计一种更通用的方法，该方法利用了威尔逊循环 (Wilson loop) 和瓦尼尔中心流 (Wannier center flow) 的概念，为大多数现代拓扑分析计算工具奠定了基础。",
            "id": "3497705",
            "problem": "一个二维时间反演对称（TRS）的绝缘体模型定义在方格晶格上，其单胞包含有自旋的电子和两个轨道。布洛赫哈密顿量 $H(\\mathbf{k})$ 满足时间反演（TR）对称性，其算符为作用于自旋的 $\\Theta = i s_y K$，$s_y$ 是自旋空间中的泡利矩阵，$K$ 代表复共轭。添加了一个与 $\\lambda_R$ 成正比的 Rashba 型自旋轨道耦合项，该项保持时间反演对称性但破坏了反演对称性。布里渊区（BZ）是一个由晶体动量 $\\mathbf{k}=(k_x,k_y)$ 参数化的环面，其中 $k_x,k_y \\in [0,2\\pi)$。\n\n要求您确定该模型中已占据能带流形的 $\\mathbb{Z}_2$ 拓扑指数 $\\nu$。在反演对称的极限 $\\lambda_R=0$ 下，Fu-Kane 宇称判据将 $\\nu$ 与时间反演不变动量点（TRIM）上已占据能带的宇称本征值联系起来。然而，当 $\\lambda_R \\neq 0$ 时，反演对称性被破坏。\n\n从以下基本依据和核心定义出发：\n\n- 时间反演（TR）对称性确保了在 TRIM 点上的 Kramers 简并，并意味着已占据流形的总第一陈数为零，$C=0$。\n- 已占据子空间的非阿贝尔贝里联络为 $A_{mn}(\\mathbf{k}) = -i \\langle u_m(\\mathbf{k}) | \\nabla_{\\mathbf{k}} | u_n(\\mathbf{k}) \\rangle$，其中 $|u_n(\\mathbf{k})\\rangle$ 是张成 $N_{\\mathrm{occ}}$ 维已占据子空间的元胞周期布洛赫本征态。\n- 沿 $\\mathbf{k}$ 空间中路径 $\\mathcal{C}$ 的非阿贝尔威尔逊循环定义为路径排序指数 $\\mathcal{W}_{\\mathcal{C}} = \\mathcal{P} \\exp\\left(i \\int_{\\mathcal{C}} A(\\mathbf{k}) \\cdot d\\mathbf{k}\\right)$，它是一个作用在已占据子空间内的幺正矩阵。其本征值为相位 $e^{i \\theta_n}$，其中 $\\theta_n \\in (-\\pi,\\pi]$，且与混合瓦尼尔中心相关。\n\n分析为何破坏反演对称性（$\\lambda_R \\neq 0$）会使宇称捷径方法失效，然后为此模型设计一种计算 $\\mathbb{Z}_2$ 指数 $\\nu$ 的替代性威尔逊循环方法。您的设计必须指明：\n\n- 在布里渊区（BZ）中适合计算规范不变的 $\\nu$ 的路径选择。\n- 在 $k_y=0$ 和 $k_y=\\pi$ 处的 TR 约束如何进入构造。\n- 从威尔逊循环谱中提取 $\\nu$ 时，计数的是什么（以及在什么参数区间上），以及为什么该计数在模 2 意义下是规范不变的。\n\n选择正确并完整描述有效设计，并为宇称捷径方法的失效提供理由的选项。每个选项描述一种建议的方法；有些选项可能包含微妙但致命的缺陷，导致结果非拓扑或规范依赖。\n\nA. 破坏反演对称性消除了 TRIM 点上已占据态的任何明确定义的宇称本征值，因此 Fu-Kane 宇称捷径方法无法应用。一个有效的替代方法是，在固定的 $k_y$ 下，沿着 $k_x$ 方向的非收缩环路计算已占据子空间的非阿贝尔威尔逊循环，即对于每个 $k_y \\in [0,\\pi]$，在一个在 $k_y=0$ 和 $k_y=\\pi$ 处与 TR 约束一致的光滑规范下（从而使 Kramers 对在这些线上正确匹配）计算 $\\mathcal{W}(k_y) = \\mathcal{P}\\exp\\left(i \\int_{0}^{2\\pi} A_x(k_x,k_y) \\, dk_x\\right)$。令 $e^{i\\theta_n(k_y)}$ 为 $\\mathcal{W}(k_y)$ 的本征值，并使其随 $k_y$ 连续排列。当 $k_y$ 从 $0$ 扫到 $\\pi$ 时，相位 $\\theta_n(k_y)$ 穿过一个固定参考角（例如 $\\theta=\\pi$）的总次数的奇偶性（模 2）即为 $\\mathbb{Z}_2$ 指数 $\\nu$。由于 TR 约束，这个穿过次数的奇偶性在模 2 意义下是规范不变的，并且等于 $\\nu$。\n\nB. 在没有反演对称性的情况下，可以转而计算在任意单个通用 $k_y$ 处的缝合矩阵 $B_{mn}(\\mathbf{k}) = \\langle u_m(-\\mathbf{k}) | \\Theta | u_n(\\mathbf{k}) \\rangle$，并计算当 $k_x$ 从 $0$ 环绕到 $2\\pi$ 时其本征值交换的奇偶性来获得 $\\nu$，而无需在 $k_y=0$ 和 $k_y=\\pi$ 处施加 TR 边界条件。\n\nC. 沿着布里渊区（BZ）中的任意可收缩环路（例如，围绕一个通用点的小圆）计算的威尔逊循环，其本征相位的环绕数奇偶性（在该环路上相对于一个固定的参考角计数）等于体 $\\mathbb{Z}_2$ 指数 $\\nu$，并且可以直接使用而无需扫描 $k_y$。\n\nD. 一种正确且更简单的替代方法是，对于 $k_y$ 在整个区间 $k_y \\in [0,2\\pi]$ 上的每个值，沿 $k_x$ 计算威尔逊循环，统计整个区间内相位穿过 $\\theta=\\pi$ 的总次数，并将 $\\nu$ 定义为此计数的一半，因为 TR 会使 $k_y \\in [\\pi,2\\pi]$ 的流动复制 $k_y \\in [0,\\pi]$ 的流动。\n\nE. 当反演对称性被破坏但绕 $z$ 轴的自旋旋转对称性保持不变时，计算自旋陈数 $C_s$ 作为自旋扇区的陈数之差，并设置 $\\nu = C_s \\bmod 2$；这对于上述 Rashba 微扰模型仍然有效。",
            "solution": "**Fu-Kane 宇称捷径方法的失效**\nFu-Kane 宇称判据提供了一种在同时具有时间反演和反演对称性的系统中计算 $\\mathbb{Z}_2$ 不变量 $\\nu$ 的方法。其公式为 $(-1)^\\nu = \\prod_{i} \\delta(K_i)$，其中乘积遍及二维 BZ 中的四个时间反演不变动量点（TRIM）$K_i$，而 $\\delta(K_i)$ 是在该 TRIM 点上已占据 Kramers 对的宇称本征值的乘积。此方法从根本上依赖于哈密顿量 $H(\\mathbf{k})$ 在 TRIM 点与反演算符 $P$ 对易：$[H(K_i), P] = 0$。这种对易关系使得布洛赫本征态 $|u_n(K_i)\\rangle$ 可以是宇称算符的同时本征态，具有明确定义的宇称本征值 $\\xi_n = \\pm 1$。问题指出引入了 Rashba 型项。一个通用的 Rashba 项会破坏反演对称性，这意味着哈密顿量不再与宇称算符对易，即对于一般的 $\\mathbf{k}$，$[H(\\mathbf{k}), P] \\neq 0$。因此，在 TRIM 点的本征态 $|u_n(K_i)\\rangle$ 不再是宇称本征态。由于宇称本征值对于这些态来说不再是明确定义的量，由这些本征值构成的 Fu-Kane 公式就变得不适用。\n\n**用于计算 $\\mathbb{Z}_2$ 指数的威尔逊循环方法**\n在缺乏反演对称性的情况下，需要一种更通用的、基于混合瓦尼尔中心演化的方法。这些中心是通过非阿贝尔威尔逊循环的本征值获得的。\n\n1.  **路径选择和威尔逊循环定义**：我们将 BZ 视为由 $(k_x, k_y)$ 参数化的环面。我们计算沿着一个非收缩方向（比如 $k_x$）的一族威尔逊循环，并由正交方向的动量 $k_y$ 来参数化。这个威尔逊循环是一个 $N_{\\mathrm{occ}} \\times N_{\\mathrm{occ}}$ 的幺正矩阵：\n    $$\n    \\mathcal{W}(k_y) = \\mathcal{P} \\exp\\left(i \\int_{0}^{2\\pi} A_x(k_x, k_y) \\, dk_x\\right)\n    $$\n    其中 $A_x = (A_x)_{mn} = -i \\langle u_m(\\mathbf{k}) | \\partial_{k_x} | u_n(\\mathbf{k}) \\rangle$ 是已占据能带的非阿贝尔贝里联络的 $x$ 分量。\n\n2.  **本征值和混合瓦尼尔中心**：幺正矩阵 $\\mathcal{W}(k_y)$ 的本征值是纯相位，我们将其写作 $e^{i\\theta_n(k_y)}$，其中 $n=1, \\dots, N_{\\mathrm{occ}}$。相位 $\\theta_n(k_y) \\in (-\\pi, \\pi]$ 被解释为混合瓦尼尔中心沿 $x$ 方向的位置，单位是晶格常数 $a_x/(2\\pi)$。集合 $\\{\\theta_n(k_y)\\}$ 构成了作为 $k_y$ 函数的瓦尼尔荷中心谱（或威尔逊循环谱）。\n\n3.  **时间反演对称性的作用**：TR 对称性 $\\Theta H(\\mathbf{k}) \\Theta^{-1} = H(-\\mathbf{k})$ 对瓦尼尔中心谱施加了关键约束。在 TR 不变线 $k_y=0$ 和 $k_y=\\pi$ 上，谱必须关于 $\\theta=0$（因此也关于 $\\theta=\\pi$）反射对称。也就是说，对于每个在 $\\theta_n$ 的瓦尼尔中心，必须有另一个在 $-\\theta_n$ 的中心存在。这是 Kramers 定理在瓦尼尔中心层面上的体现。\n\n4.  **计数程序和 $\\mathbb{Z}_2$ 不变量**：$\\mathbb{Z}_2$ 不变量 $\\nu$ 由瓦尼尔中心随 $k_y$ 从 $0$ 演化到 $\\pi$ 的“谱流”决定。在拓扑绝缘体中（$\\nu=1$），中心会交换伙伴。这种伙伴交换迫使谱线必须穿过整个 $(-\\pi, \\pi]$ 范围。一种简单且规范不变的检测方法是，计算当 $k_y$ 从 $0$ 扫到 $\\pi$ 时，任意谱线 $\\theta_n(k_y)$ 穿过某个固定参考线（比如 $\\theta=\\pi$）的次数。$\\mathbb{Z}_2$ 不变量是这个穿越次数的奇偶性：\n    $$\n    \\nu = \\left( \\sum_{n=1}^{N_{\\mathrm{occ}}} \\#\\{\\theta_n(k_y) \\text{ 在 } k_y \\in (0,\\pi) \\text{ 时穿过 } \\theta=\\pi \\text{ 的次数}\\} \\right) \\pmod 2\n    $$\n    在端点 $k_y=0$ 和 $k_y=\\pi$ 的 TR 约束确保了在不关闭体能隙的连续规范变换或哈密顿量形变下，穿越次数只能改变偶数个。这使得穿越次数的奇偶性成为一个鲁棒的、规范不变的拓扑不变量。\n\n**选项分析**\n\n**选项 A**：该选项正确地指出，破坏反演对称性使 Fu-Kane 宇称捷径方法失效，因为宇称本征值不再明确定义。然后它准确地描述了威尔逊循环方法：沿着 $k_x$ 方向的非收缩环路计算威尔逊循环 $\\mathcal{W}(k_y)$，然后将不变量 $\\nu$ 识别为当 $k_y$ 从 $0$ 扫到 $\\pi$ 时，本征相位 $\\theta_n(k_y)$ 穿过一个参考角的总次数的奇偶性。这个描述是对计算 $\\nu$ 的标准瓦尼尔中心流方法的完整而准确的总结。**结论：正确。**\n\n**选项 B**：该选项建议使用缝合矩阵 $B_{mn}(\\mathbf{k}) = \\langle u_m(-\\mathbf{k}) | \\Theta | u_n(\\mathbf{k}) \\rangle$ 在*单个通用* $k_y$ 切片上进行评估。这是不正确的。$\\mathbb{Z}_2$ 拓扑不变量是整个能带流形的属性。在单个通用切片上观察只提供局部信息，无法捕捉全局拓扑不变量。**结论：不正确。**\n\n**选项 C**：该选项建议沿着一个*可收缩*环路计算威尔逊循环。根据非阿贝尔斯托克斯定理，围绕一个可收缩环路的威尔逊循环与局域贝里曲率有关，它不能得到像 $\\nu$ 这样的全局拓扑不变量。$\\mathbb{Z}_2$ 不变量是 BZ 环面的非收缩周期的属性。**结论：不正确。**\n\n**选项 D**：该选项建议在整个区间 $k_y \\in [0,2\\pi]$ 上计算威尔逊循环谱，并取总穿越次数的一半。由于 TR 对称性，总穿越次数总是偶数。该不变量从根本上由穿越次数模 2 定义，即 $N_\\times \\pmod 2$，其中 $N_\\times$ 是在 $[0,\\pi]$ 中的穿越次数。该陈述省略了关键的“模 2”步骤，并在概念上不如标准定义直接。**结论：不正确。**\n\n**选项 E**：该选项建议使用自旋陈数 $C_s$。这种关系严格且仅当自旋分量 $S_z$ 是一个守恒量时，即 $[H, s_z]=0$ 时才成立。问题明确指出存在 Rashba 型项，它本质上混合了自旋态。因此，$S_z$ 不守恒，自旋陈数没有明确定义。**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实的材料计算常常呈现复杂的情景，其中我们感兴趣的能带在能量上与其他“平庸”能带纠缠在一起。这个高级练习将正面应对这一挑战，它要求你在计算拓扑不变量之前，先实现一个能带退纠缠程序 。这项实践模拟了一个从处理复杂数据到获得明确拓扑表征的完整工作流程，旨在磨练前沿研究所需的关键计算技能。",
            "id": "3497724",
            "problem": "实现一个完整、可运行的程序，该程序使用基于 Marzari–Vanderbilt 程序的解纠缠步骤，从纠缠能带中构建一个光滑的目标子空间，然后计算二维时间反演拓扑不变量（Z2 指数），以测试其在不同能量窗口下的稳定性。待研究的系统是一个具有时间反演对称性和已知非平庸相的方形晶格上的二维紧束缚模型，其中添加了一个额外的平庸、自旋简并的能带，使得在指定的能量窗口内，占据流形与平庸态发生纠缠。该问题必须在离散化的布里渊区 (BZ) 上，纯粹在倒易空间中求解，并且所有角度均以弧度处理。\n\n基本依据和定义：\n- 布洛赫哈密顿量是一个厄米矩阵 $H(\\mathbf{k})$，它平滑地依赖于晶体动量 $\\mathbf{k} = (k_x, k_y)$，并在布里渊区上满足周期性边界条件。\n- 动量 $\\mathbf{k}$ 处的子空间投影算符为 $P(\\mathbf{k}) = \\sum_{n=1}^{N} | u_{n}(\\mathbf{k}) \\rangle \\langle u_{n}(\\mathbf{k}) |$，其中 $\\{ | u_{n}(\\mathbf{k}) \\rangle \\}_{n=1}^{N}$ 是张成目标 N 维子空间的一组规范正交基。\n- Marzari–Vanderbilt 解纠缠方法在每个 $\\mathbf{k}$ 点，通过最大化其与一组 N 个试探类布洛赫态 $\\{ | g_{n} \\rangle \\}$ 的交叠，在指定能量窗口内选择一个 N 维子空间，这仅需对 $| g_{n} \\rangle$ 和能量窗口内的布洛赫本征矢量之间的交叠矩阵进行线性代数运算。具体而言，如果 $U_{\\text{win}}(\\mathbf{k})$ 将能量窗口内的本征矢量作为列向量收集，而 $G$ 将 N 个试探矢量作为列向量收集，那么对于 $A(\\mathbf{k}) = G^{\\dagger} U_{\\text{win}}(\\mathbf{k})$，最优子空间由 $U_{\\text{win}}(\\mathbf{k}) V_{N}(\\mathbf{k})$ 的列向量张成，其中 $V_{N}(\\mathbf{k})$ 收集了 $A(\\mathbf{k})$ 的前 N 个右奇异矢量。$U_{\\text{win}}(\\mathbf{k}) V_{N}(\\mathbf{k})$ 的规范正交化列向量为目标子空间构成了一个光滑规范。\n- 对于自旋-$\\frac{1}{2}$，时间反演算符是反幺正的，$\\Theta = \\mathrm{i} \\sigma_{y} \\mathcal{K}$，其中 $\\sigma_{y}$ 是泡利矩阵，$\\mathcal{K}$ 是复共轭。作用在一组基上，该基将每个轨道的自旋向上分量和自旋向下分量分组排列，$\\Theta$ 的幺正部分是 $\\mathrm{i} \\sigma_{y} \\otimes I_{\\text{orb}}$，其中 $I_{\\text{orb}}$ 是轨道空间中的单位矩阵。\n- 在时间反演不变动量点 (TRIM) $\\Lambda_{i}$ 处，对于一个选定的 N 维子空间，其缝合矩阵为 $w_{mn}(\\Lambda_{i}) = \\langle u_{m}(\\Lambda_{i}) | \\Theta | u_{n}(\\Lambda_{i}) \\rangle$。对于偶数 N，Fu–Kane 不变量使用乘积 $\\delta_{i} = \\sqrt{\\det[w(\\Lambda_{i})]} \\big/ \\operatorname{Pf}[w(\\Lambda_{i})]$，其中 $\\operatorname{Pf}$ 表示普法夫值。对于 N=2，$\\operatorname{Pf}[w] = w_{12}$ 且 $\\delta_{i} \\in \\{+1,-1\\}$。Z2 指数 $\\nu$ 由 $\\prod_{i} \\delta_{i}$ 的奇偶性给出：如果 $\\prod_{i} \\delta_{i} = -1$，则为非平庸绝缘体，指数为 1；如果 $\\prod_{i} \\delta_{i} = +1$，则为平庸绝缘体，指数为 0。\n\n模型与数值设置：\n- 考虑一个如下构建的 $6 \\times 6$ 布洛赫哈密顿量 $H(\\mathbf{k})$。设 $h(\\mathbf{k}) = d_{x}(\\mathbf{k}) \\sigma_{x} + d_{y}(\\mathbf{k}) \\sigma_{y} + d_{z}(\\mathbf{k}) \\sigma_{z}$，其中 $d_{x}(\\mathbf{k}) = A \\sin k_{x}$，$d_{y}(\\mathbf{k}) = A \\sin k_{y}$，$d_{z}(\\mathbf{k}) = M - 2 B \\left( 2 - \\cos k_{x} - \\cos k_{y} \\right)$。Bernevig–Hughes–Zhang 型的时间反演对称块是大小为 $4 \\times 4$ 的 $H_{\\text{BHZ}}(\\mathbf{k}) = \\operatorname{diag}\\{ h(\\mathbf{k}), h^{\\ast}(-\\mathbf{k}) \\}$。添加一个色散关系为 $E_{\\text{triv}}(\\mathbf{k}) = c + t \\left( \\cos k_{x} + \\cos k_{y} \\right)$ 的平庸、自旋简并的能带，作为一个在自旋子空间中与 $2 \\times 2$ 单位矩阵成比例的 $2 \\times 2$ 块。将基矢排序为 $\\{|E \\uparrow\\rangle, |H \\uparrow\\rangle, |T \\uparrow\\rangle, |E \\downarrow\\rangle, |H \\downarrow\\rangle, |T \\downarrow\\rangle\\}$，使得 $\\Theta$ 可以表示为 $\\mathrm{i} \\sigma_{y} \\otimes I_{3}$ 后跟复共轭操作。使用参数 $A = 1.0$, $B = 1.0$, $M = 2.0$, $c = -1.0$, $t = 0.3$。\n- 在一个 $N_{k_{x}} \\times N_{k_{y}}$ 的均匀网格上将布里渊区离散化，设置 $N_{k_{x}} = N_{k_{y}} = 20$，并使用 $k_{x} = 2 \\pi n_{x} / N_{k_{x}}$ 和 $k_{y} = 2 \\pi n_{y} / N_{k_{y}}$，其中整数 $n_{x}, n_{y} \\in \\{ 0, 1, \\dots, N_{k_{x}}-1 \\}$。\n\n解纠缠：\n- 目标子空间维度为 $N = 2$。选择两个固定的试探类布洛赫态 $|g_{1}\\rangle$ 和 $|g_{2}\\rangle$，使其分别等于 $|H \\uparrow\\rangle$ 和 $|H \\downarrow\\rangle$ 的基矢。将 $G = [ |g_{1}\\rangle, |g_{2}\\rangle ]$ 组装成一个 $6 \\times 2$ 的矩阵，其在相应位置上的元素为标准单位矢量。\n- 对于给定的能量窗口 $[E_{\\min}, E_{\\max}]$，在每个 $\\mathbf{k}$ 点，将 $H(\\mathbf{k})$ 在该窗口内本征值对应的本征矢量收集到 $U_{\\text{win}}(\\mathbf{k})$ 中。如果在任何 $\\mathbf{k}$ 点，窗口内的本征矢量数量少于 N，则声明该窗口计算失败。\n- 如果未失败，则计算交叠矩阵 $A(\\mathbf{k}) = G^{\\dagger} U_{\\text{win}}(\\mathbf{k})$，进行奇异值分解 $A(\\mathbf{k}) = U(\\mathbf{k}) \\Sigma(\\mathbf{k}) V^{\\dagger}(\\mathbf{k})$，保留 $V_{N}(\\mathbf{k})$ 中的前 N 个右奇异矢量以定义解纠缠后的基 $W(\\mathbf{k}) = U_{\\text{win}}(\\mathbf{k}) V_{N}(\\mathbf{k})$，并通过 QR 分解对 $W(\\mathbf{k})$ 进行规范正交化。投影算符为 $P(\\mathbf{k}) = W(\\mathbfk) W^{\\dagger}(\\mathbf{k})$，局域可投影性为 $p(\\mathbf{k}) = \\sum_{i=1}^{N} \\Sigma_{ii}^{2}(\\mathbf{k})$。窗口的质量度量为 $p_{\\min} = \\min_{\\mathbf{k}} p(\\mathbf{k})$。\n\n拓扑不变量：\n- 在网格上识别四个时间反演不变动量点 $\\Lambda_{i} \\in \\{ (0,0), (\\pi, 0), (0, \\pi), (\\pi, \\pi) \\}$。在每个 $\\Lambda_{i}$ 处，构建缝合矩阵 $w(\\Lambda_{i}) = W^{\\dagger}(\\Lambda_{i}) U_{\\Theta} W^{\\ast}(\\Lambda_{i})$，其中 $U_{\\Theta}$ 是 $\\Theta$ 在所选基下的幺正部分。对于 $N=2$，计算 $\\delta_{i} = \\sqrt{\\det[w(\\Lambda_{i})]} \\big/ \\operatorname{Pf}[w(\\Lambda_{i})]$，其中 $\\operatorname{Pf}[w] = w_{12}$。如果任何 $|\\operatorname{Im} \\delta_{i}|$ 超过一个小的容差，或 $|\\operatorname{Pf}[w(\\Lambda_{i})]|$ 低于一个容差，则声明不变量未定义。否则，设置 $(-1)^{\\nu} = \\prod_{i} \\delta_{i}$ 并输出 $Z_{2} = \\nu \\in \\{ 0, 1 \\}$。\n\n投影算符敏感度：\n- 定义一个使用指定参考窗口计算的参考投影算符场 $P_{\\text{ref}}(\\mathbf{k})$。对于任何其他未失败的窗口，对投影算符的敏感度是由 $2N$ 归一化的弗罗贝尼乌斯（Frobenius）差异的均方根（RMS）：\n$$\nS = \\sqrt{ \\frac{1}{N_{k_{x}} N_{k_{y}}} \\sum_{\\mathbf{k}} \\frac{\\| P(\\mathbf{k}) - P_{\\text{ref}}(\\mathbf{k}) \\|_{F}^{2}}{2 N} }.\n$$\n如果一个窗口计算失败，将其敏感度设置为约定值 $S = 0.5$。\n\n测试套件：\n- 使用以下能量窗口（所有能量单位与哈密顿量本征值的任意单位相同）：\n  1. $[E_{\\min}, E_{\\max}] = [-3.0, 0.0]$ (参考窗口).\n  2. $[E_{\\min}, E_{\\max}] = [-3.0, -0.6]$.\n  3. $[E_{\\min}, E_{\\max}] = [-1.2, -0.5]$.\n  4. $[E_{\\min}, E_{\\max}] = [-3.0, 0.5]$.\n- 对于每个窗口，程序必须输出一个三元组 $[Z_{2}, p_{\\min}, S]$，其中 $Z_{2}$ 是一个整数，对于非平庸情况取值为 1，对于平庸情况取值为 0，如果因失败而未定义则取值为 -1；$p_{\\min}$ 是一个在 $[0, N]$ 区间内的浮点数；$S$ 是一个在 $[0, 1]$ 区间内的浮点数，如果窗口如上定义失败，则 $S=0.5$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。列表中的每一项本身都是一个代表一个窗口的列表，其顺序与测试套件中的顺序相同，例如：“[[result1],[result2],[result3],[result4]]”。每个“result”必须是按顺序排列的三元素列表 $[Z_{2}, p_{\\min}, S]$。不允许有任何额外的文本或换行。",
            "solution": "该求解过程遵循以下步骤：\n1.  **哈密顿量构建**：在离散化的布里渊区 (BZ) 上的每个动量点 $\\mathbf{k}$，构建 $6 \\times 6$ 的布洛赫哈密顿量 $H(\\mathbf{k})$。指定的基矢排序 $\\{ |E \\uparrow\\rangle, |H \\uparrow\\rangle, |T \\uparrow\\rangle, |E \\downarrow\\rangle, |H \\downarrow\\rangle, |T \\downarrow\\rangle \\}$ 自然地将哈密顿量块对角化为自旋向上和自旋向下两个部分。\n    - 自旋向上块是一个作用于 $\\{ |E \\uparrow\\rangle, |H \\uparrow\\rangle, |T \\uparrow\\rangle \\}$ 的 $3 \\times 3$ 矩阵。其组成部分是 $2 \\times 2$ 的 Bernevig-Hughes-Zhang (BHZ) 矩阵 $h(\\mathbf{k}) = d_{x}(\\mathbf{k}) \\sigma_{x} + d_{y}(\\mathbf{k}) \\sigma_{y} + d_{z}(\\mathbf{k}) \\sigma_{z}$ 和平庸能带的能量 $E_{\\text{triv}}(\\mathbf{k})$。\n    - 类似地，自旋向下块作用于 $\\{ |E \\downarrow\\rangle, |H \\downarrow\\rangle, |T \\downarrow\\rangle \\}$，其组成部分为 $h^{\\ast}(-\\mathbf{k})$ 和 $E_{\\text{triv}}(\\mathbf{k})$。\n    - 这种构造遵循时间反演对称性约束 $\\Theta H(\\mathbf{k}) \\Theta^{-1} = H(-\\mathbf{k})$，其中算符为 $\\Theta = (i \\sigma_y \\otimes I_{3 \\times 3}) \\mathcal{K}$。\n\n2.  **能带解纠缠**：对于每个指定的能量窗口 $[E_{\\min}, E_{\\max}]$，在每个 $\\mathbf{k}$ 点应用以下程序：\n    - 求解 $H(\\mathbf{k})$ 的本征系统。将本征值落在窗口内的本征矢量收集到一个矩阵 $U_{\\text{win}}(\\mathbf{k})$ 中。如果找到的状态数少于 N=2，则声明失败。\n    - 使用 Marzari-Vanderbilt 方法来选择一个最优的 N=2 维子空间。这涉及到最大化与由 $|g_{1}\\rangle = |H \\uparrow\\rangle$ 和 $|g_{2}\\rangle = |H \\downarrow\\rangle$ 张成的试探子空间的交叠。该过程涉及对交叠矩阵 $A(\\mathbf{k}) = G^{\\dagger} U_{\\text{win}}(\\mathbf{k})$ 进行奇异值分解 (SVD)，其中 $G = [|g_1\\rangle, |g_2\\rangle]$。\n    - 使用 $A(\\mathbf{k})$ 的前 N=2 个右奇异矢量将 $U_{\\text{win}}(\\mathbf{k})$ 旋转到一个新的基 $W(\\mathbf{k})$，然后通过 QR 分解对其进行规范正交化。这就产生了一个张成目标子空间的光滑的布洛赫函数规范。\n    - 每个 $\\mathbf{k}$ 点的解纠缠质量由可投影性 $p(\\mathbf{k}) = \\sum_{i=1}^{N} \\Sigma_{ii}^2$ 来衡量，其中 $\\Sigma_{ii}$ 是奇异值。整个布里渊区上的最小值 $p_{\\min}$ 作为整个窗口的度量。\n\n3.  **$\\mathbb{Z}_2$ 不变量计算**：使用 Fu-Kane 公式计算 $\\mathbb{Z}_2$ 不变量 $\\nu$。\n    - 这需要在四个时间反演不变动量点 (TRIMs) $\\Lambda_i \\in \\{ (0,0), (\\pi, 0), (0, \\pi), (\\pi, \\pi) \\}$ 处计算缝合矩阵 $w(\\Lambda_i) = W(\\Lambda_i)^{\\dagger} U_{\\Theta} W(\\Lambda_i)^{\\ast}$。此处，$W(\\Lambda_i)$ 是一个 TRIM 处的两个规范正交解纠缠布洛赫函数构成的 $6 \\times 2$ 矩阵。\n    - 对于一个二维子空间，计算量 $\\delta_i = \\sqrt{\\det[w(\\Lambda_{i})]} / \\operatorname{Pf}[w(\\Lambda_{i})]$，其中普法夫值就是 $w_{12}$。由于时间反演对称性，$\\delta_i$ 的值必须为 $\\pm 1$。\n    - $\\mathbb{Z}_2$ 不变量由 $(-1)^{\\nu} = \\prod_{i} \\delta_i$ 给出。结果 $\\prod \\delta_i = -1$ 对应于非平庸拓扑绝缘体 ($\\nu=1$)，而 $\\prod \\delta_i = +1$ 对应于平庸拓扑绝缘体 ($\\nu=0$)。\n\n4.  **投影算符敏感度分析**：解纠缠子空间本身的稳定性通过其对能量窗口选择的敏感度来量化。\n    - 存储来自参考窗口 $[-3.0, 0.0]$ 的投影算符场 $P_{\\text{ref}}(\\mathbf{k})$。\n    - 对于每个后续窗口，计算与参考投影算符场的弗罗贝尼乌斯范数距离的均方根 (RMS)，即 $S = \\sqrt{\\langle \\| P(\\mathbf{k}) - P_{\\text{ref}}(\\mathbf{k}) \\|_{F}^{2} / (2N) \\rangle_{\\mathbf{k}}}$。\n    - 根据定义，参考窗口的 S=0，而任何失败的窗口都被赋 S=0.5。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs a smooth target subspace from entangled bands and evaluates the\n    Z2 topological invariant for a 2D tight-binding model.\n    \"\"\"\n    \n    # Model parameters\n    A = 1.0\n    B = 1.0\n    M = 2.0\n    c_param = -1.0\n    t_param = 0.3\n    \n    # Numerical setup\n    Nk = 20\n    N = 2  # Target subspace dimension\n    TOL = 1e-8 # Tolerance for numerical checks\n\n    # Test suite of energy windows\n    test_cases = [\n        [-3.0, 0.0],  # Reference window\n        [-3.0, -0.6],\n        [-1.2, -0.5],\n        [-3.0, 0.5],\n    ]\n\n    # Basis and operators\n    # Basis: { |E,up>, |H,up>, |T,up>, |E,down>, |H,down>, |T,down> }\n    # Trial states: |g1> = |H,up>, |g2> = |H,down>\n    G = np.zeros((6, 2), dtype=np.complex128)\n    G[1, 0] = 1.0\n    G[4, 1] = 1.0\n    \n    # Unitary part of the time-reversal operator\n    U_Theta = np.block([\n        [np.zeros((3, 3)), np.eye(3)],\n        [-np.eye(3), np.zeros((3, 3))]\n    ])\n\n    # Pauli matrices\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=np.complex128)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=np.complex128)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=np.complex128)\n\n    # Brillouin zone k-space grid\n    k_vals = np.linspace(0, 2 * np.pi, Nk, endpoint=False)\n    kx_grid, ky_grid = np.meshgrid(k_vals, k_vals)\n    k_points = np.stack([kx_grid.ravel(), ky_grid.ravel()], axis=1)\n\n    # Indices of the four Time-Reversal Invariant Momenta (TRIMs) on the flattened grid\n    trim_k_indices_flat = [\n        (0 * Nk + 0),\n        (0 * Nk + Nk // 2),\n        ((Nk // 2) * Nk + 0),\n        ((Nk // 2) * Nk + Nk // 2)\n    ]\n\n    def get_hamiltonian(kx, ky):\n        \"\"\"Constructs the 6x6 Bloch Hamiltonian matrix for a given k-point.\"\"\"\n        # d-vectors for h(k)\n        d_x = A * np.sin(kx)\n        d_y = A * np.sin(ky)\n        d_z = M - 2 * B * (2 - np.cos(kx) - np.cos(ky))\n        h_k = d_x * sigma_x + d_y * sigma_y + d_z * sigma_z\n\n        # h*(-k) for the spin-down block\n        h_star_mk = (\n            (A * np.sin(-kx)) * sigma_x.conj() +\n            (A * np.sin(-ky)) * sigma_y.conj() +\n            (M - 2 * B * (2 - np.cos(-kx) - np.cos(-ky))) * sigma_z.conj()\n        )\n\n        # Trivial band dispersion\n        E_triv = c_param + t_param * (np.cos(kx) + np.cos(ky))\n\n        # Assemble the full 6x6 Hamiltonian\n        H = np.zeros((6, 6), dtype=np.complex128)\n        H[0:2, 0:2] = h_k\n        H[2, 2] = E_triv\n        H[3:5, 3:5] = h_star_mk\n        H[5, 5] = E_triv\n        return H\n\n    results = []\n    p_ref_field = None\n\n    for i_case, (E_min, E_max) in enumerate(test_cases):\n        is_failed = False\n        p_k_list = []\n        w_ortho_trims = {}\n        \n        # Array to store projectors for sensitivity calculation\n        p_field = np.zeros((Nk * Nk, 6, 6), dtype=np.complex128)\n\n        for i_k, (kx, ky) in enumerate(k_points):\n            H = get_hamiltonian(kx, ky)\n            energies, evecs = np.linalg.eigh(H)\n\n            # Select eigenvectors within the energy window\n            win_indices = np.where((energies >= E_min)  (energies = E_max))[0]\n            \n            if len(win_indices)  N:\n                is_failed = True\n                break\n            \n            U_win = evecs[:, win_indices]\n\n            # Marzari-Vanderbilt disentanglement\n            A_k = G.conj().T @ U_win\n            _, s, vh = np.linalg.svd(A_k)\n            \n            p_k = np.sum(s[:N]**2)\n            p_k_list.append(p_k)\n\n            V_N = vh[:N, :].conj().T\n            W_k = U_win @ V_N\n            W_ortho, _ = np.linalg.qr(W_k)\n            \n            p_field[i_k, :, :] = W_ortho @ W_ortho.conj().T\n\n            if i_k in trim_k_indices_flat:\n                w_ortho_trims[i_k] = W_ortho\n        \n        if is_failed:\n            results.append([-1, 0.0, 0.5])\n            continue\n            \n        p_min = min(p_k_list)\n        \n        # Calculate Z2 topological invariant using Fu-Kane formula\n        z2_val = -1\n        try:\n            delta_prod = 1.0\n            for i_k in trim_k_indices_flat:\n                W = w_ortho_trims[i_k]\n                sewing_matrix = W.conj().T @ U_Theta @ W.conj()\n\n                pf = sewing_matrix[0, 1]\n                det_w = np.linalg.det(sewing_matrix)\n\n                if abs(pf)  TOL:\n                    raise ValueError(\"Pfaffian is near-zero; invariant undefined.\")\n\n                # Use principal square root\n                delta = np.sqrt(det_w) / pf\n                \n                if abs(delta.imag) > TOL:\n                    raise ValueError(\"Delta is not real; invariant undefined.\")\n                \n                delta_prod *= np.sign(delta.real)\n\n            z2_val = 1 if delta_prod  0 else 0\n        except (ValueError, KeyError):\n            z2_val = -1\n\n        # Store reference projector field from the first case\n        if i_case == 0:\n            p_ref_field = p_field.copy()\n\n        # Calculate sensitivity S\n        if i_case == 0:\n            S = 0.0\n        else:\n            # Frobenius norm squared is sum of abs(elements)**2\n            diff_sq_norm = np.sum(np.abs(p_field - p_ref_field)**2)\n            S = np.sqrt(diff_sq_norm / (Nk * Nk * (2 * N)))\n\n        results.append([z2_val, p_min, S])\n\n    # Format output to match problem specification\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        z2, pm, s_val = res\n        output_str += f\"[{z2},{pm:.6f},{s_val:.6f}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    print(output_str)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}