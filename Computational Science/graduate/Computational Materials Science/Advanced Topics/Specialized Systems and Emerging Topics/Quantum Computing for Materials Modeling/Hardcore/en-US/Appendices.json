{
    "hands_on_practices": [
        {
            "introduction": "Before simulating a material on a quantum computer, we must first translate its physical description into the language of qubits. This foundational exercise () challenges you to perform this translation for a generic crystalline solid, starting from a second-quantized electronic Hamiltonian. By determining how the number of required qubits and Hamiltonian terms scale with the system size, you will gain a first-principles appreciation for the immense computational complexity that quantum algorithms aim to overcome.",
            "id": "3481650",
            "problem": "Consider setting up a Variational Quantum Eigensolver (VQE) calculation for an interacting electron model of a crystalline solid represented in a localized orbital basis suitable for second quantization. The crystal has $N$ identical unit cells and $M$ localized spatial orbitals per unit cell. Assume spin degeneracy with no spin polarization so that each spatial orbital admits two spin states. You model the electrons with the standard second-quantized electronic Hamiltonian that includes all one-electron and two-electron terms over all spin-orbitals. Assume long-range Coulomb interactions are unscreened so that no two-electron integral vanishes by distance truncation, and do not exploit any point-group or translational symmetry to eliminate terms. You intend to use a fermion-to-qubit mapping in which each spin-orbital is mapped to one qubit.\n\nUnder these assumptions, do the following from first principles:\n- Determine the total number of spin-orbitals as a function of $N$ and $M$.\n- Define the Hamiltonian “size” as the total count of distinct operator monomials appearing in the second-quantized Hamiltonian prior to any mapping (i.e., the total number of index combinations in the one-body and two-body sums). Compute the leading-order dependence of this count on $N$ and $M$ by keeping only the highest-degree polynomial term in $N$ and $M$.\n\nExpress your final result as a row matrix with two entries $\\big[$total number of spin-orbitals, leading-order Hamiltonian term count in $N$ and $M\\big]$. No units are required. Provide exact expressions; no rounding is needed.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, well-posed, objective, and self-contained. The assumptions, such as neglecting symmetries and considering all potential interaction terms, are clearly stated for the purpose of a theoretical scaling analysis. We may therefore proceed with the derivation.\n\nThe problem asks for two quantities derived from a second-quantized description of an interacting electron model for a crystalline solid: the total number of spin-orbitals and the leading-order scaling of the number of terms in the electronic Hamiltonian.\n\n**1. Total Number of Spin-Orbitals**\n\nThe system is a crystalline solid comprising $N$ identical unit cells. Each unit cell contains $M$ localized spatial orbitals.\nThe total number of spatial orbitals in the crystal is the product of the number of unit cells and the number of spatial orbitals per cell.\nLet $N_{orb}$ be the total number of spatial orbitals.\n$$N_{orb} = N \\times M$$\nThe problem states to assume spin degeneracy, meaning each spatial orbital can be occupied by an electron with either spin-up ($\\sigma = +\\frac{1}{2}$, denoted $\\alpha$) or spin-down ($\\sigma = -\\frac{1}{2}$, denoted $\\beta$). Therefore, each spatial orbital gives rise to two distinct spin-orbitals.\nLet $N_{so}$ be the total number of spin-orbitals. This is the size of the basis set for the one-particle Fock space.\n$$N_{so} = N_{orb} \\times 2 = 2NM$$\nThis is the first required quantity.\n\n**2. Leading-Order Hamiltonian Term Count**\n\nThe general second-quantized electronic Hamiltonian for a system of interacting electrons is given by the sum of a one-body term and a two-body term:\n$$H = H_1 + H_2 = \\sum_{p,q=1}^{N_{so}} h_{pq} a_p^\\dagger a_q + \\frac{1}{2} \\sum_{p,q,r,s=1}^{N_{so}} v_{pqrs} a_p^\\dagger a_q^\\dagger a_r a_s$$\nwhere the indices $p, q, r, s$ run over all $N_{so}$ spin-orbitals. The term $a_p^\\dagger$ is the creation operator for an electron in spin-orbital $p$, and $a_q$ is the annihilation operator for an electron in spin-orbital $q$. The coefficients $h_{pq}$ are the one-electron integrals, and $v_{pqrs}$ are the two-electron integrals.\n\nThe problem defines the \"Hamiltonian size\" specifically as \"the total count of distinct operator monomials appearing in the second-quantized Hamiltonian prior to any mapping (i.e., the total number of index combinations in the one-body and two-body sums)\". We must adhere strictly to this definition. The problem also instructs not to exploit any symmetries to eliminate terms. This implies we should count the number of terms in the sums as written, without considering relations between coefficients (e.g., $h_{pq} = h_{qp}^*$) or operator strings (e.g., $a_p^\\dagger a_q^\\dagger = -a_q^\\dagger a_p^\\dagger$) that would typically be used to reduce the number of unique terms.\n\n**One-Body Term Count:**\nThe one-body part of the Hamiltonian is $H_1 = \\sum_{p,q=1}^{N_{so}} h_{pq} a_p^\\dagger a_q$.\nAccording to the problem's definition, we must count the number of index combinations for the pair $(p, q)$. Since both indices $p$ and $q$ run independently from $1$ to $N_{so}$, the total number of combinations is:\n$$ \\text{Count}_1 = N_{so} \\times N_{so} = N_{so}^2 $$\n\n**Two-Body Term Count:**\nThe two-body part of the Hamiltonian is $H_2 = \\frac{1}{2} \\sum_{p,q,r,s=1}^{N_{so}} v_{pqrs} a_p^\\dagger a_q^\\dagger a_r a_s$.\nWe count the number of index combinations for the 4-tuple $(p, q, r, s)$. Each of the four indices runs independently from $1$ to $N_{so}$. The total number of combinations is:\n$$ \\text{Count}_2 = N_{so} \\times N_{so} \\times N_{so} \\times N_{so} = N_{so}^4 $$\nThe prefactor of $\\frac{1}{2}$ in the Hamiltonian expression is a convention and does not affect the count of index combinations over which the sum is performed.\n\n**Total Count and Leading-Order Dependence:**\nThe total count of Hamiltonian terms, as defined, is the sum of the one-body and two-body counts:\n$$ \\text{Total Count} = \\text{Count}_1 + \\text{Count}_2 = N_{so}^2 + N_{so}^4 $$\nThe problem asks for the leading-order dependence of this count on $N$ and $M$. This corresponds to the term with the highest total power of $N$ and $M$. We substitute $N_{so} = 2NM$:\n$$ \\text{Total Count} = (2NM)^2 + (2NM)^4 = 4N^2M^2 + 16N^4M^4 $$\nThe term $4N^2M^2$ has a total degree of $2+2=4$. The term $16N^4M^4$ has a total degree of $4+4=8$. The leading-order term is therefore the one with the highest degree, which is $16N^4M^4$.\n\nThus, the leading-order dependence of the Hamiltonian term count on $N$ and $M$ is $16N^4M^4$.\n\n**Final Result Expression:**\nThe problem requires the final result to be expressed as a row matrix containing two entries: [total number of spin-orbitals, leading-order Hamiltonian term count in $N$ and $M$].\nThe two entries are $2NM$ and $16N^4M^4$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2NM  16N^{4}M^{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Variational Quantum Eigensolvers (VQE) find solutions by iteratively optimizing the parameters of a quantum circuit. This optimization is typically driven by gradients, and understanding how to compute them efficiently is paramount. In this practice (), you will derive the energy gradient for a simple yet representative ansatz using two key techniques: the analytic commutator-based method and the parameter-shift rule, allowing you to directly compare their implementation costs and statistical performance.",
            "id": "3481700",
            "problem": "Consider a minimal active-space model for a two-electron excitation relevant to computational materials science. After a Jordan–Wigner mapping and appropriate tapering of symmetries, the single-excitation subspace can be represented on two qubits with computational basis states $\\{|10\\rangle, |01\\rangle\\}$ corresponding to an electron localized in one of two spin-orbitals. Let the effective electronic Hamiltonian in this subspace be $H = \\frac{\\Delta}{2}\\,(Z_{0} - Z_{1})$, where $\\Delta  0$ is an orbital energy splitting, and $Z_{k}$ is the Pauli $Z$ operator on qubit $k$. Let the reference state be $|\\psi_{0}\\rangle = |10\\rangle$. Consider a Unitary Coupled-Cluster with Singles and Doubles (UCCSD) single-excitation generator mapped to the qubit operator\n$$\nP \\;=\\; \\frac{1}{2}\\bigl(X_{0} Y_{1} - Y_{0} X_{1}\\bigr),\n$$\nwhich is Hermitian, and define the one-parameter ansatz $U(\\theta) = \\exp\\!\\bigl(- i\\,\\theta\\,P\\bigr)$. The variational energy along this ansatz is $E(\\theta) = \\langle \\psi_{0} | U(\\theta)^{\\dagger} H\\, U(\\theta) | \\psi_{0} \\rangle$.\n\nYour tasks are:\n\n1. Starting from the definition of the variational energy and the product rule for differentiation of expectation values, derive from first principles the analytic expression for the energy gradient $\\frac{dE}{d\\theta}$ using commutator expansions. Express your final gradient in closed form as a function of $\\theta$ and $\\Delta$.\n\n2. Using the spectral properties of the Hermitian generator $P$ and standard gate differentiation from first principles, determine a valid parameter-shift value $s$ such that $\\frac{dE}{d\\theta}$ can be written exactly as a linear combination of energies $E(\\theta \\pm s)$, and present that expression. Then, compare the circuit depth required per gradient evaluation for:\n   - the commutator-based measurement of the gradient (by measuring the necessary Pauli-string observables on the state $U(\\theta)|\\psi_{0}\\rangle$),\n   - versus the parameter-shift method (by evaluating energies at shifted parameters).\n   For the commutator-based method, count only additional single-qubit basis-change rotations needed to measure the required Pauli strings $X_{0}X_{1}$ and $Y_{0}Y_{1}$ in the computational $Z$ basis; for the parameter-shift method, assume $H$ is measured directly in the computational basis without basis changes. Report the integer count of additional single-qubit rotations that the commutator-based evaluation requires relative to the parameter-shift evaluation for this two-qubit case.\n\n3. Under independent-shot sampling and assuming projective measurements, model the shot complexity by the variance of an unbiased estimator. Use the facts that for any Pauli string $O$ with eigenvalues $\\pm 1$, $\\mathrm{Var}(O) = 1 - \\langle O \\rangle^{2}$ on a pure state, and that for the Hamiltonian $H$ above in this subspace, $H^{2} = \\Delta^{2}\\,I$ so that $\\mathrm{Var}(H) = \\Delta^{2} - \\langle H \\rangle^{2}$. Compute the total number of shots required to achieve a gradient estimator variance $\\sigma_{g}^{2}$ for each method, assuming optimal equal allocation of shots across the two required measurements in each method. Then, provide the closed-form expression for the ratio $R_{\\mathrm{shots}}(\\theta)$ of total shots required by the parameter-shift method to those required by the commutator-based method, simplified as a function of $\\theta$ and $\\Delta$.\n\nAnswer format: Return a single row matrix with three entries using the LaTeX $\\mathrm{pmatrix}$ environment containing, in order: (i) the analytic gradient $\\frac{dE}{d\\theta}$, (ii) the shot-complexity ratio $R_{\\mathrm{shots}}(\\theta)$, and (iii) the integer count of additional single-qubit rotations needed by the commutator-based method relative to parameter-shift for this setup. No rounding is required and no units should be reported inside the final box.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. It represents a standard exercise in the study of variational quantum algorithms. I will now proceed with a complete solution.\n\nThe problem asks for three quantities related to the gradient of a variational energy for a two-qubit system. Let's address each part systematically.\n\nThe system is defined by:\n- The Hamiltonian: $H = \\frac{\\Delta}{2}\\,(Z_{0} - Z_{1})$\n- The reference state: $|\\psi_{0}\\rangle = |10\\rangle$\n- The ansatz generator: $P = \\frac{1}{2}\\bigl(X_{0} Y_{1} - Y_{0} X_{1}\\bigr)$\n- The variational state: $|\\psi(\\theta)\\rangle = U(\\theta)|\\psi_0\\rangle = \\exp(-i\\theta P)|\\psi_0\\rangle$\n- The variational energy: $E(\\theta) = \\langle \\psi(\\theta) | H | \\psi(\\theta) \\rangle$\n\nFirst, let's analyze the action of the generator $P$ on the relevant computational basis states, $|10\\rangle$ and $|01\\rangle$:\n$P|10\\rangle = \\frac{1}{2}\\bigl(X_{0} Y_{1} - Y_{0} X_{1}\\bigr)|10\\rangle = \\frac{1}{2}\\bigl(X_{0}(i|11\\rangle) - Y_{0}(|11\\rangle)\\bigr) = \\frac{1}{2}\\bigl(i|01\\rangle - (-i|01\\rangle)\\bigr) = i|01\\rangle$.\n$P|01\\rangle = \\frac{1}{2}\\bigl(X_{0} Y_{1} - Y_{0} X_{1}\\bigr)|01\\rangle = \\frac{1}{2}\\bigl(X_{0}(-i|00\\rangle) - Y_{0}(|00\\rangle)\\bigr) = \\frac{1}{2}\\bigl(-i|10\\rangle - (i|10\\rangle)\\bigr) = -i|10\\rangle$.\nThe subspace spanned by $\\{|10\\rangle, |01\\rangle\\}$ is invariant under $P$. In this subspace, with basis vectors ordered as $(|10\\rangle, |01\\rangle)$, $P$ has the matrix representation $\\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}$, which is the Pauli matrix $\\sigma_y$.\nSince $P^2$ acts as the identity in this subspace, we can use the identity $U(\\theta) = \\exp(-i\\theta P) = \\cos(\\theta)I - i\\sin(\\theta)P$.\nThe evolving state is $|\\psi(\\theta)\\rangle = (\\cos(\\theta)I - i\\sin(\\theta)P)|10\\rangle = \\cos(\\theta)|10\\rangle - i\\sin(\\theta)(i|01\\rangle) = \\cos(\\theta)|10\\rangle + \\sin(\\theta)|01\\rangle$.\n\n### Part 1: Analytic Gradient from Commutators\n\nThe variational energy is $E(\\theta) = \\langle \\psi_{0} | U(\\theta)^{\\dagger} H U(\\theta) | \\psi_{0} \\rangle$. The derivative with respect to $\\theta$ is:\n$$\n\\frac{dE}{d\\theta} = \\langle \\psi_{0} | \\left(\\frac{dU^{\\dagger}}{d\\theta}\\right) H U(\\theta) + U(\\theta)^{\\dagger} H \\left(\\frac{dU}{d\\theta}\\right) | \\psi_{0} \\rangle\n$$\nSince $U(\\theta) = \\exp(-i\\theta P)$, we have $\\frac{dU}{d\\theta} = -iP U(\\theta)$ and $\\frac{dU^{\\dagger}}{d\\theta} = iU(\\theta)^{\\dagger}P$. Substituting these gives:\n$$\n\\frac{dE}{d\\theta} = \\langle \\psi_{0} | iU(\\theta)^{\\dagger}P H U(\\theta) - iU(\\theta)^{\\dagger} H P U(\\theta) | \\psi_{0} \\rangle = i \\langle \\psi_{0} | U(\\theta)^{\\dagger} [P, H] U(\\theta) | \\psi_{0} \\rangle = i \\langle \\psi(\\theta) | [P, H] | \\psi(\\theta) \\rangle\n$$\nNext, we must compute the commutator $[P, H]$:\n$$\n[P, H] = \\left[ \\frac{1}{2}(X_0 Y_1 - Y_0 X_1), \\frac{\\Delta}{2}(Z_0 - Z_1) \\right] = \\frac{\\Delta}{4} \\left( [X_0 Y_1, Z_0 - Z_1] - [Y_0 X_1, Z_0 - Z_1] \\right)\n$$\nUsing the identity $[AB, C] = A[B,C] + [A,C]B$ and the Pauli algebra relations $[X,Z]=-2iY$ and $[Y,Z]=2iX$:\n$$\n[X_0 Y_1, Z_0 - Z_1] = [X_0, Z_0]Y_1 + X_0[Y_1, -Z_1] = (-2iY_0)Y_1 + X_0(-2iX_1) = -2i(Y_0 Y_1 + X_0 X_1)\n$$\n$$\n[Y_0 X_1, Z_0 - Z_1] = [Y_0, Z_0]X_1 + Y_0[X_1, -Z_1] = (2iX_0)X_1 + Y_0(2iY_1) = 2i(X_0 X_1 + Y_0 Y_1)\n$$\nSubstituting these into the expression for $[P,H]$:\n$$\n[P, H] = \\frac{\\Delta}{4} \\left( -2i(Y_0 Y_1 + X_0 X_1) - 2i(X_0 X_1 + Y_0 Y_1) \\right) = \\frac{\\Delta}{4} \\left( -4i(X_0 X_1 + Y_0 Y_1) \\right) = -i\\Delta(X_0 X_1 + Y_0 Y_1)\n$$\nNow, substitute this back into the expression for the gradient:\n$$\n\\frac{dE}{d\\theta} = i \\langle \\psi(\\theta) | (-i\\Delta(X_0 X_1 + Y_0 Y_1)) | \\psi(\\theta) \\rangle = \\Delta \\langle \\psi(\\theta) | (X_0 X_1 + Y_0 Y_1) | \\psi(\\theta) \\rangle\n$$\nTo evaluate the expectation value, we compute the action of the operator $(X_0 X_1 + Y_0 Y_1)$ on our state $|\\psi(\\theta)\\rangle$:\n$X_0 X_1 (\\cos\\theta|10\\rangle + \\sin\\theta|01\\rangle) = \\cos\\theta|01\\rangle + \\sin\\theta|10\\rangle$.\n$Y_0 Y_1 (\\cos\\theta|10\\rangle + \\sin\\theta|01\\rangle) = Y_0(i\\cos\\theta|11\\rangle -i\\sin\\theta|00\\rangle) = i(-i\\cos\\theta|01\\rangle) -i(i\\sin\\theta|10\\rangle) = \\cos\\theta|01\\rangle + \\sin\\theta|10\\rangle$.\nSo, $(X_0 X_1 + Y_0 Y_1)|\\psi(\\theta)\\rangle = 2(\\cos\\theta|01\\rangle + \\sin\\theta|10\\rangle)$.\nThe expectation value is:\n$$\n\\langle \\psi(\\theta) | (X_0 X_1 + Y_0 Y_1) | \\psi(\\theta) \\rangle = (\\cos\\theta\\langle 10| + \\sin\\theta\\langle 01|) \\cdot 2(\\cos\\theta|01\\rangle + \\sin\\theta|10\\rangle) = 2(\\cos\\theta\\sin\\theta + \\sin\\theta\\cos\\theta) = 4\\sin\\theta\\cos\\theta = 2\\sin(2\\theta)\n$$\nTherefore, the analytic gradient is:\n$$\n\\frac{dE}{d\\theta} = \\Delta (2\\sin(2\\theta)) = 2\\Delta\\sin(2\\theta)\n$$\n\n### Part 2: Parameter-Shift Rule and Circuit Depth\n\nThe generator $P$ acts as $\\sigma_y$ in the active subspace, so its eigenvalues are $\\pm 1$. A generator with two unique eigenvalues $\\pm \\lambda$ gives rise to a parameter-shift rule. For $U(\\theta)=\\exp(-i\\theta P)$, the gradient $\\frac{dE}{d\\theta} = i\\langle [P,H] \\rangle_\\theta$. The energy difference is $E(\\theta+s) - E(\\theta-s) = -i\\sin(2s\\lambda)\\langle [P,H]\\rangle_\\theta/\\lambda$. Here $\\lambda=1$. So $E(\\theta+s) - E(\\theta-s) = -i\\sin(2s)\\langle [P,H]\\rangle_\\theta$. Choosing a shift $s=\\pi/4$ gives $\\sin(2s)=1$, resulting in $E(\\theta+\\pi/4) - E(\\theta-\\pi/4) = -i\\langle [P,H]\\rangle_\\theta$.\nComparing with the gradient, $\\frac{dE}{d\\theta} = i \\langle [P, H] \\rangle_\\theta$, we find:\n$$\n\\frac{dE}{d\\theta} = E(\\theta+\\pi/4) - E(\\theta-\\pi/4)\n$$\nA valid parameter shift-value is thus $s = \\pi/4$.\n\nNow, we compare the circuit depth, measured by additional single-qubit rotations.\n- **Commutator method**: The gradient is $\\Delta(\\langle X_0X_1 \\rangle_\\theta + \\langle Y_0Y_1 \\rangle_\\theta)$. To measure $\\langle X_0X_1 \\rangle$, one must apply basis-change rotations to both qubits to map the $X$ basis to the $Z$ basis (e.g., $R_y(-\\pi/2)$ on each qubit), requiring $2$ single-qubit rotations. To measure $\\langle Y_0Y_1 \\rangle$, one must map the $Y$ basis to the $Z$ basis (e.g., $R_x(\\pi/2)$ on each qubit), requiring another $2$ rotations. The total is $2+2=4$ rotations.\n- **Parameter-shift method**: The gradient requires measuring $E(\\theta \\pm s)$. This involves measuring the Hamiltonian $H=\\frac{\\Delta}{2}(Z_0-Z_1)$, which consists only of Pauli $Z$ operators. Measurement can be performed directly in the computational basis without any basis-change rotations. The total is $0$ rotations.\n\nThe integer count of additional single-qubit rotations required by the commutator-based method relative to the parameter-shift method is $4 - 0 = 4$.\n\n### Part 3: Shot Complexity Ratio\n\nThe variance of an estimator for the gradient determines the number of shots required to achieve a target precision $\\sigma_g^2$. We assume optimal equal allocation of shots between the two measurements in each method.\n\n- **Commutator method**: $\\hat{g}_C = \\Delta(\\widehat{\\langle X_0X_1 \\rangle} + \\widehat{\\langle Y_0Y_1 \\rangle})$. Let $N_C$ be the total shots, with $N_C/2$ for each expectation value.\n$$\n\\mathrm{Var}(\\hat{g}_C) = \\Delta^2 \\mathrm{Var}(\\widehat{\\langle X_0X_1 \\rangle}) + \\Delta^2 \\mathrm{Var}(\\widehat{\\langle Y_0Y_1 \\rangle}) = \\Delta^2 \\frac{1-\\langle X_0X_1 \\rangle_\\theta^2}{N_C/2} + \\Delta^2 \\frac{1-\\langle Y_0Y_1 \\rangle_\\theta^2}{N_C/2}\n$$\nWe found $\\langle X_0X_1 \\rangle_\\theta = \\langle Y_0Y_1 \\rangle_\\theta = \\sin(2\\theta)$.\n$$\n\\mathrm{Var}(\\hat{g}_C) = \\frac{2\\Delta^2}{N_C}(1-\\sin^2(2\\theta)) + \\frac{2\\Delta^2}{N_C}(1-\\sin^2(2\\theta)) = \\frac{4\\Delta^2}{N_C}\\cos^2(2\\theta)\n$$\nSetting $\\mathrm{Var}(\\hat{g}_C) = \\sigma_g^2$, the required shots are $N_C = \\frac{4\\Delta^2\\cos^2(2\\theta)}{\\sigma_g^2}$.\n\n- **Parameter-shift method**: $\\hat{g}_{PS} = \\widehat{E(\\theta+s)} - \\widehat{E(\\theta-s)}$ with $s=\\pi/4$. Let $N_{PS}$ be the total shots.\n$$\n\\mathrm{Var}(\\hat{g}_{PS}) = \\mathrm{Var}(\\widehat{E(\\theta+s)}) + \\mathrm{Var}(\\widehat{E(\\theta-s)}) = \\frac{\\mathrm{Var}(H)_{\\theta+s}}{N_{PS}/2} + \\frac{\\mathrm{Var}(H)_{\\theta-s}}{N_{PS}/2}\n$$\nUsing $\\mathrm{Var}(H)_\\phi = \\Delta^2 - E(\\phi)^2$:\n$E(\\theta) = -\\Delta\\cos(2\\theta)$.\n$E(\\theta+s) = -\\Delta\\cos(2\\theta+\\pi/2) = \\Delta\\sin(2\\theta)$.\n$E(\\theta-s) = -\\Delta\\cos(2\\theta-\\pi/2) = -\\Delta\\sin(2\\theta)$.\nThe variances of the Hamiltonian measurements are:\n$\\mathrm{Var}(H)_{\\theta+s} = \\Delta^2 - (\\Delta\\sin(2\\theta))^2 = \\Delta^2\\cos^2(2\\theta)$.\n$\\mathrm{Var}(H)_{\\theta-s} = \\Delta^2 - (-\\Delta\\sin(2\\theta))^2 = \\Delta^2\\cos^2(2\\theta)$.\n$$\n\\mathrm{Var}(\\hat{g}_{PS}) = \\frac{\\Delta^2\\cos^2(2\\theta)}{N_{PS}/2} + \\frac{\\Delta^2\\cos^2(2\\theta)}{N_{PS}/2} = \\frac{4\\Delta^2\\cos^2(2\\theta)}{N_{PS}}\n$$\nSetting $\\mathrm{Var}(\\hat{g}_{PS}) = \\sigma_g^2$, the required shots are $N_{PS} = \\frac{4\\Delta^2\\cos^2(2\\theta)}{\\sigma_g^2}$.\n\nThe ratio of total shots $R_{\\mathrm{shots}}(\\theta)$ is:\n$$\nR_{\\mathrm{shots}}(\\theta) = \\frac{N_{PS}}{N_C} = \\frac{4\\Delta^2\\cos^2(2\\theta)/\\sigma_g^2}{4\\Delta^2\\cos^2(2\\theta)/\\sigma_g^2} = 1\n$$\nThis ratio is valid for $\\cos(2\\theta) \\ne 0$. When $\\cos(2\\theta)=0$, the gradient is at its maximum but the variance of both estimators is zero, implying zero shots are needed, which is an artifact of the pure-state, noise-free analysis.\n\n### Summary of Results\n1.  Analytic gradient $\\frac{dE}{d\\theta} = 2\\Delta\\sin(2\\theta)$.\n2.  Shot-complexity ratio $R_{\\mathrm{shots}}(\\theta) = 1$.\n3.  Additional rotations for commutator method: $4$.\n\nThese are assembled into the final answer matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\Delta\\sin(2\\theta)  1  4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The prohibitive scaling of quantum simulations can often be tamed by exploiting the physical symmetries of the material being modeled. This exercise () guides you through one of the most powerful examples of this principle: leveraging translational symmetry in a periodic crystal. By transforming the Hamiltonian into momentum space, you will see how a large, coupled problem can be decomposed into a set of smaller, independent simulations, drastically reducing the number of qubits required.",
            "id": "3481667",
            "problem": "Design and implement a complete, runnable program that formalizes a Variational Quantum Eigensolver (VQE) workflow for a one-dimensional periodic hydrogen chain by exploiting translational symmetry. Begin from the following first-principles base and core definitions.\n\nConsider a one-dimensional periodic chain of hydrogen atoms with $N$ unit cells, lattice constant $a$, one valence orbital per site, and spin degeneracy two. In second quantization with periodic boundary conditions (site indices modulo $N$), the tight-binding electronic Hamiltonian with on-site energy $\\epsilon$ and nearest-neighbor hopping amplitude $t$ is\n$$\nH \\;=\\; \\sum_{j=0}^{N-1} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\epsilon \\, \\hat{n}_{j,\\sigma} \\;-\\; t \\sum_{j=0}^{N-1} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( \\hat{c}_{j,\\sigma}^\\dagger \\hat{c}_{j+1,\\sigma} \\;+\\; \\hat{c}_{j+1,\\sigma}^\\dagger \\hat{c}_{j,\\sigma} \\right),\n$$\nwhere $\\hat{c}_{j,\\sigma}^\\dagger$ creates a spin-$\\sigma$ electron on site $j$ and $\\hat{n}_{j,\\sigma} = \\hat{c}_{j,\\sigma}^\\dagger \\hat{c}_{j,\\sigma}$. Define Bloch-adapted creation operators via the discrete Fourier transform (Bloch's theorem),\n$$\n\\hat{c}_{k,\\sigma}^\\dagger \\;=\\; \\frac{1}{\\sqrt{N}} \\sum_{j=0}^{N-1} e^{i k R_j} \\, \\hat{c}_{j,\\sigma}^\\dagger, \\quad R_j = j a, \\quad k_m = \\frac{2\\pi}{N a} m, \\; m \\in \\{0,1,\\dots,N-1\\}.\n$$\nUsing only the above base, derive the $k$-space Hamiltonian and show that it decomposes into independent crystal momentum sectors,\n$$\nH \\;=\\; \\sum_{k} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} E(k) \\, \\hat{n}_{k,\\sigma}, \\qquad E(k) = \\epsilon - 2 t \\cos(k a),\n$$\nwhere the cosine argument is in radians. For a Variational Quantum Eigensolver (VQE), one can simulate each $k$-sector separately by mapping fermionic number operators to qubits. Under the Jordan–Wigner (JW) transformation, each spin-orbital maps to one qubit, and the number operator maps as $\\hat{n} \\mapsto \\tfrac{1}{2} (I - Z)$. Therefore, the per-$k$ qubit requirement for this model is $Q_k = 2$ (one qubit per spin), while a naive real-space mapping without $k$-sector decomposition uses $Q_{\\text{full}} = 2 N$ qubits. Define the qubit savings due to $k$-tapering as $S = Q_{\\text{full}} - Q_k$ and the savings ratio as $r = S / Q_{\\text{full}}$.\n\nYour program must:\n- Construct the discrete crystal momentum grid $k_m = \\tfrac{2\\pi}{N a} m$ for each test case and compute the corresponding band energies $E(k_m) = \\epsilon - 2 t \\cos(k_m a)$, using radians for the cosine function.\n- Compute $Q_{\\text{full}} = 2 N$, $Q_k = 2$, $S = Q_{\\text{full}} - Q_k$, and $r = S/Q_{\\text{full}}$.\n- Report, for each test case, the minimum and maximum of the discrete band energies over the allowed $k$ values, denoted $E_{\\min}$ and $E_{\\max}$, respectively, expressed in electronvolts (eV).\n- Express all energies in electronvolts (eV), and use radians for all angles. Round $r$, $E_{\\min}$, and $E_{\\max}$ to six decimal places in the final output.\n\nTest Suite:\nProvide results for the following parameter sets $(N, a, \\epsilon, t)$, with $a$ in angstroms and $(\\epsilon, t)$ in electronvolts:\n- Case $1$: $(N, a, \\epsilon, t) = (8, 1.0, -0.3, 1.5)$.\n- Case $2$: $(N, a, \\epsilon, t) = (3, 1.4, 0.0, 1.0)$.\n- Case $3$ (boundary, zero hopping): $(N, a, \\epsilon, t) = (4, 1.2, -0.5, 0.0)$.\n- Case $4$ (larger system): $(N, a, \\epsilon, t) = (16, 0.74, -0.1, 2.0)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of per-case results. Each per-case result must be a list of the form $[Q_{\\text{full}}, Q_k, S, r, E_{\\min}, E_{\\max}]$, where $Q_{\\text{full}}$, $Q_k$, and $S$ are integers, and $r$, $E_{\\min}$, $E_{\\max}$ are decimal numbers rounded to six decimal places. Aggregate these per-case lists into one outer list, and print it as a single line, for example:\n$[[Q_{\\text{full}},Q_k,S,r,E_{\\min},E_{\\max}],\\dots]$.",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in the principles of solid-state physics and quantum computation, is well-posed with a complete set of definitions and parameters, and is expressed in objective, formal language. We may therefore proceed with a full solution.\n\nThe problem requires the analysis of a simplified one-dimensional periodic chain of hydrogen atoms, focusing on the computational resource savings in a Variational Quantum Eigensolver (VQE) context when translational symmetry is exploited. The core of the task is to derive the Hamiltonian in momentum space ($k$-space) and then use it to compute properties of the energy band structure for several parameter sets.\n\nFirst, we derive the $k$-space representation of the Hamiltonian from the given real-space (tight-binding) formulation. The real-space Hamiltonian is given by:\n$$ H \\;=\\; \\sum_{j=0}^{N-1} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\epsilon \\, \\hat{n}_{j,\\sigma} \\;-\\; t \\sum_{j=0}^{N-1} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( \\hat{c}_{j,\\sigma}^\\dagger \\hat{c}_{j+1,\\sigma} \\;+\\; \\hat{c}_{j+1,\\sigma}^\\dagger \\hat{c}_{j,\\sigma} \\right) $$\nHere, $j$ indexes the $N$ sites in the chain, $\\sigma$ is the spin, $\\epsilon$ is the on-site energy, and $t$ is the nearest-neighbor hopping amplitude. The operators $\\hat{c}_{j,\\sigma}^\\dagger$ and $\\hat{c}_{j,\\sigma}$ are the fermionic creation and annihilation operators for a spin-$\\sigma$ electron at site $j$, and $\\hat{n}_{j,\\sigma} = \\hat{c}_{j,\\sigma}^\\dagger \\hat{c}_{j,\\sigma}$ is the number operator.\n\nTo diagonalize this Hamiltonian, we apply a discrete Fourier transform to the fermionic operators, which is equivalent to moving to a basis of Bloch waves due to the system's translational symmetry. The Bloch-adapted creation operator is defined as:\n$$ \\hat{c}_{k,\\sigma}^\\dagger \\;=\\; \\frac{1}{\\sqrt{N}} \\sum_{j=0}^{N-1} e^{i k R_j} \\, \\hat{c}_{j,\\sigma}^\\dagger $$\nwhere $R_j = j a$ is the position of site $j$ and $k$ belongs to the discrete set of allowed crystal momenta in the first Brillouin zone, $k_m = \\frac{2\\pi m}{Na}$ for $m \\in \\{0, 1, \\dots, N-1\\}$. The inverse transform is:\n$$ \\hat{c}_{j,\\sigma}^\\dagger \\;=\\; \\frac{1}{\\sqrt{N}} \\sum_{k} e^{-i k R_j} \\, \\hat{c}_{k,\\sigma}^\\dagger, \\qquad \\hat{c}_{j,\\sigma} \\;=\\; \\frac{1}{\\sqrt{N}} \\sum_{k'} e^{i k' R_j} \\, \\hat{c}_{k',\\sigma} $$\n\nWe now substitute these into the Hamiltonian, term by term.\nThe on-site energy term becomes:\n$$ \\sum_{j,\\sigma} \\epsilon \\, \\hat{c}_{j,\\sigma}^\\dagger \\hat{c}_{j,\\sigma} \\;=\\; \\sum_{j,\\sigma} \\epsilon \\left( \\frac{1}{\\sqrt{N}} \\sum_{k} e^{-i k R_j} \\hat{c}_{k,\\sigma}^\\dagger \\right) \\left( \\frac{1}{\\sqrt{N}} \\sum_{k'} e^{i k' R_j} \\hat{c}_{k',\\sigma} \\right) $$\n$$ \\;=\\; \\frac{\\epsilon}{N} \\sum_{k,k',\\sigma} \\hat{c}_{k,\\sigma}^\\dagger \\hat{c}_{k',\\sigma} \\sum_{j=0}^{N-1} e^{i(k'-k)R_j} $$\nThe sum over $j$ is a geometric series that evaluates to $N \\delta_{k,k'}$. This orthogonality relation simplifies the expression:\n$$ \\frac{\\epsilon}{N} \\sum_{k,k',\\sigma} \\hat{c}_{k,\\sigma}^\\dagger \\hat{c}_{k',\\sigma} (N \\delta_{k,k'}) \\;=\\; \\sum_{k,\\sigma} \\epsilon \\, \\hat{c}_{k,\\sigma}^\\dagger \\hat{c}_{k,\\sigma} \\;=\\; \\sum_{k,\\sigma} \\epsilon \\, \\hat{n}_{k,\\sigma} $$\nThe on-site term is diagonal in the $k$-basis.\n\nNext, we transform the hopping term. Consider the first part, $\\sum_{j,\\sigma} \\hat{c}_{j,\\sigma}^\\dagger \\hat{c}_{j+1,\\sigma}$:\n$$ \\sum_{j,\\sigma} \\left( \\frac{1}{\\sqrt{N}} \\sum_{k} e^{-i k R_j} \\hat{c}_{k,\\sigma}^\\dagger \\right) \\left( \\frac{1}{\\sqrt{N}} \\sum_{k'} e^{i k' R_{j+1}} \\hat{c}_{k',\\sigma} \\right) $$\nUsing $R_{j+1} = R_j + a$, this becomes:\n$$ \\frac{1}{N} \\sum_{k,k',\\sigma} \\hat{c}_{k,\\sigma}^\\dagger \\hat{c}_{k',\\sigma} e^{i k' a} \\sum_{j=0}^{N-1} e^{i(k'-k)R_j} \\;=\\; \\frac{1}{N} \\sum_{k,k',\\sigma} \\hat{c}_{k,\\sigma}^\\dagger \\hat{c}_{k',\\sigma} e^{i k' a} (N \\delta_{k,k'}) \\;=\\; \\sum_{k,\\sigma} e^{i k a} \\hat{n}_{k,\\sigma} $$\nThe hermitian conjugate term, $\\sum_{j,\\sigma} \\hat{c}_{j+1,\\sigma}^\\dagger \\hat{c}_{j,\\sigma}$, yields $\\sum_{k,\\sigma} e^{-i k a} \\hat{n}_{k,\\sigma}$.\n\nCombining all terms, the full Hamiltonian is:\n$$ H \\;=\\; \\sum_{k,\\sigma} \\epsilon \\, \\hat{n}_{k,\\sigma} - t \\sum_{k,\\sigma} (e^{i k a} + e^{-i k a}) \\hat{n}_{k,\\sigma} \\;=\\; \\sum_{k,\\sigma} (\\epsilon - 2t \\cos(ka)) \\hat{n}_{k,\\sigma} $$\nThis confirms the block-diagonal structure of the Hamiltonian in momentum space:\n$$ H \\;=\\; \\sum_{k} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} E(k) \\, \\hat{n}_{k,\\sigma}, \\qquad \\text{with } E(k) = \\epsilon - 2 t \\cos(k a) $$\nThis derivation validates the energy dispersion relation provided. Each $k$-sector is independent. In a VQE simulation, instead of simulating the full $2N$-qubit system, we can simulate each $k$-sector individually. For each $k$, there are two spin-orbitals ($\\uparrow$ and $\\downarrow$), which map to $Q_k=2$ qubits. This provides a significant saving in qubit resources compared to the $Q_{\\text{full}} = 2N$ qubits required for a naive real-space simulation.\n\nThe computational procedure is as follows:\nFor each test case $(N, a, \\epsilon, t)$:\n1.  Calculate the qubit count for the full system, $Q_{\\text{full}} = 2N$, and for a single $k$-sector, $Q_k = 2$.\n2.  Compute the absolute qubit savings, $S = Q_{\\text{full}} - Q_k = 2N - 2$, and the savings ratio, $r = S / Q_{\\text{full}} = 1 - 1/N$.\n3.  Generate the discrete grid of crystal momenta $k_m = \\frac{2\\pi m}{Na}$ for $m = 0, 1, \\dots, N-1$.\n4.  For each $k_m$ on this grid, calculate the energy $E(k_m) = \\epsilon - 2t\\cos(k_m a)$. Note that the argument of the cosine function is $k_m a = \\frac{2\\pi m}{N}$, which is independent of the lattice constant $a$.\n5.  Determine the minimum and maximum values of this set of energies, $E_{\\min} = \\min_{m} E(k_m)$ and $E_{\\max} = \\max_{m} E(k_m)$.\n6.  Round the values of $r$, $E_{\\min}$, and $E_{\\max}$ to six decimal places.\n7.  Aggregate the results $[Q_{\\text{full}}, Q_k, S, r, E_{\\min}, E_{\\max}]$ for each test case into a final list.\n\nThe extrema of the energy band $E(k) = \\epsilon - 2t \\cos(ka)$ depend on the extrema of the cosine term over the discrete $k$-grid.\n- For $t0$, $E(k)$ is minimized when $\\cos(ka)$ is maximized. The maximum value is $\\cos(0) = 1$ (for $m=0$), yielding $E_{\\min} = \\epsilon - 2t$.\n- For $t0$, $E(k)$ is maximized when $\\cos(ka)$ is minimized. The minimum value of $\\cos(\\frac{2\\pi m}{N})$ over the grid determines $E_{\\max}$. If $N$ is even, the minimum is $\\cos(\\pi) = -1$, yielding $E_{\\max} = \\epsilon + 2t$. If $N$ is odd, the minimum is $\\cos(\\frac{2\\pi \\lfloor N/2 \\rfloor}{N})$.\nIf $t=0$, the band is flat, and $E(k) = \\epsilon$ for all $k$, so $E_{\\min} = E_{\\max} = \\epsilon$.\nThe implementation will numerically compute all energies and find the minimum and maximum directly, which is robust for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not required for this problem.\n\ndef solve():\n    \"\"\"\n    Computes VQE-related properties for a 1D periodic hydrogen chain\n    for a given set of test cases, leveraging translational symmetry.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (N, a, epsilon, t)\n    # N: number of unit cells (integer)\n    # a: lattice constant in angstroms (float)\n    # epsilon: on-site energy in eV (float)\n    # t: nearest-neighbor hopping amplitude in eV (float)\n    test_cases = [\n        (8, 1.0, -0.3, 1.5),\n        (3, 1.4, 0.0, 1.0),\n        (4, 1.2, -0.5, 0.0),\n        (16, 0.74, -0.1, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, epsilon, t = case\n\n        # --- Qubit Resource Calculation ---\n        # Qubits for full real-space simulation\n        Q_full = 2 * N\n        # Qubits for a single k-sector simulation\n        Q_k = 2\n        # Qubit savings\n        S = Q_full - Q_k\n        # Savings ratio\n        if N > 0:\n            r = S / Q_full\n        else:\n            r = 0.0 # Avoid division by zero, though N > 0 is implied.\n\n        # --- Energy Band Calculation ---\n        # m ranges from 0 to N-1\n        m_values = np.arange(N)\n        \n        # The argument for the cosine function is k*a = (2*pi*m / (N*a)) * a = 2*pi*m / N\n        # The lattice constant 'a' cancels out.\n        cos_args = 2 * np.pi * m_values / N\n        \n        # Calculate energies for all k-points\n        # E(k) = epsilon - 2*t*cos(k*a)\n        energies = epsilon - 2 * t * np.cos(cos_args)\n        \n        # Find the minimum and maximum of the discrete band energies\n        E_min = np.min(energies)\n        E_max = np.max(energies)\n\n        # --- Rounding and Formatting ---\n        # Round r, E_min, E_max to six decimal places as required.\n        r_rounded = round(r, 6)\n        E_min_rounded = round(E_min, 6)\n        E_max_rounded = round(E_max, 6)\n\n        # Append the list of results for the current case\n        case_result = [Q_full, Q_k, S, r_rounded, E_min_rounded, E_max_rounded]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists in Python matches the desired output.\n    # Using join and map to construct the string representation as per the template.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}