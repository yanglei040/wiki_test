{
    "hands_on_practices": [
        {
            "introduction": "What gives an amorphous solid its mechanical stability? Unlike crystals, which derive rigidity from a periodic lattice, disordered solids rely on a sufficiently dense network of local constraints. This exercise explores this concept through the lens of rigidity percolation, a fundamental model for the onset of mechanical stability in network glasses. You will implement a simulation to identify the critical point at which a collection of nodes and springs transitions from a floppy, fluid-like state to a rigid, solid-like one, providing a tangible understanding of the glass transition from a mechanical perspective .",
            "id": "3432505",
            "problem": "Consider a two-dimensional model of rigidity percolation in an amorphous network represented as a random geometric graph of point masses connected by central-force constraints. Let $N$ points be sampled independently and uniformly from the unit square $[0,1]\\times[0,1]$. Define a cutoff distance $r_c>0$. For each unordered pair of distinct points $\\{i,j\\}$ with Euclidean distance less than or equal to $r_c$, declare a candidate bond. Each candidate bond is realized independently with probability $p\\in[0,1]$. Every realized bond is a Hookean central-force spring with stiffness $k=1$ and rest length equal to the reference separation between the two points, under the small displacement approximation. Define the left boundary set as all points with $x\\le \\epsilon$ and the right boundary set as all points with $x\\ge 1-\\epsilon$, where $\\epsilon>0$.\n\nA connected component of the realized-bond graph that contains at least one point from both the left and right boundary sets is called a spanning component. To determine whether a spanning component is rigidly spanning, proceed as follows. Under a small displacement field $\\{\\mathbf{u}_i\\}_{i=1}^N$ with $\\mathbf{u}_i\\in\\mathbb{R}^2$, the total elastic energy of the network is given by the sum of spring energies due to the component’s bonds, expressed at quadratic order in displacements. Construct the linearized stiffness matrix for the component by assembling the contributions from each spring under central-force elasticity. Impose homogeneous Dirichlet boundary conditions by pinning all degrees of freedom of nodes in the component that lie in the left or right boundary sets (i.e., set $\\mathbf{u}_i=\\mathbf{0}$ for those nodes). Let $\\mathbf{K}_{\\mathrm{red}}$ denote the reduced stiffness matrix for the free degrees of freedom within the component after imposing these boundary conditions. If $\\mathbf{K}_{\\mathrm{red}}$ is positive definite, then the component has no internal floppy modes under these boundary constraints and is counted as a rigidly spanning component.\n\nFor a fixed parameter set $(N,r_c,\\epsilon)$, define the spanning probability $\\Pi(p)$ as the fraction of independent realizations at bond probability $p$ that contain at least one rigidly spanning component. To estimate the rigidity percolation threshold, consider a grid of bond probabilities $\\{p_1<p_2<\\dots<p_M\\}$. For each $p_j$, compute $\\Pi(p_j)$ using $R$ independent realizations (each realization resamples the $N$ points and their bonds). Define the estimated threshold $\\hat{p}^\\star$ as follows:\n- If there exists an index $j$ with $\\Pi(p_j)\\ge 0.5$, let $j^\\star$ be the smallest such index. If $j^\\star=1$, set $\\hat{p}^\\star=p_1$. If $j^\\star>1$, linearly interpolate between $(p_{j^\\star-1},\\Pi(p_{j^\\star-1}))$ and $(p_{j^\\star},\\Pi(p_{j^\\star}))$ to obtain the value $\\hat{p}^\\star\\in[p_{j^\\star-1},p_{j^\\star}]$ where $\\Pi$ would equal $0.5$ under linear interpolation.\n- If $\\Pi(p_j)<0.5$ for all $j$, set $\\hat{p}^\\star=1.0$.\n- If $\\Pi(p_j)\\ge 0.5$ already at $j=1$, set $\\hat{p}^\\star=p_1$.\n\nYour task is to implement a complete program that:\n- Generates the random geometric graphs and realized-bond networks as described, using a reproducible pseudo-random number generator with seed $12345$.\n- Detects connected components, tests the rigidly spanning condition via the positive definiteness of $\\mathbf{K}_{\\mathrm{red}}$, and estimates $\\Pi(p)$ at each grid point from $R$ realizations.\n- Computes $\\hat{p}^\\star$ by the interpolation rule above.\n\nUse the following test suite of parameter sets, which varies the geometric cutoff to probe different connectivity regimes:\n- Test case A: $N=24$, $r_c=0.28$, $\\epsilon=0.05$, $R=60$, and $p$-grid $\\{0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90\\}$.\n- Test case B: $N=24$, $r_c=0.24$, $\\epsilon=0.05$, $R=60$, and $p$-grid $\\{0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90\\}$.\n- Test case C: $N=24$, $r_c=0.34$, $\\epsilon=0.05$, $R=60$, and $p$-grid $\\{0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80,0.90\\}$.\n\nAll computations are dimensionless. Angles, if any are needed, must be in radians. Your program must output a single line containing the three estimated thresholds for the three test cases in the order A, B, C, formatted as a comma-separated list enclosed in square brackets, with each threshold rounded to exactly three decimal places (for example, $[0.550,0.735,0.485]$).",
            "solution": "The problem statement has been rigorously validated and is determined to be valid. It is scientifically grounded in the principles of computational materials science and elasticity theory, is well-posed with a clear and objective formulation, and provides a complete set of parameters for a reproducible numerical experiment. The problem requires the implementation of a Monte Carlo simulation to estimate the rigidity percolation threshold in a two-dimensional amorphous network model.\n\nThe solution proceeds by implementing the described simulation. The core of the problem lies in correctly identifying rigidly spanning components within random networks. This involves concepts from graph theory, linear algebra, and statistical mechanics.\n\n**1. System Generation**\n\nFor each realization of the simulation, we first generate the physical system. This involves sampling $N$ points independently and uniformly from the unit square, with coordinates $(x,y) \\in [0,1] \\times [0,1]$. These points represent point masses.\n\nA random geometric graph is then constructed. For every pair of distinct points $\\{i, j\\}$, we calculate their Euclidean distance $d_{ij}$. If $d_{ij} \\le r_c$, where $r_c$ is a given cutoff distance, the pair forms a *candidate bond*. Each candidate bond is then *realized* as a physical connection with an independent probability $p$. The ensemble of points and realized bonds constitutes the amorphous network for a single realization. A reproducible pseudo-random number generator, initialized with a fixed seed of $12345$, is used for all stochastic steps to ensure the result is deterministic.\n\n**2. Spanning and Rigidity Analysis**\n\nOnce a network is generated for a given bond probability $p$, it must be analyzed for the presence of a *rigidly spanning component*.\n\n*   **Connected Components**: The network is a graph where points are vertices and bonds are edges. We first identify the connected components of this graph using a standard algorithm, such as a Breadth-First Search (BFS) or by using a library function like `scipy.sparse.csgraph.connected_components`.\n*   **Spanning Condition**: The boundary sets are defined as the left boundary $B_L = \\{i | x_i \\le \\epsilon\\}$ and the right boundary $B_R = \\{i | x_i \\ge 1-\\epsilon\\}$, for a small parameter $\\epsilon$. A connected component is deemed a *spanning component* if it contains at least one point from $B_L$ and at least one point from $B_R$.\n\n*   **Rigidity Condition**: To assess the rigidity of a spanning component, we employ the principles of linearized elasticity. We consider a small virtual displacement $\\mathbf{u}_i \\in \\mathbb{R}^2$ for each point $i$ in the network. The elastic potential energy $U_{ij}$ of a single bond (realized as a Hookean spring with stiffness $k=1$) between points $i$ and $j$ is, to quadratic order in displacements:\n    $$U_{ij} = \\frac{1}{2} k \\left( (\\mathbf{u}_i - \\mathbf{u}_j) \\cdot \\hat{\\mathbf{r}}_{ij} \\right)^2$$\n    where $\\hat{\\mathbf{r}}_{ij}$ is the unit vector along the line connecting the points' reference positions. The total elastic energy $U$ of a component is the sum of $U_{ij}$ over all bonds within that component.\n\n    The forces are related to the displacements via the stiffness matrix $\\mathbf{K}$, where $\\mathbf{F} = -\\mathbf{K}\\mathbf{u}$. For a component with $N_c$ nodes, $\\mathbf{K}$ is a $2N_c \\times 2N_c$ matrix. The contribution of a single bond between nodes $i$ and $j$ to this matrix is the Hessian of $U_{ij}$. Let $\\hat{\\mathbf{r}}_{ij} = (n_x, n_y)$. The local $4 \\times 4$ stiffness matrix for the degrees of freedom $(\\mathbf{u}_i, \\mathbf{u}_j)$ is:\n    $$\\mathbf{k}_{ij} = \\begin{pmatrix} \\mathbf{k}_{ii} & \\mathbf{k}_{ij} \\\\ \\mathbf{k}_{ji} & \\mathbf{k}_{jj} \\end{pmatrix} = \\begin{pmatrix} n_x^2 & n_x n_y & -n_x^2 & -n_x n_y \\\\ n_x n_y & n_y^2 & -n_x n_y & -n_y^2 \\\\ -n_x^2 & -n_x n_y & n_x^2 & n_x n_y \\\\ -n_x n_y & -n_y^2 & n_x n_y & n_y^2 \\end{pmatrix}$$\n    The full stiffness matrix for the component is assembled by summing these local contributions.\n\n    To test for internal rigidity, we impose homogeneous Dirichlet boundary conditions. All degrees of freedom for nodes belonging to the boundary sets $B_L$ or $B_R$ are *pinned*, meaning their displacements are fixed to zero ($\\mathbf{u}_i = \\mathbf{0}$). The remaining nodes in the component are *free*. The stability of the component is determined by the *reduced stiffness matrix*, $\\mathbf{K}_{\\mathrm{red}}$, which pertains only to the degrees of freedom of the free nodes.\n\n    A component is *rigidly spanning* if $\\mathbf{K}_{\\mathrm{red}}$ is positive definite. A positive definite matrix has no zero or negative eigenvalues, which physically corresponds to the absence of any internal, zero-energy modes of deformation (i.e., floppy modes). A numerically robust method to test for positive definiteness is to attempt a Cholesky decomposition of $\\mathbf{K}_{\\mathrm{red}}$. The decomposition succeeds if and only if the matrix is positive definite. If a component has no free nodes (i.e., all its nodes are on the boundary), its reduced stiffness matrix is of size $0 \\times 0$, which is vacuously positive definite, and the component is considered rigid.\n\n**3. Statistical Estimation of the Threshold**\n\nThe procedure above determines if a single realization contains a rigidly spanning component. To estimate the percolation threshold, we perform a statistical analysis.\nFor each bond probability $p_j$ in a given grid $\\{p_1, p_2, \\dots, p_M\\}$, we execute $R$ independent realizations. The *spanning probability* $\\Pi(p_j)$ is estimated as the fraction of these $R$ realizations that contained at least one rigidly spanning component.\n\nThe rigidity percolation threshold $\\hat{p}^\\star$ is then estimated from the computed curve of $\\Pi(p)$ versus $p$. Following the problem's definition:\n*   If $\\Pi(p_j) < 0.5$ for all tested probabilities, we set $\\hat{p}^\\star=1.0$.\n*   Otherwise, we find the smallest index $j^\\star$ such that $\\Pi(p_{j^\\star}) \\ge 0.5$.\n    *   If $j^\\star=1$ (the first grid point), we set $\\hat{p}^\\star = p_1$.\n    *   If $j^\\star > 1$, we perform linear interpolation between the points $(p_{j^\\star-1}, \\Pi(p_{j^\\star-1}))$ and $(p_{j^\\star}, \\Pi(p_{j^\\star}))$ to find the value of $p$ at which the interpolated line crosses $0.5$. The formula for this is:\n        $$\\hat{p}^\\star = p_{j^\\star-1} + (0.5 - \\Pi(p_{j^\\star-1})) \\frac{p_{j^\\star} - p_{j^\\star-1}}{\\Pi(p_{j^\\star}) - \\Pi(p_{j^\\star-1})}$$\n\nThis entire process is repeated for each of the three test cases specified, yielding three distinct estimates for the rigidity percolation threshold.",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import csr_matrix\nfrom scipy.sparse.csgraph import connected_components\nfrom scipy.linalg import cholesky, LinAlgError\n\ndef is_component_rigid(component_nodes, points, all_realized_bonds, boundary_nodes):\n    \"\"\"\n    Checks if a given spanning component is rigid by analyzing its reduced stiffness matrix.\n\n    Args:\n        component_nodes (set): Indices of nodes in the component.\n        points (np.ndarray): Positions of all nodes in the system.\n        all_realized_bonds (list): List of all realized bonds in the system as (i, j) tuples.\n        boundary_nodes (set): Indices of all pinned boundary nodes.\n\n    Returns:\n        bool: True if the component is rigid, False otherwise.\n    \"\"\"\n    \n    pinned_nodes_in_comp = {node for node in component_nodes if node in boundary_nodes}\n    free_nodes_in_comp = [node for node in component_nodes if node not in pinned_nodes_in_comp]\n    \n    num_free_nodes = len(free_nodes_in_comp)\n    if num_free_nodes == 0:\n        return True\n\n    free_node_to_dof_map = {node_idx: i for i, node_idx in enumerate(free_nodes_in_comp)}\n    \n    k_red_size = 2 * num_free_nodes\n    K_red = np.zeros((k_red_size, k_red_size))\n\n    for i, j in all_realized_bonds:\n        if i not in component_nodes or j not in component_nodes:\n            continue\n\n        pos_i, pos_j = points[i], points[j]\n        r_ij = pos_i - pos_j\n        dist = np.linalg.norm(r_ij)\n        \n        if dist < 1e-12:\n            continue\n            \n        nx, ny = r_ij[0] / dist, r_ij[1] / dist\n        k_local = np.array([[nx * nx, nx * ny], [nx * ny, ny * ny]])\n\n        i_is_free = i in free_node_to_dof_map\n        j_is_free = j in free_node_to_dof_map\n        \n        if i_is_free:\n            dof_i_start = 2 * free_node_to_dof_map[i]\n            K_red[dof_i_start:dof_i_start+2, dof_i_start:dof_i_start+2] += k_local\n        \n        if j_is_free:\n            dof_j_start = 2 * free_node_to_dof_map[j]\n            K_red[dof_j_start:dof_j_start+2, dof_j_start:dof_j_start+2] += k_local\n            \n        if i_is_free and j_is_free:\n            dof_i_start = 2 * free_node_to_dof_map[i]\n            dof_j_start = 2 * free_node_to_dof_map[j]\n            K_red[dof_i_start:dof_i_start+2, dof_j_start:dof_j_start+2] -= k_local\n            K_red[dof_j_start:dof_j_start+2, dof_i_start:dof_i_start+2] -= k_local\n\n    try:\n        cholesky(K_red, lower=True)\n        return True\n    except LinAlgError:\n        return False\n\ndef has_rigidly_spanning_component(N, rc, epsilon, p, rng):\n    \"\"\"\n    Runs a single realization to check for a rigidly spanning component.\n    \"\"\"\n    points = rng.uniform(0.0, 1.0, size=(N, 2))\n\n    candidate_bonds = []\n    for i in range(N):\n        for j in range(i + 1, N):\n            if np.linalg.norm(points[i] - points[j]) <= rc:\n                candidate_bonds.append((i, j))\n    \n    realized_bonds = [b for b in candidate_bonds if rng.random() < p]\n\n    if not realized_bonds:\n        return False\n\n    rows, cols = zip(*realized_bonds)\n    adj_matrix = csr_matrix((np.ones(len(rows)), (rows, cols)), shape=(N, N))\n    adj_matrix = adj_matrix + adj_matrix.T\n    \n    n_components, labels = connected_components(csgraph=adj_matrix, directed=False)\n    \n    left_boundary_nodes = set(np.where(points[:, 0] <= epsilon)[0])\n    right_boundary_nodes = set(np.where(points[:, 0] >= 1 - epsilon)[0])\n    boundary_nodes = left_boundary_nodes.union(right_boundary_nodes)\n\n    for i in range(n_components):\n        component_nodes = set(np.where(labels == i)[0])\n        \n        is_spanning = (len(component_nodes.intersection(left_boundary_nodes)) > 0 and\n                       len(component_nodes.intersection(right_boundary_nodes)) > 0)\n        \n        if is_spanning:\n            if is_component_rigid(component_nodes, points, realized_bonds, boundary_nodes):\n                return True\n\n    return False\n\ndef calculate_threshold(p_grid, pi_values):\n    \"\"\"\n    Estimates the percolation threshold based on simulation results and interpolation.\n    \"\"\"\n    pi_values_np = np.array(pi_values)\n    indices_above_half = np.where(pi_values_np >= 0.5)[0]\n    \n    if len(indices_above_half) == 0:\n        return 1.0\n    \n    j_star = indices_above_half[0]\n    \n    if j_star == 0:\n        return p_grid[0]\n    \n    p1, pi1 = p_grid[j_star - 1], pi_values[j_star - 1]\n    p2, pi2 = p_grid[j_star], pi_values[j_star]\n    \n    if pi2 - pi1 == 0:\n        # This occurs if pi1 < 0.5 and pi2=pi1, which is impossible.\n        # It can only happen if pi1 = pi2 = 0.5, in which case p_star = p1 or p2.\n        # For precision, return the first p where pi is 0.5.\n        return p1 if pi1 == 0.5 else p2\n\n    p_star = p1 + (0.5 - pi1) * (p2 - p1) / (pi2 - pi1)\n    return p_star\n\ndef solve_for_case(params, rng):\n    \"\"\"\n    Solves for a single test case to find the rigidity threshold.\n    \"\"\"\n    N, rc, epsilon, R, p_grid = params\n    pi_values = []\n    \n    for p in p_grid:\n        rigidly_spanning_count = 0\n        for _ in range(R):\n            if has_rigidly_spanning_component(N, rc, epsilon, p, rng):\n                rigidly_spanning_count += 1\n        pi_values.append(rigidly_spanning_count / R)\n        \n    return calculate_threshold(p_grid, pi_values)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    rng = np.random.default_rng(12345)\n\n    p_grid = np.array([0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90])\n    test_cases = [\n        # (N, rc, epsilon, R, p_grid)\n        (24, 0.28, 0.05, 60, p_grid), # Case A\n        (24, 0.24, 0.05, 60, p_grid), # Case B\n        (24, 0.34, 0.05, 60, p_grid), # Case C\n    ]\n\n    results = []\n    for params in test_cases:\n        threshold = solve_for_case(params, rng)\n        results.append(threshold)\n\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The transition from a liquid to a glass is a kinetic phenomenon characterized by a dramatic increase in viscosity. The precise way this viscosity changes with temperature defines a liquid's 'fragility,' a key concept in glass physics. This practice challenges you to build and test a computational model that connects this macroscopic dynamic behavior to microscopic structural changes under pressure . By deriving the fragility index from a given transport law and correlating it with the pressure-induced increase in atomic coordination, you will gain hands-on experience in linking theoretical models to structural observables.",
            "id": "3432555",
            "problem": "You are asked to develop a complete and runnable program that models how applied pressure alters the kinetic fragility of an amorphous material by coupling transport behavior to pressure-induced changes in mean atomic coordination. Your task is to implement, from first principles, an internally consistent, unit-aware, and testable computational pipeline that does all of the following.\n\n- Use a well-tested transport law for supercooled liquids that connects viscosity $\\,\\eta\\,$ to temperature $\\,T\\,$ and pressure $\\,P\\,$ through a pressure-dependent energy scale and an onset temperature. Adopt the parabolic transport law from Dynamic Facilitation (DF), written in natural logarithm form as $\\,\\ln \\eta(T,P) = \\ln \\eta_0 + J(P)\\,\\left(\\frac{1}{T} - \\frac{1}{T_0(P)}\\right)^2\\,$, where $\\,\\eta_0\\,$ is a reference viscosity, $\\,J(P)\\,$ is a pressure-dependent energy parameter with units chosen so that the argument of the exponential is dimensionless, and $\\,T_0(P)\\,$ is a pressure-dependent onset temperature marking the high-temperature crossover into activated dynamics. All temperatures must be in Kelvin (K), pressures in gigapascal (GPa), and viscosity in pascal·second (Pa·s).\n\n- Relate the pressure dependence of $\\,J(P)\\,$ to the pressure-induced increase in the mean coordination number $\\,\\langle Z(P)\\rangle\\,$. Use a saturating, monotonic coordination law $\\,\\langle Z(P)\\rangle = Z_0 + \\Delta Z_{\\max}\\,\\left(1 - e^{-P/P_c}\\right)\\,$ and couple $\\,J(P)\\,$ to $\\,\\langle Z(P)\\rangle\\,$ via a shifted power law above a critical coordination $\\,Z_c\\,$: $\\,J(P) = J_{\\min} + J_{\\text{coeff}}\\,\\max\\!\\left(\\langle Z(P)\\rangle - Z_c,\\,0\\right)^\\gamma\\,$. This encodes the expected stiffening with increased constraints. Use the following physically plausible constants for the model:\n  - $\\,Z_0 = 5.5\\,$, $\\,\\Delta Z_{\\max} = 2.0\\,$, $\\,P_c = 2.0\\,\\text{GPa}\\,$, $\\,Z_c = 6.0\\,$, $\\,\\gamma = 1.5\\,$.\n  - $\\,J_{\\min} = 5.0\\times 10^7\\,\\text{K}^2\\,$, $\\,J_{\\text{coeff}} = 3.0\\times 10^7\\,\\text{K}^2\\,$.\n  - $\\,T_0(P) = T_{00} + \\beta P\\,$ with $\\,T_{00} = 800\\,\\text{K}\\,$ and $\\,\\beta = 50\\,\\text{K}/\\text{GPa}\\,$.\n  - $\\,\\eta_0 = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}\\,$.\n  - Define the glass transition temperature $\\,T_g(P)\\,$ implicitly by $\\,\\eta\\!\\left(T_g(P),P\\right) = \\eta_g\\,$ with $\\,\\eta_g = 1.0\\times 10^{12}\\,\\text{Pa}\\cdot\\text{s}\\,$.\n\n- Starting only from the DF parabolic law and the above definitions, derive an algorithm to compute $\\,T_g(P)\\,$ and the Angell fragility index $\\,m(P)\\,$. The Angell fragility index $\\,m(P)\\,$ is defined as the derivative $\\,m(P) = \\left.\\frac{d \\log_{10}\\eta(T,P)}{d\\,(T_g(P)/T)}\\right|_{T=T_g(P)}\\,$. Your code must compute $\\,m(P)\\,$ for each specified pressure using this definition together with the DF law. All intermediate reasoning in your program should be faithful to these definitions, and all quantities must be handled with the stated units.\n\n- For numerical evaluation, adopt the conventional glass-transition criterion $\\,\\eta_g = 10^{12}\\,\\text{Pa}\\cdot\\text{s}\\,$ and the above $\\,\\eta_0\\,$. You may assume $\\,J(P) > 0\\,$ and $\\,T_0(P) > 0\\,$ for all $\\,P\\,$ in the test suite below, guaranteeing a unique, positive $\\,T_g(P)\\,$.\n\n- Test Suite. Evaluate your implementation for the following pressures (in gigapascal):\n  - $\\,P_1 = 0.0\\,\\text{GPa}\\,$,\n  - $\\,P_2 = 0.575364\\,\\text{GPa}\\,$,\n  - $\\,P_3 = 1.0\\,\\text{GPa}\\,$,\n  - $\\,P_4 = 2.0\\,\\text{GPa}\\,$,\n  - $\\,P_5 = 5.0\\,\\text{GPa}\\,$.\n  These values are chosen to cover a baseline case $\\,P_1\\,$, the boundary $\\,P_2\\,$ where $\\,\\langle Z(P_2)\\rangle = Z_c\\,$, intermediate cases $\\,P_3\\,$ and $\\,P_4\\,$, and a high-pressure case $\\,P_5\\,$ approaching saturation of $\\,\\langle Z(P)\\rangle\\,$.\n\n- Required outputs. For each $\\,P_i\\,$, compute and return:\n  - the fragility $\\,m(P_i)\\,$ (dimensionless),\n  - the mean coordination $\\,\\langle Z(P_i)\\rangle\\,$ (dimensionless).\n  In addition, compute the Pearson linear correlation coefficient between the lists $\\,\\{m(P_i)\\}\\,$ and $\\,\\{\\langle Z(P_i)\\rangle\\}\\,$ over the five pressures.\n\n- Final Output Format. Your program must produce a single line containing a Python-like list with three entries: the first is the list of $\\,m(P_i)\\,$, the second is the list of $\\,\\langle Z(P_i)\\rangle\\,$, and the third is the scalar correlation coefficient. All floating-point values must be rounded to $\\,6\\,$ decimal places. The exact format is:\n  - $\\,\\big[\\,[m(P_1),m(P_2),m(P_3),m(P_4),m(P_5)],\\,[\\langle Z(P_1)\\rangle,\\langle Z(P_2)\\rangle,\\langle Z(P_3)\\rangle,\\langle Z(P_4)\\rangle,\\langle Z(P_5)\\rangle],\\,r\\,\\big]\\,$,\n  where $\\,r\\,$ is the Pearson correlation coefficient between $\\,\\{m(P_i)\\}\\,$ and $\\,\\{\\langle Z(P_i)\\rangle\\}\\,$. No additional text may be printed. All angles, if any appear, must be in radians, but no angles are used here. All physical units have been specified; report only the dimensionless $\\,m(P)\\,$ and $\\,\\langle Z(P)\\rangle\\,$, and the dimensionless correlation coefficient in the final output, rounded to $\\,6\\,$ decimal places.",
            "solution": "The problem requires the development of a computational model to calculate the kinetic fragility of an amorphous material as a function of applied pressure. The model is based on the Dynamic Facilitation (DF) theory of glasses, which provides a specific mathematical form for the viscosity $\\eta$ as a function of temperature $T$ and pressure $P$. The core of the task is to derive expressions for the glass transition temperature $T_g(P)$ and the Angell fragility index $m(P)$ from the given physical laws and constants, and then to implement these derivations in a program to analyze the correlation between fragility and the mean atomic coordination number $\\langle Z(P) \\rangle$.\n\nThe solution proceeds in three main stages:\n1.  Derivation of an explicit formula for the glass transition temperature, $T_g(P)$.\n2.  Derivation of an explicit formula for the Angell fragility index, $m(P)$.\n3.  Specification of the complete computational algorithm, including the calculation of the Pearson correlation coefficient.\n\nFirst, we restate the governing equations and constants provided.\nThe viscosity $\\eta(T,P)$ follows the parabolic transport law:\n$$ \\ln \\eta(T,P) = \\ln \\eta_0 + J(P)\\,\\left(\\frac{1}{T} - \\frac{1}{T_0(P)}\\right)^2 $$\nThe pressure-dependent parameters are given by:\nMean coordination number: $\\langle Z(P)\\rangle = Z_0 + \\Delta Z_{\\max}\\,\\left(1 - e^{-P/P_c}\\right)$\nEnergy parameter: $J(P) = J_{\\min} + J_{\\text{coeff}}\\,\\max\\!\\left(\\langle Z(P)\\rangle - Z_c,\\,0\\right)^\\gamma$\nOnset temperature: $T_0(P) = T_{00} + \\beta P$\n\nThe constants are:\n$Z_0 = 5.5$, $\\Delta Z_{\\max} = 2.0$, $P_c = 2.0\\,\\text{GPa}$, $Z_c = 6.0$, $\\gamma = 1.5$.\n$J_{\\min} = 5.0\\times 10^7\\,\\text{K}^2$, $J_{\\text{coeff}} = 3.0\\times 10^7\\,\\text{K}^2$.\n$T_{00} = 800\\,\\text{K}$, $\\beta = 50\\,\\text{K}/\\text{GPa}$.\n$\\eta_0 = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$.\nThe glass transition is defined by the condition $\\eta(T_g, P) = \\eta_g = 1.0\\times 10^{12}\\,\\text{Pa}\\cdot\\text{s}$.\n\n**1. Derivation of the Glass Transition Temperature $T_g(P)$**\n\nThe glass transition temperature $T_g(P)$ is found by substituting the definition $\\eta(T_g(P), P) = \\eta_g$ into the transport law:\n$$ \\ln \\eta_g = \\ln \\eta_0 + J(P)\\,\\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 $$\nRearranging the terms to solve for the squared parenthesis gives:\n$$ \\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 = \\frac{\\ln(\\eta_g/\\eta_0)}{J(P)} $$\nTaking the square root of both sides yields two possible solutions:\n$$ \\frac{1}{T_g(P)} - \\frac{1}{T_0(P)} = \\pm \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nTo select the physically correct branch, we must consider the definition of the fragility index $m(P)$, which must be a positive quantity. As will be shown in the next section, the fragility is proportional to the term $\\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)$. Therefore, we must choose the positive root to ensure $m(P) > 0$. This implies that the physically relevant regime for this model is where $T_g(P) < T_0(P)$.\nSelecting the positive root:\n$$ \\frac{1}{T_g(P)} = \\frac{1}{T_0(P)} + \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nInverting this expression gives the explicit formula for the glass transition temperature:\n$$ T_g(P) = \\left( \\frac{1}{T_0(P)} + \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} \\right)^{-1} $$\nThe problem statement guarantees that $T_g(P)$ is positive and unique for the given pressures, which means the term on the right-hand side is well-defined and positive.\n\n**2. Derivation of the Angell Fragility Index $m(P)$**\n\nThe Angell fragility index is defined as the slope of the $\\log_{10}\\eta$ vs. $T_g/T$ curve evaluated at the glass transition, i.e., at $T=T_g(P)$:\n$$ m(P) = \\left.\\frac{d \\log_{10}\\eta(T,P)}{d\\,(T_g(P)/T)}\\right|_{T=T_g(P)} $$\nLet us define a dimensionless temperature variable $x = T_g(P)/T$. The derivative is with respect to $x$, evaluated at $x=1$. Note that $T_g(P)$ in the definition of $x$ is treated as a constant parameter during differentiation.\nFirst, we express $\\ln\\eta$ in terms of $x$. Since $1/T = x/T_g(P)$, we have:\n$$ \\ln \\eta(T(x), P) = \\ln \\eta_0 + J(P)\\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 $$\nTo compute the derivative of $\\log_{10}\\eta$, we use the change of base formula, $\\log_{10}\\eta = \\frac{\\ln\\eta}{\\ln 10}$.\n$$ m(P) = \\frac{1}{\\ln 10} \\left. \\frac{d}{dx} \\left[ \\ln \\eta_0 + J(P)\\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 \\right] \\right|_{x=1} $$\nApplying the chain rule:\n$$ \\frac{d}{dx}[\\dots] = J(P) \\cdot 2 \\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right) \\cdot \\frac{d}{dx}\\left(\\frac{x}{T_g(P)}\\right) = 2J(P)\\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right)\\frac{1}{T_g(P)} $$\nNow, we evaluate this derivative at $x=1$:\n$$ m(P) = \\frac{2J(P)}{\\ln 10 \\cdot T_g(P)} \\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right) $$\nFrom the previous derivation of $T_g(P)$, we substitute the expression for $\\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)$:\n$$ \\frac{1}{T_g(P)} - \\frac{1}{T_0(P)} = \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nSubstituting this into the equation for $m(P)$:\n$$ m(P) = \\frac{2J(P)}{\\ln 10 \\cdot T_g(P)} \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nSimplifying by bringing $J(P)$ inside the square root:\n$$ m(P) = \\frac{2}{\\ln 10 \\cdot T_g(P)} \\sqrt{J(P) \\ln(\\eta_g/\\eta_0)} $$\nThis is the final, explicit formula for the fragility index $m(P)$. It is manifestly positive, consistent with physical expectations.\n\n**3. Computational Algorithm**\n\nThe complete algorithm to compute the required outputs for each pressure $P$ in the test suite is as follows:\n1.  Define all physical and model constants as provided. Pre-calculate the constant term $C_1 = \\ln(\\eta_g/\\eta_0) = \\ln(10^{15})$.\n2.  For each given pressure $P_i$:\n    a.  Calculate the mean coordination number: $\\langle Z(P_i)\\rangle = Z_0 + \\Delta Z_{\\max}\\,(1 - e^{-P_i/P_c})$.\n    b.  Calculate the onset temperature: $T_0(P_i) = T_{00} + \\beta P_i$.\n    c.  Calculate the pressure-dependent energy parameter: $J(P_i) = J_{\\min} + J_{\\text{coeff}}\\,\\max(\\langle Z(P_i) \\rangle - Z_c, 0)^\\gamma$.\n    d.  Calculate the glass transition temperature using the derived formula: $T_g(P_i) = \\left( \\frac{1}{T_0(P_i)} + \\sqrt{\\frac{C_1}{J(P_i)}} \\right)^{-1}$.\n    e.  Calculate the fragility index using its derived formula: $m(P_i) = \\frac{2}{\\ln 10} \\frac{\\sqrt{J(P_i) \\cdot C_1}}{T_g(P_i)}$.\n    f.  Store the computed values of $m(P_i)$ and $\\langle Z(P_i)\\rangle$.\n3.  After iterating through all pressures, assemble two lists: $M = [m(P_1), \\dots, m(P_5)]$ and $Z = [\\langle Z(P_1) \\rangle, \\dots, \\langle Z(P_5) \\rangle]$.\n4.  Compute the Pearson linear correlation coefficient, $r$, between the lists $M$ and $Z$. The formula is $r = \\frac{\\text{cov}(M, Z)}{\\sigma_M \\sigma_Z}$, which can be readily computed using standard numerical libraries.\n5.  Format the lists of results for $m(P_i)$ and $\\langle Z(P_i)$, and the scalar $r$, rounding each value to $6$ decimal places, and print them in the specified list-of-lists format.",
            "answer": "```python\nimport numpy as np\n\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Computes fragility and coordination number for an amorphous material model\n    under varying pressure, and calculates their correlation.\n    \"\"\"\n\n    # Define physical and model constants from the problem statement.\n    # Viscosity and thermodynamic constants\n    eta_0 = 1.0e-3  # Pa·s\n    eta_g = 1.0e12  # Pa·s\n    T00 = 800.0     # K\n    beta = 50.0     # K/GPa\n\n    # Coordination number model constants\n    Z0 = 5.5\n    Delta_Z_max = 2.0\n    Pc = 2.0        # GPa\n    Zc = 6.0\n\n    # Energy parameter J(P) model constants\n    J_min = 5.0e7   # K^2\n    J_coeff = 3.0e7 # K^2\n    gamma = 1.5\n\n    # Test suite of pressures\n    pressures = [\n        0.0,\n        0.575364,\n        1.0,\n        2.0,\n        5.0,\n    ]\n\n    # Pre-calculate constant factor in the equations\n    log_eta_ratio = np.log(eta_g / eta_0)\n    log_10 = np.log(10)\n\n    # Lists to store the results\n    m_values = []\n    z_values = []\n\n    for P in pressures:\n        # Step 1: Calculate the mean coordination number <Z(P)>\n        z_p = Z0 + Delta_Z_max * (1.0 - np.exp(-P / Pc))\n        z_values.append(z_p)\n\n        # Step 2: Calculate the onset temperature T0(P)\n        T0_p = T00 + beta * P\n\n        # Step 3: Calculate the energy parameter J(P)\n        z_diff = z_p - Zc\n        j_p = J_min + J_coeff * np.power(max(z_diff, 0), gamma)\n\n        # Step 4: Calculate the glass transition temperature Tg(P)\n        # We use the formula derived from the positive root for m > 0.\n        # 1/Tg(P) = 1/T0(P) + sqrt(ln(eta_g/eta_0) / J(P))\n        inv_Tg_p = (1.0 / T0_p) + np.sqrt(log_eta_ratio / j_p)\n        Tg_p = 1.0 / inv_Tg_p\n\n        # Step 5: Calculate the Angell fragility index m(P)\n        # m(P) = (2 / ln(10)) * sqrt(J(P) * ln(eta_g/eta_0)) / Tg(P)\n        m_p = (2.0 / log_10) * np.sqrt(j_p * log_eta_ratio) / Tg_p\n        m_values.append(m_p)\n\n    # Step 6: Calculate the Pearson correlation coefficient\n    # numpy.corrcoef returns a 2x2 matrix. The off-diagonal element is the correlation.\n    correlation_matrix = np.corrcoef(z_values, m_values)\n    r = correlation_matrix[0, 1]\n\n    # Step 7: Format the output as specified, rounding to 6 decimal places.\n    m_rounded = [f\"{val:.6f}\" for val in m_values]\n    z_rounded = [f\"{val:.6f}\" for val in z_values]\n    r_rounded = f\"{r:.6f}\"\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(m_rounded)}],[{','.join(z_rounded)}],{r_rounded}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "As liquids approach the glass transition, their dynamics become not only slow but also remarkably heterogeneous, with spatially distinct regions of fast and slow-moving particles. This phenomenon of dynamic heterogeneity is a cornerstone of modern glass theory, and its characterization requires sophisticated statistical tools. This exercise will guide you through the process of quantifying dynamic heterogeneity by analyzing the four-point structure factor $S_4(k,t)$ obtained from a simulation . You will extract the dynamic correlation length $\\xi_4$ and its thermodynamic limit value, mastering an advanced data analysis technique essential for contemporary research in disordered systems.",
            "id": "3432509",
            "problem": "Consider a supercooled liquid model in reduced Lennard-Jones units where length is measured in multiples of the particle diameter, denoted by $\\sigma$, and number density is denoted by $\\rho$. The goal is to assess finite-size effects on the peak of the four-point dynamical susceptibility, denoted by $\\chi_4^{\\text{max}}$, and on the associated dynamic correlation length, denoted by $\\xi_4$, as the number of particles $N$ varies, and to extrapolate $\\xi_4(N)$ to the asymptotic thermodynamic limit $N \\to \\infty$.\n\nThe fundamental base for this problem is as follows. The spatial field of dynamical overlap fluctuations at time $t$ may be characterized by a four-point correlation function in real space, denoted by $G_4(\\mathbf{r},t)$, which quantifies correlations between local dynamical activity at points separated by $\\mathbf{r}$. Its Fourier transform defines the four-point structure factor $S_4(\\mathbf{k},t)$ through\n$$\nS_4(\\mathbf{k},t) = \\int_{\\mathbb{R}^3} G_4(\\mathbf{r},t)\\, e^{-i \\mathbf{k}\\cdot \\mathbf{r}}\\, d^3 r.\n$$\nThe four-point dynamical susceptibility is defined by the spatial integral\n$$\n\\chi_4(t) = \\int_{\\mathbb{R}^3} G_4(\\mathbf{r},t)\\, d^3 r,\n$$\nwhich implies the identity\n$$\n\\chi_4(t) = S_4(\\mathbf{k}=\\mathbf{0},t).\n$$\nNear the time $t=t^\\star$ at which $\\chi_4(t)$ reaches its maximum, empirical evidence and the Ornstein–Zernike paradigm suggest that $G_4(\\mathbf{r},t^\\star)$ decays approximately exponentially with a characteristic correlation length $\\xi_4$, leading to a low-wavevector form\n$$\nS_4(k,t^\\star) \\approx \\frac{S_4(0,t^\\star)}{1 + (k \\, \\xi_4)^2},\n$$\nfor isotropic systems, where $k = \\|\\mathbf{k}\\|$ denotes the magnitude of the wavevector and $S_4(0,t^\\star) = \\chi_4^{\\text{max}}$ at the peak time.\n\nIn a cubic periodic simulation box of linear dimension $L$ containing $N$ particles at number density $\\rho$, the relation $L = (N/\\rho)^{1/3}$ holds, and allowed wavevectors are quantized with components $k_\\alpha = 2\\pi n_\\alpha / L$ where $n_\\alpha \\in \\mathbb{Z}$. The smallest nonzero wavevector magnitude is $k_{\\min} = 2\\pi/L$. As $N$ varies at fixed $\\rho$, the accessible small-$k$ range changes, potentially biasing fits used to estimate $\\xi_4$ and $\\chi_4^{\\text{max}}$.\n\nYour task is to write a complete, runnable program that, for each provided test case:\n- Treats the measured four-point structure factor data at $t^\\star$ as a set of pairs $\\{(k_i, S_4(k_i,t^\\star))\\}$ with associated uncertainties.\n- Fits the functional form $S_4(k,t^\\star) \\approx S_4(0,t^\\star) / \\left[1 + (k \\, \\xi_4)^2\\right]$ to estimate both $\\xi_4$ and $S_4(0,t^\\star)$, thereby yielding $\\xi_4$ and $\\chi_4^{\\text{max}}$ for that system size.\n- Uses the relation $L = (N/\\rho)^{1/3}$ to compute $L$ for each $N$, and then extrapolates the finite-size sequence $\\xi_4(N)$ to the thermodynamic limit by performing a linear regression of $\\xi_4$ versus $1/L$ and taking the intercept at $1/L \\to 0$ as the estimate of $\\xi_4(N\\to\\infty)$.\n\nAll lengths must be expressed in units of $\\sigma$ and must be output in $\\sigma$ units. The susceptibility $\\chi_4^{\\text{max}}$ is dimensionless. No angles are involved.\n\nUse the following test suite. The number density is $\\rho = 1.2\\,\\sigma^{-3}$. For each $N$, measured data are provided at the first four distinct wavevector shells determined by the integer triplets $(1,0,0)$, $(1,1,0)$, $(1,1,1)$, and $(2,0,0)$, which correspond to magnitudes $k = (2\\pi/L)\\,\\sqrt{n_x^2+n_y^2+n_z^2}$. For each $N$, the measured values of $S_4(k,t^\\star)$ and their one-standard-deviation uncertainties are:\n\n- $N = 500$. $S_4$ values: $[0.835,\\,0.427,\\,0.312,\\,0.234]$. Uncertainties: $[0.030,\\,0.030,\\,0.020,\\,0.020]$.\n- $N = 1000$. $S_4$ values: $[1.182,\\,0.688,\\,0.447,\\,0.370]$. Uncertainties: $[0.040,\\,0.030,\\,0.030,\\,0.020]$.\n- $N = 4000$. $S_4$ values: $[2.280,\\,1.469,\\,1.025,\\,0.842]$. Uncertainties: $[0.050,\\,0.040,\\,0.040,\\,0.030]$.\n- $N = 16000$. $S_4$ values: $[3.720,\\,2.610,\\,2.090,\\,1.670]$. Uncertainties: $[0.060,\\,0.050,\\,0.050,\\,0.040]$.\n\nFor each $N$, compute $L = (N/\\rho)^{1/3}$ in units of $\\sigma$, then compute the corresponding $k$ values for the four shells using the magnitudes described above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order:\n- The four estimates of $\\xi_4$ (in $\\sigma$ units), corresponding to $N = 500,\\,1000,\\,4000,\\,16000$.\n- The extrapolated thermodynamic-limit estimate $\\xi_4(N\\to\\infty)$ (in $\\sigma$ units), obtained as the intercept of the linear fit of $\\xi_4$ versus $1/L$ at $1/L = 0$.\n- The four estimates of $\\chi_4^{\\text{max}}$ (dimensionless), corresponding to $N = 500,\\,1000,\\,4000,\\,16000$.\n\nThus the output format is $[\\xi_4(500),\\xi_4(1000),\\xi_4(4000),\\xi_4(16000),\\xi_4(\\infty),\\chi_4^{\\text{max}}(500),\\chi_4^{\\text{max}}(1000),\\chi_4^{\\text{max}}(4000),\\chi_4^{\\text{max}}(16000)]$. All numerical entries must be standard floating-point numbers. The line must contain no additional text.\n\nEnsure numerical stability and scientific realism by using a robust nonlinear least-squares fit with nonnegative parameter constraints for $S_4(0,t^\\star)$ and $\\xi_4$ and by using the provided uncertainties as weights in the fit. The extrapolation must be a standard linear least-squares regression in the variable $1/L$.\n\nThe program must be completely self-contained, require no user input, and use only the specified libraries.",
            "solution": "The problem requires a multi-step analysis of simulated data for a supercooled liquid to characterize finite-size effects on key dynamical properties. The core tasks are to extract the dynamic correlation length $\\xi_4$ and the peak four-point susceptibility $\\chi_4^{\\text{max}}$ for several system sizes, and then to extrapolate $\\xi_4$ to the thermodynamic limit ($N \\to \\infty$). The solution proceeds in three main stages: calculation of system-dependent parameters, non-linear fitting of the four-point structure factor for each system size, and finally, a linear extrapolation of the correlation length.\n\nFirst, we determine the physical parameters for each simulated system, characterized by the number of particles $N$. The system is contained in a cubic box of volume $V=L^3$ with periodic boundary conditions. The number density $\\rho$ is fixed at $\\rho = 1.2\\,\\sigma^{-3}$, where $\\sigma$ is the particle diameter. The box length $L$ is thus related to $N$ and $\\rho$ by\n$$\nL = \\left(\\frac{N}{\\rho}\\right)^{1/3}.\n$$\nDue to the periodic boundary conditions, the allowed wavevectors $\\mathbf{k}$ are quantized. Their components must be integer multiples of $2\\pi/L$, i.e., $k_\\alpha = 2\\pi n_\\alpha / L$ for $\\alpha \\in \\{x,y,z\\}$, where $n_\\alpha \\in \\mathbb{Z}$. The problem provides data for the first four distinct non-zero wavevector shells, corresponding to integer triplets $(n_x, n_y, n_z)$ with norms $\\sqrt{n_x^2+n_y^2+n_z^2}$ of $1$ (e.g., $(1,0,0)$), $\\sqrt{2}$ (e.g., $(1,1,0)$), $\\sqrt{3}$ (e.g., $(1,1,1)$), and $2$ (e.g., $(2,0,0)$). The corresponding wavevector magnitudes are given by\n$$\nk = \\frac{2\\pi}{L} \\sqrt{n_x^2 + n_y^2 + n_z^2}.\n$$\nFor each $N$, we compute $L$ and then the set of four $k_i$ values corresponding to $\\sqrt{n_x^2+n_y^2+n_z^2} \\in \\{1, \\sqrt{2}, \\sqrt{3}, 2\\}$.\n\nSecond, for each system size $N$, we analyze the provided four-point structure factor data, $\\{ (k_i, S_4(k_i,t^\\star)) \\}$, at the time $t^\\star$ of the susceptibility peak. The data are fitted to the Ornstein-Zernike (OZ) functional form, which is appropriate for describing correlations near a critical point or, in this context, growing dynamical heterogeneity:\n$$\nS_4(k) = \\frac{S_4(0)}{1 + (k \\xi_4)^2}.\n$$\nIn this model, $S_4(0)$ is the structure factor at zero wavevector, which by definition is the peak four-point susceptibility, $\\chi_4^{\\text{max}}$. The parameter $\\xi_4$ is the dynamic correlation length. The fitting process aims to determine the optimal values of $\\chi_4^{\\text{max}}$ and $\\xi_4$. This is a non-linear least-squares problem. To account for the varying precision of the data points, a weighted least-squares approach is employed, where the objective is to minimize the chi-squared function:\n$$\n\\chi^2 = \\sum_i \\left( \\frac{S_{4,i}^{\\text{data}} - S_4(k_i; \\chi_4^{\\text{max}}, \\xi_4)}{u_i} \\right)^2,\n$$\nwhere $S_{4,i}^{\\text{data}}$ are the measured values and $u_i$ are their corresponding uncertainties. This procedure is implemented using the `scipy.optimize.curve_fit` function. Physical constraints require that both $\\chi_4^{\\text{max}}$ and $\\xi_4$ be non-negative, which is enforced by setting bounds on the optimization parameters.\n\nThird, after obtaining the correlation length $\\xi_4(N)$ for each system size $N$, we perform an extrapolation to the thermodynamic limit ($N \\to \\infty$, or equivalently, $L \\to \\infty$). Finite-size effects in systems with periodic boundary conditions often exhibit a scaling behavior with the inverse of the linear system size, $1/L$. It is a standard assumption that for large $L$, the measured correlation length $\\xi_4(L)$ approaches its thermodynamic limit value $\\xi_4(\\infty)$ according to\n$$\n\\xi_4(L) \\approx \\xi_4(\\infty) + \\frac{C}{L},\n$$\nwhere $C$ is a constant. We can therefore estimate $\\xi_4(\\infty)$ by performing a linear regression on the computed pairs $(\\xi_4(N), 1/L)$. The intercept of the resulting line at $1/L = 0$ provides the extrapolated value for the correlation length in the thermodynamic limit, $\\xi_4(\\infty)$. This linear regression is implemented using `numpy.polyfit`.\n\nThe final program implements these three stages. It iterates through the dataset for each $N$, computes the $k$-vectors, performs the weighted non-linear fit to find $\\xi_4(N)$ and $\\chi_4^{\\text{max}}(N)$, and stores these results. After processing all system sizes, it performs the linear extrapolation for $\\xi_4(\\infty)$ and assembles all computed quantities into a single list for output, formatted as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing finite-size effects on dynamical susceptibility\n    and correlation length in a supercooled liquid model.\n    \"\"\"\n\n    # Fixed parameter from the problem statement\n    rho = 1.2  # number density in units of sigma^-3\n\n    # Test suite data as provided in the problem statement\n    # Format: (N, S4_values, uncertainties)\n    test_cases = [\n        (500, np.array([0.835, 0.427, 0.312, 0.234]), np.array([0.030, 0.030, 0.020, 0.020])),\n        (1000, np.array([1.182, 0.688, 0.447, 0.370]), np.array([0.040, 0.030, 0.030, 0.020])),\n        (4000, np.array([2.280, 1.469, 1.025, 0.842]), np.array([0.050, 0.040, 0.040, 0.030])),\n        (16000, np.array([3.720, 2.610, 2.090, 1.670]), np.array([0.060, 0.050, 0.050, 0.040])),\n    ]\n\n    # Shell norms for the integer triplets (1,0,0), (1,1,0), (1,1,1), (2,0,0)\n    k_shell_norms = np.array([1.0, np.sqrt(2.0), np.sqrt(3.0), 2.0])\n\n    def oz_model(k, chi4_max, xi4):\n        \"\"\"\n        Ornstein-Zernike functional form for the four-point structure factor S4(k).\n        k: wavevector magnitude\n        chi4_max: S4(0), the peak of the four-point susceptibility\n        xi4: dynamic correlation length\n        \"\"\"\n        return chi4_max / (1.0 + (k * xi4)**2)\n\n    xi4_results = []\n    chi4_max_results = []\n    inv_L_values = []\n\n    for N, s4_data, s4_errors in test_cases:\n        # Step 1: Calculate system-specific parameters\n        # Box length L in units of sigma\n        L = (N / rho)**(1.0 / 3.0)\n        inv_L_values.append(1.0 / L)\n\n        # Wavevector magnitudes k for the given shells\n        k_values = (2.0 * np.pi / L) * k_shell_norms\n\n        # Step 2: Perform the non-linear least-squares fit\n        # Bounds to ensure physical parameters (non-negative)\n        bounds = ([0, 0], [np.inf, np.inf])\n        \n        # We use curve_fit to perform a weighted non-linear least-squares fit.\n        # The 'sigma' argument provides the uncertainties, causing curve_fit to\n        # minimize the sum of squared residuals weighted by 1/sigma^2.\n        popt, _ = curve_fit(\n            oz_model,\n            k_values,\n            s4_data,\n            sigma=s4_errors,\n            bounds=bounds,\n            absolute_sigma=True\n        )\n\n        chi4_max, xi4 = popt\n        chi4_max_results.append(chi4_max)\n        xi4_results.append(xi4)\n\n    # Step 3: Extrapolate xi4 to the thermodynamic limit (N -> infinity, L -> infinity, 1/L -> 0)\n    # Perform a linear regression of xi4 vs 1/L: xi4 = m*(1/L) + c\n    # The intercept 'c' is the extrapolated value xi4(infinity).\n    # np.polyfit returns coefficients [m, c] for a 1st degree polynomial.\n    slope, intercept = np.polyfit(inv_L_values, xi4_results, 1)\n    xi4_inf = intercept\n\n    # Assemble the final results in the specified order\n    final_results = xi4_results + [xi4_inf] + chi4_max_results\n    \n    # Print the final output in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}