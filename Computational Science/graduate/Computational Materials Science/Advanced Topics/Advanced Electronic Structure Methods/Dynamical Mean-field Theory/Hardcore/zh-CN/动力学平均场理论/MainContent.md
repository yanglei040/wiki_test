## 引言
强[关联电子系统](@entry_id:144460)，其中电子间的库仑排斥作用不可忽略，是现代[凝聚态物理学](@entry_id:140205)的核心挑战之一。传统的理论方法，如基于[独立电子近似](@entry_id:195608)的[能带理论](@entry_id:139801)，无法解释这些材料中涌现的丰富物理现象，例如[莫特金属-绝缘体相变](@entry_id:185117)。另一方面，直接求解多体薛定谔方程对于宏观系统而言计算上是不可行的，这在理论与实验之间留下了一道巨大的鸿沟。动力学平均场理论 (DMFT) 的出现，正是为了弥合这一鸿沟。它提供了一种创新的、非微扰的理论框架，通过一个精巧的映射，将无限[晶格](@entry_id:196752)的复杂问题简化为一个可解的局域问题，同时保留了关键的动力学（时间/能量）关联效应。

本文旨在全面而深入地介绍动力学平均场理论。
*   在**原理与机制**一章中，我们将剖析DMFT的理论基础、核心近似及其[自洽循环](@entry_id:138158)机制。
*   随后，在**应用与[交叉](@entry_id:147634)学科联系**一章中，我们将展示DMFT如何应用于真实材料的计算、解释关键物理现象，并探讨其思想在其他学科中的延伸。
*   最后，**动手实践**部分将提供具体的编程练习，帮助读者将理论知识转化为实践技能。

让我们首先从理解 DMFT 的基本原理及其运作机制开始。

## 原理与机制

在理解强[关联电子系统](@entry_id:144460)的复杂行为方面，理论物理学面临着艰巨的挑战。一方面，[独立电子近似](@entry_id:195608)（如能带理论）无法捕捉由电子间库仑排斥主导的物理现象；另一方面，精确求解多体[哈密顿量](@entry_id:172864)对于宏观尺度的系统而言计算上是不可行的。动力学平均场理论（DMFT）提供了一条中间道路，它将一个无限的[晶格](@entry_id:196752)问题精确地映射到一个可解的、局部的[量子杂质问题](@entry_id:144660)上。本章将深入阐述 DMFT 的核心原理、理论基础及其运作机制。

### 基本概念：关联、局域性与 DMFT 近似

大多数[关联材料](@entry_id:138171)的理论研究始于哈伯德模型（Hubbard model），这是一个描述在[晶格](@entry_id:196752)上运动并相互作用的电子的简约模型。对于单带系统，其[哈密顿量](@entry_id:172864)为：

$$
H = -t \sum_{\langle ij \rangle, \sigma} c_{i\sigma}^\dagger c_{j\sigma} + U \sum_i n_{i\uparrow} n_{i\downarrow} - \mu \sum_{i, \sigma} n_{i\sigma}
$$

其中，$t$ 是最近邻格点间的电子跃迁振幅，它决定了电子的动能和非相互作用能带的带宽 $W$。$U$ 是在同一个格点上自旋向上和自旋向下电子之间的瞬时库仑排斥能，它倾向于使电子局域化以避免双重占据的能量惩罚。$\mu$ 是化学势，用于控制系统的电子占据数，即平均每个格点的电子数 $n$。

该模型的物理行为由两个关键的无量纲参数之间的竞争所支配：**关联强度** $U/W$ 和**填充** $n$ 。
- 当 $U/W \ll 1$ 时，相互作用是动能的一个小微扰。对于任意填充 $n$，系统表现为**弱[关联金属](@entry_id:142422)**，其行为可以通过[朗道费米液体理论](@entry_id:151062)很好地描述。
- 当 $U/W \gtrsim 1$ 时，系统进入强关联区域。此时，物理性质对填充 $n$ 变得高度敏感。特别是在**半填充**（$n=1$）情况下，每个格点平均有一个电子。为了移动，电子必须跳到一个已经被占据的格点上，这会产生一个大小为 $U$ 的能量惩罚。如果 $U$ 足够大，这种[电荷](@entry_id:275494)涨落就会被抑制，电子变得局域化，系统转变为**[莫特绝缘体](@entry_id:140685)**（Mott insulator）。如果将[莫特绝缘体](@entry_id:140685)进行掺杂，使其偏离半填充（$n \neq 1$），则会引入[电荷](@entry_id:275494)载流子（电子或空穴），系统恢复金属性，但表现为一种奇特的**[关联金属](@entry_id:142422)**，其性质与弱关联费米液体显著不同。

为了在理论上描述这些现象，我们需要超越简单的[平均场方法](@entry_id:141668)，如[哈特里-福克理论](@entry_id:160358)，后者无法正确处理强关联极限下的局域量子涨落。现代[多体理论](@entry_id:169452)的核心工具是格林函数方法。对于[晶格](@entry_id:196752)系统，我们定义依赖于动量 $\mathbf{k}$ 和[松原频率](@entry_id:197724) $i\omega_n$ 的[格林函数](@entry_id:147802) $G(\mathbf{k}, i\omega_n)$。它通过[戴森方程](@entry_id:146246)（Dyson's equation）与**自能**（self-energy）$\Sigma(\mathbf{k}, i\omega_n)$ 相关联 ：

$$
G(\mathbf{k}, i\omega_n) = \frac{1}{i\omega_n + \mu - \epsilon_{\mathbf{k}} - \Sigma(\mathbf{k}, i\omega_n)}
$$

其中，$\epsilon_{\mathbf{k}}$ 是非相互作用电子的[色散关系](@entry_id:140395)。[自能](@entry_id:145608) $\Sigma$ 是一个复杂的、依赖于频率和动量的函数，它包含了所有由电子间相互作用产生的[多体效应](@entry_id:173569)。原则上，如果知道了 $\Sigma$，系统的所有单粒子性质都可以被计算出来。然而，精确计算 $\Sigma$ 是一个极其困难的问题。

DMFT 的核心思想在于引入一个看似大胆但有深刻物理基础的近似：**假设自能是完[全局域](@entry_id:196542)的**，即它不依赖于动量 $\mathbf{k}$  。

$$
\Sigma(\mathbf{k}, i\omega_n) \approx \Sigma(i\omega_n)
$$

这个近似在[实空间](@entry_id:754128)中意味着自能仅在格点内部（on-site）非零，即 $\Sigma_{ij}(i\omega_n) = \Sigma(i\omega_n) \delta_{ij}$。这一步的物理含义是，我们忽略了非局域的**空间**关联（例如，一个格点的电子如何与邻近格点的电子关联），但完全保留了**局域**的**时间**（或等效地，能量/频率）关联，即在一个格点上随时间发生的复杂量子涨落。正是这种对动力学（频率依赖性）的保留，使得 DMFT 能够捕捉到莫特转变等静态平均场理论无法描述的现象。

### 理论基础：无限维度的极限

DMFT 的局域[自能](@entry_id:145608)近似并非一个随意的猜测，而是在**无限空间维度** ($d \to \infty$) 或无限[配位数](@entry_id:143221) ($z \to \infty$) 的极限下变得**精确**的结论  。理解这一点是掌握 DMFT 精神的关键。

考虑一个 $d$ 维超[立方晶格](@entry_id:148452)，其非相互作用[色散](@entry_id:263750)为 $\varepsilon_{\mathbf{k}} = -2t_d \sum_{\alpha=1}^{d} \cos(k_\alpha a)$。这里的能量是 $d$ 个[独立随机变量](@entry_id:273896)（每个 $k_\alpha$ 分量）之和。为了在 $d \to \infty$ 时获得一个有意义的、非平庸的动能标度，我们需要适当地缩放跃迁振幅 $t_d$。根据中心极限定理，为了使能带宽度保持有限，跃迁振幅必须按 $t_d \sim 1/\sqrt{d}$（或对一般[晶格](@entry_id:196752)按 $t \sim 1/\sqrt{z}$）进行缩放。例如，选择 $t_d = t^*/\sqrt{2d}$，在 $d \to \infty$ 的极限下，非相互作用[态密度](@entry_id:147894) $\rho_0(\varepsilon)$ 会收敛为一个高斯函数 。

在这种缩放下，可以系统地分析[自能](@entry_id:145608)的[费曼图](@entry_id:144373)展开。结果表明，任何涉及不同格点之间传播的不可约[自能](@entry_id:145608)图（即非局域图）都受到 $1/\sqrt{d}$ 或更高阶的抑制。在 $d \to \infty$ 的极限下，这些非局域图的贡献完全消失，只有那些所有相互作用顶点都位于同一格点的图存活下来。这严格证明了自能在这个极限下变为纯粹的局域量 。

这个结论为 DMFT 提供了一个坚实的理论基础。它将 DMFT 定位为一种关于局域关联的平均场理论，该理论在无限维度的极限下是精确的。对于现实的三维系统，DMFT 则可被视为一种系统性的、可控的近似。

值得注意的是，这种自能的局域化仅适用于纯粹的格点上（on-site）相互作用，如哈伯德模型的 $U$ 项。如果模型中包含非局域的相互作用，例如最近邻间的密度-密度相互作用 $V \sum_{\langle ij \rangle} n_i n_j$，那么即使在 $d \to \infty$ 的极限下，[自能](@entry_id:145608)也会包含非局域分量。处理这类问题需要超越标准单点 DMFT 的框架，例如采用扩展 DMFT（EDMFT）或团簇 DMFT 等方法 。

### DMFT 机制：自洽的杂质问题映射

DMFT 的核心机制是将复杂的[晶格](@entry_id:196752)问题映射到一个等效的、可解的**[安德森杂质模型](@entry_id:137939)**（Anderson Impurity Model, AIM）上 。这个[杂质模型](@entry_id:155988)由一个单独的、具有相互作用 $U$ 的格点（“杂质”）和一个代表[晶格](@entry_id:196752)其余部分的非相互作用“电子浴”组成。关键在于，这个电子浴的性质并非固定的，而是必须通过一个**[自洽循环](@entry_id:138158)**（self-consistency loop）来确定，以确保杂质的行为能精确地反映原始[晶格](@entry_id:196752)中一个格点的局域物理。

让我们逐步分解这个[自洽循环](@entry_id:138158)  ：

1.  **定义局域格林函数**: 在 DMFT 的局域[自能](@entry_id:145608)近似下，[晶格](@entry_id:196752)的局域[格林函数](@entry_id:147802) $G_{\mathrm{loc}}(i\omega_n)$（即格点对角部分的[格林函数](@entry_id:147802) $G_{ii}(i\omega_n)$）可以通过对[动量空间](@entry_id:148936)中的格林函数在整个[布里渊区](@entry_id:142395)进行平均得到：
    $$
    G_{\mathrm{loc}}(i\omega_n) = \frac{1}{N_{\mathbf{k}}} \sum_{\mathbf{k}} G(\mathbf{k}, i\omega_n) = \frac{1}{N_{\mathbf{k}}} \sum_{\mathbf{k}} \frac{1}{i\omega_n + \mu - \epsilon_{\mathbf{k}} - \Sigma(i\omega_n)}
    $$
    这个积分也可以通过非相互作用态密度 $\rho_0(\epsilon)$ 来计算：
    $$
    G_{\mathrm{loc}}(i\omega_n) = \int_{-\infty}^{\infty} d\epsilon \frac{\rho_0(\epsilon)}{i\omega_n + \mu - \epsilon - \Sigma(i\omega_n)}
    $$
    这步操作将[晶格](@entry_id:196752)的全部信息（通过 $\rho_0(\epsilon)$）和一个猜测的[自能](@entry_id:145608) $\Sigma(i\omega_n)$ 结合起来，生成一个局域的观测量。

2.  **构建辅助杂质问题**: 我们构建一个辅助的[安德森杂质模型](@entry_id:137939)，其格林函数 $G_{\mathrm{imp}}(i\omega_n)$ 由杂质的[戴森方程](@entry_id:146246)给出：
    $$
    G_{\mathrm{imp}}^{-1}(i\omega_n) = \mathcal{G}_0^{-1}(i\omega_n) - \Sigma_{\mathrm{imp}}(i\omega_n)
    $$
    这里，$\Sigma_{\mathrm{imp}}(i\omega_n)$ 是[杂质模型](@entry_id:155988)的[自能](@entry_id:145608)，它由局域相互作用 $U$ 产生。$\mathcal{G}_0(i\omega_n)$ 被称为**魏斯有效场**（Weiss effective field），它代表了没有相互作用 $U$ 时杂质的格林函数，包含了电子浴的所有信息。通常，我们用**杂化函数** $\Delta(i\omega_n)$ 来参数化魏斯场：
    $$
    \mathcal{G}_0^{-1}(i\omega_n) = i\omega_n + \mu - \Delta(i\omega_n)
    $$
    杂化函数描述了杂质与电子浴之间的电子交换（“杂化”）过程。

3.  **施加自洽条件**: DMFT 的核心思想是，这个辅助[杂质模型](@entry_id:155988)必须精确地再现[晶格](@entry_id:196752)的局域物理。这通过施加一个自洽条件来实现：[杂质模型](@entry_id:155988)的（相互作用）格林函数必须等于[晶格](@entry_id:196752)的局域格林函数。
    $$
    G_{\mathrm{imp}}(i\omega_n) = G_{\mathrm{loc}}(i\omega_n)
    $$
    同时，我们认定杂质自能就是我们所求的[晶格](@entry_id:196752)局域自能，即 $\Sigma_{\mathrm{imp}}(i\omega_n) = \Sigma(i\omega_n)$。

4.  **更新魏斯场**: 结合上述两个[戴森方程](@entry_id:146246)和自洽条件，我们可以推导出更新魏斯场（或杂化函数）的方程。将 $\Sigma(i\omega_n)$ 和 $G_{\mathrm{loc}}(i\omega_n)$ 代入杂质[戴森方程](@entry_id:146246)，我们得到 ：
    $$
    G_{\mathrm{loc}}^{-1}(i\omega_n) = \mathcal{G}_0^{-1}(i\omega_n) - \Sigma(i\omega_n)
    $$
    整理后得到魏斯场的更新规则：
    $$
    \mathcal{G}_0^{-1}(i\omega_n) = G_{\mathrm{loc}}^{-1}(i\omega_n) + \Sigma(i\omega_n)
    $$
    这个方程是 DMFT 循环的核心。它告诉我们如何根据当前对[晶格](@entry_id:196752)局域格林函数和自能的估计，来构造下一步[杂质模型](@entry_id:155988)所处的有效环境。

**DMFT 循环流程总结**：
(a) 从一个初始的[自能](@entry_id:145608) $\Sigma(i\omega_n)$（例如，$\Sigma=0$）开始。
(b) 使用步骤 (1) 的积分计算局域[格林函数](@entry_id:147802) $G_{\mathrm{loc}}(i\omega_n)$。
(c) 使用步骤 (4) 的方程计算新的魏斯场 $\mathcal{G}_0(i\omega_n)$。
(d) 求解由该 $\mathcal{G}_0(i\omega_n)$ 和相互作用 $U$ 定义的[安德森杂质模型](@entry_id:137939)，得到新的杂质自能 $\Sigma_{\mathrm{imp}}(i\omega_n)$。这一步是计算上最昂贵的部分，需要专门的“杂质求解器”。
(e) 将新的杂质[自能](@entry_id:145608)作为对[晶格](@entry_id:196752)[自能](@entry_id:145608)的更新估计，即 $\Sigma(i\omega_n) \leftarrow \Sigma_{\mathrm{imp}}(i\omega_n)$，并返回步骤 (b)，重复此过程直至 $\Sigma(i\omega_n)$ 或 $G_{\mathrm{loc}}(i\omega_n)$ 收敛。

对于某些特殊的[晶格](@entry_id:196752)，这个循环可以进一步简化。例如，对于具有半圆形非相互作用态密度的[贝特晶格](@entry_id:139941)（Bethe lattice），在 $z \to \infty$ 极限下，自洽条件可以直接写成一个关于杂化函数的简洁形式  ：
$$
\Delta(\omega) = t^2 G_{\mathrm{imp}}(\omega)
$$
其中 $t$ 是经过标度后的有效[跃迁参数](@entry_id:267142)。这清晰地展示了杂质所处的环境（由 $\Delta$ 描述）是如何由杂质自身的行为（由 $G_{\mathrm{imp}}$ 描述）自洽决定的。

### 实际执行：杂质求解与解析延拓

DMFT 循环的理论框架虽然优美，但其实际执行依赖于两个关键的技术环节：求解[安德森杂质模型](@entry_id:137939)和从计算结果中提取物理谱函数。

**杂质求解器**

DMFT 循环的第 (d) 步——求解杂质问题——是整个计算的核心和瓶颈。由于[杂质模型](@entry_id:155988)本身就是一个[多体问题](@entry_id:138087)，精确求解它并不平凡。随着计算物理的发展，已经开发出多种“杂质求解器”，例如：
- **[量子蒙特卡洛](@entry_id:144383)（QMC）**：特别是连续时间 QMC（CT-QMC），它在[松原频率](@entry_id:197724)轴上进行[随机抽样](@entry_id:175193)，能够以可控的精度求解杂质问题，是目前最常用和最精确的方法之一。
- **数值重整化群（NRG）**：对于低温下的动力学性质非常精确，但计算成本较高。
- **精确[对角化](@entry_id:147016)（ED）**：将连续的电子浴近似为有限个离散能级，然后精确[对角化](@entry_id:147016)这个小尺寸的[哈密顿量](@entry_id:172864)。

在许多求解器（如 ED）中，一个关键步骤是将由魏斯场 $\mathcal{G}_0$ 所描述的连续电子浴近似为一个有限的、由 $N_b$ 个分立能级构成的浴。这需要一个拟合过程 。具体来说，代表离散浴的杂化函数具有如下形式：
$$
\Delta_{N_b}(i\omega_n) = \sum_{\ell=1}^{N_b} \frac{|V_{\ell}|^2}{i\omega_n - \epsilon_{\ell}}
$$
其中 $\{\epsilon_\ell, V_\ell\}$ 是 $N_b$ 个浴能级的位置和[耦合强度](@entry_id:275517)。我们的目标是寻找一组参数 $\{\epsilon_\ell, |V_\ell|^2\}$，使得 $\Delta_{N_b}(i\omega_n)$ 能够最好地复现从 DMFT 循环中得到的连续[目标函数](@entry_id:267263) $\Delta(i\omega_n)$。这通常通过最小化一个加权的最小二乘代价函数来实现：
$$
\chi^2 = \sum_{n=0}^{n_{\max}} w_n |\Delta_{N_b}(i\omega_n) - \Delta_{\mathrm{tar}}(i\omega_n)|^2
$$
权重 $w_n$ 的选取至关重要。由于低频物理（如[准粒子](@entry_id:136584)行为）对系统的性质影响最大，权重通常被设计为强调低频区域的拟合精度，例如采用洛伦兹形式的权重 $w_n = 1/(1 + (\omega_n/\omega_0)^2)$ 。

**解析延拓**

DMFT 计算通常在虚构的[松原频率](@entry_id:197724)轴 ($i\omega_n$) 上进行，因为这能保证格林函数等量的良好数学性质，便于数值处理。然而，实验上可测量的物理量，如态密度（[谱函数](@entry_id:147628)），是定义在实频率轴 ($\omega$) 上的。从松原轴上的离散数据 $G(i\omega_n)$ 恢复[实轴](@entry_id:148276)上的连续谱函数 $A(\omega)$ 的过程称为**解析延拓**（analytic continuation）。

两者之间的关系由一个[积分变换](@entry_id:186209)给出 ：
$$
G(i\omega_n) = \int_{-\infty}^{\infty} d\omega' \frac{A(\omega')}{i\omega_n - \omega'}
$$
从数学上看，这是一个Fredholm第一类积分方程的数值反演问题。当输入数据 $G(i\omega_n)$ 含有噪声（即使是微小的数值噪声）时，这个问题是典型的**[不适定问题](@entry_id:182873)**（ill-posed problem）。直接反演该方程会导致解的剧烈[振荡](@entry_id:267781)和不稳定。这是因为积分核 $K_n(\omega')=1/(i\omega_n-\omega')$ 是一个平滑算子，它会抑制 $A(\omega')$ 的高频细节；因此，反演过程会极大地放大 $G(i\omega_n)$ 中的高频噪声。

为了获得稳定且物理上合理的解，必须采用[正则化方法](@entry_id:150559)。**最大熵方法**（Maximum Entropy Method, MaxEnt）是一种基于贝叶斯概率理论的、被广泛使用的主流技术 。MaxEnt 的核心思想是在所有能够以一定容忍度（由 $\chi^2$ 衡量）拟[合数](@entry_id:263553)据的[谱函数](@entry_id:147628)中，寻找那个具有最大信息熵 $S$ 的解。这等价于最大化后验概率 $P[A|G] \propto \exp(\alpha S[A|m] - \frac{1}{2}\chi^2[A])$。这里的熵 $S[A|m]$ 通常定义为相对于一个“默认模型” $m(\omega)$ 的形式，它倾向于产生最平滑、最无特征的解，从而避免了[过拟合](@entry_id:139093)噪声。[正则化参数](@entry_id:162917) $\alpha$ 则平衡了对数据的保真度（小 $\chi^2$）和解的平滑度（大 $S$）之间的关系。

### 物理洞察：再探[莫特相变](@entry_id:137212)

装备了完整的 DMFT 机制后，我们现在可以回到最初的物理问题，并欣赏 DMFT 提供的深刻洞察。对于半填充的哈伯德模型，DMFT 的计算结果清晰地描绘了从金属到莫特绝缘体的转变过程  。

- 在弱关联区 ($U/W \ll 1$)，[谱函数](@entry_id:147628) $A(\omega)$ 在费米能级（$\omega=0$）处呈现一个尖锐的峰，这是费米液体[准粒子](@entry_id:136584)的标志。
- 随着 $U/W$ 的增加，这个[准粒子](@entry_id:136584)峰的权重 $Z$（也称为[准粒子](@entry_id:136584)[相干因子](@entry_id:147178)）减小，峰变得越来越窄。同时，在远离[费米能级](@entry_id:143215)的地方，两个宽阔的边带开始形成。它们被称为**下哈伯德带**和**上哈伯德带**，分别对应于从一个已被单占据的格点上移走一个电子和向其添加一个电子的激发过程，其能量间隔约为 $U$。
- 在零温下，当 $U$ 达到一个临界值 $U_{c2}$ 时，中心[准粒子](@entry_id:136584)峰的权重 $Z$ 完全消失。这标志着相干的[准粒子激发](@entry_id:138475)不复存在，电子被完[全局域](@entry_id:196542)化。这与 Gutzwiller 近似所预言的 Brinkman-Rice 图像是一致的，即莫特转变与 $Z \to 0$ 相关联 。
- DMFT 提供了比静态近似更丰富的信息。在有限温度下，这个[相变](@entry_id:147324)是一阶的，存在一个[相共存](@entry_id:147284)区。当 $U$ 在 $U_{c1}(T)$ 和 $U_{c2}(T)$ 之间时，金属态和绝缘态都可以作为亚稳解存在，导致[磁滞](@entry_id:145766)现象。

当系统被掺杂，偏离半填充时，DMFT 预言系统即使在强关联区也保持金属性。其谱函数呈现出标志性的三峰结构：中心有一个（权重被严重压低的）[准粒子](@entry_id:136584)峰，两侧是依然存在的下哈伯德带和上哈伯德带。这正是对[关联金属](@entry_id:142422)[电子结构](@entry_id:145158)的经典描绘，它成功解释了许多[强关联材料](@entry_id:198946)的光电子能谱实验结果。

综上所述，DMFT 通过其精巧的自洽映射机制，将一个不可解的[晶格](@entry_id:196752)[多体问题](@entry_id:138087)转化为一个可解的局域问题，为我们理解[强关联物理](@entry_id:273328)中的核心现象（如[莫特相变](@entry_id:137212)）提供了第一个系统的、非微扰的、并且是动力学的理论框架。