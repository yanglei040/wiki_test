{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在为你打下坚实的基础。我们将从一个简化的模型——一维紧束缚链——出发，解析地推导格林函数和谱函数。这项实践旨在将多体理论中这些抽象的核心概念具体化，揭示它们如何描述准粒子的能量和寿命。",
            "id": "3463231",
            "problem": "考虑一个无限长的一维紧束缚链，其晶格常数为 $a$，在位能为 $\\epsilon_{0}$，最近邻跃迁振幅为 $t$。设每格点的电子密度是均匀的且等于 $n$，并包含一个静态 Hartree 势 $U n$，该势在平均场水平上被处理为一个格点对角线上的能量移动。在零温下进行计算，并忽略所有动力学关联效应，这与静态自能近似是一致的。假设系统具有平移不变性和周期性边界条件，因此波矢 $k$ 是一个好量子数。\n\n使用多体微扰理论的基本定义和用于因果响应的推迟边界条件，推导在此静态 Hartree 近似下，该相互作用紧束缚系统的推迟单粒子格林函数 $G^{R}(k,\\omega)$ 和相应的谱函数 $A(k,\\omega)$ 的显式闭合形式表达式。将你的最终结果用 $k$, $\\omega$, $a$, $\\epsilon_{0}$, $t$, $U$, $n$ 以及在推迟函数中保证因果性的正无穷小量 $0^{+}$ 来表示。以解析表达式的形式给出你的最终答案；不需要进行数值计算或四舍五入。",
            "solution": "该问题要求在静态 Hartree 近似下，求解一维紧束缚链的推迟单粒子格林函数 $G^R(k,\\omega)$ 和谱函数 $A(k,\\omega)$。\n\n首先，我们建立系统的哈密顿量。对于一个在位能为 $\\epsilon_{0}$、最近邻跃迁振幅为 $t$ 的一维链，其紧束缚哈密顿量的无相互作用部分 $H_0$ 在格点基 $\\{|j\\rangle\\}$ 下表示为：\n$$\nH_0 = \\sum_{j} \\epsilon_{0} |j\\rangle\\langle j| - t \\sum_{j} \\left( |j\\rangle\\langle j+1| + |j+1\\rangle\\langle j| \\right)\n$$\n此处， $|j\\rangle$ 表示在格点 $j$ 处的电子态。我们采用了标准约定，即相邻格点之间的跃迁矩阵元为 $-t$。\n\n问题指明了一种静态 Hartree 势 $U n$ 形式的相互作用，其中 $U$ 是在位相互作用强度，$n$ 是每格点的均匀电子密度。在 Hartree 平均场近似中，这种相互作用被处理为一个静态的、格点对角线上的能量移动。这对应于一个静态的、与动量无关的自能 $\\Sigma = U n$。因此，完整的平均场哈密顿量 $H$ 为：\n$$\nH = H_0 + \\sum_{j} (U n) |j\\rangle\\langle j| = \\sum_{j} (\\epsilon_{0} + U n) |j\\rangle\\langle j| - t \\sum_{j} \\left( |j\\rangle\\langle j+1| + |j+1\\rangle\\langle j| \\right)\n$$\n我们可以定义一个有效的、重整化的在位能 $\\epsilon'_{0} = \\epsilon_{0} + U n$。现在，哈密顿量具有一个带有此重整化在位能的无相互作用紧束缚模型的形式：\n$$\nH = \\sum_{j} \\epsilon'_{0} |j\\rangle\\langle j| - t \\sum_{j} \\left( |j\\rangle\\langle j+1| + |j+1\\rangle\\langle j| \\right)\n$$\n由于平移不变性，波矢 $k$ 是一个好量子数。我们使用布洛赫态将哈密顿量变换到动量基（k空间），布洛赫态定义为 $|k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{j} e^{ikR_j} |j\\rangle$，其中 $R_j = ja$ 是格点 $j$ 的位置，$N$ 是总格点数。哈密顿量在此基下是对角的，其本征值由色散关系 $\\epsilon(k)$ 给出：\n$$\n\\epsilon(k) = \\langle k | H | k \\rangle = \\sum_{j'} e^{ik(R_{j'} - R_0)} \\langle 0 | H | j' \\rangle\n$$\n我们只需要考虑从一个参考格点（比如格点 0）到其相邻格点的矩阵元：\n\\begin{itemize}\n    \\item $\\langle 0 | H | 0 \\rangle = \\epsilon'_{0} = \\epsilon_0 + U n$\n    \\item $\\langle 0 | H | 1 \\rangle = -t$\n    \\item $\\langle 0 | H | {-1} \\rangle = -t$\n\\end{itemize}\n所有其他对于 $j' \\neq 0, \\pm 1$ 的矩阵元 $\\langle 0 | H | j' \\rangle$ 均为零。\n将这些代入 $\\epsilon(k)$ 的表达式中：\n$$\n\\epsilon(k) = (\\epsilon_0 + U n) \\cdot e^{ik(0)} + (-t) \\cdot e^{ika} + (-t) \\cdot e^{-ika}\n$$\n$$\n\\epsilon(k) = \\epsilon_0 + U n - t(e^{ika} + e^{-ika})\n$$\n使用欧拉公式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到准粒子能量色散：\n$$\n\\epsilon(k) = \\epsilon_0 + U n - 2t \\cos(ka)\n$$\n这表示在静态 Hartree 近似下单粒子激发的能量。系统等效地表现为一个具有此重整化能量色散的无相互作用系统。\n\n对于一个无相互作用的费米子（或在此情况下为准粒子）系统，单粒子推迟格林函数 $G^R(k, \\omega)$ 定义为：\n$$\nG^R(k, \\omega) = \\frac{1}{\\omega - \\epsilon(k) + i\\eta}\n$$\n其中 $\\eta$ 是一个正无穷小量，在问题中记为 $0^+$，它保证了因果性。代入推导出的 $\\epsilon(k)$ 表达式：\n$$\nG^R(k, \\omega) = \\frac{1}{\\omega - (\\epsilon_0 + U n - 2t \\cos(ka)) + i0^+}\n$$\n这可以重写为：\n$$\nG^R(k, \\omega) = \\frac{1}{\\omega - \\epsilon_0 - U n + 2t \\cos(ka) + i0^+}\n$$\n这是第一个所要求的表达式。\n\n接下来，我们推导谱函数 $A(k, \\omega)$。谱函数根据推迟格林函数的虚部定义：\n$$\nA(k, \\omega) = -\\frac{1}{\\pi} \\text{Im}[G^R(k, \\omega)]\n$$\n为了求虚部，我们使用恒等式 $\\frac{1}{x+iy} = \\frac{x-iy}{x^2+y^2}$。令 $x = \\omega - \\epsilon(k)$ 且 $y = \\eta = 0^+$。\n$$\nG^R(k, \\omega) = \\frac{(\\omega - \\epsilon(k)) - i\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2}\n$$\n虚部为：\n$$\n\\text{Im}[G^R(k, \\omega)] = -\\frac{\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2}\n$$\n将此代入 $A(k, \\omega)$ 的定义中：\n$$\nA(k, \\omega) = -\\frac{1}{\\pi} \\left( -\\frac{\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2} \\right) = \\frac{1}{\\pi} \\frac{\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2}\n$$\n在 $\\eta \\to 0^+$ 的极限下，此表达式是狄拉克 $\\delta$ 函数 $\\delta(\\omega - \\epsilon(k))$ 的一个标准表示。因此，谱函数为：\n$$\nA(k, \\omega) = \\delta(\\omega - \\epsilon(k))\n$$\n代入准粒子能量 $\\epsilon(k)$ 的完整表达式：\n$$\nA(k, \\omega) = \\delta(\\omega - (\\epsilon_0 + U n - 2t \\cos(ka)))\n$$\n谱函数的 $\\delta$ 函数形式表明，在此静态平均场近似中，准粒子具有无限寿命，因为没有包含引入散射或衰变的动力学关联效应。",
            "answer": "$$\n\\boxed{\\begin{gathered} G^{R}(k,\\omega) = \\frac{1}{\\omega - \\epsilon_0 - U n + 2t \\cos(ka) + i0^+} \\\\ A(k,\\omega) = \\delta(\\omega - (\\epsilon_0 + U n - 2t \\cos(ka))) \\end{gathered}}\n$$"
        },
        {
            "introduction": "从抽象理论转向实际应用，本练习模拟了真实$G_0W_0$计算的最后一步。利用为硅提供的自能数据，我们将计算准粒子能量修正和重整化因子$Z$。这将阐明自能的频率依赖性如何直接影响最终的能带结构，并揭示获得修正后带隙的计算过程。",
            "id": "3463347",
            "problem": "考虑一个晶体硅体系，在多体微扰理论框架下，使用 $G W$ 近似进行分析，并在单次计算 (single-shot) $G_{0} W_{0}$ 方案中进行评估。来自 Perdew–Burke–Ernzerhof (PBE) 广义梯度近似的 Kohn–Sham 本征值被用作零阶参考。准粒子能量由戴森方程定义，其中电子自能算符 $\\Sigma(\\omega)$ 取代了交换关联势 $V_{xc}$。为了获得准粒子修正，自能围绕每个态的 PBE 本征值进行线性化，而重整化因子 $Z$ 则源于自能对频率的导数。\n\n假设在 $\\Gamma$ 点的价带顶 (VBM) 和导带底 (CBM) 的 PBE 能量分别为 $E_{v}^{\\mathrm{PBE}} = 0.000~\\mathrm{eV}$ 和 $E_{c}^{\\mathrm{PBE}} = 0.640~\\mathrm{eV}$。对于这些态，在相应 PBE 能量处计算的差值 $\\Sigma(\\omega) - V_{xc}$ 的对角矩阵元由下式给出\n$$\n\\Delta\\Sigma_{v} \\equiv \\langle \\psi_{v} | \\Sigma(E_{v}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{v} \\rangle = -0.100~\\mathrm{eV}, \\quad\n\\Delta\\Sigma_{c} \\equiv \\langle \\psi_{c} | \\Sigma(E_{c}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{c} \\rangle = +0.600~\\mathrm{eV}.\n$$\n自能相对于频率的相应斜率（在 PBE 能量处计算的频率导数）为\n$$\ns_{v} \\equiv \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{v}^{\\mathrm{PBE}}} = -0.18, \\quad\ns_{c} \\equiv \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{c}^{\\mathrm{PBE}}} = -0.22,\n$$\n其中每个 $s$ 表示在所关心的态上 $\\partial \\Sigma / \\partial \\omega$ 的对角矩阵元。\n\n从这些数据出发，并根据 $G W$ 准粒子形式理论的第一性原理，计算：\n1. 分别对应于 VBM 和 CBM 的重整化因子 $Z_{v}$ 和 $Z_{c}$。\n2. 单次计算 $G_{0} W_{0}$ 带隙修正 $\\Delta E_{g}^{G_{0} W_{0}} \\equiv \\Delta E_{c} - \\Delta E_{v}$，其中 $\\Delta E_{n}$ 是对态 $n$ 的 PBE 本征值的准粒子修正。\n\n所有能量以 $\\mathrm{eV}$ 表示。将您的数值结果四舍五入到四位有效数字。将您的最终答案表示为有序三元组 $(Z_{v}, Z_{c}, \\Delta E_{g}^{G_{0} W_{0}})$。",
            "solution": "该问题是有效的，因为它在科学上基于多体微扰理论，数据充分、提法明确，且陈述客观。\n\n态 $n$ 的准粒子 (QP) 能量 $E_{n}^{\\mathrm{QP}}$ 是戴森方程的解。在能量壳上，并在 Kohn-Sham (KS) 轨道 $\\psi_n$ 的基组内，对角元的方程为：\n$$E_{n}^{\\mathrm{QP}} = E_{n}^{\\mathrm{KS}} + \\langle \\psi_{n} | \\Sigma(E_{n}^{\\mathrm{QP}}) - V_{xc} | \\psi_{n} \\rangle$$\n在此，$E_{n}^{\\mathrm{KS}}$ 是 Kohn-Sham 本征值（在本例中，来自 PBE 计算，为 $E_{n}^{\\mathrm{PBE}}$），$\\Sigma(\\omega)$ 是频率相关的电子自能算符，而 $V_{xc}$ 是来自底层密度泛函理论 (DFT) 计算的交换关联势。\n\n该方程对于 $E_{n}^{\\mathrm{QP}}$ 是非线性的。在单次计算 $G_0W_0$ 中，标准流程是将自能算符 $\\Sigma(\\omega)$ 围绕已知的 KS 本征值 $E_{n}^{\\mathrm{PBE}}$ 进行线性化。一阶泰勒展开得到：\n$$\\Sigma(E_{n}^{\\mathrm{QP}}) \\approx \\Sigma(E_{n}^{\\mathrm{PBE}}) + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}}$$\n将此近似代入戴森方程，可得：\n$$E_{n}^{\\mathrm{QP}} \\approx E_{n}^{\\mathrm{PBE}} + \\left\\langle \\psi_{n} \\left| \\Sigma(E_{n}^{\\mathrm{PBE}}) + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}} - V_{xc} \\right| \\psi_{n} \\right\\rangle$$\n我们可以分离各项：\n$$E_{n}^{\\mathrm{QP}} \\approx E_{n}^{\\mathrm{PBE}} + \\langle \\psi_{n} | \\Sigma(E_{n}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{n} \\rangle + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) \\left\\langle \\psi_{n} \\left| \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}} \\right| \\psi_{n} \\right\\rangle$$\n使用问题陈述中提供的记号表示态 $n$ 的对角矩阵元：\n$\\Delta\\Sigma_{n} = \\langle \\psi_{n} | \\Sigma(E_{n}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{n} \\rangle$\n$s_{n} = \\langle \\psi_{n} | \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}} | \\psi_{n} \\rangle$\n方程变为：\n$$E_{n}^{\\mathrm{QP}} = E_{n}^{\\mathrm{PBE}} + \\Delta\\Sigma_{n} + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) s_{n}$$\n我们现在求解 $E_{n}^{\\mathrm{QP}}$：\n$$E_{n}^{\\mathrm{QP}} - (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) s_{n} = E_{n}^{\\mathrm{PBE}} + \\Delta\\Sigma_{n}$$\n$$E_{n}^{\\mathrm{QP}}(1 - s_{n}) = E_{n}^{\\mathrm{PBE}}(1 - s_{n}) + \\Delta\\Sigma_{n}$$\n$$E_{n}^{\\mathrm{QP}} = E_{n}^{\\mathrm{PBE}} + \\frac{\\Delta\\Sigma_{n}}{1 - s_{n}}$$\n对 PBE 本征值的准粒子修正 $\\Delta E_{n}$ 定义为 $\\Delta E_{n} \\equiv E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}$。从上述方程，我们发现：\n$$\\Delta E_{n} = \\frac{\\Delta\\Sigma_{n}}{1 - s_{n}}$$\n重整化因子 $Z_{n}$ 由自能的频率导数定义。它量化了谱函数中准粒子峰的权重。根据线性化，其标准定义为：\n$$Z_{n} = \\frac{1}{1 - s_{n}}$$\n因此，QP 修正可以紧凑地写为 $\\Delta E_{n} = Z_{n} \\Delta\\Sigma_{n}$。\n\n我们得到以下关于价带顶 (v) 和导带底 (c) 的数据：\n对于 VBM：$E_{v}^{\\mathrm{PBE}} = 0.000~\\mathrm{eV}$，$\\Delta\\Sigma_{v} = -0.100~\\mathrm{eV}$，$s_{v} = -0.18$。\n对于 CBM：$E_{c}^{\\mathrm{PBE}} = 0.640~\\mathrm{eV}$，$\\Delta\\Sigma_{c} = +0.600~\\mathrm{eV}$，$s_{c} = -0.22$。\n\n1. 计算重整化因子 $Z_{v}$ 和 $Z_{c}$。\n对于 VBM：\n$$Z_{v} = \\frac{1}{1 - s_{v}} = \\frac{1}{1 - (-0.18)} = \\frac{1}{1.18} \\approx 0.8474576$$\n四舍五入到四位有效数字，$Z_{v} = 0.8475$。\n\n对于 CBM：\n$$Z_{c} = \\frac{1}{1 - s_{c}} = \\frac{1}{1 - (-0.22)} = \\frac{1}{1.22} \\approx 0.8196721$$\n四舍五入到四位有效数字，$Z_{c} = 0.8197$。\n\n2. 计算单次计算 $G_{0} W_{0}$ 带隙修正 $\\Delta E_{g}^{G_{0} W_{0}} = \\Delta E_{c} - \\Delta E_{v}$。\n首先，我们计算各自的 QP 修正 $\\Delta E_{v}$ 和 $\\Delta E_{c}$。\n\n对于 VBM：\n$$\\Delta E_{v} = \\frac{\\Delta\\Sigma_{v}}{1 - s_{v}} = \\frac{-0.100~\\mathrm{eV}}{1.18} \\approx -0.08474576~\\mathrm{eV}$$\n\n对于 CBM：\n$$\\Delta E_{c} = \\frac{\\Delta\\Sigma_{c}}{1 - s_{c}} = \\frac{0.600~\\mathrm{eV}}{1.22} \\approx 0.49180327~\\mathrm{eV}$$\n\n带隙修正是从 PBE 过渡到 $G_0W_0$ 时带隙能量的变化。PBE 带隙为 $E_{g}^{\\mathrm{PBE}} = E_{c}^{\\mathrm{PBE}} - E_{v}^{\\mathrm{PBE}}$。$G_0W_0$ 带隙为 $E_{g}^{G_0W_0} = E_{c}^{\\mathrm{QP}} - E_{v}^{\\mathrm{QP}}$。\n修正量为：\n$\\Delta E_{g}^{G_{0} W_{0}} = E_{g}^{G_0W_0} - E_{g}^{\\mathrm{PBE}} = (E_{c}^{\\mathrm{QP}} - E_{v}^{\\mathrm{QP}}) - (E_{c}^{\\mathrm{PBE}} - E_{v}^{\\mathrm{PBE}})$\n$\\Delta E_{g}^{G_{0} W_{0}} = (E_{c}^{\\mathrm{QP}} - E_{c}^{\\mathrm{PBE}}) - (E_{v}^{\\mathrm{QP}} - E_{v}^{\\mathrm{PBE}}) = \\Delta E_{c} - \\Delta E_{v}$\n代入计算值（为中间计算保留精度）：\n$$\\Delta E_{g}^{G_{0} W_{0}} \\approx (0.49180327 - (-0.08474576))~\\mathrm{eV}$$\n$$\\Delta E_{g}^{G_{0} W_{0}} \\approx 0.57654903~\\mathrm{eV}$$\n四舍五入到四位有效数字，$\\Delta E_{g}^{G_{0} W_{0}} = 0.5765~\\mathrm{eV}$。\n\n最终要求的答案是有序三元组 $(Z_{v}, Z_{c}, \\Delta E_{g}^{G_{0} W_{0}})$。\n$Z_{v} = 0.8475$\n$Z_{c} = 0.8197$\n$\\Delta E_{g}^{G_{0} W_{0}} = 0.5765$",
            "answer": "$$ \\boxed{ (0.8475, 0.8197, 0.5765) } $$"
        },
        {
            "introduction": "计算材料科学中的一个关键挑战是获得数值收敛的结果。本练习通过模拟$G_0W_0$计算的收敛性分析来解决这一问题，重点关注带隙如何依赖于关键的数值参数。你将开发并应用一个外推模型来确定无限极限下的带隙，这是任何从事大规模电子结构计算的研究人员都必须掌握的关键技能。",
            "id": "3463309",
            "problem": "要求您设计并实现一个自洽的计算程序，用以分析在多体微扰理论（MBPT）框架下，通过单次格林函数乘以屏蔽库仑相互作用方法（也称为零次迭代格林函数乘以屏蔽相互作用，$G_0W_0$）获得的带隙的收敛性。其目标是通过校正三种系统性的数值截断误差来源（空带数量、介电矩阵的平面波截断以及布里渊区采样分辨率），来估计无限极限下的准粒子带隙。您的程序必须从第一性原理出发，推导并实现一种有理论依据的外推策略，然后将其应用于一组给定的、由人工合成但物理上合理的数据集组成的测试套件。\n\n背景和基本定义：\n- 在MBPT中，准粒子带隙是通过求解戴森方程得到的，该方程中使用的自能算符由无相互作用的格林函数和屏蔽库仑相互作用构建。$G_0W_0$ 带隙依赖于屏蔽的精度，而屏蔽精度受以下因素控制：在有限数量的空带 $N_b$ 处截断的独立粒子极化率、由平面波截断能 $E_{\\mathrm{cut}}$ 截断的介电矩阵，以及由 $k$ 点数量 $N_k$ 控制的布里渊区采样。\n- 目标是将计算出的带隙外推到 $N_b \\to \\infty$、$E_{\\mathrm{cut}} \\to \\infty$ 和 $N_k \\to \\infty$ 的极限。\n\n任务：\n1. 从有效的MBPT基础（屏蔽的定义、极化率截断和数值布里渊区积分）出发，推导 $G_0W_0$ 带隙作为数值参数 $N_b$、$E_{\\mathrm{cut}}$ 和 $N_k$ 函数的渐进收敛行为。建立一个能够捕捉这些参数的领头阶截断误差依赖关系的模型，并得出一个数学上适定的、用于外推至无限极限的程序。\n2. 使用多元回归或等效的线性参数估计技术，在算法上实现所得到的外推模型，从而根据有限参数的数据确定无限极限带隙。\n3. 将您的程序应用于以下由人工合成的测量数据集组成的测试套件。每个数据集对应一个不同的材料类别。对于每种情况，给定九个数据点，其中一个参数变化，而另外两个参数保持固定。每个数据点是一个四元组 $(N_b, E_{\\mathrm{cut}}^{\\mathrm{Ry}}, N_k; E_g)$，其中 $E_{\\mathrm{cut}}^{\\mathrm{Ry}}$ 是以里德伯（Rydberg）为单位的介电截断能，$E_g$ 是以电子伏特（eV）为单位的 $G_0W_0$ 带隙。利用这些数据点来拟合您的模型，并为每种情况提取外推的无限极限带隙 $E_g^{\\infty}$。\n\n情况1（三维半导体；中等屏蔽）：\n- 固定 $E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 20$ 和 $N_k = 8$，改变 $N_b$： $(40, 20, 8; 3.05)$, $(80, 20, 8; 2.975)$, $(160, 20, 8; 2.9375)$。\n- 固定 $N_b = 120$ 和 $N_k = 8$，改变 $E_{\\mathrm{cut}}^{\\mathrm{Ry}}$： $(120, 10, 8; 3.15)$, $(120, 20, 8; 2.95)$, $(120, 40, 8; 2.85)$。\n- 固定 $N_b = 120$ 和 $E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 20$，改变 $N_k$： $(120, 20, 4; 3.15)$, $(120, 20, 8; 2.95)$, $(120, 20, 12; 2.8833333333)$。\n\n情况2（二维半导体；更强的有限尺寸效应）：\n- 固定 $E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 30$ 和 $N_k = 10$，改变 $N_b$： $(50, 30, 10; 2.36)$, $(100, 30, 10; 2.28)$, $(200, 30, 10; 2.24)$。\n- 固定 $N_b = 100$ 和 $N_k = 10$，改变 $E_{\\mathrm{cut}}^{\\mathrm{Ry}}$： $(100, 15, 10; 2.38)$, $(100, 30, 10; 2.28)$, $(100, 60, 10; 2.23)$。\n- 固定 $N_b = 100$ 和 $E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 30$，改变 $N_k$： $(100, 30, 5; 2.58)$, $(100, 30, 10; 2.28)$, $(100, 30, 15; 2.18)$。\n\n情况3（宽带隙三维绝缘体；弱的有限尺寸修正）：\n- 固定 $E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 40$ 和 $N_k = 10$，改变 $N_b$： $(60, 40, 10; 6.23)$, $(120, 40, 10; 6.165)$, $(240, 40, 10; 6.1525)$。\n- 固定 $N_b = 120$ 和 $N_k = 10$，改变 $E_{\\mathrm{cut}}^{\\mathrm{Ry}}$： $(120, 20, 10; 6.215)$, $(120, 40, 10; 6.165)$, $(120, 60, 10; 6.1483333333)$。\n- 固定 $N_b = 120$ 和 $E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 40$，改变 $N_k$： $(120, 40, 6; 6.225)$, $(120, 40, 10; 6.165)$, $(120, 40, 14; 6.1392857143)$。\n\n您的程序必须：\n- 实现从第一性原理推导出的外推策略。\n- 对每种情况，使用所有九个数据点拟合模型，并计算外推的无限极限带隙 $E_g^{\\infty}$。\n- 将每个 $E_g^{\\infty}$ 以电子伏特（$\\mathrm{eV}$）表示，并四舍五入到三位小数。\n- 生成单行输出，其中包含三个结果，格式为逗号分隔的列表并用方括号括起，例如 $[x_1,x_2,x_3]$。\n\n最终输出格式：\n- 单行输出：$[E_g^{\\infty}(\\mathrm{情况}\\ 1),E_g^{\\infty}(\\mathrm{情况}\\ 2),E_g^{\\infty}(\\mathrm{情况}\\ 3)]$，其中每个条目都是一个四舍五入到三位小数的浮点数，单位默认为 $\\mathrm{eV}$。\n\n不允许用户输入。所有需要的常量和数据都必须包含在您的程序中。不涉及角度。如果在内部使用了任何分数或比率，请以数值方式编码。程序必须是一个完整的、可运行的脚本，实现所推导的模型并计算所要求的输出。",
            "solution": "我们从多体微扰理论（MBPT）的基础和 $G_0W_0$ 近似开始。相对于 Kohn-Sham 理论，一个态 $\\psi_{n\\mathbf{k}}$ 的 $G_0W_0$ 准粒子能量移动由下式给出\n$$\n\\Delta E_{n\\mathbf{k}} = \\langle \\psi_{n\\mathbf{k}} | \\Sigma(E_{n\\mathbf{k}}) - V_{\\mathrm{xc}} | \\psi_{n\\mathbf{k}} \\rangle,\n$$\n其中 $\\Sigma$ 是由无相互作用格林函数 $G_0$ 和屏蔽库仑相互作用 $W_0$ 的卷积所构造的自能，而 $V_{\\mathrm{xc}}$ 是来自密度泛函理论的交换相关势。屏蔽库仑相互作用为\n$$\nW_0(\\mathbf{q},\\omega) = \\epsilon^{-1}(\\mathbf{q},\\omega) v(\\mathbf{q}),\n$$\n其中 $\\epsilon$ 是介电矩阵，$v$ 是裸库仑势。进入 $\\epsilon$ 的独立粒子极化率 $P^0$ 是通过对涉及占据态和空态的跃迁求和来计算的，介电矩阵则在由截断能截断的平面波基组中表示。对 $\\mathbf{q}$ 的布里渊区积分通过在有限 $k$ 点网格上的离散求和来近似。这些数值近似引入了必须被控制和外推的系统性截断误差。\n\n我们使用基于物理的论证来分析截断误差的渐进行为：\n\n1. 空带截断 ($N_b$)：\n独立粒子极化率 $P^0$ 包括向高能空态的跃迁。在大的跃迁能量 $\\omega$ 和高能带指数下，矩阵元衰减，而态密度随能量仅呈多项式增长（例如，在三维中对于类自由电子态，其增长与 $\\propto \\sqrt{E}$ 成正比）。被忽略的高能尾部的贡献可以通过对能量的积分来近似，其被积函数对于与屏蔽相关的频率，衰减速度近似为 $1/\\omega^2$ 或更快，这导致余项与所包含跃迁的上限成反比。当用所包含的空带数量 $N_b$ 作为索引时，这会产生一个领头阶误差，其行为如\n$$\n\\delta E_g(N_b) \\sim \\frac{a}{N_b},\n$$\n其中 $a$ 是某个依赖于材料的系数，单位为能量。这反映了随着包含更多能带，高能空态对屏蔽和自能的影响逐渐减小。\n\n2. 介电矩阵截断 ($E_{\\mathrm{cut}}$)：\n在平面波表示中，介电矩阵的截断由一个截断能 $E_{\\mathrm{cut}}$ 控制，该截断能限制了倒格矢模长 $|\\mathbf{G}|$ 的最大值。被忽略的大 $|\\mathbf{G}|$ 分量对局域场效应和短程屏蔽有贡献。对于足够大的 $E_{\\mathrm{cut}}$，随着包含更大的 $|\\mathbf{G}|$，截断余项减小，并且渐进地，其行为与截断能的倒数成正比，\n$$\n\\delta E_g(E_{\\mathrm{cut}}) \\sim \\frac{b}{E_{\\mathrm{cut}}},\n$$\n其中 $b$ 是一个依赖于材料的常数，单位为能量乘以能量。这种标度关系捕捉了缺失的主要局域场修正。\n\n3. 布里渊区采样 ($N_k$)：\n对布里渊区内涉及屏蔽相互作用和自能的函数的积分，通过在 $N_k$ 个点的网格上进行离散求和来近似。对于在 $\\mathbf{q}=\\mathbf{0}$ 处具有可积奇点（由于库仑核）的光滑被积函数，简单求和（矩形法则或未经特殊修正的 Monkhorst-Pack 网格）的误差与采样点数的倒数成正比，\n$$\n\\delta E_g(N_k) \\sim \\frac{c}{N_k},\n$$\n其中常数 $c$ 由屏蔽相互作用的长程行为以及能带边缘附近的色散关系确定。这与连续函数的黎曼和的收敛速度以及半导体和绝缘体中准粒子能量收敛的经验观察结果一致。\n\n在假设这三个误差源在领头阶上弱耦合的前提下，我们可以为使用有限参数 $(N_b, E_{\\mathrm{cut}}, N_k)$ 计算的 $G_0W_0$ 带隙 $E_g$ 写出一个可分离的领头阶模型：\n$$\nE_g(N_b, E_{\\mathrm{cut}}, N_k) = E_g^{\\infty} + \\frac{a}{N_b} + \\frac{b}{E_{\\mathrm{cut}}} + \\frac{c}{N_k},\n$$\n其中 $E_g^{\\infty}$ 是无限极限带隙，而 $(a,b,c)$ 是拟合系数，它们编码了相应截断误差的幅度。该模型在变换后的变量 $(N_b^{-1}, E_{\\mathrm{cut}}^{-1}, N_k^{-1})$ 和截距 $E_g^{\\infty}$ 上是线性的。\n\n算法外推策略：\n- 对每种材料情况，收集测量数据 $\\{(N_b^{(i)}, E_{\\mathrm{cut}}^{(i)}, N_k^{(i)}, E_g^{(i)})\\}_{i=1}^M$。\n- 构建设计矩阵 $X \\in \\mathbb{R}^{M \\times 4}$，其行为：\n$$\nX_i = \\left[ \\frac{1}{N_b^{(i)}}, \\frac{1}{E_{\\mathrm{cut}}^{(i)}}, \\frac{1}{N_k^{(i)}}, 1 \\right],\n$$\n以及目标向量 $y \\in \\mathbb{R}^M$，其分量为 $y_i = E_g^{(i)}$。\n- 求解线性最小二乘问题：\n$$\n\\min_{\\theta \\in \\mathbb{R}^4} \\| X \\theta - y \\|_2^2,\n$$\n其中 $\\theta = [a, b, c, E_g^{\\infty}]^{\\top}$。通过伪逆或标准的最小二乘求解器可以获得数值上稳定的解。\n- 从 $\\theta$ 中提取 $E_g^{\\infty}$。\n- 将每个 $E_g^{\\infty}$ 四舍五入到三位小数，并以电子伏特为单位报告。\n\n在测试套件上的应用：\n每种情况都提供了九个数据点，这些数据点的生成与上述可分离的领头阶行为一致。通过将模型拟合到这些数据，可以获得外推的无限极限带隙。数据集的构建方式使得恢复的 $E_g^{\\infty}$ 值具有代表性且在科学上是合理的。对每种情况使用所有九个点可确保回归是良态的，并且系数 $(a,b,c)$ 可以被分离出来。\n\n实现细节：\n- 不使用外部输入；数据嵌入在程序中。\n- 拟合使用一个稳健的最小二乘求解器进行，例如 $\\texttt{numpy.linalg.lstsq}$，它计算使残差的欧几里得范数最小化的 $\\theta$。\n- 求解后，从 $\\theta$ 的截距分量中提取无限极限带隙 $E_g^{\\infty}$。\n- 最终输出打印为单行列表，其中的值以 $\\mathrm{eV}$ 为单位并四舍五入到三位小数。\n\n预期结果：\n将该算法应用于所提供的数据集，会得到对每种情况都接近嵌入的无限极限目标的 $E_g^{\\infty}$ 值。最终程序以要求的格式计算并打印出三个外推值：一个单行列表 $[E_g^{\\infty}(\\mathrm{情况}\\ 1),E_g^{\\infty}(\\mathrm{情况}\\ 2),E_g^{\\infty}(\\mathrm{情况}\\ 3)]$，单位为 $\\mathrm{eV}$，并四舍五入到三位小数。",
            "answer": "[2.500,1.800,5.960]"
        }
    ]
}