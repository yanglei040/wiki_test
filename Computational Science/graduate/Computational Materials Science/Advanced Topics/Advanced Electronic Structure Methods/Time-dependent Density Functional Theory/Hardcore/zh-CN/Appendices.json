{
    "hands_on_practices": [
        {
            "introduction": "为了计算材料的光学吸收谱，含时密度泛函理论（TDDFT）提供了两种主要的计算路径：频域中的线性响应（LR）方法（通常称为Casida形式主义）和时域中的实时（RT）方法。尽管这两种方法表面上看起来不同，但它们在形式上是等价的。第一个练习将引导您通过动手实践来证明这种等价性，从而巩固您对两种方法的理论基础和实际应用的理解 ()。",
            "id": "3497347",
            "problem": "你需要实现、验证并比较含时密度泛函理论 (TDDFT) 中光学振子强度的两种等价表述：线性响应 Casida 形式主义和实时 delta-kick 方法。你的目标是从基本定义出发，推导出使用 Casida 本征矢量的振子强度的线性响应表达式，然后通过数值方法证明，这些振子强度与施加弱脉冲场 (delta-kick) 后从时域偶极动力学中提取的振子强度相等。整个过程使用原子单位，即能量单位为 Hartree，时间单位为原子时间单位，偶极矩矩阵元单位为 Bohr。振子强度是无量纲的。\n\n从以下基本基础开始：\n- Kohn-Sham 轨道 $\\{\\phi_{k}(\\mathbf{r},t)\\}$ 在含时 Kohn-Sham 势 $v_{s}[\\rho](\\mathbf{r},t)$ 下的含时 Kohn-Sham (TDKS) 方程。\n- 线性响应的定义，即弱外部微扰导致的可观测量的一阶变化。\n- 在粒子-空穴基中，激发能的标准 Casida 方程结构，其中矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$ 由 Kohn-Sham 单粒子能量差和双粒子相互作用核构建。\n- 以基态和激发态之间的跃迁偶极矩矩阵元表示的振子强度定义。\n- 实时 delta-kick 方法：在 $t=0$ 时施加一个脉冲电场，并记录在 $t0$ 时诱导的偶极矩 $d_{\\alpha}(t)$，其中 $\\alpha \\in \\{x,y,z\\}$。\n\n你的实现必须按以下步骤进行：\n1. 在独立粒子（无耦合核）极限下实现线性响应路径。在此极限下，Casida $\\mathbf{A}$ 矩阵是对角的，其对角元等于 Kohn-Sham 跃迁能 $\\omega_{n}$，且 $\\mathbf{B}=\\mathbf{0}$。此时，Casida 本征矢量选择单个跃迁。利用这一点，从 Casida 本征矢量和给定的 Kohn-Sham 跃迁偶极矢量 $\\mathbf{d}_{n} = (d_{n,x}, d_{n,y}, d_{n,z})$ 计算振子强度。使用所有三个笛卡尔分量计算各向同性振子强度。\n2. 实现实时路径，方法是在 $t=0$ 时施加一个振幅为 $k$ 的弱脉冲场，在间距为 $\\Delta t$ 的均匀网格上记录 $t \\in (0,T]$ 范围内的诱导偶极分量 $d_{\\alpha}(t)$。假设处于独立粒子机制下，因此诱导偶极矩是在 Kohn-Sham 跃迁能处的一系列正弦函数的叠加。使用最小二乘投影到已知跃迁频率下的已知正弦基上，以提取分量分辨的振幅并重构振子强度。\n3. 通过计算每个测试案例中，由 Casida 路径获得的振子强度与从实时路径中提取的振子强度之间的最大绝对差来证明等价性。\n\n使用以下科学一致的测试套件。每个测试案例提供一组由跃迁能和跃迁偶极矢量表征的跃迁。所有案例使用共同的时间网格，总时长 $T = 6000$（原子单位），时间步长 $\\Delta t = 0.5$（原子单位），以及 kick 振幅 $k = 10^{-4}$（原子单位）。对于每个案例，同等对待 $x$、$y$ 和 $z$ 方向，并在各向同性振子强度中包含跃迁偶极矢量的所有三个分量。\n\n- 测试案例 A（单个跃迁，所有分量非零）：\n  - 跃迁：一个跃迁，能量 $\\omega_{1} = 0.7$，偶极矢量 $\\mathbf{d}_{1} = (0.8, 0.3, 0.1)$。\n\n- 测试案例 B（多个跃迁，其中一个为对称性禁戒）：\n  - 跃迁：三个跃迁，其能量和偶极矢量为\n    - $\\omega_{1} = 0.5$, $\\mathbf{d}_{1} = (0.6, 0, 0)$,\n    - $\\omega_{2} = 1.2$, $\\mathbf{d}_{2} = (0, 0, 0)$,\n    - $\\omega_{3} = 1.8$, $\\mathbf{d}_{3} = (0.2, 0.3, 0.4)$。\n\n- 测试案例 C（近简并跃迁以测试频率分辨率）：\n  - 跃迁：三个跃迁，其能量和偶极矢量为\n    - $\\omega_{1} = 0.300$, $\\mathbf{d}_{1} = (0.4, 0.1, 0)$,\n    - $\\omega_{2} = 0.305$, $\\mathbf{d}_{2} = (0.1, 0.3, 0.05)$,\n    - $\\omega_{3} = 0.9$, $\\mathbf{d}_{3} = (0.2, 0, 0.1)$。\n\n要求和约束：\n- 两种路径都严格在独立粒子极限下工作。\n- 在线性响应路径中，在粒子-空穴基中构建 Casida 问题，其中 $\\mathbf{A}$ 的对角元等于给定的 $\\omega_{n}$ 且 $\\mathbf{B}=\\mathbf{0}$，并使用以 Casida 振幅和跃迁偶极矩表示的振子强度定义，为每个测试案例中的所有跃迁计算各向同性振子强度。\n- 在实时路径中，在 $t=0$ 时施加一个振幅为 $k$ 的 delta-kick，并在网格 $t_{m} = m \\Delta t$ 上记录 $d_{\\alpha}(t)$，其中 $m=1,2,\\dots,M$ 使得 $M \\Delta t = T$。将诱导偶极矩建模为在已知跃迁频率下的正弦函数的线性叠加，并通过最小二乘投影恢复振幅系数。使用这些系数重构各向同性振子强度。\n- 对于每个测试案例，计算一个标量值：线性响应和实时方法得到的振子强度集合之间的最大绝对偏差。这些标量是无量纲的，必须以四舍五入到十位小数的十进制浮点数形式打印。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个类似 Python 列表字面量的结果，该列表包含与测试案例 A、B 和 C 相对应的三个标量结果，按顺序排列，并四舍五入到十位小数，例如，\"[0.0000000001,0.0000000002,0.0000000003]\"。\n- 不应打印任何额外文本。\n\n物理单位和约定：\n- 使用原子单位。能量 $\\omega_{n}$ 的单位是 Hartree，偶极分量的单位是 Bohr，时间的单位是原子时间单位。振子强度无单位。",
            "solution": "该问题是有效的。它在科学上基于含时密度泛函理论的原理，问题设定良好（well-posed），提供了所有必要的常数和条件，并且表述客观。任务是在简化的无相互作用粒子极限下，证明用于计算振子强度的线性响应 (Casida) 方法和实时 (delta-kick) 方法在形式上的等价性。\n\n我们将首先在每种形式主义中推导振子强度的表达式，然后描述用于验证其等价性的数值程序。我们完全在原子单位下工作，其中 $\\hbar = m_e = e = 4\\pi\\epsilon_0 = 1$。\n\n### 理论框架\n\n对于从基态 $\\Psi_0$ 到激发态 $\\Psi_I$（激发能为 $\\Omega_I = E_I - E_0$）的电子激发，其振子强度 $f_{0 \\to I}$ 是一个衡量跃迁概率的无量纲量。各向同性平均表达式由下式给出：\n$$\nf_I = \\frac{2}{3} \\Omega_I \\sum_{\\alpha \\in \\{x,y,z\\}} |\\langle \\Psi_0 | \\hat{r}_\\alpha | \\Psi_I \\rangle|^2\n$$\n其中 $\\hat{\\mathbf{r}} = (\\hat{r}_x, \\hat{r}_y, \\hat{r}_z)$ 是位置算符。\n\n问题要求我们使用 TDDFT 独立粒子近似中的两种不同但等价的方法来评估这个量。在此极限下，相互作用的 Kohn-Sham 响应核被忽略。激发态 $\\Psi_I$ 被认为是纯粹的从一个占据的 Kohn-Sham 轨道 $\\phi_i$ 到一个虚轨道 $\\phi_a$ 的单粒子-空穴激发。我们用索引 $n=(i,a)$ 来表示这样的跃迁。\n\n#### 1. 线性响应 (Casida) 形式主义\n\n在独立粒子极限下，Casida 矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$ 显著简化。由交换相关核相互作用产生的矩阵 $\\mathbf{B}$ 变为零矩阵，即 $\\mathbf{B}=\\mathbf{0}$。矩阵 $\\mathbf{A}$ 在粒子-空穴基中变为对角的，其对角元是 Kohn-Sham 轨道能量差，$A_{ia,jb} = (\\epsilon_a - \\epsilon_i) \\delta_{ij}\\delta_{ab} = \\omega_n \\delta_{n,m}$，其中 $n=(i,a)$ 且 $m=(j,b)$。\n\n因此，TDDFT 激发能 $\\Omega_n$ 变得与 Kohn-Sham 跃迁能 $\\omega_n$ 相同。相应的激发态 $\\Psi_n$ 是一个对应于跃迁 $n$ 的单组态态。跃迁偶极矩矩阵元简化为：\n$$\n\\langle \\Psi_0 | \\hat{r}_\\alpha | \\Psi_n \\rangle \\rightarrow \\langle \\phi_i | \\hat{r}_\\alpha | \\phi_a \\rangle \\equiv d_{n,\\alpha}\n$$\n问题直接提供了这些跃迁能 $\\omega_n$ 和偶极矢量 $\\mathbf{d}_n = (d_{n,x}, d_{n,y}, d_{n,z})$。\n\n将这些代入振子强度的基本表达式，我们得到线性响应路径的公式：\n$$\nf_{n, \\text{LR}} = \\frac{2}{3} \\omega_n \\sum_{\\alpha \\in \\{x,y,z\\}} |d_{n,\\alpha}|^2 = \\frac{2}{3} \\omega_n |\\mathbf{d}_n|^2\n$$\n这为基于给定跃迁性质的振子强度提供了一个直接的解析结果。\n\n#### 2. 实时 Delta-Kick 形式主义\n\n实时方法通过在时间 $t=0$ 施加一个弱的、脉冲式的电场微扰，并观察随后偶极矩的演化来探测系统的动态响应。我们执行三个独立的模拟，每个笛卡尔方向 $\\alpha \\in \\{x,y,z\\}$ 一次。对于在 $\\alpha$ 方向的 kick，外部电场为 $\\mathbf{E}(t) = k \\delta(t) \\hat{\\mathbf{e}}_\\alpha$，其中 $k$ 是小的 kick 强度。\n\n该场对应一个含时势 $V_{\\text{ext}}(t) = -\\mathbf{r} \\cdot \\mathbf{E}(t) = -k r_\\alpha \\delta(t)$。在一级含时微扰理论中，系统在时间 $t0$ 的状态由 $\\Psi(t) = e^{-i\\hat{H}_0 t} \\Psi(0^+)$ 给出，其中 $\\hat{H}_0$ 是未微扰哈密顿量，且 $\\Psi(0^+) \\approx (1 + ik r_\\alpha) \\Psi_0$。\n\n由方向 $\\alpha$ 的 kick 引起的 $\\beta$ 方向的诱导偶极矩，记为 $\\delta d_{\\beta}^{(\\alpha)}(t)$，由以下公式给出：\n$$\n\\delta d_{\\beta}^{(\\alpha)}(t) = \\langle \\Psi(t) | \\hat{r}_\\beta | \\Psi(t) \\rangle - \\langle \\Psi_0 | \\hat{r}_\\beta | \\Psi_0 \\rangle\n$$\n在 $k$ 的一阶展开，并假设基态没有永久偶极矩，我们发现：\n$$\n\\delta d_{\\beta}^{(\\alpha)}(t) = i k \\langle \\Psi_0 | [\\hat{r}_\\beta(t), \\hat{r}_\\alpha] | \\Psi_0 \\rangle\n$$\n其中 $\\hat{r}_\\beta(t) = e^{i\\hat{H}_0 t} \\hat{r}_\\beta e^{-i\\hat{H}_0 t}$ 是相互作用绘景中的算符。插入 $\\hat{H}_0$ 的一组完备本征态并使用独立粒子近似，得到：\n$$\n\\delta d_{\\beta}^{(\\alpha)}(t) = 2k \\sum_n d_{n,\\beta} d_{n,\\alpha} \\sin(\\omega_n t)\n$$\n在此过程中，我们关心平行于 kick 方向的响应，即 $\\beta = \\alpha$。信号为：\n$$\nd_{\\alpha}^{(\\alpha)}(t) = 2k \\sum_n (d_{n,\\alpha})^2 \\sin(\\omega_n t)\n$$\n该方程表明，含时偶极矩是正弦函数的叠加，以系统的自然跃迁频率 $\\omega_n$ 振荡。每个正弦分量的振幅与跃迁偶极矩分量的平方 $(d_{n,\\alpha})^2$ 成正比。\n\n### 数值实现与验证\n\n策略是从模拟的实时信号中数值提取振幅，并重建振子强度，然后将它们与解析的线性响应结果进行比较。\n\n1.  **线性响应计算**：对于每个测试案例，我们遍历其给定的跃迁 ($n$)。对于每个跃迁，我们使用公式 $f_{n, \\text{LR}} = \\frac{2}{3} \\omega_n |\\mathbf{d}_n|^2$ 计算振子强度 $f_{n, \\text{LR}}$。\n\n2.  **实时模拟与提取**：\n    *   我们定义一个均匀时间网格 $t_m = m \\Delta t$，其中 $m=1, 2, \\dots, M$，且 $M\\Delta t = T$。\n    *   我们遍历三个笛卡尔方向 $\\alpha \\in \\{x,y,z\\}$。\n    *   对于每个方向 $\\alpha$，我们使用上面推导的公式生成“测量”的偶极信号 $y_m = d_{\\alpha}^{(\\alpha)}(t_m)$。\n    *   该信号可以写成基函数的线性组合：$y(t) = \\sum_n C_{n,\\alpha} \\sin(\\omega_n t)$，其中系数为 $C_{n,\\alpha} = 2k (d_{n,\\alpha})^2$。\n    *   为了从信号中找到这些系数，我们解决一个线性最小二乘问题。我们建立系统 $\\mathbf{y} = \\mathbf{S} \\mathbf{c}_\\alpha$，其中 $\\mathbf{y}$ 是信号值向量 $[y_1, \\dots, y_M]^T$，$\\mathbf{S}$ 是基矩阵，其元素为 $S_{mn} = \\sin(\\omega_n t_m)$，$\\mathbf{c}_\\alpha$ 是未知系数向量 $[C_{1,\\alpha}, C_{2,\\alpha}, \\dots]^T$。最小二乘解 $\\mathbf{c}_\\alpha = (\\mathbf{S}^T\\mathbf{S})^{-1}\\mathbf{S}^T\\mathbf{y}$ 通过数值方法计算，例如使用 `numpy.linalg.lstsq`。\n    *   从恢复的系数 $C_{n,\\alpha}$ 中，我们计算跃迁偶极矩分量的平方：$(d_{n,\\alpha,\\text{RT}})^2 = C_{n,\\alpha} / (2k)$。此步骤对每个跃迁 $n$ 执行。\n\n3.  **重建与比较**：\n    *   遍历所有三个 kick 方向后，我们得到了每个跃迁 $n$ 的数值恢复的偶极分量 $(d_{n,x,\\text{RT}})^2, (d_{n,y,\\text{RT}})^2, (d_{n,z,\\text{RT}})^2$。\n    *   我们将它们相加得到总偶极矩平方：$|\\mathbf{d}_{n,\\text{RT}}|^2 = \\sum_\\alpha (d_{n,\\alpha,\\text{RT}})^2$。\n    *   然后我们计算实时振子强度：$f_{n, \\text{RT}} = \\frac{2}{3} \\omega_n |\\mathbf{d}_{n,\\text{RT}}|^2$。\n    *   最后，对于每个测试案例，我们计算其所有跃迁的绝对差集合 $\\{|f_{n, \\text{LR}} - f_{n, \\text{RT}}|\\}$，并报告该集合中的最大值。相对于振荡周期而言，较长的模拟时间 $T$ 确保了基函数近似正交，从而得到稳定的最小二乘拟合，最终的差异接近机器精度，因此证明了两种形式主义的等价性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements, verifies, and compares linear-response and real-time formulations\n    of optical oscillator strengths within Time-Dependent Density Functional Theory (TDDFT)\n    in the independent-particle limit.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    T = 6000.0  # Total simulation time in atomic units\n    dt = 0.5    # Time step in atomic units\n    k = 1e-4    # Kick amplitude in atomic units\n\n    # --- Test Case Definitions ---\n    # Each case: list of transitions.\n    # Each transition: tuple of (energy, (dx, dy, dz))\n    test_cases = [\n        # Test Case A: single transition\n        [\n            (0.7, (0.8, 0.3, 0.1)),\n        ],\n        # Test Case B: multiple transitions, one forbidden\n        [\n            (0.5, (0.6, 0.0, 0.0)),\n            (1.2, (0.0, 0.0, 0.0)),\n            (1.8, (0.2, 0.3, 0.4)),\n        ],\n        # Test Case C: near-degenerate transitions\n        [\n            (0.300, (0.4, 0.1, 0.0)),\n            (0.305, (0.1, 0.3, 0.05)),\n            (0.9,   (0.2, 0.0, 0.1)),\n        ],\n    ]\n\n    # --- Time Grid ---\n    num_steps = int(T / dt)\n    time_grid = np.arange(1, num_steps + 1) * dt\n\n    final_results = []\n\n    for transitions in test_cases:\n        num_transitions = len(transitions)\n        omegas = np.array([t[0] for t in transitions])\n        dipoles = np.array([t[1] for t in transitions])\n\n        # --- Route 1: Linear-Response (Casida) Calculation ---\n        # f_n = (2/3) * omega_n * |d_n|^2\n        f_lr = (2.0 / 3.0) * omegas * np.sum(dipoles**2, axis=1)\n\n        # --- Route 2: Real-Time Delta-Kick Calculation ---\n        \n        # This will store the recovered squared dipole components [d_nx^2, d_ny^2, d_nz^2] for each transition n\n        d_sq_rt = np.zeros((num_transitions, 3))\n        \n        # Construct the sine basis matrix S: S_mn = sin(omega_n * t_m)\n        # S has shape (num_steps, num_transitions)\n        S = np.sin(np.outer(time_grid, omegas))\n        \n        # Perform calculations for each Cartesian direction (kick in x, y, z)\n        for alpha in range(3):  # 0:x, 1:y, 2:z\n            # Get the dipole components for the current direction\n            d_alpha_components = dipoles[:, alpha]\n            \n            # Generate the ideal time-domain dipole signal\n            # d_alpha(t) = 2 * k * sum_n [ d_{n,alpha}^2 * sin(omega_n * t) ]\n            d_alpha_sq = d_alpha_components**2\n            amplitudes = 2.0 * k * d_alpha_sq\n            \n            # Signal y is a vector of length num_steps\n            signal = S @ amplitudes\n            \n            # Solve the least-squares problem: S * c = signal\n            # np.linalg.lstsq returns a tuple; the first element is the solution vector c.\n            # rcond=None ensures use of machine precision for cutoff.\n            coeffs, _, _, _ = np.linalg.lstsq(S, signal, rcond=None)\n            \n            # Recover squared dipole components from coefficients: C_n,alpha = 2k * d_n,alpha^2\n            recovered_d_sq = coeffs / (2.0 * k)\n            d_sq_rt[:, alpha] = recovered_d_sq\n            \n        # Reconstruct oscillator strengths from the recovered dipole components\n        f_rt = (2.0 / 3.0) * omegas * np.sum(d_sq_rt, axis=1)\n        \n        # --- Comparison ---\n        # Calculate the maximum absolute deviation for the current test case\n        max_deviation = np.max(np.abs(f_lr - f_rt))\n        final_results.append(max_deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.10f}' for r in final_results])}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "尽管标准的TDDFT近似（如绝热局域密度近似ALDA）功能强大，但它们存在着一些众所周知的系统性缺陷。其中最著名的一个是无法正确描述电荷转移（CT）激发，而这类激发在分子电子学和光化学中至关重要。本练习将引导您对这一问题进行定量分析，通过比较ALDA与范围分离杂化（RSH）泛函的性能，您将理解为何前者会失效，以及后者如何提供一个稳健的解决方案 ()。通过分析误差对距离 $R$ 的依赖关系（特别是缺失的 $-1/R$ 行为），您将对TDDFT中最关键的挑战之一及其现代解决方法获得深刻的定量认识。",
            "id": "3497374",
            "problem": "开发一个程序，用于在含时密度泛函理论 (TDDFT) 中对一个良好分离的给体-受体对的电荷转移激发能的渐进行为进行建模、分析和量化。目的是在线性响应机制下，比较绝热局域密度近似 (ALDA) 和范围分离杂化 (RSH) 公式的表现，重点关注是否存在与 $1/R$ 成比例变化的长程电子-空穴吸引项。所有计算必须在原子单位下进行，能量单位为哈特里 (Hartree)，距离单位为玻尔 (Bohr)。您的输出必须是单行，其中包含一个如下文所述的、由方括号括起来的逗号分隔列表。\n\n基本基础和建模假设：\n- 考虑一个电离能为 $I_D$ 的给体和一个电子亲和能为 $A_A$ 的受体。对于大分离距离 $R$ 且轨道重叠可忽略不计的情况，精确的最低电荷转移激发能模型为\n$$\nE_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (I_D - A_A) - \\frac{1}{R}\n$$\n单位为原子单位。\n- 在使用绝热局域密度近似 (ALDA) 核的线性响应 TDDFT 中，对 Kohn–Sham 能量差的核修正随重叠而衰减，在大的 $R$ 处可以忽略。设 $\\Delta_{\\mathrm{xc}}$ 表示交换相关势的导数不连续性。则 ALDA 的预测模型为\n$$\nE_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) = (I_D - A_A) - \\Delta_{\\mathrm{xc}}\n$$\n与 $R$ 无关。\n- 对于在核中包含百分之百长程精确交换的范围分离杂化 (RSH) 方法，长程电子-空穴吸引得以恢复。设 $\\delta_{\\mathrm{RSH}}$ 表示有效带隙中的一个常数短程偏差。则 RSH 的预测模型为\n$$\nE_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) = (I_D - A_A) - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}\n$$\n\n对于下述每个测试用例，执行以下操作：\n1. 将该用例给定的常数定义为 $E_{\\mathrm{gap}} \\equiv (I_D - A_A)$。在每个指定的 $R$ 值下，计算精确的电荷转移激发能 $E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)$。\n2. 在每个 $R$ 值下，计算 ALDA 预测值 $E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R)$ 和 RSH 预测值 $E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R)$。\n3. 将模型误差定义为\n$$\n\\varepsilon_{\\mathrm{ALDA}}(R) = E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R), \\quad \\varepsilon_{\\mathrm{RSH}}(R) = E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)\n$$\n4. 对每种方法，执行误差对 $x = 1/R$ 的线性回归：\n$$\n\\varepsilon \\approx m x + b\n$$\n并报告拟合的斜率 $m$ 和截距 $b$。\n5. 对每种方法，计算在一组 $R$ 值上的最大绝对误差：\n$$\n\\varepsilon_{\\max} = \\max_{R} \\left| \\varepsilon(R) \\right|\n$$\n\n测试套件（三个独立的参数集），全部采用原子单位（能量为哈特里，距离为玻尔）：\n- 用例 1：$E_{\\mathrm{gap}} = 0.30$，$\\Delta_{\\mathrm{xc}} = 0.15$，$\\delta_{\\mathrm{RSH}} = 0.02$，$R \\in \\{ 5.0, 8.0, 12.0, 20.0 \\}$。\n- 用例 2：$E_{\\mathrm{gap}} = 0.22$，$\\Delta_{\\mathrm{xc}} = 0.00$，$\\delta_{\\mathrm{RSH}} = 0.01$，$R \\in \\{ 10.0, 15.0, 25.0, 50.0 \\}$。\n- 用例 3：$E_{\\mathrm{gap}} = 0.45$，$\\Delta_{\\mathrm{xc}} = 0.20$，$\\delta_{\\mathrm{RSH}} = 0.05$，$R \\in \\{ 3.0, 4.0, 5.0, 10.0 \\}$。\n\n每个用例所需的输出：\n- ALDA 误差的拟合斜率和截距，记为 $m_{\\mathrm{ALDA}}$ 和 $b_{\\mathrm{ALDA}}$。\n- RSH 误差的拟合斜率和截距，记为 $m_{\\mathrm{RSH}}$ 和 $b_{\\mathrm{RSH}}$。\n- ALDA 的最大绝对误差，$\\varepsilon_{\\max}^{\\mathrm{ALDA}}$。\n- RSH 的最大绝对误差，$\\varepsilon_{\\max}^{\\mathrm{RSH}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按顺序连接的所有三个用例的结果，形式为由方括号括起来的逗号分隔列表，每个浮点数四舍五入到六位小数。每个用例的顺序为\n$$\n\\left[ m_{\\mathrm{ALDA}}, b_{\\mathrm{ALDA}}, m_{\\mathrm{RSH}}, b_{\\mathrm{RSH}}, \\varepsilon_{\\max}^{\\mathrm{ALDA}}, \\varepsilon_{\\max}^{\\mathrm{RSH}} \\right]\n$$\n将三个用例按顺序聚合到一个单一的扁平列表中。例如，总的输出结构为\n$$\n[ \\text{用例 1 的六个值}, \\text{用例 2 的六个值}, \\text{用例 3 的六个值} ]\n$$",
            "solution": "根据既定的有效性标准对问题陈述进行评估。\n\n**第 1 步：提取的已知条件**\n- **精确电荷转移 (CT) 能量模型**：$E_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (I_D - A_A) - \\frac{1}{R}$\n- **绝热局域密度近似 (ALDA) CT 能量模型**：$E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) = (I_D - A_A) - \\Delta_{\\mathrm{xc}}$\n- **范围分离杂化 (RSH) CT 能量模型**：$E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) = (I_D - A_A) - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}$\n- **能隙定义**：$E_{\\mathrm{gap}} \\equiv (I_D - A_A)$\n- **误差定义**：$\\varepsilon_{\\mathrm{ALDA}}(R) = E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)$ 和 $\\varepsilon_{\\mathrm{RSH}}(R) = E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)$\n- **分析任务**：\n    1.  对误差 $\\varepsilon$ 与 $x = 1/R$ 进行线性回归，以找到斜率 $m$ 和截距 $b$。\n    2.  计算最大绝对误差 $\\varepsilon_{\\max} = \\max_{R} |\\varepsilon(R)|$。\n- **测试用例 1**：$E_{\\mathrm{gap}} = 0.30$，$\\Delta_{\\mathrm{xc}} = 0.15$，$\\delta_{\\mathrm{RSH}} = 0.02$，$R \\in \\{ 5.0, 8.0, 12.0, 20.0 \\}$。\n- **测试用例 2**：$E_{\\mathrm{gap}} = 0.22$，$\\Delta_{\\mathrm{xc}} = 0.00$，$\\delta_{\\mathrm{RSH}} = 0.01$，$R \\in \\{ 10.0, 15.0, 25.0, 50.0 \\}$。\n- **测试用例 3**：$E_{\\mathrm{gap}} = 0.45$，$\\Delta_{\\mathrm{xc}} = 0.20$，$\\delta_{\\mathrm{RSH}} = 0.05$，$R \\in \\{ 3.0, 4.0, 5.0, 10.0 \\}$。\n- **单位**：所有量均指定为原子单位（能量为哈特里，距离为玻尔）。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据、适定且客观。\n1.  **科学依据**：该问题探讨了含时密度泛函理论 (TDDFT) 中一个众所周知的基础性问题：局域和半局域交换相关 (xc) 泛函在描述长程电荷转移激发时的失败。所提供的精确、ALDA 和 RSH 激发能模型是科学文献中用于阐释此概念的标准简化表示。$(I_D - A_A) - 1/R$ 项正确描述了在大分离距离 $R$ 处的电子-空穴对能量。ALDA 模型正确地省略了 $1/R$ 项，反映了 xc 核中缺乏长程响应，这导致了错误的、与距离无关的激发能。RSH 模型正确地重新引入了 $1/R$ 项，反映了通过在长程包含一部分 Hartree-Fock 交换所提供的渐进校正。\n2.  **适定性**：问题给出了完整的说明。对于每个测试用例，所有必需的参数和变量（$E_{\\mathrm{gap}}$, $\\Delta_{\\mathrm{xc}}$, $\\delta_{\\mathrm{RSH}}$以及一组 $R$ 值）都已提供。所需的计算——误差计算、线性回归和最大误差确定——是明确的，并能导出一个唯一、稳定且有意义的解。\n3.  **客观性**：问题以精确的、量化的术语陈述。模型作为明确的假设呈现。不存在主观因素或歧义。\n\n**第 3 步：结论与行动**\n该问题是**有效的**。将提供一个解决方案。\n\n**基于原理的解决方案**\n\n目标是分析两种不同 TDDFT 近似方法（ALDA 和 RSH）在模拟电荷转移激发时，其误差作为给体-受体距离 $R$ 的函数的行为。分析涉及对误差与距离倒数 $x = 1/R$ 进行线性回归。\n\n**模型误差的理论分析**\n\n首先，我们推导每种近似方法的误差的解析形式。令 $E_{\\mathrm{gap}} \\equiv I_D - A_A$。\n\n精确的电荷转移激发能由下式给出：\n$$\nE_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = E_{\\mathrm{gap}} - \\frac{1}{R}\n$$\n\nALDA 的预测值为：\n$$\nE_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) = E_{\\mathrm{gap}} - \\Delta_{\\mathrm{xc}}\n$$\n\nRSH 的预测值为：\n$$\nE_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) = E_{\\mathrm{gap}} - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}\n$$\n\nALDA 模型的误差 $\\varepsilon_{\\mathrm{ALDA}}(R)$ 定义为：\n$$\n\\varepsilon_{\\mathrm{ALDA}}(R) = E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (E_{\\mathrm{gap}} - \\Delta_{\\mathrm{xc}}) - (E_{\\mathrm{gap}} - \\frac{1}{R})\n$$\n$$\n\\varepsilon_{\\mathrm{ALDA}}(R) = \\frac{1}{R} - \\Delta_{\\mathrm{xc}}\n$$\n该表达式揭示了 ALDA 对 CT 态的根本性失败：误差随 $1/R$ 线性增长，并在 $R \\to \\infty$ 时发散。当我们将此误差对 $x = 1/R$ 进行线性回归时，我们拟合的是模型 $\\varepsilon_{\\mathrm{ALDA}}(x) = m_{\\mathrm{ALDA}} x + b_{\\mathrm{ALDA}}$。通过与推导的误差方程直接比较，精确的理论拟合参数为：\n$$\nm_{\\mathrm{ALDA}} = 1, \\quad b_{\\mathrm{ALDA}} = -\\Delta_{\\mathrm{xc}}\n$$\n斜率为 1 证实了误差主要由缺失的 $-1/R$ 电子-空穴相互作用项主导。\n\nRSH 模型的误差 $\\varepsilon_{\\mathrm{RSH}}(R)$ 定义为：\n$$\n\\varepsilon_{\\mathrm{RSH}}(R) = E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (E_{\\mathrm{gap}} - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}) - (E_{\\mathrm{gap}} - \\frac{1}{R})\n$$\n$$\n\\varepsilon_{\\mathrm{RSH}}(R) = -\\delta_{\\mathrm{RSH}}\n$$\n此误差是一个常数，与分离距离 $R$ 无关。这表明 RSH 泛函正确地捕捉了长程 $1/R$ 物理。剩余的误差是一个常数偏差 $\\delta_{\\mathrm{RSH}}$，这可能源于泛函短程部分或底层基态计算的不准确性。将此误差对 $x = 1/R$ 用模型 $\\varepsilon_{\\mathrm{RSH}}(x) = m_{\\mathrm{RSH}} x + b_{\\mathrm{RSH}}$ 进行拟合，得到的精确理论拟合参数为：\n$$\nm_{\\mathrm{RSH}} = 0, \\quad b_{\\mathrm{RSH}} = -\\delta_{\\mathrm{RSH}}\n$$\n斜率为 0 证实了正确的渐进行为。\n\n**计算算法**\n\n程序将为每个给定的测试用例执行以下步骤：\n1.  定义用例的输入参数：$E_{\\mathrm{gap}}$, $\\Delta_{\\mathrm{xc}}$, $\\delta_{\\mathrm{RSH}}$ 和距离列表 $R$。\n2.  构建自变量向量 $x$，其中每个元素为 $x_i = 1/R_i$。\n3.  使用推导的公式计算 ALDA 的误差向量：$(\\varepsilon_{\\mathrm{ALDA}})_i = x_i - \\Delta_{\\mathrm{xc}}$。\n4.  使用推导的公式计算 RSH 的误差向量：对所有 $i$，$(\\varepsilon_{\\mathrm{RSH}})_i = -\\delta_{\\mathrm{RSH}}$。\n5.  对点集 $(x_i, (\\varepsilon_{\\mathrm{ALDA}})_i)$ 进行线性回归，以找到斜率 $m_{\\mathrm{ALDA}}$ 和截距 $b_{\\mathrm{ALDA}}$。由于关系是完全线性的，数值回归将产生与理论预测相同的结果（在机器精度范围内）。一次多项式拟合即可完成此任务。\n6.  类似地，对 $(x_i, (\\varepsilon_{\\mathrm{RSH}})_i)$ 进行线性回归，以找到 $m_{\\mathrm{RSH}}$ 和 $b_{\\mathrm{RSH}}$。\n7.  通过在绝对误差数组中找到最大值来计算 ALDA 的最大绝对误差：$\\varepsilon_{\\max}^{\\mathrm{ALDA}} = \\max_i |(\\varepsilon_{\\mathrm{ALDA}})_i|$。\n8.  计算 RSH 的最大绝对误差：$\\varepsilon_{\\max}^{\\mathrm{RSH}} = \\max_i |(\\varepsilon_{\\mathrm{RSH}})_i| = |-\\delta_{\\mathrm{RSH}}| = \\delta_{\\mathrm{RSH}}$。\n9.  按指定顺序收集六个计算值：$[m_{\\mathrm{ALDA}}, b_{\\mathrm{ALDA}}, m_{\\mathrm{RSH}}, b_{\\mathrm{RSH}}, \\varepsilon_{\\max}^{\\mathrm{ALDA}}, \\varepsilon_{\\max}^{\\mathrm{RSH}}]$。\n10. 处理完所有用例后，将收集到的结果展平为一个单一列表，并格式化为逗号分隔的字符串，每个数字四舍五入到六位小数。\n\n此过程将应用于所有三个测试用例以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the asymptotic behavior of charge-transfer excitation energies\n    in TDDFT for ALDA and RSH models.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (E_gap, Delta_xc, delta_RSH, R_values)\n    # All values are in atomic units.\n    test_cases = [\n        (0.30, 0.15, 0.02, [5.0, 8.0, 12.0, 20.0]),\n        (0.22, 0.00, 0.01, [10.0, 15.0, 25.0, 50.0]),\n        (0.45, 0.20, 0.05, [3.0, 4.0, 5.0, 10.0]),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E_gap, Delta_xc, delta_RSH, R_list = case\n        \n        # Convert R_list to a numpy array for vectorized operations.\n        R = np.array(R_list)\n        \n        # The independent variable for regression is x = 1/R.\n        x = 1.0 / R\n        \n        # --- ALDA Analysis ---\n        \n        # The error for ALDA is derived as:\n        # epsilon_ALDA = E_ALDA - E_exact\n        #              = (E_gap - Delta_xc) - (E_gap - 1/R)\n        #              = 1/R - Delta_xc\n        error_alda = x - Delta_xc\n        \n        # Perform linear regression: error_alda = m * x + b\n        # Using numpy.polyfit for a degree-1 polynomial (a line).\n        # It returns [slope, intercept].\n        # Because the data is perfectly linear, the fit will be exact.\n        m_alda, b_alda = np.polyfit(x, error_alda, 1)\n        \n        # Calculate the maximum absolute error for ALDA.\n        max_err_alda = np.max(np.abs(error_alda))\n        \n        # --- RSH Analysis ---\n        \n        # The error for RSH is derived as:\n        # epsilon_RSH = E_RSH - E_exact\n        #             = (E_gap - delta_RSH - 1/R) - (E_gap - 1/R)\n        #             = -delta_RSH\n        # This is a constant error.\n        error_rsh = np.full_like(x, -delta_RSH)\n        \n        # Perform linear regression: error_rsh = m * x + b\n        # For constant data, the slope will be 0 and the intercept will be the constant value.\n        m_rsh, b_rsh = np.polyfit(x, error_rsh, 1)\n\n        # Calculate the maximum absolute error for RSH.\n        # Since the error is constant, it's just the absolute value of that constant.\n        max_err_rsh = np.max(np.abs(error_rsh))\n\n        # Append the six required values for the current case.\n        all_results.extend([\n            m_alda, b_alda, m_rsh, b_rsh, max_err_alda, max_err_rsh\n        ])\n\n    # Format the final output string as required.\n    # A single line, comma-separated, enclosed in brackets, with 6 decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in all_results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "除了泛函的空间局域性问题外，*绝热*近似——即假设交换相关核是瞬时响应的——构成了另一个根本性的限制，它阻碍了对双电子激发等复杂多电子现象的描述。为了捕捉这类复杂的量子多体效应，我们需要一个频率依赖的交换相关核 $f_{xc}(\\omega)$。最后一个练习为这一前沿主题提供了一个易于理解的切入点，要求您求解一个极简模型，以说明频率依赖的核如何引入单激发与双激发的耦合与混合，这对于理解复杂的光化学过程至关重要 ()。",
            "id": "3497323",
            "problem": "您的任务是为拉伸的氢分子 $\\mathrm{H}_2$ 构建并分析一个最小线性响应含时密度泛函理论 (TDDFT) 模型，该模型通过引入频率依赖的交换相关核来捕捉双激发。在含时密度泛函理论 (TDDFT) 中，相互作用密度响应函数 $\\chi(\\omega)$ 通过一个类戴森方程与科恩-沈 (Kohn-Sham, KS) 响应函数 $\\chi_s(\\omega)$ 相关联：\n$$\n\\chi(\\omega) = \\chi_s(\\omega) + \\chi_s(\\omega)\\left[f_H + f_{xc}(\\omega)\\right]\\chi(\\omega)\n$$\n其中 $f_H$ 是哈特里核 (Hartree kernel)，$f_{xc}(\\omega)$ 是交换相关核 (exchange-correlation kernel)，它可能依赖于频率。标准的 Casida 表述在 KS 跃迁基组中构建了一个本征值问题，在塔姆-丹可夫近似 (Tamm-Dancoff Approximation, TDA) 中，需要求解一个涉及矩阵元 $A_{qp}(\\omega)$ 的厄米本征值问题，该矩阵元定义为：\n$$\nA_{qp}(\\omega) = \\delta_{qp}\\,\\omega_q + K_{qp}(\\omega)\n$$\n其中 $\\omega_q$ 是 KS 跃迁能，$K_{qp}(\\omega)$ 包含了有效的哈特里-交换-相关耦合。在仅包含一个 KS 跃迁的最小单跃迁子空间中，塔姆-丹可夫近似将该本征值问题简化为关于激发能 $\\omega$ 的标量非线性方程。\n\n您的目标是设计一个包含单极点的频率依赖核的最小模型，以模拟与双激发的耦合，然后分析在该简化模型中，极点位置如何移动 Casida 本征值。具体而言：\n\n- 限制在具有能量 $\\omega_q$ 的单个 KS 跃迁。\n- 使用具有简单极点的频率依赖交换相关核来模拟进入 $A(\\omega)$ 的有效耦合，\n$$\nf_{xc}(\\omega) = g + \\frac{\\beta}{\\omega - \\omega_0}\n$$\n其中 $g$ 是一个常数位移，体现了绝热哈特里-交换-相关贡献，$\\beta$ 是一个正的耦合强度（单位为能量的平方），$\\omega_0$ 是模拟科恩-沈谱中双激发能或有效辅助态的极点位置。\n- 在单跃迁塔姆-丹可夫近似中，将有效耦合 $K(\\omega)$ 等同于 $f_{xc}(\\omega)$，并推导由 $A(\\omega)$ 的本征值条件所蕴含的关于激发能 $\\omega$ 的标量方程。\n\n基于这些基础：\n1. 推导激发能 $\\omega$ 所满足的标量方程，用 $\\omega_q$、$g$、$\\beta$ 和 $\\omega_0$ 表示，并明确证明当 $\\beta  0$ 时，$f_{xc}(\\omega)$ 中极点的存在导致 $\\omega$ 有两个实数解。在此最小模型中，这两个解可以被解释为混合的单-双激发能。\n2. 证明这两个解可以写成闭合形式，并定性分析改变 $\\omega_0$ 如何移动这两个解。特别地，讨论极限情况 $\\omega_0 \\to \\infty$ 和 $\\omega_0 \\to \\omega_q + g$，以及这些极限如何与双激发的弱混合和强混合相关联。\n3. 实现一个完整、可运行的程序，对于下面的每个测试用例，计算 $\\omega$ 的两个实数解（即此最小模型中的两个 Casida 本征值），将它们按升序排序，并报告结果。将每个激发能以电子伏特 (eV) 为单位表示，并四舍五入到恰好三位小数。\n\n物理单位：所有能量必须以 $\\mathrm{eV}$ 报告，四舍五入到三位小数。\n\n角度单位：不适用。\n\n百分比：不适用。\n\n测试套件：\n使用以下参数集，每个参数集表示为 $(\\omega_q, g, \\beta, \\omega_0)$，并附带适当的单位：\n- 案例 1：$(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 1.0\\,\\mathrm{eV}^2, 16.0\\,\\mathrm{eV})$，\n- 案例 2（近共振极点）：$(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 1.0\\,\\mathrm{eV}^2, 8.5\\,\\mathrm{eV})$，\n- 案例 3（远极点）：$(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 1.0\\,\\mathrm{eV}^2, 40.0\\,\\mathrm{eV})$，\n- 案例 4（强耦合）：$(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 4.0\\,\\mathrm{eV}^2, 12.0\\,\\mathrm{eV})$，\n- 案例 5（不同的 KS 能隙）：$(6.0\\,\\mathrm{eV}, 0.3\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}^2, 12.0\\,\\mathrm{eV})$。\n\n答案规格和最终输出格式：\n- 对于每个测试用例，计算两个实数激发能 $\\omega$（单位为 $\\mathrm{eV}$），按升序排序，四舍五入到恰好三位小数。\n- 您的程序应生成单行输出，其中包含一个由逗号分隔的列表，列表用方括号括起来。列表中的每个元素本身是一个对应于一个测试用例的双元素列表。例如，输出应如下所示：\n$[\\,[\\omega_{1,1},\\omega_{1,2}],\\,[\\omega_{2,1},\\omega_{2,2}],\\,\\dots\\,]$\n其中每个 $\\omega$ 都四舍五入到恰好三位小数，并以 $\\mathrm{eV}$ 表示。",
            "solution": "该问题是有效的，因为它在科学上基于含时密度泛函理论 (TDDFT) 的原理，定义明确且完整，并且其表述是客观的。它提出了一个标准的教学模型，用于理解绝热 TDDFT 的局限性以及频率依赖核如何解决这些局限性。\n\n目标是在一个最小单跃迁塔姆-丹可夫近似 (TDA) 模型中找到激发能 $\\omega$，其中交换相关核 $f_{xc}(\\omega)$ 包含一个极点以模拟与双激发的耦合。\n\n首先，我们推导激发能 $\\omega$ 的标量方程。在单跃迁子空间中的 Casida TDA 本征值问题简化为标量方程：\n$$\nA(\\omega) = \\omega\n$$\n其中 $\\omega$ 是激发能（即本征值）。矩阵元 $A(\\omega)$ 由下式给出：\n$$\nA(\\omega) = \\omega_q + K(\\omega)\n$$\n这里，$\\omega_q$ 是未受扰动的科恩-沈 (KS) 跃迁能。问题规定有效耦合 $K(\\omega)$ 由一个频率依赖的交换相关核 $f_{xc}(\\omega)$ 建模，其形式为：\n$$\nK(\\omega) = f_{xc}(\\omega) = g + \\frac{\\beta}{\\omega - \\omega_0}\n$$\n其中 $g$ 是一个常数绝热贡献，$\\beta$ 是一个正的耦合强度，$\\omega_0$ 是一个辅助态（通常是双激发）的能量。\n\n将 $A(\\omega)$ 和 $K(\\omega)$ 的表达式代入本征值方程，得到关于 $\\omega$ 的中心标量方程：\n$$\n\\omega_q + g + \\frac{\\beta}{\\omega - \\omega_0} = \\omega\n$$\n这是一个关于 $\\omega$ 的非线性方程。为了分析其解，我们将其整理成多项式形式。我们假设 $\\omega \\neq \\omega_0$，因为极点本身不是一个物理上的解。\n$$\n\\omega - (\\omega_q + g) = \\frac{\\beta}{\\omega - \\omega_0}\n$$\n两边乘以 $(\\omega - \\omega_0)$ 得：\n$$\n(\\omega - (\\omega_q + g))(\\omega - \\omega_0) = \\beta\n$$\n展开此表达式得到一个关于 $\\omega$ 的二次方程：\n$$\n\\omega^2 - \\omega_0\\omega - (\\omega_q + g)\\omega + (\\omega_q + g)\\omega_0 = \\beta\n$$\n$$\n\\omega^2 - (\\omega_q + g + \\omega_0)\\omega + ((\\omega_q + g)\\omega_0 - \\beta) = 0\n$$\n这是一个标准形式为 $a\\omega^2 + b\\omega + c = 0$ 的二次方程，其系数为 $a = 1$，$b = -(\\omega_q + g + \\omega_0)$，以及 $c = ((\\omega_q + g)\\omega_0 - \\beta)$。$\\omega$ 的解由二次公式给出。为了证明存在两个实数解，我们检查判别式 $\\Delta = b^2 - 4ac$：\n$$\n\\Delta = (-(\\omega_q + g + \\omega_0))^2 - 4(1)((\\omega_q + g)\\omega_0 - \\beta)\n$$\n$$\n\\Delta = (\\omega_q + g)^2 + 2(\\omega_q + g)\\omega_0 + \\omega_0^2 - 4(\\omega_q + g)\\omega_0 + 4\\beta\n$$\n$$\n\\Delta = (\\omega_q + g)^2 - 2(\\omega_q + g)\\omega_0 + \\omega_0^2 + 4\\beta\n$$\n$$\n\\Delta = ((\\omega_q + g) - \\omega_0)^2 + 4\\beta\n$$\n由于 $(\\omega_q + g - \\omega_0)^2$ 是一个实数的平方，所以它非负。问题声明耦合强度 $\\beta$ 是正的 ($\\beta  0$)。因此，判别式 $\\Delta$ 严格为正 ($\\Delta  0$)，这保证了该二次方程有两个不同的实数解 $\\omega$。\n\n接下来，我们提供闭合形式的解并分析其行为。使用二次公式，两个解 $\\omega_{1,2}$ 为：\n$$\n\\omega_{1,2} = \\frac{-b \\pm \\sqrt{\\Delta}}{2a} = \\frac{(\\omega_q + g + \\omega_0) \\pm \\sqrt{(\\omega_q + g - \\omega_0)^2 + 4\\beta}}{2}\n$$\n这个表达式在结构上与代表一个耦合双能级系统的 $2 \\times 2$ 对称矩阵的本征值相同。未受扰动的“裸”能量是绝热单激发能 $\\omega'_q = \\omega_q + g$ 和双激发能 $\\omega_0$。这两个态之间的耦合强度由 $\\sqrt{\\beta}$ 给出。两个解 $\\omega_{1,2}$ 是“缀饰”或混合态的能量。\n\n我们分析这些解在两个重要极限下的行为：\n1.  **弱混合 ($\\omega_0 \\to \\infty$)：** 当双激发能 $\\omega_0$ 远大于单激发能 $\\omega'_q$ 时。平方根项可以用泰勒展开来近似。一个更简单的方法是对初始方程 $\\omega = \\omega'_q + \\beta/(\\omega - \\omega_0)$ 使用微扰理论。\n    -   一个解 $\\omega_1$ 将接近未受扰动的单激发能 $\\omega'_q$。我们在分母中近似 $\\omega \\approx \\omega'_q$：\n        $$\n        \\omega_1 \\approx \\omega'_q + \\frac{\\beta}{\\omega'_q - \\omega_0}\n        $$\n        由于 $\\omega_0$ 很大，该解与 $\\omega'_q$ 相比有轻微的移动。\n    -   另一个解 $\\omega_2$ 将接近极点 $\\omega_0$。我们令 $\\omega_2 = \\omega_0 + \\delta$：\n        $$\n        \\omega_0 + \\delta = \\omega'_q + \\frac{\\beta}{\\delta} \\implies (\\omega_0 - \\omega'_q + \\delta)\\delta = \\beta\n        $$\n        对于大的 $\\omega_0$，这给出 $\\delta \\approx \\beta / (\\omega_0 - \\omega'_q)$。该解与 $\\omega_0$ 相比有轻微的移动。\n    在此极限下，态是弱混合的，得到的能量接近于原始的未受扰动能量。\n\n2.  **强混合/共振 ($\\omega_0 \\to \\omega'_q = \\omega_q + g$)：** 当双激发能与单激发能简并或近简并时。在精确共振的情况下，$\\omega_0 = \\omega'_q$，判别式简化为 $\\Delta = (0)^2 + 4\\beta = 4\\beta$。解变为：\n    $$\n    \\omega_{1,2} = \\frac{(\\omega'_q + \\omega'_q) \\pm \\sqrt{4\\beta}}{2} = \\frac{2\\omega'_q \\pm 2\\sqrt{\\beta}}{2} = \\omega'_q \\pm \\sqrt{\\beta}\n    $$\n    在共振时，简并被解除，两个态最大程度地混合，产生两个新态，它们围绕原始能量对称地分裂，分裂量为 $2\\sqrt{\\beta}$。这展示了耦合量子系统特有的“能级排斥”现象。\n\n最后，我们实现一个程序，使用推导出的闭合形式解，为给定的测试用例计算两个激发能 $\\omega_{1,2}$。程序将计算两个根，按升序排序，并按指定格式输出结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the excitation energies in a minimal TDDFT model\n    with a frequency-dependent kernel for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (omega_q, g, beta, omega_0) in eV, eV, eV^2, eV.\n    test_cases = [\n        (8.0, 0.5, 1.0, 16.0),\n        (8.0, 0.5, 1.0, 8.5),\n        (8.0, 0.5, 1.0, 40.0),\n        (8.0, 0.5, 4.0, 12.0),\n        (6.0, 0.3, 0.5, 12.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        omega_q, g, beta, omega_0 = case\n\n        # The two solutions for the excitation energy omega are the roots of the quadratic equation:\n        # omega^2 - (omega_q + g + omega_0) * omega + ((omega_q + g) * omega_0 - beta) = 0\n        # The closed-form solution is:\n        # omega_1,2 = ( (omega_q + g + omega_0) +/- sqrt((omega_q + g - omega_0)^2 + 4*beta) ) / 2\n        \n        # Adiabatic single-excitation energy\n        omega_prime_q = omega_q + g\n        \n        # Sum and difference of the unperturbed energies\n        sum_energies = omega_prime_q + omega_0\n        diff_energies = omega_prime_q - omega_0\n        \n        # Calculate the term under the square root (related to the discriminant)\n        sqrt_term = np.sqrt(diff_energies**2 + 4 * beta)\n        \n        # Calculate the two solutions for omega\n        omega_1 = (sum_energies + sqrt_term) / 2.0\n        omega_2 = (sum_energies - sqrt_term) / 2.0\n        \n        # Sort the solutions in ascending order\n        solutions = sorted([omega_1, omega_2])\n        \n        all_results.append(solutions)\n\n    # Format the final output string as per the problem specification.\n    # Example format: [[w1_1,w1_2],[w2_1,w2_2],...] with no spaces.\n    formatted_cases = []\n    for sol_pair in all_results:\n        # Round each solution to exactly three decimal places and format as a string\n        formatted_pair = [f\"{s:.3f}\" for s in sol_pair]\n        # Create the string for the pair, e.g., '[7.500,9.500]'\n        formatted_cases.append(f\"[{','.join(formatted_pair)}]\")\n    \n    # Join all case strings into the final output format\n    final_output = f\"[{','.join(formatted_cases)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}