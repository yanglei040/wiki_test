{
    "hands_on_practices": [
        {
            "introduction": "对任何计算方法的深刻理解都始于其数学形式。本练习将引导您将全局杂化泛函的总能量表达式分解为其基本组成部分，从而阐明每一项的作用及其计算成本，为后续更高级的应用打下坚实的理论基础。通过推导这些能量项并分析它们与系统尺寸的标度关系，您将对杂化泛函的理论结构和计算复杂性有更深入的认识。",
            "id": "3457641",
            "problem": "考虑一个以原子单位描述的有限、自旋限制的闭壳层体系，该体系在科恩-沈密度泛函理论 (DFT) 的框架内进行描述。该体系具有占据空间轨道 $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{occ}}}$，每个轨道都被双重占据，电子密度为 $\\rho(\\mathbf{r}) = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} |\\phi_i(\\mathbf{r})|^{2}$。总的科恩-沈能量分解为无相互作用动能、外势能、经典电子-电子静电（哈特里）能量以及交换相关能。一个全局杂化交换相关泛函将固定比例 $a \\in [0,1]$ 的哈特里-福克 (HF) 交换与半局域交换混合，同时保留半局域关联。\n\n仅从这些核心定义以及 DFT 和哈特里-福克理论中交换和关联的一般性质出发，完成以下任务：\n\n- 推导混合比例为 $a$ 的全局杂化泛函总能量中每一项的显式轨道积分表达式，即无相互作用动能、外势能、哈特里能量、哈特里-福克交换能、半局域交换能和半局域关联能，所有表达式均用 $\\{\\phi_i\\}$ 和 $\\rho(\\mathbf{r})$ 表示。\n\n- 对于每一项，陈述其在一系列尺寸递增、电中性、闭壳层体系中随电子数 $N = 2 N_{\\mathrm{occ}}$ 变化的领头阶标度，以及在典型的原子中心高斯基组中（无辅助近似，例如不使用密度拟合）随基函数数量 $M$ 变化的领头阶计算功标度，并指出计算该项时的主导操作计数。\n\n- 定性评估基组的完备性（增加 $M$，或者对于平面波，增加截断能）如何影响每个能量项向其基组极限的收敛，并强调哪些项对基组完备性最敏感及其原因。\n\n你的最终答案必须是一个单一的闭式解析表达式，它结合所有项，给出混合比例为 $a$ 的全局杂化泛函的总能量，并以 $\\{\\phi_i\\}$ 和 $\\rho(\\mathbf{r})$ 表示。无需进行数值计算。如果引入任何缩写，首次使用时请写出其全称。全文使用原子单位。",
            "solution": "我们从自旋限制闭壳层体系的科恩-沈密度泛函理论 (DFT) 总能量的基本分解开始。科恩-沈无相互作用动能源于单粒子轨道，外势能是电子密度与核势的相互作用，哈特里能量是电子密度的经典静电能，而交换相关能则解释了量子交换和关联效应。\n\n我们使用原子单位，其中 $\\hbar = 1$，电子质量 $m_{e} = 1$，库仑常数为1。对于一个具有占据空间轨道 $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{occ}}}$ 的自旋限制闭壳层体系，其电子密度为\n$$\n\\rho(\\mathbf{r}) = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} |\\phi_i(\\mathbf{r})|^{2}.\n$$\n\n科恩-沈无相互作用动能 $T_{s}$ 是双重占据的空间轨道的单粒子动能之和。在原子单位中，对于每个空间轨道 $\\phi_i(\\mathbf{r})$，每个自旋通道的动能贡献为 $\\int \\frac{1}{2} |\\nabla \\phi_i(\\mathbf{r})|^{2} \\, d\\mathbf{r}$。由于轨道是双重占据的，总的无相互作用动能可以紧凑地写为\n$$\nT_{s}[\\{\\phi_i\\}] = \\sum_{i=1}^{N_{\\mathrm{occ}}} \\int |\\nabla \\phi_i(\\mathbf{r})|^{2} \\, d\\mathbf{r}.\n$$\n这在原子单位中利用了每个轨道 $2 \\times \\frac{1}{2} = 1$ 的恒等式。\n\n外势能 $V_{\\mathrm{ext}}$ 是\n$$\nV_{\\mathrm{ext}}[\\rho] = \\int v_{\\mathrm{ext}}(\\mathbf{r}) \\, \\rho(\\mathbf{r}) \\, d\\mathbf{r},\n$$\n其中 $v_{\\mathrm{ext}}(\\mathbf{r})$ 是外（核）势。\n\n密度的哈特里（经典库仑）能量是\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r}) \\, \\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}'.\n$$\n\n对于自旋限制的闭壳层体系，用科恩-沈轨道计算的哈特里-福克 (HF) 交换能，可以表示为占据空间轨道的形式：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}] = - \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\iint \\frac{\\phi_i(\\mathbf{r}) \\, \\phi_j(\\mathbf{r}) \\, \\phi_i(\\mathbf{r}') \\, \\phi_j(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}',\n$$\n为简单起见，我们假设轨道是实函数；对于复函数轨道，在适当的位置应将每个 $\\phi$ 替换为其复共轭。\n\n半局域交换能 $E_{x}^{\\mathrm{sl}}[\\rho]$ 和半局域关联能 $E_{c}^{\\mathrm{sl}}[\\rho]$ 是密度（也可能是其梯度和其他简单的局域描述符）的泛函。在不指定具体形式（如局域密度近似 (LDA) 或广义梯度近似 (GGA)）的情况下，我们将其泛写为局域能量密度的空间积分：\n$$\nE_{x}^{\\mathrm{sl}}[\\rho] = \\int e_{x}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r},\n\\qquad\nE_{c}^{\\mathrm{sl}}[\\rho] = \\int e_{c}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r}.\n$$\n\n全局杂化交换相关泛函将固定比例 $a \\in [0,1]$ 的哈特里-福克交换与半局域交换混合，并保留半局域关联。因此，全局杂化泛函中的交换相关能为\n$$\nE_{xc}^{\\mathrm{hyb}}[\\{\\phi_i\\},\\rho] = a \\, E_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}] + (1 - a) \\, E_{x}^{\\mathrm{sl}}[\\rho] + E_{c}^{\\mathrm{sl}}[\\rho].\n$$\n\n结合所有项，混合比例为 $a$ 的全局杂化泛函的总能量为\n$$\nE^{\\mathrm{hyb}}[\\{\\phi_i\\},\\rho] = T_{s}[\\{\\phi_i\\}] + V_{\\mathrm{ext}}[\\rho] + E_{\\mathrm{H}}[\\rho] + a \\, E_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}] + (1 - a) \\, E_{x}^{\\mathrm{sl}}[\\rho] + E_{c}^{\\mathrm{sl}}[\\rho].\n$$\n将上述显式形式代入，即可得到以 $\\{\\phi_i\\}$ 和 $\\rho(\\mathbf{r})$ 表示的最终闭式表达式。\n\n现在我们来分析所要求的标度关系。\n\n在电中性、有限、闭壳层体系中随电子数 $N = 2 N_{\\mathrm{occ}}$ 变化的领头阶标度：\n- $T_{s}[\\{\\phi_i\\}]$：当 $N$ 在平均密度和化学成分固定的情况下增加时，动能是广延的，其标度为 $\\mathcal{O}(N)$。\n- $V_{\\mathrm{ext}}[\\rho]$：对于每个电子固定的核电荷分布，该项标度为 $\\mathcal{O}(N)$（广延的）。\n- $E_{\\mathrm{H}}[\\rho]$：哈特里项计算电子-电子对。对于电中性的有限体系，由于长程相互作用的抵消，该项是广延的，其标度为 $\\mathcal{O}(N)$。\n- $E_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}]$：交换也计算自旋相同的电子对。由于交换相互作用的性质，该项对于结构相似的体系的扩展增长也是广延的，其量级标度为 $\\mathcal{O}(N)$。\n- $E_{x}^{\\mathrm{sl}}[\\rho]$ 和 $E_{c}^{\\mathrm{sl}}[\\rho]$：半局域泛函对局域能量密度进行积分，是广延的，其标度为 $\\mathcal{O}(N)$。\n\n在典型的高斯原子轨道基组中，使用标准的四中心积分且无辅助近似时，随基函数数量 $M$ 变化的领头阶计算功标度：\n- 单电子项 $T_{s}$ 和 $V_{\\mathrm{ext}}$：在能量计算中，构建单电子矩阵并将其与密度矩阵收缩的标度为 $\\mathcal{O}(M^{2})$（假设积分已预先计算或可廉价获得）。\n- $E_{\\mathrm{H}}$：朴素地看，构建四中心双电子库仑积分的标度为 $\\mathcal{O}(M^{4})$，能量计算和类福克收缩的标度也为 $\\mathcal{O}(M^{4})$；使用标准近似（此处未假设）可以降低此标度，但领头的朴素标度是 $\\mathcal{O}(M^{4})$。\n- $E_{x}^{\\mathrm{HF}}$：HF 交换能涉及同类的四中心双电子积分和收缩，因此其朴素标度也为 $\\mathcal{O}(M^{4})$。\n- 半局域项 $E_{x}^{\\mathrm{sl}}$ 和 $E_{c}^{\\mathrm{sl}}$：在数值积分格点上进行计算时，主要成本在于在格点上获得 $\\rho(\\mathbf{r})$ 和 $\\nabla \\rho(\\mathbf{r})$ 并执行格点积分。如果格点大小与 $M$ 成比例，典型的收缩成本介于 $\\mathcal{O}(M^{2})$（密度矩阵到格点）和 $\\mathcal{O}(M \\, N_{g})$ 之间，具体取决于实现方式；泛函本身的计算是 $\\mathcal{O}(N_{g})$。在解析原子轨道方法中（对于 GGA 较不常见），标度可以保持在 $\\mathcal{O}(M^{2})$ 附近。\n\n基组完备性与收敛行为：\n- $T_{s}$ 和 $V_{\\mathrm{ext}}$ 取决于单粒子轨道及其光滑性。在具有系统可改进序列的原子中心高斯基组中，由于轨道得到了很好的表示，能量收敛迅速（对于束缚态，随着基数增加通常呈近指数收敛）。在平面波基组中，收敛由动能截断控制；光滑的轨道使这些项相对较快地收敛。\n- $E_{\\mathrm{H}}$ 取决于 $\\rho(\\mathbf{r})$，对轨道中微妙的高频分量相对不敏感；在密度准确的情况下，随着基组的改进或格点的细化，它会稳定收敛。在平面波中，求解泊松方程可以实现随截断能快速且可控的收敛。\n- $E_{x}^{\\mathrm{HF}}$ 是非局域的，取决于两点处占据轨道的乘积 $\\phi_i(\\mathbf{r}) \\phi_j(\\mathbf{r}')$ 除以 $|\\mathbf{r}-\\mathbf{r}'|$。要准确表示这些轨道乘积，需要底层轨道乘积空间具有更高的完备性。因此，$E_{x}^{\\mathrm{HF}}$ 随基组尺寸的收敛通常比半局域项慢，并且对角向和径向分量的完备性（对于高斯基组）或高截断能（对于平面波）敏感，这反映了其长程、非局域的特性。\n- 半局域项 $E_{x}^{\\mathrm{sl}}$ 和 $E_{c}^{\\mathrm{sl}}$ 取决于 $\\rho(\\mathbf{r})$（也可能取决于 $\\nabla \\rho(\\mathbf{r})$）。因为密度是轨道平方和，它比单个轨道更光滑，所以这些项通常比 $E_{x}^{\\mathrm{HF}}$ 随基组改进收敛得更快。在平面波表示中，梯度由截断能很好地控制，并能系统地收敛。\n\n最后，将混合比例为 $a$ 的全局杂化泛函总能量的显式轨道积分形式组合起来，就得到了所要求的解析表达式。",
            "answer": "$$\\boxed{\\sum_{i=1}^{N_{\\mathrm{occ}}} \\int |\\nabla \\phi_i(\\mathbf{r})|^{2} \\, d\\mathbf{r} \\;+\\; \\int v_{\\mathrm{ext}}(\\mathbf{r}) \\, \\rho(\\mathbf{r}) \\, d\\mathbf{r} \\;+\\; \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r}) \\, \\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}' \\;+\\; a \\left( - \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\iint \\frac{\\phi_i(\\mathbf{r}) \\, \\phi_j(\\mathbf{r}) \\, \\phi_i(\\mathbf{r}') \\, \\phi_j(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}' \\right) \\;+\\; (1 - a) \\int e_{x}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r} \\;+\\; \\int e_{c}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r}}$$"
        },
        {
            "introduction": "发展杂化泛函的一个关键动机是减轻困扰标准密度泛函理论近似的自相互作用误差。本练习介绍了一种基于库普曼斯条件的强大诊断工具，并提供了一种具体的方法来优化混合参数 $\\alpha$，从而为特定系统构建物理上更合理的泛函。这个过程模拟了理论计算研究中的一个常见任务：如何根据基本物理原理来选择或“调整”一个泛函，以提高其对特定问题的预测准确性。",
            "id": "3457579",
            "problem": "我们为您提供一种基于原理的诊断方法，用于判断广义 Kohn–Sham 杂化计算中分子晶体的自相互作用误差。该方法基于 delta 自洽场 (Δ-SCF) 电离势和 Koopmans 条件。delta 自洽场 (Δ-SCF) 电离势定义为中性体系和阳离子体系在其各自自洽电子密度下总能量的差值。最高占据分子轨道 (HOMO) 本征值是顶层的占据 Kohn–Sham 本征值。在广义 Kohn–Sham (GKS) 框架下的杂化泛函中，一部分精确的 Hartree–Fock 交换与半局域交换混合，由一个无量纲的混合参数 $\\alpha \\in [0,1]$ 控制。对于像有机分子晶体这样的弱屏蔽体系，物理考量也表明存在一个与屏蔽相关的信息化目标 $\\alpha \\approx 1/\\varepsilon_{\\infty}$，其中 $\\varepsilon_{\\infty}$ 是电子介电常数。Koopmans 条件指出，在没有自相互作用误差的情况下，电离势 $I$ 应约等于 HOMO 本征值的负数，即 $I \\approx -\\varepsilon_{\\text{HOMO}}$。在实践中，可以调整 $\\alpha$ 以最小化偏差 $I + \\varepsilon_{\\text{HOMO}}$，同时保持 $\\alpha$ 与屏蔽信息化的目标 $1/\\varepsilon_{\\infty}$ 一致。\n\n从上述基本定义出发，请考虑以下抽象的数学任务。对于下方的每个测试用例，您会获得：\n- 交换分数 $\\alpha$ 在值为 $\\{\\alpha_j\\}$ 处的离散样本，\n- 相应的 delta 自洽场 (Δ-SCF) 电离势 $\\{I(\\alpha_j)\\}$，单位为电子伏特，\n- 相应的 HOMO 本征值 $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\}$，单位为电子伏特，\n- 电子介电常数 $\\varepsilon_{\\infty}$（无量纲）。\n\n您必须：\n1. 对于每个测试用例，使用最小二乘法将关系 $I(\\alpha)$ 和 $\\varepsilon_{\\text{HOMO}}(\\alpha)$ 拟合到关于 $\\alpha$ 的仿射（一阶）模型，即 $I(\\alpha) \\approx I_0 + s_I \\alpha$ 和 $\\varepsilon_{\\text{HOMO}}(\\alpha) \\approx \\varepsilon_0 + s_{\\varepsilon} \\alpha$，其中 $I_0$、$s_I$、$\\varepsilon_0$ 和 $s_{\\varepsilon}$ 是通过拟合确定的实数参数。\n2. 定义标量目标函数\n$$\nJ(\\alpha) \\equiv w_K \\left(I(\\alpha) + \\varepsilon_{\\text{HOMO}}(\\alpha)\\right)^2 + w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right)^2,\n$$\n其中权重 $w_K = 1.0$（单位为 $\\text{eV}^{-2}$）和 $w_S = 0.2$（无量纲）。请注意，在这些条件下，$J(\\alpha)$ 是关于 $\\alpha$ 的凸函数。\n3. 计算在物理允许区间 $\\alpha \\in [0,1]$ 上使 $J(\\alpha)$ 最小化的值 $\\alpha^\\star$。如果无约束极小值点位于 $[0,1]$ 之外，则通过将 $\\alpha^\\star$ 限制到该区间的最近端点来获得有约束的极小值点。\n4. 所有能量均以 $\\text{eV}$ 表示。最终报告的 $\\alpha^\\star$ 是无量纲的。您的程序必须生成每个 $\\alpha^\\star$，并四舍五入到小数点后六位。\n\n需要实现和评估的测试套件：\n- 情况 A（理想路径，竞争标准）：$\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$，$\\{I(\\alpha_j)\\} = \\{6.8, 7.0, 7.2\\}$ $\\text{eV}$，$\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-5.5, -6.25, -7.0\\}$ $\\text{eV}$，$\\varepsilon_{\\infty} = 3.5$。\n- 情况 B（接近屏蔽匹配）：$\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$，$\\{I(\\alpha_j)\\} = \\{7.5, 7.625, 7.75\\}$ $\\text{eV}$，$\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-6.0, -6.8, -7.6\\}$ $\\text{eV}$，$\\varepsilon_{\\infty} = 2.0$。\n- 情况 C（平坦的 Koopmans 残差，屏蔽主导）：$\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$，$\\{I(\\alpha_j)\\} = \\{7.0, 7.05, 7.1\\}$ $\\text{eV}$，$\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-6.8, -6.85, -6.9\\}$ $\\text{eV}$，$\\varepsilon_{\\infty} = 4.0$。\n- 情况 D（无约束极小值点小于零，边界截断）：$\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$，$\\{I(\\alpha_j)\\} = \\{6.0, 6.025, 6.05\\}$ $\\text{eV}$，$\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-6.5, -6.625, -6.75\\}$ $\\text{eV}$，$\\varepsilon_{\\infty} = 10.0$。\n- 情况 E（无约束极小值点大于一，边界截断）：$\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$，$\\{I(\\alpha_j)\\} = \\{5.0, 5.025, 5.05\\}$ $\\text{eV}$，$\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-3.0, -3.05, -3.1\\}$ $\\text{eV}$，$\\varepsilon_{\\infty} = 1.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其顺序与上面列出的测试用例相同。具体来说，输出格式必须是：\n- 一个包含五个最优值 $[\\alpha_A^\\star, \\alpha_B^\\star, \\alpha_C^\\star, \\alpha_D^\\star, \\alpha_E^\\star]$ 的 Python 列表，\n- 每个值都精确到小数点后六位，\n- 没有附加文本。例如，一个可接受的格式是 $[\\dots]$，其中的条目如 $0.123456$。\n\n此问题不涉及角度。输入数据中的所有物理量均以电子伏特给出，唯一要求的输出是每个用例的无量纲最优 $\\alpha$ 值，按上述规定四舍五入到小数点后六位。",
            "solution": "问题陈述经审查确认有效。其科学基础在于计算材料科学的原理，特别是关于在密度泛函理论中应用杂化交换相关泛函。该问题是适定的，具有明确定义的目标函数和约束，确保每个测试用例都存在唯一且可计算的解。所有提供的数据都是一致且足以完成任务的。因此，我们可以着手进行形式化求解。\n\n问题的核心是通过最小化一个复合目标函数 $J(\\alpha)$ 来找到交换混合参数 $\\alpha$ 的最优值。该函数平衡了两个物理上的期望目标：满足 Koopmans 条件和遵循一个与屏蔽相关的信息化 $\\alpha$ 目标。该过程包括三个主要步骤：（1）使用线性回归对电离势 $I$ 和 HOMO 本征值 $\\varepsilon_{\\text{HOMO}}$ 对 $\\alpha$ 的依赖关系进行建模；（2）使用这些模型构建目标函数 $J(\\alpha)$；以及（3）在物理上有意义的区间 $[0,1]$ 内找到使 $J(\\alpha)$ 最小化的值 $\\alpha^\\star$。\n\n**第 1 步：通过最小二乘回归进行仿射建模**\n\n对于每个测试用例，我们都获得了离散数据点 $(\\alpha_j, I(\\alpha_j))$ 和 $(\\alpha_j, \\varepsilon_{\\text{HOMO}}(\\alpha_j))$。我们需要将这些数据拟合到仿射模型：\n$$\nI(\\alpha) \\approx I_0 + s_I \\alpha\n$$\n$$\n\\varepsilon_{\\text{HOMO}}(\\alpha) \\approx \\varepsilon_0 + s_{\\varepsilon} \\alpha\n$$\n参数 $(I_0, s_I)$ 和 $(\\varepsilon_0, s_{\\varepsilon})$ 通过普通最小二乘法确定。对于一组通用点 $(x_j, y_j)$，拟合到模型 $y(x) = c + mx$ 需要找到使残差平方和最小化的参数 $(c, m)$。这是一个标准的线性代数问题，其解可通过求解正规方程得到。给定设计矩阵 $\\mathbf{A}$ 和观测向量 $\\mathbf{y}$，\n$$\n\\mathbf{A} = \\begin{pmatrix} 1  x_1 \\\\ 1  x_2 \\\\ \\vdots  \\vdots \\\\ 1  x_n \\end{pmatrix}, \\quad \\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{pmatrix},\n$$\n参数向量 $\\mathbf{p} = \\begin{pmatrix} c \\\\ m \\end{pmatrix}$ 可通过伪逆求得：$\\mathbf{p} = (\\mathbf{A}^T\\mathbf{A})^{-1}\\mathbf{A}^T\\mathbf{y}$。对于每个测试用例，将对 $I(\\alpha)$ 和 $\\varepsilon_{\\text{HOMO}}(\\alpha)$ 执行此计算。\n\n**第 2 步：目标函数的构建**\n\n需要最小化的目标函数为：\n$$\nJ(\\alpha) \\equiv w_K \\left(I(\\alpha) + \\varepsilon_{\\text{HOMO}}(\\alpha)\\right)^2 + w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right)^2\n$$\n其中权重为 $w_K = 1.0 \\, \\text{eV}^{-2}$ 和 $w_S = 0.2$。第一项惩罚对 Koopmans 条件 $I + \\varepsilon_{\\text{HOMO}} = 0$ 的偏离，而第二项惩罚对屏蔽信息化目标 $\\alpha = 1/\\varepsilon_{\\infty}$ 的偏离。\n\n将我们的仿射模型代入第一项，我们定义 Koopmans 偏差项 $K(\\alpha)$ 为：\n$$\nK(\\alpha) = I(\\alpha) + \\varepsilon_{\\text{HOMO}}(\\alpha) = (I_0 + s_I \\alpha) + (\\varepsilon_0 + s_{\\varepsilon} \\alpha) = (I_0 + \\varepsilon_0) + (s_I + s_{\\varepsilon})\\alpha\n$$\n我们定义 $K_0 \\equiv I_0 + \\varepsilon_0$ 和 $s_K \\equiv s_I + s_{\\varepsilon}$。目标函数可以写成关于 $\\alpha$ 的二次函数：\n$$\nJ(\\alpha) = w_K (K_0 + s_K \\alpha)^2 + w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right)^2\n$$\n\n**第 3 步：最小化与约束应用**\n\n为了找到 $J(\\alpha)$ 的无约束极小值点，我们计算其对 $\\alpha$ 的导数并令其为零：\n$$\n\\frac{dJ}{d\\alpha} = 2 w_K (K_0 + s_K \\alpha) s_K + 2 w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right) = 0\n$$\n求解 $\\alpha$：\n$$\nw_K K_0 s_K + w_K s_K^2 \\alpha + w_S \\alpha - \\frac{w_S}{\\varepsilon_{\\infty}} = 0\n$$\n$$\n(w_K s_K^2 + w_S)\\alpha = \\frac{w_S}{\\varepsilon_{\\infty}} - w_K K_0 s_K\n$$\n因此，无约束最优值 $\\alpha_{\\text{unconstrained}}$ 为：\n$$\n\\alpha_{\\text{unconstrained}} = \\frac{\\frac{w_S}{\\varepsilon_{\\infty}} - w_K K_0 s_K}{w_K s_K^2 + w_S}\n$$\n二阶导数 $\\frac{d^2J}{d\\alpha^2} = 2(w_K s_K^2 + w_S)$ 总是正的，因为 $w_K > 0$，$w_S > 0$ 且 $s_K^2 \\ge 0$。这证实了 $J(\\alpha)$ 是一个严格凸函数，我们的解对应于一个全局最小值。\n\n最后，混合参数的物理允许范围是 $\\alpha \\in [0, 1]$。有约束的极小值点 $\\alpha^\\star$ 通过将无约束解限制在此区间内得到：\n$$\n\\alpha^\\star = \\max(0, \\min(1, \\alpha_{\\text{unconstrained}}))\n$$\n此过程将系统地应用于所提供的五个测试用例。计算结果并按要求四舍五入到小数点后六位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimal exchange mixing parameter alpha* for a series of test cases.\n\n    The method involves:\n    1. Performing linear regression on I(alpha) and e_HOMO(alpha).\n    2. Constructing a quadratic objective function J(alpha).\n    3. Finding the analytical minimizer of J(alpha).\n    4. Constraining the solution to the interval [0, 1].\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'alpha': [0.0, 0.25, 0.5], 'I': [6.8, 7.0, 7.2], 'e_homo': [-5.5, -6.25, -7.0], 'eps_inf': 3.5},\n        # Case B\n        {'alpha': [0.0, 0.25, 0.5], 'I': [7.5, 7.625, 7.75], 'e_homo': [-6.0, -6.8, -7.6], 'eps_inf': 2.0},\n        # Case C\n        {'alpha': [0.0, 0.25, 0.5], 'I': [7.0, 7.05, 7.1], 'e_homo': [-6.8, -6.85, -6.9], 'eps_inf': 4.0},\n        # Case D\n        {'alpha': [0.0, 0.25, 0.5], 'I': [6.0, 6.025, 6.05], 'e_homo': [-6.5, -6.625, -6.75], 'eps_inf': 10.0},\n        # Case E\n        {'alpha': [0.0, 0.25, 0.5], 'I': [5.0, 5.025, 5.05], 'e_homo': [-3.0, -3.05, -3.1], 'eps_inf': 1.5},\n    ]\n\n    results = []\n    w_K = 1.0\n    w_S = 0.2\n\n    for case in test_cases:\n        alphas = np.array(case['alpha'])\n        Is = np.array(case['I'])\n        e_homos = np.array(case['e_homo'])\n        eps_inf = case['eps_inf']\n\n        # Step 1: Affine modeling via least squares regression.\n        # The design matrix A has a column of ones for the intercept and a column of alpha values for the slope.\n        A = np.vstack([np.ones_like(alphas), alphas]).T\n        \n        # Fit I(alpha) = I_0 + s_I * alpha\n        p_I, _, _, _ = np.linalg.lstsq(A, Is, rcond=None)\n        I_0, s_I = p_I[0], p_I[1]\n\n        # Fit e_HOMO(alpha) = eps_0 + s_eps * alpha\n        p_eps, _, _, _ = np.linalg.lstsq(A, e_homos, rcond=None)\n        eps_0, s_eps = p_eps[0], p_eps[1]\n\n        # Step 2: Formulate the objective function parameters.\n        # The Koopmans deviation is K(alpha) = K_0 + s_K * alpha\n        K_0 = I_0 + eps_0\n        s_K = s_I + s_eps\n        \n        # Step 3: Compute the unconstrained minimizer of J(alpha).\n        # alpha_unconstrained = ( (w_S / eps_inf) - w_K * K_0 * s_K ) / ( w_K * s_K**2 + w_S )\n        numerator = (w_S / eps_inf) - (w_K * K_0 * s_K)\n        denominator = (w_K * s_K**2) + w_S\n        alpha_unconstrained = numerator / denominator\n\n        # Step 4: Apply the physical constraint alpha in [0, 1].\n        alpha_star = np.clip(alpha_unconstrained, 0.0, 1.0)\n        \n        results.append(alpha_star)\n\n    # Format the final results for printing.\n    # Each value is rounded to exactly six digits after the decimal point.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "发展更优泛函的最终目标是更准确地预测材料性质。本练习将杂化泛函的概念应用于半导体最重要的性质之一：其能隙。通过构建一个基于微扰理论的模型，您可以探索精确交换如何校正半导体能隙，以及这种校正如何受到轨道特性和介电屏蔽等因素的影响。",
            "id": "3457585",
            "problem": "要求您构建并实现一个有物理动机、受第一性原理启发的模型，该模型用于估算在引入精确交换混合参数为 $a = 0.25$ 的杂化交换相关项后，半导体基本带隙的变化。该模型必须从以下基础推导而来：量子力学中的非简并、不含时一阶微扰理论，以及 Kohn-Sham 密度泛函理论 (DFT) 中杂化泛函的算符形式，其中一部分 Hartree-Fock (HF) 精确交换与来自广义梯度近似 (GGA) 的半局域交换势混合。目标是根据这些原理推导出一个可计算实现的带隙变化表达式，然后量化其对介电屏蔽和带边态轨道特性的敏感度。\n\n从以下经过充分检验的原理和定义出发：\n- 在 Kohn-Sham 密度泛函理论 (DFT) 框架中，引入杂化交换相关算符可以表示为对一个由半局域泛函（例如，广义梯度近似 (GGA)）构建的参考哈密顿量的加性微扰。将未微扰哈密顿量表示为 $\\hat{H}_{0}$，杂化哈密顿量表示为 $\\hat{H}(a)$，其中 $a$ 是精确交换的比例。\n- 屏蔽杂化可以通过将精确交换微扰乘以高频介电常数 $\\epsilon_{\\infty}$ 进行缩放来建模，以模拟固体中非局域交换的介电屏蔽效应。\n- 在非简并、不含时一阶微扰理论中，对于 $\\hat{H}_{0}$ 的一个归一化本征态 $\\lvert \\psi_{i} \\rangle$，由微扰 $\\hat{W}$ 引起的一阶能量修正是 $\\Delta \\varepsilon_{i}^{(1)} = \\langle \\psi_{i} \\lvert \\hat{W} \\rvert \\psi_{i} \\rangle$。\n- 杂化微扰算符是非局域 Hartree-Fock 交换算符与半局域交换势之差，并按混合参数 $a$ 和介电屏蔽 $\\epsilon_{\\infty}$ 进行缩放。\n\n您将在以下科学上标准且明确说明的近似下，将这些原理转化为一个数值模型：\n- 导带底和价带顶能量的一阶变化，记为 $\\Delta \\varepsilon_{c}$ 和 $\\Delta \\varepsilon_{v}$，是使用一阶微扰理论计算的，其中微扰算符被建模为屏蔽的(精确交换减去半局域交换)之差。\n- 对于给定的带边态，此微扰的期望值通过对角动量通道 $\\ell \\in \\{ s, p, d \\}$ 的轨道特性加权和来近似：\n  $$\\langle \\psi_{i} \\lvert \\hat{W} \\rvert \\psi_{i} \\rangle \\approx \\sum_{\\ell \\in \\{s,p,d\\}} w_{i,\\ell} \\, M_{i}(\\ell),$$\n  其中 $w_{i,\\ell}$ 是和为 1 的非负权重，$M_{i}(\\ell)$ 是为无屏蔽、单位混合情况（$a = 1$, $\\epsilon_{\\infty} = 1$）制表的、特定于材料和带边的参考矩阵元（单位为电子伏特）。\n- 对于已占据的价态，精确交换通常会相对于半局域参考降低能量；而对于未占据的导态，它会提高能量，从而增大带隙。在构建带隙变化 $\\Delta E_{g} = \\Delta \\varepsilon_{c} - \\Delta \\varepsilon_{v}$ 时，您需要反映这种符号差异。\n\n您的程序必须为下面指定的每个测试用例计算：\n- 因引入 $a = 0.25$ 的精确交换并由 $\\epsilon_{\\infty}$ 屏蔽所引起的带隙变化 $\\Delta E_{g}$（单位为电子伏特）。\n- 带隙变化相对于 $\\epsilon_{\\infty}$ 的敏感度，即导数 $\\frac{\\partial \\Delta E_{g}}{\\partial \\epsilon_{\\infty}}$，在指定的 $\\epsilon_{\\infty}$ 处求值。\n- 将 $\\Delta E_{g}$ 分解为来自导带边和价带边的每个轨道通道的贡献，这些贡献定义为加起来等于 $\\Delta E_{g}$ 的正加和项：\n  $$C_{c,\\ell} \\;\\text{for}\\; \\ell \\in \\{s,p,d\\}, \\quad C_{v,\\ell} \\;\\text{for}\\; \\ell \\in \\{s,p,d\\}.$$\n\n所有能量必须以电子伏特 (eV) 报告。导数 $\\frac{\\partial \\Delta E_{g}}{\\partial \\epsilon_{\\infty}}$ 必须以电子伏特每单位 $\\epsilon_{\\infty}$ 报告，其中 $\\epsilon_{\\infty}$ 是无量纲的。您的程序必须在打印前将每个报告的浮点数四舍五入到 $6$ 位小数。\n\n使用以下轨道通道矩阵元 $M_{i}(\\ell)$（单位：eV）的固定参数，这些参数代表了参考的无屏蔽、单位混合情况下的期望值：\n- 导带边: $M_{c}(s) = 1.0$, $M_{c}(p) = 1.5$, $M_{c}(d) = 3.0$。\n- 价带边: $M_{v}(s) = 1.2$, $M_{v}(p) = 2.0$, $M_{v}(d) = 3.5$。\n\n对于每个测试用例，您将获得 $\\epsilon_{\\infty}$ 以及导带边和价带边的轨道权重三元组 $(w_{c,s}, w_{c,p}, w_{c,d})$ 和 $(w_{v,s}, w_{v,p}, w_{v,d})$。如果某个三元组由于舍入误差其和不为 1，请将其归一化以使 $\\sum_{\\ell} w_{i,\\ell} = 1$。\n\n测试套件（每个用例按顺序提供 $\\epsilon_{\\infty}$ 和两个权重三元组 $(w_{c,s}, w_{c,p}, w_{c,d})$ 和 $(w_{v,s}, w_{v,p}, w_{v,d})$）：\n- 用例 1: $\\epsilon_{\\infty} = 4.0$, $(0.6, 0.4, 0.0)$, $(0.2, 0.8, 0.0)$。\n- 用例 2: $\\epsilon_{\\infty} = 15.0$, $(0.6, 0.4, 0.0)$, $(0.2, 0.8, 0.0)$。\n- 用例 3: $\\epsilon_{\\infty} = 1.0$, $(0.6, 0.4, 0.0)$, $(0.2, 0.8, 0.0)$。\n- 用例 4: $\\epsilon_{\\infty} = 5.0$, $(0.0, 0.2, 0.8)$, $(0.1, 0.1, 0.8)$。\n- 用例 5: $\\epsilon_{\\infty} = 7.0$, $(1.0, 0.0, 0.0)$, $(0.0, 1.0, 0.0)$。\n\n每个用例的必需输出，按此确切顺序：\n- $\\Delta E_{g}$,\n- $\\frac{\\partial \\Delta E_{g}}{\\partial \\epsilon_{\\infty}}$,\n- $C_{c,s}$, $C_{c,p}$, $C_{c,d}$,\n- $C_{v,s}$, $C_{v,p}$, $C_{v,d}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中首先是用例 1 的值，然后是用例 2 的值，依此类推，直到用例 5。例如：“[result1,result2,...,resultN]”。每个数字都必须四舍五入到 $6$ 位小数。",
            "solution": "该问题要求构建一个模型，用以估算在引入杂化交换相关泛函后半导体基本带隙的变化 $\\Delta E_g$。该模型必须从一阶微扰理论和杂化泛函的算符形式推导得出。我们将系统地推导带隙变化、其对介电屏蔽的敏感度以及其分解为轨道通道贡献的表达式。\n\n基本原理如下：\n1.  杂化哈密顿量 $\\hat{H}(a)$ 被视为对半局域 (GGA) 哈密顿量 $\\hat{H}_0$ 的微扰。微扰算符 $\\hat{W}$ 源于将比例为 $a$ 的 Hartree-Fock (精确) 交换（通过高频介电常数的倒数 $1/\\epsilon_{\\infty}$ 进行缩放）与 GGA 泛函混合。\n2.  对于 $\\hat{H}_0$ 的一个非简并本征态 $\\lvert\\psi_i\\rangle$，其一阶能量修正是由期望值 $\\Delta\\varepsilon_i = \\langle\\psi_i\\lvert\\hat{W}\\rvert\\psi_i\\rangle$ 给出。\n3.  该期望值通过对轨道特性 $\\ell \\in \\{s, p, d\\}$ 的加权和来近似。\n\n首先，我们形式化微扰算符 $\\hat{W}$。问题陈述，该微扰涉及将一部分比例为 $a$ 的半局域交换势（我们记为 $\\hat{V}_x^{\\text{GGA}}$）替换为相同比例的非局域 Hartree-Fock (HF) 交换算符 $\\hat{V}_x^{\\text{HF}}$。此差值随后由介电常数 $\\epsilon_{\\infty}$ 屏蔽。最终的微扰算符为：\n$$ \\hat{W} = \\frac{a}{\\epsilon_{\\infty}} \\left( \\hat{V}_x^{\\text{HF}} - \\hat{V}_x^{\\text{GGA}} \\right) $$\n对于一个电子态 $\\lvert\\psi_i\\rangle$（其中 $i$ 表示导带底 $c$ 或价带顶 $v$），其一阶能量修正是：\n$$ \\Delta\\varepsilon_i = \\langle\\psi_i\\lvert \\hat{W} \\rvert\\psi_i\\rangle = \\frac{a}{\\epsilon_{\\infty}} \\langle\\psi_i\\lvert \\hat{V}_x^{\\text{HF}} - \\hat{V}_x^{\\text{GGA}} \\rvert\\psi_i\\rangle $$\n问题为该期望值提供了一个特定的近似，该近似基于为无屏蔽（$\\epsilon_{\\infty}=1$）和单位混合（$a=1$）情况定义的参考矩阵元 $M_i(\\ell)$。对于无屏蔽、单位混合的微扰，其期望值由下式给出：\n$$ \\langle\\psi_i\\lvert \\hat{V}_x^{\\text{HF}} - \\hat{V}_x^{\\text{GGA}} \\rvert\\psi_i\\rangle \\approx \\sum_{\\ell \\in \\{s,p,d\\}} w_{i,\\ell} M_i(\\ell) $$\n其中 $w_{i,\\ell}$ 是态 $i$ 和通道 $\\ell$ 的归一化轨道权重。我们定义这个按轨道平均的矩阵元为 $M_i^{\\text{avg}} = \\sum_{\\ell} w_{i,\\ell} M_i(\\ell)$。\n\n因此，能量修正 $\\Delta\\varepsilon_i$ 为：\n$$ \\Delta\\varepsilon_i \\approx \\frac{a}{\\epsilon_{\\infty}} M_i^{\\text{avg}} $$\n一个关键的物理考量是修正的符号。对于未占据的导态 ($i=c$)，引入精确交换会提高能量，因此 $\\Delta\\varepsilon_c$ 是正的。给定的 $M_c(\\ell)$ 值为正，这与此一致。对于已占据的价态 ($i=v$)，相对于易产生自相互作用的半局域近似，精确交换会降低能量，因此 $\\Delta\\varepsilon_v$ 是负的。因此我们必须明确引入一个符号。\n$$ \\Delta\\varepsilon_c = +\\frac{a}{\\epsilon_{\\infty}} M_c^{\\text{avg}} = +\\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{c,\\ell} M_c(\\ell) $$\n$$ \\Delta\\varepsilon_v = -\\frac{a}{\\epsilon_{\\infty}} M_v^{\\text{avg}} = -\\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{v,\\ell} M_v(\\ell) $$\n带隙的变化 $\\Delta E_g$ 是导带边能量的变化减去价带边能量的变化：\n$$ \\Delta E_g = \\Delta\\varepsilon_c - \\Delta\\varepsilon_v $$\n代入能量修正的表达式可得：\n$$ \\Delta E_g = \\left(\\frac{a}{\\epsilon_{\\infty}} M_c^{\\text{avg}}\\right) - \\left(-\\frac{a}{\\epsilon_{\\infty}} M_v^{\\text{avg}}\\right) = \\frac{a}{\\epsilon_{\\infty}} \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) $$\n这个表达式巧妙地表明，导带的上移和价带的下移都以相加的方式对增大带隙做出了贡献。\n\n接下来，我们计算带隙变化相对于介电常数的敏感度 $\\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}}$。我们对 $\\Delta E_g$ 的表达式关于 $\\epsilon_{\\infty}$ 求导，并将 $a$、$w_{i,\\ell}$ 和 $M_i(\\ell)$ 视为常数：\n$$ \\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = \\frac{\\partial}{\\partial \\epsilon_{\\infty}} \\left[ \\frac{a}{\\epsilon_{\\infty}} \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) \\right] = a \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) \\frac{\\partial}{\\partial \\epsilon_{\\infty}} \\left( \\frac{1}{\\epsilon_{\\infty}} \\right) $$\n$$ \\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = - \\frac{a}{\\epsilon_{\\infty}^2} \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) $$\n通过将其与 $\\Delta E_g$ 的表达式进行比较，我们发现一个简单的关系：\n$$ \\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = -\\frac{\\Delta E_g}{\\epsilon_{\\infty}} $$\n最后，我们确定轨道贡献 $C_{c,\\ell}$ 和 $C_{v,\\ell}$，它们被定义为加起来等于 $\\Delta E_g$ 的正加和项。根据我们对 $\\Delta E_g$ 的表达式：\n$$ \\Delta E_g = \\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{c,\\ell} M_c(\\ell) + \\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{v,\\ell} M_v(\\ell) $$\n分解是直接的。来自导带边通道 $\\ell$ 的贡献是：\n$$ C_{c,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{c,\\ell} M_c(\\ell) $$\n而来自价带边通道 $\\ell$ 的贡献是：\n$$ C_{v,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{v,\\ell} M_v(\\ell) $$\n根据定义，$\\sum_{\\ell} (C_{c,\\ell} + C_{v,\\ell}) = \\Delta E_g$。\n\n总结来说，对于每个给定了参数 $a = 0.25$、$\\epsilon_{\\infty}$、轨道权重 $(w_{c,s}, w_{c,p}, w_{c,d})$ 和 $(w_{v,s}, w_{v,p}, w_{v,d})$ 以及固定的参考矩阵元 $M_c(\\ell)$ 和 $M_v(\\ell)$ 的测试用例，计算步骤如下：\n1.  归一化权重三元组 $\\{w_{c,\\ell}\\}$ 和 $\\{w_{v,\\ell}\\}$，确保它们各自的和为 $1$。\n2.  计算按轨道平均的矩阵元 $M_c^{\\text{avg}} = \\sum_{\\ell} w_{c,\\ell} M_c(\\ell)$ 和 $M_v^{\\text{avg}} = \\sum_{\\ell} w_{v,\\ell} M_v(\\ell)$。\n3.  计算带隙变化 $\\Delta E_g = \\frac{a}{\\epsilon_{\\infty}} (M_c^{\\text{avg}} + M_v^{\\text{avg}})$。\n4.  计算敏感度 $\\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = -\\frac{\\Delta E_g}{\\epsilon_{\\infty}}$。\n5.  计算轨道贡献 $C_{c,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{c,\\ell} M_c(\\ell)$ 和 $C_{v,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{v,\\ell} M_v(\\ell)$，其中 $\\ell \\in \\{s, p, d\\}$。\n所有数值结果均需四舍五入到 $6$ 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in a semiconductor's band gap based on a first-principles-inspired model.\n\n    The model uses first-order perturbation theory to estimate the energy shifts of the\n    conduction and valence band edges upon introducing a hybrid exchange-correlation functional.\n    The perturbation is scaled by an exact-exchange mixing fraction 'a' and a dielectric\n    screening constant 'epsilon_infinity'. The model further approximates the perturbation\n    matrix elements using an orbital-character-weighted sum over s, p, and d channels.\n    \"\"\"\n\n    # Fixed parameters from the problem statement\n    A_MIX = 0.25  # Exact-exchange mixing parameter\n    \n    # Reference unscreened, unit-mixing matrix elements M_i(l) in eV\n    # Index 0: s, 1: p, 2: d\n    M_C = np.array([1.0, 1.5, 3.0])  # Conduction-band edge\n    M_V = np.array([1.2, 2.0, 3.5])  # Valence-band edge\n\n    # Test suite: (epsilon_infinity, (wc_s, wc_p, wc_d), (wv_s, wv_p, wv_d))\n    test_cases = [\n        (4.0, (0.6, 0.4, 0.0), (0.2, 0.8, 0.0)),\n        (15.0, (0.6, 0.4, 0.0), (0.2, 0.8, 0.0)),\n        (1.0, (0.6, 0.4, 0.0), (0.2, 0.8, 0.0)),\n        (5.0, (0.0, 0.2, 0.8), (0.1, 0.1, 0.8)),\n        (7.0, (1.0, 0.0, 0.0), (0.0, 1.0, 0.0)),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        eps_inf, w_c_raw, w_v_raw = case\n        \n        # Convert weight tuples to numpy arrays for vector operations\n        w_c = np.array(w_c_raw, dtype=float)\n        w_v = np.array(w_v_raw, dtype=float)\n        \n        # Step 1: Normalize orbital weights if they do not sum to 1\n        sum_w_c = np.sum(w_c)\n        if sum_w_c > 0 and not np.isclose(sum_w_c, 1.0):\n            w_c /= sum_w_c\n            \n        sum_w_v = np.sum(w_v)\n        if sum_w_v > 0 and not np.isclose(sum_w_v, 1.0):\n            w_v /= sum_w_v\n\n        # Step 2: Compute orbitally-averaged matrix elements\n        m_c_avg = np.dot(w_c, M_C)\n        m_v_avg = np.dot(w_v, M_V)\n        \n        # Step 3: Calculate the band gap change\n        delta_eg = (A_MIX / eps_inf) * (m_c_avg + m_v_avg)\n        \n        # Step 4: Calculate the sensitivity derivative\n        d_delta_eg_d_eps = -delta_eg / eps_inf\n        \n        # Step 5: Calculate the decomposition into orbital contributions\n        scale_factor = A_MIX / eps_inf\n        c_c = scale_factor * w_c * M_C\n        c_v = scale_factor * w_v * M_V\n        \n        # Collect and round all results for the current case to 6 decimals\n        results_for_case = [\n            round(delta_eg, 6),\n            round(d_delta_eg_d_eps, 6),\n            round(c_c[0], 6), round(c_c[1], 6), round(c_c[2], 6), # C_c,s,p,d\n            round(c_v[0], 6), round(c_v[1], 6), round(c_v[2], 6), # C_v,s,p,d\n        ]\n        \n        all_results.extend(results_for_case)\n        \n    # Final print statement in the exact required format.\n    # The f-string formatting ensures that trailing zeros are printed,\n    # satisfying the visual representation of 6 decimal places.\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}