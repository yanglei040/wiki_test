{
    "hands_on_practices": [
        {
            "introduction": "The first step in any continuum analysis is to mathematically describe the motion and deformation of a material body. This exercise grounds your understanding in these fundamentals by asking you to derive key kinematic tensors for a prescribed deformation. By translating an abstract deformation map into concrete tensor components, you will build an essential skill for both analytical derivations and for validating computational simulations .",
            "id": "3440412",
            "problem": "Consider a homogeneous finite deformation of a continuum body described by the mapping $\\varphi:\\Omega_0 \\subset \\mathbb{R}^3 \\to \\Omega \\subset \\mathbb{R}^3$ taking the reference material point with position vector $X$ to the current position $x=\\varphi(X)=\\text{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\,X$, where $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$ are positive principal stretches. Starting from the kinematic foundations of continuum mechanics, namely the definition of the deformation gradient $F=\\nabla_X \\varphi$, the right Cauchy–Green deformation tensor $C=F^{\\top}F$, the left Cauchy–Green deformation tensor $B=FF^{\\top}$, and the Green–Lagrange strain tensor $E=\\frac{1}{2}(C-I)$ (where $I$ is the identity tensor), derive analytic expressions for the components of $E$ and $B$ in terms of $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$. Then, using the definitions of the invariants of $C$, namely $I_1=\\text{tr}(C)$ and $I_2=\\frac{1}{2}\\big((\\text{tr}\\,C)^2-\\text{tr}(C^2)\\big)$, derive $I_1$ and $I_2$ in terms of $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$.\n\nProvide your final answer as a row matrix containing $\\big(E_{11},E_{22},E_{33},B_{11},B_{22},B_{33},I_1,I_2\\big)$, expressed purely in terms of $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$. No numerical approximation or rounding is required.",
            "solution": "The problem provided is a standard exercise in nonlinear continuum mechanics. A validation check confirms its validity.\n\n**1. Scientific Grounding:** The problem is firmly rooted in the established kinematic theory of finite deformations. All terms—deformation gradient, Cauchy-Green tensors, Green-Lagrange strain, and tensor invariants—are standard and correctly defined.\n**2. Well-Posedness:** The problem is self-contained, providing a specific deformation mapping and clear definitions for all quantities to be derived. It leads to a unique, stable, and meaningful solution.\n**3. Objectivity:** The problem is stated in precise mathematical language, free of any subjectivity or ambiguity.\n\nThe problem is therefore valid, and we may proceed with the solution.\n\nThe position vector of a material point in the reference configuration is $X = X_1 e_1 + X_2 e_2 + X_3 e_3$, and in the current configuration is $x = x_1 e_1 + x_2 e_2 + x_3 e_3$. The deformation mapping $\\varphi$ is given as $x=\\text{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\,X$. In component form, this is:\n$$x_1 = \\lambda_1 X_1$$\n$$x_2 = \\lambda_2 X_2$$\n$$x_3 = \\lambda_3 X_3$$\n\nFirst, we compute the deformation gradient tensor $F$, whose components are defined as $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$.\n$$F_{11} = \\frac{\\partial x_1}{\\partial X_1} = \\lambda_1, \\quad F_{12} = \\frac{\\partial x_1}{\\partial X_2} = 0, \\quad F_{13} = \\frac{\\partial x_1}{\\partial X_3} = 0$$\n$$F_{21} = \\frac{\\partial x_2}{\\partial X_1} = 0, \\quad F_{22} = \\frac{\\partial x_2}{\\partial X_2} = \\lambda_2, \\quad F_{23} = \\frac{\\partial x_2}{\\partial X_3} = 0$$\n$$F_{31} = \\frac{\\partial x_3}{\\partial X_1} = 0, \\quad F_{32} = \\frac{\\partial x_3}{\\partial X_2} = 0, \\quad F_{33} = \\frac{\\partial x_3}{\\partial X_3} = \\lambda_3$$\nIn matrix form, the deformation gradient $F$ is a diagonal tensor:\n$$F = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}$$\n\nNext, we calculate the right Cauchy–Green deformation tensor, $C = F^{\\top}F$. Since $F$ is a diagonal matrix, its transpose $F^{\\top}$ is equal to $F$.\n$$C = F^{\\top}F = F^2 = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{pmatrix}$$\n\nUsing this result for $C$, we derive the components of the Green–Lagrange strain tensor, $E = \\frac{1}{2}(C-I)$, where $I$ is the second-order identity tensor.\n$$E = \\frac{1}{2} \\left( \\begin{pmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right) = \\begin{pmatrix} \\frac{1}{2}(\\lambda_1^2 - 1) & 0 & 0 \\\\ 0 & \\frac{1}{2}(\\lambda_2^2 - 1) & 0 \\\\ 0 & 0 & \\frac{1}{2}(\\lambda_3^2 - 1) \\end{pmatrix}$$\nThe requested diagonal components of $E$ are therefore:\n$$E_{11} = \\frac{1}{2}(\\lambda_1^2 - 1)$$\n$$E_{22} = \\frac{1}{2}(\\lambda_2^2 - 1)$$\n$$E_{33} = \\frac{1}{2}(\\lambda_3^2 - 1)$$\n\nNow, we compute the left Cauchy–Green deformation tensor, $B = FF^{\\top}$. As established earlier, for this specific diagonal form of $F$, we have $F^{\\top}=F$. Thus, $B$ is identical to $C$.\n$$B = FF^{\\top} = F^2 = \\begin{pmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{pmatrix}$$\nThe requested diagonal components of $B$ are:\n$$B_{11} = \\lambda_1^2$$\n$$B_{22} = \\lambda_2^2$$\n$$B_{33} = \\lambda_3^2$$\n\nFinally, we derive the first and second principal invariants of $C$, denoted $I_1$ and $I_2$.\nThe first invariant, $I_1$, is the trace of $C$.\n$$I_1 = \\text{tr}(C) = C_{11} + C_{22} + C_{33} = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$$\n\nThe second invariant, $I_2$, is defined as $I_2 = \\frac{1}{2}\\big((\\text{tr}\\,C)^2 - \\text{tr}(C^2)\\big)$.\nWe have already found $\\text{tr}(C) = I_1$. We now need to compute $\\text{tr}(C^2)$.\n$$C^2 = C \\cdot C = \\begin{pmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{pmatrix} \\begin{pmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^4 & 0 & 0 \\\\ 0 & \\lambda_2^4 & 0 \\\\ 0 & 0 & \\lambda_3^4 \\end{pmatrix}$$\nThe trace of $C^2$ is:\n$$\\text{tr}(C^2) = \\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4$$\nSubstituting $\\text{tr}(C)$ and $\\text{tr}(C^2)$ into the formula for $I_2$:\n$$I_2 = \\frac{1}{2} \\big( (\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2)^2 - (\\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4) \\big)$$\nExpanding the squared term:\n$$(\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2)^2 = (\\lambda_1^2)^2 + (\\lambda_2^2)^2 + (\\lambda_3^2)^2 + 2\\lambda_1^2\\lambda_2^2 + 2\\lambda_1^2\\lambda_3^2 + 2\\lambda_2^2\\lambda_3^2$$\n$$(\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2)^2 = \\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4 + 2(\\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2)$$\nSubstituting this back into the expression for $I_2$:\n$$I_2 = \\frac{1}{2} \\big( [\\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4 + 2(\\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2)] - (\\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4) \\big)$$\n$$I_2 = \\frac{1}{2} \\big( 2(\\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2) \\big)$$\n$$I_2 = \\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2$$\n\nWe have derived all required quantities. We now assemble them into the specified row matrix for the final answer.\nThe components are:\n$E_{11} = \\frac{1}{2}(\\lambda_1^2 - 1)$\n$E_{22} = \\frac{1}{2}(\\lambda_2^2 - 1)$\n$E_{33} = \\frac{1}{2}(\\lambda_3^2 - 1)$\n$B_{11} = \\lambda_1^2$\n$B_{22} = \\lambda_2^2$\n$B_{33} = \\lambda_3^2$\n$I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$\n$I_2 = \\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}(\\lambda_1^{2} - 1) & \\frac{1}{2}(\\lambda_2^{2} - 1) & \\frac{1}{2}(\\lambda_3^{2} - 1) & \\lambda_1^{2} & \\lambda_2^{2} & \\lambda_3^{2} & \\lambda_1^{2} + \\lambda_2^{2} + \\lambda_3^{2} & \\lambda_1^{2}\\lambda_2^{2} + \\lambda_1^{2}\\lambda_3^{2} + \\lambda_2^{2}\\lambda_3^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the kinematics of deformation established, we can now explore how a material responds by introducing a constitutive model. This practice challenges you to apply a compressible Neo-Hookean hyperelastic model—a common choice for rubber-like materials—to a uniaxial tension problem. You will derive the resulting stress state, gaining experience in how to connect a strain-energy potential to a tangible mechanical response under specific boundary conditions .",
            "id": "3440421",
            "problem": "A homogeneous, isotropic, compressible hyperelastic solid is modeled by the compressible Neo-Hookean strain-energy density\n$$\nW(\\mathbf{B},J) = \\frac{\\mu}{2}\\left(I_{1}-3\\right) - \\mu \\ln J + \\frac{K}{2}\\left(\\ln J\\right)^{2},\n$$\nwhere $\\mu$ is the shear modulus, $K$ is the bulk modulus, $\\mathbf{F}$ is the deformation gradient, $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^{\\top}$ is the left Cauchy-Green deformation tensor, $J=\\det(\\mathbf{F})$ is the Jacobian of deformation, and $I_{1}=\\operatorname{tr}(\\mathbf{B})$ is the first invariant of $\\mathbf{B}$. The Cauchy stress $\\boldsymbol{\\sigma}$ for a hyperelastic material is obtained from $W$ via standard invariant-based relations.\n\nConsider a uniaxial stretch applied along the $x_{1}$-direction with prescribed principal stretch $\\lambda>0$, so that the deformation gradient is diagonal,\n$$\n\\mathbf{F}=\\operatorname{diag}\\!\\left(\\lambda,\\lambda_{\\perp},\\lambda_{\\perp}\\right),\n$$\nwhere $\\lambda_{\\perp}>0$ are the lateral stretches that dynamically adjust to satisfy traction-free lateral boundary conditions. Assume the lateral faces normal to $x_{2}$ and $x_{3}$ are traction-free, that is,\n$$\n\\sigma_{22}=0,\\quad \\sigma_{33}=0.\n$$\nStarting only from the definitions of the kinematic measures and the given strain-energy function, derive a closed-form analytical expression for the axial Cauchy stress component $\\sigma_{11}$ as a function of the prescribed axial stretch $\\lambda$ and the material parameters $\\mu$ and $K$. Your final expression must eliminate $\\lambda_{\\perp}$ in favor of $\\lambda$, $\\mu$, and $K$. Express your answer in terms of the Lambert $W$ function if necessary. Provide the final expression for $\\sigma_{11}$ as a single analytic expression. No numerical evaluation is required, and no rounding is necessary. If units are needed in an application, express stress in Pascals (Pa), but do not include units in the final expression.",
            "solution": "The material is hyperelastic with strain-energy density\n$$\nW(\\mathbf{B},J) = \\frac{\\mu}{2}\\left(I_{1}-3\\right) - \\mu \\ln J + \\frac{K}{2}\\left(\\ln J\\right)^{2}.\n$$\nFor an isotropic hyperelastic material expressed in terms of invariants $\\left(I_{1},J\\right)$, the Kirchhoff stress $\\boldsymbol{\\tau}=J\\boldsymbol{\\sigma}$ is given by\n$$\n\\boldsymbol{\\tau} = 2\\frac{\\partial W}{\\partial I_{1}}\\,\\mathbf{B} + J\\frac{\\partial W}{\\partial J}\\,\\mathbf{I},\n$$\nwhere $\\mathbf{I}$ is the identity tensor and $\\partial I_{1}/\\partial \\mathbf{B}=\\mathbf{I}$ has been used. For the present $W$,\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{\\mu}{2},\\qquad \\frac{\\partial W}{\\partial J} = -\\frac{\\mu}{J} + \\frac{K}{J}\\ln J.\n$$\nHence,\n$$\n\\boldsymbol{\\tau} = \\mu\\,\\mathbf{B} + \\left(-\\mu + K\\ln J\\right)\\mathbf{I},\n$$\nand the Cauchy stress is\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{J}\\boldsymbol{\\tau} = \\frac{\\mu}{J}\\mathbf{B} + \\left(-\\frac{\\mu}{J} + \\frac{K\\ln J}{J}\\right)\\mathbf{I} = \\frac{\\mu}{J}\\left(\\mathbf{B}-\\mathbf{I}\\right) + \\frac{K\\ln J}{J}\\mathbf{I}.\n$$\n\nUnder the uniaxial stretch,\n$$\n\\mathbf{F}=\\operatorname{diag}\\!\\left(\\lambda,\\lambda_{\\perp},\\lambda_{\\perp}\\right),\\quad \\mathbf{B}=\\operatorname{diag}\\!\\left(\\lambda^{2},\\lambda_{\\perp}^{2},\\lambda_{\\perp}^{2}\\right),\\quad J=\\lambda\\,\\lambda_{\\perp}^{2}.\n$$\nTherefore, the principal Cauchy stresses are\n\\begin{align*}\n\\sigma_{11} &= \\frac{\\mu}{J}\\left(\\lambda^{2}-1\\right) + \\frac{K\\ln J}{J},\\\\\n\\sigma_{22} &= \\frac{\\mu}{J}\\left(\\lambda_{\\perp}^{2}-1\\right) + \\frac{K\\ln J}{J},\\\\\n\\sigma_{33} &= \\frac{\\mu}{J}\\left(\\lambda_{\\perp}^{2}-1\\right) + \\frac{K\\ln J}{J}.\n\\end{align*}\nThe traction-free lateral boundary conditions require\n$$\n\\sigma_{22}=\\sigma_{33}=0 \\quad\\Rightarrow\\quad \\frac{\\mu}{J}\\left(\\lambda_{\\perp}^{2}-1\\right) + \\frac{K\\ln J}{J} = 0.\n$$\nMultiplying by $J$ gives\n$$\nK\\ln J = -\\mu\\left(\\lambda_{\\perp}^{2}-1\\right).\n$$\nUsing $J=\\lambda\\,\\lambda_{\\perp}^{2}$, this relation becomes\n$$\nK\\ln\\!\\left(\\lambda\\,\\lambda_{\\perp}^{2}\\right) = -\\mu\\left(\\lambda_{\\perp}^{2}-1\\right).\n$$\nDefine $x=\\lambda_{\\perp}^{2}>0$ and $\\alpha=\\mu/K>0$. Then\n$$\n\\ln\\!\\left(\\lambda x\\right) = -\\alpha\\left(x-1\\right),\n$$\nwhich rearranges to\n$$\n\\ln x + \\ln \\lambda = -\\alpha x + \\alpha \\quad\\Rightarrow\\quad \\ln x = -\\alpha x + \\alpha - \\ln \\lambda.\n$$\nExponentiating both sides yields\n$$\nx = \\exp\\!\\left(-\\alpha x\\right)\\exp\\!\\left(\\alpha\\right)\\lambda^{-1},\n$$\nso\n$$\nx\\,\\exp\\!\\left(\\alpha x\\right) = \\exp\\!\\left(\\alpha\\right)\\lambda^{-1}.\n$$\nMultiplying both sides by $\\alpha$ and introducing the Lambert $W$ function, defined by $\\mathrm{W}(z)\\exp\\!\\left(\\mathrm{W}(z)\\right)=z$, we obtain\n$$\n\\alpha x\\,\\exp\\!\\left(\\alpha x\\right) = \\alpha\\,\\exp\\!\\left(\\alpha\\right)\\lambda^{-1} \\quad\\Rightarrow\\quad \\alpha x = \\mathrm{W}\\!\\left(\\alpha\\,\\exp\\!\\left(\\alpha\\right)\\lambda^{-1}\\right).\n$$\nThus,\n$$\nx = \\frac{1}{\\alpha}\\,\\mathrm{W}\\!\\left(\\alpha\\,\\exp\\!\\left(\\alpha\\right)\\lambda^{-1}\\right) = \\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right).\n$$\nWith $x=\\lambda_{\\perp}^{2}$, the Jacobian becomes\n$$\nJ = \\lambda x = \\lambda\\,\\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right).\n$$\nUsing the lateral equilibrium relation $K\\ln J = -\\mu\\left(x-1\\right)$ in $\\sigma_{11}$,\n$$\n\\sigma_{11} = \\frac{\\mu}{J}\\left(\\lambda^{2}-1\\right) + \\frac{K\\ln J}{J} = \\frac{\\mu}{J}\\left(\\lambda^{2}-1\\right) - \\frac{\\mu}{J}\\left(x-1\\right) = \\frac{\\mu}{J}\\left(\\lambda^{2}-x\\right).\n$$\nSubstituting $x$ and $J$ from the Lambert $W$ expressions,\n\\begin{align*}\n\\sigma_{11} &= \\frac{\\mu}{\\lambda\\,\\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}\\left(\\lambda^{2} - \\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)\\right)\\\\\n&= \\frac{\\mu^{2}}{\\lambda K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}\\,\\lambda^{2} \\;-\\; \\frac{\\mu^{2}}{\\lambda K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}\\cdot\\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)\\\\\n&= \\frac{\\mu^{2}\\lambda}{K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)} \\;-\\; \\frac{\\mu}{\\lambda}.\n\\end{align*}\nThis gives the desired closed-form axial Cauchy stress in terms of the prescribed axial stretch $\\lambda$ and the material moduli $\\mu$ and $K$. The physically relevant solution takes the principal branch of the Lambert $W$ function since $\\lambda>0$, $\\mu>0$, and $K>0$ make the argument positive.",
            "answer": "$$\\boxed{\\mu\\left(\\frac{\\mu\\,\\lambda}{K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}-\\frac{1}{\\lambda}\\right)}$$"
        },
        {
            "introduction": "While analytical solutions are invaluable for building intuition, most real-world engineering problems require numerical methods. This final practice bridges the gap between continuous theory and computational practice by guiding you through the implementation of a simple finite element. You will assemble the core matrices that govern a linear elastic element, apply boundary conditions, and solve for the displacement field, providing a foundational understanding of the engine behind modern simulation software .",
            "id": "3440488",
            "problem": "Consider the small-strain, linear elastic weak form for a two-dimensional ($2$D) continuum under plane stress, discretized by a single linear triangular finite element with three nodes. Let the displacement field be represented by nodal degrees of freedom $d_{ix}$ and $d_{iy}$ for node $i \\in \\{1,2,3\\}$, and let the strain be the symmetric gradient of displacement. The material behavior is isotropic, with the stress related to strain through a linear material tangent matrix $C$ for plane stress, parameterized by Young's modulus $E$ (in Pascals, $\\mathrm{Pa}$) and Poisson's ratio $\\nu$ (dimensionless). The element has thickness $t$ in meters ($\\mathrm{m}$). Natural boundary conditions are included via traction $\\mathbf{p}$ on specified element edges, where $\\mathbf{p}$ is given as a constant vector per unit area in $\\mathrm{N/m^2}$, and the resulting line traction along the mid-surface is $\\mathbf{p}\\,t$ in $\\mathrm{N/m}$. Essential (Dirichlet) boundary conditions are prescribed on selected nodal displacement components.\n\nYour task is to implement the weak form for this single triangular element and compute:\n- the element strain-displacement matrix $B$ from the linear shape function gradients over the element domain,\n- the material tangent matrix $C$ for plane stress given $(E,\\nu)$,\n- the element stiffness matrix $K$ by integrating the bilinear form over the element domain,\n- the consistent nodal force vector from the traction boundary term over a specified element edge,\n- the solution for nodal displacements by enforcing Dirichlet boundary conditions exactly through algebraic elimination, then solving the linear system $K\\mathbf{d} = \\mathbf{f}$.\n\nAll geometric quantities are in meters ($\\mathrm{m}$). Forces are in Newtons ($\\mathrm{N}$). Stresses are in Pascals ($\\mathrm{Pa}$). Displacements must be reported in meters ($\\mathrm{m}$). Angles are not used. You must implement the above without relying on any pre-coded finite element routines.\n\nFor each test case below, assemble the single-element system, apply the specified Dirichlet and Neumann boundary conditions, solve for the nodal displacement vector $\\mathbf{d} = [d_{1x},d_{1y},d_{2x},d_{2y},d_{3x},d_{3y}]^\\top$ in meters, and report the requested scalar quantity. The material model is plane stress linear elasticity, and you must treat the traction $\\mathbf{p}$ as uniform along the indicated edge and constant across the thickness, so that the total line traction used in the boundary integral is $\\mathbf{p}\\,t$ in $\\mathrm{N/m}$.\n\nTest Suite:\n- Test case $1$ (general case): \n  - Nodal coordinates (in $\\mathrm{m}$): node $1$ at $(x_1,y_1)=(0,0)$, node $2$ at $(x_2,y_2)=(1.0,0)$, node $3$ at $(x_3,y_3)=(0,1.0)$.\n  - Material parameters: $E=70\\times 10^9\\,\\mathrm{Pa}$, $\\nu=0.33$, thickness $t=0.01\\,\\mathrm{m}$.\n  - Dirichlet boundary conditions: $d_{1x}=0, d_{1y}=0, d_{2y}=0$.\n  - Neumann boundary condition: uniform traction $\\mathbf{p}=(5\\times 10^6,\\,0)\\,\\mathrm{Pa}$ applied along edge $(2,3)$.\n  - Report: the scalar displacement $d_{3x}$ in $\\mathrm{m}$.\n- Test case $2$ (thin element under downward traction):\n  - Nodal coordinates (in $\\mathrm{m}$): node $1$ at $(0,0)$, node $2$ at $(2.0,0)$, node $3$ at $(0,0.5)$.\n  - Material parameters: $E=200\\times 10^9\\,\\mathrm{Pa}$, $\\nu=0.29$, thickness $t=1\\times 10^{-4}\\,\\mathrm{m}$.\n  - Dirichlet boundary conditions: $d_{1x}=0, d_{1y}=0, d_{3x}=0$.\n  - Neumann boundary condition: uniform traction $\\mathbf{p}=(0,\\,-1\\times 10^6)\\,\\mathrm{Pa}$ applied along edge $(1,2)$.\n  - Report: the scalar displacement $d_{2y}$ in $\\mathrm{m}$.\n- Test case $3$ (oblique traction with mixed constraints):\n  - Nodal coordinates (in $\\mathrm{m}$): node $1$ at $(0,0)$, node $2$ at $(0.5,0)$, node $3$ at $(0,0.5)$.\n  - Material parameters: $E=210\\times 10^9\\,\\mathrm{Pa}$, $\\nu=0.30$, thickness $t=0.02\\,\\mathrm{m}$.\n  - Dirichlet boundary conditions: $d_{2x}=0, d_{2y}=0, d_{1y}=0$.\n  - Neumann boundary condition: uniform traction $\\mathbf{p}=(2\\times 10^6,\\,2\\times 10^6)\\,\\mathrm{Pa}$ applied along edge $(1,3)$.\n  - Report: the Euclidean norm $\\|\\mathbf{d}\\|_2$ in $\\mathrm{m}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of test cases $1$ through $3$. For example, an output of the form $[r_1,r_2,r_3]$ where each $r_i$ is a floating-point number in meters ($\\mathrm{m}$).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of continuum mechanics and the finite element method, is well-posed with sufficient boundary conditions to ensure a unique solution, and is stated in objective, formal language with all necessary data provided. The problem constitutes a standard, non-trivial exercise in computational solid mechanics.\n\nThe solution involves deriving and implementing the matrix equations for a single three-node linear triangular finite element under plane stress conditions. The governing equation is the linear system $K\\mathbf{d} = \\mathbf{f}$, where $K$ is the element stiffness matrix, $\\mathbf{d}$ is the vector of nodal displacements, and $\\mathbf{f}$ is the vector of nodal forces.\n\nFirst, we define the geometry and interpolation for a linear triangular element. The element is defined by three nodes with coordinates $(x_1, y_1)$, $(x_2, y_2)$, and $(x_3, y_3)$. The displacement field $\\mathbf{u}(x,y) = [u_x(x,y), u_y(x,y)]^\\top$ within the element is interpolated from the nodal displacements $\\mathbf{d}_i = [d_{ix}, d_{iy}]^\\top$ using linear shape functions $N_i(x,y)$:\n$$\n\\mathbf{u}(x,y) = \\sum_{i=1}^3 N_i(x,y) \\mathbf{d}_i\n$$\nThe shape functions for a linear triangle are given by:\n$$\nN_i(x,y) = \\frac{1}{2A}(a_i + b_i x + c_i y)\n$$\nwhere $A$ is the area of the triangle, calculated as:\n$$\nA = \\frac{1}{2} \\det \\begin{pmatrix} 1 & x_1 & y_1 \\\\ 1 & x_2 & y_2 \\\\ 1 & x_3 & y_3 \\end{pmatrix} = \\frac{1}{2} [x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2)]\n$$\nThe coefficients $b_i$ and $c_i$ are functions of the nodal coordinates:\n$b_1 = y_2 - y_3$, $b_2 = y_3 - y_1$, $b_3 = y_1 - y_2$\n$c_1 = x_3 - x_2$, $c_2 = x_1 - x_3$, $c_3 = x_2 - x_1$\nThe coefficients $a_i$ are not needed for strain calculations, which depend on derivatives.\n\nThe strain components for small-strain theory are given by the symmetric gradient of the displacement field. In Voigt notation, the strain vector is $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^\\top$, where $\\gamma_{xy}$ is the engineering shear strain.\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x}, \\quad \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\n$$\nSubstituting the interpolated displacement field, we relate strain to the nodal displacement vector $\\mathbf{d} = [d_{1x}, d_{1y}, d_{2x}, d_{2y}, d_{3x}, d_{3y}]^\\top$ via the strain-displacement matrix $B$:\n$$\n\\boldsymbol{\\epsilon} = B \\mathbf{d}\n$$\nFor a linear triangle, the shape function derivatives are constant, which makes the $B$ matrix constant throughout the element. It is a $3 \\times 6$ matrix given by:\n$$\nB = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x} & 0 & \\frac{\\partial N_2}{\\partial x} & 0 & \\frac{\\partial N_3}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_1}{\\partial y} & 0 & \\frac{\\partial N_2}{\\partial y} & 0 & \\frac{\\partial N_3}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\frac{\\partial N_2}{\\partial y} & \\frac{\\partial N_2}{\\partial x} & \\frac{\\partial N_3}{\\partial y} & \\frac{\\partial N_3}{\\partial x}\n\\end{pmatrix} = \\frac{1}{2A} \\begin{pmatrix}\nb_1 & 0 & b_2 & 0 & b_3 & 0 \\\\\n0 & c_1 & 0 & c_2 & 0 & c_3 \\\\\nc_1 & b_1 & c_2 & b_2 & c_3 & b_3\n\\end{pmatrix}\n$$\n\nThe material behavior is isotropic linear elastic under plane stress. The stress vector $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$ is related to the strain vector by the constitutive matrix $C$:\n$$\n\\boldsymbol{\\sigma} = C \\boldsymbol{\\epsilon}\n$$\nFor plane stress, the $3 \\times 3$ matrix $C$ is:\n$$\nC = \\frac{E}{1 - \\nu^2} \\begin{pmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\nwhere $E$ is Young's modulus and $\\nu$ is Poisson's ratio.\n\nThe element stiffness matrix $K$ is derived from the strain energy and is given by the integral of $B^\\top C B$ over the element volume $V$. For a constant-strain triangle of thickness $t$, this simplifies to:\n$$\nK = \\int_V B^\\top C B \\, dV = (B^\\top C B) \\int_V dV = B^\\top C B \\cdot A \\cdot t\n$$\nThe resulting matrix $K$ is a symmetric $6 \\times 6$ matrix.\n\nThe consistent nodal force vector $\\mathbf{f}$ due to a uniform traction $\\mathbf{p} = [p_x, p_y]^\\top$ applied over an edge of length $L$ is calculated by integrating the traction multiplied by the shape functions along that edge. For a linear element, the total force $\\mathbf{F}_{tot} = \\mathbf{p} \\, t \\, L$ is distributed equally to the two nodes on the edge. If traction is applied on the edge connecting nodes $i$ and $j$ with length $L_{ij}$, the forces on these nodes are:\n$$\n\\mathbf{f}_i = \\frac{1}{2} \\mathbf{p} \\, t \\, L_{ij}, \\quad \\mathbf{f}_j = \\frac{1}{2} \\mathbf{p} \\, t \\, L_{ij}\n$$\nThe components of these vectors are assembled into the global $6 \\times 1$ force vector $\\mathbf{f}$.\n\nWith $K$ and $\\mathbf{f}$ assembled, we have the system $K\\mathbf{d} = \\mathbf{f}$. The Dirichlet boundary conditions (prescribed displacements) are enforced by partitioning the system. The set of all degrees of freedom (DOFs), indexed from $0$ to $5$, is split into a set of free DOFs, $S_f$, and a set of prescribed DOFs, $S_p$. The system is rearranged as:\n$$\n\\begin{pmatrix} K_{ff} & K_{fp} \\\\ K_{pf} & K_{pp} \\end{pmatrix} \\begin{pmatrix} \\mathbf{d}_f \\\\ \\mathbf{d}_p \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f}_f \\\\ \\mathbf{f}_p \\end{pmatrix}\n$$\nwhere $\\mathbf{d}_f$ are the unknown displacements and $\\mathbf{d}_p$ are the known prescribed displacements. We solve the reduced system for the unknown displacements:\n$$\nK_{ff} \\mathbf{d}_f = \\mathbf{f}_f - K_{fp} \\mathbf{d}_p\n$$\nIn all test cases provided, the prescribed displacements are zero, so $\\mathbf{d}_p = \\mathbf{0}$, simplifying the system to $K_{ff} \\mathbf{d}_f = \\mathbf{f}_f$. After solving this smaller linear system, the full displacement vector $\\mathbf{d}$ is constructed by combining the computed $\\mathbf{d}_f$ and the known $\\mathbf{d}_p$. The required scalar output is then extracted from $\\mathbf{d}$. This procedure is applied systematically to each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"material\": {\"E\": 70e9, \"nu\": 0.33, \"t\": 0.01},\n            \"bcs\": {\n                \"dirichlet\": {0: 0.0, 1: 0.0, 3: 0.0},  # u1x, u1y, u2y\n                \"neumann\": {\"edge\": (1, 2), \"traction\": np.array([5e6, 0.0])}\n            },\n            \"report\": (\"scalar\", 4)  # u3x, index 4\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [2.0, 0.0], [0.0, 0.5]]),\n            \"material\": {\"E\": 200e9, \"nu\": 0.29, \"t\": 1e-4},\n            \"bcs\": {\n                \"dirichlet\": {0: 0.0, 1: 0.0, 4: 0.0},  # u1x, u1y, u3x\n                \"neumann\": {\"edge\": (0, 1), \"traction\": np.array([0.0, -1e6])}\n            },\n            \"report\": (\"scalar\", 3)  # u2y, index 3\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [0.5, 0.0], [0.0, 0.5]]),\n            \"material\": {\"E\": 210e9, \"nu\": 0.30, \"t\": 0.02},\n            \"bcs\": {\n                \"dirichlet\": {3: 0.0, 1: 0.0, 2: 0.0},  # u2y, u1y, u2x\n                \"neumann\": {\"edge\": (0, 2), \"traction\": np.array([2e6, 2e6])}\n            },\n            \"report\": (\"norm\", None)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_fem_case(case[\"nodes\"], case[\"material\"], case[\"bcs\"], case[\"report\"])\n        results.append(f\"{result:.7e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_fem_case(nodes, material, bcs, report_spec):\n    \"\"\"\n    Solves a single 2D plane stress linear elastic finite element problem.\n\n    Args:\n        nodes (np.ndarray): A 3x2 array of nodal coordinates.\n        material (dict): Dictionary with keys 'E', 'nu', 't'.\n        bcs (dict): Dictionary with 'dirichlet' and 'neumann' boundary conditions.\n        report_spec (tuple): Specification of what to report ('scalar' or 'norm').\n\n    Returns:\n        float: The requested result.\n    \"\"\"\n    # 1. Element Area and Shape Function Derivatives\n    x1, y1 = nodes[0]\n    x2, y2 = nodes[1]\n    x3, y3 = nodes[2]\n    \n    area = 0.5 * (x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n    \n    b = np.array([y2 - y3, y3 - y1, y1 - y2])\n    c = np.array([x3 - x2, x1 - x3, x2 - x1])\n\n    # 2. Strain-Displacement Matrix (B)\n    B = np.zeros((3, 6))\n    for i in range(3):\n        B[0, 2 * i] = b[i]\n        B[1, 2 * i + 1] = c[i]\n        B[2, 2 * i] = c[i]\n        B[2, 2 * i + 1] = b[i]\n    B /= (2 * area)\n\n    # 3. Material Tangent Matrix (C) for Plane Stress\n    E, nu, t = material['E'], material['nu'], material['t']\n    C = (E / (1 - nu**2)) * np.array([\n        [1, nu, 0],\n        [nu, 1, 0],\n        [0, 0, (1 - nu) / 2]\n    ])\n\n    # 4. Element Stiffness Matrix (K)\n    K = B.T @ C @ B * area * t\n\n    # 5. Nodal Force Vector from Traction (f)\n    f = np.zeros(6)\n    neumann_bc = bcs[\"neumann\"]\n    n1_idx, n2_idx = neumann_bc[\"edge\"]\n    p = neumann_bc[\"traction\"]\n    \n    node1_coords = nodes[n1_idx]\n    node2_coords = nodes[n2_idx]\n    \n    edge_length = np.linalg.norm(node2_coords - node1_coords)\n    \n    total_force = p * t * edge_length\n    \n    f[2 * n1_idx : 2 * n1_idx + 2] += total_force / 2\n    f[2 * n2_idx : 2 * n2_idx + 2] += total_force / 2\n\n    # 6. Apply Boundary Conditions and Solve\n    dirichlet_dofs = list(bcs[\"dirichlet\"].keys())\n    dirichlet_vals = np.array(list(bcs[\"dirichlet\"].values()))\n    \n    all_dofs = list(range(6))\n    free_dofs = sorted(list(set(all_dofs) - set(dirichlet_dofs)))\n\n    K_ff = K[np.ix_(free_dofs, free_dofs)]\n    K_fp = K[np.ix_(free_dofs, dirichlet_dofs)]\n    f_f = f[free_dofs]\n    \n    # Solve K_ff * d_f = f_f - K_fp * d_p\n    # Here, d_p is zero for all test cases.\n    d_p = dirichlet_vals\n    \n    rhs = f_f - K_fp @ d_p\n    d_f = np.linalg.solve(K_ff, rhs)\n\n    # Reconstruct full displacement vector\n    d = np.zeros(6)\n    d[free_dofs] = d_f\n    d[dirichlet_dofs] = d_p\n\n    # Report the required result\n    report_type, report_idx = report_spec\n    if report_type == \"scalar\":\n        return d[report_idx]\n    elif report_type == \"norm\":\n        return np.linalg.norm(d)\n    else:\n        return 0.0\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}