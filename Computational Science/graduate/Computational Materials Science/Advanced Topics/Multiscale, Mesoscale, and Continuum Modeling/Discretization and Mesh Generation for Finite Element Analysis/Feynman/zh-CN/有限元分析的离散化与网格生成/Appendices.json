{
    "hands_on_practices": [
        {
            "introduction": "形函数是有限元法的基石，它定义了物理场在单个单元内的变化规律。本练习将超越简单的线性函数，深入探讨二次（$P_2$）单元的构建，这种单元能提供更高的精度。掌握其形函数的推导过程，能够帮助你深刻理解有限元法的多项式插值基础，是进行单元开发或定制的关键一步。",
            "id": "3445730",
            "problem": "考虑平面上的一个非退化三角形$\\mathcal{T}$，其顶点为$\\boldsymbol{v}_{1}=(x_{1},y_{1})$、$\\boldsymbol{v}_{2}=(x_{2},y_{2})$和$\\boldsymbol{v}_{3}=(x_{3},y_{3})$，其有向面积$A$满足$A \\neq 0$。通过仿射关系$\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$和$\\boldsymbol{x}=\\lambda_{1}\\boldsymbol{v}_{1}+\\lambda_{2}\\boldsymbol{v}_{2}+\\lambda_{3}\\boldsymbol{v}_{3}$，为$\\mathcal{T}$上的任意点$\\boldsymbol{x}=(x,y)\\in\\mathcal{T}$定义重心（面积）坐标$\\lambda_{1}$、$\\lambda_{2}$、$\\lambda_{3}$。考虑$\\mathcal{T}$上的二次 Lagrange ($P_{2}$)有限元，其节点集如下：3个顶点和3个边中点$\\boldsymbol{m}_{12}=\\frac{1}{2}(\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2})$、$\\boldsymbol{m}_{23}=\\frac{1}{2}(\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3})$和$\\boldsymbol{m}_{31}=\\frac{1}{2}(\\boldsymbol{v}_{3}+\\boldsymbol{v}_{1})$。设节点排序为$(\\boldsymbol{v}_{1},\\boldsymbol{v}_{2},\\boldsymbol{v}_{3},\\boldsymbol{m}_{12},\\boldsymbol{m}_{23},\\boldsymbol{m}_{31})$。\n\n仅使用重心坐标、多项式空间和节点有限元的 Lagrange 插值性质的核心定义，完成以下任务：\n\n1) 以重心坐标$(\\lambda_{1},\\lambda_{2},\\lambda_{3})$表示，构造 6 个二次形函数$N_{1},\\dots,N_{6}$，使得每个$N_{i}$是总次数为 2 的多项式，在节点$i$处等于 1，在所有其他节点处等于 0，并且在$\\mathcal{T}$上满足$\\sum_{i=1}^{6}N_{i}=1$。\n\n2) 用$\\nabla \\lambda_{1}$、$\\nabla \\lambda_{2}$和$\\nabla \\lambda_{3}$表示在全局笛卡尔坐标$(x,y)$中的梯度$\\nabla N_{i}$，然后用顶点坐标$(x_{j},y_{j})$和面积$A$表示$i\\in\\{1,2,3\\}$时的$\\nabla \\lambda_{i}$。\n\n3) 证明对于任意总次数至多为 2 的多项式$p(x,y)$，节点插值$I_{\\mathcal{T}}p=\\sum_{i=1}^{6}p(\\boldsymbol{x}_{i})\\,N_{i}$在$\\mathcal{T}$上能精确地重现$p$。\n\n作为最终答案，以重心坐标将 6 个形函数表示为单个行向量，节点顺序为$(\\boldsymbol{v}_{1},\\boldsymbol{v}_{2},\\boldsymbol{v}_{3},\\boldsymbol{m}_{12},\\boldsymbol{m}_{23},\\boldsymbol{m}_{31})$。不需要数值近似或舍入。不包括单位。",
            "solution": "该问题是适定的，具有科学依据，并包含唯一解所需的所有信息。这是有限元方法理论中的一个标准问题。我们可以开始求解。\n\n问题要求完成与三角形区域 $\\mathcal{T}$ 上的二次 ($P_2$) Lagrange 有限元相关的三项任务。设顶点为 $\\boldsymbol{v}_{1}$、$\\boldsymbol{v}_{2}$、$\\boldsymbol{v}_{3}$，边中点为 $\\boldsymbol{m}_{12}$、$\\boldsymbol{m}_{23}$、$\\boldsymbol{m}_{31}$。该单元的六个节点排序为 $\\boldsymbol{x}_1=\\boldsymbol{v}_1$、$\\boldsymbol{x}_2=\\boldsymbol{v}_2$、$\\boldsymbol{x}_3=\\boldsymbol{v}_3$、$\\boldsymbol{x}_4=\\boldsymbol{m}_{12}$、$\\boldsymbol{x}_5=\\boldsymbol{m}_{23}$、$\\boldsymbol{x}_6=\\boldsymbol{m}_{31}$。\n\n$\\mathcal{T}$ 中的任意点 $\\boldsymbol{x}$ 都可以用重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 唯一表示，使得 $\\boldsymbol{x} = \\lambda_1 \\boldsymbol{v}_1 + \\lambda_2 \\boldsymbol{v}_2 + \\lambda_3 \\boldsymbol{v}_3$ 且 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$。六个节点的重心坐标为：\n- $\\boldsymbol{v}_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (1, 0, 0)$\n- $\\boldsymbol{v}_2$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (0, 1, 0)$\n- $\\boldsymbol{v}_3$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (0, 0, 1)$\n- $\\boldsymbol{m}_{12} = \\frac{1}{2}\\boldsymbol{v}_1 + \\frac{1}{2}\\boldsymbol{v}_2$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2}, \\frac{1}{2}, 0)$\n- $\\boldsymbol{m}_{23} = \\frac{1}{2}\\boldsymbol{v}_2 + \\frac{1}{2}\\boldsymbol{v}_3$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (0, \\frac{1}{2}, \\frac{1}{2})$\n- $\\boldsymbol{m}_{31} = \\frac{1}{2}\\boldsymbol{v}_3 + \\frac{1}{2}\\boldsymbol{v}_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2}, 0, \\frac{1}{2})$\n\n形函数 $N_i$ 必须是二次多项式（关于 $\\lambda_j$ 的总次数为 2）并且满足 Lagrange 性质 $N_i(\\boldsymbol{x}_j) = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 δ 符号。\n\n**1) 形函数 $N_i$ 的构造**\n\n我们通过确定每个形函数必须为零的直线来构造它。如果一个多项式在某条直线上为零，则该直线的线性方程必须是该多项式的一个因子。\n\n- **顶点 $\\boldsymbol{v}_1$ 的形函数 $N_1$**：\n$N_1$ 必须在节点 $\\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4, \\boldsymbol{x}_5, \\boldsymbol{x}_6$ 处为零。\n节点 $\\boldsymbol{v}_2$、$\\boldsymbol{v}_3$ 和 $\\boldsymbol{m}_{23}$ 位于与 $\\boldsymbol{v}_1$ 相对的边上。这条直线的方程是 $\\lambda_1 = 0$。因此，$\\lambda_1$ 必须是 $N_1$ 的一个因子。\n节点 $\\boldsymbol{m}_{12}$ 和 $\\boldsymbol{m}_{31}$ 位于连接与 $\\boldsymbol{v}_1$ 相邻的两条边中点的直线上。这条直线上的重心坐标满足 $\\lambda_1 = \\frac{1}{2}$。因此，$(\\lambda_1 - \\frac{1}{2})$ 必须是 $N_1$ 的一个因子。\n综合起来，$N_1$ 的形式必须为 $N_1 = c_1 \\lambda_1 (\\lambda_1 - \\frac{1}{2})$，其中 $c_1$ 为某个常数。这是一个二次多项式。\n为了求出 $c_1$，我们施加条件 $N_1(\\boldsymbol{v}_1) = 1$。在 $\\boldsymbol{v}_1$ 处，$\\lambda_1 = 1$。\n$N_1(\\boldsymbol{v}_1) = c_1 (1) (1 - \\frac{1}{2}) = \\frac{c_1}{2} = 1 \\implies c_1 = 2$。\n所以，$N_1 = 2\\lambda_1(\\lambda_1 - \\frac{1}{2}) = \\lambda_1(2\\lambda_1 - 1)$。\n通过指标的轮换，其他两个顶点的形函数为：\n$N_2 = \\lambda_2(2\\lambda_2 - 1)$\n$N_3 = \\lambda_3(2\\lambda_3 - 1)$\n\n- **中点 $\\boldsymbol{m}_{12}$ 的形函数 $N_4$**：\n$N_4$ 必须在节点 $\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{m}_{23}, \\boldsymbol{m}_{31}$ 处为零。\n节点 $\\boldsymbol{v}_2$、$\\boldsymbol{v}_3$、$\\boldsymbol{m}_{23}$ 位于直线 $\\lambda_1 = 0$ 上。所以 $\\lambda_1$ 是一个因子。\n节点 $\\boldsymbol{v}_1$、$\\boldsymbol{v}_3$、$\\boldsymbol{m}_{31}$ 位于直线 $\\lambda_2 = 0$ 上。所以 $\\lambda_2$ 是一个因子。\n因此，$N_4$ 的形式为 $N_4 = c_4 \\lambda_1 \\lambda_2$。这是一个二次多项式。\n为了求出 $c_4$，我们施加条件 $N_4(\\boldsymbol{m}_{12}) = 1$。在 $\\boldsymbol{m}_{12}$ 处，$\\lambda_1=\\frac{1}{2}$ 且 $\\lambda_2=\\frac{1}{2}$。\n$N_4(\\boldsymbol{m}_{12}) = c_4 (\\frac{1}{2})(\\frac{1}{2}) = \\frac{c_4}{4} = 1 \\implies c_4 = 4$。\n所以，$N_4 = 4\\lambda_1\\lambda_2$。\n通过轮换，其他两个中点的形函数为：\n$N_5 = 4\\lambda_2\\lambda_3$\n$N_6 = 4\\lambda_3\\lambda_1$\n\n最后，我们验证单位分解性质，$\\sum_{i=1}^6 N_i = 1$：\n$\\sum_{i=1}^6 N_i = \\lambda_1(2\\lambda_1-1) + \\lambda_2(2\\lambda_2-1) + \\lambda_3(2\\lambda_3-1) + 4\\lambda_1\\lambda_2 + 4\\lambda_2\\lambda_3 + 4\\lambda_3\\lambda_1$\n$= (2\\lambda_1^2 + 2\\lambda_2^2 + 2\\lambda_3^2 + 4\\lambda_1\\lambda_2 + 4\\lambda_2\\lambda_3 + 4\\lambda_3\\lambda_1) - (\\lambda_1 + \\lambda_2 + \\lambda_3)$\n$= 2(\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2 + 2\\lambda_1\\lambda_2 + 2\\lambda_2\\lambda_3 + 2\\lambda_3\\lambda_1) - (\\lambda_1 + \\lambda_2 + \\lambda_3)$\n使用恒等式 $(\\lambda_1+\\lambda_2+\\lambda_3)^2 = \\lambda_1^2+\\dots+2\\lambda_1\\lambda_2+\\dots$ 和 $\\lambda_1+\\lambda_2+\\lambda_3=1$：\n$= 2(\\lambda_1+\\lambda_2+\\lambda_3)^2 - (\\lambda_1+\\lambda_2+\\lambda_3) = 2(1)^2 - 1 = 1$。\n该性质成立。\n\n**2) 形函数的梯度**\n\n笛卡尔坐标系中的梯度算子为 $\\nabla = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})^T$。由于每个 $N_i$ 是重心坐标的函数，而重心坐标本身又是 $(x,y)$ 的函数，我们使用链式法则：\n$\\nabla N_i = \\frac{\\partial N_i}{\\partial \\lambda_1}\\nabla\\lambda_1 + \\frac{\\partial N_i}{\\partial \\lambda_2}\\nabla\\lambda_2 + \\frac{\\partial N_i}{\\partial \\lambda_3}\\nabla\\lambda_3$。\n\n- 对于顶点节点 ($i=1,2,3$)：\n$\\nabla N_1 = \\nabla(2\\lambda_1^2 - \\lambda_1) = (4\\lambda_1-1)\\nabla\\lambda_1$\n$\\nabla N_2 = (4\\lambda_2-1)\\nabla\\lambda_2$\n$\\nabla N_3 = (4\\lambda_3-1)\\nabla\\lambda_3$\n\n- 对于中点节点 ($i=4,5,6$)：\n$\\nabla N_4 = \\nabla(4\\lambda_1\\lambda_2) = 4\\lambda_2\\nabla\\lambda_1 + 4\\lambda_1\\nabla\\lambda_2$\n$\\nabla N_5 = \\nabla(4\\lambda_2\\lambda_3) = 4\\lambda_3\\nabla\\lambda_2 + 4\\lambda_2\\nabla\\lambda_3$\n$\\nabla N_6 = \\nabla(4\\lambda_3\\lambda_1) = 4\\lambda_1\\nabla\\lambda_3 + 4\\lambda_3\\nabla\\lambda_1$\n\n接下来，我们用顶点坐标表示 $\\nabla\\lambda_i$。重心坐标由以下方程组定义：\n$$\n\\begin{pmatrix} x \\\\ y \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} x_1  x_2  x_3 \\\\ y_1  y_2  y_3 \\\\ 1  1  1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix}\n$$\n该矩阵的行列式为 $D = x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2) = 2A$，其中 $A$ 是三角形的有向面积。使用 Cramer 法则求解 $\\lambda_1$：\n$$ \\lambda_1 = \\frac{1}{2A} \\det \\begin{pmatrix} x  x_2  x_3 \\\\ y  y_2  y_3 \\\\ 1  1  1 \\end{pmatrix} = \\frac{1}{2A} \\left( x(y_2-y_3) - y(x_2-x_3) + x_2y_3-x_3y_2 \\right) $$\n由于 $\\lambda_1$ 是 $x$ 和 $y$ 的线性函数，其梯度是一个常向量：\n$$ \\nabla \\lambda_1 = \\begin{pmatrix} \\partial \\lambda_1 / \\partial x \\\\ \\partial \\lambda_1 / \\partial y \\end{pmatrix} = \\frac{1}{2A} \\begin{pmatrix} y_2-y_3 \\\\ x_3-x_2 \\end{pmatrix} $$\n通过指标的轮换 $(1 \\to 2, 2 \\to 3, 3 \\to 1)$，我们求得其他梯度：\n$$ \\nabla \\lambda_2 = \\frac{1}{2A} \\begin{pmatrix} y_3-y_1 \\\\ x_1-x_3 \\end{pmatrix} $$\n$$ \\nabla \\lambda_3 = \\frac{1}{2A} \\begin{pmatrix} y_1-y_2 \\\\ x_2-x_1 \\end{pmatrix} $$\n\n**3) 二次多项式的再生**\n\n设 $P_2(\\mathcal{T})$ 表示 $\\mathcal{T}$ 上总次数至多为 2 的多项式空间。该向量空间的维数为 $\\dim(P_2) = \\frac{(2+1)(2+2)}{2} = 6$。六个形函数 $\\{N_1, \\dots, N_6\\}$ 是 $P_2(\\mathcal{T})$ 中的元素。为证明它们构成 $P_2(\\mathcal{T})$ 的一组基，我们必须证明它们是线性无关的。\n\n假设形函数的某个线性组合在 $\\mathcal{T}$ 上处处为零：\n$$ \\sum_{j=1}^6 c_j N_j(\\boldsymbol{x}) = 0 \\quad \\forall \\boldsymbol{x} \\in \\mathcal{T} $$\n我们可以在六个节点 $\\boldsymbol{x}_i$（$i=1, \\dots, 6$）处计算该表达式的值：\n$$ \\sum_{j=1}^6 c_j N_j(\\boldsymbol{x}_i) = 0 $$\n根据 Lagrange 性质，$N_j(\\boldsymbol{x}_i) = \\delta_{ij}$。求和式简化为：\n$$ \\sum_{j=1}^6 c_j \\delta_{ij} = c_i $$\n这意味着对于所有 $i \\in \\{1, \\dots, 6\\}$，$c_i = 0$。因此，形函数集合 $\\{N_1, \\dots, N_6\\}$ 是线性无关的。由于在一个 6 维空间中有 6 个线性无关的函数，它们构成了 $P_2(\\mathcal{T})$ 的一组基。\n\n现在，设 $p(x,y)$ 是任意一个总次数至多为 2 的多项式，因此 $p \\in P_2(\\mathcal{T})$。由于 $\\{N_i\\}$ 是一组基， $p$ 可以唯一地写成一个线性组合：\n$$ p(\\boldsymbol{x}) = \\sum_{i=1}^6 \\alpha_i N_i(\\boldsymbol{x}) $$\n为了求出系数 $\\alpha_i$，我们在节点 $\\boldsymbol{x}_j$ 处计算该等式：\n$$ p(\\boldsymbol{x}_j) = \\sum_{i=1}^6 \\alpha_i N_i(\\boldsymbol{x}_j) = \\sum_{i=1}^6 \\alpha_i \\delta_{ij} = \\alpha_j $$\n这些系数就是多项式本身的节点值：$\\alpha_j = p(\\boldsymbol{x}_j)$。代回原式得到：\n$$ p(\\boldsymbol{x}) = \\sum_{i=1}^6 p(\\boldsymbol{x}_i) N_i(\\boldsymbol{x}) $$\n右边正是节点插值 $I_{\\mathcal{T}}p$ 的定义。因此，对于任意 $p \\in P_2(\\mathcal{T})$，我们有 $p(\\boldsymbol{x}) = I_{\\mathcal{T}}p(\\boldsymbol{x})$ 对所有 $\\boldsymbol{x} \\in \\mathcal{T}$ 成立。这证明了二次 Lagrange 插值能精确地再生二次多项式。\n\n所要求的最终答案是这 6 个形函数的集合。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_{1}(2\\lambda_{1}-1) & \\lambda_{2}(2\\lambda_{2}-1) & \\lambda_{3}(2\\lambda_{3}-1) & 4\\lambda_{1}\\lambda_{2} & 4\\lambda_{2}\\lambda_{3} & 4\\lambda_{3}\\lambda_{1}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理论中，我们常使用完美的正方形或三角形作为参考单元，但在实际应用中，必须将这些理想单元映射到真实的、可能扭曲的网格形状上。本练习探讨了等参映射及其雅可比矩阵，特别是雅可比行列式（$\\det J$），它是衡量单元质量的关键指标。确保单元映射有效且未发生“翻转”（即 $\\det J \\gt 0$），是获得有物理意义结果的先决条件。",
            "id": "3445743",
            "problem": "考虑一个用于离散化计算材料科学中二维微观结构域的等参双线性四边形单元。该单元使用自然坐标 $\\xi,\\eta \\in [-1,1]$ 和 $i=1,2,3,4$ 的标准双线性形函数 $N_{i}(\\xi,\\eta)$。物理节点坐标 $\\left(x_{i}, y_{i}\\right)$ (以毫米为单位) 从左下角开始按逆时针顺序给出：\n- 节点 $1$：$(x_{1},y_{1}) = (0,0)$，\n- 节点 $2$：$(x_{2},y_{2}) = (40,5)$，\n- 节点 $3$：$(x_{3},y_{3}) = (45,41)$，\n- 节点 $4$：$(x_{4},y_{4}) = (-3,38)$。\n\n从参考正方形到物理单元的等参映射为\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, x_{i}, \\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, y_{i},\n$$\n其雅可比矩阵为\n$$\nJ(\\xi,\\eta) = \n\\begin{pmatrix}\n\\dfrac{\\partial x}{\\partial \\xi} & \\dfrac{\\partial x}{\\partial \\eta} \\\\\n\\dfrac{\\partial y}{\\partial \\xi} & \\dfrac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}, \\quad \\text{以及} \\quad \\det J(\\xi,\\eta) = \\dfrac{\\partial x}{\\partial \\xi}\\dfrac{\\partial y}{\\partial \\eta} - \\dfrac{\\partial x}{\\partial \\eta}\\dfrac{\\partial y}{\\partial \\xi}.\n$$\n\n使用标准高斯-勒让德 $2\\times 2$ 积分法则，高斯点位于 $(\\xi,\\eta) = \\left(\\pm \\dfrac{1}{\\sqrt{3}}, \\pm \\dfrac{1}{\\sqrt{3}}\\right)$。仅从双线性形函数和等参映射的定义出发，执行以下操作：\n- 计算所有四个高斯积分点上的 $\\det J$。\n- 推导 $\\det J(\\xi,\\eta)$ 的函数形式，并使用适当的数学推理来判断映射在整个单元上是否可逆 (即，对于所有 $(\\xi,\\eta) \\in [-1,1]^2$ 是否有 $\\det J(\\xi,\\eta) > 0$)。\n- 确定 $\\det J$ 在闭合参数域 $[-1,1]^2$ 上的最小值。\n\n将最终的行列式最小值四舍五入到四位有效数字，并以平方毫米 (mm$^2$) 表示。最终报告的答案必须是单个实数。",
            "solution": "该问题要求对单个双线性四边形单元的等参映射进行详细分析。主要目标是在特定点计算雅可比行列式 $\\det J$，通过确定 $\\det J$ 在整个单元域上的符号来分析映射的可逆性，并确定 $\\det J$ 的最小值。\n\n首先，我们定义在自然坐标系 $(\\xi, \\eta)$ (其中 $\\xi \\in [-1, 1]$ 和 $\\eta \\in [-1, 1]$) 中四边形单元的标准双线性形函数 $N_i(\\xi, \\eta)$：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n\n等参映射使用这些形函数和节点坐标 $(x_i, y_i)$ 将自然坐标 $(\\xi, \\eta)$ 与物理坐标 $(x, y)$ 相关联：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, x_{i}, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, y_{i}\n$$\n此变换的雅可比矩阵 $J$ 需要计算 $x$ 和 $y$ 关于 $\\xi$ 和 $\\eta$ 的偏导数。我们首先计算形函数的导数。\n关于 $\\xi$ 的导数：\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)\n$$\n关于 $\\eta$ 的导数：\n$$\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\n使用给定的节点坐标 (以毫米为单位)：$(x_1, y_1) = (0,0)$，$(x_2, y_2) = (40,5)$，$(x_3, y_3) = (45,41)$ 以及 $(x_4, y_4) = (-3,38)$，我们计算雅可比矩阵的分量。\n\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{1}{4} [-(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4]\n$$\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} [-(1-\\eta)(0) + (1-\\eta)(40) + (1+\\eta)(45) - (1+\\eta)(-3)] = \\frac{1}{4} [40(1-\\eta) + 48(1+\\eta)] = \\frac{1}{4}[88 + 8\\eta] = 22 + 2\\eta\n$$\n\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{1}{4} [-(1-\\eta)y_1 + (1-\\eta)y_2 + (1+\\eta)y_3 - (1+\\eta)y_4]\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} [-(1-\\eta)(0) + (1-\\eta)(5) + (1+\\eta)(41) - (1+\\eta)(38)] = \\frac{1}{4} [5(1-\\eta) + 3(1+\\eta)] = \\frac{1}{4}[8 - 2\\eta] = 2 - 0.5\\eta\n$$\n\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{1}{4} [-(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4]\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} [-(1-\\xi)(0) - (1+\\xi)(40) + (1+\\xi)(45) + (1-\\xi)(-3)] = \\frac{1}{4} [5(1+\\xi) - 3(1-\\xi)] = \\frac{1}{4}[2 + 8\\xi] = 0.5 + 2\\xi\n$$\n\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{1}{4} [-(1-\\xi)y_1 - (1+\\xi)y_2 + (1+\\xi)y_3 + (1-\\xi)y_4]\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} [-(1-\\xi)(0) - (1+\\xi)(5) + (1+\\xi)(41) + (1-\\xi)(38)] = \\frac{1}{4} [36(1+\\xi) + 38(1-\\xi)] = \\frac{1}{4}[74 - 2\\xi] = 18.5 - 0.5\\xi\n$$\n\n因此，雅可比矩阵为：\n$$\nJ(\\xi,\\eta) = \n\\begin{pmatrix}\n22 + 2\\eta & 0.5 + 2\\xi \\\\\n2 - 0.5\\eta & 18.5 - 0.5\\xi\n\\end{pmatrix}\n$$\n现在，我们推导雅可比行列式 $\\det J(\\xi,\\eta)$ 的函数形式：\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)\n$$\n$$\n\\det J(\\xi,\\eta) = (22 + 2\\eta)(18.5 - 0.5\\xi) - (0.5 + 2\\xi)(2 - 0.5\\eta)\n$$\n$$\n\\det J(\\xi,\\eta) = (407 - 11\\xi + 37\\eta - \\xi\\eta) - (1 - 0.25\\eta + 4\\xi - \\xi\\eta)\n$$\n$$\n\\det J(\\xi,\\eta) = 407 - 11\\xi + 37\\eta - \\xi\\eta - 1 + 0.25\\eta - 4\\xi + \\xi\\eta\n$$\n$$\n\\det J(\\xi,\\eta) = 406 - 15\\xi + 37.25\\eta\n$$\n这就是行列式的函数形式。它是 $\\xi$ 和 $\\eta$ 的线性函数。单位是 $\\text{mm}^2$。\n\n接下来，我们在四个 $2\\times 2$ 高斯积分点 $(\\xi_g, \\eta_g) = (\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}})$ 处计算 $\\det J$。令 $a = 1/\\sqrt{3}$。\n$$\n\\det J\\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right) = 406 - \\frac{15}{\\sqrt{3}} + \\frac{37.25}{\\sqrt{3}} = 406 + \\frac{22.25}{\\sqrt{3}} \\approx 418.8\n$$\n$$\n\\det J\\left(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right) = 406 + \\frac{15}{\\sqrt{3}} + \\frac{37.25}{\\sqrt{3}} = 406 + \\frac{52.25}{\\sqrt{3}} \\approx 436.2\n$$\n$$\n\\det J\\left(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right) = 406 + \\frac{15}{\\sqrt{3}} - \\frac{37.25}{\\sqrt{3}} = 406 - \\frac{22.25}{\\sqrt{3}} \\approx 393.2\n$$\n$$\n\\det J\\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right) = 406 - \\frac{15}{\\sqrt{3}} - \\frac{37.25}{\\sqrt{3}} = 406 - \\frac{52.25}{\\sqrt{3}} \\approx 375.8\n$$\n\n为判断映射是否可逆，我们必须检查对于所有 $(\\xi, \\eta) \\in [-1,1]^2$ 是否有 $\\det J(\\xi, \\eta) > 0$。由于 $\\det J(\\xi, \\eta) = 406 - 15\\xi + 37.25\\eta$ 是 $\\xi$ 和 $\\eta$ 的线性函数，其图像是一个平面。这样一个函数在闭合、有界、凸集 $[-1,1]^2$ 上的极值必定出现在该正方形域的顶点（角点）处。这些角点是 $(\\xi,\\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$。\n\n我们计算这四个角点上的 $\\det J$ 值：\n$$\n\\det J(-1, -1) = 406 - 15(-1) + 37.25(-1) = 406 + 15 - 37.25 = 383.75\n$$\n$$\n\\det J(1, -1) = 406 - 15(1) + 37.25(-1) = 406 - 15 - 37.25 = 353.75\n$$\n$$\n\\det J(1, 1) = 406 - 15(1) + 37.25(1) = 406 - 15 + 37.25 = 428.25\n$$\n$$\n\\det J(-1, 1) = 406 - 15(-1) + 37.25(1) = 406 + 15 + 37.25 = 458.25\n$$\n这些值中的最小值是 $353.75$。由于 $\\det J$ 在域 $[-1,1]^2$ 边界上的最小值是正的，且该函数是平面的，因此 $\\det J(\\xi, \\eta)$ 的值对于所有内部点也都是正的。\n$$\n\\min_{(\\xi,\\eta) \\in [-1,1]^2} \\det J(\\xi, \\eta) = 353.75 > 0\n$$\n由于在整个单元上 $\\det J(\\xi,\\eta) > 0$，因此从自然坐标到物理坐标的映射是可逆的。\n\n最后的任务是确定 $\\det J$ 在该域上的最小值。如前所述，这个最小值就是角点处的最小值。\n$$\n\\min \\det J = 353.75 \\, \\text{mm}^2\n$$\n问题要求将此值四舍五入到四位有效数字。前四位有效数字是 $3$、$5$、$3$、$7$。第五位数字是 $5$，因此我们将第四位数字向上舍入。\n$$\n353.75 \\approx 353.8\n$$",
            "answer": "$$\n\\boxed{353.8}\n$$"
        },
        {
            "introduction": "我们已经构建了单个单元并了解了如何评估其几何质量，但如何确保这些单元组合在一起时能够正确地工作并收敛到真实的解？“单元检验”（Patch Test）是一种基础且关键的验证方法，它测试一组单元（一个“斑块”）在给定相应的边界条件下，能否精确再现一个基本的物理状态，例如常应变场。通过单元检验是任何可靠有限元列式确保收敛性的必要条件。",
            "id": "3445677",
            "problem": "考虑一个二维区域上的小应变、平面应力、线性弹性问题。控制方程的强形式包括 Cauchy 动量平衡和本构关系：无体力时的线性动量平衡为$\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$，本构关系为$\\boldsymbol{\\sigma} = \\mathbf{D} \\, \\boldsymbol{\\varepsilon}$，其中小应变张量为$\\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left( \\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top} \\right)$，$\\boldsymbol{u}(x,y)$是位移场。在无体力的情况下，弱形式为：在适当的函数空间中找到$\\boldsymbol{u}$，满足$\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v})^{\\top} \\, \\mathbf{D} \\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\boldsymbol{v}^{\\top} \\boldsymbol{t} \\, \\mathrm{d}\\Gamma$，其中$\\boldsymbol{v}$是在 Dirichlet 边界上为零的任意虚位移，$\\boldsymbol{t}$是给定的面力。\n\n在有限元法的背景下，精确定义线性弹性中的“斑块检验”的含义：具体阐明对有限元空间和网格的要求，以确保在施加与线性位移场和常应变场相应的边界数据或面力时，能够精确再现这些场。\n\n然后，在一个边长为 2 的正方形上，使用带有等参插值的线性三节点三角形 (T3) 单元构建以下星形网格区域：\n- 节点和坐标：节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(2,0)$，节点 $3$ 位于 $(2,2)$，节点 $4$ 位于 $(0,2)$，中心节点 $5$ 位于 $(1,1)$。\n- 单元：$E_1 = (1,2,5)$，$E_2 = (2,3,5)$，$E_3 = (3,4,5)$，$E_4 = (4,1,5)$。\n- 厚度为$t = 1$。材料为均匀、各向同性的线性弹性材料，处于平面应力状态，其弹性矩阵 $\\mathbf{D}$ 由杨氏模量$E$和泊松比$\\nu$定义。\n\n设精确位移场由下式给定：\n$$\nu_x(x,y) = 2 + 3 x - 1.5 y, \\qquad u_y(x,y) = -1 + 0.5 x + 4 y.\n$$\n这对应于一个具有常小应变张量的线性位移场。\n\n通过在边界节点 $1$、$2$、$3$ 和 $4$ 处指定位移$\\boldsymbol{u}$等于上述精确场来施加本质（Dirichlet）边界条件。使用标准 Galerkin 方法和上述 T3 单元组装离散有限元系统，并求解节点 $5$ 处的未知位移。\n\n最后，计算由离散解产生的每个单元中的常工程应变向量，\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x} \\\\ \\frac{\\partial u_y}{\\partial y} \\\\ \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\end{pmatrix},\n$$\n并验证所有单元都能再现精确的常应变。将最终再现的常应变向量 $\\boldsymbol{\\varepsilon}$ 以单行矩阵的形式报告。最终答案不带单位。无需四舍五入。",
            "solution": "问题陈述经评估有效。这是一个计算固体力学中的适定问题，基于线性弹性和有限元法的既定原理。该问题是客观、自洽的，并且所有提供的数据都是一致且足以得到唯一解的。\n\n该问题要求精确定义斑块检验，然后将此检验应用于由 T3（线性三节点三角形）单元组成的特定星形网格。目标是验证这些单元能够精确再现常应变状态。\n\n首先，在线性弹性和有限元法的背景下，斑块检验的定义如下：\n斑块检验是协调有限元格式收敛的充要条件。它规定，对于任意一片可能具有不规则形状的单元，当施加由对应于某个常应变状态的位移场推导出的边界条件（本质 Dirichlet 条件或自然 Neumann 条件）时，有限元模型必须能精确再现该常应变状态。在线性弹性的情况下，常应变场 $\\boldsymbol{\\varepsilon}$ 由形式为 $\\boldsymbol{u}(x,y) = \\boldsymbol{a} + \\mathbf{B} \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 的线性位移场生成，其中 $\\boldsymbol{a}$ 是代表刚体平移的常向量，$\\mathbf{B}$ 是代表应变和刚体旋转的常矩阵。为使单元格式通过斑块检验，其形函数必须能够精确表示任意线性多项式。此性质称为 1 阶 $C^0$ 完备性。\n\n问题提供了一个线性位移场：\n$$\nu_x(x,y) = 2 + 3 x - 1.5 y\n$$\n$$\nu_y(x,y) = -1 + 0.5 x + 4 y\n$$\n使用的单元是 T$3$ 单元，它使用线性形函数 $N_i$ 在单元内插值位移场，即 $\\boldsymbol{u}_h(x,y) = \\sum_{i=1}^{3} N_i(x,y) \\boldsymbol{u}_i$。由于形函数是线性多项式，它们的线性组合可以精确表示任意线性位移场。因此，T$3$ 单元是 1 阶完备的，并保证能通过斑块检验。\n\n边界条件是在边界节点（$1, 2, 3, 4$）处使用精确线性位移场的值来指定的。由于 T$3$ 单元格式通过了斑块检验，位移场的有限元解 $\\boldsymbol{u}_h(x,y)$ 必须与区域内各处的精确线性场 $\\boldsymbol{u}(x,y)$ 完全相同。\n\n这使得我们可以直接计算内部节点 $5$（坐标为 $(1,1)$）处的未知位移，而无需组装和求解全局有限元方程组。我们只需在该点计算精确位移场的值：\n$$\nu_{x,5} = u_x(1,1) = 2 + 3(1) - 1.5(1) = 2 + 3 - 1.5 = 3.5\n$$\n$$\nu_{y,5} = u_y(1,1) = -1 + 0.5(1) + 4(1) = -1 + 0.5 + 4 = 3.5\n$$\n因此，节点 $5$ 的位移为 $(3.5, 3.5)$。\n\n下一步是计算四个单元中每个单元的工程应变向量。由于插值位移场 $\\boldsymbol{u}_h$ 与精确线性场 $\\boldsymbol{u}$ 完全相同，因此从 $\\boldsymbol{u}_h$ 导出的应变场也必须与精确应变场完全相同。该应变场是常数，因为它是从线性位移场的一阶导数得出的。\n工程应变向量 $\\boldsymbol{\\varepsilon} = (\\varepsilon_{x}, \\varepsilon_{y}, \\gamma_{xy})^{\\top}$ 的分量计算如下：\n$$\n\\varepsilon_{x} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial}{\\partial x} (2 + 3 x - 1.5 y) = 3\n$$\n$$\n\\varepsilon_{y} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial y} (-1 + 0.5 x + 4 y) = 4\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial}{\\partial y} (2 + 3 x - 1.5 y) + \\frac{\\partial}{\\partial x} (-1 + 0.5 x + 4 y) = -1.5 + 0.5 = -1\n$$\n得到的这个应变状态在整个区域内是恒定的。对于 T$3$ 单元，单元内的应变本身就是常数。计算证实了在任何单元（例如，$E_1, E_2, E_3, E_4$）中计算出的应变都将是这个精确的常数值。这验证了该区域上的有限元格式再现了精确的常应变，从而通过了斑块检验。\n\n再现的常工程应变向量为：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 3 \\\\ 4 \\\\ -1 \\end{pmatrix}\n$$\n问题要求将此结果表示为单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 4 & -1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}