{
    "hands_on_practices": [
        {
            "introduction": "掌握变分原理的最佳方式是亲自动手计算。这个练习将作为我们应用变分原理的第一次尝试，我们将为一个简单且可解析求解的系统——一维谐振子——选择一个非标准的试探波函数（三角形函数），来估算其基态能量。这个练习旨在强调变分法的核心步骤：归一化波函数，计算哈密顿量的期望值，并对得到的能量表达式关于变分参数进行最小化。",
            "id": "2144210",
            "problem": "量子力学中的变分原理提供了一种强大的方法，可以在不精确求解薛定谔方程的情况下估算系统基态能量。该原理指出，对于任何归一化的试探波函数 $\\psi$，哈密顿量的期望值 $\\langle H \\rangle = \\int \\psi^* \\hat{H} \\psi \\, dx$ 总是大于或等于真实的基态能量 $E_0$。通过选择一个带有可调参数的试探波函数，并对这些参数最小化 $\\langle H \\rangle$，我们可以得到 $E_0$ 的一个上限估计。\n\n考虑一个质量为 $m$ 的粒子在一维简谐振子势场中运动，其势能为 $V(x) = \\frac{1}{2}m\\omega^2x^2$，其中 $\\omega$ 是角频率。\n\n我们提出了一个简单的实值三角试探波函数 $\\psi(x)$，定义如下：\n$$\n\\psi(x) =\n\\begin{cases}\nN(a - |x|)  \\text{若 } |x| \\le a \\\\\n0  \\text{若 } |x|  a\n\\end{cases}\n$$\n此处，$N$ 是归一化常数，$a  0$ 是一个变分参数，它表征了波函数的空间范围。\n\n你的任务是使用变分原理，利用这个三角试探波函数，找到简谐振子基态能量的最佳可能估计。将你的最终答案表示为包含 $\\hbar$、$m$ 和 $\\omega$ 的解析表达式。",
            "solution": "我们应用变分原理，使用实值的、偶函数的三角试探函数\n$$\n\\psi(x)=\n\\begin{cases}\nN(a-|x|),  |x|\\le a,\\\\\n0,  |x|a,\n\\end{cases}\n$$\n其中 $a0$ 是变分参数，$N$ 是归一化常数。\n\n归一化要求\n$$\n\\int_{-\\infty}^{\\infty}|\\psi(x)|^{2}\\,dx=1.\n$$\n由于 $\\psi$ 的支撑集在 $[-a,a]$ 上且为偶函数，\n$$\n1=2N^{2}\\int_{0}^{a}(a-x)^{2}\\,dx=2N^{2}\\left[\\frac{a^{3}}{3}\\right]=\\frac{2}{3}N^{2}a^{3},\n$$\n所以\n$$\nN^{2}=\\frac{3}{2a^{3}}.\n$$\n\n哈密顿量为 $\\hat{H}=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}+\\frac{1}{2}m\\omega^{2}x^{2}$。因为试探函数在 $x=0$ 处有一个尖点，并且只是分段可微的，所以合适的动能二次型是\n$$\nT[\\psi]=\\frac{\\hbar^{2}}{2m}\\int_{-\\infty}^{\\infty}|\\psi'(x)|^{2}\\,dx.\n$$\n对于 $x\\in(0,a)$，$\\psi(x)=N(a-x)$，所以 $\\psi'(x)=-N$；对于 $x\\in(-a,0)$，$\\psi(x)=N(a+x)$，所以 $\\psi'(x)=N$。因此，\n$$\n\\int_{-\\infty}^{\\infty}|\\psi'(x)|^{2}\\,dx=\\int_{-a}^{a}N^{2}\\,dx=2aN^{2}.\n$$\n于是\n$$\nT(a)=\\frac{\\hbar^{2}}{2m}\\cdot 2aN^{2}=\\frac{\\hbar^{2}}{2m}\\cdot 2a\\cdot\\frac{3}{2a^{3}}=\\frac{3\\hbar^{2}}{2ma^{2}}.\n$$\n\n势能期望值为\n$$\nV(a)=\\int_{-\\infty}^{\\infty}\\frac{1}{2}m\\omega^{2}x^{2}|\\psi(x)|^{2}\\,dx=\\frac{1}{2}m\\omega^{2}\\cdot 2N^{2}\\int_{0}^{a}x^{2}(a-x)^{2}\\,dx.\n$$\n计算\n$$\n\\int_{0}^{a}x^{2}(a-x)^{2}\\,dx=\\int_{0}^{a}\\left(a^{2}x^{2}-2ax^{3}+x^{4}\\right)\\,dx=\\left[\\frac{a^{2}x^{3}}{3}-\\frac{2ax^{4}}{4}+\\frac{x^{5}}{5}\\right]_{0}^{a}=\\frac{a^{5}}{30}.\n$$\n因此\n$$\nV(a)=m\\omega^{2}N^{2}\\cdot\\frac{a^{5}}{30}=m\\omega^{2}\\cdot\\frac{3}{2a^{3}}\\cdot\\frac{a^{5}}{30}=\\frac{m\\omega^{2}a^{2}}{20}.\n$$\n\n变分能量为\n$$\nE(a)=T(a)+V(a)=\\frac{3\\hbar^{2}}{2ma^{2}}+\\frac{m\\omega^{2}a^{2}}{20}.\n$$\n为了对 $a0$ 进行最小化，我们求导并令其为零：\n$$\n\\frac{dE}{da}=-\\frac{3\\hbar^{2}}{m}a^{-3}+\\frac{m\\omega^{2}}{10}a=0\n\\quad\\Longrightarrow\\quad\nm^{2}\\omega^{2}a^{4}=30\\hbar^{2}\n\\quad\\Longrightarrow\\quad\na^{2}=\\frac{\\sqrt{30}\\,\\hbar}{m\\omega}.\n$$\n计算最小能量（等价于对 $E(a)=A a^{-2}+B a^{2}$ 使用 $E_{\\min}=2\\sqrt{AB}$，其中 $A=\\frac{3\\hbar^{2}}{2m}$ 且 $B=\\frac{m\\omega^{2}}{20}$）得到\n$$\nE_{\\min}=2\\sqrt{\\frac{3\\hbar^{2}}{2m}\\cdot\\frac{m\\omega^{2}}{20}}=\\hbar\\omega\\sqrt{\\frac{3}{10}}.\n$$\n根据变分原理，这是真实基态能量的一个上限。",
            "answer": "$$\\boxed{\\hbar\\omega\\sqrt{\\frac{3}{10}}}$$"
        },
        {
            "introduction": "在掌握了单参数最小化的基础后，我们转向更普适且强大的里兹-里兹 (Rayleigh–Ritz) 方法。该方法允许我们使用一组基函数的线性组合来近似本征函数，从而将求解薛定谔方程问题转化为一个矩阵本征值问题。我们将重访谐振子问题，但这次会构建哈密顿量矩阵 $H$ 和交叠矩阵 $S$，并求解广义本征值问题，以获得基态和第一激发态的近似能量。这种做法直接揭示了几乎所有现代电子结构计算软件所使用的核心方法。",
            "id": "3501584",
            "problem": "考虑一维（$1$-维）量子谐振子，其哈密顿算符为 $H = -\\dfrac{1}{2}\\dfrac{d^{2}}{dx^{2}} + \\dfrac{1}{2}\\,\\omega^{2} x^{2}$，其中使用 $\\hbar = 1$ 和 $m = 1$ 来设定单位制，因此所有能量都是无量纲的。目标是在一个二维（$2$-维）试探子空间中使用 Rayleigh–Ritz 变分法来估计最低的两个本征能量，并验证极小极大原理的界。使用以下基本原理：不含时 Schrödinger 方程 $H \\psi = E \\psi$、厄米算符的 Rayleigh 商和 Rayleigh–Ritz 原理，以及高斯求积恒等式或解析高斯积分。不应假设任何最终答案的捷径公式；它们必须从定义中推导得出。\n \n给定定义在实轴 $(-\\infty, \\infty)$ 上的非正交试探函数 $\\phi_{0}(x) = e^{-a x^{2}}$ 和 $\\phi_{1}(x) = x\\,e^{-a x^{2}}$，其中 $a  0$。构建重叠矩阵 $S$（其矩阵元为 $S_{ij} = \\int_{-\\infty}^{\\infty} \\phi_{i}(x)\\phi_{j}(x)\\,dx$）和哈密顿矩阵 $H$（其矩阵元为 $H_{ij} = \\int_{-\\infty}^{\\infty} \\phi_{i}(x)\\, H\\, \\phi_{j}(x)\\,dx$）。求解广义厄米本征值问题 $H \\mathbf{c} = E\\, S \\mathbf{c}$，以分别获得基态和第一激发态能量的两个 Ritz 估计值 $E_{0}^{(\\text{sub})}$ 和 $E_{1}^{(\\text{sub})}$。使用经过充分检验的谐振子精确谱 $E_{n}^{(\\text{exact})} = \\left(n + \\dfrac{1}{2}\\right)\\,\\omega$（其中 $n \\in \\{0,1\\}$）来验证极小极大 (Courant–Fischer) 界 $E_{0}^{(\\text{sub})} \\ge E_{0}^{(\\text{exact})}$ 和 $E_{1}^{(\\text{sub})} \\ge E_{1}^{(\\text{exact})}$。\n \n您的程序必须：\n- 使用给定的 $\\phi_{0}$ 和 $\\phi_{1}$ 以及算符 $H$，从第一性原理出发构建矩阵 $H$ 和 $S$。您可以使用高斯积分恒等式精确计算积分，或使用可靠的求积法进行数值计算，前提是结果准确且可复现。\n- 求解广义本征问题，以获得按升序排序的两个子空间能量 $E_{0}^{(\\text{sub})}$ 和 $E_{1}^{(\\text{sub})}$。\n- 通过与 $E_{0}^{(\\text{exact})} = \\dfrac{1}{2}\\,\\omega$ 和 $E_{1}^{(\\text{exact})} = \\dfrac{3}{2}\\,\\omega$ 比较来验证极小极大界。\n- 将能量表示为无量纲数，因为已选择 $\\hbar = 1$ 和 $m = 1$。\n \n测试套件：\n使用以下参数集 $(\\omega, a)$：\n- 情况 1：$(\\omega, a) = (1, 0.3)$。\n- 情况 2：$(\\omega, a) = (1, 0.5)$。\n- 情况 3：$(\\omega, a) = (2.5, 1.7)$。\n- 情况 4：$(\\omega, a) = (1, 0.05)$。\n \n对于每种情况，计算两个 Ritz 能量和一个布尔值，该布尔值指示两个极小极大不等式是否都成立。最终输出必须是单行，形式为一个包含在方括号内的逗号分隔列表，其中按上述顺序列出每种情况的三个连续条目：四舍五入到 $8$ 位小数的基态 Ritz 能量 $E_{0}^{(\\text{sub})}$，四舍五入到 $8$ 位小数的第一激发态 Ritz 能量 $E_{1}^{(\\text{sub})}$，以及一个布尔值（如果两个极小极大不等式都成立，则为 $True$，否则为 $False$）。因此，总输出是一个包含 $12$ 个条目的扁平列表，对应 $4$ 种情况，顺序为 $[E_{0}^{(\\text{sub})}, E_{1}^{(\\text{sub})}, \\text{bounds\\_ok}, \\ldots]$。",
            "solution": "用户提供的问题经评估为有效。它在科学上基于量子力学原理，特别是应用于量子谐振子的变分法。该问题是适定的、客观的和自洽的，为得到唯一且有意义的解提供了所有必要的参数和定义。该任务与计算物理和材料科学中的标准课题一致。因此，我们可以着手提供一个完整的解决方案。\n\n该问题的核心是应用 Rayleigh-Ritz 变分法来估计一维量子谐振子的低能级能量本征值。在无量纲单位（$\\hbar=1$, $m=1$）下，哈密顿量为：\n$$\nH = -\\frac{1}{2}\\frac{d^2}{dx^2} + \\frac{1}{2}\\omega^2 x^2\n$$\n变分法旨在寻求不含时 Schrödinger 方程 $H \\psi = E \\psi$ 的近似解。我们使用一个试探波函数 $\\psi_t$，它是一组基函数 $\\{\\phi_i\\}$ 的线性组合。在本例中，试探子空间是二维的，由非正交函数 $\\phi_0(x) = e^{-ax^2}$ 和 $\\phi_1(x) = x e^{-ax^2}$（其中 $a0$）张成。试探波函数为：\n$$\n\\psi_t(x) = c_0 \\phi_0(x) + c_1 \\phi_1(x)\n$$\nRayleigh-Ritz 原理将 Schrödinger 方程转换为关于系数 $\\mathbf{c} = (c_0, c_1)^T$ 的广义本征值问题：\n$$\n\\mathbf{H} \\mathbf{c} = E \\mathbf{S} \\mathbf{c}\n$$\n此处，$\\mathbf{S}$ 是重叠矩阵，$\\mathbf{H}$ 是在基 $\\{\\phi_0, \\phi_1\\}$ 下的哈密顿矩阵。它们的矩阵元由以下积分定义：\n$$\nS_{ij} = \\int_{-\\infty}^{\\infty} \\phi_i^*(x) \\phi_j(x) \\,dx\n$$\n$$\nH_{ij} = \\int_{-\\infty}^{\\infty} \\phi_i^*(x) H \\phi_j(x) \\,dx\n$$\n由于基函数是实数，复共轭可以省略。该系统的本征值 $E$（记为 $E_k^{(\\text{sub})}$）是真实能量本征值 $E_k^{(\\text{exact})}$ 的 Rayleigh-Ritz 估计。Courant-Fischer 极小极大原理保证这些估计值是真实本征值的上界：对于 $k=0, 1$，有 $E_k^{(\\text{sub})} \\ge E_k^{(\\text{exact})}$。\n\n我们的首要任务是计算矩阵元 $S_{ij}$ 和 $H_{ij}$。这需要计算几个高斯积分。我们将使用以下标准定积分（对于 $b0$）：\n$$\n\\int_{-\\infty}^{\\infty} e^{-bx^2} \\,dx = \\sqrt{\\frac{\\pi}{b}}\n$$\n$$\n\\int_{-\\infty}^{\\infty} x^{2n} e^{-bx^2} \\,dx = \\frac{(2n-1)!!}{2^n b^n} \\sqrt{\\frac{\\pi}{b}} \\quad (n \\ge 1)\n$$\n$$\n\\int_{-\\infty}^{\\infty} x^{2n+1} e^{-bx^2} \\,dx = 0\n$$\n\n**1. 重叠矩阵 S 的计算**\n\n基函数为 $\\phi_0(x) = e^{-ax^2}$（偶宇称）和 $\\phi_1(x) = x e^{-ax^2}$（奇宇称）。\n$$\nS_{00} = \\int_{-\\infty}^{\\infty} (e^{-ax^2})(e^{-ax^2}) \\,dx = \\int_{-\\infty}^{\\infty} e^{-2ax^2} \\,dx = \\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nS_{11} = \\int_{-\\infty}^{\\infty} (x e^{-ax^2})(x e^{-ax^2}) \\,dx = \\int_{-\\infty}^{\\infty} x^2 e^{-2ax^2} \\,dx\n$$\n使用 $n=1$ 和 $b=2a$ 的公式，我们得到：\n$$\nS_{11} = \\frac{1}{2(2a)} \\sqrt{\\frac{\\pi}{2a}} = \\frac{1}{4a} \\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nS_{01} = S_{10} = \\int_{-\\infty}^{\\infty} (e^{-ax^2})(x e^{-ax^2}) \\,dx = \\int_{-\\infty}^{\\infty} x e^{-2ax^2} \\,dx = 0\n$$\n非对角元为零，因为被积函数是一个奇函数（一个偶函数和一个奇函数的乘积）。因此，重叠矩阵是对角的：\n$$\n\\mathbf{S} = \\begin{pmatrix} \\sqrt{\\frac{\\pi}{2a}}  0 \\\\ 0  \\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}} \\end{pmatrix}\n$$\n\n**2. 哈密顿矩阵 H 的计算**\n\n首先，我们将哈密顿算符 $H$ 应用于每个基函数。\n对于 $\\phi_0(x)$:\n$$\n\\frac{d}{dx} \\phi_0 = -2ax e^{-ax^2} \\implies \\frac{d^2}{dx^2} \\phi_0 = (-2a + 4a^2x^2) e^{-ax^2}\n$$\n$$\nH \\phi_0(x) = \\left[-\\frac{1}{2}(-2a + 4a^2x^2) + \\frac{1}{2}\\omega^2x^2\\right] e^{-ax^2} = \\left[a + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^2\\right] e^{-ax^2}\n$$\n对于 $\\phi_1(x)$:\n$$\n\\frac{d}{dx} \\phi_1 = (1 - 2ax^2) e^{-ax^2} \\implies \\frac{d^2}{dx^2} \\phi_1 = (-6ax + 4a^2x^3) e^{-ax^2}\n$$\n$$\nH \\phi_1(x) = \\left[-\\frac{1}{2}(-6ax + 4a^2x^3) + \\frac{1}{2}\\omega^2x^3\\right] e^{-ax^2} = \\left[3ax + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^3\\right] e^{-ax^2}\n$$\n现在我们可以计算矩阵元 $H_{ij}$：\n$$\nH_{00} = \\int_{-\\infty}^{\\infty} \\phi_0(x) H \\phi_0(x) \\,dx = \\int_{-\\infty}^{\\infty} e^{-ax^2} \\left[a + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^2\\right] e^{-ax^2} \\,dx\n$$\n$$\nH_{00} = a \\int_{-\\infty}^{\\infty} e^{-2ax^2} \\,dx + \\left(\\frac{\\omega^2}{2} - 2a^2\\right) \\int_{-\\infty}^{\\infty} x^2 e^{-2ax^2} \\,dx\n$$\n$$\nH_{00} = a \\sqrt{\\frac{\\pi}{2a}} + \\left(\\frac{\\omega^2}{2} - 2a^2\\right) \\left(\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}\\right) = \\sqrt{\\frac{\\pi}{2a}} \\left(a + \\frac{\\omega^2}{8a} - \\frac{a}{2}\\right) = \\left(\\frac{a}{2} + \\frac{\\omega^2}{8a}\\right)\\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nH_{11} = \\int_{-\\infty}^{\\infty} \\phi_1(x) H \\phi_1(x) \\,dx = \\int_{-\\infty}^{\\infty} x e^{-ax^2} \\left[3ax + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^3\\right] e^{-ax^2} \\,dx\n$$\n$$\nH_{11} = 3a \\int_{-\\infty}^{\\infty} x^2 e^{-2ax^2} \\,dx + \\left(\\frac{\\omega^2}{2} - 2a^2\\right) \\int_{-\\infty}^{\\infty} x^4 e^{-2ax^2} \\,dx\n$$\n使用 $b=2a$, $n=1$ 和 $n=2$ 的积分公式：\n$$\n\\int x^2e^{-2ax^2}dx = \\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}} \\quad , \\quad \\int x^4e^{-2ax^2}dx = \\frac{3}{16a^2}\\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nH_{11} = 3a\\left(\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}\\right) + \\left(\\frac{\\omega^2}{2} - 2a^2\\right)\\left(\\frac{3}{16a^2}\\sqrt{\\frac{\\pi}{2a}}\\right) = \\sqrt{\\frac{\\pi}{2a}}\\left(\\frac{3}{4} + \\frac{3\\omega^2}{32a^2} - \\frac{6a^2}{16a^2}\\right)\n$$\n$$\nH_{11} = \\sqrt{\\frac{\\pi}{2a}}\\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right)\n$$\n由于宇称性，非对角元 $H_{01}$ 和 $H_{10}$ 为零，因为被积函数 $\\phi_0 H \\phi_1$ 和 $\\phi_1 H \\phi_0$ 是奇函数。\n哈密顿矩阵也是对角的：\n$$\n\\mathbf{H} = \\begin{pmatrix} \\left(\\frac{a}{2} + \\frac{\\omega^2}{8a}\\right)\\sqrt{\\frac{\\pi}{2a}}  0 \\\\ 0  \\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right)\\sqrt{\\frac{\\pi}{2a}} \\end{pmatrix}\n$$\n\n**3. 求解广义本征值问题**\n\n由于 $\\mathbf{H}$ 和 $\\mathbf{S}$ 都是对角矩阵，广义本征值问题解耦为两个独立的方程。本征值 $E$ 就是相应对角元之比：\n$$\nE_0^{(\\text{sub})} = \\frac{H_{00}}{S_{00}} = \\frac{\\left(\\frac{a}{2} + \\frac{\\omega^2}{8a}\\right)\\sqrt{\\frac{\\pi}{2a}}}{\\sqrt{\\frac{\\pi}{2a}}} = \\frac{a}{2} + \\frac{\\omega^2}{8a}\n$$\n$$\nE_1^{(\\text{sub})} = \\frac{H_{11}}{S_{11}} = \\frac{\\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right)\\sqrt{\\frac{\\pi}{2a}}}{\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}} = 4a\\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right) = \\frac{3a}{2} + \\frac{3\\omega^2}{8a}\n$$\n偶宇称基函数 $\\phi_0$ 近似偶宇称的基态，因此其关联能量 $E_0^{(\\text{sub})}$ 是基态能量的估计值。奇宇称基函数 $\\phi_1$ 近似奇宇称的第一激发态，因此 $E_1^{(\\text{sub})}$ 是其能量的估计值。如前所示，$E_1^{(\\text{sub})}-E_0^{(\\text{sub})} = a + \\frac{\\omega^2}{4a}  0$，所以本征值是自然有序的。\n\n**4. 验证极小极大原理**\n\n量子谐振子的精确能谱是 $E_n^{(\\text{exact})} = (n + 1/2)\\omega$。因此，对于最低的两个态：\n$$\nE_0^{(\\text{exact})} = \\frac{1}{2}\\omega \\quad , \\quad E_1^{(\\text{exact})} = \\frac{3}{2}\\omega\n$$\n极小极大原理要求 $E_0^{(\\text{sub})} \\ge E_0^{(\\text{exact})}$ 和 $E_1^{(\\text{sub})} \\ge E_1^{(\\text{exact})}$。\n让我们将 $E_0^{(\\text{sub})}$ 作为 $a$ 的函数进行分析。最小值在导数为零处找到：\n$$\n\\frac{dE_0^{(\\text{sub})}}{da} = \\frac{1}{2} - \\frac{\\omega^2}{8a^2} = 0 \\implies 4a^2 = \\omega^2 \\implies a = \\frac{\\omega}{2}\n$$\n在这个最优的 $a$ 值处，子空间能量达到最小：\n$$\nE_0^{(\\text{sub})}\\left(a=\\frac{\\omega}{2}\\right) = \\frac{1}{2}\\left(\\frac{\\omega}{2}\\right) + \\frac{\\omega^2}{8\\left(\\frac{\\omega}{2}\\right)} = \\frac{\\omega}{4} + \\frac{\\omega}{4} = \\frac{\\omega}{2} = E_0^{(\\text{exact})}\n$$\n对于任何其他 $a0$，能量都会更大。这证实了 $E_0^{(\\text{sub})} \\ge E_0^{(\\text{exact})}$ 总是成立。当试探函数与精确本征函数匹配时（这发生在 $a=\\omega/2$），该不等式取等号。\n\n类似地，对于 $E_1^{(\\text{sub})}$：\n$$\n\\frac{dE_1^{(\\text{sub})}}{da} = \\frac{3}{2} - \\frac{3\\omega^2}{8a^2} = 0 \\implies 4a^2 = \\omega^2 \\implies a = \\frac{\\omega}{2}\n$$\n最小值也在 $a=\\omega/2$ 处：\n$$\nE_1^{(\\text{sub})}\\left(a=\\frac{\\omega}{2}\\right) = \\frac{3}{2}\\left(\\frac{\\omega}{2}\\right) + \\frac{3\\omega^2}{8\\left(\\frac{\\omega}{2}\\right)} = \\frac{3\\omega}{4} + \\frac{3\\omega}{4} = \\frac{3\\omega}{2} = E_1^{(\\text{exact})}\n$$\n这证实了 $E_1^{(\\text{sub})} \\ge E_1^{(\\text{exact})}$ 也总是成立。\n因此，对于任何给定的参数 $(\\omega, a)$（其中 $\\omega  0$ 和 $a  0$），两个极小极大不等式都将成立。对界的布尔检查必须总是得出 `True`。\n\n**算法实现**\n\n程序将遍历每个测试用例 $(\\omega, a)$。对于每个用例，它将：\n1. 构建矩阵 $\\mathbf{H}$ 和 $\\mathbf{S}$。为避免因数值过小或过大而引起的潜在数值问题，我们可以约去公因子 $\\sqrt{\\pi/(2a)}$ 并使用缩放后的矩阵。令 $\\mathbf{H}' = \\mathbf{H}/\\sqrt{\\pi/(2a)}$ 和 $\\mathbf{S}' = \\mathbf{S}/\\sqrt{\\pi/(2a)}$。广义本征问题 $\\mathbf{H}'\\mathbf{c} = E\\mathbf{S}'\\mathbf{c}$ 会产生相同的本征值。\n2. 使用标准数值库例程（例如 `scipy.linalg.eigh`）求解 $2 \\times 2$ 广义本征值问题。\n3. 排序后的本征值为 $E_0^{(\\text{sub})}$ 和 $E_1^{(\\text{sub})}$。\n4. 计算精确能量 $E_0^{(\\text{exact})} = 0.5\\omega$ 和 $E_1^{(\\text{exact})} = 1.5\\omega$。\n5. 验证不等式并设置一个布尔标志。根据我们的证明，该值将始终为 `True`。\n6. 收集结果并按规定格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the Rayleigh-Ritz problem for the 1D quantum harmonic oscillator.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.3),  # Case 1: (omega, a)\n        (1.0, 0.5),  # Case 2\n        (2.5, 1.7),  # Case 3\n        (1.0, 0.05), # Case 4\n    ]\n\n    results = []\n    for omega, a in test_cases:\n        # Assemble the scaled overlap and Hamiltonian matrices.\n        # The common factor sqrt(pi/(2a)) is canceled from all elements.\n        \n        # S_prime matrix\n        S_prime = np.zeros((2, 2))\n        S_prime[0, 0] = 1.0\n        S_prime[1, 1] = 1.0 / (4.0 * a)\n\n        # H_prime matrix\n        H_prime = np.zeros((2, 2))\n        H_prime[0, 0] = a / 2.0 + omega**2 / (8.0 * a)\n        H_prime[1, 1] = 3.0 / 8.0 + 3.0 * omega**2 / (32.0 * a**2)\n\n        # Solve the generalized eigenvalue problem H' c = E S' c.\n        # eigh returns eigenvalues in ascending order, which is what we need.\n        # For diagonal matrices, this is equivalent to H'_ii / S'_ii.\n        # But using eigh demonstrates the general numerical method.\n        eigenvalues = eigh(H_prime, S_prime, eigvals_only=True)\n        \n        e0_sub = eigenvalues[0]\n        e1_sub = eigenvalues[1]\n\n        # Calculate exact energies\n        e0_exact = 0.5 * omega\n        e1_exact = 1.5 * omega\n\n        # Verify the min-max principle bounds\n        # Using a small tolerance for floating point comparisons, though direct\n        # comparison works here since the variational principle guarantees =.\n        tolerance = 1e-12\n        bounds_ok = (e0_sub = e0_exact - tolerance) and \\\n                    (e1_sub = e1_exact - tolerance)\n\n        # Append results for this case.\n        # round() is used as per the output specification.\n        results.extend([\n            round(e0_sub, 8),\n            round(e1_sub, 8),\n            bounds_ok\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现在，我们将把里兹-里兹方法的矩阵形式应用于一个计算材料科学的核心问题：计算晶体的电子能带结构。通过使用平面波基组，我们将为周期性势场中的电子构建哈密顿量矩阵。这个练习展示了变分原理如何通过动能截断 ($E_{\\text{cut}}$) 的概念，为精确的能带能量提供一个系统性可改进的近似，并强调了在实际计算中分析收敛性的重要性。",
            "id": "3501585",
            "problem": "考虑一个无自旋电子在一维空间中运动，其受到周期为 $a$ 的周期性余弦势的影响。计算在原子单位下进行，其中约化普朗克常数 $\\hbar$、电子质量 $m_{\\mathrm{e}}$ 和基本电荷 $e$ 均设为1。哈密顿算符由周期性势下的不含时薛定谔方程给出。余弦势为 $V(x) = V_{0} \\cos(G_{0} x)$，其中 $G_{0} = 2\\pi/a$，晶体动量 $k$ 位于第一布里渊区内。在由倒格矢 $G = n G_{0}$（其中 $n$ 为整数）标记的平面波基组中，并受动能截断 $E_{\\text{cut}}$（哈特里）的限制，通过仅包含那些自由电子动能不超过 $E_{\\text{cut}}$ 的基函数，构建固定 $k$ 值下的有限维厄米哈密顿矩阵。对于一组给定的递增截断值 $E_{\\text{cut}}$，通过对截断后的哈密顿量进行对角化来计算能带能量，并随着基组的扩大，分析最低两个能带的变分收敛性和瑞利单调性。\n\n您的程序必须：\n- 全程使用原子单位。能量必须以哈特里（Hartree）表示，长度以玻尔（Bohr）表示。除了在倒易空间中定义 $k$ 和 $G$ 外，不需要其他角度单位。\n- 对每个指定的测试用例，通过包含所有满足平面波在波矢 $k + n G_{0}$ 处的自由电子动能（即 $(1/2)\\lvert k + n G_{0} \\rvert^{2}$）小于或等于 $E_{\\text{cut}}$ 的整数 $n$，来为所提供的有序列表中的每个 $E_{\\text{cut}}$ 构建嵌套的平面波子空间。\n- 对每个截断后的哈密顿量，计算其本征值（能带能量）并按升序排序。\n- 对于最低的两个能带（能带指数为 0 和 1），通过检查随着 $E_{\\text{cut}}$ 的增加，能带能量序列是否单调非增，来验证在整个截断序列上的瑞利单调性。\n- 对于相同的能带，通过检查序列中最后两个能量的绝对差是否小于给定的容差，来评估变分收敛性。\n- 为每个测试用例返回一个包含六个项目的列表：一个布尔值表示能带 0 的单调性，一个布尔值表示能带 1 的单调性，一个布尔值表示能带 0 的收敛性，一个布尔值表示能带 1 的收敛性，最大截断下能带 0 的最终能量（哈特里），以及最大截断下能带 1 的最终能量（哈特里）。\n\n构建解决方案所用的基本原理必须限于周期性势的定态薛定谔方程、布洛赫定理、周期函数的平面波展开以及厄米算符的瑞利-里兹变分原理。不允许在解决方案中使用未从这些基础推导出的简化公式。\n\n测试套件：\n- 用例 1（布里渊区中心）：$a = 3.0$ 玻尔，$V_{0} = 0.6$ 哈特里，$k = 0.0$，$E_{\\text{cut}}$ 列表 $[2.5, 6.0, 18.0, 40.0, 80.0, 200.0]$，收敛容差 $1.0\\times 10^{-4}$ 哈特里。\n- 用例 2（布里渊区边界）：$a = 3.0$ 玻尔，$V_{0} = 0.6$ 哈特里，$k = G_{0}/2$，$E_{\\text{cut}}$ 列表 $[2.5, 6.0, 18.0, 40.0, 80.0, 200.0]$，收敛容差 $1.0\\times 10^{-4}$ 哈特里。\n- 用例 3（弱势，偏离中心的 $k$ 值）：$a = 2.5$ 玻尔，$V_{0} = 0.05$ 哈特里，$k = 0.3\\, G_{0}$，$E_{\\text{cut}}$ 列表 $[1.6, 4.0, 12.0, 30.0, 60.0, 200.0]$，收敛容差 $1.0\\times 10^{-4}$ 哈特里。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例对应一个子列表，其顺序与测试套件中的顺序相同，并且每个子列表包含上述指定的六个项目。例如，输出格式必须为 $[[b_{00}, b_{01}, b_{10}, b_{11}, e_{0}, e_{1}],[\\dots],[\\dots]]$ 的形式，其中 $b_{ij}$ 是布尔值，$e_{m}$ 是以哈特里为单位的浮点数。",
            "solution": "所提出的问题是有效的，因为它在科学上基于量子力学和固态物理学的原理，在数学上是适定的，并且为获得唯一解提供了所有必要的参数。因此，我们可以进行完整且合理的求解。\n\n该问题要求我们计算一维晶体的电子能带结构，并分析平面波变分法的收敛特性。给定一个无自旋电子在周期势 $V(x) = V_{0} \\cos(G_{0} x)$ 中运动，其中 $G_{0} = 2\\pi/a$ 是基本倒格矢，$a$ 是晶格周期。所有计算均在原子单位下进行，其中 $\\hbar = m_{\\mathrm{e}} = 1$。\n\n其控制方程为不含时薛定谔方程：\n$$\n\\hat{H} \\psi(x) = E \\psi(x)\n$$\n其中哈密顿算符由 $\\hat{H} = \\hat{T} + \\hat{V}$ 给出，动能算符为 $\\hat{T} = -\\frac{1}{2}\\frac{d^2}{dx^2}$，势能算符为 $\\hat{V} = V(x)$。\n\n根据布洛赫定理，对于周期势 $V(x) = V(x+a)$，哈密顿算符的本征函数可以写成布洛赫波的形式：\n$$\n\\psi_k(x) = e^{ikx} u_k(x)\n$$\n此处，$k$ 是晶体动量，是一个守恒量，其取值范围被限制在第一布里渊区，$k \\in [-\\pi/a, \\pi/a] = [-G_{0}/2, G_{0}/2]$。函数 $u_k(x)$ 与晶格具有相同的周期性，$u_k(x) = u_k(x+a)$。\n\n因为 $u_k(x)$ 是周期函数，所以可以将其展开为关于倒格矢 $G = n G_{0}$（其中 $n$ 为整数）的傅里叶级数：\n$$\nu_k(x) = \\sum_{G} c_{k,G} e^{iGx}\n$$\n将此代入布洛赫波形式，我们得到完整波函数 $\\psi_k(x)$ 在平面波基组 $\\{e^{i(k+G)x}\\}$ 下的展开式：\n$$\n\\psi_k(x) = \\sum_{G} c_{k,G} e^{i(k+G)x}\n$$\n系数 $c_{k,G}$ 和相应的能量本征值 $E_k$ 通过在此平面波基组中求解薛定谔方程得到。将 $\\psi_k(x)$ 的展开式代入薛定谔方程，可得：\n$$\n\\sum_{G} c_{k,G} \\left( -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x) \\right) e^{i(k+G)x} = E_k \\sum_{G} c_{k,G} e^{i(k+G)x}\n$$\n动能算符作用于平面波的结果很简单：\n$$\n-\\frac{1}{2}\\frac{d^2}{dx^2} e^{i(k+G)x} = \\frac{1}{2}(k+G)^2 e^{i(k+G)x}\n$$\n为了形成矩阵本征值方程，我们投影到特定的基函数 $\\langle e^{i(k+G')x} |$ 上，这涉及到乘以 $e^{-i(k+G')x}$ 并在整个空间上积分。这给出了哈密顿量的矩阵元 $H_{G',G}$：\n$$\nH_{G',G} = \\frac{1}{\\mathcal{L}} \\int_0^{\\mathcal{L}} e^{-i(k+G')x} \\hat{H} e^{i(k+G)x} dx\n$$\n其中积分是在晶体长度 $\\mathcal{L}$ 上进行的。\n\n动能项在此基组中是对角的：\n$$\n\\langle e^{i(k+G')x} | \\hat{T} | e^{i(k+G)x} \\rangle = \\frac{1}{2}(k+G)^2 \\delta_{G',G}\n$$\n势能项耦合了不同的平面波：\n$$\n\\langle e^{i(k+G')x} | \\hat{V} | e^{i(k+G)x} \\rangle = \\frac{1}{\\mathcal{L}} \\int_0^{\\mathcal{L}} V(x) e^{-i(G'-G)x} dx = V_{G'-G}\n$$\n其中 $V_{G'-G}$ 是势 $V(x)$ 对应于倒格矢 $G'-G$ 的傅里叶系数。给定的势为 $V(x) = V_{0}\\cos(G_{0}x) = \\frac{V_{0}}{2}(e^{iG_{0}x} + e^{-iG_{0}x})$。唯一不为零的傅里叶系数是 $V_{G_0} = V_0/2$ 和 $V_{-G_0} = V_0/2$。\n\n因此，势能项 $V_{G'-G}$ 仅在 $G'-G = \\pm G_{0}$ 时非零。当 $G = nG_0$ 和 $G' = mG_0$ 时，这意味着 $m-n = \\pm 1$。哈密顿矩阵的矩阵元 $H_{m,n}$（由整数 $m$ 和 $n$ 索引）为：\n$$\nH_{m,n} = \\frac{1}{2}(k+nG_{0})^2 \\delta_{m,n} + \\frac{V_{0}}{2}(\\delta_{m,n+1} + \\delta_{m,n-1})\n$$\n原则上，基组是无限的。为了进行数值求解，我们必须将其截断。问题指定了动能截断 $E_{\\text{cut}}$。基组是通过包含所有满足自由电子动能低于此截断的整数 $n$ 来构建的：\n$$\n\\frac{1}{2}(k+nG_0)^2 \\le E_{\\text{cut}}\n$$\n这定义了一个有限的整数集合 $\\{n\\}$，进而定义了一个有限维的哈密顿矩阵。由于动能是 $n$ 的二次函数，所包含的整数形成一个连续的区间，$n \\in [n_{\\text{min}}, n_{\\text{max}}]$。如果我们对这些整数进行排序，得到的哈密顿矩阵是三对角的。\n\n瑞利-里兹变分原理指出，从哈密顿量在子空间中的有限维矩阵表示得到的本征值是真实本征值的上界。此外，最小-最大定理保证，如果我们有两个基组 $S_1$ 和 $S_2$ 使得 $S_1 \\subset S_2$，则排序后的本征值对于所有能带指数 $i$ 都满足 $E_i^{(2)} \\le E_i^{(1)}$。问题指定了一个递增的 $E_{\\text{cut}}$ 值序列，这会生成一个嵌套基组序列。因此，对于任何给定的能带，计算出的能量必须是 $E_{\\text{cut}}$ 的单调非增函数。这就是必须验证的瑞利单调性。\n\n随着 $E_{\\text{cut}}$ 的增加，基组变得更加完备，计算出的本征值会收敛到精确值。收敛性通过检查使用序列中两个最大截断值计算出的给定能带的能量绝对差是否低于指定的容差 $\\epsilon$ 来评估。设能带 $i$ 的能量序列为 $E_i(E_{\\text{cut, 1}}), \\dots, E_i(E_{\\text{cut, M}})$。我们检查是否有 $|E_i(E_{\\text{cut, M}}) - E_i(E_{\\text{cut, M-1}})|  \\epsilon$。\n\n算法如下：\n1. 对每个测试用例，定义参数 $a, V_0, k$、$E_{\\text{cut}}$ 值列表以及容差 $\\epsilon$。计算 $G_0 = 2\\pi/a$。\n2. 对列表中的每个 $E_{\\text{cut}}$：\n    a. 确定满足 $\\frac{1}{2}(k+nG_0)^2 \\le E_{\\text{cut}}$ 的整数范围 $[n_{\\text{min}}, n_{\\text{max}}]$。\n    b. 构建大小为 $N \\times N$ 的三对角哈密顿矩阵 $H$，其中 $N = n_{\\text{max}} - n_{\\text{min}} + 1$。对角元素为 $H_{i,i} = \\frac{1}{2}(k + (n_{\\text{min}}+i)G_0)^2$，次对角线元素为 $H_{i, i\\pm 1} = V_0/2$。\n    c. 对角化这个厄米矩阵以找到其本征值（能带能量）。由于它是三对角的，可以使用专门且高效的本征值求解器。\n    d. 将最低的两个本征值（对应能带 0 和能带 1）存储在不同的列表中，以对应它们随 $E_{\\text{cut}}$ 增加的演变过程。\n3. 遍历所有 $E_{\\text{cut}}$ 值后：\n    a. 通过检查各自的能量序列是否非增，来验证能带 0 和能带 1 的瑞利单调性。\n    b. 通过将每个序列中的最后两个能量与容差 $\\epsilon$ 进行比较，来验证能带 0 和能带 1 的收敛性。\n    c. 提取两个能带的最终能量，即使用最大 $E_{\\text{cut}}$ 计算出的能量。\n4. 为每个测试用例整理六个结果（四个布尔值和两个最终能量），并按规定格式化输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"a\": 3.0, \"V0\": 0.6, \"k_factor\": 0.0,\n            \"E_cut_list\": [2.5, 6.0, 18.0, 40.0, 80.0, 200.0],\n            \"tol\": 1.0e-4\n        },\n        {\n            \"a\": 3.0, \"V0\": 0.6, \"k_factor\": 0.5,\n            \"E_cut_list\": [2.5, 6.0, 18.0, 40.0, 80.0, 200.0],\n            \"tol\": 1.0e-4\n        },\n        {\n            \"a\": 2.5, \"V0\": 0.05, \"k_factor\": 0.3,\n            \"E_cut_list\": [1.6, 4.0, 12.0, 30.0, 60.0, 200.0],\n            \"tol\": 1.0e-4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_bands(\n            case[\"a\"], case[\"V0\"], case[\"k_factor\"],\n            case[\"E_cut_list\"], case[\"tol\"]\n        )\n        results.append(result)\n\n    # Format the output string as per the problem specification\n    # e.g., [[True,True,True,True,0.23,0.85],[...],[...]]\n    outer_parts = []\n    for res in results:\n        inner_parts = []\n        for item in res:\n            if isinstance(item, bool):\n                inner_parts.append(str(item))\n            else:\n                inner_parts.append(f\"{item}\")\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    final_string = f\"[{','.join(outer_parts)}]\"\n    print(final_string)\n\ndef calculate_bands(a, V0, k_factor, E_cut_list, tol):\n    \"\"\"\n    Calculates band energies and checks for convergence and monotonicity.\n\n    Args:\n        a (float): Lattice constant in Bohr.\n        V0 (float): Potential amplitude in Hartree.\n        k_factor (float): Crystal momentum as a factor of G0.\n        E_cut_list (list of float): List of kinetic energy cutoffs in Hartree.\n        tol (float): Convergence tolerance in Hartree.\n\n    Returns:\n        list: A list containing six items: monotonicity bools for bands 0 and 1,\n              convergence bools for bands 0 and 1, and final energies for bands 0 and 1.\n    \"\"\"\n    # Define constants in atomic units\n    G0 = 2.0 * np.pi / a\n    k = k_factor * G0\n    \n    band_energies = {0: [], 1: []}\n\n    for E_cut in E_cut_list:\n        # Determine the range of integers n for the plane-wave basis\n        # (1/2) * (k + n*G0)^2 = E_cut  => |k + n*G0| = sqrt(2*E_cut)\n        # -sqrt(2*E_cut) = k + n*G0 = sqrt(2*E_cut)\n        # (-k - sqrt(2*E_cut))/G0 = n = (-k + sqrt(2*E_cut))/G0\n        sqrt_2E_cut = np.sqrt(2.0 * E_cut)\n        n_min_float = (-k - sqrt_2E_cut) / G0\n        n_max_float = (-k + sqrt_2E_cut) / G0\n        \n        n_min = int(np.ceil(n_min_float))\n        n_max = int(np.floor(n_max_float))\n        \n        n_list = np.arange(n_min, n_max + 1)\n        N = len(n_list)\n\n        # Construct the tridiagonal Hamiltonian matrix\n        # Diagonal elements: kinetic energy\n        diag_elements = 0.5 * (k + n_list * G0)**2\n        \n        # Off-diagonal elements: potential coupling\n        off_diag_elements = np.full(N - 1, V0 / 2.0)\n\n        # Diagonalize the Hamiltonian to find eigenvalues (band energies)\n        # Using eigh_tridiagonal is efficient for this matrix structure.\n        # It returns eigenvalues sorted in ascending order.\n        if N > 0:\n            eigvals = eigh_tridiagonal(diag_elements, off_diag_elements, eigvals_only=True)\n        else: # Handle cases where E_cut is too small to include any basis functions\n            eigvals = []\n\n        if len(eigvals) >= 2:\n            band_energies[0].append(eigvals[0])\n            band_energies[1].append(eigvals[1])\n        elif len(eigvals) == 1: # If only one basis function, only one band\n            band_energies[0].append(eigvals[0])\n\n    # Analyze variational convergence and Rayleigh monotonicity\n    # Ensure there are enough data points to perform checks\n    if len(band_energies[0])  2 or len(band_energies[1])  2:\n        return [False, False, False, False, np.nan, np.nan] # Not enough data to check\n\n    # 1. Rayleigh Monotonicity check\n    # Energies must be non-increasing as the basis set expands.\n    seq_b0 = band_energies[0]\n    is_monotonic_b0 = all(seq_b0[i] >= seq_b0[i+1] - 1e-12 for i in range(len(seq_b0) - 1))\n    \n    seq_b1 = band_energies[1]\n    is_monotonic_b1 = all(seq_b1[i] >= seq_b1[i+1] - 1e-12 for i in range(len(seq_b1) - 1))\n    # A small tolerance 1e-12 is added to handle potential floating-point inaccuracies\n    # where theoretically equal values might differ by machine epsilon.\n\n    # 2. Variational Convergence check\n    # Absolute difference between last two energies must be below tolerance.\n    is_converged_b0 = abs(seq_b0[-1] - seq_b0[-2])  tol\n    is_converged_b1 = abs(seq_b1[-1] - seq_b1[-2])  tol\n\n    # 3. Final energies\n    final_energy_b0 = seq_b0[-1]\n    final_energy_b1 = seq_b1[-1]\n    \n    return [\n        is_monotonic_b0, is_monotonic_b1,\n        is_converged_b0, is_converged_b1,\n        final_energy_b0, final_energy_b1\n    ]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}