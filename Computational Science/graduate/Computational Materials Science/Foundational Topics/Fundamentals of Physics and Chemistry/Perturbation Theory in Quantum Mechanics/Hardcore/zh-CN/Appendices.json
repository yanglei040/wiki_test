{
    "hands_on_practices": [
        {
            "introduction": "接下来，我们转向更为复杂的简并微扰理论。当一个微扰作用于具有简并能级的系统时，标准的非简并理论会失效，我们必须在简并子空间内对微扰哈密顿量进行对角化。这个问题  提供了一个清晰且具有物理背景的近简并微扰理场景，用于模拟应变硅中的能谷劈裂。它关键地展示了一种因对称性而导致一阶效应被禁止，而能级劈裂效应直到二阶才通过与远程态的虚跃迁而出现的情形。这项实践对于理解材料物理学中许多精细效应的起源至关重要。",
            "id": "3474558",
            "problem": "考虑一个与计算材料科学相关的，用于描述应变硅导带流形中能谷分裂的最小、对称性一致的近简并微扰理论模型。其物理基础是定态 Schrödinger 方程和标准微扰理论。设未受微扰的哈密顿量为 $H_0$，其在能量 $E_0$ 处有一个由 $\\{ \\lvert 1 \\rangle, \\lvert 2 \\rangle \\}$ 张成的二维简并子空间，并在能量 $E_r$ 处有一个单一的远程态 $\\lvert r \\rangle$，其中 $E_r > E_0$。微扰在单轴应变大小 $\\lambda$ 上是线性的，由 $V(\\lambda) = \\lambda W$ 给出，其中 $W$ 是一个应变诱导的算符。假设由于对称性，一阶子空间内矩阵元消失，即 $W_{11} = W_{22} = W_{12} = W_{21} = 0$，并且唯一的非零耦合发生在能谷子空间和远程态之间，其值为 $W_{1r} = g$ 和 $W_{2r} = -g$，其中 $g$ 是一个实的形变势振幅。这捕捉了物理上相关的情景：对称性禁止了能谷子空间中的一阶分裂，而主要的分裂通过经由 $\\lvert r \\rangle$ 的虚跃迁在二阶出现。\n\n使用简并微扰理论，定义投影算符 $P$ 投射到能谷子空间，以及 $Q = I - P$。在能谷子空间中，关于 $\\lambda$ 的高达二阶的有效哈密顿量为\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = E_0 I + \\lambda P W P + \\lambda^2 P W Q \\left( E_0 I - Q H_0 Q \\right)^{-1} Q W P,\n$$\n其中 $I$ 是适当空间上的单位算符。在此模型中，$P W P = 0$，且由于 $W_{ir}$ ($i \\in \\{1,2\\}$)，二阶项不为零。\n\n您的任务是：\n- 推导能谷分裂 $\\Delta E(\\lambda)$，其定义为能谷子空间中 $H_{\\mathrm{eff}}^{(2)}(\\lambda)$ 两个本征值之差，保留至 $\\lambda$ 的二阶项。\n- 将此微扰 $\\Delta E(\\lambda)$ 与通过对角化完整哈密顿量得到的精确分裂进行基准比较\n$$\nH(\\lambda) =\n\\begin{pmatrix}\nE_0 & 0 & \\lambda g \\\\\n0 & E_0 & -\\lambda g \\\\\n\\lambda g & -\\lambda g & E_r\n\\end{pmatrix},\n$$\n这是一个在基 $\\{ \\lvert 1 \\rangle, \\lvert 2 \\rangle, \\lvert r \\rangle \\}$ 下的 $3 \\times 3$ 矩阵。\n\n使用以下科学上合理的常数，以电子伏特 (eV) 表示：\n- $E_0 = 0.00 \\ \\text{eV}$,\n- $E_r = 0.20 \\ \\text{eV}$,\n- $g = 0.10 \\ \\text{eV}$.\n\n构建一个包含四个应变大小的测试套件：\n- $\\lambda = 0.00$,\n- $\\lambda = 0.001$,\n- $\\lambda = 0.020$,\n- $\\lambda = 0.050$.\n\n对于测试套件中的每个 $\\lambda$：\n- 使用推导出的高达 $\\lambda$ 二阶的有效哈密顿量，计算微扰分裂 $\\Delta E_{\\mathrm{pert}}(\\lambda)$。\n- 通过对角化 $H(\\lambda)$ 并取其两个最低本征值之差，计算精确分裂 $\\Delta E_{\\mathrm{exact}}(\\lambda)$。\n\n所有能量必须以电子伏特 (eV) 表示，并四舍五入到六位小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目都是一个双元素列表 $[\\Delta E_{\\mathrm{pert}}(\\lambda), \\Delta E_{\\mathrm{exact}}(\\lambda)]$，按测试套件中的顺序对应一个 $\\lambda$。例如，两个测试用例的输出将类似于 $[[x_1,y_1],[x_2,y_2]]$，其中 $x_i$ 和 $y_i$ 是以 eV 为单位、四舍五入到六位小数的浮点数。\n\n问题必须从第一性原理出发解决，从上述定义和定律开始，并使用微扰理论的标准结果。问题陈述中不应给出最终分裂的快捷公式。在没有外部第一性原理数据（例如来自密度泛函理论 (DFT) 的数据）的情况下，使用最小哈密顿量 $H(\\lambda)$ 的精确对角化作为基准参考。",
            "solution": "问题陈述已经过验证，被认为是**有效的**。它在科学上基于量子力学原理，特别是近简并微扰理论。该问题是适定的，具备所有必要的常数、定义和明确的目标。它也是客观的，使用了正式、精确的语言，没有主观论断。所提供的用于硅中能谷分裂的最小模型和参数具有物理动机，并且在计算上是可行的。\n\n### 1. 微扰能谷分裂 $\\Delta E_{\\mathrm{pert}}(\\lambda)$ 的推导\n\n我们从给定的在简并能谷子空间 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ 中关于应变参数 $\\lambda$ 的高达二阶的有效哈密顿量公式开始：\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = E_0 I + \\lambda P W P + \\lambda^2 P W Q ( E_0 I - Q H_0 Q )^{-1} Q W P\n$$\n在此，$P = \\lvert 1 \\rangle\\langle 1 \\rvert + \\lvert 2 \\rangle\\langle 2 \\rvert$ 是投射到简并子空间的投影算符，而 $Q = I - P = \\lvert r \\rangle\\langle r \\rvert$ 是投射到远程态子空间的投影算符，因为总希尔伯特空间由 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle, \\lvert r \\rangle\\}$ 张成。\n\n我们在基 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ 中计算每一项对 $H_{\\mathrm{eff}}^{(2)}(\\lambda)$ 的 $2 \\times 2$ 矩阵表示的贡献。\n\n- **零阶项**：$E_0 I$ 由矩阵 $\\begin{pmatrix} E_0 & 0 \\\\ 0 & E_0 \\end{pmatrix}$ 表示。\n\n- **一阶项**：$\\lambda P W P$。矩阵元为 $\\lambda \\langle i | W | j \\rangle = \\lambda W_{ij}$，其中 $i,j \\in \\{1,2\\}$。问题陈述中指出，由于对称性，$W_{11} = W_{22} = W_{12} = W_{21} = 0$。因此，此项为零矩阵：$\\lambda \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$。\n\n- **二阶项**：$H^{(2)} = \\lambda^2 P W Q ( E_0 I - Q H_0 Q )^{-1} Q W P$。其矩阵元 $(H^{(2)})_{ij}$（其中 $i,j \\in \\{1,2\\}$）由下式给出：\n$$\n(H^{(2)})_{ij} = \\lambda^2 \\langle i | W Q ( E_0 I - Q H_0 Q )^{-1} Q W | j \\rangle\n$$\n插入完备态集，对于由 $Q$ 投影的子空间，这只是 $\\lvert r \\rangle$，我们得到：\n$$\n(H^{(2)})_{ij} = \\lambda^2 \\langle i | W | r \\rangle \\langle r | ( E_0 I - Q H_0 Q )^{-1} | r \\rangle \\langle r | W | j \\rangle\n$$\n中间的算符作用于本征态 $\\lvert r \\rangle$。由于 $H_0 \\lvert r \\rangle = E_r \\lvert r \\rangle$ 且 $Q \\lvert r \\rangle = \\lvert r \\rangle$，我们有 $(E_0 I - Q H_0 Q) \\lvert r \\rangle = (E_0 - E_r)\\lvert r \\rangle$。因此，逆算符得出 $(E_0 - E_r)^{-1}$。表达式简化为：\n$$\n(H^{(2)})_{ij} = \\lambda^2 W_{ir} \\frac{1}{E_0 - E_r} W_{rj}\n$$\n使用给定的非零耦合 $W_{1r} = g$、$W_{2r} = -g$，并注意到因为 $g$ 是实的，所以 $W_{rj} = \\langle r | W | j \\rangle = \\langle j | W | r \\rangle^* = W_{jr}^* = W_{jr}$，我们求得矩阵元：\n- $(H^{(2)})_{11} = \\lambda^2 \\frac{W_{1r} W_{r1}}{E_0 - E_r} = \\lambda^2 \\frac{g \\cdot g}{E_0 - E_r} = \\frac{\\lambda^2 g^2}{E_0 - E_r}$\n- $(H^{(2)})_{22} = \\lambda^2 \\frac{W_{2r} W_{r2}}{E_0 - E_r} = \\lambda^2 \\frac{(-g) \\cdot (-g)}{E_0 - E_r} = \\frac{\\lambda^2 g^2}{E_0 - E_r}$\n- $(H^{(2)})_{12} = \\lambda^2 \\frac{W_{1r} W_{r2}}{E_0 - E_r} = \\lambda^2 \\frac{g \\cdot (-g)}{E_0 - E_r} = -\\frac{\\lambda^2 g^2}{E_0 - E_r}$\n- $(H^{(2)})_{21} = (H^{(2)})_{12} = -\\frac{\\lambda^2 g^2}{E_0 - E_r}$\n\n结合所有项，有效哈密顿量为：\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = \\begin{pmatrix} E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} & -\\frac{\\lambda^2 g^2}{E_0 - E_r} \\\\ -\\frac{\\lambda^2 g^2}{E_0 - E_r} & E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} \\end{pmatrix}\n$$\n形如 $\\begin{pmatrix} A & B \\\\ B & A \\end{pmatrix}$ 的 $2 \\times 2$ 矩阵的本征值 $E'$ 为 $A \\pm B$。此处，$A = E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r}$ 且 $B = -\\frac{\\lambda^2 g^2}{E_0 - E_r}$。\n本征值为：\n- $E'_1 = A+B = E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} - \\frac{\\lambda^2 g^2}{E_0 - E_r} = E_0$\n- $E'_2 = A-B = E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} - (-\\frac{\\lambda^2 g^2}{E_0 - E_r}) = E_0 + \\frac{2\\lambda^2 g^2}{E_0 - E_r}$\n\n能谷分裂 $\\Delta E_{\\mathrm{pert}}(\\lambda)$ 是这些本征值之间的绝对差：\n$$\n\\Delta E_{\\mathrm{pert}}(\\lambda) = |E'_1 - E'_2| = \\left| -\\frac{2\\lambda^2 g^2}{E_0 - E_r} \\right| = \\frac{2\\lambda^2 g^2}{E_r - E_0}\n$$\n这是高达二阶的微扰分裂的最终表达式。\n\n### 2. 精确能谷分裂 $\\Delta E_{\\mathrm{exact}}(\\lambda)$ 的推导\n\n通过对角化完整的 $3 \\times 3$ 哈密顿量来求得精确分裂：\n$$\nH(\\lambda) =\n\\begin{pmatrix}\nE_0 & 0 & \\lambda g \\\\\n0 & E_0 & -\\lambda g \\\\\n\\lambda g & -\\lambda g & E_r\n\\end{pmatrix}\n$$\n本征值 $E$ 是特征方程 $\\det(H(\\lambda) - E I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} E_0 - E & 0 & \\lambda g \\\\ 0 & E_0 - E & -\\lambda g \\\\ \\lambda g & -\\lambda g & E_r - E \\end{pmatrix} = 0\n$$\n沿第一行展开行列式：\n$$\n(E_0 - E) \\left[ (E_0 - E)(E_r - E) - (-\\lambda g)(-\\lambda g) \\right] - 0 + (\\lambda g) \\left[ 0 - (E_0 - E)(\\lambda g) \\right] = 0\n$$\n$$\n(E_0 - E) \\left[ (E_0 - E)(E_r - E) - \\lambda^2 g^2 \\right] - \\lambda^2 g^2 (E_0 - E) = 0\n$$\n$$\n(E_0 - E) \\left[ (E_0 - E)(E_r - E) - 2\\lambda^2 g^2 \\right] = 0\n$$\n此方程立即给出一个根：$E_1 = E_0$。另外两个根来自二次方程：\n$$\n(E_0 - E)(E_r - E) - 2\\lambda^2 g^2 = 0 \\implies E^2 - (E_0 + E_r)E + E_0 E_r - 2\\lambda^2 g^2 = 0\n$$\n使用二次公式，另外两个本征值为：\n$$\nE = \\frac{(E_0 + E_r) \\pm \\sqrt{(E_0 + E_r)^2 - 4(E_0 E_r - 2\\lambda^2 g^2)}}{2}\n$$\n$$\nE = \\frac{(E_0 + E_r) \\pm \\sqrt{E_0^2 + 2E_0E_r + E_r^2 - 4E_0E_r + 8\\lambda^2 g^2}}{2} = \\frac{(E_0 + E_r) \\pm \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2}\n$$\n在极限 $\\lambda \\to 0$ 下，二次方程的根变为 $E_0$ 和 $E_r$。因此，$H(\\lambda)$ 的两个最低本征值（对应于受微扰的能谷态）是：\n- $E_1 = E_0$\n- $E_2 = \\frac{(E_0 + E_r) - \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2}$\n\n精确能谷分裂 $\\Delta E_{\\mathrm{exact}}(\\lambda)$ 是这两个最低本征值之间的绝对差：\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = |E_1 - E_2| = \\left| E_0 - \\frac{E_0 + E_r - \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2} \\right|\n$$\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = \\left| \\frac{2E_0 - E_0 - E_r + \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2} \\right|\n$$\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = \\left| \\frac{-(E_r - E_0) + \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2} \\right|\n$$\n由于 $\\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2} > (E_r - E_0)$，分子为正。\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = \\frac{\\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2} - (E_r - E_0)}{2}\n$$\n这是精确分裂的最终表达式。\n\n### 3. 数值计算\n推导出的公式将用于计算指定参数（$E_0 = 0.00 \\ \\text{eV}$，$E_r = 0.20 \\ \\text{eV}$，$g = 0.10 \\ \\text{eV}$）以及每个 $\\lambda \\in \\{0.00, 0.001, 0.020, 0.050\\}$ 的分裂值。结果将按要求四舍五入到六位小数。\n\n实现将计算：\n- $\\Delta E_{\\mathrm{pert}}(\\lambda) = \\frac{2\\lambda^2 (0.10)^2}{0.20 - 0.00} = \\frac{0.02 \\lambda^2}{0.20} = 0.1 \\lambda^2$\n- $\\Delta E_{\\mathrm{exact}}(\\lambda) = \\frac{\\sqrt{(0.20)^2 + 8\\lambda^2 (0.10)^2} - 0.20}{2} = \\frac{\\sqrt{0.04 + 0.08 \\lambda^2} - 0.20}{2}$\n\n每个 $\\lambda$ 的结果将被编译成最终的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for and compares perturbative and exact valley splitting in a minimal\n    3-level quantum system model.\n    \"\"\"\n    # Define the scientifically plausible constants in units of electronvolts (eV).\n    E0 = 0.00\n    Er = 0.20\n    g = 0.10\n\n    # Define the test suite of strain magnitudes.\n    test_cases = [0.00, 0.001, 0.020, 0.050]\n\n    results = []\n    for lam in test_cases:\n        # Calculate perturbative splitting using the derived formula:\n        # delta_E_pert = 2 * lambda^2 * g^2 / (Er - E0)\n        pert_split = (2 * lam**2 * g**2) / (Er - E0)\n\n        # Calculate exact splitting using the derived formula:\n        # delta_E_exact = (sqrt((Er - E0)^2 + 8 * lambda^2 * g^2) - (Er - E0)) / 2\n        # Use numpy.sqrt for numerical stability and correctness.\n        er_minus_e0 = Er - E0\n        exact_split = (np.sqrt(er_minus_e0**2 + 8 * lam**2 * g**2) - er_minus_e0) / 2\n        \n        # Store the pair of results for the current lambda.\n        # The problem requires the output numbers to be rounded to six decimal places,\n        # and formatted as a list of lists of floats without extra spaces.\n        # We format the numbers into strings with the required precision.\n        result_pair_str = f\"[{pert_split:.6f},{exact_split:.6f}]\"\n        results.append(result_pair_str)\n\n    # Final print statement in the exact required format: [[x1,y1],[x2,y2],...]\n    # The list `results` contains strings that are already formatted as \"[n1,n2]\",\n    # so we join them with commas and enclose in an outer pair of brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后一项练习将微扰思想应用于构建有效低能模型，这是计算材料科学中的一项核心技能。我们将运用$k \\cdot p$微扰理论来描述高对称点（如狄拉克点）附近的能带结构，并将应变视为附加微扰。这项高级实践  模拟了一项前沿研究任务：为应变二维材料构建一个有效哈密顿量。它超越了简单的能量校正，展示了如何使用微扰理论推导模型中的各种参数，例如重整化的速度和应变诱导的能隙。通过将不同阶数的微扰模型与一个更完整的参考模型进行比较，你将学习到评估有效理论适用范围的关键技能，这是理论建模的基石。",
            "id": "3474565",
            "problem": "考虑一个二维晶体材料，其在某个高对称性波矢处表现出线性能带交叉（一个狄拉克点）。在交叉点附近，导带和价带可以通过$k\\cdot p$方法构建的双能带有效哈密顿量来描述。设$\\boldsymbol{k}=(k_x,k_y)$是相对于狄拉克点测量的晶体动量，设小的均匀应变张量为$\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{xx}  \\varepsilon_{xy} \\\\ \\varepsilon_{xy}  \\varepsilon_{yy}\\end{pmatrix}$。使用量子力学中的微扰理论，构建对称性允许的、在$\\boldsymbol{\\varepsilon}$中达到指定阶数的项，并通过与第一性原理应变能带能量的替代模型进行比较，来评估高阶项在何种情况下是必不可少的。\n\n基本依据：\n- 不含时薛定谔方程为$H\\psi=E\\psi$。对于简并点附近的布洛赫电子，$k\\cdot p$方法断言，布洛赫哈密顿量在简并点周围可以按小$\\boldsymbol{k}$进行类泰勒展开，并受晶体对称性约束。其领头阶产生一个$\\boldsymbol{k}$的线性项，即狄拉克型哈密顿量，其中泡利矩阵$\\sigma_x,\\sigma_y,\\sigma_z$作用于双能带子空间。\n- 应变通过对称性允许的标量项、矢量项和类质量项与电子结构耦合。在$\\boldsymbol{\\varepsilon}$的最低阶中，这些微扰可以重整化速度、产生与$\\boldsymbol{k}$成正比的倾斜项、通过质量项打开带隙，并产生作为不依赖于$\\boldsymbol{k}$的$\\sigma_x$和$\\sigma_y$项引入的类赝规范场位移。\n\n应变的定义和不变量：\n- 定义迹$t=\\mathrm{Tr}\\,\\boldsymbol{\\varepsilon}=\\varepsilon_{xx}+\\varepsilon_{yy}$。\n- 定义偏应力分量$d=\\varepsilon_{xx}-\\varepsilon_{yy}$和剪切$\\varepsilon_{xy}$。\n- 定义矢量$\\boldsymbol{g}(\\boldsymbol{\\varepsilon})=(d,\\,-2\\varepsilon_{xy})$。\n- 定义平方范数$n=\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+2\\varepsilon_{xy}^2$。\n\n待实现的有效哈密顿量：\n- 无应变的狄拉克哈密顿量为$H_0(\\boldsymbol{k})=\\hbar v_0\\,(\\sigma_x k_x+\\sigma_y k_y)$，其中$\\hbar v_0$被视为一个电子伏特-埃单位的常数前因子，因此当$\\boldsymbol{k}$以逆埃为单位时，能量以电子伏特为单位。\n- 应变一阶有效哈密顿量$H^{(1)}(\\boldsymbol{k},\\boldsymbol{\\varepsilon})$仅包含$\\boldsymbol{\\varepsilon}$的线性项：\n  1) 具有各向同性和各向异性贡献的速度重整化：$\\hbar v_x^{(1)}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_a d\\right)$，$\\hbar v_y^{(1)}=\\hbar v_0\\left(1+\\alpha_1 t-\\alpha_a d\\right)$。\n  2) 类赝规范场位移，以$G_x=\\gamma_g\\,g_x$，$G_y=\\gamma_g\\,g_y$的形式引入，通过$\\sigma_x G_x+\\sigma_y G_y$耦合。\n  3) 质量项$m^{(1)}=\\beta_1 t$，通过$\\sigma_z m^{(1)}$耦合。\n  4) 标量形变势$U^{(1)}=\\delta_1 t$，通过单位矩阵$\\sigma_0$耦合。\n  5) 通过单位矩阵引入的、与$\\boldsymbol{k}$成线性的倾斜项：$T^{(1)}(\\boldsymbol{k})=\\tau_1\\,(g_x k_x+g_y k_y)$。\n  最终的哈密顿量为\n  $$H^{(1)}=\\sigma_0\\,U^{(1)}+\\sigma_0\\,T^{(1)}+\\sigma_x\\left(\\hbar v_x^{(1)}k_x+G_x\\right)+\\sigma_y\\left(\\hbar v_y^{(1)}k_y+G_y\\right)+\\sigma_z m^{(1)}.$$\n- 应变二阶有效哈密顿量$H^{(2)}(\\boldsymbol{k},\\boldsymbol{\\varepsilon})$在$H^{(1)}$的基础上增加了应变的二次修正：\n  1) 具有二次各向同性修正的速度重整化：$\\hbar v_x^{(2)}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n+\\alpha_a d\\right)$，$\\hbar v_y^{(2)}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n-\\alpha_a d\\right)$。\n  2) 质量项$m^{(2)}=\\beta_1 t+\\beta_2 t^2$。\n  3) 标量形变势$U^{(2)}=\\delta_1 t+\\delta_2 t^2$。\n  4) 保持$\\gamma_g$和$\\tau_1$与一阶模型相同（无新的二次类赝规范项）。\n  二阶哈密顿量为\n  $$H^{(2)}=\\sigma_0\\,U^{(2)}+\\sigma_0\\,T^{(1)}+\\sigma_x\\left(\\hbar v_x^{(2)}k_x+G_x\\right)+\\sigma_y\\left(\\hbar v_y^{(2)}k_y+G_y\\right)+\\sigma_z m^{(2)}.$$\n\n第一性原理应变导带的替代模型：\n- 为模拟在第一性原理计算中发现的非线性行为，使用一个增强模型，该模型包括应变三阶速度修正、应变二次倾斜增强，以及对导带能量的弱$\\boldsymbol{k}$三次翘曲贡献。定义\n  $$\\hbar v_x^{\\mathrm{ref}}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n+\\alpha_3 t^3+\\alpha_a d\\right),\\quad \\hbar v_y^{\\mathrm{ref}}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n+\\alpha_3 t^3-\\alpha_a d\\right),$$\n  $$m^{\\mathrm{ref}}=\\beta_1 t+\\beta_2 t^2+\\beta_3 t\\,n,\\quad U^{\\mathrm{ref}}=\\delta_1 t+\\delta_2 t^2,$$\n  $$T^{\\mathrm{ref}}(\\boldsymbol{k})=(\\tau_1+\\tau_2 n)\\,(g_x k_x+g_y k_y),\\quad G_x=\\gamma_g g_x,\\quad G_y=\\gamma_g g_y.$$\n  构建\n  $$H^{\\mathrm{ref}}=\\sigma_0\\,U^{\\mathrm{ref}}+\\sigma_0\\,T^{\\mathrm{ref}}+\\sigma_x\\left(\\hbar v_x^{\\mathrm{ref}}k_x+G_x\\right)+\\sigma_y\\left(\\hbar v_y^{\\mathrm{ref}}k_y+G_y\\right)+\\sigma_z m^{\\mathrm{ref}}.$$\n  令导带能量为$H^{\\mathrm{ref}}$的较大本征值$E_+^{\\mathrm{ref}}(\\boldsymbol{k},\\boldsymbol{\\varepsilon})$，并增加一个翘曲位移\n  $$\\Delta E_{\\mathrm{warp}}=w\\,n\\,(k_x^3-3k_x k_y^2),$$\n  因此最终的替代导带能量为$E_+^{\\mathrm{ref}}+\\Delta E_{\\mathrm{warp}}$。\n\n数值常数和单位：\n- 使用$\\hbar v_0=6.5$电子伏特-埃（$\\mathrm{eV\\cdot \\mathring{A}}$），因此当$k$以逆埃（$\\mathrm{\\mathring{A}^{-1}}$）为单位时，$\\hbar v_0 k$以电子伏特为单位。所有能量必须以电子伏特计算和报告。波矢必须以逆埃为单位。\n- 耦合常数：$\\alpha_1=1.0$，$\\alpha_2=100.0$，$\\alpha_3=800.0$，$\\alpha_a=3.0$，$\\gamma_g=0.15$电子伏特，$\\beta_1=0.25$电子伏特，$\\beta_2=4.0$电子伏特，$\\beta_3=8.0$电子伏特，$\\delta_1=0.05$电子伏特，$\\delta_2=1.0$电子伏特，$\\tau_1=1.5$电子伏特-埃，$\\tau_2=4.0$电子伏特-埃，$w=1.0$电子伏特-埃$^3$。\n- $\\boldsymbol{k}$的取样：限制在一维截线$k_y=0$上，并在$[-k_{\\max},k_{\\max}]$区间内均匀取样$k_x$，其中$k_{\\max}=0.1\\,\\mathrm{\\mathring{A}^{-1}}$。使用$N=101$个等间距点。\n\n评估标准：\n- 对于给定的$\\boldsymbol{\\varepsilon}$，将一阶有效导带$E_+^{(1)}$与替代模型$E_+^{\\mathrm{ref}}$在所取样的$\\boldsymbol{k}$上的最大绝对偏差定义为$\\Delta_1=\\max_{\\boldsymbol{k}}|E_+^{(1)}-E_+^{\\mathrm{ref}}|$，类似地，二阶偏差为$\\Delta_2=\\max_{\\boldsymbol{k}}|E_+^{(2)}-E_+^{\\mathrm{ref}}|$。\n- 使用容差$\\Theta=0.01$电子伏特（即$10$毫电子伏特），通过整数对每个测试用例的区域进行分类\n  $$C=\\begin{cases}\n  0,  \\Delta_1\\le \\Theta\\quad \\text{(一阶模型足够)},\\\\\n  1,  \\Delta_1>\\Theta\\ \\text{and}\\ \\Delta_2\\le \\Theta\\quad \\text{(二阶模型必要且足够)},\\\\\n  2,  \\Delta_2>\\Theta\\quad \\text{(即使二阶模型也不足)}.\n  \\end{cases}$$\n\n测试套件：\n- 四个应变张量，每个都以$\\begin{pmatrix}\\varepsilon_{xx}\\varepsilon_{xy}\\\\\\varepsilon_{xy}\\varepsilon_{yy}\\end{pmatrix}$的顺序列于列表的列表中指定，应变分量为无量纲：\n  1) 小静水应变：$\\boldsymbol{\\varepsilon}_\\mathrm{H}=\\begin{pmatrix}0.0020.0\\\\0.00.002\\end{pmatrix}$。\n  2) 迹为零的剪切主导应变：$\\boldsymbol{\\varepsilon}_\\mathrm{S}=\\begin{pmatrix}0.010.005\\\\0.005-0.01\\end{pmatrix}$。\n  3) 较大双轴应变：$\\boldsymbol{\\varepsilon}_\\mathrm{B}=\\begin{pmatrix}0.020.0\\\\0.00.02\\end{pmatrix}$。\n  4) 零应变边界情况：$\\boldsymbol{\\varepsilon}_\\mathrm{Z}=\\begin{pmatrix}0.00.0\\\\0.00.0\\end{pmatrix}$。\n\n要求输出：\n- 你的程序必须按指定顺序计算四个测试用例的$C$值，并生成一行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如，\"[0,1,2,0]\"）。输出为整数，不含任何附加文本。能量和容差必须以电子伏特处理，波矢以逆埃处理。",
            "solution": "用户提供了一个有效的、适定的计算材料科学问题，该问题基于量子力学和微扰理论的原理。任务是针对一个受应变的二维狄拉克材料，评估递进复杂的有效哈密顿量相对于一个更完备的替代模型的有效性。\n\n问题的核心是计算一个通用的$2 \\times 2$矩阵哈密顿量的本征值。任何此类哈密顿量都可以在单位矩阵$\\sigma_0$和三个泡利矩阵$\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$的基上表示为：\n$$H = h_0\\sigma_0 + h_x\\sigma_x + h_y\\sigma_y + h_z\\sigma_z = \\begin{pmatrix} h_0 + h_z  h_x - ih_y \\\\ h_x + ih_y  h_0 - h_z \\end{pmatrix}$$\n该哈密顿量的本征值为$E_\\pm(\\boldsymbol{k}, \\boldsymbol{\\varepsilon}) = h_0 \\pm \\sqrt{h_x^2 + h_y^2 + h_z^2}$。问题关注的是导带，对应于较大的本征值，$E_+ = h_0 + \\sqrt{h_x^2 + h_y^2 + h_z^2}$。\n\n解决方案通过执行一个计算程序来进行，该程序对每个给定的应变张量$\\boldsymbol{\\varepsilon}$执行以下步骤：\n\n1.  **计算应变导出的不变量**：从给定的应变张量$\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{xx}  \\varepsilon_{xy} \\\\ \\varepsilon_{xy}  \\varepsilon_{yy}\\end{pmatrix}$的分量，我们首先计算出现在哈密顿量中的必要标量和矢量。这些量是迹$t=\\varepsilon_{xx}+\\varepsilon_{yy}$、偏应力分量$d=\\varepsilon_{xx}-\\varepsilon_{yy}$、矢量$\\boldsymbol{g}=(d, -2\\varepsilon_{xy})$（其分量为$g_x=d$和$g_y=-2\\varepsilon_{xy}$）以及平方范数$n=\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+2\\varepsilon_{xy}^2$。这些量在晶格对称性下是不变的，并构成了构造微扰项的基础。\n\n2.  **构造哈密顿量分量**：对于三个模型中的每一个——一阶模型$H^{(1)}$、二阶模型$H^{(2)}$和参考替代模型$H^{\\text{ref}}$——我们构造系数$h_0$、$h_x$、$h_y$和$h_z$作为应变不变量和波矢$\\boldsymbol{k}$的函数。问题指定了一个一维取样路径，其中$k_y=0$且$k_x$变化。\n\n    -   **一阶模型 ($H^{(1)}$)**:\n        $h_0 = U^{(1)} + T^{(1)}(\\boldsymbol{k}) = \\delta_1 t + \\tau_1(g_x k_x)$\n        $h_x = \\hbar v_x^{(1)}k_x + G_x = \\hbar v_0(1+\\alpha_1 t+\\alpha_a d)k_x + \\gamma_g g_x$\n        $h_y = \\hbar v_y^{(1)}k_y + G_y = \\gamma_g g_y$ (因为$k_y=0$)\n        $h_z = m^{(1)} = \\beta_1 t$\n\n    -   **二阶模型 ($H^{(2)}$)**: 该模型在$H^{(1)}$的基础上增加了应变的二次项。\n        $h_0 = U^{(2)} + T^{(1)}(\\boldsymbol{k}) = (\\delta_1 t + \\delta_2 t^2) + \\tau_1(g_x k_x)$\n        $h_x = \\hbar v_x^{(2)}k_x + G_x = \\hbar v_0(1+\\alpha_1 t+\\alpha_2 n+\\alpha_a d)k_x + \\gamma_g g_x$\n        $h_y = \\gamma_g g_y$\n        $h_z = m^{(2)} = \\beta_1 t + \\beta_2 t^2$\n\n    -   **参考替代模型 ($H^{\\text{ref}}$，带翘曲)**: 该模型包含更高阶的项以模拟更真实的能带结构。\n        $h_0^{\\text{ref}} = U^{\\text{ref}} + T^{\\text{ref}}(\\boldsymbol{k}) = (\\delta_1 t+\\delta_2 t^2) + (\\tau_1+\\tau_2 n)(g_x k_x)$\n        $h_x^{\\text{ref}} = \\hbar v_x^{\\text{ref}}k_x + G_x = \\hbar v_0(1+\\alpha_1 t+\\alpha_2 n+\\alpha_3 t^3+\\alpha_a d)k_x + \\gamma_g g_x$\n        $h_y^{\\text{ref}} = \\gamma_g g_y$\n        $h_z^{\\text{ref}} = m^{\\text{ref}} = \\beta_1 t+\\beta_2 t^2+\\beta_3 t n$\n        最终的替代能量还包括一个翘曲项：$E_{+, \\text{surrogate}} = E_+^{\\text{ref}} + \\Delta E_{\\text{warp}}$，其中$\\Delta E_{\\text{warp}} = w\\,n\\,k_x^3$。\n\n3.  **计算能带**：波矢$k_x$在区间$[-0.1, 0.1]\\, \\mathrm{\\mathring{A}^{-1}}$内的$N=101$个点上取样。对于每个模型，我们在每个取样的$k_x$点计算导带能量$E_+$，从而得到三个能带：$E_+^{(1)}(k_x)$、$E_+^{(2)}(k_x)$和$E_{+, \\text{surrogate}}(k_x)$。\n\n4.  **评估偏差**：一阶和二阶模型的准确性通过与替代模型在所取样的$k_x$点上的最大绝对偏差来量化。\n    $\\Delta_1 = \\max_{k_x} |E_+^{(1)}(k_x) - E_{+, \\text{surrogate}}(k_x)|$\n    $\\Delta_2 = \\max_{k_x} |E_+^{(2)}(k_x) - E_{+, \\text{surrogate}}(k_x)|$\n\n5.  **对区域进行分类**：根据计算出的偏差和给定的容差$\\Theta=0.01\\,\\mathrm{eV}$，我们根据整数值函数$C$对给定应变下模型的适用性进行分类：\n    $$C=\\begin{cases}\n    0,  \\Delta_1\\le \\Theta\\quad \\text{(一阶模型足够)},\\\\\n    1,  \\Delta_1>\\Theta\\ \\text{and}\\ \\Delta_2\\le \\Theta\\quad \\text{(二阶模型必要且足够)},\\\\\n    2,  \\Delta_2>\\Theta\\quad \\text{(即使二阶模型也不足)}.\n    \\end{cases}$$\n\n对四个指定的应变张量中的每一个重复此过程，并收集得到的分类整数以形成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It orchestrates the calculation of the classification integer C for each strain.\n    \"\"\"\n    \n    # Numerical constants and parameters\n    hbar_v0 = 6.5  # eV*A\n    alpha1 = 1.0\n    alpha2 = 100.0\n    alpha3 = 800.0\n    alpha_a = 3.0\n    gamma_g = 0.15  # eV\n    beta1 = 0.25   # eV\n    beta2 = 4.0    # eV\n    beta3 = 8.0    # eV\n    delta1 = 0.05   # eV\n    delta2 = 1.0    # eV\n    tau1 = 1.5     # eV*A\n    tau2 = 4.0     # eV*A\n    w = 1.0      # eV*A^3\n    \n    k_max = 0.1    # A^-1\n    N = 101\n    Theta = 0.01   # eV\n\n    # Test suite of strain tensors\n    test_cases = [\n        np.array([[0.002, 0.0], [0.0, 0.002]]),  # Small hydrostatic strain\n        np.array([[0.01, 0.005], [0.005, -0.01]]), # Shear-dominant strain\n        np.array([[0.02, 0.0], [0.0, 0.02]]),   # Larger biaxial strain\n        np.array([[0.0, 0.0], [0.0, 0.0]])      # Zero strain\n    ]\n\n    results = []\n    \n    # k-space sampling grid\n    k_x = np.linspace(-k_max, k_max, num=N)\n    k_y = 0.0\n\n    for eps_tensor in test_cases:\n        # 1. Calculate strain-derived quantities\n        exx = eps_tensor[0, 0]\n        exy = eps_tensor[0, 1]\n        eyy = eps_tensor[1, 1]\n\n        t = exx + eyy\n        d = exx - eyy\n        gx = d\n        gy = -2 * exy\n        n = exx**2 + eyy**2 + 2 * exy**2\n\n        # 2. Calculate conduction band energies for each model\n        \n        # Model 1: First-order in strain\n        vx1 = hbar_v0 * (1.0 + alpha1 * t + alpha_a * d)\n        Gx = gamma_g * gx\n        Gy = gamma_g * gy\n        m1 = beta1 * t\n        U1 = delta1 * t\n        T1_k = tau1 * (gx * k_x + gy * k_y)\n        \n        h0_1 = U1 + T1_k\n        hx_1 = vx1 * k_x + Gx\n        hy_1 = np.full_like(k_x, Gy)\n        hz_1 = np.full_like(k_x, m1)\n        E_plus_1 = h0_1 + np.sqrt(hx_1**2 + hy_1**2 + hz_1**2)\n\n        # Model 2: Second-order in strain\n        vx2 = hbar_v0 * (1.0 + alpha1 * t + alpha2 * n + alpha_a * d)\n        m2 = beta1 * t + beta2 * t**2\n        U2 = delta1 * t + delta2 * t**2\n        \n        h0_2 = U2 + T1_k  # NOTE: uses T1, not a higher-order T\n        hx_2 = vx2 * k_x + Gx\n        hy_2 = np.full_like(k_x, Gy)\n        hz_2 = np.full_like(k_x, m2)\n        E_plus_2 = h0_2 + np.sqrt(hx_2**2 + hy_2**2 + hz_2**2)\n\n        # Reference Surrogate Model\n        vx_ref = hbar_v0 * (1.0 + alpha1 * t + alpha2 * n + alpha3 * t**3 + alpha_a * d)\n        m_ref = beta1 * t + beta2 * t**2 + beta3 * t * n\n        U_ref = delta1 * t + delta2 * t**2 # Same as U2\n        T_ref_k = (tau1 + tau2 * n) * (gx * k_x + gy * k_y)\n\n        h0_ref = U_ref + T_ref_k\n        hx_ref = vx_ref * k_x + Gx\n        hy_ref = np.full_like(k_x, Gy)\n        hz_ref = np.full_like(k_x, m_ref)\n        \n        E_plus_ref_no_warp = h0_ref + np.sqrt(hx_ref**2 + hy_ref**2 + hz_ref**2)\n        delta_E_warp = w * n * (k_x**3 - 3 * k_x * k_y**2)\n        E_plus_surrogate = E_plus_ref_no_warp + delta_E_warp\n        \n        # 3. Assess deviations\n        delta1 = np.max(np.abs(E_plus_1 - E_plus_surrogate))\n        delta2 = np.max(np.abs(E_plus_2 - E_plus_surrogate))\n        \n        # 4. Classify the regime\n        if delta1 = Theta:\n            C = 0\n        elif delta2 = Theta:\n            C = 1\n        else:\n            C = 2\n        \n        results.append(C)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}