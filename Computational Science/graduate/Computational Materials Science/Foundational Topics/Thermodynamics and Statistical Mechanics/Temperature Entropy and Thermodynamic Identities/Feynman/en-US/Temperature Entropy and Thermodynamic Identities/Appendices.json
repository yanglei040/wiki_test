{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of computational materials science is the ability to predict macroscopic thermodynamic properties from microscopic models. This practice guides you through this process using the Einstein model of a solid, a fundamental concept in solid-state physics. Starting from the quantum energy levels of harmonic oscillators, you will construct the canonical partition function and from it, derive the absolute Helmholtz free energy $F$, a master potential from which all other thermodynamic quantities can be obtained. The exercise then involves using numerical differentiation to compute entropy $S$ and pressure $P$, and to rigorously verify fundamental identities like $S=(U-F)/T$ and the Maxwell relation $(\\partial P/\\partial T)_V = (\\partial S/\\partial V)_T$, reinforcing the deep consistency between statistical mechanics and thermodynamics .",
            "id": "3491737",
            "problem": "You are to write a complete, runnable program that computes the absolute Helmholtz free energy for a crystalline solid modeled as an Einstein crystal and uses it to validate two thermodynamic identities by finite differences. The setting is fully quantum mechanical and must use the canonical partition function of the quantum harmonic oscillator as the starting point.\n\nFundamental basis to use:\n- A single quantum harmonic oscillator has energy levels $\\varepsilon_n=\\hbar\\omega\\left(n+\\tfrac{1}{2}\\right)$ with $n\\in\\{0,1,2,\\dots\\}$.\n- The canonical partition function is $Z=\\sum_i e^{-\\beta \\varepsilon_i}$, with $\\beta=1/(k_{\\mathrm{B}}T)$ and temperature $T$.\n- For $3N$ independent oscillators of equal frequency, $Z=Z_1^{3N}$, where $Z_1$ is the single-oscillator partition function.\n- The Helmholtz free energy is $F=-k_{\\mathrm{B}}T\\ln Z$, the internal energy is $U=-\\partial \\ln Z/\\partial \\beta$, and the entropy is $S=-(\\partial F/\\partial T)_V$.\n- The Einstein model uses a single angular frequency for all modes that depends on volume via the Grüneisen parameter $\\gamma$ as $\\omega(V)=\\omega_0\\left(\\tfrac{V_0}{V}\\right)^\\gamma$, where $\\omega_0=\\tfrac{k_{\\mathrm{B}}\\Theta_{\\mathrm{E}}}{\\hbar}$ is defined by the Einstein temperature $\\Theta_{\\mathrm{E}}$ at a reference volume $V_0$.\n- The differential of the Helmholtz free energy for fixed particle number is $dF=-S\\,dT-P\\,dV$, implying the Maxwell relation $\\left(\\tfrac{\\partial P}{\\partial T}\\right)_V=\\left(\\tfrac{\\partial S}{\\partial V}\\right)_T$.\n\nConstants to use (in International System of Units):\n- Boltzmann constant $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\n- Reduced Planck constant $\\hbar=1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$.\n\nTasks your program must perform:\n1. Implement a function that, given $T$, $V$, $N$, $\\Theta_{\\mathrm{E}}$, $\\gamma$, and $V_0$, computes the absolute Helmholtz free energy $F(T,V)$ of the Einstein crystal from the canonical partition function without invoking any classical limit. You may evaluate the single-oscillator partition function $Z_1$ either by summation over $n$ to numerical convergence or by an exact closed-form evaluation obtained from the geometric series; in either case, machine-precision accuracy is required. Also compute the internal energy $U(T,V)$ from its definition in terms of $Z$.\n2. For a given $T$ and $V$, approximate $S(T,V)$ by the central finite difference $S_{\\mathrm{fd}}(T,V)=-\\dfrac{F(T+\\Delta T,V)-F(T-\\Delta T,V)}{2\\,\\Delta T}$ for a provided $\\Delta T$, and validate the identity $S(T,V)=\\dfrac{U(T,V)-F(T,V)}{T}$ by reporting the absolute discrepancy $\\left|S_{\\mathrm{fd}}-\\dfrac{U-F}{T}\\right|$ in $\\mathrm{J/K}$.\n3. Compute the pressure $P(T,V)$ via the central finite difference $P(T,V)=-\\dfrac{F(T,V+\\Delta V)-F(T,V-\\Delta V)}{2\\,\\Delta V}$, where $\\Delta V=\\varepsilon_V\\,V$ and $\\varepsilon_V$ is provided. Use this to evaluate $\\left(\\tfrac{\\partial P}{\\partial T}\\right)_V$ at $T$ by a central finite difference in $T$, and evaluate $\\left(\\tfrac{\\partial S}{\\partial V}\\right)_T$ by a central finite difference in $V$ using $S_{\\mathrm{fd}}$. Validate the Maxwell relation $\\left(\\tfrac{\\partial P}{\\partial T}\\right)_V=\\left(\\tfrac{\\partial S}{\\partial V}\\right)_T$ by reporting the absolute discrepancy in $\\mathrm{J/(K\\cdot m^3)}$.\n\nPhysical units:\n- All inputs and intermediate quantities must be treated in SI units. Temperatures $T$ and $\\Theta_{\\mathrm{E}}$ are in $\\mathrm{K}$, volumes are in $\\mathrm{m^3}$, energies are in $\\mathrm{J}$, and pressure is in $\\mathrm{Pa}$.\n\nTest suite:\nYour program must evaluate the two discrepancies for each of the following three test cases. In each case, report two floats: first the discrepancy for $S=\\dfrac{U-F}{T}$ in $\\mathrm{J/K}$, then the discrepancy for the Maxwell relation in $\\mathrm{J/(K\\cdot m^3)}$.\n\n- Case A (moderate temperature, representative Grüneisen parameter):\n  - $N=500$\n  - $\\Theta_{\\mathrm{E}}=300\\,\\mathrm{K}$\n  - $\\gamma=2.0$\n  - $V_0=6.0\\times 10^{-27}\\,\\mathrm{m^3}$\n  - $T=200\\,\\mathrm{K}$\n  - $\\Delta T=0.2\\,\\mathrm{K}$\n  - $\\varepsilon_V=1.0\\times 10^{-5}$\n\n- Case B (low temperature limit):\n  - $N=500$\n  - $\\Theta_{\\mathrm{E}}=300\\,\\mathrm{K}$\n  - $\\gamma=2.0$\n  - $V_0=6.0\\times 10^{-27}\\,\\mathrm{m^3}$\n  - $T=5\\,\\mathrm{K}$\n  - $\\Delta T=0.05\\,\\mathrm{K}$\n  - $\\varepsilon_V=1.0\\times 10^{-5}$\n\n- Case C (high temperature and different elastic response):\n  - $N=500$\n  - $\\Theta_{\\mathrm{E}}=800\\,\\mathrm{K}$\n  - $\\gamma=1.2$\n  - $V_0=8.0\\times 10^{-27}\\,\\mathrm{m^3}$\n  - $T=1200\\,\\mathrm{K}$\n  - $\\Delta T=0.5\\,\\mathrm{K}$\n  - $\\varepsilon_V=1.0\\times 10^{-5}$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n  $[\\Delta S_{\\mathrm{A}},\\Delta M_{\\mathrm{A}},\\Delta S_{\\mathrm{B}},\\Delta M_{\\mathrm{B}},\\Delta S_{\\mathrm{C}},\\Delta M_{\\mathrm{C}}]$,\n  where each $\\Delta S$ is the absolute discrepancy for $S=\\dfrac{U-F}{T}$ in $\\mathrm{J/K}$ and each $\\Delta M$ is the absolute discrepancy for the Maxwell relation in $\\mathrm{J/(K\\cdot m^3)}$. No additional text should be printed.",
            "solution": "The solution proceeds by first deriving the analytical expressions for the Helmholtz free energy $F$ and the internal energy $U$ from the canonical partition function of a quantum harmonic oscillator. These expressions are then used to devise a computational strategy to validate the two specified thermodynamic identities via the central finite difference method. For all calculations, it is assumed that the system properties are to be evaluated at the reference volume, i.e., $V=V_0$.\n\n**1. Fundamental Expressions of the Einstein Model**\n\nThe Einstein model treats a crystalline solid as a collection of $3N$ independent quantum harmonic oscillators of frequency $\\omega$. The single-oscillator partition function $Z_1$ is a geometric series that sums to:\n$$ Z_1 = \\frac{e^{-\\beta\\hbar\\omega/2}}{1 - e^{-\\beta\\hbar\\omega}} $$\nwhere $\\beta = 1/(k_{\\mathrm{B}}T)$. For $3N$ oscillators, the total partition function is $Z = Z_1^{3N}$.\n\n**2. Thermodynamic Potentials**\n\nFrom $Z$, we derive the Helmholtz free energy $F = -k_{\\mathrm{B}}T\\ln Z$ and internal energy $U = -(\\partial \\ln Z / \\partial \\beta)_V$:\n$$ F(T,V) = 3N \\left[ \\frac{\\hbar\\omega}{2} + k_{\\mathrm{B}}T \\ln\\left(1 - e^{-\\hbar\\omega/k_{\\mathrm{B}}T}\\right) \\right] $$\n$$ U(T,V) = 3N\\hbar\\omega \\left[ \\frac{1}{2} + \\frac{1}{e^{\\hbar\\omega/k_{\\mathrm{B}}T} - 1} \\right] $$\nThe volume dependence enters through the frequency $\\omega(V) = \\omega_0 (V_0/V)^\\gamma$.\n\n**3. Validation of Thermodynamic Identities**\n\nTwo identities are validated using numerical differentiation.\n\n_Identity 1: $S = (U-F)/T$_\nThe entropy $S$ is defined by $S = -(\\partial F/\\partial T)_V$. A fundamental thermodynamic relation also connects it to $U$ and $F$ as $S=(U-F)/T$. We validate this by comparing the value from the analytical expressions for $U$ and $F$ with a finite difference approximation of $S$:\n$$ S_{\\mathrm{fd}}(T,V) = -\\frac{F(T+\\Delta T, V) - F(T-\\Delta T, V)}{2\\Delta T} $$\nThe discrepancy is calculated as $\\left| S_{\\mathrm{fd}} - \\frac{U(T,V)-F(T,V)}{T} \\right|$.\n\n_Identity 2: Maxwell Relation $(\\partial P/\\partial T)_V = (\\partial S/\\partial V)_T$_\nThis relation stems from the exact differential $dF = -S\\,dT - P\\,dV$ and the equality of mixed partials of $F$. We validate it by computing both sides using central finite differences, which effectively calculates the same second-order mixed partial derivative $-\\partial^2 F/(\\partial V \\partial T)$ in two different orders. This requires calculating $F$ at nine points in the $(T,V)$ plane.\n\nThe provided Python code implements these functions and performs the validation for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes thermodynamic properties for an Einstein solid and validates two\n    thermodynamic identities using finite differences for three test cases.\n    \"\"\"\n    # Define physical constants in SI units\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34 # Reduced Planck constant in J*s\n\n    def calculate_thermo_properties(T, V, N, theta_E, gamma, V0):\n        \"\"\"\n        Calculates the Helmholtz free energy (F) and internal energy (U) for an\n        Einstein crystal.\n\n        Args:\n            T (float): Temperature in K.\n            V (float): Volume in m^3.\n            N (int): Number of atoms.\n            theta_E (float): Einstein temperature at V0 in K.\n            gamma (float): Grüneisen parameter.\n            V0 (float): Reference volume in m^3.\n\n        Returns:\n            tuple: A tuple containing (F, U) in Joules.\n        \"\"\"\n        if T = 0 or V = 0:\n            return (np.inf, np.inf)\n\n        # Volume-dependent angular frequency\n        omega = (KB * theta_E / HBAR) * (V0 / V)**gamma\n        \n        # Dimensionless argument for exponential and log functions\n        x = HBAR * omega / (KB * T)\n        \n        # Handle numerical stability for large x (low T)\n        if x > np.log(np.finfo(float).max):  # Avoid exp(x) overflow\n            log_term = -np.exp(-x)\n            exp_term_for_U = np.exp(-x)\n        else:\n            # np.log1p(-exp(-x)) is more accurate than log(1-exp(-x)) for small x\n            log_term = np.log1p(-np.exp(-x))\n            exp_term_for_U = 1.0 / (np.exp(x) - 1.0)\n\n        # Helmholtz Free Energy F\n        # F = 3N * [ hbar*omega/2 + kB*T*ln(1 - exp(-hbar*omega/kB*T)) ]\n        F = 3.0 * N * (0.5 * HBAR * omega + KB * T * log_term)\n        \n        # Internal Energy U\n        # U = 3N*hbar*omega * [ 1/2 + 1/(exp(hbar*omega/kB*T) - 1) ]\n        U = 3.0 * N * HBAR * omega * (0.5 + exp_term_for_U)\n        \n        return F, U\n\n    def run_validation_case(params):\n        \"\"\"\n        Runs the full validation for a single test case.\n        \"\"\"\n        N, theta_E, gamma, V0, T_center, delta_T, eps_V = params\n\n        # The problem does not specify V for the test cases. We assume V = V0.\n        V_center = V0\n        delta_V = eps_V * V_center\n\n        # --- Task 2: Validate S = (U-F)/T ---\n        # Get F and U at the central point (T_center, V_center)\n        F_center, U_center = calculate_thermo_properties(T_center, V_center, N, theta_E, gamma, V0)\n        \n        # Get F at T +/- delta_T for the finite difference approximation of S\n        F_pT, _ = calculate_thermo_properties(T_center + delta_T, V_center, N, theta_E, gamma, V0)\n        F_mT, _ = calculate_thermo_properties(T_center - delta_T, V_center, N, theta_E, gamma, V0)\n        \n        # S from finite difference: S_fd = - (dF/dT)_V\n        S_fd = -(F_pT - F_mT) / (2.0 * delta_T)\n        \n        # S from the thermodynamic identity: S = (U-F)/T\n        S_analytic = (U_center - F_center) / T_center\n        \n        discrepancy_S = np.abs(S_fd - S_analytic)\n\n        # --- Task 3: Validate Maxwell Relation (dP/dT)_V = (dS/dV)_T ---\n        # Define the 9 grid points in the (T,V) plane\n        T_p, T_m = T_center + delta_T, T_center - delta_T\n        V_p, V_m = V_center + delta_V, V_center - delta_V\n\n        # Calculate F at the four corner points of the finite difference stencil\n        F_pT_pV, _ = calculate_thermo_properties(T_p, V_p, N, theta_E, gamma, V0)\n        F_pT_mV, _ = calculate_thermo_properties(T_p, V_m, N, theta_E, gamma, V0)\n        F_mT_pV, _ = calculate_thermo_properties(T_m, V_p, N, theta_E, gamma, V0)\n        F_mT_mV, _ = calculate_thermo_properties(T_m, V_m, N, theta_E, gamma, V0)\n        \n        # Calculate (dS/dV)_T via nested central differences\n        # S_fd(T, V_p) = -(F(T_p, V_p) - F(T_m, V_p)) / (2*dT)\n        S_fd_at_Vp = -(F_pT_pV - F_mT_pV) / (2.0 * delta_T)\n        # S_fd(T, V_m) = -(F(T_p, V_m) - F(T_m, V_m)) / (2*dT)\n        S_fd_at_Vm = -(F_pT_mV - F_mT_mV) / (2.0 * delta_T)\n        # dS/dV ~ (S_fd(V_p) - S_fd(V_m)) / (2*dV)\n        dS_dV_T = (S_fd_at_Vp - S_fd_at_Vm) / (2.0 * delta_V)\n\n        # Calculate (dP/dT)_V via nested central differences\n        # P_fd(T_p, V) = -(F(T_p, V_p) - F(T_p, V_m)) / (2*dV)\n        P_fd_at_Tp = -(F_pT_pV - F_pT_mV) / (2.0 * delta_V)\n        # P_fd(T_m, V) = -(F(T_m, V_p) - F(T_m, V_m)) / (2*dV)\n        P_fd_at_Tm = -(F_mT_pV - F_mT_mV) / (2.0 * delta_V)\n        # dP/dT ~ (P_fd(T_p) - P_fd(T_m)) / (2*dT)\n        dP_dT_V = (P_fd_at_Tp - P_fd_at_Tm) / (2.0 * delta_T)\n        \n        discrepancy_M = np.abs(dS_dV_T - dP_dT_V)\n        \n        return discrepancy_S, discrepancy_M\n\n    # Define the test cases from the problem statement.\n    # Format: (N, theta_E, gamma, V0, T, delta_T, eps_V)\n    test_cases = [\n        # Case A\n        (500, 300.0, 2.0, 6.0e-27, 200.0, 0.2, 1.0e-5),\n        # Case B\n        (500, 300.0, 2.0, 6.0e-27, 5.0, 0.05, 1.0e-5),\n        # Case C\n        (500, 800.0, 1.2, 8.0e-27, 1200.0, 0.5, 1.0e-5),\n    ]\n\n    results = []\n    for case in test_cases:\n        discrep_S, discrep_M = run_validation_case(case)\n        results.append(f\"{discrep_S:.15e}\")\n        results.append(f\"{discrep_M:.15e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Entropy, $S$, is a state function, meaning its change between two thermodynamic states is independent of the path taken. This exercise provides a hands-on exploration of this defining property by investigating a system whose equation of state is intentionally designed to be thermodynamically inconsistent under certain conditions . You will calculate the entropy change between two points along different paths using numerical integration and directly observe the path-dependence error when the conditions for an exact differential are not met. This practice offers a powerful lesson on the mathematical underpinnings of thermodynamics, connecting the abstract concept of an exact differential to the tangible outcome of path-independent state properties.",
            "id": "3491717",
            "problem": "You will build and test a computational model for entropy integration in reduced Lennard-Jones (LJ) units for a condensed phase described by a van der Waals-like equation of state. Work entirely in reduced LJ units, where energy is scaled by the Lennard-Jones well depth, length by the Lennard-Jones diameter, and Boltzmann’s constant is unity. All reported numbers must be dimensionless.\n\nThe starting point is fundamental thermodynamics: the first and second laws, the definition of heat capacity at constant volume, and Maxwell relations derived from exact differentials of thermodynamic potentials. From these, derive a differential for the entropy in terms of temperature and volume. Do not assume any specific shortcut formula; proceed from the fundamental laws and core definitions.\n\nModel. Consider a per-particle equation of state for pressure $P(T,V)$ of the form\n$$\nP(T,V) = \\frac{T}{V - b} - \\frac{a}{V^2} + \\frac{\\alpha\\,T}{V^m} + \\frac{\\beta\\,T^2}{V^n},\n$$\nwhere $T$ is temperature, $V$ is volume per particle, $a$ and $b$ are van der Waals-like attraction and excluded volume parameters, and $\\alpha$, $\\beta$, $m$, $n$ are additional material parameters that introduce temperature-dependent cohesive contributions motivated by effective attractions in a Lennard-Jones (LJ) solid/liquid. Use a model heat capacity at constant volume\n$$\nC_V(T) = c_0 + c_2\\,T^2,\n$$\nwhich is a smooth approximation capturing a low-temperature rise.\n\nObjectives. Your program must:\n- Starting from the fundamental thermodynamic identity and Maxwell relations, derive an implementable expression for the entropy differential in terms of a function $M(T,V)$ multiplying $dT$ and a function $N(T,V)$ multiplying $dV$.\n- For each test case, compute the entropy change between state $A:(T_0,V_0)$ and state $B:(T_1,V_1)$ along two paths:\n  1. Path $A\\to B$ via an isochoric segment followed by an isothermal segment.\n  2. Path $A\\to B$ via an isothermal segment followed by an isochoric segment.\n- For each test case, report:\n  1. The path dependence error defined as the difference between the two integrated entropy changes, ordered as “isochoric-then-isothermal” minus “isothermal-then-isochoric” (a float).\n  2. The closed-loop line integral of the entropy differential around the rectangle with corners $(T_0,V_0)\\to(T_1,V_0)\\to(T_1,V_1)\\to(T_0,V_1)\\to(T_0,V_0)$, traversed in that order (a float).\n  3. The area integral over the same rectangle of the integrability residual density that certifies exactness of the entropy differential, expressed purely in terms of derivatives of the functions $M(T,V)$ and $N(T,V)$ you derived (a float).\n  4. The value of that integrability residual density evaluated at the rectangle midpoint $(\\tfrac{T_0+T_1}{2},\\tfrac{V_0+V_1}{2})$ (a float).\n\nNumerical details.\n- All integrations must be performed numerically with reliable quadrature that achieves absolute tolerance better than $10^{-8}$.\n- Volumes must satisfy $Vb$ throughout to avoid singularities.\n- Work in reduced LJ units (dimensionless), and output floating-point numbers.\n\nTest suite. Use the following four test cases, each specified by the tuple $(a,b,\\alpha,m,\\beta,n,c_0,c_2,T_0,T_1,V_0,V_1)$, with all numbers in reduced LJ units:\n- Case 1 (baseline, no nonlinear temperature dependence in $P$): $(a,b,\\alpha,m,\\beta,n,c_0,c_2,T_0,T_1,V_0,V_1) = (\\,1.0,\\,0.3,\\,0.4,\\,3,\\,0.0,\\,4,\\,1.5,\\,0.1,\\,0.8,\\,1.4,\\,1.5,\\,2.0\\,)$.\n- Case 2 (moderate quadratic temperature term in $P$): $(\\,1.0,\\,0.3,\\,0.4,\\,3,\\,0.25,\\,4,\\,1.5,\\,0.1,\\,0.8,\\,1.4,\\,1.5,\\,2.0\\,)$.\n- Case 3 (near-excluded-volume regime, stronger nonlinearity): $(\\,0.8,\\,0.8,\\,0.3,\\,3,\\,0.5,\\,6,\\,1.2,\\,0.05,\\,0.7,\\,1.1,\\,0.95,\\,1.2\\,)$.\n- Case 4 (negative quadratic temperature term in $P$): $(\\,1.2,\\,0.5,\\,0.2,\\,3,\\,-0.3,\\,5,\\,1.6,\\,0.0,\\,0.9,\\,1.3,\\,1.2,\\,2.4\\,)$.\n\nFinal output format. Your program should produce a single line of output containing a JSON-like list of results, one entry per test case, where each entry is a list of the four floats in the order specified above. Each float must be rounded to eight decimal places. For example:\n\"[[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]]\"",
            "solution": "The solution first requires deriving the general form of the entropy differential, $dS$, and then applying it to the specific models provided.\n\n**1. Thermodynamic Derivation**\n\nThe total differential of entropy as a function of temperature and volume, $S(T,V)$, is $dS = (\\frac{\\partial S}{\\partial T})_V dT + (\\frac{\\partial S}{\\partial V})_T dV$.\nUsing the definition of heat capacity, $C_V = T(\\frac{\\partial S}{\\partial T})_V$, and the Maxwell relation from Helmholtz free energy, $(\\frac{\\partial S}{\\partial V})_T = (\\frac{\\partial P}{\\partial T})_V$, we arrive at the implementable form:\n$$ dS = \\frac{C_V(T)}{T} dT + \\left( \\frac{\\partial P}{\\partial T} \\right)_V dV $$\nThis is of the form $dS = M(T,V)dT + N(T,V)dV$.\n\n**2. Model Implementation**\n\nFor the given models, the functions $M$ and $N$ are:\n-   $M(T,V) = \\frac{C_V(T)}{T} = \\frac{c_0 + c_2 T^2}{T} = \\frac{c_0}{T} + c_2 T$.\n-   $N(T,V) = \\left( \\frac{\\partial P}{\\partial T} \\right)_V = \\frac{1}{V-b} + \\frac{\\alpha}{V^m} + \\frac{2\\beta T}{V^n}$.\n\nEntropy is a state function if its differential is exact, which requires the integrability condition $(\\frac{\\partial M}{\\partial V})_T = (\\frac{\\partial N}{\\partial T})_V$. Let's check this:\n-   $(\\frac{\\partial M}{\\partial V})_T = 0$.\n-   $(\\frac{\\partial N}{\\partial T})_V = \\frac{2\\beta}{V^n}$.\nThe condition is only met if $\\beta = 0$. When $\\beta \\neq 0$, $dS$ is an inexact differential, and the entropy change will be path-dependent.\n\n**3. Calculation of Required Quantities**\n\nThe four required quantities are all related to this path dependence.\n1.  **Path Dependence Error:** Calculated by integrating $dS$ along two different paths from $(T_0, V_0)$ to $(T_1, V_1)$ and taking the difference.\n2.  **Closed-Loop Integral:** By definition, this integral over the rectangular path is exactly equal to the path dependence error.\n3.  **Area Integral:** By Green's Theorem, this is the integral of the integrability residual, $R(T,V) = (\\frac{\\partial N}{\\partial T})_V - (\\frac{\\partial M}{\\partial V})_T = \\frac{2\\beta}{V^n}$, over the area of the rectangle. This must be numerically identical to the closed-loop integral.\n4.  **Midpoint Residual Density:** This is the value of the residual function $R(T,V)$ evaluated at the rectangle's midpoint.\n\nThe provided Python code implements these numerical integrations and evaluations for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the thermodynamic integration problem for the given test cases.\n\n    Derivations:\n    - Entropy differential: dS = (C_V/T)dT + (dP/dT)_V dV\n    - M(T,V) = C_V(T)/T = c0/T + c2*T\n    - N(T,V) = (dP/dT)_V = 1/(V-b) + alpha/V^m + 2*beta*T/V^n\n    - Integrability Residual R(T,V) = (dN/dT)_V - (dM/dV)_T = 2*beta/V^n\n    \"\"\"\n    test_cases = [\n        # (a,  b,   alpha, m, beta,  n, c0,   c2,   T0,  T1,   V0,   V1)\n        (1.0, 0.3, 0.4,   3, 0.0,   4, 1.5,  0.1,  0.8, 1.4,  1.5,  2.0),\n        (1.0, 0.3, 0.4,   3, 0.25,  4, 1.5,  0.1,  0.8, 1.4,  1.5,  2.0),\n        (0.8, 0.8, 0.3,   3, 0.5,   6, 1.2,  0.05, 0.7, 1.1,  0.95, 1.2),\n        (1.2, 0.5, 0.2,   3, -0.3,  5, 1.6,  0.0,  0.9, 1.3,  1.2,  2.4),\n    ]\n\n    all_results = []\n    TOL = 1e-9 # Absolute tolerance for integration, better than 1e-8\n\n    for case in test_cases:\n        a, b, alpha, m, beta, n, c0, c2, T0, T1, V0, V1 = case\n\n        # Define the component functions M and N for the differential dS = M dT + N dV\n        M = lambda T: c0 / T + c2 * T\n        N = lambda T, V: 1 / (V - b) + alpha / V**m + 2 * beta * T / V**n\n\n        # --- Path 1: Isochoric (V0) then Isothermal (T1) ---\n        # Integral of M(T, V0) from T0 to T1. M is independent of V.\n        delta_S_T1, _ = integrate.quad(M, T0, T1, epsabs=TOL)\n        # Integral of N(T1, V) from V0 to V1\n        delta_S_V1, _ = integrate.quad(lambda V: N(T1, V), V0, V1, epsabs=TOL)\n        delta_S_path1 = delta_S_T1 + delta_S_V1\n\n        # --- Path 2: Isothermal (T0) then Isochoric (V1) ---\n        # Integral of N(T0, V) from V0 to V1\n        delta_S_V2, _ = integrate.quad(lambda V: N(T0, V), V0, V1, epsabs=TOL)\n        # Integral of M(T, V1) from T0 to T1. Same as delta_S_T1.\n        delta_S_T2 = delta_S_T1\n        delta_S_path2 = delta_S_V2 + delta_S_T2\n\n        # 1. Path dependence error\n        path_dependence_error = delta_S_path1 - delta_S_path2\n\n        # 2. Closed-loop line integral\n        # Path: (T0,V0)->(T1,V0)->(T1,V1)->(T0,V1)->(T0,V0)\n        # This is mathematically equivalent to the path dependence error.\n        # Calculated explicitly: int_M(V0) + int_N(T1) - int_M(V1) - int_N(T0)\n        # Since M is V-independent, int_M(V0) = int_M(V1).\n        # So it simplifies to int_N(T1) - int_N(T0), which is delta_S_V1 - delta_S_V2.\n        # This matches the calculation for path_dependence_error.\n        closed_loop_integral = path_dependence_error\n\n        # 3. Area integral of the integrability residual\n        # Residual R(T,V) = (dN/dT)_V - (dM/dV)_T = 2*beta/V^n\n        # The integral is over the rectangle [T0,T1] x [V0,V1]\n        integrand_R = lambda V, T: 2 * beta / V**n # dblquad expects f(y,x), here y=V,x=T\n        \n        # dblquad integrates func(y, x) dy dx. Here, y=V, x=T.\n        # So we integrate R(V,T) dV dT\n        area_integral, _ = integrate.dblquad(integrand_R, T0, T1, V0, V1, epsabs=TOL)\n        # As per Green's theorem, this must equal the closed-loop integral.\n\n        # 4. Integrability residual density at the midpoint\n        V_mid = (V0 + V1) / 2.0\n        T_mid = (T0 + T1) / 2.0 # Not needed as R is T-independent, but good practice\n        \n        if n > 0 : # to avoid 0**0 if V_mid happens to be 0\n            midpoint_residual = 2 * beta / V_mid**n\n        else: # Handle n = 0, although not in test cases\n            midpoint_residual = 2 * beta * V_mid**(-n)\n\n\n        results_for_case = [\n            path_dependence_error,\n            closed_loop_integral,\n            area_integral,\n            midpoint_residual\n        ]\n        all_results.append(results_for_case)\n\n    # Format the output string as a JSON-like list of lists of floats\n    output_strings = []\n    for result_set in all_results:\n        formatted_set = [f\"{val:.8f}\" for val in result_set]\n        output_strings.append(f\"[{','.join(formatted_set)}]\")\n    \n    final_output = f\"[{','.join(output_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "In practical simulations, we often calculate various material properties, such as heat capacities, elastic moduli, and thermal expansion coefficients, through different methods or independent simulation runs. Thermodynamics provides a powerful framework of identities that these properties must collectively satisfy, offering a crucial consistency check on our results. This practice challenges you to verify two such famous relations: the equality of the heat capacity ratio and compressibility ratio ($C_P/C_V = \\kappa_T/\\kappa_S$), and the general relation connecting the heat capacity difference $C_P - C_V$ to thermal expansion and compressibility . By working with a hypothetical dataset mimicking output from molecular dynamics, you will gain experience in applying thermodynamic calculus and appreciate its role in validating computational data.",
            "id": "3491743",
            "problem": "You are given three independent parameter sets that emulate postprocessed outputs from Molecular Dynamics simulations of isotropic materials, at well-defined thermodynamic states. Your task is to derive, implement, and numerically verify two thermodynamic identities relating heat capacities, compressibilities, and thermal expansion, using only fundamental definitions and well-tested base relations. You must express all intermediate and final computations in the International System of Units (SI). The program must compute results for the provided test suite and print them as specified.\n\nBase definitions and relations you may use:\n- Isothermal compressibility: $\\kappa_T \\equiv -\\dfrac{1}{V}\\left(\\dfrac{\\partial V}{\\partial P}\\right)_T$.\n- Adiabatic compressibility: $\\kappa_S \\equiv -\\dfrac{1}{V}\\left(\\dfrac{\\partial V}{\\partial P}\\right)_S$.\n- Isothermal bulk modulus: $B_T \\equiv \\dfrac{1}{\\kappa_T}$, adiabatic bulk modulus: $B_S \\equiv \\dfrac{1}{\\kappa_S}$.\n- Heat capacities: $C_V \\equiv T\\left(\\dfrac{\\partial S}{\\partial T}\\right)_V$, $C_P \\equiv T\\left(\\dfrac{\\partial S}{\\partial T}\\right)_P$.\n- Coefficient of thermal expansion: $\\alpha \\equiv \\dfrac{1}{V}\\left(\\dfrac{\\partial V}{\\partial T}\\right)_P$.\n- Maxwell relation from the Gibbs free energy $G$: $\\left(\\dfrac{\\partial S}{\\partial P}\\right)_T = -\\left(\\dfrac{\\partial V}{\\partial T}\\right)_P$.\n- Acoustic relation for an isotropic continuum (long-wavelength longitudinal sound): $c_s^2 = \\left(\\dfrac{\\partial P}{\\partial \\rho}\\right)_S = \\dfrac{B_S}{\\rho}$, where $\\rho$ is the mass density.\n\nFrom the above base, you must implement the following, without assuming any further unproven shortcut formulas as given:\n1. Compute the mass density as $\\rho = \\dfrac{M}{V_m}$, where $M$ is the molar mass and $V_m$ is the molar volume.\n2. Compute the adiabatic bulk modulus $B_S = \\rho\\,c_s^2$ and hence the adiabatic compressibility $\\kappa_S = \\dfrac{1}{B_S}$.\n3. Using only quantities defined above, compute two independent ratios:\n   - $\\gamma_{\\kappa} \\equiv \\dfrac{\\kappa_T}{\\kappa_S}$.\n   - $\\gamma_{C} \\equiv \\dfrac{C_P}{C_V}$.\n4. Independently form the heat-capacity difference from measurable response functions:\n   - Left-hand side: $\\Delta_C^{\\text{meas}} \\equiv C_P - C_V$.\n   - Right-hand side constructed from $T$, $V_m$, $\\alpha$, and $\\kappa_T$ using only the base definitions and Maxwell relation listed above. Denote this by $\\Delta_C^{\\text{rhs}}$.\n5. Quantify the agreement by reporting:\n   - The absolute difference $|\\gamma_{\\kappa} - \\gamma_{C}|$ as a float.\n   - The absolute difference $|\\Delta_C^{\\text{meas}} - \\Delta_C^{\\text{rhs}}|$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ as a float.\n   - Two booleans indicating whether each difference is within the specified tolerances below.\n\nNumerical and unit requirements:\n- Use SI units consistently:\n  - Temperature $T$ in $\\mathrm{K}$.\n  - Molar mass $M$ in $\\mathrm{kg}\\,\\mathrm{mol}^{-1}$.\n  - Molar volume $V_m$ in $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}$.\n  - Coefficient of thermal expansion $\\alpha$ in $\\mathrm{K}^{-1}$.\n  - Isothermal compressibility $\\kappa_T$ in $\\mathrm{Pa}^{-1}$.\n  - Sound speed $c_s$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n  - Heat capacities $C_P$, $C_V$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- Tolerances:\n  - For the ratio check, accept if $|\\gamma_{\\kappa} - \\gamma_{C}| \\leq 5\\times 10^{-3}$.\n  - For the heat-capacity-difference check, accept if $|\\Delta_C^{\\text{meas}} - \\Delta_C^{\\text{rhs}}| \\leq 2\\times 10^{-3}$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nTest suite (each line is one test case; all quantities are given in SI units as specified above):\n- Case A (metal-like solid): $T = 300$, $M = 0.063546$, $V_m = 7.09\\times 10^{-6}$, $\\alpha = 4.9\\times 10^{-5}$, $\\kappa_T = 7.14\\times 10^{-12}$, $c_s = 4008.5$, $C_V = 24.4$, $C_P = 25.115$.\n- Case B (liquid-like): $T = 298$, $M = 0.018015$, $V_m = 1.806\\times 10^{-5}$, $\\alpha = 2.57\\times 10^{-4}$, $\\kappa_T = 4.6\\times 10^{-10}$, $c_s = 1484.3$, $C_V = 74.5$, $C_P = 75.272$.\n- Case C (near-Invar-like solid): $T = 300$, $M = 0.058$, $V_m = 7.0\\times 10^{-6}$, $\\alpha = 1.0\\times 10^{-6}$, $\\kappa_T = 5.0\\times 10^{-12}$, $c_s = 4913.2$, $C_V = 25.0$, $C_P = 25.00042$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list with three elements, one per test case, in the same order as listed above.\n- Each element must itself be a list containing six entries in the following order:\n  1. $\\gamma_{\\kappa}$ as a float.\n  2. $\\gamma_{C}$ as a float.\n  3. $|\\gamma_{\\kappa} - \\gamma_{C}|$ as a float.\n  4. $|\\Delta_C^{\\text{meas}} - \\Delta_C^{\\text{rhs}}|$ as a float in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n  5. A boolean for whether the ratio check passed the tolerance.\n  6. A boolean for whether the heat-capacity-difference check passed the tolerance.\n- Example of the required print format shape (illustrative structure only): \"[[valA1,valA2,valA3,valA4,boolA5,boolA6],[valB1,valB2,valB3,valB4,boolB5,boolB6],[valC1,valC2,valC3,valC4,boolC5,boolC6]]\".",
            "solution": "The solution requires verifying two fundamental thermodynamic identities using the provided material properties. The primary theoretical task is to derive the expression for the heat capacity difference, $C_P - C_V$, from the given base definitions. All calculations are performed in SI units.\n\n**1. Derivation of the Heat Capacity Difference Identity**\n\nWe start by considering entropy as a function of temperature and pressure, $S(T,P)$. Its total differential is $dS = (\\frac{\\partial S}{\\partial T})_P dT + (\\frac{\\partial S}{\\partial P})_T dP$. By dividing by $dT$ at constant volume and multiplying by $T$, we get:\n$$ T\\left(\\frac{\\partial S}{\\partial T}\\right)_V = T\\left(\\frac{\\partial S}{\\partial T}\\right)_P + T\\left(\\frac{\\partial S}{\\partial P}\\right)_T \\left(\\frac{\\partial P}{\\partial T}\\right)_V $$\nUsing the definitions $C_V = T(\\partial S/\\partial T)_V$ and $C_P = T(\\partial S/\\partial T)_P$, this becomes:\n$$ C_V = C_P + T\\left(\\frac{\\partial S}{\\partial P}\\right)_T \\left(\\frac{\\partial P}{\\partial T}\\right)_V $$\nRearranging for the difference gives $C_P - C_V = -T \\left(\\frac{\\partial S}{\\partial P}\\right)_T \\left(\\frac{\\partial P}{\\partial T}\\right)_V$.\n\nWe now replace the partial derivatives with measurable quantities.\n- Using the provided Maxwell relation: $\\left(\\frac{\\partial S}{\\partial P}\\right)_T = -\\left(\\frac{\\partial V}{\\partial T}\\right)_P = -V_m \\alpha$.\n- Using the cyclic chain rule, $\\left(\\frac{\\partial P}{\\partial T}\\right)_V = -\\frac{(\\partial V/\\partial T)_P}{(\\partial V/\\partial P)_T}$. From the definitions of $\\alpha$ and $\\kappa_T$, this becomes $\\frac{V_m \\alpha}{V_m \\kappa_T} = \\frac{\\alpha}{\\kappa_T}$.\n\nSubstituting these into the equation for the difference yields the well-known identity:\n$$ \\Delta_C^{\\text{rhs}} = C_P - C_V = T (V_m \\alpha) \\left(\\frac{\\alpha}{\\kappa_T}\\right) = \\frac{T V_m \\alpha^2}{\\kappa_T} $$\n\n**2. Computational Procedure**\n\nFor each test case, the program will:\n1.  Calculate the mass density $\\rho = M/V_m$.\n2.  Calculate the adiabatic compressibility $\\kappa_S$ from the sound speed via $\\kappa_S = 1/B_S = 1/(\\rho c_s^2)$.\n3.  Compute the two ratios $\\gamma_{\\kappa} = \\kappa_T/\\kappa_S$ and $\\gamma_C = C_P/C_V$ and their absolute difference. This tests the identity $C_P/C_V = \\kappa_T/\\kappa_S$.\n4.  Compute the measured difference $\\Delta_C^{\\text{meas}} = C_P - C_V$ and the calculated right-hand-side $\\Delta_C^{\\text{rhs}} = T V_m \\alpha^2 / \\kappa_T$ and their absolute difference.\n5.  Evaluate the boolean checks based on the specified tolerances.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermodynamic identity verification problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains: T, M, Vm, alpha, kappa_T, cs, CV, CP in SI units.\n    test_cases = [\n        # Case A (metal-like solid)\n        (300, 0.063546, 7.09e-6, 4.9e-5, 7.14e-12, 4008.5, 24.4, 25.115),\n        # Case B (liquid-like)\n        (298, 0.018015, 1.806e-5, 2.57e-4, 4.6e-10, 1484.3, 74.5, 75.272),\n        # Case C (near-Invar-like solid)\n        (300, 0.058, 7.0e-6, 1.0e-6, 5.0e-12, 4913.2, 25.0, 25.00042)\n    ]\n\n    results = []\n    \n    # Tolerances for the checks\n    tolerance_gamma = 5e-3\n    tolerance_delta_c = 2e-3\n\n    for case in test_cases:\n        T, M, Vm, alpha, kappa_T, cs, CV, CP = case\n\n        # 1. Compute mass density rho\n        rho = M / Vm\n\n        # 2. Compute adiabatic bulk modulus B_S and compressibility kappa_S\n        B_S = rho * cs**2\n        kappa_S = 1 / B_S\n\n        # 3. Compute the two ratios gamma_kappa and gamma_C\n        gamma_kappa = kappa_T / kappa_S\n        gamma_C = CP / CV\n\n        # 4. Compute the heat-capacity differences\n        delta_c_meas = CP - CV\n        delta_c_rhs = (T * Vm * alpha**2) / kappa_T\n\n        # 5. Quantify agreement\n        diff_gamma = abs(gamma_kappa - gamma_C)\n        diff_delta_c = abs(delta_c_meas - delta_c_rhs)\n\n        # Boolean checks against tolerances\n        gamma_check_passed = diff_gamma = tolerance_gamma\n        delta_c_check_passed = diff_delta_c = tolerance_delta_c\n\n        # Append results for this case\n        case_results = [\n            gamma_kappa,\n            gamma_C,\n            diff_gamma,\n            diff_delta_c,\n            gamma_check_passed,\n            delta_c_check_passed\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is very close to the requirement.\n    # We remove whitespace to match the specified compact format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}