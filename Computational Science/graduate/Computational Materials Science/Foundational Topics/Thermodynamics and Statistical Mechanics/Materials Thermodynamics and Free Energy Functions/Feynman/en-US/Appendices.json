{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of computational materials design is predicting the ground-state stability of new compounds. This practice guides you through the process of constructing a binary phase diagram at zero temperature by applying the convex hull construction to a set of formation energies, a method central to high-throughput materials discovery . By identifying the stable phases and determining the decomposition pathway for metastable ones, you will gain hands-on experience with the primary tool for assessing thermodynamic stability from first-principles data.",
            "id": "3464640",
            "problem": "You are given two independent binary composition–energy datasets for an A–B system. Each dataset lists phases at composition $x \\in [0,1]$ with Density Functional Theory (DFT) formation energies $E$ (in $\\mathrm{eV/atom}$) referenced to the pure elements. The goal is to construct the equilibrium zero-temperature free energy envelope by convexification, compute the energy above the convex hull for every phase, and determine the decomposition products for all metastable phases.\n\nFundamental base to use:\n- At zero temperature, the relevant thermodynamic potential for phase stability at fixed composition is the internal energy (for solids, the Helmholtz free energy reduces to the internal energy), and in practice one uses DFT formation energies $E(x)$ as a proxy for the free energy.\n- The equilibrium envelope at fixed composition results from allowing mechanical mixtures of phases. For a mixture of phases at compositions $x_1, x_2, \\dots, x_n$ with nonnegative fractions $\\lambda_1, \\lambda_2, \\dots, \\lambda_n$ that sum to $1$, the accessible composition and energy satisfy $x = \\sum_{i=1}^n \\lambda_i x_i$ and $E_{\\mathrm{mix}}(x) = \\sum_{i=1}^n \\lambda_i E(x_i)$. The stable energy function is the lower convex envelope of the discrete $E(x)$ data.\n- In a binary system at zero temperature, the equilibrium mixture at a general composition $x$ involves at most two phases (Carathéodory’s theorem in one dimension), except for degenerate flat facets where three or more collinear vertices share an identical common tangent. In such degenerate cases, multiple equivalent mixtures exist.\n\nDefinitions and requirements:\n- The lower convex hull is the piecewise-linear function obtained by convexifying the set of points $\\{(x_i,E_i)\\}$; it lies at or below all points and is convex. A phase lies on the hull if its point is on the lower convex envelope; otherwise, it is metastable.\n- The energy above hull for phase $i$ is $\\Delta E_i = E_i - E_{\\mathrm{hull}}(x_i)$ in $\\mathrm{eV/atom}$.\n- For a metastable phase at composition $x_i$ strictly between two adjacent hull vertices at $x_L$ and $x_R$, the two-phase decomposition is determined by the lever rule with fractions $f_L = \\dfrac{x_R - x_i}{x_R - x_L}$ and $f_R = \\dfrac{x_i - x_L}{x_R - x_L}$.\n- Special canonical three-phase rule for degenerate flat facets: If a metastable phase has composition $x_M$ equal to a hull vertex that is an interior vertex of a flat facet consisting of three consecutive collinear hull vertices at $(x_L,E_L)$, $(x_M,E_M)$, $(x_R,E_R)$ with identical slope on both sides, then report the canonical three-phase decomposition using those three vertices with fractions\n$$\nt = \\frac{1}{2\\,(x_R - x_L)},\\quad\nc_L = t\\,(x_R - x_M),\\quad\nc_M = 1 - t\\,(x_R - x_L),\\quad\nc_R = t\\,(x_M - x_L),\n$$\nwhich yields strictly positive $c_L$, $c_M$, and $c_R$ that sum to $1$. In all other cases where $x_i$ equals a hull vertex, report a two-phase decomposition using the adjacent hull segment with one fraction equal to zero.\n\nAlgorithmic mandates:\n- Deduplicate identical compositions by keeping only the lowest energy per $x$ when constructing the hull; however, energies above hull and decompositions must be reported for every input phase in the original order.\n- Use a numerical tolerance for collinearity and equality checks of $\\varepsilon = 10^{-8}$ in composition and slope comparisons, and $\\tau = 10^{-12}$ for energy-above-hull stability checks.\n- All energies must be reported in $\\mathrm{eV/atom}$ rounded to six decimal places. Angles are not involved. Percentages are not involved; all fractions must be decimal numbers.\n\nTest suite:\n- Test Case $1$ (index mapping shown as the order listed, indices start at $0$):\n  - Phases:\n    - Index $0$: $x=0$, $E=0$ (pure A).\n    - Index $1$: $x=1$, $E=0$ (pure B).\n    - Index $2$: $x=0.25$, $E=-0.05$ (A$_3$B).\n    - Index $3$: $x=\\dfrac{1}{3} \\approx 0.3333333333$, $E=-0.06$ (A$_2$B).\n    - Index $4$: $x=0.5$, $E=-0.08$ (AB).\n    - Index $5$: $x=\\dfrac{2}{3} \\approx 0.6666666667$, $E=-0.07$ (AB$_2$).\n    - Index $6$: $x=0.75$, $E=-0.02$ (AB$_3$).\n    - Index $7$: $x=\\dfrac{1}{3} \\approx 0.3333333333$, $E=-0.055$ (metastable duplicate at $x=\\dfrac{1}{3}$).\n    - Index $8$: $x=0.2$, $E=0.01$ (metastable A-rich).\n- Test Case $2$ (indices start at $0$ for this case):\n  - Phases:\n    - Index $0$: $x=0$, $E=0$ (pure A).\n    - Index $1$: $x=1$, $E=0$ (pure B).\n    - Index $2$: $x=0.5$, $E=0$ (stable intermediate).\n    - Index $3$: $x=0.25$, $E=0.02$ (metastable).\n    - Index $4$: $x=0.75$, $E=0.01$ (metastable).\n    - Index $5$: $x=0.5$, $E=0.0001$ (metastable duplicate at $x=0.5$).\n\nRequired outputs for each test case:\n- For each test case, produce a pair of lists $[L_{\\Delta E}, L_{\\mathrm{dec}}]$.\n  - $L_{\\Delta E}$ is the list of energies above hull for all phases in the input order, each rounded to six decimal places in $\\mathrm{eV/atom}$.\n  - $L_{\\mathrm{dec}}$ is the list of decomposition products for all phases in the input order, where each entry is:\n    - An empty list $[\\,]$ if the phase lies on the convex hull (stable) within tolerance.\n    - A two-phase list $[i_L, f_L, i_R, f_R]$ of integers and floats for metastable phases that decompose into two hull vertices at indices $i_L$ and $i_R$ with fractions $f_L$ and $f_R$, respectively.\n    - A three-phase list $[i_L, f_L, i_M, f_M, i_R, f_R]$ for the special canonical three-phase case described above, with indices $i_L$, $i_M$, and $i_R$ of the three collinear hull vertices and fractions $f_L$, $f_M$, and $f_R$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces. Concretely, the two test case results must be aggregated into one top-level list in the form\n$[ \\text{result\\_case\\_1}, \\text{result\\_case\\_2} ]$\nwhere each $\\text{result\\_case\\_k}$ is itself the pair $[L_{\\Delta E}, L_{\\mathrm{dec}}]$ as specified. All numbers must be printed as plain decimals; indexing is by integer positions defined above. For example, the printed structure must look like $[[\\dots],[\\dots]]$ with no spaces anywhere.",
            "solution": "The user has provided a computational materials science problem that requires determining phase stability at zero temperature for a binary system. This involves constructing the lower convex hull of a set of formation energy data points, calculating the energy above the hull for each phase, and identifying the decomposition products for any metastable phases.\n\n### Step 1: Problem Validation\n\nI will first validate the problem statement against the required criteria.\n\n**Givens Extraction:**\n-   **System**: A binary A-B system at $T=0\\,K$.\n-   **Data**: Two sets of phases, each defined by a composition $x \\in [0,1]$ and a DFT formation energy $E$ in $\\mathrm{eV/atom}$.\n-   **Thermodynamic Principle**: At $T=0\\,K$, the stable energy as a function of composition, $E_{\\mathrm{hull}}(x)$, is the lower convex envelope of the discrete set of formation energies $\\{(x_i, E_i)\\}$.\n-   **Energy Above Hull**: For a given phase $i$ with energy $E_i$ at composition $x_i$, the energy above hull is $\\Delta E_i = E_i - E_{\\mathrm{hull}}(x_i)$.\n-   **Two-Phase Decomposition**: A metastable phase at $(x_i, E_i)$ where $x_L  x_i  x_R$ for adjacent hull vertices $L$ and $R$, decomposes into those two phases. The fractions are given by the lever rule: $f_L = \\frac{x_R - x_i}{x_R - x_L}$ and $f_R = \\frac{x_i - x_L}{x_R - x_L}$.\n-   **Canonical Three-Phase Decomposition**: A special rule applies if a metastable phase's composition $x_M$ matches that of an interior hull vertex of a three-vertex collinear facet defined by $(x_L,E_L), (x_M,E_M), (x_R,E_R)$. The decomposition products are these three hull vertices with fractions given by the provided formulas: $t = \\frac{1}{2\\,(x_R - x_L)}$, $c_L = t\\,(x_R - x_M)$, $c_M = 1 - t\\,(x_R - x_L)$, $c_R = t\\,(x_M - x_L)$.\n-   **Other Decomposition Cases**: If a phase's composition matches a hull vertex but the three-phase rule does not apply, a two-phase decomposition is reported, which naturally results from the lever rule with one fraction being zero or one.\n-   **Algorithmic Rules**:\n    1.  When building the convex hull, use only the lowest-energy phase for any given composition.\n    2.  Report results ($\\Delta E_i$ and decomposition) for all input phases in their original order.\n    3.  Use a numerical tolerance $\\varepsilon = 10^{-8}$ for composition and slope equality checks.\n    4.  Use a numerical tolerance $\\tau = 10^{-12}$ for determining stability (i.e., a phase is stable if $\\Delta E_i  \\tau$).\n    5.  Report energies rounded to six decimal places.\n\n**Validation Assessment:**\n-   **Scientific Grounding**: The problem is fundamentally sound. The use of the convex hull construction on formation energies is a cornerstone of computational thermodynamics for predicting ground-state phase stability in materials. All principles cited are standard in the field.\n-   **Well-Posedness**: The problem is well-posed. The inputs, required outputs, and the algorithm constraints are specified with high precision. Ambiguities are resolved by explicit rules, such as the handling of duplicate compositions, the specific canonical three-phase decomposition, and numerical tolerances. This detailed specification ensures a unique solution can be algorithmically determined.\n-   **Objectivity**: The problem statement is objective, using formal and quantitative language devoid of subjectivity or opinion.\n\nThe problem does not exhibit any of the listed invalidity flaws (e.g., scientific unsoundness, incompleteness, contradiction, or vagueness).\n\n**Verdict**: The problem is valid.\n\n### Step 2: Solution Algorithm Design\n\nI will design an algorithm based on the validated problem statement. The overall process for each test case is as follows:\n\n1.  **Preprocessing**:\n    -   Store the input phases along with their original indices, for instance, as a list of tuples `(x, E, original_index)`.\n    -   To prepare for hull construction, create a working set of points. Iterate through the input phases and, for each unique composition $x$, retain only the phase with the minimum energy $E$. This can be efficiently done using a dictionary. This working set will also store the original index of the lowest-energy phase at each composition.\n\n2.  **Convex Hull Construction**:\n    -   Sort the deduplicated working set of points by composition $x$ in ascending order.\n    -   Construct the lower convex hull of these points. A standard method like the Monotone Chain algorithm (or Andrew's algorithm) is suitable. It processes the sorted points and maintains a list of vertices for the lower hull, ensuring that each new point added maintains the convexity property (a \"left turn\" or collinear extension).\n    -   The convexity check for three points $p_1(x_1, E_1)$, $p_2(x_2, E_2)$, and $p_3(x_3, E_3)$ sorted by $x$ involves comparing the slope of segment $(p_1, p_2)$ to that of $(p_2, p_3)$. For a lower convex hull, the slope must be non-decreasing. To avoid floating-point division issues, a cross-product-based check is more robust: $(x_2 - x_1)(E_3 - E_2) - (E_2 - E_1)(x_3 - x_2) \\ge -tol$, where $tol$ is a scaled tolerance derived from $\\varepsilon$. Points that violate this condition (create a \"right turn\") are removed from the hull. The resulting list of points constitutes the vertices of the lower convex hull.\n\n3.  **Calculation of $\\Delta E$ and Decompositions**:\n    -   Iterate through all original input phases, in their initial order.\n    -   For each phase $i$ at $(x_i, E_i)$:\n        a.  **Find Hull Energy**: Determine the energy on the convex hull at composition $x_i$, denoted $E_{\\mathrm{hull}}(x_i)$. This requires finding the two adjacent hull vertices, $(x_L, E_L)$ and $(x_R, E_R)$, that bracket $x_i$ (i.e., $x_L \\le x_i \\le x_R$). This can be done efficiently using `numpy.searchsorted` on the x-coordinates of the hull vertices. $E_{\\mathrm{hull}}(x_i)$ is then found by linear interpolation between these two vertices.\n        b.  **Calculate $\\Delta E_i$**: Compute the energy above the hull as $\\Delta E_i = E_i - E_{\\mathrm{hull}}(x_i)$.\n        c.  **Determine Stability and Decomposition**:\n            -   If $\\Delta E_i  \\tau$ (with $\\tau=10^{-12}$), the phase is stable. Its decomposition product is an empty list.\n            -   If $\\Delta E_i \\geq \\tau$, the phase is metastable. Its decomposition must be determined:\n                i.  **Check for Special 3-Phase Case**: This case applies if the phase's composition $x_i$ matches the composition $x_M$ of a hull vertex (within tolerance $\\varepsilon$), and this hull vertex is an interior point of a three-vertex collinear segment on the hull. This is checked by finding the hull vertex $H_M$ at $x_M \\approx x_i$ and checking if its neighbors $H_L$ and $H_R$ are collinear with it (i.e., $|slope(H_L, H_M) - slope(H_M, H_R)|  \\varepsilon$). If so, the decomposition is into these three phases ($H_L, H_M, H_R$) with fractions calculated using the special formulas provided.\n                ii. **Default 2-Phase Case**: If the special 3-phase condition is not met, the decomposition is into the two hull vertices $(x_L, E_L)$ and $(x_R, E_R)$ that define the hull segment below $(x_i, E_i)$. The fractions are calculated using the lever rule. This case naturally handles phases whose compositions coincide with a hull vertex but do not meet the collinearity criterion; the lever rule will yield one fraction as $1.0$ and the other as $0.0$.\n\n4.  **Output Formatting**:\n    -   Collect the calculated $\\Delta E_i$ values for all phases, rounding each to six decimal places.\n    -   Collect the decomposition information for all phases.\n    -   Format these two lists into the specified pair format `[L_delta_E, L_dec]`.\n    -   Aggregate the results from all test cases into a single list and print as a compact JSON-like string with no whitespace, as per the problem's strict formatting requirements.",
            "answer": "```python\nimport numpy as np\nimport sys\nfrom typing import List, Tuple, Dict, Any\n\n# Define global constants from the problem statement\nEPS_COMP_SLOPE = 1e-8\nTAU_ENERGY = 1e-12\n\ndef process_case(phases_data: List[Tuple[float, float]]) - List[Any]:\n    \"\"\"\n    Processes a single test case to find energies above hull and decompositions.\n    \"\"\"\n    # Augment phases with their original index\n    phases_with_indices = [(x, E, i) for i, (x, E) in enumerate(phases_data)]\n\n    # 1. Preprocessing: Deduplicate by composition, keeping the lowest energy phase\n    lowest_energy_at_x: Dict[float, Tuple[float, float, int]] = {}\n    for x, E, i in phases_with_indices:\n        # Use a tolerance for composition keying\n        rounded_x = round(x / EPS_COMP_SLOPE) * EPS_COMP_SLOPE\n        if rounded_x not in lowest_energy_at_x or E  lowest_energy_at_x[rounded_x][1]:\n            lowest_energy_at_x[rounded_x] = (x, E, i)\n\n    points_for_hull = sorted(lowest_energy_at_x.values(), key=lambda p: p[0])\n\n    # 2. Convex Hull Construction (Andrew's monotone chain for lower hull)\n    hull: List[Tuple[float, float, int]] = []\n    for p in points_for_hull:\n        while len(hull) = 2:\n            p1, p2 = hull[-2], hull[-1]\n            # Cross-product check for right turn (pop if so)\n            # (x2-x1)*(y3-y2) - (y2-y1)*(x3-x1)  tolerance\n            # Using scaled tolerance for cross-product\n            # Check if slope(p1,p2)  slope(p2,p)\n            x1, E1, _ = p1\n            x2, E2, _ = p2\n            x3, E3, _ = p\n            # Avoid division by zero if compositions are identical (should not happen after dedupe)\n            if abs(x2-x1)  EPS_COMP_SLOPE or abs(x3-x2)  EPS_COMP_SLOPE:\n                break # Cannot determine slope, keep point\n            if (E2 - E1) * (x3 - x2)  (E3 - E2) * (x2 - x1) + EPS_COMP_SLOPE * (x2 - x1) * (x3 - x2):\n                hull.pop()\n            else:\n                break\n        hull.append(p)\n        \n    hull_x = np.array([p[0] for p in hull])\n    hull_E = np.array([p[1] for p in hull])\n    hull_indices = [p[2] for p in hull]\n\n    # 3. Calculate Delta_E and Decompositions for all original phases\n    L_delta_E: List[float] = []\n    L_dec: List[List] = []\n\n    for i, (xi, Ei) in enumerate(phases_data):\n        # Find hull segment [L, R] that brackets xi\n        idx_R = np.searchsorted(hull_x, xi, side='right')\n        # Handle edge cases where xi is an endpoint\n        if idx_R == len(hull_x):\n            idx_R = len(hull_x) - 1\n        if idx_R == 0:\n            idx_R = 1\n        \n        idx_L = idx_R - 1\n        \n        x_L, E_L, i_L = hull[idx_L]\n        x_R, E_R, i_R = hull[idx_R]\n\n        # Calculate E_hull(xi) by linear interpolation\n        if abs(x_R - x_L)  EPS_COMP_SLOPE: # Vertical segment or point\n            E_hull_i = E_L if xi = x_L else E_R\n        else:\n            E_hull_i = E_L + (E_R - E_L) * (xi - x_L) / (x_R - x_L)\n        \n        delta_E = Ei - E_hull_i\n        L_delta_E.append(delta_E)\n\n        # Determine stability and decomposition\n        if delta_E  TAU_ENERGY:\n            L_dec.append([])\n            continue\n\n        # Metastable phase: check for 3-phase rule\n        is_3_phase = False\n        try:\n            # Find if xi matches a hull vertex composition\n            match_idx = np.where(np.abs(hull_x - xi)  EPS_COMP_SLOPE)[0]\n            if len(match_idx)  0:\n                j = match_idx[0]\n                if 0  j  len(hull) - 1:\n                    # Check for collinearity of H[j-1], H[j], H[j+1]\n                    x_prev, E_prev, _ = hull[j-1]\n                    x_mid, E_mid, _ = hull[j]\n                    x_next, E_next, _ = hull[j+1]\n\n                    s1 = (E_mid - E_prev) / (x_mid - x_prev)\n                    s2 = (E_next - E_mid) / (x_next - x_mid)\n                    \n                    if abs(s1 - s2)  EPS_COMP_SLOPE:\n                        is_3_phase = True\n                        i_L3, i_M3, i_R3 = hull[j-1][2], hull[j][2], hull[j+1][2]\n                        t = 1.0 / (2.0 * (x_next - x_prev))\n                        c_L = t * (x_next - x_mid)\n                        c_M = 1.0 - t * (x_next - x_prev)\n                        c_R = t * (x_mid - x_prev)\n                        L_dec.append([i_L3, c_L, i_M3, c_M, i_R3, c_R])\n        except (ValueError, IndexError, ZeroDivisionError):\n            pass\n\n        if not is_3_phase:\n            # Standard 2-phase decomposition\n            if abs(x_R - x_L)  EPS_COMP_SLOPE: # Should not happen for metastable point\n                 f_L, f_R = (1.0, 0.0) if xi = x_L else (0.0, 1.0)\n            else:\n                f_R = (xi - x_L) / (x_R - x_L)\n                f_L = 1.0 - f_R\n            L_dec.append([i_L, f_L, i_R, f_R])\n\n    return [L_delta_E, L_dec]\n\ndef format_result(result_pair: List[Any]) - str:\n    \"\"\"Formats the result pair into the required string representation.\"\"\"\n    l_de = result_pair[0]\n    l_dec = result_pair[1]\n\n    # Format L_delta_E with 6 decimal places\n    de_strs = [f\"{x:.6f}\" for x in l_de]\n    de_str = f\"[{','.join(de_strs)}]\"\n\n    # Format L_dec\n    dec_item_strs = []\n    for item in l_dec:\n        if not item:\n            dec_item_strs.append(\"[]\")\n        else:\n            sub_items = []\n            for sub_item in item:\n                if isinstance(sub_item, int):\n                    sub_items.append(str(sub_item))\n                else: # float\n                    sub_items.append(repr(sub_item))\n            dec_item_strs.append(f\"[{','.join(sub_items)}]\")\n    dec_str = f\"[{','.join(dec_item_strs)}]\"\n\n    return f\"[{de_str},{dec_str}]\"\n    \ndef solve():\n    \"\"\"\n    Main function to run test cases and print output.\n    \"\"\"\n    # Define test cases from the problem statement\n    test_cases = [\n        [\n            (0.0, 0.0), (1.0, 0.0), (0.25, -0.05), (1/3, -0.06), \n            (0.5, -0.08), (2/3, -0.07), (0.75, -0.02), (1/3, -0.055),\n            (0.2, 0.01)\n        ],\n        [\n            (0.0, 0.0), (1.0, 0.0), (0.5, 0.0), (0.25, 0.02),\n            (0.75, 0.01), (0.5, 0.0001)\n        ]\n    ]\n\n    results_as_strings = []\n    for case_data in test_cases:\n        result = process_case(case_data)\n        results_as_strings.append(format_result(result))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "While ground-state calculations are crucial, real-world materials exist at finite temperatures where entropy plays a decisive role. This exercise delves into constructing the Helmholtz free energy $F(T)$ from microscopic principles, combining static lattice energies with vibrational and configurational entropy contributions . By comparing the free energy of a crystalline phase with that of an amorphous solid, you will predict the crossover temperature where the entropically-favored disordered state becomes thermodynamically preferred, a core concept in the study of glasses and high-temperature materials.",
            "id": "3464555",
            "problem": "You are asked to programmatically construct the temperature-dependent Helmholtz free energy $F(T)$ of an amorphous phase using an inherent-structure enumeration model that includes both harmonic vibrational and configurational contributions, and to compare it with a crystalline phase free energy to predict the glass–crystal crossover. Work within the canonical ensemble and the harmonic approximation. The derivation must start from the canonical partition function, harmonic oscillator energy levels, and standard definitions of thermodynamic potentials. All quantities must be handled per atom and expressed in precise physical units.\n\nFundamental base to use:\n- The canonical partition function $Z$ for a system with discrete microstates.\n- The definition of Helmholtz free energy $F(T)$ as $F(T) = -k_{\\mathrm{B}} T \\ln Z$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- The energy levels of a quantum harmonic oscillator with angular frequency $\\omega$: $\\epsilon_n = \\hbar \\omega \\left(n + \\tfrac{1}{2}\\right)$, where $\\hbar$ is the reduced Planck constant.\n- The vibrational partition function of independent harmonic modes and its relation to thermodynamic potentials.\n\nModeling assumptions to implement:\n- The crystalline phase is represented by a single inherent structure with energy per atom $E_{\\mathrm{c}}$ and a set of per-atom harmonic vibrational mode frequencies $\\{f_{\\mathrm{c},j}\\}$ in terahertz (THz). The crystalline free energy per atom is the sum of the inherent structure energy and the harmonic vibrational free energy.\n- The amorphous phase is represented by a finite enumeration of distinct inherent structures indexed by $i$, each with energy per atom $E_i$, an integer degeneracy $g_i$ (dimensionless, accounting for configurational multiplicity), and a set of per-atom harmonic vibrational mode frequencies $\\{f_{i,j}\\}$ in THz. The total partition function is a weighted sum over inherent structures, and the amorphous free energy per atom is given by the canonical definition using that partition function.\n- Harmonic vibrational contributions must be treated quantum mechanically for each mode, including the zero-point energy.\n\nRequired units:\n- Temperature $T$ in kelvins (K).\n- Energies in electronvolts per atom (eV/atom).\n- Frequencies in terahertz (THz). Convert to angular frequency in radians per second using $\\omega = 2\\pi f$ with $f$ in hertz.\n\nComputational tasks:\n- Implement a function that computes the per-atom harmonic vibrational free energy for a given set of modes $\\{\\omega_j\\}$ at temperature $T$, including zero-point energy.\n- Implement the crystalline free energy per atom $F_{\\mathrm{cryst}}(T)$ as inherent structure energy plus vibrational free energy.\n- Implement the amorphous free energy per atom $F_{\\mathrm{amorph}}(T)$ using inherent structure enumeration with degeneracy weights in the partition sum.\n- For each test case, compute the crossover temperature $T_{\\times}$ in kelvins at which $F_{\\mathrm{amorph}}(T) - F_{\\mathrm{cryst}}(T) = 0$ within a specified temperature interval $[T_{\\min}, T_{\\max}]$. If no sign change occurs on $[T_{\\min}, T_{\\max}]$, report $T_{\\times} = -1.0$.\n- For each test case, compute the free energy difference $\\Delta F(300\\,\\mathrm{K}) = F_{\\mathrm{amorph}}(300\\,\\mathrm{K}) - F_{\\mathrm{cryst}}(300\\,\\mathrm{K})$ in eV/atom.\n- For each test case, compute stability flags $S_{\\mathrm{low}}$ and $S_{\\mathrm{high}}$, where $S_{\\mathrm{low}} = 1$ if $F_{\\mathrm{amorph}}(T_{\\min})  F_{\\mathrm{cryst}}(T_{\\min})$ and $S_{\\mathrm{high}} = 1$ if $F_{\\mathrm{amorph}}(T_{\\max})  F_{\\mathrm{cryst}}(T_{\\max})$; otherwise set the corresponding flag to $0$.\n\nNumerical and algorithmic requirements:\n- Use a robust root-finding approach to locate $T_{\\times}$ when a sign change is detected, with a bracketing method followed by a one-dimensional solver.\n- Treat vibrational free energies with care at low temperatures to avoid numerical issues; include zero-point energy explicitly.\n- Round $T_{\\times}$ to one decimal place (in K) and $\\Delta F(300\\,\\mathrm{K})$ to six decimal places (in eV/atom). The stability flags are integers.\n- Physical constants must be used in electronvolt units: $k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\ \\mathrm{eV/K}$ and $\\hbar = 6.582119569\\times 10^{-16}\\ \\mathrm{eV\\cdot s}$.\n\nTest suite:\n- Case 1 (happy path, expected crossover in range):\n  - $T_{\\min} = 1.0\\ \\mathrm{K}$, $T_{\\max} = 1500.0\\ \\mathrm{K}$.\n  - Crystalline: $E_{\\mathrm{c}} = -3.200\\ \\mathrm{eV/atom}$, $f_{\\mathrm{c}} = [8.0, 6.0, 4.0]\\ \\mathrm{THz}$.\n  - Amorphous structures:\n    - $E_1 = -3.180\\ \\mathrm{eV/atom}$, $g_1 = 50$, $f_1 = [7.5, 5.5, 3.8]\\ \\mathrm{THz}$.\n    - $E_2 = -3.150\\ \\mathrm{eV/atom}$, $g_2 = 200$, $f_2 = [6.2, 4.5, 2.8]\\ \\mathrm{THz}$.\n    - $E_3 = -3.140\\ \\mathrm{eV/atom}$, $g_3 = 500$, $f_3 = [5.8, 4.0, 2.5]\\ \\mathrm{THz}$.\n- Case 2 (no crossover expected in range):\n  - $T_{\\min} = 1.0\\ \\mathrm{K}$, $T_{\\max} = 1500.0\\ \\mathrm{K}$.\n  - Crystalline: $E_{\\mathrm{c}} = -3.220\\ \\mathrm{eV/atom}$, $f_{\\mathrm{c}} = [8.5, 6.5, 4.5]\\ \\mathrm{THz}$.\n  - Amorphous structures:\n    - $E_1 = -3.100\\ \\mathrm{eV/atom}$, $g_1 = 10$, $f_1 = [7.0, 5.0, 3.0]\\ \\mathrm{THz}$.\n    - $E_2 = -3.080\\ \\mathrm{eV/atom}$, $g_2 = 20$, $f_2 = [6.5, 4.7, 2.9]\\ \\mathrm{THz}$.\n- Case 3 (boundary case, crossover near upper end of range):\n  - $T_{\\min} = 1.0\\ \\mathrm{K}$, $T_{\\max} = 1200.0\\ \\mathrm{K}$.\n  - Crystalline: $E_{\\mathrm{c}} = -3.205\\ \\mathrm{eV/atom}$, $f_{\\mathrm{c}} = [7.2, 5.2, 3.6]\\ \\mathrm{THz}$.\n  - Amorphous structures:\n    - $E_1 = -3.190\\ \\mathrm{eV/atom}$, $g_1 = 20$, $f_1 = [6.8, 5.0, 3.5]\\ \\mathrm{THz}$.\n    - $E_2 = -3.180\\ \\mathrm{eV/atom}$, $g_2 = 120$, $f_2 = [6.1, 4.6, 3.1]\\ \\mathrm{THz}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a list of four values $[T_{\\times}, \\Delta F(300\\,\\mathrm{K}), S_{\\mathrm{low}}, S_{\\mathrm{high}}]$, so the final output must be a list of these lists, for example: \"[[T1,DF1,S1_low,S1_high],[T2,DF2,S2_low,S2_high],[T3,DF3,S3_low,S3_high]]\". Ensure $T_{\\times}$ is rounded to one decimal place and $\\Delta F(300\\,\\mathrm{K})$ is rounded to six decimals, with the flags as integers.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in statistical mechanics, well-posed with sufficient data and clear objectives, and formalizable into a solvable computational problem. All provided information is consistent and unambiguous.\n\nThe task is to compute and compare the Helmholtz free energy $F(T)$ for crystalline and amorphous phases of a material to find their crossover temperature $T_{\\times}$. The model is based on the inherent structure formalism, using the harmonic approximation for vibrational contributions.\n\nThe derivation begins with fundamental principles of canonical ensemble statistical mechanics. The Helmholtz free energy $F$ is defined through the canonical partition function $Z$ as $F = -k_{\\mathrm{B}} T \\ln Z$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the temperature.\n\n**1. Vibrational Free Energy from a Quantum Harmonic Oscillator**\n\nThe energy levels of a single quantum harmonic oscillator with angular frequency $\\omega$ are given by:\n$$ \\epsilon_n = \\hbar \\omega \\left(n + \\frac{1}{2}\\right), \\quad n = 0, 1, 2, \\dots $$\nwhere $\\hbar$ is the reduced Planck constant. The partition function $z_{\\text{vib}}$ for this single mode is the sum over its energy states:\n$$ z_{\\text{vib}}(\\omega, T) = \\sum_{n=0}^{\\infty} e^{-\\epsilon_n / (k_{\\mathrm{B}} T)} = \\sum_{n=0}^{\\infty} e^{-\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\left(n + \\frac{1}{2}\\right)} $$\nFactoring out the zero-point energy term and recognizing the geometric series, we get:\n$$ z_{\\text{vib}}(\\omega, T) = e^{-\\frac{\\hbar \\omega}{2 k_{\\mathrm{B}} T}} \\sum_{n=0}^{\\infty} \\left(e^{-\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}}\\right)^n = \\frac{e^{-\\frac{\\hbar \\omega}{2 k_{\\mathrm{B}} T}}}{1 - e^{-\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}}} $$\nThe free energy contribution from this single mode is then:\n$$ F_{\\text{vib}}(\\omega, T) = -k_{\\mathrm{B}} T \\ln z_{\\text{vib}}(\\omega, T) = -k_{\\mathrm{B}} T \\left( -\\frac{\\hbar \\omega}{2 k_{\\mathrm{B}} T} - \\ln\\left(1 - e^{-\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}}\\right) \\right) $$\n$$ F_{\\text{vib}}(\\omega, T) = \\frac{\\hbar \\omega}{2} + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}}\\right) $$\nThe first term, $\\frac{\\hbar \\omega}{2}$, is the temperature-independent zero-point energy (ZPE). The second is the thermal contribution. For a set of independent modes $\\{\\omega_j\\}$ associated with one atom, the per-atom vibrational free energy $F_{\\text{vib}}^{\\text{atom}}$ is the sum of individual contributions:\n$$ F_{\\text{vib}}^{\\text{atom}}(\\{\\omega_j\\}, T) = \\sum_j F_{\\text{vib}}(\\omega_j, T) = \\sum_j \\left( \\frac{\\hbar \\omega_j}{2} + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\frac{\\hbar \\omega_j}{k_{\\mathrm{B}} T}}\\right) \\right) $$\nThe input frequencies $f_j$ in terahertz ($1\\ \\text{THz} = 10^{12}\\ \\text{Hz}$) are converted to angular frequencies via $\\omega_j = 2\\pi f_j \\times 10^{12}\\ \\text{rad/s}$.\n\n**2. Crystalline Phase Free Energy**\n\nThe crystalline phase is modeled as a single inherent structure with a potential energy per atom of $E_{\\mathrm{c}}$. Its total free energy per atom is the sum of this static lattice energy and the vibrational free energy of its modes $\\{\\omega_{\\mathrm{c},j}\\}$:\n$$ F_{\\mathrm{cryst}}^{\\text{atom}}(T) = E_{\\mathrm{c}} + F_{\\text{vib}}^{\\text{atom}}(\\{\\omega_{\\mathrm{c},j}\\}, T) $$\nThis expression follows from the partition function $Z_{\\mathrm{cryst}} = e^{-E_{\\mathrm{c}}/(k_{\\mathrm{B}}T)} \\times Z_{\\text{vib,cryst}}$, where $Z_{\\text{vib,cryst}} = \\prod_j z_{\\text{vib}}(\\omega_{\\mathrm{c},j}, T)$.\n\n**3. Amorphous Phase Free Energy**\n\nThe amorphous phase is described as a collection of distinct inherent structures, indexed by $i$. Each structure has a potential energy per atom $E_i$, a degeneracy $g_i$, and a unique set of vibrational modes $\\{\\omega_{i,j}\\}$. The total canonical partition function for the amorphous phase is the sum over all structures:\n$$ Z_{\\mathrm{amorph}} = \\sum_i g_i Z_i $$\nwhere $Z_i$ is the partition function for the subsystem of states associated with inherent structure $i$. This is given by:\n$$ Z_i = e^{-E_i / (k_{\\mathrm{B}} T)} Z_{\\text{vib},i} = e^{-E_i / (k_{\\mathrm{B}} T)} \\prod_j z_{\\text{vib}}(\\omega_{i,j}, T) $$\nThe free energy of structure $i$ is $F_i(T) = -k_{\\mathrm{B}} T \\ln Z_i = E_i + F_{\\text{vib}}^{\\text{atom}}(\\{\\omega_{i,j}\\}, T)$. We can rewrite $Z_i$ as $Z_i = e^{-F_i(T) / (k_{\\mathrm{B}} T)}$. The total partition function becomes:\n$$ Z_{\\mathrm{amorph}} = \\sum_i g_i e^{-F_i(T) / (k_{\\mathrm{B}} T)} $$\nThe total free energy per atom of the amorphous phase is then:\n$$ F_{\\mathrm{amorph}}^{\\text{atom}}(T) = -k_{\\mathrm{B}} T \\ln Z_{\\mathrm{amorph}} = -k_{\\mathrm{B}} T \\ln \\left( \\sum_i g_i e^{-F_i(T) / (k_{\\mathrm{B}} T)} \\right) $$\nFor numerical stability, especially when arguments of the exponential function are large and negative, the log-sum-exp trick is employed. Let $x_i(T) = \\ln(g_i) - F_i(T) / (k_{\\mathrm{B}} T)$. Then:\n$$ \\ln(Z_{\\mathrm{amorph}}) = \\ln \\left( \\sum_i e^{x_i(T)} \\right) = x_{\\text{max}}(T) + \\ln \\left( \\sum_i e^{x_i(T) - x_{\\text{max}}(T)} \\right) $$\nwhere $x_{\\text{max}}(T) = \\max_i \\{x_i(T)\\}$. This avoids floating-point overflow and minimizes precision loss from underflow.\n\n**4. Computational Algorithm**\n\nThe solution is implemented as a series of functions to compute the required quantities for each test case.\n- A function `harmonic_vibrational_free_energy` takes a set of frequencies (in THz) and a temperature $T$ to compute $F_{\\text{vib}}^{\\text{atom}}$. It uses the physical constants $k_{\\mathrm{B}}$ and $\\hbar$ in the specified eV-based units.\n- Functions `F_cryst` and `F_amorph` are constructed for each test case. They take temperature $T$ as input and compute the respective free energies per atom using the `harmonic_vibrational_free_energy` function and the model parameters for the specific case. The `F_amorph` function implements the numerically stable log-sum-exp method.\n- The free energy difference function is defined as $\\Delta F(T) = F_{\\mathrm{amorph}}^{\\text{atom}}(T) - F_{\\mathrm{cryst}}^{\\text{atom}}(T)$.\n- To find the crossover temperature $T_{\\times}$, we seek the root of $\\Delta F(T) = 0$. The signs of $\\Delta F(T_{\\min})$ and $\\Delta F(T_{\\max})$ are first checked. If they are different, a root is guaranteed to exist in the interval $[T_{\\min}, T_{\\max}]$. The `scipy.optimize.brentq` solver, a robust bracketing root-finding algorithm, is used to find $T_{\\times}$. If the signs are the same, no crossover is detected in the interval, and $T_{\\times}$ is set to $-1.0$.\n- The free energy difference at $T=300\\ \\text{K}$, $\\Delta F(300\\ \\text{K})$, is calculated by direct evaluation.\n- The stability flags, $S_{\\mathrm{low}}$ and $S_{\\mathrm{high}}$, are determined by the sign of $\\Delta F(T)$ at $T_{\\min}$ and $T_{\\max}$, respectively. $S=1$ if the amorphous phase is more stable (i.e., $\\Delta F  0$), and $S=0$ otherwise.\n- The final results for each test case—$T_{\\times}$, $\\Delta F(300\\ \\text{K})$, $S_{\\mathrm{low}}$, and $S_{\\mathrm{high}}$—are collected and formatted into a single output string as per the problem specification.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the materials thermodynamics problem for the given test cases.\n    \"\"\"\n    \n    # Physical constants in specified units\n    KB_EV_K = 8.617333262e-5  # Boltzmann constant in eV/K\n    HBAR_EV_S = 6.582119569e-16 # Reduced Planck constant in eV*s\n\n    test_cases = [\n        {\n            \"T_min\": 1.0, \"T_max\": 1500.0,\n            \"cryst\": {\"E_c\": -3.200, \"freqs\": np.array([8.0, 6.0, 4.0])},\n            \"amorph\": [\n                {\"E_i\": -3.180, \"g_i\": 50, \"freqs\": np.array([7.5, 5.5, 3.8])},\n                {\"E_i\": -3.150, \"g_i\": 200, \"freqs\": np.array([6.2, 4.5, 2.8])},\n                {\"E_i\": -3.140, \"g_i\": 500, \"freqs\": np.array([5.8, 4.0, 2.5])},\n            ]\n        },\n        {\n            \"T_min\": 1.0, \"T_max\": 1500.0,\n            \"cryst\": {\"E_c\": -3.220, \"freqs\": np.array([8.5, 6.5, 4.5])},\n            \"amorph\": [\n                {\"E_i\": -3.100, \"g_i\": 10, \"freqs\": np.array([7.0, 5.0, 3.0])},\n                {\"E_i\": -3.080, \"g_i\": 20, \"freqs\": np.array([6.5, 4.7, 2.9])},\n            ]\n        },\n        {\n            \"T_min\": 1.0, \"T_max\": 1200.0,\n            \"cryst\": {\"E_c\": -3.205, \"freqs\": np.array([7.2, 5.2, 3.6])},\n            \"amorph\": [\n                {\"E_i\": -3.190, \"g_i\": 20, \"freqs\": np.array([6.8, 5.0, 3.5])},\n                {\"E_i\": -3.180, \"g_i\": 120, \"freqs\": np.array([6.1, 4.6, 3.1])},\n            ]\n        },\n    ]\n\n    results = []\n\n    def harmonic_vibrational_free_energy(freqs_thz, T):\n        \"\"\"\n        Computes the per-atom harmonic vibrational free energy.\n        freqs_thz are in THz, T is in K.\n        Returns energy in eV/atom.\n        \"\"\"\n        if T = 0:\n            # At T=0, F_vib is just the ZPE\n            omegas = 2 * np.pi * freqs_thz * 1e12\n            hbar_omegas = HBAR_EV_S * omegas\n            return np.sum(hbar_omegas / 2.0)\n\n        omegas = 2 * np.pi * freqs_thz * 1e12  # rad/s\n        hbar_omegas = HBAR_EV_S * omegas  # eV\n        \n        # Zero-point energy contribution\n        zpe = np.sum(hbar_omegas / 2.0)\n        \n        # Thermal contribution\n        arg = hbar_omegas / (KB_EV_K * T)\n        # np.exp(-large_number) safely underflows to 0.\n        thermal_term = KB_EV_K * T * np.sum(np.log(1.0 - np.exp(-arg)))\n\n        return zpe + thermal_term\n\n    for case in test_cases:\n        \n        # Crystalline Free Energy Function\n        def F_cryst(T):\n            E_c = case[\"cryst\"][\"E_c\"]\n            freqs_c = case[\"cryst\"][\"freqs\"]\n            F_vib_c = harmonic_vibrational_free_energy(freqs_c, T)\n            return E_c + F_vib_c\n\n        # Amorphous Free Energy Function\n        def F_amorph(T):\n            if T = 0: # Handle T=0 case by calculating sum of lowest energy states\n                min_energy_struct = min(case[\"amorph\"], key=lambda s: s[\"E_i\"])\n                F_vib_min = harmonic_vibrational_free_energy(min_energy_struct[\"freqs\"], T)\n                return min_energy_struct[\"E_i\"] + F_vib_min\n            \n            F_i_list = []\n            for struct in case[\"amorph\"]:\n                E_i = struct[\"E_i\"]\n                freqs_i = struct[\"freqs\"]\n                F_vib_i = harmonic_vibrational_free_energy(freqs_i, T)\n                F_i_list.append(E_i + F_vib_i)\n\n            g_i_list = np.array([s[\"g_i\"] for s in case[\"amorph\"]])\n            F_i_array = np.array(F_i_list)\n\n            # Log-Sum-Exp for numerical stability\n            x_i = np.log(g_i_list) - F_i_array / (KB_EV_K * T)\n            x_max = np.max(x_i)\n            log_sum = x_max + np.log(np.sum(np.exp(x_i - x_max)))\n\n            return -KB_EV_K * T * log_sum\n\n        # Free Energy Difference Function\n        def delta_F(T):\n            return F_amorph(T) - F_cryst(T)\n\n        T_min, T_max = case[\"T_min\"], case[\"T_max\"]\n\n        # Calculate values at boundaries\n        delta_F_min = delta_F(T_min)\n        delta_F_max = delta_F(T_max)\n\n        # Determine stability flags\n        S_low = 1 if delta_F_min  0 else 0\n        S_high = 1 if delta_F_max  0 else 0\n\n        # Find crossover temperature\n        T_cross = -1.0\n        if delta_F_min * delta_F_max = 0: # Sign change or root at boundary\n            try:\n                T_cross = brentq(delta_F, T_min, T_max)\n            except ValueError:\n                # Should not happen due to the check, but as a safeguard.\n                T_cross = -1.0\n        \n        # Calculate free energy difference at 300 K\n        delta_F_300K = delta_F(300.0)\n        \n        # Collect results for this case\n        results.append([T_cross, delta_F_300K, S_low, S_high])\n\n    # Format the final output string\n    final_str_parts = []\n    for res in results:\n        part = f\"[{res[0]:.1f},{res[1]:.6f},{res[2]},{res[3]}]\"\n        final_str_parts.append(part)\n    \n    final_output = f\"[{','.join(final_str_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the concept of temperature-dependent free energy, we now turn to the classic thermodynamic models that describe phase behavior in multicomponent systems. This practice focuses on the Gibbs free energy of a binary regular solution, a paradigm for understanding mixing and demixing phenomena . You will derive and implement the common tangent condition to determine equilibrium compositions in a two-phase system and use the tangent plane distance as a rigorous criterion for assessing thermodynamic stability against decomposition.",
            "id": "3464582",
            "problem": "Consider an isothermal, isobaric, multicomponent mixture with total number of moles fixed. The molar Gibbs free energy per mole, non-dimensionalized by the product of the universal gas constant and temperature, is denoted by $g$. For an ideal substitutional solution perturbed by regular-solution-type interactions, a widely used, well-tested model for a binary mixture of components $\\mathrm{A}$ and $\\mathrm{B}$ is\n$$\ng(x) \\equiv x \\ln x + (1 - x)\\ln(1 - x) + w\\,x(1-x),\n$$\nwhere $x \\in (0,1)$ is the mole fraction of $\\mathrm{A}$, and $w \\equiv \\Omega/(R T)$ is a dimensionless interaction parameter formed by the regular-solution parameter $\\Omega$ and the product of the universal gas constant $R$ and temperature $T$. All quantities in this problem are non-dimensional (that is, measured in units of $R T$), so answers must be reported as pure numbers with no physical units.\n\nThis problem requires you to build from fundamental definitions to two computational tasks:\n- Gibbs energy minimization for a constrained binary mixture that may decompose into two phases.\n- Tangent plane distance (TPD) stability assessment as a global nonconvexity test on $g$.\n\nYou must start from the following foundational base, and derive the target constructs needed in the algorithm:\n- Gibbs free energy of a closed, isothermal, isobaric system is minimized at equilibrium.\n- For a one-dimensional composition variable $x$ with the constraint $x \\in [0,1]$, a two-phase state may be represented by compositions $x_\\alpha$ and $x_\\beta$ and a phase fraction $\\lambda \\in [0,1]$ such that the overall composition satisfies $z = \\lambda x_\\alpha + (1-\\lambda) x_\\beta$, and the mixture free energy is $g_{\\text{mix}} = \\lambda g(x_\\alpha) + (1-\\lambda) g(x_\\beta)$.\n- The tangent plane distance (TPD) at a reference composition $z$ is the minimum signed vertical distance between the free energy surface and the tangent plane that is anchored at $z$; for a one-dimensional composition variable, this is the minimum of $g(y)$ minus the first-order Taylor expansion of $g$ about $z$, evaluated over all admissible $y$.\n\nFrom this base, derive without using any pre-supplied shortcut formulas:\n- The equilibrium conditions for two-phase coexistence expressed as a pair of equations to solve for $x_\\alpha$ and $x_\\beta$ (a common tangent condition).\n- The expression for the one-dimensional tangent plane distance function whose global minimum over $y \\in [0,1]$ indicates stability ($\\ge 0$) or instability ($0$) of the reference composition $z$ with respect to phase separation.\n\nThen implement an algorithm to:\n1) Solve the two-phase equilibrium for the binary regular solution model by minimizing the total Gibbs free energy under the lever rule constraint, and return both the equilibrium tie-line compositions and the minimized mixture free energy.\n2) Evaluate the minimum tangent plane distance at specified reference compositions by globally minimizing the appropriate one-dimensional TPD function over the closed interval $[0,1]$.\n\nTest suite and required outputs:\n- Case $1$ (Gibbs energy minimization): Use $w = 2.5$ and overall composition $z = 0.5$. Compute the two-phase equilibrium compositions $x_\\alpha$ and $x_\\beta$ (with $x_\\alpha  x_\\beta$), the phase fraction $\\lambda$ of phase $\\alpha$, and the minimized mixture free energy $g_{\\text{mix}}$.\n- Case $2$ (TPD at unstable composition): For the same model with $w = 2.5$, evaluate the minimum tangent plane distance at $z = 0.5$ by minimizing over $y \\in [0,1]$.\n- Case $3$ (TPD at stable composition): For the same model with $w = 2.5$, evaluate the minimum tangent plane distance at $z = 0.05$ by minimizing over $y \\in [0,1]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The first element is a list of four floats for Case $1$ in the order $[x_\\alpha, x_\\beta, \\lambda, g_{\\text{mix}}]$. The second element is a single float for the Case $2$ TPD minimum. The third element is a single float for the Case $3$ TPD minimum. For example, your program should print a line of the form\n$[ [x_\\alpha,x_\\beta,\\lambda,g_{\\text{mix}}], \\mathrm{TPD}_{z=0.5}, \\mathrm{TPD}_{z=0.05} ]$\nwith numerical values substituted, with no additional text.",
            "solution": "The problem requires the derivation of equilibrium conditions and stability criteria for a binary regular solution, followed by the implementation of an algorithm to solve for phase equilibrium and tangent plane distance (TPD) for specific cases. The entire analysis is based on the provided non-dimensionalized molar Gibbs free energy model:\n$$\ng(x) = x \\ln x + (1 - x)\\ln(1 - x) + w\\,x(1-x)\n$$\nwhere $x$ is the mole fraction of component A and $w$ is the dimensionless interaction parameter.\n\n### Part 1: Derivation of Equilibrium Conditions\n\nThe fundamental principle for an isothermal, isobaric system at equilibrium is the minimization of the total Gibbs free energy. For a system with a fixed overall composition $z$ that has phase-separated into two phases, $\\alpha$ and $\\beta$, with compositions $x_\\alpha$ and $x_\\beta$ respectively, the state of the system is described by these compositions and the mole fraction of phase $\\alpha$, denoted by $\\lambda \\in [0,1]$.\n\nThe molar Gibbs free energy of this two-phase mixture, $g_{\\text{mix}}$, is given by the weighted average of the free energies of the constituent phases:\n$$\ng_{\\text{mix}} = \\lambda g(x_\\alpha) + (1-\\lambda) g(x_\\beta)\n$$\nConservation of mass (the lever rule) provides a constraint relating the phase fraction $\\lambda$ to the compositions:\n$$\nz = \\lambda x_\\alpha + (1-\\lambda) x_\\beta\n$$\nFrom the lever rule, we can express $\\lambda$ as a function of the compositions:\n$$\n\\lambda = \\frac{x_\\beta - z}{x_\\beta - x_\\alpha}\n$$\nSubstituting this into the expression for $g_{\\text{mix}}$ makes it a function of only $x_\\alpha$ and $x_\\beta$ for a fixed $z$:\n$$\ng_{\\text{mix}}(x_\\alpha, x_\\beta) = \\frac{x_\\beta - z}{x_\\beta - x_\\alpha} g(x_\\alpha) + \\frac{z - x_\\alpha}{x_\\beta - x_\\alpha} g(x_\\beta)\n$$\nThis expression defines the line segment connecting the points $(x_\\alpha, g(x_\\alpha))$ and $(x_\\beta, g(x_\\beta))$ on the free energy curve. Equilibrium is found by minimizing $g_{\\text{mix}}$ with respect to the variables $x_\\alpha$ and $x_\\beta$. This requires setting the partial derivatives to zero: $\\frac{\\partial g_{\\text{mix}}}{\\partial x_\\alpha} = 0$ and $\\frac{\\partial g_{\\text{mix}}}{\\partial x_\\beta} = 0$.\n\nPerforming the differentiation of $g_{\\text{mix}}$ with respect to $x_\\alpha$ (and by symmetry, $x_\\beta$) leads to the \"common tangent\" conditions:\n$$\ng'(x_\\alpha) = \\frac{g(x_\\beta) - g(x_\\alpha)}{x_\\beta - x_\\alpha} \\quad \\text{and} \\quad g'(x_\\beta) = \\frac{g(x_\\beta) - g(x_\\alpha)}{x_\\beta - x_\\alpha}\n$$\nCombining these yields the system of two equations that define the equilibrium compositions $x_\\alpha$ and $x_\\beta$:\n1. $g'(x_\\alpha) = g'(x_\\beta)$\n2. $g(x_\\beta) - g(x_\\alpha) = (x_\\beta - x_\\alpha)g'(x_\\alpha)$\n\nAn equivalent approach is based on the equality of chemical potentials of each component in the coexisting phases. The chemical potentials, $\\mu_A$ and $\\mu_B$, are given by:\n$$\n\\mu_A(x) = g(x) + (1-x)g'(x)\n$$\n$$\n\\mu_B(x) = g(x) - xg'(x)\n$$\nThe equilibrium conditions are $\\mu_A(x_\\alpha) = \\mu_A(x_\\beta)$ and $\\mu_B(x_\\alpha) = \\mu_B(x_\\beta)$. It can be shown that this system is fully equivalent to the common tangent conditions. For the specified regular solution model, the chemical potentials are:\n$$\n\\mu_A(x) = \\ln x + w(1-x)^2 \\quad (\\text{after non-dimensionalization by } RT)\n$$\n$$\n\\mu_B(x) = \\ln(1-x) + wx^2 \\quad (\\text{after non-dimensionalization by } RT)\n$$\nThe function $g(x)$ is symmetric about $x=0.5$. This structural symmetry implies that the equilibrium compositions $x_\\alpha$ and $x_\\beta$ must also be symmetric, i.e., $x_\\beta = 1 - x_\\alpha$. Substituting this into the chemical potential equality conditions reduces the system of two equations to a single equation for $x_\\alpha$. For instance, from $\\mu_A(x_\\alpha) = \\mu_A(1-x_\\alpha)$:\n$$\n\\ln(x_\\alpha) + w(1-x_\\alpha)^2 = \\ln(1-x_\\alpha) + w(1-(1-x_\\alpha))^2\n$$\n$$\n\\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right) = w(x_\\alpha^2 - (1-x_\\alpha)^2) = w(2x_\\alpha - 1)\n$$\nThis single non-linear equation can be solved numerically for $x_\\alpha \\in (0, 0.5)$.\n\n### Part 2: Derivation of the Tangent Plane Distance (TPD) Function\n\nThe TPD is a measure of thermodynamic stability. At a reference composition $z$, the TPD is the minimum signed vertical distance between the free energy curve $g(y)$ and the tangent line to the curve at $g(z)$. The equation for the tangent line, $T_z(y)$, at composition $z$ is the first-order Taylor expansion of $g$ around $z$:\n$$\nT_z(y) = g(z) + g'(z)(y-z)\n$$\nThe vertical distance between the free energy curve and this tangent line at any composition $y$ is the TPD function, $\\Delta_z(y)$:\n$$\n\\Delta_z(y) = g(y) - T_z(y) = g(y) - g(z) - g'(z)(y-z)\n$$\nThe tangent plane distance, $\\text{TPD}(z)$, is the global minimum of this function over the entire composition range $y \\in [0,1]$:\n$$\n\\text{TPD}(z) = \\min_{y \\in [0,1]} \\Delta_z(y)\n$$\nBy construction, $\\Delta_z(z)=0$, so the TPD is always less than or equal to zero. If $\\text{TPD}(z) = 0$, the composition $z$ is stable or metastable with respect to phase separation. If $\\text{TPD}(z)  0$, the composition $z$ is unstable, and a state with lower free energy exists.\n\n### Part 3: Algorithmic Implementation\n\n**Case 1: Gibbs Energy Minimization ($w = 2.5, z = 0.5$)**\n1.  Set $w=2.5$. The equilibrium compositions $x_\\alpha$ and $x_\\beta$ are symmetric about $0.5$.\n2.  Solve the binodal equation for $x_\\alpha  0.5$: $\\ln\\left(\\frac{x}{1-x}\\right) - w(2x - 1) = 0$. This is done using a numerical root-finding algorithm (e.g., Brent's method) on the interval $(0, 0.5)$.\n3.  Calculate $x_\\beta = 1 - x_\\alpha$.\n4.  For the overall composition $z=0.5$, the phase fractions are equal by symmetry: $\\lambda = 0.5$.\n5.  The minimized mixture free energy $g_{\\text{mix}}$ lies on the common tangent line. By symmetry, $g(x_\\alpha) = g(x_\\beta)$, so $g_{\\text{mix}} = \\lambda g(x_\\alpha) + (1-\\lambda)g(x_\\beta) = g(x_\\alpha)$.\n\n**Case 2: TPD at Unstable Composition ($w = 2.5, z = 0.5$)**\n1.  Set $w=2.5$ and $z=0.5$. The derivative of $g(x)$ at $z=0.5$ is $g'(0.5) = \\ln(1) + w(1-1) = 0$.\n2.  The TPD function simplifies to $\\Delta_{0.5}(y) = g(y) - g(0.5)$.\n3.  We must find the global minimum of this function for $y \\in [0,1]$. This is equivalent to finding the global minimum of $g(y)$. For $w  2$, $g(y)$ has two minima, symmetric around a local maximum at $y=0.5$.\n4.  The minima of $g(y)$ occur where its derivative is zero: $g'(y) = 0$. We solve $g'(y) = \\ln\\left(\\frac{y}{1-y}\\right) + w(1-2y) = 0$ for its roots. One root is $y=0.5$ (the maximum). The other two give the minima.\n5.  We find one of these roots, $y_{min}  0.5$, numerically.\n6.  The TPD is then calculated as $\\text{TPD}(0.5) = g(y_{min}) - g(0.5)$.\n\n**Case 3: TPD at Stable Composition ($w = 2.5, z = 0.05$)**\n1.  Set $w=2.5$ and $z=0.05$. The composition $z=0.05$ lies in the single-phase region, as it is less than the binodal composition $x_\\alpha \\approx 0.119$ found in Case 1.\n2.  In this region, the free energy curve $g(x)$ is convex ($g''(x)  0$), and the system is thermodynamically stable.\n3.  For a stable phase, the tangent line at $z$ lies entirely below the free energy curve $g(y)$ for all $y \\neq z$. Therefore, $\\Delta_z(y) = g(y) - T_z(y) \\geq 0$ for all $y$.\n4.  Since $\\Delta_z(z)=0$, the minimum value of $\\Delta_z(y)$ over $y \\in [0,1]$ is exactly $0$.\n5.  The algorithm confirms this by numerically minimizing the function $\\Delta_{0.05}(y) = g(y) - g(0.05) - g'(0.05)(y-0.05)$ over the interval $y \\in [0,1]$. The expected result is $0$ (or a value on the order of machine precision).",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq, minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the computational materials thermodynamics problem for a binary regular solution.\n    \"\"\"\n\n    # --- Model Definition ---\n    \n    def gibbs_g(x, w):\n        \"\"\"\n        Calculates the non-dimensional molar Gibbs free energy g(x).\n        Handles x=0 and x=1 cases where x*ln(x) - 0.\n        \"\"\"\n        # np.log(0) gives -inf, and 0 * -inf is nan. We must handle this limit.\n        term1 = x * np.log(x) if x  0 else 0.0\n        term2 = (1 - x) * np.log(1 - x) if x  1 else 0.0\n        return term1 + term2 + w * x * (1 - x)\n\n    def gibbs_g_prime(x, w):\n        \"\"\"Calculates the derivative of g(x) with respect to x.\"\"\"\n        # This will diverge at x=0 and x=1, which is physically correct.\n        # Callers must use intervals that exclude the endpoints.\n        return np.log(x / (1 - x)) + w * (1 - 2 * x)\n\n    # --- Case 1: Gibbs Energy Minimization ---\n\n    def solve_case1(w, z):\n        \"\"\"\n        Solves for two-phase equilibrium for a given w and overall composition z.\n        \"\"\"\n        # For symmetric g(x), equilibrium phase compositions are symmetric around 0.5.\n        # This simplifies the two common tangent equations to a single equation.\n        # f(x) = ln(x/(1-x)) - w*(2x-1) = 0\n        def binodal_eq(x, w_val):\n            return np.log(x / (1 - x)) - w_val * (2 * x - 1)\n\n        # Solve for x_alpha in the interval (0, 0.5)\n        # The interval needs to be slightly inset to avoid log(0)\n        x_alpha = brentq(binodal_eq, 1e-9, 0.5 - 1e-9, args=(w,))\n        \n        # x_beta is symmetric\n        x_beta = 1 - x_alpha\n        \n        # For z=0.5, by symmetry, phase fraction is 0.5\n        lambda_alpha = 0.5\n\n        # Minimized mixture free energy is the value on the common tangent,\n        # which for a symmetric decomposition is simply g(x_alpha).\n        g_mix = gibbs_g(x_alpha, w)\n\n        return [x_alpha, x_beta, lambda_alpha, g_mix]\n\n    # --- Case 2: TPD at Unstable Composition ---\n    \n    def solve_case2(w, z):\n        \"\"\"\n        Calculates the Tangent Plane Distance at an unstable composition z.\n        \"\"\"\n        # TPD(z) = min_y{ g(y) - g(z) - g'(z)(y-z) }\n        # At z=0.5, g'(0.5) = 0.\n        # So, TPD(0.5) = min_y{ g(y) - g(0.5) }\n        \n        # We need to find the global minimum of g(y). For w  2, the minima\n        # are symmetric around 0.5 and are solutions to g'(y) = 0.\n        def g_prime_eq(y, w_val):\n            return gibbs_g_prime(y, w_val)\n\n        # Find the minimum y_min in (0, 0.5)\n        # The function g'(y) changes sign in this interval. A safe upper bound is  0.5\n        y_min = brentq(g_prime_eq, 1e-9, 0.5 - 1e-9, args=(w,))\n        \n        g_at_ymin = gibbs_g(y_min, w)\n        g_at_z = gibbs_g(z, w)\n        \n        tpd_min = g_at_ymin - g_at_z\n        return tpd_min\n\n    # --- Case 3: TPD at Stable Composition ---\n\n    def solve_case3(w, z):\n        \"\"\"\n        Calculates the Tangent Plane Distance at a stable composition z.\n        \"\"\"\n        # Define the TPD function to be minimized\n        g_at_z = gibbs_g(z, w)\n        g_prime_at_z = gibbs_g_prime(z, w)\n        \n        def tpd_func(y, w_val, z_val, g_z, gp_z):\n            return gibbs_g(y, w_val) - g_z - gp_z * (y - z_val)\n\n        # Minimize the TPD function over the domain [0, 1]\n        res = minimize_scalar(tpd_func, bounds=(0, 1), method='bounded', \n                              args=(w, z, g_at_z, g_prime_at_z))\n        \n        # For a stable phase, TPD is 0. Numerical result might be a very small number.\n        tpd_min = res.fun\n        # Return 0.0 if the result is smaller than a reasonable tolerance\n        return 0.0 if np.abs(tpd_min)  1e-9 else tpd_min\n\n\n    # --- Test Suite Execution ---\n    \n    # Case 1 parameters\n    w1, z1 = 2.5, 0.5\n    results_case1 = solve_case1(w1, z1)\n\n    # Case 2 parameters\n    w2, z2 = 2.5, 0.5\n    results_case2 = solve_case2(w2, z2)\n\n    # Case 3 parameters\n    w3, z3 = 2.5, 0.05\n    results_case3 = solve_case3(w3, z3)\n    \n    # --- Final Output Formatting ---\n    \n    final_results = [results_case1, results_case2, results_case3]\n    \n    # Convert all numbers to strings for the final output string\n    # Custom string formatting for nested list\n    str_results = []\n    for item in final_results:\n        if isinstance(item, list):\n            # Format numbers inside the list with sufficient precision\n            str_results.append(f\"[{','.join(f'{v:.15f}' for v in item)}]\")\n        else:\n            str_results.append(f\"{item:.15f}\")\n            \n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        }
    ]
}