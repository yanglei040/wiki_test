{
    "hands_on_practices": [
        {
            "introduction": "密度泛函理论的核心在于使用电子密度 $n(\\mathbf{r})$ 作为基本变量。在深入探讨其理论框架之前，我们必须首先牢固掌握电子密度本身是如何从多体波函数中定义的。这个练习将引导你完成一个关键的推导，展示如何从一个由单粒子轨道构成的斯莱特行列式 (Slater determinant) 波函数出发，得到非相互作用体系的电子密度表达式，并将其应用于一个经典的“一维无限深势阱”模型中。",
            "id": "3493718",
            "problem": "考虑一个在密度泛函理论 (DFT) 框架下描述的 $N$ 电子基态，其存在性及基于密度的变分原理由 Hohenberg-Kohn (HK) 定理保证。在 Kohn-Sham (KS) 构造中，引入了一个无相互作用的费米子体系，该体系能够再现相同的基态密度。假设 KS 基态波函数由单个 Slater 行列式表示，该行列式由一组标准正交的自旋轨道 $\\{\\varphi_i(x)\\}_{i=1}^{N}$ 构成，其中 $x=(\\mathbf{r},\\sigma)$ 包含了空间坐标 $\\mathbf{r}$ 和自旋 $\\sigma$。Slater 行列式为\n$$\n\\Psi(x_1,\\dots,x_N) = \\frac{1}{\\sqrt{N!}}\n\\begin{vmatrix}\n\\varphi_1(x_1)  \\cdots  \\varphi_1(x_N) \\\\\n\\vdots  \\ddots  \\vdots \\\\\n\\varphi_N(x_1)  \\cdots  \\varphi_N(x_N)\n\\end{vmatrix}.\n$$\n从单体基态密度（即单粒子约化密度的对角部分）的定义出发，\n$$\nn(\\mathbf{r}) \\equiv N \\sum_{\\sigma_1,\\dots,\\sigma_N} \\int \\mathrm{d}\\mathbf{r}_2 \\cdots \\mathrm{d}\\mathbf{r}_N \\, \\left| \\Psi\\!\\left((\\mathbf{r},\\sigma_1),x_2,\\dots,x_N\\right) \\right|^{2},\n$$\n仅利用已占据自旋轨道的正交性以及行列式的性质，推导出：如果每个自旋轨道可以分解为 $\\varphi_i(\\mathbf{r},\\sigma)=\\phi_i(\\mathbf{r})\\chi_i(\\sigma)$（其中 $\\{\\chi_i\\}$ 是标准正交的自旋量），那么密度可以纯粹用已占据的空间轨道表示为\n$$\nn(\\mathbf{r}) = \\sum_{i=1}^{N} \\left| \\phi_i(\\mathbf{r}) \\right|^{2}.\n$$\n然后将此结果应用于宽度为 $L$ 的一维无限深方势阱（在 $x=0$ 和 $x=L$ 处有硬壁边界），假设 $N$ 个无相互作用的无自旋费米子占据了能量最低的 $N$ 个单粒子能级本征态。归一化的空间轨道为\n$$\n\\phi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\!\\left(\\frac{n\\pi x}{L}\\right), \\quad n=1,2,\\dots .\n$$\n仅使用经过充分检验的三角函数求和恒等式，且不借助任何与目标表达式相关的特定结果，计算在势阱内部（$0  x  L$）的总电子密度 $n(x)$。",
            "solution": "问题陈述已经过验证，是自洽的、有科学依据的、且提法恰当。所有前提都与量子力学和密度泛函理论的原理一致。所要求的任务是标准的教科书推导和计算。因此，将提供完整的解答。\n\n问题包含两部分。第一，推导由单个 Slater 行列式描述的体系的基态单体密度。第二，将此结果应用于一维无限深方势阱中的无相互作用无自旋费米子体系。\n\n**第一部分：基态密度表达式的推导**\n\n我们从一个 $N$ 电子体系的单体基态密度 $n(\\mathbf{r})$ 的定义开始：\n$$\nn(\\mathbf{r}) = N \\sum_{\\sigma_1,\\dots,\\sigma_N} \\int \\mathrm{d}\\mathbf{r}_2 \\cdots \\mathrm{d}\\mathbf{r}_N \\, \\left| \\Psi\\!\\left(x_1,x_2,\\dots,x_N\\right) \\right|^{2}\n$$\n其中 $x_i = (\\mathbf{r}_i, \\sigma_i)$ 代表第 $i$ 个电子的空间和自旋组合坐标，并且我们已将第一个电子的空间坐标固定为 $\\mathbf{r}$，因此 $x_1 = (\\mathbf{r},\\sigma_1)$。\n\n波函数 $\\Psi$ 是由 $N$ 个标准正交自旋轨道 $\\{\\varphi_i(x)\\}_{i=1}^N$ 构成的单个 Slater 行列式：\n$$\n\\Psi(x_1,\\dots,x_N) = \\frac{1}{\\sqrt{N!}} \\det\\left[\\varphi_j(x_i)\\right] = \\frac{1}{\\sqrt{N!}} \\sum_{P \\in S_N} \\mathrm{sgn}(P) \\prod_{i=1}^N \\varphi_{P(i)}(x_i)\n$$\n其中 $S_N$ 是 $N$ 次对称群，而 $\\mathrm{sgn}(P)$ 是置换 $P$ 的符号。\n\n波函数的模方是：\n$$\n|\\Psi(x_1,\\dots,x_N)|^2 = \\Psi^* \\Psi = \\frac{1}{N!} \\left( \\sum_{P \\in S_N} \\mathrm{sgn}(P) \\prod_{i=1}^N \\varphi_{P(i)}^*(x_i) \\right) \\left( \\sum_{Q \\in S_N} \\mathrm{sgn}(Q) \\prod_{j=1}^N \\varphi_{Q(j)}(x_j) \\right)\n$$\n$$\n|\\Psi|^2 = \\frac{1}{N!} \\sum_{P,Q \\in S_N} \\mathrm{sgn}(P)\\mathrm{sgn}(Q) \\prod_{i=1}^N \\varphi_{P(i)}^*(x_i) \\varphi_{Q(i)}(x_i)\n$$\n问题中密度的定义涉及对坐标 $\\mathrm{d}\\mathbf{r}_2, \\dots, \\mathrm{d}\\mathbf{r}_N$ 的积分以及对自旋 $\\sigma_1, \\dots, \\sigma_N$ 的求和。组合操作 $\\sum_{\\sigma_i} \\int \\mathrm{d}\\mathbf{r}_i$ 是对完整坐标 $x_i$ 的积分，记为 $\\int \\mathrm{d}x_i$。我们首先对 $x_2, \\dots, x_N$ 进行积分：\n$$\n\\int \\mathrm{d}x_2 \\cdots \\mathrm{d}x_N \\, |\\Psi|^2 = \\frac{1}{N!} \\sum_{P,Q} \\mathrm{sgn}(P)\\mathrm{sgn}(Q) \\left(\\varphi_{P(1)}^*(x_1)\\varphi_{Q(1)}(x_1)\\right) \\prod_{i=2}^N \\int \\mathrm{d}x_i \\, \\varphi_{P(i)}^*(x_i)\\varphi_{Q(i)}(x_i)\n$$\n自旋轨道 $\\{\\varphi_k(x)\\}$ 构成一个标准正交集，即 $\\int \\mathrm{d}x \\, \\varphi_j^*(x)\\varphi_k(x) = \\delta_{jk}$。因此，乘积中的积分结果为 $\\delta_{P(i),Q(i)}$。为使该乘积不为零，必须对所有 $i \\in \\{2, \\dots, N\\}$ 都有 $P(i) = Q(i)$。由于 $P$ 和 $Q$ 都是集合 $\\{1, \\dots, N\\}$ 的置换，此条件也意味着必须有 $P(1) = Q(1)$。因此，这两个置换必须相同，即 $P=Q$。\n\n对 $P$ 和 $Q$ 的双重求和坍缩为对 $P$ 的单个求和，并且 $\\mathrm{sgn}(P)\\mathrm{sgn}(Q) = (\\mathrm{sgn}(P))^2 = 1$。\n$$\n\\int \\mathrm{d}x_2 \\cdots \\mathrm{d}x_N \\, |\\Psi|^2 = \\frac{1}{N!} \\sum_{P \\in S_N} |\\varphi_{P(1)}(x_1)|^2 \\prod_{i=2}^N \\delta_{P(i),P(i)} = \\frac{1}{N!} \\sum_{P \\in S_N} |\\varphi_{P(1)}(x_1)|^2\n$$\n求和遍及 $S_N$ 中的所有 $N!$ 个置换 $P$。对于任何给定的轨道指标 $k \\in \\{1, \\dots, N\\}$，有 $(N-1)!$ 个置换满足 $P(1)=k$（剩下的 $N-1$ 个指标可以有 $(N-1)!$ 种排列方式）。因此，我们可以根据 $P(1)$ 的值对求和进行重新分组：\n$$\n\\sum_{P \\in S_N} |\\varphi_{P(1)}(x_1)|^2 = \\sum_{k=1}^N \\sum_{P: P(1)=k} |\\varphi_k(x_1)|^2 = \\sum_{k=1}^N (N-1)! |\\varphi_k(x_1)|^2\n$$\n将此代回，我们得到：\n$$\n\\int \\mathrm{d}x_2 \\cdots \\mathrm{d}x_N \\, |\\Psi|^2 = \\frac{(N-1)!}{N!} \\sum_{k=1}^N |\\varphi_k(x_1)|^2 = \\frac{1}{N} \\sum_{k=1}^N |\\varphi_k(x_1)|^2\n$$\n现在我们回到密度 $n(\\mathbf{r})$ 的定义。剩下的操作是乘以 $N$ 并对第一个电子的自旋 $\\sigma_1$ 求和，其中 $\\mathbf{r}_1=\\mathbf{r}$。\n$$\nn(\\mathbf{r}) = N \\sum_{\\sigma_1} \\left( \\frac{1}{N} \\sum_{i=1}^N |\\varphi_i((\\mathbf{r}, \\sigma_1))|^2 \\right) = \\sum_{i=1}^N \\sum_{\\sigma_1} |\\varphi_i((\\mathbf{r},\\sigma_1))|^2\n$$\n问题陈述指出，每个自旋轨道可以分解为 $\\varphi_i(\\mathbf{r},\\sigma) = \\phi_i(\\mathbf{r})\\chi_i(\\sigma)$，其中 $\\chi_i(\\sigma)$ 是归一化的自旋量。自旋量的归一化条件是 $\\sum_{\\sigma} |\\chi_i(\\sigma)|^2 = 1$。将此分解代入密度表达式中：\n$$\nn(\\mathbf{r}) = \\sum_{i=1}^N \\sum_{\\sigma_1} |\\phi_i(\\mathbf{r}) \\chi_i(\\sigma_1)|^2 = \\sum_{i=1}^N |\\phi_i(\\mathbf{r})|^2 \\left( \\sum_{\\sigma_1} |\\chi_i(\\sigma_1)|^2 \\right)\n$$\n利用归一化条件，括号中的项等于 $1$。这就得到了期望的结果：\n$$\nn(\\mathbf{r}) = \\sum_{i=1}^{N} \\left| \\phi_i(\\mathbf{r}) \\right|^{2}\n$$\n\n**第二部分：在一维无限深方势阱中的应用**\n\n现在我们将此公式应用于宽度为 $L$ 的一维无限深方势阱中的 $N$ 个无相互作用无自旋费米子体系。“无自旋”一词意味着每个费米子的状态仅由其空间轨道描述。基态是通过占据能量最低的 $N$ 个单粒子能级本征态来形成的。归一化的空间轨道为：\n$$\n\\phi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right), \\quad n=1,2,\\dots,N\n$$\n基态密度 $n(x)$ 是已占据轨道模方的总和：\n$$\nn(x) = \\sum_{n=1}^{N} |\\phi_n(x)|^2 = \\sum_{n=1}^{N} \\left| \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right|^2 = \\frac{2}{L} \\sum_{n=1}^{N} \\sin^2\\left(\\frac{n\\pi x}{L}\\right)\n$$\n为了找到一个闭合形式的表达式，我们必须计算这个求和。我们使用三角恒等式 $\\sin^2(\\alpha) = \\frac{1}{2}(1 - \\cos(2\\alpha))$。令 $\\theta = \\frac{\\pi x}{L}$。\n$$\nn(x) = \\frac{2}{L} \\sum_{n=1}^{N} \\frac{1}{2}\\left(1 - \\cos(2n\\theta)\\right) = \\frac{1}{L} \\left( \\sum_{n=1}^{N} 1 - \\sum_{n=1}^{N} \\cos(2n\\theta) \\right)\n$$\n$$\nn(x) = \\frac{1}{L} \\left( N - \\sum_{n=1}^{N} \\cos(2n\\theta) \\right)\n$$\n余弦和可以使用 Lagrange 三角恒等式来计算，该恒等式可以通过取复指数等比级数的实部来推导。令 $C_N = \\sum_{n=1}^{N} \\cos(2n\\theta)$。\n考虑级数和 $S_N = \\sum_{n=1}^{N} e^{i2n\\theta} = \\sum_{n=1}^{N} (e^{i2\\theta})^n$。这是一个等比级数，首项为 $a = e^{i2\\theta}$，公比为 $r=e^{i2\\theta}$。\n$$\nS_N = a \\frac{1-r^N}{1-r} = e^{i2\\theta} \\frac{1-e^{i2N\\theta}}{1-e^{i2\\theta}} = e^{i2\\theta} \\frac{e^{iN\\theta}(e^{-iN\\theta}-e^{iN\\theta})}{e^{i\\theta}(e^{-i\\theta}-e^{i\\theta})}\n$$\n$$\nS_N = e^{i(N+1)\\theta} \\frac{-2i\\sin(N\\theta)}{-2i\\sin(\\theta)} = \\frac{\\sin(N\\theta)}{\\sin(\\theta)} e^{i(N+1)\\theta}\n$$\n$C_N$ 是 $S_N$ 的实部：\n$$\nC_N = \\mathrm{Re}\\left[ \\frac{\\sin(N\\theta)}{\\sin(\\theta)} (\\cos((N+1)\\theta) + i\\sin((N+1)\\theta)) \\right] = \\frac{\\sin(N\\theta)\\cos((N+1)\\theta)}{\\sin(\\theta)}\n$$\n使用积化和差恒等式 $2\\sin(A)\\cos(B) = \\sin(A+B) + \\sin(A-B)$，其中 $A=N\\theta$ 且 $B=(N+1)\\theta$：\n$$\nC_N = \\frac{\\frac{1}{2}[\\sin(N\\theta+(N+1)\\theta) + \\sin(N\\theta-(N+1)\\theta)]}{\\sin(\\theta)} = \\frac{\\frac{1}{2}[\\sin((2N+1)\\theta) - \\sin(\\theta)]}{\\sin(\\theta)}\n$$\n$$\nC_N = \\frac{\\sin((2N+1)\\theta)}{2\\sin(\\theta)} - \\frac{1}{2}\n$$\n将 $C_N$ 的这个结果代回到 $n(x)$ 的表达式中：\n$$\nn(x) = \\frac{1}{L} \\left( N - \\left[\\frac{\\sin((2N+1)\\theta)}{2\\sin(\\theta)} - \\frac{1}{2}\\right] \\right)\n$$\n$$\nn(x) = \\frac{1}{L} \\left( N + \\frac{1}{2} - \\frac{\\sin((2N+1)\\theta)}{2\\sin(\\theta)} \\right)\n$$\n最后，代回 $\\theta = \\frac{\\pi x}{L}$，我们得到势阱内部（$0  x  L$）的密度表达式：\n$$\nn(x) = \\frac{1}{L} \\left( N + \\frac{1}{2} - \\frac{\\sin\\left((2N+1)\\frac{\\pi x}{L}\\right)}{2\\sin\\left(\\frac{\\pi x}{L}\\right)} \\right)\n$$",
            "answer": "$$\\boxed{\\frac{1}{L} \\left( N + \\frac{1}{2} - \\frac{\\sin\\left((2N+1)\\frac{\\pi x}{L}\\right)}{2\\sin\\left(\\frac{\\pi x}{L}\\right)} \\right)}$$"
        },
        {
            "introduction": "Hohenberg-Kohn 第二定理为我们提供了一个强大的计算工具：能量泛函的变分原理。该原理指出，对于真实的基态电子密度，能量泛函将取最小值。这个练习将让你亲手应用这一原理来解决一个具体的物理体系——谐振子。通过在一个试探密度族中最小化总能量泛函，你将体验到密度泛函理论是如何确定基态性质的，并验证其惊人的准确性。",
            "id": "3493769",
            "problem": "考虑密度泛函理论（DFT）中的霍恩伯格-科恩变分原理，该原理指出，对于固定的外势 $v(x)$，基态能量可以通过在所有满足归一化和非负性条件的 v-可表示粒子密度 $n(x)$ 上最小化总能量泛函 $E_{v}[n]$ 来获得。在一维空间（$x \\in \\mathbb{R}$）中进行计算，并采用原子单位，其中 $\\hbar = 1$ 且 $m = 1$，因此能量以哈特里（Hartree）为单位。对于谐振子势 $v(x) = \\frac{1}{2}\\,\\omega^{2} x^{2}$（其中 $\\omega  0$）中的单个粒子，忽略电子-电子相互作用，并使用魏茨泽克动能泛函来近似普适泛函。一维下的魏茨泽克动能泛函为\n$$\nT_{W}[n] \\;=\\; \\frac{1}{8}\\,\\int_{-\\infty}^{\\infty} \\frac{\\big(n'(x)\\big)^{2}}{n(x)}\\,dx,\n$$\n总能量泛函为\n$$\nE_{v}[n] \\;=\\; T_{W}[n] \\;+\\; \\int_{-\\infty}^{\\infty} v(x)\\,n(x)\\,dx.\n$$\n为了说明变分最小化过程，考虑一个由 $\\beta0$ 参数化的、归一化的非负高斯试探密度\n$$\nn_{\\beta}(x) \\;=\\; \\sqrt{\\frac{\\beta}{\\pi}}\\,\\exp\\!\\big(-\\beta x^{2}\\big),\n$$\n该密度满足 $\\int_{-\\infty}^{\\infty} n_{\\beta}(x)\\,dx = 1$。使用此试探族：\n- 推导总能量泛函 $E_{v}[n_{\\beta}]$ 关于 $\\beta$ 和 $\\omega$ 的闭式表达式 $E(\\beta)$。\n- 对 $E(\\beta)$ 关于 $\\beta0$ 进行最小化，以获得最优参数 $\\beta^{\\star}$ 和最小化后的能量 $E_{\\min} = E(\\beta^{\\star})$。\n\n以关于 $\\omega$ 的精确表达式报告您的最终结果，不要进行数值近似。能量以哈特里表示。以数对 $\\big(\\beta^{\\star},\\,E_{\\min}\\big)$ 的形式提供您的最终答案。",
            "solution": "该问题被验证为科学上成立、良定且客观。它展示了密度泛函理论（DFT）中的变分原理在一个典范体系——一维谐振子上的标准应用。所有必要信息均已提供，所要求的计算是可行且定义明确的。\n\n目标是求出单粒子体系的总能量，作为其试探密度中参数 $\\beta$ 的函数，然后对该能量关于 $\\beta$ 进行最小化。该体系由一维外势 $v(x) = \\frac{1}{2}\\omega^2 x^2$ 描述，使用原子单位（$\\hbar=1$ 和 $m=1$）。总能量泛函由下式给出\n$$\nE_{v}[n] \\;=\\; T_{W}[n] \\;+\\; \\int_{-\\infty}^{\\infty} v(x)\\,n(x)\\,dx\n$$\n其中 $T_W[n]$ 是魏茨泽克动能泛函。试探密度族是一个归一化的高斯函数：\n$$\nn_{\\beta}(x) \\;=\\; \\sqrt{\\frac{\\beta}{\\pi}}\\,\\exp(-\\beta x^{2})\n$$\n其中 $\\beta  0$。我们需要求出 $E(\\beta) = E_v[n_\\beta]$ 的表达式，然后找到使该能量最小化的最优参数 $\\beta^{\\star}$，以及最小值 $E_{\\min} = E(\\beta^{\\star})$。\n\n首先，我们计算魏茨泽克动能项 $T_W[n_\\beta]$。这需要密度的导数 $n'_{\\beta}(x)$。\n$$\nn'_{\\beta}(x) = \\frac{d}{dx}\\left( \\sqrt{\\frac{\\beta}{\\pi}}\\,\\exp(-\\beta x^{2}) \\right) = \\sqrt{\\frac{\\beta}{\\pi}}\\,\\exp(-\\beta x^{2}) \\cdot (-2\\beta x) = -2\\beta x \\, n_{\\beta}(x)\n$$\n现在，我们可以构建 $T_W[n_\\beta]$ 的被积函数：\n$$\n\\frac{\\big(n'_{\\beta}(x)\\big)^{2}}{n_{\\beta}(x)} = \\frac{\\big(-2\\beta x \\, n_{\\beta}(x)\\big)^2}{n_{\\beta}(x)} = \\frac{4\\beta^2 x^2 \\big(n_{\\beta}(x)\\big)^2}{n_{\\beta}(x)} = 4\\beta^2 x^2 n_{\\beta}(x)\n$$\n将此代入 $T_W[n_\\beta]$ 的表达式中，得到：\n$$\nT_W[n_\\beta] = \\frac{1}{8} \\int_{-\\infty}^{\\infty} 4\\beta^2 x^2 n_{\\beta}(x) \\,dx = \\frac{\\beta^2}{2} \\int_{-\\infty}^{\\infty} x^2 n_{\\beta}(x) \\,dx\n$$\n积分 $\\int_{-\\infty}^{\\infty} x^2 n_{\\beta}(x) \\,dx$ 是给定密度分布下 $x^2$ 的期望值，记为 $\\langle x^2 \\rangle$。我们可以显式地计算它：\n$$\n\\int_{-\\infty}^{\\infty} x^2 n_{\\beta}(x) \\,dx = \\int_{-\\infty}^{\\infty} x^2 \\sqrt{\\frac{\\beta}{\\pi}}\\,\\exp(-\\beta x^{2}) \\,dx = \\sqrt{\\frac{\\beta}{\\pi}} \\int_{-\\infty}^{\\infty} x^2 \\exp(-\\beta x^{2}) \\,dx\n$$\n我们使用标准高斯积分结果：\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\,dx = \\frac{1}{2a} \\sqrt{\\frac{\\pi}{a}}\n$$\n令 $a = \\beta$，我们发现：\n$$\n\\int_{-\\infty}^{\\infty} x^2 n_{\\beta}(x) \\,dx = \\sqrt{\\frac{\\beta}{\\pi}} \\left( \\frac{1}{2\\beta} \\sqrt{\\frac{\\pi}{\\beta}} \\right) = \\sqrt{\\frac{\\beta}{\\pi}} \\frac{\\sqrt{\\pi}}{2\\beta^{3/2}} = \\frac{1}{2\\beta}\n$$\n因此，动能项为：\n$$\nT_W[n_\\beta] = \\frac{\\beta^2}{2} \\left( \\frac{1}{2\\beta} \\right) = \\frac{\\beta}{4}\n$$\n接下来，我们计算势能项 $V[n_\\beta] = \\int_{-\\infty}^{\\infty} v(x) n_{\\beta}(x) \\,dx$：\n$$\nV[n_\\beta] = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2}\\omega^2 x^2 \\right) n_{\\beta}(x) \\,dx = \\frac{\\omega^2}{2} \\int_{-\\infty}^{\\infty} x^2 n_{\\beta}(x) \\,dx\n$$\n这个积分与我们刚才计算的期望值 $\\langle x^2 \\rangle$ 相同。\n$$\nV[n_\\beta] = \\frac{\\omega^2}{2} \\left( \\frac{1}{2\\beta} \\right) = \\frac{\\omega^2}{4\\beta}\n$$\n总能量 $E(\\beta)$ 是动能项和势能项之和：\n$$\nE(\\beta) = T_W[n_\\beta] + V[n_\\beta] = \\frac{\\beta}{4} + \\frac{\\omega^2}{4\\beta}\n$$\n这就是总能量关于 $\\beta$ 和 $\\omega$ 的闭式表达式。\n\n为了找到最小能量，我们必须对 $E(\\beta)$ 关于 $\\beta$ 求最小值。我们首先求 $E(\\beta)$ 的导数，并令其为零，以找到最优参数 $\\beta^{\\star}$。\n$$\n\\frac{dE}{d\\beta} = \\frac{d}{d\\beta} \\left( \\frac{\\beta}{4} + \\frac{\\omega^2}{4\\beta} \\right) = \\frac{1}{4} - \\frac{\\omega^2}{4\\beta^2}\n$$\n将导数设为零：\n$$\n\\frac{1}{4} - \\frac{\\omega^2}{4(\\beta^{\\star})^2} = 0 \\quad \\implies \\quad \\frac{1}{4} = \\frac{\\omega^2}{4(\\beta^{\\star})^2}\n$$\n$$\n(\\beta^{\\star})^2 = \\omega^2\n$$\n由于给定 $\\beta  0$ 和 $\\omega  0$，我们取正根：\n$$\n\\beta^{\\star} = \\omega\n$$\n为了确认这是一个最小值，我们检查二阶导数：\n$$\n\\frac{d^2E}{d\\beta^2} = \\frac{d}{d\\beta} \\left( \\frac{1}{4} - \\frac{\\omega^2}{4}\\beta^{-2} \\right) = - \\frac{\\omega^2}{4}(-2\\beta^{-3}) = \\frac{\\omega^2}{2\\beta^3}\n$$\n在 $\\beta = \\beta^{\\star} = \\omega$ 处，二阶导数为 $\\frac{\\omega^2}{2\\omega^3} = \\frac{1}{2\\omega}$。由于 $\\omega  0$，二阶导数为正，这证实了 $\\beta^{\\star} = \\omega$ 对应一个局域最小值。\n\n最后，我们将 $\\beta^{\\star}$ 代入 $E(\\beta)$ 的表达式中，计算最小化后的能量 $E_{\\min}$：\n$$\nE_{\\min} = E(\\beta^{\\star}) = E(\\omega) = \\frac{\\omega}{4} + \\frac{\\omega^2}{4\\omega} = \\frac{\\omega}{4} + \\frac{\\omega}{4} = \\frac{2\\omega}{4} = \\frac{\\omega}{2}\n$$\n最小化后的能量为 $E_{\\min} = \\frac{\\omega}{2}$ 哈特里。这个结果正确地恢复了一维量子谐振子的精确基态能量 $E_0 = \\frac{1}{2}\\hbar\\omega$（在原子单位下，$\\hbar=1$）。这是预料之中的，因为当 $\\beta = \\omega$ 时，试探密度族 $n_\\beta(x)$ 包含了精确的基态密度，并且对于单粒子体系，魏茨泽克泛函是精确的动能泛函。\n\n最终结果是 $\\beta^{\\star} = \\omega$ 和 $E_{\\min} = \\frac{\\omega}{2}$。",
            "answer": "$$\n\\boxed{(\\omega, \\frac{\\omega}{2})}\n$$"
        },
        {
            "introduction": "Hohenberg-Kohn 定理的严谨性建立在一些关键假设之上，其中最著名的是基态的非简并性。这项高级计算练习将挑战你构建一个场景，以简单的两格点 Hubbard 模型为例，来检验当这一假设被违背时会发生什么。你将亲眼见证基态简并性是如何导致从密度到势的唯一映射关系失效的，从而深刻理解该定理的适用边界。",
            "id": "3493735",
            "problem": "您的任务是，在一个双点离散化的一维相互作用电子系统中，根据Hohenberg-Kohn定理的意义，对基态粒子密度与外势之间的映射中的非唯一性情景进行形式化、分析和算法诊断。目标是构建两个不同的外势，由于对称性引起的简并，它们产生相同的基态密度，并指出这违反了第一Hohenberg-Kohn定理的哪个假设，然后实现一个能够识别这种模糊性的密度反演算法。\n\n数学模型和允许的基：\n- 从具有固定电子数、受外势和两体相互作用影响的多体薛定谔模型出发。使用由两个位点表示的离散化一维区间，这是一维有限区间的最小有限差分简化。设多体哈密顿量为双位点Hubbard哈密顿量\n$$\n\\hat{H} = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( \\hat{c}^{\\dagger}_{1\\sigma} \\hat{c}_{2\\sigma} + \\hat{c}^{\\dagger}_{2\\sigma} \\hat{c}_{1\\sigma} \\right)\n+ U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow} \\hat{n}_{i\\downarrow}\n+ \\sum_{i=1}^{2} v_i \\left( \\hat{n}_{i\\uparrow} + \\hat{n}_{i\\downarrow} \\right),\n$$\n其中跃迁振幅 $t \\ge 0$，在位相互作用 $U \\ge 0$，位点势 $v_1, v_2 \\in \\mathbb{R}$。粒子数算符为 $\\hat{n}_{i\\sigma} = \\hat{c}^{\\dagger}_{i\\sigma}\\hat{c}_{i\\sigma}$，其中 $i \\in \\{1,2\\}$，自旋为 $\\sigma$。在固定粒子数 $N=2$ 的条件下进行计算。将势参数化为 $v_1 = +\\Delta$ 和 $v_2 = -\\Delta$，其中 $\\Delta \\in \\mathbb{R}$。根据Hohenberg-Kohn定理关于势在相差一个常数下的唯一性精神，这种构造消除了任何加性常数。\n\n- 每个位点的基态密度定义为\n$$\nn_i = \\langle \\hat{n}_{i\\uparrow} + \\hat{n}_{i\\downarrow} \\rangle,\n$$\n其中 $\\langle \\cdot \\rangle$ 是在基态下求的期望值。在存在基态简并的情况下，使用对简并基态子空间中所有态的等权重系综平均来定义 $n_i$。\n\n非唯一性和诊断的设计目标：\n- 构建两个不同的势，其参数 $\\Delta_1 \\ne \\Delta_2$，由于对称性引起的简并，它们产生相同的基态密度 $\\mathbf{n} = (n_1,n_2)$。您必须准确指出在这种构造中违反了第一Hohenberg-Kohn定理的哪个假设。\n\n- 实现一个密度反演算法。给定一个目标密度向量 $\\mathbf{n}^{\\mathrm{target}} = (n_1^{\\mathrm{target}}, n_2^{\\mathrm{target}})$ 和固定的 $(t,U)$，该算法搜索 $\\Delta$ 的值，使得基态密度 $\\mathbf{n}(\\Delta;t,U)$ 在指定的容差内与 $\\mathbf{n}^{\\mathrm{target}}$ 匹配。如果多于一个不同的 $\\Delta$ 值实现了匹配，则报告反演存在歧义。此外，报告在任何匹配的 $\\Delta$ 值下基态是否简并（以将歧义与违反Hohenberg-Kohn唯一定理所需假设联系起来）。\n\n算法约束：\n- 您的程序必须通过在 $N=2$ 的Fock子空间中对角化哈密顿量来计算精确基态，通过在小容差内比较本征值来检测基态简并，将 $n_1$ 和 $n_2$ 计算为简并基态上的系综平均，并在指定区间内对 $\\Delta$ 进行网格搜索以实现密度反演。\n\n- 在这个离散模型中，所有能量和密度都是无量纲的；不需要进行物理单位转换。\n\n测试套件和要求输出：\n- 使用以下三个测试用例。在所有情况下，密度匹配的容差必须为 $10^{-6}$，如果两个 $\\Delta$ 值的差异至少为 $10^{-3}$，则它们被视为不同的。\n\n1) 理想情况下的非简并反演：\n   - 参数：$t=1$, $U=4$, 真实参数 $\\Delta_{\\mathrm{true}}=0.5$。\n   - 根据 $(t,U,\\Delta_{\\mathrm{true}})$ 计算 $\\mathbf{n}^{\\mathrm{target}}$。\n   - 反演：在 $\\Delta \\in [-1,1]$ 的均匀网格上搜索，步长为 $10^{-3}$。\n   - 此用例的输出：恢复的与 $\\mathbf{n}^{\\mathrm{target}}$ 匹配的 $\\Delta$ 值，四舍五入到三位小数。如果存在多个匹配项，则选择 $|\\Delta|$ 最小的一个。\n\n2) 对称性引起的简并导致非唯一性：\n   - 参数：$t=0$, $U=10$，以及两个不同的势 $\\Delta_1=1$ 和 $\\Delta_2=-3$。\n   - 直接验证 $(t,U,\\Delta_1)$ 和 $(t,U,\\Delta_2)$ 都产生相同的基态密度 $\\mathbf{n}$；报告一个布尔值表示是否相等（每个分量的容差为 $10^{-12}$）。\n   - 指出第一Hohenberg-Kohn定理的哪个假设被违反，并将其操作化为一个布尔值：报告在这些参数下基态是否简并（如果超过一个本征态的能量在最小值的 $10^{-8}$ 范围内，则为简并）。\n   - 反演：将目标密度设置为 $\\mathbf{n}^{\\mathrm{target}}=(1,1)$，在 $\\Delta \\in [-4,4]$ 范围内搜索，步长为 $10^{-3}$，并报告一个指示反演歧义的布尔值（如果超过一个不同的 $\\Delta$ 值匹配，则为真）。\n\n3) 密度为零位点的边界情况（与简并无关的反演病态）：\n   - 参数：$t=0$, $U=10$, $\\Delta_{\\mathrm{true}}=6$。\n   - 根据 $(t,U,\\Delta_{\\mathrm{true}})$ 计算 $\\mathbf{n}^{\\mathrm{target}}$，并在 $\\Delta \\in [-10,10]$ 范围内进行反演，步长为 $10^{-3}$。\n   - 报告一个表示基态简并的布尔值（如上），以及一个表示反演歧义的布尔值（多于一个匹配的 $\\Delta$）。这个边界情况测试了即使没有简并，反演也可能不是唯一的，因为其中一个位点的密度为零，使得该位点上的势在一定范围内对操作无影响。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按以下顺序排列结果：\n  - 用例1：恢复的 $\\Delta$ 值（浮点数，四舍五入到三位小数）。\n  - 用例2：$\\Delta_1$ 和 $\\Delta_2$ 的密度是否相等（布尔值）。\n  - 用例2：是否检测到基态简并（布尔值）。\n  - 用例2：反演是否有歧义（布尔值）。\n  - 用例3：是否检测到基态简并（布尔值）。\n  - 用例3：反演是否有歧义（布尔值）。\n\n例如，输出格式必须严格如下所示\n$$\n[\\delta_1,\\mathrm{eq2},\\mathrm{deg2},\\mathrm{amb2},\\mathrm{deg3},\\mathrm{amb3}],\n$$\n不得有任何附加文本。此问题陈述中的所有数学符号和数字都是无量纲的；输出中不需要也不允许使用单位。",
            "solution": "用户要求对密度泛函理论（DFT）中的一个非唯一性情景进行分析和算法实现，并使用双位点Hubbard模型作为一个最小的例子。问题的核心是展示对称性引起的基态简并如何导致外势与基态密度之间一对一映射的失效，而该映射是Hohenberg-Kohn（HK）定理的基石之一。\n\n### 1. 理论框架：双位点Hubbard模型\n\n该系统包含$N=2$个电子，分布在两个空间位点上，标记为$i=1, 2$。哈密顿量由下式给出：\n$$\n\\hat{H} = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( \\hat{c}^{\\dagger}_{1\\sigma} \\hat{c}_{2\\sigma} + \\hat{c}^{\\dagger}_{2\\sigma} \\hat{c}_{1\\sigma} \\right)\n+ U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow} \\hat{n}_{i\\downarrow}\n+ \\sum_{i=1}^{2} v_i \\hat{n}_i.\n$$\n这里，$t \\ge 0$是跃迁振幅，$U \\ge 0$是在位库仑排斥，$v_i$是位点$i$上的外势。势被参数化为$v_1 = +\\Delta$和$v_2 = -\\Delta$，这确保了当$\\Delta \\ne 0$时，$v_1$和$v_2$仅相差一个非恒定项。位点$i$上的总密度算符是$\\hat{n}_i = \\hat{n}_{i\\uparrow} + \\hat{n}_{i\\downarrow}$。\n\n### 2. 基态和哈密顿量矩阵\n\n对于两个位点上的$N=2$个电子，希尔伯特空间的维度为$\\binom{4}{2}=6$。一个方便的基是尊重哈密顿量总自旋守恒的基。哈密顿量具有自旋旋转不变性，因此总自旋$S$及其投影$S_z$是守恒的。基态可以分为自旋三重态（$S=1$）和自旋单重态（$S=0$）。\n\n**自旋三重态（$S=1$）：**\n有三个三重态，为了满足泡利不相容原理，每个位点上有一个电子。\n\\begin{align*}\n|T_1\\rangle = |\\uparrow, \\uparrow\\rangle = \\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{2\\uparrow}|0\\rangle  (S_z=1) \\\\\n|T_{-1}\\rangle = |\\downarrow, \\downarrow\\rangle = \\hat{c}^{\\dagger}_{1\\downarrow}\\hat{c}^{\\dagger}_{2\\downarrow}|0\\rangle  (S_z=-1) \\\\\n|T_0\\rangle = \\frac{1}{\\sqrt{2}}(|\\uparrow, \\downarrow\\rangle + |\\downarrow, \\uparrow\\rangle) = \\frac{1}{\\sqrt{2}}(\\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{2\\downarrow} + \\hat{c}^{\\dagger}_{1\\downarrow}\\hat{c}^{\\dagger}_{2\\uparrow})|0\\rangle  (S_z=0)\n\\end{align*}\n对于所有三重态，没有双占据情况，因此在位相互作用项$\\hat{H}_U$的贡献为零。每个位点的密度为$n_1=1$和$n_2=1$，所以势能项$\\hat{H}_v = \\Delta(\\hat{n}_1 - \\hat{n}_2)$的贡献也为零。由于泡利原理（例如，将一个电子跃迁到已存在相同自旋电子的位点是被禁止的），跃迁项$\\hat{H}_t$作用于这些态的结果也为零。因此，对于任何$t, U, \\Delta$，所有三个三重态都是$\\hat{H}$的本征态，本征值为$E_T=0$。\n$$\n\\hat{H}|T_1\\rangle = 0, \\quad \\hat{H}|T_{-1}\\rangle = 0, \\quad \\hat{H}|T_0\\rangle = 0.\n$$\n\n**自旋单重态（$S=0$）：**\n有三个单重态。两个对应于双占据位点（离子态），一个对应于单占据（共价态）。\n\\begin{align*}\n|S_1\\rangle = |\\uparrow\\downarrow, 0\\rangle = \\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{1\\downarrow}|0\\rangle \\\\\n|S_2\\rangle = |0, \\uparrow\\downarrow\\rangle = \\hat{c}^{\\dagger}_{2\\uparrow}\\hat{c}^{\\dagger}_{2\\downarrow}|0\\rangle \\\\\n|S_3\\rangle = \\frac{1}{\\sqrt{2}}(|\\uparrow, \\downarrow\\rangle - |\\downarrow, \\uparrow\\rangle) = \\frac{1}{\\sqrt{2}}(\\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{2\\downarrow} - \\hat{c}^{\\dagger}_{1\\downarrow}\\hat{c}^{\\dagger}_{2\\uparrow})|0\\rangle\n\\end{align*}\n哈密顿量不混合单重态和三重态。在由$\\{|S_1\\rangle, |S_2\\rangle, |S_3\\rangle\\}$张成的单重态子空间中，哈密顿量矩阵为：\n$$\nH_S =\n\\begin{pmatrix}\nU+2\\Delta   0   -\\sqrt{2}t \\\\\n0   U-2\\Delta   -\\sqrt{2}t \\\\\n-\\sqrt{2}t   -\\sqrt{2}t   0\n\\end{pmatrix}.\n$$\n这个$3 \\times 3$矩阵的本征值给出了三个单重态能量。\n\n### 3. 基态和密度计算\n\n哈密顿量的完整能谱由三个三重态本征值（$E=0$）和来自$H_S$的三个单重态本征值组成。基态能量$E_{GS}$是这六个能量中的最小值。\n- 如果基态是唯一的，即$|\\Psi_{GS}\\rangle = c_1|S_1\\rangle+c_2|S_2\\rangle+c_3|S_3\\rangle$，其密度向量$\\mathbf{n}=(n_1, n_2)$可计算为$n_i = \\langle \\Psi_{GS} | \\hat{n}_i | \\Psi_{GS} \\rangle$。基态的密度分别为$|S_1\\rangle$的$(2,0)$，$|S_2\\rangle$的$(0,2)$，以及$|S_3\\rangle$和所有三重态的$(1,1)$。这导致$n_1 = 2|c_1|^2 + |c_3|^2$和$n_2 = 2|c_2|^2 + |c_3|^2$。\n- 如果基态是$d$重简并的，密度是简并态$\\{\\Psi_{k}\\}_{k=1}^d$上的系综平均：\n$$\n\\mathbf{n} = \\frac{1}{d} \\sum_{k=1}^{d} \\langle \\Psi_{k} | \\hat{\\mathbf{n}} | \\Psi_{k} \\rangle.\n$$\n\n### 4. 违反Hohenberg-Kohn定理的假设\n\n第一Hohenberg-Kohn定理保证了从基态密度$n(\\mathbf{r})$到外势$v(\\mathbf{r})$的唯一映射（相差一个加性常数）。标准的归谬法证明假设基态是非简并的。如果两个不同的势$v_1$和$v_2$共享一个简并的基态子空间，就有可能构造出它们产生相同基态密度的情景，从而违反$n \\to v$映射的唯一性。本问题要求构造这样一个情景。\n\n让我们分析$t=0$的情况。哈密顿量矩阵$H_S$变为对角矩阵：\n$$\nH_S(t=0) = \\begin{pmatrix} U+2\\Delta   0   0 \\\\ 0   U-2\\Delta   0 \\\\ 0   0   0 \\end{pmatrix}.\n$$\n$\\hat{H}$的六个本征值为$\\{U+2\\Delta, U-2\\Delta, 0, 0, 0, 0\\}$。能量为$E=0$的四个态是三个三重态和单重态$|S_3\\rangle$。这四个态都具有密度分布$\\mathbf{n}=(1,1)$。\n\n基态能量为$E_{GS} = \\min(U+2\\Delta, U-2\\Delta, 0)$。只要$U+2\\Delta \\ge 0$且$U-2\\Delta \\ge 0$，基态能量将为$E_{GS}=0$。这些条件等价于$-U/2 \\le \\Delta \\le U/2$。对于此范围内的任何$\\Delta$，基态至少是四重简并的，重要的是，这个简并流形的所有组分态都具有相同的密度$\\mathbf{n}=(1,1)$。因此，系综平均密度也是$\\mathbf{n}=(1,1)$。\n\n这就产生了非唯一性：任何两个不同的势$\\Delta_1 \\ne \\Delta_2$，只要$\\Delta_1, \\Delta_2 \\in [-U/2, U/2]$，它们就是不同的势（它们不相差一个常数），但它们产生相同的基态密度向量$\\mathbf{n}=(1,1)$。被违反的假设是**基态的非简并性**。\n\n### 5. 密度反演算法和测试用例分析\n\n该算法涉及在给定目标密度$\\mathbf{n}^{\\mathrm{target}}$的情况下，对参数$\\Delta$进行网格搜索。\n\n**用例1：($t=1, U=4, \\Delta_{\\mathrm{true}}=0.5$)**\n对于$t0$和一般参数，简并被解除。我们期望一个唯一的、非简并的基态。反演算法为$\\Delta_{\\mathrm{true}}=0.5$计算$\\mathbf{n}^{\\mathrm{target}}$，然后在指定范围内搜索一个匹配的$\\Delta$。预期在$\\Delta=0.5$附近会有一个唯一的匹配。\n\n**用例2：($t=0, U=10, \\Delta_1=1, \\Delta_2=-3$)**\n这里，$U/2 = 5$。$\\Delta_1=1$和$\\Delta_2=-3$都位于区间$[-5, 5]$内。根据上述分析，对于这两个$\\Delta$值，基态都是四重简并的，能量为$E_{GS}=0$，密度为$\\mathbf{n}=(1,1)$。因此，密度相等，且基态是简并的。对$\\mathbf{n}^{\\mathrm{target}}=(1,1)$的反演会发现，在搜索范围$[-4,4]$内的所有$\\Delta$值都产生目标密度，从而证明了歧义性。\n\n**用例3：($t=0, U=10, \\Delta_{\\mathrm{true}}=6$)**\n这里，$\\Delta_{\\mathrm{true}}=6  U/2=5$。本征值为$\\{10+12, 10-12, 0, 0, 0, 0\\} = \\{22, -2, 0, 0, 0, 0\\}$。基态是唯一的，能量为$E_{GS}=-2$，对应于态$|S_2\\rangle=|0, \\uparrow\\downarrow\\rangle$。基态是非简并的。密度为$\\mathbf{n}^{\\mathrm{target}}=(0,2)$。\n对于反演，我们寻找能产生$\\mathbf{n}=(0,2)$的$\\Delta$值。这要求$|S_2\\rangle$是唯一的基态，这在$U-2\\Delta$是最小能量时发生。这要求$U-2\\Delta  0$且$U-2\\Delta  U+2\\Delta$。第一个条件给出$10  2\\Delta$，即$\\Delta  5$。对于$\\Delta0$，第二个条件总是成立。因此，任何$\\Delta  5$都会给出相同的基态密度$\\mathbf{n}=(0,2)$。在$\\Delta \\in [-10, 10]$上的搜索会发现，区间$(5, 10]$内的所有值都是解，因此反演存在歧义。这说明了另一种唯一性失效的情况，发生在某个位点上的密度为零时，使得该位点上的势在一定范围内对能量无关紧要。这种情况是非简并的，与用例2中的机制不同。",
            "answer": "$$[0.500, \\mathrm{true}, \\mathrm{true}, \\mathrm{true}, \\mathrm{false}, \\mathrm{true}]$$"
        }
    ]
}