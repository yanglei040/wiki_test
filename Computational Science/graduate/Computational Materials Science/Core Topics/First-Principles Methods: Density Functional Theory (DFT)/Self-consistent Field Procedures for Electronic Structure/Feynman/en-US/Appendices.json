{
    "hands_on_practices": [
        {
            "introduction": "The self-consistent field (SCF) procedure is fundamentally an iterative search for a fixed point, where an input electronic density generates a potential that, in turn, reproduces the same density. This first exercise provides a concrete, hands-on calculation of a single step in this iterative map, $\\rho_{\\text{in}} \\rightarrow \\rho_{\\text{out}}$. By working through this one-dimensional model, you will practice constructing an output density from a given set of orbitals and understand the rationale behind linear mixing, the simplest and most fundamental technique for stabilizing SCF iterations and preventing oscillatory divergence.",
            "id": "3486399",
            "problem": "Consider a one-dimensional model of noninteracting electrons in the Kohn–Sham formulation of Density Functional Theory (DFT), where the one-body electron density is obtained from a set of orthonormal single-particle orbitals and their occupations. Let the orthonormal orbitals be the first two eigenfunctions of the one-dimensional quantum harmonic oscillator of mass $m$ and angular frequency $\\omega$, with the standard normalization convention:\n$$\n\\psi_{0}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\exp\\!\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right), \\quad \\psi_{1}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\sqrt{2}\\,\\sqrt{\\frac{m \\omega}{\\hbar}}\\, x \\exp\\!\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right).\n$$\nAssume the occupation numbers are $f_{0} = 1$ and $f_{1} = \\frac{1}{2}$, and that the input density entering the Self-Consistent Field (SCF) procedure is a normalized Gaussian chosen to integrate to the same total electron number $N = f_{0} + f_{1}$:\n$$\n\\rho_{\\text{in}}(x) = N \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}), \\quad b>0,\n$$\nwhere $N = f_{0} + f_{1}$ and $\\hbar$ is the reduced Planck constant.\n\nUsing only the standard definitions of the one-body density in the Kohn–Sham formalism and the construction of Slater determinants for orthonormal orbitals, compute the output density $\\rho_{\\text{out}}(x)$ associated with the set $\\{\\psi_{i}\\}$ and $\\{f_{i}\\}$. Then, explain the rationale for density mixing in a fixed-point iteration and form the next-iteration mixed density $\\rho_{\\text{next}}(x)$ using linear mixing with a mixing parameter $\\alpha \\in (0,1)$. Provide your final result as closed-form analytic expressions for $\\rho_{\\text{out}}(x)$ and $\\rho_{\\text{next}}(x)$.\n\nExpress your final answers as analytic functions of $x$ with parameters $m$, $\\omega$, $\\hbar$, $b$, and $\\alpha$. No numerical rounding is required. If you present multiple expressions, write them as a single row matrix. No physical units need to be reported in the final answer box.",
            "solution": "The problem has been validated and is deemed scientifically grounded, well-posed, and objective. It is a standard theoretical exercise in computational electronic structure theory. All necessary data and definitions are provided, and the problem is free of contradictions or ambiguities.\n\nThe one-body electron density, $\\rho(x)$, in the Kohn-Sham formalism is constructed from the set of single-particle orbitals $\\{\\psi_i(x)\\}$ and their corresponding occupation numbers $\\{f_i\\}$ according to the formula:\n$$\n\\rho(x) = \\sum_{i} f_{i} |\\psi_{i}(x)|^{2}\n$$\n\nFirst, we compute the output density, $\\rho_{\\text{out}}(x)$, using the provided orbitals $\\psi_{0}(x)$ and $\\psi_{1}(x)$, and occupation numbers $f_{0}=1$ and $f_{1}=\\frac{1}{2}$.\n\nThe given orthonormal orbitals are:\n$$\n\\psi_{0}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\exp\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right)\n$$\n$$\n\\psi_{1}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\sqrt{2}\\,\\sqrt{\\frac{m \\omega}{\\hbar}}\\, x \\exp\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right)\n$$\nTo simplify the notation, let us define the parameter $\\gamma = \\frac{m \\omega}{\\hbar}$. The orbitals can then be written as:\n$$\n\\psi_{0}(x) = \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right)\n$$\n$$\n\\psi_{1}(x) = \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\sqrt{2\\gamma}\\, x \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right)\n$$\nNext, we find the squared magnitudes of these orbitals:\n$$\n|\\psi_{0}(x)|^{2} = \\left[ \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right) \\right]^2 = \\sqrt{\\frac{\\gamma}{\\pi}} \\exp(-\\gamma x^{2})\n$$\n$$\n|\\psi_{1}(x)|^{2} = \\left[ \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\sqrt{2\\gamma}\\, x \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right) \\right]^2 = \\sqrt{\\frac{\\gamma}{\\pi}} (2\\gamma x^{2}) \\exp(-\\gamma x^{2})\n$$\nNow, we can construct the output density $\\rho_{\\text{out}}(x)$ using the occupation numbers $f_{0}=1$ and $f_{1}=\\frac{1}{2}$:\n$$\n\\rho_{\\text{out}}(x) = f_{0} |\\psi_{0}(x)|^{2} + f_{1} |\\psi_{1}(x)|^{2}\n$$\n$$\n\\rho_{\\text{out}}(x) = (1) \\left(\\sqrt{\\frac{\\gamma}{\\pi}} \\exp(-\\gamma x^{2})\\right) + \\left(\\frac{1}{2}\\right) \\left(\\sqrt{\\frac{\\gamma}{\\pi}} (2\\gamma x^{2}) \\exp(-\\gamma x^{2})\\right)\n$$\n$$\n\\rho_{\\text{out}}(x) = \\sqrt{\\frac{\\gamma}{\\pi}} \\exp(-\\gamma x^{2}) + \\sqrt{\\frac{\\gamma}{\\pi}} \\gamma x^{2} \\exp(-\\gamma x^{2})\n$$\nFactoring out the common terms, we get:\n$$\n\\rho_{\\text{out}}(x) = \\sqrt{\\frac{\\gamma}{\\pi}} (1 + \\gamma x^{2}) \\exp(-\\gamma x^{2})\n$$\nSubstituting back $\\gamma = \\frac{m \\omega}{\\hbar}$, the final expression for the output density is:\n$$\n\\rho_{\\text{out}}(x) = \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right)\n$$\nThe total number of electrons for this density is $\\int_{-\\infty}^{\\infty} \\rho_{\\text{out}}(x) dx = f_{0} \\int |\\psi_{0}|^2 dx + f_{1} \\int |\\psi_{1}|^2 dx = f_{0}(1) + f_{1}(1) = 1 + \\frac{1}{2} = \\frac{3}{2}$, which is consistent with the definition $N = f_{0} + f_{1}$.\n\nNext, we address the rationale for density mixing. The Self-Consistent Field (SCF) procedure is an iterative process that seeks to find a fixed point of a mapping $\\mathcal{F}$, where $\\rho_{\\text{out}} = \\mathcal{F}(\\rho_{\\text{in}})$. A simple fixed-point iteration updates the density at step $k+1$ using the full output from step $k$: $\\rho_{k+1} = \\rho_{\\text{out},k}$. This procedure is often unstable and fails to converge. The output density can overcorrect for errors in the input density, leading to large, undamped oscillations (often termed \"charge sloshing\") between successive iterations. Density mixing is a numerical technique to dampen these oscillations and stabilize the convergence. In linear mixing, the density for the next iteration is formed as a linear combination of the input and output densities from the current iteration:\n$$\n\\rho_{\\text{next}}(x) = (1-\\alpha) \\rho_{\\text{in}}(x) + \\alpha \\rho_{\\text{out}}(x)\n$$\nThe mixing parameter $\\alpha \\in (0,1)$ controls the step size. A small value of $\\alpha$ ensures that the density is updated cautiously, which mitigates oscillations and improves the likelihood of reaching a self-consistent solution, albeit potentially at the cost of a slower convergence rate.\n\nFinally, we compute the mixed density $\\rho_{\\text{next}}(x)$ using the given input density $\\rho_{\\text{in}}(x)$, the calculated output density $\\rho_{\\text{out}}(x)$, and the mixing parameter $\\alpha$.\nThe total electron number is $N = f_0 + f_1 = 1 + \\frac{1}{2} = \\frac{3}{2}$. The input density is given as:\n$$\n\\rho_{\\text{in}}(x) = N \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}) = \\frac{3}{2} \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2})\n$$\nUsing the linear mixing formula, we combine $\\rho_{\\text{in}}(x)$ and $\\rho_{\\text{out}}(x)$:\n$$\n\\rho_{\\text{next}}(x) = (1-\\alpha) \\left( \\frac{3}{2} \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}) \\right) + \\alpha \\left( \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right) \\right)\n$$\nThis expression represents the electron density to be used as input for the subsequent SCF iteration. The two terms do not simplify further due to the different coefficients in the exponentials, namely $-b x^2$ and $-\\frac{m \\omega}{\\hbar} x^2$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right) & (1-\\alpha) \\frac{3}{2} \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}) + \\alpha \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While linear mixing is a crucial tool, its success and efficiency depend on a carefully chosen mixing parameter, $\\alpha$. This practice delves into the analytical foundations of SCF convergence by applying linear response theory to a Thomas-Fermi model. By linearizing the SCF map and analyzing its response to a small perturbation, you will determine the conditions for convergence and calculate the optimal mixing parameter, gaining a deeper understanding of the mathematical structure that governs the stability of these iterative procedures.",
            "id": "3486412",
            "problem": "Consider a one-dimensional Thomas–Fermi model at zero temperature for a spin-degenerate electron gas on a periodic domain with coordinate $x$, formulated in Hartree atomic units. The global chemical potential $\\mu$ is spatially constant, and the local Thomas–Fermi relation reads $\\mu = v_{\\mathrm{eff}}(x) + \\frac{\\pi^{2}}{2}\\,\\rho(x)^{2}$, where $\\rho(x)$ is the electron density and $v_{\\mathrm{eff}}(x)$ is the effective electrostatic potential. Assume a locally screened electrostatics described by the Helmholtz equation $\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)v_{\\mathrm{eff}}(x) = \\gamma\\,\\rho(x)$ with periodic boundary conditions, where $\\kappa > 0$ is the inverse screening length and $\\gamma > 0$ is a coupling constant. Take $\\kappa = 2.0$ and $\\gamma = 1.0$. Let the reference state be a uniform density $\\rho_{0} = 0.4$ that solves the homogeneous Thomas–Fermi condition with a constant potential offset $v_{\\mathrm{eff},0}$, namely $\\mu = v_{\\mathrm{eff},0} + \\frac{\\pi^{2}}{2}\\,\\rho_{0}^{2}$, where $v_{\\mathrm{eff},0} = \\gamma \\rho_{0}/\\kappa^{2}$. Consider a trial input density $\\rho_{\\mathrm{in}}(x) = \\rho_{0} + A\\cos(qx)$ with $A$ sufficiently small to justify linearization and with wave number $q = 1.0$. Define the Self-Consistent Field (SCF) fixed-point map $F$ by constructing $v_{\\mathrm{eff}}[\\rho_{\\mathrm{in}}]$ from the Helmholtz equation and then updating $\\rho_{\\mathrm{out}}(x)$ via the Thomas–Fermi relation at fixed $\\mu$.\n\nUsing only first-order (linear) response in the amplitude $A$:\n1) Compute the explicit form of $F(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x)$ up to terms linear in $A$, expressing the cosine amplitude of the output density in terms of $\\rho_{0}$, $q$, $\\kappa$, $\\gamma$, and $\\pi$.\n2) Evaluate the residual $R(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x) - \\rho_{\\mathrm{in}}(x)$ to the same order and identify its cosine amplitude.\n3) Consider a linear mixing update $\\rho^{(\\mathrm{new})}(x) = (1-\\alpha)\\rho^{(\\mathrm{old})}(x) + \\alpha\\,F(\\rho^{(\\mathrm{old})})(x)$ with mixing parameter $\\alpha \\in (0,2)$. Determine the largest admissible value $\\alpha_{\\max}$ such that the cosine mode with wave number $q$ converges linearly under iteration. Round your final numerical value of $\\alpha_{\\max}$ to four significant figures. The final answer should be given as a single dimensionless number.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and self-contained. The problem describes a self-consistent field (SCF) procedure for a one-dimensional Thomas-Fermi model. This is a standard, albeit simplified, framework in computational materials science. All provided equations, such as the Thomas-Fermi relation and the screened Helmholtz equation for the potential, are standard representations within this context. The parameters are well-defined, and the task—a linear response analysis of an SCF cycle—is a canonical exercise in this field. The problem is therefore deemed valid and a full solution is warranted.\n\nThe solution proceeds in three parts as requested by the problem statement.\n\nFirst, we determine the output density $\\rho_{\\mathrm{out}}(x)$ for a given input density $\\rho_{\\mathrm{in}}(x)$.\nThe input density is a small perturbation around a uniform reference state $\\rho_0$:\n$$\n\\rho_{\\mathrm{in}}(x) = \\rho_{0} + A\\cos(qx)\n$$\nWe denote the perturbation as $\\delta\\rho_{\\mathrm{in}}(x) = A\\cos(qx)$.\nThe SCF map $F$ consists of two steps. The first step is to compute the effective potential $v_{\\mathrm{eff}}(x)$ by solving the Helmholtz equation:\n$$\n\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)v_{\\mathrm{eff}}(x) = \\gamma\\,\\rho_{\\mathrm{in}}(x)\n$$\nWe express the potential as a sum of the reference potential $v_{\\mathrm{eff},0}$ and a perturbation $\\delta v_{\\mathrm{eff}}(x)$: $v_{\\mathrm{eff}}(x) = v_{\\mathrm{eff},0} + \\delta v_{\\mathrm{eff}}(x)$. The reference state satisfies $\\kappa^{2}v_{\\mathrm{eff},0} = \\gamma\\rho_0$. Substituting the perturbed forms into the Helmholtz equation gives:\n$$\n\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)(v_{\\mathrm{eff},0} + \\delta v_{\\mathrm{eff}}(x)) = \\gamma(\\rho_{0} + A\\cos(qx))\n$$\nThe zeroth-order terms $\\kappa^{2}v_{\\mathrm{eff},0} = \\gamma\\rho_0$ cancel, leaving an equation for the perturbations:\n$$\n\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)\\delta v_{\\mathrm{eff}}(x) = \\gamma A\\cos(qx)\n$$\nWe seek a solution of the form $\\delta v_{\\mathrm{eff}}(x) = v_1 \\cos(qx)$. Substituting this ansatz yields:\n$$\nq^{2}v_1\\cos(qx) + \\kappa^{2}v_1\\cos(qx) = \\gamma A\\cos(qx)\n$$\nSolving for the amplitude $v_1$ gives:\n$$\nv_1 = \\frac{\\gamma A}{q^{2} + \\kappa^{2}}\n$$\nSo, the effective potential is $v_{\\mathrm{eff}}(x) = v_{\\mathrm{eff},0} + \\frac{\\gamma A}{q^{2} + \\kappa^{2}}\\cos(qx)$.\n\nThe second step is to compute the output density $\\rho_{\\mathrm{out}}(x)$ using the Thomas-Fermi relation at a fixed chemical potential $\\mu$:\n$$\n\\rho_{\\mathrm{out}}(x) = \\sqrt{\\frac{2}{\\pi^{2}}(\\mu - v_{\\mathrm{eff}}(x))}\n$$\nUsing the reference state condition $\\mu - v_{\\mathrm{eff},0} = \\frac{\\pi^{2}}{2}\\rho_{0}^{2}$, we substitute for $\\mu$ and $v_{\\mathrm{eff}}(x)$:\n$$\n\\rho_{\\mathrm{out}}(x) = \\sqrt{\\frac{2}{\\pi^{2}}\\left(\\frac{\\pi^{2}}{2}\\rho_{0}^{2} - \\frac{\\gamma A}{q^{2} + \\kappa^{2}}\\cos(qx)\\right)} = \\sqrt{\\rho_{0}^{2} - \\frac{2\\gamma A}{\\pi^{2}(q^{2} + \\kappa^{2})}\\cos(qx)}\n$$\n$$\n\\rho_{\\mathrm{out}}(x) = \\rho_{0}\\sqrt{1 - \\frac{2\\gamma A}{\\pi^{2}\\rho_{0}^{2}(q^{2} + \\kappa^{2})}\\cos(qx)}\n$$\nSince $A$ is small, we linearize using the Taylor expansion $\\sqrt{1 - u} \\approx 1 - \\frac{u}{2}$:\n$$\n\\rho_{\\mathrm{out}}(x) \\approx \\rho_{0}\\left(1 - \\frac{1}{2} \\frac{2\\gamma A}{\\pi^{2}\\rho_{0}^{2}(q^{2} + \\kappa^{2})}\\cos(qx)\\right) = \\rho_{0} - \\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\cos(qx)\n$$\nThis is the explicit form of $F(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x)$ to first order in $A$. The cosine amplitude of the output density is $-\\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}$.\n\nSecond, we evaluate the residual $R(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x) - \\rho_{\\mathrm{in}}(x)$:\n$$\nR(\\rho_{\\mathrm{in}})(x) = \\left(\\rho_{0} - \\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\cos(qx)\\right) - (\\rho_{0} + A\\cos(qx))\n$$\n$$\nR(\\rho_{\\mathrm{in}})(x) = \\left(- \\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})} - A \\right)\\cos(qx) = -A\\left(1 + \\frac{\\gamma}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\right)\\cos(qx)\n$$\nThe cosine amplitude of the residual is $-A\\left(1 + \\frac{\\gamma}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\right)$.\n\nThird, we analyze the convergence of the linear mixing scheme to find $\\alpha_{\\max}$. The update rule is:\n$$\n\\rho^{(\\mathrm{new})}(x) = (1-\\alpha)\\rho^{(\\mathrm{old})}(x) + \\alpha\\,F(\\rho^{(\\mathrm{old})})(x)\n$$\nLet the perturbation in the density at iteration $n$ be $\\delta\\rho^{(n)}(x) = A^{(n)}\\cos(qx)$. The map $F$ acts linearly on this perturbation: $\\delta\\rho_{\\mathrm{out}}^{(n)}(x) = \\lambda \\delta\\rho^{(n)}(x)$, where the eigenvalue $\\lambda$ is the ratio of the output to input amplitudes:\n$$\n\\lambda = \\frac{A_{\\mathrm{out}}}{A} = -\\frac{\\gamma}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\n$$\nThe iteration for the perturbation amplitude is:\n$$\nA^{(\\mathrm{new})}\\cos(qx) = (1-\\alpha)A^{(\\mathrm{old})}\\cos(qx) + \\alpha (\\lambda A^{(\\mathrm{old})}\\cos(qx))\n$$\n$$\nA^{(\\mathrm{new})} = [(1-\\alpha) + \\alpha\\lambda] A^{(\\mathrm{old})} = [1 - \\alpha(1-\\lambda)] A^{(\\mathrm{old})}\n$$\nFor the iteration to converge, the magnitude of the amplification factor $g(\\alpha) = 1 - \\alpha(1-\\lambda)$ must be less than $1$:\n$$\n|g(\\alpha)| = |1 - \\alpha(1-\\lambda)| < 1\n$$\nThis is equivalent to the inequality $-1 < 1 - \\alpha(1-\\lambda) < 1$.\nFirst, let's evaluate $\\lambda$ using the given parameters: $\\rho_{0} = 0.4$, $\\kappa = 2.0$, $\\gamma = 1.0$, and $q = 1.0$.\n$$\n\\lambda = -\\frac{1.0}{\\pi^{2}(0.4)(1.0^{2} + 2.0^{2})} = -\\frac{1.0}{\\pi^{2}(0.4)(5.0)} = -\\frac{1}{2\\pi^{2}}\n$$\nSince $\\lambda$ is negative, the term $1-\\lambda = 1 + \\frac{1}{2\\pi^2}$ is positive and greater than $1$. Let $C = 1-\\lambda$. The convergence condition becomes:\n$$\n-1 < 1 - \\alpha C < 1 \\implies -2 < -\\alpha C < 0\n$$\nSince $C$ is positive, $-\\alpha C$ being less than $0$ implies $\\alpha > 0$. Dividing by $-C$ (a negative number) reverses the inequalities:\n$$\n\\frac{2}{C} > \\alpha > 0\n$$\nThe iteration converges for $\\alpha \\in \\left(0, \\frac{2}{C}\\right)$. The largest admissible value is $\\alpha_{\\max} = \\frac{2}{C}$:\n$$\n\\alpha_{\\max} = \\frac{2}{1-\\lambda} = \\frac{2}{1 - (-\\frac{1}{2\\pi^{2}})} = \\frac{2}{1 + \\frac{1}{2\\pi^{2}}}\n$$\nThis expression can be simplified:\n$$\n\\alpha_{\\max} = \\frac{2}{\\frac{2\\pi^{2} + 1}{2\\pi^{2}}} = \\frac{4\\pi^{2}}{2\\pi^{2} + 1}\n$$\nNow, we compute the numerical value:\n$$\n\\alpha_{\\max} = \\frac{4\\pi^{2}}{2\\pi^{2} + 1} \\approx \\frac{4(9.8696044)}{2(9.8696044) + 1} \\approx \\frac{39.4784176}{19.7392088 + 1} \\approx \\frac{39.4784176}{20.7392088} \\approx 1.903573\n$$\nRounding to four significant figures, we get $\\alpha_{\\max} \\approx 1.904$.",
            "answer": "$$\n\\boxed{1.904}\n$$"
        },
        {
            "introduction": "Simple linear mixing can be slow to converge, especially for challenging systems. This practice introduces a far more powerful and widely used acceleration technique: the Direct Inversion in the Iterative Subspace (DIIS) method. By framing the search for the ground state as a constrained minimization of an error vector, you will derive and solve the equations for the optimal extrapolation coefficients. This exercise provides hands-on experience with an advanced algorithm that uses the history of previous iterations to intelligently guide the SCF procedure toward the self-consistent solution.",
            "id": "3486427",
            "problem": "Consider a self-consistent field iteration of the Kohn–Sham equations in Density Functional Theory, where three previous trial density matrices $\\{D_1, D_2, D_3\\}$ and the corresponding residual vectors $\\{R_1, R_2, R_3\\}$ have been collected in the iterative subspace. The residual vector $R_i$ is defined (in an orthonormal molecular orbital basis) as the error in satisfying the generalized eigenvalue problem for the current trial density, and its inner product with another residual $R_j$ is defined using the Hilbert–Schmidt inner product $\\langle R_i, R_j \\rangle = \\mathrm{Tr}\\!\\left(R_i^{\\dagger} R_j\\right)$. The Direct Inversion in the Iterative Subspace (DIIS) method constructs an extrapolated density $D^{\\mathrm{DIIS}} = \\sum_{i=1}^{3} c_i D_i$ by choosing coefficients $\\{c_i\\}$ that minimize the quadratic form built from the residual inner products subject to the affine constraint $\\sum_{i=1}^{3} c_i = 1$.\n\nYou are given that the inner products have been evaluated to form the symmetric residual metric matrix $B$ with elements $B_{ij} = \\langle R_i, R_j \\rangle$:\n$$\nB \\;=\\;\n\\begin{pmatrix}\n0.0400 & 0.0150 & 0.0100 \\\\\n0.0150 & 0.0500 & 0.0200 \\\\\n0.0100 & 0.0200 & 0.0600\n\\end{pmatrix}.\n$$\nStarting from first principles—namely, the Kohn–Sham variational framework for the self-consistent field, the definition of the residuals and their inner product, and the constrained minimization of the residual norm in the iterative subspace—derive the Pulay Direct Inversion in the Iterative Subspace (DIIS) linear system for the coefficients $\\{c_i\\}$, solve for the exact coefficients $c_1$, $c_2$, and $c_3$, and write the resulting extrapolated density update $D^{\\mathrm{DIIS}}$ as a single analytic expression in terms of $\\{D_1, D_2, D_3\\}$ and the exact coefficients. Express the final extrapolated density update in exact form; no rounding is required.",
            "solution": "The problem requires the derivation and solution of the Direct Inversion in the Iterative Subspace (DIIS) equations to find an optimal set of coefficients $\\{c_1, c_2, c_3\\}$ for extrapolating a new trial density matrix in a self-consistent field (SCF) procedure.\n\nThe DIIS procedure constructs an extrapolated density matrix, $D^{\\mathrm{DIIS}}$, as a linear combination of a set of $n$ previous trial density matrices, $\\{D_i\\}_{i=1}^n$. In this problem, $n=3$, so we have:\n$$D^{\\mathrm{DIIS}} = \\sum_{i=1}^{3} c_i D_i$$\nThe coefficients $c_i$ are determined by minimizing the norm of the corresponding extrapolated residual vector, $R^{\\mathrm{DIIS}}$, which is formed by the same linear combination of the individual residual vectors, $\\{R_i\\}_{i=1}^3$:\n$$R^{\\mathrm{DIIS}} = \\sum_{i=1}^{3} c_i R_i$$\nThe minimization is performed subject to the constraint that the coefficients sum to unity, ensuring that if the $D_i$ are properly normalized (e.g., $\\mathrm{Tr}(D_i S) = N_{electrons}$), the extrapolated density $D^{\\mathrm{DIIS}}$ preserves this normalization. The constraint is:\n$$\\sum_{i=1}^{3} c_i = 1$$\nThe quantity to be minimized is the squared norm of the extrapolated residual vector, $S = \\|R^{\\mathrm{DIIS}}\\|^2$. Using the provided definition of the inner product, $\\langle R_i, R_j \\rangle = \\mathrm{Tr}(R_i^{\\dagger} R_j)$, we can express $S$ as a quadratic form in terms of the coefficients $c_i$:\n$$S = \\left\\langle \\sum_{i=1}^{3} c_i R_i, \\sum_{j=1}^{3} c_j R_j \\right\\rangle = \\sum_{i=1}^{3} \\sum_{j=1}^{3} c_i c_j \\langle R_i, R_j \\rangle$$\nLet $B$ be the symmetric matrix of residual inner products, with elements $B_{ij} = \\langle R_i, R_j \\rangle$. Let $\\mathbf{c}$ be the column vector of coefficients $(c_1, c_2, c_3)^T$. The objective function is $S(\\mathbf{c}) = \\mathbf{c}^T B \\mathbf{c}$.\n\nTo solve this constrained minimization problem, we use the method of Lagrange multipliers. We define a Lagrangian function $\\mathcal{L}$ that incorporates the constraint, where $\\lambda$ is the Lagrange multiplier:\n$$\\mathcal{L}(\\mathbf{c}, \\lambda) = \\mathbf{c}^T B \\mathbf{c} - \\lambda \\left(\\sum_{i=1}^{3} c_i - 1\\right)$$\nTo find the minimum, we set the partial derivatives of $\\mathcal{L}$ with respect to each coefficient $c_k$ and the multiplier $\\lambda$ to zero. For a more convenient form, we can define the Lagrangian as $\\mathcal{L}(\\mathbf{c}, \\lambda_L) = \\mathbf{c}^T B \\mathbf{c} + 2\\lambda_L (\\mathbf{1}^T\\mathbf{c} - 1)$, where $\\mathbf{1}$ is a column vector of ones.\nThe stationarity conditions are:\n$$\\frac{\\partial \\mathcal{L}}{\\partial c_k} = 0 \\quad \\text{for } k=1, 2, 3$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda_L} = 0$$\nThe derivative with respect to $c_k$ is:\n$$\\frac{\\partial}{\\partial c_k} \\left( \\sum_{i,j} c_i B_{ij} c_j + 2\\lambda_L \\left(\\sum_i c_i - 1\\right) \\right) = 2 \\sum_j B_{kj} c_j + 2\\lambda_L = 0$$\nThis gives a set of three equations: $\\sum_j B_{kj} c_j + \\lambda_L = 0$ for $k=1, 2, 3$. In matrix form, this is $B\\mathbf{c} + \\lambda_L \\mathbf{1} = \\mathbf{0}$.\nThe derivative with respect to $\\lambda_L$ recovers the constraint:\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda_L} = 2\\left( \\sum_i c_i - 1 \\right) = 0 \\implies \\sum_i c_i = 1$$\nCombining these results, we arrive at the Pulay DIIS linear system of $n+1$ equations (here $4$ equations):\n$$\n\\begin{pmatrix}\nB_{11} & B_{12} & B_{13} & 1 \\\\\nB_{21} & B_{22} & B_{23} & 1 \\\\\nB_{31} & B_{32} & B_{33} & 1 \\\\\n1 & 1 & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\nc_2 \\\\\nc_3 \\\\\n\\lambda_L\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n1\n\\end{pmatrix}\n$$\nThis is the derived linear system. To solve for the coefficients $\\mathbf{c}$, we can proceed analytically. From $B\\mathbf{c} = -\\lambda_L \\mathbf{1}$, and assuming $B$ is invertible, we have $\\mathbf{c} = -\\lambda_L B^{-1} \\mathbf{1}$.\nSubstituting this into the constraint $\\mathbf{1}^T \\mathbf{c} = 1$:\n$$1 = \\mathbf{1}^T (-\\lambda_L B^{-1} \\mathbf{1}) = -\\lambda_L (\\mathbf{1}^T B^{-1} \\mathbf{1})$$\nThis allows us to solve for the Lagrange multiplier:\n$$-\\lambda_L = \\frac{1}{\\mathbf{1}^T B^{-1} \\mathbf{1}} = \\frac{1}{\\sum_{i,j} (B^{-1})_{ij}}$$\nSubstituting this back into the expression for $\\mathbf{c}$:\n$$\\mathbf{c} = \\frac{B^{-1} \\mathbf{1}}{\\sum_{i,j} (B^{-1})_{ij}}$$\nComponent-wise, the solution for each coefficient $c_k$ is the sum of the elements in the $k$-th row of $B^{-1}$, normalized by the sum of all elements of $B^{-1}$:\n$$c_k = \\frac{\\sum_j (B^{-1})_{kj}}{\\sum_{i,j} (B^{-1})_{ij}}$$\nNow, we apply this formula using the given matrix $B$:\n$$B = \\begin{pmatrix} 0.0400 & 0.0150 & 0.0100 \\\\ 0.0150 & 0.0500 & 0.0200 \\\\ 0.0100 & 0.0200 & 0.0600 \\end{pmatrix}$$\nTo obtain an exact solution, we convert the decimal values to fractions. The least common denominator for the given values is $200$.\n$$B = \\frac{1}{200} \\begin{pmatrix} 8 & 3 & 2 \\\\ 3 & 10 & 4 \\\\ 2 & 4 & 12 \\end{pmatrix}$$\nLet $B_{int} = \\begin{pmatrix} 8 & 3 & 2 \\\\ 3 & 10 & 4 \\\\ 2 & 4 & 12 \\end{pmatrix}$. Then $B^{-1} = 200 \\times B_{int}^{-1}$.\nWe first compute the determinant of $B_{int}$:\n$$\\det(B_{int}) = 8(10 \\cdot 12 - 4 \\cdot 4) - 3(3 \\cdot 12 - 4 \\cdot 2) + 2(3 \\cdot 4 - 10 \\cdot 2)$$\n$$\\det(B_{int}) = 8(120-16) - 3(36-8) + 2(12-20) = 8(104) - 3(28) + 2(-8) = 832 - 84 - 16 = 732$$\nNext, we find the adjugate of $B_{int}$, which is the transpose of its cofactor matrix:\n$$ \\mathrm{adj}(B_{int}) = \\begin{pmatrix} 104 & -28 & -8 \\\\ -28 & 92 & -26 \\\\ -8 & -26 & 71 \\end{pmatrix} $$\nSo, $B_{int}^{-1} = \\frac{1}{732} \\mathrm{adj}(B_{int})$. And $B^{-1} = \\frac{200}{732} \\mathrm{adj}(B_{int}) = \\frac{50}{183} \\mathrm{adj}(B_{int})$.\nTo find the coefficients $c_k$, we need the row sums of $B^{-1}$. Let's find the row sums of $\\mathrm{adj}(B_{int})$:\nRow $1$ sum: $104 - 28 - 8 = 68$\nRow $2$ sum: $-28 + 92 - 26 = 38$\nRow $3$ sum: $-8 - 26 + 71 = 37$\nThe numerator for $c_k$ is proportional to these sums. The denominator is proportional to the sum of all elements, which is the sum of these row sums: $68 + 38 + 37 = 143$.\nThe normalization constant $\\frac{50}{183}$ cancels out, so we have:\n$$c_1 = \\frac{68}{143}$$\n$$c_2 = \\frac{38}{143}$$\n$$c_3 = \\frac{37}{143}$$\nAs a check, $\\sum_i c_i = \\frac{68+38+37}{143} = \\frac{143}{143} = 1$. The constraint is satisfied.\nThe final extrapolated density update is obtained by substituting these exact coefficients into the expression for $D^{\\mathrm{DIIS}}$:\n$$D^{\\mathrm{DIIS}} = \\frac{68}{143} D_1 + \\frac{38}{143} D_2 + \\frac{37}{143} D_3$$\nThis is the final analytic expression for the DIIS density update.",
            "answer": "$$\n\\boxed{\\frac{68}{143} D_1 + \\frac{38}{143} D_2 + \\frac{37}{143} D_3}\n$$"
        }
    ]
}