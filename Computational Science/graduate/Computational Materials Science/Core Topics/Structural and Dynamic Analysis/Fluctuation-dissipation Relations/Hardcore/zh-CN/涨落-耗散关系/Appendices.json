{
    "hands_on_practices": [
        {
            "introduction": "朗之万谐振子是统计物理学中的一个经典模型，它描述了一个与热浴相互作用的简化的自由度。这个练习将引导你通过基本的数学步骤，从第一性原理推导出涨落-耗散定理。通过这个过程，你将亲手建立起热涨落谱（由随机力引起）与系统响应的耗散部分（由摩擦力引起）之间的深刻联系。",
            "id": "3452690",
            "problem": "考虑一个一维朗之万谐振子，它模拟了一个与热浴耦合的粗粒化物料自由度的单一振动模式，其运动由以下随机微分方程决定\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t),\n$$\n其中 $m$ 是质量，$\\gamma$ 是黏性阻尼系数，$k$ 是弹簧常数，$\\xi(t)$ 是代表热涨落的平稳随机力。假设系统处于温度 $T$ 的热平衡状态，并且 $\\xi(t)$ 是均值为零、自相关函数如下的高斯白噪声：\n$$\n\\langle \\xi(t)\\,\\xi(t')\\rangle=2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'),\n$$\n其中，$k_{B}$ 是玻尔兹曼常数，$\\langle\\cdot\\rangle$ 表示系综平均。定义傅里叶变换为 $x(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,x(t)$，并采用双边功率谱密度 (PSD) 约定 $\\langle a(\\omega)\\,b(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{ab}(\\omega)$，因此 $S_{xx}(\\omega)$ 和 $S_{vv}(\\omega)$ 分别是 $x(t)$ 和 $v(t)=\\dot{x}(t)$ 的功率谱密度。引入一个与 $x(t)$ 共轭的弱外部探针力 $f(t)$，通过线性响应 $x(\\omega)=\\chi_{xx}(\\omega)\\,f(\\omega)$ 来定义因果线性响应函数 $\\chi_{xx}(\\omega)$。\n\n从这些定义和朗之万动力学出发，完成以下任务：\n- 推导平稳功率谱密度 $S_{xx}(\\omega)$ 和 $S_{vv}(\\omega)$ 关于 $m$、$\\gamma$、$k$、$\\omega$、$k_{B}$ 和 $T$ 的表达式。\n- 推导线性响应函数 $\\chi_{xx}(\\omega)$ 的吸收（虚）部 $\\chi''_{xx}(\\omega)$，并讨论在欠阻尼情况下，共振峰的频率和宽度是如何由系统参数决定的。\n- 显式地展示您的结果如何验证了经典的涨落-耗散定理。",
            "solution": "问题陈述已经过验证，被认为是统计物理学中一个有效、有科学依据且定义明确的问题。\n\n出发点是一维谐振子的朗之万方程：\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t)\n$$\n其中 $\\xi(t)$ 是白噪声项，满足 $\\langle \\xi(t) \\rangle = 0$ 且自相关函数为 $\\langle \\xi(t)\\,\\xi(t')\\rangle=2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t')$。\n\n我们首先推导功率谱密度 (PSD) $S_{xx}(\\omega)$ 和 $S_{vv}(\\omega)$。我们将傅里叶变换（定义为 $g(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,g(t)$）应用于朗之万方程。利用时间导数 $\\frac{d^n g(t)}{dt^n}$ 的傅里叶变换是 $(-i\\omega)^n g(\\omega)$ 这一性质，我们得到：\n$$\n(m(-i\\omega)^2 + \\gamma(-i\\omega) + k)x(\\omega) = \\xi(\\omega)\n$$\n$$\n(-m\\omega^2 - i\\omega\\gamma + k)x(\\omega) = \\xi(\\omega)\n$$\n求解 $x(\\omega)$，我们得到频域中位置与随机力之间的关系：\n$$\nx(\\omega) = \\frac{\\xi(\\omega)}{k - m\\omega^2 - i\\omega\\gamma}\n$$\n接下来，我们确定随机力 $S_{\\xi\\xi}(\\omega)$ 的功率谱密度。问题通过关系式 $\\langle a(\\omega)\\,b(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{ab}(\\omega)$ 来定义功率谱密度。我们计算经过傅里叶变换的噪声的相关性：\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = \\int_{-\\infty}^{\\infty}\\mathrm{d}t \\int_{-\\infty}^{\\infty}\\mathrm{d}t'\\, \\exp(i\\omega t)\\,\\exp(i\\omega' t')\\,\\langle \\xi(t)\\,\\xi(t')\\rangle\n$$\n代入给定的 $\\xi(t)$ 的自相关函数：\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = \\int_{-\\infty}^{\\infty}\\mathrm{d}t \\int_{-\\infty}^{\\infty}\\mathrm{d}t'\\, \\exp(i\\omega t)\\,\\exp(i\\omega' t')\\,(2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'))\n$$\n$$\n= 2\\,\\gamma\\,k_{B}\\,T \\int_{-\\infty}^{\\infty}\\mathrm{d}t\\, \\exp(i(\\omega+\\omega')t)\n$$\n利用狄拉克δ函数的积分表示 $\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\, \\exp(iKt) = 2\\pi\\delta(K)$，我们得到：\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = 2\\,\\gamma\\,k_{B}\\,T\\,(2\\pi\\delta(\\omega+\\omega'))\n$$\n将其与定义 $\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{\\xi\\xi}(\\omega)$ 进行比较，我们确定噪声的功率谱密度为一个常数（这是白噪声的特征）：\n$$\nS_{\\xi\\xi}(\\omega) = 2\\,\\gamma\\,k_{B}\\,T\n$$\n现在我们可以计算位置的功率谱密度 $S_{xx}(\\omega)$。我们计算相关性 $\\langle x(\\omega)x(\\omega') \\rangle$：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\left\\langle \\frac{\\xi(\\omega)}{k - m\\omega^2 - i\\omega\\gamma} \\frac{\\xi(\\omega')}{k - m(\\omega')^2 - i\\omega'\\gamma} \\right\\rangle = \\frac{\\langle \\xi(\\omega)\\xi(\\omega') \\rangle}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(\\omega')^2 - i\\omega'\\gamma)}\n$$\n代入 $\\langle \\xi(\\omega)\\xi(\\omega') \\rangle$ 的表达式：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(\\omega')^2 - i\\omega'\\gamma)}\n$$\nδ函数 $\\delta(\\omega+\\omega')$ 强制要求 $\\omega' = -\\omega$。应用此约束：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(-\\omega)^2 - i(-\\omega)\\gamma)} = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m\\omega^2 + i\\omega\\gamma)}\n$$\n$$\n= \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n代入 $S_{\\xi\\xi}(\\omega) = 2\\,\\gamma\\,k_{B}\\,T$：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = 2\\pi\\delta(\\omega+\\omega') \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n从定义 $\\langle x(\\omega)\\,x(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{xx}(\\omega)$，我们得到位置的功率谱密度：\n$$\nS_{xx}(\\omega) = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n为了求出速度的功率谱密度 $S_{vv}(\\omega)$，我们使用关系式 $v(t)=\\dot{x}(t)$，它在傅里叶空间中为 $v(\\omega) = -i\\omega x(\\omega)$。那么，\n$$\n\\langle v(\\omega)v(\\omega') \\rangle = \\langle (-i\\omega x(\\omega))(-i\\omega' x(\\omega')) \\rangle = (-i)^2\\omega\\omega'\\langle x(\\omega)x(\\omega') \\rangle = -\\omega\\omega' \\langle x(\\omega)x(\\omega') \\rangle\n$$\n由于 $\\langle x(\\omega)x(\\omega') \\rangle$ 包含 $\\delta(\\omega+\\omega')$，我们可以用 $-\\omega$ 替换 $\\omega'$：\n$$\n\\langle v(\\omega)v(\\omega') \\rangle = -\\omega(-\\omega) [2\\pi\\delta(\\omega+\\omega')S_{xx}(\\omega)] = \\omega^2 [2\\pi\\delta(\\omega+\\omega')S_{xx}(\\omega)]\n$$\n与定义 $\\langle v(\\omega)\\,v(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{vv}(\\omega)$ 进行比较，我们发现：\n$$\nS_{vv}(\\omega) = \\omega^2 S_{xx}(\\omega) = \\frac{2\\,\\gamma\\,\\omega^2\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n这就完成了第一个任务。对于第二个任务，我们推导响应函数 $\\chi_{xx}(\\omega)$。我们在运动方程中加入一个弱外部力 $f(t)$：\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t) + f(t)\n$$\n线性响应由系综平均 $\\langle x(t) \\rangle$ 描述，对于系综平均，噪声项的平均值为零，即 $\\langle \\xi(t) \\rangle = 0$。平均响应的方程是：\n$$\nm\\,\\frac{d^2\\langle x(t) \\rangle}{dt^2}+\\gamma\\,\\frac{d\\langle x(t) \\rangle}{dt}+k\\,\\langle x(t) \\rangle = f(t)\n$$\n对该方程进行傅里叶变换，得到：\n$$\n(-m\\omega^2 - i\\omega\\gamma + k)\\langle x(\\omega) \\rangle = f(\\omega)\n$$\n响应函数 $\\chi_{xx}(\\omega)$ 由线性关系 $\\langle x(\\omega) \\rangle = \\chi_{xx}(\\omega) f(\\omega)$ 定义。因此，我们可以确定：\n$$\n\\chi_{xx}(\\omega) = \\frac{1}{k - m\\omega^2 - i\\omega\\gamma}\n$$\n为了求出吸收（虚）部，我们将分子和分母同乘以分母的复共轭：\n$$\n\\chi_{xx}(\\omega) = \\frac{k - m\\omega^2 + i\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} = \\frac{k - m\\omega^2}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} + i \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n吸收部分是虚部，我们记为 $\\chi''_{xx}(\\omega)$。在我们的傅里叶变换约定下，耗散与正的虚部相关联。我们的结果是：\n$$\n\\chi''_{xx}(\\omega) = \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n这是我的符号约定，对于 $\\omega>0$ 和 $\\gamma>0$，该值为正。\n在欠阻尼区 ($\\gamma \\ll 2\\sqrt{mk}$)，$\\chi''_{xx}(\\omega)$ 表现出一个尖锐的共振峰。振子的自然频率是 $\\omega_0 = \\sqrt{k/m}$。分母 $m^2(\\omega_0^2-\\omega^2)^2 + \\gamma^2\\omega^2$ 在 $\\omega = \\omega_0$ 附近急剧地达到最小值。由于 $\\omega$ 因子的存在，$\\chi''_{xx}(\\omega)$ 的峰值不完全在 $\\omega_0$ 处，但对于弱阻尼，它非常接近 $\\omega_0$。峰值频率 $\\omega_{res}$ 近似为 $\\omega_0 = \\sqrt{k/m}$。这个共振峰的宽度可以通过在 $\\omega_0$ 附近将线型近似为洛伦兹线型来分析。共振的半峰全宽 (FWHM) 被发现是 $\\Gamma = \\gamma/m$。因此，峰值频率取决于刚度 $k$ 和质量 $m$，而其宽度由阻尼 $\\gamma$ 和质量 $m$ 决定。\n\n最后，我们通过联系推导出的 $S_{xx}(\\omega)$ 和 $\\chi''_{xx}(\\omega)$ 来解释涨落耗散定理 (FDT)：\n$$\nS_{xx}(\\omega) = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n$$\n\\chi''_{xx}(\\omega) = \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n通过直接比较，我们可以看到一个简单的比例关系：\n$$\n\\frac{S_{xx}(\\omega)}{\\chi''_{xx}(\\omega)} = \\frac{2\\,\\gamma\\,k_{B}\\,T}{\\omega\\gamma} = \\frac{2\\,k_{B}\\,T}{\\omega}\n$$\n对于所选的变量和约定，这就给出了经典的涨落耗散定理：\n$$\nS_{xx}(\\omega) = \\frac{2\\,k_{B}\\,T}{\\omega} \\chi''_{xx}(\\omega)\n$$\n该定理是统计物理学中的一个基本结果。它在两个看似不同的现象之间建立了一个定量的联系：系统在热平衡状态下的自发涨落（由功率谱密度 $S_{xx}(\\omega)$ 量化）和系统对小的外部微扰的耗散响应（由响应函数的吸收部分 $\\chi''_{xx}(\\omega)$ 量化）。这种联系的物理基础是，能量的耗散和热涨落都是自由度 $x$ 与热浴之间相互作用的相同潜在微观过程的表现。比例常数涉及温度 $T$，表明平衡涨落的幅度由热能标度 $k_B T$ 决定。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} S_{xx}(\\omega) \\\\ S_{vv}(\\omega) \\end{pmatrix} = \\begin{pmatrix} \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} \\\\ \\frac{2\\,\\gamma\\,\\omega^2\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将连续的物理理论应用于计算机模拟时，必须谨慎处理。直接对朗之万这样的随机微分方程进行数值积分，可能会破坏系统原有的物理性质，例如温度。本练习将探讨如何正确地离散化朗之万方程，通过推导修正后的噪声项，确保离散时间下的涨落-耗散关系得以维持，从而使模拟能够保持在正确的热力学平衡状态。",
            "id": "3452632",
            "problem": "考虑一个质量为 $m$ 的一维粒子，与温度为 $T$ 的热浴接触，该系统由欠阻尼郎之万方程描述\n$$\nm \\,\\dot{v}(t) \\;=\\; -\\,\\gamma\\, v(t) \\;+\\; \\eta(t),\n$$\n其中 $\\gamma$ 是粘性摩擦系数，$\\eta(t)$ 是一个零均值高斯白噪声力。涨落-耗散定理（FDT）要求噪声自相关为\n$$\n\\langle \\eta(t)\\,\\eta(t') \\rangle \\;=\\; 2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数。假设在无力场情况下（平坦势），目标稳态速度分布为麦克斯韦-玻尔兹曼分布，\n$$\np(v) \\;\\propto\\; \\exp\\!\\left(-\\frac{m\\,v^{2}}{2\\,k_{B}\\,T}\\right).\n$$\n\n您使用显式欧拉更新方法，在有限时间步长 $\\Delta t$ 上对该方程进行离散化处理，\n$$\n\\frac{m}{\\Delta t}\\,\\big(v_{n+1}-v_{n}\\big) \\;=\\; -\\,\\gamma\\,v_{n} \\;+\\; \\zeta_{n},\n$$\n其中 $\\zeta_{n}$ 是一个离散的、零均值的高斯随机力，旨在表示区间 $[t_{n},t_{n}+\\Delta t]$ 上的时间平均热噪声。在这种离散表示中，白噪声自相关被克罗内克δ函数替代，可以写作\n$$\n\\langle \\zeta_{n}\\,\\zeta_{n'} \\rangle \\;=\\; A\\,\\delta_{n,n'},\n$$\n其中振幅 $A$ 待定。等价地，速度更新可以写成以下形式\n$$\nv_{n+1} \\;=\\; \\left(1-\\frac{\\gamma\\,\\Delta t}{m}\\right) v_{n} \\;+\\; \\sigma_{\\Delta t}\\,\\xi_{n},\n$$\n其中 $\\xi_{n}$ 是独立的标准正态随机变量，$\\sigma_{\\Delta t}$ 是速度噪声振幅，通过 $\\sigma_{\\Delta t} = (\\Delta t/m)\\sqrt{A}$ 与 $A$ 相关联。\n\n从基本原理出发，即连续时间FDT和要求 $v$ 满足的麦克斯韦-玻尔兹曼稳态分布，推导将 $A$ 与热力学参数及时间步长 $\\Delta t$ 联系起来的离散时间FDT。然后，确定修正后的速度噪声振幅 $\\sigma_{\\Delta t}$，以保证离散时间马尔可夫链对于任何有限的 $\\Delta t$ 都具有正确的稳态方差 $\\langle v^{2} \\rangle = k_{B}T/m$。\n\n请用一个包含 $m$、$\\gamma$、$k_{B}$、$T$ 和 $\\Delta t$ 的单一闭式解析表达式来表示您的最终答案 $\\sigma_{\\Delta t}$。",
            "solution": "问题陈述被认为是有效的，因为它具有科学依据、问题明确且客观。它提出了一个计算统计力学中的标准问题，涉及随机微分方程的离散化。所有提供的信息都是自洽且一致的。\n\n目标是确定离散噪声的振幅 $\\sigma_{\\Delta t}$，使得离散化的郎之万方程的稳态速度分布具有由能量均分定理决定的正确方差，该定理可从指定的麦克斯韦-玻尔兹曼分布中导出。\n\n离散化的郎之万方程以速度更新规则的形式给出：\n$$\nv_{n+1} \\;=\\; \\left(1-\\frac{\\gamma\\,\\Delta t}{m}\\right) v_{n} \\;+\\; \\sigma_{\\Delta t}\\,\\xi_{n}\n$$\n其中 $v_n$ 是在离散时间步 $n$ 时的速度，$m$ 是质量，$\\gamma$ 是摩擦系数，$\\Delta t$ 是时间步长，$\\xi_n$ 是从标准正态分布中抽取的独立同分布随机变量。$\\xi_n$ 的性质是：\n$$\n\\langle \\xi_n \\rangle = 0\n$$\n$$\n\\langle \\xi_n^2 \\rangle = 1\n$$\n$$\n\\langle \\xi_n \\xi_{n'} \\rangle = \\delta_{n,n'}\n$$\n其中 $\\delta_{n,n'}$ 是克罗内克δ函数。\n\n为简化表示，我们定义常数系数 $C$ 为：\n$$\nC = 1-\\frac{\\gamma\\,\\Delta t}{m}\n$$\n更新规则变为：\n$$\nv_{n+1} = C v_n + \\sigma_{\\Delta t} \\xi_n\n$$\n我们关心的是速度的稳态方差 $\\langle v^2 \\rangle$。在稳态下，分布的统计矩不随时间变化，这意味着 $\\langle v_{n+1}^2 \\rangle = \\langle v_n^2 \\rangle$。我们将此稳态方差记为 $\\langle v^2 \\rangle_{\\text{st}}$。\n\n我们计算 $v_{n+1}$ 平方的期望值：\n$$\n\\langle v_{n+1}^2 \\rangle = \\langle (C v_n + \\sigma_{\\Delta t} \\xi_n)^2 \\rangle\n$$\n展开平方项得到：\n$$\n\\langle v_{n+1}^2 \\rangle = \\langle C^2 v_n^2 + 2 C \\sigma_{\\Delta t} v_n \\xi_n + \\sigma_{\\Delta t}^2 \\xi_n^2 \\rangle\n$$\n利用期望算符的线性性：\n$$\n\\langle v_{n+1}^2 \\rangle = C^2 \\langle v_n^2 \\rangle + 2 C \\sigma_{\\Delta t} \\langle v_n \\xi_n \\rangle + \\sigma_{\\Delta t}^2 \\langle \\xi_n^2 \\rangle\n$$\n现在我们计算各个期望项。速度 $v_n$ 是直到步骤 $n-1$ 的噪声项的结果。由于噪声项 $\\xi_n$ 与所有之前的噪声项 $\\xi_k$（其中 $k  n$）无关，所以 $v_n$ 和 $\\xi_n$ 是不相关的。因此，它们乘积的期望等于它们各自期望的乘积：\n$$\n\\langle v_n \\xi_n \\rangle = \\langle v_n \\rangle \\langle \\xi_n \\rangle\n$$\n平均速度根据 $\\langle v_{n+1} \\rangle = C \\langle v_n \\rangle$ 演化。假设系统从零平均速度开始，或弛豫到零平均速度，稳态平均速度为 $\\langle v \\rangle=0$。因此，对于所有 $n$，$\\langle v_n \\rangle = 0$，这导致：\n$$\n\\langle v_n \\xi_n \\rangle = 0\n$$\n将此结果和 $\\langle \\xi_n^2 \\rangle = 1$ 代入 $\\langle v_{n+1}^2 \\rangle$ 的方程中，我们得到方差的递推关系：\n$$\n\\langle v_{n+1}^2 \\rangle = C^2 \\langle v_n^2 \\rangle + \\sigma_{\\Delta t}^2\n$$\n在稳态下，我们有 $\\langle v_{n+1}^2 \\rangle = \\langle v_n^2 \\rangle = \\langle v^2 \\rangle_{\\text{st}}$。递推关系变成一个代数方程：\n$$\n\\langle v^2 \\rangle_{\\text{st}} = C^2 \\langle v^2 \\rangle_{\\text{st}} + \\sigma_{\\Delta t}^2\n$$\n求解 $\\langle v^2 \\rangle_{\\text{st}}$ 可得：\n$$\n\\langle v^2 \\rangle_{\\text{st}} (1 - C^2) = \\sigma_{\\Delta t}^2\n$$\n$$\n\\langle v^2 \\rangle_{\\text{st}} = \\frac{\\sigma_{\\Delta t}^2}{1 - C^2}\n$$\n这就是对于给定的噪声振幅 $\\sigma_{\\Delta t}$，离散过程将产生的方差。\n\n问题要求这个稳态方差与在温度 $T$ 下从麦克斯韦-玻尔兹曼分布推导出的物理方差相匹配。根据单个二次自由度（一维动能）的能量均分定理，平均能量为 $\\frac{1}{2} k_B T$：\n$$\n\\left\\langle \\frac{1}{2} m v^2 \\right\\rangle = \\frac{1}{2} k_B T\n$$\n这意味着所要求的稳态方差是：\n$$\n\\langle v^2 \\rangle = \\frac{k_B T}{m}\n$$\n为确保离散模拟保持正确的温度，我们必须将算法产生的方差与物理方差相等：\n$$\n\\frac{\\sigma_{\\Delta t}^2}{1 - C^2} = \\frac{k_B T}{m}\n$$\n现在，我们求解 $\\sigma_{\\Delta t}$：\n$$\n\\sigma_{\\Delta t}^2 = \\frac{k_B T}{m} (1 - C^2)\n$$\n代回 $C = 1 - \\frac{\\gamma \\Delta t}{m}$ 的表达式：\n$$\n\\sigma_{\\Delta t}^2 = \\frac{k_B T}{m} \\left(1 - \\left(1 - \\frac{\\gamma \\Delta t}{m}\\right)^2\\right)\n$$\n展开括号内的项：\n$$\n1 - \\left(1 - \\frac{2\\gamma \\Delta t}{m} + \\left(\\frac{\\gamma \\Delta t}{m}\\right)^2\\right) = \\frac{2\\gamma \\Delta t}{m} - \\left(\\frac{\\gamma \\Delta t}{m}\\right)^2\n$$\n所以，$\\sigma_{\\Delta t}^2$ 的表达式是：\n$$\n\\sigma_{\\Delta t}^2 = \\frac{k_B T}{m} \\left(\\frac{2\\gamma \\Delta t}{m} - \\left(\\frac{\\gamma \\Delta t}{m}\\right)^2\\right)\n$$\n取平方根得到速度噪声振幅 $\\sigma_{\\Delta t}$ 的最终表达式：\n$$\n\\sigma_{\\Delta t} = \\sqrt{\\frac{k_B T}{m} \\left(1 - \\left(1 - \\frac{\\gamma \\Delta t}{m}\\right)^2\\right)}\n$$\n这就是针对此特定数值积分器的离散时间涨落-耗散定理，它确保了对于积分器稳定的任何有限时间步长 $\\Delta t$（即 $|C|  1$，要求 $\\Delta t  2m/\\gamma$），都能维持正确的平衡温度。这个结果与连续时间噪声的朴素离散化不同，后者会导致不正确的平衡温度。",
            "answer": "$$\\boxed{\\sqrt{\\frac{k_{B} T}{m} \\left(1 - \\left(1 - \\frac{\\gamma \\Delta t}{m}\\right)^{2}\\right)}}$$"
        },
        {
            "introduction": "涨落-耗散定理为我们从模拟数据中挖掘材料性质提供了强有力的工具。本练习将展示一个在计算材料科学中的典型应用：利用平衡态下的速度自相关函数——一种衡量热涨落的指标——来重构材料的振动声子态密度 (VDOS)。这个态密度捕捉了材料的本征振动谱，进而可以用来预测关键的热力学性质，如比热。",
            "id": "3452648",
            "problem": "在计算材料科学的背景下，您需要完成一项任务：利用涨落-耗散关系，从平衡速度自相关函数重构振动态密度，然后预测定容比热的温度依赖性。您应依赖的基本原理是：平衡速度自相关函数的定义、简谐振动的简正模分解以及谐振子的量子统计力学。在平衡状态下，速度自相关函数定义为 $Z(t) = \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle / \\langle \\mathbf{v}(0)^2 \\rangle$，它是时间的偶函数。在一个简谐系统中，动力学可以用简正模的叠加来描述。涨落-耗散原理将平衡关联函数与响应谱联系起来，确保了从 $Z(t)$ 中提取的谱内容代表了与热力学预测相关的振动密度。您不能使用快捷公式；相反，您的重构和热力学计算必须基于这些定义和原理。\n\n对于每个给定的测试用例，您的程序必须执行以下步骤：\n\n1. 使用带有指定权重和角频率的阻尼余弦贡献的有限和，在均匀时间网格上构建一个合成的、稳态的平衡速度自相关函数 $Z(t)$。每个测试用例都指定了权重 $\\{w_i\\}$（满足 $\\sum_i w_i = 1$）、角频率 $\\{\\omega_i\\}$（单位为弧度/皮秒）和一个阻尼率 $\\gamma$（单位为反皮秒）。在 $t \\in [0, t_{\\max}]$ 上使用 $Z(t) = \\mathrm{e}^{-\\gamma t} \\sum_i w_i \\cos(\\omega_i t)$，其中 $t_{\\max}$ 和时间步长 $\\Delta t$ 在下文指定。请确保 $Z(0) = 1$。\n\n2. 通过对 $Z(t)$ 应用与涨落-耗散框架一致的加窗余弦变换，在均匀角频率网格上数值重构单边振动态密度 $g(\\omega)$。使用一个能够抑制频谱泄漏并产生非负估计的变迹窗。将 $g(\\omega)$ 归一化，使得 $\\int_0^{\\omega_{\\max}} g(\\omega)\\,\\mathrm{d}\\omega = 1$。\n\n3. 使用重构并归一化的 $g(\\omega)$，对于每个测试用例，在两个温度 $T_{\\mathrm{low}}$ 和 $T_{\\mathrm{high}}$（均以开尔文为单位）下，计算每个振动模式的定容比热 $C_V(T)$，单位为玻尔兹曼常数 $k_{\\mathrm{B}}$。将每个振动模式视为一个独立的量子谐振子，并使用物理上正确的约化普朗克常数 $\\hbar$ 和玻尔兹曼常数 $k_{\\mathrm{B}}$ 的值。在构建无量纲参数 $\\hbar \\omega / (k_{\\mathrm{B}} T)$ 时，要考虑从弧度/皮秒到弧度/秒的单位转换。同时，基于能量均分定理计算高温下每个模式的经典定容比热。\n\n4. 对于每个测试用例，输出四个量：以 $k_{\\mathrm{B}}$ 为单位的低温量子比热 $C_V(T_{\\mathrm{low}})$，以 $k_{\\mathrm{B}}$ 为单位的高温量子比热 $C_V(T_{\\mathrm{high}})$，一个布尔值，指示高温量子比热是否在经典极限的 $0.05$ 范围内，以及一个布尔值，指示低温量子比热是否小于 $0.05$。\n\n重要的数值和单位说明：\n\n- 使用时间网格 $t \\in [0, t_{\\max}]$，其中 $t_{\\max} = 5.0$ 皮秒，$\\Delta t = 0.001$ 皮秒。\n- 使用角频率网格 $\\omega \\in [0, \\omega_{\\max}]$，其中 $\\omega_{\\max} = 100.0$ 弧度/皮秒，并采用均匀间距，提供至少 $2{,}000$ 个点。\n- 温度 $T_{\\mathrm{low}}$ 和 $T_{\\mathrm{high}}$ 以开尔文为单位给出，所有报告的比热必须以 $k_{\\mathrm{B}}$ 为单位（无量纲），而不是焦耳/开尔文。\n- 角频率必须以弧度处理；在转换为无量纲参数 $\\hbar \\omega / (k_{\\mathrm{B}} T)$ 时，确保单位的一致性。\n\n测试套件：\n\n- 案例1（单一爱因斯坦模式，无阻尼）：权重 $\\{1.0\\}$，频率 $\\{30.0\\}$ 弧度/皮秒，阻尼 $\\gamma = 0.0$ 反皮秒，$T_{\\mathrm{low}} = 10$ 开尔文，$T_{\\mathrm{high}} = 3000$ 开尔文。\n- 案例2（两个爱因斯坦模式，无阻尼）：权重 $\\{0.6, 0.4\\}$，频率 $\\{20.0, 50.0\\}$ 弧度/皮秒，阻尼 $\\gamma = 0.0$ 反皮秒，$T_{\\mathrm{low}} = 5$ 开尔文，$T_{\\mathrm{high}} = 5000$ 开尔文。\n- 案例3（两个爱因斯坦模式，有阻尼）：权重 $\\{0.5, 0.5\\}$，频率 $\\{15.0, 40.0\\}$ 弧度/皮秒，阻尼 $\\gamma = 5.0$ 反皮秒，$T_{\\mathrm{low}} = 5$ 开尔文，$T_{\\mathrm{high}} = 5000$ 开尔文。\n\n您的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个案例的：$C_V(T_{\\mathrm{low}})$、$C_V(T_{\\mathrm{high}})$、用于高温经典极限检查的布尔值，以及用于低温抑制检查的布尔值。例如，输出应如下所示：\"[c1_low,c1_high,c1_high_ok,c1_low_ok,c2_low,c2_high,c2_high_ok,c2_low_ok,c3_low,c3_high,c3_high_ok,c3_low_ok]\"。",
            "solution": "提交审议的问题陈述是有效的。它在科学上植根于统计力学的原理，特别是涨落-耗散定理，并且是适定的，具有一套清晰、自洽的指令和参数。这项任务涉及从模型速度自相关函数重构振动态密度，并随后计算热力学性质，是计算材料科学中的一个标准且相关的练习。所提供的参数和数值规格在物理上是现实的，在计算上也是可行的。\n\n解决方案通过执行问题中概述的步骤序列来进行。该方法论的核心在于两个基本联系：\n1.  **Wiener-Khinchin 定理**，这是涨落-耗散框架的一个具体体现。该定理指出，一个宽平稳随机过程的功率谱密度是其自相关函数的傅里叶变换。对于原子速度而言，功率谱密度与振动态密度（VDOS）成正比。\n2.  来自量子统计力学的原理，即一个无相互作用振子系统（简谐近似）的总宏观热力学性质，可以通过将单个振子的性质在振子频率分布（即VDOS）上积分来计算。\n\n详细的推导和数值实现如下。\n\n**1. 速度自相关函数 ($Z(t)$) 的构建**\n\n问题为 $t \\geq 0$ 的归一化、单边平衡速度自相关函数（VACF）$Z(t)$ 提供了一个模型：\n$$\nZ(t) = \\mathrm{e}^{-\\gamma t} \\sum_{i} w_i \\cos(\\omega_i t)\n$$\n此处，$\\{\\omega_i\\}$ 代表振动简正模的角频率，$\\{w_i\\}$ 是它们在速度自相关中的各自权重（满足 $\\sum_i w_i = 1$ 以确保 $Z(0) = 1$），而 $\\gamma$ 是一个唯象阻尼参数，用于解释能量耗散，导致振动模式具有有限寿命。此函数构建在离散时间网格 $t_k = k \\Delta t$ 上，其中 $k = 0, 1, \\dots, (t_{\\max}/\\Delta t)$。\n\n**2. 振动态密度 ($g(\\omega)$) 的重构**\n\nVDOS $g(\\omega)$ 与速度涨落的功率谱成正比。由于 $Z(t)$ 是时间的实偶函数（根据其物理定义，尽管我们只对 $t \\ge 0$ 进行建模），其傅里叶变换简化为余弦变换：\n$$\ng(\\omega) \\propto \\int_{-\\infty}^{\\infty} Z(t) e^{-i\\omega t} \\, \\mathrm{d}t = 2 \\int_{0}^{\\infty} Z(t) \\cos(\\omega t) \\, \\mathrm{d}t\n$$\n在一个从 $t=0$ 到 $t=t_{\\max}$ 的有限时间信号的数值计算环境中，这个积分是近似的。直接截断积分会导致频谱伪影（泄漏）。为了减轻这种情况，$Z(t)$ 首先乘以一个变迹窗函数 $W(t)$，该函数在时间区间的边界处平滑地趋于零。为此目的选择一个 Hann 窗：\n$$\nW(t) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi t}{t_{\\max}}\\right)\\right) \\quad \\text{for } t \\in [0, t_{\\max}]\n$$\n然后，通过对加窗的 VACF $Z_w(t) = Z(t)W(t)$ 进行数值余弦变换，使用梯形法则进行积分，计算出原始的、未归一化的 VDOS $g_{\\text{raw}}(\\omega)$：\n$$\ng_{\\text{raw}}(\\omega) \\approx \\int_{0}^{t_{\\max}} Z_w(t) \\cos(\\omega t) \\, \\mathrm{d}t\n$$\n通过裁剪掉可能由数值不精确性产生的任何微小负值，使得到的谱严格非负。最后，将 $g(\\omega)$ 归一化以表示模式的概率分布：\n$$\n\\int_{0}^{\\omega_{\\max}} g(\\omega) \\, \\mathrm{d}\\omega = 1\n$$\n这是通过将 $g_{\\text{raw}}(\\omega)$ 除以其在频域 $[0, \\omega_{\\max}]$ 上的总积分来实现的。\n\n**3. 定容比热 ($C_V(T)$) 的计算**\n\n每个振动模式的定容比热 $C_V(T)$，是单个模式比热 $C_{V,\\text{SHO}}(\\omega, T)$ 按 VDOS $g(\\omega)$ 加权的平均值：\n$$\nC_V(T) = \\int_{0}^{\\omega_{\\max}} C_{V,\\text{SHO}}(\\omega, T) g(\\omega) \\, \\mathrm{d}\\omega\n$$\n在温度 $T$ 下，频率为 $\\omega$ 的单个量子谐振子（SHO）的比热，以玻尔兹曼常数 $k_{\\mathrm{B}}$ 为单位，由下式给出：\n$$\n\\frac{C_{V,\\text{SHO}}(\\omega, T)}{k_{\\mathrm{B}}} = \\left(\\frac{\\hbar \\omega}{2k_{\\mathrm{B}}T}\\right)^2 \\frac{1}{\\sinh^2\\left(\\frac{\\hbar \\omega}{2 k_{\\mathrm{B}} T}\\right)}\n$$\n其中 $\\hbar$ 是约化普朗克常数。无量纲参数 $x = \\hbar \\omega / (k_{\\mathrm{B}} T)$ 需要仔细进行单位转换，因为 $\\omega$ 以弧度/皮秒（rad/ps）给出，必须转换为弧度/秒（$1 \\text{ rad/ps} = 10^{12} \\text{ rad/s}$），以与 $\\hbar$ 和 $k_{\\mathrm{B}}$ 的国际单位制（SI）单位保持一致。$C_V(T)$ 的最终积分是在离散频率网格上使用梯形法则进行数值计算的。\n\n**4. 高温和低温极限**\n\n计算出的比热值与两个物理极限进行比较：\n- **经典极限**：根据能量均分定理，在高温下（$k_{\\mathrm{B}} T \\gg \\hbar \\omega$），一维谐振子的比热接近 $k_{\\mathrm{B}}$。因此，检查 $C_V(T_{\\mathrm{high}})/k_{\\mathrm{B}}$ 是否在 $1.0$ 的 $0.05$ 范围内。\n- **低温极限**：当 $T \\to 0$ 时，振动模式“冻结”，比热必须趋于零，这是量子理论的一个关键预测。检查 $C_V(T_{\\mathrm{low}})/k_{\\mathrm{B}}$ 是否小于 $0.05$。\n\n实现过程结合了这些步骤来处理每个测试用例并生成所需的输出量。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It reconstructs the VDOS from a synthetic VACF and calculates specific heat.\n    \"\"\"\n\n    # --- Define Physical and Numerical Parameters ---\n    HBAR = constants.hbar  # Reduced Planck constant in J·s\n    KB = constants.k      # Boltzmann constant in J/K\n\n    T_MAX = 5.0      # Maximum correlation time in ps\n    DT = 0.001       # Time step in ps\n    OMEGA_MAX = 100.0  # Maximum angular frequency in rad/ps\n    N_OMEGA = 2001   # Number of points on the frequency grid\n\n    # Create the time and frequency grids\n    t_grid = np.arange(0, T_MAX + DT, DT)\n    omega_grid = np.linspace(0, OMEGA_MAX, N_OMEGA)\n\n    # --- Test Cases ---\n    test_cases = [\n        {'weights': [1.0], 'freqs': [30.0], 'gamma': 0.0, 'T_low': 10.0, 'T_high': 3000.0},\n        {'weights': [0.6, 0.4], 'freqs': [20.0, 50.0], 'gamma': 0.0, 'T_low': 5.0, 'T_high': 5000.0},\n        {'weights': [0.5, 0.5], 'freqs': [15.0, 40.0], 'gamma': 5.0, 'T_low': 5.0, 'T_high': 5000.0},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # --- Step 1: Construct Velocity Autocorrelation Function Z(t) ---\n        weights = np.array(case['weights'])\n        freqs = np.array(case['freqs'])\n        gamma = case['gamma']\n        \n        z_t = np.zeros_like(t_grid)\n        for w, f in zip(weights, freqs):\n            z_t += w * np.cos(f * t_grid)\n        z_t *= np.exp(-gamma * t_grid)\n\n        # --- Step 2: Reconstruct Vibrational Density of States g(omega) ---\n        # Apply a Hann window to Z(t) to suppress spectral leakage from signal truncation\n        hann_window = 0.5 * (1 - np.cos(2 * np.pi * t_grid / T_MAX))\n        z_t_windowed = z_t * hann_window\n\n        # Perform cosine transform via numerical integration (trapezoidal rule).\n        # This is done efficiently using NumPy broadcasting.\n        cos_matrix = np.cos(np.outer(t_grid, omega_grid))\n        integrand = z_t_windowed[:, np.newaxis] * cos_matrix\n        g_raw = integrate.trapezoid(integrand, t_grid, axis=0)\n        \n        # Ensure g(omega) is non-negative, clipping any numerical noise\n        g_raw[g_raw  0] = 0.0\n\n        # Normalize g(omega) such that its integral is 1\n        norm_const = integrate.trapezoid(g_raw, omega_grid)\n        g_omega = g_raw / norm_const if norm_const > 1e-12 else np.zeros_like(omega_grid)\n\n        # --- Step 3: Compute Constant-Volume Specific Heat Cv(T) ---\n        def calculate_cv_per_mode(T, vdos, omega_grid_rps):\n            if T == 0:\n                return 0.0\n            \n            # Convert omega from rad/ps to rad/s for use with SI unit constants\n            omega_grid_rs = omega_grid_rps * 1e12\n            \n            # Dimensionless parameter x = hbar*omega / (kB*T)\n            # Handle T=0 or omega=0 cases where x might be ill-defined\n            x = np.zeros_like(omega_grid_rs)\n            valid_T = T > 1e-9\n            if valid_T:\n                x = (HBAR * omega_grid_rs) / (KB * T)\n            \n            # Specific heat of a single quantum harmonic oscillator in units of kB\n            cv_sho_per_kb = np.ones_like(x)\n            non_zero_x = x > 1e-9\n            \n            arg = x[non_zero_x] / 2.0\n            cv_sho_per_kb[non_zero_x] = np.power(arg, 2) / np.power(np.sinh(arg), 2)\n            \n            # Total specific heat per mode is the average over the VDOS\n            total_cv_per_kb = integrate.trapezoid(cv_sho_per_kb * vdos, omega_grid_rps)\n            return total_cv_per_kb\n\n        cv_low = calculate_cv_per_mode(case['T_low'], g_omega, omega_grid)\n        cv_high = calculate_cv_per_mode(case['T_high'], g_omega, omega_grid)\n        \n        # --- Step 4: Perform Boolean Checks ---\n        # Classical limit for Cv per mode is 1.0 kB\n        classical_limit = 1.0\n        high_temp_check = abs(cv_high - classical_limit)  0.05\n        low_temp_check = cv_low  0.05\n        \n        all_results.extend([cv_low, cv_high, high_temp_check, low_temp_check])\n\n    # --- Final Output Formatting ---\n    # Format the results into a single comma-separated string as per problem specification.\n    # Boolean values are converted to lowercase strings 'true'/'false'.\n    final_list_str = []\n    for r in all_results:\n        if isinstance(r, bool):\n            final_list_str.append(str(r).lower())\n        else:\n            final_list_str.append(str(r))\n    \n    print(f\"[{','.join(final_list_str)}]\")\n\nsolve()\n```"
        }
    ]
}