{
    "hands_on_practices": [
        {
            "introduction": "A material's electronic behavior is profoundly linked to the topology of its Fermi surface. As external parameters like pressure or doping shift the chemical potential, the Fermi surface can undergo abrupt changes in its connectivity, known as Lifshitz transitions. This exercise  provides foundational practice in identifying the critical points in a band structure, the van Hove singularities, that drive these transitions, thereby connecting the abstract mathematical form of a dispersion relation to tangible changes in the physical system.",
            "id": "3451548",
            "problem": "Consider a three-dimensional nearest-neighbor tight-binding band on a simple cubic lattice with lattice constant $a$ and hopping amplitude $t0$, with dispersion\n$$\nE(\\mathbf{k})=-2t\\left(\\cos(k_x a)+\\cos(k_y a)+\\cos(k_z a)\\right),\n$$\nwhere $\\mathbf{k}$ lies in the first Brillouin zone $k_i\\in[-\\pi/a,\\pi/a]$ for $i\\in\\{x,y,z\\}$. The Fermi surface (FS) is defined by the locus of $\\mathbf{k}$ satisfying $E(\\mathbf{k})=\\mu$, where $\\mu$ is the chemical potential. A van Hove singularity arises at stationary points of $E(\\mathbf{k})$ in the Brillouin zone where the energy dispersion has an indefinite Hessian (saddle point), and a continuous change in the topology of the FS (a Lifshitz transition) occurs when $\\mu$ crosses the corresponding stationary energy.\n\nStarting from the definitions of stationary points and the classification of critical points via the Hessian matrix, determine all saddle-point energies of $E(\\mathbf{k})$ in the first Brillouin zone. Using these, analyze how the topology of the FS evolves as $\\mu$ is tuned from the band bottom to the band top, and identify all distinct chemical potential values at which a Lifshitz transition driven by a van Hove crossing occurs. Express your final answer for the critical chemical potential value(s) in terms of $t$ (use $t$ as the energy unit). The final answer must be given as a symbolic expression. Do not include any units in the final answer.",
            "solution": "The problem asks for the chemical potential values $\\mu$ at which a Lifshitz transition, driven by a van Hove singularity, occurs for a given tight-binding model on a simple cubic lattice. The dispersion relation is given by\n$$\nE(\\mathbf{k}) = -2t\\left(\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a)\\right)\n$$\nwhere $t0$ is the hopping amplitude, $a$ is the lattice constant, and $\\mathbf{k}=(k_x, k_y, k_z)$ is a wavevector in the first Brillouin zone (BZ), defined by $k_i \\in [-\\pi/a, \\pi/a]$ for $i \\in \\{x,y,z\\}$.\n\nA Lifshitz transition occurs when the chemical potential $\\mu$ crosses the energy of a stationary point of the dispersion $E(\\mathbf{k})$. A van Hove singularity corresponds to such a stationary point. We begin by finding all stationary points $\\mathbf{k}^*$ in the BZ by solving $\\nabla_{\\mathbf{k}} E(\\mathbf{k}) = \\mathbf{0}$.\n\nThe components of the gradient are:\n$$\n\\frac{\\partial E}{\\partial k_x} = 2ta \\sin(k_x a)\n$$\n$$\n\\frac{\\partial E}{\\partial k_y} = 2ta \\sin(k_y a)\n$$\n$$\n\\frac{\\partial E}{\\partial k_z} = 2ta \\sin(k_z a)\n$$\nSetting the gradient to zero gives $\\sin(k_i a) = 0$ for each component $i \\in \\{x,y,z\\}$. Within the first BZ, this condition is satisfied when $k_i a \\in \\{0, \\pi\\}$. We note that points on the BZ boundary like $k_i a = -\\pi$ are equivalent to $k_i a = \\pi$ by a reciprocal lattice vector. This yields $2^3 = 8$ distinct high-symmetry points in the BZ.\n\nTo classify these stationary points, we compute the Hessian matrix, $H_{ij} = \\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$. The second partial derivatives are:\n$$\n\\frac{\\partial^2 E}{\\partial k_x^2} = 2ta^2 \\cos(k_x a)\n$$\n$$\n\\frac{\\partial^2 E}{\\partial k_y^2} = 2ta^2 \\cos(k_y a)\n$$\n$$\n\\frac{\\partial^2 E}{\\partial k_z^2} = 2ta^2 \\cos(k_z a)\n$$\nAll off-diagonal terms $\\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$ for $i \\neq j$ are zero. Thus, the Hessian matrix is diagonal:\n$$\nH(\\mathbf{k}) = 2ta^2 \\begin{pmatrix} \\cos(k_x a)  0  0 \\\\ 0  \\cos(k_y a)  0 \\\\ 0  0  \\cos(k_z a) \\end{pmatrix}\n$$\nThe eigenvalues of $H$ are its diagonal elements. The nature of a stationary point is determined by the signs of these eigenvalues. Since $t0$ and $a0$, the signs are determined by the values of $\\cos(k_i a)$, which are either $\\cos(0)=1$ or $\\cos(\\pi)=-1$.\n\nWe now classify the stationary points and find their energies:\n1.  **Point $\\Gamma$**: $\\mathbf{k}a = (0,0,0)$.\n    Here, $\\cos(k_i a)=1$ for all $i$. The eigenvalues of $H$ are all positive ($2ta^2, 2ta^2, 2ta^2$). This point is a local minimum.\n    The energy is $E_{\\min} = E(0,0,0) = -2t(1+1+1) = -6t$. This is the band bottom.\n\n2.  **Points $X$**: $\\mathbf{k}a = (\\pi,0,0)$ and its two permutations $(0,\\pi,0)$ and $(0,0,\\pi)$.\n    For $\\mathbf{k}a=(\\pi,0,0)$, the cosines are $(-1,1,1)$. The eigenvalues of $H$ have signs $(-,+,+)$. These are saddle points of index $1$.\n    The energy at these points is $E_1 = E(\\pi/a,0,0) = -2t(-1+1+1) = -2t$.\n\n3.  **Points $M$**: $\\mathbf{k}a = (\\pi,\\pi,0)$ and its two permutations $(\\pi,0,\\pi)$ and $(0,\\pi,\\pi)$.\n    For $\\mathbf{k}a=(\\pi,\\pi,0)$, the cosines are $(-1,-1,1)$. The eigenvalues of $H$ have signs $(-,-,+)$. These are saddle points of index $2$.\n    The energy at these points is $E_2 = E(\\pi/a,\\pi/a,0) = -2t(-1-1+1) = 2t$.\n\n4.  **Point $R$**: $\\mathbf{k}a = (\\pi,\\pi,\\pi)$.\n    Here, $\\cos(k_i a)=-1$ for all $i$. The eigenvalues of $H$ are all negative ($-2ta^2, -2ta^2, -2ta^2$). This point is a local maximum.\n    The energy is $E_{\\max}=E(\\pi/a,\\pi/a,\\pi/a) = -2t(-1-1-1) = 6t$. This is the band top.\n\nThe problem asks for the chemical potential values $\\mu$ where Lifshitz transitions are driven by a van Hove crossing. These correspond to the energies of the saddle points, where the Hessian matrix is indefinite. From our analysis, these are the energies $E_1 = -2t$ and $E_2 = 2t$.\n\nThe evolution of the Fermi surface (FS) topology as $\\mu$ increases from $-6t$ to $6t$ confirms these transitions:\n-   For $\\mu$ just above $-6t$, the FS consists of small, closed spherical electron pockets centered at the $\\Gamma$ point.\n-   At $\\mu = -2t$, the FS, which has grown from the $\\Gamma$ point, makes contact with the BZ boundary at the $X$ points. This corresponds to the FS touching its periodic images, causing a topological change from a closed surface to a single, connected, open \"jungle-gym\" structure. This is the first Lifshitz transition.\n-   At $\\mu = 2t$, the open FS undergoes another topological change. This is best viewed from the perspective of hole states near the band top. The previously connected structure of unoccupied states breaks apart. The FS transitions from a single open surface to a set of disjoint, closed hole pockets centered at the $R$ point. This is the second Lifshitz transition.\n-   For $\\mu$ approaching $6t$, the FS consists of small, shrinking hole pockets around the $R$ point, which vanish at $\\mu=6t$.\n\nThe distinct chemical potential values at which these saddle-point-driven Lifshitz transitions occur are therefore the energies of the $X$ and $M$ points.\n$$\n\\mu_1 = -2t\n$$\n$$\n\\mu_2 = 2t\n$$\nThese are the energies of the van Hove singularities associated with saddle points in the band structure.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -2t  2t \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Quantum oscillation experiments, such as the de Haas-van Alphen effect, serve as one of the most powerful tools for mapping the geometry of a material's Fermi surface. The oscillation frequencies observed in magnetization are directly proportional to the extremal cross-sectional areas of the Fermi surface perpendicular to an applied magnetic field. This problem  challenges you to apply the semiclassical Onsager relation, a cornerstone of the field, to translate an analytical band structure into predictions for these experimentally measurable quantities.",
            "id": "3451505",
            "problem": "Consider a single quasi-two-dimensional electronic band with dispersion\n$$\nE(\\mathbf{k}) \\equiv E(k_{x},k_{y},k_{z}) = \\frac{\\hbar^{2}}{2 m} \\left(k_{x}^{2} + k_{y}^{2}\\right) + 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right],\n$$\nwhere $m$ is the in-plane band mass, $t_{z}  0$ is an interlayer hopping amplitude, $c$ is the interlayer lattice constant, and $\\hbar$ is the reduced Planck constant. Assume a constant Fermi energy $E_{F}$ with $E_{F}  4 t_{z}$ so that the Fermi surface is a weakly corrugated cylinder along $\\hat{z}$. A uniform magnetic field is applied along $\\hat{z}$ so that the cyclotron motion is in planes of fixed $k_{z}$.\n\nStarting from fundamental semiclassical quantization for electron orbits in a magnetic field and core definitions of the Fermi surface as the set of $\\mathbf{k}$ satisfying $E(\\mathbf{k}) = E_{F}$, do the following:\n\n1. For fixed $k_{z}$, derive the Fermi wavevector $k_{F}(k_{z})$ in the $k_{x}$-$k_{y}$ plane and the corresponding cross-sectional area $A(k_{z})$ enclosed by the Fermi contour at that $k_{z}$.\n2. Determine the extremal values of $A(k_{z})$ with respect to $k_{z}$, identifying which $k_{z}$ yield the maximum and minimum areas and providing those areas symbolically.\n3. Using the semiclassical quantization framework, predict the set of fundamental quantum oscillation (de Haas–van Alphen (dHvA)) frequencies associated with these extremal cross-sections and the corresponding cyclotron effective masses at the Fermi level for those orbits.\n\nProvide the final result as a single row matrix containing, in order, the two extremal dHvA frequencies (maximum-area first, then minimum-area) and the two corresponding cyclotron effective masses (for the maximum-area orbit first, then the minimum-area orbit). Express the oscillation frequencies in Tesla and the effective masses in kilograms. No numerical values are provided; give your answers as closed-form analytic expressions in terms of $m$, $E_{F}$, $t_{z}$, $e$, and $\\hbar$. Do not include any units in your final boxed answer.",
            "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **Dispersion Relation**: $E(\\mathbf{k}) \\equiv E(k_{x},k_{y},k_{z}) = \\frac{\\hbar^{2}}{2 m} \\left(k_{x}^{2} + k_{y}^{2}\\right) + 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]$.\n- **Parameters**: $m$ is the in-plane band mass, $t_{z}  0$ is the interlayer hopping amplitude, $c$ is the interlayer lattice constant, and $\\hbar$ is the reduced Planck constant. The elementary charge is denoted by $e$.\n- **Condition**: Fermi energy $E_{F}$ is a constant satisfying $E_{F}  4 t_{z}$.\n- **Setup**: A uniform magnetic field is applied along the $\\hat{z}$ direction. Cyclotron motion occurs in planes of constant $k_{z}$.\n- **Tasks**:\n  1. Derive the Fermi wavevector $k_{F}(k_{z})$ and cross-sectional area $A(k_{z})$ for a fixed $k_{z}$.\n  2. Determine the extremal values of $A(k_{z})$ with respect to $k_{z}$, the values of $k_{z}$ where they occur, and the symbolic expressions for these extremal areas.\n  3. Predict the set of de Haas–van Alphen (dHvA) frequencies and corresponding cyclotron effective masses for these extremal orbits.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded (Critical)**: The problem is based on the semiclassical model of electron dynamics in solids and the tight-binding approximation, which are standard and well-established frameworks in condensed matter physics. The dispersion relation is a common model for quasi-two-dimensional layered materials. The analysis of quantum oscillations (dHvA effect) is a fundamental experimental and theoretical tool. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly stated. The condition $E_{F}  4 t_{z}$ is crucial and ensures that the Fermi surface is a single, continuous, corrugated-cylinder-like sheet that is not \"pinched off\" or gapped at any $k_{z}$. This guarantees the existence of well-defined, non-zero minimum and maximum cross-sectional areas, leading to a unique solution.\n- **Objective (Critical)**: The problem is formulated using precise mathematical language and objective physical concepts, free from any subjective or biased statements.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, objective, and contains sufficient information for a unique solution. Proceeding to the solution.\n\n---\n\n### Part 1: Fermi Wavevector and Cross-Sectional Area\n\nThe Fermi surface is defined as the set of all wavevectors $\\mathbf{k}$ such that the energy $E(\\mathbf{k})$ equals the Fermi energy $E_{F}$.\n$$\nE_{F} = \\frac{\\hbar^{2}}{2 m} \\left(k_{x}^{2} + k_{y}^{2}\\right) + 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\n$$\nThe problem states that the magnetic field is along $\\hat{z}$, causing electrons to execute cyclotron motion in planes of constant $k_{z}$. For a fixed $k_{z}$, the Fermi surface contour is a circle in the $k_{x}$-$k_{y}$ plane. Let $k_{\\perp}^{2} = k_{x}^{2} + k_{y}^{2}$. The equation for the Fermi surface at a fixed $k_{z}$ becomes:\n$$\n\\frac{\\hbar^{2}}{2 m} k_{\\perp}^{2} = E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\n$$\nThe Fermi wavevector in the plane, $k_{F}(k_{z})$, is the radius of this circular cross-section, which is $k_{\\perp}$ evaluated at the Fermi energy.\n$$\nk_{F}(k_{z})^{2} = \\frac{2 m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)\n$$\nThus, the Fermi wavevector is:\n$$\nk_{F}(k_{z}) = \\sqrt{\\frac{2 m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)}\n$$\nThe cross-sectional area $A(k_{z})$ of the Fermi surface in a plane of constant $k_{z}$ is the area of a circle with radius $k_{F}(k_{z})$:\n$$\nA(k_{z}) = \\pi k_{F}(k_{z})^{2}\n$$\nSubstituting the expression for $k_{F}(k_{z})^{2}$:\n$$\nA(k_{z}) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)\n$$\n\n### Part 2: Extremal Cross-Sectional Areas\n\nTo find the extremal values of $A(k_{z})$, we must find the extrema of the term $\\cos(k_{z} c)$, as all other terms are constants. The function $\\cos(x)$ has a maximum value of $1$ and a minimum value of $-1$.\n\nThe area $A(k_{z})$ is maximized when the term being subtracted from $E_{F}$ is minimized. This occurs when $1 - \\cos(k_{z} c)$ is at its minimum. The minimum value of $1 - \\cos(k_{z} c)$ is $1 - 1 = 0$, which occurs when $\\cos(k_{z} c) = 1$. This condition is met for $k_{z} c = 2 n \\pi$, or $k_{z} = \\frac{2 n \\pi}{c}$ for any integer $n$. A principal value is $k_{z}=0$. This orbit is often called the \"belly\" orbit. The maximum area, $A_{max}$, is:\n$$\nA_{max} = A(k_{z}=0) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - 1\\right]\\right) = \\frac{2 \\pi m E_{F}}{\\hbar^{2}}\n$$\n\nThe area $A(k_{z})$ is minimized when the term being subtracted from $E_{F}$ is maximized. This occurs when $1 - \\cos(k_{z} c)$ is at its maximum. The maximum value of $1 - \\cos(k_{z} c)$ is $1 - (-1) = 2$, which occurs when $\\cos(k_{z} c) = -1$. This condition is met for $k_z c = (2 n + 1) \\pi$, or $k_{z} = \\frac{(2 n + 1) \\pi}{c}$ for any integer $n$. A principal value is $k_z = \\pi/c$, which corresponds to the Brillouin zone boundary in many simple cases. This orbit is often called the \"neck\" orbit. The minimum area, $A_{min}$, is:\n$$\nA_{min} = A(k_{z}=\\pi/c) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - (-1)\\right]\\right) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 4 t_{z}\\right)\n$$\nThe condition $E_{F}  4 t_{z}$ ensures that $A_{min}$ is positive and the Fermi surface is not pinched off.\n\n### Part 3: dHvA Frequencies and Cyclotron Masses\n\nThe de Haas–van Alphen (dHvA) oscillation frequency $F$, measured in units of magnetic field (Tesla), is related to an extremal cross-sectional area of the Fermi surface, $A_{ext}$, by the Onsager relation:\n$$\nF = \\frac{\\hbar}{2 \\pi e} A_{ext}\n$$\nWe have two extremal areas, $A_{max}$ and $A_{min}$, which give rise to two fundamental frequencies, $F_{max}$ and $F_{min}$.\n\nFor the maximum area orbit:\n$$\nF_{max} = \\frac{\\hbar}{2 \\pi e} A_{max} = \\frac{\\hbar}{2 \\pi e} \\left(\\frac{2 \\pi m E_{F}}{\\hbar^{2}}\\right) = \\frac{m E_{F}}{e \\hbar}\n$$\n\nFor the minimum area orbit:\n$$\nF_{min} = \\frac{\\hbar}{2 \\pi e} A_{min} = \\frac{\\hbar}{2 \\pi e} \\left(\\frac{2 \\pi m (E_{F} - 4 t_{z})}{\\hbar^{2}}\\right) = \\frac{m (E_{F} - 4 t_{z})}{e \\hbar}\n$$\n\nNext, we determine the cyclotron effective mass, $m_{c}$, for these orbits. The cyclotron mass is defined at the Fermi energy as:\n$$\nm_{c}(k_{z}) = \\frac{\\hbar^{2}}{2 \\pi} \\left. \\frac{\\partial A(E, k_{z})}{\\partial E} \\right|_{E=E_{F}}\n$$\nTo calculate this, we first express the area $A$ as a function of a general energy $E$ and $k_z$:\n$$\nA(E, k_z) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)\n$$\nNow, we take the partial derivative with respect to $E$:\n$$\n\\frac{\\partial A(E, k_{z})}{\\partial E} = \\frac{\\partial}{\\partial E} \\left[ \\frac{2 \\pi m}{\\hbar^{2}} \\left(E - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right) \\right] = \\frac{2 \\pi m}{\\hbar^{2}}\n$$\nThis derivative is a constant, independent of both $E$ and $k_{z}$. Therefore, the cyclotron mass is the same for all orbits on the Fermi surface.\n$$\nm_{c} = \\frac{\\hbar^{2}}{2 \\pi} \\left(\\frac{2 \\pi m}{\\hbar^{2}}\\right) = m\n$$\nThis result confirms that the cyclotron mass for both the maximum-area orbit ($m_{c,max}$) and the minimum-area orbit ($m_{c,min}$) is equal to the in-plane band mass $m$.\n$$\nm_{c,max} = m_{c,min} = m\n$$\nThis is expected for a dispersion that is purely parabolic in the plane of the cyclotron orbit.\n\nThe final answer requires a row matrix containing the four calculated quantities in the order: $F_{max}$, $F_{min}$, $m_{c,max}$, $m_{c,min}$.",
            "answer": "$$\n\\boxed{\\pmatrix{ \\frac{m E_{F}}{e \\hbar}  \\frac{m(E_{F} - 4t_{z})}{e \\hbar}  m  m }}\n$$"
        },
        {
            "introduction": "While first-principles calculations can produce highly accurate band structures, simpler analytical models like the tight-binding approximation are often essential for deeper analysis and building models for larger-scale phenomena. The energy dispersion $E(\\mathbf{k})$ in this framework can be expressed as a Fourier series, allowing its coefficients—the hopping parameters—to be determined by fitting to more fundamental data. This computational exercise  guides you through the practical workflow of parameterizing an effective model from synthetic *ab initio* data, honing crucial skills in linear regression and the assessment of a model's physical plausibility.",
            "id": "3451506",
            "problem": "You are given a task grounded in the analysis of Fermi surfaces in computational materials science. Start from the well-established premise of the Tight-Binding (TB) approximation for a single-band on a two-dimensional square lattice with up to next-next-nearest neighbor hopping. In this framework, the electronic band energy as a function of crystal momentum $\\mathbf{k} = (k_x,k_y)$ can be represented by a Fourier series whose coefficients are hopping amplitudes. For a minimal but expressive model, adopt the following parametric form for the energy:\n$$\nE(\\mathbf{k}) \\equiv E(k_x,k_y) = \\epsilon_0 - 2 t_1 \\left(\\cos k_x + \\cos k_y\\right) - 4 t_2 \\cos k_x \\cos k_y - 2 t_3 \\left(\\cos 2 k_x + \\cos 2 k_y\\right),\n$$\nwhere $\\epsilon_0$ is an onsite energy measured relative to the Fermi energy (set to $0$), and $t_1$, $t_2$, $t_3$ are hopping amplitudes. All energies must be expressed in electronvolts (eV), and all angles must be in radians.\n\nYour task is to write a complete and runnable program that:\n- Generates synthetic \"ab initio\" energy data $E_i$ along specified cuts through momentum space $\\mathbf{k}_i$, using known ground-truth parameters and a Gaussian noise model with a specified pseudorandom seed. The independent variable $\\mathbf{k}$ must be sampled along two orthogonal cuts for each test case: one at fixed $k_y = k_{y,0}$ as $k_x$ varies, and one at fixed $k_x = k_{x,0}$ as $k_y$ varies. The cosine arguments are in radians and the Brillouin-zone range is $[0,\\pi]$ for both $k_x$ and $k_y$.\n- Fits the TB parameters $\\theta = [\\epsilon_0, t_1, t_2, t_3]^T$ by ordinary least squares on the linear form\n$$\nE(\\mathbf{k}) = \\epsilon_0 + t_1 X_1(\\mathbf{k}) + t_2 X_2(\\mathbf{k}) + t_3 X_3(\\mathbf{k}),\n$$\nwhere\n$$\nX_1(\\mathbf{k}) = -2 \\left(\\cos k_x + \\cos k_y\\right), \\quad X_2(\\mathbf{k}) = -4 \\cos k_x \\cos k_y, \\quad X_3(\\mathbf{k}) = -2 \\left(\\cos 2 k_x + \\cos 2 k_y\\right).\n$$\n- Reports the root-mean-square error (RMSE) of the fit in eV, defined as\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left(E_i - \\widehat{E}_i\\right)^2},\n$$\nrounded to six decimal places.\n- Assesses physical plausibility of the fitted parameters via the following boolean criteria, all of which must simultaneously hold to declare the fit physically plausible:\n    1. Dominant nearest-neighbor hopping: $\\max\\left(|t_2|,|t_3|\\right) \\leq 0.6\\,|t_1|$.\n    2. Small onsite offset relative to the Fermi level: $|\\epsilon_0| \\leq 0.1$ eV.\n    3. Reasonable bandwidth estimate from the model coefficients: $W_{\\mathrm{est}} \\equiv 8|t_1| + 16|t_2| + 8|t_3| \\leq 3.0$ eV.\n- Outputs, for each test case, a list containing the RMSE (as a float rounded to six decimals) and the plausibility decision (as a boolean). The final program output must be a single line containing a list of these per-case results, with no additional text.\n\nUse the following test suite of three cases. In all cases, use $\\pi$ for the Brillouin-zone boundary and sample $k_x$ and $k_y$ linearly over the specified intervals. When generating Gaussian noise, use a zero mean and the specified standard deviation and seed. Energies must be in eV, and angles in radians.\n\n- Case A (general, mildly noisy):\n    - Ground-truth parameters: $\\epsilon_0 = 0.02$ eV, $t_1 = 0.25$ eV, $t_2 = -0.05$ eV, $t_3 = 0.02$ eV.\n    - Cuts: fixed $k_y = \\pi/3$ with $k_x$ sampled at $N_x = 41$ points from $0$ to $\\pi$ inclusive; fixed $k_x = \\pi/5$ with $k_y$ sampled at $N_y = 37$ points from $0$ to $\\pi$ inclusive.\n    - Noise: Gaussian with standard deviation $\\sigma = 0.003$ eV; pseudorandom seed $s = 1$.\n\n- Case B (isotropic nearest-neighbor only, noiseless):\n    - Ground-truth parameters: $\\epsilon_0 = 0.0$ eV, $t_1 = 0.15$ eV, $t_2 = 0.0$ eV, $t_3 = 0.0$ eV.\n    - Cuts: fixed $k_y = \\pi/4$ with $k_x$ sampled at $N_x = 25$ points from $0$ to $\\pi$ inclusive; fixed $k_x = \\pi/2$ with $k_y$ sampled at $N_y = 25$ points from $0$ to $\\pi$ inclusive.\n    - Noise: $\\sigma = 0.0$ eV; pseudorandom seed $s = 2$ (the seed is irrelevant for zero noise but must still be set).\n\n- Case C (near-degenerate anisotropy, mildly noisy):\n    - Ground-truth parameters: $\\epsilon_0 = 0.0$ eV, $t_1 = 0.08$ eV, $t_2 = 0.06$ eV, $t_3 = 0.0$ eV.\n    - Cuts: fixed $k_y = \\pi/6$ with $k_x$ sampled at $N_x = 41$ points from $0$ to $\\pi$ inclusive; fixed $k_x = \\pi/3$ with $k_y$ sampled at $N_y = 41$ points from $0$ to $\\pi$ inclusive.\n    - Noise: Gaussian with standard deviation $\\sigma = 0.002$ eV; pseudorandom seed $s = 3$.\n\nImplementation requirements:\n- Construct the design matrix with one row per data point using the features $X_1(\\mathbf{k})$, $X_2(\\mathbf{k})$, $X_3(\\mathbf{k})$ and an intercept for $\\epsilon_0$.\n- Solve the least-squares problem using a numerically stable method appropriate for linear regression.\n- For each case, compute the RMSE in eV and the plausibility decision as specified above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact format:\n\"[ [rmse_A,plaus_A], [rmse_B,plaus_B], [rmse_C,plaus_C] ]\"\nwhere each \"rmse_X\" is a float rounded to six decimals and each \"plaus_X\" is a boolean. For example, a structurally correct output would look like \"[[0.001234,True],[0.000000,True],[0.002345,False]]\" but with the actual computed values for the specified test suite.",
            "solution": "The problem presented is a valid and well-posed exercise in computational materials science, specifically in the domain of parameterizing electronic band structures. It requires fitting a Tight-Binding (TB) model to synthetically generated energy data using linear least squares. The validation of the problem statement proceeds as follows.\n\nThe givens are:\n1.  **Energy Model**: The electronic band energy $E(\\mathbf{k})$ for a 2D square lattice is given by:\n    $$\n    E(\\mathbf{k}) \\equiv E(k_x,k_y) = \\epsilon_0 - 2 t_1 \\left(\\cos k_x + \\cos k_y\\right) - 4 t_2 \\cos k_x \\cos k_y - 2 t_3 \\left(\\cos 2 k_x + \\cos 2 k_y\\right)\n    $$\n    where $\\mathbf{k} = (k_x, k_y)$ is the crystal momentum, $\\epsilon_0$ is the onsite energy relative to a Fermi energy of $0$, and $t_1, t_2, t_3$ are hopping amplitudes.\n2.  **Linear Regression Form**: The model is to be fitted in the linear form $E(\\mathbf{k}) = \\epsilon_0 + t_1 X_1(\\mathbf{k}) + t_2 X_2(\\mathbf{k}) + t_3 X_3(\\mathbf{k})$, with coefficients (parameters) $\\theta = [\\epsilon_0, t_1, t_2, t_3]^T$ and basis functions (features):\n    $$\n    X_1(\\mathbf{k}) = -2 \\left(\\cos k_x + \\cos k_y\\right) \\\\\n    X_2(\\mathbf{k}) = -4 \\cos k_x \\cos k_y \\\\\n    X_3(\\mathbf{k}) = -2 \\left(\\cos 2 k_x + \\cos 2 k_y\\right)\n    $$\n3.  **Root-Mean-Square Error (RMSE)**: The fit quality is measured by $\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left(E_i - \\widehat{E}_i\\right)^2}$, rounded to six decimal places, where $E_i$ are the \"observed\" energies and $\\widehat{E}_i$ are the fitted energies.\n4.  **Physical Plausibility Criteria**: A fit is plausible if and only if all three conditions are met:\n    - Dominant nearest-neighbor hopping: $\\max\\left(|t_2|,|t_3|\\right) \\leq 0.6\\,|t_1|$.\n    - Small onsite offset: $|\\epsilon_0| \\leq 0.1$ eV.\n    - Reasonable bandwidth estimate: $W_{\\mathrm{est}} \\equiv 8|t_1| + 16|t_2| + 8|t_3| \\leq 3.0$ eV.\n5.  **Test Cases**: Three specific cases (A, B, C) are provided with ground-truth parameters, descriptions of momentum-space cuts for data sampling, and specifications for Gaussian noise generation (standard deviation $\\sigma$ and pseudorandom seed $s$).\n\nThe problem is scientifically grounded, well-posed, and objective. It utilizes a standard TB model and a common parameter-fitting technique (ordinary least squares) which is fundamental in this field. All components are clearly defined, including the mathematical model, data generation protocol, error metric, and evaluation criteria. The provided data and constraints are self-consistent and physically reasonable. Therefore, the problem is deemed valid and a solution can be constructed.\n\nThe solution is approached by formulating the task as a linear regression problem. For a set of $N$ data points $(\\mathbf{k}_i, E_i)$, we seek the parameter vector $\\hat{\\theta} = [\\hat{\\epsilon}_0, \\hat{t}_1, \\hat{t}_2, \\hat{t}_3]^T$ that minimizes the sum of squared residuals. This can be expressed in matrix form as minimizing $\\| \\mathbf{E} - A \\theta \\|_2^2$, where $\\mathbf{E}$ is the $N \\times 1$ vector of observed energies, $\\theta$ is the $4 \\times 1$ vector of parameters, and $A$ is the $N \\times 4$ design matrix.\n\nThe columns of the design matrix $A$ correspond to the basis functions of the linear model. For each data point $\\mathbf{k}_i = (k_{x,i}, k_{y,i})$, the corresponding row of $A$ is:\n$$\nA_i = \\begin{bmatrix} 1  X_1(\\mathbf{k}_i)  X_2(\\mathbf{k}_i)  X_3(\\mathbf{k}_i) \\end{bmatrix}\n$$\nThe first column of ones is the regressor for the intercept term, $\\epsilon_0$. The aformentioned basis functions $X_1, X_2, X_3$ constitute the remaining columns.\n\nThe procedure for each test case is as follows:\n1.  **Data Generation**:\n    - The momentum vectors $\\mathbf{k}_i$ are generated by creating two linear grids of points as specified (e.g., using `numpy.linspace`) and concatenating them.\n    - The true energies $E_{\\mathrm{true},i}$ are calculated for each $\\mathbf{k}_i$ using the given ground-truth parameters for that case.\n    - A pseudorandom number generator is seeded, and a vector of Gaussian noise with the specified standard deviation $\\sigma$ is generated.\n    - The final \"observed\" energies are computed as $E_i = E_{\\mathrm{true},i} + \\mathrm{noise}_i$.\n\n2.  **Linear Regression**:\n    - The design matrix $A$ is constructed based on the generated $\\mathbf{k}_i$ vectors.\n    - The ordinary least-squares problem $A\\theta = \\mathbf{E}$ is solved for the parameter vector $\\hat{\\theta}$. This is performed using a numerically stable algorithm, such as one based on QR decomposition or Singular Value Decomposition (SVD), as implemented in `numpy.linalg.lstsq`.\n\n3.  **Analysis**:\n    - The fitted energies are predicted using the determined parameters: $\\widehat{\\mathbf{E}} = A\\hat{\\theta}$.\n    - The RMSE is calculated as the square root of the mean of $(E_i - \\widehat{E}_i)^2$.\n    - The fitted parameters $\\hat{\\epsilon}_0, \\hat{t}_1, \\hat{t}_2, \\hat{t}_3$ are evaluated against the three specified physical plausibility criteria. The overall plausibility is the logical conjunction (AND) of the individual checks.\n\nThis entire process is encapsulated in a program that iterates through the three test cases and formats the results into the required output string.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the Tight-Binding model fitting problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: General, mildly noisy\n        {\n            \"truth_params\": [0.02, 0.25, -0.05, 0.02],  # [eps0, t1, t2, t3]\n            \"cuts\": [\n                {\"fixed_dim\": \"ky\", \"fixed_val\": np.pi / 3, \"var_dim\": \"kx\", \"n_points\": 41},\n                {\"fixed_dim\": \"kx\", \"fixed_val\": np.pi / 5, \"var_dim\": \"ky\", \"n_points\": 37},\n            ],\n            \"noise_sigma\": 0.003,\n            \"seed\": 1,\n        },\n        # Case B: Isotropic nearest-neighbor only, noiseless\n        {\n            \"truth_params\": [0.0, 0.15, 0.0, 0.0],\n            \"cuts\": [\n                {\"fixed_dim\": \"ky\", \"fixed_val\": np.pi / 4, \"var_dim\": \"kx\", \"n_points\": 25},\n                {\"fixed_dim\": \"kx\", \"fixed_val\": np.pi / 2, \"var_dim\": \"ky\", \"n_points\": 25},\n            ],\n            \"noise_sigma\": 0.0,\n            \"seed\": 2,\n        },\n        # Case C: Near-degenerate anisotropy, mildly noisy\n        {\n            \"truth_params\": [0.0, 0.08, 0.06, 0.0],\n            \"cuts\": [\n                {\"fixed_dim\": \"ky\", \"fixed_val\": np.pi / 6, \"var_dim\": \"kx\", \"n_points\": 41},\n                {\"fixed_dim\": \"kx\", \"fixed_val\": np.pi / 3, \"var_dim\": \"ky\", \"n_points\": 41},\n            ],\n            \"noise_sigma\": 0.002,\n            \"seed\": 3,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(case)\n        results.append(result)\n    \n    # Format the final output string exactly as required.\n    # Python's str(True) - \"True\", which matches the example.\n    output_parts = [f\"[{res[0]:.6f},{res[1]}]\" for res in results]\n    print(f\"[{','.join(output_parts)}]\")\n\n\ndef energy_model(k_vectors, params):\n    \"\"\"\n    Calculates energy E(k) based on the TB model.\n    k_vectors is an (N, 2) array of (kx, ky) pairs.\n    params is a list or array of [eps0, t1, t2, t3].\n    \"\"\"\n    kx, ky = k_vectors[:, 0], k_vectors[:, 1]\n    eps0, t1, t2, t3 = params\n    \n    E = (eps0\n         - 2 * t1 * (np.cos(kx) + np.cos(ky))\n         - 4 * t2 * np.cos(kx) * np.cos(ky)\n         - 2 * t3 * (np.cos(2 * kx) + np.cos(2 * ky)))\n    return E\n\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case: generates data, fits model, and evaluates.\n    \"\"\"\n    # 1. Generate k-points\n    all_k_vectors = []\n    for cut in case_data[\"cuts\"]:\n        var_coords = np.linspace(0, np.pi, cut[\"n_points\"])\n        if cut[\"var_dim\"] == \"kx\":\n            kx_coords = var_coords\n            ky_coords = np.full_like(kx_coords, cut[\"fixed_val\"])\n        else: # var_dim == \"ky\"\n            ky_coords = var_coords\n            kx_coords = np.full_like(ky_coords, cut[\"fixed_val\"])\n        all_k_vectors.append(np.stack((kx_coords, ky_coords), axis=1))\n    \n    k_vectors = np.concatenate(all_k_vectors, axis=0)\n    \n    # 2. Generate \"ab initio\" energy data with noise\n    E_true = energy_model(k_vectors, case_data[\"truth_params\"])\n    rng = np.random.default_rng(case_data[\"seed\"])\n    noise = rng.normal(loc=0.0, scale=case_data[\"noise_sigma\"], size=E_true.shape[0])\n    E_observed = E_true + noise\n    \n    # 3. Construct the design matrix\n    kx, ky = k_vectors[:, 0], k_vectors[:, 1]\n    N = k_vectors.shape[0]\n    \n    X0 = np.ones(N)  # Intercept for eps0\n    X1 = -2 * (np.cos(kx) + np.cos(ky))\n    X2 = -4 * np.cos(kx) * np.cos(ky)\n    X3 = -2 * (np.cos(2 * kx) + np.cos(2 * ky))\n    \n    A = np.stack([X0, X1, X2, X3], axis=1)\n\n    # 4. Perform linear least-squares fit\n    fitted_params, _, _, _ = np.linalg.lstsq(A, E_observed, rcond=None)\n    \n    # 5. Calculate RMSE\n    E_predicted = A @ fitted_params\n    rmse = np.sqrt(np.mean((E_observed - E_predicted)**2))\n    \n    # 6. Check physical plausibility\n    eps0_fit, t1_fit, t2_fit, t3_fit = fitted_params\n    \n    # Condition 1: Dominant nearest-neighbor hopping\n    if t1_fit == 0: # Avoid division by zero\n        plaus1 = max(abs(t2_fit), abs(t3_fit)) == 0\n    else:\n        plaus1 = max(abs(t2_fit), abs(t3_fit)) = 0.6 * abs(t1_fit)\n    \n    # Condition 2: Small onsite offset\n    plaus2 = abs(eps0_fit) = 0.1\n    \n    # Condition 3: Reasonable bandwidth\n    W_est = 8 * abs(t1_fit) + 16 * abs(t2_fit) + 8 * abs(t3_fit)\n    plaus3 = W_est = 3.0\n    \n    is_plausible = bool(plaus1 and plaus2 and plaus3)\n    \n    return [round(rmse, 6), is_plausible]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}