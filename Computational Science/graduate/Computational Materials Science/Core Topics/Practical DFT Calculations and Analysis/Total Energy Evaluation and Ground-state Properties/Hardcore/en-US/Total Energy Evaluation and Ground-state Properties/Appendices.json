{
    "hands_on_practices": [
        {
            "introduction": "The total energy calculated from first principles is the foundation upon which our understanding of material stability is built. To bridge the gap between this quantum mechanical quantity and experimental thermodynamics, we compute cohesive and formation energies. This practice will guide you through calculating these fundamental metrics, which determine a material's intrinsic stability and its likelihood of forming relative to competing phases or constituent elements . You will apply the core thermodynamic definitions at zero temperature to translate raw total energies into chemically intuitive quantities.",
            "id": "3498173",
            "problem": "You are given a set of zero-temperature, zero-pressure ground-state total energies from Density Functional Theory (DFT) calculations and isolated atomic references. From the foundational thermodynamic definitions at zero temperature and pressure, the ground-state total energy per system equals the internal energy, and the chemical potential of species $i$, denoted $\\mu_i$, represents the energy change to add one atom of species $i$ from its reservoir to the system. The cohesive energy of an elemental solid is the energy gained when isolated atoms bind into a crystal. The formation energy of a multicomponent crystal is the energy difference between the crystal and its constituent atoms held in external reservoirs characterized by chemical potentials. Your task is to implement a program that uses these principles to compute cohesive and formation energies for the parameter sets below.\n\nUse the following fundamental bases only:\n- At zero temperature and pressure, the ground-state total energy equals the internal energy and the enthalpy, so all energies can be taken directly from the provided ground-state totals.\n- The chemical potential of species $i$, denoted $\\mu_i$, represents the energy change to add one atom of species $i$ from its reservoir to the system.\n- For a cell containing an integer number of formula units, the ground-state total energy per formula unit equals the cell energy divided by the number of formula units.\n- For an elemental system, the cohesive energy per atom is the energy difference between the isolated atom and the atom in the crystal state.\n- For a compound $A_x B_y C_z$, the formation energy per formula unit is the difference between the compound’s ground-state energy per formula unit and the energy of $x$ atoms of $A$, $y$ atoms of $B$, and $z$ atoms of $C$ drawn from external reservoirs with specified chemical potentials.\n- Chemical potentials can be written as $\\mu_i = \\mu_i^{0} + \\Delta \\mu_i$, with $\\Delta \\mu_i \\le 0$ when referenced to the elemental ground states $\\mu_i^{0}$. When a compound is in equilibrium with the reservoirs at zero temperature and pressure, the compound’s ground-state energy per formula unit equals the appropriate sum over reservoir chemical potentials.\n\nAll answers must be expressed in electronvolts, with the cohesive energy reported in $\\mathrm{eV}$ per atom and each formation energy reported in $\\mathrm{eV}$ per formula unit. Round each reported float to three decimal places.\n\nImplement a program that computes the requested quantities for the following test suite. Each test produces a single float.\n\nTest suite:\n- Test $1$ (elemental cohesive energy per atom):\n  - A cubic elemental crystal contains $N = 8$ atoms per simulation cell with ground-state total energy $E_{\\mathrm{cell}} = -42.400\\,\\mathrm{eV}$. The isolated atomic reference has $E_{\\mathrm{atom}}^{\\mathrm{iso}} = -0.900\\,\\mathrm{eV}$. Compute the cohesive energy per atom in $\\mathrm{eV}$ per atom.\n- Test $2$ (binary formation energy per formula unit at elemental reservoirs):\n  - A binary compound $A B_2$ has a simulation cell containing $n_{\\mathrm{fu}} = 2$ formula units. The ground-state total energy of the cell is $E_{\\mathrm{cell}} = -36.000\\,\\mathrm{eV}$. The elemental reservoirs have $\\mu_A^{0} = -3.000\\,\\mathrm{eV}$ and $\\mu_B^{0} = -4.000\\,\\mathrm{eV}$. Compute the formation energy per formula unit in $\\mathrm{eV}$ per formula unit when the reservoirs are at the elemental limit, that is, when $\\mu_A = \\mu_A^{0}$ and $\\mu_B = \\mu_B^{0}$.\n- Test $3$ (binary formation energy per formula unit under a specified reservoir shift with equilibrium constraint):\n  - Consider the same $A B_2$ compound and cell as in Test $2$. Let the reservoir shifts be $\\Delta \\mu_B = -1.000\\,\\mathrm{eV}$ and an unknown $\\Delta \\mu_A$, with $\\mu_B = \\mu_B^{0} + \\Delta \\mu_B$ and $\\mu_A = \\mu_A^{0} + \\Delta \\mu_A$. Impose the thermodynamic equilibrium condition that the compound and the reservoirs share the same ground-state energy per formula unit at zero pressure, and use this to determine the unknown $\\Delta \\mu_A$. Then compute the formation energy per formula unit in $\\mathrm{eV}$ per formula unit for these reservoirs.\n- Test $4$ (ternary formation energy per formula unit with non-elemental reservoirs):\n  - A ternary compound $A_2 B C$ has $n_{\\mathrm{fu}} = 1$ formula unit in the simulation cell, with ground-state total energy $E_{\\mathrm{cell}} = -22.000\\,\\mathrm{eV}$. The elemental references are $\\mu_A^{0} = -3.000\\,\\mathrm{eV}$, $\\mu_B^{0} = -4.000\\,\\mathrm{eV}$, and $\\mu_C^{0} = -5.000\\,\\mathrm{eV}$. The reservoirs are specified by shifts $\\Delta \\mu_A = -1.000\\,\\mathrm{eV}$, $\\Delta \\mu_B = -0.500\\,\\mathrm{eV}$, and $\\Delta \\mu_C = 0.000\\,\\mathrm{eV}$ so that $\\mu_A = \\mu_A^{0} + \\Delta \\mu_A$, $\\mu_B = \\mu_B^{0} + \\Delta \\mu_B$, and $\\mu_C = \\mu_C^{0} + \\Delta \\mu_C$. Compute the formation energy per formula unit in $\\mathrm{eV}$ per formula unit.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$), where $r_k$ is the float result for Test $k$ rounded to three decimal places. The required output types are floats only, and the units are as specified above.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It provides a clear set of definitions and data based on fundamental principles of thermodynamics and solid-state physics as applied in computational materials science. All data are self-consistent and sufficient for deriving a unique solution for each test case.\n\nThe solution requires the application of standard definitions for cohesive energy and formation energy at zero temperature and pressure ($T=0\\,\\mathrm{K}$, $P=0\\,\\mathrm{Pa}$), where the ground-state total energy is equivalent to the internal energy and enthalpy.\n\nThe cohesive energy, $E_{\\text{coh}}$, of an elemental solid measures the energy gained by forming the crystal from isolated atoms. On a per-atom basis, it is defined as:\n$$E_{\\text{coh}} = E_{\\text{atom}}^{\\text{iso}} - E_{\\text{atom}}^{\\text{crystal}}$$\nwhere $E_{\\text{atom}}^{\\text{iso}}$ is the ground-state energy of an isolated atom and $E_{\\text{atom}}^{\\text{crystal}}$ is the ground-state energy per atom in the crystal.\n\nThe formation energy, $E_{\\text{form}}$, of a compound with formula unit $A_{n_A}B_{n_B}C_{n_C}\\dots$ quantifies its stability relative to a set of external reservoirs of its constituent elements. On a per-formula-unit basis, it is defined as:\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{\\text{cmpd}} - \\sum_i n_i \\mu_i$$\nwhere $E_{\\text{f.u.}}^{\\text{cmpd}}$ is the ground-state energy of the compound per formula unit, $n_i$ is the number of atoms of species $i$ in the formula unit, and $\\mu_i$ is the chemical potential of species $i$ in its respective reservoir. The chemical potential $\\mu_i$ is given by $\\mu_i = \\mu_i^0 + \\Delta\\mu_i$, where $\\mu_i^0$ is the energy per atom of the elemental ground state of species $i$, and $\\Delta\\mu_i \\leq 0$ is the chemical potential shift.\n\nWe will now apply these principles to each test case.\n\nTest $1$: Elemental cohesive energy per atom.\nThe problem provides the ground-state total energy of a simulation cell, $E_{\\mathrm{cell}} = -42.400\\,\\mathrm{eV}$, containing $N = 8$ atoms of an element. The energy per atom in the crystal is:\n$$E_{\\text{atom}}^{\\text{crystal}} = \\frac{E_{\\mathrm{cell}}}{N} = \\frac{-42.400\\,\\mathrm{eV}}{8} = -5.300\\,\\mathrm{eV}$$\nThe isolated atomic reference energy is given as $E_{\\mathrm{atom}}^{\\mathrm{iso}} = -0.900\\,\\mathrm{eV}$. The cohesive energy per atom is therefore:\n$$E_{\\text{coh}} = E_{\\mathrm{atom}}^{\\mathrm{iso}} - E_{\\text{atom}}^{\\text{crystal}} = (-0.900\\,\\mathrm{eV}) - (-5.300\\,\\mathrm{eV}) = 4.400\\,\\mathrm{eV}$$\n\nTest $2$: Binary formation energy per formula unit at elemental reservoirs.\nThe problem describes a binary compound $AB_2$ in a simulation cell with $n_{\\mathrm{fu}} = 2$ formula units and a total energy of $E_{\\mathrm{cell}} = -36.000\\,\\mathrm{eV}$. The energy per formula unit of the compound is:\n$$E_{\\text{f.u.}}^{AB_2} = \\frac{E_{\\mathrm{cell}}}{n_{\\mathrm{fu}}} = \\frac{-36.000\\,\\mathrm{eV}}{2} = -18.000\\,\\mathrm{eV}$$\nThe reservoirs are at the elemental limit, meaning $\\Delta\\mu_A=0$ and $\\Delta\\mu_B=0$. The chemical potentials are thus $\\mu_A = \\mu_A^0 = -3.000\\,\\mathrm{eV}$ and $\\mu_B = \\mu_B^0 = -4.000\\,\\mathrm{eV}$. The formation energy per formula unit is calculated for the stoichiometry $A_1 B_2$:\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{AB_2} - (1 \\cdot \\mu_A + 2 \\cdot \\mu_B)$$\n$$E_{\\text{form}} = -18.000\\,\\mathrm{eV} - (1 \\cdot (-3.000\\,\\mathrm{eV}) + 2 \\cdot (-4.000\\,\\mathrm{eV}))$$\n$$E_{\\text{form}} = -18.000\\,\\mathrm{eV} - (-3.000\\,\\mathrm{eV} - 8.000\\,\\mathrm{eV}) = -18.000\\,\\mathrm{eV} - (-11.000\\,\\mathrm{eV}) = -7.000\\,\\mathrm{eV}$$\n\nTest $3$: Binary formation energy per formula unit with an equilibrium constraint.\nThis test uses the same compound $AB_2$ as Test $2$, so $E_{\\text{f.u.}}^{AB_2} = -18.000\\,\\mathrm{eV}$. The problem imposes the thermodynamic equilibrium condition, which states that the compound's ground-state energy per formula unit is equal to the summed chemical potentials of its constituents in the reservoir:\n$$E_{\\text{f.u.}}^{AB_2} = 1 \\cdot \\mu_A + 2 \\cdot \\mu_B$$\nThe formation energy is, by definition, calculated with respect to these same reservoir chemical potentials:\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{AB_2} - (1 \\cdot \\mu_A + 2 \\cdot \\mu_B)$$\nSubstituting the equilibrium condition into the definition for formation energy yields:\n$$E_{\\text{form}} = (1 \\cdot \\mu_A + 2 \\cdot \\mu_B) - (1 \\cdot \\mu_A + 2 \\cdot \\mu_B) = 0.000\\,\\mathrm{eV}$$\nThis result is a direct consequence of the definitions. A compound in equilibrium with a set of reservoirs has, by definition, zero formation energy with respect to those reservoirs. The specific values of the chemical potential shifts ($\\Delta \\mu_B = -1.000\\,\\mathrm{eV}$ and the resulting $\\Delta \\mu_A = -5.000\\,\\mathrm{eV}$) are used to establish the reservoir conditions, but the formation energy under these equilibrium conditions is tautologically zero.\n\nTest $4$: Ternary formation energy per formula unit.\nThe problem considers a ternary compound $A_2 B C$ with $n_{\\mathrm{fu}} = 1$ formula unit in the cell and a total energy $E_{\\mathrm{cell}} = -22.000\\,\\mathrm{eV}$. The energy per formula unit is thus $E_{\\text{f.u.}}^{A_2BC} = E_{\\mathrm{cell}} / n_{\\mathrm{fu}} = -22.000\\,\\mathrm{eV}$. The reservoir chemical potentials are specified by shifts from their elemental references:\n$$\\mu_A = \\mu_A^0 + \\Delta\\mu_A = -3.000\\,\\mathrm{eV} + (-1.000\\,\\mathrm{eV}) = -4.000\\,\\mathrm{eV}$$\n$$\\mu_B = \\mu_B^0 + \\Delta\\mu_B = -4.000\\,\\mathrm{eV} + (-0.500\\,\\mathrm{eV}) = -4.500\\,\\mathrm{eV}$$\n$$\\mu_C = \\mu_C^0 + \\Delta\\mu_C = -5.000\\,\\mathrm{eV} + 0.000\\,\\mathrm{eV} = -5.000\\,\\mathrm{eV}$$\nThe formation energy for the stoichiometry $A_2 B_1 C_1$ is:\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{A_2BC} - (2 \\cdot \\mu_A + 1 \\cdot \\mu_B + 1 \\cdot \\mu_C)$$\n$$E_{\\text{form}} = -22.000\\,\\mathrm{eV} - (2 \\cdot (-4.000\\,\\mathrm{eV}) + 1 \\cdot (-4.500\\,\\mathrm{eV}) + 1 \\cdot (-5.000\\,\\mathrm{eV}))$$\n$$E_{\\text{form}} = -22.000\\,\\mathrm{eV} - (-8.000\\,\\mathrm{eV} - 4.500\\,\\mathrm{eV} - 5.000\\,\\mathrm{eV})$$\n$$E_{\\text{form}} = -22.000\\,\\mathrm{eV} - (-17.500\\,\\mathrm{eV}) = -4.500\\,\\mathrm{eV}$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are necessary.\n\ndef solve():\n    \"\"\"\n    Computes cohesive and formation energies based on provided DFT total energies and chemical potentials.\n    \"\"\"\n\n    # --- Test 1: Elemental cohesive energy per atom ---\n    # Given data for an elemental crystal.\n    E_cell_1 = -42.400  # eV\n    N_1 = 8             # atoms\n    E_atom_iso_1 = -0.900 # eV\n\n    # Cohesive energy is the energy of the isolated atom minus the energy per atom in the crystal.\n    E_atom_crystal_1 = E_cell_1 / N_1\n    r1 = E_atom_iso_1 - E_atom_crystal_1\n\n    # --- Test 2: Binary formation energy at elemental reservoirs ---\n    # Given data for a binary compound AB2.\n    E_cell_2 = -36.000  # eV\n    n_fu_2 = 2          # formula units\n    mu_A0_2 = -3.000    # eV\n    mu_B0_2 = -4.000    # eV\n\n    # Energy per formula unit of the compound.\n    E_fu_2 = E_cell_2 / n_fu_2\n    # Reservoirs are at the elemental limit.\n    mu_A_2 = mu_A0_2\n    mu_B_2 = mu_B0_2\n    # Stoichiometry of AB2 is x=1, y=2.\n    x_2, y_2 = 1, 2\n    # Formation energy is the compound's energy minus the weighted sum of reservoir chemical potentials.\n    r2 = E_fu_2 - (x_2 * mu_A_2 + y_2 * mu_B_2)\n\n    # --- Test 3: Binary formation energy under equilibrium ---\n    # Same compound as Test 2. The equilibrium condition dictates that the compound's\n    # energy per formula unit equals the summed chemical potentials of the components.\n    # E_fu = x*mu_A + y*mu_B\n    # The formation energy is defined as E_form = E_fu - (x*mu_A + y*mu_B).\n    # Under equilibrium, these two quantities are equal, so their difference is zero.\n    r3 = 0.0\n\n    # --- Test 4: Ternary formation energy with non-elemental reservoirs ---\n    # Given data for a ternary compound A2BC.\n    E_cell_4 = -22.000  # eV\n    n_fu_4 = 1          # formula unit\n    mu_A0_4 = -3.000    # eV\n    mu_B0_4 = -4.000    # eV\n    mu_C0_4 = -5.000    # eV\n    delta_mu_A_4 = -1.000 # eV\n    delta_mu_B_4 = -0.500 # eV\n    delta_mu_C_4 = 0.000  # eV\n\n    # Energy per formula unit of the compound.\n    E_fu_4 = E_cell_4 / n_fu_4\n    # Calculate absolute chemical potentials from the given shifts.\n    mu_A_4 = mu_A0_4 + delta_mu_A_4\n    mu_B_4 = mu_B0_4 + delta_mu_B_4\n    mu_C_4 = mu_C0_4 + delta_mu_C_4\n    # Stoichiometry of A2BC is x=2, y=1, z=1.\n    x_4, y_4, z_4 = 2, 1, 1\n    # Calculate formation energy.\n    r4 = E_fu_4 - (x_4 * mu_A_4 + y_4 * mu_B_4 + z_4 * mu_C_4)\n\n    # Collect all results.\n    results = [r1, r2, r3, r4]\n\n    # Format the final output string as a comma-separated list of floats\n    # rounded to three decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond static stability, the response of a material to external stimuli is critical to its function. By examining the curvature of the total energy landscape with respect to lattice strain, we can extract the elastic constants, which quantify a material's stiffness. This exercise demonstrates how to calculate the shear elastic constant $C_{44}$ for a cubic crystal using a symmetry-adapted strain and introduces a vital aspect of computational rigor: identifying and correcting for numerical artifacts such as the Pulay error arising from basis-set incompleteness . You will learn to extrapolate your results to the infinite basis-set limit to obtain a physically accurate value.",
            "id": "3498179",
            "problem": "Consider a cubic crystal at zero external stress. The total energy as a function of a small homogeneous strain tensor $\\boldsymbol{\\epsilon}$ admits the quadratic expansion\n$$\nE(\\boldsymbol{\\epsilon}) = E_0 + \\frac{1}{2} V_0 \\sum_{i,j,k,l} C_{ijkl}\\,\\epsilon_{ij}\\,\\epsilon_{kl} + \\mathcal{O}\\!\\left(\\|\\boldsymbol{\\epsilon}\\|^3\\right),\n$$\nwhere $E_0$ is the unstrained energy, $V_0$ is the equilibrium volume, and $C_{ijkl}$ are the elastic stiffnesses. In Voigt notation, for a cubic material, the independent elastic constants are $C_{11}$, $C_{12}$, and $C_{44}$. Use symmetry-adapted strains to isolate specific elastic constants. In particular, use the pure shear pattern in the $xy$-plane with engineering shear $\\gamma$, defined by the symmetric tensor $\\epsilon_{xy} = \\epsilon_{yx} = \\gamma/2$ and all other components zero.\n\nTo study the influence of basis-set incompleteness (Pulay error) on the curvature-extracted elastic constants, consider a synthetic, but physically consistent, energy oracle that returns a total energy (per unit cell) $E(\\boldsymbol{\\epsilon}; E_{\\text{cut}})$ at a chosen plane-wave cutoff energy $E_{\\text{cut}}$. The oracle is constructed from three pieces:\n1. A harmonic elastic energy density $U_{\\text{harm}}$ constructed from the true elastic constants,\n2. A Pulay-error energy density $U_{\\text{Pulay}}$ that scales inversely with $E_{\\text{cut}}$ and is quadratic in strain,\n3. A small quartic shear anharmonicity $U_{\\text{anh}}$ that is independent of $E_{\\text{cut}}$ and regularizes step-size effects.\n\nAll energies are in electronvolts, volumes in cubic ångström, strains are dimensionless, and elastic constants in gigapascal. Let the conversion constant be $\\kappa = 160.21766208$ gigapascal per $(\\text{electronvolt}/\\text{Å}^3)$. The oracle is\n$$\nE(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = E_0 + V_0 \\left[ U_{\\text{harm}}(\\boldsymbol{\\epsilon}) + U_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) + U_{\\text{anh}}(\\boldsymbol{\\epsilon}) \\right],\n$$\nwith\n$$\nU_{\\text{harm}}(\\boldsymbol{\\epsilon}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} C_{11} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) + C_{12} \\left(\\epsilon_{xx}\\epsilon_{yy} + \\epsilon_{yy}\\epsilon_{zz} + \\epsilon_{zz}\\epsilon_{xx} \\right) + 2 C_{44} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) \\right),\n$$\n$$\nU_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} \\frac{K_{\\text{vol}}}{E_{\\text{cut}}} (\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz})^2 + 2 \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) + \\frac{1}{2} \\frac{K_{\\text{diag}}}{E_{\\text{cut}}} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) \\right),\n$$\n$$\nU_{\\text{anh}}(\\boldsymbol{\\epsilon}) = \\frac{1}{4} H_{\\text{sh}} \\left( (2\\epsilon_{xy})^4 + (2\\epsilon_{yz})^4 + (2\\epsilon_{xz})^4 \\right).\n$$\nThe constants to be used are\n- $E_0 = -10.0$ electronvolt,\n- $V_0 = 15.0$ $\\text{Å}^3$,\n- $C_{11} = 250.0$ gigapascal,\n- $C_{12} = 150.0$ gigapascal,\n- $C_{44} = 120.0$ gigapascal,\n- $K_{\\text{vol}} = 1000.0$ gigapascal$\\cdot$electronvolt,\n- $K_{\\text{sh}} = 7200.0$ gigapascal$\\cdot$electronvolt,\n- $K_{\\text{diag}} = 500.0$ gigapascal$\\cdot$electronvolt,\n- $H_{\\text{sh}} = 0.02$ electronvolt/Å$^3$,\n- $\\kappa = 160.21766208$ gigapascal per (electronvolt/Å$^3$).\n\nYour task is to write a complete program that:\n- Implements the oracle $E(\\boldsymbol{\\epsilon}; E_{\\text{cut}})$ using the constants above.\n- Uses the symmetry-adapted pure shear pattern described above with engineering shear $\\gamma$ to numerically estimate the curvature $\\partial^2 E / \\partial \\gamma^2$ at $\\gamma = 0$ by the three-point central difference formula with step $\\Delta \\gamma$:\n$$\n\\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0} \\approx \\frac{E(\\gamma=+\\Delta \\gamma; E_{\\text{cut}}) - 2 E(\\gamma=0; E_{\\text{cut}}) + E(\\gamma=-\\Delta \\gamma; E_{\\text{cut}})}{(\\Delta \\gamma)^2}.\n$$\n- Converts the curvature into an estimate of $C_{44}$ in gigapascal using the volume $V_0$ and the conversion constant $\\kappa$.\n\nThe conversion to $C_{44}$ in gigapascal must be derived from first principles in your solution, but your program must implement the final expression.\n\nTest suite and required output:\n- Use the three cutoff energies $E_{\\text{cut}} \\in \\{300.0, 600.0, 1200.0\\}$ electronvolt with $\\Delta \\gamma = 0.02$ to produce three estimates of $C_{44}$.\n- Perform a linear least-squares fit of the three estimates versus $1/E_{\\text{cut}}$ to the model $C_{44}(E_{\\text{cut}}) = C_{44}^{(\\infty)} + A \\cdot (1/E_{\\text{cut}})$, and report the extrapolated $C_{44}^{(\\infty)}$.\n- Additionally, compute the estimate at $E_{\\text{cut}} = 300.0$ electronvolt with a larger step $\\Delta \\gamma = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$$\n\\left[ C_{44}(300.0,\\Delta\\gamma=0.02),\\; C_{44}(600.0,\\Delta\\gamma=0.02),\\; C_{44}(1200.0,\\Delta\\gamma=0.02),\\; C_{44}^{(\\infty)}\\ \\text{from fit},\\; C_{44}(300.0,\\Delta\\gamma=0.05) \\right],\n$$\nwith each entry expressed in gigapascal, rounded to $6$ decimal places, with no additional text. Angles are not involved. Physical units are required exactly as specified. All numerical values in the output must be floating-point numbers.\n\nScientific realism requirement: Ensure that your implementation respects the definitions above, uses the specified constants, and faithfully applies the symmetry-adapted strain. No external data is permitted; the oracle must be implemented directly from the formulas given here. The program must be self-contained and require no input.",
            "solution": "The problem is scientifically and mathematically well-posed and self-contained. All necessary constants, physical models, and numerical procedures are provided, allowing for a unique and verifiable solution. We will proceed with the derivation and implementation.\n\nThe primary objective is to determine the elastic constant $C_{44}$ by analyzing the total energy response of a cubic crystal to a specific shear strain. We are given an energy oracle, $E(\\boldsymbol{\\epsilon}; E_{\\text{cut}})$, that models the total energy as a function of the strain tensor $\\boldsymbol{\\epsilon}$ and a computational parameter, the plane-wave cutoff energy $E_{\\text{cut}}$. This oracle includes harmonic, Pulay error, and anharmonic contributions.\n\nFirst, we derive the relationship between the energy and the elastic constant $C_{44}$ under the specified strain. The problem prescribes a pure shear deformation in the $xy$-plane, defined by an engineering shear strain $\\gamma$. The corresponding symmetric strain tensor $\\boldsymbol{\\epsilon}$ has components $\\epsilon_{xy} = \\epsilon_{yx} = \\gamma/2$, with all other components $\\epsilon_{ij}$ being zero.\n\nWe substitute this specific strain tensor into the given energy oracle components:\n$E(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = E_0 + V_0 \\left[ U_{\\text{harm}}(\\boldsymbol{\\epsilon}) + U_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) + U_{\\text{anh}}(\\boldsymbol{\\epsilon}) \\right]$.\n\n1.  **Harmonic Term $U_{\\text{harm}}$**:\n    The general form is $U_{\\text{harm}}(\\boldsymbol{\\epsilon}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} C_{11} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) + C_{12} \\left(\\epsilon_{xx}\\epsilon_{yy} + \\epsilon_{yy}\\epsilon_{zz} + \\epsilon_{zz}\\epsilon_{xx} \\right) + 2 C_{44} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) \\right)$.\n    For our strain, only $\\epsilon_{xy}$ is non-zero. The expression simplifies to:\n    $$\n    U_{\\text{harm}}(\\gamma) = \\frac{1}{\\kappa} \\left( 2 C_{44} \\epsilon_{xy}^2 \\right) = \\frac{2 C_{44}}{\\kappa} \\left(\\frac{\\gamma}{2}\\right)^2 = \\frac{C_{44}}{2\\kappa} \\gamma^2.\n    $$\n\n2.  **Pulay Error Term $U_{\\text{Pulay}}$**:\n    The general form is $U_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} \\frac{K_{\\text{vol}}}{E_{\\text{cut}}} (\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz})^2 + 2 \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) + \\frac{1}{2} \\frac{K_{\\text{diag}}}{E_{\\text{cut}}} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) \\right)$.\n    Again, only the term involving $\\epsilon_{xy}^2$ survives:\n    $$\n    U_{\\text{Pulay}}(\\gamma; E_{\\text{cut}}) = \\frac{1}{\\kappa} \\left( 2 \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} \\epsilon_{xy}^2 \\right) = \\frac{2 K_{\\text{sh}}}{\\kappa E_{\\text{cut}}} \\left(\\frac{\\gamma}{2}\\right)^2 = \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\gamma^2.\n    $$\n\n3.  **Anharmonic Term $U_{\\text{anh}}$**:\n    The general form is $U_{\\text{anh}}(\\boldsymbol{\\epsilon}) = \\frac{1}{4} H_{\\text{sh}} \\left( (2\\epsilon_{xy})^4 + (2\\epsilon_{yz})^4 + (2\\epsilon_{xz})^4 \\right)$.\n    This simplifies to:\n    $$\n    U_{\\text{anh}}(\\gamma) = \\frac{1}{4} H_{\\text{sh}} \\left( 2 \\frac{\\gamma}{2} \\right)^4 = \\frac{H_{\\text{sh}}}{4} \\gamma^4.\n    $$\n\nCombining these terms, the total energy as a function of the engineering shear $\\gamma$ is:\n$$\nE(\\gamma; E_{\\text{cut}}) = E_0 + V_0 \\left[ \\left( \\frac{C_{44}}{2\\kappa} + \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\right) \\gamma^2 + \\frac{H_{\\text{sh}}}{4} \\gamma^4 \\right].\n$$\nFrom the definition of elastic constants, the energy per unit volume has a quadratic term $\\frac{1}{2}C_{44}\\gamma^2$ for this shear. Therefore, the second derivative of the total energy with respect to $\\gamma$ evaluated at $\\gamma=0$ is related to $C_{44}$:\n$$\n\\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0} = V_0 \\left( \\frac{C_{44}}{\\kappa} + \\frac{K_{\\text{sh}}}{\\kappa E_{\\text{cut}}} \\right).\n$$\nRearranging this gives a way to find an effective elastic constant from the energy curvature:\n$$\nC_{44} + \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} = \\frac{\\kappa}{V_0} \\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0}.\n$$\nThe problem requires a numerical estimate of this second derivative using the three-point central difference formula with a step size $\\Delta\\gamma$:\n$$\n\\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0} \\approx \\frac{E(+\\Delta \\gamma; E_{\\text{cut}}) - 2 E(0; E_{\\text{cut}}) + E(-\\Delta \\gamma; E_{\\text{cut}})}{(\\Delta \\gamma)^2}.\n$$\nLet's analyze the numerator. Note that $E(\\gamma)$ depends only on even powers of $\\gamma$, so $E(+\\Delta\\gamma) = E(-\\Delta\\gamma)$. Also, $E(0; E_{\\text{cut}}) = E_0$.\n$$\nE(\\Delta\\gamma) - 2 E_0 + E(\\Delta\\gamma) = 2(E(\\Delta\\gamma) - E_0) = 2 V_0 \\left[ \\left( \\frac{C_{44}}{2\\kappa} + \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\right) (\\Delta\\gamma)^2 + \\frac{H_{\\text{sh}}}{4} (\\Delta\\gamma)^4 \\right].\n$$\nThe numerical second derivative is then:\n$$\n\\left( \\frac{\\partial^2 E}{\\partial \\gamma^2} \\right)_{\\text{num}} = \\frac{2 V_0 \\left[ \\left( \\frac{C_{44}}{2\\kappa} + \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\right) (\\Delta\\gamma)^2 + \\frac{H_{\\text{sh}}}{4} (\\Delta\\gamma)^4 \\right]}{(\\Delta\\gamma)^2} = \\frac{V_0}{\\kappa}\\left(C_{44} + \\frac{K_{\\text{sh}}}{E_{\\text{cut}}}\\right) + \\frac{V_0 H_{\\text{sh}}}{2} (\\Delta\\gamma)^2.\n$$\nThe numerically estimated elastic constant, which we denote as $C_{44}^{\\text{est}}$, is obtained by multiplying this numerical curvature by $\\kappa/V_0$:\n$$\nC_{44}^{\\text{est}}(E_{\\text{cut}}, \\Delta\\gamma) = \\frac{\\kappa}{V_0} \\left( \\frac{\\partial^2 E}{\\partial \\gamma^2} \\right)_{\\text{num}} = \\left(C_{44} + \\frac{K_{\\text{sh}}}{E_{\\text{cut}}}\\right) + \\frac{\\kappa H_{\\text{sh}}}{2} (\\Delta\\gamma)^2.\n$$\nThis equation shows that the estimated constant has two sources of error compared to the true value $C_{44}$: a Pulay error term proportional to $1/E_{\\text{cut}}$, and a finite-difference truncation error proportional to $(\\Delta\\gamma)^2$.\n\nThe task requires a linear least-squares fit of $C_{44}^{\\text{est}}$ versus $1/E_{\\text{cut}}$ for a fixed $\\Delta\\gamma$. Our derived expression for $C_{44}^{\\text{est}}$ is in the form of a linear equation $y = m x + b$:\n$$\nC_{44}^{\\text{est}} = K_{\\text{sh}} \\cdot \\left(\\frac{1}{E_{\\text{cut}}}\\right) + \\left(C_{44} + \\frac{\\kappa H_{\\text{sh}}}{2} (\\Delta\\gamma)^2\\right),\n$$\nwhere $y = C_{44}^{\\text{est}}$, $x = 1/E_{\\text{cut}}$, the slope $m=K_{\\text{sh}}$, and the y-intercept $b = C_{44} + \\frac{\\kappa H_{\\text{sh}}}{2} (\\Delta\\gamma)^2$. The extrapolated value at infinite cutoff energy, $C_{44}^{(\\infty)}$, is the y-intercept $b$ of this fit.\n\nThe algorithm is as follows:\n1.  Implement a function `energy_oracle(gamma, e_cut)` based on the simplified energy expression $E(\\gamma; E_{\\text{cut}})$.\n2.  Implement a function `calculate_C44_est(e_cut, delta_gamma)` that computes the three energy points $E(+\\Delta\\gamma)$, $E(0)$, and $E(-\\Delta\\gamma)$, applies the central difference formula to get the curvature, and converts it to $C_{44}^{\\text{est}}$ using the factor $\\kappa/V_0$.\n3.  Calculate the three estimates $C_{44}^{\\text{est}}(300, 0.02)$, $C_{44}^{\\text{est}}(600, 0.02)$, and $C_{44}^{\\text{est}}(1200, 0.02)$.\n4.  Perform a linear least-squares fit on the points $(1/300, C_{44}^{\\text{est}}(300, 0.02))$, $(1/600, C_{44}^{\\text{est}}(600, 0.02))$, and $(1/1200, C_{44}^{\\text{est}}(1200, 0.02))$. The intercept of this fit is $C_{44}^{(\\infty)}$.\n5.  Calculate the final required value, $C_{44}^{\\text{est}}(300, 0.05)$.\n6.  Assemble the five results and print them in the specified format. The `numpy.polyfit` function will be used for the linear regression.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# No other libraries are needed or permitted.\n\ndef solve():\n    \"\"\"\n    Solves the computational materials science problem as described.\n    1. Implements the energy oracle for a specific shear strain.\n    2. Uses a numerical derivative to estimate the C44 elastic constant.\n    3. Performs a series of calculations and a linear extrapolation.\n    \"\"\"\n    \n    # Define the physical constants from the problem statement.\n    E0 = -10.0  # unstrained energy in eV\n    V0 = 15.0  # equilibrium volume in A^3\n    C44_true = 120.0  # true C44 in GPa\n    K_sh = 7200.0  # Pulay error shear constant in GPa*eV\n    H_sh = 0.02  # Anharmonic shear constant in eV/A^3\n    kappa = 160.21766208  # conversion constant GPa / (eV/A^3)\n\n    def energy_oracle(gamma, e_cut):\n        \"\"\"\n        Calculates the total energy for a given engineering shear strain gamma\n        and plane-wave cutoff energy e_cut.\n        The general formula is simplified for the specific shear strain.\n        \"\"\"\n        # For shear strain, epsilon_xy = gamma/2.\n        # U_harm = (1/kappa) * (2 * C44_true * (gamma/2)**2)\n        # U_pulay = (1/kappa) * (2 * K_sh/e_cut * (gamma/2)**2)\n        # U_anh = (1/4) * H_sh * gamma**4\n        # Total energy E = E0 + V0 * (U_harm + U_pulay + U_anh)\n        \n        # Combining terms for efficiency:\n        gamma_sq = gamma**2\n        \n        energy_density_quadratic = (C44_true / (2.0 * kappa) + K_sh / (2.0 * kappa * e_cut)) * gamma_sq\n        energy_density_quartic = (H_sh / 4.0) * gamma**4\n        \n        total_energy = E0 + V0 * (energy_density_quadratic + energy_density_quartic)\n        \n        return total_energy\n\n    def calculate_c44_est(e_cut, delta_gamma):\n        \"\"\"\n        Numerically estimates C44 using the three-point central difference formula.\n        \"\"\"\n        # Calculate energy at the three required points\n        e_plus = energy_oracle(delta_gamma, e_cut)\n        e_zero = energy_oracle(0.0, e_cut)\n        # Due to symmetry (even powers of gamma), e_minus = e_plus\n        e_minus = e_plus\n\n        # Calculate the second derivative (curvature) numerically\n        curvature = (e_plus - 2.0 * e_zero + e_minus) / (delta_gamma**2)\n\n        # Convert curvature to the estimated C44 in GPa\n        c44_estimated = curvature * kappa / V0\n        \n        return c44_estimated\n\n    # Define the test cases from the problem statement.\n    e_cuts_for_fit = [300.0, 600.0, 1200.0]\n    delta_gamma_for_fit = 0.02\n    \n    # Calculate the three C44 estimates for the fit\n    c44_fit_values = [calculate_c44_est(ec, delta_gamma_for_fit) for ec in e_cuts_for_fit]\n    \n    # Perform the linear least-squares fit\n    # Model: C44_est = C44_inf + A * (1/E_cut)\n    # x-values are 1/E_cut, y-values are the calculated C44 estimates\n    x_fit = 1.0 / np.array(e_cuts_for_fit)\n    y_fit = np.array(c44_fit_values)\n    \n    # np.polyfit(x, y, 1) returns [slope, intercept] for a linear fit\n    # The extrapolated C44 at infinite cutoff is the intercept\n    slope, c44_extrapolated = np.polyfit(x_fit, y_fit, 1)\n\n    # Calculate the additional test case\n    e_cut_final = 300.0\n    delta_gamma_final = 0.05\n    c44_final_case = calculate_c44_est(e_cut_final, delta_gamma_final)\n    \n    # Assemble the final list of results in the required order\n    results = [\n        c44_fit_values[0],\n        c44_fit_values[1],\n        c44_fit_values[2],\n        c44_extrapolated,\n        c44_final_case\n    ]\n\n    # Format the final output string exactly as specified\n    # Each value rounded to 6 decimal places.\n    output_string = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Real materials are finite and have surfaces, which often govern their reactivity and electronic properties. This practice moves from the perfect bulk to the more complex slab models used to simulate crystalline surfaces. A key challenge in such simulations is the presence of spurious electrostatic interactions between periodic images of the slab, especially for polar surfaces. You will learn to derive and apply a dipole correction to the total energy and perform the necessary convergence studies with respect to slab thickness and vacuum spacing to extract a reliable surface energy, a measure of the energy cost to create a surface .",
            "id": "3498188",
            "problem": "A repeated-slab model of a crystalline surface is simulated using ground-state total energies from Kohn–Sham density functional theory. The slab comprises $N$ atomic layers and is separated by a vacuum thickness $L_z$ along the surface normal. When placed in three-dimensional periodic boundary conditions, a slab with a nonzero out-of-plane dipole moment $p_z$ experiences spurious electrostatic interactions between its periodic images. These interactions alter the total energy of the slab and must be corrected to recover the intrinsic surface energetics. Starting from the thermodynamic definition of excess energy for creating two surfaces and classical electrostatics for a periodically repeated dipole sheet, derive a physically consistent expression for the surface free energy per unit area in terms of the slab total energy, the bulk reference energy per atomic layer, the surface area, and an electrostatic dipole correction, and explain the asymptotic thickness dependence as $N \\to \\infty$. Then implement a numerical procedure that (i) applies the appropriate dipole correction to each slab total energy, (ii) evaluates the surface energy per unit area for each slab thickness, and (iii) extracts the semi-infinite-thickness limit by fitting the thickness dependence of the surface energy to a rational asymptotic form motivated by physical finite-size effects.\n\nYour program must:\n- Use the following constants in atomic units and International System of Units conversions: the Bohr radius $a_0 = 5.29177210903\\times 10^{-11}\\ \\text{m}$ and the Hartree energy $E_{\\text{H}} = 4.3597447222071\\times 10^{-18}\\ \\text{J}$.\n- Treat all slab total energies, bulk reference energies, and dipole corrections in Hartree. Convert energies per area to Joule per square meter at the end using $E_{\\text{H}}$ and $a_0$.\n- Assume that the spurious electrostatic interaction energy for a repeated slab with a net dipole $p_z$ along the surface normal scales inversely with the vacuum length $L_z$ and the surface area $A$ in atomic units, consistent with classical electrostatics of periodic dipole arrays. You must incorporate this correction explicitly and justify its functional form in your derivation.\n\nData generation and evaluation protocol:\n- For each test case, construct synthetic slab total energies in Hartree by combining a bulk term proportional to $N$, a constant two-surface excess term proportional to the surface area, a finite-thickness interaction term that decays with $N$, the dipole interaction term, and, for one edge case, a residual term that decays with $L_z^2$ representing higher-order multipole interactions not captured by the leading dipole correction. All quantities are specified below. After computing the synthetic measured slab energies, apply the dipole correction and then evaluate the corrected surface energies.\n- Fit the thickness dependence of the corrected surface energy for each test case to the model $y = a + b x$ with $x = 1/N$, where $a$ represents the semi-infinite-thickness surface energy per unit area. Report $a$ in $\\text{J}/\\text{m}^2$.\n- Assess vacuum convergence by computing, for fixed $N$, the spread of corrected surface energies across all specified $L_z$ values; declare convergence if the maximum spread over all $N$ does not exceed a tolerance of $10^{-2}\\ \\text{J}/\\text{m}^2$.\n\nTest suite:\n- Test case $1$ (happy path):\n    - Surface area $A = 75.0$ in $a_0^2$.\n    - Bulk energy per atomic layer $E_{\\text{bulk}} = -5.0$ in Hartree.\n    - Dipole moment $p_z = 1.0$ in $e\\cdot a_0$.\n    - Slab thicknesses $N \\in \\{4,6,8,10,12\\}$.\n    - Vacuum lengths $L_z \\in \\{60.0,80.0,100.0\\}$ in $a_0$.\n    - True semi-infinite surface energy parameter used for synthetic data generation $\\gamma_{\\infty} = 1.2$ in $\\text{J}/\\text{m}^2$.\n    - Finite-thickness coefficient $b = 0.3$ in $\\text{J}/\\text{m}^2$.\n    - Residual higher-order interaction coefficient $c_{\\text{res}} = 0.0$ in Hartree$\\cdot a_0^2$.\n- Test case $2$ (stronger dipole, still convergent after correction):\n    - Surface area $A = 120.0$ in $a_0^2$.\n    - Bulk energy per atomic layer $E_{\\text{bulk}} = -8.3$ in Hartree.\n    - Dipole moment $p_z = 3.0$ in $e\\cdot a_0$.\n    - Slab thicknesses $N \\in \\{5,7,9,11,13\\}$.\n    - Vacuum lengths $L_z \\in \\{70.0,100.0,140.0\\}$ in $a_0$.\n    - True semi-infinite surface energy parameter used for synthetic data generation $\\gamma_{\\infty} = 2.0$ in $\\text{J}/\\text{m}^2$.\n    - Finite-thickness coefficient $b = 0.25$ in $\\text{J}/\\text{m}^2$.\n    - Residual higher-order interaction coefficient $c_{\\text{res}} = 0.0$ in Hartree$\\cdot a_0^2$.\n- Test case $3$ (edge case with insufficient vacuum and residual higher-order interactions):\n    - Surface area $A = 60.0$ in $a_0^2$.\n    - Bulk energy per atomic layer $E_{\\text{bulk}} = -3.5$ in Hartree.\n    - Dipole moment $p_z = 3.0$ in $e\\cdot a_0$.\n    - Slab thicknesses $N \\in \\{3,4,5,6\\}$.\n    - Vacuum lengths $L_z \\in \\{30.0,40.0,50.0\\}$ in $a_0$.\n    - True semi-infinite surface energy parameter used for synthetic data generation $\\gamma_{\\infty} = 0.8$ in $\\text{J}/\\text{m}^2$.\n    - Finite-thickness coefficient $b = 0.5$ in $\\text{J}/\\text{m}^2$.\n    - Residual higher-order interaction coefficient $c_{\\text{res}} = 6.0$ in Hartree$\\cdot a_0^2$.\n\nSynthetic measured slab energies for each $(N,L_z)$ are to be constructed in Hartree as follows:\n- Compute the two-surface excess energy from the specified $\\gamma_{\\infty}$ as an energy in Hartree using the conversion from $\\text{J}/\\text{m}^2$ to Hartree via $E_{\\text{H}}$ and $a_0$.\n- Add a finite-thickness interaction term that decays like $1/N$ and is proportional to the surface area.\n- Add the dipole interaction term that scales inversely with $A L_z$ in atomic units.\n- Add the residual term proportional to $1/L_z^2$ in Hartree for the edge case only.\n- Sum all contributions with the bulk term $N E_{\\text{bulk}}$.\n\nYour program must implement the complete pipeline above, compute the corrected surface energies, perform the fit for each test case using the largest $L_z$ in that case, and output the semi-infinite surface energy estimate and the root-mean-square fit error in $\\text{J}/\\text{m}^2$, along with a boolean indicating whether the vacuum convergence criterion is met.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\gamma_1,\\text{conv}_1,\\text{rmse}_1,\\gamma_2,\\text{conv}_2,\\text{rmse}_2,\\gamma_3,\\text{conv}_3,\\text{rmse}_3]$, where each $\\gamma_i$ and $\\text{rmse}_i$ is rounded to $6$ decimal places in $\\text{J}/\\text{m}^2$ and each $\\text{conv}_i$ is a boolean.",
            "solution": "The problem requires the derivation of a physically consistent expression for the surface free energy of a crystalline slab from total energy calculations and the implementation of a numerical procedure to extract this quantity from synthetic data. The process involves correcting for spurious electrostatic interactions inherent in simulations using periodic boundary conditions.\n\n### Step 1: Theoretical Derivation and Physical Principles\n\nThe surface free energy per unit area, $\\gamma$, represents the excess energy required to create a surface relative to the bulk material. For a crystalline slab composed of $N$ atomic layers with a surface area $A$, which creates two identical surfaces, the surface energy is formally defined in the limit of an infinitely thick slab:\n$$ \\gamma = \\lim_{N\\to\\infty} \\frac{1}{2A} \\left[ E_{\\text{slab,iso}}(N, A) - N E_{\\text{bulk}} \\right] $$\nHere, $E_{\\text{slab,iso}}(N, A)$ is the total energy of an ideal, isolated $N$-layer slab, and $E_{\\text{bulk}}$ is the reference energy of a single atomic layer within the bulk crystal. The factor of $\\frac{1}{2}$ accounts for the two surfaces created.\n\nIn practice, total energies are often calculated using periodic boundary conditions (PBC). A slab is placed in a computational supercell of area $A$ and height $L_{\\text{cell}}$, which is periodically repeated in all three dimensions. The cell height is composed of the slab thickness plus a vacuum region of thickness $L_z$, such that $L_{\\text{cell}} \\approx L_{\\text{slab}} + L_z$. If the slab possesses a net dipole moment perpendicular to its surface, $p_z$, the periodic repetition creates an infinite series of dipole sheets. This arrangement generates a spurious, uniform electric field across the entire supercell, including within the slab itself, altering the calculated total energy.\n\nThe spurious energy contribution, $E_{\\text{dipole}}$, can be derived from classical electrostatics. A sheet of dipoles with a dipole moment per unit area $\\mu_z = p_z/A$ creates a potential step of $\\Delta V = 4\\pi \\mu_z$ in atomic units (where $4\\pi\\epsilon_0=1$). In a periodically repeated system, this potential step is sawtooth-like. To maintain periodicity of the potential, a fictitious background charge is effectively introduced, which leads to a constant electric field $E = \\Delta V / L_{\\text{cell}} = 4\\pi p_z / (A L_{\\text{cell}})$ throughout the cell. The energy density of this field is $u = E^2 / (8\\pi)$. The total spurious energy in the cell volume $V = A L_{\\text{cell}}$ is therefore:\n$$ E_{\\text{dipole}} = u \\cdot V = \\frac{1}{8\\pi} \\left( \\frac{4\\pi p_z}{A L_{\\text{cell}}} \\right)^2 (A L_{\\text{cell}}) = \\frac{2\\pi p_z^2}{A L_{\\text{cell}}} $$\nSince the vacuum region $L_z$ is typically much larger than the physical slab thickness, it is standard to approximate $L_{\\text{cell}} \\approx L_z$. The problem statement implies this approximation, stating the interaction energy scales with $1/(A L_z)$. This formula provides the justification for the functional form of the dipole correction. The calculated total energy, $E_{\\text{slab}}^{\\text{measured}}$, is the sum of the true isolated slab energy and this spurious term. To recover the physically meaningful energy of the isolated slab, this term must be subtracted:\n$$ E_{\\text{slab}}^{\\text{corrected}}(N, A, L_z) = E_{\\text{slab}}^{\\text{measured}}(N, A, L_z) - \\frac{2\\pi p_z^2}{A L_z} $$\nIn this expression, all quantities ($E, p_z, A, L_z$) are in atomic units.\n\nWith the corrected energy, we can define the surface energy for a finite slab of thickness $N$ and vacuum $L_z$:\n$$ \\gamma(N, L_z) = \\frac{1}{2A} \\left[ E_{\\text{slab}}^{\\text{corrected}}(N, A, L_z) - N E_{\\text{bulk}} \\right] $$\n\nFor finite $N$, $\\gamma(N, L_z)$ still deviates from the true semi-infinite limit, $\\gamma_{\\infty}$. These finite-size effects arise from quantum confinement and the residual interaction between the two surfaces of the slab. These effects typically decay with slab thickness. A common and physically motivated model for the leading-order N-dependence is a rational asymptotic form:\n$$ \\gamma(N) = \\gamma_{\\infty} + \\frac{B}{N} $$\nwhere $B$ is a constant. This equation explains the asymptotic thickness dependence: as $N \\to \\infty$, the $B/N$ term vanishes, and $\\gamma(N)$ converges to the true surface energy $\\gamma_{\\infty}$. This functional form justifies the numerical procedure of performing a linear fit of the calculated surface energies $\\gamma(N)$ against $1/N$. The intercept of this fit provides an estimate for $\\gamma_{\\infty}$. A non-zero dependence of the corrected energy on $L_z$ indicates that the leading-order dipole correction is insufficient and higher-order multipole interactions or wavefunction overlap between periodic images may be present, which typically decay faster, e.g., as $1/L_z^2$.\n\n### Step 2: Numerical Implementation Plan\n\nThe numerical procedure will follow these steps for each test case:\n1.  **Constants and Conversions**: Define the physical constants $a_0$ and $E_{\\text{H}}$. Calculate the conversion factor from Hartree/$a_0^2$ to J/m$^2$:\n    $$ \\text{factor} = \\frac{E_{\\text{H}}}{a_0^2} = \\frac{4.3597447222071 \\times 10^{-18} \\text{ J}}{(5.29177210903 \\times 10^{-11} \\text{ m})^2} $$\n\n2.  **Synthetic Data Generation**: For each combination of slab thickness $N$ and vacuum length $L_z$, generate the \"measured\" total energy $E_{\\text{slab}}^{\\text{measured}}$ in Hartree atomic units according to the specified model:\n    $$ E_{\\text{slab}}^{\\text{measured}}(N, L_z) = N E_{\\text{bulk}} + 2A \\gamma_{\\infty}^{\\text{au}} + \\frac{2 A b^{\\text{au}}}{N} + \\frac{2\\pi p_z^2}{A L_z} + \\frac{c_{\\text{res}}}{L_z^2} $$\n    where $\\gamma_{\\infty}^{\\text{au}}$ and $b^{\\text{au}}$ are the input parameters given in J/m$^2$, converted to atomic units (Hartree/$a_0^2$) by dividing by the conversion factor.\n\n3.  **Energy Correction and Surface Energy Calculation**:\n    *   Apply the dipole correction to each generated energy: $E_{\\text{slab}}^{\\text{corrected}} = E_{\\text{slab}}^{\\text{measured}} - \\frac{2\\pi p_z^2}{A L_z}$.\n    *   Calculate the surface energy for each $(N, L_z)$ pair in atomic units: $\\gamma^{\\text{au}}(N, L_z) = \\frac{1}{2A} (E_{\\text{slab}}^{\\text{corrected}} - N E_{\\text{bulk}})$.\n\n4.  **Vacuum Convergence Analysis**:\n    *   For each slab thickness $N$, calculate the spread of surface energies across all vacuum lengths $L_z$: $\\Delta\\gamma(N) = \\max_{L_z} \\gamma^{\\text{au}}(N, L_z) - \\min_{L_z} \\gamma^{\\text{au}}(N, L_z)$.\n    *   Find the maximum spread over all $N$: $\\Delta\\gamma_{\\max} = \\max_{N} \\Delta\\gamma(N)$.\n    *   Convert $\\Delta\\gamma_{\\max}$ to J/m$^2$ and check if it is less than or equal to the tolerance of $10^{-2}$ J/m$^2$. This determines the boolean convergence flag.\n\n5.  **Extrapolation to Infinite Thickness**:\n    *   Select the data corresponding to the largest vacuum length, $L_{z,\\max}$, for each test case.\n    *   Construct the dataset $\\{ (x_i, y_i) \\}$, where $x_i = 1/N_i$ and $y_i = \\gamma^{\\text{au}}(N_i, L_{z,\\max})$.\n    *   Perform a linear least-squares fit to the model $y = a + b'x$ using `numpy.polyfit`. The intercept $a$ is the estimate for $\\gamma_{\\infty}$ in atomic units.\n    *   Calculate the Root Mean Square Error (RMSE) of the fit: $\\text{RMSE} = \\sqrt{\\frac{1}{k} \\sum_{i=1}^k (y_i - (a+b'x_i))^2}$, where $k$ is the number of $N$ values.\n    *   Convert the resulting intercept $a$ and the RMSE to J/m$^2$ by multiplying by the conversion factor.\n\n6.  **Output Formatting**: Collect the extrapolated surface energy $\\gamma$, the convergence flag, and the RMSE for each test case and format them into the required single-line string output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational materials science problem by simulating slab energy data,\n    applying dipole corrections, checking for vacuum convergence, and extracting the\n    semi-infinite surface energy via a linear fit.\n    \"\"\"\n    # Physical constants in SI units\n    A0 = 5.29177210903e-11  # Bohr radius in meters\n    EH = 4.3597447222071e-18 # Hartree energy in Joules\n\n    # Conversion factor from Hartree/a0^2 to J/m^2\n    HARTREE_PER_A02_TO_J_PER_M2 = EH / (A0**2)\n    # Conversion factor from J/m^2 to Hartree/a0^2\n    J_PER_M2_TO_HARTREE_PER_A02 = 1.0 / HARTREE_PER_A02_TO_J_PER_M2\n\n    # Vacuum convergence tolerance in J/m^2\n    VACUUM_TOLERANCE_SI = 1e-2\n\n    test_cases = [\n        # Test case 1 (happy path)\n        {\n            \"A\": 75.0, \"E_bulk\": -5.0, \"p_z\": 1.0,\n            \"N_values\": [4, 6, 8, 10, 12],\n            \"Lz_values\": [60.0, 80.0, 100.0],\n            \"gamma_inf_si\": 1.2, \"b_si\": 0.3, \"c_res\": 0.0\n        },\n        # Test case 2 (stronger dipole)\n        {\n            \"A\": 120.0, \"E_bulk\": -8.3, \"p_z\": 3.0,\n            \"N_values\": [5, 7, 9, 11, 13],\n            \"Lz_values\": [70.0, 100.0, 140.0],\n            \"gamma_inf_si\": 2.0, \"b_si\": 0.25, \"c_res\": 0.0\n        },\n        # Test case 3 (insufficient vacuum, residual interactions)\n        {\n            \"A\": 60.0, \"E_bulk\": -3.5, \"p_z\": 3.0,\n            \"N_values\": [3, 4, 5, 6],\n            \"Lz_values\": [30.0, 40.0, 50.0],\n            \"gamma_inf_si\": 0.8, \"b_si\": 0.5, \"c_res\": 6.0\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A = case[\"A\"]\n        E_bulk = case[\"E_bulk\"]\n        p_z = case[\"p_z\"]\n        N_values = np.array(case[\"N_values\"])\n        Lz_values = np.array(case[\"Lz_values\"])\n        gamma_inf_si = case[\"gamma_inf_si\"]\n        b_si = case[\"b_si\"]\n        c_res = case[\"c_res\"]\n\n        # Convert SI parameters to atomic units\n        gamma_inf_au = gamma_inf_si * J_PER_M2_TO_HARTREE_PER_A02\n        b_au = b_si * J_PER_M2_TO_HARTREE_PER_A02\n\n        # Dictionary to store calculated surface energies\n        gamma_values_au = {N: {} for N in N_values}\n\n        # --- Data Generation and Analysis ---\n        for N in N_values:\n            for Lz in Lz_values:\n                # 1. Generate synthetic measured energy in Hartree\n                E_bulk_term = N * E_bulk\n                E_surface_term = 2.0 * A * gamma_inf_au\n                E_finite_N_term = (2.0 * A * b_au) / N\n                E_dipole_term = (2.0 * np.pi * p_z**2) / (A * Lz)\n                E_residual_term = c_res / (Lz**2)\n                \n                E_measured_au = (E_bulk_term + E_surface_term + E_finite_N_term +\n                                 E_dipole_term + E_residual_term)\n\n                # 2. Apply dipole correction\n                E_corrected_au = E_measured_au - E_dipole_term\n\n                # 3. Calculate surface energy in atomic units\n                gamma_au = (E_corrected_au - N * E_bulk) / (2.0 * A)\n                gamma_values_au[N][Lz] = gamma_au\n\n        # --- Vacuum Convergence Check ---\n        max_spread_au = 0.0\n        for N in N_values:\n            gammas_for_N = list(gamma_values_au[N].values())\n            spread_au = np.max(gammas_for_N) - np.min(gammas_for_N)\n            if spread_au > max_spread_au:\n                max_spread_au = spread_au\n        \n        max_spread_si = max_spread_au * HARTREE_PER_A02_TO_J_PER_M2\n        is_converged = max_spread_si = VACUUM_TOLERANCE_SI\n\n        # --- Fit for Semi-Infinite Surface Energy ---\n        Lz_max = np.max(Lz_values)\n        x_fit = 1.0 / N_values\n        y_fit = np.array([gamma_values_au[N][Lz_max] for N in N_values])\n\n        # Linear fit: y = b'*x + a\n        # numpy.polyfit returns coefficients [b', a] for degree 1\n        fit_coeffs = np.polyfit(x_fit, y_fit, 1)\n        slope, intercept_au = fit_coeffs[0], fit_coeffs[1]\n\n        # Convert intercept to SI units\n        gamma_fit_si = intercept_au * HARTREE_PER_A02_TO_J_PER_M2\n\n        # --- RMSE Calculation ---\n        y_pred = np.polyval(fit_coeffs, x_fit)\n        rmse_au = np.sqrt(np.mean((y_fit - y_pred)**2))\n        rmse_si = rmse_au * HARTREE_PER_A02_TO_J_PER_M2\n\n        # Append results for this case\n        results.extend([\n            round(gamma_fit_si, 6),\n            is_converged,\n            round(rmse_si, 6)\n        ])\n    \n    # Final print statement in the exact required format.\n    # The boolean values are automatically converted to 'True' or 'False'\n    print(f\"[{','.join(map(str, results))}]\".replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```"
        }
    ]
}