{
    "hands_on_practices": [
        {
            "introduction": "The foundation of all structural relaxation methods is the principle that a system's stable structure corresponds to a local minimum on its potential energy surface. This exercise provides a hands-on derivation of this principle using a simple, analytically tractable model of a one-dimensional atomic chain. By minimizing the energy of a chain with nearest-neighbor Lennard-Jones interactions, you will not only determine the equilibrium lattice parameter but also connect the curvature of the potential at this minimum to the material's vibrational properties (phonons), illustrating a deep connection between structure and dynamics .",
            "id": "3454299",
            "problem": "Consider an infinite one-dimensional Bravais lattice of identical atoms of mass $M$ with lattice parameter $a$. Atoms interact through a pairwise potential $V(r)$ truncated to nearest neighbors. In the context of geometry optimization and structural relaxation, assume zero external stress and that relaxation proceeds by minimizing the energy per atom with respect to the lattice parameter $a$. Let the pairwise interaction be the Lennard–Jones potential $V(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$, where $\\varepsilon$ and $\\sigma$ are positive constants. \n\nTasks:\n1. Starting from the definitions of potential energy in a lattice and the principle that equilibrium structures minimize energy, formulate the energy per atom $E(a)$ under the nearest-neighbor approximation and obtain the equilibrium lattice parameter $a^{\\star}$ by minimizing $E(a)$.\n2. Linearize the equations of motion around the equilibrium configuration, derive the harmonic force constant $k$ as the curvature $k=V''(a^{\\star})$, and obtain the phonon dispersion relation $\\omega(q)$ for longitudinal modes in the nearest-neighbor approximation. Interpret the result to show how the curvature $k$ governs the long-wavelength behavior.\n3. Provide the final analytical expression for the equilibrium lattice parameter $a^{\\star}$ in terms of $\\sigma$.\n\nYour final reported quantity must be a single closed-form analytic expression for $a^{\\star}$ in terms of $\\sigma$. No rounding is required.",
            "solution": "The problem statement is evaluated based on the established criteria for validity.\n\n### Step 1: Extract Givens\n- System: An infinite one-dimensional Bravais lattice.\n- Constituents: Identical atoms of mass $M$.\n- Geometry: Lattice parameter is $a$.\n- Interaction: A pairwise potential $V(r)$.\n- Approximation: Interaction is truncated to nearest neighbors only.\n- Conditions: Zero external stress; relaxation proceeds by minimizing the energy per atom, $E(a)$, with respect to the lattice parameter $a$.\n- Potential Form: Lennard–Jones potential, $V(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$, where $\\varepsilon$ and $\\sigma$ are positive constants.\n- Task 1: Formulate $E(a)$ and find the equilibrium lattice parameter $a^{\\star}$ by minimizing $E(a)$.\n- Task 2: Linearize the equations of motion to find the harmonic force constant $k=V''(a^{\\star})$ and the phonon dispersion relation $\\omega(q)$ for longitudinal modes. Interpret the long-wavelength behavior.\n- Task 3: Provide the analytical expression for $a^{\\star}$ in terms of $\\sigma$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for scientific grounding, well-posedness, and objectivity.\n\n- **Scientifically Grounded**: The problem is a standard, fundamental exercise in solid-state physics and computational materials science. It employs the well-established Lennard-Jones potential to model interatomic interactions and explores core concepts like lattice energy minimization, equilibrium structure, and lattice dynamics (phonons). All principles involved are scientifically sound.\n- **Well-Posed**: The problem is clearly defined and mathematically tractable. The nearest-neighbor approximation simplifies the calculation, making it a well-posed problem that leads to a unique, stable, and meaningful solution for the equilibrium lattice parameter $a^{\\star}$ and the dispersion relation $\\omega(q)$.\n- **Objective**: The problem is stated using precise, unambiguous scientific language, free from any subjective or biased elements.\n- **Completeness and Consistency**: The problem provides all necessary information (potential form, physical model) to perform the requested derivations. The tasks are logically sequential and consistent with one another.\n- **Relevance**: The problem is directly and fundamentally related to the topic of *geometry optimization and structural relaxation* as specified. Energy minimization is the core principle of structural relaxation, and analysis of vibrational modes (phonons) is a standard method to characterize the stability of the predicted structure.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and directly relevant. It contains no contradictions, ambiguities, or factual errors.\n**Verdict: The problem is valid.**\nThe solution will now be derived.\n\n### Solution Derivation\n\n**Task 1: Energy per Atom and Equilibrium Lattice Parameter**\n\nIn a one-dimensional infinite lattice with nearest-neighbor interactions, the total potential energy $U$ can be found by summing the interaction energy over all pairs. To obtain the energy per atom, $E(a)$, we can assign half of the energy of each bond to each of the two atoms participating in that bond. An arbitrary atom in the chain has two nearest neighbors, one to its left and one to its right, both at a distance $a$. Therefore, the atom participates in two bonds. The energy per atom is the sum of the energies of these two half-bonds:\n$$E(a) = \\frac{1}{2}V(a) + \\frac{1}{2}V(a) = V(a)$$\nAlternatively, for a lattice of $N$ atoms with periodic boundary conditions, there are $N$ nearest-neighbor bonds. The total energy is $U = N V(a)$, and the energy per atom is $E(a) = U/N = V(a)$.\n\nSubstituting the Lennard-Jones potential form:\n$$E(a) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{a}\\right)^{12}-\\left(\\frac{\\sigma}{a}\\right)^{6}\\right] = 4\\varepsilon\\left(\\sigma^{12}a^{-12} - \\sigma^{6}a^{-6}\\right)$$\nThe equilibrium lattice parameter, $a^{\\star}$, corresponds to the value of $a$ that minimizes the energy per atom. This condition is found by setting the first derivative of $E(a)$ with respect to $a$ to zero:\n$$\\frac{dE(a)}{da} = 0$$\n$$\\frac{d}{da}\\left[4\\varepsilon\\left(\\sigma^{12}a^{-12} - \\sigma^{6}a^{-6}\\right)\\right] = 4\\varepsilon\\left(-12\\sigma^{12}a^{-13} + 6\\sigma^{6}a^{-7}\\right) = 0$$\nSince $4\\varepsilon \\neq 0$, we must have:\n$$-12\\sigma^{12}a^{-13} + 6\\sigma^{6}a^{-7} = 0$$\n$$6\\sigma^{6}a^{-7} = 12\\sigma^{12}a^{-13}$$\nAssuming $a \\neq 0$ and $\\sigma \\neq 0$, we can rearrange the equation to solve for $a$:\n$$a^{-7}a^{13} = \\frac{12\\sigma^{12}}{6\\sigma^{6}}$$\n$$a^{6} = 2\\sigma^{6}$$\n$$a^{\\star} = (2\\sigma^{6})^{1/6} = 2^{1/6}\\sigma$$\nTo confirm that this corresponds to a minimum, we evaluate the second derivative of the energy, $\\frac{d^{2}E(a)}{da^{2}}$, at $a = a^{\\star}$.\n$$\\frac{d^{2}E(a)}{da^{2}} = \\frac{d}{da}\\left[4\\varepsilon\\left(-12\\sigma^{12}a^{-13} + 6\\sigma^{6}a^{-7}\\right)\\right]$$\n$$\\frac{d^{2}E(a)}{da^{2}} = 4\\varepsilon\\left((-12)(-13)\\sigma^{12}a^{-14} + (6)(-7)\\sigma^{6}a^{-8}\\right) = 4\\varepsilon\\left(156\\sigma^{12}a^{-14} - 42\\sigma^{6}a^{-8}\\right)$$\nEvaluating at $a=a^{\\star}$, where $(a^{\\star})^6 = 2\\sigma^6$:\n$$\\frac{d^{2}E}{da^{2}}\\bigg|_{a=a^{\\star}} = 4\\varepsilon\\left(156\\sigma^{12}(a^{\\star})^{-14} - 42\\sigma^{6}(a^{\\star})^{-8}\\right) = 4\\varepsilon(a^{\\star})^{-14}\\left(156\\sigma^{12} - 42\\sigma^{6}(a^{\\star})^{6}\\right)$$\n$$= 4\\varepsilon(a^{\\star})^{-14}\\left(156\\sigma^{12} - 42\\sigma^{6}(2\\sigma^{6})\\right) = 4\\varepsilon(a^{\\star})^{-14}\\left(156\\sigma^{12} - 84\\sigma^{12}\\right)$$\n$$= 4\\varepsilon(a^{\\star})^{-14}(72\\sigma^{12}) = \\frac{288\\varepsilon\\sigma^{12}}{(a^{\\star})^{14}}$$\nSince $\\varepsilon > 0$, $\\sigma > 0$, and $a^{\\star} > 0$, the second derivative is positive. Thus, $a^{\\star} = 2^{1/6}\\sigma$ is indeed the lattice parameter that minimizes the energy.\n\n**Task 2: Force Constant and Phonon Dispersion**\n\nThe harmonic force constant $k$ is defined as the curvature of the pairwise potential at the equilibrium separation, $k = V''(a^{\\star})$. From Task 1, since $E(a)=V(a)$, we have $k = E''(a^{\\star})$.\n$$k = \\frac{288\\varepsilon\\sigma^{12}}{(a^{\\star})^{14}} = \\frac{288\\varepsilon\\sigma^{12}}{(2^{1/6}\\sigma)^{14}} = \\frac{288\\varepsilon\\sigma^{12}}{2^{14/6}\\sigma^{14}} = \\frac{288\\varepsilon}{2^{7/3}\\sigma^{2}} = \\frac{2^5 \\cdot 9 \\cdot \\varepsilon}{2^{7/3}\\sigma^{2}} = 72 \\cdot 2^{-1/3} \\frac{\\varepsilon}{\\sigma^2}$$\nNow, we derive the phonon dispersion relation. Let $u_n$ be the longitudinal displacement of the $n$-th atom from its equilibrium position $na^{\\star}$. The equation of motion for the $n$-th atom is given by Newton's second law, $M\\ddot{u}_n = F_n$. The force $F_n$ is the sum of forces from its nearest neighbors, atoms $n-1$ and $n+1$.\n$$F_n = F_{n \\leftarrow n-1} + F_{n \\leftarrow n+1}$$\nIn the harmonic approximation, the force between two atoms is linear in their displacement from equilibrium separation: $F = -k \\times (\\text{displacement})$.\nThe force on atom $n$ from atom $n+1$ is $k(u_{n+1}-u_n)$.\nThe force on atom $n$ from atom $n-1$ is $k(u_{n-1}-u_n)$.\nThe net force on atom $n$ is:\n$$F_n = k(u_{n+1}-u_n) + k(u_{n-1}-u_n) = k(u_{n+1} + u_{n-1} - 2u_n)$$\nThe equation of motion is:\n$$M\\frac{d^{2}u_n}{dt^{2}} = k(u_{n+1} + u_{n-1} - 2u_n)$$\nWe seek plane wave solutions of the form $u_n(t) = A\\exp(i(qna^{\\star} - \\omega t))$, where $q$ is the wavevector and $\\omega$ is the angular frequency. Substituting this ansatz into the equation of motion:\n$$u_{n\\pm1}(t) = u_n(t) \\exp(\\pm iqa^{\\star})$$\n$$M(-\\omega^{2})u_n = k(u_n\\exp(iqa^{\\star}) + u_n\\exp(-iqa^{\\star}) - 2u_n)$$\nDividing by $u_n$ (which is non-zero):\n$$-M\\omega^{2} = k(\\exp(iqa^{\\star}) + \\exp(-iqa^{\\star}) - 2)$$\nUsing the identity $2\\cos\\theta = \\exp(i\\theta) + \\exp(-i\\theta)$:\n$$-M\\omega^{2} = k(2\\cos(qa^{\\star}) - 2) = -2k(1 - \\cos(qa^{\\star}))$$\nUsing the identity $1 - \\cos\\theta = 2\\sin^{2}(\\theta/2)$:\n$$M\\omega^{2} = 4k\\sin^{2}\\left(\\frac{qa^{\\star}}{2}\\right)$$\nThe phonon dispersion relation is thus:\n$$\\omega(q) = \\sqrt{\\frac{4k}{M}}\\left|\\sin\\left(\\frac{qa^{\\star}}{2}\\right)\\right|$$\nFor the long-wavelength limit ($q \\to 0$), we have $\\sin(x) \\approx x$. Therefore:\n$$\\omega(q) \\approx \\sqrt{\\frac{4k}{M}}\\left|\\frac{qa^{\\star}}{2}\\right| = \\left(a^{\\star}\\sqrt{\\frac{k}{M}}\\right)|q|$$\nThis shows a linear relationship, $\\omega(q) = v_s|q|$, which is characteristic of acoustic waves. The speed of sound is $v_s = a^{\\star}\\sqrt{k/M}$.\nThe curvature of the potential, $k=V''(a^{\\star})$, directly governs this long-wavelength behavior. A larger curvature implies a stiffer \"spring\" connecting the atoms. This increased stiffness results in a higher speed of sound $v_s$, meaning that mechanical waves propagate faster through the lattice. Therefore, the curvature $k$ sets the scale for the acoustic properties of the material.\n\n**Task 3: Final Analytical Expression for the Equilibrium Lattice Parameter**\n\nAs derived in Task 1, the equilibrium lattice parameter $a^{\\star}$ that minimizes the energy per atom for the given one-dimensional chain with nearest-neighbor Lennard-Jones interactions is:\n$$a^{\\star} = 2^{1/6}\\sigma$$\nThis expression provides the optimal interatomic distance in terms of the Lennard-Jones parameter $\\sigma$, which represents the finite distance at which the inter-particle potential is zero. The equilibrium distance is slightly larger than $\\sigma$, as expected, because the repulsive part of the potential is much steeper than the attractive part.",
            "answer": "$$\\boxed{2^{1/6}\\sigma}$$"
        },
        {
            "introduction": "While simple energy minimization is the goal, the algorithms to achieve it in high-dimensional spaces are sophisticated. This practice moves beyond simple gradient descent to demystify the powerful Broyden–Fletcher–Goldfarb–Shanno (BFGS) algorithm, a workhorse for geometry optimization. By performing two iterations by hand on a simple quadratic potential, you will gain invaluable insight into how this quasi-Newton method iteratively builds an approximation to the inverse Hessian matrix to take efficient steps toward the minimum .",
            "id": "3454267",
            "problem": "Consider a structural relaxation step in computational materials science modeled by minimizing a harmonic approximation to the total energy. Let the two-dimensional energy be given by the quadratic function $E(\\mathbf{x}) = \\tfrac{1}{2}\\,\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}^{\\mathsf{T}}\\mathbf{x}$, where $\\mathbf{x} \\in \\mathbb{R}^{2}$ collects two coupled geometric degrees of freedom. Assume the symmetric positive definite Hessian matrix $\\mathbf{A}$ and the linear term $\\mathbf{b}$ are known and given by $\\mathbf{A} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$ and $\\mathbf{b} = \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$. Start from the initial configuration $\\mathbf{x}_{0} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ and the initial inverse Hessian approximation $\\mathbf{H}_{0} = \\mathbf{I}_{2}$, where $\\mathbf{I}_{2}$ is the $2 \\times 2$ identity matrix.\n\nPerform two iterations of the Broyden–Fletcher–Goldfarb–Shanno (BFGS) method using the inverse-form update with exact line search along the search direction $\\mathbf{p}_{k} = -\\mathbf{H}_{k}\\,\\nabla E(\\mathbf{x}_{k})$ at each iteration $k$. At each iteration, compute the step $\\mathbf{s}_{k} = \\alpha_{k}\\,\\mathbf{p}_{k}$ with the exact line-search parameter $\\alpha_{k}$ chosen to minimize $E(\\mathbf{x}_{k} + \\alpha\\,\\mathbf{p}_{k})$ over real $\\alpha$, the gradient difference $\\mathbf{y}_{k} = \\nabla E(\\mathbf{x}_{k+1}) - \\nabla E(\\mathbf{x}_{k})$, and then update the inverse Hessian approximation to obtain $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$. Show the explicit matrices $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$ obtained by these two iterations.\n\nFinally, compute the trace $\\operatorname{tr}(\\mathbf{H}_{2})$ and provide it as the final answer. Express the final answer as a single exact rational number with no rounding and no units.",
            "solution": "The problem is valid as it presents a well-posed numerical optimization task based on established principles of computational materials science and numerical analysis. All necessary data are provided, and the problem is free of scientific flaws, contradictions, or ambiguities.\n\nThe total energy is given by the quadratic function $E(\\mathbf{x}) = \\frac{1}{2}\\,\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}^{\\mathsf{T}}\\mathbf{x}$. The gradient of the energy function, $\\nabla E(\\mathbf{x})$, is required for the BFGS algorithm. It is given by:\n$$\n\\nabla E(\\mathbf{x}) = \\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}\n$$\nThe BFGS algorithm iteratively refines the position $\\mathbf{x}_{k}$ and the inverse Hessian approximation $\\mathbf{H}_{k}$. The update rules are:\n1.  Compute the gradient: $\\mathbf{g}_{k} = \\nabla E(\\mathbf{x}_{k})$.\n2.  Compute the search direction: $\\mathbf{p}_{k} = -\\mathbf{H}_{k}\\,\\mathbf{g}_{k}$.\n3.  Find the step size $\\alpha_{k}$ via exact line search, minimizing $E(\\mathbf{x}_{k} + \\alpha\\,\\mathbf{p}_{k})$. For a quadratic energy function, this is given by:\n    $$\n    \\alpha_{k} = -\\frac{\\mathbf{g}_{k}^{\\mathsf{T}}\\mathbf{p}_{k}}{\\mathbf{p}_{k}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{p}_{k}}\n    $$\n4.  Update the position: $\\mathbf{x}_{k+1} = \\mathbf{x}_{k} + \\mathbf{s}_{k}$, where $\\mathbf{s}_{k} = \\alpha_{k}\\mathbf{p}_{k}$.\n5.  Compute the new gradient and the gradient difference: $\\mathbf{g}_{k+1} = \\nabla E(\\mathbf{x}_{k+1})$ and $\\mathbf{y}_{k} = \\mathbf{g}_{k+1} - \\mathbf{g}_{k}$.\n6.  Update the inverse Hessian approximation using the inverse BFGS formula:\n    $$\n    \\mathbf{H}_{k+1} = \\mathbf{H}_{k} + \\frac{(\\mathbf{s}_{k}^{\\mathsf{T}}\\mathbf{y}_{k} + \\mathbf{y}_{k}^{\\mathsf{T}}\\mathbf{H}_{k}\\mathbf{y}_{k})}{(\\mathbf{s}_{k}^{\\mathsf{T}}\\mathbf{y}_{k})^2} (\\mathbf{s}_{k} \\mathbf{s}_{k}^{\\mathsf{T}}) - \\frac{\\mathbf{H}_{k}\\mathbf{y}_{k}\\mathbf{s}_{k}^{\\mathsf{T}} + \\mathbf{s}_{k}\\mathbf{y}_{k}^{\\mathsf{T}}\\mathbf{H}_{k}}{\\mathbf{s}_{k}^{\\mathsf{T}}\\mathbf{y}_{k}}\n    $$\n\nWe are given:\n$\\mathbf{A} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$, $\\mathbf{b} = \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$, $\\mathbf{x}_{0} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$, and $\\mathbf{H}_{0} = \\mathbf{I}_{2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$.\n\n**Iteration $0$ (to find $\\mathbf{H}_{1}$)**\n\n1.  Gradient at $\\mathbf{x}_{0}$:\n    $\\mathbf{g}_{0} = \\mathbf{A}\\,\\mathbf{x}_{0} + \\mathbf{b} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$.\n2.  Search direction $\\mathbf{p}_{0}$:\n    $\\mathbf{p}_{0} = -\\mathbf{H}_{0}\\,\\mathbf{g}_{0} = -\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix}$.\n3.  Step size $\\alpha_{0}$:\n    Numerator: $-\\mathbf{g}_{0}^{\\mathsf{T}}\\mathbf{p}_{0} = -\\begin{pmatrix} 1  3 \\end{pmatrix}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = -(-1-9) = 10$.\n    Denominator: $\\mathbf{A}\\mathbf{p}_{0} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} -7 \\\\ -10 \\end{pmatrix}$.\n    $\\mathbf{p}_{0}^{\\mathsf{T}}\\mathbf{A}\\mathbf{p}_{0} = \\begin{pmatrix} -1  -3 \\end{pmatrix}\\begin{pmatrix} -7 \\\\ -10 \\end{pmatrix} = 7+30 = 37$.\n    $\\alpha_{0} = \\frac{10}{37}$.\n4.  Position update:\n    $\\mathbf{s}_{0} = \\alpha_{0}\\mathbf{p}_{0} = \\frac{10}{37}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} -10/37 \\\\ -30/37 \\end{pmatrix}$.\n    $\\mathbf{x}_{1} = \\mathbf{x}_{0} + \\mathbf{s}_{0} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} -10/37 \\\\ -30/37 \\end{pmatrix} = \\begin{pmatrix} 27/37 \\\\ -67/37 \\end{pmatrix}$.\n5.  Gradient difference:\n    $\\mathbf{g}_{1} = \\mathbf{A}\\,\\mathbf{x}_{1} + \\mathbf{b} = \\frac{1}{37}\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 27 \\\\ -67 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} 41 \\\\ -174 \\end{pmatrix} + \\frac{1}{37}\\begin{pmatrix} -74 \\\\ 185 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} -33 \\\\ 11 \\end{pmatrix}$.\n    $\\mathbf{y}_{0} = \\mathbf{g}_{1} - \\mathbf{g}_{0} = \\frac{1}{37}\\begin{pmatrix} -33 \\\\ 11 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} -70 \\\\ -100 \\end{pmatrix}$.\n6.  Inverse Hessian update for $\\mathbf{H}_{1}$:\n    We need $\\mathbf{s}_{0}^{\\mathsf{T}}\\mathbf{y}_{0}$ and $\\mathbf{y}_{0}^{\\mathsf{T}}\\mathbf{H}_{0}\\mathbf{y}_{0} = \\mathbf{y}_{0}^{\\mathsf{T}}\\mathbf{y}_{0}$ (since $\\mathbf{H}_{0}=\\mathbf{I}$).\n    $\\mathbf{s}_{0}^{\\mathsf{T}}\\mathbf{y}_{0} = \\frac{10}{37}\\begin{pmatrix} -1  -3 \\end{pmatrix} \\frac{1}{37}\\begin{pmatrix} -70 \\\\ -100 \\end{pmatrix} = \\frac{10}{37^2}(70+300) = \\frac{3700}{1369} = \\frac{100}{37}$.\n    $\\mathbf{y}_{0}^{\\mathsf{T}}\\mathbf{y}_{0} = \\frac{1}{37^2}\\begin{pmatrix} -70  -100 \\end{pmatrix}\\begin{pmatrix} -70 \\\\ -100 \\end{pmatrix} = \\frac{1}{1369}(4900+10000) = \\frac{14900}{1369}$.\n    Using the update formula with $\\mathbf{H}_{0}=\\mathbf{I}$:\n    $\\mathbf{H}_{1} = \\mathbf{I} + \\frac{\\frac{100}{37} + \\frac{14900}{1369}}{(\\frac{100}{37})^2} (\\mathbf{s}_{0} \\mathbf{s}_{0}^{\\mathsf{T}}) - \\frac{\\mathbf{y}_{0}\\mathbf{s}_{0}^{\\mathsf{T}} + \\mathbf{s}_{0}\\mathbf{y}_{0}^{\\mathsf{T}}}{\\frac{100}{37}}$.\n    The coefficient of $\\mathbf{s}_{0}\\mathbf{s}_{0}^{\\mathsf{T}}$ is $\\frac{\\frac{100 \\cdot 37 + 14900}{1369}}{\\frac{10000}{1369}} = \\frac{3700+14900}{10000} = \\frac{18600}{10000} = \\frac{186}{100} = \\frac{93}{50}$.\n    $\\mathbf{s}_{0} \\mathbf{s}_{0}^{\\mathsf{T}} = (\\frac{10}{37})^2 \\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix} = \\frac{100}{1369}\\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix}$.\n    First term: $\\frac{93}{50} \\frac{100}{1369}\\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix} = \\frac{186}{1369}\\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix}$.\n    $\\mathbf{s}_{0}\\mathbf{y}_{0}^{\\mathsf{T}} = \\frac{10}{37^2}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} \\begin{pmatrix} -70  -100 \\end{pmatrix} = \\frac{10}{1369}\\begin{pmatrix} 70  100 \\\\ 210  300 \\end{pmatrix}$.\n    Cross term: $-\\frac{37}{100} \\frac{10}{1369} \\left( \\begin{pmatrix} 70  100 \\\\ 210  300 \\end{pmatrix} + \\begin{pmatrix} 70  210 \\\\ 100  300 \\end{pmatrix} \\right) = -\\frac{370}{136900} \\begin{pmatrix} 140  310 \\\\ 310  600 \\end{pmatrix} = -\\frac{1}{370} \\begin{pmatrix} 140  310 \\\\ 310  600 \\end{pmatrix} = -\\frac{1}{37}\\begin{pmatrix} 14  31 \\\\ 31  60 \\end{pmatrix}$.\n    $\\mathbf{H}_{1} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{1}{1369} \\begin{pmatrix} 186  558 \\\\ 558  1674 \\end{pmatrix} - \\frac{37}{1369}\\begin{pmatrix} 14  31 \\\\ 31  60 \\end{pmatrix}$.\n    $\\mathbf{H}_{1} = \\frac{1}{1369} \\left( \\begin{pmatrix} 1369  0 \\\\ 0  1369 \\end{pmatrix} + \\begin{pmatrix} 186  558 \\\\ 558  1674 \\end{pmatrix} - \\begin{pmatrix} 518  1147 \\\\ 1147  2220 \\end{pmatrix} \\right)$.\n    $\\mathbf{H}_{1} = \\frac{1}{1369}\\begin{pmatrix} 1037  -589 \\\\ -589  823 \\end{pmatrix}$.\n\n**Iteration $1$ (to find $\\mathbf{H}_{2}$)**\n\nFor a quadratic function in $N$ dimensions, the BFGS method with exact line search finds the minimum in at most $N$ iterations. For this $2$-dimensional problem, $\\mathbf{x}_{2}$ will be the exact minimum, and $\\mathbf{H}_{2}$ will be the exact inverse Hessian $\\mathbf{A}^{-1}$. We verify this by calculation.\n\n1.  Search direction $\\mathbf{p}_{1}$:\n    $\\mathbf{p}_{1} = -\\mathbf{H}_{1}\\,\\mathbf{g}_{1} = -\\frac{1}{1369}\\begin{pmatrix} 1037  -589 \\\\ -589  823 \\end{pmatrix} \\frac{1}{37}\\begin{pmatrix} -33 \\\\ 11 \\end{pmatrix} = -\\frac{11}{1369 \\cdot 37}\\begin{pmatrix} 1037  -589 \\\\ -589  823 \\end{pmatrix}\\begin{pmatrix} -3 \\\\ 1 \\end{pmatrix}$.\n    The matrix-vector product is $\\begin{pmatrix} -3111 - 589 \\\\ 1767 + 823 \\end{pmatrix} = \\begin{pmatrix} -3700 \\\\ 2590 \\end{pmatrix} = 37\\begin{pmatrix} -100 \\\\ 70 \\end{pmatrix}$.\n    $\\mathbf{p}_{1} = -\\frac{11 \\cdot 37}{1369 \\cdot 37}\\begin{pmatrix} -100 \\\\ 70 \\end{pmatrix} = \\frac{11}{1369}\\begin{pmatrix} 100 \\\\ -70 \\end{pmatrix} = \\frac{110}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix}$.\n2.  Step size $\\alpha_{1}$:\n    Numerator: $-\\mathbf{g}_{1}^{\\mathsf{T}}\\mathbf{p}_{1} = -\\frac{1}{37}\\begin{pmatrix} -33  11 \\end{pmatrix} \\frac{110}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = -\\frac{11 \\cdot 110}{37 \\cdot 1369}\\begin{pmatrix} -3  1 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = -\\frac{1210}{50653}(-30-7) = \\frac{1210 \\cdot 37}{50653} = \\frac{1210}{1369}$.\n    Denominator: $\\mathbf{A}\\mathbf{p}_{1} = \\frac{110}{1369}\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = \\frac{110}{1369}\\begin{pmatrix} 33 \\\\ -11 \\end{pmatrix}$.\n    $\\mathbf{p}_{1}^{\\mathsf{T}}\\mathbf{A}\\mathbf{p}_{1} = \\frac{110^2}{1369^2}\\begin{pmatrix} 10  -7 \\end{pmatrix} \\begin{pmatrix} 33 \\\\ -11 \\end{pmatrix} = \\frac{12100}{1369^2}(330+77) = \\frac{12100 \\cdot 407}{1369^2} = \\frac{12100 \\cdot 11 \\cdot 37}{(37^2)^2} = \\frac{133100}{37^3}$.\n    $\\alpha_{1} = \\frac{1210/37^2}{133100/37^3} = \\frac{1210 \\cdot 37}{133100} = \\frac{121 \\cdot 37}{13310} = \\frac{37}{110}$.\n3.  Position update:\n    $\\mathbf{s}_{1} = \\alpha_{1}\\mathbf{p}_{1} = \\frac{37}{110}\\frac{110}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = \\frac{37}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix}$.\n    $\\mathbf{x}_{2} = \\mathbf{x}_{1} + \\mathbf{s}_{1} = \\begin{pmatrix} 27/37 \\\\ -67/37 \\end{pmatrix} + \\begin{pmatrix} 10/37 \\\\ -7/37 \\end{pmatrix} = \\begin{pmatrix} 37/37 \\\\ -74/37 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$.\n    This is the exact minimum, as $\\nabla E(\\mathbf{x}_{2}) = \\mathbf{A}\\mathbf{x}_{2}+\\mathbf{b} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -5 \\end{pmatrix}+\\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\n4.  Inverse Hessian update for $\\mathbf{H}_{2}$:\n    The theorem for quadratic functions states $\\mathbf{H}_{2} = \\mathbf{A}^{-1}$.\n    $\\mathbf{A}^{-1} = \\frac{1}{4(3) - 1(1)}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}$.\n    So, the matrix is $\\mathbf{H}_{2} = \\begin{pmatrix} 3/11  -1/11 \\\\ -1/11  4/11 \\end{pmatrix}$.\n\nThe final step is to compute the trace of $\\mathbf{H}_{2}$.\n$$\n\\operatorname{tr}(\\mathbf{H}_{2}) = \\operatorname{tr}\\left(\\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}\\right) = \\frac{3}{11} + \\frac{4}{11} = \\frac{7}{11}\n$$\nThis is an exact rational number as requested.",
            "answer": "$$\\boxed{\\frac{7}{11}}$$"
        },
        {
            "introduction": "Geometry optimization is not limited to atomic positions; in many simulations, the size and shape of the periodic cell must also be relaxed to match a desired external pressure. This exercise demonstrates a single step in a variable-cell relaxation, a crucial technique for predicting crystal structures and equations of state. You will apply a steepest-descent algorithm to update the lattice vectors based on the mismatch between the internal stress tensor, $\\boldsymbol{\\sigma}$, and the external pressure, $p$, providing a concrete link between these macroscopic thermodynamic quantities and the microscopic cell geometry .",
            "id": "3454268",
            "problem": "Consider a three-dimensional periodic solid represented by a cell matrix $\\mathbf{h}^{(0)}$ whose columns are the lattice vectors in Cartesian coordinates. Let the Cauchy stress tensor $\\boldsymbol{\\sigma}$ be computed from a quantum-mechanical total-energy calculation at fixed fractional atomic coordinates, and let the system be subject to a hydrostatic external pressure $p$. The enthalpy is $H = E + p V$, where $E$ is the internal energy and $V=\\det(\\mathbf{h})$ is the cell volume. A steepest-descent update of the cell is performed by taking a step along the negative gradient of $H$ with respect to the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$, while holding fractional atomic coordinates fixed. Assume the small-strain linearization of the cell update and use the standard virtual-work relation between stress and strain.\n\nYou are given:\n$$\n\\mathbf{h}^{(0)} = \\begin{pmatrix}\n3.000  0.200  0.100\\\\\n0.000  4.000  0.300\\\\\n0.000  0.000  5.000\n\\end{pmatrix}\\ \\text{Å},\n\\quad\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n1.5  0.2  -0.1\\\\\n0.2  -0.5  0.0\\\\\n-0.1  0.0  2.0\n\\end{pmatrix}\\ \\text{GPa},\n\\quad\np = 1.0\\ \\text{GPa}.\n$$\nLet the steepest-descent step size be characterized by a scalar $\\kappa$ with units $\\text{GPa}^{-1}$ defined by $\\delta \\boldsymbol{\\varepsilon} = \\kappa \\left( \\boldsymbol{\\sigma} - p \\mathbf{I} \\right)$, with $\\kappa = 2.0 \\times 10^{-2}\\ \\text{GPa}^{-1}$. Adopt the linearized update of the cell matrix under the deformation gradient $\\mathbf{F} \\approx \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}$, namely $\\mathbf{h}^{(1)} = \\left( \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon} \\right) \\mathbf{h}^{(0)}$, where $\\mathbf{I}$ is the identity matrix. Use the double-contraction convention $A : B = \\sum_{i,j} A_{ij} B_{ij}$.\n\nCompute the updated cell matrix $\\mathbf{h}^{(1)}$. Express your final answer as a row matrix listing the nine components of $\\mathbf{h}^{(1)}$ in column-major order (i.e., column by column, top to bottom, left to right), in Å. Round each component of the answer to four significant figures.",
            "solution": "The user wants me to compute the updated cell matrix `\\mathbf{h}^{(1)}` after a single steepest-descent step.\n\n### Step 1: Extract Givens\n- Initial cell matrix:\n$$\n\\mathbf{h}^{(0)} = \\begin{pmatrix}\n3.000  0.200  0.100\\\\\n0.000  4.000  0.300\\\\\n0.000  0.000  5.000\n\\end{pmatrix}\\ \\text{Å}\n$$\n- Cauchy stress tensor:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n1.5  0.2  -0.1\\\\\n0.2  -0.5  0.0\\\\\n-0.1  0.0  2.0\n\\end{pmatrix}\\ \\text{GPa}\n$$\n- Hydrostatic external pressure: $p = 1.0\\ \\text{GPa}$.\n- Steepest-descent step size parameter: $\\kappa = 2.0 \\times 10^{-2}\\ \\text{GPa}^{-1}$.\n- Strain update rule: $\\delta \\boldsymbol{\\varepsilon} = \\kappa \\left( \\boldsymbol{\\sigma} - p \\mathbf{I} \\right)$.\n- Linearized cell update rule: $\\mathbf{h}^{(1)} = \\left( \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon} \\right) \\mathbf{h}^{(0)}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard, albeit simplified, computational procedure for structural relaxation in materials science. The provided update rule, $\\delta \\boldsymbol{\\varepsilon} = \\kappa \\left( \\boldsymbol{\\sigma} - p \\mathbf{I} \\right)$, represents a physically motivated algorithm to relax the internal stress $\\boldsymbol{\\sigma}$ towards the target external pressure tensor $p \\mathbf{I}$. All necessary data are provided, the quantities are dimensionally consistent, and the required operations are well-defined mathematical procedures. Therefore, a unique solution can be determined. The problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the full solution.\n\nThe solution proceeds by first computing the infinitesimal strain tensor $\\delta \\boldsymbol{\\varepsilon}$ from the given stress, pressure, and step size. Then, this strain is used to construct the linearized deformation gradient $\\mathbf{F} \\approx \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}$. Finally, the updated cell matrix $\\mathbf{h}^{(1)}$ is computed by applying this deformation to the initial cell matrix $\\mathbf{h}^{(0)}$.\n\nFirst, we calculate the difference between the internal stress tensor $\\boldsymbol{\\sigma}$ and the target stress tensor corresponding to the external pressure, $p \\mathbf{I}$.\n$$\np \\mathbf{I} = (1.0) \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\text{GPa} = \\begin{pmatrix} 1.0  0.0  0.0 \\\\ 0.0  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{pmatrix} \\text{GPa}\n$$\n$$\n\\boldsymbol{\\sigma} - p \\mathbf{I} = \\begin{pmatrix}\n1.5  0.2  -0.1\\\\\n0.2  -1.5  0.0\\\\\n-0.1  0.0  1.0\n\\end{pmatrix} - \\begin{pmatrix}\n1.0  0.0  0.0 \\\\\n0.0  1.0  0.0 \\\\\n0.0  0.0  1.0\n\\end{pmatrix} = \\begin{pmatrix}\n0.5  0.2  -0.1\\\\\n0.2  -1.5  0.0\\\\\n-0.1  0.0  1.0\n\\end{pmatrix} \\text{GPa}\n$$\nNext, we compute the infinitesimal strain tensor $\\delta \\boldsymbol{\\varepsilon}$ using the provided update rule, $\\delta \\boldsymbol{\\varepsilon} = \\kappa ( \\boldsymbol{\\sigma} - p \\mathbf{I} )$.\n$$\n\\delta \\boldsymbol{\\varepsilon} = (2.0 \\times 10^{-2}\\ \\text{GPa}^{-1}) \\begin{pmatrix}\n0.5  0.2  -0.1\\\\\n0.2  -1.5  0.0\\\\\n-0.1  0.0  1.0\n\\end{pmatrix} \\text{GPa}\n$$\n$$\n\\delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix}\n0.02 \\times 0.5  0.02 \\times 0.2  0.02 \\times (-0.1)\\\\\n0.02 \\times 0.2  0.02 \\times (-1.5)  0.02 \\times 0.0\\\\\n0.02 \\times (-0.1)  0.02 \\times 0.0  0.02 \\times 1.0\n\\end{pmatrix} = \\begin{pmatrix}\n0.010  0.004  -0.002\\\\\n0.004  -0.030  0.000\\\\\n-0.002  0.000  0.020\n\\end{pmatrix}\n$$\nThis strain tensor is dimensionless, as expected. Now we form the matrix $\\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}$, which represents the linearized deformation gradient.\n$$\n\\mathbf{I} + \\delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix} + \\begin{pmatrix}\n0.010  0.004  -0.002\\\\\n0.004  -0.030  0.000\\\\\n-0.002  0.000  0.020\n\\end{pmatrix} = \\begin{pmatrix}\n1.010  0.004  -0.002\\\\\n0.004  0.970  0.000\\\\\n-0.002  0.000  1.020\n\\end{pmatrix}\n$$\nFinally, we compute the updated cell matrix $\\mathbf{h}^{(1)}$ by applying this deformation to the initial cell matrix $\\mathbf{h}^{(0)}$.\n$$\n\\mathbf{h}^{(1)} = (\\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}) \\mathbf{h}^{(0)} = \\begin{pmatrix}\n1.010  0.004  -0.002\\\\\n0.004  0.970  0.000\\\\\n-0.002  0.000  1.020\n\\end{pmatrix} \\begin{pmatrix}\n3.000  0.200  0.100\\\\\n0.000  4.000  0.300\\\\\n0.000  0.000  5.000\n\\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$h^{(1)}_{11} = (1.010)(3.000) + (0.004)(0.000) + (-0.002)(0.000) = 3.030$\n$h^{(1)}_{21} = (0.004)(3.000) + (0.970)(0.000) + (0.000)(0.000) = 0.012$\n$h^{(1)}_{31} = (-0.002)(3.000) + (0.000)(0.000) + (1.020)(0.000) = -0.006$\n\n$h^{(1)}_{12} = (1.010)(0.200) + (0.004)(4.000) + (-0.002)(0.000) = 0.202 + 0.016 = 0.218$\n$h^{(1)}_{22} = (0.004)(0.200) + (0.970)(4.000) + (0.000)(0.000) = 0.0008 + 3.88 = 3.8808$\n$h^{(1)}_{32} = (-0.002)(0.200) + (0.000)(4.000) + (1.020)(0.000) = -0.0004$\n\n$h^{(1)}_{13} = (1.010)(0.100) + (0.004)(0.300) + (-0.002)(5.000) = 0.101 + 0.0012 - 0.01 = 0.0922$\n$h^{(1)}_{23} = (0.004)(0.100) + (0.970)(0.300) + (0.000)(5.000) = 0.0004 + 0.291 = 0.2914$\n$h^{(1)}_{33} = (-0.002)(0.100) + (0.000)(0.300) + (1.020)(5.000) = -0.0002 + 5.1 = 5.0998$\n\nSo, the updated cell matrix is:\n$$\n\\mathbf{h}^{(1)} = \\begin{pmatrix}\n3.030  0.218  0.0922 \\\\\n0.012  3.8808  0.2914 \\\\\n-0.006  -0.0004  5.0998\n\\end{pmatrix}\\ \\text{Å}\n$$\nThe problem requires rounding each component to four significant figures.\n$h^{(1)}_{11} = 3.030 \\rightarrow 3.030$\n$h^{(1)}_{21} = 0.012 \\rightarrow 0.01200$\n$h^{(1)}_{31} = -0.006 \\rightarrow -0.006000$\n\n$h^{(1)}_{12} = 0.218 \\rightarrow 0.2180$\n$h^{(1)}_{22} = 3.8808 \\rightarrow 3.881$\n$h^{(1)}_{32} = -0.0004 \\rightarrow -0.0004000$\n\n$h^{(1)}_{13} = 0.0922 \\rightarrow 0.09220$\n$h^{(1)}_{23} = 0.2914 \\rightarrow 0.2914$\n$h^{(1)}_{33} = 5.0998 \\rightarrow 5.100$\n\nThe final components, listed in column-major order as requested, are:\nColumn 1: $3.030$, $0.01200$, $-0.006000$\nColumn 2: $0.2180$, $3.881$, $-0.0004000$\nColumn 3: $0.09220$, $0.2914$, $5.100$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.030  0.01200  -0.006000  0.2180  3.881  -0.0004000  0.09220  0.2914  5.100 \\end{pmatrix}}\n$$"
        }
    ]
}