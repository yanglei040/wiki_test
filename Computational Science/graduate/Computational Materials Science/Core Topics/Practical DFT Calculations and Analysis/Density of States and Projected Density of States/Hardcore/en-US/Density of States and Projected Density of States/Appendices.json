{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is a cornerstone of solid-state physics, guiding you through the derivation of the density of states (DOS) for the simplest model of a metal—the free electron gas. By starting from the quantization of states in a box and moving to the continuum limit, this practice builds fundamental intuition for how a system's dimensionality and dispersion relation shape its electronic spectrum. Completing this derivation  provides a crucial baseline for understanding the DOS in more complex, real-world materials.",
            "id": "3443614",
            "problem": "A noninteracting electron gas in three-dimensional (3D) space is confined to a cubic box of edge length $L$ and volume $V=L^3$ with periodic boundary conditions. The one-electron energy dispersion is $E(\\mathbf{k})=\\hbar^2 k^2/(2m)$, where $m$ is the electron mass and $\\mathbf{k}$ is the crystal momentum. The density of states $D(E)$ is defined as the derivative with respect to energy of the number $N(E)$ of one-electron quantum states with energy less than or equal to $E$, i.e., $D(E)=\\mathrm{d}N(E)/\\mathrm{d}E$. The spin degree of freedom leads to a spin degeneracy factor $g_s$ in the absence of spin splitting.\n\nStarting only from the definitions above and the quantization implied by periodic boundary conditions, derive from first principles a closed-form expression for the total density of states $D(E)$ for the electron gas that correctly accounts for spin degeneracy. In your reasoning, explicitly identify how the spin degeneracy factor $g_s$ enters and then specialize to electrons by taking $g_s=2$. Also state, in words, how the spin-projected densities of states $D_{\\uparrow}(E)$ and $D_{\\downarrow}(E)$ relate to the total $D(E)$ in the unpolarized case.\n\nProvide as your final answer the closed-form analytic expression for the total $D(E)$ for electrons (with both spins counted), expressed in terms of $E$, $V$, $m$, and $\\hbar$. Do not include units in your final expression.",
            "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem from fundamental solid-state physics that asks for the derivation of the density of states for a free electron gas. All necessary information is provided, and the terminology is standard and unambiguous. We shall proceed with the derivation from first principles.\n\nThe system is a noninteracting electron gas in a three-dimensional (3D) cubic box of edge length $L$ and volume $V=L^3$. We impose periodic boundary conditions on the one-electron wavefunctions $\\psi(\\mathbf{r})$. The wavefunction for a plane wave is given by $\\psi_{\\mathbf{k}}(\\mathbf{r}) = C \\exp(i\\mathbf{k} \\cdot \\mathbf{r})$, where $\\mathbf{k}$ is the wavevector. The periodic boundary conditions require that the wavefunction is periodic with the dimensions of the box:\n$$\n\\psi(x+L, y, z) = \\psi(x, y, z) \\\\\n\\psi(x, y+L, z) = \\psi(x, y, z) \\\\\n\\psi(x, y, z+L) = \\psi(x, y, z)\n$$\nApplying the first condition to the plane wave solution, we have:\n$$\n\\exp(ik_x(x+L) + ik_y y + ik_z z) = \\exp(ik_x x + ik_y y + ik_z z)\n$$\nThis implies $\\exp(ik_x L) = 1$. This condition is satisfied if $k_x L = 2\\pi n_x$, where $n_x$ is an integer. Applying the same logic to the other two directions, we find that the allowed components of the wavevector $\\mathbf{k}$ are quantized:\n$$\nk_x = n_x \\frac{2\\pi}{L}, \\quad k_y = n_y \\frac{2\\pi}{L}, \\quad k_z = n_z \\frac{2\\pi}{L}\n$$\nwhere $n_x, n_y, n_z$ are any integers ($0, \\pm 1, \\pm 2, \\dots$). These allowed $\\mathbf{k}$ vectors form a discrete cubic grid in reciprocal space (k-space). The separation between adjacent points is $\\Delta k = 2\\pi/L$. The volume in k-space associated with each allowed $\\mathbf{k}$ state is:\n$$\n\\Delta V_k = \\left(\\frac{2\\pi}{L}\\right)^3 = \\frac{8\\pi^3}{L^3} = \\frac{8\\pi^3}{V}\n$$\nTo find the density of states, we first calculate $N(E)$, the total number of single-electron quantum states with energy less than or equal to $E$. The energy dispersion is given as $E(\\mathbf{k}) = \\hbar^2 k^2 / (2m)$, where $k^2 = |\\mathbf{k}|^2 = k_x^2 + k_y^2 + k_z^2$. The condition $E(\\mathbf{k}) \\le E$ defines a sphere in k-space centered at the origin, with a radius $k_E$ given by:\n$$\n\\frac{\\hbar^2 k_E^2}{2m} = E \\implies k_E = \\frac{\\sqrt{2mE}}{\\hbar}\n$$\nFor a large system, the discrete k-points are very closely spaced, and we can treat the distribution of states as a continuum. The number of orbital states (ignoring spin for a moment), $N_{\\text{orb}}(E)$, is found by dividing the volume of this sphere in k-space by the volume per k-state:\n$$\nN_{\\text{orb}}(E) = \\frac{\\text{Volume of k-sphere of radius } k_E}{\\text{Volume per k-state}} = \\frac{\\frac{4}{3}\\pi k_E^3}{\\left(\\frac{2\\pi}{L}\\right)^3}\n$$\nSubstituting $V=L^3$ and the expression for $k_E$:\n$$\nN_{\\text{orb}}(E) = \\frac{\\frac{4}{3}\\pi \\left(\\frac{2mE}{\\hbar^2}\\right)^{3/2}}{\\frac{8\\pi^3}{V}} = \\frac{4\\pi V}{3 \\cdot 8\\pi^3} \\left(\\frac{2mE}{\\hbar^2}\\right)^{3/2} = \\frac{V}{6\\pi^2} \\left(\\frac{2mE}{\\hbar^2}\\right)^{3/2}\n$$\nThis expression counts only the orbital states. Each orbital state can be occupied by an electron with spin-up or spin-down. In the absence of spin-splitting (e.g., no external magnetic field), these two spin states are degenerate in energy. This introduces a spin degeneracy factor, $g_s$. The total number of one-electron quantum states, $N(E)$, including spin, is therefore:\n$$\nN(E) = g_s \\cdot N_{\\text{orb}}(E) = g_s \\frac{V}{6\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{3/2}\n$$\nThe problem explicitly asks how the spin degeneracy factor $g_s$ enters the derivation. As shown above, it enters as a multiplicative factor that accounts for the number of available spin states for each unique spatial (orbital) wavefunction.\n\nThe density of states, $D(E)$, is defined as the derivative of $N(E)$ with respect to energy $E$:\n$$\nD(E) = \\frac{\\mathrm{d}N(E)}{\\mathrm{d}E} = \\frac{\\mathrm{d}}{\\mathrm{d}E} \\left[ g_s \\frac{V}{6\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{3/2} \\right]\n$$\nThe terms multiplying $E^{3/2}$ are constants with respect to $E$. The derivative of $E^{3/2}$ is $\\frac{3}{2}E^{1/2}$. Thus,\n$$\nD(E) = g_s \\frac{V}{6\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} \\left(\\frac{3}{2}E^{1/2}\\right) = g_s \\frac{3V}{12\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{1/2}\n$$\nSimplifying the numerical prefactor gives the general expression for the density of states:\n$$\nD(E) = g_s \\frac{V}{4\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{1/2}\n$$\nFor electrons, which are spin-$1/2$ fermions, the spin degeneracy factor is $g_s=2$. Substituting this value, we obtain the total density of states for an electron gas:\n$$\nD(E) = 2 \\cdot \\frac{V}{4\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{1/2} = \\frac{V}{2\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{1/2}\n$$\nThis is the final analytical expression for the total density of states.\n\nRegarding the spin-projected densities of states, $D_{\\uparrow}(E)$ and $D_{\\downarrow}(E)$, in an unpolarized system: the total density of states $D(E)$ is the sum of the density of states for spin-up electrons and spin-down electrons, i.e., $D(E) = D_{\\uparrow}(E) + D_{\\downarrow}(E)$. In the unpolarized case, there is no energy difference between spin-up and spin-down states. Therefore, the number of available states for spin-up electrons at a given energy $E$ is exactly the same as for spin-down electrons. This implies that their respective densities of states are equal: $D_{\\uparrow}(E) = D_{\\downarrow}(E)$. Consequently, each spin-projected density of states is exactly half of the total density of states: $D_{\\uparrow}(E) = D_{\\downarrow}(E) = \\frac{1}{2}D(E)$. This is equivalent to calculating the density of states with a degeneracy factor of $g_s=1$.",
            "answer": "$$\n\\boxed{\\frac{V}{2\\pi^2}\\left(\\frac{2m}{\\hbar^2}\\right)^{3/2}E^{1/2}}\n$$"
        },
        {
            "introduction": "Moving beyond the parabolic bands of the free electron gas, this practice explores the unique electronic structure of graphene, a material defined by its linear \"Dirac cone\" dispersion. By deriving the density of states for this two-dimensional system, you will uncover the origins of its characteristic V-shaped DOS, which vanishes at the Fermi level in its undoped state. This exercise  also connects this fundamental quantity to a measurable physical property, electronic screening, illustrating how the DOS governs a material's response to electric fields.",
            "id": "3443506",
            "problem": "Consider monolayer graphene described at low energy by the continuum two-dimensional Dirac Hamiltonian with isotropic linear dispersion near each Dirac point. The electronic energy bands are given by $E_{s}(\\mathbf{k}) = s\\,\\hbar v_{F}|\\mathbf{k}|$ with band index $s \\in \\{+1,-1\\}$ for conduction and valence bands, reduced Planck constant $\\hbar$, Fermi velocity $v_{F}$, and wave vector $\\mathbf{k} \\in \\mathbb{R}^{2}$. The system has spin degeneracy $g_{s} = 2$ and valley degeneracy $g_{v} = 2$. \n\nStarting from the fundamental definition of the density of states (DOS) per unit area,\n$$\nD(E) = \\sum_{s}\\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right),\n$$\nderive a closed-form expression for $D(E)$ valid in the low-energy Dirac regime. Then, define the projected density of states (PDOS) onto a single sublattice $A$ as\n$$\nD_{A}(E) = \\sum_{s}\\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\left|\\langle A|\\psi_{s,\\mathbf{k}}\\rangle\\right|^{2}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right),\n$$\nwhere $|\\psi_{s,\\mathbf{k}}\\rangle$ is a normalized Bloch eigenstate in the two-sublattice basis, and use the low-energy Dirac-spinor structure to obtain $D_{A}(E)$ in terms of $D(E)$. Finally, using the static Thomas–Fermi (TF) model of screening in two dimensions and the relation $q_{\\mathrm{TF}} = \\frac{2\\pi e^{2}}{\\epsilon}\\,\\frac{\\partial n}{\\partial \\mu}$ with background dielectric constant $\\epsilon$, elementary charge $e$, carrier density $n$, and chemical potential $\\mu$, express the TF screening wave vector $q_{\\mathrm{TF}}$ in terms of $D(E)$ evaluated at the Fermi energy and discuss the qualitative dependence of screening on the Fermi energy near charge neutrality.\n\nYour final reported result must be the analytic expression for the total DOS $D(E)$ as a function of $E$, $\\hbar$, and $v_{F}$. Express the DOS in the unit convention of “states per square meter per Joule.” Do not provide intermediate steps or any other quantity in the final answer. No rounding is required; give the exact closed-form expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n### Step 1: Problem Validation\n\n**Extracted Givens:**\n-   **System and Model**: Monolayer graphene in the low-energy continuum approximation (2D Dirac Hamiltonian).\n-   **Dispersion Relation**: $E_{s}(\\mathbf{k}) = s\\,\\hbar v_{F}|\\mathbf{k}|$, where $s \\in \\{+1,-1\\}$ is the band index, $\\hbar$ is the reduced Planck constant, $v_{F}$ is the Fermi velocity, and $\\mathbf{k} \\in \\mathbb{R}^{2}$ is the wave vector.\n-   **Degeneracies**: Spin degeneracy $g_{s} = 2$, valley degeneracy $g_{v} = 2$.\n-   **Definition of Total DOS per Unit Area**: Implicitly defined by scaling the provided definition, $D(E) = g_{s}g_{v}\\sum_{s}\\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right)$.\n-   **Definition of PDOS onto Sublattice A**: $D_{A}(E) = \\sum_{s}\\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\left|\\langle A|\\psi_{s,\\mathbf{k}}\\rangle\\right|^{2}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right)$.\n-   **Eigenstate Property**: $|\\psi_{s,\\mathbf{k}}\\rangle$ is a normalized Bloch eigenstate in the two-sublattice basis, with a structure determined by the low-energy Dirac Hamiltonian.\n-   **Thomas–Fermi (TF) Screening Wave Vector**: $q_{\\mathrm{TF}} = \\frac{2\\pi e^{2}}{\\epsilon}\\,\\frac{\\partial n}{\\partial \\mu}$, with $e$ as the elementary charge, $\\epsilon$ as the background dielectric constant, $n$ as the carrier density, and $\\mu$ as the chemical potential.\n-   **Final Deliverable**: An analytic expression for the total DOS $D(E)$ in terms of $E$, $\\hbar$, and $v_{F}$.\n\n**Validation Verdict:**\nThe problem is **valid**. It is based on standard, well-established models and concepts in condensed matter physics (the Dirac model for graphene, density of states, and Thomas-Fermi screening). The problem is self-contained, mathematically formalizable, and well-posed, providing all necessary definitions and parameters to derive the requested quantities. It does not violate any scientific principles and is a standard problem in the field.\n\n### Step 2: Derivation of the Solution\n\n**Part 1: Total Density of States (DOS)**\n\nWe begin with the definition of the total density of states per unit area, $D(E)$, which includes spin ($g_s=2$) and valley ($g_v=2$) degeneracies.\n$$\nD(E) = g_{s} g_{v} \\sum_{s=\\pm 1} \\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right)\n$$\nSubstituting the given values and the dispersion relation $E_{s}(\\mathbf{k}) = s\\hbar v_{F}|\\mathbf{k}|$, where we let $k=|\\mathbf{k}|$:\n$$\nD(E) = 4 \\sum_{s=\\pm 1} \\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\delta\\!\\left(E - s\\hbar v_{F}k\\right)\n$$\nThe integral is over the two-dimensional $\\mathbf{k}$-space. We convert to polar coordinates, where $d^{2}\\mathbf{k} = k\\,dk\\,d\\phi$. The integrand is independent of the angle $\\phi$, so integrating from $\\phi=0$ to $\\phi=2\\pi$ yields a factor of $2\\pi$.\n$$\nD(E) = 4 \\sum_{s=\\pm 1} \\frac{2\\pi}{(2\\pi)^2} \\int_{0}^{\\infty} k\\,\\delta\\!\\left(E - s\\hbar v_{F}k\\right)\\,dk = \\frac{2}{\\pi} \\sum_{s=\\pm 1} \\int_{0}^{\\infty} k\\,\\delta\\!\\left(E - s\\hbar v_{F}k\\right)\\,dk\n$$\nTo evaluate the integral, we use the property of the Dirac delta function: $\\int g(x)\\delta(f(x))dx = \\sum_i \\frac{g(x_i)}{|f'(x_i)|}$, where $x_i$ are the roots of $f(x)=0$.\nHere, the integration variable is $k$, the function in the delta is $f(k) = E - s\\hbar v_{F}k$, and $g(k)=k$. The root $k_0$ of $f(k)$ is $k_0 = \\frac{E}{s\\hbar v_{F}}$. For the integral to be non-zero, the root must lie in the domain of integration, i.e., $k_0  0$. This condition implies that $E$ and $s$ must have the same sign.\nThe derivative is $f'(k) = -s\\hbar v_{F}$, so its absolute value is $|f'(k)| = \\hbar v_{F}$.\n\nThe value of the integral for a fixed $s$ is $\\frac{g(k_0)}{|f'(k_0)|} = \\frac{k_0}{\\hbar v_{F}} = \\frac{E/(s\\hbar v_{F})}{\\hbar v_{F}} = \\frac{E}{s(\\hbar v_{F})^{2}}$, provided $E/s  0$.\n\nNow we perform the summation over $s$:\n-   If $E  0$, only the $s=+1$ (conduction band) term contributes. The sum gives $\\frac{E}{+(\\hbar v_{F})^{2}} = \\frac{E}{(\\hbar v_{F})^{2}}$.\n-   If $E  0$, only the $s=-1$ (valence band) term contributes. The sum gives $\\frac{E}{-(\\hbar v_{F})^{2}} = \\frac{-E}{(\\hbar v_{F})^{2}} = \\frac{|E|}{(\\hbar v_{F})^{2}}$.\n-   If $E = 0$, the DOS is $0$.\n\nCombining these cases, the sum is $\\frac{|E|}{(\\hbar v_{F})^{2}}$ for any $E \\neq 0$.\nSubstituting this back into the expression for $D(E)$:\n$$\nD(E) = \\frac{2}{\\pi} \\frac{|E|}{(\\hbar v_{F})^{2}}\n$$\nThis expression describes the characteristic V-shaped density of states of ideal graphene, which is linear in energy and vanishes at the Dirac point ($E=0$). The units are states per unit energy per unit area. In SI units, this is states per Joule per square meter, as requested.\n\n**Part 2: Projected Density of States (PDOS)**\n\nThe PDOS on sublattice A, $D_{A}(E)$, requires the projection of the eigenstate $|\\psi_{s,\\mathbf{k}}\\rangle$ onto the sublattice-A basis state, $|A\\rangle$. The low-energy Hamiltonian for a single valley (e.g., $K$) can be written as $H_{\\mathbf{k}} = \\hbar v_{F} (k_x\\sigma_x + k_y\\sigma_y) = \\hbar v_F k \\begin{pmatrix} 0  e^{-i\\phi_{\\mathbf{k}}} \\\\ e^{i\\phi_{\\mathbf{k}}}  0 \\end{pmatrix}$, where $\\phi_{\\mathbf{k}}$ is the polar angle of vector $\\mathbf{k}$.\nThe normalized eigenvector for an energy eigenvalue $E_s(\\mathbf{k})=s\\hbar v_F k$ is a two-component spinor representing the amplitudes on the two sublattices (A and B):\n$$\n|\\psi_{s,\\mathbf{k}}\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} e^{-i\\phi_{\\mathbf{k}}} \\\\ s \\end{pmatrix}\n$$\nThe projection weight onto sublattice A is the squared modulus of the first component:\n$$\n|\\langle A|\\psi_{s,\\mathbf{k}}\\rangle|^2 = \\left| \\frac{1}{\\sqrt{2}} e^{-i\\phi_{\\mathbf{k}}} \\right|^2 = \\frac{1}{2}\n$$\nThis result is independent of the band index $s$ and the wave vector $\\mathbf{k}$. This signifies that electron density is equally shared between the two sublattices.\nThe total PDOS on sublattice A, including degeneracies, is given by:\n$$\nD_{A, \\text{total}}(E) = g_{s} g_{v} \\sum_{s} \\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\left|\\langle A|\\psi_{s,\\mathbf{k}}\\rangle\\right|^{2}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right)\n$$\nSubstituting $|\\langle A|\\psi_{s,\\mathbf{k}}\\rangle|^2 = \\frac{1}{2}$:\n$$\nD_{A, \\text{total}}(E) = \\frac{1}{2} \\left[ g_{s} g_{v} \\sum_{s} \\int \\frac{d^{2}\\mathbf{k}}{(2\\pi)^{2}}\\,\\delta\\!\\left(E - E_{s}(\\mathbf{k})\\right) \\right]\n$$\nThe expression in the brackets is precisely the total DOS, $D(E)$. Therefore,\n$$\nD_{A, \\text{total}}(E) = \\frac{1}{2} D(E)\n$$\nAs expected, the PDOS on one sublattice is exactly half of the total DOS.\n\n**Part 3: Thomas-Fermi Screening**\n\nThe TF screening wave vector is $q_{\\mathrm{TF}} = \\frac{2\\pi e^{2}}{\\epsilon}\\,\\frac{\\partial n}{\\partial \\mu}$. We need to relate $\\frac{\\partial n}{\\partial \\mu}$ to the DOS. At zero temperature, the carrier density $n$ (number of electrons added or holes created per unit area) relative to the charge-neutral system is given by the integral of the DOS from the Dirac point ($E=0$) to the chemical potential $\\mu$:\n$$\nn(\\mu) = \\int_{0}^{\\mu} D(E')\\,dE'\n$$\nThis definition holds for both electron doping ($\\mu  0$) and hole doping ($\\mu  0$), where for $\\mu  0$ the integral is negative, representing a deficit of electrons (i.e., a density of holes). The quantity $n$ in the TF formula refers to the density of charge carriers, which changes as $\\mu$ changes. We can find the rate of change using the Fundamental Theorem of Calculus:\n$$\n\\frac{\\partial n}{\\partial \\mu} = D(\\mu)\n$$\nThis important result states that the compressibility of the electron gas at the Fermi level is directly proportional to the DOS at the Fermi level.\nSubstituting this into the expression for $q_{\\mathrm{TF}}$:\n$$\nq_{\\mathrm{TF}} = \\frac{2\\pi e^{2}}{\\epsilon} D(\\mu)\n$$\nNow we can use our result for $D(E)$:\n$$\nq_{\\mathrm{TF}} = \\frac{2\\pi e^{2}}{\\epsilon} \\left( \\frac{2|\\mu|}{\\pi(\\hbar v_{F})^{2}} \\right) = \\frac{4e^{2}|\\mu|}{\\epsilon(\\hbar v_{F})^{2}}\n$$\nThis expression reveals the qualitative dependence of screening on the Fermi energy ($\\mu$). The screening wave vector $q_{\\mathrm{TF}}$ is directly proportional to the absolute value of the chemical potential, $|\\mu|$.\nNear the charge neutrality point, where $\\mu \\to 0$, we have $q_{\\mathrm{TF}} \\to 0$. The screening length is $\\lambda_{\\mathrm{TF}} = q_{\\mathrm{TF}}^{-1}$. This means that as we approach the Dirac point, the screening length diverges, and screening becomes progressively weaker. This is in stark contrast to conventional two-dimensional electron gases with parabolic dispersion, where the DOS is constant, leading to a screening wave vector that is independent of the chemical potential. The tunable, carrier-density-dependent screening is a hallmark of graphene's electronic properties.",
            "answer": "$$\n\\boxed{\\frac{2|E|}{\\pi(\\hbar v_{F})^{2}}}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between abstract theory and computational implementation, a core competency in modern materials science. You will construct and analyze a simplified tight-binding model for a cubic perovskite, calculating the projected density of states (PDOS) to identify which atomic orbitals contribute to the electronic states near the Fermi level. This exercise  demonstrates how PDOS is used to interpret complex band structures, offering vital clues about chemical bonding, hybridization, and a material's potential electronic and magnetic properties.",
            "id": "2387879",
            "problem": "Construct a minimal, physically grounded tight-binding (TB) model to compute the orbital-resolved projected density of states (PDOS) near the Fermi level for a cubic perovskite representative of strontium vanadate, with chemical formula $\\mathrm{SrVO}_3$. Use a single-orbital-per-element basis $\\{ \\lvert \\mathrm{V}\\,d \\rangle, \\lvert \\mathrm{O}\\,p \\rangle, \\lvert \\mathrm{Sr}\\,s \\rangle \\}$ per primitive cell to capture the dominant orbital characters and their hybridizations. Assume a simple cubic Bravais lattice with lattice constant set to $a=1$ for convenience. Let crystal momentum be $\\mathbf{k}=(k_x,k_y,k_z)$ in the first Brillouin zone (BZ), taken as $k_x,k_y,k_z \\in [-\\pi,\\pi)$ with angles in radians.\n\nDefine the $3\\times 3$ Bloch Hamiltonian $H(\\mathbf{k})$ in the orbital basis above as\n$$\nH(\\mathbf{k})=\n\\begin{pmatrix}\n\\varepsilon_d + 2 t_{dd} S(\\mathbf{k})  V_{dp}\\, C(\\mathbf{k})  V_{ds}\\, C(\\mathbf{k}) \\\\\nV_{dp}\\, C(\\mathbf{k})  \\varepsilon_p + 2 t_{pp} S(\\mathbf{k})  0 \\\\\nV_{ds}\\, C(\\mathbf{k})  0  \\varepsilon_s + 2 t_{ss} S(\\mathbf{k})\n\\end{pmatrix},\n$$\nwith structure factors\n$$\nS(\\mathbf{k})=\\cos k_x + \\cos k_y + \\cos k_z,\\qquad\nC(\\mathbf{k})=\\frac{\\sin k_x + \\sin k_y + \\sin k_z}{\\sqrt{3}}.\n$$\nHere $\\varepsilon_d,\\varepsilon_p,\\varepsilon_s$ are on-site energies (in electronvolts), $t_{dd},t_{pp},t_{ss}$ are nearest-neighbor hopping amplitudes (in electronvolts), and $V_{dp},V_{ds}$ are inter-orbital hybridizations (in electronvolts) that carry the odd-parity structure factor $C(\\mathbf{k})$. All energies must be treated in electronvolts ($\\mathrm{eV}$).\n\nLet the Fermi energy be $E_F=0\\,\\mathrm{eV}$. Define the orbital-resolved weight within an energy window of half-width $W$ about $E_F$ as\n$$\nW_\\alpha = \\frac{1}{N_k^3}\\sum_{k_x,k_y,k_z}\\sum_{n=1}^{3} \\left|u_{\\alpha n}(\\mathbf{k})\\right|^2 \\,\\Theta\\!\\left(W - \\left|E_n(\\mathbf{k})-E_F\\right|\\right),\n$$\nwhere $E_n(\\mathbf{k})$ and $u_{\\alpha n}(\\mathbf{k})$ are the eigenvalues and eigenvector components (normalized so that $\\sum_\\alpha |u_{\\alpha n}|^2=1$) of $H(\\mathbf{k})$, $\\Theta$ is the Heaviside step function, $\\alpha \\in \\{\\mathrm{V},\\mathrm{O},\\mathrm{Sr}\\}$ indexes the orbital basis in the order $\\{\\lvert \\mathrm{V}\\,d\\rangle, \\lvert \\mathrm{O}\\,p\\rangle, \\lvert \\mathrm{Sr}\\,s\\rangle\\}$, and the sum over $\\mathbf{k}$ is taken on a uniform grid of $N_k\\times N_k\\times N_k$ points with $N_k=21$. Define the PDOS fractions near the Fermi level as\n$$\nf_\\alpha =\n\\begin{cases}\n\\dfrac{W_\\alpha}{W_{\\mathrm{V}}+W_{\\mathrm{O}}+W_{\\mathrm{Sr}}},  \\text{if } W_{\\mathrm{V}}+W_{\\mathrm{O}}+W_{\\mathrm{Sr}} > 0, \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\nfor $\\alpha \\in \\{\\mathrm{Sr},\\mathrm{V},\\mathrm{O}\\}$. Report the ordered triple $\\bigl[f_{\\mathrm{Sr}},f_{\\mathrm{V}},f_{\\mathrm{O}}\\bigr]$ for each parameter set below, rounded to three decimal places. If no eigenvalues fall within the energy window (that is, $W_{\\mathrm{V}}+W_{\\mathrm{O}}+W_{\\mathrm{Sr}}=0$), return $\\bigl[0.000,0.000,0.000\\bigr]$ for that case. Use an energy half-width $W=0.5\\,\\mathrm{eV}$.\n\nUse the following test suite of parameter sets (all energies in $\\mathrm{eV}$):\n\n- Case $T_1$ (baseline mixing):\n  - $\\varepsilon_d=0.0$, $t_{dd}=-0.4$,\n  - $\\varepsilon_p=-3.0$, $t_{pp}=-0.2$,\n  - $V_{dp}=1.0$,\n  - $\\varepsilon_s=6.0$, $t_{ss}=0.2$,\n  - $V_{ds}=0.0$.\n\n- Case $T_2$ (decoupled $d$–$p$):\n  - Same as $T_1$ except $V_{dp}=0.0$.\n\n- Case $T_3$ (enhanced $d$–$p$ hybridization near $E_F$):\n  - $\\varepsilon_d=0.0$, $t_{dd}=-0.4$,\n  - $\\varepsilon_p=-1.0$, $t_{pp}=-0.2$,\n  - $V_{dp}=1.2$,\n  - $\\varepsilon_s=6.0$, $t_{ss}=0.2$,\n  - $V_{ds}=0.0$.\n\n- Case $T_4$ (bands far from $E_F$, no states in window):\n  - $\\varepsilon_d=4.0$, $t_{dd}=-0.1$,\n  - $\\varepsilon_p=-4.0$, $t_{pp}=-0.1$,\n  - $V_{dp}=0.5$,\n  - $\\varepsilon_s=8.0$, $t_{ss}=0.1$,\n  - $V_ds=0.0$.\n\nYour program must compute the PDOS fractions $\\bigl[f_{\\mathrm{Sr}},f_{\\mathrm{V}},f_{\\mathrm{O}}\\bigr]$ for each case using the definitions above, with the BZ sampled on a uniform grid of $N_k=21$ points along each reciprocal direction and $W=0.5\\,\\mathrm{eV}$. Angles must be in radians. Energies must be in electronvolts.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of lists in the order $\\bigl[T_1,T_2,T_3,T_4\\bigr]$, where each list is the ordered triple $\\bigl[f_{\\mathrm{Sr}},f_{\\mathrm{V}},f_{\\mathrm{O}}\\bigr]$ rounded to three decimal places. For example: $\\bigl[[0.000,0.950,0.050],[\\dots],\\dots\\,\\bigr]$.",
            "solution": "The problem statement is subjected to validation and is found to be valid. It presents a well-posed problem in computational condensed matter physics, grounded in the established principles of tight-binding theory. All necessary parameters, definitions, and mathematical structures are provided completely and without contradiction. The task is to compute the orbital-resolved projected density of states (PDOS) for a simplified model of a perovskite, which is a standard and meaningful exercise in this field.\n\nThe objective is to calculate the fractional contribution of each orbital type—vanadium $d$-orbital ($\\lvert \\mathrm{V}\\,d \\rangle$), oxygen $p$-orbital ($\\lvert \\mathrm{O}\\,p \\rangle$), and strontium $s$-orbital ($\\lvert \\mathrm{Sr}\\,s \\rangle$)—to the electronic states within a small energy window around the Fermi level, $E_F$. The problem defines this window as $[E_F - W, E_F + W]$, with $E_F=0\\,\\mathrm{eV}$ and half-width $W=0.5\\,\\mathrm{eV}$.\n\nThe core of the calculation involves diagonalizing the momentum-dependent $3 \\times 3$ Bloch Hamiltonian $H(\\mathbf{k})$ over a discrete grid of crystal momentum vectors $\\mathbf{k}$ spanning the first Brillouin zone (BZ). The BZ is defined as a cube with $k_x, k_y, k_z \\in [-\\pi, \\pi)$. This continuous space is approximated by a uniform grid of $N_k \\times N_k \\times N_k$ points, where $N_k=21$.\n\nFor each $\\mathbf{k}$ point on the grid, we perform the following steps:\n$1$. Construct the Hamiltonian matrix $H(\\mathbf{k})$ using the provided parameters $(\\varepsilon_\\alpha, t_{\\alpha\\beta}, V_{\\alpha\\beta})$ and the structure factors $S(\\mathbf{k})$ and $C(\\mathbf{k})$.\n$$\nH(\\mathbf{k})=\n\\begin{pmatrix}\n\\varepsilon_d + 2 t_{dd} S(\\mathbf{k})  V_{dp}\\, C(\\mathbf{k})  V_{ds}\\, C(\\mathbf{k}) \\\\\nV_{dp}\\, C(\\mathbf{k})  \\varepsilon_p + 2 t_{pp} S(\\mathbf{k})  0 \\\\\nV_{ds}\\, C(\\mathbf{k})  0  \\varepsilon_s + 2 t_{ss} S(\\mathbf{k})\n\\end{pmatrix}\n$$\nThe basis is ordered as $\\{\\lvert \\mathrm{V}\\,d\\rangle, \\lvert \\mathrm{O}\\,p\\rangle, \\lvert \\mathrm{Sr}\\,s\\rangle\\}$. Since all parameters are real, $H(\\mathbf{k})$ is a real symmetric matrix, which is a special case of a Hermitian matrix.\n\n$2$. Diagonalize $H(\\mathbf{k})$ to obtain its three real eigenvalues $E_n(\\mathbf{k})$ and the corresponding orthonormal eigenvectors $\\mathbf{u}_n(\\mathbf{k})$ for band indices $n=1,2,3$. The eigenvector $\\mathbf{u}_n(\\mathbf{k})$ is a column vector whose components, $u_{\\alpha n}(\\mathbf{k})$, give the projection of the Bloch state onto the orbital basis functions. The normalization condition $\\sum_{\\alpha} |u_{\\alpha n}(\\mathbf{k})|^2 = 1$ is satisfied by standard numerical diagonalization routines.\n\n$3$. For each eigenstate $(\\mathbf{k}, n)$, we check if its energy $E_n(\\mathbf{k})$ falls within the specified window, i.e., $|E_n(\\mathbf{k}) - E_F| \\le W$.\n\n$4$. If the state is within the window, its contribution to the density of states for each orbital $\\alpha$ is given by the squared magnitude of the corresponding eigenvector component, $|u_{\\alpha n}(\\mathbf{k})|^2$. These contributions are summed over all states $(\\mathbf{k}, n)$ that satisfy the energy condition. This yields the total un-normalized weight for each orbital, which we may denote $W'_{\\alpha}$:\n$$\nW'_{\\alpha} = \\sum_{\\mathbf{k},n} |u_{\\alpha n}(\\mathbf{k})|^2 \\, \\Theta(W - |E_n(\\mathbf{k}) - E_F|)\n$$\nThe normalization factor $1/N_k^3$ from the problem's definition of $W_\\alpha$ is a common scaling for all orbitals and will cancel when calculating the fractions.\n\n$5$. After summing over all $\\mathbf{k}$-points, we obtain the total integrated weights $W'_{\\mathrm{V}}$, $W'_{\\mathrm{O}}$, and $W'_{\\mathrm{Sr}}$. The total weight is $W'_{\\text{total}} = W'_{\\mathrm{V}} + W'_{\\mathrm{O}} + W'_{\\mathrm{Sr}}$.\n\n$6$. Finally, the PDOS fractions $f_\\alpha$ are calculated by normalizing the individual orbital weights by the total weight: $f_\\alpha = W'_{\\alpha} / W'_{\\text{total}}$. If $W'_{\\text{total}}$ is zero (meaning no states were found in the energy window), all fractions are defined as zero.\n\nThe final output for each test case is the ordered triple $[f_{\\mathrm{Sr}}, f_{\\mathrm{V}}, f_{\\mathrm{O}}]$, with each value rounded to three decimal places. This entire procedure is repeated for each of the four parameter sets provided. The implementation will utilize `numpy` for efficient array operations and for the diagonalization of the Hamiltonian via `numpy.linalg.eigh`.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the orbital-resolved projected density of states (PDOS) fractions\n    for a tight-binding model of a cubic perovskite.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    N_k = 21\n    W = 0.5\n    E_F = 0.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case T1 (baseline mixing)\n        {\n            'eps_d': 0.0, 't_dd': -0.4,\n            'eps_p': -3.0, 't_pp': -0.2,\n            'V_dp': 1.0,\n            'eps_s': 6.0, 't_ss': 0.2,\n            'V_ds': 0.0,\n        },\n        # Case T2 (decoupled d–p)\n        {\n            'eps_d': 0.0, 't_dd': -0.4,\n            'eps_p': -3.0, 't_pp': -0.2,\n            'V_dp': 0.0,\n            'eps_s': 6.0, 't_ss': 0.2,\n            'V_ds': 0.0,\n        },\n        # Case T3 (enhanced d–p hybridization near EF)\n        {\n            'eps_d': 0.0, 't_dd': -0.4,\n            'eps_p': -1.0, 't_pp': -0.2,\n            'V_dp': 1.2,\n            'eps_s': 6.0, 't_ss': 0.2,\n            'V_ds': 0.0,\n        },\n        # Case T4 (bands far from EF, no states in window)\n        {\n            'eps_d': 4.0, 't_dd': -0.1,\n            'eps_p': -4.0, 't_pp': -0.1,\n            'V_dp': 0.5,\n            'eps_s': 8.0, 't_ss': 0.1,\n            'V_ds': 0.0,\n        },\n    ]\n\n    all_results = []\n\n    # Generate the k-point grid for the first Brillouin Zone\n    # k_x, k_y, k_z are in [-pi, pi)\n    k_points = np.linspace(-np.pi, np.pi, N_k, endpoint=False)\n    sqrt3 = np.sqrt(3.0)\n\n    for params in test_cases:\n        # Extract parameters for the current case\n        eps_d, t_dd = params['eps_d'], params['t_dd']\n        eps_p, t_pp = params['eps_p'], params['t_pp']\n        eps_s, t_ss = params['eps_s'], params['t_ss']\n        V_dp, V_ds = params['V_dp'], params['V_ds']\n        \n        # Initialize accumulated weights for V, O, Sr orbitals\n        W_V, W_O, W_Sr = 0.0, 0.0, 0.0\n\n        # Iterate over all k-points in the 3D grid\n        for kx in k_points:\n            for ky in k_points:\n                for kz in k_points:\n                    # Calculate structure factors S(k) and C(k)\n                    S_k = np.cos(kx) + np.cos(ky) + np.cos(kz)\n                    C_k = (np.sin(kx) + np.sin(ky) + np.sin(kz)) / sqrt3\n                    \n                    # Construct the 3x3 Hamiltonian matrix H(k)\n                    # Basis order: {V_d, O_p, Sr_s}\n                    H = np.zeros((3, 3), dtype=np.float64)\n                    H[0, 0] = eps_d + 2.0 * t_dd * S_k\n                    H[1, 1] = eps_p + 2.0 * t_pp * S_k\n                    H[2, 2] = eps_s + 2.0 * t_ss * S_k\n                    H[0, 1] = H[1, 0] = V_dp * C_k\n                    H[0, 2] = H[2, 0] = V_ds * C_k\n                    # H[1, 2] = H[2, 1] = 0.0 is implicit\n                    \n                    # Diagonalize the Hermitian matrix to find eigenvalues and eigenvectors\n                    evals, evecs = np.linalg.eigh(H)\n                    \n                    # Iterate over the 3 bands (eigenstates)\n                    for n in range(3):\n                        # Check if eigenvalue is within the energy window [E_F - W, E_F + W]\n                        if np.abs(evals[n] - E_F) = W:\n                            # Accumulate squared eigenvector components (orbital weights)\n                            # evecs are normalized columns: evecs[:, n] is the nth eigenvector\n                            # evecs[0, n] - V_d component\n                            # evecs[1, n] - O_p component\n                            # evecs[2, n] - Sr_s component\n                            W_V += evecs[0, n]**2\n                            W_O += evecs[1, n]**2\n                            W_Sr += evecs[2, n]**2\n                            \n        # Calculate total weight\n        W_total = W_V + W_O + W_Sr\n\n        # Calculate PDOS fractions, handling the case of zero total weight\n        if W_total > 1e-12: # Use a tolerance for float comparison\n            f_V = W_V / W_total\n            f_O = W_O / W_total\n            f_Sr = W_Sr / W_total\n        else:\n            f_V, f_O, f_Sr = 0.0, 0.0, 0.0\n            \n        # Append the ordered triple [f_Sr, f_V, f_O] for the current case\n        all_results.append([f_Sr, f_V, f_O])\n\n    # Format the final output string as specified: [[...],[...],...]\n    # Each number is rounded to three decimal places without trailing zeros if not needed.\n    # The f-string formatting ensures exactly three decimal places.\n    inner_lists_str = []\n    for res in all_results:\n        # res is [f_Sr, f_V, f_O]\n        inner_lists_str.append(f\"[{res[0]:.3f},{res[1]:.3f},{res[2]:.3f}]\")\n    \n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}