{
    "hands_on_practices": [
        {
            "introduction": "A credible surrogate model must obey the same fundamental principles as the physical system it represents. One of the most basic principles in continuum mechanics is objectivity, or frame indifference, which states that material behavior cannot depend on the observer's rigid-body motion. This hands-on practice  challenges you to test whether a surrogate constitutive model respects this crucial symmetry by quantifying its response to a rotation of the coordinate system. You will learn to diagnose and measure objectivity violations, a critical skill for developing reliable and physically consistent ML surrogates.",
            "id": "3540297",
            "problem": "You are given a surrogate constitutive mapping that predicts the Cauchy stress tensor from a small-strain tensor in three dimensions. The purpose is to assess the objectivity (frame indifference) of the surrogate by checking its invariance under proper orthogonal transformations. Objectivity requires that for any proper orthogonal rotation matrix $\\mathbf{Q}$ (that is, $\\mathbf{Q} \\in \\mathbb{R}^{3 \\times 3}$ with $\\mathbf{Q}^T \\mathbf{Q} = \\mathbf{I}$ and $\\det(\\mathbf{Q}) = +1$) and any symmetric small-strain tensor $\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^{3 \\times 3}$, a constitutive mapping $\\boldsymbol{\\sigma}(\\cdot)$ must satisfy $\\boldsymbol{\\sigma}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\mathbf{Q}\\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon})\\mathbf{Q}^T$. Violations of this identity quantify a lack of objectivity.\n\nThe surrogate to be tested is defined as follows. For any symmetric small-strain tensor $\\boldsymbol{\\varepsilon}$,\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\n=\n\\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I}\n\\;+\\;\n2 \\mu \\, \\boldsymbol{\\varepsilon}\n\\;+\\;\nb \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A},\n$$\nwhere $\\lambda$ and $\\mu$ are Lamé parameters, $\\mathbf{I}$ is the identity tensor, $b$ is a scalar bias coefficient, and $\\mathbf{A}$ is a fixed symmetric traceless tensor that encodes a basis-pinned modeling bias. The fixed tensor is\n$$\n\\mathbf{A} = \\mathrm{diag}\\!\\left(\\tfrac{2}{3}, -\\tfrac{1}{3}, -\\tfrac{1}{3}\\right).\n$$\nPhysical units and parameters are:\n- Lamé parameter $\\lambda = 4.0 \\times 10^{10} \\ \\mathrm{Pa}$,\n- Lamé parameter $\\mu = 3.0 \\times 10^{10} \\ \\mathrm{Pa}$,\n- Bias coefficient $b = 5.0 \\times 10^{8} \\ \\mathrm{Pa}$.\nStrain $\\boldsymbol{\\varepsilon}$ is dimensionless. Stress $\\boldsymbol{\\sigma}_{\\text{pred}}$ is in $\\mathrm{Pa}$.\n\nFor any given rotation matrix $\\mathbf{Q}$ and strain tensor $\\boldsymbol{\\varepsilon}$, define the objectivity violation measure as the Frobenius norm (FN) of the difference between the stress predicted on the rotated strain and the rotated predicted stress:\n$$\nE(\\mathbf{Q}, \\boldsymbol{\\varepsilon}) \\equiv \\left\\| \\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;-\\; \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T \\right\\|_F,\n$$\nexpressed in $\\mathrm{Pa}$.\n\nYour task is to write a program that evaluates $E(\\mathbf{Q}, \\boldsymbol{\\varepsilon})$ for the following test suite. Angles are specified in radians and rotations are about the $z$-axis. The rotation matrix about the $z$-axis by angle $\\theta$ is\n$$\n\\mathbf{Q}_z(\\theta) =\n\\begin{bmatrix}\n\\cos(\\theta) & -\\sin(\\theta) & 0 \\\\\n\\sin(\\theta) & \\cos(\\theta)  & 0 \\\\\n0            & 0             & 1\n\\end{bmatrix}.\n$$\nThe test suite consists of five cases:\n- Case $1$ (happy path, identity rotation): $\\theta = 0$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}\\!\\left(1.2\\times 10^{-3},\\, -0.3\\times 10^{-3},\\, -0.3\\times 10^{-3}\\right)$.\n- Case $2$ (nontrivial rotation with volumetric strain): $\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}\\!\\left(1.2\\times 10^{-3},\\, -0.3\\times 10^{-3},\\, -0.3\\times 10^{-3}\\right)$.\n- Case $3$ (trace-free shear edge case): $\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_2$ with components $(\\boldsymbol{\\varepsilon}_2)_{12} = (\\boldsymbol{\\varepsilon}_2)_{21} = 5.0\\times 10^{-4}$ and all other components equal to $0$.\n- Case $4$ (hydrostatic strain under nontrivial rotation): $\\theta = \\tfrac{\\pi}{3}$, $\\boldsymbol{\\varepsilon}_3 = 1.0\\times 10^{-4} \\, \\mathbf{I}$.\n- Case $5$ (zero-strain boundary): $\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_4 = \\mathbf{0}$.\n\nAll five cases must be evaluated in the order listed. Your program must:\n- Construct $\\mathbf{Q} = \\mathbf{Q}_z(\\theta)$ for the specified $\\theta$,\n- Construct the specified $\\boldsymbol{\\varepsilon}$,\n- Compute $E(\\mathbf{Q}, \\boldsymbol{\\varepsilon})$ using the surrogate $\\boldsymbol{\\sigma}_{\\text{pred}}$ above,\n- Return the five values of $E$ in $\\mathrm{Pa}$.\n\nExpress the final results in Pascals (in $\\mathrm{Pa}$) as floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5]\"), where each $x_i$ corresponds to the value of $E$ for Case $i$ in the order listed above.",
            "solution": "The problem is to assess the objectivity of a surrogate constitutive model in continuum mechanics. A constitutive model is objective (or frame-indifferent) if its form is invariant under rigid body rotations of the spatial frame of reference. For a Cauchy stress tensor $\\boldsymbol{\\sigma}$ as a function of a small-strain tensor $\\boldsymbol{\\varepsilon}$, this principle is formally expressed by the identity $\\boldsymbol{\\sigma}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\mathbf{Q}\\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon})\\mathbf{Q}^T$ for any proper orthogonal rotation tensor $\\mathbf{Q}$. The problem asks us to quantify the violation of this identity for a specific surrogate model.\n\nThe surrogate model is given by\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon}) = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, \\boldsymbol{\\varepsilon} \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A}\n$$\nwhere $\\lambda$ and $\\mu$ are Lamé parameters, $\\mathbf{I}$ is the identity tensor, $b$ is a bias coefficient, and $\\mathbf{A}$ is a fixed, basis-pinned symmetric traceless tensor. The standard part of this model, $\\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$, represents isotropic linear elasticity and is known to be objective. The additional term $b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A}$ is a modeling bias, and we will analyze its effect on objectivity.\n\nThe measure of objectivity violation is defined as the Frobenius norm of the difference tensor $\\boldsymbol{\\Delta}$:\n$$\nE(\\mathbf{Q}, \\boldsymbol{\\varepsilon}) \\equiv \\| \\boldsymbol{\\Delta} \\|_F = \\left\\| \\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;-\\; \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T \\right\\|_F\n$$\n\nLet us derive a simplified expression for $\\boldsymbol{\\Delta}$. Let $\\boldsymbol{\\varepsilon}' = \\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T$. The first term in the norm is:\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon}') = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}') \\, \\mathbf{I} \\;+\\; 2 \\mu \\, \\boldsymbol{\\varepsilon}' \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}') \\, \\mathbf{A}\n$$\nA key property of the trace operator is its invariance under cyclic permutations, which for an orthogonal tensor $\\mathbf{Q}$ implies $\\mathrm{tr}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\mathrm{tr}(\\boldsymbol{\\varepsilon}\\mathbf{Q}^T\\mathbf{Q}) = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$. Therefore, $\\mathrm{tr}(\\boldsymbol{\\varepsilon}') = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$. Substituting this and the definition of $\\boldsymbol{\\varepsilon}'$ gives:\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, (\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A}\n$$\n\nThe second term in the norm is:\n$$\n\\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T = \\mathbf{Q} \\left( \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, \\boldsymbol{\\varepsilon} \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A} \\right) \\mathbf{Q}^T\n$$\nDistributing $\\mathbf{Q}$ and $\\mathbf{Q}^T$ and using the fact that $\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^T = \\mathbf{I}$, we get:\n$$\n\\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, (\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, (\\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T)\n$$\n\nNow, we compute the difference tensor $\\boldsymbol{\\Delta}$:\n$$\n\\boldsymbol{\\Delta} = \\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) - \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T\n$$\n$$\n\\boldsymbol{\\Delta} = \\left( \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} + 2 \\mu \\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T + b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{A} \\right) - \\left( \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T + b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right)\n$$\nThe terms involving $\\lambda$ and $\\mu$ cancel out, as expected for an objective base model. The remaining terms are:\n$$\n\\boldsymbol{\\Delta} = b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A} - b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\left( \\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right)\n$$\nThe objectivity violation measure $E(\\mathbf{Q}, \\boldsymbol{\\varepsilon})$ is the Frobenius norm of this tensor. Using the norm property $\\|c\\mathbf{M}\\|_F = |c|\\|\\mathbf{M}\\|_F$ for a scalar $c$:\n$$\nE(\\mathbf{Q}, \\boldsymbol{\\varepsilon}) = \\left\\| b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\left( \\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right) \\right\\|_F = |b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon})| \\left\\| \\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right\\|_F\n$$\nThis simplified expression reveals that the objectivity violation is zero if $b=0$, if the strain is isochoric (i.e., $\\mathrm{tr}(\\boldsymbol{\\varepsilon})=0$), or if the rotation $\\mathbf{Q}$ commutes with the bias tensor $\\mathbf{A}$ (i.e., $\\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathbf{A}$).\n\nWe now apply this formula to the five test cases using the given parameters: $b = 5.0 \\times 10^{8} \\ \\mathrm{Pa}$ and $\\mathbf{A} = \\mathrm{diag}(\\tfrac{2}{3}, -\\tfrac{1}{3}, -\\tfrac{1}{3})$.\n\nCase $1$: $\\theta = 0$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}(1.2\\times 10^{-3}, -0.3\\times 10^{-3}, -0.3\\times 10^{-3})$.\nFor $\\theta=0$, the rotation matrix is the identity matrix, $\\mathbf{Q} = \\mathbf{I}$.\nThus, $\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathbf{A} - \\mathbf{I}\\mathbf{A}\\mathbf{I}^T = \\mathbf{A} - \\mathbf{A} = \\mathbf{0}$.\nThe norm is $0$, so $E_1 = 0 \\ \\mathrm{Pa}$.\n\nCase $2$: $\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}(1.2\\times 10^{-3}, -0.3\\times 10^{-3}, -0.3\\times 10^{-3})$.\nFirst, $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_1) = (1.2 - 0.3 - 0.3) \\times 10^{-3} = 0.6 \\times 10^{-3}$.\nThe rotation matrix is $\\mathbf{Q}_z(\\tfrac{\\pi}{2}) = \\begin{bsmallmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bsmallmatrix}$.\nWe compute $\\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathrm{diag}(-\\tfrac{1}{3}, \\tfrac{2}{3}, -\\tfrac{1}{3})$.\nThe difference is $\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathrm{diag}(\\tfrac{2}{3}, -\\tfrac{1}{3}, -\\tfrac{1}{3}) - \\mathrm{diag}(-\\tfrac{1}{3}, \\tfrac{2}{3}, -\\tfrac{1}{3}) = \\mathrm{diag}(1, -1, 0)$.\nThe Frobenius norm is $\\| \\mathrm{diag}(1, -1, 0) \\|_F = \\sqrt{1^2 + (-1)^2 + 0^2} = \\sqrt{2}$.\n$E_2 = |5.0 \\times 10^8| \\times |0.6 \\times 10^{-3}| \\times \\sqrt{2} = 3.0 \\times 10^5 \\times \\sqrt{2} \\approx 424264.0687 \\ \\mathrm{Pa}$.\n\nCase $3$: $\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_2$ has non-zero components $(\\boldsymbol{\\varepsilon}_2)_{12} = (\\boldsymbol{\\varepsilon}_2)_{21} = 5.0\\times 10^{-4}$.\nThe trace is $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_2) = 0$.\nSince $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_2) = 0$, the objectivity violation $E_3 = 0 \\ \\mathrm{Pa}$ directly from the formula.\n\nCase $4$: $\\theta = \\tfrac{\\pi}{3}$, $\\boldsymbol{\\varepsilon}_3 = 1.0\\times 10^{-4} \\, \\mathbf{I}$.\nThe strain is hydrostatic. $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_3) = \\mathrm{tr}(1.0\\times 10^{-4} \\, \\mathbf{I}) = 1.0\\times 10^{-4} \\times 3 = 3.0 \\times 10^{-4}$.\nThe rotation is $\\mathbf{Q}_z(\\tfrac{\\pi}{3})$. Let $c=\\cos(\\tfrac{\\pi}{3}) = \\tfrac{1}{2}$ and $s=\\sin(\\tfrac{\\pi}{3}) = \\tfrac{\\sqrt{3}}{2}$.\nThe difference tensor is $\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = (a_1-a_2) \\begin{bsmallmatrix} s^2 & -cs & 0 \\\\ -cs & -s^2 & 0 \\\\ 0 & 0 & 0 \\end{bsmallmatrix}$, where $a_1=\\tfrac{2}{3}, a_2=-\\tfrac{1}{3}$.\n$a_1 - a_2 = 1$. So, $\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\begin{bsmallmatrix} (\\sqrt{3}/2)^2 & -(\\sqrt{3}/4) & 0 \\\\ -(\\sqrt{3}/4) & -(\\sqrt{3}/2)^2 & 0 \\\\ 0 & 0 & 0 \\end{bsmallmatrix} = \\begin{bsmallmatrix} 3/4 & -\\sqrt{3}/4 & 0 \\\\ -\\sqrt{3}/4 & -3/4 & 0 \\\\ 0 & 0 & 0 \\end{bsmallmatrix}$.\nThe squared Frobenius norm is $\\| \\cdot \\|_F^2 = (\\tfrac{3}{4})^2 + (-\\tfrac{\\sqrt{3}}{4})^2 + (-\\tfrac{\\sqrt{3}}{4})^2 + (-\\tfrac{3}{4})^2 = \\tfrac{9}{16} + \\tfrac{3}{16} + \\tfrac{3}{16} + \\tfrac{9}{16} = \\tfrac{24}{16} = \\tfrac{3}{2}$.\nThe norm is $\\sqrt{\\tfrac{3}{2}}$.\n$E_4 = |5.0 \\times 10^8| \\times |3.0 \\times 10^{-4}| \\times \\sqrt{\\tfrac{3}{2}} = 1.5 \\times 10^5 \\times \\sqrt{1.5} \\approx 183711.7307 \\ \\mathrm{Pa}$.\n\nCase $5$: $\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_4 = \\mathbf{0}$.\nThe strain tensor is the zero tensor. $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_4) = 0$.\nAccordingly, the objectivity violation $E_5 = 0 \\ \\mathrm{Pa}$.\n\nThe program below will implement these calculations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the objectivity violation measure E(Q, ε) for five test cases.\n    \"\"\"\n    # Define physical and model parameters\n    B_COEFF = 5.0e8  # Bias coefficient b in Pa\n\n    # Define the fixed symmetric traceless tensor A\n    A = np.diag([2/3, -1/3, -1/3])\n\n    # Define the test suite\n    test_cases = [\n        # Case 1: Identity rotation\n        {\n            'theta': 0.0,\n            'epsilon': np.diag([1.2e-3, -0.3e-3, -0.3e-3])\n        },\n        # Case 2: Nontrivial rotation, volumetric strain\n        {\n            'theta': np.pi / 2,\n            'epsilon': np.diag([1.2e-3, -0.3e-3, -0.3e-3])\n        },\n        # Case 3: Trace-free shear\n        {\n            'theta': np.pi / 2,\n            'epsilon': np.array([[0, 5.0e-4, 0], [5.0e-4, 0, 0], [0, 0, 0]])\n        },\n        # Case 4: Hydrostatic strain\n        {\n            'theta': np.pi / 3,\n            'epsilon': 1.0e-4 * np.identity(3)\n        },\n        # Case 5: Zero strain\n        {\n            'theta': np.pi / 2,\n            'epsilon': np.zeros((3, 3))\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        theta = case['theta']\n        epsilon = case['epsilon']\n\n        # Calculate trace of the strain tensor\n        tr_eps = np.trace(epsilon)\n\n        # The objectivity violation is zero if tr(ε) is zero.\n        if np.isclose(tr_eps, 0):\n            E = 0.0\n            results.append(E)\n            continue\n\n        # Construct the rotation matrix Q for rotation about the z-axis\n        c, s = np.cos(theta), np.sin(theta)\n        Q = np.array([[c, -s, 0], \n                      [s,  c, 0], \n                      [0,  0, 1]])\n\n        # Calculate the difference tensor A - Q A Q^T\n        QAQT = Q @ A @ Q.T\n        diff_tensor = A - QAQT\n\n        # Calculate the Frobenius norm of the difference tensor\n        norm_diff = np.linalg.norm(diff_tensor, 'fro')\n\n        # Calculate the objectivity violation measure E\n        E = abs(B_COEFF * tr_eps) * norm_diff\n        results.append(E)\n\n    # Format and print the final results\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond symmetries, surrogate models must also conform to universal physical laws, such as the second law of thermodynamics. For mechanical systems, this law manifests as the Clausius-Duhem inequality, which requires that the rate of internal energy dissipation must be non-negative. In this exercise , you will investigate a scenario where independently constructed surrogates for stress and energy can violate this law, leading to the unphysical prediction of negative dissipation. This practice will also guide you in designing a penalty function to enforce thermodynamic consistency, a cornerstone technique of physics-informed machine learning.",
            "id": "3540257",
            "problem": "You are given a one-dimensional, isothermal, small-strain thermomechanical setting appropriate for computational geomechanics, where the mechanical dissipation is constrained by the Clausius–Duhem inequality. The fundamental base is the Clausius–Duhem inequality, which states that mechanical dissipation must be non-negative, expressed as $$D \\ge 0.$$ In one spatial dimension under small strains, the mechanical dissipation is $$D = \\sigma \\dot{\\epsilon} - \\dot{\\Psi},$$ where $\\sigma$ is the Cauchy stress (units of Pascal), $\\epsilon$ is the strain (dimensionless), $\\dot{\\epsilon}$ is the strain rate (units of $\\text{s}^{-1}$), and $\\Psi$ is the Helmholtz free energy density (units of Pascal since energy per unit volume is $\\text{J}/\\text{m}^3 = \\text{Pa}$). By the chain rule, $$\\dot{\\Psi} = \\frac{\\partial \\Psi}{\\partial \\epsilon}\\dot{\\epsilon} + \\frac{\\partial \\Psi}{\\partial q}\\dot{q},$$ where $q$ is a scalar internal variable (dimensionless) and $\\dot{q}$ is its rate (units of $\\text{s}^{-1}$). Hence, the dissipation reduces to $$D = (\\sigma - \\frac{\\partial \\Psi}{\\partial \\epsilon})\\dot{\\epsilon} - \\frac{\\partial \\Psi}{\\partial q}\\dot{q}.$$\n\nConsider machine learning surrogates that independently predict stress and the free-energy landscape, potentially violating $D \\ge 0$. In this one-dimensional surrogate setting, define\n- the surrogate stress as $$\\hat{\\sigma}(\\epsilon,q) = s_1 \\epsilon + s_2 q + s_3 \\epsilon^3,$$\n- the surrogate free energy as $$\\hat{\\Psi}(\\epsilon,q) = \\tfrac{1}{2} a \\epsilon^2 + \\tfrac{1}{2} b q^2 + c \\epsilon q,$$\nso that $$\\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}(\\epsilon,q) = a \\epsilon + c q, \\quad \\frac{\\partial \\hat{\\Psi}}{\\partial q}(\\epsilon,q) = b q + c \\epsilon.$$\nFor the internal variable kinetics, use a linear surrogate evolution law $$\\dot{q} = h_1 \\hat{\\sigma} + h_2 \\epsilon + h_3 q,$$ with $h_1$ (units of $\\text{s}^{-1}\\text{Pa}^{-1}$), $h_2$ and $h_3$ (units of $\\text{s}^{-1}$).\n\nThe mechanical dissipation produced by the surrogates is $$D(\\epsilon,q,\\dot{\\epsilon}) = \\hat{\\sigma}(\\epsilon,q)\\,\\dot{\\epsilon} - \\left( \\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}(\\epsilon,q)\\,\\dot{\\epsilon} + \\frac{\\partial \\hat{\\Psi}}{\\partial q}(\\epsilon,q)\\,\\dot{q} \\right).$$\n\nYour tasks are:\n1. Compute a counterexample where the unconstrained surrogate violates the non-negative dissipation requirement $D \\ge 0$, by evaluating $D$ over a fixed, finite training batch of states and rates, and detecting whether any sample yields $D < 0$.\n2. Design and evaluate a regularization term that penalizes negative dissipation during training. Define the regularization as the hinge-squared penalty applied over a mini-batch, $$\\mathcal{R} = \\alpha \\, \\text{mean}\\left( \\max(0, -D)^2 \\right),$$ with $\\alpha$ a dimensionless weight and $\\text{mean}(\\cdot)$ the arithmetic mean over the batch. This penalty must be zero whenever all dissipation values are non-negative, and strictly positive whenever any dissipation is negative.\n\nUse the following fixed training batch of states and rates:\n- Strain samples $$\\epsilon \\in \\{-0.01,\\, 0.0,\\, 0.01\\}$$ (dimensionless),\n- Internal variable samples $$q \\in \\{0.0,\\, 0.02\\}$$ (dimensionless),\n- Strain rate samples $$\\dot{\\epsilon} \\in \\{-10^{-5},\\, 10^{-5}\\}$$ in $\\text{s}^{-1}$.\n\nEvaluate three test cases (parameter sets), each with the penalty weight $\\alpha = 1.0$:\n- Case A (energy-consistent stress and dissipative flow): choose $$a = 50\\times 10^6\\,\\text{Pa}, \\quad b = 20\\times 10^6\\,\\text{Pa}, \\quad c = 10\\times 10^6\\,\\text{Pa},$$ enforce $$s_1 = a,\\quad s_2 = c,\\quad s_3 = 0,$$ and choose a positive mobility $$L = 2\\times 10^{-9}\\,\\text{Pa}^{-1}\\text{s}^{-1}$$ with $$h_1 = 0,\\quad h_2 = -L\\,c,\\quad h_3 = -L\\,b.$$ This is a physically consistent configuration expected to satisfy $$D \\ge 0.$$\n- Case B (boundary case with zero mobility): use the same $a$, $b$, $c$, $s_1$, $s_2$, $s_3$ as Case A, but set $$h_1 = 0,\\quad h_2 = 0,\\quad h_3 = 0.$$ This corresponds to frozen internal variables with $$D = 0$$ when $\\hat{\\sigma} = \\partial \\hat{\\Psi}/\\partial \\epsilon$.\n- Case C (unconstrained surrogate with reversed flow): use $$a = 50\\times 10^6\\,\\text{Pa}, \\quad b = 20\\times 10^6\\,\\text{Pa}, \\quad c = 10\\times 10^6\\,\\text{Pa},$$ set stress surrogate parameters $$s_1 = a,\\quad s_2 = -c,\\quad s_3 = 20\\times 10^6\\,\\text{Pa},$$ and choose a positive mobility $$M = 2\\times 10^{-9}\\,\\text{Pa}^{-1}\\text{s}^{-1}$$ with $$h_1 = 0,\\quad h_2 = M\\,c,\\quad h_3 = M\\,b.$$ This configuration reverses the sign of the internal variable flow relative to the negative gradient of the free energy and is expected to produce dissipation violations $$D < 0$$ for some states.\n\nFor each case, compute over the full training batch:\n- The boolean violation flag indicating whether any sample yielded $$D < 0.$$ \n- The hinge-squared regularization value $$\\mathcal{R}$$ as defined above.\n- The minimum dissipation value $$\\min D$$ over the batch.\n\nPhysical units:\n- Report dissipation values $$D$$ in $\\text{Pa}/\\text{s}$,\n- Report the regularization values $$\\mathcal{R}$$ in $\\text{Pa}^2/\\text{s}^2$,\n- Report the violation flag as a boolean.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test-case result must be a list of the form $$[\\text{violation},\\, \\mathcal{R},\\, \\min D]$$, so the overall output is $$[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]].$$\n\nTest suite coverage:\n- Case A exercises the physically consistent \"happy path\" with strictly non-negative dissipation.\n- Case B is a boundary case where dissipation should be zero across the batch.\n- Case C is an edge case counterexample intentionally violating the dissipative constraint, requiring the penalty to be strictly positive.\n\nYour implementation must use the formulas above to compute $$D$$ and $$\\mathcal{R}$$ for the specified batch and parameter sets, and must output the aggregate results in the exact format described.",
            "solution": "The problem requires an evaluation of the mechanical dissipation, $D$, for a one-dimensional thermomechanical system described by surrogate models for stress, free energy, and internal variable kinetics. The core task is to verify whether these surrogate models respect the second law of thermodynamics, which, in this isothermal, small-strain context, is expressed by the Clausius-Duhem inequality, $D \\ge 0$. We will compute $D$ for a batch of discrete states $(\\epsilon, q)$ and rates $(\\dot{\\epsilon})$, identify violations of this physical constraint, and quantify the violation using a penalty function suitable for training a machine learning model.\n\nThe mechanical dissipation $D$ is given by the formula:\n$$D = \\sigma \\dot{\\epsilon} - \\dot{\\Psi}$$\nwhere $\\sigma$ is the Cauchy stress, $\\dot{\\epsilon}$ is the strain rate, and $\\dot{\\Psi}$ is the material time derivative of the Helmholtz free energy density $\\Psi$. Using the chain rule for $\\Psi(\\epsilon, q)$, where $\\epsilon$ is the strain and $q$ is an internal variable, we have:\n$$\\dot{\\Psi} = \\frac{\\partial \\Psi}{\\partial \\epsilon}\\dot{\\epsilon} + \\frac{\\partial \\Psi}{\\partial q}\\dot{q}$$\nSubstituting this into the dissipation expression yields:\n$$D = (\\sigma - \\frac{\\partial \\Psi}{\\partial \\epsilon})\\dot{\\epsilon} - \\frac{\\partial \\Psi}{\\partial q}\\dot{q}$$\nThis form helpfully separates the dissipation into two parts: one associated with the strain rate $\\dot{\\epsilon}$ and another with the rate of the internal variable $\\dot{q}$. The term $(\\sigma - \\frac{\\partial \\Psi}{\\partial \\epsilon})$ represents the dissipative part of the stress.\n\nThe problem defines surrogate models for stress, $\\hat{\\sigma}$, and free energy, $\\hat{\\Psi}$, along with an evolution law for the internal variable, $\\dot{q}$. We substitute these surrogates into the dissipation formula:\n$$D(\\epsilon,q,\\dot{\\epsilon}) = (\\hat{\\sigma}(\\epsilon,q) - \\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}(\\epsilon,q))\\dot{\\epsilon} - \\frac{\\partial \\hat{\\Psi}}{\\partial q}(\\epsilon,q)\\dot{q}(\\epsilon,q)$$\nThe specific forms of the surrogate models are:\n- Surrogate stress: $\\hat{\\sigma}(\\epsilon,q) = s_1 \\epsilon + s_2 q + s_3 \\epsilon^3$\n- Surrogate free energy partial derivatives:\n  - $\\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}(\\epsilon,q) = a \\epsilon + c q$\n  - $\\frac{\\partial \\hat{\\Psi}}{\\partial q}(\\epsilon,q) = b q + c \\epsilon$\n- Surrogate internal variable evolution: $\\dot{q}(\\epsilon,q) = h_1 \\hat{\\sigma}(\\epsilon,q) + h_2 \\epsilon + h_3 q$\n\nOur computational procedure is as follows. We first construct the training batch by taking the Cartesian product of the provided sample sets: $\\epsilon \\in \\{-0.01, 0.0, 0.01\\}$, $q \\in \\{0.0, 0.02\\}$, and $\\dot{\\epsilon} \\in \\{-10^{-5}, 10^{-5}\\}$. This results in a batch of $3 \\times 2 \\times 2 = 12$ data points of $(\\epsilon, q, \\dot{\\epsilon})$.\n\nFor each of the three test cases (A, B, and C), we set the specific material and surrogate parameters. Then, for each of the $12$ points in the batch, we perform the following calculations:\n1.  Compute the surrogate stress $\\hat{\\sigma}$ at the state $(\\epsilon, q)$.\n2.  Compute the rate of the internal variable $\\dot{q}$ at the state $(\\epsilon, q)$, which depends on the computed $\\hat{\\sigma}$.\n3.  Compute the partial derivatives of the surrogate free energy, $\\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}$ and $\\frac{\\partial \\hat{\\Psi}}{\\partial q}$, at the state $(\\epsilon, q)$.\n4.  Combine these quantities to calculate the dissipation $D$ using the full expression above.\n\nAfter computing the $12$ dissipation values $\\{D_i\\}$ for a given case, we determine the required outputs:\n- **Violation Flag**: A boolean value, which is `True` if any $D_i < 0$ in the batch, and `False` otherwise.\n- **Minimum Dissipation**: The minimum value of $D_i$ over the batch, $\\min(\\{D_i\\})$.\n- **Regularization Value $\\mathcal{R}$**: The hinge-squared penalty, calculated as $\\mathcal{R} = \\alpha \\, \\text{mean}(\\max(0, -D_i)^2)$, with the penalty weight $\\alpha=1.0$. This term is zero if all $D_i \\ge 0$ and is strictly positive if any $D_i < 0$.\n\nLet us analyze the three cases based on principles of thermodynamic consistency:\n\n**Case A: Energy-consistent stress and dissipative flow.**\nHere, the surrogate stress parameters are set such that $\\hat{\\sigma} = a\\epsilon + c q = \\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}$ (since $s_1=a$, $s_2=c$, $s_3=0$). This enforces that the stress is derived from the free energy potential, a standard assumption for elastic behavior. The dissipation expression simplifies to $D = - \\frac{\\partial \\hat{\\Psi}}{\\partial q}\\dot{q}$. The internal variable evolution is given by $\\dot{q} = -L(c\\epsilon + bq) = -L\\frac{\\partial \\hat{\\Psi}}{\\partial q}$, which is a standard linear flow rule where the rate is proportional to the thermodynamic driving force $\\frac{\\partial \\hat{\\Psi}}{\\partial q}$. Substituting this into the simplified dissipation gives $D = - \\frac{\\partial \\hat{\\Psi}}{\\partial q} (-L \\frac{\\partial \\hat{\\Psi}}{\\partial q}) = L (\\frac{\\partial \\hat{\\Psi}}{\\partial q})^2$. Since the mobility $L > 0$, the dissipation $D$ is guaranteed to be non-negative, $D \\ge 0$. We expect zero violations.\n\n**Case B: Boundary case with zero mobility.**\nThis case maintains the energy-consistent stress $\\hat{\\sigma} = \\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon}$, so the first term in $D$ is zero. However, the internal variable kinetics are frozen by setting $h_1, h_2, h_3$ to $0$, which implies $\\dot{q}=0$. Consequently, the dissipation is $D = (0)\\dot{\\epsilon} - \\frac{\\partial \\hat{\\Psi}}{\\partial q}(0) = 0$ for all states. This represents a purely elastic (non-dissipative) response. We expect zero violations and a minimum dissipation of exactly $0$.\n\n**Case C: Unconstrained surrogate with reversed flow.**\nIn this case, the surrogate parameters for $\\hat{\\sigma}$ do not correspond to the derivative of $\\hat{\\Psi}$ (as $s_2 = -c \\neq c$ and $s_3 \\neq 0$). This introduces a dissipative stress term, $(\\hat{\\sigma} - \\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon})\\dot{\\epsilon}$. Furthermore, the internal variable kinetics are set to $\\dot{q} = M(c\\epsilon + bq) = M\\frac{\\partial \\hat{\\Psi}}{\\partial q}$. This represents an \"uphill\" flow, where the internal variable evolves in the direction of the thermodynamic force, rather than against it. The dissipation becomes $D = (\\hat{\\sigma} - \\frac{\\partial \\hat{\\Psi}}{\\partial \\epsilon})\\dot{\\epsilon} - M(\\frac{\\partial \\hat{\\Psi}}{\\partial q})^2$. The second term is always non-positive since $M>0$. The first term can be positive or negative depending on the state and strain rate. This configuration is explicitly designed to violate the dissipation inequality, and we expect to find states where $D < 0$, resulting in a positive regularization penalty $\\mathcal{R}$.\n\nThe implementation will now proceed to compute these quantities numerically for each case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes dissipation violations and penalties for three test cases\n    of a thermomechanical surrogate model in geomechanics.\n    \"\"\"\n\n    # Define the training batch\n    epsilon_samples = np.array([-0.01, 0.0, 0.01])\n    q_samples = np.array([0.0, 0.02])\n    epsilon_dot_samples = np.array([-1e-5, 1e-5])\n\n    # Create the full batch using meshgrid for vectorized computation\n    eps, q, eps_dot = np.meshgrid(epsilon_samples, q_samples, epsilon_dot_samples, indexing='ij')\n    \n    # Flatten arrays for batch processing\n    batch_size = eps.size\n    eps_flat = eps.flatten()\n    q_flat = q.flatten()\n    eps_dot_flat = eps_dot.flatten()\n\n    # Define parameters for the three test cases\n    cases = {\n        \"A\": {\n            'a': 50e6, 'b': 20e6, 'c': 10e6,\n            's1': 50e6, 's2': 10e6, 's3': 0.0,\n            'h1': 0.0,\n            'h2': -(2e-9) * 10e6,  # -L*c\n            'h3': -(2e-9) * 20e6,  # -L*b\n        },\n        \"B\": {\n            'a': 50e6, 'b': 20e6, 'c': 10e6,\n            's1': 50e6, 's2': 10e6, 's3': 0.0,\n            'h1': 0.0, 'h2': 0.0, 'h3': 0.0,\n        },\n        \"C\": {\n            'a': 50e6, 'b': 20e6, 'c': 10e6,\n            's1': 50e6, 's2': -10e6, 's3': 20e6,\n            'h1': 0.0,\n            'h2': (2e-9) * 10e6,   # M*c\n            'h3': (2e-9) * 20e6,   # M*b\n        }\n    }\n\n    all_results = []\n    \n    # Penalty weight\n    alpha = 1.0\n\n    for case_name in [\"A\", \"B\", \"C\"]:\n        params = cases[case_name]\n        \n        a, b, c = params['a'], params['b'], params['c']\n        s1, s2, s3 = params['s1'], params['s2'], params['s3']\n        h1, h2, h3 = params['h1'], params['h2'], params['h3']\n        \n        # --- Vectorized computations over the batch ---\n        \n        # 1. Surrogate stress\n        sigma_hat = s1 * eps_flat + s2 * q_flat + s3 * eps_flat**3\n        \n        # 2. Surrogate internal variable evolution\n        q_dot = h1 * sigma_hat + h2 * eps_flat + h3 * q_flat\n        \n        # 3. Surrogate free energy derivatives\n        dPsi_de = a * eps_flat + c * q_flat\n        dPsi_dq = b * q_flat + c * eps_flat\n        \n        # 4. Mechanical dissipation\n        D = (sigma_hat - dPsi_de) * eps_dot_flat - dPsi_dq * q_dot\n        \n        # --- Compute required metrics ---\n        \n        # Violation flag\n        violation = np.any(D  0)\n        \n        # Minimum dissipation\n        min_D = np.min(D)\n        \n        # Hinge-squared regularization\n        negative_D = -D\n        penalty_per_sample = np.maximum(0, negative_D)**2\n        R = alpha * np.mean(penalty_per_sample)\n        \n        # Store results for the current case\n        # The problem asks for boolean violation, R, and min_D\n        # Python's default str(bool) gives 'True'/'False' which is acceptable.\n        all_results.append([violation, R, min_D])\n\n    # Format the final output string as per requirements\n    case_strings = []\n    for res in all_results:\n        # res is [bool, float, float]\n        # Manually format to avoid spaces and ensure correctness\n        case_strings.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A constitutive model must not only obey fundamental laws but also describe a stable material response, which is essential for the well-posedness of numerical simulations. The strong ellipticity condition ensures this stability by placing constraints on the material's tangent stiffness tensor. This final practice  shows how to architecturally enforce simple positivity constraints on learned elastic moduli, such as the bulk modulus $K$ and shear modulus $G$, using the Softplus function. You will then verify the full strong ellipticity condition, ensuring the surrogate produces a stable material tangent across a range of geomechanically relevant stress states.",
            "id": "3540275",
            "problem": "You are given a small-strain, incrementally isotropic elastic tangent modeled by a machine learning surrogate that maps mean stress to elastic moduli. The surrogate outputs a bulk modulus $K$ and a shear modulus $G$ as functions of mean stress $p$, with units of megapascal (MPa). The surrogate must enforce positivity constraints $Kgt;0$ and $Ggt;0$, and the task is to check the Strong Ellipticity condition of the tangent stiffness as $p$ increases along a specified hydrostatic stress path.\n\nStart from the fundamental base in linear elasticity: the fourth-order isotropic elastic tangent under small strain and isotropy can be written in terms of Lamé parameters $\\lambda$ and $\\mu$ as\n$$\nC_{ijkl} = \\lambda\\,\\delta_{ij}\\delta_{kl} + \\mu\\left(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}\\right),\n$$\nwith $\\mu=G$ and $\\lambda=K-\\tfrac{2}{3}G$. The Strong Ellipticity condition requires that for every unit vector $n$ and any nonzero vector $v$, the acoustic quadratic form satisfies $v_i\\,Q_{ij}(n)\\,v_jgt;0$, where the acoustic tensor is\n$$\nQ_{ij}(n) = C_{ipjq}\\,n_p\\,n_q.\n$$\nFor the isotropic form above,\n$$\nQ_{ij}(n) = \\left(\\lambda + 2G\\right) n_i n_j + G\\left(\\delta_{ij} - n_i n_j\\right),\n$$\nwhose eigenvalues do not depend on the direction $n$ and are given by two repeated transverse eigenvalues equal to $G$ and one longitudinal eigenvalue equal to $\\lambda + 2G = K + \\tfrac{4}{3}G$. Therefore, Strong Ellipticity is equivalent to\n$$\nG  0 \\quad \\text{and} \\quad K + \\tfrac{4}{3}G  0.\n$$\nThe machine learning surrogate imposes the positivity constraints by transforming raw polynomial outputs via the Softplus function. Specifically, for each given mean stress $p$,\n$$\nk_{\\text{raw}}(p) = a_0 + a_1 p + a_2 p^2,\\quad g_{\\text{raw}}(p) = b_0 + b_1 p + b_2 p^2,\n$$\n$$\nK(p) = \\log\\!\\left(1 + e^{\\,k_{\\text{raw}}(p)}\\right) + \\varepsilon_K,\\quad G(p) = \\log\\!\\left(1 + e^{\\,g_{\\text{raw}}(p)}\\right) + \\varepsilon_G,\n$$\nwhere $\\varepsilon_K$ and $\\varepsilon_G$ are small fixed positive constants to ensure strict positivity. Units are as follows: $p$ is in megapascals (MPa), and $K$ and $G$ are in megapascals (MPa). For each $p$, the smallest eigenvalue of the acoustic tensor is\n$$\n\\lambda_{\\min}(p) = \\min\\!\\left(G(p),\\, K(p) + \\tfrac{4}{3}G(p)\\right).\n$$\nGiven a stress path $p \\in \\{\\,0,\\,50,\\,100,\\,200,\\,400\\,\\}$ (in MPa), compute the minimum over the path,\n$$\n\\Lambda_{\\min} = \\min_{p \\in \\{0,50,100,200,400\\}} \\lambda_{\\min}(p),\n$$\nwhich quantifies the Strong Ellipticity margin of the tangent stiffness as stress increases.\n\nImplement a program that, for each test case defined below, evaluates $K(p)$ and $G(p)$ from the surrogate, computes $\\lambda_{\\min}(p)$ at each specified $p$, and returns $\\Lambda_{\\min}$ as a single floating-point number in megapascals (MPa), rounded to six decimal places. The Softplus function used is the natural logarithm version:\n$$\n\\operatorname{softplus}(x) = \\log\\!\\left(1 + e^{\\,x}\\right).\n$$\nUse the constants $\\varepsilon_K=\\varepsilon_G=10^{-12}$ (in MPa).\n\nTest suite specifications:\n- Use the hydrostatic mean stress path $p \\in \\{\\,0,\\,50,\\,100,\\,200,\\,400\\,\\}$ in megapascals (MPa).\n- For each test case, the surrogate parameters $(a_0,a_1,a_2,b_0,b_1,b_2)$ are as follows:\n    1. Case $1$ (increasing moduli): $(a_0,a_1,a_2)=(5.0,\\,0.1,\\,0.0)$, $(b_0,b_1,b_2)=(2.0,\\,0.05,\\,0.0)$.\n    2. Case $2$ (decaying shear modulus): $(a_0,a_1,a_2)=(10.0,\\,0.0,\\,0.0)$, $(b_0,b_1,b_2)=(1.0,\\,-0.0025,\\,0.0)$.\n    3. Case $3$ (near-degenerate shear): $(a_0,a_1,a_2)=(2.0,\\,0.0,\\,0.0)$, $(b_0,b_1,b_2)=(-10.0,\\,0.0,\\,0.0)$.\n    4. Case $4$ (nonmonotone shear with quadratic term): $(a_0,a_1,a_2)=(20.0,\\,0.05,\\,0.0)$, $(b_0,b_1,b_2)=(0.5,\\,0.01,\\,-1.0\\times 10^{-4})$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in megapascals (MPa), rounded to six decimal places, for the four cases in order. For example, a valid output line looks like\n\"[0.123456,1.234568,0.000001,0.987654]\".",
            "solution": "The objective is to compute the minimum stability margin, denoted by $\\Lambda_{\\min}$, for an incrementally isotropic elastic material along a specified hydrostatic stress path $p \\in \\{0, 50, 100, 200, 400\\}\\,\\text{MPa}$. This margin is quantified by the smallest eigenvalue of the acoustic tensor. The material's elastic moduli, bulk modulus $K$ and shear modulus $G$, are functions of the mean stress $p$ and are provided by a surrogate model.\n\nThe solution is obtained by following a clear, step-by-step procedure for each test case.\n\n**1. Surrogate Model Evaluation**\n\nThe first step is to compute the elastic moduli $K(p)$ and $G(p)$ for each stress value $p$ in the path. The surrogate model employs a two-stage process. Initially, raw values are calculated using quadratic polynomials:\n$$\nk_{\\text{raw}}(p) = a_0 + a_1 p + a_2 p^2\n$$\n$$\ng_{\\text{raw}}(p) = b_0 + b_1 p + b_2 p^2\n$$\nThe coefficients $(a_0, a_1, a_2, b_0, b_1, b_2)$ are specific to each test case. All stress and moduli values are in units of megapascals (MPa).\n\n**2. Positivity Enforcement**\n\nTo ensure the physical constraints of positive definite moduli, $K  0$ and $G  0$, the raw outputs are transformed using the Softplus function, $\\operatorname{softplus}(x) = \\log(1 + e^x)$, and shifted by small positive constants $\\varepsilon_K$ and $\\varepsilon_G$. The moduli are thus given by:\n$$\nK(p) = \\operatorname{softplus}(k_{\\text{raw}}(p)) + \\varepsilon_K = \\log(1 + e^{k_{\\text{raw}}(p)}) + \\varepsilon_K\n$$\n$$\nG(p) = \\operatorname{softplus}(g_{\\text{raw}}(p)) + \\varepsilon_G = \\log(1 + e^{g_{\\text{raw}}(p)}) + \\varepsilon_G\n$$\nThe problem specifies the constants as $\\varepsilon_K = 10^{-12}$ and $\\varepsilon_G = 10^{-12}$. This construction guarantees that $K(p)$ and $G(p)$ are strictly positive for any finite raw output.\n\n**3. Strong Ellipticity Condition**\n\nThe Strong Ellipticity condition is a fundamental requirement for material stability, ensuring that wave speeds are real. It mandates that the acoustic tensor, $Q_{ij}(n) = C_{ipjq} n_p n_q$, be positive definite for any unit vector $n$. For an isotropic elastic material, the fourth-order stiffness tensor is\n$$\nC_{ijkl} = \\lambda\\,\\delta_{ij}\\delta_{kl} + \\mu\\left(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}\\right)\n$$\nwhere the Lamé parameters are related to the moduli by $\\mu = G$ and $\\lambda = K - \\frac{2}{3}G$. The eigenvalues of the corresponding acoustic tensor are independent of the direction $n$ and are given by $G$ (a repeated transverse mode) and $K + \\frac{4}{3}G$ (a longitudinal mode).\nStrong Ellipticity is therefore satisfied if and only if both eigenvalues are strictly positive:\n$$\nG  0 \\quad \\text{and} \\quad K + \\tfrac{4}{3}G  0\n$$\n\n**4. Minimum Eigenvalue Calculation at Each Stress Point**\n\nThe stability margin at a given stress $p$ is the smallest of these two eigenvalues. We define this as $\\lambda_{\\min}(p)$:\n$$\n\\lambda_{\\min}(p) = \\min\\!\\left(G(p),\\, K(p) + \\tfrac{4}{3}G(p)\\right)\n$$\nFor each test case, we compute the values of $K(p)$ and $G(p)$ for each $p$ in the set $\\{0, 50, 100, 200, 400\\}$, and then calculate the corresponding $\\lambda_{\\min}(p)$.\n\n**5. Determination of the Overall Minimum Stability Margin**\n\nThe final required quantity, $\\Lambda_{\\min}$, represents the tightest stability constraint over the entire stress path. It is found by taking the minimum of the $\\lambda_{\\min}(p)$ values calculated in the previous step:\n$$\n\\Lambda_{\\min} = \\min_{p \\in \\{0,50,100,200,400\\}} \\lambda_{\\min}(p)\n$$\nThis computation is performed for each of the four provided test cases. The final result for each case is rounded to six decimal places, as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum strong ellipticity margin for a surrogate elastic model.\n    \"\"\"\n    \n    # Define constants and the stress path as specified\n    epsilon_K = 1e-12\n    epsilon_G = 1e-12\n    p_path = np.array([0., 50., 100., 200., 400.])\n\n    # Test cases: tuples of (a0, a1, a2, b0, b1, b2)\n    test_cases = [\n        # Case 1: increasing moduli\n        (5.0, 0.1, 0.0, 2.0, 0.05, 0.0),\n        # Case 2: decaying shear modulus\n        (10.0, 0.0, 0.0, 1.0, -0.0025, 0.0),\n        # Case 3: near-degenerate shear\n        (2.0, 0.0, 0.0, -10.0, 0.0, 0.0),\n        # Case 4: nonmonotone shear with quadratic term\n        (20.0, 0.05, 0.0, 0.5, 0.01, -1.0e-4)\n    ]\n\n    # Helper function for the Softplus transformation\n    def softplus(x):\n        return np.log(1 + np.exp(x))\n\n    all_results = []\n    \n    # Iterate through each test case\n    for case in test_cases:\n        a0, a1, a2, b0, b1, b2 = case\n        \n        # --- Step 1  2: Evaluate Surrogate Model with Positivity ---\n        # Calculate raw polynomial outputs for all p in the path (vectorized)\n        k_raw = a0 + a1 * p_path + a2 * p_path**2\n        g_raw = b0 + b1 * p_path + b2 * p_path**2\n        \n        # Apply Softplus transform and add epsilon to get K and G\n        K_p_array = softplus(k_raw) + epsilon_K\n        G_p_array = softplus(g_raw) + epsilon_G\n        \n        # --- Step 3  4: Evaluate Strong Ellipticity Eigenvalues ---\n        # The two eigenvalues of interest for the acoustic tensor are G and K + 4/3*G\n        eig_longitudinal = K_p_array + (4.0/3.0) * G_p_array\n        \n        # Find the minimum eigenvalue at each point p in the path\n        lambda_min_p_array = np.minimum(G_p_array, eig_longitudinal)\n\n        # --- Step 5: Determine Minimum over the Path ---\n        # Find the minimum of these eigenvalues over the entire path\n        Lambda_min = np.min(lambda_min_p_array)\n        \n        all_results.append(Lambda_min)\n\n    # Format the results to exactly six decimal places and produce the final output string\n    formatted_results = [\"{:.6f}\".format(r) for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}