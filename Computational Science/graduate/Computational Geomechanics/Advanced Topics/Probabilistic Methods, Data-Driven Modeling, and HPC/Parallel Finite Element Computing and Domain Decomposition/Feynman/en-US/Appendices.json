{
    "hands_on_practices": [
        {
            "introduction": "To design efficient parallel algorithms, we must first learn to predict their performance and identify potential bottlenecks. This practice introduces the fundamental alpha-beta model to dissect the runtime of a parallel Krylov solver into its core components: computation, communication latency, and bandwidth costs. By deriving these terms from the geometry of a finite element mesh decomposition, you will build a tangible connection between algorithmic choices and real-world performance .",
            "id": "3548064",
            "problem": "Consider a quasi-static, small-strain, linear elasticity problem on the unit cube discretized by trilinear hexahedral finite elements on a structured nodal grid of size $120 \\times 120 \\times 120$. Each node carries $3$ displacement components, so each node contributes $3$ degrees of freedom (DOFs). The global stiffness matrix is assembled in scalar form with a block-sparse pattern that couples each node to all nodes in its $3 \\times 3 \\times 3$ neighborhood, producing an average of $81$ nonzeros per row (each $3 \\times 3$ block contributes $3$ scalar nonzeros in a row, and there are $27$ such blocks per row). The domain is partitioned by a regular, non-overlapping domain decomposition onto $p=64$ processes arranged as a $4 \\times 4 \\times 4$ Cartesian grid of subdomains. Assume perfect load balance, i.e., each subdomain contains exactly the same number of nodes and DOFs. A Krylov iteration (e.g., Conjugate Gradient (CG) or Generalized Minimal Residual (GMRES)) performs one sparse matrix-vector product (SpMV) with a single-layer halo exchange and executes $s=3$ global reductions. The halo exchange communicates with all $26$ neighbors (faces, edges, corners) using one message per neighbor per iteration, with a single layer of width one node. For all-reductions, assume a binary-tree algorithm with $2 \\lceil \\log_{2}(p) \\rceil$ stages per all-reduce, where at each stage each process sends and receives a single scalar of size $8$ bytes.\n\nAssume the following machine model and constants:\n- Message latency $\\alpha = 2.5 \\times 10^{-6}$ s (seconds per message).\n- Inverse bandwidth $\\beta = 2.5 \\times 10^{-10}$ s/byte (seconds per byte).\n- Sparse matrix-vector product cost $\\gamma = 3.0 \\times 10^{-9}$ s per nonzero (seconds per nonzero).\n\nUsing the alpha-beta communication model, where the time to send a message of $m$ bytes is $\\alpha + \\beta m$, and starting from first principles (domain decomposition geometry for the halo volume and message counts, and the definition of the sparse matrix-vector product cost), derive an expression for the per-iteration time\n$$\nT \\approx \\gamma\\, n_{nz} + \\alpha\\, n_{m} + \\beta\\, V,\n$$\nby explicitly determining the three quantities $n_{nz}$ (nonzeros per process), $n_{m}$ (total number of messages per process per iteration accounting for both halo exchange and reductions), and $V$ (total bytes communicated per process per iteration accounting for both halo exchange and reductions). Clearly explain the physical and algorithmic meaning of each term in your expression as part of the derivation based on the given setup. Then, evaluate $T$ numerically. Express the final time in seconds and round your answer to four significant figures.",
            "solution": "The task is to derive and evaluate a performance model for the per-iteration time of a parallel finite element solver. The model is given as $T \\approx \\gamma\\, n_{nz} + \\alpha\\, n_{m} + \\beta\\, V$. Our objective is to determine the quantities $n_{nz}$, $n_{m}$, and $V$ from first principles based on the problem description and then compute the total time $T$. The total time per iteration is the sum of three components: the computation time for the sparse matrix-vector product (SpMV), the communication latency, and the communication bandwidth cost.\n\nWe proceed by analyzing each component separately.\n\n1.  **Computation Time: $T_{\\text{comp}} = \\gamma n_{nz}$**\n\nThis term represents the time spent on floating-point arithmetic. For a Krylov solver, the dominant computational cost per iteration is the SpMV operation. The cost is modeled as being proportional to the number of non-zero entries in the local portion of the stiffness matrix handled by a single process.\n\n-   The global computational domain is a structured grid of $N_{\\text{global}} = 120 \\times 120 \\times 120 = 1,728,000$ nodes.\n-   Each node has $d_{\\text{node}} = 3$ degrees of freedom (DOFs).\n-   The total number of DOFs in the system is $N_{\\text{DOF, global}} = N_{\\text{global}} \\times d_{\\text{node}} = 1,728,000 \\times 3 = 5,184,000$. This is the number of rows in the global stiffness matrix.\n-   The problem states that the scalar-assembled matrix has an average of $k_{\\text{row}} = 81$ non-zero entries per row.\n-   The total number of non-zeros in the global stiffness matrix is $NNZ_{\\text{global}} = N_{\\text{DOF, global}} \\times k_{\\text{row}} = 5,184,000 \\times 81 = 419,904,000$.\n-   The domain is partitioned among $p=64$ processes. Assuming perfect load balance, the non-zeros are distributed evenly.\n-   The number of non-zeros per process, $n_{nz}$, is:\n    $$\n    n_{nz} = \\frac{NNZ_{\\text{global}}}{p} = \\frac{419,904,000}{64} = 6,561,000\n    $$\n-   The cost per nonzero is given as $\\gamma = 3.0 \\times 10^{-9}$ s.\n-   The computation time per process per iteration is:\n    $$\n    T_{\\text{comp}} = \\gamma n_{nz} = (3.0 \\times 10^{-9}) \\times 6,561,000 = 0.019683 \\text{ s}\n    $$\n\n2.  **Communication Time: $T_{\\text{comm}} = \\alpha n_m + \\beta V$**\n\nThis term represents the time spent on inter-process communication, which consists of two parts: halo exchange for the SpMV operation and global reductions for the Krylov solver. We must determine the total number of messages sent per process, $n_m$, and the total volume of data sent, $V$.\n\n**2.1. Halo Exchange**\n\nThe halo exchange is required to communicate node data for the DOFs residing on the boundaries of subdomains. The cost depends on the subdomain geometry and communication pattern.\n\n-   The global grid of $120 \\times 120 \\times 120$ nodes is partitioned onto a Cartesian process grid of $p_x \\times p_y \\times p_z = 4 \\times 4 \\times 4$ processes.\n-   Each process is assigned a subdomain of size $n_x \\times n_y \\times n_z$, where $n_x = 120/4 = 30$, $n_y = 120/4 = 30$, and $n_z = 120/4 = 30$ nodes.\n-   We model the communication for a representative interior process, which has $3^3 - 1 = 26$ neighbors (6 face, 12 edge, 8 corner). The problem states that the process communicates with all $26$ neighbors, sending one message to each.\n-   The number of messages for the halo exchange is thus $n_{m, \\text{halo}} = 26$.\n-   The volume of data sent is the sum of the payloads of these $26$ messages. A single layer of nodes is exchanged.\n    -   **Face messages:** $6$ messages are sent to face neighbors. Each message contains the data for nodes on a face of the subdomain. The size of a face is $30 \\times 30 = 900$ nodes.\n    -   **Edge messages:** $12$ messages are sent to edge neighbors. Each message contains data for nodes on an edge of the subdomain. The size of an edge is $30$ nodes.\n    -   **Corner messages:** $8$ messages are sent to corner neighbors. Each message contains data for a single corner node.\n-   The total number of nodal values sent during the halo exchange is the sum over all messages:\n    $$\n    N_{\\text{nodes, halo}} = 6 \\times (30 \\times 30) + 12 \\times 30 + 8 \\times 1 = 6 \\times 900 + 360 + 8 = 5400 + 360 + 8 = 5768 \\text{ nodes}\n    $$\n-   Each node carries $d_{\\text{node}} = 3$ DOFs, and each DOF is a scalar of size $8$ bytes (as implied by the reduction message size).\n-   The total volume of halo exchange data per process is:\n    $$\n    V_{\\text{halo}} = N_{\\text{nodes, halo}} \\times d_{\\text{node}} \\times (\\text{size of scalar}) = 5768 \\times 3 \\times 8 = 138,432 \\text{ bytes}\n    $$\n\n**2.2. Global Reductions**\n\nThe Krylov solver performs $s=3$ global reductions per iteration (e.g., for dot products).\n\n-   The algorithm is a binary-tree all-reduce with $N_{\\text{stages}} = 2 \\lceil \\log_{2}(p) \\rceil$ stages. With $p=64$, $\\log_2(64) = 6$, so $N_{\\text{stages}} = 2 \\times 6 = 12$ stages per reduction.\n-   The problem states that at each stage, each process sends one message. Thus, the number of messages per reduction is $12$.\n-   For $s=3$ reductions, the total number of reduction messages per process is $n_{m, \\text{reduc}} = s \\times N_{\\text{stages}} = 3 \\times 12 = 36$.\n-   At each stage, the message is a single scalar of size $8$ bytes.\n-   The data volume per reduction is $N_{\\text{stages}} \\times 8 = 12 \\times 8 = 96$ bytes.\n-   The total volume for $s=3$ reductions is $V_{\\text{reduc}} = s \\times 96 = 3 \\times 96 = 288$ bytes.\n\n**2.3. Total Communication Costs**\n\nWe can now sum the contributions from halo exchange and global reductions.\n-   Total number of messages per process per iteration:\n    $$\n    n_m = n_{m, \\text{halo}} + n_{m, \\text{reduc}} = 26 + 36 = 62\n    $$\n-   Total data volume sent per process per iteration:\n    $$\n    V = V_{\\text{halo}} + V_{\\text{reduc}} = 138,432 + 288 = 138,720 \\text{ bytes}\n    $$\n-   Using the communication parameters $\\alpha = 2.5 \\times 10^{-6}$ s and $\\beta = 2.5 \\times 10^{-10}$ s/byte:\n    -   Latency cost: $T_{\\text{lat}} = \\alpha n_m = (2.5 \\times 10^{-6}) \\times 62 = 0.000155$ s.\n    -   Bandwidth cost: $T_{\\text{bw}} = \\beta V = (2.5 \\times 10^{-10}) \\times 138,720 = 0.00003468$ s.\n\n3.  **Total Per-Iteration Time**\n\nThe total time $T$ is the sum of the computational and communication components:\n$$\nT = T_{\\text{comp}} + T_{\\text{lat}} + T_{\\text{bw}}\n$$\n$$\nT = 0.019683 + 0.000155 + 0.00003468 = 0.01987268 \\text{ s}\n$$\nThe problem asks for the result to be rounded to four significant figures.\n$$\nT \\approx 0.01987 \\text{ s}\n$$\nIn this model, the computation time ($T_{\\text{comp}} \\approx 19.7$ ms) is dominant, while the latency time ($T_{\\text{lat}} \\approx 0.16$ ms) and bandwidth time ($T_{\\text{bw}} \\approx 0.03$ ms) are significantly smaller. This indicates that for this problem size and machine configuration, the iteration is computation-bound.",
            "answer": "$$\n\\boxed{0.01987}\n$$"
        },
        {
            "introduction": "The true test of a domain decomposition method is its robustness against challenging material properties, such as strong anisotropy. This exercise serves as a case study in diagnosing preconditioner failure, a critical skill for any computational scientist. You will explore how a seemingly reasonable preconditioner can fail and see its condition number degrade, by analyzing the interaction between layered anisotropy and an insufficient coarse space in a BDDC method .",
            "id": "3548024",
            "problem": "Consider antiplane shear elasticity in a two-dimensional rectangular domain $\\Omega = (0,2H)\\times(0,H)$ with $H>0$. Let the out-of-plane displacement be $w:\\Omega\\to\\mathbb{R}$. The constitutive law is orthotropic shear with stiffness tensor $\\mathbf{G}=\\mathrm{diag}(G_{x},G_{y})$ so that the elastic energy of a field $w$ is\n$$\n\\mathcal{E}(w)=\\int_{\\Omega}\\left(G_{x}\\,|\\partial_{x}w|^{2}+G_{y}\\,|\\partial_{y}w|^{2}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nImpose homogeneous Dirichlet boundary conditions $w=0$ on $\\partial\\Omega$.\n\nPartition $\\Omega$ into two nonoverlapping subdomains $\\Omega_{L}=(0,H)\\times(0,H)$ and $\\Omega_{R}=(H,2H)\\times(0,H)$ with the common interface $\\Gamma=\\{H\\}\\times(0,H)$. Consider a layered anisotropy described by the piecewise-constant coefficients\n$$\n(G_{x},G_{y})=\\begin{cases}\n(1,a), & \\text{in }\\Omega_{L},\\\\\n(1,1), & \\text{in }\\Omega_{R},\n\\end{cases}\n$$\nwhere the anisotropy ratio $a\\gg 1$ is a given positive parameter. Assume a conforming piecewise linear finite element discretization that is aligned with the subdomain interface $\\Gamma$.\n\nLet $S$ denote the discrete Schur complement operator on interface degrees of freedom obtained by eliminating the interior unknowns in each subdomain via discrete harmonic extension. Precondition the interface problem with the Balancing Domain Decomposition by Constraints (BDDC) method using only corner primal constraints, that is, enforcing continuity only at the endpoints of $\\Gamma$, and using standard arithmetic averaging on $\\Gamma$; no edge-average constraints are included. Denote the resulting preconditioned operator by $M^{-1}S$ and its spectral condition number by $\\kappa(a)$.\n\nStarting from the variational characterization of discrete harmonic extensions and Rayleigh quotients for symmetric positive definite operators, and using only fundamental inequalities from Sobolev space theory (e.g., trace, Poincaré, and Cauchy–Schwarz inequalities) together with standard properties of BDDC with corner-only constraints, construct an explicit family of interface traces $\\varphi_{a}\\in H_{0}^{1}(0,H)$ (vanishing at the endpoints to be compatible with the corner constraints) whose discrete lifts into $\\Omega_{L}$ and $\\Omega_{R}$ show that $\\kappa(a)$ grows with $a$. Identify the interfacial mode that is poorly controlled by corner-only constraints and explain the mechanism by which the anisotropy amplifies the Rayleigh quotient.\n\nDetermine the asymptotic growth exponent $p$ defined by\n$$\n\\kappa(a)\\sim C\\,a^{p}\\quad\\text{as }a\\to\\infty,\n$$\nfor some constant $C>0$ independent of $a$. Your final answer must be the single real number $p$. No units are required.",
            "solution": "The condition number $\\kappa(M^{-1}S)$ of the preconditioned operator is the ratio of its largest to its smallest eigenvalue, $\\kappa(M^{-1}S) = \\lambda_{\\max}(M^{-1}S) / \\lambda_{\\min}(M^{-1}S)$. The behavior of $\\kappa(a)$ as $a \\to \\infty$ reveals the robustness of the BDDC method with respect to the anisotropy contrast.\n\nThe core of the issue lies in the strong anisotropy in subdomain $\\Omega_L$, which is not properly handled by the specified BDDC preconditioner. The anisotropy is tangential to the interface $\\Gamma$, a configuration known to be challenging for standard domain decomposition methods. The preconditioner uses arithmetic averaging and only corner constraints, both of which are insufficient to counter the effect of the large parameter $a$.\n\nTo analyze the behavior, we can use a scaling argument which transforms the anisotropic problem into an isotropic one on a geometrically distorted domain.\nIn subdomain $\\Omega_L$, the energy functional is:\n$$ \\mathcal{E}_L(w) = \\int_{0}^{H} \\int_{0}^{H} \\left( |\\partial_x w|^2 + a |\\partial_y w|^2 \\right) \\,dx\\,dy $$\nLet's introduce a change of coordinates for $\\Omega_L$:\n$$ (\\tilde{x}, \\tilde{y}) = (x, y/\\sqrt{a}) $$\nUnder this transformation, a function $w(x,y)$ becomes $\\tilde{w}(\\tilde{x}, \\tilde{y}) = w(\\tilde{x}, \\tilde{y}\\sqrt{a})$. The derivatives transform as:\n$$ \\partial_x w = \\partial_{\\tilde{x}} \\tilde{w}, \\quad \\partial_y w = \\frac{1}{\\sqrt{a}} \\partial_{\\tilde{y}} \\tilde{w} $$\nThe Jacobian of this transformation is $dx\\,dy = \\sqrt{a}\\, d\\tilde{x}\\,d\\tilde{y}$.\nThe energy functional in the new coordinates becomes:\n$$ \\mathcal{E}_L(w) = \\int_{\\tilde{\\Omega}_L} \\left( |\\partial_{\\tilde{x}} \\tilde{w}|^2 + a \\left|\\frac{1}{\\sqrt{a}} \\partial_{\\tilde{y}} \\tilde{w}\\right|^2 \\right) \\sqrt{a} \\,d\\tilde{x}\\,d\\tilde{y} \\\\ = \\sqrt{a} \\int_{\\tilde{\\Omega}_L} \\left( |\\partial_{\\tilde{x}} \\tilde{w}|^2 + |\\partial_{\\tilde{y}} \\tilde{w}|^2 \\right) \\,d\\tilde{x}\\,d\\tilde{y} $$\nThe original domain $\\Omega_L = (0,H) \\times (0,H)$ is mapped to the new domain $\\tilde{\\Omega}_L = (0,H) \\times (0, H/\\sqrt{a})$. This is a thin rectangular domain with aspect ratio:\n$$ \\text{Aspect Ratio} = \\frac{\\text{long side}}{\\text{short side}} = \\frac{H}{H/\\sqrt{a}} = \\sqrt{a} $$\nThe subdomain $\\Omega_R$ remains a square of size $H \\times H$, as it is isotropic.\n\nThe original problem is thus equivalent to a scaled isotropic problem on a composite domain $\\tilde{\\Omega}_L \\cup \\Omega_R$, where one subdomain, $\\tilde{\\Omega}_L$, becomes increasingly thin as $a \\to \\infty$. The energy in this subdomain is scaled by $\\sqrt{a}$.\n\nThe performance of domain decomposition methods is highly sensitive to the geometry of the subdomains, particularly to large aspect ratios. For a problem decomposed into subdomains where at least one has a large aspect ratio, the condition number of the preconditioned system often deteriorates. The BDDC method with only corner constraints is not robust for such geometries. The coarse problem, enforcing continuity only at the two corners, is too weak to propagate information effectively across the thin subdomain.\n\nIt is a well-established result in the theory of domain decomposition (e.g., in the analysis of Bramble-Pasciak-Schatz-type methods) that for a strip-like domain of aspect ratio $AR$, the condition number of the preconditioned operator for a two-subdomain decomposition can grow quadratically with the aspect ratio. In our case, the effective aspect ratio of subdomain $\\Omega_L$ is $\\sqrt{a}$.\n\nThe condition number is expected to scale as:\n$$ \\kappa(a) \\sim C \\cdot (\\text{Aspect Ratio})^2 $$\nSubstituting the aspect ratio we found:\n$$ \\kappa(a) \\sim C \\cdot (\\sqrt{a})^2 = C \\cdot a $$\nThis indicates that the exponent $p$ is $1$.\n\nThe interfacial mode that is poorly controlled by the preconditioner corresponds to a function that, in the scaled domain $\\tilde{\\Omega}_L$, varies slowly in the long direction ($\\tilde{x}$) and rapidly in the short direction ($\\tilde{y}$). Translating back to the original coordinates, this is a mode on $\\Gamma$ that exhibits high-frequency oscillations in the $y$-direction. Let's consider a mode like $\\varphi(y) = \\sin(k\\pi y/H)$ for a large wave number $k$. The weak corner-only constraints fail to control such oscillatory modes, and the simple arithmetic averaging does not account for the fact that the stiffness associated with such oscillations is amplified by the factor $a$ in $\\Omega_L$ but not in $\\Omega_R$. This mismatch is what drives the growth of the condition number. The scaling argument precisely captures the effect of this mismatch as a geometric deformation, leading to the quadratic dependence on the aspect ratio.\n\nTherefore, the asymptotic growth exponent is $p=1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "The ultimate goal of domain decomposition research is to design solvers whose performance is independent of problem size or material parameters. This advanced practice showcases such an achievement for a complex poroelasticity problem. By performing a spectral analysis of a physics-based Schur complement preconditioner, you will prove that it yields an optimal, two-iteration convergence for GMRES, demonstrating the profound link between continuous PDE theory and discrete solver performance .",
            "id": "3548004",
            "problem": "Consider one-dimensional consolidation of a homogeneous, isotropic, linearly elastic, saturated porous column occupying $x \\in [0,L]$, with cross-sectional area $A$, Young’s modulus $E$, Biot coefficient $\\alpha$, storage coefficient $c_0$, and hydraulic conductivity $k$. The column is sealed at both ends for fluid flow (homogeneous Neumann boundary conditions for the pore pressure $p$, i.e., $p'(0)=p'(L)=0$) and clamped for mechanics (homogeneous Dirichlet boundary conditions for the displacement $u$, i.e., $u(0)=0$ and $u(L)=0$). The governing equations are the quasi-static linear momentum balance for the skeleton and mass conservation for the pore fluid, with Hooke’s law for mechanics and Darcy’s law for flow. Time discretization uses backward Euler with time step $\\Delta t$, and the spatial discretization uses conforming piecewise-linear finite elements for both $u$ and $p$ on a uniform mesh.\n\nUnder nonoverlapping domain decomposition into two equal subdomains with matching interface at $x=L/2$, consider the algebraic system obtained at a given time step after standard mixed formulation assembly. Eliminating the displacement unknowns $u$ at the algebraic level yields the pressure Schur complement operator $S_p$ acting on the vector of nodal pressures $p$, of the form\n$$\nS_p = c_0 I + \\Delta t\\,K_p \\;+\\; B K^{-1} B^{\\top},\n$$\nwhere $I$ is the identity, $K_p$ is the symmetric positive semidefinite diffusion operator associated with $-\\nabla\\cdot(k \\nabla p)$ under homogeneous Neumann boundary conditions, $K$ is the symmetric positive definite stiffness operator for the clamped bar, and $B$ is the discrete coupling arising from the volumetric strain term $\\alpha \\,\\nabla \\cdot u$ in the mass balance. For the preconditioner, use the symmetric positive definite operator\n$$\n\\mathcal{P} \\;=\\; c_0 I \\;+\\; \\Delta t\\,K_p \\;+\\; \\frac{\\alpha^2}{E} I,\n$$\nwhich corresponds to a block-diagonal approximation frequently used in domain decomposition preconditioning, replacing $B K^{-1} B^{\\top}$ by $\\frac{\\alpha^2}{E} I$.\n\nStarting from the continuous one-dimensional balance laws and boundary conditions specified above, and assuming uniform material properties, derive the exact action of $B K^{-1} B^{\\top}$ on an arbitrary pressure field $p(x)$ and show how it simplifies in this setting. Then, for the fully assembled global pressure space, compute the spectrum of the preconditioned Schur complement operator $\\mathcal{P}^{-1} S_p$. Finally, under the assumption that the initial residual has a nonzero component along the constant-pressure mode, estimate the number of Generalized Minimal Residual (GMRES) iterations required to reduce the Euclidean norm of the residual by a factor of $\\epsilon = 10^{-8}$, independent of the mesh size and the domain decomposition partition. Report only the iteration count as your final answer. No rounding is required.",
            "solution": "### Solution Derivation\nThe problem requires a three-part solution: analyzing the term $B K^{-1} B^{\\top}$, computing the spectrum of the preconditioned operator $\\mathcal{P}^{-1} S_p$, and estimating the GMRES iteration count.\n\n**Part 1: Derivation of the action of $B K^{-1} B^{\\top}$**\n\nThe term $B K^{-1} B^{\\top} p$ represents a sequence of operations that can be interpreted at the continuous PDE level.\n1.  The operator $B^{\\top}$ maps a pressure field $p$ to a force on the solid skeleton. In the weak formulation, the coupling term in the fluid mass balance equation involves $\\int \\alpha (\\nabla \\cdot \\dot{u}) q \\,dx$, while the corresponding term in the momentum balance is $\\int \\alpha p (\\nabla \\cdot v) \\,dx$ where $v$ is the test function for displacement $u$. Integrating by parts gives $\\int (-\\alpha \\nabla p) \\cdot v \\,dx$. Thus, the action of $B^{\\top}$ on $p$ corresponds to applying a body force density of $-\\alpha \\nabla p = -\\alpha p'$.\n2.  The operator $K^{-1}$ is the solution operator for the mechanical problem. Applying $K^{-1}$ to the force from step 1 means solving the static equilibrium equation for the displacement field $u_p$ caused by the pressure $p$. The governing equation for the one-dimensional elastic bar is $-E u'' = f$, where $f$ is the body force density. Here, $f=-\\alpha p'$. So we solve:\n    $$ -E u_p'' = -\\alpha p' \\quad \\text{with B.C.s } u_p(0)=0, u_p(L)=0 $$\n3.  The operator $B$ maps the resulting displacement field $u_p$ back to the fluid mass balance equation via the divergence term $\\alpha \\nabla \\cdot u_p$, which in 1D is $\\alpha u_p'$.\n\nLet's solve the boundary value problem for $u_p$. Integrating $-E u_p'' = -\\alpha p'$ once with respect to $x$ yields:\n$$ -E u_p'(x) = -\\alpha p(x) + C_1 $$\nwhere $C_1$ is an integration constant. Integrating a second time:\n$$ -E u_p(x) = -\\alpha \\int_0^x p(\\xi) \\,d\\xi + C_1 x + C_2 $$\nThe boundary condition $u_p(0)=0$ implies $C_2=0$. Applying the second boundary condition $u_p(L)=0$:\n$$ 0 = -\\alpha \\int_0^L p(\\xi) \\,d\\xi + C_1 L $$\nThis determines the constant $C_1$:\n$$ C_1 = \\frac{\\alpha}{L} \\int_0^L p(\\xi) \\,d\\xi $$\nLet's define the spatial average of the pressure field $p(x)$ as $\\bar{p} = \\frac{1}{L} \\int_0^L p(\\xi) \\,d\\xi$. Then $C_1 = \\alpha \\bar{p}$.\nNow, we find the action of $B K^{-1} B^{\\top}$ by computing $\\alpha u_p'$. From the first integration, we have $u_p'(x) = \\frac{\\alpha}{E} p(x) - \\frac{C_1}{E}$. Substituting $C_1$:\n$$ u_p'(x) = \\frac{\\alpha}{E} p(x) - \\frac{\\alpha \\bar{p}}{E} = \\frac{\\alpha}{E} (p(x) - \\bar{p}) $$\nThe action of the operator is thus multiplication by $\\alpha$, resulting in:\n$$ (B K^{-1} B^{\\top})p = \\alpha u_p' = \\frac{\\alpha^2}{E}(p - \\bar{p}) $$\nThis shows that the operator $B K^{-1} B^{\\top}$ projects the pressure field onto the space of functions with zero mean, scaled by the factor $\\frac{\\alpha^2}{E}$.\n\n**Part 2: Spectrum of the preconditioned operator $\\mathcal{P}^{-1} S_p$**\n\nWe seek the eigenvalues $\\lambda$ of the generalized eigenvalue problem $S_p v = \\lambda \\mathcal{P} v$, where $v$ is a pressure eigenmode.\nUsing the definitions of $S_p$ and $\\mathcal{P}$, and the result from Part 1, we can write the action of the operators on an arbitrary vector $v$:\n$$ S_p v = (c_0 I + \\Delta t K_p)v + \\frac{\\alpha^2}{E}(v - \\bar{v}) $$\n$$ \\mathcal{P} v = (c_0 I + \\Delta t K_p)v + \\frac{\\alpha^2}{E}v $$\nThe analysis is simplified by considering the eigenvectors of the diffusion operator $K_p$. The operator $K_p$ corresponds to $-k \\frac{d^2}{dx^2}$ with homogeneous Neumann boundary conditions $p'(0)=p'(L)=0$. The eigenfunctions and eigenvalues are:\n- The constant mode: $v_0(x) = \\text{const.}$, with corresponding eigenvalue $\\mu_0 = 0$. For this mode, $\\bar{v}_0 = v_0$.\n- The non-constant modes: $v_n(x) = \\cos\\left(\\frac{n\\pi x}{L}\\right)$ for $n=1, 2, 3, \\ldots$, with eigenvalues $\\mu_n = k \\left(\\frac{n\\pi}{L}\\right)^2$. For these modes, $\\bar{v}_n = \\frac{1}{L}\\int_0^L \\cos\\left(\\frac{n\\pi x}{L}\\right) dx = 0$.\n\nThe discrete eigenvectors of the finite element matrix $K_p$ on a uniform mesh are discrete samplings of these continuous eigenfunctions. We can analyze the spectrum of $\\mathcal{P}^{-1} S_p$ by examining its action on these eigenvectors.\n\nCase 1: The constant eigenmode $v_0$.\nFor this mode, $\\bar{v}_0 = v_0$, which implies $v_0 - \\bar{v}_0 = 0$. Also, $K_p v_0 = \\mu_0 v_0 = 0$.\nThe action of $S_p$ on $v_0$ is:\n$$ S_p v_0 = (c_0 I + 0)v_0 + \\frac{\\alpha^2}{E}(0) = c_0 v_0 $$\nThe action of $\\mathcal{P}$ on $v_0$ is:\n$$ \\mathcal{P} v_0 = (c_0 I + 0)v_0 + \\frac{\\alpha^2}{E}v_0 = \\left(c_0 + \\frac{\\alpha^2}{E}\\right)v_0 $$\nThe eigenvalue equation $S_p v_0 = \\lambda_0 \\mathcal{P} v_0$ becomes:\n$$ c_0 v_0 = \\lambda_0 \\left(c_0 + \\frac{\\alpha^2}{E}\\right)v_0 $$\nSolving for the eigenvalue $\\lambda_0$:\n$$ \\lambda_0 = \\frac{c_0}{c_0 + \\frac{\\alpha^2}{E}} $$\n\nCase 2: The non-constant eigenmodes $v_n$ for $n \\ge 1$.\nFor these modes, $\\bar{v}_n = 0$, which implies $v_n - \\bar{v}_n = v_n$.\nThe action of $S_p$ on $v_n$ is:\n$$ S_p v_n = (c_0 I + \\Delta t K_p)v_n + \\frac{\\alpha^2}{E}v_n = \\left( (c_0 + \\frac{\\alpha^2}{E})I + \\Delta t K_p \\right)v_n $$\nThe action of $\\mathcal{P}$ on $v_n$ is:\n$$ \\mathcal{P} v_n = (c_0 I + \\Delta t K_p)v_n + \\frac{\\alpha^2}{E}v_n = \\left( (c_0 + \\frac{\\alpha^2}{E})I + \\Delta t K_p \\right)v_n $$\nWe observe that for any $n \\ge 1$, $S_p v_n = \\mathcal{P} v_n$. The eigenvalue equation $S_p v_n = \\lambda_n \\mathcal{P} v_n$ becomes:\n$$ \\mathcal{P} v_n = \\lambda_n \\mathcal{P} v_n $$\nSince $\\mathcal{P}$ is symmetric positive definite, $\\mathcal{P} v_n$ is not the zero vector. Thus, we can conclude that for all $n \\ge 1$:\n$$ \\lambda_n = 1 $$\n\nThe spectrum of the preconditioned operator $\\mathcal{P}^{-1} S_p$ therefore consists of exactly two distinct eigenvalues: $\\left\\{ \\frac{c_0}{c_0 + \\alpha^2/E}, 1 \\right\\}$. This result is independent of the mesh size, as the analysis holds for the entire family of eigenmodes.\n\n**Part 3: GMRES Iteration Count**\n\nThe Generalized Minimal Residual (GMRES) method is an iterative algorithm for solving a system of linear equations $Ax=b$. A fundamental property of GMRES is that if the matrix $A$ has only $m$ distinct eigenvalues, the algorithm is guaranteed to converge to the exact solution in at most $m$ iterations (assuming exact arithmetic).\n\nIn our problem, the preconditioned system is $\\mathcal{P}^{-1} S_p p = \\mathcal{P}^{-1} f$, so the matrix of the iterative system is $A = \\mathcal{P}^{-1} S_p$. From Part 2, we have established that this matrix has exactly $m=2$ distinct eigenvalues.\n\nThe problem states that the initial residual has a nonzero component along the constant-pressure mode (the eigenvector $v_0$ corresponding to $\\lambda_0$) and, implicitly, components along other modes (the eigenspace corresponding to $\\lambda=1$). If the initial residual were entirely within one eigenspace, convergence would take 1 iteration. Since its components span both eigenspaces, the minimal polynomial of $A$ with respect to the initial residual has degree $2$. Consequently, GMRES will require exactly $2$ iterations to find the solution that makes the residual zero.\n\nThe requirement is to reduce the residual norm by a factor of $\\epsilon = 10^{-8}$. Since GMRES converges to the exact solution (and thus a zero residual) in $2$ steps, this condition is met after the second iteration. The number of iterations is therefore independent of the mesh size and the material parameters, as long as the problem structure remains the same. The mention of domain decomposition is contextual for the choice of the preconditioner structure but does not affect the global spectral analysis performed here.\n\nThe number of GMRES iterations required is $2$.",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}