{
    "hands_on_practices": [
        {
            "introduction": "在并行计算中，性能预测是评估和优化算法效率的关键步骤。本练习旨在通过一个实际的线性弹性问题，让学生从第一性原理出发，构建一个经典的并行性能模型。通过亲手推导和计算每个处理器上的计算负载、通信消息数量和数据传输总量()，学生将深入理解并行有限元方法中计算、通信延迟和带宽成本之间的权衡关系，为设计可扩展的求解器奠定定量分析的基础。",
            "id": "3548064",
            "problem": "考虑一个在单位立方体上的准静态、小应变线性弹性问题，该问题在大小为 $120 \\times 120 \\times 120$ 的结构化节点网格上使用三线性六面体有限元进行离散化。每个节点带有 $3$ 个位移分量，因此每个节点贡献 $3$ 个自由度 (DOF)。全局刚度矩阵以标量形式组装，其块稀疏模式将每个节点耦合到其 $3 \\times 3 \\times 3$ 邻域中的所有节点，每行平均产生 $81$ 个非零元（每个 $3 \\times 3$ 块在一行中贡献 $3$ 个标量非零元，每行有 $27$ 个这样的块）。该域通过规则、不重叠的区域分解被划分到 $p=64$ 个进程上，这些进程排列成一个 $4 \\times 4 \\times 4$ 的子域笛卡尔网格。假设负载完美平衡，即每个子域包含完全相同数量的节点和自由度。一次 Krylov 迭代（例如，共轭梯度法 (CG) 或广义最小残差法 (GMRES)）执行一次稀疏矩阵向量乘积 (SpMV) 和一次单层 halo 交换，并执行 $s=3$ 次全局归约。halo 交换与所有 $26$ 个邻居（面、边、角）通信，每次迭代每个邻居发送一条消息，halo 层宽度为一个节点。对于全体归约 (all-reductions)，假设采用二叉树算法，每次全体归约有 $2 \\lceil \\log_{2}(p) \\rceil$ 个阶段，在每个阶段，每个进程发送和接收一个大小为 $8$ 字节的标量。\n\n假设使用以下机器模型和常数：\n- 消息延迟 $\\alpha = 2.5 \\times 10^{-6}$ s（秒/消息）。\n- 逆带宽 $\\beta = 2.5 \\times 10^{-10}$ s/byte（秒/字节）。\n- 稀疏矩阵向量乘积成本 $\\gamma = 3.0 \\times 10^{-9}$ s/非零元（秒/非零元）。\n\n使用 alpha-beta 通信模型（发送一个 $m$ 字节消息的时间为 $\\alpha + \\beta m$），并从第一性原理（用于 halo 体积和消息计数的区域分解几何形状，以及稀疏矩阵向量乘积成本的定义）出发，推导单次迭代时间的表达式\n$$\nT \\approx \\gamma\\, n_{nz} + \\alpha\\, n_{m} + \\beta\\, V,\n$$\n通过明确确定以下三个量：$n_{nz}$（每个进程的非零元数）、$n_{m}$（每次迭代中每个进程的消息总数，包括 halo 交换和归约）以及 $V$（每次迭代中每个进程通信的总字节数，包括 halo 交换和归约）。在推导过程中，根据给定的设置，清楚地解释表达式中每一项的物理和算法意义。然后，对 $T$进行数值计算。最终时间以秒表示，并将答案四舍五入到四位有效数字。",
            "solution": "任务是推导并评估并行有限元求解器单次迭代时间的性能模型。该模型为 $T \\approx \\gamma\\, n_{nz} + \\alpha\\, n_{m} + \\beta\\, V$。我们的目标是根据问题描述，从第一性原理确定 $n_{nz}$、$n_{m}$ 和 $V$ 这三个量，然后计算总时间 $T$。单次迭代的总时间是三个部分的和：稀疏矩阵向量乘积 (SpMV) 的计算时间、通信延迟和通信带宽成本。\n\n我们分别分析每个组成部分。\n\n1.  **计算时间: $T_{comp} = \\gamma n_{nz}$**\n\n该项代表浮点运算所花费的时间。对于 Krylov 求解器，每次迭代的主要计算成本是 SpMV 操作。该成本被建模为与单个进程处理的刚度矩阵局部部分的非零元数量成正比。\n\n-   全局计算域是一个包含 $N_{global} = 120 \\times 120 \\times 120 = 1,728,000$ 个节点的结构化网格。\n-   每个节点有 $d_{node} = 3$ 个自由度 (DOF)。\n-   系统中的总自由度数为 $N_{DOF, global} = N_{global} \\times d_{node} = 1,728,000 \\times 3 = 5,184,000$。这也是全局刚度矩阵的行数。\n-   问题陈述，标量组装的矩阵平均每行有 $k_{row} = 81$ 个非零元。\n-   全局刚度矩阵中的非零元总数为 $NNZ_{global} = N_{DOF, global} \\times k_{row} = 5,184,000 \\times 81 = 419,904,000$。\n-   该域被划分到 $p=64$ 个进程中。假设负载完美平衡，非零元被均匀分布。\n-   每个进程的非零元数量 $n_{nz}$ 为：\n    $$\n    n_{nz} = \\frac{NNZ_{global}}{p} = \\frac{419,904,000}{64} = 6,561,000\n    $$\n-   每个非零元的成本为 $\\gamma = 3.0 \\times 10^{-9}$ s。\n-   每次迭代每个进程的计算时间为：\n    $$\n    T_{comp} = \\gamma n_{nz} = (3.0 \\times 10^{-9}) \\times 6,561,000 = 0.019683 \\text{ s}\n    $$\n\n2.  **通信时间: $T_{comm} = \\alpha n_m + \\beta V$**\n\n该项代表进程间通信所花费的时间，包括两部分：SpMV 操作的 halo 交换和 Krylov 求解器的全局归约。我们必须确定每个进程发送的消息总数 $n_m$ 和发送的数据总量 $V$。\n\n**2.1. Halo 交换**\n\n需要进行 halo 交换来通信位于子域边界上的自由度的节点数据。其成本取决于子域的几何形状和通信模式。\n\n-   $120 \\times 120 \\times 120$ 的全局节点网格被划分到 $p_x \\times p_y \\times p_z = 4 \\times 4 \\times 4$ 的笛卡尔进程网格上。\n-   每个进程被分配一个大小为 $n_x \\times n_y \\times n_z$ 的子域，其中 $n_x = 120/4 = 30$，$n_y = 120/4 = 30$，$n_z = 120/4 = 30$ 个节点。\n-   我们对一个具有 $3^3 - 1 = 26$ 个邻居（6个面、12条边、8个角）的代表性内部进程的通信进行建模。问题陈述该进程与所有 $26$ 个邻居通信，向每个邻居发送一条消息。\n-   因此，halo 交换的消息数量为 $n_{m, halo} = 26$。\n-   发送的数据量是这 $26$ 条消息负载的总和。交换的是单层节点。\n    -   **面消息：**向面邻居发送 $6$ 条消息。每条消息包含子域一个面上的节点数据。一个面的大小为 $30 \\times 30 = 900$ 个节点。\n    -   **边消息：**向边邻居发送 $12$ 条消息。每条消息包含子域一条边上的节点数据。一条边的大小为 $30$ 个节点。\n    -   **角消息：**向角邻居发送 $8$ 条消息。每条消息包含一个角节点的数据。\n-   在 halo 交换期间发送的节点值总数为所有消息的总和：\n    $$\n    N_{nodes, halo} = 6 \\times (30 \\times 30) + 12 \\times 30 + 8 \\times 1 = 6 \\times 900 + 360 + 8 = 5400 + 360 + 8 = 5768 \\text{ 节点}\n    $$\n-   每个节点带有 $d_{node} = 3$ 个自由度，每个自由度是一个大小为 $8$ 字节的标量（由归约消息的大小推断）。\n-   每个进程的 halo 交换数据总量为：\n    $$\n    V_{halo} = N_{nodes, halo} \\times d_{node} \\times (\\text{标量大小}) = 5768 \\times 3 \\times 8 = 138,432 \\text{ 字节}\n    $$\n\n**2.2. 全局归约**\n\nKrylov 求解器每次迭代执行 $s=3$ 次全局归约（例如，用于点积）。\n\n-   该算法是二叉树全体归约 (all-reduce)，每个归约有 $N_{stages} = 2 \\lceil \\log_{2}(p) \\rceil$ 个阶段。当 $p=64$ 时，$\\log_2(64) = 6$，所以每次归约有 $N_{stages} = 2 \\times 6 = 12$ 个阶段。\n-   问题陈述在每个阶段，每个进程发送一条消息。因此，每次归约的消息数量为 $12$。\n-   对于 $s=3$ 次归约，每个进程的归约消息总数为 $n_{m, reduc} = s \\times N_{stages} = 3 \\times 12 = 36$。\n-   在每个阶段，消息是一个大小为 $8$ 字节的标量。\n-   每次归约的数据量为 $N_{stages} \\times 8 = 12 \\times 8 = 96$ 字节。\n-   $s=3$ 次归约的总数据量为 $V_{reduc} = s \\times 96 = 3 \\times 96 = 288$ 字节。\n\n**2.3. 总通信成本**\n\n现在我们可以将 halo 交换和全局归约的贡献相加。\n-   每次迭代每个进程的消息总数：\n    $$\n    n_m = n_{m, halo} + n_{m, reduc} = 26 + 36 = 62\n    $$\n-   每次迭代每个进程发送的总数据量：\n    $$\n    V = V_{halo} + V_{reduc} = 138,432 + 288 = 138,720 \\text{ 字节}\n    $$\n-   使用通信参数 $\\alpha = 2.5 \\times 10^{-6}$ s 和 $\\beta = 2.5 \\times 10^{-10}$ s/byte：\n    -   延迟成本: $T_{lat} = \\alpha n_m = (2.5 \\times 10^{-6}) \\times 62 = 0.000155$ s。\n    -   带宽成本: $T_{bw} = \\beta V = (2.5 \\times 10^{-10}) \\times 138,720 = 0.00003468$ s。\n\n3.  **单次迭代总时间**\n\n总时间 $T$ 是计算和通信部分的总和：\n$$\nT = T_{comp} + T_{lat} + T_{bw}\n$$\n$$\nT = 0.019683 + 0.000155 + 0.00003468 = 0.01987268 \\text{ s}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\nT \\approx 0.01987 \\text{ s}\n$$\n在此模型中，计算时间（$T_{comp} \\approx 19.7$ ms）占主导地位，而延迟时间（$T_{lat} \\approx 0.16$ ms）和带宽时间（$T_{bw} \\approx 0.03$ ms）则小得多。这表明对于此问题规模和机器配置，迭代是计算密集型的。",
            "answer": "$$\n\\boxed{0.01987}\n$$"
        },
        {
            "introduction": "当转向更复杂的多物理场问题时，迭代求解器的收敛性成为核心挑战，而这正是高级预条件技术大显身手的领域。本练习以一个典型的土力学问题——一维固结问题——为例，深入剖析了基于舒尔补的预条件算子的谱特性。通过对一个特定预条件算子 $\\mathcal{P}$ 进行严格的数学分析()，您将揭示为何它能将预条件系统的特征值压缩到仅有的两个点上，从而实现与网格无关的、在两次迭代内收敛的卓越性能。",
            "id": "3548004",
            "problem": "考虑一个占据 $x \\in [0,L]$ 的均质、各向同性、线性弹性、饱和多孔柱的一维固结问题。该柱的横截面积为 $A$，杨氏模量为 $E$，Biot 系数为 $\\alpha$，储水系数为 $c_0$，导水系数为 $k$。柱的两端对流体流动是封闭的（孔隙压力 $p$ 满足齐次 Neumann 边界条件，即 $p'(0)=p'(L)=0$），在力学上是固支的（位移 $u$ 满足齐次 Dirichlet 边界条件，即 $u(0)=0$ 和 $u(L)=0$）。控制方程为骨架的准静态线性动量平衡方程和孔隙流体的质量守恒方程，其中力学部分使用 Hooke 定律，流动部分使用 Darcy 定律。时间离散化采用时间步长为 $\\Delta t$ 的后向欧拉法，空间离散化在均匀网格上对 $u$ 和 $p$ 均使用协调的分片线性有限元。\n\n在将区域无重叠地分解为两个相等的子区域（匹配界面位于 $x=L/2$）的情况下，考虑在给定时间步下，通过标准混合格式组装得到的代数系统。在代数层面消去位移未知量 $u$，可以得到作用于节点压力向量 $p$ 的压力 Schur 补算子 $S_p$，其形式为\n$$\nS_p = c_0 I + \\Delta t\\,K_p \\;+\\; B K^{-1} B^{\\top},\n$$\n其中 $I$ 是单位矩阵，$K_p$ 是与齐次 Neumann 边界条件下的 $-\\nabla\\cdot(k \\nabla p)$ 相关联的对称半正定扩散算子，$K$ 是固支杆的对称正定刚度算子，$B$ 是由质量平衡方程中的体应变项 $\\alpha \\,\\nabla \\cdot u$ 产生的离散耦合算子。对于预条件子，使用对称正定算子\n$$\n\\mathcal{P} \\;=\\; c_0 I \\;+\\; \\Delta t\\,K_p \\;+\\; \\frac{\\alpha^2}{E} I,\n$$\n这对应于区域分解预处理中常用的一种块对角近似，即用 $\\frac{\\alpha^2}{E} I$ 替换 $B K^{-1} B^{\\top}$。\n\n从上述指定的连续一维平衡律和边界条件出发，并假设材料属性是均匀的，推导 $B K^{-1} B^{\\top}$ 对任意压力场 $p(x)$ 的精确作用，并说明其在这种设置下如何简化。然后，对于完全组装的全局压力空间，计算预处理后的 Schur 补算子 $\\mathcal{P}^{-1} S_p$ 的谱。最后，在初始残差沿恒压模式有非零分量的假设下，估计将残差的欧几里得范数减小一个因子 $\\epsilon = 10^{-8}$ 所需的广义最小残差（GMRES）迭代次数，该次数应独立于网格尺寸和区域分解划分。最终答案仅报告迭代次数，无需四舍五入。",
            "solution": "首先评估问题陈述的有效性。\n\n### 第 1 步：提取已知条件\n- **区域**：一维柱，$x \\in [0,L]$。\n- **物理背景**：均质、各向同性、线性弹性、饱和多孔介质。准静态线性多孔弹性。\n- **材料属性**：杨氏模量 $E$、Biot 系数 $\\alpha$、储水系数 $c_0$、导水系数 $k$。均为常数。\n- **控制变量**：位移 $u(x,t)$，孔隙压力 $p(x,t)$。\n- **边界条件 (BCs)**：\n    - 力学：两端固支，$u(0,t)=0$ 和 $u(L,t)=0$ (齐次 Dirichlet)。\n    - 水力学：两端封闭，$p'(0,t)=0$ 和 $p'(L,t)=0$ (齐次 Neumann)。注意：$p'$ 表示 $\\frac{\\partial p}{\\partial x}$。\n- **离散化**：\n    - 时间：后向欧拉法，时间步长为 $\\Delta t$。\n    - 空间：在均匀网格上对 $u$ 和 $p$ 均使用协调的分片线性有限元。\n- **区域分解 (DD)**：无重叠区域分解为两个相等的子区域，界面在 $x=L/2$。\n- **代数系统**：问题涉及混合有限元格式的代数系统。\n- **压力 Schur 补算子**：$S_p = c_0 I + \\Delta t\\,K_p + B K^{-1} B^{\\top}$。\n    - $I$：单位矩阵。\n    - $K_p$：来自 $-\\nabla\\cdot(k \\nabla p)$ 在齐次 Neumann 边界条件下的对称半正定扩散算子。\n    - $K$：固支杆的对称正定刚度算子。\n    - $B$：来自体应变项 $\\alpha \\,\\nabla \\cdot u$ 的离散耦合算子。\n- **预条件子**：$\\mathcal{P} = c_0 I + \\Delta t\\,K_p + \\frac{\\alpha^2}{E} I$。\n- **目标**：\n    1. 推导 $B K^{-1} B^{\\top}$ 对任意压力场 $p(x)$ 的精确作用。\n    2. 计算预处理算子 $\\mathcal{P}^{-1} S_p$ 的谱。\n    3. 估计将残差范数减小 $\\epsilon = 10^{-8}$ 所需的 GMRES 迭代次数。\n- **假设**：\n    - 初始残差沿恒压模式有非零分量。\n    - GMRES 迭代次数的估计应独立于网格尺寸和区域分解划分。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于 Biot 的多孔弹性理论，这是地质力学和多孔介质物理学的基石。控制方程、本构律（Hooke 定律、Darcy 定律）和边界条件都是标准的且物理上合理的。数值方法（有限元法 FEM、后向欧拉法、Schur 补）是解决此类问题的标准方法。该问题不违反任何科学原理。\n- **适定性**：问题提供了所有必要的定义和条件。力学和流动的边界条件都定义明确，从而构成一个适定的数学问题。目标陈述清晰，要求进行特定的推导和计算。\n- **客观性**：语言精确、正式，没有任何主观或基于意见的陈述。所有术语都在计算力学的背景下定义。\n- **其他检查**：问题不是不完整、矛盾、不切实际、不适定或微不足道的。提及区域分解为所选预条件子的特定形式提供了背景，但核心分析是在完全组装的全局系统上进行的，这是一种有效的方法。该问题是偏微分方程数值方法分析中一项具有挑战性但正式的练习。\n\n### 第 3 步：结论和行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n问题要求一个三部分的解答：分析项 $B K^{-1} B^{\\top}$，计算预处理算子 $\\mathcal{P}^{-1} S_p$ 的谱，以及估计 GMRES 迭代次数。\n\n**第 1 部分：$B K^{-1} B^{\\top}$ 作用的推导**\n\n项 $B K^{-1} B^{\\top} p$ 代表了一系列可以在连续偏微分方程（PDE）层面解释的操作。\n1.  算子 $B^{\\top}$ 将压力场 $p$ 映射到固体骨架上的一个力。在弱形式中，流体质量平衡方程中的耦合项涉及 $\\int \\alpha (\\nabla \\cdot \\dot{u}) q \\,dx$，而动量平衡中的相应项是 $\\int \\alpha p (\\nabla \\cdot v) \\,dx$，其中 $v$ 是位移 $u$ 的检验函数。分部积分得到 $\\int (-\\alpha \\nabla p) \\cdot v \\,dx$。因此，$B^{\\top}$ 对 $p$ 的作用对应于施加一个体力密度 $-\\alpha \\nabla p = -\\alpha p'$。\n2.  算子 $K^{-1}$ 是力学问题的解算子。将 $K^{-1}$ 应用于第 1 步中的力，意味着求解由压力 $p$ 引起的位移场 $u_p$ 的静态平衡方程。一维弹性杆的控制方程为 $-E u'' = f$，其中 $f$ 是体力密度。这里，$f=-\\alpha p'$。所以我们求解：\n    $$ -E u_p'' = -\\alpha p' \\quad \\text{边界条件为 } u_p(0)=0, u_p(L)=0 $$\n3.  算子 $B$ 通过散度项 $\\alpha \\nabla \\cdot u_p$（在一维中为 $\\alpha u_p'$）将产生的位移场 $u_p$ 映射回流体质量平衡方程。\n\n让我们求解 $u_p$ 的边值问题。将 $-E u_p'' = -\\alpha p'$ 对 $x$ 积分一次得到：\n$$ -E u_p'(x) = -\\alpha p(x) + C_1 $$\n其中 $C_1$ 是一个积分常数。再次积分：\n$$ -E u_p(x) = -\\alpha \\int_0^x p(\\xi) \\,d\\xi + C_1 x + C_2 $$\n边界条件 $u_p(0)=0$ 意味着 $C_2=0$。应用第二个边界条件 $u_p(L)=0$：\n$$ 0 = -\\alpha \\int_0^L p(\\xi) \\,d\\xi + C_1 L $$\n这确定了常数 $C_1$：\n$$ C_1 = \\frac{\\alpha}{L} \\int_0^L p(\\xi) \\,d\\xi $$\n让我们定义压力场 $p(x)$ 的空间平均值为 $\\bar{p} = \\frac{1}{L} \\int_0^L p(\\xi) \\,d\\xi$。那么 $C_1 = \\alpha \\bar{p}$。\n现在，我们通过计算 $\\alpha u_p'$ 来找到 $B K^{-1} B^{\\top}$ 的作用。从第一次积分我们得到 $u_p'(x) = \\frac{\\alpha}{E} p(x) - \\frac{C_1}{E}$。代入 $C_1$：\n$$ u_p'(x) = \\frac{\\alpha}{E} p(x) - \\frac{\\alpha \\bar{p}}{E} = \\frac{\\alpha}{E} (p(x) - \\bar{p}) $$\n因此，算子的作用是乘以 $\\alpha$，得到：\n$$ (B K^{-1} B^{\\top})p = \\alpha u_p' = \\frac{\\alpha^2}{E}(p - \\bar{p}) $$\n这表明算子 $B K^{-1} B^{\\top}$ 将压力场投影到零均值函数的空间上，并按因子 $\\frac{\\alpha^2}{E}$ 进行缩放。\n\n**第 2 部分：预处理算子 $\\mathcal{P}^{-1} S_p$ 的谱**\n\n我们寻求广义特征值问题 $S_p v = \\lambda \\mathcal{P} v$ 的特征值 $\\lambda$，其中 $v$ 是一个压力本征模。\n使用 $S_p$ 和 $\\mathcal{P}$ 的定义以及第 1 部分的结果，我们可以写出算子对任意向量 $v$ 的作用：\n$$ S_p v = (c_0 I + \\Delta t K_p)v + \\frac{\\alpha^2}{E}(v - \\bar{v}) $$\n$$ \\mathcal{P} v = (c_0 I + \\Delta t K_p)v + \\frac{\\alpha^2}{E}v $$\n通过考虑扩散算子 $K_p$ 的特征向量，可以简化分析。算子 $K_p$ 对应于 $-k \\frac{d^2}{dx^2}$，并带有齐次 Neumann 边界条件 $p'(0)=p'(L)=0$。其特征函数和特征值为：\n- 常数模式：$v_0(x) = \\text{const.}$，对应的特征值为 $\\mu_0 = 0$。对于此模式，$\\bar{v}_0 = v_0$。\n- 非常数模式：$v_n(x) = \\cos\\left(\\frac{n\\pi x}{L}\\right)$，对于 $n=1, 2, 3, \\ldots$，特征值为 $\\mu_n = k \\left(\\frac{n\\pi}{L}\\right)^2$。对于这些模式，$\\bar{v}_n = \\frac{1}{L}\\int_0^L \\cos\\left(\\frac{n\\pi x}{L}\\right) dx = 0$。\n\n均匀网格上有限元矩阵 $K_p$ 的离散特征向量是这些连续特征函数的离散采样。我们可以通过检查 $\\mathcal{P}^{-1} S_p$ 在这些特征向量上的作用来分析其谱。\n\n情况 1：常数本征模 $v_0$。\n对于此模式，$\\bar{v}_0 = v_0$，这意味着 $v_0 - \\bar{v}_0 = 0$。同时，$K_p v_0 = \\mu_0 v_0 = 0$。\n$S_p$ 对 $v_0$ 的作用是：\n$$ S_p v_0 = (c_0 I + 0)v_0 + \\frac{\\alpha^2}{E}(0) = c_0 v_0 $$\n$\\mathcal{P}$ 对 $v_0$ 的作用是：\n$$ \\mathcal{P} v_0 = (c_0 I + 0)v_0 + \\frac{\\alpha^2}{E}v_0 = \\left(c_0 + \\frac{\\alpha^2}{E}\\right)v_0 $$\n特征值方程 $S_p v_0 = \\lambda_0 \\mathcal{P} v_0$ 变为：\n$$ c_0 v_0 = \\lambda_0 \\left(c_0 + \\frac{\\alpha^2}{E}\\right)v_0 $$\n求解特征值 $\\lambda_0$：\n$$ \\lambda_0 = \\frac{c_0}{c_0 + \\frac{\\alpha^2}{E}} $$\n\n情况 2：$n \\ge 1$ 的非常数本征模 $v_n$。\n对于这些模式，$\\bar{v}_n = 0$，这意味着 $v_n - \\bar{v}_n = v_n$。\n$S_p$ 对 $v_n$ 的作用是：\n$$ S_p v_n = (c_0 I + \\Delta t K_p)v_n + \\frac{\\alpha^2}{E}v_n = \\left( (c_0 + \\frac{\\alpha^2}{E})I + \\Delta t K_p \\right)v_n $$\n$\\mathcal{P}$ 对 $v_n$ 的作用是：\n$$ \\mathcal{P} v_n = (c_0 I + \\Delta t K_p)v_n + \\frac{\\alpha^2}{E}v_n = \\left( (c_0 + \\frac{\\alpha^2}{E})I + \\Delta t K_p \\right)v_n $$\n我们观察到对于任何 $n \\ge 1$，$S_p v_n = \\mathcal{P} v_n$。特征值方程 $S_p v_n = \\lambda_n \\mathcal{P} v_n$ 变为：\n$$ \\mathcal{P} v_n = \\lambda_n \\mathcal{P} v_n $$\n由于 $\\mathcal{P}$ 是对称正定的，$\\mathcal{P} v_n$ 不是零向量。因此，我们可以得出结论，对于所有 $n \\ge 1$：\n$$ \\lambda_n = 1 $$\n\n因此，预处理算子 $\\mathcal{P}^{-1} S_p$ 的谱仅包含两个不同的特征值：$\\left\\{ \\frac{c_0}{c_0 + \\alpha^2/E}, 1 \\right\\}$。这个结果独立于网格尺寸，因为该分析对整个本征模族都成立。\n\n**第 3 部分：GMRES 迭代次数**\n\n广义最小残差（GMRES）法是求解线性方程组 $Ax=b$ 的一种迭代算法。GMRES 的一个基本性质是，如果矩阵 $A$ 只有 $m$ 个不同的特征值，该算法保证在最多 $m$ 次迭代内收敛到精确解（假设使用精确算术）。\n\n在我们的问题中，预处理系统是 $\\mathcal{P}^{-1} S_p p = \\mathcal{P}^{-1} f$，所以迭代系统的矩阵是 $A = \\mathcal{P}^{-1} S_p$。从第 2 部分我们已经确定，该矩阵恰好有 $m=2$ 个不同的特征值。\n\n问题陈述，初始残差在恒压模式（对应于 $\\lambda_0$ 的特征向量 $v_0$）上有非零分量，并且隐含地在其他模式（对应于 $\\lambda=1$ 的特征空间）上也有分量。如果初始残差完全位于一个特征空间内，收敛将需要 1 次迭代。由于其分量张成了两个特征空间，因此 $A$ 相对于初始残差的最小多项式次数为 2。因此，GMRES 将需要恰好 2 次迭代来找到使残差为零的解。\n\n要求是将残差范数减小一个因子 $\\epsilon = 10^{-8}$。由于 GMRES 在 2 步内收敛到精确解（从而使残差为零），这个条件在第二次迭代后即得到满足。因此，迭代次数独立于网格尺寸和材料参数，只要问题结构保持不变。提及区域分解是为了说明预条件子结构选择的背景，但它不影响此处进行的全局谱分析。\n\n所需的 GMRES 迭代次数为 2。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "尽管精心设计的预条件子可以实现理想的收敛效果，但在面对材料属性的极端变化时，它们的鲁棒性会受到严峻考验。本练习探讨了区域分解方法的一个经典挑战：当材料存在强各向异性时，标准预条件子的性能会如何退化。通过分析一个具有层状各向异性的抗平面剪切问题()，您将学习如何运用缩放变换和变分原理来揭示预条件系统条件数与各向异性比率 $a$ 之间的增长关系，从而理解为何简单的约束（如仅包含角点约束的BDDC方法）不足以应对这种挑战。",
            "id": "3548024",
            "problem": "考虑一个二维矩形域 $\\Omega = (0,2H)\\times(0,H)$（其中 $H>0$）中的反平面剪切弹性问题。设平面外位移为 $w:\\Omega\\to\\mathbb{R}$。本构关系为正交各向异性剪切，其刚度张量为 $\\mathbf{G}=\\mathrm{diag}(G_{x},G_{y})$，因此场 $w$ 的弹性势能为\n$$\n\\mathcal{E}(w)=\\int_{\\Omega}\\left(G_{x}\\,|\\partial_{x}w|^{2}+G_{y}\\,|\\partial_{y}w|^{2}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n在边界 $\\partial\\Omega$ 上施加齐次 Dirichlet 边界条件 $w=0$。\n\n将 $\\Omega$ 分割为两个不重叠的子域 $\\Omega_{L}=(0,H)\\times(0,H)$ 和 $\\Omega_{R}=(H,2H)\\times(0,H)$，其公共界面为 $\\Gamma=\\{H\\}\\times(0,H)$。考虑由分段常数系数描述的层状各向异性\n$$\n(G_{x},G_{y})=\\begin{cases}\n(1,a),  \\text{in }\\Omega_{L},\\\\\n(1,1),  \\text{in }\\Omega_{R},\n\\end{cases}\n$$\n其中各向异性比 $a\\gg 1$ 是一个给定的正参数。假设采用与子域界面 $\\Gamma$ 对齐的协调分片线性有限元离散化方法。\n\n令 $S$ 表示通过离散调和延拓消除每个子域内部未知量而得到的界面自由度上的离散 Schur 补算子。使用带约束的平衡区域分解 (BDDC) 方法对界面问题进行预处理，其中仅使用角点原始约束，即仅在 $\\Gamma$ 的端点处强制连续性，并在 $\\Gamma$ 上使用标准算术平均；不包括边平均约束。将得到的预处理算子记为 $M^{-1}S$，其谱条件数记为 $\\kappa(a)$。\n\n从离散调和延拓的变分特征和对称正定算子的 Rayleigh 商出发，并仅使用 Sobolev 空间理论中的基本不等式（例如，迹不等式、Poincaré 不等式和 Cauchy–Schwarz 不等式）以及带角点约束的 BDDC 的标准性质，构造一个显式的界面迹族 $\\varphi_{a}\\in H_{0}^{1}(0,H)$（在端点处为零以与角点约束兼容），其在 $\\Omega_{L}$ 和 $\\Omega_{R}$ 中的离散提升表明 $\\kappa(a)$ 随 $a$ 增长。识别出仅由角点约束控制不佳的界面模态，并解释各向异性放大 Rayleigh 商的机理。\n\n确定由下式定义的渐近增长指数 $p$\n$$\n\\kappa(a)\\sim C\\,a^{p}\\quad\\text{as }a\\to\\infty,\n$$\n其中 $C>0$ 是一个与 $a$ 无关的常数。您的最终答案必须是单个实数 $p$。不需要单位。",
            "solution": "用户希望确定一个带有层状正交各向异性的反平面剪切问题的 BDDC 预处理系统的条件数 $\\kappa(a)$ 的渐近增长情况。\n\n### 步骤 1：问题陈述验证\n\n该问题是计算力学和数值分析领域中一个适定且有科学依据的模型问题，特别涉及偏微分方程的区域分解方法。\n\n- **已知条件**：\n    - 区域：$\\Omega = (0,2H)\\times(0,H)$，$H>0$。\n    - 分解：$\\Omega_{L}=(0,H)\\times(0,H)$ 和 $\\Omega_{R}=(H,2H)\\times(0,H)$。\n    - 界面：$\\Gamma=\\{H\\}\\times(0,H)$。\n    - 弹性势能：$\\mathcal{E}(w)=\\int_{\\Omega}\\left(G_{x}\\,|\\partial_{x}w|^{2}+G_{y}\\,|\\partial_{y}w|^{2}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y$。\n    - 材料系数：在 $\\Omega_{L}$ 中为 $(G_{x},G_{y}) = (1,a)$，在 $\\Omega_{R}$ 中为 $(1,1)$，其中 $a \\gg 1$。\n    - 边界条件：在 $\\partial\\Omega$ 上 $w=0$。\n    - 离散化与求解器：使用协调的分片线性有限元方法。由此产生的界面问题通过带约束的平衡区域分解 (BDDC) 方法进行预处理。\n    - BDDC 设置：粗空间仅由界面 $\\Gamma$ 的角点，即 $(H,0)$ 和 $(H,H)$ 处的原始约束定义。缩放采用标准算术平均。\n- **目标**：求出当 $a \\to \\infty$ 时，渐近关系 $\\kappa(a) \\sim C a^p$ 中的指数 $p$。\n\n- **验证结论**：该问题有效。它描述了一个用于分析区域分解方法对材料非均匀性（特别是各向异性）鲁棒性的标准设置。所有术语都定义明确，且该分析是该领域的标准程序。\n\n### 步骤 2：求解推导\n\n预处理算子的条件数 $\\kappa(M^{-1}S)$ 是其最大特征值与最小特征值之比，即 $\\kappa(M^{-1}S) = \\lambda_{\\max}(M^{-1}S) / \\lambda_{\\min}(M^{-1}S)$。当 $a \\to \\infty$ 时 $\\kappa(a)$ 的行为揭示了 BDDC 方法对各向异性对比度的鲁棒性。\n\n问题的核心在于子域 $\\Omega_L$ 中的强各向异性，而指定的 BDDC 预处理器未能妥善处理此问题。各向异性方向与界面 $\\Gamma$ 相切，这种配置对于标准区域分解方法来说是众所周知的挑战。该预处理器使用算术平均和仅有的角点约束，这两者都不足以抵消大参数 $a$ 的影响。\n\n为了分析其行为，我们可以使用一个尺度变换论证，将各向异性问题转化为一个几何扭曲域上的各向同性问题。\n在子域 $\\Omega_L$ 中，能量泛函为：\n$$ \\mathcal{E}_L(w) = \\int_{0}^{H} \\int_{0}^{H} \\left( |\\partial_x w|^2 + a |\\partial_y w|^2 \\right) \\,dx\\,dy $$\n我们为 $\\Omega_L$ 引入坐标变换：\n$$ (\\tilde{x}, \\tilde{y}) = (x, y/\\sqrt{a}) $$\n在此变换下，函数 $w(x,y)$ 变为 $\\tilde{w}(\\tilde{x}, \\tilde{y}) = w(\\tilde{x}, \\tilde{y}\\sqrt{a})$。导数变换如下：\n$$ \\partial_x w = \\partial_{\\tilde{x}} \\tilde{w}, \\quad \\partial_y w = \\frac{1}{\\sqrt{a}} \\partial_{\\tilde{y}} \\tilde{w} $$\n此变换的雅可比行列式为 $dxd_y = \\sqrt{a}\\, d\\tilde{x}d\\tilde{y}$。\n在新坐标系下，能量泛函变为：\n$$ \\mathcal{E}_L(w) = \\int_{\\tilde{\\Omega}_L} \\left( |\\partial_{\\tilde{x}} \\tilde{w}|^2 + a \\left|\\frac{1}{\\sqrt{a}} \\partial_{\\tilde{y}} \\tilde{w}\\right|^2 \\right) \\sqrt{a} \\,d\\tilde{x}\\,d\\tilde{y} \\\\ = \\sqrt{a} \\int_{\\tilde{\\Omega}_L} \\left( |\\partial_{\\tilde{x}} \\tilde{w}|^2 + |\\partial_{\\tilde{y}} \\tilde{w}|^2 \\right) \\,d\\tilde{x}\\,d\\tilde{y} $$\n原始域 $\\Omega_L = (0,H) \\times (0,H)$ 被映射到新域 $\\tilde{\\Omega}_L = (0,H) \\times (0, H/\\sqrt{a})$。这是一个细长的矩形域，其纵横比为：\n$$ \\text{纵横比} = \\frac{\\text{长边}}{\\text{短边}} = \\frac{H}{H/\\sqrt{a}} = \\sqrt{a} $$\n子域 $\\Omega_R$ 仍然是一个大小为 $H \\times H$ 的正方形，因为它是各向同性的。\n\n因此，原始问题等价于在一个复合域 $\\tilde{\\Omega}_L \\cup \\Omega_R$ 上的一个缩放后的各向同性问题，其中一个子域 $\\tilde{\\Omega}_L$ 随着 $a \\to \\infty$ 而变得越来越薄。该子域中的能量被缩放了 $\\sqrt{a}$ 倍。\n\n区域分解方法的性能对子域的几何形状高度敏感，特别是对大的纵横比。对于一个分解后的子域中至少有一个具有大纵横比的问题，预处理系统的条件数通常会恶化。仅带角点约束的 BDDC 方法对于此类几何形状不具有鲁棒性。仅在两个角点处施加连续性约束的粗问题太弱，无法在薄子域中有效地传播信息。\n\n在区域分解理论中（例如，在对 Bramble-Pasciak-Schatz 型方法的分析中）有一个公认的结果：对于一个纵横比为 $AR$ 的条状域，双子域分解的预处理算子的条件数可以随纵横比呈二次方增长。在我们的情况下，子域 $\\Omega_L$ 的有效纵横比为 $\\sqrt{a}$。\n\n条件数预计按以下方式缩放：\n$$ \\kappa(a) \\sim C \\cdot (\\text{纵横比})^2 $$\n代入我们找到的纵横比：\n$$ \\kappa(a) \\sim C \\cdot (\\sqrt{a})^2 = C \\cdot a $$\n这表明指数 $p$ 为 $1$。\n\n预处理器控制不佳的界面模态对应于这样一个函数：在缩放域 $\\tilde{\\Omega}_L$ 中，它在长方向（$\\tilde{x}$）上变化缓慢，而在短方向（$\\tilde{y}$）上变化迅速。转换回原始坐标，这是界面 $\\Gamma$ 上一个在 $y$ 方向上表现出高频振荡的模态。让我们考虑一个类似 $\\varphi(y) = \\sin(k\\pi y/H)$ 的模态，其中波数 $k$ 很大。弱的仅角点约束无法控制这种振荡模态，而简单的算术平均没有考虑到与这种振荡相关的刚度在 $\\Omega_L$ 中被因子 $a$ 放大，而在 $\\Omega_R$ 中却没有。这种不匹配是导致条件数增长的原因。尺度变换论证精确地将这种不匹配的影响捕捉为几何变形，从而导致了对纵横比的二次依赖关系。\n\n因此，渐近增长指数为 $p=1$。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}