{
    "hands_on_practices": [
        {
            "introduction": "Understanding the behavior of rock joints begins with mastering the mathematical description of their shear strength. The Barton-Bandis criterion is a cornerstone model, but its raw form can be unwieldy. This first exercise  challenges you to translate the model into a dimensionless form, a crucial skill in engineering that reveals the fundamental relationships between key physical quantities. By normalizing the shear strength, you will see how the joint's response is governed by the ratio of normal stress to the joint wall strength.",
            "id": "3537020",
            "problem": "A rock joint in a numerical model is represented by a frictional interface whose shear resistance increases with contact roughness at low normal stress and approaches a residual friction response at high normal stress. Let the shear stress be denoted by $\\tau$ and the applied effective normal stress by $\\sigma_{n}$. The Joint Wall Compressive Strength (JCS) is a material strength scale for the joint surfaces, and the Joint Roughness Coefficient (JRC) is a dimensionless descriptor of surface roughness calibrated so that its contribution to the apparent friction angle enters additively, in $\\text{radians}$, through a base-$10$ logarithm of a stress ratio constructed from $JCS$ and $\\sigma_{n}$. The residual friction angle is $\\phi_{r}$, measured in $\\text{radians}$. Starting from the fundamental frictional form in which shear strength scales with normal stress and the tangent of a mobilized friction angle, introduce an appropriate nondimensionalization using $JCS$ as the stress scale. Derive a closed-form expression for the dimensionless shear strength $\\tau/JCS$ in terms of the dimensionless ratio $\\sigma_{n}/JCS$, the residual friction angle $\\phi_{r}$, and the roughness term $JRC \\log_{10}(JCS/\\sigma_{n})$. Express any angles in $\\text{radians}$. Provide the final analytic expression for $\\tau/JCS$; no numerical evaluation is required.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Shear stress: $\\tau$\n- Applied effective normal stress: $\\sigma_{n}$\n- Joint Wall Compressive Strength: $JCS$\n- Joint Roughness Coefficient: $JRC$ (dimensionless)\n- Residual friction angle: $\\phi_{r}$ (in radians)\n- Fundamental relationship for shear strength: $\\tau$ scales with $\\sigma_{n}$ and the tangent of a mobilized friction angle, $\\phi_{mob}$. This can be written as $\\tau = \\sigma_{n} \\tan(\\phi_{mob})$.\n- Definition of mobilized friction angle: The contribution from the $JRC$ enters additively to the residual friction angle $\\phi_{r}$. The $JRC$ contribution is given as $JRC \\log_{10}(JCS/\\sigma_{n})$. Thus, $\\phi_{mob} = \\phi_{r} + JRC \\log_{10}(JCS/\\sigma_{n})$.\n- Nondimensionalization: The characteristic stress scale for nondimensionalization is $JCS$.\n- Goal: Derive a closed-form expression for the dimensionless shear strength $\\tau/JCS$ in terms of the dimensionless ratio $\\sigma_{n}/JCS$, $\\phi_{r}$, and $JRC \\log_{10}(JCS/\\sigma_{n})$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes the formulation of the Barton-Bandis shear strength criterion for rock joints, a widely accepted and utilized empirical model in rock mechanics and computational geomechanics. The premises are factually sound and based on established principles in the field.\n- **Well-Posed**: The problem is well-posed. It provides all necessary definitions and relationships to derive a unique analytical expression. The goal is clearly stated.\n- **Objective**: The problem is formulated in precise, objective, and technical language, free of any subjective or opinion-based statements.\n- **Completeness and Consistency**: The problem is self-contained, providing all required parameters ($\\tau$, $\\sigma_n$, $JCS$, $JRC$, $\\phi_r$) and the functional forms relating them. There are no contradictions.\n- **Realism**: The parameters and the model itself are physically realistic and represent standard practice in geotechnical engineering.\n- **Structure**: The problem is clearly structured as a derivation task.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, and complete. The solution process may proceed.\n\n### Solution Derivation\n\nThe derivation proceeds by systematically assembling the components described in the problem statement.\n\nThe fundamental relationship between shear stress $\\tau$, effective normal stress $\\sigma_{n}$, and the mobilized friction angle $\\phi_{mob}$ is given as a Mohr-Coulomb type law:\n$$\n\\tau = \\sigma_{n} \\tan(\\phi_{mob})\n$$\nThe problem states that the mobilized friction angle, $\\phi_{mob}$, is composed of two additive parts: the residual friction angle, $\\phi_{r}$, and a contribution from the joint roughness. The roughness term is explicitly given as $JRC \\log_{10}(JCS/\\sigma_{n})$. Therefore, the expression for the mobilized friction angle is:\n$$\n\\phi_{mob} = \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right)\n$$\nAll angles in this expression are specified to be in radians.\n\nSubstituting the expression for $\\phi_{mob}$ into the shear strength equation yields the full expression for the shear strength according to the Barton-Bandis model:\n$$\n\\tau = \\sigma_{n} \\tan\\left( \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right) \\right)\n$$\nThe final requirement is to express the shear strength in a dimensionless form by normalizing it with respect to the Joint Wall Compressive Strength, $JCS$. To achieve this, we divide both sides of the equation by $JCS$:\n$$\n\\frac{\\tau}{JCS} = \\frac{\\sigma_{n}}{JCS} \\tan\\left( \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right) \\right)\n$$\nThis equation represents the dimensionless shear strength, $\\tau/JCS$, as a function of the dimensionless normal stress, $\\sigma_{n}/JCS$, the residual friction angle, $\\phi_{r}$, and the roughness term, $JRC \\log_{10}(JCS/\\sigma_{n})$, as requested. This is the final closed-form expression.",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{n}}{JCS} \\tan\\left(\\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right)\\right)}\n$$"
        },
        {
            "introduction": "Empirical models are powerful tools, but they are not universally applicable and must be used with a critical understanding of their physical basis. The logarithmic term in the Barton-Bandis model can lead to non-physical predictions under certain stress conditions. This practice  focuses on identifying these limitations and justifying the need for model modifications, a vital step in developing robust and physically realistic computational tools. You will determine the exact condition under which the model breaks down and articulate why it must be capped at the residual strength.",
            "id": "3537034",
            "problem": "A rock joint is modeled using the Barton–Bandis joint constitutive law for peak shear strength, which decomposes the peak friction angle into a residual component and a roughness-induced increment. Let the residual friction angle be denoted by $\\phi_{r}$, the Joint Roughness Coefficient (JRC) by $JRC$, the Joint Wall Compressive Strength (JCS) by $JCS$, and the applied normal stress by $\\sigma_{n}$. In this model, the roughness-induced increment depends logarithmically on the ratio $JCS/\\sigma_{n}$ and is proportional to $JRC$, and the peak friction angle reduces to the residual friction angle at sufficiently high $\\sigma_{n}$ when roughness effects vanish.\n\nAssume $JRC \\ge 0$ and treat the logarithm as base-$10$. Using the well-tested Barton–Bandis representation of peak friction angle described above, determine the smallest $JCS$ (express your answer as a closed-form symbolic expression) that guarantees the computed peak friction angle does not fall below $\\phi_{r}$. Also briefly justify, from the perspective of computational implementation and physical consistency, why dropping the computed friction angle below $\\phi_{r}$ is typically prevented.\n\nProvide the final $JCS$ as a symbolic expression in the same stress units as $\\sigma_{n}$. No rounding is required. Your final answer must be a single expression.",
            "solution": "The problem requires the determination of the minimum Joint Wall Compressive Strength, $JCS$, that ensures the computed peak friction angle, $\\phi_p$, in the Barton–Bandis model does not fall below the residual friction angle, $\\phi_r$. Additionally, a justification for this constraint from physical and computational perspectives is requested.\n\nFirst, we formalize the Barton–Bandis model for the peak friction angle as described in the problem statement. The peak friction angle, $\\phi_p$, is the sum of the residual friction angle, $\\phi_r$, and a roughness-induced increment. This increment is proportional to the Joint Roughness Coefficient, $JRC$, and depends logarithmically (base-$10$) on the ratio of the Joint Wall Compressive Strength, $JCS$, to the applied normal stress, $\\sigma_n$. The standard representation of this relationship is:\n$$\n\\phi_p = \\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right)\n$$\nThe problem specifies that $JRC \\ge 0$. It also states that for the logarithm to be defined, its argument must be positive, so we assume $JCS > 0$ and $\\sigma_n > 0$.\n\nThe core condition to be satisfied is that the peak friction angle must not fall below the residual friction angle. This is expressed mathematically as:\n$$\n\\phi_p \\ge \\phi_r\n$$\nSubstituting the expression for $\\phi_p$ into this inequality yields:\n$$\n\\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge \\phi_r\n$$\nSubtracting $\\phi_r$ from both sides of the inequality simplifies the expression to:\n$$\nJRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge 0\n$$\nWe analyze this inequality based on the value of $JRC$.\nCase 1: $JRC = 0$.\nIf $JRC = 0$, the joint is perfectly smooth. The inequality becomes $0 \\ge 0$, which is always true. In this case, $\\phi_p = \\phi_r$ regardless of the values of $JCS$ and $\\sigma_n$, so the condition is met for any valid $JCS$.\n\nCase 2: $JRC > 0$.\nSince $JRC$ is a positive constant, we can divide both sides of the inequality by $JRC$ without changing the direction of the inequality sign:\n$$\n\\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge 0\n$$\nFor the base-$10$ logarithm of a number to be greater than or equal to zero, its argument must be greater than or equal to $1$. This is a fundamental property of logarithms ($\\log_b(x) \\ge 0 \\iff x \\ge 1$ for any base $b > 1$). Therefore, we must have:\n$$\n\\frac{JCS}{\\sigma_n} \\ge 1\n$$\nMultiplying both sides by $\\sigma_n$ (which is a positive stress) gives the condition on $JCS$:\n$$\nJCS \\ge \\sigma_n\n$$\nThis inequality must hold to guarantee that $\\phi_p \\ge \\phi_r$. The problem asks for the smallest value of $JCS$ that guarantees this condition. This corresponds to the lower bound of the derived inequality. Thus, the minimum required value for $JCS$ is equal to $\\sigma_n$.\n\nThe second part of the problem asks for a justification as to why the condition $\\phi_p \\ge \\phi_r$ is enforced in practice.\n\nJustification from Physical Consistency:\nThe residual friction angle, $\\phi_r$, represents the baseline frictional resistance of a rock joint surface after all asperities (roughness features) have been sheared off. It is the frictional strength of a planar, uncemented contact. The roughness component of strength, represented by the term $JRC \\log_{10}(JCS/\\sigma_n)$, accounts for the additional shear resistance provided by the interlocking of these asperities. This additional resistance can be zero (for a smooth joint or under very high normal stress that crushes the asperities) but it cannot be negative. A negative contribution would imply that a rough surface is weaker than a perfectly smooth one, which contradicts fundamental physical principles of friction and mechanics. The mathematical artifact of the logarithmic term becoming negative when $JCS < \\sigma_n$ is a limitation of the empirical formulation outside its primary range of validity. Physically, when the normal stress $\\sigma_n$ exceeds the compressive strength $JCS$ of the joint wall material, the asperities are crushed. The behavior should then default to that of sliding on crushed rock debris, which would have a friction angle at least equal to $\\phi_r$.\n\nJustification from Computational Implementation:\nIn computational geomechanics software (e.g., using the Finite Element Method or the Distinct Element Method), constitutive models must be numerically robust and physically sound to ensure stable and meaningful simulations. If the calculated friction angle $\\phi_p$ were allowed to drop below $\\phi_r$, it could lead to unphysical material softening and potential numerical instabilities, causing non-convergence or erroneous predictions of failure. To prevent this, implementations of the Barton–Bandis model almost universally include a conditional check. A common implementation is:\n$$\n\\phi_p = \\max\\left(\\phi_r, \\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right)\\right)\n$$\nThis ensures that the peak friction angle is never assigned a value less than the residual friction angle, thereby maintaining physical consistency and improving the stability of the numerical solution. The condition $JCS \\ge \\sigma_n$ is precisely the criterion that prevents this floor function from being activated.",
            "answer": "$$\n\\boxed{\\sigma_n}\n$$"
        },
        {
            "introduction": "Bridging the gap from theoretical constitutive laws to practical numerical simulation is a hallmark of advanced computational geomechanics. This final practice  guides you through the implementation of a complete, regularized joint model suitable for a Newton-Raphson solution scheme. You will derive the consistent tangent stiffness components for both normal and shear responses, a non-trivial task essential for ensuring the quadratic convergence and stability of a non-linear finite element or distinct element analysis.",
            "id": "3537116",
            "problem": "Consider a zero-thickness interface element representing a rock joint modeled with the Barton-Bandis (BB) joint constitutive law under mixed-mode normal-shear loading. Let the interface relative displacement vector be $\\boldsymbol{\\delta} = (\\delta_n, \\delta_s)$, where $\\delta_n$ is the normal closure (positive in compression, negative in opening) and $\\delta_s$ is the shear slip (positive along the local tangential direction). Let the corresponding traction vector be $\\mathbf{t} = (t_n, t_s)$, where $t_n$ is the normal traction and $t_s$ is the shear traction (both expressed as stress). You will derive and implement the consistent tangent components $\\partial t_n / \\partial \\delta_n$ and $\\partial t_s / \\partial \\delta_s$ required for quadratic convergence in a Newton-Raphson scheme for solving the nonlinear interface equilibrium.\n\nUse the following scientifically accepted constitutive ingredients as the foundational base:\n\n- Normal stress-closure relation inspired by the Barton-Bandis hyperbolic law: for $\\delta_n \\le 0$ (opening), the joint carries no compressive normal traction, i.e., $t_n = 0$. For $\\delta_n > 0$ (compression), the normal traction is given by\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m}\n$$,\nwhere $k_{n0}$ is the initial normal stiffness and $\\delta_m$ is a characteristic closure scale. This produces a physically realistic nonlinearly softening tangent stiffness and an asymptotic saturation of normal traction for large closures.\n\n- Shear traction evolution regularized to be smooth while anchored to the Barton peak shear strength envelope. The peak shear strength $\\tau_p(\\sigma_n)$ as a function of the effective normal stress $\\sigma_n$ is given by\n$$\n\\tau_p(\\sigma_n) = \n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right), & \\sigma_n > 0, \\\\\n0, & \\sigma_n \\le 0,\n\\end{cases}\n$$,\nwhere $\\phi_r$ is the residual friction angle, $\\mathrm{JRC}$ is the Joint Roughness Coefficient, and $\\mathrm{JCS}$ is the Joint Wall Compressive Strength. Angles in $\\tan(\\cdot)$ must be supplied in radians. The shear traction is regularized by a smooth slip function\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right)\n$$,\nwhere $d_s$ is a characteristic slip length that controls the transition from initial elastic-like response to the asymptotic frictional strength. This regularization ensures differentiability of $t_s$ with respect to $\\delta_s$ and enables consistent tangents for a Newton-Raphson scheme. In mixed-mode, use $\\sigma_n = t_n(\\delta_n)$.\n\nTask:\n1. Starting strictly from the above base, derive explicit expressions for the consistent tangent components $\\partial t_n / \\partial \\delta_n$ and $\\partial t_s / \\partial \\delta_s$ appropriate for a Newton-Raphson scheme under mixed-mode loading. In the derivation, clearly state any piecewise conditions required for physical realism, and consistently treat $\\partial t_s / \\partial \\delta_s$ as the partial derivative with respect to $\\delta_s$ at fixed $\\delta_n$.\n2. Implement these expressions in a program that computes, for a given set of parameters and $(\\delta_n, \\delta_s)$, the pair of tangent components $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$.\n\nUnits and angle specification:\n- All displacements $\\delta_n$ and $\\delta_s$ must be in millimeters ($\\mathrm{mm}$).\n- All stresses and tractions $t_n$, $t_s$, $\\sigma_n$, $\\mathrm{JCS}$ must be in megapascals ($\\mathrm{MPa}$).\n- Stiffness $k_{n0}$ and tangents $\\partial t_n / \\partial \\delta_n$, $\\partial t_s / \\partial \\delta_s$ must be in $\\mathrm{MPa}/\\mathrm{mm}$.\n- Angles must be supplied in degrees but converted to radians for use in $\\tan(\\cdot)$.\n\nTest suite:\nUse the following five test cases, each specified by $(\\delta_n, \\delta_s, k_{n0}, \\delta_m, \\mathrm{JRC}, \\mathrm{JCS}, \\phi_r, d_s)$:\n- Case $1$ (general mixed-mode, moderate compression and slip): $(\\delta_n, \\delta_s) = (0.5, 0.2)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $2$ (opening in normal, zero shear): $(\\delta_n, \\delta_s) = (-0.1, 0.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $3$ (high compression, large slip): $(\\delta_n, \\delta_s) = (20.0, 2.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $4$ (small compression, zero slip): $(\\delta_n, \\delta_s) = (0.05, 0.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $5$ (no roughness, moderate compression and slip): $(\\delta_n, \\delta_s) = (1.0, 0.1)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 0$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the pair $[\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s]$ for one case, formatted as nested lists with each float value printed to six decimal places, for example: $[[a_1,b_1],[a_2,b_2],\\dots]$. All tangent results must be expressed in $\\mathrm{MPa}/\\mathrm{mm}$.",
            "solution": "We derive the consistent tangent components from the constitutive definitions, which are well-tested formulas used in computational geomechanics for rock joints. The goal in a Newton-Raphson scheme is to compute the Jacobian of the residual with respect to the displacement increments. For a zero-thickness interface, the residual contribution from the constitutive law involves the tractions $\\mathbf{t}(\\boldsymbol{\\delta})$. Therefore, the consistent tangent components required are the partial derivatives of the traction components with respect to their corresponding displacement components, evaluated at the current state.\n\nNormal direction derivation:\nFor $\\delta_n \\le 0$, the joint is open and carries no compressive normal traction, so $t_n(\\delta_n) = 0$ and the tangent is $\\partial t_n / \\partial \\delta_n = 0$. For $\\delta_n > 0$, the normal traction is\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m}.\n$$\nLet $k_{n0}$ and $\\delta_m$ be constants with $k_{n0} > 0$ and $\\delta_m > 0$. Define $v(\\delta_n) = 1 + \\delta_n / \\delta_m$. Then $t_n(\\delta_n) = k_{n0} \\frac{\\delta_n}{v(\\delta_n)}$. By the quotient rule,\n$$\n\\frac{\\partial}{\\partial \\delta_n}\\left(\\frac{\\delta_n}{v(\\delta_n)}\\right) = \\frac{v(\\delta_n)\\cdot 1 - \\delta_n \\cdot \\frac{\\partial v}{\\partial \\delta_n}}{v(\\delta_n)^2}.\n$$\nSince $\\frac{\\partial v}{\\partial \\delta_n} = \\frac{1}{\\delta_m}$, we obtain\n$$\n\\frac{\\partial}{\\partial \\delta_n}\\left(\\frac{\\delta_n}{v(\\delta_n)}\\right) = \\frac{1 + \\delta_n / \\delta_m - \\delta_n / \\delta_m}{\\left(1 + \\delta_n / \\delta_m\\right)^2} = \\frac{1}{\\left(1 + \\delta_n / \\delta_m\\right)^2}.\n$$\nTherefore, the consistent tangent in the normal direction is\n$$\n\\frac{\\partial t_n}{\\partial \\delta_n} =\n\\begin{cases}\n0, & \\delta_n \\le 0, \\\\\n\\dfrac{k_{n0}}{\\left(1 + \\delta_n / \\delta_m\\right)^2}, & \\delta_n > 0.\n\\end{cases}\n$$\n\nShear direction derivation:\nWe regularize the shear traction by anchoring it to the Barton peak shear strength envelope and using a smooth slip function. The peak shear strength as a function of the effective normal stress $\\sigma_n$ is\n$$\n\\tau_p(\\sigma_n) =\n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right), & \\sigma_n > 0, \\\\\n0, & \\sigma_n \\le 0,\n\\end{cases}\n$$\nwhere the argument of $\\tan(\\cdot)$ is in radians. Under mixed-mode, $\\sigma_n = t_n(\\delta_n)$. The shear traction is defined as\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\nwith $d_s > 0$. For the consistent tangent with respect to $\\delta_s$, we consider the partial derivative at fixed $\\delta_n$, which implies $\\sigma_n$ is held constant when differentiating $t_s$ with respect to $\\delta_s$. Thus,\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s}\\bigg|_{\\delta_n} = \\tau_p(\\sigma_n) \\cdot \\frac{\\partial}{\\partial \\delta_s}\\left[\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right)\\right] = \\tau_p(\\sigma_n) \\cdot \\frac{1}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\nwhere $\\mathrm{sech}(x) = 1/\\cosh(x)$. Accounting for the physical piecewise condition in $\\tau_p(\\sigma_n)$, we have\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} =\n\\begin{cases}\n0, & \\sigma_n \\le 0, \\\\\n\\dfrac{\\tau_p(\\sigma_n)}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\dfrac{\\delta_s}{d_s}\\right), & \\sigma_n > 0.\n\\end{cases}\n$$\n\nUnits and angles:\n- $\\delta_n$ and $\\delta_s$ are in $\\mathrm{mm}$.\n- $t_n$, $t_s$, $\\sigma_n$, $\\mathrm{JCS}$ are in $\\mathrm{MPa}$.\n- $k_{n0}$ and the tangent components $\\partial t_n / \\partial \\delta_n$, $\\partial t_s / \\partial \\delta_s$ are in $\\mathrm{MPa}/\\mathrm{mm}$.\n- $\\phi_r$ is provided in degrees and must be converted to radians in the argument of $\\tan(\\cdot)$ via $\\phi_r^{\\mathrm{rad}} = \\phi_r^{\\circ}\\,\\pi/180$.\n- The $\\log_{10}(\\cdot)$ is the base-$10$ logarithm, consistent with the Barton formulation.\n\nAlgorithmic design for implementation:\n1. For each test case, read $\\delta_n$, $\\delta_s$, $k_{n0}$, $\\delta_m$, $\\mathrm{JRC}$, $\\mathrm{JCS}$, $\\phi_r$, $d_s$.\n2. Compute $t_n$ using the piecewise BB-inspired hyperbolic law. Then compute $\\partial t_n / \\partial \\delta_n$ using the derived closed-form expression.\n3. Set $\\sigma_n = t_n$. If $\\sigma_n \\le 0$, then set $\\tau_p = 0$ and $\\partial t_s / \\partial \\delta_s = 0$. Otherwise, compute the Barton peak strength\n$$\n\\theta^{\\circ} = \\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\frac{\\mathrm{JCS}}{\\sigma_n}\\right),\\quad \\theta^{\\mathrm{rad}} = \\theta^{\\circ}\\,\\frac{\\pi}{180}\n$$,\n$$\n\\tau_p = \\sigma_n \\tan(\\theta^{\\mathrm{rad}}),\n$$\nand then compute\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} = \\frac{\\tau_p}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right) = \\frac{\\tau_p}{d_s}\\,\\frac{1}{\\cosh^2\\!\\left(\\frac{\\delta_s}{d_s}\\right)}\n$$.\n4. Collect the pair $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$ for each case.\n5. Print the results as a single line, formatted as a list of lists with each float to six decimal places: $[[a_1,b_1],[a_2,b_2],\\dots]$.\n\nThis procedure provides the consistent tangents needed for quadratic convergence in a Newton-Raphson solver, as they are the exact partial derivatives of the constitutive tractions with respect to the displacement components under mixed-mode conditions, respecting the physically motivated piecewise behavior in the normal direction and ensuring smoothness in the shear direction.",
            "answer": "```python\nimport numpy as np\n\ndef barton_peak_tau(sigma_n, JRC, JCS, phi_r_deg):\n    \"\"\"\n    Compute Barton peak shear strength tau_p(sigma_n).\n    Angles input in degrees; converted to radians for tan().\n    If sigma_n <= 0, return 0.\n    Units: sigma_n, JCS in MPa; tau_p in MPa.\n    \"\"\"\n    if sigma_n <= 0.0:\n        return 0.0\n    # Angle in degrees per Barton formula\n    theta_deg = phi_r_deg + JRC * np.log10(JCS / sigma_n)\n    theta_rad = np.deg2rad(theta_deg)\n    return sigma_n * np.tan(theta_rad)\n\ndef normal_traction_and_tangent(delta_n, k_n0, delta_m):\n    \"\"\"\n    Compute normal traction t_n and its consistent tangent dt_n/d(delta_n).\n    Piecewise: opening (delta_n <= 0) -> t_n = 0, tangent = 0.\n    Compression (delta_n > 0) -> hyperbolic law.\n    Units: delta_n in mm; k_n0 in MPa/mm; delta_m in mm.\n    Returns (t_n in MPa, tangent in MPa/mm).\n    \"\"\"\n    if delta_n <= 0.0:\n        return 0.0, 0.0\n    v = 1.0 + delta_n / delta_m\n    t_n = k_n0 * delta_n / v\n    dtangent = k_n0 / (v * v)\n    return t_n, dtangent\n\ndef shear_tangent(delta_s, sigma_n, d_s, JRC, JCS, phi_r_deg):\n    \"\"\"\n    Compute the consistent shear tangent dt_s/d(delta_s) at fixed delta_n.\n    Uses regularized tanh slip law anchored to Barton peak strength.\n    Units: delta_s, d_s in mm; sigma_n, JCS in MPa; tangent in MPa/mm.\n    \"\"\"\n    tau_p = barton_peak_tau(sigma_n, JRC, JCS, phi_r_deg)\n    if tau_p <= 0.0:\n        return 0.0\n    x = delta_s / d_s\n    sech2 = 1.0 / (np.cosh(x) ** 2)\n    return (tau_p / d_s) * sech2\n\ndef solve():\n    # Define the test cases as tuples:\n    # (delta_n, delta_s, k_n0, delta_m, JRC, JCS, phi_r_deg, d_s)\n    test_cases = [\n        (0.5, 0.2, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),   # Case 1\n        (-0.1, 0.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 2\n        (20.0, 2.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 3\n        (0.05, 0.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 4\n        (1.0, 0.1, 50.0, 2.0, 0.0, 100.0, 30.0, 0.5),    # Case 5 (JRC=0)\n    ]\n\n    results = []\n    for (delta_n, delta_s, k_n0, delta_m, JRC, JCS, phi_r_deg, d_s) in test_cases:\n        # Normal traction and tangent\n        t_n, dtn_ddn = normal_traction_and_tangent(delta_n, k_n0, delta_m)\n        sigma_n = t_n  # effective normal stress equals normal traction\n\n        # Shear tangent\n        dts_dds = shear_tangent(delta_s, sigma_n, d_s, JRC, JCS, phi_r_deg)\n\n        results.append((dtn_ddn, dts_dds))\n\n    # Format results with six decimals, nested list, no spaces\n    formatted_pairs = []\n    for a, b in results:\n        formatted_pairs.append(f\"[{a:.6f},{b:.6f}]\")\n    output = \"[\" + \",\".join(formatted_pairs) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}