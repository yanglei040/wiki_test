{
    "hands_on_practices": [
        {
            "introduction": "理解岩石节理在正应力作用下的闭合机制，是模拟其力学行为的基础。本练习将探讨应用广泛的双曲线定律，引导您推导其无量纲形式。通过这种实践，您将学会如何将复杂的力学响应简化为由少数关键参数控制的普适关系，这对于模型的通用性至关重要。",
            "id": "3537115",
            "problem": "一个承受单调法向压缩的粗糙岩石节理，使用 Barton–Bandis 法向闭合法则的双曲线形式进行建模。令法向闭合量为 $u_{n}$，对应的法向应力为 $\\sigma_{n}$。在闭合量为零时的初始切向法向刚度为 $k_{n0}$，在压缩下可达到的渐近最大闭合量为 $u_{\\max}$。假设双曲线法向闭合关系满足初始切向刚度为 $\\left.\\frac{d \\sigma_{n}}{d u_{n}}\\right|_{u_{n}=0}=k_{n0}$，并且当 $\\sigma_{n} \\to \\infty$ 时，该法则渐近地趋于一个有限的闭合量 $u_{\\max}$。\n\n仅使用闭合量的特征尺度 $u_{\\max}$ 和应力的特征尺度 $k_{n0} u_{\\max}$，通过引入无量纲闭合量 $\\hat{u}$ 和无量纲应力 $\\hat{\\sigma}$，对双曲线法向闭合法则进行无量纲化。将本构关系重写为完全无量纲形式，并确定控制法向响应的关键无量纲群组。将最终的无量纲本构关系表示为单一的封闭形式解析表达式。不需要数值近似或四舍五入，最终表达式中不应包含任何物理单位。",
            "solution": "**问题验证**\n\n**第1步：提取已知条件**\n-   法向闭合量：$u_{n}$\n-   法向应力：$\\sigma_{n}$\n-   本构模型：Barton–Bandis 法向闭合法则的双曲线形式。\n-   初始切向法向刚度：$k_{n0} = \\left.\\frac{d \\sigma_{n}}{d u_{n}}\\right|_{u_{n}=0}$。\n-   最大可达闭合量：$u_{\\max}$ 是当 $\\sigma_{n} \\to \\infty$ 时 $u_n$ 的极限。\n-   闭合量的特征尺度：$u_{\\max}$。\n-   应力的特征尺度：$k_{n0} u_{\\max}$。\n-   无量纲闭合量：$\\hat{u}$。\n-   无量纲应力：$\\hat{\\sigma}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，提法得当，且客观。它描述了连续介质力学和地质力学中的一个标准程序：从其基本性质推导出一个特定的本构法则，然后将其表示为无量纲形式。Barton–Bandis 模型是岩石节理力学的基石，而双曲线公式是一种常见的表示方法。所提供的条件（初始刚度和渐近行为）足以唯一确定该法则的数学形式。该问题是自洽的，没有矛盾或歧义。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n**求解过程**\n\n主要任务是从其所述性质中推导出有量纲双曲线本构法则的具体形式，然后使用提供的特征尺度对其进行无量纲化。\n\n首先，我们建立法向应力 $\\sigma_{n}$ 和法向闭合量 $u_{n}$ 之间关系的函数形式。该关系被描述为双曲线。我们寻求一个满足所给条件的函数 $\\sigma_{n}(u_{n})$。一个通过原点（即 $u_n=0$, $\\sigma_n=0$）并具有垂直渐近线的通用双曲线函数可以写成：\n$$ \\sigma_{n} = \\frac{C_1 u_{n}}{C_2 - u_{n}} $$\n其中 $C_1$ 和 $C_2$ 是待定常数。\n\n问题陈述，当法向应力 $\\sigma_{n}$ 趋于无穷大时，法向闭合量 $u_{n}$ 渐近地趋于最大值 $u_{\\max}$。这对应于 $\\sigma_{n}(u_{n})$ 函数在 $u_{n} = u_{\\max}$ 处的一条垂直渐近线。这意味着常数 $C_2$ 必须等于最大闭合量 $u_{\\max}$。因此，该法则的形式为：\n$$ \\sigma_{n} = \\frac{C_1 u_{n}}{u_{\\max} - u_{n}} $$\n\n接下来，我们使用关于初始切向法向刚度 $k_{n0}$ 的条件。刚度是应力对闭合量的导数：\n$$ \\frac{d\\sigma_{n}}{du_{n}} = \\frac{d}{du_{n}} \\left( \\frac{C_1 u_{n}}{u_{\\max} - u_{n}} \\right) $$\n应用除法定则进行微分，我们得到：\n$$ \\frac{d\\sigma_{n}}{du_{n}} = \\frac{C_1(u_{\\max} - u_{n}) - C_1 u_{n} (-1)}{(u_{\\max} - u_{n})^{2}} = \\frac{C_1 u_{\\max} - C_1 u_{n} + C_1 u_{n}}{(u_{\\max} - u_{n})^{2}} = \\frac{C_1 u_{\\max}}{(u_{\\max} - u_{n})^{2}} $$\n初始切向刚度是在 $u_{n}=0$ 处计算的该导数值：\n$$ \\left.\\frac{d\\sigma_{n}}{du_{n}}\\right|_{u_{n}=0} = \\frac{C_1 u_{\\max}}{(u_{\\max} - 0)^{2}} = \\frac{C_1 u_{\\max}}{u_{\\max}^{2}} = \\frac{C_1}{u_{\\max}} $$\n根据问题陈述，这个初始刚度必须等于 $k_{n0}$。因此：\n$$ \\frac{C_1}{u_{\\max}} = k_{n0} \\implies C_1 = k_{n0} u_{\\max} $$\n将现已确定的常数 $C_1$ 和 $C_2$ 代回双曲线函数，我们得到完整的有量纲本构法则：\n$$ \\sigma_{n} = \\frac{k_{n0} u_{\\max} u_{n}}{u_{\\max} - u_{n}} $$\n这个方程精确地模拟了一个在零闭合量时应力为零、初始刚度为 $k_{n0}$、并且在压应力变为无穷大时其闭合量渐近趋于 $u_{\\max}$ 的节理。\n\n现在，我们进行无量纲化。给定的特征尺度为：\n- 特征闭合量：$u_{\\max}$\n- 特征应力：$k_{n0} u_{\\max}$\n\n我们将无量纲闭合量 $\\hat{u}$ 和无量纲应力 $\\hat{\\sigma}$ 定义为物理变量与其特征尺度的比值：\n$$ \\hat{u} = \\frac{u_{n}}{u_{\\max}} $$\n$$ \\hat{\\sigma} = \\frac{\\sigma_{n}}{k_{n0} u_{\\max}} $$\n为了找到无量纲法则，我们将有量纲变量用其无量纲对应项表示：\n$$ u_{n} = \\hat{u} u_{\\max} $$\n$$ \\sigma_{n} = \\hat{\\sigma} k_{n0} u_{\\max} $$\n然后我们将这些表达式代入有量纲本构方程：\n$$ \\hat{\\sigma} k_{n0} u_{\\max} = \\frac{k_{n0} u_{\\max} (\\hat{u} u_{\\max})}{u_{\\max} - (\\hat{u} u_{\\max})} $$\n对于一个有物理意义的问题，假设 $k_{n0} \\neq 0$ 且 $u_{\\max} \\neq 0$，我们可以将两边同除以 $k_{n0} u_{\\max}$ 项：\n$$ \\hat{\\sigma} = \\frac{\\hat{u} u_{\\max}}{u_{\\max} - \\hat{u} u_{\\max}} $$\n从右侧分母中提出因子 $u_{\\max}$，得到：\n$$ \\hat{\\sigma} = \\frac{\\hat{u} u_{\\max}}{u_{\\max}(1 - \\hat{u})} $$\n消去分子和分母中的 $u_{\\max}$ 项，得到最终的无量纲本构关系：\n$$ \\hat{\\sigma} = \\frac{\\hat{u}}{1 - \\hat{u}} $$\n对于所有遵循指定双曲线法则的节理，该关系是普适的。关键的无量纲群组是归一化应力 $\\hat{\\sigma}$ 和归一化闭合量 $\\hat{u}$。最终方程中没有任何其他参数，这表明该问题完全由所选尺度表征。所要求的无量纲本构关系的封闭形式解析表达式即为 $\\hat{\\sigma}$ 作为 $\\hat{u}$ 的函数表达式。",
            "answer": "$$\n\\boxed{\\hat{\\sigma} = \\frac{\\hat{u}}{1 - \\hat{u}}}\n$$"
        },
        {
            "introduction": "在掌握了法向闭合规律后，我们将注意力转向抗剪强度——这是稳定性分析中最为关键的因素。Barton-Bandis模型是岩石力学领域的基石，但与所有经验模型一样，它有其特定的适用范围。本练习旨在挑战您识别该模型中一个关键的物理和计算约束条件，从而培养在工程应用中进行批判性思考的能力。",
            "id": "3537034",
            "problem": "一个岩石节理采用Barton–Bandis节理本构律来模拟其峰值抗剪强度，该定律将峰值摩擦角分解为一个残余分量和一个由粗糙度引起的增量。设残余摩擦角表示为$\\phi_{r}$，节理粗糙度系数 (JRC) 表示为 $JRC$，节理壁抗压强度 (JCS) 表示为 $JCS$，施加的法向应力表示为 $\\sigma_{n}$。在该模型中，由粗糙度引起的增量对数依赖于比值 $JCS/\\sigma_{n}$，且与 $JRC$ 成正比；当 $\\sigma_{n}$ 足够高以致粗糙度效应消失时，峰值摩擦角会减小至残余摩擦角。\n\n假设 $JRC \\ge 0$ 并且对数以10为底。使用上述经过充分检验的Barton–Bandis峰值摩擦角表示法，确定能保证计算出的峰值摩擦角不低于 $\\phi_{r}$ 的最小 $JCS$ 值（以闭式符号表达式表示答案）。同时，从计算实现和物理一致性的角度，简要论证为什么通常要防止计算出的摩擦角低于 $\\phi_{r}$。\n\n以与 $\\sigma_{n}$ 相同的应力单位，用一个符号表达式给出最终的 $JCS$。无需四舍五入。你的最终答案必须是单一表达式。",
            "solution": "问题要求确定在Barton–Bandis模型中，能确保计算出的峰值摩擦角 $\\phi_p$ 不低于残余摩擦角 $\\phi_r$ 的最小节理壁抗压强度 $JCS$。此外，还要求从物理和计算的角度对此约束条件进行论证。\n\n首先，我们根据问题陈述，将Barton–Bandis峰值摩擦角模型形式化。峰值摩擦角 $\\phi_p$ 是残余摩擦角 $\\phi_r$ 与一个由粗糙度引起的增量之和。该增量与节理粗糙度系数 $JRC$ 成正比，并对数（以10为底）依赖于节理壁抗压强度 $JCS$ 与施加的法向应力 $\\sigma_n$ 之比。该关系的标准表示法是：\n$$\n\\phi_p = \\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right)\n$$\n问题指明 $JRC \\ge 0$。它还指出，为使对数有定义，其参数必须为正，因此我们假设 $JCS > 0$ 且 $\\sigma_n > 0$。\n\n需要满足的核心条件是峰值摩擦角不得低于残余摩擦角。这在数学上表示为：\n$$\n\\phi_p \\ge \\phi_r\n$$\n将 $\\phi_p$ 的表达式代入此不等式，得到：\n$$\n\\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge \\phi_r\n$$\n从不等式两边减去 $\\phi_r$，表达式简化为：\n$$\nJRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge 0\n$$\n我们根据 $JRC$ 的值来分析这个不等式。\n情况1：$JRC = 0$。\n如果 $JRC = 0$，则节理是完全光滑的。不等式变为 $0 \\ge 0$，此式恒成立。在这种情况下，无论 $JCS$ 和 $\\sigma_n$ 的值如何，都有 $\\phi_p = \\phi_r$，因此对于任何有效的 $JCS$，该条件都得到满足。\n\n情况2：$JRC > 0$。\n由于 $JRC$ 是一个正常数，我们可以在不等式两边同时除以 $JRC$ 而不改变不等号的方向：\n$$\n\\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge 0\n$$\n要使一个数的以10为底的对数大于或等于零，其参数必须大于或等于 $1$。这是对数的一个基本性质（对于任何底数 $b > 1$，有 $\\log_b(x) \\ge 0 \\iff x \\ge 1$）。因此，我们必须有：\n$$\n\\frac{JCS}{\\sigma_n} \\ge 1\n$$\n两边同乘以 $\\sigma_n$（这是一个正应力），得到关于 $JCS$ 的条件：\n$$\nJCS \\ge \\sigma_n\n$$\n这个不等式必须成立，才能保证 $\\phi_p \\ge \\phi_r$。问题要求保证此条件的最小 $JCS$ 值。这对应于所推导不等式的下界。因此，$JCS$ 的最小要求值等于 $\\sigma_n$。\n\n问题的第二部分要求论证为什么在实践中要强制执行 $\\phi_p \\ge \\phi_r$ 这一条件。\n\n从物理一致性角度的论证：\n残余摩擦角 $\\phi_r$ 代表了岩石节理表面在所有粗糙体（粗糙度特征）被剪断后的基线摩擦阻力。它是一个平面、未胶结接触面的摩擦强度。由项 $JRC \\log_{10}(JCS/\\sigma_n)$ 表示的强度粗糙度分量，解释了由这些粗糙体互锁提供的额外抗剪阻力。这种额外的阻力可以为零（对于光滑节理或在压碎粗糙体的极高法向应力下），但不能为负。负的贡献将意味着粗糙表面比完全光滑的表面更弱，这与摩擦和力学的基本物理原理相矛盾。当 $JCS  \\sigma_n$ 时，对数项变为负值，这是该经验公式在其主要有效范围之外的一个数学局限性。在物理上，当法向应力 $\\sigma_n$ 超过节理壁材料的抗压强度 $JCS$ 时，粗糙体被压碎。此时的行为应默认为在碎石残骸上滑动，其摩擦角至少等于 $\\phi_r$。\n\n从计算实现角度的论证：\n在计算岩土力学软件（例如，使用有限元法或离散元法）中，本构模型必须在数值上稳健且物理上合理，以确保模拟的稳定性和意义。如果允许计算出的摩擦角 $\\phi_p$ 降至 $\\phi_r$ 以下，可能会导致不符合物理规律的材料软化和潜在的数值不稳定性，从而引起不收敛或错误的破坏预测。为防止这种情况，Barton–Bandis模型的实现几乎普遍包含一个条件检查。一种常见的实现是：\n$$\n\\phi_p = \\max\\left(\\phi_r, \\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right)\\right)\n$$\n这确保了峰值摩擦角永远不会被赋予小于残余摩擦角的值，从而保持了物理一致性并提高了数值解的稳定性。条件 $JCS \\ge \\sigma_n$ 正是防止这个下限函数被激活的准则。",
            "answer": "$$\n\\boxed{\\sigma_n}\n$$"
        },
        {
            "introduction": "最后的这项实践将法向和剪切行为整合成一个统一的计算框架。您将推导并实现“一致性切线刚度”，这是现代数值模拟（如有限元法）实现高效和稳定收敛的关键。完成这项任务，意味着您将成功地在岩土本构理论和其在高级计算软件中的实际应用之间架起一座桥梁。",
            "id": "3537116",
            "problem": "考虑一个代表岩石节理的零厚度界面单元，该节理在法向-剪切混合模式加载下采用 Barton-Bandis (BB) 节理本构法进行模拟。设界面相对位移矢量为 $\\boldsymbol{\\delta} = (\\delta_n, \\delta_s)$，其中 $\\delta_n$ 是法向闭合量（压缩为正，张开为负），$\\delta_s$ 是剪切滑移量（沿局部切向为正）。设对应的应力矢量为 $\\mathbf{t} = (t_n, t_s)$，其中 $t_n$ 是法向应力，$t_s$ 是剪切应力（均以应力表示）。您将推导并实现一致性切线分量 $\\partial t_n / \\partial \\delta_n$ 和 $\\partial t_s / \\partial \\delta_s$，这些分量是在 Newton-Raphson 格式中为求解非线性界面平衡问题并获得二次收敛所必需的。\n\n使用以下科学上公认的本构关系作为基础：\n\n- 受 Barton-Bandis 双曲线定律启发的法向应力-闭合关系：对于 $\\delta_n \\le 0$（张开），节理不承受法向压应力，即 $t_n = 0$。对于 $\\delta_n  0$（压缩），法向应力由下式给出\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m},\n$$\n其中 $k_{n0}$ 是初始法向刚度，$\\delta_m$ 是一个特征闭合尺度。这产生了一个物理上真实的非线性软化切线刚度，以及在大闭合量下法向应力的渐近饱和。\n\n- 剪切应力演化被正则化以保证光滑，同时锚定于 Barton 峰值抗剪强度包线。峰值抗剪强度 $\\tau_p(\\sigma_n)$ 作为有效法向应力 $\\sigma_n$ 的函数，由下式给出\n$$\n\\tau_p(\\sigma_n) = \n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right),  \\sigma_n  0, \\\\\n0,  \\sigma_n \\le 0,\n\\end{cases}\n$$\n其中 $\\phi_r$ 是残余摩擦角，$\\mathrm{JRC}$ 是节理粗糙度系数，$\\mathrm{JCS}$ 是节理壁抗压强度。$\\tan(\\cdot)$ 中的角度必须以弧度为单位。剪切应力通过一个光滑滑移函数进行正则化：\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\n其中 $d_s$ 是一个特征滑移长度，它控制了从初始类弹性响应到渐近摩擦强度的过渡。这种正则化确保了 $t_s$ 相对于 $\\delta_s$ 的可微性，并为 Newton-Raphson 格式提供了一致性切线。在混合模式下，使用 $\\sigma_n = t_n(\\delta_n)$。\n\n任务：\n1. 严格从上述基础出发，为混合模式加载下的 Newton-Raphson 格式推导一致性切线分量 $\\partial t_n / \\partial \\delta_n$ 和 $\\partial t_s / \\partial \\delta_s$ 的显式表达式。在推导过程中，清楚地说明为保证物理真实性所需的任何分段条件，并始终将 $\\partial t_s / \\partial \\delta_s$ 视为在 $\\delta_n$ 固定时对 $\\delta_s$ 的偏导数。\n2. 在一个程序中实现这些表达式，该程序对于给定的参数集和 $(\\delta_n, \\delta_s)$，计算切线分量对 $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$。\n\n单位和角度规范：\n- 所有位移 $\\delta_n$ 和 $\\delta_s$ 必须以毫米（$\\mathrm{mm}$）为单位。\n- 所有应力 $t_n$、$t_s$、$\\sigma_n$、$\\mathrm{JCS}$ 必须以兆帕（$\\mathrm{MPa}$）为单位。\n- 刚度 $k_{n0}$ 和切线 $\\partial t_n / \\partial \\delta_n$、$\\partial t_s / \\partial \\delta_s$ 必须以 $\\mathrm{MPa}/\\mathrm{mm}$ 为单位。\n- 角度必须以度为单位提供，但在用于 $\\tan(\\cdot)$ 时需转换为弧度。\n\n测试套件：\n使用以下五个测试用例，每个用例由 $(\\delta_n, \\delta_s, k_{n0}, \\delta_m, \\mathrm{JRC}, \\mathrm{JCS}, \\phi_r, d_s)$ 指定：\n- 用例 1（一般混合模式，中等压缩和滑移）：$(\\delta_n, \\delta_s) = (0.5, 0.2)$，$k_{n0} = 50$，$\\delta_m = 2.0$，$\\mathrm{JRC} = 10$，$\\mathrm{JCS} = 100$，$\\phi_r = 30$，$d_s = 0.5$。\n- 用例 2（法向张开，零剪切）：$(\\delta_n, \\delta_s) = (-0.1, 0.0)$，$k_{n0} = 50$，$\\delta_m = 2.0$，$\\mathrm{JRC} = 10$，$\\mathrm{JCS} = 100$，$\\phi_r = 30$，$d_s = 0.5$。\n- 用例 3（高压缩，大滑移）：$(\\delta_n, \\delta_s) = (20.0, 2.0)$，$k_{n0} = 50$，$\\delta_m = 2.0$，$\\mathrm{JRC} = 10$，$\\mathrm{JCS} = 100$，$\\phi_r = 30$，$d_s = 0.5$。\n- 用例 4（小压缩，零滑移）：$(\\delta_n, \\delta_s) = (0.05, 0.0)$，$k_{n0} = 50$，$\\delta_m = 2.0$，$\\mathrm{JRC} = 10$，$\\mathrm{JCS} = 100$，$\\phi_r = 30$，$d_s = 0.5$。\n- 用例 5（无粗糙度，中等压缩和滑移）：$(\\delta_n, \\delta_s) = (1.0, 0.1)$，$k_{n0} = 50$，$\\delta_m = 2.0$，$\\mathrm{JRC} = 0$，$\\mathrm{JCS} = 100$，$\\phi_r = 30$，$d_s = 0.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目是对应一个用例的切线分量对 $[\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s]$，格式为嵌套列表，每个浮点值打印到小数点后六位，例如：$[[a_1,b_1],[a_2,b_2],\\dots]$。所有切线结果必须以 $\\mathrm{MPa}/\\mathrm{mm}$ 表示。",
            "solution": "我们从本构定义中推导一致性切线分量，这些定义是计算岩土力学中用于岩石节理的、经过充分检验的公式。在 Newton-Raphson 格式中，目标是计算残差相对于位移增量的雅可比矩阵。对于零厚度界面，来自本构律的残差贡献涉及应力 $\\mathbf{t}(\\boldsymbol{\\delta})$。因此，所需的一致性切线分量是应力分量相对于其相应位移分量的偏导数，并在当前状态下进行计算。\n\n法向推导：\n对于 $\\delta_n \\le 0$，节理处于张开状态，不承受法向压应力，因此 $t_n(\\delta_n) = 0$，切线为 $\\partial t_n / \\partial \\delta_n = 0$。对于 $\\delta_n  0$，法向应力为\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m}.\n$$\n设 $k_{n0}$ 和 $\\delta_m$ 为常数，且 $k_{n0}  0$ 和 $\\delta_m  0$。定义 $v(\\delta_n) = 1 + \\delta_n / \\delta_m$。则 $t_n(\\delta_n) = k_{n0} \\frac{\\delta_n}{v(\\delta_n)}$。根据商法则，\n$$\n\\frac{\\partial}{\\partial \\delta_n}\\left(\\frac{\\delta_n}{v(\\delta_n)}\\right) = \\frac{v(\\delta_n)\\cdot 1 - \\delta_n \\cdot \\frac{\\partial v}{\\partial \\delta_n}}{v(\\delta_n)^2}.\n$$\n由于 $\\frac{\\partial v}{\\partial \\delta_n} = \\frac{1}{\\delta_m}$，我们得到\n$$\n\\frac{\\partial}{\\partial \\delta_n}\\left(\\frac{\\delta_n}{v(\\delta_n)}\\right) = \\frac{1 + \\delta_n / \\delta_m - \\delta_n / \\delta_m}{\\left(1 + \\delta_n / \\delta_m\\right)^2} = \\frac{1}{\\left(1 + \\delta_n / \\delta_m\\right)^2}.\n$$\n因此，法向的一致性切线为\n$$\n\\frac{\\partial t_n}{\\partial \\delta_n} =\n\\begin{cases}\n0,  \\delta_n \\le 0, \\\\\n\\dfrac{k_{n0}}{\\left(1 + \\delta_n / \\delta_m\\right)^2},  \\delta_n  0.\n\\end{cases}\n$$\n\n剪切方向推导：\n我们通过将剪切应力锚定到 Barton 峰值抗剪强度包线并使用光滑滑移函数来对其进行正则化。峰值抗剪强度作为有效法向应力 $\\sigma_n$ 的函数为\n$$\n\\tau_p(\\sigma_n) =\n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right),  \\sigma_n  0, \\\\\n0,  \\sigma_n \\le 0,\n\\end{cases}\n$$\n其中 $\\tan(\\cdot)$ 的参数以弧度为单位。在混合模式下，$\\sigma_n = t_n(\\delta_n)$。剪切应力定义为\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\n其中 $d_s  0$。对于关于 $\\delta_s$ 的一致性切线，我们考虑在固定 $\\delta_n$ 时的偏导数，这意味着在对 $t_s$ 求关于 $\\delta_s$ 的导数时，$\\sigma_n$ 保持不变。因此，\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s}\\bigg|_{\\delta_n} = \\tau_p(\\sigma_n) \\cdot \\frac{\\partial}{\\partial \\delta_s}\\left[\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right)\\right] = \\tau_p(\\sigma_n) \\cdot \\frac{1}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\n其中 $\\mathrm{sech}(x) = 1/\\cosh(x)$。考虑到 $\\tau_p(\\sigma_n)$ 中的物理分段条件，我们有\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} =\n\\begin{cases}\n0,  \\sigma_n \\le 0, \\\\\n\\dfrac{\\tau_p(\\sigma_n)}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\dfrac{\\delta_s}{d_s}\\right),  \\sigma_n  0.\n\\end{cases}\n$$\n\n单位和角度：\n- $\\delta_n$ 和 $\\delta_s$ 的单位是 $\\mathrm{mm}$。\n- $t_n$、$t_s$、$\\sigma_n$、$\\mathrm{JCS}$ 的单位是 $\\mathrm{MPa}$。\n- $k_{n0}$ 和切线分量 $\\partial t_n / \\partial \\delta_n$、$\\partial t_s / \\partial \\delta_s$ 的单位是 $\\mathrm{MPa}/\\mathrm{mm}$。\n- $\\phi_r$ 以度为单位提供，在 $\\tan(\\cdot)$ 的参数中必须转换为弧度，通过 $\\phi_r^{\\mathrm{rad}} = \\phi_r^{\\circ}\\,\\pi/180$。\n- $\\log_{10}(\\cdot)$ 是以 10 为底的对数，与 Barton 公式一致。\n\n实现的算法设计：\n1. 对于每个测试用例，读取 $\\delta_n$、$\\delta_s$、$k_{n0}$、$\\delta_m$、$\\mathrm{JRC}$、$\\mathrm{JCS}$、$\\phi_r$、$d_s$。\n2. 使用分段的、受 BB 启发的双曲线定律计算 $t_n$。然后使用推导出的闭式表达式计算 $\\partial t_n / \\partial \\delta_n$。\n3. 令 $\\sigma_n = t_n$。如果 $\\sigma_n \\le 0$，则设 $\\tau_p = 0$ 且 $\\partial t_s / \\partial \\delta_s = 0$。否则，计算 Barton 峰值强度\n$$\n\\theta^{\\circ} = \\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\frac{\\mathrm{JCS}}{\\sigma_n}\\right),\\quad \\theta^{\\mathrm{rad}} = \\theta^{\\circ}\\,\\frac{\\pi}{180},\n$$\n$$\n\\tau_p = \\sigma_n \\tan(\\theta^{\\mathrm{rad}}),\n$$\n然后计算\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} = \\frac{\\tau_p}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right) = \\frac{\\tau_p}{d_s}\\,\\frac{1}{\\cosh^2\\!\\left(\\frac{\\delta_s}{d_s}\\right)}.\n$$\n4. 收集每个用例的对 $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$。\n5. 将结果打印为单行，格式化为嵌套列表，每个浮点数保留六位小数：$[[a_1,b_1],[a_2,b_2],\\dots]$。\n\n此过程提供了在 Newton-Raphson 求解器中实现二次收敛所需的一致性切线，因为它们是在混合模式条件下本构应力相对于位移分量的精确偏导数，同时尊重法向的物理驱动分段行为并确保剪切方向的光滑性。",
            "answer": "```python\nimport numpy as np\n\ndef barton_peak_tau(sigma_n, JRC, JCS, phi_r_deg):\n    \"\"\"\n    Compute Barton peak shear strength tau_p(sigma_n).\n    Angles input in degrees; converted to radians for tan().\n    If sigma_n = 0, return 0.\n    Units: sigma_n, JCS in MPa; tau_p in MPa.\n    \"\"\"\n    if sigma_n = 0.0:\n        return 0.0\n    # Angle in degrees per Barton formula\n    theta_deg = phi_r_deg + JRC * np.log10(JCS / sigma_n)\n    theta_rad = np.deg2rad(theta_deg)\n    return sigma_n * np.tan(theta_rad)\n\ndef normal_traction_and_tangent(delta_n, k_n0, delta_m):\n    \"\"\"\n    Compute normal traction t_n and its consistent tangent dt_n/d(delta_n).\n    Piecewise: opening (delta_n = 0) -> t_n = 0, tangent = 0.\n    Compression (delta_n > 0) -> hyperbolic law.\n    Units: delta_n in mm; k_n0 in MPa/mm; delta_m in mm.\n    Returns (t_n in MPa, tangent in MPa/mm).\n    \"\"\"\n    if delta_n = 0.0:\n        return 0.0, 0.0\n    v = 1.0 + delta_n / delta_m\n    t_n = k_n0 * delta_n / v\n    dtangent = k_n0 / (v * v)\n    return t_n, dtangent\n\ndef shear_tangent(delta_s, sigma_n, d_s, JRC, JCS, phi_r_deg):\n    \"\"\"\n    Compute the consistent shear tangent dt_s/d(delta_s) at fixed delta_n.\n    Uses regularized tanh slip law anchored to Barton peak strength.\n    Units: delta_s, d_s in mm; sigma_n, JCS in MPa; tangent in MPa/mm.\n    \"\"\"\n    if sigma_n = 0.0:\n        return 0.0\n    tau_p = barton_peak_tau(sigma_n, JRC, JCS, phi_r_deg)\n    x = delta_s / d_s\n    sech2 = 1.0 / (np.cosh(x) ** 2)\n    return (tau_p / d_s) * sech2\n\ndef solve():\n    # Define the test cases as tuples:\n    # (delta_n, delta_s, k_n0, delta_m, JRC, JCS, phi_r_deg, d_s)\n    test_cases = [\n        (0.5, 0.2, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),   # Case 1\n        (-0.1, 0.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 2\n        (20.0, 2.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 3\n        (0.05, 0.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 4\n        (1.0, 0.1, 50.0, 2.0, 0.0, 100.0, 30.0, 0.5),    # Case 5 (JRC=0)\n    ]\n\n    results = []\n    for (delta_n, delta_s, k_n0, delta_m, JRC, JCS, phi_r_deg, d_s) in test_cases:\n        # Normal traction and tangent\n        t_n, dtn_ddn = normal_traction_and_tangent(delta_n, k_n0, delta_m)\n        sigma_n = t_n  # effective normal stress equals normal traction\n\n        # Shear tangent\n        dts_dds = shear_tangent(delta_s, sigma_n, d_s, JRC, JCS, phi_r_deg)\n\n        results.append((dtn_ddn, dts_dds))\n\n    # Format results with six decimals, nested list, no spaces\n    formatted_pairs = []\n    for a, b in results:\n        formatted_pairs.append(f\"[{a:.6f},{b:.6f}]\")\n    output = \"[\" + \",\".join(formatted_pairs) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}