{
    "hands_on_practices": [
        {
            "introduction": "任何计算模拟都始于对材料的数学建模。对于各向同性线性黏弹性材料，我们可以将其复杂的三维应力-应变关系分解为两个独立的部分：一个控制体积变化（球量部分），另一个控制形状变化（偏量部分）。这项练习旨在巩固您对基本本构方程的理解，该方程是岩土力学中大多数黏弹性模拟的基石 。",
            "id": "3513930",
            "problem": "考虑一种各向同性的地质材料（例如泥岩或岩盐），其处于小应变、等温条件下，蠕变和应力松弛等时间相关现象非常显著。在计算地质力学的背景下，柯西应力张量 $\\boldsymbol{\\sigma}(t)$在线性粘弹性理论中通过一个与 Boltzmann 叠加原理一致的遗传积分来建模，其中应力取决于小应变张量 $\\boldsymbol{\\varepsilon}(t)$ 的整个过去历史。令 $\\boldsymbol{I}$ 表示二阶单位张量，令 $\\delta_{ij}$ 表示克罗内克符号。定义瞬时小应变张量为 $\\boldsymbol{\\varepsilon}(t) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u}(t) + \\nabla \\boldsymbol{u}(t)^{\\mathsf{T}}\\right)$，其体积应变为 $\\varepsilon_{v}(t) = \\mathrm{tr}\\,\\boldsymbol{\\varepsilon}(t)$，其平均（球形）应变为 $\\varepsilon_{m}(t) = \\frac{1}{3}\\,\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}(t)$，其偏应变为 $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(t) = \\boldsymbol{\\varepsilon}(t) - \\varepsilon_{m}(t)\\,\\boldsymbol{I}$。对于各向同性线性粘弹性材料，四阶松弛张量仅取决于时间和旋转不变量，体积响应和偏响应分别由标量体积松弛函数 $K(t)$ 和剪切松弛函数 $G(t)$ 控制。\n\n从这些定义以及材料坐标系无关性和各向同性的要求出发，确定将 $\\boldsymbol{\\sigma}(t)$ 通过 $K(t)$ 和 $G(t)$ 分解为体积部分和偏量部分的正确本构关系，该关系以关于应变率历史的遗传积分形式表示。选择一个选项。\n\nA. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{v}(\\tau)\\,\\boldsymbol{I} + 2\\,G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$\n\nB. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,3\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{m}(\\tau)\\,\\boldsymbol{I} + 2\\,G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$\n\nC. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,K(t-\\tau)\\,\\varepsilon_{v}(\\tau)\\,\\boldsymbol{I} + G(t-\\tau)\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$\n\nD. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,3\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{v}(\\tau)\\,\\boldsymbol{I} + 2\\,G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$\n\nE. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{m}(\\tau)\\,\\boldsymbol{I} + G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$",
            "solution": "## 推导与选项分析\n\n一般线性粘弹性材料的本构律可以表示为 Stieltjes 积分，或者根据要求，假设过去是静止的（对于 $t0$，$\\boldsymbol{\\varepsilon}(t) = \\boldsymbol{0}$），表示为包含应变率的遗传积分：\n$$ \\boldsymbol{\\sigma}(t) = \\int_{0}^{t} \\mathbb{C}(t-\\tau) : \\dot{\\boldsymbol{\\varepsilon}}(\\tau) \\, \\mathrm{d}\\tau $$\n其中 $\\mathbb{C}(t)$ 是四阶松弛张量，$\\dot{\\boldsymbol{\\varepsilon}}(\\tau)$ 是在时间 $\\tau$ 的应变张量速率。\n\n对于各向同性材料，响应可以解耦为体积（或球形）部分和偏量部分。这类似于线性弹性理论中的分解。\n\n首先，我们来分解应力张量和应变张量。\n应力张量 $\\boldsymbol{\\sigma}$ 被分解为其球形（平均）部分 $p\\boldsymbol{I}$ 和其偏量部分 $\\boldsymbol{\\sigma}_{\\mathrm{dev}}$：\n$$ \\boldsymbol{\\sigma}(t) = p(t)\\boldsymbol{I} + \\boldsymbol{\\sigma}_{\\mathrm{dev}}(t) $$\n其中 $p(t) = \\frac{1}{3}\\mathrm{tr}\\,\\boldsymbol{\\sigma}(t)$ 是平均应力。\n\n应变张量 $\\boldsymbol{\\varepsilon}$ 被分解为其球形（平均）部分 $\\varepsilon_m \\boldsymbol{I}$ 和其偏量部分 $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}$：\n$$ \\boldsymbol{\\varepsilon}(t) = \\varepsilon_{m}(t)\\boldsymbol{I} + \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(t) $$\n其中 $\\varepsilon_{m}(t) = \\frac{1}{3}\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}(t)$ 是平均应变。\n\n对于各向同性材料，球形响应和偏量响应是解耦的。我们可以将 Boltzmann 叠加原理应用于弹性关系。\n\n**1. 体积（球形）响应：**\n平均应力与应变之间的弹性关系是 $p = K \\varepsilon_v$ 或 $p = 3 K \\varepsilon_m$，其中 $K$ 是体积模量，$\\varepsilon_v = 3 \\varepsilon_m$ 是体积应变。利用对应原理，我们将弹性模量替换为包含松弛函数 $K(t)$ 的遗传积分。\n\n使用平均应变 $\\varepsilon_m(t)$，平均应力的粘弹性法则是：\n$$ p(t) = 3 \\int_{0}^{t} K(t-\\tau) \\dot{\\varepsilon}_{m}(\\tau) \\, \\mathrm{d}\\tau $$\n应力张量的球形部分是 $\\boldsymbol{\\sigma}_{\\mathrm{sph}}(t) = p(t)\\boldsymbol{I}$：\n$$ \\boldsymbol{\\sigma}_{\\mathrm{sph}}(t) = \\left( 3 \\int_{0}^{t} K(t-\\tau) \\dot{\\varepsilon}_{m}(\\tau) \\, \\mathrm{d}\\tau \\right) \\boldsymbol{I} = \\int_{0}^{t} 3 K(t-\\tau) \\dot{\\varepsilon}_{m}(\\tau) \\boldsymbol{I} \\, \\mathrm{d}\\tau $$\n\n或者，使用体积应变 $\\varepsilon_{v}(t)$，弹性关系是 $p = K \\varepsilon_{v}$。粘弹性法则是：\n$$ p(t) = \\int_{0}^{t} K(t-\\tau) \\dot{\\varepsilon}_{v}(\\tau) \\, \\mathrm{d}\\tau $$\n应力张量的球形部分变为：\n$$ \\boldsymbol{\\sigma}_{\\mathrm{sph}}(t) = \\left( \\int_{0}^{t} K(t-\\tau) \\dot{\\varepsilon}_{v}(\\tau) \\, \\mathrm{d}\\tau \\right) \\boldsymbol{I} = \\int_{0}^{t} K(t-\\tau) \\dot{\\varepsilon}_{v}(\\tau) \\boldsymbol{I} \\, \\mathrm{d}\\tau $$\n这两种形式是等价的，因为问题定义了 $\\varepsilon_v = \\mathrm{tr}\\,\\boldsymbol{\\varepsilon}$ 和 $\\varepsilon_m = \\frac{1}{3}\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}$，这意味着 $\\varepsilon_v = 3\\varepsilon_m$，因此 $\\dot{\\varepsilon}_v = 3\\dot{\\varepsilon}_m$。\n\n**2. 偏量响应：**\n偏量分量的弹性关系是 $\\boldsymbol{\\sigma}_{\\mathrm{dev}} = 2 G \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}$，其中 $G$ 是剪切模量。其粘弹性对应形式是：\n$$ \\boldsymbol{\\sigma}_{\\mathrm{dev}}(t) = 2 \\int_{0}^{t} G(t-\\tau) \\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau) \\, \\mathrm{d}\\tau $$\n\n**3. 总应力：**\n总应力是球形部分和偏量部分之和：$\\boldsymbol{\\sigma}(t) = \\boldsymbol{\\sigma}_{\\mathrm{sph}}(t) + \\boldsymbol{\\sigma}_{\\mathrm{dev}}(t)$。\n合并积分，我们可以用两种等价形式写出总应力。\n\n形式 1 (使用 $\\varepsilon_v$)：\n$$ \\boldsymbol{\\sigma}(t) = \\int_{0}^{t} K(t-\\tau) \\dot{\\varepsilon}_{v}(\\tau) \\boldsymbol{I} \\, \\mathrm{d}\\tau + \\int_{0}^{t} 2 G(t-\\tau) \\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau) \\, \\mathrm{d}\\tau $$\n$$ \\boldsymbol{\\sigma}(t) = \\int_{0}^{t} \\left[ K(t-\\tau) \\dot{\\varepsilon}_{v}(\\tau) \\boldsymbol{I} + 2 G(t-\\tau) \\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau) \\right] \\mathrm{d}\\tau $$\n\n形式 2 (使用 $\\varepsilon_m$)：\n$$ \\boldsymbol{\\sigma}(t) = \\int_{0}^{t} 3 K(t-\\tau) \\dot{\\varepsilon}_{m}(\\tau) \\boldsymbol{I} \\, \\mathrm{d}\\tau + \\int_{0}^{t} 2 G(t-\\tau) \\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau) \\, \\mathrm{d}\\tau $$\n$$ \\boldsymbol{\\sigma}(t) = \\int_{0}^{t} \\left[ 3 K(t-\\tau) \\dot{\\varepsilon}_{m}(\\tau) \\boldsymbol{I} + 2 G(t-\\tau) \\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau) \\right] \\mathrm{d}\\tau $$\n\n我们现在分析每个选项。\n\n**A. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{v}(\\tau)\\,\\boldsymbol{I} + 2\\,G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$**\n该表达式与我们推导的形式 1 相匹配。体积部分使用体积应变率 $\\dot{\\varepsilon}_v$ 表示，偏量部分包含因子 2，也是正确的。\n**结论：正确。**\n\n**B. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,3\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{m}(\\tau)\\,\\boldsymbol{I} + 2\\,G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$**\n该表达式与我们推导的形式 2 相匹配。体积部分使用平均应变率 $\\dot{\\varepsilon}_m$ 表示，并带有必要的因子 3。偏量部分也是正确的。如推导所示，此表达式在数学上与选项 A 中的表达式相同，因为 $\\dot{\\varepsilon}_v(\\tau) = 3\\dot{\\varepsilon}_m(\\tau)$。\n**结论：正确。**\n\n**C. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,K(t-\\tau)\\,\\varepsilon_{v}(\\tau)\\,\\boldsymbol{I} + G(t-\\tau)\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$**\n该表达式不正确。遗传积分必须涉及应变*率* ($\\dot{\\boldsymbol{\\varepsilon}}(\\tau)$)，而不是应变本身 ($\\boldsymbol{\\varepsilon}(\\tau)$)。这种形式无法正确捕捉材料对应变历史的依赖性。它还在偏量项中遗漏了因子 2。\n**结论：不正确。**\n\n**D. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,3\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{v}(\\tau)\\,\\boldsymbol{I} + 2\\,G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$**\n该表达式不正确。体积项是 $3K(t-\\tau)\\dot{\\varepsilon}_{v}(\\tau)$。由此产生的平均应力的正确关系应为 $p(t) = \\int_0^t 3K(t-\\tau)\\dot{\\varepsilon}_v(\\tau) d\\tau$。这与正确的关系 $p(t) = \\int_0^t K(t-\\tau)\\dot{\\varepsilon}_v(\\tau) d\\tau$ 相比，错误地多了一个因子 3。\n**结论：不正确。**\n\n**E. $\\displaystyle \\boldsymbol{\\sigma}(t) = \\int_{0}^{t}\\Big[\\,K(t-\\tau)\\,\\dot{\\varepsilon}_{m}(\\tau)\\,\\boldsymbol{I} + G(t-\\tau)\\,\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}(\\tau)\\,\\Big]\\mathrm{d}\\tau$**\n该表达式不正确。它在体积项中缺少因子 3（应为 $3K\\dot{\\varepsilon}_m$），在偏量项中缺少因子 2（应为 $2G\\dot{\\boldsymbol{\\varepsilon}}_{\\mathrm{dev}}$）。\n**结论：不正确。**\n\n选项 A 和 B 都是正确的，并且是基于所提供定义下本构律的数学等价表示。",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "在定义了理论模型之后，我们需要将其转化为代码以解决实际问题，而广义Maxwell模型是表征许多岩土材料时间依赖性行为的主力。通过假设在一个小时间步内应变呈线性演化，我们可以精确求解每个Maxwell元件的控制微分方程，从而得到一种高精度的更新法则，即指数积分器。这项实践让您直接体验将本构理论转化为稳健数值算法的过程，这是计算岩土力学的一项核心技能 。",
            "id": "3514044",
            "problem": "考虑一个广义 Maxwell 固体的等温、一维、小应变、线性粘弹性行为，该模型由一个平衡弹簧与 $N$ 个 Maxwell 分支并联而成。设总应变为 $\\varepsilon(t)$，总应力为 $\\sigma(t)$，平衡模量为 $E_{\\infty}$。对于每个分支 $i \\in \\{1,\\dots,N\\}$，设弹簧模量为 $E_i$，粘壶粘度为 $\\eta_i$，弛豫时间为 $\\tau_i = \\eta_i / E_i$。分支应力 $\\sigma_i(t)$ 是模型的内变量，总应力为 $\\sigma(t) = E_{\\infty} \\, \\varepsilon(t) + \\sum_{i=1}^{N} \\sigma_i(t)$。对于每个分支 $i$，串联平衡意味着一个线性的、一阶常微分方程（ODE），该方程将分支应力率与施加的应变率关联起来，\n$$\nE_i \\, \\dot{\\varepsilon}(t) \\;=\\; \\dot{\\sigma}_i(t) \\;+\\; \\frac{1}{\\tau_i}\\,\\sigma_i(t).\n$$\n在大小为 $\\Delta t = t_{n+1}-t_n$ 的单个时间步 $[t_n,t_{n+1}]$ 上，假设应变呈线性演化，因此 $\\varepsilon(t) = \\varepsilon_n + \\frac{t-t_n}{\\Delta t}(\\varepsilon_{n+1}-\\varepsilon_n)$ 且 $\\dot{\\varepsilon}(t)$ 在该时间步上为常数。从上述 ODE 出发，并仅使用所述假设，推导出一个指数积分器，该积分器将 $t_n$ 时的已知状态映射到 $t_{n+1}$ 时的更新状态：\n- 根据已知的先前分支应力 $\\{\\sigma_{i,n}\\}_{i=1}^N$、先前应变 $\\varepsilon_n$、当前应变 $\\varepsilon_{n+1}$ 以及时间步长 $\\Delta t$ 计算更新后的分支应力 $\\{\\sigma_{i,n+1}\\}_{i=1}^N$。\n- 组合出更新后的总应力 $\\sigma_{n+1} = E_{\\infty}\\,\\varepsilon_{n+1} + \\sum_{i=1}^{N} \\sigma_{i,n+1}$。\n- 推导算法一致性切线 $K_{n+1} = \\partial \\sigma_{n+1} / \\partial \\varepsilon_{n+1}$，该切线适用于在同一步长上进行 Newton 线性化，并保持 $\\varepsilon_n$、$\\{\\sigma_{i,n}\\}_{i=1}^N$ 和 $\\Delta t$ 固定。\n\n你的程序必须使用从第一性原理获得的指数积分器来实现上述更新，并为以下四个测试用例生成数值结果。请精确使用给定的参数。所有应力和模量均以帕斯卡（Pa）表示。不涉及角度。最终输出必须是单行，包含一个 Python 风格的浮点数列表，顺序为\n$[\\sigma_{1,n+1}, K_{1,n+1}, \\sigma_{2,n+1}, K_{2,n+1}, \\sigma_{3,n+1}, K_{3,n+1}, \\sigma_{4,n+1}, K_{4,n+1}]$，\n打印的列表中不含单位。每一对对应一个测试用例的总应力和算法切线。\n\n测试套件：\n- 案例 $1$（一般加载，两个分支）：\n  - $E_{\\infty} = 1.0\\times 10^{9}\\,\\text{Pa}$，$N=2$，$E_1 = 2.0\\times 10^{9}\\,\\text{Pa}$，$E_2 = 1.0\\times 10^{9}\\,\\text{Pa}$，\n  - $\\tau_1 = 10.0\\,\\text{s}$，$\\tau_2 = 1.0\\,\\text{s}$，\n  - $\\sigma_{1,n} = 0\\,\\text{Pa}$，$\\sigma_{2,n} = 0\\,\\text{Pa}$，\n  - $\\varepsilon_n = 0$，$\\varepsilon_{n+1} = 2.0\\times 10^{-3}$，\n  - $\\Delta t = 5.0\\times 10^{-1}\\,\\text{s}$。\n- 案例 $2$（应力松弛，两个分支）：\n  - $E_{\\infty} = 5.0\\times 10^{8}\\,\\text{Pa}$，$N=2$，$E_1 = 1.0\\times 10^{9}\\,\\text{Pa}$，$E_2 = 5.0\\times 10^{8}\\,\\text{Pa}$，\n  - $\\tau_1 = 2.0\\,\\text{s}$，$\\tau_2 = 5.0\\times 10^{-1}\\,\\text{s}$，\n  - $\\sigma_{1,n} = 5.0\\times 10^{7}\\,\\text{Pa}$，$\\sigma_{2,n} = 3.0\\times 10^{7}\\,\\text{Pa}$，\n  - $\\varepsilon_n = 1.0\\times 10^{-3}$，$\\varepsilon_{n+1} = 1.0\\times 10^{-3}$，\n  - $\\Delta t = 5.0\\,\\text{s}$。\n- 案例 $3$（极小时间步，两个分支）：\n  - $E_{\\infty} = 0\\,\\text{Pa}$，$N=2$，$E_1 = 1.0\\times 10^{8}\\,\\text{Pa}$，$E_2 = 3.0\\times 10^{8}\\,\\text{Pa}$，\n  - $\\tau_1 = 1.0\\times 10^{-3}\\,\\text{s}$，$\\tau_2 = 5.0\\times 10^{-4}\\,\\text{s}$，\n  - $\\sigma_{1,n} = 0\\,\\text{Pa}$，$\\sigma_{2,n} = 0\\,\\text{Pa}$，\n  - $\\varepsilon_n = 0$，$\\varepsilon_{n+1} = 1.0\\times 10^{-4}$，\n  - $\\Delta t = 1.0\\times 10^{-6}\\,\\text{s}$。\n- 案例 $4$（极大时间步，一个分支）：\n  - $E_{\\infty} = 1.0\\times 10^{8}\\,\\text{Pa}$，$N=1$，$E_1 = 4.0\\times 10^{8}\\,\\text{Pa}$，\n  - $\\tau_1 = 1.0\\,\\text{s}$，\n  - $\\sigma_{1,n} = 1.0\\times 10^{7}\\,\\text{Pa}$，\n  - $\\varepsilon_n = 1.0\\times 10^{-3}$，$\\varepsilon_{n+1} = 2.0\\times 10^{-3}$，\n  - $\\Delta t = 1.0\\times 10^{4}\\,\\text{s}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，顺序与上文指定完全一致。所有返回的数字必须是浮点数，并表示以帕斯卡（Pa）为单位的值。",
            "solution": "该问题是有效的，因为它代表了基于线性粘弹性既定原理的计算力学中的一个标准的、适定的练习。所有必要的参数和条件都已提供，问题具有科学依据、客观且内部一致。\n\n任务是在离散时间步上应变线性演化的假设下，为广义 Maxwell 模型推导并实现一个数值更新方案。这包括为每个 Maxwell 分支求解一阶常微分方程（ODE）、组合总应力，并推导相应的算法切线模量。\n\n首先，我们为单个 Maxwell 分支 $i$ 推导指数积分器。其控制性常微分方程如下：\n$$\n\\dot{\\sigma}_i(t) + \\frac{1}{\\tau_i}\\sigma_i(t) = E_i \\dot{\\varepsilon}(t)\n$$\n其中 $\\sigma_i(t)$ 是分支应力，$\\tau_i$ 是弛豫时间，$E_i$ 是分支模量，$\\dot{\\varepsilon}(t)$ 是总应变率。\n\n问题陈述，在持续时间为 $\\Delta t = t_{n+1} - t_n$ 的时间步 $[t_n, t_{n+1}]$ 上，应变线性演化。这意味着应变率在该区间内是恒定的：\n$$\n\\dot{\\varepsilon}(t) = \\frac{\\varepsilon_{n+1} - \\varepsilon_n}{\\Delta t} = \\frac{\\Delta \\varepsilon}{\\Delta t} \\quad \\text{for } t \\in [t_n, t_{n+1}]\n$$\n其中 $\\varepsilon_n$ 和 $\\varepsilon_{n+1}$ 分别是该时间步开始和结束时的应变。分支 $i$ 的常微分方程（ODE）变成一个具有常系数和常数强迫项的一阶线性常微分方程：\n$$\n\\dot{\\sigma}_i(t) + \\frac{1}{\\tau_i}\\sigma_i(t) = E_i \\frac{\\Delta \\varepsilon}{\\Delta t}\n$$\n这个常微分方程可以使用积分因子 $I(t) = e^{\\int (1/\\tau_i) dt} = e^{t/\\tau_i}$ 来求解。将该常微分方程乘以 $I(t)$ 可得：\n$$\n\\frac{d}{dt}\\left(\\sigma_i(t) e^{t/\\tau_i}\\right) = E_i \\frac{\\Delta \\varepsilon}{\\Delta t} e^{t/\\tau_i}\n$$\n将此方程从 $t_n$ 积分到 $t_{n+1}$：\n$$\n\\int_{t_n}^{t_{n+1}} \\frac{d}{dt}\\left(\\sigma_i(t) e^{t/\\tau_i}\\right) dt = \\int_{t_n}^{t_{n+1}} E_i \\frac{\\Delta \\varepsilon}{\\Delta t} e^{t/\\tau_i} dt\n$$\n$$\n\\left[\\sigma_i(t) e^{t/\\tau_i}\\right]_{t_n}^{t_{n+1}} = E_i \\frac{\\Delta \\varepsilon}{\\Delta t} \\left[\\tau_i e^{t/\\tau_i}\\right]_{t_n}^{t_{n+1}}\n$$\n$$\n\\sigma_{i,n+1} e^{t_{n+1}/\\tau_i} - \\sigma_{i,n} e^{t_n/\\tau_i} = E_i \\tau_i \\frac{\\Delta \\varepsilon}{\\Delta t} \\left(e^{t_{n+1}/\\tau_i} - e^{t_n/\\tau_i}\\right)\n$$\n其中 $\\sigma_{i,n} = \\sigma_i(t_n)$ 且 $\\sigma_{i,n+1} = \\sigma_i(t_{n+1})$。两边乘以 $e^{-t_{n+1}/\\tau_i}$ 并使用 $t_n - t_{n+1} = -\\Delta t$，我们分离出 $\\sigma_{i,n+1}$：\n$$\n\\sigma_{i,n+1} = \\sigma_{i,n} e^{-\\Delta t/\\tau_i} + E_i \\tau_i \\frac{\\Delta \\varepsilon}{\\Delta t} \\left(1 - e^{-\\Delta t/\\tau_i}\\right)\n$$\n这是在给定假设下的精确解，构成了指数积分器的基础。为便于实现，可以定义一个无量纲参数 $\\beta_i = \\Delta t / \\tau_i$。更新法则可以改写为：\n$$\n\\sigma_{i,n+1} = \\sigma_{i,n} e^{-\\beta_i} + E_i \\left( \\frac{1-e^{-\\beta_i}}{\\beta_i} \\right) \\Delta \\varepsilon\n$$\n\n接下来，我们组合出时间 $t_{n+1}$ 的总应力，它是平衡弹簧和所有 Maxwell 分支中应力的总和：\n$$\n\\sigma_{n+1} = E_{\\infty}\\varepsilon_{n+1} + \\sum_{i=1}^{N} \\sigma_{i,n+1}\n$$\n代入推导出的 $\\sigma_{i,n+1}$ 表达式：\n$$\n\\sigma_{n+1} = E_{\\infty}\\varepsilon_{n+1} + \\sum_{i=1}^{N} \\left[ \\sigma_{i,n} e^{-\\beta_i} + E_i \\left( \\frac{1-e^{-\\beta_i}}{\\beta_i} \\right) (\\varepsilon_{n+1} - \\varepsilon_n) \\right]\n$$\n\n最后，我们通过将 $\\sigma_{n+1}$ 对 $\\varepsilon_{n+1}$ 求导来推导算法一致性切线模量 $K_{n+1}$，同时保持 $\\varepsilon_n$、$\\{\\sigma_{i,n}\\}_{i=1}^N$ 和 $\\Delta t$ 不变。\n$$\nK_{n+1} = \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}} = \\frac{\\partial}{\\partial \\varepsilon_{n+1}} \\left( E_{\\infty}\\varepsilon_{n+1} + \\sum_{i=1}^{N} \\left[ \\sigma_{i,n} e^{-\\beta_i} + E_i \\left( \\frac{1-e^{-\\beta_i}}{\\beta_i} \\right) (\\varepsilon_{n+1} - \\varepsilon_n) \\right] \\right)\n$$\n相对于 $\\varepsilon_{n+1}$，项 $\\sigma_{i,n} e^{-\\beta_i}$ 和 $-E_i \\left( \\frac{1-e^{-\\beta_i}}{\\beta_i} \\right) \\varepsilon_n$ 是常数。求导得出：\n$$\nK_{n+1} = E_{\\infty} + \\sum_{i=1}^{N} E_i \\left( \\frac{1-e^{-\\beta_i}}{\\beta_i} \\right)\n$$\n这个表达式代表了材料在该时间步内的刚度。\n\n对于数值实现，当计算因子 $f(\\beta_i) = (1 - e^{-\\beta_i}) / \\beta_i$ 且 $\\beta_i = \\Delta t/\\tau_i$ 很小时，必须特别小心。直接计算可能因分子中的灾难性抵消和除以一个小数而导致精度损失。当 $\\beta_i \\to 0$ 时，$f(\\beta_i)$ 的极限为 $1$。对于小但非零的 $\\beta_i$，可使用泰勒级数展开 $f(\\beta_i) \\approx 1 - \\beta_i/2$ 或一个数值稳定的函数，如 `numpy.expm1`。所提供的代码采用了这种鲁棒的方法。\n\n下面的 Python 程序实现了这些推导出的公式，用以计算四个给定测试用例的总应力 $\\sigma_{n+1}$ 和算法切线 $K_{n+1}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the generalized Maxwell model.\n    \"\"\"\n    \n    def factor_f(beta):\n        \"\"\"\n        Computes the factor f(beta) = (1 - exp(-beta)) / beta in a numerically stable way.\n        \n        For beta close to zero, uses a Taylor series expansion to avoid 0/0 uncertainty and\n        loss of precision. The expansion is f(beta) = 1 - beta/2 + O(beta^2).\n        For larger beta, np.expm1(x) = exp(x) - 1 is used for stable evaluation of the numerator.\n        \"\"\"\n        if abs(beta)  1e-8:\n            return 1.0 - beta / 2.0\n        else:\n            return -np.expm1(-beta) / beta\n\n    def compute_update(E_inf, branches, sigma_n_branches, eps_n, eps_n1, dt):\n        \"\"\"\n        Computes the updated total stress and algorithmic tangent modulus for a single time step.\n\n        Args:\n            E_inf (float): Equilibrium modulus.\n            branches (list of tuples): List of (E_i, tau_i) for each Maxwell branch.\n            sigma_n_branches (list of floats): Branch stresses at the start of the step.\n            eps_n (float): Total strain at the start of the step.\n            eps_n1 (float): Total strain at the end of the step.\n            dt (float): Time step size.\n\n        Returns:\n            tuple: A tuple containing the total stress (sigma_n1_total) and the\n                   algorithmic tangent modulus (K_n1) at the end of the step.\n        \"\"\"\n        delta_eps = eps_n1 - eps_n\n\n        # Initialize with the contribution from the equilibrium spring\n        sigma_n1_total = E_inf * eps_n1\n        K_n1 = E_inf\n\n        for i in range(len(branches)):\n            E_i, tau_i = branches[i]\n            sigma_i_n = sigma_n_branches[i]\n\n            # All provided relaxation times tau_i must be positive.\n            if tau_i = 0:\n                raise ValueError(\"Relaxation time tau_i must be positive.\")\n            \n            beta_i = dt / tau_i\n\n            # Calculate the special factor f(beta) derived from the integration\n            f_beta_i = factor_f(beta_i)\n            \n            # Calculate the exponential decay term\n            exp_neg_beta = np.exp(-beta_i)\n            \n            # Update branch stress using the derived exponential integrator formula:\n            # sigma_i,n+1 = sigma_i,n * exp(-beta_i) + E_i * f(beta_i) * delta_eps\n            sigma_i_n1 = sigma_i_n * exp_neg_beta + E_i * f_beta_i * delta_eps\n            \n            # Add branch contributions to total stress and tangent modulus\n            sigma_n1_total += sigma_i_n1\n            K_n1 += E_i * f_beta_i\n            \n        return sigma_n1_total, K_n1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"E_inf\": 1.0e9,\n            \"branches\": [(2.0e9, 10.0), (1.0e9, 1.0)],\n            \"sigma_n_branches\": [0.0, 0.0],\n            \"eps_n\": 0.0,\n            \"eps_n1\": 2.0e-3,\n            \"dt\": 0.5\n        },\n        # Case 2\n        {\n            \"E_inf\": 5.0e8,\n            \"branches\": [(1.0e9, 2.0), (5.0e8, 0.5)],\n            \"sigma_n_branches\": [5.0e7, 3.0e7],\n            \"eps_n\": 1.0e-3,\n            \"eps_n1\": 1.0e-3,\n            \"dt\": 5.0\n        },\n        # Case 3\n        {\n            \"E_inf\": 0.0,\n            \"branches\": [(1.0e8, 1.0e-3), (3.0e8, 5.0e-4)],\n            \"sigma_n_branches\": [0.0, 0.0],\n            \"eps_n\": 0.0,\n            \"eps_n1\": 1.0e-4,\n            \"dt\": 1.0e-6\n        },\n        # Case 4\n        {\n            \"E_inf\": 1.0e8,\n            \"branches\": [(4.0e8, 1.0)],\n            \"sigma_n_branches\": [1.0e7],\n            \"eps_n\": 1.0e-3,\n            \"eps_n1\": 2.0e-3,\n            \"dt\": 1.0e4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_n1, K_n1 = compute_update(\n            case[\"E_inf\"],\n            case[\"branches\"],\n            case[\"sigma_n_branches\"],\n            case[\"eps_n\"],\n            case[\"eps_n1\"],\n            case[\"dt\"]\n        )\n        results.append(sigma_n1)\n        results.append(K_n1)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "数值积分算法的选择不仅仅是为了方便，它对模拟的准确性和稳定性有着深远的影响，尤其是在处理“刚性”系统时。本练习探讨了局部渐近稳定性的概念，它决定了数值误差是会衰减还是会失控增长。通过分析非线性模型的简单积分格式的稳定性，您将深入理解为何隐式方法在岩土力学中通常更受青睐，以及如何在您自己的模拟中诊断和防止数值不稳定性 。",
            "id": "3514027",
            "problem": "考虑对一种岩土材料进行一维小应变单轴应力松弛试验，该材料被建模为带有非线性粘壶的Maxwell型粘弹性固体。设总应变为弹性和粘性部分之和，即 $ \\varepsilon = \\varepsilon_{\\mathrm{e}} + \\varepsilon_{\\mathrm{v}} $。Cauchy应力为 $ \\sigma = E \\, \\varepsilon_{\\mathrm{e}} $，其中 $ E $ 是弹性模量。粘壶的粘度是状态相关的，可通过一个严格的标量无量纲势函数 $ G(\\varepsilon) $ 表示，使得 $ \\eta_{\\mathrm{eff}}(\\varepsilon) = \\eta / \\left( \\partial G / \\partial \\varepsilon \\right) $，其中 $ \\eta $ 是一个参考粘度，单位为 $ \\mathrm{Pa \\cdot s} $。假设粘壶遵循标准流动法则 $ \\dot{\\varepsilon}_{\\mathrm{v}} = \\sigma / \\eta_{\\mathrm{eff}}(\\varepsilon) $。考虑在 $ t \\ge 0 $ 时，在恒定的给定总应变 $ \\varepsilon(t) = \\bar{\\varepsilon} $下进行的应力松弛试验。\n\n仅使用这些定义和运动学约束 $ \\varepsilon = \\varepsilon_{\\mathrm{e}} + \\varepsilon_{\\mathrm{v}} $，推导控制 $ \\sigma(t) $ 随时间演化的常微分方程，该方程用 $ E $、$ \\eta $ 和在 $ \\varepsilon = \\bar{\\varepsilon} $ 处取值的 $ \\partial G / \\partial \\varepsilon $ 来表示。然后，对于此控制方程，考虑以固定时间步长 $ \\Delta t $ 应用的两种单步时间积分格式：\n\n- 显式（前向）Euler法。\n- 隐式（后向）Euler法。\n\n将在一个固定状态下时间积分的局部线性渐近稳定性定义为：一个小扰动 $ \\delta \\sigma $ 的幅值从一个时间步到下一个时间步是衰减的，这等价于线性化单步放大因子的幅值严格小于 $ 1 $。在从控制方程和时间步进格式的定义推导出稳定性判据之前，您不得假设或陈述任何闭式稳定性判据。\n\n您的任务是实现一个程序，对于每组指定的参数，判断显式Euler更新是否是局部渐近稳定的，以及隐式Euler更新是否是局部渐近稳定的。此外，对于 $ \\partial G / \\partial \\varepsilon  0 $ 的情况，计算显式Euler法保持局部渐近稳定的最大时间步长 $ \\Delta t_{\\mathrm{crit}} $（以秒为单位），表示为一个非负实数；如果 $ \\partial G / \\partial \\varepsilon \\le 0 $，则设置 $ \\Delta t_{\\mathrm{crit}} = 0 $。\n\n所有物理量必须使用国际单位制。具体来说，$ E $ 的单位必须是 $ \\mathrm{Pa} $，$ \\eta $ 的单位是 $ \\mathrm{Pa \\cdot s} $，$ \\Delta t $ 的单位是 $ \\mathrm{s} $，而 $ \\partial G / \\partial \\varepsilon $ 是无量纲的。程序必须为每个测试用例输出一个形式为 $ [b_{\\mathrm{exp}}, b_{\\mathrm{imp}}, \\Delta t_{\\mathrm{crit}}] $ 的列表，其中 $ b_{\\mathrm{exp}} $ 和 $ b_{\\mathrm{imp}} $ 分别是表示显式和隐式Euler法稳定性的布尔值，$ \\Delta t_{\\mathrm{crit}} $ 是一个以 $ \\mathrm{s} $ 为单位并四舍五入到三位小数的浮点值。最终输出必须是包含这些按用例排列的列表的单行，不含任何额外文本。\n\n使用以下参数集 $ (E, \\eta, \\partial G / \\partial \\varepsilon, \\Delta t) $ 的测试套件：\n\n1. $ (5.0 \\times 10^{7} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{9} \\,\\mathrm{Pa \\cdot s}, \\; 1.0, \\; 1.0 \\times 10^{1} \\,\\mathrm{s}) $。\n2. 边界情况: $ (5.0 \\times 10^{7} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{9} \\,\\mathrm{Pa \\cdot s}, \\; 1.0, \\; 4.0 \\times 10^{1} \\,\\mathrm{s}) $。\n3. 大时间步: $ (5.0 \\times 10^{7} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{9} \\,\\mathrm{Pa \\cdot s}, \\; 1.0, \\; 1.0 \\times 10^{2} \\,\\mathrm{s}) $。\n4. 高刚度弹性与中等粘度，大步长: $ (1.0 \\times 10^{9} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{8} \\,\\mathrm{Pa \\cdot s}, \\; 5.0 \\times 10^{-1}, \\; 5.0 \\times 10^{-1} \\,\\mathrm{s}) $。\n5. 高刚度弹性与中等粘度，小步长: $ (1.0 \\times 10^{9} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{8} \\,\\mathrm{Pa \\cdot s}, \\; 5.0 \\times 10^{-1}, \\; 1.0 \\times 10^{-1} \\,\\mathrm{s}) $。\n6. 无粘性流动因子的边缘情况: $ (1.0 \\times 10^{7} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{9} \\,\\mathrm{Pa \\cdot s}, \\; 0.0, \\; 1.0 \\times 10^{3} \\,\\mathrm{s}) $。\n7. 非物理的负导数: $ (1.0 \\times 10^{7} \\,\\mathrm{Pa}, \\; 1.0 \\times 10^{9} \\,\\mathrm{Pa \\cdot s}, \\; -1.0 \\times 10^{-1}, \\; 1.0 \\times 10^{0} \\,\\mathrm{s}) $。\n\n就本问题而言，仅当相关放大因子的幅值严格小于 $ 1 $（不等于 $ 1 $）时，才将一个格式声明为局部渐近稳定的。程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $ [\\ldots] $）形式的结果，其中每个元素对应一个测试用例，并具有上述格式。将 $ \\Delta t_{\\mathrm{crit}} $ 四舍五入到三位小数，并以 $ \\mathrm{s} $ 为单位报告。",
            "solution": "该问题陈述被评估为具有科学依据、适定、客观和自洽。它提出了一个计算粘弹性力学中的标准问题，涉及控制方程的推导和常用时间积分格式的稳定性分析。所有必要的物理定律、定义和参数都已提供，任务也已明确指定。因此，该问题被认为是有效的。\n\n解决方案分三个阶段进行：首先，推导应力松弛的控制常微分方程（ODE）；其次，对应用于该ODE的显式和隐式Euler格式进行局部线性稳定性分析；第三，基于稳定性判据构建计算算法。\n\n**1. 控制常微分方程的推导**\n\n该模型由以下一维单轴加载关系定义：\n总应变 $ \\varepsilon $ 的运动学分解：\n$$ \\varepsilon = \\varepsilon_{\\mathrm{e}} + \\varepsilon_{\\mathrm{v}} $$\n弹性本构定律（Hooke定律）：\n$$ \\sigma = E \\, \\varepsilon_{\\mathrm{e}} $$\n粘性流动法则：\n$$ \\dot{\\varepsilon}_{\\mathrm{v}} = \\frac{\\sigma}{\\eta_{\\mathrm{eff}}(\\varepsilon)} $$\n有效粘度 $ \\eta_{\\mathrm{eff}} $ 的定义：\n$$ \\eta_{\\mathrm{eff}}(\\varepsilon) = \\frac{\\eta}{\\partial G / \\partial \\varepsilon} $$\n此处，$ \\sigma $ 是Cauchy应力，$ E $ 是弹性模量，$ \\varepsilon_{\\mathrm{e}} $ 是弹性应变，$ \\varepsilon_{\\mathrm{v}} $ 是粘性应变，$ \\eta $ 是参考粘度，$ G(\\varepsilon) $ 是一个无量纲势函数。\n\n应力松弛试验是在恒定的给定总应变下进行的，即 $ \\varepsilon(t) = \\bar{\\varepsilon} $（对于时间 $ t \\ge 0 $）。因此，总应变率为零：$ \\dot{\\varepsilon} = 0 $。\n\n对应变分解方程求时间导数，得到：\n$$ \\dot{\\varepsilon} = \\dot{\\varepsilon}_{\\mathrm{e}} + \\dot{\\varepsilon}_{\\mathrm{v}} $$\n由于 $ \\dot{\\varepsilon} = 0 $，我们得到运动学约束：\n$$ \\dot{\\varepsilon}_{\\mathrm{e}} = - \\dot{\\varepsilon}_{\\mathrm{v}} $$\n假设 $ E $ 是常数，通过对弹性定律求导，可以用应力率 $ \\dot{\\sigma} $ 表示弹性应变率 $ \\dot{\\varepsilon}_{\\mathrm{e}} $：\n$$ \\dot{\\varepsilon}_{\\mathrm{e}} = \\frac{1}{E} \\dot{\\sigma} $$\n粘性应变率 $ \\dot{\\varepsilon}_{\\mathrm{v}} $ 由流动法则给出。代入 $ \\eta_{\\mathrm{eff}} $ 的定义，我们得到：\n$$ \\dot{\\varepsilon}_{\\mathrm{v}} = \\frac{\\sigma}{\\eta} \\frac{\\partial G}{\\partial \\varepsilon} $$\n在应力松弛试验期间，总应变保持在 $ \\bar{\\varepsilon} $ 恒定。因此，$ \\partial G / \\partial \\varepsilon $ 项在 $ \\varepsilon = \\bar{\\varepsilon} $ 处取值，并且不随时间变化。我们将此常数值记为 $ g' = \\left. \\frac{\\partial G}{\\partial \\varepsilon} \\right|_{\\varepsilon = \\bar{\\varepsilon}} $。粘性流动法则简化为：\n$$ \\dot{\\varepsilon}_{\\mathrmv} = \\frac{\\sigma}{\\eta} g' $$\n将 $ \\dot{\\varepsilon}_{\\mathrme} $ 和 $ \\dot{\\varepsilon}_{\\mathrmv} $ 的表达式代入运动学约束 $ \\dot{\\varepsilon}_{\\mathrm{e}} = - \\dot{\\varepsilon}_{\\mathrm{v}} $ 中：\n$$ \\frac{1}{E} \\dot{\\sigma} = - \\frac{g'}{\\eta} \\sigma $$\n重新整理此方程，得到控制应力 $ \\sigma(t) $ 演化的常微分方程：\n$$ \\dot{\\sigma} = - \\left( \\frac{E g'}{\\eta} \\right) \\sigma $$\n这是一个形式为 $ \\dot{\\sigma} = \\lambda \\sigma $ 的一阶线性齐次常微分方程，其中系数 $ \\lambda = - \\frac{E g'}{\\eta} $ 是一个由给定应变 $ \\bar{\\varepsilon} $ 下的材料属性决定的常数。\n\n**2. 局部线性稳定性分析**\n\n我们分析用于常微分方程 $ \\dot{\\sigma} = \\lambda \\sigma $ 的两种单步数值格式的稳定性，其中 $ \\sigma_n $ 是 $ \\sigma(t_n) $ 的数值近似，$ \\Delta t $ 是时间步长。稳定性要求单步放大因子 $ A $ 的幅值严格小于 $ 1 $，即 $ |A|  1 $。\n\n**2.1. 显式（前向）Euler格式**\n\n显式Euler更新由 $ \\sigma_{n+1} = \\sigma_n + \\Delta t \\, \\dot{\\sigma}_n = \\sigma_n + \\Delta t (\\lambda \\sigma_n) $ 给出。\n$$ \\sigma_{n+1} = (1 + \\lambda \\Delta t) \\sigma_n $$\n放大因子为 $ A_{\\mathrm{exp}} = 1 + \\lambda \\Delta t $。代入 $ \\lambda = - \\frac{E g'}{\\eta} $：\n$$ A_{\\mathrm{exp}} = 1 - \\frac{E g' \\Delta t}{\\eta} $$\n稳定性条件是 $ |A_{\\mathrm{exp}}|  1 $，这可以转化为：\n$$ \\left| 1 - \\frac{E g' \\Delta t}{\\eta} \\right|  1 \\implies -1  1 - \\frac{E g' \\Delta t}{\\eta}  1 $$\n这蕴含着两个联立的不等式：\n1. $ 1 - \\frac{E g' \\Delta t}{\\eta}  1 \\implies -\\frac{E g' \\Delta t}{\\eta}  0 \\implies \\frac{E g' \\Delta t}{\\eta} > 0 $。\n2. $ -1  1 - \\frac{E g' \\Delta t}{\\eta} \\implies \\frac{E g' \\Delta t}{\\eta}  2 $。\n\n由于 $ E > 0 $，$ \\eta > 0 $，$ \\Delta t > 0 $，第一个不等式要求 $ g' > 0 $。如果 $ g' \\le 0 $，此条件被违反，格式是无条件不稳定的。\n如果 $ g' > 0 $，第一个不等式满足，稳定性由第二个不等式决定：\n$$ \\Delta t  \\frac{2 \\eta}{E g'} $$\n因此，对于 $ g' > 0 $，显式格式是条件稳定的。格式变得不稳定所对应的临界时间步长是 $ \\Delta t_{\\mathrm{crit}} = \\frac{2 \\eta}{E g'} $。对于 $ g' \\le 0 $，不存在使格式稳定的正时间步长，所以我们定义 $ \\Delta t_{\\mathrm{crit}} = 0 $。\n\n**2.2. 隐式（后向）Euler格式**\n\n隐式Euler更新由 $ \\sigma_{n+1} = \\sigma_n + \\Delta t \\, \\dot{\\sigma}_{n+1} = \\sigma_n + \\Delta t (\\lambda \\sigma_{n+1}) $ 给出。\n$$ \\sigma_{n+1} (1 - \\lambda \\Delta t) = \\sigma_n \\implies \\sigma_{n+1} = \\frac{1}{1 - \\lambda \\Delta t} \\sigma_n $$\n放大因子为 $ A_{\\mathrm{imp}} = (1 - \\lambda \\Delta t)^{-1} $。代入 $ \\lambda $：\n$$ A_{\\mathrm{imp}} = \\frac{1}{1 + \\frac{E g' \\Delta t}{\\eta}} $$\n稳定性条件是 $ |A_{\\mathrm{imp}}|  1 $，这等价于 $ |1 + \\frac{E g' \\Delta t}{\\eta}| > 1 $。\n\n我们根据 $ g' $ 的符号来分析此条件：\n- 如果 $ g' > 0 $：项 $ \\frac{E g' \\Delta t}{\\eta} $ 是正的。因此，$ 1 + \\frac{E g' \\Delta t}{\\eta} > 1 $，其幅值也大于 $ 1 $。对于任何 $ \\Delta t > 0 $，稳定性条件总是满足的。该格式是无条件稳定的。\n- 如果 $ g' = 0 $：放大因子为 $ A_{\\mathrm{imp}} = 1 $。幅值为 $ |A_{\\mathrm{imp}}| = 1 $，不严格小于 $ 1 $。该格式不是渐近稳定的。\n- 如果 $ g'  0 $：令 $ g' = -|g'| $。稳定性条件变为 $ |1 - \\frac{E |g'| \\Delta t}{\\eta}| > 1 $。这在 $ 1 - \\frac{E |g'| \\Delta t}{\\eta} > 1 $（这是不可能的，因为 $ E, |g'|, \\Delta t, \\eta $ 都是正的）或 $ 1 - \\frac{E |g'| \\Delta t}{\\eta}  -1 $ 时成立。第二种情况给出：\n$$ 2  \\frac{E |g'| \\Delta t}{\\eta} \\implies \\Delta t > \\frac{2 \\eta}{E |g'|} $$\n该格式是条件稳定的，但仅对大于某一特定值的时间步长才稳定。这反映了一个事实，即对于 $ g'  0 $，物理系统本身是不稳定的（应力无限增长），而隐式格式仅在足够大的时间步长下才能正确捕捉到这种增长。\n\n**3. 算法实现**\n\n对于每个参数集 $ (E, \\eta, g', \\Delta t) $：\n1.  **临界时间步长 ($ \\Delta t_{\\mathrm{crit}} $)**：\n    - 如果 $ g' > 0 $，计算 $ \\Delta t_{\\mathrm{crit}} = \\frac{2 \\eta}{E g'} $。\n    - 否则 ($ g' \\le 0 $)，设置 $ \\Delta t_{\\mathrm{crit}} = 0 $。\n\n2.  **显式Euler稳定性 ($ b_{\\mathrm{exp}} $)**：\n    - 如果 $ g' > 0 $，当 $ \\Delta t  \\Delta t_{\\mathrm{crit}} $ 时格式稳定。\n    - 否则 ($ g' \\le 0 $)，格式不稳定。\n    - 所以，$ b_{\\mathrm{exp}} $ 为 `True` 当且仅当 $ g' > 0 $ 且 $ \\Delta t  \\frac{2 \\eta}{E g'} $。\n\n3.  **隐式Euler稳定性 ($ b_{\\mathrm{imp}} $)**：\n    - 如果 $ g' > 0 $，格式无条件稳定，所以 $ b_{\\mathrm{imp}} $ 为 `True`。\n    - 如果 $ g' = 0 $，格式不稳定，所以 $ b_{\\mathrm{imp}} $ 为 `False`。\n    - 如果 $ g'  0 $，当 $ \\Delta t > \\frac{2 \\eta}{E |g'|} $ 时格式稳定。\n    - 所以，$ b_{\\mathrm{imp}} $ 为 `True` 如果 $ g' > 0 $ 或者 ($ g'  0 $ 且 $ \\Delta t > \\frac{2 \\eta}{E |g'|} $)。否则，它为 `False`。\n\n每个用例的最终输出是一个列表 $ [b_{\\mathrm{exp}}, b_{\\mathrm{imp}}, \\Delta t_{\\mathrm{crit}}] $，其中 $ \\Delta t_{\\mathrm{crit}} $ 四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of determining numerical stability for a viscoelastic model.\n\n    The function processes a suite of test cases, each defined by a set of physical\n    and numerical parameters. For each case, it determines the stability of the\n    explicit and implicit Euler schemes and calculates the critical time step\n    for the explicit scheme.\n    \"\"\"\n    test_cases = [\n        # (E, eta, dG/de, dt)\n        (5.0e7, 1.0e9, 1.0, 1.0e1),      # Case 1\n        (5.0e7, 1.0e9, 1.0, 4.0e1),      # Case 2: Boundary case\n        (5.0e7, 1.0e9, 1.0, 1.0e2),      # Case 3: Large time step\n        (1.0e9, 1.0e8, 0.5, 0.5),        # Case 4: Stiff elasticity, large step\n        (1.0e9, 1.0e8, 0.5, 0.1),        # Case 5: Stiff elasticity, small step\n        (1.0e7, 1.0e9, 0.0, 1.0e3),     # Case 6: Edge case with zero flow factor\n        (1.0e7, 1.0e9, -0.1, 1.0),       # Case 7: Nonphysical negative derivative\n    ]\n\n    output_strings = []\n\n    for E, eta, g_prime, dt in test_cases:\n        # E: Elastic Modulus (Pa)\n        # eta: Reference Viscosity (Pa.s)\n        # g_prime: dG/de (dimensionless)\n        # dt: time step (s)\n\n        # 1. Calculate the critical time step for explicit Euler\n        dt_crit = 0.0\n        if g_prime > 0:\n            # The derivation shows dt_crit = 2 * eta / (E * g_prime)\n            dt_crit = 2 * eta / (E * g_prime)\n\n        # 2. Determine stability of Explicit (forward) Euler\n        # The scheme is stable iff |1 - E*g_prime*dt/eta|  1.\n        # This holds if g_prime > 0 and dt  dt_crit.\n        b_exp = False\n        if g_prime > 0 and dt  dt_crit:\n            b_exp = True\n        \n        # 3. Determine stability of Implicit (backward) Euler\n        # The scheme is stable iff |1 + E*g_prime*dt/eta| > 1.\n        b_imp = False\n        if g_prime > 0:\n            # For g_prime > 0, 1 + E*g_prime*dt/eta is always > 1. Unconditionally stable.\n            b_imp = True\n        elif g_prime  0:\n            # For g_prime  0, stability requires dt > 2*eta / (E*|g_prime|).\n            if dt > (2 * eta / (E * abs(g_prime))):\n                b_imp = True\n        # For g_prime = 0, the amplification factor is 1, so not strictly stable.\n        # b_imp remains False.\n        \n        # Format the result for the current case\n        result_string = f\"[{str(b_exp)}, {str(b_imp)}, {dt_crit:.3f}]\"\n        output_strings.append(result_string)\n\n    # Final print statement in the exact required format\n    final_output = f\"[{','.join(output_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}