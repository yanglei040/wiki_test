{
    "hands_on_practices": [
        {
            "introduction": "This practice serves as a fundamental building block for computational modeling. We will explore a classic uniaxial creep test using a Perzyna viscoplastic model, for which an exact analytical solution is attainable . By first deriving this exact solution and then developing a numerical time-stepping algorithm, you will gain direct insight into the concepts of numerical accuracy and convergence, a crucial skill for verifying any complex computational code.",
            "id": "3521801",
            "problem": "Consider a uniaxial bar made of a linear elastic-overstress viscoplastic solid following the Perzyna model of rate-dependent plasticity with linear isotropic hardening. Assume small strains, isothermal conditions, and uniaxial stress. The total strain $\\varepsilon$ admits the additive decomposition $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$. The uniaxial elastic constitutive relation is $\\sigma = E \\, \\varepsilon^{e}$ with Young’s modulus $E$. The viscoplastic flow is governed by the Perzyna overstress rule with exponent $n=1$,\n$\\dot{\\varepsilon}^{p} = \\frac{1}{\\eta} \\left\\langle f(\\sigma,\\varepsilon^{p}) \\right\\rangle$,\nwhere $\\eta$ is the viscosity parameter, $\\langle \\cdot \\rangle$ denotes the Macaulay bracket $\\langle x \\rangle = \\max(x,0)$, and the uniaxial yield function with linear isotropic hardening is $f(\\sigma,\\varepsilon^{p}) = |\\sigma| - \\sigma_{y} - H \\, \\varepsilon^{p}$ with initial yield stress $\\sigma_{y}$ and hardening modulus $H$. The bar is suddenly loaded at $t=0$ into tension and then held at a constant uniaxial stress $\\sigma(t) = \\sigma_{0} > 0$ for all $t \\ge 0$. The initial condition is $\\varepsilon^{p}(0)=0$.\n\nTasks:\n1) Starting only from the above definitions and balance of linear momentum in the quasi-static limit (no inertia), derive the analytical expression for the viscoplastic strain $\\varepsilon^{p}(t)$ and the total strain $\\varepsilon(t)$ for $t \\ge 0$ under the constant stress $\\sigma(t)=\\sigma_{0}$, assuming $\\sigma_{0} > \\sigma_{y}$.\n2) Construct the fully implicit Backward Euler (BE) time discretization for the evolution of $\\varepsilon^{p}$ with a constant time step $\\Delta t$, and derive a closed-form expression for $\\varepsilon^{p}$ after $N$ steps, i.e., at $t_{N} = N \\Delta t$, in terms of $E$, $H$, $\\eta$, $\\sigma_{y}$, $\\sigma_{0}$, $\\Delta t$, and $N$.\n3) Using your analytical solution from Task 1 and your BE solution from Task 2, evaluate the absolute error in total strain at the final time $T$,\n$\\left|\\varepsilon_{\\text{exact}}(T) - \\varepsilon_{\\text{BE}}(T)\\right|$,\nfor the following data (International System of Units): $E = 30\\,\\mathrm{GPa}$, $H = 2\\,\\mathrm{GPa}$, $\\eta = 2 \\times 10^{14}\\,\\mathrm{Pa\\,s}$, $\\sigma_{y} = 40\\,\\mathrm{MPa}$, $\\sigma_{0} = 60\\,\\mathrm{MPa}$, $T = 2.0 \\times 10^{5}\\,\\mathrm{s}$, $\\Delta t = 2.5 \\times 10^{4}\\,\\mathrm{s}$, and $N = T/\\Delta t$. Report the error as a pure strain (dimensionless) and round your answer to four significant figures. Express the final number without units.",
            "solution": "The problem statement is validated as scientifically sound, well-posed, and complete. It describes a standard problem in computational viscoplasticity. All necessary constitutive relations, parameters, and boundary/initial conditions are provided.\n\nThe assumption of quasi-static loading implies that inertial forces are negligible. For a uniaxial bar, this ensures that the axial stress $\\sigma$ is spatially uniform, allowing it to be prescribed as a function of time, $\\sigma(t)$. The problem states that a constant stress $\\sigma(t) = \\sigma_{0}$ is applied for $t \\ge 0$, with $\\sigma_{0} > \\sigma_{y}$.\n\nThe analysis proceeds in three parts as requested.\n\n**Task 1: Analytical solution for strain evolution**\n\nThe total strain $\\varepsilon$ is the sum of the elastic strain $\\varepsilon^{e}$ and the plastic strain $\\varepsilon^{p}$:\n$$\n\\varepsilon(t) = \\varepsilon^{e}(t) + \\varepsilon^{p}(t)\n$$\nThe elastic strain is given by Hooke's law, $\\sigma(t) = E \\, \\varepsilon^{e}(t)$. Since the stress is constant, $\\sigma(t) = \\sigma_{0}$, the elastic strain is also constant:\n$$\n\\varepsilon^{e}(t) = \\frac{\\sigma_{0}}{E}\n$$\nThe evolution of the viscoplastic strain $\\varepsilon^{p}$ is governed by the Perzyna flow rule:\n$$\n\\dot{\\varepsilon}^{p} = \\frac{1}{\\eta} \\left\\langle f(\\sigma,\\varepsilon^{p}) \\right\\rangle\n$$\nwhere the yield function $f$ is given by $f(\\sigma,\\varepsilon^{p}) = |\\sigma| - \\sigma_{y} - H \\, \\varepsilon^{p}$.\nGiven that $\\sigma(t) = \\sigma_{0} > 0$, we have $|\\sigma| = \\sigma_{0}$. The yield function becomes $f(\\sigma_{0},\\varepsilon^{p}) = \\sigma_{0} - \\sigma_{y} - H \\, \\varepsilon^{p}$.\nThe initial condition is $\\varepsilon^{p}(0)=0$. At $t=0$, the value of the yield function is $f(\\sigma_0, 0) = \\sigma_0 - \\sigma_y$. Since it is given that $\\sigma_{0} > \\sigma_{y}$, this value is positive. By continuity, $f$ will remain positive for some time interval after $t=0$. The Macaulay bracket can be dropped, $\\left\\langle f \\right\\rangle = f$, as long as $f \\ge 0$. The governing equation for $\\varepsilon^{p}$ is thus a linear first-order ordinary differential equation (ODE):\n$$\n\\frac{d\\varepsilon^{p}}{dt} = \\frac{1}{\\eta} (\\sigma_{0} - \\sigma_{y} - H \\, \\varepsilon^{p})\n$$\nThis can be rearranged into the standard form:\n$$\n\\frac{d\\varepsilon^{p}}{dt} + \\frac{H}{\\eta} \\varepsilon^{p} = \\frac{\\sigma_{0} - \\sigma_{y}}{\\eta}\n$$\nThe solution to this ODE with the initial condition $\\varepsilon^{p}(0)=0$ is found by standard methods. The general solution is the sum of a homogeneous solution $\\varepsilon^{p}_{h}(t) = C \\exp\\left(-\\frac{H}{\\eta}t\\right)$ and a particular solution $\\varepsilon^{p}_{p}(t) = \\frac{\\sigma_{0} - \\sigma_{y}}{H}$.\nThe full solution is $\\varepsilon^{p}(t) = \\frac{\\sigma_{0} - \\sigma_{y}}{H} + C \\exp\\left(-\\frac{H}{\\eta}t\\right)$.\nApplying the initial condition $\\varepsilon^{p}(0)=0$:\n$$\n0 = \\frac{\\sigma_{0} - \\sigma_{y}}{H} + C \\implies C = -\\frac{\\sigma_{0} - \\sigma_{y}}{H}\n$$\nSubstituting $C$ back, we obtain the analytical expression for the viscoplastic strain:\n$$\n\\varepsilon^{p}(t) = \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left( 1 - \\exp\\left(-\\frac{H}{\\eta}t\\right) \\right)\n$$\nAs $t \\to \\infty$, $\\varepsilon^{p}(t) \\to \\frac{\\sigma_{0} - \\sigma_{y}}{H}$, which makes $f \\to \\sigma_{0} - \\sigma_{y} - H \\frac{\\sigma_{0} - \\sigma_{y}}{H} = 0$. So the condition $f \\ge 0$ is satisfied for all $t \\ge 0$.\nThe total strain $\\varepsilon(t)$ is then:\n$$\n\\varepsilon(t) = \\frac{\\sigma_{0}}{E} + \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left( 1 - \\exp\\left(-\\frac{H}{\\eta}t\\right) \\right)\n$$\n\n**Task 2: Backward Euler (BE) discretization**\n\nWe discretize the time domain with a constant step $\\Delta t$, such that $t_{k} = k \\Delta t$. The Backward Euler scheme approximates the rate $\\dot{\\varepsilon}^{p}$ at time $t_{k+1}$ as $\\frac{\\varepsilon^{p}_{k+1} - \\varepsilon^{p}_{k}}{\\Delta t}$, and evaluates the right-hand side of the ODE at $t_{k+1}$:\n$$\n\\frac{\\varepsilon^{p}_{k+1} - \\varepsilon^{p}_{k}}{\\Delta t} = \\frac{1}{\\eta} \\left\\langle \\sigma_{0} - \\sigma_{y} - H \\varepsilon^{p}_{k+1} \\right\\rangle\n$$\nHere, $\\varepsilon^{p}_{k}$ denotes the numerical approximation of $\\varepsilon^{p}(t_k)$. Assuming plastic flow occurs at step $k+1$ (a consistent assumption given the loading), we can drop the Macaulay bracket:\n$$\n\\frac{\\varepsilon^{p}_{k+1} - \\varepsilon^{p}_{k}}{\\Delta t} = \\frac{1}{\\eta} (\\sigma_{0} - \\sigma_{y} - H \\varepsilon^{p}_{k+1})\n$$\nWe solve for $\\varepsilon^{p}_{k+1}$:\n$$\n\\varepsilon^{p}_{k+1} - \\varepsilon^{p}_{k} = \\frac{\\Delta t}{\\eta} (\\sigma_{0} - \\sigma_{y}) - \\frac{H \\Delta t}{\\eta} \\varepsilon^{p}_{k+1}\n$$\n$$\n\\varepsilon^{p}_{k+1} \\left(1 + \\frac{H \\Delta t}{\\eta}\\right) = \\varepsilon^{p}_{k} + \\frac{\\Delta t}{\\eta} (\\sigma_{0} - \\sigma_{y})\n$$\n$$\n\\varepsilon^{p}_{k+1} = \\frac{1}{1 + \\frac{H \\Delta t}{\\eta}} \\varepsilon^{p}_{k} + \\frac{\\frac{\\Delta t}{\\eta}(\\sigma_{0} - \\sigma_{y})}{1 + \\frac{H \\Delta t}{\\eta}}\n$$\nThis is a linear recurrence relation of the form $\\varepsilon^{p}_{k+1} = A \\varepsilon^{p}_{k} + B$, with $\\varepsilon^{p}_{0}=0$. The solution after $N$ steps is given by $\\varepsilon^{p}_{N} = B \\sum_{k=0}^{N-1} A^k = B \\frac{1 - A^N}{1 - A}$.\nLet's compute the term $\\frac{B}{1-A}$:\n$$\n1 - A = 1 - \\frac{1}{1 + \\frac{H \\Delta t}{\\eta}} = \\frac{H \\Delta t/\\eta}{1 + H \\Delta t/\\eta}\n$$\n$$\n\\frac{B}{1 - A} = \\frac{\\frac{\\frac{\\Delta t}{\\eta}(\\sigma_{0} - \\sigma_{y})}{1 + \\frac{H \\Delta t}{\\eta}}}{\\frac{\\frac{H \\Delta t}{\\eta}}{1 + \\frac{H \\Delta t}{\\eta}}} = \\frac{\\sigma_{0} - \\sigma_{y}}{H}\n$$\nTherefore, the closed-form expression for $\\varepsilon^{p}_{N}$ is:\n$$\n\\varepsilon^{p}_{N} = \\frac{\\sigma_{0} - \\sigma_{y}}{H} (1 - A^N) = \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left( 1 - \\left(\\frac{1}{1 + \\frac{H \\Delta t}{\\eta}}\\right)^N \\right)\n$$\nThis can also be written as:\n$$\n\\varepsilon^{p}_{N} = \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left( 1 - \\left(1 + \\frac{H \\Delta t}{\\eta}\\right)^{-N} \\right)\n$$\n\n**Task 3: Error calculation**\n\nWe need to evaluate the absolute error in the total strain at time $T = N \\Delta t$:\n$Error = \\left|\\varepsilon_{\\text{exact}}(T) - \\varepsilon_{\\text{BE}}(T)\\right|$.\nThe exact total strain at $T$ is $\\varepsilon_{\\text{exact}}(T) = \\varepsilon^{e}(T) + \\varepsilon^{p}_{\\text{exact}}(T)$.\nThe BE approximated total strain at $T$ is $\\varepsilon_{\\text{BE}}(T) = \\varepsilon^{e}(T) + \\varepsilon^{p}_{N}$.\nThe elastic strain term $\\varepsilon^{e}(T) = \\sigma_{0}/E$ is common to both expressions and cancels out in the difference. The error is solely in the viscoplastic strain component:\n$$\nError = \\left| \\varepsilon^{p}_{\\text{exact}}(T) - \\varepsilon^{p}_{N} \\right|\n$$\nSubstituting the expressions derived in Tasks 1 and 2, with $T=N\\Delta t$:\n$$\nError = \\left| \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left( 1 - \\exp\\left(-\\frac{H T}{\\eta}\\right) \\right) - \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left( 1 - \\left(1 + \\frac{H \\Delta t}{\\eta}\\right)^{-N} \\right) \\right|\n$$\n$$\nError = \\frac{\\sigma_{0} - \\sigma_{y}}{H} \\left| \\left(1 + \\frac{H \\Delta t}{\\eta}\\right)^{-N} - \\exp\\left(-\\frac{H T}{\\eta}\\right) \\right|\n$$\nNow, we substitute the given numerical values:\n$E = 30 \\times 10^{9}\\,\\mathrm{Pa}$\n$H = 2 \\times 10^{9}\\,\\mathrm{Pa}$\n$\\eta = 2 \\times 10^{14}\\,\\mathrm{Pa\\,s}$\n$\\sigma_{y} = 40 \\times 10^{6}\\,\\mathrm{Pa}$\n$\\sigma_{0} = 60 \\times 10^{6}\\,\\mathrm{Pa}$\n$T = 2.0 \\times 10^{5}\\,\\mathrm{s}$\n$\\Delta t = 2.5 \\times 10^{4}\\,\\mathrm{s}$\n$N = T/\\Delta t = (2.0 \\times 10^{5}) / (2.5 \\times 10^{4}) = 8$\n\nFirst, calculate the prefactor:\n$$\n\\frac{\\sigma_{0} - \\sigma_{y}}{H} = \\frac{60 \\times 10^{6}\\,\\mathrm{Pa} - 40 \\times 10^{6}\\,\\mathrm{Pa}}{2 \\times 10^{9}\\,\\mathrm{Pa}} = \\frac{20 \\times 10^{6}}{2 \\times 10^{9}} = 1 \\times 10^{-2} = 0.01\n$$\nNext, calculate the arguments of the terms inside the absolute value:\n$$\n\\frac{H \\Delta t}{\\eta} = \\frac{(2 \\times 10^{9}\\,\\mathrm{Pa}) \\times (2.5 \\times 10^{4}\\,\\mathrm{s})}{2 \\times 10^{14}\\,\\mathrm{Pa\\,s}} = \\frac{5 \\times 10^{13}}{2 \\times 10^{14}} = 0.25\n$$\n$$\n\\frac{H T}{\\eta} = \\frac{(2 \\times 10^{9}\\,\\mathrm{Pa}) \\times (2.0 \\times 10^{5}\\,\\mathrm{s})}{2 \\times 10^{14}\\,\\mathrm{Pa\\,s}} = \\frac{4 \\times 10^{14}}{2 \\times 10^{14}} = 2\n$$\nNote that $\\frac{HT}{\\eta} = \\frac{H(N\\Delta t)}{\\eta} = N \\left(\\frac{H\\Delta t}{\\eta}\\right) = 8 \\times 0.25 = 2$, which is consistent.\n\nNow, substitute these into the error formula:\n$$\nError = 0.01 \\times \\left| \\left(1 + 0.25\\right)^{-8} - \\exp(-2) \\right|\n$$\n$$\nError = 0.01 \\times \\left| (1.25)^{-8} - \\exp(-2) \\right|\n$$\n$$\nError = 0.01 \\times \\left| \\left(\\frac{5}{4}\\right)^{-8} - \\exp(-2) \\right| = 0.01 \\times \\left| \\left(\\frac{4}{5}\\right)^{8} - \\exp(-2) \\right|\n$$\n$$\nError = 0.01 \\times \\left| (0.8)^{8} - \\exp(-2) \\right|\n$$\nNow we compute the numerical values:\n$(0.8)^{8} \\approx 0.16777216$\n$\\exp(-2) \\approx 0.13533528$\n$$\nError \\approx 0.01 \\times |0.16777216 - 0.13533528|\n$$\n$$\nError \\approx 0.01 \\times 0.03243688\n$$\n$$\nError \\approx 0.0003243688\n$$\nRounding to four significant figures, the error is $0.0003244$. In scientific notation, this is $3.244 \\times 10^{-4}$.",
            "answer": "$$\n\\boxed{3.244 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "Real-world geomaterial models, such as Mohr-Coulomb, often feature non-smooth yield surfaces with 'corners' and 'edges' in principal stress space. At these points, the plastic flow direction cannot be determined by a simple gradient, posing a significant challenge for numerical implementation. This exercise guides you through the application of subdifferential calculus to robustly handle these non-differentiabilities, allowing you to develop a key algorithm for computing a unique and physically consistent plastic flow direction .",
            "id": "3521788",
            "problem": "Consider a three-dimensional stress state with principal stresses denoted by the vector $\\boldsymbol{\\sigma} = [\\sigma_1,\\sigma_2,\\sigma_3]$ with the convention that no ordering is assumed. In the Mohr-Coulomb model, the yield condition can be expressed in principal stress space using the friction angle $\\varphi$ and cohesion $c$ through the convex function\n$$\nf(\\boldsymbol{\\sigma};\\varphi,c) = \\max(\\sigma_1,\\sigma_2,\\sigma_3) - K(\\varphi)\\,\\min(\\sigma_1,\\sigma_2,\\sigma_3) - 2\\,c\\,\\sqrt{K(\\varphi)},\n$$\nwhere $$K(\\theta) = \\dfrac{1+\\sin\\theta}{1-\\sin\\theta}.$$ For Elasto-Viscoplasticity (EVP), the rate of plastic flow is governed by a plastic potential $g$ constructed analogously from the dilation angle $\\psi$,\n$$\ng(\\boldsymbol{\\sigma};\\psi) = \\max(\\sigma_1,\\sigma_2,\\sigma_3) - K(\\psi)\\,\\min(\\sigma_1,\\sigma_2,\\sigma_3).\n$$\nBecause $g$ is nondifferentiable on edges and corners corresponding to ties among principal stresses, the plastic flow direction must be defined using the subdifferential $\\partial g(\\boldsymbol{\\sigma};\\psi)$. The return mapping algorithm in EVP requires detecting whether the stress state lies on a smooth facet (edge) or on a corner and selecting a consistent subgradient direction.\n\nStarting from the fundamental definitions of convex subdifferentials of pointwise maximum and minimum functions, derive an algorithm that:\n- Detects the active edge or corner set in principal stress space for the Mohr-Coulomb EVP update using a tolerance $\\varepsilon$ to identify ties, and classifies the state as an \"edge\" when both the maximum and minimum sets are singletons or as a \"corner\" otherwise.\n- Computes a well-defined subgradient direction $\\mathbf{n}_p \\in \\partial g(\\boldsymbol{\\sigma};\\psi)$ for plastic flow in principal stress space by selecting the minimal-norm element of the subdifferential (use uniform convex weights over the tied indices in the maximum and minimum sets).\n- Normalizes the subgradient direction to unit Euclidean norm when its norm is nonzero, leaving it as the zero vector if the norm is zero.\n\nUse the following fundamental bases:\n- The definition of the Mohr-Coulomb yield function in principal stress space and the plastic potential $g$ as convex functions of principal stresses.\n- The subdifferential of the pointwise maximum and minimum of linear functionals, and the characterization of the subgradient on nondifferentiable points via convex hulls.\n- The principle that selecting uniform convex weights over tied active sets yields the minimal Euclidean norm subgradient due to symmetry.\n\nImplement the derived algorithm in a complete, runnable program that, for each test case, returns:\n- An integer classification code $c_{\\text{class}}$ with $0$ for edge and $1$ for corner.\n- The list of indices of the active maximum set $\\mathcal{I}_{\\max} \\subset \\{0,1,2\\}$.\n- The list of indices of the active minimum set $\\mathcal{J}_{\\min} \\subset \\{0,1,2\\}$.\n- The normalized subgradient direction vector $\\mathbf{n}_p$ for plastic flow computed from $g(\\boldsymbol{\\sigma};\\psi)$.\n- The yield overstress $f(\\boldsymbol{\\sigma};\\varphi,c)$ in $\\mathrm{MPa}$.\n\nAngles must be provided in degrees and converted to radians internally before applying the sine function. Stress quantities must be handled in megapascals ($\\mathrm{MPa}$). The normalized subgradient direction is dimensionless, and the yield overstress must be reported in $\\mathrm{MPa}$. The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest Suite:\nUse the following parameter sets to validate the algorithm, expressed as tuples $(\\boldsymbol{\\sigma}\\ \\mathrm{in}\\ \\mathrm{MPa},\\ c\\ \\mathrm{in}\\ \\mathrm{MPa},\\ \\varphi\\ \\mathrm{in}\\ \\mathrm{degrees},\\ \\psi\\ \\mathrm{in}\\ \\mathrm{degrees},\\ \\varepsilon\\ \\mathrm{in}\\ \\mathrm{MPa})$:\n1. $\\left([100.0, 70.0, 30.0],\\ 5.0,\\ 30.0,\\ 5.0,\\ 10^{-3}\\right)$: distinct principal stresses, typical edge case.\n2. $\\left([100.0, 100.0 - 10^{-4}, 40.0],\\ 5.0,\\ 30.0,\\ 10.0,\\ 10^{-3}\\right)$: near tie on the maximum, corner case.\n3. $\\left([50.0, 50.0, 50.0],\\ 0.0,\\ 25.0,\\ 5.0,\\ 10^{-6}\\right)$: hydrostatic stress, corner at apex, zero cohesion.\n4. $\\left([90.0, 30.0, 30.0],\\ 10.0,\\ 35.0,\\ 5.0,\\ 10^{-6}\\right)$: tie on the minimum, corner case.\n5. $\\left([-10.0, -20.0, -30.0],\\ 2.0,\\ 30.0,\\ 0.0,\\ 10^{-4}\\right)$: tensile regime with zero dilation angle, edge case.\n6. Let $K(\\varphi)$ at $\\varphi=30.0^\\circ$ be used; choose $\\sigma_3=30.0$, then set $\\sigma_1 = K(\\varphi)\\,\\sigma_3 + 2\\,c\\,\\sqrt{K(\\varphi)}$, and $\\sigma_2=50.0$ with $c=5.0$, $\\varphi=30.0^\\circ$, $\\psi=10.0^\\circ$, $\\varepsilon=10^{-6}$: stress on the yield surface to test overstress near zero.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form\n$$\n\\left[c_{\\text{class}},\\ \\mathcal{I}_{\\max},\\ \\mathcal{J}_{\\min},\\ \\mathbf{n}_p,\\ f(\\boldsymbol{\\sigma};\\varphi,c)\\right].\n$$\nAll lists must use zero-based indices for principal stress positions. The normalized subgradient vector $\\mathbf{n}_p$ must be reported as a list of three floats, and $f(\\boldsymbol{\\sigma};\\varphi,c)$ must be a float in $\\mathrm{MPa}$.",
            "solution": "The problem requires the derivation and implementation of an algorithm to determine the plastic flow direction for an elasto-viscoplastic material governed by a non-associated Mohr-Coulomb model. This is a fundamental task in computational geomechanics, particularly for stress-update procedures known as return mapping algorithms. The core challenge lies in handling the non-differentiability of the plastic potential function $g(\\boldsymbol{\\sigma};\\psi)$ at stress states where principal stresses are tied, corresponding to edges and corners of the yield surface in principal stress space.\n\nThe solution proceeds by applying the principles of convex analysis to the plastic potential function. The plastic flow direction is given by the gradient of the plastic potential, $\\nabla g$. However, where $g$ is not differentiable, the gradient is not uniquely defined. In its place, we use the subdifferential, denoted $\\partial g$, which is the set of all valid subgradients.\n\nThe plastic potential is given by:\n$$\ng(\\boldsymbol{\\sigma};\\psi) = \\max(\\sigma_1, \\sigma_2, \\sigma_3) - K(\\psi)\\,\\min(\\sigma_1, \\sigma_2, \\sigma_3)\n$$\nwhere $\\boldsymbol{\\sigma} = [\\sigma_1, \\sigma_2, \\sigma_3]$ is the vector of principal stresses, $\\psi$ is the dilation angle, and $$K(\\psi) = \\frac{1+\\sin\\psi}{1-\\sin\\psi}.$$ Let us define $\\sigma_{\\max} = \\max_i\\{\\sigma_i\\}$ and $\\sigma_{\\min} = \\min_i\\{\\sigma_i\\}$. The function $g$ can be written as $g(\\boldsymbol{\\sigma}) = \\sigma_{\\max} - K(\\psi)\\sigma_{\\min}$.\n\nBoth $\\sigma_{\\max}$ and $\\sigma_{\\min}$ are convex functions of $\\boldsymbol{\\sigma}$. The subdifferential of a sum of convex functions is the Minkowski sum of their individual subdifferentials. Therefore, the subdifferential of $g$ is:\n$$\n\\partial g(\\boldsymbol{\\sigma}) = \\partial(\\sigma_{\\max}) - K(\\psi)\\,\\partial(\\sigma_{\\min})\n$$\nThe subdifferential of the pointwise maximum of a set of functions is the convex hull of the gradients of the active functions. Let $\\mathcal{I}_{\\max} = \\{i \\in \\{1,2,3\\} \\mid \\sigma_i = \\sigma_{\\max}\\}$ be the set of indices corresponding to the maximum principal stress. The gradients of the individual functions $\\sigma_i$ are the standard basis vectors $\\mathbf{e}_i$. Thus, the subdifferential of $\\sigma_{\\max}$ is:\n$$\n\\partial(\\sigma_{\\max}) = \\text{conv}\\{\\mathbf{e}_i \\mid i \\in \\mathcal{I}_{\\max}\\} = \\left\\{ \\sum_{i \\in \\mathcal{I}_{\\max}} \\alpha_i \\mathbf{e}_i \\mid \\alpha_i \\ge 0, \\sum_{i \\in \\mathcal{I}_{\\max}} \\alpha_i = 1 \\right\\}\n$$\nSimilarly, let $\\mathcal{J}_{\\min} = \\{j \\in \\{1,2,3\\} \\mid \\sigma_j = \\sigma_{\\min}\\}$ be the set of indices corresponding to the minimum principal stress. The subdifferential of $\\sigma_{\\min}$ is:\n$$\n\\partial(\\sigma_{\\min}) = \\text{conv}\\{\\mathbf{e}_j \\mid j \\in \\mathcal{J}_{\\min}\\} = \\left\\{ \\sum_{j \\in \\mathcal{J}_{\\min}} \\beta_j \\mathbf{e}_j \\mid \\beta_j \\ge 0, \\sum_{j \\in \\mathcal{J}_{\\min}} \\beta_j = 1 \\right\\}\n$$\nAny subgradient $\\mathbf{m} \\in \\partial g(\\boldsymbol{\\sigma})$ can be expressed as $\\mathbf{m} = \\mathbf{a} - K(\\psi)\\mathbf{b}$, where $\\mathbf{a} \\in \\partial(\\sigma_{\\max})$ and $\\mathbf{b} \\in \\partial(\\sigma_{\\min})$.\n\nTo ensure a unique plastic flow direction, we select the subgradient with the minimum Euclidean norm, which is a unique vector as $\\partial g(\\boldsymbol{\\sigma})$ is a closed convex set. This minimal-norm element is found by selecting uniform convex weights for the active gradients. This choice is justified by the symmetry of the convex hulls. Let $N_{\\max} = |\\mathcal{I}_{\\max}|$ and $N_{\\min} = |\\mathcal{J}_{\\min}|$ be the number of tied maximum and minimum principal stresses, respectively. The weights are $\\alpha_i = 1/N_{\\max}$ and $\\beta_j = 1/N_{\\min}$.\n\nThe resulting minimal-norm subgradient, denoted $\\mathbf{m}_p$, is:\n$$\n\\mathbf{m}_p = \\left( \\frac{1}{N_{\\max}} \\sum_{i \\in \\mathcal{I}_{\\max}} \\mathbf{e}_i \\right) - K(\\psi) \\left( \\frac{1}{N_{\\min}} \\sum_{j \\in \\mathcal{J}_{\\min}} \\mathbf{e}_j \\right)\n$$\nThis vector $\\mathbf{m}_p$ represents the direction of plastic flow. For consistency in constitutive models, it is normalized to have a unit Euclidean norm, provided it is not a zero vector. The normalized plastic flow direction $\\mathbf{n}_p$ is:\n$$\n\\mathbf{n}_p = \\begin{cases} \\frac{\\mathbf{m}_p}{\\|\\mathbf{m}_p\\|_2} & \\text{if } \\|\\mathbf{m}_p\\|_2 \\neq 0 \\\\ \\mathbf{0} & \\text{if } \\|\\mathbf{m}_p\\|_2 = 0 \\end{cases}\n$$\nThe norm $\\|\\mathbf{m}_p\\|_2$ is zero only under the specific conditions of a hydrostatic stress state ($\\sigma_1 = \\sigma_2 = \\sigma_3$, so $\\mathcal{I}_{\\max} = \\mathcal{J}_{\\min} = \\{1,2,3\\}$) and a zero dilation angle ($\\psi=0$, so $K(\\psi)=1$).\n\nThe algorithmic procedure is as follows:\n1.  Given a stress vector $\\boldsymbol{\\sigma}$, find $\\sigma_{\\max}$ and $\\sigma_{\\min}$.\n2.  Using a numerical tolerance $\\varepsilon > 0$, identify the active index sets:\n    $\\mathcal{I}_{\\max} = \\{i \\in \\{0,1,2\\} \\mid \\sigma_i \\ge \\sigma_{\\max} - \\varepsilon\\}$\n    $\\mathcal{J}_{\\min} = \\{j \\in \\{0,1,2\\} \\mid \\sigma_j \\le \\sigma_{\\min} + \\varepsilon\\}$\n3.  Classify the stress state. If $N_{\\max} = 1$ and $N_{\\min} = 1$, the state is on a smooth face ('edge'), and the classification code is $c_{\\text{class}} = 0$. Otherwise, it is on a non-smooth intersection ('corner'), and $c_{\\text{class}} = 1$.\n4.  Compute the components of the vector $\\mathbf{m}_p = [m_{p,1}, m_{p,2}, m_{p,3}]$. For each component $k \\in \\{1,2,3\\}$:\n    $$\n    m_{p,k} = \\begin{cases} 1/N_{\\max} & \\text{if } k-1 \\in \\mathcal{I}_{\\max} \\text{ and } k-1 \\notin \\mathcal{J}_{\\min} \\\\ -K(\\psi)/N_{\\min} & \\text{if } k-1 \\notin \\mathcal{I}_{\\max} \\text{ and } k-1 \\in \\mathcal{J}_{\\min} \\\\ 1/N_{\\max} - K(\\psi)/N_{\\min} & \\text{if } k-1 \\in \\mathcal{I}_{\\max} \\text{ and } k-1 \\in \\mathcal{J}_{\\min} \\\\ 0 & \\text{otherwise} \\end{cases}\n    $$\n    Note that we use $0$-based indices $\\{0,1,2\\}$ in the implementation.\n5.  Calculate the Euclidean norm $\\|\\mathbf{m}_p\\|_2$ and normalize to find $\\mathbf{n}_p$.\n6.  Finally, compute the yield overstress $f(\\boldsymbol{\\sigma};\\varphi,c)$ using the Mohr-Coulomb yield function:\n    $$\n    f(\\boldsymbol{\\sigma};\\varphi,c) = \\sigma_{\\max} - K(\\varphi)\\,\\sigma_{\\min} - 2\\,c\\,\\sqrt{K(\\varphi)}\n    $$\nThis algorithm provides a complete and robust method for determining the classification, active sets, plastic flow direction, and yield overstress, which are essential components for numerical integration of elasto-viscoplastic constitutive models.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an algorithm to compute the plastic flow direction\n    for a non-associated Mohr-Coulomb model in principal stress space.\n    \"\"\"\n\n    # Pre-calculate stress for test case 6\n    # phi = 30.0 degrees, c = 5.0 MPa, sigma_3 = 30.0 MPa\n    k_phi_30 = (1 + np.sin(np.deg2rad(30.0))) / (1 - np.sin(np.deg2rad(30.0)))\n    sigma1_tc6 = k_phi_30 * 30.0 + 2 * 5.0 * np.sqrt(k_phi_30)\n\n    test_cases = [\n        ([100.0, 70.0, 30.0], 5.0, 30.0, 5.0, 1e-3),\n        ([100.0, 100.0 - 1e-4, 40.0], 5.0, 30.0, 10.0, 1e-3),\n        ([50.0, 50.0, 50.0], 0.0, 25.0, 5.0, 1e-6),\n        ([90.0, 30.0, 30.0], 10.0, 35.0, 5.0, 1e-6),\n        ([-10.0, -20.0, -30.0], 2.0, 30.0, 0.0, 1e-4),\n        ([sigma1_tc6, 50.0, 30.0], 5.0, 30.0, 10.0, 1e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_vec, c, phi_deg, psi_deg, eps = case\n        sigma = np.array(sigma_vec, dtype=float)\n        \n        # Convert angles to radians\n        phi_rad = np.deg2rad(phi_deg)\n        psi_rad = np.deg2rad(psi_deg)\n        \n        # Calculate K coefficients\n        # Handle the case where sin(theta) is 1.0, though unlikely with typical angles.\n        if np.isclose(np.sin(phi_rad), 1.0):\n            k_phi = np.inf\n        else:\n            k_phi = (1 + np.sin(phi_rad)) / (1 - np.sin(phi_rad))\n\n        if np.isclose(np.sin(psi_rad), 1.0):\n            k_psi = np.inf\n        else:\n            k_psi = (1 + np.sin(psi_rad)) / (1 - np.sin(psi_rad))\n        \n        # Find max and min principal stresses\n        sigma_max = np.max(sigma)\n        sigma_min = np.min(sigma)\n        \n        # Identify active sets using tolerance\n        I_max_indices = np.where(sigma >= sigma_max - eps)[0]\n        J_min_indices = np.where(sigma = sigma_min + eps)[0]\n        \n        N_max = len(I_max_indices)\n        N_min = len(J_min_indices)\n        \n        # Classify as edge or corner\n        if N_max == 1 and N_min == 1:\n            c_class = 0  # Edge\n        else:\n            c_class = 1  # Corner\n\n        # Compute minimal-norm subgradient m_p\n        m_p = np.zeros(3)\n        if N_max > 0:\n            m_p[I_max_indices] += 1.0 / N_max\n        if N_min > 0:\n            m_p[J_min_indices] -= k_psi / N_min\n            \n        # Normalize the subgradient to get plastic flow direction n_p\n        norm_mp = np.linalg.norm(m_p)\n        if norm_mp > 1e-12: # Use a machine epsilon for floating point comparison\n            n_p = m_p / norm_mp\n        else:\n            n_p = np.zeros(3)\n            \n        # Compute yield overstress f\n        if np.isinf(k_phi):\n            # This is a special case (tension cut-off) not formally handled by the formula\n            # For this problem, it's safe to assume phi  90 deg.\n            pass\n        f_overstress = sigma_max - k_phi * sigma_min - 2 * c * np.sqrt(k_phi)\n\n        result_tuple = [\n            c_class,\n            I_max_indices.tolist(),\n            J_min_indices.tolist(),\n            n_p.tolist(),\n            f_overstress\n        ]\n        results.append(result_tuple)\n\n    # Format the final output string\n    # Using str(list) automatically creates the desired output format '[...]'\n    output_str = f\"[{','.join(map(str, results))}]\"\n    # Replace spaces after commas inside each list for a more compact representation, optional but cleaner.\n    output_str = output_str.replace(\", \", \",\")\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "Beyond the corners of yield surfaces, another type of singularity plagues many pressure-dependent models like Drucker-Prager: the apex singularity, which occurs at hydrostatic stress states. Standard implementations can fail catastrophically near this point due to undefined flow directions, hindering the convergence of numerical solvers. This practice challenges you to analyze this numerical pitfall and identify robust, continuously differentiable formulations that 'smooth' the apex, ensuring your implementation is stable and efficient across all stress regimes .",
            "id": "3521822",
            "problem": "A three-dimensional small-strain elasto-viscoplasticity (EVP) model for geomaterials is considered under the standard soil mechanics sign convention in which compression is positive. Let the Cauchy stress be $\\boldsymbol{\\sigma}$, the mean stress be $p=-\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$, the deviatoric stress be $\\mathbf{s}=\\boldsymbol{\\sigma}+p\\mathbf{I}$, and the equivalent shear stress be $q=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}$, where $\\mathbf{I}$ is the identity tensor and $:$ denotes the double contraction. The EVP flow rule is given by $$\\dot{\\boldsymbol{\\varepsilon}}^{\\mathrm{vp}}=\\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}},$$ with the scalar viscoplastic multiplier $\\dot{\\lambda}\\ge 0$ prescribed by an overstress-type Perzyna law, for example $\\dot{\\lambda}=\\dfrac{1}{\\eta}\\langle F(\\boldsymbol{\\sigma})\\rangle^{m}$ with viscosity $\\eta0$, rate exponent $m\\ge 1$, Macaulay brackets $\\langle\\cdot\\rangle$, and $F(\\boldsymbol{\\sigma})$ the yield function. Assume a Drucker–Prager-type model in invariant form with $F(p,q)=q+\\alpha p-k$ and the non-associated plastic potential $g(p,q)=q+\\beta p$, where $\\alpha,\\beta,k0$ are material parameters.\n\nA fully implicit backward-Euler stress update is used within a Newton–Raphson algorithm, requiring evaluation of $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ and the algorithmic consistent tangent. Starting from the definitions of $p$, $\\mathbf{s}$, and $q$, analyze the behavior of the EVP stress update and its linearization in the vicinity of hydrostatic states, i.e., when $\\mathbf{s}\\to\\mathbf{0}$ and $q\\to 0$. Identify the numerical pitfall that arises from the invariant-based formulation and explain why it occurs. Then, select all options that describe robust formulations or implementation strategies that avoid singularities while preserving differentiability, convexity, and thermodynamic consistency.\n\nOptions:\nA. Replace $q$ everywhere in $F$ and $g$ by the smooth norm $q_{\\varepsilon}=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}+\\varepsilon^{2}}$, with $\\varepsilon0$ chosen as a small, dimensionally consistent fraction of a characteristic shear stress, and base $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ and the Jacobian on $q_{\\varepsilon}$; this yields bounded derivatives as $q\\to 0$ and maintains convexity of the invariant functions.\n\nB. Freeze the deviatoric direction to the start-of-step value by setting $\\mathbf{n}=\\mathbf{s}_{n}/q_{n}$, where the subscript $n$ denotes the previous converged state, and perform an explicit viscoplastic update using this fixed direction to avoid division by small $q$ at the current step.\n\nC. Redefine the deviatoric part of the plastic potential as $g_{\\mathrm{dev}}=\\tfrac{3}{4}\\,\\mathbf{s}:\\mathbf{s}$ so that $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}=\\tfrac{3}{2}\\,\\mathbf{s}$, and keep $F(p,q)$ unchanged; this eliminates $\\dfrac{\\mathbf{s}}{q}$ in the flow direction without altering the yield function.\n\nD. Introduce a tolerance $\\varepsilon0$, clip $q$ to zero when $q\\varepsilon$, and set the deviatoric flow direction $\\mathbf{n}=\\mathbf{0}$ under this condition, proceeding with the original invariant formulas elsewhere.\n\nE. Reformulate the EVP model with a smooth invariant norm (e.g., $q_{\\varepsilon}$) consistently in $F$ and $g$, and compute all required derivatives, including the algorithmic consistent tangent, by exact analytic expressions or by Automatic Differentiation (AD) to avoid hand-coded normalizations and ensure $C^{1}$ smoothness.\n\nSelect all that apply.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, and objective. It describes a standard scenario in computational geomechanics involving an elasto-viscoplastic Drucker-Prager model and identifies a known numerical challenge. The problem is valid.\n\nThe core task is to analyze a numerical pitfall in the fully implicit stress update for an elasto-viscoplastic model and to identify robust implementation strategies. The model is of the Drucker-Prager type, with yield function $F(p,q)=q+\\alpha p-k$ and a non-associated plastic potential $g(p,q)=q+\\beta p$. The viscoplastic flow rule is given by $\\dot{\\boldsymbol{\\varepsilon}}^{\\mathrm{vp}}=\\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$.\n\nThe numerical pitfall arises from the evaluation of the gradient of the plastic potential, $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$, which determines the direction of viscoplastic flow. Using the chain rule, this gradient is:\n$$ \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial q}\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} $$\nThe terms are evaluated as follows, using the provided definitions $p=-\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ and $q=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}$:\n- $\\dfrac{\\partial g}{\\partial p} = \\beta$\n- $\\dfrac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = -\\dfrac{1}{3}\\mathbf{I}$\n- $\\dfrac{\\partial g}{\\partial q} = 1$\n- $\\dfrac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\dfrac{\\partial}{\\partial \\boldsymbol{\\sigma}}\\left(\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}\\right)$. For $q \\neq 0$, this is $\\dfrac{1}{2q} \\left(\\dfrac{3}{2} \\cdot 2\\mathbf{s}\\right) : \\dfrac{\\partial \\mathbf{s}}{\\partial \\boldsymbol{\\sigma}} = \\dfrac{3}{2}\\dfrac{\\mathbf{s}}{q} : \\left(\\mathbb{I}^{\\text{dev}}\\right)$, where $\\mathbb{I}^{\\text{dev}}$ is the fourth-order deviatoric projection tensor. Since $\\mathbf{s}$ is deviatoric, this simplifies to $\\dfrac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\dfrac{3}{2}\\dfrac{\\mathbf{s}}{q}$.\n\nCombining these terms, the flow direction is:\n$$ \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\beta \\left(-\\frac{1}{3}\\mathbf{I}\\right) + 1 \\left(\\frac{3}{2}\\frac{\\mathbf{s}}{q}\\right) = \\frac{3}{2}\\frac{\\mathbf{s}}{q} - \\frac{\\beta}{3}\\mathbf{I} $$\nThe pitfall occurs at or near hydrostatic states, i.e., when the deviatoric stress $\\mathbf{s} \\to \\mathbf{0}$, which implies the equivalent shear stress $q \\to 0$. In this limit, the deviatoric part of the flow direction, $\\dfrac{3}{2}\\dfrac{\\mathbf{s}}{q}$, becomes an indeterminate form of type $\\mathbf{0}/0$. This is a singularity at the apex of the Drucker-Prager cone in stress space. At this point, the plastic potential $g$ is not differentiable, and its gradient is not uniquely defined.\n\nA fully implicit backward-Euler scheme solved with a Newton-Raphson algorithm requires a continuously differentiable residual function to achieve its characteristic quadratic convergence. The singularity in $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ violates this requirement, leading to severe numerical difficulties, including failure to converge. The algorithmic consistent tangent operator, which is the linearization of the stress update, would also be singular.\n\nWe now evaluate the proposed options for circumventing this pitfall.\n\n**A. Replace $q$ everywhere in $F$ and $g$ by the smooth norm $q_{\\varepsilon}=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}+\\varepsilon^{2}}$, with $\\varepsilon0$ chosen as a small, dimensionally consistent fraction of a characteristic shear stress, and base $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ and the Jacobian on $q_{\\varepsilon}$; this yields bounded derivatives as $q\\to 0$ and maintains convexity of the invariant functions.**\n\nThis option proposes a regularization of the equivalent shear stress $q$ by introducing a smooth variant $q_{\\varepsilon} = \\sqrt{q^2 + \\varepsilon^2}$. Let's analyze the derivative of the smoothed plastic potential $g_{\\varepsilon} = q_{\\varepsilon} + \\beta p$. The critical term becomes:\n$$ \\frac{\\partial q_{\\varepsilon}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q_{\\varepsilon}}{\\partial \\mathbf{s}}:\\frac{\\partial \\mathbf{s}}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{2q_{\\varepsilon}} \\frac{\\partial(q^2+\\varepsilon^2)}{\\partial \\mathbf{s}}:\\frac{\\partial \\mathbf{s}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\frac{3}{2}\\mathbf{s}}{q_{\\varepsilon}} = \\frac{\\frac{3}{2}\\mathbf{s}}{\\sqrt{q^2+\\varepsilon^2}} $$\nAs $\\mathbf{s} \\to \\mathbf{0}$, we have $q \\to 0$, and the derivative becomes $\\lim_{\\mathbf{s}\\to\\mathbf{0}} \\dfrac{\\frac{3}{2}\\mathbf{s}}{\\sqrt{q^2+\\varepsilon^2}} = \\dfrac{\\mathbf{0}}{\\varepsilon} = \\mathbf{0}$. The derivative is now well-defined and bounded everywhere. This technique, known as apex smoothing, replaces the sharp apex of the cone with a smooth hyperbola. The function $q_{\\varepsilon}(\\mathbf{s})$ is convex and smooth (infinitely differentiable for $\\varepsilon > 0$), which ensures that the resulting functions $F_{\\varepsilon}$ and $g_{\\varepsilon}$ are also convex and smooth. Basing the Jacobian (the algorithmic tangent) on this smoothed formulation is the correct procedure for an implicit solver. This is a standard, robust, and theoretically sound method.\n**Verdict: Correct.**\n\n**B. Freeze the deviatoric direction to the start-of-step value by setting $\\mathbf{n}=\\mathbf{s}_{n}/q_{n}$, where the subscript $n$ denotes the previous converged state, and perform an explicit viscoplastic update using this fixed direction to avoid division by small $q$ at the current step.**\n\nThis approach attempts to fix the flow direction using information from the previous converged step, indexed by $n$. This fundamentally changes the algorithm from fully implicit to a mixed or explicit type for the flow direction. For a Newton-Raphson scheme aiming for quadratic convergence, all terms in the residual and the tangent operator must be evaluated at the current iterative state. Using a fixed direction from a previous state makes the algorithmic tangent inconsistent with the residual, destroying quadratic convergence and potentially leading to an inaccurate solution, especially for large increments where the stress state may rotate significantly. Furthermore, this method does not solve the problem if the previous state was already hydrostatic ($q_n = 0$).\n**Verdict: Incorrect.**\n\n**C. Redefine the deviatoric part of the plastic potential as $g_{\\mathrm{dev}}=\\tfrac{3}{4}\\,\\mathbf{s}:\\mathbf{s}$ so that $\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}=\\tfrac{3}{2}\\,\\mathbf{s}$, and keep $F(p,q)$ unchanged; this eliminates $\\dfrac{\\mathbf{s}}{q}$ in the flow direction without altering the yield function.**\n\nThis option proposes changing the plastic potential to $g_{\\text{new}} = \\tfrac{3}{4}\\mathbf{s}:\\mathbf{s} + \\beta p$. The gradient is then $\\dfrac{\\partial g_{\\text{new}}}{\\partial \\boldsymbol{\\sigma}} = \\dfrac{3}{2}\\mathbf{s} - \\dfrac{\\beta}{3}\\mathbf{I}$, which is well-defined at $\\mathbf{s}=\\mathbf{0}$. However, this is a fundamentally different constitutive model. The original potential $g=q+\\beta p$ leads to a deviatoric plastic strain rate whose magnitude is independent of $q$ (for a given $\\dot{\\lambda}$). The proposed potential $g_{\\text{new}}$ leads to a deviatoric plastic strain rate whose magnitude is proportional to $\\|\\mathbf{s}\\|$, which is proportional to $q$. This changes the predicted material behavior. The problem asks for a robust implementation of the *given* model, not to replace it with a different one. While using quadratic potentials is a valid modeling choice, it is not a faithful implementation of the specified Drucker-Prager model.\n**Verdict: Incorrect.**\n\n**D. Introduce a tolerance $\\varepsilon0$, clip $q$ to zero when $q\\varepsilon$, and set the deviatoric flow direction $\\mathbf{n}=\\mathbf{0}$ under this condition, proceeding with the original invariant formulas elsewhere.**\n\nThis is a conditional (\"if-then-else\") logic approach. While it avoids division by zero, it introduces a jump discontinuity in the definition of the flow direction at the boundary $q = \\varepsilon$. For $q \\ge \\varepsilon$, the deviatoric flow direction is $\\mathbf{n} \\propto \\mathbf{s}/q$, while for $q  \\varepsilon$, it is abruptly set to $\\mathbf{0}$. Such discontinuities are detrimental to a Newton-Raphson solver, which relies on the smoothness of the underlying functions. The algorithm will fail to converge quadratically and may oscillate or fail entirely when the stress state is near this artificial boundary. This is a fragile and mathematically unsound fix.\n**Verdict: Incorrect.**\n\n**E. Reformulate the EVP model with a smooth invariant norm (e.g., $q_{\\varepsilon}$) consistently in $F$ and $g$, and compute all required derivatives, including the algorithmic consistent tangent, by exact analytic expressions or by Automatic Differentiation (AD) to avoid hand-coded normalizations and ensure $C^{1}$ smoothness.**\n\nThis option describes a general and robust strategy. It builds upon the idea in option A. Key elements are:\n1.  Using a smooth norm (e.g., $q_{\\varepsilon}$) to regularize the apex.\n2.  Applying this regularization *consistently* to both the yield function $F$ and the plastic potential $g$, which preserves the model's structure.\n3.  Ensuring $C^1$ smoothness (continuous first derivative), which is essential for Newton's method.\n4.  Computing all required derivatives (for the residual and the algorithmic consistent tangent) *exactly*. This can be done by painstakingly deriving analytical expressions or, more robustly and less error-prone, by using Automatic Differentiation (AD).\nThis represents a comprehensive best-practice for implementing such models. It guarantees a robust, efficient, and accurate numerical solution by marrying a sound mathematical regularization with a powerful implementation technique for computing derivatives.\n**Verdict: Correct.**\n\nOptions A and E both describe correct and robust approaches. Option A details a specific, valid method. Option E describes the general, modern, and comprehensive strategy for implementing such methods correctly. Both are valid answers to the question.",
            "answer": "$$\\boxed{AE}$$"
        }
    ]
}