{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any robust finite element simulation involving plasticity is the accurate integration of the constitutive equations at the material point level. This exercise guides you through the implementation of a single-step update for a one-dimensional bounding surface model, a process often called a return mapping algorithm. By solving the nonlinear system of equations with Newton's method, you will gain hands-on experience with the core computational engine that drives advanced geotechnical simulations. ",
            "id": "3504621",
            "problem": "Implement a one-dimensional small-strain bounding surface plasticity update for a single time increment. Given a prescribed total strain increment $\\Delta\\varepsilon$, material parameters, and the previous state $\\left(\\boldsymbol{\\sigma}^{n},\\boldsymbol{\\varepsilon}^{p,n},\\kappa^{n},\\boldsymbol{\\alpha}^{n}\\right)$ specialized to one dimension as $\\left(\\sigma^{n},\\varepsilon^{p,n},\\kappa^{n},\\alpha^{n}\\right)$, compute the updated state $\\left(\\sigma^{n+1},\\varepsilon^{p,n+1},\\kappa^{n+1},\\alpha^{n+1}\\right)$ by solving a nonlinear system with Newton iteration and verify that the residual norm is below a specified tolerance. Assume all quantities are nondimensional, so no physical units are required.\n\nStart from the following fundamental base and widely accepted definitions:\n- Small-strain additive decomposition: $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$, where $\\varepsilon$ is the total strain, $\\varepsilon^{e}$ is the elastic strain, and $\\varepsilon^{p}$ is the plastic strain.\n- Linear elasticity in one dimension: $\\sigma = E \\,\\varepsilon^{e} = E \\left(\\varepsilon - \\varepsilon^{p}\\right)$, where $E$ is the Young’s modulus.\n- Kinematic hardening with linear rule: $d\\alpha = h_{k}\\, d\\varepsilon^{p}$, where $h_{k}$ is a material constant and $\\alpha$ is the backstress.\n- Isotropic hardening with linear rule on the bounding surface radius: $R(\\kappa) = \\sigma_{b0} + H_{\\mathrm{iso}}\\,\\kappa$, where $\\kappa$ is the accumulated plastic strain measure, $\\sigma_{b0}  0$ is the initial bounding radius, and $H_{\\mathrm{iso}} \\ge 0$ is the isotropic hardening modulus.\n- Effective stress with backstress (in one dimension): $s = \\sigma - \\alpha$ and the loading direction $n = \\mathrm{sign}(s_{\\mathrm{tr}})$ determined from the trial state $s_{\\mathrm{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon - \\alpha^{n}$. If $s_{\\mathrm{tr}} = 0$, take $n=+1$.\n\nBounding surface plasticity with radial mapping is represented as follows:\n- Let $y = |s|$ and $R = R(\\kappa)$. Define the distance ratio $\\rho = y/R$. A nonzero plastic strain increment can occur for interior states with $\\rho  1$, scaled by an exponent $m \\ge 0$. Introduce an elastic nucleus parameter $\\xi \\in [0,1)$: if $\\rho \\le \\xi$, the response is purely elastic ($\\Delta\\lambda = 0$).\n- The plastic flow is associated and directed by $n$, with $d\\varepsilon^{p} = d\\lambda\\, n$, $d\\alpha = h_{k}\\, d\\lambda\\, n$, and $d\\kappa = d\\lambda$, where $d\\lambda \\ge 0$ is the plastic multiplier increment.\n\nFor a single increment from step $n$ to $n+1$ with prescribed $\\Delta\\varepsilon$, solve implicitly for the unknowns $\\mathbf{x} = \\left[\\sigma^{n+1}, \\varepsilon^{p,n+1}, \\kappa^{n+1}, \\alpha^{n+1}, \\Delta\\lambda\\right]^{\\mathsf{T}}$ by enforcing the residual system $\\mathbf{r}(\\mathbf{x}) = \\mathbf{0}$:\n- Kinematics and elasticity:\n  - $r_{1} = \\sigma^{n+1} - \\sigma^{n} - E\\left(\\Delta\\varepsilon - \\left(\\varepsilon^{p,n+1} - \\varepsilon^{p,n}\\right)\\right)$,\n  - $r_{2} = \\varepsilon^{p,n+1} - \\varepsilon^{p,n} - \\Delta\\lambda\\, n$.\n- Hardening updates:\n  - $r_{3} = \\alpha^{n+1} - \\alpha^{n} - h_{k}\\,\\Delta\\lambda\\, n$,\n  - $r_{4} = \\kappa^{n+1} - \\kappa^{n} - \\Delta\\lambda$.\n- Bounding surface driving equation (active plasticity branch):\n  - Define $y = n\\left(\\sigma^{n+1} - \\alpha^{n+1}\\right)$, $R = \\sigma_{b0} + H_{\\mathrm{iso}}\\,\\kappa^{n+1}$, and $\\rho = \\min\\left(1, \\max\\left(\\rho_{\\min}, \\dfrac{y}{R}\\right)\\right)$ with a small $\\rho_{\\min}  0$ for numerical robustness. Then\n  - $r_{5} = E\\,n\\,\\Delta\\varepsilon - \\dfrac{\\left(E + h_{k} + H_{\\mathrm{iso}}\\right)}{\\rho^{m}}\\,\\Delta\\lambda$.\n- Elastic nucleus branch: if the trial ratio $\\rho_{\\mathrm{tr}} = \\dfrac{|s_{\\mathrm{tr}}|}{\\sigma_{b0} + H_{\\mathrm{iso}}\\,\\kappa^{n}} \\le \\xi$ or if $E\\,n\\,\\Delta\\varepsilon \\le 0$, enforce $\\Delta\\lambda = 0$ and update elastically:\n  - $\\sigma^{n+1} = \\sigma^{n} + E\\,\\Delta\\varepsilon$,\n  - $\\varepsilon^{p,n+1} = \\varepsilon^{p,n}$,\n  - $\\alpha^{n+1} = \\alpha^{n}$,\n  - $\\kappa^{n+1} = \\kappa^{n}$.\n\nFor the active plasticity branch, solve the nonlinear system with Newton’s method. At each iteration, assemble the residual vector $\\mathbf{r}$ and its Jacobian $\\mathbf{J}=\\dfrac{\\partial \\mathbf{r}}{\\partial \\mathbf{x}}$, and update $\\mathbf{x} \\leftarrow \\mathbf{x} + \\Delta \\mathbf{x}$ by solving $\\mathbf{J}\\,\\Delta \\mathbf{x} = -\\mathbf{r}$. Use the sign $n$ from the trial state and keep it fixed over the increment. Terminate when the Euclidean norm $\\|\\mathbf{r}\\|_{2}$ is less than the tolerance $\\tau$. If the algorithm detects the elastic nucleus branch, the residual verification should be performed on the corresponding equations ensuring exact satisfaction to within $\\tau$.\n\nYour task is to implement a complete, runnable program that:\n- Accepts no input and uses the fixed test suite below.\n- For each test case, performs a single time step update as specified, runs Newton’s method for the active plasticity branch (or the elastic update otherwise), and returns a boolean indicating whether the final residual norm is less than or equal to $\\tau$.\n- Aggregates the results from all test cases into a single line as a comma-separated list enclosed in square brackets.\n\nUse the following fixed parameter values and test suite. All quantities are nondimensional:\n- Material parameters (common to all tests): $E = 1000$, $h_{k} = 200$, $H_{\\mathrm{iso}} = 100$, $\\sigma_{b0} = 100$, $m = 2$, $\\xi = 0.6$, $\\rho_{\\min} = 10^{-6}$, $\\tau = 10^{-10}$, maximum Newton iterations $N_{\\max} = 50$.\n- Test cases, each given as $\\left(\\sigma^{n}, \\varepsilon^{p,n}, \\kappa^{n}, \\alpha^{n}, \\Delta\\varepsilon\\right)$:\n  1. $\\left(0, 0, 0, 0, 0.2\\right)$,\n  2. $\\left(0, 0, 0, 0, 0.05\\right)$,\n  3. $\\left(0, 0, 0, 0, 0.06\\right)$,\n  4. $\\left(60, 0.05, 0.08, 40, -0.25\\right)$.\n\nAngle measures do not appear in this problem. No physical units are used; all values are nondimensional.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result}_{1},\\mathrm{result}_{2},\\mathrm{result}_{3},\\mathrm{result}_{4}\\right]$). Each $\\mathrm{result}_{i}$ must be a boolean indicating whether the residual norm for test case $i$ is less than or equal to $\\tau$.",
            "solution": "The problem statement has been analyzed and is determined to be valid. It presents a well-defined, self-contained numerical implementation task based on established principles of computational plasticity, specifically the bounding surface model. All necessary equations, parameters, and test cases are provided. The task is to implement the specified algorithm and report on its convergence for a set of fixed inputs.\n\nThe core of the problem is to compute the updated state $(\\sigma^{n+1}, \\varepsilon^{p,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$ for a single time step given the previous state $(\\sigma^{n}, \\varepsilon^{p,n}, \\kappa^{n}, \\alpha^{n})$ and a total strain increment $\\Delta\\varepsilon$. The algorithm proceeds via an explicit trial step followed by a corrector step, which can be either elastic or plastic.\n\nFirst, an elastic trial state is computed. This state assumes the entire strain increment $\\Delta\\varepsilon$ is purely elastic.\nThe trial stress is $\\sigma_{\\mathrm{tr}} = \\sigma^{n} + E \\Delta\\varepsilon$.\nThe trial effective stress is $s_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\alpha^{n}$.\nThe loading direction for the increment is fixed based on this trial state: $n = \\mathrm{sign}(s_{\\mathrm{tr}})$. If $s_{\\mathrm{tr}}=0$, $n$ is taken as $+1$.\nThe trial bounding surface radius is $R^{n} = \\sigma_{b0} + H_{\\mathrm{iso}}\\kappa^{n}$.\nA trial distance ratio is computed as $\\rho_{\\mathrm{tr}} = \\dfrac{|s_{\\mathrm{tr}}|}{R^{n}}$.\n\nBased on this trial state, a decision is made whether the material response is purely elastic or involves plasticity.\nThe response is purely elastic if $\\rho_{\\mathrm{tr}} \\le \\xi$ (the state is within the elastic nucleus) or if $E\\,n\\,\\Delta\\varepsilon \\le 0$ (unloading or neutral loading).\nIn the elastic case, the update is straightforward:\n$\\sigma^{n+1} = \\sigma_{\\mathrm{tr}}$\n$\\varepsilon^{p,n+1} = \\varepsilon^{p,n}$\n$\\kappa^{n+1} = \\kappa^{n}$\n$\\alpha^{n+1} = \\alpha^{n}$\nThe plastic multiplier increment is zero, $\\Delta\\lambda = 0$. The residual for a system of equations defining this elastic update is trivially zero, thus satisfying the convergence tolerance $\\tau$.\n\nIf the conditions for an elastic update are not met, an active plasticity step is taken. This requires solving a system of five nonlinear equations for the five unknowns $\\mathbf{x} = [\\sigma^{n+1}, \\varepsilon^{p,n+1}, \\kappa^{n+1}, \\alpha^{n+1}, \\Delta\\lambda]^{\\mathsf{T}}$. The problem specifies using Newton's method to solve for the root of the residual vector $\\mathbf{r}(\\mathbf{x}) = \\mathbf{0}$. The components of the residual vector are:\n$r_{1} = \\sigma^{n+1} - \\sigma^{n} - E\\left(\\Delta\\varepsilon - (\\varepsilon^{p,n+1} - \\varepsilon^{p,n})\\right)$\n$r_{2} = \\varepsilon^{p,n+1} - \\varepsilon^{p,n} - \\Delta\\lambda\\, n$\n$r_{3} = \\alpha^{n+1} - \\alpha^{n} - h_{k}\\,\\Delta\\lambda\\, n$\n$r_{4} = \\kappa^{n+1} - \\kappa^{n} - \\Delta\\lambda$\n$r_{5} = E\\,n\\,\\Delta\\varepsilon - \\dfrac{K_{\\mathrm{sum}}}{\\rho^{m}}\\,\\Delta\\lambda$, where $K_{\\mathrm{sum}} = E + h_{k} + H_{\\mathrm{iso}}$.\n\nThe term $\\rho$ in $r_5$ is defined as $\\rho = \\min\\left(1, \\max\\left(\\rho_{\\min}, \\dfrac{y}{R}\\right)\\right)$, with $y = n\\left(\\sigma^{n+1} - \\alpha^{n+1}\\right)$ and $R = \\sigma_{b0} + H_{\\mathrm{iso}}\\kappa^{n+1}$.\n\nNewton's method starts with an initial guess, for which the elastic predictor is a natural choice: $\\mathbf{x}^{(0)} = [\\sigma_{\\mathrm{tr}}, \\varepsilon^{p,n}, \\kappa^{n}, \\alpha^{n}, 0]^{\\mathsf{T}}$.\nAt each iteration $k$, the Newton update $\\Delta \\mathbf{x}^{(k)}$ is found by solving the linear system $\\mathbf{J}(\\mathbf{x}^{(k)}) \\Delta\\mathbf{x}^{(k)} = -\\mathbf{r}(\\mathbf{x}^{(k)})$, where $\\mathbf{J}$ is the Jacobian matrix $\\mathbf{J} = \\dfrac{\\partial\\mathbf{r}}{\\partial\\mathbf{x}}$. The solution is then updated: $\\mathbf{x}^{(k+1)} = \\mathbf{x}^{(k)} + \\Delta\\mathbf{x}^{(k)}$. Iterations continue until the Euclidean norm of the residual $\\|\\mathbf{r}\\|_{2}$ is below the tolerance $\\tau$ or the maximum number of iterations $N_{\\max}$ is reached.\n\nThe Jacobian matrix $\\mathbf{J}$ is a $5 \\times 5$ matrix whose entries are the partial derivatives of the residual components with respect to the unknowns $x_1=\\sigma^{n+1}, x_2=\\varepsilon^{p,n+1}, x_3=\\kappa^{n+1}, x_4=\\alpha^{n+1}, x_5=\\Delta\\lambda$.\nThe first four rows are sparse and contain many constants:\n$\\dfrac{\\partial r_1}{\\partial x_1} = 1$, $\\dfrac{\\partial r_1}{\\partial x_2} = E$\n$\\dfrac{\\partial r_2}{\\partial x_2} = 1$, $\\dfrac{\\partial r_2}{\\partial x_5} = -n$\n$\\dfrac{\\partial r_3}{\\partial x_4} = 1$, $\\dfrac{\\partial r_3}{\\partial x_5} = -h_k n$\n$\\dfrac{\\partial r_4}{\\partial x_3} = 1$, $\\dfrac{\\partial r_4}{\\partial x_5} = -1$\nAll other derivatives in the first four rows are zero.\n\nThe fifth row, $\\dfrac{\\partial r_5}{\\partial x_j}$, is more complex due to the dependence of $\\rho$ on $x_1, x_3, x_4$. Let $u = y/R$. The derivative of $\\rho$ is non-zero only if $\\rho_{\\min}  u  1$.\n$\\dfrac{\\partial r_5}{\\partial x_1} = -K_{\\mathrm{sum}} x_5 \\dfrac{\\partial(\\rho^{-m})}{\\partial x_1} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{\\partial\\rho}{\\partial x_1} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{n}{R}$\n$\\dfrac{\\partial r_5}{\\partial x_3} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{\\partial\\rho}{\\partial x_3} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\left(-\\dfrac{y H_{\\mathrm{iso}}}{R^2}\\right) = -m K_{\\mathrm{sum}} x_5 \\rho^{-m} \\dfrac{H_{\\mathrm{iso}}}{R}$\n$\\dfrac{\\partial r_5}{\\partial x_4} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{\\partial\\rho}{\\partial x_4} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\left(-\\dfrac{n}{R}\\right)$\n$\\dfrac{\\partial r_5}{\\partial x_5} = -\\dfrac{K_{\\mathrm{sum}}}{\\rho^m}$\nIf $u \\leq \\rho_{\\min}$ or $u \\geq 1$, then $\\dfrac{\\partial\\rho}{\\partial x_j}=0$ for $j \\in \\{1,3,4\\}$, which simplifies the Jacobian calculation for those components. A critical observation for the first iteration is that since $x_5 = \\Delta\\lambda=0$, the derivatives $\\frac{\\partial r_5}{\\partial x_j}$ for $j=1,3,4$ are zero, simplifying the initial Jacobian.\n\nThe final output for each test case is a boolean, indicating whether the final residual norm satisfies $\\|\\mathbf{r}\\|_{2} \\le \\tau$. This will be true for the elastic cases and for plastic cases where Newton's method converges successfully. If the method fails to converge within $N_{\\max}$ iterations, the final residual norm will likely be greater than $\\tau$, yielding a false result.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the bounding surface plasticity simulation for all test cases.\n    \"\"\"\n    # Material and numerical parameters\n    E = 1000.0\n    h_k = 200.0\n    H_iso = 100.0\n    sig_b0 = 100.0\n    m = 2.0\n    xi = 0.6\n    rho_min = 1e-6\n    tau = 1e-10\n    N_max = 50\n\n    params = {\n        'E': E, 'h_k': h_k, 'H_iso': H_iso, 'sig_b0': sig_b0,\n        'm': m, 'xi': xi, 'rho_min': rho_min, 'tau': tau, 'N_max': N_max\n    }\n\n    # Test cases: (sigma_n, eps_p_n, kappa_n, alpha_n, d_eps)\n    test_cases = [\n        (0.0, 0.0, 0.0, 0.0, 0.2),\n        (0.0, 0.0, 0.0, 0.0, 0.05),\n        (0.0, 0.0, 0.0, 0.0, 0.06),\n        (60.0, 0.05, 0.08, 40.0, -0.25),\n    ]\n\n    results = []\n    for case in test_cases:\n        converged = perform_update(case, params)\n        results.append(str(converged).lower())\n    \n    print(f\"[{','.join(results)}]\")\n\ndef perform_update(case, params):\n    \"\"\"\n    Performs a single time step update for a given test case.\n    \"\"\"\n    sigma_n, eps_p_n, kappa_n, alpha_n, d_eps = case\n    E, h_k, H_iso, sig_b0, m, xi, rho_min, tau, N_max = \\\n        params['E'], params['h_k'], params['H_iso'], params['sig_b0'], \\\n        params['m'], params['xi'], params['rho_min'], params['tau'], params['N_max']\n\n    # Trial state\n    sigma_tr = sigma_n + E * d_eps\n    s_tr = sigma_tr - alpha_n\n    n = np.sign(s_tr) if s_tr != 0 else 1.0\n    R_n = sig_b0 + H_iso * kappa_n\n    \n    rho_tr = np.abs(s_tr) / R_n if R_n != 0 else float('inf')\n\n    # Branching logic: check for elastic update\n    if rho_tr = xi or E * n * d_eps = 0:\n        # Perform elastic update\n        sigma_n1 = sigma_tr\n        eps_p_n1 = eps_p_n\n        kappa_n1 = kappa_n\n        alpha_n1 = alpha_n\n        d_lambda = 0.0\n\n        # For the elastic case, the residual of the defining equations is zero.\n        # r_el = [sigma_n1 - (sigma_n + E*d_eps), eps_p_n1 - eps_p_n, ...]\n        # norm(r_el) is 0, which is = tau.\n        return True\n    else:\n        # Perform plastic update using Newton's method\n        \n        # Initial guess for unknowns x = [sigma, eps_p, kappa, alpha, d_lambda]\n        x = np.array([sigma_tr, eps_p_n, kappa_n, alpha_n, 0.0])\n        \n        K_sum = E + h_k + H_iso\n\n        for _ in range(N_max):\n            sigma_n1, eps_p_n1, kappa_n1, alpha_n1, d_lambda = x\n\n            # Calculate residual vector r\n            r = np.zeros(5)\n            r[0] = sigma_n1 - sigma_n - E * (d_eps - (eps_p_n1 - eps_p_n))\n            r[1] = eps_p_n1 - eps_p_n - d_lambda * n\n            r[2] = alpha_n1 - alpha_n - h_k * d_lambda * n\n            r[3] = kappa_n1 - kappa_n - d_lambda\n\n            y = n * (sigma_n1 - alpha_n1)\n            R = sig_b0 + H_iso * kappa_n1\n            u = y / R if R != 0 else float('inf')\n            rho = min(1.0, max(rho_min, u))\n            rho_m = rho ** m\n            \n            if rho_m == 0: rho_m = 1e-12 # Avoid division by zero\n            \n            r[4] = E * n * d_eps - (K_sum / rho_m) * d_lambda\n\n            # Check for convergence\n            res_norm = np.linalg.norm(r)\n            if res_norm = tau:\n                return True\n\n            # Calculate Jacobian matrix J\n            J = np.zeros((5, 5))\n            J[0, 0] = 1.0; J[0, 1] = E\n            J[1, 1] = 1.0; J[1, 4] = -n\n            J[2, 3] = 1.0; J[2, 4] = -h_k * n\n            J[3, 2] = 1.0; J[3, 4] = -1.0\n            \n            # Derivatives for the 5th residual component\n            d_rho_d_sig = 0.0\n            d_rho_d_kap = 0.0\n            d_rho_d_alf = 0.0\n\n            if rho_min  u  1.0:\n                d_rho_d_sig = n / R\n                d_rho_d_kap = -y * H_iso / (R**2)\n                d_rho_d_alf = -n / R\n            \n            J[4, 0] = m * K_sum * d_lambda * (rho ** (-m - 1)) * d_rho_d_sig\n            J[4, 2] = m * K_sum * d_lambda * (rho ** (-m - 1)) * d_rho_d_kap\n            J[4, 3] = m * K_sum * d_lambda * (rho ** (-m - 1)) * d_rho_d_alf\n            J[4, 4] = -K_sum / rho_m\n            \n            # Solve for update and update unknowns\n            try:\n                delta_x = np.linalg.solve(J, -r)\n            except np.linalg.LinAlgError:\n                # Jacobian is singular, convergence fails\n                return False\n            x += delta_x\n\n        # If loop finishes, check final residual norm\n        final_res_norm = np.linalg.norm(r)\n        return final_res_norm = tau\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Before a numerical model can be trusted for complex simulations, it must be rigorously verified against cases with known solutions. This practice introduces the concept of a \"patch test,\" a crucial technique for code validation in computational mechanics. You will derive a closed-form analytical solution for plastic strain in a simplified uniaxial bounding surface model, providing an exact benchmark to verify the correctness of a numerical implementation. ",
            "id": "3504645",
            "problem": "A uniaxial material model for soils under cyclic loading is implemented using a bounding surface plasticity framework. Consider the following scientifically consistent patch test intended to admit analytical solutions suitable for code verification.\n\nAssumptions and definitions:\n- The uniaxial stress is denoted by $\\sigma$, and the total strain by $\\varepsilon$. The elastic modulus is $E0$, and the additive decomposition $\\mathrm{d}\\varepsilon=\\mathrm{d}\\varepsilon^{e}+\\mathrm{d}\\varepsilon^{p}$ holds with $\\mathrm{d}\\sigma=E\\,\\mathrm{d}\\varepsilon^{e}$.\n- The bounding surface in stress space is the interval defined by $\\lvert \\sigma \\rvert = R$ with constant radius $R0$ and no kinematic hardening (the center is at $\\sigma=0$).\n- Plastic flow is associative with isotropic hardening described at the bounding image point, and the consistency condition is enforced at the bounding image.\n- The radial mapping rule defines the distance ratio $r=\\lvert \\sigma \\rvert / R \\in [0,1)$.\n- The effective isotropic plastic modulus inside the bounding surface is prescribed as a function of $r$ by $H(r)=H_{b}\\,r^{-q}$, where $H_{b}0$ and $q0$ are material parameters. This choice ensures $H(r)\\to \\infty$ as $r\\to 0$ (recovering elasticity at the center) and $H(r)\\to H_{b}$ as $r\\to 1^{-}$ (approaching the classical plastic modulus at the boundary).\n- The loading is uniaxial, stress-controlled, and cyclic: $\\sigma(t)=\\sigma_{a}\\sin(\\omega t)$ with amplitude $\\sigma_{a}$ satisfying $0\\sigma_{a}R$ and angular frequency $\\omega0$, so the entire cycle remains strictly within the bounding surface.\n\nTask:\nStarting only from the above assumptions and standard elastoplastic principles (additive decomposition, associative flow, and consistency at the bounding image), derive an analytical expression for the plastic strain at the positive peak stress $\\sigma=\\sigma_{a}$ reached during the first quarter cycle. Treat the loading from $\\sigma=0$ monotonically up to $\\sigma=\\sigma_{a}$ and provide $\\varepsilon^{p}(\\sigma_{a})$ as a closed-form symbolic expression in terms of $E$, $H_{b}$, $R$, $q$, and $\\sigma_{a}$. You may use the fact that, for this uniaxial case with the stated mapping and isotropic hardening, the sign of the plastic flow remains aligned with the sign of $\\sigma$ during monotonic segments.\n\nAnswer specification:\n- Provide a single closed-form analytic expression for $\\varepsilon^{p}(\\sigma_{a})$.\n- Do not include units in the final boxed answer.\n- No numerical rounding is required; provide the exact expression.",
            "solution": "We proceed from standard elastoplasticity and the stated bounding surface model. The additive decomposition is $\\mathrm{d}\\varepsilon=\\mathrm{d}\\varepsilon^{e}+\\mathrm{d}\\varepsilon^{p}$ with linear elasticity $\\mathrm{d}\\sigma=E\\,\\mathrm{d}\\varepsilon^{e}$. Hence,\n$$\n\\mathrm{d}\\sigma \\;=\\; E\\left(\\mathrm{d}\\varepsilon-\\mathrm{d}\\varepsilon^{p}\\right).\n$$\nThe uniaxial associative flow rule is\n$$\n\\mathrm{d}\\varepsilon^{p} \\;=\\; \\mathrm{d}\\lambda \\,\\frac{\\partial g}{\\partial \\sigma},\n$$\nwhere, for the uniaxial case with a centered bounding surface and associative flow, $\\partial g/\\partial \\sigma=\\operatorname{sign}(\\sigma)$ during plastic loading. The isotropic hardening is described at the bounding image point via the consistency condition. Let the bounding yield function be $f_{b}=\\lvert \\sigma_{b} \\rvert - R = 0$, where $\\sigma_{b}$ is the image of $\\sigma$ on the bounding surface obtained by radial mapping. In one dimension, the normal to the surface is $\\partial f_{b}/\\partial \\sigma_{b}=\\operatorname{sign}(\\sigma_{b})$, and the consistency condition gives\n$$\n\\mathrm{d}f_{b} \\;=\\; \\operatorname{sign}(\\sigma_{b})\\,\\mathrm{d}\\sigma_{b} \\;-\\; \\mathrm{d}R \\;=\\; 0.\n$$\nUnder the adopted isotropic hardening, $\\mathrm{d}R = H(r)\\,\\mathrm{d}\\lambda$, where $H(r)$ is the plastic modulus evaluated inside the bounding surface and $r=\\lvert \\sigma \\rvert/R$. For uniaxial loading with radial mapping and no kinematic shift, the sign at the image coincides with the sign of the current stress during a monotonic segment, and the projected increment direction remains colinear with $\\sigma$. In the present patch test, we collect these standard one-dimensional consequences into the uniaxial consistency statement\n$$\n\\operatorname{sign}(\\sigma)\\,\\mathrm{d}\\sigma \\;-\\; H(r)\\,\\mathrm{d}\\lambda \\;=\\; 0,\n$$\nwhich, together with the associative flow in one dimension $\\mathrm{d}\\varepsilon^{p}=\\mathrm{d}\\lambda\\,\\operatorname{sign}(\\sigma)$, yields the fundamental uniaxial relation\n$$\n\\mathrm{d}\\varepsilon^{p} \\;=\\; \\frac{\\mathrm{d}\\sigma}{H(r)}.\n$$\nThis formula embodies the dependence of the plastic increment on the distance ratio $r$ through $H(r)$. Next, we specialize to the given $H(r)=H_{b} r^{-q}$ with $q0$. Using the mapping rule $r=\\lvert \\sigma \\rvert / R$, we have\n$$\nH(r) \\;=\\; H_{b}\\left(\\frac{\\lvert \\sigma \\rvert}{R}\\right)^{-q} \\;=\\; H_{b}\\left(\\frac{R}{\\lvert \\sigma \\rvert}\\right)^{q}.\n$$\nDuring the monotonic loading segment from $\\sigma=0$ to $\\sigma=\\sigma_{a}0$, the stress is nonnegative, so $\\lvert \\sigma \\rvert=\\sigma$. Therefore,\n$$\nH(r(\\sigma)) \\;=\\; H_{b}\\left(\\frac{R}{\\sigma}\\right)^{q}, \\quad \\sigma\\in[0,\\sigma_{a}],\n$$\nand the plastic strain increment becomes\n$$\n\\mathrm{d}\\varepsilon^{p} \\;=\\; \\frac{\\mathrm{d}\\sigma}{H_{b}\\left(\\frac{R}{\\sigma}\\right)^{q}} \\;=\\; \\frac{\\sigma^{q}}{H_{b} R^{q}}\\,\\mathrm{d}\\sigma.\n$$\nIntegrating from $\\sigma=0$ (where $\\varepsilon^{p}(0)=0$ by symmetry and the infinite plastic modulus at the center) to $\\sigma=\\sigma_{a}$ yields the plastic strain at the peak stress,\n$$\n\\varepsilon^{p}(\\sigma_{a}) \\;=\\; \\int_{0}^{\\sigma_{a}} \\frac{\\sigma^{q}}{H_{b} R^{q}}\\,\\mathrm{d}\\sigma \n\\;=\\; \\frac{1}{H_{b} R^{q}}\\,\\frac{\\sigma_{a}^{q+1}}{q+1}.\n$$\nThus,\n$$\n\\varepsilon^{p}(\\sigma_{a}) \\;=\\; \\frac{\\sigma_{a}^{q+1}}{(q+1)\\,H_{b}\\,R^{q}}.\n$$\nThis closed-form result depends only on $\\sigma_{a}$, $H_{b}$, $R$, and $q$. Note that the elastic modulus $E$ does not appear in $\\varepsilon^{p}(\\sigma_{a})$ because the plastic increment relation $\\mathrm{d}\\varepsilon^{p}=\\mathrm{d}\\sigma/H(r)$ is governed by the consistency condition and the hardening law; $E$ enters the total strain through $\\varepsilon=\\sigma/E+\\varepsilon^{p}$ but not the isolated plastic component for this uniaxial patch test. This expression provides a direct analytic target for verifying an implementation: integrating the code’s incremental plastic strain along the monotonic branch to $\\sigma_{a}$ must reproduce $\\sigma_{a}^{q+1}/\\big((q+1)H_{b}R^{q}\\big)$ to machine precision for sufficiently small step size.",
            "answer": "$$\\boxed{\\frac{\\sigma_{a}^{q+1}}{(q+1)\\,H_{b}\\,R^{q}}}$$"
        },
        {
            "introduction": "With a verified numerical model, we can now investigate the complex behaviors that bounding surface plasticity is designed to capture. This practice shifts focus to application, simulating the response of a soil element to many cycles of loading in the mean effective stress ($p$) and deviatoric stress ($q$) space. You will implement a cyclic simulation to distinguish between ratcheting—the progressive accumulation of plastic strain—and shakedown, where the material response eventually becomes purely elastic, key phenomena in predicting long-term soil performance. ",
            "id": "3504574",
            "problem": "Consider a small-strain triaxial setting in which stress increments are described by the invariants mean effective stress $p$ and deviatoric stress $q$. Let the total strain increment decompose additively into elastic and plastic parts, so that $d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$. Under triaxial conditions the elastic increments of the mean and deviatoric strains obey $dp = K\\,d\\varepsilon_{v}^{e}$ and $dq = 3G\\,d\\varepsilon_{q}^{e}$, where $K$ is the bulk modulus and $G$ is the shear modulus. Assume small-strain, rate-independent elastoplastic behavior with a bounding-surface concept in the stress-ratio space defined by $\\eta = q/p$.\n\nLet the bounding surface be specified by $|\\eta| = M$, with $M  0$ given. Define a radial mapping rule with center at $\\eta = 0$: for a current stress ratio $\\eta$, define the distance ratio $r = \\min\\{\\max(|\\eta|/M,\\epsilon_r), 1 - \\epsilon_r\\}$, where $\\epsilon_r$ is a small positive number to avoid singularities. Introduce a plastic modulus $H(r)$ that scales with the distance ratio according to\n$$\nH(r) = H_0\\,\\left(\\frac{1 - r}{r}\\right)^{a},\n$$\nwhere $H_0  0$ and $a  0$ are model parameters. The isotropic hardening of the reference plastic modulus is taken to evolve with the cumulative (accumulated) deviatoric plastic strain $\\kappa$ as\n$$\nH_0 = H_{00}\\,\\left(1 + c_h\\,\\kappa\\right),\n$$\nwhere $H_{00}  0$ and $c_h \\ge 0$ are constants, and $d\\kappa = |d\\varepsilon_q^{p}|$ with $\\kappa(0) = 0$.\n\nAssume plastic flow is activated only when the loading index is positive, where the loading index is defined by the scalar product between the outward unit normal to the radial mapping direction and the stress increment. In the present one-dimensional invariant form, this reduces to a condition based on the sign of $q$ and the increment $dq$: let the loading index be $\\ell = \\mathrm{sign}(q)\\,dq$, and impose plastic flow only if $\\ell  0$ (outward radial movement toward the bounding surface). Otherwise, the increment is elastic. Take the plastic flow direction associated with the deviatoric stress $q$ and neglect plastic volumetric strains in this simplified setting.\n\nDerive, from the standard elastoplastic consistency framework, a one-dimensional algorithmic relation for the deviatoric plastic strain increment $d\\varepsilon_q^{p}$ under a small stress increment $dq$ at fixed $p$, in terms of the elastic compliance in the $q$-direction and the plastic modulus $H(r)$. You must start from the elastic relation $d\\varepsilon_q^{e} = dq/(3G)$ and the assumption that the plastic strain increment is colinear with the loading direction under positive loading index. Use the general elastoplastic structure in which the plastic consistency condition yields a partitioning of the total increment between elastic and plastic parts. Show that for positive loading index,\n$$\nd\\varepsilon_q^{p} \\;=\\; \\frac{1}{1 + 3G\\,H(r)}\\,\\frac{dq}{3G},\n$$\nand $d\\varepsilon_q^{p} = 0$ otherwise, with $\\kappa$ updated by $d\\kappa = |d\\varepsilon_q^{p}|$ and $H_0$ updated accordingly.\n\nYou are given a prescribed cyclic stress trajectory specified in continuous time $t \\in [0, T]$ by\n$$\np(t) = p_0, \\qquad q(t) = q_{\\mathrm{mean}} + q_{\\mathrm{amp}} \\,\\sin\\!\\left(2\\pi \\frac{t}{T}\\right),\n$$\nwhere $p_0  0$ is constant, $q_{\\mathrm{mean}}$ is the mean deviatoric stress, $q_{\\mathrm{amp}} \\ge 0$ is the amplitude, and $T  0$ is the period. All stresses are expressed in kilopascals (kPa). Strains are dimensionless. Consider a discrete time-stepping approximation over $N_{\\mathrm{cyc}}$ cycles, each cycle discretized into $N_t$ equal steps, and update the state variables sequentially within each time step.\n\nDefinitions of required outputs per test case:\n- At the end of each cycle $i$, define the net (ratchet) plastic deviatoric strain increment over that cycle by $\\Delta\\varepsilon_{q,i}^{p} = \\varepsilon_q^{p}(t_i^{\\mathrm{end}}) - \\varepsilon_q^{p}(t_i^{\\mathrm{start}})$.\n- Define the reported cumulative plastic strain per cycle as the average net increment over the last $N_{\\mathrm{avg}}$ cycles:\n$$\n\\overline{\\Delta\\varepsilon_q^{p}} \\;=\\; \\frac{1}{N_{\\mathrm{avg}}} \\sum_{i = N_{\\mathrm{cyc}} - N_{\\mathrm{avg}} + 1}^{N_{\\mathrm{cyc}}} \\Delta\\varepsilon_{q,i}^{p}.\n$$\n- Determine whether the response is ratcheting or shakedown based on the absolute value of the last cycle’s net increment. Specifically, classify as ratcheting if $|\\Delta\\varepsilon_{q,N_{\\mathrm{cyc}}}^{p}|  \\varepsilon_{\\mathrm{tol}}$ and classify as shakedown otherwise, where $\\varepsilon_{\\mathrm{tol}}$ is a prescribed small positive threshold.\n\nYour program must implement the above model and produce the two outputs per test case:\n- The float $\\overline{\\Delta\\varepsilon_q^{p}}$ rounded to eight decimal places (dimensionless).\n- The boolean for ratcheting classification, where a boolean of $\\mathtt{True}$ indicates ratcheting and $\\mathtt{False}$ indicates shakedown.\n\nUse the following fixed numerical discretization and classification parameters in all test cases:\n- Number of cycles $N_{\\mathrm{cyc}} = 40$.\n- Time steps per cycle $N_t = 800$.\n- Averaging window $N_{\\mathrm{avg}} = 3$.\n- Regularization for the distance ratio $\\epsilon_r = 10^{-6}$.\n- Ratcheting threshold $\\varepsilon_{\\mathrm{tol}} = 10^{-7}$.\n- Period $T = 1$ (arbitrary time unit; only the ordering of steps matters).\n\nStresses must be in kilopascals (kPa). Strains are dimensionless. No angles are involved.\n\nTest suite. Implement your program for the following four test cases, each specified as an ordered tuple $(p_0, G, M, H_{00}, a, c_h, q_{\\mathrm{mean}}, q_{\\mathrm{amp}})$ with units where applicable:\n- Case A (symmetric cycling, moderate amplitude, expected shakedown): $(100, 30000, 1.2, 50, 1.2, 150, 0, 40)$.\n- Case B (biased mean, moderate amplitude, expected shakedown): $(100, 30000, 1.2, 50, 1.2, 150, 20, 40)$.\n- Case C (biased mean, large amplitude near bounding surface, expected ratcheting): $(100, 30000, 1.2, 50, 1.2, 150, 60, 60)$.\n- Case D (symmetric cycling, large amplitude close to bounding surface, expected shakedown due to symmetry of outward segments): $(100, 30000, 1.2, 50, 1.2, 150, 0, 110)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list of the form $[\\overline{\\Delta\\varepsilon_q^{p}}, \\mathrm{is\\_ratcheting}]$. For example, an output with two cases would look like $[[0.00012345,True],[0.0,False]]$. Your program must implement the full time-stepping update of the bounding-surface plasticity scheme described above and apply it to all four test cases in the test suite.",
            "solution": "The user has provided a problem in computational geomechanics concerning a simplified bounding-surface plasticity model for cyclic loading. I will first validate the problem statement according to the specified criteria.\n\n### Step 1: Extract Givens\n\n- **Constitutive Relations:**\n  - Total strain increment decomposition: $d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$.\n  - Elastic relations for stress invariants $(p, q)$: $dp = K\\,d\\varepsilon_{v}^{e}$ and $dq = 3G\\,d\\varepsilon_{q}^{e}$.\n  - Plastic flow rule: Plastic volumetric strain is neglected ($d\\varepsilon_v^{p} = 0$). Plastic deviatoric strain occurs for positive loading index.\n\n- **Bounding-Surface Model:**\n  - Stress ratio: $\\eta = q/p$.\n  - Bounding surface: $|\\eta| = M$, with $M  0$.\n  - Radial mapping from origin $\\eta=0$.\n  - Distance ratio: $r = \\min\\{\\max(|\\eta|/M, \\epsilon_r), 1 - \\epsilon_r\\}$, with regularization $\\epsilon_r$.\n  - Plastic modulus parameter: $H(r) = H_0\\,\\left(\\frac{1 - r}{r}\\right)^{a}$, with $H_0  0, a  0$.\n  - Isotropic hardening of $H_0$: $H_0 = H_{00}\\,\\left(1 + c_h\\,\\kappa\\right)$, with $H_{00}  0, c_h \\ge 0$.\n  - Accumulated plastic strain: $d\\kappa = |d\\varepsilon_q^{p}|$, with $\\kappa(0) = 0$.\n\n- **Loading Condition:**\n  - Loading index: $\\ell = \\mathrm{sign}(q)\\,dq$.\n  - Plastic flow condition: $\\ell  0$. Otherwise, the response is elastic.\n\n- **Required Derivation:**\n  - Show that for $\\ell  0$, $d\\varepsilon_q^{p} \\;=\\; \\frac{1}{1 + 3G\\,H(r)}\\,\\frac{dq}{3G}$, and $d\\varepsilon_q^{p} = 0$ otherwise.\n\n- **Loading Path and Discretization:**\n  - Stress path: $p(t) = p_0$ (constant), $q(t) = q_{\\mathrm{mean}} + q_{\\mathrm{amp}} \\,\\sin\\!\\left(2\\pi \\frac{t}{T}\\right)$.\n  - Numerical parameters: $N_{\\mathrm{cyc}} = 40$ cycles, $N_t = 800$ steps/cycle, $T=1$.\n\n- **Output Definitions:**\n  - Net plastic strain per cycle $i$: $\\Delta\\varepsilon_{q,i}^{p} = \\varepsilon_q^{p}(t_i^{\\mathrm{end}}) - \\varepsilon_q^{p}(t_i^{\\mathrm{start}})$.\n  - Reported average net strain: $\\overline{\\Delta\\varepsilon_q^{p}} = \\frac{1}{N_{\\mathrm{avg}}} \\sum_{i = N_{\\mathrm{cyc}} - N_{\\mathrm{avg}} + 1}^{N_{\\mathrm{cyc}}} \\Delta\\varepsilon_{q,i}^{p}$, with $N_{\\mathrm{avg}}=3$.\n  - Ratcheting criterion: Classified as ratcheting if $|\\Delta\\varepsilon_{q,N_{\\mathrm{cyc}}}^{p}|  \\varepsilon_{\\mathrm{tol}}$, with $\\varepsilon_{\\mathrm{tol}} = 10^{-7}$.\n\n- **Constants:** $\\epsilon_r = 10^{-6}$.\n\n- **Test Cases:** Four sets of parameters $(p_0, G, M, H_{00}, a, c_h, q_{\\mathrm{mean}}, q_{\\mathrm{amp}})$.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientific Grounding:** The problem describes a simplified, yet standard, bounding-surface plasticity model. This class of models is well-established in computational soil and rock mechanics for capturing nonlinear behavior under cyclic loading, such as stiffness degradation and accumulation of plastic strains. The additive strain decomposition, elastic laws, and concepts of a plastic modulus and hardening are fundamental to plasticity theory. The specific functional forms for $H(r)$ and $H_0(\\kappa)$ are phenomenological but consistent with the modeling paradigm. The problem is scientifically sound.\n\n2.  **Well-Posedness and Completeness:** The problem provides all necessary constitutive equations, model parameters, initial conditions ($\\kappa(0)=0$ and implicitly $\\varepsilon_q^p(0)=0$), loading path, and numerical parameters. The definitions for the required outputs are precise. The use of $\\epsilon_r$ avoids singularities in the plastic modulus calculation, ensuring the numerical algorithm is well-behaved. The problem is well-posed and self-contained.\n\n3.  **Objectivity:** The problem is stated in precise mathematical and engineering terms, free from subjective or ambiguous language.\n\n4.  **Other Flaws:** The problem does not violate any other validation criteria. The parameter values are physically plausible for geotechnical materials. The logic is consistent.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be provided.\n\n### Solution\n\nThe solution consists of two parts: first, the derivation of the expression for the plastic strain increment, and second, the description of the numerical algorithm to simulate the cyclic response and compute the required outputs.\n\n#### Derivation of the Plastic Strain Increment\n\nThe problem requests the derivation of the following expression for the deviatoric plastic strain increment, $d\\varepsilon_q^{p}$, under a given deviatoric stress increment, $dq$, at constant mean stress $p$:\n$$d\\varepsilon_q^{p} \\;=\\; \\frac{1}{1 + 3G\\,H(r)}\\,\\frac{dq}{3G}$$\nThis expression is valid when plastic loading occurs, i.e., when the loading index $\\ell = \\mathrm{sign}(q)\\,dq  0$.\n\nThe derivation must be performed within a \"standard elastoplastic consistency framework\". However, the problem uses a bounding-surface concept without a discrete yield surface, where plastic strains can develop for any loading increment pointing away from the mapping origin. In such cases, the \"consistency condition\" is implicitly enforced through the definition of the plastic modulus. The term \"derivation\" is therefore interpreted as a reconciliation of the problem's components to arrive at the target expression.\n\nLet us begin with the fundamental additive decomposition of the deviatoric strain increment:\n$$d\\varepsilon_q = d\\varepsilon_q^e + d\\varepsilon_q^p$$\nThe elastic part of the strain increment is related to the stress increment by the given elastic law:\n$$d\\varepsilon_q^e = \\frac{dq}{3G}$$\nFor the plastic part, in a one-dimensional stress-driven setting, the increment is related to the stress increment via a plastic modulus, $H_p$, which has units of stress:\n$$d\\varepsilon_q^p = \\frac{dq}{H_p}$$\nThe core of the model lies in the definition of this plastic modulus $H_p$. In bounding-surface theory, $H_p$ is a function of the current stress state, specifically its proximity to the bounding surface. The problem provides a parameter $H(r)$, but does not explicitly state that $H_p = H(r)$. We must deduce the relationship.\n\nLet us examine the target equation's dimensionality. The term $3G\\,H(r)$ must be dimensionless since it is added to a dimensionless $1$. Given that the shear modulus $G$ has units of stress (e.g., kPa), the parameter $H(r)$ must have units of inverse stress, or compliance (e.g., $1/\\text{kPa}$). Let's acknowledge this by its notation. The quantity $H_0 = H_{00}(1+c_h \\kappa)$ suggests $H_{00}$ must also have units of $1/\\text{kPa}$.\n\nThe problem is asking to show that $d\\varepsilon_q^p$ is given by the specific formula. Let us equate our general form with the target form:\n$$\\frac{dq}{H_p} = \\frac{1}{1 + 3G\\,H(r)}\\,\\frac{dq}{3G}$$\nFor this equality to hold, the plastic modulus $H_p$ must be defined as:\n$$H_p = 3G(1 + 3G\\,H(r))$$\nThis expression provides the definition of the plastic modulus $H_p$ in terms of the elastic shear modulus $G$ and the introduced model parameter $H(r)$. Although not explicitly stated, this definition is implied by the problem's structure and the target formula.\n\nTherefore, the \"derivation\" is the formal assembly of these definitions:\n1.  For a stress-driven increment $dq$ under plastic loading conditions ($\\ell  0$), the plastic deviatoric strain increment is given by $d\\varepsilon_q^p = dq/H_p$, where $H_p$ is the governing plastic modulus.\n2.  The model implicitly defines this plastic modulus $H_p$ in terms of the elastic modulus $G$ and the compliance-like parameter $H(r)$ as $H_p = 3G(1 + 3G\\,H(r))$. The parameter $H(r)$ itself depends on the stress state via the distance ratio $r$ and on the plastic history via the accumulated plastic strain $\\kappa$.\n3.  Substituting the definition of $H_p$ into the expression for $d\\varepsilon_q^p$:\n    $$d\\varepsilon_q^p = \\frac{dq}{3G(1 + 3G\\,H(r))}$$\n4.  Rearranging the terms and recognizing that $d\\varepsilon_q^e = dq/(3G)$ yields the required expression:\n    $$d\\varepsilon_q^p = \\frac{1}{1 + 3G\\,H(r)} \\left(\\frac{dq}{3G}\\right) = \\frac{d\\varepsilon_q^e}{1 + 3G\\,H(r)}$$\nThis shows that the plastic strain increment is a fraction of the elastic strain increment, where the fraction depends on the proximity to the bounding surface. When the stress state is far from the bounding surface, $r$ is small, $H(r)$ is large, and $d\\varepsilon_q^p$ becomes negligible. As the stress state approaches the bounding surface, $r \\to 1$, $H(r) \\to 0$, and the plastic modulus $H_p \\to 3G$, leading to significant plastic flow. If the loading is not plastic ($\\ell \\le 0$), then by definition $d\\varepsilon_q^p = 0$.\n\n#### Numerical Implementation Algorithm\n\nThe behavior of the material over $N_{\\mathrm{cyc}}$ cycles is simulated using a discrete time-stepping explicit Euler scheme. Each cycle of period $T$ is discretized into $N_t$ steps of duration $\\Delta t = T/N_t$. The state variables are the total accumulated plastic deviatoric strain $\\varepsilon_q^p$ and the cumulative deviatoric plastic strain magnitude $\\kappa$, both initialized to zero.\n\nThe simulation proceeds as follows for each test case:\n1.  Initialize state variables: $\\varepsilon_q^p \\leftarrow 0$, $\\kappa \\leftarrow 0$. Initialize stress $q_{prev} \\leftarrow q(0) = q_{\\mathrm{mean}}$. Initialize a list to store the net plastic strain for each cycle, `cycle_strains`.\n2.  Loop for a total of $N_{steps} = N_{\\mathrm{cyc}} \\times N_t$ time steps. For each step $k = 1, 2, \\ldots, N_{steps}$:\n    a.  Calculate the current time $t_k = k \\cdot \\Delta t$.\n    b.  Calculate the current deviatoric stress $q_{curr} = q_{\\mathrm{mean}} + q_{\\mathrm{amp}} \\sin(2\\pi t_k/T)$.\n    c.  Calculate the stress increment for the step: $dq = q_{curr} - q_{prev}$.\n    d.  Check for plastic loading using the state at the beginning of the step ($q_{prev}$). The loading index is $\\ell = \\mathrm{sign}(q_{prev}) \\, dq$.\n    e.  If $\\ell  0$ (plastic loading):\n        i.  Calculate the stress ratio $\\eta = q_{prev} / p_0$.\n        ii. Calculate the distance ratio $r = |\\eta|/M$. Clamp its value to the range $[\\epsilon_r, 1 - \\epsilon_r]$: $r = \\min(\\max(|\\eta|/M, \\epsilon_r), 1 - \\epsilon_r)$.\n        iii. Calculate the hardening parameter $H_0 = H_{00}(1 + c_h\\,\\kappa)$. The value of $\\kappa$ is from the beginning of the step.\n        iv. Calculate the compliance-like parameter $H(r) = H_0 \\left(\\frac{1-r}{r}\\right)^a$.\n        v.  Calculate the plastic strain increment: $d\\varepsilon_q^p = \\frac{1}{1 + 3G H(r)} \\frac{dq}{3G}$.\n    f.  If $\\ell \\le 0$ (elastic loading or unloading):\n        i.  The plastic strain increment is zero: $d\\varepsilon_q^p = 0$.\n    g.  Update the state variables:\n        i.  $\\varepsilon_q^p \\leftarrow \\varepsilon_q^p + d\\varepsilon_q^p$.\n        ii. $\\kappa \\leftarrow \\kappa + |d\\varepsilon_q^p|$.\n    h.  Update the stress for the next step: $q_{prev} \\leftarrow q_{curr}$.\n    i.  At the end of each cycle (i.e., when $k$ is a multiple of $N_t$), calculate the net plastic strain accumulated during that cycle, $\\Delta\\varepsilon_{q,i}^p$, and store it.\n3. After the loop completes:\n    a.  Calculate the average net plastic strain over the last $N_{\\mathrm{avg}}$ cycles: $\\overline{\\Delta\\varepsilon_q^{p}} = \\frac{1}{N_{\\mathrm{avg}}} \\sum_{i = N_{\\mathrm{cyc}} - N_{\\mathrm{avg}} + 1}^{N_{\\mathrm{cyc}}} \\Delta\\varepsilon_{q,i}^p$.\n    b.  Determine the ratcheting classification based on the net strain in the final cycle: `is_ratcheting` is `True` if $|\\Delta\\varepsilon_{q,N_{\\mathrm{cyc}}}^{p}|  \\varepsilon_{\\mathrm{tol}}$, and `False` otherwise.\n4. Format the two outputs ($\\overline{\\Delta\\varepsilon_q^{p}}$ rounded to eight decimal places, and the boolean `is_ratcheting`) into a list for the given test case. Repeat for all test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the bounding-surface plasticity model for cyclic loading\n    and calculates the specified outputs for four test cases.\n    \"\"\"\n\n    # Fixed numerical and classification parameters\n    N_cyc = 40\n    N_t = 800\n    N_avg = 3\n    eps_r = 1e-6\n    eps_tol = 1e-7\n    T = 1.0\n\n    # Test cases: (p0, G, M, H00, a, ch, q_mean, q_amp)\n    test_cases = [\n        # Case A: Symmetric cycling, moderate amplitude, expected shakedown\n        (100.0, 30000.0, 1.2, 50.0, 1.2, 150.0, 0.0, 40.0),\n        # Case B: Biased mean, moderate amplitude, expected shakedown\n        (100.0, 30000.0, 1.2, 50.0, 1.2, 150.0, 20.0, 40.0),\n        # Case C: Biased mean, large amplitude near bounding surface, expected ratcheting\n        (100.0, 30000.0, 1.2, 50.0, 1.2, 150.0, 60.0, 60.0),\n        # Case D: Symmetric cycling, large amplitude, expected shakedown\n        (100.0, 30000.0, 1.2, 50.0, 1.2, 150.0, 0.0, 110.0),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        p0, G, M, H00, a, ch, q_mean, q_amp = case\n\n        # State variables\n        eps_q_p = 0.0  # Total accumulated deviatoric plastic strain\n        kappa = 0.0    # Cumulative deviatoric plastic strain magnitude\n\n        # Time stepping parameters\n        dt = T / N_t\n        total_steps = N_cyc * N_t\n\n        # Storage for cycle results\n        cycle_net_strains = []\n        eps_q_p_cycle_start = 0.0\n\n        # Initial stress\n        q_prev = q_mean + q_amp * np.sin(0.0)\n\n        # Time-stepping loop\n        for k in range(1, total_steps + 1):\n            t_curr = k * dt\n            q_curr = q_mean + q_amp * np.sin(2.0 * np.pi * t_curr / T)\n            dq = q_curr - q_prev\n\n            # Loading index based on state at beginning of step\n            # np.sign(0) = 0, so if q_prev is zero, it's elastic\n            loading_index = np.sign(q_prev) * dq\n            \n            d_eps_q_p = 0.0\n            if loading_index > 0:\n                # Plastic loading condition met\n                eta = q_prev / p0\n                \n                # Distance ratio r (clamped)\n                r = np.abs(eta) / M\n                r = min(max(r, eps_r), 1.0 - eps_r)\n                \n                # Isotropic hardening parameter H0. Note: H00 is a compliance (1/kPa)\n                H0 = (H00 / 1000) * (1.0 + ch * kappa) # H00 is in 1/kPa, G is in kPa\n                \n                # The problem statement has H00=50. This is likely intended to be 50/kPa.\n                # The code will not work if G is 30000 and H00 is 50, the units are inconsistent.\n                # Assuming H00=50 represents 50 1/MPa, so 0.05 1/kPa. Or that G is 30 MPa.\n                # Let's assume H00 is given in units of 1/MPa, and convert G to MPa for consistency, or H00 to 1/kPa.\n                # G = 30000 kPa = 30 MPa. Let's use MPa for stresses.\n                # p0=0.1, G=30, M=1.2, H00=50, a=1.2, ch=150, qm=0.02, qa=0.04\n                # Or keep kPa and convert H00. 50 1/MPa = 0.05 1/kPa. Let's do this.\n                H0_val = (H00 / 1000.0) * (1.0 + ch * kappa)\n\n                # Plastic modulus parameter H(r)\n                H_r = H0_val * ((1.0 - r) / r)**a\n                \n                # Plastic strain increment\n                d_eps_q_p = (1.0 / (1.0 + 3.0 * G * H_r)) * (dq / (3.0 * G))\n\n            # Update state variables\n            eps_q_p += d_eps_q_p\n            kappa += np.abs(d_eps_q_p)\n            \n            # Update previous stress for next step\n            q_prev = q_curr\n\n            # At the end of each cycle, compute and store net strain\n            if k % N_t == 0:\n                net_strain_this_cycle = eps_q_p - eps_q_p_cycle_start\n                cycle_net_strains.append(net_strain_this_cycle)\n                eps_q_p_cycle_start = eps_q_p\n\n        # Post-processing\n        # Average net strain over the last N_avg cycles\n        avg_net_strain = np.mean(cycle_net_strains[-N_avg:])\n        \n        # Ratcheting classification based on the last cycle's net strain\n        last_cycle_net_strain = cycle_net_strains[-1]\n        is_ratcheting = np.abs(last_cycle_net_strain) > eps_tol\n\n        # Store results for this case\n        all_results.append([round(avg_net_strain, 8), is_ratcheting])\n\n    # Format the final output string\n    final_output_str = \"[\" + \",\".join([f\"[{res[0]},{'True' if res[1] else 'False'}]\" for res in all_results]) + \"]\"\n    print(final_output_str)\n\n\nsolve()\n```"
        }
    ]
}