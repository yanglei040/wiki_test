{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of geotechnical engineering is the ability to predict when a material will fail. This exercise merges the foundational Terzaghi effective stress principle with a simple isotropic damage model inside the classic Mohr-Coulomb failure criterion. By working through the mechanics of a drained triaxial test on a damaged sandstone specimen, you will see how to translate a physical test into stress invariants and compute the material's strength, providing a direct link between damage, effective stress, and failure .",
            "id": "3536396",
            "problem": "A cylindrical specimen of weakly cemented sandstone is tested in a drained triaxial compression at room temperature. The total confining pressure is $\\,\\sigma_{3} = 30\\,\\mathrm{MPa}\\,$ and the pore fluid pressure is controlled at $\\,p_{f} = 5\\,\\mathrm{MPa}\\,$ throughout the test. The material is modeled using an isotropic damage variable $\\,D \\in [0,1)\\,$, which reduces the intrinsic cohesion linearly while leaving the friction angle unaffected, so that the cohesion entering the failure condition is $\\,c(D) = (1 - D)\\,c_{0}\\,$, where $\\,c_{0}\\,$ is the undamaged cohesion. Assume that failure is governed by the Mohr–Coulomb criterion expressed in terms of Terzaghi effective stress invariants, and that the specimen fails in the triaxial compression branch.\n\nFundamental bases that must be used:\n- The Terzaghi effective stress principle $\\,\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - p_{f}\\,\\mathbf{I}\\,$ and the effective stress invariants $\\,p' = \\tfrac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}')\\,$ and $\\,q = \\sqrt{3\\,J_{2}(\\boldsymbol{s}')}\\,$, where $\\,\\boldsymbol{s}' = \\boldsymbol{\\sigma}' - p'\\,\\mathbf{I}\\,$ and $\\,J_{2}(\\boldsymbol{s}') = \\tfrac{1}{2}\\,\\boldsymbol{s}':\\boldsymbol{s}'\\,$.\n- The linear Mohr–Coulomb failure envelope $\\,\\tau = c + \\sigma_{n}' \\tan\\phi\\,$ in terms of effective normal stress $\\,\\sigma_{n}'\\,$ and shear stress $\\,\\tau\\,$ on the critical plane.\n\nGiven:\n- $\\,\\sigma_{3} = 30\\,\\mathrm{MPa}\\,$,\n- $\\,p_{f} = 5\\,\\mathrm{MPa}\\,$,\n- friction angle $\\,\\phi = 32^{\\circ}\\,$ (use radians when evaluating trigonometric functions),\n- undamaged cohesion $\\,c_{0} = 8\\,\\mathrm{MPa}\\,$,\n- isotropic damage $\\,D = 0.25\\,$.\n\nUsing only the above bases and definitions, derive from first principles and compute the failure deviatoric stress $\\,q_{f}\\,$ for the triaxial compression branch, expressed in megapascals. Round your final numerical value to four significant figures and express the final answer in $\\,\\mathrm{MPa}\\,$. Do not present intermediate results in the final answer.",
            "solution": "The problem requires the calculation of the deviatoric stress at failure, $q_f$, for a sandstone specimen under drained triaxial compression. The solution must be derived from first principles, using the Terzaghi effective stress concept and the Mohr-Coulomb failure criterion.\n\nFirst, we establish the state of stress and material properties at the point of failure. The specimen is subjected to a constant total confining pressure $\\sigma_{3} = 30\\,\\mathrm{MPa}$ and a constant pore fluid pressure $p_{f} = 5\\,\\mathrm{MPa}$. According to Terzaghi's effective stress principle, the effective stress tensor $\\boldsymbol{\\sigma}'$ is given by $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - p_{f}\\,\\mathbf{I}$, where $\\boldsymbol{\\sigma}$ is the total stress tensor and $\\mathbf{I}$ is the identity tensor.\n\nIn a triaxial compression test, the stress tensor in the principal stress basis is diagonal. The total principal stresses are $\\sigma_1$ (axial) and $\\sigma_2 = \\sigma_3$ (confining). The corresponding effective principal stresses are $\\sigma'_1 = \\sigma_1 - p_f$ and $\\sigma'_2 = \\sigma'_3 = \\sigma_3 - p_f$. Since the confining pressure is held constant, the minor effective principal stress $\\sigma'_3$ is also constant throughout the test:\n$$\n\\sigma'_{3} = 30\\,\\mathrm{MPa} - 5\\,\\mathrm{MPa} = 25\\,\\mathrm{MPa}\n$$\nThe problem specifies a compression-positive sign convention, with failure occurring under increasing axial stress, so $\\sigma'_1 \\ge \\sigma'_3$.\n\nThe material's cohesion is affected by damage. The undamaged cohesion is $c_{0} = 8\\,\\mathrm{MPa}$ and the damage variable at failure is $D = 0.25$. The cohesion entering the failure criterion, $c(D)$, is given by:\n$$\nc(D) = (1 - D) c_{0} = (1 - 0.25) \\times 8\\,\\mathrm{MPa} = 0.75 \\times 8\\,\\mathrm{MPa} = 6\\,\\mathrm{MPa}\n$$\nThe friction angle $\\phi = 32^{\\circ}$ is unaffected by damage.\n\nThe failure is governed by the Mohr-Coulomb criterion, which states that failure occurs when the shear stress $\\tau$ on a plane reaches a critical value dependent on the effective normal stress $\\sigma'_{n}$ on that same plane:\n$$\n|\\tau| = c(D) + \\sigma'_{n} \\tan\\phi\n$$\nTo apply this criterion to the triaxial stress state, we express it in terms of the major and minor principal effective stresses, $\\sigma'_1$ and $\\sigma'_3$. In the $(\\sigma'_n, \\tau)$ plane, the stress state is represented by a Mohr's circle with center $C$ and radius $R$ given by:\n$$\nC = \\frac{\\sigma'_1 + \\sigma'_3}{2} \\quad \\text{and} \\quad R = \\frac{\\sigma'_1 - \\sigma'_3}{2}\n$$\nFailure occurs when this circle becomes tangent to the failure envelope defined by $|\\tau| = c(D) + \\sigma'_{n} \\tan\\phi$. From the geometry of the Mohr's circle and its tangency to the failure line, we have the relationship:\n$$\nR = C \\sin\\phi + c(D) \\cos\\phi\n$$\nSubstituting the expressions for $C$ and $R$:\n$$\n\\frac{\\sigma'_1 - \\sigma'_3}{2} = \\left(\\frac{\\sigma'_1 + \\sigma'_3}{2}\\right) \\sin\\phi + c(D) \\cos\\phi\n$$\nWe need to solve for the major principal effective stress at failure, $\\sigma'_{1,f}$. Let $\\sigma'_1 = \\sigma'_{1,f}$ and $\\sigma'_3 = \\sigma'_{3,f} = 25\\,\\mathrm{MPa}$. Rearranging the equation to solve for $\\sigma'_{1,f}$:\n$$\n\\sigma'_{1,f} - \\sigma'_{3,f} = (\\sigma'_{1,f} + \\sigma'_{3,f}) \\sin\\phi + 2 c(D) \\cos\\phi\n$$\n$$\n\\sigma'_{1,f} (1 - \\sin\\phi) = \\sigma'_{3,f} (1 + \\sin\\phi) + 2 c(D) \\cos\\phi\n$$\n$$\n\\sigma'_{1,f} = \\sigma'_{3,f} \\frac{1 + \\sin\\phi}{1 - \\sin\\phi} + 2 c(D) \\frac{\\cos\\phi}{1 - \\sin\\phi}\n$$\nThis equation gives the major principal effective stress at failure.\n\nThe problem asks for the failure deviatoric stress, $q_f$. The deviatoric stress invariant $q$ is defined as $q = \\sqrt{3 J_2(\\boldsymbol{s}')}$, where $J_2(\\boldsymbol{s}')$ is the second invariant of the deviatoric effective stress tensor $\\boldsymbol{s}' = \\boldsymbol{\\sigma}' - p'\\mathbf{I}$. For the case of triaxial compression ($\\sigma'_1 \\ge \\sigma'_2 = \\sigma'_3$), this simplifies to:\n$$\nq = \\sigma'_1 - \\sigma'_3\n$$\nTherefore, the deviatoric stress at failure, $q_f$, is:\n$$\nq_f = \\sigma'_{1,f} - \\sigma'_{3,f}\n$$\nSubstituting the expression for $\\sigma'_{1,f}$ derived from the Mohr-Coulomb criterion:\n$$\nq_f = \\left(\\sigma'_{3,f} \\frac{1 + \\sin\\phi}{1 - \\sin\\phi} + 2 c(D) \\frac{\\cos\\phi}{1 - \\sin\\phi}\\right) - \\sigma'_{3,f}\n$$\n$$\nq_f = \\sigma'_{3,f} \\left(\\frac{1 + \\sin\\phi}{1 - \\sin\\phi} - 1\\right) + \\frac{2 c(D) \\cos\\phi}{1 - \\sin\\phi}\n$$\n$$\nq_f = \\sigma'_{3,f} \\left(\\frac{1 + \\sin\\phi - (1 - \\sin\\phi)}{1 - \\sin\\phi}\\right) + \\frac{2 c(D) \\cos\\phi}{1 - \\sin\\phi}\n$$\n$$\nq_f = \\sigma'_{3,f} \\left(\\frac{2 \\sin\\phi}{1 - \\sin\\phi}\\right) + \\frac{2 c(D) \\cos\\phi}{1 - \\sin\\phi}\n$$\nThis simplifies to the final analytical expression for $q_f$:\n$$\nq_f = \\frac{2(\\sigma'_{3,f} \\sin\\phi + c(D) \\cos\\phi)}{1 - \\sin\\phi}\n$$\nNow, we substitute the numerical values: $\\sigma'_{3,f} = 25\\,\\mathrm{MPa}$, $c(D) = 6\\,\\mathrm{MPa}$, and $\\phi = 32^{\\circ}$. The problem specifies using radians for evaluating trigonometric functions, which is the standard for computational libraries.\n$$\n\\sin(32^{\\circ}) \\approx 0.529919\n$$\n$$\n\\cos(32^{\\circ}) \\approx 0.848048\n$$\nPlugging these values into the expression for $q_f$:\n$$\nq_f = \\frac{2(25\\,\\mathrm{MPa} \\times 0.529919 + 6\\,\\mathrm{MPa} \\times 0.848048)}{1 - 0.529919}\n$$\n$$\nq_f = \\frac{2(13.247975\\,\\mathrm{MPa} + 5.088288\\,\\mathrm{MPa})}{0.470081}\n$$\n$$\nq_f = \\frac{2(18.336263\\,\\mathrm{MPa})}{0.470081}\n$$\n$$\nq_f = \\frac{36.672526\\,\\mathrm{MPa}}{0.470081} \\approx 78.0134\\,\\mathrm{MPa}\n$$\nRounding the final result to four significant figures as requested, we get $78.01\\,\\mathrm{MPa}$.",
            "answer": "$$\\boxed{78.01}$$"
        },
        {
            "introduction": "Developing a constitutive model for a damaged material requires a theoretical postulate to connect its response to a fictitious, undamaged counterpart. This practice delves into this conceptual foundation by comparing two prominent theories: the strain equivalence and energy equivalence hypotheses. You will derive the predicted stiffness of a damaged rock in an oedometer test under each hypothesis, revealing how these different theoretical starting points lead to distinct, quantifiable predictions for material behavior . This highlights the critical role that underlying assumptions play in the formulation of any advanced material model.",
            "id": "3536380",
            "problem": "An isotropically damaged rock specimen is subjected to an oedometer test. The oedometer condition enforces zero lateral strains while the axial strain is controlled by the axial stress. The undamaged elastic response is linear isotropic with Young’s modulus $E_0$ and Poisson’s ratio $\\nu_0$. The mean effective stress $p'$ is elevated to a high level during reloading, physically closing crack faces. However, the scalar damage variable $d$ is taken as irreversibly stored from prior loading, parameterized by an internal variable $\\kappa$, and does not decrease upon compressive reloading.\n\nAdopt the effective stress concept for isotropic scalar damage with the standard definition of effective Cauchy stress as $\\tilde{\\sigma} = \\sigma / (1 - d)$, where $0 \\le d < 1$. Consider two equivalence hypotheses that connect the damaged material to a fictitious undamaged material:\n- Strain equivalence: the elastic strain in the damaged material under the real stress $\\sigma$ equals the elastic strain of the undamaged material under the effective stress $\\tilde{\\sigma}$.\n- Energy equivalence: the elastic energy density in the damaged material under $\\sigma$ equals the elastic energy density of the undamaged material under $\\tilde{\\sigma}$.\n\nStarting only from the definitions above and linear isotropic elasticity, derive the unloaded constrained modulus in an oedometer test, $M$, under each hypothesis. The constrained modulus $M$ is defined by the axial stress–axial strain slope under zero lateral strain and depends on the damaged elastic constants. Then, for the same damage evolution law $d(\\kappa)$, compute the ratio $R$ of the unloading constrained modulus predicted by strain equivalence to that predicted by energy equivalence.\n\nUse the following scientifically realistic parameters:\n- Undamaged elastic constants: $E_0 = 40$ GPa and $\\nu_0 = 0.25$.\n- Irreversible damage function: $d(\\kappa) = 1 - \\exp(-b \\kappa)$ with $b = 15$ and $\\kappa = 0.005$.\n- High mean effective stress: $p' = 120$ MPa (this contextualizes crack closure but does not enter the algebra directly because $d$ is taken as history-dependent and fixed during unloading).\n\nCompute $R$ and round your final answer to four significant figures. Express the ratio as a pure number (unitless).",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard problem in continuum damage mechanics. All necessary data and definitions are provided, and there are no internal contradictions. Therefore, a complete solution will be developed.\n\nThe core of the problem is to derive the damaged constrained modulus $M$ under two different equivalence hypotheses—strain equivalence and energy equivalence—and then compute their ratio.\n\nFirst, we establish the fundamental relationship for linear isotropic elasticity in an undamaged material. The constitutive relation (Hooke's Law) can be expressed in terms of the compliance tensor $\\mathbf{C}_0$. For principal stresses and strains, this is:\n$$\n\\begin{pmatrix} \\epsilon_{1} \\\\ \\epsilon_{2} \\\\ \\epsilon_{3} \\end{pmatrix}\n=\n\\frac{1}{E_0}\n\\begin{pmatrix}\n1 & -\\nu_0 & -\\nu_0 \\\\\n-\\nu_0 & 1 & -\\nu_0 \\\\\n-\\nu_0 & -\\nu_0 & 1\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_{1} \\\\ \\sigma_{2} \\\\ \\sigma_{3} \\end{pmatrix}\n$$\nwhere $E_0$ is the undamaged Young's modulus and $\\nu_0$ is the undamaged Poisson's ratio. The elastic strain energy density for the undamaged material is $\\Psi_0 = \\frac{1}{2} \\sigma : \\epsilon = \\frac{1}{2} \\sigma : \\mathbf{C}_0 : \\sigma$.\n\nThe problem states that the damage state is fixed, defined by a scalar damage variable $d$. The value of $d$ is determined by the given irreversible damage function and parameters:\n$d = 1 - \\exp(-b \\kappa)$, with $b = 15$ and $\\kappa = 0.005$.\n$$\nd = 1 - \\exp(-15 \\times 0.005) = 1 - \\exp(-0.075)\n$$\nThis value of $d$ is constant during the unloading process being analyzed. The effective stress tensor $\\tilde{\\sigma}$ is defined as:\n$$\n\\tilde{\\sigma} = \\frac{\\sigma}{1-d}\n$$\n\nThe oedometer condition imposes zero lateral strains. Let the axial direction be denoted by the subscript $z$, and the lateral directions by $x$ and $y$. The conditions are $\\epsilon_x = \\epsilon_y = 0$. Due to axisymmetry, we must have $\\sigma_x = \\sigma_y$.\n\nThe constrained modulus $M$ is defined from the axial stress-strain relationship under these conditions: $M = \\frac{\\sigma_z}{\\epsilon_z}$.\n\n**1. Strain Equivalence Hypothesis**\n\nThe strain equivalence hypothesis posits that the strain tensor $\\epsilon$ in the damaged material under the action of the Cauchy stress $\\sigma$ is equal to the strain tensor in the fictitious undamaged material under the action of the effective stress $\\tilde{\\sigma}$.\n$$\n\\epsilon(\\sigma, d) = \\epsilon_0(\\tilde{\\sigma})\n$$\nUsing the undamaged constitutive law, we have:\n$$\n\\epsilon = \\mathbf{C}_0 : \\tilde{\\sigma} = \\mathbf{C}_0 : \\frac{\\sigma}{1-d}\n$$\nThis defines the compliance tensor of the damaged material, $\\mathbf{C}_d$, as $\\mathbf{C}_d = \\frac{\\mathbf{C}_0}{1-d}$. This relation implies a degradation of the elastic properties. To find the new elastic constants $E$ and $\\nu$, we write out the strain components:\n$$\n\\epsilon_z = \\frac{1}{E_0(1-d)} \\left[ \\sigma_z - \\nu_0 (\\sigma_x + \\sigma_y) \\right]\n$$\nComparing this to the generic form $\\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - \\nu (\\sigma_x + \\sigma_y) \\right]$, we can identify the damaged elastic constants under strain equivalence:\n$$\nE_{\\text{se}} = E_0(1-d)\n$$\n$$\n\\nu_{\\text{se}} = \\nu_0\n$$\nUnder the oedometer conditions ($\\epsilon_x=0$, $\\sigma_x=\\sigma_y$), the lateral strain equation is:\n$$\n\\epsilon_x = 0 = \\frac{1}{E_{\\text{se}}} \\left[ \\sigma_x - \\nu_{\\text{se}} (\\sigma_x + \\sigma_z) \\right]\n$$\nSolving for $\\sigma_x$:\n$$\n\\sigma_x (1 - \\nu_{\\text{se}}) = \\nu_{\\text{se}} \\sigma_z \\implies \\sigma_x = \\frac{\\nu_{\\text{se}}}{1 - \\nu_{\\text{se}}} \\sigma_z\n$$\nNow, we substitute this into the expression for the axial strain $\\epsilon_z$:\n$$\n\\epsilon_z = \\frac{1}{E_{\\text{se}}} \\left[ \\sigma_z - \\nu_{\\text{se}} (2\\sigma_x) \\right] = \\frac{1}{E_{\\text{se}}} \\left[ \\sigma_z - 2\\nu_{\\text{se}} \\left( \\frac{\\nu_{\\text{se}}}{1 - \\nu_{\\text{se}}} \\sigma_z \\right) \\right]\n$$\n$$\n\\epsilon_z = \\frac{\\sigma_z}{E_{\\text{se}}} \\left[ 1 - \\frac{2\\nu_{\\text{se}}^2}{1 - \\nu_{\\text{se}}} \\right] = \\frac{\\sigma_z}{E_{\\text{se}}} \\frac{1 - \\nu_{\\text{se}} - 2\\nu_{\\text{se}}^2}{1 - \\nu_{\\text{se}}} = \\frac{\\sigma_z}{E_{\\text{se}}} \\frac{(1+\\nu_{\\text{se}})(1-2\\nu_{\\text{se}})}{1 - \\nu_{\\text{se}}}\n$$\nThe constrained modulus under strain equivalence, $M_{\\text{se}}$, is $\\sigma_z / \\epsilon_z$:\n$$\nM_{\\text{se}} = E_{\\text{se}} \\frac{1 - \\nu_{\\text{se}}}{(1+\\nu_{\\text{se}})(1-2\\nu_{\\text{se}})}\n$$\nSubstituting $E_{\\text{se}} = E_0(1-d)$ and $\\nu_{\\text{se}} = \\nu_0$:\n$$\nM_{\\text{se}} = E_0(1-d) \\frac{1 - \\nu_0}{(1+\\nu_0)(1-2\\nu_0)}\n$$\n\n**2. Energy Equivalence Hypothesis**\n\nThe energy equivalence hypothesis posits that the elastic strain energy density $\\Psi$ in the damaged material under $\\sigma$ is equal to the elastic strain energy density $\\Psi_0$ in the fictitious undamaged material under $\\tilde{\\sigma}$.\n$$\n\\Psi(\\sigma, d) = \\Psi_0(\\tilde{\\sigma}) = \\frac{1}{2} \\tilde{\\sigma} : \\mathbf{C}_0 : \\tilde{\\sigma}\n$$\nSubstituting $\\tilde{\\sigma} = \\sigma / (1-d)$:\n$$\n\\Psi(\\sigma, d) = \\frac{1}{2} \\left(\\frac{\\sigma}{1-d}\\right) : \\mathbf{C}_0 : \\left(\\frac{\\sigma}{1-d}\\right) = \\frac{1}{(1-d)^2} \\left( \\frac{1}{2} \\sigma : \\mathbf{C}_0 : \\sigma \\right) = \\frac{\\Psi_0(\\sigma)}{(1-d)^2}\n$$\nThe strain tensor is derived from the potential: $\\epsilon = \\frac{\\partial \\Psi}{\\partial \\sigma}$.\n$$\n\\epsilon = \\frac{\\partial}{\\partial \\sigma} \\left[ \\frac{\\Psi_0(\\sigma)}{(1-d)^2} \\right] = \\frac{1}{(1-d)^2} \\frac{\\partial \\Psi_0(\\sigma)}{\\partial \\sigma} = \\frac{\\epsilon_0(\\sigma)}{(1-d)^2}\n$$\nwhere $\\epsilon_0(\\sigma)$ is the strain in the undamaged material under stress $\\sigma$. This gives the damaged compliance tensor as $\\mathbf{C}_d = \\frac{\\mathbf{C}_0}{(1-d)^2}$. We identify the effective elastic constants by comparing strain components:\n$$\n\\epsilon_z = \\frac{1}{(1-d)^2} \\left( \\frac{1}{E_0} \\left[ \\sigma_z - \\nu_0 (\\sigma_x + \\sigma_y) \\right] \\right) = \\frac{1}{E_0(1-d)^2} \\left[ \\sigma_z - \\nu_0 (\\sigma_x + \\sigma_y) \\right]\n$$\nComparing with the generic form, we find the damaged elastic constants under energy equivalence:\n$$\nE_{\\text{ee}} = E_0(1-d)^2\n$$\n$$\n\\nu_{\\text{ee}} = \\nu_0\n$$\nThe algebraic form for the constrained modulus is the same as before, but with these new parameters:\n$$\nM_{\\text{ee}} = E_{\\text{ee}} \\frac{1 - \\nu_{\\text{ee}}}{(1+\\nu_{\\text{ee}})(1-2\\nu_{\\text{ee}})}\n$$\nSubstituting $E_{\\text{ee}} = E_0(1-d)^2$ and $\\nu_{\\text{ee}} = \\nu_0$:\n$$\nM_{\\text{ee}} = E_0(1-d)^2 \\frac{1 - \\nu_0}{(1+\\nu_0)(1-2\\nu_0)}\n$$\n\n**3. Ratio of the Constrained Moduli**\n\nWe now compute the ratio $R = M_{\\text{se}} / M_{\\text{ee}}$.\n$$\nR = \\frac{M_{\\text{se}}}{M_{\\text{ee}}} = \\frac{E_0(1-d) \\frac{1 - \\nu_0}{(1+\\nu_0)(1-2\\nu_0)}}{E_0(1-d)^2 \\frac{1 - \\nu_0}{(1+\\nu_0)(1-2\\nu_0)}}\n$$\nThe terms involving $E_0$ and $\\nu_0$ cancel out, leaving a simple expression:\n$$\nR = \\frac{1-d}{(1-d)^2} = \\frac{1}{1-d}\n$$\nNow, substitute the expression for the damage variable $d = 1 - \\exp(-0.075)$:\n$$\nR = \\frac{1}{1 - (1 - \\exp(-0.075))} = \\frac{1}{\\exp(-0.075)} = \\exp(0.075)\n$$\nFinally, we compute the numerical value and round it to four significant figures:\n$$\nR = \\exp(0.075) \\approx 1.07788411\n$$\nRounding to four significant figures gives $1.078$.",
            "answer": "$$\\boxed{1.078}$$"
        },
        {
            "introduction": "This practice brings together the preceding concepts into a dynamic numerical simulation, moving from static calculations to modeling the entire evolution of material behavior. You will implement a simplified simulation of a drained triaxial compression test, tracking the coupled evolution of stress, strain, and damage over a prescribed loading path. This hands-on coding exercise demonstrates how the constitutive laws and damage evolution rules are integrated within an incremental solver to predict the full, non-linear stress-strain response of a geomaterial as it progressively weakens .",
            "id": "3536423",
            "problem": "Consider a small-strain, axisymmetric drained triaxial compression simulation for a saturated geomaterial modeled with isotropic scalar damage and the effective stress concept. Adopt the following sign convention: compressive stresses and strains are positive. The specimen is loaded such that the total radial stress is held constant and the axial strain is monotonically increased. Pore pressure is prescribed. Your task is to compute the stress-strain response using effective stress invariants and an internal damage variable.\n\nUse the following modeling assumptions and core definitions as the fundamental base:\n- The Cauchy effective stress tensor, denoted by $\\boldsymbol{\\sigma}'$, is related to the total stress tensor $\\boldsymbol{\\sigma}$ and pore pressure $u$ by the effective stress principle for saturated media: $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - u \\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor.\n- The elastic constitutive law in terms of effective stress is isotropic linear elasticity degraded by an isotropic scalar damage variable $d \\in [0,1)$ applied multiplicatively to the stiffness, so that $\\boldsymbol{\\sigma}' = \\left(1-d\\right) \\mathbb{C} : \\boldsymbol{\\varepsilon}$, where $\\boldsymbol{\\varepsilon}$ is the small strain tensor and $\\mathbb{C}$ is the fourth-order isotropic elasticity tensor parameterized by Young's modulus $E$ and Poisson's ratio $\\nu$.\n- Axisymmetric triaxial compression implies principal strains $\\varepsilon_1$ (axial), $\\varepsilon_2=\\varepsilon_3$ (radial), and principal stresses $\\sigma_1$, $\\sigma_2=\\sigma_3$.\n- The mean effective stress invariant is $p' = \\tfrac{1}{3}\\left(\\sigma_1' + \\sigma_2' + \\sigma_3'\\right)$ and the triaxial compression deviatoric invariant is $q = \\sqrt{3 J_2'}$ with $J_2'$ being the second invariant of the deviatoric effective stress; under axisymmetry with $\\sigma_2'=\\sigma_3'$, this reduces to $q = \\left|\\sigma_1' - \\sigma_3'\\right|$.\n- The equivalent strain controlling damage is defined from the deviatoric strain as $\\varepsilon_{\\mathrm{eq}} = \\sqrt{\\tfrac{2}{3}} \\, \\sqrt{\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} : \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}}$, where $\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I}$.\n- The damage-driving history variable is $\\kappa(t) = \\max_{0 \\le \\tau \\le t} \\varepsilon_{\\mathrm{eq}}(\\tau)$ and the damage evolution is prescribed as $d(\\kappa) = 1 - \\exp\\!\\left(-\\left(\\dfrac{\\kappa}{\\kappa_0}\\right)^m\\right)$, capped by a maximum $d_{\\max} \\in [0,1)$ to avoid loss of ellipticity.\n\nSimulation setting to be implemented:\n- Kinematics and loading: impose a monotonically increasing axial strain path $\\varepsilon_1$ from $0$ to a specified final value in $N$ uniform increments. Enforce constant total radial stress $\\sigma_3$ equal to the given confining pressure and prescribed constant pore pressure $u$. At each increment, solve for the unknown radial strain $\\varepsilon_3$ and compute the corresponding effective stresses and invariants.\n- State update: within each increment, treat the dependence of $d$ on the current equivalent strain implicitly by a fixed-point iteration on $d$ until convergence. Initialize $d$ from the previous increment. Use a convergence tolerance on $|d^{k+1}-d^k|$ of $10^{-10}$ and a maximum of $200$ iterations per increment. Enforce $d \\le d_{\\max}$.\n\nPhysical and numerical units:\n- Express all stresses, including $p'$ and $q$, in kilopascals (kPa).\n- Express all strains as dimensionless quantities.\n\nTest suite:\nImplement your program to run the following three cases. Each case uses a uniform grid of $N$ increments in axial strain.\n\n- Case 1 (general behavior):\n    - $E = 10000$ kPa, $\\nu = 0.25$,\n    - $\\kappa_0 = 0.005$, $m = 2.0$, $d_{\\max} = 0.99$,\n    - Confined total radial stress $\\sigma_3 = 100$ kPa,\n    - Pore pressure $u = 0$ kPa,\n    - Final axial strain $\\varepsilon_{1,\\mathrm{end}} = 0.01$, $N = 50$.\n\n- Case 2 (nearly elastic with nonzero pore pressure):\n    - $E = 10000$ kPa, $\\nu = 0.25$,\n    - $\\kappa_0 = 1000.0$, $m = 2.0$, $d_{\\max} = 0.99$,\n    - Confined total radial stress $\\sigma_3 = 100$ kPa,\n    - Pore pressure $u = 50$ kPa,\n    - Final axial strain $\\varepsilon_{1,\\mathrm{end}} = 0.005$, $N = 50$.\n\n- Case 3 (rapid damage growth):\n    - $E = 10000$ kPa, $\\nu = 0.25$,\n    - $\\kappa_0 = 0.0001$, $m = 1.0$, $d_{\\max} = 0.95$,\n    - Confined total radial stress $\\sigma_3 = 100$ kPa,\n    - Pore pressure $u = 0$ kPa,\n    - Final axial strain $\\varepsilon_{1,\\mathrm{end}} = 0.01$, $N = 50$.\n\nRequired outputs:\n- For each case, after completing the loading to the final axial strain, report a list containing three values:\n    1. The final mean effective stress $p'$ in kPa,\n    2. The final deviatoric effective stress $q$ in kPa,\n    3. The final radial strain $\\varepsilon_3$ as a dimensionless number.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of the three-element lists for each case, enclosed in square brackets. For example: \"[[p1,q1,eps3_1],[p2,q2,eps3_2],[p3,q3,eps3_3]]\", where each $p_i$ and $q_i$ is in kPa and each $\\varepsilon_{3,i}$ is dimensionless.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of continuum damage mechanics and effective stress theory as applied to geomechanics. It is well-posed, providing a complete and consistent set of governing equations, material parameters, and loading conditions for a deterministic simulation. The problem statement is objective and uses precise, standard terminology. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe solution involves implementing a numerical simulation of an axisymmetric drained triaxial compression test. The material behavior is governed by isotropic linear elasticity coupled with an isotropic scalar damage model. A strain-driven incremental approach is adopted, where at each increment of axial strain, the corresponding radial strain and damage state are solved implicitly.\n\n**1. Governing Equations in Axisymmetric Form**\n\nThe simulation is based on the following specialized equations for the axisymmetric case, with the sign convention that compression is positive.\n\n- **Effective Stress Principle**: The relationship between the total stress tensor $\\boldsymbol{\\sigma}$, the effective stress tensor $\\boldsymbol{\\sigma}'$, and pore pressure $u$ is given by the standard principle $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - u \\mathbf{I}$. In principal components, this is:\n  $$ \\sigma'_1 = \\sigma_1 - u $$\n  $$ \\sigma'_3 = \\sigma_3 - u $$\n  where $\\sigma_1$ and $\\sigma_3$ are the axial and radial total stresses, respectively, and $\\sigma'_1$ and $\\sigma'_3$ are the corresponding effective stresses. Since the total radial stress $\\sigma_3$ and pore pressure $u$ are prescribed as constants, the effective radial stress $\\sigma'_3$ is also constant throughout the simulation. Let us denote this target value as $\\sigma'_{3,\\text{target}} = \\sigma_3 - u$.\n\n- **Constitutive Law**: The damaged elastic stress-strain relationship, $\\boldsymbol{\\sigma}' = (1-d)[\\lambda \\mathrm{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I} + 2\\mu\\boldsymbol{\\varepsilon}]$, gives the following for the principal effective stresses under axisymmetry ($\\varepsilon_2=\\varepsilon_3$):\n  $$ \\sigma'_1 = (1-d)[(\\lambda+2\\mu)\\varepsilon_1 + 2\\lambda\\varepsilon_3] $$\n  $$ \\sigma'_3 = (1-d)[\\lambda\\varepsilon_1 + 2(\\lambda+\\mu)\\varepsilon_3] $$\n  where $d$ is the scalar damage variable, $\\varepsilon_1$ and $\\varepsilon_3$ are the axial and radial strains, and $\\lambda$ and $\\mu$ are the Lamé parameters, defined in terms of Young's modulus $E$ and Poisson's ratio $\\nu$ as:\n  $$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\n  $$ \\mu = \\frac{E}{2(1+\\nu)} $$\n\n- **Damage Driving Strain and Evolution**: The equivalent strain $\\varepsilon_{\\mathrm{eq}}$ that drives damage is derived from the deviatoric strain tensor. For the axisymmetric case, this simplifies to:\n  $$ \\varepsilon_{\\mathrm{eq}} = \\frac{2}{3}|\\varepsilon_1 - \\varepsilon_3| $$\n  The damage evolution is governed by a history variable $\\kappa$, which tracks the maximum equivalent strain experienced by the material, and a damage law $d(\\kappa)$:\n  $$ \\kappa(t) = \\max_{0 \\le \\tau \\le t} \\varepsilon_{\\mathrm{eq}}(\\tau) $$\n  $$ d(\\kappa) = \\min\\left(d_{\\max}, 1 - \\exp\\left(-\\left(\\frac{\\kappa}{\\kappa_0}\\right)^m\\right)\\right) $$\n  where $\\kappa_0$, $m$, and $d_{\\max}$ are material parameters.\n\n**2. Numerical Algorithm**\n\nThe simulation proceeds in two main stages: an initial confinement step and an incremental loading phase.\n\n**2.1. Initial State Calculation (Confinement)**\n\nBefore the axial strain $\\varepsilon_1$ is applied, the specimen is subjected to the constant confining total stress $\\sigma_3$ and pore pressure $u$. This induces an initial state of strain and possibly damage. At this stage, $\\varepsilon_1 = 0$. The unknowns are the initial radial strain $\\varepsilon_{3,0}$ and initial damage $d_0$. They are determined by solving the following coupled non-linear system:\n$$ \\sigma'_{3,\\text{target}} = (1-d_0)[2(\\lambda+\\mu)\\varepsilon_{3,0}] $$\n$$ d_0 = \\min\\left(d_{\\max}, 1 - \\exp\\left(-\\left(\\frac{\\frac{2}{3}|\\varepsilon_{3,0}|}{\\kappa_0}\\right)^m\\right)\\right) $$\nThis system is solved using the prescribed fixed-point iteration on the damage variable $d_0$.\n1.  Initialize with a guess $d_0^{(k=0)} = 0$.\n2.  Iterate for $k=0, 1, 2, \\dots$:\n    a.  Calculate radial strain: $\\varepsilon_{3,0}^{(k)} = \\frac{\\sigma'_{3,\\text{target}}}{(1-d_0^{(k)}) \\cdot 2(\\lambda+\\mu)}$.\n    b.  Calculate equivalent strain: $\\varepsilon_{\\text{eq},0}^{(k)} = \\frac{2}{3}|\\varepsilon_{3,0}^{(k)}|$.\n    c.  Update damage: $d_0^{(k+1)} = \\min\\left(d_{\\max}, 1 - \\exp\\left(-\\left(\\frac{\\varepsilon_{\\text{eq},0}^{(k)}}{\\kappa_0}\\right)^m\\right)\\right)$.\n    d.  Check for convergence: if $|d_0^{(k+1)} - d_0^{(k)}| < 10^{-10}$, the iteration is complete.\nThe converged values $d_0$ and $\\varepsilon_{3,0}$ define the initial state. The initial damage history is set to $\\kappa_{hist} = \\frac{2}{3}|\\varepsilon_{3,0}|$.\n\n**2.2. Incremental Loading Phase**\n\nThe axial strain is increased from $\\varepsilon_1=0$ to $\\varepsilon_{1,\\text{end}}$ in $N$ uniform increments, $\\Delta\\varepsilon_1 = \\varepsilon_{1,\\text{end}}/N$. For each increment $i = 1, \\dots, N$, the axial strain is $\\varepsilon_{1,i} = i \\cdot \\Delta\\varepsilon_1$. The task within each increment is to find the corresponding radial strain $\\varepsilon_{3,i}$ and damage $d_i$, given the state from the previous increment ($d_{i-1}$, $\\kappa_{hist, i-1}$).\n\nThe governing equations for increment $i$ are:\n$$ \\sigma'_{3,\\text{target}} = (1-d_i)[\\lambda\\varepsilon_{1,i} + 2(\\lambda+\\mu)\\varepsilon_{3,i}] $$\n$$ d_i = \\min\\left(d_{\\max}, 1 - \\exp\\left(-\\left(\\frac{\\kappa_i}{\\kappa_0}\\right)^m\\right)\\right) \\quad \\text{where} \\quad \\kappa_i = \\max(\\kappa_{hist, i-1}, \\varepsilon_{\\text{eq},i}) $$\nAgain, a fixed-point iteration is used to solve this coupled system for $d_i$ and $\\varepsilon_{3,i}$.\n1.  Initialize the damage guess with the value from the previous step: $d_i^{(k=0)} = d_{i-1}$.\n2.  Iterate for $k=0, 1, 2, \\dots$:\n    a. Rearrange the first equation to solve for radial strain based on the current damage guess $d_i^{(k)}$:\n       $$ \\varepsilon_{3,i}^{(k)} = \\frac{1}{2(\\lambda+\\mu)} \\left( \\frac{\\sigma'_{3,\\text{target}}}{1-d_i^{(k)}} - \\lambda\\varepsilon_{1,i} \\right) $$\n    b. Calculate the current equivalent strain: $\\varepsilon_{\\text{eq},i}^{(k)} = \\frac{2}{3}|\\varepsilon_{1,i} - \\varepsilon_{3,i}^{(k)}|$.\n    c. Update the history variable for this iteration: $\\kappa_i^{(k)} = \\max(\\kappa_{hist, i-1}, \\varepsilon_{\\text{eq},i}^{(k)})$.\n    d. Calculate the new damage estimate: $d_i^{(k+1)} = \\min\\left(d_{\\max}, 1 - \\exp\\left(-\\left(\\frac{\\kappa_i^{(k)}}{\\kappa_0}\\right)^m\\right)\\right)$.\n    e. Check for convergence: if $|d_i^{(k+1)} - d_i^{(k)}| < 10^{-10}$, exit the loop.\n3.  Upon convergence, the state for the current increment is known: ($\\varepsilon_{1,i}$, $\\varepsilon_{3,i}$, $d_i$). The history variable is updated for the next step: $\\kappa_{hist, i} = \\max(\\kappa_{hist, i-1}, \\varepsilon_{\\text{eq},i})$.\n\n**3. Final Output Calculation**\n\nAfter completing all $N$ increments, the final state is characterized by $\\varepsilon_{1,N} = \\varepsilon_{1,\\text{end}}$, $\\varepsilon_{3,N}$, and $d_N$. The final effective stresses are calculated as:\n$$ \\sigma'_{1,N} = (1-d_N)[(\\lambda+2\\mu)\\varepsilon_{1,N} + 2\\lambda\\varepsilon_{3,N}] $$\n$$ \\sigma'_{3,N} = \\sigma'_{3,\\text{target}} $$\nThe final stress invariants required for the output are then computed:\n$$ p'_{\\text{final}} = \\frac{1}{3}(\\sigma'_{1,N} + 2\\sigma'_{3,N}) $$\n$$ q_{\\text{final}} = |\\sigma'_{1,N} - \\sigma'_{3,N}| $$\nThe outputs for each test case are the list $[p'_{\\text{final}}, q_{\\text{final}}, \\varepsilon_{3,N}]$.",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(E, nu, kappa0, m, d_max, sigma3_conf, u, eps1_end, N):\n    \"\"\"\n    Performs an axisymmetric drained triaxial compression simulation.\n\n    Args:\n        E (float): Young's modulus [kPa]\n        nu (float): Poisson's ratio\n        kappa0 (float): Damage model parameter\n        m (float): Damage model parameter\n        d_max (float): Maximum allowed damage\n        sigma3_conf (float): Confining total radial stress [kPa]\n        u (float): Pore pressure [kPa]\n        eps1_end (float): Final axial strain\n        N (int): Number of increments\n\n    Returns:\n        tuple: (final p', final q, final eps3)\n    \"\"\"\n    # Numerical parameters\n    TOL = 1e-10\n    MAX_ITER = 200\n\n    # Pre-compute elastic constants and fixed stress values\n    lambda_ = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    mu = E / (2 * (1 + nu))\n    sigma3_eff_target = sigma3_conf - u\n\n    # --- Step 1: Initial state calculation (confinement at eps1 = 0) ---\n    d_init = 0.0\n    eps3_init = 0.0\n    kappa_hist = 0.0\n\n    d_k = 0.0\n    for _ in range(MAX_ITER):\n        # Avoid division by zero when d approaches 1\n        if (1.0 - d_k)  TOL:\n            d_k = 1.0 - TOL\n\n        eps3_k = sigma3_eff_target / ((1.0 - d_k) * 2.0 * (lambda_ + mu))\n        eeq_k = (2.0 / 3.0) * abs(eps3_k) # eps1 is 0\n        \n        # kappa is simply eeq_k since history starts from 0\n        kappa_k = eeq_k\n        \n        if kappa_k / kappa0  TOL:\n             d_kp1 = 0.0\n        else:\n            d_kp1 = 1.0 - np.exp(-((kappa_k / kappa0)**m))\n        \n        d_kp1 = min(d_kp1, d_max)\n        \n        if abs(d_kp1 - d_k)  TOL:\n            break\n        d_k = d_kp1\n    \n    d_init = d_kp1\n    eps3_init = sigma3_eff_target / ((1.0 - d_init) * 2.0 * (lambda_ + mu))\n    kappa_hist = (2.0 / 3.0) * abs(eps3_init)\n    \n    # --- Step 2: Incremental loading ---\n    d_prev = d_init\n    eps1_increments = np.linspace(0, eps1_end, N + 1)[1:] # Start from first non-zero step\n    \n    eps3_final = eps3_init\n    d_final = d_init\n\n    for eps1_i in eps1_increments:\n        d_k = d_prev  # Initial guess for the current increment\n        for _ in range(MAX_ITER):\n            if (1.0 - d_k)  TOL:\n                d_k = 1.0 - TOL\n\n            # Solve for eps3 based on current damage guess d_k\n            eps3_i_k = (1.0 / (2.0 * (lambda_ + mu))) * \\\n                       (sigma3_eff_target / (1.0 - d_k) - lambda_ * eps1_i)\n\n            # Calculate equivalent strain and update history variable\n            eeq_i_k = (2.0 / 3.0) * abs(eps1_i - eps3_i_k)\n            kappa_i_k = max(kappa_hist, eeq_i_k)\n            \n            # Update damage\n            if kappa_i_k / kappa0  TOL:\n                d_kp1 = 0.0\n            else:\n                d_kp1 = 1.0 - np.exp(-((kappa_i_k / kappa0)**m))\n            \n            d_kp1 = min(d_kp1, d_max)\n            \n            if abs(d_kp1 - d_k)  TOL:\n                break\n            d_k = d_kp1\n        \n        # Converged values for this increment\n        d_final = d_kp1\n        eps3_final = (1.0 / (2.0 * (lambda_ + mu))) * \\\n                     (sigma3_eff_target / (1.0 - d_final) - lambda_ * eps1_i)\n\n        # Update history for next increment\n        eeq_final = (2.0 / 3.0) * abs(eps1_i - eps3_final)\n        kappa_hist = max(kappa_hist, eeq_final)\n        d_prev = d_final\n\n    # --- Step 3: Final output calculation ---\n    eps1_final = eps1_end\n    \n    sigma1_eff_final = (1.0 - d_final) * \\\n                       ((lambda_ + 2.0 * mu) * eps1_final + 2.0 * lambda_ * eps3_final)\n    sigma3_eff_final = sigma3_eff_target\n    \n    p_eff_final = (1.0 / 3.0) * (sigma1_eff_final + 2.0 * sigma3_eff_final)\n    q_final = abs(sigma1_eff_final - sigma3_eff_final)\n    \n    return p_eff_final, q_final, eps3_final\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: general behavior\n        {'E': 10000.0, 'nu': 0.25, 'kappa0': 0.005, 'm': 2.0, 'd_max': 0.99,\n         'sigma3_conf': 100.0, 'u': 0.0, 'eps1_end': 0.01, 'N': 50},\n        \n        # Case 2: nearly elastic with nonzero pore pressure\n        {'E': 10000.0, 'nu': 0.25, 'kappa0': 1000.0, 'm': 2.0, 'd_max': 0.99,\n         'sigma3_conf': 100.0, 'u': 50.0, 'eps1_end': 0.005, 'N': 50},\n        \n        # Case 3: rapid damage growth\n        {'E': 10000.0, 'nu': 0.25, 'kappa0': 0.0001, 'm': 1.0, 'd_max': 0.95,\n         'sigma3_conf': 100.0, 'u': 0.0, 'eps1_end': 0.01, 'N': 50},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        p_final, q_final, eps3_final = run_simulation(**params)\n        all_results.append(f\"[{p_final},{q_final},{eps3_final}]\")\n        \n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}