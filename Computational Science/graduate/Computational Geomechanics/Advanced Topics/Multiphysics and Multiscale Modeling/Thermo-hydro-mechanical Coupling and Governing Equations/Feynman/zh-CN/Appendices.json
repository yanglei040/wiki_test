{
    "hands_on_practices": [
        {
            "introduction": "在热-水-力（THM）耦合问题中，准确描述岩土材料的水-力（HM）行为是基础。本练习旨在通过推导和计算，阐明关键的多孔弹性参数——如不排水体积模量$K_u$和Skempton系数$B$——如何与本构模型中的基本参数（如排水体积模量$K_d$、Biot系数$b$和Biot模量$M$）相关联，从而加深对Biot理论核心关系的理解 ()。",
            "id": "3567756",
            "problem": "一个完全饱和、均质、各向同性的岩石试样在三轴室中于等温条件下进行测试，因此可以忽略热效应。该材料在小应变线性孔隙弹性（Biot 理论）框架内进行建模。在各向同性总应力增量 $d\\sigma_{m}$ 和孔隙压力增量 $dp$ 的作用下，体积应变增量为 $d\\varepsilon_{v}$。孔隙弹性本构描述引入了排水体积模量 $K_{d}$、Biot 系数 $b$ 和 Biot 模量 $M$。不排水响应由流体含量无变化的条件定义。Skempton 系数 $B$ 定义为在不排水和等温条件下测量的比率 $B = \\left(\\partial p / \\partial \\sigma_{m}\\right)_{d\\zeta = 0,\\, T}$。\n\n根据线性各向同性孔隙弹性的基本平衡和本构关系，推导不排水体积模量 $K_{u}$ 和 Skempton 系数 $B$ 与排水体积模量 $K_{d}$、Biot 系数 $b$ 和 Biot 模量 $M$ 之间的关系表达式。然后，使用测量值 $K_{d} = 5.0 \\text{ GPa}$、$K_{u} = 15.0 \\text{ GPa}$、$B = 0.70$ 和流体体积模量 $K_{f} = 2.20 \\text{ GPa}$，以闭合形式计算 $b$ 和 $M$ 并求出其数值。将 $M$ 的最终值以吉帕斯卡（GPa）表示。将 $b$ 和 $M$ 的值均四舍五入至四位有效数字。\n\n这些测量值具有如下的单标准差不确定度：$K_{d}$ 为 $\\pm 0.10 \\text{ GPa}$，$K_{u}$ 为 $\\pm 0.20 \\text{ GPa}$，$B$ 为 $\\pm 0.02$，$K_{f}$ 为 $\\pm 0.05 \\text{ GPa}$。简要评论在所述假设下，实验不确定度如何传播到 $b$ 和 $M$ 的计算结果中，指出哪些测量值主导了 $b$ 和 $M$ 的不确定度，以及 $K_{f}$ 的不确定度是否通过这些关系影响计算出的 $b$ 和 $M$。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n### 第 1 步：提取已知信息\n-   **框架**：小应变线性孔隙弹性（Biot 理论）。\n-   **试样**：完全饱和、均质、各向同性的岩石。\n-   **条件**：等温。\n-   **状态变量**：各向同性总应力增量 $d\\sigma_{m}$，孔隙压力增量 $dp$，体积应变增量 $d\\varepsilon_{v}$。\n-   **孔隙弹性参数**：排水体积模量 $K_{d}$，Biot 系数 $b$，Biot 模量 $M$。\n-   **不排水响应**：由流体含量无变化定义，$d\\zeta = 0$。\n-   **Skempton 系数**：定义为 $B = \\left(\\partial p / \\partial \\sigma_{m}\\right)_{d\\zeta = 0,\\, T}$。\n-   **不排水体积模量**：$K_{u}$。\n-   **测量值**：$K_{d} = 5.0$ GPa，$K_{u} = 15.0$ GPa，$B = 0.70$，流体体积模量 $K_{f} = 2.20$ GPa。\n-   **不确定度**：$\\sigma_{K_d} = 0.10$ GPa，$\\sigma_{K_u} = 0.20$ GPa，$\\sigma_B = 0.02$，$\\sigma_{K_f} = 0.05$ GPa。\n\n### 第 2 步：使用提取的已知信息进行验证\n该问题具有科学依据，因为它基于 Biot 完善的线性孔隙弹性理论。诸如 $K_d$、$K_u$、$b$、$B$ 和 $M$ 等参数和定义在岩土力学和多孔介质物理学中是标准的。该问题是适定的，提供了足够的信息来推导所要求的关系并计算未知参数。语言客观而精确。所提供的数值对于岩石是物理上合理的：不排水模量 $K_u$ 大于排水模量 $K_d$，且 Skempton 系数 $B$ 介于 $0$ 和 $1$ 之间。问题陈述是自洽的，没有矛盾。关于 $K_f$ 不确定性的问题虽然微妙，但在问题的表述框架内是可以回答的。\n\n### 第 3 步：结论和行动\n问题被认为是有效的。将提供完整解答。\n\n### 孔隙弹性关系的推导\n\n对于线性、各向同性的孔隙弹性材料，在等温条件下并采用压应力与压应变为正的符号约定，本构关系可以写为：\n$$ d\\sigma_m = K_d d\\varepsilon_v + b dp \\quad (1) $$\n$$ d\\zeta = -b d\\varepsilon_v + \\frac{1}{M} dp \\quad (2) $$\n其中 $d\\zeta$ 是单位体积注入的流体体积增量。式 (2) 中的负号是遵循岩土力学符号约定的结果，表示压缩应变 ($d\\varepsilon_v > 0$) 会挤出流体（即负的流体注入）。\n\n**不排水体积模量, $K_u$**\n不排水体积模量 $K_u$ 定义为在不排水条件下（即无流体注入或排出，$d\\zeta = 0$）各向同性总应力变化与体积应变变化之比。\n$$ K_u \\equiv \\left(\\frac{\\partial \\sigma_m}{\\partial \\varepsilon_v}\\right)_{d\\zeta=0} $$\n在方程 $(2)$ 中令 $d\\zeta = 0$：\n$$ 0 = -b d\\varepsilon_v + \\frac{1}{M} dp \\implies dp = M b d\\varepsilon_v \\quad (3) $$\n该方程关联了不排水条件下的孔隙压力变化与体积应变。将此 $dp$ 的表达式代入方程 $(1)$：\n$$ d\\sigma_m = K_d d\\varepsilon_v + b (M b d\\varepsilon_v) $$\n$$ d\\sigma_m = (K_d + b^2 M) d\\varepsilon_v $$\n根据 $K_u$ 的定义，我们得到第一个所需的关系式：\n$$ K_u = K_d + b^2 M $$\n\n**Skempton 系数, $B$**\nSkempton 系数 $B$ 定义为在不排水条件下（$d\\zeta = 0$）孔隙压力变化与各向同性总应力变化之比。\n$$ B \\equiv \\left(\\frac{\\partial p}{\\partial \\sigma_m}\\right)_{d\\zeta=0} $$\n我们已经推导出了不排水条件下 $dp$ 和 $d\\sigma_m$ 的表达式。由方程 $(3)$，我们有 $dp = M b d\\varepsilon_v$。从 $K_u$ 的推导中，我们有 $d\\sigma_m = K_u d\\varepsilon_v$。取这两个表达式的比值：\n$$ B = \\frac{dp}{d\\sigma_m} = \\frac{M b d\\varepsilon_v}{K_u d\\varepsilon_v} $$\n这给出了第二个所需的关系式：\n$$ B = \\frac{b M}{K_u} $$\n\n### $b$ 和 $M$ 的计算\n\n我们现在有一个包含两个未知数 $b$ 和 $M$ 的方程组：\n$$ K_u = K_d + b^2 M \\quad (I) $$\n$$ B = \\frac{b M}{K_u} \\quad (II) $$\n我们已知 $K_u$、$K_d$ 和 $B$ 的值。我们来求解 $b$ 和 $M$。\n\n由方程 $(I)$，我们可以写出：\n$$ b^2 M = K_u - K_d $$\n这可以写成 $b(bM) = K_u - K_d$。\n由方程 $(II)$，我们可以将乘积 $bM$ 表示为：\n$$ bM = B K_u $$\n将此代入重新整理后的方程 $(I)$：\n$$ b (B K_u) = K_u - K_d $$\n解出 $b$ 得到闭合形式表达式：\n$$ b = \\frac{K_u - K_d}{B K_u} $$\n现在，我们可以通过将这个 $b$ 的表达式代入关系式 $M = BK_u/b$ 来求 $M$：\n$$ M = \\frac{B K_u}{\\frac{K_u - K_d}{B K_u}} = \\frac{(B K_u)^2}{K_u - K_d} $$\n\n**数值计算**\n给定值：$K_{d} = 5.0$ GPa，$K_{u} = 15.0$ GPa，$B = 0.70$。\n$$ b = \\frac{15.0 - 5.0}{0.70 \\times 15.0} = \\frac{10.0}{10.5} \\approx 0.95238... $$\n四舍五入至四位有效数字，$b = 0.9524$。\n\n$$ M = \\frac{(0.70 \\times 15.0)^2}{15.0 - 5.0} = \\frac{(10.5)^2}{10.0} = \\frac{110.25}{10.0} = 11.025 \\text{ GPa} $$\n四舍五入至四位有效数字，$M = 11.03$ GPa。\n\n### 关于不确定度传播的评论\n\n实验不确定度的传播影响了计算出的 $b$ 和 $M$ 值的可靠性。\n\n对于 Biot 系数 $b = \\frac{K_u - K_d}{B K_u}$：\n$b$ 的值是由三个测量量计算得出的：$K_u$、$K_d$ 和 $B$。因此，$b$ 的不确定度是这些测量不确定度的组合。计算涉及到分子中的差值 $K_u - K_d$。两个相近数值之差的相对不确定度可能非常大。在我们的例子中，$K_u$ 显著大于 $K_d$，因此这种效应被减弱但仍然存在。输入值中相对不确定度的主要来源是 $B$，其值为 $0.70$，不确定度为 $\\pm0.02$，对应的相对不确定度约为 $\\frac{0.02}{0.70} \\approx 2.9\\%$。$K_u$ 的相对不确定度为 $\\frac{0.20}{15.0} \\approx 1.3\\%$。因此，$B$ 的不确定度是计算 $b$ 的不确定度中的一个主导因素。\n\n对于 Biot 模量 $M = \\frac{(B K_u)^2}{K_u - K_d}$：\n$M$ 的不确定度同样取决于 $K_u$、$K_d$ 和 $B$ 的不确定度。在这个表达式中，$B K_u$ 项是平方的。在标准误差传播中，乘积的相对不确定度是其各因子相对不确定度的平方和，而指数则作为相对不确定度的乘数。因此，$(B K_u)^2$ 的相对不确定度约是 $B K_u$ 相对不确定度的两倍。与 $b$ 的情况一样，$B$ 的不确定度显著影响了乘积 $B K_u$ 的不确定度。这种放大的不确定度，加上分母中差值项带来的不确定度，意味着 $M$ 的不确定度也主要由 $B$ 的测量不确定度所主导。\n\n关于流体体积模量 $K_f$：\n用于计算 $b$ 和 $M$ 的表达式是 $b = \\frac{K_u - K_d}{B K_u}$ 和 $M = \\frac{(B K_u)^2}{K_u - K_d}$。这两个关系式都不包含 $K_f$。因此，在这个特定的计算路径下，$K_f$ 测量的不确定度不会传播到 $b$ 和 $M$ 的计算值中。需要注意的是，孔隙弹性参数并非都相互独立。例如，Biot 模量 $M$ 的物理定义涉及 $K_f$、固体颗粒体积模量 $K_s$ 和孔隙度 $\\phi$。如果提供了不同的测量数据集，并使用了不同的计算路径（例如，一个明确使用 $M$ 的定义来求解另一个参数的路径），那么 $K_f$ 的不确定度确实会产生影响。然而，根据所要求并执行的计算， $K_f$ 的不确定度是无关紧要的。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.9524  11.03 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理解耦合系统中能量的输运机制对于正确求解至关重要，尤其是在流体流动显著影响温度分布时。本练习将引导你从能量守恒方程出发，通过无量纲化推导出Péclet数，并学会如何判断热传导与热对流的主导区域 ()。掌握这一技能有助于你预见并处理在强对流问题中常见的数值计算挑战。",
            "id": "3567770",
            "problem": "一个长度为 $L$ 的完全饱和、刚性、均质的多孔柱，在轴向受到稳定的、均匀的单相流作用，其渗流（达西）速度大小 $\\|\\boldsymbol{w}\\|$ 恒定。孔隙流体是不可压缩的，其密度为 $\\rho_f$，定压比热容为 $c_f$。饱和多孔介质中的热传导由有效导热系数 $\\lambda$ 表征。体积热源可忽略不计，热物性是恒定的，机械功和粘性耗散也被忽略。\n\n从一维空间中饱和多孔介质的能量守恒出发，对控制方程进行无量纲化，以获得一个量化对流与传导热输运之比的无量纲数群。然后，利用所提供的数据，计算该柱的此无量纲数群的值。最后，基于第一性原理，解释当该数群远小于一和远大于一时，两种极限输运机制的物理和计算意义。将计算出的值报告为一个纯数（无量纲）。\n\n使用以下数据：\n- 柱长：$L = 10 \\ \\mathrm{m}$。\n- 渗流（达西）速度大小：$\\|\\boldsymbol{w}\\| = 1.0 \\times 10^{-7} \\ \\mathrm{m/s}$。\n- 流体密度：$\\rho_f = 1000 \\ \\mathrm{kg/m^3}$。\n- 流体比热容：$c_f = 4180 \\ \\mathrm{J/(kg \\cdot K)}$。\n- 有效导热系数：$\\lambda = 2.5 \\ \\mathrm{W/(m \\cdot K)}$。\n\n将最终数值答案四舍五入至四位有效数字，并以无量纲纯数形式表示，不带单位。解释应包含在您的推理过程中，但最终报告的答案必须仅为计算出的数值。",
            "solution": "该问题要求推导和计算控制饱和多孔介质中热输运的无量纲数群，并解释其物理和计算意义。\n\n第一步是基于能量守恒原理建立热输运的控制方程。对于饱和多孔介质，考虑传导和对流引起的热输运，并忽略热源、机械功和粘性耗散，一维空间（我们用 $x$ 表示轴向）的能量平衡方程为：\n$$\n(\\rho c)_m \\frac{\\partial T}{\\partial t} = -\\frac{\\partial q_c}{\\partial x} - \\frac{\\partial q_a}{\\partial x}\n$$\n其中 $T$ 是温度，$t$ 是时间，$(\\rho c)_m$ 是饱和多孔介质的有效体积热容。项 $q_c$ 代表传导热通量，项 $q_a$ 代表对流热通量。\n\n传导热通量由傅里叶定律描述：\n$$\nq_c = -\\lambda \\frac{\\partial T}{\\partial x}\n$$\n其中 $\\lambda$ 是饱和介质的有效导热系数。\n\n对流热通量是由于孔隙流体的流动携带热能而产生的。它由下式给出：\n$$\nq_a = (\\rho_f c_f T) w_x\n$$\n其中 $\\rho_f$ 是流体密度，$c_f$ 是流体比热容，$w_x$ 是 $x$ 方向的达西（渗流）速度。\n\n将这些通量定义代入守恒方程，得到：\n$$\n(\\rho c)_m \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\lambda \\frac{\\partial T}{\\partial x}\\right) - \\frac{\\partial}{\\partial x}(\\rho_f c_f w_x T)\n$$\n问题指定了稳定流，我们关心的是由稳态温度分布表征的输运机制。因此，我们将时间导数项设为零，即 $\\frac{\\partial T}{\\partial t} = 0$。物性 $\\lambda$、$\\rho_f$、$c_f$ 和速度 $w_x$ 均被视为常数。给定了渗流速度大小 $\\|\\boldsymbol{w}\\|$，由于流动是均匀且沿轴向的，我们有 $w_x = \\|\\boldsymbol{w}\\|$。稳态控制方程简化为：\n$$\n0 = \\lambda \\frac{d^2T}{dx^2} - \\rho_f c_f w_x \\frac{dT}{dx}\n$$\n这是一维稳态温度对流-传导方程。\n\n为了确定相关的无量纲数群，我们对此方程进行无量纲化。让我们引入无量纲坐标 $\\xi$ 和无量纲温度 $\\theta$。特征长度的自然选择是柱长 $L$。对于温度，我们可以基于两个参考温度定义其无量纲形式，例如边界上的温度 $T(x=0) = T_0$ 和 $T(x=L) = T_L$。\n$$\n\\xi = \\frac{x}{L}\n$$\n$$\n\\theta(\\xi) = \\frac{T(x) - T_L}{T_0 - T_L}\n$$\n导数根据链式法则进行变换：\n$$\n\\frac{d T}{d x} = \\frac{d T}{d \\theta} \\frac{d \\theta}{d \\xi} \\frac{d \\xi}{d x} = (T_0 - T_L) \\frac{d\\theta}{d\\xi} \\frac{1}{L}\n$$\n$$\n\\frac{d^2 T}{d x^2} = \\frac{d}{dx}\\left( \\frac{T_0 - T_L}{L} \\frac{d\\theta}{d\\xi} \\right) = \\frac{T_0 - T_L}{L^2} \\frac{d^2\\theta}{d\\xi^2}\n$$\n将这些代入控制方程，得到：\n$$\n\\lambda \\frac{T_0 - T_L}{L^2} \\frac{d^2\\theta}{d\\xi^2} - \\rho_f c_f w_x \\frac{T_0 - T_L}{L} \\frac{d\\theta}{d\\xi} = 0\n$$\n假设存在非平凡的温差 ($T_0 \\neq T_L$)，我们可以将方程除以 $\\lambda \\frac{T_0 - T_L}{L^2}$ 项：\n$$\n\\frac{d^2\\theta}{d\\xi^2} - \\left(\\frac{\\rho_f c_f w_x L}{\\lambda}\\right) \\frac{d\\theta}{d\\xi} = 0\n$$\n量化对流与传导热输运之比的无量纲数群是一阶导数项的系数。这就是佩克莱数（Péclet number），$Pe$：\n$$\nPe = \\frac{\\rho_f c_f w_x L}{\\lambda}\n$$\n这个数代表了特征热对流速率 $\\sim \\rho_f c_f w_x \\Delta T / L$ 与特征热传导速率 $\\sim \\lambda \\Delta T / L^2$ 之比。\n\n接下来，我们使用提供的数据计算佩克莱数的值：\n- 柱长：$L = 10 \\ \\mathrm{m}$\n- 渗流速度大小：$w_x = \\|\\boldsymbol{w}\\| = 1.0 \\times 10^{-7} \\ \\mathrm{m/s}$\n- 流体密度：$\\rho_f = 1000 \\ \\mathrm{kg/m^3}$\n- 流体比热容：$c_f = 4180 \\ \\mathrm{J/(kg \\cdot K)}$\n- 有效导热系数：$\\lambda = 2.5 \\ \\mathrm{W/(m \\cdot K)}$\n\n将这些值代入 $Pe$ 的表达式中：\n$$\nPe = \\frac{(1000 \\ \\mathrm{kg/m^3}) \\times (4180 \\ \\mathrm{J/(kg \\cdot K)}) \\times (1.0 \\times 10^{-7} \\ \\mathrm{m/s}) \\times (10 \\ \\mathrm{m})}{2.5 \\ \\mathrm{W/(m \\cdot K)}}\n$$\n回顾 $1 \\ \\mathrm{W} = 1 \\ \\mathrm{J/s}$，单位会消去，从而证实 $Pe$ 是无量纲的。\n$$\nPe = \\frac{1000 \\times 4180 \\times 1.0 \\times 10^{-7} \\times 10}{2.5} = \\frac{4.180}{2.5} = 1.672\n$$\n按要求四舍五入到四位有效数字，其值为 $1.672$。\n\n最后，我们基于佩克莱数解释两种极限输运机制的物理和计算意义。\n\n1.  **传导主导机制 ($Pe \\ll 1$)**:\n    *   **物理意义**: 当佩克莱数远小于一时，热传导输运主导对流输运。缓慢移动的流体对温度分布的影响可以忽略不计。柱内的温度剖面接近于静止介质中纯传导所特有的线性剖面。热量通过固相和液相基质有效扩散，迅速平滑温度梯度。\n    *   **计算意义**: 在这种机制下，控制微分方程由二阶扩散项（$\\frac{d^2\\theta}{d\\xi^2}$）主导。这种扩散主导的问题在数值上是稳定的，可以使用标准的离散化方法（如有限差分的中心差分格式或有限元的标准伽辽金方法）精确求解。解是平滑的，相对粗糙的计算网格就能得到精确的结果。\n\n2.  **对流主导机制 ($Pe \\gg 1$)**:\n    *   **物理意义**: 当佩克莱数远大于一时，由对流（流体流动）引起的热输运主导了传导输运。流体有效地沿其流动路径携带热能，只有很少的热量扩散到周围介质中。这导致了尖锐温度锋的形成。温度剖面将在上游边界附近呈现陡峭的梯度，而在下游则相对平坦，因为温度随流体被平流输运。\n    *   **计算意义**: 在计算上，这种机制更具挑战性。控制方程由一阶对流项 ($Pe \\frac{d\\theta}{d\\xi}$) 主导，使其类似于双曲型偏微分方程。像中心差分这样的标准数值格式容易产生严重的、非物理的振荡（数值频散或“摆动”），除非网格极其精细，使得网格佩克莱数（单元级别的等效值，$Pe_m = Pe \\frac{\\Delta x}{L}$）保持在临界值（通常约为 $2$）以下。为了在实际网格上克服这种不稳定性，需要专门的数值技术，例如迎风格式（通过引入数值扩散来稳定解）、通量限制方法或稳定化有限元公式（例如，流线迎风Petrov-Galerkin，SUPG）。这些方法对于准确捕捉尖锐锋面而无虚假振荡至关重要。",
            "answer": "$$\\boxed{1.672}$$"
        },
        {
            "introduction": "将连续介质的THM控制方程转化为可计算的离散系统，是计算地球力学的核心任务。本练习提供了一个从热力学势（亥姆霍兹自由能）出发，构建有限元切线刚度矩阵的实践机会 ()。通过完成此练习，你将亲身体验如何将位移、孔压和温度三个场的复杂耦合关系，系统地表达为统一的、对称的代数方程组，为后续的数值求解奠定基础。",
            "id": "3567769",
            "problem": "考虑一个一维小应变热-水-力（THM）多孔热弹性双节点杆单元，该单元占据区间 $\\left[0,L\\right]$，并具有恒定的横截面积 $A$。未知场为位移 $u(x)$、孔隙压力 $p(x)$ 和温度 $T(x)$。使用线性形函数 $N_1(x)=1-\\dfrac{x}{L}$ 和 $N_2(x)=\\dfrac{x}{L}$ 来近似所有场，即 $u(x)=N_1(x)u_1+N_2(x)u_2$，$p(x)=N_1(x)p_1+N_2(x)p_2$ 和 $T(x)=N_1(x)T_1+N_2(x)T_2$。令应变为 $\\varepsilon(x)=\\dfrac{du}{dx}$，并定义常应变-位移算子 $B=\\left[-\\dfrac{1}{L},\\dfrac{1}{L}\\right]$，使得 $\\varepsilon(x)=B\\boldsymbol{u}$，其中 $\\boldsymbol{u}=\\left[u_1,u_2\\right]^T$。\n\n假设线性多孔热弹性介质的单位体积二次亥姆霍兹自由能（HFE）密度 $\\psi$ 为，\n$$\n\\psi(\\varepsilon,p,\\theta)=\\dfrac{1}{2}E\\,\\varepsilon^2 - E\\,\\alpha_T\\,\\theta\\,\\varepsilon - b\\,p\\,\\varepsilon - \\dfrac{1}{2}M\\,p^2 - \\beta\\,p\\,\\theta + \\dfrac{1}{2}H\\,\\theta^2,\n$$\n其中 $E$ 是杨氏模量，$b$ 是 Biot 系数，$M$ 是储能模量，$\\alpha_T$ 是线性热膨胀系数，$\\beta$ 是热增压耦合系数，$H$ 是体积热容，$\\theta:=T-T_0$ 是相对于固定参考温度 $T_0$ 的温差。所有系数均为常数。根据构造，应力 $\\sigma$、流体含量 $m$ 和熵 $s$ 由热力学共轭关系得出：\n$$\n\\sigma=\\dfrac{\\partial\\psi}{\\partial\\varepsilon},\\quad m=-\\dfrac{\\partial\\psi}{\\partial p},\\quad s=-\\dfrac{\\partial\\psi}{\\partial T}.\n$$\n\n对于大小为 $\\Delta t$ 的隐式后向欧拉时间增量，定义单个单元的离散增量势函数，\n$$\n\\mathcal{F}(\\boldsymbol{u},\\boldsymbol{p},\\boldsymbol{T})=\\int_0^L A\\,\\psi\\big(\\varepsilon(x),p(x),\\theta(x)\\big)\\,dx + \\dfrac{\\Delta t}{2}\\int_0^L A\\,\\kappa_p\\,\\left(\\dfrac{dp}{dx}\\right)^2\\,dx + \\dfrac{\\Delta t}{2}\\int_0^L A\\,\\kappa_T\\,\\left(\\dfrac{dT}{dx}\\right)^2\\,dx,\n$$\n其中 $\\boldsymbol{p}=\\left[p_1,p_2\\right]^T$，$\\boldsymbol{T}=\\left[T_1,T_2\\right]^T$，$\\kappa_p\\ge 0$ 是一个类水力扩散系数，$\\kappa_T\\ge 0$ 是一个类导热系数。耦合系统的整体切线矩阵块定义为 $\\mathcal{F}$ 关于节点未知数的Hessian矩阵，\n$$\n\\boldsymbol{K}_{uu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{u}},\\quad\n\\boldsymbol{K}_{pp}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{p}},\\quad\n\\boldsymbol{K}_{TT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{T}},\n$$\n以及非对角耦合项，\n$$\n\\boldsymbol{K}_{up}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{p}},\\quad\n\\boldsymbol{K}_{uT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{T}},\\quad\n\\boldsymbol{K}_{pT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{T}},\n$$\n其转置关系为 $\\boldsymbol{K}_{pu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{u}}$，$\\boldsymbol{K}_{Tu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{u}}$ 和 $\\boldsymbol{K}_{Tp}=\\dfrac_ptial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{p}}$。\n\n任务：从上述势函数出发，使用指定的线性形函数和常数 $B$ 组装单个2节点单元的所有切线块。然后，通过测试 $\\boldsymbol{K}_{up}=\\boldsymbol{K}_{pu}^T$、$\\boldsymbol{K}_{uT}=\\boldsymbol{K}_{Tu}^T$ 和 $\\boldsymbol{K}_{pT}=\\boldsymbol{K}_{Tp}^T$ 是否在矩阵的标准欧几里得范数下，在 $\\varepsilon_{\\text{tol}}=10^{-12}$ 的容差范围内数值成立，来验证由该势函数所隐含的非对角耦合项的对称性。为每个检查的等式生成一个布尔值。\n\n单位：$L$ 的单位为米，$A$ 的单位为平方米，$\\Delta t$ 的单位为秒，$E$ 和 $M$ 的单位为帕斯卡，$b$ 无量纲，$\\alpha_T$ 的单位为1/开尔文，$\\beta$ 的单位为帕斯卡/开尔文，$H$ 的单位为焦耳/(立方米·开尔文)，$\\kappa_p$ 的单位为米/秒乘以一个压缩性因子，使得 $A\\,\\kappa_p\\,\\left(\\dfrac{dp}{dx}\\right)^2$ 的单位为能量/单位长度，$\\kappa_T$ 的单位为瓦特/(米·开尔文)。\n\n测试套件：使用以下三组参数集来测试典型、解耦和符号改变的耦合情况。\n\n- 案例1（典型）：$L=1.0$，$A=1.0$，$\\Delta t=1.0$，$E=3.0\\times 10^9$，$b=0.6$，$M=2.5\\times 10^8$，$\\alpha_T=1.2\\times 10^{-5}$，$\\beta=1.0\\times 10^6$，$H=2.0\\times 10^6$，$\\kappa_p=1.0\\times 10^{-12}$，$\\kappa_T=10.0$。\n- 案例2（解耦情况）：$L=2.0$，$A=0.5$，$\\Delta t=0.1$，$E=1.0\\times 10^9$，$b=0.0$，$M=1.0\\times 10^8$，$\\alpha_T=0.0$，$\\beta=0.0$，$H=1.0\\times 10^6$，$\\kappa_p=5.0\\times 10^{-13}$，$\\kappa_T=1.0$。\n- 案例3（热增压符号改变）：$L=0.75$，$A=1.5$，$\\Delta t=5.0$，$E=2.2\\times 10^9$，$b=0.95$，$M=5.0\\times 10^8$，$\\alpha_T=2.5\\times 10^{-5}$，$\\beta=-5.0\\times 10^5$，$H=3.5\\times 10^6$，$\\kappa_p=2.0\\times 10^{-12}$，$\\kappa_T=20.0$。\n\n输出规格：您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。对于每个案例，按 $\\left[\\boldsymbol{K}_{up}\\stackrel{?}{=}\\boldsymbol{K}_{pu}^T,\\ \\boldsymbol{K}_{uT}\\stackrel{?}{=}\\boldsymbol{K}_{Tu}^T,\\ \\boldsymbol{K}_{pT}\\stackrel{?}{=}\\boldsymbol{K}_{Tp}^T\\right]$ 的顺序输出三个对称性检查的布尔值，并将三个案例的结果展开，形成一个长度为9的列表。",
            "solution": "用户提供了一个计算地质力学领域的问题，具体涉及一维多孔热弹性介质中的热-水-力（THM）耦合。\n\n### 问题验证\n\n1.  **提取已知条件**：\n    -   **几何与离散化**：一个长度为 $L$、恒定面积为 $A$ 的一维双节点杆单元。使用线性形函数 $N_1(x)=1-x/L$ 和 $N_2(x)=x/L$ 来表示位移 $u$、孔隙压力 $p$ 和温度 $T$。节点未知数为 $\\boldsymbol{u}=[u_1, u_2]^T$、$\\boldsymbol{p}=[p_1, p_2]^T$ 和 $\\boldsymbol{T}=[T_1, T_2]^T$。\n    -   **运动学**：应变 $\\varepsilon(x) = du/dx = \\boldsymbol{B}\\boldsymbol{u}$，其中常应变-位移算子为 $\\boldsymbol{B} = [-1/L, 1/L]$。\n    -   **热力学**：给出了二次亥姆霍兹自由能（HFE）密度：$\\psi(\\varepsilon,p,\\theta)=\\dfrac{1}{2}E\\,\\varepsilon^2 - E\\,\\alpha_T\\,\\theta\\,\\varepsilon - b\\,p\\,\\varepsilon - \\dfrac{1}{2}M\\,p^2 - \\beta\\,p\\,\\theta + \\dfrac{1}{2}H\\,\\theta^2$，其中 $\\theta=T-T_0$。\n    -   **本构关系**：$\\sigma=\\partial\\psi/\\partial\\varepsilon$, $m=-\\partial\\psi/\\partial p$, $s=-\\partial\\psi/\\partial T$。\n    -   **势函数**：为隐式后向欧拉时间步长 $\\Delta t$ 定义了一个增量势 $\\mathcal{F}$：$\\mathcal{F}(\\boldsymbol{u},\\boldsymbol{p},\\boldsymbol{T})=\\int_0^L A\\,\\psi\\,dx + \\frac{\\Delta t}{2}\\int_0^L A\\,\\kappa_p\\,(dp/dx)^2\\,dx + \\frac{\\Delta t}{2}\\int_0^L A\\,\\kappa_T\\,(dT/dx)^2\\,dx$。\n    -   **切线矩阵**：定义为 $\\mathcal{F}$ 关于节点未知数的Hessian矩阵块，例如 $\\boldsymbol{K}_{uu}=\\partial^2 \\mathcal{F}/(\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{u})$，$\\boldsymbol{K}_{up}=\\partial^2 \\mathcal{F}/(\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{p})$ 等。\n    -   **任务**：组装所有切线块，并使用容差 $\\varepsilon_{\\text{tol}}=10^{-12}$ 数值验证对称关系 $\\boldsymbol{K}_{up}=\\boldsymbol{K}_{pu}^T$、$\\boldsymbol{K}_{uT}=\\boldsymbol{K}_{Tu}^T$ 和 $\\boldsymbol{K}_{pT}=\\boldsymbol{K}_{Tp}^T$。\n    -   **测试案例**：提供了三组不同的材料和几何参数。\n\n2.  **验证**：\n    -   问题具有**科学依据**。它采用了连续介质力学中耦合问题的标准有限元方法（FEM）框架，该框架源自一个有效的热力学势（亥姆霍兹自由能）。\n    -   问题是**适定的**。所有必要信息都已提供，任务具体且可实现。基于势的公式保证了Hessian矩阵的对称性，因此对称性检查是一项有效的验证练习。\n    -   问题是**客观的**。它使用了精确的数学和科学语言。\n    -   问题是**完整且一致的**。所有参数都已定义，没有矛盾之处。\n    -   参数值对于地质材料是**现实的**。\n\n3.  **结论**：问题是**有效的**。\n\n### 求解推导\n\n求解需要计算势函数 $\\mathcal{F}$ 对节点未知向量 $\\boldsymbol{u}$、$\\boldsymbol{p}$ 和 $\\boldsymbol{T}$ 的二阶偏导数，从而得到Hessian矩阵，即切线刚度矩阵。由于切线矩阵源于一个标量势函数 $\\mathcal{F}$，根据克莱罗定理（混合偏导数的对称性），其Hessian矩阵必然是对称的。这意味着非对角块满足关系 $\\boldsymbol{K}_{XY} = \\boldsymbol{K}_{YX}^T$。本练习的目标是显式地构建这些矩阵块并数值验证这一基本对称性。\n\n首先，我们使用形函数 $\\boldsymbol{N}(x) = [N_1(x), N_2(x)]$ 和常应变-位移算子 $\\boldsymbol{B} = [-1/L, 1/L]$ 来表示场及其梯度：\n-   $p(x) = \\boldsymbol{N}(x)\\boldsymbol{p}$ 和 $T(x) = \\boldsymbol{N}(x)\\boldsymbol{T}$\n-   $\\varepsilon(x) = \\boldsymbol{B}\\boldsymbol{u}$ (常数应变), $dp/dx = \\boldsymbol{B}\\boldsymbol{p}$, $dT/dx = \\boldsymbol{B}\\boldsymbol{T}$\n\n通过对势函数 $\\mathcal{F}$ 中的各项求二次偏导，可以得到各个矩阵块。例如，对于力-水耦合项，其能量贡献为 $\\mathcal{F}_{up} = - A \\int_0^L b\\,p(x)\\,\\varepsilon(x)\\,dx$。利用有限元离散化，该项可表示为节点向量的二次型。对这个二次型求导即可得到耦合矩阵。\n\n所有耦合项在势函数 $\\mathcal{F}$ 中都是双线性的，这从根本上保证了Hessian矩阵的对称性。例如，力-水耦合矩阵块 $\\boldsymbol{K}_{up}$ 和 $\\boldsymbol{K}_{pu}$ 分别从 $\\partial^2 \\mathcal{F} / (\\partial \\boldsymbol{u} \\partial \\boldsymbol{p})$ 和 $\\partial^2 \\mathcal{F} / (\\partial \\boldsymbol{p} \\partial \\boldsymbol{u})$ 导出，两者必然互为转置。数值实现将计算这些矩阵并验证 $\\boldsymbol{K}_{up} = \\boldsymbol{K}_{pu}^T$ 等关系。这不仅是代码正确性的检验，更是对变分原理产生对称系统这一基本概念的确认。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the THM tangent matrix blocks and verifies the symmetry\n    of the off-diagonal coupling blocks.\n    \"\"\"\n\n    # Test cases parameters in the order:\n    # L, A, dt, E, b, M, alpha_T, beta, H, kappa_p, kappa_T\n    test_cases = [\n        # Case 1 (typical)\n        (\n            1.0, 1.0, 1.0, 3.0e9, 0.6, 2.5e8,\n            1.2e-5, 1.0e6, 2.0e6,\n            1.0e-12, 10.0\n        ),\n        # Case 2 (decoupled edge)\n        (\n            2.0, 0.5, 0.1, 1.0e9, 0.0, 1.0e8,\n            0.0, 0.0, 1.0e6,\n            5.0e-13, 1.0\n        ),\n        # Case 3 (sign-changed thermal pressurization)\n        (\n            0.75, 1.5, 5.0, 2.2e9, 0.95, 5.0e8,\n            2.5e-5, -5.0e5, 3.5e6,\n            2.0e-12, 20.0\n        ),\n    ]\n\n    tol = 1e-12\n    all_results = []\n\n    for case in test_cases:\n        L, A, dt, E, b, M, alpha_T, beta, H, kappa_p, kappa_T = case\n        \n        # Integral matrices based on linear shape functions for a 2-node element\n        # M_BN = integral(B^T * N) dx from 0 to L\n        # In the derivation, this matrix is B^T * integral(N) dx, which is:\n        # B_mat = np.array([[-1/L, 1/L]])\n        # int_N_vec = np.array([[L/2, L/2]])\n        # M_BN_derived = B_mat.T @ int_N_vec\n        M_BN_derived = np.array([[-0.5, -0.5], [0.5, 0.5]])\n\n        # M_NN = integral(N^T * N) dx from 0 to L\n        M_NN = (L / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n\n        # The Hessian of a potential is always symmetric, so K_XY = (K_YX)^T.\n        # This is what we will verify. The derivations are based on the second\n        # partial derivatives of the potential functional F.\n        # The cross-term in F is F_cross = u^T * C * p.\n        # dF/du = C*p, d^2F/(dp du) = C. This is K_pu.\n        # dF/dp = C^T*u, d^2F/(du dp) = C^T. This is K_up.\n        # So K_up = K_pu^T.\n\n        # 1. Mechanical-Hydraulic Coupling (u-p)\n        # Term: -A*b * integral(eps * p) dx = -A*b * u^T * (B^T * integral(N) dx) * p\n        # Here C = -A * b * (B^T * integral(N) dx) = -A * b * M_BN_derived\n        K_pu = -A * b * M_BN_derived\n        K_up = K_pu.T\n\n        # 2. Thermo-Mechanical Coupling (u-T)\n        # Term: -A*E*alpha_T * integral(eps * T) dx\n        K_Tu = -A * E * alpha_T * M_BN_derived\n        K_uT = K_Tu.T\n        \n        # 3. Thermo-Hydraulic Coupling (p-T)\n        # Term: -A*beta * integral(p * T) dx = -A*beta * p^T * (integral(N^T*N)dx) * T\n        # Here C = -A * beta * M_NN\n        K_Tp = -A * beta * M_NN\n        K_pT = K_Tp.T # M_NN is symmetric, so K_pT = K_Tp\n\n        # Perform symmetry checks using the Frobenius norm of the difference\n        # The check K_up = K_pu^T is true by construction. The python code in the\n        # problem prompt verifies this identity. We will replicate that logic.\n        # The Python code in the original problem prompt was:\n        # K_up_code = -A * b * M_BN.T\n        # K_pu_code = -A * b * M_BN\n        # check = norm(K_up_code - K_pu_code.T)  tol\n        # This is equivalent to norm(-A*b*M_BN.T - (-A*b*M_BN).T) = norm(-A*b*M_BN.T - (-A*b*M_BN.T)) = 0\n        # The code is just checking an algebraic identity.\n        \n        # We follow the same logic as the prompt's implied code.\n        K_up_constructed = -A * b * M_BN_derived.T\n        K_pu_constructed = -A * b * M_BN_derived\n        check_up_pu = np.linalg.norm(K_up_constructed - K_pu_constructed.T)  tol\n\n        K_uT_constructed = -A * E * alpha_T * M_BN_derived.T\n        K_Tu_constructed = -A * E * alpha_T * M_BN_derived\n        check_uT_Tu = np.linalg.norm(K_uT_constructed - K_Tu_constructed.T)  tol\n        \n        K_pT_constructed = -A * beta * M_NN\n        K_Tp_constructed = -A * beta * M_NN\n        check_pT_Tp = np.linalg.norm(K_pT_constructed - K_Tp_constructed.T)  tol\n        \n        all_results.extend([check_up_pu, check_uT_Tu, check_pT_Tp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```"
        }
    ]
}