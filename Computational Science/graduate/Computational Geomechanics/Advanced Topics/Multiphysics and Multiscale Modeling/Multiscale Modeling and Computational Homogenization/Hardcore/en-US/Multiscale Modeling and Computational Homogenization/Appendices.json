{
    "hands_on_practices": [
        {
            "introduction": "The bedrock of first-order computational homogenization is the principle that macroscopic quantities are the volume average of their microscopic counterparts. This exercise provides a direct application of this core concept, stripping away the complexity of solving a micro-scale boundary value problem to focus purely on the upscaling step. By working with hypothetical, piecewise-constant fields, you will solidify your understanding of how macroscopic stress $\\boldsymbol{\\Sigma}$ and strain $\\boldsymbol{E}$ tensors are derived and see firsthand how microstructural arrangements can give rise to effective anisotropic behavior .",
            "id": "3545651",
            "problem": "Consider a two-dimensional plane-strain Representative Volume Element (RVE) comprising three non-overlapping subdomains with area fractions $f_1=0.5$, $f_2=0.3$, and $f_3=0.2$, such that $f_1+f_2+f_3=1$. For two independent macroscopic loading cases, denoted by $A$ (predominantly $x$-direction extension) and $B$ (predominantly $y$-direction extension), the microscopic Cauchy stress $\\boldsymbol{\\sigma}_i^{(k)}$ and small-strain tensor $\\boldsymbol{\\varepsilon}_i^{(k)}$ are piecewise constant within each subdomain $i\\in\\{1,2,3\\}$ for case $k\\in\\{A,B\\}$ and given by the following symmetric matrices (units: stresses in megapascals (MPa), strains dimensionless):\n\nFor case $A$:\n$\\boldsymbol{\\varepsilon}_1^{(A)}=\\begin{pmatrix}0.0010 & 0 \\\\ 0 & 0.0002\\end{pmatrix}$, $\\boldsymbol{\\sigma}_1^{(A)}=\\begin{pmatrix}25 & 0 \\\\ 0 & 5\\end{pmatrix}$;\n$\\boldsymbol{\\varepsilon}_2^{(A)}=\\begin{pmatrix}0.0010 & 0 \\\\ 0 & 0.0001\\end{pmatrix}$, $\\boldsymbol{\\sigma}_2^{(A)}=\\begin{pmatrix}18 & 0 \\\\ 0 & 6\\end{pmatrix}$;\n$\\boldsymbol{\\varepsilon}_3^{(A)}=\\begin{pmatrix}0.0010 & 0 \\\\ 0 & 0.0003\\end{pmatrix}$, $\\boldsymbol{\\sigma}_3^{(A)}=\\begin{pmatrix}30 & 0 \\\\ 0 & 4.5\\end{pmatrix}$.\n\nFor case $B$:\n$\\boldsymbol{\\varepsilon}_1^{(B)}=\\begin{pmatrix}0.0002 & 0 \\\\ 0 & 0.0010\\end{pmatrix}$, $\\boldsymbol{\\sigma}_1^{(B)}=\\begin{pmatrix}5 & 0 \\\\ 0 & 20\\end{pmatrix}$;\n$\\boldsymbol{\\varepsilon}_2^{(B)}=\\begin{pmatrix}0.0001 & 0 \\\\ 0 & 0.0010\\end{pmatrix}$, $\\boldsymbol{\\sigma}_2^{(B)}=\\begin{pmatrix}6 & 0 \\\\ 0 & 14\\end{pmatrix}$;\n$\\boldsymbol{\\varepsilon}_3^{(B)}=\\begin{pmatrix}0.0003 & 0 \\\\ 0 & 0.0010\\end{pmatrix}$, $\\boldsymbol{\\sigma}_3^{(B)}=\\begin{pmatrix}4.5 & 0 \\\\ 0 & 28\\end{pmatrix}$.\n\nStarting from first principles of computational homogenization in computational geomechanics, specifically the Hill–Mandel macro-homogeneity principle and the definition of volume averages, perform the following:\n\n1. Compute the macroscopic stress tensor $\\boldsymbol{\\Sigma}^{(A)}$ and macroscopic strain tensor $\\boldsymbol{E}^{(A)}$ for case $A$ using volume averaging over the subdomains.\n2. Compute the macroscopic stress tensor $\\boldsymbol{\\Sigma}^{(B)}$ and macroscopic strain tensor $\\boldsymbol{E}^{(B)}$ for case $B$ using volume averaging over the subdomains.\n3. Define directional effective moduli under these predominantly uniaxial macroscopic strain states as $E_{11}^{\\text{eff}}=\\Sigma_{11}^{(A)}/E_{11}^{(A)}$ and $E_{22}^{\\text{eff}}=\\Sigma_{22}^{(B)}/E_{22}^{(B)}$, where $\\Sigma_{ij}^{(k)}$ and $E_{ij}^{(k)}$ denote the components of the macroscopic tensors in case $k$.\n4. Assess anisotropy via the ratio $\\mathcal{R}=\\dfrac{E_{11}^{\\text{eff}}}{E_{22}^{\\text{eff}}}$.\n\nReport only the final value of the anisotropy ratio $\\mathcal{R}$ as a pure number (no units) rounded to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The provided data, though inconsistent with simple linear elasticity, is taken as given for two independent loading cases, a common scenario in analyzing complex non-linear materials. The task is a direct application of the fundamental principles of computational homogenization.\n\nThe core principle of computational homogenization is that macroscopic fields are the volume averages of their microscopic counterparts over a Representative Volume Element (RVE). For a heterogeneous material composed of $N$ subdomains (phases) with volume fractions $f_i$ (where $\\sum_{i=1}^{N} f_i = 1$) and with piecewise constant microscopic stress $\\boldsymbol{\\sigma}_i$ and strain $\\boldsymbol{\\varepsilon}_i$ tensors, the macroscopic stress $\\boldsymbol{\\Sigma}$ and strain $\\boldsymbol{E}$ are given by:\n$$\n\\boldsymbol{\\Sigma} = \\langle \\boldsymbol{\\sigma} \\rangle = \\sum_{i=1}^{N} f_i \\boldsymbol{\\sigma}_i\n$$\n$$\n\\boldsymbol{E} = \\langle \\boldsymbol{\\varepsilon} \\rangle = \\sum_{i=1}^{N} f_i \\boldsymbol{\\varepsilon}_i\n$$\nFor the given two-dimensional problem, area fractions are equivalent to volume fractions. We are given $f_1=0.5$, $f_2=0.3$, and $f_3=0.2$.\n\nStep 1: Compute the macroscopic stress tensor $\\boldsymbol{\\Sigma}^{(A)}$ and macroscopic strain tensor $\\boldsymbol{E}^{(A)}$ for case $A$.\n\nThe macroscopic strain tensor $\\boldsymbol{E}^{(A)}$ is the weighted average of the microscopic strain tensors:\n$$\n\\boldsymbol{E}^{(A)} = f_1 \\boldsymbol{\\varepsilon}_1^{(A)} + f_2 \\boldsymbol{\\varepsilon}_2^{(A)} + f_3 \\boldsymbol{\\varepsilon}_3^{(A)}\n$$\nComponent-wise, this is:\n$E_{11}^{(A)} = (0.5)(0.0010) + (0.3)(0.0010) + (0.2)(0.0010) = (0.5+0.3+0.2)(0.0010) = 1 \\times 0.0010 = 0.0010$.\n$E_{22}^{(A)} = (0.5)(0.0002) + (0.3)(0.0001) + (0.2)(0.0003) = 0.0001 + 0.00003 + 0.00006 = 0.00019$.\nSince all microscopic shear strains are zero, $E_{12}^{(A)} = E_{21}^{(A)} = 0$.\nThus, the macroscopic strain tensor for case $A$ is:\n$$\n\\boldsymbol{E}^{(A)} = \\begin{pmatrix} 0.0010 & 0 \\\\ 0 & 0.00019 \\end{pmatrix}\n$$\nThe macroscopic stress tensor $\\boldsymbol{\\Sigma}^{(A)}$ is the weighted average of the microscopic stress tensors:\n$$\n\\boldsymbol{\\Sigma}^{(A)} = f_1 \\boldsymbol{\\sigma}_1^{(A)} + f_2 \\boldsymbol{\\sigma}_2^{(A)} + f_3 \\boldsymbol{\\sigma}_3^{(A)}\n$$\nComponent-wise, this is:\n$\\Sigma_{11}^{(A)} = (0.5)(25) + (0.3)(18) + (0.2)(30) = 12.5 + 5.4 + 6.0 = 23.9$ MPa.\n$\\Sigma_{22}^{(A)} = (0.5)(5) + (0.3)(6) + (0.2)(4.5) = 2.5 + 1.8 + 0.9 = 5.2$ MPa.\nSince all microscopic shear stresses are zero, $\\Sigma_{12}^{(A)} = \\Sigma_{21}^{(A)} = 0$.\nThus, the macroscopic stress tensor for case $A$ is:\n$$\n\\boldsymbol{\\Sigma}^{(A)} = \\begin{pmatrix} 23.9 & 0 \\\\ 0 & 5.2 \\end{pmatrix}\n$$\n\nStep 2: Compute the macroscopic stress tensor $\\boldsymbol{\\Sigma}^{(B)}$ and macroscopic strain tensor $\\boldsymbol{E}^{(B)}$ for case $B$.\n\nThe macroscopic strain tensor $\\boldsymbol{E}^{(B)}$ is:\n$$\n\\boldsymbol{E}^{(B)} = f_1 \\boldsymbol{\\varepsilon}_1^{(B)} + f_2 \\boldsymbol{\\varepsilon}_2^{(B)} + f_3 \\boldsymbol{\\varepsilon}_3^{(B)}\n$$\n$E_{11}^{(B)} = (0.5)(0.0002) + (0.3)(0.0001) + (0.2)(0.0003) = 0.0001 + 0.00003 + 0.00006 = 0.00019$.\n$E_{22}^{(B)} = (0.5)(0.0010) + (0.3)(0.0010) + (0.2)(0.0010) = (0.5+0.3+0.2)(0.0010) = 1 \\times 0.0010 = 0.0010$.\n$E_{12}^{(B)} = E_{21}^{(B)} = 0$.\nThus, the macroscopic strain tensor for case $B$ is:\n$$\n\\boldsymbol{E}^{(B)} = \\begin{pmatrix} 0.00019 & 0 \\\\ 0 & 0.0010 \\end{pmatrix}\n$$\nThe macroscopic stress tensor $\\boldsymbol{\\Sigma}^{(B)}$ is:\n$$\n\\boldsymbol{\\Sigma}^{(B)} = f_1 \\boldsymbol{\\sigma}_1^{(B)} + f_2 \\boldsymbol{\\sigma}_2^{(B)} + f_3 \\boldsymbol{\\sigma}_3^{(B)}\n$$\n$\\Sigma_{11}^{(B)} = (0.5)(5) + (0.3)(6) + (0.2)(4.5) = 2.5 + 1.8 + 0.9 = 5.2$ MPa.\n$\\Sigma_{22}^{(B)} = (0.5)(20) + (0.3)(14) + (0.2)(28) = 10.0 + 4.2 + 5.6 = 19.8$ MPa.\n$\\Sigma_{12}^{(B)} = \\Sigma_{21}^{(B)} = 0$.\nThus, the macroscopic stress tensor for case $B$ is:\n$$\n\\boldsymbol{\\Sigma}^{(B)} = \\begin{pmatrix} 5.2 & 0 \\\\ 0 & 19.8 \\end{pmatrix}\n$$\n\nStep 3: Define and compute the directional effective moduli.\n\nThe directional effective modulus in the $x$-direction, $E_{11}^{\\text{eff}}$, is defined as the ratio of the macroscopic stress to the macroscopic strain in that direction for the predominantly $x$-direction loading case $A$:\n$$\nE_{11}^{\\text{eff}} = \\frac{\\Sigma_{11}^{(A)}}{E_{11}^{(A)}} = \\frac{23.9}{0.0010} = 23900 \\text{ MPa}\n$$\nThe directional effective modulus in the $y$-direction, $E_{22}^{\\text{eff}}$, is defined as the ratio of the macroscopic stress to the macroscopic strain in that direction for the predominantly $y$-direction loading case $B$:\n$$\nE_{22}^{\\text{eff}} = \\frac{\\Sigma_{22}^{(B)}}{E_{22}^{(B)}} = \\frac{19.8}{0.0010} = 19800 \\text{ MPa}\n$$\n\nStep 4: Assess anisotropy via the ratio $\\mathcal{R}$.\n\nThe anisotropy ratio $\\mathcal{R}$ is defined as the ratio of the two directional effective moduli:\n$$\n\\mathcal{R} = \\frac{E_{11}^{\\text{eff}}}{E_{22}^{\\text{eff}}} = \\frac{23900}{19800} = \\frac{239}{198}\n$$\nPerforming the division:\n$$\n\\mathcal{R} \\approx 1.2070707...\n$$\nRounding to four significant figures as required by the problem statement, we obtain:\n$$\n\\mathcal{R} = 1.207\n$$",
            "answer": "$$ \\boxed{1.207} $$"
        },
        {
            "introduction": "A central question in multiscale modeling is: how large must a sample be to be \"representative\"? This practice moves beyond simple averaging to address the statistical definition of a Representative Volume Element (RVE). Using principles from random field theory, you will analytically determine the minimum RVE size required to achieve a target precision for the effective modulus, linking it directly to the material's microstructural correlation length. This exercise is crucial for appreciating that the RVE is a statistical concept, not a deterministic one, a cornerstone of rigorous multiscale analysis .",
            "id": "3545643",
            "problem": "A three-dimensional geomaterial exhibits a statistically homogeneous microstructure consisting of stiff inclusions embedded in a softer matrix. The characteristic inclusion size is $\\ell = 1$ mm, and a laboratory specimen has height $L = 100$ mm. You are to assess the adequacy of scale separation for first-order computational homogenization and to size a Representative Volume Element (RVE) that achieves a prescribed statistical accuracy for the effective Young’s modulus.\n\nAssume the following physically justified modeling hypotheses:\n\n- The local Young’s modulus field $E(\\boldsymbol{x})$ is a second-order stationary, ergodic random field over $\\mathbb{R}^3$ with mean $\\mu_E$ and standard deviation $\\sigma_E$. The pointwise Coefficient of Variation (CoV) is $c_0 = \\sigma_E / \\mu_E = 0.4$.\n- The normalized two-point correlation function of $E(\\boldsymbol{x})$ is isotropic and given by $\\rho(r) = \\exp(-r/\\ell)$ with correlation length equal to the inclusion size $\\ell$.\n- The specimen is large compared to the RVE, and spatial averages are taken over cubic windows $\\Omega_D$ of side length $D$ and volume $V = D^3$.\n- Use the definition of the spatial average $\\overline{E}_D = \\frac{1}{V}\\int_{\\Omega_D} E(\\boldsymbol{x})\\, \\mathrm{d}\\boldsymbol{x}$ and the covariance integral representation $\\mathrm{Var}(\\overline{E}_D) = V^{-2}\\int_{\\Omega_D}\\int_{\\Omega_D} C_E(|\\boldsymbol{x}-\\boldsymbol{y}|)\\,\\mathrm{d}\\boldsymbol{x}\\,\\mathrm{d}\\boldsymbol{y}$, where $C_E(r) = \\sigma_E^2 \\rho(r)$. For large windows, it is standard to approximate the double integral by the product of the domain volume and the integral of the covariance over space.\n\nTasks:\n\n1) Define the dimensionless scale separation parameter $\\eta = \\ell/L$ and, adopting the engineering adequacy criterion for first-order computational homogenization that $\\eta \\le 0.1$, determine whether scale separation is adequate.\n\n2) Starting from the above definitions and assumptions, derive an expression for the CoV of the apparent modulus $\\overline{E}_D$ in terms of $D$, and determine the minimum cube side length $D_{\\mathrm{RVE}}$ such that the CoV of $\\overline{E}_D$ does not exceed a target value $c_t = 0.05$. Use the exponential correlation and evaluate any needed integrals exactly. Round your final numerical answer to four significant figures. Express the final $D_{\\mathrm{RVE}}$ in mm.\n\nProvide only the numerical value of $D_{\\mathrm{RVE}}$ as your final answer.",
            "solution": "The requirement for first-order computational homogenization is that the microstructural length scale be much smaller than the macroscopic structural scale. A common dimensionless measure is the length-scale ratio $\\eta = \\ell/L$. With $\\ell = 1$ mm and $L = 100$ mm,\n$$\n\\eta \\;=\\; \\frac{\\ell}{L} \\;=\\; \\frac{1}{100} \\;=\\; 0.01.\n$$\nAdopting the engineering criterion $\\eta \\le 0.1$ for adequacy, we have $0.01 \\le 0.1$, so scale separation is adequate.\n\nTo determine the Representative Volume Element (RVE) size, consider the spatial average of the stationary field $E(\\boldsymbol{x})$ over a cubic window $\\Omega_D$ with volume $V=D^3$:\n$$\n\\overline{E}_D \\;=\\; \\frac{1}{V}\\int_{\\Omega_D} E(\\boldsymbol{x})\\, \\mathrm{d}\\boldsymbol{x}.\n$$\nBy the definition of variance and stationarity, the variance of $\\overline{E}_D$ can be written via the covariance integral:\n$$\n\\mathrm{Var}(\\overline{E}_D) \\;=\\; \\frac{1}{V^2}\\int_{\\Omega_D}\\int_{\\Omega_D} C_E\\big(|\\boldsymbol{x}-\\boldsymbol{y}|\\big)\\, \\mathrm{d}\\boldsymbol{x}\\,\\mathrm{d}\\boldsymbol{y},\n$$\nwhere $C_E(r) = \\sigma_E^2 \\rho(r)$ and $\\rho(r) = \\exp(-r/\\ell)$.\n\nFor large windows $D \\gg \\ell$, a standard approximation from random field theory (obtained by change of variables and neglecting boundary effects) reduces the double integral to the product of the domain volume and the integral of the covariance over $\\mathbb{R}^3$:\n$$\n\\mathrm{Var}(\\overline{E}_D) \\;\\approx\\; \\frac{1}{V}\\int_{\\mathbb{R}^3} C_E(r)\\, \\mathrm{d}\\boldsymbol{r} \\;=\\; \\frac{\\sigma_E^2}{V}\\int_{\\mathbb{R}^3} \\rho(r)\\, \\mathrm{d}\\boldsymbol{r}.\n$$\nUsing spherical coordinates with $r = |\\boldsymbol{r}|$ and $\\rho(r) = \\exp(-r/\\ell)$, the integral becomes\n$$\n\\int_{\\mathbb{R}^3} \\rho(r)\\, \\mathrm{d}\\boldsymbol{r} \\;=\\; \\int_{0}^{\\infty} 4\\pi r^2 \\exp\\!\\big(-r/\\ell\\big)\\, \\mathrm{d}r.\n$$\nEvaluate the radial integral using the identity $\\int_{0}^{\\infty} r^n \\exp(-r/a)\\, \\mathrm{d}r = n!\\, a^{n+1}$ for $a>0$ and integer $n$, with $n=2$ and $a=\\ell$:\n$$\n\\int_{0}^{\\infty} r^2 \\exp\\!\\big(-r/\\ell\\big)\\, \\mathrm{d}r \\;=\\; 2!\\, \\ell^{3} \\;=\\; 2\\, \\ell^3.\n$$\nTherefore,\n$$\n\\int_{\\mathbb{R}^3} \\rho(r)\\, \\mathrm{d}\\boldsymbol{r} \\;=\\; 4\\pi \\cdot 2 \\ell^3 \\;=\\; 8\\pi \\ell^3,\n$$\nand the large-window variance is\n$$\n\\mathrm{Var}(\\overline{E}_D) \\;\\approx\\; \\frac{\\sigma_E^2}{V}\\, 8\\pi \\ell^3 \\;=\\; \\sigma_E^2 \\,\\frac{8\\pi \\ell^3}{D^3}.\n$$\nThe Coefficient of Variation (CoV) of the apparent modulus is\n$$\n\\mathrm{CoV}(\\overline{E}_D) \\;=\\; \\frac{\\sqrt{\\mathrm{Var}(\\overline{E}_D)}}{\\mu_E} \\;\\approx\\; \\frac{\\sigma_E}{\\mu_E}\\, \\sqrt{\\frac{8\\pi \\ell^3}{D^3}} \\;=\\; c_0 \\,\\frac{\\sqrt{8\\pi}\\, \\ell^{3/2}}{D^{3/2}}.\n$$\nImposing the target $\\mathrm{CoV}(\\overline{E}_D) \\le c_t$ and solving for $D$ yields\n$$\nc_0 \\,\\frac{\\sqrt{8\\pi}\\, \\ell^{3/2}}{D^{3/2}} \\;\\le\\; c_t\n\\;\\;\\Rightarrow\\;\\;\nD^{3/2} \\;\\ge\\; \\frac{c_0 \\sqrt{8\\pi}\\, \\ell^{3/2}}{c_t}\n\\;\\;\\Rightarrow\\;\\;\nD \\;\\ge\\; \\ell \\left(\\frac{c_0 \\sqrt{8\\pi}}{c_t}\\right)^{\\!2/3}.\n$$\nWith $\\ell = 1$ mm, $c_0 = 0.4$, and $c_t = 0.05$, the minimum RVE size is\n$$\nD_{\\mathrm{RVE}} \\;=\\; 1 \\times \\left(\\frac{0.4\\, \\sqrt{8\\pi}}{0.05}\\right)^{\\!2/3} \\;\\text{mm}.\n$$\nCompute the dimensionless factor:\n$$\n\\sqrt{8\\pi} \\;=\\; \\sqrt{25.1327412287} \\;\\approx\\; 5.013256549, \\quad\n\\frac{0.4 \\times 5.013256549}{0.05} \\;\\approx\\; 40.10605239,\n$$\nand thus\n$$\nD_{\\mathrm{RVE}} \\;\\approx\\; \\big(40.10605239\\big)^{2/3} \\;\\text{mm} \\;\\approx\\; 11.72 \\;\\text{mm},\n$$\nrounded to four significant figures.\n\nHence, scale separation is adequate since $\\eta = 0.01 \\le 0.1$, and the minimum cube side length that achieves the target CoV is $D_{\\mathrm{RVE}} \\approx 11.72$ mm.",
            "answer": "$$\\boxed{11.72}$$"
        },
        {
            "introduction": "This practice translates the theoretical concept of RVE sizing into a practical computational workflow using Monte Carlo simulation. You will write a program to generate numerous random microstructures and quantify the statistical dispersion of the resulting effective stiffness tensor as a function of the sample size. The exercise uses a simplified Voigt-type estimate for the effective stiffness, which allows the focus to remain on the statistical procedure for determining the RVE size based on a coefficient of variation criterion, a skill essential for performing and interpreting computational homogenization studies .",
            "id": "3545604",
            "problem": "You are asked to formalize a Representative Volume Element (RVE) size selection criterion in first-order computational homogenization for random two-phase geomaterials. The objective is to quantify how the apparent effective stiffness tensor varies across independent microstructural realizations and to identify the smallest sample size that yields sufficiently low ensemble variability.\n\nFundamental base and modeling assumptions:\n- Consider small-strain, linear elastic, two-dimensional plane strain behavior with isotropic phases. Let the two phases have Young’s moduli $E_1$, $E_2$ and Poisson’s ratios $\\nu_1$, $\\nu_2$ (with moduli $E_i$ in GPa and ratios $\\nu_i$ dimensionless). The Lamé parameters of phase $i \\in \\{1,2\\}$ are $\\lambda_i = \\dfrac{E_i \\nu_i}{(1+\\nu_i)(1-2\\nu_i)}$ and $\\mu_i = \\dfrac{E_i}{2(1+\\nu_i)}$. The fourth-order stiffness tensor in plane strain is represented in Voigt form as a $3 \\times 3$ matrix $C_i$ with components $C_{i,11} = \\lambda_i + 2\\mu_i$, $C_{i,22} = \\lambda_i + 2\\mu_i$, $C_{i,12} = \\lambda_i$, and $C_{i,33} = \\mu_i$ (using the convention $(11,22,12)$ mapped to $(1,2,3)$).\n- Invoke the Hill–Mandel macro-homogeneity principle under Kinematic Uniform Boundary Conditions (KUBC), which ensures that, at first order, the macroscopic stress–strain relation is obtained by the volume average of the local stiffness. Consequently, with a binary indicator field $I(\\mathbf{x}) \\in \\{0,1\\}$ denoting phase $1$, the apparent effective stiffness tensor is $C_{\\text{eff}} = \\langle C(\\mathbf{x}) \\rangle = \\langle I(\\mathbf{x}) \\rangle C_1 + \\left(1 - \\langle I(\\mathbf{x}) \\rangle \\right) C_2$. Here $\\langle \\cdot \\rangle$ denotes the spatial average over the Representative Volume Element (RVE).\n- Model the microstructure as an $N \\times N$ regular grid of pixels, each independently assigned to phase $1$ with probability $\\phi$ and to phase $2$ with probability $1-\\phi$. This construction yields a Bernoulli random field with mean volume fraction $\\phi$ and sample volume fraction $\\widehat{\\phi}_N = \\dfrac{1}{N^2} \\sum_{p=1}^{N^2} I_p$.\n- Define the coefficient of variation of a random variable $X$ by $\\mathrm{CV}[X] = \\dfrac{\\sqrt{\\mathrm{Var}[X]}}{\\mathbb{E}[X]}$.\n\nTask:\n- For each candidate size $N$ in a provided list, generate $M$ independent microstructure realizations on the $N \\times N$ grid with the given phase probability $\\phi$. For each realization, compute the apparent effective stiffness matrix $C_{\\text{eff}}$ by the KUBC volume average. Extract the four independent components in Voigt notation: $C_{\\text{eff},11}$, $C_{\\text{eff},22}$, $C_{\\text{eff},12}$, and $C_{\\text{eff},33}$. Across the $M$ realizations, compute the sample mean and sample standard deviation of each component, and then compute the component-wise coefficient of variation.\n- Aggregate the component-wise coefficients of variation into a single scalar by taking the maximum over the four independent components, that is $\\max\\left\\{\\mathrm{CV}[C_{\\text{eff},11}], \\mathrm{CV}[C_{\\text{eff},22}], \\mathrm{CV}[C_{\\text{eff},12}], \\mathrm{CV}[C_{\\text{eff},33}] \\right\\}$.\n- RVE size criterion: Declare that a candidate size $N$ is acceptable if the aggregated coefficient of variation satisfies $\\max\\left\\{\\mathrm{CV}[C_{\\text{eff},11}], \\mathrm{CV}[C_{\\text{eff},22}], \\mathrm{CV}[C_{\\text{eff},12}], \\mathrm{CV}[C_{\\text{eff},33}] \\right\\} < \\epsilon$, where $\\epsilon$ is a prescribed tolerance. Among the candidate sizes, select the smallest $N$ that satisfies the criterion. If none satisfy the criterion, return $-1$.\n- All computations of $E$ must be carried out in $\\text{GPa}$, and coefficients of variation are dimensionless. The final outputs for each test case are integers (either the selected $N$ or $-1$).\n\nTest suite and input parameters:\n- Use a fixed random number generator seed of $12345$ to ensure reproducibility.\n- For each test case, parameters are given as a tuple: $(E_1,\\nu_1,E_2,\\nu_2,\\phi,M,\\epsilon,\\mathcal{N})$, where $\\mathcal{N}$ is the set of candidate sizes.\n\nProvide the following four test cases:\n1. Happy path, moderate contrast and equal volume fractions: $(E_1,\\nu_1,E_2,\\nu_2,\\phi,M,\\epsilon,\\mathcal{N}) = (30.0, 0.20, 3.0, 0.35, 0.5, 300, 0.03, \\{8,16,32,64\\})$.\n2. Near-equal phases, fast convergence: $(E_1,\\nu_1,E_2,\\nu_2,\\phi,M,\\epsilon,\\mathcal{N}) = (10.0, 0.25, 9.0, 0.30, 0.5, 200, 0.02, \\{8,16,32\\})$.\n3. Rare stiff inclusions, high contrast: $(E_1,\\nu_1,E_2,\\nu_2,\\phi,M,\\epsilon,\\mathcal{N}) = (70.0, 0.20, 1.0, 0.35, 0.05, 400, 0.05, \\{16,32,64,96\\})$.\n4. Stringent tolerance, likely failure: $(E_1,\\nu_1,E_2,\\nu_2,\\phi,M,\\epsilon,\\mathcal{N}) = (30.0, 0.20, 3.0, 0.35, 0.5, 200, 0.005, \\{8,16,24\\})$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the test cases in the order listed above, for example, $[n_1,n_2,n_3,n_4]$, where each $n_i$ is the smallest acceptable $N$ or $-1$ if none are acceptable.\n\nImportant notes:\n- The derivation and algorithm must start from fundamental principles: small-strain linear elasticity, Hill–Mandel macro-homogeneity, and Kinematic Uniform Boundary Conditions leading to the Voigt estimate for $C_{\\text{eff}}$.\n- Do not use or cite any target or shortcut formulas for the RVE criterion; derive it from first principles and definitions.\n- Ensure scientific realism: all physical parameter values are plausible for geomaterials and composites, and all computations use $\\text{GPa}$ for moduli.",
            "solution": "The problem requires the formalization and implementation of a size selection criterion for a Representative Volume Element (RVE) in the context of first-order computational homogenization for a random two-phase geomaterial. The core of the task is to determine the smallest domain size $N \\times N$ for which the statistical variability of the apparent effective stiffness tensor, computed over multiple microstructural realizations, falls below a specified tolerance.\n\nThe solution proceeds by first establishing the theoretical framework based on linear elasticity and the provided homogenization assumptions. Subsequently, a numerical algorithm based on a Monte Carlo simulation is designed to compute the required statistics and apply the selection criterion.\n\nThe analysis is based on the following principles and modeling choices:\n\n1.  **Constitutive Behavior of Phases**: Each of the two isotropic phases, indexed by $i \\in \\{1,2\\}$, is described by linear elasticity. The material properties are the Young’s modulus $E_i$ and Poisson’s ratio $\\nu_i$. For a plane strain analysis, it is convenient to work with Lamé's first and second parameters, $\\lambda_i$ and $\\mu_i$ (shear modulus), which are derived from $E_i$ and $\\nu_i$ as:\n    $$\n    \\lambda_i = \\frac{E_i \\nu_i}{(1+\\nu_i)(1-2\\nu_i)}\n    $$\n    $$\n    \\mu_i = \\frac{E_i}{2(1+\\nu_i)}\n    $$\n    The fourth-order stiffness tensor for each phase, $C_i$, can be represented in Voigt matrix notation for a 2D plane strain state. Following the problem's convention where the vector of strain components is $(\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12})^T$ with $\\gamma_{12} = 2\\varepsilon_{12}$ being the engineering shear strain, the $3 \\times 3$ stiffness matrix for an isotropic material is:\n    $$\n    C_i = \\begin{pmatrix}\n    \\lambda_i + 2\\mu_i & \\lambda_i & 0 \\\\\n    \\lambda_i & \\lambda_i + 2\\mu_i & 0 \\\\\n    0 & 0 & \\mu_i\n    \\end{pmatrix}\n    $$\n    The problem specifies tracking four components, which we label according to their indices in the matrix: $C_{i,11} = \\lambda_i + 2\\mu_i$, $C_{i,22} = \\lambda_i + 2\\mu_i$, $C_{i,12} = \\lambda_i$, and $C_{i,33} = \\mu_i$.\n\n2.  **Homogenization Principle**: The problem invokes the Hill–Mandel macro-homogeneity condition under Kinematic Uniform Boundary Conditions (KUBC). Crucially, it simplifies the outcome of this principle to a first-order volume-averaging scheme, also known as the Voigt estimate or the rule of mixtures. According to this model, the apparent effective stiffness tensor $C_{\\text{eff}}$ of a given microstructural realization is the spatial average of the local stiffness tensor $C(\\mathbf{x})$:\n    $$\n    C_{\\text{eff}} = \\langle C(\\mathbf{x}) \\rangle\n    $$\n    For a two-phase material, where the local stiffness is either $C_1$ or $C_2$, this average is computed using a sample volume fraction. Let $\\widehat{\\phi}_N$ be the volume fraction of phase 1 in a given $N \\times N$ realization. The apparent effective stiffness is then a linear combination of the phase stiffnesses:\n    $$\n    C_{\\text{eff}} = \\widehat{\\phi}_N C_1 + (1 - \\widehat{\\phi}_N) C_2\n    $$\n    Consequently, each component of the effective stiffness matrix is also a linear function of $\\widehat{\\phi}_N$:\n    $$\n    C_{\\text{eff},k} = \\widehat{\\phi}_N C_{1,k} + (1 - \\widehat{\\phi}_N) C_{2,k}\n    $$\n    where $k$ denotes any of the components $(11, 22, 12, 33)$. This formulation bypasses the need to solve a boundary value problem on the RVE, reducing the problem to the statistical analysis of the sample volume fraction $\\widehat{\\phi}_N$.\n\n3.  **Stochastic Microstructure Model**: The microstructure is modeled as an $N \\times N$ regular grid of pixels. Each pixel is independently assigned to be phase 1 with probability $\\phi$ or phase 2 with probability $1-\\phi$. This describes a field of independent and identically distributed (i.i.d.) Bernoulli random variables. The sample volume fraction $\\widehat{\\phi}_N$ for a grid of $N^2$ pixels is the average of these variables. If $K$ is the number of pixels assigned to phase 1, then $\\widehat{\\phi}_N = K/N^2$. The random variable $K$ follows a binomial distribution, $K \\sim \\mathrm{Binomial}(n=N^2, p=\\phi)$. All stochasticity in the modeled $C_{\\text{eff}}$ originates from the statistical fluctuations of $\\widehat{\\phi}_N$ from one realization to another.\n\n4.  **Statistical Analysis and RVE Criterion**: To find the RVE size, we must assess the variability of $C_{\\text{eff}}$. This is done via a Monte Carlo simulation. For each candidate size $N \\in \\mathcal{N}$:\n    - Generate $M$ independent realizations of the microstructure. Computationally, this is equivalent to generating $M$ independent values of the sample volume fraction $\\widehat{\\phi}_N$ by drawing from the binomial distribution $\\mathrm{Binomial}(N^2, \\phi)$ and dividing by $N^2$.\n    - For each of the $M$ values of $\\widehat{\\phi}_N$, compute the four specified components of $C_{\\text{eff}}$. This yields $M$ samples for each component, e.g., $\\{C_{\\text{eff},11}^{(1)}, \\dots, C_{\\text{eff},11}^{(M)}\\}$.\n    - For each component $k$, compute its sample mean $(\\bar{C}_{\\text{eff},k})$ and its sample standard deviation $(s_{k})$ using the unbiased estimator (with $M-1$ in the denominator).\n    - The coefficient of variation (CV) for each component is then calculated as:\n      $$\n      \\mathrm{CV}[C_{\\text{eff},k}] = \\frac{s_{k}}{\\bar{C}_{\\text{eff},k}}\n      $$\n    - An aggregated measure of variability for the size $N$ is taken as the maximum of these component-wise CVs:\n      $$\n      \\mathrm{CV}_{\\max}(N) = \\max\\left\\{\\mathrm{CV}[C_{\\text{eff},11}], \\mathrm{CV}[C_{\\text{eff},22}], \\mathrm{CV}[C_{\\text{eff},12}], \\mathrm{CV}[C_{\\text{eff},33}] \\right\\}\n      $$\n    - The RVE size criterion is then applied. The candidate sizes in $\\mathcal{N}$ are checked in ascending order. The first size $N$ for which $\\mathrm{CV}_{\\max}(N) < \\epsilon$ is declared the minimum acceptable RVE size. If no candidate size in $\\mathcal{N}$ meets the criterion, the result is designated as $-1$.\n\nThis procedure provides a complete and rigorous method for determining the RVE size under the specified modeling assumptions. The implementation will follow this algorithm precisely, using the provided test case parameters and a fixed random seed for reproducibility.",
            "answer": "[16,8,64,-1]"
        }
    ]
}