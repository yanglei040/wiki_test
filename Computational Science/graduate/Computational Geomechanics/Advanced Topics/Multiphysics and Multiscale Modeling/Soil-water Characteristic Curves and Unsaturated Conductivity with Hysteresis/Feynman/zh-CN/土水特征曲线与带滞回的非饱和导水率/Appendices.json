{
    "hands_on_practices": [
        {
            "introduction": "土壤-水特征曲线（SWCC）是理解非饱和土力学的核心，而van Genuchten模型是描述这种关系最广泛使用的经验公式之一。本练习旨在揭示这类经验模型背后的物理基础，通过从孔隙尺寸的对数正态分布出发，推导出基于物理的Kosugi模型。通过将这两个模型在关键点上进行二阶匹配，本练习不仅阐明了SWCC的统计力学渊源，还锻炼了连接理论模型与经验公式的分析能力。",
            "id": "3561023",
            "problem": "一个刚性、各向同性的土壤被建模为半径呈对数正态分布的圆柱形孔隙的集合。设孔隙半径的自然对数 $\\ln R$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。考虑主干燥（排水）过程，无墨水瓶效应、接触角恒定且空气滞留可忽略不计，因此毛细管束理想化模型成立。毛细管压力水头 $\\psi$ 与最大充水孔隙通过杨-拉普拉斯关系 $r_c(\\psi) = A/\\psi$ 相关联，其中 $A = \\frac{2 \\gamma \\cos \\theta}{\\rho_{w} g}$，$\\gamma$ 为水-气表面张力，$\\theta$ 为接触角，$\\rho_w$ 为水的密度， $g$ 为重力加速度。在这些假设下，有效饱和度 $S_e(\\psi)$ 等于保持充水状态的孔隙的累积概率，即那些满足 $R \\le r_c(\\psi)$ 的孔隙。\n\n第 (a) 部分：仅从上述统计和毛细管假设以及有效饱和度的定义出发，推导由对数正态（Kosugi型）孔隙半径模型所蕴含的土水特征曲线 (SWCC) $S_e^{K}(\\psi)$ 的显式闭式表达式。用与孔径中值 $R_m = \\exp(\\mu)$ 相关联的中值毛细管压力水头 $h_m$ 来表示你的结果。\n\n第 (b) 部分：现在考虑由三个正参数 $(\\alpha, n, m)$ 定义的 van Genuchten 族 $S_e^{VG}(\\psi)$，作为主干燥过程的通用参数化SWCC，其中 $S_e^{VG}(\\psi) = \\left[1 + (\\alpha \\psi)^{n}\\right]^{-m}$。在 $\\psi = h_m$ 处，对 $S_e^{K}(\\psi)$ 和 $S_e^{VG}(\\psi)$ 施加一个局部“二阶重合”条件，即在 $\\psi = h_m$ 处，两条曲线的值、关于 $\\psi$ 的一阶导数和二阶导数均相同。\n\n在这些重合条件下，确定 van Genuchten 指数 $m$ 的唯一值。你的最终答案必须仅为 $m$ 的值。无需四舍五入。最终答案中不要包含单位。",
            "solution": "该问题要求从第一性原理出发推导 Kosugi 型土水特征曲线 (SWCC)，然后通过在两种模型之间施加在中值毛细管压力水头处的二阶重合条件来确定 van Genuchten 参数 $m$。\n\n第 (a) 部分：Kosugi SWCC, $S_e^{K}(\\psi)$ 的推导\n\n我们已知孔隙半径的自然对数 $\\ln R$ 服从正态分布。设随机变量 $X = \\ln R$。则 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$。有效饱和度 $S_e(\\psi)$ 是保持充水状态的孔隙的累积概率，即半径 $R$ 小于或等于最大充水孔隙半径 $r_c(\\psi)$ 的孔隙。杨-拉普拉斯关系给出 $r_c(\\psi) = A/\\psi$。\n\n因此，$S_e(\\psi)$ 的定义是：\n$$S_e(\\psi) = P(R \\le r_c(\\psi)) = P(R \\le A/\\psi)$$\n为了处理正态分布变量 $X = \\ln R$，我们对不等式两边取自然对数：\n$$S_e(\\psi) = P(\\ln R \\le \\ln(A/\\psi)) = P(X \\le \\ln A - \\ln \\psi)$$\n为了求得此概率，我们对随机变量 $X$ 进行标准化。设 $Z = \\frac{X - \\mu}{\\sigma}$，其中 $Z \\sim \\mathcal{N}(0, 1)$ 是标准正态变量。不等式变为：\n$$\\frac{X - \\mu}{\\sigma} \\le \\frac{\\ln A - \\ln \\psi - \\mu}{\\sigma}$$\n该概率由标准正态分布的累积分布函数 (CDF) 给出，记为 $\\Phi(z) = P(Z \\le z)$：\n$$S_e^{K}(\\psi) = \\Phi\\left(\\frac{\\ln A - \\mu - \\ln \\psi}{\\sigma}\\right)$$\n问题要求用中值毛细管压力水头 $h_m$ 来表示此表达式。孔隙半径中值为 $R_m = \\exp(\\mu)$。水头 $h_m$ 是排空尺寸为 $R_m$ 的孔隙所需的毛细管压力水头。根据杨-拉普拉斯关系：\n$$R_m = \\frac{A}{h_m}$$\n取自然对数：\n$$\\ln R_m = \\ln\\left(\\frac{A}{h_m}\\right) = \\ln A - \\ln h_m$$\n由于 $\\ln R_m = \\mu$，我们有 $\\mu = \\ln A - \\ln h_m$，这意味着 $\\ln A - \\mu = \\ln h_m$。\n将此代入 $S_e^{K}(\\psi)$ 的表达式中：\n$$S_e^{K}(\\psi) = \\Phi\\left(\\frac{\\ln h_m - \\ln \\psi}{\\sigma}\\right) = \\Phi\\left(\\frac{1}{\\sigma}\\ln\\left(\\frac{h_m}{\\psi}\\right)\\right)$$\n这就是 Kosugi 型 SWCC 的闭式表达式。\n\n第 (b) 部分：van Genuchten 参数 $m$ 的确定\n\n我们已知 van Genuchten SWCC 为 $S_e^{VG}(\\psi) = \\left[1 + (\\alpha \\psi)^{n}\\right]^{-m}$。\n我们必须在 $\\psi = h_m$ 处对 $S_e^{K}(\\psi)$ 和 $S_e^{VG}(\\psi)$ 施加二阶重合。这意味着在 $\\psi = h_m$ 处，这两个函数的值以及它们的前两阶导数必须相等。\n\n我们记 $S_K(\\psi) = S_e^{K}(\\psi)$ 和 $S_{VG}(\\psi) = S_e^{VG}(\\psi)$。条件是：\n$1.$ $S_K(h_m) = S_{VG}(h_m)$\n$2.$ $S_K'(h_m) = S_{VG}'(h_m)$\n$3.$ $S_K''(h_m) = S_{VG}''(h_m)$\n\n首先，我们计算 $S_K(\\psi)$ 及其在 $\\psi=h_m$ 处的导数。设 $u(\\psi) = \\frac{1}{\\sigma}\\ln\\left(\\frac{h_m}{\\psi}\\right)$。\n那么 $S_K(\\psi) = \\Phi(u(\\psi))$。在 $\\psi=h_m$ 处， $u(h_m) = \\frac{1}{\\sigma}\\ln(1) = 0$。\n条件 1：\n$S_K(h_m) = \\Phi(0) = \\frac{1}{2}$。\n$S_{VG}(h_m) = \\left[1 + (\\alpha h_m)^{n}\\right]^{-m} = \\frac{1}{2}$。\n这意味着 $1 + (\\alpha h_m)^n = 2^{1/m}$，所以 $(\\alpha h_m)^n = 2^{1/m} - 1$。\n\n现在来看导数。我们使用链式法则以及标准正态概率密度函数 (PDF) $\\phi(z) = \\Phi'(z)$ 及其导数 $\\phi'(z) = -z\\phi(z)$ 的性质。\n$u'(\\psi) = \\frac{1}{\\sigma} \\frac{\\psi}{h_m} \\left(-\\frac{h_m}{\\psi^2}\\right) = -\\frac{1}{\\sigma\\psi}$。在 $\\psi=h_m$ 处， $u'(h_m) = -\\frac{1}{\\sigma h_m}$。\n$u''(\\psi) = \\frac{1}{\\sigma\\psi^2}$。在 $\\psi=h_m$ 处， $u''(h_m) = \\frac{1}{\\sigma h_m^2}$。\n\n$S_K'(\\psi) = \\phi(u(\\psi))u'(\\psi)$。\n$S_K'(h_m) = \\phi(0)u'(h_m) = \\phi(0) \\left(-\\frac{1}{\\sigma h_m}\\right) = -\\frac{\\phi(0)}{\\sigma h_m}$。\n\n$S_K''(\\psi) = \\phi'(u(\\psi))(u'(\\psi))^2 + \\phi(u(\\psi))u''(\\psi)$。\n$S_K''(h_m) = \\phi'(0)(u'(h_m))^2 + \\phi(0)u''(h_m)$。\n由于 $\\phi'(0) = -0 \\cdot \\phi(0) = 0$，第一项消失。\n$S_K''(h_m) = \\phi(0)u''(h_m) = \\phi(0)\\left(\\frac{1}{\\sigma h_m^2}\\right) = \\frac{\\phi(0)}{\\sigma h_m^2}$。\n\n从 $S_K$ 的这些导数表达式中，我们发现一个关键关系：\n$$S_K''(h_m) = \\frac{\\phi(0)}{\\sigma h_m^2} = -\\frac{1}{h_m} \\left(-\\frac{\\phi(0)}{\\sigma h_m}\\right) = -\\frac{S_K'(h_m)}{h_m}$$\n因此，重合条件 $S_K'(h_m) = S_{VG}'(h_m)$ 和 $S_K''(h_m) = S_{VG}''(h_m)$ 意味着 van Genuchten 曲线在 $\\psi=h_m$ 处必须满足相同的关系：\n$$S_{VG}''(h_m) = -\\frac{S_{VG}'(h_m)}{h_m}$$\n这对 van Genuchten 参数 $(\\alpha, n, m)$ 提供了一个约束，该约束与 Kosugi 参数 $\\sigma$ 无关。\n\n为了使用这个条件，我们现在计算 $S_{VG}(\\psi)$ 的导数。使用对数求导比较方便。设 $L(\\psi) = \\ln S_{VG}(\\psi) = -m \\ln\\left(1 + (\\alpha\\psi)^n\\right)$。\n$L'(\\psi) = \\frac{S_{VG}'(\\psi)}{S_{VG}(\\psi)}$。所以，$S_{VG}'(\\psi) = S_{VG}(\\psi)L'(\\psi)$。\n$S_{VG}''(\\psi) = S_{VG}'(\\psi)L'(\\psi) + S_{VG}(\\psi)L''(\\psi) = \\frac{(S_{VG}'(\\psi))^2}{S_{VG}(\\psi)} + S_{VG}(\\psi)L''(\\psi)$。\n\n将此代入我们的关键条件 $S_{VG}''(h_m) + \\frac{S_{VG}'(h_m)}{h_m} = 0$：\n$$\\frac{(S_{VG}'(h_m))^2}{S_{VG}(h_m)} + S_{VG}(h_m)L''(h_m) + \\frac{S_{VG}'(h_m)}{h_m} = 0$$\n在 $\\psi = h_m$ 处，我们有 $S_{VG}(h_m) = 1/2$。方程变为：\n$$2(S_{VG}'(h_m))^2 + \\frac{1}{2}L''(h_m) + \\frac{S_{VG}'(h_m)}{h_m} = 0$$\n现在我们计算 $L'(\\psi)$ 和 $L''(\\psi)$。设 $x(\\psi) = (\\alpha\\psi)^n$。\n$L'(\\psi) = -m \\frac{n(\\alpha\\psi)^{n-1}\\alpha}{1+(\\alpha\\psi)^n} = -\\frac{mn}{ \\psi}\\frac{(\\alpha\\psi)^n}{1+(\\alpha\\psi)^n} = -\\frac{mn}{\\psi}\\frac{x}{1+x}$。\n$L''(\\psi) = \\frac{d}{d\\psi}\\left(-\\frac{mn}{\\psi}\\frac{x}{1+x}\\right) = \\frac{mn}{\\psi^2}\\frac{x}{1+x} - \\frac{mn}{\\psi} \\frac{d}{d\\psi}\\left(\\frac{x}{1+x}\\right)$。\n$\\frac{x}{1+x}$ 的导数是 $\\frac{x'(1+x) - x(x')}{(1+x)^2} = \\frac{x'}{(1+x)^2}$。\n$x' = \\frac{d}{d\\psi}(\\alpha^n \\psi^n) = n\\alpha^n\\psi^{n-1} = \\frac{n}{\\psi}x$。\n所以，$\\frac{d}{d\\psi}\\left(\\frac{x}{1+x}\\right) = \\frac{nx}{\\psi(1+x)^2}$。\n$L''(\\psi) = \\frac{mnx}{\\psi^2(1+x)^2}\\left((1+x)-n\\right)$。\n\n在 $\\psi=h_m$ 处，我们有 $x(h_m) = (\\alpha h_m)^n = 2^{1/m}-1$ 和 $1+x(h_m) = 2^{1/m}$。\n$S_{VG}'(h_m) = S_{VG}(h_m) L'(h_m) = \\frac{1}{2} \\left(-\\frac{mn}{h_m}\\frac{2^{1/m}-1}{2^{1/m}}\\right) = -\\frac{mn}{2h_m}(1-2^{-1/m})$。\n$L''(h_m) = \\frac{mn(2^{1/m}-1)}{h_m^2(2^{1/m})^2}\\left(2^{1/m}-n\\right) = \\frac{mn(1-2^{-1/m})}{h_m^2 2^{1/m}}\\left(2^{1/m}-n\\right)$。\n\n将这些代入 $2(S_{VG}'(h_m))^2 + \\frac{1}{2}L''(h_m) + \\frac{S_{VG}'(h_m)}{h_m} = 0$ 中：\n$$2\\left(-\\frac{mn}{2h_m}(1-2^{-1/m})\\right)^2 + \\frac{1}{2}\\left(\\frac{mn(1-2^{-1/m})}{h_m^2 2^{1/m}}(2^{1/m}-n)\\right) - \\frac{1}{h_m}\\left(\\frac{mn}{2h_m}(1-2^{-1/m})\\right) = 0$$\n我们可以提出非零公因子 $\\frac{mn(1-2^{-1/m})}{2h_m^2}$：\n$$mn(1-2^{-1/m}) + \\frac{1}{2^{1/m}}(2^{1/m}-n) - 1 = 0$$\n$$mn - mn2^{-1/m} + 1 - n2^{-1/m} - 1 = 0$$\n$$mn - mn2^{-1/m} - n2^{-1/m} = 0$$\n由于 $n>0$，我们可以除以 $n$：\n$$m - m2^{-1/m} - 2^{-1/m} = 0$$\n$$m = m2^{-1/m} + 2^{-1/m} = (m+1)2^{-1/m}$$\n$$\\frac{m}{m+1} = 2^{-1/m}$$\n对两边取倒数：\n$$\\frac{m+1}{m} = 2^{1/m}$$\n$$1 + \\frac{1}{m} = 2^{1/m}$$\n我们需要求解这个关于 $m0$ 的超越方程。通过观察，我们可以看出 $m=1$ 是一个解：\n$$1 + \\frac{1}{1} = 2 \\quad \\text{和} \\quad 2^{1/1} = 2$$\n因此，$m=1$ 是满足二阶重合条件的解。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "一旦掌握了描述土壤储水能力的土壤-水特征曲线（SWCC），下一步便是预测水在其中的流动能力，即非饱和导水率。本练习通过应用Mualem模型，要求学生从一个给定的SWCC（Brooks-Corey模型）出发，通过解析积分推导出相对导水率函数 $k_{r}(S_{e})$ 。这项实践是连接土壤静态持水特性与动态输运性质的关键一步，它揭示了随着饱和度降低，导水率急剧下降的物理机制。",
            "id": "3561024",
            "problem": "一个均匀、各向同性的多孔介质表现出非饱和流，其土壤-水分特征曲线 (SWCC) 在主干燥和主湿润分支上均由 Brooks–Corey 关系描述。令有效饱和度定义为 $S_{e} = (\\theta - \\theta_{r})/(\\theta_{s} - \\theta_{r})$，其中 $\\theta$ 是体积含水量，$\\theta_{s}$ 是饱和含水量，$\\theta_{r}$ 是残余含水量。对于干燥分支，Brooks–Corey 关系为 $S_{e}(\\psi) = \\left(\\psi_{bd}/|\\psi|\\right)^{\\lambda}$，适用于 $|\\psi| \\ge \\psi_{bd}$；对于湿润分支，该关系为 $S_{e}(\\psi) = \\left(\\psi_{bw}/|\\psi|\\right)^{\\lambda}$，适用于 $|\\psi| \\ge \\psi_{bw}$，其中 $\\psi$ 是基质吸力水头（取其大小，为正值），$\\psi_{bd}  0$ 和 $\\psi_{bw}  0$ 分别是干燥和湿润时的进气水头，$\\lambda  0$ 是两个分支共有的孔径分布指数。\n\n根据 Mualem 连通性假说，相对导水率 $k_{r}(S_{e})$ 由 SWCC 表示为\n$$\nk_{r}(S_{e}) = S_{e}^{\\tau} \\left[\\frac{\\displaystyle \\int_{0}^{S_{e}} \\frac{\\mathrm{d}S}{|\\psi(S)|}}{\\displaystyle \\int_{0}^{1} \\frac{\\mathrm{d}S}{|\\psi(S)|}}\\right]^{2},\n$$\n其中 $\\tau$ 是一个常数，称为迂曲度-连通性参数，而 $|\\psi(S)|$ 表示通过 SWCC 表达为 $S$ 函数的基质吸力水头的大小。\n\n仅从上述定义和 Mualem 关系出发，通过不同的进气水头 $\\psi_{bd}$ 和 $\\psi_{bw}$ 但相同的 $\\lambda$ 来处理滞后现象，解析地计算积分，以获得 $k_{r}(S_{e})$ 作为 $S_{e}$、$\\lambda$ 和 $\\tau$ 函数的闭合形式表达式。然后，确定在 $S_{e} \\to 0$ 时控制 $k_{r}$ 低饱和度标度的指数，即 $k_{r}(S_{e}) \\sim S_{e}^{p}$。\n\n将您的最终答案表示为 $k_{r}(S_{e})$ 关于 $S_{e}$、$\\lambda$ 和 $\\tau$ 的单个闭合形式解析表达式。最终表达式中不要包含单位。无需进行数值计算。",
            "solution": "目标是基于 Brooks–Corey 土壤-水分特征曲线 (SWCC) 和 Mualem 模型，推导出相对导水率 $k_{r}(S_{e})$ 的闭合形式表达式。我们有以下给定的定义：\n\nBrooks-Corey SWCC 由 $S_{e}(\\psi) = \\left(\\frac{\\psi_{b}}{|\\psi|}\\right)^{\\lambda}$ 给出，适用于 $|\\psi| \\ge \\psi_{b}$，其中 $S_e$ 是有效饱和度，$\\psi$ 是基质吸力水头，$\\psi_{b}$ 是进气水头（干燥时为 $\\psi_{bd}$，湿润时为 $\\psi_{bw}$），$\\lambda$ 是孔径分布指数。\n\nMualem 的相对导水率模型是\n$$\nk_{r}(S_{e}) = S_{e}^{\\tau} \\left[\\frac{\\displaystyle \\int_{0}^{S_{e}} \\frac{\\mathrm{d}S}{|\\psi(S)|}}{\\displaystyle \\int_{0}^{1} \\frac{\\mathrm{d}S}{|\\psi(S)|}}\\right]^{2}\n$$\n其中 $\\tau$ 是一个迂曲度-连通性参数。\n\n第一步是将基质吸力 $|\\psi|$ 表示为有效饱和度 $S_{e}$ 的函数。我们对 Brooks-Corey 关系进行反演：\n$$\nS_{e} = \\left(\\frac{\\psi_{b}}{|\\psi|}\\right)^{\\lambda}\n$$\n将两边同时取 $1/\\lambda$ 次幂：\n$$\nS_{e}^{1/\\lambda} = \\frac{\\psi_{b}}{|\\psi|}\n$$\n重新整理以求解 $|\\psi|$，得到反函数关系：\n$$\n|\\psi(S_{e})| = \\psi_{b} S_{e}^{-1/\\lambda}\n$$\n这个表达式将基质吸力与有效饱和度联系起来。我们将在 Mualem 积分中使用这个表达式，并将积分变量 $S_{e}$ 替换为 $S$：\n$$\n|\\psi(S)| = \\psi_{b} S^{-1/\\lambda}\n$$\n\n接下来，我们计算 Mualem 表达式中分子的积分，我们将其记为 $I_{\\text{num}}$：\n$$\nI_{\\text{num}}(S_{e}) = \\int_{0}^{S_{e}} \\frac{\\mathrm{d}S}{|\\psi(S)|} = \\int_{0}^{S_{e}} \\frac{\\mathrm{d}S}{\\psi_{b} S^{-1/\\lambda}}\n$$\n我们可以将常数项 $1/\\psi_{b}$ 移到积分符号外：\n$$\nI_{\\text{num}}(S_{e}) = \\frac{1}{\\psi_{b}} \\int_{0}^{S_{e}} S^{1/\\lambda} \\mathrm{d}S\n$$\n这是一个标准的幂律积分。由于 $\\lambda  0$，指数 $1/\\lambda$ 为正，因此 $1/\\lambda+1$ 也为正。积分为：\n$$\nI_{\\text{num}}(S_{e}) = \\frac{1}{\\psi_{b}} \\left[ \\frac{S^{1/\\lambda + 1}}{1/\\lambda + 1} \\right]_{0}^{S_{e}} = \\frac{1}{\\psi_{b}} \\frac{S_{e}^{1 + 1/\\lambda}}{1 + 1/\\lambda}\n$$\n简化指数和分母：\n$$\n1 + \\frac{1}{\\lambda} = \\frac{\\lambda+1}{\\lambda}\n$$\n因此，分子积分为：\n$$\nI_{\\text{num}}(S_{e}) = \\frac{1}{\\psi_{b}} \\frac{S_{e}^{(\\lambda+1)/\\lambda}}{(\\lambda+1)/\\lambda} = \\frac{\\lambda}{\\psi_{b}(\\lambda+1)} S_{e}^{(\\lambda+1)/\\lambda}\n$$\n\n现在，我们计算分母中的积分，记为 $I_{\\text{den}}$。这个积分与分子积分相同，但计算到完全饱和的上限，即 $S_{e}=1$。\n$$\nI_{\\text{den}} = \\int_{0}^{1} \\frac{\\mathrm{d}S}{|\\psi(S)|} = \\frac{1}{\\psi_{b}} \\int_{0}^{1} S^{1/\\lambda} \\mathrm{d}S\n$$\n使用与之前相同的积分结果，但上限为 $1$：\n$$\nI_{\\text{den}} = \\frac{1}{\\psi_{b}} \\left[ \\frac{S^{(\\lambda+1)/\\lambda}}{(\\lambda+1)/\\lambda} \\right]_{0}^{1} = \\frac{1}{\\psi_{b}} \\frac{1^{(\\lambda+1)/\\lambda}}{(\\lambda+1)/\\lambda} = \\frac{\\lambda}{\\psi_{b}(\\lambda+1)}\n$$\n\n下一步是计算这两个积分的比值：\n$$\n\\frac{I_{\\text{num}}(S_{e})}{I_{\\text{den}}} = \\frac{\\frac{\\lambda}{\\psi_{b}(\\lambda+1)} S_{e}^{(\\lambda+1)/\\lambda}}{\\frac{\\lambda}{\\psi_{b}(\\lambda+1)}} = S_{e}^{(\\lambda+1)/\\lambda}\n$$\n这里一个重要的结果是，进气水头 $\\psi_{b}$ 在比值中被消掉了。这意味着得到的相对导水率函数 $k_{r}(S_{e})$ 与使用的是 SWCC 的干燥分支 ($\\psi_{bd}$) 还是湿润分支 ($\\psi_{bw}$) 无关。因此，Mualem–Brooks-Corey 模型预测了相对导水率与有效饱和度之间存在一个非滞后关系 $k_{r}(S_{e})$。\n\n最后，我们将这个比值代回 Mualem 方程，求 $k_{r}(S_{e})$：\n$$\nk_{r}(S_{e}) = S_{e}^{\\tau} \\left[ \\frac{I_{\\text{num}}(S_{e})}{I_{\\text{den}}} \\right]^{2} = S_{e}^{\\tau} \\left( S_{e}^{(\\lambda+1)/\\lambda} \\right)^{2}\n$$\n使用指数性质 $(x^{a})^{b} = x^{ab}$：\n$$\nk_{r}(S_{e}) = S_{e}^{\\tau} S_{e}^{2(\\lambda+1)/\\lambda}\n$$\n使用指数性质 $x^{a}x^{b} = x^{a+b}$：\n$$\nk_{r}(S_{e}) = S_{e}^{\\tau + 2(\\lambda+1)/\\lambda}\n$$\n我们来简化指数：\n$$\n\\tau + \\frac{2(\\lambda+1)}{\\lambda} = \\tau + \\frac{2\\lambda + 2}{\\lambda} = \\tau + 2 + \\frac{2}{\\lambda}\n$$\n所以，相对导水率的最终闭合形式表达式是：\n$$\nk_{r}(S_{e}) = S_{e}^{\\tau + 2 + 2/\\lambda}\n$$\n\n问题还要求确定在 $S_{e} \\to 0$ 时控制 $k_{r}$ 低饱和度标度的指数，即 $k_{r}(S_{e}) \\sim S_{e}^{p}$。从我们推导的表达式中可以立即看出，该函数是 $S_e$ 的一个幂律函数。因此，标度指数 $p$ 就是我们刚刚推导出的指数：\n$$\np = \\tau + 2 + \\frac{2}{\\lambda}\n$$\n这个指数决定了当多孔介质去饱和时导水率的快速下降。\n\n要求的最终答案是 $k_{r}(S_{e})$ 的闭合形式解析表达式。",
            "answer": "$$\n\\boxed{S_{e}^{\\tau + 2 + \\frac{2}{\\lambda}}}\n$$"
        },
        {
            "introduction": "在实际的干湿循环过程中，土壤的水力特性表现出显著的滞回效应，这给数值模拟带来了巨大挑战。为了准确预测非饱和流动，必须在控制方程（即Richards方程）的求解中恰当处理这种路径依赖性。本练习直面这一高级课题，要求学生为包含完整滞回模型的Richards方程推导其牛顿法线性化后的雅可比矩阵项。这项高阶练习是连接理论与计算实践的桥梁，它培养了在开发高级岩土工程模拟软件时，处理复杂本构关系所必需的核心数值分析技能。",
            "id": "3561012",
            "problem": "考虑由 Richards 方程控制的非饱和土壤中一维垂向水流，该方程以压力水头 $\\psi$ 和总水力水头 $H = \\psi + z$ 来表示，其中 $z$ 是向上测量的标高。设体积含水量为 $\\theta(\\psi)$，非饱和导水率为 $k(\\psi)$。土水特征曲线 (SWCC) 和导水率表现出滞回现象，具有不同的湿润和干燥边界曲线以及介于两者之间的扫描曲线。假设采用以下建模框架，该框架与广泛使用的滞回本构描述一致：\n\n- 湿润和干燥边界 SWCC 由 van Genuchten 形式给出：对于分支 $b \\in \\{w,d\\}$，\n$$S_{e,b}(\\psi) = \\left[1 + \\left(\\alpha_{b}|\\psi|\\right)^{n_{b}}\\right]^{-m_{b}}, \\quad m_{b} = 1 - \\frac{1}{n_{b}},$$\n其中 $S_{e,b}$ 是分支 $b$ 上的有效饱和度，$\\alpha_{b}  0$ 和 $n_{b}  1$ 是分支 $b$ 的材料参数，$|\\psi|$ 表示压力水头的绝对值。体积含水量为\n$$\\theta_{b}(\\psi) = \\theta_{r} + (\\theta_{s} - \\theta_{r})S_{e,b}(\\psi),$$\n其中 $\\theta_{r}$ 为残余含水量，$\\theta_{s}$ 为饱和含水量。\n\n- 分支 $b$ 上的非饱和导水率由 Mualem-van Genuchten 关系给出：\n$$k_{b}(\\psi) = k_{s}S_{e,b}(\\psi)^{\\ell}\\left\\{1 - \\left[1 - S_{e,b}(\\psi)^{1/m_{b}}\\right]^{m_{b}}\\right\\}^{2},$$\n其中 $k_{s}$ 是饱和导水率，$\\ell$ 是孔隙连通性参数。\n\n- 湿润和干燥之间的扫描曲线通过在边界曲线之间对有效饱和度和导水率进行线性插值来定义，使用与当前扫描的反转点对相关联的固定扫描权重 $\\xi \\in [0,1]$：\n$$S_{e,\\text{scan}}(\\psi) = S_{e,w}(\\psi) + \\xi\\left[S_{e,d}(\\psi) - S_{e,w}(\\psi)\\right],\\quad k_{\\text{scan}}(\\psi) = k_{w}(\\psi) + \\xi\\left[k_{d}(\\psi) - k_{w}(\\psi)\\right].$$\n\n令 $I_{w}, I_{d}, I_{s} \\in \\{0,1\\}$ 为在当前迭代步选择活动分支的指示函数：如果活动分支是湿润，则 $I_{w} = 1$；如果干燥，则 $I_{d} = 1$；如果扫描，则 $I_{s} = 1$；在任何迭代步，恰好有一个指示函数为 $1$，其余为 $0$。在一次 Newton 迭代中，将 $I_{w}, I_{d}, I_{s}, \\xi$ 视为关于 $\\psi$ 的常数（分支切换在迭代之间更新这些常数，而不是在迭代内部）。\n\n使用后向欧拉法在时间上对 Richards 方程进行离散化，时间步长为 $\\Delta t  0$；在空间上使用间距为 $h  0$ 的均匀网格，并对界面导水率进行算术平均：\n$$k_{i+\\frac{1}{2}} = \\frac{k(\\psi_{i}) + k(\\psi_{i+1})}{2}, \\quad k_{i-\\frac{1}{2}} = \\frac{k(\\psi_{i}) + k(\\psi_{i-1})}{2}.$$\n内部节点 $i$ 处关于未知量 $\\psi_{i}^{n+1}$ 的离散残差为\n$$R_{i}(\\psi^{n+1}) = \\frac{\\theta(\\psi_{i}^{n+1}) - \\theta(\\psi_{i}^{n})}{\\Delta t} - \\frac{1}{h}\\left[\\frac{k_{i+\\frac{1}{2}}(\\psi^{n+1})\\left(H_{i+1}^{n+1} - H_{i}^{n+1}\\right)}{h} - \\frac{k_{i-\\frac{1}{2}}(\\psi^{n+1})\\left(H_{i}^{n+1} - H_{i-1}^{n+1}\\right)}{h}\\right],$$\n其中 $H_{j}^{n+1} = \\psi_{j}^{n+1} + z_{j}$。\n\n从这些定义和离散化出发，推导残差的一致 Newton 线性化，其中包含滞回系数。在线性化过程中，沿着活动分支对 $\\theta(\\psi)$ 和 $k(\\psi)$ 进行微分，同时保持 $I_{w}, I_{d}, I_{s}, \\xi$ 为常数。将雅可比矩阵对角元 $\\partial R_{i}/\\partial \\psi_{i}^{n+1}$ 表示为一个单一的闭合形式解析表达式，该表达式依赖于 $\\theta_{s}, \\theta_{r}, k_{s}, \\ell, \\alpha_{b}, n_{b}, m_{b}, h, \\Delta t, \\psi_{i}^{n+1}, \\psi_{i\\pm1}^{n+1}, z_{i\\pm1}$、指示函数 $I_{w}, I_{d}, I_{s}$ 以及扫描权重 $\\xi$。使用 Heaviside 函数 $\\mathcal{H}(-\\psi)$ 来确保在饱和区 $\\psi \\ge 0$ 中导数为零。为保证可微性，假设 $\\psi_{i}^{n+1}  0$，但在最终表达式中显式地包含 $\\mathcal{H}(-\\psi_{i}^{n+1})$，以保证在接近饱和时的正确性。\n\n你的最终答案必须是关于 $\\partial R_{i}/\\partial \\psi_{i}^{n+1}$ 的单一闭合形式解析表达式。不要提供数值。不要在最终的方框答案中包含单位。",
            "solution": "该问题要求推导带有滞回效应的离散化 Richards 方程的 Newton-Raphson 线性化所对应的雅可比矩阵对角元 $\\frac{\\partial R_{i}}{\\partial \\psi_{i}^{n+1}}$。\n\n为简化推导过程中的符号，令 $\\psi_{j}$ 表示在时间步 $n+1$ 时节点 $j$ 处的未知压力水头，即 $\\psi_{j} \\equiv \\psi_{j}^{n+1}$。内部节点 $i$ 处的残差由下式给出\n$$R_{i} = \\frac{\\theta(\\psi_{i}) - \\theta(\\psi_{i}^{n})}{\\Delta t} - \\frac{1}{h}\\left[\\frac{k_{i+\\frac{1}{2}}(\\psi)\\left(H_{i+1} - H_{i}\\right)}{h} - \\frac{k_{i-\\frac{1}{2}}(\\psi)\\left(H_{i} - H_{i-1}\\right)}{h}\\right]$$\n其中 $H_{j} = \\psi_{j} + z_{j}$，$k_{i+\\frac{1}{2}} = \\frac{k(\\psi_{i}) + k(\\psi_{i+1})}{2}$，以及 $k_{i-\\frac{1}{2}} = \\frac{k(\\psi_{i}) + k(\\psi_{i-1})}{2}$。\n\n我们计算 $R_{i}$ 关于 $\\psi_{i}$ 的偏导数。项 $\\theta(\\psi_i^n)$ 是来自前一个时间步的常数，因此其导数为零。该导数由两个主要部分组成：储水项和通量散度项。\n\n1.  **储水项的导数：**\n    $R_i$ 的第一项是时间离散的储水项。其关于 $\\psi_i$ 的导数为：\n    $$\\frac{\\partial}{\\partial \\psi_{i}}\\left(\\frac{\\theta(\\psi_{i}) - \\theta(\\psi_i^n)}{\\Delta t}\\right) = \\frac{1}{\\Delta t}\\frac{d\\theta}{d\\psi_{i}}$$\n    此处，$\\frac{d\\theta}{d\\psi_{i}}$ 是比水容量，通常记作 $C(\\psi_i)$。\n\n2.  **通量散度项的导数：**\n    设通量散度项为 $D_i = \\frac{1}{h^2}\\left[k_{i+\\frac{1}{2}}(H_{i+1} - H_{i}) - k_{i-\\frac{1}{2}}(H_{i} - H_{i-1})\\right]$。我们需要求解 $-\\frac{\\partial D_i}{\\partial \\psi_i}$。我们对 $D_i$ 的每个部分关于 $\\psi_i$ 求导：\n    \n    对于涉及节点 $i$ 和 $i+1$ 之间通量的项：\n    $$\\frac{\\partial}{\\partial \\psi_{i}}\\left[k_{i+\\frac{1}{2}}(H_{i+1} - H_{i})\\right] = \\frac{\\partial}{\\partial \\psi_{i}}\\left[\\frac{k(\\psi_{i}) + k(\\psi_{i+1})}{2}(\\psi_{i+1} - \\psi_{i} + z_{i+1} - z_{i})\\right]$$\n    使用乘法法则，并注意 $\\psi_{i+1}$、$k(\\psi_{i+1})$ 及所有 $z_j$ 均独立于 $\\psi_i$：\n    $$ = \\left(\\frac{1}{2}\\frac{dk}{d\\psi_{i}}\\right)(\\psi_{i+1} - \\psi_{i} + z_{i+1} - z_{i}) + \\left(\\frac{k(\\psi_{i}) + k(\\psi_{i+1})}{2}\\right)(-1) = \\frac{1}{2}\\frac{dk}{d\\psi_{i}}(H_{i+1} - H_{i}) - k_{i+\\frac{1}{2}}$$\n\n    对于涉及节点 $i-1$ 和 $i$ 之间通量的项：\n    $$\\frac{\\partial}{\\partial \\psi_{i}}\\left[k_{i-\\frac{1}{2}}(H_{i} - H_{i-1})\\right] = \\frac{\\partial}{\\partial \\psi_{i}}\\left[\\frac{k(\\psi_{i}) + k(\\psi_{i-1})}{2}(\\psi_{i} - \\psi_{i-1} + z_{i} - z_{i-1})\\right]$$\n    $$ = \\left(\\frac{1}{2}\\frac{dk}{d\\psi_{i}}\\right)(\\psi_i - \\psi_{i-1} + z_i - z_{i-1}) + \\left(\\frac{k(\\psi_{i}) + k(\\psi_{i-1})}{2}\\right)(1) = \\frac{1}{2}\\frac{dk}{d\\psi_{i}}(H_{i} - H_{i-1}) + k_{i-\\frac{1}{2}}$$\n\n    综合这些结果，散度项的导数为：\n    $$-\\frac{\\partial D_i}{\\partial \\psi_i} = -\\frac{1}{h^2} \\left[ \\left(\\frac{1}{2}\\frac{dk}{d\\psi_{i}}(H_{i+1} - H_{i}) - k_{i+\\frac{1}{2}}\\right) - \\left(\\frac{1}{2}\\frac{dk}{d\\psi_{i}}(H_{i} - H_{i-1}) + k_{i-\\frac{1}{2}}\\right) \\right]$$\n    $$ = -\\frac{1}{h^2} \\left[ \\frac{1}{2}\\frac{dk}{d\\psi_{i}}(H_{i+1} - 2H_i + H_{i-1}) - (k_{i+\\frac{1}{2}} + k_{i-\\frac{1}{2}}) \\right]$$\n    $$ = \\frac{k_{i+\\frac{1}{2}} + k_{i-\\frac{1}{2}}}{h^2} - \\frac{1}{2h^2}\\frac{dk}{d\\psi_{i}}(H_{i+1} - 2H_i + H_{i-1})$$\n\n3.  **组合完整的雅可比元：**\n    将储水项和散度项的导数相加，我们得到：\n    $$\\frac{\\partial R_i}{\\partial \\psi_i} = \\frac{1}{\\Delta t}\\frac{d\\theta}{d\\psi_{i}} + \\frac{k_{i+\\frac{1}{2}} + k_{i-\\frac{1}{2}}}{h^2} - \\frac{1}{2h^2}\\frac{dk}{d\\psi_{i}}(H_{i+1} - 2H_i + H_{i-1})$$\n    代入 $k_{i\\pm\\frac{1}{2}}$ 的定义，得到：\n    $$\\frac{\\partial R_i}{\\partial \\psi_i} = \\frac{1}{\\Delta t}\\frac{d\\theta}{d\\psi_{i}} + \\frac{k(\\psi_i) + \\frac{1}{2}(k(\\psi_{i+1}) + k(\\psi_{i-1}))}{h^2} - \\frac{1}{2h^2}\\frac{dk}{d\\psi_{i}}(\\psi_{i+1} - 2\\psi_i + \\psi_{i-1} + z_{i+1} - 2z_i + z_{i-1})$$\n\n4.  **滞回本构函数的导数：**\n    问题指定了一个滞回模型，其中活动分支由指示函数 $I_w, I_d, I_s$ 和扫描权重 $\\xi$ 选择。在 Newton 迭代中，这些被视为常数。活动分支的贡献是湿润（$b=w$）和干燥（$b=d$）边界曲线的线性组合。令 $W_w = I_w + I_s(1-\\xi)$ 和 $W_d = I_d + I_s\\xi$。\n\n    -   **体积含水量 ($\\theta$) 的导数：**\n        $\\theta(\\psi) = \\theta_r + (\\theta_s - \\theta_r) \\left[ W_w S_{e,w}(\\psi) + W_d S_{e,d}(\\psi) \\right]$。\n        因此，$\\frac{d\\theta}{d\\psi} = (\\theta_s - \\theta_r) \\left[ W_w \\frac{dS_{e,w}}{d\\psi} + W_d \\frac{dS_{e,d}}{d\\psi} \\right]$。\n        对于给定的分支 $b \\in \\{w, d\\}$，并假设 $\\psi  0$，因此 $|\\psi| = -\\psi$：\n        $S_{e,b}(\\psi) = \\left[1 + (-\\alpha_{b}\\psi)^{n_{b}}\\right]^{-m_{b}}$。\n        导数为：\n        $$\\frac{dS_{e,b}}{d\\psi} = -m_b\\left[1+(-\\alpha_b \\psi)^{n_b}\\right]^{-m_b-1} \\cdot n_b(-\\alpha_b \\psi)^{n_b-1} \\cdot (-\\alpha_b) = \\alpha_b m_b n_b (-\\alpha_b\\psi)^{n_b-1} \\left[1+(-\\alpha_b\\psi)^{n_b}\\right]^{-m_b-1}$$\n        问题要求当 $\\psi \\ge 0$ 时此导数为零。我们通过乘以 Heaviside 函数 $\\mathcal{H}(-\\psi)$ 来实现这一点。\n\n    -   **导水率 ($k$) 的导数：**\n        $k(\\psi) = W_w k_w(\\psi) + W_d k_d(\\psi)$。\n        所以，$\\frac{dk}{d\\psi} = W_w \\frac{dk_w}{d\\psi} + W_d \\frac{dk_d}{d\\psi}$。\n        对于分支 $b$，$k_b$ 由 Mualem-van Genuchten 模型给出。我们使用链式法则：$\\frac{dk_b}{d\\psi} = \\frac{dk_b}{dS_{e,b}} \\frac{dS_{e,b}}{d\\psi}$。我们已经有了 $\\frac{dS_{e,b}}{d\\psi}$。\n        暂时将 $S_{e,b}$ 作为自变量。\n        $k_b(S_{e,b}) = k_s S_{e,b}^\\ell \\left\\{1 - \\left[1 - S_{e,b}^{1/m_b}\\right]^{m_b}\\right\\}^2$。\n        令 $T_b(S_{e,b}) = \\left\\{1 - \\left[1 - S_{e,b}^{1/m_b}\\right]^{m_b}\\right\\}$。\n        $\\frac{dk_b}{dS_{e,b}} = \\frac{d}{dS_{e,b}} \\left( k_s S_{e,b}^\\ell T_b^2 \\right) = k_s\\left(\\ell S_{e,b}^{\\ell-1} T_b^2 + S_{e,b}^\\ell \\cdot 2T_b \\frac{dT_b}{dS_{e,b}}\\right)$。\n        $\\frac{dT_b}{dS_{e,b}} = -m_b\\left[1 - S_{e,b}^{1/m_b}\\right]^{m_b-1} \\cdot \\left(-\\frac{1}{m_b}S_{e,b}^{\\frac{1}{m_b}-1}\\right) = \\left[1 - S_{e,b}^{1/m_b}\\right]^{m_b-1} S_{e,b}^{\\frac{1}{m_b}-1}$。\n        将此代入 $k_b$ 的导数中：\n        $$\\frac{dk_b}{dS_{e,b}} = k_s S_{e,b}^{\\ell-1} T_b \\left( \\ell T_b + 2S_{e,b} \\frac{dT_b}{dS_{e,b}} \\right) = k_s S_{e,b}^{\\ell-1} T_b \\left( \\ell T_b + 2 S_{e,b}^{1/m_b} [1-S_{e,b}^{1/m_b}]^{m_b-1} \\right)$$\n        与 $\\frac{d\\theta}{d\\psi}$ 一样，导数 $\\frac{dk}{d\\psi}$ 必须乘以 $\\mathcal{H}(-\\psi)$ 以确保在 $\\psi \\ge 0$ 时为零。\n\n通过将这些表达式代入 $\\frac{\\partial R_i}{\\partial \\psi_i}$ 的公式中，并恢复时间索引 $n+1$，我们得到最终的闭合形式表达式。为了保持最终表达式的清晰性，我们定义以下在通用水头 $\\psi$ 处求值的特定分支函数：\n$$S_{e,b}(\\psi) = \\left[1 + (\\alpha_{b}|\\psi|)^{n_{b}}\\right]^{-m_{b}}$$\n$$k_b(\\psi) = k_s S_{e,b}(\\psi)^{\\ell} \\left\\{1 - \\left[1 - S_{e,b}(\\psi)^{1/m_b}\\right]^{m_b}\\right\\}^2$$\n对于在 $\\psi_i^{n+1}$ 处求值的导数（其中 $\\psi_i^{n+1}  0$），我们定义：\n$$S'_{e,b}(\\psi_i^{n+1}) = \\alpha_b m_b n_b (-\\alpha_b \\psi_i^{n+1})^{n_b-1} \\left[1+(-\\alpha_b \\psi_i^{n+1})^{n_b}\\right]^{-m_b-1}$$\n$$\\frac{dk_b}{dS_{e,b}}(\\psi_i^{n+1}) = k_s \\left[ \\ell S_{e,b}(\\psi_i^{n+1})^{\\ell-1} \\left\\{1-\\dots\\right\\}^2 + 2 S_{e,b}(\\psi_i^{n+1})^{\\ell} \\left\\{1-\\dots\\right\\} \\left[1-S_{e,b}(\\psi_i^{n+1})^{1/m_b}\\right]^{m_b-1} S_{e,b}(\\psi_i^{n+1})^{\\frac{1}{m_b}-1} \\right]$$\n其中 $\\{1-\\dots\\}$ 代表 $T_b(S_{e,b}(\\psi_i^{n+1}))$。最终的组合表达式是基于这些分量构建的。",
            "answer": "$$\\boxed{\\begin{aligned} \\frac{1}{\\Delta t} (\\theta_s - \\theta_r) \\mathcal{H}(-\\psi_i^{n+1}) \\Big( (I_w + I_s(1-\\xi)) S'_{e,w}(\\psi_i^{n+1}) + (I_d + I_s\\xi) S'_{e,d}(\\psi_i^{n+1}) \\Big) \\\\ + \\frac{1}{h^2} \\Big( (I_w + I_s(1-\\xi)) k_w(\\psi_i^{n+1}) + (I_d + I_s\\xi) k_d(\\psi_i^{n+1}) \\Big) \\\\ + \\frac{1}{2h^2} \\Big( (I_w + I_s(1-\\xi)) (k_w(\\psi_{i+1}^{n+1}) + k_w(\\psi_{i-1}^{n+1})) + (I_d + I_s\\xi) (k_d(\\psi_{i+1}^{n+1}) + k_d(\\psi_{i-1}^{n+1})) \\Big) \\\\ - \\frac{1}{2h^2} (\\psi_{i+1}^{n+1} - 2\\psi_i^{n+1} + \\psi_{i-1}^{n+1} + z_{i+1} - 2z_i + z_{i-1}) \\mathcal{H}(-\\psi_i^{n+1}) \\Big( (I_w + I_s(1-\\xi)) \\frac{dk_w}{d\\psi}(\\psi_i^{n+1}) + (I_d + I_s\\xi) \\frac{dk_d}{d\\psi}(\\psi_i^{n+1}) \\Big) \\\\ \\text{其中对于 } b \\in \\{w, d\\} \\text{ 和任意 } \\psi_j^{n+1}: \\\\ S_{e,b}(\\psi_j^{n+1}) = \\left[1 + (\\alpha_b|\\psi_j^{n+1}|)^{n_b}\\right]^{-m_b} \\\\ T_b(\\psi_j^{n+1}) = 1 - \\left[1 - S_{e,b}(\\psi_j^{n+1})^{1/m_b}\\right]^{m_b} \\\\ k_b(\\psi_j^{n+1}) = k_s S_{e,b}(\\psi_j^{n+1})^{\\ell} T_b(\\psi_j^{n+1})^2 \\\\ \\text{以及对于 } b \\in \\{w,d\\} \\text{ 在 } \\psi_i^{n+1} \\text{ 处}: \\\\ S'_{e,b}(\\psi_i^{n+1}) = \\alpha_b m_b n_b (-\\alpha_b \\psi_i^{n+1})^{n_b-1} \\left[1+(-\\alpha_b \\psi_i^{n+1})^{n_b}\\right]^{-m_b-1} \\\\ \\frac{dk_b}{d\\psi}(\\psi_i^{n+1}) = S'_{e,b}(\\psi_i^{n+1}) \\cdot k_s S_{e,b}(\\psi_i^{n+1})^{\\ell-1} T_b(\\psi_i^{n+1}) \\left( \\ell T_b(\\psi_i^{n+1}) + 2 S_{e,b}(\\psi_i^{n+1})^{1/m_b} \\left[1-S_{e,b}(\\psi_i^{n+1})^{1/m_b}\\right]^{m_b-1} \\right) \\end{aligned}}$$"
        }
    ]
}