{
    "hands_on_practices": [
        {
            "introduction": "Understanding the $\\mu(I)$ rheology begins with mastering its core relationship. This exercise provides a direct application of the constitutive law, where you will calculate the macroscopic friction coefficient, $\\mu$, for a debris flow under specified kinematic and stress conditions . This foundational practice ensures you can confidently translate the physical state of a flow, including the critical role of pore pressure in defining the effective stress, into the material's frictional response as predicted by the model.",
            "id": "3516322",
            "problem": "A dense, saturated debris flow is idealized as a plane shear of a granular mixture under steady, homogeneous conditions. At a representative location, the measured total normal stress is $\\sigma_{n}=20\\,\\mathrm{kPa}$ and the pore fluid pressure is $p_{f}=12\\,\\mathrm{kPa}$. The solid grains have diameter $d=1\\,\\mathrm{mm}$ and solid density $\\rho_{s}=2500\\,\\mathrm{kg/m^{3}}$. The material exhibits the standard frictional rheology with $\\mu(I)$ behavior for dense granular flows, characterized by parameters $\\mu_{s}=0.4$, $\\mu_{2}=0.8$, and $I_{0}=0.3$. The imposed shear rate is $\\dot{\\gamma}=5\\,\\mathrm{s^{-1}}$. The inertial number $I$ is defined by\n$$\nI=d\\,\\dot{\\gamma}\\,\\sqrt{\\frac{\\rho_{s}}{P}},\n$$\nwhere $P=\\sigma_{n}-p_{f}$ is the effective (Terzaghi) normal stress. Under these conditions, compute the dimensionless macroscopic friction coefficient\n$$\n\\mu=\\frac{\\tau}{\\sigma_{n}-p_{f}}\n$$\nrequired to sustain steady shear. Report $\\mu$ as a dimensionless number, rounded to four significant figures.",
            "solution": "The debris flow is treated within the dense granular $\\mu(I)$ framework, which connects the dimensionless friction coefficient $\\mu$ to the inertial number $I$. The effective (Terzaghi) normal stress is given by\n$$\nP=\\sigma_{n}-p_{f}.\n$$\nThis effective stress governs grain-scale normal loading in the presence of interstitial fluid pressure and enters the inertial number through the ratio $\\rho_{s}/P$. The inertial number compares the shearing timescale to an inertial rearrangement timescale of grains:\n$$\nI=d\\,\\dot{\\gamma}\\,\\sqrt{\\frac{\\rho_{s}}{P}},\n$$\nwhere $d$ is the grain diameter, $\\dot{\\gamma}$ is the shear rate, and $\\rho_{s}$ is the solid density. The $\\mu(I)$ rheology prescribes that the friction coefficient depends on $I$ through the parameters $\\mu_{s}$, $\\mu_{2}$, and $I_{0}$, yielding\n$$\n\\mu=\\mu_{s}+(\\mu_{2}-\\mu_{s})\\,\\frac{I}{I_{0}+I}.\n$$\nFirst compute the effective stress:\n$$\nP=\\sigma_{n}-p_{f}=20\\,\\mathrm{kPa}-12\\,\\mathrm{kPa}=8\\,\\mathrm{kPa}=8000\\,\\mathrm{Pa}.\n$$\nNext compute the inertial number. Using $d=1\\,\\mathrm{mm}=10^{-3}\\,\\mathrm{m}$, $\\dot{\\gamma}=5\\,\\mathrm{s^{-1}}$, and $\\rho_{s}=2500\\,\\mathrm{kg/m^{3}}$,\n$$\n\\frac{\\rho_{s}}{P}=\\frac{2500\\,\\mathrm{kg/m^{3}}}{8000\\,\\mathrm{Pa}}=\\frac{2500}{8000}=\\frac{5}{16},\n$$\nso\n$$\nI=d\\,\\dot{\\gamma}\\,\\sqrt{\\frac{\\rho_{s}}{P}}=10^{-3}\\times 5 \\times \\sqrt{\\frac{5}{16}}=5\\times 10^{-3}\\times \\frac{\\sqrt{5}}{4}=\\left(1.25\\times 10^{-3}\\right)\\sqrt{5}.\n$$\nNumerically, $\\sqrt{5}\\approx 2.236067977$, hence\n$$\nI\\approx 1.25\\times 10^{-3}\\times 2.236067977\\approx 2.79508497\\times 10^{-3}.\n$$\nNow evaluate the friction coefficient using the $\\mu(I)$ law with $\\mu_{s}=0.4$, $\\mu_{2}=0.8$, and $I_{0}=0.3$:\n$$\n\\mu=\\mu_{s}+(\\mu_{2}-\\mu_{s})\\,\\frac{I}{I_{0}+I}\n=0.4+0.4\\,\\frac{2.79508497\\times 10^{-3}}{0.3+2.79508497\\times 10^{-3}}.\n$$\nCompute the ratio:\n$$\n\\frac{I}{I_{0}+I}=\\frac{2.79508497\\times 10^{-3}}{0.30279508497}\\approx 9.23093\\times 10^{-3}.\n$$\nThus,\n$$\n\\mu\\approx 0.4+0.4\\times 9.23093\\times 10^{-3}\n=0.4+3.69237\\times 10^{-3}\n\\approx 0.40369237.\n$$\nRounded to four significant figures, the required dimensionless friction coefficient is\n$$\n\\mu\\approx 0.4037.\n$$\nThis value is slightly above $\\mu_{s}$ because the inertial number $I$ is much smaller than $I_{0}$, leading to a modest rate-dependent increase in friction relative to the quasi-static limit.",
            "answer": "$$\\boxed{0.4037}$$"
        },
        {
            "introduction": "Beyond simple calculations, rheological models offer powerful tools for predicting real-world geophysical phenomena. This problem challenges you to apply the $\\mu(I)$ framework to a classic geomechanics scenario: assessing the stability of a debris layer on an inclined plane . By comparing the gravitational driving stress with the material's minimum basal resistance, which includes both cohesive and frictional components, you will determine whether a steady flow is physically possible, thereby gaining insight into the critical conditions for landslide initiation.",
            "id": "3516235",
            "problem": "Consider a dense, saturated granular debris layer of uniform thickness sliding down a rigid plane inclined at an angle $\\theta$ to the horizontal. Assume a steady, uniform configuration so that the downslope Cauchy momentum balance reduces to a local balance between the gravitational body force component and the shear resistance at the base. Let the basal shear stress be decomposed into an additive cohesive (rate-independent) contribution $\\tau_{c}$ and a frictional contribution governed by a friction coefficient with inertial-number dependence $\\mu(I)$, where $I$ is the inertial number. The normal stress is the mean lithostatic pressure $P$. Assume $\\mu(I)$ is a non-decreasing function of $I$ with $\\mu(0)=\\mu_{s}$, where $\\mu_{s}$ is the static friction coefficient.\n\nStarting from first principles, derive the condition under which a steady uniform flow is admissible on the slope. If a steady flow is admissible, show how to compute the inertial number $I$ consistent with the stress ratio imposed by gravity. Use the following data:\n- $\\tau_{c}=1$ $\\mathrm{kPa}$,\n- $P=10$ $\\mathrm{kPa}$,\n- $\\mu_{s}=0.4$,\n- $\\theta=15^{\\circ}$.\n\nExpress the final inertial number $I$ as a pure number. If steady flow is not admissible for the given data, report $I=0$ as the answer. No rounding is required.",
            "solution": "The problem asks for the condition under which a steady, uniform debris flow is admissible on an inclined plane and to compute the corresponding inertial number, $I$. The analysis begins from the first principle of momentum balance.\n\nFor a steady, uniform flow down a plane inclined at an angle $\\theta$, the momentum balance in the downslope direction simplifies to a balance between the gravitational driving stress, $\\tau_d$, and the basal resisting stress, $\\tau_b$.\n\nLet us consider a control volume of the debris layer with a unit area at its base and extending through the full thickness of the layer, $H$. Let $\\rho$ be the bulk density of the saturated granular material and $g$ be the acceleration due to gravity. The weight of this volume of material is $\\rho g H$. The component of this weight acting parallel to the inclined plane (downslope) is $(\\rho g H)\\sin(\\theta)$. As this force acts over a unit basal area, the driving shear stress is:\n$$ \\tau_d = \\rho g H \\sin(\\theta) $$\nThe component of the weight acting normal to the inclined plane is $(\\rho g H)\\cos(\\theta)$. This force is supported by the normal stress at the base, which is given in the problem as the mean lithostatic pressure $P$. Thus:\n$$ P = \\rho g H \\cos(\\theta) $$\nBy dividing the expression for $\\tau_d$ by the expression for $P$, we can express the driving stress in terms of the normal pressure and the slope angle:\n$$ \\frac{\\tau_d}{P} = \\frac{\\rho g H \\sin(\\theta)}{\\rho g H \\cos(\\theta)} = \\tan(\\theta) $$\nTherefore, the driving shear stress imposed by gravity is:\n$$ \\tau_d = P \\tan(\\theta) $$\n\nThe problem states that the basal shear resistance, $\\tau_b$, is composed of a cohesive (rate-independent) part, $\\tau_c$, and a frictional part that depends on the inertial number, $I$. The frictional part is given by the product of a friction coefficient, $\\mu(I)$, and the normal pressure, $P$. Thus, the total basal resistance is:\n$$ \\tau_b = \\tau_c + \\mu(I) P $$\n\nFor a steady, uniform flow to exist, the driving stress must be exactly balanced by the resisting stress:\n$$ \\tau_d = \\tau_b $$\nSubstituting the expressions derived above:\n$$ P \\tan(\\theta) = \\tau_c + \\mu(I) P $$\nThis equation defines the value that the friction coefficient $\\mu(I)$ must take to sustain a steady flow. We can solve for this required friction coefficient, let's call it $\\mu_{req}$:\n$$ \\mu(I) P = P \\tan(\\theta) - \\tau_c $$\n$$ \\mu_{req} = \\mu(I) = \\tan(\\theta) - \\frac{\\tau_c}{P} $$\n\nThis equation shows how to determine the friction coefficient required for equilibrium. The inertial number $I$ would then be found by inverting the function $\\mu(I)$, i.e., $I = \\mu^{-1}(\\mu_{req})$. However, for a solution to be physically admissible, this required friction coefficient $\\mu_{req}$ must be a value that the material can actually develop.\n\nThe problem specifies key properties of the function $\\mu(I)$: it is a non-decreasing function of $I$ for $I \\ge 0$, and its value at $I=0$ (the static case) is the static friction coefficient, $\\mu_s$. That is, $\\mu(0) = \\mu_s$. Since $\\mu(I)$ is non-decreasing, its minimum possible value is $\\mu_s$.\nTherefore, a steady flow is only possible if the required friction coefficient, $\\mu_{req}$, is greater than or equal to the minimum possible friction coefficient, $\\mu_s$. The condition for an admissible steady flow is:\n$$ \\mu_{req} \\ge \\mu_s $$\nSubstituting the expression for $\\mu_{req}$:\n$$ \\tan(\\theta) - \\frac{\\tau_c}{P} \\ge \\mu_s $$\nThis inequality represents the fundamental condition for steady flow to be admissible. If it is satisfied, a flow state with $I \\ge 0$ can exist. If it is not satisfied, the driving stress is insufficient to overcome the minimum material resistance, and the material remains static.\n\nWe now test this condition using the provided data:\n- $\\tau_c = 1 \\text{ kPa}$\n- $P = 10 \\text{ kPa}$\n- $\\mu_s = 0.4$\n- $\\theta = 15^{\\circ}$\n\nFirst, we compute the required friction coefficient $\\mu_{req}$:\n$$ \\mu_{req} = \\tan(15^{\\circ}) - \\frac{1 \\text{ kPa}}{10 \\text{ kPa}} = \\tan(15^{\\circ}) - 0.1 $$\nThe exact value of $\\tan(15^{\\circ})$ can be found using the angle subtraction formula for tangents, $\\tan(A-B) = \\frac{\\tan(A)-\\tan(B)}{1+\\tan(A)\\tan(B)}$:\n$$ \\tan(15^{\\circ}) = \\tan(45^{\\circ} - 30^{\\circ}) = \\frac{\\tan(45^{\\circ}) - \\tan(30^{\\circ})}{1+\\tan(45^{\\circ})\\tan(30^{\\circ})} = \\frac{1 - \\frac{1}{\\sqrt{3}}}{1 + (1)\\left(\\frac{1}{\\sqrt{3}}\\right)} = \\frac{\\sqrt{3}-1}{\\sqrt{3}+1} $$\nBy rationalizing the denominator, we get:\n$$ \\tan(15^{\\circ}) = \\frac{(\\sqrt{3}-1)(\\sqrt{3}-1)}{(\\sqrt{3}+1)(\\sqrt{3}-1)} = \\frac{3 - 2\\sqrt{3} + 1}{3-1} = \\frac{4 - 2\\sqrt{3}}{2} = 2 - \\sqrt{3} $$\nSo, the required friction coefficient is:\n$$ \\mu_{req} = (2 - \\sqrt{3}) - 0.1 $$\n\nNext, we check the admissibility condition, $\\mu_{req} \\ge \\mu_s$:\n$$ (2 - \\sqrt{3}) - 0.1 \\ge 0.4 $$\n$$ 2 - \\sqrt{3} \\ge 0.5 $$\n$$ 1.5 \\ge \\sqrt{3} $$\nTo check this inequality without approximation, we can square both sides since both are positive:\n$$ (1.5)^2 \\ge (\\sqrt{3})^2 $$\n$$ 2.25 \\ge 3 $$\nThis inequality is false.\n\nSince $\\mu_{req}  \\mu_s$, the required friction coefficient is less than the minimum possible friction coefficient that the material can mobilize (the static one). This means that the total driving stress, $\\tau_d = P\\tan(\\theta)$, is less than the minimum resistance the material can offer, which is the static resistance at zero shear rate, $\\tau_{b,static} = \\tau_c + \\mu_s P$.\n$$ \\tau_d = 10 \\text{ kPa} \\times \\tan(15^{\\circ}) = 10(2-\\sqrt{3}) \\approx 2.68 \\text{ kPa} $$\n$$ \\tau_{b,static} = 1 \\text{ kPa} + 0.4 \\times 10 \\text{ kPa} = 1 \\text{ kPa} + 4 \\text{ kPa} = 5 \\text{ kPa} $$\nClearly, $\\tau_d  \\tau_{b,static}$. The gravitational driving force is insufficient to overcome the frictional and cohesive resistance of the material at rest.\n\nTherefore, a steady uniform flow is not admissible under the given conditions. The debris layer will remain static. For a static material, the velocity gradients are zero, and consequently, the shear rate is zero. The inertial number, $I$, is defined as a dimensionless shear rate, so for a static body, $I=0$. The problem states to report $I=0$ if a steady flow is not admissible.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "A central task in computational geomechanics is to calibrate constitutive models using experimental data. This comprehensive exercise simulates this entire workflow by asking you to estimate the parameters of the $\\mu(I)$ model from synthetic measurements of flow velocity . You will first derive an analytical expression for the depth-averaged velocity from first principles and then use this model to perform a nonlinear least-squares fit, bridging the gap between theoretical rheology and practical data analysis.",
            "id": "3516253",
            "problem": "You are tasked with constructing and solving a parameter estimation problem for steady, uniform, dense debris flow on a fixed, planar incline using the granular friction law with inertial number dependence, commonly referred to as the $\\mu(I)$ rheology. The objective is to estimate the parameters of the friction law from synthetic measurements of depth-averaged velocity as a function of flow depth at three slope angles and to quantify uncertainty via confidence intervals. All physical quantities and variables must be treated rigorously and expressed in standard International System of Units.\n\nAssume a single-phase, dense, incompressible mixture of grains and fluid flowing down an incline of angle $\\theta$ (in degrees). Consider a Cartesian coordinate system with the $z$-axis normal to the bed, $z=0$ at the bed, and $z=h$ at the free surface. The gravitational acceleration is $g$ in $\\mathrm{m/s^2}$. The mixture (bulk) density is $\\rho_m$ in $\\mathrm{kg/m^3}$ and the grain density is $\\rho_s$ in $\\mathrm{kg/m^3}$. The characteristic grain diameter is $d$ in $\\mathrm{m}$. Let $u(z)$ denote the streamwise velocity profile and let $\\overline{u}$ denote the depth-averaged velocity, defined by\n$$\n\\overline{u} = \\frac{1}{h} \\int_0^h u(z) \\, dz,\n$$\nwith $\\overline{u}$ expressed in $\\mathrm{m/s}$ and the flow depth $h$ in $\\mathrm{m}$.\n\nUse the following well-tested, foundational principles:\n- Newton's second law applied to a steady, uniform, fully developed flow implies a balance between gravitational driving and internal stresses. The local shear stress $\\tau(z)$ and normal stress $p(z)$ within the layer satisfy\n$$\n\\tau(z) = \\rho_m g (h - z) \\sin\\theta_r, \\quad p(z) = \\rho_m g (h - z) \\cos\\theta_r,\n$$\nwhere $\\theta_r$ is the slope angle in radians, and $\\tan\\theta_r = \\tau(z)/p(z)$ is independent of $z$.\n- The granular friction law with inertial number dependence is\n$$\n\\mu(I) = \\mu_s + \\frac{\\mu_2 - \\mu_s}{1 + I_0/I},\n$$\nwhere $\\mu_s$ is the quasi-static friction coefficient, $\\mu_2$ is the high-shear friction coefficient, $I_0$ is a characteristic inertial number scale, and $I$ is the inertial number defined by\n$$\nI = \\frac{d \\, \\dot{\\gamma}}{\\sqrt{p/\\rho_s}},\n$$\nwith $\\dot{\\gamma}$ the shear rate (in $\\mathrm{s^{-1}}$). All symbols must be handled with appropriate units.\n\nAssume a no-slip bed and that the flow is dense enough for the above relations to hold over the entire depth. From these foundations, derive a model for the depth-averaged velocity $\\overline{u}(h,\\theta)$ that is consistent with the friction-law constraint $\\mu(I) = \\tan\\theta_r$ and the inertial-number definition. Your derivation must start from the principles stated above and must not assume any shortcut formulas.\n\nYou are given three slope angles $\\theta = 18^\\circ, 22^\\circ, 26^\\circ$ and synthetic data generated from a single global parameter set $(\\mu_s, \\mu_2, I_0)$, with measurement noise added. The synthetic data must be generated exactly as described below. Your program must use the generated synthetic data to estimate $(\\mu_s, \\mu_2, I_0)$ via nonlinear least squares and report approximate $95\\%$ confidence intervals using the asymptotic normal approximation derived from the Jacobian at the solution. Angles must be handled in degrees for input specification and converted to radians internally for trigonometric evaluation. All velocities must be expressed in $\\mathrm{m/s}$ and all depths in $\\mathrm{m}$.\n\nPhysical constants and true parameter values for data generation:\n- $g = 9.81 \\, \\mathrm{m/s^2}$,\n- $\\rho_m = 2000 \\, \\mathrm{kg/m^3}$,\n- $\\rho_s = 2650 \\, \\mathrm{kg/m^3}$,\n- $d = 0.02 \\, \\mathrm{m}$,\n- $\\mu_s^{\\mathrm{true}} = 0.30$,\n- $\\mu_2^{\\mathrm{true}} = 0.70$,\n- $I_0^{\\mathrm{true}} = 0.40$.\n\nSynthetic data generation protocol:\n- For each test case, for each angle $\\theta \\in \\{18^\\circ, 22^\\circ, 26^\\circ\\}$, and for each specified depth $h$ in the test case’s depth set, compute the noise-free depth-averaged velocity $\\overline{u}(h,\\theta)$ by using the derived model with the true parameters $(\\mu_s^{\\mathrm{true}},\\mu_2^{\\mathrm{true}},I_0^{\\mathrm{true}})$ and the constants above.\n- Add independent, zero-mean Gaussian noise $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$ to each velocity sample to form the measured data $\\overline{u}_{\\mathrm{meas}}(h,\\theta) = \\overline{u}(h,\\theta) + \\varepsilon$.\n- Use the specified random seed to initialize a pseudorandom number generator so that the noise is reproducible.\n\nYour program must fit the three unknown parameters $(\\mu_s,\\mu_2,I_0)$ to the entire data set across all three angles simultaneously for each test case, using nonlinear least squares with physically reasonable bounds that keep $(\\mu_s,\\mu_2,I_0)$ positive and ensure $\\mu_2  \\tan(26^\\circ)$ to maintain model consistency for the given angles. Then compute the approximate $95\\%$ confidence interval for each parameter using the covariance matrix approximation\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) \\approx s^2 \\left(\\mathbf{J}^\\top \\mathbf{J}\\right)^{-1},\n$$\nwhere $\\hat{\\boldsymbol{\\theta}} = (\\hat{\\mu}_s,\\hat{\\mu}_2,\\hat{I}_0)$ is the parameter estimate, $\\mathbf{J}$ is the Jacobian of residuals with respect to parameters evaluated at $\\hat{\\boldsymbol{\\theta}}$, and $s^2 = \\mathrm{RSS}/(N-p)$ is the residual variance estimate with $\\mathrm{RSS}$ the residual sum of squares, $N$ the number of observations and $p=3$ the number of parameters. Use the normal quantile $1.96$ to form symmetric confidence intervals.\n\nTest suite specification (three cases that vary noise level and depth sets; angles are always $\\theta = 18^\\circ, 22^\\circ, 26^\\circ$):\n1. Case A (happy path): random seed $42$, noise standard deviation $\\sigma = 0.03 \\, \\mathrm{m/s}$, depths $h \\in \\{0.15, 0.25, 0.35, 0.50, 0.70\\} \\, \\mathrm{m}$.\n2. Case B (low-noise boundary): random seed $7$, noise standard deviation $\\sigma = 0.00 \\, \\mathrm{m/s}$, depths $h \\in \\{0.12, 0.20, 0.30, 0.45, 0.60\\} \\, \\mathrm{m}$.\n3. Case C (higher-noise edge): random seed $123$, noise standard deviation $\\sigma = 0.06 \\, \\mathrm{m/s}$, depths $h \\in \\{0.20, 0.30, 0.40, 0.60, 0.90, 1.20\\} \\, \\mathrm{m}$.\n\nAlgorithmic requirements and output specification:\n- Implement the model derivation to obtain $\\overline{u}(h,\\theta)$ as a function of $(\\mu_s,\\mu_2,I_0)$ and the given constants. Use this model to generate synthetic data per the protocol for each test case.\n- Fit $(\\mu_s,\\mu_2,I_0)$ for each test case via nonlinear least squares across all angles and depths, respecting bounds that enforce $\\mu_s  0$, $I_0  0$, and $\\mu_2  \\tan(26^\\circ)$.\n- Compute approximate $95\\%$ confidence intervals for each parameter from the Jacobian and residual variance at the solution. If $\\mathbf{J}^\\top \\mathbf{J}$ is ill-conditioned or non-invertible, use a Moore–Penrose pseudoinverse.\n- Final output format: Your program should produce a single line of output containing a flattened comma-separated list of $27$ numbers enclosed in square brackets. For each of the three test cases in order (Case A, Case B, Case C), append the following $9$ values:\n  1. $\\hat{\\mu}_s$,\n  2. $\\hat{\\mu}_2$,\n  3. $\\hat{I}_0$,\n  4. lower bound of the $95\\%$ confidence interval for $\\mu_s$,\n  5. upper bound of the $95\\%$ confidence interval for $\\mu_s$,\n  6. lower bound of the $95\\%$ confidence interval for $\\mu_2$,\n  7. upper bound of the $95\\%$ confidence interval for $\\mu_2$,\n  8. lower bound of the $95\\%$ confidence interval for $I_0$,\n  9. upper bound of the $95\\%$ confidence interval for $I_0$.\n- Numerical presentation: Express all reported numbers as decimal floats rounded to six decimal places. Angles must be interpreted in degrees; velocities must be in $\\mathrm{m/s}$; depths must be in $\\mathrm{m}$.\n\nYour program must be fully self-contained, generate the synthetic data using the exact constants and seeds above, perform the requested estimation and uncertainty quantification, and finally print the results for all three test cases in the exact single-line format specified.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, objective, and provides a complete and consistent set of instructions for a standard parameter estimation task in computational geomechanics. We will now proceed with the solution, which involves two main stages: first, the analytical derivation of the model for depth-averaged velocity, and second, the numerical implementation of the data generation, parameter fitting, and uncertainty analysis pipeline.\n\n### Model Derivation for Depth-Averaged Velocity $\\overline{u}$\n\nThe objective is to derive an expression for the depth-averaged velocity $\\overline{u}$ as a function of flow depth $h$, slope angle $\\theta$, and the rheological parameters $(\\mu_s, \\mu_2, I_0)$. We begin from the provided first principles.\n\n**1. Stress and Friction Balance**\n\nFor a steady, uniform flow, the gravitational driving force is balanced by internal friction. The local shear stress $\\tau(z)$ and normal stress $p(z)$ at a depth $z$ from the bed are given by:\n$$\n\\tau(z) = \\rho_m g (h - z) \\sin\\theta_r\n$$\n$$\np(z) = \\rho_m g (h - z) \\cos\\theta_r\n$$\nwhere $\\theta_r$ is the slope angle in radians. The ratio of these stresses defines the macroscopic friction coefficient required for equilibrium:\n$$\n\\mu = \\frac{\\tau(z)}{p(z)} = \\frac{\\rho_m g (h - z) \\sin\\theta_r}{\\rho_m g (h - z) \\cos\\theta_r} = \\tan\\theta_r\n$$\nCrucially, this required friction coefficient, $\\tan\\theta_r$, is constant throughout the flow depth for a given slope.\n\n**2. Relating Friction to Inertial Number**\n\nThe material's constitutive behavior is described by the $\\mu(I)$ rheology, which relates the mobilized friction coefficient to the inertial number $I$:\n$$\n\\mu(I) = \\mu_s + \\frac{\\mu_2 - \\mu_s}{1 + I_0/I}\n$$\nIn a steady, uniform flow, the mobilized friction must equal the required friction, so $\\mu(I) = \\tan\\theta_r$. This allows us to solve for the inertial number $I$ as a function of the slope angle and the rheological parameters.\n$$\n\\tan\\theta_r = \\mu_s + \\frac{\\mu_2 - \\mu_s}{1 + I_0/I}\n$$\nRearranging the equation to solve for $I$:\n$$\n\\tan\\theta_r - \\mu_s = \\frac{\\mu_2 - \\mu_s}{1 + I_0/I}\n$$\n$$\n1 + \\frac{I_0}{I} = \\frac{\\mu_2 - \\mu_s}{\\tan\\theta_r - \\mu_s}\n$$\n$$\n\\frac{I_0}{I} = \\frac{\\mu_2 - \\mu_s}{\\tan\\theta_r - \\mu_s} - 1 = \\frac{(\\mu_2 - \\mu_s) - (\\tan\\theta_r - \\mu_s)}{\\tan\\theta_r - \\mu_s} = \\frac{\\mu_2 - \\tan\\theta_r}{\\tan\\theta_r - \\mu_s}\n$$\nThis yields a constant value for the inertial number $I$ for a given slope:\n$$\nI = I_0 \\frac{\\tan\\theta_r - \\mu_s}{\\mu_2 - \\tan\\theta_r}\n$$\nThis expression is valid only when $\\mu_s  \\tan\\theta_r  \\mu_2$, which ensures a positive inertial number and thus a flowing state. The given slope angles ($18^\\circ, 22^\\circ, 26^\\circ$) and true parameters satisfy this condition.\n\n**3. Deriving the Velocity Profile $u(z)$**\n\nThe inertial number $I$ is also defined microscopically in terms of the local shear rate $\\dot{\\gamma}$ and the local confining pressure $p(z)$:\n$$\nI = \\frac{d \\, \\dot{\\gamma}}{\\sqrt{p(z)/\\rho_s}}\n$$\nAssuming simple shear, the shear rate is $\\dot{\\gamma} = |du/dz|$. For a flow moving downslope, $u(z) \\ge 0$ and we can write $\\dot{\\gamma} = du/dz$. We can now express the velocity gradient $du/dz$ by rearranging the definition of $I$:\n$$\n\\frac{du}{dz} = \\frac{I}{d} \\sqrt{\\frac{p(z)}{\\rho_s}}\n$$\nSubstituting the expression for $p(z)$:\n$$\n\\frac{du}{dz} = \\frac{I}{d} \\sqrt{\\frac{\\rho_m g (h-z) \\cos\\theta_r}{\\rho_s}} = \\left( \\frac{I}{d} \\sqrt{\\frac{\\rho_m g \\cos\\theta_r}{\\rho_s}} \\right) (h-z)^{1/2}\n$$\nThe term in parentheses is constant for a given slope. Let us denote it by a constant $C(\\theta_r)$:\n$$\nC(\\theta_r) = \\frac{I}{d} \\sqrt{\\frac{\\rho_m g \\cos\\theta_r}{\\rho_s}} = \\left( \\frac{I_0}{d} \\frac{\\tan\\theta_r - \\mu_s}{\\mu_2 - \\tan\\theta_r} \\right) \\sqrt{\\frac{\\rho_m g \\cos\\theta_r}{\\rho_s}}\n$$\nSo, we have a differential equation for the velocity profile:\n$$\n\\frac{du}{dz} = C(\\theta_r) (h-z)^{1/2}\n$$\nWe integrate this equation with respect to $z$ from the bed ($z=0$) to an arbitrary height $z$ within the flow, applying the no-slip boundary condition $u(0)=0$:\n$$\nu(z) = \\int_0^z \\frac{du}{dz'} dz' = \\int_0^z C(\\theta_r) (h-z')^{1/2} dz'\n$$\n$$\nu(z) = C(\\theta_r) \\left[ -\\frac{2}{3}(h-z')^{3/2} \\right]_0^z = C(\\theta_r) \\left( -\\frac{2}{3}(h-z)^{3/2} - \\left(-\\frac{2}{3}(h-0)^{3/2}\\right) \\right)\n$$\nThis gives the velocity profile:\n$$\nu(z) = \\frac{2}{3} C(\\theta_r) \\left( h^{3/2} - (h-z)^{3/2} \\right)\n$$\n\n**4. Deriving the Depth-Averaged Velocity $\\overline{u}$**\n\nFinally, we compute the depth-averaged velocity $\\overline{u}$ by integrating $u(z)$ over the flow depth $h$ and dividing by $h$:\n$$\n\\overline{u} = \\frac{1}{h} \\int_0^h u(z) dz = \\frac{1}{h} \\int_0^h \\frac{2}{3} C(\\theta_r) \\left( h^{3/2} - (h-z)^{3/2} \\right) dz\n$$\n$$\n\\overline{u} = \\frac{2 C(\\theta_r)}{3h} \\left[ \\int_0^h h^{3/2} dz - \\int_0^h (h-z)^{3/2} dz \\right]\n$$\nThe integrals evaluate to:\n$$\n\\int_0^h h^{3/2} dz = h^{3/2} [z]_0^h = h^{5/2}\n$$\n$$\n\\int_0^h (h-z)^{3/2} dz = \\left[ -\\frac{2}{5}(h-z)^{5/2} \\right]_0^h = 0 - \\left( -\\frac{2}{5}h^{5/2} \\right) = \\frac{2}{5}h^{5/2}\n$$\nSubstituting these back:\n$$\n\\overline{u} = \\frac{2 C(\\theta_r)}{3h} \\left[ h^{5/2} - \\frac{2}{5}h^{5/2} \\right] = \\frac{2 C(\\theta_r)}{3h} \\left[ \\frac{3}{5}h^{5/2} \\right] = \\frac{2}{5} C(\\theta_r) h^{3/2}\n$$\nSubstituting the expression for $C(\\theta_r)$, we obtain the final model for the depth-averaged velocity:\n$$\n\\overline{u}(h, \\theta; \\mu_s, \\mu_2, I_0) = \\frac{2}{5} h^{3/2} \\left( \\frac{I_0}{d} \\frac{\\tan\\theta_r - \\mu_s}{\\mu_2 - \\tan\\theta_r} \\right) \\sqrt{\\frac{\\rho_m g \\cos\\theta_r}{\\rho_s}}\n$$\nThis equation serves as the core model for generating synthetic data and for the nonlinear least-squares fitting procedure.\n\n### Numerical Implementation Strategy\n\nThe program will proceed as follows for each test case:\n1.  **Data Generation:** Using the derived model with the true parameters $(\\mu_s^{\\mathrm{true}}, \\mu_2^{\\mathrm{true}}, I_0^{\\mathrm{true}})$, compute the noise-free velocity $\\overline{u}$ for each pair of slope angle $\\theta$ and flow depth $h$. Add Gaussian noise with the specified standard deviation $\\sigma$ and random seed to create the synthetic measurement dataset.\n2.  **Parameter Estimation:** Employ `scipy.optimize.least_squares` to find the parameter vector $\\hat{\\boldsymbol{\\theta}} = (\\hat{\\mu}_s, \\hat{\\mu}_2, \\hat{I}_0)$ that minimizes the sum of squared residuals between the model predictions and the synthetic data. The optimization will be constrained by the specified bounds: $\\mu_s  0$, $I_0  0$, and $\\mu_2  \\tan(26^\\circ)$.\n3.  **Uncertainty Quantification:** Using the Jacobian matrix of the residuals with respect to the parameters (returned by the optimizer), compute the approximate covariance matrix $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ via the formula $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) \\approx s^2 (\\mathbf{J}^\\top \\mathbf{J})^{-1}$. The term $(\\mathbf{J}^\\top \\mathbf{J})^{-1}$ is computed using the Moore-Penrose pseudoinverse to ensure numerical stability. The residual variance $s^2$ is estimated from the residual sum of squares (RSS).\n4.  **Confidence Intervals:** From the diagonal elements of the covariance matrix, calculate the standard error for each parameter estimate. The $95\\%$ confidence intervals are then constructed as $\\hat{\\theta_i} \\pm 1.96 \\times \\mathrm{se}(\\hat{\\theta_i})$.\n5.  **Output Formatting:** Collate and format all results for all three test cases into a single-line string as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Main function to execute the parameter estimation problem for debris flow rheology.\n    It generates synthetic data for three test cases, fits the mu(I) model parameters,\n    calculates confidence intervals, and prints the formatted results.\n    \"\"\"\n\n    # Physical constants and true parameter values for data generation\n    g = 9.81  # m/s^2\n    rho_m = 2000.0  # kg/m^3\n    rho_s = 2650.0  # kg/m^3\n    d = 0.02  # m\n    \n    true_params = {\n        \"mu_s\": 0.30,\n        \"mu_2\": 0.70,\n        \"I_0\": 0.40\n    }\n\n    # Test suite specification\n    angles_deg = np.array([18.0, 22.0, 26.0])\n    \n    test_cases = [\n        {\"seed\": 42, \"sigma\": 0.03, \"depths\": np.array([0.15, 0.25, 0.35, 0.50, 0.70])},\n        {\"seed\": 7, \"sigma\": 0.00, \"depths\": np.array([0.12, 0.20, 0.30, 0.45, 0.60])},\n        {\"seed\": 123, \"sigma\": 0.06, \"depths\": np.array([0.20, 0.30, 0.40, 0.60, 0.90, 1.20])},\n    ]\n\n    def u_bar_model(h, theta_deg, params, consts):\n        \"\"\"\n        Calculates the depth-averaged velocity based on the derived model.\n        \n        Args:\n            h (float or np.ndarray): Flow depth(s) in meters.\n            theta_deg (float or np.ndarray): Slope angle(s) in degrees.\n            params (tuple): A tuple of rheological parameters (mu_s, mu_2, I_0).\n            consts (dict): A dictionary of physical constants (g, d, rho_m, rho_s).\n        \n        Returns:\n            float or np.ndarray: Predicted depth-averaged velocity(s) in m/s.\n        \"\"\"\n        mu_s, mu_2, I_0 = params\n        g, d, rho_m, rho_s = consts['g'], consts['d'], consts['rho_m'], consts['rho_s']\n\n        theta_r = np.deg2rad(theta_deg)\n        tan_theta = np.tan(theta_r)\n        cos_theta = np.cos(theta_r)\n        \n        # Check for physical validity of parameters for the given angles\n        if np.any(tan_theta = mu_s) or np.any(tan_theta = mu_2):\n            # Return a large value to be penalized by the optimizer if out of valid range\n            return np.full_like(h, 1e9)\n\n        term1 = (2.0 / 5.0) * (I_0 / d)\n        term2 = np.sqrt((rho_m * g * cos_theta) / rho_s)\n        term3 = (tan_theta - mu_s) / (mu_2 - tan_theta)\n        \n        u_bar = term1 * term2 * term3 * h**(1.5)\n        return u_bar\n\n    def residual_func(params, x_data, y_data, consts):\n        \"\"\"Residuals for the least_squares optimizer.\"\"\"\n        h_vals, theta_vals = x_data\n        model_predictions = u_bar_model(h_vals, theta_vals, params, consts)\n        return model_predictions - y_data\n\n    # Store all results in a flat list\n    all_results = []\n    \n    # Process each test case\n    for case in test_cases:\n        # --- 1. Generate Synthetic Data ---\n        rng = np.random.default_rng(case[\"seed\"])\n        \n        h_data, theta_data, u_meas_data = [], [], []\n        \n        for theta in angles_deg:\n            for h in case[\"depths\"]:\n                params_true_tuple = (true_params[\"mu_s\"], true_params[\"mu_2\"], true_params[\"I_0\"])\n                constants_dict = {'g': g, 'd': d, 'rho_m': rho_m, 'rho_s': rho_s}\n                \n                u_true = u_bar_model(h, theta, params_true_tuple, constants_dict)\n                noise = rng.normal(0, case[\"sigma\"])\n                u_meas = u_true + noise\n                \n                h_data.append(h)\n                theta_data.append(theta)\n                u_meas_data.append(u_meas)\n\n        h_data = np.array(h_data)\n        theta_data = np.array(theta_data)\n        y_data = np.array(u_meas_data)\n        x_data = (h_data, theta_data)\n\n        # --- 2. Parameter Estimation ---\n        # Bounds: [mu_s  0, mu_2  tan(26 deg), I_0  0]\n        # Added a small epsilon to mu_2 lower bound for strict inequality\n        lower_bounds = [0, np.tan(np.deg2rad(angles_deg.max())) + 1e-9, 0]\n        upper_bounds = [np.inf, np.inf, np.inf]\n        bounds = (lower_bounds, upper_bounds)\n        \n        # Initial guess for parameters (mu_s, mu_2, I_0)\n        p0 = [0.2, 0.6, 0.3]\n\n        res = least_squares(\n            residual_func,\n            p0,\n            args=(x_data, y_data, constants_dict),\n            bounds=bounds,\n            method='trf'\n        )\n        popt = res.x\n        hat_mu_s, hat_mu_2, hat_I_0 = popt\n\n        # --- 3. Uncertainty Quantification ---\n        J = res.jac\n        rss = 2 * res.cost # least_squares returns 0.5 * sum of squares\n        N = len(y_data)\n        p = len(popt)\n        \n        # Residual variance\n        if N  p:\n            s2 = rss / (N - p)\n        else: # Should not happen in this problem\n            s2 = np.nan \n\n        # Covariance matrix calculation\n        try:\n            # Use Moore-Penrose pseudoinverse as required\n            JtJ_inv = np.linalg.pinv(J.T @ J)\n            pcov = s2 * JtJ_inv\n            # Handle noise-free case where s2 can be ~0\n            if np.allclose(pcov, 0):\n                se = np.zeros_like(popt)\n            else:\n                se = np.sqrt(np.diag(pcov))\n        except (np.linalg.LinAlgError, ValueError):\n            se = np.array([np.inf] * p)\n\n        # --- 4. Confidence Intervals ---\n        z_score = 1.96  # For 95% confidence\n        conf_int_lower = popt - z_score * se\n        conf_int_upper = popt + z_score * se\n        \n        # --- 5. Store and Format Results ---\n        case_results = [\n            hat_mu_s, hat_mu_2, hat_I_0,\n            conf_int_lower[0], conf_int_upper[0],\n            conf_int_lower[1], conf_int_upper[1],\n            conf_int_lower[2], conf_int_upper[2],\n        ]\n        all_results.extend(case_results)\n\n    # Final formatting of the output string\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}