{
    "hands_on_practices": [
        {
            "introduction": "Understanding the interaction between the ground and a support system is the cornerstone of the convergence-confinement method in tunneling. This foundational exercise guides you through deriving the elastic Ground Response Curve (GRC) from the first principles of continuum mechanics. By establishing the relationship between tunnel convergence and the required internal support pressure, and then intersecting it with a Support Reaction Curve (SRC), you will determine the final equilibrium state of the tunnel, providing a fundamental skill for tunnel design analysis. ",
            "id": "3569433",
            "problem": "A circular tunnel of radius $a$ is excavated in an infinite, homogeneous, isotropic rock mass under plane strain. The far field geostress is hydrostatic with magnitude $\\sigma_{0}$ (compression taken as positive). The rock behaves as a linear elastic solid with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The excavation boundary at $r=a$ is supported by an axisymmetric support system that reacts uniformly in pressure against the ground. The support is installed after a fraction of stress release, modeled by the deconfinement factor $\\lambda \\in (0,1)$ defined as the fraction of the free (unsupported) elastic convergence that has occurred by the time the support becomes active. After installation, the support follows a linear Support Reaction Curve (SRC), modeled as a uniform pressure $p_{s}$ proportional to the additional wall convergence beyond the installation convergence: $p_{s} = K_{s}\\,(u - u_{i})$ for $u \\ge u_{i}$ and $p_{s}=0$ for $u < u_{i}$, where $u$ is the tunnel wall radial convergence and $K_{s}$ is the support stiffness with units of stress per displacement, and $u_{i}$ is the installation convergence.\n\nStarting only from fundamental equations of axisymmetric equilibrium, compatibility, and linear elasticity in plane strain, first derive the elastic Ground Response Curve (GRC), i.e., the relation between the uniform internal pressure $p$ applied at $r=a$ and the corresponding wall convergence $u$. Then, using the definitions above, determine the unique ground–support interaction equilibrium $u_{\\ast}$ by enforcing $p_{s}(u_{\\ast})$ equal to the ground reaction $p(u_{\\ast})$.\n\nUse the following data:\n- Tunnel radius: $a = 2.5\\,\\mathrm{m}$.\n- Far field hydrostatic stress: $\\sigma_{0} = 15\\,\\mathrm{MPa}$.\n- Rock elastic properties: $E = 2.0 \\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.25$.\n- Support stiffness: $K_{s} = 3.0 \\times 10^{8}\\,\\mathrm{Pa/m}$.\n- Deconfinement factor at installation: $\\lambda = 0.60$.\n\nAssume compression positive, neglect face effects, and treat the problem as two-dimensional plane strain with an unbounded elastic domain. Express the final equilibrium wall convergence $u_{\\ast}$ in millimeters, and round your answer to four significant figures.",
            "solution": "The problem asks for the equilibrium wall convergence of a circular tunnel excavated in a linear elastic rock mass, considering the interaction with a linear support system. The solution requires two main steps: first, the derivation of the Ground Response Curve (GRC) from fundamental principles of mechanics, and second, the determination of the equilibrium point by intersecting the GRC with the Support Reaction Curve (SRC). The analysis is performed under plane strain conditions with a hydrostatic far-field stress. Compression is taken as positive.\n\n**Part 1: Derivation of the Ground Response Curve (GRC)**\n\nThe GRC describes the relationship between the uniform internal pressure $p$ applied to the tunnel boundary and the resulting radial wall convergence $u$. We derive this by solving the elastostatic boundary value problem.\n\n**1. Governing Equations**\nThe problem is axisymmetric, so we use polar coordinates $(r, \\theta)$. The fundamental equations are:\n-   **Equilibrium Equation** (in the absence of body forces):\n    $$ \\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0 $$\n    where $\\sigma_r$ is the radial stress and $\\sigma_\\theta$ is the tangential (hoop) stress.\n-   **Kinematic Relations:** Strains are related to the radial displacement field $u_r(r)$ by:\n    $$ \\epsilon_r = \\frac{du_r}{dr}, \\quad \\epsilon_\\theta = \\frac{u_r}{r} $$\n    where $\\epsilon_r$ and $\\epsilon_\\theta$ are the radial and tangential strains, respectively.\n-   **Constitutive Law (Hooke's Law for Plane Strain):** For an isotropic, linear elastic material under plane strain ($\\epsilon_z = 0$) and with compression assumed positive, the stress-strain relations are:\n    $$ \\epsilon_r = \\frac{1}{E}[-\\sigma_r + \\nu(\\sigma_\\theta + \\sigma_z)] $$\n    $$ \\epsilon_\\theta = \\frac{1}{E}[-\\sigma_\\theta + \\nu(\\sigma_r + \\sigma_z)] $$\n    The condition $\\epsilon_z=0$ implies $\\sigma_z = \\nu(\\sigma_r + \\sigma_\\theta)$. Substituting this into the strain equations yields:\n    $$ \\epsilon_r = -\\frac{1+\\nu}{E}[(1-\\nu)\\sigma_r - \\nu\\sigma_\\theta] $$\n    $$ \\epsilon_\\theta = -\\frac{1+\\nu}{E}[(1-\\nu)\\sigma_\\theta - \\nu\\sigma_r] $$\n\n**2. Stress Field Solution**\nThe problem can be solved by superposition. The final state (far-field stress $\\sigma_0$, internal pressure $p$) is the sum of an initial hydrostatic stress field ($\\sigma=\\sigma_0$ everywhere) and the stress changes induced by excavation and support installation. The displacement is caused solely by these stress changes. The change in boundary condition at the tunnel wall ($r=a$) corresponds to applying a traction of $p - \\sigma_0$.\n\nLet $\\Delta\\sigma_r$ and $\\Delta\\sigma_\\theta$ be the stress changes. The boundary conditions for this change field are:\n-   At the tunnel wall, $r=a$: $\\Delta\\sigma_r(a) = p - \\sigma_0$.\n-   In the far field, $r \\to \\infty$: $\\Delta\\sigma_r(\\infty) \\to 0$.\n\nThe general solution to the equilibrium equation in polar coordinates for an axisymmetric problem (the Lamé solution) is:\n$$ \\Delta\\sigma_r(r) = A - \\frac{B}{r^2} $$\n$$ \\Delta\\sigma_\\theta(r) = A + \\frac{B}{r^2} $$\nApplying the far-field boundary condition: $\\Delta\\sigma_r(\\infty) = A = 0$.\nApplying the near-field boundary condition: $\\Delta\\sigma_r(a) = -\\frac{B}{a^2} = p - \\sigma_0$, which gives $B = a^2(\\sigma_0 - p)$.\nThe stress changes are therefore:\n$$ \\Delta\\sigma_r(r) = -(\\sigma_0 - p)\\frac{a^2}{r^2} $$\n$$ \\Delta\\sigma_\\theta(r) = (\\sigma_0 - p)\\frac{a^2}{r^2} $$\n\n**3. Displacement and GRC**\nNow we calculate the displacement field caused by these stress changes. We use the kinematic relation $u_r(r) = r \\epsilon_\\theta(r)$ and the constitutive law for $\\epsilon_\\theta$ where the stresses are the stress changes $\\Delta\\sigma_r$ and $\\Delta\\sigma_\\theta$:\n$$ \\epsilon_\\theta(r) = -\\frac{1+\\nu}{E}[(1-\\nu)\\Delta\\sigma_\\theta(r) - \\nu\\Delta\\sigma_r(r)] $$\nSubstituting the expressions for $\\Delta\\sigma_r$ and $\\Delta\\sigma_\\theta$:\n$$ \\epsilon_\\theta(r) = -\\frac{1+\\nu}{E}\\left[(1-\\nu)\\left((\\sigma_0 - p)\\frac{a^2}{r^2}\\right) - \\nu\\left(-(\\sigma_0 - p)\\frac{a^2}{r^2}\\right)\\right] $$\n$$ \\epsilon_\\theta(r) = -\\frac{1+\\nu}{E}\\left[(\\sigma_0 - p)\\frac{a^2}{r^2}(1-\\nu+\\nu)\\right] = -\\frac{1+\\nu}{E}(\\sigma_0 - p)\\frac{a^2}{r^2} $$\nThe radial displacement field is:\n$$ u_r(r) = r \\epsilon_\\theta(r) = -r \\frac{1+\\nu}{E}(\\sigma_0 - p)\\frac{a^2}{r^2} = -\\frac{a^2(1+\\nu)}{E r}(\\sigma_0 - p) $$\nAt the tunnel wall ($r=a$), the radial displacement is:\n$$ u_r(a) = -\\frac{a(1+\\nu)}{E}(\\sigma_0 - p) $$\nThe negative sign indicates that the displacement is inward for $\\sigma_0 > p$. Wall convergence, $u$, is defined as the magnitude of this inward displacement, so $u = -u_r(a)$.\n$$ u(p) = \\frac{a(1+\\nu)}{E}(\\sigma_0 - p) $$\nThis linear equation is the Ground Response Curve (GRC). It can be rearranged to express pressure as a function of convergence:\n$$ p(u) = \\sigma_0 - \\frac{E}{a(1+\\nu)} u $$\n\n**Part 2: Ground-Support Interaction**\n\n**1. Support Reaction Curve (SRC)**\nThe support becomes active at an installation convergence $u_i$. This convergence is a fraction $\\lambda$ of the free (unsupported) convergence, $u_{max}$, which occurs when $p=0$.\n$$ u_{max} = u(p=0) = \\frac{a(1+\\nu)}{E}\\sigma_0 $$\n$$ u_i = \\lambda u_{max} = \\lambda \\frac{a(1+\\nu)}{E}\\sigma_0 $$\nThe Support Reaction Curve (SRC) is given by:\n$$ p_s(u) = \n\\begin{cases} \n0 & \\text{for } u < u_i \\\\\nK_s (u - u_i) & \\text{for } u \\ge u_i \n\\end{cases}\n$$\nwhere $K_s$ is the support stiffness.\n\n**2. Equilibrium Condition**\nEquilibrium is achieved when the pressure from the ground reaction equals the pressure exerted by the support. Let the equilibrium convergence be $u_\\ast$.\n$$ p(u_\\ast) = p_s(u_\\ast) $$\nAssuming $u_\\ast \\ge u_i$, we have:\n$$ \\sigma_0 - \\frac{E}{a(1+\\nu)} u_\\ast = K_s (u_\\ast - u_i) $$\nWe solve for $u_\\ast$. Let's define the ground stiffness modulus $K_g = \\frac{E}{a(1+\\nu)}$. The equation becomes:\n$$ \\sigma_0 - K_g u_\\ast = K_s u_\\ast - K_s u_i $$\n$$ \\sigma_0 + K_s u_i = u_\\ast (K_s + K_g) $$\n$$ u_\\ast = \\frac{\\sigma_0 + K_s u_i}{K_s + K_g} $$\nSubstitute the expression for $u_i = \\lambda \\frac{\\sigma_0}{K_g}$:\n$$ u_\\ast = \\frac{\\sigma_0 + K_s (\\lambda \\frac{\\sigma_0}{K_g})}{K_s + K_g} = \\frac{\\sigma_0(1 + \\frac{\\lambda K_s}{K_g})}{K_s + K_g} $$\n\n**Part 3: Numerical Calculation**\n\nThe given data are:\n-   $a = 2.5\\,\\mathrm{m}$\n-   $\\sigma_0 = 15\\,\\mathrm{MPa} = 15 \\times 10^6\\,\\mathrm{Pa}$\n-   $E = 2.0 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\nu = 0.25$\n-   $K_s = 3.0 \\times 10^8\\,\\mathrm{Pa/m}$\n-   $\\lambda = 0.60$\n\nFirst, calculate the ground stiffness modulus $K_g$:\n$$ K_g = \\frac{E}{a(1+\\nu)} = \\frac{2.0 \\times 10^9\\,\\mathrm{Pa}}{2.5\\,\\mathrm{m} \\times (1 + 0.25)} = \\frac{2.0 \\times 10^9}{2.5 \\times 1.25} = \\frac{2.0 \\times 10^9}{3.125}\\,\\mathrm{Pa/m} = 6.4 \\times 10^8\\,\\mathrm{Pa/m} $$\nNext, calculate the installation convergence $u_i$:\n$$ u_i = \\lambda \\frac{\\sigma_0}{K_g} = 0.60 \\times \\frac{15 \\times 10^6\\,\\mathrm{Pa}}{6.4 \\times 10^8\\,\\mathrm{Pa/m}} = \\frac{9 \\times 10^6}{6.4 \\times 10^8}\\,\\mathrm{m} = \\frac{9}{640}\\,\\mathrm{m} = 0.0140625\\,\\mathrm{m} $$\nNow, calculate the equilibrium convergence $u_\\ast$ using the derived formula:\n$$ u_\\ast = \\frac{\\sigma_0 + K_s u_i}{K_s + K_g} $$\nCalculate the numerator:\n$$ \\sigma_0 + K_s u_i = 15 \\times 10^6\\,\\mathrm{Pa} + (3.0 \\times 10^8\\,\\mathrm{Pa/m}) \\times (0.0140625\\,\\mathrm{m}) $$\n$$ \\sigma_0 + K_s u_i = 15 \\times 10^6\\,\\mathrm{Pa} + 4.21875 \\times 10^6\\,\\mathrm{Pa} = 19.21875 \\times 10^6\\,\\mathrm{Pa} $$\nCalculate the denominator:\n$$ K_s + K_g = 3.0 \\times 10^8\\,\\mathrm{Pa/m} + 6.4 \\times 10^8\\,\\mathrm{Pa/m} = 9.4 \\times 10^8\\,\\mathrm{Pa/m} $$\nFinally, compute $u_\\ast$:\n$$ u_\\ast = \\frac{19.21875 \\times 10^6\\,\\mathrm{Pa}}{9.4 \\times 10^8\\,\\mathrm{Pa/m}} \\approx 0.0204454787\\,\\mathrm{m} $$\nThe problem asks for the answer in millimeters, rounded to four significant figures.\n$$ u_\\ast \\approx 0.0204454787\\,\\mathrm{m} \\times 1000\\,\\mathrm{mm/m} \\approx 20.4454787\\,\\mathrm{mm} $$\nRounding to four significant figures gives:\n$$ u_\\ast = 20.45\\,\\mathrm{mm} $$\nSince $u_\\ast \\approx 20.45\\,\\mathrm{mm}$ and $u_i = 14.0625\\,\\mathrm{mm}$, the condition $u_\\ast > u_i$ is satisfied, validating our use of the active support pressure formula.",
            "answer": "$$\\boxed{20.45}$$"
        },
        {
            "introduction": "Moving beyond ideal elasticity, this practice tackles the more realistic scenario of a rock mass that can yield and form a plastic zone. You will implement a computational algorithm to analyze a tunnel using the industry-standard Hoek-Brown failure criterion, a powerful empirical tool for characterizing rock mass strength. This exercise involves a common engineering technique—linearizing the non-linear criterion—to calculate the radius of the plastic zone, a critical parameter for assessing tunnel stability and support requirements. ",
            "id": "3569461",
            "problem": "Consider a circular tunnel of radius $a$ excavated in a rock mass at depth $H$, under plane strain conditions and axisymmetric far-field hydrostatic stress. The in-situ geostatic pressure at tunnel axis is $p_0 = \\gamma H / 1000$ expressed in $\\mathrm{MPa}$, where $\\gamma$ is the unit weight in $\\mathrm{kN/m^3}$ and $H$ is in $\\mathrm{m}$. The tunnel boundary is subjected to a uniform support pressure $p_i$ (in $\\mathrm{MPa}$). The rock mass is modeled as elastic-perfectly plastic with strength described by the Hoek-Brown rock mass criterion. The objective is to compute the plastic zone radius $r_p$ and report the dimensionless ratio $r_p/a$ for several test cases, using an algorithm grounded in continuum mechanics and the Hoek-Brown criterion.\n\nYou must derive your computational method from the following foundational bases:\n- Equilibrium of radial stresses in an axisymmetric cylindrical continuum under plane strain: the radial equilibrium differential equation is\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0,\n$$\nwhere $\\sigma_r$ and $\\sigma_\\theta$ are the radial and circumferential (hoop) stresses, respectively, and $r$ is the radial coordinate.\n- Elastic solution in the outer zone (if present) for a pressurized cylindrical cavity in an infinite elastic medium under far-field hydrostatic stress $p_0$ and internal pressure $p_i$ gives (in the elastic region):\n$$\n\\sigma_r^{e}(r) = p_0 - (p_0 - p_i)\\frac{a^2}{r^2},\\quad\n\\sigma_\\theta^{e}(r) = p_0 + (p_0 - p_i)\\frac{a^2}{r^2},\n$$\nfor $r \\ge r_p$.\n- The Hoek-Brown rock mass strength criterion for the major principal stress $\\sigma_1$ as a function of the minor principal stress $\\sigma_3$ is\n$$\n\\sigma_1 = \\sigma_3 + \\sigma_{ci}\\left(m_b\\frac{\\sigma_3}{\\sigma_{ci}} + s\\right)^a,\n$$\nwhere $\\sigma_{ci}$ is the intact rock uniaxial compressive strength, $m_b$ is the reduced Hoek-Brown constant for the rock mass, $s$ is a scalar that decreases with rock mass quality, and $a$ is a dimensionless exponent. The empirical parameters are defined by the Geological Strength Index (GSI) and the disturbance factor $D$:\n$$\nm_b = m_i \\exp\\left(\\frac{\\mathrm{GSI}-100}{28-14D}\\right),\\quad\ns = \\exp\\left(\\frac{\\mathrm{GSI}-100}{9-3D}\\right),\\quad\na = \\frac{1}{2} + \\frac{1}{6}\\left[\\exp\\left(-\\frac{\\mathrm{GSI}}{15}\\right) - \\exp\\left(-\\frac{20}{3}\\right)\\right],\n$$\nwhere $m_i$ is the intact rock constant.\n- To make the problem computationally tractable, approximate the non-linear Hoek-Brown envelope by a tangent Mohr-Coulomb linearization at a specified confining stress $\\sigma_3 = \\sigma_{3t}$ using the derivative of the Hoek-Brown function. The Mohr-Coulomb form is\n$$\n\\sigma_1 = \\alpha\\,\\sigma_3 + \\beta,\\quad \\alpha = \\frac{1+\\sin\\varphi}{1-\\sin\\varphi},\\quad \\beta = \\frac{2c\\cos\\varphi}{1-\\sin\\varphi},\n$$\nwhere $c$ is cohesion and $\\varphi$ is the friction angle (express angles internally in radians). The tangent mapping is defined by matching the slope and the function value at $\\sigma_3 = \\sigma_{3t}$:\n$$\n\\left.\\frac{d\\sigma_1}{d\\sigma_3}\\right|_{\\sigma_3=\\sigma_{3t}} = k = 1 + a\\,m_b\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^{a-1},\n$$\nthen\n$$\n\\sin\\varphi = \\frac{k-1}{k+1},\n$$\nand\n$$\n\\sigma_1^{HB}(\\sigma_{3t}) = \\sigma_{3t} + \\sigma_{ci}\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^a,\n$$\nfrom which\n$$\nc = \\frac{\\left[\\sigma_1^{HB}(\\sigma_{3t}) - \\alpha\\,\\sigma_{3t}\\right](1-\\sin\\varphi)}{2\\cos\\varphi}.\n$$\n- In the plastic region ($a \\le r \\le r_p$), if the major principal stress is the hoop stress ($\\sigma_\\theta = \\sigma_1$) and the minor principal stress is the radial stress ($\\sigma_r = \\sigma_3$), the stress state at yield satisfies the Mohr-Coulomb envelope $\\sigma_\\theta = \\alpha\\,\\sigma_r + \\beta$. Substituting into equilibrium yields the first-order ordinary differential equation\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{(1-\\alpha)\\sigma_r - \\beta}{r} = 0,\n$$\nwhich integrates to\n$$\n\\sigma_r(r) = \\frac{\\beta}{1-\\alpha} + C\\,r^{\\alpha-1},\n$$\nwith boundary condition $\\sigma_r(a) = p_i$ leading to $C = \\left(p_i - \\frac{\\beta}{1-\\alpha}\\right)a^{1-\\alpha}$. Continuity at $r=r_p$ requires the elastic stress state to satisfy the yield condition at the interface, which leads to the equation\n$$\n\\sigma_\\theta^{e}(r_p) = \\alpha\\,\\sigma_r^{e}(r_p) + \\beta,\n$$\nthat can be solved for $r_p$.\n\nImplement the following algorithmic steps to compute $r_p/a$ for each test case:\n1. Compute $p_0 = \\gamma H / 1000$ in $\\mathrm{MPa}$ and set $\\Delta = p_0 - p_i$.\n2. Compute the Hoek-Brown parameters $m_b$, $s$, and $a$ using the given $\\mathrm{GSI}$ and $D$.\n3. Choose the tangent confining stress $\\sigma_{3t} = p_i$ and compute $k$, then $\\sin\\varphi$ and $\\cos\\varphi$, followed by $\\alpha$ and $\\sigma_1^{HB}(\\sigma_{3t})$, and finally the cohesion $c$ and $\\beta$.\n4. Solve for the plastic radius ratio using the interface yield condition written with the elastic solution:\n$$\np_0 + \\Delta\\frac{a^2}{r_p^2} = \\alpha\\left[p_0 - \\Delta\\frac{a^2}{r_p^2}\\right] + \\beta,\\quad \\text{so}\\quad\nx \\equiv \\frac{a^2}{r_p^2} = \\frac{p_0(\\alpha - 1) + \\beta}{\\Delta(1+\\alpha)}.\n$$\nSet $r_p/a = 1/\\sqrt{x}$ if $0 < x < 1$, and $r_p/a = 1$ if $x \\le 0$ or if $\\Delta \\le 0$ (which indicates no disturbance or no plastic propagation in this idealization).\n5. Report the ratio $r_p/a$ as a dimensionless float.\n\nDesign a test suite to exercise the algorithm across different regimes:\n- Case $1$ (typical rock, no support): $a = 2.5\\,\\mathrm{m}$, $H = 500\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = 0\\,\\mathrm{MPa}$, $\\sigma_{ci} = 80\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 55$, $D = 0.5$.\n- Case $2$ (typical rock, moderate support): $a = 2.5\\,\\mathrm{m}$, $H = 500\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = 5\\,\\mathrm{MPa}$, $\\sigma_{ci} = 80\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 55$, $D = 0.5$.\n- Case $3$ (boundary condition, full support equal to geostatic): $a = 2.5\\,\\mathrm{m}$, $H = 500\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = p_0$ computed from $H$ and $\\gamma$, $\\sigma_{ci} = 80\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 55$, $D = 0.5$.\n- Case $4$ (weaker rock, low support): $a = 3.0\\,\\mathrm{m}$, $H = 400\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = 1.0\\,\\mathrm{MPa}$, $\\sigma_{ci} = 50\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 35$, $D = 0.7$.\n\nAll inputs in the test suite are in Standard International (SI) units as specified. Angles for internal computations must be in radians. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_{p1}/a, r_{p2}/a, r_{p3}/a, r_{p4}/a]$). Each list entry must be a float.\n\nThe final answer must be a complete, runnable program that implements this algorithm exactly for the provided test suite and prints the results in the specified format.",
            "solution": "The problem statement has been validated and is deemed a well-posed and scientifically sound problem in computational geomechanics. It presents a clear algorithmic procedure for determining the extent of the plastic zone around a circular tunnel under hydrostatic stress conditions, using a widely accepted, albeit simplified, analytical model. The model linearizes the non-linear Hoek-Brown failure criterion to a tangent Mohr-Coulomb criterion, which permits a closed-form solution. All required physical parameters, equations, and test cases are provided, and the setup is internally consistent.\n\nThe solution proceeds by implementing the prescribed algorithm. The core of the analysis involves calculating the stress state in the rock mass and comparing it against the rock mass strength to determine the radius $r_p$ of the region where yielding occurs.\n\nThe first step is to establish the initial stress state. The far-field in-situ geostatic pressure, $p_0$, is a hydrostatic stress resulting from the overburden weight. It is calculated as:\n$$\np_0 = \\frac{\\gamma H}{1000}\n$$\nwhere $p_0$ is in $\\mathrm{MPa}$, $\\gamma$ is the rock unit weight in $\\mathrm{kN/m^3}$, and $H$ is the tunnel depth in $\\mathrm{m}$. The excavation of the tunnel and the application of an internal support pressure $p_i$ creates a stress differential $\\Delta = p_0 - p_i$. This differential drives the stress redistribution and potential plastic failure around the tunnel. If $\\Delta \\le 0$, it implies that the support pressure is equal to or greater than the in-situ stress, preventing any inward movement or stress-induced failure. In this case, no plastic zone develops, and the plastic radius $r_p$ is equal to the tunnel radius $a$, yielding a ratio $r_p/a = 1$.\n\nNext, the strength of the rock mass is characterized using the empirical Hoek-Brown criterion. The criterion depends on several parameters derived from the Geological Strength Index ($\\mathrm{GSI}$), the disturbance factor ($D$), and properties of the intact rock ($\\sigma_{ci}, m_i$). These parameters are the reduced Hoek-Brown constant $m_b$, the rock mass quality term $s$, and the exponent $a$:\n$$\nm_b = m_i \\exp\\left(\\frac{\\mathrm{GSI}-100}{28-14D}\\right)\n$$\n$$\ns = \\exp\\left(\\frac{\\mathrm{GSI}-100}{9-3D}\\right)\n$$\n$$\na = \\frac{1}{2} + \\frac{1}{6}\\left[\\exp\\left(-\\frac{\\mathrm{GSI}}{15}\\right) - \\exp\\left(-\\frac{20}{3}\\right)\\right]\n$$\n\nThe non-linear Hoek-Brown failure envelope is computationally complex for direct analytical integration. Therefore, the problem specifies a common engineering approximation: linearization to an equivalent Mohr-Coulomb model ($\\sigma_1 = \\alpha\\,\\sigma_3 + \\beta$) at a chosen confining stress. The problem directs the use of $\\sigma_{3t} = p_i$ as the point of tangency. At this point, the slope of the Hoek-Brown criterion is matched to the slope of the Mohr-Coulomb line.\nThe slope, $k$, is the derivative of the major principal stress $\\sigma_1$ with respect to the minor principal stress $\\sigma_3$, evaluated at $\\sigma_{3t}$:\n$$\nk = \\left.\\frac{d\\sigma_1}{d\\sigma_3}\\right|_{\\sigma_3=\\sigma_{3t}} = 1 + a\\,m_b\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^{a-1}\n$$\nThis slope $k$ is identical to the Mohr-Coulomb parameter $\\alpha$. From $k$, the equivalent angle of internal friction $\\varphi$ is found:\n$$\n\\sin\\varphi = \\frac{k-1}{k+1} \\implies \\alpha = k = \\frac{1+\\sin\\varphi}{1-\\sin\\varphi}\n$$\nTo find the second Mohr-Coulomb parameter, $\\beta$, which relates to cohesion $c$, we enforce that the line passes through the point on the Hoek-Brown curve at $\\sigma_{3t}$. First, we compute the major principal stress from the Hoek-Brown criterion at this point:\n$$\n\\sigma_1^{HB}(\\sigma_{3t}) = \\sigma_{3t} + \\sigma_{ci}\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^a\n$$\nThen, the parameter $\\beta$ is determined by the identity $\\sigma_1^{HB}(\\sigma_{3t}) = \\alpha\\,\\sigma_{3t} + \\beta$:\n$$\n\\beta = \\sigma_1^{HB}(\\sigma_{3t}) - \\alpha\\,\\sigma_{3t}\n$$\n\nThe extent of the plastic zone is found by establishing a continuity condition at the interface between the elastic and plastic zones, $r=r_p$. At this boundary, the stress state predicted by the elastic solution must satisfy the plastic yield criterion. The elastic stresses around a cylindrical cavity are given by:\n$$\n\\sigma_r^{e}(r) = p_0 - (p_0 - p_i)\\frac{a^2}{r^2}\n$$\n$$\n\\sigma_\\theta^{e}(r) = p_0 + (p_0 - p_i)\\frac{a^2}{r^2}\n$$\nApplying the yield condition $\\sigma_\\theta = \\alpha\\,\\sigma_r + \\beta$ at $r=r_p$ (with $\\sigma_\\theta=\\sigma_1$, $\\sigma_r=\\sigma_3$) using the elastic stress expressions:\n$$\np_0 + (p_0 - p_i)\\frac{a^2}{r_p^2} = \\alpha\\left[p_0 - (p_0 - p_i)\\frac{a^2}{r_p^2}\\right] + \\beta\n$$\nDefining $x \\equiv (a/r_p)^2$ and $\\Delta = p_0 - p_i$, this equation can be algebraically rearranged to solve for $x$:\n$$\np_0 + \\Delta\\,x = \\alpha(p_0 - \\Delta\\,x) + \\beta \\implies \\Delta\\,x(1+\\alpha) = p_0(\\alpha-1) + \\beta\n$$\n$$\nx = \\frac{p_0(\\alpha - 1) + \\beta}{\\Delta(1+\\alpha)}\n$$\nThe value of $x$ determines the plastic zone size.\n1.  If $\\Delta \\le 0$, there is no plastic zone, so $r_p/a = 1$.\n2.  If $x \\le 0$, the rock mass is sufficiently strong that the stress state never reaches the yield envelope under the given conditions. Thus, $r_p/a = 1$.\n3.  A plastic zone develops only if yielding occurs at the tunnel wall ($r=a$). This corresponds to $x < 1$. If $x \\ge 1$, the rock remains elastic everywhere, so $r_p/a = 1$.\n4.  If a plastic zone exists ($0 < x < 1$), its size is given by $r_p/a = 1/\\sqrt{x}$.\n\nThis completes the logical framework for the algorithm, which will be implemented to solve for the test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef compute_rp_ratio(a_rad, H, gamma, p_i, sig_ci, m_i, gsi, d):\n    \"\"\"\n    Computes the plastic zone radius ratio r_p/a around a circular tunnel.\n    All pressure/stress inputs are in MPa.\n    \"\"\"\n    \n    # Step 1: Compute geostatic pressure and stress differential\n    p0 = gamma * H / 1000.0\n    \n    # Handle the specific setup for Case 3 where p_i is defined as p0\n    if isinstance(p_i, str) and p_i.lower() == 'p0':\n        p_i_val = p0\n    else:\n        p_i_val = p_i\n\n    delta = p0 - p_i_val\n    \n    # Condition: If support pressure is high enough, no plastic zone forms.\n    if delta <= 0:\n        return 1.0\n        \n    # Step 2: Compute Hoek-Brown parameters\n    mb = m_i * np.exp((gsi - 100) / (28 - 14 * d))\n    s = np.exp((gsi - 100) / (9 - 3 * d))\n    a_param = 0.5 + (1/6) * (np.exp(-gsi / 15) - np.exp(-20 / 3))\n    \n    # Step 3: Mohr-Coulomb Linearization\n    sigma_3t = p_i_val\n    \n    # Check for potential math domain error if the term inside the power is negative\n    # This happens if s is very small and sigma_3t is negative, which is not the case here.\n    term_for_k = (mb * sigma_3t / sig_ci) + s\n    if term_for_k < 0:\n        # This case is physically unlikely for this problem setup but is a robust check.\n        # It would imply tension, and the H-B criterion has limitations here.\n        # For this problem's constraints, we assume no plastic yielding.\n        return 1.0\n\n    k = 1 + a_param * mb * (term_for_k)**(a_param - 1)\n    \n    alpha = k\n    \n    if k <= 1: # a non-frictional or cohesive-only material model may result from linearization\n               # this should not occur for typical rock parameters, implies high strength.\n        return 1.0\n        \n    # Calculate major principal stress from H-B at the tangent point\n    sig1_hb = sigma_3t + sig_ci * (term_for_k)**a_param\n    \n    # Calculate beta from the tangent condition\n    beta = sig1_hb - alpha * sigma_3t\n    \n    # Step 4: Solve for the plastic radius ratio\n    # x = (a/r_p)^2\n    denominator = delta * (1 + alpha)\n    if denominator == 0: # Should be caught by delta <= 0, but as a safeguard.\n        return 1.0\n\n    numerator = p0 * (alpha - 1) + beta\n    x = numerator / denominator\n    \n    # Step 5: Report the ratio based on the value of x\n    # if x <= 0, rock is too strong, no plastic zone.\n    # if x >= 1, elastic stress state at the wall is within the yield envelope, no plastic zone.\n    if x <= 0 or x >= 1:\n        return 1.0\n    \n    # if 0 < x < 1, a plastic zone exists.\n    rp_over_a = 1.0 / np.sqrt(x)\n    \n    return rp_over_a\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (a, H, gamma, p_i, sig_ci, m_i, GSI, D)\n        (2.5, 500, 27, 0, 80, 10, 55, 0.5),      # Case 1\n        (2.5, 500, 27, 5, 80, 10, 55, 0.5),      # Case 2\n        (2.5, 500, 27, 'p0', 80, 10, 55, 0.5),   # Case 3\n        (3.0, 400, 27, 1.0, 50, 10, 35, 0.7),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_rp_ratio(*case)\n        results.append(result)\n\n    # Format the output as a single line: [res1,res2,res3,res4]\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Finding an equilibrium point between the ground and support is only part of the analysis; ensuring that equilibrium is stable is paramount. This exercise delves into the advanced topic of energetic stability, using the principle of minimum potential energy to assess the stability of the ground-support system. By analyzing the second variation of the system's total potential, you will identify critical limit points where stability is lost and predict complex nonlinear behaviors such as snap-through, gaining a deeper understanding of potential failure mechanisms in tunneling. ",
            "id": "3569440",
            "problem": "A one-degree-of-freedom reduction of the convergence–confinement method is adopted for a circular tunnel in plane strain to study the interaction between the nonlinear deforming ground and an elastic support. Let the generalized displacement be the tunnel wall convergence $u$ (in $\\text{m}$). The far-field geostatic pressure $p_0$ (in $\\text{MPa}$) is a dead load. The elastic support is modeled as a linear spring with stiffness $k_s = 5 \\text{ MPa/m}$. The surrounding rock mass is represented by a conservative nonlinear ground response described by the generalized resisting pressure\n$$\np_g(u) = A\\,u - B\\,u^{3} + C\\,u^{5},\n$$\nwith $A = 10 \\text{ MPa/m}$, $B = 150 \\text{ MPa/m}^3$, and $C = 500 \\text{ MPa/m}^5$. The coupled conservative system is described by the total potential\n$$\n\\Pi(u) = U_g(u) + \\frac{1}{2} k_s u^2 - p_0 u,\n$$\nwhere $U_g(u)$ is the recoverable stored energy of the ground satisfying the constitutive work-conjugacy definition $\\frac{dU_g}{du} = p_g(u)$.\n\nStarting from first principles of energy minimization, use the stationarity and positive-definiteness conditions of the total potential to:\n\n- derive the equilibrium path and the energetic stability condition along that path,\n- evaluate the second variation $\\delta^{2}\\Pi$ along the Ground Response Curve (GRC) equilibrium path,\n- determine the points where energetic stability is lost along the equilibrium path (i.e., where $\\delta^{2}\\Pi = 0$), and classify the corresponding limit points in terms of snap-through or snap-back behavior under load control versus displacement control.\n\nFinally, compute the smaller of the two corresponding far-field pressures $p_0$ (in $\\text{MPa}$) at which energetic stability is first lost (i.e., the lower of the two critical values on the $p_0$–$u$ path). Round your answer to four significant figures and express the final pressure in $\\text{MPa}$. Your final reported answer must be a single real number.",
            "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Generalized Displacement**: Tunnel wall convergence $u$ (in $\\text{m}$).\n- **Far-field Geostatic Pressure**: $p_0$ (in $\\text{MPa}$), a dead load.\n- **Support Stiffness**: $k_s = 5 \\text{ MPa/m}$.\n- **Ground Resisting Pressure**: $p_g(u) = A\\,u - B\\,u^{3} + C\\,u^{5}$.\n- **Ground Response Constants**: $A = 10 \\text{ MPa/m}$, $B = 150 \\text{ MPa/m}^3$, $C = 500 \\text{ MPa/m}^5$.\n- **Total Potential Energy**: $\\Pi(u) = U_g(u) + \\frac{1}{2} k_s u^2 - p_0 u$.\n- **Work Conjugacy**: $\\frac{dU_g}{du} = p_g(u)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria.\n- **Scientific Groundedness**: The problem is based on the convergence-confinement method, a standard and well-established framework in rock mechanics and tunnel engineering. The use of potential energy minimization to find equilibrium and assess stability is a fundamental principle of mechanics. The given functions and parameters are consistent with a simplified, but valid, nonlinear mechanical model.\n- **Well-Posedness**: The problem is mathematically well-defined. It provides all necessary functions and constants to determine the equilibrium path and its stability. The objective is to find specific critical points, which is a solvable problem in calculus and stability theory.\n- **Objectivity**: The problem statement is composed of objective, technical language, free from any subjective or biased phrasing.\n- **Completeness and Consistency**: All parameters ($A$, $B$, $C$, $k_s$) and functional relationships are explicitly provided. The units are consistent throughout the problem description ($\\text{MPa}$, $\\text{m}$, $\\text{MPa/m}$, etc.). There are no internal contradictions.\n- **Realism and Feasibility**: The model is a one-degree-of-freedom idealization, but it represents a valid simplification used in preliminary tunnel design analysis. The numerical values, while specific to this problem, do not represent physically impossible quantities.\n- **Structure and Clarity**: The problem is structured logically, guiding the solver from first principles (stationarity of potential) to the final calculation. The terminology used (e.g., stationarity, positive-definiteness, snap-through) is standard in nonlinear mechanics.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and internally consistent. It is a valid problem in computational geomechanics. The solution process may proceed.\n\n### Solution Derivation\nThe solution is derived from the principle of minimum potential energy. A state of equilibrium corresponds to a stationary point of the total potential energy, $\\Pi(u)$. A stable equilibrium requires this stationary point to be a local minimum.\n\nFirst, we establish the equilibrium path. The condition for equilibrium is the stationarity of the total potential, $\\delta \\Pi = 0$. For a one-degree-of-freedom system, this corresponds to the first derivative of the potential with respect to the generalized displacement being zero:\n$$\n\\frac{d\\Pi}{du} = 0\n$$\nGiven the total potential $\\Pi(u) = U_g(u) + \\frac{1}{2} k_s u^2 - p_0 u$ and the work-conjugacy relation $\\frac{dU_g}{du} = p_g(u)$, the derivative is:\n$$\n\\frac{d\\Pi}{du} = \\frac{dU_g}{du} + \\frac{d}{du}\\left(\\frac{1}{2}k_s u^2\\right) - \\frac{d}{du}(p_0 u) = p_g(u) + k_s u - p_0\n$$\nSetting this to zero yields the equilibrium equation, which defines the path of equilibrium states $(u, p_0)$:\n$$\np_0(u) = p_g(u) + k_s u\n$$\nThis equation describes the total pressure that the system (ground plus support) can sustain at a given convergence $u$. Substituting the expression for $p_g(u)$:\n$$\np_0(u) = (A u - B u^3 + C u^5) + k_s u = (A + k_s)u - B u^3 + C u^5\n$$\nThis is the equilibrium path for the coupled system.\n\nNext, we establish the energetic stability condition. For an equilibrium point to be stable, it must be a local minimum of the potential energy. This requires the second variation of the potential to be positive-definite, $\\delta^2 \\Pi > 0$. For a one-degree-of-freedom system, this is equivalent to the second derivative being positive:\n$$\n\\delta^2 \\Pi = \\frac{d^2\\Pi}{du^2} > 0\n$$\nWe calculate the second derivative of $\\Pi(u)$:\n$$\n\\frac{d^2\\Pi}{du^2} = \\frac{d}{du}\\left( \\frac{d\\Pi}{du} \\right) = \\frac{d}{du}\\left( p_g(u) + k_s u - p_0 \\right) = \\frac{dp_g}{du} + k_s\n$$\nNote that $\\frac{d^2\\Pi}{du^2} = \\frac{dp_0}{du}$. Therefore, the stability condition is $\\frac{dp_0}{du} > 0$, which means that for a stable response under load control, the required load $p_0$ must increase with increasing displacement $u$. The slope of the equilibrium path on a $p_0$ versus $u$ plot must be positive.\n\nThe problem asks to find the points where energetic stability is lost. This occurs at the limit of the stability region, where the second variation becomes zero:\n$$\n\\delta^2 \\Pi = \\frac{d^2\\Pi}{du^2} = 0\n$$\nCalculating the derivative $\\frac{dp_g}{du}$:\n$$\n\\frac{dp_g}{du} = \\frac{d}{du}(A u - B u^3 + C u^5) = A - 3B u^2 + 5C u^4\n$$\nThe condition for loss of stability becomes:\n$$\n(A - 3B u^2 + 5C u^4) + k_s = 0\n$$\n$$\n(A + k_s) - 3B u^2 + 5C u^4 = 0\n$$\nThese points correspond to the local extrema (maximum and minimum) on the equilibrium path $p_0(u)$, where $\\frac{dp_0}{du} = 0$. These are limit points. Under load control (specified by \"dead load\"), reaching such a point leads to a dynamic jump to a different equilibrium state, a phenomenon known as snap-through. The problem geometry does not allow for snap-back behavior, which would require the displacement to decrease as the controlling parameter is advanced.\n\nTo find the critical displacements $u_{crit}$ where stability is lost, we solve the equation for $u$. Let $x = u^2$. The equation is a quadratic in $x$:\n$$\n5C x^2 - 3B x + (A + k_s) = 0\n$$\nSubstituting the given values $A = 10 \\text{ MPa/m}$, $B = 150 \\text{ MPa/m}^3$, $C = 500 \\text{ MPa/m}^5$, and $k_s = 5 \\text{ MPa/m}$:\n$$\n5(500) x^2 - 3(150) x + (10 + 5) = 0\n$$\n$$\n2500 x^2 - 450 x + 15 = 0\n$$\nDividing by $5$ simplifies the equation to:\n$$\n500 x^2 - 90 x + 3 = 0\n$$\nWe use the quadratic formula to find the roots $x_{1,2}$:\n$$\nx = \\frac{-(-90) \\pm \\sqrt{(-90)^2 - 4(500)(3)}}{2(500)} = \\frac{90 \\pm \\sqrt{8100 - 6000}}{1000} = \\frac{90 \\pm \\sqrt{2100}}{1000}\n$$\n$$\nx = \\frac{90 \\pm 10\\sqrt{21}}{1000} = \\frac{9 \\pm \\sqrt{21}}{100}\n$$\nSince $\\sqrt{21} \\approx 4.58$, both roots for $x=u^2$ are positive and thus physically meaningful. Let the smaller root be $x_1$ and the larger be $x_2$:\n$$\nx_1 = u_1^2 = \\frac{9 - \\sqrt{21}}{100} \\approx 0.044174 \\text{ m}^2\n$$\n$$\nx_2 = u_2^2 = \\frac{9 + \\sqrt{21}}{100} \\approx 0.135826 \\text{ m}^2\n$$\nThese correspond to two critical positive displacements, $u_1 = \\sqrt{x_1}$ and $u_2 = \\sqrt{x_2}$. The stability condition $\\frac{dp_0}{du} > 0$ is satisfied for $u < u_1$ and $u > u_2$. The equilibrium path is unstable for $u_1 < u < u_2$. Therefore, $u_1$ corresponds to a local maximum of $p_0(u)$ and $u_2$ corresponds to a local minimum of $p_0(u)$.\n\nThe final step is to compute the critical pressures $p_{0,crit}$ at these two critical displacements by substituting them back into the equilibrium path equation:\n$$\np_0(u) = (A + k_s)u - B u^3 + C u^5 = 15u - 150u^3 + 500u^5\n$$\nWe calculate the pressures corresponding to $u_1$ and $u_2$:\n$$\np_{0, crit, 1} = p_0(u_1) = 15u_1 - 150u_1^3 + 500u_1^5\n$$\n$$\np_{0, crit, 2} = p_0(u_2) = 15u_2 - 150u_2^3 + 500u_2^5\n$$\nNumerically:\nFor $u_1 = \\sqrt{0.04417424...} \\approx 0.21017670 \\text{ m}$:\n$$\np_{0, crit, 1} = 15(0.21017670) - 150(0.21017670)^3 + 500(0.21017670)^5 \\approx 3.152650 - 1.392715 + 0.205073 \\approx 1.965008 \\text{ MPa}\n$$\nFor $u_2 = \\sqrt{0.13582576...} \\approx 0.36854546 \\text{ m}$:\n$$\np_{0, crit, 2} = 15(0.36854546) - 150(0.36854546)^3 + 500(0.36854546)^5 \\approx 5.528182 - 7.509015 + 3.400194 \\approx 1.419361 \\text{ MPa}\n$$\nThe two critical pressures at which stability is lost are approximately $1.9650 \\text{ MPa}$ and $1.4194 \\text{ MPa}$. The problem asks for the smaller of these two values.\n$$\n\\min(p_{0, crit, 1}, p_{0, crit, 2}) \\approx 1.419361 \\text{ MPa}\n$$\nRounding the result to four significant figures gives $1.419$.",
            "answer": "$$\\boxed{1.419}$$"
        }
    ]
}