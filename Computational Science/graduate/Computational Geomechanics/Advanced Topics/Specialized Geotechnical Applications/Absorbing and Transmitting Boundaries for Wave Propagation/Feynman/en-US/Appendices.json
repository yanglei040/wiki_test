{
    "hands_on_practices": [
        {
            "introduction": "Understanding how waves behave at material interfaces is the first step toward designing effective absorbing boundaries. This practice guides you through the fundamental derivation of reflection and transmission coefficients from first principles, demonstrating how impedance mismatch dictates the energy partitioning of a wave. By applying these principles to a concrete example, you will gain a foundational understanding of why artificial boundaries in simulations can cause spurious reflections if not treated properly.",
            "id": "3498878",
            "problem": "A one-dimensional ($1\\text{D}$) normally incident primary wave (P-wave) travels from an isotropic, linear elastic medium $1$ into an isotropic, linear elastic medium $2$ across a perfectly bonded, planar interface at $x=0$. This situation models a transmitting boundary used to truncate a semi-infinite domain in computational geomechanics, where the reflection and transmission of tractions through the boundary must be controlled to avoid spurious reflections. Let the mass density and P-wave speed in medium $1$ be $\\rho_1$ and $c_{P,1}$, and those in medium $2$ be $\\rho_2$ and $c_{P,2}$. The P-wave impedance in medium $j$ is defined as $Z_j=\\rho_j c_{P,j}$ for $j\\in\\{1,2\\}$.\n\nUsing conservation of linear momentum, linear elasticity, and interface continuity of normal traction and normal particle velocity, derive the normal-incidence stress-amplitude reflection coefficient $R$ and stress-amplitude transmission coefficient $T$ at the interface, where $R$ is the ratio of the reflected normal traction amplitude in medium $1$ to the incident normal traction amplitude in medium $1$, and $T$ is the ratio of the transmitted normal traction amplitude in medium $2$ to the incident normal traction amplitude in medium $1$.\n\nThen evaluate $R$ and $T$ for the following material properties:\n$$\\rho_1=2000\\ \\mathrm{kg/m^3},\\quad c_{P,1}=1600\\ \\mathrm{m/s},\\quad \\rho_2=2650\\ \\mathrm{kg/m^3},\\quad c_{P,2}=6000\\ \\mathrm{m/s}.$$\n\nExpress your final numerical answer as a two-entry row matrix containing $R$ and $T$ in that order. Both coefficients are dimensionless. Round your numerical results to four significant figures.",
            "solution": "The problem requires the derivation of the stress-amplitude reflection and transmission coefficients for a one-dimensional ($1\\text{D}$) P-wave normally incident on an interface between two distinct linear elastic media, followed by a numerical evaluation for given material properties. The derivation will be based on the principles of wave propagation in continuous media and the application of continuity conditions at the interface.\n\nLet the interface be located at $x=0$. Medium $1$ occupies the half-space $x<0$ and medium $2$ occupies the half-space $x>0$. The physical properties (mass density $\\rho$, P-wave speed $c_P$) are denoted with subscripts $1$ and $2$ for the respective media. The P-wave impedance is defined as $Z_j = \\rho_j c_{P,j}$ for $j \\in \\{1, 2\\}$.\n\nWe represent the waves as harmonic functions of position $x$ and time $t$. For a $1\\text{D}$ P-wave, we are interested in the normal stress $\\sigma(x,t)$ (equivalent to normal traction on a plane perpendicular to the x-axis) and the normal particle velocity $v(x,t)$.\n\nIn medium $1$ ($x<0$), the total wave field is a superposition of the incident wave propagating in the $+x$ direction and the reflected wave propagating in the $-x$ direction.\nThe incident stress wave is given by:\n$$ \\sigma_I(x,t) = \\tilde{\\sigma}_I \\exp\\left(i(k_1 x - \\omega t)\\right) $$\nThe reflected stress wave is given by:\n$$ \\sigma_R(x,t) = \\tilde{\\sigma}_R \\exp\\left(i(-k_1 x - \\omega t)\\right) $$\nHere, $\\tilde{\\sigma}_I$ and $\\tilde{\\sigma}_R$ are the complex amplitudes of the incident and reflected stress waves, respectively. The angular frequency is $\\omega$, and the wavenumber in medium $1$ is $k_1 = \\omega / c_{P,1}$.\n\nIn medium $2$ ($x>0$), there is only a transmitted wave propagating in the $+x$ direction:\n$$ \\sigma_T(x,t) = \\tilde{\\sigma}_T \\exp\\left(i(k_2 x - \\omega t)\\right) $$\nwhere $\\tilde{\\sigma}_T$ is the complex amplitude of the transmitted stress wave and $k_2 = \\omega / c_{P,2}$ is the wavenumber in medium $2$.\n\nThe relationship between normal stress $\\sigma$ and normal particle velocity $v$ for a plane wave is crucial. This can be derived from the 1D equation of motion $\\rho \\frac{\\partial v}{\\partial t} = \\frac{\\partial \\sigma}{\\partial x}$ and the constitutive law. For a harmonic wave, this leads to a direct proportionality involving the impedance $Z$.\nFor a forward-propagating wave (in the $+x$ direction, like the incident and transmitted waves), the relationship is:\n$$ \\sigma(x,t) = -Z v(x,t) $$\nFor a backward-propagating wave (in the $-x$ direction, like the reflected wave), the relationship is:\n$$ \\sigma(x,t) = +Z v(x,t) $$\n\nAt the interface $x=0$, continuity conditions must be satisfied. Since the interface is perfectly bonded, both the normal traction (stress) and the normal particle velocity must be continuous.\n\n1.  **Continuity of Normal Traction:** The total stress in medium $1$ must equal the total stress in medium $2$ at $x=0$.\n    $$ \\sigma_I(0,t) + \\sigma_R(0,t) = \\sigma_T(0,t) $$\n    Substituting the wave-field expressions and evaluating at $x=0$:\n    $$ \\tilde{\\sigma}_I \\exp(-i\\omega t) + \\tilde{\\sigma}_R \\exp(-i\\omega t) = \\tilde{\\sigma}_T \\exp(-i\\omega t) $$\n    This must hold for all time $t$, so we can write an equation for the amplitudes:\n    $$ \\tilde{\\sigma}_I + \\tilde{\\sigma}_R = \\tilde{\\sigma}_T \\quad \\quad (1) $$\n\n2.  **Continuity of Normal Particle Velocity:** The total particle velocity in medium $1$ must equal the particle velocity in medium $2$ at $x=0$.\n    $$ v_I(0,t) + v_R(0,t) = v_T(0,t) $$\n    Using the stress-velocity relationships: $v_I = -\\sigma_I/Z_1$, $v_R = +\\sigma_R/Z_1$, and $v_T = -\\sigma_T/Z_2$.\n    $$ -\\frac{\\sigma_I(0,t)}{Z_1} + \\frac{\\sigma_R(0,t)}{Z_1} = -\\frac{\\sigma_T(0,t)}{Z_2} $$\n    Again, this must hold for all $t$, leading to an amplitude equation:\n    $$ \\frac{1}{Z_1} (-\\tilde{\\sigma}_I + \\tilde{\\sigma}_R) = -\\frac{1}{Z_2} \\tilde{\\sigma}_T $$\n    $$ \\tilde{\\sigma}_R - \\tilde{\\sigma}_I = -\\frac{Z_1}{Z_2} \\tilde{\\sigma}_T \\quad \\quad (2) $$\n\nWe now have a system of two linear equations, (1) and (2), for the unknown amplitudes $\\tilde{\\sigma}_R$ and $\\tilde{\\sigma}_T$ in terms of the known incident amplitude $\\tilde{\\sigma}_I$. The problem defines the reflection coefficient $R = \\tilde{\\sigma}_R / \\tilde{\\sigma}_I$ and the transmission coefficient $T = \\tilde{\\sigma}_T / \\tilde{\\sigma}_I$.\n\nSubstitute $\\tilde{\\sigma}_T$ from equation (1) into equation (2):\n$$ \\tilde{\\sigma}_R - \\tilde{\\sigma}_I = -\\frac{Z_1}{Z_2} (\\tilde{\\sigma}_I + \\tilde{\\sigma}_R) $$\nMultiply by $Z_2$ to clear the denominator:\n$$ Z_2 (\\tilde{\\sigma}_R - \\tilde{\\sigma}_I) = -Z_1 (\\tilde{\\sigma}_I + \\tilde{\\sigma}_R) $$\n$$ Z_2 \\tilde{\\sigma}_R - Z_2 \\tilde{\\sigma}_I = -Z_1 \\tilde{\\sigma}_I - Z_1 \\tilde{\\sigma}_R $$\nGroup terms with $\\tilde{\\sigma}_R$ and $\\tilde{\\sigma}_I$:\n$$ \\tilde{\\sigma}_R (Z_1 + Z_2) = \\tilde{\\sigma}_I (Z_2 - Z_1) $$\nThe reflection coefficient $R$ is therefore:\n$$ R = \\frac{\\tilde{\\sigma}_R}{\\tilde{\\sigma}_I} = \\frac{Z_2 - Z_1}{Z_2 + Z_1} $$\n\nTo find the transmission coefficient $T$, we can rearrange equation (1) as $T = 1+R$:\n$$ T = \\frac{\\tilde{\\sigma}_T}{\\tilde{\\sigma}_I} = \\frac{\\tilde{\\sigma}_I + \\tilde{\\sigma}_R}{\\tilde{\\sigma}_I} = 1 + \\frac{\\tilde{\\sigma}_R}{\\tilde{\\sigma}_I} = 1 + R $$\nSubstituting the expression for $R$:\n$$ T = 1 + \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{Z_1 + Z_2 + Z_2 - Z_1}{Z_1 + Z_2} = \\frac{2Z_2}{Z_1 + Z_2} $$\n\nNow, we evaluate these coefficients for the given material properties:\n$\\rho_1=2000\\ \\mathrm{kg/m^3}$, $c_{P,1}=1600\\ \\mathrm{m/s}$\n$\\rho_2=2650\\ \\mathrm{kg/m^3}$, $c_{P,2}=6000\\ \\mathrm{m/s}$\n\nFirst, calculate the P-wave impedances $Z_1$ and $Z_2$:\n$$ Z_1 = \\rho_1 c_{P,1} = (2000\\ \\mathrm{kg/m^3}) \\times (1600\\ \\mathrm{m/s}) = 3.2 \\times 10^6\\ \\mathrm{kg \\cdot m^{-2} \\cdot s^{-1}} $$\n$$ Z_2 = \\rho_2 c_{P,2} = (2650\\ \\mathrm{kg/m^3}) \\times (6000\\ \\mathrm{m/s}) = 15.9 \\times 10^6\\ \\mathrm{kg \\cdot m^{-2} \\cdot s^{-1}} $$\nThe units $\\mathrm{kg \\cdot m^{-2} \\cdot s^{-1}}$ are also known as Rayl.\n\nNext, compute $R$ and $T$:\n$$ R = \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{(15.9 - 3.2) \\times 10^6}{(3.2 + 15.9) \\times 10^6} = \\frac{12.7}{19.1} $$\n$$ R \\approx 0.6649214659... $$\nRounding to four significant figures, we get $R = 0.6649$.\n\n$$ T = \\frac{2Z_2}{Z_1 + Z_2} = \\frac{2 \\times 15.9 \\times 10^6}{(3.2 + 15.9) \\times 10^6} = \\frac{31.8}{19.1} $$\n$$ T \\approx 1.6649214659... $$\nRounding to four significant figures, we get $T = 1.665$.\n\nThe results are dimensionless coefficients, as required. The final answer is the pair $(R, T)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6649 & 1.665 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Moving beyond simple interfaces, we explore the design of a specialized absorbing region known as a Perfectly Matched Layer (PML). This exercise challenges you to analyze how a PML, governed by an augmented wave equation, attenuates incoming waves. You will derive the relationship between the layer's properties and its attenuation performance, and then apply this to calculate a required PML thickness, linking theoretical models to practical design criteria.",
            "id": "3498942",
            "problem": "Consider one-dimensional plane compressional wave propagation in a homogeneous elastic medium with constant wave speed $c$, where a Perfectly Matched Layer (PML) of thickness $L$ is attached to the computational boundary to absorb outgoing waves. Within the PML, the governing equation for the displacement field $u(x,t)$ is augmented by a spatially varying linear damping profile $\\sigma(x)$ so that the PML dynamics are governed by\n$$\nu_{tt} + \\sigma(x)\\,u_{t} = c^{2}\\,u_{xx},\n$$\nfor $x \\in [0,L]$, with the physical interface at $x=0$ and the outer boundary at $x=L$. Assume harmonic excitation at angular frequency $\\omega$ and that $\\sigma(x)$ varies slowly enough for a local plane-wave approximation to be valid in the PML. The PML is perfectly matched at $x=0$ so that reflections there are negligible, and attenuation is controlled by the propagation through and back across the PML.\n\nTasks:\n1. Starting from the stated equation of motion and the harmonic ansatz, derive the local complex wavenumber $k(x)$ to leading order in $\\sigma(x)$ and obtain the round-trip amplitude reduction factor across the PML as an exponential involving the path integral of the local attenuation coefficient. Define the amplitude attenuation in decibels (dB) by $A_{\\mathrm{dB}} = -20 \\log_{10} R$, where $R$ is the magnitude of the round-trip amplitude ratio. Then, for a polynomial damping profile\n$$\n\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^{m},\n$$\nwith $m \\ge 1$, derive a closed-form relation connecting $A_{\\mathrm{dB}}$, $L$, $\\sigma_{\\max}$, $m$, and $c$.\n\n2. Using the derived relation, determine the minimal PML thickness $L$ required to achieve a target amplitude attenuation of $A_{\\mathrm{dB}} = 60$ with wave speed $c = 2000\\,\\mathrm{m/s}$, polynomial order $m = 3$, and subject to the stability-imposed bound $\\sigma_{\\max} \\le 1000\\,\\mathrm{s}^{-1}$. Express the thickness $L$ in meters and round your final numerical answer to four significant figures.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The solution proceeds in two parts as requested.\n\nPart 1: Derivation of the general relation for amplitude attenuation.\nThe governing equation for wave propagation within the Perfectly Matched Layer (PML) is given by:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} + \\sigma(x) \\frac{\\partial u}{\\partial t} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $u(x,t)$ is the displacement, $c$ is the constant wave speed, and $\\sigma(x)$ is the spatially varying damping profile.\n\nWe consider a harmonic wave solution (ansatz) of the form $u(x,t) = \\hat{u}(x) \\exp(-i\\omega t)$, where $\\omega$ is the angular frequency. The partial derivatives with respect to time $t$ are:\n$$\n\\frac{\\partial u}{\\partial t} = -i\\omega \\hat{u}(x) \\exp(-i\\omega t)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = -\\omega^2 \\hat{u}(x) \\exp(-i\\omega t)\n$$\nThe partial derivative with respect to position $x$ is:\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = \\frac{d^2 \\hat{u}}{dx^2} \\exp(-i\\omega t)\n$$\nSubstituting these expressions into the governing equation and dividing by the common factor $\\exp(-i\\omega t)$ yields an ordinary differential equation for the spatial amplitude $\\hat{u}(x)$:\n$$\n-\\omega^2 \\hat{u}(x) - i\\omega\\sigma(x) \\hat{u}(x) = c^2 \\frac{d^2 \\hat{u}}{dx^2}\n$$\nRearranging this equation gives a Helmholtz-like equation:\n$$\n\\frac{d^2 \\hat{u}}{dx^2} + \\frac{\\omega^2}{c^2} \\left(1 + i\\frac{\\sigma(x)}{\\omega}\\right) \\hat{u}(x) = 0\n$$\nThis equation has the form $\\frac{d^2 \\hat{u}}{dx^2} + k(x)^2 \\hat{u}(x) = 0$, where $k(x)$ is the local complex wavenumber. By comparison, we identify:\n$$\nk(x)^2 = \\frac{\\omega^2}{c^2} \\left(1 + i\\frac{\\sigma(x)}{\\omega}\\right)\n$$\nTaking the square root, we get:\n$$\nk(x) = \\frac{\\omega}{c} \\left(1 + i\\frac{\\sigma(x)}{\\omega}\\right)^{1/2}\n$$\nThe problem states that we should find $k(x)$ to leading order in $\\sigma(x)$. This implies that the damping term is small compared to the frequency, i.e., $\\frac{\\sigma(x)}{\\omega} \\ll 1$. We can use the binomial expansion $(1+z)^{\\alpha} \\approx 1 + \\alpha z$ for small $z$. Here, $z = i\\frac{\\sigma(x)}{\\omega}$ and $\\alpha = \\frac{1}{2}$.\n$$\nk(x) \\approx \\frac{\\omega}{c} \\left(1 + \\frac{1}{2} i\\frac{\\sigma(x)}{\\omega}\\right) = \\frac{\\omega}{c} + i\\frac{\\sigma(x)}{2c}\n$$\nThe complex wavenumber $k(x)$ has a real part $k_R = \\frac{\\omega}{c}$ and an imaginary part $k_I(x) = \\frac{\\sigma(x)}{2c}$. The imaginary part, $k_I(x)$, is the local attenuation coefficient, which governs the spatial decay of the wave amplitude.\n\nA plane wave propagating through the PML from $x=0$ to $x=L$ has its amplitude multiplied by a factor whose magnitude is $\\exp\\left(-\\int_0^L k_I(x) dx\\right)$. The problem specifies that attenuation is due to propagation through and back across the PML. This implies a wave travels from $x=0$ to $x=L$, reflects at $x=L$ (with a reflection coefficient of magnitude $1$), and travels back to $x=0$. The round-trip amplitude reduction factor, $R$, is the product of the attenuation factors for the forward and backward paths:\n$$\nR = \\exp\\left(-\\int_0^L k_I(x) dx\\right) \\times \\exp\\left(-\\int_L^0 k_I(x) dx\\right) = \\exp\\left(-2 \\int_0^L k_I(x) dx\\right)\n$$\nSubstituting the expression for the attenuation coefficient $k_I(x) = \\frac{\\sigma(x)}{2c}$:\n$$\nR = \\exp\\left(-2 \\int_0^L \\frac{\\sigma(x)}{2c} dx\\right) = \\exp\\left(-\\frac{1}{c} \\int_0^L \\sigma(x) dx\\right)\n$$\nThe amplitude attenuation in decibels ($A_{\\mathrm{dB}}$) is defined as $A_{\\mathrm{dB}} = -20 \\log_{10} R$. Substituting the expression for $R$:\n$$\nA_{\\mathrm{dB}} = -20 \\log_{10} \\left[ \\exp\\left(-\\frac{1}{c} \\int_0^L \\sigma(x) dx\\right) \\right]\n$$\nUsing the logarithm property $\\log_b(a^p) = p \\log_b(a)$ and the change of base formula $\\log_{10}(e) = \\frac{\\ln(e)}{\\ln(10)} = \\frac{1}{\\ln(10)}$:\n$$\nA_{\\mathrm{dB}} = -20 \\left(-\\frac{1}{c} \\int_0^L \\sigma(x) dx\\right) \\log_{10}(e) = \\frac{20}{c \\ln(10)} \\int_0^L \\sigma(x) dx\n$$\nNext, we use the specific polynomial damping profile $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^{m}$. We compute the integral:\n$$\n\\int_0^L \\sigma(x) dx = \\int_0^L \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^{m} dx = \\frac{\\sigma_{\\max}}{L^m} \\int_0^L x^m dx\n$$\n$$\n\\int_0^L x^m dx = \\left[ \\frac{x^{m+1}}{m+1} \\right]_0^L = \\frac{L^{m+1}}{m+1}\n$$\nTherefore, the integral of the damping profile is:\n$$\n\\int_0^L \\sigma(x) dx = \\frac{\\sigma_{\\max}}{L^m} \\frac{L^{m+1}}{m+1} = \\frac{\\sigma_{\\max} L}{m+1}\n$$\nSubstituting this result into the expression for $A_{\\mathrm{dB}}$ yields the final closed-form relation:\n$$\nA_{\\mathrm{dB}} = \\frac{20}{c \\ln(10)} \\left( \\frac{\\sigma_{\\max} L}{m+1} \\right)\n$$\n\nPart 2: Calculation of the minimal PML thickness $L$.\nWe are asked to find the minimal PML thickness $L$ required to achieve a target attenuation of $A_{\\mathrm{dB}} = 60$. To do this, we first rearrange the derived relation to solve for $L$:\n$$\nL = A_{\\mathrm{dB}} \\frac{c \\ln(10) (m+1)}{20 \\sigma_{\\max}}\n$$\nTo find the *minimal* required thickness $L$, we must maximize the attenuation effect for a given thickness. This is achieved by using the maximum permissible value of the damping parameter $\\sigma_{\\max}$. The problem provides the stability-imposed bound $\\sigma_{\\max} \\le 1000\\,\\mathrm{s}^{-1}$. Thus, we set $\\sigma_{\\max} = 1000\\,\\mathrm{s}^{-1}$.\n\nThe given values are:\n- Target attenuation $A_{\\mathrm{dB}} = 60$\n- Wave speed $c = 2000\\,\\mathrm{m/s}$\n- Polynomial order $m = 3$\n- Maximum damping $\\sigma_{\\max} = 1000\\,\\mathrm{s}^{-1}$\n\nSubstituting these values into the expression for $L$:\n$$\nL = 60 \\cdot \\frac{2000 \\cdot \\ln(10) \\cdot (3+1)}{20 \\cdot 1000}\n$$\n$$\nL = 60 \\cdot \\frac{2000 \\cdot \\ln(10) \\cdot 4}{20000} = 60 \\cdot \\frac{8000 \\cdot \\ln(10)}{20000}\n$$\n$$\nL = 60 \\cdot \\frac{8}{20} \\ln(10) = 60 \\cdot \\frac{2}{5} \\ln(10) = 24 \\ln(10)\n$$\nNow, we calculate the numerical value. Using $\\ln(10) \\approx 2.302585$:\n$$\nL \\approx 24 \\times 2.302585 = 55.26204\\,\\mathrm{m}\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nL \\approx 55.26\\,\\mathrm{m}\n$$\nThis is the minimal PML thickness required to meet the specified attenuation criteria.",
            "answer": "$$\n\\boxed{55.26}\n$$"
        },
        {
            "introduction": "The final practice bridges theory and computational implementation by tackling the calibration of a Convolutional Perfectly Matched Layer (CPML), a robust and widely used boundary condition. This problem simulates a realistic engineering task where you must optimize CPML parameters to absorb challenging surface waves across a range of frequencies. By implementing a calibration algorithm, you will develop practical skills in translating analytical models into effective numerical solutions for complex wave propagation problems.",
            "id": "3498941",
            "problem": "Design and implement a program that calibrates the Convolutional Perfectly Matched Layer (CPML) parameters for attenuating Rayleigh waves in a two-dimensional soft-over-stiff geological layering during time-harmonic wave propagation. The goal is to ensure that the plane-wave reflection magnitude at the truncated boundary is below a prescribed tolerance across a target frequency band. The calibration must be performed under the modeling assumption that the worst-case attenuation requirement is governed by the slowest Rayleigh wave phase speed in the soft surface layer. The program must compute, for each specified test case, a tuple consisting of the maximum CPML conductivity $\\sigma_{\\max}$ in $\\mathrm{s^{-1}}$, the maximum CPML real stretch parameter $\\kappa_{\\max}$ (dimensionless), and the CPML auxiliary attenuation parameter $\\alpha$ in $\\mathrm{s^{-1}}$, such that the maximum reflection magnitude $R_{\\max}$ over the target frequency band satisfies $R_{\\max} \\leq 0.01$. The program must output a list of results, one for each test case, where each result is the list $[\\sigma_{\\max},\\kappa_{\\max},\\alpha,R_{\\max}]$.\n\nBase the derivation and algorithm on the following foundational laws and definitions:\n- The linear elastodynamic wave equation for small-amplitude motion in a homogeneous region, with solutions expressible as plane waves of angular frequency $\\omega$ and wavenumber $k=\\omega/c$ for a given phase speed $c$.\n- The complex-coordinate stretching concept for Perfectly Matched Layers (PML), where the spatial coordinate is mapped by $x \\mapsto \\tilde{x}=\\int_0^x s(\\xi,\\omega)\\,d\\xi$, with a complex-valued stretch $s(\\xi,\\omega)$.\n- The Rayleigh wave phase speed $c_R$ in a soft surface layer is the slowest pertinent surface wave speed, controlling the worst-case attenuation requirement in the absorbing boundary.\n\nYou must not use any shortcut formulas or pre-derived expressions directly in the problem statement. Instead, the solution must show how the required expressions for the reflection bound and the calibration procedure follow from the base principles above.\n\nAssumptions and modeling choices to be enforced in the solution and program:\n- Use time dependence $\\mathrm{e}^{-i\\omega t}$ for all harmonic fields.\n- Adopt a one-dimensional normal-incidence design proxy for the boundary performance of the CPML with polynomial grading across thickness $L$, which, when applied with $c=c_R$ (soft layer), provides a conservative bound for the reflection magnitude at the truncation.\n- Parameter grading across the CPML thickness $x\\in[0,L]$:\n  - $\\sigma(x)=\\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$ with $m\\in\\mathbb{N}$,\n  - $\\kappa(x)=1+(\\kappa_{\\max}-1)\\left(\\frac{x}{L}\\right)^m$,\n  - $\\alpha(x)\\equiv\\alpha$ (constant).\n- Frequencies are specified by $f\\in[f_{\\min},f_{\\max}]$ in Hertz; angular frequency is $\\omega=2\\pi f$ in radians per second.\n- The target reflection bound is $R(f)\\leq 0.01$ for all $f\\in[f_{\\min},f_{\\max}]$.\n- The design selection for $\\kappa_{\\max}$ and $\\alpha$ must be drawn from candidate sets to ensure numerical robustness for near-field and low-frequency content:\n  - $\\kappa_{\\max}\\in\\{1.0,1.5,2.0\\}$ (dimensionless),\n  - $\\alpha\\in\\{0.2\\,\\omega_{\\min},0.5\\,\\omega_{\\min},1.0\\,\\omega_{\\min}\\}$, where $\\omega_{\\min}=2\\pi f_{\\min}$.\n- For each candidate pair $(\\kappa_{\\max},\\alpha)$, determine the minimum $\\sigma_{\\max}$ in $\\mathrm{s^{-1}}$ that achieves the reflection requirement over the frequency band, and select the pair that yields the smallest such $\\sigma_{\\max}$. Report the corresponding $R_{\\max}$ achieved by the calibrated triple $(\\sigma_{\\max},\\kappa_{\\max},\\alpha)$ evaluated over a fine frequency grid spanning $[f_{\\min},f_{\\max}]$.\n\nScientific realism and units:\n- All distances must be in meters (m), times in seconds (s), and frequencies in Hertz (Hz). Return $\\sigma_{\\max}$ in $\\mathrm{s^{-1}}$, $\\alpha$ in $\\mathrm{s^{-1}}$, $\\kappa_{\\max}$ dimensionless, and $R_{\\max}$ as a dimensionless decimal number. Round the reported floating-point numbers to six decimal places in the final output.\n- Assume the lateral absorbing boundary is placed adjacent to the soft layer, so the Rayleigh wave speed of the soft layer $c_R$ controls the worst-case calibration.\n\nTest suite to be used by the program:\n- Case A (happy path): $L=40\\,\\mathrm{m}$, $m=3$, $c_R^{\\text{soft}}=180\\,\\mathrm{m/s}$, $c_R^{\\text{stiff}}=700\\,\\mathrm{m/s}$, $f_{\\min}=0.5\\,\\mathrm{Hz}$, $f_{\\max}=10\\,\\mathrm{Hz}$, target $R_{\\max}\\leq 0.01$.\n- Case B (thin CPML edge case): $L=20\\,\\mathrm{m}$, $m=2$, $c_R^{\\text{soft}}=180\\,\\mathrm{m/s}$, $c_R^{\\text{stiff}}=700\\,\\mathrm{m/s}$, $f_{\\min}=0.5\\,\\mathrm{Hz}$, $f_{\\max}=10\\,\\mathrm{Hz}$, target $R_{\\max}\\leq 0.01$.\n- Case C (very soft surface layer): $L=40\\,\\mathrm{m}$, $m=4$, $c_R^{\\text{soft}}=120\\,\\mathrm{m/s}$, $c_R^{\\text{stiff}}=700\\,\\mathrm{m/s}$, $f_{\\min}=0.5\\,\\mathrm{Hz}$, $f_{\\max}=10\\,\\mathrm{Hz}$, target $R_{\\max}\\leq 0.01$.\n\nAnswer specification and required final output format:\n- For each case, output the calibrated list $[\\sigma_{\\max},\\kappa_{\\max},\\alpha,R_{\\max}]$.\n- Aggregate the three case results into a single Python-style list literal and print exactly one line:\n  - Example format: [[s1,k1,a1,r1],[s2,k2,a2,r2],[s3,k3,a3,r3]]\n- All floating-point values must be rounded to six decimal places.",
            "solution": "The problem of calibrating Convolutional Perfectly Matched Layer (CPML) parameters is addressed by first deriving an analytical expression for the reflection coefficient at the boundary of the absorbing layer. This derivation is based on a one-dimensional normal-incidence proxy model, which provides a conservative estimate for performance by assuming the slowest relevant wave speed, the Rayleigh wave speed in the soft surface layer, $c_R^{\\text{soft}}$.\n\nThe design goal is to determine the CPML parameters—maximum conductivity $\\sigma_{\\max}$, maximum real stretch $\\kappa_{\\max}$, and auxiliary attenuation parameter $\\alpha$—such that the reflection magnitude $R$ remains below a target tolerance $R_{\\text{target}} = 0.01$ across a specified frequency band $[f_{\\min}, f_{\\max}]$.\n\nThe derivation and subsequent calibration algorithm proceed as follows:\n\n**1. Derivation of the 1D Normal-Incidence Reflection Coefficient**\n\nThe propagation of a time-harmonic wave with time dependence $e^{-i\\omega t}$ in a homogeneous, one-dimensional medium is governed by the Helmholtz equation:\n$$ \\frac{d^2 U}{dx^2} + k^2 U = 0 $$\nwhere $U(x)$ is the spatial part of the wavefield, $\\omega = 2\\pi f$ is the angular frequency, $c$ is the phase speed, and $k = \\omega/c$ is the wavenumber.\n\nThe CPML is modeled by introducing a complex coordinate stretching function, $s(x, \\omega)$, which modifies the spatial derivative. For a wave propagating along the $x$-axis, this is equivalent to modifying the wavenumber from $k$ to a complex, position-dependent effective wavenumber $k_{\\text{eff}}(x, \\omega) = k \\cdot s(x, \\omega)$. The function $s(x, \\omega)$ for the CPML formulation, consistent with the $e^{-i\\omega t}$ time convention, is:\n$$ s(x, \\omega) = \\kappa(x) + \\frac{\\sigma(x)}{\\alpha(x) - i\\omega} $$\nwhere $\\sigma(x)$, $\\kappa(x)$, and $\\alpha(x)$ are the spatially-varying CPML parameters.\n\nA plane wave propagating from the physical domain into the CPML region (from $x=0$ to $x=L$) accumulates phase and attenuation. The amplitude of the wave is modified by a factor of $e^{i \\int_0^x k_{\\text{eff}}(\\xi, \\omega) d\\xi}$. In our 1D proxy model, the boundary at $x=L$ is assumed to be perfectly reflecting. A wave entering at $x=0$, traveling to $x=L$, reflecting, and returning to $x=0$ completes a round trip. The amplitude of the returning wave, relative to the incident wave, defines the reflection coefficient $R(\\omega)$. The round-trip modification factor is $e^{2 i \\int_0^L k \\cdot s(\\xi, \\omega) d\\xi}$. The magnitude of this factor is the reflection coefficient:\n$$ R(\\omega) = \\left| e^{2 i k \\int_0^L s(\\xi, \\omega) d\\xi} \\right| = e^{\\text{Re}\\left(2 i k \\int_0^L s(\\xi, \\omega) d\\xi\\right)} = e^{-2 \\cdot \\text{Im}\\left(k \\int_0^L s(\\xi, \\omega) d\\xi\\right)} $$\nHere, we use the slowest wave speed for a conservative design, so $c = c_R^{\\text{soft}}$. The integral of the stretch function is:\n$$ \\int_0^L s(\\xi, \\omega) d\\xi = \\int_0^L \\left(\\kappa(\\xi) + \\frac{\\sigma(\\xi)}{\\alpha(\\xi) - i\\omega}\\right) d\\xi $$\nUsing the prescribed polynomial grading functions $\\sigma(x)=\\sigma_{\\max}(x/L)^m$, $\\kappa(x)=1+(\\kappa_{\\max}-1)(x/L)^m$, and the constant parameter $\\alpha(x)=\\alpha$:\n$$ \\int_0^L \\kappa(x) dx = \\int_0^L \\left[1 + (\\kappa_{\\max}-1)\\left(\\frac{x}{L}\\right)^m\\right] dx = \\left[x + (\\kappa_{\\max}-1)\\frac{x^{m+1}}{L^m(m+1)}\\right]_0^L = L\\left(1 + \\frac{\\kappa_{\\max}-1}{m+1}\\right) $$\n$$ \\int_0^L \\sigma(x) dx = \\int_0^L \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m dx = \\frac{\\sigma_{\\max}L}{m+1} $$\nSubstituting these results, the integrated stretch function becomes:\n$$ \\int_0^L s(\\xi, \\omega) d\\xi = L\\left(1 + \\frac{\\kappa_{\\max}-1}{m+1}\\right) + \\frac{\\sigma_{\\max}L}{(m+1)(\\alpha - i\\omega)} $$\nWe need the imaginary part of $k \\int_0^L s(\\xi, \\omega) d\\xi$:\n$$ \\text{Im}\\left(k \\int_0^L s(\\xi, \\omega) d\\xi\\right) = \\text{Im}\\left( \\frac{\\omega}{c} \\left[ L\\left(1 + \\frac{\\kappa_{\\max}-1}{m+1}\\right) + \\frac{\\sigma_{\\max}L}{(m+1)(\\alpha - i\\omega)} \\right] \\right) $$\nThe term involving $\\kappa_{\\max}$ is purely real. The imaginary part arises from the $\\sigma_{\\max}$ term:\n$$ \\text{Im}\\left( \\frac{\\omega}{c} \\frac{\\sigma_{\\max}L}{(m+1)(\\alpha - i\\omega)} \\right) = \\frac{\\omega}{c} \\frac{\\sigma_{\\max}L}{m+1} \\text{Im}\\left( \\frac{\\alpha+i\\omega}{\\alpha^2+\\omega^2} \\right) = \\frac{\\omega}{c} \\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\alpha^2+\\omega^2} = \\frac{\\sigma_{\\max}L\\omega^2}{c(m+1)(\\alpha^2+\\omega^2)} $$\nThus, the reflection coefficient is:\n$$ R(\\omega) = \\exp\\left(-2 \\frac{\\sigma_{\\max}L\\omega^2}{c(m+1)(\\alpha^2+\\omega^2)}\\right) $$\nThis expression forms the basis for the parameter calibration. Notably, $R(\\omega)$ in this 1D model is independent of $\\kappa_{\\max}$.\n\n**2. Calibration of CPML Parameters**\n\nThe calibration requires finding the minimum $\\sigma_{\\max}$ that ensures $R(\\omega) \\leq R_{\\text{target}}$ for all $\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]$, where $\\omega_{\\min}=2\\pi f_{\\min}$ and $\\omega_{\\max}=2\\pi f_{\\max}$.\n$$ \\exp\\left(-2 \\frac{\\sigma_{\\max}L\\omega^2}{c(m+1)(\\alpha^2+\\omega^2)}\\right) \\leq R_{\\text{target}} $$\nTaking the natural logarithm and rearranging for $\\sigma_{\\max}$:\n$$ -2 \\frac{\\sigma_{\\max}L\\omega^2}{c(m+1)(\\alpha^2+\\omega^2)} \\leq \\ln(R_{\\text{target}}) $$\n$$ \\sigma_{\\max} \\geq \\frac{-c(m+1)\\ln(R_{\\text{target}})}{2L} \\left(\\frac{\\alpha^2+\\omega^2}{\\omega^2}\\right) $$\nLet the function $g(\\omega) = (\\alpha^2+\\omega^2)/\\omega^2 = 1 + (\\alpha/\\omega)^2$. To satisfy the inequality for all $\\omega$ in the band, $\\sigma_{\\max}$ must be greater than or equal to the maximum value of the right-hand side. The function $g(\\omega)$ is monotonically decreasing for $\\omega > 0$. Therefore, its maximum value on the interval $[\\omega_{\\min}, \\omega_{\\max}]$ occurs at $\\omega = \\omega_{\\min}$.\nThe minimum required $\\sigma_{\\max}$ is thus:\n$$ \\sigma_{\\max}^{\\min} = \\frac{-c(m+1)\\ln(R_{\\text{target}})}{2L} \\left(1 + \\left(\\frac{\\alpha}{\\omega_{\\min}}\\right)^2\\right) $$\n\n**3. Parameter Selection and Final Algorithm**\n\nThe task is to select the pair $(\\kappa_{\\max}, \\alpha)$ from the candidate sets $\\kappa_{\\max} \\in \\{1.0, 1.5, 2.0\\}$ and $\\alpha \\in \\{0.2\\,\\omega_{\\min}, 0.5\\,\\omega_{\\min}, 1.0\\,\\omega_{\\min}\\}$ that yields the smallest $\\sigma_{\\max}^{\\min}$.\nFrom the derived formula, $\\sigma_{\\max}^{\\min}$ is independent of $\\kappa_{\\max}$. Its value depends only on $\\alpha$. The expression $\\left(1 + (\\alpha/\\omega_{\\min})^2\\right)$ is an increasing function of $\\alpha$. To minimize $\\sigma_{\\max}^{\\min}$, we must choose the smallest possible value of $\\alpha$ from the candidate set, which is $\\alpha_{\\text{opt}} = 0.2\\omega_{\\min}$.\nWith this choice of $\\alpha$, all three candidate values for $\\kappa_{\\max}$ yield the same minimum $\\sigma_{\\max}^{\\min}$. The problem statement becomes ambiguous in this scenario. A logical tie-breaking rule is to select the simplest model, which corresponds to the least modification of the coordinate system. This implies choosing the smallest candidate value, $\\kappa_{\\max}^{\\text{opt}} = 1.0$, as it corresponds to no stretching of the real part of the coordinate.\n\nThe final calibrated parameters are:\n- $\\kappa_{\\max} = 1.0$\n- $\\alpha = 0.2\\,\\omega_{\\min} = 0.2(2\\pi f_{\\min}) = 0.4\\pi f_{\\min}$\n- $\\sigma_{\\max} = \\frac{-c_R^{\\text{soft}}(m+1)\\ln(0.01)}{2L} (1 + 0.2^2) = 1.04 \\frac{-c_R^{\\text{soft}}(m+1)\\ln(0.01)}{2L}$\n\nFinally, we must report the maximum reflection magnitude $R_{\\max}$ achieved over the frequency band with these calibrated parameters. The reflection function $R(\\omega)$ is monotonically decreasing with $\\omega$ because the term $\\omega^2 / (\\alpha^2 + \\omega^2)$ is monotonically increasing. Thus, the maximum reflection occurs at the lowest frequency, $\\omega_{\\min}$. By substituting the expression for the calibrated $\\sigma_{\\max}$ back into the formula for $R(\\omega)$ at $\\omega = \\omega_{\\min}$, we find:\n$$ R_{\\max} = R(\\omega_{\\min}) = \\exp(\\ln(R_{\\text{target}})) = R_{\\text{target}} = 0.01 $$\nThis analytical result confirms that the calibration procedure correctly enforces the target at the worst-case frequency. The implementation will verify this by numerically searching over a fine grid.\n\nThe final algorithm for each test case is:\n1.  Set parameters $L, m, c=c_R^{\\text{soft}}, f_{\\min}, f_{\\max}$.\n2.  Set $R_{\\text{target}} = 0.01$.\n3.  Calculate $\\omega_{\\min} = 2\\pi f_{\\min}$.\n4.  Set optimal parameters $\\kappa_{\\max} = 1.0$ and $\\alpha = 0.2\\,\\omega_{\\min}$.\n5.  Calculate the calibrated $\\sigma_{\\max}$ using the derived formula.\n6.  Theoretically, $R_{\\max} = 0.01$. This will be confirmed numerically.\n7.  Store and format the results $[\\sigma_{\\max}, \\kappa_{\\max}, \\alpha, R_{\\max}]$ rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\n# from scipy import ... # Scipy is not required for this implementation.\n\ndef solve():\n    \"\"\"\n    Calibrates CPML parameters for three test cases and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, m, c_R_soft, f_min, f_max)\n    # Note: c_R_stiff is not used in the calculation per the problem statement.\n    test_cases = [\n        # Case A: Happy path\n        (40.0, 3, 180.0, 0.5, 10.0),\n        # Case B: Thin CPML edge case\n        (20.0, 2, 180.0, 0.5, 10.0),\n        # Case C: Very soft surface layer\n        (40.0, 4, 120.0, 0.5, 10.0),\n    ]\n\n    R_target = 0.01\n    ln_R_target = np.log(R_target)\n    \n    # Candidate parameter coefficients from the problem statement\n    # alpha = alpha_coeff * omega_min\n    alpha_coeffs = [0.2, 0.5, 1.0]\n    kappa_max_candidates = [1.0, 1.5, 2.0]\n\n    results = []\n    for case in test_cases:\n        L, m, c_R_soft, f_min, f_max = case\n        omega_min = 2.0 * np.pi * f_min\n\n        # As derived in the solution, sigma_max is minimized by the smallest alpha\n        # and is independent of kappa_max.\n        # We select the smallest alpha coefficient to minimize sigma_max.\n        best_alpha_coeff = min(alpha_coeffs)\n        # We select the smallest kappa_max as a tie-breaker (simplest model).\n        best_kappa_max = min(kappa_max_candidates)\n\n        alpha_opt = best_alpha_coeff * omega_min\n        \n        # Calculate the required sigma_max based on the derived formula:\n        # sigma_max = (-c*(m+1)*ln(R_target) / (2*L)) * (1 + (alpha/omega_min)^2)\n        # Since alpha = best_alpha_coeff * omega_min, (alpha/omega_min)^2 = best_alpha_coeff^2\n        sigma_max_cal = (-c_R_soft * (m + 1) * ln_R_target / (2.0 * L)) * (1.0 + best_alpha_coeff**2)\n\n        # Per the problem, verify the maximum reflection R_max over a fine frequency grid.\n        # The analytical derivation shows R_max occurs at f_min and equals R_target.\n        # This numerical check validates the derivation.\n        freq_grid = np.linspace(f_min, f_max, num=2000)\n        omega_grid = 2.0 * np.pi * freq_grid\n        \n        # R(omega) = exp(-2 * sigma_max * L * omega^2 / (c*(m+1)*(alpha^2 + omega^2)))\n        exponent_numerator = -2.0 * sigma_max_cal * L\n        exponent_denominator = c_R_soft * (m + 1)\n        \n        g_omega = omega_grid**2 / (alpha_opt**2 + omega_grid**2)\n        \n        R_values = np.exp((exponent_numerator / exponent_denominator) * g_omega)\n        \n        R_max_val = np.max(R_values)\n\n        results.append([\n            sigma_max_cal,\n            best_kappa_max,\n            alpha_opt,\n            R_max_val\n        ])\n    \n    # Format the final output string exactly as specified.\n    # Values are rounded to six decimal places.\n    formatted_results = []\n    for res in results:\n        s, k, a, r = res\n        # Ensure kappa is formatted as a float\n        k_float = float(k)\n        formatted_results.append(f\"[{s:.6f},{k_float:.6f},{a:.6f},{r:.6f}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}