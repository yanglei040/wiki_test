{
    "hands_on_practices": [
        {
            "introduction": "在进行井眼稳定性分析时，一个至关重要的初始步骤是准确描述井壁周围的应力状态。由于地层中的主应力方向通常与钻井轨迹不一致，我们需要进行坐标变换，将远场应力张量转换到与井眼对齐的局部坐标系中。本练习将通过推导旋转矩阵，帮助你掌握这一基本但关键的数学技能，为后续所有三维井眼稳定性分析奠定基础。",
            "id": "3571590",
            "problem": "一均质线弹性地层承受远场应力，其柯西应力张量在其主应力坐标系 $\\mathcal{P}=\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 中是对角的，其中 $\\mathbf{e}_{1}$ 与最大水平主应力方向一致，$\\mathbf{e}_{2}$ 与最小水平主应力方向一致，$\\mathbf{e}_{3}$ 与垂向主应力方向一致。一口斜井以与垂向的夹角为 $\\theta$ 的井斜角和方位角 $\\psi$ 钻进，方位角 $\\psi$ 在水平面内遵循右手定则从 $\\mathbf{e}_{1}$ 朝向 $\\mathbf{e}_{2}$ 测量。在井眼局部笛卡尔坐标系 $\\mathcal{B}=\\{\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3}\\}$ 中，$\\mathbf{b}_{3}$ 沿井眼轴线方向选取，$\\mathbf{b}_{1}$ 是高边方向，由 $\\mathbf{e}_{3}$ 在垂直于 $\\mathbf{b}_{3}$ 的平面上的投影给出，而 $\\mathbf{b}_{2}=\\mathbf{b}_{3}\\times \\mathbf{b}_{1}$ 构成一个右手坐标基。在由角度 $\\alpha$ 指定的周向位置上，井眼柱坐标系 $\\mathcal{C}=\\{\\mathbf{e}_{r},\\mathbf{e}_{\\theta},\\mathbf{e}_{z}\\}$ 定义为 $\\mathbf{e}_{r}=\\cos\\alpha\\,\\mathbf{b}_{1}+\\sin\\alpha\\,\\mathbf{b}_{2}$，$\\mathbf{e}_{\\theta}=-\\sin\\alpha\\,\\mathbf{b}_{1}+\\cos\\alpha\\,\\mathbf{b}_{2}$ 和 $\\mathbf{e}_{z}=\\mathbf{b}_{3}$。所有角度 $\\theta$、$\\psi$ 和 $\\alpha$ 均以弧度为单位。\n\n从标准正交基、方向余弦和张量变换法则的定义出发，推导将矢量和二阶张量分量从 $\\mathcal{P}$ 映射到 $\\mathcal{B}$ 以及从 $\\mathcal{B}$ 映射到 $\\mathcal{C}$ 的旋转矩阵。将它们组合以获得单个旋转矩阵 $\\mathbf{Q}_{\\mathcal{C}\\leftarrow \\mathcal{P}}(\\alpha,\\theta,\\psi)$，使得对于任意矢量 $\\mathbf{v}$，其分量满足 $\\left[\\mathbf{v}\\right]_{\\mathcal{C}}=\\mathbf{Q}_{\\mathcal{C}\\leftarrow \\mathcal{P}}\\left[\\mathbf{v}\\right]_{\\mathcal{P}}$；对于任意二阶张量 $\\boldsymbol{\\sigma}$，其分量满足 $\\left[\\boldsymbol{\\sigma}\\right]_{\\mathcal{C}}=\\mathbf{Q}_{\\mathcal{C}\\leftarrow \\mathcal{P}}\\left[\\boldsymbol{\\sigma}\\right]_{\\mathcal{P}}\\mathbf{Q}_{\\mathcal{C}\\leftarrow \\mathcal{P}}^{\\top}$。\n\n请以 $\\alpha$、$\\theta$ 和 $\\psi$ 表示的 $3\\times 3$ 矩阵 $\\mathbf{Q}_{\\mathcal{C}\\leftarrow \\mathcal{P}}(\\alpha,\\theta,\\psi)$ 的单个闭式解析表达式的形式给出最终答案。无需进行数值计算或取整。",
            "solution": "...",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\cos\\alpha\\cos\\theta\\cos\\psi + \\sin\\alpha\\sin\\psi   -\\cos\\alpha\\cos\\theta\\sin\\psi - \\sin\\alpha\\cos\\psi   \\cos\\alpha\\sin\\theta \\\\\n\\sin\\alpha\\cos\\theta\\cos\\psi + \\cos\\alpha\\sin\\psi   \\sin\\alpha\\cos\\theta\\sin\\psi - \\cos\\alpha\\cos\\psi   -\\sin\\alpha\\sin\\theta \\\\\n\\sin\\theta\\cos\\psi   \\sin\\theta\\sin\\psi   \\cos\\theta\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了井周应力之后，我们必须评估岩石是否能够承受这些应力。本练习通过对比理想化的弹性应力集中（Kirsch解）与更符合实际的弹塑性响应（采用Mohr-Coulomb准则），深入探讨了岩石的破坏行为。通过这个计算，你将理解当岩石屈服后发生的应力重分布现象，这是决定井壁破坏区范围的核心概念。",
            "id": "3571622",
            "problem": "在均质、各向同性、线弹性岩石中钻有一个半径为 $a$ 的竖直圆形钻孔。该岩石的力学行为符合弹性理想塑性，并采用莫尔-库仑（MC）破坏准则及相关流动法则。在垂直于钻孔轴线的平面上，采用小应变和轴对称平面应变条件，并以压应力为正。水平面内的地应力远场总应力是各向同性的，大小为 $S_{0} = 60\\,\\mathrm{MPa}$。地层孔隙压力为 $P_{p} = 10\\,\\mathrm{MPa}$，并且在稳态排水条件下，钻孔与地层水力连通，因此井壁处的孔隙压力等于泥浆压力 $P_{w} = 10\\,\\mathrm{MPa}$。取毕奥系数 $\\alpha = 1$。岩石的莫尔-库仑强度参数为黏聚力 $c = 8\\,\\mathrm{MPa}$，内摩擦角 $\\varphi = 30^{\\circ}$。杨氏模量为 $E = 20\\,\\mathrm{GPa}$，泊松比为 $\\nu = 0.25$。假设中间主有效应力为轴向应力，且其值保持在径向和环向有效应力之间，因此屈服由径向和环向有效应力分别作为最小和最大主有效应力来控制。\n\n使用基本原理，从圆柱坐标系下的平衡方程、有效应力定义以及莫尔-库仑屈服条件出发，计算：\n- 在井壁附近形成塑性区后，更新后的井壁环向有效应力（使用弹塑性解析解），以及\n- 在相同边界条件下，井壁处的纯弹性环向有效应力（Kirsch型解）。\n\n然后，求出更新后的弹塑性井壁环向有效应力与纯弹性井壁环向有效应力之比 $R$。将 $R$ 以十进制数形式报告，不带单位和百分号，并四舍五入至四位有效数字。",
            "solution": "在尝试求解之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n-   钻孔几何：竖直、圆形，半径为 $a$。\n-   岩体性质：均质、各向同性、线弹性理想塑性。\n-   分析条件：小应变、轴对称平面应变。压应力为正。\n-   破坏准则：莫尔-库仑（MC）及相关流动法则。\n-   强度参数：黏聚力 $c = 8\\,\\mathrm{MPa}$，内摩擦角 $\\varphi = 30^{\\circ}$。\n-   弹性参数：杨氏模量 $E = 20\\,\\mathrm{GPa}$，泊松比 $\\nu = 0.25$。\n-   远场应力：各向同性总应力 $S_{0} = 60\\,\\mathrm{MPa}$。\n-   孔隙压力：远场地层压力 $P_{p} = 10\\,\\mathrm{MPa}$。钻孔井壁压力（泥浆压力）$P_{w} = 10\\,\\mathrm{MPa}$。水力连通下的稳态排水条件。\n-   有效应力参数：毕奥系数 $\\alpha = 1$。\n-   主应力假设：中间主有效应力 $\\sigma'_z$ 满足 $\\sigma'_r \\le \\sigma'_z \\le \\sigma'_\\theta$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于连续介质力学、弹性力学、塑性力学和岩石力学的既定原理（Kirsch方程、有效应力原理、莫尔-库仑破坏准则）。所有概念均为岩土力学中的标准概念。\n-   **适定性**：该问题提供了足够的信息来确定唯一解。已知条件一致，边界条件明确。虽然提供了弹性模量（$E, \\nu$），但对于应力计算而言并非必需，这并不会使问题变得不适定。\n-   **客观性**：问题以精确、定量的术语陈述，没有歧义或主观性语言。\n-   **完整性与一致性**：数据是自洽且一致的。例如，稳态排水条件下 $P_w = P_p = 10\\,\\mathrm{MPa}$ 的条件意味着孔隙压力场是均匀的 $P(r) = 10\\,\\mathrm{MPa}$，这简化了分析。关于中间主应力的假设确保了问题可以在二维中进行分析。\n\n### 步骤3：结论与行动\n问题有效。它在科学上是合理的、适定的，并且为所要求的计算提供了所有必要的参数。将提供完整的解答。\n\n### 求解推导\n目标是计算比值 $R = \\sigma'_{\\theta\\theta, \\text{ep}} / \\sigma'_{\\theta\\theta, \\text{e}}$，其中 $\\sigma'_{\\theta\\theta, \\text{ep}}$ 是弹塑性材料在井壁处的环向有效应力，而 $\\sigma'_{\\theta\\theta, \\text{e}}$ 是假设纯弹性响应时在井壁处的环向有效应力。\n\n**1. 纯弹性环向有效应力（$\\sigma'_{\\theta\\theta, \\text{e}}$）的计算**\n\n对于在各向同性远场总应力 $S_0$ 和内压 $P_w$ 作用下的无限、各向同性、弹性介质中的圆形孔洞，圆柱坐标系 $(r, \\theta, z)$ 中的总应力由Kirsch方程给出。由于轴对称性（$S_H = S_h = S_0$），剪应力 $\\tau_{r\\theta}$ 为零，且应力与 $\\theta$ 无关。径向（$\\sigma_r$）和环向（$\\sigma_\\theta$）总应力为：\n$$ \\sigma_r(r) = S_0 \\left(1 - \\frac{a^2}{r^2}\\right) + P_w \\frac{a^2}{r^2} $$\n$$ \\sigma_\\theta(r) = S_0 \\left(1 + \\frac{a^2}{r^2}\\right) - P_w \\frac{a^2}{r^2} $$\n我们关心的是钻孔井壁处的应力，即 $r=a$ 处：\n$$ \\sigma_r(r=a) = S_0 (1-1) + P_w (1) = P_w $$\n$$ \\sigma_\\theta(r=a) = S_0 (1+1) - P_w (1) = 2S_0 - P_w $$\n代入给定的总应力值 $S_0 = 60\\,\\mathrm{MPa}$ 和 $P_w = 10\\,\\mathrm{MPa}$：\n$$ \\sigma_r(r=a) = 10\\,\\mathrm{MPa} $$\n$$ \\sigma_\\theta(r=a) = 2(60\\,\\mathrm{MPa}) - 10\\,\\mathrm{MPa} = 120\\,\\mathrm{MPa} - 10\\,\\mathrm{MPa} = 110\\,\\mathrm{MPa} $$\n有效应力 $\\sigma'$ 与总应力 $\\sigma$ 和孔隙压力 $P$ 的关系由Biot推广的太沙基原理给出：$\\sigma' = \\sigma - \\alpha P$。问题说明，由于稳态排水条件，井壁处的孔隙压力等于泥浆压力，即 $P(r=a) = P_w = 10\\,\\mathrm{MPa}$。当 $\\alpha=1$ 时，井壁处的有效应力为：\n$$ \\sigma'_{rr, \\text{e}}(r=a) = \\sigma_r(r=a) - \\alpha P(r=a) = 10\\,\\mathrm{MPa} - 1(10\\,\\mathrm{MPa}) = 0\\,\\mathrm{MPa} $$\n$$ \\sigma'_{\\theta\\theta, \\text{e}}(r=a) = \\sigma_\\theta(r=a) - \\alpha P(r=a) = 110\\,\\mathrm{MPa} - 1(10\\,\\mathrm{MPa}) = 100\\,\\mathrm{MPa} $$\n因此，井壁处的纯弹性环向有效应力为 $\\sigma'_{\\theta\\theta, \\text{e}} = 100\\,\\mathrm{MPa}$。\n\n**2. 弹塑性环向有效应力（$\\sigma'_{\\theta\\theta, \\text{ep}}$）的计算**\n\n首先，我们必须验证弹性应力状态是否导致岩石屈服。莫尔-库仑破坏准则用最大（$\\sigma'_1$）和最小（$\\sigma'_3$）主有效应力表示为：\n$$ \\sigma'_1 = \\sigma'_3 N_\\varphi + C_0 $$\n其中 $N_\\varphi = \\frac{1+\\sin\\varphi}{1-\\sin\\varphi}$ 且 $C_0 = \\frac{2c \\cos\\varphi}{1-\\sin\\varphi}$。\n根据问题给出的条件：$c = 8\\,\\mathrm{MPa}$ 和 $\\varphi = 30^{\\circ}$，所以 $\\sin\\varphi = 0.5$ 和 $\\cos\\varphi = \\frac{\\sqrt{3}}{2}$。\n$$ N_\\varphi = \\frac{1+0.5}{1-0.5} = \\frac{1.5}{0.5} = 3 $$\n$$ C_0 = \\frac{2(8\\,\\mathrm{MPa}) \\cos(30^{\\circ})}{1-\\sin(30^{\\circ})} = \\frac{16 \\left(\\frac{\\sqrt{3}}{2}\\right)}{1-0.5} = \\frac{8\\sqrt{3}}{0.5}\\,\\mathrm{MPa} = 16\\sqrt{3}\\,\\mathrm{MPa} $$\n问题假设 $\\sigma'_\\theta$ 是最大主应力（$\\sigma'_1$），$\\sigma'_r$ 是最小主应力（$\\sigma'_3$）。根据弹性计算，在井壁处，$\\sigma'_1 = \\sigma'_{\\theta\\theta, \\text{e}} = 100\\,\\mathrm{MPa}$ 且 $\\sigma'_3 = \\sigma'_{rr, \\text{e}} = 0\\,\\mathrm{MPa}$。\n我们来检查是否满足屈服条件：\n$$ \\sigma'_3 N_\\varphi + C_0 = (0)(3) + 16\\sqrt{3}\\,\\mathrm{MPa} \\approx 27.71\\,\\mathrm{MPa} $$\n由于 $\\sigma'_1 = 100\\,\\mathrm{MPa} > 16\\sqrt{3}\\,\\mathrm{MPa}$，井壁处的岩石已经屈服，并形成了一个塑性区。\n\n当材料屈服时，其应力状态必须位于破坏包络线上。因此，井壁处的实际环向有效应力 $\\sigma'_{\\theta\\theta, \\text{ep}}$ 不可能是弹性计算出的 $100\\,\\mathrm{MPa}$。相反，它是在井壁处已知径向应力条件下满足莫尔-库仑准则的应力。\n井壁处的径向有效应力由泥浆压力和孔隙压力的边界条件固定：\n$$ \\sigma'_3 = \\sigma'_{rr}(r=a) = P_w - \\alpha P_w = 10\\,\\mathrm{MPa} - 1(10\\,\\mathrm{MPa}) = 0\\,\\mathrm{MPa} $$\n于是，井壁处的环向有效应力 $\\sigma'_1 = \\sigma'_{\\theta\\theta, \\text{ep}}$ 由屈服准则确定：\n$$ \\sigma'_{\\theta\\theta, \\text{ep}} = \\sigma'_3 N_\\varphi + C_0 = (0)(3) + 16\\sqrt{3}\\,\\mathrm{MPa} $$\n$$ \\sigma'_{\\theta\\theta, \\text{ep}} = 16\\sqrt{3}\\,\\mathrm{MPa} $$\n这就是弹塑性解中井壁处更新后的环向有效应力。\n\n**3. 比值 $R$ 的计算**\n\n比值 $R$ 定义为更新后的弹塑性井壁环向有效应力与纯弹性井壁环向有效应力之比。\n$$ R = \\frac{\\sigma'_{\\theta\\theta, \\text{ep}}}{\\sigma'_{\\theta\\theta, \\text{e}}} $$\n代入计算出的值：\n$$ R = \\frac{16\\sqrt{3}\\,\\mathrm{MPa}}{100\\,\\mathrm{MPa}} = \\frac{16\\sqrt{3}}{100} $$\n现在，我们计算数值并四舍五入到四位有效数字：\n$$ R = \\frac{16 \\times 1.7320508...}{100} = \\frac{27.7128129...}{100} = 0.277128129... $$\n四舍五入到四位有效数字，得到：\n$$ R \\approx 0.2771 $$",
            "answer": "$$\\boxed{0.2771}$$"
        },
        {
            "introduction": "井眼稳定性不仅是一个静态问题，它还深受钻井作业动态过程的影响。本练习将水力学压力变化（激动与抽汲压力）与静态地质力学稳定性极限（破裂与坍塌压力）相结合。通过从第一性原理出发建立模型，你将学会如何确定安全起下钻作业的速度窗口，将理论知识应用于解决实际的工程挑战。",
            "id": "3571594",
            "problem": "您的任务是开发一个完整的、可运行的程序，用于计算安全的起下钻速度，以避免激动或抽吸引起的井壁失稳。您的程序必须将井筒水力学与稳定性极限耦合，并强制执行允许的瞬态压力波动。计算必须基于第一性原理和经过充分检验的公式，不得使用任何简化公式。\n\n基本和建模假设：\n- 不可压缩流体和刚性柱近似。根据质量守恒定律，环空中的体积流率等于钻杆的体积排量率：如果钻杆以速度 $v_{\\text{pipe}}$ 轴向移动（向下移动时为正），则环空流率为 $Q = s \\, v_{\\text{pipe}} \\, A_{\\text{pipe}}$，其中向下运动（激动）时 $s = +1$，向上运动（抽吸）时 $s = -1$，而 $A_{\\text{pipe}} = \\pi R_{\\mathrm{i}}^{2}$ 是半径为 $R_{\\mathrm{i}}$ 的钻柱的外部横截面积。\n- 静水力平衡：在真实垂直深度 $L$ 处的基线井底压力为 $p_{\\mathrm{h}} = \\rho g L$，其中 $\\rho$ 是钻井液密度， $g$ 是重力加速度。\n- 长度为 $L$ 的环空流体柱的非定常一维动量平衡，以向上方向为正，包括静水压力、惯性项和粘性项：\n  $$p_{\\mathrm{b}} - p_{\\mathrm{s}} = \\rho g L + \\rho L \\frac{d v_{\\mathrm{ann}}}{dt} + \\Delta p_{\\mathrm{fric}},$$\n  其中 $p_{\\mathrm{b}}$ 是井底压力，$p_{\\mathrm{s}}$ 是地面压力（取 $p_{\\mathrm{s}} = 0$ 表压），$v_{\\mathrm{ann}} = Q / A_{\\mathrm{ann}}$ 是平均环空速度，其中 $A_{\\mathrm{ann}} = \\pi \\left(R_{\\mathrm{o}}^{2} - R_{\\mathrm{i}}^{2}\\right)$，$R_{\\mathrm{o}}$ 是井筒半径。在加速到目标稳定速度的过程中，当钻杆加速度大小恒为 $a_{\\text{pipe}}$ 时，假定 $d v_{\\mathrm{ann}}/dt = s \\, a_{\\text{pipe}} \\, A_{\\text{pipe}} / A_{\\mathrm{ann}}$。\n- 根据经典润滑理论，稳态层流同心环空流动（牛顿流体）的粘性压力损失为：\n  $$Q = -\\frac{\\pi}{8 \\mu} \\left(\\frac{dp}{dz}\\right) S,$$\n  其中 $\\mu$ 是动力粘度，且\n  $$S = R_{\\mathrm{o}}^{4} - R_{\\mathrm{i}}^{4} - \\frac{\\left(R_{\\mathrm{o}}^{2} - R_{\\mathrm{i}}^{2}\\right)^{2}}{\\ln\\!\\left(R_{\\mathrm{o}}/R_{\\mathrm{i}}\\right)}.$$\n  在长度 $L$ 上，对井底-地面压降的粘性贡献为\n  $$\\Delta p_{\\mathrm{fric}} = \\frac{8 \\mu L}{\\pi S} Q.$$\n- 相对于静水压力的瞬态压力波动为\n  $$p_{\\mathrm{extra}} = \\rho L \\frac{d v_{\\mathrm{ann}}}{dt} + \\frac{8 \\mu L}{\\pi S} Q.$$\n  在恒定加速度加速到目标速度期间，最坏情况的幅值出现在加速阶段结束时（即加速度停止前），这可以通过使用 $Q = s \\, v_{\\text{pipe}} \\, A_{\\text{pipe}}$ 和 $\\frac{d v_{\\mathrm{ann}}}{dt} = s \\, a_{\\text{pipe}} \\, A_{\\text{pipe}}/A_{\\mathrm{ann}}$ 计算 $p_{\\mathrm{extra}}$ 并将两部分贡献相加来进行保守近似。\n\n稳定性极限和允许的瞬态波动：\n- 设深度的上稳定性极限（破裂萌生）为 $P_{\\mathrm{frac}}$，下稳定性极限（坍塌阈值或最小支撑压力）为 $P_{\\mathrm{low}}$。允许的瞬态波动由非负裕度 $M_{\\mathrm{surge}}$ 和 $M_{\\mathrm{swab}}$ 表示，要求\n  $$p_{\\mathrm{b}} \\le P_{\\mathrm{frac}} - M_{\\mathrm{surge}}, \\quad p_{\\mathrm{b}} \\ge P_{\\mathrm{low}} + M_{\\mathrm{swab}}.$$\n- 当 $p_{\\mathrm{b}} = p_{\\mathrm{h}} + p_{\\mathrm{extra}}$ 且 $p_{\\mathrm{h}} = \\rho g L$ 时，安全速度不等式变为：\n  - 向下运动（激动，$s=+1$）：确保 $p_{\\mathrm{h}} + p_{\\mathrm{extra}} \\le P_{\\mathrm{frac}} - M_{\\mathrm{surge}}$。\n  - 向上运动（抽吸，$s=-1$）：确保 $p_{\\mathrm{h}} + p_{\\mathrm{extra}} \\ge P_{\\mathrm{low}} + M_{\\mathrm{swab}}$。\n- 对于从恒定加速度到恒定速度的操作，使用目标速度和加速阶段加速度下的保守最坏情况 $p_{\\mathrm{extra}}$ 来强制执行这些条件。如果对于任何正速度都无法满足不等式，则安全速度为零。\n\n您的任务：\n- 实现一个程序，在上述建模框架下，为每个测试用例计算安全的向下起下钻速度 $v_{\\downarrow}$ 和安全的向上起下钻速度 $v_{\\uparrow}$（单位为 $\\mathrm{m/s}$），每个速度都四舍五入到四位小数。对每个用例使用以下步骤：\n  1. 计算 $A_{\\text{pipe}} = \\pi R_{\\mathrm{i}}^{2}$、$A_{\\mathrm{ann}} = \\pi \\left(R_{\\mathrm{o}}^{2} - R_{\\mathrm{i}}^{2}\\right)$ 和如上定义的 $S$。如果 $R_{\\mathrm{o}} \\le R_{\\mathrm{i}}$ 或 $S \\le 0$，则该用例的两个速度都设置为零。\n  2. 计算静水压力 $p_{\\mathrm{h}} = \\rho g L$。\n  3. 定义环空加速度标量 $a_{\\mathrm{ann}} = a_{\\text{pipe}} \\, A_{\\text{pipe}}/A_{\\mathrm{ann}}$ 和惯性压力增量 $\\Delta p_{\\mathrm{inert}} = \\rho L a_{\\mathrm{ann}}$（幅值）。\n  4. 定义层流摩擦系数 $c = \\dfrac{8 \\mu L A_{\\text{pipe}}}{\\pi S}$，使得速度为 $v$ 时的粘性部分幅值为 $c v$。\n  5. 定义激动压力窗口 $H_{\\mathrm{surge}} = (P_{\\mathrm{frac}} - M_{\\mathrm{surge}}) - p_{\\mathrm{h}}$ 和抽吸压力窗口 $H_{\\mathrm{swab}} = p_{\\mathrm{h}} - (P_{\\mathrm{low}} + M_{\\mathrm{swab}})$。\n  6. 保守的安全速度为\n     $$v_{\\downarrow} = \\max\\!\\left(0, \\frac{H_{\\mathrm{surge}} - \\Delta p_{\\mathrm{inert}}}{c}\\right), \\quad v_{\\uparrow} = \\max\\!\\left(0, \\frac{H_{\\mathrm{swab}} - \\Delta p_{\\mathrm{inert}}}{c}\\right).$$\n     如果任一压力窗口为负，则相应的安全速度为零。\n\n物理和数值单位：\n- 所有输入均采用国际单位制（SI）：长度单位为 $\\mathrm{m}$，压力单位为 $\\mathrm{Pa}$，密度单位为 $\\mathrm{kg/m^{3}}$，动力粘度单位为 $\\mathrm{Pa \\cdot s}$，加速度单位为 $\\mathrm{m/s^{2}}$，重力加速度单位为 $\\mathrm{m/s^{2}}$。\n- 输出速度必须以 $\\mathrm{m/s}$ 表示，并四舍五入到四位小数。\n\n角度单位不适用。\n\n测试套件：\n- 使用以下五组参数。对每一组，计算 $[v_{\\downarrow}, v_{\\uparrow}]$（单位 $\\mathrm{m/s}$）。\n  1. 情况 A（理想情况，中等窗口）：\n     - $L = 3000$, $R_{\\mathrm{o}} = 0.09$, $R_{\\mathrm{i}} = 0.06$, $\\rho = 1200$, $\\mu = 0.04$, $g = 9.81$, $P_{\\mathrm{frac}} = 36.9 \\times 10^{6}$, $P_{\\mathrm{low}} = 34.5 \\times 10^{6}$, $M_{\\mathrm{surge}} = 0.05 \\times 10^{6}$, $M_{\\mathrm{swab}} = 0.05 \\times 10^{6}$, $a_{\\text{pipe}} = 0.2$.\n  2. 情况 B（惯性极限导致向下速度为零）：\n     - $L = 3000$, $R_{\\mathrm{o}} = 0.09$, $R_{\\mathrm{i}} = 0.06$, $\\rho = 1200$, $\\mu = 0.04$, $g = 9.81$, $P_{\\mathrm{frac}} = 35.75 \\times 10^{6}$, $P_{\\mathrm{low}} = 34.0 \\times 10^{6}$, $M_{\\mathrm{surge}} = 0.10 \\times 10^{6}$, $M_{\\mathrm{swab}} = 0.05 \\times 10^{6}$, $a_{\\text{pipe}} = 0.4$.\n  3. 情况 C（宽环空，低粘度，惯性效应显著）：\n     - $L = 2500$, $R_{\\mathrm{o}} = 0.12$, $R_{\\mathrm{i}} = 0.04$, $\\rho = 1100$, $\\mu = 0.01$, $g = 9.81$, $P_{\\mathrm{frac}} = 27.4 \\times 10^{6}$, $P_{\\mathrm{low}} = 26.0 \\times 10^{6}$, $M_{\\mathrm{surge}} = 0.05 \\times 10^{6}$, $M_{\\mathrm{swab}} = 0.05 \\times 10^{6}$, $a_{\\text{pipe}} = 0.3$.\n  4. 情况 D（深井，高粘度，非常窄的环空）：\n     - $L = 5000$, $R_{\\mathrm{o}} = 0.095$, $R_{\\mathrm{i}} = 0.07$, $\\rho = 1300$, $\\mu = 0.06$, $g = 9.81$, $P_{\\mathrm{frac}} = 64.4 \\times 10^{6}$, $P_{\\mathrm{low}} = 63.0 \\times 10^{6}$, $M_{\\mathrm{surge}} = 0.10 \\times 10^{6}$, $M_{\\mathrm{swab}} = 0.05 \\times 10^{6}$, $a_{\\text{pipe}} = 0.15$.\n  5. 情况 E（无效几何边界：$R_{\\mathrm{o}} \\le R_{\\mathrm{i}}$）：\n     - $L = 3000$, $R_{\\mathrm{o}} = 0.05$, $R_{\\mathrm{i}} = 0.06$, $\\rho = 1200$, $\\mu = 0.04$, $g = 9.81$, $P_{\\mathrm{frac}} = 36.0 \\times 10^{6}$, $P_{\\mathrm{low}} = 34.0 \\times 10^{6}$, $M_{\\mathrm{surge}} = 0.05 \\times 10^{6}$, $M_{\\mathrm{swab}} = 0.05 \\times 10^{6}$, $a_{\\text{pipe}} = 0.2$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是测试用例的速度对 $[v_{\\downarrow}, v_{\\uparrow}]$，两个速度均以 $\\mathrm{m/s}$ 为单位，四舍五入到四位小数。例如，一个有效的输出格式是\n  $$[[0.1234,0.5678],[0.0000,0.4321],\\dots].$$",
            "solution": "目标是计算钻柱在井筒中的最大安全起下钻速度，包括向下（$v_{\\downarrow}$，激动）和向上（$v_{\\uparrow}$，抽吸）。该分析将简化的井筒水力学与地质力学稳定性极限相结合。解决方案根据问题陈述中列出的第一性原理推导得出。\n\n基本原理是环空流体的一维动量平衡，它将井底压力 $p_{\\mathrm{b}}$ 与静水压力、惯性分量和摩擦分量联系起来。井底压力由下式给出：\n$$p_{\\mathrm{b}} = p_{\\mathrm{h}} + p_{\\mathrm{extra}}$$\n其中 $p_{\\mathrm{h}} = \\rho g L$ 是密度为 $\\rho$、长度为 $L$ 的流体柱在重力加速度 $g$ 下的静水压力。$p_{\\mathrm{extra}}$ 项表示由钻杆运动引起的瞬态压力波动。\n\n瞬态压力波动 $p_{\\mathrm{extra}}$ 被建模为由于流体加速产生的惯性分量和由于流体流动产生的粘性摩擦分量之和：\n$$p_{\\mathrm{extra}} = \\rho L \\frac{d v_{\\mathrm{ann}}}{dt} + \\Delta p_{\\mathrm{fric}}$$\n此处，$\\frac{d v_{\\mathrm{ann}}}{dt}$ 是环空中流体的平均加速度，$\\Delta p_{\\mathrm{fric}}$ 是由粘性摩擦引起的压力损失。\n\n根据不可压缩流体和刚性钻柱的质量守恒原理，环空流率 $Q$ 与钻杆速度 $v_{\\text{pipe}}$ 的关系为 $Q = s \\, v_{\\text{pipe}} \\, A_{\\text{pipe}}$。符号函数 $s$ 在向下运动（激动）时为 $+1$，在向上运动（抽吸）时为 $-1$。$A_{\\text{pipe}} = \\pi R_{\\mathrm{i}}^2$ 是外径为 $R_{\\mathrm{i}}$ 的钻杆的横截面积。平均环空速度为 $v_{\\mathrm{ann}} = Q / A_{\\mathrm{ann}}$，其中 $A_{\\mathrm{ann}} = \\pi(R_{\\mathrm{o}}^2 - R_{\\mathrm{i}}^2)$ 是环空的横截面积，$R_{\\mathrm{o}}$ 是井筒半径。\n对于恒定的钻杆加速度 $a_{\\text{pipe}}$，流体加速度为 $\\frac{d v_{\\mathrm{ann}}}{dt} = s \\, a_{\\text{pipe}} \\, A_{\\text{pipe}} / A_{\\mathrm{ann}}$。\n\n惯性压力分量的幅值定义为 $\\Delta p_{\\mathrm{inert}} = |\\rho L \\frac{d v_{\\mathrm{ann}}}{dt}|$。我们定义一个恒定的环空加速度标量 $a_{\\mathrm{ann}} = a_{\\text{pipe}} \\frac{A_{\\text{pipe}}}{A_{\\mathrm{ann}}}$。因此，惯性压力项为：\n$$\\Delta p_{\\mathrm{inert}} = \\rho L a_{\\mathrm{ann}}$$\n此项对 $p_{\\mathrm{extra}}$ 的贡献符号取决于运动方向，激动时（$s=+1$）为 $+ \\Delta p_{\\mathrm{inert}}$，抽吸时（$s=-1$）为 $- \\Delta p_{\\mathrm{inert}}$。\n\n同心环空中稳态层流的摩擦压降由 $\\Delta p_{\\mathrm{fric}} = \\frac{8 \\mu L}{\\pi S} Q$ 给出，其中 $\\mu$ 是流体的动力粘度，$S$ 是一个几何因子：\n$$S = R_{\\mathrm{o}}^{4} - R_{\\mathrm{i}}^{4} - \\frac{\\left(R_{\\mathrm{o}}^{2} - R_{\\mathrm{i}}^{2}\\right)^{2}}{\\ln\\!\\left(R_{\\mathrm{o}}/R_{\\mathrm{i}}\\right)}$$\n这使我们能够将摩擦压力写成钻杆速度 $v_{\\text{pipe}}$ 的线性函数：$\\Delta p_{\\mathrm{fric}} = s \\, c \\, v_{\\text{pipe}}$，其中系数 $c$ 定义为：\n$$c = \\frac{8 \\mu L A_{\\text{pipe}}}{\\pi S}$$\n对于任何物理上有效的几何形状（$R_{\\mathrm{o}} > R_{\\mathrm{i}}$）和流体（$\\mu > 0$），该系数均为正值。\n\n综合这些项，在以加速度 $a_{\\text{pipe}}$ 加速后达到稳定速度 $v_{\\text{pipe}}$ 时的总压力波动可以保守地估计为：\n$$p_{\\mathrm{extra}} = s \\, (\\Delta p_{\\mathrm{inert}} + c \\, v_{\\text{pipe}})$$\n其中 $v_{\\text{pipe}}$ 是速度的幅值（$v_{\\downarrow}$ 或 $v_{\\uparrow}$）。\n\n如果井底压力 $p_{\\mathrm{b}}$ 保持在规定限值内，即 $P_{\\mathrm{low}} + M_{\\mathrm{swab}} \\le p_{\\mathrm{b}} \\le P_{\\mathrm{frac}} - M_{\\mathrm{surge}}$，则井壁保持稳定。$P_{\\mathrm{frac}}$ 和 $P_{\\mathrm{low}}$ 分别是破裂压力和坍塌压力，$M_{\\mathrm{surge}}$ 和 $M_{\\mathrm{swab}}$ 是安全裕度。\n\n对于向下运动（激动，$s=+1$，$v_{\\text{pipe}} = v_{\\downarrow}$），约束条件是：\n$$p_{\\mathrm{h}} + (\\Delta p_{\\mathrm{inert}} + c \\, v_{\\downarrow}) \\le P_{\\mathrm{frac}} - M_{\\mathrm{surge}}$$\n重新整理以求解最大安全速度 $v_{\\downarrow}$：\n$$c \\, v_{\\downarrow} \\le (P_{\\mathrm{frac}} - M_{\\mathrm{surge}} - p_{\\mathrm{h}}) - \\Delta p_{\\mathrm{inert}}$$\n设激动的可用压力裕度为“激动压力窗口”，即 $H_{\\mathrm{surge}} = (P_{\\mathrm{frac}} - M_{\\mathrm{surge}}) - p_{\\mathrm{h}}$。不等式变为：\n$$v_{\\downarrow} \\le \\frac{H_{\\mathrm{surge}} - \\Delta p_{\\mathrm{inert}}}{c}$$\n由于速度必须为非负，且负的或零的压力窗口/分子意味着没有安全的正速度，因此安全的向下速度为：\n$$v_{\\downarrow} = \\max\\!\\left(0, \\frac{H_{\\mathrm{surge}} - \\Delta p_{\\mathrm{inert}}}{c}\\right)$$\n\n对于向上运动（抽吸，$s=-1$，$v_{\\text{pipe}} = v_{\\uparrow}$），约束条件是：\n$$p_{\\mathrm{h}} - (\\Delta p_{\\mathrm{inert}} + c \\, v_{\\uparrow}) \\ge P_{\\mathrm{low}} + M_{\\mathrm{swab}}$$\n重新整理以求解最大安全速度 $v_{\\uparrow}$：\n$$c \\, v_{\\uparrow} \\le p_{\\mathrm{h}} - (P_{\\mathrm{low}} + M_{\\mathrm{swab}}) - \\Delta p_{\\mathrm{inert}}$$\n设抽吸的可用压力裕度为“抽吸压力窗口”，即 $H_{\\mathrm{swab}} = p_{\\mathrm{h}} - (P_{\\mathrm{low}} + M_{\\mathrm{swab}})$。不等式变为：\n$$v_{\\uparrow} \\le \\frac{H_{\\mathrm{swab}} - \\Delta p_{\\mathrm{inert}}}{c}$$\n类似地，安全的向上速度为：\n$$v_{\\uparrow} = \\max\\!\\left(0, \\frac{H_{\\mathrm{swab}} - \\Delta p_{\\mathrm{inert}}}{c}\\right)$$\n\n每个测试用例的算法如下：\n1.  计算几何参数 $A_{\\text{pipe}}$、$A_{\\text{ann}}$ 和 $S$。如果几何形状无效（$R_o \\le R_i$）或推导出的几何因子为非正值（$S \\le 0$），则两个速度均设为 $0$。\n2.  计算静水压力 $p_{\\mathrm{h}}$。\n3.  计算惯性压力幅值 $\\Delta p_{\\mathrm{inert}}$ 和摩擦系数 $c$。\n4.  计算激动和抽吸的压力窗口，$H_{\\mathrm{surge}}$ 和 $H_{\\mathrm{swab}}$。\n5.  应用最终公式计算 $v_{\\downarrow}$ 和 $v_{\\uparrow}$。\n\n对每个提供的参数集实施此程序。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes safe tripping speeds for a drillstring to avoid surge/swab instability.\n    \"\"\"\n\n    test_cases = [\n        # Case A (happy path, moderate window)\n        {'L': 3000, 'R_o': 0.09, 'R_i': 0.06, 'rho': 1200, 'mu': 0.04, 'g': 9.81, \n         'P_frac': 36.9e6, 'P_low': 34.5e6, 'M_surge': 0.05e6, 'M_swab': 0.05e6, 'a_pipe': 0.2},\n        # Case B (inertial limit triggers zero downward speed)\n        {'L': 3000, 'R_o': 0.09, 'R_i': 0.06, 'rho': 1200, 'mu': 0.04, 'g': 9.81, \n         'P_frac': 35.75e6, 'P_low': 34.0e6, 'M_surge': 0.10e6, 'M_swab': 0.05e6, 'a_pipe': 0.4},\n        # Case C (wide annulus, low viscosity, inertia noticeable)\n        {'L': 2500, 'R_o': 0.12, 'R_i': 0.04, 'rho': 1100, 'mu': 0.01, 'g': 9.81, \n         'P_frac': 27.4e6, 'P_low': 26.0e6, 'M_surge': 0.05e6, 'M_swab': 0.05e6, 'a_pipe': 0.3},\n        # Case D (deep, viscous, very thin annulus)\n        {'L': 5000, 'R_o': 0.095, 'R_i': 0.07, 'rho': 1300, 'mu': 0.06, 'g': 9.81, \n         'P_frac': 64.4e6, 'P_low': 63.0e6, 'M_surge': 0.10e6, 'M_swab': 0.05e6, 'a_pipe': 0.15},\n        # Case E (invalid geometry boundary: Ro = Ri)\n        {'L': 3000, 'R_o': 0.05, 'R_i': 0.06, 'rho': 1200, 'mu': 0.04, 'g': 9.81, \n         'P_frac': 36.0e6, 'P_low': 34.0e6, 'M_surge': 0.05e6, 'M_swab': 0.05e6, 'a_pipe': 0.2},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        L, R_o, R_i, rho, mu, g = case['L'], case['R_o'], case['R_i'], case['rho'], case['mu'], case['g']\n        P_frac, P_low = case['P_frac'], case['P_low']\n        M_surge, M_swab = case['M_surge'], case['M_swab']\n        a_pipe = case['a_pipe']\n\n        # Step 1: Compute geometric properties and validate\n        if R_o = R_i:\n            results.append([0.0, 0.0])\n            continue\n            \n        A_pipe = np.pi * R_i**2\n        A_ann = np.pi * (R_o**2 - R_i**2)\n        \n        try:\n            # S is the geometric factor for friction\n            S_geom = R_o**4 - R_i**4 - (R_o**2 - R_i**2)**2 / np.log(R_o / R_i)\n        except (ValueError, ZeroDivisionError):\n            S_geom = 0.0\n\n        if S_geom = 0:\n            results.append([0.0, 0.0])\n            continue\n\n        # Step 2: Compute hydrostatic pressure\n        p_h = rho * g * L\n\n        # Step 3: Compute inertial pressure increment\n        a_ann = a_pipe * A_pipe / A_ann\n        delta_p_inert = rho * L * a_ann\n\n        # Step 4: Compute laminar friction coefficient\n        c_fric = (8 * mu * L * A_pipe) / (np.pi * S_geom)\n\n        if c_fric = 0: # This should not happen with valid inputs but is a robust check\n           results.append([0.0, 0.0])\n           continue\n\n        # Step 5: Define surge and swab headrooms\n        H_surge = (P_frac - M_surge) - p_h\n        H_swab = p_h - (P_low + M_swab)\n\n        # Step 6: Compute conservative safe speeds\n        v_down_num = H_surge - delta_p_inert\n        v_down = max(0, v_down_num / c_fric)\n\n        v_up_num = H_swab - delta_p_inert\n        v_up = max(0, v_up_num / c_fric)\n\n        results.append([v_down, v_up])\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{res[0]:.4f},{res[1]:.4f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}