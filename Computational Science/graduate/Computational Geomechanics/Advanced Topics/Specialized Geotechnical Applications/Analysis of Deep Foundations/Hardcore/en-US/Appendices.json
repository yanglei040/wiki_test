{
    "hands_on_practices": [
        {
            "introduction": "Understanding the behavior of a single pile is the first step in analyzing deep foundations. This exercise establishes this fundamental skill by modeling pile settlement as a combination of two distinct effects: the elastic compression of the pile itself and the deformation of the soil beneath its tip . By deriving the solution from first principles, you will practice applying core concepts from both structural mechanics and elasticity theory to a canonical soil-structure interaction problem.",
            "id": "3499728",
            "problem": "A slender cylindrical pile is driven vertically into a homogeneous, isotropic, linear elastic soil that occupies a semi-infinite half-space. The pile is subjected to an axial compressive load, and side resistance along the shaft is neglected to isolate tip response effects. The pile is modeled as a one-dimensional elastic bar whose axial force does not vary along its length. The soil is modeled as a classical elastic half-space. The pile tip is planar and circular, and its contact with the soil is modeled as frictionless, consistent with a rigid circular punch on an elastic half-space.\n\nStarting from fundamental laws and core definitions in linear elasticity and solid mechanics, derive the governing relations needed to compute the pile head settlement under a given axial load. Use one-dimensional axial bar theory for the pile and elastic half-space theory for the tip-soil contact. Do not use any shortcut formulas or pre-derived expressions without justification from basic principles.\n\nYour task is to write a complete, runnable program that, given a set of parameters, computes the pile head settlement in meters. The bar elongation must be computed from first principles using Hooke's law and axial equilibrium. The tip compliance must be computed from the elastic half-space solution for a rigid circular punch. The total pile head settlement is the sum of the bar elongation and the tip compression. The following definitions and physical quantities must be used consistently:\n\n- Pile axial load $P$ in newtons.\n- Pile length $L$ in meters.\n- Pile cross-sectional area $A$ in square meters.\n- Pile Young's modulus $E_\\mathrm{p}$ in pascals.\n- Soil Young's modulus $E_\\mathrm{s}$ in pascals.\n- Soil Poisson's ratio $\\nu_\\mathrm{s}$ (dimensionless).\n- Pile tip radius $a$ in meters.\n- Soil shear modulus $G_\\mathrm{s}$ defined as $G_\\mathrm{s} = \\dfrac{E_\\mathrm{s}}{2\\left(1+\\nu_\\mathrm{s}\\right)}$.\n\nYour program must compute the following quantities for each test case:\n1. The axial bar elongation $\\,\\delta_\\mathrm{bar}\\,$ in meters.\n2. The tip compression $\\,\\delta_\\mathrm{tip}\\,$ in meters based on the elastic half-space response under the pile tip load.\n3. The total pile head settlement $\\,s\\,$ in meters, defined as $\\,s = \\delta_\\mathrm{bar} + \\delta_\\mathrm{tip}\\,$.\n\nExpress all settlements in meters as floating-point numbers.\n\nTest Suite:\nUse the following parameter sets, each tuple ordered as $\\left(P, L, A, E_\\mathrm{p}, a, E_\\mathrm{s}, \\nu_\\mathrm{s}\\right)$ with the units and definitions as specified above.\n\n- Case 1 (general): $\\left(2.0\\times10^6,\\; 12.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.40,\\; 1.0\\times10^8,\\; 0.30\\right)$.\n- Case 2 (stiff pile): $\\left(2.0\\times10^6,\\; 12.0,\\; 0.25,\\; 2.0\\times10^{11},\\; 0.40,\\; 1.0\\times10^8,\\; 0.30\\right)$.\n- Case 3 (large tip radius and stiffer soil): $\\left(3.0\\times10^6,\\; 20.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.75,\\; 1.5\\times10^8,\\; 0.35\\right)$.\n- Case 4 (near-incompressible soil): $\\left(2.0\\times10^6,\\; 12.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.40,\\; 1.0\\times10^9,\\; 0.49\\right)$.\n- Case 5 (long pile): $\\left(2.0\\times10^6,\\; 80.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.40,\\; 1.0\\times10^8,\\; 0.30\\right)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the total pile head settlements for the above test cases, in meters, as a comma-separated list enclosed in square brackets. For example: \"[$s_1,s_2,s_3,s_4,s_5$]\". Every settlement must be expressed in meters. No additional text should be printed.",
            "solution": "The problem requires the calculation of the total settlement, $s$, of a vertically loaded pile. The total settlement is the sum of two distinct physical phenomena: the elastic compression of the pile itself, $\\delta_{\\mathrm{bar}}$, and the settlement of the soil mass beneath the pile tip, $\\delta_{\\mathrm{tip}}$. The problem specifies a simplified model where shaft friction along the pile is neglected, which implies that the entire axial load, $P$, applied at the pile head is transferred to the pile tip. The system is thus decomposed into two sub-problems that can be analyzed independently using fundamental principles of solid mechanics. The total settlement is expressed as:\n$$ s = \\delta_{\\mathrm{bar}} + \\delta_{\\mathrm{tip}} $$\n\nFirst, we derive the expression for the pile's elastic compression, $\\delta_{\\mathrm{bar}}$.\nThe pile is modeled as a one-dimensional elastic bar of length $L$, constant cross-sectional area $A$, and Young's modulus $E_{\\mathrm{p}}$. According to the problem statement and the principles of static equilibrium, the axial force is constant along the pile's length. This is a direct consequence of neglecting side resistance. Therefore, the internal axial force at any cross-section is equal to the applied load, $P$.\n\nThe axial stress, $\\sigma$, is defined as the force per unit area. Since the internal force is uniform, the stress is also uniform along the pile:\n$$ \\sigma = \\frac{P}{A} $$\nThe axial strain, $\\epsilon$, is defined as the deformation per unit length. For a linear elastic material under uniaxial loading, Hooke's Law states that stress is directly proportional to strain:\n$$ \\sigma = E_{\\mathrm{p}} \\epsilon $$\nwhere $E_{\\mathrm{p}}$ is the Young's modulus of the pile material. By combining these two fundamental equations, we solve for the strain in the pile:\n$$ \\epsilon = \\frac{\\sigma}{E_{\\mathrm{p}}} = \\frac{P}{A E_{\\mathrm{p}}} $$\nStrain represents the local rate of change of displacement along the pile axis. The total compression of the pile, $\\delta_{\\mathrm{bar}}$, is found by integrating the strain over the entire length, $L$, of the pile:\n$$ \\delta_{\\mathrm{bar}} = \\int_{0}^{L} \\epsilon \\, dz $$\nSince the material is homogeneous and the cross-section and force are constant, the strain $\\epsilon$ is also constant. The integral thus simplifies to:\n$$ \\delta_{\\mathrm{bar}} = \\epsilon L $$\nSubstituting the expression for $\\epsilon$, we obtain the final formula for the pile's compression:\n$$ \\delta_{\\mathrm{bar}} = \\frac{P L}{A E_{\\mathrm{p}}} $$\n\nNext, we derive the expression for the settlement of the soil at the pile tip, $\\delta_{\\mathrm{tip}}$.\nThe problem states that the soil is a homogeneous, isotropic, linear elastic half-space. The pile tip is modeled as a rigid, planar, circular punch of radius $a$ that imposes a load $P$ onto the soil surface. The contact is considered frictionless. The settlement of a rigid circular punch on an elastic half-space is a canonical solution in the theory of elasticity, derived from the Boussinesq solution for a point load. While a full derivation from the governing differential equations of elasticity (Navier-Cauchy equations) is extensive, the established result is a fundamental principle for this specific boundary-value problem. The uniform vertical displacement (settlement) under the punch, $\\delta_{\\mathrm{tip}}$, is given by the well-established formula:\n$$ \\delta_{\\mathrm{tip}} = \\frac{P (1 - \\nu_{\\mathrm{s}}^2)}{2 a E_{\\mathrm{s}}} $$\nwhere $P$ is the total load transmitted by the tip, $a$ is the radius of the circular tip, and $E_{\\mathrm{s}}$ and $\\nu_{\\mathrm{s}}$ are the Young's modulus and Poisson's ratio of the elastic half-space (the soil), respectively. The problem also provides a definition for the soil shear modulus, $G_{\\mathrm{s}} = \\dfrac{E_{\\mathrm{s}}}{2\\left(1+\\nu_{\\mathrm{s}}\\right)}$, which allows for an alternative expression. By substituting $E_{\\mathrm{s}} = 2 G_{\\mathrm{s}} (1+\\nu_{\\mathrm{s}})$ into the settlement formula, we can verify its equivalence:\n$$ \\delta_{\\mathrm{tip}} = \\frac{P (1 - \\nu_{\\mathrm{s}})(1 + \\nu_{\\mathrm{s}})}{2 a \\cdot 2G_{\\mathrm{s}}(1+\\nu_{\\mathrm{s}})} = \\frac{P(1-\\nu_{\\mathrm{s}})}{4 a G_{\\mathrm{s}}} $$\nFor computation, the formula using $E_{\\mathrm{s}}$ and $\\nu_{\\mathrm{s}}$ is more direct as these are the parameters provided in the test suite.\n\nFinally, the total pile head settlement, $s$, is the linear superposition of the pile's structural compression and the soil's deformation at the tip:\n$$ s = \\delta_{\\mathrm{bar}} + \\delta_{\\mathrm{tip}} = \\frac{P L}{A E_{\\mathrm{p}}} + \\frac{P (1 - \\nu_{\\mathrm{s}}^2)}{2 a E_{\\mathrm{s}}} $$\nThis equation synthesizes the two parts of the model and will be implemented to compute the total settlement for each of the given test cases. All parameters are provided in consistent SI units, ensuring the resulting settlement $s$ is in meters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total settlement of an axially loaded pile based on a composite model.\n\n    The total settlement is the sum of the pile's elastic compression and the tip \n    settlement on an elastic half-space.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is ordered as (P, L, A, E_p, a, E_s, nu_s) with SI units.\n    # P: Pile axial load (N)\n    # L: Pile length (m)\n    # A: Pile cross-sectional area (m^2)\n    # E_p: Pile Young's modulus (Pa)\n    # a: Pile tip radius (m)\n    # E_s: Soil Young's modulus (Pa)\n    # nu_s: Soil Poisson's ratio (dimensionless)\n    test_cases = [\n        (2.0e6, 12.0, 0.25, 3.0e10, 0.40, 1.0e8, 0.30),\n        (2.0e6, 12.0, 0.25, 2.0e11, 0.40, 1.0e8, 0.30),\n        (3.0e6, 20.0, 0.25, 3.0e10, 0.75, 1.5e8, 0.35),\n        (2.0e6, 12.0, 0.25, 3.0e10, 0.40, 1.0e9, 0.49),\n        (2.0e6, 80.0, 0.25, 3.0e10, 0.40, 1.0e8, 0.30)\n    ]\n\n    results = []\n    for case in test_cases:\n        P, L, A, E_p, a, E_s, nu_s = case\n        \n        # 1. Compute axial bar elongation (compression)\n        # Formula: delta_bar = (P * L) / (A * E_p)\n        delta_bar = (P * L) / (A * E_p)\n        \n        # 2. Compute tip compression (settlement)\n        # Formula: delta_tip = (P * (1 - nu_s^2)) / (2 * a * E_s)\n        delta_tip = (P * (1 - nu_s**2)) / (2 * a * E_s)\n        \n        # 3. Compute total pile head settlement\n        # Formula: s = delta_bar + delta_tip\n        total_settlement = delta_bar + delta_tip\n        \n        results.append(total_settlement)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of floating-point numbers in a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Piles are rarely used in isolation; they are typically installed in groups. This practice extends the analysis from a single pile to a group, introducing the critical concept of interaction effects, where the presence of neighboring piles alters the soil response . Using the established $p$-multiplier method within a Winkler foundation model, you will learn how to quantify the 'shadowing' effect on the lateral resistance of piles in a group.",
            "id": "3499759",
            "problem": "A square $3 \\times 3$ group of identical vertical piles with center-to-center spacing of $3D$ is installed in a normally consolidated, laterally uniform clay deposit. The pile cap is at the ground surface and is perfectly rigid in lateral translation in the loading direction such that all pile heads have the same lateral displacement. Consider small-strain behavior, and neglect axial-flexure coupling and any inertial effects. Model the soil–pile interaction using the Winkler idealization, in which the distributed soil reaction per unit length, $p(z)$, at depth $z$ is related to the local lateral pile deflection, $y(z)$, by $p(z) = k(z)\\,y(z)$, where $k(z)$ is the initial tangent subgrade modulus. For this site, assume a linear variation with depth $k(z) = n_h\\,z$, where $n_h$ is a constant.\n\nA horizontal resultant load $H$ is applied to the pile cap, aligned so that it acts in the direction normal to one set of pile rows (that is, perpendicular to the rows so that the front row is loaded first). Pile–pile shadowing is represented using the $p$-multiplier concept: each pile’s local soil reaction is reduced by a factor $m \\in (0,1]$ that depends on the row position with respect to the loading direction. Specifically, all three piles in the front row have $m = 0.80$, all three piles in the middle row have $m = 0.60$, and all three piles in the back row have $m = 0.50$. Assume the piles are sufficiently stiff relative to the soil such that the lateral pile deflection is approximately uniform with depth, i.e., $y(z) \\equiv y_0$, where $y_0$ is the cap (and pile head) lateral translation.\n\nUsing only equilibrium, compatibility, and the Winkler foundation relation defined above, derive an expression for $y_0$ in terms of $H$, $n_h$, the pile embedded length $L$, and the row $p$-multipliers. Then, evaluate $y_0$ for the following parameters: $H = 4.0 \\times 10^3$ kN, $L = 12$ m, $n_h = 5.0 \\times 10^3$ kN/m$^4$. Round your answer to three significant figures and express the final displacement in millimeters.",
            "solution": "The core principle for solving this problem is static equilibrium. The total applied horizontal load, $H$, on the rigid pile cap must be resisted by the sum of the horizontal forces exerted by the soil on each of the $9$ piles in the group. Let $P_{i,j}$ be the total horizontal force resisted by the pile in row $i$ and column $j$. The equilibrium equation is:\n$$ H = \\sum_{i=1}^{3} \\sum_{j=1}^{3} P_{i,j} $$\nThe problem states that all piles are identical and that the $p$-multiplier, $m$, depends only on the row position. Let $m_i$ be the multiplier for row $i$. All three piles in a given row $i$ will therefore resist the same total horizontal force, which we can denote as $P_i$. The equilibrium equation simplifies to:\n$$ H = 3 P_1 + 3 P_2 + 3 P_3 = 3(P_1 + P_2 + P_3) $$\nwhere $P_1$, $P_2$, and $P_3$ are the total horizontal forces on a single pile in the front, middle, and back rows, respectively.\n\nThe total horizontal force $P_i$ on a single pile in row $i$ is the integral of the distributed soil reaction per unit length, $p_i(z)$, over the embedded pile length $L$:\n$$ P_i = \\int_0^L p_i(z) \\, dz $$\nThe problem defines the soil reaction using the Winkler idealization, modified by the $p$-multiplier $m_i$ for group interaction effects:\n$$ p_i(z) = m_i \\, k(z) \\, y(z) $$\nWe are given a subgrade modulus that varies linearly with depth, $z$:\n$$ k(z) = n_h z $$\nFurthermore, we are given a critical simplifying assumption that the piles are very stiff, such that their lateral deflection is uniform with depth and equal to the pile cap displacement, $y_0$:\n$$ y(z) \\equiv y_0 $$\nSubstituting these expressions into the formula for the soil reaction $p_i(z)$:\n$$ p_i(z) = m_i (n_h z) y_0 $$\nNow, we can compute the total force $P_i$ on a single pile in row $i$ by integrating this reaction over the pile length $L$:\n$$ P_i = \\int_0^L (m_i n_h y_0 z) \\, dz $$\nSince $m_i$, $n_h$, and $y_0$ are constants with respect to the integration variable $z$, they can be factored out of the integral:\n$$ P_i = m_i n_h y_0 \\int_0^L z \\, dz $$\nThe integral is elementary:\n$$ \\int_0^L z \\, dz = \\left[ \\frac{z^2}{2} \\right]_0^L = \\frac{L^2}{2} - 0 = \\frac{L^2}{2} $$\nSubstituting this result back gives the expression for the force on a single pile in row $i$:\n$$ P_i = m_i n_h y_0 \\frac{L^2}{2} $$\nNow, we substitute this expression for $P_1$, $P_2$, and $P_3$ into the main equilibrium equation:\n$$ H = 3 \\left( m_1 n_h y_0 \\frac{L^2}{2} + m_2 n_h y_0 \\frac{L^2}{2} + m_3 n_h y_0 \\frac{L^2}{2} \\right) $$\nFactor out the common terms $n_h$, $y_0$, and $\\frac{L^2}{2}$:\n$$ H = 3 n_h y_0 \\frac{L^2}{2} (m_1 + m_2 + m_3) $$\nThe first part of the task is to derive an expression for $y_0$. We can rearrange the above equation:\n$$ y_0 = \\frac{H}{3 n_h \\frac{L^2}{2} (m_1 + m_2 + m_3)} $$\n$$ y_0 = \\frac{2 H}{3 n_h L^2 (m_1 + m_2 + m_3)} $$\nThis is the symbolic expression for the lateral displacement $y_0$.\n\nThe second part of the task is to evaluate this expression for the given parameters:\n- Total horizontal load: $H = 4.0 \\times 10^3$ kN\n- Pile embedded length: $L = 12$ m\n- Subgrade modulus constant: $n_h = 5.0 \\times 10^3$ kN/m$^4$\n- $p$-multipliers: $m_1 = 0.80$ (front row), $m_2 = 0.60$ (middle row), $m_3 = 0.50$ (back row).\n\nFirst, calculate the sum of the $p$-multipliers:\n$$ \\sum m_i = m_1 + m_2 + m_3 = 0.80 + 0.60 + 0.50 = 1.90 $$\nNext, substitute all numerical values into the derived expression for $y_0$. The units are consistent (kN for force, m for length), so the resulting displacement will be in meters.\n$$ y_0 = \\frac{2 (4.0 \\times 10^3)}{3 (5.0 \\times 10^3) (12)^2 (1.90)} $$\n$$ y_0 = \\frac{8.0 \\times 10^3}{3 (5.0 \\times 10^3) (144) (1.90)} $$\n$$ y_0 = \\frac{8.0 \\times 10^3}{(15.0 \\times 10^3) (144) (1.90)} $$\n$$ y_0 = \\frac{8.0 \\times 10^3}{(2160 \\times 10^3) (1.90)} $$\n$$ y_0 = \\frac{8.0 \\times 10^3}{4104 \\times 10^3} \\, \\text{m} $$\n$$ y_0 = \\frac{8.0}{4104} \\, \\text{m} \\approx 0.0019493177 \\, \\text{m} $$\nThe problem requires the final answer to be expressed in millimeters and rounded to three significant figures.\n$$ y_0 \\approx 0.0019493177 \\, \\text{m} \\times \\frac{1000 \\, \\text{mm}}{1 \\, \\text{m}} \\approx 1.9493177 \\, \\text{mm} $$\nRounding to three significant figures gives $1.95$ mm.",
            "answer": "$$\\boxed{1.95}$$"
        },
        {
            "introduction": "Modern foundation engineering often involves hybrid systems that combine different foundation types to optimize performance. This exercise tackles the analysis of a piled raft, a system where a shallow raft and deep piles work together to support a structure . You will learn to build a system-level model by assembling the stiffness contributions from the raft-soil contact and the pile group, allowing you to determine the overall settlement and the distribution of load between the components.",
            "id": "3499751",
            "problem": "A rigid piled raft foundation is idealized as a single vertical degree-of-freedom system in which a rigid raft is connected in parallel to a set of vertical pile-head springs embedded in an elastic ground. The ground beneath the raft surface is represented by a continuous, linearly elastic reaction characterized by a distributed subgrade modulus. The pile group is represented by a symmetric interaction stiffness matrix that captures both the axial head stiffness of individual piles and the elastic interaction among pile heads through the surrounding soil. Assume small strains, linear elasticity, and quasi-static conditions. The raft is sufficiently stiff in bending that its vertical displacement is spatially uniform.\n\nStarting from the following fundamental bases: (i) linear momentum balance (static equilibrium) stating that the sum of reactions equals the applied load, (ii) kinematic compatibility for the rigid raft that all pile heads and the raft undergo the same vertical displacement, and (iii) linear elastic constitutive relations for springs, derive a computational procedure that determines the uniform settlement and the load distribution between the raft-soil contact and the pile group.\n\nModeling definitions to be used:\n- The raft-soil contact is modeled as a distributed linear spring with subgrade modulus per unit area $k_s$ in $\\mathrm{MN/m^3}$. For a raft plan area $A$ in $\\mathrm{m^2}$, the equivalent raft-soil vertical stiffness is $K_r = k_s \\times 10^6 \\times A$ in $\\mathrm{N/m}$.\n- The pile group of $n$ piles is modeled by a symmetric interaction stiffness matrix $K_p \\in \\mathbb{R}^{n \\times n}$ given in $\\mathrm{GN/m}$; convert each entry to $\\mathrm{N/m}$ by multiplying by $10^9$. The diagonal entries represent the isolated pile-head axial stiffnesses, and the off-diagonal entries represent pairwise interaction terms.\n- The total applied vertical load is $Q$ in $\\mathrm{kN}$; convert to $\\mathrm{N}$ by multiplying by $10^3$.\n- Each pile $i$ has an allowable capacity $C_i$ in $\\mathrm{kN}$.\n\nYour program must:\n- Use only equilibrium and compatibility to obtain expressions for the uniform settlement $u$ in $\\mathrm{m}$, the raft reaction $Q_r$ in $\\mathrm{N}$, and the pile load vector $\\mathbf{q}$ in $\\mathrm{N}$.\n- Convert and report the following for each test case: the settlement in $\\mathrm{mm}$ rounded to three decimal places, the raft load share in $\\mathrm{kN}$ rounded to two decimal places, the list of pile loads in $\\mathrm{kN}$ rounded to two decimal places, and a boolean indicating whether all piles satisfy $q_i \\le C_i$ (use the same unit for both, $\\mathrm{kN}$). If there are no piles, treat the pile loads list as empty and the boolean as true.\n- Ensure internal unit consistency using the specified conversions.\n\nAngle units do not apply. Express all requested physical quantities in the specified units.\n\nTest suite (each case is independent). For each case, the inputs are provided as $(Q,\\;A,\\;k_s,\\;K_p,\\;\\{C_i\\})$ with the units specified above:\n- Case $1$ (happy path, moderate interaction, four piles):\n  - $Q = 60000$\n  - $A = 400$\n  - $k_s = 30$\n  - $K_p$ (in $\\mathrm{GN/m}$):\n    - $4 \\times 4$ matrix with diagonal entries $0.8$ and off-diagonal entries $0.16$\n  - Capacities $\\{C_i\\}$ (in $\\mathrm{kN}$): $\\{6000, 6000, 6000, 6000\\}$\n- Case $2$ (boundary case, no piles):\n  - $Q = 20000$\n  - $A = 300$\n  - $k_s = 15$\n  - $K_p$: empty (no piles)\n  - Capacities: empty\n- Case $3$ (heterogeneous group and strong pile share):\n  - $Q = 50000$\n  - $A = 200$\n  - $k_s = 5$\n  - $K_p$ (in $\\mathrm{GN/m}$):\n    - $\n      \\begin{bmatrix}\n      1.5 & 0.25 & 0.15 \\\\\n      0.25 & 1.2 & 0.20 \\\\\n      0.15 & 0.20 & 0.9\n      \\end{bmatrix}\n      $\n  - Capacities $\\{C_i\\}$ (in $\\mathrm{kN}$): $\\{17000, 14000, 9500\\}$\n- Case $4$ (high interaction, two piles):\n  - $Q = 10000$\n  - $A = 250$\n  - $k_s = 10$\n  - $K_p$ (in $\\mathrm{GN/m}$):\n    - $\n      \\begin{bmatrix}\n      0.6 & 0.54 \\\\\n      0.54 & 0.6\n      \\end{bmatrix}\n      $\n  - Capacities $\\{C_i\\}$ (in $\\mathrm{kN}$): $\\{2500, 2500\\}$\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[u_{\\mathrm{mm}},\\;Q_{r,\\mathrm{kN}},\\;[q_{1,\\mathrm{kN}},\\dots,q_{n,\\mathrm{kN}}],\\;\\text{safe}]$, where $u_{\\mathrm{mm}}$ is the settlement in $\\mathrm{mm}$, $Q_{r,\\mathrm{kN}}$ is the raft load in $\\mathrm{kN}$, the inner list contains the pile loads in $\\mathrm{kN}$, and $\\text{safe}$ is the boolean safety indicator. For example, the overall output must look like $[[\\cdot,\\cdot,[\\cdot],\\cdot],[\\cdot,\\cdot,[\\cdot],\\cdot],\\dots]$ with no additional text.",
            "solution": "The derivation is based on three fundamental principles as specified: (i) static equilibrium, (ii) kinematic compatibility, and (iii) linear elastic constitutive relations. All quantities are expressed in base SI units (Newtons, meters) during the derivation.\n\nLet $u$ be the uniform vertical settlement of the rigid raft in meters [$\\mathrm{m}$].\nLet $Q$ be the total applied vertical load in Newtons [$\\mathrm{N}$].\nLet $A$ be the raft plan area in square meters [$\\mathrm{m}^2$].\nLet $k_s$ be the subgrade modulus in Pascals per meter [$\\mathrm{N/m^3}$].\nLet $K_r$ be the equivalent vertical stiffness of the raft-soil contact in Newtons per meter [$\\mathrm{N/m}$].\nLet $n$ be the number of piles. For $n>0$, let $K_p \\in \\mathbb{R}^{n \\times n}$ be the pile group interaction stiffness matrix in Newtons per meter [$\\mathrm{N/m}$].\n\nThe problem is to find the settlement $u$, the load carried by the raft-soil contact $Q_r$, and the load vector for the piles $\\mathbf{q} = [q_1, q_2, \\dots, q_n]^T$.\n\n**1. Kinematic Compatibility**\nThe problem states that the raft is rigid and undergoes a uniform vertical displacement $u$. Since the piles are connected to the raft, all pile heads must experience the same settlement. Let $\\mathbf{u}_p$ be the vector of pile-head displacements.\nThen,\n$$ \\mathbf{u}_p = \\begin{bmatrix} u \\\\ u \\\\ \\vdots \\\\ u \\end{bmatrix} = u \\cdot \\mathbf{1} $$\nwhere $\\mathbf{1}$ is a column vector of size $n$ with all entries equal to $1$.\n\n**2. Constitutive Relations**\nThe system components are modeled as linear elastic springs.\n- **Raft-Soil Contact**: The reactive force from the soil beneath the raft, $Q_r$, is proportional to the settlement $u$.\n  Per the problem definition, the equivalent raft-soil stiffness is $K_r = k_s \\cdot A$. The constitutive law is:\n  $$ Q_r = K_r \\cdot u $$\n\n- **Pile Group**: The vector of pile-head forces, $\\mathbf{q}$, is related to the vector of pile-head displacements, $\\mathbf{u}_p$, by the pile group stiffness matrix $K_p$.\n  $$ \\mathbf{q} = K_p \\mathbf{u}_p $$\n  Substituting the compatibility condition $\\mathbf{u}_p = u \\cdot \\mathbf{1}$ into this relation gives:\n  $$ \\mathbf{q} = K_p (u \\cdot \\mathbf{1}) = u (K_p \\mathbf{1}) $$\n  This equation provides the load $q_i$ on each individual pile $i$ as a a function of the unknown settlement $u$. The term $K_p \\mathbf{1}$ is a vector whose $i$-th element is the sum of all stiffness coefficients in the $i$-th row of $K_p$, i.e., $\\sum_{j=1}^{n} K_{p,ij}$.\n\nThe total load carried by the entire pile group, $Q_p$, is the sum of the individual pile loads:\n$$ Q_p = \\sum_{i=1}^{n} q_i = \\mathbf{1}^T \\mathbf{q} $$\nSubstituting the expression for $\\mathbf{q}$:\n$$ Q_p = \\mathbf{1}^T (u K_p \\mathbf{1}) = u (\\mathbf{1}^T K_p \\mathbf{1}) $$\nThe scalar quantity $K_{p,group} = \\mathbf{1}^T K_p \\mathbf{1} = \\sum_{i=1}^{n} \\sum_{j=1}^{n} K_{p,ij}$ represents the overall stiffness of the pile group when subjected to a uniform displacement. It is calculated by summing all elements of the matrix $K_p$. The total pile group load is thus:\n$$ Q_p = K_{p,group} \\cdot u $$\nIf there are no piles ($n=0$), then $K_{p,group}=0$ and $Q_p=0$.\n\n**3. Static Equilibrium**\nFor the piled raft system to be in static equilibrium, the total applied load $Q$ must be balanced by the sum of all upward reactions from the foundation. These reactions are the raft-soil contact force $Q_r$ and the total pile group force $Q_p$.\n$$ Q = Q_r + Q_p $$\nSubstituting the constitutive relations for $Q_r$ and $Q_p$ into the equilibrium equation:\n$$ Q = (K_r \\cdot u) + (K_{p,group} \\cdot u) $$\nFactoring out the settlement $u$:\n$$ Q = (K_r + K_{p,group}) \\cdot u $$\nThis is the governing equation for the single-degree-of-freedom system. The term $K_{total} = K_r + K_{p,group}$ is the total stiffness of the piled raft foundation.\n\n**4. Computational Algorithm**\nBased on the derivation, the computational procedure is as follows:\n\n- **Step 1: Unit Conversion and Stiffness Calculation.**\n  - Convert all input parameters to base SI units (N, m).\n    - $Q\\;[\\mathrm{N}] = Q\\;[\\mathrm{kN}] \\times 10^3$\n    - $k_s\\;[\\mathrm{N/m^3}] = k_s\\;[\\mathrm{MN/m^3}] \\times 10^6$\n    - $K_p\\;[\\mathrm{N/m}] = K_p\\;[\\mathrm{GN/m}] \\times 10^9$\n  - Calculate raft stiffness: $K_r = k_s \\cdot A$.\n  - Calculate pile group stiffness: If $n > 0$, $K_{p,group} = \\sum_{i,j} K_{p,ij}$. If $n=0$, $K_{p,group} = 0$.\n  - Calculate total system stiffness: $K_{total} = K_r + K_{p,group}$.\n\n- **Step 2: Solve for Settlement.**\n  - The uniform settlement $u$ is calculated from the governing equilibrium equation:\n    $$ u = \\frac{Q}{K_{total}} $$\n\n- **Step 3: Determine Load Distribution.**\n  - Raft-soil contact load: $Q_r = K_r \\cdot u$.\n  - Pile loads: If $n > 0$, the vector of pile loads $\\mathbf{q}$ is calculated as $\\mathbf{q} = u (K_p \\mathbf{1})$. If $n=0$, the pile load vector is empty.\n\n- **Step 4: Perform Safety Check.**\n  - For each pile $i$, compare its calculated load $q_i$ to its allowable capacity $C_i$. Note that both must be in the same units (e.g., $\\mathrm{kN}$) for a valid comparison.\n  - The foundation is deemed 'safe' if $q_i \\le C_i$ for all piles. For a foundation with no piles, this condition is vacuously true.\n\n- **Step 5: Format Output.**\n  - Convert the calculated settlement $u$ to millimeters ($u \\times 1000$), raft load $Q_r$ to kiloNewtons ($Q_r / 1000$), and pile loads $q_i$ to kiloNewtons ($q_i / 1000$).\n  - Round the values to the specified number of decimal places.\n  - Assemble the results into the required list format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n    \n    # Test suite definition\n    test_cases = [\n        # Case 1: (Q, A, k_s, K_p, {C_i})\n        (60000, 400, 30, \n         [[0.8, 0.16, 0.16, 0.16], \n          [0.16, 0.8, 0.16, 0.16], \n          [0.16, 0.16, 0.8, 0.16], \n          [0.16, 0.16, 0.16, 0.8]], \n         [6000, 6000, 6000, 6000]),\n        # Case 2: No piles\n        (20000, 300, 15, [], []),\n        # Case 3: Heterogeneous group\n        (50000, 200, 5, \n         [[1.5, 0.25, 0.15], \n          [0.25, 1.2, 0.20], \n          [0.15, 0.20, 0.9]], \n         [17000, 14000, 9500]),\n        # Case 4: High interaction\n        (10000, 250, 10, \n         [[0.6, 0.54], \n          [0.54, 0.6]], \n         [2500, 2500])\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is the desired format.\n    print(f\"{results}\".replace(\"'\", \"\").replace(\" \", \"\"))\n\ndef calculate_case(Q_kN, A_m2, ks_MN_m3, Kp_GN_m, C_kN):\n    \"\"\"\n    Calculates settlement and load distribution for a single piled raft case.\n\n    Args:\n        Q_kN (float): Total applied load in kN.\n        A_m2 (float): Raft plan area in m^2.\n        ks_MN_m3 (float): Subgrade modulus in MN/m^3.\n        Kp_GN_m (list of lists): Pile group stiffness matrix in GN/m.\n        C_kN (list of float): Pile capacities in kN.\n\n    Returns:\n        list: [settlement_mm, raft_load_kN, pile_loads_kN_list, is_safe_boolean]\n    \"\"\"\n    # Unit conversions to base SI units (N, m)\n    Q_N = Q_kN * 1e3\n    ks_N_m3 = ks_MN_m3 * 1e6\n\n    # Step 1: Calculate Stiffnesses\n    # Raft-soil contact stiffness\n    Kr_N_m = ks_N_m3 * A_m2\n\n    # Pile group stiffness\n    if not Kp_GN_m:\n        n_piles = 0\n        Kp_group_N_m = 0.0\n        Kp_N_m = np.array([])\n    else:\n        Kp_GN_m_np = np.array(Kp_GN_m)\n        n_piles = Kp_GN_m_np.shape[0]\n        Kp_N_m = Kp_GN_m_np * 1e9\n        # Equivalent group stiffness is the sum of all elements in the matrix\n        Kp_group_N_m = np.sum(Kp_N_m)\n    \n    # Total system stiffness\n    K_total_N_m = Kr_N_m + Kp_group_N_m\n\n    # Step 2: Calculate Settlement\n    # Safeguard against non-positive stiffness, though physically not expected\n    if K_total_N_m = 0:\n        return [0.0, 0.0, [], False]\n\n    u_m = Q_N / K_total_N_m\n    u_mm = u_m * 1e3\n\n    # Step 3: Determine Load Distribution\n    # Raft-soil contact load\n    Qr_N = Kr_N_m * u_m\n    Qr_kN = Qr_N / 1e3\n\n    # Pile loads\n    q_kN_list = []\n    is_safe = True\n    if n_piles > 0:\n        # q = u * (K_p * 1), where K_p*1 is a vector of row sums\n        row_sums_N_m = np.sum(Kp_N_m, axis=1)\n        q_N_vector = u_m * row_sums_N_m\n        q_kN_vector = q_N_vector / 1e3\n        \n        q_kN_list = [round(q, 2) for q in q_kN_vector]\n        \n        # Step 4: Perform Safety Check\n        C_kN_np = np.array(C_kN)\n        # Using a small tolerance for floating point comparisons\n        is_safe = np.all(q_kN_vector = C_kN_np + 1e-9)\n    else: # n_piles == 0\n        is_safe = True\n        q_kN_list = []\n\n    # Step 5: Format Output\n    u_mm_rounded = round(u_mm, 3)\n    Qr_kN_rounded = round(Qr_kN, 2)\n    \n    return [u_mm_rounded, Qr_kN_rounded, q_kN_list, bool(is_safe)]\n\n\nsolve()\n```"
        }
    ]
}