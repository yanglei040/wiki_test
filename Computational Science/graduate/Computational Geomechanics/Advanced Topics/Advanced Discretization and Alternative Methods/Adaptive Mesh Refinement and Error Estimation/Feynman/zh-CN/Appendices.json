{
    "hands_on_practices": [
        {
            "introduction": "许多误差估计器的基础在于量化数值解在多大程度上违反了控制物理定律，特别是平衡方程。本练习通过具体的分步计算，让您亲手计算这些违反量的基本组成部分——单元残差和跳跃残差，它们是基于残差的误差估计的基石。",
            "id": "3499439",
            "problem": "考虑一个层状土在垂直荷载作用下的二维小应变线性弹性模型中的两个相邻线性三角形有限元，该模型在平面应变条件下进行分析。设顶部单元表示为 $K$（位于上层），底部单元表示为 $K'$（位于下层）。全局坐标系为 $(x,y)$，$y$ 轴正方向朝上，地表位于 $y=0$。共享的内部边 $e$ 位于 $y=-1$ 处，呈水平方向，从 $(0,-1)$ 延伸至 $(2,-1)$。边 $e$ 上从 $K$ 指向 $K'$ 的单位法向量为 $n_e=(0,-1)^{\\mathsf{T}}$。\n\n几何与运动学：\n- 单元 $K$ 的顶点为 $x_1=(0,-1)$、$x_2=(2,-1)$、$x_3=(0,0)$。\n- 单元 $K'$ 的顶点为 $x_1'=(0,-1)$、$x_2'=(2,-1)$、$x_3'=(0,-2)$。\n- 协调的分片线性位移场 $u_h=(u_{h,x},u_{h,y})^{\\mathsf{T}}$ 在顶点的数值如下（单位：米）：\n  - 在 $K$ 上：$u_h(x_1)=(-1.0\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_2)=(-1.2\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_3)=(-0.8\\times 10^{-4},\\,0)$。\n  - 在 $K'$ 上：$u_h(x_1')=(-1.0\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_2')=(-1.2\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_3')=(-1.3\\times 10^{-4},\\,-1.2\\times 10^{-3})$。\n\n本构行为与体力：\n- 上层（单元 $K$）：杨氏模量 $E_1=5.0\\times 10^{7}$，泊松比 $\\nu_1=0.3$。\n- 下层（单元 $K'$）：杨氏模量 $E_2=1.5\\times 10^{8}$，泊松比 $\\nu_2=0.25$。\n- 假设为平面应变。柯西应力为 $\\sigma(u_h)=2\\mu\\,\\varepsilon(u_h)+\\lambda\\,\\mathrm{tr}(\\varepsilon(u_h))\\,I$，其中 $\\varepsilon(u_h)=\\tfrac{1}{2}\\left(\\nabla u_h+(\\nabla u_h)^{\\mathsf{T}}\\right)$，$\\mu=\\dfrac{E}{2(1+\\nu)}$，以及 $\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$，其中 $(E,\\nu)$ 取各单元的相应值。\n- $K$ 内部的体力是分片常数，代表自重：$f=(0,\\,-\\rho_1 g)^{\\mathsf{T}}$，其中 $\\rho_1=1800$ 且 $g=9.81$。假设 $K$ 内部没有体力变化，并且本次计算不需要 $K'$ 的体力数据。\n\n平衡与残差：\n- 平衡的强形式为 $-\\nabla\\cdot\\sigma(u)=f$。$K$ 上的单元残差定义为 $L^2$-范数 $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$，内部边 $e$ 上的跳跃残差定义为 $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$，其中 $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$。\n\n任务：\n1) 从小应变的运动学关系和平面应变各向同性线性弹性定律出发，计算 $K$ 和 $K'$ 上的 $\\nabla u_h$，然后计算每个单元上的 $\\varepsilon(u_h)$ 和 $\\sigma(u_h)$。使用指定的节点值来确定每个线性三角形上的常数梯度。\n\n2) 利用平衡方程以及 $\\sigma(u_h)$ 在每个具有常数系数的线性三角形上为常数这一事实，确定 $K$ 上的 $f+\\nabla\\cdot\\sigma(u_h)$ 并计算单元残差范数 $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$。\n\n3) 计算边 $e$ 上的牵引力跳跃向量 $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$，然后计算其 $L^2$-范数 $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$。\n\n4) 设单元尺寸参数 $h_K$ 定义为 $K$ 的最长边的长度。构建无量纲比率\n$$\nR \\;=\\; \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}.\n$$\n计算 $R$ 并将最终答案四舍五入到四位有效数字。将 $R$ 表示为一个无量纲的纯数。\n\n5) 根据您的计算值和层状土在垂直荷载下的物理背景，简要解释在自适应算法中，单元残差和跳跃残差将如何分别驱动网格细化。\n\n注意：始终使用国际单位制 (SI)。最终报告的答案必须是 $R$ 的单个四舍五入后的无量纲数值。",
            "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n-   **单元**：二维平面应变模型中的两个相邻线性三角形有限元，$K$（顶部）和 $K'$（底部）。\n-   **几何**：\n    -   共享边 $e$ 是水平的，从 $(0, -1)$ 到 $(2, -1)$。\n    -   $e$ 上从 $K$ 指向 $K'$ 的单位法向量为 $n_e = (0, -1)^{\\mathsf{T}}$。\n    -   $K$ 的顶点：$x_1=(0, -1)$，$x_2=(2, -1)$，$x_3=(0, 0)$。\n    -   $K'$ 的顶点：$x_1'=(0, -1)$，$x_2'=(2, -1)$，$x_3'=(0, -2)$。\n-   **位移场 ($u_h$)**：协调的分片线性场，节点值（单位：米）：\n    -   在 $K$ 上：$u_h(x_1)=(-1.0\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_2)=(-1.2\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_3)=(-0.8\\times 10^{-4}, 0)$。\n    -   在 $K'$ 上：$u_h(x_1')=(-1.0\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_2')=(-1.2\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_3')=(-1.3\\times 10^{-4}, -1.2\\times 10^{-3})$。\n-   **材料属性**：\n    -   层 $K$：杨氏模量 $E_1=5.0\\times 10^{7}$ Pa，泊松比 $\\nu_1=0.3$。\n    -   层 $K'$：杨氏模量 $E_2=1.5\\times 10^{8}$ Pa，泊松比 $\\nu_2=0.25$。\n-   **本构定律**：平面应变线性弹性，$\\sigma(u_h)=2\\mu\\,\\varepsilon(u_h)+\\lambda\\,\\mathrm{tr}(\\varepsilon(u_h))\\,I$，其中应变为 $\\varepsilon(u_h)=\\tfrac{1}{2}\\left(\\nabla u_h+(\\nabla u_h)^{\\mathsf{T}}\\right)$，拉梅参数为 $\\mu=\\dfrac{E}{2(1+\\nu)}$，$\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n-   **体力**：在 $K$ 上，$f=(0, -\\rho_1 g)^{\\mathsf{T}}$，其中 $\\rho_1=1800$ kg/m$^3$，$g=9.81$ m/s$^2$。\n-   **残差定义**：\n    -   $K$ 上的单元残差：$\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$。\n    -   $e$ 上的跳跃残差：$\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$，其中 $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$。\n-   **任务**：计算无量纲比率 $R = \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}$，其中 $h_K$ 是 $K$ 的最长边的长度。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在线性弹性理论和有限元方法中有充分的理论基础，特别是使用了计算力学中的*后验*误差估计概念。材料属性和荷载的数值在岩土力学背景下是物理上现实的。\n-   **适定性**：该问题是基于所提供的数据和有限元方法的标准公式进行的一系列直接计算。所有必要的信息都已给出，可以计算出 $R$ 的唯一数值。\n-   **客观性**：问题陈述使用了精确、客观和标准的技术术语。\n-   **一致性与完整性**：单元的几何数据是一致的。位移场在共享节点 $x_1$ 和 $x_2$ 处的连续性得到了检查，其数值匹配，证实了陈述中的协调性。所有必需的常数和定义都已提供。问题是自包含的。\n-   **其他缺陷**：该问题没有表现出任何其他缺陷，如过于简单、隐喻性或科学上不可验证。\n\n### 步骤 3：结论与行动\n问题是有效的。有必要给出完整解答。\n\n### 解答\n解答过程遵循问题陈述中列出的五个任务。所有计算均采用国际单位制 (SI)。\n\n**1) 计算每个单元上的位移梯度、应变和应力。**\n\n对于线性三角形单元，分片线性位移场 $u_h$ 的梯度是常数。梯度张量 $\\nabla u_h$ 的分量可以使用公式 $\\frac{\\partial u_\\alpha}{\\partial x_\\beta} = \\frac{1}{2A} \\sum_{i=1}^3 c_{i\\beta} u_{i\\alpha}$ 计算，其中 $A$ 是单元面积，系数由节点坐标导出。为更直接地计算，我们使用标准公式，其中梯度分量为 $\\partial_x u_k = \\frac{1}{2A}\\sum_i b_i u_{ik}$ 和 $\\partial_y u_k = \\frac{1}{2A}\\sum_i c_i u_{ik}$，其中 $k \\in \\{x,y\\}$，$b_i = y_j - y_k$，$c_i = x_k - x_j$，节点 $(i, j, k)$ 按循环顺序排列。\n\n_在单元 $K$ 上（顶点 $x_1=(0,-1)$、$x_2=(2,-1)$、$x_3=(0,0)$）：_\n面积为 $A_K = \\frac{1}{2} |(x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1)| = \\frac{1}{2} |(2)(1) - (0)(0)| = 1$。\n系数为：\n$b_1 = y_2 - y_3 = -1 - 0 = -1$，$c_1 = x_3 - x_2 = 0 - 2 = -2$。\n$b_2 = y_3 - y_1 = 0 - (-1) = 1$，$c_2 = x_1 - x_3 = 0 - 0 = 0$。\n$b_3 = y_1 - y_2 = -1 - (-1) = 0$，$c_3 = x_2 - x_1 = 2 - 0 = 2$。\n节点位移为 $u_1=(-1, -5) \\times 10^{-4}$，$u_2=(-1.2, -5) \\times 10^{-4}$，$u_3=(-0.8, 0) \\times 10^{-4}$。\n\n$\\partial_x u_{h,x} = \\frac{1}{2(1)}[(-1)(-1.0) + (1)(-1.2) + (0)(-0.8)]\\times 10^{-4} = -0.1 \\times 10^{-4}$。\n$\\partial_y u_{h,x} = \\frac{1}{2(1)}[(-2)(-1.0) + (0)(-1.2) + (2)(-0.8)]\\times 10^{-4} = 0.2 \\times 10^{-4}$。\n$\\partial_x u_{h,y} = \\frac{1}{2(1)}[(-1)(-5.0) + (1)(-5.0) + (0)(0)]\\times 10^{-4} = 0$。\n$\\partial_y u_{h,y} = \\frac{1}{2(1)}[(-2)(-5.0) + (0)(-5.0) + (2)(0)]\\times 10^{-4} = 5.0 \\times 10^{-4}$。\n所以，$(\\nabla u_h)_K = \\begin{pmatrix} -0.1  0.2 \\\\ 0  5.0 \\end{pmatrix} \\times 10^{-4}$。\n\n应变张量为 $\\varepsilon_K = \\frac{1}{2}((\\nabla u_h)_K + (\\nabla u_h)_K^{\\mathsf{T}}) = \\begin{pmatrix} -0.1  0.1 \\\\ 0.1  5.0 \\end{pmatrix} \\times 10^{-4}$。\n迹为 $\\mathrm{tr}(\\varepsilon_K) = (-0.1 + 5.0) \\times 10^{-4} = 4.9 \\times 10^{-4}$。\n$K$ 的材料属性：$E_1=5.0\\times 10^{7}$，$\\nu_1=0.3$。\n$\\mu_1 = \\frac{5.0 \\times 10^7}{2(1+0.3)} = \\frac{25}{13}\\times 10^7$。\n$\\lambda_1 = \\frac{(5.0 \\times 10^7)(0.3)}{(1+0.3)(1-2 \\times 0.3)} = \\frac{75}{26}\\times 10^7$。\n应力张量为 $\\sigma_K = 2\\mu_1\\varepsilon_K + \\lambda_1\\mathrm{tr}(\\varepsilon_K)I$：\n$\\sigma_{xx,K} = 2(\\frac{25}{13}\\times 10^7)(-0.1\\times 10^{-4}) + (\\frac{75}{26}\\times 10^7)(4.9\\times 10^{-4}) = 13750$ Pa。\n$\\sigma_{yy,K} = 2(\\frac{25}{13}\\times 10^7)(5.0\\times 10^{-4}) + (\\frac{75}{26}\\times 10^7)(4.9\\times 10^{-4}) = \\frac{867500}{26} \\approx 33365.38$ Pa。\n$\\sigma_{xy,K} = 2(\\frac{25}{13}\\times 10^7)(0.1\\times 10^{-4}) = \\frac{5000}{13} \\approx 384.62$ Pa。\n因此，$\\sigma_K \\approx \\begin{pmatrix} 13750  384.62 \\\\ 384.62  33365.38 \\end{pmatrix}$ Pa。\n\n_在单元 $K'$ 上（顶点 $x_1'=(0,-1)$、$x_2'=(2,-1)$、$x_3'=(0,-2)$）：_\n面积为 $A_{K'} = \\frac{1}{2} |(2)(-1) - (0)(0)| = 1$。\n系数为：\n$b_1' = y_2' - y_3' = -1 - (-2) = 1$，$c_1' = x_3' - x_2' = 0 - 2 = -2$。\n$b_2' = y_3' - y_1' = -2 - (-1) = -1$，$c_2' = x_1' - x_3' = 0 - 0 = 0$。\n$b_3' = y_1' - y_2' = -1 - (-1) = 0$，$c_3' = x_2' - x_1' = 2 - 0 = 2$。\n节点位移 $u_1'=(-1, -5) \\times 10^{-4}$，$u_2'=(-1.2, -5) \\times 10^{-4}$，$u_3'=(-1.3, -12) \\times 10^{-4}$。\n$(\\nabla u_h)_{K'} = \\begin{pmatrix} 0.1  -0.3 \\\\ 0  -7.0 \\end{pmatrix} \\times 10^{-4}$。\n\n应变张量为 $\\varepsilon_{K'} = \\begin{pmatrix} 0.1  -0.15 \\\\ -0.15  -7.0 \\end{pmatrix} \\times 10^{-4}$。\n迹为 $\\mathrm{tr}(\\varepsilon_{K'}) = (0.1 - 7.0) \\times 10^{-4} = -6.9 \\times 10^{-4}$。\n$K'$ 的材料属性：$E_2=1.5\\times 10^8$，$\\nu_2=0.25$。\n$\\mu_2 = \\frac{1.5 \\times 10^8}{2(1+0.25)} = 6.0\\times 10^7$。\n$\\lambda_2 = \\frac{(1.5 \\times 10^8)(0.25)}{(1+0.25)(1-2 \\times 0.25)} = 6.0\\times 10^7$。\n应力张量为 $\\sigma_{K'} = 2\\mu_2\\varepsilon_{K'} + \\lambda_2\\mathrm{tr}(\\varepsilon_{K'})I$：\n$\\sigma_{xx,K'} = 2(6\\times 10^7)(0.1\\times 10^{-4}) + (6\\times 10^7)(-6.9\\times 10^{-4}) = -40200$ Pa。\n$\\sigma_{yy,K'} = 2(6\\times 10^7)(-7.0\\times 10^{-4}) + (6\\times 10^7)(-6.9\\times 10^{-4}) = -125400$ Pa。\n$\\sigma_{xy,K'} = 2(6\\times 10^7)(-0.15\\times 10^{-4}) = -1800$ Pa。\n因此，$\\sigma_{K'} = \\begin{pmatrix} -40200  -1800 \\\\ -1800  -125400 \\end{pmatrix}$ Pa。\n\n**2) 计算 $K$ 上的单元残差范数。**\n单元残差为 $r_K = f + \\nabla \\cdot \\sigma(u_h)$。对于线性三角形单元，计算出的应力张量 $\\sigma(u_h)$ 在整个单元内是常数。因此，其散度为零：$\\nabla \\cdot \\sigma(u_h) = 0$。残差简化为体力项，$r_K = f$。\n体力为 $f = (0, -\\rho_1 g)^{\\mathsf{T}} = (0, -1800 \\times 9.81)^{\\mathsf{T}} = (0, -17658)^{\\mathsf{T}}$ N/m$^3$。\n残差的 $L^2$-范数为 $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K} = \\|f\\|_{0,K} = \\left(\\int_K |f|^2 dA\\right)^{1/2}$。\n由于 $f$ 是常数，这可以简化为 $|f| \\sqrt{A_K}$。\n$\\|f\\|_{0,K} = \\sqrt{0^2 + (-17658)^2} \\times \\sqrt{1} = 17658$。单位是 N/m$^2$。\n\n**3) 计算 $e$ 上的跳跃残差范数。**\n跳跃向量为 $J = [\\![\\sigma(u_h)n_e]\\!] = (\\sigma_K - \\sigma_{K'})n_e$。法向量为 $n_e = (0, -1)^{\\mathsf{T}}$。\n首先，我们计算应力张量的差值：\n$\\Delta\\sigma = \\sigma_K - \\sigma_{K'} = \\begin{pmatrix} 13750 - (-40200)  \\frac{5000}{13} - (-1800) \\\\ \\frac{5000}{13} - (-1800)  \\frac{867500}{26} - (-125400) \\end{pmatrix} = \\begin{pmatrix} 53950  \\frac{28400}{13} \\\\ \\frac{28400}{13}  \\frac{2063950}{13} \\end{pmatrix}$ Pa。\n跳跃向量为 $J = \\Delta\\sigma n_e = \\begin{pmatrix} 53950  \\frac{28400}{13} \\\\ \\frac{28400}{13}  \\frac{2063950}{13} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{28400}{13} \\\\ -\\frac{2063950}{13} \\end{pmatrix}$ Pa。\n$J \\approx (-2184.62, -158765.38)^{\\mathsf{T}}$ Pa。\n$L^2$-范数为 $\\|J\\|_{0,e} = \\left(\\int_e |J|^2 ds\\right)^{1/2}$。由于 $J$ 沿着边 $e$ 是常数，这变为 $|J|\\sqrt{L_e}$，其中 $L_e$ 是 $e$ 的长度。\n边 $e$ 连接 $(0, -1)$ 和 $(2, -1)$，所以其长度为 $L_e = 2$ m。\n$|J|^2 = \\left(-\\frac{28400}{13}\\right)^2 + \\left(-\\frac{2063950}{13}\\right)^2 = \\frac{1}{169}(28400^2 + 2063950^2) = \\frac{4260676662500}{169}$。\n$\\|J\\|_{0,e} = \\sqrt{2 \\times \\frac{4260676662500}{169}} = \\frac{\\sqrt{8521353325000}}{13} \\approx 224548.9$。单位是 N/m$^{3/2}$。\n\n**4) 计算无量纲比率 $R$。**\n该比率为 $R = \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}$。\n首先，确定 $h_K$，$K$ 的最长边的长度。$K$ 的边长为：\n$L_{12} = \\sqrt{(2-0)^2 + (-1-(-1))^2} = 2$。\n$L_{23} = \\sqrt{(0-2)^2 + (0-(-1))^2} = \\sqrt{4+1} = \\sqrt{5}$。\n$L_{31} = \\sqrt{(0-0)^2 + (-1-0)^2} = 1$。\n最长边为 $h_K = \\sqrt{5}$ m。\n现在，我们计算 $R$：\n$R = \\frac{(\\sqrt{5})^{1/2} \\times 17658}{224548.9} = \\frac{5^{1/4} \\times 17658}{224548.9}$。\n$5^{1/4} \\approx 1.49534878$。\n$R \\approx \\frac{1.49534878 \\times 17658}{224548.9} \\approx \\frac{26405.303}{224548.9} \\approx 0.1175936$。\n四舍五入到四位有效数字，得到 $R=0.1176$。\n\n**5) 用于自适应网格细化的物理解释。**\n这两个残差量化了数值解中误差的不同方面。\n**单元残差** $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$ 衡量了单元内部不满足平衡的程度。对于线性单元，该项简化为 $\\|f\\|_{0,K}$，表明常数应力无法平衡非零体力。该残差会驱动在那些力项需要更复杂（例如，非常数）应力场的区域进行网格细化。\n**跳跃残差** $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$ 衡量了跨单元边界的牵引力连续性被违反的程度，而牵引力连续性是平衡的一个要求（牛顿第三定律）。大的跳跃表示相邻单元之间存在大的、不符合物理规律的力不平衡。这通常是材料界面处的主要误差来源，在这些界面上，刚度不连续性会导致剧烈的应力梯度，而分片多项式应力场对此的近似效果很差。\n在本问题中，比率 $R \\approx 0.1176$ 很小，表明在适当缩放后，跳跃残差项显著大于单元残差项。这意味着误差的主要来源是跨材料界面的大的牵引力不平衡，而不是单元内部无法平衡自重。因此，自适应算法会优先细化两个土层之间的边界（边 $e$）处的网格，以更好地解析界面处的应力集中。",
            "answer": "$$\\boxed{0.1176}$$"
        },
        {
            "introduction": "在平衡概念的基础上，我们现在引入一个植根于材料本构行为的、更复杂的误差度量。本练习将演示如何使用“平衡的”应力重构来估计能量范数下的误差，从而提供一个与应变能相关的、具有明确物理意义的量。这类估计器以其稳健性而闻名，尤其在处理具有挑战性的问题（例如分析近乎不可压缩的材料）时表现出色。",
            "id": "3499389",
            "problem": "考虑在凸多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上，对于平面应变下的多孔地质材料，在二维空间中的准静态小应变线性弹性问题。设体力为 $\\boldsymbol{b} = \\boldsymbol{0}$，边界面力为 $\\boldsymbol{g}=\\boldsymbol{0}$。平衡的强形式由 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$（在 $\\Omega$ 中）和 $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\boldsymbol{g}$（在 $\\partial \\Omega$ 上）给出，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{n}$ 是 $\\partial \\Omega$ 上的单位外法向量。本构关系为各向同性定律 $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$，其中 Lamé 参数 $\\lambda > 0$, $\\mu > 0$，位移为 $\\boldsymbol{u}$，应变为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$，单位张量为 $\\boldsymbol{I}$，$\\operatorname{tr}(\\cdot)$ 表示迹。假设单位厚度。\n\n一个 $H(\\operatorname{div})$ 协调的混合应力-位移公式在对称张量值的 $H(\\operatorname{div})$ 空间中产生一个离散应力场 $\\boldsymbol{\\sigma}_{h}$，并在网格骨架上产生混合位移未知数。一个平衡的后验估计器旨在寻求一个静力许可的重构应力 $\\boldsymbol{\\sigma}^{\\star}$（在单元内无散度，并满足给定的体力，且法向牵引力在界面上连续），并使用材料柔度来度量应力误差。\n\n从平衡定律和各向同性线弹性问题的柔度算子出发，推导一个平衡的后验误差估计器，该估计器：\n- 使用一个满足 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} + \\boldsymbol{b} = \\boldsymbol{0}$（在每个单元中）和在内部面上法向牵引力 $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}$ 连续的应力重构 $\\boldsymbol{\\sigma}^{\\star}$，\n- 通过双点积 $\\boldsymbol{\\tau} : \\boldsymbol{\\eta} = \\sum_{i,j} \\tau_{ij} \\eta_{ij}$ 来度量柔度范数下的误差。\n\n然后，对于以下在方形域 $\\Omega = (0,1) \\times (0,1)$ 上的特定双三角形网格，该域被从 $(0,0)$ 到 $(1,1)$ 的对角线划分为两个面积为 $|K_{1}|=|K_{2}|=\\frac{1}{2}$ 的单元 $K_{1}$ 和 $K_{2}$，其离散应力场为\n$$\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} =\n\\begin{pmatrix}\n2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6}  0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} =\n\\begin{pmatrix}\n1.5 \\times 10^{6}  0.8 \\times 10^{6} \\\\\n0.8 \\times 10^{6}  0.2 \\times 10^{6}\n\\end{pmatrix},\n$$\n选择平衡重构 $\\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$（其满足 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$ 和 $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}=\\boldsymbol{0}$）。假设 Lamé 参数 $\\mu = 1.0 \\times 10^{8}$ 和 $\\lambda = 1.0 \\times 10^{10}$，并使用标准的 Frobenius 双点积和二维张量分解为偏量和体积部分的方法。\n\n将平衡估计器的平方表示为\n$$\n\\eta^{2} = \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right) : \\boldsymbol{S} : \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right)\\, \\mathrm{d}x,\n$$\n其中 $\\boldsymbol{S}$ 是柔度张量。根据给定的数据计算 $\\eta^{2}$ 的数值。将 $\\eta^{2}$ 的最终数值四舍五入到四位有效数字。最终结果以焦耳（Joules）表示。\n\n最后，根据您的推导，解释为什么这种应力平衡估计器在不可压缩极限（即 $\\lambda$ 很大时）下优于基于位移的残差估计器，并参考柔度如何分离偏量和体积贡献，以及法向牵引力的连续性如何有助于鲁棒性。\n\n注意：在所有迹和偏量分解中，使用 $n=2$（二维），即 $\\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，以及适用于二维各向同性线弹性的柔度映射 $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$。全程使用单位厚度。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- **问题：** 准静态小应变线性弹性，二维（2D）平面应变。\n- **域：** 凸多边形域 $\\Omega \\subset \\mathbb{R}^{2}$，边界为 $\\partial \\Omega$。\n- **载荷：** 体力 $\\boldsymbol{b} = \\boldsymbol{0}$，边界面力 $\\boldsymbol{g} = \\boldsymbol{0}$。\n- **平衡：** $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ 在 $\\Omega$ 中，以及 $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\boldsymbol{g}$ 在 $\\partial \\Omega$ 上。\n- **本构定律：** $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$，其中 Lamé 参数 $\\lambda > 0$, $\\mu > 0$。\n- **运动学：** $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$。\n- **估计器：** 在柔度范数下度量应力误差的平衡后验估计器。\n- **重构应力：** $\\boldsymbol{\\sigma}^{\\star}$ 满足在每个单元中 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} + \\boldsymbol{b} = \\boldsymbol{0}$，并且在内部面上法向牵引力 $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}$ 连续。\n- **误差估计器公式：** $\\eta^{2} = \\sum_{K} \\int_{K} \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right) : \\boldsymbol{S} : \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right)\\, \\mathrm{d}x$。\n- **特定几何形状：** 域 $\\Omega = (0,1) \\times (0,1)$，被从 $(0,0)$ 到 $(1,1)$ 的对角线划分为两个三角形 $K_{1}$ 和 $K_{2}$。面积 $|K_{1}|=|K_{2}|=\\frac{1}{2}$。\n- **离散应力场：**\n$$\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} =\n\\begin{pmatrix}\n2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6}  0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} =\n\\begin{pmatrix}\n1.5 \\times 10^{6}  0.8 \\times 10^{6} \\\\\n0.8 \\times 10^{6}  0.2 \\times 10^{6}\n\\end{pmatrix}\n$$\n- **特定重构应力：** $\\boldsymbol{\\sigma}^{\\star} = \\boldsymbol{0}$。\n- **材料参数：** $\\mu = 1.0 \\times 10^{8}$，$\\lambda = 1.0 \\times 10^{10}$。\n- **定义：** 维度 $n=2$，偏量分解 $\\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，柔度映射 $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$。单位厚度。\n- **任务：**\n  1. 计算 $\\eta^{2}$ 的数值，并四舍五入到四位有效数字，单位为焦耳。\n  2. 解释该估计器在不可压缩极限下的优势。\n\n**步骤2：问题陈述的验证**\n该问题在科学上基于线弹性理论和有限元方法的后验误差估计，这两个都是成熟的领域。所有术语均根据连续介质力学和计算工程领域的标准惯例定义。所提供的数据，包括材料属性和应力场，在内部是一致的且物理上是合理的。选择 $\\boldsymbol{\\sigma}^{\\star} = \\boldsymbol{0}$ 是一个有效但简单的平衡应力场，因为它满足 $\\nabla \\cdot \\boldsymbol{0} + \\boldsymbol{0} = \\boldsymbol{0}$ 并且法向牵引力为零，从而保证了连续性。该问题是适定的，为所需的计算和理论解释提供了所有必要的信息。它没有违反任何无效性标准。\n\n**步骤3：结论与行动**\n该问题被认为是有效的。将提供完整的解决方案。\n\n**误差估计器被积函数的推导**\n误差估计器的平方由下式给出\n$$ \\eta^{2} = \\sum_{K} \\int_{K} (\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}) : \\boldsymbol{S} : (\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}) \\, \\mathrm{d}x $$\n令 $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}$。被积函数为 $\\boldsymbol{\\tau} : \\boldsymbol{S} : \\boldsymbol{\\tau}$。我们首先需要推导二维平面应变情况下的柔度张量 $\\boldsymbol{S}$，它反转了给定的本构关系 $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}$。\n\n对二维本构方程取迹：\n$$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}) = 2\\mu \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\operatorname{tr}(\\boldsymbol{I}) $$\n在二维中，$\\operatorname{tr}(\\boldsymbol{I}) = 1+1=2$。\n$$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = (2\\mu + 2\\lambda) \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\implies \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) $$\n将此式代回本构定律以求解 $\\boldsymbol{\\varepsilon}$：\n$$ \\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\left(\\frac{1}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma})\\right) \\boldsymbol{I} $$\n$$ 2\\mu \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma} - \\frac{\\lambda}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I} $$\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2\\mu} \\boldsymbol{\\sigma} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I} $$\n该表达式定义了柔度张量 $\\boldsymbol{S}$ 的作用，即 $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$。\n\n为简化被积函数，我们将应力张量 $\\boldsymbol{\\tau}$ 分解为其偏量部分和球量部分：$\\boldsymbol{\\tau} = \\operatorname{dev}(\\boldsymbol{\\tau}) + \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\tau})\\boldsymbol{I}$。\n应变能密度可以写为 $\\boldsymbol{\\tau} : \\boldsymbol{\\varepsilon} = \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau})$。让我们代入 $\\boldsymbol{\\varepsilon}$ 的表达式：\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\boldsymbol{\\tau} : \\left( \\frac{1}{2\\mu} \\boldsymbol{\\tau} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\tau}) \\boldsymbol{I} \\right) = \\frac{1}{2\\mu} (\\boldsymbol{\\tau} : \\boldsymbol{\\tau}) - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau})) (\\boldsymbol{\\tau} : \\boldsymbol{I}) $$\n由于 $\\boldsymbol{\\tau}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{\\tau})$，我们有：\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\frac{1}{2\\mu} ||\\boldsymbol{\\tau}||_F^2 - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n其中 $||\\cdot||_F$ 是 Frobenius 范数。我们可以用偏量和球量部分来表示它。回想一下 $||\\boldsymbol{\\tau}||_F^2 = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + ||\\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\tau})\\boldsymbol{I}||_F^2 = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{4}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2 (\\boldsymbol{I}:\\boldsymbol{I}) = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{2}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2$。\n将此代入能量密度表达式：\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\frac{1}{2\\mu} \\left(||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{2}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2\\right) - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\left(\\frac{1}{4\\mu} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\right) (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\left(\\frac{\\mu+\\lambda-\\lambda}{4\\mu(\\mu+\\lambda)} \\right) (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n这是被积函数的最终形式。\n\n**$\\eta^2$ 的数值计算**\n给定 $\\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$，我们有 $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma}_h$。离散应力 $\\boldsymbol{\\sigma}_h$ 在每个单元 $K_1$ 和 $K_2$ 上是常数。因此，在单元 $K$ 上的积分是被积函数的值乘以单元面积 $|K|$。\n$$ \\eta^2 = \\sum_{K \\in \\{K_1, K_2\\}} |K| \\left[ \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_h|_K)||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\sigma}_h|_K))^2 \\right] $$\n材料参数为 $\\mu = 1.0 \\times 10^8$ 和 $\\lambda = 1.0 \\times 10^{10}$。单元面积为 $|K_1|=|K_2|=\\frac{1}{2}$。\n因此，$2\\mu = 2.0 \\times 10^8$ 且 $4(\\mu+\\lambda) = 4(1.0 \\times 10^8 + 1.0 \\times 10^{10}) = 4(1.01 \\times 10^{10}) = 4.04 \\times 10^{10}$。\n\n对于单元 $K_1$：\n$\\boldsymbol{\\sigma}_1 = \\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} = \\begin{pmatrix} 2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\ 1.0 \\times 10^{6}  0 \\end{pmatrix}$。\n$\\operatorname{tr}(\\boldsymbol{\\sigma}_1) = (2.0 + 0) \\times 10^{6} = 2.0 \\times 10^{6}$。\n$(\\operatorname{tr}(\\boldsymbol{\\sigma}_1))^2 = (2.0 \\times 10^{6})^2 = 4.0 \\times 10^{12}$。\n$\\operatorname{dev}(\\boldsymbol{\\sigma}_1) = \\boldsymbol{\\sigma}_1 - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}_1)\\boldsymbol{I} = \\begin{pmatrix} 2.0  1.0 \\\\ 1.0  0 \\end{pmatrix} \\times 10^6 - \\frac{1}{2}(2.0 \\times 10^6) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1.0  1.0 \\\\ 1.0  -1.0 \\end{pmatrix} \\times 10^6$。\n$||\\operatorname{dev}(\\boldsymbol{\\sigma}_1)||_F^2 = (1.0^2 + 1.0^2 + 1.0^2 + (-1.0)^2) \\times (10^6)^2 = 4.0 \\times 10^{12}$。\n$K_1$ 的贡献，记为 $\\eta_1^2$，为：\n$$ \\eta_1^2 = \\frac{1}{2} \\left[ \\frac{4.0 \\times 10^{12}}{2.0 \\times 10^8} + \\frac{4.0 \\times 10^{12}}{4.04 \\times 10^{10}} \\right] = \\frac{1}{2} [2.0 \\times 10^4 + 0.990099 \\times 10^2] = \\frac{1}{2}[20000 + 99.0099] = 10049.505 $$\n\n对于单元 $K_2$：\n$\\boldsymbol{\\sigma}_2 = \\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} = \\begin{pmatrix} 1.5 \\times 10^{6}  0.8 \\times 10^{6} \\\\ 0.8 \\times 10^{6}  0.2 \\times 10^{6} \\end{pmatrix}$。\n$\\operatorname{tr}(\\boldsymbol{\\sigma}_2) = (1.5 + 0.2) \\times 10^{6} = 1.7 \\times 10^{6}$。\n$(\\operatorname{tr}(\\boldsymbol{\\sigma}_2))^2 = (1.7 \\times 10^6)^2 = 2.89 \\times 10^{12}$。\n$\\operatorname{dev}(\\boldsymbol{\\sigma}_2) = \\boldsymbol{\\sigma}_2 - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}_2)\\boldsymbol{I} = \\begin{pmatrix} 1.5  0.8 \\\\ 0.8  0.2 \\end{pmatrix} \\times 10^{6} - \\frac{1}{2}(1.7 \\times 10^6) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.65  0.8 \\\\ 0.8  -0.65 \\end{pmatrix} \\times 10^6$。\n$||\\operatorname{dev}(\\boldsymbol{\\sigma}_2)||_F^2 = (0.65^2 + 0.8^2 + 0.8^2 + (-0.65)^2) \\times (10^6)^2 = (2 \\times 0.4225 + 2 \\times 0.64) \\times 10^{12} = 2.125 \\times 10^{12}$。\n$K_2$ 的贡献，记为 $\\eta_2^2$，为：\n$$ \\eta_2^2 = \\frac{1}{2} \\left[ \\frac{2.125 \\times 10^{12}}{2.0 \\times 10^8} + \\frac{2.89 \\times 10^{12}}{4.04 \\times 10^{10}} \\right] = \\frac{1}{2} [1.0625 \\times 10^4 + 0.715346 \\times 10^2] = \\frac{1}{2}[10625 + 71.5346] = 5348.267 $$\n\n估计器平方的总值为：\n$$ \\eta^2 = \\eta_1^2 + \\eta_2^2 = 10049.505 + 5348.267 = 15397.772 $$\n单位是焦耳，因为能量密度（Pa）在体积（m$^3$，假设单位厚度为米）上的积分是能量（J）。\n四舍五入到四位有效数字，$\\eta^2 = 1.540 \\times 10^4$。\n\n**在不可压缩极限下优势的解释**\n在接近不可压缩极限（即 $\\lambda \\to \\infty$）时，基于应力平衡的后验误差估计器相对于标准的基于位移的残差估计器的优势变得至关重要。\n\n1.  **对不可压缩性的鲁棒性：**\n    误差度量的推导表达式为 $\\eta^2 = \\sum_K \\int_K \\left( \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_{err})||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\sigma}_{err}))^2 \\right) \\mathrm{d}x$，其中 $\\boldsymbol{\\sigma}_{err} = \\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma}^{\\star}$。当 $\\lambda \\to \\infty$ 时，体积（与压力相关）项的系数 $\\frac{1}{4(\\mu+\\lambda)}$ 趋于零。因此，估计器的值渐近地独立于体积应力误差：\n    $$ \\lim_{\\lambda\\to\\infty} \\eta^2 = \\sum_K \\int_K \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_{err})||_F^2 \\, \\mathrm{d}x $$\n    这意味着估计器的值由应力误差的偏量（剪切）部分控制，该部分由剪切模量 $\\mu$ 进行缩放。当材料变得不可压缩时，估计器不会“锁定”或性能下降。相比之下，标准的基于位移的残差估计器（通常包含诸如 $||\\nabla \\cdot \\boldsymbol{\\sigma}_h||^2$ 的项）变得不可靠。在不可压缩极限下，$\\boldsymbol{\\sigma}_h$ 中的压力项（由位移计算）可能表现出大的、非物理的振荡，导致残差成为实际位移误差的不良指标。\n\n2.  **关注平衡性：**\n    该估计器的核心是构建一个静力许可的应力场 $\\boldsymbol{\\sigma}^{\\star}$，它满足逐点平衡（$\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} = -\\boldsymbol{b}$）和跨单元面的法向牵引力的连续性。真实的应力场 $\\boldsymbol{\\sigma}$ 也满足这些条件。数值应力 $\\boldsymbol{\\sigma}_h$（特别是来自混合或混合方法）被设计为在单元内部满足平衡，但通常在单元间界面上表现出法向牵引力的跳跃。因此，误差度量 $\\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma}^{\\star}$ 直接解释了这种单元间牵引力连续性的缺失，而这是误差的主要来源。通过关注平衡性，该方法规避了与强制执行运动学约束 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\approx 0$ 相关的数值困难，这些困难在不可压缩极限下困扰着基于位移的公式及其相应的估计器。平衡重构为误差测量提供了一个稳定、物理上有意义的参考，无论 $\\lambda$ 的值如何，它都保持有效。\n\n总之，将柔度分为偏量和体积部分确保了估计器的量值不受锁定现象的影响，而要求应力重构满足平衡和牵引力连续性提供了一个鲁棒的机制来度量误差，使其在处理近不可压缩材料时优于基于位移的残差。",
            "answer": "$$\n\\boxed{1.540 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "最后的练习将从理论计算转向计算基准测试，这是对误差估计器实用性的最终检验。您将实现并比较不同估计器——一种基于恢复的方法和一种基于残差的方法——在一个涉及应变局部化的复杂岩土力学场景中的性能。本练习旨在强调评估估计器“有效性”的重要性，以确保其在指导自适应网格细化时的可靠性。",
            "id": "3499414",
            "problem": "考虑一个饱和黏土的二维平面应变小变形模型，该黏土正在经历伴有应变局部化的弹黏塑性蠕变。域为单位正方形，空间坐标 $(x,y) \\in [0,1] \\times [0,1]$，单位为米。运动学基于小应变定义，其中位移场为 $(u(x,y),v(x,y))$，小应变张量定义为 $\\varepsilon_{xx} = \\partial u/\\partial x$、$\\varepsilon_{yy} = \\partial v/\\partial y$，工程剪切应变为 $\\gamma_{xy} = \\partial u/\\partial y + \\partial v/\\partial x$。我们考虑一个制造位移场，该位移场捕捉了沿 $y = 0.5$ 水平带的局部化现象：\n$$\nu(x,y) = U_0 x + A \\exp\\left(-\\frac{(y-0.5)^2}{2 w^2}\\right) x, \\quad v(x,y) = 0,\n$$\n其中 $U_0$ 是均匀拉伸应变幅值，$A$ 是局部化幅值，$w$ 控制局部化宽度。材料遵循线弹性，其平面应变模量在局部化带内软化：\n$$\nE(y) = E_0 \\left(1 - s \\exp\\left(-\\frac{(y-0.5)^2}{2 w^2}\\right)\\right), \\quad \\nu = \\text{constant},\n$$\n其中 $E_0$ 是基础杨氏模量，$s \\in [0,1)$ 是一个软化参数，表示由于黏塑性蠕变和局部化导致的峰后刚度降低。平面应变的应力-应变关系为 $\\boldsymbol{\\sigma} = \\mathbf{D}(y)\\,\\boldsymbol{\\varepsilon}$，其中本构矩阵 $\\mathbf{D}(y)$ 由拉梅参数 $\\lambda(y) = \\frac{\\nu E(y)}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu(y) = \\frac{E(y)}{2(1+\\nu)}$ 定义，并且\n$$\n\\mathbf{D}(y) = \\begin{bmatrix}\n\\lambda(y) + 2\\mu(y)  \\lambda(y)  0\\\\\n\\lambda(y)  \\lambda(y) + 2\\mu(y)  0\\\\\n0  0  \\mu(y)\n\\end{bmatrix}\n$$\n作用于Voigt应变向量 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$。精确的体力场 $\\mathbf{f}(x,y)$ 是通过强形式的平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\text{exact}} + \\mathbf{f} = \\mathbf{0}$ 对精确应力场 $\\boldsymbol{\\sigma}^{\\text{exact}}(x,y)$ 强制施加平衡而构造的，从而使制造解保持一致。\n\n您的任务是使用结构化三角剖分对域进行离散化，并在单个准静态快照下，评估两种自适应网格细化误差估计器在能量范数下的可靠性，评估涵盖局部化的三个阶段：局部化前、开始和峰后软化。使用精确位移场的节点采样来定义线性三角形上的分片线性有限元近似 $(u_h,v_h)$；在单元质心处计算单元应变 $\\boldsymbol{\\varepsilon}_h$ 和应力 $\\boldsymbol{\\sigma}_h$。根据制造场在质心处定义精确应变 $\\boldsymbol{\\varepsilon}^{\\text{exact}}$，并令单元刚度为质心坐标 $y_c$ 处的 $\\mathbf{D}(y_c)$。真实能量范数误差近似为\n$$\n\\|e\\|^2 \\approx \\sum_{K} |K|\\,\\left(\\boldsymbol{\\varepsilon}^{\\text{exact}}_K - \\boldsymbol{\\varepsilon}_{h,K}\\right)^\\top \\mathbf{D}_K \\left(\\boldsymbol{\\varepsilon}^{\\text{exact}}_K - \\boldsymbol{\\varepsilon}_{h,K}\\right),\n$$\n其中 $|K|$ 是单元面积，$\\mathbf{D}_K = \\mathbf{D}(y_c)$。\n\n实现并基准测试以下误差估计器：\n\n1. 基于Zienkiewicz–Zhu恢复的估计器：通过相邻单元应力 $\\boldsymbol{\\sigma}_h$ 的面积加权平均恢复节点应力 $\\boldsymbol{\\sigma}^*$，插值到单元质心以获得 $\\boldsymbol{\\sigma}^*_K$，并计算\n$$\n\\eta_{\\text{ZZ}}^2 \\approx \\sum_{K} |K|\\,\\left(\\boldsymbol{\\sigma}^*_K - \\boldsymbol{\\sigma}_{h,K}\\right)^\\top \\mathbf{C}_K \\left(\\boldsymbol{\\sigma}^*_K - \\boldsymbol{\\sigma}_{h,K}\\right),\n$$\n其中 $\\mathbf{C}_K = \\mathbf{D}_K^{-1}$ 是 $y_c$ 处的柔度矩阵。\n\n2. 平衡残差估计器（简化的残差-跳跃形式）：近似\n$$\n\\eta_{\\text{ER}}^2 \\approx \\sum_{K} |K|\\, h_K^2\\,\\|\\mathbf{f}_K + \\nabla \\cdot \\boldsymbol{\\sigma}_{h,K}\\|^2 + \\sum_{e \\in \\mathcal{E}_{\\text{int}}} h_e\\,\\|\\llbracket \\boldsymbol{\\sigma}_h \\mathbf{n}_e \\rrbracket\\|^2,\n$$\n其中 $h_K = \\sqrt{|K|}$，$\\mathbf{f}_K$ 是单元质心处的精确体力，对于线性三角形上的分片常数应力，$\\nabla \\cdot \\boldsymbol{\\sigma}_{h,K} = \\mathbf{0}$，$\\mathcal{E}_{\\text{int}}$ 表示内部边的集合，$h_e$ 是边长，$\\mathbf{n}_e$ 是边 $e$ 的单位法向量，$\\llbracket \\cdot \\rrbracket$ 表示跨边 $e$ 的牵引力跳跃，使用一致选择的 $\\mathbf{n}_e$ 进行计算。\n\n计算有效性指数\n$$\n\\theta_{\\text{ZZ}} = \\frac{\\eta_{\\text{ZZ}}}{\\|e\\|}, \\quad \\theta_{\\text{ER}} = \\frac{\\eta_{\\text{ER}}}{\\|e\\|}.\n$$\n有效性指数是无量纲的，应以浮点数形式报告。\n\n使用均匀三角剖分，将每个方形单元划分为两个三角形，共 $N_x \\times N_y$ 个单元，其中 $N_x = 20$ 且 $N_y = 20$。材料参数为 $E_0 = 50 \\times 10^6\\,\\mathrm{Pa}$ 和 $\\nu = 0.3$。测试套件由三组参数 $(U_0, A, w, s)$ 定义，分别代表：\n\n- 局部化前: $(U_0, A, w, s) = (0.01, 0.02, 0.20, 0.20)$。\n- 局部化开始: $(U_0, A, w, s) = (0.01, 0.02, 0.05, 0.60)$。\n- 峰后软化: $(U_0, A, w, s) = (0.01, 0.02, 0.01, 0.85)$。\n\n此计算不涉及角度。能量和应力在内部以帕斯卡和焦耳为单位计算，但要求的输出是无量纲的有效性指数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，按 $[\\theta_{\\text{ZZ}}^{(1)}, \\theta_{\\text{ER}}^{(1)}, \\theta_{\\text{ZZ}}^{(2)}, \\theta_{\\text{ER}}^{(2)}, \\theta_{\\text{ZZ}}^{(3)}, \\theta_{\\text{ER}}^{(3)}]$ 的顺序展平，其中上标 $(1),(2),(3)$ 对应于上面给出的三组参数。",
            "solution": "控制原理始于小应变运动学、平面应变中的线弹性本构行为和静力平衡。我们采用制造解方法来锚定一个体现黏土中黏塑性局部化的精确位移场，然后推导出一个确保精确平衡的一致体力场，从而可以在不求解完整非线性问题的情况下对误差估计器进行受控的基准测试。\n\n首先，定义小变形下位移场 $(u(x,y),v(x,y))$ 的小应变度量。工程剪切应变为 $\\gamma_{xy} = \\partial u/\\partial y + \\partial v/\\partial x$。对于平面应变线弹性，应力-应变关系为 $\\boldsymbol{\\sigma} = \\mathbf{D}(y)\\,\\boldsymbol{\\varepsilon}$，其中 $\\mathbf{D}(y)$ 通过拉梅参数 $\\lambda(y)$ 和 $\\mu(y)$ 依赖于 $E(y)$ 和泊松比 $\\nu$：\n$$\n\\lambda(y) = \\frac{\\nu E(y)}{(1+\\nu)(1-2\\nu)}, \\quad \\mu(y) = \\frac{E(y)}{2(1+\\nu)}.\n$$\n在Voigt表示法 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$ 中，本构矩阵为\n$$\n\\mathbf{D}(y) = \\begin{bmatrix}\n\\lambda(y) + 2\\mu(y)  \\lambda(y)  0\\\\\n\\lambda(y)  \\lambda(y) + 2\\mu(y)  0\\\\\n0  0  \\mu(y)\n\\end{bmatrix}.\n$$\n我们定义一个捕捉沿 $y=0.5$ 局部化的精确位移：\n$$\nu(x,y) = U_0 x + A\\,g(y)\\,x, \\quad v(x,y) = 0, \\quad g(y) = \\exp\\left(-\\frac{(y-0.5)^2}{2w^2}\\right).\n$$\n相应的精确应变分量为\n$$\n\\varepsilon_{xx}^{\\text{exact}} = \\frac{\\partial u}{\\partial x} = U_0 + A g(y), \\quad \\varepsilon_{yy}^{\\text{exact}} = 0, \\quad \\gamma_{xy}^{\\text{exact}} = \\frac{\\partial u}{\\partial y} = A x g(y) c(y),\n$$\n其中 $c(y) = -\\frac{y-0.5}{w^2}$。平衡所需的导数为\n$$\n\\frac{\\partial \\varepsilon_{xx}^{\\text{exact}}}{\\partial y} = A g(y) c(y), \\quad \\frac{\\partial \\gamma_{xy}^{\\text{exact}}}{\\partial y} = A x g(y)\\left(c(y)^2 - \\frac{1}{w^2}\\right), \\quad \\frac{\\partial \\gamma_{xy}^{\\text{exact}}}{\\partial x} = A g(y) c(y).\n$$\n弹性模量通过以下方式在带内软化\n$$\nE(y) = E_0 \\big(1 - s g(y)\\big), \\quad E'(y) = -E_0 s g(y) c(y),\n$$\n得到导数 $\\mu'(y) = \\frac{E'(y)}{2(1+\\nu)}$ 和 $\\lambda'(y) = \\frac{\\nu E'(y)}{(1+\\nu)(1-2\\nu)}$。\n\n静力平衡要求精确体力 $\\mathbf{f}(x,y) = [f_x(x,y), f_y(x,y)]^\\top$ 满足 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\text{exact}} + \\mathbf{f} = \\mathbf{0}$，其中 $\\boldsymbol{\\sigma}^{\\text{exact}} = \\mathbf{D}(y)\\,\\boldsymbol{\\varepsilon}^{\\text{exact}}$。利用对 $y$ 的依赖性，我们得到\n$$\nf_x = -\\left(\\frac{\\partial \\sigma_{xx}^{\\text{exact}}}{\\partial x} + \\frac{\\partial \\sigma_{xy}^{\\text{exact}}}{\\partial y}\\right) = -\\left( \\mu'(y)\\,\\gamma_{xy}^{\\text{exact}} + \\mu(y)\\,\\frac{\\partial \\gamma_{xy}^{\\text{exact}}}{\\partial y} \\right),\n$$\n$$\nf_y = -\\left(\\frac{\\partial \\sigma_{yx}^{\\text{exact}}}{\\partial x} + \\frac{\\partial \\sigma_{yy}^{\\text{exact}}}{\\partial y}\\right) = -\\left( \\mu(y)\\,\\frac{\\partial \\gamma_{xy}^{\\text{exact}}}{\\partial x} + \\lambda'(y)\\,\\varepsilon_{xx}^{\\text{exact}} + \\lambda(y)\\,\\frac{\\partial \\varepsilon_{xx}^{\\text{exact}}}{\\partial y} \\right),\n$$\n因为对于制造场，$\\frac{\\partial \\sigma_{xx}^{\\text{exact}}}{\\partial x} = 0$ 且 $\\sigma_{yy}^{\\text{exact}} = \\lambda(y)\\,\\varepsilon_{xx}^{\\text{exact}}$（其中 $\\varepsilon_{yy}^{\\text{exact}} = 0$）。\n\n我们将单位正方形离散为 $N_x \\times N_y$ 个矩形单元，沿对角线将每个单元分割成两个三角形，并通过在节点处采样精确位移 $(u,v)$ 来分配节点位移。对于每个具有节点 $(x_i,y_i)$（$i=1,2,3$）的三角形 $K$，从几何形状计算线性形函数的梯度 $\\nabla N_i$；利用节点值 $u_i$ 和 $v_i$，单元应变为\n$$\n\\varepsilon_{xx,h} = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial x} u_i, \\quad \\varepsilon_{yy,h} = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial y} v_i, \\quad \\gamma_{xy,h} = \\sum_{i=1}^{3}\\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right).\n$$\n我们在单元质心 $(x_c,y_c)$ 处计算精确应变 $\\boldsymbol{\\varepsilon}^{\\text{exact}}$ 和刚度 $\\mathbf{D}_K = \\mathbf{D}(y_c)$。单元应力为 $\\boldsymbol{\\sigma}_{h,K} = \\mathbf{D}_K \\boldsymbol{\\varepsilon}_{h,K}$。真实能量范数误差通过基于质心的求积近似为\n$$\n\\|e\\|^2 \\approx \\sum_{K} |K|\\, (\\boldsymbol{\\varepsilon}^{\\text{exact}}_K - \\boldsymbol{\\varepsilon}_{h,K})^\\top \\mathbf{D}_K (\\boldsymbol{\\varepsilon}^{\\text{exact}}_K - \\boldsymbol{\\varepsilon}_{h,K}).\n$$\n\n对于Zienkiewicz–Zhu恢复估计器，我们通过相邻单元应力的面积加权平均计算节点恢复应力 $\\boldsymbol{\\sigma}^*$；将其插值到质心（对于线性三角形，质心值是三个节点值的平均值），我们得到 $\\boldsymbol{\\sigma}^*_K$。柔度 $\\mathbf{C}_K = \\mathbf{D}_K^{-1}$ 产生估计器\n$$\n\\eta_{\\text{ZZ}}^2 \\approx \\sum_{K} |K|\\, (\\boldsymbol{\\sigma}^*_K - \\boldsymbol{\\sigma}_{h,K})^\\top \\mathbf{C}_K (\\boldsymbol{\\sigma}^*_K - \\boldsymbol{\\sigma}_{h,K}).\n$$\n\n对于残差-跳跃近似中的平衡残差估计器，当 $\\boldsymbol{\\sigma}_{h,K}$ 为分片常数时，我们在 $K$ 内部有 $\\nabla \\cdot \\boldsymbol{\\sigma}_{h,K} = \\mathbf{0}$。每个单元的体力为 $\\mathbf{f}_K = \\mathbf{f}(x_c,y_c)$。对于由三角形 $K$ 和 $L$ 共享的内部边 $e$，其单位法向量为 $\\mathbf{n}_e$，定义牵引力跳跃\n$$\n\\llbracket \\boldsymbol{\\sigma}_h \\mathbf{n}_e \\rrbracket = (\\boldsymbol{\\sigma}_{h,K} - \\boldsymbol{\\sigma}_{h,L})\\,\\mathbf{n}_e.\n$$\n估计器为\n$$\n\\eta_{\\text{ER}}^2 \\approx \\sum_{K} |K|\\, h_K^2 \\|\\mathbf{f}_K\\|^2 + \\sum_{e \\in \\mathcal{E}_{\\text{int}}} h_e \\| \\llbracket \\boldsymbol{\\sigma}_h \\mathbf{n}_e \\rrbracket \\|^2,\n$$\n其中 $h_K = \\sqrt{|K|}$，$h_e$ 为边长。\n\n有效性指数定义为\n$$\n\\theta_{\\text{ZZ}} = \\frac{\\eta_{\\text{ZZ}}}{\\|e\\|}, \\quad \\theta_{\\text{ER}} = \\frac{\\eta_{\\text{ER}}}{\\|e\\|}.\n$$\n这些指数是无量纲的，用于量化可靠性：接近1的值表示对真实误差的准确估计。为了探究局部化开始和峰后软化期间的可靠性，我们在保持 $E_0$ 和 $\\nu$ 固定的情况下，对三个案例改变 $(U_0, A, w, s)$，并计算这些指数。程序构建网格，组装单元量，计算恢复的节点应力，构造用于跳跃的边集，并使用基于质心的积分评估估计器和真实误差。最后，它输出一行，包含按指定顺序排列的六个浮点有效性指数，这些指数根据其构造是无量纲的。\n\n**实施代码**\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef create_mesh(nx, ny):\n    \"\"\"\n    Create a structured triangular mesh over [0,1]x[0,1].\n    Each cell is split into two triangles: lower-left and upper-right.\n    Returns:\n        nodes: (N,2) array of coordinates\n        elements: list of triangles, each as a tuple of 3 node indices\n        cell_map: mapping from cell indices to pairs of element indices (not used)\n    \"\"\"\n    xs = np.linspace(0.0, 1.0, nx+1)\n    ys = np.linspace(0.0, 1.0, ny+1)\n    nodes = np.array([(x, y) for y in ys for x in xs])\n    def node_id(i, j):\n        return j*(nx+1) + i\n    elements = []\n    for j in range(ny):\n        for i in range(nx):\n            n00 = node_id(i, j)\n            n10 = node_id(i+1, j)\n            n01 = node_id(i, j+1)\n            n11 = node_id(i+1, j+1)\n            # Triangle 1: (i,j)-(i+1,j)-(i,j+1)\n            elements.append((n00, n10, n01))\n            # Triangle 2: (i+1,j)-(i+1,j+1)-(i,j+1)\n            elements.append((n10, n11, n01))\n    return nodes, elements\n\ndef triangle_area_and_centroid(p1, p2, p3):\n    x1, y1 = p1; x2, y2 = p2; x3, y3 = p3\n    area = 0.5 * abs((x2-x1)*(y3-y1) - (x3-x1)*(y2-y1))\n    cx = (x1 + x2 + x3) / 3.0\n    cy = (y1 + y2 + y3) / 3.0\n    return area, cx, cy\n\ndef shape_function_gradients(p1, p2, p3):\n    # Gradients of linear shape functions for triangle\n    x1, y1 = p1; x2, y2 = p2; x3, y3 = p3\n    detJ = (x2 - x1)*(y3 - y1) - (x3 - x1)*(y2 - y1)\n    area = 0.5 * detJ\n    # Using formula dNi/dx = (yj+ yk difference)/ (2A), dNi/dy = (xk - xj)/(2A)\n    # For N1 (opposite node 1): indices (2,3)\n    dN1dx = (y2 - y3) / (2.0 * area)\n    dN1dy = (x3 - x2) / (2.0 * area)\n    # N2 (opposite node 2): indices (3,1)\n    dN2dx = (y3 - y1) / (2.0 * area)\n    dN2dy = (x1 - x3) / (2.0 * area)\n    # N3 (opposite node 3): indices (1,2)\n    dN3dx = (y1 - y2) / (2.0 * area)\n    dN3dy = (x2 - x1) / (2.0 * area)\n    dNdx = np.array([dN1dx, dN2dx, dN3dx])\n    dNdy = np.array([dN1dy, dN2dy, dN3dy])\n    return dNdx, dNdy\n\ndef gaussian_band(y, w):\n    return np.exp(-((y - 0.5) ** 2) / (2.0 * w ** 2))\n\ndef E_of_y(y, E0, s, w):\n    return E0 * (1.0 - s * gaussian_band(y, w))\n\ndef dE_dy(y, E0, s, w):\n    g = gaussian_band(y, w)\n    c = -(y - 0.5) / (w ** 2)\n    return -E0 * s * g * c\n\ndef lame_parameters(E, nu):\n    lam = nu * E / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu = E / (2.0 * (1.0 + nu))\n    return lam, mu\n\ndef d_lame_dy(Ep, nu):\n    lam_p = nu * Ep / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu_p = Ep / (2.0 * (1.0 + nu))\n    return lam_p, mu_p\n\ndef D_matrix(E, nu):\n    lam, mu = lame_parameters(E, nu)\n    D = np.array([[lam + 2.0 * mu, lam, 0.0],\n                  [lam, lam + 2.0 * mu, 0.0],\n                  [0.0, 0.0, mu]])\n    return D\n\ndef exact_strain_and_derivatives(x, y, U0, A, w):\n    g = gaussian_band(y, w)\n    c = -(y - 0.5) / (w ** 2)\n    exx = U0 + A * g\n    eyy = 0.0\n    gamma = A * x * g * c\n    d_exx_dy = A * g * c\n    d_gamma_dy = A * x * g * (c**2 - 1.0/(w**2))\n    d_gamma_dx = A * g * c\n    return exx, eyy, gamma, d_exx_dy, d_gamma_dy, d_gamma_dx\n\ndef body_force(x, y, U0, A, w, E0, s, nu):\n    exx, _, gamma, d_exx_dy, d_gamma_dy, d_gamma_dx = exact_strain_and_derivatives(x, y, U0, A, w)\n    E = E_of_y(y, E0, s, w)\n    Ep = dE_dy(y, E0, s, w)\n    lam, mu = lame_parameters(E, nu)\n    lam_p, mu_p = d_lame_dy(Ep, nu)\n    fx = - (mu_p * gamma + mu * d_gamma_dy)\n    fy = - (mu * d_gamma_dx + lam_p * exx + lam * d_exx_dy)\n    return np.array([fx, fy])\n\ndef compute_element_strain(p1, p2, p3, u_vals, v_vals):\n    dNdx, dNdy = shape_function_gradients(p1, p2, p3)\n    # u_vals, v_vals are vectors of length 3\n    exx = np.dot(dNdx, u_vals)\n    eyy = np.dot(dNdy, v_vals)\n    gamma = np.dot(dNdy, u_vals) + np.dot(dNdx, v_vals)\n    return np.array([exx, eyy, gamma])\n\ndef build_edge_list(elements, nodes):\n    \"\"\"\n    Build edges with adjacency and geometric data.\n    Returns dict: key=(min_i,max_j) -> {'tris':[k,l], 'length':h_e, 'normal':n_e}\n    For boundary edges, 'tris' will have one triangle.\n    \"\"\"\n    edge_dict = {}\n    for k, tri in enumerate(elements):\n        tri_nodes = list(tri)\n        # edges as pairs\n        edges = [(tri_nodes[0], tri_nodes[1]),\n                 (tri_nodes[1], tri_nodes[2]),\n                 (tri_nodes[2], tri_nodes[0])]\n        for (i, j) in edges:\n            key = (min(i, j), max(i, j))\n            pi = nodes[i]; pj = nodes[j]\n            edge_vec = pj - pi\n            length = np.linalg.norm(edge_vec)\n            # Unit normal: rotate edge_vec by +90 degrees\n            if length > 0:\n                n = np.array([ -edge_vec[1], edge_vec[0] ]) / length\n            else:\n                n = np.array([0.0, 0.0])\n            if key not in edge_dict:\n                edge_dict[key] = {'tris': [k], 'length': length, 'normal': n}\n            else:\n                edge_dict[key]['tris'].append(k)\n    return edge_dict\n\ndef compute_effectivities(nx=20, ny=20, E0=50e6, nu=0.3, param_sets=None):\n    nodes, elements = create_mesh(nx, ny)\n    # Precompute element geometry\n    elem_geo = []\n    for tri in elements:\n        p1 = nodes[tri[0]]; p2 = nodes[tri[1]]; p3 = nodes[tri[2]]\n        area, cx, cy = triangle_area_and_centroid(p1, p2, p3)\n        elem_geo.append((area, cx, cy))\n    edge_dict = build_edge_list(elements, nodes)\n    results = []\n    # Node adjacency for ZZ recovery\n    node_to_elems = [[] for _ in range(len(nodes))]\n    for k, tri in enumerate(elements):\n        for ni in tri:\n            node_to_elems[ni].append(k)\n    # Loop over parameter sets\n    for (U0, A, w, s) in param_sets:\n        # Nodal displacements sampled from exact field\n        u_node = np.zeros(len(nodes))\n        v_node = np.zeros(len(nodes))\n        for i, (x, y) in enumerate(nodes):\n            u_node[i] = U0 * x + A * gaussian_band(y, w) * x\n            v_node[i] = 0.0\n        # Element strains, stresses, exact strains, D, C, and body forces\n        eps_h = []\n        sig_h = []\n        eps_exact = []\n        D_list = []\n        C_list = []\n        f_list = []\n        e_true_sq = 0.0\n        for k, tri in enumerate(elements):\n            p1 = nodes[tri[0]]; p2 = nodes[tri[1]]; p3 = nodes[tri[2]]\n            area, cx, cy = elem_geo[k]\n            u_vals = np.array([u_node[tri[0]], u_node[tri[1]], u_node[tri[2]]])\n            v_vals = np.array([v_node[tri[0]], v_node[tri[1]], v_node[tri[2]]])\n            eps_k = compute_element_strain(p1, p2, p3, u_vals, v_vals)\n            exx, eyy, gamma, _, _, _ = exact_strain_and_derivatives(cx, cy, U0, A, w)\n            eps_ex_k = np.array([exx, eyy, gamma])\n            E = E_of_y(cy, E0, s, w)\n            Dk = D_matrix(E, nu)\n            Ck = np.linalg.inv(Dk)\n            sig_k = Dk @ eps_k\n            # Body force at centroid\n            f_k = body_force(cx, cy, U0, A, w, E0, s, nu)\n            # True energy error contribution\n            de = eps_ex_k - eps_k\n            e_true_sq += area * (de @ (Dk @ de))\n            # Store\n            eps_h.append(eps_k)\n            eps_exact.append(eps_ex_k)\n            sig_h.append(sig_k)\n            D_list.append(Dk)\n            C_list.append(Ck)\n            f_list.append(f_k)\n        eps_h = np.array(eps_h)\n        eps_exact = np.array(eps_exact)\n        sig_h = np.array(sig_h)\n        D_list = np.array(D_list)\n        C_list = np.array(C_list)\n        f_list = np.array(f_list)\n        # ZZ recovery: nodal recovered stress by area-weighted averaging of adjacent element stresses\n        # Compute element areas for weights\n        areas = np.array([ag[0] for ag in elem_geo])\n        sigma_star_node = np.zeros((len(nodes), 3))\n        for i in range(len(nodes)):\n            elems = node_to_elems[i]\n            if len(elems) == 0:\n                continue\n            wts = areas[elems]\n            svals = sig_h[elems]\n            sigma_star_node[i, :] = np.average(svals, axis=0, weights=wts)\n        # Interpolate recovered stress to element centroids: average of node recovered stresses\n        sigma_star_elem = np.zeros_like(sig_h)\n        for k, tri in enumerate(elements):\n            sigma_star_elem[k, :] = (sigma_star_node[tri[0], :] +\n                                     sigma_star_node[tri[1], :] +\n                                     sigma_star_node[tri[2], :]) / 3.0\n        # Compute ZZ estimator\n        eta_ZZ_sq = 0.0\n        for k in range(len(elements)):\n            area, _, _ = elem_geo[k]\n            dsig = sigma_star_elem[k, :] - sig_h[k, :]\n            Ck = C_list[k]\n            eta_ZZ_sq += area * (dsig @ (Ck @ dsig))\n        # Residual-jump estimator\n        # Element residual term: div sigma_h is zero (constant), so residual f_K only\n        eta_ER_sq = 0.0\n        for k in range(len(elements)):\n            area, _, _ = elem_geo[k]\n            hK = np.sqrt(area)\n            R = f_list[k]  # vector residual\n            eta_ER_sq += area * (hK**2) * (R @ R)\n        # Edge jump term\n        for key, data in edge_dict.items():\n            tris = data['tris']\n            if len(tris) == 2:\n                k, l = tris\n                n = data['normal']\n                he = data['length']\n                # Traction jump: (sigma_k - sigma_l) * n\n                # Build full 2x2 stress tensors from Voigt [xx,yy,xy]\n                sigK = sig_h[k, :]\n                sigL = sig_h[l, :]\n                S_K = np.array([[sigK[0], sigK[2]],\n                                [sigK[2], sigK[1]]])\n                S_L = np.array([[sigL[0], sigL[2]],\n                                [sigL[2], sigL[1]]])\n                jump = (S_K - S_L) @ n\n                eta_ER_sq += he * (jump @ jump)\n        # Effectivity indices\n        e_true = np.sqrt(max(e_true_sq, 0.0))\n        eta_ZZ = np.sqrt(max(eta_ZZ_sq, 0.0))\n        eta_ER = np.sqrt(max(eta_ER_sq, 0.0))\n        # Guard against zero true error (unlikely but for completeness)\n        if e_true > 0:\n            theta_ZZ = eta_ZZ / e_true\n            theta_ER = eta_ER / e_true\n        else:\n            theta_ZZ = float('inf')\n            theta_ER = float('inf')\n        results.append((theta_ZZ, theta_ER))\n    return results\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each parameter set is (U0, A, w, s)\n    test_cases = [\n        (0.01, 0.02, 0.20, 0.20),  # Pre-localization\n        (0.01, 0.02, 0.05, 0.60),  # Onset of localization\n        (0.01, 0.02, 0.01, 0.85),  # Post-peak softening\n    ]\n    results_pairs = compute_effectivities(nx=20, ny=20, E0=50e6, nu=0.3, param_sets=test_cases)\n    # Flatten as [theta_ZZ_1, theta_ER_1, theta_ZZ_2, theta_ER_2, theta_ZZ_3, theta_ER_3]\n    flat_results = []\n    for (theta_ZZ, theta_ER) in results_pairs:\n        flat_results.append(theta_ZZ)\n        flat_results.append(theta_ER)\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, flat_results))}]\")\n\n# The original problem asks for the output as a string. To generate it, one would run solve().\n# solve()\n```",
            "answer": "```\n[0.6401034484915664,2.379201542460673,0.8529068045958615,5.187843336706911,1.1578135835694212,17.20239031730999]\n```"
        }
    ]
}