{
    "hands_on_practices": [
        {
            "introduction": "Understanding the 'why' behind stabilization begins with recognizing the numerical pathologies that can arise in finite element simulations. This first exercise challenges you to distinguish between two common but distinct issues in the simulation of nearly incompressible materials: volumetric locking and pressure instability. By correctly identifying the cause, manifestation, and remedy for each, you will build a solid conceptual foundation for appreciating the role and design of stabilized mixed formulations. ",
            "id": "3562752",
            "problem": "Consider small-strain linear elasticity on a bounded domain $\\Omega \\subset \\mathbb{R}^d$ with body force $\\boldsymbol{f}$ and traction $\\boldsymbol{t}$ on a portion of the boundary. The balance of linear momentum in the absence of inertia is $\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u}) + \\boldsymbol{f} = \\boldsymbol{0}$ in $\\Omega$, with the Cauchy stress for an isotropic linear elastic material given by $\\boldsymbol{\\sigma}(\\boldsymbol{u}) = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$, where $\\boldsymbol{u}$ is displacement, $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\top)$ is the infinitesimal strain, $\\mu$ and $\\lambda$ are the Lamé parameters, and $\\boldsymbol{I}$ is the identity tensor. The bulk modulus is $\\kappa = \\lambda + \\tfrac{2}{3}\\mu$, and the Poisson ratio $\\nu \\to 0.5$ corresponds to the nearly incompressible limit $\\kappa \\gg \\mu$ in which the volumetric strain $\\varepsilon_v = \\nabla \\cdot \\boldsymbol{u}$ is nearly zero. A common mixed displacement–pressure formulation introduces the pressure $p \\approx -\\kappa \\varepsilon_v$ as an independent unknown and enforces the incompressibility constraint weakly, leading to a saddle-point problem with bilinear forms $a(\\boldsymbol{u},\\boldsymbol{v}) = 2\\mu \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega$ and $b(\\boldsymbol{v},q) = -\\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega$. In the Finite Element Method (FEM), the choice of discrete spaces for $\\boldsymbol{u}$ and $p$ affects both accuracy and stability. The Ladyzhenskaya–Babuška–Brezzi (LBB) condition is the stability requirement that the discrete inf–sup constant be uniformly bounded away from zero with respect to the mesh size.\n\nWithin this context, define volumetric locking for nearly incompressible elasticity and distinguish it from pressure checkerboarding that may arise in equal-order mixed discretizations (for example, continuous piecewise linear $\\mathbb{P}_1/\\mathbb{P}_1$ pairs). Then, select all statements that correctly capture these phenomena and clearly differentiate their causes, manifestations, and remedies.\n\nA. Volumetric locking is a loss of uniform accuracy as $\\kappa \\to \\infty$ in displacement-based discretizations that over-constrain the volumetric strain, producing an artificially stiff global response and poor displacement convergence unless special techniques (such as $\\bar{B}$ formulations or mixed methods) are used; it does not, by itself, imply oscillatory pressure fields.\n\nB. Pressure checkerboarding is a manifestation of violating the discrete inf–sup condition for the displacement–pressure pair (for example, equal-order continuous interpolation), leading to spurious, mesh-level oscillations in $p$ that alternate between neighboring elements, even when the mean pressure is accurate.\n\nC. Both volumetric locking and pressure checkerboarding are caused solely by under-integration of the volumetric term, and using full integration removes both pathologies without changing the approximation spaces.\n\nD. Pressure checkerboarding generally causes the global response to be overly stiff in the incompressible limit, while volumetric locking produces oscillatory pressure fields but not stiffness errors.\n\nE. Stabilization methods that add consistent pressure-gradient jump or residual-based terms to the discrete mixed formulation target the inf–sup deficiency and can suppress checkerboard modes for equal-order pairs, whereas they do not, by themselves, cure locking in a pure displacement formulation.\n\nF. Using a mixed formulation with an inf–sup stable pair (for example, Taylor–Hood $\\mathbb{P}_2/\\mathbb{P}_1$) removes both checkerboarding and volumetric locking in the near-incompressible limit by representing the incompressibility constraint without over-constraining volumetric strains.\n\nSelect all that apply.",
            "solution": "The problem statement asks for the definitions and distinctions between volumetric locking and pressure checkerboarding in the context of finite element analysis of nearly incompressible linear elasticity, and to identify the correct statements describing these phenomena.\n\nFirst, let us establish the fundamental concepts based on the provided problem description. The problem concerns the numerical solution of the equations of linear elasticity in the nearly incompressible limit, where the Poisson ratio $\\nu \\to 0.5$. This limit corresponds to the bulk modulus $\\kappa$ being much larger than the shear modulus $\\mu$, i.e., $\\kappa \\gg \\mu$. The constitutive relation is $\\boldsymbol{\\sigma}(\\boldsymbol{u}) = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$. We can decompose the stress and strain into deviatoric and volumetric parts. The infinitesimal strain is $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, with volumetric strain $\\varepsilon_v = \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) = \\nabla \\cdot \\boldsymbol{u}$. The pressure is $p = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}) = -\\kappa \\varepsilon_v$. In the incompressible limit, $\\kappa \\to \\infty$, which forces the constraint $\\varepsilon_v = \\nabla \\cdot \\boldsymbol{u} = 0$.\n\n**Volumetric Locking**\nVolumetric locking is a numerical artifact that primarily affects standard displacement-based finite element formulations when dealing with nearly incompressible materials. In a displacement-based formulation, the stiffness matrix is derived from the strain energy, which contains a term proportional to $\\kappa (\\varepsilon_v)^2$. As $\\kappa \\to \\infty$, this term acts as a penalty to enforce the constraint $\\varepsilon_v = 0$. For a discrete displacement field $\\boldsymbol{u}_h$ from a finite element space $\\boldsymbol{V}_h$, the constraint becomes $\\nabla \\cdot \\boldsymbol{u}_h = 0$. For low-order elements (e.g., continuous piecewise linear, $\\mathbb{P}_1$), the space of discrete divergence-free functions $\\{\\boldsymbol{v}_h \\in \\boldsymbol{V}_h \\mid \\nabla \\cdot \\boldsymbol{v}_h = 0 \\text{ in } \\Omega\\}$ is too small, containing mostly trivial (e.g., zero or rigid body motion) solutions. This over-constrains the system. As a result, the discrete system becomes artificially stiff, leading to displacements that are orders of magnitude smaller than the correct solution. This pathology manifests as a severe loss of accuracy that worsens as $\\nu$ approaches $0.5$.\n\n**Pressure Checkerboarding**\nPressure checkerboarding is an instability that arises in mixed finite element formulations, where pressure $p$ is introduced as an independent field variable. The stability of such a formulation depends on the choice of discrete function spaces for displacement, $\\boldsymbol{V}_h$, and pressure, $Q_h$. Specifically, these spaces must satisfy the Ladyzhenskaya–Babuška–Brezzi (LBB) condition, also known as the inf–sup condition:\n$$\n\\inf_{q_h \\in Q_h/ \\mathbb{R}} \\sup_{\\boldsymbol{v}_h \\in \\boldsymbol{V}_h} \\frac{-\\int_{\\Omega} q_h (\\nabla \\cdot \\boldsymbol{v}_h) \\, \\mathrm{d}\\Omega}{\\|\\boldsymbol{v}_h\\|_{\\boldsymbol{V}} \\|q_h\\|_{Q/\\mathbb{R}}} \\ge \\beta > 0\n$$\nwhere $\\beta$ is a constant independent of the mesh size $h$. If this condition is violated, the discrete system can have spurious, non-physical pressure modes. These modes are often oscillatory, with a characteristic \"checkerboard\" pattern of alternating high and low pressure values in adjacent elements. These modes belong to the near-kernel of the discrete divergence operator, meaning they produce a near-zero value for the term $\\int_{\\Omega} p_h (\\nabla \\cdot \\boldsymbol{v}_h) \\, \\mathrm{d}\\Omega$ for all $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$, and thus contaminate the pressure solution without being controlled by the discrete equations. A classic example of an LBB-unstable pair is the use of equal-order continuous interpolations for displacement and pressure, such as $\\mathbb{P}_1/\\mathbb{P}_1$.\n\nNow we evaluate the given options.\n\n**A. Volumetric locking is a loss of uniform accuracy as $\\kappa \\to \\infty$ in displacement-based discretizations that over-constrain the volumetric strain, producing an artificially stiff global response and poor displacement convergence unless special techniques (such as $\\bar{B}$ formulations or mixed methods) are used; it does not, by itself, imply oscillatory pressure fields.**\nThis statement is an accurate and comprehensive description of volumetric locking. It correctly identifies its context (displacement-based methods), cause (over-constraining volumetric strain as $\\kappa \\to \\infty$), manifestation (artificial stiffness, poor displacement convergence), and common remedies ($\\bar{B}$ methods, mixed formulations). Crucially, it correctly distinguishes locking from checkerboarding by noting that locking is primarily a stiffness/displacement issue and does not intrinsically produce the oscillatory pressure patterns characteristic of a different type of instability.\n**Verdict: Correct.**\n\n**B. Pressure checkerboarding is a manifestation of violating the discrete inf–sup condition for the displacement–pressure pair (for example, equal-order continuous interpolation), leading to spurious, mesh-level oscillations in $p$ that alternate between neighboring elements, even when the mean pressure is accurate.**\nThis statement provides a precise definition of pressure checkerboarding. It correctly attributes the phenomenon to the violation of the LBB (inf–sup) condition, gives the canonical example of an unstable pair ($\\mathbb{P}_1/\\mathbb{P}_1$), and accurately describes the resulting spurious pressure oscillations. The observation that the mean pressure can remain accurate while the field is polluted with zero-mean oscillatory modes is also correct.\n**Verdict: Correct.**\n\n**C. Both volumetric locking and pressure checkerboarding are caused solely by under-integration of the volumetric term, and using full integration removes both pathologies without changing the approximation spaces.**\nThis statement is incorrect on multiple counts. Volumetric locking is exacerbated by *full* integration in standard displacement elements; *under-integration* (or selective-reduced integration) is a technique used to *alleviate* locking. Pressure checkerboarding is caused by an unstable choice of approximation spaces, a deficiency that is not remedied by simply changing the quadrature rule from under-integration to full integration. The stability is a property of the function spaces themselves, not the accuracy of the integration.\n**Verdict: Incorrect.**\n\n**D. Pressure checkerboarding generally causes the global response to be overly stiff in the incompressible limit, while volumetric locking produces oscillatory pressure fields but not stiffness errors.**\nThis statement reverses the characteristics of the two phenomena. Volumetric locking is defined by the artificial stiffness and corresponding error in the displacement field. Pressure checkerboarding is defined by spurious oscillations in the pressure field. While an unstable mixed method can lead to a poorly conditioned or singular stiffness matrix, describing it as \"overly stiff\" is not its primary characteristic; \"locking\" is the term for the stiffness pathology. Conversely, attributing oscillatory pressures to locking and lack of stiffness errors is a direct contradiction of its definition.\n**Verdict: Incorrect.**\n\n**E. Stabilization methods that add consistent pressure-gradient jump or residual-based terms to the discrete mixed formulation target the inf–sup deficiency and can suppress checkerboard modes for equal-order pairs, whereas they do not, by themselves, cure locking in a pure displacement formulation.**\nThis statement accurately describes the purpose and scope of a major class of stabilization techniques for mixed methods. Methods like adding pressure-gradient jump penalties or Galerkin/Least-Squares (GLS) terms are specifically designed to amend LBB-unstable formulations (like $\\mathbb{P}_1/\\mathbb{P}_1$) to restore stability and eliminate checkerboarding. The statement is also correct in pointing out that these methods are specific to mixed formulations (as they operate on the pressure variable $p$ and the system of equations) and are not applicable to curing locking within a pure displacement-based formulation, which requires different techniques (like $\\bar{B}$).\n**Verdict: Correct.**\n\n**F. Using a mixed formulation with an inf–sup stable pair (for example, Taylor–Hood $\\mathbb{P}_2/\\mathbb{P}_1$) removes both checkerboarding and volumetric locking in the near-incompressible limit by representing the incompressibility constraint without over-constraining volumetric strains.**\nThis statement correctly identifies the most robust solution to both problems. Choosing an LBB-stable element pair, such as the Taylor-Hood element ($\\mathbb{P}_2$ velocity, $\\mathbb{P}_1$ pressure), guarantees stability against spurious pressure modes, thus eliminating checkerboarding. It also prevents volumetric locking because the mixed formulation treats the incompressibility constraint via a Lagrange multiplier ($p$) in a mathematically well-posed manner, ensuring the discrete constraint does not \"lock\" the displacement field. The stability of the pair ensures a proper balance between the degrees of freedom in the displacement and pressure spaces.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ABEF}$$"
        },
        {
            "introduction": "Having established the need for stabilization to cure pressure instabilities, the next critical question is how to design the stabilization parameter. A poorly chosen parameter can either fail to stabilize the system or introduce excessive artificial diffusion, harming accuracy. This practice guides you through the analytical reasoning required to select a robust stabilization parameter, $\\gamma_K$, that correctly scales with mesh size and material properties, ensuring the method is both stable and accurate. ",
            "id": "3562747",
            "problem": "Consider the mixed displacement–pressure formulation of quasi-static, linear, isotropic elasticity on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ with body force $\\boldsymbol{f}$. Let $\\boldsymbol{u}$ denote displacement and $p$ denote the scalar pressure (volumetric stress). The material is characterized by shear modulus $G$ and bulk modulus $K_b$. The weak mixed formulation seeks $(\\boldsymbol{u},p)$ such that, for all test functions $(\\boldsymbol{v},q)$,\n$$(a)\\quad \\int_{\\Omega} 2G\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v})\\, \\mathrm{d}x \\;-\\; \\int_{\\Omega} p\\, \\nabla\\cdot \\boldsymbol{v}\\, \\mathrm{d}x \\;=\\; \\int_{\\Omega} \\boldsymbol{f}\\cdot \\boldsymbol{v}\\, \\mathrm{d}x,$$\n$$(b)\\quad -\\int_{\\Omega} q\\, \\nabla\\cdot \\boldsymbol{u}\\, \\mathrm{d}x \\;-\\; \\int_{\\Omega} \\frac{1}{K_b}\\, p\\, q\\, \\mathrm{d}x \\;=\\; 0,$$\nwhere $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$. Suppose we discretize this system using a Finite Element Method (FEM) with equal-order continuous, piecewise linear elements for both $\\boldsymbol{u}$ and $p$ on a conforming simplicial mesh $\\mathcal{T}_h$ with element diameters $h_K$. Because equal-order pairs violate the Brezzi–Babuška inf–sup condition, we add a consistent pressure-gradient stabilization term of the form\n$$s_h(p_h,q_h) \\;=\\; \\sum_{K\\in \\mathcal{T}_h} \\gamma_K \\int_K \\nabla p_h \\cdot \\nabla q_h \\, \\mathrm{d}x,$$\nwith elementwise stabilization parameters $\\gamma_K > 0$. The goal is to choose $\\gamma_K$ to balance conditioning and accuracy uniformly with respect to mesh size and material parameters.\n\nUsing only foundational facts about (i) the structure of the mixed operator and its Schur complement, (ii) the Brezzi stability mechanism, and (iii) standard inverse inequalities for continuous piecewise linear functions, identify a robust strategy to select $\\gamma_K$ that:\n- scales correctly with $h_K$ to avoid over-stabilization and consistency loss as $h_K \\to 0$,\n- is insensitive to the near-incompressible limit $K_b \\to \\infty$,\n- equalizes the magnitude of the stabilization contribution $s_h(\\cdot,\\cdot)$ with the pressure Schur complement induced by the elasticity block so that the pressure subsystem is well-conditioned uniformly in $G$.\n\nWhich of the following prescriptions best satisfies these requirements?\n\nA. $\\gamma_K \\;=\\; c_0 \\,\\dfrac{h_K^2}{G}$, with $c_0$ a mesh- and material-independent constant of order $\\mathcal{O}(1)$ (e.g., $c_0 \\in [\\,10^{-1},\\,1\\,]$), optionally adjusted by an element shape-regularity factor that remains bounded above and below for shape-regular meshes.\n\nB. $\\gamma_K \\;=\\; c_0 \\, G \\, h_K^2$, choosing the stabilization strength to increase with stiffness so that the stabilization dominates in the nearly incompressible limit.\n\nC. $\\gamma_K \\;=\\; \\dfrac{c_0}{h_K}$, independent of material parameters, so that mesh refinement alone strengthens the stabilization to suppress spurious pressure modes.\n\nD. $\\gamma_K \\;=\\; c_0 \\, \\dfrac{K_b}{h_K^2}$, tying the stabilization to the bulk modulus to penalize pressure variations more strongly as the material approaches incompressibility.\n\nSelect the most appropriate option.",
            "solution": "We derive the appropriate scaling from first principles. The mixed system couples the symmetric, coercive elasticity bilinear form on displacements with the divergence constraint on pressures. The discrete inf–sup deficiency of equal-order elements can be compensated by adding a pressure-gradient stabilization $s_h(\\cdot,\\cdot)$ that is consistent and vanishes as $h_K \\to 0$ at the correct rate. The three fundamental ingredients are:\n\n(i) Structure of the mixed operator and Schur complement. Write the block system at the discrete level as\n$$\n\\begin{bmatrix}\nA & B^{\\top} \\\\\nB & -\\tfrac{1}{K_b} M_p\n\\end{bmatrix}\n\\begin{bmatrix}\n\\boldsymbol{u}_h \\\\ p_h\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\boldsymbol{f}_h \\\\ 0\n\\end{bmatrix},\n$$\nwhere $A$ is the discrete elasticity operator induced by $a(\\cdot,\\cdot) = \\int_{\\Omega} 2G\\, \\boldsymbol{\\varepsilon}(\\cdot):\\boldsymbol{\\varepsilon}(\\cdot)\\, \\mathrm{d}x$, $B$ encodes the discrete divergence, and $M_p$ is the $L^2$ mass matrix on pressures. Eliminating $\\boldsymbol{u}_h$ yields the discrete Schur complement on pressures:\n$$\nS_h \\;=\\; -\\tfrac{1}{K_b} M_p \\;-\\; B\\,A^{-1}\\,B^{\\top}.\n$$\nThe operator $B\\,A^{-1}\\,B^{\\top}$ represents the pressure-to-pressure map via the displacement compliance. Since $A$ scales with $G$ (i.e., $A \\sim G\\,K_u$, where $K_u$ is a dimensionless stiffness), it follows that $A^{-1}$ scales like $G^{-1}$ in energy units. Consequently, $B\\,A^{-1}\\,B^{\\top}$ scales like $G^{-1}$ times a pressure mass-like operator. Thus, uniformly in $K_b$ (including the limit $K_b \\to \\infty$), the pressure block receives an effective stabilization from mechanics that is of size $\\mathcal{O}(G^{-1})$.\n\n(ii) Role of stabilization. The added term $s_h(p_h,q_h) = \\sum_K \\gamma_K \\int_K \\nabla p_h \\cdot \\nabla q_h \\,\\mathrm{d}x$ should (a) control the pressure modes that violate the discrete inf–sup condition and (b) be consistent, so it must vanish in the limit $h_K \\to 0$ for smooth pressures. To compare $s_h$ to a mass-like control, we use inverse inequalities.\n\n(iii) Inverse inequalities for continuous piecewise linear functions. For $p_h$ piecewise linear on $K$, a standard inverse estimate gives\n$$\n\\|\\nabla p_h\\|_{0,K}^2 \\;\\le\\; C_{\\mathrm{inv}}\\, h_K^{-2}\\, \\|p_h\\|_{0,K}^2,\n$$\nwith $C_{\\mathrm{inv}}$ depending only on shape regularity. Hence,\n$$\ns_h(p_h,p_h) \\;=\\; \\sum_K \\gamma_K \\|\\nabla p_h\\|_{0,K}^2 \\;\\le\\; \\sum_K \\gamma_K\\, C_{\\mathrm{inv}}\\, h_K^{-2}\\, \\|p_h\\|_{0,K}^2.\n$$\nTherefore, choosing $\\gamma_K$ proportional to $h_K^2$ converts $s_h(\\cdot,\\cdot)$ into an $L^2$-like control with a coefficient proportional to the proportionality constant. In particular, if $\\gamma_K \\sim h_K^2 / G$, then\n$$\ns_h(p_h,p_h) \\;\\lesssim\\; \\sum_K \\big(h_K^2/G\\big)\\, h_K^{-2}\\, \\|p_h\\|_{0,K}^2 \\;\\sim\\; G^{-1}\\, \\|p_h\\|_{0,\\Omega}^2,\n$$\nmatching the $G^{-1}$ scaling of $B\\,A^{-1}\\,B^{\\top}$. This alignment balances the pressure Schur complement so that the overall pressure block remains well-conditioned independent of $G$ and the mesh size. Moreover, since $\\gamma_K \\propto h_K^2$, the stabilization term is high-order consistent: for smooth $p$, $\\|\\nabla p\\|_{0,K}^2$ is bounded while $\\gamma_K \\to 0$ as $h_K \\to 0$, avoiding over-stabilization.\n\nInsensitivity to $K_b$: In the nearly incompressible limit $K_b \\to \\infty$, the term $-(1/K_b)M_p$ vanishes, and the only material scaling left in the pressure Schur complement is that of $B\\,A^{-1}\\,B^{\\top} \\sim G^{-1}$. Choosing $\\gamma_K \\sim h_K^2 / G$ keeps the stabilization commensurate with this scale and thus robust to locking.\n\nWe now assess the options.\n\nOption A: $\\gamma_K = c_0\\, h_K^2/G$, with $c_0 = \\mathcal{O}(1)$. This exactly realizes the reasoning above. The choice $\\gamma_K \\propto h_K^2$ ensures consistency, while the division by $G$ matches the $G^{-1}$ scaling of the mechanical Schur complement. Incorporating only bounded shape-regularity adjustments preserves mesh independence. The choice is insensitive to $K_b$ and balances conditioning and accuracy. Verdict — Correct.\n\nOption B: $\\gamma_K = c_0\\, G\\, h_K^2$. This grows with $G$, so $s_h(p_h,p_h) \\lesssim G\\, \\|p_h\\|^2$, which overwhelms the natural $G^{-1}$ scale of $B\\,A^{-1}\\,B^{\\top}$ as $G$ increases. In the nearly incompressible regime (large $G$ relative to pressure scales), this over-stabilizes, degrading accuracy and potentially harming convergence by imposing an artificially stiff pressure gradient penalty. Verdict — Incorrect.\n\nOption C: $\\gamma_K = c_0/h_K$. This does not vanish as $h_K \\to 0$ in the sense required for gradient-based stabilization. Indeed, $s_h(p_h,p_h) \\lesssim (c_0/h_K)\\, h_K^{-2}\\, \\|p_h\\|^2 \\sim c_0\\, h_K^{-3}\\, \\|p_h\\|^2$ in $d=\\!3$ (and similar blow-up in other dimensions), which diverges upon refinement and destroys consistency. Moreover, it ignores material scaling and will not balance $B\\,A^{-1}\\,B^{\\top} \\sim G^{-1}$. Verdict — Incorrect.\n\nOption D: $\\gamma_K = c_0\\, K_b/h_K^2$. This choice makes $s_h(p_h,p_h)$ scale like $K_b\\, h_K^{-2}\\, \\|p_h\\|^2$, which diverges both as $h_K \\to 0$ and as $K_b \\to \\infty$. In the nearly incompressible limit, the stabilization dominates, causing locking-like behavior and ruining accuracy. It also violates the requirement that stabilization be insensitive to $K_b$ and that it vanish appropriately with mesh refinement. Verdict — Incorrect.\n\nTherefore, the robust and consistent strategy is to set $\\gamma_K$ proportional to $h_K^2$ and inversely proportional to $G$, with an $\\mathcal{O}(1)$ constant independent of mesh and material parameters, as in Option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Theory comes to life through implementation. This final hands-on practice moves from conceptual understanding and analytical design to direct computational verification. You will implement a stabilized mixed formulation for a simple one-dimensional problem and use numerical linear algebra to probe its stability, observing firsthand how an unstable system behaves and how the stabilization parameter, $\\tau$, restores well-posedness to the discrete operator. ",
            "id": "3562780",
            "problem": "Consider the one-dimensional mixed formulation of Darcy flow on the unit interval $\\left[0,1\\right]$, posed in first-order form with unknown flux $q$ and pressure $p$, derived from mass conservation and Darcy’s law. Starting from the fundamental balance $\\nabla \\cdot q = f$ and the constitutive relation $q = -\\kappa \\nabla p$ with constant hydraulic conductivity $\\kappa$, consider the stabilized equal-order discretization designed to assess the stability of the mixed operator. The goal is to assemble a discrete operator and estimate its stability by computing the smallest singular value of the operator, viewed as a proxy for the discrete inf-sup constant. You must write a complete, runnable program that assembles the operator described below and computes the smallest singular value $\\sigma_{\\min}$ for multiple parameter sets.\n\nThe weak formulation seeks $q$ and $p$ such that, for all admissible test functions $v$ and $w$,\n- the constitutive relation is enforced weakly, and\n- the mass balance is enforced weakly.\n\nIntroduce a pressure-gradient stabilization term with a nonnegative stabilization parameter $\\tau$, so that the stabilized bilinear form reads\n$$(q, v) + (p, \\nabla \\cdot v) + (\\nabla \\cdot q, w) + \\tau (\\nabla p, \\nabla w),$$\nwhere $(\\cdot,\\cdot)$ denotes the $L^2$ inner product on $\\left[0,1\\right]$. Impose homogeneous Dirichlet boundary conditions on pressure, $p(0)=0$ and $p(1)=0$, so that the pressure unknown is restricted to interior nodes only. Ignore the right-hand side and focus on the homogeneous operator to study stability.\n\nDiscretize the interval $\\left[0,1\\right]$ with a uniform mesh of $N$ elements, element size $h = 1/N$. Use continuous, piecewise-linear Lagrange basis functions for both flux $q$ and pressure $p$ (equal-order approximation). Let $\\{\\varphi_i\\}_{i=0}^{N}$ denote the flux basis functions and $\\{\\psi_j\\}_{j=0}^{N}$ the pressure basis functions, with pressure degrees of freedom restricted to the interior nodes $\\{1,\\dots,N-1\\}$ after enforcing $p(0)=p(1)=0$. Assemble the following block matrix for the discrete operator $A \\in \\mathbb{R}^{(N+1 + N-1)\\times(N+1 + N-1)}$:\n$$\nA = \\begin{bmatrix}\nM_q & G \\\\\nG^\\top & \\tau K_p\n\\end{bmatrix},\n$$\nwhere:\n- $M_q \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ is the flux mass matrix with entries $(M_q)_{ik} = \\int_0^1 \\varphi_i \\varphi_k \\, dx$,\n- $K_p \\in \\mathbb{R}^{(N-1)\\times(N-1)}$ is the pressure stiffness matrix with entries $(K_p)_{j\\ell} = \\int_0^1 \\nabla \\psi_j \\cdot \\nabla \\psi_\\ell \\, dx$, assembled only over interior pressure nodes,\n- $G \\in \\mathbb{R}^{(N+1)\\times(N-1)}$ is the coupling matrix with entries $G_{i j} = \\int_0^1 \\psi_j \\, \\nabla \\cdot \\varphi_i \\, dx$ after restricting to interior pressure nodes.\n\nOn each element of length $h$, with local node indices $a$ and $b$ corresponding to global nodes $i$ and $i+1$, the standard one-dimensional piecewise-linear shape functions $\\widehat{N}_1$ and $\\widehat{N}_2$ yield the following well-tested local contributions:\n- Local flux mass matrix:\n$$\nM_q^{(e)} = \\frac{h}{3}\\begin{bmatrix}2 & 1 \\\\ 1 & 2\\end{bmatrix}.\n$$\n- Local pressure stiffness matrix:\n$$\nK_p^{(e)} = \\frac{1}{h}\\begin{bmatrix}1 & -1 \\\\ -1 & 1\\end{bmatrix}.\n$$\n- Local coupling matrix implementing $(p, v')$ where $v' = \\nabla \\cdot v$ in one dimension and $p$ is scalar:\n$$\nG^{(e)} = \\begin{bmatrix} -\\tfrac{1}{2} & -\\tfrac{1}{2} \\\\ \\tfrac{1}{2} & \\tfrac{1}{2} \\end{bmatrix},\n$$\nwith rows associated to the test flux basis functions at local nodes $a$ and $b$, and columns associated to the trial pressure basis functions at local nodes $a$ and $b$. After global assembly, enforce the homogeneous pressure boundary conditions by eliminating the first and last pressure degrees of freedom (corresponding to global nodes $0$ and $N$) from the pressure space, which restricts $K_p$ and $G$ to the interior pressure nodes.\n\nDefine the discrete operator $A(N,\\tau)$ assembled as above. The requested stability metric is the smallest singular value:\n$$\n\\sigma_{\\min}(A) = \\min \\operatorname{svd}(A),\n$$\nwhich can be computed equivalently as the square root of the smallest eigenvalue of $A^\\top A$. Compute $\\sigma_{\\min}(A)$ numerically using a robust method, such as Singular Value Decomposition (SVD, Singular Value Decomposition).\n\nYour task:\n- Implement a program that, for given $(N,\\tau)$, assembles $A(N,\\tau)$ exactly as specified and returns $\\sigma_{\\min}(A(N,\\tau))$.\n- Use the following test suite of cases $(N,\\tau)$, which probes a typical case, a near-unstabilized case, and mesh-refinement effects:\n  - Case $1$: $(N,\\tau) = (8, 0)$.\n  - Case $2$: $(N,\\tau) = (8, 10^{-6})$.\n  - Case $3$: $(N,\\tau) = (8, 10^{-2})$.\n  - Case $4$: $(N,\\tau) = (16, 10^{-2})$.\n  - Case $5$: $(N,\\tau) = (32, 10^{-2})$.\n  - Case $6$: $(N,\\tau) = (32, 1)$.\n- For each case, compute the single floating-point number $\\sigma_{\\min}(A(N,\\tau))$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in scientific notation with $10$ significant digits, ordered as cases $1$ through $6$:\n$$\n[\\sigma_{\\min}(A(8,0)),\\sigma_{\\min}(A(8,10^{-6})),\\sigma_{\\min}(A(8,10^{-2})),\\sigma_{\\min}(A(16,10^{-2})),\\sigma_{\\min}(A(32,10^{-2})),\\sigma_{\\min}(A(32,1))]\n$$\nNo physical units are required; the requested values are dimensionless. Angles are not involved. Express all numerical outputs in scientific notation with $10$ significant digits (for example, $1.2345678900\\mathrm{e}{-02}$).",
            "solution": "The objective is to compute the smallest singular value, $\\sigma_{\\min}$, of a discrete operator $A(N,\\tau)$ corresponding to a stabilized mixed finite element formulation for one-dimensional Darcy flow. This value serves as a numerical estimate for the inf-sup constant, a key metric for the stability of the mixed formulation. The algorithm proceeds by first assembling the system matrix $A(N,\\tau)$ and then computing its singular values.\n\nThe problem is defined on the unit interval $\\Omega = [0,1]$, discretized by a uniform mesh of $N$ elements, each of length $h = 1/N$. We use continuous, piecewise-linear ($P_1$) Lagrange basis functions for both the flux variable $q$ and the pressure variable $p$. The total number of nodes is $N+1$, indexed from $i=0$ to $i=N$.\n\nThe flux variable $q$ is approximated as $q_h = \\sum_{i=0}^{N} q_i \\varphi_i(x)$, where $\\{\\varphi_i\\}_{i=0}^{N}$ are the $P_1$ basis functions spanning the flux approximation space $V_h$. The dimension of this space is $N+1$.\n\nThe pressure variable $p$ is approximated as $p_h = \\sum_{j=0}^{N} p_j \\psi_j(x)$, where $\\{\\psi_j\\}_{j=0}^{N}$ are also $P_1$ basis functions. The problem imposes homogeneous Dirichlet boundary conditions, $p(0)=0$ and $p(1)=0$. These are enforced by restricting the pressure approximation to the subspace spanned by interior basis functions, $\\{\\psi_j\\}_{j=1}^{N-1}$. Thus, the pressure approximation is $p_h = \\sum_{j=1}^{N-1} p_j \\psi_j(x)$, and the dimension of the pressure approximation space $Q_h$ is $N-1$.\n\nThe discrete system is derived from the stabilized weak formulation, which leads to the block matrix operator $A \\in \\mathbb{R}^{(N+1 + N-1)\\times(N+1 + N-1)}$:\n$$\nA = \\begin{bmatrix}\nM_q & G \\\\\nG^\\top & \\tau K_p\n\\end{bmatrix}\n$$\nThe total size of matrix $A$ is $(2N) \\times (2N)$. The blocks are assembled as follows:\n\n1.  **Flux Mass Matrix, $M_q$**: This $(N+1) \\times (N+1)$ matrix has entries $(M_q)_{ik} = \\int_0^1 \\varphi_i \\varphi_k \\, dx$. It is assembled by summing the contributions from each element's local mass matrix.\n\n2.  **Pressure Stiffness Matrix, $K_p$**: This $(N-1) \\times (N-1)$ matrix corresponds to the stabilization term $\\tau (\\nabla p, \\nabla w)$. Its entries are $(K_p)_{j\\ell} = \\int_0^1 \\nabla \\psi_j \\cdot \\nabla \\psi_\\ell \\, dx$, for interior pressure basis functions $j, \\ell \\in \\{1, \\dots, N-1\\}$. The assembly uses the specified local stiffness matrix. A full $(N+1) \\times (N+1)$ matrix is first assembled, and then the submatrix corresponding to the interior nodes $\\{1, \\dots, N-1\\}$ is extracted to form $K_p$.\n\n3.  **Coupling Matrix, $G$**: This $(N+1) \\times (N-1)$ matrix arises from the a-symmetric terms in the original mixed formulation, $(p, \\nabla \\cdot v)$ and $(\\nabla \\cdot q, w)$. The entry $G_{ij}$ is defined as $G_{ij} = \\int_0^1 \\psi_j \\, \\nabla \\cdot \\varphi_i \\, dx$, where $i \\in \\{0, \\dots, N\\}$ and $j \\in \\{1, \\dots, N-1\\}$. A full $(N+1) \\times (N+1)$ coupling matrix is assembled first using the given local matrix, and then the columns corresponding to the interior pressure nodes $\\{1, \\dots, N-1\\}$ are selected to form $G$. The block $G^\\top$ in the system matrix A is the transpose of this resulting matrix.\n\nThe assembly process involves initializing global matrices of size $(N+1) \\times (N+1)$ to zero. Then, for each element $e$ connecting global nodes $i$ and $i+1$, the corresponding $2 \\times 2$ local matrices are added to the appropriate entries of the global matrices. After iterating through all $N$ elements, the boundary conditions are applied by slicing the assembled global matrices to obtain the final blocks $K_p$ and $G$.\n\nOnce the full matrix $A(N,\\tau)$ is constructed, its stability is assessed by computing its smallest singular value, $\\sigma_{\\min}(A)$. The singular values are the square roots of the eigenvalues of the symmetric positive semi-definite matrix $A^\\top A$. We compute them numerically using a standard Singular Value Decomposition (SVD) algorithm. The smallest of these values is the desired metric.\n\nThe overall algorithm is:\n1.  For a given pair $(N, \\tau)$, calculate the element size $h=1/N$.\n2.  Define the local matrices $M_q^{(e)}$, $K_p^{(e)}$, and $G^{(e)}$ as functions of $h$ as specified in the problem.\n3.  Initialize global matrices $M_q^{\\text{global}}$, $K_p^{\\text{global}}$, $G^{\\text{global}}$ of size $(N+1) \\times (N+1)$ with zeros.\n4.  Loop from element $e=0$ to $N-1$:\n    a. Determine the global indices $\\{i, i+1\\}$ for the element's nodes, where $i=e$.\n    b. Add the local matrices to the global matrices at the sub-blocks corresponding to indices $\\{i, i+1\\}$.\n5.  Extract the final matrix blocks:\n    a. $M_q = M_q^{\\text{global}}$.\n    b. $K_p = K_p^{\\text{global}}[1:N, 1:N]$.\n    c. $G = G^{\\text{global}}[:, 1:N]$.\n6.  Construct the $(2N) \\times (2N)$ block matrix $A = \\begin{bmatrix} M_q & G \\\\ G^\\top & \\tau K_p \\end{bmatrix}$.\n7.  Compute the singular values of $A$ using an SVD routine.\n8.  Return the minimum singular value, $\\sigma_{\\min}(A)$.\nThis procedure is repeated for each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef compute_sigma_min(N, tau):\n    \"\"\"\n    Assembles the discrete operator A(N, tau) and computes its smallest singular value.\n\n    Args:\n        N (int): The number of elements in the mesh.\n        tau (float): The stabilization parameter.\n\n    Returns:\n        float: The smallest singular value of the matrix A.\n    \"\"\"\n    # 1. Mesh and matrix dimensions\n    h = 1.0 / N\n    num_nodes = N + 1\n    num_flux_dofs = N + 1\n    num_pressure_dofs_interior = N - 1\n\n    # 2. Define local element matrices\n    M_q_local = (h / 3.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n    K_p_local = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    G_local = np.array([[-0.5, -0.5], [0.5, 0.5]])\n\n    # 3. Initialize global matrices (full size, before applying BCs)\n    M_q_global = np.zeros((num_nodes, num_nodes))\n    K_p_global = np.zeros((num_nodes, num_nodes))\n    G_global = np.zeros((num_nodes, num_nodes))\n\n    # 4. Assembly loop over elements\n    for e in range(N):\n        # Global node indices for element e\n        idx0, idx1 = e, e + 1\n        dof_map = np.array([idx0, idx1])\n\n        # Add local contributions to global matrices\n        # np.ix_ is used for indexing submatrices\n        M_q_global[np.ix_(dof_map, dof_map)] += M_q_local\n        K_p_global[np.ix_(dof_map, dof_map)] += K_p_local\n        G_global[np.ix_(dof_map, dof_map)] += G_local\n\n    # 5. Apply boundary conditions to extract final matrix blocks\n    # M_q uses all N+1 flux DOFs\n    M_q = M_q_global\n\n    # K_p is restricted to the N-1 interior pressure DOFs (nodes 1 to N-1)\n    K_p = K_p_global[1:N, 1:N]\n\n    # G has rows for all N+1 flux DOFs and columns for the N-1 interior pressure DOFs\n    G = G_global[:, 1:N]\n\n    # 6. Construct the final block matrix A\n    # A has size (num_flux_dofs + num_pressure_dofs_interior) x (...)\n    # which is (N+1 + N-1) x (N+1 + N-1) = 2N x 2N\n    A = np.block([\n        [M_q, G],\n        [G.T, tau * K_p]\n    ])\n\n    # 7. Compute singular values of A\n    # We only need the singular values, not the vectors U and Vh, so compute_uv=False.\n    # linalg.svd returns singular values in descending order.\n    singular_values = linalg.svd(A, compute_uv=False)\n    \n    # 8. Return the minimum singular value\n    if singular_values.size > 0:\n        return np.min(singular_values)\n    else:\n        return 0.0\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (8, 0.0),          # Case 1\n        (8, 1e-6),         # Case 2\n        (8, 1e-2),         # Case 3\n        (16, 1e-2),        # Case 4\n        (32, 1e-2),        # Case 5\n        (32, 1.0)          # Case 6\n    ]\n\n    results = []\n    for N, tau in test_cases:\n        sigma_min = compute_sigma_min(N, tau)\n        results.append(sigma_min)\n\n    # Final print statement in the exact required format.\n    # Format each number in scientific notation with 10 significant digits.\n    # The format string \"{:.9e}\" accomplishes this (1 digit before '.', 9 after).\n    formatted_results = [f\"{res:.9e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}