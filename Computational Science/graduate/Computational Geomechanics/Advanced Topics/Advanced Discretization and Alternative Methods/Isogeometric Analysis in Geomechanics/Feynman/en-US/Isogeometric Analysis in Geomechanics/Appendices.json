{
    "hands_on_practices": [
        {
            "introduction": "A core principle of isogeometric analysis is the ability to refine the computational basis without altering the exact geometry it describes. This exercise  explores degree elevation, a fundamental technique for p-refinement where the polynomial degree of a B-spline basis is increased. By deriving the new control points for an elevated-degree curve, you will directly verify the powerful property of geometric invariance, a cornerstone of IGA that distinguishes it from traditional mesh regeneration.",
            "id": "3535326",
            "problem": "Consider an isogeometric mapping used to describe a one-dimensional boundary curve in a plane-strain geomechanics model. The curve is represented by a clamped B-spline of degree $p=2$ on the parameter domain $[0,1]$ with the open knot vector $\\{0,0,0,1,1,1\\}$ and control points $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(2,0)$. Assume a non-rational setting with unit weights, so the mapping is\n$$\n\\mathbf{x}(u)=\\sum_{i=0}^{2} N_{i,2}(u)\\,\\mathbf{P}_i,\\quad u\\in[0,1],\n$$\nwhere $N_{i,2}(u)$ are the quadratic B-spline basis functions. Because the knot vector has a single nontrivial span, the basis reduces to the degree-$p$ Bernstein polynomials on $[0,1]$, and the curve is a single Bézier segment.\n\nPerform degree elevation from degree $p$ to degree $p+1$ to obtain a new control polygon $\\{\\mathbf{Q}_i\\}_{i=0}^{3}$ and a cubic mapping\n$$\n\\tilde{\\mathbf{x}}(u)=\\sum_{i=0}^{3} \\tilde{N}_{i,3}(u)\\,\\mathbf{Q}_i,\n$$\nwith the same clamped knot vector structure for a single span, so that the cubic basis reduces to the degree-$p+1$ Bernstein polynomials on $[0,1]$. Using only fundamental properties of B-spline/Bernstein bases (partition of unity, non-negativity, and linearity of the geometric map), derive the necessary relations to determine the elevated control points $\\{\\mathbf{Q}_i\\}$ such that the geometric mapping remains invariant, i.e., $\\tilde{\\mathbf{x}}(u)=\\mathbf{x}(u)$ for all $u\\in[0,1]$.\n\nThen evaluate both mappings at $u=\\tfrac{1}{2}$ and compute the Euclidean norm of their difference, that is,\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\tfrac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\|.\n$$\nReport this real number as your final answer. Assume all coordinates are dimensionless; report the final answer with no units. No rounding is required for the final answer.",
            "solution": "The problem requires the derivation of the degree elevation relations for a quadratic Bézier curve and the subsequent calculation of the norm of the difference between the original and elevated curve mappings at a specific parameter value.\n\nThe initial curve is a quadratic B-spline with a knot vector $\\{0,0,0,1,1,1\\}$. This configuration, with multiplicity $p+1=3$ for the start and end knots, makes the B-spline basis functions $N_{i,2}(u)$ identical to the quadratic Bernstein polynomials $B_{i,2}(u)$ on the domain $u \\in [0,1]$. The curve is thus a quadratic Bézier curve:\n$$\n\\mathbf{x}(u) = \\sum_{i=0}^{2} B_{i,2}(u) \\mathbf{P}_i\n$$\nwhere the Bernstein polynomials of degree $p=2$ are:\n$$\nB_{0,2}(u) = \\binom{2}{0}(1-u)^2 u^0 = (1-u)^2 \\\\\nB_{1,2}(u) = \\binom{2}{1}(1-u)^1 u^1 = 2u(1-u) \\\\\nB_{2,2}(u) = \\binom{2}{2}(1-u)^0 u^2 = u^2\n$$\nThe control points are given as $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, and $\\mathbf{P}_2=(2,0)$.\n\nThe process of degree elevation seeks a new set of control points $\\{\\mathbf{Q}_i\\}_{i=0}^3$ for a cubic Bézier curve $\\tilde{\\mathbf{x}}(u)$ such that the geometry is identical to the original curve, i.e., $\\tilde{\\mathbf{x}}(u) = \\mathbf{x}(u)$ for all $u \\in [0,1]$.\n$$\n\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i\n$$\nTo find the relationship between $\\{\\mathbf{P}_i\\}$ and $\\{\\mathbf{Q}_i\\}$, we can elevate the degree of the basis functions of the original curve. We use the property that the basis functions form a partition of unity, $\\sum B_{i,p}(u) = 1$, which can be expressed for the simplest case as $(1-u)+u=1$. We multiply the expression for $\\mathbf{x}(u)$ by $1$:\n$$\n\\mathbf{x}(u) = ((1-u) + u) \\sum_{j=0}^{2} B_{j,2}(u) \\mathbf{P}_j = \\sum_{j=0}^{2} (1-u)B_{j,2}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} uB_{j,2}(u)\\mathbf{P}_j\n$$\nWe use the definitions $B_{j,p}(u) = \\binom{p}{j}u^j(1-u)^{p-j}$ to analyze the products:\n$$\n(1-u)B_{j,p}(u) = (1-u)\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j}} \\binom{p+1}{j}u^j(1-u)^{p+1-j} = \\frac{p+1-j}{p+1} B_{j,p+1}(u)\n$$\n$$\nuB_{j,p}(u) = u\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j+1}} \\binom{p+1}{j+1}u^{j+1}(1-u)^{p-j} = \\frac{j+1}{p+1} B_{j+1,p+1}(u)\n$$\nSubstituting these identities with $p=2$ into the expression for $\\mathbf{x}(u)$:\n$$\n\\mathbf{x}(u) = \\sum_{j=0}^{2} \\frac{3-j}{3}B_{j,3}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} \\frac{j+1}{3}B_{j+1,3}(u)\\mathbf{P}_j\n$$\nLet's expand and collect terms based on the cubic Bernstein basis functions $B_{i,3}(u)$:\nThe first sum gives:\n$$\n\\frac{3}{3}B_{0,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{1,3}(u)\\mathbf{P}_1 + \\frac{1}{3}B_{2,3}(u)\\mathbf{P}_2\n$$\nThe second sum gives (index shifted):\n$$\n\\frac{1}{3}B_{1,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{2,3}(u)\\mathbf{P}_1 + \\frac{3}{3}B_{3,3}(u)\\mathbf{P}_2\n$$\nCombining and grouping terms by $B_{i,3}(u)$:\n$$\n\\mathbf{x}(u) = B_{0,3}(u)[\\mathbf{P}_0] + B_{1,3}(u)[\\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1] + B_{2,3}(u)[\\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2] + B_{3,3}(u)[\\mathbf{P}_2]\n$$\nBy comparing this with $\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i$, we obtain the new control points $\\{\\mathbf{Q}_i\\}$:\n$$\n\\mathbf{Q}_0 = \\mathbf{P}_0 \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1 \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2 \\\\\n\\mathbf{Q}_3 = \\mathbf{P}_2\n$$\nThe general formula for degree elevation from $p$ to $p+1$ is $\\mathbf{Q}_i = \\frac{i}{p+1}\\mathbf{P}_{i-1} + (1-\\frac{i}{p+1})\\mathbf{P}_i$ for $i=1,\\ldots,p$, with $\\mathbf{Q}_0 = \\mathbf{P}_0$ and $\\mathbf{Q}_{p+1} = \\mathbf{P}_p$. Our derivation for $p=2$ matches this general result.\n\nNow, we apply these relations to the given control points $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(2,0)$:\n$$\n\\mathbf{Q}_0 = (0,0) \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}(0,0) + \\frac{2}{3}(1,2) = \\left(\\frac{2}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}(1,2) + \\frac{1}{3}(2,0) = \\left(\\frac{2}{3}+\\frac{2}{3}, \\frac{4}{3}+0\\right) = \\left(\\frac{4}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_3 = (2,0)\n$$\nThe problem asks for the evaluation of $\\left\\|\\mathbf{x}\\!\\left(\\tfrac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\|$. By our derivation, the geometric mapping is invariant under degree elevation, meaning $\\mathbf{x}(u) = \\tilde{\\mathbf{x}}(u)$ for all $u \\in [0,1]$. Consequently, the difference vector $\\mathbf{x}(u) - \\tilde{\\mathbf{x}}(u)$ is the zero vector, $\\mathbf{0}$, for any value of $u$.\n\nFor completeness, we can explicitly verify this at $u=\\frac{1}{2}$.\nFor the original quadratic curve:\n$$\n\\mathbf{x}\\left(\\frac{1}{2}\\right) = B_{0,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_0 + B_{1,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_1 + B_{2,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_2 \\\\\n= \\left(1-\\frac{1}{2}\\right)^2 \\mathbf{P}_0 + 2\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right)\\mathbf{P}_1 + \\left(\\frac{1}{2}\\right)^2 \\mathbf{P}_2 \\\\\n= \\frac{1}{4}(0,0) + \\frac{1}{2}(1,2) + \\frac{1}{4}(2,0) = \\left(0+\\frac{1}{2}+\\frac{2}{4}, 0+1+0\\right) = (1,1)\n$$\nFor the degree-elevated cubic curve:\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = B_{0,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_0 + B_{1,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_1 + B_{2,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_2 + B_{3,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_3\n$$\nThe cubic Bernstein values at $u=\\frac{1}{2}$ are $B_{0,3}=\\frac{1}{8}$, $B_{1,3}=\\frac{3}{8}$, $B_{2,3}=\\frac{3}{8}$, $B_{3,3}=\\frac{1}{8}$.\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = \\frac{1}{8}(0,0) + \\frac{3}{8}\\left(\\frac{2}{3}, \\frac{4}{3}\\right) + \\frac{3}{8}\\left(\\frac{4}{3}, \\frac{4}{3}\\right) + \\frac{1}{8}(2,0) \\\\\n= \\left(0 + \\frac{6}{24} + \\frac{12}{24} + \\frac{2}{8}, 0 + \\frac{12}{24} + \\frac{12}{24} + 0\\right) \\\\\n= \\left(\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4}, \\frac{1}{2} + \\frac{1}{2}\\right) = (1,1)\n$$\nThe verification confirms that $\\mathbf{x}(\\frac{1}{2})=\\tilde{\\mathbf{x}}(\\frac{1}{2})=(1,1)$. The difference is:\n$$\n\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right) = (1,1) - (1,1) = (0,0)\n$$\nFinally, we compute the Euclidean norm of this difference vector:\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right)\\right\\| = \\|(0,0)\\| = \\sqrt{0^2 + 0^2} = 0\n$$\nThe result is a direct consequence of the geometric invariance of a curve under degree elevation.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Building system matrices in IGA, as in traditional FEM, requires integrating products of basis functions over the domain. Because B-splines are piecewise polynomials, this integration is performed numerically on a span-by-span basis using Gaussian quadrature. This exercise  challenges you to determine the minimally sufficient quadrature rule, a critical decision for ensuring computational accuracy and efficiency. You will analyze the polynomial degree of integrands found in geomechanical problems to justify the necessary number of integration points.",
            "id": "3535321",
            "problem": "In Isogeometric Analysis (IGA), consider a univariate, nonrational B-spline basis of degree $p$ defined over an open knot vector $\\Xi = \\{\\xi_1,\\xi_2,\\dots,\\xi_{n+p+1}\\}$ that partitions the parametric domain into knot spans $[\\xi_a,\\xi_{a+1}]$ for $a=1,\\dots, n_{\\mathrm{el}}$, where $n_{\\mathrm{el}}$ is the number of nonempty spans. Assume small-strain linear geomechanics with constant material coefficients on each span and an affine geometry mapping on each span so that the Jacobian determinant $J$ is constant on $[\\xi_a,\\xi_{a+1}]$. Consider assembling span-wise the canonical bilinear forms that arise in geomechanics, such as the mass bilinear form $\\int N_i N_j\\, \\rho\\, J\\, \\mathrm{d}\\xi$ and the stiffness bilinear form $\\int (\\nabla N_i)^{\\top}\\boldsymbol{C}\\,\\nabla N_j\\, J\\, \\mathrm{d}\\xi$, where $N_i$ and $N_j$ are B-spline basis functions of degree $p$, $\\rho$ is the density, and $\\boldsymbol{C}$ is a constant constitutive tensor on the span.\n\nOn a single span $[\\xi_a,\\xi_{a+1}]$, $N_i$ and $N_j$ are polynomials of degree at most $p$, so $N_i N_j$ is a polynomial of degree at most $2p$, and $(\\partial_{\\xi} N_i)(\\partial_{\\xi} N_j)$ is a polynomial of degree at most $2p-2$. You are tasked to prescribe a Gaussian quadrature rule per knot span and to justify the minimum number of quadrature points required to exactly integrate any polynomial integrand of degree up to $2p$ that may appear in these spline-based bilinear forms under the stated assumptions.\n\nWhich option correctly specifies the per-span Gaussian quadrature mapping and the minimal number of Gauss points required to guarantee exact integration of all polynomial terms of degree up to $2p$ on each span?\n\nA. On each span $[\\xi_a,\\xi_{a+1}]$, use the $n$-point Gauss–Legendre rule with $n=p+1$ points. Map $\\hat{\\xi}\\in[-1,1]$ to $\\xi\\in[\\xi_a,\\xi_{a+1}]$ by $\\xi(\\hat{\\xi}) = \\dfrac{\\xi_{a}+\\xi_{a+1}}{2}+\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}\\,\\hat{\\xi}$ and scale weights by $w_k=\\hat{w}_k\\,\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}$. This exactly integrates any polynomial integrand of degree up to $2p$ on the span (and thus both mass and stiffness integrands under the stated assumptions).\n\nB. On each span $[\\xi_a,\\xi_{a+1}]$, use the $n$-point Gauss–Legendre rule with $n=p$ points. The high inter-element continuity of B-splines ensures that products up to degree $2p$ are exactly integrated with $p$ points on each span.\n\nC. On each span $[\\xi_a,\\xi_{a+1}]$, use the $n$-point Gauss–Lobatto rule with $n=p+1$ points because endpoint inclusion aligns with open knot vectors. This exactly integrates any polynomial integrand up to degree $2p$ on the span.\n\nD. Because B-splines are globally smooth, use a single $n$-point Gauss–Legendre rule on the full parametric domain with $n=(p+1)\\,n_{\\mathrm{el}}$ points, without span-wise mapping. This exactly integrates any polynomial integrand up to degree $2p$ over the entire domain.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the theory of Isogeometric Analysis and numerical integration, is well-posed, objective, and contains sufficient information to derive a unique solution.\n\nThe core of the problem is to determine the minimum number of quadrature points for a Gaussian quadrature rule to exactly integrate polynomial functions up to a certain degree on a given interval. The standard theorem for Gauss-Legendre quadrature states that an $n$-point rule on a reference interval, typically $[-1, 1]$, can exactly integrate any polynomial of degree up to $2n-1$.\n\nThe problem specifies that the bilinear forms for mass and stiffness matrices must be integrated. The integration is performed span-wise, over each interval $[\\xi_a, \\xi_{a+1}]$. On such a span, the B-spline basis functions $N_i(\\xi)$ are polynomials of degree at most $p$.\nThe problem assumptions are:\n1.  The geometry mapping is affine on each span, which means the Jacobian determinant $J$ of the mapping from the parametric domain to the physical domain is constant on the span.\n2.  Material coefficients, such as density $\\rho$ and the constitutive tensor $\\boldsymbol{C}$, are constant on each span.\n3.  We are considering univariate B-splines, so the gradient operator $\\nabla$ effectively becomes a derivative with respect to the physical coordinate, which is related to the derivative with respect to the parametric coordinate $\\xi$ via the (constant) Jacobian of the affine map. Thus, $\\nabla N_i$ involves $\\partial_{\\xi} N_i$.\n\nLet's analyze the integrands on a single span $[\\xi_a, \\xi_{a+1}]$:\n-   **Mass matrix integrand**: The term is of the form $N_i N_j \\rho J$. Since $N_i$ and $N_j$ are polynomials of degree at most $p$, their product $N_i N_j$ is a polynomial of degree at most $p+p=2p$. As $\\rho$ and $J$ are constant on the span, the entire integrand is a polynomial of degree at most $2p$.\n-   **Stiffness matrix integrand**: The term involves $(\\nabla N_i)^{\\top}\\boldsymbol{C}\\,\\nabla N_j J$. In the univariate case, this simplifies to a term proportional to $(\\partial_{\\xi} N_i)(\\partial_{\\xi} N_j) J (\\text{map constants})$. The derivative of a polynomial of degree $p$ is a polynomial of degree $p-1$. Therefore, the product $(\\partial_{\\xi} N_i)(\\partial_{\\xi} N_j)$ is a polynomial of degree at most $(p-1)+(p-1) = 2p-2$. The full integrand is thus a polynomial of degree at most $2p-2$.\n\nThe question asks for a single quadrature rule prescription per span that guarantees exact integration for \"any polynomial integrand of degree up to $2p$ that may appear in these spline-based bilinear forms\". The highest degree polynomial that appears is $2p$ from the mass matrix term. Therefore, the quadrature rule must be sufficient to integrate any polynomial of degree up to $2p$ exactly.\n\nLet $n$ be the number of Gauss points. For a Gauss-Legendre rule, the maximum degree of exact integration is $2n-1$. We require this to be at least $2p$.\n$$ 2n-1 \\ge 2p $$\n$$ 2n \\ge 2p+1 $$\n$$ n \\ge p + \\frac{1}{2} $$\nSince $n$ must be an integer, the minimum number of required points is $n = p+1$.\nWith $n=p+1$ points, a Gauss-Legendre rule exactly integrates polynomials of degree up to $2(p+1)-1 = 2p+1$, which is sufficient for the degree $2p$ mass matrix integrand and, by extension, the lower-degree $2p-2$ stiffness matrix integrand.\n\nThe integration must be performed on each span $[\\xi_a, \\xi_{a+1}]$. Standard Gauss-Legendre quadrature rules are defined on a reference interval, such as $\\hat{\\xi} \\in [-1, 1]$. A linear (affine) mapping is used to transform the integral from the physical span to the reference span. Let the mapping be $\\xi(\\hat{\\xi})$. We require $\\xi(-1)=\\xi_a$ and $\\xi(1)=\\xi_{a+1}$. The unique linear map satisfying this is:\n$$ \\xi(\\hat{\\xi}) = \\frac{\\xi_a+\\xi_{a+1}}{2} + \\frac{\\xi_{a+1}-\\xi_a}{2} \\hat{\\xi} $$\nThe differential element transforms as $\\mathrm{d}\\xi = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}\\hat{\\xi}} \\mathrm{d}\\hat{\\xi}$. The Jacobian of this one-dimensional mapping is $\\frac{\\mathrm{d}\\xi}{\\mathrm{d}\\hat{\\xi}} = \\frac{\\xi_{a+1}-\\xi_a}{2}$.\nAn integral transforms as:\n$$ \\int_{\\xi_a}^{\\xi_{a+1}} f(\\xi) \\, \\mathrm{d}\\xi = \\int_{-1}^{1} f(\\xi(\\hat{\\xi})) \\frac{\\xi_{a+1}-\\xi_a}{2} \\, \\mathrm{d}\\hat{\\xi} $$\nThe quadrature approximation on the reference interval using $n$ points $\\{\\hat{\\xi}_k, \\hat{w}_k\\}_{k=1}^n$ is:\n$$ \\int_{-1}^{1} g(\\hat{\\xi}) \\, \\mathrm{d}\\hat{\\xi} \\approx \\sum_{k=1}^n \\hat{w}_k g(\\hat{\\xi}_k) $$\nApplying this to our transformed integral:\n$$ \\int_{\\xi_a}^{\\xi_{a+1}} f(\\xi) \\, \\mathrm{d}\\xi \\approx \\sum_{k=1}^n \\hat{w}_k \\left( f(\\xi(\\hat{\\xi}_k)) \\frac{\\xi_{a+1}-\\xi_a}{2} \\right) = \\sum_{k=1}^n w_k f(\\xi_k) $$\nwhere the points on the physical span are $\\xi_k = \\xi(\\hat{\\xi}_k)$ and the corresponding weights are $w_k = \\hat{w}_k \\frac{\\xi_{a+1}-\\xi_a}{2}$.\n\nNow we evaluate the given options based on this derivation.\n\n**A. On each span $[\\xi_a,\\xi_{a+1}]$, use the $n$-point Gauss–Legendre rule with $n=p+1$ points. Map $\\hat{\\xi}\\in[-1,1]$ to $\\xi\\in[\\xi_a,\\xi_{a+1}]$ by $\\xi(\\hat{\\xi}) = \\dfrac{\\xi_{a}+\\xi_{a+1}}{2}+\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}\\,\\hat{\\xi}$ and scale weights by $w_k=\\hat{w}_k\\,\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}$. This exactly integrates any polynomial integrand of degree up to $2p$ on the span (and thus both mass and stiffness integrands under the stated assumptions).**\n- This option correctly identifies the number of points as $n=p+1$, which guarantees exact integration for polynomials up to degree $2(p+1)-1 = 2p+1$, satisfying the requirement for degree $2p$.\n- It specifies the Gauss-Legendre rule, which is the optimal choice for polynomial integration.\n- It provides the correct affine mapping from the reference interval $[-1,1]$ to the span $[\\xi_a, \\xi_{a+1}]$.\n- It correctly states the scaling for the quadrature weights, which corresponds to the Jacobian of the mapping.\n- The conclusion that this rule is sufficient for both mass and stiffness integrands is correct.\n- **Verdict: Correct.**\n\n**B. On each span $[\\xi_a,\\xi_{a+1}]$, use the $n$-point Gauss–Legendre rule with $n=p$ points. The high inter-element continuity of B-splines ensures that products up to degree $2p$ are exactly integrated with $p$ points on each span.**\n- This option proposes using $n=p$ points. An $n=p$ point Gauss-Legendre rule integrates polynomials exactly up to degree $2p-1$. This is insufficient to exactly integrate the mass matrix term, which can be of degree $2p$.\n- The justification about \"high inter-element continuity\" is a red herring. Numerical integration is performed span by span, and on each span, the integrand is a polynomial whose properties are independent of the function's continuity at the span boundaries. Global continuity does not change the degree of the polynomial inside a span.\n- **Verdict: Incorrect.**\n\n**C. On each span $[\\xi_a,\\xi_{a+1}]$, use the $n$-point Gauss–Lobatto rule with $n=p+1$ points because endpoint inclusion aligns with open knot vectors. This exactly integrates any polynomial integrand up to degree $2p$ on the span.**\n- This option proposes using a Gauss-Lobatto rule. An $n$-point Gauss-Lobatto rule integrates polynomials exactly up to degree $2n-3$.\n- With $n=p+1$ points, this rule would be exact for polynomials up to degree $2(p+1)-3 = 2p-1$. This is insufficient for the degree $2p$ mass term.\n- While Gauss-Lobatto rules are used in some numerical contexts, they are less efficient for volume integration than Gauss-Legendre. The justification provided is weak and does not change the mathematical fact of the rule's accuracy.\n- **Verdict: Incorrect.**\n\n**D. Because B-splines are globally smooth, use a single $n$-point Gauss–Legendre rule on the full parametric domain with $n=(p+1)\\,n_{\\mathrm{el}}$ points, without span-wise mapping. This exactly integrates any polynomial integrand up to degree $2p$ over the entire domain.**\n- This option proposes a fundamentally incorrect procedure. The integrand $N_i N_j$ is a piecewise polynomial, not a single polynomial over the entire domain. Furthermore, the material properties and Jacobian are only piecewise constant. A single Gauss-Legendre rule is only guaranteed to be exact for a single polynomial function over its domain of application. Applying it to a piecewise polynomial (with coefficient discontinuities at knots) will not yield an exact result. The standard and correct method is to sum the integrals over each span, applying a separate quadrature rule to each.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Many critical problems in geomechanics, such as the modeling of fluid-saturated porous media, are best described by mixed formulations that solve for multiple fields simultaneously. The numerical stability of such methods depends on the choice of approximation spaces, a condition mathematically captured by the inf-sup constant. This advanced practice  guides you through the complete derivation and calculation of this constant for a specific pairing of isogeometric spaces. Successfully completing this exercise demonstrates a deep understanding of the conditions required for a stable and reliable simulation of complex multi-physics phenomena.",
            "id": "3535320",
            "problem": "Consider the mixed displacement–pressure formulation for a one-dimensional, nearly incompressible solid in small strain geomechanics on the parametric domain $\\Omega = [0,1]$. Let the displacement space be the isogeometric space built from a quadratic ($p = 2$) open knot vector with a single element, and the pressure space be the isogeometric space built from a linear ($p-1 = 1$) open knot vector with the same single element. Assume the geometry mapping is the identity and impose the homogeneous essential boundary condition $u(0) = 0$ to eliminate the rigid body mode.\n\nLet the bilinear form associated with volumetric coupling be\n$$\nb(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx,\n$$\nand equip the discrete displacement and pressure spaces with the norms\n$$\n\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}, \n\\qquad\n\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}.\n$$\nThe discrete inf–sup (Ladyzhenskaya–Babuška–Brezzi) constant is defined as\n$$\n\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}.\n$$\n\nUsing the above setting:\n- Construct the basis functions for $V_{h}$ and $Q_{h}$ induced by the open knot vectors on the single element.\n- Enforce $u(0)=0$ consistently in the discrete setting.\n- Starting from the definition of $\\beta_{h}$, derive a computable expression for the discrete inf–sup constant in terms of the discrete operators and evaluate it exactly for this mesh and these isogeometric spaces.\n\nFinally, explain how the value you obtain relates to the knot configuration and continuity; in particular, discuss qualitatively how inserting an interior knot (thus introducing multiple elements and reducing continuity) would be expected to affect the discrete inf–sup constant. Provide as your final result the exact value of $\\beta_{h}$ for the single-element open-knot configuration described above. The constant is dimensionless, so no units are required, and no rounding is necessary.",
            "solution": "The problem requires the calculation of the discrete inf-sup constant $\\beta_h$ for a specific one-dimensional isogeometric element pairing and a subsequent discussion on the result.\n\nThe validation of the problem statement is performed first.\n\n**Step 1: Extract Givens**\n- Formulation: Mixed displacement–pressure formulation.\n- Domain: $\\Omega = [0,1]$.\n- Displacement space ($V_h$): Isogeometric space from a quadratic ($p=2$) open knot vector, single element.\n- Pressure space ($Q_h$): Isogeometric space from a linear ($p-1=1$) open knot vector, single element.\n- Geometry mapping: Identity, $x(\\xi) = \\xi$.\n- Boundary condition: Homogeneous essential boundary condition $u(0) = 0$.\n- Bilinear form: $b(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx$.\n- Displacement norm: $\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}$.\n- Pressure norm: $\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}$.\n- Definition of the discrete inf-sup constant: $\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It poses a standard, non-trivial question in the theory of mixed finite element methods, specifically within the framework of isogeometric analysis. The formulation, definitions, and spaces are standard in the field. The problem is self-contained and free of contradictions, ambiguities, or unsound premises.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\n**Part 1: Construction of Basis Functions**\nFor a single element on the domain $[0,1]$ with an open knot vector, the B-spline basis functions reduce to the Bernstein polynomials.\n\n- **Displacement Space $V_h$ ($p=2$):**\nThe open knot vector for a single quadratic element is $\\Xi_u = \\{0, 0, 0, 1, 1, 1\\}$. The basis functions are the quadratic Bernstein polynomials:\n$$\n\\begin{aligned}\nN_{1,2}(x) &= (1-x)^2 = 1 - 2x + x^2 \\\\\nN_{2,2}(x) &= 2x(1-x) = 2x - 2x^2 \\\\\nN_{3,2}(x) &= x^2\n\\end{aligned}\n$$\nA discrete displacement field $u_h(x)$ is represented as $u_h(x) = \\sum_{i=1}^{3} c_i N_{i,2}(x)$.\n\n- **Pressure Space $Q_h$ ($p=1$):**\nThe open knot vector for a single linear element is $\\Xi_q = \\{0, 0, 1, 1\\}$. The basis functions are the linear Bernstein polynomials:\n$$\n\\begin{aligned}\nQ_{1,1}(x) &= 1-x \\\\\nQ_{2,1}(x) &= x\n\\end{aligned}\n$$\nA discrete pressure field $q_h(x)$ is represented as $q_h(x) = \\sum_{k=1}^{2} d_k Q_{k,1}(x)$.\n\n**Part 2: Enforcement of Boundary Condition $u(0)=0$**\nThe condition $u(0)=0$ must be imposed on the discrete displacement space. At $x=0$, the basis functions evaluate to:\n$N_{1,2}(0) = 1$, $N_{2,2}(0) = 0$, $N_{3,2}(0) = 0$.\nThus, $u_h(0) = c_1 N_{1,2}(0) + c_2 N_{2,2}(0) + c_3 N_{3,2}(0) = c_1$.\nThe condition $u_h(0)=0$ implies $c_1=0$. The constrained displacement space is therefore spanned by $\\{N_{2,2}(x), N_{3,2}(x)\\}$. Let $\\mathbf{c} = \\begin{pmatrix} c_2 & c_3 \\end{pmatrix}^T$ be the vector of active degrees of freedom.\n\n**Part 3: Matrix Formulation of the inf-sup Constant**\nWe express the terms in the definition of $\\beta_h$ in matrix form. Let $\\mathbf{d} = \\begin{pmatrix} d_1 & d_2 \\end{pmatrix}^T$.\n- $b(u_h, q_h) = \\int_{0}^{1} (\\mathbf{d}^T \\mathbf{Q}(x)) (\\mathbf{N}'(x)^T \\mathbf{c}) dx = \\mathbf{d}^T \\mathbf{B} \\mathbf{c}$, where $\\mathbf{B}_{kj} = \\int_0^1 Q_{k,1}(x) N'_{j+1,2}(x) dx$.\n- $\\|u_h\\|_V^2 = \\int_{0}^{1} |\\frac{du_h}{dx}|^2 dx = \\mathbf{c}^T \\mathbf{K} \\mathbf{c}$, where $\\mathbf{K}_{ij} = \\int_0^1 N'_{i+1,2}(x) N'_{j+1,2}(x) dx$.\n- $\\|q_h\\|_Q^2 = \\int_{0}^{1} |q_h|^2 dx = \\mathbf{d}^T \\mathbf{M} \\mathbf{d}$, where $\\mathbf{M}_{kl} = \\int_0^1 Q_{k,1}(x) Q_{l,1}(x) dx$.\n\nThe discrete inf-sup constant is given by $\\beta_h^2 = \\lambda_{\\min}$, where $\\lambda$ are the eigenvalues of the generalized eigenvalue problem:\n$$\n(\\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T) \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}\n$$\n\n**Part 4: Computation of Matrices**\nThe required derivatives of the displacement basis functions are:\n$N'_{2,2}(x) = 2 - 4x$\n$N'_{3,2}(x) = 2x$\n\n- **Stiffness Matrix $\\mathbf{K}$** (for the constrained space):\n$K_{11} = \\int_0^1 (2-4x)^2 dx = \\int_0^1 (4 - 16x + 16x^2) dx = \\left[4x - 8x^2 + \\frac{16}{3}x^3\\right]_0^1 = 4-8+\\frac{16}{3} = \\frac{4}{3}$.\n$K_{12} = K_{21} = \\int_0^1 (2-4x)(2x) dx = \\int_0^1 (4x - 8x^2) dx = \\left[2x^2 - \\frac{8}{3}x^3\\right]_0^1 = 2-\\frac{8}{3} = -\\frac{2}{3}$.\n$K_{22} = \\int_0^1 (2x)^2 dx = \\int_0^1 4x^2 dx = \\left[\\frac{4}{3}x^3\\right]_0^1 = \\frac{4}{3}$.\n$$ \\mathbf{K} = \\begin{pmatrix} \\frac{4}{3} & -\\frac{2}{3} \\\\ -\\frac{2}{3} & \\frac{4}{3} \\end{pmatrix} = \\frac{2}{3}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} $$\n\n- **Pressure Mass Matrix $\\mathbf{M}$**:\n$M_{11} = \\int_0^1 (1-x)^2 dx = \\left[-\\frac{(1-x)^3}{3}\\right]_0^1 = \\frac{1}{3}$.\n$M_{12} = M_{21} = \\int_0^1 x(1-x) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_0^1 = \\frac{1}{2}-\\frac{1}{3} = \\frac{1}{6}$.\n$M_{22} = \\int_0^1 x^2 dx = \\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{1}{3}$.\n$$ \\mathbf{M} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{6} \\\\ \\frac{1}{6} & \\frac{1}{3} \\end{pmatrix} = \\frac{1}{6}\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n\n- **Coupling Matrix $\\mathbf{B}$**:\n$B_{11} = \\int_0^1 (1-x)(2-4x) dx = \\int_0^1 (2-6x+4x^2) dx = \\left[2x - 3x^2 + \\frac{4}{3}x^3\\right]_0^1 = 2-3+\\frac{4}{3} = \\frac{1}{3}$.\n$B_{12} = \\int_0^1 (1-x)(2x) dx = \\int_0^1 (2x-2x^2) dx = \\left[x^2 - \\frac{2}{3}x^3\\right]_0^1 = 1-\\frac{2}{3} = \\frac{1}{3}$.\n$B_{21} = \\int_0^1 x(2-4x) dx = \\int_0^1 (2x-4x^2) dx = \\left[x^2 - \\frac{4}{3}x^3\\right]_0^1 = 1-\\frac{4}{3} = -\\frac{1}{3}$.\n$B_{22} = \\int_0^1 x(2x) dx = \\int_0^1 2x^2 dx = \\left[\\frac{2}{3}x^3\\right]_0^1 = \\frac{2}{3}$.\n$$ \\mathbf{B} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{2}{3} \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1 & 1 \\\\ -1 & 2 \\end{pmatrix} $$\n\n**Part 5: Solving the Eigenvalue Problem**\nFirst, we find $\\mathbf{K}^{-1}$:\n$\\det(\\mathbf{K}) = (\\frac{2}{3})^2(2 \\cdot 2 - (-1)(-1)) = \\frac{4}{9}(3) = \\frac{4}{3}$.\n$$ \\mathbf{K}^{-1} = \\frac{1}{4/3} \\begin{pmatrix} \\frac{4}{3} & \\frac{2}{3} \\\\ \\frac{2}{3} & \\frac{4}{3} \\end{pmatrix} = \\frac{3}{4} \\frac{2}{3} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{1}{2} \\\\ \\frac{1}{2} & 1 \\end{pmatrix} $$\nNext, we compute the matrix $\\mathbf{S} = \\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T$.\n$$ \\mathbf{B} \\mathbf{K}^{-1} = \\frac{1}{3}\\begin{pmatrix} 1 & 1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 & \\frac{1}{2} \\\\ \\frac{1}{2} & 1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1+\\frac{1}{2} & \\frac{1}{2}+1 \\\\ -1+1 & -\\frac{1}{2}+2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{3}{2} & \\frac{3}{2} \\\\ 0 & \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & \\frac{1}{2} \\end{pmatrix} $$\n$$ \\mathbf{S} = (\\mathbf{B} \\mathbf{K}^{-1})\\mathbf{B}^T = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & \\frac{1}{2} \\end{pmatrix} \\frac{1}{3}\\begin{pmatrix} 1 & -1 \\\\ 1 & 2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{1}{2}+\\frac{1}{2} & -\\frac{1}{2}+1 \\\\ \\frac{1}{2} & 1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1 & \\frac{1}{2} \\\\ \\frac{1}{2} & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{6} \\\\ \\frac{1}{6} & \\frac{1}{3} \\end{pmatrix} $$\nWe observe that $\\mathbf{S} = \\mathbf{M}$. The generalized eigenvalue problem $\\mathbf{S} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}$ thus becomes:\n$$ \\mathbf{M} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d} $$\nSince $\\mathbf{M}$ is invertible (as $\\det(\\mathbf{M}) = \\frac{1}{9}-\\frac{1}{36} \\neq 0$), we can multiply by $\\mathbf{M}^{-1}$ to get $\\mathbf{I} \\mathbf{d} = \\lambda \\mathbf{d}$. The eigenvalues are the eigenvalues of the identity matrix, so $\\lambda_1 = \\lambda_2 = 1$. The minimum eigenvalue is $\\lambda_{\\min} = 1$.\nThe discrete inf-sup constant is $\\beta_h = \\sqrt{\\lambda_{\\min}} = \\sqrt{1} = 1$.\n\n**Part 6: Discussion**\nThe calculated value $\\beta_h = 1$ is the maximum possible value for an inf-sup constant and indicates a perfectly stable element pairing. This optimal result is a direct consequence of the specific isogeometric spaces chosen for a single element. For Bernstein polynomials, the space spanned by the derivatives of degree-$p$ polynomials is identical to the space of polynomials of degree-$(p-1)$. In our case, after applying the boundary condition, the space of derivatives of the constrained quadratic displacement basis functions, $V'_h = \\text{span}\\{2-4x, 2x\\}$, is precisely the space of all linear polynomials. The linear pressure basis, $Q_h = \\text{span}\\{1-x, x\\}$, also spans the space of all linear polynomials. Thus, $V'_h = Q_h$.\n\nThis means for any discrete pressure $q_h \\in Q_h$, there exists a unique discrete displacement $u_h \\in V_h$ such that $\\frac{du_h}{dx} = q_h$. Choosing this particular $u_h$ in the supremum of the definition of $\\beta_h$ yields:\n$$ \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}} \\ge \\frac{\\|q_h\\|_Q^2}{\\|u_h\\|_V \\|q_h\\|_Q} = \\frac{\\|q_h\\|_Q^2}{\\|q_h\\|_Q \\|q_h\\|_Q} = 1 $$\nSince the ratio can never exceed $1$ by the Cauchy-Schwarz inequality, the supremum for any $q_h$ is exactly $1$. The infimum over all $q_h$ is therefore also $1$.\n\nIf an interior knot were inserted (e.g., at $x=1/2$), a multi-element mesh would be created. The displacement basis functions would become $C^1$-continuous quadratic splines, and the pressure basis would be $C^0$-continuous linear splines. While the derivative of a $C^1$ quadratic spline space is a $C^0$ linear spline space, and the dimensions of the derivative space $V'_h$ and the pressure space $Q_h$ would remain equal, the spaces are no longer identical in their functional form due to the differences in the underlying knot vectors used in the derivative formula versus the basis function definition. This loss of the $V'_h=Q_h$ property means the supremum part of the calculation will yield a value strictly less than $1$ for some pressure modes $q_h$. Consequently, inserting an interior knot and reducing the global continuity of the basis would be expected to decrease the discrete inf-sup constant from its perfect value of $1$. The element pair would remain stable ($\\beta_h > 0$), but it would no longer be \"perfectly\" stable.",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}