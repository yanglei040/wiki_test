{
    "hands_on_practices": [
        {
            "introduction": "等几何分析的核心优势之一是能够改变近似空间的自由度，同时精确保持几何形状。阶数提升（degree elevation）是实现 $p$-细化的一种基本技术，它允许在不改变几何的情况下增加基函数的次数。本练习将通过推导阶数提升公式，巩固您对 B 样条和 Bézier 基函数性质的理解，这些性质对于高级细化策略至关重要 。",
            "id": "3535326",
            "problem": "考虑一个用于描述平面应变岩土力学模型中一维边界曲线的等几何映射。该曲线由参数域 $[0,1]$ 上阶数为 $p=2$ 的夹持B样条表示，其开节点矢量为 $\\{0,0,0,1,1,1\\}$，控制点为 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$、$\\mathbf{P}_2=(2,0)$。假设为具有单位权重的非有理设置，因此映射为\n$$\n\\mathbf{x}(u)=\\sum_{i=0}^{2} N_{i,2}(u)\\,\\mathbf{P}_i,\\quad u\\in[0,1],\n$$\n其中 $N_{i,2}(u)$ 是二次B样条基函数。由于节点矢量只有一个非平凡区间，基函数退化为 $[0,1]$ 上的 $p$ 次伯恩斯坦多项式，该曲线是一个单独的贝塞尔段。\n\n执行从 $p$ 阶到 $p+1$ 阶的升阶操作，以获得新的控制多边形 $\\{\\mathbf{Q}_i\\}_{i=0}^{3}$ 和一个三次映射\n$$\n\\tilde{\\mathbf{x}}(u)=\\sum_{i=0}^{3} \\tilde{N}_{i,3}(u)\\,\\mathbf{Q}_i,\n$$\n该映射具有与单个区间相同的夹持节点矢量结构，因此三次基退化为 $[0,1]$ 上的 $p+1$ 次伯恩斯坦多项式。仅使用B样条/伯恩斯坦基的基本性质（单位分解性、非负性和几何映射的线性），推导出确定升阶后控制点 $\\{\\mathbf{Q}_i\\}$ 所需的关系式，以使几何映射保持不变，即对于所有 $u\\in[0,1]$，都有 $\\tilde{\\mathbf{x}}(u)=\\mathbf{x}(u)$。\n\n然后，在 $u=\\frac{1}{2}$ 处计算两个映射的值，并计算它们差值的欧几里得范数，即$$ \\left\\|\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right)\\right\\| $$。将此实数作为您的最终答案。假设所有坐标都是无量纲的；报告最终答案时不带单位。最终答案无需四舍五入。",
            "solution": "该问题要求推导二次贝塞尔曲线的升阶关系式，并随后计算在特定参数值下原始曲线映射与升阶后曲线映射之间差值的范数。\n\n初始曲线是一个二次B样条，其节点矢量为 $\\{0,0,0,1,1,1\\}$。这种结构中，首末节点的重复度为 $p+1=3$，使得B样条基函数 $N_{i,2}(u)$ 与域 $u \\in [0,1]$ 上的二次伯恩斯坦多项式 $B_{i,2}(u)$ 完全相同。因此，该曲线是一条二次贝塞尔曲线：\n$$\n\\mathbf{x}(u) = \\sum_{i=0}^{2} B_{i,2}(u) \\mathbf{P}_i\n$$\n其中，$p=2$ 阶的伯恩斯坦多项式为：\n$$\nB_{0,2}(u) = \\binom{2}{0}(1-u)^2 u^0 = (1-u)^2 \\\\\nB_{1,2}(u) = \\binom{2}{1}(1-u)^1 u^1 = 2u(1-u) \\\\\nB_{2,2}(u) = \\binom{2}{2}(1-u)^0 u^2 = u^2\n$$\n给定的控制点为 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$ 和 $\\mathbf{P}_2=(2,0)$。\n\n升阶过程旨在为三次贝塞尔曲线 $\\tilde{\\mathbf{x}}(u)$ 寻找一组新的控制点 $\\{\\mathbf{Q}_i\\}_{i=0}^3$，使得其几何形状与原始曲线完全相同，即对于所有 $u \\in [0,1]$，都有 $\\tilde{\\mathbf{x}}(u) = \\mathbf{x}(u)$。\n$$\n\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i\n$$\n为了找到 $\\{\\mathbf{P}_i\\}$ 和 $\\{\\mathbf{Q}_i\\}$ 之间的关系，我们可以提升原始曲线基函数的阶数。我们利用基函数构成单位分解这一性质，即 $\\sum B_{i,p}(u) = 1$，对于最简单的情况可以表示为 $(1-u)+u=1$。我们将 $\\mathbf{x}(u)$ 的表达式乘以 1：\n$$\n\\mathbf{x}(u) = ((1-u) + u) \\sum_{j=0}^{2} B_{j,2}(u) \\mathbf{P}_j = \\sum_{j=0}^{2} (1-u)B_{j,2}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} uB_{j,2}(u)\\mathbf{P}_j\n$$\n我们使用定义式 $B_{j,p}(u) = \\binom{p}{j}u^j(1-u)^{p-j}$ 来分析这些乘积：\n$$\n(1-u)B_{j,p}(u) = (1-u)\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j}} \\binom{p+1}{j}u^j(1-u)^{p+1-j} = \\frac{p+1-j}{p+1} B_{j,p+1}(u)\n$$\n$$\nuB_{j,p}(u) = u\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j+1}} \\binom{p+1}{j+1}u^{j+1}(1-u)^{p-j} = \\frac{j+1}{p+1} B_{j+1,p+1}(u)\n$$\n将这些 $p=2$ 时的恒等式代入 $\\mathbf{x}(u)$ 的表达式中：\n$$\n\\mathbf{x}(u) = \\sum_{j=0}^{2} \\frac{3-j}{3}B_{j,3}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} \\frac{j+1}{3}B_{j+1,3}(u)\\mathbf{P}_j\n$$\n让我们根据三次伯恩斯坦基函数 $B_{i,3}(u)$ 展开并合并各项：\n第一个求和项给出：\n$$\n\\frac{3}{3}B_{0,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{1,3}(u)\\mathbf{P}_1 + \\frac{1}{3}B_{2,3}(u)\\mathbf{P}_2\n$$\n第二个求和项给出（变址后）：\n$$\n\\frac{1}{3}B_{1,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{2,3}(u)\\mathbf{P}_1 + \\frac{3}{3}B_{3,3}(u)\\mathbf{P}_2\n$$\n按 $B_{i,3}(u)$ 合并和分组各项：\n$$\n\\mathbf{x}(u) = B_{0,3}(u)[\\mathbf{P}_0] + B_{1,3}(u)[\\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1] + B_{2,3}(u)[\\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2] + B_{3,3}(u)[\\mathbf{P}_2]\n$$\n通过将其与 $\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i$ 进行比较，我们得到新的控制点 $\\{\\mathbf{Q}_i\\}$：\n$$\n\\mathbf{Q}_0 = \\mathbf{P}_0 \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1 \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2 \\\\\n\\mathbf{Q}_3 = \\mathbf{P}_2\n$$\n从 $p$ 阶到 $p+1$ 阶的升阶通用公式为 $\\mathbf{Q}_i = \\frac{i}{p+1}\\mathbf{P}_{i-1} + (1-\\frac{i}{p+1})\\mathbf{P}_i$（对于 $i=1,\\ldots,p$），且 $\\mathbf{Q}_0 = \\mathbf{P}_0$ 和 $\\mathbf{Q}_{p+1} = \\mathbf{P}_p$。我们对 $p=2$ 的推导与此通用结果相符。\n\n现在，我们将这些关系式应用于给定的控制点 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$、$\\mathbf{P}_2=(2,0)$：\n$$\n\\mathbf{Q}_0 = (0,0) \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}(0,0) + \\frac{2}{3}(1,2) = \\left(\\frac{2}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}(1,2) + \\frac{1}{3}(2,0) = \\left(\\frac{2}{3}+\\frac{2}{3}, \\frac{4}{3}+0\\right) = \\left(\\frac{4}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_3 = (2,0)\n$$\n问题要求计算 $\\left\\|\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right)\\right\\|$。根据我们的推导，几何映射在升阶操作下是保持不变的，这意味着对于所有 $u \\in [0,1]$，都有 $\\mathbf{x}(u) = \\tilde{\\mathbf{x}}(u)$。因此，对于任何 $u$ 值，差分矢量 $\\mathbf{x}(u) - \\tilde{\\mathbf{x}}(u)$ 都是零矢量 $\\mathbf{0}$。\n\n为了完整性起见，我们可以在 $u=\\frac{1}{2}$ 处明确地验证这一点。\n对于原始的二次曲线：\n$$\n\\mathbf{x}\\left(\\frac{1}{2}\\right) = B_{0,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_0 + B_{1,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_1 + B_{2,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_2 \\\\\n= \\left(1-\\frac{1}{2}\\right)^2 \\mathbf{P}_0 + 2\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right)\\mathbf{P}_1 + \\left(\\frac{1}{2}\\right)^2 \\mathbf{P}_2 \\\\\n= \\frac{1}{4}(0,0) + \\frac{1}{2}(1,2) + \\frac{1}{4}(2,0) = \\left(0+\\frac{1}{2}+\\frac{2}{4}, 0+1+0\\right) = (1,1)\n$$\n对于升阶后的三次曲线：\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = B_{0,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_0 + B_{1,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_1 + B_{2,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_2 + B_{3,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_3\n$$\n在 $u=\\frac{1}{2}$ 处，三次伯恩斯坦多项式的值为 $B_{0,3}=\\frac{1}{8}$、$B_{1,3}=\\frac{3}{8}$、$B_{2,3}=\\frac{3}{8}$、$B_{3,3}=\\frac{1}{8}$。\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = \\frac{1}{8}(0,0) + \\frac{3}{8}\\left(\\frac{2}{3}, \\frac{4}{3}\\right) + \\frac{3}{8}\\left(\\frac{4}{3}, \\frac{4}{3}\\right) + \\frac{1}{8}(2,0) \\\\\n= \\left(0 + \\frac{6}{24} + \\frac{12}{24} + \\frac{2}{8}, 0 + \\frac{12}{24} + \\frac{12}{24} + 0\\right) \\\\\n= \\left(\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4}, \\frac{1}{2} + \\frac{1}{2}\\right) = (1,1)\n$$\n验证证实了 $\\mathbf{x}(\\frac{1}{2})=\\tilde{\\mathbf{x}}(\\frac{1}{2})=(1,1)$。其差值为：\n$$\n\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right) = (1,1) - (1,1) = (0,0)\n$$\n最后，我们计算这个差分矢量的欧几里得范数：\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right)\\right\\| = \\|(0,0)\\| = \\sqrt{0^2 + 0^2} = 0\n$$\n这个结果是曲线在升阶操作下几何不变性的直接推论。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "将控制连续物理问题的偏微分方程转化为离散代数系统，是伽辽金法（Galerkin method）的核心步骤，这需要精确计算积分。数值积分的准确性直接决定了最终离散系统（如刚度矩阵）的精度。本练习旨在阐明如何在等几何分析中确定高斯积分（Gaussian quadrature）所需的最小积分点数，以确保在多项式表示的极限内精确计算积分，这是保证程序正确性和计算效率的关键考量 。",
            "id": "3535321",
            "problem": "在等几何分析 (IGA) 中，考虑定义在开节点矢量 $\\Xi = \\{\\xi_1,\\xi_2,\\dots,\\xi_{n+p+1}\\}$ 上的一个 $p$ 次单变量非有理B样条基。该节点矢量将参数域划分为多个节点区间 $[\\xi_a,\\xi_{a+1}]$（其中 $a=1,\\dots, n_{\\mathrm{el}}$，$n_{\\mathrm{el}}$ 是非空区间的数量）。假设在每个区间上为小应变线性地质力学模型，其材料系数为常数，并且几何映射为仿射映射，因此雅可比行列式 $J$ 在 $[\\xi_a,\\xi_{a+1}]$ 上为常数。考虑逐个区间地组装在地质力学中出现的典型双线性形式，例如质量双线性形式 $\\int N_i N_j\\, \\rho\\, J\\, \\mathrm{d}\\xi$ 和刚度双线性形式 $\\int (\\nabla N_i)^{\\top}\\boldsymbol{C}\\,\\nabla N_j\\, J\\, \\mathrm{d}\\xi$，其中 $N_i$ 和 $N_j$ 是 $p$ 次B样条基函数，$\\rho$ 是密度，$\\boldsymbol{C}$ 是该区间上的常数本构张量。\n\n在单个区间 $[\\xi_a,\\xi_{a+1}]$ 上，$N_i$ 和 $N_j$ 是至多为 $p$ 次的多项式，因此 $N_i N_j$ 是一个至多为 $2p$ 次的多项式，而 $(\\partial_{\\xi} N_i)(\\partial_{\\xi} N_j)$ 是一个至多为 $2p-2$ 次的多项式。你的任务是为每个节点区间指定一个高斯求积法则，并论证在所述假设下，为精确积分这些基于样条的双线性形式中可能出现的任何最高为 $2p$ 次的多项式被积函数，所需的最少求积点数。\n\n哪个选项正确地指定了每个区间上的高斯求积映射以及保证在每个区间上精确积分所有最高为 $2p$ 次多项式项所需的最少高斯点数？\n\nA. 在每个区间 $[\\xi_a,\\xi_{a+1}]$ 上，使用 $n$ 点高斯-勒让德法则，其中点数为 $n=p+1$。通过 $\\xi(\\hat{\\xi}) = \\dfrac{\\xi_{a}+\\xi_{a+1}}{2}+\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}\\,\\hat{\\xi}$ 将 $\\hat{\\xi}\\in[-1,1]$ 映射到 $\\xi\\in[\\xi_a,\\xi_{a+1}]$，并通过 $w_k=\\hat{w}_k\\,\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}$ 缩放权重。这可以精确积分该区间上任何最高为 $2p$ 次的多项式被积函数（因此，在所述假设下，可以精确积分质量和刚度的被积函数）。\n\nB. 在每个区间 $[\\xi_a,\\xi_{a+1}]$ 上，使用 $n$ 点高斯-勒让德法则，其中点数为 $n=p$。B样条的高阶单元间连续性确保了在每个区间上用 $p$ 个点就能精确积分最高为 $2p$ 次的乘积。\n\nC. 在每个区间 $[\\xi_a,\\xi_{a+1}]$ 上，使用 $n$ 点高斯-洛巴托法则，其中点数为 $n=p+1$，因为包含端点与开节点矢量相符。这可以精确积分该区间上任何最高为 $2p$ 次的多项式被积函数。\n\nD. 因为B样条是全局光滑的，所以在整个参数域上使用一个具有 $n=(p+1)\\,n_{\\mathrm{el}}$ 个点的 $n$ 点高斯-勒让德法则，而无需逐区间映射。这可以精确积分整个域上任何最高为 $2p$ 次的多项式被积函数。",
            "solution": "问题陈述被评估为有效。它在等几何分析和数值积分的理论中有科学依据，是适定的、客观的，并包含足够的信息来推导出唯一解。\n\n问题的核心是确定高斯求积法则所需的最少求积点数，以便在给定区间上精确积分某个次数以下的多项式函数。高斯-勒让德求积的标准定理指出，在参考区间（通常是 $[-1, 1]$）上的一个 $n$ 点法则可以精确积分任何最高为 $2n-1$ 次的多项式。\n\n问题指定必须对质量矩阵和刚度矩阵的双线性形式进行积分。积分是逐个区间地在每个区间 $[\\xi_a, \\xi_{a+1}]$ 上执行的。在这样一个区间上，B样条基函数 $N_i(\\xi)$ 是至多为 $p$ 次的多项式。\n问题假设为：\n1. 每个区间上的几何映射是仿射的，这意味着从参数域到物理域的映射的雅可比行列式 $J$ 在该区间上是常数。\n2. 材料系数，如密度 $\\rho$ 和本构张量 $\\boldsymbol{C}$，在每个区间上是常数。\n3. 我们考虑的是单变量B样条，因此梯度算子 $\\nabla$ 实际上变成了对物理坐标的导数，而该导数通过仿射映射的（常数）雅可比行列式与对参数坐标 $\\xi$ 的导数相关。因此，$\\nabla N_i$ 涉及 $\\partial_{\\xi} N_i$。\n\n让我们分析单个区间 $[\\xi_a, \\xi_{a+1}]$ 上的被积函数：\n-   **质量矩阵被积函数**：该项的形式为 $N_i N_j \\rho J$。由于 $N_i$ 和 $N_j$ 是至多为 $p$ 次的多项式，它们的乘积 $N_i N_j$ 是一个至多为 $p+p=2p$ 次的多项式。因为 $\\rho$ 和 $J$ 在该区间上是常数，所以整个被积函数是一个至多为 $2p$ 次的多项式。\n-   **刚度矩阵被积函数**：该项涉及 $(\\nabla N_i)^{\\top}\\boldsymbol{C}\\,\\nabla N_j J$。在单变量情况下，这简化为一个与 $(\\partial_{\\xi} N_i)(\\partial_{\\xi} N_j) J (\\text{映射常数})$ 成比例的项。一个 $p$ 次多项式的导数是一个 $p-1$ 次多项式。因此，乘积 $(\\partial_{\\xi} N_i)(\\partial_{\\xi} N_j)$ 是一个至多为 $(p-1)+(p-1) = 2p-2$ 次的多项式。因此，完整的被积函数是一个至多为 $2p-2$ 次的多项式。\n\n问题要求为每个区间指定一个单一的求积法则，以保证对“这些基于样条的双线性形式中可能出现的任何最高为 $2p$ 次的多项式被积函数”进行精确积分。出现的最高次多项式是来自质量矩阵项的 $2p$ 次多项式。因此，求积法则必须足以精确积分任何最高为 $2p$ 次的多项式。\n\n设 $n$ 为高斯点数。对于高斯-勒让德法则，精确积分的最高次数是 $2n-1$。我们要求这个值至少为 $2p$。\n$$ 2n-1 \\ge 2p $$\n$$ 2n \\ge 2p+1 $$\n$$ n \\ge p + \\frac{1}{2} $$\n由于 $n$ 必须是整数，所需的最少点数是 $n = p+1$。\n使用 $n=p+1$ 个点，高斯-勒让德法则可以精确积分最高为 $2(p+1)-1 = 2p+1$ 次的多项式，这对于 $2p$ 次的质量矩阵被积函数是足够的，并且也足以积分次数较低的 $2p-2$ 次的刚度矩阵被积函数。\n\n积分必须在每个区间 $[\\xi_a, \\xi_{a+1}]$ 上执行。标准的高斯-勒让德求积法则定义在参考区间上，例如 $\\hat{\\xi} \\in [-1, 1]$。使用一个线性（仿射）映射将积分从目标区间变换到参考区间。设映射为 $\\xi(\\hat{\\xi})$。我们要求 $\\xi(-1)=\\xi_a$ 和 $\\xi(1)=\\xi_{a+1}$。满足此条件的唯一线性映射是：\n$$ \\xi(\\hat{\\xi}) = \\frac{\\xi_a+\\xi_{a+1}}{2} + \\frac{\\xi_{a+1}-\\xi_a}{2} \\hat{\\xi} $$\n微分元变换为 $\\mathrm{d}\\xi = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}\\hat{\\xi}} \\mathrm{d}\\hat{\\xi}$。这个一维映射的雅可比行列式是 $\\frac{\\mathrm{d}\\xi}{\\mathrm{d}\\hat{\\xi}} = \\frac{\\xi_{a+1}-\\xi_a}{2}$。\n一个积分变换如下：\n$$ \\int_{\\xi_a}^{\\xi_{a+1}} f(\\xi) \\, \\mathrm{d}\\xi = \\int_{-1}^{1} f(\\xi(\\hat{\\xi})) \\frac{\\xi_{a+1}-\\xi_a}{2} \\, \\mathrm{d}\\hat{\\xi} $$\n使用 $n$ 个点 $\\{\\hat{\\xi}_k, \\hat{w}_k\\}_{k=1}^n$ 在参考区间上的求积近似为：\n$$ \\int_{-1}^{1} g(\\hat{\\xi}) \\, \\mathrm{d}\\hat{\\xi} \\approx \\sum_{k=1}^n \\hat{w}_k g(\\hat{\\xi}_k) $$\n将此应用于我们变换后的积分：\n$$ \\int_{\\xi_a}^{\\xi_{a+1}} f(\\xi) \\, \\mathrm{d}\\xi \\approx \\sum_{k=1}^n \\hat{w}_k \\left( f(\\xi(\\hat{\\xi}_k)) \\frac{\\xi_{a+1}-\\xi_a}{2} \\right) = \\sum_{k=1}^n w_k f(\\xi_k) $$\n其中，目标区间上的点是 $\\xi_k = \\xi(\\hat{\\xi}_k)$，对应的权重是 $w_k = \\hat{w}_k \\frac{\\xi_{a+1}-\\xi_a}{2}$。\n\n现在我们基于这个推导来评估给出的选项。\n\n**A. 在每个区间 $[\\xi_a,\\xi_{a+1}]$ 上，使用 $n$ 点高斯-勒让德法则，其中点数为 $n=p+1$。通过 $\\xi(\\hat{\\xi}) = \\dfrac{\\xi_{a}+\\xi_{a+1}}{2}+\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}\\,\\hat{\\xi}$ 将 $\\hat{\\xi}\\in[-1,1]$ 映射到 $\\xi\\in[\\xi_a,\\xi_{a+1}]$，并通过 $w_k=\\hat{w}_k\\,\\dfrac{\\xi_{a+1}-\\xi_{a}}{2}$ 缩放权重。这可以精确积分该区间上任何最高为 $2p$ 次的多项式被积函数（因此，在所述假设下，可以精确积分质量和刚度的被积函数）。**\n- 这个选项正确地指出了点数 $n=p+1$，这保证了对最高为 $2(p+1)-1 = 2p+1$ 次的多项式进行精确积分，满足了对 $2p$ 次的要求。\n- 它指定了高斯-勒让德法则，这是多项式积分的最佳选择。\n- 它提供了从参考区间 $[-1,1]$ 到区间 $[\\xi_a, \\xi_{a+1}]$ 的正确仿射映射。\n- 它正确地陈述了求积权重的缩放，这对应于映射的雅可比行列式。\n- 该法则对质量和刚度被积函数都足够的结论是正确的。\n- **结论：正确。**\n\n**B. 在每个区间 $[\\xi_a,\\xi_{a+1}]$ 上，使用 $n$ 点高斯-勒让德法则，其中点数为 $n=p$。B样条的高阶单元间连续性确保了在每个区间上用 $p$ 个点就能精确积分最高为 $2p$ 次的乘积。**\n- 这个选项建议使用 $n=p$ 个点。一个 $n=p$ 点的高斯-勒让德法则可以精确积分最高为 $2p-1$ 次的多项式。这不足以精确积分可能为 $2p$ 次的质量矩阵项。\n- 关于“高阶单元间连续性”的理由是一种误导。数值积分是逐个区间执行的，在每个区间上，被积函数是一个多项式，其属性与函数在区间边界处的连续性无关。全局连续性不会改变区间内多项式的次数。\n- **结论：不正确。**\n\n**C. 在每个区间 $[\\xi_a,\\xi_{a+1}]$ 上，使用 $n$ 点高斯-洛巴托法则，其中点数为 $n=p+1$，因为包含端点与开节点矢量相符。这可以精确积分该区间上任何最高为 $2p$ 次的多项式被积函数。**\n- 这个选项建议使用高斯-洛巴托法则。一个 $n$ 点高斯-洛巴托法则可以精确积分最高为 $2n-3$ 次的多项式。\n- 使用 $n=p+1$ 个点，该法则对于最高为 $2(p+1)-3 = 2p-1$ 次的多项式是精确的。这对于 $2p$ 次的质量项是不够的。\n- 虽然高斯-洛巴托法则在某些数值分析场景中使用，但对于体积积分，其效率低于高斯-勒让德法则。所提供的理由很薄弱，并且不能改变该法则精度不足的数学事实。\n- **结论：不正确。**\n\n**D. 因为B样条是全局光滑的，所以在整个参数域上使用一个具有 $n=(p+1)\\,n_{\\mathrm{el}}$ 个点的 $n$ 点高斯-勒让德法则，而无需逐区间映射。这可以精确积分整个域上任何最高为 $2p$ 次的多项式被积函数。**\n- 这个选项提出了一个根本上不正确的程序。被积函数 $N_i N_j$ 是一个分段多项式，而不是在整个域上的单个多项式。此外，材料属性和雅可比行列式也只是分段常数。单个高斯-勒让德法则仅能保证对其应用域上的单个多项式函数是精确的。将其应用于分段多项式（在节点处系数不连续）不会得到精确的结果。标准且正确的方法是对每个区间上的积分求和，并对每个区间应用独立的求积法则。\n- **结论：不正确。**",
            "answer": "$$ \\boxed{A} $$"
        },
        {
            "introduction": "在处理如孔隙弹性或不可压缩性等地质力学问题时，混合公式是不可或缺的工具，但其稳定性依赖于 inf-sup (LBB) 条件的满足。这个条件对不同物理场（如位移和压力）的离散空间选择施加了严格的约束。本高阶练习将指导您为一个经典的等几何单元配对计算离散 inf-sup 常数，从而深入理解为何特定的样条空间能够为这些挑战性的约束问题提供完美的稳定近似 。",
            "id": "3535320",
            "problem": "考虑在参数域 $\\Omega = [0,1]$ 上，一维近不可压缩固体在小应变地质力学下的位移-压力混合格式。\n\n设位移空间是由具有单个单元的二次（$p = 2$）开放节点矢量构建的等几何空间，压力空间是由具有相同单个单元的线性（$p-1 = 1$）开放节点矢量构建的等几何空间。假设几何映射为单位映射，并施加齐次本质边界条件 $u(0) = 0$ 以消除刚体模态。\n\n设与体积耦合相关的双线性形式为\n$$\nb(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx,\n$$\n并为离散位移和压力空间配备范数\n$$\n\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}, \n\\qquad\n\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}.\n$$\n离散 inf–sup (Ladyzhenskaya–Babuška–Brezzi) 常数定义为\n$$\n\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}.\n$$\n\n使用上述设置：\n- 构建由单个单元上的开放节点矢量导出的 $V_{h}$ 和 $Q_{h}$ 的基函数。\n- 在离散设置中一致地施加 $u(0)=0$。\n- 从 $\\beta_{h}$ 的定义出发，推导离散 inf-sup 常数关于离散算子的可计算表达式，并针对此网格和这些等几何空间精确地计算它。\n\n最后，解释您获得的值与节点配置和连续性的关系；特别是，定性地讨论插入一个内部节点（从而引入多个单元并降低连续性）预计会如何影响离散 inf-sup 常数。请提供上述单单元开放节点配置下 $\\beta_{h}$ 的精确值作为最终结果。该常数为无量纲，因此不需要单位，也不需要四舍五入。",
            "solution": "该问题要求计算特定一维等几何单元配对的离散 inf-sup 常数 $\\beta_h$，并对结果进行后续讨论。\n\n首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 格式：位移-压力混合格式。\n- 域：$\\Omega = [0,1]$。\n- 位移空间 ($V_h$)：由二次（$p=2$）开放节点矢量构建的等几何空间，单个单元。\n- 压力空间 ($Q_h$)：由线性（$p-1=1$）开放节点矢量构建的等几何空间，单个单元。\n- 几何映射：单位映射，$x(\\xi) = \\xi$。\n- 边界条件：齐次本质边界条件 $u(0) = 0$。\n- 双线性形式：$b(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx$。\n- 位移范数：$\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}$。\n- 压力范数：$\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}$。\n- 离散 inf-sup 常数的定义：$\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它在混合有限元方法理论中，特别是在等几何分析框架内，提出了一个标准的、非平凡的问题。其格式、定义和空间都是该领域的标准。该问题是自洽的，没有矛盾、歧义或不可靠的前提。\n\n**步骤 3：结论与行动**\n该问题是有效的。将提供完整的解答。\n\n**解答推导**\n\n**第一部分：基函数的构建**\n对于域 $[0,1]$ 上具有开放节点矢量的单个单元，B-样条基函数简化为 Bernstein 多项式。\n\n- **位移空间 $V_h$ ($p=2$)：**\n单个二次单元的开放节点矢量为 $\\Xi_u = \\{0, 0, 0, 1, 1, 1\\}$。基函数是二次 Bernstein 多项式：\n$$\n\\begin{aligned}\nN_{1,2}(x) = (1-x)^2 = 1 - 2x + x^2 \\\\\nN_{2,2}(x) = 2x(1-x) = 2x - 2x^2 \\\\\nN_{3,2}(x) = x^2\n\\end{aligned}\n$$\n离散位移场 $u_h(x)$ 表示为 $u_h(x) = \\sum_{i=1}^{3} c_i N_{i,2}(x)$。\n\n- **压力空间 $Q_h$ ($p=1$)：**\n单个线性单元的开放节点矢量为 $\\Xi_q = \\{0, 0, 1, 1\\}$。基函数是线性 Bernstein 多项式：\n$$\n\\begin{aligned}\nQ_{1,1}(x) = 1-x \\\\\nQ_{2,1}(x) = x\n\\end{aligned}\n$$\n离散压力场 $q_h(x)$ 表示为 $q_h(x) = \\sum_{k=1}^{2} d_k Q_{k,1}(x)$。\n\n**第二部分：边界条件 $u(0)=0$ 的施加**\n必须在离散位移空间上施加条件 $u(0)=0$。在 $x=0$ 处，基函数的计算结果为：\n$N_{1,2}(0) = 1$, $N_{2,2}(0) = 0$, $N_{3,2}(0) = 0$。\n因此，$u_h(0) = c_1 N_{1,2}(0) + c_2 N_{2,2}(0) + c_3 N_{3,2}(0) = c_1$。\n条件 $u_h(0)=0$ 意味着 $c_1=0$。因此，受约束的位移空间由 $\\{N_{2,2}(x), N_{3,2}(x)\\}$ 张成。设 $\\mathbf{c} = \\begin{pmatrix} c_2  c_3 \\end{pmatrix}^T$ 为活性自由度向量。\n\n**第三部分：inf-sup 常数的矩阵形式**\n我们将 $\\beta_h$ 定义中的各项表示为矩阵形式。设 $\\mathbf{d} = \\begin{pmatrix} d_1  d_2 \\end{pmatrix}^T$。\n- $b(u_h, q_h) = \\int_{0}^{1} (\\mathbf{d}^T \\mathbf{Q}(x)) (\\mathbf{N}'(x)^T \\mathbf{c}) dx = \\mathbf{d}^T \\mathbf{B} \\mathbf{c}$，其中 $\\mathbf{B}_{kj} = \\int_0^1 Q_{k,1}(x) N'_{j+1,2}(x) dx$。\n- $\\|u_h\\|_V^2 = \\int_{0}^{1} |\\frac{du_h}{dx}|^2 dx = \\mathbf{c}^T \\mathbf{K} \\mathbf{c}$，其中 $\\mathbf{K}_{ij} = \\int_0^1 N'_{i+1,2}(x) N'_{j+1,2}(x) dx$。\n- $\\|q_h\\|_Q^2 = \\int_{0}^{1} |q_h|^2 dx = \\mathbf{d}^T \\mathbf{M} \\mathbf{d}$，其中 $\\mathbf{M}_{kl} = \\int_0^1 Q_{k,1}(x) Q_{l,1}(x) dx$。\n\n离散 inf-sup 常数由 $\\beta_h^2 = \\lambda_{\\min}$ 给出，其中 $\\lambda$ 是广义特征值问题的特征值：\n$$\n(\\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T) \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}\n$$\n\n**第四部分：矩阵的计算**\n所需的位移基函数的导数为：\n$N'_{2,2}(x) = 2 - 4x$\n$N'_{3,2}(x) = 2x$\n\n- **刚度矩阵 $\\mathbf{K}$** (针对受约束空间)：\n$K_{11} = \\int_0^1 (2-4x)^2 dx = \\int_0^1 (4 - 16x + 16x^2) dx = \\left[4x - 8x^2 + \\frac{16}{3}x^3\\right]_0^1 = 4-8+\\frac{16}{3} = \\frac{4}{3}$。\n$K_{12} = K_{21} = \\int_0^1 (2-4x)(2x) dx = \\int_0^1 (4x - 8x^2) dx = \\left[2x^2 - \\frac{8}{3}x^3\\right]_0^1 = 2-\\frac{8}{3} = -\\frac{2}{3}$。\n$K_{22} = \\int_0^1 (2x)^2 dx = \\int_0^1 4x^2 dx = \\left[\\frac{4}{3}x^3\\right]_0^1 = \\frac{4}{3}$。\n$$ \\mathbf{K} = \\begin{pmatrix} \\frac{4}{3}  -\\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\frac{2}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} $$\n\n- **压力质量矩阵 $\\mathbf{M}$**：\n$M_{11} = \\int_0^1 (1-x)^2 dx = \\left[-\\frac{(1-x)^3}{3}\\right]_0^1 = \\frac{1}{3}$。\n$M_{12} = M_{21} = \\int_0^1 x(1-x) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_0^1 = \\frac{1}{2}-\\frac{1}{3} = \\frac{1}{6}$。\n$M_{22} = \\int_0^1 x^2 dx = \\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{1}{3}$。\n$$ \\mathbf{M} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{1}{3} \\end{pmatrix} = \\frac{1}{6}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n- **耦合矩阵 $\\mathbf{B}$**：\n$B_{11} = \\int_0^1 (1-x)(2-4x) dx = \\int_0^1 (2-6x+4x^2) dx = \\left[2x - 3x^2 + \\frac{4}{3}x^3\\right]_0^1 = 2-3+\\frac{4}{3} = \\frac{1}{3}$。\n$B_{12} = \\int_0^1 (1-x)(2x) dx = \\int_0^1 (2x-2x^2) dx = \\left[x^2 - \\frac{2}{3}x^3\\right]_0^1 = 1-\\frac{2}{3} = \\frac{1}{3}$。\n$B_{21} = \\int_0^1 x(2-4x) dx = \\int_0^1 (2x-4x^2) dx = \\left[x^2 - \\frac{4}{3}x^3\\right]_0^1 = 1-\\frac{4}{3} = -\\frac{1}{3}$。\n$B_{22} = \\int_0^1 x(2x) dx = \\int_0^1 2x^2 dx = \\left[\\frac{2}{3}x^3\\right]_0^1 = \\frac{2}{3}$。\n$$ \\mathbf{B} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{3} \\\\ -\\frac{1}{3}  \\frac{2}{3} \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1  1 \\\\ -1  2 \\end{pmatrix} $$\n\n**第五部分：求解特征值问题**\n首先，我们求 $\\mathbf{K}^{-1}$：\n$\\det(\\mathbf{K}) = (\\frac{2}{3})^2(2 \\cdot 2 - (-1)(-1)) = \\frac{4}{9}(3) = \\frac{4}{3}$。\n$$ \\mathbf{K}^{-1} = \\frac{1}{4/3} \\begin{pmatrix} \\frac{4}{3}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\frac{3}{4} \\frac{2}{3} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} $$\n接着，我们计算矩阵 $\\mathbf{S} = \\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T$。\n$$ \\mathbf{B} \\mathbf{K}^{-1} = \\frac{1}{3}\\begin{pmatrix} 1  1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1+\\frac{1}{2}  \\frac{1}{2}+1 \\\\ -1+1  -\\frac{1}{2}+2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{3}{2}  \\frac{3}{2} \\\\ 0  \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ 0  \\frac{1}{2} \\end{pmatrix} $$\n$$ \\mathbf{S} = (\\mathbf{B} \\mathbf{K}^{-1})\\mathbf{B}^T = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ 0  \\frac{1}{2} \\end{pmatrix} \\frac{1}{3}\\begin{pmatrix} 1  -1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{1}{2}+\\frac{1}{2}  -\\frac{1}{2}+1 \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{1}{3} \\end{pmatrix} $$\n我们观察到 $\\mathbf{S} = \\mathbf{M}$。因此，广义特征值问题 $\\mathbf{S} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}$ 变为：\n$$ \\mathbf{M} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d} $$\n由于 $\\mathbf{M}$ 是可逆的（因为 $\\det(\\mathbf{M}) = \\frac{1}{9}-\\frac{1}{36} \\neq 0$），我们可以两边乘以 $\\mathbf{M}^{-1}$ 得到 $\\mathbf{I} \\mathbf{d} = \\lambda \\mathbf{d}$。特征值是单位矩阵的特征值，所以 $\\lambda_1 = \\lambda_2 = 1$。最小特征值为 $\\lambda_{\\min} = 1$。\n离散 inf-sup 常数为 $\\beta_h = \\sqrt{\\lambda_{\\min}} = \\sqrt{1} = 1$。\n\n**第六部分：讨论**\n计算出的值 $\\beta_h = 1$ 是 inf-sup 常数的最大可能值，表明这是一个完全稳定的单元配对。这个最优结果是为单个单元选择特定等几何空间的直接后果。对于 Bernstein 多项式，$p$ 次多项式导数张成的空间与 $(p-1)$ 次多项式空间是相同的。在我们的案例中，施加边界条件后，受约束的二次位移基函数的导数空间 $V'_h = \\text{span}\\{2-4x, 2x\\}$，恰好是所有线性多项式的空间。线性压力基 $Q_h = \\text{span}\\{1-x, x\\}$ 也张成了所有线性多项式的空间。因此，$V'_h = Q_h$。\n\n这意味着对于任何离散压力 $q_h \\in Q_h$，都存在一个唯一的离散位移 $u_h \\in V_h$ 使得 $\\frac{du_h}{dx} = q_h$。在 $\\beta_h$ 定义的上确界中选择这个特定的 $u_h$ 会得到：\n$$ \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{\\int q_h \\frac{du_h}{dx} dx}{\\|u_h\\|_V \\|q_h\\|_Q} \\ge \\frac{\\int q_h \\cdot q_h dx}{\\|\\frac{dq_h}{dx}\\|_{L^2}^{-1} \\|q_h\\|_Q} = \\frac{\\|q_h\\|_Q^2}{\\|q_h\\|_Q \\|q_h\\|_Q} = 1 $$\n根据柯西-施瓦茨不等式，该比值永远不会超过 $1$，因此对于任何 $q_h$，上确界都恰好是 $1$。所以，对所有 $q_h$ 取下确界的结果也是 $1$。\n\n如果插入一个内部节点（例如，在 $x=1/2$ 处），将会创建一个多单元网格。位移基函数将变为 $C^1$ 连续的二次样条，压力基将是 $C^0$ 连续的线性样条。虽然 $C^1$ 二次样条空间的导数是一个 $C^0$ 线性样条空间，并且导数空间 $V'_h$ 和压力空间 $Q_h$ 的维数将保持相等，但由于导数公式与基函数定义中使用的底层节点矢量的差异，这两个空间在函数形式上不再相同。$V'_h=Q_h$ 这一性质的丧失意味着，对于某些压力模态 $q_h$，计算中的上确界部分将产生一个严格小于 $1$ 的值。因此，插入内部节点并降低基函数的全局连续性，预计会使离散 inf-sup 常数从其完美值 $1$ 下降。该单元配对将保持稳定（$\\beta_h > 0$），但不再是“完全”稳定的。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}