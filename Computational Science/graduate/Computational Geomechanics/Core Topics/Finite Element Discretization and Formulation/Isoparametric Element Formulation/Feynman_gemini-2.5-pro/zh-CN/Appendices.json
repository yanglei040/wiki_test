{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，一个核心任务是将体力等分布式载荷转化为作用在节点上的等效力。本练习将引导你从虚功原理出发，通过等参映射的完整流程，推导并计算一致节点力 ()。这是一个掌握等参单元公式基本原理，并将理论与具体计算相结合的绝佳实践。",
            "id": "3535642",
            "problem": "在计算地质力学的有限元方法 (FEM) 中，考虑一个节点逆时针排序的单一等参双线性四边形单元，其物理坐标（单位：米）为节点 $1$：$(0,0)$，节点 $2$：$(3,0)$，节点 $3$：$(3.5,2)$，以及节点 $4$：$(-0.5,1)$。该单元具有均匀的平面外厚度 $t = 0.2$ 米，质量密度 $\\rho = 1800$ 千克/立方米。体力加速度场是由绕直线 $x=0$ 的匀速旋转引起的，由 $\\mathbf{b}(\\mathbf{x}) = \\omega^{2} x \\,\\mathbf{e}_{x}$ 给出，其中 $\\omega = 4$ 弧度/秒， $x$ 是以米为单位测量的全局笛卡尔坐标。\n\n仅使用基本原理，从平衡的弱形式和等参插值特性出发，推导该单元的一致等效节点体力向量的 $x$ 分量之和所得到的 $x$ 方向合力表达式。然后，根据给定的单元几何形状和参数，精确计算该合力。\n\n以牛顿为单位表示最终答案，并将答案四舍五入到四位有效数字。仅陈述最终数值；最终答案中不包含中间结果。",
            "solution": "该问题是适定的，并且与计算力学和有限元方法 (FEM) 的原理一致。所有必要数据均已提供。我们开始求解。\n\n一致等效节点体力向量 $\\mathbf{F}_b$ 是从虚功原理推导出来的。体力 $\\mathbf{f}_b$ 在单元体积 $V$ 上所做的虚功由下式给出：\n$$ \\delta W_b = \\int_V \\delta\\mathbf{u}^T \\mathbf{f}_b \\, dV $$\n在 FEM 框架内，单元内任意点 $\\mathbf{x}$ 的位移场 $\\mathbf{u}$ 是通过形函数矩阵 $\\mathbf{N}(\\mathbf{x})$ 从节点位移 $\\mathbf{d}$ 插值得到的：\n$$ \\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\mathbf{d} $$\n那么，虚位移场 $\\delta\\mathbf{u}$ 为：\n$$ \\delta\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\delta\\mathbf{d} $$\n将此代入虚功表达式，我们得到：\n$$ \\delta W_b = \\int_V (\\mathbf{N} \\delta\\mathbf{d})^T \\mathbf{f}_b \\, dV = \\delta\\mathbf{d}^T \\int_V \\mathbf{N}^T \\mathbf{f}_b \\, dV $$\n虚功也定义为 $\\delta W_b = \\delta\\mathbf{d}^T \\mathbf{F}_b$。通过比较这两个表达式，我们确定了一致节点体力向量：\n$$ \\mathbf{F}_b = \\int_V \\mathbf{N}^T \\mathbf{f}_b \\, dV $$\n给定的体力加速度为 $\\mathbf{b}(\\mathbf{x}) = \\omega^{2} x \\,\\mathbf{e}_{x}$。单位体积的体力为 $\\mathbf{f}_b = \\rho \\mathbf{b}$，其中 $\\rho$ 是质量密度。因此，\n$$ \\mathbf{f}_b(\\mathbf{x}) = \\begin{pmatrix} f_{bx} \\\\ f_{by} \\end{pmatrix} = \\begin{pmatrix} \\rho \\omega^2 x \\\\ 0 \\end{pmatrix} $$\n对于一个有 $4$ 个节点的二维单元，形函数矩阵 $\\mathbf{N}$ 和节点力向量 $\\mathbf{F}_b$ 的结构如下：\n$$ \\mathbf{N} = \\begin{bmatrix} N_1  0  N_2  0  N_3  0  N_4  0 \\\\ 0  N_1  0  N_2  0  N_3  0  N_4 \\end{bmatrix} \\quad , \\quad \\mathbf{F}_b = \\begin{pmatrix} (F_{b,1})_x \\\\ (F_{b,1})_y \\\\ \\vdots \\\\ (F_{b,4})_x \\\\ (F_{b,4})_y \\end{pmatrix} $$\n节点 $i$ 处节点力的 $x$ 分量为：\n$$ (F_{b,i})_x = \\int_V N_i f_{bx} \\, dV = \\int_V N_i (\\rho \\omega^2 x) \\, dV $$\n问题要求 $x$ 方向的合力，即节点力 $x$ 分量的总和：\n$$ R_x = \\sum_{i=1}^{4} (F_{b,i})_x = \\sum_{i=1}^{4} \\int_V N_i (\\rho \\omega^2 x) \\, dV $$\n根据积分的线性性质，我们可以写出：\n$$ R_x = \\int_V \\left( \\sum_{i=1}^{4} N_i \\right) (\\rho \\omega^2 x) \\, dV $$\n等参形函数的一个基本性质是单位分解性，即对于单元内的任意点 $\\mathbf{x}$，都有 $\\sum_{i=1}^{4} N_i(\\mathbf{x}) = 1$。因此，$R_x$ 的表达式简化为作用在单元上的 $x$ 方向总体力：\n$$ R_x = \\int_V \\rho \\omega^2 x \\, dV $$\n对于厚度均匀为 $t$ 的单元，体积积分可以写成对单元面积 $A$ 的积分：\n$$ R_x = \\rho \\omega^2 t \\int_A x \\, dA $$\n为了计算给定四边形的这个积分，我们使用从 $(\\xi, \\eta)$ 坐标（其中 $\\xi \\in [-1, 1]$ 且 $\\eta \\in [-1, 1]$）下的方形母单元到 $(x, y)$ 坐标下的物理单元的等参映射。微分面积元变换为 $dA = |\\mathbf{J}| d\\xi d\\eta$，其中 $|\\mathbf{J}|$ 是变换的雅可比矩阵的行列式。积分变为：\n$$ R_x = \\rho \\omega^2 t \\int_{-1}^{1} \\int_{-1}^{1} x(\\xi, \\eta) |\\mathbf{J}(\\xi, \\eta)| \\, d\\xi d\\eta $$\n坐标映射由 $x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$ 给出，其中 $N_i$ 是双线性形函数：\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n节点的物理坐标为 $(x_1, y_1) = (0,0)$，$(x_2, y_2) = (3,0)$，$(x_3, y_3) = (3.5,2)$ 和 $(x_4, y_4) = (-0.5,1)$。\n将这些坐标代入 $x$ 的映射：\n$$ x(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(3) + \\frac{1}{4}(1+\\xi)(1+\\eta)(3.5) + \\frac{1}{4}(1-\\xi)(1+\\eta)(-0.5) $$\n$$ x(\\xi, \\eta) = \\frac{1}{4} [ (3+3.5-0.5) + (3+3.5+0.5)\\xi + (-3+3.5-0.5)\\eta + (-3+3.5+0.5)\\xi\\eta ] $$\n$$ x(\\xi, \\eta) = \\frac{1}{4} (6 + 7\\xi + \\xi\\eta) $$\n雅可比矩阵为 $\\mathbf{J} = \\begin{bmatrix} \\partial x/\\partial \\xi  \\partial y/\\partial \\xi \\\\ \\partial x/\\partial \\eta  \\partial y/\\partial \\eta \\end{bmatrix}$。偏导数是：\n$$ \\frac{\\partial x}{\\partial \\xi} = \\sum \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{1}{4} [3(1-\\eta) + 3.5(1+\\eta) - (-0.5)(1+\\eta)] = \\frac{1}{4}(7+\\eta) $$\n$$ \\frac{\\partial y}{\\partial \\xi} = \\sum \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{1}{4} [0(1-\\eta) + 2(1+\\eta) - 1(1+\\eta)] = \\frac{1}{4}(1+\\eta) $$\n$$ \\frac{\\partial x}{\\partial \\eta} = \\sum \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{1}{4} [-3(1+\\xi) + 3.5(1+\\xi) + (-0.5)(1-\\xi)] = \\frac{1}{4}\\xi $$\n$$ \\frac{\\partial y}{\\partial \\eta} = \\sum \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{1}{4} [0(1+\\xi) + 2(1+\\xi) + 1(1-\\xi)] = \\frac{1}{4}(3+\\xi) $$\n雅可比矩阵的行列式为：\n$$ |\\mathbf{J}| = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{16} [(7+\\eta)(3+\\xi) - (1+\\eta)\\xi] = \\frac{1}{16} (21 + 6\\xi + 3\\eta) $$\n现在，我们构建 $R_x$ 的积分：\n$$ R_x = \\rho \\omega^2 t \\int_{-1}^{1} \\int_{-1}^{1} \\left[ \\frac{1}{4}(6 + 7\\xi + \\xi\\eta) \\right] \\left[ \\frac{1}{16}(21 + 6\\xi + 3\\eta) \\right] d\\xi d\\eta $$\n$$ R_x = \\frac{\\rho \\omega^2 t}{64} \\int_{-1}^{1} \\int_{-1}^{1} (6 + 7\\xi + \\xi\\eta)(21 + 6\\xi + 3\\eta) \\, d\\xi d\\eta $$\n我们展开被积函数中的多项式乘积：\n$$ (126 + 36\\xi + 18\\eta) + (147\\xi + 42\\xi^2 + 21\\xi\\eta) + (21\\xi\\eta + 6\\xi^2\\eta + 3\\xi\\eta^2) $$\n$$ = 126 + 183\\xi + 18\\eta + 42\\xi^2 + 42\\xi\\eta + 6\\xi^2\\eta + 3\\xi\\eta^2 $$\n我们在域 $\\xi \\in [-1, 1], \\eta \\in [-1, 1]$ 上对该表达式进行积分。由于多项式的正交性，含 $\\xi$ 或 $\\eta$ 奇次方的项积分为零。只有常数项和偶次项有非零贡献：\n$$ \\int_{-1}^{1} \\int_{-1}^{1} (126 + 42\\xi^2) \\, d\\xi d\\eta = \\int_{-1}^{1} [126\\xi + 14\\xi^3]_{-1}^{1} \\, d\\eta = \\int_{-1}^{1} [(126+14) - (-126-14)] \\, d\\eta $$\n$$ = \\int_{-1}^{1} 280 \\, d\\eta = [280\\eta]_{-1}^{1} = 280 - (-280) = 560 $$\n或者，使用标准积分恒等式：\n$$ \\int_{-1}^{1} \\int_{-1}^{1} 126 \\, d\\xi d\\eta = 126 \\times (2) \\times (2) = 504 $$\n$$ \\int_{-1}^{1} \\int_{-1}^{1} 42\\xi^2 \\, d\\xi d\\eta = 42 \\left(\\int_{-1}^{1} \\xi^2 d\\xi\\right) \\left(\\int_{-1}^{1} d\\eta\\right) = 42 \\left(\\frac{2}{3}\\right) (2) = 56 $$\n积分的总值为 $504 + 56 = 560$。\n现在我们通过代入给定参数来计算 $R_x$ 的最终值：$\\rho = 1800 \\, \\text{kg/m}^3$，$\\omega = 4 \\, \\text{rad/s}$ 和 $t = 0.2 \\, \\text{m}$。\n$$ R_x = \\frac{1800 \\times 4^2 \\times 0.2}{64} \\times 560 $$\n$$ R_x = \\frac{1800 \\times 16 \\times 0.2}{64} \\times 560 = \\frac{1800 \\times 0.2}{4} \\times 560 $$\n$$ R_x = 90 \\times 560 = 50400 \\, \\text{N} $$\n问题要求答案四舍五入到四位有效数字。精确值 $50400$ 可以用科学记数法写成 $5.040 \\times 10^4$，它有四位有效数字。因此，无需进一步四舍五入。",
            "answer": "$$\\boxed{50400}$$"
        },
        {
            "introduction": "从静力学转向动力学分析，单元的惯性特性通过其质量矩阵来描述。本练习探讨了两种常见的质量矩阵形式——一致质量矩阵和集中质量矩阵 ()。通过推导它们迹的比率，本练习巧妙地利用了形函数的单位分解特性，揭示了两种列式在基本层面上的深刻联系，这有助于理解在计算精度和效率之间的权衡。",
            "id": "3535709",
            "problem": "考虑平面应变条件下均质、干燥土层中的瞬态波传播问题，该问题通过有限元法（FEM）进行离散化，使用一个覆盖了角节点为 $(0,0)$、$(a,0)$、$(a,b)$ 和 $(0,b)$（其中 $a0$ 且 $b0$）的矩形区域的单个等参数双线性 $4$ 节点四边形单元。土的质量密度为恒定的 $\\rho0$。母（参考）坐标系为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，标准双线性形函数为\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n设等参数映射为 $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)x_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)y_i$，雅可比矩阵为 $\\mathbf{J}=\\partial(x,y)/\\partial(\\xi,\\eta)$，其行列式在单元上满足 $\\det\\mathbf{J}0$。一致单元质量矩阵定义为\n$$\n\\mathbf{M}_c = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T\\mathbf{N}\\, d\\Omega,\\quad \\text{其中 } \\mathbf{N}=[N_1\\;N_2\\;N_3\\;N_4],\n$$\n并且，在等参数映射下，$d\\Omega = \\det\\mathbf{J}\\, d\\xi\\, d\\eta$。集中单元质量矩阵通过标准的行和对角化近似得到，\n$$\n\\mathbf{M}_\\ell = \\mathrm{diag}\\big(\\mathbf{M}_c\\,\\mathbf{1}\\big),\\quad \\text{其中 } \\mathbf{1}=[1\\;1\\;1\\;1]^T.\n$$\n从这些定义出发，不使用任何预先计算好的积分，推导一致质量矩阵的迹与集中质量矩阵的迹之比 $r$ 的精确表达式，\n$$\nr \\equiv \\frac{\\mathrm{tr}(\\mathbf{M}_c)}{\\mathrm{tr}(\\mathbf{M}_\\ell)},\n$$\n并以单个精确有理数的形式给出 $r$ 的最终值。答案是无量纲的，因此不需要单位。无需四舍五入；报告精确值。",
            "solution": "该问题是有效的，因为它科学上基于有限元法的原理，提法恰当且所有必要信息均已提供，并且陈述客观、没有歧义。因此，我们可以进行完整的推导。\n\n目标是计算定义为如下的比率 $r$：\n$$\nr = \\frac{\\mathrm{tr}(\\mathbf{M}_c)}{\\mathrm{tr}(\\mathbf{M}_\\ell)}\n$$\n其中 $\\mathbf{M}_c$ 是一致质量矩阵，$\\mathbf{M}_\\ell$ 是单个矩形等参数单元的集中质量矩阵。\n\n首先，我们确定等参数映射的雅可比矩阵。物理域 $(x,y)$ 中矩形单元的角节点为 $(x_1, y_1) = (0,0)$、$(x_2, y_2) = (a,0)$、$(x_3, y_3) = (a,b)$ 和 $(x_4, y_4) = (0,b)$。从母域 $(\\xi, \\eta)$ 到物理域的等参数映射由下式给出：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)x_i = N_1(0) + N_2(a) + N_3(a) + N_4(0) = a(N_2 + N_3)\n$$\n$$\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)y_i = N_1(0) + N_2(0) + N_3(b) + N_4(b) = b(N_3 + N_4)\n$$\n使用所给的形函数 $N_i$ 的定义：\n$$\nN_2 + N_3 = \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta+1+\\eta) = \\frac{1}{2}(1+\\xi)\n$$\n$$\nN_3 + N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)(1+\\xi+1-\\xi) = \\frac{1}{2}(1+\\eta)\n$$\n因此，映射为：\n$$\nx(\\xi,\\eta) = \\frac{a}{2}(1+\\xi) \\quad \\text{和} \\quad y(\\xi,\\eta) = \\frac{b}{2}(1+\\eta)\n$$\n雅可比矩阵 $\\mathbf{J}$ 的分量为 $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$：\n$$\nJ_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{a}{2}, \\quad J_{12} = \\frac{\\partial x}{\\partial \\eta} = 0\n$$\n$$\nJ_{21} = \\frac{\\partial y}{\\partial \\xi} = 0, \\quad J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\frac{b}{2}\n$$\n所以，雅可比矩阵为 $\\mathbf{J} = \\begin{pmatrix} a/2  0 \\\\ 0  b/2 \\end{pmatrix}$。雅可比行列式为：\n$$\n\\det\\mathbf{J} = \\left(\\frac{a}{2}\\right)\\left(\\frac{b}{2}\\right) - (0)(0) = \\frac{ab}{4}\n$$\n由于 $a0$ 且 $b0$，$\\det\\mathbf{J}0$ 符合要求。该行列式在单元上是常数，这简化了积分过程。\n\n接下来，我们计算一致质量矩阵的迹 $\\mathrm{tr}(\\mathbf{M}_c)$。一致质量矩阵由下式给出：\n$$\n\\mathbf{M}_c = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T\\mathbf{N}\\, d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} \\rho\\, \\mathbf{N}^T(\\xi,\\eta)\\mathbf{N}(\\xi,\\eta)\\, \\det\\mathbf{J}\\, d\\xi\\, d\\eta\n$$\n$\\mathbf{M}_c$ 的分量为：\n$$\n(M_c)_{ij} = \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} N_i(\\xi,\\eta)N_j(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n$\\mathbf{M}_c$ 的迹是其对角元素之和：\n$$\n\\mathrm{tr}(\\mathbf{M}_c) = \\sum_{i=1}^{4} (M_c)_{ii} = \\rho \\frac{ab}{4} \\sum_{i=1}^{4} \\int_{-1}^{1}\\int_{-1}^{1} N_i^2(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n由于形函数的结构，对于所有的 $i=1,2,3,4$，$N_i^2$ 的积分都是相同的。让我们为 $i=1$ 计算它：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} N_1^2(\\xi,\\eta)\\, d\\xi\\, d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} \\left(\\frac{1}{4}(1-\\xi)(1-\\eta)\\right)^2 d\\xi\\, d\\eta = \\frac{1}{16} \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\int_{-1}^{1} (1-\\eta)^2 d\\eta\n$$\n我们计算这个一维积分：\n$$\n\\int_{-1}^{1} (1-u)^2 du = \\left[ -\\frac{(1-u)^3}{3} \\right]_{-1}^{1} = -\\frac{(1-1)^3}{3} - \\left(-\\frac{(1-(-1))^3}{3}\\right) = 0 + \\frac{2^3}{3} = \\frac{8}{3}\n$$\n因此，该二重积分为：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} N_1^2(\\xi,\\eta)\\, d\\xi\\, d\\eta = \\frac{1}{16} \\left(\\frac{8}{3}\\right) \\left(\\frac{8}{3}\\right) = \\frac{64}{16 \\times 9} = \\frac{4}{9}\n$$\n根据对称性，这个结果对所有 $N_i^2$ 都成立。所以，$\\mathbf{M}_c$ 的对角元素为：\n$$\n(M_c)_{ii} = \\rho \\frac{ab}{4} \\left(\\frac{4}{9}\\right) = \\frac{\\rho ab}{9}\n$$\n一致质量矩阵的迹是这四个相同对角元素之和：\n$$\n\\mathrm{tr}(\\mathbf{M}_c) = 4 \\times \\frac{\\rho ab}{9} = \\frac{4\\rho ab}{9}\n$$\n\n现在，我们计算集中质量矩阵的迹 $\\mathrm{tr}(\\mathbf{M}_\\ell)$。集中质量矩阵通过行和技术定义：$\\mathbf{M}_\\ell = \\mathrm{diag}(\\mathbf{M}_c\\mathbf{1})$。其对角元素为 $(M_\\ell)_{ii} = \\sum_{j=1}^{4} (M_c)_{ij}$。迹是这些对角元素之和：\n$$\n\\mathrm{tr}(\\mathbf{M}_\\ell) = \\sum_{i=1}^{4} (M_\\ell)_{ii} = \\sum_{i=1}^{4} \\sum_{j=1}^{4} (M_c)_{ij}\n$$\n这是一致质量矩阵 $\\mathbf{M}_c$ 中所有元素的总和。我们可以直接计算这个和：\n$$\n\\sum_{i=1}^{4} \\sum_{j=1}^{4} (M_c)_{ij} = \\sum_{i=1}^{4} \\sum_{j=1}^{4} \\left( \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} N_i N_j \\, d\\xi\\, d\\eta \\right) = \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\left(\\sum_{i=1}^{4} N_i\\right) \\left(\\sum_{j=1}^{4} N_j\\right) d\\xi\\, d\\eta\n$$\n插值形函数的一个基本性质是它们构成单位分解，即对于所有的 $(\\xi, \\eta)$，$\\sum_{k=1}^{4} N_k(\\xi, \\eta) = 1$。将此性质代入表达式中：\n$$\n\\mathrm{tr}(\\mathbf{M}_\\ell) = \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} (1)(1)\\, d\\xi\\, d\\eta = \\rho \\frac{ab}{4} \\left[ \\xi \\right]_{-1}^{1} \\left[ \\eta \\right]_{-1}^{1} = \\rho \\frac{ab}{4} (2)(2) = \\rho ab\n$$\n在物理上，$\\mathrm{tr}(\\mathbf{M}_\\ell)$ 代表单元的总质量，即密度 $\\rho$ 乘以面积 $ab$。\n\n最后，我们计算比率 $r$：\n$$\nr = \\frac{\\mathrm{tr}(\\mathbf{M}_c)}{\\mathrm{tr}(\\mathbf{M}_\\ell)} = \\frac{\\frac{4\\rho ab}{9}}{\\rho ab}\n$$\n$\\rho$、$a$ 和 $b$ 项被消去，得到最终的无量纲值：\n$$\nr = \\frac{4}{9}\n$$\n这个结果是所要求的精确有理数。",
            "answer": "$$ \\boxed{\\frac{4}{9}} $$"
        },
        {
            "introduction": "虽然等参单元功能强大，但从理想的父单元到扭曲的物理单元的几何映射可能会产生意想不到的后果。本编程练习 () 旨在量化单元扭曲如何影响剪切带方向等物理现象的预测精度。这是一个至关重要的实践，它揭示了雅可比矩阵的各向异性如何直接转化为物理预测的误差，为进行高保真度的岩土力学模拟提供了宝贵的见解。",
            "id": "3535712",
            "problem": "要求您实现一个程序，量化在一个双线性四边形等参单元中，当一个朴素的程序忽略了等参映射引入的各向异性时，计算出的剪切带方向对单元畸变的敏感程度。在小应变假设下进行二维分析。基本理论应包括四节点四边形单元的双线性形函数等参映射、小应变运动学以及梯度通过雅可比矩阵的变换。\n\n考虑一个四节点双线性等参四边形单元（通常记作 $Q_4$ 单元）。设母单元坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$。从母单元到物理空间的映射由双线性插值定义\n$$\n\\mathbf{x}(\\xi,\\eta) \\;=\\; \\sum_{a=1}^{4} N_a(\\xi,\\eta)\\,\\mathbf{x}_a,\n$$\n其中 $\\mathbf{x}_a = [x_a,y_a]^T$ 是节点 $a$ 的物理坐标，而 $N_a(\\xi,\\eta)$ 是标准双线性形函数。在点 $(\\xi,\\eta)$ 处的雅可比矩阵为\n$$\n\\mathbf{J}(\\xi,\\eta) \\;=\\; \\frac{\\partial \\mathbf{x}}{\\partial(\\xi,\\eta)} \\;=\\; \\begin{bmatrix}\n\\sum_{a=1}^{4} x_a\\,\\frac{\\partial N_a}{\\partial \\xi}  \\sum_{a=1}^{4} x_a\\,\\frac{\\partial N_a}{\\partial \\eta} \\\\\n\\sum_{a=1}^{4} y_a\\,\\frac{\\partial N_a}{\\partial \\xi}  \\sum_{a=1}^{4} y_a\\,\\frac{\\partial N_a}{\\partial \\eta}\n\\end{bmatrix}.\n$$\n在小应变运动学中，空间梯度通过 $\\nabla_{\\mathbf{x}} = \\mathbf{J}^{-T}\\,\\nabla_{(\\xi,\\eta)}$ 进行变换。因此，空间方向受到 $\\mathbf{J}$ 各向异性的影响。\n\n假设一个真实的物理剪切带法线由物理空间中的单位向量 $\\mathbf{n}_0 = [\\cos\\theta_0,\\sin\\theta_0]^T$ 指定。一个忽略了等参映射各向异性的朴素离散程序可能会错误地将 $\\mathbf{n}_0$ 视为母空间法线，然后通过梯度变换将其映射到物理空间，从而预测出一个法线\n$$\n\\widehat{\\mathbf{n}} \\;\\propto\\; \\mathbf{J}^{-T}\\,\\mathbf{n}_0,\n$$\n并归一化为单位长度。由此产生的方向误差定义为 $\\mathbf{n}_0$ 和 $\\widehat{\\mathbf{n}}$ 之间的最小物理角，\n$$\n\\Delta\\theta \\;=\\; \\arccos\\left(\\big|\\mathbf{n}_0\\cdot \\widehat{\\mathbf{n}}\\big|\\right),\n$$\n由于线法线对称性，该角度位于 $[0,\\pi/2]$ 区间内。此误差由雅可比矩阵的各向异性和扭曲度驱动，并通过等参格式中的链式法则，由应变-位移矩阵中相应的扭曲度驱动。为了进行解释性分析，定义度量张量\n$$\n\\mathbf{M} \\;=\\; \\mathbf{J}^{-T}\\,\\mathbf{J}^{-1},\n$$\n其特征值量化了方向映射的各向异性。可以定义一个各向异性指数\n$$\n\\rho \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}(\\mathbf{M})}{\\lambda_{\\min}(\\mathbf{M})}},\n$$\n以及一个扭曲度指数\n$$\ns \\;=\\; \\frac{|M_{12}|}{\\sqrt{M_{11}\\,M_{22}}}.\n$$\n这些指数无需打印；它们提供了一种将畸变与方向误差关联起来的方法。\n\n所有计算均使用单元形心 $(\\xi,\\eta)=(0,0)$。在该点，标准双线性形函数的导数为\n$$\n\\left.\\frac{\\partial N}{\\partial \\xi}\\right|_{(0,0)} \\;=\\; \\left[-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4},\\,-\\frac{1}{4}\\right],\\quad\n\\left.\\frac{\\partial N}{\\partial \\eta}\\right|_{(0,0)} \\;=\\; \\left[-\\frac{1}{4},\\,-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4}\\right].\n$$\n\n请实现一个程序，针对下方的测试套件，计算每个单元和每个目标真实方向 $\\theta_0$ 对应的方向误差 $\\Delta\\theta$ 列表（以度为单位表示）。使用以下测试套件。\n\n- 单元 $E_0$（正方形，单位为米）：节点坐标按 $a=1,2,3,4$ 排序，分别对应于母单元节点 $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$，\n$$\n[(0,0),(1,0),(1,1),(0,1)].\n$$\n- 单元 $E_1$（具有长宽比的矩形，单位为米）：\n$$\n[(0,0),(2,0),(2,1),(0,1)].\n$$\n- 单元 $E_2$（扭斜的平行四边形，单位为米）：\n$$\n[(0,0),(2,0.2),(2,1.2),(0,1)].\n$$\n\n对于每个单元，在形心处计算四个真实物理剪切带方向角（以弧度为单位）：\n$$\n\\theta_0 \\in \\left\\{0,\\,\\frac{\\pi}{8},\\,\\frac{\\pi}{4},\\,\\frac{3\\pi}{8}\\right\\}.\n$$\n对于每一对单元和 $\\theta_0$，以度为单位计算 $\\Delta\\theta$ 并四舍五入到六位小数。使用以下角度单位说明：所有输入角度均以弧度为单位；要求输出以度为单位。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按上述顺序（先按单元，再按角度）排列，即：\n$$\n[E_0\\text{ with }\\theta_0=0,\\; E_0\\text{ with }\\theta_0=\\pi/8,\\; E_0\\text{ with }\\theta_0=\\pi/4,\\; E_0\\text{ with }\\theta_0=3\\pi/8,\\; E_1\\text{ with the same four angles},\\; E_2\\text{ with the same four angles}].\n$$\n每个条目必须是四舍五入到六位小数的浮点数。\n\n所有物理坐标的单位均为米。最终答案（方向误差）必须以度表示，并四舍五入到六位小数。最终输出格式必须严格为如下单行形式\n$$\n[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_{12}].\n$$",
            "solution": "该问题是有效的，因为它提出了一个在计算力学领域中定义明确、有科学依据的问题。所有必要的数据和数学公式都已提供，从而可以得出一个唯一且可验证的解。任务是计算当朴素计算忽略了映射引起的各向异性时，双线性四边形等参单元中剪切带法线的方向误差 $\\Delta\\theta$。\n\n为每个给定的单元和真实方向角 $\\theta_0$ 计算方向误差 $\\Delta\\theta$ 的步骤如下。所有计算都在单元形心处执行，此处的母单元坐标为 $(\\xi,\\eta)=(0,0)$。\n\n首先，我们确定单元的几何形状和必要的导数。对于一个节点坐标为 $\\mathbf{x}_a = [x_a, y_a]^T$（其中 $a=1,2,3,4$）的四节点四边形单元，在形心处计算其等参映射 $\\mathbf{x}(\\xi,\\eta)$ 的雅可比矩阵 $\\mathbf{J}$。雅可比矩阵的分量由下式给出：\n$$\nJ_{ij} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\xi_j} x_{ai}\n$$\n其中 $i,j \\in \\{1,2\\}$，$(\\xi_1, \\xi_2) = (\\xi, \\eta)$，且 $(x_{a1}, x_{a2}) = (x_a, y_a)$。在单元形心 $(\\xi,\\eta)=(0,0)$ 处，双线性形函数 $N_a$ 的导数已给出：\n$$\n\\left.\\frac{\\partial N}{\\partial \\xi}\\right|_{(0,0)} = \\left[-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4},\\,-\\frac{1}{4}\\right]\n$$\n$$\n\\left.\\frac{\\partial N}{\\partial \\eta}\\right|_{(0,0)} = \\left[-\\frac{1}{4},\\,-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4}\\right]\n$$\n节点排序 $a=1,2,3,4$ 分别对应于母空间角点 $(-1,-1), (1,-1), (1,1), (-1,1)$。利用这些值和每个单元给定的节点坐标，可以组装出 $2 \\times 2$ 的雅可比矩阵 $\\mathbf{J}$。\n\n其次，真实的物理剪切带法线由给定方向角 $\\theta_0$ 的单位向量 $\\mathbf{n}_0$ 定义：\n$$\n\\mathbf{n}_0 = \\begin{bmatrix} \\cos\\theta_0 \\\\ \\sin\\theta_0 \\end{bmatrix}\n$$\n\n第三，我们确定被错误预测的法线 $\\widehat{\\mathbf{n}}$。朴素的程序将 $\\mathbf{n}_0$ 视为母空间中的向量，并使用与梯度相同的变换规则，即通过逆转置雅可比矩阵 $\\mathbf{J}^{-T}$，将其变换到物理空间。这给出了一个预测的（但未归一化的）向量 $\\mathbf{v}$：\n$$\n\\mathbf{v} = \\mathbf{J}^{-T} \\mathbf{n}_0\n$$\n为计算 $\\mathbf{J}^{-T}$，我们首先计算矩阵的逆 $\\mathbf{J}^{-1}$，然后求其转置 $(\\mathbf{J}^{-1})^T$。然后通过对 $\\mathbf{v}$ 进行归一化来找到预测的法线方向：\n$$\n\\widehat{\\mathbf{n}} = \\frac{\\mathbf{v}}{||\\mathbf{v}||}\n$$\n\n第四，方向误差 $\\Delta\\theta$ 是真实法线 $\\mathbf{n}_0$ 与预测法线 $\\widehat{\\mathbf{n}}$ 之间的最小物理角。这通过点积计算：\n$$\n\\cos(\\Delta\\theta_{abs}) = \\mathbf{n}_0 \\cdot \\widehat{\\mathbf{n}}\n$$\n问题将误差指定在 $[0, \\pi/2]$ 范围内，这对应于由法线定义的直线之间的夹角。这可以通过在应用反余弦函数之前对点积取绝对值来实现：\n$$\n\\Delta\\theta_{\\text{rad}} = \\arccos\\left(\\left|\\mathbf{n}_0 \\cdot \\widehat{\\mathbf{n}}\\right|\\right)\n$$\n最后，将结果从弧度转换为度：\n$$\n\\Delta\\theta_{\\text{deg}} = \\Delta\\theta_{\\text{rad}} \\times \\frac{180^\\circ}{\\pi}\n$$\n对每个单元（$E_0$，$E_1$，$E_2$）和每个指定的角度 $\\theta_0 \\in \\{0, \\pi/8, \\pi/4, 3\\pi/8\\}$ 重复此过程。得到的 $\\Delta\\theta_{\\text{deg}}$ 值四舍五入到六位小数。\n\n对于像正方形 $E_0$ 这样的未畸变单元，其形心处的雅可比矩阵是各向同性的，即 $\\mathbf{J} = c\\mathbf{I}$，其中 $c$ 是一个标量，$\\mathbf{I}$ 是单位矩阵。在这种情况下，$\\mathbf{J}^{-T} = (1/c)\\mathbf{I}$，变换只是对向量 $\\mathbf{n}_0$ 进行缩放。归一化会消除这种缩放，因此 $\\widehat{\\mathbf{n}} = \\mathbf{n}_0$，从而导致零误差 $\\Delta\\theta = 0$。对于畸变单元，$\\mathbf{J}$ 不是一个缩放的单位矩阵，这会导致一个非零的方向误差，该误差既取决于单元的畸变，也取决于初始角度 $\\theta_0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the shear band orientation error due to naive isoparametric mapping.\n    \"\"\"\n    # Define the derivatives of the shape functions at the centroid (xi, eta) = (0, 0).\n    # dN/d_xi for nodes 1, 2, 3, 4\n    dN_dxi = np.array([-0.25, 0.25, 0.25, -0.25])\n    # dN/d_eta for nodes 1, 2, 3, 4\n    dN_deta = np.array([-0.25, -0.25, 0.25, 0.25])\n\n    # Node ordering a=1,2,3,4 corresponds to parent nodes (xi,eta)=(-1,-1),(1,-1),(1,1),(-1,1).\n    # Element E0 (square)\n    E0_coords = (np.array([0., 1., 1., 0.]), np.array([0., 0., 1., 1.]))\n    # Element E1 (rectangle)\n    E1_coords = (np.array([0., 2., 2., 0.]), np.array([0., 0., 1., 1.]))\n    # Element E2 (skewed parallelogram)\n    E2_coords = (np.array([0., 2., 2., 0.]), np.array([0., 0.2, 1.2, 1.]))\n\n    # Define the test suite of elements and orientation angles.\n    elements = [E0_coords, E1_coords, E2_coords]\n    thetas = [0., np.pi/8, np.pi/4, 3*np.pi/8]\n\n    results = []\n\n    for x_coords, y_coords in elements:\n        # Calculate the Jacobian matrix J at the centroid.\n        J = np.zeros((2, 2))\n        J[0, 0] = np.dot(x_coords, dN_dxi)\n        J[0, 1] = np.dot(x_coords, dN_deta)\n        J[1, 0] = np.dot(y_coords, dN_dxi)\n        J[1, 1] = np.dot(y_coords, dN_deta)\n\n        # Calculate the inverse-transpose of the Jacobian.\n        try:\n            J_inv_T = np.linalg.inv(J).T\n        except np.linalg.LinAlgError:\n            # Handle singular Jacobian if necessary, though not expected for these elements.\n            # For a singular matrix, we would have infinite error, but this case is invalid.\n            # For this problem, we can assume J is always invertible.\n            results.extend([float('nan')] * len(thetas))\n            continue\n\n        for theta_0 in thetas:\n            # Define the true physical normal vector n_0.\n            n0 = np.array([np.cos(theta_0), np.sin(theta_0)])\n\n            # Calculate the predicted normal vector n_hat.\n            # v is the un-normalized predicted vector.\n            v = J_inv_T @ n0\n            \n            # Normalize v to get the unit vector n_hat.\n            norm_v = np.linalg.norm(v)\n            if norm_v  1e-15: # handles potential division by zero\n                # This case implies n_0 is in the null space of J_inv_T, error is ill-defined\n                # or can be considered max (90 degrees). For this problem, it won't occur.\n                delta_theta_deg = 90.0\n            else:\n                n_hat = v / norm_v\n\n                # Calculate the orientation error delta_theta.\n                # The dot product between two unit vectors is the cosine of the angle between them.\n                # We take the absolute value as per the problem to get the smallest angle in [0, pi/2].\n                cos_delta_theta = np.abs(np.dot(n0, n_hat))\n\n                # Clip the value to be within [-1, 1] to avoid domain errors in arccos\n                # due to floating point inaccuracies.\n                cos_delta_theta = np.clip(cos_delta_theta, -1.0, 1.0)\n                \n                delta_theta_rad = np.arccos(cos_delta_theta)\n                delta_theta_deg = np.rad2deg(delta_theta_rad)\n\n            # Round the result to six decimal places and append to the list.\n            results.append(round(delta_theta_deg, 6))\n\n    # Format the final output as a single line: [result1,result2,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}