{
    "hands_on_practices": [
        {
            "introduction": "The Finite Element Method (FEM) provides powerful approximations to complex continuum mechanics problems. A crucial first step in mastering FEM is to understand and quantify the error introduced by this discretization. This practice makes the abstract concept of discretization error tangible by guiding you to derive both the exact analytical solution and a simple one-element FEM solution for a bar under self-weight, a common scenario in geomechanics . You will then use the energy norm, a natural and rigorous metric in solid mechanics, to quantify the difference between the continuous reality and the discrete model.",
            "id": "3498577",
            "problem": "Consider a prismatic, uniform bar of length $L$, cross-sectional area $A$, and Young's modulus $E$ lying along the spatial coordinate $x \\in [0,L]$. The bar is subjected to a constant body force per unit volume $b$ acting in the axial direction. Assume small strains and linear elasticity. The left end at $x=0$ is fixed ($u(0)=0$), and the right end at $x=L$ is traction-free in the axial direction (zero axial force at $x=L$). \n\nStarting solely from axial equilibrium and the linear constitutive relation appropriate for a one-dimensional bar in computational geomechanics, derive the analytical displacement field $u(x)$ that satisfies the boundary conditions. Then, using the Finite Element Method (FEM) with a single two-node linear bar element spanning the entire domain $[0,L]$, construct the one-element finite element displacement field $u_h(x)$ with a consistent body-force load representation and the given natural boundary condition. \n\nQuantify the discretization error by the relative energy norm, defined as the ratio of the energy norm of the error field to the energy norm of the exact solution, using the energy norm induced by the one-dimensional linear elastic internal energy. Provide the exact value of this relative error as a pure number without units. No rounding is required.",
            "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- A prismatic, uniform bar of length $L$, cross-sectional area $A$, and Young's modulus $E$.\n- The bar is oriented along the $x$-axis, occupying the domain $x \\in [0,L]$.\n- A constant body force per unit volume, $b$, acts in the axial direction.\n- Assumptions: small strains and linear elasticity.\n- Boundary conditions:\n    1.  Fixed end at $x=0$: $u(0)=0$.\n    2.  Traction-free end at $x=L$: zero axial force.\n- The task is to:\n    1.  Derive the analytical displacement field $u(x)$.\n    2.  Derive the finite element displacement field $u_h(x)$ using a single two-node linear element.\n    3.  Quantify the discretization error using the relative energy norm, $\\eta = \\frac{||u-u_h||_E}{||u||_E}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard exercise in solid mechanics and computational methods. It is based on the fundamental principles of axial equilibrium of a bar, linear elasticity (Hooke's Law), and the Finite Element Method (FEM). All concepts are firmly established within the field of computational geomechanics and engineering.\n- **Well-Posed:** The problem is a second-order ordinary differential equation with one essential (Dirichlet) boundary condition, $u(0)=0$, and one natural (Neumann) boundary condition (zero force at $x=L$). This combination ensures the existence of a unique, stable solution.\n- **Objective:** The problem statement is precise, quantitative, and free of subjective or ambiguous language. All parameters ($L, A, E, b$) are clearly defined.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, objective, and complete. It is therefore deemed **valid**. A full solution will be provided.\n\n### Analytical Solution Derivation\nThe governing equation for axial equilibrium of a one-dimensional bar subjected to a body force is derived from force balance on a differential element. The equilibrium equation in terms of axial stress $\\sigma_{xx}$ and body force per unit volume $b$ is:\n$$ \\frac{d\\sigma_{xx}}{dx} + b = 0 $$\nFor linear elasticity, the constitutive relation (Hooke's Law) is:\n$$ \\sigma_{xx} = E \\epsilon_{xx} $$\nwhere $E$ is the Young's modulus and $\\epsilon_{xx}$ is the axial strain. The strain-displacement relationship for small strains is:\n$$ \\epsilon_{xx} = \\frac{du}{dx} $$\nwhere $u(x)$ is the axial displacement field.\nSubstituting the strain-displacement and constitutive relations into the equilibrium equation yields the governing differential equation for the displacement field $u(x)$:\n$$ \\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + b = 0 $$\nSince $E$ is constant for a uniform bar, this simplifies to:\n$$ E \\frac{d^2u}{dx^2} = -b $$\nIntegrating once with respect to $x$ gives:\n$$ E \\frac{du}{dx} = -bx + C_1 $$\nwhere $C_1$ is a constant of integration. Integrating a second time gives:\n$$ E u(x) = -\\frac{bx^2}{2} + C_1x + C_2 $$\nwhere $C_2$ is a second constant of integration. These constants are determined by applying the boundary conditions.\n\n1.  **Fixed end at $x=0$**: $u(0) = 0$.\n    $$ E u(0) = -\\frac{b(0)^2}{2} + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n2.  **Traction-free end at $x=L$**: The axial force $N(x) = A\\sigma_{xx}(x)$ must be zero at $x=L$.\n    $$ N(x) = A\\sigma_{xx} = A E \\frac{du}{dx} $$\n    Using the result from the first integration:\n    $$ N(x) = A(-bx + C_1) $$\n    Applying the boundary condition $N(L)=0$:\n    $$ N(L) = A(-bL + C_1) = 0 \\implies C_1 = bL $$\nSubstituting the values of $C_1$ and $C_2$ back into the expression for $u(x)$, we obtain the exact analytical solution:\n$$ E u(x) = -\\frac{bx^2}{2} + bLx $$\n$$ u(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) $$\n\n### Finite Element Solution Derivation\nWe model the bar with a single two-node linear element spanning the domain $[0,L]$. The nodes are at $x_1=0$ and $x_2=L$. The displacement field $u_h(x)$ is interpolated from the nodal displacements $d_1$ and $d_2$ using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$ u_h(x) = N_1(x)d_1 + N_2(x)d_2 $$\nThe shape functions are:\n$$ N_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L} $$\nThe element stiffness matrix $\\mathbf{k}$ and consistent body force vector $\\mathbf{f}_b$ are given by:\n$$ \\mathbf{k} = \\frac{AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n$$ \\mathbf{f}_b = \\int_{V} \\mathbf{N}^T b \\, dV = \\int_0^L A \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} b \\, dx = Ab \\int_0^L \\begin{pmatrix} 1 - x/L \\\\ x/L \\end{pmatrix} dx $$\n$$ \\mathbf{f}_b = Ab \\left[ \\begin{matrix} x - \\frac{x^2}{2L} \\\\ \\frac{x^2}{2L} \\end{matrix} \\right]_0^L = Ab \\begin{pmatrix} L - L/2 \\\\ L/2 \\end{pmatrix} = \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nThe finite element system of equations is $\\mathbf{k}\\mathbf{d} = \\mathbf{f}$, where $\\mathbf{f} = \\mathbf{f}_{ext} + \\mathbf{f}_b$. The external point load vector is $\\mathbf{f}_{ext} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix}$, where $R_1$ is the reaction force at the fixed node $1$, and the force at node $2$ is zero due to the traction-free boundary condition.\nThe system is:\n$$ \\frac{AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix} + \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nApplying the essential boundary condition $u(0)=0 \\implies d_1=0$. We can solve for the unknown displacement $d_2$ using the second equation of the system:\n$$ \\frac{AE}{L} (-d_1 + d_2) = 0 + \\frac{AbL}{2} $$\n$$ \\frac{AE}{L} (0 + d_2) = \\frac{AbL}{2} \\implies d_2 = \\frac{AbL}{2} \\frac{L}{AE} = \\frac{bL^2}{2E} $$\nThe finite element displacement field is thus:\n$$ u_h(x) = N_1(x)(0) + N_2(x)d_2 = \\frac{x}{L} \\left( \\frac{bL^2}{2E} \\right) = \\frac{bL}{2E}x $$\n\n### Error Quantification\nThe discretization error field is $e(x) = u(x) - u_h(x)$:\n$$ e(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) - \\frac{bL}{2E}x = \\frac{b}{E} \\left( \\frac{Lx}{2} - \\frac{x^2}{2} \\right) = \\frac{b}{2E}(Lx - x^2) $$\nThe energy norm of a displacement field $v(x)$ is defined as $||v||_E = \\sqrt{\\int_0^L AE \\left(\\frac{dv}{dx}\\right)^2 dx}$. We need to compute the relative error $\\eta = \\frac{||e||_E}{||u||_E}$. We first compute the square of the norms.\n\nEnergy norm of the exact solution $u(x)$:\n$$ \\frac{du}{dx} = \\frac{b}{E}(L-x) $$\n$$ ||u||_E^2 = \\int_0^L AE \\left( \\frac{b}{E}(L-x) \\right)^2 dx = \\frac{Ab^2}{E} \\int_0^L (L-x)^2 dx $$\n$$ ||u||_E^2 = \\frac{Ab^2}{E} \\left[ -\\frac{(L-x)^3}{3} \\right]_0^L = \\frac{Ab^2}{E} \\left( 0 - \\left(-\\frac{L^3}{3}\\right) \\right) = \\frac{Ab^2L^3}{3E} $$\n\nEnergy norm of the error field $e(x)$:\n$$ \\frac{de}{dx} = \\frac{b}{2E}(L-2x) $$\n$$ ||e||_E^2 = \\int_0^L AE \\left( \\frac{b}{2E}(L-2x) \\right)^2 dx = \\frac{Ab^2}{4E} \\int_0^L (L-2x)^2 dx $$\n$$ ||e||_E^2 = \\frac{Ab^2}{4E} \\left[ -\\frac{(L-2x)^3}{6} \\right]_0^L = \\frac{Ab^2}{4E} \\left( -\\frac{(-L)^3}{6} - \\left(-\\frac{L^3}{6}\\right) \\right) = \\frac{Ab^2}{4E} \\left( \\frac{L^3}{6} + \\frac{L^3}{6} \\right) = \\frac{Ab^2}{4E} \\frac{L^3}{3} = \\frac{Ab^2L^3}{12E} $$\n\nThe relative error in energy norm is the ratio of the two norms:\n$$ \\eta = \\frac{||e||_E}{||u||_E} = \\sqrt{\\frac{||e||_E^2}{||u||_E^2}} = \\sqrt{\\frac{Ab^2L^3/(12E)}{Ab^2L^3/(3E)}} = \\sqrt{\\frac{1/12}{1/3}} = \\sqrt{\\frac{3}{12}} = \\sqrt{\\frac{1}{4}} $$\n$$ \\eta = \\frac{1}{2} $$\nThe exact value of the relative error is $1/2$.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "While the previous exercise showed that a simple FEM model may not exactly capture a complex displacement field, a correctly formulated element must perfectly reproduce basic deformation states. This practice introduces the \"patch test,\" a fundamental and indispensable verification procedure in computational mechanics . By imposing a linear displacement field that corresponds to a constant strain state, you will verify that your 1D bar element formulation is sound and can pass this critical test regardless of the mesh's configuration, ensuring your code is built on a reliable foundation.",
            "id": "3498516",
            "problem": "Consider the one-dimensional linear elastic bar in small strain and small displacement setting. Let the bar occupy the interval $x \\in [0,L]$, with constant Young's modulus $E$ and constant cross-sectional area $A$. There are no body forces. The displacement field is prescribed at the two ends as $u(0) = \\alpha$ and $u(L) = \\alpha + \\beta L$, which enforces the exact linear displacement field $u(x) = \\alpha + \\beta x$ and constant strain $\\epsilon(x) = \\beta$ throughout the bar. Using the Finite Element Method (FEM), you will derive and implement the stiffness of a two-node linear bar element and assemble the global stiffness matrix for arbitrary mesh partitions. Then, you will conduct a patch test by imposing the given end displacements and verify that the assembled solution reproduces the exact constant strain field for arbitrary mesh partitioning.\n\nThe derivation should be based on the following fundamental principles:\n- Kinematics: small strain in one dimension $\\epsilon(x) = \\dfrac{du}{dx}$.\n- Constitutive law (Hooke’s law): $\\sigma(x) = E \\, \\epsilon(x)$, where $\\sigma$ is the axial stress.\n- Principle of Virtual Work (PVW): $\\displaystyle \\int_{0}^{L} \\sigma \\, \\delta \\epsilon \\, A \\, dx = \\int_{0}^{L} b \\, \\delta u \\, A \\, dx + \\left. t \\, \\delta u \\right|_{\\partial \\Omega_t}$, with $b=0$ and end tractions absent due to purely essential boundary conditions in this problem.\n\nTask:\n1. Starting from the Principle of Virtual Work and the above kinematics and constitutive relations, derive the element stiffness matrix for a two-node linear bar element on an interval $[x_i, x_{i+1}]$. Do not use any pre-memorized stiffness formulas; the derivation must start from the virtual work statement, employ the standard two-node $C^0$-continuous linear approximation within an element, and perform the element-level integration exactly.\n2. Assemble the global stiffness matrix for an arbitrary partition (mesh) of $[0,L]$ into sub-intervals. Impose the essential boundary conditions $u(0)=\\alpha$ and $u(L)=\\alpha+\\beta L$ and solve for the interior nodal displacements.\n3. For each test case below, compute the following dimensionless error metrics:\n   - The maximum relative nodal displacement error in the infinity norm: $\\displaystyle e_{u,\\infty}^{\\mathrm{rel}} = \\dfrac{\\max_j \\left| u_h(x_j) - u(x_j) \\right|}{\\max_j \\left| u(x_j) \\right|}$, where $u_h$ is the finite element solution and $\\{x_j\\}$ are the nodal coordinates.\n   - The relative $\\ell^2$ displacement error: $\\displaystyle e_{u,2}^{\\mathrm{rel}} = \\dfrac{\\left( \\sum_j \\left( u_h(x_j) - u(x_j) \\right)^2 \\right)^{1/2}}{\\left( \\sum_j \\left( u(x_j) \\right)^2 \\right)^{1/2}}$.\n   - The maximum relative element strain error: $\\displaystyle e_{\\epsilon,\\infty}^{\\mathrm{rel}} = \\max_e \\dfrac{\\left| \\epsilon_h^{(e)} - \\beta \\right|}{\\left| \\beta \\right|}$, where $\\epsilon_h^{(e)}$ is the constant strain computed on element $e$ as the difference of nodal displacements divided by the element length, and $\\beta$ is the exact constant strain.\nAll three errors are dimensionless. No physical unit should appear in your outputs.\n\nTest suite:\nProvide results for the following four test cases. In each case, $E$ is in $\\mathrm{Pa}$, $A$ is in $\\mathrm{m}^2$, $L$ is in $\\mathrm{m}$, $\\alpha$ is in $\\mathrm{m}$, and $\\beta$ is in $\\mathrm{m}^{-1}$. The mesh is given by an ordered list of nodal coordinates including $0$ and $L$.\n\n- Test case $1$ (general irregular partition):\n  - $L = 3.7$, $E = 2.1 \\times 10^{11}$, $A = 4.0 \\times 10^{-3}$, $\\alpha = 1.2 \\times 10^{-3}$, $\\beta = -8.5 \\times 10^{-4}$.\n  - Nodes: $[0.0,\\, 0.3,\\, 1.1,\\, 2.5,\\, 3.7]$.\n\n- Test case $2$ (single element partition):\n  - $L = 5.0$, $E = 3.5 \\times 10^{10}$, $A = 2.5 \\times 10^{-2}$, $\\alpha = -3.0 \\times 10^{-3}$, $\\beta = 2.0 \\times 10^{-4}$.\n  - Nodes: $[0.0,\\, 5.0]$.\n\n- Test case $3$ (highly skewed partition with very small elements near the left end):\n  - $L = 1.0$, $E = 7.0 \\times 10^{10}$, $A = 1.0 \\times 10^{-2}$, $\\alpha = 0.5 \\times 10^{-3}$, $\\beta = 3.0 \\times 10^{-3}$.\n  - Nodes: $[0.0,\\, 10^{-6},\\, 10^{-3},\\, 10^{-2},\\, 10^{-1},\\, 0.5,\\, 1.0]$.\n\n- Test case $4$ (graded mesh with many elements):\n  - $L = 2.0$, $E = 1.0 \\times 10^{11}$, $A = 5.0 \\times 10^{-3}$, $\\alpha = 2.5 \\times 10^{-4}$, $\\beta = -1.25 \\times 10^{-3}$.\n  - Nodes: $x_i = L \\left( \\dfrac{i}{N} \\right)^2$ for $i=0,1,\\dots,N$ with $N=50$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list corresponding to a test case in the same order as above and containing the three errors $[e_{u,\\infty}^{\\mathrm{rel}},\\, e_{u,2}^{\\mathrm{rel}},\\, e_{\\epsilon,\\infty}^{\\mathrm{rel}}]$. For example: $[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],[r_{3,1},r_{3,2},r_{3,3}],[r_{4,1},r_{4,2},r_{4,3}]]$. The numbers must be dimensionless (no physical units are to be reported).",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of linear elastostatics and the Finite Element Method, is well-posed as a Dirichlet boundary value problem, is expressed objectively and without ambiguity, and contains all necessary information to derive the expressions and compute the requested numerical results. The task constitutes a standard patch test, a fundamental verification procedure in computational mechanics.\n\n### 1. Derivation of the Element Stiffness Matrix\n\nThe derivation begins with the Principle of Virtual Work (PVW) for the one-dimensional bar. Given the absence of body forces ($b=0$) and external tractions on the boundary (as boundary conditions are purely of the Dirichlet type), the PVW simplifies to its homogeneous form, stating that the internal virtual work is zero for any kinematically admissible virtual displacement:\n$$\n\\int_{0}^{L} \\delta W_{int} \\, dx = \\int_{0}^{L} \\sigma(x) \\, \\delta \\epsilon(x) \\, A \\, dx = 0\n$$\nwhere $\\sigma$ is the axial stress, $\\epsilon$ is the axial strain, $\\delta\\epsilon$ is the virtual axial strain, and $A$ is the cross-sectional area.\n\nThe integral over the entire domain $[0,L]$ can be decomposed into a sum of integrals over each element in the finite element mesh. For a single element $e$, occupying the domain $[x_i, x_{i+1}]$ of length $L_e = x_{i+1} - x_i$, the contribution to the PVW is:\n$$\n\\int_{x_i}^{x_{i+1}} \\sigma^{(e)}(x) \\, \\delta \\epsilon^{(e)}(x) \\, A \\, dx = 0\n$$\n\nWe introduce a finite element approximation for the displacement field $u(x)$ within this element. For a two-node linear bar element, the displacement $u_h^{(e)}(x)$ is interpolated from the nodal displacements $d_1^{(e)} = u_h(x_i)$ and $d_2^{(e)} = u_h(x_{i+1})$ using linear shape functions. We define a local coordinate $\\xi \\in [0,1]$ such that $x = x_i + \\xi L_e$. The linear shape functions are:\n$$\nN_1(\\xi) = 1 - \\xi \\quad \\text{and} \\quad N_2(\\xi) = \\xi\n$$\nThe approximated displacement field is then written in matrix form as:\n$$\nu_h^{(e)}(x(\\xi)) = N_1(\\xi)d_1^{(e)} + N_2(\\xi)d_2^{(e)} = \\mathbf{N}(\\xi) \\mathbf{d}^{(e)}\n$$\nwhere $\\mathbf{N}(\\xi) = [N_1(\\xi), N_2(\\xi)]$ is the vector of shape functions and $\\mathbf{d}^{(e)} = [d_1^{(e)}, d_2^{(e)}]^T$ is the vector of element nodal displacements.\n\nThe strain is the spatial derivative of the displacement, $\\epsilon(x) = du/dx$. Using the chain rule, we relate the derivative with respect to $x$ to the derivative with respect to $\\xi$:\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{L_e}\\frac{d}{d\\xi}\n$$\nThe strain within the element, $\\epsilon_h^{(e)}$, is then:\n$$\n\\epsilon_h^{(e)} = \\frac{du_h^{(e)}}{dx} = \\frac{1}{L_e} \\frac{d\\mathbf{N}(\\xi)}{d\\xi} \\mathbf{d}^{(e)}\n$$\nThe derivatives of the shape functions are $\\frac{dN_1}{d\\xi} = -1$ and $\\frac{dN_2}{d\\xi} = 1$. This leads to the strain-displacement matrix, $\\mathbf{B}$:\n$$\n\\epsilon_h^{(e)} = \\frac{1}{L_e}[-1, 1]\\mathbf{d}^{(e)} = \\mathbf{B}\\mathbf{d}^{(e)}\n$$\nNote that for a linear element, the $\\mathbf{B}$ matrix is constant within the element, resulting in a constant strain field. The virtual strain $\\delta\\epsilon_h^{(e)}$ is related to the virtual nodal displacements $\\delta\\mathbf{d}^{(e)}$ by the same relationship:\n$$\n\\delta\\epsilon_h^{(e)} = \\mathbf{B}\\delta\\mathbf{d}^{(e)}\n$$\nThe constitutive relation (Hooke's Law) for linear elasticity is $\\sigma(x) = E \\epsilon(x)$. In the element context, this is $\\sigma_h^{(e)} = E \\epsilon_h^{(e)} = E \\mathbf{B} \\mathbf{d}^{(e)}$, where $E$ is the constant Young's modulus.\n\nSubstituting these expressions into the element's virtual work equation:\n$$\n\\int_{x_i}^{x_{i+1}} \\left( E \\mathbf{B} \\mathbf{d}^{(e)} \\right)^T \\left( \\mathbf{B} \\delta\\mathbf{d}^{(e)} \\right) A \\, dx = 0\n$$\nSince the terms are scalars, the transpose on the stress term can be moved. We can rearrange the expression, noting that nodal displacements are not functions of $x$:\n$$\n(\\delta\\mathbf{d}^{(e)})^T \\left( \\int_{x_i}^{x_{i+1}} \\mathbf{B}^T E A \\mathbf{B} \\, dx \\right) \\mathbf{d}^{(e)} = 0\n$$\nSince this must hold for any arbitrary virtual displacements $\\delta\\mathbf{d}^{(e)}$, the term in the parentheses must be zero. This term represents the element's force-displacement relationship, $\\mathbf{k}^{(e)}\\mathbf{d}^{(e)} = \\mathbf{f}^{(e)}$, where $\\mathbf{k}^{(e)}$ is the element stiffness matrix.\n$$\n\\mathbf{k}^{(e)} = \\int_{x_i}^{x_{i+1}} \\mathbf{B}^T E A \\mathbf{B} \\, dx\n$$\nAs $E$, $A$, and the $\\mathbf{B}$ matrix are constant within the element, they can be taken out of the integral:\n$$\n\\mathbf{k}^{(e)} = \\mathbf{B}^T E A \\mathbf{B} \\int_{x_i}^{x_{i+1}} dx = (\\mathbf{B}^T E A \\mathbf{B}) L_e\n$$\nSubstituting the expression for $\\mathbf{B}$:\n$$\n\\mathbf{k}^{(e)} = \\left( \\left(\\frac{1}{L_e}\\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix}\\right) E A \\left(\\frac{1}{L_e}[-1, 1]\\right) \\right) L_e = \\frac{EA}{L_e^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} L_e\n$$\nThis simplifies to the well-known stiffness matrix for a $2$-node linear elastic bar element:\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L_e}\n\\begin{bmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{bmatrix}\n$$\n\n### 2. Global Assembly and Solution\n\nThe global stiffness matrix $\\mathbf{K}$ for a mesh with $N_{nodes}$ nodes is an $N_{nodes} \\times N_{nodes}$ matrix, initially filled with zeros. The global system of equations is $\\mathbf{K} \\mathbf{U} = \\mathbf{F}$, where $\\mathbf{U}$ is the vector of global nodal displacements and $\\mathbf{F}$ is the vector of external nodal forces (which is zero for this problem).\n\nThe matrix $\\mathbf{K}$ is assembled by iterating through each element $e$ connecting global nodes $i$ and $j$, and adding the entries of the element stiffness matrix $\\mathbf{k}^{(e)}$ to the corresponding locations in $\\mathbf{K}$. For an element connecting nodes $i$ and $i+1$, the assembly rule is:\n$$\nK_{i,i} \\leftarrow K_{i,i} + k^{(e)}_{11} \\quad \\quad K_{i,i+1} \\leftarrow K_{i,i+1} + k^{(e)}_{12} \\\\\nK_{i+1,i} \\leftarrow K_{i+1,i} + k^{(e)}_{21} \\quad \\quad K_{i+1,i+1} \\leftarrow K_{i+1,i+1} + k^{(e)}_{22}\n$$\nThe essential boundary conditions are $u(0) = \\alpha$ and $u(L) = \\alpha + \\beta L$. These are imposed on the first and last nodes of the global system. The global system is partitioned into unknown (interior) and prescribed (boundary) degrees of freedom (DOFs), denoted by subscripts $u$ and $p$ respectively:\n$$\n\\begin{bmatrix}\n\\mathbf{K}_{uu} & \\mathbf{K}_{up} \\\\\n\\mathbf{K}_{pu} & \\mathbf{K}_{pp}\n\\end{bmatrix}\n\\begin{Bmatrix}\n\\mathbf{U}_u \\\\\n\\mathbf{U}_p\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\mathbf{F}_u \\\\\n\\mathbf{F}_p\n\\end{Bmatrix}\n$$\nHere, $\\mathbf{U}_u$ is the vector of unknown interior nodal displacements, and $\\mathbf{U}_p = [\\alpha, \\alpha + \\beta L]^T$ is the vector of known boundary displacements. Since $\\mathbf{F}_u = \\mathbf{0}$, the system for the unknown DOFs is:\n$$\n\\mathbf{K}_{uu} \\mathbf{U}_u + \\mathbf{K}_{up} \\mathbf{U}_p = \\mathbf{0} \\implies \\mathbf{K}_{uu} \\mathbf{U}_u = - \\mathbf{K}_{up} \\mathbf{U}_p\n$$\nThis linear system is solved for $\\mathbf{U}_u$. The full finite element solution vector $u_h$ is then constructed by combining the solved interior displacements $\\mathbf{U}_u$ with the prescribed boundary displacements $\\mathbf{U}_p$.\n\n### 3. Error Metrics and Patch Test Verification\n\nThe patch test verifies that the FEM implementation can exactly reproduce a constant or linear solution field. For this problem, the exact solution is the linear displacement field $u(x) = \\alpha + \\beta x$ and the constant strain field $\\epsilon(x) = \\beta$. Since a two-node element uses a linear interpolation, it can represent this solution exactly. Therefore, the finite element solution $u_h$ should match the exact solution $u(x)$ at all nodes to within machine precision, irrespective of the mesh layout.\n\nThe following dimensionless error metrics are computed to verify this:\n1.  Maximum relative nodal displacement error: This measures the largest deviation at any node, relative to the largest exact nodal displacement.\n    $$\n    e_{u,\\infty}^{\\mathrm{rel}} = \\dfrac{\\max_j \\left| u_h(x_j) - u(x_j) \\right|}{\\max_j \\left| u(x_j) \\right|}\n    $$\n2.  Relative $\\ell^2$ displacement error: This measures the overall error in nodal displacements in a root-mean-square sense.\n    $$\n    e_{u,2}^{\\mathrm{rel}} = \\dfrac{\\left( \\sum_j \\left( u_h(x_j) - u(x_j) \\right)^2 \\right)^{1/2}}{\\left( \\sum_j \\left( u(x_j) \\right)^2 \\right)^{1/2}} = \\frac{\\| \\mathbf{U}_h - \\mathbf{U}_{exact} \\|_2}{\\| \\mathbf{U}_{exact} \\|_2}\n    $$\n3.  Maximum relative element strain error: This measures the largest deviation in the element-wise constant strain from the exact constant strain $\\beta$.\n    $$\n    e_{\\epsilon,\\infty}^{\\mathrm{rel}} = \\max_e \\dfrac{\\left| \\epsilon_h^{(e)} - \\beta \\right|}{\\left| \\beta \\right|}\n    $$\n    where $\\epsilon_h^{(e)} = (u_h(x_{j+1}) - u_h(x_j))/(x_{j+1} - x_j)$ for an element between nodes $j$ and $j+1$.\n\nFor all test cases, since the patch test must be passed, all three error metrics are expected to be zero or a very small number on the order of machine floating-point precision (e.g., $\\approx 10^{-14}$ or smaller).",
            "answer": "```python\nimport numpy as np\n\ndef run_fem_patch_test(L, E, A, alpha, beta, nodes):\n    \"\"\"\n    Performs a 1D bar patch test for a given set of parameters and mesh.\n\n    Args:\n        L (float): Length of the bar.\n        E (float): Young's modulus.\n        A (float): Cross-sectional area.\n        alpha (float): Displacement constant u(x) = alpha + beta*x.\n        beta (float): Strain.\n        nodes (np.ndarray): Array of nodal coordinates.\n\n    Returns:\n        list: A list containing the three error metrics\n              [e_u_inf_rel, e_u_2_rel, e_eps_inf_rel].\n    \"\"\"\n    nodes = np.array(nodes, dtype=float)\n    n_nodes = len(nodes)\n    n_elements = n_nodes - 1\n\n    # If there is only one element (two nodes), the solution is trivial.\n    if n_nodes == 2:\n        u_h = np.array([alpha, alpha + beta * L])\n    else:\n        # Assemble global stiffness matrix K\n        K = np.zeros((n_nodes, n_nodes))\n        for i in range(n_elements):\n            node1_idx, node2_idx = i, i + 1\n            L_e = nodes[node2_idx] - nodes[node1_idx]\n            \n            if L_e = 0:\n                raise ValueError(\"Element length must be positive.\")\n\n            k_multiplier = E * A / L_e\n            k_e = k_multiplier * np.array([[1, -1], [-1, 1]])\n\n            # Add element stiffness to global matrix\n            K[node1_idx, node1_idx] += k_e[0, 0]\n            K[node1_idx, node2_idx] += k_e[0, 1]\n            K[node2_idx, node1_idx] += k_e[1, 0]\n            K[node2_idx, node2_idx] += k_e[1, 1]\n\n        # Apply boundary conditions by partitioning\n        # Unknown DOFs are at indices 1 to n_nodes-2\n        # Prescribed DOFs are at indices 0 and n_nodes-1\n        K_uu = K[1:-1, 1:-1]\n        K_up = K[1:-1, [0, n_nodes - 1]]\n        \n        # Prescribed displacements\n        u_p = np.array([alpha, alpha + beta * L])\n        \n        # Right-hand side vector for the reduced system\n        F_u_eff = -K_up @ u_p\n        \n        # Solve for interior displacements\n        u_u = np.linalg.solve(K_uu, F_u_eff)\n        \n        # Reconstruct the full displacement vector\n        u_h = np.concatenate(([u_p[0]], u_u, [u_p[1]]))\n\n    # --- Error Calculation ---\n    \n    # Exact solution at nodes\n    u_exact = alpha + beta * nodes\n    \n    # 1. Maximum relative nodal displacement error\n    err_abs_u_inf = np.max(np.abs(u_h - u_exact))\n    norm_u_exact_inf = np.max(np.abs(u_exact))\n    e_u_inf_rel = err_abs_u_inf / norm_u_exact_inf if norm_u_exact_inf > 0 else err_abs_u_inf\n\n    # 2. Relative l2 displacement error\n    norm_err_u_2 = np.linalg.norm(u_h - u_exact)\n    norm_u_exact_2 = np.linalg.norm(u_exact)\n    e_u_2_rel = norm_err_u_2 / norm_u_exact_2 if norm_u_exact_2 > 0 else norm_err_u_2\n    \n    # 3. Maximum relative element strain error\n    eps_h = np.zeros(n_elements)\n    for i in range(n_elements):\n        L_e = nodes[i+1] - nodes[i]\n        eps_h[i] = (u_h[i+1] - u_h[i]) / L_e\n        \n    err_abs_eps_inf = np.max(np.abs(eps_h - beta))\n    norm_beta = np.abs(beta)\n    e_eps_inf_rel = err_abs_eps_inf / norm_beta if norm_beta > 0 else err_abs_eps_inf\n\n    return [e_u_inf_rel, e_u_2_rel, e_eps_inf_rel]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Test case 1\n    tc1 = {\n        'L': 3.7, 'E': 2.1e11, 'A': 4.0e-3, 'alpha': 1.2e-3, 'beta': -8.5e-4,\n        'nodes': [0.0, 0.3, 1.1, 2.5, 3.7]\n    }\n\n    # Test case 2\n    tc2 = {\n        'L': 5.0, 'E': 3.5e10, 'A': 2.5e-2, 'alpha': -3.0e-3, 'beta': 2.0e-4,\n        'nodes': [0.0, 5.0]\n    }\n\n    # Test case 3\n    tc3 = {\n        'L': 1.0, 'E': 7.0e10, 'A': 1.0e-2, 'alpha': 0.5e-3, 'beta': 3.0e-3,\n        'nodes': [0.0, 1e-6, 1e-3, 1e-2, 1e-1, 0.5, 1.0]\n    }\n    \n    # Test case 4\n    N4 = 50\n    L4 = 2.0\n    nodes4 = [L4 * (i / N4)**2 for i in range(N4 + 1)]\n    tc4 = {\n        'L': 2.0, 'E': 1.0e11, 'A': 5.0e-3, 'alpha': 2.5e-4, 'beta': -1.25e-3,\n        'nodes': nodes4\n    }\n\n    test_cases = [tc1, tc2, tc3, tc4]\n    \n    results = []\n    for case in test_cases:\n        errors = run_fem_patch_test(\n            L=case['L'], \n            E=case['E'], \n            A=case['A'], \n            alpha=case['alpha'], \n            beta=case['beta'], \n            nodes=case['nodes']\n        )\n        results.append(errors)\n\n    # Format the output as specified: [[r1,r2,r3],[...],...]\n    formatted_results = '],['.join([','.join(map(str, res)) for res in results])\n    print(f\"[[{formatted_results}]]\")\n\nsolve()\n```"
        },
        {
            "introduction": "To enhance accuracy and model more complex behaviors, we can employ higher-order elements. This practice advances from linear to quadratic elements, which can represent non-uniform strain within a single element. By analyzing a bar with a varying cross-section, you will encounter a scenario where the stiffness matrix integral becomes too complex to solve by hand, necessitating the use of numerical quadrature . You will implement and compare different Gauss quadrature rules, gaining hands-on experience with an essential computational technique for practical FEM analysis.",
            "id": "3498547",
            "problem": "Consider a three-node isoparametric quadratic one-dimensional bar element used in the Finite Element Method (FEM) for small-strain linear elasticity. The bar has length $L$, with nodal coordinates $x_{1}=0$, $x_{2}=L/2$, and $x_{3}=L$. The cross-sectional area varies linearly along the bar as $A(x)=A_{1}+\\left(\\frac{A_{2}-A_{1}}{L}\\right)x$, and the Young’s modulus is constant $E$. The local isoparametric coordinate is $\\xi \\in [-1,1]$, the standard quadratic Lagrange shape functions are $N_{1}(\\xi)=\\frac{1}{2}\\,\\xi\\,(\\xi-1)$, $N_{2}(\\xi)=1-\\xi^{2}$, $N_{3}(\\xi)=\\frac{1}{2}\\,\\xi\\,(\\xi+1)$, and the geometric mapping is $x(\\xi)=\\sum_{i=1}^{3}N_{i}(\\xi)\\,x_{i}$.\n\nStarting from fundamental principles and core definitions, use the small-strain linear elastic constitutive relation $\\sigma=E\\,\\varepsilon$, the kinematic relation $\\varepsilon=\\frac{du}{dx}$, and the principle of virtual work to obtain the element stiffness entries as integrals over the bar. Then, perform exact and approximate integration to compare one-point and two-point Gauss quadrature.\n\nGiven parameters are $L=3\\ \\mathrm{m}$, $E=50\\times 10^{9}\\ \\mathrm{Pa}$, $A_{1}=0.01\\ \\mathrm{m}^{2}$, and $A_{2}=0.025\\ \\mathrm{m}^{2}$.\n\nTasks:\n1. Derive, from the principle of virtual work, the expression for the element stiffness matrix entries $K_{ij}$ in terms of an integral over the physical coordinate $x$, and then transform it to the local coordinate $\\xi$ using the isoparametric mapping. Your derivation must start from the weak form and the definitions above, without citing pre-derived element matrices.\n2. Compute the exact element stiffness matrix by analytically evaluating the integral with the given $A(x)$ and quadratic shape functions. Express the final numerical matrix entries in $\\mathrm{N}/\\mathrm{m}$.\n3. Compute the one-point Gauss quadrature approximation and the two-point Gauss quadrature approximation of the element stiffness matrix using the standard rules on $[-1,1]$: for one-point, node $\\xi_{1}=0$ with weight $w_{1}=2$; for two-point, nodes $\\xi_{1,2}=\\pm 1/\\sqrt{3}$ with weights $w_{1,2}=1$. Express the resulting numerical matrices in $\\mathrm{N}/\\mathrm{m}$.\n4. Define the relative quadrature error for an $n$-point rule as $\\varepsilon_{n}=\\frac{\\|K^{(n)}-K\\|_{F}}{\\|K\\|_{F}}$, where $\\|\\,\\cdot\\,\\|_{F}$ is the Frobenius norm, $K$ is the exact stiffness, and $K^{(n)}$ is the $n$-point Gauss approximation. Compute $\\varepsilon_{1}$ and $\\varepsilon_{2}$.\n\nRound your final error values $\\varepsilon_{1}$ and $\\varepsilon_{2}$ to six significant figures and express them as decimals. The final answer must be reported as a two-entry row matrix using the LaTeX pmatrix environment, with no units inside the matrix.",
            "solution": "The problem requires the derivation and computation of the stiffness matrix for a three-node quadratic bar element with variable cross-section, followed by a comparison of numerical integration schemes.\n\n**Task 1: Derivation of the Element Stiffness Matrix**\n\nThe derivation begins with the principle of virtual work. For a one-dimensional body under axial load, the internal virtual work $\\delta W_{\\text{int}}$ is given by the integral of the virtual strain energy density over the volume $V$.\n$$ \\delta W_{\\text{int}} = \\int_{V} \\delta\\varepsilon^{T} \\sigma \\, dV $$\nHere, $\\sigma$ is the axial stress and $\\delta\\varepsilon$ is the virtual axial strain. For a bar element, the volume integral can be expressed as an integral over the length $L$:\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\varepsilon \\sigma A(x) \\, dx $$\nwhere $A(x)$ is the cross-sectional area at position $x$.\n\nThe constitutive relation for linear elasticity is $\\sigma = E \\varepsilon$, where $E$ is the Young's modulus. Substituting this into the virtual work expression gives:\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\varepsilon E \\varepsilon A(x) \\, dx $$\n\nWithin the finite element framework, the displacement field $u(x)$ is approximated using shape functions $N_i(x)$ and nodal displacements $d_i$:\n$$ u(x) = \\sum_{j=1}^{3} N_j(x) d_j = \\mathbf{N}(x) \\mathbf{d} $$\nThe axial strain $\\varepsilon$ is the spatial derivative of the displacement:\n$$ \\varepsilon = \\frac{du}{dx} = \\sum_{j=1}^{3} \\frac{dN_j}{dx} d_j = \\mathbf{B}(x) \\mathbf{d} $$\nwhere $\\mathbf{B}(x) = \\left[ \\begin{matrix} \\frac{dN_1}{dx}  \\frac{dN_2}{dx}  \\frac{dN_3}{dx} \\end{matrix} \\right]$ is the strain-displacement matrix.\nSimilarly, the virtual displacement and virtual strain are given by:\n$$ \\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{d} \\quad \\text{and} \\quad \\delta\\varepsilon = \\mathbf{B}(x) \\delta\\mathbf{d} $$\nSubstituting the discretized forms of $\\varepsilon$ and $\\delta\\varepsilon$ into the internal virtual work equation:\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} (\\delta\\mathbf{d}^{T} \\mathbf{B}(x)^{T}) E (\\mathbf{B}(x) \\mathbf{d}) A(x) \\, dx $$\n$$ \\delta W_{\\text{int}} = \\delta\\mathbf{d}^{T} \\left( \\int_{0}^{L} E A(x) \\mathbf{B}(x)^{T} \\mathbf{B}(x) \\, dx \\right) \\mathbf{d} $$\nBy definition, $\\delta W_{\\text{int}} = \\delta\\mathbf{d}^T \\mathbf{K} \\mathbf{d}$, where $\\mathbf{K}$ is the element stiffness matrix. Therefore:\n$$ \\mathbf{K} = \\int_{0}^{L} E A(x) \\mathbf{B}(x)^{T} \\mathbf{B}(x) \\, dx $$\nThe entries of the stiffness matrix are $K_{ij} = \\int_{0}^{L} E A(x) \\frac{dN_i}{dx} \\frac{dN_j}{dx} \\, dx$.\n\nFor an isoparametric element, the physical coordinates $x$ are mapped from the local coordinates $\\xi \\in [-1,1]$ using the same shape functions as the displacement field:\n$$ x(\\xi) = \\sum_{k=1}^{3} N_k(\\xi) x_k $$\nThe derivative of a shape function with respect to $x$ is found using the chain rule: $\\frac{dN_i}{dx} = \\frac{dN_i}{d\\xi} \\frac{d\\xi}{dx}$. The term $\\frac{dx}{d\\xi}$ is the Jacobian of the transformation, $J$.\n$$ J = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi} \\left( \\sum_{k=1}^{3} N_k(\\xi) x_k \\right) = \\sum_{k=1}^{3} \\frac{dN_k}{d\\xi} x_k $$\nThe differential length element is $dx = J d\\xi$. The stiffness matrix integral is transformed to the local coordinate system:\n$$ K_{ij} = \\int_{-1}^{1} E A(x(\\xi)) \\left( \\frac{1}{J} \\frac{dN_i}{d\\xi} \\right) \\left( \\frac{1}{J} \\frac{dN_j}{d\\xi} \\right) J \\, d\\xi = \\int_{-1}^{1} \\frac{E A(x(\\xi))}{J} \\frac{dN_i}{d\\xi} \\frac{dN_j}{d\\xi} \\, d\\xi $$\nThis completes the derivation requested in Task 1.\n\n**Task 2: Exact Element Stiffness Matrix**\n\nFirst, we establish the specific functions for this problem. The quadratic shape functions are given:\n$N_{1}(\\xi)=\\frac{1}{2}\\xi(\\xi-1)$, $N_{2}(\\xi)=1-\\xi^{2}$, $N_{3}(\\xi)=\\frac{1}{2}\\xi(\\xi+1)$.\nTheir derivatives with respect to $\\xi$ are:\n$$ \\frac{dN_1}{d\\xi} = \\xi - \\frac{1}{2}, \\quad \\frac{dN_2}{d\\xi} = -2\\xi, \\quad \\frac{dN_3}{d\\xi} = \\xi + \\frac{1}{2} $$\nThe nodal coordinates are $x_1=0$, $x_2=L/2$, and $x_3=L$. The Jacobian $J$ is:\n$$ J = \\left(\\xi - \\frac{1}{2}\\right) (0) + (-2\\xi)\\left(\\frac{L}{2}\\right) + \\left(\\xi + \\frac{1}{2}\\right)(L) = -L\\xi + L\\xi + \\frac{L}{2} = \\frac{L}{2} $$\nThe Jacobian is constant because the mid-side node is at the geometric center. The coordinate mapping is:\n$$ x(\\xi) = N_1(\\xi)(0) + N_2(\\xi)\\left(\\frac{L}{2}\\right) + N_3(\\xi)(L) = (1-\\xi^2)\\frac{L}{2} + \\frac{1}{2}(\\xi^2+\\xi)L = \\frac{L}{2}(1+\\xi) $$\nThe cross-sectional area $A(x) = A_1 + \\frac{A_2-A_1}{L}x$. Substituting $x(\\xi)$:\n$$ A(x(\\xi)) = A_1 + \\frac{A_2-A_1}{L} \\frac{L}{2}(1+\\xi) = A_1 + \\frac{A_2-A_1}{2} + \\frac{A_2-A_1}{2}\\xi = \\frac{A_1+A_2}{2} + \\frac{A_2-A_1}{2}\\xi $$\nLet $A_c = \\frac{A_1+A_2}{2}$ and $\\Delta A = \\frac{A_2-A_1}{2}$. Then $A(x(\\xi)) = A_c + \\Delta A \\xi$.\nThe stiffness matrix entries are:\n$$ K_{ij} = \\int_{-1}^{1} \\frac{E (A_c + \\Delta A \\xi)}{L/2} \\left(\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{dN_j}{d\\xi}\\right) d\\xi = \\frac{2E}{L} \\int_{-1}^{1} (A_c + \\Delta A \\xi) \\left(\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{dN_j}{d\\xi}\\right) d\\xi $$\nThe term $(\\frac{dN_i}{d\\xi})(\\frac{dN_j}{d\\xi})$ is a polynomial in $\\xi$ of at most degree $2$. The full integrand is a polynomial of at most degree $3$. We can integrate this exactly. Let $\\mathbf{B}_\\xi = [\\begin{matrix} \\xi-\\frac{1}{2}  -2\\xi  \\xi+\\frac{1}{2} \\end{matrix}]$. We must compute $\\mathbf{K} = \\frac{2E}{L} \\int_{-1}^1 (A_c + \\Delta A \\xi) \\mathbf{B}_\\xi^T \\mathbf{B}_\\xi d\\xi$.\nThe result of this exact integration yields the matrix:\n$$ \\mathbf{K} = \\frac{E}{3L} \\begin{pmatrix} 7A_c - 4\\Delta A  -8A_c + 4\\Delta A  A_c \\\\ -8A_c + 4\\Delta A  16A_c  -8A_c - 4\\Delta A \\\\ A_c  -8A_c - 4\\Delta A  7A_c + 4\\Delta A \\end{pmatrix} $$\nUsing the given parameters: $L=3\\,\\mathrm{m}$, $E=50 \\times 10^9\\,\\mathrm{Pa}$, $A_1=0.01\\,\\mathrm{m}^2$, $A_2=0.025\\,\\mathrm{m}^2$.\n$A_c = \\frac{0.01+0.025}{2} = 0.0175\\,\\mathrm{m}^2 = \\frac{7}{400}\\,\\mathrm{m}^2$.\n$\\Delta A = \\frac{0.025-0.01}{2} = 0.0075\\,\\mathrm{m}^2 = \\frac{3}{400}\\,\\mathrm{m}^2$.\nSubstituting these into the matrix formula:\n$\\frac{E}{3L} = \\frac{50 \\times 10^9}{9}$.\n$7A_c-4\\Delta A = 7(\\frac{7}{400}) - 4(\\frac{3}{400}) = \\frac{37}{400}$.\n$-8A_c+4\\Delta A = -8(\\frac{7}{400}) + 4(\\frac{3}{400}) = -\\frac{44}{400}$.\n$A_c = \\frac{7}{400}$.\n$16A_c = 16(\\frac{7}{400}) = \\frac{112}{400}$.\n$-8A_c-4\\Delta A = -8(\\frac{7}{400})-4(\\frac{3}{400}) = -\\frac{68}{400}$.\n$7A_c+4\\Delta A = 7(\\frac{7}{400})+4(\\frac{3}{400}) = \\frac{61}{400}$.\n$$ \\mathbf{K} = \\frac{50 \\times 10^9}{9} \\frac{1}{400} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix} = \\frac{1.25 \\times 10^8}{9} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix} $$\nThis can be written as $\\mathbf{K} = \\frac{10^9}{72} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix}$.\n\n**Task 3: Approximate Element Stiffness Matrices**\n\nThe general formula for $n$-point Gauss quadrature is $\\mathbf{K}^{(n)} = \\sum_{k=1}^{n} w_k \\left[ \\frac{E A(x(\\xi))}{J} \\mathbf{B}_\\xi(\\xi)^T \\mathbf{B}_\\xi(\\xi) \\right]_{\\xi=\\xi_k}$.\n\n**One-point Gauss quadrature ($n=1$)**:\nRule: $\\xi_1 = 0$, $w_1=2$.\n$$ \\mathbf{K}^{(1)} = w_1 \\left[ \\frac{2E}{L} (A_c+\\Delta A\\xi) \\mathbf{B}_\\xi(\\xi)^T \\mathbf{B}_\\xi(\\xi) \\right]_{\\xi=0} $$\nAt $\\xi=0$, we have $A(x(0)) = A_c$ and $\\mathbf{B}_\\xi(0) = [\\begin{matrix} -1/2  0  1/2 \\end{matrix}]$.\n$$ \\mathbf{K}^{(1)} = 2 \\cdot \\frac{2E A_c}{L} \\begin{pmatrix} -1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix} \\begin{pmatrix} -1/2  0  1/2 \\end{pmatrix} = \\frac{E A_c}{L} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} $$\nSubstituting values:\n$\\frac{EA_c}{L} = \\frac{(50 \\times 10^9)(0.0175)}{3} = \\frac{7}{24} \\times 10^9$.\n$$ \\mathbf{K}^{(1)} = \\frac{7 \\times 10^9}{24} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} = \\frac{21 \\times 10^9}{72} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} $$\n\n**Two-point Gauss quadrature ($n=2$)**:\nRule: $\\xi_{1,2} = \\pm 1/\\sqrt{3}$, $w_{1,2}=1$.\nThe integrand for $K_{ij}$ is a polynomial of degree $3$ in $\\xi$. Two-point Gauss quadrature is exact for polynomials of degree up to $2n-1 = 2(2)-1=3$. Therefore, the two-point quadrature rule will evaluate the integral exactly.\n$$ \\mathbf{K}^{(2)} = \\mathbf{K} $$\n\n**Task 4: Relative Quadrature Error**\n\nThe relative error is defined as $\\varepsilon_{n}=\\frac{\\|\\mathbf{K}^{(n)}-\\mathbf{K}\\|_{F}}{\\|\\mathbf{K}\\|_{F}}$, where $\\|\\cdot\\|_F$ is the Frobenius norm, $\\|\\mathbf{A}\\|_F = \\sqrt{\\sum_{i,j} |a_{ij}|^2}$.\n\nFor the two-point rule, since $\\mathbf{K}^{(2)} = \\mathbf{K}$, the numerator $\\|\\mathbf{K}^{(2)}-\\mathbf{K}\\|_F = 0$. Thus,\n$$ \\varepsilon_2 = 0 $$\nFor the one-point rule, we compute the error $\\varepsilon_1$. We can factor out the common term $C = \\frac{10^9}{72}$.\nLet $\\mathbf{M}_K = \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix}$ and $\\mathbf{M}_{K1} = \\begin{pmatrix} 21  0  -21 \\\\ 0  0  0 \\\\ -21  0  21 \\end{pmatrix}$.\nThen $\\mathbf{K} = C \\mathbf{M}_K$ and $\\mathbf{K}^{(1)} = C \\mathbf{M}_{K1}$.\nThe error is $\\varepsilon_1 = \\frac{\\|C(\\mathbf{M}_{K1}-\\mathbf{M}_K)\\|_F}{\\|C\\mathbf{M}_K\\|_F} = \\frac{\\|\\mathbf{M}_{K1}-\\mathbf{M}_K\\|_F}{\\|\\mathbf{M}_K\\|_F}$.\nLet $\\Delta\\mathbf{M} = \\mathbf{M}_{K1}-\\mathbf{M}_K$:\n$$ \\Delta\\mathbf{M} = \\begin{pmatrix} 21-37  0-(-44)  -21-7 \\\\ 0-(-44)  0-112  0-(-68) \\\\ -21-7  0-(-68)  21-61 \\end{pmatrix} = \\begin{pmatrix} -16  44  -28 \\\\ 44  -112  68 \\\\ -28  68  -40 \\end{pmatrix} $$\nNow we compute the squared Frobenius norms:\n$$ \\|\\mathbf{M}_K\\|_F^2 = 37^2 + (-44)^2 + 7^2 + (-44)^2 + 112^2 + (-68)^2 + 7^2 + (-68)^2 + 61^2 $$\n$$ \\|\\mathbf{M}_K\\|_F^2 = 1369 + 1936 + 49 + 1936 + 12544 + 4624 + 49 + 4624 + 3721 = 30852 $$\n$$ \\|\\Delta\\mathbf{M}\\|_F^2 = (-16)^2 + 44^2 + (-28)^2 + 44^2 + (-112)^2 + 68^2 + (-28)^2 + 68^2 + (-40)^2 $$\n$$ \\|\\Delta\\mathbf{M}\\|_F^2 = 256 + 1936 + 784 + 1936 + 12544 + 4624 + 784 + 4624 + 1600 = 29088 $$\nThe relative error $\\varepsilon_1$ is:\n$$ \\varepsilon_1 = \\sqrt{\\frac{\\|\\Delta\\mathbf{M}\\|_F^2}{\\|\\mathbf{M}_K\\|_F^2}} = \\sqrt{\\frac{29088}{30852}} \\approx \\sqrt{0.942823739} \\approx 0.970991136 $$\nRounding to six significant figures, $\\varepsilon_1 = 0.970991$.\nThe final error values are $\\varepsilon_1 = 0.970991$ and $\\varepsilon_2 = 0$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.970991  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}