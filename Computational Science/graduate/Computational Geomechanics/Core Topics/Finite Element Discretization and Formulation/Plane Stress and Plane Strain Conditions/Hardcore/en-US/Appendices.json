{
    "hands_on_practices": [
        {
            "introduction": "We begin by testing our intuition about the importance of two-dimensional idealizations. This exercise analyzes the stability of an infinite clay slope, a classic problem in geomechanics, under both plane stress and plane strain conditions. By deriving the critical height for failure, you will uncover a scenario where, due to the specific material model and failure mode, both assumptions surprisingly lead to the identical result, highlighting the need to carefully consider the governing physics before assuming an outcome .",
            "id": "3550757",
            "problem": "A homogeneous, saturated clay forms an infinitely long slope of inclination angle $\\beta$ (in radians) with a planar ground surface. Consider short-term undrained conditions modeled by a Tresca ($\\phi=0$) material with a constant undrained shear strength $s_{u}$ (total stress framework) and total unit weight $\\gamma$. Let the potential failure be a translational slip along a plane parallel to the slope surface, located at a vertical depth $H$ below the slope surface. Assume small deformations and two-dimensional conditions.\n\nTwo analyses are to be performed:\n- A plane strain analysis, enforcing zero out-of-plane normal strain $\\varepsilon_{zz}=0$ (with $\\sigma_{zz}$ unknown and determined by compatibility).\n- A plane stress analysis that neglects the out-of-plane normal stress, i.e., $\\sigma_{zz}=0$.\n\nStarting only from basic equilibrium, kinematics, and the Tresca yield condition for undrained response, derive the expression for the critical vertical height $H_{c}$ at which impending translational failure along the plane parallel to the slope occurs for each analysis. Then, compare the predicted critical heights and determine the ratio\n$$\n\\frac{H_{c}^{\\text{plane stress}}}{H_{c}^{\\text{plane strain}}}.\n$$\nExpress your final answer as a pure number. No numerical rounding is required.",
            "solution": "The user wants to solve the problem. I will execute the `solve_problem` command.\nThe user wants me to solve this problem. I have analyzed the user's request and will now proceed with generating a response.\n### Step 1: Extract Givens\n- Material: Homogeneous, saturated clay.\n- Geometry: Infinitely long slope with inclination angle $\\beta$.\n- Analysis type: Short-term undrained conditions, total stress framework.\n- Material model: Tresca ($\\phi=0$) with constant undrained shear strength $s_u$.\n- Loading: Self-weight, with total unit weight $\\gamma$.\n- Failure mechanism: Translational slip along a plane parallel to the slope surface, located at a vertical depth $H$.\n- Assumptions: Small deformations, two-dimensional conditions.\n- Case 1: Plane strain analysis, with $\\varepsilon_{zz}=0$.\n- Case 2: Plane stress analysis, with $\\sigma_{zz}=0$.\n- Objective: Derive the critical vertical height $H_c$ for impending failure for each case and compute the ratio $\\frac{H_{c}^{\\text{plane stress}}}{H_{c}^{\\text{plane strain}}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic exercise in geotechnical slope stability, a core topic in computational geomechanics.\n\n- **Scientifically Grounded:** The problem uses standard, well-established concepts: infinite slope geometry, total stress analysis for undrained clay, and the Tresca ($\\phi=0$) failure criterion. The distinction between plane stress and plane strain is a fundamental concept in continuum mechanics. All premises are scientifically sound.\n- **Well-Posed:** The problem is well-defined. It provides all necessary symbolic parameters ($\\beta$, $s_u$, $\\gamma$) and a clearly specified failure mechanism. The objective to find a critical height and a ratio is specific and leads to a unique solution.\n- **Objective:** The problem statement is written in precise, unbiased technical language.\n\nThe problem is self-contained and free from scientific flaws, contradictions, or ambiguities. It represents a valid and formalizable scientific problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution will now be derived.\n\n### Derivation of Critical Height\n\nThe problem requires the derivation of the critical height $H_c$ at which a translational slip is impending. This requires comparing the shear stress acting on the potential failure plane to the shear strength of the material on that plane.\n\n**1. Shear Stress on the Failure Plane**\n\nThe shear stress on the specified failure plane is induced by the gravitational force of the soil mass above it. This stress can be determined purely from static equilibrium.\n\nLet's establish a coordinate system with the $x$-axis pointing downslope, parallel to the ground surface, and the $y$-axis pointing into the soil, perpendicular to the surface. The problem specifies a potential failure plane at a constant vertical depth $H$.\n\nConsider a slice of soil of horizontal width $b$ and unit thickness into the page. The vertical depth to the failure plane is $H$.\nThe volume of this soil slice is $V = b \\times H \\times 1$.\nThe total weight of this slice is $W = \\gamma V = \\gamma b H$. This force acts vertically downwards.\n\nThe failure plane is inclined at an angle $\\beta$ to the horizontal. The area of the failure plane beneath this soil slice, $A$, is the length along the slope, $L = b / \\cos(\\beta)$, multiplied by the unit thickness. Thus, $A = \\frac{b}{\\cos(\\beta)}$.\n\nThe component of the weight $W$ acting parallel to the failure plane is the driving shear force, $F_D$.\n$$F_D = W \\sin(\\beta) = (\\gamma b H) \\sin(\\beta)$$\n\nThe shear stress, $\\tau$, on the failure plane is this driving force distributed over the area $A$.\n$$\\tau = \\frac{F_D}{A} = \\frac{\\gamma b H \\sin(\\beta)}{b / \\cos(\\beta)} = \\gamma H \\sin(\\beta) \\cos(\\beta)$$\n\nThis expression for the driving shear stress at a vertical depth $H$ is derived from equilibrium principles alone. It depends only on the geometry ($\\beta$), the material's unit weight ($\\gamma$), and the depth ($H$). It is independent of the material's constitutive law (e.g., elasticity) or the specific two-dimensional assumption (plane stress or plane strain).\n\n**2. Shear Strength of the Material**\n\nThe problem models the saturated clay as a Tresca ($\\phi=0$) material with a constant undrained shear strength $s_u$. In a total stress analysis, this means the material's resistance to shear failure on any plane is equal to $s_u$, regardless of the normal stress acting on that plane.\nThe failure criterion for the prescribed translational slip mode is therefore:\n$$|\\tau| = s_u$$\n\n**3. Critical Height Calculation**\n\nImpending failure occurs at the critical vertical height $H_c$ when the driving shear stress equals the available shear strength.\n$$\\gamma H_c \\sin(\\beta) \\cos(\\beta) = s_u$$\n\nSolving for $H_c$, we get:\n$$H_c = \\frac{s_u}{\\gamma \\sin(\\beta) \\cos(\\beta)}$$\n\n**4. Comparison of Plane Strain and Plane Stress Analyses**\n\nThe problem asks for the derivation of $H_c$ for both a plane strain ($\\varepsilon_{zz}=0$) and a plane stress ($\\sigma_{zz}=0$) analysis. Let's analyze the impact of these assumptions.\n\nThe assumptions of plane strain or plane stress affect the full three-dimensional state of stress, specifically the out-of-plane normal stress $\\sigma_{zz}$ and the in-plane normal stress parallel to the slope, $\\sigma_{xx}$. These stresses are required if one were to evaluate the general Tresca yield criterion, $\\sigma_1 - \\sigma_3 = 2s_u$, without a prescribed failure mode.\n\nHowever, this particular problem specifies the failure mechanism: a translational slip along a plane parallel to the slope. For a Tresca ($\\phi=0$) material, the shear strength $s_u$ is, by definition, independent of the normal stresses. The stability analysis for this specific failure mode only requires comparing the shear stress on the slip plane ($\\tau$) to the shear strength ($s_u$).\n\nAs derived above:\n- The driving shear stress, $\\tau = \\gamma H \\sin(\\beta) \\cos(\\beta)$, is determined solely by equilibrium and is identical in both plane stress and plane strain cases.\n- The resisting shear strength, $s_u$, is a constant material property for a $\\phi=0$ material and is also identical in both cases.\n\nSince the calculation for $H_c$ depends only on $\\tau$ and $s_u$, the resulting expression for the critical height is the same for both analyses. The information regarding plane stress versus plane strain is extraneous to the resolution of this specific problem, as the prescribed failure mode and material law bypass the need for a full stress tensor analysis.\n\nTherefore:\n$$H_{c}^{\\text{plane strain}} = \\frac{s_u}{\\gamma \\sin(\\beta) \\cos(\\beta)}$$\n$$H_{c}^{\\text{plane stress}} = \\frac{s_u}{\\gamma \\sin(\\beta) \\cos(\\beta)}$$\n\n**5. Ratio of Critical Heights**\n\nThe ratio is calculated as:\n$$\n\\frac{H_{c}^{\\text{plane stress}}}{H_{c}^{\\text{plane strain}}} = \\frac{\\frac{s_u}{\\gamma \\sin(\\beta) \\cos(\\beta)}}{\\frac{s_u}{\\gamma \\sin(\\beta) \\cos(\\beta)}} = 1\n$$\nThe ratio is a pure number, independent of any of the problem parameters, as required.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "Having seen a case where the 2D assumption was not critical, we now explore a problem where it fundamentally alters the physics. This practice delves into the coupled theory of poroelasticity, requiring the derivation of the governing equations for a thin saturated layer under a plane stress constraint. You will discover how this purely mechanical assumption, $\\sigma_{zz}=0$, propagates through the effective stress principle to modify the fluid mass balance equation, providing deep insight into the subtle interplays within multi-physics problems .",
            "id": "3550721",
            "problem": "A homogeneous, fully saturated, linear isotropic poroelastic thin layer of thickness $h$ extends infinitely in the in-plane directions $x$ and $y$. The layer is thin enough that the plane stress condition applies: the total stress component normal to the layer vanishes, $\\sigma_{zz} = 0$, and through-thickness shear stresses vanish. Assume small strains, quasi-static conditions, and no body forces. State fields are independent of the through-thickness coordinate $z$ and there is no through-thickness flow. The solid skeleton is characterized by drained Young’s modulus $E$ and drained Poisson’s ratio $\\nu$, and the fluid-skeleton coupling is described by Biot’s coefficient $\\alpha$ and Biot’s modulus $M$. The pore fluid flow is governed by Darcy’s law with intrinsic permeability $k$ and dynamic viscosity $\\mu$.\n\nStarting only from:\n- Balance of linear momentum for the mixture, $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$.\n- The small-strain kinematic definition $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}})$.\n- Linear poroelasticity for an isotropic drained skeleton, with the effective stress principle $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon} - \\alpha p \\boldsymbol{I}$, where $\\mathbb{C}$ is the fourth-order drained elasticity tensor parametrized by Lamé constants $\\lambda$ and $G$ and $p$ is the pore pressure.\n- Conservation of fluid mass expressed through the fluid content increment $\\zeta$, namely $\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{q} = 0$, with $\\zeta = \\alpha \\varepsilon_{v} + \\tfrac{p}{M}$ and $\\varepsilon_{v} = \\mathrm{tr}\\,\\boldsymbol{\\varepsilon}$ the volumetric strain.\n- Darcy’s law $\\boldsymbol{q} = -\\dfrac{k}{\\mu} \\nabla p$,\n\nperform the following:\n- Reduce the coupled Partial Differential Equations (PDEs) to an in-plane system under the plane stress condition $\\sigma_{zz} = 0$ by eliminating the out-of-plane strain $\\varepsilon_{zz}$ in favor of the in-plane strains and the pore pressure $p$.\n- Show explicitly how the condition $\\sigma_{zz} = 0$ modifies the fluid mass conservation by altering the storage term through the effective stress relation.\n- Identify the modified storage coefficient under plane stress, denoted $S_{\\mathrm{ps}}$, that multiplies $\\dot{p}$ in the reduced in-plane conservation law.\n\nFinally, provide the closed-form analytic expression for $S_{\\mathrm{ps}}$ solely in terms of $E$, $\\nu$, $\\alpha$, and $M$. Your final answer must be a single analytic expression. No numerical evaluation is required.",
            "solution": "The user has provided a problem statement in the field of computational geomechanics, specifically concerning linear poroelasticity under plane stress conditions. The first and most critical step is to validate the problem statement for scientific soundness, clarity, and completeness.\n\n### Step 1: Extract Givens\nThe problem provides the following data, conditions, and governing equations:\n- **System**: A homogeneous, fully saturated, linear isotropic poroelastic thin layer of thickness $h$.\n- **Geometry  Dimensionality**: The layer is infinite in the $x$ and $y$ directions. Fields are independent of the through-thickness coordinate $z$.\n- **Mechanical Condition**: Plane stress, specifically $\\sigma_{zz} = 0$. Through-thickness shear stresses also vanish.\n- **Flow Condition**: No through-thickness flow, $q_z = 0$.\n- **Assumptions**: Small strains, quasi-static conditions, no body forces.\n- **Material Properties**: Drained Young’s modulus $E$, drained Poisson’s ratio $\\nu$, Biot’s coefficient $\\alpha$, Biot’s modulus $M$, intrinsic permeability $k$, and dynamic viscosity $\\mu$.\n- **Governing Equations**:\n    1.  Balance of linear momentum: $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$.\n    2.  Strain-displacement relation: $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}})$.\n    3.  Constitutive law: $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon} - \\alpha p \\boldsymbol{I}$, where $\\mathbb{C}$ is the drained elasticity tensor for an isotropic material parametrized by Lamé constants $\\lambda$ and $G$.\n    4.  Fluid mass conservation: $\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{q} = 0$.\n    5.  Fluid content increment: $\\zeta = \\alpha \\varepsilon_{v} + \\tfrac{p}{M}$, where $\\varepsilon_{v} = \\mathrm{tr}\\,\\boldsymbol{\\varepsilon}$.\n    6.  Darcy’s law: $\\boldsymbol{q} = -\\dfrac{k}{\\mu} \\nabla p$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is formulated within the framework of Biot's theory of linear poroelasticity, which is a fundamental and well-established theory in mechanics of porous media. All provided equations are standard forms. The problem is scientifically sound.\n- **Well-Posed**: The task is to derive an analytical expression for a specific coefficient ($S_{\\mathrm{ps}}$) by manipulating the given set of equations under a specified constraint. This represents a well-defined mathematical derivation, not a boundary value problem. The request is unambiguous.\n- **Objective**: The problem is stated in precise, technical language, free of any subjectivity or opinion.\n- **Incomplete or Contradictory Setup**: The problem provides all necessary equations and constraints to perform the required derivation. The combination of plane stress with poroelasticity is a standard topic. There are no contradictions.\n- **Unrealistic or Infeasible**: The plane stress assumption is a standard and valid idealization for thin structures where out-of-plane stresses are negligible. The setup is physically plausible within this modeling context.\n\n### Step 3: Verdict and Action\nThe problem statement is valid, being scientifically sound, well-posed, and self-contained. Therefore, I will proceed with the derivation of the solution.\n\nThe objective is to derive the modified storage coefficient, $S_{\\mathrm{ps}}$, which multiplies the pore pressure rate, $\\dot{p}$, in the fluid mass conservation equation when reduced for plane stress conditions ($\\sigma_{zz} = 0$).\n\nThe derivation proceeds as follows. First, we use the plane stress condition to express the out-of-plane strain, $\\varepsilon_{zz}$, in terms of the in-plane strains and the pore pressure. This result is then used to find a modified expression for the volumetric strain, $\\varepsilon_v$. Finally, this modified expression for $\\varepsilon_v$ is substituted into the fluid mass conservation law, from which the coefficient of $\\dot{p}$ can be identified.\n\nThe constitutive relation for an isotropic linear poroelastic material is given by $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon} - \\alpha p \\boldsymbol{I}$. In component form, using Lamé constants $\\lambda$ and $G$, the normal stress components are:\n$$\n\\sigma_{ij} = \\lambda \\varepsilon_{v} \\delta_{ij} + 2 G \\varepsilon_{ij} - \\alpha p \\delta_{ij}\n$$\nwhere $\\varepsilon_{v} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ is the volumetric strain and $\\delta_{ij}$ is the Kronecker delta.\n\nThe $zz$-component of the total stress is:\n$$\n\\sigma_{zz} = \\lambda (\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2 G \\varepsilon_{zz} - \\alpha p\n$$\nThe plane stress condition requires that $\\sigma_{zz} = 0$. Applying this condition gives:\n$$\n\\lambda \\varepsilon_{xx} + \\lambda \\varepsilon_{yy} + \\lambda \\varepsilon_{zz} + 2 G \\varepsilon_{zz} - \\alpha p = 0\n$$\nWe can rearrange this equation to solve for the out-of-plane strain, $\\varepsilon_{zz}$:\n$$\n(\\lambda + 2G) \\varepsilon_{zz} = - \\lambda (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\alpha p\n$$\n$$\n\\varepsilon_{zz} = - \\frac{\\lambda}{\\lambda + 2G} (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\frac{\\alpha}{\\lambda + 2G} p\n$$\nThis equation shows that under plane stress, the out-of-plane strain $\\varepsilon_{zz}$ is induced by both in-plane strains and the pore pressure.\n\nNext, we substitute this expression for $\\varepsilon_{zz}$ back into the definition of volumetric strain, $\\varepsilon_v$:\n$$\n\\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\left[ - \\frac{\\lambda}{\\lambda + 2G} (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\frac{\\alpha}{\\lambda + 2G} p \\right]\n$$\nGrouping terms related to the in-plane volumetric strain, $\\varepsilon_{v,\\mathrm{ps}} = \\varepsilon_{xx} + \\varepsilon_{yy}$:\n$$\n\\varepsilon_v = \\left( 1 - \\frac{\\lambda}{\\lambda + 2G} \\right) (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\frac{\\alpha}{\\lambda + 2G} p\n$$\n$$\n\\varepsilon_v = \\left( \\frac{\\lambda + 2G - \\lambda}{\\lambda + 2G} \\right) (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\frac{\\alpha}{\\lambda + 2G} p\n$$\n$$\n\\varepsilon_v = \\frac{2G}{\\lambda + 2G} (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\frac{\\alpha}{\\lambda + 2G} p\n$$\nThis is the key relation that connects the total volumetric strain $\\varepsilon_v$ to the in-plane strains and pore pressure under the plane stress constraint.\n\nNow, we turn to the fluid mass conservation equation: $\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{q} = 0$.\nThe fluid content increment $\\zeta$ is defined as $\\zeta = \\alpha \\varepsilon_{v} + \\tfrac{p}{M}$. Substituting our derived expression for $\\varepsilon_v$ into the definition of $\\zeta$:\n$$\n\\zeta = \\alpha \\left[ \\frac{2G}{\\lambda + 2G} (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\frac{\\alpha}{\\lambda + 2G} p \\right] + \\frac{p}{M}\n$$\nRearranging the terms:\n$$\n\\zeta = \\alpha \\frac{2G}{\\lambda + 2G} (\\varepsilon_{xx} + \\varepsilon_{yy}) + \\left( \\frac{\\alpha^2}{\\lambda + 2G} + \\frac{1}{M} \\right) p\n$$\nTo get the mass conservation law, we differentiate $\\zeta$ with respect to time:\n$$\n\\dot{\\zeta} = \\alpha \\frac{2G}{\\lambda + 2G} (\\dot{\\varepsilon}_{xx} + \\dot{\\varepsilon}_{yy}) + \\left( \\frac{\\alpha^2}{\\lambda + 2G} + \\frac{1}{M} \\right) \\dot{p}\n$$\nThe reduced in-plane fluid mass conservation law is thus:\n$$\n\\alpha \\frac{2G}{\\lambda + 2G} (\\dot{\\varepsilon}_{xx} + \\dot{\\varepsilon}_{yy}) + \\left( \\frac{\\alpha^2}{\\lambda + 2G} + \\frac{1}{M} \\right) \\dot{p} + \\nabla \\cdot \\boldsymbol{q} = 0\n$$\nThe problem asks to identify the modified storage coefficient, $S_{\\mathrm{ps}}$, which multiplies $\\dot{p}$ in this reduced equation. By inspection, we find:\n$$\nS_{\\mathrm{ps}} = \\frac{\\alpha^2}{\\lambda + 2G} + \\frac{1}{M}\n$$\nThis expression demonstrates how the plane stress condition modifies storage. The term $\\frac{1}{M}$ is the standard specific storage capacity related to fluid and grain compressibility. The additional term $\\frac{\\alpha^2}{\\lambda + 2G}$ arises because an increase in pore pressure, under the $\\sigma_{zz}=0$ constraint, induces an unresisted expansion in the $z$-direction, which increases pore volume and thus the capacity to store fluid.\n\nThe final step is to express $S_{\\mathrm{ps}}$ in terms of the drained material properties $E$ and $\\nu$, instead of Lamé constants $\\lambda$ and $G$. The standard relations for 3D isotropic elasticity are:\n$$\nG = \\frac{E}{2(1+\\nu)} \\quad \\text{and} \\quad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\nWe need to evaluate the term $\\lambda + 2G$:\n$$\n\\lambda + 2G = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + 2 \\left( \\frac{E}{2(1+\\nu)} \\right) = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu}\n$$\nCreating a common denominator:\n$$\n\\lambda + 2G = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E(1-2\\nu)}{(1+\\nu)(1-2\\nu)} = \\frac{E\\nu + E - 2E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\nNow, we substitute this into the expression for $S_{\\mathrm{ps}}$:\n$$\nS_{\\mathrm{ps}} = \\frac{\\alpha^2}{\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}} + \\frac{1}{M}\n$$\n$$\nS_{\\mathrm{ps}} = \\frac{\\alpha^2 (1+\\nu)(1-2\\nu)}{E(1-\\nu)} + \\frac{1}{M}\n$$\nThis is the final analytical expression for the modified storage coefficient under plane stress conditions, given in terms of the requested parameters $E$, $\\nu$, $\\alpha$, and $M$.",
            "answer": "$$\n\\boxed{\\frac{\\alpha^2 (1+\\nu)(1-2\\nu)}{E(1-\\nu)} + \\frac{1}{M}}\n$$"
        },
        {
            "introduction": "From theory, we move to implementation and verification, the cornerstones of reliable computational modeling. This exercise guides you through the process of building a finite element solver and implementing a powerful check on its correctness based on the Maxwell-Betti reciprocal work theorem. By deliberately mis-specifying boundary conditions and observing the failure of reciprocity, you will gain hands-on experience in debugging numerical models and building confidence in your simulation results .",
            "id": "3550723",
            "problem": "Consider a homogeneous, isotropic, linear elastic body occupying a two-dimensional domain with Cartesian coordinates $(x,y)$ and outward unit normal $\\mathbf{n}$. The governing assumptions are either plane stress or plane strain. The constitutive behavior follows Hooke’s law in two dimensions, and the traction vector on a boundary segment is defined by Cauchy’s theorem as $\\mathbf{t} = \\boldsymbol{\\sigma}\\,\\mathbf{n}$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor. The principle of virtual work and the symmetry of the stress tensor hold. Let the material have Young’s modulus $E$ and Poisson’s ratio $\\nu$, and consider a body of unit thickness $t = 1\\,\\mathrm{m}$ so that all forces computed are per meter thickness. \n\nTask A (derivation). Starting from the balance of linear momentum and Cauchy’s traction principle, derive the correct traction and displacement boundary conditions at free surfaces for both plane stress and plane strain assumptions. Explicitly state the kinematic constraints and stress components that vanish under each assumption, and show how the traction-free condition is expressed in terms of $\\boldsymbol{\\sigma}$ and $\\mathbf{n}$ on the free boundary. Your derivation must be carried out from first principles and must not use shortcut formulas beyond fundamental definitions. \n\nTask B (computational test via reciprocal work). Design and implement a numerical test using the Finite Element Method (FEM) that verifies the Maxwell–Betti reciprocal work theorem for two independent load cases on a small two-dimensional mesh, under both plane stress and plane strain assumptions. Specifically:\n- Discretize the square domain $\\Omega = [0,1] \\times [0,1]$ using a conforming triangulation, with linear triangular elements and unit thickness $t = 1\\,\\mathrm{m}$. Distances are in meters.\n- Construct the element stiffness using the appropriate two-dimensional constitutive matrix $D$ for plane stress and for plane strain, derived from $E$ and $\\nu$.\n- Impose essential (displacement) boundary conditions to remove rigid body motions by fixing $(u_x,u_y)$ at node $(0,0)$ and $u_y$ at node $(1,0)$.\n- Apply boundary tractions as follows. Load case $A$: uniform traction $\\mathbf{t}_A = (p,0)$ on the right boundary $x=1$. Load case $B$: uniform traction $\\mathbf{t}_B = (0,p)$ on the top boundary $y=1$. Here $p$ is a specified traction magnitude in pascals. All other boundaries are traction-free, i.e., $\\mathbf{t} = \\mathbf{0}$.\n- Compute displacements $\\mathbf{u}^A$ and $\\mathbf{u}^B$ for the two load cases, and evaluate the reciprocal work scalars $W_{AB} = \\mathbf{F}_A^\\top \\mathbf{u}^B$ and $W_{BA} = \\mathbf{F}_B^\\top \\mathbf{u}^A$, where $\\mathbf{F}_A$ and $\\mathbf{F}_B$ are the global nodal force vectors corresponding to $\\mathbf{t}_A$ and $\\mathbf{t}_B$. The Maxwell–Betti theorem predicts $W_{AB} = W_{BA}$ for a single linear elastic operator with symmetric stiffness and consistent boundary conditions.\n- Design mis-specified boundary condition variants for one of the load cases that violate the free-surface condition (e.g., by erroneously fixing displacement components along a boundary that should be traction-free). Show that when the two load cases are solved under different boundary condition operators, the reciprocal work equality generally fails, and use this failure to detect mis-specified boundary conditions. \n\nYour program must implement the above and report, for each test case, a boolean indicating whether the Maxwell–Betti check is satisfied within a relative tolerance of $10^{-6}$. Booleans should be printed as the programming language’s native boolean literals.\n\nPhysical units:\n- Young’s modulus $E$ is in pascals $(\\mathrm{Pa})$.\n- Traction magnitude $p$ is in pascals $(\\mathrm{Pa})$.\n- Lengths are in meters $(\\mathrm{m})$.\n- The thickness is $t=1\\,\\mathrm{m}$.\n\nAngle units: no angles are used in this problem.\n\nTest suite and parameter specification:\n- Test case $1$ (happy path, plane stress): $E = 3.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\nu = 0.25$, $p = 1.0\\times 10^{6}\\,\\mathrm{Pa}$; both load cases use correct traction-free boundary conditions except for the supports specified above.\n- Test case $2$ (happy path, plane strain): $E = 3.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\nu = 0.25$, $p = 1.0\\times 10^{6}\\,\\mathrm{Pa}$; both load cases use correct traction-free boundary conditions except for the supports specified above.\n- Test case $3$ (mis-specified boundary condition, plane stress): $E = 1.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\nu = 0.30$, $p = 2.0\\times 10^{6}\\,\\mathrm{Pa}$; load case $A$ uses correct traction-free boundaries, while load case $B$ is erroneously constrained by fixing $u_y$ on the entire top boundary ($y=1$), violating the free-surface condition.\n- Test case $4$ (near incompressible, mis-specified boundary condition, plane strain): $E = 1.0\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.49$, $p = 5.0\\times 10^{5}\\,\\mathrm{Pa}$; load case $A$ uses correct traction-free boundaries, while load case $B$ is erroneously constrained by fixing $u_x$ on the entire right boundary ($x=1$), violating the free-surface condition.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[ \\mathrm{True}, \\mathrm{False}, \\mathrm{True}, \\mathrm{False} ]$), where each entry is a boolean that is $\\mathrm{True}$ if $|W_{AB} - W_{BA}|/\\max(1,|W_{AB}|,|W_{BA}|)  10^{-6}$ and $\\mathrm{False}$ otherwise. The brackets and commas must follow the exact formatting shown, and the program must not print any other text.",
            "solution": "The problem is valid as it is scientifically grounded in linear elasticity and the Finite Element Method (FEM), well-posed, and objective. It presents a standard derivation task (Task A) and a non-trivial computational verification task (Task B) that are consistent and complete.\n\n### Task A: Derivation of Boundary Conditions\n\nThis task requires the derivation of traction and displacement boundary conditions for plane stress and plane strain assumptions starting from first principles.\n\n**1. Fundamental Principles**\n\nThe foundation of the derivation rests on two principles of continuum mechanics for a body in quasi-static equilibrium (no inertial effects) and in the absence of body forces ($\\mathbf{b}=\\mathbf{0}$):\n\n- **Balance of Linear Momentum**: In its local (differential) form, this principle states that the divergence of the Cauchy stress tensor $\\boldsymbol{\\sigma}$ is zero throughout the body's domain $\\Omega$:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0} $$\nIn Cartesian coordinates $(x,y,z)$, this expands to three scalar equations:\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} = 0 $$\n$$ \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} + \\frac{\\partial \\sigma_{yz}}{\\partial z} = 0 $$\n$$ \\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zy}}{\\partial y} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = 0 $$\n\n- **Cauchy's Traction Principle**: This principle relates the stress state within the body to the traction vector $\\mathbf{t}$ (force per unit area) acting on any surface within or on the boundary of the body. For a surface with an outward unit normal vector $\\mathbf{n}$, the traction is given by:\n$$ \\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n} $$\nA \"free surface\" is a boundary where no external forces are applied. Therefore, on a free surface, the traction vector is zero, $\\mathbf{t} = \\mathbf{0}$. This defines the **natural boundary condition** for a free surface:\n$$ \\boldsymbol{\\sigma} \\mathbf{n} = \\mathbf{0} $$\nIn addition, **essential boundary conditions** may be prescribed, where the displacement vector $\\mathbf{u}$ is fixed to a known value $\\bar{\\mathbf{u}}$ on a portion of the boundary.\n\n**2. Plane Stress Condition**\n\n- **Assumption and Vanishing Stresses**: The plane stress assumption is applicable to thin, flat bodies (like plates) loaded only in their plane. The thickness in the $z$-direction is assumed to be small, and the top and bottom surfaces ($z=\\pm h/2$) are free of traction. It is then assumed that the stress components acting perpendicular to the $xy$-plane are negligible throughout the body's thickness.\n$$ \\sigma_{zz} = 0, \\quad \\sigma_{xz} = 0, \\quad \\sigma_{yz} = 0 $$\n- **Kinematic Consequence**: These stress assumptions do not imply that the corresponding strain components are zero. For a linear isotropic elastic material (Hooke's Law), the strain $\\epsilon_{zz}$ is related to the in-plane stresses:\n$$ \\epsilon_{zz} = \\frac{1}{E} [ \\sigma_{zz} - \\nu(\\sigma_{xx} + \\sigma_{yy}) ] = -\\frac{\\nu}{E}(\\sigma_{xx} + \\sigma_{yy}) \\neq 0 $$\nThus, under plane stress, the body experiences changes in thickness. There are no a priori kinematic constraints on the strain field, only on the stress field.\n- **Free-Surface Boundary Condition**: Consider a free boundary on the edge of the plate, within the $xy$-plane. The outward normal vector $\\mathbf{n}$ is in this plane and has components $\\mathbf{n} = (n_x, n_y, 0)^\\top$. The stress tensor in matrix form is:\n$$ \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx}  \\sigma_{xy}  0 \\\\ \\sigma_{yx}  \\sigma_{yy}  0 \\\\ 0  0  0 \\end{pmatrix} $$\nApplying the traction-free condition $\\boldsymbol{\\sigma} \\mathbf{n} = \\mathbf{0}$:\n$$ \\begin{pmatrix} \\sigma_{xx}  \\sigma_{xy}  0 \\\\ \\sigma_{yx}  \\sigma_{yy}  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} n_x \\\\ n_y \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{xx}n_x + \\sigma_{xy}n_y \\\\ \\sigma_{yx}n_x + \\sigma_{yy}n_y \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nUsing the symmetry of the stress tensor ($\\sigma_{xy} = \\sigma_{yx}$), this yields two scalar equations for a free surface in a plane stress problem:\n$$ \\sigma_{xx}n_x + \\sigma_{xy}n_y = 0 $$\n$$ \\sigma_{xy}n_x + \\sigma_{yy}n_y = 0 $$\n\n**3. Plane Strain Condition**\n\n- **Assumption and Kinematic Constraints**: The plane strain assumption is applicable to bodies that are very long in one direction (say, the $z$-direction) and whose geometry and loading are constant along that length (e.g., dams, tunnels, retaining walls). This leads to the kinematic assumption that there is no displacement in the out-of-plane direction, $u_z=0$, and the in-plane displacements $u_x$ and $u_y$ are functions of only $x$ and $y$.\n- **Vanishing Strains**: The kinematic constraints directly imply that the out-of-plane strain components are zero:\n$$ \\epsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = 0 $$\n$$ \\gamma_{xz} = \\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x} = 0 $$\n$$ \\gamma_{yz} = \\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y} = 0 $$\nThe corresponding shear stresses are also zero, $\\sigma_{xz} = G\\gamma_{xz} = 0$ and $\\sigma_{yz} = G\\gamma_{yz} = 0$.\n- **Stress Consequence**: A non-zero axial stress $\\sigma_{zz}$ is required to enforce the constraint $\\epsilon_{zz}=0$. From Hooke's Law:\n$$ \\epsilon_{zz} = 0 = \\frac{1}{E} [ \\sigma_{zz} - \\nu(\\sigma_{xx} + \\sigma_{yy}) ] \\implies \\sigma_{zz} = \\nu(\\sigma_{xx} + \\sigma_{yy}) \\neq 0 $$\nThis axial stress ensures no change in length in the $z$-direction.\n- **Free-Surface Boundary Condition**: Consider a free boundary whose surface normal is in the $xy$-plane, so $\\mathbf{n} = (n_x, n_y, 0)^\\top$. The stress tensor has the form:\n$$ \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx}  \\sigma_{xy}  0 \\\\ \\sigma_{yx}  \\sigma_{yy}  0 \\\\ 0  0  \\sigma_{zz} \\end{pmatrix} $$\nApplying the traction-free condition $\\boldsymbol{\\sigma} \\mathbf{n} = \\mathbf{0}$:\n$$ \\begin{pmatrix} \\sigma_{xx}  \\sigma_{xy}  0 \\\\ \\sigma_{yx}  \\sigma_{yy}  0 \\\\ 0  0  \\sigma_{zz} \\end{pmatrix} \\begin{pmatrix} n_x \\\\ n_y \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{xx}n_x + \\sigma_{xy}n_y \\\\ \\sigma_{yx}n_x + \\sigma_{yy}n_y \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nUsing $\\sigma_{xy} = \\sigma_{yx}$, this yields two scalar equations, which are formally identical to the plane stress case:\n$$ \\sigma_{xx}n_x + \\sigma_{xy}n_y = 0 $$\n$$ \\sigma_{xy}n_x + \\sigma_{yy}n_y = 0 $$\nThe key difference lies in the constitutive relation between stress and strain used to evaluate the stress components.\n\n### Task B: Computational Test via Reciprocal Work\n\nThe Maxwell-Betti reciprocal work theorem states that for a linear elastic body subjected to two independent sets of loads, $\\{ \\mathbf{F}_A, \\mathbf{u}_A \\}$ and $\\{ \\mathbf{F}_B, \\mathbf{u}_B \\}$, the work done by the first set of loads acting through the displacements caused by the second set is equal to the work done by the second set of loads acting through the displacements caused by the first. In its discrete FEM form, this is $W_{AB} = \\mathbf{F}_A^\\top \\mathbf{u}_B = \\mathbf{F}_B^\\top \\mathbf{u}_A = W_{BA}$. This equality holds if both systems $\\{A\\}$ and $\\{B\\}$ are governed by the same symmetric linear operator (i.e., the same stiffness matrix $\\mathbf{K}$ resulting from the same material properties, mesh, and essential boundary conditions). If the essential boundary conditions differ between the two systems, the operators are different, and the equality is generally not expected to hold. This provides a method for detecting inconsistent boundary condition specifications.\n\nThe following Python program implements a 2D FEM solver for linear triangular elements to test this principle for the specified cases. The implementation proceeds as follows:\n1.  **Mesh Generation**: A structured grid of $10 \\times 10$ squares is created on the unit domain, with each square divided into two linear triangular elements.\n2.  **Constitutive Models**: Functions provide the $2D$ material stiffness matrix $\\mathbf{D}$ for both plane stress and plane strain.\n3.  **FEM Assembly**: The code iterates through each element, calculates its element stiffness matrix $\\mathbf{k}^e = \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\cdot A \\cdot t$, and assembles it into the global stiffness matrix $\\mathbf{K}$.\n4.  **Force Vector Assembly**: External nodal force vectors $\\mathbf{F}_A$ and $\\mathbf{F}_B$ are calculated by integrating the prescribed tractions over the boundary elements on the right ($x=1$) and top ($y=1$) edges, respectively.\n5.  **Boundary Conditions and Solver**: Essential (displacement) boundary conditions are applied by partitioning the global system of equations into free and fixed degrees of freedom. The reduced system for free DOFs is solved using `numpy.linalg.solve`.\n6.  **Reciprocal Work Calculation**: For each test case, two FEM simulations are run: one for load case A and one for load case B, using the appropriate boundary conditions for each. The resulting force and displacement vectors are used to compute $W_{AB} = \\mathbf{F}_A^\\top \\mathbf{u}_B$ and $W_{BA} = \\mathbf{F}_B^\\top \\mathbf{u}_A$.\n7.  **Verification**: The two work scalars are compared using the specified relative tolerance to determine if the Maxwell-Betti check is satisfied, producing a boolean result for each test case. Cases 1 and 2 are \"happy paths\" with consistent BCs, while Cases 3 and 4 introduce inconsistent BCs for load case B, which is expected to cause the reciprocity check to fail.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver funtion to execute the FEM analysis for all test cases.\n    \"\"\"\n\n    def generate_mesh(nx=10, ny=10):\n        \"\"\"Generates a structured mesh of linear triangles on the [0,1]x[0,1] domain.\"\"\"\n        x = np.linspace(0, 1, nx + 1)\n        y = np.linspace(0, 1, ny + 1)\n        nodes = np.array([[xi, yi] for yi in y for xi in x])\n        \n        elements = []\n        for j in range(ny):\n            for i in range(nx):\n                n1 = i + j * (nx + 1)\n                n2 = (i + 1) + j * (nx + 1)\n                n3 = (i + 1) + (j + 1) * (nx + 1)\n                n4 = i + (j + 1) * (nx + 1)\n                elements.append([n1, n2, n3])\n                elements.append([n1, n3, n4])\n        return nodes, np.array(elements)\n\n    def get_constitutive_matrix(E, nu, plane_type):\n        \"\"\"Returns the constitutive matrix D for plane stress or plane strain.\"\"\"\n        if plane_type == 'stress':\n            c = E / (1 - nu**2)\n            D = c * np.array([[1, nu, 0],\n                              [nu, 1, 0],\n                              [0, 0, (1 - nu) / 2]])\n        elif plane_type == 'strain':\n            c = E / ((1 + nu) * (1 - 2 * nu))\n            D = c * np.array([[1 - nu, nu, 0],\n                              [nu, 1 - nu, 0],\n                              [0, 0, (1 - 2 * nu) / 2]])\n        else:\n            raise ValueError(\"plane_type must be 'stress' or 'strain'\")\n        return D\n\n    def get_element_stiffness(coords, D_matrix, thickness):\n        \"\"\"Calculates the stiffness matrix for a single T3 element.\"\"\"\n        x1, y1 = coords[0]\n        x2, y2 = coords[1]\n        x3, y3 = coords[2]\n        \n        area = 0.5 * np.linalg.det(np.array([[1, x1, y1], [1, x2, y2], [1, x3, y3]]))\n        if area = 0:\n            raise ValueError(\"Zero or negative area element\")\n            \n        B = (1 / (2 * area)) * np.array([\n            [y2 - y3, 0, y3 - y1, 0, y1 - y2, 0],\n            [0, x3 - x2, 0, x1 - x3, 0, x2 - x1],\n            [x3 - x2, y2 - y3, x1 - x3, y3 - y1, x2 - x1, y1 - y2]\n        ])\n        \n        ke = B.T @ D_matrix @ B * area * thickness\n        return ke\n\n    def run_fem(nodes, elements, E, nu, p, plane_type, load_case, bc_config):\n        \"\"\"\n        Main FEM routine for a single load case and BC configuration.\n        Returns the global force vector and global displacement vector.\n        \"\"\"\n        num_nodes = len(nodes)\n        num_dofs = 2 * num_nodes\n        thickness = 1.0\n        \n        D_matrix = get_constitutive_matrix(E, nu, plane_type)\n        \n        K = np.zeros((num_dofs, num_dofs))\n        for el_nodes_idx in elements:\n            el_coords = nodes[el_nodes_idx]\n            ke = get_element_stiffness(el_coords, D_matrix, thickness)\n            \n            dof_indices = []\n            for node_idx in el_nodes_idx:\n                dof_indices.extend([2 * node_idx, 2 * node_idx + 1])\n                \n            for i in range(6):\n                for j in range(6):\n                    K[dof_indices[i], dof_indices[j]] += ke[i, j]\n\n        F = np.zeros(num_dofs)\n        nx = int(round(np.max(nodes[:, 0]) * (np.sqrt(num_nodes)-1)))\n        ny = int(round(np.max(nodes[:, 1]) * (np.sqrt(num_nodes)-1)))\n\n        if load_case == 'A': # Traction on right edge\n            for j in range(ny):\n                n1_idx = (nx) + j * (nx + 1)\n                n2_idx = (nx) + (j + 1) * (nx + 1)\n                edge_len = np.linalg.norm(nodes[n2_idx] - nodes[n1_idx])\n                force_val = p * edge_len * thickness / 2.0\n                F[2 * n1_idx] += force_val\n                F[2 * n2_idx] += force_val\n        elif load_case == 'B': # Traction on top edge\n             for i in range(nx):\n                n1_idx = i + ny * (nx + 1)\n                n2_idx = (i + 1) + ny * (nx + 1)\n                edge_len = np.linalg.norm(nodes[n2_idx] - nodes[n1_idx])\n                force_val = p * edge_len * thickness / 2.0\n                F[2 * n1_idx + 1] += force_val\n                F[2 * n2_idx + 1] += force_val\n        \n        # Apply essential BCs\n        fixed_dofs = []\n        # Standard supports to prevent rigid body motion\n        node00_idx = 0\n        fixed_dofs.extend([2 * node00_idx, 2 * node00_idx + 1])\n        node10_idx = nx\n        fixed_dofs.append(2 * node10_idx + 1)\n\n        # Mis-specified BCs from problem statement\n        if bc_config == 'mis_spec_3': # Fix uy on top for Load Case B of test 3\n            for i in range(nx + 1):\n                node_idx = i + ny * (nx + 1)\n                fixed_dofs.append(2 * node_idx + 1)\n        elif bc_config == 'mis_spec_4': # Fix ux on right for Load Case B of test 4\n            for j in range(ny + 1):\n                node_idx = nx + j * (nx + 1)\n                fixed_dofs.append(2 * node_idx)\n        \n        fixed_dofs = sorted(list(set(fixed_dofs)))\n        all_dofs = np.arange(num_dofs)\n        free_dofs = np.setdiff1d(all_dofs, fixed_dofs)\n        \n        K_ff = K[np.ix_(free_dofs, free_dofs)]\n        F_f = F[free_dofs]\n        \n        U_f = np.linalg.solve(K_ff, F_f)\n        \n        U = np.zeros(num_dofs)\n        U[free_dofs] = U_f\n        \n        return F, U\n\n    test_cases = [\n        {'E': 3.0e10, 'nu': 0.25, 'p': 1.0e6, 'type': 'stress', 'bc_A': 'correct', 'bc_B': 'correct'},\n        {'E': 3.0e10, 'nu': 0.25, 'p': 1.0e6, 'type': 'strain', 'bc_A': 'correct', 'bc_B': 'correct'},\n        {'E': 1.0e10, 'nu': 0.30, 'p': 2.0e6, 'type': 'stress', 'bc_A': 'correct', 'bc_B': 'mis_spec_3'},\n        {'E': 1.0e9,  'nu': 0.49, 'p': 5.0e5,  'type': 'strain', 'bc_A': 'correct', 'bc_B': 'mis_spec_4'}\n    ]\n\n    results = []\n    nodes, elements = generate_mesh()\n    \n    for case in test_cases:\n        E, nu, p, plane_type = case['E'], case['nu'], case['p'], case['type']\n        bc_A_config, bc_B_config = case['bc_A'], case['bc_B']\n\n        # Solve for Load Case A\n        F_A, U_A = run_fem(nodes, elements, E, nu, p, plane_type, 'A', bc_A_config)\n        \n        # Solve for Load Case B\n        F_B, U_B = run_fem(nodes, elements, E, nu, p, plane_type, 'B', bc_B_config)\n\n        # Calculate reciprocal work\n        W_AB = F_A.T @ U_B\n        W_BA = F_B.T @ U_A\n        \n        # Check for equality within tolerance\n        denominator = max(1.0, abs(W_AB), abs(W_BA))\n        relative_error = abs(W_AB - W_BA) / denominator\n        \n        is_satisfied = relative_error  1e-6\n        results.append(str(is_satisfied))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}