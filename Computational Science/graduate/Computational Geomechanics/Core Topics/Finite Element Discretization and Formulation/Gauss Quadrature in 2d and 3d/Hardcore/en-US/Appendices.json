{
    "hands_on_practices": [
        {
            "introduction": "Numerical integration in the Finite Element Method often begins with the simplest element: the quadrilateral, mapped from a reference square. This exercise  serves as a foundational check on your understanding of tensor-product Gauss-Legendre quadrature. By comparing the numerical result with the exact analytical value for a simple polynomial, you will directly verify the rule's degree of exactness, a crucial first step in validating any FEM implementation.",
            "id": "3527331",
            "problem": "In computational geomechanics, volume integrals over reference elements frequently arise when assembling matrices in the Finite Element Method (FEM). Consider the reference square $[-1,1]^2$ associated with a bilinear quadrilateral element. Evaluate the integral\n$$\nI \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} x^{3}\\,y^{5}\\,dx\\,dy\n$$\nusing a tensor-product Gauss–Legendre quadrature with $3$ points per direction. Then compute the analytic value of the same integral directly from the definition of the Riemann integral and compare the two values to determine whether the quadrature rule is exact for this integrand. Express your final answer as a pure number with no units. No rounding is required.",
            "solution": "The problem requires the evaluation of the integral $I = \\int_{-1}^{1}\\int_{-1}^{1} x^{3}\\,y^{5}\\,dx\\,dy$ using two methods: first, a $3$-point tensor-product Gauss–Legendre quadrature, and second, direct analytical integration. The results are then to be compared.\n\nFirst, let us evaluate the integral analytically. The integrand, $f(x,y) = x^3 y^5$, is a separable function, meaning it can be written as a product of a function of $x$ and a function of $y$. Therefore, the double integral can be expressed as the product of two single integrals:\n$$\nI = \\left( \\int_{-1}^{1} x^{3}\\,dx \\right) \\left( \\int_{-1}^{1} y^{5}\\,dy \\right)\n$$\nWe evaluate each integral separately. The first integral is:\n$$\n\\int_{-1}^{1} x^{3}\\,dx = \\left[ \\frac{x^{4}}{4} \\right]_{-1}^{1} = \\frac{(1)^{4}}{4} - \\frac{(-1)^{4}}{4} = \\frac{1}{4} - \\frac{1}{4} = 0\n$$\nAlternatively, we recognize that the integrand $p(x) = x^3$ is an odd function, meaning $p(-x) = (-x)^3 = -x^3 = -p(x)$. The integral of any odd function over a symmetric interval, such as $[-1, 1]$, is always zero.\n\nSimilarly, for the second integral:\n$$\n\\int_{-1}^{1} y^{5}\\,dy = \\left[ \\frac{y^{6}}{6} \\right]_{-1}^{1} = \\frac{(1)^{6}}{6} - \\frac{(-1)^{6}}{6} = \\frac{1}{6} - \\frac{1}{6} = 0\n$$\nThe integrand $q(y) = y^5$ is also an odd function, so its integral over $[-1, 1]$ is zero.\n\nTherefore, the analytical value of the integral is:\n$$\nI = 0 \\times 0 = 0\n$$\n\nNext, we evaluate the integral using a $3$-point tensor-product Gauss–Legendre quadrature. The formula for the numerical approximation of the integral, which we denote $I_{GQ}$, is:\n$$\nI_{GQ} = \\int_{-1}^{1}\\int_{-1}^{1} f(x,y)\\,dx\\,dy \\approx \\sum_{i=1}^{3} \\sum_{j=1}^{3} w_i w_j f(x_i, y_j)\n$$\nwhere $\\{x_i\\}$ and $\\{y_j\\}$ are the Gauss points and $\\{w_i\\}$ and $\\{w_j\\}$ are the corresponding weights for the $3$-point rule. For Gauss-Legendre quadrature, the points are the roots of the Legendre polynomial of degree $n$, and the weights are derived from these roots. For $n=3$, the points and weights are:\nPoints ($\\xi_k$): $\\xi_1 = -\\sqrt{\\frac{3}{5}}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{\\frac{3}{5}}$\nWeights ($w_k$): $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$\n\nSince the integrand $f(x,y) = x^3 y^5$ is separable, the double summation can also be separated:\n$$\nI_{GQ} = \\left( \\sum_{i=1}^{3} w_i x_i^3 \\right) \\left( \\sum_{j=1}^{3} w_j y_j^5 \\right)\n$$\nLet's compute the first summation:\n\\begin{align*} \\label{eq:1}\n\\sum_{i=1}^{3} w_i x_i^3 &= w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^3 + \\left(\\frac{8}{9}\\right) (0)^3 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^3 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\frac{3}{5}\\sqrt{\\frac{3}{5}}\\right) + 0 + \\left(\\frac{5}{9}\\right) \\left(\\frac{3}{5}\\sqrt{\\frac{3}{5}}\\right) \\\\\n&= -\\frac{3}{9}\\sqrt{\\frac{3}{5}} + \\frac{3}{9}\\sqrt{\\frac{3}{5}} \\\\\n&= 0\n\\end{align*}\nNow, we compute the second summation:\n\\begin{align*} \\label{eq:2}\n\\sum_{j=1}^{3} w_j y_j^5 &= w_1 y_1^5 + w_2 y_2^5 + w_3 y_3^5 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^5 + \\left(\\frac{8}{9}\\right) (0)^5 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^5 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\left(\\frac{3}{5}\\right)^2\\sqrt{\\frac{3}{5}}\\right) + 0 + \\left(\\frac{5}{9}\\right) \\left(\\left(\\frac{3}{5}\\right)^2\\sqrt{\\frac{3}{5}}\\right) \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\frac{9}{25}\\sqrt{\\frac{3}{5}}\\right) + \\left(\\frac{5}{9}\\right) \\left(\\frac{9}{25}\\sqrt{\\frac{3}{5}}\\right) \\\\\n&= -\\frac{5}{25}\\sqrt{\\frac{3}{5}} + \\frac{5}{25}\\sqrt{\\frac{3}{5}} \\\\\n&= 0\n\\end{align*}\nThe value of the integral approximated by Gauss quadrature is therefore:\n$$\nI_{GQ} = 0 \\times 0 = 0\n$$\n\nFinally, we compare the two results. The analytical value is $I = 0$ and the value obtained via $3$-point Gauss-Legendre quadrature is $I_{GQ} = 0$. The values are identical.\n\nThis demonstrates that the quadrature rule is exact for this specific integrand. This is consistent with the theory of Gauss-Legendre quadrature. An $n$-point rule is exact for all polynomials of degree up to $2n-1$. For this problem, $n=3$, so the rule is exact for polynomials of degree up to $2(3)-1=5$. The tensor-product rule is exact for any polynomial $f(x,y)$ that is a linear combination of terms $x^i y^j$ where $i \\le 2n-1$ and $j \\le 2n-1$. Our integrand is $f(x,y)=x^3y^5$. The degree in $x$ is $3$, and the degree in $y$ is $5$. Since $3 \\le 5$ and $5 \\le 5$, the $3$-point rule is exact for both the $x$ and $y$ components of the integral, and thus the tensor-product rule is exact for the full integral.\n\nThe computed value for the integral is $0$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "While quadrilateral elements are common, triangular elements offer greater flexibility for meshing complex geometries. Unlike on squares, quadrature rules for triangles are not constructed by a simple tensor product, requiring specialized sets of points and weights. This practice  guides you through the application of a standard symmetric quadrature rule for a reference triangle, demonstrating how to handle the non-trivial integration schemes that are essential for working with triangular finite elements.",
            "id": "3527327",
            "problem": "In computational geomechanics, assembling element stiffness and mass matrices requires accurate evaluation of polynomial integrals over reference domains. Consider the standard reference triangle $T = \\{(x,y) \\in \\mathbb{R}^2 : x \\ge 0,\\ y \\ge 0,\\ x + y \\le 1\\}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Using the principles of Gaussian quadrature in two dimensions, evaluate the integral of the quadratic polynomial $x^2 + x y + y^2$ over $T$ by:\n- computing the analytical value via direct integration, and\n- computing the numerical value using a symmetric $7$-point triangular Gaussian quadrature rule that is exact for all polynomials up to total degree $5$.\n\nThe $7$-point rule is defined by the following nodes and weights, given in barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3)$ relative to the vertices $(0,0)$, $(1,0)$, and $(0,1)$, with the mapping $(x,y) = (\\lambda_2,\\lambda_3)$. The weights below are scaled to the area of $T$.\n- One centroid point: $(\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3}\\right)$ with weight $w_1 = 0.1125$.\n- Three points with $\\alpha_1 = 0.101286507323456$ and $\\beta_1 = 1 - 2 \\alpha_1 = 0.797426985353088$, each with weight $w_2 = 0.062969590272413$, namely\n  $(\\alpha_1,\\alpha_1,\\beta_1)$, $(\\alpha_1,\\beta_1,\\alpha_1)$, $(\\beta_1,\\alpha_1,\\alpha_1)$.\n- Three points with $\\alpha_2 = 0.470142064105115$ and $\\beta_2 = 1 - 2 \\alpha_2 = 0.059715871789770$, each with weight $w_3 = 0.066197076394253$, namely\n  $(\\alpha_2,\\alpha_2,\\beta_2)$, $(\\alpha_2,\\beta_2,\\alpha_2)$, $(\\beta_2,\\alpha_2,\\alpha_2)$.\n\nCompute both the analytic and quadrature values and compare them to confirm exactness for the given integrand. Express the final answer as a single exact fraction for the integral over $T$. No rounding is required.",
            "solution": "The user has provided a problem from the field of computational geomechanics that requires the evaluation of a two-dimensional integral over a standard reference triangle. The evaluation is to be performed by two methods: direct analytical integration and numerical integration using a specified $7$-point Gaussian quadrature rule. The validity of the problem has been confirmed, as it is scientifically grounded, well-posed, and all necessary data are provided. We will proceed with the solution.\n\nThe integral to be evaluated is:\n$$I = \\int_T (x^2 + xy + y^2) \\, dA$$\nwhere $T$ is the reference triangle defined by the vertices $(0,0)$, $(1,0)$, and $(0,1)$. The domain $T$ can be described by the inequalities $x \\ge 0$, $y \\ge 0$, and $x+y \\le 1$.\n\n**Part 1: Analytical Evaluation**\n\nWe compute the integral directly using iterated integration. The limits of integration are from $x=0$ to $x=1$, and for each $x$, from $y=0$ to $y=1-x$.\n\n$$I = \\int_{0}^{1} \\int_{0}^{1-x} (x^2 + xy + y^2) \\, dy \\, dx$$\n\nFirst, we integrate with respect to $y$:\n\\begin{align*} \\int_{0}^{1-x} (x^2 + xy + y^2) \\, dy &= \\left[ x^2y + \\frac{1}{2}xy^2 + \\frac{1}{3}y^3 \\right]_{y=0}^{y=1-x} \\\\ &= x^2(1-x) + \\frac{1}{2}x(1-x)^2 + \\frac{1}{3}(1-x)^3 \\\\ &= (x^2 - x^3) + \\frac{1}{2}x(1 - 2x + x^2) + \\frac{1}{3}(1 - 3x + 3x^2 - x^3) \\\\ &= x^2 - x^3 + \\frac{1}{2}x - x^2 + \\frac{1}{2}x^3 + \\frac{1}{3} - x + x^2 - \\frac{1}{3}x^3 \\\\ &= -\\frac{5}{6}x^3 + x^2 - \\frac{1}{2}x + \\frac{1}{3}\\end{align*}\nNext, we integrate this resulting polynomial with respect to $x$ from $0$ to $1$:\n\\begin{align*} I &= \\int_{0}^{1} \\left( -\\frac{5}{6}x^3 + x^2 - \\frac{1}{2}x + \\frac{1}{3} \\right) \\, dx \\\\ &= \\left[ -\\frac{5}{6}\\frac{x^4}{4} + \\frac{x^3}{3} - \\frac{1}{2}\\frac{x^2}{2} + \\frac{1}{3}x \\right]_{0}^{1} \\\\ &= -\\frac{5}{24} + \\frac{1}{3} - \\frac{1}{4} + \\frac{1}{3} \\\\ &= -\\frac{5}{24} + \\frac{2}{3} - \\frac{1}{4} \\end{align*}\nTo sum these fractions, we find a common denominator, which is $24$:\n$$I = \\frac{-5}{24} + \\frac{2 \\times 8}{24} - \\frac{1 \\times 6}{24} = \\frac{-5 + 16 - 6}{24} = \\frac{5}{24}$$\nThe analytical value of the integral is $\\frac{5}{24}$.\n\n**Part 2: Numerical Evaluation via Gaussian Quadrature**\n\nThe problem states that the $7$-point quadrature rule is exact for all polynomials up to total degree $5$. Since the integrand $f(x,y) = x^2 + xy + y^2$ is a polynomial of total degree $2$, we expect the numerical result to be identical to the analytical one. The problem, however, requires us to *compute* this value. The quadrature formula is given by:\n$$I_Q = \\sum_{i=1}^{7} W_i f(x_i, y_i)$$\nwhere $(x_i, y_i)$ are the coordinates of the quadrature points and $W_i$ are the corresponding weights. The problem gives the points in barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ and provides the mapping to Cartesian coordinates as $(x,y) = (\\lambda_2, \\lambda_3)$. The provided weights are scaled by the area of the triangle, $A = \\frac{1}{2}$.\n\nThe problem gives the point coordinates and weights as floating-point numbers, but requires an exact fractional answer. This indicates that these numerical values represent exact algebraic numbers. By consulting standard literature on numerical integration (e.g., Dunavant's rules), we can identify the exact values:\n- Let $a = \\sqrt{15}$.\n- First group of points: $\\alpha_1 = \\frac{6-a}{21}$. Corresponding weight: $w_2 = \\frac{155-a}{2400}$.\n- Second group of points: $\\alpha_2 = \\frac{6+a}{21}$. Corresponding weight: $w_3 = \\frac{155+a}{2400}$.\n- Centroid weight: $w_1 = 0.1125 = \\frac{9}{80}$.\n\nThe $7$ quadrature points and their respective weights are:\n1. Centroid point $P_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$. Cartesian $(x_1,y_1) = (\\frac{1}{3},\\frac{1}{3})$. Weight $W_1 = w_1 = \\frac{9}{80}$.\n2. A group of $3$ points defined by permutations of $(\\beta_1, \\alpha_1, \\alpha_1)$ where $\\beta_1 = 1-2\\alpha_1$. Each has weight $W_{2,3,4} = w_2$.\n   - $P_2$: $(\\beta_1, \\alpha_1, \\alpha_1) \\implies (x_2,y_2) = (\\alpha_1, \\alpha_1)$\n   - $P_3$: $(\\alpha_1, \\beta_1, \\alpha_1) \\implies (x_3,y_3) = (\\beta_1, \\alpha_1)$\n   - $P_4$: $(\\alpha_1, \\alpha_1, \\beta_1) \\implies (x_4,y_4) = (\\alpha_1, \\beta_1)$\n3. A group of $3$ points defined by permutations of $(\\beta_2, \\alpha_2, \\alpha_2)$ where $\\beta_2 = 1-2\\alpha_2$. Each has weight $W_{5,6,7} = w_3$.\n   - $P_5$: $(\\beta_2, \\alpha_2, \\alpha_2) \\implies (x_5,y_5) = (\\alpha_2, \\alpha_2)$\n   - $P_6$: $(\\alpha_2, \\beta_2, \\alpha_2) \\implies (x_6,y_6) = (\\beta_2, \\alpha_2)$\n   - $P_7$: $(\\alpha_2, \\alpha_2, \\beta_2) \\implies (x_7,y_7) = (\\alpha_2, \\beta_2)$\n\nWe now evaluate the integrand $f(x,y)=x^2+xy+y^2$ at each point.\n- Contribution from the centroid ($P_1$):\n  $f(x_1, y_1) = f(\\frac{1}{3}, \\frac{1}{3}) = (\\frac{1}{3})^2 + (\\frac{1}{3})(\\frac{1}{3}) + (\\frac{1}{3})^2 = \\frac{1}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{3}{9} = \\frac{1}{3}$.\n  Contribution: $W_1 f(x_1,y_1) = \\frac{9}{80} \\times \\frac{1}{3} = \\frac{3}{80}$.\n\n- Contribution from the first group of points ($P_2, P_3, P_4$):\n  The total contribution is $w_2 [f(\\alpha_1,\\alpha_1) + f(\\beta_1,\\alpha_1) + f(\\alpha_1,\\beta_1)]$.\n  $f(\\alpha_1,\\alpha_1) = \\alpha_1^2 + \\alpha_1^2 + \\alpha_1^2 = 3\\alpha_1^2$.\n  $f(\\beta_1,\\alpha_1) = \\beta_1^2 + \\beta_1\\alpha_1 + \\alpha_1^2$. Since $f(x,y)=f(y,x)$, $f(\\alpha_1,\\beta_1) = f(\\beta_1,\\alpha_1)$.\n  Sum of function values for this group: $S_f^{(1)} = 3\\alpha_1^2 + 2(\\beta_1^2 + \\beta_1\\alpha_1 + \\alpha_1^2)$.\n  Substitute $\\beta_1 = 1-2\\alpha_1$:\n  $\\beta_1^2 + \\beta_1\\alpha_1 + \\alpha_1^2 = (1-2\\alpha_1)^2 + (1-2\\alpha_1)\\alpha_1 + \\alpha_1^2 = (1-4\\alpha_1+4\\alpha_1^2) + (\\alpha_1-2\\alpha_1^2) + \\alpha_1^2 = 3\\alpha_1^2 - 3\\alpha_1 + 1$.\n  $S_f^{(1)} = 3\\alpha_1^2 + 2(3\\alpha_1^2 - 3\\alpha_1 + 1) = 9\\alpha_1^2 - 6\\alpha_1 + 2$.\n  Let's evaluate this with $\\alpha_1 = \\frac{6-\\sqrt{15}}{21}$:\n  $21\\alpha_1 = 6-\\sqrt{15} \\implies 441\\alpha_1^2 = 36-12\\sqrt{15}+15 = 51-12\\sqrt{15}$.\n  $S_f^{(1)} = 9\\left(\\frac{51-12\\sqrt{15}}{441}\\right) - 6\\left(\\frac{6-\\sqrt{15}}{21}\\right) + 2 = \\frac{51-12\\sqrt{15}}{49} - \\frac{2(6-\\sqrt{15})}{7} + 2$\n  $= \\frac{51-12\\sqrt{15} - 14(6-\\sqrt{15}) + 98}{49} = \\frac{51-12\\sqrt{15} - 84+14\\sqrt{15} + 98}{49} = \\frac{65+2\\sqrt{15}}{49}$.\n  Contribution: $w_2 S_f^{(1)} = \\frac{155-\\sqrt{15}}{2400} \\times \\frac{65+2\\sqrt{15}}{49}$.\n  Numerator: $(155-\\sqrt{15})(65+2\\sqrt{15}) = 10075 + 310\\sqrt{15} - 65\\sqrt{15} - 2(15) = 10045 + 245\\sqrt{15}$.\n  Note that $10045 = 205 \\times 49$ and $245 = 5 \\times 49$.\n  Numerator = $49(205 + 5\\sqrt{15})$.\n  Contribution is $\\frac{49(205+5\\sqrt{15})}{2400 \\times 49} = \\frac{205+5\\sqrt{15}}{2400}$.\n\n- Contribution from the second group of points ($P_5, P_6, P_7$):\n  The calculation is identical, with $\\alpha_1$ replaced by $\\alpha_2$ and $w_2$ by $w_3$.\n  Sum of function values is $S_f^{(2)} = 9\\alpha_2^2 - 6\\alpha_2 + 2$. Since $\\alpha_2$ is the conjugate of $\\alpha_1$ (with respect to $\\sqrt{15}$), $S_f^{(2)} = \\frac{65-2\\sqrt{15}}{49}$.\n  Contribution: $w_3 S_f^{(2)} = \\frac{155+\\sqrt{15}}{2400} \\times \\frac{65-2\\sqrt{15}}{49}$.\n  Numerator: $(155+\\sqrt{15})(65-2\\sqrt{15}) = 10045 - 245\\sqrt{15} = 49(205-5\\sqrt{15})$.\n  Contribution is $\\frac{49(205-5\\sqrt{15})}{2400 \\times 49} = \\frac{205-5\\sqrt{15}}{2400}$.\n\n- Total numerical integral $I_Q$:\n  $I_Q = \\frac{3}{80} + \\frac{205+5\\sqrt{15}}{2400} + \\frac{205-5\\sqrt{15}}{2400}$\n  $I_Q = \\frac{3}{80} + \\frac{205+5\\sqrt{15} + 205-5\\sqrt{15}}{2400}$\n  $I_Q = \\frac{3}{80} + \\frac{410}{2400} = \\frac{3}{80} + \\frac{41}{240}$.\n  The common denominator is $240$.\n  $I_Q = \\frac{3 \\times 3}{240} + \\frac{41}{240} = \\frac{9+41}{240} = \\frac{50}{240} = \\frac{5}{24}$.\n\nThe numerical value is $\\frac{5}{24}$, which is identical to the analytical value. This confirms the exactness property of the specified quadrature rule for the given quadratic polynomial.",
            "answer": "$$\\boxed{\\frac{5}{24}}$$"
        },
        {
            "introduction": "Standard Gaussian quadrature is designed to integrate smooth, polynomial-like functions with maximum efficiency. However, many problems in geomechanics, such as fracture analysis, involve singular fields that violate this assumption. This advanced practice  explores such a scenario, where a standard quadrature rule fails to accurately compute an integral with a crack-tip singularity of the form $r^{-1/2}$. You will then implement the Duffy transform, a powerful coordinate-mapping technique that regularizes the integrand, demonstrating how specialized methods are essential for obtaining accurate solutions in the presence of physical singularities.",
            "id": "3527274",
            "problem": "Consider the planar crack-tip integral in computational geomechanics where a stress-like quantity behaves as $r^{-1/2}$ near the crack tip located at the origin, with $r = \\sqrt{x^2 + y^2}$. Let $T$ be a triangle in $\\mathbb{R}^2$ whose vertex at the crack tip is at $\\boldsymbol{v}_1 = (0,0)$ and whose other vertices are $\\boldsymbol{v}_2 \\in \\mathbb{R}^2$ and $\\boldsymbol{v}_3 \\in \\mathbb{R}^2$. The target integral is\n$$\nI(T) = \\int_T r^{-1/2}\\, \\mathrm{d}x\\,\\mathrm{d}y.\n$$\nStarting from the change-of-variables theorem for integration and the definition of Gauss-Legendre quadrature, implement the Duffy transform for triangles and use it to approximate $I(T)$ with a tensor-product Gauss-Legendre rule of nominal degree $p$ along each parametric direction. For the same nominal degree $p$, implement a standard symmetric triangle cubature rule of degree $p$ on the reference triangle and map it affinely to the physical triangle $T$.\n\nYour derivation and implementation must begin from the following base:\n- Change-of-variables for integrals: For a smooth bijective mapping $\\boldsymbol{\\phi}: \\Omega \\subset \\mathbb{R}^n \\to \\mathbb{R}^n$, one has\n$$\n\\int_{\\boldsymbol{\\phi}(\\Omega)} f(\\boldsymbol{x})\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\Omega} f(\\boldsymbol{\\phi}(\\boldsymbol{u}))\\, \\left|\\det D\\boldsymbol{\\phi}(\\boldsymbol{u})\\right|\\, \\mathrm{d}\\boldsymbol{u}.\n$$\n- Gauss-Legendre quadrature: For $n$ points, the Gauss-Legendre rule on $[-1,1]$ is exact for polynomials up to degree $2n-1$ and maps to $[0,1]$ by the affine change of variables.\n- The Duffy transform for a triangle with the crack tip at the origin: Let $(\\xi,\\eta)$ be coordinates on the reference right triangle with vertices $(0,0)$, $(1,0)$, $(0,1)$. The Duffy mapping $(u,v) \\mapsto (\\xi,\\eta)$ defined by $(\\xi,\\eta)=(u,uv)$ for $u \\in [0,1]$ and $v \\in [0,1]$ has Jacobian determinant $J_{D}(u,v) = u$. Composing this with the affine map from the reference triangle to the physical triangle $T$ given by $\\boldsymbol{x}(\\xi,\\eta) = \\boldsymbol{v}_1 + \\xi\\,\\boldsymbol{v}_2 + \\eta\\,\\boldsymbol{v}_3$ yields a total Jacobian $\\left|\\det D\\boldsymbol{\\phi}(u,v)\\right| = \\left|\\det\\left[\\boldsymbol{v}_2\\,\\,\\boldsymbol{v}_3\\right]\\right|\\, u$.\n\nUnder these mappings, the transformed integrand for $f(\\boldsymbol{x}) = r^{-1/2}$ becomes separable in $u$ and $v$, and the integral can be evaluated by a tensor-product Gauss-Legendre rule of nominal degree $p$ in $u$ and $v$. To assess accuracy, compute a reference value $I_{\\mathrm{ref}}(T)$ by evaluating the separated $u$-integral analytically and the resulting one-dimensional $v$-integral using a high-order Gauss-Legendre rule on $[0,1]$.\n\nFor the symmetric triangle cubature of degree $p$ on the reference triangle with vertices $(0,0)$, $(1,0)$, $(0,1)$, use the classical degree-$p$ positive rule with $p = 2$:\n- Three points at barycentric coordinates $(\\tfrac{2}{3},\\tfrac{1}{6},\\tfrac{1}{6})$, $(\\tfrac{1}{6},\\tfrac{2}{3},\\tfrac{1}{6})$, $(\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3})$,\n- Equal weights $w = \\tfrac{1}{6}$ on the reference triangle (weights summing to its area $A_{\\mathrm{ref}}=\\tfrac{1}{2}$).\nMap these points affinely to $T$ and scale the weights by the absolute Jacobian determinant $\\left|\\det\\left[\\boldsymbol{v}_2\\,\\,\\boldsymbol{v}_3\\right]\\right|$.\n\nImplement the following tasks in a single program:\n1. Derive and implement the Duffy-based quadrature for $I(T)$ using Gauss-Legendre quadrature of nominal degree $p$ with $p=2$ in both parametric directions on $[0,1]$.\n2. Implement the symmetric triangle cubature of degree $p=2$ as described and evaluate $I(T)$.\n3. Compute the high-accuracy reference $I_{\\mathrm{ref}}(T)$ by evaluating the $u$-integral analytically and the $v$-integral using a Gauss-Legendre rule on $[0,1]$ with $n_{\\mathrm{ref}} = 200$ points.\n4. For each test case below, output the absolute errors of the Duffy-based quadrature and the symmetric triangle cubature with respect to $I_{\\mathrm{ref}}(T)$.\n\nTest suite (each case defines a triangle $T$ by its non-origin vertices $\\boldsymbol{v}_2=(x_2,y_2)$ and $\\boldsymbol{v}_3=(x_3,y_3)$ and sets $p=2$):\n- Case $1$: $\\boldsymbol{v}_2=(1,0)$, $\\boldsymbol{v}_3=(0,1)$.\n- Case $2$: $\\boldsymbol{v}_2=(0.1,0)$, $\\boldsymbol{v}_3=(0,0.1)$.\n- Case $3$: $\\boldsymbol{v}_2=(0.01,0)$, $\\boldsymbol{v}_3=(0,0.01)$.\n- Case $4$: $\\boldsymbol{v}_2=(0.1,0)$, $\\boldsymbol{v}_3=(0,0.2)$.\n- Case $5$: $\\boldsymbol{v}_2=(0.1,0)$, $\\boldsymbol{v}_3=(0.05,0.1)$.\n\nAll quantities are dimensionless; no physical units are required. Angles do not appear in this problem. For each test case, compute a pair of absolute errors:\n$$\n\\left[\\, \\left|I_{\\mathrm{Duffy}}(T) - I_{\\mathrm{ref}}(T)\\right| \\,,\\, \\left|I_{\\mathrm{tri}}(T) - I_{\\mathrm{ref}}(T)\\right| \\,\\right].\n$$\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of these pairs, enclosed in square brackets, with each numeric entry printed as a floating-point number; for example, \n$$\n\\left[\\,[e_{11},e_{12}],[e_{21},e_{22}],\\ldots\\right].\n$$",
            "solution": "The problem requires the evaluation of a singular integral $I(T) = \\int_T r^{-1/2}\\, \\mathrm{d}x\\,\\mathrm{d}y$ over a triangle $T$ with one vertex at the origin, where the singularity $r^{-1/2}$ is located. We are to compare the accuracy of two numerical methods: a standard symmetric cubature rule and a specialized method using the Duffy transform. A high-accuracy reference value will be computed for comparison. All methods will be implemented for a nominal degree of $p=2$.\n\nFirst, we establish the mathematical framework for each method.\n\n### 1. Duffy Transform Quadrature\n\nThe Duffy transform is a coordinate change designed to regularize singularities at the vertex of a triangle. The transformation is a composition of two maps. First, the Duffy map $\\boldsymbol{\\psi}_D: [0,1]^2 \\to \\hat{T}$ maps the unit square in $(u,v)$ coordinates to the reference right triangle $\\hat{T}$ with vertices $(0,0)$, $(1,0)$, and $(0,1)$ in $(\\xi,\\eta)$ coordinates. This map is given by $(\\xi, \\eta) = (u, uv)$. Its Jacobian determinant is $J_D(u,v) = u$.\n\nSecond, an affine map $\\boldsymbol{\\psi}_A: \\hat{T} \\to T$ maps the reference triangle $\\hat{T}$ to the physical triangle $T$. Since the vertex at the singularity is $\\boldsymbol{v}_1=(0,0)$, this map is $\\boldsymbol{x}(\\xi,\\eta) = \\xi \\boldsymbol{v}_2 + \\eta \\boldsymbol{v}_3$. The Jacobian of this map is the matrix $D\\boldsymbol{\\psi}_A = [\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]$, and its determinant is $\\det(D\\boldsymbol{\\psi}_A) = \\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]$.\n\nThe composite map is $\\boldsymbol{\\phi}(u,v) = \\boldsymbol{\\psi}_A(\\boldsymbol{\\psi}_D(u,v)) = u\\boldsymbol{v}_2 + uv\\boldsymbol{v}_3 = u(\\boldsymbol{v}_2 + v\\boldsymbol{v}_3)$. The absolute value of the total Jacobian determinant, by the chain rule, is $|\\det D\\boldsymbol{\\phi}(u,v)| = |\\det(D\\boldsymbol{\\psi}_A)| |J_D(u,v)| = |\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\, u$, since $u \\in [0,1]$.\n\nThe integrand $f(\\boldsymbol{x}) = r^{-1/2}$ is transformed as follows. The squared distance from the origin is $r^2 = \\boldsymbol{x} \\cdot \\boldsymbol{x}$.\n$$\nr^2(u,v) = \\left(u(\\boldsymbol{v}_2 + v\\boldsymbol{v}_3)\\right) \\cdot \\left(u(\\boldsymbol{v}_2 + v\\boldsymbol{v}_3)\\right) = u^2 \\left( \\|\\boldsymbol{v}_2\\|^2 + 2v(\\boldsymbol{v}_2 \\cdot \\boldsymbol{v}_3) + v^2\\|\\boldsymbol{v}_3\\|^2 \\right)\n$$\nThe transformed integrand is therefore:\n$$\nf(\\boldsymbol{\\phi}(u,v)) = r^{-1/2} = \\left(r^2\\right)^{-1/4} = u^{-1/2} \\left( \\|\\boldsymbol{v}_2\\|^2 + 2v(\\boldsymbol{v}_2 \\cdot \\boldsymbol{v}_3) + v^2\\|\\boldsymbol{v}_3\\|^2 \\right)^{-1/4}\n$$\nThe integral over $T$ becomes an integral over the unit square $[0,1]^2$:\n$$\nI(T) = \\int_0^1 \\int_0^1 f(\\boldsymbol{\\phi}(u,v)) |\\det D\\boldsymbol{\\phi}(u,v)| \\, \\mathrm{d}u \\, \\mathrm{d}v\n$$\n$$\nI(T) = \\int_0^1 \\int_0^1 \\left[ u^{-1/2} g(v) \\right] \\left[ |\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\, u \\right] \\, \\mathrm{d}u \\, \\mathrm{d}v\n$$\nwhere $g(v) = \\left( \\|\\boldsymbol{v}_2\\|^2 + 2v(\\boldsymbol{v}_2 \\cdot \\boldsymbol{v}_3) + v^2\\|\\boldsymbol{v}_3\\|^2 \\right)^{-1/4}$.\nThe key benefit of the Duffy transform is evident here: the Jacobian term $u$ combines with the singular term $u^{-1/2}$ from the integrand, yielding a regular term $u^{1/2}$. The integral is now separable and free of singularities:\n$$\nI(T) = |\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\left( \\int_0^1 u^{1/2} \\, \\mathrm{d}u \\right) \\left( \\int_0^1 g(v) \\, \\mathrm{d}v \\right)\n$$\nTo compute $I_{\\mathrm{Duffy}}(T)$, we approximate this integral using a tensor-product Gauss-Legendre rule of nominal degree $p=2$. This requires a rule exact for polynomials up to degree $2$. The $n$-point Gauss-Legendre rule is exact for polynomials of degree $2n-1$. For $2n-1 \\ge 2$, we choose $n=2$. Let $\\{z_i, w_i\\}_{i=1}^2$ be the 2-point Gauss-Legendre points and weights mapped to the interval $[0,1]$. The approximation is:\n$$\nI_{\\mathrm{Duffy}}(T) \\approx \\sum_{i=1}^2 \\sum_{j=1}^2 w_i w_j \\left( |\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\, z_i^{1/2} \\, g(z_j) \\right)\n$$\n\n### 2. Standard Symmetric Triangle Cubature\n\nThis method uses a standard affine map from the reference triangle $\\hat{T}$ (vertices at $(0,0)$, $(1,0)$, $(0,1)$) to the physical triangle $T$. The map is $\\boldsymbol{x}(\\xi,\\eta) = \\xi \\boldsymbol{v}_2 + \\eta \\boldsymbol{v}_3$, with Jacobian determinant $\\det D\\boldsymbol{x} = \\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]$. The integral transforms as:\n$$\nI(T) = \\int_{\\hat{T}} f(\\boldsymbol{x}(\\xi,\\eta)) |\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nThe integral over $\\hat{T}$ is approximated using the specified symmetric cubature rule of degree $p=2$. The rule's points are given in barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ on $\\hat{T}$. For reference vertices $\\boldsymbol{c}_1=(0,0), \\boldsymbol{c}_2=(1,0), \\boldsymbol{c}_3=(0,1)$, a point with barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ has Cartesian coordinates $(\\xi, \\eta) = (\\lambda_2, \\lambda_3)$. The points are:\n\\begin{itemize}\n    \\item $\\boldsymbol{p}_1$: $(\\tfrac{2}{3}, \\tfrac{1}{6}, \\tfrac{1}{6}) \\implies (\\xi_1, \\eta_1) = (\\tfrac{1}{6}, \\tfrac{1}{6})$\n    \\item $\\boldsymbol{p}_2$: $(\\tfrac{1}{6}, \\tfrac{2}{3}, \\tfrac{1}{6}) \\implies (\\xi_2, \\eta_2) = (\\tfrac{2}{3}, \\tfrac{1}{6})$\n    \\item $\\boldsymbol{p}_3$: $(\\tfrac{1}{6}, \\tfrac{1}{6}, \\tfrac{2}{3}) \\implies (\\xi_3, \\eta_3) = (\\tfrac{1}{6}, \\tfrac{2}{3})$\n\\end{itemize}\nThe corresponding weights are $\\hat{w}_k = \\tfrac{1}{6}$ for $k=1,2,3$. The sum of weights is $3 \\times \\frac{1}{6} = \\frac{1}{2}$, the area of $\\hat{T}$. The cubature approximation is:\n$$\nI_{\\mathrm{tri}}(T) \\approx |\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\sum_{k=1}^3 \\hat{w}_k f(\\boldsymbol{x}(\\xi_k, \\eta_k))\n$$\nwhere $\\boldsymbol{x}_k = \\xi_k \\boldsymbol{v}_2 + \\eta_k \\boldsymbol{v}_3$. Because the integrand $f(\\boldsymbol{x})=r^{-1/2}$ is singular at a vertex and not a polynomial, this standard rule is expected to have low accuracy.\n\n### 3. High-Accuracy Reference Integral\n\nThe reference value $I_{\\mathrm{ref}}(T)$ is computed by building upon the separable form of the Duffy-transformed integral. The integral with respect to $u$ can be solved analytically:\n$$\n\\int_0^1 u^{1/2} \\, \\mathrm{d}u = \\left[\\frac{2}{3}u^{3/2}\\right]_0^1 = \\frac{2}{3}\n$$\nThis leaves a one-dimensional integral in $v$:\n$$\nI(T) = \\frac{2}{3}|\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\int_0^1 g(v) \\, \\mathrm{d}v\n$$\nwhere $g(v)$ is the smooth function defined previously. To compute $I_{\\mathrm{ref}}(T)$, we approximate the remaining integral $\\int_0^1 g(v) \\, \\mathrm{d}v$ with a high-order Gauss-Legendre rule using $n_{\\mathrm{ref}}=200$ points and weights $\\{z_j^{\\mathrm{ref}}, w_j^{\\mathrm{ref}}\\}_{j=1}^{200}$ on $[0,1]$.\n$$\nI_{\\mathrm{ref}}(T) = \\frac{2}{3}|\\det[\\boldsymbol{v}_2 \\,\\,\\boldsymbol{v}_3]| \\sum_{j=1}^{200} w_j^{\\mathrm{ref}} g(z_j^{\\mathrm{ref}})\n$$\nThis value serves as a highly accurate benchmark against which we measure the absolute errors of $I_{\\mathrm{Duffy}}(T)$ and $I_{\\mathrm{tri}}(T)$.\n\nThe final step is to compute the absolute errors $|I_{\\mathrm{Duffy}}(T) - I_{\\mathrm{ref}}(T)|$ and $|I_{\\mathrm{tri}}(T) - I_{\\mathrm{ref}}(T)|$ for each given test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the crack-tip integral problem by comparing Duffy transform quadrature\n    and standard triangle cubature against a high-accuracy reference solution.\n    \"\"\"\n\n    test_cases = [\n        ((1.0, 0.0), (0.0, 1.0)),    # Case 1\n        ((0.1, 0.0), (0.0, 0.1)),    # Case 2\n        ((0.01, 0.0), (0.0, 0.01)),   # Case 3\n        ((0.1, 0.0), (0.0, 0.2)),    # Case 4\n        ((0.1, 0.0), (0.05, 0.1))    # Case 5\n    ]\n\n    p_nominal = 2\n    # For a Gauss-Legendre rule of nominal degree p, we need 2n-1 >= p.\n    # For p=2, 2n-1 >= 2 => n=2 points are sufficient.\n    n_points_duffy = 2\n    n_points_ref = 200\n\n    def get_gl_rule_01(n_points):\n        \"\"\"Returns Gauss-Legendre points and weights for the interval [0, 1].\"\"\"\n        points_neg1_1, weights_neg1_1 = np.polynomial.legendre.leggauss(n_points)\n        points_0_1 = 0.5 * (points_neg1_1 + 1.0)\n        weights_0_1 = 0.5 * weights_neg1_1\n        return points_0_1, weights_0_1\n\n    # Gauss-Legendre rules\n    gl_points_duffy, gl_weights_duffy = get_gl_rule_01(n_points_duffy)\n    gl_points_ref, gl_weights_ref = get_gl_rule_01(n_points_ref)\n\n    # Standard symmetric triangle cubature rule (degree p=2) on reference triangle\n    # Points are given in barycentric coords; converted to Cartesian (xi, eta)\n    # for ref triangle with vertices (0,0), (1,0), (0,1).\n    # (lambda_1, lambda_2, lambda_3) -> (xi, eta) = (lambda_2, lambda_3)\n    tri_points_ref = np.array([\n        [1.0/6.0, 1.0/6.0],\n        [2.0/3.0, 1.0/6.0],\n        [1.0/6.0, 2.0/3.0]\n    ])\n    tri_weights_ref = np.array([1.0/6.0, 1.0/6.0, 1.0/6.0])\n\n    all_errors = []\n\n    for v2_coords, v3_coords in test_cases:\n        v2 = np.array(v2_coords)\n        v3 = np.array(v3_coords)\n\n        # --- Common Calculations ---\n        abs_det_J = np.abs(np.linalg.det([v2, v3]))\n        v2_dot_v2 = np.dot(v2, v2)\n        v3_dot_v3 = np.dot(v3, v3)\n        v2_dot_v3 = np.dot(v2, v3)\n\n        def g_v(v):\n            \"\"\"The v-dependent part of the Duffy-transformed integrand.\"\"\"\n            return (v2_dot_v2 + 2 * v * v2_dot_v3 + v**2 * v3_dot_v3)**(-0.25)\n        \n        # --- 1. High-Accuracy Reference Integral (I_ref) ---\n        # The u-integral is analytically 2/3.\n        # We use a high-order GL rule for the v-integral.\n        g_vals_ref = g_v(gl_points_ref)\n        integral_g_ref = np.sum(gl_weights_ref * g_vals_ref)\n        I_ref = (2.0/3.0) * abs_det_J * integral_g_ref\n\n        # --- 2. Duffy Transform Quadrature (I_Duffy) ---\n        # Tensor-product GL rule on [0,1]x[0,1] for the separable integral.\n        u_vals, v_vals = gl_points_duffy, gl_points_duffy\n        wu_vals, wv_vals = gl_weights_duffy, gl_weights_duffy\n        \n        # Integrand: abs_det_J * u^(1/2) * g(v)\n        # Using separability: (Integral of u part) * (Integral of v part)\n        integral_u_duffy = np.sum(wu_vals * u_vals**0.5)\n        integral_g_duffy = np.sum(wv_vals * g_v(v_vals))\n        \n        I_duffy = abs_det_J * integral_u_duffy * integral_g_duffy\n\n        # --- 3. Symmetric Triangle Cubature (I_tri) ---\n        # Map cubature points from reference to physical triangle\n        # x_k = xi_k * v2 + eta_k * v3\n        phys_points = tri_points_ref @ np.vstack([v2, v3])\n        \n        # Evaluate integrand f(x) = r^(-1/2) = (x . x)^(-1/4) at these points\n        r_sq = np.sum(phys_points**2, axis=1)\n        f_vals = r_sq**(-0.25)\n        \n        # I_tri = abs_det_J * sum(w_k * f(x_k))\n        I_tri = abs_det_J * np.sum(tri_weights_ref * f_vals)\n\n        # --- Calculate and store errors ---\n        error_duffy = np.abs(I_duffy - I_ref)\n        error_tri = np.abs(I_tri - I_ref)\n        all_errors.append([error_duffy, error_tri])\n\n    # --- Final Output ---\n    # Convert the list of lists into the required string format\n    result_str = \",\".join([f\"[{e1},{e2}]\" for e1, e2 in all_errors])\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```"
        }
    ]
}