{
    "hands_on_practices": [
        {
            "introduction": "构建能够准确模拟板弯曲行为的有限元是一项核心挑战，特别是对于基于Kirchhoff-Love理论的薄板单元。这些单元要求跨单元边界的转角（即斜率）必须是连续的，这被称为$C^1$连续性。本练习将引导你从熟悉的一维欧拉-伯努利梁单元出发，通过构建其三次Hermite形函数，来理解和推导保证$C^1$连续性所必需的节点自由度，进而通过张量积的方式将此概念推广到二维矩形板单元，从而掌握经典薄板单元构造的基本原理。",
            "id": "3551396",
            "problem": "考虑在计算岩土力学的有限元法 (FEM) 框架下，基于 Kirchhoff–Love 假设建模的小挠度 Euler–Bernoulli 梁和薄板。\n\nA 部分（梁）：设一个长度为 $L$ 的单一直线 $2$ 节点 Euler–Bernoulli 梁单元通过等参映射 $x = x_{c} + \\frac{L}{2}\\,\\xi$ 由母坐标 $\\xi \\in [-1,1]$ 参数化，其中 $x_{c}$ 是单元中心。运动学假设将横截面转角与斜率关联起来，$\\theta = \\frac{\\mathrm{d}w}{\\mathrm{d}x}$，其中 $w(x)$ 是横向位移。寻求 $w(\\xi)$ 的三次 Hermite 插值，形式如下\n$$\nw(\\xi) = N_{1}(\\xi)\\,w_{1} + N_{2}(\\xi)\\,L\\,\\theta_{1} + N_{3}(\\xi)\\,w_{2} + N_{4}(\\xi)\\,L\\,\\theta_{2},\n$$\n节点自由度为 $\\xi=-1$ 处的 $w_{1}$、$\\theta_{1}$ 和 $\\xi=+1$ 处的 $w_{2}$、$\\theta_{2}$。在物理坐标 $x$ 中强制执行 $C^{1}$ 连续性的插值条件：精确的节点值 $w(-1)=w_{1}$、$w(1)=w_{2}$ 和精确的节点斜率 $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=-1}=\\theta_{1}$、$\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=1}=\\theta_{2}$，并考虑链式法则 $\\frac{\\mathrm{d}}{\\mathrm{d}x}=\\frac{2}{L}\\frac{\\mathrm{d}}{\\mathrm{d}\\xi}$。从这些原则出发，构造三次 Hermite 形函数 $N_{1}(\\xi)$、$N_{2}(\\xi)$、$N_{3}(\\xi)$ 和 $N_{4}(\\xi)$，作为 $\\xi$ 的显式多项式。\n\nB 部分（板）：对于 Kirchhoff–Love 理论下的矩形薄板单元，弯曲应变取决于横向位移场 $w(x,y)$ 的二阶导数，具体为 $\\kappa_{xx} = -\\frac{\\partial^{2} w}{\\partial x^{2}}$、$\\kappa_{yy} = -\\frac{\\partial^{2} w}{\\partial y^{2}}$ 和 $\\kappa_{xy} = -2\\,\\frac{\\partial^{2} w}{\\partial x \\partial y}$。为了实现单元间边界的 $C^{1}$ 连续性，位移 $w$ 及其一阶导数必须沿着共享边是连续的。使用与 A 部分中 Hermite 三次构造一致的张量积原理，推导出一个 $4$ 节点矩形板单元的每个角节点所需的最小节点参数集，以确保 $C^{1}$ 连续性和双三次完备性，并说明每个节点的自由度数量。\n\n将您的最终答案表示为四个形函数 $N_{1}(\\xi)$、$N_{2}(\\xi)$、$N_{3}(\\xi)$、$N_{4}(\\xi)$ 的行矩阵，后跟板单元每个节点的自由度数量。无需四舍五入。",
            "solution": "该问题包含两部分。A 部分要求显式构造一个 2 节点 Euler-Bernoulli 梁单元的三次 Hermite 形函数。B 部分要求推导一个 $C^{1}$ 连续的矩形 Kirchhoff-Love 板单元的节点自由度。\n\n### A 部分：梁单元形函数\n\n横向位移场 $w(\\xi)$ 在母域 $\\xi \\in [-1, 1]$ 上使用四个三次 Hermite 形函数 $N_{i}(\\xi)$进行插值。插值公式如下：\n$$w(\\xi) = N_{1}(\\xi)w_{1} + N_{2}(\\xi)L\\theta_{1} + N_{3}(\\xi)w_{2} + N_{4}(\\xi)L\\theta_{2}$$\n其中 $\\{w_{1}, \\theta_{1}\\}$ 是节点 1 ($\\xi=-1$) 处的位移和转角，$\\{w_{2}, \\theta_{2}\\}$ 是节点 2 ($\\xi=1$) 处的位移和转角。单元的长度为 $L$。\n\n题目陈述了对应于节点自由度的四个强制条件：\n1.  $w(-1) = w_{1}$\n2.  $w(1) = w_{2}$\n3.  $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=-1} = \\theta_{1}$\n4.  $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=1} = \\theta_{2}$\n\n物理坐标 $x$ 和母坐标 $\\xi$ 中导数之间的关系由链式法则和等参映射 $x = x_{c} + \\frac{L}{2}\\xi$ 给出：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} = \\frac{2}{L} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi}$$\n应用此关系，斜率条件变为：\n3. $\\frac{2}{L} \\left.\\frac{\\mathrm{d}w}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\theta_{1}$\n4. $\\frac{2}{L} \\left.\\frac{\\mathrm{d}w}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = \\theta_{2}$\n\n通过将 $w(\\xi)$ 的插值表达式代入这四个条件，并要求它们对任意节点值 $\\{w_{1}, \\theta_{1}, w_{2}, \\theta_{2}\\}$ 均成立，我们得到了每个形函数 $N_{i}(\\xi)$ 必须满足的条件。每个 $N_{i}(\\xi)$ 都是一个形式为 $a\\xi^3+b\\xi^2+c\\xi+d$ 的三次多项式。\n\n**对于 $N_1(\\xi)$：**\n该函数与 $w_{1}$ 相关联。设置 $w_{1}=1$ 且所有其他自由度为零，得到 $w(\\xi)=N_1(\\xi)$。\n1.  $N_{1}(-1) = 1$\n2.  $N_{1}(1) = 0$\n3.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}\\xi}\\right|_{\\xi=-1}=0 \\implies N_{1}'(-1)=0$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}\\xi}\\right|_{\\xi=1}=0 \\implies N_{1}'(1)=0$\n\n**对于 $N_2(\\xi)$：**\n该函数与 $L\\theta_{1}$ 相关联。设置 $L\\theta_{1}=1$ (即 $\\theta_1=1/L$) 且所有其他自由度为零，得到 $w(\\xi)=N_2(\\xi)$。\n1.  $N_{2}(-1) = 0$\n2.  $N_{2}(1) = 0$\n3.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\frac{1}{L} \\implies N_{2}'(-1) = \\frac{1}{2}$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = 0 \\implies N_{2}'(1) = 0$\n\n**对于 $N_3(\\xi)$：**\n该函数与 $w_{2}$ 相关联。\n1.  $N_{3}(-1) = 0$\n2.  $N_{3}(1) = 1$\n3.  $N_{3}'(-1) = 0$\n4.  $N_{3}'(1) = 0$\n\n**对于 $N_4(\\xi)$：**\n该函数与 $L\\theta_{2}$ 相关联。\n1.  $N_{4}(-1) = 0$\n2.  $N_{4}(1) = 0$\n3.  $N_{4}'(-1) = 0$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{4}}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = \\frac{1}{L} \\implies N_{4}'(1) = \\frac{1}{2}$\n\n我们现在求解每个形函数的多项式系数。\n设 $N(\\xi) = a\\xi^{3} + b\\xi^{2} + c\\xi + d$。则 $N'(\\xi) = 3a\\xi^{2} + 2b\\xi + c$。\n\n**$N_{1}(\\xi)$ 的推导：** 条件产生以下方程组：\n1.  $-a + b - c + d = 1$\n2.  $a + b + c + d = 0$\n3.  $3a - 2b + c = 0$\n4.  $3a + 2b + c = 0$\n由 (3) 和 (4)，$4b=0 \\implies b=0$，这给出 $c=-3a$。由 (1) 和 (2)，$2b+2d=1 \\implies d=1/2$，且 $2a+2c=-1$。代入 $c=-3a$ 得到 $2a-6a=-1 \\implies -4a=-1 \\implies a=1/4$。因此，$c=-3/4$。\n所以，$N_{1}(\\xi) = \\frac{1}{4}\\xi^{3} - \\frac{3}{4}\\xi + \\frac{1}{2}$。\n\n**$N_{3}(\\xi)$ 的推导：** 从条件中我们可以观察到，$N_{3}(\\xi)$ 通过变换 $\\xi \\to -\\xi$ 与 $N_{1}(\\xi)$ 相关。因此，$N_{3}(\\xi) = N_{1}(-\\xi)$。\n$N_{3}(\\xi) = \\frac{1}{4}(-\\xi)^{3} - \\frac{3}{4}(-\\xi) + \\frac{1}{2} = -\\frac{1}{4}\\xi^{3} + \\frac{3}{4}\\xi + \\frac{1}{2}$。\n\n**$N_{2}(\\xi)$ 的推导：** 条件产生以下方程组：\n1.  $-a + b - c + d = 0$\n2.  $a + b + c + d = 0$\n3.  $3a - 2b + c = 1/2$\n4.  $3a + 2b + c = 0$\n由 (1) 和 (2)，$b+d=0 \\implies d=-b$ 且 $a+c=0 \\implies c=-a$。代入 (3) 和 (4)：\n3. $3a-2b-a = 1/2 \\implies 2a-2b=1/2$\n4. $3a+2b-a = 0 \\implies 2a+2b=0 \\implies a=-b$。\n将 $a=-b$ 代入 $2a-2b=1/2$ 得到 $2(-b)-2b=1/2 \\implies -4b=1/2 \\implies b=-1/8$。则 $a=1/8$，$c=-1/8$，以及 $d=1/8$。\n所以，$N_{2}(\\xi) = \\frac{1}{8}\\xi^{3} - \\frac{1}{8}\\xi^{2} - \\frac{1}{8}\\xi + \\frac{1}{8}$。\n\n**$N_{4}(\\xi)$ 的推导：** $N_{4}(\\xi)$ 上的条件可以与 $N_{2}(\\xi)$ 上的条件相关联。设 $g(\\xi) = -N_{2}(-\\xi)$。那么 $g(-1) = -N_{2}(1) = 0$，$g(1) = -N_{2}(-1) = 0$。导数为 $g'(\\xi) = -(-1)N_{2}'(-\\xi) = N_{2}'(-\\xi)$。所以 $g'(-1) = N_{2}'(1) = 0$ 且 $g'(1) = N_{2}'(-1) = 1/2$。这些恰好是 $N_{4}(\\xi)$ 的条件。因此，$N_{4}(\\xi) = -N_{2}(-\\xi)$。\n$N_{4}(\\xi) = -(\\frac{1}{8}(-\\xi)^{3} - \\frac{1}{8}(-\\xi)^{2} - \\frac{1}{8}(-\\xi) + \\frac{1}{8}) = -(-\\frac{1}{8}\\xi^{3} - \\frac{1}{8}\\xi^{2} + \\frac{1}{8}\\xi + \\frac{1}{8}) = \\frac{1}{8}\\xi^{3} + \\frac{1}{8}\\xi^{2} - \\frac{1}{8}\\xi - \\frac{1}{8}$。\n\n四个作为 $\\xi$ 的显式多项式的形函数是：\n$N_{1}(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{3}{4}\\xi + \\frac{1}{2}$\n$N_{2}(\\xi) = \\frac{1}{8}\\xi^3 - \\frac{1}{8}\\xi^2 - \\frac{1}{8}\\xi + \\frac{1}{8}$\n$N_{3}(\\xi) = -\\frac{1}{4}\\xi^3 + \\frac{3}{4}\\xi + \\frac{1}{2}$\n$N_{4}(\\xi) = \\frac{1}{8}\\xi^3 + \\frac{1}{8}\\xi^2 - \\frac{1}{8}\\xi - \\frac{1}{8}$\n\n### B 部分：板单元自由度\n\n对于由 Kirchhoff-Love 理论控制的薄板，应变能涉及横向位移 $w(x, y)$ 的二阶导数。为了构建一个协调（或 $C^{1}$ 连续）的有限元，位移 $w$ 及其法向导数 $\\frac{\\partial w}{\\partial n}$ 都必须在单元间边界上是连续的。对于边平行于 $x$ 和 $y$ 轴的矩形单元，这意味着 $w$、$\\frac{\\partial w}{\\partial x}$ 和 $\\frac{\\partial w}{\\partial y}$ 必须在单元边上是连续的。\n\n题目建议基于 A 部分中的一维 Hermite 三次多项式进行张量积构造。一维插值保证了节点处的值和一阶导数的连续性。通过张量积将其扩展到二维，得到 $w(x, y)$ 的双三次多项式空间，可以在母坐标 $(\\xi, \\eta)$ 中表示为：\n$$w(\\xi, \\eta) = \\sum_{i=0}^{3} \\sum_{j=0}^{3} c_{ij} \\xi^{i} \\eta^{j}$$\n这个多项式有 $16$ 个系数，因此该单元必须总共有 $16$ 个自由度 (DOF)。对于一个 $4$ 节点矩形单元，这要求每个节点有 $16/4 = 4$ 个自由度。\n\n我们必须推导出确保 $C^{1}$ 连续性的特定节点参数集（自由度）。让我们分析沿一条边的连续性，例如，一条 $\\eta = \\text{常数}$ 的边。\n1.  **$w$ 的连续性**：沿着这条边，$w$ 是一个关于 $\\xi$ 的三次多项式。一个三次多项式由四个参数唯一确定。为确保其连续性仅取决于该边上的两个节点，我们可以在这两个节点处分别指定值 $w$ 和切向斜率 $\\frac{\\partial w}{\\partial \\xi}$。这总计 $2+2=4$ 个参数。因此，$w$ 和 $\\frac{\\partial w}{\\partial x}$ (与 $\\frac{\\partial w}{\\partial \\xi}$ 成正比) 必须是节点自由度。\n2.  **法向导数 $\\frac{\\partial w}{\\partial \\eta}$ 的连续性**：沿着同一条边，$\\frac{\\partial w}{\\partial \\eta}$ 也是一个关于 $\\xi$ 的三次多项式。为了通过边上两个节点的自由度唯一地定义它，我们可以再次在每个节点处指定其值和其切向导数。所需的参数是两个节点处的 $\\frac{\\partial w}{\\partial \\eta}$ 和 $\\frac{\\partial}{\\partial \\xi}(\\frac{\\partial w}{\\partial \\eta}) = \\frac{\\partial^{2} w}{\\partial \\xi \\partial \\eta}$。\n\n综合分析平行于两个坐标轴的边的要求，确保双三次场完全 $C^{1}$ 连续性的每个角节点的最小节点参数集是：\n1.  位移：$w$\n2.  绕 $y$ 轴的转角：$\\frac{\\partial w}{\\partial x}$\n3.  绕 $x$ 轴的转角：$\\frac{\\partial w}{\\partial y}$\n4.  混合偏导数（扭率）：$\\frac{\\partial^{2} w}{\\partial x \\partial y}$\n\n这个集合包含四个参数。因此，每个节点的自由度数量为 $4$。这个集合允许仅基于边上两个端点的参数来唯一定义 $w$ 及其法向导数沿任意边的三次变化，从而保证单元间的 $C^{1}$ 连续性。\n\n板单元每个节点的自由度数量为 $4$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} - \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^3 & \\frac{1}{8} - \\frac{1}{8}\\xi - \\frac{1}{8}\\xi^2 + \\frac{1}{8}\\xi^3 & \\frac{1}{2} + \\frac{3}{4}\\xi - \\frac{1}{4}\\xi^3 & -\\frac{1}{8} - \\frac{1}{8}\\xi + \\frac{1}{8}\\xi^2 + \\frac{1}{8}\\xi^3 & 4 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在开发或使用一个新的有限元时，我们必须首先验证其基本精度和可靠性。“Patch Test”（斑块检验）是确保单元正确性的黄金标准，它检验单元在任意（扭曲）网格上能否精确再现常应变和常曲率状态。本练习要求你为基于Reissner-Mindlin理论的四节点四边形壳单元设计膜和弯曲斑块检验，你需要指定能够产生常应变和常曲率的精确位移场和转角场。通过这个过程，你将深刻理解单元的运动学性能，并掌握验证其通过最基本一致性检验的核心技术。",
            "id": "3551339",
            "problem": "考虑一个嵌入在畸变物理域中的单个四节点等参双线性四边形壳单元。该单元在全局笛卡尔物理空间中的节点坐标由顶点位于 $(0,0)$、$(2,0.2)$、$(1.8,1.0)$ 和 $(0.1,0.9)$ 的凸四边形给出。该壳是均匀、各向同性、线性弹性的，并遵循小应变、小转动运动学。设壳厚度为 $t$，杨氏模量为 $E$，泊松比为 $\\nu$，横向剪切修正因子为 $k_{s}$。假设采用 Reissner–Mindlin 运动学描述，其中中面面内位移为 $u(x,y)$ 和 $v(x,y)$，横向位移为 $w(x,y)$，绕 $y$ 轴和 $x$ 轴的独立转动分别为 $\\beta_{x}(x,y)$ 和 $\\beta_{y}(x,y)$。所有计算完全在物理坐标 $(x,y)$ 中进行。\n\n您的目标是设计精确的位移场和转动场，用作该畸变单元的膜和弯曲斑块检验，并推导出相应的恒定应力合力。请按以下步骤进行：\n\n1. 膜斑块检验：\n   - 指定显式场 $u(x,y)$、$v(x,y)$、$w(x,y)$、$\\beta_{x}(x,y)$、$\\beta_{y}(x,y)$，使其在单元内各处产生恒定的面内膜应变 $\\varepsilon_{x}^{0}$、$\\varepsilon_{y}^{0}$ 和 $\\gamma_{xy}^{0}$，且弯曲曲率和横向剪切应变为零。您的场必须由目标常量 $\\varepsilon_{x}^{0}$、$\\varepsilon_{y}^{0}$ 和 $\\gamma_{xy}^{0}$ 参数化，并且无论双线性映射如何畸变，都必须保持精确。\n   - 使用简化为中面平面应力状态的三维小应变线性弹性理论，并通过沿厚度积分，推导与您的场相关的恒定膜力合力 $N_{x}$、$N_{y}$ 和 $N_{xy}$，以 $E$、$\\nu$、$t$ 和目标常量表示。\n\n2. 弯曲斑块检验：\n   - 指定显式场 $u(x,y)$、$v(x,y)$、$w(x,y)$、$\\beta_{x}(x,y)$、$\\beta_{y}(x,y)$，使其在单元内各处产生恒定的弯曲曲率 $\\kappa_{x}^{0}$、$\\kappa_{y}^{0}$ 和 $\\kappa_{xy}^{0}$，且中面膜应变和横向剪切应变为零。您的场必须由目标常量 $\\kappa_{x}^{0}$、$\\kappa_{y}^{0}$ 和 $\\kappa_{xy}^{0}$ 参数化，并且无论双线性映射如何畸变，都必须保持精确。\n   - 从相同的基本运动学、平面应力弹性理论和沿厚度积分出发，推导与您的场相关的恒定弯矩合力 $M_{x}$、$M_{y}$ 和 $M_{xy}$，以 $E$、$\\nu$、$t$ 和目标常量表示。\n\n假设中面膜应变 $\\varepsilon_{x}^{0}$、$\\varepsilon_{y}^{0}$ 和工程剪应变 $\\gamma_{xy}^{0}$，Reissner–Mindlin 横向剪切应变 $\\gamma_{xz}$ 和 $\\gamma_{yz}$，以及工程弯曲曲率 $\\kappa_{x}$、$\\kappa_{y}$ 和 $\\kappa_{xy}$ 均采用标准的小应变度量。在构造弯曲斑块检验时，您可以将横向剪切合力视为零。将最终结果表示为行向量 $[N_{x},\\,N_{y},\\,N_{xy},\\,M_{x},\\,M_{y},\\,M_{xy}]$ 关于 $E$、$\\nu$、$t$ 和六个目标常量的单个解析表达式。不需要数值。您的最终答案必须是单个解析表达式。如果您引入任何代表刚体运动的常数，请明确说明它们不影响合力结果。\n\n不需要四舍五入。最终的框式答案中不要包含单位；所有符号必须在您的推导过程中有明确定义。若涉及角度，应视为以弧度为单位。",
            "solution": "该问题陈述是计算壳力学理论中一个有效、适定且具有科学依据的练习。它要求为四节点四边形壳单元的膜和弯曲斑块检验设计解析位移场和转动场，并推导相应的恒定应力合力。所提供的节点坐标仅用于确定单元在几何上是畸变的；推导过程必须是通用的，并且独立于这些具体坐标。\n\n我们首先定义一个经历小应变和小转动的线性弹性各向同性 Reissner–Mindlin 壳的基本运动学和本构关系。\n\n自由度为中面位移 $u(x,y)$、$v(x,y)$、$w(x,y)$ 以及中面法线的独立转动 $\\beta_{x}(x,y)$ 和 $\\beta_{y}(x,y)$。根据问题陈述，$\\beta_{x}$ 是绕 $y$ 轴的转动，$\\beta_{y}$ 是绕 $x$ 轴的转动。\n\n为确保整个推导过程的一致性，我们采用以下标准的小应变工程运动学关系：\n中面膜应变：\n$$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{y} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n弯曲曲率：\n$$ \\kappa_{x} = \\frac{\\partial \\beta_{x}}{\\partial x}, \\quad \\kappa_{y} = \\frac{\\partial \\beta_{y}}{\\partial y}, \\quad \\kappa_{xy} = \\frac{\\partial \\beta_{x}}{\\partial y} + \\frac{\\partial \\beta_{y}}{\\partial x} $$\n横向剪切应变：\n$$ \\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\beta_{x}, \\quad \\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\beta_{y} $$\n这套定义确保了物理意义的明确性，例如，曲率 $\\kappa_x$ 与绕 $y$ 轴转动 $\\beta_x$ 的梯度相关联。\n\n应力合力（单位长度上的力和力矩）通过平面应力本构关系与应变和曲率相关，并通过沿壳厚度 $t$ 积分得到。对于杨氏模量为 $E$、泊松比为 $\\nu$ 的均匀各向同性材料：\n\n膜力合力为：\n$$\n\\begin{pmatrix} N_{x} \\\\ N_{y} \\\\ N_{xy} \\end{pmatrix} = \\frac{E t}{1-\\nu^2} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix}\n$$\n弯矩合力为：\n$$\n\\begin{pmatrix} M_{x} \\\\ M_{y} \\\\ M_{xy} \\end{pmatrix} = \\frac{E t^3}{12(1-\\nu^2)} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} \\kappa_{x} \\\\ \\kappa_{y} \\\\ \\kappa_{xy} \\end{pmatrix}\n$$\n该问题可以通过分别考虑膜和弯曲斑块检验，然后通过线性叠加组合结果来解决。\n\n**1. 膜斑块检验**\n\n目标是找到产生恒定膜应变状态 $(\\varepsilon_{x}, \\varepsilon_{y}, \\gamma_{xy}) = (\\varepsilon_{x}^{0}, \\varepsilon_{y}^{0}, \\gamma_{xy}^{0})$，且弯曲曲率和横向剪切应变为零的场。\n\n为获得恒定的膜应变，我们对应变-位移关系进行积分：\n$\\frac{\\partial u}{\\partial x} = \\varepsilon_{x}^{0} \\implies u(x,y) = \\varepsilon_{x}^{0}x + f(y)$\n$\\frac{\\partial v}{\\partial y} = \\varepsilon_{y}^{0} \\implies v(x,y) = \\varepsilon_{y}^{0}y + g(x)$\n代入剪切应变定义：\n$\\gamma_{xy}^{0} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = f'(y) + g'(x)$\n为使此式对所有 $(x,y)$ 成立，$f'(y)$ 和 $g'(x)$ 必须是常数。一个对称的选择是 $f'(y) = g'(x) = \\frac{\\gamma_{xy}^{0}}{2}$。\n对它们积分得到 $f(y) = \\frac{\\gamma_{xy}^{0}}{2}y + C_1$ 和 $g(x) = \\frac{\\gamma_{xy}^{0}}{2}x + C_2$。\n积分常数可以用刚体运动参数表示：面内平移 $u_r, v_r$ 和绕 $z$ 轴的转动 $\\omega_r$。\n$u(x,y) = \\varepsilon_{x}^{0}x + \\frac{\\gamma_{xy}^{0}}{2}y + u_r - \\omega_r y$\n$v(x,y) = \\frac{\\gamma_{xy}^{0}}{2}x + \\varepsilon_{y}^{0}y + v_r + \\omega_r x$\n\n为确保弯曲曲率为零，转动场的梯度必须为零。这意味着 $\\beta_x$ 和 $\\beta_y$ 必须是常数，对应于刚体倾斜。设 $\\beta_x = \\beta_{xr}$ 和 $\\beta_y = \\beta_{yr}$。\n\n为确保横向剪切应变为零：\n$\\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\beta_x = 0 \\implies \\frac{\\partial w}{\\partial x} = -\\beta_x = -\\beta_{xr}$\n$\\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\beta_y = 0 \\implies \\frac{\\partial w}{\\partial y} = -\\beta_y = -\\beta_{yr}$\n对它们积分得到横向位移场：\n$w(x,y) = - \\beta_{xr} x - \\beta_{yr} y + w_r$，其中 $w_r$ 是刚体平移。\n\n膜斑块检验的完整场是 $x$ 和 $y$ 的线性函数。任何非退化的四节点等参单元都可以精确表示线性场。因此，这种状态可以被精确再现。刚体运动参数 $(u_r, v_r, w_r, \\omega_r, \\beta_{xr}, \\beta_{yr})$ 不会引起任何应力或应变。\n\n膜力合力通过将恒定应变代入本构关系得到：\n$N_{x} = \\frac{E t}{1-\\nu^2}(\\varepsilon_{x}^{0} + \\nu \\varepsilon_{y}^{0})$\n$N_{y} = \\frac{E t}{1-\\nu^2}(\\nu \\varepsilon_{x}^{0} + \\varepsilon_{y}^{0})$\n$N_{xy} = \\frac{E t}{1-\\nu^2} \\frac{1-\\nu}{2} \\gamma_{xy}^{0} = \\frac{E t}{2(1+\\nu)} \\gamma_{xy}^{0}$\n由于曲率为零，$M_x = M_y = M_{xy} = 0$。\n\n**2. 弯曲斑块检验**\n\n目标是找到产生恒定弯曲曲率状态 $(\\kappa_{x}, \\kappa_{y}, \\kappa_{xy}) = (\\kappa_{x}^{0}, \\kappa_{y}^{0}, \\kappa_{xy}^{0})$，且膜应变和横向剪切应变为零的场。\n\n为获得恒定的曲率，我们对修正后的标准曲率-转动关系进行积分：\n$\\frac{\\partial \\beta_{x}}{\\partial x} = \\kappa_{x}^{0} \\implies \\beta_x(x,y) = \\kappa_{x}^{0}x + f(y)$\n$\\frac{\\partial \\beta_{y}}{\\partial y} = \\kappa_{y}^{0} \\implies \\beta_y(x,y) = \\kappa_{y}^{0}y + g(x)$\n代入扭曲曲率定义：\n$\\kappa_{xy}^{0} = \\frac{\\partial \\beta_{x}}{\\partial y} + \\frac{\\partial \\beta_{y}}{\\partial x} = f'(y) + g'(x)$\n一个对称的选择是 $f'(y) = g'(x) = \\frac{\\kappa_{xy}^{0}}{2}$。积分并包含刚体倾斜常数 $\\beta_{xr}, \\beta_{yr}$：\n$\\beta_x(x,y) = \\kappa_{x}^{0}x + \\frac{\\kappa_{xy}^{0}}{2}y + \\beta_{xr}$\n$\\beta_y(x,y) = \\frac{\\kappa_{xy}^{0}}{2}x + \\kappa_{y}^{0}y + \\beta_{yr}$\n\n为确保膜应变为零，面内位移必须表示刚体运动：\n$u(x,y) = u_r - \\omega_r y$\n$v(x,y) = v_r + \\omega_r x$\n\n为确保横向剪切应变为零，我们对 $\\frac{\\partial w}{\\partial x} = -\\beta_x$ 和 $\\frac{\\partial w}{\\partial y} = -\\beta_y$ 进行积分：\n$\\frac{\\partial w}{\\partial x} = -(\\kappa_{x}^{0}x + \\frac{\\kappa_{xy}^{0}}{2}y + \\beta_{xr})$\n$\\frac{\\partial w}{\\partial y} = -(\\frac{\\kappa_{xy}^{0}}{2}x + \\kappa_{y}^{0}y + \\beta_{yr})$\n将第一个方程对 $x$ 积分得到：\n$w(x,y) = -\\frac{\\kappa_{x}^{0}}{2}x^2 - \\frac{\\kappa_{xy}^{0}}{2}xy - \\beta_{xr}x + h(y)$\n对 $y$ 微分并与第二个条件相等：\n$\\frac{\\partial w}{\\partial y} = -\\frac{\\kappa_{xy}^{0}}{2}x + h'(y) = -(\\frac{\\kappa_{xy}^{0}}{2}x + \\kappa_{y}^{0}y + \\beta_{yr})$\n$h'(y) = -\\kappa_{y}^{0}y - \\beta_{yr} \\implies h(y) = -\\frac{\\kappa_{y}^{0}}{2}y^2 - \\beta_{yr}y + w_r$。\n所需的横向位移场是二次的：\n$w(x,y) = -\\frac{1}{2}(\\kappa_{x}^{0}x^2 + \\kappa_{y}^{0}y^2 + \\kappa_{xy}^{0}xy) - \\beta_{xr}x - \\beta_{yr}y + w_r$\n\n弯矩合力通过将恒定曲率代入本构关系得到：\n$M_{x} = \\frac{E t^3}{12(1-\\nu^2)}(\\kappa_{x}^{0} + \\nu\\kappa_{y}^{0})$\n$M_{y} = \\frac{E t^3}{12(1-\\nu^2)}(\\nu\\kappa_{x}^{0} + \\kappa_{y}^{0})$\n$M_{xy} = \\frac{E t^3}{12(1-\\nu^2)} \\frac{1-\\nu}{2} \\kappa_{xy}^{0} = \\frac{E t^3}{24(1+\\nu)} \\kappa_{xy}^{0}$\n由于膜应变为零，$N_x = N_y = N_{xy} = 0$。\n\n**组合结果**\n由于基础理论的线性特性，通过叠加两种检验中推导出的位移场和转动场，可以实现恒定膜应变和恒定弯曲曲率的一般状态。由此产生的应力合力是各项检验所得合力的总和。问题要求以六个目标常量 $\\varepsilon_{x}^{0}, \\varepsilon_{y}^{0}, \\gamma_{xy}^{0}, \\kappa_{x}^{0}, \\kappa_{y}^{0}, \\kappa_{xy}^{0}$ 表示的单个行向量形式的合力。\n\n综合结果，我们有：\n$N_{x} = \\frac{Et}{1-\\nu^2}(\\varepsilon_{x}^{0} + \\nu\\varepsilon_{y}^{0})$\n$N_{y} = \\frac{Et}{1-\\nu^2}(\\nu\\varepsilon_{x}^{0} + \\varepsilon_{y}^{0})$\n$N_{xy} = \\frac{Et}{2(1+\\nu)}\\gamma_{xy}^{0}$\n$M_{x} = \\frac{Et^3}{12(1-\\nu^2)}(\\kappa_{x}^{0} + \\nu\\kappa_{y}^{0})$\n$M_{y} = \\frac{Et^3}{12(1-\\nu^2)}(\\nu\\kappa_{x}^{0} + \\kappa_{y}^{0})$\n$M_{xy} = \\frac{Et^3}{24(1+\\nu)}\\kappa_{xy}^{0}$\n\n这些表达式构成了正确制定的有限元实现为通过斑块检验应能再现的解析解。与刚体运动相关的常数对应变或应力没有贡献，因此不会出现在合力的最终表达式中。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Et}{1-\\nu^2}(\\varepsilon_{x}^{0} + \\nu\\varepsilon_{y}^{0}) & \\frac{Et}{1-\\nu^2}(\\nu\\varepsilon_{x}^{0} + \\varepsilon_{y}^{0}) & \\frac{Et}{2(1+\\nu)}\\gamma_{xy}^{0} & \\frac{Et^3}{12(1-\\nu^2)}(\\kappa_{x}^{0} + \\nu\\kappa_{y}^{0}) & \\frac{Et^3}{12(1-\\nu^2)}(\\nu\\kappa_{x}^{0} + \\kappa_{y}^{0}) & \\frac{Et^3}{24(1+\\nu)}\\kappa_{xy}^{0}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Reissner-Mindlin板单元因其仅需$C^0$连续性而得到广泛应用，但它们在模拟薄板时会遭遇一种被称为“剪切锁定”(shear locking)的数值病态问题，导致单元表现得异常刚硬，位移结果偏小。本实践旨在通过一个数值基准测试，让你亲手诊断并解决这一问题。你将为一个固支方板实现两种不同的四边形单元列式：一种采用完全积分，另一种则对剪切能项采用选择性减缩积分（SRI）。通过对比两者在薄板极限下的中心挠度，你将量化剪切锁定的影响，并直观地理解SRI作为一种经典“解锁”技术的有效性。",
            "id": "3551332",
            "problem": "要求您设计并实现一个自包含的数值基准测试，通过将有效剪切刚度驱动至零，来揭示支撑在软性温克勒地基上的、用于类土材料的Reissner–Mindlin板单元中的剪切锁定现象。从虚功原理出发，使用双线性四边形单元对一个四边固支、均布荷载的方形板的控制方程进行离散化，并比较两种单元族：它们唯一的区别在于对横向剪切项的处理方式，即完全高斯积分与选择性减缩积分。通过在一系列剪切模量缩放参数和网格密度下，计算两种公式中心挠度的比值来量化锁定现象。\n\n基本出发点必须如下。Reissner–Mindlin板的运动学假设一个横向位移场 $w(x,y)$ 和独立的转角 $\\theta_x(x,y)$ 及 $\\theta_y(x,y)$。曲率应变为 $\\kappa_x = \\partial \\theta_x / \\partial x$、$\\kappa_y = \\partial \\theta_y / \\partial y$ 和 $\\kappa_{xy} = \\partial \\theta_x / \\partial y + \\partial \\theta_y / \\partial x$。横向剪切应变为 $\\gamma_{xz} = \\theta_x + \\partial w / \\partial x$ 和 $\\gamma_{yz} = \\theta_y + \\partial w / \\partial y$。应变能密度是弯曲和剪切贡献的总和，而刚度为 $k$ 的温克勒地基的势能对 $w$ 施加了一个局部惩罚。虚功声明将内部虚功与来自均布荷载 $q$ 的外部虚功相等。\n\n您必须在边长为 $L$ 的正方形域上，使用结构化网格上的双线性四边形（$\\mathrm{Q}4$）等参单元来离散化此问题。在所有边上使用固支边界条件（$w=\\theta_x=\\theta_y=0$）。通过对所有公式使用完全相同的求积方法对曲率项进行积分，来构建单元弯曲刚度。以两种不同方式构建单元剪切刚度：\n- 公式A（完全积分）：使用标准的 $2\\times 2$ 高斯积分法对剪切能进行积分。\n- 公式B（选择性减缩积分，SRI）：在单元中心使用单个高斯点对剪切能进行积分。\n\n保持公式A和B之间的弯曲刚度不变，以便仅有剪切处理方式不同。\n\n为模拟类土行为，引入一个标量因子 $\\alpha \\in (0,1]$，它将有效剪切模量缩放为 $G_{\\mathrm{eff}} = \\alpha \\, G_0$，其中 $G_0$ 是通过杨氏模量 $E$ 和泊松比 $\\nu$ 计算出的剪切模量，公式为 $G_0 = E / (2(1+\\nu))$。弯曲刚度必须保持与 $E$ 和 $\\nu$ 挂钩而不进行缩放，而剪切刚度则使用 $G_{\\mathrm{eff}}$。这种分离模拟了一种材料，其弯曲刚度由 $E$ 和 $\\nu$ 控制，但其横向剪切柔度可以独立调节，这是Reissner–Mindlin基准测试中的一种标准方法。\n\n从虚功原理和标准的等参有限元方法出发，推导您的单元矩阵。不要使用任何针对Mindlin单元的简化公式。通过在单元级别添加一个一致的 $w$–$w$ 刚度项来计入温克勒地基的贡献。组装全局系统，对所有边界节点施加固支边界条件，并求解线性系统以获得 $w$、$\\theta_x$ 和 $\\theta_y$ 的节点值。\n\n使用以下物理上合理且自洽的参数和单位，并在所有测试案例中保持不变，除非明确变化：\n- 几何：方形板，边长 $L = 1\\,\\mathrm{m}$，厚度 $t = 0.01\\,\\mathrm{m}$。\n- 弯曲材料：杨氏模量 $E = 30\\times 10^9\\,\\mathrm{Pa}$，泊松比 $\\nu = 0.3$。\n- 剪切修正系数：$\\kappa_s = 5/6$，应用于剪切刚度。\n- 均布横向荷载：$q = 1000\\,\\mathrm{N/m^2}$，施加于整个板面。\n- 温克勒地基：刚度 $k = 1000\\,\\mathrm{N/m^3}$（软地基）。\n- 未直接要求角度量；没有需要报告的角度单位。\n- 内部出现的所有位移单位必须是 $\\mathrm{m}$，荷载单位是 $\\mathrm{N/m^2}$，刚度单位使用与上述一致的相应国际单位制（SI）单位。\n\n将每个测试案例的锁定指标定义为比值\n$$\nR = \\frac{w_{\\mathrm{center}}^{\\mathrm{Full}}}{w_{\\mathrm{center}}^{\\mathrm{SRI}}},\n$$\n其中 $w_{\\mathrm{center}}^{\\mathrm{Full}}$ 和 $w_{\\mathrm{center}}^{\\mathrm{SRI}}$ 分别是公式A和公式B计算出的板几何中心的横向位移。将 $R  1$ 解释为，相对于选择性减缩积分公式，完全积分剪切公式由于剪切锁定而导致的预测偏低。\n\n您的程序必须实现以上内容，并评估以下参数组合的测试套件，这些组合旨在考察软温克勒地基下的正常情况、接近无剪切极限以及网格敏感性：\n- 案例1：$(\\alpha, n_x, n_y) = (1.0, 4, 4)$。\n- 案例2：$(\\alpha, n_x, n_y) = (10^{-3}, 4, 4)$。\n- 案例3：$(\\alpha, n_x, n_y) = (10^{-6}, 4, 4)$。\n- 案例4：$(\\alpha, n_x, n_y) = (1.0, 2, 2)$。\n- 案例5：$(\\alpha, n_x, n_y) = (10^{-6}, 2, 2)$。\n- 案例6：$(\\alpha, n_x, n_y) = (10^{-6}, 8, 8)$。\n\n此处，$n_x$ 和 $n_y$ 分别是 $x$ 和 $y$ 方向的单元数量。对于每种情况，计算如上定义的单个标量 $R$。您程序的最终输出必须是单行文本，包含所有六个 $R$ 值，以逗号分隔并用方括号括起，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$。每个 $r_i$ 是一个无单位的浮点数。不得打印任何其他文本。\n\n注意：本说明中的所有数学符号和数字均采用国际单位制（SI），且所要求的输出均为无量纲比值，因此最终结果无需进行单位转换。",
            "solution": "作为一项强制性先决条件，对用户的问题陈述进行了严格评估。\n\n### 步骤1：提取已知条件\n- **问题域**：一个边长 $L = 1\\,\\mathrm{m}$、厚度 $t = 0.01\\,\\mathrm{m}$ 的方形板，放置在刚度为 $k = 1000\\,\\mathrm{N/m^3}$ 的温克勒地基上。\n- **材料属性**：杨氏模量 $E = 30\\times 10^9\\,\\mathrm{Pa}$，泊松比 $\\nu = 0.3$。\n- **荷载**：均布横向荷载 $q = 1000\\,\\mathrm{N/m^2}$。\n- **边界条件**：四边固支（$w = \\theta_x = \\theta_y = 0$）。\n- **运动学理论**：Reissner–Mindlin板理论。\n  - 位移场：$w(x,y)$, $\\theta_x(x,y)$, $\\theta_y(x,y)$。\n  - 曲率应变：$\\kappa_x = \\partial \\theta_x / \\partial x$, $\\kappa_y = \\partial \\theta_y / \\partial y$, $\\kappa_{xy} = \\partial \\theta_x / \\partial y + \\partial \\theta_y / \\partial x$。\n  - 横向剪切应变：$\\gamma_{xz} = \\theta_x + \\partial w / \\partial x$, $\\gamma_{yz} = \\theta_y + \\partial w / \\partial y$。\n- **有限元模型**：\n  - 单元类型：双线性四边形（$\\mathrm{Q}4$）等参单元。\n  - 网格：$n_x \\times n_y$ 单元的结构化网格。\n- **剪切建模**：\n  - 剪切修正系数：$\\kappa_s = 5/6$。\n  - 有效剪切模量：$G_{\\mathrm{eff}} = \\alpha \\, G_0$，其中 $G_0 = E / (2(1+\\nu))$ 且 $\\alpha \\in (0,1]$。\n- **用于比较的公式**：\n  - 弯曲刚度：在所有情况下均使用 $2\\times 2$ 高斯积分法进行积分。\n  - 公式A（完全）：剪切刚度使用 $2\\times 2$ 高斯积分法进行积分。\n  - 公式B（SRI）：剪切刚度使用单个（$1\\times 1$）高斯点进行积分。\n- **锁定指标**：$R = w_{\\mathrm{center}}^{\\mathrm{Full}} / w_{\\mathrm{center}}^{\\mathrm{SRI}}$，即中心横向挠度之比。\n- **测试案例**：\n  - 案例1：$(\\alpha, n_x, n_y) = (1.0, 4, 4)$。\n  - 案例2：$(\\alpha, n_x, n_y) = (10^{-3}, 4, 4)$。\n  - 案例3：$(\\alpha, n_x, n_y) = (10^{-6}, 4, 4)$。\n  - 案例4：$(\\alpha, n_x, n_y) = (1.0, 2, 2)$。\n  - 案例5：$(\\alpha, n_x, n_y) = (10^{-6}, 2, 2)$。\n  - 案例6：$(\\alpha, n_x, n_y) = (10^{-6}, 8, 8)$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据充分**：问题牢固地植根于弹性力学和计算固体力学理论。Reissner-Mindlin板理论、有限元方法以及剪切锁定的概念都是标准且完善的课题。\n- **问题适定**：该问题描述了一个具有明确定义的几何形状、材料属性、荷载和边界条件的板的静态分析。这构成了一个允许唯一解的标准边值问题。\n- **目标明确**：所有参数和程序都以定量和明确的方式指定。目标是计算一个数值比率，这是一个客观的度量。\n- **完整性与一致性**：问题是自包含的。推导和实现所需的所有常数和控制方程均已提供。单位（SI）在全文中保持一致。\n- **可行性与现实性**：指定的参数在物理上是合理的。实现此有限元基准测试的任务在计算上是可行的。使用参数 $\\alpha$ 来诱发剪切锁定是板单元数值分析中的一种标准技术。\n- **结构与平凡性**：问题结构良好且非平凡。它需要从虚功原理进行正确推导，并仔细实现有限元方法，包括数值求积、矩阵组装和边界条件的应用。\n\n### 步骤3：结论与行动\n问题陈述**有效**。这是一个适定的、科学上合理的、并且完整的计算力学问题。将提供一个解决方案。\n\n### 基于原理的推导和求解方法\n\n解决方案源自虚功原理，该原理指出，对于处于平衡状态的物体，对于任何运动学上容许的虚位移，内虚功等于外虚功。对于给定的系统，这表示为：\n$$\n\\delta U_b + \\delta U_s + \\delta U_w = \\delta W_{ext}\n$$\n其中 $\\delta U_b$ 是弯曲虚功，$\\delta U_s$ 是横向剪切虚功，$\\delta U_w$ 是在温克勒地基上所做的虚功，$\\delta W_{ext}$ 是外荷载的虚功。\n\n各项分别为：\n$$\n\\delta U_b = \\int_A \\delta\\boldsymbol{\\kappa}^T \\mathbf{M} \\, dA \\quad , \\quad \\delta U_s = \\int_A \\delta\\boldsymbol{\\gamma}^T \\mathbf{Q} \\, dA \\quad , \\quad \\delta U_w = \\int_A \\delta w \\, (k w) \\, dA \\quad , \\quad \\delta W_{ext} = \\int_A \\delta w \\, q \\, dA\n$$\n此处，$\\boldsymbol{\\kappa} = [\\kappa_x, \\kappa_y, \\kappa_{xy}]^T$ 是曲率向量，$\\boldsymbol{\\gamma} = [\\gamma_{xz}, \\gamma_{yz}]^T$ 是横向剪切应变向量，$\\mathbf{M}$ 是弯矩向量，$\\mathbf{Q}$ 是剪力向量，$k$ 是温克勒刚度，$q$ 是分布荷载。\n\n各向同性材料的本构关系为 $\\mathbf{M} = \\mathbf{C}_b \\boldsymbol{\\kappa}$ 和 $\\mathbf{Q} = \\mathbf{C}_s \\boldsymbol{\\gamma}$。\n弯曲刚度矩阵 $\\mathbf{C}_b$ 是：\n$$\n\\mathbf{C}_b = \\frac{E t^3}{12(1-\\nu^2)} \\begin{pmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{pmatrix}\n$$\n剪切刚度矩阵 $\\mathbf{C}_s$ 是：\n$$\n\\mathbf{C}_s = \\kappa_s G_{\\mathrm{eff}} t \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\kappa_s \\left( \\alpha \\frac{E}{2(1+\\nu)} \\right) t \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n因子 $\\alpha$ 直接缩放剪切刚度，当 $\\alpha \\to 0$ 时，可以模拟薄板行为（此时剪切锁定现象显著）。\n\n我们使用双线性四边形（$\\mathrm{Q}4$）单元对域进行离散化。在每个单元内，位移场和转角场通过等参形函数 $N_i(\\xi, \\eta)$ 从节点自由度 $\\mathbf{d}^e = [w_1, \\theta_{x1}, \\theta_{y1}, \\dots, w_4, \\theta_{x4}, \\theta_{y4}]^T$ 插值得到：\n$$\nw(\\xi, \\eta) = \\sum_{i=1}^{4} N_i w_i \\quad , \\quad \\theta_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i \\theta_{xi} \\quad , \\quad \\theta_y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i \\theta_{yi}\n$$\n其中 $(\\xi, \\eta)$ 是单元的自然坐标。节点 $i$ 的形函数为 $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$。\n\n应变场通过应变-位移矩阵 $\\mathbf{B}_b$ 和 $\\mathbf{B}_s$ 与节点自由度（DOF）相关联：\n$$\n\\boldsymbol{\\kappa} = \\mathbf{B}_b \\mathbf{d}^e \\quad , \\quad \\boldsymbol{\\gamma} = \\mathbf{B}_s \\mathbf{d}^e\n$$\n横向位移插值为 $w = \\mathbf{N}_w \\mathbf{d}^e$。矩阵 $\\mathbf{B}_b$ 和 $\\mathbf{B}_s$ 包含形函数的空间导数。这些导数是使用等参映射的雅可比矩阵，相对于全局坐标 $(x,y)$ 计算的。\n\n将离散化后的场代入虚功原理，得到单元级方程组。对于任意虚位移 $(\\delta \\mathbf{d}^e)^T$，我们得到单元刚度矩阵 $\\mathbf{k}^e$ 和力向量 $\\mathbf{f}^e$：\n$$\n(\\mathbf{k}_b^e + \\mathbf{k}_s^e + \\mathbf{k}_w^e) \\mathbf{d}^e = \\mathbf{f}^e\n$$\n单个单元刚度矩阵通过在单元域 $A^e$ 上进行数值积分来计算：\n$$\n\\mathbf{k}_b^e = \\int_{A^e} \\mathbf{B}_b^T \\mathbf{C}_b \\mathbf{B}_b \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}_b^T \\mathbf{C}_b \\mathbf{B}_b \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n$$\n\\mathbf{k}_s^e = \\int_{A^e} \\mathbf{B}_s^T \\mathbf{C}_s \\mathbf{B}_s \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}_s^T \\mathbf{C}_s \\mathbf{B}_s \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n$$\n\\mathbf{k}_w^e = \\int_{A^e} k \\mathbf{N}_w^T \\mathbf{N}_w \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} k \\mathbf{N}_w^T \\mathbf{N}_w \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n单元力向量为：\n$$\n\\mathbf{f}^e = \\int_{A^e} q \\mathbf{N}_w^T \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} q \\mathbf{N}_w^T \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n该基准测试的核心在于用于 $\\mathbf{k}_s^e$ 的数值求积法。对于两种公式，$\\mathbf{k}_b^e$、$\\mathbf{k}_w^e$ 和 $\\mathbf{f}^e$ 均使用标准的 $2\\times 2$ 高斯求积法则进行计算。\n- **公式A（完全积分）**：$\\mathbf{k}_s^e$ 使用 $2\\times 2$ 高斯求积法则计算。在薄板极限情况下，该法则会过度约束单元，导致剪切锁定。\n- **公式B（选择性减缩积分 - SRI）**：$\\mathbf{k}_s^e$ 在单元中心（$\\xi=0, \\eta=0$）使用单个高斯点（$1\\times 1$ 法则）计算。这会软化剪切响应并减轻锁定。\n\n将单元矩阵和向量组装成一个全局线性方程组 $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$。通过从全局系统中消除相应的行和列，对板周边上的所有节点施加固支边界条件（$w=\\theta_x=\\theta_y=0$）。求解得到的简化系统，以获得未知的节点位移和转角 $\\mathbf{d}$。\n\n最后，确定板几何中心的横向位移 $w_{\\mathrm{center}}$。由于所有指定的网格（$2\\times 2$、$4\\times 4$、$8\\times 8$）都具有偶数个单元，板的中心与一个节点重合。通过对公式A和公式B运行仿真，并取中心挠度的比值 $R = w_{\\mathrm{center}}^{\\mathrm{Full}} / w_{\\mathrm{center}}^{\\mathrm{SRI}}$，来计算每个测试案例的锁定指标 $R$。$R  1$ 的值表示在完全积分单元中存在剪切锁定，因为其人为的高刚度导致了较小的预测位移。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main solver function to execute the benchmark for Reissner-Mindlin plates.\n    It iterates through a set of predefined test cases, computes the locking\n    indicator for each, and prints the results in the specified format.\n    \"\"\"\n\n    # Define physical and geometric parameters as per the problem statement.\n    params = {\n        'L': 1.0,  # m\n        't': 0.01,  # m\n        'E': 30e9,  # Pa\n        'nu': 0.3,  # Poisson's ratio\n        'kappa_s': 5.0 / 6.0,  # Shear correction factor\n        'q': 1000.0,  # N/m^2\n        'k': 1000.0,  # N/m^3\n    }\n\n    # Test cases: (alpha, nx, ny)\n    test_cases = [\n        (1.0, 4, 4),\n        (1e-3, 4, 4),\n        (1e-6, 4, 4),\n        (1.0, 2, 2),\n        (1e-6, 2, 2),\n        (1e-6, 8, 8),\n    ]\n\n    results = []\n    for alpha, nx, ny in test_cases:\n        # Run simulation for Formulation A (Full Integration)\n        w_center_full = run_fem_analysis(nx, ny, alpha, 'full', params)\n        # Run simulation for Formulation B (Selective Reduced Integration)\n        w_center_sri = run_fem_analysis(nx, ny, alpha, 'sri', params)\n\n        if w_center_sri == 0:\n            locking_ratio = np.nan # Avoid division by zero\n        else:\n            # Ratios of displacements are the same regardless of sign convention.\n            locking_ratio = w_center_full / w_center_sri\n        results.append(locking_ratio)\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n\ndef run_fem_analysis(nx, ny, alpha, shear_integration_rule, params):\n    \"\"\"\n    Performs a single Finite Element Analysis for a given mesh, alpha, and integration rule.\n    \"\"\"\n    # Unpack parameters\n    L, t, E, nu, kappa_s, q, k_winkler = params['L'], params['t'], params['E'], params['nu'], params['kappa_s'], params['q'], params['k']\n\n    # --- Mesh Generation ---\n    num_nodes_x = nx + 1\n    num_nodes_y = ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_dofs = 3 * num_nodes\n    hx, hy = L / nx, L / ny\n\n    node_coords = np.zeros((num_nodes, 2))\n    for i in range(num_nodes_y):\n        for j in range(num_nodes_x):\n            node_idx = i * num_nodes_x + j\n            node_coords[node_idx] = [j * hx, i * hy]\n\n    elements = np.zeros((nx * ny, 4), dtype=int)\n    for i in range(ny):\n        for j in range(nx):\n            el_idx = i * nx + j\n            n1 = i * num_nodes_x + j\n            n2 = i * num_nodes_x + j + 1\n            n3 = (i + 1) * num_nodes_x + j + 1\n            n4 = (i + 1) * num_nodes_x + j\n            elements[el_idx] = [n1, n2, n3, n4]\n\n    # --- Constitutive Matrices ---\n    C_b = (E * t**3) / (12 * (1 - nu**2)) * np.array([[1, nu, 0], [nu, 1, 0], [0, 0, (1 - nu) / 2]])\n    G_eff = alpha * E / (2 * (1 + nu))\n    C_s = kappa_s * G_eff * t * np.identity(2)\n\n    # --- Gauss Quadrature Points and Weights ---\n    gauss_pts_1d = { 1: [(0.0, 2.0)], 2: [(-1/np.sqrt(3), 1.0), (1/np.sqrt(3), 1.0)] }\n    xi_eta_nodes = np.array([[-1, -1], [1, -1], [1, 1], [-1, 1]])\n\n    # --- FEM Assembly ---\n    K_global = np.zeros((num_dofs, num_dofs))\n    F_global = np.zeros(num_dofs)\n\n    def shape_functions(xi, eta):\n        N = 0.25 * (1 + xi_eta_nodes[:, 0] * xi) * (1 + xi_eta_nodes[:, 1] * eta)\n        dNdxi = 0.25 * xi_eta_nodes[:, 0] * (1 + xi_eta_nodes[:, 1] * eta)\n        dNdeta = 0.25 * xi_eta_nodes[:, 1] * (1 + xi_eta_nodes[:, 0] * xi)\n        return N, dNdxi, dNdeta\n\n    for el_nodes in elements:\n        k_elem = np.zeros((12, 12))\n        f_elem = np.zeros(12)\n        det_J = hx * hy / 4.0\n\n        # --- Bending, Winkler, and Force contributions (always 2x2 integration) ---\n        for xi_gp, w_xi in gauss_pts_1d[2]:\n            for eta_gp, w_eta in gauss_pts_1d[2]:\n                N, dNdxi, dNdeta = shape_functions(xi_gp, eta_gp)\n                dNdx = dNdxi * (2.0 / hx)\n                dNdy = dNdeta * (2.0 / hy)\n\n                B_b = np.zeros((3, 12))\n                N_w = np.zeros((1, 12))\n                for i in range(4):\n                    B_b[0, 3 * i + 1] = dNdx[i]\n                    B_b[1, 3 * i + 2] = dNdy[i]\n                    B_b[2, 3 * i + 1] = dNdy[i]\n                    B_b[2, 3 * i + 2] = dNdx[i]\n                    N_w[0, 3 * i] = N[i]\n                    f_elem[3 * i] += N[i] * q * det_J * w_xi * w_eta\n\n                k_elem += B_b.T @ C_b @ B_b * det_J * w_xi * w_eta\n                k_elem += k_winkler * N_w.T @ N_w * det_J * w_xi * w_eta\n        \n        # --- Shear contribution (full or SRI) ---\n        n_gp_shear = 2 if shear_integration_rule == 'full' else 1\n        for xi_gp, w_xi in gauss_pts_1d[n_gp_shear]:\n            for eta_gp, w_eta in gauss_pts_1d[n_gp_shear]:\n                N, dNdxi, dNdeta = shape_functions(xi_gp, eta_gp)\n                dNdx = dNdxi * (2.0 / hx)\n                dNdy = dNdeta * (2.0 / hy)\n                \n                B_s = np.zeros((2, 12))\n                for i in range(4):\n                    B_s[0, 3 * i] = dNdx[i]\n                    B_s[0, 3 * i + 1] = N[i]\n                    B_s[1, 3 * i] = dNdy[i]\n                    B_s[1, 3 * i + 2] = N[i]\n                \n                k_elem += B_s.T @ C_s @ B_s * det_J * w_xi * w_eta\n\n        # Assemble into global matrices\n        dof_map = (3 * np.repeat(el_nodes, 3)) + np.tile(np.arange(3), 4)\n        K_global[np.ix_(dof_map, dof_map)] += k_elem\n        F_global[dof_map] += f_elem\n\n    # --- Apply Boundary Conditions (Clamped) ---\n    boundary_nodes = set()\n    for i in range(num_nodes_y):\n        boundary_nodes.add(i * num_nodes_x)\n        boundary_nodes.add(i * num_nodes_x + num_nodes_x - 1)\n    for j in range(num_nodes_x):\n        boundary_nodes.add(j)\n        boundary_nodes.add((num_nodes_y - 1) * num_nodes_x + j)\n    \n    boundary_dofs = []\n    for node_idx in boundary_nodes:\n        boundary_dofs.extend([3 * node_idx, 3 * node_idx + 1, 3 * node_idx + 2])\n    \n    all_dofs = np.arange(num_dofs)\n    free_dofs = np.setdiff1d(all_dofs, boundary_dofs)\n\n    K_reduced = K_global[np.ix_(free_dofs, free_dofs)]\n    F_reduced = F_global[free_dofs]\n\n    # --- Solve System and Extract Result ---\n    try:\n        sol_reduced = linalg.solve(K_reduced, F_reduced)\n    except linalg.LinAlgError:\n        return np.nan\n\n    d_global = np.zeros(num_dofs)\n    d_global[free_dofs] = sol_reduced\n    \n    # Find central node displacement 'w'\n    center_node_idx_x = nx // 2\n    center_node_idx_y = ny // 2\n    center_node_global_idx = center_node_idx_y * num_nodes_x + center_node_idx_x\n    center_w_dof_idx = 3 * center_node_global_idx\n    \n    return d_global[center_w_dof_idx]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}