## Introduction
In [computational geomechanics](@entry_id:747617), the Finite Element Method (FEM) is a cornerstone for analyzing the complex behavior of soil and rock. The accuracy and efficiency of FEM simulations depend critically on the choice of element family used to approximate the [displacement field](@entry_id:141476). For the widely used quadrilateral and [hexahedral elements](@entry_id:174602), two primary families dominate: the robust but computationally intensive Lagrangian family and the economical Serendipity family. The decision between them is not trivial, representing a fundamental trade-off between computational cost and numerical fidelity. This article addresses this crucial choice by providing a comprehensive comparison. Across the following chapters, you will first learn the core mathematical theory in **Principles and Mechanisms**. Next, **Applications and Interdisciplinary Connections** will explore the practical consequences of these differences in various geomechanical scenarios. Finally, **Hands-On Practices** will offer exercises to solidify your understanding of their implementation and numerical behavior.

## Principles and Mechanisms

In the displacement-based Finite Element Method (FEM) for problems in geomechanics, the primary objective is to find an approximate solution to the governing [equations of equilibrium](@entry_id:193797). The underlying mathematical framework, or weak form, is typically set in a Sobolev space, most commonly the space $H^1(\Omega)$. This space consists of functions that are square-integrable and whose first derivatives are also square-integrable. A critical property for any function to belong to $H^1(\Omega)$ is that it must be continuous across the domain. When we construct a finite element solution by assembling [piecewise polynomial](@entry_id:144637) functions defined over a mesh of elements, this global continuity requirement translates into a local condition: the solution must be continuous across the boundaries shared by adjacent elements. This is known as **$C^0$ interelement continuity**. Finite element families that satisfy this condition are called **$H^1$-conforming**, a fundamental requirement for guaranteeing convergence to the true solution as the mesh is refined .

The construction of these [polynomial spaces](@entry_id:753582) depends heavily on the geometry of the [reference element](@entry_id:168425). For meshes built from hypercubes (quadrilaterals in two dimensions, hexahedra in three), the construction is naturally based on a tensor-product structure. For meshes built from [simplices](@entry_id:264881) (triangles in two dimensions, tetrahedra in three), the construction is based on polynomials of total degree. This chapter elucidates the principles and mechanisms behind the two most prominent element families for hypercubes: the **Lagrangian** and **Serendipity** families.

### The Lagrangian Family: A Tensor-Product Construction

The most straightforward way to construct [polynomial approximation](@entry_id:137391) spaces on a square or cube is through a [tensor product](@entry_id:140694) of one-dimensional [polynomial spaces](@entry_id:753582). Let us consider the one-dimensional reference interval $\hat{I} = [-1, 1]$. The space of polynomials of degree at most $k$, denoted $\mathcal{P}_k(\hat{I})$, is a vector space of dimension $k+1$, with a standard monomial basis being $\{1, \xi, \xi^2, \dots, \xi^k\}$.

To extend this to a two-dimensional reference square, $\hat{K} = [-1, 1]^2$, we form the tensor-product space, denoted $\mathcal{Q}_k(\hat{K})$. This space is defined as the set of all bivariate polynomials in coordinates $(\xi, \eta)$ where the degree in each coordinate separately is at most $k$. A basis for $\mathcal{Q}_k(\hat{K})$ can be formed by taking all possible products of the 1D basis monomials:
$$
\text{Basis}(\mathcal{Q}_k) = \{ \xi^i \eta^j \mid 0 \le i \le k, \text{ and } 0 \le j \le k \}
$$
The dimension of this space is the product of the dimensions of the constituent 1D spaces. For a $d$-dimensional hypercube $\hat{K} = [-1, 1]^d$, the dimension of the corresponding tensor-[product space](@entry_id:151533) $\mathcal{Q}_k(\hat{K})$ is therefore:
$$
\dim(\mathcal{Q}_k(\hat{K})) = (\dim(\mathcal{P}_k(\hat{I})))^d = (k+1)^d
$$
This formula reveals a rapid growth in the number of degrees of freedom (DOFs) with both polynomial degree $k$ and spatial dimension $d$. For instance, for a cubic element ($k=3$), a 2D quadrilateral ($d=2$) requires $(3+1)^2 = 16$ DOFs, while a 3D hexahedron ($d=3$) requires $(3+1)^3 = 64$ DOFs . These DOFs are typically associated with nodal values at points arranged in a regular $(k+1) \times (k+1)$ (in 2D) or $(k+1) \times (k+1) \times (k+1)$ (in 3D) grid on the [reference element](@entry_id:168425). For any degree $k \ge 2$, this grid necessarily includes nodes in the interior of the element.

The shape functions for these elements are constructed to facilitate interpolation. For any function $u(\xi, \eta)$ defined on the [reference element](@entry_id:168425), its interpolant $u_h$ is given by $u_h(\xi, \eta) = \sum_{a=1}^{N} u_a N_a(\xi, \eta)$, where $N$ is the number of nodes, $u_a$ is the value of the function at node $a$, and $N_a$ is the shape function associated with node $a$. These shape functions themselves belong to the space $\mathcal{Q}_k(\hat{K})$ and are defined by the **Kronecker delta property**: $N_a(\xi_b, \eta_b) = \delta_{ab}$, where $(\xi_b, \eta_b)$ are the coordinates of node $b$. This property ensures that the interpolant matches the function values exactly at the nodes.

Let's illustrate this with the simplest case: the bilinear [quadrilateral element](@entry_id:170172), $Q_1$ ($k=1$). The 1D linear Lagrange polynomials on $[-1,1]$ with nodes at $-1$ and $1$ are $\ell_1(\xi) = \frac{1-\xi}{2}$ and $\ell_2(\xi) = \frac{1+\xi}{2}$. The four 2D [shape functions](@entry_id:141015) for the $Q_1$ element, whose nodes are at the four corners $(\pm 1, \pm 1)$, are formed by taking the tensor products of these 1D functions :
- Node 1 $(-1, -1)$: $N_1(\xi, \eta) = \ell_1(\xi)\ell_1(\eta) = \frac{1}{4}(1-\xi)(1-\eta)$
- Node 2 $(1, -1)$: $N_2(\xi, \eta) = \ell_2(\xi)\ell_1(\eta) = \frac{1}{4}(1+\xi)(1-\eta)$
- Node 3 $(1, 1)$: $N_3(\xi, \eta) = \ell_2(\xi)\ell_2(\eta) = \frac{1}{4}(1+\xi)(1+\eta)$
- Node 4 $(-1, 1)$: $N_4(\xi, \eta) = \ell_1(\xi)\ell_2(\eta) = \frac{1}{4}(1-\xi)(1+\eta)$

These functions satisfy not only the Kronecker delta property but also the **[partition of unity](@entry_id:141893)** property: $\sum_{a=1}^{4} N_a(\xi, \eta) = 1$ for all $(\xi, \eta)$. This is a crucial property ensuring that the element can exactly represent a constant field, which is a prerequisite for passing the fundamental constant-strain patch test in mechanics .

### The Serendipity Family: An Economical Construction

While the Lagrangian family provides a systematic way to construct [higher-order elements](@entry_id:750328), the rapid growth in the number of DOFs, particularly interior DOFs, can lead to computationally expensive models. The **Serendipity** family of elements was developed to provide a more economical alternative. The core idea is to remove the interior nodes while retaining all boundary nodes (vertices, edges, and faces) to maintain $C^0$ conformity.

For a [quadrilateral element](@entry_id:170172) of order $k \ge 2$, the [serendipity element](@entry_id:754705) retains the 4 vertex nodes and adds $k-1$ nodes to the interior of each of the 4 edges. This results in a total number of nodes, and thus a space dimension, of :
$$
\dim(S_k) = 4 + 4(k-1) = 4k
$$
For the quadratic case ($k=2$), the [serendipity element](@entry_id:754705) ($S_2$) has $4 \times 2 = 8$ nodes (the four corners and four edge midpoints). This is one fewer than the 9-node Lagrangian element ($Q_2$). For the cubic case ($k=3$), the $S_3$ element has $4 \times 3 = 12$ nodes, a significant reduction from the 16 nodes of the $Q_3$ element. This reduction in DOFs, which becomes more pronounced in three dimensions, is the primary motivation for using the serendipity family.

### Characterizing Serendipity Spaces: The Polynomial Subspace

Since the dimension of the serendipity space $S_k$ is less than that of the Lagrangian space $Q_k$ (for $k \ge 2$), it must be that $S_k$ is a proper subspace of $Q_k$. The immediate question is: which polynomial modes are sacrificed to achieve this economy?

Let's again consider the quadratic case ($k=2$). The $Q_2$ space has dimension 9 and is spanned by the monomials $\{1, \xi, \eta, \xi^2, \xi\eta, \eta^2, \xi^2\eta, \xi\eta^2, \xi^2\eta^2\}$. The $S_2$ space has dimension 8. It is constructed to be unisolvent with the 8 boundary nodes. This is achieved by systematically removing a polynomial basis function that is associated with the interior node. The function that vanishes at all 8 boundary nodes of the $S_2$ element but is non-zero in the interior is related to the highest-order mixed monomial, $\xi^2\eta^2$. By removing this term from the basis of $Q_2$, we obtain the standard 8-dimensional space for the $S_2$ element :
$$
\text{Basis}(S_2) = \{1, \xi, \eta, \xi^2, \xi\eta, \eta^2, \xi^2\eta, \xi\eta^2\}
$$
A crucial observation is that this space still contains all monomials of *total degree* up to 2 (i.e., the space $\mathcal{P}_2 = \text{span}\{1, \xi, \eta, \xi^2, \xi\eta, \eta^2\}$). This ensures that the element can reproduce any [quadratic field](@entry_id:636261) and will achieve the optimal rate of convergence for smooth problems. The number of *quadratic monomials of total degree 2* that are missing from $S_2$ is therefore zero . The incompleteness of $S_2$ is relative to the *tensor-product* space $Q_2$, not the *total degree* space $\mathcal{P}_2$.

A more formal way to define the monomial content of the serendipity space $S_k$ is through the concept of **superlinear degree**. The superlinear degree of a monomial $\xi^i \eta^j$ is the sum of the exponents that are greater than or equal to 2. A monomial is included in $S_k$ if its superlinear degree is no more than $k$. For example, the superlinear degree of $\xi^3\eta^1$ is 3, so it is in $S_3$. The superlinear degree of $\xi^2\eta^2$ is $2+2=4$, so it is *not* in $S_3$. Using this rule, we can identify all monomials in $Q_3$ that are excluded from $S_3$. These are precisely the terms whose superlinear degree exceeds 3: $\{\xi^2\eta^2, \xi^2\eta^3, \xi^3\eta^2, \xi^3\eta^3\}$ .

This exclusion can also be understood through a hierarchical basis construction. A basis for $Q_k$ can be built from vertex functions, edge "bubble" functions, and face "bubble" functions. The face [bubble functions](@entry_id:176111) are those that vanish on the entire boundary of the element. The serendipity space $S_k$ is formed by retaining all vertex and edge functions but discarding all face (interior) [bubble functions](@entry_id:176111) .

### Implications for Approximation and Accuracy

The trade-off inherent in the serendipity family is one of computational cost versus approximation power.

First, because the space $S_k$ is a proper subspace of $Q_k$, a [serendipity element](@entry_id:754705) cannot exactly reproduce a polynomial field that lies in $Q_k$ but not in $S_k$. For example, an $S_3$ element cannot exactly represent a displacement field containing a term like $c \cdot \xi^2\eta^2$. While both $Q_k$ and $S_k$ pass the standard patch tests that require reproduction of linear fields, a higher-order patch test designed with a solution from the "missing" part of the [polynomial space](@entry_id:269905) would be failed by the [serendipity element](@entry_id:754705)  .

Second, and more subtly, the reduced polynomial content of [serendipity elements](@entry_id:171371) has consequences when combined with **[isoparametric mapping](@entry_id:173239)**. In this technique, the geometry of a physical element is mapped from the [reference element](@entry_id:168425) using the same shape functions used for interpolation. For a general, non-parallelogram quadrilateral, this mapping is non-affine and includes bilinear terms. When a physical field (e.g., a simple quadratic polynomial in physical coordinates $(x,y)$) is pulled back to the reference element, the composition with the non-affine map can generate high-order polynomial terms in the reference coordinates $(\xi, \eta)$. Specifically, a quadratic physical field mapped to a bilinear element will generally produce a polynomial on the [reference element](@entry_id:168425) that contains a non-zero $\xi^2\eta^2$ term. Since the $S_2$ space explicitly lacks the $\xi^2\eta^2$ monomial, it cannot exactly reproduce this [quadratic field](@entry_id:636261) on a general curved or distorted element. The full $Q_2$ element, which does contain $\xi^2\eta^2$, does not suffer from this particular limitation and is therefore more robust for problems involving distorted meshes .

Despite this reduced [polynomial completeness](@entry_id:177462), it is essential to recognize that [serendipity elements](@entry_id:171371) remain fully $H^1$-conforming. The trace of an $S_k$ polynomial on any edge is still a 1D polynomial of degree $k$, which is uniquely determined by the $k+1$ nodes on that edge. Since these boundary nodes are preserved, continuity across elements is guaranteed .

### The Simplex Anomaly: Why Serendipity is for Hypercubes

The concept of creating a "serendipity" element by removing interior nodes while preserving the full [polynomial space](@entry_id:269905) is unique to tensor-product elements. It is generally not possible for simplex elements like triangles and tetrahedra.

The standard Lagrangian family on a reference triangle uses the space $\mathcal{P}_k$ of polynomials of *total degree* at most $k$. The dimension of this space is $\binom{k+2}{2}$. For $k=2$, this gives $\dim(\mathcal{P}_2) = 6$, and a corresponding 6-node element can be constructed using only boundary nodes (3 vertices, 3 edge midpoints). However, for $k \ge 3$, the space $\mathcal{P}_k$ on a triangle contains at least one **cell [bubble function](@entry_id:179039)**â€”a non-zero polynomial that vanishes on the entire element boundary. The simplest is the cubic bubble $\lambda_1\lambda_2\lambda_3$, where $\lambda_i$ are the [barycentric coordinates](@entry_id:155488).

If one were to attempt to define a set of DOFs for $\mathcal{P}_3$ using only boundary nodes, these DOFs would all evaluate to zero on the [bubble function](@entry_id:179039). It would be impossible to distinguish the bubble from the zero function, violating the unisolvence requirement for a well-defined finite element. Therefore, to define an element whose space is the full $\mathcal{P}_k$ (for $k \ge 3$ on triangles or $k \ge 4$ on tetrahedra), at least one interior node is mandatory. A "serendipity-style" elimination of interior DOFs while retaining the full [polynomial space](@entry_id:269905) is fundamentally impossible for standard simplex families of higher order . This highlights that the serendipity construction is an elegant and powerful, yet specific, feature of elements built on tensor-product geometries.