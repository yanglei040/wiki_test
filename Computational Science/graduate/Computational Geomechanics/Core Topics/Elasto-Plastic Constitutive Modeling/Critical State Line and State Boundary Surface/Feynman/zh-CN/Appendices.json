{
    "hands_on_practices": [
        {
            "introduction": "在深入研究临界状态土力学之前，我们必须首先掌握其基本“语言”——应力不变量。任何复杂的三维应力状态都可以通过平均有效应力 $p'$、广义剪应力 $q$ 和洛德角 $\\theta$ 来描述，它们共同定义了应力点在海格-维斯特加德（Haigh–Westergaard）空间中的位置。这项练习  提供了从一个完整的应力张量计算这些关键不变量的实践，这是绘制应力路径和评估任何高等土体本构模型中状态边界面的基础技能。",
            "id": "3514410",
            "problem": "在与实验室坐标系对齐的坐标系中，一个土壤单元承受对称有效应力张量 $\\boldsymbol{\\sigma'}$（有效柯西应力），单位为千帕，其表达式为\n$$\n\\boldsymbol{\\sigma'} \\,=\\, \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} \\, .\n$$\n在Haigh–Westergaard应力空间中的临界状态线 (CSL) 和状态边界曲面 (SBS) 框架内，一个应力状态的位置由平均有效应力 $p'$、广义剪应力大小 $q$ 和参数化偏平面上位置的Lode角 $\\theta$ 来描述。从应力不变量和偏应力的核心定义出发，计算给定 $\\boldsymbol{\\sigma'}$ 的三元组 $(p', q, \\theta)$。其中，$p'$ 是 $\\boldsymbol{\\sigma'}$ 的第一不变量除以三，$q$ 是与 $\\boldsymbol{\\sigma'}$ 的第二偏应力不变量相关的剪应力大小，$\\theta$ 是与SBS偏平面的三维描述一致的有符号Lode角。使用土力学惯例，其中三轴压缩对应于 $\\theta = \\pi/6$，三轴拉伸对应于 $\\theta = -\\pi/6$，纯剪对应于 $\\theta = 0$。\n\n然后，使用 $\\theta$，通过比较与 $\\theta = \\pi/6$、$\\theta = -\\pi/6$ 和 $\\theta = 0$ 的绝对角距离，确定该应力状态最接近哪个子午线（三轴压缩、三轴拉伸或中间子午线）。\n\n报告 $p'$ 和 $q$ 的单位为 $\\mathrm{kPa}$，$\\theta$ 的单位为弧度。将 $p'$ 和 $q$ 四舍五入到四位有效数字，将 $\\theta$ 四舍五入到三位有效数字。在你最终的方框答案中，仅按顺序呈现包含 $(p', q, \\theta)$ 的数值行矩阵，不带单位。在你的推理过程中提供子午线分类，但不要将其包含在方框答案中。",
            "solution": "题目要求计算给定有效应力张量 $\\boldsymbol{\\sigma'}$ 的应力不变量 $(p', q, \\theta)$。这些量分别是平均有效应力 $p'$、广义剪应力 $q$ 和 Lode角 $\\theta$。\n\n给定的有效应力张量为：\n$$\n\\boldsymbol{\\sigma'} \\,=\\, \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} \\, \\mathrm{kPa}\n$$\n\n首先，我们计算平均有效应力 $p'$，其定义为应力张量第一不变量 $I_1(\\boldsymbol{\\sigma'})$ 的三分之一。第一不变量是张量的迹。\n$$\nI_1(\\boldsymbol{\\sigma'}) = \\mathrm{tr}(\\boldsymbol{\\sigma'}) = \\sigma'_{11} + \\sigma'_{22} + \\sigma'_{33}\n$$\n$$\nI_1(\\boldsymbol{\\sigma'}) = 450 + 380 + 310 = 1140 \\, \\mathrm{kPa}\n$$\n因此，平均有效应力为：\n$$\np' = \\frac{1}{3} I_1(\\boldsymbol{\\sigma'}) = \\frac{1140}{3} = 380 \\, \\mathrm{kPa}\n$$\n\n接下来，我们计算广义剪应力 $q$。这需要偏应力张量 $\\boldsymbol{s'}$，其定义为 $\\boldsymbol{s'} = \\boldsymbol{\\sigma'} - p'\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是 $3 \\times 3$ 的单位矩阵。\n$$\n\\boldsymbol{s'} = \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} - 380 \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{s'} = \\begin{pmatrix}\n450 - 380  35  -20 \\\\\n35  380 - 380  15 \\\\\n-20  15  310 - 380\n\\end{pmatrix} = \\begin{pmatrix}\n70  35  -20 \\\\\n35  0  15 \\\\\n-20  15  -70\n\\end{pmatrix} \\, \\mathrm{kPa}\n$$\n广义剪应力 $q$ 由偏应力张量的第二不变量 $J_2$ 定义。\n$$\nJ_2 = \\frac{1}{2} \\mathrm{tr}(\\boldsymbol{s'}^2) = \\frac{1}{2} s'_{ij} s'_{ji} = \\frac{1}{2} \\left( (s'_{11})^2 + (s'_{22})^2 + (s'_{33})^2 + 2\\left((s'_{12})^2 + (s'_{23})^2 + (s'_{31})^2\\right) \\right)\n$$\n代入 $\\boldsymbol{s'}$ 的分量：\n$$\nJ_2 = \\frac{1}{2} \\left( 70^2 + 0^2 + (-70)^2 + 2(35^2 + 15^2 + (-20)^2) \\right)\n$$\n$$\nJ_2 = \\frac{1}{2} \\left( 4900 + 4900 + 2(1225 + 225 + 400) \\right) = \\frac{1}{2} \\left( 9800 + 2(1850) \\right)\n$$\n$$\nJ_2 = \\frac{1}{2} (9800 + 3700) = \\frac{13500}{2} = 6750 \\, \\mathrm{kPa}^2\n$$\n广义剪应力 $q$ 定义为：\n$$\nq = \\sqrt{3 J_2} = \\sqrt{3 \\times 6750} = \\sqrt{20250} = \\sqrt{2025 \\times 10} = 45\\sqrt{10} \\, \\mathrm{kPa}\n$$\n数值上，$q \\approx 142.3025 \\, \\mathrm{kPa}$。\n\n为了求Lode角 $\\theta$，我们首先计算偏应力张量的第三不变量，$J_3 = \\det(\\boldsymbol{s'})$。\n$$\nJ_3 = \\det \\begin{pmatrix}\n70  35  -20 \\\\\n35  0  15 \\\\\n-20  15  -70\n\\end{pmatrix}\n$$\n$$\nJ_3 = 70(0 \\cdot (-70) - 15 \\cdot 15) - 35(35 \\cdot (-70) - 15 \\cdot (-20)) - 20(35 \\cdot 15 - 0 \\cdot (-20))\n$$\n$$\nJ_3 = 70(-225) - 35(-2450 + 300) - 20(525)\n$$\n$$\nJ_3 = -15750 - 35(-2150) - 10500 = -15750 + 75250 - 10500 = 49000 \\, \\mathrm{kPa}^3\n$$\nLode角 $\\theta$ 的定义需符合给定的三轴压缩 ($\\theta = \\pi/6$) 和三轴拉伸 ($\\theta = -\\pi/6$) 的惯例。适当的公式是：\n$$\n\\sin(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{(J_2)^{3/2}}\n$$\n我们计算反正弦函数的自变量：\n$$\n\\frac{3\\sqrt{3}}{2} \\frac{J_3}{(J_2)^{3/2}} = \\frac{3\\sqrt{3}}{2} \\frac{49000}{(6750)^{3/2}} = \\frac{3\\sqrt{3} \\times 49000}{2 \\times (6750 \\sqrt{6750})} = \\frac{147000\\sqrt{3}}{2 \\times 101250\\sqrt{30}} = \\frac{147000\\sqrt{3}}{202500\\sqrt{30}} = \\frac{1470}{2025\\sqrt{10}}\n$$\n化简分数 $\\frac{1470}{2025} = \\frac{98}{135}$。\n$$\n\\sin(3\\theta) = \\frac{98}{135\\sqrt{10}} \\approx 0.2295535\n$$\n求解 $\\theta$：\n$$\n3\\theta = \\arcsin\\left(\\frac{98}{135\\sqrt{10}}\\right) \\approx \\arcsin(0.2295535) \\approx 0.231575 \\, \\mathrm{rad}\n$$\n$$\n\\theta = \\frac{1}{3} \\arcsin\\left(\\frac{98}{135\\sqrt{10}}\\right) \\approx \\frac{0.231575}{3} \\approx 0.077192 \\, \\mathrm{rad}\n$$\n将结果四舍五入到指定精度：\n- $p'$ 保留四位有效数字：$380.0 \\, \\mathrm{kPa}$。\n- $q$ 保留四位有效数字：$142.3 \\, \\mathrm{kPa}$。\n- $\\theta$ 保留三位有效数字：$0.0772 \\, \\mathrm{rad}$。\n\n应力不变量三元组为 $(p', q, \\theta) \\approx (380.0, 142.3, 0.0772)$。\n\n最后，我们通过比较计算出的 $\\theta$ 与三轴压缩 ($\\theta_{TC} = \\pi/6$)、三轴拉伸 ($\\theta_{TE} = -\\pi/6$) 和纯剪 ($\\theta_{PS} = 0$) 子午线的绝对角距离，来确定该应力状态最接近哪个子午线。\n$$\n\\theta \\approx 0.0772 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{TC} = \\frac{\\pi}{6} \\approx 0.5236 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{TE} = -\\frac{\\pi}{6} \\approx -0.5236 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{PS} = 0 \\, \\mathrm{rad}\n$$\n绝对角距离为：\n- 与TC子午线的距离：$|\\theta - \\theta_{TC}| \\approx |0.0772 - 0.5236| = 0.4464 \\, \\mathrm{rad}$。\n- 与TE子午线的距离：$|\\theta - \\theta_{TE}| \\approx |0.0772 - (-0.5236)| = 0.6008 \\, \\mathrm{rad}$。\n- 与PS子午线的距离：$|\\theta - \\theta_{PS}| \\approx |0.0772 - 0| = 0.0772 \\, \\mathrm{rad}$。\n\n最小的距离是到纯剪子午线 ($\\theta = 0$) 的距离。因此，给定的应力状态最接近纯剪或中间子午线。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n380.0  142.3  0.0772\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论概念的价值最终体现在其计算应用中。临界状态在理论上由恒定的应力比和零塑性体积应变率来定义，但在数值模拟中，这些条件是渐近达成的，并且会受到数值噪声的干扰。这项练习  将理论与实践相结合，要求你设计一个稳健的算法，在有限元模拟的积分点上自动检测临界状态的到达。这不仅是对临界状态物理意义的深化理解，更是将理论转化为实用代码的关键一步，锻炼了处理数值不稳定性和避免“假阳性”检测的工程判断力。",
            "id": "3514403",
            "problem": "给定一个有限元单元单积分点的增量应力-应变响应数据序列，该序列由平均有效应力 $p'$（单位为 $\\mathrm{kPa}$）、偏应力 $q$（单位为 $\\mathrm{kPa}$）和塑性体积应变增量 $d\\varepsilon_v^p$（无量纲）的数组表示。目标是通过监测两个指标并应用鲁棒的阈值来自动检测临界状态线（CSL），以避免在有限元模拟中出现误报。临界状态线（CSL）和状态边界曲面（SBS）是临界状态土力学中的概念：在临界状态下，$q$ 和 $p'$ 满足一个由摩擦阻力控制的恒定应力比关系，且塑性体积增量趋于零。\n\n基本原理和定义：\n- 平均有效应力 $p'$ 和偏应力 $q$ 是用于表征土体响应的应力不变量。CSL 的特征是一个恒定的应力比参数 $M$（无量纲），使得在临界状态下，应力对位于 $(p',q)$ 平面的一条直线上。我们定义在增量索引 $t$ 处的归一化 CSL 偏差为\n$$\n\\phi_t = \\frac{\\left| q_t - M\\,p'_t \\right|}{\\max\\left(p'_t,\\,p_{\\mathrm{floor}}\\right)},\n$$\n其中 $p_{\\mathrm{floor}}$ 是一个下限，以防止除以过小的 $p'$。\n- 塑性体积应变增量的大小为\n$$\nv_t = \\left| d\\varepsilon_{v,t}^p \\right|.\n$$\n- 鲁棒的检测应要求持续性和平滑性，以避免因数值噪声、瞬时尖峰或围压消失而可能引起的误报。为此，如果存在一个包含 $k$ 个增量的连续窗口，且该窗口满足以下所有条件，则宣布检测成功：\n    1. 窗口内所有增量的 $\\phi_t \\le \\tau_{\\mathrm{CSL}}$。\n    2. 窗口内所有增量的 $v_t \\le \\tau_{\\mathrm{vol}}$。\n    3. 窗口内所有增量的 $p'_t \\ge p_{\\mathrm{det,min}}$。\n    4. 窗口内 CSL 偏差的跨度受以下条件限制\n    $$\n    \\max(\\text{窗口内}\\ \\phi_t) - \\min(\\text{窗口内}\\ \\phi_t) \\le s_{\\max}.\n    $$\n\n所有测试用例中使用的阈值和参数：\n- CSL 偏差容差 $\\tau_{\\mathrm{CSL}} = 0.03$（无量纲）。\n- 体积增量容差 $\\tau_{\\mathrm{vol}} = 5\\times 10^{-7}$（无量纲）。\n- 归一化下限 $p_{\\mathrm{floor}} = 10.0$ $\\mathrm{kPa}$。\n- 最小检测围压 $p_{\\mathrm{det,min}} = 20.0$ $\\mathrm{kPa}$。\n- 持续长度 $k = 3$ 个增量。\n- 平滑度界限 $s_{\\max} = 0.015$（无量纲）。\n\n检测规则输出：\n- 对于每个测试用例，输出一个布尔值：如果存在一个包含 $k$ 个连续增量的窗口满足上述所有四个条件，则为 $True$；否则为 $False$。\n\n角度单位不适用于此问题。应力值必须以 $\\mathrm{kPa}$ 为单位处理，应变增量为无量纲。\n\n测试套件：\n为以下 $6$ 个测试用例提供结果。每个用例包含一个参数 $M$（无量纲），以及数组 $p'$（单位为 $\\mathrm{kPa}$）、$q$（单位为 $\\mathrm{kPa}$）和 $d\\varepsilon_v^p$（无量纲）。这些数组是增量的有序序列；请在长度为 $k$ 的连续窗口上应用检测标准。\n\n- 用例 1（理想路径；持续趋近 CSL 且 $d\\varepsilon_v^p$ 消失）：\n    - $M = 1.25$\n    - $p' = [50,\\,60,\\,70,\\,80,\\,90,\\,100,\\,100,\\,100]$\n    - $q = [1.25\\cdot 50 + 5,\\,1.25\\cdot 60 + 3,\\,1.25\\cdot 70 + 2.8,\\,1.25\\cdot 80 + 2.4,\\,1.25\\cdot 90 + 1.8,\\,1.25\\cdot 100 + 1.5,\\,1.25\\cdot 100 + 1.2,\\,1.25\\cdot 100 + 1.0]$\n    - $d\\varepsilon_v^p = [-8\\times 10^{-6},\\,-6\\times 10^{-6},\\,-4\\times 10^{-6},\\,-2\\times 10^{-6},\\,-1\\times 10^{-6},\\,-5\\times 10^{-7},\\,-4\\times 10^{-7},\\,-3\\times 10^{-7}]$\n- 用例 2（低围压；通过 $p' \\ge p_{\\mathrm{det,min}}$ 要求避免误报）：\n    - $M = 1.25$\n    - $p' = [8,\\,9,\\,10,\\,12,\\,15]$\n    - $q = [1.25\\cdot 8 + 0.2,\\,1.25\\cdot 9 + 0.225,\\,1.25\\cdot 10 + 0.25,\\,1.25\\cdot 12 + 0.3,\\,1.25\\cdot 15 + 0.3]$\n    - $d\\varepsilon_v^p = [-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7}]$\n- 用例 3（瞬时接近 CSL，但 $d\\varepsilon_v^p$ 不具持续性）：\n    - $M = 1.2$\n    - $p' = [80,\\,80,\\,80,\\,80,\\,80]$\n    - $q = [1.2\\cdot 80 + 2.5,\\,1.2\\cdot 80 + 2.0,\\,1.2\\cdot 80 + 1.8,\\,1.2\\cdot 80 + 4.0,\\,1.2\\cdot 80 + 3.8]$\n    - $d\\varepsilon_v^p = [-4\\times 10^{-6},\\,-6\\times 10^{-6},\\,-4\\times 10^{-7},\\,-6\\times 10^{-6},\\,-6\\times 10^{-6}]$\n- 用例 4（在应力空间中接近 CSL，但由于 $d\\varepsilon_v^p$ 不为零而未达到临界状态）：\n    - $M = 1.3$\n    - $p' = [70,\\,80,\\,90,\\,100]$\n    - $q = [1.3\\cdot 70 + 1.0,\\,1.3\\cdot 80 + 1.0,\\,1.3\\cdot 90 + 1.0,\\,1.3\\cdot 100 + 1.0]$\n    - $d\\varepsilon_v^p = [1\\times 10^{-5},\\,1\\times 10^{-5},\\,8\\times 10^{-6},\\,7\\times 10^{-6}]$\n- 用例 5（边界情况；等于阈值应视为检测成功）：\n    - $M = 1.25$\n    - $p' = [100,\\,100,\\,100]$\n    - $q = [1.25\\cdot 100 + 3.0,\\,1.25\\cdot 100 + 3.0,\\,1.25\\cdot 100 + 3.0]$\n    - $d\\varepsilon_v^p = [-5\\times 10^{-7},\\,-5\\times 10^{-7},\\,-5\\times 10^{-7}]$\n- 用例 6（窗口内 CSL 偏差含噪声；因平滑度界限被拒绝）：\n    - $M = 1.25$\n    - $p' = [90,\\,95,\\,100,\\,100,\\,100]$\n    - $q = [1.25\\cdot 90 + 5.0,\\,1.25\\cdot 95 + 3.0,\\,1.25\\cdot 100 + 2.0,\\,1.25\\cdot 100 + 1.0,\\,1.25\\cdot 100 + 2.8]$\n    - $d\\varepsilon_v^p = [-1\\times 10^{-6},\\,-8\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7}]$\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如 $[result_1,result_2,\\dots,result_6]$），其中每个 $result_i$ 是一个布尔值，表示相应测试用例的检测结果。\n\n根据上述定义和阈值实施检测。程序必须是自包含的，且不得要求任何用户输入。",
            "solution": "该问题要求在计算岩土力学背景下，根据增量应力-应变数据实现一种鲁棒的算法，以检测是否达到临界状态线（CSL）。检测必须基于在连续数据窗口上应用的四个特定条件，以确保持续性和平滑性，从而避免误报。\n\n基本物理原理是，在临界状态下，土单元在恒定体积和恒定应力下变形。由平均有效应力 $p'$ 和偏应力 $q$ 定义的应力状态位于 CSL 上，这是 $(p', q)$ 平面中由恒定应力比 $M$ 定义的一条直线：$q = M p'$。恒定体积变形意味着塑性体积应变增量 $d\\varepsilon_v^p$ 趋近于零。\n\n该算法将使用给定的数据和阈值系统地验证这些原理。对于每个测试用例，我们都给定了 CSL 参数 $M$，以及 $p'_t$、$q_t$ 和 $d\\varepsilon_{v,t}^p$ 的时间序列。检测逻辑基于分析一个 $k=3$ 个连续增量的滑动窗口。\n\n首先，我们为每个增量 $t$ 定义并计算两个关键指标：\n1.  归一化的 CSL 偏差 $\\phi_t$，衡量应力状态 $(p'_t, q_t)$ 距离 CSL 的远近。其公式为\n    $$\n    \\phi_t = \\frac{\\left| q_t - M\\,p'_t \\right|}{\\max\\left(p'_t,\\,p_{\\mathrm{floor}}\\right)}\n    $$\n    其中 $p_{\\mathrm{floor}} = 10.0\\,\\mathrm{kPa}$ 是一个归一化下限，用于处理低围压应力。较小的 $\\phi_t$ 表示接近 CSL。\n\n2.  塑性体积应变增量的大小 $v_t$，量化了体积变化的速率。其公式为\n    $$\n    v_t = \\left| d\\varepsilon_{v,t}^p \\right|\n    $$\n    较小的 $v_t$ 表示材料正在接近恒定体积变形状态。\n\n有了这些指标，检测规则如下：如果存在至少一个包含 $k=3$ 个增量的连续窗口同时满足以下所有四个条件，则检测到临界状态：\n1.  **CSL 偏差条件**：窗口中所有 $t$ 的 $\\phi_t \\le \\tau_{\\mathrm{CSL}}$。阈值为 $\\tau_{\\mathrm{CSL}} = 0.03$。\n2.  **体积应变条件**：窗口中所有 $t$ 的 $v_t \\le \\tau_{\\mathrm{vol}}$。阈值为 $\\tau_{\\mathrm{vol}} = 5 \\times 10^{-7}$。\n3.  **围压条件**：窗口中所有 $t$ 的 $p'_t \\ge p_{\\mathrm{det,min}}$。最小围压为 $p_{\\mathrm{det,min}} = 20.0\\,\\mathrm{kPa}$。这可以防止在接近零应力时出现伪检测。\n4.  **平滑度条件**：$\\max(\\text{窗口内}\\ \\phi_t) - \\min(\\text{窗口内}\\ \\phi_t) \\le s_{\\max}$。这确保了 CSL 偏差在窗口内不会过于嘈杂，最大跨度为 $s_{\\max} = 0.015$。\n\n算法流程是为每个测试用例遍历所有可能的尺寸为 $k=3$ 的窗口。对于一个包含 $N$ 个增量的序列，窗口索引从 $[0, 1, 2]$ 到 $[N-3, N-2, N-1]$。如果任何一个窗口满足所有四个标准，则该测试用例的结果为 `True`。如果检查完所有窗口后，没有一个满足标准，则结果为 `False`。\n\n让我们用两个例子来说明：\n\n**用例 1（检测成功）：**\n给定 $M=1.25$ 以及 $p'$、$q$ 和 $d\\varepsilon_v^p$ 的数组。\n计算出的 $\\phi_t$ 和 $v_t$ 序列为：\n$\\phi = [0.1, 0.05, 0.04, 0.03, 0.02, 0.015, 0.012, 0.01]$\n$v = [8 \\times 10^{-6}, 6 \\times 10^{-6}, 4 \\times 10^{-6}, 2 \\times 10^{-6}, 1 \\times 10^{-6}, 5 \\times 10^{-7}, 4 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\n我们测试最后一个可能的窗口，覆盖增量 $t=5, 6, 7$。\n- 窗口数据：\n  - $p' = [100, 100, 100]\\,\\mathrm{kPa}$\n  - $\\phi = [0.015, 0.012, 0.01]$\n  - $v = [5 \\times 10^{-7}, 4 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\n- 检查条件：\n  1. $\\phi_t \\le 0.03$：所有值 $[0.015, 0.012, 0.01]$ 均 $\\le 0.03$。（通过）\n  2. $v_t \\le 5 \\times 10^{-7}$：所有值 $[5 \\times 10^{-7}, 4 \\times 10^{-7}, 3 \\times 10^{-7}]$ 均 $\\le 5 \\times 10^{-7}$。（通过）\n  3. $p'_t \\ge 20.0\\,\\mathrm{kPa}$：所有值均为 $100.0\\,\\mathrm{kPa}$，$\\ge 20.0\\,\\mathrm{kPa}$。（通过）\n  4. 平滑度：$\\max(\\phi) - \\min(\\phi) = 0.015 - 0.01 = 0.005$。这 $\\le s_{\\max}=0.015$。（通过）\n\n由于所有四个条件都满足，用例 1 的检测成功。结果：`True`。\n\n**用例 6（因平滑度而失败）：**\n给定 $M=1.25$ 以及 $p'$、$q$ 和 $d\\varepsilon_v^p$ 的数组。\n计算出的指标序列为：\n$\\phi \\approx [0.0556, 0.0316, 0.02, 0.01, 0.028]$\n$v = [1 \\times 10^{-6}, 8 \\times 10^{-7}, 3 \\times 10^{-7}, 3 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\n前两个窗口不满足 $\\phi_t \\le\\tau_{\\mathrm{CSL}}$ 条件。我们检查最后一个窗口，覆盖增量 $t=2, 3, 4$。\n- 窗口数据：\n  - $p' = [100, 100, 100]\\,\\mathrm{kPa}$\n  - $\\phi = [0.02, 0.01, 0.028]$\n  - $v = [3 \\times 10^{-7}, 3 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\n- 检查条件：\n  1. $\\phi_t \\le 0.03$：所有值 $[0.02, 0.01, 0.028]$ 均 $\\le 0.03$。（通过）\n  2. $v_t \\le 5 \\times 10^{-7}$：所有值均为 $3 \\times 10^{-7}$，$\\le 5 \\times 10^{-7}$。（通过）\n  3. $p'_t \\ge 20.0\\,\\mathrm{kPa}$：所有值均为 $100.0\\,\\mathrm{kPa}$，$\\ge 20.0\\,\\mathrm{kPa}$。（通过）\n  4. 平滑度：$\\max(\\phi) - \\min(\\phi) = 0.028 - 0.01 = 0.018$。这不 $\\le s_{\\max}=0.015$。（失败）\n\n因为平滑度条件不满足，这个窗口被拒绝。由于没有其他窗口满足所有条件，用例 6 的检测失败。结果：`False`。\n\n这种跨滑动窗口的、系统的、多条件的检查方法为 CSL 检测提供了一种预期的鲁棒方法。实现将对所有提供的测试用例遵循此逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run CSL detection on all test cases and print results.\n    \"\"\"\n    \n    # Thresholds and parameters\n    params = {\n        'tau_csl': 0.03,\n        'tau_vol': 5e-7,\n        'p_floor': 10.0,\n        'p_det_min': 20.0,\n        'k': 3,\n        's_max': 0.015,\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        {\n            'M': 1.25,\n            'p_prime': np.array([50., 60., 70., 80., 90., 100., 100., 100.]),\n            'q': np.array([1.25*50+5, 1.25*60+3, 1.25*70+2.8, 1.25*80+2.4, 1.25*90+1.8, 1.25*100+1.5, 1.25*100+1.2, 1.25*100+1.0]),\n            'd_eps_v_p': np.array([-8e-6, -6e-6, -4e-6, -2e-6, -1e-6, -5e-7, -4e-7, -3e-7]),\n        },\n        # Case 2 (low confinement)\n        {\n            'M': 1.25,\n            'p_prime': np.array([8., 9., 10., 12., 15.]),\n            'q': np.array([1.25*8+0.2, 1.25*9+0.225, 1.25*10+0.25, 1.25*12+0.3, 1.25*15+0.3]),\n            'd_eps_v_p': np.array([-3e-7, -3e-7, -3e-7, -3e-7, -3e-7]),\n        },\n        # Case 3 (transient near-CSL)\n        {\n            'M': 1.2,\n            'p_prime': np.array([80., 80., 80., 80., 80.]),\n            'q': np.array([1.2*80+2.5, 1.2*80+2.0, 1.2*80+1.8, 1.2*80+4.0, 1.2*80+3.8]),\n            'd_eps_v_p': np.array([-4e-6, -6e-6, -4e-7, -6e-6, -6e-6]),\n        },\n        # Case 4 (non-vanishing d_eps_v_p)\n        {\n            'M': 1.3,\n            'p_prime': np.array([70., 80., 90., 100.]),\n            'q': np.array([1.3*70+1.0, 1.3*80+1.0, 1.3*90+1.0, 1.3*100+1.0]),\n            'd_eps_v_p': np.array([1e-5, 1e-5, 8e-6, 7e-6]),\n        },\n        # Case 5 (boundary case)\n        {\n            'M': 1.25,\n            'p_prime': np.array([100., 100., 100.]),\n            'q': np.array([1.25*100+3.0, 1.25*100+3.0, 1.25*100+3.0]),\n            'd_eps_v_p': np.array([-5e-7, -5e-7, -5e-7]),\n        },\n        # Case 6 (noisy, fails smoothness)\n        {\n            'M': 1.25,\n            'p_prime': np.array([90., 95., 100., 100., 100.]),\n            'q': np.array([1.25*90+5.0, 1.25*95+3.0, 1.25*100+2.0, 1.25*100+1.0, 1.25*100+2.8]),\n            'd_eps_v_p': np.array([-1e-6, -8e-7, -3e-7, -3e-7, -3e-7]),\n        },\n    ]\n\n    def check_csl_detection(case, params):\n        \"\"\"\n        Checks for CSL detection for a single case.\n        \"\"\"\n        M = case['M']\n        p_prime = case['p_prime']\n        q = case['q']\n        d_eps_v_p = case['d_eps_v_p']\n        \n        k = params['k']\n        tau_csl = params['tau_csl']\n        tau_vol = params['tau_vol']\n        p_floor = params['p_floor']\n        p_det_min = params['p_det_min']\n        s_max = params['s_max']\n\n        num_increments = len(p_prime)\n        if num_increments  k:\n            return False\n\n        # Calculate indicator arrays\n        phi = np.abs(q - M * p_prime) / np.maximum(p_prime, p_floor)\n        v = np.abs(d_eps_v_p)\n\n        # Sliding window check\n        for i in range(num_increments - k + 1):\n            window_slice = slice(i, i + k)\n            \n            p_window = p_prime[window_slice]\n            phi_window = phi[window_slice]\n            v_window = v[window_slice]\n\n            # 1. CSL deviation condition\n            cond1 = np.all(phi_window = tau_csl)\n            \n            # 2. Volumetric strain condition\n            cond2 = np.all(v_window = tau_vol)\n\n            # 3. Confinement condition\n            cond3 = np.all(p_window = p_det_min)\n\n            # 4. Smoothness condition\n            spread = np.max(phi_window) - np.min(phi_window)\n            cond4 = spread = s_max\n            \n            if cond1 and cond2 and cond3 and cond4:\n                return True\n        \n        return False\n\n    results = []\n    for case in test_cases:\n        result = check_csl_detection(case, params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个本构模型的预测能力取决于其参数的准确性。这个高级练习  模拟了计算建模者的核心任务：参数标定。你将面对一个逆向问题，即从模拟离散元方法（DEM）得到的合成数据中，反演临界状态模型的宏观参数 $M$ 和 $\\Gamma$。此练习的挑战不仅在于建立微观力学行为与宏观响应的联系，更在于从第一性原理出发，为包含非恒定方差（异方差性）的噪声数据推导并实施正确的估计算法，这是在模型校准中获得可靠结果的关键统计技能。",
            "id": "3514412",
            "problem": "您的任务是在计算地质力学中构建并求解一个反问题，以从代表离散元法（DEM）三轴模拟的合成数据中识别临界状态参数。宏观临界状态线和正常压缩关系由临界状态土力学框架通过两个核心定义在单元尺度上定义：偏应力关系 $q = M p'$ 和比容关系 $v = \\Gamma - \\lambda \\ln p'$，其中 $q$ 和 $p'$ 是应力，$v$ 是比容，$M$ 和 $\\Gamma$ 是无量纲材料参数，$\\lambda$ 是正常压缩线在 $(v, \\ln p')$ 空间中的斜率。在本问题中，这些关系被视为本构定义，目标是从包含微观力学影响的正演模型生成的含噪合成数据中恢复宏观参数 $M$ 和 $\\Gamma$。\n\n您必须从反问题和最小二乘估计的第一性原理出发，考虑与数据生成一致的测量误差结构。您的算法必须生成可复现且具有物理解释性的稳健估计。\n\n为生成类似DEM的合成数据，假设以下正演模型假定：\n- 应力 $q$ 和 $p'$ 的单位是千帕（kPa）。比容 $v$ 是无量纲的。参数 $M$ 和 $\\Gamma$ 是无量纲的。\n- 真实的基准宏观参数为 $M_0 = 1.2$，$\\Gamma_0 = 1.95$，以及 $\\lambda = 0.12$。\n- 微观参数为颗粒摩擦系数 $\\mu$（无量纲）和法向接触刚度 $k_n$（单位为牛顿/米，N/m）。参考值为 $\\mu_{\\mathrm{ref}} = 0.5$ 和 $k_{\\mathrm{ref}} = 10^5$。\n- 微观到宏观的敏感性被建模为 $\\mu$ 的线性函数和 $k_n$ 的对数函数，使用以下有效参数：\n  $$M_{\\mathrm{eff}}(\\mu, k_n) = M_0 + s_\\mu \\left(\\mu - \\mu_{\\mathrm{ref}}\\right) + s_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right),$$\n  $$\\Gamma_{\\mathrm{eff}}(\\mu, k_n) = \\Gamma_0 + t_\\mu \\left(\\mu - \\mu_{\\mathrm{ref}}\\right) + t_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right),$$\n  固定敏感性系数为 $s_\\mu = 0.6$，$s_k = 0.03$，$t_\\mu = -0.02$，$t_k = -0.01$。\n- 对于每个测试案例，在平均有效应力\n  $$p'_i \\in \\{50, 75, 100, 150, 200, 250, 300, 350, 400\\}\\ \\text{kPa},$$\n  下生成 $N$ 个数据点，形成一个包含 $N = 9$ 个值（单位 kPa）的数组。\n- 相应的无噪声宏观响应为\n  $$q_i^{\\ast} = M_{\\mathrm{eff}}(\\mu, k_n)\\, p'_i,$$\n  $$v_i^{\\ast} = \\Gamma_{\\mathrm{eff}}(\\mu, k_n) - \\lambda \\ln p'_i.$$\n- 应用附加噪声以反映真实的异方差性：\n  $$q_i = q_i^{\\ast} + \\varepsilon_{q,i}, \\quad \\varepsilon_{q,i} \\sim \\mathcal{N}\\left(0, \\sigma_q^2\\, (p'_i)^2\\right), \\quad \\sigma_q = 0.02,$$\n  $$v_i = v_i^{\\ast} + \\varepsilon_{v,i}, \\quad \\varepsilon_{v,i} \\sim \\mathcal{N}\\left(0, \\sigma_v^2\\right), \\quad \\sigma_v = 0.005.$$\n  为保证可复现性，所有随机性必须使用等于 $42$ 的固定种子确定性地生成。对 $\\ln(\\cdot)$ 使用自然对数。\n\n您的任务：\n1. 对于每个测试案例，从第一性原理出发，通过求解一个考虑了 $\\varepsilon_{q,i}$ 非恒定方差的加权最小二乘问题（模型为 $q_i \\approx M p'_i$），来推导并实现 $M$ 的估计量。您的推导必须从最小化由噪声方差的倒数加权的残差平方和的原理开始，并且不得假设任何闭式解快捷方式。将您实现的最终估计量表示为相应正规方程的解。\n2. 对于每个测试案例，从第一性原理出发，在 $\\varepsilon_{v,i}$ 方差恒定的假设下，通过求解一个普通最小二乘问题（模型为 $v_i \\approx \\Gamma - \\lambda \\ln p'_i$），来推导并实现 $\\Gamma$ 的估计量。展示如何将其转换为仅截距估计问题，并从最小化残差平方和中推导出相应的估计量。\n\n测试套件：\n- 使用以下五个微观参数案例来探究宏观敏感性：\n  - 案例A（参考）：$(\\mu, k_n) = (0.5, 10^5)$。\n  - 案例B（低摩擦）：$(\\mu, k_n) = (0.3, 10^5)$。\n  - 案例C（高摩擦）：$(\\mu, k_n) = (0.7, 10^5)$。\n  - 案例D（低刚度）：$(\\mu, k_n) = (0.5, 3 \\times 10^4)$。\n  - 案例E（高刚度）：$(\\mu, k_n) = (0.5, 10^6)$。\n\n计算要求：\n- 严格按照上述模型实现合成数据生成，使用提供的确切常数、kPa的应力单位以及固定的随机种子 $42$。\n- 实现任务1和2中推导的反演估计量。不要使用黑盒回归程序；直接从正规方程计算估计量。\n- 对于每个案例，报告恢复的参数 $(\\widehat{M}, \\widehat{\\Gamma})$ 为无量纲数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试案例的结果，形式为方括号内以逗号分隔的列表。\n- 列表必须包含10个浮点数，顺序为 $[\\widehat{M}_A, \\widehat{\\Gamma}_A, \\widehat{M}_B, \\widehat{\\Gamma}_B, \\widehat{M}_C, \\widehat{\\Gamma}_C, \\widehat{M}_D, \\widehat{\\Gamma}_D, \\widehat{M}_E, \\widehat{\\Gamma}_E]$。\n- 每个数字必须四舍五入到5位小数。\n- 所有报告的值都是无量纲的。不应打印其他任何文本。\n\n注意：\n- 通过保持在所提供的kPa应力范围内并使用指定的噪声结构来确保科学真实性。\n- 本问题不使用角度。\n- 不要将任何结果表示为百分比；所有输出必须是原始十进制数。\n\n程序必须完全自包含，无需任何输入。它必须确定性地执行并完全按照规定生成最终输出行。",
            "solution": "该问题要求构建并求解一个反问题，以从合成数据中确定临界状态土模型的两个宏观参数 $M$ 和 $\\Gamma$。生成合成数据是为了模拟离散元法（DEM）三轴模拟的输出，包括微观力学敏感性和真实的测量噪声。解决方案涉及从最小二乘估计的第一性原理推导 $M$ 和 $\\Gamma$ 的估计量，并实现它们以针对几个测试案例恢复这些参数。\n\n问题的结构如下：首先，一个正演模型生成合成数据 $(p'_i, q_i, v_i)$，其中 $i=1, \\dots, N$。这些数据结合了确定性的本构关系和随机噪声。其次，对这些含噪数据应用一个反演模型来估计本构参数。\n\n正演模型将有效宏观参数 $M_{\\mathrm{eff}}$ 和 $\\Gamma_{\\mathrm{eff}}$ 定义为微观参数 $\\mu$ 和 $k_n$ 的函数：\n$$ M_{\\mathrm{eff}}(\\mu, k_n) = M_0 + s_\\mu (\\mu - \\mu_{\\mathrm{ref}}) + s_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right) $$\n$$ \\Gamma_{\\mathrm{eff}}(\\mu, k_n) = \\Gamma_0 + t_\\mu (\\mu - \\mu_{\\mathrm{ref}}) + t_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right) $$\n无噪声数据点 $(p'_i, q_i^*, v_i^*)$ 位于临界状态线和正常压缩线上：\n$$ q_i^{\\ast} = M_{\\mathrm{eff}} p'_i $$\n$$ v_i^{\\ast} = \\Gamma_{\\mathrm{eff}} - \\lambda \\ln p'_i $$\n最后，通过添加具有指定方差结构的零均值高斯噪声来生成含噪观测值 $q_i$ 和 $v_i$：\n$$ q_i = q_i^{\\ast} + \\varepsilon_{q,i}, \\quad \\varepsilon_{q,i} \\sim \\mathcal{N}\\left(0, \\sigma_q^2 (p'_i)^2\\right) $$\n$$ v_i = v_i^{\\ast} + \\varepsilon_{v,i}, \\quad \\varepsilon_{v,i} \\sim \\mathcal{N}\\left(0, \\sigma_v^2\\right) $$\n\n反演任务是从含噪数据集 $(p'_i, q_i)$ 和 $(p'_i, v_i)$ 分别估计 $M_{\\mathrm{eff}}$ 和 $\\Gamma_{\\mathrm{eff}}$。我们将估计量表示为 $\\widehat{M}$ 和 $\\widehat{\\Gamma}$。\n\n**1. 应力比参数 $M$ 的估计**\n\n偏应力的模型是 $q_i \\approx M p'_i$。噪声项 $\\varepsilon_{q,i}$ 的方差为 $\\text{Var}(\\varepsilon_{q,i}) = \\sigma_q^2 (p'_i)^2$，它依赖于自变量 $p'_i$。此性质称为异方差性。对于此类线性模型，合适的估计方法是加权最小二乘法（WLS）。WLS的原理是最小化残差平方和，其中每个残差都由其误差方差的倒数加权。\n\n需要对参数 $M$ 最小化的目标函数是：\n$$ S(M) = \\sum_{i=1}^{N} w_i (q_i - M p'_i)^2 $$\n最优权重 $w_i$ 是误差方差的倒数：$w_i = 1/\\text{Var}(\\varepsilon_{q,i}) = 1/(\\sigma_q^2 (p'_i)^2)$。代入这些权重后，目标函数变为：\n$$ S(M) = \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} (q_i - M p'_i)^2 $$\n为了找到最小化 $S(M)$ 的估计量 $\\widehat{M}$，我们将 $S(M)$ 对 $M$ 求导，并令结果为零：\n$$ \\frac{dS}{dM} = \\frac{d}{dM} \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} (q_i - M p'_i)^2 = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} \\cdot 2(q_i - M p'_i) \\cdot (-p'_i) = 0 $$\n常数因子 $-2/\\sigma_q^2$ 可以消去，得到：\n$$ \\sum_{i=1}^{N} \\frac{p'_i}{(p'_i)^2} (q_i - M p'_i) = \\sum_{i=1}^{N} \\frac{1}{p'_i} (q_i - M p'_i) = 0 $$\n展开求和并求解估计量 $\\widehat{M}$：\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - \\sum_{i=1}^{N} \\frac{\\widehat{M} p'_i}{p'_i} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - \\sum_{i=1}^{N} \\widehat{M} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - N \\widehat{M} = 0 $$\n这给出了 $M$ 的WLS估计量的最终表达式：\n$$ \\widehat{M} = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{q_i}{p'_i} $$\n这个结果可以从WLS的正规方程形式化推导出来。对于模型 $\\mathbf{q} = \\mathbf{X}\\beta + \\varepsilon$，其中 $\\mathbf{X} = [p'_1, \\dots, p'_N]^T$ 且 $\\beta = [M]$，解为 $\\widehat{\\beta} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{q}$，其中 $\\mathbf{W} = \\text{diag}(w_i)$。上面展示的计算与求解此系统是等效的。实现时将计算比率 $q_i/p'_i$ 的简单算术平均值。\n\n**2. 比容参数 $\\Gamma$ 的估计**\n\n比容的模型是 $v_i \\approx \\Gamma - \\lambda \\ln p'_i$。参数 $\\lambda$ 作为常数给出（$\\lambda = 0.12$）。噪声项 $\\varepsilon_{v,i}$ 具有恒定方差 $\\text{Var}(\\varepsilon_{v,i}) = \\sigma_v^2$。这是一个同方差模型，普通最小二乘法（OLS）是合适的方法。\n\n为简化估计，我们可以重新整理模型以分离未知参数 $\\Gamma$。我们定义一个新的因变量 $y_i$：\n$$ y_i = v_i + \\lambda \\ln p'_i $$\n将其代入模型方程，我们得到一个仅截距模型：\n$$ y_i \\approx \\Gamma $$\n$y_i$ 的统计模型是 $y_i = \\Gamma + \\varepsilon_{v,i}$。任务简化为估计观测值 $y_i$ 的均值。OLS估计量 $\\widehat{\\Gamma}$ 通过最小化残差平方和找到：\n$$ S(\\Gamma) = \\sum_{i=1}^{N} (y_i - \\Gamma)^2 $$\n对 $\\Gamma$ 求导并将结果设为零，得到此问题的正规方程：\n$$ \\frac{dS}{d\\Gamma} = \\frac{d}{d\\Gamma} \\sum_{i=1}^{N} (y_i - \\Gamma)^2 = \\sum_{i=1}^{N} -2(y_i - \\Gamma) = 0 $$\n$$ \\sum_{i=1}^{N} (y_i - \\Gamma) = 0 $$\n$$ \\sum_{i=1}^{N} y_i - \\sum_{i=1}^{N} \\Gamma = 0 $$\n$$ \\sum_{i=1}^{N} y_i - N \\Gamma = 0 $$\n求解估计量 $\\widehat{\\Gamma}$：\n$$ \\widehat{\\Gamma} = \\frac{1}{N} \\sum_{i=1}^{N} y_i $$\n将 $y_i$ 的定义代回，得到最终的估计量：\n$$ \\widehat{\\Gamma} = \\frac{1}{N} \\sum_{i=1}^{N} (v_i + \\lambda \\ln p'_i) $$\n该估计量就是变换后变量 $y_i$ 的样本均值。实现时将为每个测试案例计算此均值。\n\n每个测试案例的总体算法是：\n1.  根据给定的微观参数 $(\\mu, k_n)$，计算真实有效参数 $M_{\\mathrm{eff}}$ 和 $\\Gamma_{\\mathrm{eff}}$。\n2.  在指定的应力水平 $p'_i$ 下，生成 $N=9$ 个无噪声数据点 $(q_i^*, v_i^*)$ 的集合。\n3.  使用固定的随机种子以保证可复现性，对 $q_i^*$ 添加指定的异方差噪声，对 $v_i^*$ 添加同方差噪声。这产生了合成测量数据 $(q_i, v_i)$。\n4.  将推导出的估计量 $\\widehat{M} = \\frac{1}{N} \\sum (q_i/p'_i)$ 应用于 $(p'_i, q_i)$ 数据。\n5.  将推导出的估计量 $\\widehat{\\Gamma} = \\frac{1}{N} \\sum (v_i + \\lambda \\ln p'_i)$ 应用于 $(p'_i, v_i)$ 数据。\n6.  得到的对 $(\\widehat{M}, \\widehat{\\Gamma})$ 构成了该测试案例的解。对所有五个案例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves an inverse problem to identify critical state parameters from synthetic data.\n    The solution involves generating synthetic data based on a forward model and then\n    recovering the parameters using Weighted Least Squares for M and Ordinary Least\n    Squares for Gamma, as derived from first principles.\n    \"\"\"\n\n    # --- 1. Define Constants and Forward Model Parameters ---\n    M0 = 1.2\n    Gamma0 = 1.95\n    lambda_val = 0.12\n    mu_ref = 0.5\n    k_ref = 1e5\n    s_mu = 0.6\n    s_k = 0.03\n    t_mu = -0.02\n    t_k = -0.01\n    sigma_q = 0.02\n    sigma_v = 0.005\n    RANDOM_SEED = 42\n\n    # Stress levels for data generation (in kPa)\n    p_prime = np.array([50., 75., 100., 150., 200., 250., 300., 350., 400.])\n    N = len(p_prime)\n\n    # Test suite of micro-parameters\n    test_cases = [\n        (0.5, 1e5),          # Case A (reference)\n        (0.3, 1e5),          # Case B (low friction)\n        (0.7, 1e5),          # Case C (high friction)\n        (0.5, 3e4),          # Case D (low stiffness)\n        (0.5, 1e6)           # Case E (high stiffness)\n    ]\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    results = []\n    \n    # --- 2. Process Each Test Case ---\n    for mu, k_n in test_cases:\n        \n        # --- 2a. Generate Synthetic Data ---\n        \n        # Calculate effective macro-parameters based on micro-parameters\n        M_eff = M0 + s_mu * (mu - mu_ref) + s_k * np.log(k_n / k_ref)\n        Gamma_eff = Gamma0 + t_mu * (mu - mu_ref) + t_k * np.log(k_n / k_ref)\n        \n        # Generate noiseless data\n        q_star = M_eff * p_prime\n        v_star = Gamma_eff - lambda_val * np.log(p_prime)\n        \n        # Generate heteroscedastic noise for q\n        std_dev_q = sigma_q * p_prime\n        epsilon_q = rng.normal(0, std_dev_q, size=N)\n        \n        # Generate homoscedastic noise for v\n        epsilon_v = rng.normal(0, sigma_v, size=N)\n        \n        # Add noise to generate synthetic measurements\n        q_measured = q_star + epsilon_q\n        v_measured = v_star + epsilon_v\n        \n        # --- 2b. Inverse Problem: Estimate M and Gamma ---\n        \n        # Estimate M using the derived Weighted Least Squares estimator\n        # Model: q_i = M * p'_i\n        # Estimator: M_hat = (1/N) * sum(q_i / p'_i)\n        # This is the solution to the normal equations for the WLS problem.\n        M_hat = np.mean(q_measured / p_prime)\n        \n        # Estimate Gamma using the derived Ordinary Least Squares estimator\n        # Model: v_i = Gamma - lambda * ln(p'_i)\n        # Rearranged model: y_i = v_i + lambda * ln(p'_i) = Gamma\n        # Estimator: Gamma_hat = mean(y_i)\n        y = v_measured + lambda_val * np.log(p_prime)\n        Gamma_hat = np.mean(y)\n        \n        results.extend([M_hat, Gamma_hat])\n        \n    # --- 3. Format and Print Final Output ---\n    # The output format must be a list of 10 floats, rounded to 5 decimal places.\n    formatted_results = [f'{x:.5f}' for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}