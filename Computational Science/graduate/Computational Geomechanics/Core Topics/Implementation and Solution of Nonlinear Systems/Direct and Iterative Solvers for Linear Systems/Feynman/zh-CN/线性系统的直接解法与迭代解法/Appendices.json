{
    "hands_on_practices": [
        {
            "introduction": "在计算岩土力学中，许多问题（例如小应变线弹性）在离散化后会产生对称正定（Symmetric Positive Definite, SPD）的刚度矩阵。对于这类系统，Cholesky分解是一种极为高效和数值稳定的直接求解方法。本练习将通过一个具体的算例，引导你手动完成Cholesky分解以及后续的前向和后向代换过程，从而加深对该算法核心机制的理解。",
            "id": "3517762",
            "problem": "一个三自由度线性系统源于计算岩土力学中小应变、线弹性一维杆段的有限元离散化。根据最小势能原理和弹性双线性形式的矫顽性，组装后的刚度矩阵是对称正定的。给定刚度矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和载荷向量 $b \\in \\mathbb{R}^{3}$：\n$$\nA \\;=\\; \\begin{pmatrix}\n4  & 2  & 0 \\\\\n2  & 10 & 6 \\\\\n0  & 6  & 5\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n8 \\\\\n40 \\\\\n27\n\\end{pmatrix}.\n$$\n仅使用 Cholesky 分解的定义 $A = L L^{\\top}$（其中 $L$ 是一个对角线元素为正的下三角矩阵），对 $A$ 进行分解，然后通过前向和后向代入法求解线性系统 $A x = b$。报告解向量 $x$ 的第三个分量 $x_{3}$。将最终答案表示为一个精确数。不包含单位。无需四舍五入。",
            "solution": "问题是求解线性系统 $A x = b$ 以得到未知向量 $x \\in \\mathbb{R}^3$，其中矩阵 $A$ 和向量 $b$ 由下式给出：\n$$\nA \\;=\\; \\begin{pmatrix}\n4  & 2  & 0 \\\\\n2  & 10 & 6 \\\\\n0  & 6  & 5\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n8 \\\\\n40 \\\\\n27\n\\end{pmatrix}.\n$$\n指定的求解方法是 Cholesky 分解。\n\n首先，对问题陈述进行验证。问题提供了所有必要的数据（$A$ 和 $b$），并指定了一个清晰、客观的任务。其背景在科学上是合理的。一个关键前提是矩阵 $A$ 是对称正定 (SPD) 的，这是存在唯一 Cholesky 分解的充分必要条件。\n\n我们来验证这个前提。\n对称性：矩阵 $A$ 是对称的，因为对于所有的 $i, j \\in \\{1, 2, 3\\}$ 都有 $A_{ij} = A_{ji}$。例如，$A_{12} = 2 = A_{21}$ 且 $A_{23} = 6 = A_{32}$。\n\n正定性：我们检查 $A$ 的顺序主子式。\n一阶顺序主子式为 $\\Delta_1 = |4| = 4 > 0$。\n二阶顺序主子式为 $\\det\\begin{pmatrix} 4  & 2 \\\\ 2  & 10 \\end{pmatrix} = (4)(10) - (2)(2) = 40 - 4 = 36 > 0$。\n三阶顺序主子式是 $A$ 的行列式：\n$$\n\\det(A) = 4 \\det\\begin{pmatrix} 10 & 6 \\\\ 6 & 5 \\end{pmatrix} - 2 \\det\\begin{pmatrix} 2 & 6 \\\\ 0 & 5 \\end{pmatrix} + 0 = 4(50 - 36) - 2(10 - 0) = 4(14) - 20 = 56 - 20 = 36 > 0.\n$$\n由于所有顺序主子式均为正，矩阵 $A$ 确实是对称正定的。该问题是有效的。\n\n我们继续寻找 Cholesky 分解 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素为正的下三角矩阵：\n$$\nL = \\begin{pmatrix} l_{11}  & 0  & 0 \\\\ l_{21}  & l_{22}  & 0 \\\\ l_{31}  & l_{32}  & l_{33} \\end{pmatrix}\n$$\n方程 $A = L L^{\\top}$ 为：\n$$\n\\begin{pmatrix} 4  & 2  & 0 \\\\ 2  & 10 & 6 \\\\ 0  & 6  & 5 \\end{pmatrix} = \\begin{pmatrix} l_{11}  & 0  & 0 \\\\ l_{21}  & l_{22}  & 0 \\\\ l_{31}  & l_{32}  & l_{33} \\end{pmatrix} \\begin{pmatrix} l_{11}  & l_{21}  & l_{31} \\\\ 0  & l_{22}  & l_{32} \\\\ 0  & 0  & l_{33} \\end{pmatrix} = \\begin{pmatrix} l_{11}^2  & l_{11}l_{21}  & l_{11}l_{31} \\\\ l_{21}l_{11}  & l_{21}^2+l_{22}^2  & l_{21}l_{31}+l_{22}l_{32} \\\\ l_{31}l_{11}  & l_{31}l_{21}+l_{32}l_{22}  & l_{31}^2+l_{32}^2+l_{33}^2 \\end{pmatrix}\n$$\n令 $A$ 的元素与 $L L^{\\top}$ 的元素相等：\n\n对于 $L$ 的第一列：\n$l_{11}^2 = 4 \\implies l_{11} = \\sqrt{4} = 2$。\n$l_{11}l_{21} = 2 \\implies 2 l_{21} = 2 \\implies l_{21} = 1$。\n$l_{11}l_{31} = 0 \\implies 2 l_{31} = 0 \\implies l_{31} = 0$。\n\n对于 $L$ 的第二列：\n$l_{21}^2 + l_{22}^2 = 10 \\implies 1^2 + l_{22}^2 = 10 \\implies l_{22}^2 = 9 \\implies l_{22} = \\sqrt{9} = 3$。\n$l_{21}l_{31} + l_{22}l_{32} = 6 \\implies (1)(0) + (3)l_{32} = 6 \\implies 3l_{32} = 6 \\implies l_{32} = 2$。\n\n对于 $L$ 的第三列：\n$l_{31}^2 + l_{32}^2 + l_{33}^2 = 5 \\implies 0^2 + 2^2 + l_{33}^2 = 5 \\implies 4 + l_{33}^2 = 5 \\implies l_{33}^2 = 1 \\implies l_{33} = \\sqrt{1} = 1$。\n\n因此，Cholesky 因子 $L$ 为：\n$$\nL = \\begin{pmatrix} 2  & 0  & 0 \\\\ 1  & 3  & 0 \\\\ 0  & 2  & 1 \\end{pmatrix}\n$$\n线性系统 $A x = b$ 变为 $L L^{\\top} x = b$。我们分两步求解。首先，令 $y = L^{\\top} x$，并使用前向代入法求解下三角系统 $L y = b$ 以得到 $y$。\n$$\n\\begin{pmatrix} 2  & 0  & 0 \\\\ 1  & 3  & 0 \\\\ 0  & 2  & 1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 40 \\\\ 27 \\end{pmatrix}\n$$\n第一个方程给出 $2y_1 = 8 \\implies y_1 = 4$。\n第二个方程给出 $y_1 + 3y_2 = 40 \\implies 4 + 3y_2 = 40 \\implies 3y_2 = 36 \\implies y_2 = 12$。\n第三个方程给出 $2y_2 + y_3 = 27 \\implies 2(12) + y_3 = 27 \\implies 24 + y_3 = 27 \\implies y_3 = 3$。\n因此，中间向量为 $y = \\begin{pmatrix} 4 \\\\ 12 \\\\ 3 \\end{pmatrix}$。\n\n其次，我们使用后向代入法求解上三角系统 $L^{\\top} x = y$ 以得到 $x$。\n$$\nL^{\\top} = \\begin{pmatrix} 2  & 1  & 0 \\\\ 0  & 3  & 2 \\\\ 0  & 0  & 1 \\end{pmatrix}\n$$\n该系统为：\n$$\n\\begin{pmatrix} 2  & 1  & 0 \\\\ 0  & 3  & 2 \\\\ 0  & 0  & 1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 12 \\\\ 3 \\end{pmatrix}\n$$\n第三个方程给出 $x_3 = 3$。\n第二个方程给出 $3x_2 + 2x_3 = 12 \\implies 3x_2 + 2(3) = 12 \\implies 3x_2 + 6 = 12 \\implies 3x_2 = 6 \\implies x_2 = 2$。\n第一个方程给出 $2x_1 + x_2 = 4 \\implies 2x_1 + 2 = 4 \\implies 2x_1 = 2 \\implies x_1 = 1$。\n\n解向量为 $x = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$。\n问题要求解向量的第三个分量，即 $x_3$。\n其值为 $x_3 = 3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "当问题规模变得庞大时，直接求解法的计算成本和内存需求会急剧增加，此时迭代法成为更合适的选择。共轭梯度（Conjugate Gradient, CG）法是求解对称正定（SPD）系统的首选迭代方法，但其收敛速度与系统矩阵的谱特性密切相关。本练习旨在揭示这一联系，通过分析一个典型一维弹性杆问题的刚度矩阵特征值，来预测CG方法的收敛性能，让你理解条件数是如何影响迭代次数的。",
            "id": "3517795",
            "problem": "一根长度为 $L$ 的一维均质弹性柱，具有恒定的杨氏模量 $E$ 和横截面积 $A$，其两端固定，并受到体力荷载作用（本次特征分析无需考虑此荷载）。小应变、线弹性、轴向位移场 $u(x)$ 被离散为 $N_{e}$ 个等长的双节点线性有限元。在两端施加本质（狄利克雷）边界条件后，内部自由度的全局刚度矩阵是对称正定的。对于单元长度为 $h = L/N_{e}$ 的均匀网格，为内部节点组装的刚度矩阵具有以下规范的三对角形式\n$$\n\\mathbf{K} \\;=\\; \\frac{EA}{h} \\,\\mathbf{T}, \\quad \\text{其中} \\quad \\mathbf{T} \\in \\mathbb{R}^{n \\times n}, \\; n = N_{e}-1,\n$$\n且 $\\mathbf{T}$ 是一个 $n \\times n$ 的三对角托普利茨矩阵，其主对角线元素为 $2$，第一亚对角线和第一超对角线元素为 $-1$。\n\n考虑具体数据 $L = 6\\,\\mathrm{m}$，$E = 50 \\times 10^{6}\\,\\mathrm{Pa}$，$A = 0.20\\,\\mathrm{m}^{2}$，以及 $N_{e} = 6$，因此 $h = 1\\,\\mathrm{m}$ 且 $n = 5$。于是 $\\mathbf{K} \\in \\mathbb{R}^{5 \\times 5}$ 是一个三对角矩阵，其形式为\n$$\n\\mathbf{K} \\;=\\; \\frac{EA}{h}\\begin{bmatrix}\n2  & -1 & 0  & 0  & 0\\\\\n-1 & 2  & -1 & 0  & 0\\\\\n0  & -1 & 2  & -1 & 0\\\\\n0  & 0  & -1 & 2  & -1\\\\\n0  & 0  & 0  & -1 & 2\n\\end{bmatrix}.\n$$\n\n任务：\n- 明确计算 $\\mathbf{K}$ 的所有特征值。\n- 使用共轭梯度（CG）法在不使用预处理的情况下求解对称正定系统的经典最坏情况收敛界，估算为将误差的相对 $\\mathbf{K}$-范数减小一个因子 $\\varepsilon = 10^{-8}$（即，确保 $\\lVert \\mathbf{e}_{m} \\rVert_{\\mathbf{K}} / \\lVert \\mathbf{e}_{0} \\rVert_{\\mathbf{K}} \\le \\varepsilon$，且与初始误差 $\\mathbf{e}_{0}$ 无关）所需的最小CG迭代整数次数 $m$。不使用任何预处理。\n\n将你的最终答案表示为所需的最小共轭梯度迭代整数次数 $m$（无量纲）。最终答案中不应报告任何其他量。如果需要任何中间数值，尽可能进行精确计算；如果无法避免数值近似，仅在最后对中间值进行四舍五入，以避免累积误差。最终答案是整数，不需要按有效数字取整。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 柱的长度：$L = 6\\,\\mathrm{m}$\n- 杨氏模量：$E = 50 \\times 10^{6}\\,\\mathrm{Pa}$\n- 横截面积：$A = 0.20\\,\\mathrm{m}^{2}$\n- 有限元数量：$N_{e} = 6$\n- 内部自由度数量：$n = N_{e}-1 = 5$\n- 单元长度：$h = L/N_{e} = 1\\,\\mathrm{m}$\n- 内部自由度的全局刚度矩阵：$\\mathbf{K} = \\frac{EA}{h} \\mathbf{T}$，其中 $\\mathbf{T}$ 是一个 $n \\times n$ 的三对角托普利茨矩阵，主对角线元素为 $2$，第一亚对角线和第一超对角线元素为 $-1$。\n对于 $n=5$ 的具体矩阵如下：\n$$\n\\mathbf{K} \\;=\\; \\frac{EA}{h}\\begin{bmatrix}\n2  & -1 & 0  & 0  & 0\\\\\n-1 & 2  & -1 & 0  & 0\\\\\n0  & -1 & 2  & -1 & 0\\\\\n0  & 0  & -1 & 2  & -1\\\\\n0  & 0  & 0  & -1 & 2\n\\end{bmatrix}\n$$\n- 共轭梯度（CG）法要求的误差减小量：$\\varepsilon = 10^{-8}$\n- 收敛条件：$\\lVert \\mathbf{e}_{m} \\rVert_{\\mathbf{K}} / \\lVert \\mathbf{e}_{0} \\rVert_{\\mathbf{K}} \\le \\varepsilon$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了有限元法（FEM）在1D线弹性问题（轴向受力杆）中的一个标准应用。得到的刚度矩阵是一个众所周知的结构（对称正定、三对角托普利茨矩阵）。通过矩阵条件数分析共轭梯度法的收敛性是数值线性代数和科学计算中的一个基本课题。该问题牢固地植根于计算力学和数值分析的既定原则。\n- **适定性：** 计算特征值和所需CG迭代次数的所有必要数据均已提供。任务陈述清晰。问题是自洽的，且在数学上是一致的。例如，给定的值 $L=6$ 和 $N_e=6$ 正确地得到 $h=1$，而 $N_e=6$ 正确地得到 $n=5$。矩阵形式对于所描述的物理系统和离散化是正确的。\n- **客观性：** 问题以精确、客观和定量的术语表述。它没有主观论断或含糊之处。\n\n未发现任何缺陷。该问题并非科学上不合理、不可形式化、不完整、不切实际、不适定、过于简单或无法验证。\n\n### 步骤3：结论与行动\n该问题是**有效**的。将提供完整解答。\n\n### 解答推导\n根据题目要求，解答分为两个部分。\n\n#### 第一部分：K的特征值计算\n刚度矩阵 $\\mathbf{K}$ 由 $\\mathbf{K} = \\frac{EA}{h} \\mathbf{T}$ 给出，其中 $\\mathbf{T}$ 是一个 $n \\times n$ 的矩阵：\n$$\n\\mathbf{T} = \\begin{bmatrix}\n2  & -1 & 0  & \\dots  & 0 \\\\\n-1 & 2  & -1 & \\ddots  & \\vdots \\\\\n0  & -1 & \\ddots  & \\ddots  & 0 \\\\\n\\vdots  & \\ddots  & \\ddots  & 2  & -1 \\\\\n0  & \\dots  & 0  & -1 & 2\n\\end{bmatrix}\n$$\n$\\mathbf{K}$ 的特征值（记为 $\\lambda_j(\\mathbf{K})$）与 $\\mathbf{T}$ 的特征值（记为 $\\lambda_j(\\mathbf{T})$）通过标量倍数 $\\frac{EA}{h}$ 相关联。\n$$\n\\lambda_j(\\mathbf{K}) = \\frac{EA}{h} \\lambda_j(\\mathbf{T})\n$$\n这种特定的 $n \\times n$ 三对角托普利茨矩阵 $\\mathbf{T}$ 的特征值是众所周知的，由以下公式给出：\n$$\n\\lambda_j(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{j\\pi}{n+1}\\right), \\quad j = 1, 2, \\dots, n\n$$\n在这个问题中，$n = N_{e}-1 = 6-1 = 5$。因此，$n+1 = 6$。$\\mathbf{T}$ 的特征值是：\n$$\n\\lambda_j(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{j\\pi}{6}\\right), \\quad j = 1, 2, 3, 4, 5\n$$\n我们明确地计算每个特征值：\n- 对于 $j=1$：$\\lambda_1(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{\\pi}{6}\\right) = 2 - 2\\left(\\frac{\\sqrt{3}}{2}\\right) = 2 - \\sqrt{3}$\n- 对于 $j=2$：$\\lambda_2(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{2\\pi}{6}\\right) = 2 - 2\\cos\\left(\\frac{\\pi}{3}\\right) = 2 - 2\\left(\\frac{1}{2}\\right) = 1$\n- 对于 $j=3$：$\\lambda_3(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{3\\pi}{6}\\right) = 2 - 2\\cos\\left(\\frac{\\pi}{2}\\right) = 2 - 2(0) = 2$\n- 对于 $j=4$：$\\lambda_4(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{4\\pi}{6}\\right) = 2 - 2\\cos\\left(\\frac{2\\pi}{3}\\right) = 2 - 2\\left(-\\frac{1}{2}\\right) = 3$\n- 对于 $j=5$：$\\lambda_5(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{5\\pi}{6}\\right) = 2 - 2\\left(-\\frac{\\sqrt{3}}{2}\\right) = 2 + \\sqrt{3}$\n\n接下来，我们计算标量前置因子 $\\frac{EA}{h}$：\n$$\n\\frac{EA}{h} = \\frac{(50 \\times 10^{6}\\,\\mathrm{Pa})(0.20\\,\\mathrm{m}^{2})}{1\\,\\mathrm{m}} = 10 \\times 10^{6}\\,\\frac{\\mathrm{N}}{\\mathrm{m}} = 10^{7}\\,\\frac{\\mathrm{N}}{\\mathrm{m}}\n$$\n因此，刚度矩阵 $\\mathbf{K}$ 的特征值为：\n- $\\lambda_1(\\mathbf{K}) = 10^{7}(2 - \\sqrt{3})$\n- $\\lambda_2(\\mathbf{K}) = 10^{7}(1) = 10^{7}$\n- $\\lambda_3(\\mathbf{K}) = 10^{7}(2) = 2 \\times 10^{7}$\n- $\\lambda_4(\\mathbf{K}) = 10^{7}(3) = 3 \\times 10^{7}$\n- $\\lambda_5(\\mathbf{K}) = 10^{7}(2 + \\sqrt{3})$\n\n#### 第二部分：CG迭代次数的估计\n对于对称正定系统，共轭梯度（CG）法的经典最坏情况收敛界将误差的 $\\mathbf{K}$-范数减小量与迭代次数 $m$ 和矩阵 $\\mathbf{K}$ 的谱条件数 $\\kappa(\\mathbf{K})$ 联系起来：\n$$\n\\frac{\\lVert \\mathbf{e}_{m} \\rVert_{\\mathbf{K}}}{\\lVert \\mathbf{e}_{0} \\rVert_{\\mathbf{K}}} \\le 2 \\left(\\frac{\\sqrt{\\kappa(\\mathbf{K})} - 1}{\\sqrt{\\kappa(\\mathbf{K})} + 1}\\right)^m\n$$\n我们需要找到最小的整数 $m$，使得这个比率小于或等于 $\\varepsilon = 10^{-8}$。\n\n首先，我们计算条件数 $\\kappa(\\mathbf{K})$，即 $\\mathbf{K}$ 的最大特征值与最小特征值之比：\n$$\n\\kappa(\\mathbf{K}) = \\frac{\\lambda_{\\max}(\\mathbf{K})}{\\lambda_{\\min}(\\mathbf{K})} = \\frac{\\lambda_5(\\mathbf{K})}{\\lambda_1(\\mathbf{K})} = \\frac{10^{7}(2 + \\sqrt{3})}{10^{7}(2 - \\sqrt{3})} = \\frac{2 + \\sqrt{3}}{2 - \\sqrt{3}}\n$$\n为简化此表达式，我们将分子和分母同乘以分母的共轭：\n$$\n\\kappa(\\mathbf{K}) = \\frac{2 + \\sqrt{3}}{2 - \\sqrt{3}} \\times \\frac{2 + \\sqrt{3}}{2 + \\sqrt{3}} = \\frac{(2 + \\sqrt{3})^2}{2^2 - (\\sqrt{3})^2} = \\frac{4 + 4\\sqrt{3} + 3}{4 - 3} = 7 + 4\\sqrt{3}\n$$\n现在我们计算 $\\sqrt{\\kappa(\\mathbf{K})}$：\n$$\n\\sqrt{\\kappa(\\mathbf{K})} = \\sqrt{7 + 4\\sqrt{3}}\n$$\n我们可以通过识别出 $(2+\\sqrt{3})^2 = 2^2 + 2(2)(\\sqrt{3}) + (\\sqrt{3})^2 = 4 + 4\\sqrt{3} + 3 = 7 + 4\\sqrt{3}$ 来展开此根式。\n因此：\n$$\n\\sqrt{\\kappa(\\mathbf{K})} = 2 + \\sqrt{3}\n$$\n接下来，我们计算收敛因子中的项：\n$$\n\\frac{\\sqrt{\\kappa(\\mathbf{K})} - 1}{\\sqrt{\\kappa(\\mathbf{K})} + 1} = \\frac{(2 + \\sqrt{3}) - 1}{(2 + \\sqrt{3}) + 1} = \\frac{1 + \\sqrt{3}}{3 + \\sqrt{3}}\n$$\n从分母中提取因子 $\\sqrt{3}$ 得到：\n$$\n\\frac{1 + \\sqrt{3}}{\\sqrt{3}(\\sqrt{3} + 1)} = \\frac{1}{\\sqrt{3}}\n$$\n将此代回收敛不等式，我们需要求解 $m$：\n$$\n2 \\left(\\frac{1}{\\sqrt{3}}\\right)^m \\le 10^{-8}\n$$\n我们重新整理并对两边取自然对数：\n$$\n\\left(\\frac{1}{\\sqrt{3}}\\right)^m \\le \\frac{10^{-8}}{2} = 0.5 \\times 10^{-8}\n$$\n$$\n\\ln\\left((\\sqrt{3})^{-m}\\right) \\le \\ln(0.5 \\times 10^{-8})\n$$\n$$\n-m \\ln(\\sqrt{3}) \\le \\ln(0.5) + \\ln(10^{-8})\n$$\n$$\n-\\frac{m}{2} \\ln(3) \\le -\\ln(2) - 8\\ln(10)\n$$\n两边乘以 $-2$ 会反转不等号：\n$$\nm \\ln(3) \\ge 2\\ln(2) + 16\\ln(10)\n$$\n$$\nm \\ge \\frac{2\\ln(2) + 16\\ln(10)}{\\ln(3)}\n$$\n现在，我们代入对数的数值（$\\ln(2) \\approx 0.693147$，$\\ln(3) \\approx 1.098612$，$\\ln(10) \\approx 2.302585$）：\n$$\nm \\ge \\frac{2(0.693147) + 16(2.302585)}{1.098612}\n$$\n$$\nm \\ge \\frac{1.386294 + 36.84136}{1.098612}\n$$\n$$\nm \\ge \\frac{38.227654}{1.098612} \\approx 34.7951\n$$\n由于迭代次数 $m$ 必须是整数，我们取满足此条件的最小整数值：\n$$\nm = 35\n$$\n因此，为保证所要求的误差减小，需要至少35次CG迭代。",
            "answer": "$$\\boxed{35}$$"
        },
        {
            "introduction": "许多复杂的岩土力学问题，如涉及接触和摩擦的场景，会产生KKT（Karush-Kuhn-Tucker）系统，其矩阵通常是大型、稀疏且不定的。对于这类不定系统，Cholesky分解不再适用，必须采用更通用的LU分解。本计算实验将探讨在求解这类问题时，稀疏LU分解中的阈值部分主元选择策略，如何影响数值稳定性（以增长因子衡量）和计算效率（以填充率衡量）之间的权衡。",
            "id": "3517820",
            "problem": "考虑小应变线性弹性力学的混合公式，其中包含单边接触和摩擦，并在一个潜在接触节点处进行理想化处理。在线性化层面上，离散力学可以用 Karush-Kuhn-Tucker (KKT) 系统来表示。该线性系统的块结构由下式给出\n$$\nA(\\mu) \\;=\\;\n\\begin{bmatrix}\nK  & J(\\mu)^{\\top} \\\\\nJ(\\mu)  & 0\n\\end{bmatrix},\n$$\n其中 $K \\in \\mathbb{R}^{4 \\times 4}$ 是一个双节点、每节点双自由度（$x$ 和 $y$）弹性子系统的对称正定刚度矩阵，而 $J(\\mu) \\in \\mathbb{R}^{2 \\times 4}$ 是约束雅可比矩阵，用于在第二个节点上模拟法向接触和切向静摩擦。摩擦系数 $\\mu$ 通过库仑定律 $\\mu = \\tan(\\phi)$ 与摩擦角 $\\phi$ 相关联。提供给程序时，摩擦角必须以度为单位表示。由于右下角存在零块，该 KKT 矩阵 $A(\\mu)$ 是不定的。\n\n要求您研究在摩擦角变化时，稀疏下-上 (LU) 分解中的阈值部分主元法与不定矩阵 $A(\\mu)$ 的稳定性-填充权衡之间的相互作用。阈值参数用 $\\tau \\in (0,1]$ 表示，它控制主元选择中的对角偏好。\n\n基本原理与构造：\n- 从线性弹性的最小势能原理出发，该原理为无约束自由度生成一个对称正定刚度矩阵 $K$。\n- 通过拉格朗日乘子在法向施加双边接触，在切向施加静摩擦，从而产生带有 $J(\\mu)$ 和一个零块的 KKT 块结构，使得系统成为不定的。\n- 使用库仑摩擦关系 $\\mu = \\tan(\\phi)$（其中 $\\phi$ 以度为单位）来缩放 $J(\\mu)$ 中的切向约束行。\n\n离散模型细节：\n- 模型有 $2$ 个节点，位移自由度排序为 $[u_{1x}, u_{1y}, u_{2x}, u_{2y}]$，因此 $K \\in \\mathbb{R}^{4 \\times 4}$。\n- 弹性耦合和锚定由线性弹簧建模，其刚度分别为 $k_{1} > 0$ 和 $k_{2} > 0$，分别在 $x$ 和 $y$ 方向上锚定节点 $1$ 和节点 $2$；还有一个节点间耦合刚度 $k_{12} > 0$，在 $x$ 和 $y$ 方向上独立作用。得到的 $K$ 为\n$$\nK =\n\\begin{bmatrix}\nk_{1}+k_{12}  & 0  & -k_{12}  & 0 \\\\\n0  & k_{1}+k_{12}  & 0  & -k_{12} \\\\\n-k_{12}  & 0  & k_{2}+k_{12}  & 0 \\\\\n0  & -k_{12}  & 0  & k_{2}+k_{12}\n\\end{bmatrix}.\n$$\n- 约束雅可比矩阵 $J(\\mu)$ 编码了节点 $2$ 处的接触法向和切向。使用全局单位方向 $\\boldsymbol{n} = [1,0]$ 和 $\\boldsymbol{t} = [0,1]$，约束条件为 $u_{2n} = \\boldsymbol{n}^{\\top}\\boldsymbol{u}_2$ 和 $u_{2t} = \\boldsymbol{t}^{\\top}\\boldsymbol{u}_2$。通过将切向约束行乘以 $\\mu$ 来引入静摩擦缩放，这平衡了法向和切向约束之间的相对条件数。因此，\n$$\nJ(\\mu) =\n\\begin{bmatrix}\n0  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & \\mu\n\\end{bmatrix}.\n$$\n\n稳定性和稀疏性度量：\n- 稳定性代理是经典的 LU 增长因子，定义为\n$$\n\\gamma(A,L,U) \\;=\\; \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A_{ij}|},\n$$\n其中 $U$ 是 $A$ 的 LU 分解得到的上三角因子。该因子衡量了 $U$ 中相对于 $A$ 的最大元素增长。\n- 稀疏性度量是填充率，定义为\n$$\n\\rho(A,L,U) \\;=\\; \\frac{\\operatorname{nnz}(L) + \\operatorname{nnz}(U)}{\\operatorname{nnz}(A)},\n$$\n其中 $\\operatorname{nnz}(\\cdot)$ 表示非零元素的数量。下三角因子 $L$ 被视为显式的单位下三角矩阵，其单位对角线元素计入 $\\operatorname{nnz}(L)$ 以确保各情况之间的一致性。\n\n计算任务：\n- 实现一个程序，使用 $k_{1} = 120$, $k_{2} = 80$, 和 $k_{12} = 50$ 构造 $K$，为每个摩擦角 $\\phi$ 和阈值 $\\tau$ 构建 $A(\\mu)$，使用阈值部分主元参数 $\\tau$ 执行稀疏 LU 分解，并计算 $\\gamma$ 和 $\\rho$。\n- 角度必须以度为单位解释。在内部为计算 $\\mu = \\tan(\\phi)$ 将其转换为弧度。\n- 在分解过程中对列使用对称列近似最小度排序，以减少填充。\n\n测试套件：\n- 摩擦角 $\\phi$（度）: $\\{20, 35, 45\\}$，通过 $\\mu = \\tan(\\phi)$ 对应于递增的 $\\mu$。\n- 主元阈值 $\\tau$: $\\{1.0, 0.1, 0.01\\}$。\n- 评估所有 $9$ 种组合 $(\\phi, \\tau)$。\n\n答案规范：\n- 对于每个测试用例 $(\\phi, \\tau)$，计算实数对 $(\\gamma, \\rho)$。\n- 最终输出必须是单行，包含一个由方括号括起来的逗号分隔列表，其中每个项目都是列表 $[\\phi,\\tau,\\gamma,\\rho]$，$\\phi$ 和 $\\tau$ 为十进制形式，$\\gamma$ 和 $\\rho$ 为浮点数。例如，格式为 $[[\\phi_{1},\\tau_{1},\\gamma_{1},\\rho_{1}],\\dots,[\\phi_{9},\\tau_{9},\\gamma_{9},\\rho_{9}]]$。\n\n您的程序必须是自包含的，并且不得需要外部输入。除了角度外，不涉及任何物理单位，角度必须以度为单位。确保实现是稳健的，并在数值上与上述定义一致。",
            "solution": "该问题是有效的。它提出了一个定义明确的计算任务，该任务基于计算接触力学和数值线性代数的既定原则。所有必需的数据、定义和模型参数都已提供，问题内部一致且科学上合理。\n\n问题的核心是研究稀疏直接求解器应用于从带接触和摩擦的线性弹性问题导出的 Karush-Kuhn-Tucker (KKT) 系统时的数值特性。由矩阵 $A(\\mu)$ 表示的 KKT 系统本质上是不定的，这对直接求解器构成了挑战。目标是量化数值稳定性与稀疏性保持之间的权衡，这种权衡由阈值主元参数 $\\tau$ 控制，并随着问题物理特性通过摩擦系数 $\\mu$ 变化而变化。\n\n解决方案分几个步骤进行：为每个测试用例构建系统矩阵，使用稀疏 LU 算法进行分解，以及计算稳定性和稀疏性度量。\n\n首先，我们构造系统矩阵 $A(\\mu)$。该矩阵具有 $2 \\times 2$ 的块结构：\n$$\nA(\\mu) =\n\\begin{bmatrix}\nK  & J(\\mu)^{\\top} \\\\\nJ(\\mu)  & 0\n\\end{bmatrix}\n$$\n左上角的块 $K \\in \\mathbb{R}^{4 \\times 4}$ 是刚度矩阵。它代表了无约束系统的弹性势能。根据所提供的弹簧模型，其刚度为 $k_{1} = 120$、$k_{2} = 80$ 和 $k_{12} = 50$，自由度排序为 $[u_{1x}, u_{1y}, u_{2x}, u_{2y}]$，矩阵 $K$ 的组装如下：\n$$\nK =\n\\begin{bmatrix}\nk_{1}+k_{12}  & 0  & -k_{12}  & 0 \\\\\n0  & k_{1}+k_{12}  & 0  & -k_{12} \\\\\n-k_{12}  & 0  & k_{2}+k_{12}  & 0 \\\\\n0  & -k_{12}  & 0  & k_{2}+k_{12}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n170  & 0  & -50  & 0 \\\\\n0  & 170  & 0  & -50 \\\\\n-50  & 0  & 130  & 0 \\\\\n0  & -50  & 0  & 130\n\\end{bmatrix}\n$$\n该矩阵是对称的，并且对于稳定的弹性系统来说，是正定的。\n\n非对角块 $J(\\mu) \\in \\mathbb{R}^{2 \\times 4}$ 及其转置 $J(\\mu)^{\\top}$ 代表线性化约束。它们在第二个节点上施加法向接触和切向静摩擦。摩擦系数 $\\mu$ 由库仑定律 $\\mu = \\tan(\\phi)$ 确定，其中摩擦角 $\\phi$ 以度为单位给出，在进行三角函数计算时必须转换为弧度。$J(\\mu)$ 的结构如下：\n$$\nJ(\\mu) =\n\\begin{bmatrix}\n0  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & \\mu\n\\end{bmatrix}\n$$\n$A(\\mu)$ 的右下角块是一个 $2 \\times 2$ 的零矩阵，这是 KKT 系统的特征，也是该矩阵不定的根源。将这些块组装起来，得到完整的 $6 \\times 6$ KKT 矩阵 $A(\\mu)$。\n\n对于测试套件中的每一对参数 $(\\phi, \\tau)$，我们构建相应的矩阵 $A(\\mu)$。然后，使用一种稀疏 LU 分解算法对该矩阵进行分解，该算法结合了阈值部分主元法和列预排序以减少填充。分解过程计算置换矩阵 $P$（行）和 $Q$（列），以及单位下/上三角矩阵 $L$ 和 $U$，使得 $PAQ = LU$。\n- 列置换 $Q$ 由对称列近似最小度 (COLAMD) 算法确定，该算法旨在通过重排 $A$ 的列来最小化填充（$\\operatorname{nnz}(L+U)$）。\n- 行置换 $P$ 在分解过程中由阈值部分主元法确定，其参数为 $\\tau \\in (0, 1]$。在每一步 $k$，算法从当前列中选择一个主元 $a_{ik}$，使得 $|a_{ik}| \\ge \\tau \\cdot \\max_j |a_{jk}|$。$\\tau=1.0$ 的值强制执行经典的部分主元法（最大稳定性），而较小的 $\\tau$ 值则放宽了这一条件，使算法有更多自由度来选择可能更有利于保持稀疏性的主元。\n\n分解后，我们计算两个度量来评估性能：\n1. 增长因子 $\\gamma$ 作为分解数值稳定性的代理。它定义为计算出的上三角因子 $U$ 中的最大绝对值与原始矩阵 $A$ 中的最大绝对值之比：\n$$\n\\gamma(A,L,U) = \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |A_{ij}|}\n$$\n期望增长因子较小，因为它表明矩阵元素的大小在消元过程中没有过度增长，这与更好的后向稳定性相关。\n\n2. 填充率 $\\rho$ 衡量算法的稀疏性保持能力。它是因子 $L$ 和 $U$ 中非零元素总数与原始矩阵 $A$ 中非零元素数量之比：\n$$\n\\rho(A,L,U) = \\frac{\\operatorname{nnz}(L) + \\operatorname{nnz}(U)}{\\operatorname{nnz}(A)}\n$$\n根据问题规范，因子 $L$ 的单位对角线被显式存储并包含在 $\\operatorname{nnz}(L)$ 中。接近 $1$ 的 $\\rho$ 值表示填充最少，这对于内存和计算时间效率而言是理想的。\n\n计算过程遍历 $\\phi \\in \\{20, 35, 45\\}$ 和 $\\tau \\in \\{1.0, 0.1, 0.01\\}$ 的所有 $9$ 种组合。对于每种组合，构造相应的 $A(\\mu)$，进行分解，并计算和存储 $(\\gamma, \\rho)$ 对。最终输出是按指定格式排列的这些结果的列表。该实现将使用 `scipy.sparse.linalg.splu` 函数，该函数提供了对 SuperLU 库的访问以执行这些操作。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import csc_matrix\nfrom scipy.sparse.linalg import splu\n\ndef solve():\n    \"\"\"\n    Constructs and analyzes a KKT system from a simplified contact mechanics problem.\n    This function iterates through specified friction angles and pivot thresholds,\n    performs a sparse LU factorization for each case, and computes stability and\n    sparsity metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    k1 = 120.0\n    k2 = 80.0\n    k12 = 50.0\n\n    phi_vals = [20.0, 35.0, 45.0]\n    tau_vals = [1.0, 0.1, 0.01]\n\n    # Create all combinations of (phi, tau)\n    test_cases = [(phi, tau) for phi in phi_vals for tau in tau_vals]\n\n    # Construct the constant stiffness matrix K\n    K = np.array([\n        [k1 + k12, 0, -k12, 0],\n        [0, k1 + k12, 0, -k12],\n        [-k12, 0, k2 + k12, 0],\n        [0, -k12, 0, k2 + k12]\n    ])\n\n    results = []\n    for phi, tau in test_cases:\n        # 1. Construct the matrix A(mu) for the current case\n        \n        # Convert friction angle from degrees to radians and compute mu\n        mu = np.tan(np.deg2rad(phi))\n\n        # Construct the constraint Jacobian J(mu)\n        J = np.array([\n            [0, 0, 1, 0],\n            [0, 0, 0, mu]\n        ])\n\n        # Assemble the 6x6 KKT matrix A(mu)\n        A = np.block([\n            [K, J.T],\n            [J, np.zeros((2, 2))]\n        ])\n\n        # Convert to compressed sparse column (CSC) format for factorization\n        A_sparse = csc_matrix(A)\n        \n        # 2. Perform sparse LU factorization with specified options\n        \n        # permc_spec='COLAMD': Symmetric column approximate minimum degree ordering\n        # options={'DiagPivotThresh': tau}: Threshold for partial pivoting\n        lu_factors = splu(A_sparse, permc_spec='COLAMD', options={'DiagPivotThresh': tau})\n\n        # 3. Compute stability and sparsity metrics\n        \n        # Stability metric: Growth factor gamma\n        max_abs_A = np.max(np.abs(A))\n        if max_abs_A == 0:\n            max_abs_A = 1.0  # Avoid division by zero\n        \n        # The .data attribute of a sparse matrix contains all non-zero values\n        if lu_factors.U.nnz > 0:\n            max_abs_U = np.max(np.abs(lu_factors.U.data))\n        else:\n            max_abs_U = 0.0\n            \n        gamma = max_abs_U / max_abs_A\n\n        # Sparsity metric: Fill-in ratio rho\n        nnz_A = A_sparse.nnz\n        # splu from SciPy/SuperLU returns L with explicit unit diagonal entries\n        nnz_L = lu_factors.L.nnz\n        nnz_U = lu_factors.U.nnz\n\n        if nnz_A > 0:\n            rho = (nnz_L + nnz_U) / nnz_A\n        else:\n            rho = 1.0\n\n        # Append the computed values for this test case\n        results.append([phi, tau, gamma, rho])\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts each inner list [p, t, g, r] to its string representation.\n    # The ','.join(...) creates a single string from these list-strings, separated by commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}