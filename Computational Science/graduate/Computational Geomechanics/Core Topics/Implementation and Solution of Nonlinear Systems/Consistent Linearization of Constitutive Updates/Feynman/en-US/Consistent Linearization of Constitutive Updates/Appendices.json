{
    "hands_on_practices": [
        {
            "introduction": "This first practice is a cornerstone exercise for any computational mechanician. You will work through the complete derivation of the consistent algorithmic tangent for the widely used Drucker–Prager model, starting from the closest-point projection principle. Mastering this fundamental procedure  is essential for understanding how to correctly implement complex material models within implicit finite element codes.",
            "id": "3508082",
            "problem": "Consider a small-strain, rate-independent, isotropic elastoplastic model for a geomaterial governed by the Drucker–Prager (DP) yield condition with associative flow. The elastic response is linear and isotropic, with bulk modulus $K$ and shear modulus $G$, and the additive strain decomposition $ \\epsilon = \\epsilon^{e} + \\epsilon^{p} $ holds. Let the Cauchy stress be denoted by $ \\sigma $, with hydrostatic pressure $ p = \\tfrac{1}{3} \\operatorname{tr}(\\sigma) $ and deviatoric stress $ s = \\sigma - p I $, where $I$ is the second-order identity. The second invariant of the deviatoric stress is represented by $ q = \\sqrt{\\tfrac{3}{2} s : s} $. The Drucker–Prager yield function is \n$$\nf(\\sigma) = q + \\alpha p - k,\n$$\nwith constant material parameters $\\alpha > 0$ and $k > 0$, and the associative plastic flow is defined by $ \\dot{\\epsilon}^{p} = \\dot{\\lambda}\\, \\partial f / \\partial \\sigma $ with plastic multiplier $\\dot{\\lambda} \\ge 0$. Assume perfect plasticity (no hardening).\n\nYou are to work entirely in stress space and use the closest-point projection (in the metric induced by the elastic compliance tensor) to return an elastic trial stress to the yield surface when plastic loading occurs. Start from the fundamental definitions above and from linear elasticity. Do not assume any formula not derivable from these bases.\n\nData for this problem:\n- Elastic moduli: $K = 100$ MPa, $G = 40$ MPa.\n- Drucker–Prager parameters: $\\alpha = 0.2$, $k = 2$ MPa.\n- Elastic trial stress at the end of a load increment: \n$$\n\\sigma^{\\mathrm{tr}} = \\begin{pmatrix} 10 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\text{ MPa}.\n$$\n\nTasks:\n1. Formulate the closest-point projection problem in stress space for this model as a constrained minimization and derive the first-order optimality conditions that define the return mapping. Use these to express the updated stress $ \\sigma_{n+1} $ in terms of $ \\sigma^{\\mathrm{tr}} $ and the plastic multiplier increment $ \\Delta \\lambda $, and also to obtain a scalar nonlinear equation for $ \\Delta \\lambda $ by enforcing consistency $ f(\\sigma_{n+1}) = 0 $.\n2. Solve the consistency equation to obtain a closed-form expression for $ \\Delta \\lambda $ in terms of the invariants $ p^{\\mathrm{tr}} $ and $ q^{\\mathrm{tr}} $, and then compute the updated invariants $ p_{n+1} $ and $ q_{n+1} $ explicitly for the given data.\n3. Compute the linearization (consistent algorithmic tangent) of the return mapping to obtain the fourth-order algorithmic modulus tensor $ \\mathbb{C}^{\\mathrm{alg}} $ at the updated state. Work from the linearization of the optimality system you derived, and express $ \\mathbb{C}^{\\mathrm{alg}} $ in terms of the elastic tensor, the flow direction, and appropriate contractions. Then, define the algorithmic bulk modulus $ K^{\\mathrm{alg}} $ as the scalar mapping $ K^{\\mathrm{alg}} = \\mathrm{d}p / \\mathrm{d}\\epsilon_{v} $ for an incremental purely volumetric strain perturbation (with $ \\epsilon_{v} = \\operatorname{tr}(\\epsilon) $), and evaluate $ K^{\\mathrm{alg}} $ in closed form for the Drucker–Prager model at the updated state.\n4. Using the provided numerical data, evaluate $ K^{\\mathrm{alg}} $ numerically. Round your answer to four significant figures. Express the final result in MPa.",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in computational plasticity. Therefore, the problem is deemed valid. We proceed with the solution.\n\n### Task 1: Closest-Point Projection Formulation\n\nThe problem is to find the updated stress state $\\sigma_{n+1}$ that is closest to the elastic trial stress $\\sigma^{\\mathrm{tr}}$ while satisfying the yield condition $f(\\sigma_{n+1}) \\le 0$. The \"distance\" is measured in the energy norm defined by the inverse of the elastic stiffness tensor, $\\mathbb{M}^e = (\\mathbb{C}^e)^{-1}$. This is a constrained optimization problem:\n$$\n\\text{Minimize} \\quad \\frac{1}{2} (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) : \\mathbb{M}^e : (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) \\quad \\text{subject to} \\quad f(\\sigma_{n+1}) \\le 0.\n$$\nFor a plastic step, the constraint is active, $f(\\sigma_{n+1}) = 0$. The Lagrangian for this problem is:\n$$\n\\mathcal{L}(\\sigma_{n+1}, \\Delta\\lambda) = \\frac{1}{2} (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) : \\mathbb{M}^e : (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) + \\Delta\\lambda f(\\sigma_{n+1})\n$$\nwhere $\\Delta\\lambda \\ge 0$ is the Lagrange multiplier, identifiable as the consistent plastic multiplier increment. The first-order optimality conditions are:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\sigma_{n+1}} = \\mathbb{M}^e : (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) + \\Delta\\lambda \\frac{\\partial f}{\\partial \\sigma_{n+1}} = \\mathbf{0}\n$$\n$$\nf(\\sigma_{n+1}) = 0\n$$\nFrom the first condition, we obtain the return mapping algorithm:\n$$\n\\sigma_{n+1} - \\sigma^{\\mathrm{tr}} = - \\Delta\\lambda (\\mathbb{M}^e)^{-1} : \\frac{\\partial f}{\\partial \\sigma_{n+1}} \\implies \\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - \\Delta\\lambda \\mathbb{C}^e : \\frac{\\partial f}{\\partial \\sigma_{n+1}}\n$$\nThis structure is identical to the one derived from the discrete flow rule $\\Delta\\epsilon^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\sigma_{n+1}}$ and the stress update $\\sigma_{n+1} = \\mathbb{C}^e : (\\epsilon_{n+1} - \\epsilon^p_{n+1}) = \\sigma^{\\mathrm{tr}} - \\mathbb{C}^e : \\Delta\\epsilon^p$.\n\nTo proceed, we need the gradient of the yield function $f(\\sigma) = q + \\alpha p - k$. The derivatives of the invariants are:\n$$\n\\frac{\\partial p}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} \\left(\\frac{1}{3} I:\\sigma\\right) = \\frac{1}{3} I\n$$\n$$\n\\frac{\\partial q}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} \\left(\\sqrt{\\frac{3}{2} s:s}\\right) = \\sqrt{\\frac{3}{2}} \\frac{s}{\\sqrt{s:s}} = \\frac{3}{2} \\frac{s}{q}\n$$\nThe gradient of the yield function, which defines the direction of plastic flow $R$, is:\n$$\nR = \\frac{\\partial f}{\\partial \\sigma} = \\frac{3}{2} \\frac{s}{q} + \\frac{\\alpha}{3} I\n$$\nThe isotropic elastic tensor is $\\mathbb{C}^e = K I \\otimes I + 2G \\mathbb{P}_{\\mathrm{dev}}$, where $\\mathbb{P}_{\\mathrm{dev}} = \\mathbb{I} - \\frac{1}{3}I \\otimes I$ is the deviatoric projection tensor. Applying this tensor to $R$:\n$$\n\\mathbb{C}^e : R = \\mathbb{C}^e : \\left(\\frac{3}{2} \\frac{s}{q}\\right) + \\mathbb{C}^e : \\left(\\frac{\\alpha}{3} I\\right)\n$$\nSince $\\frac{s}{q}$ is deviatoric and $I$ is volumetric, we get:\n$$\n\\mathbb{C}^e : R = 2G \\left(\\frac{3}{2} \\frac{s}{q}\\right) + K (I \\otimes I) : \\left(\\frac{\\alpha}{3} I\\right) = 3G \\frac{s}{q} + \\alpha K I\n$$\nSubstituting this into the return mapping equation, evaluated at $\\sigma_{n+1}$:\n$$\n\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - \\Delta\\lambda \\left( 3G \\frac{s_{n+1}}{q_{n+1}} + \\alpha K I \\right)\n$$\nDecomposing into hydrostatic and deviatoric parts ($s_{n+1} = \\sigma_{n+1} - p_{n+1}I$):\n$$\np_{n+1}I + s_{n+1} = p^{\\mathrm{tr}}I + s^{\\mathrm{tr}} - \\Delta\\lambda (\\alpha K I) - \\Delta\\lambda \\left( 3G \\frac{s_{n+1}}{q_{n+1}} \\right)\n$$\nEquating the respective parts gives the update rules for the invariants:\nHydrostatic: $p_{n+1} = p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda$\nDeviatoric: $s_{n+1} = s^{\\mathrm{tr}} - 3G \\Delta\\lambda \\frac{s_{n+1}}{q_{n+1}} \\implies s_{n+1}\\left(1 + \\frac{3G \\Delta\\lambda}{q_{n+1}}\\right) = s^{\\mathrm{tr}}$.\nThis implies $s_{n+1}$ and $s^{\\mathrm{tr}}$ are coaxial. Taking the norm $\\sqrt{\\frac{3}{2} \\cdot:\\cdot}$ of the deviatoric equation gives:\n$q_{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$.\n\nThe scalar equation for $\\Delta\\lambda$ is obtained by enforcing the consistency condition $f(\\sigma_{n+1}) = 0$:\n$$\nq_{n+1} + \\alpha p_{n+1} - k = 0\n$$\n$$\n(q^{\\mathrm{tr}} - 3G \\Delta\\lambda) + \\alpha (p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda) - k = 0\n$$\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k) - (3G + \\alpha^2 K) \\Delta\\lambda = 0\n$$\nThis simplifies to $f(\\sigma^{\\mathrm{tr}}) - (3G + \\alpha^2 K) \\Delta\\lambda = 0$.\n\n### Task 2: Solve for $\\Delta\\lambda$ and Compute Updated Invariants\n\nFrom the consistency equation, if plastic loading occurs ($f(\\sigma^{\\mathrm{tr}}) > 0$), the plastic multiplier increment is:\n$$\n\\Delta\\lambda = \\frac{f(\\sigma^{\\mathrm{tr}})}{3G + \\alpha^2 K} = \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha^2 K}\n$$\nFirst, we compute the invariants of the trial stress $\\sigma^{\\mathrm{tr}} = \\begin{pmatrix} 10 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$ MPa.\nTrial pressure: $p^{\\mathrm{tr}} = \\frac{1}{3}\\operatorname{tr}(\\sigma^{\\mathrm{tr}}) = \\frac{1}{3}(10+0+0) = \\frac{10}{3}$ MPa.\nTrial deviatoric stress: $s^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}} - p^{\\mathrm{tr}}I = \\begin{pmatrix} 20/3 & 0 & 0 \\\\ 0 & -10/3 & 0 \\\\ 0 & 0 & -10/3 \\end{pmatrix}$ MPa.\nTrial deviatoric stress invariant:\n$q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}s^{\\mathrm{tr}}:s^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2}\\left[\\left(\\frac{20}{3}\\right)^2 + \\left(-\\frac{10}{3}\\right)^2 + \\left(-\\frac{10}{3}\\right)^2\\right]} = \\sqrt{\\frac{3}{2}\\frac{600}{9}} = \\sqrt{100} = 10$ MPa.\n\nNext, we check the yield condition with the material parameters $\\alpha=0.2$ and $k=2$ MPa:\n$f(\\sigma^{\\mathrm{tr}}) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k = 10 + 0.2 \\left(\\frac{10}{3}\\right) - 2 = 8 + \\frac{2}{3} = \\frac{26}{3}$ MPa.\nSince $f(\\sigma^{\\mathrm{tr}}) > 0$, plastic loading occurs.\n\nWe compute the denominator $3G + \\alpha^2 K$ with $G=40$ MPa and $K=100$ MPa:\n$3G + \\alpha^2 K = 3(40) + (0.2)^2(100) = 120 + 0.04(100) = 120 + 4 = 124$ MPa.\nThe plastic multiplier is:\n$\\Delta\\lambda = \\frac{26/3}{124} = \\frac{26}{3 \\cdot 124} = \\frac{13}{186}$.\n\nFinally, we compute the updated invariants $p_{n+1}$ and $q_{n+1}$:\n$p_{n+1} = p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda = \\frac{10}{3} - (0.2)(100)\\left(\\frac{13}{186}\\right) = \\frac{10}{3} - \\frac{260}{186} = \\frac{620 - 260}{186} = \\frac{360}{186} = \\frac{60}{31}$ MPa.\n$q_{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda = 10 - 3(40)\\left(\\frac{13}{186}\\right) = 10 - \\frac{1560}{186} = \\frac{1860 - 1560}{186} = \\frac{300}{186} = \\frac{50}{31}$ MPa.\nWe can check consistency: $q_{n+1} + \\alpha p_{n+1} - k = \\frac{50}{31} + 0.2\\left(\\frac{60}{31}\\right) - 2 = \\frac{50+12}{31} - 2 = \\frac{62}{31} - 2 = 2 - 2 = 0$.\n\n### Task 3: Algorithmic Tangent and Algorithmic Bulk Modulus\n\nThe consistent algorithmic tangent modulus is $\\mathbb{C}^{\\mathrm{alg}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}}$. For a total strain-driven problem, the trial stress is $\\sigma^{\\mathrm{tr}} = \\mathbb{C}^e : (\\epsilon_{n+1}-\\epsilon^{p}_n)$, so $\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\mathbb{C}^e : \\mathrm{d}\\epsilon_{n+1}$. Thus, $\\mathbb{C}^{\\mathrm{alg}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\sigma^{\\mathrm{tr}}} : \\mathbb{C}^e$.\n\nFor plastic loading, the state is governed by the system:\n$\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - \\Delta\\lambda \\mathbb{C}^e : R$\n$f(\\sigma_{n+1}) = 0$.\nwhere $R = \\frac{\\partial f}{\\partial\\sigma}\\Big|_{\\sigma_{n+1}}$. For a radial return algorithm (as derived for DP), the direction of the deviatoric part of the flow vector is constant during the iteration, so we can use $R \\approx R^{\\mathrm{tr}} = \\frac{\\partial f}{\\partial\\sigma}\\Big|_{\\sigma^{\\mathrm{tr}}}$.\nUpon differentiation, maintaining consistency $d f(\\sigma_{n+1}) = R : d\\sigma_{n+1} = 0$:\n$R : (\\mathrm{d}\\sigma^{\\mathrm{tr}} - \\mathrm{d}(\\Delta\\lambda) \\mathbb{C}^e : R) = 0 \\implies \\mathrm{d}(\\Delta\\lambda) = \\frac{R:\\mathrm{d}\\sigma^{\\mathrm{tr}}}{R:\\mathbb{C}^e:R}$.\nWe calculated $R:\\mathbb{C}^e:R = 3G + \\alpha^2 K$.\nSubstituting $\\mathrm{d}(\\Delta\\lambda)$ back into the linearized return map $\\mathrm{d}\\sigma_{n+1} = \\mathrm{d}\\sigma^{\\mathrm{tr}} - \\mathrm{d}(\\Delta\\lambda) \\mathbb{C}^e:R$:\n$$\n\\mathrm{d}\\sigma_{n+1} = \\mathrm{d}\\sigma^{\\mathrm{tr}} - \\frac{R:\\mathrm{d}\\sigma^{\\mathrm{tr}}}{3G+\\alpha^2K} (\\mathbb{C}^e:R) = \\left( \\mathbb{I} - \\frac{(\\mathbb{C}^e:R) \\otimes R}{3G+\\alpha^2K} \\right) : \\mathrm{d}\\sigma^{\\mathrm{tr}}\n$$\nFrom this, $\\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\sigma^{\\mathrm{tr}}}$ is identified. The algorithmic tangent is:\n$$\n\\mathbb{C}^{\\mathrm{alg}} = \\left( \\mathbb{I} - \\frac{(\\mathbb{C}^e:R) \\otimes R}{3G+\\alpha^2K} \\right) : \\mathbb{C}^e = \\mathbb{C}^e - \\frac{(\\mathbb{C}^e:R) \\otimes (\\mathbb{C}^e:R)}{3G+\\alpha^2K}\n$$\n\nThe algorithmic bulk modulus is $K^{\\mathrm{alg}} = \\mathrm{d}p / \\mathrm{d}\\epsilon_{v}$ for a purely volumetric strain increment $\\mathrm{d}\\epsilon = \\mathrm{d}\\epsilon_v \\frac{1}{3}I$. This corresponds to a trial stress increment $\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\mathbb{C}^e : (\\mathrm{d}\\epsilon_v \\frac{1}{3}I) = K \\mathrm{d}\\epsilon_v I = \\mathrm{d}p^{\\mathrm{tr}} I$.\nThe change in pressure is $\\mathrm{d}p_{n+1} = \\frac{1}{3} I : \\mathrm{d}\\sigma_{n+1}$. Using the expression for $\\mathrm{d}\\sigma_{n+1}$:\n$$\n\\mathrm{d}p_{n+1} = \\frac{1}{3}I : \\left( \\mathrm{d}\\sigma^{\\mathrm{tr}} - \\frac{R:\\mathrm{d}\\sigma^{\\mathrm{tr}}}{3G+\\alpha^2K} (\\mathbb{C}^e:R) \\right)\n$$\nWith $\\mathrm{d}\\sigma^{\\mathrm{tr}} = K \\mathrm{d}\\epsilon_v I$:\n$\\frac{1}{3}I:\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\frac{1}{3}I:(K\\mathrm{d}\\epsilon_v I) = K\\mathrm{d}\\epsilon_v$.\n$R:\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\left(\\frac{3}{2}\\frac{s^{\\mathrm{tr}}}{q^{\\mathrm{tr}}} + \\frac{\\alpha}{3} I\\right) : (K\\mathrm{d}\\epsilon_v I) = 0 + \\frac{\\alpha}{3}K\\mathrm{d}\\epsilon_v (I:I) = \\alpha K \\mathrm{d}\\epsilon_v$.\n$\\frac{1}{3}I:(\\mathbb{C}^e:R) = \\frac{1}{3}I:\\left(3G\\frac{s^{\\mathrm{tr}}}{q^{\\mathrm{tr}}} + \\alpha K I\\right) = 0 + \\frac{1}{3}\\alpha K (I:I) = \\alpha K$.\nSubstituting these parts back:\n$$\n\\mathrm{d}p_{n+1} = K\\mathrm{d}\\epsilon_v - \\frac{\\alpha K \\mathrm{d}\\epsilon_v}{3G+\\alpha^2K}(\\alpha K) = K\\mathrm{d}\\epsilon_v \\left(1 - \\frac{\\alpha^2 K}{3G+\\alpha^2K}\\right)\n$$\n$$\n\\mathrm{d}p_{n+1} = K\\mathrm{d}\\epsilon_v \\left(\\frac{3G+\\alpha^2K - \\alpha^2 K}{3G+\\alpha^2K}\\right) = K \\frac{3G}{3G+\\alpha^2K} \\mathrm{d}\\epsilon_v\n$$\nThus, the algorithmic bulk modulus is:\n$$\nK^{\\mathrm{alg}} = \\frac{\\mathrm{d}p_{n+1}}{\\mathrm{d}\\epsilon_v} = K \\frac{3G}{3G+\\alpha^2K}\n$$\n\n### Task 4: Numerical Evaluation of Algorithmic Bulk Modulus\n\nUsing the given data: $K = 100$ MPa, $G = 40$ MPa, $\\alpha=0.2$.\n$$\nK^{\\mathrm{alg}} = 100 \\frac{3(40)}{3(40) + (0.2)^2(100)} = 100 \\frac{120}{120 + 0.04(100)} = 100 \\frac{120}{120+4}\n$$\n$$\nK^{\\mathrm{alg}} = 100 \\frac{120}{124} = 100 \\frac{30}{31} = \\frac{3000}{31} \\approx 96.77419... \\text{ MPa}\n$$\nRounding to four significant figures, the result is $96.77$ MPa.",
            "answer": "$$\n\\boxed{96.77}\n$$"
        },
        {
            "introduction": "While analytical derivations are crucial, seeing the theory in action provides a deeper and more practical understanding. This exercise  moves from pen-and-paper to implementation, tasking you with solving a coupled poromechanics problem using Newton's method. By comparing the convergence behavior when using the exact (consistent) tangent versus an approximate (inconsistent) one, you will directly observe the critical role of consistent linearization in achieving quadratic convergence and numerical efficiency.",
            "id": "3508087",
            "problem": "Consider a one-dimensional confined compression test with drainage of a saturated porous medium governed by Biot's theory of poromechanics. Let the unknowns at the end of a time step be the volumetric strain $e$ of the solid skeleton and the pore pressure $p$ of the pore fluid. Work under the small-strain, quasi-static, isothermal, single-phase fluid assumptions. Let the total Cauchy stress in the axial loading direction be given by $\\sigma = \\sigma^{\\prime} - \\alpha\\,p$, where $\\sigma^{\\prime}$ is the effective stress of the skeleton and $\\alpha$ is the Biot coefficient. Adopt a nonlinear elastic volumetric effective stress law $\\sigma^{\\prime}(e) = K_0\\,e + \\beta\\,e^3$ with $K_0 > 0$ and $\\beta \\ge 0$. Assume backward Euler time discretization of the fluid mass balance with storage coefficient $S$ and a lumped hydraulic conductance term $\\ell$ to represent drainage to an external reservoir at zero external pressure. All physical quantities are scalar in this setting.\n\nFrom first principles, derive the coupled nonlinear residual vector $\\boldsymbol{r}(e,p)$, based on:\n- Total stress equilibrium with an applied axial total stress at the end of step $\\sigma_{\\text{app}}$,\n- Backward Euler discretization of the fluid mass balance with storage and a linearized drainage term proportional to $p$.\n\nHere, $e^n$ and $p^n$ denote the converged values at the previous time step, and $\\Delta t$ is the time step.\n\nThen, derive the consistent tangent (Jacobian) matrix $\\boldsymbol{K}_{\\text{cons}}(e,p)$ as the exact derivative of $\\boldsymbol{r}(e,p)$ with respect to the unknowns $(e,p)$. Define also an inconsistent solid tangent $\\boldsymbol{K}_{\\text{incons}}(e,p)$ obtained by replacing the derivative $\\mathrm{d}\\sigma^{\\prime}/\\mathrm{d}e$ in the momentum block with the constant $K_0$ (i.e., ignoring the contribution from the nonlinear term $\\beta\\,e^3$), while keeping all other Jacobian entries exact.\n\nYour program must:\n- Implement Newton's method to solve $\\boldsymbol{r}(e,p) = \\boldsymbol{0}$ with both the consistent tangent and the inconsistent tangent. Use the same initial guess $(e^0,p^0) = (e^n,p^n)$ for both solves.\n- Use a backtracking line search on the Newton update to ensure robust convergence, with a sufficient decrease criterion on the Euclidean norm of the residual.\n- Terminate when the ratio $\\lVert \\boldsymbol{r}_k \\rVert_2 / \\lVert \\boldsymbol{r}_0 \\rVert_2 \\le \\varepsilon$ with tolerance $\\varepsilon$, or when a maximum number of iterations is reached. If the initial residual is zero, return zero iterations.\n- Report, for each test case, two integers: the number of Newton iterations for the consistent tangent and for the inconsistent tangent, each being the number of nonlinear iterations performed to reach the specified tolerance. If the method fails to converge within the iteration cap, return the cap value plus one for that method.\n\nBase your derivation on the following foundational relations:\n- Effective stress principle: $\\sigma = \\sigma^{\\prime} - \\alpha\\,p$,\n- Volumetric nonlinear elastic law: $\\sigma^{\\prime}(e) = K_0\\,e + \\beta\\,e^3$ with tangent $\\mathrm{d}\\sigma^{\\prime}/\\mathrm{d}e = K_0 + 3\\,\\beta\\,e^2$,\n- Backward Euler fluid mass balance for a lumped system exchanging mass with an external reservoir at zero pressure: $\\alpha\\,(e - e^n) + S\\,(p - p^n) + \\Delta t\\,\\ell\\,p = 0$.\n\nUse the following units and numerical requirements:\n- Express stress-related quantities in megapascals (MPa), time in seconds (s), and strains as dimensionless.\n- The storage $S$ must be in $\\text{MPa}^{-1}$, the conductance $\\ell$ in $\\text{MPa}^{-1}\\,\\text{s}^{-1}$, and the Biot coefficient $\\alpha$ is dimensionless.\n- Use a convergence tolerance $\\varepsilon = 10^{-10}$, a maximum of $N_{\\max} = 50$ Newton iterations, an Armijo parameter $c = 10^{-4}$, and a backtracking factor $\\gamma = 0.5$.\n\nTest suite:\n- Case A (near-linear, happy path): $K_0 = 1000$, $\\beta = 0$, $\\alpha = 1.0$, $S = 10^{-3}$, $\\Delta t = 1.0$, \\,$\\ell = 10^{-2}$, $\\sigma_{\\text{app}} = 10$, $e^n = 0$, $p^n = 0$.\n- Case B (moderate nonlinearity, moderate coupling): $K_0 = 1000$, $\\beta = 5\\times 10^{5}$, $\\alpha = 0.9$, $S = 10^{-3}$, $\\Delta t = 1.0$, \\,$\\ell = 10^{-2}$, $\\sigma_{\\text{app}} = 100$, $e^n = 0$, $p^n = 0$.\n- Case C (strong nonlinearity, stiff coupling): $K_0 = 1000$, $\\beta = 10^{6}$, $\\alpha = 0.9$, $S = 10^{-6}$, $\\Delta t = 5.0$, \\,$\\ell = 10^{-1}$, $\\sigma_{\\text{app}} = 100$, $e^n = 0$, $p^n = 0$.\n\nAll numerical values above are in their specified units. For example, $K_0$ and $\\beta$ are in megapascals, $\\Delta t$ is in seconds.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as:\n$[\\text{it}_{\\text{cons},A}, \\text{it}_{\\text{incons},A}, \\text{it}_{\\text{cons},B}, \\text{it}_{\\text{incons},B}, \\text{it}_{\\text{cons},C}, \\text{it}_{\\text{incons},C}]$,\nwhere each entry is an integer equal to the number of iterations used by the corresponding Newton solve. If a solve fails to converge in at most $N_{\\max}$ iterations, report $N_{\\max} + 1$ for that entry.",
            "solution": "The problem requires the derivation of the governing equations and the implementation of a numerical solution for a one-dimensional, quasi-static, poromechanical system. The state of the system at the end of a time step is described by two scalar unknowns: the volumetric strain of the solid skeleton, $e$, and the pore fluid pressure, $p$. We assemble these into a state vector $\\boldsymbol{x} = [e, p]^T$. The problem is to find $\\boldsymbol{x}$ that solves the nonlinear system of equations $\\boldsymbol{r}(\\boldsymbol{x}) = \\boldsymbol{0}$, where $\\boldsymbol{r}$ is the residual vector.\n\nThe residual vector is derived from two fundamental physical principles: the balance of momentum (stress equilibrium) and the balance of fluid mass.\n\nFirst, we establish the residual component from the momentum balance equation. In this quasi-static, one-dimensional setting, the total stress $\\sigma$ must be in equilibrium with the externally applied stress, $\\sigma_{\\text{app}}$. The first residual equation, $r_1$, expresses this balance:\n$$r_1(e,p) = \\sigma - \\sigma_{\\text{app}} = 0$$\nThe problem provides the effective stress principle, $\\sigma = \\sigma^{\\prime} - \\alpha p$, where $\\sigma^{\\prime}$ is the effective stress and $\\alpha$ is the Biot coefficient. The constitutive law for the solid skeleton is a nonlinear elastic relation between effective stress and volumetric strain: $\\sigma^{\\prime}(e) = K_0 e + \\beta e^3$. Substituting these relationships into the equilibrium equation gives the first component of the residual vector:\n$$r_1(e,p) = (K_0 e + \\beta e^3) - \\alpha p - \\sigma_{\\text{app}}$$\n\nSecond, we establish the residual component from the fluid mass balance. The problem provides the time-discretized form of this balance equation using the backward Euler method. This equation relates the change in strain, the change in pressure, and the drainage of pore fluid over a time step $\\Delta t$. Let $e^n$ and $p^n$ be the converged values from the previous time step. The fluid mass balance is given as:\n$$\\alpha(e - e^n) + S(p - p^n) + \\Delta t \\, \\ell \\, p = 0$$\nwhere $S$ is the storage coefficient and $\\ell$ is the hydraulic conductance. The second residual component, $r_2$, is simply this equation rearranged:\n$$r_2(e,p) = \\alpha(e - e^n) + S(p - p^n) + \\Delta t \\, \\ell \\, p$$\nWe can group terms related to the current unknowns $(e, p)$ to write it as:\n$$r_2(e,p) = \\alpha e + (S + \\Delta t \\, \\ell)p - (\\alpha e^n + S p^n)$$\n\nCombining these two components, the full residual vector $\\boldsymbol{r}(e,p)$ is:\n$$\\boldsymbol{r}(e,p) = \\begin{pmatrix} r_1(e,p) \\\\ r_2(e,p) \\end{pmatrix} = \\begin{pmatrix} K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}} \\\\ \\alpha(e - e^n) + (S + \\Delta t \\, \\ell)p - S p^n \\end{pmatrix}$$\n\nTo solve the nonlinear system $\\boldsymbol{r}(\\boldsymbol{x}) = \\boldsymbol{0}$, we use Newton's method. This iterative method requires the consistent tangent matrix, which is the Jacobian of the residual vector with respect to the state variables, $\\boldsymbol{K}_{\\text{cons}} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\boldsymbol{x}}$. The matrix components are the partial derivatives of the residual components:\n$$\\boldsymbol{K}_{\\text{cons}}(e,p) = \\begin{pmatrix} \\frac{\\partial r_1}{\\partial e} & \\frac{\\partial r_1}{\\partial p} \\\\ \\frac{\\partial r_2}{\\partial e} & \\frac{\\partial r_2}{\\partial p} \\end{pmatrix}$$\n\nThe individual components are calculated as follows:\n$\\frac{\\partial r_1}{\\partial e} = \\frac{\\mathrm{d}}{\\mathrm{d}e} (K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}}) = K_0 + 3\\beta e^2$. This term is the tangent bulk modulus of the solid skeleton, $K_T(e)$.\n$\\frac{\\partial r_1}{\\partial p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} (K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}}) = -\\alpha$.\n$\\frac{\\partial r_2}{\\partial e} = \\frac{\\mathrm{d}}{\\mathrm{d}e} (\\alpha e + (S + \\Delta t \\, \\ell)p - \\alpha e^n - S p^n) = \\alpha$.\n$\\frac{\\partial r_2}{\\partial p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} (\\alpha e + (S + \\Delta t \\, \\ell)p - \\alpha e^n - S p^n) = S + \\Delta t \\, \\ell$.\n\nAssembling these gives the consistent tangent matrix:\n$$\\boldsymbol{K}_{\\text{cons}}(e,p) = \\begin{pmatrix} K_0 + 3\\beta e^2 & -\\alpha \\\\ \\alpha & S + \\Delta t \\, \\ell \\end{pmatrix}$$\n\nThe problem also defines an inconsistent tangent matrix, $\\boldsymbol{K}_{\\text{incons}}$, which is formed by approximating the tangent modulus of the solid skeleton, $\\frac{\\mathrm{d}\\sigma^{\\prime}}{\\mathrm{d}e}$, by its initial value, $K_0$. This means we replace the entry $\\frac{\\partial r_1}{\\partial e}$ in the consistent Jacobian with $K_0$:\n$$\\boldsymbol{K}_{\\text{incons}}(e,p) = \\begin{pmatrix} K_0 & -\\alpha \\\\ \\alpha & S + \\Delta t \\, \\ell \\end{pmatrix}$$\nThis tangent is exact only if the material response is linear ($\\beta=0$) or if the strain $e$ is zero. Using an inconsistent tangent typically degrades the convergence rate of Newton's method from quadratic to linear.\n\nThe Newton-Raphson update step for an iteration $k$ involves solving the linear system $\\boldsymbol{K}(\\boldsymbol{x}_k) \\Delta \\boldsymbol{x}_k = -\\boldsymbol{r}(\\boldsymbol{x}_k)$ for the update vector $\\Delta \\boldsymbol{x}_k = [\\Delta e_k, \\Delta p_k]^T$. The solution is then updated as $\\boldsymbol{x}_{k+1} = \\boldsymbol{x}_k + \\eta_k \\Delta \\boldsymbol{x}_k$. The step length $\\eta_k$ is determined by a backtracking line search to ensure a sufficient decrease in the residual norm, preventing divergence. The specific Armijo condition is $\\lVert \\boldsymbol{r}(\\boldsymbol{x}_k + \\eta_k \\Delta \\boldsymbol{x}_k) \\rVert_2 \\le (1 - c \\eta_k) \\lVert \\boldsymbol{r}(\\boldsymbol{x}_k) \\rVert_2$, with constants $c=10^{-4}$ and backtracking factor $\\gamma=0.5$. The iteration starts with an initial guess $\\boldsymbol{x}_0 = [e^n, p^n]^T$ and terminates when the relative residual norm $\\lVert \\boldsymbol{r}_k \\rVert_2 / \\lVert \\boldsymbol{r}_0 \\rVert_2$ falls below a tolerance $\\varepsilon=10^{-10}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef newton_solver(problem_params, initial_state, use_consistent_tangent):\n    \"\"\"\n    Solves the coupled nonlinear poromechanics problem using Newton's method.\n\n    Args:\n        problem_params (tuple): Physical and discretization parameters.\n        initial_state (tuple): Converged state from the previous step (e^n, p^n).\n        use_consistent_tangent (bool): Flag to use consistent or inconsistent tangent.\n\n    Returns:\n        int: Number of iterations to converge, or max_iter + 1 if failed.\n    \"\"\"\n    # Unpack parameters\n    K0, beta, alpha, S, dt, l, sigma_app = problem_params\n    e_n, p_n = initial_state\n\n    # Numerical solver settings\n    tol = 1e-10\n    max_iter = 50\n    c_armijo = 1e-4\n    gamma_bt = 0.5\n\n    # Initial guess for the state vector x = [e, p]\n    x = np.array([e_n, p_n], dtype=np.float64)\n\n    def compute_residual(x_vec):\n        \"\"\"Computes the residual vector r(x).\"\"\"\n        e, p = x_vec\n        r1 = K0 * e + beta * e**3 - alpha * p - sigma_app\n        r2 = alpha * (e - e_n) + S * (p - p_n) + dt * l * p\n        return np.array([r1, r2])\n\n    # Initial residual calculation\n    r0 = compute_residual(x)\n    norm_r0 = np.linalg.norm(r0)\n\n    # If initial guess is already the solution\n    if norm_r0 == 0.0:\n        return 0\n\n    # Main Newton iteration loop\n    for k in range(max_iter):\n        e_k, p_k = x\n        \n        # Calculate current residual and check for convergence\n        r_k = compute_residual(x)\n        norm_r_k = np.linalg.norm(r_k)\n        \n        if norm_r_k / norm_r0 = tol:\n            return k\n\n        # Compute the tangent matrix K\n        if use_consistent_tangent:\n            # Consistent tangent modulus\n            K11 = K0 + 3.0 * beta * e_k**2\n        else:\n            # Inconsistent (initial) tangent modulus\n            K11 = K0\n        \n        K = np.array([\n            [K11, -alpha],\n            [alpha, S + dt * l]\n        ], dtype=np.float64)\n\n        # Solve the linear system K * dx = -r for the update dx\n        try:\n            dx = np.linalg.solve(K, -r_k)\n        except np.linalg.LinAlgError:\n            # Matrix is singular, cannot proceed\n            return max_iter + 1\n\n        # Backtracking line search to find optimal step length eta\n        eta = 1.0\n        # Armijo condition: ||r(x + eta*dx)|| = (1 - c*eta) * ||r(x)||\n        # We perform a limited number of backtrackings to avoid infinite loops\n        max_backtrack_steps = 20\n        for _ in range(max_backtrack_steps):\n            x_trial = x + eta * dx\n            r_trial = compute_residual(x_trial)\n            norm_r_trial = np.linalg.norm(r_trial)\n            \n            if norm_r_trial = (1.0 - c_armijo * eta) * norm_r_k:\n                break  # Sufficient decrease, step is accepted\n            \n            eta *= gamma_bt\n        else:\n            # Line search failed to find a suitable step\n            return max_iter + 1\n\n        # Update the solution vector\n        x += eta * dx\n\n    # Final check after the loop completes (for convergence on the last iteration)\n    r_final = compute_residual(x)\n    if np.linalg.norm(r_final) / norm_r0 = tol:\n        return max_iter\n\n    # If loop finishes without convergence\n    return max_iter + 1\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: (K0, beta, alpha, S, dt, l, sigma_app, e_n, p_n)\n        (1000.0, 0.0, 1.0, 1e-3, 1.0, 1e-2, 10.0, 0.0, 0.0),\n        # Case B\n        (1000.0, 5e5, 0.9, 1e-3, 1.0, 1e-2, 100.0, 0.0, 0.0),\n        # Case C\n        (1000.0, 1e6, 0.9, 1e-6, 5.0, 1e-1, 100.0, 0.0, 0.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        # Extract problem parameters and initial state from the case tuple\n        problem_params = params[:7]\n        initial_state = params[7:]\n\n        # Solve with the consistent tangent\n        iters_cons = newton_solver(problem_params, initial_state, use_consistent_tangent=True)\n        results.append(iters_cons)\n\n        # Solve with the inconsistent tangent\n        iters_incons = newton_solver(problem_params, initial_state, use_consistent_tangent=False)\n        results.append(iters_incons)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world geomaterial behavior often involves complexities like softening or damage, which are modeled with internal variables subject to inequality constraints. This practice  delves into the advanced topic of linearizing these non-smooth constitutive laws, where a projection operator enforces a variable's admissibility. You will learn how to correctly linearize this operator and analyze how its non-differentiable nature impacts the continuity of the global algorithmic tangent, a key consideration for robust numerical solvers.",
            "id": "3508109",
            "problem": "Consider a rate-independent, small-strain, one-dimensional elastoplastic solid with a single scalar internal hardening variable subject to an admissibility constraint. The Cauchy stress is modeled by $ \\sigma = E \\left( \\epsilon - \\epsilon^{p} \\right) $, where $E$ is the Young modulus, $\\epsilon$ is the total strain, and $\\epsilon^{p}$ is the plastic strain. Plastic loading is governed by the yield function $ f(\\sigma, r) = |\\sigma| - \\left( \\sigma_{y0} + r \\right) \\le 0 $, where $\\sigma_{y0} > 0$ is the initial yield stress and $r$ is an isotropic hardening variable that must satisfy the admissibility constraint $ r \\ge 0 $. The flow rule is associative with accumulated plastic strain equal to the absolute plastic strain in one dimension.\n\nA backward-Euler return-mapping update from time step $n$ to $n+1$ is applied. Denote the plastic multiplier increment by $ \\Delta \\gamma \\ge 0 $. The discrete state update is\n- $ \\epsilon^{p}_{n+1} = \\epsilon^{p}_{n} + \\Delta \\gamma \\, s $, where $ s = \\operatorname{sign}(\\sigma_{n+1}) $ and $s \\in \\{-1, +1\\}$,\n- $ r^{\\text{trial}}_{n+1} = r_{n} + h \\, \\Delta \\gamma $, with a constant $ h > 0 $,\n- $ r_{n+1} = \\Pi\\left( r^{\\text{trial}}_{n+1} \\right) $, where the projection $ \\Pi(x) = \\max(x, 0) $ enforces $ r \\ge 0 $,\n- and the yield condition at $ n+1 $ is $ f(\\sigma_{n+1}, r_{n+1}) = 0 $ for plastic loading, with $ \\sigma_{n+1} = E \\left( \\epsilon_{n+1} - \\epsilon^{p}_{n+1} \\right) $.\n\nYou are to perform the consistent linearization of the above return-mapping equations needed by a Newton–Raphson method in a finite element implementation. Assume that the sign $ s = \\operatorname{sign}(\\sigma_{n+1}) $ is known and constant in the considered neighborhood (so that $ s^{2} = 1 $ and $ \\mathrm{d}s = 0 $). Denote by $ \\pi'(z) $ the classical derivative of the projection $ \\Pi $ evaluated at $ z = r^{\\text{trial}}_{n+1} $, i.e., $ \\pi'(z) = 1 $ if $ z > 0 $ and $ \\pi'(z) = 0 $ if $ z  0 $; you may assume the algorithm evaluates $ \\pi'(z) = 0 $ on the projected side when $ z \\le 0 $.\n\nDerive, from first principles, the closed-form expression for the normalized algorithmic tangent\n$$ \\mathcal{K} \\equiv \\frac{1}{E} \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} $$\nfor plastic loading with the projection active at the bound $ r_{n+1} = 0 $ (i.e., when $ r^{\\text{trial}}_{n+1}  0 $ so that the projection enforces $ r_{n+1} = 0 $). Your derivation must start from the residual statements implied by the return mapping and their consistent linearization, explicitly showing how the linearization of the projection operator enters. Conclude with the requested expression for $ \\mathcal{K} $ on the projected side of the bound.\n\nFinally, based on your linearization, assess whether the stress–strain map $ \\epsilon \\mapsto \\sigma $ is $ C^{0} $ or $ C^{1} $ at the bound $ r = 0 $ when approaching from the interior side $ r^{\\text{trial}}_{n+1} > 0 $ versus the projected side $ r^{\\text{trial}}_{n+1}  0 $, and explain why in terms of $ \\pi'(z) $. No numerical values are required. Report as your final answer only the closed-form expression for $ \\mathcal{K} $ at the bound approached from the projected side. This final quantity is unitless by construction and requires no rounding.",
            "solution": "The problem is validated as follows.\n\n### Step 1: Extract Givens\n-   **Constitutive Law**: The Cauchy stress is $\\sigma = E \\left( \\epsilon - \\epsilon^{p} \\right)$, where $E$ is Young's modulus, $\\epsilon$ is total strain, and $\\epsilon^{p}$ is plastic strain.\n-   **Yield Function**: Plastic loading is governed by $f(\\sigma, r) = |\\sigma| - \\left( \\sigma_{y0} + r \\right) \\le 0$, where $\\sigma_{y0} > 0$ is the initial yield stress.\n-   **Isotropic Hardening Variable**: $r$ is the hardening variable, subject to the admissibility constraint $r \\ge 0$.\n-   **Flow Rule**: The flow rule is associative.\n-   **Discrete State Update (Time Step $n$ to $n+1$)**:\n    -   Plastic multiplier increment: $\\Delta \\gamma \\ge 0$.\n    -   Plastic strain update: $\\epsilon^{p}_{n+1} = \\epsilon^{p}_{n} + \\Delta \\gamma \\, s$, where $s = \\operatorname{sign}(\\sigma_{n+1})$ and $s \\in \\{-1, +1\\}$.\n    -   Trial hardening variable: $r^{\\text{trial}}_{n+1} = r_{n} + h \\, \\Delta \\gamma$, with a constant $h > 0$.\n    -   Projected hardening variable: $r_{n+1} = \\Pi\\left( r^{\\text{trial}}_{n+1} \\right)$, where $\\Pi(x) = \\max(x, 0)$.\n    -   Yield condition for plastic loading: $f(\\sigma_{n+1}, r_{n+1}) = 0$.\n    -   Stress at $n+1$: $\\sigma_{n+1} = E \\left( \\epsilon_{n+1} - \\epsilon^{p}_{n+1} \\right)$.\n-   **Linearization Assumptions**:\n    -   The sign of stress is constant: $s = \\operatorname{sign}(\\sigma_{n+1})$ is known and fixed, so $\\mathrm{d}s = 0$.\n    -   The derivative of the projection operator is defined as: $\\pi'(z) = 1$ if $z > 0$ and $\\pi'(z) = 0$ if $z  0$, where $z = r^{\\text{trial}}_{n+1}$. The case $z \\le 0$ uses $\\pi'(z)=0$.\n-   **Objective**:\n    -   Derive the closed-form expression for the normalized algorithmic tangent $\\mathcal{K} \\equiv \\frac{1}{E} \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}}$ for plastic loading when the projection is active, i.e., $r^{\\text{trial}}_{n+1}  0$.\n    -   Assess the continuity class ($C^0$ or $C^1$) of the stress-strain map $\\epsilon \\mapsto \\sigma$ at the bound $r=0$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes a canonical backward-Euler return-mapping algorithm for a one-dimensional rate-independent elastoplastic model. The use of a projection operator to enforce inequality constraints on internal variables is a standard technique in computational mechanics, particularly in models for damage or softening. The problem is firmly rooted in the principles of computational geomechanics and continuum mechanics.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary equations, definitions, and assumptions to uniquely derive the requested algorithmic tangent. The objective is clearly stated.\n-   **Objective**: The problem is stated in precise, formal mathematical language, free from any subjective or biased phrasing.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. It is scientifically sound, formally structured, and objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe derivation of the consistent algorithmic tangent modulus, $\\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}}$, proceeds from the set of nonlinear algebraic equations defining the return-mapping algorithm. The core idea is to enforce the consistency condition, which states that the final state $(\\sigma_{n+1}, r_{n+1})$ must lie on the yield surface, i.e., $f(\\sigma_{n+1}, r_{n+1}) = 0$.\n\nFirst, we express the state variables at time $n+1$ in terms of the trial state and the plastic multiplier increment $\\Delta\\gamma$. The trial stress is defined by assuming a purely elastic step from $n$ to $n+1$:\n$$ \\sigma^{\\text{trial}}_{n+1} = E \\left( \\epsilon_{n+1} - \\epsilon^{p}_{n} \\right) $$\nThe actual stress at $n+1$ is then found by correcting the trial stress for the plastic deformation that occurs during the step:\n$$ \\sigma_{n+1} = E \\left( \\epsilon_{n+1} - \\epsilon^{p}_{n+1} \\right) = E \\left( \\epsilon_{n+1} - \\left( \\epsilon^{p}_{n} + \\Delta\\gamma \\, s \\right) \\right) = \\sigma^{\\text{trial}}_{n+1} - E s \\Delta\\gamma $$\nThe hardening variable at $n+1$ is given by the projection of the trial value:\n$$ r_{n+1} = \\Pi\\left( r^{\\text{trial}}_{n+1} \\right) = \\Pi\\left( r_{n} + h \\Delta\\gamma \\right) $$\nFor a plastic loading step, the discrete consistency condition must be satisfied:\n$$ f(\\sigma_{n+1}, r_{n+1}) = |\\sigma_{n+1}| - \\left(\\sigma_{y0} + r_{n+1}\\right) = 0 $$\nUsing the assumption that $s = \\operatorname{sign}(\\sigma_{n+1})$ is constant, we have $|\\sigma_{n+1}| = s \\sigma_{n+1}$. The consistency condition can be formulated as a scalar residual equation, $R$, which must be zero:\n$$ R(\\Delta\\gamma, \\epsilon_{n+1}) = s \\sigma_{n+1} - \\left( \\sigma_{y0} + r_{n+1} \\right) = 0 $$\nSubstituting the expressions for $\\sigma_{n+1}$ and $r_{n+1}$:\n$$ R = s \\left( \\sigma^{\\text{trial}}_{n+1} - E s \\Delta\\gamma \\right) - \\left( \\sigma_{y0} + \\Pi(r_{n} + h \\Delta\\gamma) \\right) = 0 $$\nSince $s^2 = 1$, this simplifies to a non-linear equation for $\\Delta\\gamma$:\n$$ R = |\\sigma^{\\text{trial}}_{n+1}| - E \\Delta\\gamma - \\sigma_{y0} - \\Pi(r_{n} + h \\Delta\\gamma) = 0 $$\nThe consistent tangent modulus is obtained by taking the total derivative of the residual equation, enforcing that the state remains on the yield surface for infinitesimal changes in strain, i.e., $\\mathrm{d}R = 0$.\n$$ \\mathrm{d}R = \\frac{\\partial R}{\\partial \\epsilon_{n+1}} \\mathrm{d}\\epsilon_{n+1} + \\frac{\\partial R}{\\partial \\Delta\\gamma} \\mathrm{d}\\Delta\\gamma = 0 $$\nWe compute the partial derivatives. First, with respect to $\\epsilon_{n+1}$:\n$$ \\frac{\\partial R}{\\partial \\epsilon_{n+1}} = \\frac{\\partial}{\\partial \\epsilon_{n+1}} \\left( |\\sigma^{\\text{trial}}_{n+1}| \\right) = s \\frac{\\partial \\sigma^{\\text{trial}}_{n+1}}{\\partial \\epsilon_{n+1}} = s E $$\nNext, with respect to $\\Delta\\gamma$. Let $z = r^{\\text{trial}}_{n+1} = r_n + h \\Delta\\gamma$.\n$$ \\frac{\\partial R}{\\partial \\Delta\\gamma} = \\frac{\\partial}{\\partial \\Delta\\gamma} \\left( -E \\Delta\\gamma - \\Pi(r_n + h \\Delta\\gamma) \\right) = -E - \\frac{\\mathrm{d}\\Pi(z)}{\\mathrm{d}z} \\frac{\\partial z}{\\partial \\Delta\\gamma} $$\nUsing the problem's notation $\\pi'(z) = \\frac{\\mathrm{d}\\Pi(z)}{\\mathrm{d}z}$ and noting that $\\frac{\\partial z}{\\partial \\Delta\\gamma} = h$:\n$$ \\frac{\\partial R}{\\partial \\Delta\\gamma} = -E - h \\, \\pi'(r^{\\text{trial}}_{n+1}) $$\nSubstituting these derivatives back into the $\\mathrm{d}R = 0$ expression:\n$$ (s E) \\mathrm{d}\\epsilon_{n+1} + \\left( -E - h \\, \\pi'(r^{\\text{trial}}_{n+1}) \\right) \\mathrm{d}\\Delta\\gamma = 0 $$\nWe can now solve for the derivative of the plastic multiplier increment with respect to the total strain:\n$$ \\frac{\\mathrm{d}\\Delta\\gamma}{\\mathrm{d}\\epsilon_{n+1}} = \\frac{s E}{E + h \\, \\pi'(r^{\\text{trial}}_{n+1})} $$\nThe algorithmic tangent modulus is the derivative of the stress $\\sigma_{n+1}$ with respect to the total strain $\\epsilon_{n+1}$. Starting from $\\sigma_{n+1} = \\sigma^{\\text{trial}}_{n+1} - E s \\Delta\\gamma$:\n$$ \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} = \\frac{\\mathrm{d}\\sigma^{\\text{trial}}_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} - E s \\frac{\\mathrm{d}\\Delta\\gamma}{\\mathrm{d}\\epsilon_{n+1}} $$\nSince $\\frac{\\mathrm{d}\\sigma^{\\text{trial}}_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} = E$, we substitute our result for $\\frac{\\mathrm{d}\\Delta\\gamma}{\\mathrmd\\epsilon_{n+1}}$:\n$$ \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} = E - E s \\left( \\frac{s E}{E + h \\, \\pi'(r^{\\text{trial}}_{n+1})} \\right) = E - \\frac{E^2}{E + h \\, \\pi'(r^{\\text{trial}}_{n+1})} $$\nSimplifying this expression gives the general form of the consistent algorithmic tangent modulus:\n$$ \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} = \\frac{E \\left(E + h \\, \\pi'(r^{\\text{trial}}_{n+1})\\right) - E^2}{E + h \\, \\pi'(r^{\\text{trial}}_{n+1})} = \\frac{E h \\, \\pi'(r^{\\text{trial}}_{n+1})}{E + h \\, \\pi'(r^{\\text{trial}}_{n+1})} $$\nThe problem asks for this tangent on the projected side of the bound, which corresponds to the case where $r^{\\text{trial}}_{n+1}  0$. According to the problem statement, for $z  0$, $\\pi'(z)=0$.\nSubstituting $\\pi'(r^{\\text{trial}}_{n+1}) = 0$ into the general expression for the tangent modulus:\n$$ \\left. \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} \\right|_{r^{\\text{trial}}_{n+1}  0} = \\frac{E h \\, (0)}{E + h \\, (0)} = \\frac{0}{E} = 0 $$\nThe normalized algorithmic tangent is therefore:\n$$ \\mathcal{K} \\equiv \\frac{1}{E} \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}} = \\frac{1}{E} (0) = 0 $$\nThis result is physically consistent with perfect plasticity, which is the behavior when the hardening variable is unable to grow (i.e., it is constrained at $r=0$).\n\nFinally, we assess the continuity of the stress-strain map $\\epsilon \\mapsto \\sigma$ at the bound $r=0$, which corresponds to the point where $r^{\\text{trial}}_{n+1}=0$. We must compare the one-sided limits of the tangent modulus.\n-   When approaching from the projected side, $r^{\\text{trial}}_{n+1} \\to 0^-$. Here, $\\pi'(r^{\\text{trial}}_{n+1})=0$, and the tangent modulus is $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\epsilon} = 0$.\n-   When approaching from the interior side, $r^{\\text{trial}}_{n+1} \\to 0^+$. Here, $\\pi'(r^{\\text{trial}}_{n+1})=1$, and the tangent modulus is $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\epsilon} = \\frac{Eh}{E+h}$.\n\nSince $E > 0$ and $h > 0$, we have $\\frac{Eh}{E+h} \\ne 0$. The left-hand and right-hand derivatives of $\\sigma$ with respect to $\\epsilon$ are not equal at the point where $r^{\\text{trial}}_{n+1} = 0$. This discontinuity in the first derivative means the stress-strain map is not $C^1$ (continuously differentiable) at this point. The stress function $\\sigma(\\epsilon)$ itself is continuous (the return-mapping algorithm ensures this), so the map is $C^0$ (continuous). The loss of $C^1$ continuity is a direct consequence of the non-differentiability of the projection operator $\\Pi(x)$ at $x=0$, which manifests as a jump in the value of its derivative $\\pi'(z)$ from $0$ to $1$.\n\nThe required final answer is the closed-form expression for $\\mathcal{K}$ on the projected side of the bound.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}