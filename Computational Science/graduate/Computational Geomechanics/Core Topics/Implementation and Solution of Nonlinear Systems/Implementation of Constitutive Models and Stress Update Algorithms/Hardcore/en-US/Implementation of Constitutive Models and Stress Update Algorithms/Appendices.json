{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a fundamental introduction to the implementation of elastoplastic models. You will implement the radial return algorithm, a cornerstone of computational plasticity, for the classic von Mises ($J_2$) yield criterion. This practice will solidify your understanding of the predictor-corrector structure for stress updates under a simple shear loading condition ().",
            "id": "3531837",
            "problem": "Consider small-strain simple shear of an undrained, isotropic, rate-independent material modeled by von Mises plasticity based on the second invariant of deviatoric stress (commonly called $J_2$ plasticity) with linear isotropic hardening. The material follows linear isotropic elasticity for the elastic response, with shear modulus $G$ and bulk modulus sufficiently large that volumetric strain remains negligible over the increment. The plasticity model employs an associated flow rule and the hardening law $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$, where $\\sigma_y$ is the current yield stress, $\\sigma_{y0}$ is the initial yield stress, $H$ is the linear isotropic hardening modulus, and $\\kappa$ is the equivalent plastic strain. The yield function is defined as $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa)$, where $\\boldsymbol{s}$ is the deviatoric part of the Cauchy stress and $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$. The plastic flow direction is $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$, and the backward Euler time discretization is used for the plastic strain increment, so that $\\Delta \\boldsymbol{\\varepsilon}^p = \\Delta \\lambda\\, \\boldsymbol{n}_{n+1}$ and $\\kappa_{n+1} = \\kappa_n + \\sqrt{2/3}\\,\\Delta \\lambda$, where $\\Delta \\lambda \\ge 0$ is the plastic multiplier.\n\nA single strain increment is applied from state $n$ to $n+1$ with only an engineering shear strain increment $\\Delta \\gamma$ nonzero, such that the small-strain tensor increment satisfies $\\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\Delta \\gamma/2$ and all other components of $\\Delta \\boldsymbol{\\varepsilon}$ are zero. The material parameters and initial conditions are:\n- Shear modulus $G = 25$ MPa.\n- Initial yield stress $\\sigma_{y0} = 0.2$ MPa.\n- Linear isotropic hardening modulus $H = 5$ MPa.\n- Initial equivalent plastic strain $\\kappa_n = 0$.\n- Initial stress $\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$ and initial plastic strain $\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$.\n- Engineering shear strain increment $\\Delta \\gamma = 0.03$.\n\nImplement the radial return stress update with backward Euler integration for this simple shear increment. Compute the updated deviatoric shear stress component $s_{12,n+1}$ (which equals the Cauchy shear stress $\\sigma_{12,n+1}$ in pure shear) and the plastic multiplier $\\Delta \\lambda$. Express $s_{12,n+1}$ in MPa and $\\Delta \\lambda$ as dimensionless. Round both results to five significant figures. Provide the final numerical values as a row matrix $\\begin{pmatrix} s_{12,n+1}  \\Delta \\lambda \\end{pmatrix}$.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, objective, and complete. It is a standard problem in computational plasticity that can be solved using the specified radial return algorithm. We proceed with the solution.\n\nThe solution process involves a standard predictor-corrector algorithm for the stress update. First, an elastic predictor step calculates a trial stress assuming the entire strain increment is elastic. Second, this trial stress is checked against the yield criterion. If yielding is indicated, a plastic corrector step is applied to return the stress state to the updated yield surface.\n\nThe initial state at step $n$ is given by:\nInitial stress: $\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$, which implies the deviatoric stress is also zero, $\\boldsymbol{s}_n = \\boldsymbol{0}$.\nInitial equivalent plastic strain: $\\kappa_n = 0$.\n\nThe applied strain increment $\\Delta\\boldsymbol{\\varepsilon}$ for simple shear with an engineering shear strain increment $\\Delta \\gamma = 0.03$ is given by its non-zero components:\n$$ \\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\frac{\\Delta \\gamma}{2} = \\frac{0.03}{2} = 0.015 $$\nSince the trace of the strain increment tensor $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}) = \\Delta\\varepsilon_{11} + \\Delta\\varepsilon_{22} + \\Delta\\varepsilon_{33} = 0$, the strain increment is purely deviatoric.\n\n**Step 1: Elastic Predictor**\n\nIn the predictor step, the entire strain increment is assumed to be elastic, so $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{0}$ and $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon}$. The trial deviatoric stress at step $n+1$, denoted $\\boldsymbol{s}^{\\text{trial}}_{n+1}$, is calculated using the elastic constitutive law:\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon}^e = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon} $$\nWith $\\boldsymbol{s}_n = \\boldsymbol{0}$ and $G=25$ MPa:\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = 2(25 \\text{ MPa}) \\Delta\\boldsymbol{\\varepsilon} = 50 \\Delta\\boldsymbol{\\varepsilon} $$\nThe only non-zero components of the trial deviatoric stress are:\n$$ s^{\\text{trial}}_{12,n+1} = s^{\\text{trial}}_{21,n+1} = 50 \\times 0.015 = 0.75 \\text{ MPa} $$\nThe norm of the trial deviatoric stress is calculated as $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{s_{ij}s_{ij}}$:\n$$ \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| = \\sqrt{(s^{\\text{trial}}_{12,n+1})^2 + (s^{\\text{trial}}_{21,n+1})^2} = \\sqrt{(0.75)^2 + (0.75)^2} = \\sqrt{2 \\times (0.75)^2} = 0.75\\sqrt{2} \\text{ MPa} $$\nNumerically, $\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| \\approx 1.06066$ MPa.\n\n**Step 2: Yield Check**\n\nWe check if this trial stress state lies outside the elastic domain defined by the yield function $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa) \\le 0$. The check is performed using the yield stress at the beginning of the increment, $\\sigma_y(\\kappa_n)$.\nThe hardening law is $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$. With $\\kappa_n=0$, $\\sigma_{y0}=0.2$ MPa and $H=5$ MPa:\n$$ \\sigma_y(\\kappa_n) = \\sigma_y(0) = \\sigma_{y0} = 0.2 \\text{ MPa} $$\nThe trial value of the yield function is:\n$$ f^{\\text{trial}} = \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}} \\sigma_y(\\kappa_n) = 0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2) \\text{ MPa} $$\nNumerically, $f^{\\text{trial}} \\approx 1.06066 - 0.81650 \\times 0.2 \\approx 1.06066 - 0.16330 = 0.89736$ MPa.\nSince $f^{\\text{trial}}  0$, the elastic predictor violates the yield condition, and a plastic correction is required.\n\n**Step 3: Plastic Corrector (Radial Return)**\n\nFor plastic loading, the plastic multiplier $\\Delta \\lambda$ must be greater than zero. For a backward Euler integration scheme, $\\Delta \\lambda$ is found from the consistency condition $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$. This leads to the following expression for $\\Delta \\lambda$:\n$$ \\Delta \\lambda = \\frac{f^{\\text{trial}}}{2G + \\frac{2}{3}H} = \\frac{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\sigma_y(\\kappa_n)}{2G + \\frac{2}{3}H} $$\nSubstituting the given values:\n$$ \\Delta \\lambda = \\frac{0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2)}{2(25) + \\frac{2}{3}(5)} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{50 + 10/3} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{160/3} $$\nNumerically:\n$$ \\Delta \\lambda = \\frac{1.060660 - 0.163299}{53.333333} = \\frac{0.897361}{53.333333} = 0.0168255 $$\nRounding to five significant figures, we get $\\Delta \\lambda = 0.016826$.\n\n**Step 4: Stress Update**\n\nThe final deviatoric stress $\\boldsymbol{s}_{n+1}$ is found by returning the trial stress radially to the expanded yield surface. The return mapping equation is:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\lambda \\boldsymbol{n}_{n+1} $$\nwhere $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}_{n+1}/\\|\\boldsymbol{s}_{n+1}\\|$. For radial return, the direction of the final stress is the same as the trial stress, so $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1}/\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$.\nThe component $s_{12,n+1}$ is:\n$$ s_{12,n+1} = s^{\\text{trial}}_{12,n+1} - 2G\\Delta\\lambda \\frac{s^{\\text{trial}}_{12,n+1}}{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|} $$\nSubstituting the values for $s^{\\text{trial}}_{12,n+1}$ and $\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$:\n$$ s_{12,n+1} = 0.75 - 2(25)\\Delta\\lambda \\frac{0.75}{0.75\\sqrt{2}} = 0.75 - \\frac{50}{\\sqrt{2}}\\Delta\\lambda $$\nUsing the computed value of $\\Delta\\lambda = 0.0168255...$:\n$$ s_{12,n+1} = 0.75 - \\frac{50}{\\sqrt{2}}(0.0168255) = 0.75 - (35.355339)(0.0168255) = 0.75 - 0.594865 = 0.155135 \\text{ MPa} $$\nRounding to five significant figures, we get $s_{12,n+1} = 0.15514$ MPa. Since the problem starts from a zero stress state and the strain increment is purely deviatoric, the mean stress remains zero, so $\\sigma_{12,n+1} = s_{12,n+1}$.\n\nThe final requested values are $s_{12,n+1}$ and $\\Delta \\lambda$.\n- $s_{12,n+1} = 0.15514$ MPa\n- $\\Delta \\lambda = 0.016826$\nWe present these in a row matrix as requested.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.15514  0.016826 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Geomaterials like soil and rock often have negligible tensile strength, a feature that standard models might not capture. This practice introduces the concept of a tension cut-off, implemented via a powerful technique called spectral decomposition, which projects inadmissible tensile principal stresses back to zero (). This method ensures a physically realistic stress state, for instance, in simulations of excavation where unloading can induce tensile stresses.",
            "id": "3531831",
            "problem": "Implement a small-strain stress update with a tension cut-off for soils to prevent spurious tensile stresses during unloading (e.g., excavation). Use the following assumptions and requirements to derive and implement the algorithm.\n\nAssumptions and fundamental base:\n- Adopt the standard small-strain kinematics with the symmetric strain tensor $\\boldsymbol{\\varepsilon}$ and the Cauchy stress tensor $\\boldsymbol{\\sigma}$.\n- Use isotropic linear elasticity for the elastic predictor with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The elastic stiffness is defined by the Lamé parameters $\\lambda$ and $\\mu$, with $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$, and $\\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$, where $\\mathbf{I}$ is the second-order identity tensor and $\\text{tr}(\\cdot)$ is the trace.\n- Adopt the sign convention where tensile stresses are positive and compressive stresses are negative.\n- Model the soil as a no-tension material: at the end of the increment, the updated stress must lie in the admissible set $\\mathcal{K}$ defined by the requirement that all principal stresses are non-positive, i.e., the tensor is negative semidefinite.\n\nTask:\n- Given the previous stress state $\\boldsymbol{\\sigma}_n$ and a prescribed strain increment $\\Delta \\boldsymbol{\\varepsilon}$ over a time step, compute the elastic trial stress\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon},\n$$\nwhere $\\mathbb{C}$ is the fourth-order isotropic elastic tensor determined by $E$ and $\\nu$.\n- Enforce the tension cut-off by returning (projecting) $\\boldsymbol{\\sigma}^{\\text{tr}}$ to the admissible set $\\mathcal{K}$ in a way that is consistent with energy minimization and does not produce tensile principal stresses. Formulate the return as the closest-point projection in the Frobenius norm:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2.\n$$\n- Compute the three principal stresses of $\\boldsymbol{\\sigma}_{n+1}$ and sort them in descending order.\n\nPhysical and numerical units:\n- All stresses must be reported in kilopascals (kPa).\n- Angles do not appear in this problem.\n- Express the final answers as floats rounded to three decimal places in kPa.\n\nTest suite:\nUse $E = 50\\,\\text{MPa}$ and $\\nu = 0.3$ for all cases. Use the identity tensor $\\mathbf{I}$ for isotropic states and the standard small-strain relation for shear where an engineering shear $\\gamma$ corresponds to $\\varepsilon_{12} = \\varepsilon_{21} = \\gamma/2$.\n\nDefine the following four test cases, each specified by $(\\boldsymbol{\\sigma}_n, \\Delta \\boldsymbol{\\varepsilon})$:\n\n- Test case $1$ (compressive loading, elastic admissible):\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$,\n  - $\\Delta \\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$.\n\n- Test case $2$ (excavation-type unloading to tension, needs cut-off):\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$,\n  - $\\Delta \\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$.\n\n- Test case $3$ (pure shear from zero stress, mixed principal states, needs cut-off):\n  - $\\boldsymbol{\\sigma}_n = \\mathbf{0}$,\n  - Engineering shear $\\gamma = 10^{-4}$ in the $1$-$2$ plane, i.e., $\\Delta \\boldsymbol{\\varepsilon}_{12} = \\Delta \\boldsymbol{\\varepsilon}_{21} = \\gamma/2$ and other components zero.\n\n- Test case $4$ (boundary case to the cut-off surface):\n  - $\\boldsymbol{\\sigma}_n = -50\\,\\text{kPa}\\,\\mathbf{I}$,\n  - $\\Delta \\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of length $4$ (one per test case).\n- Each entry is a list of the three principal stresses of $\\boldsymbol{\\sigma}_{n+1}$ in kPa, rounded to three decimal places and sorted in descending order.\n- The exact format is a single line like\n  $$\n  [ [s_{1,1}, s_{1,2}, s_{1,3}], [s_{2,1}, s_{2,2}, s_{2,3}], [s_{3,1}, s_{3,2}, s_{3,3}], [s_{4,1}, s_{4,2}, s_{4,3}] ]\n  $$\n  printed as a Python list literal with no additional text.",
            "solution": "The problem requires the implementation of a stress update algorithm for an isotropic linear elastic material subject to a tension cut-off condition. This is a classic problem in computational plasticity, specifically for a Rankine or no-tension material model, commonly used for geomaterials like soil or rock which exhibit negligible tensile strength. The solution will be derived and implemented based on a return mapping algorithm, which enforces the constitutive constraint via a closest-point projection in stress space. Tensile stresses are taken as positive.\n\n**1. Constitutive Framework**\n\nThe material behavior is described by two components:\n-   **Elasticity**: Governed by isotropic linear elasticity. The stress tensor $\\boldsymbol{\\sigma}$ is related to the strain tensor $\\boldsymbol{\\varepsilon}$ by Hooke's law, which can be written using Lamé's parameters, $\\lambda$ and $\\mu$:\n    $$\n    \\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}\n    $$\n    where $\\mathbf{I}$ is the second-order identity tensor. The material parameters $E=50\\,\\text{MPa} = 50000\\,\\text{kPa}$ and $\\nu=0.3$ yield:\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)} = \\frac{50000\\,\\text{kPa}}{2(1+0.3)} = \\frac{25000}{1.3} = \\frac{250000}{13}\\,\\text{kPa} \\approx 19230.769\\,\\text{kPa}\n    $$\n    $$\n    \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)} = \\frac{50000\\,\\text{kPa} \\cdot 0.3}{(1+0.3)(1-2 \\cdot 0.3)} = \\frac{15000}{1.3 \\cdot 0.4} = \\frac{15000}{0.52} = \\frac{375000}{13}\\,\\text{kPa} \\approx 28846.154\\,\\text{kPa}\n    $$\n\n-   **Tension Cut-off**: The material cannot sustain tensile stresses. This is formulated as a constraint on the updated stress tensor $\\boldsymbol{\\sigma}_{n+1}$. Its principal stresses, denoted by $\\sigma_1, \\sigma_2, \\sigma_3$, must all be non-positive. This defines the admissible stress set $\\mathcal{K}$:\n    $$\n    \\mathcal{K} = \\{ \\boldsymbol{\\sigma} \\in \\mathbb{S}^3 \\, | \\, \\sigma_i(\\boldsymbol{\\sigma}) \\le 0, \\forall i=1,2,3 \\}\n    $$\n    where $\\mathbb{S}^3$ is the space of symmetric second-order tensors in three dimensions.\n\n**2. Return Mapping Algorithm**\n\nThe stress update is performed in two steps: an elastic predictor and a plastic corrector (return mapping).\n\n-   **Elastic Predictor**: Given the stress state $\\boldsymbol{\\sigma}_n$ at the beginning of the increment and a strain increment $\\Delta\\boldsymbol{\\varepsilon}$, we first compute an elastic trial stress $\\boldsymbol{\\sigma}^{\\text{tr}}$. This assumes the material response is purely elastic over the increment:\n    $$\n    \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}_n + \\lambda \\, \\text{tr}(\\Delta \\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\Delta \\boldsymbol{\\varepsilon}\n    $$\n\n-   **Plastic Corrector**: If $\\boldsymbol{\\sigma}^{\\text{tr}}$ violates the tension cut-off condition (i.e., $\\boldsymbol{\\sigma}^{\\text{tr}} \\notin \\mathcal{K}$), it must be \"returned\" or \"projected\" onto the admissible set $\\mathcal{K}$. The problem specifies this projection as the one that minimizes the distance in the Frobenius norm, a standard choice ensuring energy consistency:\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2\n    $$\n    This is a closest-point projection of $\\boldsymbol{\\sigma}^{\\text{tr}}$ onto the convex set $\\mathcal{K}$.\n\n**3. Spectral Projection**\n\nThe key to solving this minimization problem lies in spectral decomposition. The Frobenius norm and the admissibility condition are both isotropic functions of the stress tensor, meaning they depend only on its principal values (eigenvalues), not its principal directions (eigenvectors). Consequently, the projected stress $\\boldsymbol{\\sigma}_{n+1}$ shares the same principal directions as the trial stress $\\boldsymbol{\\sigma}^{\\text{tr}}$.\n\nLet the spectral decomposition of the trial stress be:\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\sum_{i=1}^3 \\sigma_i^{\\text{tr}} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\nwhere $\\sigma_i^{\\text{tr}}$ are the principal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ and $\\mathbf{n}_i$ are the corresponding orthonormal principal directions. The updated stress $\\boldsymbol{\\sigma}_{n+1}$ has the form:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\sum_{i=1}^3 \\sigma_{i, n+1} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\nThe optimization problem decouples into three independent one-dimensional problems for the principal stresses:\n$$\n\\sigma_{i, n+1} = \\operatorname*{arg\\,min}_{\\sigma_i \\le 0} (\\sigma_i - \\sigma_i^{\\text{tr}})^2 \\quad \\text{for } i=1,2,3\n$$\nThe solution is a simple projection onto the non-positive real axis:\n-   If $\\sigma_i^{\\text{tr}} \\le 0$, the trial value is already admissible, so $\\sigma_{i, n+1} = \\sigma_i^{\\text{tr}}$.\n-   If $\\sigma_i^{\\text{tr}}  0$, the trial value is inadmissible, and the closest admissible point is $0$, so $\\sigma_{i, n+1} = 0$.\n\nThis can be expressed compactly as:\n$$\n\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)\n$$\n\n**Algorithm Summary:**\n1.  For each test case, given $\\boldsymbol{\\sigma}_n$ and $\\Delta\\boldsymbol{\\varepsilon}$, compute the trial stress tensor $\\boldsymbol{\\sigma}^{\\text{tr}}$.\n2.  Compute the principal stresses (eigenvalues) of $\\boldsymbol{\\sigma}^{\\text{tr}}$, let them be $\\{\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}\\}$.\n3.  Apply the tension cut-off to each principal trial stress: $\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)$.\n4.  The set $\\{\\sigma_{1, n+1}, \\sigma_{2, n+1}, \\sigma_{3, n+1}\\}$ constitutes the principal stresses of the final updated stress $\\boldsymbol{\\sigma}_{n+1}$.\n5.  Sort these final principal stresses in descending order and round to three decimal places.\n\n**Calculations for Test Cases:**\n\n**Case 1:** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = -3 \\times 10^{-4}$. The stress increment is isotropic: $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (-3 \\times 10^{-4}) + 2\\mu \\cdot (-10^{-4}))\\mathbf{I} = -12.5\\,\\mathbf{I}\\,\\text{kPa}$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} - 12.5\\,\\mathbf{I} = -112.5\\,\\mathbf{I}\\,\\text{kPa}$.\nPrincipal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ are $\\{-112.5, -112.5, -112.5\\}$. All are $\\le 0$, so no projection is needed.\nFinal principal stresses, sorted descending: $[-112.500, -112.500, -112.500]$.\n\n**Case 2:** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 9 \\times 10^{-3}$. The stress increment is $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (9 \\times 10^{-3}) + 2\\mu \\cdot (3 \\times 10^{-3}))\\mathbf{I} = 375\\,\\mathbf{I}\\,\\text{kPa}$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} + 375\\,\\mathbf{I} = 275\\,\\mathbf{I}\\,\\text{kPa}$.\nPrincipal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ are $\\{275, 275, 275\\}$. All are $ 0$.\nProjected principal stresses: $\\{\\min(275, 0), \\min(275, 0), \\min(275, 0)\\} = \\{0, 0, 0\\}$.\nFinal principal stresses, sorted descending: $[0.000, 0.000, 0.000]$.\n\n**Case 3:** $\\boldsymbol{\\sigma}_n = \\mathbf{0}$, pure shear $\\gamma=10^{-4}$\n$\\Delta\\varepsilon_{12} = \\Delta\\varepsilon_{21} = 0.5 \\times 10^{-4}$, other components zero. $\\text{tr}(\\Delta\\boldsymbol{\\varepsilon})=0$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = 2\\mu\\Delta\\boldsymbol{\\varepsilon}$. The only non-zero component is $\\sigma^{\\text{tr}}_{12} = \\sigma^{\\text{tr}}_{21} = 2\\mu \\Delta\\varepsilon_{12} = \\mu \\gamma = \\frac{250000}{13} \\cdot 10^{-4} = \\frac{25}{13} \\approx 1.923\\,\\text{kPa}$.\nThe principal stresses of this pure shear state are $\\{ \\sigma^{\\text{tr}}_{12}, 0, -\\sigma^{\\text{tr}}_{12} \\} = \\{25/13, 0, -25/13\\}$.\nProjected principal stresses: $\\{\\min(25/13, 0), \\min(0, 0), \\min(-25/13, 0)\\} = \\{0, 0, -25/13\\}$.\nFinal principal stresses, sorted descending: $[0.000, 0.000, -1.923]$.\n\n**Case 4:** $\\boldsymbol{\\sigma}_n = -50\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 12 \\times 10^{-4}$. The stress increment is $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (12 \\times 10^{-4}) + 2\\mu \\cdot (4 \\times 10^{-4}))\\mathbf{I} = 50\\,\\mathbf{I}\\,\\text{kPa}$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -50\\,\\mathbf{I} + 50\\,\\mathbf{I} = \\mathbf{0}\\,\\text{kPa}$.\nPrincipal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ are $\\{0, 0, 0\\}$. All are $\\le 0$. No projection needed.\nFinal principal stresses, sorted descending: $[0.000, 0.000, 0.000]$.",
            "answer": "$$\n[[-112.500, -112.500, -112.500], [0.000, 0.000, 0.000], [0.000, 0.000, -1.923], [0.000, 0.000, 0.000]]\n$$"
        },
        {
            "introduction": "Constitutive models are the heart of a finite element simulation, but how do they connect to the global system of equations, especially in coupled problems? This problem explores the link between a single-point stress update algorithm and the element-level tangent stiffness matrix in a $u$-$p$ formulation for poromechanics (). You will derive the components of the coupled algorithmic tangent, revealing how the properties of the solid skeleton's constitutive model influence the overall system response.",
            "id": "3531844",
            "problem": "A saturated porous solid is modeled under the framework of Biot poromechanics using a mixed displacement–pressure formulation with displacement field $u$ and pore pressure field $p$. The kinematics are small strain, and the solid phase (skeleton) obeys an isotropic associative von Mises (also called $J_{2}$) elastoplastic constitutive law with linear isotropic hardening. The fluid is compressible with compressibility parameter $M$ in the sense that the increment of fluid content is proportional to $p$ with proportionality $1/M$. The Biot coefficient is $\\alpha \\in (0,1]$. The Cauchy total stress is given by $\\sigma = \\sigma' - \\alpha\\,p\\,\\boldsymbol{I}$, where $\\sigma'$ is the effective stress of the skeleton and $\\boldsymbol{I}$ is the second-order identity tensor. The effective stress is related to the strain $\\varepsilon(u)$ by an algorithmic consistent tangent $\\boldsymbol{C}^{ep}$ coming from a backward Euler return mapping for the $J_{2}$ model.\n\nConsider a standard three-dimensional Galerkin finite element discretization over a domain $\\Omega$ with displacement shape functions $N_{u}$ and pressure shape functions $N_{p}$. Let $\\boldsymbol{B}$ denote the usual symmetric gradient operator mapping nodal displacements to strains, and $B_{v}$ denote the volumetric strain operator that produces the trace of strain (i.e., $B_{v} u = \\operatorname{tr}(\\varepsilon(u))$). Neglect Darcy flow and diffusion (impermeable, no-flow conditions), so that the fluid equation retains only storage terms. Focus on a single material point or a homogeneous element with uniform fields such that spatial variations of the operators can be treated as constant over $\\Omega$.\n\nStarting from the Biot theory and the definition of the algorithmic consistent tangent for the elastoplastic skeleton, perform the following:\n\n1. Derive the symbolic expressions of the four coupled algorithmic tangent blocks $K_{uu}$, $K_{up}$, $K_{pu}$, and $K_{pp}$ that arise from linearization of the discrete residuals of mechanical equilibrium and fluid mass balance with respect to the unknowns $u$ and $p$. Express each block as an integral over $\\Omega$ involving the operators $\\boldsymbol{B}$, $B_{v}$, the identity tensor $\\boldsymbol{I}$, the Biot coefficient $\\alpha$, the algorithmic consistent tangent $\\boldsymbol{C}^{ep}$, and the compressibility parameter $M$.\n\n2. Use the structure of the $J_{2}$ return mapping with linear isotropic hardening to identify the volumetric part of $\\boldsymbol{C}^{ep}$ and its consequence for the volumetric stiffness of the skeleton. Clearly explain any split into volumetric and deviatoric parts and the role of plastic incompressibility of the $J_{2}$ flow.\n\n3. Under the homogeneous-element assumption, perform a static condensation of the displacement unknowns at the element level by forming the Schur complement of $K_{uu}$ in the coupled system. This yields a condensed pressure block that captures the effective compressibility response of the coupled system. Extract the scalar coefficient multiplying the pressure test functions that quantifies the effective compressibility at the material point level.\n\nReport as your final answer the closed-form analytic expression of that scalar coefficient in terms of the Biot coefficient $\\alpha$, the drained elastic bulk modulus $K$ of the skeleton, and the fluid compressibility parameter $M$. Do not provide intermediate steps or numerical values in the final answer; provide only the final analytic expression. If you introduce any auxiliary moduli (for example, Lamé parameters), make sure your final expression is given solely in terms of $\\alpha$, $K$, and $M$.",
            "solution": "The starting point is the mixed displacement–pressure formulation for a saturated porous medium under small strains. The total stress is $\\sigma = \\sigma' - \\alpha\\,p\\,\\boldsymbol{I}$, with $\\sigma'$ the effective stress of the skeleton. The mechanical residual for displacement is obtained by virtual work of internal stresses, and the fluid residual is the mass balance of fluid, specialized to storage-only under no-flow conditions.\n\nFor the skeleton, we adopt isotropic associative von Mises ($J_{2}$) elastoplasticity with linear isotropic hardening and backward Euler return mapping. The algorithmic consistent tangent $\\boldsymbol{C}^{ep}$ is the Jacobian $\\partial\\sigma'/\\partial\\varepsilon$ that arises from linearization of the integrated constitutive update. In an isotropic setting, it is standard to decompose tensors into volumetric and deviatoric parts. Let $\\varepsilon$ be the strain, and write\n$$\n\\varepsilon = \\varepsilon^{vol} + \\varepsilon^{dev}, \\quad \\varepsilon^{vol} = \\frac{1}{3}\\operatorname{tr}(\\varepsilon)\\,\\boldsymbol{I}, \\quad \\varepsilon^{dev} = \\varepsilon - \\varepsilon^{vol},\n$$\nand similarly for $\\sigma'$. The elastic moduli are given by the drained bulk modulus $K$ and the shear modulus $\\mu$, so the elastic stiffness is\n$$\n\\boldsymbol{C}^{e} = K\\,\\boldsymbol{I}\\otimes\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{I}^{dev},\n$$\nwhere $\\boldsymbol{I}\\otimes\\boldsymbol{I}$ maps volumetric strains to volumetric stresses, and $\\boldsymbol{I}^{dev}$ is the fourth-order deviatoric projector.\n\nUnder $J_{2}$ plasticity with associative flow, the plastic strain increment is purely deviatoric (plastic incompressibility), i.e., $\\operatorname{tr}(\\dot{\\varepsilon}^{p}) = 0$. In backward Euler return mapping, one projects the trial deviatoric stress back to the yield surface along the normal while preserving volumetric stress. The resulting algorithmic consistent tangent has the general structure\n$$\n\\boldsymbol{C}^{ep} = K\\,\\boldsymbol{I}\\otimes\\boldsymbol{I} + 2\\mu\\left(\\boldsymbol{I}^{dev} - \\eta\\,\\boldsymbol{P}_{n}\\right),\n$$\nwhere $\\boldsymbol{P}_{n}$ is a fourth-order projector aligned with the current flow direction in deviatoric space (constructed from the unit normal to the yield surface), and $\\eta$ is a scalar that depends on the elastic shear modulus and the plastic modulus (isotropic hardening slope). The critical observation for our purpose is that the volumetric part of $\\boldsymbol{C}^{ep}$ remains equal to $K\\,\\boldsymbol{I}\\otimes\\boldsymbol{I}$, because the $J_{2}$ flow is isochoric and does not alter the volumetric stiffness. Therefore, the volumetric tangent modulus of the skeleton is unchanged by plasticity and equals $K$.\n\nWe now construct the tangent blocks from the linearization of the discrete residuals. The mechanical equilibrium residual for displacement $u$ may be written in discrete form as\n$$\nR_{u} = \\int_{\\Omega} \\boldsymbol{B}^{T}\\,\\sigma\\,\\mathrm{d}\\Omega - \\text{external terms} = \\int_{\\Omega} \\boldsymbol{B}^{T}\\left(\\sigma' - \\alpha\\,p\\,\\boldsymbol{I}\\right)\\mathrm{d}\\Omega - \\text{external terms}.\n$$\nLinearizing with respect to $(u,p)$ yields the tangent contributions\n$$\nK_{uu} = \\int_{\\Omega} \\boldsymbol{B}^{T}\\,\\boldsymbol{C}^{ep}\\,\\boldsymbol{B}\\,\\mathrm{d}\\Omega, \\quad\nK_{up} = -\\int_{\\Omega} \\boldsymbol{B}^{T}\\,\\alpha\\,\\boldsymbol{I}\\,N_{p}\\,\\mathrm{d}\\Omega,\n$$\nwhere $N_{p}$ are the pressure shape functions. The negative sign in $K_{up}$ comes from the $-\\alpha\\,p\\,\\boldsymbol{I}$ term in the total stress.\n\nThe fluid mass balance under no-flow conditions reduces to storage of fluid content. For a compressible fluid and compressible skeleton, the increment of fluid content per unit reference volume is\n$$\nm = \\alpha\\,\\varepsilon_{v} + \\frac{1}{M}\\,p,\n$$\nwhere $\\varepsilon_{v} = \\operatorname{tr}(\\varepsilon)$ is the volumetric strain. Its residual in discrete form is\n$$\nR_{p} = \\int_{\\Omega} N_{p}^{T}\\left(\\alpha\\,B_{v}\\,u + \\frac{1}{M}\\,p\\right)\\mathrm{d}\\Omega - \\text{sources}.\n$$\nLinearizing yields\n$$\nK_{pu} = \\int_{\\Omega} N_{p}^{T}\\,\\alpha\\,B_{v}\\,\\mathrm{d}\\Omega, \\quad\nK_{pp} = \\int_{\\Omega} N_{p}^{T}\\left(\\frac{1}{M}\\right)N_{p}\\,\\mathrm{d}\\Omega.\n$$\nThese are the consistent tangent blocks in the storage-only setting with an elastoplastic skeleton.\n\nTo extract the effective compressibility coefficient in the condensed pressure block, consider the homogeneous-element assumption with uniform fields and constant operators over $\\Omega$. Then the Schur complement of $K_{uu}$ in the coupled system produces a condensed pressure tangent of the form\n$$\n\\widetilde{K}_{pp} \\;=\\; K_{pp} - K_{pu}\\,K_{uu}^{-1}\\,K_{up}.\n$$\nThe physical meaning of the second term is the skeleton’s volumetric stress response to pressure through the mechanical equilibrium constraint, mapped back into the fluid equation. Under uniform fields, $K_{uu}^{-1}$ acting on the volumetric mode is governed by the skeleton’s volumetric tangent modulus $K$ identified above. The contraction $K_{pu}\\,K_{uu}^{-1}\\,K_{up}$ evaluated on the volumetric mode yields a scalar contribution equal to $\\alpha^{2}/K$ multiplying the same pressure test functions. Therefore, the effective scalar compressibility coefficient multiplying the pressure test functions in the condensed pressure block is the sum of the fluid compressibility and the skeleton’s constrained compressibility contribution,\n$$\nS_{ep} \\;=\\; \\frac{\\alpha^{2}}{K} + \\frac{1}{M}.\n$$\nBecause the $J_{2}$ plasticity is isochoric, the volumetric tangent modulus remains $K$ even in the plastic regime, and thus $S_{ep}$ is unaffected by the deviatoric plasticity parameters and depends only on $\\alpha$, $K$, and $M$ as shown.",
            "answer": "$$\\boxed{\\frac{\\alpha^{2}}{K} + \\frac{1}{M}}$$"
        }
    ]
}