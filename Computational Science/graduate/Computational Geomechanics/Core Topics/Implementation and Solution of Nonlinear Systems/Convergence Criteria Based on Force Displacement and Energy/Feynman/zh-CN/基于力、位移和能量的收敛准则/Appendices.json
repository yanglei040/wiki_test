{
    "hands_on_practices": [
        {
            "introduction": "在非线性有限元分析中，最直观的平衡状态检验方法是直接衡量系统中的“不平衡力”有多大。这个不平衡力，即残差向量 $r(u)$，代表了当前位移 $u$ 下外力与内力的差距。本练习将通过一个简单的二维离散系统，指导您动手计算残差的欧几里得范数 $||r(u)||_2$，并将其与给定的容差进行比较，这是掌握基于力的收敛准则的第一步。",
            "id": "3511080",
            "problem": "考虑一个源于计算岩土力学中有限元离散化的小应变、准静态、两自由度 (DOF) 离散系统。设节点位移向量为 $u \\in \\mathbb{R}^{2}$，其分量单位为米；节点外力向量为 $f_{\\mathrm{ext}} \\in \\mathbb{R}^{2}$，其分量单位为牛顿；节点内力向量为 $f_{\\mathrm{int}}(u) \\in \\mathbb{R}^{2}$。假设为线性弹性行为，因此一致切线（刚度）矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$ 是常数、对称且正定的，并且 $f_{\\mathrm{int}}(u) = K u$，其中 $K$ 的元素单位为牛顿/米。在基于力的收敛准则中，与牛顿法相关的残差向量定义为 $r(u) = f_{\\mathrm{ext}} - f_{\\mathrm{int}}(u)$。基于力的绝对收敛准则要求欧几里得范数 $||r(u)||_{2}$ 小于或等于给定的绝对容差 $\\tau$（单位为牛顿），以认为迭代收敛。\n\n已知\n$$\nf_{\\mathrm{ext}} = \\begin{bmatrix} 10 \\\\ -5 \\end{bmatrix}, \\quad\nK = \\begin{bmatrix} 100  20 \\\\ 20  50 \\end{bmatrix}, \\quad\nf_{\\mathrm{int}}(u) = K u, \\quad\nu = \\begin{bmatrix} 0.1 \\\\ -0.2 \\end{bmatrix},\n$$\n计算 $||r(u)||_{2}$ 并根据绝对容差 $\\tau = 10^{-2}$ 评估收敛性。以牛顿为单位表示残差范数。此外，报告一个二元指示符 $c$，定义为：如果 $||r(u)||_{2} \\le \\tau$，则 $c = 1$，否则 $c = 0$。请将您的最终答案以一个行矩阵的形式给出，其中依次包含残差范数和二元指示符。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n问题提供了以下数据和定义：\n- 节点位移向量：$u \\in \\mathbb{R}^{2}$，其中 $u = \\begin{bmatrix} 0.1 \\\\ -0.2 \\end{bmatrix}$（单位：米）。\n- 节点外力向量：$f_{\\mathrm{ext}} \\in \\mathbb{R}^{2}$，其中 $f_{\\mathrm{ext}} = \\begin{bmatrix} 10 \\\\ -5 \\end{bmatrix}$（单位：牛顿）。\n- 节点内力向量：$f_{\\mathrm{int}}(u) \\in \\mathbb{R}^{2}$。\n- 刚度矩阵：$K \\in \\mathbb{R}^{2 \\times 2}$，其中 $K = \\begin{bmatrix} 100  20 \\\\ 20  50 \\end{bmatrix}$（单位：牛顿/米）。\n- 本构关系：$f_{\\mathrm{int}}(u) = K u$。\n- 残差向量：$r(u) = f_{\\mathrm{ext}} - f_{\\mathrm{int}}(u)$。\n- 绝对收敛准则：$||r(u)||_{2} \\le \\tau$。\n- 绝对容差：$\\tau = 10^{-2}$（单位：牛顿）。\n- 二元收敛指示符：如果 $||r(u)||_{2} \\le \\tau$，则 $c=1$，否则 $c=0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于固体力学和数值分析的原理，特别是针对线性弹性系统的有限元法。内力、残余力和基于力的收敛准则的定义在计算力学中是标准的。\n- **适定性**：该问题是适定的。所有必要的数据（$f_{\\mathrm{ext}}$、$K$、$u$、$\\tau$）都已提供。定义清晰无歧义，可得到唯一可计算的解。单位是一致的：$[K][u] = (\\text{N}/\\text{m}) \\cdot \\text{m} = \\text{N}$，与 $f_{\\mathrm{ext}}$ 和 $\\tau$ 的单位相匹配。刚度矩阵 $K$ 是对称的。其顺序主子式为 $\\det([100]) = 100 > 0$ 和 $\\det(K) = (100)(50) - (20)(20) = 5000 - 400 = 4600 > 0$，证实了其如所述是正定的。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有任何主观性或模糊性。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它具有科学合理性、适定性和客观性。将推导求解。\n\n**求解推导**\n\n主要目标是计算残差向量的欧几里得范数 $||r(u)||_{2}$，然后确定二元收敛指示符 $c$ 的值。\n\n首先，我们使用给定的刚度矩阵 $K$ 和位移向量 $u$ 计算内力向量 $f_{\\mathrm{int}}(u)$。\n$$\nf_{\\mathrm{int}}(u) = K u = \\begin{bmatrix} 100  20 \\\\ 20  50 \\end{bmatrix} \\begin{bmatrix} 0.1 \\\\ -0.2 \\end{bmatrix}\n$$\n矩阵-向量乘法得出：\n$$\nf_{\\mathrm{int}}(u) = \\begin{bmatrix} (100)(0.1) + (20)(-0.2) \\\\ (20)(0.1) + (50)(-0.2) \\end{bmatrix} = \\begin{bmatrix} 10 - 4 \\\\ 2 - 10 \\end{bmatrix} = \\begin{bmatrix} 6 \\\\ -8 \\end{bmatrix}\n$$\n$f_{\\mathrm{int}}(u)$ 的单位是牛顿。\n\n接下来，我们计算残差向量 $r(u)$，即外力向量与内力向量之差。\n$$\nr(u) = f_{\\mathrm{ext}} - f_{\\mathrm{int}}(u) = \\begin{bmatrix} 10 \\\\ -5 \\end{bmatrix} - \\begin{bmatrix} 6 \\\\ -8 \\end{bmatrix} = \\begin{bmatrix} 10 - 6 \\\\ -5 - (-8) \\end{bmatrix} = \\begin{bmatrix} 4 \\\\ 3 \\end{bmatrix}\n$$\n$r(u)$ 的单位是牛顿。\n\n现在，我们计算残差向量的欧几里得范数（或 $L_2$-范数）$||r(u)||_{2}$。对于向量 $v = \\begin{bmatrix} v_1 \\\\ v_2 \\end{bmatrix}$，其欧几里得范数为 $||v||_2 = \\sqrt{v_1^2 + v_2^2}$。\n$$\n||r(u)||_{2} = \\left|\\left|\\begin{bmatrix} 4 \\\\ 3 \\end{bmatrix}\\right|\\right|_{2} = \\sqrt{4^2 + 3^2} = \\sqrt{16 + 9} = \\sqrt{25} = 5\n$$\n残差范数为 $5$ N。\n\n最后，我们通过将计算出的残差范数与给定的绝对容差 $\\tau$ 进行比较来评估收敛性。收敛准则是 $||r(u)||_{2} \\le \\tau$。\n我们有 $||r(u)||_{2} = 5$ 和 $\\tau = 10^{-2} = 0.01$。不等式为：\n$$\n5 \\le 0.01\n$$\n这个不等式不成立。因此，系统没有收敛。\n\n二元指示符 $c$ 的定义是：如果达到收敛，则 $c=1$，否则 $c=0$。由于条件未满足，指示符的值为：\n$$\nc = 0\n$$\n问题要求最终答案是一个行矩阵，按顺序包含残差范数和二元指示符。所需的量为 $||r(u)||_{2} = 5$ 和 $c=0$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 5  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "仅仅依赖位移增量的大小来判断收敛有时会产生误导，尤其是在刚度矩阵“病态”的系统中。这种情况在包含接触、罚函数或材料属性差异巨大的岩土工程模型中并不少见。本练习通过一个精心设计的反例，揭示了一个微小的位移修正量 $\\Delta u$ 如何可能掩盖一个巨大的残余力 $r$，从而帮助您深刻理解为何基于力的准则通常比基于位移的准则更为可靠。",
            "id": "3511130",
            "problem": "考虑一个通过有限元法（FEM）离散化的准静态、小应变岩土力学模型。某次迭代中的离散平衡由线性系统 $K u = f$ 描述，其中 $K$ 是对称正定的全局刚度矩阵，$u$ 是节点位移向量，$f$ 是外力向量。在一次牛顿-拉夫逊（NR）迭代中，残余力向量定义为 $r = f - K u$，而更新过程求解 $K \\Delta u = r$。收敛性通常通过位移增量范数 $\\|\\Delta u\\|$、残余力范数 $\\|r\\|$ 以及一种能量度量来评估。利用这些核心定义，构造一个具体反例，说明由于病态条件或不良缩放，小的 $\\|\\Delta u\\|$ 可以与大的 $\\|r\\|$ 共存。\n\n建立一个双自由度节点的模型，该节点代表一个刚性基础，通过对非穿透施加罚函数约束压在一个刚性边界上，同时用一个软的侧向剪切弹簧代表周围的土体。罚刚度导致了该代数系统的严重病态。设全局刚度矩阵为\n$$\nK = \\begin{pmatrix}\n10^{12}  0 \\\\\n0  10^{3}\n\\end{pmatrix},\n$$\n当前迭代步的位移为 $u_{k} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，施加的外力为\n$$\nf = \\begin{pmatrix}\n10^{3} \\\\\n0\n\\end{pmatrix}.\n$$\n将 $u_{1}$ 解释为由罚函数施加约束的法向接触自由度，将 $u_{2}$ 解释为具有真实土体刚度的侧向剪切自由度。\n\n使用上述基本定义，由 $K \\Delta u = r$（其中 $r = f - K u_{k}$）计算牛顿-拉夫逊更新量 $\\Delta u$，然后评估欧几里得向量范数 $\\|\\Delta u\\|_{2}$ 和 $\\|r\\|_{2}$，最后构建无量纲比率\n$$\n\\rho = \\frac{\\|r\\|_{2}}{\\|\\Delta u\\|_{2}}。\n$$\n将最终比率表示为一个纯数（无单位），并将答案四舍五入到四位有效数字。此外，根据计算出的量和 $K$ 的结构，解释为什么对于这个系统，基于位移的判据会错误地指示收敛，而基于力的判据则不会。",
            "solution": "该问题陈述是计算力学和数值分析领域一个有效的练习。它具有科学依据、是适定的且客观的。它展示了在岩土工程问题接触分析的有限元法（FEM）中遇到的一个标准（尽管是简化的）场景，其中罚函数法会导致病态刚度矩阵。计算和后续分析所需的所有数据均已提供，且不存在内部矛盾或歧义。因此，我们可以开始求解。\n\n该问题要求我们分析一个双自由度系统的牛顿-拉夫逊迭代。位移增量 $\\Delta u$ 的控制方程由 $K \\Delta u = r$ 给出，其中 $K$ 是刚度矩阵，$r$ 是残余力向量。\n\n首先，我们已知必要的量：\n全局刚度矩阵为：\n$$\nK = \\begin{pmatrix}\n10^{12}  0 \\\\\n0  10^{3}\n\\end{pmatrix}\n$$\n外力向量为：\n$$\nf = \\begin{pmatrix}\n10^{3} \\\\\n0\n\\end{pmatrix}\n$$\n当前迭代步 $k$ 的位移向量为：\n$$\nu_{k} = \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n第一步是计算当前迭代步的残余力向量 $r$。残余力定义为不平衡力 $r = f - f_{\\text{internal}}$，其中内力由 $f_{\\text{internal}} = K u_{k}$ 给出。\n$$\nr = f - K u_{k} = \\begin{pmatrix} 10^{3} \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 10^{12}  0 \\\\ 0  10^{3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\nr = \\begin{pmatrix} 10^{3} \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 10^{3} \\\\ 0 \\end{pmatrix}\n$$\n残余力向量为 $r = \\begin{pmatrix} 10^{3} \\\\ 0 \\end{pmatrix}$。\n\n接下来，我们使用牛顿-拉夫逊更新方程 $K \\Delta u = r$ 求解位移增量向量 $\\Delta u = \\begin{pmatrix} \\Delta u_1 \\\\ \\Delta u_2 \\end{pmatrix}$。\n$$\n\\begin{pmatrix} 10^{12}  0 \\\\ 0  10^{3} \\end{pmatrix} \\begin{pmatrix} \\Delta u_1 \\\\ \\Delta u_2 \\end{pmatrix} = \\begin{pmatrix} 10^{3} \\\\ 0 \\end{pmatrix}\n$$\n由于刚度矩阵 $K$ 是对角的，这个线性方程组是解耦的，可以分量逐一求解：\n$$\n10^{12} \\Delta u_1 = 10^{3} \\implies \\Delta u_1 = \\frac{10^{3}}{10^{12}} = 10^{-9}\n$$\n$$\n10^{3} \\Delta u_2 = 0 \\implies \\Delta u_2 = 0\n$$\n因此，位移增量向量为：\n$$\n\\Delta u = \\begin{pmatrix}\n10^{-9} \\\\\n0\n\\end{pmatrix}\n$$\n\n现在，我们评估残余力向量的欧几里得范数（$\\ell_2$-范数）$\\|r\\|_{2}$ 和位移增量向量的欧几里得范数 $\\|\\Delta u\\|_{2}$。\n残余力向量的范数为：\n$$\n\\|r\\|_{2} = \\sqrt{(10^{3})^{2} + 0^{2}} = \\sqrt{10^{6}} = 10^{3}\n$$\n位移增量向量的范数为：\n$$\n\\|\\Delta u\\|_{2} = \\sqrt{(10^{-9})^{2} + 0^{2}} = \\sqrt{10^{-18}} = 10^{-9}\n$$\n\n最后，我们计算无量纲比率 $\\rho$：\n$$\n\\rho = \\frac{\\|r\\|_{2}}{\\|\\Delta u\\|_{2}} = \\frac{10^{3}}{10^{-9}} = 10^{12}\n$$\n题目要求将此值四舍五入到四位有效数字。我们用科学记数法表示：\n$$\n\\rho = 1.000 \\times 10^{12}\n$$\n\n对于为何基于位移的判据可能具有误导性的解释，是建立在我们刚刚计算出的结果以及刚度矩阵 $K$ 的结构之上的。\n位移增量的范数 $\\|\\Delta u\\|_{2} = 10^{-9}$ 是一个极小的值。如果一个典型的位移收敛容差是，例如，$\\epsilon_u = 10^{-6}$，那么判据 $\\|\\Delta u\\|_{2} \\le \\epsilon_u$ 将会满足，迭代求解器将终止并宣布收敛。\n\n然而，残余力的范数 $\\|r\\|_{2} = 10^{3}$ 是一个非常大的值。残余力代表了当前迭代步对平衡方程的违背程度。一个大的残余力范数表明系统远未达到平衡。一个基于力的收敛判据，例如 $\\|r\\|_{2} \\le \\epsilon_f$（其中 $\\epsilon_f$ 是一个小的力容差），将能正确地识别出解尚未收敛。\n\n这种差异的根本原因是刚度矩阵 $K$ 的严重病态。一个对称矩阵的条件数是其最大特征值与最小特征值之比。对于我们的对角矩阵 $K$，特征值就是对角线上的元素，即 $\\lambda_{1} = 10^{12}$ 和 $\\lambda_{2} = 10^{3}$。条件数为：\n$$\n\\text{cond}(K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{10^{12}}{10^{3}} = 10^{9}\n$$\n大的条件数意味着该矩阵对扰动敏感，并且它以截然不同的缩放因子映射不同方向上的向量。在本问题中，代表刚性罚函数接触的第一个自由度的刚度（$k_{11} = 10^{12}$）比代表较软土体的第二个自由度的刚度（$k_{22} = 10^3$）大 $9$ 个数量级。\n\n关系式 $r = K \\Delta u$ 表明，如果 $K$ 含有大的元素，一个小的位移增量 $\\Delta u$ 就可能对应一个大的残余力 $r$。具体来说，残余力完全集中在非常刚硬的第一个自由度上（$r_1 = 10^3$）。为了平衡这个巨大的不平衡力，只需要一个大小为 $\\Delta u_1 = r_1/k_{11} = 10^3 / 10^{12} = 10^{-9}$ 的位移修正。由于位移修正量如此微小，对 $\\|\\Delta u\\|_2$ 的检查提供了一个误导性的收敛信号。它错误地将一个在非常刚硬方向上的微小步长当作是接近最终解。另一方面，基于力的判据直接衡量不平衡状态，不会被病态刚度矩阵的缩放效应所欺骗。因此，在具有高刚度对比的系统中（如此例），基于力或基于能量的收敛判据通常比纯粹基于位移的判据更为稳健和可靠。",
            "answer": "$$\n\\boxed{1.000 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "除了分别考察力和位移，我们还可以将两者结合起来，形成一个物理意义更强的能量准则。这个准则通常通过计算不平衡力在当前迭代步的位移增量上所做的功来衡量，即 $w^{(k)} = |(\\mathbf{r}^{(k)})^T \\Delta \\mathbf{u}^{(k)}|$。本练习将让您亲手计算这个能量（功）的度量，并理解它如何作为一个综合指标，同时反映了力和位移的收敛情况，为评估迭代过程的有效性提供了更全面的视角。",
            "id": "3511056",
            "problem": "在计算岩土力学的有限元法（FEM）的非线性准静态步中，第 $k$ 次迭代的残余力向量定义为不平衡力 $\\mathbf{r}^{(k)}=\\mathbf{f}_{\\mathrm{ext}}-\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}^{(k)})$，位移修正量为 $\\Delta \\mathbf{u}^{(k)}=\\mathbf{u}^{(k+1)}-\\mathbf{u}^{(k)}$。基于能量的收敛准则源于虚功原理：在一次迭代中，不平衡力沿位移增量做机械功。仅使用此原理和核心定义，构建第 $k$ 次迭代的标量形式的能量残差度量，其大小为该次迭代中不平衡力沿位移增量所做的机械功的绝对值。然后，通过参考功对其进行归一化，以评估收敛性。\n\n考虑一个在第 $k$ 次迭代时的 $2$ 自由度岩土力学模型，其参数如下\n$$\\mathbf{r}^{(k)}=\\begin{pmatrix}100 \\\\ -50\\end{pmatrix}\\ \\text{(牛顿)},\\qquad \\Delta \\mathbf{u}^{(k)}=\\begin{pmatrix}1\\times 10^{-3} \\\\ -2\\times 10^{-3}\\end{pmatrix}\\ \\text{(米)}.$$\n设能量容差为 $\\varepsilon_{E}=10^{-4}$，参考功为 $W_{\\mathrm{ref}}=1$（焦耳）。使用上述物理原理，计算不平衡力沿 $\\Delta \\mathbf{u}^{(k)}$ 所做的标量功 $w^{(k)}$，并通过构建比率\n$$\\rho_{E}^{(k)}=\\frac{w^{(k)}}{\\varepsilon_{E}\\,W_{\\mathrm{ref}}}$$\n来评估是否满足基于能量的收敛准则。\n将 $\\rho_{E}^{(k)}$ 作为你的最终答案报告（无单位）。如果你的答案需要四舍五入，请保留四位有效数字。",
            "solution": "用户提供了一个来自计算岩土力学领域的问题，具体涉及有限元法（FEM）中的收敛准则。该问题已经过验证，被认为是科学合理的、适定的和客观的。所有必要的数据均已提供，任务明确。我现在将着手解决。\n\n该问题要求计算非线性准静态分析步中基于能量的收敛度量。如问题所述，核心原理是能量残差与一次迭代中不平衡力所做的机械功有关。\n\n首先，我们对机械功的概念进行形式化。一个恒定的力向量 $\\mathbf{F}$ 沿一个位移向量 $\\mathbf{d}$ 所做的功 $W$ 定义为这两个向量的点积：\n$$W = \\mathbf{F} \\cdot \\mathbf{d}$$\n在本次有限元迭代的背景下，力是残余（不平衡）力向量 $\\mathbf{r}^{(k)}$，位移是位移增量修正向量 $\\Delta \\mathbf{u}^{(k)}$。问题要求构建标量形式的能量残差度量，记为 $w^{(k)}$，其大小为所做机械功的绝对值。因此，我们将 $w^{(k)}$ 定义为：\n$$w^{(k)} = |\\mathbf{r}^{(k)} \\cdot \\Delta \\mathbf{u}^{(k)}|$$\n问题给出了一个 $2$ 自由度系统在第 $k$ 次迭代时的具体数值：\n$$\\mathbf{r}^{(k)} = \\begin{pmatrix} 100 \\\\ -50 \\end{pmatrix} \\ \\text{(N)}$$\n$$\\Delta \\mathbf{u}^{(k)} = \\begin{pmatrix} 1 \\times 10^{-3} \\\\ -2 \\times 10^{-3} \\end{pmatrix} \\ \\text{(m)}$$\n我们计算点积，它代表了不平衡力所做的功：\n$$\\mathbf{r}^{(k)} \\cdot \\Delta \\mathbf{u}^{(k)} = (100) \\cdot (1 \\times 10^{-3}) + (-50) \\cdot (-2 \\times 10^{-3})$$\n$$\\mathbf{r}^{(k)} \\cdot \\Delta \\mathbf{u}^{(k)} = 0.1 + 0.1 = 0.2 \\ \\text{(J)}$$\n所做的功为 $0.2$ 焦耳。能量残差度量 $w^{(k)}$ 是该功的绝对值：\n$$w^{(k)} = |0.2| = 0.2 \\ \\text{(J)}$$\n接下来，问题指定了一个用于评估收敛性的特定比率 $\\rho_{E}^{(k)}$。该比率将计算出的功 $w^{(k)}$ 通过一个由能量容差 $\\varepsilon_{E}$ 缩放的参考功 $W_{\\mathrm{ref}}$ 进行归一化。其定义如下：\n$$\\rho_{E}^{(k)} = \\frac{w^{(k)}}{\\varepsilon_{E} \\, W_{\\mathrm{ref}}}$$\n提供的容差和参考功的值为：\n$$\\varepsilon_{E} = 10^{-4}$$\n$$W_{\\mathrm{ref}} = 1 \\ \\text{(J)}$$\n将计算出的 $w^{(k)}$ 值和给定参数代入 $\\rho_{E}^{(k)}$ 的表达式中：\n$$\\rho_{E}^{(k)} = \\frac{0.2}{10^{-4} \\cdot 1}$$\n$$\\rho_{E}^{(k)} = \\frac{0.2}{10^{-4}} = 0.2 \\times 10^{4}$$\n$$\\rho_{E}^{(k)} = 2000$$\n该比率的结果值为 $2000$。这是一个无单位量，因为分子和分母中的焦耳单位相互抵消了。\n\n问题还要求评估是否满足基于能量的收敛准则。通常，当这种归一化的残差度量小于或等于 $1$ 时，即认为达到收敛。在本例中，$\\rho_{E}^{(k)} = 2000$，远大于 $1$。因此，第 $k$ 次迭代的能量收敛准则未被满足，需要进一步迭代以将不平衡功降低到可接受的水平。\n\n题目要求的最终答案是 $\\rho_{E}^{(k)}$ 的数值。计算得出一个精确的整数，因此无需四舍五入。",
            "answer": "$$\\boxed{2000}$$"
        }
    ]
}