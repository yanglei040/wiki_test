{
    "hands_on_practices": [
        {
            "introduction": "To build robust plasticity models, one must first master the fundamental mechanics of their derivation. This exercise provides essential practice by having you derive a key component of the algorithmic tangent for the widely used Modified Cam-Clay model, which features a smooth yield surface. Completing this derivation will sharpen your tensor calculus skills and provide a concrete understanding of how material parameters and stress states combine to define the tangent stiffness .",
            "id": "3508732",
            "problem": "Consider a small-strain, isotropic, elasto-plastic material model for soils using the Modified Cam-Clay (MCC) theory with an associated flow rule. Let the plastic potential $G$ be identified with the MCC yield function $f$ in terms of the mean effective stress $p$, the deviatoric stress magnitude $q$, and the hardening variable $p_{c}$ (the preconsolidation pressure). The MCC potential is given by the widely accepted elliptical form\n$$\nG(p,q,p_{c}) \\equiv f(p,q,p_{c}) = \\frac{q^{2}}{M^{2}} + p\\left(p - p_{c}\\right),\n$$\nwhere $M>0$ is the slope of the critical state line in the $p$-$q$ plane. The stress invariants are defined by\n$$\np = \\frac{1}{3}\\,\\operatorname{tr}\\,\\boldsymbol{\\sigma}, \\quad \\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}, \\quad q = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\|,\n$$\nwith $\\boldsymbol{\\sigma}$ the Cauchy stress tensor, $\\boldsymbol{I}$ the second-order identity tensor, and $\\|\\cdot\\|$ the Euclidean norm. The elastic behavior is linear and isotropic, with the elastic fourth-order stiffness tensor $\\mathbb{C}_{e}$ expressed in terms of the bulk modulus $K>0$ and shear modulus $G>0$ as\n$$\n\\mathbb{C}_{e} : \\boldsymbol{X} = K\\,\\operatorname{tr}(\\boldsymbol{X})\\,\\boldsymbol{I} + 2G\\,\\operatorname{dev}(\\boldsymbol{X}),\n$$\nfor any second-order tensor $\\boldsymbol{X}$, where $\\operatorname{dev}(\\boldsymbol{X}) = \\boldsymbol{X} - \\frac{1}{3}\\,\\operatorname{tr}(\\boldsymbol{X})\\,\\boldsymbol{I}$.\n\nStarting from these definitions, derive the explicit tensorial expression for the associated flow direction\n$$\n\\boldsymbol{n} = \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}},\n$$\nin terms of $p$, $q$, $\\boldsymbol{s}$, $M$, and $\\boldsymbol{I}$. Then, using the given elastic stiffness $\\mathbb{C}_{e}$, compute the scalar contraction\n$$\n\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n},\n$$\nand express your final answer as a single closed-form analytic expression involving only $K$, $G$, $M$, $p$, $q$, and $p_{c}$. Do not perform any numerical substitution. Provide the final expression only. No rounding is required, and no units are to be reported with the final expression.",
            "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is a standard derivation in the field of computational geomechanics for an elasto-plastic model.\n\nThe objective is to first derive the flow direction tensor $\\boldsymbol{n}$ and then compute the scalar contraction $\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n}$.\n\nFirst, we derive the expression for the flow direction $\\boldsymbol{n} = \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}}$. The plastic potential $G$ is given as a function of the stress invariants $p$ and $q$, and the hardening variable $p_{c}$:\n$$\nG(p,q,p_{c}) = \\frac{q^{2}}{M^{2}} + p\\left(p - p_{c}\\right)\n$$\nUsing the chain rule, the gradient of $G$ with respect to the stress tensor $\\boldsymbol{\\sigma}$ is:\n$$\n\\boldsymbol{n} = \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial G}{\\partial p} \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial G}{\\partial q} \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}}\n$$\nWe compute the partial derivatives of $G$ with respect to $p$ and $q$:\n$$\n\\frac{\\partial G}{\\partial p} = 2p - p_{c}\n$$\n$$\n\\frac{\\partial G}{\\partial q} = \\frac{2q}{M^{2}}\n$$\nNext, we compute the derivatives of the stress invariants $p$ and $q$ with respect to $\\boldsymbol{\\sigma}$.\nFor the mean stress $p = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3}\\sigma_{kk}$, the derivative is:\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3} \\frac{\\partial (\\sigma_{kk})}{\\partial \\sigma_{ij}} \\boldsymbol{e}_{i} \\otimes \\boldsymbol{e}_{j} = \\frac{1}{3} \\delta_{ij} \\boldsymbol{e}_{i} \\otimes \\boldsymbol{e}_{j} = \\frac{1}{3}\\boldsymbol{I}\n$$\nwhere $\\boldsymbol{I}$ is the second-order identity tensor.\n\nFor the deviatoric stress magnitude $q = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\|$, it is easier to first consider $q^{2} = \\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}$. The derivative of $q$ with respect to $\\boldsymbol{\\sigma}$ is a standard result in continuum mechanics:\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q}\n$$\nTo show this, we use the chain rule again: $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{s}} : \\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}}$.\nFirst, $\\frac{\\partial q}{\\partial \\boldsymbol{s}} = \\frac{\\partial}{\\partial \\boldsymbol{s}} \\left(\\sqrt{\\frac{3}{2}(\\boldsymbol{s}:\\boldsymbol{s})}\\right) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}$.\nSince $q = \\sqrt{\\frac{3}{2}} \\|\\boldsymbol{s}\\|$, we have $\\|\\boldsymbol{s}\\| = q / \\sqrt{\\frac{3}{2}}$.\nSubstituting this gives $\\frac{\\partial q}{\\partial \\boldsymbol{s}} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{q / \\sqrt{3/2}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q}$.\nNext, $\\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}}(\\boldsymbol{\\sigma} - p\\boldsymbol{I}) = \\mathbb{I} - \\boldsymbol{I} \\otimes \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\mathbb{I} - \\frac{1}{3}\\boldsymbol{I} \\otimes \\boldsymbol{I}$, where $\\mathbb{I}$ is the fourth-order symmetric identity tensor.\nThus, $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\left( \\frac{3}{2} \\frac{\\boldsymbol{s}}{q} \\right) : \\left( \\mathbb{I} - \\frac{1}{3}\\boldsymbol{I} \\otimes \\boldsymbol{I} \\right) = \\frac{3}{2q}(\\boldsymbol{s}:\\mathbb{I}) - \\frac{3}{2q}\\left(\\frac{1}{3}(\\boldsymbol{s}:\\boldsymbol{I}) \\otimes \\boldsymbol{I}\\right) = \\frac{3}{2q}\\boldsymbol{s} - \\frac{1}{2q}\\operatorname{tr}(\\boldsymbol{s})\\boldsymbol{I}$.\nSince $\\boldsymbol{s}$ is deviatoric, $\\operatorname{tr}(\\boldsymbol{s}) = 0$. This confirms $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2}\\frac{\\boldsymbol{s}}{q}$.\n\nNow, we substitute these derivatives back into the expression for $\\boldsymbol{n}$:\n$$\n\\boldsymbol{n} = (2p - p_{c}) \\left(\\frac{1}{3}\\boldsymbol{I}\\right) + \\left(\\frac{2q}{M^{2}}\\right) \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}}{q}\\right)\n$$\n$$\n\\boldsymbol{n} = \\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\n$$\nThis is the explicit tensorial expression for the flow direction.\n\nThe second part of the problem is to compute the scalar contraction $\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n}$.\nThe elastic stiffness tensor acts on a second-order tensor $\\boldsymbol{X}$ as $\\mathbb{C}_{e} : \\boldsymbol{X} = K\\,\\operatorname{tr}(\\boldsymbol{X})\\,\\boldsymbol{I} + 2G\\,\\operatorname{dev}(\\boldsymbol{X})$.\nLet's first compute the action of $\\mathbb{C}_{e}$ on $\\boldsymbol{n}$:\n$$\n\\mathbb{C}_{e} : \\boldsymbol{n} = K\\,\\operatorname{tr}(\\boldsymbol{n})\\,\\boldsymbol{I} + 2G\\,\\operatorname{dev}(\\boldsymbol{n})\n$$\nWe need to find the trace $\\operatorname{tr}(\\boldsymbol{n})$ and the deviatoric part $\\operatorname{dev}(\\boldsymbol{n})$ of $\\boldsymbol{n}$.\nThe trace is:\n$$\n\\operatorname{tr}(\\boldsymbol{n}) = \\operatorname{tr}\\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\\right) = \\frac{1}{3}(2p - p_{c})\\operatorname{tr}(\\boldsymbol{I}) + \\frac{3}{M^{2}}\\operatorname{tr}(\\boldsymbol{s})\n$$\nUsing $\\operatorname{tr}(\\boldsymbol{I}) = 3$ and $\\operatorname{tr}(\\boldsymbol{s}) = 0$ (by definition of a deviatoric tensor), we get:\n$$\n\\operatorname{tr}(\\boldsymbol{n}) = \\frac{1}{3}(2p - p_{c})(3) + 0 = 2p - p_{c}\n$$\nThe deviatoric part of $\\boldsymbol{n}$ is $\\operatorname{dev}(\\boldsymbol{n}) = \\boldsymbol{n} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{n})\\boldsymbol{I}$.\nSubstituting the expressions for $\\boldsymbol{n}$ and $\\operatorname{tr}(\\boldsymbol{n})$:\n$$\n\\operatorname{dev}(\\boldsymbol{n}) = \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\\right) - \\frac{1}{3}(2p - p_{c})\\boldsymbol{I} = \\frac{3}{M^{2}}\\boldsymbol{s}\n$$\nThis is not surprising, as $\\boldsymbol{s}$ is itself deviatoric.\nNow substitute $\\operatorname{tr}(\\boldsymbol{n})$ and $\\operatorname{dev}(\\boldsymbol{n})$ into the expression for $\\mathbb{C}_{e} : \\boldsymbol{n}$:\n$$\n\\mathbb{C}_{e} : \\boldsymbol{n} = K(2p - p_{c})\\boldsymbol{I} + 2G\\left(\\frac{3}{M^{2}}\\boldsymbol{s}\\right) = K(2p - p_{c})\\boldsymbol{I} + \\frac{6G}{M^{2}}\\boldsymbol{s}\n$$\nFinally, we compute the double dot product $\\boldsymbol{n} : (\\mathbb{C}_{e} : \\boldsymbol{n})$:\n$$\n\\boldsymbol{n} : (\\mathbb{C}_{e} : \\boldsymbol{n}) = \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\\right) : \\left(K(2p - p_{c})\\boldsymbol{I} + \\frac{6G}{M^{2}}\\boldsymbol{s}\\right)\n$$\nWe expand the product based on the distributive property of the double dot product:\n$$\n= \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I}\\right):\\left(K(2p - p_{c})\\boldsymbol{I}\\right) + \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I}\\right):\\left(\\frac{6G}{M^{2}}\\boldsymbol{s}\\right) \\\\ + \\left(\\frac{3}{M^{2}}\\boldsymbol{s}\\right):\\left(K(2p - p_{c})\\boldsymbol{I}\\right) + \\left(\\frac{3}{M^{2}}\\boldsymbol{s}\\right):\\left(\\frac{6G}{M^{2}}\\boldsymbol{s}\\right)\n$$\nWe use the tensor identities $\\boldsymbol{I}:\\boldsymbol{I} = 3$, $\\boldsymbol{I}:\\boldsymbol{s} = \\operatorname{tr}(\\boldsymbol{s}) = 0$, and $\\boldsymbol{s}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{s})=0$.\nThe first term is:\n$$\n\\frac{1}{3}K(2p-p_{c})^{2}(\\boldsymbol{I}:\\boldsymbol{I}) = \\frac{1}{3}K(2p-p_{c})^{2}(3) = K(2p - p_{c})^{2}\n$$\nThe second and third terms are zero due to $\\boldsymbol{I}:\\boldsymbol{s}=0$ and $\\boldsymbol{s}:\\boldsymbol{I}=0$.\nThe fourth term is:\n$$\n\\left(\\frac{3}{M^{2}}\\right)\\left(\\frac{6G}{M^{2}}\\right)(\\boldsymbol{s}:\\boldsymbol{s}) = \\frac{18G}{M^{4}}(\\boldsymbol{s}:\\boldsymbol{s})\n$$\nFrom the definition $q = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\| = \\sqrt{\\frac{3}{2}(\\boldsymbol{s}:\\boldsymbol{s})}$, we have $q^{2} = \\frac{3}{2}(\\boldsymbol{s}:\\boldsymbol{s})$, which gives $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^{2}$.\nSubstituting this into the fourth term:\n$$\n\\frac{18G}{M^{4}}\\left(\\frac{2}{3}q^{2}\\right) = \\frac{12G}{M^{4}}q^{2}\n$$\nCombining the non-zero terms, we obtain the final expression:\n$$\n\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n} = K(2p - p_{c})^{2} + \\frac{12G}{M^{4}}q^{2}\n$$\nThis expression is in terms of the required variables $K, G, M, p, q,$ and $p_{c}$.",
            "answer": "$$\n\\boxed{K(2p - p_{c})^{2} + \\frac{12G}{M^{4}}q^{2}}\n$$"
        },
        {
            "introduction": "Real-world yield surfaces are often not smooth, featuring sharp corners and apexes that introduce mathematical singularities and require special treatment. This practice addresses the important case of a stress state returning to the apex of the Drucker-Prager yield cone, a common scenario in geomechanics simulations. By working through this problem, you will learn the regularization technique needed to derive a well-defined and robust consistent tangent operator at a singular point .",
            "id": "3508756",
            "problem": "Consider a three-dimensional small-strain, isotropic, elastoplastic material governed by linear elasticity and an associative Drucker–Prager yield condition. Let the fourth-order elastic stiffness be $\\mathbb{C} = K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}$, where $K$ and $G$ are the bulk and shear moduli, respectively, $\\mathbb{I}$ is the second-order identity tensor, and $\\mathbb{P}^{\\text{dev}} := \\mathbb{I}^{\\text{sym}} - \\tfrac{1}{3}\\,\\mathbb{I} \\otimes \\mathbb{I}$ is the deviatoric projector with $\\mathbb{I}^{\\text{sym}}$ the fourth-order symmetric identity. The Cauchy stress is $\\boldsymbol{\\sigma}$, with first invariant $I_{1} := \\operatorname{tr}(\\boldsymbol{\\sigma})$, deviatoric stress $\\boldsymbol{s} := \\boldsymbol{\\sigma} - \\tfrac{1}{3}I_{1}\\,\\mathbb{I}$, and second invariant $J_{2} := \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$. The associative Drucker–Prager yield function is \n$$\nf(\\boldsymbol{\\sigma},\\kappa) := \\sqrt{J_{2}} + \\alpha\\,I_{1} - \\kappa,\n$$\nwith friction parameter $\\alpha>0$ and an isotropic hardening scalar $\\kappa$ evolving as $\\Delta\\kappa = H\\,\\Delta\\lambda$, where $H \\ge 0$ is a constant plastic modulus and $\\Delta\\lambda \\ge 0$ is the plastic multiplier. The backward Euler return mapping updates the stress as\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\Delta\\lambda\\,\\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\Big|_{n+1}, \n\\quad\nf(\\boldsymbol{\\sigma}_{n+1},\\kappa_{n} + H\\,\\Delta\\lambda) = 0,\n$$\nwhere $\\boldsymbol{\\sigma}_{\\text{tr}} := \\boldsymbol{\\sigma}_{n} + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}$ is the elastic trial stress for total strain increment $\\Delta\\boldsymbol{\\varepsilon}$.\n\nFocus on the apex return case, where the integration reaches the hydrostatic apex characterized by $J_{2} \\to 0$ and $\\boldsymbol{s}_{n+1} = \\boldsymbol{0}$, which makes the derivative $\\partial \\sqrt{J_{2}}/\\partial \\boldsymbol{\\sigma}$ formally singular. Starting from the stated kinematics, elasticity, yield function, associative flow, and backward Euler update and consistency, derive the special-case algorithmic consistent tangent operator $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} := \\dfrac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$. The derivation must explicitly handle the apex limit $J_{2} \\to 0$ and show the role of the hardening modulus $H$.\n\nIn addition, clearly state the regularization that must be introduced to avoid singular derivatives in $\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ at the apex and justify its consequence for the apex-limit form of $\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$.\n\nExpress your final answer as a single closed-form analytic expression for $\\mathbb{C}_{\\text{alg}}^{\\text{apex}}$ in terms of $K$, $G$, $\\alpha$, $H$, $\\mathbb{I}\\otimes\\mathbb{I}$, and $\\mathbb{P}^{\\text{dev}}$. No numerical evaluation is required. The final answer must be a single expression with no units inside the box.",
            "solution": "The user wants to solve a computational geomechanics problem.\n\n### Step 1: Problem Validation\n\nThe problem is to derive the algorithmic consistent tangent operator for an associative Drucker-Prager plasticity model specifically for the apex return case.\n\n**Givens:**\n-   **Elasticity**: Isotropic, with fourth-order stiffness $\\mathbb{C} = K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}$.\n-   **Yield Function**: $f(\\boldsymbol{\\sigma},\\kappa) := \\sqrt{J_{2}} + \\alpha\\,I_{1} - \\kappa$, with $\\alpha>0$.\n-   **Stress Invariants**: $I_{1} = \\operatorname{tr}(\\boldsymbol{\\sigma})$, $J_{2} = \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$ where $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3}I_{1}\\,\\mathbb{I}$.\n-   **Hardening**: Isotropic, $\\Delta\\kappa = H\\,\\Delta\\lambda$, with $H \\ge 0$.\n-   **Flow Rule**: Associative, $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$.\n-   **Integration**: Backward Euler, with $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\Delta\\lambda\\,\\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\Big|_{n+1}$ and consistency $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$.\n-   **Apex Condition**: The return mapping results in a state on the hydrostatic axis, i.e., $\\boldsymbol{s}_{n+1} = \\boldsymbol{0}$ and $J_{2,n+1} = 0$.\n-   **Objective**: Derive $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} := \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$ for the apex case, explaining the necessary regularization.\n\n**Validation:**\n1.  **Scientifically Grounded**: The problem is a standard, albeit advanced, topic in computational plasticity. The Drucker-Prager model, return mapping algorithms, and the derivation of consistent tangent operators are well-established concepts in solid mechanics and geomechanics.\n2.  **Well-Posed**: The problem provides a complete set of governing equations and a clearly defined objective. The apex return is a specific, well-defined scenario that leads to a unique expression for the tangent operator.\n3.  **Objective**: The problem is stated using precise, unambiguous technical language.\n\nThe problem is deemed **valid** as it is scientifically sound, well-posed, and objective. There are no contradictions, missing information, or pseudo-scientific claims.\n\n### Step 2: Solution\n\nThe derivation of the algorithmic consistent tangent operator, $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} := \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$, for the apex return case proceeds as follows.\n\n**Regularization at the Apex**\nThe gradient of the yield function, which defines the direction of plastic flow, is\n$$\n\\boldsymbol{N} := \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial \\sqrt{J_2}}{\\partial \\boldsymbol{\\sigma}} + \\alpha \\frac{\\partial I_1}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\boldsymbol{s}}{2\\sqrt{J_2}} + \\alpha \\mathbb{I}\n$$\nAt the apex of the yield cone, the stress state is purely hydrostatic, meaning the deviatoric stress tensor $\\boldsymbol{s} = \\boldsymbol{0}$ and thus its invariant $J_2 = 0$. In this limit, the term $\\frac{\\boldsymbol{s}}{2\\sqrt{J_2}}$ is indeterminate. This mathematical singularity reflects the geometrical fact that a conical apex does not have a unique normal vector.\n\nTo resolve this indeterminacy, a regularization must be introduced. In the context of the apex return, the algorithm recognizes that the final state must be hydrostatic, $\\boldsymbol{s}_{n+1} = \\boldsymbol{0}$. This implies that the plastic flow process must accommodate the entire trial deviatoric stress $\\boldsymbol{s}_{\\text{tr}}$. The subsequent plastic evolution occurs purely along the hydrostatic axis. For a process that is purely hydrostatic, the plastic strain rate must also be purely volumetric. The deviatoric part of the plastic flow gradient, $\\frac{\\boldsymbol{s}}{2\\sqrt{J_2}}$, is therefore considered to be inactive for this stage.\n\nThe consequence of this regularization is that the effective gradient of the yield function at the apex is taken to be purely volumetric:\n$$\n\\boldsymbol{N}^{\\text{apex}} = \\lim_{\\boldsymbol{s}\\to\\boldsymbol{0}} \\left(\\frac{\\boldsymbol{s}}{2\\sqrt{J_2}} + \\alpha \\mathbb{I}\\right) \\longrightarrow \\alpha \\mathbb{I}\n$$\nThis assumes that for the purely hydrostatic plastic loading/unloading at the apex, the deviatoric part of the flow direction is null.\n\n**Derivation of the Apex Tangent Operator**\nThe apex return is typically triggered when the trial stress is in a region where its hydrostatic component alone violates the yield condition, i.e., $f(\\frac{1}{3}I_{1,\\text{tr}}\\mathbb{I}, \\kappa_n) = \\alpha I_{1,\\text{tr}} - \\kappa_n > 0$. In this case, the algorithm directly sets the final deviatoric stress to zero, $\\boldsymbol{s}_{n+1}=\\boldsymbol{0}$, which implies the final stress state is hydrostatic: $\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3}I_{1,n+1}\\mathbb{I}$.\n\nThe final stress state is determined by the backward Euler integration scheme and the consistency condition. We have two scalar unknowns, the final first stress invariant $I_{1,n+1}$ and the plastic multiplier $\\Delta\\lambda$. They are governed by two scalar equations.\n\n1.  **Consistency Condition at the Apex**: With $J_{2,n+1}=0$ and $\\kappa_{n+1} = \\kappa_n + H\\Delta\\lambda$, the yield function $f_{n+1}=0$ becomes:\n    $$\n    \\alpha I_{1,n+1} - (\\kappa_n + H\\Delta\\lambda) = 0\n    $$\n\n2.  **Volumetric Stress Update**: The stress update rule is $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\Delta\\lambda\\,\\mathbb{C} : \\boldsymbol{N}^{\\text{apex}}$. Substituting $\\boldsymbol{N}^{\\text{apex}} = \\alpha \\mathbb{I}$ and taking the trace of the equation gives:\n    $$\n    I_{1,n+1} = I_{1,\\text{tr}} - \\Delta\\lambda\\, \\mathbb{I} : (\\mathbb{C} : (\\alpha \\mathbb{I}))\n    $$\n    Let's evaluate the term $\\mathbb{I} : (\\mathbb{C} : (\\alpha \\mathbb{I}))$. Using the definition $\\mathbb{C} = K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}$:\n    $$\n    \\mathbb{I} : (\\mathbb{C} : (\\alpha \\mathbb{I})) = \\alpha\\, \\mathbb{I} : (\\mathbb{C} : \\mathbb{I}) = \\alpha\\, (\\mathbb{I} : \\mathbb{C}) : \\mathbb{I}\n    $$\n    The contraction $\\mathbb{I} : \\mathbb{C}$ is:\n    $$\n    \\mathbb{I} : \\mathbb{C} = \\mathbb{I} : (K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}) = K(\\mathbb{I} : (\\mathbb{I} \\otimes \\mathbb{I})) + 2G(\\mathbb{I} : \\mathbb{P}^{\\text{dev}})\n    $$\n    Since $\\mathbb{I} : \\mathbb{I} = 3$ and $\\mathbb{P}^{\\text{dev}}$ projects onto the deviatoric subspace, $\\mathbb{I} : \\mathbb{P}^{\\text{dev}} = \\boldsymbol{0}$. Also, $\\mathbb{I} : (\\mathbb{I} \\otimes \\mathbb{I}) = (\\mathbb{I}:\\mathbb{I})\\mathbb{I} = 3\\mathbb{I}$. So, $\\mathbb{I} : \\mathbb{C} = 3K\\mathbb{I}$.\n    Substituting this back, we get:\n    $$\n    \\alpha\\, (3K\\mathbb{I}) : \\mathbb{I} = 3K\\alpha (\\mathbb{I}:\\mathbb{I}) = 3K\\alpha(3) = 9K\\alpha\n    $$\n    Thus, the volumetric stress update simplifies to:\n    $$\n    I_{1,n+1} = I_{1, \\text{tr}} - 9K\\alpha\\Delta\\lambda\n    $$\n\nNow we solve the system of two linear equations for $\\Delta\\lambda$ and $I_{1,n+1}$:\n(a) $\\alpha I_{1,n+1} - H\\Delta\\lambda = \\kappa_n$\n(b) $I_{1,n+1} + 9K\\alpha\\Delta\\lambda = I_{1, \\text{tr}}$\n\nFrom (b), $\\Delta\\lambda = \\frac{I_{1,\\text{tr}} - I_{1,n+1}}{9K\\alpha}$. Substituting into (a):\n$$\n\\alpha I_{1,n+1} - H\\frac{I_{1,\\text{tr}} - I_{1,n+1}}{9K\\alpha} = \\kappa_n\n$$\n$$\n9K\\alpha^2 I_{1,n+1} - H I_{1,\\text{tr}} + H I_{1,n+1} = 9K\\alpha\\kappa_n\n$$\n$$\n(9K\\alpha^2 + H) I_{1,n+1} = 9K\\alpha\\kappa_n + H I_{1,\\text{tr}}\n$$\nThis yields the final hydrostatic stress invariant in terms of the trial one:\n$$\nI_{1,n+1} = \\frac{9K\\alpha\\kappa_n + H I_{1, \\text{tr}}}{H + 9K\\alpha^2}\n$$\nThe final stress tensor is $\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3} I_{1,n+1} \\mathbb{I}$. To compute the consistent tangent operator $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} = \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$, we first relate $I_{1,\\text{tr}}$ to the total strain increment $\\Delta\\boldsymbol{\\varepsilon}$:\n$$\nI_{1, \\text{tr}} = \\operatorname{tr}(\\boldsymbol{\\sigma}_n + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}) = I_{1,n} + \\mathbb{I}:(\\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}) = I_{1,n} + (3K\\mathbb{I}):\\Delta\\boldsymbol{\\varepsilon} = I_{1,n} + 3K\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon})\n$$\nDifferentiating $\\boldsymbol{\\sigma}_{n+1}$ with respect to $\\Delta\\boldsymbol{\\varepsilon}$:\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}} : d\\Delta\\boldsymbol{\\varepsilon} = \\mathbb{C}_{\\text{alg}}^{\\text{apex}} : d\\Delta\\boldsymbol{\\varepsilon}\n$$\nWe have $d\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3} dI_{1,n+1} \\mathbb{I}$. Differentiating the expression for $I_{1,n+1}$:\n$$\ndI_{1,n+1} = \\frac{\\partial I_{1,n+1}}{\\partial I_{1,\\text{tr}}} dI_{1,\\text{tr}} = \\frac{H}{H + 9K\\alpha^2} dI_{1,\\text{tr}}\n$$\nAnd $dI_{1,\\text{tr}} = 3K \\operatorname{tr}(d\\Delta\\boldsymbol{\\varepsilon}) = 3K (\\mathbb{I}:d\\Delta\\boldsymbol{\\varepsilon})$.\nCombining these correctly:\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3} \\left( \\frac{H}{H + 9K\\alpha^2} \\right) (3K (\\mathbb{I}:d\\Delta\\boldsymbol{\\varepsilon})) \\mathbb{I}\n$$\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\frac{KH}{H + 9K\\alpha^2} (\\mathbb{I}:d\\Delta\\boldsymbol{\\varepsilon}) \\mathbb{I}\n$$\nThis relation can be written in tensorial form as:\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\left( \\frac{KH}{H + 9K\\alpha^2} \\mathbb{I} \\otimes \\mathbb{I} \\right) : d\\Delta\\boldsymbol{\\varepsilon}\n$$\nBy definition, the algorithmic consistent tangent operator for the apex return is therefore:\n$$\n\\mathbb{C}_{\\text{alg}}^{\\text{apex}} = \\frac{KH}{H + 9K\\alpha^2} \\mathbb{I} \\otimes \\mathbb{I}\n$$\nThis operator is purely volumetric, reflecting the fact that the final stress state is hydrostatic. The role of the hardening modulus $H$ is evident: for perfect plasticity ($H=0$), $\\mathbb{C}_{\\text{alg}}^{\\text{apex}}=\\boldsymbol{0}$, meaning the stress is fixed at the apex and does not change with further strain. For $H>0$, the material exhibits a stiffening response. The shear modulus $G$ and the deviatoric projector $\\mathbb{P}^{\\text{dev}}$ do not appear, as the deviatoric response is fully plasticized in an apex return.",
            "answer": "$$\n\\boxed{\\frac{KH}{H + 9K\\alpha^2} \\mathbb{I} \\otimes \\mathbb{I}}\n$$"
        },
        {
            "introduction": "Beyond ensuring numerical convergence, the consistent tangent operator plays a crucial role in the predictive capability of a simulation, especially when modeling material failure. This practice connects the abstract concept of the tangent modulus to the physical phenomenon of strain localization and shear band formation. By deriving and comparing the results from the mathematically rigorous consistent tangent versus a simpler secant tangent, you will quantify why this precision is essential for accurately predicting material instabilities .",
            "id": "3508706",
            "problem": "Consider a one-dimensional small-strain gradient-enhanced elastoplastic solid under monotonic tension. The Cauchy stress is $\\sigma = E(\\varepsilon - \\varepsilon^{p})$, where $E$ is the Young’s modulus, $\\varepsilon$ is the total strain, and $\\varepsilon^{p}$ is the plastic strain. Adopt a rate-independent associative flow with accumulated plastic strain $\\kappa$ defined by $\\dot{\\kappa} = \\dot{\\lambda}$ and $\\dot{\\varepsilon}^{p} = \\dot{\\lambda}$ in uniaxial monotonic loading. The yield stress degrades exponentially with $\\kappa$ as $Y(\\kappa) = Y_{0}\\,\\exp(-\\kappa/\\kappa_{0})$ with $Y_{0} > 0$ and $\\kappa_{0} > 0$.\n\nA single internal length $\\ell$ regularizes localization via an energetic gradient contribution that, upon linearization about a homogeneous state and Fourier decomposition of perturbations with wavenumber $k$, produces a stabilizing term proportional to $g\\,E\\,(k\\,\\ell)^{2}$, where $g > 0$ is a dimensionless gradient coefficient. Assume a backward Euler return mapping at each increment. Let $\\Delta \\varepsilon$ denote the applied strain increment, $\\Delta \\gamma$ the plastic multiplier increment, and $\\kappa_{n}$ the prior accumulated plastic strain at step $n$. The trial stress is $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\,\\Delta \\varepsilon$ with $\\sigma_{n} = Y(\\kappa_{n})$ (assume the previous state lies on the yield surface in monotonic loading). The backward Euler plastic corrector enforces $\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma$ and $\\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma$ with the end-of-step consistency condition $\\sigma_{n+1} - Y(\\kappa_{n+1}) = 0$.\n\nTasks:\n1) Starting only from the constitutive definitions above and the backward Euler consistency condition, derive the expression for the algorithmic consistent tangent $E_{\\mathrm{alg}}^{\\mathrm{con}}$ at the end of a plastic step as the exact linearization $\\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\varepsilon_{n+1}$. Derive, by contrast, the secant tangent $E_{\\mathrm{alg}}^{\\mathrm{sec}}$ defined by the chord slope $(\\sigma_{n+1}-\\sigma_{n})/(\\varepsilon_{n+1}-\\varepsilon_{n})$ over the same increment.\n2) Using linear stability of homogeneous response under Fourier-mode perturbations, derive the neutral stability condition that defines the critical wavenumber $k^{\\star}$ in terms of $E_{\\mathrm{alg}}$ and the gradient contribution. From this, derive the predicted shear-band thickness $t$ as the half-wavelength of the critical mode, and provide the normalized thickness $T = t/\\ell$ in terms of $E_{\\mathrm{alg}}$, $E$, and $g$. Specify what to report when $E_{\\mathrm{alg}} \\ge 0$ (no softening instability).\n3) Propose a numerical experiment that isolates the role of the tangent choice from the internal length parameter $\\ell$ by holding $\\ell$ and $g$ fixed while varying only the loading increment $\\Delta \\varepsilon$ and/or the softening curvature $\\kappa_{0}$, and explain the rationale.\n4) Implement a complete program that:\n   - For each test case below, solves the scalar backward Euler plastic corrector for $\\Delta \\gamma$ by finding the root of the consistency equation $\\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - Y(\\kappa_{n}+\\Delta \\gamma) = 0$ using a robust bracketed method, then evaluates both $E_{\\mathrm{alg}}^{\\mathrm{con}}$ and $E_{\\mathrm{alg}}^{\\mathrm{sec}}$ from your derivations.\n   - Computes the normalized predicted thicknesses $T^{\\mathrm{con}}$ and $T^{\\mathrm{sec}}$ for the consistent and secant tangents, respectively, for a fixed $g$ and $\\ell$.\n   - Reports the triple $[T^{\\mathrm{con}},\\,T^{\\mathrm{sec}},\\,T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$ as floats for each case, using the convention that if $E_{\\mathrm{alg}} \\ge 0$ then $T = 10^{9}$ (dimensionless) to indicate no localization.\n   - Aggregates the results for all cases into a single line as a comma-separated Python-style list of lists.\n\nUse the following test suite that holds $E$, $Y_{0}$, $\\kappa_{n}$, $g$, and $\\ell$ fixed while varying $\\Delta \\varepsilon$ and $\\kappa_{0}$ to isolate the tangent’s role:\n- Case A (near-incremental limit): $E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-6}$, $g = 0.2$, $\\ell = 1$.\n- Case B (moderate increment): $E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$.\n- Case C (sharper softening curvature): $E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.05$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$.\n\nAll quantities are nondimensional by construction, and the requested outputs $T^{\\mathrm{con}}$, $T^{\\mathrm{sec}}$, and their difference are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of three lists, each inner list formatted as $[T^{\\mathrm{con}},T^{\\mathrm{sec}},T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$ for Cases A, B, and C in this order, for example $[[a,b,c],[d,e,f],[g,h,i]]$.",
            "solution": "We work in one dimension with small strain and monotonic loading. The stress is $\\sigma = E(\\varepsilon - \\varepsilon^{p})$, with accumulated plastic strain $\\kappa$ satisfying $\\dot{\\kappa} = \\dot{\\lambda}$ and $\\dot{\\varepsilon}^{p} = \\dot{\\lambda}$. The yield stress degrades as $Y(\\kappa) = Y_{0}\\exp(-\\kappa/\\kappa_{0})$. At step $n \\to n+1$ with strain increment $\\Delta \\varepsilon$, we adopt backward Euler. Assume the previous state is on the yield surface due to monotonic loading: $\\sigma_{n} = Y(\\kappa_{n})$. The trial stress is\n$$\n\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\,\\Delta \\varepsilon = Y(\\kappa_{n}) + E\\,\\Delta \\varepsilon.\n$$\nIf plastic correction occurs, the end-of-step values satisfy\n$$\n\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma, \\quad \\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma,\n$$\nand the discrete consistency condition\n$$\nr(\\Delta \\gamma) \\equiv \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - Y(\\kappa_{n+1}) = 0, \\quad \\text{with} \\quad Y(\\kappa_{n+1}) = Y_{0}\\exp\\!\\left(-\\frac{\\kappa_{n}+\\Delta \\gamma}{\\kappa_{0}}\\right).\n$$\n\n1) Algorithmic consistent tangent. The algorithmic consistent tangent $E_{\\mathrm{alg}}^{\\mathrm{con}} = \\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\varepsilon_{n+1}$ is defined by exact linearization of the fully implicit update. Differentiate the scalar consistency equation with respect to $\\Delta \\varepsilon$, noting that $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\Delta \\varepsilon$ and $\\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma(\\Delta \\varepsilon)$:\n$$\n0 = \\frac{\\mathrm{d}r}{\\mathrm{d}\\Delta \\varepsilon} = \\frac{\\partial r}{\\partial \\Delta \\varepsilon} + \\frac{\\partial r}{\\partial \\Delta \\gamma}\\,\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon}\n= E + \\left(-E - Y'(\\kappa_{n+1})\\right)\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon},\n$$\nwhere $Y'(\\kappa) = \\mathrm{d}Y/\\mathrm{d}\\kappa = -\\frac{1}{\\kappa_{0}}\\,Y(\\kappa)$. Solving for the sensitivity yields\n$$\n\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon} = \\frac{E}{E + Y'(\\kappa_{n+1})}.\n$$\nThe end-of-step stress satisfies $\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma$, so\n$$\nE_{\\mathrm{alg}}^{\\mathrm{con}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\varepsilon_{n+1}} = E - E\\,\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon}\n= E\\left(1 - \\frac{E}{E + Y'(\\kappa_{n+1})}\\right)\n= E\\,\\frac{Y'(\\kappa_{n+1})}{E + Y'(\\kappa_{n+1})}.\n$$\nBecause $Y'(\\kappa_{n+1})  0$ for softening, one finds $E_{\\mathrm{alg}}^{\\mathrm{con}}  0$ in a plastic softening step.\n\nSecant tangent. The secant tangent over the finite step is defined as the chord slope\n$$\nE_{\\mathrm{alg}}^{\\mathrm{sec}} = \\frac{\\sigma_{n+1} - \\sigma_{n}}{\\varepsilon_{n+1} - \\varepsilon_{n}} = \\frac{\\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - \\sigma_{n}}{\\Delta \\varepsilon} = \\frac{E\\,\\Delta \\varepsilon - E\\,\\Delta \\gamma}{\\Delta \\varepsilon} = E\\left(1 - \\frac{\\Delta \\gamma}{\\Delta \\varepsilon}\\right).\n$$\nFor nonlinear softening $Y(\\kappa)$, one has $\\Delta \\gamma/\\Delta \\varepsilon \\ne \\partial \\Delta \\gamma/\\partial \\Delta \\varepsilon$ in general, hence $E_{\\mathrm{alg}}^{\\mathrm{sec}} \\ne E_{\\mathrm{alg}}^{\\mathrm{con}}$.\n\nTo evaluate either tangent, we first solve the scalar nonlinear equation $r(\\Delta \\gamma) = 0$ for $\\Delta \\gamma$. Then compute $\\kappa_{n+1}$, $Y(\\kappa_{n+1})$, and $Y'(\\kappa_{n+1})$. The consistent tangent follows from the expression above; the secant follows from the chord ratio.\n\n2) Gradient-regularized stability and shear-band thickness. Consider linear perturbations about a homogeneous state with Fourier mode $\\mathrm{e}^{\\mathrm{i}k x}$. The incremental force operator in the homogeneous medium separates into a material part proportional to the scalar algorithmic tangent $E_{\\mathrm{alg}}$ and a stabilizing gradient part proportional to $g\\,E\\,(k\\,\\ell)^{2}$. Neutral stability (onset of localization) occurs when the net incremental stiffness of a mode vanishes, which gives the scalar condition\n$$\n-E_{\\mathrm{alg}} + g\\,E\\,(k\\,\\ell)^{2} = 0 \\quad \\Rightarrow \\quad k^{\\star}\\ell = \\sqrt{\\frac{-E_{\\mathrm{alg}}}{g\\,E}}, \\quad \\text{for } E_{\\mathrm{alg}}  0.\n$$\nThe most unstable perturbation at onset has wavenumber $k^{\\star}$ and wavelength $\\lambda^{\\star} = 2\\pi/k^{\\star}$. A common measure of shear-band thickness is the half-wavelength, so\n$$\nt = \\frac{\\pi}{k^{\\star}}, \\qquad T \\equiv \\frac{t}{\\ell} = \\pi\\,\\sqrt{\\frac{g\\,E}{-E_{\\mathrm{alg}}}} \\quad \\text{if } E_{\\mathrm{alg}}  0.\n$$\nWhen $E_{\\mathrm{alg}} \\ge 0$, no softening-driven localization is predicted; we adopt the convention $T = 10^{9}$ (dimensionless) to denote the absence of a finite localization thickness within this linearized criterion.\n\n3) Numerical experiment to isolate the tangent’s role. To decouple the contribution of the tangent from the internal length parameter, hold fixed the intrinsic length $\\ell$ and the gradient coefficient $g$, and keep the elastic modulus $E$ and yield scale $Y_{0}$ fixed. Vary the nonlinearity of the return mapping by changing either (a) the strain increment $\\Delta \\varepsilon$ (probing the difference between chord and differential slopes) or (b) the softening curvature parameter $\\kappa_{0}$ (which controls $Y'(\\kappa)$ at a given state). For each case, compute $E_{\\mathrm{alg}}^{\\mathrm{con}}$ and $E_{\\mathrm{alg}}^{\\mathrm{sec}}$, then evaluate $T^{\\mathrm{con}}$ and $T^{\\mathrm{sec}}$ from the stability formula with the same fixed $g$ and $\\ell$. Since $\\ell$ and $g$ are held constant, any change in $T$ across cases is solely attributable to changes in $E_{\\mathrm{alg}}$ due to the tangent choice and constitutive nonlinearity, thus isolating the tangent’s role.\n\n4) Algorithmic implementation. For each test case:\n- Compute $\\sigma_{n} = Y_{0}\\exp(-\\kappa_{n}/\\kappa_{0})$ and $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\,\\Delta \\varepsilon$.\n- Solve $r(\\Delta \\gamma) = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - Y_{0}\\exp(-(\\kappa_{n}+\\Delta \\gamma)/\\kappa_{0}) = 0$ for $\\Delta \\gamma \\ge 0$ using a bracketed method (e.g., bisection), noting that $r(0) = E\\,\\Delta \\varepsilon \\ge 0$ and $r(\\Delta \\gamma) \\to -\\infty$ as $\\Delta \\gamma \\to +\\infty$, so a bracket can always be constructed.\n- Evaluate $\\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma$, $Y(\\kappa_{n+1})$, and $Y'(\\kappa_{n+1}) = -Y(\\kappa_{n+1})/\\kappa_{0}$.\n- Compute $E_{\\mathrm{alg}}^{\\mathrm{con}} = E\\,\\dfrac{Y'(\\kappa_{n+1})}{E + Y'(\\kappa_{n+1})}$ and $E_{\\mathrm{alg}}^{\\mathrm{sec}} = E\\left(1 - \\dfrac{\\Delta \\gamma}{\\Delta \\varepsilon}\\right)$. Guard $\\Delta \\varepsilon > 0$ in the secant calculation.\n- Compute $T^{\\mathrm{con}} = \\pi\\sqrt{\\dfrac{g\\,E}{-E_{\\mathrm{alg}}^{\\mathrm{con}}}}$ if $E_{\\mathrm{alg}}^{\\mathrm{con}}  0$ else $T^{\\mathrm{con}} = 10^{9}$; similarly for $T^{\\mathrm{sec}}$ using $E_{\\mathrm{alg}}^{\\mathrm{sec}}$.\n- Report the triple $[T^{\\mathrm{con}},\\,T^{\\mathrm{sec}},\\,T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$.\n\nWith the specified test suite:\n- Case A: $E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-6}$, $g = 0.2$, $\\ell = 1$.\n- Case B: $E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$.\n- Case C: $E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.05$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$.\n\nThe final program computes these values and prints a single line containing a Python-style list of three lists in the order A, B, C, each inner list $[T^{\\mathrm{con}},T^{\\mathrm{sec}},T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$, all dimensionless.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_return_mapping(E, Y0, kappa0, kappa_n, delta_eps):\n    \"\"\"\n    Solve the backward Euler return mapping for exponential softening:\n      r(dgamma) = sigma_tr - E*dgamma - Y0*exp(-(kappa_n + dgamma)/kappa0) = 0\n    using a robust bisection method. Assumes previous state on yield: sigma_n = Y(kappa_n).\n    Returns:\n      dgamma, kappa_np1, Y_end, Yprime_end\n    \"\"\"\n    # Previous stress on yield\n    sigma_n = Y0 * np.exp(-kappa_n / kappa0)\n    # Trial stress\n    sigma_tr = sigma_n + E * delta_eps\n\n    # Residual function\n    def r(dg):\n        return sigma_tr - E * dg - Y0 * np.exp(-(kappa_n + dg) / kappa0)\n\n    # Bracket root: r(0) = 0, r(high) - negative for sufficiently large dgamma\n    r0 = r(0.0)\n    if r0  0:\n        # No plastic correction (should not happen in monotonic loading at yield with positive delta_eps)\n        dgamma = 0.0\n        kappa_np1 = kappa_n\n        Y_end = Y0 * np.exp(-kappa_np1 / kappa0)\n        Yprime_end = -Y_end / kappa0\n        return dgamma, kappa_np1, Y_end, Yprime_end\n\n    # Choose a high bound that guarantees negativity\n    # Since r ~ sigma_tr - E*dgamma as dg - inf, it becomes negative beyond sigma_tr/E\n    high = delta_eps + sigma_n / E + 10.0 * max(1.0, kappa0)\n    # Ensure r(high)  0; increase if needed\n    r_high = r(high)\n    iters = 0\n    while r_high  0 and iters  50:\n        high *= 2.0\n        r_high = r(high)\n        iters += 1\n\n    # Bisection\n    a, b = 0.0, high\n    fa, fb = r(a), r(b)\n    # Safety: if fb  0 due to numerical issues, fallback to small plastic step\n    if fb  0:\n        dgamma = 0.0\n        kappa_np1 = kappa_n\n        Y_end = Y0 * np.exp(-kappa_np1 / kappa0)\n        Yprime_end = -Y_end / kappa0\n        return dgamma, kappa_np1, Y_end, Yprime_end\n\n    tol = 1e-12\n    for _ in range(200):\n        c = 0.5 * (a + b)\n        fc = r(c)\n        if abs(fc)  tol or (b - a)  1e-12:\n            dgamma = c\n            break\n        if fa * fc  0:\n            a, fa = c, fc\n        else:\n            b, fb = c, fc\n    else:\n        dgamma = 0.5 * (a + b)\n\n    kappa_np1 = kappa_n + dgamma\n    Y_end = Y0 * np.exp(-kappa_np1 / kappa0)\n    Yprime_end = -Y_end / kappa0\n    return dgamma, kappa_np1, Y_end, Yprime_end\n\ndef consistent_tangent(E, Yprime_end):\n    # E_alg^con = E * Y' / (E + Y')\n    denom = E + Yprime_end\n    # Guard against division by zero\n    if abs(denom)  1e-15:\n        # In the singular limit, use a large negative tangent (approach -E)\n        return -E\n    return E * (Yprime_end / denom)\n\ndef secant_tangent(E, dgamma, delta_eps):\n    # E_alg^sec = E * (1 - dgamma/delta_eps)\n    if delta_eps = 0.0:\n        # No increment; use elastic stiffness as secant convention\n        return E\n    return E * (1.0 - dgamma / delta_eps)\n\ndef normalized_thickness(E, E_alg, g):\n    # T = pi * sqrt( g * E / (-E_alg) ) if E_alg  0, else 1e9\n    if E_alg  0.0:\n        val = np.pi * np.sqrt(g * E / (-E_alg))\n        # Numerical guard\n        if not np.isfinite(val):\n            return 1e9\n        return float(val)\n    else:\n        return 1e9\n\ndef run_case(E, Y0, kappa0, kappa_n, delta_eps, g, ell):\n    # ell is not used explicitly because we return normalized thickness T = t/ell\n    dgamma, kappa_np1, Y_end, Yprime_end = solve_return_mapping(E, Y0, kappa0, kappa_n, delta_eps)\n    E_alg_con = consistent_tangent(E, Yprime_end)\n    E_alg_sec = secant_tangent(E, dgamma, delta_eps)\n    T_con = normalized_thickness(E, E_alg_con, g)\n    T_sec = normalized_thickness(E, E_alg_sec, g)\n    return T_con, T_sec, T_sec - T_con\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (E, Y0, kappa0, kappa_n, delta_eps, g, ell)\n    test_cases = [\n        (1000.0, 300.0, 0.5, 0.1, 1e-6, 0.2, 1.0),    # Case A\n        (1000.0, 300.0, 0.5, 0.1, 1e-2, 0.2, 1.0),    # Case B\n        (1000.0, 300.0, 0.05, 0.1, 1e-2, 0.2, 1.0),   # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        E, Y0, kappa0, kappa_n, delta_eps, g, ell = case\n        T_con, T_sec, dT = run_case(E, Y0, kappa0, kappa_n, delta_eps, g, ell)\n        # Round for stable textual output\n        results.append([round(T_con, 6), round(T_sec, 6), round(dT, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}