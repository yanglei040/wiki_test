{
    "hands_on_practices": [
        {
            "introduction": "To truly appreciate the importance of the consistent tangent modulus, we begin with a practical demonstration of its impact on computational efficiency. This exercise guides you through a one-dimensional coding benchmark that starkly contrasts the convergence rates of two numerical solvers. By comparing a solver that uses the correct algorithmic tangent, $\\boldsymbol{D}^{ep}$, with one that uses a simplified elastic tangent, you will directly observe the quadratic convergence that makes robust and efficient finite element analysis possible .",
            "id": "3522215",
            "problem": "Consider a one-dimensional, small-strain, rate-independent elastoplastic material with linear isotropic hardening. Let the total strain be denoted by $\\varepsilon$, the stress by $\\sigma$, the elastic modulus by $E$ (in $\\mathrm{Pa}$), the initial yield stress by $\\sigma_{y0}$ (in $\\mathrm{Pa}$), and the plastic modulus by $H$ (in $\\mathrm{Pa}$). Assume monotonic loading in tension so that the plastic flow direction is positive. The material follows the additive strain decomposition and standard small-strain elastoplasticity with linear isotropic hardening, a convex yield function, associative flow, and the Kuhn–Tucker conditions. A single material point is subjected to a prescribed traction $T$ (in $\\mathrm{Pa}$); equilibrium at the material point is enforced by solving the scalar equation $R(\\varepsilon) = \\sigma(\\varepsilon) - T = 0$ for $\\varepsilon$ using Newton’s method.\n\nStarting only from the fundamental definitions of small-strain elastoplasticity, convex yield function with linear isotropic hardening, associative flow, and the consistency condition, derive the algorithmic elastoplastic tangent modulus $D^{ep}$ required for quadratic convergence of Newton’s method applied to the scalar equilibrium equation $R(\\varepsilon)=0$. Then, design and implement a benchmark to compare:\n- a Newton solver that uses the algorithmic $D^{ep}$ (i.e., the consistent tangent modulus) as the Jacobian $d\\sigma/d\\varepsilon$ in the iterations,\n- versus a Newton solver based on an elastic predictor–plastic corrector without a consistent tangent, which uses the elastic modulus $E$ as the Jacobian $d\\sigma/d\\varepsilon$ throughout the iterations, even after yielding.\n\nYour program must:\n1. Implement a physically admissible stress–strain response $\\sigma(\\varepsilon)$ for the described material point based on a standard return-mapping concept with linear isotropic hardening, ensuring that $\\sigma(\\varepsilon)$ is continuous and piecewise differentiable in $\\varepsilon$.\n2. Implement two Newton solvers for the scalar equation $R(\\varepsilon)=\\sigma(\\varepsilon)-T=0$:\n   - Solver A: Use the algorithmic elastoplastic tangent modulus $D^{ep}$ as the Jacobian $d\\sigma/d\\varepsilon$ when in plastic loading and the elastic modulus $E$ when in elastic loading.\n   - Solver B: Use only the elastic modulus $E$ as the Jacobian $d\\sigma/d\\varepsilon$ for all iterations, i.e., do not use the consistent tangent in plastic loading.\n3. Use a fixed residual tolerance of $10^{0}$ $\\mathrm{Pa}$, i.e., declare convergence when $|R(\\varepsilon)| \\leq 10^{0}$ $\\mathrm{Pa}$. Use a maximum number of Newton iterations of $1000$.\n4. Compute and report the following error metrics for each test case:\n   - The number of Newton iterations until convergence for Solver A and Solver B (each an integer).\n   - A boolean indicating whether convergence was achieved for Solver A and for Solver B within the iteration limit.\n   - The absolute strain error $|\\varepsilon_{\\text{num}} - \\varepsilon_{\\text{exact}}|$ (dimensionless), where $\\varepsilon_{\\text{exact}}$ is the exact closed-form solution obtained analytically by enforcing the elastic or plastic state conditions derived from first principles.\n   - The final residual $|R(\\varepsilon)|$ (in $\\mathrm{Pa}$) at termination for Solver A and Solver B.\n5. Use the following test suite, each case defined by $(E,\\sigma_{y0},H,T)$ with all moduli and tractions in $\\mathrm{Pa}$:\n   - Case $1$: $(200 \\times 10^9, 400 \\times 10^6, 10 \\times 10^9, 300 \\times 10^6)$, an elastic case.\n   - Case $2$: $(200 \\times 10^9, 400 \\times 10^6, 10 \\times 10^9, 400 \\times 10^6)$, at the elastic–plastic boundary.\n   - Case $3$: $(200 \\times 10^9, 400 \\times 10^6, 10 \\times 10^9, 800 \\times 10^6)$, a plastic case with moderate hardening.\n   - Case $4$: $(200 \\times 10^9, 400 \\times 10^6, 0.5 \\times 10^9, 800 \\times 10^6)$, a plastic case with weak hardening stressing the need for a consistent tangent.\n   - Case $5$: $(200 \\times 10^9, 400 \\times 10^6, 100 \\times 10^9, 1200 \\times 10^6)$, a plastic case with strong hardening approaching elastic-like behavior.\n6. Use the initial guess $\\varepsilon_0 = 0$ for all test cases.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list in the form:\n$[\\text{itersA},\\text{itersB},\\text{convA},\\text{convB},\\text{errA},\\text{errB},\\text{resA},\\text{resB}]$.\nThus the final output must be a list of five such lists, one per test case, e.g., $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$.\n\nAnswer all physical quantities in the specified units: moduli and stresses in $\\mathrm{Pa}$, strains dimensionless. Angles are not involved. All boolean values must be Python booleans. All floating-point and integer outputs must be raw numerical values, not rounded or formatted with units.",
            "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded problem in computational plasticity, with all necessary data and conditions provided for a unique solution.\n\n### 1. Fundamental Constitutive Relations\nThe problem describes a one-dimensional, rate-independent elastoplastic material with linear isotropic hardening under monotonic tensile loading from an initial unstressed state. The governing relations are as follows:\n\n- **Strain Decomposition**: The total strain $\\varepsilon$ is the sum of the elastic strain $\\varepsilon^e$ and plastic strain $\\varepsilon^p$.\n  $$ \\varepsilon = \\varepsilon^e + \\varepsilon^p $$\n- **Elastic Law**: The stress $\\sigma$ is related to the elastic strain by Hooke's law, with elastic modulus $E$.\n  $$ \\sigma = E \\varepsilon^e $$\n- **Yield Condition**: Plastic flow initiates when the stress reaches the current yield strength $\\sigma_y$. For monotonic tension ($\\sigma \\ge 0$), the yield function $f$ is:\n  $$ f(\\sigma, \\alpha) = \\sigma - \\sigma_y(\\alpha) \\le 0 $$\n- **Linear Isotropic Hardening**: The yield strength $\\sigma_y$ evolves linearly with the equivalent plastic strain $\\alpha$, starting from an initial yield stress $\\sigma_{y0}$ with a plastic modulus $H$.\n  $$ \\sigma_y(\\alpha) = \\sigma_{y0} + H\\alpha $$\n- **Flow Rule and Plastic Strain**: For this 1D tension case, the associative flow rule simplifies such that the rate of plastic strain equals the rate of the plastic multiplier, $\\dot{\\varepsilon}^p = \\dot{\\gamma}$. Furthermore, the equivalent plastic strain rate is $\\dot{\\alpha} = |\\dot{\\varepsilon}^p| = \\dot{\\varepsilon}^p$ (since $\\dot{\\varepsilon}^p \\ge 0$). Integrating over time from a virgin state, we find that the accumulated plastic strain is equal to the equivalent plastic strain, $\\varepsilon^p = \\alpha$.\n  The yield condition can thus be written in terms of $\\varepsilon^p$:\n  $$ f = \\sigma - (\\sigma_{y0} + H\\varepsilon^p) \\le 0 $$\n\n### 2. Derivation of the Stress-Strain Relation $\\sigma(\\varepsilon)$\nFor a given total strain $\\varepsilon$ under monotonic tensile loading from $\\varepsilon=0$, we can determine the stress $\\sigma$. The initial yield strain is $\\varepsilon_y = \\sigma_{y0}/E$.\n\n- **Elastic Regime** ($\\varepsilon \\le \\varepsilon_y$): No plastic deformation occurs ($\\varepsilon^p=0$). The total strain is purely elastic, $\\varepsilon = \\varepsilon^e$.\n  $$ \\sigma(\\varepsilon) = E\\varepsilon $$\n- **Plastic Regime** ($\\varepsilon  \\varepsilon_y$): The material yields. The state must satisfy the yield condition, $\\sigma = \\sigma_y = \\sigma_{y0} + H\\varepsilon^p$. We also have $\\sigma = E\\varepsilon^e = E(\\varepsilon-\\varepsilon^p)$. Equating the two expressions for $\\sigma$:\n  $$ E(\\varepsilon - \\varepsilon^p) = \\sigma_{y0} + H\\varepsilon^p $$\n  Solving for the plastic strain $\\varepsilon^p$:\n  $$ E\\varepsilon - \\sigma_{y0} = (E+H)\\varepsilon^p \\implies \\varepsilon^p = \\frac{E\\varepsilon - \\sigma_{y0}}{E+H} $$\n  Substituting this back into the elastic law to find $\\sigma$ in terms of $\\varepsilon$:\n  $$ \\sigma(\\varepsilon) = E(\\varepsilon - \\varepsilon^p) = E\\left(\\varepsilon - \\frac{E\\varepsilon - \\sigma_{y0}}{E+H}\\right) = \\frac{E(E+H)\\varepsilon - E(E\\varepsilon - \\sigma_{y0})}{E+H} = \\frac{EH\\varepsilon + E\\sigma_{y0}}{E+H} $$\nThe complete, continuous, and piecewise-differentiable stress-strain relation $\\sigma(\\varepsilon)$ for monotonic tension is:\n$$\n\\sigma(\\varepsilon) = \\begin{cases}\n    E\\varepsilon  \\text{if } \\varepsilon \\le \\sigma_{y0}/E \\\\\n    \\frac{EH\\varepsilon + E\\sigma_{y0}}{E+H}  \\text{if } \\varepsilon  \\sigma_{y0}/E\n\\end{cases}\n$$\n\n### 3. Derivation of the Algorithmic (Consistent) Tangent Modulus $D^{ep}$\nThe problem requires solving the nonlinear equilibrium equation $R(\\varepsilon) = \\sigma(\\varepsilon) - T = 0$ using Newton's method. The Jacobian of this equation is $R'(\\varepsilon) = d\\sigma/d\\varepsilon$. For quadratic convergence, this Jacobian must be the *consistent tangent modulus*, which is the exact derivative of the stress update algorithm. For this 1D rate-independent case, this corresponds to the derivative of the $\\sigma(\\varepsilon)$ function derived above.\n\n- **Elastic Tangent**: In the elastic regime ($\\varepsilon \\le \\sigma_{y0}/E$):\n  $$ D^e = \\frac{d}{d\\varepsilon}(E\\varepsilon) = E $$\n- **Elastoplastic Tangent**: In the plastic regime ($\\varepsilon  \\sigma_{y0}/E$):\n  $$ D^{ep} = \\frac{d}{d\\varepsilon}\\left(\\frac{EH\\varepsilon + E\\sigma_{y0}}{E+H}\\right) = \\frac{EH}{E+H} $$\nThis $D^{ep}$ is the algorithmic tangent modulus for plastic loading.\n\n### 4. Newton's Method and Solver Implementation\nThe Newton-Raphson iteration to find $\\varepsilon$ such that $R(\\varepsilon)=0$ is:\n$$ \\varepsilon_{k+1} = \\varepsilon_{k} - \\frac{R(\\varepsilon_k)}{J_k} $$\nwhere $\\varepsilon_k$ is the strain at iteration $k$, $R(\\varepsilon_k) = \\sigma(\\varepsilon_k) - T$ is the residual, and $J_k$ is the Jacobian.\n\n- **Solver A (Consistent Tangent)**: Uses the true Jacobian, leading to quadratic convergence.\n  $$ J_k = \\frac{d\\sigma}{d\\varepsilon}\\bigg|_{\\varepsilon_k} = \\begin{cases} E  \\text{if } \\varepsilon_k \\le \\sigma_{y0}/E \\\\ \\frac{EH}{E+H}  \\text{if } \\varepsilon_k  \\sigma_{y0}/E \\end{cases} $$\n- **Solver B (Elastic Tangent)**: Uses the elastic modulus $E$ as the Jacobian for all iterations.\n  $$ J_k = E $$\n  When the material is plastic, this Jacobian is incorrect, and the convergence rate degrades to linear. The performance difference between Solver A and B is most pronounced when the consistent tangent $D^{ep}$ is significantly different from the elastic tangent $E$, which occurs for low values of the plastic modulus $H$.\n\n### 5. Exact Analytical Solution $\\varepsilon_{\\text{exact}}$\nTo calculate the numerical error, we derive the exact solution $\\varepsilon_{\\text{exact}}$ that satisfies $\\sigma(\\varepsilon_{\\text{exact}}) = T$.\n\n- **If $T \\le \\sigma_{y0}$ (Elastic)**:\n  $$ E\\varepsilon_{\\text{exact}} = T \\implies \\varepsilon_{\\text{exact}} = \\frac{T}{E} $$\n- **If $T  \\sigma_{y0}$ (Plastic)**:\n  $$ \\frac{EH\\varepsilon_{\\text{exact}} + E\\sigma_{y0}}{E+H} = T \\implies EH\\varepsilon_{\\text{exact}} = T(E+H) - E\\sigma_{y0} $$\n  $$ \\varepsilon_{\\text{exact}} = \\frac{T(E+H) - E\\sigma_{y0}}{EH} = \\frac{T}{H} + \\frac{T}{E} - \\frac{\\sigma_{y0}}{H} $$\n  Alternatively, using the strain decomposition $\\varepsilon = \\varepsilon^e + \\varepsilon^p$:\n  $$ \\varepsilon^e = \\sigma/E = T/E $$\n  $$ \\sigma = T = \\sigma_{y0} + H\\varepsilon^p \\implies \\varepsilon^p = \\frac{T-\\sigma_{y0}}{H} $$\n  $$ \\varepsilon_{\\text{exact}} = \\varepsilon^e + \\varepsilon^p = \\frac{T}{E} + \\frac{T-\\sigma_{y0}}{H} $$\n  These two forms for the plastic case are identical. This analytical solution provides the benchmark against which the numerical results are compared.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the strain in a 1D elastoplastic material under a given traction,\n    comparing a Newton solver using the consistent tangent modulus with one\n    using only the elastic modulus as the Jacobian.\n    \"\"\"\n    \n    # Define the test suite as specified in the problem statement.\n    # Each case is a tuple: (E, sigma_y0, H, T) in Pa.\n    test_cases = [\n        (200e9, 400e6, 10e9, 300e6),    # Case 1: Elastic\n        (200e9, 400e6, 10e9, 400e6),    # Case 2: At yield boundary\n        (200e9, 400e6, 10e9, 800e6),    # Case 3: Plastic, moderate hardening\n        (200e9, 400e6, 0.5e9, 800e6),   # Case 4: Plastic, weak hardening\n        (200e9, 400e6, 100e9, 1200e6),  # Case 5: Plastic, strong hardening\n    ]\n\n    results = []\n\n    for E, sigma_y0, H, T in test_cases:\n        \n        # 1. Calculate the exact analytical solution for strain.\n        if T = sigma_y0:\n            # Elastic case\n            epsilon_exact = T / E\n        else:\n            # Plastic case: epsilon = elastic_strain + plastic_strain\n            # elastic_strain = T / E\n            # plastic_strain = (T - sigma_y0) / H\n            epsilon_exact = T / E + (T - sigma_y0) / H\n\n        # 2. Define the Newton solver.\n        def newton_solver(use_consistent_tangent):\n            \"\"\"\n            Performs Newton-Raphson iterations to solve R(e) = sigma(e) - T = 0.\n            \n            Args:\n                use_consistent_tangent (bool): If True, uses the algorithmic tangent\n                                               modulus (Solver A). If False, uses the\n                                               elastic modulus (Solver B).\n            Returns:\n                A tuple containing the final strain, number of iterations,\n                convergence status, and final residual.\n            \"\"\"\n            epsilon = 0.0\n            max_iter = 1000\n            tolerance = 1.0  # Pa, as specified\n            \n            def get_stress_and_tangent(current_epsilon):\n                \"\"\"\n                Computes stress and consistent tangent for a given total strain,\n                assuming monotonic loading from a virgin state.\n                \"\"\"\n                epsilon_yield = sigma_y0 / E\n                \n                # Check if the state is elastic or plastic\n                if current_epsilon = epsilon_yield:\n                    sigma = E * current_epsilon\n                    tangent = E\n                else:\n                    sigma = (E * H * current_epsilon + E * sigma_y0) / (E + H)\n                    tangent = (E * H) / (E + H)\n                return sigma, tangent\n\n            for i in range(max_iter):\n                sigma, tangent_consistent = get_stress_and_tangent(epsilon)\n                residual = sigma - T\n                \n                if abs(residual) = tolerance:\n                    return epsilon, i + 1, True, abs(residual)\n                \n                jacobian = tangent_consistent if use_consistent_tangent else E\n                \n                # Prevent division by zero, although not expected in these test cases\n                if abs(jacobian)  1e-12:\n                    break\n                    \n                delta_epsilon = -residual / jacobian\n                epsilon += delta_epsilon\n            \n            # If the loop completes without converging\n            final_sigma, _ = get_stress_and_tangent(epsilon)\n            final_residual = abs(final_sigma - T)\n            return epsilon, max_iter, False, final_residual\n\n        # 3. Run both solvers and collect metrics.\n        \n        # Solver A (Consistent Tangent)\n        eps_A, iters_A, conv_A, res_A = newton_solver(use_consistent_tangent=True)\n        err_A = abs(eps_A - epsilon_exact)\n\n        # Solver B (Elastic Tangent)\n        eps_B, iters_B, conv_B, res_B = newton_solver(use_consistent_tangent=False)\n        err_B = abs(eps_B - epsilon_exact)\n\n        # 4. Store the results for the current test case.\n        case_result = [iters_A, iters_B, conv_A, conv_B, err_A, err_B, res_A, res_B]\n        results.append(case_result)\n\n    # 5. Format and print the final output string.\n    # Using repr() to get an unambiguous string representation of the list of lists,\n    # then removing spaces to create a compact output as per the problem's implicit format.\n    final_output_str = repr(results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Having established the practical necessity of the consistent tangent, we now move to its formal derivation in a three-dimensional context. This practice focuses on deriving the tangent modulus for the foundational von Mises ($J_2$) plasticity model, which is a cornerstone of metal plasticity and a common starting point for many geomechanical models. You will translate the fourth-order tensor representation into the Voigt matrix form used in finite element codes, ensuring energy consistency, a critical step for correct implementation .",
            "id": "3522229",
            "problem": "A small-strain, isotropic, associative von Mises (Second deviatoric invariant, $J_{2}$) elastoplastic material with linear isotropic hardening is used in a Finite Element (FE) implementation. The elastic response is defined by the bulk modulus $K$ and shear modulus $G$, such that for any symmetric strain tensor $\\boldsymbol{\\varepsilon}$ the elastic stress is $\\boldsymbol{\\sigma}^{e} = \\boldsymbol{D}^{e} : \\boldsymbol{\\varepsilon}$, where the fourth-order elastic stiffness is $\\boldsymbol{D}^{e} = K\\,\\mathbf{I} \\otimes \\mathbf{I} + 2 G\\,\\boldsymbol{I}^{s}$. Here $\\mathbf{I}$ is the second-order identity tensor, and $\\boldsymbol{I}^{s}$ is the symmetric fourth-order identity. The yield function is $f(\\boldsymbol{\\sigma},\\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y0} - H \\alpha$, where $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$, $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\mathbf{I}$ is the deviatoric stress, $\\sigma_{y0}$ is the initial yield stress, $H$ is the plastic modulus, and $\\alpha$ is the accumulated plastic strain. The flow rule is associative, $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$, and the hardening law is $\\dot{\\alpha} = \\dot{\\lambda}$.\n\nAt a converged material point in a Newton iteration, assume a plastic state ($\\dot{\\lambda} \\ge 0$) and denote the unit deviatoric direction by $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$ and the plastic flow direction by $\\boldsymbol{m} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}}\\,\\boldsymbol{n}$. The continuum elastoplastic tangent modulus (fourth-order tensor) is defined as the derivative of the stress rate with respect to the strain rate, consistent with the chosen material rate, such that the internal power is preserved, i.e., $\\dot{W} = \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}$.\n\nYour task is to express the tangent modulus in the six-component Voigt form suitable for FE implementation, using the engineering shear convention for the strain-like vector and ensuring energy consistency with the chosen material time rate. Specifically:\n\n1. Define the energy-consistent Voigt mappings for the strain and stress:\n   $$\\boldsymbol{\\varepsilon}^{V} = \\begin{pmatrix}\\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ 2\\,\\varepsilon_{23} \\\\ 2\\,\\varepsilon_{13} \\\\ 2\\,\\varepsilon_{12}\\end{pmatrix}, \\qquad \\boldsymbol{\\sigma}^{V} = \\begin{pmatrix}\\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{13} \\\\ \\sigma_{12}\\end{pmatrix},$$\n   and verify that $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}} = (\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\varepsilon}}^{V}$.\n\n2. Starting from the small-strain kinematics, isotropic elasticity, the associative flow rule, and the return-mapping structure for the $J_{2}$ model, derive the fourth-order continuum elastoplastic tangent modulus in the plastic state and show that it can be written as\n   $$\\boldsymbol{D}^{ep} = \\boldsymbol{D}^{e} - \\frac{3 G}{H + 3 G}\\, (2G \\boldsymbol{m}) \\otimes \\boldsymbol{m},$$\n   with $\\boldsymbol{m} = \\sqrt{\\frac{3}{2}}\\,\\boldsymbol{n}$.\n\n3. Using the energy-consistent mapping and the engineering shear convention, provide the $6 \\times 6$ Voigt matrix $\\boldsymbol{D}^{ep V}$ such that $\\dot{\\boldsymbol{\\sigma}}^{V} = \\boldsymbol{D}^{ep V}\\,\\dot{\\boldsymbol{\\varepsilon}}^{V}$. Express the result in closed form as the sum of the elastic Voigt matrix and a rank-one correction constructed from the stress-like Voigt mapping of $\\boldsymbol{m}$,\n   $$\\boldsymbol{m}_{\\sigma}^{V} = \\begin{pmatrix}m_{11} \\\\ m_{22} \\\\ m_{33} \\\\ m_{23} \\\\ m_{13} \\\\ m_{12}\\end{pmatrix},$$\n   and ensure that the mapping preserves the internal power $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}} = (\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\varepsilon}}^{V}$.\n\nExpress your final answer as a single closed-form analytic expression for $\\boldsymbol{D}^{ep V}$ in terms of $K$, $G$, $H$, and the components $m_{ij}$. No numerical evaluation is required.",
            "solution": "The problem is valid as it represents a standard and well-posed derivation in the field of computational plasticity. It is scientifically grounded, objective, and contains all necessary information to derive the requested continuum tangent modulus for a $J_2$-plasticity model.\n\nThe derivation will proceed in three stages: first, verification of the energy consistency of the specified Voigt mappings; second, derivation of the fourth-order continuum tangent tensor $\\boldsymbol{D}^{ep}$; and third, conversion of this tensor into its $6 \\times 6$ Voigt matrix representation $\\boldsymbol{D}^{ep V}$.\n\n**1. Verification of Energy-Consistent Voigt Mappings**\n\nThe internal power, representing the rate of work done by stresses on strain rates, is given by the double dot product $\\dot{W} = \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}$. For symmetric stress $\\boldsymbol{\\sigma}$ and strain rate $\\dot{\\boldsymbol{\\varepsilon}}$ tensors, this expands to:\n$$\n\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\sigma_{ij} \\dot{\\varepsilon}_{ij} = \\sigma_{11}\\dot{\\varepsilon}_{11} + \\sigma_{22}\\dot{\\varepsilon}_{22} + \\sigma_{33}\\dot{\\varepsilon}_{33} + 2\\sigma_{12}\\dot{\\varepsilon}_{12} + 2\\sigma_{13}\\dot{\\varepsilon}_{13} + 2\\sigma_{23}\\dot{\\varepsilon}_{23}\n$$\nThe problem defines the stress-like and strain-like Voigt vectors as:\n$$\n\\boldsymbol{\\sigma}^{V} = \\begin{pmatrix}\\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{13} \\\\ \\sigma_{12}\\end{pmatrix}, \\qquad \\dot{\\boldsymbol{\\varepsilon}}^{V} = \\begin{pmatrix}\\dot{\\varepsilon}_{11} \\\\ \\dot{\\varepsilon}_{22} \\\\ \\dot{\\varepsilon}_{33} \\\\ 2\\dot{\\varepsilon}_{23} \\\\ 2\\dot{\\varepsilon}_{13} \\\\ 2\\dot{\\varepsilon}_{12}\\end{pmatrix}\n$$\nThe dot product of their transposes is:\n$$\n(\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\varepsilon}}^{V} = \\begin{pmatrix}\\sigma_{11}  \\sigma_{22}  \\sigma_{33}  \\sigma_{23}  \\sigma_{13}  \\sigma_{12}\\end{pmatrix} \\begin{pmatrix}\\dot{\\varepsilon}_{11} \\\\ \\dot{\\varepsilon}_{22} \\\\ \\dot{\\varepsilon}_{33} \\\\ 2\\dot{\\varepsilon}_{23} \\\\ 2\\dot{\\varepsilon}_{13} \\\\ 2\\dot{\\varepsilon}_{12}\\end{pmatrix}\n$$\n$$\n(\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\varepsilon}}^{V} = \\sigma_{11}\\dot{\\varepsilon}_{11} + \\sigma_{22}\\dot{\\varepsilon}_{22} + \\sigma_{33}\\dot{\\varepsilon}_{33} + \\sigma_{23}(2\\dot{\\varepsilon}_{23}) + \\sigma_{13}(2\\dot{\\varepsilon}_{13}) + \\sigma_{12}(2\\dot{\\varepsilon}_{12})\n$$\nThis expression is identical to the tensor-based internal power. Thus, the condition $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}} = (\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\varepsilon}}^{V}$ is verified, confirming the energy consistency of the chosen mappings. This is crucial for correctly transforming constitutive tensors into matrix form.\n\n**2. Derivation of the Fourth-Order Continuum Tangent Tensor**\n\nThe continuum tangent modulus is derived from the rate form of the constitutive equations. The stress rate is $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{D}^e : \\dot{\\boldsymbol{\\varepsilon}}^e = \\boldsymbol{D}^e : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^p)$.\nThe plastic strain rate is given by the associative flow rule: $\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda}\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}} = \\dot{\\lambda}\\boldsymbol{m}$.\nThe consistency condition $\\dot{f}=0$ is used to find $\\dot{\\lambda}$:\n$$ \\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}:\\dot{\\boldsymbol{\\sigma}} + \\frac{\\partial f}{\\partial \\alpha}\\dot{\\alpha} = 0 $$\nGiven $f = \\sigma_{\\mathrm{eq}} - \\sigma_{y0} - H\\alpha$, we have $\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}} = \\boldsymbol{m}$ and $\\frac{\\partial f}{\\partial\\alpha} = -H$. With the hardening law $\\dot{\\alpha}=\\dot{\\lambda}$, the consistency condition becomes $\\boldsymbol{m}:\\dot{\\boldsymbol{\\sigma}} - H\\dot{\\lambda} = 0$.\nSubstituting the stress rate:\n$$ \\boldsymbol{m}:[\\boldsymbol{D}^e : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{m})] - H\\dot{\\lambda} = 0 $$\n$$ \\boldsymbol{m}:\\boldsymbol{D}^e:\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}(\\boldsymbol{m}:\\boldsymbol{D}^e:\\boldsymbol{m} + H) = 0 $$\nSolving for the plastic multiplier rate $\\dot{\\lambda}$:\n$$ \\dot{\\lambda} = \\frac{\\boldsymbol{m}:\\boldsymbol{D}^e:\\dot{\\boldsymbol{\\varepsilon}}}{\\boldsymbol{m}:\\boldsymbol{D}^e:\\boldsymbol{m} + H} $$\nThe tensor $\\boldsymbol{m} = \\sqrt{3/2}\\boldsymbol{n}$ is deviatoric ($\\mathrm{tr}(\\boldsymbol{m})=0$). The elastic stiffness tensor is $\\boldsymbol{D}^e = K \\mathbf{I} \\otimes \\mathbf{I} + 2G \\boldsymbol{I}^{\\text{dev}}$, where $\\boldsymbol{I}^{\\text{dev}}$ is the fourth-order deviatoric projector.\nThe term $\\boldsymbol{m}:\\boldsymbol{D}^e:\\boldsymbol{m}$ simplifies:\n$\\boldsymbol{m}:\\boldsymbol{D}^e:\\boldsymbol{m} = \\boldsymbol{m} : (K(\\mathbf{I}:\\boldsymbol{m})\\otimes\\mathbf{I} + 2G\\boldsymbol{m}) = \\boldsymbol{m}:(2G\\boldsymbol{m}) = 2G(\\boldsymbol{m}:\\boldsymbol{m})$.\nSince $\\boldsymbol{m} = \\sqrt{3/2}\\boldsymbol{n}$ and $\\boldsymbol{n}$ is a unit tensor, $\\boldsymbol{m}:\\boldsymbol{m} = (3/2)(\\boldsymbol{n}:\\boldsymbol{n}) = 3/2$.\nSo, $\\boldsymbol{m}:\\boldsymbol{D}^e:\\boldsymbol{m} = 2G(3/2) = 3G$.\nThe denominator becomes $3G+H$.\nThe numerator is $\\boldsymbol{m}:\\boldsymbol{D}^e:\\dot{\\boldsymbol{\\varepsilon}} = \\boldsymbol{m}:(2G\\,\\mathrm{dev}(\\dot{\\boldsymbol{\\varepsilon}})) = 2G(\\boldsymbol{m}:\\dot{\\boldsymbol{\\varepsilon}})$.\nSubstituting $\\dot{\\lambda}$ back into the stress rate equation:\n$$ \\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{D}^e : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}(\\boldsymbol{D}^e:\\boldsymbol{m}) = \\boldsymbol{D}^e : \\dot{\\boldsymbol{\\varepsilon}} - \\frac{(\\boldsymbol{D}^e:\\boldsymbol{m}) \\otimes (\\boldsymbol{m}:\\boldsymbol{D}^e)}{\\boldsymbol{m}:\\boldsymbol{D}^e:\\boldsymbol{m} + H} : \\dot{\\boldsymbol{\\varepsilon}} $$\nThe continuum tangent is therefore:\n$$ \\boldsymbol{D}^{ep} = \\boldsymbol{D}^e - \\frac{(\\boldsymbol{D}^e:\\boldsymbol{m}) \\otimes (\\boldsymbol{m}:\\boldsymbol{D}^e)}{H+3G} $$\nSince $\\boldsymbol{m}$ is deviatoric, $\\boldsymbol{D}^e:\\boldsymbol{m} = 2G\\boldsymbol{m}$ and $\\boldsymbol{m}:\\boldsymbol{D}^e = 2G\\boldsymbol{m}$.\n$$ \\boldsymbol{D}^{ep} = \\boldsymbol{D}^e - \\frac{(2G\\boldsymbol{m}) \\otimes (2G\\boldsymbol{m})}{H+3G} = \\boldsymbol{D}^e - \\frac{4G^2}{H+3G} \\boldsymbol{m} \\otimes \\boldsymbol{m} $$\nThis can also be written as $\\boldsymbol{D}^{ep} = \\boldsymbol{D}^e - \\frac{3G}{H+3G}(2G\\boldsymbol{m})\\otimes\\boldsymbol{m}$ if one factors out one $2G$ term from the numerator. The expression in the problem statement is slightly unconventional but mathematically equivalent.\n\n**3. Voigt Matrix Representation**\n\nWe now convert the fourth-order tensor $\\boldsymbol{D}^{ep}$ to its $6 \\times 6$ matrix form $\\boldsymbol{D}^{ep V}$. The constitutive law in Voigt notation is $\\dot{\\boldsymbol{\\sigma}}^{V} = \\boldsymbol{D}^{ep V} \\dot{\\boldsymbol{\\varepsilon}}^{V}$.\nThe elastic part $\\boldsymbol{D}^e$ maps to the standard isotropic elastic matrix $\\boldsymbol{D}_{e}^{V}$. With $\\lambda = K-\\frac{2}{3}G$, it is:\n$$\n\\boldsymbol{D}_{e}^{V} =\n\\begin{pmatrix}\nK+\\frac{4}{3}G  K-\\frac{2}{3}G  K-\\frac{2}{3}G  0  0  0 \\\\\nK-\\frac{2}{3}G  K+\\frac{4}{3}G  K-\\frac{2}{3}G  0  0  0 \\\\\nK-\\frac{2}{3}G  K-\\frac{2}{3}G  K+\\frac{4}{3}G  0  0  0 \\\\\n0  0  0  G  0  0 \\\\\n0  0  0  0  G  0 \\\\\n0  0  0  0  0  G\n\\end{pmatrix}\n$$\nThe plastic correction term is a rank-one tensor product $\\boldsymbol{m}\\otimes\\boldsymbol{m}$. For a fourth-order tensor of the form $\\boldsymbol{D} = \\boldsymbol{a} \\otimes \\boldsymbol{b}$, where $\\boldsymbol{a}$ and $\\boldsymbol{b}$ are symmetric second-order tensors, the action on a strain tensor $\\boldsymbol{\\varepsilon}$ is $\\boldsymbol{\\sigma} = \\boldsymbol{D}:\\boldsymbol{\\varepsilon} = (\\boldsymbol{b}:\\boldsymbol{\\varepsilon})\\boldsymbol{a}$.\nUsing the energy-consistent Voigt map, the scalar product becomes $\\boldsymbol{b}:\\boldsymbol{\\varepsilon} = (\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}\\boldsymbol{\\varepsilon}^{V}$, where $\\boldsymbol{b}_{\\sigma}^{V}$ is the stress-like vector form of $\\boldsymbol{b}$.\nThe resulting stress is $\\boldsymbol{\\sigma} = [(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}\\boldsymbol{\\varepsilon}^{V}]\\boldsymbol{a}$. Converting $\\boldsymbol{\\sigma}$ to its stress-like Voigt vector $\\boldsymbol{\\sigma}^V$ gives $\\boldsymbol{\\sigma}^{V} = [(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}\\boldsymbol{\\varepsilon}^{V}]\\boldsymbol{a}_{\\sigma}^{V}$.\nRearranging this into matrix-vector form: $\\boldsymbol{\\sigma}^{V} = (\\boldsymbol{a}_{\\sigma}^{V}(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}})\\boldsymbol{\\varepsilon}^{V}$. Therefore, the Voigt matrix for $\\boldsymbol{a}\\otimes\\boldsymbol{b}$ is the outer product $\\boldsymbol{a}_{\\sigma}^{V}(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}$.\n\nFor the plastic correction term, $\\boldsymbol{a}=\\boldsymbol{b}=\\boldsymbol{m}$. The corresponding Voigt matrix is $\\boldsymbol{m}_{\\sigma}^{V}(\\boldsymbol{m}_{\\sigma}^{V})^{\\mathsf{T}}$.\nThe vector $\\boldsymbol{m}_{\\sigma}^{V}$ is given as $\\boldsymbol{m}_{\\sigma}^{V} = (m_{11}, m_{22}, m_{33}, m_{23}, m_{13}, m_{12})^{\\mathsf{T}}$.\nThe complete Voigt representation of the continuum tangent is:\n$\\boldsymbol{D}^{ep V} = \\boldsymbol{D}_{e}^{V} - \\frac{4G^2}{H+3G} \\boldsymbol{m}_{\\sigma}^{V}(\\boldsymbol{m}_{\\sigma}^{V})^{\\mathsf{T}}$.\nThis is the required closed-form expression. Expanding this gives the full $6 \\times 6$ matrix. Let $\\gamma' = \\frac{4G^2}{H+3G}$. The matrix $(\\boldsymbol{m}_{\\sigma}^{V}(\\boldsymbol{m}_{\\sigma}^{V})^{\\mathsf{T}})_{IJ} = m_I m_J$, where $m_I$ are the components of $\\boldsymbol{m}_{\\sigma}^{V}$. The final matrix is the sum of the elastic matrix and the negative of this rank-one correction matrix scaled by $\\gamma'$.",
            "answer": "$$\n\\boxed{\n\\boldsymbol{D}^{ep V} =\n\\begin{pmatrix}\nK+\\frac{4}{3}G  K-\\frac{2}{3}G  K-\\frac{2}{3}G  0  0  0 \\\\\nK-\\frac{2}{3}G  K+\\frac{4}{3}G  K-\\frac{2}{3}G  0  0  0 \\\\\nK-\\frac{2}{3}G  K-\\frac{2}{3}G  K+\\frac{4}{3}G  0  0  0 \\\\\n0  0  0  G  0  0 \\\\\n0  0  0  0  G  0 \\\\\n0  0  0  0  0  G\n\\end{pmatrix}\n- \\frac{4G^2}{H+3G}\n\\begin{pmatrix}\nm_{11}^2  m_{11}m_{22}  m_{11}m_{33}  m_{11}m_{23}  m_{11}m_{13}  m_{11}m_{12} \\\\\nm_{22}m_{11}  m_{22}^2  m_{22}m_{33}  m_{22}m_{23}  m_{22}m_{13}  m_{22}m_{12} \\\\\nm_{33}m_{11}  m_{33}m_{22}  m_{33}^2  m_{33}m_{23}  m_{33}m_{13}  m_{33}m_{12} \\\\\nm_{23}m_{11}  m_{23}m_{22}  m_{23}m_{33}  m_{23}^2  m_{23}m_{13}  m_{23}m_{12} \\\\\nm_{13}m_{11}  m_{13}m_{22}  m_{13}m_{33}  m_{13}m_{23}  m_{13}^2  m_{13}m_{12} \\\\\nm_{12}m_{11}  m_{12}m_{22}  m_{12}m_{33}  m_{12}m_{23}  m_{12}m_{13}  m_{12}^2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice serves as a capstone, bridging the gap between analytical derivation and robust numerical implementation. After deriving the tangent modulus, a crucial step in any code development cycle is verification, ensuring the algorithm performs as theoretically expected. This exercise requires you to build a numerical test to check that the implemented tangent correctly predicts incremental energy dissipation, confirming that it does not spuriously create or destroy plastic work and thus maintains algorithmic consistency .",
            "id": "3522268",
            "problem": "Consider small-strain, rate-independent, isotropic, associated elastoplasticity with a von Mises (also known as $J_2$) yield condition and linear isotropic hardening, as used in computational geomechanics. The fundamental base consists of the additive strain decomposition, the elastic law for isotropic linear elasticity, the von Mises yield function, and the associated flow rule:\n- Additive strain decomposition: $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$.\n- Isotropic linear elasticity: $\\boldsymbol{\\sigma} = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}^e)\\,\\mathbf{I} + 2\\mu\\,\\mathrm{dev}(\\boldsymbol{\\varepsilon}^e)$, where $\\lambda$ and $\\mu$ are the Lamé parameters, $\\mathrm{tr}(\\cdot)$ denotes the trace, $\\mathbf{I}$ is the identity tensor, and $\\mathrm{dev}(\\cdot)$ extracts the deviatoric part.\n- von Mises yield function with linear isotropic hardening: $f = \\sigma_{\\mathrm{eq}} - \\left(\\sigma_{y0} + H\\,\\alpha\\right)$, where $\\sigma_{\\mathrm{eq}} = \\sqrt{3/2}\\|\\mathbf{s}\\|$ is the equivalent stress, $\\mathbf{s} = \\mathrm{dev}(\\boldsymbol{\\sigma})$ is the deviatoric stress, $\\sigma_{y0}$ is the initial yield stress, $H$ is the hardening modulus, and $\\alpha$ is the accumulated plastic strain.\n- Associated flow rule: $\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\gamma}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ with $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{3/2} \\frac{\\mathbf{s}}{\\|\\mathbf{s}\\|}$, and consistency enforced when plastic loading is active. The hardening law is $\\dot{\\alpha} = \\dot{\\gamma}$.\n\nThe incremental plastic work over a load step from time $t_n$ to $t_{n+1}$ with strain increment $\\Delta\\boldsymbol{\\varepsilon}$ is defined as $W_p^{\\mathrm{inc}} = \\boldsymbol{\\sigma}_{n+1} : \\Delta\\boldsymbol{\\varepsilon}^p$, expressed in megapascals (MPa), where the colon denotes the double contraction and $\\Delta\\boldsymbol{\\varepsilon}^p$ is the plastic strain increment tensor. The algorithmic consistent elastoplastic tangent modulus $\\mathbf{D}^{ep}$ is the derivative of the stress update mapping with respect to the strain increment, evaluated at the state of interest.\n\nYour task is to write a program that:\n1. Implements an incremental return mapping algorithm for the specified model, starting from the fundamental base listed above (do not use any pre-derived shortcut formulas beyond those derivable from the base).\n2. Numerically constructs the algorithmic consistent tangent modulus $\\mathbf{D}^{ep}$ at a given state by finite differencing the exact stress update algorithm with respect to the strain increment in Voigt notation. Use the Voigt ordering $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}, \\gamma_{xz}, \\gamma_{xy}]$, where $\\gamma_{ij}$ are the engineering shear strains and stresses are ordered as $[\\sigma_{xx}, \\sigma_{yy}, \\sigma_{zz}, \\tau_{yz}, \\tau_{xz}, \\tau_{xy}]$.\n3. Uses $\\mathbf{D}^{ep}$ to compute a linearized prediction of the plastic strain increment for a given step via the relation $\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{lin}} = \\Delta\\boldsymbol{\\varepsilon} - \\mathbf{C}^e:\\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}}$, where $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}} = \\mathbf{D}^{ep} : \\Delta\\boldsymbol{\\varepsilon}$ and $\\mathbf{C}^e$ is the elastic compliance tensor.\n4. Evaluates the incremental plastic work in two ways:\n   - Exact incremental plastic work: $W_p^{\\mathrm{inc,exact}} = \\boldsymbol{\\sigma}_{n+1} : \\Delta\\boldsymbol{\\varepsilon}^p$, computed from the return-mapped stress and the exact plastic strain increment.\n   - Linearized incremental plastic work using the tangent: $W_p^{\\mathrm{inc,lin}} = \\boldsymbol{\\sigma}_{n} : \\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{lin}}$, computed from the pre-step stress and the linearized plastic strain increment derived using $\\mathbf{D}^{ep}$ and $\\mathbf{C}^e$.\n\nVerify algorithmic consistency through incremental energy dissipation by checking that:\n- The linearized plastic work is non-negative $W_p^{\\mathrm{inc,lin}} \\ge 0$ (no spurious creation of plastic work with linearization).\n- The linearized plastic work matches the exact plastic work to first order, i.e., $\\left|W_p^{\\mathrm{inc,lin}} - W_p^{\\mathrm{inc,exact}}\\right| \\le \\varepsilon \\,\\max\\left(1, \\left|W_p^{\\mathrm{inc,exact}}\\right|\\right)$ for a chosen tolerance $\\varepsilon$.\n\nMaterial parameters to use in all cases are:\n- Young’s modulus $E = 10000$ MPa, Poisson’s ratio $\\nu = 0.3$.\n- Initial yield stress $\\sigma_{y0} = 50$ MPa, hardening modulus $H = 1000$ MPa.\n\nExpress all plastic work values internally in megapascals (MPa). Angles do not appear in this problem. Strain is dimensionless.\n\nConstruct a test suite of five sequential incremental steps, applied cumulatively to the same material point starting from zero stress and zero plastic strain:\n- Step 1 (pure volumetric, elastic): $\\Delta\\boldsymbol{\\varepsilon} = [1\\times 10^{-5},\\,1\\times 10^{-5},\\,1\\times 10^{-5},\\,0,\\,0,\\,0]$.\n- Step 2 (pure shear, plastic): $\\Delta\\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,0,\\,0,\\,0.01]$.\n- Step 3 (reverse shear, likely elastic due to hardening): $\\Delta\\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,-0,\\,0,\\,-0.005]$.\n- Step 4 (near-yield shear from a fresh state snapshot; for this step, reset to zero stress and zero plastic strain before applying): $\\Delta\\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,0,\\,0,\\,\\gamma_y]$ with $\\gamma_y = \\dfrac{\\sigma_{y0}}{\\sqrt{3}\\,\\mu}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$.\n- Step 5 (combined volumetric-deviatoric, plastic): $\\Delta\\boldsymbol{\\varepsilon} = [5\\times 10^{-4},\\,-2.5\\times 10^{-4},\\,-2.5\\times 10^{-4},\\,0,\\,0,\\,0.008]$.\n\nFor the five steps above, determine a boolean result for each step indicating whether both conditions hold:\n- Non-negative linearized plastic work.\n- Agreement of linearized and exact plastic work within tolerance $\\varepsilon = 5\\times 10^{-3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[true,false,true,true,false]\"). The booleans must be lowercase. The program must be fully self-contained and must not require user input.",
            "solution": "We begin with small-strain elastoplasticity. The total strain can be additively decomposed as $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$. The elastic law for isotropic linear elasticity is written as $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}^e)\\,\\mathbf{I} + 2\\mu\\,\\mathrm{dev}(\\boldsymbol{\\varepsilon}^e)$, where $\\mathrm{dev}(\\mathbf{A}) = \\mathbf{A} - \\dfrac{1}{3}\\mathrm{tr}(\\mathbf{A})\\mathbf{I}$. The shear modulus is $\\mu = \\dfrac{E}{2(1+\\nu)}$ and the bulk modulus is $K = \\dfrac{E}{3(1-2\\nu)}$. The Lamé parameter is $\\lambda = K - \\dfrac{2}{3}\\mu$.\n\nThe von Mises yield function with linear isotropic hardening is $f = \\sigma_{\\mathrm{eq}} - \\left(\\sigma_{y0} + H\\,\\alpha\\right)$, where $\\sigma_{\\mathrm{eq}} = \\sqrt{3/2}\\|\\mathbf{s}\\|$ and $\\alpha$ is the equivalent plastic strain. The associated flow rule prescribes $\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\gamma}\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$ with hardening law $\\dot{\\alpha} = \\dot{\\gamma}$.\n\nAn incremental return mapping algorithm for a strain increment $\\Delta\\boldsymbol{\\varepsilon}$ proceeds as follows. Denote the pre-step state by $(\\boldsymbol{\\sigma}_n, \\boldsymbol{\\varepsilon}^p_n, \\alpha_n)$ and the post-step state by $(\\boldsymbol{\\sigma}_{n+1}, \\boldsymbol{\\varepsilon}^p_{n+1}, \\alpha_{n+1})$. Compute the elastic predictor (trial stress increment) using the elastic stiffness without plastic strain increment:\n$$\n\\Delta\\boldsymbol{\\sigma}_{\\mathrm{trial}} = K\\,\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon})\\,\\mathbf{I} + 2\\mu\\,\\mathrm{dev}(\\Delta\\boldsymbol{\\varepsilon}),\n$$\nand form the trial stress $\\boldsymbol{\\sigma}_{\\mathrm{trial}} = \\boldsymbol{\\sigma}_n + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{trial}}$. Extract its deviatoric part $\\mathbf{s}_{\\mathrm{trial}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{trial}})$ and compute the trial equivalent stress $\\sigma_{\\mathrm{eq, trial}} = \\sqrt{3/2}\\|\\mathbf{s}_{\\mathrm{trial}}\\|$. The yield function at trial is:\n$$\nf_{\\mathrm{trial}} = \\sigma_{\\mathrm{eq, trial}} - (\\sigma_{y0} + H\\,\\alpha_n).\n$$\nIf $f_{\\mathrm{trial}} \\le 0$, the step is elastic, so $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{trial}}$, $\\Delta\\boldsymbol{\\varepsilon}^p = \\mathbf{0}$, and $\\alpha_{n+1} = \\alpha_n$. If $f_{\\mathrm{trial}}  0$, plasticity occurs and the standard radial return mapping applies. Define the unit deviatoric direction $\\mathbf{n} = \\dfrac{\\mathbf{s}_{\\mathrm{trial}}}{\\|\\mathbf{s}_{\\mathrm{trial}}\\|}$ and solve for the plastic consistency increment $\\Delta\\gamma$ by enforcing the yield condition at the end of the step:\n$$\n\\sigma_{\\mathrm{eq, n+1}} = \\sigma_{y0} + H\\,\\alpha_{n+1}.\n$$\nUnder radial return, $\\sigma_{\\mathrm{eq, n+1}} = \\sigma_{\\mathrm{eq, trial}} - 3\\mu\\Delta\\gamma$ and $\\alpha_{n+1} = \\alpha_n + \\Delta\\gamma$. Substitution yields the scalar equation\n$$\n\\sigma_{\\mathrm{eq, trial}} - 3\\mu\\Delta\\gamma = \\sigma_{y0} + H(\\alpha_n + \\Delta\\gamma),\n$$\nwhich simplifies to\n$$\n\\Delta\\gamma = \\frac{ \\sigma_{\\mathrm{eq, trial}} - (\\sigma_{y0} + H\\alpha_n)}{ 3\\mu + H } = \\frac{f_{\\mathrm{trial}}}{3\\mu+H}.\n$$\nThe plastic strain increment is then\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\gamma\\sqrt{3/2}\\mathbf{n},\n$$\nand the post-step stress deviator is $\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{trial}} - 2\\mu\\Delta\\boldsymbol{\\varepsilon}^p$. The full stress is $\\boldsymbol{\\sigma}_{n+1} = \\mathbf{s}_{n+1} + p_{\\mathrm{trial}}\\,\\mathbf{I}$, where $p_{\\mathrm{trial}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{trial}})$.\nThe exact incremental plastic work for the step is $W_p^{\\mathrm{inc,exact}} = \\boldsymbol{\\sigma}_{n+1} : \\Delta\\boldsymbol{\\varepsilon}^p$, expressed in megapascals.\n\nNext, we discuss the algorithmic consistent elastoplastic tangent modulus. By definition, $\\mathbf{D}^{ep}$ is the Fréchet derivative of the stress update mapping at the state of interest, i.e., $\\Delta\\boldsymbol{\\sigma} \\approx \\mathbf{D}^{ep} : \\Delta\\boldsymbol{\\varepsilon}$ for sufficiently small $\\Delta\\boldsymbol{\\varepsilon}$. A robust way to obtain $\\mathbf{D}^{ep}$ is to numerically differentiate the update mapping via finite differences.\n\nGiven $\\mathbf{D}^{ep}$, we obtain a linearized prediction of the elastic strain increment by applying the elastic compliance operator $\\mathbf{C}^e$. For a stress increment $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}}$, the elastic strain increment is\n$$\n\\Delta\\boldsymbol{\\varepsilon}^e_{\\mathrm{lin}} = \\mathbf{C}^e : \\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}} = \\frac{1}{2\\mu}\\mathrm{dev}\\left(\\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}}\\right) + \\frac{1}{9K}\\mathrm{tr}\\left(\\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}}\\right)\\mathbf{I}.\n$$\nTherefore, the linearized plastic strain increment is\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{lin}} = \\Delta\\boldsymbol{\\varepsilon} - \\Delta\\boldsymbol{\\varepsilon}^e_{\\mathrm{lin}}.\n$$\nWe then define the linearized incremental plastic work as\n$$\nW_p^{\\mathrm{inc,lin}} = \\boldsymbol{\\sigma}_n : \\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{lin}},\n$$\nwhich is a first-order accurate approximation to $W_p^{\\mathrm{inc,exact}}$ under the consistent tangent linearization.\n\nTwo consistency checks are required: non-negativity and first-order agreement. The Clausius-Duhem inequality for rate-independent associated plasticity implies $\\boldsymbol{\\sigma} : \\dot{\\boldsymbol{\\varepsilon}}^p \\ge 0$, which at the discrete level motivates $W_p^{\\mathrm{inc,lin}} \\ge 0$. First-order agreement is assessed by requiring $|W_p^{\\mathrm{inc,lin}} - W_p^{\\mathrm{inc,exact}}|$ to be sufficiently small relative to the magnitude of $W_p^{\\mathrm{inc,exact}}$.\n\nAlgorithmic design:\n- Represent stress and strain in Voigt notation with engineering shear components for scalar products to reflect work conjugacy.\n- Implement conversion between Voigt vectors and $3\\times 3$ symmetric tensors to compute deviatoric parts and norms consistently.\n- Implement the return mapping algorithm per step, updating $(\\boldsymbol{\\sigma}, \\boldsymbol{\\varepsilon}^p, \\alpha)$ and computing $\\Delta\\boldsymbol{\\varepsilon}^p$.\n- Build $\\mathbf{D}^{ep}$ by finite difference of the full update mapping at the pre-step state for the given step.\n- Compute $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{lin}} = \\mathbf{D}^{ep} : \\Delta\\boldsymbol{\\varepsilon}$, then $\\Delta\\boldsymbol{\\varepsilon}^e_{\\mathrm{lin}}$ via the compliance operator, and finally $\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{lin}}$.\n- Compute $W_p^{\\mathrm{inc,exact}}$ and $W_p^{\\mathrm{inc,lin}}$ in megapascals by the Voigt scalar product, and check the two conditions for each step.\n- For the fourth step, reset the state to $(\\boldsymbol{\\sigma}, \\boldsymbol{\\varepsilon}^p, \\alpha) = (\\mathbf{0}, \\mathbf{0}, 0)$ prior to applying the near-yield increment.\n- Aggregate the booleans for the five steps into a single list and print it in the specified format.\n\nThis design conforms to the fundamental laws and definitions. The test suite covers elastic, plastic, unloading, yield boundary, and combined loading cases, ensuring coverage of algorithmic consistency across different regimes. The output is a single list of lowercase booleans indicating whether the tangent-based linearization preserves non-negative plastic work and matches the exact plastic work to first order for each incremental step.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Material parameters\nE = 10000.0  # MPa\nnu = 0.3\nsigma_y0 = 50.0  # MPa\nH = 1000.0  # MPa\n\n# Derived elastic moduli\nmu = E / (2.0 * (1.0 + nu))         # shear modulus\nK = E / (3.0 * (1.0 - 2.0 * nu))    # bulk modulus\n\n# Helpers: Voigt -> tensor and deviatoric operations\ndef voigt_strain_to_tensor(e):\n    # e = [exx, eyy, ezz, gyz, gxz, gxy] (engineering shear)\n    eps = np.zeros((3, 3))\n    eps[0, 0] = e[0]\n    eps[1, 1] = e[1]\n    eps[2, 2] = e[2]\n    eps[1, 2] = e[3] / 2.0; eps[2, 1] = e[3] / 2.0\n    eps[0, 2] = e[4] / 2.0; eps[2, 0] = e[4] / 2.0\n    eps[0, 1] = e[5] / 2.0; eps[1, 0] = e[5] / 2.0\n    return eps\n\ndef tensor_to_voigt_strain(eps):\n    return np.array([\n        eps[0, 0], eps[1, 1], eps[2, 2],\n        eps[1, 2] * 2.0, eps[0, 2] * 2.0, eps[0, 1] * 2.0\n    ])\n\ndef voigt_stress_to_tensor(s):\n    # s = [sxx, syy, szz, tyz, txz, txy]\n    sig = np.zeros((3, 3))\n    sig[0, 0] = s[0]\n    sig[1, 1] = s[1]\n    sig[2, 2] = s[2]\n    sig[1, 2] = s[3]; sig[2, 1] = s[3]\n    sig[0, 2] = s[4]; sig[2, 0] = s[4]\n    sig[0, 1] = s[5]; sig[1, 0] = s[5]\n    return sig\n\ndef tensor_to_voigt_stress(sig):\n    return np.array([\n        sig[0, 0], sig[1, 1], sig[2, 2],\n        sig[1, 2], sig[0, 2], sig[0, 1]\n    ])\n\ndef dev(tensor):\n    tr = np.trace(tensor)\n    return tensor - (tr / 3.0) * np.eye(3)\n\ndef tensor_norm(tensor):\n    return np.sqrt(np.sum(tensor * tensor))\n\ndef elastic_stress_increment(delta_eps_tensor):\n    tr_eps = np.trace(delta_eps_tensor)\n    return K * tr_eps * np.eye(3) + 2.0 * mu * dev(delta_eps_tensor)\n\ndef elastic_compliance_map(delta_sigma_tensor):\n    tr_sig = np.trace(delta_sigma_tensor)\n    return (1.0 / (2.0 * mu)) * dev(delta_sigma_tensor) + (tr_sig / (9.0 * K)) * np.eye(3)\n\n# Return mapping for one step, using the model consistent with the rest of the article\ndef return_mapping_update(state, delta_eps_voigt):\n    sigma_n = state['sigma']\n    alpha_n = state['alpha']\n    delta_eps_tensor = voigt_strain_to_tensor(delta_eps_voigt)\n    \n    delta_sigma_trial = elastic_stress_increment(delta_eps_tensor)\n    sigma_trial = sigma_n + delta_sigma_trial\n    s_trial = dev(sigma_trial)\n    norm_s_trial = tensor_norm(s_trial)\n    sigma_eq_trial = norm_s_trial * np.sqrt(1.5)\n    \n    f_trial = sigma_eq_trial - (sigma_y0 + H * alpha_n)\n\n    if f_trial = 1e-12: # Numerical tolerance\n        # Elastic step\n        sigma_np1 = sigma_trial\n        delta_eps_p_tensor = np.zeros((3, 3))\n        alpha_np1 = alpha_n\n    else:\n        # Plastic step\n        n_dir = s_trial / (norm_s_trial + 1e-32)\n        denom = 3.0 * mu + H\n        delta_gamma = f_trial / denom\n        \n        delta_eps_p_tensor = delta_gamma * np.sqrt(1.5) * n_dir\n        delta_sigma_p = 2.0 * mu * delta_eps_p_tensor\n        s_np1 = s_trial - delta_sigma_p\n        \n        p_trial = np.trace(sigma_trial) / 3.0\n        sigma_np1 = s_np1 + p_trial * np.eye(3)\n        alpha_np1 = alpha_n + delta_gamma\n\n    delta_eps_p_voigt = tensor_to_voigt_strain(delta_eps_p_tensor)\n    sigma_np1_voigt = tensor_to_voigt_stress(sigma_np1)\n    Wp_inc_exact = float(np.dot(sigma_np1_voigt, delta_eps_p_voigt))\n\n    new_state = {\n        'sigma': sigma_np1,\n        'eps_p': state['eps_p'] + delta_eps_p_tensor,\n        'alpha': alpha_np1\n    }\n    return new_state, delta_eps_p_voigt, Wp_inc_exact\n\ndef numeric_tangent_dep(state, h=1e-8):\n    sigma_base = state['sigma']\n    Dep = np.zeros((6, 6))\n    for i in range(6):\n        delta_eps = np.zeros(6)\n        delta_eps[i] = h\n        base_copy = {\n            'sigma': sigma_base.copy(),\n            'eps_p': state['eps_p'].copy(),\n            'alpha': state['alpha']\n        }\n        new_state, _, _ = return_mapping_update(base_copy, delta_eps)\n        delta_sigma_tensor = new_state['sigma'] - sigma_base\n        delta_sigma_voigt = tensor_to_voigt_stress(delta_sigma_tensor)\n        Dep[:, i] = delta_sigma_voigt / h\n    return Dep\n\ndef solve():\n    tol = 5e-3\n    steps = [\n        np.array([1e-5, 1e-5, 1e-5, 0.0, 0.0, 0.0]),\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.01]),\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0, -0.005]),\n    ]\n    state = {'sigma': np.zeros((3, 3)), 'eps_p': np.zeros((3, 3)), 'alpha': 0.0}\n    results = []\n\n    for delta_eps in steps:\n        Dep = numeric_tangent_dep(state, h=1e-8)\n        delta_sigma_lin_voigt = Dep @ delta_eps\n        delta_sigma_lin_tensor = voigt_stress_to_tensor(delta_sigma_lin_voigt)\n        delta_eps_e_lin_tensor = elastic_compliance_map(delta_sigma_lin_tensor)\n        delta_eps_e_lin_voigt = tensor_to_voigt_strain(delta_eps_e_lin_tensor)\n        delta_eps_p_lin_voigt = delta_eps - delta_eps_e_lin_voigt\n        sigma_n_voigt = tensor_to_voigt_stress(state['sigma'])\n        Wp_inc_lin = float(np.dot(sigma_n_voigt, delta_eps_p_lin_voigt))\n        new_state, _, Wp_inc_exact = return_mapping_update(state, delta_eps)\n        nonneg = (Wp_inc_lin >= -1e-10)\n        err = abs(Wp_inc_lin - Wp_inc_exact)\n        scale = max(1.0, abs(Wp_inc_exact))\n        agree = (err = tol * scale)\n        results.append(nonneg and agree)\n        state = new_state\n    \n    # Step 4: Reset state\n    state_reset = {'sigma': np.zeros((3, 3)), 'eps_p': np.zeros((3, 3)), 'alpha': 0.0}\n    gamma_y = sigma_y0 / (np.sqrt(3.0) * mu)\n    delta_eps4 = np.array([0.0, 0.0, 0.0, 0.0, 0.0, gamma_y])\n    Dep4 = numeric_tangent_dep(state_reset, h=1e-8)\n    delta_sigma_lin_voigt_4 = Dep4 @ delta_eps4\n    delta_sigma_lin_tensor_4 = voigt_stress_to_tensor(delta_sigma_lin_voigt_4)\n    delta_eps_e_lin_tensor_4 = elastic_compliance_map(delta_sigma_lin_tensor_4)\n    delta_eps_e_lin_voigt_4 = tensor_to_voigt_strain(delta_eps_e_lin_tensor_4)\n    delta_eps_p_lin_voigt_4 = delta_eps4 - delta_eps_e_lin_voigt_4\n    sigma_n_voigt_4 = tensor_to_voigt_stress(state_reset['sigma'])\n    Wp_inc_lin_4 = float(np.dot(sigma_n_voigt_4, delta_eps_p_lin_voigt_4))\n    _, _, Wp_inc_exact_4 = return_mapping_update(state_reset, delta_eps4)\n    nonneg_4 = (Wp_inc_lin_4 >= -1e-10)\n    err_4 = abs(Wp_inc_lin_4 - Wp_inc_exact_4)\n    scale_4 = max(1.0, abs(Wp_inc_exact_4))\n    agree_4 = (err_4 = tol * scale_4)\n    results.append(nonneg_4 and agree_4)\n\n    # Step 5: Continue from state after Step 3\n    delta_eps5 = np.array([5e-4, -2.5e-4, -2.5e-4, 0.0, 0.0, 0.008])\n    Dep5 = numeric_tangent_dep(state, h=1e-8)\n    delta_sigma_lin_voigt_5 = Dep5 @ delta_eps5\n    delta_sigma_lin_tensor_5 = voigt_stress_to_tensor(delta_sigma_lin_voigt_5)\n    delta_eps_e_lin_voigt_5 = tensor_to_voigt_strain(delta_sigma_lin_tensor_5)\n    delta_eps_p_lin_voigt_5 = delta_eps5 - delta_eps_e_lin_voigt_5\n    sigma_n_voigt_5 = tensor_to_voigt_stress(state['sigma'])\n    Wp_inc_lin_5 = float(np.dot(sigma_n_voigt_5, delta_eps_p_lin_voigt_5))\n    _, _, Wp_inc_exact_5 = return_mapping_update(state, delta_eps5)\n    nonneg_5 = (Wp_inc_lin_5 >= -1e-10)\n    err_5 = abs(Wp_inc_lin_5 - Wp_inc_exact_5)\n    scale_5 = max(1.0, abs(Wp_inc_exact_5))\n    agree_5 = (err_5 = tol * scale_5)\n    results.append(nonneg_5 and agree_5)\n    \n    print(f\"[{','.join(map(lambda x: 'true' if x else 'false', results))}]\")\n\nsolve()\n```"
        }
    ]
}