{
    "hands_on_practices": [
        {
            "introduction": "减缩积分虽然能有效避免剪切闭锁，但可能引入被称为“沙漏模式”的非物理性零能变形。本练习提供了一个具体的实践机会，让您识别一个简单的二维单元中的这种模式，并直接验证其定义性特征：它不产生应变能，从而使单元表现出不切实际的柔性。通过这个练习 ()，您将为理解此问题建立起基本直觉。",
            "id": "3555206",
            "problem": "考虑一个用于计算岩土力学的平面应变条件下的单个四节点双线性等参四边形有限元。该单元是边长为 $2L$、厚度为 $t$ 的正方形，节点位于物理坐标 $(x,y)$ 处：节点 $1$ 位于 $(-L,-L)$，节点 $2$ 位于 $(L,-L)$，节点 $3$ 位于 $(L,L)$，节点 $4$ 位于 $(-L,L)$。材料是线性弹性、均质、各向同性的，在平面应变条件下，其杨氏模量为 $E$，泊松比为 $\\nu$。刚度矩阵是在自然坐标系中的单元中心 $(\\xi,\\eta)=(0,0)$ 处，使用单点高斯积分（即减缩积分）形成的。\n\n采用以自然坐标 $(\\xi,\\eta)$ 表示的标准双线性形函数，以及标准等参映射 $x=L\\xi$, $y=L\\eta$。设节点位移向量排列如下\n$$\n\\boldsymbol{u}=\\begin{pmatrix}u_1  v_1  u_2  v_2  u_3  v_3  u_4  v_4\\end{pmatrix}^{\\mathsf{T}},\n$$\n其中 $u_i$ 和 $v_i$ 分别是节点 $i$ 在 $x$ 和 $y$ 方向上的位移。\n\n仅使用单元中心的单点高斯积分且不进行任何沙漏控制稳定，通过找到一个特定的节点位移向量 $\\boldsymbol{u}$（归一化为欧几里得范数为 $1$），使得在中心点计算的应变向量恒等于零，从而确定一个非平凡沙漏模式。然后，使用内能的单点有限元近似，验证并计算内能\n$$\nU=\\frac{1}{2}\\,\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\,\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{K}$ 是通过未经稳定的单点积分得到的单元刚度矩阵。\n\n提供：\n- 归一化沙漏节点位移向量 $\\boldsymbol{u}$ 的分量。\n- 相应的内能 $U$。\n\n将内能以焦耳（Joules）为单位表示。不需要进行数值四舍五入。将最终答案以一个单行矩阵的形式返回，该矩阵包含 $\\boldsymbol{u}$ 的八个分量以及随后的 $U$。",
            "solution": "用户希望我解决一个计算岩土力学中的问题，具体涉及有限元分析。\n\n我的计划如下：\n1.  **验证问题陈述：** 检查其科学合理性、适定性和完整性。\n    *   **已知条件：**\n        *   单元：4节点双线性等参四边形，平面应变。\n        *   几何形状：正方形，边长 $2L$，厚度 $t$。\n        *   节点（物理坐标）：$1(-L,-L)$、$2(L,-L)$、$3(L,L)$、$4(-L,L)$。\n        *   材料：线性弹性、均质、各向同性（杨氏模量 $E$，泊松比 $\\nu$）。\n        *   积分：在 $(\\xi, \\eta) = (0,0)$ 处的单点高斯积分。\n        *   映射：从自然坐标 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$ 到 $x=L\\xi$, $y=L\\eta$。\n        *   位移：$\\boldsymbol{u}=\\begin{pmatrix}u_1  v_1  u_2  v_2  u_3  v_3  u_4  v_4\\end{pmatrix}^{\\mathsf{T}}$。\n        *   任务1：找到一个非平凡、归一化的沙漏模式 $\\boldsymbol{u}$（欧几里得范数=1），使其中心点应变为零。\n        *   任务2：计算此模式下的内能 $U=\\frac{1}{2}\\,\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\,\\boldsymbol{u}$，其中 $\\boldsymbol{K}$ 是未稳定的、单点积分的刚度矩阵。\n        *   特别说明：“以焦耳（Joules）为单位表示内能。”和“不需要进行数值四舍五入。”\n    *   **验证：**\n        *   该问题在科学上基于有限元方法（FEM）的理论。\n        *   该设置是演示减缩积分单元中沙漏现象的标准设置。\n        *   最初的担忧是，对于一个带有符号参数（$E, L, t, \\nu$）的问题，要求以“焦耳”为单位提供能量。这暗示着可能存在矛盾，因为没有数值就无法指定单位。\n        *   然而，让我们分析问题的核心。根据定义，减缩积分单元的“沙漏模式”是一种在积分点处产生零应变的节点位移模式。\n        *   由有限元积分法则近似的内能是这些积分点处应变的函数。\n        *   具体来说，单元内能为 $U \\approx \\frac{1}{2} (\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c))^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c)) \\times V_{eff}$，其中 $\\boldsymbol{x}_c$ 是积分点，$V_{eff}$ 是有效体积。\n        *   如果根据所研究模式的定义，$\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c) = \\boldsymbol{0}$，那么计算出的内能 $U$ 必须恰好为 $0$。\n        *   值 $0$ 与单位系统无关。“0 焦耳”是一个完全有效且明确的表述。\n        *   因此，该问题并不矛盾，而是一个精心设计的问题，用以测试对沙漏模式基本理解。它是有效的。\n\n2.  **进行求解：**\n    *   定义双线性形函数 $N_i(\\xi, \\eta)$。\n    *   定义等参映射并计算雅可比矩阵 $\\boldsymbol{J}$。\n    *   推导应变-位移矩阵 $\\boldsymbol{B}$，它通过 $\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\boldsymbol{u}$ 将应变向量 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_x  \\varepsilon_y  \\gamma_{xy} \\end{pmatrix}^{\\mathsf{T}}$ 与节点位移向量 $\\boldsymbol{u}$ 联系起来。\n    *   在积分点 $(\\xi, \\eta) = (0,0)$ 处计算 $\\boldsymbol{B}$。\n    *   在 $\\boldsymbol{B}(0,0)$ 的零空间中找到一个非平凡向量 $\\boldsymbol{u}$。该向量代表一个沙漏模式。一个标准的选择是“领结”模式。\n    *   将此向量归一化，使其欧几里得范数为1。\n    *   使用单点积分，正式写出单元刚度矩阵 $\\boldsymbol{K}$ 的表达式。\n    *   将此代入内能表达式 $U = \\frac{1}{2}\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{u}$。\n    *   证明由于 $\\boldsymbol{u}$ 是一个沙漏模式，能量 $U$ 计算结果为零。\n    *   将最终答案组合成一个行矩阵。\n\n**分步执行：**\n\n*   **形函数：**\n    $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n*   **雅可比矩阵：**\n    $x = \\sum N_i x_i = L\\xi$, $y = \\sum N_i y_i = L\\eta$.\n    $\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} L  0 \\\\ 0  L \\end{pmatrix}$.\n    $\\boldsymbol{J}^{-1} = \\begin{pmatrix} 1/L  0 \\\\ 0  1/L \\end{pmatrix}$。 $\\det(\\boldsymbol{J}) = L^2$。\n*   **中心点的B矩阵：**\n    在 $(\\xi, \\eta) = (0,0)$ 处：\n    $\\frac{\\partial N_1}{\\partial \\xi}=-\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\xi}=\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\xi}=\\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\xi}=-\\frac{1}{4}$。\n    $\\frac{\\partial N_1}{\\partial \\eta}=-\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\eta}=-\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\eta}=\\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\eta}=\\frac{1}{4}$。\n    B矩阵将应变与位移关联起来：$\\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{pmatrix} = \\sum_{i=1}^4 \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix} \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}$。\n    使用 $\\frac{\\partial N_i}{\\partial x} = \\frac{1}{L}\\frac{\\partial N_i}{\\partial \\xi}$ 和 $\\frac{\\partial N_i}{\\partial y} = \\frac{1}{L}\\frac{\\partial N_i}{\\partial \\eta}$：\n    $\\boldsymbol{B}(0,0) = \\frac{1}{4L} \\begin{pmatrix} -1  0  1  0  1  0  -1  0 \\\\ 0  -1  0  -1  0  1  0  1 \\\\ -1  -1  -1  1  1  1  1  -1 \\end{pmatrix}$。\n*   **沙漏模式：**\n    我们需要 $\\boldsymbol{B}(0,0)\\boldsymbol{u} = \\boldsymbol{0}$。\n    我们来测试一个经典的模式：$\\boldsymbol{u}_{raw} = \\begin{pmatrix} 1  -1  -1  1  1  -1  -1  1 \\end{pmatrix}^{\\mathsf{T}}$（不是这个）。\n    让我们对 $u$ 分量使用模式 $\\boldsymbol{h} = \\begin{pmatrix} 1, -1, 1, -1 \\end{pmatrix}^{\\mathsf{T}}$，对 $v$ 分量使用零。\n    $\\boldsymbol{u}_{raw} = \\begin{pmatrix} 1  0  -1  0  1  0  -1  0 \\end{pmatrix}^{\\mathsf{T}}$。\n    检验：$\\boldsymbol{B}(0,0)\\boldsymbol{u}_{raw} = \\frac{1}{4L} \\begin{pmatrix} -1(1)+1(-1)+1(1)-1(-1) \\\\ 0 \\\\ -1(1)-1(-1)+1(1)+1(-1) \\end{pmatrix} = \\frac{1}{4L} \\begin{pmatrix} -1-1+1+1 \\\\ 0 \\\\ -1+1+1-1 \\end{pmatrix} = \\boldsymbol{0}$。这个模式可行。\n*   **归一化：**\n    $||\\boldsymbol{u}_{raw}||_2 = \\sqrt{1^2 + (-1)^2 + 1^2 + (-1)^2} = \\sqrt{4} = 2$。\n    $\\boldsymbol{u} = \\frac{1}{2} \\boldsymbol{u}_{raw} = \\begin{pmatrix} \\frac{1}{2}  0  -\\frac{1}{2}  0  \\frac{1}{2}  0  -\\frac{1}{2}  0 \\end{pmatrix}^{\\mathsf{T}}$。\n*   **内能：**\n    $U = \\frac{1}{2}\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{u}$。\n    对于单点积分，刚度矩阵为 $\\boldsymbol{K} = V_q \\boldsymbol{B}(0,0)^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B}(0,0)$，其中 $V_q = w \\det(\\boldsymbol{J}) t = 4 L^2 t$。\n    $U = \\frac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} (4 L^2 t \\boldsymbol{B}(0,0)^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B}(0,0)) \\boldsymbol{u}$\n    $U = 2 L^2 t (\\boldsymbol{B}(0,0)\\boldsymbol{u})^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{B}(0,0)\\boldsymbol{u})$。\n    根据构造，所选的 $\\boldsymbol{u}$ 是一个沙漏模式，所以 $\\boldsymbol{B}(0,0)\\boldsymbol{u} = \\boldsymbol{0}$。\n    $U = 2 L^2 t (\\boldsymbol{0})^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{0}) = 0$。\n*   **最终答案：**\n    向量分量为 $\\frac{1}{2}, 0, -\\frac{1}{2}, 0, \\frac{1}{2}, 0, -\\frac{1}{2}, 0$。\n    能量为 $U=0$。\n    最终答案是一个行矩阵：$\\begin{pmatrix} \\frac{1}{2}  0  -\\frac{1}{2}  0  \\frac{1}{2}  0  -\\frac{1}{2}  0  0 \\end{pmatrix}$。\n\n逻辑成立。我现在将正式写出解答。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  0  -\\frac{1}{2}  0  \\frac{1}{2}  0  -\\frac{1}{2}  0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了沙漏问题之后，下一步自然是探索如何控制它。本练习介绍了一种常见的解决方案：增加一个惩罚沙漏变形的“稳定能”。您将从这个势能函数出发，推导出相应的稳定力 ()，从而完成从识别问题到设计解决方案的过渡。",
            "id": "3555177",
            "problem": "考虑有限元法 (FEM) 中一个未畸变的三线性 ($Q_1$) 八节点六面体有限元，该单元占据一个边长为 $h$ 的立方体，其节点处的局部等参坐标 $(\\xi,\\eta,\\zeta)$ 取值为 $\\pm 1$。该单元由各向同性线弹性材料构成，其杨氏模量为 $E$，泊松比为 $\\nu$。该单元采用单高斯点（减缩积分）进行积分。为解决沙漏（零能）模式的出现，采用一种基于刚度的沙漏控制方法，为单元增加稳定能。\n\n定义位移 $x$ 分量的标量离散沙漏度量为\n$$\nq \\equiv \\sum_{i=1}^{8} u_{x,i}\\,\\xi_i\\,\\eta_i,\n$$\n其中 $u_{x,i}$ 是节点 $i$ 处位移的 $x$ 分量，$(\\xi_i,\\eta_i,\\zeta_i)\\in\\{-1,1\\}^3$ 是节点 $i$ 的局部坐标。引入稳定能\n$$\nW_{hg} \\equiv \\frac{1}{2}\\,\\beta\\,q^2,\n$$\n其中网格尺寸缩放因子为 $\\beta = \\alpha\\,E\\,h$，$\\alpha0$ 是一个无量纲控制参数。\n\n假设在单元节点上规定了以下离散位移场：\n$$\nu_{x,i} = U_0\\,\\xi_i\\,\\eta_i,\\qquad u_{y,i}=0,\\qquad u_{z,i}=0,\n$$\n对于所有 $i=1,\\dots,8$，其中 $U_0$ 是一个常数振幅。在减缩积分下，该位移场代表一个纯沙漏模式。\n\n任务：\n1. 从保守内力的虚功原理出发，通过对 $u_{x,i}$ 求适当的导数，推导由 $W_{hg}$ 隐含的沙漏节点力 $f^{hg}_{x,i}$。\n2. 对给定的位移场计算 $q$，并获得用 $\\alpha$、$E$、$h$ 和 $U_0$ 表示的 $f^{hg}_{x,i}$ 的显式形式。\n3. 计算给定场下的总稳定能 $W_{hg}$，并验证对于 $\\alpha0$ 其为非负值。\n\n将最终的稳定能 $W_{hg}$（单位为焦耳）表示为包含 $\\alpha$、$E$、$h$ 和 $U_0$ 的封闭形式表达式。在最终的方框答案中不要包含单位。",
            "solution": "该问题经证实具有科学依据、提法恰当、客观且自洽。它描述了在固体力学有限元法 (FEM) 背景下进行沙漏控制的标准程序。所有定义和数据均已提供，可用于执行所要求的推导和计算。\n\n解答过程按问题陈述的要求分为三个部分。\n\n### 第1部分：沙漏节点力的推导\n\n沙漏节点力 $f^{hg}_{x,i}$ 是从沙漏稳定势能 $W_{hg}$ 推导出的保守力。根据保守系统的虚功原理，节点力是势能相对于相应广义坐标（即节点位移 $u_{x,i}$）的负偏导数。\n\n稳定能由下式给出：\n$$\nW_{hg} = \\frac{1}{2}\\,\\beta\\,q^2\n$$\n节点 $i$ 处位移 $x$ 分量的沙漏节点力为：\n$$\nf^{hg}_{x,i} = -\\frac{\\partial W_{hg}}{\\partial u_{x,i}}\n$$\n我们应用链式法则来计算这个导数：\n$$\nf^{hg}_{x,i} = -\\frac{\\partial}{\\partial u_{x,i}} \\left( \\frac{1}{2}\\,\\beta\\,q^2 \\right) = -\\frac{1}{2}\\,\\beta \\cdot (2q) \\cdot \\frac{\\partial q}{\\partial u_{x,i}} = -\\beta\\,q\\,\\frac{\\partial q}{\\partial u_{x,i}}\n$$\n沙漏度量 $q$ 被定义为节点位移 $u_{x,j}$ 的线性函数：\n$$\nq = \\sum_{j=1}^{8} u_{x,j}\\,\\xi_j\\,\\eta_j\n$$\n现在，我们计算 $q$ 相对于 $u_{x,i}$ 的偏导数：\n$$\n\\frac{\\partial q}{\\partial u_{x,i}} = \\frac{\\partial}{\\partial u_{x,i}} \\left( \\sum_{j=1}^{8} u_{x,j}\\,\\xi_j\\,\\eta_j \\right)\n$$\n由于节点位移 $u_{x,j}$ 是自变量，导数 $\\frac{\\partial u_{x,j}}{\\partial u_{x,i}}$ 等于克罗内克δ符号 $\\delta_{ij}$。\n$$\n\\frac{\\partial q}{\\partial u_{x,i}} = \\sum_{j=1}^{8} \\frac{\\partial u_{x,j}}{\\partial u_{x,i}}\\,\\xi_j\\,\\eta_j = \\sum_{j=1}^{8} \\delta_{ij}\\,\\xi_j\\,\\eta_j = \\xi_i\\,\\eta_i\n$$\n将此结果代回沙漏力的表达式，我们得到沙漏节点力的一般形式：\n$$\nf^{hg}_{x,i} = -\\beta\\,q\\,\\xi_i\\,\\eta_i\n$$\n\n### 第2部分：对给定 displaceent 场的计算\n\n问题规定了一个纯沙漏位移场：\n$$\nu_{x,i} = U_0\\,\\xi_i\\,\\eta_i, \\qquad u_{y,i}=0, \\qquad u_{z,i}=0\n$$\n首先，我们针对此特定位移场计算标量沙漏度量 $q$。\n$$\nq = \\sum_{i=1}^{8} u_{x,i}\\,\\xi_i\\,\\eta_i = \\sum_{i=1}^{8} (U_0\\,\\xi_i\\,\\eta_i)\\,\\xi_i\\,\\eta_i = U_0 \\sum_{i=1}^{8} (\\xi_i\\,\\eta_i)^2 = U_0 \\sum_{i=1}^{8} \\xi_i^2\\,\\eta_i^2\n$$\n对于六面体单元的每个节点 $i$，局部坐标 $\\xi_i$ 和 $\\eta_i$ 要么是 $-1$ 要么是 $1$。因此，它们的平方总是1：$\\xi_i^2 = (\\pm 1)^2 = 1$ 且 $\\eta_i^2 = (\\pm 1)^2 = 1$。\n因此，对于所有 $i=1, \\dots, 8$，$\\xi_i^2\\,\\eta_i^2 = 1$。求和变为：\n$$\nq = U_0 \\sum_{i=1}^{8} 1 = 8\\,U_0\n$$\n现在我们可以将 $q=8\\,U_0$ 和 $\\beta=\\alpha\\,E\\,h$ 的表达式代入第1部分推导出的公式，从而写出沙漏节点力 $f^{hg}_{x,i}$ 的显式形式。\n$$\nf^{hg}_{x,i} = -\\beta\\,q\\,\\xi_i\\,\\eta_i = -(\\alpha\\,E\\,h)\\,(8\\,U_0)\\,\\xi_i\\,\\eta_i\n$$\n$$\nf^{hg}_{x,i} = -8\\,\\alpha\\,E\\,h\\,U_0\\,\\xi_i\\,\\eta_i\n$$\n\n### 第3部分：总稳定能的计算\n\n总稳定能 $W_{hg}$ 使用其定义和上面推导出的值来计算。\n$$\nW_{hg} = \\frac{1}{2}\\,\\beta\\,q^2\n$$\n代入 $\\beta = \\alpha\\,E\\,h$ 和 $q = 8\\,U_0$：\n$$\nW_{hg} = \\frac{1}{2}\\,(\\alpha\\,E\\,h)\\,(8\\,U_0)^2 = \\frac{1}{2}\\,\\alpha\\,E\\,h\\,(64\\,U_0^2)\n$$\n$$\nW_{hg} = 32\\,\\alpha\\,E\\,h\\,U_0^2\n$$\n为验证该能量是非负的，我们检查表达式中每一项的符号：\n- 控制参数 $\\alpha$ 给定为正：$\\alpha  0$。\n- 杨氏模量 $E$ 是一种物理材料属性，对于任何真实材料都为正：$E  0$。\n- 单元边长 $h$ 是一个几何尺寸，必须为正：$h  0$。\n- 振幅的平方 $U_0^2$ 对于任何实数值 $U_0$ 都是非负的：$U_0^2 \\ge 0$。\n\n因此，这些项的乘积 $W_{hg} = 32\\,\\alpha\\,E\\,h\\,U_0^2$ 必须为非负值 ($W_{hg} \\ge 0$)。仅当沙漏模式的振幅为零 ($U_0=0$) 时，能量才为零，这是稳定项所期望的行为。\n\n总稳定能的最终表达式为 $32\\,\\alpha\\,E\\,h\\,U_0^2$。",
            "answer": "$$\n\\boxed{32\\,\\alpha\\,E\\,h\\,U_0^{2}}\n$$"
        },
        {
            "introduction": "在前述概念的基础上，这个高级练习将深入探讨三维沙漏模式的内在结构。您将推导这些模式的完整基向量集，并应用一种广泛使用的特定控制方案（Flanagan-Belytschko）来计算需要多大的变形幅值才能储存目标稳定能。这个综合性问题 () 将底层理论与实际的工程设计计算联系起来。",
            "id": "3555190",
            "problem": "考虑一个用于岩土力学应用的有限元法 (FEM) 中的三维八节点三线性等参砖单元 ($Q1$)。自然坐标为 $(\\xi,\\eta,\\zeta) \\in [-1,1]^3$，节点自然坐标符号为 $\\xi_a,\\eta_a,\\zeta_a \\in \\{-1,+1\\}$，其中节点索引 $a=1,\\dots,8$，遵循常规的 $Q1$ 顶点布局。三线性形函数为 $N_a(\\xi,\\eta,\\zeta) = \\frac{1}{8}(1+\\xi_a \\xi)(1+\\eta_a \\eta)(1+\\zeta_a \\zeta)$。到物理坐标的等参映射由节点位置 $\\boldsymbol{x}_a$ 定义；其在单元中心 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 处的雅可比矩阵是 $3 \\times 3$ 的矩阵 $\\boldsymbol{J}$，其分量以米为单位，由下式给出：\n$$\n\\boldsymbol{J} = \\begin{pmatrix}\n1.2  0.3  0 \\\\\n0.1  0.9  0.2 \\\\\n0  0.25  1.1\n\\end{pmatrix}.\n$$\n该单元在中心使用单个高斯点进行减缩积分。物理坐标中的对称梯度算子为 $\\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$，其中 $\\boldsymbol{u}$ 是位移场。\n\n从上述定义出发，并且仅使用基本的有限元恒等式，例如高斯点处的 $\\nabla N_a = \\boldsymbol{J}^{-T} \\nabla_{\\widehat{\\boldsymbol{x}}} N_a$ 和中心点处的三线性形函数导数 $\\frac{\\partial N_a}{\\partial \\xi}\\big|_{0} = \\xi_a/8$，$\\frac{\\partial N_a}{\\partial \\eta}\\big|_{0} = \\eta_a/8$，$\\frac{\\partial N_a}{\\partial \\zeta}\\big|_{0} = \\zeta_a/8$，完成以下任务：\n\n1. 推导完整的标量沙漏基底模式 $h^{\\alpha}_a \\in \\{-1,+1\\}$ (对于 $\\alpha=1,2,3,4$)，这些模式在自然坐标空间中的高斯点处产生零梯度，即满足 $\\sum_{a=1}^{8} h^{\\alpha}_a\\,\\xi_a = \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\eta_a = \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\zeta_a = 0$。解释为什么在给定的等参畸变 $\\boldsymbol{J}$ 下，这些模式在物理空间的减缩积分点处仍然产生 $\\nabla^s \\boldsymbol{u}=\\boldsymbol{0}$。\n\n2. 将这些标量模式扩展到矢量值位移设置，通过每次将每个标量模式仅分配给位移的一个笛卡尔分量，来枚举出减缩积分下 $Q1$ 磚单元的 $12$ 个零能沙漏向量。\n\n3. 设计一个显式位移场 $\\boldsymbol{u}(\\xi,\\eta,\\zeta)$，该位移场恰好激发 $12$ 个矢量沙漏模式中的一个，同时确保在减缩积分点处 $\\nabla^s \\boldsymbol{u}=\\boldsymbol{0}$。设所选模式为具有标量模式 $h^{4}_a = \\xi_a \\eta_a \\zeta_a$ 的笛卡尔 $x$ 分量。用单个振幅参数 $\\alpha$ 和该标量模式表示 $\\boldsymbol{u}$，并写出相应的节点位移值 $\\boldsymbol{u}_a$。\n\n4. 考虑一个 Flanagan–Belytschko 型沙漏控制罚，其能量为\n$$\nE_{h} \\,=\\, \\beta\\, G\\, \\frac{V}{\\ell^2}\\, q^{2},\n$$\n其中 $G$ 是剪切模量，$V$ 是由 $V \\approx 8\\,\\det(\\boldsymbol{J})$ 近似的单元体积，$\\ell$ 是由 $\\ell^2 = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{J}^{T}\\boldsymbol{J})$ 定义的特征长度，$\\beta$ 是一个无量纲稳定化参数，$q$ 是为所选模式定义的标量沙漏度量，定义为\n$$\nq \\,=\\, \\frac{1}{8}\\sum_{a=1}^{8} h^{4}_a\\, u_{a,x},\n$$\n其中 $u_{a,x}$ 是节点 $a$ 处节点位移的 $x$ 分量。假设 $G = 25 \\times 10^{6}\\,\\text{Pa}$ 且 $\\beta = 0.25$。\n\n为所选的单个模式施加一个目标沙漏控制能 $E_h^{\\star} = 1.5\\,\\text{kJ}$，并计算所需的振幅 $\\alpha$，使得 $E_h = E_h^{\\star}$。使用给定的 $\\boldsymbol{J}$。以米为单位表示最终振幅，并将答案四舍五入到四位有效数字。",
            "solution": "该问题已经过验证，被认为是科学上成立、适定、客观且内部一致的，包含了获得唯一解所需的所有必要信息。在计算岩土力学的背景下，其定义和参数值是标准的且物理上是现实的。因此，我们可以进行完整解答。\n\n解答分为四个部分，对应于问题陈述中的四个任务。\n\n**第一部分：标量沙漏模式的推导及零应变条件**\n\n沙漏模式是一种节点位移模式，它导致位于单元中心 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 的单个高斯点处的应变为零。位移场 $\\boldsymbol{u}$ 是通过形函数 $N_a$ 从节点位移 $\\boldsymbol{u}_a$ 插值得到的：$\\boldsymbol{u}(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) \\boldsymbol{u}_a$。\n首先，考虑一个标量场 $u(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) u_a$。其相对于自然坐标 $(\\xi, \\eta, \\zeta)$ 的梯度为 $\\nabla_{\\boldsymbol{\\xi}} u = \\sum_{a=1}^{8} u_a \\nabla_{\\boldsymbol{\\xi}} N_a$。在单元中心，节点 $a$ 的形函数的梯度由问题陈述给出，为 $\\nabla_{\\boldsymbol{\\xi}} N_a \\rvert_{(0,0,0)} = \\frac{1}{8}(\\xi_a, \\eta_a, \\zeta_a)^{\\top}$。\n因此，该标量场在中心点的梯度为：\n$$\n\\nabla_{\\boldsymbol{\\xi}} u \\bigg|_{(0,0,0)} = \\sum_{a=1}^{8} u_a \\left(\\frac{1}{8}(\\xi_a, \\eta_a, \\zeta_a)^{\\top}\\right) = \\frac{1}{8} \\begin{pmatrix} \\sum_{a=1}^{8} u_a \\xi_a \\\\ \\sum_{a=1}^{8} u_a \\eta_a \\\\ \\sum_{a=1}^{8} u_a \\zeta_a \\end{pmatrix}\n$$\n为了使该梯度为零向量，节点位移模式 $\\{u_a\\}_{a=1}^8$ 必须与由自然坐标定义的三个节点向量 $\\{\\xi_a\\}$、$\\{\\eta_a\\}$ 和 $\\{\\zeta_a\\}$ 正交。问题要求找出四个这样的模式，记为 $h^{\\alpha}_a \\in \\{-1,+1\\}$ (对于 $\\alpha=1,2,3,4$)，满足：\n$$\n\\sum_{a=1}^{8} h^{\\alpha}_a\\,\\xi_a = 0, \\quad \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\eta_a = 0, \\quad \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\zeta_a = 0\n$$\n这些条件定义了沙漏模式。在 $\\mathbb{R}^8$ 中，与三个向量 $\\{\\xi_a\\}$、$\\{\\eta_a\\}$ 和 $\\{\\zeta_a\\}$ 正交的节点向量空间维数为 $8-3=5$。该空间的一个基也包括常数向量 $\\{1,1, ..., 1\\}$，它对应于刚体平移并产生零梯度。剩下的四个基向量构成了沙漏模式。一个标准的、由 $\\{-1,+1\\}$ 中元素构成的相互正交的此类模式集，可以通过坐标符号的乘积构造出来：\n$$\nh^{1}_a = \\xi_a \\eta_a \\\\\nh^{2}_a = \\eta_a \\zeta_a \\\\\nh^{3}_a = \\zeta_a \\xi_a \\\\\nh^{4}_a = \\xi_a \\eta_a \\zeta_a\n$$\n为了验证，以 $h^{1}_a = \\xi_a \\eta_a$ 为例。检查正交性条件：\n$\\sum_{a=1}^{8} (\\xi_a \\eta_a) \\xi_a = \\sum_{a=1}^{8} \\xi_a^2 \\eta_a = \\sum_{a=1}^{8} \\eta_a = 0$，因为有四个节点的 $\\eta_a=+1$，四个节点的 $\\eta_a=-1$。类似地，$\\sum_{a=1}^{8} (\\xi_a \\eta_a) \\eta_a = \\sum_{a=1}^{8} \\xi_a \\eta_a^2 = \\sum_{a=1}^{8} \\xi_a = 0$。最后，$\\sum_{a=1}^{8} (\\xi_a \\eta_a) \\zeta_a=0$，因为对于每一对 $(\\xi_a, \\eta_a)$ 值，都有一个节点的 $\\zeta_a=+1$ 和一个节点的 $\\zeta_a=-1$，导致项成对抵消。类似的论证也适用于 $h^2_a$、$h^3_a$ 和 $h^4_a$。这样就完成了四个标量模式的推导。\n\n接下来，我们解释为什么这些模式在物理空间中会产生零对称梯度 $\\nabla^s \\boldsymbol{u}=\\boldsymbol{0}$。\n设位移场为一个矢量场 $\\boldsymbol{u}$。$\\boldsymbol{u}$ 相对于自然坐标的梯度 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$ 与其相对于物理坐标的梯度 $\\nabla \\boldsymbol{u}$ 通过链式法则相关联：$\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = (\\nabla \\boldsymbol{u}) \\boldsymbol{J}$。\n这意味着 $\\nabla \\boldsymbol{u} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}) \\boldsymbol{J}^{-1}$，前提是雅可比矩阵 $\\boldsymbol{J}$ 是可逆的。\n沙漏位移模式是通过将一个笛卡尔分量（例如 $u_x$）的节点位移设置为一个标量沙漏模式（例如 $u_{a,x} = c\\,h^{\\alpha}_a$），并将其他分量设置为零来形成的。\n在中心点，该分量相对于自然坐标的梯度如上所示为零：$\\nabla_{\\boldsymbol{\\xi}} u_x \\rvert_0 = \\boldsymbol{0}^{\\top}$。如果位移的全部三个分量都遵循某个标量沙漏模式（不一定是同一个），那么矩阵 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$ 的每一行在中心点都将是零向量。因此，$\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}\\rvert_0 = \\boldsymbol{0}_{3\\times3}$。\n因此，在中心点处物理坐标下的梯度也是零矩阵：\n$$\n\\nabla \\boldsymbol{u} \\bigg|_{(0,0,0)} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} \\rvert_{(0,0,0)}) \\boldsymbol{J}^{-1} = \\boldsymbol{0}_{3\\times3} \\cdot \\boldsymbol{J}^{-1} = \\boldsymbol{0}_{3\\times3}\n$$\n对称梯度算子是 $\\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$。如果 $\\nabla \\boldsymbol{u}\\rvert_0 = \\boldsymbol{0}$，则立即得出 $\\nabla^s \\boldsymbol{u}\\rvert_0 = \\boldsymbol{0}$。这个结果与具体的畸变矩阵 $\\boldsymbol{J}$ 无关，只要它是非奇异的。\n\n**第二部分：矢量沙漏模式的枚举**\n\n该单元有 $8$ 个节点，每个节点有 $3$ 个位移自由度 (DOF)，总共有 $24$ 个自由度。单个积分点处的状态由位移梯度张量 $\\nabla \\boldsymbol{u}$ 的 $3 \\times 3 = 9$ 个分量描述。积分点“看不到”的变形模式数量为 $24 - 9 = 15$。这些是在减缩积分下的零能模式。这 $15$ 个模式包括 $3$ 个刚体平移模式和 $12$ 个内部运动模式，后者即为沙漏模式。\n\n这 $12$ 个矢量值沙漏模式可以从第一部分推导出的 $4$ 个标量模式系统地枚举出来。每个标量模式可以应用于三个笛卡尔位移分量（$x$、$y$ 或 $z$）中的任意一个，而其他两个分量在所有节点上均为零。\n设 $\\boldsymbol{e}_x, \\boldsymbol{e}_y, \\boldsymbol{e}_z$ 为标准笛卡尔基向量。这 $12$ 个由其节点位移向量 $\\boldsymbol{u}_a$ 描述的矢量沙漏模式是：\n\\begin{enumerate}\n    \\item 4 个 $x$ 分量模式：$\\{\\boldsymbol{u}_a = h^{\\alpha}_a \\boldsymbol{e}_x\\}_{a=1}^8$，其中 $\\alpha \\in \\{1,2,3,4\\}$。\n    \\item 4 个 $y$ 分量模式：$\\{\\boldsymbol{u}_a = h^{\\alpha}_a \\boldsymbol{e}_y\\}_{a=1}^8$，其中 $\\alpha \\in \\{1,2,3,4\\}$。\n    \\item 4 个 $z$ 分量模式：$\\{\\boldsymbol{u}_a = h^{\\alpha}_a \\boldsymbol{e}_z\\}_{a=1}^8$，其中 $\\alpha \\in \\{1,2,3,4\\}$。\n\\end{enumerate}\n这构成了沙漏模式子空间的一个由 $4 \\times 3 = 12$ 个线性无关向量组成的基。\n\n**第三部分：特定沙漏模式的位移场**\n\n我们被要求构造对应于具有标量模式 $h^{4}_a = \\xi_a \\eta_a \\zeta_a$ 的笛卡尔 $x$ 分量的位移场。节点位移由 $\\boldsymbol{u}_a = (\\alpha h^4_a, 0, 0) = (\\alpha \\xi_a \\eta_a \\zeta_a, 0, 0)$ 给出，其中 $\\alpha$ 是一个标量振幅。\n位移场 $\\boldsymbol{u}(\\xi,\\eta,\\zeta)$ 通过插值得到：\n$$\n\\boldsymbol{u}(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) \\boldsymbol{u}_a\n$$\n$y$ 和 $z$ 分量为零。$x$ 分量为：\n$$\nu_x(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) (\\alpha \\xi_a \\eta_a \\zeta_a) = \\alpha \\sum_{a=1}^{8} \\frac{1}{8}(1+\\xi_a \\xi)(1+\\eta_a \\eta)(1+\\zeta_a \\zeta) (\\xi_a \\eta_a \\zeta_a)\n$$\n展开乘积并使用 $\\xi_a^2=\\eta_a^2=\\zeta_a^2=1$：\n$$\nu_x(\\xi,\\eta,\\zeta) = \\frac{\\alpha}{8} \\sum_{a=1}^{8} (\\xi_a\\eta_a\\zeta_a + \\eta_a\\zeta_a \\xi + \\xi_a\\zeta_a \\eta + \\xi_a\\eta_a \\zeta + \\zeta_a \\xi\\eta + \\xi_a \\eta\\zeta + \\eta_a \\xi\\zeta + \\xi\\eta\\zeta)\n$$\n对所有 $8$ 个节点（$a=1, \\dots, 8$）求和时，所有涉及一个或两个不同坐标符号乘积的项之和为零（例如，$\\sum_a \\xi_a = 0$，$\\sum_a \\xi_a\\eta_a = 0$）。甚至 $\\sum_a \\xi_a\\eta_a\\zeta_a$ 项也为零。唯一和不为零的项是最后一项 $\\xi\\eta\\zeta$，它相对于求和索引 $a$ 是一个常数：\n$$\n\\sum_{a=1}^{8} \\xi\\eta\\zeta = 8\\xi\\eta\\zeta\n$$\n将此代入 $u_x$ 的表达式中：\n$$\nu_x(\\xi,\\eta,\\zeta) = \\frac{\\alpha}{8} (8 \\xi\\eta\\zeta) = \\alpha \\xi\\eta\\zeta\n$$\n因此，激发这单个沙漏模式的位移场是 $\\boldsymbol{u}(\\xi,\\eta,\\zeta) = (\\alpha \\xi\\eta\\zeta, 0, 0)$。\n相应的节点位移为 $\\boldsymbol{u}_a = (\\alpha \\xi_a\\eta_a\\zeta_a, 0, 0)$。\n\n**第四部分：振幅 $\\alpha$ 的计算**\n\n我们必须找到振幅 $\\alpha$，使得沙漏能量 $E_h$ 等于目标值 $E_h^{\\star} = 1.5\\,\\text{kJ} = 1500\\,\\text{J}$。\n沙漏能量由 $E_{h} = \\beta\\, G\\, \\frac{V}{\\ell^2}\\, q^{2}$ 给出。\n参数为 $\\beta = 0.25$ 和 $G = 25 \\times 10^{6}\\,\\text{Pa}$。\n我们需要计算单元体积 $V$、特征长度的平方 $\\ell^2$ 和沙漏度量 $q$。\n\n雅可比矩阵为 $\\boldsymbol{J} = \\begin{pmatrix} 1.2  0.3  0 \\\\ 0.1  0.9  0.2 \\\\ 0  0.25  1.1 \\end{pmatrix}$。\n单元体积 $V$ 由 $V \\approx 8\\,\\det(\\boldsymbol{J})$ 近似。\n$$\n\\det(\\boldsymbol{J}) = 1.2(0.9 \\cdot 1.1 - 0.2 \\cdot 0.25) - 0.3(0.1 \\cdot 1.1 - 0.2 \\cdot 0) = 1.2(0.99 - 0.05) - 0.3(0.11) = 1.2(0.94) - 0.033 = 1.128 - 0.033 = 1.095\n$$\n所以，$V = 8 \\times 1.095 = 8.76\\,\\text{m}^3$。\n\n特征长度的平方 $\\ell^2$ 为 $\\ell^2 = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{J}^{T}\\boldsymbol{J})$。$\\boldsymbol{J}^{T}\\boldsymbol{J}$ 的迹是 $\\boldsymbol{J}$ 的列向量的平方范数之和。\n\\begin{align*}\n\\operatorname{tr}(\\boldsymbol{J}^{T}\\boldsymbol{J}) = \\sum_{j=1}^{3} \\sum_{i=1}^{3} (J_{ij})^2 \\\\\n= (1.2^2 + 0.1^2 + 0^2) + (0.3^2 + 0.9^2 + 0.25^2) + (0^2 + 0.2^2 + 1.1^2) \\\\\n= (1.44 + 0.01) + (0.09 + 0.81 + 0.0625) + (0.04 + 1.21) \\\\\n= 1.45 + 0.9625 + 1.25 = 3.6625 \\,\\text{m}^2\n\\end{align*}\n所以，$\\ell^2 = \\frac{3.6625}{3} \\,\\text{m}^2 \\approx 1.22083\\,\\text{m}^2$。\n\n沙漏度量 $q$ 是 $q = \\frac{1}{8}\\sum_{a=1}^{8} h^{4}_a\\, u_{a,x}$。对于所选模式，$u_{a,x} = \\alpha h^4_a$。\n$$\nq = \\frac{1}{8}\\sum_{a=1}^{8} h^{4}_a (\\alpha h^4_a) = \\frac{\\alpha}{8}\\sum_{a=1}^{8} (h^{4}_a)^2\n$$\n因为 $h^4_a \\in \\{-1, +1\\}$，所以 $(h^4_a)^2 = 1$。因此，$\\sum_{a=1}^{8} (h^4_a)^2 = 8$。\n这可以简化为 $q = \\frac{\\alpha}{8} \\cdot 8 = \\alpha$。\n\n现在我们将能量方程设置为目标值，并求解 $\\alpha$：\n$$\nE_h^{\\star} = \\beta\\, G\\, \\frac{V}{\\ell^2}\\, \\alpha^2\n$$\n$$\n1500 = 0.25 \\times (25 \\times 10^6) \\times \\frac{8.76}{3.6625/3} \\times \\alpha^2\n$$\n$$\n1500 = (6.25 \\times 10^6) \\times \\frac{8.76 \\times 3}{3.6625} \\times \\alpha^2\n$$\n$$\n1500 \\approx (6.25 \\times 10^6) \\times (7.17547) \\times \\alpha^2\n$$\n$$\n1500 \\approx (4.484669 \\times 10^7) \\times \\alpha^2\n$$\n求解 $\\alpha^2$：\n$$\n\\alpha^2 = \\frac{1500}{4.484669 \\times 10^7} \\approx 3.344699 \\times 10^{-5} \\,\\text{m}^2\n$$\n取平方根以找到振幅 $\\alpha$：\n$$\n\\alpha = \\sqrt{3.344699 \\times 10^{-5}} \\approx 0.00578333\\,\\text{m}\n$$\n四舍五入到四位有效数字，所需振幅为 $\\alpha = 0.005783\\,\\text{m}$。",
            "answer": "$$\n\\boxed{0.005783}\n$$"
        }
    ]
}