{
    "hands_on_practices": [
        {
            "introduction": "Before deploying any physical model, we must first understand the fundamental properties of its constituent parameters. This exercise uses dimensional analysis, a cornerstone of physics and engineering, to determine the physical units of the Rayleigh damping coefficients, $\\alpha$ and $\\beta$. A firm grasp of these dimensions is essential for the correct implementation and interpretation of the model, and it forms the basis for performing similitude studies, such as those used in centrifuge modeling in geotechnical engineering .",
            "id": "3515220",
            "problem": "A linear elastodynamic finite element model of a saturated soil deposit is used to simulate seismic response. The semidiscrete equations of motion in physical coordinates are of the form\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{f}(t),\n$$\nwhere $\\mathbf{M}$ is the mass matrix, $\\mathbf{C}$ is the damping matrix, $\\mathbf{K}$ is the stiffness matrix, and $\\mathbf{u}(t)$ is the displacement vector. In this model, the damping matrix is constructed using a Rayleigh-type linear combination of the mass and stiffness matrices with scalar coefficients $\\alpha$ and $\\beta$. You are given the standard International System of Units (SI) for the assembled matrices: $[\\mathbf{M}]=\\mathrm{kg}$, $[\\mathbf{K}]=\\mathrm{N/m}$, and $[\\mathbf{C}]=\\mathrm{N\\,s/m}$.\n\n(a) From these SI units and the requirement that each term in the equations of motion has consistent physical dimensions, determine the powers of time in the fundamental time dimension symbol $T$ for the Rayleigh coefficients, i.e., find $p_{\\alpha}$ and $p_{\\beta}$ such that $[\\alpha]=T^{p_{\\alpha}}$ and $[\\beta]=T^{p_{\\beta}}$.\n\n(b) Consider a similitude study between a prototype and a scaled model in which all geometric and material similitude conditions are satisfied so that the dimensionless equations of motion are invariant, and assume that model time $t_{\\mathrm{m}}$ relates to prototype time $t_{\\mathrm{p}}$ by a prescribed time scale factor $\\lambda_{t}=t_{\\mathrm{m}}/t_{\\mathrm{p}}$. Using only dimensional consistency and the invariance of the dimensionless governing equations, express the ratios $\\alpha_{\\mathrm{m}}/\\alpha_{\\mathrm{p}}$ and $\\beta_{\\mathrm{m}}/\\beta_{\\mathrm{p}}$ as functions of $\\lambda_{t}$.\n\nYour final answer must be a single row matrix containing four entries in the order $\\left(p_{\\alpha},\\,p_{\\beta},\\,\\alpha_{\\mathrm{m}}/\\alpha_{\\mathrm{p}},\\,\\beta_{\\mathrm{m}}/\\beta_{\\mathrm{p}}\\right)$. No numerical rounding is required, and do not include units in your final answer.",
            "solution": "This problem consists of two parts. The first part requires a dimensional analysis of the Rayleigh damping coefficients $\\alpha$ and $\\beta$. The second part requires determining the scaling relations for these coefficients in a similitude study.\n\nPart (a): Determination of the powers of time for $\\alpha$ and $\\beta$.\n\nThe analysis begins with the semidiscrete equation of motion for a linear elastodynamic system:\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{f}(t)\n$$\nFor this equation to be physically consistent, every term must have the same physical dimensions, which must be that of force. Let us denote the fundamental dimensions of mass, length, and time by $M$, $L$, and $T$, respectively. The dimension of force is $[F] = M L T^{-2}$.\n\nThe dimensions of the kinematic quantities are:\n- Displacement $[\\mathbf{u}] = L$\n- Velocity $[\\dot{\\mathbf{u}}] = \\frac{d}{dt}[\\mathbf{u}] = L T^{-1}$\n- Acceleration $[\\ddot{\\mathbf{u}}] = \\frac{d^2}{dt^2}[\\mathbf{u}] = L T^{-2}$\n\nFrom the problem statement, we are given the SI units of the assembled matrices. We can convert these to fundamental dimensions:\n- Mass matrix $[\\mathbf{M}] = \\mathrm{kg}$, which corresponds to the dimension of mass, so $[\\mathbf{M}] = M$.\n- Stiffness matrix $[\\mathbf{K}] = \\mathrm{N/m}$. The Newton ($N$) is the unit of force, so its dimension is $M L T^{-2}$. The meter ($m$) is the unit of length, dimension $L$. Thus, $[\\mathbf{K}] = \\frac{M L T^{-2}}{L} = M T^{-2}$.\n- Damping matrix $[\\mathbf{C}] = \\mathrm{N\\,s/m}$. The second ($s$) is the unit of time, dimension $T$. Thus, $[\\mathbf{C}] = \\frac{(M L T^{-2}) T}{L} = M T^{-1}$.\n\nWe can verify that each term in the equation of motion has dimensions of force:\n- $[\\mathbf{M}\\,\\ddot{\\mathbf{u}}] = [\\mathbf{M}][\\ddot{\\mathbf{u}}] = M \\cdot (L T^{-2}) = M L T^{-2}$.\n- $[\\mathbf{C}\\,\\dot{\\mathbf{u}}] = [\\mathbf{C}][\\dot{\\mathbf{u}}] = (M T^{-1}) \\cdot (L T^{-1}) = M L T^{-2}$.\n- $[\\mathbf{K}\\,\\mathbf{u}}] = [\\mathbf{K}][\\mathbf{u}] = (M T^{-2}) \\cdot L = M L T^{-2}$.\nAll terms are dimensionally consistent with force, as expected.\n\nThe damping matrix $\\mathbf{C}$ is defined by the Rayleigh damping model:\n$$\n\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}\n$$\nAccording to the principle of dimensional homogeneity, all terms in a sum must have the same dimensions. Therefore, the dimension of $\\mathbf{C}$ must be equal to the dimension of $\\alpha\\mathbf{M}$ and also equal to the dimension of $\\beta\\mathbf{K}$.\n$$\n[\\mathbf{C}] = [\\alpha \\mathbf{M}] = [\\alpha][\\mathbf{M}]\n$$\n$$\n[\\mathbf{C}] = [\\beta \\mathbf{K}] = [\\beta][\\mathbf{K}]\n$$\nWe can solve for the dimensions of $\\alpha$ and $\\beta$:\nFor $\\alpha$:\n$$\n[\\alpha] = \\frac{[\\mathbf{C}]}{[\\mathbf{M}]} = \\frac{M T^{-1}}{M} = T^{-1}\n$$\nThe problem defines $[\\alpha] = T^{p_{\\alpha}}$. By comparison, we find $p_{\\alpha} = -1$.\n\nFor $\\beta$:\n$$\n[\\beta] = \\frac{[\\mathbf{C}]}{[\\mathbf{K}]} = \\frac{M T^{-1}}{M T^{-2}} = T^{1} = T\n$$\nThe problem defines $[\\beta] = T^{p_{\\beta}}$. By comparison, we find $p_{\\beta} = 1$.\n\nPart (b): Determination of the scaling ratios for $\\alpha$ and $\\beta$.\n\nThis part involves a similitude study comparing a prototype (subscript $p$) and a scaled model (subscript $m$). The key principle is the invariance of the dimensionless governing equations. We are given the time scale factor $\\lambda_t = t_m / t_p$.\n\nLet us make the equation of motion dimensionless with respect to time. We can rewrite the equation by dividing through by the mass matrix $\\mathbf{M}$:\n$$\n\\ddot{\\mathbf{u}} + \\mathbf{M}^{-1}(\\alpha\\mathbf{M} + \\beta\\mathbf{K})\\dot{\\mathbf{u}} + \\mathbf{M}^{-1}\\mathbf{K}\\mathbf{u} = \\mathbf{M}^{-1}\\mathbf{f}\n$$\n$$\n\\ddot{\\mathbf{u}} + (\\alpha\\mathbf{I} + \\beta\\mathbf{M}^{-1}\\mathbf{K})\\dot{\\mathbf{u}} + (\\mathbf{M}^{-1}\\mathbf{K})\\mathbf{u} = \\mathbf{M}^{-1}\\mathbf{f}\n$$\nwhere $\\mathbf{I}$ is the identity matrix. Let $T_{char}$ be a characteristic time. We define a dimensionless time variable $t^* = t/T_{char}$. The time derivatives transform as:\n$$\n\\dot{\\mathbf{u}} = \\frac{d\\mathbf{u}}{dt} = \\frac{d\\mathbf{u}}{dt^*} \\frac{dt^*}{dt} = \\frac{1}{T_{char}} \\frac{d\\mathbf{u}}{dt^*}\n$$\n$$\n\\ddot{\\mathbf{u}} = \\frac{d^2\\mathbf{u}}{dt^2} = \\frac{1}{T_{char}^2} \\frac{d^2\\mathbf{u}}{dt^{*2}}\n$$\nSubstituting these into the equation and multiplying by $T_{char}^2$ yields:\n$$\n\\frac{d^2\\mathbf{u}}{dt^{*2}} + T_{char}(\\alpha\\mathbf{I} + \\beta\\mathbf{M}^{-1}\\mathbf{K})\\frac{d\\mathbf{u}}{dt^*} + T_{char}^2(\\mathbf{M}^{-1}\\mathbf{K})\\mathbf{u} = T_{char}^2\\mathbf{M}^{-1}\\mathbf{f}\n$$\nThe dimensionless groups are the coefficients of the derivative terms. Let's inspect the damping term's coefficient matrix:\n$$\n\\mathbf{D}^* = T_{char}(\\alpha\\mathbf{I} + \\beta\\mathbf{M}^{-1}\\mathbf{K}) = (\\alpha T_{char})\\mathbf{I} + (\\beta/T_{char})(T_{char}^2\\mathbf{M}^{-1}\\mathbf{K})\n$$\nThe term $\\Pi_{\\alpha} = \\alpha T_{char}$ is a dimensionless number, as $[\\alpha T_{char}] = T^{-1} \\cdot T = T^0$.\nThe term $\\Pi_{\\beta} = \\beta / T_{char}$ is also a dimensionless number, as $[\\beta / T_{char}] = T \\cdot T^{-1} = T^0$.\nThe matrix $T_{char}^2(\\mathbf{M}^{-1}\\mathbf{K})$ is also dimensionless, as $[T_{char}^2(\\mathbf{M}^{-1}\\mathbf{K})] = T^2 \\cdot (M^{-1} \\cdot MT^{-2}) = T^2 \\cdot T^{-2} = T^0$.\n\nFor the dimensionless equations of motion to be invariant, these dimensionless numbers ($\\Pi$) must be identical for the prototype and the model.\n$$\n\\Pi_{\\alpha, m} = \\Pi_{\\alpha, p} \\implies \\alpha_m T_{char, m} = \\alpha_p T_{char, p}\n$$\n$$\n\\Pi_{\\beta, m} = \\Pi_{\\beta, p} \\implies \\frac{\\beta_m}{T_{char, m}} = \\frac{\\beta_p}{T_{char, p}}\n$$\nThe characteristic times must scale with the time variables, so $\\frac{T_{char, m}}{T_{char, p}} = \\lambda_t$.\n\nFrom the first invariance condition for $\\alpha$:\n$$\n\\frac{\\alpha_m}{\\alpha_p} = \\frac{T_{char, p}}{T_{char, m}} = \\left(\\frac{T_{char, m}}{T_{char, p}}\\right)^{-1} = \\lambda_t^{-1}\n$$\n\nFrom the second invariance condition for $\\beta$:\n$$\n\\frac{\\beta_m}{\\beta_p} = \\frac{T_{char, m}}{T_{char, p}} = \\lambda_t\n$$\n\nThe four required quantities are $p_{\\alpha}$, $p_{\\beta}$, $\\alpha_m/\\alpha_p$, and $\\beta_m/\\beta_p$.\nCombining our results:\n- $p_{\\alpha} = -1$\n- $p_{\\beta} = 1$\n- $\\alpha_m/\\alpha_p = \\lambda_t^{-1}$\n- $\\beta_m/\\beta_p = \\lambda_t$\n\nThe final answer is presented as a single row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1 & 1 & \\lambda_t^{-1} & \\lambda_t \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A common task in computational geomechanics is to calibrate a numerical model to reproduce a desired level of energy dissipation at specific, important frequencies. For instance, an analyst may need to match the damping ratio observed at the first few natural frequencies of a soil deposit. This exercise provides hands-on practice in the classic two-point calibration of Rayleigh damping, where the coefficients $\\alpha$ and $\\beta$ are determined by enforcing a target damping ratio at two distinct frequencies . This process illuminates the key feature of the model: damping is frequency-dependent, and a perfect match is typically only possible at the two chosen points.",
            "id": "3515209",
            "problem": "A vertically propagating shear-wave soil column is modeled using the linear elastodynamic equation of motion in the time domain, with proportional damping constructed as a linear combination of the mass matrix and the stiffness matrix. Consider the finite element semi-discrete system with displacement vector $u(t)$, mass matrix $M$, stiffness matrix $K$, and damping matrix $C$, and assume classical proportional damping in the form of a Rayleigh model. The modal damping ratio $\\xi$ is defined for each mode through the single-degree-of-freedom reduction of the equations of motion in modal coordinates. The soil column is tuned so that the first two natural modes, with frequencies $f_{1}=3\\,\\mathrm{Hz}$ and $f_{2}=9\\,\\mathrm{Hz}$, both have modal damping ratio $\\xi=0.05$ under this Rayleigh damping assumption. Using the angular frequency definition $\\omega=2\\pi f$, determine the two Rayleigh coefficients $\\alpha$ and $\\beta$ that achieve this tuning. Then, compute the resulting damping ratios at $f=0.5\\,\\mathrm{Hz}$ and $f=30\\,\\mathrm{Hz}$ implied by these coefficients.\n\nProvide all four results as exact analytic expressions without rounding. Express $\\alpha$ in $\\mathrm{s}^{-1}$, $\\beta$ in $\\mathrm{s}$, and the damping ratios $\\xi$ as dimensionless decimals or fractions. In your final boxed answer, list the four quantities in the order $\\alpha$, $\\beta$, $\\xi(f=0.5\\,\\mathrm{Hz})$, $\\xi(f=30\\,\\mathrm{Hz})$.",
            "solution": "The relationship between the modal damping ratio $\\xi_n$ and the modal angular frequency $\\omega_n$ for a system with Rayleigh damping is given by:\n$$ \\xi_n = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega_n} + \\beta\\omega_n \\right) $$\nwhere $\\alpha$ and $\\beta$ are the Rayleigh damping coefficients.\n\nFirst, we convert the given frequencies $f_1$ and $f_2$ into angular frequencies $\\omega_1$ and $\\omega_2$ using the formula $\\omega = 2\\pi f$:\n$$ \\omega_1 = 2\\pi f_1 = 2\\pi (3\\,\\mathrm{Hz}) = 6\\pi\\,\\mathrm{rad/s} $$\n$$ \\omega_2 = 2\\pi f_2 = 2\\pi (9\\,\\mathrm{Hz}) = 18\\pi\\,\\mathrm{rad/s} $$\n\nWe are given that the damping ratio is $\\xi = 0.05$ for both of these modes. This provides a system of two linear equations for the two unknowns $\\alpha$ and $\\beta$:\n$$ 0.05 = \\frac{1}{2} \\left( \\frac{\\alpha}{6\\pi} + \\beta(6\\pi) \\right) \\quad \\text{(1)} $$\n$$ 0.05 = \\frac{1}{2} \\left( \\frac{\\alpha}{18\\pi} + \\beta(18\\pi) \\right) \\quad \\text{(2)} $$\n\nMultiplying both equations by $2$ gives:\n$$ 0.10 = \\frac{\\alpha}{6\\pi} + 6\\pi\\beta $$\n$$ 0.10 = \\frac{\\alpha}{18\\pi} + 18\\pi\\beta $$\n\nThis is a linear system in $\\alpha$ and $\\beta$. For two frequencies $\\omega_i$ and $\\omega_j$ with the same damping ratio $\\xi$, the general solution for $\\alpha$ and $\\beta$ is:\n$$ \\alpha = \\frac{2\\xi \\omega_i \\omega_j}{\\omega_i + \\omega_j} $$\n$$ \\beta = \\frac{2\\xi}{\\omega_i + \\omega_j} $$\n\nNow, we substitute $\\xi=0.05$, $\\omega_1=6\\pi$, and $\\omega_2=18\\pi$ into these formulas. For $\\beta$:\n$$ \\beta = \\frac{2(0.05)}{6\\pi + 18\\pi} = \\frac{0.1}{24\\pi} = \\frac{1}{240\\pi}\\,\\mathrm{s} $$\nFor $\\alpha$:\n$$ \\alpha = \\frac{2(0.05)(6\\pi)(18\\pi)}{6\\pi + 18\\pi} = \\frac{0.1 \\cdot 108\\pi^2}{24\\pi} = \\frac{10.8\\pi}{24} = \\frac{108\\pi}{240} = \\frac{9\\pi}{20}\\,\\mathrm{s}^{-1} $$\nSo, the Rayleigh coefficients are $\\alpha = \\frac{9\\pi}{20}$ and $\\beta = \\frac{1}{240\\pi}$.\n\nNext, we compute the damping ratios at $f_3 = 0.5\\,\\mathrm{Hz}$ and $f_4 = 30\\,\\mathrm{Hz}$.\nFirst, we find the corresponding angular frequencies:\n$$ \\omega_3 = 2\\pi f_3 = 2\\pi (0.5) = \\pi\\,\\mathrm{rad/s} $$\n$$ \\omega_4 = 2\\pi f_4 = 2\\pi (30) = 60\\pi\\,\\mathrm{rad/s} $$\n\nNow, we use the damping ratio formula $\\xi(\\omega) = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega} + \\beta\\omega \\right)$ with our calculated $\\alpha$ and $\\beta$.\n\nFor $f_3 = 0.5\\,\\mathrm{Hz}$ ($\\omega_3 = \\pi$):\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9\\pi/20}{\\pi} + \\frac{1}{240\\pi} \\cdot \\pi \\right) = \\frac{1}{2} \\left( \\frac{9}{20} + \\frac{1}{240} \\right) = \\frac{1}{2} \\left( \\frac{108}{240} + \\frac{1}{240} \\right) = \\frac{1}{2} \\left( \\frac{109}{240} \\right) = \\frac{109}{480} $$\n\nFor $f_4 = 30\\,\\mathrm{Hz}$ ($\\omega_4 = 60\\pi$):\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9\\pi/20}{60\\pi} + \\frac{1}{240\\pi} \\cdot 60\\pi \\right) = \\frac{1}{2} \\left( \\frac{9}{1200} + \\frac{60}{240} \\right) = \\frac{1}{2} \\left( \\frac{9}{1200} + \\frac{300}{1200} \\right) = \\frac{1}{2} \\left( \\frac{309}{1200} \\right) = \\frac{309}{2400} = \\frac{103}{800} $$\n\nThe four required quantities are:\n1.  $\\alpha = \\frac{9\\pi}{20}$\n2.  $\\beta = \\frac{1}{240\\pi}$\n3.  $\\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{109}{480}$\n4.  $\\xi(f=30\\,\\mathrm{Hz}) = \\frac{103}{800}$",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{9\\pi}{20} & \\frac{1}{240\\pi} & \\frac{109}{480} & \\frac{103}{800} \\end{pmatrix}} $$"
        },
        {
            "introduction": "While matching damping at two points is instructive, real material behavior and broadband seismic loads often necessitate a more robust approach. The simple frequency-dependence of Rayleigh damping, $\\zeta(\\omega) = \\frac{\\alpha}{2\\omega} + \\frac{\\beta\\omega}{2}$, can rarely capture the complex, often non-monotonic, damping characteristics of soils across a wide frequency range. This advanced practice introduces a powerful optimization technique: finding the Rayleigh coefficients that provide the best possible fit to a target damping curve over a continuous frequency band by minimizing the integrated squared error . This exercise reflects the practical reality of engineering modeling, where the goal is not a perfect match but the best approximation, and it introduces formal methods for quantifying the resulting model error.",
            "id": "3515294",
            "problem": "A continuum soil specimen is represented in a discrete form by a second-order linear dynamical system governed by the equation of motion $M\\ddot{u} + C\\dot{u} + Ku = f_{\\text{ext}}$, where $M$ is the mass matrix, $K$ is the stiffness matrix, $C$ is the damping matrix, $u$ is the displacement vector, and $f_{\\text{ext}}$ is the external force vector. Assume a classical Rayleigh damping model in which $C = \\alpha M + \\beta K$, where real scalars $\\alpha$ and $\\beta$ are to be determined. Consider linear free-vibration and modal analysis assumptions standard in computational geomechanics.\n\nDefine the target soil damping ratio curve $\\zeta_{\\text{target}}(\\omega)$ as a scalar function of circular frequency $\\omega$ (in $\\mathrm{rad/s}$), representing small-strain cyclic test observations for the soil. Over a frequency band $[\\omega_L,\\omega_H]$, determine the Rayleigh damping parameters ($\\alpha,\\beta$) (with $\\alpha$ in $\\mathrm{s^{-1}}$ and $\\beta$ in $\\mathrm{s}$) that minimize the squared error functional\n$$\nJ(\\alpha,\\beta) = \\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega,\n$$\nwhere $\\zeta_{\\text{Rayleigh}}(\\omega)$ is the modal damping ratio implied by the Rayleigh damping model under standard modal reduction. You must derive $\\zeta_{\\text{Rayleigh}}(\\omega)$ starting from the equation of motion, the definition of Rayleigh damping, and the modal relations between effective modal mass and stiffness for an undamped mode of circular frequency $\\omega$.\n\nFor the optimal ($\\alpha,\\beta$), additionally compute the equal-contribution frequency\n$$\n\\omega_{\\mathrm{eq}} = \\sqrt{\\frac{\\alpha}{\\beta}},\n$$\nin $\\mathrm{rad/s}$, defined as the frequency at which the mass-proportional and stiffness-proportional components contribute equally to the Rayleigh modal damping ratio. If $\\alpha \\le 0$ or $\\beta \\le 0$, set $\\omega_{\\mathrm{eq}}$ to not-a-number.\n\nAlso quantify the quality of fit by computing:\n- The root-mean-square error over the band,\n$$\ne_{\\mathrm{rms}} = \\sqrt{\\frac{1}{\\omega_H-\\omega_L}\\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega},\n$$\ndimensionless.\n- The maximum absolute error over the band, defined as the supremum of $\\left|\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right|$ for $\\omega \\in [\\omega_L,\\omega_H]$, approximated numerically on a sufficiently fine grid, dimensionless.\n\nYour program must implement the minimization analytically via the normal equations arising from least-squares projection of $\\zeta_{\\text{target}}(\\omega)$ onto the span of the frequency-dependent Rayleigh basis functions implied by the derivation, and must evaluate the necessary integrals numerically with adequate accuracy.\n\nUse the following test suite. For each case, the target damping curve and the frequency band are specified. All damping ratios are dimensionless; all frequencies are in $\\mathrm{rad/s}$.\n\n- Case 1 (baseline constant target, broad band):\n  - $\\zeta_{\\text{target}}(\\omega) = 0.05$,\n  - $\\omega_L = 1$, $\\omega_H = 100$.\n- Case 2 (monotone increasing saturation target, medium band):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_0 + (\\zeta_\\infty - \\zeta_0)\\frac{\\omega}{\\omega + \\omega_c}$, with $\\zeta_0 = 0.02$, $\\zeta_\\infty = 0.08$, $\\omega_c = 30$,\n  - $\\omega_L = 5$, $\\omega_H = 100$.\n- Case 3 (peaked target, broad-low band):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_{\\text{base}} + \\zeta_{\\text{amp}}\\frac{\\omega}{\\omega_p}\\exp\\!\\left(1 - \\frac{\\omega}{\\omega_p}\\right)$, with $\\zeta_{\\text{base}} = 0.02$, $\\zeta_{\\text{amp}} = 0.06$, $\\omega_p = 20$,\n  - $\\omega_L = 1$, $\\omega_H = 50$.\n- Case 4 (narrow band, mildly varying target):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_0 + \\frac{\\beta}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^2}$, with $\\zeta_0 = 0.03$, $\\beta = 0.04$, $\\omega_c = 21$,\n  - $\\omega_L = 20$, $\\omega_H = 22$.\n\nFor each test case, your program must:\n- Derive and use $\\zeta_{\\text{Rayleigh}}(\\omega)$ based on fundamental relations,\n- Compute the optimal ($\\alpha,\\beta$) in $\\mathrm{s^{-1}}$ and $\\mathrm{s}$, respectively,\n- Compute $\\omega_{\\mathrm{eq}}$ in $\\mathrm{rad/s}$ (set to not-a-number if $\\alpha \\le 0$ or $\\beta \\le 0$),\n- Compute $e_{\\mathrm{rms}}$ (dimensionless),\n- Compute the maximum absolute error over $[\\omega_L,\\omega_H]$ (dimensionless).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, concatenating the five values per case in the following order:\n$$\n[\\alpha^{(1)}, \\beta^{(1)}, \\omega_{\\mathrm{eq}}^{(1)}, e_{\\mathrm{rms}}^{(1)}, e_{\\max}^{(1)}, \\alpha^{(2)}, \\beta^{(2)}, \\omega_{\\mathrm{eq}}^{(2)}, e_{\\mathrm{rms}}^{(2)}, e_{\\max}^{(2)}, \\alpha^{(3)}, \\beta^{(3)}, \\omega_{\\mathrm{eq}}^{(3)}, e_{\\mathrm{rms}}^{(3)}, e_{\\max}^{(3)}, \\alpha^{(4)}, \\beta^{(4)}, \\omega_{\\mathrm{eq}}^{(4)}, e_{\\mathrm{rms}}^{(4)}, e_{\\max}^{(4)}],\n$$\nwhere superscripts denote the case number. All $\\alpha$ entries must be in $\\mathrm{s^{-1}}$, all $\\beta$ entries in $\\mathrm{s}$, all $\\omega_{\\mathrm{eq}}$ entries in $\\mathrm{rad/s}$, and all errors must be dimensionless. Angles (frequencies) are in radians per second. The final numeric outputs must be floats. If a case yields $\\alpha \\le 0$ or $\\beta \\le 0$, print $\\mathrm{NaN}$ for $\\omega_{\\mathrm{eq}}$ for that case.",
            "solution": "The problem requires the determination of optimal Rayleigh damping parameters ($\\alpha, \\beta$) by minimizing the integrated squared error between a target damping ratio curve $\\zeta_{\\text{target}}(\\omega)$ and the Rayleigh damping curve $\\zeta_{\\text{Rayleigh}}(\\omega)$ over a specified frequency band $[\\omega_L, \\omega_H]$. This is a classical least-squares problem in the context of structural dynamics.\n\nFirst, we must derive the expression for the Rayleigh modal damping ratio, $\\zeta_{\\text{Rayleigh}}(\\omega)$. The equation of motion for a linear multi-degree-of-freedom system is given as $M\\ddot{u} + C\\dot{u} + Ku = f_{\\text{ext}}$. Under the assumption of linear free-vibration and modal analysis, we consider the undamped eigenvalue problem, $K\\phi_i = \\omega_i^2 M\\phi_i$, where $\\omega_i$ is the $i$-th natural circular frequency and $\\phi_i$ is the corresponding mode shape.\n\nBy applying modal transformation $u(t) = \\sum_i \\phi_i q_i(t)$, and leveraging the orthogonality of mode shapes with respect to the mass and stiffness matrices, the system of coupled equations decouples into a set of independent SDOF (single-degree-of-freedom) equations, one for each mode $i$:\n$$\nM_i \\ddot{q}_i(t) + C_i \\dot{q}_i(t) + K_i q_i(t) = F_i(t)\n$$\nwhere $M_i = \\phi_i^T M \\phi_i$ is the modal mass, $K_i = \\phi_i^T K \\phi_i$ is the modal stiffness, and $C_i = \\phi_i^T C \\phi_i$ is the modal damping. The modal stiffness and mass are related by $K_i = \\omega_i^2 M_i$.\n\nThe standard form of an SDOF equation is $\\ddot{q}_i + 2\\zeta_i\\omega_i \\dot{q}_i + \\omega_i^2 q_i = F_i/M_i$. By comparing the coefficients, the modal damping ratio $\\zeta_i$ is defined as:\n$$\n\\zeta_i = \\frac{C_i}{2\\omega_i M_i}\n$$\nThe problem specifies a Rayleigh damping matrix $C = \\alpha M + \\beta K$. Substituting this into the expression for the modal damping coefficient $C_i$:\n$$\nC_i = \\phi_i^T (\\alpha M + \\beta K) \\phi_i = \\alpha (\\phi_i^T M \\phi_i) + \\beta (\\phi_i^T K \\phi_i) = \\alpha M_i + \\beta K_i\n$$\nSubstituting $K_i = \\omega_i^2 M_i$, we get $C_i = \\alpha M_i + \\beta (\\omega_i^2 M_i) = (\\alpha + \\beta \\omega_i^2) M_i$.\nNow, we substitute this expression for $C_i$ back into the formula for the modal damping ratio $\\zeta_i$:\n$$\n\\zeta_i = \\frac{(\\alpha + \\beta \\omega_i^2) M_i}{2\\omega_i M_i} = \\frac{\\alpha + \\beta \\omega_i^2}{2\\omega_i} = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta \\omega_i}{2}\n$$\nThe problem considers the damping ratio as a continuous function of frequency $\\omega$, not limited to discrete modal frequencies. Thus, we generalize the modal damping ratio to a function of $\\omega$:\n$$\n\\zeta_{\\text{Rayleigh}}(\\omega) = \\frac{\\alpha}{2\\omega} + \\frac{\\beta \\omega}{2}\n$$\n\nNext, we solve the minimization problem. We need to find the scalars $\\alpha$ and $\\beta$ that minimize the functional $J(\\alpha, \\beta)$:\n$$\nJ(\\alpha, \\beta) = \\int_{\\omega_L}^{\\omega_H} \\left( \\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega) \\right)^2 \\mathrm{d}\\omega = \\int_{\\omega_L}^{\\omega_H} \\left( \\frac{\\alpha}{2\\omega} + \\frac{\\beta\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right)^2 \\mathrm{d}\\omega\n$$\nTo find the minimum, we set the partial derivatives of $J$ with respect to $\\alpha$ and $\\beta$ to zero, which yields the normal equations of the least-squares problem.\n$$\n\\frac{\\partial J}{\\partial \\alpha} = \\int_{\\omega_L}^{\\omega_H} 2 \\left( \\frac{\\alpha}{2\\omega} + \\frac{\\beta\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right) \\left( \\frac{1}{2\\omega} \\right) \\mathrm{d}\\omega = 0\n$$\n$$\n\\frac{\\partial J}{\\partial \\beta} = \\int_{\\omega_L}^{\\omega_H} 2 \\left( \\frac{\\alpha}{2\\omega} + \\frac{\\beta\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right) \\left( \\frac{\\omega}{2} \\right) \\mathrm{d}\\omega = 0\n$$\nSimplifying and rearranging these two equations gives a linear system for ($\\alpha, \\beta$):\n$$\n\\alpha \\left( \\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega \\right) + \\beta \\left( \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\right) = \\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega\n$$\n$$\n\\alpha \\left( \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\right) + \\beta \\left( \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega \\right) = \\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega\n$$\nThis system can be written in matrix form $A \\mathbf{x} = \\mathbf{b}$, where $\\mathbf{x} = [\\alpha, \\beta]^T$:\n$$\n\\begin{bmatrix}\n\\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega & \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\\\\n\\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d\\omega} & \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega\n\\end{bmatrix}\n\\begin{Bmatrix} \\alpha \\\\ \\beta \\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega \\\\\n\\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega\n\\end{Bmatrix}\n$$\nThe integrals forming the coefficient matrix $A$ can be evaluated analytically:\n$A_{11} = \\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega = \\left[-\\frac{1}{\\omega}\\right]_{\\omega_L}^{\\omega_H} = \\frac{1}{\\omega_L} - \\frac{1}{\\omega_H}$\n$A_{12} = A_{21} = \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega = [\\omega]_{\\omega_L}^{\\omega_H} = \\omega_H - \\omega_L$\n$A_{22} = \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega = \\left[\\frac{\\omega^3}{3}\\right]_{\\omega_L}^{\\omega_H} = \\frac{\\omega_H^3 - \\omega_L^3}{3}$\n\nThe integrals on the right-hand side vector $\\mathbf{b}$ involve the target function $\\zeta_{\\text{target}}(\\omega)$ and are computed numerically using quadrature, as they generally do not have simple analytical solutions.\n$b_1 = \\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega$\n$b_2 = \\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega$\n\nThe system $A \\mathbf{x} = \\mathbf{b}$ is solved for $\\mathbf{x} = [\\alpha, \\beta]^T$ to obtain the optimal parameters. Once ($\\alpha, \\beta$) are found, the required metrics are calculated:\n\n1.  The equal-contribution frequency $\\omega_{\\mathrm{eq}}$ is the frequency at which the mass-proportional term $\\frac{\\alpha}{2\\omega}$ and stiffness-proportional term $\\frac{\\beta\\omega}{2}$ are equal.\n    $$\n    \\frac{\\alpha}{2\\omega_{\\mathrm{eq}}} = \\frac{\\beta\\omega_{\\mathrm{eq}}}{2} \\implies \\omega_{\\mathrm{eq}}^2 = \\frac{\\alpha}{\\beta} \\implies \\omega_{\\mathrm{eq}} = \\sqrt{\\frac{\\alpha}{\\beta}}\n    $$\n    This is only defined for $\\alpha > 0$ and $\\beta > 0$. If either is non-positive, $\\omega_{\\mathrm{eq}}$ is set to not-a-number (NaN).\n\n2.  The root-mean-square error $e_{\\mathrm{rms}}$ is given by:\n    $$\n    e_{\\mathrm{rms}} = \\sqrt{\\frac{J(\\alpha, \\beta)}{\\omega_H - \\omega_L}} = \\sqrt{\\frac{1}{\\omega_H-\\omega_L}\\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega}\n    $$\n    The integral is computed numerically using the determined optimal $\\alpha$ and $\\beta$.\n\n3.  The maximum absolute error $e_{\\max}$ is:\n    $$\n    e_{\\max} = \\sup_{\\omega \\in [\\omega_L, \\omega_H]} \\left|\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right|\n    $$\n    This is approximated by evaluating the absolute error on a fine uniform grid of frequencies across the interval $[\\omega_L, \\omega_H]$ and finding the maximum value.\n\nThe implementation will follow these steps, using numerical quadrature for the integrals and a linear algebra solver for the normal equations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes optimal Rayleigh damping parameters and error metrics for a suite of test cases.\n    \"\"\"\n\n    def solve_case(zeta_target_func, omega_L, omega_H):\n        \"\"\"\n        Solves for a single test case.\n\n        Args:\n            zeta_target_func (callable): The target damping ratio function zeta_target(omega).\n            omega_L (float): The lower bound of the frequency band [rad/s].\n            omega_H (float): The upper bound of the frequency band [rad/s].\n\n        Returns:\n            tuple: A 5-tuple containing (a0, a1, omega_eq, e_rms, e_max).\n        \"\"\"\n        # 1. Analytically compute the coefficient matrix A for the normal equations.\n        # A_11 = integral(1/w^2) dw\n        A11 = 1.0 / omega_L - 1.0 / omega_H\n        # A_12 = A_21 = integral(1) dw\n        A12 = omega_H - omega_L\n        A21 = A12\n        # A_22 = integral(w^2) dw\n        A22 = (omega_H**3 - omega_L**3) / 3.0\n        \n        A = np.array([[A11, A12], [A21, A22]])\n\n        # 2. Numerically compute the right-hand side vector b.\n        # Integrands for b1 and b2\n        integrand_b1 = lambda w: 2.0 * zeta_target_func(w) / w\n        integrand_b2 = lambda w: 2.0 * w * zeta_target_func(w)\n\n        b1, _ = quad(integrand_b1, omega_L, omega_H, limit=200)\n        b2, _ = quad(integrand_b2, omega_L, omega_H, limit=200)\n        \n        b = np.array([b1, b2])\n\n        # 3. Solve the linear system A * x = b for x = [a0, a1].\n        try:\n            a0, a1 = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            # This should not happen for valid physical bands [omega_L, omega_H]\n            return (np.nan, np.nan, np.nan, np.nan, np.nan)\n\n        # 4. Calculate the equal-contribution frequency, omega_eq.\n        if a0 > 0 and a1 > 0:\n            omega_eq = np.sqrt(a0 / a1)\n        else:\n            omega_eq = np.nan\n\n        # 5. Define the resulting Rayleigh damping function.\n        zeta_rayleigh_func = lambda w: a0 / (2.0 * w) + a1 * w / 2.0\n\n        # 6. Calculate the root-mean-square error, e_rms.\n        squared_error_integrand = lambda w: (zeta_rayleigh_func(w) - zeta_target_func(w))**2\n        J, _ = quad(squared_error_integrand, omega_L, omega_H, limit=200)\n        e_rms = np.sqrt(J / (omega_H - omega_L))\n        \n        # 7. Calculate the maximum absolute error, e_max, on a fine grid.\n        # Use a sufficiently fine grid for numerical approximation of supremum.\n        num_points = 10001 \n        omega_grid = np.linspace(omega_L, omega_H, num_points)\n        error_values = np.abs(zeta_rayleigh_func(omega_grid) - zeta_target_func(omega_grid))\n        e_max = np.max(error_values)\n\n        return (a0, a1, omega_eq, e_rms, e_max)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"zeta_target\": lambda w: 0.05,\n            \"omega_L\": 1.0,\n            \"omega_H\": 100.0,\n        },\n        {\n            \"zeta_target\": lambda w, z0=0.02, zi=0.08, wc=30.0: z0 + (zi - z0) * w / (w + wc),\n            \"omega_L\": 5.0,\n            \"omega_H\": 100.0,\n        },\n        {\n            \"zeta_target\": lambda w, zb=0.02, za=0.06, wp=20.0: zb + za * (w / wp) * np.exp(1.0 - w / wp),\n            \"omega_L\": 1.0,\n            \"omega_H\": 50.0,\n        },\n        {\n            \"zeta_target\": lambda w, z0=0.03, beta=0.04, wc=21.0: z0 + beta / (1.0 + (w / wc)**2),\n            \"omega_L\": 20.0,\n            \"omega_H\": 22.0,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = solve_case(case[\"zeta_target\"], case[\"omega_L\"], case[\"omega_H\"])\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}