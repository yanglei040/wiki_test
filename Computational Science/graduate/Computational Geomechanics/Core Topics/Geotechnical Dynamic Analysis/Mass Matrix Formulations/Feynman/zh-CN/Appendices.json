{
    "hands_on_practices": [
        {
            "introduction": "在计算动力学中，准确表示系统的惯性是至关重要的第一步。本练习将带您亲手实践，使用标准的有限元方法（FEM）程序——即等参映射和高斯求积——来计算“精确”的二维四边形单元一致质量矩阵。通过将结果与计算成本更低的集总质量矩阵进行对比，您将掌握构建这些基本矩阵的核心计算技能，并理解它们在节点质量分配上的根本差异。这项练习是进行任何计算动力学分析的基础。",
            "id": "3540965",
            "problem": "考虑一个单一的四节点双线性四边形有限元，用于在有限元法 (FEM) 中模拟平面应变下的均质土域。该单元在物理坐标中占据一个矩形，节点位于 $(0,0)$、$(L_{x},0)$、$(L_{x},L_{y})$ 和 $(0,L_{y})$，其中 $L_{x}  0$ 且 $L_{y}  0$。土壤具有均匀的质量密度 $\\rho$ 和均匀的平面外厚度 $b$。令等参母坐标为 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$，并采用标准的双线性形函数\n$$\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta), \\quad\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta), \\quad\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta), \\quad\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta).\n$$\n从动态平衡方程及其 Galerkin 投影开始，确定单元级的一致质量矩阵 $\\mathbf{M}^{\\mathrm{c}}$，其分量为 $M_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho\\, b\\, N_{i}\\, N_{j}\\, \\mathrm{d}\\Omega$，其中 $i,j \\in \\{1,2,3,4\\}$。使用 $2 \\times 2$ 高斯求积法则，其积分点为 $(\\xi,\\eta) = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$，权重均等于 $1$，精确计算该矩形单元的一致质量矩阵 $\\mathbf{M}^{\\mathrm{c}}$。然后，通过定义 $m_{i}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{ij}^{\\mathrm{c}}$ 并形成对角矩阵 $\\mathbf{M}^{\\mathrm{L}} = \\mathrm{diag}(m_{1}^{\\mathrm{L}}, m_{2}^{\\mathrm{L}}, m_{3}^{\\mathrm{L}}, m_{4}^{\\mathrm{L}})$ 来构建行和集中对角质量矩阵。最后，通过计算比值来量化节点质量分布的比较\n$$\nr \\;=\\; \\frac{m_{1}^{\\mathrm{L}}}{M_{11}^{\\mathrm{c}}}.\n$$\n将最终答案表示为一个无单位的精确简化分数。",
            "solution": "用户要求我解决一个计算岩土力学中的问题。\n\n我的计划如下：\n1.  **验证问题陈述。**\n    *   **步骤1：提取已知条件。** 我将列出所有提供的信息：单元类型、几何形状、材料属性、形函数、一致质量矩阵的定义、数值积分方案、集中质量矩阵的定义以及最终要计算的量。\n    *   **步骤2：验证。** 我将检查问题是否具有科学依据、是否适定、客观、完整且不平凡。\n        *   **科学依据：** 该问题涉及标准的有限元法概念（双线性四边形、形函数、一致和集中质量矩阵、高斯求积）。这是计算力学中的教科书材料。\n        *   **适定性：** 该问题要求基于明确定义的量计算一个特定的比率，并提供了清晰的计算路径。存在唯一解。\n        *   **客观性：** 语言技术性强且精确。\n        *   **完整性：** 它提供了所有必要的信息，包括几何形状、形函数、密度、厚度、一致质量矩阵的公式、积分规则和质量集中的定义。\n        *   **现实性：** 这是一个标准的学术问题，用于有限元法的教学和验证。\n    *   **步骤3：结论。** 问题有效。我将继续进行求解。\n\n2.  **解决问题。**\n    *   **第一部分：积分变换。** 我将把一致质量矩阵的积分 $M_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho b N_{i} N_{j} \\mathrm{d}\\Omega$ 从物理域 $\\Omega_e$ 变换到母域 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。这需要计算雅可比行列式 $\\det(\\mathbf{J})$。\n    *   **第二部分：雅可比矩阵计算。** 我将找到坐标变换 $x(\\xi, \\eta)$、$y(\\xi, \\eta)$，然后计算雅可比矩阵 $\\mathbf{J}$ 及其行列式。\n    *   **第三部分：数值积分设置。** 我将在母域中写出 $M_{ij}^{\\mathrm{c}}$ 的积分，并陈述 $2 \\times 2$ 高斯求积的公式。问题指出，对于本案例，这是一种精确方法，这是正确的，因为被积函数在每个变量中是次数最多为 2 的多项式，而 2 点高斯法则对次数最高为 $2 \\times 2 - 1 = 3$ 的多项式是精确的。\n    *   **第四部分：形函数求值。** 我将计算在四个指定的高斯求积点上的形函数值。\n    *   **第五部分：计算 $m_{1}^{\\mathrm{L}}$ 和 $M_{11}^{\\mathrm{c}}$。**\n        *   我将首先定义节点 1 的行和集中质量 $m_{1}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{1j}^{\\mathrm{c}}$。一个关键的简化来自于性质 $\\sum_{j=1}^{4} N_j = 1$。\n        *   我将应用高斯求积公式来计算 $m_{1}^{\\mathrm{L}}$ 和对角项 $M_{11}^{\\mathrm{c}}$。\n    *   **第六部分：最终比率计算。** 我将计算比率 $r = m_{1}^{\\mathrm{L}} / M_{11}^{\\mathrm{c}}$。\n\n我将确保严格遵守所有格式规则，特别是对所有数学实体强制使用 LaTeX。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   单元类型：四节点双线性四边形有限元，用于平面应变。\n-   几何形状：一个矩形，节点位于 $(0,0)$、$(L_{x},0)$、$(L_{x},L_{y})$ 和 $(0,L_{y})$，其中 $L_{x}  0$ 且 $L_{y}  0$。\n-   材料属性：均匀的质量密度 $\\rho$，均匀的平面外厚度 $b$。\n-   母坐标：$(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。\n-   形函数：\n    $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta)$\n    $N_{2}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta)$\n    $N_{3}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta)$\n    $N_{4}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)$\n-   一致质量矩阵定义：$M_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho\\, b\\, N_{i}\\, N_{j}\\, \\mathrm{d}\\Omega$，其中 $i,j \\in \\{1,2,3,4\\}$。\n-   数值积分法则：$2 \\times 2$ 高斯求积，积分点为 $(\\xi,\\eta) = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$，权重均等于 $1$。\n-   集中质量矩阵定义：$m_{i}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{ij}^{\\mathrm{c}}$，形成一个对角矩阵 $\\mathbf{M}^{\\mathrm{L}} = \\mathrm{diag}(m_{1}^{\\mathrm{L}}, m_{2}^{\\mathrm{L}}, m_{3}^{\\mathrm{L}}, m_{4}^{\\mathrm{L}})$。\n-   待计算量：比率 $r = \\frac{m_{1}^{\\mathrm{L}}}{M_{11}^{\\mathrm{c}}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题牢固地基于有限元法 (FEM) 应用于结构或连续介质动力学的标准理论。一致质量矩阵、集中质量矩阵、双线性形函数和高斯求积等概念是计算力学的基石。\n-   **适定性：** 该问题提供了一个清晰的、定量的任务，包含所有必要的数据和定义。步骤逻辑清晰，导向一个唯一的、确定性的结果。\n-   **客观性：** 问题以精确的数学语言陈述，没有任何主观性或歧义。\n-   **完整性：** 问题是自洽的。它提供了几何形状、材料属性、形函数以及要使用的具体数值方法。\n-   **未检测到其他缺陷：** 该问题并非微不足道，需要详细计算。它不是循环论证、自相矛盾或基于不切实际的物理学。\n\n**步骤3：结论与行动**\n问题有效。我将继续进行求解。\n\n### 求解过程\n\n有限元的一致质量矩阵源于虚功原理中的动能项。其分量由下式给出\n$$\nM_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho\\, b\\, N_{i}\\, N_{j}\\, \\mathrm{d}\\Omega\n$$\n其中 $\\rho$ 是质量密度，$b$ 是厚度，$N_i$ 和 $N_j$ 是形函数，积分在单元域 $\\Omega_e$ 上进行。为计算此积分，我们将其变换到等参母域 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。面积微元变换为 $\\mathrm{d}\\Omega = \\det(\\mathbf{J})\\, \\mathrm{d}\\xi\\, \\mathrm{d}\\eta$，其中 $\\mathbf{J}$ 是坐标映射的雅可比矩阵。\n\n物理坐标 $(x,y)$ 通过形函数从母坐标 $(\\xi,\\eta)$ 映射而来：\n$$\nx(\\xi,\\eta) = \\sum_{k=1}^{4} N_{k}(\\xi,\\eta) x_{k} \\quad \\text{和} \\quad y(\\xi,\\eta) = \\sum_{k=1}^{4} N_{k}(\\xi,\\eta) y_{k}\n$$\n节点坐标为 $(x_1, y_1) = (0,0)$、$(x_2, y_2) = (L_x, 0)$、$(x_3, y_3) = (L_x, L_y)$ 和 $(x_4, y_4) = (0, L_y)$。代入这些坐标可得：\n$$\nx(\\xi,\\eta) = N_2(\\xi,\\eta)L_x + N_3(\\xi,\\eta)L_x = \\frac{1}{4}(1+\\xi)(1-\\eta)L_x + \\frac{1}{4}(1+\\xi)(1+\\eta)L_x = \\frac{L_x}{4}(1+\\xi)(1-\\eta+1+\\eta) = \\frac{L_x}{2}(1+\\xi)\n$$\n$$\ny(\\xi,\\eta) = N_3(\\xi,\\eta)L_y + N_4(\\xi,\\eta)L_y = \\frac{1}{4}(1+\\xi)(1+\\eta)L_y + \\frac{1}{4}(1-\\xi)(1+\\eta)L_y = \\frac{L_y}{4}(1+\\eta)(1+\\xi+1-\\xi) = \\frac{L_y}{2}(1+\\eta)\n$$\n雅可比矩阵 $\\mathbf{J}$ 为\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2}  0 \\\\ 0  \\frac{L_y}{2} \\end{pmatrix}\n$$\n对于这个矩形单元，雅可比行列式是恒定的：\n$$\n\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}\n$$\n质量矩阵分量的积分变为\n$$\nM_{ij}^{\\mathrm{c}} = \\rho\\, b\\, \\frac{L_x L_y}{4} \\int_{-1}^{1}\\int_{-1}^{1} N_{i}(\\xi,\\eta) N_{j}(\\xi,\\eta)\\, \\mathrm{d}\\xi\\, \\mathrm{d}\\eta\n$$\n问题指定使用 $2 \\times 2$ 高斯求积法则。函数 $f(\\xi,\\eta)$ 的积分近似为\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} f(\\xi,\\eta)\\, \\mathrm{d}\\xi\\, \\mathrm{d}\\eta \\approx \\sum_{k=1}^{4} w_k f(\\xi_k, \\eta_k)\n$$\n高斯点为 $(\\xi_k, \\eta_k) = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$，所有 $k \\in \\{1,2,3,4\\}$ 的权重均为 $w_k = 1$。由于被积函数 $N_i N_j$ 是一个在 $\\xi$ 和 $\\eta$ 上次数最多为 2 的多项式，此法则（对次数最高为 3 的多项式精确）提供了积分的精确值。\n设 $C = \\rho b \\frac{L_x L_y}{4}$。那么，\n$$\nM_{ij}^{\\mathrm{c}} = C \\sum_{k=1}^{4} N_{i}(\\xi_k, \\eta_k) N_{j}(\\xi_k, \\eta_k)\n$$\n首先，我们计算对角项 $M_{11}^{\\mathrm{c}}$：\n$$\nM_{11}^{\\mathrm{c}} = C \\sum_{k=1}^{4} [N_{1}(\\xi_k, \\eta_k)]^2\n$$\n接下来，我们使用行和集中法确定节点 1 的集中质量 $m_{1}^{\\mathrm{L}}$：\n$$\nm_{1}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{1j}^{\\mathrm{c}} = \\sum_{j=1}^{4} C \\sum_{k=1}^{4} N_{1}(\\xi_k, \\eta_k) N_{j}(\\xi_k, \\eta_k) = C \\sum_{k=1}^{4} N_{1}(\\xi_k, \\eta_k) \\left( \\sum_{j=1}^{4} N_{j}(\\xi_k, \\eta_k) \\right)\n$$\n这些形函数的一个基本性质是它们构成单位分解，即对于所有的 $(\\xi,\\eta)$，$\\sum_{j=1}^{4} N_{j}(\\xi,\\eta) = 1$。因此，集中质量的表达式简化为\n$$\nm_{1}^{\\mathrm{L}} = C \\sum_{k=1}^{4} N_{1}(\\xi_k, \\eta_k)\n$$\n设 $\\alpha = \\frac{1}{\\sqrt{3}}$。四个高斯点为 $p_1=(-\\alpha, -\\alpha)$、$p_2=(\\alpha, -\\alpha)$、$p_3=(\\alpha, \\alpha)$ 和 $p_4=(-\\alpha, \\alpha)$。我们在这些点上计算 $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$ 的值：\n$N_1(p_1) = N_1(-\\alpha, -\\alpha) = \\frac{1}{4}(1+\\alpha)^2$\n$N_1(p_2) = N_1(\\alpha, -\\alpha) = \\frac{1}{4}(1-\\alpha)(1+\\alpha) = \\frac{1}{4}(1-\\alpha^2)$\n$N_1(p_3) = N_1(\\alpha, \\alpha) = \\frac{1}{4}(1-\\alpha)^2$\n$N_1(p_4) = N_1(-\\alpha, \\alpha) = \\frac{1}{4}(1+\\alpha)(1-\\alpha) = \\frac{1}{4}(1-\\alpha^2)$\n\n现在我们可以计算 $m_{1}^{\\mathrm{L}}$：\n$$\nm_{1}^{\\mathrm{L}} = C \\left[ \\frac{1}{4}(1+\\alpha)^2 + \\frac{1}{4}(1-\\alpha^2) + \\frac{1}{4}(1-\\alpha)^2 + \\frac{1}{4}(1-\\alpha^2) \\right]\n$$\n$$\nm_{1}^{\\mathrm{L}} = \\frac{C}{4} \\left[ (1+2\\alpha+\\alpha^2) + (1-\\alpha^2) + (1-2\\alpha+\\alpha^2) + (1-\\alpha^2) \\right] = \\frac{C}{4} [1+1+1+1] = \\frac{C}{4}(4) = C\n$$\n因此，$m_{1}^{\\mathrm{L}} = C = \\rho b \\frac{L_x L_y}{4}$。这是预料之中的，因为对于一个矩形单元，行和集中法将总单元质量（$\\rho b L_x L_y$）的四分之一分配给每个节点。\n\n接下来，我们计算 $M_{11}^{\\mathrm{c}}$：\n$$\nM_{11}^{\\mathrm{c}} = C \\left( [N_1(p_1)]^2 + [N_1(p_2)]^2 + [N_1(p_3)]^2 + [N_1(p_4)]^2 \\right)\n$$\n$$\nM_{11}^{\\mathrm{c}} = C \\left[ \\left(\\frac{1}{4}(1+\\alpha)^2\\right)^2 + \\left(\\frac{1}{4}(1-\\alpha^2)\\right)^2 + \\left(\\frac{1}{4}(1-\\alpha)^2\\right)^2 + \\left(\\frac{1}{4}(1-\\alpha^2)\\right)^2 \\right]\n$$\n$$\nM_{11}^{\\mathrm{c}} = \\frac{C}{16} \\left[ (1+\\alpha)^4 + 2(1-\\alpha^2)^2 + (1-\\alpha)^4 \\right]\n$$\n我们使用恒等式 $(1+\\alpha)^4 + (1-\\alpha)^4 = 2(1+6\\alpha^2+\\alpha^4)$。\n$$\nM_{11}^{\\mathrm{c}} = \\frac{C}{16} \\left[ 2(1+6\\alpha^2+\\alpha^4) + 2(1-2\\alpha^2+\\alpha^4) \\right] = \\frac{C}{8} \\left[ (1+6\\alpha^2+\\alpha^4) + (1-2\\alpha^2+\\alpha^4) \\right] = \\frac{C}{8} [2+4\\alpha^2+2\\alpha^4] = \\frac{C}{4} [1+2\\alpha^2+\\alpha^4]\n$$\n代入 $\\alpha^2 = \\left(\\frac{1}{\\sqrt{3}}\\right)^2 = \\frac{1}{3}$ 和 $\\alpha^4 = \\frac{1}{9}$：\n$$\nM_{11}^{\\mathrm{c}} = \\frac{C}{4} \\left[ 1 + 2\\left(\\frac{1}{3}\\right) + \\frac{1}{9} \\right] = \\frac{C}{4} \\left[ 1 + \\frac{2}{3} + \\frac{1}{9} \\right] = \\frac{C}{4} \\left[ \\frac{9+6+1}{9} \\right] = \\frac{C}{4} \\left( \\frac{16}{9} \\right) = \\frac{4}{9}C\n$$\n最后，我们计算所要求的比率 $r$：\n$$\nr = \\frac{m_{1}^{\\mathrm{L}}}{M_{11}^{\\mathrm{c}}} = \\frac{C}{\\frac{4}{9}C} = \\frac{1}{\\frac{4}{9}} = \\frac{9}{4}\n$$\n对于双线性矩形单元，节点上的集中质量与一致质量矩阵对角项的比率为 $\\frac{9}{4}$。",
            "answer": "$$\n\\boxed{\\frac{9}{4}}\n$$"
        },
        {
            "introduction": "在前一个练习的基础上，本节将这些概念扩展到三维空间，采用四面体单元——这是复杂岩土力学模型中的主力单元。本练习将介绍简化积分方案（如单点求积）的应用，这在实际计算中是一种常见的权衡策略。通过为三维单元构建一致和集总质量矩阵，您将学会如何将这些矩阵公式应用于不同的单元类型和计算环境，并理解在简化过程中保持总质量等物理约束的重要性。",
            "id": "3541000",
            "problem": "考虑一个在小应变弹塑性动力学公式中使用的、具有线性形函数的四节点四面体有限元，该公式用于计算岩土力学。假设单元域内为均匀各向同性固体，其质量密度 $\\rho$ 为常数，并为分离惯性贡献而忽略体力。使用有限元法 (FEM)，从线性动量守恒及其弱形式出发，并将注意力限制在运动的单个平动分量上（即每个节点一个标量自由度）。推导单元级一致质量矩阵项关于形函数和质量密度的表达式。然后，在单元形心处使用单点积分，计算该四节点四面体单元的一致质量矩阵，将其表示为单元体积 $V_{e}$ 和 $\\rho$ 的函数。\n\n接下来，为同一单元提出一个保持对称性和每个平动分量的总单元质量的集中对角质量矩阵，并将其对角项用 $V_{e}$ 和 $\\rho$ 表示。\n\n最后，定义比率 $r$ 为单点积分一致质量矩阵的对角项与您提出的集中质量矩阵的相应对角项（均为每个标量自由度）之商。计算 $r$。将 $r$ 以无单位的单个数字形式给出。",
            "solution": "在进行求解之前，对问题陈述进行了严格验证。\n\n### 第 1 步：提取已知条件\n- 单元类型：具有线性形函数的四节点四面体有限元。\n- 物理问题：计算岩土力学中的小应变弹塑性动力学。\n- 材料属性：均匀各向同性固体，质量密度 $\\rho$ 为常数。\n- 简化：忽略体力。分析限制为每个节点一个标量自由度 (DOF)。\n- 公式：基于线性动量守恒弱形式的有限元法 (FEM)。\n- 任务 1：推导一致质量矩阵项的通用表达式。\n- 任务 2：使用单元形心处的单点积分，计算指定单元的一致质量矩阵，表示为单元体积 $V_{e}$ 和密度 $\\rho$ 的函数。\n- 任务 3：为同一单元提出一个保持对称性和总单元质量的集中对角质量矩阵。\n- 任务 4：定义比率 $r$ 为单点积分一致质量矩阵的对角项与所提出的集中质量矩阵的对角项之商。\n- 任务 5：计算 $r$ 的数值。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据预定义标准对问题进行评估：\n- **科学性**：该问题坚实地植根于连续介质力学和有限元法的原理。一致质量矩阵和集中质量矩阵、四面体单元以及数值积分是计算力学中标准的、成熟的概念。该问题在科学上是合理的。\n- **适定性**：问题陈述清晰，信息充分，并包含一系列明确定义的任务，从而导出一个唯一的数值答案。使用单点积分是一个明确的指令，消除了歧义。\n- **客观性**：语言技术性强、精确，且不含主观或基于意见的内容。\n\n该问题没有表现出任何科学上不合理、不完整、矛盾或模棱两可的缺陷。这是有限元法理论中一个标准的、有一定难度的练习。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### 求解推导\n\n弹塑性动力学问题的出发点是线性动量守恒。对于一个域为 $\\Omega$ 的连续体，忽略体力，其表达式为：\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\ddot{\\mathbf{u}} $$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\rho$ 是质量密度，$\\ddot{\\mathbf{u}}$ 是加速度矢量。\n\n为了推导有限元方程，我们使用加权余量法来构建弱形式。我们将动量方程乘以一个矢量值检验函数 $\\mathbf{w}$，并在单元体积 $V_e$ 上积分：\n$$ \\int_{V_e} \\mathbf{w} \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma} - \\rho \\ddot{\\mathbf{u}}) \\, dV = 0 $$\n对应力项应用分部积分法得到：\n$$ \\int_{V_e} (\\nabla \\mathbf{w}) : \\boldsymbol{\\sigma} \\, dV - \\int_{\\partial V_e} \\mathbf{w} \\cdot (\\boldsymbol{\\sigma} \\cdot \\mathbf{n}) \\, dS - \\int_{V_e} \\mathbf{w} \\cdot (\\rho \\ddot{\\mathbf{u}}) \\, dV = 0 $$\n问题陈述我们只考虑运动的单个平动分量，这将矢量场 $\\mathbf{u}$ 和 $\\mathbf{w}$ 分别简化为标量场 $u$ 和 $w$。控制这个单自由度的方程是：\n$$ \\int_{V_e} \\nabla w \\cdot \\nabla \\sigma_{comp} \\, dV - \\int_{\\partial V_e} w (\\nabla \\sigma_{comp} \\cdot \\mathbf{n}) \\, dS - \\int_{V_e} w (\\rho \\ddot{u}) \\, dV = 0 $$\n其中 $\\sigma_{comp}$ 代表相关的应力分量。惯性项是质量矩阵推导的重点，它简化为：\n$$ \\int_{V_e} \\rho w \\ddot{u} \\, dV $$\n在有限元法中，单元内的位移场 $u$ 通过使用形函数 $N_i(x)$ 对节点位移 $u_i$ 进行插值来近似：\n$$ u(x, t) \\approx \\sum_{i=1}^{4} N_i(x) u_i(t) = \\mathbf{N}(x) \\mathbf{u}(t) $$\n加速度也同样近似：\n$$ \\ddot{u}(x, t) \\approx \\sum_{i=1}^{4} N_i(x) \\ddot{u}_i(t) = \\mathbf{N}(x) \\ddot{\\mathbf{u}}(t) $$\n使用伽辽金法，检验函数 $w$ 从与形函数相同的基中选取。对于第 $j$ 个方程，我们取 $w = N_j(x)$。将这些近似代入惯性项，得到惯性力矢量的第 $j$ 个分量：\n$$ \\int_{V_e} \\rho N_j(x) \\left( \\sum_{i=1}^{4} N_i(x) \\ddot{u}_i(t) \\right) dV = \\sum_{i=1}^{4} \\left( \\int_{V_e} \\rho N_j(x) N_i(x) dV \\right) \\ddot{u}_i(t) $$\n这个表达式定义了单元级一致质量矩阵 $\\mathbf{M}^e$，其项 $M_{ji}^e$ 由以下公式给出：\n$$ M_{ji}^e = \\int_{V_e} \\rho N_j(x) N_i(x) dV $$\n这是一致质量矩阵各项的通用表达式。\n\n接下来，我们使用单元形心处的单点求积法来计算一个四节点四面体单元的此表达式。单点数值积分的公式是：\n$$ \\int_{V_e} f(x) dV \\approx f(x_c) V_e $$\n其中 $x_c$ 是四面体的形心，$V_e$ 是其体积。对于线性四面体单元，形函数 $N_i$ 与重心坐标 $L_i$ 相同。四面体的形心是所有重心坐标都相等的点：\n$$ N_i(x_c) = L_i(x_c) = \\frac{1}{4} \\quad \\text{for } i = 1, 2, 3, 4 $$\n将单点积分法则应用于质量矩阵项，并假设密度 $\\rho$ 为常数：\n$$ M_{ji}^e \\approx \\rho N_j(x_c) N_i(x_c) V_e $$\n代入形函数在形心处的值：\n$$ M_{ji}^e \\approx \\rho \\left(\\frac{1}{4}\\right) \\left(\\frac{1}{4}\\right) V_e = \\frac{\\rho V_e}{16} $$\n这个结果与索引 $j$ 和 $i$ 无关。因此， $4 \\times 4$ 单点积分一致质量矩阵中的每个项都是 $\\frac{\\rho V_e}{16}$。该矩阵为：\n$$ \\mathbf{M}^e_{\\text{cons, 1pt}} = \\frac{\\rho V_e}{16} \\begin{pmatrix} 1  1  1  1 \\\\ 1  1  1  1 \\\\ 1  1  1  1 \\\\ 1  1  1  1 \\end{pmatrix} $$\n该矩阵的对角项是 $(M^e_{\\text{cons, 1pt}})_{ii} = \\frac{\\rho V_e}{16}$。\n\n接下来，我们提出了一个集中对角质量矩阵 $\\mathbf{M}^e_{\\text{lumped}}$，它保持了总单元质量并且是对称的。单元的总质量是 $m_{total} = \\rho V_e$。对于具有几何对称节点的线性单元，一个标准的、物理上直观的集中方案是将总质量平均分配给各个节点。对于一个4节点四面体，这意味着将总质量的1/4分配给质量矩阵中每个节点的对角项。这保证了对称性。对角项为：\n$$ (M^e_{\\text{lumped}})_{ii} = \\frac{m_{total}}{4} = \\frac{\\rho V_e}{4} $$\n所有非对角项均为零。得到的集中质量矩阵是：\n$$ \\mathbf{M}^e_{\\text{lumped}} = \\frac{\\rho V_e}{4} \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} $$\n其各项之和为 $4 \\times \\frac{\\rho V_e}{4} = \\rho V_e$，证实了总质量是守恒的。\n\n最后，我们计算比率 $r$，定义为单点积分一致质量矩阵的对角项与所提出的集中质量矩阵的相应对角项之商。\n$$ r = \\frac{(M^e_{\\text{cons, 1pt}})_{ii}}{(M^e_{\\text{lumped}})_{ii}} $$\n代入推导出的值：\n$$ r = \\frac{\\frac{\\rho V_e}{16}}{\\frac{\\rho V_e}{4}} = \\frac{\\rho V_e}{16} \\cdot \\frac{4}{\\rho V_e} = \\frac{4}{16} = \\frac{1}{4} $$\n作为一个单独的数字，结果是 $0.25$。",
            "answer": "$$\\boxed{0.25}$$"
        },
        {
            "introduction": "理论知识必须与其实际应用后果的理解相结合。本章的最终练习是一个计算实验，旨在揭示一个关键原则：数值一致性。通过模拟一个简单的自由落体场景，您将发现一些看似无害的建模选择——例如，将集总质量矩阵与一致荷载向量配对——如何导致非物理性的结果，如虚假的能量产生。对于确保复杂岩土力学模拟的有效性而言，这是一个至关重要的教训。",
            "id": "3541036",
            "problem": "考虑一个二维连续体在均匀重力加速度下自由落体的半离散动力学。从牛顿第二定律及其对于一个密度为$\\rho$、平面外单位厚度的物体，在沿y轴负方向作用的重力$g$下的Galerkin弱形式出发。通过使用双线性等参四边形形函数$\\{N_i\\}_{i=1}^{4}$和节点垂直位置$\\mathbf{y} = [y_1,y_2,y_3,y_4]^T$的有限元法（FEM）离散化，垂直运动的半离散方程可写作\n$$\n\\mathbf{M}\\,\\mathbf{a} = \\mathbf{f},\n$$\n其中$\\mathbf{M}$是质量矩阵，$\\mathbf{f}$是重力载荷向量。一致质量矩阵定义为\n$$\n\\mathbf{M}_\\text{cons} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\mathbf{N}\\, \\mathrm{d}\\Omega,\n$$\n其中$\\mathbf{N} = [N_1, N_2, N_3, N_4]$，$\\Omega_e$是单元域。一致体力向量（在向上为正的坐标约定下，重力沿y轴负方向）为\n$$\n\\mathbf{f}_\\text{cons} = - \\int_{\\Omega_e} \\rho\\, g\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega.\n$$\n令$\\mathbf{r} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega$表示一致“行质量”向量，因此$\\mathbf{f}_\\text{cons} = - g \\mathbf{r}$。同时，考虑一个对角“集中”质量矩阵$\\mathbf{M}_\\text{lump} = \\mathrm{diag}(m_1,m_2,m_3,m_4)$，它是通过将单元总质量平均分配到其四个节点上得到的，即$m_i = (\\int_{\\Omega_e} \\rho\\, \\mathrm{d}\\Omega)/4$，而不考虑形状畸变。自由落体的初始条件为$\\mathbf{y}(0) = \\mathbf{y}_0$（初始节点坐标，单位为米）和$\\mathbf{v}(0) = \\mathbf{0}$（初始速度），没有位移约束，也没有内刚度（一个可变形离散体的纯刚体自由落体）。\n\n将物理总机械能定义为动能和重力势能之和，\n$$\nE(t) = \\tfrac{1}{2}\\, \\mathbf{v}(t)^T\\, \\mathbf{M}_\\text{cons}\\, \\mathbf{v}(t) \\;+\\; g\\, \\mathbf{r}^T \\mathbf{y}(t),\n$$\n这对应于连续体能量的一致离散化（注意，对于向上为正的y，势能$g\\,\\mathbf{r}^T\\mathbf{y}$等于$\\int_{\\Omega_e} \\rho\\, g\\, y\\, \\mathrm{d}\\Omega$）。在精确的刚体自由落体下，$E(t)$必须随时间保持恒定。\n\n你需要构建一个反例，证明在一个畸变单元中，使用对角等节点“集中”质量矩阵$\\mathbf{M}_\\text{lump}$与一致重力载荷向量$\\mathbf{f}_\\text{cons}$相结合，会注入非物理的刚体能量，即使使用相同的$\\mathbf{f}_\\text{cons}$的一致格式$\\mathbf{M}_\\text{cons}$能够保持正确的能量平衡。\n\n算法任务：\n- 对于下面的每个单元，使用双线性形函数和到给定物理节点坐标的标准映射，通过在等参坐标中的父正方形上进行$2\\times 2$高斯积分，计算$\\mathbf{M}_\\text{cons}$和$\\mathbf{r}$。\n- 通过将单元总质量平均分配到四个节点上来构建$\\mathbf{M}_\\text{lump}$，即$m_i = (\\sum_j r_j)/4$。\n- 分别计算一致格式和集中格式的节点加速度，\n  $$\n  \\mathbf{a}_\\text{cons} = \\mathbf{M}_\\text{cons}^{-1} \\mathbf{f}_\\text{cons},\\quad\n  \\mathbf{a}_\\text{lump} = \\mathbf{M}_\\text{lump}^{-1} \\mathbf{f}_\\text{cons}.\n  $$\n- 使用$\\mathbf{v}(0)=\\mathbf{0}$的精确匀加速运动学，推进到时间$t$：\n  $$\n  \\mathbf{v}(t) = \\mathbf{a}\\, t,\\qquad \\mathbf{y}(t) = \\mathbf{y}_0 + \\tfrac{1}{2}\\,\\mathbf{a}\\, t^2.\n  $$\n  对$\\mathbf{a}_\\text{cons}$和$\\mathbf{a}_\\text{lump}$分别执行此操作，以获得$\\mathbf{v}_\\text{cons}(t), \\mathbf{y}_\\text{cons}(t)$和$\\mathbf{v}_\\text{lump}(t), \\mathbf{y}_\\text{lump}(t)$。\n- 计算两种格式相对于初始能量$E(0)$的能量变化，\n  $$\n  \\Delta E_\\text{cons}(t) = E_\\text{cons}(t) - E(0),\\qquad\n  \\Delta E_\\text{lump}(t) = E_\\text{lump}(t) - E(0),\n  $$\n  其中$E_\\text{cons}(t)$和$E_\\text{lump}(t)$都使用相同的物理能量定义$E(t) = \\tfrac{1}{2}\\mathbf{v}^T \\mathbf{M}_\\text{cons}\\mathbf{v} + g \\mathbf{r}^T \\mathbf{y}$进行评估。能量单位使用国际单位制中的焦耳（J）。\n\n测试套件与参数：\n- 材料密度$\\rho = 1700$ kg/m$^3$，重力加速度$g = 9.81$ m/s$^2$，时间$t = 0.2$ s，平面外单位厚度。y坐标向上为正。\n- 三个单单元算例（每个算例是一个双线性等参四边形，有四个节点，按逆时针顺序给出，坐标为$(x_i, y_i)$，单位为米）：\n  1. 矩形（基准，常数雅可比）：[(0,0),(2,0),(2,1),(0,1)]。\n  2. 轻度畸变梯形：[(0,0),(2,0.2),(2,1.2),(0,1)]。\n  3. 严重畸变梯形：[(0,0),(2,0.8),(2,1.6),(0,1)]。\n\n计算要求：\n- 实现稳健的数值积分（对于$2\\times 2$高斯法则下的双线性映射是精确的）来组装$\\mathbf{M}_\\text{cons}$和$\\mathbf{r}$。\n- 在计算$E(t)$时，对两种格式都使用一致能量定义。\n\n交付成果和最终输出格式：\n- 对于每个测试用例，输出一个浮点数对$[\\Delta E_\\text{cons}(t), \\Delta E_\\text{lump}(t)]$，单位为焦耳，四舍五入到六位小数。\n- 你的程序应生成一行输出，其中包含一个由方括号括起来的、逗号分隔的这些对的列表（例如：\"[[e1_cons,e1_lump],[e2_cons,e2_lump],[e3_cons,e3_lump]]\"）。\n\n注意：\n- 如果轻度和重度畸变的算例显示$\\Delta E_\\text{lump}(t)  0$，而$\\Delta E_\\text{cons}(t)$在数值上接近于零（两者均以焦耳为单位报告），则反例成立。矩形算例作为一个边界条件，由于精确等效性，两种情况下的能量变化都应在数值上接近于零。",
            "solution": "该问题陈述是计算力学领域，特别是在应用于结构动力学的有限元法（FEM）范畴内的一个有效练习。它在科学上基于牛顿力学和Galerkin法的原理，是适定的，并提供了所有必要的数据和条件，其表述是客观的。任务是通过一个反例来证明，集中质量矩阵与一致力向量的不一致配对，会在模拟的刚体运动中导致对能量守恒的非物理违反。\n\n所涉及的基本物理原理是在保守力场作用下运动的系统的总机械能守恒。对于在均匀重力下自由落体的物体，其动能和势能之和必须保持恒定。从Galerkin有限元格式推导出的半离散运动方程由下式给出：\n$$\n\\mathbf{M}\\,\\mathbf{a} = \\mathbf{f}\n$$\n其中$\\mathbf{M}$是质量矩阵，$\\mathbf{a}$是节点加速度向量，$\\mathbf{f}$是节点力向量。\n\n一致质量矩阵$\\mathbf{M}_\\text{cons}$直接源于Galerkin程序，定义为：\n$$\n\\mathbf{M}_\\text{cons} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\mathbf{N}\\, \\mathrm{d}\\Omega\n$$\n其中$\\rho$是材料密度，$\\mathbf{N} = [N_1, N_2, N_3, N_4]$是双线性形函数向量，积分在单元域$\\Omega_e$上进行。该矩阵正确地表示了由形函数插值的速度场的动能。\n\n类似地，对于沿y轴负方向作用的重力，其一致体力向量为：\n$$\n\\mathbf{f}_\\text{cons} = - \\int_{\\Omega_e} \\rho\\, g\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega = -g \\mathbf{r}\n$$\n其中$g$是重力加速度，$\\mathbf{r} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega$是一致节点质量贡献的向量。\n\n一种常见的简化是使用对角或“集中”质量矩阵$\\mathbf{M}_\\text{lump}$以提高计算效率。问题指定了一种特定的集中方案，其中单元总质量$M_{tot} = \\int_{\\Omega_e} \\rho\\, \\mathrm{d}\\Omega = \\sum_i r_i$被平均分配到四个节点上：\n$$\n\\mathbf{M}_\\text{lump} = \\mathrm{diag}\\left(\\frac{M_{tot}}{4}, \\frac{M_{tot}}{4}, \\frac{M_{tot}}{4}, \\frac{M_{tot}}{4}\\right)\n$$\n本研究的核心在于分析“不一致”系统$\\mathbf{M}_\\text{lump} \\mathbf{a} = \\mathbf{f}_\\text{cons}$，并将其能量行为与一致系统$\\mathbf{M}_\\text{cons} \\mathbf{a} = \\mathbf{f}_\\text{cons}$进行比较。\n\n离散系统的总机械能被一致地定义为：\n$$\nE(t) = \\frac{1}{2}\\, \\mathbf{v}(t)^T\\, \\mathbf{M}_\\text{cons}\\, \\mathbf{v}(t) \\;+\\; g\\, \\mathbf{r}^T \\mathbf{y}(t)\n$$\n给定静止的初始条件$\\mathbf{v}(0) = \\mathbf{0}$，初始能量纯为势能：$E(0) = g\\, \\mathbf{r}^T \\mathbf{y}_0$。使用匀加速运动学，我们有$\\mathbf{v}(t) = \\mathbf{a}t$和$\\mathbf{y}(t) = \\mathbf{y}_0 + \\frac{1}{2}\\mathbf{a}t^2$。从$t=0$到稍后时间$t$的能量变化为：\n$$\n\\Delta E(t) = E(t) - E(0) = \\left( \\frac{1}{2}(\\mathbf{a}t)^T \\mathbf{M}_\\text{cons} (\\mathbf{a}t) + g\\mathbf{r}^T (\\mathbf{y}_0 + \\frac{1}{2}\\mathbf{a}t^2) \\right) - g\\mathbf{r}^T\\mathbf{y}_0\n$$\n$$\n\\Delta E(t) = \\frac{1}{2}t^2 \\mathbf{a}^T \\mathbf{M}_\\text{cons} \\mathbf{a} + \\frac{1}{2}t^2 g\\mathbf{r}^T \\mathbf{a}\n$$\n代入$\\mathbf{f}_\\text{cons} = -g\\mathbf{r}$，我们得到能量变化的紧凑表达式：\n$$\n\\Delta E(t) = \\frac{1}{2}t^2 \\left( \\mathbf{a}^T \\mathbf{M}_\\text{cons} \\mathbf{a} - \\mathbf{f}_\\text{cons}^T \\mathbf{a} \\right)\n$$\n对于一致格式，$\\mathbf{a} = \\mathbf{a}_\\text{cons} = \\mathbf{M}_\\text{cons}^{-1} \\mathbf{f}_\\text{cons}$。这意味着$\\mathbf{M}_\\text{cons} \\mathbf{a}_\\text{cons} = \\mathbf{f}_\\text{cons}$。由于$\\mathbf{M}_\\text{cons}$是对称的，因此$\\mathbf{a}_\\text{cons}^T \\mathbf{M}_\\text{cons} = \\mathbf{f}_\\text{cons}^T$。将此代入能量变化方程，得到$\\Delta E_\\text{cons}(t) = \\frac{1}{2}t^2 (\\mathbf{f}_\\text{cons}^T \\mathbf{a}_\\text{cons} - \\mathbf{f}_\\text{cons}^T \\mathbf{a}_\\text{cons}) = 0$。因此，一致格式精确地能量守恒。\n\n对于指定的集中格式，$\\mathbf{a} = \\mathbf{a}_\\text{lump} = \\mathbf{M}_\\text{lump}^{-1} \\mathbf{f}_\\text{cons}$。一般情况下，$\\mathbf{M}_\\text{cons} \\mathbf{a}_\\text{lump} \\neq \\mathbf{f}_\\text{cons}$，所以$\\Delta E_\\text{lump}(t)$的括号中的项将不为零，导致非物理的能量变化。\n\n计算流程如下：\n1.  对于每个单元几何形状，使用$2 \\times 2$高斯积分法则在等参父单元域$[-1,1] \\times [-1,1]$上数值计算$\\mathbf{M}_\\text{cons}$和$\\mathbf{r}$的积分。对于双线性单元遇到的被积函数（它们在每个父坐标$\\xi$和$\\eta$中最多是三次多项式），此法则是精确的。\n2.  在每个高斯点计算等参映射的雅可比$J(\\xi, \\eta) = \\det(\\mathbf{J})$。微分面积元为$\\mathrm{d}\\Omega = J(\\xi, \\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n3.  通过将四个高斯点处计算的各自被积函数值乘以材料密度$\\rho$和局部雅可比行列式$J_k$后求和，来组装$\\mathbf{M}_\\text{cons}$和$\\mathbf{r}$。由于所有高斯权重均为1，组装过程为：\n    $$\n    \\mathbf{M}_\\text{cons} = \\rho \\sum_{k=1}^{4} \\mathbf{N}(\\xi_k, \\eta_k)^T \\mathbf{N}(\\xi_k, \\eta_k) J_k, \\quad \\mathbf{r} = \\rho \\sum_{k=1}^{4} \\mathbf{N}(\\xi_k, \\eta_k)^T J_k\n    $$\n4.  构造集中质量矩阵$\\mathbf{M}_\\text{lump}$和一致力向量$\\mathbf{f}_\\text{cons}$。\n5.  通过求解相应的线性系统计算节点加速度$\\mathbf{a}_\\text{cons}$和$\\mathbf{a}_\\text{lump}$。\n6.  使用推导出的公式，在给定材料参数和时间步长$t=0.2\\,\\text{s}$下，计算能量变化$\\Delta E_\\text{cons}(t)$和$\\Delta E_\\text{lump}(t)$。\n\n对三种指定的单元几何形状实施此流程。预期结果将显示，对于未畸变的矩形单元，两种格式都能量守恒。然而，对于畸变的梯形单元，不一致的集中格式将向系统中注入虚假的、正值的能量，且畸变越强，效应越显著。这证明了当质量和力的表示之间的一致性被破坏时，可能出现数值误差和不稳定性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the energy conservation of consistent versus\n    inconsistent (lumped mass, consistent force) FEM formulations for\n    a 2D element in free fall.\n    \"\"\"\n    #\n    # --- Problem Parameters ---\n    #\n    rho = 1700.0  # kg/m^3\n    g = 9.81      # m/s^2\n    t = 0.2       # s\n\n    #\n    # --- Test Cases: Nodal coordinates (x, y) in meters ---\n    # Node ordering is counter-clockwise starting from bottom-left.\n    #\n    test_cases = [\n        # Case 1: Rectangular element (baseline)\n        np.array([(0.0, 0.0), (2.0, 0.0), (2.0, 1.0), (0.0, 1.0)]),\n        # Case 2: Mildly distorted trapezoid\n        np.array([(0.0, 0.0), (2.0, 0.2), (2.0, 1.2), (0.0, 1.0)]),\n        # Case 3: Strongly distorted trapezoid\n        np.array([(0.0, 0.0), (2.0, 0.8), (2.0, 1.6), (0.0, 1.0)])\n    ]\n\n    all_results = []\n\n    #\n    # --- Numerical Integration Setup (2x2 Gauss Quadrature) ---\n    #\n    gauss_p = 1.0 / np.sqrt(3.0)\n    gauss_points = [\n        (-gauss_p, -gauss_p), (gauss_p, -gauss_p),\n        (gauss_p, gauss_p), (-gauss_p, gauss_p)\n    ]\n    # Weights for 2x2 Gauss quadrature are all 1.0\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    #\n    # --- Main Calculation Loop ---\n    #\n    for nodes in test_cases:\n        #\n        # Step 1: Compute Consistent Mass Matrix (M_cons) and Row-Mass Vector (r_vec)\n        #\n        M_cons = np.zeros((4, 4))\n        r_vec = np.zeros(4)\n\n        for i in range(len(gauss_points)):\n            xi, eta = gauss_points[i]\n            weight = gauss_weights[i]\n\n            # Bilinear shape functions N(xi, eta) at the current Gauss point\n            N = 0.25 * np.array([\n                (1 - xi) * (1 - eta),\n                (1 + xi) * (1 - eta),\n                (1 + xi) * (1 + eta),\n                (1 - xi) * (1 + eta)\n            ])\n\n            # Derivatives of N w.r.t. parent coordinates (xi, eta)\n            dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n            dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n\n            # Jacobian matrix of the isoparametric mapping\n            J_mat = np.array([\n                [np.dot(dN_dxi, nodes[:, 0]), np.dot(dN_dxi, nodes[:, 1])],\n                [np.dot(dN_deta, nodes[:, 0]), np.dot(dN_deta, nodes[:, 1])]\n            ])\n\n            # Jacobian determinant\n            det_J = np.linalg.det(J_mat)\n            if det_J = 0:\n                raise ValueError(\"Jacobian is non-positive. Element is degenerate or inverted.\")\n\n            # Accumulate contributions to M_cons and r_vec integrals\n            # Unit thickness is assumed (h=1)\n            M_cons += rho * np.outer(N, N) * det_J * weight\n            r_vec += rho * N * det_J * weight\n\n        #\n        # Step 2: Form other matrices and vectors\n        #\n        # Consistent gravitational force vector\n        f_cons = -g * r_vec\n\n        # Lumped mass matrix (equal distribution of total mass)\n        total_mass = np.sum(r_vec)\n        m_lump_diag_val = total_mass / 4.0\n        M_lump = np.diag([m_lump_diag_val] * 4)\n\n        #\n        # Step 3: Compute nodal accelerations for both formulations\n        #\n        # a_cons = inv(M_cons) * f_cons\n        a_cons = np.linalg.solve(M_cons, f_cons)\n        \n        # a_lump = inv(M_lump) * f_cons\n        a_lump = f_cons / m_lump_diag_val\n\n        #\n        # Step 4: Compute the change in total mechanical energy for both cases\n        # Delta_E = 0.5 * t^2 * (a.T @ M_cons @ a - f_cons.T @ a)\n        #\n        \n        # Consistent formulation\n        delta_E_cons = 0.5 * t**2 * (a_cons.T @ M_cons @ a_cons - f_cons.T @ a_cons)\n\n        # Inconsistent \"lumped\" formulation (energy is still measured via M_cons)\n        delta_E_lump = 0.5 * t**2 * (a_lump.T @ M_cons @ a_lump - f_cons.T @ a_lump)\n        \n        # Store results rounded to 6 decimal places\n        all_results.append([round(delta_E_cons, 6), round(delta_E_lump, 6)])\n\n    #\n    # --- Final Output ---\n    #\n    output_str = \"[\" + \",\".join([f\"[{e_c},{e_l}]\" for e_c, e_l in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}