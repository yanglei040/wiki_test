{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering any implicit time integration algorithm is to understand the core computation performed at each time step: the assembly and solution of a linear system. This practice provides a direct, hands-on experience in translating the theoretical equations of the generalized-$\\alpha$ method into a practical computational task. You will derive the effective stiffness matrix, $\\hat{K}$, and effective load vector, $\\hat{R}$, which are fundamental components for implementing the scheme in a finite element code, before applying your derivation to a concrete numerical example. ",
            "id": "3527564",
            "problem": "Consider a linear elastodynamic initial value problem arising in computational geomechanics with the semi-discrete equations of motion $M \\, a(t) + C \\, v(t) + K \\, d(t) = f(t)$, where $M$ is the mass matrix, $C$ is the damping matrix, $K$ is the stiffness matrix, and $d(t)$, $v(t)$, $a(t)$ are displacement, velocity, and acceleration, respectively. A single time step from $t_n$ to $t_{n+1} = t_n + \\Delta t$ is to be advanced using the generalized-$\\alpha$ method (Hilber-Hughes-Taylor/generalized-$\\alpha$ family) with parameters $\\alpha_m$, $\\alpha_f$, $\\beta$, and $\\gamma$. Assume that the method enforces the equilibrium in the weighted sense $M \\, a_{n+\\alpha_m} + C \\, v_{n+\\alpha_f} + K \\, d_{n+\\alpha_f} = f_{n+\\alpha_f}$, where $a_{n+\\alpha_m} = (1-\\alpha_m) a_{n+1} + \\alpha_m a_n$, $v_{n+\\alpha_f} = (1-\\alpha_f) v_{n+1} + \\alpha_f v_n$, $d_{n+\\alpha_f} = (1-\\alpha_f) d_{n+1} + \\alpha_f d_n$, and the kinematic updates are of the Newmark family with parameters $\\beta$ and $\\gamma$. The external load $f(t)$ is piecewise linear over the time step, so that $f_{n+\\alpha_f} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$.\n\nStarting from the equation of motion and these weighted definitions (but not any ready-made update formulas), derive the linear system for the unknown acceleration $a_{n+1}$ at the end of the time step in the form $\\hat{K} \\, a_{n+1} = \\hat{R}$, identifying the effective stiffness matrix $\\hat{K}$ and the effective load vector $\\hat{R}$ in terms of $M$, $C$, $K$, the parameters $\\alpha_m$, $\\alpha_f$, $\\beta$, $\\gamma$, the time step $\\Delta t$, and the known values at $t_n$. Then evaluate these for the following specific data:\n- $\\alpha_m = 0.1$, $\\alpha_f = 0.3$, $\\beta = 0.36$, $\\gamma = 0.7$, and $\\Delta t = 0.02$,\n- $M = \\begin{pmatrix} 2  0 \\\\ 0  1.5 \\end{pmatrix}$, $C = \\begin{pmatrix} 0.8  0.1 \\\\ 0.1  0.5 \\end{pmatrix}$, $K = \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix}$,\n- $d_n = \\begin{pmatrix} 0.005 \\\\ -0.002 \\end{pmatrix}$, $v_n = \\begin{pmatrix} 0.1 \\\\ -0.05 \\end{pmatrix}$, $a_n = \\begin{pmatrix} 0 \\\\ 0.2 \\end{pmatrix}$,\n- $f_n = \\begin{pmatrix} 100 \\\\ 50 \\end{pmatrix}$ and $f_{n+1} = \\begin{pmatrix} 120 \\\\ 48 \\end{pmatrix}$.\n\nCompute the effective stiffness $\\hat{K}$ and the effective load vector $\\hat{R}$ explicitly. As your final reported quantity, provide the first component of the effective load vector $\\hat{R}$, expressed in Newtons. Round your answer to four significant figures and express the final answer in N. Do not include any other quantity in your final reported answer.",
            "solution": "The user requests the derivation and computation of the effective stiffness matrix and effective load vector for a single time step of a linear elastodynamic problem using the generalized-$\\alpha$ time integration method. The final answer should be the first component of the effective load vector.\n\n### Problem Validation\nThe problem statement is **valid**. It provides a complete and consistent set of equations, parameters, and data for a well-defined task in computational mechanics. The governing equations for the generalized-$\\alpha$ method and the Newmark kinematic updates are standard in the field. The provided numerical values are physically plausible for a two-degree-of-freedom system. The problem is scientifically grounded, well-posed, and objective. It contains no contradictions or ambiguities.\n\n### Part 1: Derivation of the Effective System\n\nThe semi-discrete equation of motion is given by:\n$$M a(t) + C v(t) + K d(t) = f(t)$$\nwhere $M$, $C$, and $K$ are the mass, damping, and stiffness matrices, and $d(t)$, $v(t)$, $a(t)$, and $f(t)$ are the displacement, velocity, acceleration, and external force vectors, respectively.\n\nThe generalized-$\\alpha$ method advances the solution from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ by enforcing equilibrium at an intermediate time:\n$$M a_{n+\\alpha_m} + C v_{n+\\alpha_f} + K d_{n+\\alpha_f} = f_{n+\\alpha_f}$$\nThe state vectors at these intermediate times are defined as weighted averages:\n$$a_{n+\\alpha_m} = (1-\\alpha_m) a_{n+1} + \\alpha_m a_n$$\n$$v_{n+\\alpha_f} = (1-\\alpha_f) v_{n+1} + \\alpha_f v_n$$\n$$d_{n+\\alpha_f} = (1-\\alpha_f) d_{n+1} + \\alpha_f d_n$$\nThe external load is assumed to be piecewise linear:\n$$f_{n+\\alpha_f} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$$\n\nThe relationship between displacement, velocity, and acceleration is given by the Newmark family of integration formulas:\n$$d_{n+1} = d_n + \\Delta t v_n + \\Delta t^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right) a_n + \\beta a_{n+1} \\right]$$\n$$v_{n+1} = v_n + \\Delta t \\left[ (1 - \\gamma) a_n + \\gamma a_{n+1} \\right]$$\n\nThe goal is to derive a linear system for the unknown acceleration at the end of the time step, $a_{n+1}$, in the form $\\hat{K} a_{n+1} = \\hat{R}$. To do this, we must express $d_{n+1}$ and $v_{n+1}$ in terms of $a_{n+1}$ and known quantities from time $t_n$. The Newmark formulas already provide this.\n\nFirst, substitute the weighted average definitions into the equilibrium equation:\n$$M ((1-\\alpha_m) a_{n+1} + \\alpha_m a_n) + C ((1-\\alpha_f) v_{n+1} + \\alpha_f v_n) + K ((1-\\alpha_f) d_{n+1} + \\alpha_f d_n) = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$$\n\nRearrange the equation to isolate terms involving quantities at $t_{n+1}$ on the left-hand side (LHS):\n$$(1-\\alpha_m) M a_{n+1} + (1-\\alpha_f) C v_{n+1} + (1-\\alpha_f) K d_{n+1} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n - \\alpha_m M a_n - \\alpha_f C v_n - \\alpha_f K d_n$$\n\nNow, substitute the Newmark update rules for $v_{n+1}$ and $d_{n+1}$ into the LHS:\n\\begin{align*} (1-\\alpha_m) M a_{n+1} + (1-\\alpha_f) C \\left( v_n + \\Delta t ((1 - \\gamma) a_n + \\gamma a_{n+1}) \\right) \\\\ + (1-\\alpha_f) K \\left( d_n + \\Delta t v_n + \\Delta t^2 ((\\frac{1}{2} - \\beta) a_n + \\beta a_{n+1}) \\right) = \\text{RHS} \\end{align*}\n\nWe group all terms multiplying the unknown $a_{n+1}$ on the LHS:\n$$ \\left( (1-\\alpha_m) M + (1-\\alpha_f) \\gamma \\Delta t C + (1-\\alpha_f) \\beta \\Delta t^2 K \\right) a_{n+1} = \\text{RHS} - (\\text{known terms from LHS})$$\n\nThe matrix multiplying $a_{n+1}$ is the effective stiffness matrix $\\hat{K}$:\n$$\\hat{K} = (1-\\alpha_m) M + (1-\\alpha_f) \\gamma \\Delta t C + (1-\\alpha_f) \\beta \\Delta t^2 K$$\n\nThe remaining terms form the effective load vector $\\hat{R}$. We move all known quantities to the right-hand side:\n\\begin{align*} \\hat{R} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n - \\alpha_m M a_n - \\alpha_f C v_n - \\alpha_f K d_n \\\\ - (1-\\alpha_f) C \\left( v_n + \\Delta t(1 - \\gamma) a_n \\right) \\\\ - (1-\\alpha_f) K \\left( d_n + \\Delta t v_n + \\Delta t^2 (\\frac{1}{2} - \\beta) a_n \\right) \\end{align*}\n\nSimplifying by collecting terms associated with $a_n$, $v_n$, and $d_n$:\n\\begin{align*} \\hat{R} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n \\\\ - \\left( \\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 K \\right) a_n \\\\ - \\left( (\\alpha_f + 1 - \\alpha_f)C + (1-\\alpha_f)\\Delta t K \\right) v_n \\\\ - \\left( (\\alpha_f + 1 - \\alpha_f)K \\right) d_n \\end{align*}\n\nThis simplifies to:\n\\begin{align*} \\hat{R} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n \\\\ - \\left[ \\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 K \\right] a_n \\\\ - \\left[ C + (1-\\alpha_f)\\Delta t K \\right] v_n \\\\ - K d_n \\end{align*}\n\nFor calculation, it is often simpler to compute each term separately and then combine them:\n$\\hat{R} = T_f - T_a - T_v - T_d$, where:\n$T_f = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$\n$T_a = \\left[ \\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 K \\right] a_n$\n$T_v = \\left[ C + (1-\\alpha_f)\\Delta t K \\right] v_n$\n$T_d = K d_n$\n\n### Part 2: Numerical Computation\n\nGiven data:\n$\\alpha_m = 0.1$, $\\alpha_f = 0.3$, $\\beta = 0.36$, $\\gamma = 0.7$, $\\Delta t = 0.02$.\n$M = \\begin{pmatrix} 2  0 \\\\ 0  1.5 \\end{pmatrix}$, $C = \\begin{pmatrix} 0.8  0.1 \\\\ 0.1  0.5 \\end{pmatrix}$, $K = \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix}$.\n$d_n = \\begin{pmatrix} 0.005 \\\\ -0.002 \\end{pmatrix}$, $v_n = \\begin{pmatrix} 0.1 \\\\ -0.05 \\end{pmatrix}$, $a_n = \\begin{pmatrix} 0 \\\\ 0.2 \\end{pmatrix}$.\n$f_n = \\begin{pmatrix} 100 \\\\ 50 \\end{pmatrix}$, $f_{n+1} = \\begin{pmatrix} 120 \\\\ 48 \\end{pmatrix}$.\n\nFirst, we compute the coefficients for the effective load vector $\\hat{R}$:\n$1-\\alpha_f = 1 - 0.3 = 0.7$\n$\\alpha_f = 0.3$\n$\\alpha_m = 0.1$\n$1-\\gamma = 1 - 0.7 = 0.3$\n$\\frac{1}{2}-\\beta = 0.5 - 0.36 = 0.14$\n$(1-\\alpha_f)(1-\\gamma)\\Delta t = 0.7 \\times 0.3 \\times 0.02 = 0.0042$\n$(1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 = 0.7 \\times 0.14 \\times (0.02)^2 = 0.0000392$\n$(1-\\alpha_f)\\Delta t = 0.7 \\times 0.02 = 0.014$\n\nNow compute each term of $\\hat{R}$:\n\n1.  Force term $T_f$:\n    $T_f = 0.7 f_{n+1} + 0.3 f_n = 0.7 \\begin{pmatrix} 120 \\\\ 48 \\end{pmatrix} + 0.3 \\begin{pmatrix} 100 \\\\ 50 \\end{pmatrix} = \\begin{pmatrix} 84 \\\\ 33.6 \\end{pmatrix} + \\begin{pmatrix} 30 \\\\ 15 \\end{pmatrix} = \\begin{pmatrix} 114 \\\\ 48.6 \\end{pmatrix}$\n\n2.  Displacement term $T_d$:\n    $T_d = K d_n = \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix} \\begin{pmatrix} 0.005 \\\\ -0.002 \\end{pmatrix} = \\begin{pmatrix} 5 + 0.4 \\\\ -1 - 1.6 \\end{pmatrix} = \\begin{pmatrix} 5.4 \\\\ -2.6 \\end{pmatrix}$\n\n3.  Velocity term $T_v$:\n    $T_v = \\left[ C + 0.014 K \\right] v_n$\n    $0.014 K = 0.014 \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix} = \\begin{pmatrix} 14  -2.8 \\\\ -2.8  11.2 \\end{pmatrix}$\n    $C + 0.014 K = \\begin{pmatrix} 0.8  0.1 \\\\ 0.1  0.5 \\end{pmatrix} + \\begin{pmatrix} 14  -2.8 \\\\ -2.8  11.2 \\end{pmatrix} = \\begin{pmatrix} 14.8  -2.7 \\\\ -2.7  11.7 \\end{pmatrix}$\n    $T_v = \\begin{pmatrix} 14.8  -2.7 \\\\ -2.7  11.7 \\end{pmatrix} \\begin{pmatrix} 0.1 \\\\ -0.05 \\end{pmatrix} = \\begin{pmatrix} 1.48 + 0.135 \\\\ -0.27 - 0.585 \\end{pmatrix} = \\begin{pmatrix} 1.615 \\\\ -0.855 \\end{pmatrix}$\n\n4.  Acceleration term $T_a$:\n    $T_a = \\left[ 0.1 M + 0.0042 C + 0.0000392 K \\right] a_n$\n    $0.1 M = \\begin{pmatrix} 0.2  0 \\\\ 0  0.15 \\end{pmatrix}$\n    $0.0042 C = \\begin{pmatrix} 0.00336  0.00042 \\\\ 0.00042  0.0021 \\end{pmatrix}$\n    $0.0000392 K = \\begin{pmatrix} 0.0392  -0.00784 \\\\ -0.00784  0.03136 \\end{pmatrix}$\n    Matrix in brackets = $\\begin{pmatrix} 0.2 + 0.00336 + 0.0392  0 + 0.00042 - 0.00784 \\\\ 0 + 0.00042 - 0.00784  0.15 + 0.0021 + 0.03136 \\end{pmatrix} = \\begin{pmatrix} 0.24256  -0.00742 \\\\ -0.00742  0.18346 \\end{pmatrix}$\n    $T_a = \\begin{pmatrix} 0.24256  -0.00742 \\\\ -0.00742  0.18346 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.00742 \\times 0.2 \\\\ 0.18346 \\times 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.001484 \\\\ 0.036692 \\end{pmatrix}$\n\nFinally, assemble the effective load vector $\\hat{R} = T_f - T_d - T_v - T_a$:\n$$\\hat{R} = \\begin{pmatrix} 114 \\\\ 48.6 \\end{pmatrix} - \\begin{pmatrix} 5.4 \\\\ -2.6 \\end{pmatrix} - \\begin{pmatrix} 1.615 \\\\ -0.855 \\end{pmatrix} - \\begin{pmatrix} -0.001484 \\\\ 0.036692 \\end{pmatrix}$$\n\nWe only need the first component, $\\hat{R}_1$:\n$$\\hat{R}_1 = 114 - 5.4 - 1.615 - (-0.001484)$$\n$$\\hat{R}_1 = 114 - 5.4 - 1.615 + 0.001484$$\n$$\\hat{R}_1 = 108.6 - 1.615 + 0.001484$$\n$$\\hat{R}_1 = 106.985 + 0.001484$$\n$$\\hat{R}_1 = 106.986484$$\n\nThe problem requires rounding to four significant figures. The first four significant figures are $1$, $0$, $6$, $9$. The fifth digit is $8$, so we round up the fourth digit.\n$106.9 \\rightarrow 107.0$. The trailing zero is significant.\n\nThe first component of the effective load vector is $107.0$ N.",
            "answer": "$$\\boxed{107.0}$$"
        },
        {
            "introduction": "In realistic geomechanical simulations, damping arises from both physical energy dissipation and the numerical properties of the time integrator. This exercise tackles the crucial task of distinguishing between and designing for both types of damping. You will first design physical damping coefficients for a Rayleigh damping model to match target modal damping ratios, a common practice in calibrating material models, and then select an algorithmic parameter, $\\rho_{\\infty}$, to control spurious high-frequency oscillations.  This practice illuminates the different frequency-dependent characteristics of physical versus numerical damping, a key concept for building robust and accurate dynamic models.",
            "id": "3527639",
            "problem": "Consider a linear semi-discrete elastodynamic system arising in computational geomechanics with equations of motion given by $M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = f(t)$, where $M$ is the symmetric positive-definite mass matrix, $C$ is the damping matrix, and $K$ is the symmetric positive-definite stiffness matrix. Assume proportional (Rayleigh) damping $C = a_0 M + a_1 K$ with scalar coefficients $a_0$ and $a_1$. Let the undamped modal problem $K \\phi_j = \\omega_j^2 M \\phi_j$ define the natural circular frequencies $\\omega_j$ and corresponding orthonormal modal vectors $\\phi_j$ with respect to $M$.\n\nYou will compare the effects of Rayleigh damping and generalized-$\\alpha$ algorithmic dissipation (which reduces high-frequency content via the time integrator) on modal damping ratios, and design $(a_0,a_1,\\rho_\\infty)$ to achieve specified low- and high-frequency damping behavior. The generalized-$\\alpha$ method is a one-step, second-order accurate, unconditionally stable time integration scheme obtained by weighting equilibrium at an intermediate time $t_{n+\\alpha_f}$ and acceleration at $t_{n+\\alpha_m}$, with parameters $\\alpha_m$ and $\\alpha_f$ chosen to achieve a prescribed high-frequency spectral radius $\\rho_\\infty$; the Hilber-Hughes-Taylor (HHT) method is recovered as a special case when $\\alpha_m=0$ and $\\alpha_f=\\alpha$.\n\nStarting from fundamental modal dynamics $m_j \\ddot{q}_j + c_j \\dot{q}_j + k_j q_j = 0$, where $m_j = \\phi_j^{\\top} M \\phi_j$, $k_j = \\phi_j^{\\top} K \\phi_j = m_j \\omega_j^2$, and $c_j = \\phi_j^{\\top} C \\phi_j$, derive the expression for the modal damping ratio $\\zeta_j$ in terms of $(a_0,a_1)$ and $\\omega_j$. Then, for the generalized-$\\alpha$ method, analyze the amplification of the undamped single-mode equation $\\ddot{q} + \\omega^2 q = 0$ under the method and determine the high-frequency spectral radius $\\rho_\\infty$ as the modulus of the amplification factor in the limit $\\omega \\Delta t \\to \\infty$, relating it to $(\\alpha_m,\\alpha_f)$, and hence to a prescribed $\\rho_\\infty$.\n\nDesign the Rayleigh damping coefficients to meet the following physical damping specifications:\n- A low-frequency target modal damping ratio $\\zeta(\\omega_L) = 0.05$ at $\\omega_L = 20$,\n- A high-frequency target modal damping ratio $\\zeta(\\omega_H) = 0.02$ at $\\omega_H = 200$.\n\nAdditionally, design the generalized-$\\alpha$ algorithmic dissipation to have high-frequency spectral radius $\\rho_\\infty = \\dfrac{3}{5}$, and assume the time step $\\Delta t = 0.005$ in your discussion of algorithmic dissipation, although the design of $\\rho_\\infty$ itself is independent of $\\Delta t$.\n\nCompare the frequency dependence of physical Rayleigh modal damping ratios $\\zeta(\\omega)$ with the generalized-$\\alpha$ algorithmic dissipation characterized by $\\rho_\\infty$, emphasizing how each mechanism targets different parts of the spectrum.\n\nExpress your final design triple $(a_0,a_1,\\rho_\\infty)$ as exact values. Report $a_0$ in $\\text{s}^{-1}$, $a_1$ in $\\text{s}$, and $\\rho_\\infty$ as dimensionless. The answer must be a single row matrix using the LaTeX $\\mathrm{pmatrix}$ environment. No rounding is required.",
            "solution": "The problem statement will first be validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\nThe givens are listed verbatim from the problem statement:\n-   Equation of motion: $M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = f(t)$.\n-   $M$: symmetric positive-definite mass matrix.\n-   $C$: damping matrix.\n-   $K$: symmetric positive-definite stiffness matrix.\n-   Proportional (Rayleigh) damping: $C = a_0 M + a_1 K$.\n-   Undamped modal problem: $K \\phi_j = \\omega_j^2 M \\phi_j$ defining natural circular frequencies $\\omega_j$ and M-orthonormal modal vectors $\\phi_j$.\n-   Homogeneous modal dynamics: $m_j \\ddot{q}_j + c_j \\dot{q}_j + k_j q_j = 0$.\n-   Modal mass, stiffness, and damping: $m_j = \\phi_j^{\\top} M \\phi_j$, $k_j = \\phi_j^{\\top} K \\phi_j = m_j \\omega_j^2$, and $c_j = \\phi_j^{\\top} C \\phi_j$.\n-   Generalized-$\\alpha$ method description as a one-step, second-order accurate, unconditionally stable time integration scheme with parameters $(\\alpha_m, \\alpha_f)$ chosen to achieve a prescribed high-frequency spectral radius $\\rho_\\infty$.\n-   Physical damping specifications:\n    -   Low-frequency target: $\\zeta(\\omega_L) = 0.05$ at $\\omega_L = 20$.\n    -   High-frequency target: $\\zeta(\\omega_H) = 0.02$ at $\\omega_H = 200$.\n-   Algorithmic dissipation specification: $\\rho_\\infty = \\frac{3}{5}$.\n-   Time step for discussion: $\\Delta t = 0.005$.\n-   Output requirement: Design triple $(a_0, a_1, \\rho_\\infty)$ as exact values.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation checklist:\n-   **Scientifically Grounded (Critical)**: The problem is fundamentally based on established principles of linear elastodynamics, modal analysis, and numerical time integration (specifically, Rayleigh damping and the generalized-$\\alpha$ method). These are standard topics in computational geomechanics and structural dynamics. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides a clear objective and sufficient, consistent information to determine the required design parameters. The system of equations for the Rayleigh damping coefficients has a unique solution. The value for $\\rho_\\infty$ is a design choice that is explicitly provided. The problem is well-posed.\n-   **Objective (Critical)**: The problem is stated using precise, quantitative, and unbiased technical language. It is free from subjective or opinion-based statements.\n\n**Step 3: Verdict and Action**\nThe problem is found to be scientifically sound, well-posed, objective, and complete. No invalidating flaws are present. The solution process may proceed.\n\n### Solution Derivations and Design\n\n#### 1. Modal Damping Ratio for Rayleigh Damping\n\nThe analysis begins with the uncoupled equation of motion for the $j$-th mode under homogeneous conditions, $m_j \\ddot{q}_j + c_j \\dot{q}_j + k_j q_j = 0$. This can be normalized by the modal mass $m_j$ to yield:\n$$\n\\ddot{q}_j + \\frac{c_j}{m_j} \\dot{q}_j + \\frac{k_j}{m_j} q_j = 0\n$$\nFrom the definition of the modal problem, we have $k_j = \\omega_j^2 m_j$, so $\\frac{k_j}{m_j} = \\omega_j^2$. The standard form of a damped single-degree-of-freedom system is $\\ddot{x} + 2\\zeta\\omega \\dot{x} + \\omega^2 x = 0$. By comparing the coefficients, we identify $2\\zeta_j \\omega_j = \\frac{c_j}{m_j}$.\n\nThe modal damping coefficient, $c_j$, is given by the projection of the damping matrix $C$ onto the modal basis: $c_j = \\phi_j^{\\top} C \\phi_j$. Substituting the Rayleigh damping model $C = a_0 M + a_1 K$ gives:\n$$\nc_j = \\phi_j^{\\top} (a_0 M + a_1 K) \\phi_j = a_0 (\\phi_j^{\\top} M \\phi_j) + a_1 (\\phi_j^{\\top} K \\phi_j)\n$$\nUsing the definitions of modal mass $m_j = \\phi_j^{\\top} M \\phi_j$ and modal stiffness $k_j = \\phi_j^{\\top} K \\phi_j$, this becomes:\n$$\nc_j = a_0 m_j + a_1 k_j\n$$\nNow, substitute this expression for $c_j$ into the relation for the damping ratio:\n$$\n2\\zeta_j \\omega_j = \\frac{a_0 m_j + a_1 k_j}{m_j} = a_0 + a_1 \\frac{k_j}{m_j}\n$$\nSince $\\frac{k_j}{m_j} = \\omega_j^2$, we have:\n$$\n2\\zeta_j \\omega_j = a_0 + a_1 \\omega_j^2\n$$\nSolving for the modal damping ratio $\\zeta_j$ as a function of the natural frequency $\\omega_j$ yields the desired expression:\n$$\n\\zeta_j \\equiv \\zeta(\\omega_j) = \\frac{1}{2\\omega_j}(a_0 + a_1 \\omega_j^2) = \\frac{a_0}{2\\omega_j} + \\frac{a_1 \\omega_j}{2}\n$$\n\n#### 2. Design of Rayleigh Damping Coefficients $(a_0, a_1)$\n\nThe coefficients $a_0$ and $a_1$ are determined by solving a system of two linear equations based on the provided specifications:\n1.  At $\\omega_L = 20$, $\\zeta(\\omega_L) = 0.05$.\n2.  At $\\omega_H = 200$, $\\zeta(\\omega_H) = 0.02$.\n\nSubstituting these values into the expression for $\\zeta(\\omega)$:\n1.  $0.05 = \\frac{a_0}{2(20)} + \\frac{a_1(20)}{2} \\implies 0.05 = \\frac{a_0}{40} + 10 a_1$\n2.  $0.02 = \\frac{a_0}{2(200)} + \\frac{a_1(200)}{2} \\implies 0.02 = \\frac{a_0}{400} + 100 a_1$\n\nLet's solve this system. Multiply the first equation by $40$ and the second by $400$:\n1.  $40 \\times 0.05 = a_0 + 400 a_1 \\implies 2 = a_0 + 400 a_1$\n2.  $400 \\times 0.02 = a_0 + 40000 a_1 \\implies 8 = a_0 + 40000 a_1$\n\nSubtracting the first transformed equation from the second gives:\n$$\n(8-2) = (a_0 + 40000 a_1) - (a_0 + 400 a_1)\n$$\n$$\n6 = 39600 a_1\n$$\n$$\na_1 = \\frac{6}{39600} = \\frac{1}{6600}\n$$\nNow, substitute $a_1$ back into the first transformed equation ($2 = a_0 + 400 a_1$) to find $a_0$:\n$$\n2 = a_0 + 400 \\left(\\frac{1}{6600}\\right) = a_0 + \\frac{4}{66} = a_0 + \\frac{2}{33}\n$$\n$$\na_0 = 2 - \\frac{2}{33} = \\frac{66-2}{33} = \\frac{64}{33}\n$$\nThe Rayleigh damping coefficients are $a_0 = \\frac{64}{33} \\, \\text{s}^{-1}$ and $a_1 = \\frac{1}{6600} \\, \\text{s}$.\n\n#### 3. Algorithmic Dissipation in the Generalized-$\\alpha$ Method\n\nThe generalized-$\\alpha$ method introduces numerical dissipation controlled by its parameters. For second-order accuracy, the parameters $\\beta$ and $\\gamma$ are linked to $\\alpha_m$ and $\\alpha_f$. The distinguishing feature of the method is its ability to control high-frequency dissipation via the spectral radius $\\rho_\\infty \\in [0, 1]$, which is the limit of the modulus of the amplification factor as the product of frequency and time step, $\\omega \\Delta t$, approaches infinity. The relationship between $\\rho_\\infty$ and the primary parameters $(\\alpha_m, \\alpha_f)$ is definitional for designing the scheme. For a desired $\\rho_\\infty$, the parameters are chosen as:\n$$\n\\alpha_m = \\frac{2-\\rho_\\infty}{1+\\rho_\\infty}, \\quad \\alpha_f = \\frac{1}{1+\\rho_\\infty}\n$$\nThese ensure unconditional stability and second-order accuracy. In this problem, the design specification is $\\rho_\\infty = \\frac{3}{5}$. This value is thus a direct input to the design of the time integration scheme.\n\n#### 4. Comparison of Damping Mechanisms\n\nThe two damping mechanisms operate on different principles and target different aspects of the system's dynamic response.\n\n**Rayleigh Damping:**\n-   **Nature**: Represents physical energy dissipation within the material or at system boundaries. It is part of the physical model, described by the matrix $C = a_0 M + a_1 K$.\n-   **Frequency Dependence**: The damping ratio $\\zeta(\\omega) = \\frac{a_0}{2\\omega} + \\frac{a_1 \\omega}{2}$ is highly frequency-dependent. The mass-proportional term ($a_0$) provides damping that decreases with frequency, while the stiffness-proportional term ($a_1$) provides damping that increases with frequency. This results in a U-shaped curve for $\\zeta(\\omega)$ with a minimum at $\\omega = \\sqrt{a_0/a_1}$. For our designed parameters, this minimum occurs at $\\omega = \\sqrt{(\\frac{64}{33}) / (\\frac{1}{6600})} \\approx 113.14 \\, \\text{rad/s}$. The damping is tailored to be low in a specific frequency band and increases for both very low and very high frequencies. The specified damping values of $0.05$ and $0.02$ are quite low, which is typical for geologic materials at low strain.\n\n**Generalized-$\\alpha$ Algorithmic Dissipation:**\n-   **Nature**: This is a numerical artifact of the time integration algorithm, not a representation of a physical process. Its purpose is purely mathematical: to damp out spurious, non-physical high-frequency oscillations that arise from the spatial discretization (e.g., finite element meshing) and cannot be accurately represented by the mesh.\n-   **Frequency Dependence**: The dissipation is designed to act selectively on high frequencies. The algorithmic damping ratio is negligible for low-frequency modes where $\\omega \\Delta t \\ll 1$, ensuring that the physically important, slow dynamics are integrated accurately with minimal artificial damping. As frequency $\\omega$ increases, the algorithmic damping ratio increases monotonically and approaches a maximum value determined by $\\rho_\\infty$. With $\\Delta t = 0.005 \\, \\text{s}$, the effects become significant for modes with frequencies where $\\omega \\Delta t$ is on the order of $1$ or greater (i.e., $\\omega \\ge \\frac{1}{0.005} = 200 \\, \\text{rad/s}$).\n-   **Control**: The parameter $\\rho_\\infty$ provides direct control over the amount of high-frequency damping. A value of $\\rho_\\infty = 1$ corresponds to no dissipation (energy-conserving), while $\\rho_\\infty = 0$ corresponds to maximum dissipation (asymptotically annihilating high-frequency response in one step). The specified value $\\rho_\\infty = \\frac{3}{5} = 0.6$ provides a moderate level of high-frequency damping.\n\n**Summary of Comparison:**\n-   **Physical vs. Numerical**: Rayleigh damping models physical phenomena. Generalized-$\\alpha$ dissipation is a numerical tool.\n-   **Target Spectrum**: Rayleigh damping, as designed here, provides specific damping levels at chosen low and high frequencies, with a characteristic U-shaped profile. Generalized-$\\alpha$ dissipation acts as a low-pass filter, targeting all frequencies above a certain threshold (determined by $\\Delta t$) with increasing intensity, up to a limit set by $\\rho_\\infty$.\n-   **Purpose**: They are used together to achieve two different goals: modeling the known physical energy losses of the system (Rayleigh) and ensuring numerical robustness by filtering high-frequency numerical noise (generalized-$\\alpha$).\n\nThe final design triple $(a_0, a_1, \\rho_\\infty)$ consists of the calculated Rayleigh coefficients and the specified spectral radius.\n$a_0 = \\frac{64}{33}$\n$a_1 = \\frac{1}{6600}$\n$\\rho_\\infty = \\frac{3}{5}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{64}{33}  \\frac{1}{6600}  \\frac{3}{5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond forward simulation, time integration schemes are critical components in advanced frameworks for model calibration and inverse problems. This practice introduces the powerful discrete adjoint method, which offers an exceptionally efficient means of computing the sensitivity of a final state to all previous states. You will derive the reverse-time recursion for the adjoint variables corresponding to the generalized-$\\alpha$ integrator, a foundational technique for gradient-based optimization in large-scale geomechanical systems.  Understanding this derivation provides a gateway to leveraging dynamic simulations for sophisticated data assimilation and parameter estimation tasks.",
            "id": "3527593",
            "problem": "Consider a linear elastodynamic initial value problem arising from the spatial semi-discretization of small-strain dynamics in computational geomechanics. Let $M \\in \\mathbb{R}^{n \\times n}$, $C \\in \\mathbb{R}^{n \\times n}$, and $K \\in \\mathbb{R}^{n \\times n}$ be symmetric positive definite mass, damping, and stiffness matrices, respectively. The semi-discrete equation of motion is\n$$\nM\\,\\ddot{u}(t) + C\\,\\dot{u}(t) + K\\,u(t) = f(t),\n$$\nwhere $u(t) \\in \\mathbb{R}^{n}$ is the vector of nodal displacements, $\\dot{u}(t)$ is the velocity, $\\ddot{u}(t)$ is the acceleration, and $f(t)$ is the prescribed external load.\n\nTime integration is performed using the generalized-$\\alpha$ method (which reduces to the Hilber-Hughes-Taylor (HHT) method when $\\alpha_{m}=0$). For a uniform time step $\\Delta t0$ and parameters $\\alpha_{m},\\alpha_{f}\\in \\mathbb{R}$, and the Newmark parameters $\\beta,\\gamma \\in \\mathbb{R}$, define the weighted stage quantities\n$$\na_{n+\\alpha_{m}} := (1-\\alpha_{m})\\,a_{n+1} + \\alpha_{m}\\,a_{n}, \\quad\nv_{n+\\alpha_{f}} := (1-\\alpha_{f})\\,v_{n+1} + \\alpha_{f}\\,v_{n}, \\quad\nu_{n+\\alpha_{f}} := (1-\\alpha_{f})\\,u_{n+1} + \\alpha_{f}\\,u_{n},\n$$\nand the Newmark kinematic updates\n$$\nu_{n+1} = u_{n} + \\Delta t\\,v_{n} + \\Delta t^{2}\\left(\\tfrac{1}{2}-\\beta\\right)a_{n} + \\beta\\,\\Delta t^{2}\\,a_{n+1}, \\quad\nv_{n+1} = v_{n} + \\Delta t\\,(1-\\gamma)\\,a_{n} + \\gamma\\,\\Delta t\\,a_{n+1}.\n$$\nEquilibrium is enforced at the weighted stage:\n$$\nM\\,a_{n+\\alpha_{m}} + C\\,v_{n+\\alpha_{f}} + K\\,u_{n+\\alpha_{f}} = f_{n+\\alpha_{f}},\n$$\nwhere $f_{n+\\alpha_{f}} := (1-\\alpha_{f})\\,f_{n+1} + \\alpha_{f}\\,f_{n}$.\n\nIntroduce the state vector $y_{n} := \\begin{pmatrix} u_{n} \\\\ v_{n} \\\\ a_{n} \\end{pmatrix} \\in \\mathbb{R}^{3n}$ and suppose the load $f(t)$ is prescribed and independent of the state. Consider the terminal misfit functional\n$$\nJ(u_{N}) := \\tfrac{1}{2}\\left(u_{N} - u_{T}\\right)^{\\top} W \\left(u_{N} - u_{T}\\right),\n$$\nwith a target displacement $u_{T} \\in \\mathbb{R}^{n}$ and a symmetric positive definite weighting matrix $W \\in \\mathbb{R}^{n \\times n}$.\n\nYour tasks are:\n- Starting only from the definitions above, derive the one-step update in the form $y_{n+1} = A\\,y_{n} + B\\,f_{n+\\alpha_{f}}$, expressing the block matrices $A \\in \\mathbb{R}^{3n \\times 3n}$ and $B \\in \\mathbb{R}^{3n \\times n}$ explicitly in terms of $M$, $C$, $K$, $\\Delta t$, $\\alpha_{m}$, $\\alpha_{f}$, $\\beta$, and $\\gamma$.\n- Construct the corresponding discrete adjoint recursion for the adjoint variable $p_{n} := \\frac{\\partial \\mathcal{L}}{\\partial y_{n}} \\in \\mathbb{R}^{3n}$ associated with the Lagrangian of the constrained time-stepping dynamics, enforcing the dynamics as equality constraints over all steps. Assume no running cost and only the terminal misfit as given above.\n- Specify the reverse-time recursion, including the terminal condition $p_{N}$.\n- Provide, as your final answer, the closed-form analytic expression for $p_{n}$ in terms of $A$, $n$, $N$, $u_{N}$, $u_{T}$, and $W$. No numerical evaluation is required. Express your final answer as a single analytic expression. Do not include units. Do not round.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in computational mechanics, mathematically well-posed, objective, and internally consistent. All necessary information for the derivation is provided.\n\nThe tasks involve deriving the one-step update matrix for a generalized-$\\alpha$ time integration scheme, constructing the corresponding discrete adjoint system, and finding a closed-form solution for the adjoint variables.\n\n### Task 1: Derivation of the One-Step Update\nThe goal is to find matrices $A \\in \\mathbb{R}^{3n \\times 3n}$ and $B \\in \\mathbb{R}^{3n \\times n}$ such that the state update can be written as $y_{n+1} = A\\,y_{n} + B\\,f_{n+\\alpha_{f}}$, where $y_{n} = \\begin{pmatrix} u_{n}^{\\top}  v_{n}^{\\top}  a_{n}^{\\top} \\end{pmatrix}^{\\top}$.\n\nThe governing equations are:\n1.  Equilibrium at the weighted stage: $M\\,a_{n+\\alpha_{m}} + C\\,v_{n+\\alpha_{f}} + K\\,u_{n+\\alpha_{f}} = f_{n+\\alpha_{f}}$.\n2.  Newmark kinematic updates:\n    $u_{n+1} = u_{n} + \\Delta t\\,v_{n} + \\Delta t^{2}\\left(\\tfrac{1}{2}-\\beta\\right)a_{n} + \\beta\\,\\Delta t^{2}\\,a_{n+1}$\n    $v_{n+1} = v_{n} + \\Delta t\\,(1-\\gamma)\\,a_{n} + \\gamma\\,\\Delta t\\,a_{n+1}$\n3.  Definitions of weighted quantities:\n    $a_{n+\\alpha_{m}} = (1-\\alpha_{m})\\,a_{n+1} + \\alpha_{m}\\,a_{n}$\n    $v_{n+\\alpha_{f}} = (1-\\alpha_{f})\\,v_{n+1} + \\alpha_{f}\\,v_{n}$\n    $u_{n+\\alpha_{f}} = (1-\\alpha_{f})\\,u_{n+1} + \\alpha_{f}\\,u_{n}$\n\nWe begin by substituting the definitions of the weighted quantities into the equilibrium equation:\n$$\nM((1-\\alpha_{m})\\,a_{n+1} + \\alpha_{m}\\,a_{n}) + C((1-\\alpha_{f})\\,v_{n+1} + \\alpha_{f}\\,v_{n}) + K((1-\\alpha_{f})\\,u_{n+1} + \\alpha_{f}\\,u_{n}) = f_{n+\\alpha_{f}}\n$$\nNext, substitute the Newmark update rules for $u_{n+1}$ and $v_{n+1}$ into this equation to obtain an equation solely in terms of $a_{n+1}$ and known quantities at step $n$.\n$$\n\\begin{aligned}\n(1-\\alpha_{m})M a_{n+1} + (1-\\alpha_{f})C \\left( v_{n} + \\Delta t(1-\\gamma)a_{n} + \\gamma\\Delta t a_{n+1} \\right) \\\\\n+ (1-\\alpha_{f})K \\left( u_{n} + \\Delta t v_{n} + \\Delta t^2(\\tfrac{1}{2}-\\beta)a_{n} + \\beta\\Delta t^2 a_{n+1} \\right) \\\\\n= f_{n+\\alpha_{f}} - \\alpha_{m}M a_{n} - \\alpha_{f}C v_{n} - \\alpha_{f}K u_{n}\n\\end{aligned}\n$$\nWe collect all terms involving $a_{n+1}$ on the left-hand side (LHS) and all other terms on the right-hand side (RHS).\n$$\n\\left[ (1-\\alpha_{m})M + (1-\\alpha_{f})\\gamma\\Delta t C + (1-\\alpha_{f})\\beta\\Delta t^2 K \\right] a_{n+1} = \\text{RHS}\n$$\nLet's define the effective stiffness matrix $\\tilde{K}$:\n$$\n\\tilde{K} := (1-\\alpha_{m})M + (1-\\alpha_{f})\\gamma\\Delta t C + (1-\\alpha_{f})\\beta\\Delta t^2 K\n$$\nSince $M$, $C$, and $K$ are symmetric positive definite, for standard choices of non-negative parameters, $\\tilde{K}$ is invertible.\n\nThe RHS is constructed by moving all terms not involving $a_{n+1}$ from the LHS:\n$$\n\\begin{aligned}\n\\text{RHS} = f_{n+\\alpha_{f}} - \\alpha_{m}M a_{n} - \\alpha_{f}C v_{n} - \\alpha_{f}K u_{n} \\\\\n\\quad - (1-\\alpha_{f})C(v_n + \\Delta t(1-\\gamma)a_n) - (1-\\alpha_{f})K(u_n + \\Delta t v_n + \\Delta t^2(\\tfrac{1}{2}-\\beta)a_n)\n\\end{aligned}\n$$\nCombining terms by $u_n, v_n, a_n$:\n$$\n\\begin{aligned}\n\\text{RHS} = f_{n+\\alpha_{f}} - K u_n - (C + (1-\\alpha_f)\\Delta t K) v_n \\\\\n\\quad - \\left(\\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\tfrac{1}{2}-\\beta)\\Delta t^2 K\\right) a_n\n\\end{aligned}\n$$\nSolving for $a_{n+1}$ yields:\n$$\na_{n+1} = \\tilde{K}^{-1} \\left[ f_{n+\\alpha_{f}} - K u_n - (C + (1-\\alpha_f)\\Delta t K) v_n - \\left(\\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\tfrac{1}{2}-\\beta)\\Delta t^2 K\\right) a_n \\right]\n$$\nThis defines the third row of the update equation $y_{n+1} = Ay_n + B f_{n+\\alpha_f}$. Let $a_{n+1} = A_{31}u_n + A_{32}v_n + A_{33}a_n + B_3 f_{n+\\alpha_f}$. The block matrices are:\n$$\n\\begin{aligned}\nA_{31} = -\\tilde{K}^{-1}K \\\\\nA_{32} = -\\tilde{K}^{-1}(C + (1-\\alpha_f)\\Delta t K) \\\\\nA_{33} = -\\tilde{K}^{-1}\\left(\\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\tfrac{1}{2}-\\beta)\\Delta t^2 K\\right) \\\\\nB_{3} = \\tilde{K}^{-1}\n\\end{aligned}\n$$\nNow, we substitute this expression for $a_{n+1}$ back into the Newmark updates for $u_{n+1}$ and $v_{n+1}$.\nFor $v_{n+1}$:\n$$\n\\begin{aligned}\nv_{n+1} = v_n + \\Delta t(1-\\gamma)a_n + \\gamma\\Delta t a_{n+1} \\\\\n= (\\gamma\\Delta t A_{31})u_n + (I + \\gamma\\Delta t A_{32})v_n + (\\Delta t(1-\\gamma)I + \\gamma\\Delta t A_{33})a_n + (\\gamma\\Delta t B_3)f_{n+\\alpha_f}\n\\end{aligned}\n$$\nThis gives the second row of blocks: $A_{21} = \\gamma\\Delta t A_{31}$, $A_{22} = I + \\gamma\\Delta t A_{32}$, $A_{23} = \\Delta t(1-\\gamma)I + \\gamma\\Delta t A_{33}$, and $B_2 = \\gamma\\Delta t B_3$.\n\nFor $u_{n+1}$:\n$$\n\\begin{aligned}\nu_{n+1} = u_n + \\Delta t v_n + \\Delta t^2(\\tfrac{1}{2}-\\beta)a_n + \\beta\\Delta t^2 a_{n+1} \\\\\n= (I + \\beta\\Delta t^2 A_{31})u_n + (\\Delta t I + \\beta\\Delta t^2 A_{32})v_n + (\\Delta t^2(\\tfrac{1}{2}-\\beta)I + \\beta\\Delta t^2 A_{33})a_n + (\\beta\\Delta t^2 B_3)f_{n+\\alpha_f}\n\\end{aligned}\n$$\nThis gives the first row of blocks: $A_{11} = I + \\beta\\Delta t^2 A_{31}$, $A_{12} = \\Delta t I + \\beta\\Delta t^2 A_{32}$, $A_{13} = \\Delta t^2(\\tfrac{1}{2}-\\beta)I + \\beta\\Delta t^2 A_{33}$, and $B_1 = \\beta\\Delta t^2 B_3$.\n\nThe complete block matrices $A$ and $B$ are:\n$$\nA = \\begin{pmatrix}\nI + \\beta\\Delta t^2 A_{31}  \\Delta t I + \\beta\\Delta t^2 A_{32}  \\Delta t^2(\\frac{1}{2}-\\beta)I + \\beta\\Delta t^2 A_{33} \\\\\n\\gamma\\Delta t A_{31}  I + \\gamma\\Delta t A_{32}  \\Delta t(1-\\gamma)I + \\gamma\\Delta t A_{33} \\\\\nA_{31}  A_{32}  A_{33}\n\\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix}\n\\beta\\Delta t^2 B_3 \\\\\n\\gamma\\Delta t B_3 \\\\\nB_3\n\\end{pmatrix} = \\begin{pmatrix} \\beta\\Delta t^2 \\\\ \\gamma\\Delta t \\\\ 1 \\end{pmatrix} \\otimes \\tilde{K}^{-1}\n$$\n\n### Tasks 2  3: Discrete Adjoint Recursion and Terminal Condition\nWe approach this using the method of Lagrange multipliers, also known as the adjoint method. The problem is to minimize the terminal cost $J(u_N)$ subject to the dynamic constraints $y_{n+1} = A y_n + B f_{n+\\alpha_f}$ for $n=0, \\dots, N-1$.\nThe Lagrangian $\\mathcal{L}$ for this constrained optimization problem is:\n$$\n\\mathcal{L} = J(u_N) + \\sum_{n=0}^{N-1} p_{n+1}^{\\top} (A y_n + B f_{n+\\alpha_f} - y_{n+1})\n$$\nHere, $p_{n+1}$ is the vector of Lagrange multipliers (or costates/adjoint variables) associated with the dynamic constraint at step $n \\to n+1$. The wording of the problem, $p_n := \\frac{\\partial\\mathcal{L}}{\\partial y_n}$, is slightly ambiguous. In optimization, we set this derivative to zero. A more standard interpretation, which we adopt, is that $p_n$ is the costate variable itself, which represents the sensitivity of the objective function to a perturbation in the state $y_n$. This is equivalent to setting up the KKT conditions for optimality. The stationarity condition with respect to an intermediate state $y_n$ ($1 \\le n \\le N-1$) is $\\frac{\\partial\\mathcal{L}}{\\partial y_n} = 0$.\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial y_n} = A^{\\top}p_{n+1} - p_n = 0 \\implies p_n = A^{\\top}p_{n+1}\n$$\nThis defines the reverse-time recursion for the adjoint variables. It is valid for $n = N-1, N-2, \\dots, 1$.\n\nThe terminal condition for the adjoint recursion is found by taking the derivative with respect to the final state $y_N$:\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial y_N} = \\frac{\\partial J(u_N)}{\\partial y_N} - p_N = 0 \\implies p_N = \\frac{\\partial J(u_N)}{\\partial y_N}\n$$\nThe cost functional is $J(u_N) = \\frac{1}{2}(u_N - u_T)^{\\top}W(u_N - u_T)$. We can write $u_N = E y_N$ where $E=\\begin{pmatrix} I  0  0 \\end{pmatrix}$ is a $n \\times 3n$ projection matrix.\n$$\nJ(y_N) = \\tfrac{1}{2}(E y_N - u_T)^{\\top}W(E y_N - u_T) = \\tfrac{1}{2}y_N^{\\top}E^{\\top}WEy_N - y_N^{\\top}E^{\\top}Wu_T + \\tfrac{1}{2}u_T^{\\top}Wu_T\n$$\nThe gradient with respect to $y_N$ is:\n$$\n\\frac{\\partial J}{\\partial y_N} = E^{\\top}WEy_N - E^{\\top}Wu_T = E^{\\top}W(Ey_N - u_T) = E^{\\top}W(u_N - u_T)\n$$\nSubstituting the definition of $E^{\\top} = \\begin{pmatrix} I \\\\ 0 \\\\ 0 \\end{pmatrix}$:\n$$\np_N = \\begin{pmatrix} I \\\\ 0 \\\\ 0 \\end{pmatrix} W(u_N - u_T) = \\begin{pmatrix} W(u_N - u_T) \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nSo, the full adjoint system is:\n-   **Reverse-time recursion:** $p_n = A^{\\top}p_{n+1}$ for $n = N-1, \\dots, 0$.\n-   **Terminal condition:** $p_N = \\begin{pmatrix} W(u_N - u_T) \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n\n### Task 4: Closed-Form Expression for $p_n$\nThe adjoint recursion is a linear recurrence relation that can be solved by unrolling it backwards from the terminal time $N$.\n$$\np_{N-1} = A^{\\top}p_N\n$$\n$$\np_{N-2} = A^{\\top}p_{N-1} = A^{\\top}(A^{\\top}p_N) = (A^{\\top})^2 p_N\n$$\nBy induction, the solution for any $n \\le N$ is:\n$$\np_n = (A^{\\top})^{N-n} p_N\n$$\nSubstituting the expression for the terminal condition $p_N$:\n$$\np_n = (A^{\\top})^{N-n} \\begin{pmatrix} W(u_N - u_T) \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis is the closed-form analytic expression for the adjoint state $p_n$ in terms of the specified quantities.",
            "answer": "$$ \\boxed{ (A^{\\top})^{N-n} \\begin{pmatrix} W(u_N - u_T) \\\\ 0 \\\\ 0 \\end{pmatrix} } $$"
        }
    ]
}