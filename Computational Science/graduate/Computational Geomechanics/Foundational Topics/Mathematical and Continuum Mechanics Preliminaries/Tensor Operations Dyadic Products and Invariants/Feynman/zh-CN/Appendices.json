{
    "hands_on_practices": [
        {
            "introduction": "在深入研究本构模型之前，掌握如何从张量的分量形式直接计算其主不变量是至关重要的第一步。这些不变量，即 $I_1$、$I_2$ 和 $I_3$，是许多各向同性材料模型的基石，因为它们以标量形式捕捉了应力状态的内在特性。本练习将引导你从特征多项式出发，推导不变量的计算公式，并通过一个具体例子，让你熟练掌握这一基本计算技能。",
            "id": "3567001",
            "problem": "在计算岩土力学中，各向同性本构模型和屈服函数通常依赖于柯西应力张量的标量不变量。考虑一个无量纲的对称二阶张量 $T$，它表示在准静态加载下通过有限元计算获得的土体单元的应力状态。主不变量是 $T$ 的特征多项式的标量系数，定义为\n$$\np(\\lambda) = \\det(\\lambda I - T) = \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3},\n$$\n其中 $I$ 是二阶单位张量。从该定义和标准张量运算出发，推导 $I_{1}$、$I_{2}$ 和 $I_{3}$ 关于 $T$ 的迹、行列式以及 $T$ 的平方的迹的表达式。你的推导必须仅依赖于 $T$ 的谱表示、迹算子的性质、并矢积以及弗罗贝尼乌斯内积。\n\n然后，计算以下张量的不变量\n$$\nT=\\begin{bmatrix}3 & -1 & 0\\\\-1 & 2 & 1\\\\0 & 1 & 1\\end{bmatrix}.\n$$\n\n使用 LaTeX 的 $\\operatorname{pmatrix}$ 环境将最终的三元组 $(I_{1},I_{2},I_{3})$ 表示为行矩阵。无需四舍五入，也无需物理单位。",
            "solution": "该问题经评估有效。它在科学上基于张量代数和连续介质力学，问题提法恰当、客观，并包含获得唯一解所需的所有信息。\n\n该问题包括两个部分：首先，推导对称二阶张量 $T$ 的主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 关于其迹、行列式及其平方的迹的表达式；其次，计算一个特定张量的这些不变量。\n\n### 第1部分：不变量的推导\n\n给定三维空间中二阶张量 $T$ 的特征多项式：\n$$\np(\\lambda) = \\det(\\lambda I - T) = \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3}\n$$\n该多项式的根 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 是 $T$ 的特征值。因此，特征多项式可以写成其因式分解形式：\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2})(\\lambda - \\lambda_{3})\n$$\n展开此因式分解形式可得：\n$$\np(\\lambda) = (\\lambda^{2} - (\\lambda_{1} + \\lambda_{2})\\lambda + \\lambda_{1}\\lambda_{2})(\\lambda - \\lambda_{3})\n$$\n$$\np(\\lambda) = \\lambda^{3} - \\lambda_{3}\\lambda^{2} - (\\lambda_{1} + \\lambda_{2})\\lambda^{2} + (\\lambda_{1} + \\lambda_{2})\\lambda_{3}\\lambda + \\lambda_{1}\\lambda_{2}\\lambda - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n$$\np(\\lambda) = \\lambda^{3} - (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})\\lambda^{2} + (\\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1})\\lambda - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n通过将此展开多项式的系数与给定定义进行比较，我们可以确定用特征值表示的主不变量：\n$$\nI_{1} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\n$$\nI_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1}\n$$\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n下一步是将这些表达式与指定的张量运算联系起来。张量 $T$ 被说明为对称的，这保证了它具有实特征值和一组标准正交的特征向量基 $\\{n_{1}, n_{2}, n_{3}\\}$。这使得 $T$ 可以进行谱表示：\n$$\nT = \\sum_{i=1}^{3} \\lambda_{i} (n_{i} \\otimes n_{i})\n$$\n其中 $\\otimes$ 表示并矢积。\n\n**$I_{1}$ 的推导：**\n第一个不变量 $I_{1}$ 是特征值之和。根据定义，这正是张量 $T$ 的迹，记作 $\\operatorname{tr}(T)$。我们可以使用谱表示和迹算子的性质来证明这一点。迹是一个线性算子，所以：\n$$\n\\operatorname{tr}(T) = \\operatorname{tr}\\left(\\sum_{i=1}^{3} \\lambda_{i} (n_{i} \\otimes n_{i})\\right) = \\sum_{i=1}^{3} \\lambda_{i} \\operatorname{tr}(n_{i} \\otimes n_{i})\n$$\n并矢积 $u \\otimes v$ 的迹是它们的标量积，$\\operatorname{tr}(u \\otimes v) = u \\cdot v$。由于特征向量 $\\{n_{i}\\}$ 构成一个标准正交基，所以 $n_{i} \\cdot n_{i} = \\|n_{i}\\|^{2} = 1$。因此，$\\operatorname{tr}(n_{i} \\otimes n_{i}) = 1$。\n$$\n\\operatorname{tr}(T) = \\sum_{i=1}^{3} \\lambda_{i} (1) = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\n因此，第一个不变量是张量的迹：\n$$\nI_{1} = \\operatorname{tr}(T)\n$$\n\n**$I_{3}$ 的推导：**\n第三个不变量 $I_{3}$ 是特征值之积。这是张量行列式的一个基本性质。\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3} = \\det(T)\n$$\n\n**$I_{2}$ 的推导：**\n第二个不变量 $I_{2}$ 的推导需要更多的代数操作。我们从考虑第一个不变量的平方开始：\n$$\nI_{1}^{2} = (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})^{2} = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2} + 2(\\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1})\n$$\n识别出 $I_{2}$ 的表达式和特征值平方和，我们可以写出：\n$$\nI_{1}^{2} = \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) + 2I_{2}\n$$\n对 $I_{2}$ 进行整理：\n$$\nI_{2} = \\frac{1}{2} \\left[ I_{1}^{2} - \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) \\right] = \\frac{1}{2} \\left[ (\\operatorname{tr}(T))^{2} - \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) \\right]\n$$\n现在我们必须将特征值的平方和 $\\sum_{i=1}^{3} \\lambda_{i}^{2}$ 与一个张量运算联系起来。让我们考虑张量 $T^{2} = T \\cdot T$。$T^{2}$ 的特征值是 $T$ 特征值的平方，即 $\\lambda_{1}^{2}, \\lambda_{2}^{2}, \\lambda_{3}^{2}$。因此，$T^{2}$ 的迹是其特征值之和：\n$$\n\\operatorname{tr}(T^{2}) = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\n按照要求，这可以使用弗罗贝尼乌斯内积（$A:B = \\operatorname{tr}(A^{T}B)$）更正式地证明。对于对称张量 $T$，$\\operatorname{tr}(T^{2}) = \\operatorname{tr}(T^{T}T) = T:T$。弗罗贝尼乌斯内积在标准正交基变换下是不变的。在特征向量的主基 $\\{n_i\\}$ 中，张量 $T$ 由一个对角矩阵表示，其对角元为 $\\lambda_1, \\lambda_2, \\lambda_3$。在这个基中，弗罗贝尼乌斯内积就是对角元平方的和：\n$$\n\\operatorname{tr}(T^{2}) = T:T = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\n将这个结果代入 $I_{2}$ 的表达式中：\n$$\nI_{2} = \\frac{1}{2} [(\\operatorname{tr}(T))^{2} - \\operatorname{tr}(T^{2})]\n$$\n推导现已完成。\n\n### 第2部分：特定张量的计算\n\n给定张量：\n$$\nT=\\begin{bmatrix}3 & -1 & 0\\\\-1 & 2 & 1\\\\0 & 1 & 1\\end{bmatrix}\n$$\n我们使用推导出的公式计算不变量。\n\n**计算 $I_{1}$：**\n第一个不变量是 $T$ 的迹。\n$$\nI_{1} = \\operatorname{tr}(T) = 3 + 2 + 1 = 6\n$$\n\n**计算 $I_{3}$：**\n第三个不变量是 $T$ 的行列式。\n$$\nI_{3} = \\det(T) = 3\\begin{vmatrix} 2  & 1 \\\\ 1  & 1 \\end{vmatrix} - (-1)\\begin{vmatrix} -1 &  1 \\\\ 0 &  1 \\end{vmatrix} + 0\\begin{vmatrix} -1 &  2 \\\\ 0 &  1 \\end{vmatrix}\n$$\n$$\nI_{3} = 3(2 \\cdot 1 - 1 \\cdot 1) + 1(-1 \\cdot 1 - 0 \\cdot 1) + 0 = 3(1) + 1(-1) = 3 - 1 = 2\n$$\n\n**计算 $I_{2}$：**\n为了计算 $I_{2}$，我们首先需要求出 $T^{2}$ 及其迹。\n$$\nT^{2} = T \\cdot T = \\begin{bmatrix}3 & -1 & 0\\\\-1 & 2 & 1\\\\0 & 1 & 1\\end{bmatrix} \\begin{bmatrix}3 & -1 & 0\\\\-1 & 2 & 1\\\\0 & 1 & 1\\end{bmatrix}\n$$\n$$\nT^{2} = \\begin{bmatrix} (3)(3)+(-1)(-1)+(0)(0) &  (3)(-1)+(-1)(2)+(0)(1) &  (3)(0)+(-1)(1)+(0)(1) \\\\ (-1)(3)+(2)(-1)+(1)(0) &  (-1)(-1)+(2)(2)+(1)(1) &  (-1)(0)+(2)(1)+(1)(1) \\\\ (0)(3)+(1)(-1)+(1)(0) &  (0)(-1)+(1)(2)+(1)(1) &  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix}\n$$\n$$\nT^{2} = \\begin{bmatrix} 9+1 &  -3-2 &  -1 \\\\ -3-2 &  1+4+1 &  2+1 \\\\ -1 &  2+1 &  1+1 \\end{bmatrix} = \\begin{bmatrix} 10 &  -5 &  -1 \\\\ -5 &  6 &  3 \\\\ -1 &  3 &  2 \\end{bmatrix}\n$$\n$T^{2}$ 的迹是：\n$$\n\\operatorname{tr}(T^{2}) = 10 + 6 + 2 = 18\n$$\n现在我们可以计算 $I_{2}$：\n$$\nI_{2} = \\frac{1}{2} [(\\operatorname{tr}(T))^{2} - \\operatorname{tr}(T^{2})] = \\frac{1}{2} [6^{2} - 18] = \\frac{1}{2} [36 - 18] = \\frac{1}{2} [18] = 9\n$$\n主不变量为 $I_{1}=6$、$I_{2}=9$ 和 $I_{3}=2$。\n\n最终结果是三元组 $(I_{1}, I_{2}, I_{3})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 6 & 9 & 2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然我们可以从张量分量计算不变量，但它们的真正本质植根于张量的特征值，在力学中即为主应力。本练习旨在通过验证冯·米塞斯 (von Mises) 等效应力的两种等价计算方法，来巩固不变量与主应力之间的这一重要联系。你将通过具体计算证明，基于偏应力不变量 $J_2$ 的公式与基于主应力差的公式将得到完全相同的结果，从而加深对不变量物理意义的理解。",
            "id": "3567018",
            "problem": "在计算岩土力学的三维有限变形分析中，一个均质、各向同性的土体单元承受一个柯西应力张量 $\\,\\boldsymbol{\\sigma}\\,$（单位为兆帕）。某物质点的应力测量为\n$$\n\\boldsymbol{\\sigma} \\;=\\;\n\\begin{pmatrix}\n120  &40  &0 \\\\\n40  &60  &0 \\\\\n0  &0  &80\n\\end{pmatrix}.\n$$\n严格根据柯西应力、偏应力 $\\,\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 以及偏应力第二不变量 $\\,J_{2} = \\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}\\,$（其中 $:$ 表示双点积）的定义，完成以下任务：\n\n1. 根据 $\\,\\boldsymbol{\\sigma}\\,$ 计算不变量 $\\,J_{2}\\,$。\n2. 将应力张量视为对称算子，通过提取其特征值来计算主应力。\n3. 仅使用这些基本定义，通过不变量公式以及独立地通过主应力公式推导 von Mises 等效应力 $\\,\\sigma_{\\mathrm{eq}}\\,$，并证明对于给定的 $\\,\\boldsymbol{\\sigma}\\,$，这两个结果是相同的。\n4. 报告 $\\,\\sigma_{\\mathrm{eq}}\\,$ 的共同值。\n\n最终的等效应力以兆帕（MPa）为单位表示，并将您的答案四舍五入至四位有效数字。仅提供最终的数值作为答案。如果出现角度，必须以弧度表示。百分比必须以小数或分数表示，不得使用百分号。",
            "solution": "该问题要求针对给定的柯西应力张量 $\\boldsymbol{\\sigma}$，使用两种不同但等价的公式计算 von Mises 等效应力 $\\sigma_{\\mathrm{eq}}$。我们将通过证明这两种公式对所提供的张量得出相同的结果来验证其有效性。该过程涉及计算偏应力张量的第二不变量 $J_2$ 和主应力。\n\n给定的柯西应力张量为：\n$$\n\\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n120  & 40 &  0 \\\\\n40  & 60 &  0 \\\\\n0  & 0  & 80\n\\end{pmatrix} \\text{ MPa}\n$$\n\n解题过程将按要求分为四个部分：\n1.  计算不变量 $J_2$。\n2.  计算主应力。\n3.  通过基于不变量和基于主应力的公式计算 $\\sigma_{\\mathrm{eq}}$。\n4.  报告最终数值。\n\n**1. 计算不变量 $J_2$**\n\n偏应力张量 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是二阶单位张量。首先，我们计算 $\\boldsymbol{\\sigma}$ 的迹：\n$$\n\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33} = 120 + 60 + 80 = 260 \\text{ MPa}\n$$\n平均应力 $\\sigma_m$ 是迹的三分之一：\n$$\n\\sigma_m = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{260}{3} \\text{ MPa}\n$$\n现在，我们可以计算偏应力张量 $\\boldsymbol{s}$ 的分量：\n$$\ns_{ij} = \\sigma_{ij} - \\sigma_m \\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是克罗内克符号。\n$$\n\\boldsymbol{s} =\n\\begin{pmatrix}\n120 - \\frac{260}{3} & 40 & 0 \\\\\n40 & 60 - \\frac{260}{3} & 0 \\\\\n0 & 0 & 80 - \\frac{260}{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{360 - 260}{3} & 40 & 0 \\\\\n40 & \\frac{180 - 260}{3} & 0 \\\\\n0 & 0 & \\frac{240 - 260}{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{100}{3} & 40 & 0 \\\\\n40 & -\\frac{80}{3} & 0 \\\\\n0 & 0 & -\\frac{20}{3}\n\\end{pmatrix} \\text{ MPa}\n$$\n偏应力张量的第二不变量 $J_2$ 定义为 $J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$，其中双点积 $\\boldsymbol{s}:\\boldsymbol{s} = \\sum_i \\sum_j s_{ij}s_{ji}$。由于 $\\boldsymbol{s}$ 是对称的，这等于 $\\sum_i \\sum_j s_{ij}^2$。\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = \\left(\\frac{100}{3}\\right)^2 + (40)^2 + (0)^2 + (40)^2 + \\left(-\\frac{80}{3}\\right)^2 + (0)^2 + (0)^2 + (0)^2 + \\left(-\\frac{20}{3}\\right)^2\n$$\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = \\frac{10000}{9} + 1600 + 1600 + \\frac{6400}{9} + \\frac{400}{9} = \\frac{10000 + 6400 + 400}{9} + 3200 = \\frac{16800}{9} + 3200\n$$\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = \\frac{5600}{3} + \\frac{9600}{3} = \\frac{15200}{3} \\text{ MPa}^2\n$$\n现在，我们求 $J_2$：\n$$\nJ_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s} = \\frac{1}{2}\\left(\\frac{15200}{3}\\right) = \\frac{7600}{3} \\text{ MPa}^2\n$$\n\n**2. 计算主应力**\n\n主应力，记作 $\\sigma_1, \\sigma_2, \\sigma_3$，是柯西应力张量 $\\boldsymbol{\\sigma}$ 的特征值。它们通过求解特征方程 $\\det(\\boldsymbol{\\sigma} - \\lambda\\boldsymbol{I}) = 0$ 得到。\n$$\n\\det\\begin{pmatrix}\n120-\\lambda & 40 & 0 \\\\\n40 & 60-\\lambda & 0 \\\\\n0 & 0 & 80-\\lambda\n\\end{pmatrix} = 0\n$$\n沿第三行展开行列式：\n$$\n(80 - \\lambda) \\det\\begin{pmatrix}\n120-\\lambda & 40 \\\\\n40 & 60-\\lambda\n\\end{pmatrix} = 0\n$$\n$$\n(80 - \\lambda) \\left[ (120 - \\lambda)(60 - \\lambda) - (40)(40) \\right] = 0\n$$\n该方程立即给出一个特征值：$\\lambda_3 = 80$ MPa。另外两个特征值是以下二次方程的根：\n$$\n(120 - \\lambda)(60 - \\lambda) - 1600 = 0\n$$\n$$\n7200 - 120\\lambda - 60\\lambda + \\lambda^2 - 1600 = 0\n$$\n$$\n\\lambda^2 - 180\\lambda + 5600 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda = \\frac{180 \\pm \\sqrt{(-180)^2 - 4(1)(5600)}}{2} = \\frac{180 \\pm \\sqrt{32400 - 22400}}{2} = \\frac{180 \\pm \\sqrt{10000}}{2} = \\frac{180 \\pm 100}{2}\n$$\n另外两个特征值是：\n$$\n\\lambda_1 = \\frac{180 + 100}{2} = 140 \\text{ MPa}\n$$\n$$\n\\lambda_2 = \\frac{180 - 100}{2} = 40 \\text{ MPa}\n$$\n按照惯例，主应力按 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$ 的顺序排列。\n主应力为 $\\sigma_1 = 140$ MPa, $\\sigma_2 = 80$ MPa, and $\\sigma_3 = 40$ MPa。\n\n**3. $\\sigma_{\\mathrm{eq}}$ 等价公式的证明**\n\nvon Mises 等效应力 $\\sigma_{\\mathrm{eq}}$ 可以通过两种方式计算。我们将使用这两种方法进行计算，并验证它们产生相同的结果。\n\n**基于不变量的公式：**\nvon Mises 应力用 $J_2$ 定义为：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{3 J_2}\n$$\n使用我们计算出的 $J_2$ 值：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{3 \\left(\\frac{7600}{3}\\right)} = \\sqrt{7600} \\text{ MPa}\n$$\n\n**基于主应力的公式：**\n用主应力表示，von Mises 应力由下式给出：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - \\sigma_3)^2 + (\\sigma_3 - \\sigma_1)^2\\right]}\n$$\n代入计算出的主应力：\n$$\n\\sigma_1 - \\sigma_2 = 140 - 80 = 60 \\text{ MPa}\n$$\n$$\n\\sigma_2 - \\sigma_3 = 80 - 40 = 40 \\text{ MPa}\n$$\n$$\n\\sigma_3 - \\sigma_1 = 40 - 140 = -100 \\text{ MPa}\n$$\n现在，我们计算 $\\sigma_{\\mathrm{eq}}$：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{1}{2}\\left[(60)^2 + (40)^2 + (-100)^2\\right]} = \\sqrt{\\frac{1}{2}\\left[3600 + 1600 + 10000\\right]}\n$$\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{1}{2}\\left[15200\\right]} = \\sqrt{7600} \\text{ MPa}\n$$\n两种公式都得出了相同的结果 $\\sigma_{\\mathrm{eq}} = \\sqrt{7600}$ MPa，从而证实了对于给定的应力状态，它们是等价的。\n\n**4. 最终数值**\n\nvon Mises 等效应力的共同值为 $\\sqrt{7600}$。为了提供四舍五入到四位有效数字的数值答案，我们计算其值：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{7600} = \\sqrt{100 \\times 76} = 10\\sqrt{76} \\approx 87.177978... \\text{ MPa}\n$$\n四舍五入到四位有效数字得到：\n$$\n\\sigma_{\\mathrm{eq}} \\approx 87.18 \\text{ MPa}\n$$",
            "answer": "$$\\boxed{87.18}$$"
        },
        {
            "introduction": "不变量最根本的特性在于其不依赖于坐标系的选择，即它们在坐标旋转下保持不变。本练习将理论付诸实践，要求你构建一个单元测试来数值验证应力不变量的旋转不变性。通过实现不变量的计算并测试其在任意旋转变换 $\\sigma' = Q \\sigma Q^\\top$ 下的恒定性，你将掌握验证计算力学代码正确性的关键技能，并对不变量的定义获得直观而深刻的认识。",
            "id": "3567010",
            "problem": "构建一个完整、可运行的程序，该程序实现一个确定性单元测试套件，以验证三维（$3$）计算岩土力学中应力张量不变量的旋转不变性。设 $Q \\in \\mathrm{SO}(3)$ 为一个旋转，Cauchy 应力张量为一个实对称二阶张量 $\\,\\sigma \\in \\mathbb{R}^{3 \\times 3}\\,$。在通过 $Q$ 进行基变换时，应力变换为 $\\sigma \\mapsto \\sigma' = Q \\,\\sigma\\, Q^\\top$。根据第一性原理，不变量是由 $\\sigma$ 的特征值构造的、与基无关的量，因此它们在这种变换下应保持不变。\n\n您的程序必须：\n- 实现二阶张量 $\\,\\sigma\\,$ 的主不变量：\n  - $I_1 = \\mathrm{tr}(\\sigma)$，\n  - $I_2 = \\tfrac{1}{2}\\big(\\mathrm{tr}(\\sigma)^2 - \\mathrm{tr}(\\sigma^2)\\big)$，\n  - $I_3 = \\det(\\sigma)$。\n- 实现平均应力 $p$、偏应力第二不变量 $J_2$、应力大小 $q$ 和 Lode 角 $\\theta$：\n  - $p = \\tfrac{1}{3} I_1$，\n  - $s = \\sigma - p\\,\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量，\n  - $J_2 = \\tfrac{1}{2}\\, s:s = \\tfrac{1}{2}\\,\\mathrm{tr}(s^2)$，\n  - $q = \\sqrt{3\\,J_2}$，\n  - $\\theta = \\tfrac{1}{3}\\arccos\\!\\Big( \\tfrac{3\\sqrt{3}}{2}\\, \\dfrac{J_3}{J_2^{3/2}} \\Big)$，其中 $J_3 = \\det(s)$，并约定当 $J_2$ 低于一个小的正阈值时，设 $q=0$ 和 $\\theta=0$。Lode 角必须以弧度计算。\n\n您必须通过多个测试用例，数值验证对于随机采样的 $Q \\in \\mathrm{SO}(3)$，$I_1$、$I_2$、$I_3$、$p$、$q$ 和 $\\theta$ 在变换 $\\sigma \\mapsto Q \\sigma Q^\\top$ 下是不变的。随机旋转 $Q$ 的采样必须在 $\\mathrm{SO}(3)$ 上服从关于 Haar 测度的均匀分布。一种数值稳定的方法是：生成一个其元素为独立同分布标准正态数的随机矩阵，计算其正交三角分解（通常称为正交三角分解或 $QR$ 分解），然后如有必要，通过翻转某一列的符号来强制使 $\\det(Q)=+1$。\n\n在比较浮点数时，使用相对容差 $r_{\\text{tol}} = 10^{-10}$ 和绝对容差 $a_{\\text{tol}} = 10^{-12}$。角度必须以弧度为单位，并使用相同的容差进行比较。所有随机采样必须通过给定的种子实现确定性。\n\n测试套件规范：\n- 每个测试用例必须返回一个布尔值，指示该用例的所有不变性检查是否都已通过。\n- 测试套件由以下五个用例组成。在每个用例中，使用提供的旋转种子和旋转次数；对于生成随机应力的用例，使用提供的应力种子。对于任何使用静水应力或构造应力的用例，只有旋转采样是随机的。\n\n用例 A（通用随机对称应力，“理想路径”）：\n- 类型：随机对称。\n- 应力种子：$42$。\n- 旋转种子：$31415$。\n- 应力数量：$4$。\n- 每个应力的旋转次数：$8$。\n- 应力尺度：$1.0$。\n\n用例 B（纯静水应力，按约定 $q=0$ 且 $\\theta=0$）：\n- 类型：静水。\n- 静水压力 $p$ (意义为 $p=\\tfrac{1}{3}I_1$)：$[-3.0,\\,0.0,\\,5.5]$。\n- 旋转种子：$27182$。\n- 每个应力的旋转次数：$8$。\n\n用例 C（纯剪切应力，其中 $J_3=0$）：\n- 类型：纯剪切，对于列出的每个 $\\tau$，$\\sigma = \\begin{bmatrix}0  &\\tau  &0\\\\ \\tau  &0  &0\\\\ 0  &0  &0\\end{bmatrix}$。\n- 剪切值 $\\tau$：$[0.7,\\,-2.3]$。\n- 旋转种子：$16180$。\n- 每个应力的旋转次数：$8$。\n\n用例 D（具有极小偏应力部分的近静水应力，以探测 $J_2 \\approx 0$ 附近的数值稳定性）：\n- 类型：近静水随机。\n- 应力种子：$123$。\n- 旋转种子：$14142$。\n- 应力数量：$3$。\n- 每个应力的旋转次数：$8$。\n- 偏应力大小尺度 $\\varepsilon = 10^{-8}$。\n- 静水压力大小范围：从 $[-10.0,\\,10.0]$ 中均匀抽取 $p$。\n\n用例 E（固定对角各向异性应力）：\n- 类型：对角。\n- 对角线元素：$\\{(9.0,\\,-4.0,\\,2.0),\\,(100.0,\\,0.01,\\,-1.0)\\}$。\n- 旋转种子：$17320$。\n- 每个应力的旋转次数：$8$。\n\n对每个测试用例，执行以下操作：构建指定的应力集，采样指定数量的随机旋转 $Q \\in \\mathrm{SO}(3)$，将每个应力变换为 $\\sigma' = Q \\sigma Q^\\top$，并使用容差 $r_{\\text{tol}}$ 和 $a_{\\text{tol}}$ 比较旋转前后的 $I_1$、$I_2$、$I_3$、$p$、$q$ 和 $\\theta$ 的值。当且仅当该用例中所有应力和所有旋转的所有比较都通过时，一个测试用例才算通过。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$，其中每个 $\\text{result}_k$ 是对应于 A、B、C、D、E 顺序的用例的布尔值。\n- 角度必须以弧度处理。输出中无需报告物理单位。",
            "solution": "用户提供的问题陈述经评估为 **有效**。它在科学上基于连续介质力学的原理，特别是应用于计算岩土力学的张量分析。该问题是适定的，为确定性的、可验证的解决方案提供了所有必要的定义、常数和参数。其语言客观、无歧义，完全属于张量运算及其不变量这一指定主题。\n\n任务是使用 Python 构建一个单元测试套件，以数值方式验证 Cauchy 应力张量 $\\sigma$ 的特定标量不变量在坐标系的正常正交变换（旋转）下保持不变。二阶张量的变换规则为 $\\sigma' = Q \\sigma Q^\\top$，其中 $Q$ 是一个旋转矩阵，即 $Q \\in \\mathrm{SO}(3)$，意味着 $Q Q^\\top = Q^\\top Q = \\mathbf{I}$ 且 $\\det(Q) = +1$。\n\n该解决方案通过以下步骤实现：\n1.  **不变量计算的实现**：设计一个函数，用于计算任何给定的 $3 \\times 3$ 对称应力张量 $\\sigma$ 的六个指定不变量。\n    - 主不变量 $I_1(\\sigma)$、$I_2(\\sigma)$ 和 $I_3(\\sigma)$ 直接根据其涉及迹和行列式的定义进行计算：\n        $$ I_1 = \\mathrm{tr}(\\sigma) $$\n        $$ I_2 = \\frac{1}{2}\\left( (\\mathrm{tr}(\\sigma))^2 - \\mathrm{tr}(\\sigma^2) \\right) $$\n        $$ I_3 = \\det(\\sigma) $$\n    - 剩余的量由这些量和偏应力张量 $s = \\sigma - p\\mathbf{I}$ 导出，其中 $p = \\frac{1}{3}I_1$ 是平均应力。\n        - 偏应力第二不变量 $J_2$ 由下式给出：\n          $$ J_2 = \\frac{1}{2} s:s = \\frac{1}{2} \\mathrm{tr}(s^2) $$\n        - von Mises 等效应力 $q$ 定义为：\n          $$ q = \\sqrt{3 J_2} $$\n        - Lode 角 $\\theta$ 根据 $J_2$ 和第三偏应力不变量 $J_3 = \\det(s)$ 定义：\n          $$ \\theta = \\frac{1}{3}\\arccos\\left( \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}} \\right) $$\n    - 实现的一个关键部分是处理当 $J_2$ 接近于零时（即，对于近静水应力状态）$q$ 和 $\\theta$ 的数值稳定性。按照规定，如果 $J_2$ 低于一个小的正阈值，则 $q$ 和 $\\theta$ 都设置为零。此阈值的一个合适选择是用于比较的绝对容差 $a_{\\text{tol}} = 10^{-12}$。此外，$\\arccos$ 函数的参数被裁剪到区间 $[-1, 1]$ 内，以防止因浮点不精确而引起的定义域错误。\n\n2.  **随机旋转矩阵的生成**：为了测试不变性，我们需要生成在 Haar 测度上均匀分布的随机旋转矩阵 $Q \\in \\mathrm{SO}(3)$。问题指定了一种标准的、数值稳定的方法：\n    - 生成一个 $3 \\times 3$ 矩阵 $A$，其元素从独立同分布的标准正态分布中抽取。\n    - 计算 $A$ 的 QR 分解，得到 $A = QR$，其中 $Q$ 是一个正交矩阵，$R$ 是一个上三角矩阵。\n    - 正交矩阵的行列式为 $+1$ 或 $-1$。为确保 $Q$ 是一个正常旋转（即 $\\det(Q) = +1$），我们检查其行列式。如果 $\\det(Q) < 0$，我们将其中的一列（例如，最后一列）乘以 $-1$。这会在保持正交性的同时翻转行列式的符号，从而得到一个矩阵 $Q \\in \\mathrm{SO}(3)$。\n    - 对于所需数量的旋转，重复此过程，并使用指定的随机种子以确保确定性可复现。\n\n3.  **应力张量的生成**：对每个测试用例，都构造一组特定的应力张量。这包括：\n    - **随机对称张量（用例 A）**：生成一个随机的 $3 \\times 3$ 矩阵 $M$，通过 $\\sigma = \\frac{1}{2}(M + M^\\top)$ 形成一个对称张量，然后进行缩放。\n    - **静水张量（用例 B）**：对于给定的压力 $p$，张量为 $\\sigma = p \\mathbf{I}$。\n    - **纯剪切张量（用例 C）**：这些张量直接构造为 $\\sigma = \\begin{pmatrix} 0 & \\tau & 0 \\\\ \\tau & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$。\n    - **近静水张量（用例 D）**：应力张量形成为 $\\sigma = p\\mathbf{I} + s_{\\text{dev}}$，其中 $p$ 是一个随机静水压力，$s_{\\text{dev}}$ 是一个大小非常小的偏应力张量，由尺度因子 $\\varepsilon = 10^{-8}$ 控制。这旨在探测 $J_2=0$ 附近的数值行为。\n    - **对角张量（用例 E）**：这些张量直接由一组给定的主应力构造，$\\sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$。\n\n4.  **验证逻辑**：测试套件的核心是一个循环，它遍历每个指定的应力张量和每个生成的旋转矩阵。对于每一对 $(\\sigma, Q)$：\n    - 计算原始应力张量 $\\sigma$ 的六个不变量。\n    - 对应力张量进行变换：$\\sigma' = Q \\sigma Q^\\top$。\n    - 计算变换后张量 $\\sigma'$ 的六个不变量。\n    - 将每个原始不变量与其变换后的对应项进行比较。比较使用 `numpy.allclose`，并采用指定的相对容差 $r_{\\text{tol}} = 10^{-10}$ 和绝对容差 $a_{\\text{tol}} = 10^{-12}$。\n    - 只有当该用例中的所有应力张量和所有旋转的所有不变量比较都成功时，该测试用例才被标记为通过（`True`）。若有任何一个比较失败，则整个测试用例失败（`False`）。\n\n5.  **最终输出**：来自五个测试用例（A、B、C、D、E）的布尔结果被收集到一个列表中，并以指定格式打印到标准输出：`[result_A,result_B,result_C,result_D,result_E]`。\n\n这种系统化的方法确保了问题的所有要求都得到满足，为应力不变量的旋转不变性这一基本原理提供了一个稳健且确定性的验证。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a deterministic unit-test suite to verify the rotational\n    invariance of stress tensor invariants.\n    \"\"\"\n    \n    TOL_REL = 1e-10\n    TOL_ABS = 1e-12\n    J2_THRESHOLD = TOL_ABS\n\n    def generate_random_rotations(num_rotations, seed):\n        \"\"\"\n        Generates random rotation matrices Q in SO(3) using the QR decomposition method.\n        The distribution is uniform with respect to the Haar measure.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        rotations = []\n        for _ in range(num_rotations):\n            A = rng.normal(size=(3, 3))\n            Q, _ = np.linalg.qr(A)\n            # Ensure Q is a proper rotation matrix (det(Q) = +1)\n            if np.linalg.det(Q)  0:\n                Q[:, -1] *= -1\n            rotations.append(Q)\n        return rotations\n\n    def create_invariants_calculator(j2_threshold):\n        \"\"\"\n        Creates a callable function that calculates the six stress invariants.\n        The j2_threshold is captured by the closure.\n        \"\"\"\n        def calculate_invariants(sigma):\n            \"\"\"\n            Calculates the principal invariants (I1, I2, I3) and derived\n            invariants (p, q, theta) for a given stress tensor.\n            \"\"\"\n            # Principal invariants\n            I1 = np.trace(sigma)\n            I2 = 0.5 * (I1**2 - np.trace(sigma @ sigma))\n            I3 = np.linalg.det(sigma)\n\n            # Mean stress and deviatoric stress tensor\n            p = I1 / 3.0\n            s = sigma - p * np.identity(3)\n\n            # Deviatoric invariants and related quantities\n            J2 = 0.5 * np.trace(s @ s)\n\n            if J2  j2_threshold:\n                q = 0.0\n                theta = 0.0\n            else:\n                q = np.sqrt(3.0 * J2)\n                J3 = np.linalg.det(s)\n                \n                # Argument for arccos, can be slightly outside [-1, 1] due to float errors\n                arg = (3.0 * np.sqrt(3.0) / 2.0) * J3 / (J2**1.5)\n                arg = np.clip(arg, -1.0, 1.0)\n                \n                theta = (1.0 / 3.0) * np.arccos(arg)\n            \n            return (I1, I2, I3, p, q, theta)\n        return calculate_invariants\n\n    invariants_calculator = create_invariants_calculator(J2_THRESHOLD)\n\n    def generate_stresses(params):\n        \"\"\"\n        Generates a list of stress tensors based on the test case parameters.\n        \"\"\"\n        stresses = []\n        case_type = params['type']\n        \n        if case_type == 'random_symmetric':\n            rng = np.random.default_rng(params['stress_seed'])\n            for _ in range(params['num_stresses']):\n                M = rng.normal(size=(3, 3))\n                sigma = 0.5 * (M + M.T) * params['stress_scale']\n                stresses.append(sigma)\n        elif case_type == 'hydrostatic':\n            for p_val in params['pressures']:\n                stresses.append(p_val * np.identity(3))\n        elif case_type == 'pure_shear':\n            for tau in params['shear_values']:\n                sigma = np.array([[0.0, tau, 0.0], [tau, 0.0, 0.0], [0.0, 0.0, 0.0]])\n                stresses.append(sigma)\n        elif case_type == 'near_hydrostatic':\n            rng = np.random.default_rng(params['stress_seed'])\n            epsilon = params['dev_scale']\n            p_bound = params['p_bound']\n            for _ in range(params['num_stresses']):\n                p_val = rng.uniform(-p_bound, p_bound)\n                \n                # Generate a random deviatoric tensor and scale it\n                S_rand = rng.normal(size=(3, 3))\n                S_rand = 0.5 * (S_rand + S_rand.T) \n                s_dev_unscaled = S_rand - (np.trace(S_rand) / 3.0) * np.identity(3)\n                \n                norm = np.linalg.norm(s_dev_unscaled)\n                if norm  1e-15:  # Avoid division by zero if tensor is accidentally zero\n                    s_dev_unscaled = np.array([[1.0, 0.0, 0.0], [0.0, -1.0, 0.0], [0.0, 0.0, 0.0]])\n                    norm = np.linalg.norm(s_dev_unscaled)\n                    \n                s_dev = epsilon * s_dev_unscaled / norm\n                sigma = p_val * np.identity(3) + s_dev\n                stresses.append(sigma)\n        elif case_type == 'diagonal':\n            for d in params['diagonals']:\n                stresses.append(np.diag(d))\n                \n        return stresses\n\n    def run_test_case(params):\n        \"\"\"\n        Runs a single test case and returns True if all checks pass, False otherwise.\n        \"\"\"\n        stresses = generate_stresses(params)\n        rotations = generate_random_rotations(params['num_rotations'], params['rotation_seed'])\n\n        for sigma in stresses:\n            original_invariants = invariants_calculator(sigma)\n            for Q in rotations:\n                sigma_prime = Q @ sigma @ Q.T\n                transformed_invariants = invariants_calculator(sigma_prime)\n\n                for orig_inv, trans_inv in zip(original_invariants, transformed_invariants):\n                    if not np.allclose(orig_inv, trans_inv, rtol=TOL_REL, atol=TOL_ABS):\n                        return False\n        return True\n\n    test_cases_spec = [\n        # Case A\n        {'type': 'random_symmetric', 'stress_seed': 42, 'rotation_seed': 31415,\n         'num_stresses': 4, 'num_rotations': 8, 'stress_scale': 1.0},\n        # Case B\n        {'type': 'hydrostatic', 'pressures': [-3.0, 0.0, 5.5],\n         'rotation_seed': 27182, 'num_rotations': 8},\n        # Case C\n        {'type': 'pure_shear', 'shear_values': [0.7, -2.3],\n         'rotation_seed': 16180, 'num_rotations': 8},\n        # Case D\n        {'type': 'near_hydrostatic', 'stress_seed': 123, 'rotation_seed': 14142,\n         'num_stresses': 3, 'num_rotations': 8, 'dev_scale': 1e-8, 'p_bound': 10.0},\n        # Case E\n        {'type': 'diagonal', 'diagonals': [(9.0, -4.0, 2.0), (100.0, 0.01, -1.0)],\n         'rotation_seed': 17320, 'num_rotations': 8}\n    ]\n\n    results = [run_test_case(params) for params in test_cases_spec]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}