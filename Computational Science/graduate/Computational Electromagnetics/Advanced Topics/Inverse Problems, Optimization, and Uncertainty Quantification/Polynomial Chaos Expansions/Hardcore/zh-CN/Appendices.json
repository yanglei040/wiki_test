{
    "hands_on_practices": [
        {
            "introduction": "多项式混沌展开（PCE）的一个关键优势是能够直接从展开系数中计算模型输出的统计矩。本练习将引导您从一个给定的PCE表达式中，推导其均值和方差 。掌握这种关系是有效解释和使用PCE结果进行不确定性量化的第一步。",
            "id": "3341826",
            "problem": "考虑一个频域计算电磁学模型，其中均匀、各向同性介质具有不确定的介电常数 $\\,\\epsilon(\\xi) = \\epsilon_{0}\\,(1+\\xi)\\,$，其中 $\\,\\epsilon_{0} > 0\\,$ 是一个确定性常数，$\\,\\xi \\sim \\mathcal{N}(0,\\sigma^{2})\\,$ 是一个方差为 $\\,\\sigma^{2} > 0\\,$ 的标量高斯随机输入。设 $\\,u(\\xi)\\,$ 表示在固定点和固定频率下，从由麦克斯韦方程组导出的控制的线性边值问题（例如，具有波数 $\\,k(\\xi) = \\omega \\sqrt{\\mu\\,\\epsilon(\\xi)}\\,$ 的标量亥姆霍兹算子）得到的标量场解的非负幅值，其边界条件确保对于 $\\,\\xi\\,$ 的容许值存在唯一解。假设 $\\,u(\\xi)\\,$ 属于关于 $\\,\\xi\\,$ 的高斯测度的平方可积空间，因此在 Wiener–Hermite 类中存在多项式混沌展开 (PCE)。\n\n假设 $\\,u(\\xi)\\,$ 由一个关于适应 $\\,\\xi\\,$ 分布的正交 Hermite 基的有限阶 PCE 表示：\n$$\nu(\\xi) \\approx \\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi),\n$$\n其中 $\\,p \\in \\mathbb{N}\\,$ 是截断阶数，$\\,\\hat{u}_{k} \\in \\mathbb{R}\\,$ 是确定性系数，$\\,\\{\\Psi_{k}(\\xi)\\}_{k=0}^{p}\\,$ 是关于 $\\,\\xi\\,$ 的高斯测度的正交多项式基，满足 $\\,\\mathbb{E}[\\Psi_{m}(\\xi)\\,\\Psi_{n}(\\xi)] = \\delta_{mn}\\,$ 且 $\\,\\Psi_{0}(\\xi) \\equiv 1\\,$。\n\n从基本原理出发——即控制算子相对于场的线性性、二阶矩的定义以及 Wiener–Hermite 基的正交性——推导均值 $\\,\\mathbb{E}[u(\\xi)]\\,$ 和方差 $\\,\\operatorname{Var}(u(\\xi))\\,$ 关于系数 $\\,\\{\\hat{u}_{k}\\}_{k=0}^{p}\\,$ 的表达式。然后，陈述在输入 $\\,\\xi\\,$、介电常数映射 $\\,\\epsilon(\\xi)\\,$ 和确定性算子上保证截断 PCE $\\,\\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)\\,$ 在 $\\,p \\to \\infty\\,$ 时均方收敛于 $\\,u(\\xi)\\,$ 的数学上精确的条件。\n\n请将您的最终答案以单个行向量的形式给出，其中包含用 $\\,\\{\\hat{u}_{k}\\}\\,$ 和 $\\,p\\,$ 表示的均值和方差的闭式解析表达式。无需四舍五入，最终答案不应包含单位。",
            "solution": "该问题要求从其多项式混沌展开 (PCE) 中推导随机变量 $u(\\xi)$ 的均值和方差，并给出保证此展开均方收敛的条件。$u(\\xi)$ 的 PCE 以截断形式给出：$u_p(\\xi) = \\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)$。控制算子相对于场 $u$ 的线性性是使用谱方法（如 PCE-Galerkin）来确定系数 $\\hat{u}_k$ 的一个基本要求，但从展开式本身计算矩依赖于期望算子的线性性和基多项式的性质。\n\n首先，我们推导均值 $\\mathbb{E}[u(\\xi)]$。对于截断级数 $u_p(\\xi)$，通过应用期望算子 $\\mathbb{E}[\\cdot]$ 来求其均值。\n$$\n\\mathbb{E}[u_p(\\xi)] = \\mathbb{E}\\left[\\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)\\right]\n$$\n根据期望算子的线性性，我们可以将其移到求和号内部。由于系数 $\\hat{u}_k$ 是确定性常数，它们可以从期望中提出。\n$$\n\\mathbb{E}[u_p(\\xi)] = \\sum_{k=0}^{p} \\hat{u}_{k}\\,\\mathbb{E}[\\Psi_{k}(\\xi)]\n$$\n为了计算 $\\mathbb{E}[\\Psi_{k}(\\xi)]$，我们使用所给的正交基的性质。我们已知 $\\Psi_0(\\xi) \\equiv 1$，并且正交性条件为 $\\mathbb{E}[\\Psi_m(\\xi)\\Psi_n(\\xi)] = \\delta_{mn}$，其中 $\\delta_{mn}$ 是克罗内克 (Kronecker) δ。我们可以将 $\\Psi_k(\\xi)$ 的期望表示为与 $\\Psi_0(\\xi)$ 的内积：\n$$\n\\mathbb{E}[\\Psi_{k}(\\xi)] = \\mathbb{E}[\\Psi_k(\\xi) \\cdot 1] = \\mathbb{E}[\\Psi_k(\\xi)\\,\\Psi_0(\\xi)] = \\delta_{k0}\n$$\n这个结果表明，除了零阶多项式的期望为 1 之外，任何基多项式的期望都为零。将此结果代入 $u_p(\\xi)$ 的均值表达式中：\n$$\n\\mathbb{E}[u_p(\\xi)] = \\sum_{k=0}^{p} \\hat{u}_{k}\\,\\delta_{k0} = \\hat{u}_0 \\cdot 1 + \\hat{u}_1 \\cdot 0 + \\dots + \\hat{u}_p \\cdot 0 = \\hat{u}_0\n$$\n因此，随机场的均值恰好是零阶 PCE 系数。当 $p \\to \\infty$ 时，如果展开式收敛，则 $\\mathbb{E}[u(\\xi)] = \\hat{u}_0$。\n\n接下来，我们推导方差 $\\operatorname{Var}(u(\\xi))$。方差定义为 $\\operatorname{Var}(u_p(\\xi)) = \\mathbb{E}[u_p(\\xi)^2] - (\\mathbb{E}[u_p(\\xi)])^2$。我们已经求得 $\\mathbb{E}[u_p(\\xi)] = \\hat{u}_0$。现在我们需要计算二阶矩 $\\mathbb{E}[u_p(\\xi)^2]$。\n$$\n\\mathbb{E}[u_p(\\xi)^2] = \\mathbb{E}\\left[\\left(\\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)\\right)^2\\right] = \\mathbb{E}\\left[\\left(\\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)\\right)\\left(\\sum_{j=0}^{p} \\hat{u}_{j}\\,\\Psi_{j}(\\xi)\\right)\\right]\n$$\n展开乘积并利用期望的线性性：\n$$\n\\mathbb{E}[u_p(\\xi)^2] = \\mathbb{E}\\left[\\sum_{k=0}^{p}\\sum_{j=0}^{p} \\hat{u}_k \\hat{u}_j \\Psi_k(\\xi) \\Psi_j(\\xi)\\right] = \\sum_{k=0}^{p}\\sum_{j=0}^{p} \\hat{u}_k \\hat{u}_j \\mathbb{E}[\\Psi_k(\\xi) \\Psi_j(\\xi)]\n$$\n使用正交性条件 $\\mathbb{E}[\\Psi_k(\\xi)\\Psi_j(\\xi)] = \\delta_{kj}$：\n$$\n\\mathbb{E}[u_p(\\xi)^2] = \\sum_{k=0}^{p}\\sum_{j=0}^{p} \\hat{u}_k \\hat{u}_j \\delta_{kj}\n$$\n克罗内克 δ $\\delta_{kj}$ 使得内层求和坍缩，因为只有当 $j=k$ 时项才非零：\n$$\n\\mathbb{E}[u_p(\\xi)^2] = \\sum_{k=0}^{p} \\hat{u}_k^2\n$$\n这是 $u_p(\\xi)$ 的二阶矩。现在，我们将二阶矩和均值代入方差公式：\n$$\n\\operatorname{Var}(u_p(\\xi)) = \\mathbb{E}[u_p(\\xi)^2] - (\\mathbb{E}[u_p(\\xi)])^2 = \\sum_{k=0}^{p} \\hat{u}_k^2 - (\\hat{u}_0)^2\n$$\n将 $k=0$ 项从求和中分离出来：\n$$\n\\operatorname{Var}(u_p(\\xi)) = \\left(\\hat{u}_0^2 + \\sum_{k=1}^{p} \\hat{u}_k^2\\right) - \\hat{u}_0^2 = \\sum_{k=1}^{p} \\hat{u}_k^2\n$$\n方差是所有高阶 ($k \\geq 1$) PCE 系数的平方和。\n\n最后，我们讨论均方收敛的条件。截断的 PCE $\\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)$ 在 $p \\to \\infty$ 时均方收敛于 $u(\\xi)$，如果均方误差趋于零：\n$$\n\\lim_{p \\to \\infty} \\mathbb{E}\\left[ \\left(u(\\xi) - \\sum_{k=0}^{p} \\hat{u}_{k}\\,\\Psi_{k}(\\xi)\\right)^2 \\right] = 0\n$$\n对于用于高斯随机变量 $\\xi$ 的 Wiener-Hermite PCE，Cameron-Martin 定理为此收敛提供了充分必要条件。唯一的、数学上精确的条件是函数 $u(\\xi)$ 必须关于高斯概率测度是平方可积的，即它必须属于希尔伯特空间 (Hilbert space) $L^2(\\mathbb{R}, w(\\xi)d\\xi)$，其中 $w(\\xi)$ 是 $\\xi$ 的高斯概率密度函数。这等价于要求 $u(\\xi)$ 的二阶矩是有限的：\n$$\n\\mathbb{E}[u(\\xi)^2] < \\infty\n$$\n问题陈述明确假设了这一条件（“假设 $u(\\xi)$ 属于平方可积空间...”）。对输出函数 $u(\\xi)$ 的这个条件，对系统的各个组成部分施加了隐含的条件：\n1.  输入随机变量 $\\xi$ 和介电常数映射 $\\epsilon(\\xi) = \\epsilon_0(1+\\xi)$ 已经定义。高斯测度的支撑集为整个 $\\mathbb{R}$。\n2.  确定性算子（例如，标量亥姆霍兹算子）、其相关的边界条件以及任何强迫项必须使得由参数化 $k(\\xi) = \\omega\\sqrt{\\mu\\epsilon(\\xi)}$ 产生的解 $u(\\xi)$ 满足有限方差条件。这意味着解 $u(\\xi)$ 中的任何奇异性在均方意义下必须是可积的。例如，在边值问题中，算子可能在某些共振波数处变得奇异。一个保证平方可积性的充分（但非必要）条件是，$k(\\xi)$ 对于 $\\xi \\in \\mathbb{R}$ 的取值范围不包含任何这些共振波数，从而保证解 $u(\\xi)$ 有界，因此二阶矩有限。更一般地，即使 $u(\\xi)$ 存在奇异点（例如，在 $\\epsilon=0$ 的 $\\xi=-1$ 处或在共振波数处），解的幅值 $|u(\\xi)|$ 在这些奇异点附近的增长速度也必须足够慢，以使积分 $\\int_{-\\infty}^{\\infty} |u(\\xi)|^2 \\exp(-\\xi^2/(2\\sigma^2)) d\\xi$ 收敛。\n总之，基本的收敛保证是解的平方可积性，这是算子、边界条件和特定参数化的一个综合属性。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\hat{u}_{0} & \\sum_{k=1}^{p} \\hat{u}_{k}^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了基本的统计矩，PCE还为全局灵敏度分析提供了一个强大的框架，使我们能够将输出方差归因于不同的不确定性输入。本实践问题演示了如何直接从一个多元模型的PCE系数中计算一阶和全阶Sobol指数 。这项技术对于识别复杂系统中最具影响力的参数非常有价值。",
            "id": "3523157",
            "problem": "在一个共轭传热-热弹性耦合问题中，一个降阶模型用于预测一个微型热交换器在不确定的热和力学边界条件下的稳态界面温度响应 $u(\\boldsymbol{\\xi})$。不确定性输入被映射为三个独立的标准化变量 $\\boldsymbol{\\xi}=(\\xi_{1},\\xi_{2},\\xi_{3})$，其中 $\\xi_{i}\\sim \\mathcal{U}[-1,1]$ 且相互独立。多项式混沌展开 (PCE) 将模型输出表示为\n$$\nu(\\boldsymbol{\\xi})=\\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\,\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}),\n$$\n其中 $\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})=\\prod_{i=1}^{3}\\varphi_{\\alpha_{i}}(\\xi_{i})$，而 $\\{\\varphi_{n}\\}_{n\\ge 0}$ 是区间 $[-1,1]$ 上关于均匀测度的标准正交勒让德多项式，即 $\\mathbb{E}[\\varphi_{n}(\\xi)\\varphi_{m}(\\xi)]=\\delta_{nm}$ 且 $\\varphi_{0}(\\xi)=1$。因此，该多元基是标准正交的：$\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})]=\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$。通过非侵入式 PCE 校准获得的非零系数为\n- $c_{(0,0,0)}=2$,\n- $c_{(1,0,0)}=\\frac{1}{2}$, $c_{(0,1,0)}=-\\frac{1}{4}$, $c_{(0,0,1)}=\\frac{1}{8}$,\n- $c_{(2,0,0)}=\\frac{1}{4}$, $c_{(0,2,0)}=-\\frac{1}{8}$, $c_{(0,0,2)}=\\frac{1}{16}$,\n- $c_{(1,1,0)}=\\frac{1}{8}$, $c_{(1,0,1)}=-\\frac{1}{16}$, $c_{(0,1,1)}=\\frac{1}{32}$, $c_{(1,1,1)}=-\\frac{1}{32}$,\n所有其他 $c_{\\boldsymbol{\\alpha}}$ 均为零。\n\n从基的标准正交性、方差的定义 $\\mathbb{V}[u]=\\mathbb{E}\\big[(u-\\mathbb{E}[u])^{2}\\big]$ 以及基于方差的全局敏感度分析定义（一阶 Sobol 指数 $S_{i}=\\mathbb{V}\\big(\\mathbb{E}[u\\mid \\xi_{i}]\\big)/\\mathbb{V}[u]$ 和全局 Sobol 指数 $S_{T_{i}}=1-\\mathbb{V}\\big(\\mathbb{E}[u\\mid \\boldsymbol{\\xi}_{\\sim i}]\\big)/\\mathbb{V}[u]$，其中 $\\boldsymbol{\\xi}_{\\sim i}$ 表示除 $\\xi_{i}$ 以外的所有输入）出发，完成以下任务：\n\n1. 推导 $\\mathbb{V}[u]$ 关于系数 $c_{\\boldsymbol{\\alpha}}$ 的表达式。\n2. 推导一阶 Sobol 指数 $S_{i}$ 的表达式，用仅支撑在变量 $\\xi_{i}$ 上的多重指标 $\\boldsymbol{\\alpha}$ 关联的 $c_{\\boldsymbol{\\alpha}}^{2}$ 的和来表示。\n3. 推导全局 Sobol 指数 $S_{T_{i}}$ 的表达式，用满足 $\\alpha_{i}>0$ 的多重指标 $\\boldsymbol{\\alpha}$ 关联的 $c_{\\boldsymbol{\\alpha}}^{2}$ 的和来表示。\n4. 使用所给的系数，计算当 $i\\in\\{1,2,3\\}$ 时推导出的表达式的值。\n\n将您的最终答案表示为单行矩阵\n$$\n\\big[\\ \\mathbb{V}[u],\\ S_{1},\\ S_{2},\\ S_{3},\\ S_{T_{1}},\\ S_{T_{2}},\\ S_{T_{3}}\\ \\big]\n$$\n其值为精确的最简分数。无需四舍五入，也无需报告单位。",
            "solution": "解答需要依次执行四个任务：推导总方差、一阶 Sobol 指数和全局 Sobol 指数的 PCE 系数表达式，然后计算这些量的值。\n\n**1. 方差 $\\mathbb{V}[u]$ 的推导**\n\n首先计算模型输出 $u(\\boldsymbol{\\xi})$ 的均值。利用期望算子的线性性质和基函数的标准正交性：\n$$\n\\mathbb{E}[u] = \\mathbb{E}\\left[\\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\right] = \\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})]\n$$\n由于 $\\psi_{\\boldsymbol{0}}(\\boldsymbol{\\xi})=\\varphi_{0}(\\xi_1)\\varphi_{0}(\\xi_2)\\varphi_{0}(\\xi_3)=1 \\cdot 1 \\cdot 1 = 1$，基函数的期望为：\n$$\n\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})] = \\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\psi_{\\boldsymbol{0}}(\\boldsymbol{\\xi})] = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{0}}\n$$\n其中 $\\boldsymbol{0} = (0,0,0)$ 是零多重指标。因此，均值就是第一个系数：\n$$\n\\mathbb{E}[u] = \\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{0}} = c_{\\boldsymbol{0}} = c_{(0,0,0)}\n$$\n方差定义为 $\\mathbb{V}[u] = \\mathbb{E}[u^2] - (\\mathbb{E}[u])^2$。我们计算均方值 $\\mathbb{E}[u^2]$：\n$$\n\\mathbb{E}[u^2] = \\mathbb{E}\\left[\\left(\\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\alpha}}\\right)\\left(\\sum_{\\boldsymbol{\\beta}} c_{\\boldsymbol{\\beta}}\\psi_{\\boldsymbol{\\beta}}\\right)\\right] = \\sum_{\\boldsymbol{\\alpha},\\boldsymbol{\\beta}} c_{\\boldsymbol{\\alpha}}c_{\\boldsymbol{\\beta}}\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\beta}}]\n$$\n使用标准正交性 $\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\beta}}] = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$：\n$$\n\\mathbb{E}[u^2] = \\sum_{\\boldsymbol{\\alpha},\\boldsymbol{\\beta}} c_{\\boldsymbol{\\alpha}}c_{\\boldsymbol{\\beta}}\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}}^2\n$$\n将这些结果代入方差公式，得到：\n$$\n\\mathbb{V}[u] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}}^2 - c_{\\boldsymbol{0}}^2 = \\sum_{\\boldsymbol{\\alpha}\\neq\\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\n$$\n这就是所求的总方差表达式。\n\n**2. 一阶 Sobol 指数 $S_i$ 的推导**\n\n一阶 Sobol 指数是 $S_i = \\mathbb{V}_i / \\mathbb{V}[u]$，其中 $\\mathbb{V}_i = \\mathbb{V}[\\mathbb{E}[u \\mid \\xi_i]]$。我们首先计算条件期望 $\\mathbb{E}[u \\mid \\xi_i]$：\n$$\n\\mathbb{E}[u \\mid \\xi_i] = \\mathbb{E}\\left[\\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\xi_i \\right] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\mathbb{E}\\left[\\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\xi_i \\right]\n$$\n由于变量 $\\xi_j$ 的独立性，条件期望变为：\n$$\n\\mathbb{E}\\left[\\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\xi_i \\right] = \\varphi_{\\alpha_i}(\\xi_i) \\prod_{j \\neq i} \\mathbb{E}[\\varphi_{\\alpha_j}(\\xi_j)]\n$$\n由于 $\\mathbb{E}[\\varphi_{\\alpha_j}(\\xi_j)] = \\delta_{\\alpha_j, 0}$，仅当对所有 $j \\neq i$ 都有 $\\alpha_j = 0$ 时，乘积 $\\prod_{j \\neq i} \\delta_{\\alpha_j, 0}$ 才非零（且等于 1）。这将求和限制在最多只有一个非零分量的多重指标上，且该非零分量必须在位置 $i$。\n令 $\\mathcal{A}_i = \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_0^3 \\mid \\alpha_j = 0, \\forall j \\neq i\\}$。则：\n$$\nu_i \\equiv \\mathbb{E}[u \\mid \\xi_i] = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i} c_{\\boldsymbol{\\alpha}} \\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) = \\sum_{k=0}^{\\infty} c_{(0,..,k,..,0)} \\varphi_k(\\xi_i)\n$$\n方差 $\\mathbb{V}_i = \\mathbb{V}[u_i]$ 是这个部分和的方差。其均值为 $\\mathbb{E}[u_i]=\\mathbb{E}[\\mathbb{E}[u|\\xi_i]]=\\mathbb{E}[u]=c_{\\boldsymbol{0}}$。使用与总方差相同的逻辑：\n$$\n\\mathbb{V}_i = \\mathbb{E}[u_i^2] - (\\mathbb{E}[u_i])^2 = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i} c_{\\boldsymbol{\\alpha}}^2 - c_{\\boldsymbol{0}}^2 = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\n$$\n这个和包含了其多重指标仅支撑在变量 $\\xi_i$ 上的系数的平方。所以，一阶指数为：\n$$\nS_i = \\frac{\\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2}\n$$\n\n**3. 全局 Sobol 指数 $S_{T_i}$ 的推导**\n\n全局 Sobol 指数是 $S_{T_i} = 1 - \\mathbb{V}[\\mathbb{E}[u \\mid \\boldsymbol{\\xi}_{\\sim i}]] / \\mathbb{V}[u]$。我们计算对除 $\\xi_i$ 以外的所有变量（记为 $\\boldsymbol{\\xi}_{\\sim i}$）的条件期望：\n$$\n\\mathbb{E}[u \\mid \\boldsymbol{\\xi}_{\\sim i}] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\mathbb{E}\\left[\\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\boldsymbol{\\xi}_{\\sim i} \\right] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\left(\\prod_{j \\neq i} \\varphi_{\\alpha_j}(\\xi_j) \\right) \\mathbb{E}[\\varphi_{\\alpha_i}(\\xi_i)]\n$$\n同样，$\\mathbb{E}[\\varphi_{\\alpha_i}(\\xi_i)] = \\delta_{\\alpha_i, 0}$。求和被限制在 $\\alpha_i = 0$ 的指标 $\\boldsymbol{\\alpha}$ 上。令 $\\mathcal{B}_i = \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_0^3 \\mid \\alpha_i=0 \\}$。则：\n$$\nu_{\\sim i} \\equiv \\mathbb{E}[u \\mid \\boldsymbol{\\xi}_{\\sim i}] = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i} c_{\\boldsymbol{\\alpha}} \\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\n$$\n此项的方差为 $\\mathbb{V}[u_{\\sim i}] = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2$。那么，\n$$\nS_{T_i} = 1 - \\frac{\\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2} = \\frac{\\left(\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2\\right) - \\left(\\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\\right)}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2}\n$$\n所有非零多重指标的集合 $\\{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}\\}$ 可以划分为 $\\beta_i=0$ 的部分（即 $\\mathcal{B}_i \\setminus \\{\\boldsymbol{0}\\}$）和 $\\beta_i > 0$ 的部分。分子是所有满足 $\\alpha_i > 0$ 的多重指标 $\\boldsymbol{\\alpha}$ 对应的 $c_{\\boldsymbol{\\alpha}}^2$ 的和。\n$$\nS_{T_i} = \\frac{\\sum_{\\boldsymbol{\\alpha} \\text{ with } \\alpha_i > 0} c_{\\boldsymbol{\\alpha}}^2}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2}\n$$\n\n**4. 表达式求值**\n\n首先，我们计算总方差 $\\mathbb{V}[u] = \\sum_{\\boldsymbol{\\alpha}\\neq\\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2$。给定的非零系数（对于 $\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}$）的平方是：\n- $c_{(1,0,0)}^2 = (\\frac{1}{2})^2 = \\frac{1}{4}$\n- $c_{(0,1,0)}^2 = (-\\frac{1}{4})^2 = \\frac{1}{16}$\n- $c_{(0,0,1)}^2 = (\\frac{1}{8})^2 = \\frac{1}{64}$\n- $c_{(2,0,0)}^2 = (\\frac{1}{4})^2 = \\frac{1}{16}$\n- $c_{(0,2,0)}^2 = (-\\frac{1}{8})^2 = \\frac{1}{64}$\n- $c_{(0,0,2)}^2 = (\\frac{1}{16})^2 = \\frac{1}{256}$\n- $c_{(1,1,0)}^2 = (\\frac{1}{8})^2 = \\frac{1}{64}$\n- $c_{(1,0,1)}^2 = (-\\frac{1}{16})^2 = \\frac{1}{256}$\n- $c_{(0,1,1)}^2 = (\\frac{1}{32})^2 = \\frac{1}{1024}$\n- $c_{(1,1,1)}^2 = (-\\frac{1}{32})^2 = \\frac{1}{1024}$\n$\\mathbb{V}[u] = \\frac{1}{4} + \\frac{1}{16} + \\frac{1}{64} + \\frac{1}{16} + \\frac{1}{64} + \\frac{1}{256} + \\frac{1}{64} + \\frac{1}{256} + \\frac{1}{1024} + \\frac{1}{1024}$\n$\\mathbb{V}[u] = \\frac{256+64+16+64+16+4+16+4+1+1}{1024} = \\frac{442}{1024} = \\frac{221}{512}$。\n\n接下来，我们计算 $S_i$ 的部分方差：\n- $\\mathbb{V}_1 = c_{(1,0,0)}^2 + c_{(2,0,0)}^2 = \\frac{1}{4} + \\frac{1}{16} = \\frac{5}{16}$。\n- $\\mathbb{V}_2 = c_{(0,1,0)}^2 + c_{(0,2,0)}^2 = \\frac{1}{16} + \\frac{1}{64} = \\frac{5}{64}$。\n- $\\mathbb{V}_3 = c_{(0,0,1)}^2 + c_{(0,0,2)}^2 = \\frac{1}{64} + \\frac{1}{256} = \\frac{5}{256}$。\n$S_1 = \\frac{5/16}{221/512} = \\frac{5}{16} \\cdot \\frac{512}{221} = \\frac{5 \\cdot 32}{221} = \\frac{160}{221}$。\n$S_2 = \\frac{5/64}{221/512} = \\frac{5}{64} \\cdot \\frac{512}{221} = \\frac{5 \\cdot 8}{221} = \\frac{40}{221}$。\n$S_3 = \\frac{5/256}{221/512} = \\frac{5}{256} \\cdot \\frac{512}{221} = \\frac{5 \\cdot 2}{221} = \\frac{10}{221}$。\n\n最后，我们计算 $S_{T_i}$ 的部分方差：\n- $\\mathbb{V}_{T_1} = c_{(1,0,0)}^2+c_{(2,0,0)}^2+c_{(1,1,0)}^2+c_{(1,0,1)}^2+c_{(1,1,1)}^2 = \\frac{1}{4}+\\frac{1}{16}+\\frac{1}{64}+\\frac{1}{256}+\\frac{1}{1024} = \\frac{256+64+16+4+1}{1024} = \\frac{341}{1024}$。\n- $\\mathbb{V}_{T_2} = c_{(0,1,0)}^2+c_{(0,2,0)}^2+c_{(1,1,0)}^2+c_{(0,1,1)}^2+c_{(1,1,1)}^2 = \\frac{1}{16}+\\frac{1}{64}+\\frac{1}{64}+\\frac{1}{1024}+\\frac{1}{1024} = \\frac{64+16+16+1+1}{1024} = \\frac{98}{1024} = \\frac{49}{512}$。\n- $\\mathbb{V}_{T_3} = c_{(0,0,1)}^2+c_{(0,0,2)}^2+c_{(1,0,1)}^2+c_{(0,1,1)}^2+c_{(1,1,1)}^2 = \\frac{1}{64}+\\frac{1}{256}+\\frac{1}{256}+\\frac{1}{1024}+\\frac{1}{1024} = \\frac{16+4+4+1+1}{1024} = \\frac{26}{1024} = \\frac{13}{512}$。\n$S_{T_1} = \\frac{341/1024}{442/1024} = \\frac{341}{442}$。\n$S_{T_2} = \\frac{49/512}{221/512} = \\frac{49}{221}$。\n$S_{T_3} = \\frac{13/512}{221/512} = \\frac{13}{221} = \\frac{1}{17}$。\n\n将最终结果整理成所要求的矩阵格式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{221}{512} & \\frac{160}{221} & \\frac{40}{221} & \\frac{10}{221} & \\frac{341}{442} & \\frac{49}{221} & \\frac{1}{17} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管标准分布存在经典的正交多项式，但现实世界的问题通常涉及具有任意或经验定义的分布的不确定性。这个编程练习要求您实现Gram-Schmidt过程，从给定的原始矩序列中构建一个正交多项式基底 。这项实践让您深入理解PCE的构造本质，并使您具备处理非经典不确定性的能力。",
            "id": "3523203",
            "problem": "给定一个单变量输入不确定性，它仅通过其直到 $2p$ 阶的原始矩序列 $\\{\\mu_{k}\\}_{k=0}^{2p}$ 来描述，其中 $\\mu_{0}=1$ 且 $\\mu_{k}=\\mathbb{E}[X^{k}]$，对于一个实值随机变量 $X$。考虑所有次数至多为 $p$ 的实多项式组成的多项式空间 $\\mathcal{P}_{p}$。将在 $\\mathcal{P}_{p}$ 上由其下的测度所诱导的内积定义为\n$$\n\\langle f,g\\rangle \\equiv \\mathbb{E}[f(X)g(X)].\n$$\n当 $f$ 和 $g$ 在单项式基 $\\{1,x,x^{2},\\dots,x^{p}\\}$ 中表示时，该内积简化为一种涉及矩的双线性形式：\n$$\n\\langle x^{i},x^{j}\\rangle=\\mu_{i+j},\\quad \\text{对于所有 } i,j\\in\\{0,1,\\dots,p\\}.\n$$\n您的任务是通过对单项式序列 $\\{1,x,\\dots,x^{p}\\}$ 应用上述定义的内积 $\\langle\\cdot,\\cdot\\rangle$ 下的 Gram–Schmidt 正交化，在 $\\mathcal{P}_{p}$ 中构建一个正交多项式混沌基 $\\{\\phi_{k}(x)\\}_{k=0}^{p}$。每个多项式 $\\phi_{k}(x)$ 必须由其在单项式基中的系数向量表示，并且正交性必须满足\n$$\n\\langle \\phi_{i},\\phi_{j}\\rangle=\\delta_{ij},\\quad \\text{对于所有 } i,j\\in\\{0,1,\\dots,p\\},\n$$\n其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n从第一性原理出发，仅使用上述定义和原始矩 $\\{\\mu_k\\}_{k=0}^{2p}$ 来：\n- 在单项式基上实现一个数值稳定的修正 Gram–Schmidt 过程，\n- 生成正交基系数 $\\{\\phi_{k}\\}_{k=0}^{p}$，\n- 通过构建 Gram 矩阵 $G\\in\\mathbb{R}^{(p+1)\\times(p+1)}$ 来数值上验证正交性，其元素为\n$$\nG_{ij}=\\langle \\phi_{i},\\phi_{j}\\rangle,\n$$\n使用原始矩计算，以及\n- 报告与单位矩阵的最大绝对偏差，\n$$\n\\varepsilon \\equiv \\max_{0\\le i,j\\le p}\\left|G_{ij}-\\delta_{ij}\\right|.\n$$\n\n所有量都是无量纲的。不涉及角度。不涉及百分比。\n\n测试套件。您的程序必须对以下五种分布运行上述过程，每种分布都由一个直到 $2p$ 阶的有效矩序列指定，并为每个测试用例返回一个标量 $\\varepsilon$：\n\n- 案例 1 (标准正态分布): $X\\sim\\mathcal{N}(0,1)$。使用阶数 $p=6$。其原始矩由经过充分检验的恒等式给出\n$$\n\\mu_{2n}=(2n-1)!!=\\prod_{k=1}^{n}(2k-1),\\quad \\mu_{2n+1}=0,\\quad \\text{对于所有 } n\\in\\mathbb{N}_{0}.\n$$\n\n- 案例 2 (均匀分布): $X\\sim\\mathcal{U}(-1,1)$。使用阶数 $p=6$。其原始矩为\n$$\n\\mu_{2n}=\\frac{1}{2n+1},\\quad \\mu_{2n+1}=0,\\quad \\text{对于所有 } n\\in\\mathbb{N}_{0}.\n$$\n\n- 案例 3 (指数分布): $X\\sim\\mathrm{Exp}(\\lambda)$，率 $\\lambda=1$。使用阶数 $p=6$。其原始矩为\n$$\n\\mu_{k}=k!,\\quad \\text{对于所有 } k\\in\\mathbb{N}_{0}.\n$$\n\n- 案例 4 (贝塔分布): $X\\sim\\mathrm{Beta}(\\alpha,\\beta)$，其中 $\\alpha=2$ 和 $\\beta=3$。使用阶数 $p=6$。其原始矩为\n$$\n\\mu_{k}=\\frac{(\\alpha)_{k}}{(\\alpha+\\beta)_{k}}=\\frac{\\Gamma(\\alpha+k)\\,\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\,\\Gamma(\\alpha+\\beta+k)}=\\frac{24}{(k+4)(k+3)(k+2)},\\quad \\text{对于所有 } k\\in\\mathbb{N}_{0},\n$$\n其中 $(a)_{k}$ 是上升 Pochhammer 符号。\n\n- 案例 5 (两点离散分布): $X$ 以概率 $w=0.7$ 取值 $a=-1$，以概率 $1-w=0.3$ 取值 $b=2$。使用阶数 $p=1$，以使在 $\\mathcal{P}_{1}$ 上诱导的双线性形式是非奇异的。其原始矩为\n$$\n\\mu_{k}=w\\,a^{k}+(1-w)\\,b^{k},\\quad \\text{对于所有 } k\\in\\mathbb{N}_{0}.\n$$\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3},r_{4},r_{5}]$），其中 $r_{i}$ 是为案例 $i$ 计算的标量 $\\varepsilon$。每个 $r_{i}$ 必须是实数（浮点数）。不应打印任何其他文本。",
            "solution": "目标是为次数至多为 $p$ 的多项式空间（记作 $\\mathcal{P}_p$）构建一个正交多项式基 $\\{\\phi_k(x)\\}_{k=0}^p$。构建过程是关于一个由随机变量 $X$ 诱导的内积进行的，该随机变量的概率测度通过给定的原始矩序列 $\\{\\mu_k\\}_{k=0}^{2p}$ 来定义。指定的方法是应用于单项式基 $\\{1, x, \\dots, x^p\\}$ 的修正 Gram-Schmidt (MGS) 过程。\n\n首先，我们将每个多项式 $f(x) \\in \\mathcal{P}_p$ 表示为其在单项式基中的系数向量。一个多项式 $f(x) = \\sum_{i=0}^p c_i x^i$ 由系数向量 $\\mathbf{c} = [c_0, c_1, \\dots, c_p]^T \\in \\mathbb{R}^{p+1}$ 唯一确定。在此表示中，单项式基 $\\{1, x, \\dots, x^p\\}$ 对应于 $\\mathbb{R}^{p+1}$ 的标准基向量 $\\{\\mathbf{e}_0, \\mathbf{e}_1, \\dots, \\mathbf{e}_p\\}$，其中 $\\mathbf{e}_k$ 是一个在索引 $k$ 处为 1，其他位置为 0 的向量。\n\n内积 $\\langle f, g \\rangle \\equiv \\mathbb{E}[f(X)g(X)]$ 可以用这些系数向量来表示。设 $f(x)$ 和 $g(x)$ 的系数向量分别为 $\\mathbf{a}=[a_0, \\dots, a_p]^T$ 和 $\\mathbf{b}=[b_0, \\dots, b_p]^T$。根据期望的线性性，内积成为一种双线性形式：\n$$\n\\langle f, g \\rangle = \\mathbb{E}\\left[ \\left( \\sum_{i=0}^p a_i X^i \\right) \\left( \\sum_{j=0}^p b_j X^j \\right) \\right] = \\sum_{i=0}^p \\sum_{j=0}^p a_i b_j \\mathbb{E}[X^{i+j}] = \\sum_{i=0}^p \\sum_{j=0}^p a_i b_j \\mu_{i+j}\n$$\n此计算需要直到 $2p$ 阶的原始矩，因为两个 $p$ 次多项式的乘积是一个次数最高为 $2p$ 的多项式，其期望 $\\langle x^p, x^p \\rangle = \\mu_{2p}$ 是所需的最高阶矩。\n\n任务是正交化单项式基向量，我们将其记为 $\\{\\mathbf{v}_k = \\mathbf{e}_k\\}_{k=0}^p$。我们对这组向量应用修正 Gram-Schmidt (MGS) 算法。MGS 过程以其相比经典 Gram-Schmidt 方法更优的数值稳定性而著称。\n\n让我们将初始向量集（单项式系数向量）表示为 $\\{\\mathbf{v}_j\\}_{j=0}^p$。MGS 算法按如下方式生成一个正交向量集 $\\{\\mathbf{q}_j\\}_{j=0}^p$：\n通过对所有 $j$ 设置 $\\mathbf{u}_j = \\mathbf{v}_j$ 来初始化一个工作向量集 $\\{\\mathbf{u}_j\\}_{j=0}^p$。\n\n对于 $j = 0, \\dots, p$：\n1.  使用由矩定义的内积计算当前向量 $\\mathbf{u}_j$ 的范数：$N_j = \\sqrt{\\langle \\mathbf{u}_j, \\mathbf{u}_j \\rangle}$。\n2.  归一化该向量以获得第 $j$ 个正交向量：$\\mathbf{q}_j = \\mathbf{u}_j / N_j$。\n3.  对于所有 $k > j$ 的后续向量 $\\mathbf{u}_k$，减去它们平行于 $\\mathbf{q}_j$ 的分量：\n    $$\n    \\mathbf{u}_k \\leftarrow \\mathbf{u}_k - \\langle\\mathbf{u}_k, \\mathbf{q}_j\\rangle \\mathbf{q}_j\n    $$\n    此步骤确保更新后的向量 $\\mathbf{u}_k$ 与 $\\mathbf{q}_j$ 正交。该过程重复进行，使得工作集中的剩余向量依次与每个新生成的基向量正交。\n\n最终的向量集 $\\{\\mathbf{q}_j\\}_{j=0}^p$ 包含了所需正交多项式 $\\{\\phi_j(x)\\}_{j=0}^p$ 的系数。\n\n最后，为验证计算出的基的正交性，我们构建 Gram 矩阵 $G$，其元素为 $G_{ij} = \\langle \\phi_i, \\phi_j \\rangle$。在我们的向量表示中，这是 $G_{ij} = \\langle \\mathbf{q}_i, \\mathbf{q}_j \\rangle$。对于一个完全正交的基，该矩阵必须是单位矩阵 $I$。数值误差由与单位矩阵的最大绝对偏差来量化，由度量 $\\varepsilon$ 指定：\n$$\n\\varepsilon \\equiv \\max_{0\\le i,j\\le p}\\left|G_{ij}-\\delta_{ij}\\right|\n$$\n对五个测试用例中的每一个都实施此过程，首先为每个指定的概率分布生成所需的矩序列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import factorial, factorial2\nimport math\n\ndef get_moments(case_name, p):\n    \"\"\"\n    Generates the sequence of raw moments {mu_k} up to order 2*p\n    for a given distribution.\n    \n    Args:\n        case_name (str): The name of the distribution case.\n        p (int): The maximum polynomial degree.\n        \n    Returns:\n        numpy.ndarray: An array of moments from order 0 to 2*p.\n    \"\"\"\n    max_order = 2 * p\n    moments = np.zeros(max_order + 1, dtype=np.float64)\n    \n    if case_name == 'normal':\n        # X ~ N(0,1), mu_{2n} = (2n-1)!!, mu_{2n+1} = 0\n        for n in range((max_order // 2) + 1):\n            k = 2 * n\n            if k = max_order:\n                if k == 0:\n                    moments[k] = 1.0\n                else:\n                    moments[k] = float(factorial2(k - 1, exact=True))\n    \n    elif case_name == 'uniform':\n        # X ~ U(-1,1), mu_{2n} = 1/(2n+1), mu_{2n+1} = 0\n        for n in range((max_order // 2) + 1):\n            k = 2 * n\n            if k = max_order:\n                moments[k] = 1.0 / (k + 1)\n            \n    elif case_name == 'exponential':\n        # X ~ Exp(1), mu_k = k!\n        for k in range(max_order + 1):\n            moments[k] = float(factorial(k, exact=True))\n            \n    elif case_name == 'beta':\n        # X ~ Beta(2,3), mu_k = 24 / ((k+4)(k+3)(k+2))\n        for k in range(max_order + 1):\n            moments[k] = 24.0 / ((k + 4.0) * (k + 3.0) * (k + 2.0))\n            \n    elif case_name == 'discrete':\n        # Two-point distribution\n        a, b, w = -1.0, 2.0, 0.7\n        # mu_k = w*a^k + (1-w)*b^k\n        for k in range(max_order + 1):\n            moments[k] = w * (a**k) + (1.0 - w) * (b**k)\n            \n    return moments\n\ndef inner_product(c1, c2, moments):\n    \"\"\"\n    Computes the inner product of two polynomials given their monomial coefficients.\n    \"\"\"\n    val = 0.0\n    p1 = len(c1) - 1\n    p2 = len(c2) - 1\n    for i in range(p1 + 1):\n        for j in range(p2 + 1):\n            if c1[i] != 0 and c2[j] != 0:\n                val += c1[i] * c2[j] * moments[i + j]\n    return val\n\ndef modified_gram_schmidt(p, moments):\n    \"\"\"\n    Performs the Modified Gram-Schmidt process on the monomial basis.\n    Returns a list of coefficient vectors for the orthonormal polynomials.\n    \"\"\"\n    U = [np.eye(p + 1)[i] for i in range(p + 1)]\n    Q = []\n    \n    for j in range(p + 1):\n        # Normalize the current vector\n        norm_u_j = np.sqrt(inner_product(U[j], U[j], moments))\n        if norm_u_j  1e-15: \n             q_j = np.zeros(p + 1)\n        else:\n             q_j = U[j] / norm_u_j\n        Q.append(q_j)\n        \n        # Orthogonalize remaining vectors against the new basis vector\n        for k in range(j + 1, p + 1):\n            proj = inner_product(U[k], q_j, moments)\n            U[k] = U[k] - proj * q_j\n            \n    return Q\n\ndef solve_all_cases_and_print():\n    \"\"\"\n    Runs all test cases and prints the results in the required format.\n    \"\"\"\n    cases = {\n        'normal': 6,\n        'uniform': 6,\n        'exponential': 6,\n        'beta': 6,\n        'discrete': 1\n    }\n    \n    results = []\n    \n    for case_name, p in cases.items():\n        moments = get_moments(case_name, p)\n        \n        # Build the orthonormal basis using MGS\n        Q = modified_gram_schmidt(p, moments)\n        \n        # Build the Gram matrix to verify orthogonality\n        gram_matrix = np.zeros((p + 1, p + 1))\n        for i in range(p + 1):\n            for j in range(p + 1):\n                gram_matrix[i, j] = inner_product(Q[i], Q[j], moments)\n                \n        # Calculate the max absolute deviation from the identity matrix\n        identity_matrix = np.eye(p + 1)\n        epsilon = np.max(np.abs(gram_matrix - identity_matrix))\n        results.append(epsilon)\n        \n    print(\"[\" + \",\".join(map(str, results)) + \"]\")\n\nif __name__ == '__main__':\n    solve_all_cases_and_print()\n```"
        }
    ]
}