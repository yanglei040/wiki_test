{
    "hands_on_practices": [
        {
            "introduction": "为了有效地应用随机配置法，我们必须首先掌握其理论基础。本练习将引导您从第一性原理出发，推导多维配置插值式的表达式。通过解决这个问题 ，您将巩固对如何利用张量积拉格朗日多项式，将离散点的样本值转化为连续代理模型的理解。",
            "id": "3350693",
            "problem": "在频域计算电磁学中，考虑一个参数化的麦克斯韦边界值问题，其关注的标量由 $u(\\boldsymbol{\\xi})$ 表示，其中 $\\boldsymbol{\\xi} \\in \\Gamma \\subset \\mathbb{R}^{d}$ 代表 $d$ 个独立的不确定性输入参数，其乘积概率密度为 $\\rho(\\boldsymbol{\\xi})=\\prod_{j=1}^{d}\\rho_{j}(\\xi_{j})$。在一个随机配置 (SC) 框架下，给定一个张量积网格，该网格由每个维度 $j \\in \\{1,\\dots,d\\}$ 的单变量节点集 $\\{\\xi^{(j)}_{k_{j}}\\}_{k_{j}=1}^{n_{j}} \\subset \\Gamma_{j}$ 构建而成。对于每个维度 $j$，相应的单变量拉格朗日基多项式 $\\{\\ell_{j,k_{j}}(\\xi_{j})\\}_{k_{j}=1}^{n_{j}}$ 由克罗内克 Delta 条件 $\\ell_{j,k_{j}}(\\xi^{(j)}_{m_{j}})=\\delta_{k_{j}m_{j}}$（对于所有 $k_{j},m_{j}\\in\\{1,\\dots,n_{j}\\}$）定义，其中 $\\delta_{k_{j}m_{j}}$ 是克罗内克 delta 符号。完整的张量积节点集为 $\\{\\boldsymbol{\\xi}^{\\boldsymbol{k}}\\}_{\\boldsymbol{k}}$，其中多重指标为 $\\boldsymbol{k}=(k_{1},\\dots,k_{d})$，且 $\\boldsymbol{\\xi}^{\\boldsymbol{k}}=(\\xi^{(1)}_{k_{1}},\\dots,\\xi^{(d)}_{k_{d}})$。假设一个确定性麦克斯韦求解器在所有张量积节点上提供了值 $u(\\boldsymbol{\\xi}^{\\boldsymbol{k}})$。\n\n仅使用有限维函数空间中插值的基本定义以及单变量拉格朗日基的克罗内克 Delta 性质，推导张量积随机配置插值函数 $\\hat{u}(\\boldsymbol{\\xi})$ 的显式表达式，该表达式在张量积节点上精确插值可用样本 $\\{u(\\boldsymbol{\\xi}^{\\boldsymbol{k}})\\}$。您的最终答案必须是 $\\hat{u}(\\boldsymbol{\\xi})$ 的一个单一闭式解析表达式。不需要进行数值计算、单位换算或四舍五入。",
            "solution": "问题陈述经核实具有科学依据、适定且客观。它提供了一套完整且一致的定义和条件，用以推导张量积随机配置插值函数的显式表达式。该问题基于多元多项式插值的基本原理，是不确定性量化领域的一个标准理论练习。所有术语都得到了正式定义，任务是基于所提供的前提进行数学推导。因此，该问题是有效的，并将提供解答。\n\n目标是推导插值函数 $\\hat{u}(\\boldsymbol{\\xi})$ 的表达式，该函数近似于关注量 $u(\\boldsymbol{\\xi})$。该插值函数构建于一个有限维函数空间中，并且必须满足在一组离散点上的插值条件。问题指定了张量积结构，这指导了函数空间基的选择。\n\n令多元插值函数空间由单变量拉格朗日基多项式 $\\{\\ell_{j,k_j}(\\xi_j)\\}$ 的张量积所张成。这个多元空间中，与张量积节点 $\\boldsymbol{\\xi}^{\\boldsymbol{k}}$ 相关联的基函数，由相应单变量基函数的乘积给出。我们将此多元基函数表示为 $L_{\\boldsymbol{k}}(\\boldsymbol{\\xi})$，其中 $\\boldsymbol{k}=(k_1, \\dots, k_d)$ 是一个多重指标，其每个分量 $k_j$ 的取值范围为 $1$ 到 $n_j$。其定义为：\n$$L_{\\boldsymbol{k}}(\\boldsymbol{\\xi}) = \\prod_{j=1}^{d} \\ell_{j,k_j}(\\xi_j)$$\n随机配置插值函数 $\\hat{u}(\\boldsymbol{\\xi})$ 可以表示为这些基函数的线性组合：\n$$\\hat{u}(\\boldsymbol{\\xi}) = \\sum_{\\boldsymbol{k}} c_{\\boldsymbol{k}} L_{\\boldsymbol{k}}(\\boldsymbol{\\xi})$$\n求和是对所有有效的多重指标 $\\boldsymbol{k}$ 进行的，这对应于对张量积网格中所有节点的求和。这可以更明确地写为：\n$$\\hat{u}(\\boldsymbol{\\xi}) = \\sum_{k_1=1}^{n_1} \\cdots \\sum_{k_d=1}^{n_d} c_{(k_1, \\dots, k_d)} \\left( \\prod_{j=1}^{d} \\ell_{j,k_j}(\\xi_j) \\right)$$\n系数 $c_{\\boldsymbol{k}}$ 是未知的，必须被确定。为求得这些系数，我们施加插值条件，该条件规定插值函数在张量积网格的每个节点上必须等于真实的函数值。对于任意对应于多重指标 $\\boldsymbol{m}=(m_1, \\dots, m_d)$ 的节点 $\\boldsymbol{\\xi}^{\\boldsymbol{m}}$，此条件为：\n$$\\hat{u}(\\boldsymbol{\\xi}^{\\boldsymbol{m}}) = u(\\boldsymbol{\\xi}^{\\boldsymbol{m}})$$\n将 $\\hat{u}(\\boldsymbol{\\xi})$ 的表达式代入此方程左侧，我们得到：\n$$\\sum_{\\boldsymbol{k}} c_{\\boldsymbol{k}} L_{\\boldsymbol{k}}(\\boldsymbol{\\xi}^{\\boldsymbol{m}}) = u(\\boldsymbol{\\xi}^{\\boldsymbol{m}})$$\n现在，我们必须在节点 $\\boldsymbol{\\xi}^{\\boldsymbol{m}}$ 处计算基函数 $L_{\\boldsymbol{k}}(\\boldsymbol{\\xi})$ 的值。根据定义，$\\boldsymbol{\\xi}^{\\boldsymbol{m}} = (\\xi^{(1)}_{m_1}, \\dots, \\xi^{(d)}_{m_d})$。因此我们有：\n$$L_{\\boldsymbol{k}}(\\boldsymbol{\\xi}^{\\boldsymbol{m}}) = \\prod_{j=1}^{d} \\ell_{j,k_j}(\\xi^{(j)}_{m_j})$$\n问题陈述了单变量拉格朗日基多项式的克罗内克 Delta 性质：$\\ell_{j,k_{j}}(\\xi^{(j)}_{m_{j}})=\\delta_{k_{j}m_{j}}$，其中 $\\delta_{k_{j}m_{j}}$ 是克罗内克 delta 符号。将此性质代入 $L_{\\boldsymbol{k}}(\\boldsymbol{\\xi}^{\\boldsymbol{m}})$ 的表达式中，得到：\n$$L_{\\boldsymbol{k}}(\\boldsymbol{\\xi}^{\\boldsymbol{m}}) = \\prod_{j=1}^{d} \\delta_{k_j m_j}$$\n克罗内克 delta 的乘积为 $1$ 当且仅当对于所有 $j \\in \\{1, \\dots, d\\}$ 都有 $k_j = m_j$，这意味着多重指标 $\\boldsymbol{k}$ 必须与多重指标 $\\boldsymbol{m}$ 完全相同。如果任何分量 $k_j$ 不等于 $m_j$，则乘积为 $0$。这个乘积定义了多维克罗内克 delta，$\\delta_{\\boldsymbol{k}\\boldsymbol{m}}$。因此，多元基函数也表现出克罗内克 Delta 性质：\n$$L_{\\boldsymbol{k}}(\\boldsymbol{\\xi}^{\\boldsymbol{m}}) = \\delta_{\\boldsymbol{k}\\boldsymbol{m}}$$\n将此结果代回系数方程中：\n$$\\sum_{\\boldsymbol{k}} c_{\\boldsymbol{k}} \\delta_{\\boldsymbol{k}\\boldsymbol{m}} = u(\\boldsymbol{\\xi}^{\\boldsymbol{m}})$$\n由于克罗内克 delta 的筛选性质，左侧的求和坍缩，仅留下 $\\boldsymbol{k} = \\boldsymbol{m}$ 的那一项。这得出：\n$$c_{\\boldsymbol{m}} = u(\\boldsymbol{\\xi}^{\\boldsymbol{m}})$$\n由于此式对任何多重指标 $\\boldsymbol{m}$ 都成立，我们发现系数 $c_{\\boldsymbol{k}}$ 就是函数 $u$ 在相应张量积节点 $\\boldsymbol{\\xi}^{\\boldsymbol{k}}$ 上的已知值。\n\n最后，我们将这些系数代回插值函数 $\\hat{u}(\\boldsymbol{\\xi})$ 的一般表达式中：\n$$\\hat{u}(\\boldsymbol{\\xi}) = \\sum_{\\boldsymbol{k}} u(\\boldsymbol{\\xi}^{\\boldsymbol{k}}) L_{\\boldsymbol{k}}(\\boldsymbol{\\xi})$$\n使用 $L_{\\boldsymbol{k}}(\\boldsymbol{\\xi})$ 的定义以及对多重指标 $\\boldsymbol{k}=(k_1, \\dots, k_d)$ 的求和，将其完全写出，便得到了张量积随机配置插值函数的最终显式表达式：\n$$\\hat{u}(\\boldsymbol{\\xi}) = \\sum_{k_1=1}^{n_1} \\cdots \\sum_{k_d=1}^{n_d} u(\\boldsymbol{\\xi}^{\\boldsymbol{k}}) \\prod_{j=1}^{d} \\ell_{j,k_j}(\\xi_j)$$\n此表达式根据其构造满足了对所有节点 $\\boldsymbol{\\xi}^{\\boldsymbol{m}}$ 的插值条件 $\\hat{u}(\\boldsymbol{\\xi}^{\\boldsymbol{m}}) = u(\\boldsymbol{\\xi}^{\\boldsymbol{m}})$，并且其推导过程仅使用了问题陈述中指定的基本原理。",
            "answer": "$$\n\\boxed{\n\\hat{u}(\\boldsymbol{\\xi}) = \\sum_{k_1=1}^{n_1} \\cdots \\sum_{k_d=1}^{n_d} u(\\boldsymbol{\\xi}^{\\boldsymbol{k}}) \\prod_{j=1}^{d} \\ell_{j,k_j}(\\xi_j)\n}\n$$"
        },
        {
            "introduction": "代理模型构建完成后，一个关键应用是高效地计算统计矩。本练习提供一个明确的多项式代理模型，要求您计算其均值和方差，这对于不确定性量化至关重要。这项计算  搭建了从抽象插值式到其在表征系统统计行为方面实际应用的桥梁。",
            "id": "3350756",
            "problem": "考虑一个计算电磁学中的横电（TE）平面波散射问题的双参数不确定性模型，其中标量关注量 $u$（例如，从麦克斯韦方程组的解中提取的归一化后向散射振幅）依赖于两个标准化的独立随机输入 $\\xi_{1}$ 和 $\\xi_{2}$，两者均在 $[-1,1]$ 上均匀分布。通过在每个维度上3阶的张量积高斯-勒让德节点上对确定性电磁求解进行插值，构建了一个非侵入式随机配置代理模型 $\\hat{u}(\\xi_{1},\\xi_{2})$。插值节点和相关的一维求积权重为\n$$\\xi^{(1)} = -\\sqrt{\\frac{3}{5}},\\quad \\xi^{(2)} = 0,\\quad \\xi^{(3)} = \\sqrt{\\frac{3}{5}},\\qquad w^{(1)} = \\frac{5}{9},\\quad w^{(2)} = \\frac{8}{9},\\quad w^{(3)} = \\frac{5}{9}.$$\n得到的代理模型形式如下\n$$\\hat{u}(\\xi_{1},\\xi_{2}) = 1.2 + 0.4\\,\\xi_{1} - 0.3\\,\\xi_{2} + 0.25\\,\\xi_{1}\\xi_{2} + 0.1\\,\\xi_{1}^{2} + 0.05\\,\\xi_{2}^{2}.$$\n将 $\\hat{u}$ 视为 $u$ 的配置近似。使用由这些插值节点导出的求积（即，在每个维度上3阶的张量积高斯-勒让德法则），计算在 $[-1,1]^{2}$ 上的独立均匀分布下 $u$ 的均值 $\\mathbb{E}[u]$ 和方差 $\\mathrm{Var}[u]$。将最终答案表示为无舍入的精确有理数。在最终答案中，将 $\\mathbb{E}[u]$ 和 $\\mathrm{Var}[u]$ 一起以单个行矩阵的形式提供。",
            "solution": "该问题要求计算一个给定的二维多项式代理模型 $\\hat{u}(\\xi_1, \\xi_2)$ 在输入变量 $\\xi_1, \\xi_2$ 均为 $[-1,1]$ 上的独立均匀分布时的均值和方差。\n\n**1. 计算均值 $\\mathbb{E}[\\hat{u}]$**\n\n代理模型为：\n$$\\hat{u}(\\xi_{1},\\xi_{2}) = 1.2 + 0.4\\,\\xi_{1} - 0.3\\,\\xi_{2} + 0.25\\,\\xi_{1}\\xi_{2} + 0.1\\,\\xi_{1}^{2} + 0.05\\,\\xi_{2}^{2}$$\n\n对于一个在 $[-1,1]$ 上均匀分布的随机变量 $\\xi$，其奇数次幂的期望为零（例如 $\\mathbb{E}[\\xi] = 0$），偶数次幂的期望为 $\\mathbb{E}[\\xi^{2k}] = \\frac{1}{2k+1}$。因此，$\\mathbb{E}[\\xi^2] = 1/3$。由于 $\\xi_1$ 和 $\\xi_2$ 相互独立，$\\mathbb{E}[\\xi_1 \\xi_2] = \\mathbb{E}[\\xi_1]\\mathbb{E}[\\xi_2] = 0$。\n\n利用期望的线性性质：\n$$\n\\begin{aligned}\n\\mathbb{E}[\\hat{u}] &= \\mathbb{E}[1.2] + 0.4\\mathbb{E}[\\xi_1] - 0.3\\mathbb{E}[\\xi_2] + 0.25\\mathbb{E}[\\xi_1\\xi_2] + 0.1\\mathbb{E}[\\xi_1^2] + 0.05\\mathbb{E}[\\xi_2^2] \\\\\n&= 1.2 + 0.4(0) - 0.3(0) + 0.25(0) + 0.1(1/3) + 0.05(1/3) \\\\\n&= 1.2 + 0.15/3 = 1.2 + 0.05 = 1.25\n\\end{aligned}\n$$\n将均值表示为有理数：$\\mathbb{E}[\\hat{u}] = \\frac{5}{4}$。\n\n**2. 计算方差 $\\mathrm{Var}[\\hat{u}]$**\n\n方差可以通过 $\\mathrm{Var}[\\hat{u}] = \\mathbb{E}[\\hat{u}^2] - (\\mathbb{E}[\\hat{u}])^2$ 计算。由于 $\\hat{u}$ 是一个多项式，我们可以利用正交多项式的性质来简化计算。勒让德多项式在 $[-1,1]$ 上关于均匀测度是正交的。\n$\\hat{u}$ 可以重写为中心化的形式：\n$$ \\hat{u} = \\mathbb{E}[\\hat{u}] + (0.4\\xi_1 - 0.3\\xi_2 + 0.25\\xi_1\\xi_2) + 0.1(\\xi_1^2 - 1/3) + 0.05(\\xi_2^2 - 1/3) $$\n由于各项（常数、线性项、二次项）相互正交，方差是各项方差之和：\n$$\n\\begin{aligned}\n\\mathrm{Var}[\\hat{u}] &= \\mathrm{Var}[0.4\\xi_1] + \\mathrm{Var}[-0.3\\xi_2] + \\mathrm{Var}[0.25\\xi_1\\xi_2] + \\mathrm{Var}[0.1\\xi_1^2] + \\mathrm{Var}[0.05\\xi_2^2] \\\\\n&= (0.4)^2\\mathrm{Var}[\\xi_1] + (-0.3)^2\\mathrm{Var}[\\xi_2] + (0.25)^2\\mathrm{Var}[\\xi_1\\xi_2] + (0.1)^2\\mathrm{Var}[\\xi_1^2] + (0.05)^2\\mathrm{Var}[\\xi_2^2]\n\\end{aligned}\n$$\n我们需要以下方差值：\n- $\\mathrm{Var}[\\xi] = \\mathbb{E}[\\xi^2] - (\\mathbb{E}[\\xi])^2 = 1/3 - 0^2 = 1/3$。\n- $\\mathrm{Var}[\\xi_1\\xi_2] = \\mathbb{E}[(\\xi_1\\xi_2)^2] - (\\mathbb{E}[\\xi_1\\xi_2])^2 = \\mathbb{E}[\\xi_1^2]\\mathbb{E}[\\xi_2^2] - 0^2 = (1/3)(1/3) = 1/9$。\n- $\\mathbb{E}[\\xi^4] = 1/5$。\n- $\\mathrm{Var}[\\xi^2] = \\mathbb{E}[(\\xi^2)^2] - (\\mathbb{E}[\\xi^2])^2 = \\mathbb{E}[\\xi^4] - (1/3)^2 = 1/5 - 1/9 = 4/45$。\n\n代入数值：\n$$\n\\begin{aligned}\n\\mathrm{Var}[\\hat{u}] &= 0.16(1/3) + 0.09(1/3) + 0.0625(1/9) + 0.01(4/45) + 0.0025(4/45) \\\\\n&= \\frac{0.25}{3} + \\frac{0.0625}{9} + \\frac{0.04}{45} + \\frac{0.01}{45} \\\\\n&= \\frac{1}{12} + \\frac{1/16}{9} + \\frac{0.05}{45} = \\frac{1}{12} + \\frac{1}{144} + \\frac{1}{900}\n\\end{aligned}\n$$\n通分，使用最小公倍数 $3600$:\n$$ \\mathrm{Var}[\\hat{u}] = \\frac{300}{3600} + \\frac{25}{3600} + \\frac{4}{3600} = \\frac{329}{3600} $$\n问题要求使用高斯-勒让德求积法则计算。由于代理模型是二次多项式，而三点高斯法则是对最高五次多项式精确的，因此使用求积法则会得到与上述解析积分完全相同的结果。\n\n最终结果以行矩阵形式给出：\n$$ \\begin{pmatrix} \\mathbb{E}[u] & \\mathrm{Var}[u] \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4} & \\frac{329}{3600} \\end{pmatrix} $$",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{5}{4} & \\frac{329}{3600} \\end{pmatrix}} $$"
        },
        {
            "introduction": "最后的这项实践将挑战您将随机配置法应用于一个计算电磁学中的实际问题：量化天线输入阻抗的不确定性。您将实现从物理系统建模到分析数值结果的完整工作流程，并特别关注非光滑行为 。本练习旨在突出物理现象如何给数值方法带来挑战，并展示批判性地评估代理模型准确性的重要性。",
            "id": "3350734",
            "problem": "考虑一个放置在均匀衬底上的薄中心馈电平面天线，在角频率 $\\omega$ 下激励。输入端口由两个导体之间的一个窄馈电间隙实现，其物理宽度为 $g(\\xi_1)$，导体的有效重叠面积为 $A$，并由相对介电常数为 $\\varepsilon_r(\\xi_2)$ 的电介质支撑。量 $\\xi_1$ 和 $\\xi_2$ 是在区间 $[-1,1]$ 上服从均匀分布的独立标准化随机变量。衬底的绝对介电常数为 $\\varepsilon_0\\varepsilon_r(\\xi_2)$，其中 $\\varepsilon_0$ 是真空介电常数。该天线以一个非色散的辐射电阻 $R_{\\mathrm{rad}}$ 进行辐射，局部馈电引入了一个串联电感 $L_s$。在馈电处近场的准静态集总元件体系内进行分析，并假设在 $x\\text{-}y$ 平面内为二维激励，且馈电电感之外的磁耦合可忽略不计。取光速为 $c$，电场为 $\\mathbf{E}$，磁场为 $\\mathbf{H}$，电通量密度为 $\\mathbf{D}$，磁通量密度为 $\\mathbf{B}$。从Maxwell方程组 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$ 和 $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\partial \\mathbf{D}/\\partial t$、本构关系 $\\mathbf{D} = \\varepsilon \\mathbf{E}$ (其中 $\\varepsilon = \\varepsilon_0 \\varepsilon_r$) 以及电报员模型所蕴含的集总元件极限出发，推导出一个能捕捉端口行为的简化等效网络。在此网络中，辐射由一个电阻表示，馈电间隙由一个电容器表示，其电容通过适当的平行板近似依赖于 $\\varepsilon_r(\\xi_2)$ 和 $g(\\xi_1)$。端口的输入阻抗 $Z_{\\mathrm{in}}(\\boldsymbol{\\xi})$ 是当馈电电感与辐射电阻和间隙电容器的并联组合串联时，从端口看进去的阻抗。由于当 $g(\\xi_1) \\to 0$ 时间隙电容无界增长，并联支路的导纳会变得很大，这可能导致 $Z_{\\mathrm{in}}(\\boldsymbol{\\xi})$ 作为 $\\boldsymbol{\\xi} = (\\xi_1,\\xi_2)$ 的函数表现出非光滑行为。\n\n您的任务是使用随机配置法来量化由随机馈电间隙 $g(\\xi_1)$ 和衬底相对介电常数 $\\varepsilon_r(\\xi_2)$ 引起的输入阻抗模 $|Z_{\\mathrm{in}}(\\boldsymbol{\\xi})|$ 的不确定性，并探究当 $g(\\xi_1) \\to 0$ 时近奇异电容行为的影响。模型假设必须保持在准静态和线性范围内。计算必须对两个独立的均匀随机变量使用张量积Gauss–Legendre配置点进行。期望值应通过这些点上的加权和来近似。使用一个带有Sobol序列的独立准蒙特卡罗（QMC）基准来评估每个测试案例的配置误差。\n\n定义以下确定性参数，所有参数均物理上合理且科学上一致：\n- 频率 $f = 3\\times 10^9$，单位赫兹 (Hz)，因此角频率 $\\omega = 2\\pi f$，单位弧度/秒。\n- 真空介电常数 $\\varepsilon_0 = 8.854187817\\times 10^{-12}$，单位法拉/米 (F/m)。\n- 有效重叠面积 $A = 1\\times 10^{-4}$，单位平方米 (m$^2$)。\n- 辐射电阻 $R_{\\mathrm{rad}} = 50$，单位欧姆 ($\\Omega$)。\n- 串联馈电电感 $L_s = 1\\times 10^{-9}$，单位亨利 (H)。\n\n从标准化随机变量到物理参数的映射必须是仿射的：\n- 对于任何区间 $[a,b]$ 和标准化变量 $\\xi \\in [-1,1]$，物理值为 $x(\\xi) = \\frac{a+b}{2} + \\frac{b-a}{2}\\,\\xi$。\n- 使用此映射从各自的范围获得 $g(\\xi_1)$ 和 $\\varepsilon_r(\\xi_2)$。\n\n随机配置必须在每个维度上采用 $n$ 个Gauss–Legendre点。如果 $\\{(\\xi_{1,i},w_{1,i})\\}_{i=1}^n$ 和 $\\{(\\xi_{2,j},w_{2,j})\\}_{j=1}^n$ 是在 $[-1,1]$ 上的一维节点和权重，那么二维张量积法则通过以下公式近似任何在映射后的矩形区域上服从独立均匀分布的平方可积量 $u(\\xi_1,\\xi_2)$ 的期望值：\n$$\n\\mathbb{E}[u] \\approx \\sum_{i=1}^n \\sum_{j=1}^n \\left(\\frac{w_{1,i}}{2}\\right)\\left(\\frac{w_{2,j}}{2}\\right) u\\!\\big(\\xi_{1,i},\\xi_{2,j}\\big),\n$$\n对 $\\mathbb{E}[u^2]$ 也类似，以获得方差 $\\mathrm{Var}[u] = \\mathbb{E}[u^2] - (\\mathbb{E}[u])^2$。关注量为 $u(\\xi_1,\\xi_2) = |Z_{\\mathrm{in}}(\\xi_1,\\xi_2)|$，单位为欧姆。基准QMC估计必须使用一个在二维物理参数矩形区域上的Sobol序列，通过相同的仿射映射进行变换，并使用 $N$ 个样本。\n\n从第一性原理构建输入阻抗 $Z_{\\mathrm{in}}(\\boldsymbol{\\xi})$：\n- 使用 $\\mathbf{D} = \\varepsilon \\mathbf{E}$ 和平行板近似来论证间隙电容满足 $C_{\\mathrm{gap}}(\\varepsilon_r,g) \\propto \\varepsilon_0\\,\\varepsilon_r\\,A/g$ 形式的正比关系。\n- 将辐射电阻和间隙电容并联，然后与馈电电感串联，以获得端口的 $Z_{\\mathrm{in}}(\\boldsymbol{\\xi})$。\n- 使用 $u(\\xi_1,\\xi_2) = |Z_{\\mathrm{in}}(\\xi_1,\\xi_2)|$ 作为标量可观测量。\n\n测试套件。评估四种情况，以检验典型情况和近奇异行为：\n- 案例 $1$ (正常情况)：$g \\in [10^{-4},5\\times 10^{-4}]$ 米，$\\varepsilon_r \\in [2,4]$ (无量纲)，配置阶数 $n=5$，QMC样本数 $N=32768$。\n- 案例 $2$ (近奇异，小间隙)：$g \\in [10^{-6},10^{-4}]$ 米，$\\varepsilon_r \\in [2,4]$ (无量纲)，配置阶数 $n=5$，QMC样本数 $N=32768$。\n- 案例 $3$ (高阶近奇异)：$g \\in [10^{-6},10^{-4}]$ 米，$\\varepsilon_r \\in [2,4]$ (无量纲)，配置阶数 $n=9$，QMC样本数 $N=32768$。\n- 案例 $4$ (窄变异性)：$g \\in [5\\times 10^{-5},6\\times 10^{-5}]$ 米，$\\varepsilon_r \\in [2.4,2.6]$ (无量纲)，配置阶数 $n=3$，QMC样本数 $N=32768$。\n\n对每种情况，使用随机配置法计算：\n- $\\mathbb{E}[|Z_{\\mathrm{in}}|]$ 的配置估计值，单位为欧姆。\n- $\\mathrm{Var}(|Z_{\\mathrm{in}}|)$ 的配置估计值，单位为平方欧姆。\n\n同时使用QMC计算：\n- $\\mathbb{E}[|Z_{\\mathrm{in}}|]$ 和 $\\mathrm{Var}(|Z_{\\mathrm{in}}|)$ 的基准估计值，单位相同。\n\n量化绝对误差：\n- $e_{\\mu} = \\big|\\mathbb{E}_{\\mathrm{coll}}[|Z_{\\mathrm{in}}|] - \\mathbb{E}_{\\mathrm{QMC}}[|Z_{\\mathrm{in}}|]\\big|$，单位为欧姆。\n- $e_{\\sigma^2} = \\big|\\mathrm{Var}_{\\mathrm{coll}}(|Z_{\\mathrm{in}}|) - \\mathrm{Var}_{\\mathrm{QMC}}(|Z_{\\mathrm{in}}|)\\big|$，单位为平方欧姆。\n\n您的程序应生成单行输出，按顺序包含四种情况的配置均值、配置方差、绝对均值误差和绝对方差误差，形式为用方括号括起来的逗号分隔列表（例如，$[$m_1,v_1,e_{\\mu,1},e_{\\sigma^2,1},m_2,v_2,e_{\\mu,2},e_{\\sigma^2,2},m_3,v_3,e_{\\mu,3},e_{\\sigma^2,3},m_4,v_4,e_{\\mu,4},e_{\\sigma^2,4}$$]$）。所有值必须以欧姆或平方欧姆为单位表示（视情况而定），并由编程语言运行时的默认浮点表示进行四舍五入。",
            "solution": "我们从宏观Maxwell方程组 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$、$\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\partial \\mathbf{D}/\\partial t$ 和本构关系 $\\mathbf{D} = \\varepsilon \\mathbf{E}$、$\\mathbf{B} = \\mu \\mathbf{H}$ 开始。在馈电间隙的准静态体系中，位移电流在小间距 $g$ 内主导辐射，且能量主要以电能形式存储在间隙中。当介电常数为 $\\varepsilon = \\varepsilon_0 \\varepsilon_r$ 且间隙面积为 $A$ 时，通过将几何形状近似为平行板电容器，可得到电容关系\n$$\nC_{\\mathrm{gap}}(\\varepsilon_r,g) \\approx \\frac{\\varepsilon_0\\,\\varepsilon_r\\,A}{g},\n$$\n此关系由 $Q = \\int_S \\mathbf{D}\\cdot\\mathrm{d}\\mathbf{S} = \\varepsilon \\int_S \\mathbf{E}\\cdot\\mathrm{d}\\mathbf{S}$ 和穿过间隙的电压 $V = \\int \\mathbf{E}\\cdot \\mathrm{d}\\mathbf{\\ell}$ 推导而来，其中场被认为是近似均匀的。此关系符合当 $g\\to 0$ 时 $C_{\\mathrm{gap}}\\to \\infty$ 的极限，反映了导纳 $Y_C = j\\omega C_{\\mathrm{gap}}$ 中的电容奇异性。\n\n整个端口可以由一个集总网络表示，其串联部分为馈电电感 $L_s$（考虑了馈线附近的磁能存储），其并联部分为辐射电阻 $R_{\\mathrm{rad}}$与间隙电容 $C_{\\mathrm{gap}}(\\varepsilon_r,g)$ 并联。这种简化源于将电报员模型局部应用于馈电区域，并将辐射损耗（电阻性）与电抗性储能（电容性和电感性）分离开来，这与线性时谐行为 $e^{j\\omega t}$ 一致。并联支路的导纳为\n$$\nY_{\\mathrm{shunt}}(\\varepsilon_r,g) = \\frac{1}{R_{\\mathrm{rad}}} + j\\omega C_{\\mathrm{gap}}(\\varepsilon_r,g),\n$$\n其阻抗为 $Z_{\\mathrm{shunt}} = 1/Y_{\\mathrm{shunt}}$。从端口看进去的输入阻抗则是串联和：\n$$\nZ_{\\mathrm{in}}(\\varepsilon_r,g) = Z_{\\mathrm{shunt}}(\\varepsilon_r,g) + j\\omega L_s.\n$$\n关注的可观测量是其模：\n$$\nu(\\varepsilon_r,g) = \\left|Z_{\\mathrm{in}}(\\varepsilon_r,g)\\right|.\n$$\n\n不确定性源于随机的馈电间隙 $g(\\xi_1)$ 和电介质 $\\varepsilon_r(\\xi_2)$，其中 $\\xi_1,\\xi_2 \\sim \\mathrm{Uniform}([-1,1])$ 且相互独立。仿射映射 $x(\\xi) = \\frac{a+b}{2} + \\frac{b-a}{2}\\,\\xi$ 将标准化变量转换到 $[a,b]$ 上的物理参数。对于每个测试案例，$g$ 和 $\\varepsilon_r$ 的范围在参数空间中定义了矩形区域，其联合密度分解为均匀密度的乘积。\n\n对于独立均匀变量，随机配置法采用 $[-1,1]$ 上的张量积Gauss–Legendre点。对于一个阶数为 $n$ 的一维法则，其节点为 $\\{\\xi_i\\}_{i=1}^n$，权重为 $\\{w_i\\}_{i=1}^n$，我们通过 $\\int_{-1}^1 f(\\xi)\\,\\mathrm{d}\\xi \\approx \\sum_i w_i f(\\xi_i)$ 来近似积分。关于 $[-1,1]$ 上均匀分布的期望是 $\\mathbb{E}[f] = \\frac{1}{2}\\int_{-1}^1 f(\\xi)\\,\\mathrm{d}\\xi$，从而得到权重 $w_i/2$。在二维情况下，张量积期望变为\n$$\n\\mathbb{E}[u] \\approx \\sum_{i=1}^n \\sum_{j=1}^n \\left(\\frac{w_{1,i}}{2}\\right)\\left(\\frac{w_{2,j}}{2}\\right) u\\!\\big(\\xi_{1,i},\\xi_{2,j}\\big),\n$$\n其中 $u(\\xi_{1,i},\\xi_{2,j}) = |Z_{\\mathrm{in}}(\\varepsilon_r(\\xi_{2,j}),g(\\xi_{1,i}))|$。对于方差，我们使用 $\\mathrm{Var}(u) = \\mathbb{E}[u^2] - (\\mathbb{E}[u])^2$ 并将相同的法则应用于 $u^2$。\n\n为探究非光滑性，注意到当 $g \\to 0$ 时，$C_{\\mathrm{gap}} \\to \\infty$ 且 $Y_{\\mathrm{shunt}} \\to \\infty$，因此 $Z_{\\mathrm{shunt}} \\to 0$。于是，$Z_{\\mathrm{in}} \\to j\\omega L_s$，这是一个有限的极限。然而，梯度 $\\partial Z_{\\mathrm{in}}/\\partial g$ 的模会变得很大，因为 $\\partial C_{\\mathrm{gap}}/\\partial g \\sim -\\varepsilon_0 \\varepsilon_r A/g^2$，这引入了作为 $g$ 函数的陡峭变化和降低的光滑性。对于此类近奇异行为，与具有较大 $g$ 的更光滑的区域相比，基于多项式的配置法（或等效地，谱插值）收敛得更慢。\n\n我们为每个案例在物理矩形区域上实现一个带有Sobol序列的准蒙特卡罗（QMC）基准。给定 $[0,1]^2$ 中的 $N$ 个二维点 $\\{\\mathbf{u}_k\\}_{k=1}^N$，我们将它们仿射映射到 $g$ 和 $\\varepsilon_r$ 的矩形区域，评估 $u_k = |Z_{\\mathrm{in}}(\\varepsilon_r^{(k)},g^{(k)})|$，并计算 $\\widehat{\\mathbb{E}}[u] = \\frac{1}{N}\\sum_k u_k$ 和 $\\widehat{\\mathrm{Var}}(u) = \\frac{1}{N}\\sum_k u_k^2 - \\left(\\frac{1}{N}\\sum_k u_k\\right)^2$。\n\n对于四个测试案例，我们执行以下操作：\n- 案例 $1$：$g$ 的值适中且远离 $0$，预期对于 $n=5$，配置法结果与QMC吻合良好（即 $e_{\\mu}$ 和 $e_{\\sigma^2}$ 很小）。\n- 案例 $2$：近奇异的 $g$ 范围，使用 $n=5$，预期由于被积函数相对于 $\\xi_1$ 的光滑性降低，误差会更大。\n- 案例 $3$：相同的近奇异范围，但使用更高阶 $n=9$，预期与案例2相比误差减小，这说明对陡峭变化的解析度有所提高。\n- 案例 $4$：$g$ 和 $\\varepsilon_r$ 的范围都很窄，预期即使使用 $n=3$，变异性也很小，绝对误差也很小。\n\n算法步骤：\n- 计算 $\\omega = 2\\pi f$，并使用指定的 $\\varepsilon_0$、$A$、$R_{\\mathrm{rad}}$ 和 $L_s$。\n- 对每个案例，获取每个维度上在 $[-1,1]$ 上的 $n$ 个Gauss–Legendre节点和权重，通过仿射变换映射到 $g$ 和 $\\varepsilon_r$，并累加\n$$\n\\mu_{\\mathrm{coll}} \\approx \\sum_{i,j} \\frac{w_{1,i} w_{2,j}}{4}\\, u\\!\\big(\\xi_{1,i},\\xi_{2,j}\\big), \\quad\nm_{2,\\mathrm{coll}} \\approx \\sum_{i,j} \\frac{w_{1,i} w_{2,j}}{4}\\, u\\!\\big(\\xi_{1,i},\\xi_{2,j}\\big)^2,\n$$\n然后计算 $\\sigma^2_{\\mathrm{coll}} = m_{2,\\mathrm{coll}} - \\mu_{\\mathrm{coll}}^2$。\n- 生成 $N$ 个Sobol点 $\\mathbf{u}_k \\in [0,1]^2$，映射到物理矩形区域，评估 $u_k$，并计算 $\\mu_{\\mathrm{QMC}}$ 和 $\\sigma^2_{\\mathrm{QMC}}$。\n- 以浮点数形式报告 $\\mu_{\\mathrm{coll}}$、$\\sigma^2_{\\mathrm{coll}}$、$e_{\\mu} = |\\mu_{\\mathrm{coll}} - \\mu_{\\mathrm{QMC}}|$ 和 $e_{\\sigma^2} = |\\sigma^2_{\\mathrm{coll}} - \\sigma^2_{\\mathrm{QMC}}|$。\n\n所有量 $\\mu_{\\mathrm{coll}}$ 和 $\\mu_{\\mathrm{QMC}}$ 的单位是欧姆，而 $\\sigma^2_{\\mathrm{coll}}$ 和 $\\sigma^2_{\\mathrm{QMC}}$ 的单位是平方欧姆。最终打印的输出是一行，包含一个用方括号括起来的逗号分隔列表，其中按问题陈述中指定的顺序包含 $16$ 个数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.legendre import leggauss\nfrom scipy.stats import qmc\n\n# Physical constants and model parameters\nf = 3.0e9  # Hz\nomega = 2.0 * np.pi * f  # rad/s\neps0 = 8.854187817e-12  # F/m\nA = 1.0e-4  # m^2\nR_rad = 50.0  # ohms\nL_s = 1.0e-9  # H\n\ndef map_affine(xi, a, b):\n    \"\"\"Affine map from standardized xi in [-1,1] to physical [a,b].\"\"\"\n    return 0.5 * (a + b) + 0.5 * (b - a) * xi\n\ndef gap_capacitance(eps_r, g):\n    \"\"\"Parallel-plate approximation for gap capacitance.\"\"\"\n    return eps0 * eps_r * A / g\n\ndef Z_in(eps_r, g):\n    \"\"\"Compute input impedance for given eps_r and g using the reduced network.\"\"\"\n    Cgap = gap_capacitance(eps_r, g)\n    Y_shunt = (1.0 / R_rad) + 1j * omega * Cgap\n    Z_shunt = 1.0 / Y_shunt\n    Z = Z_shunt + 1j * omega * L_s\n    return Z\n\ndef collocation_stats(g_range, eps_range, order):\n    \"\"\"Compute collocation-based mean and variance of |Z_in| using tensor-product Gauss-Legendre.\"\"\"\n    # 1D Gauss-Legendre nodes and weights on [-1,1]\n    xi1, w1 = leggauss(order)\n    xi2, w2 = leggauss(order)\n    # Tensor-product evaluation\n    mean = 0.0\n    m2 = 0.0\n    for i in range(order):\n        gi = map_affine(xi1[i], g_range[0], g_range[1])\n        for j in range(order):\n            epsj = map_affine(xi2[j], eps_range[0], eps_range[1])\n            val = np.abs(Z_in(epsj, gi))\n            weight = (w1[i] * w2[j]) / 4.0  # product of uniform expectation weights\n            mean += weight * val\n            m2 += weight * (val * val)\n    var = m2 - mean * mean\n    return mean, var\n\ndef qmc_stats(g_range, eps_range, n_samples):\n    \"\"\"Compute QMC Sobol-based mean and variance of |Z_in|.\"\"\"\n    sobol = qmc.Sobol(d=2, scramble=False)\n    # Generate points in [0,1)^2\n    pts = sobol.random(n=n_samples)\n    # Map to physical ranges\n    g = g_range[0] + (g_range[1] - g_range[0]) * pts[:, 0]\n    epsr = eps_range[0] + (eps_range[1] - eps_range[0]) * pts[:, 1]\n    vals = np.abs(Z_in(epsr, g))\n    mean = float(np.mean(vals))\n    var = float(np.var(vals, ddof=0))\n    return mean, var\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (g_min, g_max, eps_min, eps_max, collocation_order, qmc_samples)\n    test_cases = [\n        (1.0e-4, 5.0e-4, 2.0, 4.0, 5, 32768),          # Case 1: happy path\n        (1.0e-6, 1.0e-4, 2.0, 4.0, 5, 32768),          # Case 2: near-singular, small gap\n        (1.0e-6, 1.0e-4, 2.0, 4.0, 9, 32768),          # Case 3: higher order near-singular\n        (5.0e-5, 6.0e-5, 2.4, 2.6, 3, 32768),          # Case 4: narrow variability\n    ]\n\n    results = []\n    for case in test_cases:\n        gmin, gmax, epsmin, epsmax, order, n_qmc = case\n        g_range = (gmin, gmax)\n        eps_range = (epsmin, epsmax)\n        # Collocation estimates\n        m_coll, v_coll = collocation_stats(g_range, eps_range, order)\n        # QMC baseline\n        m_qmc, v_qmc = qmc_stats(g_range, eps_range, n_qmc)\n        # Errors\n        e_mean = abs(m_coll - m_qmc)\n        e_var = abs(v_coll - v_qmc)\n        # Append results in the required order\n        results.extend([m_coll, v_coll, e_mean, e_var])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}