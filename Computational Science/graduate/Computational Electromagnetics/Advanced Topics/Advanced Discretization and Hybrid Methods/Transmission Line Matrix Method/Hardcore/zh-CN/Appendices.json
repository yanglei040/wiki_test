{
    "hands_on_practices": [
        {
            "introduction": "传输线矩阵（TLM）方法的核心在于节点上的“散射-连接”过程。本练习将从电压连续性和电流守恒等第一性原理出发，推导一个简单的一维并联节点上的基本散射机制。通过掌握这一推导，您将为理解TLM方法如何局部地模拟电磁波与材料的相互作用打下坚实的基础。",
            "id": "11289",
            "problem": "在传输线矩阵（TLM）数值方法中，电磁波的传播被建模为在传输线网格上传播的电压和电流脉冲。仿真的核心是一个“散射-连接”过程。在每个离散时间步，入射到结（节点）的脉冲被散射，然后产生的散射脉冲传播到相邻的节点。\n\n考虑一个 TLM 模型中的基本一维并联节点。该节点连接两条半无限长传输线，分别称为端口1和端口2，每条线的特性阻抗均为 $Z_0$。在连接点处，一个具有通用导纳 $Y_s$ 的并联元件连接在传输线和地之间。这个并联导纳模拟了局部的材料属性。\n\n节点处的动态特性由两个原则支配：\n1.  **电压连续性：** 节点上的总电压 $V_n$ 从任一端口看都是相同的。端口上的总电压是其入射脉冲和散射脉冲之和。例如，在端口1，有 $V_n = V_1^i + V_1^s$。\n2.  **电流守恒：** 流入节点的电流之和必须等于通过并联元件流出的电流（基尔霍夫电流定律）。传输线上的电流由入射和散射电压脉冲之差除以特性阻抗得出。例如，在端口1，流入节点的电流是 $I_1 = (V_1^i - V_1^s) / Z_0$。流经并联元件的电流是 $I_s = V_n Y_s$。\n\n一个幅值为 $V_{inc}$ 的电压脉冲从端口1发出并入射到该节点上。没有脉冲从端口2入射。推导一个表达式，表示散射回端口1的脉冲的幅值，记为 $V_{refl}$。你的结果应该用 $V_{inc}$、$Z_0$ 和 $Y_s$ 来表示。",
            "solution": "1. 相关方程：\n电压连续性：\n$$V_n = V_1^i + V_1^s = V_2^i + V_2^s.$$  \n线路电流：\n$$I_1 = \\frac{V_1^i - V_1^s}{Z_0},\\quad I_2 = \\frac{V_2^i - V_2^s}{Z_0},\\quad I_s = V_n Y_s.$$  \n基尔霍夫定律：\n$$I_1 + I_2 = I_s.$$\n\n2. 应用边界条件和连续性：\n由于 $V_2^i=0$，我们有 $V_n=V_2^s$。同时 $V_n=V_1^i+V_1^s$。\n\n3. 代入电流守恒方程：\n$$\\frac{V_1^i - V_1^s}{Z_0} - \\frac{V_2^s}{Z_0} = V_n Y_s$$  \n$$\\frac{V_1^i - V_1^s - V_n}{Z_0} = V_n Y_s$$  \n使用 $V_n=V_1^i+V_1^s$：\n$$\\frac{V_1^i - V_1^s - V_1^i - V_1^s}{Z_0} = (V_1^i+V_1^s)Y_s$$  \n$$-\\frac{2V_1^s}{Z_0} = (V_1^i+V_1^s)Y_s$$  \n\n4. 求解 $V_1^s$：\n乘以 $Z_0$：\n$$-2V_1^s = Z_0Y_s(V_1^i + V_1^s)$$  \n$$-2V_1^s = Z_0Y_s V_1^i + Z_0Y_s V_1^s$$  \n$$-(2 + Z_0Y_s)V_1^s = Z_0Y_s V_1^i$$  \n$$V_1^s = -\\frac{Z_0Y_s}{2 + Z_0Y_s}\\,V_1^i.$$  \n\n由于入射脉冲 $V_{inc}=V_1^i$，反射脉冲的幅值为\n$$V_{refl} = -\\frac{Z_0 Y_s}{2 + Z_0 Y_s}\\,V_{inc}.$$",
            "answer": "$$\\boxed{-\\frac{Z_0 Y_s}{2 + Z_0 Y_s}\\,V_{inc}}$$"
        },
        {
            "introduction": "除了模拟简单的波传播，TLM方法也是分析复杂几何特征附近场行为的强大工具。本练习将演示如何利用TLM的局部角向更新算子，对理想导体楔尖处的场奇异性进行数值分析。通过对离散算子进行特征分析，您将学习如何直接从数值格式中提取奇异性指数等物理量，从而架起离散计算与连续物理理论之间的桥梁。",
            "id": "3357537",
            "problem": "考虑一个二维横磁场结构，其电场沿轴向极化，模型建立在一个内角为 $\\alpha$（单位为弧度）的理想电导体楔形附近。该楔体占据 $\\theta=0$ 和 $\\theta=\\alpha$ 的位置，感兴趣的区域是角扇区 $\\theta \\in (0,\\alpha)$ 和径向坐标 $r>0$。目标是分析切向电场分量 $E_{\\phi}(r,\\theta)$ 的角点奇异性，并验证近场行为 $E_{\\phi}(r,\\theta)\\propto r^{\\lambda-1}$，其中 $\\lambda$ 取决于 $\\alpha$。该分析必须使用传输线矩阵（TLM）方法（Transmission Line Matrix (TLM)）在角点附近构建局部角度更新算子，然后通过该算子的数值特征分析提取奇异指数 $\\lambda(\\alpha)$。\n\n从第一性原理出发，利用频域中的麦克斯韦方程组、理想电导体边界条件的定义以及在极坐标系下的变量分离法，论证在固定半径 $r$ 的小环形区域上，场的角度依赖性在稳态下由一个关于 $\\theta$ 的自伴二阶微分算子决定，且该算子在 $\\theta=0$ 和 $\\theta=\\alpha$ 处满足齐次狄利克雷边界条件。解释在传输线矩阵框架下，如何通过使用对称浓缩节点并强制能量守恒和互易性，使得局部角度更新算子简化为在均匀网格上对角度二阶导数的标准二阶差分离散化。该网格包含 $M$ 个内部角度节点，用以解析 $\\theta \\in (0,\\alpha)$，并在楔形面上施加狄利克雷边界条件。\n\n令 $\\Delta \\theta = \\alpha/(M+1)$ 表示均匀的角度步长，并令 $\\mathbf{L}\\in\\mathbb{R}^{M\\times M}$ 为表示离散角度算子的三对角矩阵\n$$\n\\mathbf{L} = \\frac{1}{\\Delta\\theta^2}\\begin{bmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\ddots  \\vdots \\\\\n0  -1  2  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{bmatrix}.\n$$\n证明 $\\mathbf{L}$ 的特征值问题产生离散的角度特征值 $\\mu_k$ 和特征向量，这些特征值和特征向量近似于满足楔形边界条件的连续角度特征函数。并证明对应于最奇异模式的奇异指数 $\\lambda$ 由 $\\lambda = \\sqrt{\\mu_{\\min}}$ 给出，其中 $\\mu_{\\min}$ 是 $\\mathbf{L}$ 的最小正特征值。论证连续参考指数 $\\lambda_{\\text{cont}}(\\alpha)$ 是通过对分离变量解的角度部分施加齐次狄利克雷边界条件而产生的，并且通过强制角度函数在 $\\theta=0$ 和 $\\theta=\\alpha$ 处为零来获得，即它是角度函数标量边界条件方程的最小严格正解。\n\n你的任务是实现一个完整的程序，该程序：\n- 为给定的 $\\alpha$ 和 $M$ 构建 $\\mathbf{L}$。\n- 计算最小正特征值 $\\mu_{\\min}$ 并设置 $\\lambda_{\\text{num}} = \\sqrt{\\mu_{\\min}}$。\n- 通过求解齐次狄利克雷角度边界条件得到最小严格正 $\\lambda$，从而计算连续参考值 $\\lambda_{\\text{cont}}(\\alpha)$。\n- 对于每个测试用例，返回相对误差 $|\\lambda_{\\text{num}}-\\lambda_{\\text{cont}}|/\\lambda_{\\text{cont}}$，结果为浮点数。\n\n角度必须以弧度处理。除了角度单位外，不需要其他物理单位。程序必须输出单行结果，该行包含一个由方括号括起来的逗号分隔列表，其中按顺序包含所有测试用例的相对误差。\n\n使用以下 $(\\alpha,M)$ 对的测试套件：\n- $(\\alpha, M) = \\left(\\frac{\\pi}{2}, 128\\right)$ 作为一般情况。\n- $(\\alpha, M) = \\left(\\frac{\\pi}{3}, 128\\right)$ 作为锐角楔形情况。\n- $(\\alpha, M) = \\left(\\frac{3\\pi}{4}, 128\\right)$ 作为钝角楔形情况。\n- $(\\alpha, M) = \\left(0.95\\pi, 128\\right)$ 作为近乎平坦边界的情况。\n- $(\\alpha, M) = \\left(\\frac{\\pi}{2}, 8\\right)$ 作为粗糙离散化的边缘情况。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如，\"[r1,r2,r3,r4,r5]\"）。",
            "solution": "首先验证问题在科学上是合理的、适定的和客观的。它提出了计算电磁学中一个关于尖锐金属角点场奇异性的标准问题，并将其置于传输线矩阵（TLM）方法的框架内。所给信息完整且一致，足以推导出一个解决方案。\n\n### 理论基础与连续模型\n\n我们从第一性原理出发，推导在理想电导体（PEC）楔形尖端附近的场行为的连续参考模型。问题描述了一个二维横磁（TM）结构，其中电场沿轴向极化，我们将其视为 $\\hat{z}$ 轴。在这种 TM$_z$ 情况下，电场只有一个 $z$ 分量，$\\mathbf{E} = E_z(r, \\theta) \\hat{z}$，而磁场是横向的，$\\mathbf{H} = H_r(r, \\theta) \\hat{r} + H_\\theta(r, \\theta) \\hat{\\theta}$。问题陈述提到了切向电场分量 $E_{\\phi}(r,\\theta)$，这与 TM$_z$ 极化（其中 $E_\\phi=0$）不一致。在这种结构中，角点奇异性的分析正确地应针对轴向分量 $E_z$，该分量与楔形的理想电导体（PEC）表面相切。我们将假定分析是针对 $E_z$ 进行的，因为问题中的所有后续细节（波动方程、边界条件以及由此产生的算子）都与此解释一致。当 $E_z \\propto r^\\lambda$ 时，横向磁场分量的近场行为与 $r^{\\lambda-1}$ 成正比，这可能是这种记法不一致的来源。目标是找到指数 $\\lambda$。\n\n在频域中，无源、均匀介质（介电常数为 $\\epsilon$，磁导率为 $\\mu$）中的时谐电场 $E_z$ 满足亥姆霍兹方程：\n$$ \\nabla^2 E_z + k^2 E_z = 0 $$\n其中 $k^2 = \\omega^2 \\epsilon \\mu$ 是波数的平方。在极坐标 $(r, \\theta)$ 中，拉普拉斯算子为 $\\nabla^2 = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial \\theta^2}$。亥姆霍兹方程变为：\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial E_z}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 E_z}{\\partial \\theta^2} + k^2 E_z = 0 $$\n我们使用变量分离法寻求解答，假设 $E_z(r, \\theta) = R(r)\\Theta(\\theta)$。将此代入波动方程并重新整理各项可得：\n$$ \\frac{r}{R(r)}\\frac{d}{dr}\\left(r\\frac{dR(r)}{dr}\\right) + k^2 r^2 = -\\frac{1}{\\Theta(\\theta)}\\frac{d^2\\Theta(\\theta)}{d\\theta^2} $$\n由于左侧仅依赖于 $r$ 而右侧仅依赖于 $\\theta$，两者必须等于一个分离常数，我们记为 $\\lambda^2$。这得到两个常微分方程：\n1.  角度方程：$\\frac{d^2\\Theta}{d\\theta^2} + \\lambda^2 \\Theta = 0$\n2.  径向方程：$r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} + (k^2 r^2 - \\lambda^2)R = 0$\n\n理想电导体（PEC）楔形由表面 $\\theta=0$ 和 $\\theta=\\alpha$ 定义。PEC 的边界条件是电场的切向分量在其表面上必须为零。此处，$E_z$ 与两个表面都相切。这对解施加了齐次狄利克雷边界条件：\n$$ E_z(r, 0) = 0 \\quad \\text{and} \\quad E_z(r, \\alpha) = 0 $$\n为了使这些条件对所有 $r>0$ 成立，它们必须由角度函数 $\\Theta(\\theta)$ 满足：\n$$ \\Theta(0) = 0 \\quad \\text{and} \\quad \\Theta(\\alpha) = 0 $$\n角度方程的通解是 $\\Theta(\\theta) = A\\sin(\\lambda\\theta) + B\\cos(\\lambda\\theta)$。应用 $\\Theta(0)=0$ 得到 $B=0$。将 $\\Theta(\\alpha)=0$ 应用于剩余解 $\\Theta(\\theta) = A\\sin(\\lambda\\theta)$，要求对于非平凡解（$A \\neq 0$）有 $\\sin(\\lambda\\alpha) = 0$。当 $\\lambda\\alpha = n\\pi$（其中 $n$ 为任意整数）时，此条件满足。为确保扇区内角度依赖性的有效性，我们要求 $n \\geq 1$。因此，角度问题的特征值为 $\\lambda_n = n\\pi/\\alpha$，其中 $n=1,2,3,\\dots$。\n\n在角点尖端附近（$r \\to 0$），径向方程（即 Bessel 方程）中的 $k^2r^2$ 项与 $\\lambda^2$ 项相比变得可以忽略。方程简化为 Euler-Cauchy 形式：\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} - \\lambda^2 R = 0 $$\n假设解的形式为 $R(r) = r^p$，我们得到 $p(p-1) + p - \\lambda^2 = 0$，简化为 $p^2 = \\lambda^2$，因此 $p=\\pm\\lambda$。通解为 $R(r) = C_1 r^\\lambda + C_2 r^{-\\lambda}$。为了使场具有物理意义（即在原点周围任何小区域内能量有限），我们必须舍弃奇异项 $r^{-\\lambda}$ 并选择 $p=\\lambda$。因此，场表现为 $E_z \\propto r^\\lambda$。当 $r \\to 0$ 时占主导地位的最奇异（即最不平滑）行为对应于 $\\lambda$ 的最小正值，这发生在 $n=1$ 时。这给出了精确的连续奇异性指数：\n$$ \\lambda_{\\text{cont}} = \\frac{\\pi}{\\alpha} $$\n\n### 离散化与基于TLM的数值模型\n\n问题断言，在传输线矩阵（TLM）框架内，使用对称浓缩节点，局部角度更新算子可简化为对角度二阶导数的有限差分离散化。这种联系在 TLM 分析中是标准的，在低频极限下，网络方程等效于波动方程的有限差分格式。在这里，我们分析角度算子 $\\mathcal{L}_\\theta = -d^2/d\\theta^2$ 的离散对应物，它控制着场的稳态角度变化。\n\n我们将角度域 $\\theta \\in [0, \\alpha]$ 离散化为 $M+1$ 个相等的段，创建 $M$ 个内部节点。角度步长为 $\\Delta\\theta = \\alpha/(M+1)$。设 $\\Theta_i$ 是节点 $\\theta_i = i\\Delta\\theta$ 处（其中 $i=0, 1, \\dots, M+1$）的角度函数值。边界条件为 $\\Theta_0 = 0$ 和 $\\Theta_{M+1} = 0$。\n\n连续特征值问题 $-\\frac{d^2\\Theta}{d\\theta^2} = \\mu \\Theta$（其中 $\\mu=\\lambda^2$）在每个内部节点 $i$ 处使用二阶导数的二阶中心差分公式进行近似：\n$$ -\\frac{\\Theta_{i+1} - 2\\Theta_i + \\Theta_{i-1}}{(\\Delta\\theta)^2} = \\mu \\Theta_i $$\n这可以重写为：\n$$ -\\Theta_{i-1} + 2\\Theta_i - \\Theta_{i+1} = \\mu (\\Delta\\theta)^2 \\Theta_i $$\n对每个内部节点 $i=1, \\dots, M$ 写出此方程，并结合边界条件（当 $i=1$ 时 $\\Theta_0=0$，当 $i=M$ 时 $\\Theta_{M+1}=0$），得到一个矩阵特征值问题 $\\mathbf{L}\\vec{\\Theta} = \\mu\\vec{\\Theta}$。此处，$\\vec{\\Theta} = [\\Theta_1, \\dots, \\Theta_M]^T$ 是内部节点处场值的向量，而 $\\mathbf{L}$ 是 $M \\times M$ 矩阵：\n$$\n\\mathbf{L} = \\frac{1}{\\Delta\\theta^2}\\begin{bmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\ddots  \\vdots \\\\\n0  -1  2  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{bmatrix}\n$$\n这正是问题中给出的离散角度算子。该矩阵的特征值 $\\mu_k$ 是对连续特征值 $\\lambda^2 = (n\\pi/\\alpha)^2$ 的数值近似。$\\mathbf{L}$ 的最小特征值，记为 $\\mu_{\\min}$，将近似于最小的连续特征值 $\\lambda_{\\text{cont}}^2 = (\\pi/\\alpha)^2$。因此，数值奇异性指数通过以下方式找到：\n$$ \\lambda_{\\text{num}} = \\sqrt{\\mu_{\\min}} $$\n\n### 实现策略\n\n程序将为每个测试用例 $(\\alpha, M)$ 实现数值解。\n1.  给定 $\\alpha$ 和 $M$，计算角度步长 $\\Delta\\theta = \\alpha / (M+1)$。\n2.  通过将主对角线元素设置为 $2/\\Delta\\theta^2$ 和第一副对角线元素设置为 $-1/\\Delta\\theta^2$ 来构造 $M \\times M$ 的三对角矩阵 $\\mathbf{L}$。\n3.  计算实对称矩阵 $\\mathbf{L}$ 的特征值。最小的特征值 $\\mu_{\\min}$ 即为所需的值。\n4.  计算数值指数 $\\lambda_{\\text{num}} = \\sqrt{\\mu_{\\min}}$。\n5.  计算精确的连续指数 $\\lambda_{\\text{cont}} = \\pi/\\alpha$。\n6.  计算相对误差 $|\\lambda_{\\text{num}} - \\lambda_{\\text{cont}}| / \\lambda_{\\text{cont}}$。\n收集所有测试用例的结果，并以指定格式打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative error between the numerical and continuous singularity\n    exponents for a PEC wedge.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (np.pi / 2, 128),    # General case\n        (np.pi / 3, 128),    # Acute wedge\n        (3 * np.pi / 4, 128),# Obtuse wedge\n        (0.95 * np.pi, 128), # Near-flat boundary\n        (np.pi / 2, 8),      # Coarse discretization\n    ]\n\n    results = []\n    for alpha, M in test_cases:\n        # Step 1: Calculate parameters\n        # M is the number of interior angular nodes.\n        # The total number of angular steps is M+1.\n        delta_theta = alpha / (M + 1)\n\n        # Step 2: Construct the discrete angular operator matrix L.\n        # L is a symmetric tridiagonal matrix representing the second-difference\n        # operator, scaled by 1/delta_theta^2.\n        \n        # Create the unscaled matrix with 2s on the main diagonal and -1s on\n        # the first off-diagonals.\n        main_diag = np.full(M, 2, dtype=float)\n        off_diag = np.full(M - 1, -1, dtype=float)\n        \n        # Assemble the unscaled matrix using numpy.diag.\n        L_unscaled = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        \n        # Scale the matrix by 1/(delta_theta^2).\n        L = L_unscaled / (delta_theta**2)\n\n        # Step 3: Compute the eigenvalues of L.\n        # numpy.linalg.eigvalsh is used for real symmetric matrices. It is\n        # computationally efficient and returns eigenvalues in ascending order.\n        eigenvalues = np.linalg.eigvalsh(L)\n\n        # The smallest positive eigenvalue is the first element of the sorted array.\n        mu_min = eigenvalues[0]\n\n        # Step 4: Compute the numerical singularity exponent lambda_num.\n        # This is derived from the relation lambda = sqrt(mu).\n        lambda_num = np.sqrt(mu_min)\n\n        # Step 5: Compute the continuous reference exponent lambda_cont.\n        # This is the exact analytical solution for the lowest-order mode.\n        lambda_cont = np.pi / alpha\n\n        # Step 6: Calculate the relative error.\n        relative_error = np.abs(lambda_num - lambda_cont) / lambda_cont\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在计算电磁学中，精确模拟开放区域问题是一项关键挑战，这需要有效的吸收边界条件（Absorbing Boundary Conditions, ABCs）。本练习旨在TLM框架下对不同的吸收边界条件（如Mur、Liao和PML）进行对比分析，重点关注它们在具有挑战性的大掠射角下的性能。通过结合理论分析与编程实践，您将研究数值色散如何导致边界上的模式失配，量化评估反射误差，并理解这些关键技术之间的优劣与权衡。",
            "id": "3357495",
            "problem": "考虑一个二维传输线矩阵 (TLM) 离散模型，用于模拟电磁波在均匀无损介质中的传播。该介质的特征在于真空介电常数 $\\varepsilon_0$ 和真空磁导率 $\\mu_0$，因此光速为 $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$。假设一个方形 TLM 网格，其空间步长 $\\Delta x = \\Delta y$，时间步长为 $\\Delta t$，且满足稳定性界限。令 $S = c \\Delta t / \\Delta x$ 表示方形网格上的库朗数。对于角频率为 $\\omega$、波数分量为 $(k_x, k_y)$ 的离散平面波，方形网格上的 TLM 离散色散关系可采用以下经过充分检验的关系式\n$$\n\\cos(\\omega \\Delta t) = 1 - 2 S^2 \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) \\right].\n$$\n一个连续角频率为 $\\omega$ 的单色平面波以入射角 $\\theta$（从边界法线测量）入射到计算边界上，因此连续波数大小为 $k = \\omega/c$，连续切向分量为 $k_y = k \\sin\\theta$。在离散网格中，波必须满足上述离散色散关系；假设 $k_y$ 由入射几何结构决定，而离散的 $k_x$ 由该 $\\omega$ 和 $k_y$ 下的色散关系确定。\n\n在边界上，应用以下三种吸收边界构造之一：\n\n1. Mur 一阶吸收边界条件 (Mur ABC)：建模为法向相速度等于 $c$ 的单向波算子，即作用于边界上总场 $u$ 的形式为 $\\left( \\partial/\\partial t + c \\, \\partial/\\partial n \\right) u = 0$ 的边界算子。\n\n2. Liao 高阶吸收边界条件 (Liao ABC)：建模为精确单向波算子的截断级数近似，该算子通过连续亥姆霍兹关系中的平方根算子来考虑斜入射。当作用于角度为 $\\theta$ 的平面波时，它产生一个有效法向相速度 $v_b$，近似于 $c \\cos\\theta$。在变量 $u = \\sin^2\\theta$ 中使用二阶截断，\n$$\nv_b(\\theta) \\approx c \\left( 1 - \\frac{u}{2} - \\frac{u^2}{8} \\right), \\quad u = \\sin^2\\theta,\n$$\n作为 Liao ABC 在边界处模式匹配的模型。\n\n3. 完美匹配层 (PML)：建模为一个厚度为 $d$、具有线性渐变电导率分布 $\\sigma(x) = \\sigma_{\\max} \\, x/d$（其中 $0 \\le x \\le d$）的有限厚度、理想匹配的有损层。在理想匹配的连续统极限下，法向入射的振幅反射近似为 $R \\approx \\exp(-2 \\alpha)$，其中 $\\alpha = \\sigma_{\\max} d /(4 Z_0)$，$Z_0 = \\sqrt{\\mu_0/\\varepsilon_0}$ 是自由空间阻抗。设计 $\\sigma_{\\max}$ 以实现目标法向入射反射 $R_0$；假设在这个简化的量化中，这个理想的反射大小适用于所有角度和频率（即，在计算此问题中的 $R(\\theta,f)$ 时，忽略离散化引起的 PML 误差）。\n\n对于网格内的 TLM 离散平面波，通过将边界算子施加于前向和后向法向传播分量的叠加之上，来对边界处的反射系数进行建模。在平面波拟设下，这简化为在边界上匹配作用于 $e^{-j(\\omega t - k_x x - k_y y)}$ 和 $e^{-j(\\omega t + k_x x - k_y y)}$ 的算子。这导出了通用形式的反射系数大小\n$$\nR(\\theta, f) = \\left| \\frac{\\omega - v_b(\\theta) \\, k_x^{\\mathrm{(d)}}(\\omega, k_y)}{\\omega + v_b(\\theta) \\, k_x^{\\mathrm{(d)}}(\\omega, k_y)} \\right|,\n$$\n其中 $v_b(\\theta)$ 取决于吸收边界的构造，而 $k_x^{\\mathrm{(d)}}(\\omega, k_y)$ 从 TLM 离散色散关系中获得。对于 Mur ABC，取 $v_b(\\theta) = c$。对于 Liao ABC，取 $v_b(\\theta)$ 为上面给出的形式。对于 PML，根据理想化建模假设，取 $R(\\theta,f) = R_0$，与 $\\theta$ 和 $f$ 无关。\n\n如果离散色散关系没有得出实数 $k_x^{\\mathrm{(d)}}$（即，计算出的 $s_x^2$ 为负或超过 1），则将该模式视为在边界法线方向上非传播，并为 Mur 和 Liao ABCs 指定 $R(\\theta, f) = 1$（在没有实数传播模式的情况下为全反射），而 PML 的 $R(\\theta,f)$ 保持为设计的 $R_0$。\n\n从麦克斯韦方程组和 TLM 离散平面波模型出发，推导上述反射系数的构造，并针对每种 ABC 解释离散边界上的模式失配如何在掠射时产生反射。特别地，展示为什么假设 $v_b(\\theta) = c$ 的 Mur ABC 在 $\\theta \\to 90^\\circ$ 时会产生大的反射，以及为什么有限阶 Liao ABC 截断在非常大的倾角下（当 $\\sin^2\\theta \\approx 1$ 时）由于对 $c \\cos\\theta$ 的近似不佳而可能表现得比 Mur 更差。解释为什么在理想匹配假设下，完美匹配层保持稳健，其反射 $R_0$ 与角度和频率无关。\n\n实现一个程序，使用上述指定的 TLM 离散色散关系和模型，为这三种 ABC 计算 $R(\\theta, f)$。使用以下物理和数值参数：\n- $c = 2.99792458 \\times 10^8$ m/s。\n- $Z_0 = 376.730313668$ $\\Omega$。\n- 空间步长 $\\Delta x = 1.0 \\times 10^{-3}$ m。\n- 库朗数 $S = 1/\\sqrt{2}$。\n- 时间步长 $\\Delta t = S \\Delta x / c$。\n- PML 厚度 $d = 8 \\Delta x$。\n- PML 的设计法向入射反射 $R_0 = 1.0 \\times 10^{-3}$，用于通过 $\\alpha = \\frac{1}{2}\\ln(1/R_0)$ 和 $\\sigma_{\\max} = 4 Z_0 \\alpha / d$ 设置 $\\sigma_{\\max}$；然后在输出中对 PML 取 $R(\\theta, f) = R_0$。\n\n你的程序必须评估以下由入射角（单位：度）和频率（单位：赫兹）组成的测试套件：\n- 情况 1：$\\theta = 80^\\circ$，$f = 3.0 \\times 10^9$ Hz。\n- 情况 2：$\\theta = 85^\\circ$，$f = 3.0 \\times 10^9$ Hz。\n- 情况 3：$\\theta = 89^\\circ$，$f = 3.0 \\times 10^9$ Hz。\n- 情况 4：$\\theta = 89.9^\\circ$，$f = 3.0 \\times 10^9$ Hz。\n- 情况 5：$\\theta = 89^\\circ$，$f = 9.0 \\times 10^9$ Hz。\n\n对于每种情况，计算并返回一个包含三个浮点数的列表 $[R_{\\mathrm{Mur}}, R_{\\mathrm{Liao}}, R_{\\mathrm{PML}}]$，其中每个浮点数是四舍五入到六位小数的反射系数大小。你的程序应生成单行输出，其中包含这些列表组成的、以逗号分隔的列表，并用方括号括起来，顺序与测试套件一致。例如，一个有效的输出格式是\n$$\n[\\,[r_{11},r_{12},r_{13}],\\,[r_{21},r_{22},r_{23}],\\,\\dots\\,]\n$$\n角度以度为单位指定，反射系数是无量纲的；将每个反射系数表示为四舍五入到六位小数的小数。",
            "solution": "该问题要求在一个二维传输线矩阵 (TLM) 网格模型中，分析和计算平面波遇到三种不同吸收边界构造时的反射系数大小 $R(\\theta, f)$：一阶 Mur 吸收边界条件 (ABC)、二阶 Liao ABC 和理想化的完美匹配层 (PML)。\n\n首先，我们推导通用的反射系数公式。设边界位于 $x=0$ 处，计算域在半空间 $x>0$ 中。一个角频率为 $\\omega$ 的时谐平面波入射到该边界上。我们使用电气工程领域的相量表示法 $e^{-j\\omega t}$。总场 $u(x,y,t)$ 是入射波和反射波的叠加。向 $+x$ 方向传播的入射波和向 $-x$ 方向传播的反射波由下式给出：\n$$\nu_i(x,y,t) = A \\, e^{-j(\\omega t - k_x^{\\mathrm{(d)}} x - k_y y)}\n$$\n$$\nu_r(x,y,t) = R A \\, e^{-j(\\omega t + k_x^{\\mathrm{(d)}} x - k_y y)}\n$$\n这里，$k_x^{\\mathrm{(d)}}$ 是垂直于边界的离散波数分量的大小，$k_y$ 是切向波数分量，$A$ 是入射波振幅，$R$ 是复反射系数。总场为 $u = u_i + u_r$。\n$$\nu(x,y,t) = A \\left( e^{j k_x^{\\mathrm{(d)}} x} + R e^{-j k_x^{\\mathrm{(d)}} x} \\right) e^{-j(\\omega t - k_y y)}\n$$\n吸收边界构造通过一种形式为 $\\left( \\frac{\\partial}{\\partial t} + v_b(\\theta) \\frac{\\partial}{\\partial n} \\right) u = 0$ 的单向波算子进行建模，其中 $\\hat{n}=\\hat{x}$ 是向外的法线方向，$v_b(\\theta)$ 是表征边界的有效相速度。将此算子应用于边界 $x=0$ 处的总场 $u$：\n$$\n\\frac{\\partial u}{\\partial t} = -j\\omega u \\quad \\implies \\quad \\left.\\frac{\\partial u}{\\partial t}\\right|_{x=0} = -j\\omega A(1+R) e^{-j(\\omega t - k_y y)}\n$$\n$$\n\\frac{\\partial u}{\\partial x} = A \\left( j k_x^{\\mathrm{(d)}} e^{j k_x^{\\mathrm{(d)}} x} - j R k_x^{\\mathrm{(d)}} e^{-j k_x^{\\mathrm{(d)}} x} \\right) e^{-j(\\omega t - k_y y)} \\quad \\implies \\quad \\left.\\frac{\\partial u}{\\partial x}\\right|_{x=0} = j k_x^{\\mathrm{(d)}} A(1-R) e^{-j(\\omega t - k_y y)}\n$$\n将这些代入边界条件 $x=0$ 中：\n$$\n-j\\omega A(1+R) + v_b(\\theta) \\left( j k_x^{\\mathrm{(d)}} A(1-R) \\right) = 0\n$$$$\n-\\omega(1+R) + v_b(\\theta) k_x^{\\mathrm{(d)}} (1-R) = 0\n$$$$\nv_b(\\theta) k_x^{\\mathrm{(d)}} - \\omega = R \\left( \\omega + v_b(\\theta) k_x^{\\mathrm{(d)}} \\right)\n$$$$\nR = \\frac{v_b(\\theta) k_x^{\\mathrm{(d)}} - \\omega}{v_b(\\theta) k_x^{\\mathrm{(d)}} + \\omega}\n$$\n因此，反射系数的大小为：\n$$\nR(\\theta, f) = |R| = \\left| \\frac{v_b(\\theta) k_x^{\\mathrm{(d)}} - \\omega}{v_b(\\theta) k_x^{\\mathrm{(d)}} + \\omega} \\right| = \\left| \\frac{\\omega - v_b(\\theta) k_x^{\\mathrm{(d)}}}{\\omega + v_b(\\theta) k_x^{\\mathrm{(d)}}} \\right|\n$$\n这与问题陈述中提供的公式相符。当边界的有效速度与波在网格上的法向相速度匹配时，即 $v_b(\\theta) = \\omega / k_x^{\\mathrm{(d)}}$，发生完美吸收（$R=0$）。任何失配都会导致反射。\n\n离散法向波数 $k_x^{\\mathrm{(d)}}$ 由 TLM 网格的色散关系确定。给定参数 $\\omega$、$\\Delta t$、$S=c\\Delta t/\\Delta x$ 和 $k_y = (\\omega/c)\\sin\\theta$，我们求解 $k_x^{\\mathrm{(d)}}$：\n$$\n\\cos(\\omega \\Delta t) = 1 - 2 S^2 \\left[ \\sin^2\\left(\\frac{k_x^{\\mathrm{(d)}} \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) \\right]\n$$\n我们记 $s_x = \\sin(k_x^{\\mathrm{(d)}} \\Delta x / 2)$ 和 $s_y = \\sin(k_y \\Delta x / 2)$。整理后得到：\n$$\ns_x^2 = \\sin^2\\left(\\frac{k_x^{\\mathrm{(d)}} \\Delta x}{2}\\right) = \\frac{1 - \\cos(\\omega \\Delta t)}{2 S^2} - \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right)\n$$\n为了在 $x$ 方向上存在实数传播模式，我们必须有 $k_x^{\\mathrm{(d)}}$ 的实数解，这要求 $0 \\le s_x^2 \\le 1$。如果 $s_x^2  0$，波数 $k_x^{\\mathrm{(d)}}$ 变为虚数，代表一个倏逝（非传播）波。在这种情况下，对于像 Mur 或 Liao 这样的无损边界模型，波被完全反射，因此 $R=1$。\n\n我们现在分析每种 ABC：\n1.  **Mur 一阶 ABC**：这种简单的 ABC 假设波是法向入射的。它用法向有效速度 $v_b(\\theta) = c$ 来模拟边界，该速度与入射角 $\\theta$ 无关。在连续介质中，平面波的法向相速度为 $c_x = c/\\cos\\theta$。因此，Mur ABC 仅在法向入射（$\\theta=0$）时提供完美匹配。当入射变得更具掠射性（$\\theta \\to 90^\\circ$）时，连续法向波数 $k_x = k \\cos\\theta$ 趋近于 0，而法向相速度 $c/\\cos\\theta$ 趋近于无穷大。从色散关系计算出的离散法向波数 $k_x^{\\mathrm{(d)}}$ 也趋近于 0。Mur ABC 试图用一个固定速度 $v_b=c$ 来匹配它。波的较大法向相速度 $\\omega/k_x^{\\mathrm{(d)}}$ 与边界的固定速度 $c$ 之间的失配变得严重。在反射公式中，当 $k_x^{\\mathrm{(d)}} \\to 0$ 时，项 $v_b k_x^{\\mathrm{(d)}}$ 与 $\\omega$ 相比变得很小，导致比值 $|R|$ 趋近于 $|\\omega/\\omega| = 1$。这解释了在掠射时的高反射。\n\n2.  **Liao 高阶 ABC**：Liao ABC 试图通过考虑斜入射来改进 Mur ABC。该问题提供了一个基于 $c \\cos\\theta$ 的二阶泰勒级数近似的有效速度模型：$v_b(\\theta) \\approx c (1 - u/2 - u^2/8)$，其中 $u = \\sin^2\\theta$。问题中这个模型的选择有些不寻常，因为理想算子应匹配法向相速度 $c/\\cos\\theta$，而不是 $c \\cos\\theta$。然而，我们遵循问题陈述，分析这个模型。这个对 $c \\cos\\theta$ 的近似在小 $\\theta$（小 $u$）时是准确的，但随着 $\\theta \\to 90^\\circ$（此时 $u \\to 1$），其精度会显著下降。在 $u=1$ 时，该模型给出 $v_b = c(1-1/2-1/8) = 0.375c$，而 $c\\cos\\theta$ 的真实值趋于 0。Mur ABC 使用 $v_b=c$。由于在大角度下 $0.375c  c$，Liao 边界速度小于 Mur 的速度。反射大小可以表示为乘积 $v_b k_x^{\\mathrm{(d)}}$ 的函数。当 $\\theta \\to 90^\\circ$ 时，$k_x^{\\mathrm{(d)}} \\to 0$。对于小参数 $z$， $|(1-z)/(1+z)| \\approx 1-2z$。因此，$R \\approx 1 - 2v_b k_x^{\\mathrm{(d)}}/\\omega$。一个较小的 $v_b$ 会导致 $R$ 的值更接近 1。由于在高角度下 $v_b^{\\text{Liao}}  v_b^{\\text{Mur}}$，这里建模的 Liao ABC 会产生更高的反射系数，表现比更简单的 Mur ABC 更差。\n\n3.  **完美匹配层 (PML)**：PML 不是像 Mur 或 Liao 那样算子意义上的边界条件。它是一个虚构的、有损的介质，被设计成与计算域完美阻抗匹配。在一个理想的 PML 中，任何频率和任何非掠射角的波进入该层时在界面上不会发生反射。一旦进入内部，波就会被该层的人工电导率 $\\sigma$ 衰减。问题指定了一个理想化模型，其中这些属性完美成立，忽略了离散化引起的反射。计算出的反射 $R_0$ 源于层的有限厚度 $d$；它代表了波穿过该层，从其后壁（假设为理想导体）反射，然后返回到界面部分，在两次通过时都被衰减。振幅的总衰减因子是 $e^{-\\alpha}$，因此往返反射被建模为 $R_0 \\approx e^{-2\\alpha}$，前提是前端界面是完美匹配的。因此，在这种理想化下，反射系数恒为设计值 $R_0$，与角度和频率无关。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reflection coefficient magnitude for Mur, Liao, and PML\n    absorbing boundaries in a 2D TLM grid model.\n    \"\"\"\n    # Physical and numerical parameters\n    c = 2.99792458e8  # Speed of light in vacuum (m/s)\n    delta_x = 1.0e-3    # Spatial step (m)\n    S = 1.0 / np.sqrt(2.0) # Courant number\n    delta_t = S * delta_x / c # Time step (s)\n    R0_pml = 1.0e-3 # Designed normal-incidence reflection for PML\n\n    # Test suite of incidence angles (degrees) and frequencies (Hz)\n    test_cases = [\n        (80.0, 3.0e9),\n        (85.0, 3.0e9),\n        (89.0, 3.0e9),\n        (89.9, 3.0e9),\n        (89.0, 9.0e9),\n    ]\n\n    all_results = []\n\n    for theta_deg, f in test_cases:\n        # Convert angle to radians\n        theta = np.deg2rad(theta_deg)\n        \n        # Calculate wave parameters\n        omega = 2.0 * np.pi * f  # Angular frequency (rad/s)\n        k = omega / c            # Continuous wavenumber (rad/m)\n        ky = k * np.sin(theta)   # Tangential wavenumber\n\n        # --- Calculate discrete normal wavenumber kx_d ---\n        \n        # Terms for the discrete dispersion relation\n        omega_dt = omega * delta_t\n        ky_dx = ky * delta_x\n        \n        cos_omega_dt = np.cos(omega_dt)\n        sy_sq = np.sin(ky_dx / 2.0)**2\n        \n        # Solve for sin^2(kx_d * delta_x / 2)\n        sx_sq = (1.0 - cos_omega_dt) / (2.0 * S**2) - sy_sq\n        \n        # --- Handle evanescent case ---\n        if sx_sq  0 or sx_sq > 1:\n            R_mur = 1.0\n            R_liao = 1.0\n            R_pml = R0_pml\n        else:\n            # --- Propagating case: calculate kx_d ---\n            sx = np.sqrt(sx_sq)\n            # arcsin(sx) gives kx_d * delta_x / 2\n            kx_d = (2.0 / delta_x) * np.arcsin(sx)\n\n            # --- Calculate reflection coefficients ---\n            \n            # Mur ABC\n            vb_mur = c\n            num_mur = omega - vb_mur * kx_d\n            den_mur = omega + vb_mur * kx_d\n            R_mur = np.abs(num_mur / den_mur)\n            \n            # Liao ABC (2nd order approximation model)\n            u = np.sin(theta)**2\n            vb_liao = c * (1.0 - u / 2.0 - u**2 / 8.0)\n            num_liao = omega - vb_liao * kx_d\n            den_liao = omega + vb_liao * kx_d\n            R_liao = np.abs(num_liao / den_liao)\n            \n            # PML (idealized model)\n            R_pml = R0_pml\n\n        all_results.append([R_mur, R_liao, R_pml])\n\n    # Format the output string as specified\n    result_strings = []\n    for r_mur, r_liao, r_pml in all_results:\n        result_strings.append(f\"[{r_mur:.6f},{r_liao:.6f},{r_pml:.6f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}