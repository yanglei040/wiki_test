{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个实践是一项基础练习。我们将从第一性原理出发，为一个一维麦克斯韦界面问题实现迎风数值通量。这项练习不仅能培养编程技能，还将通过计算和平衡入射、反射和透射功率，加深对抽象通量公式与能量守恒这一物理原理之间联系的理解。",
            "id": "3335545",
            "problem": "实现一个程序，用于计算具有分段常数介电常数和磁导率的一维麦克斯韦界面问题的上风数值通量，从得到的界面场评估离散的透射和反射功率密度，并检验能量平衡。\n\n你必须在一维横电磁波的设定下工作，该设定由麦克斯韦方程组限定于单个切向电场分量和单个切向磁场分量。左侧介质的介电常数为 $\\epsilon_L$，磁导率为 $\\mu_L$，右侧介质的介电常数为 $\\epsilon_R$，磁导率为 $\\mu_R$，所有这些值在各自的半域中均为严格正常数。设界面法线从左指向右。界面左侧的切向电场和磁场迹分别表示为 $E^-$ 和 $H^-$，右侧的表示为 $E^+$ 和 $H^+$。将每种介质中的电磁阻抗定义为 $Z = \\sqrt{\\mu/\\epsilon}$，波速定义为 $c = 1/\\sqrt{\\mu \\epsilon}$。假设介质无损耗。\n\n仅从麦克斯韦方程组的物理定律和双曲系统的特征变量概念出发，推导用于间断伽辽金离散化中的上风数值通量所对应的唯一界面场 $\\hat{E}$ 和 $\\hat{H}$。具体来说，选择从两侧传入的特征作为数据，强制执行界面处黎曼问题所蕴含的物理连续性条件，并求解 $\\hat{E}$ 和 $\\hat{H}$，用 $(E^-, H^-)$、$(E^+, H^+)$、$(\\epsilon_L,\\mu_L)$ 和 $(\\epsilon_R,\\mu_R)$ 表示。\n\n对每种介质，定义右行和左行特征不变量\n$$w^+ = E + Z H,\\quad w^- = E - Z H.$$\n给定任意迹 $(E^-,H^-)$ 和 $(E^+,H^+)$，将 $w_L^+ = E^- + Z_L H^-$ 解释为从左侧传入的右行波振幅，将 $w_R^- = E^+ - Z_R H^+$ 解释为从右侧传入的左行波振幅。求解界面黎曼问题后的出射波振幅为 $w_L^- = \\hat{E} - Z_L \\hat{H}$（反射回左侧）和 $w_R^+ = \\hat{E} + Z_R \\hat{H}$（透射向右侧）。\n\n在阻抗为 $Z$ 的介质中，定义一个振幅为 $w^+$ 的右行波所携带的瞬时功率密度（坡印廷通量）为 $S_{\\rightarrow} = (w^+)^2/(4 Z)$，一个振幅为 $w^-$ 的左行波所携带的瞬时功率密度为 $S_{\\leftarrow} = (w^-)^2/(4 Z)$。对于一般的叠加情况，净功率密度为 $S = S_{\\rightarrow} - S_{\\leftarrow} = E H$。\n\n你的程序必须：\n- 实现上风数值通量以计算界面处的 $\\hat{E}$ 和 $\\hat{H}$。\n- 根据 $\\hat{E}$ 和 $\\hat{H}$，计算透射和反射的瞬时功率密度，定义为 $S_{\\text{trans}} = (w_R^+)^2/(4 Z_R)$ 和 $S_{\\text{refl}} = (w_L^-)^2/(4 Z_L)$，单位为 $\\mathrm{W/m^2}$。\n- 计算总入射功率密度 $S_{\\text{in}} = (w_L^+)^2/(4 Z_L) + (w_R^-)^2/(4 Z_R)$ 和总出射功率密度 $S_{\\text{out}} = S_{\\text{trans}} + S_{\\text{refl}}$，单位均为 $\\mathrm{W/m^2}$。\n- 报告相对能量不平衡，定义为 $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, \\varepsilon)$，其中 $\\varepsilon$ 是一个小的正常数，用于避免 $S_{\\text{in}}$ 为零时发生除零错误。使用 $\\varepsilon = 10^{-16}$。\n\n测试套件和要求的输出：\n使用以下四个测试用例，其中真空常数为 $\\epsilon_0 = 8.854187817\\times 10^{-12}\\ \\mathrm{F/m}$ 和 $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$。\n\n- 用例 A（阻抗匹配，无反射）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = \\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 仅从左侧入射：$E^- = 1.0\\ \\mathrm{V/m}$，$H^- = E^- / Z_L$，$E^+ = 0$，$H^+ = 0$。\n- 用例 B（阻抗阶跃到右侧较低阻抗）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = 4\\,\\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 仅从左侧入射：$E^- = 1.0\\ \\mathrm{V/m}$，$H^- = E^- / Z_L$，$E^+ = 0$，$H^+ = 0$。\n- 用例 C（右侧近似为理想电导体）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = 10^9\\,\\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 仅从左侧入射：$E^- = 1.0\\ \\mathrm{V/m}$，$H^- = E^- / Z_L$，$E^+ = 0$，$H^+ = 0$。\n- 用例 D（两侧同时入射，介质相同）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = \\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 左侧入射右行波振幅 $A_L = 0.8$：设置 $E^- = A_L/2$，$H^- = A_L/(2 Z_L)$。\n  - 右侧入射左行波振幅 $A_R = 0.5$：设置 $E^+ = A_R/2$，$H^+ = -A_R/(2 Z_R)$。\n\n你的程序应该生成一行输出，包含一个用方括号括起来的逗号分隔列表。对于每个用例，按顺序输出三个浮点数：透射功率密度 $S_{\\text{trans}}$（单位 $\\mathrm{W/m^2}$），反射功率密度 $S_{\\text{refl}}$（单位 $\\mathrm{W/m^2}$），以及相对不平衡 $\\delta$（无量纲）。因此，最终输出必须是一个包含12个浮点数的扁平列表，其顺序对应于用例A、B、C和D：\n$[S_{\\text{trans}}^{(A)}, S_{\\text{refl}}^{(A)}, \\delta^{(A)}, S_{\\text{trans}}^{(B)}, S_{\\text{refl}}^{(B)}, \\delta^{(B)}, S_{\\text{trans}}^{(C)}, S_{\\text{refl}}^{(C)}, \\delta^{(C)}, S_{\\text{trans}}^{(D)}, S_{\\text{refl}}^{(D)}, \\delta^{(D)}]$。",
            "solution": "该问题是有效的。这是一个定义明确的计算电磁学问题，基于麦克斯韦方程组和双曲系统理论的基本原理。所有术语都得到了清晰的定义，提供的数据一致且足以推导出唯一的解。\n\n### 上风通量界面场的推导\n\n我们考虑沿 $x$ 轴传播的一维横电磁（TEM）波。在无损耗、无源的介质中，对于具有介电常数 $\\epsilon$ 和磁导率 $\\mu$ 的单个切向电场分量 $E$ 和单个切向磁场分量 $H$，相关的麦克斯韦方程组为：\n$$\n\\epsilon \\frac{\\partial E}{\\partial t} = -\\frac{\\partial H}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H}{\\partial t} = -\\frac{\\partial E}{\\partial x}\n$$\n注意：问题中对磁场使用的符号约定等价于 $\\epsilon \\partial_t E + \\partial_x H = 0$ 和 $\\mu \\partial_t H + \\partial_x E = 0$。这可以写成矩阵形式 $\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{u}}{\\partial x} = 0$，其中 $\\mathbf{u} = [E, H]^T$，系统矩阵为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1/\\epsilon \\\\ 1/\\mu  0 \\end{pmatrix}\n$$\n该矩阵的特征值为 $\\lambda = \\pm 1/\\sqrt{\\mu\\epsilon} = \\pm c$，其中 $c$ 是波速。对应的右特征向量是：对于 $\\lambda=+c$（右行波）为 $[Z, 1]^T$，对于 $\\lambda=-c$（左行波）为 $[Z, -1]^T$，其中 $Z = \\sqrt{\\mu/\\epsilon}$ 是阻抗。\n\n特征变量定义为 $w^+ = E+ZH$ 和 $w^- = E-ZH$。我们来分析它们的物理意义。\n对于一个沿 $+x$ 方向传播的纯右行波，场之间的关系为 $E=ZH$。此时，$w^+ = ZH+ZH = 2E$ 且 $w^- = ZH-ZH=0$。\n对于一个沿 $-x$ 方向传播的纯左行波，$E=-ZH$。此时，$w^+ = -ZH+ZH=0$ 且 $w^- = -ZH-ZH = -2ZH=2E$。\n因此，$w^+$ 代表波的右行分量的振幅，$w^-$ 代表左行分量的振幅。问题陈述中将 $w^+$ 与右行相关联、将 $w^-$ 与左行相关联是一种不常规但被一致使用的做法。我们将采用问题的解释：$w^+ = E+ZH$ 是右行波振幅，$w^-=E-ZH$ 是左行波振幅。\n\n左介质（$L$）和右介质（$R$）之间界面的上风通量通过求解局部黎曼问题来确定。界面处的状态 $(\\hat{E}, \\hat{H})$ 是恒定的，并且必须满足切向场的物理连续性。\n界面两侧的场可以分解为传入波和传出波。\n- 在左边界（迹 $E^-, H^-$），传入波是右行分量，$w_L^+ = E^- + Z_L H^-$。\n- 在右边界（迹 $E^+, H^+$），传入波是左行分量，$w_R^- = E^+ - Z_R H^+$。\n\n上风原理规定，界面处的特征由流向界面的信息决定。因此，界面状态 $(\\hat{E}, \\hat{H})$ 必须由传入特征 $w_L^+$ 和 $w_R^-$ 构成。\n物理场 $E$ 和 $H$ 的连续性必须在界面 $x=0$ 处成立。\n设界面处的场为 $\\hat{E}$ 和 $\\hat{H}$。这个单一状态是从两侧看到的。\n从左侧（$x=0^-$）看，状态 $(\\hat{E}, \\hat{H})$ 由给定的传入右行波 $w_L^+$ 和一个待确定的传出（反射）左行波（我们记为 $\\hat{w}_L^-$）组成。关系式为 $\\hat{E} = (\\hat{w}_L^+ + \\hat{w}_L^-)/2$ 和 $\\hat{H} = (\\hat{w}_L^+ - \\hat{w}_L^-)/(2 Z_L)$。由此，我们可以断定，从左侧看到的界面场的右行分量必须是来自左侧的传入波。因此，$\\hat{E} + Z_L \\hat{H} = w_L^+$。\n从右侧（$x=0^+$）看，状态 $(\\hat{E}, \\hat{H})$ 由给定的传入左行波 $w_R^-$ 和一个待确定的传出（透射）右行波 $\\hat{w}_R^+$ 组成。关系式为 $\\hat{E} = (\\hat{w}_R^+ + \\hat{w}_R^-)/2$ 和 $\\hat{H} = (\\hat{w}_R^+ - \\hat{w}_R^-)/(2 Z_R)$。从右侧看到的界面场的左行分量必须是来自右侧的传入波。因此，$\\hat{E} - Z_R \\hat{H} = w_R^-$。\n\n我们现在得到了一个由两个线性方程组成的方程组，用于求解两个未知的界面场 $\\hat{E}$ 和 $\\hat{H}$：\n$$\n\\begin{cases}\n\\hat{E} + Z_L \\hat{H} = w_L^+ = E^- + Z_L H^- \\\\\n\\hat{E} - Z_R \\hat{H} = w_R^- = E^+ - Z_R H^+\n\\end{cases}\n$$\n解这个方程组可以得到上风通量唯一的界面场。第一个方程减去第二个方程得到：\n$$\n(Z_L + Z_R)\\hat{H} = w_L^+ - w_R^- \\implies \\hat{H} = \\frac{w_L^+ - w_R^-}{Z_L + Z_R}\n$$\n为了求 $\\hat{E}$，我们将第一个方程乘以 $Z_R$，第二个方程乘以 $Z_L$，然后相加：\n$$\n(Z_R + Z_L)\\hat{E} = Z_R w_L^+ + Z_L w_R^- \\implies \\hat{E} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R}\n$$\n\n### 功率计算与能量平衡\n\n确定了界面场 $(\\hat{E}, \\hat{H})$ 后，我们就可以找到传出（反射和透射）波的特征。\n透射波是传播到右介质中的右行波，由其特征振幅 $w_R^+$ 定义：\n$$\nw_R^+ = \\hat{E} + Z_R \\hat{H} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R} + Z_R \\frac{w_L^+ - w_R^-}{Z_L + Z_R} = \\frac{2Z_R}{Z_L+Z_R} w_L^+ + \\frac{Z_L-Z_R}{Z_L+Z_R} w_R^-\n$$\n反射波是传播回左介质中的左行波，由其特征振幅 $w_L^-$ 定义：\n$$\nw_L^- = \\hat{E} - Z_L \\hat{H} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R} - Z_L \\frac{w_L^+ - w_R^-}{Z_L + Z_R} = \\frac{Z_R-Z_L}{Z_L+Z_R} w_L^+ + \\frac{2Z_L}{Z_L+Z_R} w_R^-\n$$\n瞬时功率密度由这些波的振幅计算得出。\n总入射功率密度是来自传入波的功率之和：\n$$\nS_{\\text{in}} = S_{\\rightarrow,L} + S_{\\leftarrow,R} = \\frac{(w_L^+)^2}{4 Z_L} + \\frac{(w_R^-)^2}{4 Z_R}\n$$\n透射功率密度与传出波 $w_R^+$ 相关：\n$$\nS_{\\text{trans}} = \\frac{(w_R^+)^2}{4 Z_R}\n$$\n反射功率密度与传出波 $w_L^-$ 相关：\n$$\nS_{\\text{refl}} = \\frac{(w_L^-)^2}{4 Z_L}\n$$\n总出射功率密度为 $S_{\\text{out}} = S_{\\text{trans}} + S_{\\text{refl}}$。\n我们可以解析地验证能量守恒。将 $w_R^+$ 和 $w_L^-$ 的表达式代入 $S_{\\text{out}}$ 的公式中：\n$$\nS_{\\text{out}} = \\frac{1}{4Z_R}\\left(\\frac{2Z_R}{Z_L+Z_R} w_L^+ + \\frac{Z_L-Z_R}{Z_L+Z_R} w_R^-\\right)^2 + \\frac{1}{4Z_L}\\left(\\frac{Z_R-Z_L}{Z_L+Z_R} w_L^+ + \\frac{2Z_L}{Z_L+Z_R} w_R^-\\right)^2\n$$\n展开平方项并合并关于 $(w_L^+)^2$、$(w_R^-)^2$ 和 $w_L^+ w_R^-$ 的项，会发现交叉项的系数之和为零，最终结果简化为：\n$$\nS_{\\text{out}} = \\frac{(w_L^+)^2}{4 Z_L} + \\frac{(w_R^-)^2}{4 Z_R} = S_{\\text{in}}\n$$\n这证实了所推导的上风通量是能量守恒的。数值相对能量不平衡 $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, \\varepsilon)$ 应该在浮点精度范围内为零。\n\n### 计算方法\n程序将对每个测试用例执行以下步骤：\n1. 定义真空常数 $\\epsilon_0 = 8.854187817\\times 10^{-12}$ 和 $\\mu_0 = 4\\pi\\times 10^{-7}$。\n2. 对每种介质（$L, R$），计算介电常数 $\\epsilon$、磁导率 $\\mu$ 和阻抗 $Z = \\sqrt{\\mu/\\epsilon}$。\n3. 根据测试用例规范确定迹值 $(E^-, H^-)$ 和 $(E^+, H^+)$。\n4. 计算传入特征波的振幅：$w_L^+ = E^- + Z_L H^-$ 和 $w_R^- = E^+ - Z_R H^+$。\n5. 使用推导出的透射和反射公式计算传出波的振幅 $w_R^+$ 和 $w_L^-$。\n6. 计算功率密度：$S_{\\text{trans}} = (w_R^+)^2/(4 Z_R)$ 和 $S_{\\text{refl}} = (w_L^-)^2/(4 Z_L)$。\n7. 计算总入射功率 $S_{\\text{in}}$ 和总出射功率 $S_{\\text{out}}$。\n8. 计算相对能量不平衡 $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, 10^{-16})$。\n9. 为每个用例存储三元组 $(S_{\\text{trans}}, S_{\\text{refl}}, \\delta)$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes upwind flux, power densities, and energy imbalance for 1D Maxwell's equations \n    at a material interface.\n    \"\"\"\n    \n    # Physical constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n    MU_0 = 4 * np.pi * 1e-7      # H/m\n    Z_0 = np.sqrt(MU_0 / EPSILON_0) # Impedance of free space\n\n    # Small constant for division stability\n    EPSILON_NUM = 1e-16\n\n    # Test suite definition\n    test_cases_spec = [\n        # Case A: Impedance matched\n        {'id': 'A', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1.0, 'mu_r_R': 1.0, \n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case B: Impedance step down\n        {'id': 'B', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 4.0, 'mu_r_R': 1.0,\n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case C: Approximate PEC\n        {'id': 'C', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1e9, 'mu_r_R': 1.0,\n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case D: Simultaneous incidence\n        {'id': 'D', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1.0, 'mu_r_R': 1.0,\n         'type': 'simultaneous', 'A_L': 0.8, 'A_R': 0.5}\n    ]\n\n    results = []\n    \n    for case in test_cases_spec:\n        # 1. Calculate material properties\n        eps_L = case['eps_r_L'] * EPSILON_0\n        mu_L = case['mu_r_L'] * MU_0\n        Z_L = np.sqrt(mu_L / eps_L)\n\n        eps_R = case['eps_r_R'] * EPSILON_0\n        mu_R = case['mu_r_R'] * MU_0\n        Z_R = np.sqrt(mu_R / eps_R)\n\n        # 2. Determine trace field values E-, H-, E+, H+\n        if case['type'] == 'incident_left':\n            E_minus = case['E_amp']\n            H_minus = E_minus / Z_L\n            E_plus = 0.0\n            H_plus = 0.0\n        elif case['type'] == 'simultaneous':\n            A_L = case['A_L']\n            A_R = case['A_R']\n            E_minus = A_L / 2.0\n            H_minus = A_L / (2.0 * Z_L)\n            E_plus = A_R / 2.0\n            H_plus = -A_R / (2.0 * Z_R)\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # 3. Compute incoming characteristic wave amplitudes\n        w_L_plus = E_minus + Z_L * H_minus\n        w_R_minus = E_plus - Z_R * H_plus\n        \n        # 4. Compute total incident power density\n        S_in = (w_L_plus**2) / (4 * Z_L) + (w_R_minus**2) / (4 * Z_R)\n\n        # 5. Compute outgoing wave amplitudes (transmitted and reflected)\n        # These are the reflection/transmission coefficients for the characteristic variables\n        # This is derived by solving for the interface fields E_hat, H_hat and then\n        # calculating the outgoing characteristics w_L_minus_out and w_R_plus_out.\n        \n        # Reflected wave amplitude: w_L_minus_out = Gamma_L * w_L_plus + T_R * w_R_minus\n        Gamma_L = (Z_R - Z_L) / (Z_L + Z_R)\n        T_R_to_L = (2 * Z_L) / (Z_L + Z_R)\n        w_L_minus_out = Gamma_L * w_L_plus + T_R_to_L * w_R_minus\n        \n        # Transmitted wave amplitude: w_R_plus_out = T_L * w_L_plus + Gamma_R * w_R_minus\n        T_L_to_R = (2 * Z_R) / (Z_L + Z_R)\n        Gamma_R = (Z_L - Z_R) / (Z_L + Z_R) # Note Gamma_R = -Gamma_L\n        w_R_plus_out = T_L_to_R * w_L_plus + Gamma_R * w_R_minus\n\n        # 6. Calculate transmitted and reflected power densities\n        S_trans = (w_R_plus_out**2) / (4 * Z_R)\n        S_refl = (w_L_minus_out**2) / (4 * Z_L)\n        \n        # 7. Calculate total outgoing power density\n        S_out = S_trans + S_refl\n\n        # 8. Compute relative energy imbalance\n        delta = abs(S_in - S_out) / max(S_in, EPSILON_NUM)\n        \n        results.extend([S_trans, S_refl, delta])\n\n    # Format output as a single comma-separated string\n    output_str = f\"[{','.join(f'{x:.8e}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "为了更好地理解DG方法，将其与更成熟的技术联系起来是很有帮助的。本练习探讨了间断伽辽金方法与经典的Yee FDTD格式之间的深刻联系。通过分析具有特定通量族的DG离散化，我们将确定在何种精确条件下，最简单的DG格式（$p=0$）能够再现Yee方法的无耗散模板。",
            "id": "3335537",
            "problem": "考虑均匀、无源介质中的横电磁（TEM）波的一维时域麦克斯韦方程组，其介电常数为 $\\varepsilon$，磁导率为 $\\mu$，\n$$\n\\partial_{t} E(x,t) \\;=\\; -\\frac{1}{\\varepsilon}\\,\\partial_{x} H(x,t), \\qquad\n\\partial_{t} H(x,t) \\;=\\; -\\frac{1}{\\mu}\\,\\partial_{x} E(x,t),\n$$\n方程定义在由单元 $\\{K_i\\}$ 构成的均匀笛卡尔网格上，其中 $K_i=[x_{i-1/2},x_{i+1/2}]$，间距为 $\\Delta x$。设间断伽辽金（DG）空间离散采用 $p \\geq 0$ 阶多项式，具有标准的单元弱形式、一致的数值界面通量和精确质量矩阵。时间步进采用显式蛙跳格式，其精神与经典的 Yee 氏时域有限差分（FDTD）方法一致（此处定义为在笛卡尔网格上基于中心空间差分构建的标准二阶时间交错更新）。\n\n在每个界面 $x_{i+1/2}$ 处，通过组合与波阻抗 $Z_0=\\sqrt{\\mu/\\varepsilon}$ 和导纳 $Y_0=1/Z_0$ 相关的界面特征变量，构造一个在中心通量和阻抗加权上风通量之间插值的单参数线性一致数值通量族。仅使用物理原理（局部守恒、出射特征的连续性和能量稳定性），写出一个由无量纲实数参数 $\\alpha$ 索引的最小参数化族，该族混合了中心和上风行为。在均匀网格上，推导单元平均未知量 $E_i(t)$ 和 $H_i(t)$ 的半离散 $p=0$ DG 更新方程，并通过匹配在蛙跳时间步进下产生的空间模板，确定使 DG 格式在笛卡尔网格上精确再现 Yee 空间模板和非耗散行为的唯一 $\\alpha$ 值。\n\n最后，利用半离散算子和从第一性原理推导出的色散/能量论证，定性解释当多项式阶数 $p$ 增加（$p \\geq 1$）时，即使使用通量族中的中心成员，DG 格式为何以及如何偏离 Yee 格式。您的解释必须基于多项式表示、单元间耦合和特征连续性的作用。\n\n将 $\\alpha$ 的值作为最终答案报告。最终答案是一个无量纲实数；无需四舍五入。",
            "solution": "该问题要求构造一维麦克斯韦方程组的一个单参数数值通量族，推导多项式阶数 $p=0$ 时的间断伽辽金（DG）格式，确定使该 DG 格式再现 Yee FDTD 格式的唯一参数值 $\\alpha$，并定性解释当 $p \\ge 1$ 时 DG 格式与 Yee 格式之间的差异。\n\n### 步骤 1：问题陈述的验证\n所提供的问题源于计算电磁学和偏微分方程数值分析领域。\n**已知条件提取：**\n-   控制方程是一维横电磁（TEM）波的麦克斯韦方程组：$\\partial_{t} E = -\\frac{1}{\\varepsilon}\\,\\partial_{x} H$ 和 $\\partial_{t} H = -\\frac{1}{\\mu}\\,\\partial_{x} E$。\n-   介质是均匀、无源的，介电常数为 $\\varepsilon$，磁导率为 $\\mu$。\n-   空间离散是在均匀笛卡尔网格上进行的 DG 方法，网格单元为 $K_i=[x_{i-1/2},x_{i+1/2}]$，间距为 $\\Delta x$。\n-   多项式阶数为 $p \\geq 0$。\n-   要求数值通量是线性的且一致的。\n-   质量矩阵是精确的。\n-   时间积分是显式蛙跳格式。\n-   定义：波阻抗 $Z_0=\\sqrt{\\mu/\\varepsilon}$ 和导纳 $Y_0=1/Z_0$。\n-   目标是找到一个特定通量族中的唯一无量纲参数 $\\alpha$，使得 $p=0$ 的 DG 格式能够再现 Yee FDTD 的空间模板及其非耗散特性。\n\n**验证：**\n1.  **科学依据：** 该问题牢固地植根于电磁学和数值方法（DG、FDTD）的既定原理，这些都是科学计算中的标准课题。\n2.  **适定性：** 任务定义清晰，导向一个特定的解析结果（$\\alpha$）和一个概念性解释。问题断言存在唯一解，这为求解过程提供了指引。\n3.  **客观性：** 语言正式、精确，不含主观内容。\n4.  **完整性与一致性：** 提供了所有必需的物理常数、方程和数值方法规范。没有矛盾之处。\n\n该问题被认为是**有效的**，因为它是科学合理的、适定的和客观的。\n\n### 步骤 2：数值通量族的构造\n\n一维麦克斯韦系统可以写成向量形式 $\\partial_t \\mathbf{u} + \\mathbf{A} \\partial_x \\mathbf{u} = 0$，其中状态向量为 $\\mathbf{u} = [E, H]^T$，矩阵为 $\\mathbf{A} = \\begin{pmatrix} 0  1/\\varepsilon \\\\ 1/\\mu  0 \\end{pmatrix}$。$\\mathbf{A}$ 的特征值为 $\\pm c$，其中 $c=1/\\sqrt{\\mu\\varepsilon}$ 是波速。\n\n界面 $x_{i+1/2}$ 处的数值通量为状态提供一个单一值 $\\mathbf{u}^* = [\\hat{E}, \\hat{H}]^T$，该值基于左侧状态 $\\mathbf{u}^-$ 和右侧状态 $\\mathbf{u}^+$。问题要求一个在中心通量和上风通量之间插值的通量族。\n\n**中心通量**是左、右状态的平均值：\n$$ \\hat{E}_{C} = \\frac{1}{2}(E^- + E^+), \\qquad \\hat{H}_{C} = \\frac{1}{2}(H^- + H^+) $$\n这可以写成 $\\mathbf{u}^*_C = \\{\\mathbf{u}\\}$，其中 $\\{\\cdot\\}$ 表示平均值。\n\n**阻抗加权上风通量**由系统的特征变量构造而成。它也被称为特征通量或基于黎曼求解器的通量。对于对称双曲系统，上风通量状态由 $\\mathbf{u}^*_U = \\{\\mathbf{u}\\} - \\frac{1}{2}\\mathrm{sign}(\\mathbf{A})\\llbracket \\mathbf{u} \\rrbracket$ 给出，其中 $\\llbracket \\mathbf{u} \\rrbracket = \\mathbf{u}^+ - \\mathbf{u}^-$ 是跳跃量。矩阵 $\\mathrm{sign}(\\mathbf{A})$ 通过对角化 $\\mathbf{A}=\\mathbf{R}\\Lambda\\mathbf{L}$ 求得，结果为 $\\mathrm{sign}(\\mathbf{A})=\\mathbf{R}\\,\\mathrm{sign}(\\Lambda)\\,\\mathbf{L}$。对于该系统，计算结果为：\n$$ \\mathrm{sign}(\\mathbf{A}) = \\begin{pmatrix} 0  Z_0 \\\\ Y_0  0 \\end{pmatrix} $$\n因此，上风通量的分量为：\n$$ \\hat{E}_{U} = \\frac{E^- + E^+}{2} - \\frac{Z_0}{2}(H^+ - H^-) $$\n$$ \\hat{H}_{U} = \\frac{H^- + H^+}{2} - \\frac{Y_0}{2}(E^+ - E^-) $$\n\n一个由无量纲参数 $\\alpha$ 索引的单参数通量族，它在中心通量（$\\alpha=0$）和上风通量（$\\alpha=1$）之间进行线性插值，由 $\\mathbf{u}^* = (1-\\alpha)\\mathbf{u}^*_C + \\alpha \\mathbf{u}^*_U$ 给出。一个更直接的参数化方法是在中心平均值上加上一个缩放的跳跃项：\n$$ \\hat{E}(\\alpha) = \\frac{E^- + E^+}{2} - \\frac{\\alpha Z_0}{2}(H^+ - H^-) $$\n$$ \\hat{H}(\\alpha) = \\frac{H^- + H^+}{2} - \\frac{\\alpha Y_0}{2}(E^+ - E^-) $$\n该通量是一致的，因为当 $\\mathbf{u}^- = \\mathbf{u}^+$ 时，我们有 $\\hat{E}=E^-$ 和 $\\hat{H}=H^-$。\n\n### 步骤 3：p=0 DG 格式的推导\n\n对于多项式阶数 $p=0$，每个单元 $K_i$ 中的基函数是 $\\phi_0(x)=1$，解由其单元平均值表示，$E_h(x,t) = E_i(t)$ 和 $H_h(x,t) = H_i(t)$ 对 $x \\in K_i$ 成立。\n\n方程 $\\partial_t E = -\\frac{1}{\\varepsilon}\\partial_x H$ 在单元 $K_i$ 上的 DG 弱形式为：\n$$ \\int_{K_i} (\\partial_t E_h) \\phi_0 \\,dx = -\\frac{1}{\\varepsilon} \\int_{K_i} (\\partial_x H_h) \\phi_0 \\,dx $$\n对右侧进行分部积分得到：\n$$ \\Delta x \\frac{dE_i}{dt} = \\frac{1}{\\varepsilon} \\int_{K_i} H_h (\\partial_x \\phi_0) \\,dx - \\frac{1}{\\varepsilon} [ \\hat{H}\\phi_0 ]_{x_{i-1/2}}^{x_{i+1/2}} $$\n由于 $\\phi_0=1$，其导数为零，我们得到半离散更新法则：\n$$ \\frac{dE_i}{dt} = -\\frac{1}{\\varepsilon \\Delta x} (\\hat{H}_{i+1/2} - \\hat{H}_{i-1/2}) $$\n类似地，对于 $H$ 方程：\n$$ \\frac{dH_i}{dt} = -\\frac{1}{\\mu \\Delta x} (\\hat{E}_{i+1/2} - \\hat{E}_{i-1/2}) $$\n现在我们代入数值通量的表达式。在界面 $x_{i+1/2}$ 处，我们有 $E^-=E_i, E^+=E_{i+1}, H^-=H_i, H^+=H_{i+1}$。在 $x_{i-1/2}$ 处，我们有 $E^-=E_{i-1}, E^+=E_i, H^-=H_{i-1}, H^+=H_i$。\n$$ \\hat{H}_{i+1/2} = \\frac{H_i+H_{i+1}}{2} - \\frac{\\alpha Y_0}{2}(E_{i+1}-E_i) $$\n$$ \\hat{H}_{i-1/2} = \\frac{H_{i-1}+H_i}{2} - \\frac{\\alpha Y_0}{2}(E_i-E_{i-1}) $$\n将这些代入 $E_i$ 的方程中得到：\n$$ \\frac{dE_i}{dt} = -\\frac{1}{\\varepsilon \\Delta x} \\left[ \\frac{H_{i+1}-H_{i-1}}{2} - \\frac{\\alpha Y_0}{2}(E_{i+1} - 2E_i + E_{i-1}) \\right] $$\n类似地，对于 $H_i$：\n$$ \\frac{dH_i}{dt} = -\\frac{1}{\\mu \\Delta x} \\left[ \\frac{E_{i+1}-E_{i-1}}{2} - \\frac{\\alpha Z_0}{2}(H_{i+1} - 2H_i + H_{i-1}) \\right] $$\n\n### 步骤 4：与 Yee 格式匹配并求解 $\\alpha$\n\n问题要求 DG 格式再现 Yee 格式的两个特性：空间模板及其非耗散性。\n\n1.  **非耗散行为：** 我们分析半离散能量 $\\mathcal{E}_h = \\frac{\\Delta x}{2} \\sum_i (\\varepsilon E_i^2 + \\mu H_i^2)$ 的时间演化。能量的变化率为：\n    $$ \\frac{d\\mathcal{E}_h}{dt} = \\Delta x \\sum_i \\left(\\varepsilon E_i \\frac{dE_i}{dt} + \\mu H_i \\frac{dH_i}{dt}\\right) $$\n    代入半离散方程并进行分部求和，揭示了在界面处耗散的能量：\n    $$ \\frac{d\\mathcal{E}_h}{dt} = -\\sum_i \\left( \\frac{\\alpha Z_0}{2}(H_{i+1}-H_i)^2 + \\frac{\\alpha Y_0}{2}(E_{i+1}-E_i)^2 \\right) $$\n    众所周知，在没有材料损耗的情况下，Yee FDTD 格式是能量守恒的（非耗散的）。要使 DG 格式非耗散，必须有 $d\\mathcal{E}_h/dt = 0$。由于 $Z_0  0$，$Y_0  0$，且平方跳跃项为非负，此条件对于任意解成立当且仅当 $\\alpha=0$。因此，非耗散特性唯一地确定了参数**必须是 $\\alpha=0$**。\n\n2.  **Yee 空间模板：** 当 $\\alpha=0$ 时，通量变为中心通量，半离散 DG 格式简化为：\n    $$ \\frac{dE_i}{dt} = - \\frac{1}{\\varepsilon} \\frac{H_{i+1}-H_{i-1}}{2\\Delta x}, \\qquad \\frac{dH_i}{dt} = - \\frac{1}{\\mu} \\frac{E_{i+1}-E_{i-1}}{2\\Delta x} $$\n    这是一个同位中心差分格式。标准的 Yee FDTD 格式定义在交错网格上：\n    $$ \\frac{dE_i}{dt} = - \\frac{1}{\\varepsilon} \\frac{H_{i+1/2}-H_{i-1/2}}{\\Delta x}, \\qquad \\frac{dH_{i+1/2}}{dt} = - \\frac{1}{\\mu} \\frac{E_{i+1}-E_i}{\\Delta x} $$\n    这些模板看起来不同。然而，已知 $\\alpha=0$ 的同位格式会解耦成两个独立的子网格，分别对应偶数和奇数索引。让我们从同位 DG 网格变量定义一个交错网格：$E'_j = E_{2j}$ 和 $H'_{j+1/2} = H_{2j+1}$。这个新交错网格的间距是 $2\\Delta x$。\n    对于偶数索引 $i=2j$ 处的 E 场更新，DG 格式给出：$\\frac{dE_{2j}}{dt} = - \\frac{1}{\\varepsilon} \\frac{H_{2j+1}-H_{2j-1}}{2\\Delta x}$。用新变量表示，这是 $\\frac{dE'_j}{dt} = - \\frac{1}{\\varepsilon} \\frac{H'_{j+1/2}-H'_{j-1/2}}{2\\Delta x}$。这正是在间距为 $2\\Delta x$ 的网格上 $E$ 的 Yee 模板。\n    对于奇数索引 $i=2j+1$ 处的 H 场更新：$\\frac{dH_{2j+1}}{dt} = - \\frac{1}{\\mu} \\frac{E_{2j+2}-E_{2j}}{2\\Delta x}$。用新变量表示，这是 $\\frac{dH'_{j+1/2}}{dt} = - \\frac{1}{\\mu} \\frac{E'_{j+1}-E'_j}{2\\Delta x}$。这正是 H 的 Yee 模板。\n    因此，当 $\\alpha=0$ 时，DG($p=0$) 格式在代数上等价于两个在两倍间距网格上的独立 Yee 格式。这就是它“精确再现 Yee 空间模板”的含义。\n    因此，同时满足这两个条件的唯一 $\\alpha$ 值是 $\\alpha=0$。\n\n### 步骤 5：高阶多项式 ($p \\ge 1$) 的偏差\n\n当多项式阶数 $p$ 增加到 $p \\ge 1$ 时，采用中心通量（$\\alpha=0$）的 DG 格式从根本上偏离了简单的 Yee FDTD 格式。为 $p=0$ 找到的对应关系是一个特例，无法推广。\n\n1.  **多项式表示与自由度：** 对于 $p \\ge 1$，每个单元 $K_i$ 内的基函数是最高为 $p$ 阶的多项式。解 $E_h(x,t)$ 不再是单个单元平均值，而是一个每个单元有 $p+1$ 个系数（自由度）的多项式。例如，对于 $p=1$，解在每个单元中是一条线段。这提供了场的高阶表示，并能捕捉子单元内的变化，这在基于点值的 Yee 格式中是完全没有的概念。\n\n2.  **单元间耦合：** 当 $p \\ge 1$ 时，解在单元边界处的值，例如 $E_h(x_{i+1/2}^-)$，是单元 $K_i$ 中的多项式在该点的评价值。它依赖于单元 $K_i$ 中所有的 $p+1$ 个系数。中心通量 $\\hat{E}_{i+1/2} = \\frac{1}{2}(E_h(x_{i+1/2}^-) + E_h(x_{i+1/2}^+))$ 将单元 $K_i$ 的所有自由度与单元 $K_{i+1}$ 的所有自由度耦合起来。与 $p=0$ 情况或 Yee 格式的简单最近邻耦合相比，这为半离散算子创建了一个复杂得多、稠密得多的模板。\n\n3.  **色散与能量：** 对于 $p \\ge 1$ 的半离散算子具有更宽的特征值谱。这导致系统中波存在 $p+1$ 个不同的色散关系（一个物理模式，$p$ 个伪模式）。虽然中心通量对整个系统保持能量守恒，但色散特性截然不同。高阶 DG 方法因其物理模式的数值色散误差非常低而备受推崇，这意味着与二阶精度的 Yee 格式相比，波速在更宽的波数范围内是准确的。这种精度的提高是更丰富的多项式表示和单元间耦合的直接结果。该格式不能再分解为简单的、独立的类 Yee 模板。\n\n总之，对于 $p \\ge 1$，DG 中心通量格式成为一种真正的高阶方法。其表示、耦合以及由此产生的波传播特性，在根本上比 Yee 格式的简单有限差分模板更丰富、更精确，两者之间的任何等价性都已不复存在。\n\n使得 $p=0$ DG 格式非耗散并再现 Yee 模板的 $\\alpha$ 值是唯一确定的。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "真实的模拟任务常常需要使用非均匀网格来高效地解析复杂的几何和场。本实践将挑战一个更高级的问题：处理粗细网格界面处的数值通量。我们将对由数值耗散引起的伪反射进行建模，然后设计并实现一种“智能”的自适应通量，该通量通过考虑波的局部入射角来减少这些不必要的反射。",
            "id": "3335515",
            "problem": "考虑二维横电 (TE) 形式的麦克斯韦方程组，该方程组描述的是在均匀、各向同性的介质中的电磁波。介质的介电常数为 $\\varepsilon$，磁导率为 $\\mu$，因此电磁波速为 $c = 1/\\sqrt{\\mu \\varepsilon}$。设一个单色平面波入射到两个不连续伽辽金 (DG) 单元之间的一个内部面上，这两个单元在一个粗细网格尺寸过渡界面处相遇。将界面单位法向量记为 $\\mathbf{n}$，并将入射角 $\\theta$ 定义为波矢 $\\mathbf{k}$ 与 $\\mathbf{n}$ 之间的夹角，因此相速度的法向分量为 $c_n = c \\, |\\cos \\theta|$。对于一个对称双曲系统，考虑在 DG 面上常用的 Lax–Friedrichs 型数值通量，该通量通过一个与状态跳跃成正比的耗散惩罚项来增强平均物理通量，此惩罚项由一个逐面的耗散参数 $\\alpha$ 控制。\n\n从守恒律形式的麦克斯韦方程组和界面上切向场的连续性出发，对数值耗散产生的反射进行如下建模：将切向场振幅的界面相互作用近似为一个法向的一阶标量透射-反射模型。在该模型中，一个入射振幅为 $A_i$、反射振幅为 $A_r$ 的波产生一个透射振幅为 $A_t$ 的波。假设对于谐波状态，数值通量在线性化意义上强制施加一个等效于 Lax–Friedrichs 惩罚的关系，该惩罚使用参数 $\\alpha$ 并作用于法向特征速度 $c_n$。在此模型下，从第一性原理出发，推导出反射振幅比 $R = A_r/A_i$ 作为 $\\alpha$ 和 $c_n$ 的函数的闭式表达式，然后将反射功率分数表示为 $P = R^2$。\n\n为了以科学上合理的方式引入粗细网格界面的效应，将面上的基准耗散参数定义为\n$$\n\\alpha_{\\text{iso}} = c \\, s(r, p_f, p_c), \\quad s(r, p_f, p_c) = 1 + \\frac{r - 1}{r + 1} \\cdot \\frac{p_c + 1}{p_f + 1},\n$$\n其中 $r = h_c / h_f \\geq 1$ 是粗单元与细单元尺寸之比，而 $p_f$ 和 $p_c$ 分别是细单元和粗单元一侧的多项式次数。这个 $s(r,p_f,p_c) \\geq 1$ 代表了在非协调界面上常用的增强稳定性。现在，设计一种入射角自适应方法，通过将有效界面耗散限制在法向特征速度来减少伪反射：\n$$\n\\alpha_{\\text{adapt}} = \\min\\!\\left(\\alpha_{\\text{iso}}, \\, c_n\\right).\n$$\n\n你的任务是：\n1. 根据上述物理和数值原理，推导出反射振幅 $R(\\alpha, c_n)$ 和反射功率 $P(\\alpha, c_n)$。\n2. 实现一个程序，为每个测试用例计算两个数：$P_{\\text{iso}} = P(\\alpha_{\\text{iso}}, c_n)$ 和 $P_{\\text{adapt}} = P(\\alpha_{\\text{adapt}}, c_n)$。\n\n假设使用无量纲单位，且 $c = 1$。角度单位必须是度，在进行任何三角计算时，必须在内部将其转换为弧度。最终答案必须是浮点数。\n\n测试套件：\n- 用例 1 (理想路径，中等失配下的垂直入射): $r = 2$, $p_f = 3$, $p_c = 1$, $\\theta = 0^\\circ$。\n- 用例 2 (斜入射，较大失配): $r = 4$, $p_f = 4$, $p_c = 1$, $\\theta = 60^\\circ$。\n- 用例 3 (近掠射，强失配): $r = 8$, $p_f = 5$, $p_c = 1$, $\\theta = 80^\\circ$。\n- 用例 4 (无 $h$ 失配，斜入射): $r = 1$, $p_f = 3$, $p_c = 3$, $\\theta = 45^\\circ$。\n- 用例 5 (极端掠射): $r = 16$, $p_f = 7$, $p_c = 2$, $\\theta = 89.9^\\circ$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序必须完全遵循\n$$\n[P_{\\text{iso},1}, P_{\\text{adapt},1}, P_{\\text{iso},2}, P_{\\text{adapt},2}, P_{\\text{iso},3}, P_{\\text{adapt},3}, P_{\\text{iso},4}, P_{\\text{adapt},4}, P_{\\text{iso},5}, P_{\\text{adapt},5}],\n$$\n其中，索引对应于上面编号的测试用例。",
            "solution": "该问题要求推导并计算在粗细网格交界处的不连续伽辽金 (DG) 界面上产生的伪数值反射。这种反射是数值通量中稳定项的人为产物，此处指定为 Lax-Friedrichs 类型。\n\n### 第一部分：反射模型的推导\n\n单色平面波与单个数值界面的相互作用可以通过一个简化的一维模型进行分析。问题指出，我们应将完整的电磁相互作用近似为一个沿着界面法向 $\\mathbf{n}$ 的一阶标量透射-反射模型。\n\n设场振幅由标量 $u$ 表示。该振幅在垂直于界面的方向上的传播由标量平流方程 $u_t + c_n u_x = 0$ 控制，其中 $c_n = c |\\cos\\theta|$ 是相速度的法向分量。这里，$c$ 是介质中的光速，$\\theta$ 是入射角。\n\n在位于 $x=0$ 的界面处，一个振幅为 $A_i$ 的入射波从左侧 ($x0$) 到达，产生一个振幅为 $A_r$ 的反射波向左传播，以及一个振幅为 $A_t$ 的透射波进入右半空间 ($x0$)。因此，界面左右两侧的总场振幅由下式给出：\n$$\nu^- = A_i + A_r\n$$\n$$\nu^+ = A_t\n$$\n在物理的、均匀的介质中，不会有反射，即 $A_r=0$ 且 $A_t=A_i$。这里分析的反射是纯粹的数值产物，由 DG 格式稳定性所需的数值通量的耗散部分产生。问题指定了 Lax-Friedrichs (LF) 型数值通量，对于标量平流方程，其形式为：\n$$\n\\mathcal{F}(u^-, u^+) = \\frac{1}{2}(c_n u^- + c_n u^+) - \\frac{\\alpha}{2}(u^+ - u^-)\n$$\n这里，$\\alpha$ 是耗散参数，控制着人工黏性的量。\n\n对于一个由数值通量定义的界面，对波与该界面的相互作用进行标准的特征分析，可以得出一个关于入射波、反射波和透射波振幅之间关系式。这一分析构成了从数值波传播的第一性原理出发的推导，最终得出了反射振幅比 $R = A_r/A_i$ 的一个闭式表达式。对于 Lax-Friedrichs 通量，该比值为：\n$$\nR(\\alpha, c_n) = \\frac{c_n - \\alpha}{c_n + \\alpha}\n$$\n这个公式是我们分析的核心。它直接建立了数值参数 $\\alpha$ 与反射 $R$ 这一物理后果之间的联系。\n\n从该公式可以得出一个关键的观察：如果 $\\alpha = c_n$，反射系数 $R$ 变为零。在这种情况下，Lax-Friedrichs 通量退化为标量平流方程的纯上风格式，即 $\\mathcal{F}(u^-, u^+) = c_n u^-$。众所周知，上风格式具有最小的耗散性，并且对于沿上风方向传播的波不会产生伪反射。\n\n反射功率分数 $P$ 与反射波振幅的平方成正比。因此，反射功率比由下式给出：\n$$\nP(\\alpha, c_n) = R^2 = \\left(\\frac{c_n - \\alpha}{c_n + \\alpha}\\right)^2\n$$\n\n### 第二部分：耗散模型的应用\n\n问题为粗细网格界面上的耗散参数 $\\alpha$ 定义了两种模型。\n\n1.  **各向同性耗散 ($\\alpha_{\\text{iso}}$)**：这是一个基准模型，其中耗散与入射角无关。该参数定义为 $\\alpha_{\\text{iso}} = c \\cdot s(r, p_f, p_c)$，其中 $r=h_c/h_f$ 是粗单元与细单元尺寸之比，$p_c$ 和 $p_f$ 分别是粗细单元一侧的多项式次数，稳定函数 $s$ 为：\n    $$\n    s(r, p_f, p_c) = 1 + \\frac{r - 1}{r + 1} \\cdot \\frac{p_c + 1}{p_f + 1}\n    $$\n    此模型的反射功率为 $P_{\\text{iso}} = P(\\alpha_{\\text{iso}}, c_n)$。\n\n2.  **自适应耗散 ($\\alpha_{\\text{adapt}}$)**：该模型根据入射角调整耗散以减少伪反射。它将耗散参数的上限设置为法向特征速度 $c_n$：\n    $$\n    \\alpha_{\\text{adapt}} = \\min(\\alpha_{\\text{iso}}, c_n)\n    $$\n    反射功率为 $P_{\\text{adapt}} = P(\\alpha_{\\text{adapt}}, c_n)$。如前所述，如果 $\\alpha_{\\text{iso}} \\geq c_n$，则 $\\alpha_{\\text{adapt}} = c_n$，反射 $P_{\\text{adapt}}$ 将为零。当基准耗散超过入射特征的法向速度时，这种自适应策略有效地恢复了无反射的上风条件。\n\n计算任务是为每个给定的测试用例计算 $P_{\\text{iso}}$ 和 $P_{\\text{adapt}}$。我们假设使用无量纲单位，且 $c=1$。\n对于每个测试用例，我们执行以下步骤：\n1.  将入射角 $\\theta$ 从度转换为弧度。\n2.  计算法向特征速度 $c_n = c|\\cos\\theta| = |\\cos\\theta|$。\n3.  计算稳定函数 $s(r, p_f, p_c)$ 和基准耗散 $\\alpha_{\\text{iso}} = s$。\n4.  确定自适应耗散 $\\alpha_{\\text{adapt}} = \\min(\\alpha_{\\text{iso}}, c_n)$。\n5.  使用推导出的公式 $P(\\alpha, c_n)$ 计算反射功率分数 $P_{\\text{iso}}$ 和 $P_{\\text{adapt}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating spurious numerical reflection for\n    different dissipation models in a Discontinuous Galerkin scheme.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (r, p_f, p_c, theta_degrees)\n    test_cases = [\n        (2, 3, 1, 0.0),    # Case 1\n        (4, 4, 1, 60.0),   # Case 2\n        (8, 5, 1, 80.0),   # Case 3\n        (1, 3, 3, 45.0),   # Case 4\n        (16, 7, 2, 89.9),   # Case 5\n    ]\n\n    results = []\n    \n    # Speed of light in dimensionless units\n    c = 1.0\n\n    def calculate_reflected_power(alpha, c_n):\n        \"\"\"\n        Calculates the reflected power fraction P = R^2.\n        Args:\n            alpha (float): The dissipation parameter.\n            c_n (float): The normal component of the phase speed.\n        Returns:\n            float: The reflected power fraction.\n        \"\"\"\n        if c_n + alpha == 0:\n            # Handle potential division by zero, though unlikely with problem constraints\n            # (alpha and c_n are non-negative).\n            return 1.0 if c_n - alpha != 0 else 0.0\n        \n        reflection_ratio = (c_n - alpha) / (c_n + alpha)\n        return reflection_ratio**2\n\n    for case in test_cases:\n        r, p_f, p_c, theta_deg = case\n\n        # Convert angle to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Calculate the normal component of the phase speed\n        c_n = c * np.abs(np.cos(theta_rad))\n\n        # Calculate the stabilization function s(r, p_f, p_c)\n        s = 1.0 + ((r - 1.0) / (r + 1.0)) * ((p_c + 1.0) / (p_f + 1.0))\n\n        # Calculate the isotropic dissipation parameter\n        alpha_iso = c * s\n\n        # Calculate the adaptive dissipation parameter\n        alpha_adapt = min(alpha_iso, c_n)\n\n        # Calculate reflected power for the isotropic model\n        p_iso = calculate_reflected_power(alpha_iso, c_n)\n\n        # Calculate reflected power for the adaptive model\n        p_adapt = calculate_reflected_power(alpha_adapt, c_n)\n\n        results.extend([p_iso, p_adapt])\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures standard float representation.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}