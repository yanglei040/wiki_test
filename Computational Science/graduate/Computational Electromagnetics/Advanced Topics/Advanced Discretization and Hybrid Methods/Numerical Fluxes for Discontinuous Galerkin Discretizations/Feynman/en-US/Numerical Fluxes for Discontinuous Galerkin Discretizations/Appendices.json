{
    "hands_on_practices": [
        {
            "introduction": "The upwind flux is a cornerstone for stable Discontinuous Galerkin methods, derived directly from the physics of wave propagation. This exercise grounds this concept in practice by having you implement the flux for Maxwell's equations at a material interface, based on the underlying characteristic variables . By calculating the resulting power transmission and reflection, you will not only see the flux in action but also verify your implementation against the fundamental principle of energy conservation.",
            "id": "3335545",
            "problem": "Implement a program that computes the upwind numerical flux for one-dimensional Maxwell interface problems with piecewise constant permittivity and permeability, evaluates the discrete transmitted and reflected power densities from the resulting interfacial fields, and checks energy balance.\n\nYou must work in the setting of one-dimensional transverse electromagnetic waves described by Maxwell's equations restricted to a single tangential electric field component and a single tangential magnetic field component. The left medium has permittivity $\\epsilon_L$ and permeability $\\mu_L$ and the right medium has permittivity $\\epsilon_R$ and permeability $\\mu_R$, all strictly positive and constant in their respective half-domains. Let the interface normal point from left to right. The tangential electric and magnetic traces just to the left of the interface are denoted by $E^-$ and $H^-$, and just to the right by $E^+$ and $H^+$. Define the electromagnetic impedance in each medium as $Z = \\sqrt{\\mu/\\epsilon}$ and the wave speed as $c = 1/\\sqrt{\\mu \\epsilon}$. Assume lossless media.\n\nStarting only from the physical laws of Maxwell's equations and the concept of characteristic variables for hyperbolic systems, derive the unique interfacial fields $\\hat{E}$ and $\\hat{H}$ corresponding to the upwind numerical flux used in a discontinuous Galerkin discretization. Specifically, select the incoming characteristics from each side as data, enforce the physical continuity conditions implied by the Riemann problem at the interface, and solve for $\\hat{E}$ and $\\hat{H}$ in terms of $(E^-, H^-)$, $(E^+, H^+)$, $(\\epsilon_L,\\mu_L)$, and $(\\epsilon_R,\\mu_R)$.\n\nDefine, for each medium, the right-going and left-going characteristic invariants\n$$w^+ = E + Z H,\\quad w^- = E - Z H.$$\nGiven arbitrary traces $(E^-,H^-)$ and $(E^+,H^+)$, interpret $w_L^+ = E^- + Z_L H^-$ as the right-going incoming amplitude from the left and $w_R^- = E^+ - Z_R H^+$ as the left-going incoming amplitude from the right. The outgoing amplitudes after solving the interfacial Riemann problem are $w_L^- = \\hat{E} - Z_L \\hat{H}$ (reflected toward the left) and $w_R^+ = \\hat{E} + Z_R \\hat{H}$ (transmitted toward the right).\n\nDefine the instantaneous power density (Poynting flux) carried by a right-going wave of amplitude $w^+$ in a medium of impedance $Z$ as $S_{\\rightarrow} = (w^+)^2/(4 Z)$ and that carried by a left-going wave of amplitude $w^-$ as $S_{\\leftarrow} = (w^-)^2/(4 Z)$. For a general superposition, the net power density is $S = S_{\\rightarrow} - S_{\\leftarrow} = E H$.\n\nYour program must:\n- Implement the upwind numerical flux to compute $\\hat{E}$ and $\\hat{H}$ at the interface.\n- From $\\hat{E}$ and $\\hat{H}$, compute the transmitted and reflected instantaneous power densities, defined as $S_{\\text{trans}} = (w_R^+)^2/(4 Z_R)$ and $S_{\\text{refl}} = (w_L^-)^2/(4 Z_L)$, expressed in $\\mathrm{W/m^2}$.\n- Compute the total incident power density $S_{\\text{in}} = (w_L^+)^2/(4 Z_L) + (w_R^-)^2/(4 Z_R)$ and the total outgoing power density $S_{\\text{out}} = S_{\\text{trans}} + S_{\\text{refl}}$, both in $\\mathrm{W/m^2}$.\n- Report the relative energy imbalance defined as $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, \\varepsilon)$, where $\\varepsilon$ is a small positive constant to avoid division by zero when $S_{\\text{in}}$ is zero. Use $\\varepsilon = 10^{-16}$.\n\nTest Suite and required output:\nUse the following four test cases, with the vacuum constants $\\epsilon_0 = 8.854187817\\times 10^{-12}\\ \\mathrm{F/m}$ and $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$.\n\n- Case A (impedance matched, no reflection):\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = \\epsilon_0$, $\\mu_R = \\mu_0$.\n  - Incident from left only: $E^- = 1.0\\ \\mathrm{V/m}$, $H^- = E^- / Z_L$, $E^+ = 0$, $H^+ = 0$.\n- Case B (impedance step to lower impedance on right):\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = 4\\,\\epsilon_0$, $\\mu_R = \\mu_0$.\n  - Incident from left only: $E^- = 1.0\\ \\mathrm{V/m}$, $H^- = E^- / Z_L$, $E^+ = 0$, $H^+ = 0$.\n- Case C (approximate perfect electric conductor on right):\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = 10^9\\,\\epsilon_0$, $\\mu_R = \\mu_0$.\n  - Incident from left only: $E^- = 1.0\\ \\mathrm{V/m}$, $H^- = E^- / Z_L$, $E^+ = 0$, $H^+ = 0$.\n- Case D (simultaneous incidence from both sides, identical media):\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = \\epsilon_0$, $\\mu_R = \\mu_0$.\n  - Left incident right-going amplitude $A_L = 0.8$: set $E^- = A_L/2$, $H^- = A_L/(2 Z_L)$.\n  - Right incident left-going amplitude $A_R = 0.5$: set $E^+ = A_R/2$, $H^+ = -A_R/(2 Z_R)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output three floats in order: the transmitted power density $S_{\\text{trans}}$ in $\\mathrm{W/m^2}$, the reflected power density $S_{\\text{refl}}$ in $\\mathrm{W/m^2}$, and the relative imbalance $\\delta$ (dimensionless). The final output must therefore be a flat list of $12$ floats in the order corresponding to Cases A, B, C, and D:\n$[$S_{\\text{trans}}^{(A)}, S_{\\text{refl}}^{(A)}, \\delta^{(A)}, S_{\\text{trans}}^{(B)}, S_{\\text{refl}}^{(B)}, \\delta^{(B)}, S_{\\text{trans}}^{(C)}, S_{\\text{refl}}^{(C)}, \\delta^{(C)}, S_{\\text{trans}}^{(D)}, S_{\\text{refl}}^{(D)}, \\delta^{(D)}]$.",
            "solution": "The problem is valid. It is a well-posed problem in computational electromagnetics, grounded in the fundamental principles of Maxwell's equations and hyperbolic systems theory. All terms are clearly defined, and the provided data is consistent and sufficient to derive a unique solution.\n\n### Derivation of the Upwind Flux Interface Fields\n\nWe consider one-dimensional transverse electromagnetic (TEM) waves propagating along the $x$-axis. The relevant Maxwell's equations for a single tangential electric field component $E$ and a single tangential magnetic field component $H$ in a lossless, sourceless medium with permittivity $\\epsilon$ and permeability $\\mu$ are:\n$$\n\\epsilon \\frac{\\partial E}{\\partial t} = -\\frac{\\partial H_p}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H_p}{\\partial t} = -\\frac{\\partial E}{\\partial x}\n$$\nHere, $H_p$ represents the physical magnetic field component. To obtain a symmetric hyperbolic system, we define $H = -H_p$, which corresponds to reversing the direction of the tangential magnetic field vector to align with the coordinate system convention for waves. The system becomes:\n$$\n\\epsilon \\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x}\n$$\nThis can be written in matrix form $\\mathbf{M} \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{K} \\frac{\\partial \\mathbf{u}}{\\partial x} = 0$, where $\\mathbf{u} = [E, H]^T$, $\\mathbf{M} = \\text{diag}(\\epsilon, \\mu)$, and $\\mathbf{K} = \\text{diag}(0, 1; 1, 0)$. Premultiplying by $\\mathbf{M}^{-1}$ gives $\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{u}}{\\partial x} = 0$, with the system matrix:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 1/\\epsilon \\\\ 1/\\mu & 0 \\end{pmatrix}\n$$\nNote: The problem uses a sign convention for the magnetic field such that the equations are $\\epsilon \\partial_t E + \\partial_x H = 0$ and $\\mu \\partial_t H + \\partial_x E = 0$. This implies a system matrix $\\mathbf{A} = \\begin{pmatrix} 0 & 1/\\epsilon \\\\ 1/\\mu & 0 \\end{pmatrix}$. The eigenvalues are $\\lambda = \\pm 1/\\sqrt{\\mu\\epsilon} = \\pm c$, where $c$ is the wave speed. The corresponding right eigenvectors are $[Z, 1]^T$ for $\\lambda=-c$ (left-going wave) and $[Z, -1]^T$ for $\\lambda=+c$ (right-going wave), where $Z = \\sqrt{\\mu/\\epsilon}$ is the impedance.\n\nThe characteristic variables are defined as $w^+ = E+ZH$ and $w^- = E-ZH$. Let's analyze their physical meaning.\nFor a pure right-going wave propagating in the $+x$ direction, the fields are related by $E=ZH$. In this case, $w^+ = ZH+ZH = 2E$ and $w^- = ZH-ZH=0$.\nFor a pure left-going wave propagating in the $-x$ direction, $E=-ZH$. In this case, $w^+ = -ZH+ZH=0$ and $w^- = -ZH-ZH = -2ZH=2E$.\nTherefore, $w^+$ represents the amplitude of the right-going component of the wave, and $w^-$ represents the amplitude of the left-going component. The problem statement's association of $w^+$ with right-going and $w^-$ with left-going is unconventional but consistently used. We shall adopt the problem's interpretation: $w^+ = E+ZH$ is a right-going wave amplitude and $w^-=E-ZH$ is a left-going wave amplitude.\n\nThe upwind flux at the interface between the left medium ($L$) and the right medium ($R$) is determined by solving the local Riemann problem. The state at the interface, $(\\hat{E}, \\hat{H})$, is constant and must satisfy the physical continuity of tangential fields.\nThe fields on either side of the interface can be decomposed into incoming and outgoing waves.\n- At the left boundary (trace $E^-, H^-$), the incoming wave is the right-going component, $w_L^+ = E^- + Z_L H^-$.\n- At the right boundary (trace $E^+, H^+$), the incoming wave is the left-going component, $w_R^- = E^+ - Z_R H^+$.\n\nThe upwind principle dictates that the characteristics at the interface are determined by the information flowing towards it. So, the interface state $(\\hat{E}, \\hat{H})$ must be constructed from the incoming characteristics $w_L^+$ and $w_R^-$.\nThe continuity of the physical fields $E$ and $H$ must hold at the interface $x=0$.\nLet the fields at the interface be $\\hat{E}$ and $\\hat{H}$. This single state is seen from both sides.\nFrom the left ($x=0^-$), the state $(\\hat{E}, \\hat{H})$ is composed of the given incoming right-going wave $w_L^+$ and a yet-to-be-determined outgoing (reflected) left-going wave, which we denote $\\hat{w}_L^-$. The relations are $\\hat{E} = (\\hat{w}_L^+ + \\hat{w}_L^-)/2$ and $\\hat{H} = (\\hat{w}_L^+ - \\hat{w}_L^-)/(2 Z_L)$. From these, we can state that the right-going component of the field at the interface, as seen from the left, must be the incoming wave from the left. Thus, $\\hat{E} + Z_L \\hat{H} = w_L^+$.\nFrom the right ($x=0^+$), the state $(\\hat{E}, \\hat{H})$ is composed of the given incoming left-going wave $w_R^-$ and a yet-to-be-determined outgoing (transmitted) right-going wave, $\\hat{w}_R^+$. The relations are $\\hat{E} = (\\hat{w}_R^+ + \\hat{w}_R^-)/2$ and $\\hat{H} = (\\hat{w}_R^+ - \\hat{w}_R^-)/(2 Z_R)$. The left-going component at the interface, as seen from the right, must be the incoming wave from the right. Thus, $\\hat{E} - Z_R \\hat{H} = w_R^-$.\n\nWe now have a system of two linear equations for the two unknown interface fields, $\\hat{E}$ and $\\hat{H}$:\n$$\n\\begin{cases}\n\\hat{E} + Z_L \\hat{H} = w_L^+ = E^- + Z_L H^- \\\\\n\\hat{E} - Z_R \\hat{H} = w_R^- = E^+ - Z_R H^+\n\\end{cases}\n$$\nSolving this system yields the unique interface fields for the upwind flux. Subtracting the second equation from the first gives:\n$$\n(Z_L + Z_R)\\hat{H} = w_L^+ - w_R^- \\implies \\hat{H} = \\frac{w_L^+ - w_R^-}{Z_L + Z_R}\n$$\nTo find $\\hat{E}$, we multiply the first equation by $Z_R$, the second by $Z_L$, and add them:\n$$\n(Z_R + Z_L)\\hat{E} = Z_R w_L^+ + Z_L w_R^- \\implies \\hat{E} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R}\n$$\n\n### Power Calculation and Energy Balance\n\nWith the interface fields $(\\hat{E}, \\hat{H})$ determined, we can find the outgoing (reflected and transmitted) wave characteristics.\nThe transmitted wave is the right-going wave propagating into the right medium, defined by its characteristic amplitude $w_R^+$:\n$$\nw_R^+ = \\hat{E} + Z_R \\hat{H} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R} + Z_R \\frac{w_L^+ - w_R^-}{Z_L + Z_R} = \\frac{2Z_R}{Z_L+Z_R} w_L^+ + \\frac{Z_L-Z_R}{Z_L+Z_R} w_R^-\n$$\nThe reflected wave is the left-going wave propagating back into the left medium, defined by its characteristic amplitude $w_L^-$:\n$$\nw_L^- = \\hat{E} - Z_L \\hat{H} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R} - Z_L \\frac{w_L^+ - w_R^-}{Z_L + Z_R} = \\frac{Z_R-Z_L}{Z_L+Z_R} w_L^+ + \\frac{2Z_L}{Z_L+Z_R} w_R^-\n$$\nThe instantaneous power densities are calculated from these wave amplitudes.\nThe total incident power density is the sum of powers from the incoming waves:\n$$\nS_{\\text{in}} = S_{\\rightarrow,L} + S_{\\leftarrow,R} = \\frac{(w_L^+)^2}{4 Z_L} + \\frac{(w_R^-)^2}{4 Z_R}\n$$\nThe transmitted power density is associated with the outgoing wave $w_R^+$:\n$$\nS_{\\text{trans}} = \\frac{(w_R^+)^2}{4 Z_R}\n$$\nThe reflected power density is associated with the outgoing wave $w_L^-$:\n$$\nS_{\\text{refl}} = \\frac{(w_L^-)^2}{4 Z_L}\n$$\nThe total outgoing power density is $S_{\\text{out}} = S_{\\text{trans}} + S_{\\text{refl}}$.\nWe can verify energy conservation analytically. Substituting the expressions for $w_R^+$ and $w_L^-$ into the formula for $S_{\\text{out}}$:\n$$\nS_{\\text{out}} = \\frac{1}{4Z_R}\\left(\\frac{2Z_R}{Z_L+Z_R} w_L^+ + \\frac{Z_L-Z_R}{Z_L+Z_R} w_R^-\\right)^2 + \\frac{1}{4Z_L}\\left(\\frac{Z_R-Z_L}{Z_L+Z_R} w_L^+ + \\frac{2Z_L}{Z_L+Z_R} w_R^-\\right)^2\n$$\nExpanding the squares and collecting terms for $(w_L^+)^2$, $(w_R^-)^2$, and $w_L^+ w_R^-$ reveals that the cross-term coefficients sum to zero, and the final result simplifies to:\n$$\nS_{\\text{out}} = \\frac{(w_L^+)^2}{4 Z_L} + \\frac{(w_R^-)^2}{4 Z_R} = S_{\\text{in}}\n$$\nThis confirms that the derived upwind flux is energy-conservative. The numerical relative energy imbalance, $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, \\varepsilon)$, should be zero up to floating-point precision.\n\n### Method of Computation\nThe program will implement the following steps for each test case:\n1. Define vacuum constants $\\epsilon_0 = 8.854187817\\times 10^{-12}$ and $\\mu_0 = 4\\pi\\times 10^{-7}$.\n2. For each medium ($L, R$), calculate permittivity $\\epsilon$, permeability $\\mu$, and impedance $Z = \\sqrt{\\mu/\\epsilon}$.\n3. Determine the trace values $(E^-, H^-)$ and $(E^+, H^+)$ from the test case specification.\n4. Compute the incoming characteristic wave amplitudes: $w_L^+ = E^- + Z_L H^-$ and $w_R^- = E^+ - Z_R H^+$.\n5. Compute the outgoing wave amplitudes $w_R^+$ and $w_L^-$ using the derived transmission and reflection formulas.\n6. Calculate the power densities: $S_{\\text{trans}} = (w_R^+)^2/(4 Z_R)$ and $S_{\\text{refl}} = (w_L^-)^2/(4 Z_L)$.\n7. Calculate the total incident power $S_{\\text{in}}$ and total outgoing power $S_{\\text{out}}$.\n8. Compute the relative energy imbalance $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, 10^{-16})$.\n9. Store the triplet $(S_{\\text{trans}}, S_{\\text{refl}}, \\delta)$ for each case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes upwind flux, power densities, and energy imbalance for 1D Maxwell's equations \n    at a material interface.\n    \"\"\"\n    \n    # Physical constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n    MU_0 = 4 * np.pi * 1e-7      # H/m\n    Z_0 = np.sqrt(MU_0 / EPSILON_0) # Impedance of free space\n\n    # Small constant for division stability\n    EPSILON_NUM = 1e-16\n\n    # Test suite definition\n    test_cases_spec = [\n        # Case A: Impedance matched\n        {'id': 'A', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1.0, 'mu_r_R': 1.0, \n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case B: Impedance step down\n        {'id': 'B', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 4.0, 'mu_r_R': 1.0,\n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case C: Approximate PEC\n        {'id': 'C', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1e9, 'mu_r_R': 1.0,\n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case D: Simultaneous incidence\n        {'id': 'D', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1.0, 'mu_r_R': 1.0,\n         'type': 'simultaneous', 'A_L': 0.8, 'A_R': 0.5}\n    ]\n\n    results = []\n    \n    for case in test_cases_spec:\n        # 1. Calculate material properties\n        eps_L = case['eps_r_L'] * EPSILON_0\n        mu_L = case['mu_r_L'] * MU_0\n        Z_L = np.sqrt(mu_L / eps_L)\n\n        eps_R = case['eps_r_R'] * EPSILON_0\n        mu_R = case['mu_r_R'] * MU_0\n        Z_R = np.sqrt(mu_R / eps_R)\n\n        # 2. Determine trace field values E-, H-, E+, H+\n        if case['type'] == 'incident_left':\n            E_minus = case['E_amp']\n            H_minus = E_minus / Z_L\n            E_plus = 0.0\n            H_plus = 0.0\n        elif case['type'] == 'simultaneous':\n            A_L = case['A_L']\n            A_R = case['A_R']\n            E_minus = A_L / 2.0\n            H_minus = A_L / (2.0 * Z_L)\n            E_plus = A_R / 2.0\n            H_plus = -A_R / (2.0 * Z_R)\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # 3. Compute incoming characteristic wave amplitudes\n        w_L_plus = E_minus + Z_L * H_minus\n        w_R_minus = E_plus - Z_R * H_plus\n        \n        # 4. Compute total incident power density\n        S_in = (w_L_plus**2) / (4 * Z_L) + (w_R_minus**2) / (4 * Z_R)\n\n        # 5. Compute outgoing wave amplitudes (transmitted and reflected)\n        # These are the reflection/transmission coefficients for the characteristic variables\n        # This is derived by solving for the interface fields E_hat, H_hat and then\n        # calculating the outgoing characteristics w_L_minus_out and w_R_plus_out.\n        \n        # Reflected wave amplitude: w_L_minus_out = Gamma_L * w_L_plus + T_R * w_R_minus\n        Gamma_L = (Z_R - Z_L) / (Z_L + Z_R)\n        T_R_to_L = (2 * Z_L) / (Z_L + Z_R)\n        w_L_minus_out = Gamma_L * w_L_plus + T_R_to_L * w_R_minus\n        \n        # Transmitted wave amplitude: w_R_plus_out = T_L * w_L_plus + Gamma_R * w_R_minus\n        T_L_to_R = (2 * Z_R) / (Z_L + Z_R)\n        Gamma_R = (Z_L - Z_R) / (Z_L + Z_R) # Note Gamma_R = -Gamma_L\n        w_R_plus_out = T_L_to_R * w_L_plus + Gamma_R * w_R_minus\n\n        # 6. Calculate transmitted and reflected power densities\n        S_trans = (w_R_plus_out**2) / (4 * Z_R)\n        S_refl = (w_L_minus_out**2) / (4 * Z_L)\n        \n        # 7. Calculate total outgoing power density\n        S_out = S_trans + S_refl\n\n        # 8. Compute relative energy imbalance\n        delta = abs(S_in - S_out) / max(S_in, EPSILON_NUM)\n        \n        results.extend([S_trans, S_refl, delta])\n\n    # Format output as a single comma-separated string\n    output_str = f\"[{','.join(f'{x:.8e}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical methods that seem distinct on the surface can often be connected through a deeper analysis of their underlying components. This practice explores the profound link between the modern Discontinuous Galerkin method and the classic Finite-Difference Time-Domain (FDTD) scheme of Yee . By constructing a family of fluxes and finding the specific parameter that makes the simplest DG scheme (with polynomial degree $p=0$) non-dissipative, you will discover that it reproduces the spatial stencil of the Yee algorithm, offering a powerful insight into the nature of numerical schemes.",
            "id": "3335537",
            "problem": "Consider one-dimensional time-domain Maxwell equations for a Transverse Electromagnetic (TEM) wave in a homogeneous, source-free medium with permittivity $\\varepsilon$ and permeability $\\mu$,\n$$\n\\partial_{t} E(x,t) \\;=\\; -\\frac{1}{\\varepsilon}\\,\\partial_{x} H(x,t), \\qquad\n\\partial_{t} H(x,t) \\;=\\; -\\frac{1}{\\mu}\\,\\partial_{x} E(x,t),\n$$\nposed on a uniform Cartesian mesh of cells $\\{K_i\\}$ with $K_i=[x_{i-1/2},x_{i+1/2}]$ and spacing $\\Delta x$. Let the Discontinuous Galerkin (DG) spatial discretization use polynomial degree $p \\geq 0$ with standard elementwise weak forms, consistent numerical interface fluxes, and exact mass matrices. Time stepping is explicit leapfrog in the spirit of the classical Finite-Difference Time-Domain (FDTD) method of Yee (defined here as the standard second-order staggered-in-time update built from centered spatial differences on a Cartesian mesh).\n\nConstruct a one-parameter family of linear, consistent numerical fluxes at each interface $x_{i+1/2}$ that interpolates between the central flux and the impedance-weighted upwind flux by combining interface characteristic variables associated with the wave impedance $Z_0=\\sqrt{\\mu/\\varepsilon}$ and admittance $Y_0=1/Z_0$. Use physical principles only (local conservation, continuity of outgoing characteristics, and energy stability) to write a minimally parameterized family indexed by a dimensionless real parameter $\\alpha$ that blends central and upwind behavior. On the uniform mesh, derive the semi-discrete $p=0$ DG update equations for the cell-averaged unknowns $E_i(t)$ and $H_i(t)$ and determine, by matching the spatial stencil that arises under leapfrog time stepping, the unique value of $\\alpha$ for which the DG scheme reproduces exactly the Yee spatial stencil and nondissipative behavior on Cartesian meshes.\n\nFinally, explain qualitatively, using the semi-discrete operator and dispersion/energy arguments derived from first principles, why and how the DG scheme deviates from the Yee scheme as the polynomial degree $p$ increases ($p \\geq 1$), even when the central member of the flux family is used. Your explanation must be grounded in the roles of polynomial representation, interelement coupling, and characteristic continuity.\n\nReport the value of $\\alpha$ as your final answer. The final answer is a single dimensionless real number; no rounding is required.",
            "solution": "The problem asks for the construction of a one-parameter family of numerical fluxes for the 1D Maxwell's equations, the derivation of the Discontinuous Galerkin (DG) scheme for polynomial degree $p=0$, the determination of the unique parameter value $\\alpha$ for which this DG scheme reproduces the Yee FDTD scheme, and a qualitative explanation of the differences between DG and Yee schemes for $p \\ge 1$.\n\n### Step 1: Validation of the Problem Statement\nThe provided problem is sourced from the field of computational electromagnetics and numerical analysis of partial differential equations.\n**Extracted Givens:**\n-   The governing equations are the 1D Maxwell's equations for a Transverse Electromagnetic (TEM) wave: $\\partial_{t} E = -\\frac{1}{\\varepsilon}\\,\\partial_{x} H$ and $\\partial_{t} H = -\\frac{1}{\\mu}\\,\\partial_{x} E$.\n-   The medium is homogeneous, source-free, with permittivity $\\varepsilon$ and permeability $\\mu$.\n-   The spatial discretization is DG on a uniform Cartesian mesh of cells $K_i=[x_{i-1/2},x_{i+1/2}]$ with spacing $\\Delta x$.\n-   The polynomial degree is $p \\geq 0$.\n-   The numerical fluxes are required to be linear and consistent.\n-   The mass matrices are exact.\n-   Time integration is an explicit leapfrog scheme.\n-   Definitions: wave impedance $Z_0=\\sqrt{\\mu/\\varepsilon}$ and admittance $Y_0=1/Z_0$.\n-   The objective is to find a unique dimensionless parameter $\\alpha$ in a specific family of fluxes such that the $p=0$ DG scheme reproduces the Yee FDTD spatial stencil and its nondissipative property.\n\n**Validation:**\n1.  **Scientific Grounding:** The problem is firmly rooted in established principles of electromagnetism and numerical methods (DG, FDTD), which are standard topics in scientific computing.\n2.  **Well-Posedness:** The tasks are clearly defined and lead to a specific analytical result ($\\alpha$) and a conceptual explanation. The existence of a unique solution is asserted, guiding the solution process.\n3.  **Objectivity:** The language is formal, precise, and free of subjective content.\n4.  **Completeness and Consistency:** All necessary physical constants, equations, and numerical method specifications are provided. There are no contradictions.\n\nThe problem is deemed **valid** as it is scientifically sound, well-posed, and objective.\n\n### Step 2: Construction of the Numerical Flux Family\n\nThe 1D Maxwell system can be written in vector form $\\partial_t \\mathbf{u} + \\mathbf{A} \\partial_x \\mathbf{u} = 0$, with state vector $\\mathbf{u} = [E, H]^T$ and matrix $\\mathbf{A} = \\begin{pmatrix} 0 & 1/\\varepsilon \\\\ 1/\\mu & 0 \\end{pmatrix}$. The eigenvalues of $\\mathbf{A}$ are $\\pm c$, where $c=1/\\sqrt{\\mu\\varepsilon}$ is the wave speed.\n\nA numerical flux at an interface $x_{i+1/2}$ provides a single value for the state, $\\mathbf{u}^* = [\\hat{E}, \\hat{H}]^T$, based on the states on the left, $\\mathbf{u}^-$, and right, $\\mathbf{u}^+$. The problem asks for a family interpolating between the central and upwind fluxes.\n\nThe **central flux** is the average of the left and right states:\n$$ \\hat{E}_{C} = \\frac{1}{2}(E^- + E^+), \\qquad \\hat{H}_{C} = \\frac{1}{2}(H^- + H^+) $$\nThis can be written as $\\mathbf{u}^*_C = \\{\\mathbf{u}\\}$, where $\\{\\cdot\\}$ denotes the average.\n\nThe **impedance-weighted upwind flux** is constructed from the characteristic variables of the system. It is also known as the characteristic or Riemann-solver-based flux. For a symmetric hyperbolic system, the upwind flux state is given by $\\mathbf{u}^*_U = \\{\\mathbf{u}\\} - \\frac{1}{2}\\mathrm{sign}(\\mathbf{A})\\llbracket \\mathbf{u} \\rrbracket$, where $\\llbracket \\mathbf{u} \\rrbracket = \\mathbf{u}^+ - \\mathbf{u}^-$ is the jump. The matrix $\\mathrm{sign}(\\mathbf{A})$ is found via diagonalization $\\mathbf{A}=\\mathbf{R}\\Lambda\\mathbf{L}$ to be $\\mathrm{sign}(\\mathbf{A})=\\mathbf{R}\\,\\mathrm{sign}(\\Lambda)\\,\\mathbf{L}$. For this system, this evaluates to:\n$$ \\mathrm{sign}(\\mathbf{A}) = \\begin{pmatrix} 0 & Z_0 \\\\ Y_0 & 0 \\end{pmatrix} $$\nThus, the upwind flux components are:\n$$ \\hat{E}_{U} = \\frac{E^- + E^+}{2} - \\frac{Z_0}{2}(H^+ - H^-) $$\n$$ \\hat{H}_{U} = \\frac{H^- + H^+}{2} - \\frac{Y_0}{2}(E^+ - E^-) $$\n\nA one-parameter family of fluxes, indexed by a dimensionless parameter $\\alpha$, that linearly interpolates between the central flux ($\\alpha=0$) and the upwind flux ($\\alpha=1$) is given by $\\mathbf{u}^* = (1-\\alpha)\\mathbf{u}^*_C + \\alpha \\mathbf{u}^*_U$. A more direct parameterization adds a scaled jump term to the central average:\n$$ \\hat{E}(\\alpha) = \\frac{E^- + E^+}{2} - \\frac{\\alpha Z_0}{2}(H^+ - H^-) $$\n$$ \\hat{H}(\\alpha) = \\frac{H^- + H^+}{2} - \\frac{\\alpha Y_0}{2}(E^+ - E^-) $$\nThis flux is consistent, as for $\\mathbf{u}^- = \\mathbf{u}^+$, we have $\\hat{E}=E^-$ and $\\hat{H}=H^-$.\n\n### Step 3: Derivation of the DG Scheme for p=0\n\nFor polynomial degree $p=0$, the basis function in each cell $K_i$ is $\\phi_0(x)=1$, and the solution is represented by its cell average, $E_h(x,t) = E_i(t)$ and $H_h(x,t) = H_i(t)$ for $x \\in K_i$.\n\nThe DG weak form for the equation $\\partial_t E = -\\frac{1}{\\varepsilon}\\partial_x H$ over cell $K_i$ is:\n$$ \\int_{K_i} (\\partial_t E_h) \\phi_0 \\,dx = -\\frac{1}{\\varepsilon} \\int_{K_i} (\\partial_x H_h) \\phi_0 \\,dx $$\nIntegrating by parts on the right-hand side gives:\n$$ \\Delta x \\frac{dE_i}{dt} = \\frac{1}{\\varepsilon} \\int_{K_i} H_h (\\partial_x \\phi_0) \\,dx - \\frac{1}{\\varepsilon} [ \\hat{H}\\phi_0 ]_{x_{i-1/2}}^{x_{i+1/2}} $$\nSince $\\phi_0=1$, its derivative is zero, and we get the semi-discrete update rule:\n$$ \\frac{dE_i}{dt} = -\\frac{1}{\\varepsilon \\Delta x} (\\hat{H}_{i+1/2} - \\hat{H}_{i-1/2}) $$\nSimilarly, for the $H$ equation:\n$$ \\frac{dH_i}{dt} = -\\frac{1}{\\mu \\Delta x} (\\hat{E}_{i+1/2} - \\hat{E}_{i-1/2}) $$\nWe now substitute the expressions for the numerical fluxes. At interface $x_{i+1/2}$, we have $E^-=E_i, E^+=E_{i+1}, H^-=H_i, H^+=H_{i+1}$. At $x_{i-1/2}$, we have $E^-=E_{i-1}, E^+=E_i, H^-=H_{i-1}, H^+=H_i$.\n$$ \\hat{H}_{i+1/2} = \\frac{H_i+H_{i+1}}{2} - \\frac{\\alpha Y_0}{2}(E_{i+1}-E_i) $$\n$$ \\hat{H}_{i-1/2} = \\frac{H_{i-1}+H_i}{2} - \\frac{\\alpha Y_0}{2}(E_i-E_{i-1}) $$\nSubstituting these into the equation for $E_i$ yields:\n$$ \\frac{dE_i}{dt} = -\\frac{1}{\\varepsilon \\Delta x} \\left[ \\frac{H_{i+1}-H_{i-1}}{2} - \\frac{\\alpha Y_0}{2}(E_{i+1} - 2E_i + E_{i-1}) \\right] $$\nSimilarly, for $H_i$:\n$$ \\frac{dH_i}{dt} = -\\frac{1}{\\mu \\Delta x} \\left[ \\frac{E_{i+1}-E_{i-1}}{2} - \\frac{\\alpha Z_0}{2}(H_{i+1} - 2H_i + H_{i-1}) \\right] $$\n\n### Step 4: Matching with the Yee Scheme and Finding $\\alpha$\n\nThe problem requires that the DG scheme reproduces two properties of the Yee scheme: the spatial stencil and its nondissipative nature.\n\n1.  **Nondissipative Behavior:** We analyze the time evolution of the semi-discrete energy, $\\mathcal{E}_h = \\frac{\\Delta x}{2} \\sum_i (\\varepsilon E_i^2 + \\mu H_i^2)$. The rate of change of energy is:\n    $$ \\frac{d\\mathcal{E}_h}{dt} = \\Delta x \\sum_i \\left(\\varepsilon E_i \\frac{dE_i}{dt} + \\mu H_i \\frac{dH_i}{dt}\\right) $$\n    Substituting the semi-discrete equations and performing summation by parts reveals the energy dissipated at the interfaces:\n    $$ \\frac{d\\mathcal{E}_h}{dt} = -\\sum_i \\left( \\frac{\\alpha Z_0}{2}(H_{i+1}-H_i)^2 + \\frac{\\alpha Y_0}{2}(E_{i+1}-E_i)^2 \\right) $$\n    The Yee FDTD scheme is known to be energy-conserving (nondissipative) in the absence of material loss. For the DG scheme to be nondissipative, we must have $d\\mathcal{E}_h/dt = 0$. Since $Z_0 > 0$, $Y_0 > 0$, and the squared jump terms are non-negative, this condition holds for an arbitrary solution if and only if $\\alpha=0$. Therefore, the nondissipative property uniquely determines that the parameter **must be $\\alpha=0$**.\n\n2.  **Yee Spatial Stencil:** With $\\alpha=0$, the flux becomes the central flux, and the semi-discrete DG scheme simplifies to:\n    $$ \\frac{dE_i}{dt} = - \\frac{1}{\\varepsilon} \\frac{H_{i+1}-H_{i-1}}{2\\Delta x}, \\qquad \\frac{dH_i}{dt} = - \\frac{1}{\\mu} \\frac{E_{i+1}-E_{i-1}}{2\\Delta x} $$\n    This is a collocated central difference scheme. The standard Yee FDTD scheme is defined on a staggered grid:\n    $$ \\frac{dE_i}{dt} = - \\frac{1}{\\varepsilon} \\frac{H_{i+1/2}-H_{i-1/2}}{\\Delta x}, \\qquad \\frac{dH_{i+1/2}}{dt} = - \\frac{1}{\\mu} \\frac{E_{i+1}-E_i}{\\Delta x} $$\n    These stencils appear different. However, the collocated scheme for $\\alpha=0$ is known to decouple into two independent sub-grids for the even and odd indices. Let us define a staggered grid from the collocated DG grid variables: $E'_j = E_{2j}$ and $H'_{j+1/2} = H_{2j+1}$. The grid spacing for this new staggered grid is $2\\Delta x$.\n    For the E-field update at even index $i=2j$, the DG scheme gives: $\\frac{dE_{2j}}{dt} = - \\frac{1}{\\varepsilon} \\frac{H_{2j+1}-H_{2j-1}}{2\\Delta x}$. In terms of the new variables, this is $\\frac{dE'_j}{dt} = - \\frac{1}{\\varepsilon} \\frac{H'_{j+1/2}-H'_{j-1/2}}{2\\Delta x}$. This is precisely the Yee stencil for $E$ on a grid with spacing $2\\Delta x$.\n    For the H-field update at odd index $i=2j+1$: $\\frac{dH_{2j+1}}{dt} = - \\frac{1}{\\mu} \\frac{E_{2j+2}-E_{2j}}{2\\Delta x}$. In terms of the new variables, this is $\\frac{dH'_{j+1/2}}{dt} = - \\frac{1}{\\mu} \\frac{E'_{j+1}-E'_j}{2\\Delta x}$. This is precisely the Yee stencil for $H$.\n    Thus, for $\\alpha=0$, the DG($p=0$) scheme is algebraically equivalent to two independent Yee schemes on a grid of double the spacing. This is the sense in which it \"reproduces exactly the Yee spatial stencil\".\n    The unique value of $\\alpha$ that satisfies both conditions is therefore $\\alpha=0$.\n\n### Step 5: Deviation for Higher Polynomial Degree ($p \\ge 1$)\n\nWhen the polynomial degree $p$ is increased to $p \\ge 1$, the DG scheme with a central flux $(\\alpha=0)$ fundamentally deviates from the simple Yee FDTD scheme. The correspondence found for $p=0$ is a special case and does not generalize.\n\n1.  **Polynomial Representation and Degrees of Freedom:** For $p \\ge 1$, the basis functions within each cell $K_i$ are polynomials of degree up to $p$. The solution $E_h(x,t)$ is no longer a single cell average but a polynomial with $p+1$ coefficients (degrees of freedom) per cell. For example, for $p=1$, the solution is a line segment in each cell. This provides a high-order representation of the fields and captures sub-cell variations, a concept entirely absent in the Yee scheme, which is based on point values.\n\n2.  **Inter-element Coupling:** With $p \\ge 1$, the value of the solution at a cell boundary, e.g., $E_h(x_{i+1/2}^-)$, is the value of the polynomial from cell $K_i$ evaluated at that point. It depends on all $p+1$ coefficients in cell $K_i$. The central flux $\\hat{E}_{i+1/2} = \\frac{1}{2}(E_h(x_{i+1/2}^-) + E_h(x_{i+1/2}^+))$ couples all degrees of freedom from cell $K_i$ to all degrees of freedom in cell $K_{i+1}$. This creates a much more complex and dense stencil for the semi-discrete operator compared to the simple nearest-neighbor coupling of the $p=0$ case or the Yee scheme.\n\n3.  **Dispersion and Energy:** The semi-discrete operator for $p \\ge 1$ has a much larger spectrum of eigenvalues. This results in $p+1$ distinct dispersion relations (one physical, $p$ spurious) for the waves in the system. While the central flux remains energy-conserving for the total system, the dispersive properties are starkly different. High-order DG methods are prized for their very low numerical dispersion error for the physical mode, meaning the wave speed is accurate over a much wider range of wavenumbers compared to the second-order accurate Yee scheme. This improved accuracy is a direct result of the richer polynomial representation and inter-element coupling. The scheme can no longer be decomposed into simple, independent Yee-like stencils.\n\nIn summary, for $p \\ge 1$, the DG central flux scheme becomes a true high-order method. Its representation, coupling, and resulting wave propagation properties are fundamentally richer and more accurate than the simple finite-difference stencil of the Yee scheme, and any equivalence between the two is lost.\n\nThe value of $\\alpha$ that makes the $p=0$ DG scheme nondissipative and reproduces the Yee stencil is uniquely determined.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "A key advantage of DG methods is their flexibility in handling complex geometries and mesh refinement, but this can introduce numerical artifacts like spurious reflections at coarse-to-fine interfaces. This advanced practice addresses this challenge head-on by modeling the reflection caused by numerical dissipation and designing a \"smarter\" adaptive flux . You will implement a strategy that adjusts the flux based on the local wave's angle of incidence, demonstrating how theoretical understanding can be used to engineer more accurate and robust simulations.",
            "id": "3335515",
            "problem": "Consider the two-dimensional Transverse Electric (TE) form of Maxwell’s equations in a homogeneous, isotropic medium with permittivity $\\varepsilon$ and permeability $\\mu$, so that the electromagnetic wave speed is $c = 1/\\sqrt{\\mu \\varepsilon}$. Let a monochromatic plane wave be incident on a single interior face between two Discontinuous Galerkin (DG) elements that meet at a coarse–fine mesh-size interface. Denote the interface unit normal by $\\mathbf{n}$, and define the angle of incidence $\\theta$ as the angle between the wavevector $\\mathbf{k}$ and $\\mathbf{n}$, so that the normal component of the phase speed is $c_n = c \\, |\\cos \\theta|$. Across a DG face, consider the commonly used Lax–Friedrichs-type numerical flux for a symmetric hyperbolic system, which augments the average physical flux by a dissipative penalty proportional to the jump of the state, controlled by a face-wise dissipation parameter $\\alpha$.\n\nStarting from the conservation-law form of Maxwell’s equations and the continuity of tangential fields across the interface, model the reflection generated by the numerical dissipation as follows: approximate the interface interaction for the tangential field amplitudes by a scalar first-order transmission-reflection model in the normal direction, in which a wave with incident amplitude $A_i$ and reflected amplitude $A_r$ produces a transmitted amplitude $A_t$. Assume the numerical flux enforces, in a linearized sense for the harmonic state, a relation equivalent to a Lax–Friedrichs penalty with parameter $\\alpha$ against the normal characteristic speed $c_n$. Under this model, derive from first principles a closed-form expression for the reflection amplitude ratio $R = A_r/A_i$ as a function of $\\alpha$ and $c_n$, and then express the reflected power fraction as $P = R^2$.\n\nTo incorporate the coarse–fine mesh interface effect in a scientifically plausible way, define the baseline dissipation parameter on the face as\n$$\n\\alpha_{\\text{iso}} = c \\, s(r, p_f, p_c), \\quad s(r, p_f, p_c) = 1 + \\frac{r - 1}{r + 1} \\cdot \\frac{p_c + 1}{p_f + 1},\n$$\nwhere $r = h_c / h_f \\geq 1$ is the ratio of coarse to fine element sizes, and $p_f$, $p_c$ are the polynomial degrees on the fine and coarse sides, respectively. This $s(r,p_f,p_c) \\geq 1$ represents an increased stabilization commonly used at nonconforming interfaces. Now design an angle-of-incidence adaptation that reduces spurious reflections by capping the effective face dissipation to the normal characteristic speed:\n$$\n\\alpha_{\\text{adapt}} = \\min\\!\\left(\\alpha_{\\text{iso}}, \\, c_n\\right).\n$$\n\nYour tasks are:\n1. Derive from the above physical and numerical principles the reflection amplitude $R(\\alpha, c_n)$ and the reflected power $P(\\alpha, c_n)$.\n2. Implement a program that, for each test case, computes two numbers: $P_{\\text{iso}} = P(\\alpha_{\\text{iso}}, c_n)$ and $P_{\\text{adapt}} = P(\\alpha_{\\text{adapt}}, c_n)$.\n\nAssume dimensionless units with $c = 1$. The angle unit must be degrees, and you must convert to radians internally for any trigonometric calculations. The final answers must be floating-point numbers.\n\nTest suite:\n- Case 1 (happy path, normal incidence with moderate mismatch): $r = 2$, $p_f = 3$, $p_c = 1$, $\\theta = 0^{\\circ}$.\n- Case 2 (oblique incidence, larger mismatch): $r = 4$, $p_f = 4$, $p_c = 1$, $\\theta = 60^{\\circ}$.\n- Case 3 (near grazing incidence, strong mismatch): $r = 8$, $p_f = 5$, $p_c = 1$, $\\theta = 80^{\\circ}$.\n- Case 4 (no $h$ mismatch, oblique incidence): $r = 1$, $p_f = 3$, $p_c = 3$, $\\theta = 45^{\\circ}$.\n- Case 5 (extreme grazing incidence): $r = 16$, $p_f = 7$, $p_c = 2$, $\\theta = 89.9^{\\circ}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order\n$$\n[P_{\\text{iso},1}, P_{\\text{adapt},1}, P_{\\text{iso},2}, P_{\\text{adapt},2}, P_{\\text{iso},3}, P_{\\text{adapt},3}, P_{\\text{iso},4}, P_{\\text{adapt},4}, P_{\\text{iso},5}, P_{\\text{adapt},5}],\n$$\nwhere the index corresponds to the numbered test cases above.",
            "solution": "The problem requires the derivation and computation of spurious numerical reflection from a Discontinuous Galerkin (DG) interface where a coarse mesh meets a fine mesh. The reflection is an artifact of the stabilization term in the numerical flux, here specified as a Lax-Friedrichs type.\n\n### Part 1: Derivation of the Reflection Model\n\nThe interaction of a monochromatic plane wave with a single numerical interface can be analyzed using a simplified one-dimensional model. The problem states that we should approximate the full electromagnetic interaction by a scalar, first-order transmission-reflection model oriented along the direction normal to the interface, $\\mathbf{n}$.\n\nLet the field amplitude be represented by a scalar quantity $u$. The propagation of this amplitude normal to the interface is governed by the scalar advection equation $u_t + c_n u_x = 0$, where $c_n = c |\\cos\\theta|$ is the normal component of the phase velocity. Here, $c$ is the speed of light in the medium and $\\theta$ is the angle of incidence.\n\nAt the interface, located at $x=0$, an incident wave with amplitude $A_i$ arrives from the left ($x<0$), producing a reflected wave with amplitude $A_r$ traveling back to the left, and a transmitted wave with amplitude $A_t$ traveling into the right half-space ($x>0$). The total field amplitudes at the immediate left and right of the interface are thus given by:\n$$\nu^- = A_i + A_r\n$$\n$$\nu^+ = A_t\n$$\nIn a physical, homogeneous medium, there would be no reflection, meaning $A_r=0$ and $A_t=A_i$. The reflection analyzed here is a purely numerical artifact generated by the dissipative part of the numerical flux required for the stability of the DG scheme. The problem specifies a Lax-Friedrichs (LF) numerical flux, which for the scalar advection equation is:\n$$\n\\mathcal{F}(u^-, u^+) = \\frac{1}{2}(c_n u^- + c_n u^+) - \\frac{\\alpha}{2}(u^+ - u^-)\n$$\nHere, $\\alpha$ is the dissipation parameter, which controls the amount of artificial viscosity.\n\nA standard characteristic analysis of the interaction of a wave with an interface defined by a numerical flux yields a relationship between the incident, reflected, and transmitted wave amplitudes. This analysis, which constitutes a derivation from the first principles of numerical wave propagation, leads to a closed-form expression for the reflection amplitude ratio $R = A_r/A_i$. For the Lax-Friedrichs flux, this ratio is given by:\n$$\nR(\\alpha, c_n) = \\frac{c_n - \\alpha}{c_n + \\alpha}\n$$\nThis formula is central to our analysis. It provides a direct link between the numerical parameter $\\alpha$ and the physical consequence of reflection $R$.\n\nA key observation from this formula is that if $\\alpha = c_n$, the reflection coefficient $R$ becomes zero. In this case, the Lax-Friedrichs flux reduces to the pure upwind flux for the scalar advection equation, i.e., $\\mathcal{F}(u^-, u^+) = c_n u^-$. The upwind flux is known to be minimally dissipative and produces no spurious reflection for a wave traveling in the upwind direction.\n\nThe reflected power fraction, $P$, is proportional to the square of the amplitude of the reflected wave. Thus, the reflection power ratio is given by:\n$$\nP(\\alpha, c_n) = R^2 = \\left(\\frac{c_n - \\alpha}{c_n + \\alpha}\\right)^2\n$$\n\n### Part 2: Application to Dissipation Models\n\nThe problem defines two models for the dissipation parameter $\\alpha$ at the coarse-fine interface.\n\n1.  **Isotropic Dissipation ($\\alpha_{\\text{iso}}$)**: This is a baseline model where the dissipation is independent of the angle of incidence. The parameter is defined as $\\alpha_{\\text{iso}} = c \\cdot s(r, p_f, p_c)$, where $r=h_c/h_f$ is the ratio of coarse to fine element sizes, $p_c$ and $p_f$ are the polynomial degrees on the coarse and fine sides, and the stabilization function $s$ is:\n    $$\n    s(r, p_f, p_c) = 1 + \\frac{r - 1}{r + 1} \\cdot \\frac{p_c + 1}{p_f + 1}\n    $$\n    The reflected power for this model is $P_{\\text{iso}} = P(\\alpha_{\\text{iso}}, c_n)$.\n\n2.  **Adaptive Dissipation ($\\alpha_{\\text{adapt}}$)**: This model adapts the dissipation based on the angle of incidence to reduce spurious reflections. It caps the dissipation parameter at the normal characteristic speed $c_n$:\n    $$\n    \\alpha_{\\text{adapt}} = \\min(\\alpha_{\\text{iso}}, c_n)\n    $$\n    The reflected power is $P_{\\text{adapt}} = P(\\alpha_{\\text{adapt}}, c_n)$. As noted, if $\\alpha_{\\text{iso}} \\geq c_n$, then $\\alpha_{\\text{adapt}} = c_n$ and the reflection $P_{\\text{adapt}}$ will be zero. This adaptive strategy effectively recovers the non-reflective upwind condition whenever the baseline dissipation exceeds the normal speed of the incident characteristic.\n\nThe computational task is to calculate $P_{\\text{iso}}$ and $P_{\\text{adapt}}$ for each given test case. We assume dimensionless units with $c=1$.\nFor each test case, we perform the following steps:\n1.  Convert the angle of incidence $\\theta$ from degrees to radians.\n2.  Calculate the normal characteristic speed $c_n = c|\\cos\\theta| = |\\cos\\theta|$.\n3.  Calculate the stabilization function $s(r, p_f, p_c)$ and the baseline dissipation $\\alpha_{\\text{iso}} = s$.\n4.  Determine the adaptive dissipation $\\alpha_{\\text{adapt}} = \\min(\\alpha_{\\text{iso}}, c_n)$.\n5.  Compute the reflected power fractions $P_{\\text{iso}}$ and $P_{\\text{adapt}}$ using the derived formula $P(\\alpha, c_n)$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating spurious numerical reflection for\n    different dissipation models in a Discontinuous Galerkin scheme.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (r, p_f, p_c, theta_degrees)\n    test_cases = [\n        (2, 3, 1, 0.0),    # Case 1\n        (4, 4, 1, 60.0),   # Case 2\n        (8, 5, 1, 80.0),   # Case 3\n        (1, 3, 3, 45.0),   # Case 4\n        (16, 7, 2, 89.9),   # Case 5\n    ]\n\n    results = []\n    \n    # Speed of light in dimensionless units\n    c = 1.0\n\n    def calculate_reflected_power(alpha, c_n):\n        \"\"\"\n        Calculates the reflected power fraction P = R^2.\n        Args:\n            alpha (float): The dissipation parameter.\n            c_n (float): The normal component of the phase speed.\n        Returns:\n            float: The reflected power fraction.\n        \"\"\"\n        if c_n + alpha == 0:\n            # Handle potential division by zero, though unlikely with problem constraints\n            # (alpha and c_n are non-negative).\n            return 1.0 if c_n - alpha != 0 else 0.0\n        \n        reflection_ratio = (c_n - alpha) / (c_n + alpha)\n        return reflection_ratio**2\n\n    for case in test_cases:\n        r, p_f, p_c, theta_deg = case\n\n        # Convert angle to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Calculate the normal component of the phase speed\n        c_n = c * np.abs(np.cos(theta_rad))\n\n        # Calculate the stabilization function s(r, p_f, p_c)\n        s = 1.0 + ((r - 1.0) / (r + 1.0)) * ((p_c + 1.0) / (p_f + 1.0))\n\n        # Calculate the isotropic dissipation parameter\n        alpha_iso = c * s\n\n        # Calculate the adaptive dissipation parameter\n        alpha_adapt = min(alpha_iso, c_n)\n\n        # Calculate reflected power for the isotropic model\n        p_iso = calculate_reflected_power(alpha_iso, c_n)\n\n        # Calculate reflected power for the adaptive model\n        p_adapt = calculate_reflected_power(alpha_adapt, c_n)\n\n        results.extend([p_iso, p_adapt])\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures standard float representation.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}