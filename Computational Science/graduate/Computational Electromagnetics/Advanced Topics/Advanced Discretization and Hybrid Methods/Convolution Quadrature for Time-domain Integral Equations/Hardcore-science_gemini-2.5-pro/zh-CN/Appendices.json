{
    "hands_on_practices": [
        {
            "introduction": "卷积求积方法的核心在于其权重 $\\omega_n$，这些权重是连续卷积核的离散化表示。本练习将通过一个基础而重要的案例，指导您直接从生成函数出发，解析推导这些权重 。通过分析权重的渐近衰减行为，您将深入理解其性质如何直接影响数值解的长期稳定性，这是保证时域积分方程模拟结果物理真实性的关键。",
            "id": "3322767",
            "problem": "用于电磁散射的时域积分方程（TDIE）可以写成时间上的因果沃尔泰拉卷积形式，其中未知场与一个核函数进行卷积，该核函数的拉普拉斯变换是一个传递函数。对此类卷积进行稳定的长时间离散化的一种经过充分检验的方法是卷积求积（CQ），它由一个底层的单步法通过相应的离散符号生成。对于梯形法则（也称为隐式中点法），其离散符号由有理函数 $\\delta(\\zeta)=2(1-\\zeta)/(1+\\zeta)$ 给出。考虑一个标量TDIE卷积，其传递函数为 $Z(s)=1/\\sqrt{s}$。使用时间步长 $\\Delta t=1$ 的CQ方法，CQ权重 $\\{\\omega_{n}\\}_{n\\geq 0}$ 由生成函数 $\\sum_{n=0}^{\\infty}\\omega_{n}\\zeta^{n}=Z\\!\\left(\\delta(\\zeta)/\\Delta t\\right)$ 隐式定义，该函数编码了对于因果输入的离散时间样本 $\\{f_{n}\\}$ 的因果离散卷积 $u_{n}=\\sum_{j=0}^{n}\\omega_{j} f_{n-j}$。\n\n从卷积及其拉普拉斯变换的基本定义出发，并利用CQ生成函数的特征，为上述选择的 $\\delta(\\zeta)$、 $Z(s)$ 和 $\\Delta t$ 推导出前三个CQ权重 $\\omega_{0}$、 $\\omega_{1}$ 和 $\\omega_{2}$ 的精确闭式表达式。然后，通过识别生成函数的主导奇点，并应用解析组合学中的转换原理，分析当 $n\\to\\infty$ 时 $\\omega_{n}$ 的渐近衰减率，以推断 $\\omega_{n}$ 的主阶行为。解释这些权重的符号和衰减如何与TDIE离散化中的晚期不稳定性抑制相关。\n\n将这三个权重表示为精确的解析表达式。最终答案必须是包含 $\\omega_{0}$、 $\\omega_{1}$ 和 $\\omega_{2}$ 的单行矩阵。无需四舍五入。",
            "solution": "该问题具有科学依据，提法恰当且客观。所有必要信息均已提供，且无内部矛盾。时域积分方程（TDIE）、卷积求积（CQ）、生成函数和传递函数等概念在计算电磁学和数值分析中是标准概念。因此，该问题被认为是有效的，并将提供解答。\n\n问题的核心在于分析生成函数 $G(\\zeta) = \\sum_{n=0}^{\\infty}\\omega_{n}\\zeta^{n}$ 的幂级数展开的系数。该函数定义为 $G(\\zeta) = Z(\\delta(\\zeta)/\\Delta t)$。\n\n首先，我们为这个问题构建特定的生成函数。给定条件如下：\n- 传递函数：$Z(s) = 1/\\sqrt{s} = s^{-1/2}$。\n- 梯形法则的离散符号：$\\delta(\\zeta) = 2(1-\\zeta)/(1+\\zeta)$。\n- 时间步长：$\\Delta t = 1$。\n\n将这些代入定义，我们得到生成函数 $G(\\zeta)$：\n$$\nG(\\zeta) = Z\\left(\\frac{\\delta(\\zeta)}{\\Delta t}\\right) = Z(\\delta(\\zeta)) = \\left( \\frac{2(1-\\zeta)}{1+\\zeta} \\right)^{-1/2} = \\sqrt{\\frac{1+\\zeta}{2(1-\\zeta)}}\n$$\n这可以重写为：\n$$\nG(\\zeta) = \\frac{1}{\\sqrt{2}} (1+\\zeta)^{1/2} (1-\\zeta)^{-1/2}\n$$\nCQ权重 $\\{\\omega_n\\}_{n \\ge 0}$ 是 $G(\\zeta)$ 的麦克劳林级数的系数：\n$$\nG(\\zeta) = \\omega_0 + \\omega_1 \\zeta + \\omega_2 \\zeta^2 + \\dots\n$$\n\n为了求得前三个权重 $\\omega_0$、 $\\omega_1$ 和 $\\omega_2$，我们将 $G(\\zeta)$ 在 $\\zeta=0$ 附近展开为幂级数。我们使用广义二项式定理 $(1+x)^{\\alpha} = \\sum_{k=0}^{\\infty} \\binom{\\alpha}{k} x^k$。\n\n$(1+\\zeta)^{1/2}$ 的展开式为：\n$$\n(1+\\zeta)^{1/2} = \\binom{1/2}{0} + \\binom{1/2}{1}\\zeta + \\binom{1/2}{2}\\zeta^2 + O(\\zeta^3) = 1 + \\frac{1}{2}\\zeta + \\frac{\\frac{1}{2}(\\frac{1}{2}-1)}{2!}\\zeta^2 + O(\\zeta^3) = 1 + \\frac{1}{2}\\zeta - \\frac{1}{8}\\zeta^2 + O(\\zeta^3)\n$$\n$(1-\\zeta)^{-1/2}$ 的展开式为：\n$$\n(1-\\zeta)^{-1/2} = \\binom{-1/2}{0} + \\binom{-1/2}{1}(-\\zeta) + \\binom{-1/2}{2}(-\\zeta)^2 + O(\\zeta^3)\n$$\n系数为：\n$\\binom{-1/2}{0} = 1$\n$\\binom{-1/2}{1} = -1/2$\n$\\binom{-1/2}{2} = \\frac{-\\frac{1}{2}(-\\frac{1}{2}-1)}{2!} = \\frac{-\\frac{1}{2}(-\\frac{3}{2})}{2} = \\frac{3}{8}$\n所以展开式为：\n$$\n(1-\\zeta)^{-1/2} = 1 + (-\\frac{1}{2})(-\\zeta) + (\\frac{3}{8})(-\\zeta)^2 + O(\\zeta^3) = 1 + \\frac{1}{2}\\zeta + \\frac{3}{8}\\zeta^2 + O(\\zeta^3)\n$$\n现在我们将这两个级数与前置因子 $1/\\sqrt{2}$ 相乘：\n$$\nG(\\zeta) = \\frac{1}{\\sqrt{2}} \\left( 1 + \\frac{1}{2}\\zeta - \\frac{1}{8}\\zeta^2 + \\dots \\right) \\left( 1 + \\frac{1}{2}\\zeta + \\frac{3}{8}\\zeta^2 + \\dots \\right)\n$$\n我们按 $\\zeta$ 的幂次合并同类项：\n- 常数项 ($\\zeta^0$)： $\\frac{1}{\\sqrt{2}} (1 \\cdot 1) = \\frac{1}{\\sqrt{2}}$\n- $\\zeta^1$ 项： $\\frac{1}{\\sqrt{2}} \\left( 1 \\cdot \\frac{1}{2}\\zeta + \\frac{1}{2}\\zeta \\cdot 1 \\right) = \\frac{1}{\\sqrt{2}} (1 \\zeta) = \\frac{1}{\\sqrt{2}}\\zeta$\n- $\\zeta^2$ 项： $\\frac{1}{\\sqrt{2}} \\left( 1 \\cdot \\frac{3}{8}\\zeta^2 + (\\frac{1}{2}\\zeta) (\\frac{1}{2}\\zeta) + (-\\frac{1}{8}\\zeta^2) \\cdot 1 \\right) = \\frac{1}{\\sqrt{2}} \\left( \\frac{3}{8} + \\frac{1}{4} - \\frac{1}{8} \\right)\\zeta^2 = \\frac{1}{\\sqrt{2}} \\left( \\frac{3+2-1}{8} \\right)\\zeta^2 = \\frac{1}{\\sqrt{2}}\\frac{4}{8}\\zeta^2 = \\frac{1}{\\sqrt{2}}\\frac{1}{2}\\zeta^2$\n\n因此，$G(\\zeta)$ 的展开式为：\n$$\nG(\\zeta) = \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}}\\zeta + \\frac{1}{2\\sqrt{2}}\\zeta^2 + O(\\zeta^3)\n$$\n通过将其与 $G(\\zeta) = \\omega_0 + \\omega_1\\zeta + \\omega_2\\zeta^2 + \\dots$ 比较，我们确定前三个权重：\n$$\n\\omega_0 = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\n$$\n$$\n\\omega_1 = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\n$$\n$$\n\\omega_2 = \\frac{1}{2\\sqrt{2}} = \\frac{\\sqrt{2}}{4}\n$$\n\n接下来，我们分析当 $n$ 很大时 $\\omega_n$ 的渐近衰减率。根据解析组合学的原理，系数 $[\\zeta^n]G(\\zeta)$ 的渐近行为由函数 $G(\\zeta)$ 的主导奇点决定，即模最小的奇点。函数 $G(\\zeta) = \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}(1-\\zeta)^{-1/2}$ 在 $\\zeta=1$ 和 $\\zeta=-1$ 处有支点奇点。两者的模都为1，因此它们都是主导奇点。\n\n在 $\\zeta=1$ 附近，我们可以写出 $G(\\zeta) = f(\\zeta)(1-\\zeta)^{-1/2}$，其中 $f(\\zeta) = \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}$。当 $\\zeta \\to 1$ 时，其行为由奇点主导：\n$$\nG(\\zeta) \\sim f(1) (1-\\zeta)^{-1/2} = \\frac{1}{\\sqrt{2}}(1+1)^{1/2} (1-\\zeta)^{-1/2} = \\frac{\\sqrt{2}}{\\sqrt{2}}(1-\\zeta)^{-1/2} = (1-\\zeta)^{-1/2}\n$$\n奇点分析的转换定理指出，如果一个函数在 $\\zeta=\\rho$ 处有一个形如 $C(1-\\zeta/\\rho)^{-\\alpha}$ 的孤立奇点，那么它的第 $n$ 个系数渐近于 $C \\frac{n^{\\alpha-1}}{\\Gamma(\\alpha)}\\rho^{-n}$。这里，$C=1$，$\\rho=1$，$\\alpha=1/2$。$\\zeta=1$ 处的奇点对 $\\omega_n$ 的贡献为：\n$$\n\\omega_n^{(+1)} \\sim \\frac{n^{1/2-1}}{\\Gamma(1/2)} (1)^{-n} = \\frac{n^{-1/2}}{\\sqrt{\\pi}}\n$$\n\n在 $\\zeta=-1$ 附近，项 $(1+\\zeta)^{1/2}$ 变为奇异。我们分析当 $\\zeta \\to -1$ 时 $G(\\zeta)$ 的行为：\n$$\nG(\\zeta) \\sim \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}(1-(-1))^{-1/2} = \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}(2)^{-1/2} = \\frac{1}{2}(1+\\zeta)^{1/2}\n$$\n这个奇点的形式为 $K(1-\\zeta/\\rho)^{\\beta}$，其中 $K=1/2$，$\\rho=-1$，$\\beta=1/2$。来自这样一个项的系数衰减得更快。它对 $\\omega_n$ 的贡献阶数为 $n^{-\\beta-1}=n^{-3/2}$。具体来说，这个贡献渐近于 $-(-1)^n \\frac{1}{4\\sqrt{\\pi}} n^{-3/2}$。\n\n总的渐近行为是所有主导奇点贡献的总和。由于 $n^{-1/2}$ 比 $n^{-3/2}$ 衰减得慢，主阶行为完全由 $\\zeta=1$ 处的奇点决定。因此，渐近衰减率为：\n$$\n\\omega_n \\sim \\frac{1}{\\sqrt{\\pi n}} = O(n^{-1/2})\n$$\n\n最后，我们讨论这些发现与晚期不稳定性抑制的关系。TDIE离散化中的晚期不稳定性通常表现为非物理的、指数增长的数值解，这些是数值方法的人为产物。一个稳定的格式必须能正确捕捉连续系统的物理行为。\n\n对应于 $Z(s)=1/\\sqrt{s}$ 的连续核是拉普拉斯逆变换 $\\mathcal{L}^{-1}\\{s^{-1/2}\\}(t) = (\\pi t)^{-1/2}$（对于 $t>0$）。这个核是正的，并表现出缓慢的代数衰减。这种缓慢衰减代表了控制方程分数阶性质所固有的“长记忆”效应。\n\nCQ权重 $\\{\\omega_n\\}$ 充当了该核的离散版本。我们的分析揭示了两个关键性质：\n1. 权重以 $\\omega_n \\sim O(n^{-1/2})$ 的形式代数衰减。这正确地模拟了连续核的缓慢衰减。一个错误地施加更快（例如，指数级）衰减的格式将无法捕捉长记忆物理特性，并且在晚期会不准确。\n2. 对于 $n \\ge 0$，权重 $\\omega_n$ 均为正。这可以通过将 $G(\\zeta)$ 重写为 $G(\\zeta) = \\frac{1}{\\sqrt{2}}(1+\\zeta)(1-\\zeta^2)^{-1/2}$ 来证明。$(1-\\zeta^2)^{-1/2}$ 的展开式只包含 $\\zeta^2$ 的非负次幂，且系数为正。乘以 $(1+\\zeta)$ 会得到一个所有系数均为正的级数。这种正性与连续核的正性相匹配，防止了在数值解中引入虚假的、非物理的振荡。\n\n基于梯形法则的CQ方法已知将虚轴 $\\text{Re}(s)=0$ 映射到单位圆 $|\\zeta|=1$。因此，$Z(s)$ 在 $s=0$ 处的奇点被映射到单位圆上，而不是其内部，这一点至关重要。由此产生的离散系统（与权重 $\\omega_n$ 的卷积）不是有界输入有界输出（BIBO）稳定的，因为 $\\sum |\\omega_n| \\sim \\sum n^{-1/2}$ 是发散的。然而，这是正确的行为，因为底层的连续算子（一个分数半积分）也不是BIBO稳定的；它会放大像阶跃函数这样的有界输入。CQ格式的“稳定性”在于它能够复现连续系统的正确物理行为，而不会引入寄生的、指数增长的模式。正权重和正确的代数衰减率相结合，确保了数值解在物理上保持有意义，并且没有其他方法中常见的非物理晚期不稳定性。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个稳健的电磁学数值方法必须能够保持电荷守恒这一基本物理定律。本练习将理论与实践相结合，演示了在卷积求积时域积分方程 (CQ-TDIE) 框架中，如何利用散度整合基函数在离散层面自然地满足连续性方程 。通过数值验证，您将亲手确认这一关键属性，加深对构建稳定数值格式重要性的理解，并认识到理论选择如何在计算中得以体现。",
            "id": "3296312",
            "problem": "考虑用于理想闭合导体表面的时域电场边界积分公式，其中未知的表面电流密度由散度协调基函数（例如 Rao–Wilton–Glisson (RWG) 函数）展开，从而离散电流 $J$ 和离散表面电荷 $\\rho$ 以弱形式满足连续性方程。弱连续性方程指出，当在每个网格单元上使用分段常数（脉冲）函数进行检验时，电流的表面散度等于表面电荷的负时间导数，即\n$$\n\\int_{T_i} \\nabla_s \\cdot J(\\mathbf{r},t) \\, dS \\;=\\; - \\frac{d}{dt} \\int_{T_i} \\rho(\\mathbf{r},t) \\, dS,\n$$\n对于网格中的每个三角形 $T_i$。在离散设置中，令 $D$ 表示将基于边的电流系数映射到单元检验散度的矩阵，并令 $\\rho^n$ 表示在离散时间 $t_n=n\\Delta t$ 的检验单元电荷向量。弱连续性要求变为\n$$\nD \\, J^n \\;+\\; \\frac{d\\rho}{dt}\\Big|_{t=t_n} \\;=\\; 0.\n$$\n\n卷积求积 (Convolution Quadrature, CQ) 是一种通过将选定的线性多步法从时域转换到拉普拉斯域，从而在积分方程中离散化时间卷积的技术。当算子是时间导数时，其拉普拉斯域符号为 $s$，使用二阶后向差分格式 (BDF2) 的 CQ 可得出离散时间导数\n$$\n\\frac{d\\rho}{dt}\\Big|_{t=t_n} \\approx \\frac{1}{\\Delta t}\\left(\\frac{3}{2}\\rho^n - 2 \\rho^{n-1} + \\frac{1}{2}\\rho^{n-2}\\right),\n$$\n这是通过 CQ 范式从 BDF2 生成多项式 $\\delta(\\zeta)=\\tfrac{3}{2}-2\\zeta+\\tfrac{1}{2}\\zeta^2$ 获得的。此选择与 CQ-时域积分方程 (CQ-TDIE) 框架一致。\n\n在本问题中，您将通过数值验证，在 CQ-TDIE 中使用散度协调基函数可强制执行弱连续性方程，而非协调的散度映射扰动会产生可测量的违背。\n\n几何形状与离散算子：\n- 考虑一个由两个共享单条内部边的平面三角形 $T_1$ 和 $T_2$ 组成的最小网格。使用支撑在该内部边上的单个散度协调边基函数展开电流。用单元脉冲检验表面散度可得出离散散度映射\n$$\nD_{\\mathrm{conf}} \\in \\mathbb{R}^{2\\times 1}, \\quad D_{\\mathrm{conf}} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix},\n$$\n意味着对于单个边系数 $J$，在 $T_1$ 上的检验散度为 $+J$，在 $T_2$ 上为 $-J$。\n- 通过引入一个小的参数 $\\varepsilon>0$ 并设置以下公式，定义一个非协调的散度映射扰动\n$$\nD_{\\mathrm{non}} \\in \\mathbb{R}^{2\\times 1}, \\quad D_{\\mathrm{non}} = \\begin{bmatrix} 1+\\varepsilon \\\\ -1+\\varepsilon \\end{bmatrix}.\n$$\n这个 $D_{\\mathrm{non}}$ 不对应任何散度协调基函数的精确检验表面散度，因此破坏了电荷守恒。\n\n电荷与电流：\n- 规定两个三角形中的单元电荷大小相等、方向相反：\n$$\n\\rho_1(t) = A \\sin(\\omega t), \\qquad \\rho_2(t) = -A \\sin(\\omega t),\n$$\n其中振幅 $A$ 的单位为库仑 (C)，角频率 $\\omega$ 的单位为弧度/秒 (rad/s)。\n- 将时间离散化为 $t_n=n\\Delta t$，其中 $n=0,1,\\dots,N-1$，时间步长 $\\Delta t$ 的单位为秒 (s)，步数 $N\\ge 3$。\n- 使用 BDF2 卷积求积离散导数\n$$\n\\dot\\rho_i^n = \\frac{1}{\\Delta t}\\left(\\frac{3}{2}\\rho_i^n - 2 \\rho_i^{n-1} + \\frac{1}{2}\\rho_i^{n-2}\\right),\n$$\n对于 $n\\ge 2$ 和 $i\\in\\{1,2\\}$。\n- 通过以离散 CQ 形式强制执行第一个三角形的连续性来定义每个时间步的边电流系数：\n$$\nJ^n = -\\dot\\rho_1^n.\n$$\n\n用于验证电荷守恒的残差：\n- 对于每个时间步 $n\\ge 2$，构建单位为安培 (A) 的残差向量\n$$\nr_{\\mathrm{conf}}^n = D_{\\mathrm{conf}} J^n + \\begin{bmatrix}\\dot\\rho_1^n \\\\ \\dot\\rho_2^n\\end{bmatrix}, \\qquad\nr_{\\mathrm{non}}^n = D_{\\mathrm{non}} J^n + \\begin{bmatrix}\\dot\\rho_1^n \\\\ \\dot\\rho_2^n\\end{bmatrix}.\n$$\n- 计算每个残差向量的欧几里得范数，\n$$\n\\|r_{\\mathrm{conf}}^n\\|_2, \\qquad \\|r_{\\mathrm{non}}^n\\|_2,\n$$\n并报告在所有 $n=2,3,\\dots,N-1$ 上的最大值。\n\n测试组：\n为以下参数集提供数值结果。必须严格遵守单位：$\\Delta t$ 的单位为秒 (s)，$\\omega$ 的单位为弧度/秒 (rad/s)，$A$ 的单位为库仑 (C)，输出的残差范数单位为安培 (A)。\n1. $(\\Delta t,\\omega,N,A,\\varepsilon) = (10^{-3}\\ \\mathrm{s},\\ 1250\\ \\mathrm{rad/s},\\ 100,\\ 10^{-9}\\ \\mathrm{C},\\ 0.05)$\n2. $(\\Delta t,\\omega,N,A,\\varepsilon) = (10^{-3}\\ \\mathrm{s},\\ 0\\ \\mathrm{rad/s},\\ 50,\\ 2\\times 10^{-9}\\ \\mathrm{C},\\ 0.05)$\n3. $(\\Delta t,\\omega,N,A,\\varepsilon) = (5\\times 10^{-3}\\ \\mathrm{s},\\ 800\\ \\mathrm{rad/s},\\ 60,\\ 5\\times 10^{-10}\\ \\mathrm{C},\\ 0.02)$\n4. $(\\Delta t,\\omega,N,A,\\varepsilon) = (10^{-4}\\ \\mathrm{s},\\ 5000\\ \\mathrm{rad/s},\\ 200,\\ 10^{-9}\\ \\mathrm{C},\\ 0.03)$\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，并且必须是一个包含最大残差范数 $[\\max_n \\|r_{\\mathrm{conf}}^n\\|_2,\\ \\max_n \\|r_{\\mathrm{non}}^n\\|_2]$（单位为安培）的两元素列表，例如，\n$[[R_{\\mathrm{conf},1},R_{\\mathrm{non},1}],[R_{\\mathrm{conf},2},R_{\\mathrm{non},2}],\\dots]$,\n其中每个 $R$ 都是一个浮点数。",
            "solution": "问题要求在计算电磁学的卷积求积时域积分方程 (CQ-TDIE) 背景下，对电荷守恒性质进行数值验证。具体来说，我们将比较使用散度协调离散算子与非协调离散算子时，离散连续性方程的满足情况。\n\n对每个给定的参数集 $(\\Delta t, \\omega, N, A, \\varepsilon)$，分析按以下步骤进行。\n\n首先，我们将时间轴离散化为 $t_n = n \\Delta t$，其中 $n=0, 1, \\dots, N-1$。据此，我们计算在每个时间步下两个三角形单元 $T_1$ 和 $T_2$ 上的规定电荷。电荷由以下公式给出：\n$$\n\\rho_1^n = A \\sin(\\omega t_n)\n$$\n$$\n\\rho_2^n = -A \\sin(\\omega t_n) = -\\rho_1^n\n$$\n这些值是为所有时间步 $n \\in \\{0, 1, \\dots, N-1\\}$ 计算的。两个单元的最终电荷向量为 $\\boldsymbol{\\rho}^n = [\\rho_1^n, \\rho_2^n]^T$。\n\n其次，我们使用由卷积求积框架指定的二阶后向差分格式 (BDF2) 计算每个单元处电荷的时间导数。在时间 $t_n$ 时电荷 $\\rho_i$ 的离散时间导数记为 $\\dot\\rho_i^n$，对于 $n \\ge 2$ 计算如下：\n$$\n\\dot\\rho_i^n = \\frac{1}{\\Delta t}\\left(\\frac{3}{2}\\rho_i^n - 2 \\rho_i^{n-1} + \\frac{1}{2}\\rho_i^{n-2}\\right)\n$$\n由于对于任意时间索引 $k$，都有 $\\rho_2^k = -\\rho_1^k$，根据 BDF2 算子的线性性质，可以直接得出其时间导数也大小相等、方向相反：\n$$\n\\dot\\rho_2^n = \\frac{1}{\\Delta t}\\left(\\frac{3}{2}(-\\rho_1^n) - 2(-\\rho_1^{n-1}) + \\frac{1}{2}(-\\rho_1^{n-2})\\right) = -\\dot\\rho_1^n\n$$\n我们为每个时间步 $n \\ge 2$ 构建电荷时间导数向量：\n$$\n\\dot{\\boldsymbol{\\rho}}^n = \\begin{bmatrix} \\dot\\rho_1^n \\\\ \\dot\\rho_2^n \\end{bmatrix} = \\begin{bmatrix} \\dot\\rho_1^n \\\\ -\\dot\\rho_1^n \\end{bmatrix}\n$$\n\n第三，通过在第一个单元 $T_1$ 上强制执行离散连续性方程来确定共享边上的离散电流系数 $J^n$。单元 $i$ 的离散连续性方程为 $(D J)^n_i + \\dot{\\rho}_i^n = 0$。对于单元 1，使用协调算子时，方程为 $(D_{\\mathrm{conf}}J^n)_1 + \\dot{\\rho}_1^n = 0$。已知 $(D_{\\mathrm{conf}})_1 = 1$，该式可简化为 $J^n + \\dot{\\rho}_1^n = 0$。问题基于此原理定义电流，推广为：\n$$\nJ^n = -\\dot\\rho_1^n\n$$\n对每个时间步 $n=2, 3, \\dots, N-1$ 执行此计算。\n\n第四，我们计算散度协调和非协调情况下离散连续性方程的残差。在时间 $t_n$ 的残差向量定义为 $r^n = D J^n + \\dot{\\boldsymbol{\\rho}}^n$。\n\n对于散度协调的情况，离散散度算子为 $D_{\\mathrm{conf}} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$。残差为：\n$$\nr_{\\mathrm{conf}}^n = D_{\\mathrm{conf}} J^n + \\dot{\\boldsymbol{\\rho}}^n = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} J^n + \\begin{bmatrix} \\dot\\rho_1^n \\\\ \\dot\\rho_2^n \\end{bmatrix}\n$$\n代入 $J^n = -\\dot\\rho_1^n$ 和 $\\dot\\rho_2^n = -\\dot\\rho_1^n$：\n$$\nr_{\\mathrm{conf}}^n = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} (-\\dot\\rho_1^n) + \\begin{bmatrix} \\dot\\rho_1^n \\\\ -\\dot\\rho_1^n \\end{bmatrix} = \\begin{bmatrix} -\\dot\\rho_1^n \\\\ \\dot\\rho_1^n \\end{bmatrix} + \\begin{bmatrix} \\dot\\rho_1^n \\\\ -\\dot\\rho_1^n \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n$$\n因此，对于协调算子，每个时间步的残差都是零向量。因此，欧几里得范数 $\\|r_{\\mathrm{conf}}^n\\|_2$ 对所有 $n$ 均为 $0$，其在 $n$ 上的最大值也为 $0$。任何非零结果都将完全归因于浮点精度限制。\n\n对于非协调的情况，离散散度算子为 $D_{\\mathrm{non}} = \\begin{bmatrix} 1+\\varepsilon \\\\ -1+\\varepsilon \\end{bmatrix}$。残差为：\n$$\nr_{\\mathrm{non}}^n = D_{\\mathrm{non}} J^n + \\dot{\\boldsymbol{\\rho}}^n = \\begin{bmatrix} 1+\\varepsilon \\\\ -1+\\varepsilon \\end{bmatrix} J^n + \\begin{bmatrix} \\dot\\rho_1^n \\\\ \\dot\\rho_2^n \\end{bmatrix}\n$$\n代入 $J^n = -\\dot\\rho_1^n$ 和 $\\dot\\rho_2^n = -\\dot\\rho_1^n$：\n$$\nr_{\\mathrm{non}}^n = \\begin{bmatrix} 1+\\varepsilon \\\\ -1+\\varepsilon \\end{bmatrix} (-\\dot\\rho_1^n) + \\begin{bmatrix} \\dot\\rho_1^n \\\\ -\\dot\\rho_1^n \\end{bmatrix} = \\begin{bmatrix} -(1+\\varepsilon)\\dot\\rho_1^n + \\dot\\rho_1^n \\\\ -(-1+\\varepsilon)(-\\dot\\rho_1^n) - \\dot\\rho_1^n \\end{bmatrix} = \\begin{bmatrix} -\\varepsilon\\dot\\rho_1^n \\\\ (1-\\varepsilon)\\dot\\rho_1^n - \\dot\\rho_1^n \\end{bmatrix} = \\begin{bmatrix} -\\varepsilon\\dot\\rho_1^n \\\\ -\\varepsilon\\dot\\rho_1^n \\end{bmatrix}\n$$\n此残差向量的欧几里得范数为：\n$$\n\\|r_{\\mathrm{non}}^n\\|_2 = \\sqrt{(-\\varepsilon\\dot\\rho_1^n)^2 + (-\\varepsilon\\dot\\rho_1^n)^2} = \\sqrt{2(\\varepsilon\\dot\\rho_1^n)^2} = \\sqrt{2} |\\varepsilon \\dot\\rho_1^n|\n$$\n\n最后，我们为每个测试用例计算所需的输出量。我们需要找到在相关时间步 $n=2, 3, \\dots, N-1$ 上残差范数的最大值。\n最大协调残差范数为：\n$$\n\\max_{n\\in[2, N-1]} \\|r_{\\mathrm{conf}}^n\\|_2 = 0\n$$\n最大非协调残差范数为：\n$$\n\\max_{n\\in[2, N-1]} \\|r_{\\mathrm{non}}^n\\|_2 = \\max_{n\\in[2, N-1]} \\left( \\sqrt{2} |\\varepsilon \\dot\\rho_1^n| \\right) = \\sqrt{2} |\\varepsilon| \\max_{n\\in[2, N-1]} |\\dot\\rho_1^n|\n$$\n该算法首先计算离散时间导数向量 $\\dot\\rho_1^n$（对于 $n=2, \\dots, N-1$），找到该向量中的最大绝对值，然后将其乘以 $\\sqrt{2}|\\varepsilon|$ 以获得最终的非协调残差范数。对于 $\\omega=0$ 的特殊情况，$\\rho_1(t)$ 恒为零，这意味着对所有 $n$ 都有 $\\dot\\rho_1^n=0$，因此两个最大残差范数都将为零。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum residual norms for charge conservation using\n    conforming and non-conforming discrete divergence operators.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (delta_t, omega, N, A, epsilon)\n        (1e-3, 1250, 100, 1e-9, 0.05),\n        (1e-3, 0, 50, 2e-9, 0.05),\n        (5e-3, 800, 60, 5e-10, 0.02),\n        (1e-4, 5000, 200, 1e-9, 0.03),\n    ]\n\n    results = []\n    for case in test_cases:\n        dt, omega, N, A, epsilon = case\n\n        # Step 1: Discretize time and compute charges\n        # Time vector t_n = n * dt for n = 0, 1, ..., N-1\n        t = np.arange(N) * dt\n        \n        # Charge on the first triangle, rho_1(t) = A * sin(omega * t)\n        rho1 = A * np.sin(omega * t)\n\n        # Handle the special case where omega is 0\n        if omega == 0:\n            # If omega is 0, rho1 is always 0.\n            # Its derivative is also 0, so current J is 0.\n            # Both residuals will be 0.\n            max_res_conf = 0.0\n            max_res_non = 0.0\n            results.append([max_res_conf, max_res_non])\n            continue\n            \n        # Step 2: Compute the discrete time derivative of the charge\n        # BDF2 formula for n >= 2:\n        # dot_rho_n = (1.5*rho_n - 2*rho_{n-1} + 0.5*rho_{n-2}) / dt\n        # We use numpy array slicing for an efficient calculation over all n.\n        # This computes derivatives for n = 2, 3, ..., N-1.\n        rho1_dot = (1.5 * rho1[2:] - 2.0 * rho1[1:-1] + 0.5 * rho1[0:-2]) / dt\n        \n        # Step 3  4: Compute maximum residual norms\n        # From the derivation in the solution, the conforming residual is always zero.\n        max_res_conf = 0.0\n        \n        # The non-conforming residual norm at step n is sqrt(2) * |epsilon * rho1_dot_n|\n        # The maximum norm is therefore sqrt(2) * |epsilon| * max(|rho1_dot_n|)\n        max_abs_rho1_dot = np.max(np.abs(rho1_dot))\n        max_res_non = np.sqrt(2) * epsilon * max_abs_rho1_dot\n        \n        results.append([max_res_conf, max_res_non])\n\n    # Final print statement in the exact required format.\n    # str() on a list produces the correct string representation, e.g., '[0.0, 1.23e-10]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "卷积求积方法的一大优势在于其能够优雅地处理频率相关（即色散）材料，而这对传统时域步进方法构成了巨大挑战。本练习将引导您完成一个完整的实际应用，即为 Debye 色散介质实现卷积求积算法 。您将学习如何使用快速傅里叶变换 (FFT) 高效计算卷积权重，从而模拟一个真实的物理场景并分析其响应特性，体验 CQ 方法在复杂问题中的强大功能。",
            "id": "3296281",
            "problem": "考虑一个由麦克斯韦方程组和一个色散本构关系所描述的均匀、各向同性、非磁性的德拜介质。电场 $E(t)$ 和磁场 $H(t)$ 满足以下基本定律\n$$\\nabla\\times E(t)=-\\mu\\,\\frac{\\partial H(t)}{\\partial t},\\quad \\nabla\\times H(t)=\\frac{\\partial D(t)}{\\partial t},$$\n其中电通量密度 $D(t)$ 通过时间上的卷积与电场 $E(t)$ 相关联。在拉普拉斯域（拉普拉斯变量为 $s$）中，德拜介电常数模型为\n$$\\epsilon(s)=\\epsilon_\\infty+\\frac{\\epsilon_s-\\epsilon_\\infty}{1+s\\tau},$$\n其中 $\\epsilon_\\infty$ 是高频介电常数极限，$\\epsilon_s$ 是静态介电常数，$\\tau$ 是弛豫时间。\n\n一个用于电磁散射的标准时域边界积分方程通过一个频率相关的面积分算子引入了推迟势。对于一个位于代表性分离距离上的单点配置自由度，单层势算子的标量传递函数在拉普拉斯域中可以建模为\n$$G(s)=\\frac{e^{-k(s)\\,r_0}}{4\\pi\\,r_0},\\quad k(s)=s\\,\\sqrt{\\mu\\,\\epsilon(s)},$$\n其中 $r_0$ 是一个表示有效相互作用距离的正长度尺度，$\\mu$ 是磁导率（在本问题中假定为常数，且等于自由空间磁导率）。这个简化的传递函数通过 $k(s)$ 捕捉了频率依赖性，同时保留了与德拜介质中波传播相关的因果衰减特性。\n\n卷积求积（Convolution Quadrature, CQ）将因果时域卷积\n$$y(t)=\\int_0^t g(t-\\xi)\\,u(\\xi)\\,\\mathrm{d}\\xi\\quad\\text{with}\\quad \\mathcal{L}\\{g\\}(s)=G(s),$$\n近似为一个离散卷积 $y_n\\approx\\sum_{j=0}^n w_j\\,u_{n-j}$，其中 $w_n$ 是从一个 A-稳定时间步进法的生成函数中获得的 CQ 权重。对于梯形法则，其生成函数为\n$$\\delta(\\zeta)=\\frac{2(1-\\zeta)}{1+\\zeta},$$\nCQ 权重通过柯西积分表示法定义\n$$w_n=\\frac{1}{2\\pi i}\\oint_{|\\zeta|=\\rho}\\!G\\!\\left(\\frac{\\delta(\\zeta)}{\\Delta t}\\right)\\,\\zeta^{-n-1}\\,\\mathrm{d}\\zeta,$$\n其中 $0<\\rho<1$，$\\Delta t>0$ 是时间步长。在数值上，该积分通过在圆 $|\\zeta|=\\rho$ 上使用梯形法则进行近似，得到\n$$w_n\\approx \\frac{1}{N}\\sum_{\\ell=0}^{N-1}G\\!\\left(\\frac{\\delta(\\zeta_\\ell)}{\\Delta t}\\right)\\,\\zeta_\\ell^{-n},\\quad \\zeta_\\ell=\\rho\\,e^{2\\pi i \\ell/N}.$$\n\n您的任务是为所描述的德拜介质实现梯形法则卷积求积，以计算标量算子 $G(s)$ 的离散阶跃响应，并通过测量单位阶跃输入的输出序列的放大率来评估稳定性随弛豫时间 $\\tau$ 的变化情况。使用以下科学上一致的参数：\n- 自由空间磁导率 $\\mu_0=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$。\n- 真空介电常数 $\\epsilon_0=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n- 高频介电常数 $\\epsilon_\\infty=2\\,\\epsilon_0$。\n- 静态介电常数 $\\epsilon_s=5\\,\\epsilon_0$。\n- 代表性距离 $r_0=0.1\\,\\mathrm{m}$。\n- 时间步长 $\\Delta t=1\\times 10^{-10}\\,\\mathrm{s}$。\n- 时间步数 $N_t=256$。\n- CQ 轮廓半径 $\\rho=0.95$。\n- 单位圆上的求积点数 $N=2048$。\n\n将单位阶跃输入定义为 $u_n=1$（对于 $n=0,1,\\dots,N_t-1$）。对于下面测试套件中的每个弛豫时间 $\\tau$，计算 CQ 权重 $w_n$ 和输出序列 $y_n=\\sum_{j=0}^n w_j$（离散阶跃响应）。使用随时间变化的最大绝对值\n$$A(\\tau)=\\max_{0\\le n<N_t}\\,|y_n|,$$\n作为一个无量纲的稳定性指标：较小的值表示离散卷积与色散算子结合时具有更强的阻尼和更好的稳定性。\n\n测试套件：\n- 情况 1：$\\tau=0$。\n- 情况 2：$\\tau=1\\times 10^{-12}\\,\\mathrm{s}$。\n- 情况 3：$\\tau=1\\times 10^{-9}\\,\\mathrm{s}$。\n- 情况 4：$\\tau=1\\times 10^{-6}\\,\\mathrm{s}$。\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，`[result1,result2,result3,result4]`）。\n- 该列表必须按给定顺序包含与测试套件中的情况相对应的四个无量纲放大值 $[A(\\tau_1),A(\\tau_2),A(\\tau_3),A(\\tau_4)]$。",
            "solution": "该问题陈述清晰且科学上合理，它基于计算电磁学的既定原理，特别是卷积求积（CQ）在色散介质中波传播的时域边界积分方程中的应用。所有必需的物理常数、材料属性和数值参数均已提供，其数值与该领域的典型情况一致。该问题代表了一项有效且具有一定难度的计算任务。\n\n核心目标是计算德拜介质中标量波算子的离散阶跃响应，并通过一个放大度量 $A(\\tau)$ 来评估其在不同材料弛豫时间 $\\tau$ 下的稳定性。解决方案涉及实现梯形法则卷积求积方法。\n\n步骤如下：\n\n1.  **定义系统传递函数**：该物理系统由拉普拉斯域中的一个标量传递函数 $G(s)$ 建模。该函数描述了均匀、各向同性、非磁性德拜介质中的一个推迟势。它由下式给出\n    $$G(s)=\\frac{e^{-k(s)\\,r_0}}{4\\pi\\,r_0}$$\n    其中 $r_0$ 是一个特征距离。传播常数 $k(s)$ 捕捉了材料的色散性质，定义为\n    $$k(s)=s\\,\\sqrt{\\mu\\,\\epsilon(s)}$$\n    这里，$\\mu$ 是磁导率，取自由空间值 $\\mu_0$。频率相关的介电常数 $\\epsilon(s)$ 由单极点德拜模型描述：\n    $$\\epsilon(s)=\\epsilon_\\infty+\\frac{\\epsilon_s-\\epsilon_\\infty}{1+s\\tau}$$\n    其中 $\\epsilon_\\infty$ 是高频介电常数，$\\epsilon_s$ 是静态介电常数，$\\tau$ 是弛豫时间。对于 $\\tau=0$ 的特殊情况，介电常数变为常数 $\\epsilon(s) = \\epsilon_\\infty + (\\epsilon_s - \\epsilon_\\infty) = \\epsilon_s$，代表一个非色散介质。为保证因果性，必须选择 $k(s)$ 的平方根分支，使得当 $\\mathrm{Re}(s) \\ge 0$ 时，$\\mathrm{Re}(k(s)) \\ge 0$。\n\n2.  **使用卷积求积（CQ）进行离散化**：连续时域卷积 $y(t) = (g*u)(t)$（其中 $\\mathcal{L}\\{g\\}(s) = G(s)$）被近似为离散卷积 $y_n = \\sum_{j=0}^{n} w_j u_{n-j}$。CQ 权重 $w_n$ 是从传递函数 $G(s)$ 使用数值时间积分方案的生成函数推导出来的。对于 A-稳定的梯形法则，其生成函数为\n    $$\\delta(\\zeta)=\\frac{2(1-\\zeta)}{1+\\zeta}$$\n    拉普拉斯变量 $s$ 随后通过映射 $s = \\delta(\\zeta)/\\Delta t$ 与复平面上一个圆上的离散变量 $\\zeta$ 相关联，其中 $\\Delta t$ 是时间步长。\n\n3.  **通过快速傅里叶变换（FFT）计算 CQ 权重**：CQ 权重 $w_n$ 的正式表达形式为一个柯西积分，该积分通过在圆形轮廓 $|\\zeta|=\\rho < 1$ 上使用梯形法则进行数值近似。此近似等价于逆离散傅里叶变换（IDFT）。权重的计算公式为\n    $$w_n\\approx \\frac{1}{N}\\sum_{\\ell=0}^{N-1}G\\!\\left(\\frac{\\delta(\\zeta_\\ell)}{\\Delta t}\\right)\\,\\zeta_\\ell^{-n}, \\quad \\text{with} \\quad \\zeta_\\ell=\\rho\\,e^{2\\pi i \\ell/N}$$\n    其中 $N$ 是求积点的数量。令 $W_\\ell = G(\\delta(\\zeta_\\ell)/\\Delta t)$。该公式可以改写为：\n    $$w_n \\approx \\frac{\\rho^{-n}}{N} \\sum_{\\ell=0}^{N-1} W_\\ell e^{-2\\pi i n \\ell / N}$$\n    求和项正是序列 $\\{W_\\ell\\}_{\\ell=0}^{N-1}$ 的 $N$ 点离散傅里叶变换（DFT）的第 $n$ 个分量。因此，可以使用 FFT 算法高效地计算这些权重：\n    $$w_n \\approx \\frac{\\rho^{-n}}{N} \\left(\\mathrm{FFT}\\left(\\{W_\\ell\\}\\right)\\right)_n$$\n    我们只需要计算 $n=0, 1, \\dots, N_t-1$ 的这些权重。由于底层的时域脉冲响应 $g(t)$ 是实数，所构造的序列 $W_\\ell$ 将表现出共轭对称性（$W_\\ell = W_{N-\\ell}^*$），从而确保计算出的权重 $w_n$ 是实数。\n\n4.  **计算离散阶跃响应**：问题指定了单位阶跃输入，$u_n = 1$（对于所有 $n \\ge 0$）。由此产生的输出序列 $y_n$ 是离散阶跃响应：\n    $$y_n = \\sum_{j=0}^{n} w_j u_{n-j} = \\sum_{j=0}^{n} w_j (1) = \\sum_{j=0}^{n} w_j$$\n    这只是 CQ 权重的累积和。\n\n5.  **确定稳定性指标**：对于测试套件中的每个 $\\tau$ 值，我们计算 $n=0, 1, \\dots, N_t-1$ 的输出序列 $y_n$。然后，稳定性通过放大因子 $A(\\tau)$ 进行量化，其定义为该时间间隔内输出序列的最大绝对值：\n    $$A(\\tau)=\\max_{0\\le n<N_t}\\,|y_n|$$\n    对四个指定的 $\\tau$ 情况中的每一种都计算此值。\n\n总体算法如下：\n对于每个给定的 $\\tau$：\na. 定义所有物理常数（$\\mu_0, \\epsilon_0, \\epsilon_s, \\epsilon_\\infty, r_0$）和数值参数（$\\Delta t, N_t, \\rho, N$）。\nb. 在 CQ 轮廓上生成 $N$ 个求积点：$\\zeta_\\ell = \\rho \\exp(2\\pi i \\ell / N)$（对于 $\\ell = 0, \\dots, N-1$）。\nc. 将这些点映射到拉普拉斯域：$s_\\ell = (2/\\Delta t)(1-\\zeta_\\ell)/(1+\\zeta_\\ell)$。\nd. 对于每个 $s_\\ell$，通过先计算 $\\epsilon(s_\\ell)$，然后计算 $k(s_\\ell)$，最后计算 $G(s_\\ell)$ 来评估传递函数 $W_\\ell = G(s_\\ell)$。\ne. 计算序列 $\\{W_\\ell\\}$ 的 FFT 以获得 $\\{V_n\\} = \\mathrm{FFT}(\\{W_\\ell\\})$。\nf. 使用公式 $w_n = \\mathrm{Re}(V_n / (N \\rho^n))$ 计算前 $N_t$ 个 CQ 权重（$n=0, \\dots, N_t-1$）。\ng. 通过计算 $\\{w_n\\}$ 的累积和来计算离散阶跃响应 $y_n$。\nh. 找出放大率 $A(\\tau) = \\max(|y_n|)$。\n对所有四个 $\\tau$ 的情况重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stability indicator for a Debye medium using Convolution Quadrature.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement.\n    mu_0 = 4.0 * np.pi * 1e-7  # Free-space permeability (H/m)\n    eps_0 = 8.854187817e-12    # Vacuum permittivity (F/m)\n    eps_inf = 2.0 * eps_0         # High-frequency permittivity\n    eps_s = 5.0 * eps_0           # Static permittivity\n    r0 = 0.1                      # Representative distance (m)\n    dt = 1.0e-10                  # Time step (s)\n    Nt = 256                      # Number of time steps\n    rho = 0.95                    # CQ contour radius\n    N = 2048                      # Number of quadrature points\n\n    # Test suite for relaxation time tau (s)\n    test_cases = [\n        0.0,\n        1.0e-12,\n        1.0e-9,\n        1.0e-6,\n    ]\n\n    results = []\n    \n    # Pre-calculate common numerical arrays\n    ell = np.arange(N)\n    zeta = rho * np.exp(2j * np.pi * ell / N)\n    s_laplace = (2.0 / dt) * (1.0 - zeta) / (1.0 + zeta)\n\n    n_indices = np.arange(Nt)\n    rho_powers = rho ** n_indices\n\n    for tau in test_cases:\n        # Step 1: Evaluate the Debye permittivity epsilon(s)\n        # Handle tau=0 case to avoid division by zero if s is such that 1+s*tau is zero, though unlikely.\n        if tau == 0.0:\n            eps = np.full(N, eps_s, dtype=complex)\n        else:\n            eps = eps_inf + (eps_s - eps_inf) / (1.0 + s_laplace * tau)\n\n        # Step 2: Evaluate the wave number k(s)\n        # The principal branch of np.sqrt ensures Re(k(s))>0 for Re(s)>0, which is physically correct.\n        k_s = s_laplace * np.sqrt(mu_0 * eps)\n\n        # Step 3: Evaluate the transfer function G(s)\n        G_s = np.exp(-k_s * r0) / (4.0 * np.pi * r0)\n\n        # Step 4: Compute CQ weights via FFT\n        # The formula is w_n = (rho^-n / N) * FFT(G_s)_n\n        w_fft = np.fft.fft(G_s)\n        \n        # We only need the first Nt weights\n        weights_fft_subset = w_fft[:Nt]\n        \n        # Calculate the final weights. The result should be real since the impulse response is real.\n        weights = np.real(weights_fft_subset / (N * rho_powers))\n\n        # Step 5: Compute the discrete step response (cumulative sum of weights)\n        # y_n = sum_{j=0 to n} w_j\n        step_response = np.cumsum(weights)\n\n        # Step 6: Calculate the stability indicator A(tau)\n        A_tau = np.max(np.abs(step_response))\n        results.append(A_tau)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}