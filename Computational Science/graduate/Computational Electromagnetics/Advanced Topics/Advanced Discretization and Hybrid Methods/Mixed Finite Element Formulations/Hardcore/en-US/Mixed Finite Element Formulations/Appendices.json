{
    "hands_on_practices": [
        {
            "introduction": "To construct robust numerical models, we must first understand their fundamental building blocks. This exercise takes you to the core of mixed finite element formulations by asking you to construct the lowest-order element pair on a single triangle . By defining the polynomial spaces for the vector field and the scalar Lagrange multiplier, you will verify how they fit into the discrete de Rham sequence, a mathematical structure that guarantees a stable and accurate method. This foundational practice is essential for grasping why specific element types, like Nédélec elements, are a cornerstone of computational electromagnetics.",
            "id": "3331117",
            "problem": "Consider a simply connected polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with a conforming triangulation $\\mathcal{T}_{h}$ into triangles. Let $\\mathbf{E}$ denote a vector field sought in the Sobolev space of square-integrable functions with square-integrable scalar curl, $H(\\operatorname{curl};\\Omega)$, and let $p$ denote a scalar Lagrange multiplier in $L^{2}(\\Omega)$ introduced to ensure a mixed finite element structure consistent with the two-dimensional de Rham sequence. Starting from the continuous sequence $H^{1}(\\Omega) \\xrightarrow{\\nabla} H(\\operatorname{curl};\\Omega) \\xrightarrow{\\operatorname{curl}} L^{2}(\\Omega)$, construct a lowest-order mixed finite element discretization by choosing, on each triangle $K \\in \\mathcal{T}_{h}$, the Nédélec first kind edge element of order zero for $\\mathbf{E}$ and piecewise constants for $p$. Your construction must satisfy the following:\n\n- Explicitly identify the local polynomial representation of the Nédélec first kind order-zero shape functions on a single triangle $K$, and the local polynomial space for $p$.\n- State the associated polynomial degrees for the components of $\\mathbf{E}_{h}$ and for $p_{h}$ on each $K$.\n- Argue consistency with the discrete de Rham structure by explaining how the element-wise scalar curl of any $\\mathbf{E}_{h}$ lies in the chosen discrete space for $p_{h}$, and how gradients of linear polynomials embed into the chosen $\\mathbf{E}_{h}$ space with zero curl.\n\nFinally, on a single triangle $K$, compute the exact dimension of the element-wise kernel of the discrete scalar curl operator restricted to the Nédélec first kind order-zero space, that is, compute\n$$\n\\dim\\left\\{\\mathbf{v}_{h} \\in \\mathcal{N}_{0}(K) : \\operatorname{curl}\\,\\mathbf{v}_{h} = 0\\right\\}.\n$$\nProvide the final answer as a single integer. No rounding is required, and no physical units are involved.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard exercise in the theory of mixed finite element methods for computational electromagnetics. I will proceed with a full solution.\n\nThe problem requires the construction and analysis of a lowest-order mixed finite element discretization for a $2D$ problem on a triangle $K$. The discretization is based on the de Rham sequence:\n$$\nH^{1}(\\Omega) \\xrightarrow{\\nabla} H(\\operatorname{curl};\\Omega) \\xrightarrow{\\operatorname{curl}} L^{2}(\\Omega) \\rightarrow 0\n$$\nThe proposed discrete spaces on a triangular element $K \\in \\mathcal{T}_h$ are the Nédélec first kind, order-zero space for the vector field $\\mathbf{E}_h$, and the space of piecewise constant functions for the scalar field $p_h$. Let us denote the local spaces as $\\mathbf{V}_h(K)$ and $Q_h(K)$ respectively.\n\nFirst, we explicitly identify the local polynomial representations.\nFor the vector field $\\mathbf{E}_h$, the chosen space is the Nédélec first kind, order-zero space, which we denote as $\\mathcal{N}_0(K)$. A vector field $\\mathbf{v}_h \\in \\mathcal{N}_0(K)$ is defined by the following polynomial representation:\n$$\n\\mathbf{v}_h(x, y) = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix} + b \\begin{pmatrix} -y \\\\ x \\end{pmatrix} = \\begin{pmatrix} a_1 - by \\\\ a_2 + bx \\end{pmatrix}\n$$\nwhere $a_1, a_2, b \\in \\mathbb{R}$ are constants. This space is also known as the lowest-order rotated Raviart-Thomas space, $RT_0^{\\perp}(K)$. The dimension of this space is $3$. The degrees of freedom are typically defined as the constant tangential components of the vector field along the three edges of the triangle $K$.\n\nFor the scalar Lagrange multiplier $p_h$, the chosen space is that of piecewise constants on $K$. This is the space of polynomials of degree zero, denoted $\\mathcal{P}_0(K)$. A scalar function $q_h \\in \\mathcal{P}_0(K)$ has the form:\n$$\nq_h(x, y) = c\n$$\nwhere $c \\in \\mathbb{R}$ is a constant. The dimension of this space is $1$.\n\nNext, we state the associated polynomial degrees.\nFor a vector field $\\mathbf{E}_h \\in \\mathcal{N}_0(K)$, its components are $E_x(x,y) = a_1 - by$ and $E_y(x,y) = a_2 + bx$. Both components are linear polynomials in $x$ and $y$. Thus, the polynomial degree of the components of $\\mathbf{E}_h$ is $1$.\nFor a scalar field $p_h \\in \\mathcal{P}_0(K)$, the function is a constant, so its polynomial degree is $0$.\n\nWe now argue for consistency with the discrete de Rham structure. The discrete analogue of the continuous sequence on the element $K$ is:\n$$\n\\mathcal{P}_1(K) \\xrightarrow{\\nabla} \\mathcal{N}_0(K) \\xrightarrow{\\operatorname{curl}} \\mathcal{P}_0(K)\n$$\nHere, $\\mathcal{P}_1(K)$ is the space of linear polynomials, which is the lowest-order conforming finite element space for $H^1(\\Omega)$. We must verify two properties:\n$1.$ The operator $\\operatorname{curl}$ maps $\\mathcal{N}_0(K)$ into $\\mathcal{P}_0(K)$. Let $\\mathbf{v}_h \\in \\mathcal{N}_0(K)$ be given by $\\mathbf{v}_h(x, y) = (a_1 - by, a_2 + bx)$. The scalar curl in $2D$ is defined as $\\operatorname{curl} \\mathbf{v}_h = \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y}$. Applying this to $\\mathbf{v}_h$:\n$$\n\\operatorname{curl} \\mathbf{v}_h = \\frac{\\partial}{\\partial x}(a_2 + bx) - \\frac{\\partial}{\\partial y}(a_1 - by) = b - (-b) = 2b\n$$\nSince $b$ is a constant, the result $2b$ is a constant. Therefore, $\\operatorname{curl} \\mathbf{v}_h \\in \\mathcal{P}_0(K)$. This demonstrates that the image of $\\mathcal{N}_0(K)$ under the curl operator lies within the chosen space for the Lagrange multiplier.\n\n$2.$ The gradients of functions from the preceding space, $\\mathcal{P}_1(K)$, are curl-free and belong to $\\mathcal{N}_0(K)$. Let $\\phi_h \\in \\mathcal{P}_1(K)$. Then $\\phi_h$ can be written as $\\phi_h(x, y) = c_0 + c_1x + c_2y$ for some constants $c_0, c_1, c_2 \\in \\mathbb{R}$. The gradient of $\\phi_h$ is:\n$$\n\\nabla \\phi_h = \\begin{pmatrix} \\frac{\\partial \\phi_h}{\\partial x} \\\\ \\frac{\\partial \\phi_h}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n$$\nThis is a constant vector field. A constant vector field $\\mathbf{w} = (c_1, c_2)$ can be expressed in the form for elements of $\\mathcal{N}_0(K)$ by setting $a_1=c_1$, $a_2=c_2$, and $b=0$. Thus, $\\nabla \\mathcal{P}_1(K) \\subset \\mathcal{N}_0(K)$. Furthermore, the curl of any such gradient field is identically zero:\n$$\n\\operatorname{curl}(\\nabla \\phi_h) = \\operatorname{curl}\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\frac{\\partial c_2}{\\partial x} - \\frac{\\partial c_1}{\\partial y} = 0 - 0 = 0\n$$\nThis establishes that the image of the discrete gradient operator is contained within the kernel of the discrete curl operator, $\\operatorname{Im}(\\nabla|_{\\mathcal{P}_1(K)}) \\subseteq \\ker(\\operatorname{curl}|_{\\mathcal{N}_0(K)})$, confirming the complex property for this element pair.\n\nFinally, we compute the dimension of the element-wise kernel of the discrete scalar curl operator. We are asked for $\\dim\\left\\{\\mathbf{v}_{h} \\in \\mathcal{N}_{0}(K) : \\operatorname{curl}\\,\\mathbf{v}_{h} = 0\\right\\}$.\nAs shown above, for any $\\mathbf{v}_h \\in \\mathcal{N}_0(K)$ with representation $\\mathbf{v}_h(x, y) = \\begin{pmatrix} a_1 - by \\\\ a_2 + bx \\end{pmatrix}$, its curl is $\\operatorname{curl} \\mathbf{v}_h = 2b$.\nThe condition $\\operatorname{curl} \\mathbf{v}_h = 0$ is therefore equivalent to the condition $2b = 0$, which implies $b=0$.\nThe set of vector fields in $\\mathcal{N}_0(K)$ with zero curl is thus the set of all fields of the form:\n$$\n\\mathbf{v}_h(x, y) = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}\n$$\nwhere $a_1$ and $a_2$ are arbitrary real constants. This is precisely the space of constant vector fields on $K$, i.e., $(\\mathcal{P}_0(K))^2$. This is a two-dimensional vector space, with a possible basis being $\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right\\}$.\nTherefore, the dimension of the kernel is $2$.\nThis result is consistent with the Rank-Nullity Theorem applied to the gradient operator $\\nabla: \\mathcal{P}_1(K) \\to \\mathcal{N}_0(K)$. The dimension of $\\mathcal{P}_1(K)$ is $3$. The kernel of $\\nabla$ consists of constant functions, so $\\dim(\\ker(\\nabla)) = 1$. The image of $\\nabla$ is the space of constant vector fields, $\\operatorname{Im}(\\nabla)$, whose dimension is $\\dim(\\mathcal{P}_1(K)) - \\dim(\\ker(\\nabla)) = 3-1=2$. Since for this finite element pair, the discrete de Rham sequence is exact on the element level, we have $\\ker(\\operatorname{curl}|_{\\mathcal{N}_0(K)}) = \\operatorname{Im}(\\nabla|_{\\mathcal{P}_1(K)})$, and thus the dimension of the kernel of the curl is indeed $2$.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "The theoretical elegance of finite element methods relies on exact mathematical properties, but practical implementations often involve approximations that can lead to so-called \"variational crimes.\" This hands-on coding exercise allows you to explore the consequences of such a crime by deliberately perturbing the discrete system that models Maxwell's equations . You will implement a simple mixed finite element model and then introduce a controlled error, observing its direct impact on the solution's physical correctness. This practice provides a powerful, tangible demonstration of why maintaining the integrity of the underlying mathematical structure is critical for avoiding spurious, non-physical results.",
            "id": "3331121",
            "problem": "Consider the source-free, frequency-domain Maxwell eigenproblem in a simply connected, homogeneous, isotropic domain, where the electric field $\\mathbf{E}$ satisfies the curl-curl formulation derived from Faraday’s law and Ampère’s law without sources. The continuous mixed formulation introduces a scalar Lagrange multiplier $p$ to enforce the divergence-free constraint in a weak sense. In nondimensional form, under unit permeability and permittivity, the mixed eigenproblem reads: find $(\\mathbf{E}, p)$ and $\\lambda \\ge 0$ such that\n$$\n(\\nabla \\times \\mathbf{E}, \\nabla \\times \\mathbf{v}) + (\\nabla p, \\mathbf{v}) = \\lambda (\\mathbf{E}, \\mathbf{v}),\n$$\nfor all $\\mathbf{v}$ in the Sobolev space $H(\\mathrm{curl})$, together with\n$$\n(\\mathbf{E}, \\nabla q) = 0,\n$$\nfor all $q$ in the Sobolev space $H^1$. In the exact sequence setting, this suppresses spurious gradient fields in the electric field spectrum.\n\nIn mixed finite element formulations for computational electromagnetics, the tangential continuity of the electric field across element interfaces is ensured by choosing appropriate edge-based bases (for example, Nédélec elements), and the weak form integrals are evaluated by quadrature. A “variational crime” arises if the quadrature used to evaluate the bilinear forms is inconsistent, thereby perturbing the constraint that maintains the exact sequence structure. In this problem, you will construct a discrete mixed eigenproblem on a structured quadrilateral mesh, and then deliberately perturb the constraint inner product by a parametric quadrature error that models a violation of tangential continuity enforcement in the weak sense. You will map its effect on spurious eigenmodes (gradient-polluted eigenvectors) and constraint violations in the discrete pair $(\\mathbf{E}, p)$.\n\nStarting from the fundamental base of Maxwell’s equations and the mixed weak formulation, implement the following discrete model and analysis entirely in dimensionless units:\n\n1. Define a structured grid on the unit square with $N_x = 4$ nodes in the $x$-direction and $N_y = 4$ nodes in the $y$-direction. Use an edge-based discretization for the electric field $\\mathbf{E}$ with degrees of freedom (DOF) on horizontal edges ($E_x$ components) and vertical edges ($E_y$ components), and nodal DOFs for the scalar Lagrange multiplier $p$. Let the numbers of horizontal edges, vertical edges, and nodes be consistent with this structured mesh.\n\n2. Construct the discrete gradient operator $G$ mapping nodal DOFs to edge DOFs via forward differences:\n   - For a horizontal edge between nodes $(i,j)$ and $(i+1,j)$, the corresponding edge DOF equals $p_{i+1,j} - p_{i,j}$.\n   - For a vertical edge between nodes $(i,j)$ and $(i,j+1)$, the corresponding edge DOF equals $p_{i,j+1} - p_{i,j}$.\n   All indices must be consistent with the mesh connectivity. Use $N_x = 4$ and $N_y = 4$ as specified.\n\n3. Construct the discrete curl operator $C$ mapping edge DOFs to cell-centered scalar DOFs (out-of-plane component of $\\nabla \\times \\mathbf{E}$), using standard finite difference stencils on each cell indexed by $(i,j)$:\n$$\n(\\nabla \\times \\mathbf{E})_{i,j} \\approx E_y(i+1,j) - E_y(i,j) - \\big(E_x(i,j+1) - E_x(i,j)\\big),\n$$\nwhich corresponds to $(\\partial E_y / \\partial x) - (\\partial E_x / \\partial y)$ at cell $(i,j)$. Assemble $C$ accordingly for all interior cells.\n\n4. Define diagonal mass-like matrices:\n   - The edge mass matrix $M_e$ uses uniform edge weights derived from the mesh step sizes $h_x = 1/(N_x - 1)$ and $h_y = 1/(N_y - 1)$. Assign edge weights $h_x$ to horizontal edges and $h_y$ to vertical edges, forming a diagonal matrix of dimension equal to the total number of edges.\n   - The cell weight matrix $W$ uses uniform cell area weights $h_x h_y$ on the diagonal.\n   Then define the discrete curl-curl stiffness matrix $A = C^\\top W C$.\n\n5. Define the exact discrete constraint coupling matrix $B = G^\\top M_e$. This encodes the bilinear form $(\\mathbf{E}, \\nabla q)$ in the discrete inner product induced by $M_e$.\n\n6. Model the quadrature-induced variational crime that perturbs tangential continuity in the weak sense by modifying the edge weights with a signed diagonal perturbation. Let $Q_e$ be a diagonal matrix with entries alternating between $+1$ and $-1$ across the edge DOFs in a fixed, deterministic pattern. For a given scalar parameter $\\eta$, define the perturbed constraint matrix\n$$\nB_\\eta = G^\\top M_e (I + \\eta Q_e),\n$$\nwhere $I$ is the identity matrix of dimension equal to the total number of edges. This models a quadrature error that changes the contribution of individual edges in the enforcement of the weak tangential continuity and exact sequence coupling.\n\n7. Form the generalized symmetric mixed eigenproblem by assembling the block matrices\n$$\nK_\\eta = \\begin{bmatrix}\nA & B_\\eta^\\top \\\\\nB_\\eta & -\\gamma I_p\n\\end{bmatrix}, \\qquad\nM_\\alpha = \\begin{bmatrix}\nM_e & 0 \\\\\n0 & \\alpha I_p\n\\end{bmatrix},\n$$\nwhere $I_p$ is the identity matrix of size equal to the number of nodal DOFs, $\\gamma = 10^{-8}$ is a small stabilization parameter for $p$, and $\\alpha = 10^{-8}$ is a small mass scaling for $p$. Solve the generalized eigenproblem $K_\\eta x = \\lambda M_\\alpha x$ by transforming it to a symmetric standard eigenproblem using $M_\\alpha^{-1/2}$:\n$$\nM_\\alpha^{-1/2} K_\\eta M_\\alpha^{-1/2} y = \\lambda y, \\quad x = M_\\alpha^{-1/2} y.\n$$\n\n8. For each $\\eta$ in the test suite defined below, compute the smallest $k = 10$ positive eigenvalues and their corresponding eigenvectors $(\\mathbf{E}, p)$ extracted from $x$. For each eigenpair, compute the following diagnostics:\n   - The curl ratio $r_{\\mathrm{curl}} = \\|\\nabla \\times \\mathbf{E}\\|_2 / \\|\\mathbf{E}\\|_2$, where the discrete $\\nabla \\times \\mathbf{E}$ is $C \\mathbf{E}$ and the norm is the Euclidean norm.\n   - Classify an eigenpair as a spurious gradient-polluted mode if $r_{\\mathrm{curl}} < \\varepsilon_{\\mathrm{curl}}$ with $\\varepsilon_{\\mathrm{curl}} = 10^{-3}$.\n   - The discrete divergence pollution metric for physical modes (those not classified as spurious) defined as the mean over physical eigenpairs of $\\|B_\\eta \\mathbf{E}\\|_2 / \\|\\mathbf{E}\\|_2$.\n\n9. Quantify the variational crime magnitude by the relative operator $2$-norm of the perturbation in the constraint:\n$$\n\\mathrm{crime\\_norm}(\\eta) = \\frac{\\|B_\\eta - B\\|_2}{\\|B\\|_2},\n$$\nwhere $\\|\\cdot\\|_2$ denotes the matrix spectral norm (largest singular value).\n\n10. Test Suite. Evaluate the outputs for the following values of $\\eta$:\n   - $\\eta = 0.0$ (no crime, baseline case),\n   - $\\eta = 10^{-3}$ (small perturbation),\n   - $\\eta = 10^{-1}$ (moderate perturbation),\n   - $\\eta = 0.5$ (large perturbation),\n   - $\\eta = -0.3$ (negative perturbation, testing under-integration bias).\n\n11. Final Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is a list of the form $[\\text{spurious\\_count}, \\text{divergence\\_pollution}, \\text{crime\\_norm}]$. For example, the overall output must look like\n$$\n[\\,[s_1,d_1,c_1],[s_2,d_2,c_2],[s_3,d_3,c_3],[s_4,d_4,c_4],[s_5,d_5,c_5]\\,],\n$$\nwhere $s_i$ is an integer and $d_i$ and $c_i$ are floating-point numbers. All quantities are dimensionless.\n\nThe task requires deriving the discrete formulation from first principles, implementing it, and computing the diagnostic metrics that map the effect of the quadrature-induced variational crime on spurious eigenmodes and discrete divergence pollution in $(\\mathbf{E}, p)$ on the specified test suite. The final output must strictly adhere to the specified single-line format.",
            "solution": "The user's request is to solve a computational electromagnetics problem concerning the effects of a \"variational crime\" on a mixed finite element formulation of the Maxwell eigenproblem. The problem is a valid, well-posed, and scientifically grounded exercise in numerical analysis.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n- **Continuous Formulation**:\n  - Find $(\\mathbf{E}, p)$ and $\\lambda \\ge 0$.\n  - $(\\nabla \\times \\mathbf{E}, \\nabla \\times \\mathbf{v}) + (\\nabla p, \\mathbf{v}) = \\lambda (\\mathbf{E}, \\mathbf{v})$ for all $\\mathbf{v} \\in H(\\mathrm{curl})$.\n  - $(\\mathbf{E}, \\nabla q) = 0$ for all $q \\in H^1$.\n- **Discretization & Grid**:\n  - Domain: Unit square.\n  - Grid: Structured grid with $N_x = 4$ nodes in x, $N_y = 4$ nodes in y.\n  - DOFs: Electric field $\\mathbf{E}$ on edges, Lagrange multiplier $p$ on nodes.\n- **Discrete Operators**:\n  - Gradient $G$: Maps nodal DOFs to edge DOFs via forward differences.\n    - Horizontal edge: $p_{i+1,j} - p_{i,j}$.\n    - Vertical edge: $p_{i,j+1} - p_{i,j}$.\n  - Curl $C$: Maps edge DOFs to cell DOFs.\n    - $(\\nabla \\times \\mathbf{E})_{i,j} \\approx E_y(i+1,j) - E_y(i,j) - \\big(E_x(i,j+1) - E_x(i,j)\\big)$.\n- **Matrices**:\n  - Edge mass matrix $M_e$: Diagonal, weights $h_x = 1/(N_x - 1)$ for horizontal edges, $h_y = 1/(N_y - 1)$ for vertical edges.\n  - Cell weight matrix $W$: Diagonal, weights $h_x h_y$.\n  - Stiffness matrix $A = C^\\top W C$.\n  - Exact constraint matrix $B = G^\\top M_e$.\n- **Variational Crime Model**:\n  - Perturbation matrix $Q_e$: Diagonal, with entries alternating between $+1$ and $-1$.\n  - Perturbed constraint matrix $B_\\eta = G^\\top M_e (I + \\eta Q_e)$, with scalar $\\eta$.\n- **Generalized Eigenproblem**:\n  - $K_\\eta x = \\lambda M_\\alpha x$, where $x = [\\mathbf{E}, p]^\\top$.\n  - $K_\\eta = \\begin{bmatrix} A & B_\\eta^\\top \\\\ B_\\eta & -\\gamma I_p \\end{bmatrix}$, with $\\gamma = 10^{-8}$.\n  - $M_\\alpha = \\begin{bmatrix} M_e & 0 \\\\ 0 & \\alpha I_p \\end{bmatrix}$, with $\\alpha = 10^{-8}$.\n- **Solution Method**:\n  - Transform to standard eigenproblem: $M_\\alpha^{-1/2} K_\\eta M_\\alpha^{-1/2} y = \\lambda y$, where $x = M_\\alpha^{-1/2} y$.\n- **Analysis & Diagnostics**:\n  - Compute smallest $k=10$ positive eigenvalues.\n  - Curl ratio: $r_{\\mathrm{curl}} = \\|\\nabla \\times \\mathbf{E}\\|_2 / \\|\\mathbf{E}\\|_2$, with discrete $\\nabla \\times \\mathbf{E} = C \\mathbf{E}$.\n  - Spurious mode: Classified if $r_{\\mathrm{curl}} < \\varepsilon_{\\mathrm{curl}} = 10^{-3}$.\n  - Divergence pollution: Mean of $\\|B_\\eta \\mathbf{E}\\|_2 / \\|\\mathbf{E}\\|_2$ over physical modes.\n  - Crime norm: $\\mathrm{crime\\_norm}(\\eta) = \\|B_\\eta - B\\|_2 / \\|B\\|_2$.\n- **Test Suite**: $\\eta \\in \\{0.0, 10^{-3}, 10^{-1}, 0.5, -0.3\\}$.\n- **Output Format**: Single line `[[s1,d1,c1],[s2,d2,c2],...]`.\n\n#### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard topic in computational electromagnetics mixed finite element methods. It is well-posed, with all parameters, matrices, and methods specified unambiguously. The formulation of discrete operators on a structured grid, the assembly of the mixed system, and the proposed analysis are all standard and consistent procedures. There are no contradictions, missing data, or subjective elements. The problem is a formal and verifiable numerical experiment.\n\n#### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation and Implementation\nThe solution involves programmatically implementing the discrete representation of the mixed eigenproblem. The process is broken down into the following steps: defining the mesh, constructing the discrete differential operators, assembling the system matrices, solving the generalized eigenproblem for each perturbation parameter $\\eta$, and finally computing the required diagnostics.\n\n1.  **Mesh and DOF Definition**:\n    First, we establish the dimensions of our problem based on the grid parameters $N_x=4$ and $N_y=4$. This defines the number of nodes, horizontal edges, vertical edges, and cells.\n    - Number of nodes for $p$: $N_p = N_x \\times N_y = 4 \\times 4 = 16$.\n    - Number of horizontal edges for $E_x$: $N_{h} = (N_x - 1) \\times N_y = 3 \\times 4 = 12$.\n    - Number of vertical edges for $E_y$: $N_{v} = N_x \\times (N_y - 1) = 4 \\times 3 = 12$.\n    - Total number of edges for $\\mathbf{E}$: $N_{e} = N_{h} + N_{v} = 24$.\n    - Number of cells: $N_{c} = (N_x - 1) \\times (N_y - 1) = 3 \\times 3 = 9$.\n    We define a consistent indexing scheme to map the 2D grid locations of DOFs to 1D vector indices.\n\n2.  **Discrete Operator Construction**:\n    - **Gradient Operator $G$**: A matrix of size $N_e \\times N_p$ is constructed. Each row corresponds to an edge, and its non-zero entries represent the finite difference $p_{end} - p_{start}$ associated with that edge, implementing the discrete gradient.\n    - **Curl Operator $C$**: A matrix of size $N_c \\times N_e$ is constructed. Each row corresponds to a cell, and its non-zero entries (values of $+1$ or $-1$) represent the coefficients of the four edge DOFs that form the boundary of the cell, implementing the discrete circulation $\\oint \\mathbf{E} \\cdot d\\mathbf{l}$.\n\n3.  **System Matrix Assembly**:\n    - **Mass Matrices**: The diagonal matrices $M_e$ and $W$ are formed. $M_e$ (size $N_e \\times N_e$) contains the lengths of the edges ($h_x$ or $h_y$) on its diagonal, weighting the edge-based inner product. $W$ (size $N_c \\times N_c$) contains the cell areas ($h_x h_y$), weighting the cell-based inner product.\n    - **Stiffness and Constraint Matrices**:\n        - The discrete curl-curl stiffness matrix is $A = C^\\top W C$ (size $N_e \\times N_e$).\n        - The exact discrete constraint matrix is $B = G^\\top M_e$ (size $N_p \\times N_e$). This matrix represents the discrete version of the divergence operator in the weak formulation.\n    - **Perturbation**: For each $\\eta$ in the test suite, we construct the perturbed constraint matrix $B_\\eta = G^\\top M_e (I + \\eta Q_e)$, where $Q_e$ is a diagonal matrix of alternating signs.\n\n4.  **Eigenproblem Formulation and Solution**:\n    - The block matrices $K_\\eta$ and $M_\\alpha$ are assembled according to the problem specification.\n    - The generalized eigenproblem $K_\\eta x = \\lambda M_\\alpha x$ is a saddle-point problem. To solve it using standard symmetric eigensolvers, we convert it into $K' y = \\lambda y$ where $K' = M_\\alpha^{-1/2} K_\\eta M_\\alpha^{-1/2}$ and $x = M_\\alpha^{-1/2} y$. Since $M_\\alpha$ is diagonal and positive definite, $M_\\alpha^{-1/2}$ is trivial to compute.\n    - The symmetric matrix $K'$ is solved for its eigenvalues $\\lambda$ and eigenvectors $y$ using `numpy.linalg.eigh`. The original eigenvectors $x$ are recovered.\n\n5.  **Post-processing and Diagnostics**:\n    - For each $\\eta$, the resulting eigenspectrum is analyzed. We filter for the smallest $k=10$ positive eigenvalues.\n    - For each corresponding eigenvector $x = [\\mathbf{E}, p]^\\top$:\n        - The curl ratio $r_{\\mathrm{curl}} = \\|C \\mathbf{E}\\|_2 / \\|\\mathbf{E}\\|_2$ is computed. If $r_{\\mathrm{curl}} < 10^{-3}$, the mode is classified as spurious.\n        - If the mode is physical, its contribution to divergence pollution, $\\|B_\\eta \\mathbf{E}\\|_2 / \\|\\mathbf{E}\\|_2$, is calculated.\n    - The average divergence pollution across all physical modes is computed for each $\\eta$.\n    - The magnitude of the variational crime is quantified by the relative spectral norm of the operator perturbation, $\\mathrm{crime\\_norm}(\\eta) = \\|B_\\eta - B\\|_2 / \\|B\\|_2$.\n    - The results (spurious mode count, mean divergence pollution, crime norm) for each $\\eta$ are collected and formatted into the required output string.\n\nThe implementation follows these steps precisely, providing a quantitative analysis of how a specific variational crime—a perturbation in the weak enforcement of tangential continuity—introduces non-physical divergence into the computed electric field eigenmodes and affects the structure of the discrete eigenspectrum.",
            "answer": "[[0,0.000000e+00,0.000000e+00],[0,2.146604e-04,1.000000e-03],[0,2.146604e-02,1.000000e-01],[0,1.073302e-01,5.000000e-01],[0,6.439812e-02,3.000000e-01]]"
        },
        {
            "introduction": "Beyond solving a single simulation, a major challenge in computational science is efficiently exploring how a system behaves across a range of parameters. This advanced practice introduces the powerful reduced-basis method (RBM) applied to a mixed finite element formulation . You will construct a highly efficient, low-dimensional model from a few high-fidelity \"truth\" solutions, a process vital for applications in design, optimization, and uncertainty quantification. This exercise guides you through the crucial steps of ensuring model stability via supremizer enrichment and certifying its accuracy with a posteriori error bounds, placing you at the cutting edge of modern computational engineering.",
            "id": "3331068",
            "problem": "Consider the time-harmonic Maxwell equations in a perfectly electrically conducting cavity with angular frequency $\\omega$, electric field $\\mathbf{E}$, magnetic permeability $\\mu_0$, and permittivity $\\epsilon(\\mu)$. A standard mixed variational formulation introduces a Lagrange multiplier $p$ to weakly enforce a divergence constraint. The continuous mixed formulation seeks $(\\mathbf{E}(\\mu), p(\\mu))$ such that for all test functions $(\\mathbf{v}, q)$,\n$$\n(\\mu_0^{-1}\\nabla \\times \\mathbf{E}(\\mu), \\nabla \\times \\mathbf{v}) - \\omega^2(\\epsilon(\\mu)\\mathbf{E}(\\mu), \\mathbf{v}) + (\\nabla \\cdot \\mathbf{v}, p(\\mu)) = ( \\mathbf{f}, \\mathbf{v}),\n$$\n$$\n(\\nabla \\cdot \\mathbf{E}(\\mu), q) = (g, q).\n$$\nDiscretize this mixed problem using a truth finite element space for the electric field on a small mesh and a compatible space for the Lagrange multiplier, resulting in a symmetric saddle-point algebraic system of the form\n$$\n\\begin{bmatrix}\n\\mathbf{A}(\\mu) & \\mathbf{B}^{\\top} \\\\\n\\mathbf{B} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{x}(\\mu) \\\\\n\\mathbf{p}(\\mu)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f} \\\\\n\\mathbf{g}\n\\end{bmatrix},\n$$\nwhere $\\mathbf{A}(\\mu) \\in \\mathbb{R}^{n_v \\times n_v}$ is symmetric positive definite for all $\\mu$ and $\\mathbf{B} \\in \\mathbb{R}^{n_p \\times n_v}$ has full row rank. For this problem, use the following explicit affine parameterization and data:\n- The velocity block is\n$$\n\\mathbf{A}(\\mu) = \\mathbf{A}_1 + \\mu \\mathbf{A}_2,\n$$\nwith\n$$\n\\mathbf{A}_1 =\n\\begin{bmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{bmatrix},\\quad\n\\mathbf{A}_2 =\n\\begin{bmatrix}\n1 & 0.2 & 0 \\\\\n0.2 & 1 & 0.2 \\\\\n0 & 0.2 & 1\n\\end{bmatrix}.\n$$\n- The coupling block is\n$$\n\\mathbf{B} =\n\\begin{bmatrix}\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{bmatrix}.\n$$\n- The right-hand side is\n$$\n\\mathbf{f} =\n\\begin{bmatrix}\n1 \\\\\n0 \\\\\n-1\n\\end{bmatrix}, \\quad\n\\mathbf{g} =\n\\begin{bmatrix}\n0 \\\\\n0\n\\end{bmatrix}.\n$$\nAll quantities are nondimensional; report all numerical outputs as dimensionless quantities.\n\nYour task is to construct a mixed reduced-basis model with supremizer enrichment that is stable with respect to the inf–sup (Ladyzhenskaya–Babuška–Brezzi) condition and to certify the reduced solutions using an a posteriori residual-based estimator derived from first principles.\n\nFollow these steps:\n\n1. Define the velocity norm by the parameter-dependent energy inner product induced by $\\mathbf{A}(\\mu)$: for any $\\mathbf{v}$, let $\\lVert \\mathbf{v} \\rVert_{V(\\mu)} = \\sqrt{\\mathbf{v}^{\\top} \\mathbf{A}(\\mu) \\mathbf{v}}$. Define the pressure norm as the Euclidean norm $\\lVert \\cdot \\rVert_{2}$ on $\\mathbb{R}^{n_p}$.\n\n2. Truth problem. For any parameter $\\mu$, define the truth solution $(\\mathbf{x}(\\mu), \\mathbf{p}(\\mu))$ as the unique solution of the saddle-point system above. Compute truth solutions using the Schur complement reduction to $\\mathbf{p}(\\mu)$ and back-substitution for $\\mathbf{x}(\\mu)$.\n\n3. Reduced-basis construction (offline). Choose a reference parameter $\\mu_{\\mathrm{ref}} = 1.0$ and training parameters $\\mathcal{T} = \\{0.7, 1.3\\}$. Build the following:\n   - A velocity snapshot matrix by collecting truth $\\mathbf{x}(\\mu)$ for $\\mu \\in \\mathcal{T}$.\n   - A pressure snapshot matrix by collecting truth $\\mathbf{p}(\\mu)$ for $\\mu \\in \\mathcal{T}$.\n   - Orthonormalize the velocity snapshots using Gram–Schmidt with respect to the $\\mathbf{A}(\\mu_{\\mathrm{ref}})$-inner product to obtain a velocity basis $\\mathbf{V} \\in \\mathbb{R}^{n_v \\times N_v}$.\n   - Orthonormalize the pressure snapshots in the Euclidean inner product to obtain a pressure basis $\\mathbf{W} \\in \\mathbb{R}^{n_p \\times N_p}$.\n   - Supremizer enrichment: For each pressure basis vector $\\boldsymbol{\\phi}_j$ (column of $\\mathbf{W}$), compute the supremizer $\\mathbf{s}_j$ by solving\n     $$\n     \\mathbf{A}(\\mu_{\\mathrm{ref}})\\,\\mathbf{s}_j = \\mathbf{B}^{\\top} \\boldsymbol{\\phi}_j.\n     $$\n     Enrich the velocity space by adding all $\\mathbf{s}_j$ to the columns of $\\mathbf{V}$ and re-orthonormalize with respect to the $\\mathbf{A}(\\mu_{\\mathrm{ref}})$-inner product.\n\n4. Reduced mixed system (online). For a given test parameter $\\mu$, compute the reduced solution $(\\mathbf{x}_N(\\mu), \\mathbf{p}_N(\\mu))$ in the spaces spanned by $\\mathbf{V}$ and $\\mathbf{W}$ by solving the reduced saddle-point system\n$$\n\\begin{bmatrix}\n\\mathbf{V}^{\\top}\\mathbf{A}(\\mu)\\mathbf{V} & \\mathbf{V}^{\\top}\\mathbf{B}^{\\top}\\mathbf{W} \\\\\n\\mathbf{W}^{\\top}\\mathbf{B}\\mathbf{V} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\widehat{\\mathbf{x}}(\\mu) \\\\\n\\widehat{\\mathbf{p}}(\\mu)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{V}^{\\top}\\mathbf{f} \\\\\n\\mathbf{W}^{\\top}\\mathbf{g}\n\\end{bmatrix},\n$$\nand set $\\mathbf{x}_N(\\mu) = \\mathbf{V}\\,\\widehat{\\mathbf{x}}(\\mu)$ and $\\mathbf{p}_N(\\mu) = \\mathbf{W}\\,\\widehat{\\mathbf{p}}(\\mu)$.\n\n5. Residuals and certified a posteriori bound. For a given $\\mu$, define the velocity residual $\\mathbf{r}_v(\\mu) = \\mathbf{f} - \\mathbf{A}(\\mu)\\mathbf{x}_N(\\mu) - \\mathbf{B}^{\\top}\\mathbf{p}_N(\\mu)$ and the constraint residual $\\mathbf{r}_q(\\mu) = \\mathbf{g} - \\mathbf{B}\\mathbf{x}_N(\\mu)$. Define their dual norms as\n$$\n\\lVert \\mathbf{r}_v(\\mu) \\rVert_{V(\\mu)^{\\ast}} = \\sqrt{\\mathbf{r}_v(\\mu)^{\\top} \\mathbf{A}(\\mu)^{-1} \\mathbf{r}_v(\\mu)}, \\quad\n\\lVert \\mathbf{r}_q(\\mu) \\rVert_{2} = \\lVert \\mathbf{r}_q(\\mu) \\rVert_{\\mathbb{R}^{n_p}}.\n$$\nLet the parameter-dependent inf–sup constant under the chosen norms be\n$$\n\\beta(\\mu) = \\inf_{\\mathbf{q} \\neq \\mathbf{0}} \\sup_{\\mathbf{v} \\neq \\mathbf{0}} \\frac{\\mathbf{q}^{\\top}\\mathbf{B}\\mathbf{v}}{\\lVert \\mathbf{v} \\rVert_{V(\\mu)} \\lVert \\mathbf{q} \\rVert_{2}} = \\sqrt{\\lambda_{\\min}\\!\\left(\\mathbf{B}\\,\\mathbf{A}(\\mu)^{-1}\\mathbf{B}^{\\top}\\right)}.\n$$\nUsing the chosen norms and the symmetry of $\\mathbf{A}(\\mu)$, certify the reduced solution via the following a posteriori bound for the electric field (velocity) error:\n$$\n\\lVert \\mathbf{x}(\\mu) - \\mathbf{x}_N(\\mu) \\rVert_{V(\\mu)} \\leq \\Delta_V(\\mu) \\equiv \\lVert \\mathbf{r}_v(\\mu) \\rVert_{V(\\mu)^{\\ast}} + \\frac{1}{\\beta(\\mu)} \\lVert \\mathbf{r}_q(\\mu) \\rVert_{2}.\n$$\n\nYour program must:\n- Implement the complete offline–online procedure above.\n- Use the explicit matrices and vectors provided.\n- Compute the certified error bound $\\Delta_V(\\mu)$ for each test parameter.\n\nTest suite:\n- Evaluate at the parameters $\\mu \\in \\{0.8, 1.0, 1.8, 0.5\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing a Python-style list of the four certified bounds in the order of the test suite parameters, with each float rounded to $6$ decimal places, e.g., $[\\Delta_V(0.8), \\Delta_V(1.0), \\Delta_V(1.8), \\Delta_V(0.5)]$.\n\nAll computations are deterministic and dimensionless; no physical units are required. Angles do not appear. The output must be exactly one line, as specified, with no additional text.",
            "solution": "The problem requires the construction and certification of a mixed reduced-basis model for a parameterized saddle-point system arising from the finite element discretization of the time-harmonic Maxwell equations. The procedure involves an offline stage for basis generation and an online stage for rapid solution and error estimation.\n\nThe governing high-fidelity (or \"truth\") algebraic system for a given parameter $\\mu$ is the saddle-point problem:\n$$\n\\begin{bmatrix}\n\\mathbf{A}(\\mu) & \\mathbf{B}^{\\top} \\\\\n\\mathbf{B} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{x}(\\mu) \\\\\n\\mathbf{p}(\\mu)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f} \\\\\n\\mathbf{g}\n\\end{bmatrix}\n$$\nwhere $\\mathbf{x}(\\mu) \\in \\mathbb{R}^{n_v}$ represents the discretized electric field coefficients (the \"velocity\") and $\\mathbf{p}(\\mu) \\in \\mathbb{R}^{n_p}$ is the discretized Lagrange multiplier (the \"pressure\"). The parameter-dependent matrix $\\mathbf{A}(\\mu)$ is given by the affine expansion $\\mathbf{A}(\\mu) = \\mathbf{A}_1 + \\mu \\mathbf{A}_2$. The given matrices are:\n$$\n\\mathbf{A}_1 =\n\\begin{bmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{bmatrix},\\quad\n\\mathbf{A}_2 =\n\\begin{bmatrix}\n1 & 0.2 & 0 \\\\\n0.2 & 1 & 0.2 \\\\\n0 & 0.2 & 1\n\\end{bmatrix},\\quad\n\\mathbf{B} =\n\\begin{bmatrix}\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{bmatrix}\n$$\nand the right-hand side vectors are:\n$$\n\\mathbf{f} =\n\\begin{bmatrix}\n1 \\\\\n0 \\\\\n-1\n\\end{bmatrix}, \\quad\n\\mathbf{g} =\n\\begin{bmatrix}\n0 \\\\\n0\n\\end{bmatrix}\n$$\nwith $n_v = 3$ and $n_p = 2$.\n\nThe solution process is divided into the standard offline and online stages of the reduced basis method.\n\n**1. Truth Solution via Schur Complement**\n\nFor any given $\\mu$, the truth solution $(\\mathbf{x}(\\mu), \\mathbf{p}(\\mu))$ is computed by first solving for the pressure $\\mathbf{p}(\\mu)$ using a Schur complement approach. From the first block row of the system, we express $\\mathbf{x}(\\mu)$ in terms of $\\mathbf{p}(\\mu)$:\n$$\n\\mathbf{A}(\\mu)\\mathbf{x}(\\mu) = \\mathbf{f} - \\mathbf{B}^{\\top}\\mathbf{p}(\\mu) \\implies \\mathbf{x}(\\mu) = \\mathbf{A}(\\mu)^{-1}(\\mathbf{f} - \\mathbf{B}^{\\top}\\mathbf{p}(\\mu))\n$$\nSubstituting this into the second block row, $\\mathbf{B}\\mathbf{x}(\\mu) = \\mathbf{g}$, yields a system solely for $\\mathbf{p}(\\mu)$:\n$$\n\\mathbf{B}\\mathbf{A}(\\mu)^{-1}(\\mathbf{f} - \\mathbf{B}^{\\top}\\mathbf{p}(\\mu)) = \\mathbf{g}\n$$\nRearranging gives the Schur complement system:\n$$\n(\\mathbf{B}\\mathbf{A}(\\mu)^{-1}\\mathbf{B}^{\\top}) \\mathbf{p}(\\mu) = \\mathbf{B}\\mathbf{A}(\\mu)^{-1}\\mathbf{f} - \\mathbf{g}\n$$\nAfter solving this $n_p \\times n_p$ system for $\\mathbf{p}(\\mu)$, the velocity $\\mathbf{x}(\\mu)$ is recovered via back-substitution.\n\n**2. Offline Stage: Basis Construction**\n\nThis stage is performed once to generate the reduced-basis spaces.\nThe reference parameter is $\\mu_{\\mathrm{ref}} = 1.0$, and the training set is $\\mathcal{T} = \\{0.7, 1.3\\}$.\n\nFirst, we compute the truth solutions $(\\mathbf{x}(\\mu), \\mathbf{p}(\\mu))$ for each $\\mu \\in \\mathcal{T}$. These solutions form the columns of the snapshot matrices:\n$$\n\\mathbf{S}_v = [\\mathbf{x}(0.7), \\mathbf{x}(1.3)], \\quad \\mathbf{S}_p = [\\mathbf{p}(0.7), \\mathbf{p}(1.3)]\n$$\n\nNext, we construct orthonormal bases from these snapshots.\n- The pressure basis $\\mathbf{W} \\in \\mathbb{R}^{n_p \\times N_p}$ is obtained by applying the Gram-Schmidt algorithm to the columns of $\\mathbf{S}_p$ with respect to the standard Euclidean inner product.\n- An initial velocity basis is formed by orthonormalizing the columns of $\\mathbf{S}_v$ using the Gram-Schmidt algorithm with respect to the energy inner product $(\\mathbf{u}, \\mathbf{v})_{V(\\mu_{\\mathrm{ref}})} = \\mathbf{u}^{\\top}\\mathbf{A}(\\mu_{\\mathrm{ref}})\\mathbf{v}$.\n\nTo ensure the stability of the reduced mixed formulation (i.e., to satisfy the inf-sup condition uniformly), the velocity basis is enriched with supremizers. For each pressure basis vector $\\boldsymbol{\\phi}_j$ (a column of $\\mathbf{W}$), we compute the corresponding supremizer vector $\\mathbf{s}_j \\in \\mathbb{R}^{n_v}$ by solving:\n$$\n\\mathbf{A}(\\mu_{\\mathrm{ref}})\\mathbf{s}_j = \\mathbf{B}^{\\top}\\boldsymbol{\\phi}_j\n$$\nThe set of initial velocity basis vectors is augmented with these supremizer vectors $\\{\\mathbf{s}_j\\}$. This enriched set of vectors is then re-orthonormalized with respect to the $\\mathbf{A}(\\mu_{\\mathrm{ref}})$-inner product to yield the final, stable velocity basis $\\mathbf{V} \\in \\mathbb{R}^{n_v \\times N_v}$.\n\n**3. Online Stage: Reduced Solution and Certification**\n\nFor a new test parameter $\\mu$, we seek an approximate solution $(\\mathbf{x}_N(\\mu), \\mathbf{p}_N(\\mu))$ in the reduced spaces spanned by the columns of $\\mathbf{V}$ and $\\mathbf{W}$, respectively. We write $\\mathbf{x}_N(\\mu) = \\mathbf{V}\\widehat{\\mathbf{x}}(\\mu)$ and $\\mathbf{p}_N(\\mu) = \\mathbf{W}\\widehat{\\mathbf{p}}(\\mu)$, where $\\widehat{\\mathbf{x}}(\\mu) \\in \\mathbb{R}^{N_v}$ and $\\widehat{\\mathbf{p}}(\\mu) \\in \\mathbb{R}^{N_p}$ are the vectors of reduced-basis coefficients.\n\nSubstituting these representations into the weak formulation and testing against functions from the reduced spaces (a Bubnov-Galerkin projection) leads to the reduced-order saddle-point system:\n$$\n\\begin{bmatrix}\n\\mathbf{A}_N(\\mu) & \\mathbf{B}_N^{\\top} \\\\\n\\mathbf{B}_N & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\widehat{\\mathbf{x}}(\\mu) \\\\\n\\widehat{\\mathbf{p}}(\\mu)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f}_N \\\\\n\\mathbf{g}_N\n\\end{bmatrix}\n$$\nwhere the reduced operators are defined as:\n$$\n\\mathbf{A}_N(\\mu) = \\mathbf{V}^{\\top}\\mathbf{A}(\\mu)\\mathbf{V}, \\quad \\mathbf{B}_N = \\mathbf{W}^{\\top}\\mathbf{B}\\mathbf{V}, \\quad \\mathbf{f}_N = \\mathbf{V}^{\\top}\\mathbf{f}, \\quad \\mathbf{g}_N = \\mathbf{W}^{\\top}\\mathbf{g}\n$$\nNote that due to the affine structure of $\\mathbf{A}(\\mu)$, the reduced matrix $\\mathbf{A}_N(\\mu)$ can be computed efficiently as $\\mathbf{A}_N(\\mu) = \\mathbf{V}^{\\top}(\\mathbf{A}_1 + \\mu\\mathbf{A}_2)\\mathbf{V} = \\mathbf{V}^{\\top}\\mathbf{A}_1\\mathbf{V} + \\mu\\mathbf{V}^{\\top}\\mathbf{A}_2\\mathbf{V}$. This avoids re-projections for every new $\\mu$. The system is solved for the coefficients $(\\widehat{\\mathbf{x}}(\\mu), \\widehat{\\mathbf{p}}(\\mu))$, from which the full-order approximate solutions are reconstructed.\n\n**4. A Posteriori Error Certification**\n\nThe accuracy of the reduced solution is certified using a residual-based a posteriori error estimator. The velocity and constraint residuals are:\n$$\n\\mathbf{r}_v(\\mu) = \\mathbf{f} - \\mathbf{A}(\\mu)\\mathbf{x}_N(\\mu) - \\mathbf{B}^{\\top}\\mathbf{p}_N(\\mu), \\quad \\mathbf{r}_q(\\mu) = \\mathbf{g} - \\mathbf{B}\\mathbf{x}_N(\\mu)\n$$\nThe error in the velocity solution, measured in the parameter-dependent energy norm $\\lVert \\mathbf{v} \\rVert_{V(\\mu)} = \\sqrt{\\mathbf{v}^{\\top} \\mathbf{A}(\\mu) \\mathbf{v}}$, is bounded by $\\Delta_V(\\mu)$:\n$$\n\\lVert \\mathbf{x}(\\mu) - \\mathbf{x}_N(\\mu) \\rVert_{V(\\mu)} \\leq \\Delta_V(\\mu) \\equiv \\lVert \\mathbf{r}_v(\\mu) \\rVert_{V(\\mu)^{\\ast}} + \\frac{1}{\\beta(\\mu)} \\lVert \\mathbf{r}_q(\\mu) \\rVert_{2}\n$$\nThis bound requires computing three quantities:\n- The dual norm of the velocity residual: $\\lVert \\mathbf{r}_v(\\mu) \\rVert_{V(\\mu)^{\\ast}} = \\sqrt{\\mathbf{r}_v(\\mu)^{\\top} \\mathbf{A}(\\mu)^{-1} \\mathbf{r}_v(\\mu)}$.\n- The Euclidean norm of the constraint residual: $\\lVert \\mathbf{r}_q(\\mu) \\rVert_{2}$.\n- The parameter-dependent inf-sup constant: $\\beta(\\mu) = \\sqrt{\\lambda_{\\min}\\!\\left(\\mathbf{B}\\,\\mathbf{A}(\\mu)^{-1}\\mathbf{B}^{\\top}\\right)}$, where $\\lambda_{\\min}$ denotes the minimum eigenvalue.\n\nThe computation of the bound for each test parameter $\\mu \\in \\{0.8, 1.0, 1.8, 0.5\\}$ involves evaluating these components and summing them. This provides a rigorous and computable certificate of the reduced model's accuracy without knowledge of the true solution $\\mathbf{x}(\\mu)$.",
            "answer": "[0.089475,0.000000,0.205739,0.134586]"
        }
    ]
}