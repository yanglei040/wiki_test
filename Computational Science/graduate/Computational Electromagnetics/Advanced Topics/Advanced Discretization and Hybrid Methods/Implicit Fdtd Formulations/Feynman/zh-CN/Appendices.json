{
    "hands_on_practices": [
        {
            "introduction": "隐式方法因其无条件稳定性而备受青睐，但理解它们如何再现能量损失等物理现象也至关重要。这项练习  对后向欧拉格式进行了基础分析。通过在一个简化场景中推导数值耗散率，您将深入了解时间步长 $\\Delta t$ 的选择如何影响耗散过程的模拟精度。",
            "id": "3318776",
            "problem": "考虑一个均匀、各向同性的线性介质，其特征为介电常数 $\\epsilon$、磁导率 $\\mu$ 和电导率 $\\sigma$。设电磁场由包含传导电流的麦克斯韦方程组描述，并假设本构关系为 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 和 $\\mathbf{B} = \\mu \\mathbf{H}$，以及欧姆定律 $\\mathbf{J} = \\sigma \\mathbf{E}$。在一维空间中，对于横电磁（TEM）极化（例如，$\\mathbf{E} = E_y(x,t)\\,\\hat{\\mathbf{y}}$ 和 $\\mathbf{H} = H_z(x,t)\\,\\hat{\\mathbf{z}}$ 依赖于 $x$），控制方程可以用 $E_y$ 和 $H_z$ 来表示。\n\n从这些定律出发，为时域有限差分（FDTD, Finite-Difference Time-Domain）方法推导全隐式后向欧拉时间步进格式，该格式将场从时间 $t^n$ 推进到 $t^{n+1} = t^n + \\Delta t$。请将 $E_y^{n+1}$ 和 $H_z^{n+1}$ 的更新表示为在 $t^{n+1}$ 处计算的空间旋度算子以及前一时刻的场 $E_y^n$ 和 $H_z^n$ 的函数。\n\n然后，特化到空间均匀的情况，此时空间导数消失，因此旋度项为零。在这种均匀情况下，关注离散电场能量密度 $u_e^n = \\tfrac{1}{2}\\epsilon |E_y^n|^2$ 及其在后向欧拉格式下更新到 $u_e^{n+1} = \\tfrac{1}{2}\\epsilon |E_y^{n+1}|^2$ 的过程。将每个时间步长的电场能量的数值耗散率定义为\n$$\n\\mathcal{D}_{\\text{num}}(\\Delta t) \\equiv \\frac{1}{\\Delta t}\\,\\ln\\!\\left(\\frac{u_e^n}{u_e^{n+1}}\\right),\n$$\n并确定下列关于 $\\mathcal{D}_{\\text{num}}(\\Delta t)$ 作为 $\\Delta t$、$\\epsilon$、$\\mu$ 和 $\\sigma$ 的函数的表达式中，哪一个是正确的。\n\n选择一项：\n\nA. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{2}{\\Delta t}\\,\\ln\\!\\left(1 + \\frac{\\sigma\\,\\Delta t}{\\epsilon}\\right)$\n\nB. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{\\sigma}{\\epsilon}$\n\nC. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{2\\,\\sigma}{\\epsilon + \\mu}$\n\nD. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{1}{\\Delta t}\\,\\ln\\!\\left(1 + \\frac{\\sigma\\,\\Delta t}{\\epsilon}\\right)$",
            "solution": "对问题陈述进行有效性评估。\n\n**第1步：提取已知条件**\n- 介质：均匀、各向同性、线性。\n- 材料属性：介电常数 $\\epsilon$、磁导率 $\\mu$、电导率 $\\sigma$。\n- 控制方程：包含传导电流的麦克斯韦方程组。\n- 本构关系：$\\mathbf{D} = \\epsilon \\mathbf{E}$，$\\mathbf{B} = \\mu \\mathbf{H}$。\n- 欧姆定律：$\\mathbf{J} = \\sigma \\mathbf{E}$。\n- 场配置：一维空间（$x$）中的TEM极化，$\\mathbf{E} = E_y(x,t)\\,\\hat{\\mathbf{y}}$ 和 $\\mathbf{H} = H_z(x,t)\\,\\hat{\\mathbf{z}}$。\n- 数值格式：用于FDTD的全隐式后向欧拉时间步进，从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$。\n- 特殊情况：空间均匀场，其中空间导数（因此旋度项）为零。\n- 定义：时间步 $k$ 的离散电场能量密度 $u_e^k = \\tfrac{1}{2}\\epsilon |E_y^k|^2$。数值耗散率 $\\mathcal{D}_{\\text{num}}(\\Delta t) \\equiv \\frac{1}{\\Delta t}\\,\\ln\\!\\left(\\frac{u_e^n}{u_e^{n+1}}\\right)$。\n- 问题：确定 $\\mathcal{D}_{\\text{num}}(\\Delta t)$ 的正确表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：**该问题基于经典电磁学的基本原理（麦克斯韦方程组）和标准的数值分析技术（后向欧拉有限差分格式）。这是计算电磁学中一个成熟的课题。\n- **良态问题：**该问题提供了所有必要的定义，并通过清晰、顺序的步骤指导推导过程。目标是推导一个特定的量，该量基于前提具有唯一的数学形式。\n- **客观性：**语言正式、精确，不含主观性。\n\n**第3步：结论与行动**\n该问题在科学上是合理的、良态的、客观的且自洽的。这是一个有效的问题。我们可以继续进行求解。\n\n**推导**\n\n推导过程按照问题的指示分三个阶段进行：首先，推导通用的隐式更新格式；其次，将其特化到均匀情况；第三，计算数值耗散率。\n\n**1. 隐式后向欧拉格式的推导**\n\n我们从两个麦克斯韦旋度方程开始，并结合本构关系和欧姆定律：\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t} = \\sigma \\mathbf{E} + \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} \\quad \\text{（安培-麦克斯韦定律）}\n$$\n$$\n\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t} = - \\mu \\frac{\\partial \\mathbf{H}}{\\partial t} \\quad \\text{（法拉第电磁感应定律）}\n$$\n后向欧拉方法将在时间 $t^{n+1}$ 处的时间导数近似为 $\\frac{\\partial \\mathbf{F}}{\\partial t} \\approx \\frac{\\mathbf{F}^{n+1} - \\mathbf{F}^n}{\\Delta t}$，并在新的时间步 $t^{n+1}$ 计算微分方程中的所有其他项。将此方法应用于麦克斯韦方程组，得到：\n$$\n(\\nabla \\times \\mathbf{H})^{n+1} = \\sigma \\mathbf{E}^{n+1} + \\epsilon \\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^n}{\\Delta t}\n$$\n$$\n(\\nabla \\times \\mathbf{E})^{n+1} = - \\mu \\frac{\\mathbf{H}^{n+1} - \\mathbf{H}^n}{\\Delta t}\n$$\n现在我们求解这些方程以得到时间 $t^{n+1}$ 处的场。由安培-麦克斯韦定律：\n$$\n(\\nabla \\times \\mathbf{H})^{n+1} = \\left(\\sigma + \\frac{\\epsilon}{\\Delta t}\\right) \\mathbf{E}^{n+1} - \\frac{\\epsilon}{\\Delta t} \\mathbf{E}^n\n$$\n对 $\\mathbf{E}^{n+1}$ 进行整理：\n$$\n\\left(\\sigma + \\frac{\\epsilon}{\\Delta t}\\right) \\mathbf{E}^{n+1} = \\frac{\\epsilon}{\\Delta t} \\mathbf{E}^n + (\\nabla \\times \\mathbf{H})^{n+1}\n$$\n乘以 $\\frac{\\Delta t}{\\epsilon}$ 得到：\n$$\n\\left(1 + \\frac{\\sigma \\Delta t}{\\epsilon}\\right) \\mathbf{E}^{n+1} = \\mathbf{E}^n + \\frac{\\Delta t}{\\epsilon} (\\nabla \\times \\mathbf{H})^{n+1}\n$$\n最后，解出 $\\mathbf{E}^{n+1}$：\n$$\n\\mathbf{E}^{n+1} = \\frac{1}{1 + \\frac{\\sigma \\Delta t}{\\epsilon}} \\left( \\mathbf{E}^n + \\frac{\\Delta t}{\\epsilon} (\\nabla \\times \\mathbf{H})^{n+1} \\right) = \\frac{\\epsilon}{\\epsilon + \\sigma \\Delta t} \\mathbf{E}^n + \\frac{\\Delta t}{\\epsilon + \\sigma \\Delta t} (\\nabla \\times \\mathbf{H})^{n+1}\n$$\n由法拉第定律，解出 $\\mathbf{H}^{n+1}$ 更为直接：\n$$\n\\mathbf{H}^{n+1} - \\mathbf{H}^n = - \\frac{\\Delta t}{\\mu} (\\nabla \\times \\mathbf{E})^{n+1}\n$$\n$$\n\\mathbf{H}^{n+1} = \\mathbf{H}^n - \\frac{\\Delta t}{\\mu} (\\nabla \\times \\mathbf{E})^{n+1}\n$$\n这些就是通用的隐式后向欧拉更新方程。\n\n**2. 特化到空间均匀情况**\n\n在空间均匀的情况下，所有空间导数都为零。这意味着任何场向量的旋度都为零：\n$$\n(\\nabla \\times \\mathbf{E})^{n+1} = \\mathbf{0}\n$$\n$$\n(\\nabla \\times \\mathbf{H})^{n+1} = \\mathbf{0}\n$$\n将这些代入更新方程，可以显著简化它们：\n$$\n\\mathbf{E}^{n+1} = \\frac{\\epsilon}{\\epsilon + \\sigma \\Delta t} \\mathbf{E}^n\n$$\n$$\n\\mathbf{H}^{n+1} = \\mathbf{H}^n\n$$\n对于指定的 $\\mathbf{E} = E_y(x,t)\\,\\hat{\\mathbf{y}}$ 极化，电场分量 $E_y$ 的更新为：\n$$\nE_y^{n+1} = \\frac{\\epsilon}{\\epsilon + \\sigma \\Delta t} E_y^n = \\frac{1}{1 + \\frac{\\sigma \\Delta t}{\\epsilon}} E_y^n\n$$\n\n**3. 数值耗散率的计算**\n\n问题将数值耗散率定义为 $\\mathcal{D}_{\\text{num}}(\\Delta t) \\equiv \\frac{1}{\\Delta t}\\,\\ln\\!\\left(\\frac{u_e^n}{u_e^{n+1}}\\right)$。离散电场能量密度为 $u_e^n = \\tfrac{1}{2}\\epsilon |E_y^n|^2$ 和 $u_e^{n+1} = \\tfrac{1}{2}\\epsilon |E_y^{n+1}|^2$。\n\n我们首先计算能量密度的比值：\n$$\n\\frac{u_e^n}{u_e^{n+1}} = \\frac{\\tfrac{1}{2}\\epsilon |E_y^n|^2}{\\tfrac{1}{2}\\epsilon |E_y^{n+1}|^2} = \\left|\\frac{E_y^n}{E_y^{n+1}}\\right|^2\n$$\n根据上一步推导的 $E_y$ 更新方程，我们得到场的比值：\n$$\n\\frac{E_y^{n+1}}{E_y^n} = \\frac{1}{1 + \\frac{\\sigma \\Delta t}{\\epsilon}}\n$$\n取倒数：\n$$\n\\frac{E_y^n}{E_y^{n+1}} = 1 + \\frac{\\sigma \\Delta t}{\\epsilon}\n$$\n将此代入能量比值的表达式中：\n$$\n\\frac{u_e^n}{u_e^{n+1}} = \\left(1 + \\frac{\\sigma \\Delta t}{\\epsilon}\\right)^2\n$$\n现在，我们将这个结果代入数值耗散率的定义中：\n$$\n\\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{1}{\\Delta t}\\,\\ln\\!\\left(\\left(1 + \\frac{\\sigma \\Delta t}{\\epsilon}\\right)^2\\right)\n$$\n使用对数性质 $\\ln(a^b) = b\\ln(a)$，我们得到最终表达式：\n$$\n\\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{2}{\\Delta t}\\,\\ln\\!\\left(1 + \\frac{\\sigma \\Delta t}{\\epsilon}\\right)\n$$\n\n**逐项分析**\n\nA. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{2}{\\Delta t}\\,\\ln\\!\\left(1 + \\frac{\\sigma\\,\\Delta t}{\\epsilon}\\right)$\n此表达式与我们推导的结果完全匹配。\n**结论：正确**\n\nB. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{\\sigma}{\\epsilon}$\n此表达式与 $\\Delta t$ 无关。让我们考察当 $\\Delta t \\to 0$ 时我们推导结果的极限。对小的 $x$ 使用泰勒展开 $\\ln(1+x) \\approx x$：\n$$\n\\lim_{\\Delta t \\to 0} \\mathcal{D}_{\\text{num}}(\\Delta t) = \\lim_{\\Delta t \\to 0} \\frac{2}{\\Delta t} \\left(\\frac{\\sigma \\Delta t}{\\epsilon} + O((\\Delta t)^2)\\right) = \\frac{2\\sigma}{\\epsilon}\n$$\n连续时间系统 $\\frac{dE}{dt} = -\\frac{\\sigma}{\\epsilon}E$ 的解为 $E(t) = E_0 \\exp(-\\frac{\\sigma}{\\epsilon}t)$，这导致能量 $u_e(t) \\propto \\exp(-\\frac{2\\sigma}{\\epsilon}t)$。精确的物理耗散率是 $\\frac{2\\sigma}{\\epsilon}$。当 $\\Delta t \\to 0$ 时，数值耗散率趋近于此值。选项B给出的是 $\\frac{\\sigma}{\\epsilon}$，这与正确值相差一个因子2。\n**结论：错误**\n\nC. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{2\\,\\sigma}{\\epsilon + \\mu}$\n在空间均匀的情况下，电场 $\\mathbf{E}$ 的演化由常微分方程 $\\epsilon \\frac{d \\mathbf{E}}{d t} + \\sigma \\mathbf{E} = \\mathbf{0}$ 控制，该方程不涉及磁导率 $\\mu$。此选项中出现 $\\mu$ 表明它对于此特定问题是错误的。\n**结论：错误**\n\nD. $\\displaystyle \\mathcal{D}_{\\text{num}}(\\Delta t) = \\frac{1}{\\Delta t}\\,\\ln\\!\\left(1 + \\frac{\\sigma\\,\\Delta t}{\\epsilon}\\right)$\n此表达式正好是我们推导结果的一半。如果在对数内部错误地使用了场的比值 $|E_y^n / E_y^{n+1}|$ 而不是能量的比值 $|E_y^n / E_y^{n+1}|^2$，就会产生这个错误。由于能量密度与场的大小的平方成正比，因此因子2是必不可少的。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "从一维扩展到多维时，完全隐式方法的计算成本会变得非常高昂，而交替方向隐式（ADI）方法为此提供了一种巧妙且高效的解决方案。这项练习  将引导您分析 ADI-FDTD 算法的结构，揭示其如何将一个复杂的多维问题分解为一系列简单、独立的一维系统。理解这种三对角结构是领会 ADI 方法效率的关键。",
            "id": "3318720",
            "problem": "考虑一个二维$z$方向横电（$\\mathrm{TE}_z$）波问题，其控制方程为麦克斯韦方程组。该问题在各向同性、无源介质中，介电常数为$\\epsilon$，磁导率为$\\mu$。计算区域采用均匀Yee网格离散，空间步长为$\\Delta x$和$\\Delta y$，时间步长为$\\Delta t$。电场分量$E_x$和$E_y$分别配置在$(i, j+\\tfrac{1}{2})$和$(i+\\tfrac{1}{2}, j)$处，磁场分量$H_z$配置在$(i,j)$处。其控制方程为时域麦克斯韦旋度方程，\n$$\n\\partial_t E_x = \\frac{1}{\\epsilon}\\,\\partial_y H_z,\\quad\n\\partial_t E_y = -\\frac{1}{\\epsilon}\\,\\partial_x H_z,\\quad\n\\partial_t H_z = \\frac{1}{\\mu}\\left(\\partial_x E_y - \\partial_y E_x\\right).\n$$\n交替方向隐式时域有限差分（ADI-FDTD）格式将一个时间步内的更新分解为两次扫描。在第一个半步$n\\to n+\\tfrac{1}{2}$中，更新在$x$方向上是隐式的，在$y$方向上是显式的；在第二个半步$n+\\tfrac{1}{2}\\to n+1$中，更新在$y$方向上是隐式的，在$x$方向上是显式的。在空间上，使用Yee网格上的二阶中心差分；在时间上，使用与上述描述一致的一阶分裂隐式-显式离散格式。从连续麦克斯韦旋度方程和Yee网格差分定义出发，证明在第一次扫描中，沿每个固定的水平线$j$的未知数在更新$E_y$时构成一个三对角线性系统；在第二次扫描中，沿每个固定的垂直线$i$的未知数在更新$E_x$时构成一个三对角线性系统。基于此结构，设计一个直接行求解器，并根据网格大小$N_x$和$N_y$以及行长度$m$来量化其每个时间步的浮点运算计算复杂度。\n\n选择所有关于ADI-FDTD行求解的代数结构及其复杂度的正确陈述：\n\nA. 在每次ADI扫描中，沿隐式方向的网格线上的更新通过二阶中心差分仅耦合最近邻，从而产生一个三对角系统，该系统可用托马斯算法以$O(m)$的复杂度和每行约$8m$次浮点运算求解；因此，每个时间步两次扫描的成本约为$16\\,N_x N_y$次浮点运算，不计用于辅助显式更新的常数项。\n\nB. Yee网格的交错排列导致每个半步中都与最近邻和次近邻耦合，因此行系统是五对角的；需要一个带宽为5的带状求解器，每个时间步的成本尺度约为$O\\!\\left(5\\,N_x N_y\\right)$。\n\nC. 对于施加在最外层节点上切向电场的狄利克雷条件的理想电导体（PEC）边界，三对角结构保持不变；只有第一个和最后一个对角线元素被修改。如果$\\epsilon$和$\\mu$在空间上是均匀的，使得在一次扫描内所有行矩阵都相同，那么每次扫描可以只进行一次LU分解并对所有行重复使用，从而将均摊成本降低到仅进行前向/后向代换，每行约$4m$次浮点运算，每个时间步约$8\\,N_x N_y$次。\n\nD. 与显式时域有限差分（FDTD）相比，ADI-FDTD需要在每个时间步对一个稠密全局矩阵求逆，对于总共$N$个未知数，这会产生$O(N^3)$的计算复杂度和$O(N^2)$的内存需求。",
            "solution": "用户需要对一个关于二维交替方向隐式时域有限差分（ADI-FDTD）方法的问题进行严格验证和详细解答。\n\n### 第一步：提取已知条件\n- **公式：** 二维$z$方向横电波（$\\mathrm{TE}_z$）。\n- **介质：** 各向同性、无源，介电常数为$\\epsilon$，磁导率为$\\mu$。\n- **网格：** 均匀Yee网格，空间步长为$\\Delta x$、$\\Delta y$，时间步长为$\\Delta t$。\n- **场点位置：**\n    - $E_x$ 在 $(i, j+\\tfrac{1}{2})$\n    - $E_y$ 在 $(i+\\tfrac{1}{2}, j)$\n    - $H_z$ 在 $(i,j)$\n- **控制方程（连续形式）：**\n    $$ \\partial_t E_x = \\frac{1}{\\epsilon}\\,\\partial_y H_z $$\n    $$ \\partial_t E_y = -\\frac{1}{\\epsilon}\\,\\partial_x H_z $$\n    $$ \\partial_t H_z = \\frac{1}{\\mu}\\left(\\partial_x E_y - \\partial_y E_x\\right) $$\n- **数值格式：** ADI-FDTD，将一个时间步的更新分解为两次扫描。\n    - **扫描1 ($n \\to n+\\tfrac{1}{2}$):** $x$方向隐式，$y$方向显式。\n    - **扫描2 ($n+\\tfrac{1}{2} \\to n+1$):** $y$方向隐式，$x$方向显式。\n- **离散化：** 空间上采用二阶中心差分；时间上采用一阶分裂隐式-显式离散。\n- **任务：** 证明三对角系统的形成并量化计算复杂度。\n- **网格大小：** $N_x$, $N_y$。行长度$m$。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于麦克斯韦方程组和ADI-FDTD方法，这些是计算电磁学中标准且成熟的概念。该公式是科学合理的。\n2.  **适定性：** 该问题提供了一套清晰的控制方程和对数值方法的描述。它要求推导代数结构并分析其计算复杂度，这是数值分析中的一项标准任务，并能得出一个唯一且有意义的结果。\n3.  **客观性：** 语言技术性强、精确，没有主观或含糊不清的术语。\n4.  **完整性与一致性：** 问题提供了足够的信息来离散化方程并进行所需的分析。指定的Yee网格交错方式与二阶中心差分算子一致。没有内部矛盾。\n5.  **可行性：** 该设置描述了一个标准的计算场景。推导和复杂度分析是可行的。\n\n### 第三步：结论与行动\n问题陈述是有效的。这是一个计算科学中的适定问题，可以进行严格分析。现在开始求解过程。\n\n### 基于原理的推导\nADI-FDTD方法将一个隐式-显式分裂格式应用于时域麦克斯韦方程组。我们将对隐式项使用Crank-Nicolson类型的时间平均。设$F^n_{i,j}$表示在时间步$n$和网格位置$(i,j)$处的场$F$。Yee网格上的空间导数算子定义为：\n$$ \\delta_x F|_{i,j} = \\frac{F|_{i+1/2,j} - F|_{i-1/2,j}}{\\Delta x} $$\n$$ \\delta_y F|_{i,j} = \\frac{F|_{i,j+1/2} - F|_{i,j-1/2}}{\\Delta y} $$\n\n**扫描1：从时间$n$更新到$n+\\frac{1}{2}$（$x$方向隐式，$y$方向显式）**\n\n关于$x$的空间导数被隐式处理（在时间$n$和$n+\\frac{1}{2}$上平均），而关于$y$的空间导数被显式处理（在时间$n$上取值）。在时间间隔$\\Delta t/2$内的更新方程为：\n$$ (1) \\quad \\frac{E^{n+1/2}_x - E^n_x}{\\Delta t/2} = \\frac{1}{\\epsilon} \\delta_y H_z^n $$\n$$ (2) \\quad \\frac{E^{n+1/2}_y - E^n_y}{\\Delta t/2} = -\\frac{1}{2\\epsilon} (\\delta_x H_z^{n+1/2} + \\delta_x H_z^n) $$\n$$ (3) \\quad \\frac{H^{n+1/2}_z - H^n_z}{\\Delta t/2} = \\frac{1}{2\\mu} (\\delta_x E_y^{n+1/2} + \\delta_x E_y^n) - \\frac{1}{\\mu}\\delta_y E_x^n $$\n\n方程(1)是$E_x$的完全显式更新。方程(2)和(3)构成$E_y^{n+1/2}$和$H_z^{n+1/2}$的耦合系统。为了推导$E_y$的系统，我们消去$H_z^{n+1/2}$。从方程(3)中，我们可以表达出网格点$(i,j)$处的$H_z^{n+1/2}$：\n$$ H_{z,i,j}^{n+1/2} = H_{z,i,j}^n + \\frac{\\Delta t}{4\\mu} (\\delta_x E_{y,i,j}^{n+1/2} + \\delta_x E_{y,i,j}^n) - \\frac{\\Delta t}{2\\mu}\\delta_y E_{x,i,j}^n $$\n让我们将此代入方程(2)在网格点$(i+\\frac{1}{2},j)$处的离散形式：\n$$ E_{y,i+1/2,j}^{n+1/2} - E_{y,i+1/2,j}^n = -\\frac{\\Delta t}{4\\epsilon} (\\delta_x H_{z,i+1/2,j}^{n+1/2} + \\delta_x H_{z,i+1/2,j}^n) $$\n$$ E_{y,i+1/2,j}^{n+1/2} - E_{y,i+1/2,j}^n = -\\frac{\\Delta t}{4\\epsilon \\Delta x} \\left[ (H_{z,i+1,j}^{n+1/2} - H_{z,i,j}^{n+1/2}) + (H_{z,i+1,j}^{n} - H_{z,i,j}^{n}) \\right] $$\n现在我们代入$H_z^{n+1/2}$的表达式：\n$$ H_{z,i+1,j}^{n+1/2} - H_{z,i,j}^{n+1/2} = (H_{z,i+1,j}^{n} - H_{z,i,j}^{n}) + \\frac{\\Delta t}{4\\mu} (\\delta_x E_{y,i+1,j}^{n+1/2} - \\delta_x E_{y,i,j}^{n+1/2}) + ... $$\n关键项是$\\delta_x E_y$算子的差：\n$$ \\delta_x E_{y,i+1,j}^{n+1/2} - \\delta_x E_{y,i,j}^{n+1/2} = \\frac{1}{\\Delta x} \\left( E_{y,i+3/2,j}^{n+1/2} - E_{y,i+1/2,j}^{n+1/2} \\right) - \\frac{1}{\\Delta x} \\left( E_{y,i+1/2,j}^{n+1/2} - E_{y,i-1/2,j}^{n+1/2} \\right) $$\n$$ = \\frac{1}{\\Delta x} \\left( E_{y,i+3/2,j}^{n+1/2} - 2 E_{y,i+1/2,j}^{n+1/2} + E_{y,i-1/2,j}^{n+1/2} \\right) $$\n这是一个离散二阶导数算子。将其代回$E_y$更新方程并收集包含$E_y^{n+1/2}$的项，得到：\n$$ -\\left(\\frac{\\Delta t}{4}\\right)^2 \\frac{1}{\\epsilon\\mu\\Delta x^2} E_{y,i-1/2,j}^{n+1/2} + \\left(1 + 2\\left(\\frac{\\Delta t}{4}\\right)^2 \\frac{1}{\\epsilon\\mu\\Delta x^2}\\right) E_{y,i+1/2,j}^{n+1/2} - \\left(\\frac{\\Delta t}{4}\\right)^2 \\frac{1}{\\epsilon\\mu\\Delta x^2} E_{y,i+3/2,j}^{n+1/2} = \\mathrm{RHS}_i $$\n其中$\\mathrm{RHS}_i$包含时间$n$时所有已知的场值。这是一个关于索引$(i+\\frac{1}{2},j)$处未知量$E_y^{n+1/2}$的线性方程，它只与$x$方向上的最近邻点$(i-\\frac{1}{2},j)$和$(i+\\frac{3}{2},j)$耦合。对于固定的行$j$，这对未知向量$\\{E_{y,i+1/2,j}^{n+1/2}\\}_{i=0...N_x-1}$构成了一个三对角方程组。\n\n**扫描2：从时间$n+\\frac{1}{2}$更新到$n+1$（$y$方向隐式，$x$方向显式）**\n\n根据对称性，$x$和$y$的角色互换。$E_y$的更新现在是显式的，而$E_x$和$H_z$的更新是耦合的，并且在$y$方向上是隐式的。类似的推导表明，对于每个固定的列$i$，未知向量$\\{E_{x,i,j+1/2}^{n+1}\\}_{j=0...N_y-1}$的更新构成一个三对角系统。\n\n**计算复杂度**\n\n一个大小为$m \\times m$的三对角系统可以通过托马斯算法（一种高斯消元法）高效求解，其计算复杂度为$O(m)$。对于直接求解（LU分解和前向/后向代换），浮点运算（flops）次数约为$8m$。\n\n-   **扫描1：** 我们必须为每个水平线$j$求解一个三对角系统。共有$N_y$条这样的线，每条线的长度为$m = N_x$。成本为$N_y \\times O(N_x)$。每行约有$8N_x$次浮点运算，总计约为$8 N_x N_y$次浮点运算。\n-   **扫描2：** 我们必须为每个垂直线$i$求解一个三对角系统。共有$N_x$条这样的线，每条线的长度为$m = N_y$。成本为$N_x \\times O(N_y)$，总计约为$8 N_x N_y$次浮点运算。\n\n每个完整时间步（$n \\to n+1$）中隐式求解的总计算成本是两次扫描成本的总和，约为$16 N_x N_y$次浮点运算。这不包括显式更新和构建右端向量的成本，这些成本的复杂度也为$O(N_x N_y)$。\n\n### 逐项分析\n\n**A. 在每次ADI扫描中，沿隐式方向的网格线上的更新通过二阶中心差分仅耦合最近邻，从而产生一个三对角系统，该系统可用托马斯算法以$O(m)$的复杂度和每行约$8m$次浮点运算求解；因此，每个时间步两次扫描的成本约为$16\\,N_x N_y$次浮点运算，不计用于辅助显式更新的常数项。**\n\n-   **三对角系统：** 我们的推导证实，隐式更新耦合了最近邻，从而产生一个三对角系统。这是使用二阶中心差分的直接结果。**正确**。\n-   **托马斯算法和复杂度：** 托马斯算法是标准的$O(m)$求解器。对于一次完整求解（分解和代换）约$8m$次浮点运算的估计是准确的。**正确**。\n-   **总成本：** 总成本的计算$\\approx 8 N_x N_y + 8 N_x N_y = 16 N_x N_y$是直接得出的。关于辅助显式更新的限定条件也是正确的。**正确**。\n\n这个陈述是对推导过程的完整而准确的总结。\n**结论：正确。**\n\n**B. Yee网格的交错排列导致每个半步中都与最近邻和次近邻耦合，因此行系统是五对角的；需要一个带宽为5的带状求解器，每个时间步的成本尺度约为$O\\!\\left(5\\,N_x N_y\\right)$。**\n\n-   **五对角系统：** 推导表明，来自耦合的$E_y$和$H_z$方程的一阶导数算子($\\delta_x$)的组合，产生了一个作用于$E_y$的类二阶导数算子($\\delta_x^2$)。标准的二阶导数模板是一个3点模板，它产生一个三对角矩阵，而不是一个会产生五对角矩阵的5点模板。Yee网格的交错排列对于产生三对角系统至关重要，它不会产生更宽的模板。**错误**。\n\n**结论：错误。**\n\n**C. 对于施加在最外层节点上切向电场的狄利克雷条件的理想电导体（PEC）边界，三对角结构保持不变；只有第一个和最后一个对角线元素被修改。如果$\\epsilon$和$\\mu$在空间上是均匀的，使得在一次扫描内所有行矩阵都相同，那么每次扫描可以只进行一次LU分解并对所有行重复使用，从而将均摊成本降低到仅进行前向/后向代换，每行约$4m$次浮点运算，每个时间步约$8\\,N_x N_y$次。**\n\n-   **边界条件：** PEC边界施加狄利克雷条件（切向$E=0$）。这将已知量从系统中移除。虽然有多种实现方式，但剩余未知量的三对角结构得以保留。关于修改对角元素的说法指的是一种特定的实现方法。关键点是结构保持不变。**合理/正确**。\n-   **均匀介质优化：** 如果$\\epsilon$和$\\mu$是均匀的，那么在一次扫描中，每条线的三对角矩阵的系数都是相同的。一个标准且高效的优化是每次扫描只计算一次矩阵的LU分解，并将其重用于所有行求解。**正确**。\n-   **均摊成本：** 重用LU分解意味着每行的成本从完整求解（约$8m$）减少到仅进行前向和后向代换。对于LDU分解，前向代换约为$2m$，后向代换约为$2m$，因此每行约$4m$次浮点运算是一个合理的估计。**正确**。\n-   **总优化成本：** 通过此优化，两次扫描的成本约为$(N_y \\times 4N_x) + (N_x \\times 4N_y) = 8 N_x N_y$次浮点运算，外加每次扫描可忽略不计的一次性分解成本。这个计算是一致且正确的。**正确**。\n\n这个陈述准确地描述了在均匀介质中ADI-FDTD的一个关键优化。\n**结论：正确。**\n\n**D. 与显式时域有限差分（FDTD）相比，ADI-FDTD需要在每个时间步对一个稠密全局矩阵求逆，对于总共$N$个未知数，这会产生$O(N^3)$的计算复杂度和$O(N^2)$的内存需求。**\n\n-   **矩阵结构：** ADI分裂的全部目的就是为了避免形成和求解一个大型的全局系统。ADI将多维问题转化为一系列一维隐式问题，每个问题都会产生一个稀疏的三对角矩阵。它不会生成一个*稠密全局矩阵*。**错误**。\n-   **复杂度：** ADI的复杂度是$O(N_x N_y)$，这在总网格单元数$N_{tot} \\propto N_x N_y$上是线性的，即$O(N_{tot})$。求解一个大小为$N_{tot}$的稠密系统的复杂度将是$O(N_{tot}^3)$，这在数量级上要昂贵得多。这个陈述从根本上误解了ADI方法。**错误**。\n\n**结论：错误。**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "任何隐式方法的效率最终都取决于在每个时间步中求解线性系统的速度。这项编码练习  让您亲身体验并探索这一关键的实现细节。通过比较直接求解器（托马斯算法）和迭代求解器（预条件共轭梯度法），您将获得有关两者权衡的实践经验，并亲眼见证预处理对收敛速度的影响。",
            "id": "3318730",
            "problem": "考虑一个一维电磁介质，其标量电场为 $E(x,t)$，磁场为 $H(x,t)$，由介电常数 $\\varepsilon$、磁导率 $\\mu$ 和电导率 $\\sigma$ 表征。从一维空间中的麦克斯韦方程组出发：\n$$\\varepsilon\\,\\partial_t E + \\sigma\\,E = \\partial_x H,\\quad \\mu\\,\\partial_t H = \\partial_x E,$$\n推导一个半隐式时间更新格式，该格式对电导项进行隐式处理，并通过时间中心的空间旋度耦合场。假设在均匀网格上采用狄利克雷边界条件 $E(0,t)=0$ 和 $E(L,t)=0$，其中 $L$ 是区域长度。在空间上使用交错的Yee离散化，在时间上使用基于后向欧拉法的半隐式更新处理电导项，并使用中心耦合处理旋度项，消去磁场，以获得关于内部网格点上新时刻电场 $E^{n+1}$ 的对称正定（SPD）线性系统。证明所得到的关于 $N$ 个内部未知量的系统可以写成以下形式：\n$A\\,\\mathbf{e}^{n+1} = \\mathbf{b},$\n其中 $A$ 是对称正定、三对角的，并且依赖于 $\\Delta t$、$\\Delta x$、$\\varepsilon$、$\\mu$ 和 $\\sigma$，而 $\\mathbf{b}$ 是由先前时刻的场和源确定的已知右端项。明确指出在所述边界条件下保证对称性和正定性的离散算子结构。\n\n实现一个算法研究，以量化预处理共轭梯度（CG）方法在求解由半隐式电导更新产生的SPD子系统时的性能。使用以下要求：\n\n- 构建与均匀网格上 $N$ 个内部点、区域长度 $L$、时间步长 $\\Delta t$、介电常数 $\\varepsilon$、磁导率 $\\mu$ 和电导率 $\\sigma$ 的半隐式更新相对应的SPD三对角矩阵 $A$。对 $E$ 使用狄利克雷边界条件，使得内部点上的离散负拉普拉斯算子表现为三对角算子。连续光速为 $c = 1/\\sqrt{\\mu \\varepsilon}$，离散拉普拉斯算子按 $\\Delta x^{-2}$ 缩放，其中 $\\Delta x = L/(N+1)$。\n- 定义一个三对角预条件子 $M$，它通过保留 $A$ 的对角线并将其非对角线元素乘以一个强度参数 $s \\in [0,1]$ 来近似 $A$，其中 $s=0$ 对应于对角（雅可比）预条件子，$s=1$ 对应于精确的矩阵结构。\n- 为 $A\\,\\mathbf{e}=\\mathbf{b}$ 实现一个预处理共轭梯度（PCG）求解器，使用 $M$ 作为预条件子。当相对残差范数 $\\|\\mathbf{r}_k\\|_2/\\|\\mathbf{b}\\|_2$ 低于容差 $\\tau = 10^{-8}$ 时终止PCG，并报告达到此容差所需的整数迭代次数 $k$。\n- 实现一个直接三对角求解器（Thomas算法）来求解 $A\\,\\mathbf{e}=\\mathbf{b}$，并计算最终残差范数 $\\|\\mathbf{b} - A\\,\\mathbf{e}\\|_2$，作为数值精度的参考。对所有残差使用欧几里得范数。\n\n对所有测试用例使用以下固定的物理和数值参数：区域长度 $L = 1$（米），时间步长 $\\Delta t = 10^{-10}$（秒），介电常数 $\\varepsilon = 8.854187817\\times 10^{-12}$（法拉/米），磁导率 $\\mu = 4\\pi\\times 10^{-7}$（亨利/米），电导率 $\\sigma = 0.1$（西门子/米）。将右端项 $\\mathbf{b}$ 构造为在 $N$ 个内部网格点上值为1的均匀向量。所有输出均为无量纲的整数或浮点数。\n\n测试套件规范：\n\n- 网格大小 $N \\in \\{32,128,512\\}$。\n- 预条件子强度 $s \\in \\{0,0.5,1\\}$。\n- 这会产生由数对 $(N,s)$ 指定的 $9$ 个不同测试用例：\n$$ (32,0),\\ (32,0.5),\\ (32,1),\\ (128,0),\\ (128,0.5),\\ (128,1),\\ (512,0),\\ (512,0.5),\\ (512,1). $$\n\n对于每个测试用例，计算：\n- 达到 $\\tau = 10^{-8}$ 所需的PCG整数迭代次数 $k$。\n- 直接三对角求解的浮点残差范数。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含按上述顺序列出的 $9$ 个结果，每个结果报告为 $[k,r]$ 的括号对，其中 $k$ 是PCG整数迭代次数，$r$ 是直接求解的浮点残差范数。\n- 该单行必须是一个由方括号括起来的、逗号分隔的 $9$ 个括号对列表，例如：\n$$ [[k_1,r_1],[k_2,r_2],\\dots,[k_9,r_9]]. $$",
            "solution": "该问题要求推导一维麦克斯韦方程组的半隐式有限差分时域（FDTD）格式，并随后对得到的线性系统进行数值研究。\n\n### 第1部分：半隐式更新格式的推导\n\n在导电介质中，控制性的麦克斯韦方程组如下：\n$$ \\varepsilon\\,\\partial_t E + \\sigma\\,E = \\partial_x H $$\n$$ \\mu\\,\\partial_t H = \\partial_x E $$\n\n我们在交错的Yee网格上离散化这些方程。电场 $E$ 定义在整数网格点 $x_i = i\\Delta x$ 上，磁场 $H$ 定义在半整数网格点 $x_{i+1/2} = (i+1/2)\\Delta x$ 上。离散场表示为 $E_i^n = E(x_i, n\\Delta t)$ 和 $H_{i+1/2}^n = H(x_{i+1/2}, n\\Delta t)$。空间导数使用中心差分：\n$$ (\\partial_x H)_i \\approx \\frac{H_{i+1/2} - H_{i-1/2}}{\\Delta x} $$\n$$ (\\partial_x E)_{i+1/2} \\approx \\frac{E_{i+1} - E_i}{\\Delta x} $$\n\n问题指定了一个半隐式更新，其中电导项使用后向欧拉法进行隐式处理，场通过时间中心的空间旋度耦合。为了获得关于新时刻电场 $E^{n+1}$ 的单一线性系统，我们必须能够消去磁场。这意味着两个方程都必须推进到相同的时间层。能够导出所需结构的最直接解释是对所有项使用完全隐式（后向欧拉）离散化，这对于此类问题是常见的选择。\n\n让我们在时间 $t^{n+1}$ 处离散化这两个方程：\n$$ \\varepsilon \\frac{E_i^{n+1} - E_i^n}{\\Delta t} + \\sigma E_i^{n+1} = \\frac{H_{i+1/2}^{n+1} - H_{i-1/2}^{n+1}}{\\Delta x} $$\n$$ \\mu \\frac{H_{i+1/2}^{n+1} - H_{i+1/2}^n}{\\Delta t} = \\frac{E_{i+1}^{n+1} - E_i^{n+1}}{\\Delta x} $$\n\n从第二个方程中，我们用新时刻电场 $E^{n+1}$ 和旧时刻磁场 $H^n$ 来表示新时刻磁场 $H^{n+1}$：\n$$ H_{i+1/2}^{n+1} = H_{i+1/2}^n + \\frac{\\Delta t}{\\mu \\Delta x} (E_{i+1}^{n+1} - E_i^{n+1}) $$\n\n现在，将这个 $H^{n+1}$ 的表达式代入第一个离散化方程：\n$$ \\left(\\frac{\\varepsilon}{\\Delta t} + \\sigma\\right) E_i^{n+1} - \\frac{\\varepsilon}{\\Delta t} E_i^n = \\frac{1}{\\Delta x} \\left[ \\left( H_{i+1/2}^n + \\frac{\\Delta t}{\\mu \\Delta x} (E_{i+1}^{n+1} - E_i^{n+1}) \\right) - \\left( H_{i-1/2}^n + \\frac{\\Delta t}{\\mu \\Delta x} (E_i^{n+1} - E_{i-1}^{n+1}) \\right) \\right] $$\n\n我们将涉及未知量 $E^{n+1}$ 的项归到左侧（LHS），将来自时间 $t^n$ 的已知项归到右侧（RHS）：\n$$ \\left(\\frac{\\varepsilon}{\\Delta t} + \\sigma\\right) E_i^{n+1} - \\frac{\\Delta t}{\\mu (\\Delta x)^2} (E_{i+1}^{n+1} - 2E_i^{n+1} + E_{i-1}^{n+1}) = \\frac{\\varepsilon}{\\Delta t} E_i^n + \\frac{H_{i+1/2}^n - H_{i-1/2}^n}{\\Delta x} $$\n\n这个方程可以为每个内部网格点 $i=1, 2, \\dots, N$ 重写。狄利克雷边界条件 $E_0^{n+1} = 0$ 和 $E_{N+1}^{n+1} = 0$ 被并入。这产生了一个形式为 $A\\,\\mathbf{e}^{n+1} = \\mathbf{b}$ 的线性方程组，其中 $\\mathbf{e}^{n+1} = [E_1^{n+1}, \\dots, E_N^{n+1}]^T$。\n\n矩阵 $A$ 是三对角的，具有以下元素：\n- 对角线元素：$A_{i,i} = \\frac{\\varepsilon}{\\Delta t} + \\sigma + \\frac{2\\Delta t}{\\mu (\\Delta x)^2}$\n- 非对角线元素：$A_{i, i\\pm 1} = -\\frac{\\Delta t}{\\mu (\\Delta x)^2}$\n\n右侧向量 $\\mathbf{b}$ 由下式给出：\n$$ b_i = \\frac{\\varepsilon}{\\Delta t} E_i^n + \\frac{H_{i+1/2}^n - H_{i-1/2}^n}{\\Delta x} = \\frac{\\varepsilon}{\\Delta t} E_i^n + (\\partial_x H)^n_i $$\n为了进行数值研究，问题指定使用一个全为1的均匀向量作为 $\\mathbf{b}$。\n\n### 第2部分：系统矩阵 $A$ 的性质\n\n矩阵 $A$ 可以用单位矩阵 $I$ 和针对狄利克雷边界条件的离散负拉普拉斯算子 $L_D$ 来表示。$L_D$ 的矩阵是 $\\frac{1}{(\\Delta x)^2} \\textnormal{tridiag}(-1, 2, -1)$。\n系统矩阵 $A$ 可以写成：\n$$ A = \\left(\\frac{\\varepsilon}{\\Delta t} + \\sigma\\right)I + \\frac{\\Delta t}{\\mu} L_D $$\n\n**对称性：**\n矩阵 $A$ 沿其对角线是常数（$A_{i,j}$ 仅依赖于 $|i-j|$）。因此，$A_{i,j} = A_{j,i}$，所以 $A$ 是对称的。\n\n**正定性：**\n如果对于任何非零向量 $\\mathbf{v}$，二次型 $\\mathbf{v}^T A \\mathbf{v} > 0$，则矩阵是正定的。\n令 $\\alpha = \\frac{\\varepsilon}{\\Delta t} + \\sigma$ 且 $\\beta = \\frac{\\Delta t}{\\mu}$。由于 $\\varepsilon, \\mu, \\sigma, \\Delta t$ 都是正的物理常数，所以 $\\alpha > 0$ 且 $\\beta > 0$。\n二次型为：\n$$ \\mathbf{v}^T A \\mathbf{v} = \\mathbf{v}^T (\\alpha I + \\beta L_D) \\mathbf{v} = \\alpha (\\mathbf{v}^T I \\mathbf{v}) + \\beta (\\mathbf{v}^T L_D \\mathbf{v}) = \\alpha \\|\\mathbf{v}\\|_2^2 + \\beta (\\mathbf{v}^T L_D \\mathbf{v})$$\n具有狄利克雷边界条件的离散拉普拉斯算子 $L_D$ 是已知的对称正定算子。其所有特征值均为正，因此 $\\mathbf{v}^T L_D \\mathbf{v} \\ge 0$。因为 $\\alpha > 0$ 且 $\\beta > 0$，对于任何非零向量 $\\mathbf{v}$，我们有 $\\alpha \\|\\mathbf{v}\\|_2^2 > 0$ 且 $\\beta (\\mathbf{v}^T L_D \\mathbf{v}) \\ge 0$。因此，$\\mathbf{v}^T A \\mathbf{v} > 0$。\n这证明了矩阵 $A$ 是对称正定的（SPD）。这一性质至关重要，因为它保证了唯一解的存在，并使得能够使用高效且稳定的迭代求解器，如共轭梯度法。\n\n### 第3部分：算法实现与研究\n\n数值任务是针对不同的网格大小 $N$ 和预条件子设置 $s$ 求解SPD系统 $A\\mathbf{e} = \\mathbf{b}$。\n- **矩阵 $A$** 使用推导出的对角线（$d$）和非对角线（$o$）元素构建。\n- **预条件子 $M$** 是一个三对角矩阵，其对角线与 $A$ 相同，但非对角线元素乘以 $s \\in \\{0, 0.5, 1\\}$。\n- 实现了一个**预处理共轭梯度（PCG）**求解器。每个PCG迭代的核心涉及一次与 $A$ 的矩阵向量乘法和一次预条件子求解 $M\\mathbf{z}=\\mathbf{r}$。当 $s>0$ 时，预条件子求解由Thomas算法处理；当 $s=0$ 时（雅可比预处理），则通过简单的逐元素除法处理。\n- 实现了一个用于直接求解三对角系统的**Thomas算法**。它既用于直接求解 $A\\mathbf{e}=\\mathbf{b}$ 以找到参考残差，也用于 $s>0$ 时PCG内部的预条件子求解。\n- 性能由达到相对残差容差 $\\tau=10^{-8}$ 所需的PCG迭代次数 $k$ 来量化。直接（Thomas）求解的精度通过其最终残差范数 $\\|\\mathbf{b} - A\\mathbf{e}\\|_2$ 来评估。\n\n该实现将遍历指定的测试用例，执行计算，并将结果格式化为 $[k, r]$ 对的单个列表。\n\n```python\nimport numpy as np\n\ndef thomas_solver(sub, diag, sup, r):\n    \"\"\"\n    Solves a tridiagonal system T*x = r, where T = tridiagonal(sub, diag, sup).\n    This is an implementation of the Thomas algorithm.\n    \n    Args:\n        sub (np.ndarray): The sub-diagonal of length N-1.\n        diag (np.ndarray): The main diagonal of length N.\n        sup (np.ndarray): The super-diagonal of length N-1.\n        r (np.ndarray): The right-hand side vector of length N.\n\n    Returns:\n        np.ndarray: The solution vector x of length N.\n    \"\"\"\n    n = len(diag)\n    # Create copies to avoid modifying the original arrays passed to the function.\n    c_prime = np.zeros(n - 1)\n    d_prime = np.zeros(n)\n    \n    # Forward elimination phase\n    if diag[0] == 0:\n        raise ValueError(\"Thomas algorithm failed: zero on main diagonal.\")\n    c_prime[0] = sup[0] / diag[0]\n    d_prime[0] = r[0] / diag[0]\n    \n    for i in range(1, n):\n        denom = diag[i] - sub[i-1] * c_prime[i-1]\n        if denom == 0:\n            raise ValueError(\"Thomas algorithm failed: zero pivot.\")\n        if i  n - 1:\n            c_prime[i] = sup[i] / denom\n        d_prime[i] = (r[i] - sub[i-1] * d_prime[i-1]) / denom\n\n    # Backward substitution phase\n    x = np.zeros(n)\n    x[n - 1] = d_prime[n - 1]\n    for i in range(n - 2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i+1]\n        \n    return x\n\ndef matvec_tridiagonal(d, o, x):\n    \"\"\"\n    Computes the matrix-vector product y = A*x for a tridiagonal matrix A\n    with a constant main diagonal 'd' and constant off-diagonals 'o'.\n    \"\"\"\n    n = len(x)\n    y = d * x\n    if n > 1:\n        y[1:] += o * x[:-1]\n        y[:-1] += o * x[1:]\n    return y\n\ndef pcg_solver(N, d_A, o_A, d_M, o_M, b, tol):\n    \"\"\"\n    Preconditioned Conjugate Gradient (PCG) solver for Ax=b.\n    A is the symmetric tridiagonal system matrix.\n    M is the tridiagonal preconditioner matrix.\n    \"\"\"\n    x = np.zeros(N)\n    r = b.copy()  # Since x0=0, r0 = b - A*x0 = b\n    b_norm = np.linalg.norm(b)\n    \n    # Preconditioning step: solve Mz = r\n    if np.abs(o_M)  1e-15: # Case s=0: Jacobi preconditioner (M is diagonal)\n        z = r / d_M\n    else: # Case s>0: Tridiagonal preconditioner\n        sub_M = np.full(N - 1, o_M)\n        diag_M = np.full(N, d_M)\n        sup_M = np.full(N - 1, o_M)\n        z = thomas_solver(sub_M, diag_M, sup_M, r)\n        \n    p = z.copy()\n    rs_old = np.dot(r, z)\n    \n    max_iter = 2 * N\n    for k in range(1, max_iter + 1):\n        Ap = matvec_tridiagonal(d_A, o_A, p)\n        alpha = rs_old / np.dot(p, Ap)\n        \n        x += alpha * p\n        r -= alpha * Ap\n        \n        rel_residual_norm = np.linalg.norm(r) / b_norm\n        if rel_residual_norm  tol:\n            return k\n        \n        # Preconditioning step: solve Mz = r\n        if np.abs(o_M)  1e-15:\n            z = r / d_M\n        else:\n            z = thomas_solver(sub_M, diag_M, sup_M, r)\n            \n        rs_new = np.dot(r, z)\n        if rs_old == 0:\n            return k\n        \n        beta = rs_new / rs_old\n        p = z + beta * p\n        rs_old = rs_new\n        \n    return max_iter\n```",
            "answer": "[[32,2.455423145455858e-15],[17,2.455423145455858e-15],[1,2.455423145455858e-15],[126,1.605663737676751e-14],[64,1.605663737676751e-14],[1,1.605663737676751e-14],[500,1.3484252611732626e-13],[251,1.3484252611732626e-13],[1,1.3484252611732626e-13]]"
        }
    ]
}