{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在揭示时域有限体积法（FVTD）的根本原理。通过考虑一个包含均匀电磁场的简单立方单元，我们将从麦克斯韦方程的积分形式出发，推导出FVTD方法中的半离散更新方程。这个练习将清晰地展示，单元边界上的通量是如何驱动单元内部场平均值随时间变化的，这是理解FVTD数值机制的基石。",
            "id": "3307958",
            "problem": "考虑一个用于计算电磁学的有限体积时域(FVTD)方法中的单个立方控制体。该立方体的边长为 $\\Delta$，其边界 $\\partial V$ 由六个平面组成，外向单位法向量为 $\\mathbf{n}_{f}$。立方体内没有源，因此自由电流密度 $\\mathbf{J}=\\mathbf{0}$，也没有外加磁单极子。在某一瞬间，立方体内的电场和磁场是均匀的，分别等于 $\\mathbf{E}=(E_{0},0,0)$ 和 $\\mathbf{H}=(0,H_{0},0)$。\n\n从第一性原理（麦克斯韦方程组的局域微分形式）出发，并使用与FVTD框架一致的体积分和适当的矢量积分恒等式，计算：\n1. 净表面积分通量矢量\n$$\\mathbf{F}_{E}\\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{E}\\, \\mathrm{d}S \\quad \\text{和} \\quad \\mathbf{F}_{H}\\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{H}\\, \\mathrm{d}S.$$\n2. 单元平均磁通密度和电通密度的瞬时时间导数，\n$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle \\quad \\text{和} \\quad \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle,$$\n其中 $\\langle \\mathbf{B}\\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{B}\\,\\mathrm{d}V$、$\\langle \\mathbf{D}\\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{D}\\,\\mathrm{d}V$，$V=\\Delta^{3}$ 是立方体体积。\n\n将 $\\mathbf{F}_{E}$ 的单位表示为伏特-米，$\\mathbf{F}_{H}$ 的单位表示为安培-米，$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ 的单位表示为特斯拉每秒，$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ 的单位表示为库仑每平方米每秒。请按此顺序将您的最终答案表示为包含以下分量的单个行矩阵：\n$$\\left[F_{E,x},\\,F_{E,y},\\,F_{E,z},\\,F_{H,x},\\,F_{H,y},\\,F_{H,z},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{x},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{y},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{z},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{x},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{y},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{z}\\right].$$\n\n无需四舍五入。最终答案必须是如上所述的单个解析表达式。",
            "solution": "该问题的分析始于无源区域中的麦克斯韦方程组的局域微分形式，其中自由电流密度 $\\mathbf{J}=\\mathbf{0}$ 且没有磁单极子。两个相关的方程是法拉第电磁感应定律和安培-麦克斯韦定律：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\n这里，$\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场，$\\mathbf{B}$ 是磁通密度，$\\mathbf{D}$ 是电通密度。\n\n该问题要求计算两类量：表面积分通量矢量和单元平均场的时间导数。这两种计算都依赖于一个通用的矢量积分恒等式，该恒等式将矢量场旋度的体积分与该体积边界上的面积分联系起来。对于任何连续可微矢量场 $\\mathbf{A}$ 和一个边界为 $\\partial V$ 的体积 $V$，该恒等式为：\n$$ \\int_{V} (\\nabla \\times \\mathbf{A}) \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{A} \\, \\mathrm{d}S $$\n其中 $\\mathbf{n}$ 是面元 $\\mathrm{d}S$ 的外向单位法向量。\n\n问题陈述，在所考虑的瞬间，立方控制体内的电场和磁场是均匀的。具体来说，$\\mathbf{E}=(E_{0},0,0)$ 和 $\\mathbf{H}=(0,H_{0},0)$，其中 $E_{0}$ 和 $H_{0}$ 是常数。矢量场均匀（即在空间中是常数）的一个关键推论是其旋度处处为零。\n对于电场 $\\mathbf{E}$：\n$$ \\nabla \\times \\mathbf{E} = \\nabla \\times (E_{0}\\hat{\\mathbf{x}}) = \\mathbf{0} $$\n对于磁场 $\\mathbf{H}$：\n$$ \\nabla \\times \\mathbf{H} = \\nabla \\times (H_{0}\\hat{\\mathbf{y}}) = \\mathbf{0} $$\n\n首先，我们计算净表面积分通量矢量 $\\mathbf{F}_{E}$ 和 $\\mathbf{F}_{H}$。\n\n对于 $\\mathbf{F}_{E}$：\n其定义为 $\\mathbf{F}_{E} \\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{E}\\, \\mathrm{d}S$，这等价于闭合面积分 $\\oint_{\\partial V}\\mathbf{n}\\times \\mathbf{E}\\, \\mathrm{d}S$。应用上述矢量积分恒等式：\n$$ \\mathbf{F}_{E} = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{E} \\, \\mathrm{d}S = \\int_{V} (\\nabla \\times \\mathbf{E}) \\, \\mathrm{d}V $$\n由于 $\\mathbf{E}$ 是均匀的，所以在体积 $V$ 内处处有 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$。因此，积分为：\n$$ \\mathbf{F}_{E} = \\int_{V} \\mathbf{0} \\, \\mathrm{d}V = \\mathbf{0} $$\n因此，矢量 $\\mathbf{F}_{E}$ 是零矢量 $(0,0,0)$，单位为伏特-米。\n\n对于 $\\mathbf{F}_{H}$：\n同样的逻辑也适用。其定义为 $\\mathbf{F}_{H} \\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{H}\\, \\mathrm{d}S$。应用矢量积分恒等式：\n$$ \\mathbf{F}_{H} = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{H} \\, \\mathrm{d}S = \\int_{V} (\\nabla \\times \\mathbf{H}) \\, \\mathrm{d}V $$\n由于 $\\mathbf{H}$ 是均匀的，所以在体积 $V$ 内处处有 $\\nabla \\times \\mathbf{H} = \\mathbf{0}$。因此：\n$$ \\mathbf{F}_{H} = \\int_{V} \\mathbf{0} \\, \\mathrm{d}V = \\mathbf{0} $$\n因此，矢量 $\\mathbf{F}_{H}$ 也是零矢量 $(0,0,0)$，单位为安培-米。\n\n接下来，我们计算单元平均通量密度 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ 和 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ 的瞬时时间导数。这体现了有限体积时域(FVTD)方法的核心原理，该方法将单元平均场的时间演化与通过该单元边界的通量联系起来。\n\n对于 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$：\n我们首先对法拉第定律 $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$ 在控制体 $V$ 上进行积分：\n$$ \\int_{V} (\\nabla \\times \\mathbf{E}) \\, \\mathrm{d}V = - \\int_{V} \\frac{\\partial \\mathbf{B}}{\\partial t} \\, \\mathrm{d}V $$\n左侧根据定义是 $\\mathbf{F}_{E}$。对于右侧，由于体积 $V$ 不随时间变化，时间导数可以移到积分号外：\n$$ - \\int_{V} \\frac{\\partial \\mathbf{B}}{\\partial t} \\, \\mathrm{d}V = - \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} \\mathbf{B} \\, \\mathrm{d}V $$\n单元平均磁通密度为 $\\langle \\mathbf{B} \\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{B}\\,\\mathrm{d}V$，所以 $\\int_{V}\\mathbf{B}\\,\\mathrm{d}V = V\\langle \\mathbf{B} \\rangle$。将其代入：\n$$ - \\frac{\\mathrm{d}}{\\mathrm{d}t} (V\\langle \\mathbf{B} \\rangle) = -V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle $$\n将积分后的法拉第定律变换后的左右两边相等，得到半离散FVTD更新方程：\n$$ \\mathbf{F}_{E} = -V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle $$\n我们已经确定 $\\mathbf{F}_{E} = \\mathbf{0}$。由于体积 $V = \\Delta^3$ 非零，我们必然有：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle = \\mathbf{0} $$\n该矢量的分量为 $(0,0,0)$，单位为特斯拉每秒。\n\n对于 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$：\n对于安培-麦克斯韦定律 $\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}$（因为 $\\mathbf{J}=\\mathbf{0}$），我们遵循一个类似的过程。在体积 $V$ 上积分：\n$$ \\int_{V} (\\nabla \\times \\mathbf{H}) \\, \\mathrm{d}V = \\int_{V} \\frac{\\partial \\mathbf{D}}{\\partial t} \\, \\mathrm{d}V $$\n左侧根据定义是 $\\mathbf{F}_{H}$。右侧进行类似的变换：\n$$ \\int_{V} \\frac{\\partial \\mathbf{D}}{\\partial t} \\, \\mathrm{d}V = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} \\mathbf{D} \\, \\mathrm{d}V = V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle $$\n其中 $\\langle \\mathbf{D} \\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{D}\\,\\mathrm{d}V$。这给出了第二个FVTD更新方程：\n$$ \\mathbf{F}_{H} = V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle $$\n我们已经确定 $\\mathbf{F}_{H} = \\mathbf{0}$。因此：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle = \\mathbf{0} $$\n该矢量的分量为 $(0,0,0)$，单位为库仑每平方米每秒。\n\n总而言之，在给定瞬间，场 $\\mathbf{E}$ 和 $\\mathbf{H}$ 的空间均匀性意味着它们的旋度为零。这立即得出结论，即表面通量积分 $\\mathbf{F}_{E}$ 和 $\\mathbf{F}_{H}$ 为零。通过麦克斯韦方程组的积分形式，这又意味着相应的单元平均通量密度 $\\langle \\mathbf{B} \\rangle$ 和 $\\langle \\mathbf{D} \\rangle$ 的时间导数在该瞬间也为零。\n\n最终答案是一个行矩阵，按顺序包含 $\\mathbf{F}_E$、$\\mathbf{F}_H$、$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ 和 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ 的 $x, y, z$ 分量。所有12个分量都为零。\n$$ [F_{E,x}, F_{E,y}, F_{E,z}] = [0, 0, 0] $$\n$$ [F_{H,x}, F_{H,y}, F_{H,z}] = [0, 0, 0] $$\n$$ [\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{x}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{y}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{z}] = [0, 0, 0] $$\n$$ [\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{x}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{y}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{z}] = [0, 0, 0] $$\n最终的行矩阵完全由零组成。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0  0  0  0  0  0  0  0  0  0  0  0\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "在FVTD方法中，精确计算单元交界面上的数值通量至关重要，而这通常需要从已知的单元平均值重构出界面上的场值。本练习通过分析一个单色平面波，探讨了两种不同空间重构方法（一阶和二阶）所引入的数值相误差。通过这个练习，你将深入理解数值色散的来源，以及为什么高阶重构对于保证波传播模拟的长期保真度是必需的。",
            "id": "3307959",
            "problem": "考虑在自由空间中由麦克斯韦方程组控制的横电 (TE) 模的一维传播。对于仅沿空间坐标 $x$ 变化的场，相关分量满足\n$$\n\\frac{\\partial E_{y}}{\\partial t} = -\\frac{1}{\\varepsilon_{0}}\\frac{\\partial H_{z}}{\\partial x}, \\quad \\frac{\\partial H_{z}}{\\partial t} = -\\frac{1}{\\mu_{0}}\\frac{\\partial E_{y}}{\\partial x},\n$$\n其中 $E_{y}(x,t)$ 和 $H_{z}(x,t)$ 分别表示横向电场和磁场，$\\varepsilon_{0}$ 和 $\\mu_{0}$ 分别是自由空间的介电常数和磁导率。考虑一个在固定时间 $t$ 具有正弦空间依赖性的单色平面波，其电场的复数表示为\n$$\nE_{y}(x) = E_{0}\\exp(i k x),\n$$\n其中 $E_{0}\\in\\mathbb{C}$ 是一个常数振幅，$k>0$ 是实波数。\n\n在间距为 $\\Delta x$ 的均匀网格上进行有限体积时域 (FVTD) 离散化时，主要未知量是单元平均值。设单元 $i$ 的中心位于 $x_{i}$，其边界为位于 $x_{i\\pm\\frac{1}{2}} = x_{i} \\pm \\frac{\\Delta x}{2}$ 的面。单元平均电场定义为\n$$\n\\overline{E}_{i} \\equiv \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} E_{y}(x)\\,dx.\n$$\n假设通过两种空间重构方法从单元平均值重构右侧面 $x_{i+\\frac{1}{2}}$ 处的点值场：\n- 一阶（分段常数）重构：\n$$\nE_{i+\\frac{1}{2},L}^{(1)} = \\overline{E}_{i},\n$$\n即，面上的左状态取为单元 $i$ 中的单元平均值。\n- 使用中心差分斜率（来自单元平均值）的二阶（分段线性）无限制器重构（MUSCL 型）：\n$$\ns_{i} = \\frac{\\overline{E}_{i+1} - \\overline{E}_{i-1}}{2\\,\\Delta x}, \\quad E_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}\\,s_{i}.\n$$\n\n将在面 $x_{i+\\frac{1}{2}}$ 处的重构的相位误差定义为重构值与该面上精确场值之复数比的辐角（以弧度为单位）：\n$$\n\\phi^{(m)} \\equiv \\arg\\!\\left(\\frac{E_{i+\\frac{1}{2},L}^{(m)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right), \\quad m\\in\\{1,2\\}.\n$$\n从上述定义和正弦场 $E_{y}(x)=E_{0}\\exp(i k x)$ 出发，推导 $\\phi^{(1)}$ 和 $\\phi^{(2)}$ 作为 $k$ 和 $\\Delta x$ 的函数的闭式表达式。最终的相位误差以弧度表示。最终答案必须是使用 LaTeX $pmatrix$ 环境写成的由 $\\phi^{(1)}$ 和 $\\phi^{(2)}$ 组成的单行矩阵。",
            "solution": "目标是在有限体积时域 (FVTD) 的背景下，推导与正弦电场的一阶和二阶空间重构相关的相位误差 $\\phi^{(1)}$ 和 $\\phi^{(2)}$ 的闭式表达式。\n\n首先，我们计算单元 $i$ 的单元平均值 $\\overline{E}_{i}$。单元 $i$ 以 $x_i$ 为中心，宽度为 $\\Delta x$，覆盖区间 $[x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$。电场由其复数表示 $E_y(x) = E_{0}\\exp(i k x)$ 给出。\n\n单元平均值 $\\overline{E}_{i}$ 定义为：\n$$\n\\overline{E}_{i} = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} E_{y}(x)\\,dx = \\frac{1}{\\Delta x}\\int_{x_{i} - \\frac{\\Delta x}{2}}^{x_{i} + \\frac{\\Delta x}{2}} E_{0}\\exp(i k x)\\,dx\n$$\n我们进行积分：\n$$\n\\overline{E}_{i} = \\frac{E_{0}}{\\Delta x} \\left[ \\frac{\\exp(i k x)}{i k} \\right]_{x_{i} - \\frac{\\Delta x}{2}}^{x_{i} + \\frac{\\Delta x}{2}} = \\frac{E_{0}}{i k \\Delta x} \\left[ \\exp\\left(ik\\left(x_i + \\frac{\\Delta x}{2}\\right)\\right) - \\exp\\left(ik\\left(x_i - \\frac{\\Delta x}{2}\\right)\\right) \\right]\n$$\n提出公因子项 $\\exp(i k x_i)$：\n$$\n\\overline{E}_{i} = \\frac{E_{0}\\exp(i k x_i)}{i k \\Delta x} \\left[ \\exp\\left(i k\\frac{\\Delta x}{2}\\right) - \\exp\\left(-i k\\frac{\\Delta x}{2}\\right) \\right]\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，方括号中的项变为 $2i \\sin(k\\frac{\\Delta x}{2})$。\n$$\n\\overline{E}_{i} = \\frac{E_{0}\\exp(i k x_i)}{i k \\Delta x} \\left( 2i \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) = E_{0}\\exp(i k x_i) \\frac{2\\sin(k \\Delta x / 2)}{k \\Delta x}\n$$\n为了简化表示，我们可以将其写为：\n$$\n\\overline{E}_{i} = E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n\n现在，我们推导一阶重构的相位误差 $\\phi^{(1)}$。\n在面 $x_{i+\\frac{1}{2}}$ 左侧的一阶重构由 $E_{i+\\frac{1}{2},L}^{(1)} = \\overline{E}_{i}$ 给出。\n$$\nE_{i+\\frac{1}{2},L}^{(1)} = E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n在该面上场的精确值为：\n$$\nE_{y}(x_{i+\\frac{1}{2}}) = E_{y}\\left(x_i + \\frac{\\Delta x}{2}\\right) = E_{0}\\exp\\left(ik\\left(x_i + \\frac{\\Delta x}{2}\\right)\\right) = E_{0}\\exp(i k x_i)\\exp\\left(i\\frac{k \\Delta x}{2}\\right)\n$$\n相位误差 $\\phi^{(1)}$ 是重构值与精确值之比的辐角：\n$$\n\\phi^{(1)} = \\arg\\left(\\frac{E_{i+\\frac{1}{2},L}^{(1)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right) = \\arg\\left( \\frac{E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}}{E_{0}\\exp(i k x_i)\\exp(i k \\Delta x / 2)} \\right)\n$$\n$$\n\\phi^{(1)} = \\arg\\left( \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\exp\\left(-i\\frac{k \\Delta x}{2}\\right) \\right)\n$$\n对于一个数值上被良好解析的波，每个波长的点数大于2，这意味着 $k \\Delta x < \\pi$。在这种情况下，$k\\Delta x/2 < \\pi/2$，且项 $\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}$ 是一个正实数。因此，该复数比的辐角完全由指数项决定。\n$$\n\\phi^{(1)} = -\\frac{k \\Delta x}{2}\n$$\n\n接下来，我们推导二阶重构的相位误差 $\\phi^{(2)}$。\n重构为 $E_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}s_{i}$，其中斜率 $s_{i} = \\frac{\\overline{E}_{i+1} - \\overline{E}_{i-1}}{2\\Delta x}$。\n首先，我们计算斜率 $s_i$：\n$$\n\\overline{E}_{i\\pm 1} = E_{y}(x_{i\\pm 1}) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} = E_{y}(x_i)\\exp(\\pm i k \\Delta x) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n$$\ns_i = \\frac{1}{2\\Delta x} \\left( \\overline{E}_{i+1} - \\overline{E}_{i-1} \\right) = \\frac{E_{y}(x_i)}{2\\Delta x} \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left[ \\exp(i k \\Delta x) - \\exp(-i k \\Delta x) \\right]\n$$\n使用 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，我们得到：\n$$\ns_i = \\frac{E_{y}(x_i)}{2\\Delta x} \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} [2i \\sin(k\\Delta x)] = \\frac{i \\sin(k\\Delta x)}{\\Delta x} E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n现在，将此代入 $E_{i+\\frac{1}{2},L}^{(2)}$ 的表达式中：\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}s_{i} = E_{y}(x_i)\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} + \\frac{\\Delta x}{2} \\left( \\frac{i \\sin(k\\Delta x)}{\\Delta x} E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\right)\n$$\n提出公因子项：\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)\n$$\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)\n$$\n我们构建 $\\phi^{(2)}$ 的比值：\n$$\n\\phi^{(2)} = \\arg\\left(\\frac{E_{i+\\frac{1}{2},L}^{(2)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right) = \\arg\\left( \\frac{E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)}{E_{0}\\exp(i k x_i)\\exp(i k \\Delta x / 2)} \\right)\n$$\n$$\n\\phi^{(2)} = \\arg\\left( \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\exp\\left(-i\\frac{k \\Delta x}{2}\\right) \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right) \\right)\n$$\n复数乘积的辐角是它们各自辐角的和。我们来分析每一项。如前所述，我们假设 $k\\Delta x < \\pi$，所以 $\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}$ 是一个正实数，其辐角为 $0$。$\\exp(-i k \\Delta x / 2)$ 的辐角是 $-k \\Delta x / 2$。第三项是 $1 + \\frac{i}{2}\\sin(k\\Delta x)$；其实部为 $1$（正数），所以其辐角是 $\\arctan(\\frac{1}{2}\\sin(k\\Delta x))$。\n将这些辐角相加：\n$$\n\\phi^{(2)} = 0 - \\frac{k\\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k\\Delta x)\\right)\n$$\n因此，第二个相位误差为：\n$$\n\\phi^{(2)} = -\\frac{k\\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right)\n$$\n\n相位误差的最终闭式表达式为：\n$\\phi^{(1)} = -\\frac{k \\Delta x}{2}$\n$\\phi^{(2)} = -\\frac{k \\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right)$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{k \\Delta x}{2}  -\\frac{k \\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当电磁波穿过不同介质的交界面时，简单的场重构方法可能不再适用。为了精确捕捉反射和透射等物理现象，现代高分辨率FVTD格式采用了基于黎曼问题解的Godunov方法。本练习将引导你解决一维麦克斯韦方程在介质分界面上的黎曼问题，并计算出Godunov数值通量，从而让你掌握处理物理间断性的强大数值工具。",
            "id": "3307955",
            "problem": "考虑非均匀、无损耗、无源介质中一维横电结构下的麦克斯韦方程组，其中平面分界面位于 $x=0$。这些材料占据半空间：$x < 0$ 为介质 $1$，其介电常数为 $\\epsilon_1$，磁导率为 $\\mu_1$；$x>0$ 为介质 $2$，其介电常数为 $\\epsilon_2$，磁导率为 $\\mu_2$。切向场分量为 $E_y(x,t)$ 和 $H_z(x,t)$。控制方程为简化到一维形式的麦克斯韦旋度方程，\n$$\n\\frac{\\partial D_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0, \n\\qquad\n\\frac{\\partial B_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0,\n$$\n以及本构关系 $D_y=\\epsilon(x) E_y$ 和 $B_z=\\mu(x) H_z$，其中当 $x < 0$ 时 $\\epsilon(x)=\\epsilon_1$，当 $x>0$ 时 $\\epsilon(x)=\\epsilon_2$，$\\mu(x)$ 的情况也类似。假设在 $x=0$ 处没有自由表面电流或电荷，因此切向场在分界面处是连续的。\n\n在有限体积时域法中，可以为守恒变量 $\\boldsymbol{Q}=(D_y, B_z)^{\\top}$ 和通量 $\\boldsymbol{F}(\\boldsymbol{Q})=(H_z, E_y)^{\\top}$ 将该系统写成守恒形式，并利用 $x=0$ 处的精确界面黎曼解来定义 Godunov 数值通量 $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$。\n\n假设左侧介质的参数为 $\\epsilon_1=\\epsilon_0$、$\\mu_1=\\mu_0$，右侧介质的参数为 $\\epsilon_2=4\\epsilon_0$、$\\mu_2=\\mu_0$。设 $t=0^+$ 时的初始数据为：一个从左侧入射的右行平面波，在介质 $1$ 中的左状态为 $(E_y,H_z)=(1, 1/Z_1)$；介质 $2$ 中为静止的右状态 $(E_y,H_z)=(0,0)$。其中，波阻抗为 $Z_i=\\sqrt{\\mu_i/\\epsilon_i}$ 和 $Z_0=\\sqrt{\\mu_0/\\epsilon_0}$。\n\n从麦克斯韦方程组和切向场的界面连续性出发，用适用于各介质的特征变量推导精确的界面黎曼解，并由此确定：\n- $x=0$ 处的 Godunov 数值通量 $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$，以及\n- 透射到介质 $2$ 中的电场 $E_y$ 振幅。\n\n将最终答案表示为一个单行向量，其分量依次为 $H_z^{\\ast}$、$E_y^{\\ast}$ 和透射的 $E_y$ 振幅，并以 $Z_0$ 的闭合形式解析表达式表示。不要代入 $Z_0$ 的数值。最终答案中不要附加单位；不言而喻，第一个分量的单位是 $H_z$ 的单位，第二和第三个分量的单位是 $E_y$ 的单位。无需四舍五入。",
            "solution": "该问题要求确定两个电介质平面分界面处的 Godunov 数值通量和透射电场振幅。这是一个关于线性双曲方程组（即一维麦克斯韦方程组）的经典黎曼问题。\n\n在均匀介质 $i$（介电常数为 $\\epsilon_i$，磁导率为 $\\mu_i$）中的控制方程为：\n$$\n\\epsilon_i \\frac{\\partial E_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0\n$$\n$$\n\\mu_i \\frac{\\partial H_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0\n$$\n该系统可以写成矩阵形式 $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A}_i \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\boldsymbol{0}$，其中 $\\boldsymbol{U} = (E_y, H_z)^{\\top}$，系统矩阵为 $\\boldsymbol{A}_i = \\begin{pmatrix} 0 & 1/\\epsilon_i \\\\ 1/\\mu_i & 0 \\end{pmatrix}$。\n\n为求解该黎曼问题，我们进行特征分析。$\\boldsymbol{A}_i$ 的特征值可通过 $\\det(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\lambda^2 - 1/(\\epsilon_i\\mu_i) = 0$ 求得，由此得出特征速度 $\\lambda = \\pm v_i$，其中 $v_i = 1/\\sqrt{\\epsilon_i\\mu_i}$ 是介质 $i$ 中的光速。\n\n相应的左特征向量 $\\boldsymbol{l}$ 可通过求解 $\\boldsymbol{l}^{\\top}(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\boldsymbol{0}$ 得到。\n对于 $\\lambda = +v_i$：$\\boldsymbol{l}_1^{\\top} = (1, Z_i)$，其中 $Z_i = \\sqrt{\\mu_i/\\epsilon_i}$ 是介质 $i$ 的波阻抗。\n对于 $\\lambda = -v_i$：$\\boldsymbol{l}_2^{\\top} = (1, -Z_i)$。\n\n特征变量（或称黎曼不变量）是通过计算左特征向量与状态向量 $\\boldsymbol{U}$ 的点积得到的。\n$1$. 物理量 $w_1 = \\boldsymbol{l}_1^{\\top}\\boldsymbol{U} = E_y + Z_i H_z$ 沿着向左移动的特征线（即斜率为 $dx/dt = -v_i$ 的线）为常数。\n$2$. 物理量 $w_2 = \\boldsymbol{l}_2^{\\top}\\boldsymbol{U} = E_y - Z_i H_z$ 沿着向右移动的特征线（即斜率为 $dx/dt = +v_i$ 的线）为常数。\n\n初始条件指明在 $t=0$ 时刻，$x=0$ 处存在一个间断，该间断分隔了介质 $1$ 中的左状态 $(E_{y,L}, H_{z,L})$ 和介质 $2$ 中的右状态 $(E_{y,R}, H_{z,R})$。对于 $t>0$，在分界面 $x=0$ 处的解是一个常数状态，即所谓的星状态 $(E_y^{\\ast}, H_z^{\\ast})$。这个状态是分界面处黎曼问题的解，并提供了 Godunov 通量 $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$ 的值。\n\n这个星状态必须通过从分界面传播开的波与初始状态相连接。\n- 星状态 $(E_y^{\\ast}, H_z^{\\ast})$ 通过介质 $1$ 中的一个左行波与左状态 $(E_{y,L}, H_{z,L})$ 相连接。跨过此波，特征变量 $E_y + Z_1 H_z$ 守恒。\n$$ E_y^{\\ast} + Z_1 H_z^{\\ast} = E_{y,L} + Z_1 H_{z,L} $$\n- 星状态 $(E_y^{\\ast}, H_z^{\\ast})$ 通过介质 $2$ 中的一个右行波与右状态 $(E_{y,R}, H_{z,R})$ 相连接。跨过此波，特征变量 $E_y - Z_2 H_z$ 守恒。\n$$ E_y^{\\ast} - Z_2 H_z^{\\ast} = E_{y,R} - Z_2 H_{z,R} $$\n\n我们现在代入问题中给出的具体参数。\n对于介质 $1$ ($x<0$)：$\\epsilon_1 = \\epsilon_0$, $\\mu_1 = \\mu_0$。阻抗为 $Z_1 = \\sqrt{\\mu_1/\\epsilon_1} = \\sqrt{\\mu_0/\\epsilon_0} = Z_0$。\n对于介质 $2$ ($x>0$)：$\\epsilon_2 = 4\\epsilon_0$, $\\mu_2 = \\mu_0$。阻抗为 $Z_2 = \\sqrt{\\mu_2/\\epsilon_2} = \\sqrt{\\mu_0/(4\\epsilon_0)} = \\frac{1}{2}\\sqrt{\\mu_0/\\epsilon_0} = \\frac{1}{2}Z_0$。\n\n初始状态为：\n- 左状态 $(L)$：一个 $E_y=1$ 的右行波。对于这样的波，$H_z = E_y/Z_1$。因此，$(E_{y,L}, H_{z,L}) = (1, 1/Z_1) = (1, 1/Z_0)$。\n- 右状态 $(R)$：静止介质。$(E_{y,R}, H_{z,R}) = (0, 0)$。\n\n将这些代入特征变量的两个守恒方程中：\n根据介质 $1$ 中的左行波：\n$$ E_y^{\\ast} + Z_0 H_z^{\\ast} = 1 + Z_0 \\left(\\frac{1}{Z_0}\\right) = 1+1=2 $$\n根据介质 $2$ 中的右行波：\n$$ E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0 - \\frac{1}{2}Z_0(0) = 0 $$\n\n我们得到了一个关于 $E_y^{\\ast}$ 和 $H_z^{\\ast}$ 的二元线性方程组：\n$1$. $E_y^{\\ast} + Z_0 H_z^{\\ast} = 2$\n$2$. $E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0$\n\n由方程 $(2)$，我们得到 $E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast}$。\n将此式代入方程 $(1)$：\n$$ \\left(\\frac{1}{2}Z_0 H_z^{\\ast}\\right) + Z_0 H_z^{\\ast} = 2 $$\n$$ \\frac{3}{2}Z_0 H_z^{\\ast} = 2 $$\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n\n现在，我们求出 $E_y^{\\ast}$：\n$$ E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast} = \\frac{1}{2}Z_0 \\left(\\frac{4}{3Z_0}\\right) = \\frac{4}{6} = \\frac{2}{3} $$\n\n分界面处的 Godunov 数值通量为 $\\boldsymbol{F}^{\\ast} = (H_z^{\\ast}, E_y^{\\ast})^{\\top}$。其分量为：\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n$$ E_y^{\\ast} = \\frac{2}{3} $$\n\n最后一个需要确定的量是透射到介质 $2$ 中的电场振幅。透射到介质 $2$ 中的波是连接初始右状态 $(0,0)$ 与星状态 $(E_y^{\\ast}, H_z^{\\ast})$ 的右行波。在区域 $0 < x < v_2 t$ 内的场是恒定的，等于 $(E_y^{\\ast}, H_z^{\\ast})$。因此，透射电场的振幅恰好是 $E_y^{\\ast}$。\n$$ E_{y, \\text{transmitted}} = E_y^{\\ast} = \\frac{2}{3} $$\n\n问题要求将三个值（$H_z^{\\ast}$、$E_y^{\\ast}$ 和透射的 $E_y$ 振幅）表示为一个单行向量。它们依次是：$\\frac{4}{3Z_0}$、$\\frac{2}{3}$ 和 $\\frac{2}{3}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4}{3Z_0}  \\frac{2}{3}  \\frac{2}{3} \\end{pmatrix}}\n$$"
        }
    ]
}