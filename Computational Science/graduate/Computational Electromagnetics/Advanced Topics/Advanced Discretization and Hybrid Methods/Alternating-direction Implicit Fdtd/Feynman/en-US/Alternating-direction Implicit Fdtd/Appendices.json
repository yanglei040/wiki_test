{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Alternating-Direction Implicit Finite-Difference Time-Domain (ADI-FDTD) method lies in its unique time-splitting procedure, which transforms a multi-dimensional problem into a series of one-dimensional implicit solves. This hands-on practice guides you through the complete derivation of the update equations for a two-dimensional Transverse-Magnetic (TM) case directly from Maxwell's equations . Mastering this derivation is essential for a deep understanding of how the ADI-FDTD algorithm is constructed and how it successfully overcomes the stringent Courant–Friedrichs–Lewy (CFL) stability condition of explicit FDTD methods.",
            "id": "3289199",
            "problem": "Consider a lossless, homogeneous, two-dimensional electromagnetic medium with electric permittivity $\\varepsilon$ and magnetic permeability $\\mu$, discretized on a uniform Yee grid with spatial steps $\\Delta x$ and $\\Delta y$, and time step $\\Delta t$. Focus on the transverse-magnetic polarization to $z$ (TM$_z$) in which the nonzero field components are $\\left(E_z, H_x, H_y\\right)$. Starting only from Maxwell’s curl equations in differential form and the standard staggered Yee placement of the field components, construct an Alternating-Direction Implicit Finite-Difference Time-Domain (ADI-FDTD) scheme in two substeps: the first substep is implicit in the $x$-direction, and the second substep is implicit in the $y$-direction. Use a Peaceman–Rachford style time splitting, with half-step updates from $t^n$ to $t^{n+1/2}$ and from $t^{n+1/2}$ to $t^{n+1}$. \n\nYour tasks are:\n- Derive the fully discrete update relations for the first substep, implicit in $x$, that update $\\left(H_x, H_y, E_z\\right)$ from time index $n$ to $n+\\tfrac{1}{2}$, using centered second-order difference operators consistent with the Yee grid staggering. Clearly identify which spatial derivatives are treated implicitly and which explicitly in this substep. \n- Derive the fully discrete update relations for the second substep, implicit in $y$, that update $\\left(H_x, H_y, E_z\\right)$ from time index $n+\\tfrac{1}{2}$ to $n+1$, again specifying the implicit versus explicit treatment of the spatial derivatives.\n- For each substep, eliminate the magnetic field unknown implicit coupling as needed to reduce the update for $E_z$ to a one-dimensional tridiagonal linear system along the implicit direction. Explicitly write the tridiagonal stencil coefficients for the $E_z$ solve in each substep in terms of $\\Delta t$, $\\varepsilon$, $\\mu$, $\\Delta x$, and $\\Delta y$. Also provide the explicit finite-difference stencil coefficients appearing in the magnetic field updates.\n- Assume interior points and ignore boundary conditions so that standard centered differences apply everywhere. Clearly define your discrete derivative operators and the Yee staggering you adopt.\n\nFinally, from your tridiagonal system for $E_z$ in the first substep (implicit in $x$), extract the center coefficient of the tridiagonal operator (i.e., the coefficient multiplying $E_z$ at the current grid line index along $x$) as a closed-form analytical expression in terms of $\\Delta t$, $\\varepsilon$, $\\mu$, and $\\Delta x$. Report this center coefficient as your final answer. Do not include units in the final answer. The final answer must be a single closed-form analytic expression.",
            "solution": "The problem is valid as it is scientifically grounded in Maxwell's equations and the well-established ADI-FDTD numerical method, is well-posed, objective, and self-contained. We shall proceed with the derivation.\n\nThe starting point is Maxwell's curl equations for a transverse-magnetic to $z$ (TM$_z$) polarization in a source-free, lossless, homogeneous medium with permittivity $\\varepsilon$ and permeability $\\mu$:\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} = \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\n$$\n$$\n\\mu \\frac{\\partial H_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\nThese equations are discretized on a two-dimensional Yee grid. A grid point is denoted by indices $(i, j)$ corresponding to spatial coordinates $(i\\Delta x, j\\Delta y)$, and a time step is denoted by index $n$ for time $t^n = n\\Delta t$. The field components are staggered in space and time according to the standard Yee scheme for TM$_z$:\n- $E_z$ is located at $(i\\Delta x, j\\Delta y)$ and integer time steps $n\\Delta t$. We denote this as $E_z|_{i,j}^n$.\n- $H_x$ is located at $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$ and half-integer time steps $(n+\\frac{1}{2})\\Delta t$. We denote this as $H_x|_{i, j+1/2}^{n+1/2}$.\n- $H_y$ is located at $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$ and half-integer time steps $(n+\\frac{1}{2})\\Delta t$. We denote this as $H_y|_{i+1/2, j}^{n+1/2}$.\n\nThe ADI-FDTD method, however, typically places all field components at the same time instances ($n, n+1/2, n+1$) within the algorithm. The spatial staggering is maintained:\n- $E_z \\rightarrow E_z|_{i,j}$\n- $H_x \\rightarrow H_x|_{i, j+1/2}$\n- $H_y \\rightarrow H_y|_{i+1/2, j}$\n\nWe define the second-order centered spatial difference operators consistent with this staggering:\n$$\n\\delta_x f|_{i} = \\frac{f|_{i+1/2} - f|_{i-1/2}}{\\Delta x}, \\quad \\delta_y f|_{j} = \\frac{f|_{j+1/2} - f|_{j-1/2}}{\\Delta y}\n$$\n$$\n\\delta_x f|_{i+1/2} = \\frac{f|_{i+1} - f|_{i}}{\\Delta x}, \\quad \\delta_y f|_{j+1/2} = \\frac{f|_{j+1} - f|_{j}}{\\Delta y}\n$$\nFor the time derivatives over a half-step $\\Delta t/2$, we use a first-order forward difference, e.g., $\\frac{\\partial F}{\\partial t} \\approx \\frac{F^{n+1/2} - F^n}{\\Delta t/2}$.\n\nThe Peaceman-Rachford splitting scheme divides the update from time $n$ to $n+1$ into two substeps. The right-hand side operator of the TM$_z$ system is split into operators containing only $x$-derivatives ($A_x$) and only $y$-derivatives ($A_y$).\n\n**Substep 1: Update from $t^n$ to $t^{n+1/2}$ (Implicit in $x$-direction)**\n\nIn this substep, the $x$-derivatives are treated implicitly (evaluated at time $n+1/2$) and the $y$-derivatives are treated explicitly (evaluated at time $n$). The semi-discrete equations are:\n$$\n\\varepsilon \\frac{E_z^{n+1/2} - E_z^n}{\\Delta t/2} = \\frac{\\partial H_y^{n+1/2}}{\\partial x} - \\frac{\\partial H_x^n}{\\partial y}\n$$\n$$\n\\mu \\frac{H_x^{n+1/2} - H_x^n}{\\Delta t/2} = -\\frac{\\partial E_z^n}{\\partial y}\n$$\n$$\n\\mu \\frac{H_y^{n+1/2} - H_y^n}{\\Delta t/2} = \\frac{\\partial E_z^{n+1/2}}{\\partial x}\n$$\nApplying the defined discrete operators, we obtain the fully discrete update relations:\n\n1.  The $E_z$ update equation, centered at $(i,j)$:\n    $$\n    \\varepsilon \\frac{E_z|_{i,j}^{n+1/2} - E_z|_{i,j}^n}{\\Delta t/2} = \\frac{H_y|_{i+1/2,j}^{n+1/2} - H_y|_{i-1/2,j}^{n+1/2}}{\\Delta x} - \\frac{H_x|_{i,j+1/2}^n - H_x|_{i,j-1/2}^n}{\\Delta y}\n    $$\n    Here, the $\\delta_x$ operator on $H_y$ is implicit, and the $\\delta_y$ operator on $H_x$ is explicit.\n\n2.  The $H_y$ update equation, centered at $(i+1/2,j)$:\n    $$\n    \\mu \\frac{H_y|_{i+1/2,j}^{n+1/2} - H_y|_{i+1/2,j}^n}{\\Delta t/2} = \\frac{E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2}}{\\Delta x}\n    $$\n    The $\\delta_x$ operator on $E_z$ is implicit.\n\n3.  The $H_x$ update equation, centered at $(i,j+1/2)$:\n    $$\n    \\mu \\frac{H_x|_{i,j+1/2}^{n+1/2} - H_x|_{i,j+1/2}^n}{\\Delta t/2} = -\\frac{E_z|_{i,j+1}^n - E_z|_{i,j}^n}{\\Delta y}\n    $$\n    The $\\delta_y$ operator on $E_z$ is explicit. This equation can be solved directly for $H_x|_{i,j+1/2}^{n+1/2}$:\n    $$\n    H_x|_{i,j+1/2}^{n+1/2} = H_x|_{i,j+1/2}^n - \\frac{\\Delta t}{2\\mu\\Delta y} \\left( E_z|_{i,j+1}^n - E_z|_{i,j}^n \\right)\n    $$\n    The finite-difference stencil coefficients for this explicit $H_x$ update are $\\frac{\\Delta t}{2\\mu\\Delta y}$ for $E_z|_{i,j}^n$ and $-\\frac{\\Delta t}{2\\mu\\Delta y}$ for $E_z|_{i,j+1}^n$.\n\nTo obtain the tridiagonal system for $E_z$, we first rearrange the implicit $H_y$ update to express $H_y^{n+1/2}$ in terms of $E_z^{n+1/2}$ and known values:\n$$\nH_y|_{i+1/2,j}^{n+1/2} = H_y|_{i+1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} \\left( E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2} \\right)\n$$\nSubstitute this expression for $H_y|_{i+1/2,j}^{n+1/2}$ and a similar one for $H_y|_{i-1/2,j}^{n+1/2}$ into the $E_z$ equation:\n$$\n\\varepsilon \\frac{E_z|_{i,j}^{n+1/2} - E_z|_{i,j}^n}{\\Delta t/2} = \\frac{1}{\\Delta x} \\left[ \\left( H_y|_{i+1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} (E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2}) \\right) - \\left( H_y|_{i-1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} (E_z|_{i,j}^{n+1/2} - E_z|_{i-1,j}^{n+1/2}) \\right) \\right] - \\delta_y H_x|_{i,j}^n\n$$\nRearranging terms to group unknowns ($E_z^{n+1/2}$) on the left-hand side (LHS) and knowns on the right-hand side (RHS):\n$$\nE_z|_{i,j}^{n+1/2} - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2} \\left[ E_z|_{i+1,j}^{n+1/2} - 2E_z|_{i,j}^{n+1/2} + E_z|_{i-1,j}^{n+1/2} \\right] = E_z|_{i,j}^n + \\frac{\\Delta t}{2\\varepsilon} \\left( \\delta_x H_y|_{i,j}^n - \\delta_y H_x|_{i,j}^n \\right)\n$$\nThis is a one-dimensional tridiagonal system for each horizontal line (constant $j$). The equation is of the form $a_i E_z|_{i-1,j}^{n+1/2} + b_i E_z|_{i,j}^{n+1/2} + c_i E_z|_{i+1,j}^{n+1/2} = d_i$. The stencil coefficients for the tridiagonal operator on $E_z$ are:\n- Left coefficient ($a_i$): $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2}$\n- Center coefficient ($b_i$): $1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}$\n- Right coefficient ($c_i$): $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2}$\n\nOnce the tridiagonal system is solved for all $E_z|_{i,j}^{n+1/2}$, the update for $H_y|_{i+1/2,j}^{n+1/2}$ is completed explicitly using the now-known $E_z$ values. The stencil coefficients for this $H_y$ update are $\\frac{\\Delta t}{2\\mu\\Delta x}$ for $E_z|_{i+1,j}^{n+1/2}$ and $-\\frac{\\Delta t}{2\\mu\\Delta x}$ for $E_z|_{i,j}^{n+1/2}$.\n\n**Substep 2: Update from $t^{n+1/2}$ to $t^{n+1}$ (Implicit in $y$-direction)**\n\nThis substep is symmetric to the first. The $y$-derivatives are now implicit (evaluated at $t^{n+1}$), and the $x$-derivatives are explicit (evaluated at $t^{n+1/2}$).\n$$\n\\varepsilon \\frac{E_z^{n+1} - E_z^{n+1/2}}{\\Delta t/2} = \\frac{\\partial H_y^{n+1/2}}{\\partial x} - \\frac{\\partial H_x^{n+1}}{\\partial y}\n$$\n$$\n\\mu \\frac{H_x^{n+1} - H_x^{n+1/2}}{\\Delta t/2} = -\\frac{\\partial E_z^{n+1}}{\\partial y}\n$$\n$$\n\\mu \\frac{H_y^{n+1} - H_y^{n+1/2}}{\\Delta t/2} = \\frac{\\partial E_z^{n+1/2}}{\\partial x}\n$$\nFollowing an analogous procedure as in Substep 1:\n\n1.  The $H_y$ update is now explicit:\n    $$\n    H_y|_{i+1/2,j}^{n+1} = H_y|_{i+1/2,j}^{n+1/2} + \\frac{\\Delta t}{2\\mu\\Delta x} \\left( E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2} \\right)\n    $$\n    The stencil coefficients are $\\frac{\\Delta t}{2\\mu\\Delta x}$ and $-\\frac{\\Delta t}{2\\mu\\Delta x}$ on values of $E_z^{n+1/2}$.\n\n2.  The $E_z$ and $H_x$ updates are implicitly coupled. We substitute the expression for $H_x^{n+1}$ into the $E_z$ update equation. This yields a tridiagonal system for each vertical line (constant $i$):\n    $$\n    - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2} E_z|_{i,j-1}^{n+1} + \\left(1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta y)^2}\\right) E_z|_{i,j}^{n+1} - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2} E_z|_{i,j+1}^{n+1} = \\text{RHS}\n    $$\n    where the RHS contains only known values from time $n+1/2$.\n    The stencil coefficients for the tridiagonal operator on $E_z$ are:\n    - Bottom coefficient: $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2}$\n    - Center coefficient: $1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta y)^2}$\n    - Top coefficient: $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2}$\n\n3.  After solving for $E_z^{n+1}$, the $H_x$ update is completed explicitly:\n    $$\n    H_x|_{i,j+1/2}^{n+1} = H_x|_{i,j+1/2}^{n+1/2} - \\frac{\\Delta t}{2\\mu\\Delta y} \\left( E_z|_{i,j+1}^{n+1} - E_z|_{i,j}^{n+1} \\right)\n    $$\n    The stencil coefficients are $\\frac{\\Delta t}{2\\mu\\Delta y}$ and $-\\frac{\\Delta t}{2\\mu\\Delta y}$ on values of $E_z^{n+1}$.\n\nThe final answer requested is the center coefficient of the tridiagonal operator for the $E_z$ solve in the first substep, which is implicit in the $x$-direction.\nThis coefficient is identified as $b_i$ in the equation for Substep 1.\n$$\n\\text{Center Coefficient} = 1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}\n$$",
            "answer": "$$\n\\boxed{1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}}\n$$"
        },
        {
            "introduction": "A numerical algorithm's utility is defined not only by its structure but also by its performance characteristics, such as stability and accuracy. This exercise employs von Neumann stability analysis—a cornerstone technique for analyzing finite-difference schemes—to investigate the properties of the ADI-FDTD method in one dimension . By deriving the numerical dispersion relation and amplification factor, you will calculate key performance metrics and interpret their physical consequences, gaining direct insight into the method's trade-off between unconditional stability and numerical dispersion.",
            "id": "3289170",
            "problem": "Consider one-dimensional propagation of a transverse electromagnetic wave in vacuum governed by Maxwell’s equations, discretized on a staggered spatial grid (Yee grid) and advanced in time by the Alternating-Direction Implicit Finite-Difference Time-Domain (ADI-FDTD) method specialized to one spatial dimension. In this case, the alternating-direction implicit splitting of the trapezoidal (Crank–Nicolson) time discretization of the first-order Maxwell operator reduces to the trapezoidal rule applied to the one-dimensional staggered Maxwell system, which is unconditionally stable and second-order accurate in both space and time.\n\nStarting from the source-free one-dimensional Maxwell equations in vacuum and the above discretization assumptions, perform a von Neumann plane-wave analysis with ansatz $E_i^n = E_0 \\exp\\!\\big(i\\,(i\\,\\kappa - n\\,\\Omega)\\big)$ and $H_{i+1/2}^n = H_0 \\exp\\!\\big(i\\,( (i+1/2)\\,\\kappa - n\\,\\Omega)\\big)$, where $\\kappa = k\\,\\Delta x$ and $\\Omega = \\omega\\,\\Delta t$, to derive the discrete dispersion relation and the one-step amplification factor $G$. Then:\n\n1) From the discrete dispersion relation $\\omega = \\omega(k)$, compute the group velocity $v_g = \\partial \\omega/\\partial k$.\n\n2) Compute the magnitude of the amplification factor $\\lvert G \\rvert$.\n\nEvaluate both quantities for the following parameter set:\n- Vacuum wave speed $c = 3.00 \\times 10^{8}\\,\\mathrm{m/s}$.\n- Spatial step $\\Delta x = 1.00 \\times 10^{-2}\\,\\mathrm{m}$.\n- Time step $\\Delta t = 3.00 \\times 10^{-11}\\,\\mathrm{s}$.\n- Wavenumber such that $k\\,\\Delta x = \\kappa = \\pi/2$.\n\nProvide the physical interpretation of the results for a narrowband wave packet centered at the given wavenumber, addressing propagation speed and amplitude evolution over many time steps. Express the final numerical value of the group velocity in $\\mathrm{m/s}$ and the amplification-factor magnitude as a dimensionless number. Round your final numbers to six significant figures. Assume all phases and angular quantities are in radians.",
            "solution": "The problem requires the derivation and evaluation of the group velocity and amplification factor for a one-dimensional Alternating-Direction Implicit Finite-Difference Time-Domain (ADI-FDTD) scheme applied to Maxwell's equations. As stated, this method in 1D reduces to the Crank–Nicolson (trapezoidal rule) time integration on a staggered Yee grid.\n\nWe begin with the source-free, one-dimensional Maxwell's curl equations in a vacuum for a transverse electromagnetic wave, which can be written for field components $E_y$ and $H_z$ propagating in the $x$-direction:\n$$ \\frac{\\partial E_y}{\\partial t} = -\\frac{1}{\\epsilon_0} \\frac{\\partial H_z}{\\partial x} $$\n$$ \\frac{\\partial H_z}{\\partial t} = -\\frac{1}{\\mu_0} \\frac{\\partial E_y}{\\partial x} $$\nHere, $\\epsilon_0$ and $\\mu_0$ are the permittivity and permeability of vacuum, respectively, related to the speed of light $c$ by $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$.\n\nThe problem specifies a staggered spatial grid (Yee grid), where we define $E_y$ at integer grid points $i$ and $H_z$ at half-integer grid points $i+1/2$. The spatial derivatives are approximated by second-order central differences:\n$$ \\frac{\\partial H_z}{\\partial x} \\bigg|_i \\approx \\frac{H_{z, i+1/2} - H_{z, i-1/2}}{\\Delta x} $$\n$$ \\frac{\\partial E_y}{\\partial x} \\bigg|_{i+1/2} \\approx \\frac{E_{y, i+1} - E_{y, i}}{\\Delta x} $$\nThe time discretization uses the trapezoidal rule (Crank–Nicolson method), which involves averaging the right-hand-side spatial derivatives over time steps $n$ and $n+1$. Let $E_i^n$ denote $E_y(i\\Delta x, n\\Delta t)$ and $H_{i+1/2}^n$ denote $H_z((i+1/2)\\Delta x, n\\Delta t)$. The discretized equations are:\n$$ \\frac{E_i^{n+1} - E_i^n}{\\Delta t} = -\\frac{1}{2\\epsilon_0 \\Delta x} \\left[ (H_{i+1/2}^{n+1} - H_{i-1/2}^{n+1}) + (H_{i+1/2}^n - H_{i-1/2}^n) \\right] $$\n$$ \\frac{H_{i+1/2}^{n+1} - H_{i+1/2}^n}{\\Delta t} = -\\frac{1}{2\\mu_0 \\Delta x} \\left[ (E_{i+1}^{n+1} - E_i^{n+1}) + (E_{i+1}^n - E_i^n) \\right] $$\n\nTo perform the von Neumann stability analysis, we substitute the plane-wave ansatz provided:\n$E_i^n = E_0 \\exp\\big(i(i\\kappa - n\\Omega)\\big)$\n$H_{i+1/2}^n = H_0 \\exp\\big(i((i+1/2)\\kappa - n\\Omega)\\big)$\nwhere $\\kappa = k\\Delta x$, $\\Omega = \\omega\\Delta t$, and $i$ is the imaginary unit. The amplification factor is $G = \\exp(-i\\Omega)$, such that $E_i^{n+1} = G E_i^n$ and $H_{i+1/2}^{n+1} = G H_{i+1/2}^n$.\n\nSubstituting the ansatz into the discretized equations, we obtain a system of two linear algebraic equations for the amplitudes $E_0$ and $H_0$.\n\nFor the first equation (update for $E_y$):\n$E_i^n(G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} \\left[ (G H_{i-1/2}^n(\\exp(i\\kappa)-1)) + (H_{i-1/2}^n(\\exp(i\\kappa)-1)) \\right]$\n$E_0 \\exp(i(i\\kappa-n\\Omega))(G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} (G+1) H_0 \\exp(i((i-1/2)\\kappa-n\\Omega)) (\\exp(i\\kappa)-1)$\nDividing out common terms and using $\\exp(-i\\kappa/2)(\\exp(i\\kappa)-1) = \\exp(i\\kappa/2)-\\exp(-i\\kappa/2) = 2i\\sin(\\kappa/2)$:\n$E_0 (G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} (G+1) H_0 \\exp(-i\\kappa/2) (\\exp(i\\kappa)-1)$\n$E_0 (G-1) = -\\frac{\\Delta t}{\\epsilon_0 \\Delta x} (G+1) H_0 (i\\sin(\\kappa/2))$\n$$ E_0 \\left(\\frac{G-1}{G+1}\\right) = -\\frac{i\\Delta t \\sin(\\kappa/2)}{\\epsilon_0 \\Delta x} H_0 \\quad (1)$$\n\nFor the second equation (update for $H_z$):\n$H_{i+1/2}^n(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} \\left[ (G E_i^n(\\exp(i\\kappa)-1)) + (E_i^n(\\exp(i\\kappa)-1)) \\right]$\n$H_0 \\exp(i((i+1/2)\\kappa-n\\Omega))(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 \\exp(i(i\\kappa-n\\Omega))(\\exp(i\\kappa)-1)$\n$H_0 \\exp(i\\kappa/2)(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 (\\exp(i\\kappa)-1)$\n$H_0 (G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 \\exp(-i\\kappa/2)(\\exp(i\\kappa)-1)$\n$H_0 (G-1) = -\\frac{\\Delta t}{\\mu_0 \\Delta x} (G+1) E_0 (i\\sin(\\kappa/2))$\n$$ H_0 \\left(\\frac{G-1}{G+1}\\right) = -\\frac{i\\Delta t \\sin(\\kappa/2)}{\\mu_0 \\Delta x} E_0 \\quad (2)$$\n\nFor a non-trivial solution $(E_0, H_0)$, the determinant of the system formed by equations (1) and (2) must be zero:\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 - \\left(-\\frac{i\\Delta t \\sin(\\kappa/2)}{\\epsilon_0 \\Delta x}\\right) \\left(-\\frac{i\\Delta t \\sin(\\kappa/2)}{\\mu_0 \\Delta x}\\right) = 0 $$\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 - (i^2) \\frac{(\\Delta t)^2 \\sin^2(\\kappa/2)}{\\epsilon_0 \\mu_0 (\\Delta x)^2} = 0 $$\nUsing $c=1/\\sqrt{\\epsilon_0\\mu_0}$ and the Courant number $S = c\\Delta t/\\Delta x$:\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 + S^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right) = 0 $$\n$$ \\frac{G-1}{G+1} = \\pm i S \\sin\\left(\\frac{\\kappa}{2}\\right) $$\nFor a forward-propagating wave, where $E_y = Z_0 H_z$ and $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$ is the impedance of free space, equation (1) implies we must choose the negative sign:\n$\\frac{G-1}{G+1} = -i S \\sin(\\kappa/2)$.\nLet's solve for $G$:\n$G-1 = -i S \\sin(\\kappa/2) (G+1) \\implies G(1 + i S \\sin(\\kappa/2)) = 1 - i S \\sin(\\kappa/2)$\n$$ G = \\frac{1 - i S \\sin(\\kappa/2)}{1 + i S \\sin(\\kappa/2)} $$\n\nThe magnitude of the amplification factor $|G|$ is computed as:\n$$ |G| = \\left| \\frac{1 - i S \\sin(\\kappa/2)}{1 + i S \\sin(\\kappa/2)} \\right| = \\frac{|1 - i S \\sin(\\kappa/2)|}{|1 + i S \\sin(\\kappa/2)|} = \\frac{\\sqrt{1^2 + (-S \\sin(\\kappa/2))^2}}{\\sqrt{1^2 + (S \\sin(\\kappa/2))^2}} = 1 $$\nThis confirms that the numerical scheme is unconditionally stable and non-dissipative. For any valid set of parameters, $|G|=1$. The value to six significant figures is $1.00000$.\n\nTo find the discrete dispersion relation, we relate $G$ to the angular frequency $\\omega$.\n$G = \\exp(-i\\Omega) = \\exp(-i\\omega\\Delta t)$.\nThe argument of the complex number $1 + i S \\sin(\\kappa/2)$ is $\\arctan(S \\sin(\\kappa/2))$. Thus, the argument of $G$ is $-2\\arctan(S \\sin(\\kappa/2))$.\n$\\exp(-i\\omega\\Delta t) = \\exp(-2i \\arctan(S \\sin(\\kappa/2)))$.\nThis gives the dispersion relation:\n$$ \\omega(k) = \\frac{2}{\\Delta t} \\arctan\\left(S \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) = \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) $$\n\nThe group velocity $v_g$ is the derivative of $\\omega$ with respect to $k$:\n$$ v_g = \\frac{\\partial \\omega}{\\partial k} = \\frac{2}{\\Delta t} \\frac{\\partial}{\\partial k} \\left[ \\arctan\\left(\\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) \\right] $$\nUsing the chain rule, with $u(k) = \\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)$:\n$$ v_g = \\frac{2}{\\Delta t} \\cdot \\frac{1}{1 + \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)} \\cdot \\frac{d u}{d k} $$\n$$ \\frac{d u}{d k} = \\frac{c\\Delta t}{\\Delta x} \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\cdot \\frac{\\Delta x}{2} $$\nSubstituting this back:\n$$ v_g = \\frac{2}{\\Delta t} \\cdot \\frac{1}{1 + S^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right)} \\cdot \\frac{c\\Delta t}{2} \\cos\\left(\\frac{\\kappa}{2}\\right) $$\n$$ v_g = \\frac{c \\cos(\\kappa/2)}{1 + S^2 \\sin^2(\\kappa/2)} $$\n\nNow, we evaluate $v_g$ and $|G|$ for the given parameters:\n$c = 3.00 \\times 10^8\\,\\mathrm{m/s}$\n$\\Delta x = 1.00 \\times 10^{-2}\\,\\mathrm{m}$\n$\\Delta t = 3.00 \\times 10^{-11}\\,\\mathrm{s}$\n$\\kappa = k\\Delta x = \\pi/2$\n\nFirst, calculate the Courant number $S$:\n$S = \\frac{c\\Delta t}{\\Delta x} = \\frac{(3.00 \\times 10^8\\,\\mathrm{m/s})(3.00 \\times 10^{-11}\\,\\mathrm{s})}{1.00 \\times 10^{-2}\\,\\mathrm{m}} = \\frac{9.00 \\times 10^{-3}}{1.00 \\times 10^{-2}} = 0.900$\n\nFor the group velocity $v_g$, we use $\\kappa = \\pi/2$:\n$\\sin(\\kappa/2) = \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n$\\cos(\\kappa/2) = \\cos(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n$$ v_g = \\frac{(3.00 \\times 10^8) \\cos(\\pi/4)}{1 + (0.900)^2 \\sin^2(\\pi/4)} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + (0.81) (\\frac{\\sqrt{2}}{2})^2} $$\n$$ v_g = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + (0.81) (\\frac{1}{2})} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + 0.405} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1.405} $$\n$$ v_g = \\frac{3.00 \\times \\sqrt{2}}{2 \\times 1.405} \\times 10^8 \\approx \\frac{3.00 \\times 1.41421356}{2.810} \\times 10^8 \\approx 1.50983654 \\times 10^8\\,\\mathrm{m/s} $$\nRounding to six significant figures, $v_g = 1.50984 \\times 10^8\\,\\mathrm{m/s}$.\n\nThe magnitude of the amplification factor $|G|$ is exactly $1$. To six significant figures, this is $1.00000$.\n\nPhysical Interpretation:\nThe group velocity $v_g \\approx 1.51 \\times 10^8\\,\\mathrm{m/s}$ is the propagation speed of the envelope of a narrowband wave packet centered at the given wavenumber ($k\\Delta x = \\pi/2$). This velocity is only about half the speed of light in vacuum, $c$. This significant deviation is a result of numerical dispersion, an artifact of the spatial and temporal discretization. For the given parameters, the grid resolution is $4$ cells per wavelength ($\\lambda = 2\\pi/k = 2\\pi/(\\pi/(2\\Delta x)) = 4\\Delta x$), which is quite coarse and leads to substantial numerical dispersion error, slowing the wave packet.\n\nThe amplification factor magnitude $|G|=1$ signifies that the numerical scheme is non-dissipative (unitary). The amplitude of a single plane-wave mode is perfectly preserved over time. For a wave packet, this means that while its shape will distort and spread due to the different speeds of its constituent frequency components (numerical dispersion), its total energy will be conserved over many time steps.\n\nThe final answers are the numerical value of the group velocity and the magnitude of the amplification factor.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.50984 \\times 10^8 & 1.00000 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Practical electromagnetic simulations almost always involve complex geometries with varying material properties. This advanced practice addresses the critical challenge of modeling wave propagation across material interfaces within the ADI-FDTD framework . You will derive modified update coefficients for a one-dimensional system with a piecewise constant permittivity, using a physically consistent flux-conservative formulation. This exercise highlights the necessary adjustments for handling inhomogeneous media and encourages a deeper analysis of how sharp material contrasts can impact the numerical conditioning and local accuracy of the simulation.",
            "id": "3289210",
            "problem": "Consider the source-free one-dimensional Maxwell equations on a uniform line with spatial step size $\\Delta x$ and time step size $\\Delta t$,\n$$\n\\epsilon(x)\\,\\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x},\\qquad\n\\mu\\,\\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x},\n$$\nwhere $\\mu$ is a positive constant and $\\epsilon(x)$ is piecewise constant with a single jump discontinuity located between two neighboring grid nodes at $x_{j_0}$ and $x_{j_0+1}$. Let $E_j^n$ denote the electric field $E$ at node $x_j$ and time $t^n$, and $H_{j+1/2}^n$ denote the magnetic field $H$ at staggered half-nodes $x_{j+1/2}$ and time $t^n$. The Alternating-Direction Implicit Finite-Difference Time-Domain (ADI-FDTD) update in one dimension reduces to a trapezoidal (Crank–Nicolson) implicit step for the electric field,\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = \\frac{1}{\\mu\\,\\epsilon(x)}\\,\\frac{\\partial^2 E}{\\partial x^2},\n$$\nwhen eliminating $H$. A second-order accurate spatial discretization that remains consistent in the weak sense at material interfaces uses a face-weighted flux formulation with interface wave speed squared $c^2(x) = 1/(\\mu\\,\\epsilon(x))$ evaluated at cell faces. Define the face-centered value\n$$\nc_{j+1/2}^2 := \\left(\\frac{1}{2}\\left(\\frac{1}{c_j^2}+\\frac{1}{c_{j+1}^2}\\right)\\right)^{-1} = \\frac{2}{\\mu\\left(\\epsilon_j+\\epsilon_{j+1}\\right)},\n$$\nwhere $c_j^2 = 1/(\\mu\\,\\epsilon_j)$ and $\\epsilon_j := \\epsilon(x_j)$. The resulting implicit update for $E^{n+1}$ can be written as a tridiagonal linear system\n$$\na_j\\,E_{j-1}^{n+1} + b_j\\,E_j^{n+1} + c_j\\,E_{j+1}^{n+1} = r_j,\n$$\nwith known right-hand side $r_j$ assembled from previous-step quantities.\n\nStarting from the Maxwell equations and using the above face-flux formulation for the spatial operator together with the trapezoidal rule in time, derive the expressions for the tridiagonal coefficients $a_j$, $b_j$, and $c_j$ that correctly account for the jump in $\\epsilon(x)$ via the face-centered $c_{j\\pm 1/2}^2$. Your derivation must begin from the given physical laws and proceed through a consistent semi-discrete form before arriving at the fully discrete implicit scheme. In addition, explain, based on your derived coefficients, how large contrasts in $\\epsilon(x)$ near the interface affect the conditioning of the resulting tridiagonal system and the local truncation error in the neighborhood of the discontinuity.\n\nExpress your final answer as a single closed-form analytical expression for the coefficient triplet $\\left(a_j,\\,b_j,\\,c_j\\right)$ in terms of $\\Delta t$, $\\Delta x$, $\\mu$, and the nodal permittivities $\\epsilon_j$, valid for all nodes including the two nodes adjacent to the interface. No numerical evaluation is required and no units should be included in the final expression.",
            "solution": "The starting point is the source-free one-dimensional Maxwell system,\n$$\n\\epsilon(x)\\,\\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x},\\qquad\n\\mu\\,\\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x},\n$$\nwith $\\mu>0$ constant and $\\epsilon(x)>0$ piecewise constant. Eliminating $H$ yields a second-order hyperbolic equation in $E$. Differentiate the first equation with respect to time and substitute $\\partial H/\\partial t$ from the second equation:\n$$\n\\epsilon(x)\\,\\frac{\\partial^2 E}{\\partial t^2} = \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial H}{\\partial x}\\right)\n= \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial H}{\\partial t}\\right)\n= \\frac{\\partial}{\\partial x}\\left(\\frac{1}{\\mu}\\,\\frac{\\partial E}{\\partial x}\\right).\n$$\nBecause $\\mu$ is constant, we obtain\n$$\n\\epsilon(x)\\,\\frac{\\partial^2 E}{\\partial t^2} = \\frac{1}{\\mu}\\,\\frac{\\partial^2 E}{\\partial x^2}.\n$$\nEquivalently,\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = c^2(x)\\,\\frac{\\partial^2 E}{\\partial x^2},\\qquad c^2(x) := \\frac{1}{\\mu\\,\\epsilon(x)}.\n$$\nWhile this form places the spatially varying coefficient outside the spatial derivative, a conservative and interface-aware discrete approximation is obtained by writing the spatial operator in flux form and discretizing it by a face-centered finite-volume/finite-difference approach. Over a uniform grid with nodes $x_j = j\\,\\Delta x$, approximate\n$$\n\\frac{\\partial}{\\partial x}\\!\\left(c^2(x)\\,\\frac{\\partial E}{\\partial x}\\right)\\Big|_{x_j}\n\\approx \\frac{1}{\\Delta x}\\left[c_{j+1/2}^2\\,\\frac{E_{j+1}-E_j}{\\Delta x} - c_{j-1/2}^2\\,\\frac{E_j-E_{j-1}}{\\Delta x}\\right]\n= \\frac{1}{\\Delta x^2}\\left[c_{j+1/2}^2\\,(E_{j+1}-E_j) - c_{j-1/2}^2\\,(E_j-E_{j-1})\\right],\n$$\nwhere $c_{j\\pm 1/2}^2$ are face-centered values of $c^2(x)$ designed to enforce weak-form consistency across discontinuities. For piecewise constant $\\epsilon(x)$ (and constant $\\mu$), the appropriate face value is the harmonic average,\n$$\nc_{j+1/2}^2 := \\left(\\frac{1}{2}\\left(\\frac{1}{c_j^2}+\\frac{1}{c_{j+1}^2}\\right)\\right)^{-1}\n= \\left(\\frac{1}{2}\\left(\\mu\\,\\epsilon_j+\\mu\\,\\epsilon_{j+1}\\right)\\right)^{-1}\n= \\frac{2}{\\mu\\left(\\epsilon_j+\\epsilon_{j+1}\\right)}.\n$$\nThis choice guarantees that the discrete flux $c_{j+1/2}^2\\,(E_{j+1}-E_j)/\\Delta x$ respects the interface continuity of the displacement field $D=\\epsilon\\,E$ in the weak sense, as it arises from integrating the flux form over a cell.\n\nTo construct a second-order accurate implicit time update that is unconditionally stable in one dimension and consistent with Alternating-Direction Implicit Finite-Difference Time-Domain (ADI-FDTD) splitting (which reduces to the trapezoidal rule in one dimension), introduce the auxiliary velocity $V=\\partial E/\\partial t$ to form a first-order system:\n$$\n\\frac{\\partial E}{\\partial t} = V,\\qquad \\frac{\\partial V}{\\partial t} = \\frac{1}{\\Delta x^2}\\left[c_{j+1/2}^2\\,(E_{j+1}-E_j) - c_{j-1/2}^2\\,(E_j-E_{j-1})\\right].\n$$\nApplying the trapezoidal (Crank–Nicolson) rule in time from $t^n$ to $t^{n+1}$,\n$$\nE_j^{n+1} = E_j^{n} + \\frac{\\Delta t}{2}\\left(V_j^{n+1}+V_j^n\\right),\n$$\n$$\nV_j^{n+1} = V_j^{n} + \\frac{\\Delta t}{2}\\,\\frac{1}{\\Delta x^2}\\left[c_{j+1/2}^2\\left(E_{j+1}^{n+1}+E_{j+1}^{n} - (E_j^{n+1}+E_j^{n})\\right) - c_{j-1/2}^2\\left(E_j^{n+1}+E_j^{n} - (E_{j-1}^{n+1}+E_{j-1}^{n})\\right)\\right].\n$$\nEliminating $V_j^{n+1}$ from the first equation using the second yields a linear implicit update for $E^{n+1}$. Substituting and arranging terms on the left-hand side that multiply $E_{j-1}^{n+1}$, $E_j^{n+1}$, and $E_{j+1}^{n+1}$, one obtains the tridiagonal system\n$$\n-\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j-1/2}^2\\,E_{j-1}^{n+1}\n+\\left(1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left[c_{j-1/2}^2+c_{j+1/2}^2\\right]\\right)E_j^{n+1}\n-\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j+1/2}^2\\,E_{j+1}^{n+1}\n= r_j,\n$$\nwhere the right-hand side $r_j$ collects known contributions from $E^n$, $V^n$, and their spatial neighbors. Therefore, the tridiagonal coefficients are\n$$\na_j = -\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j-1/2}^2,\\qquad\nb_j = 1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left(c_{j-1/2}^2+c_{j+1/2}^2\\right),\\qquad\nc_j = -\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j+1/2}^2,\n$$\nwith the face-centered wave speeds\n$$\nc_{j\\pm 1/2}^2 = \\frac{2}{\\mu\\left(\\epsilon_j+\\epsilon_{j\\pm 1}\\right)}.\n$$\n\nThese expressions automatically account for interface nodes, because the faces adjacent to the interface use the two distinct permittivities $\\epsilon_{j_0}$ and $\\epsilon_{j_0+1}$ in $c_{j_0+1/2}^2$. In homogeneous subregions, $\\epsilon_j=\\epsilon_{j\\pm 1}$ and the face speed reduces to $c_{j\\pm 1/2}^2=1/(\\mu\\,\\epsilon_j)$.\n\nRegarding conditioning, the coefficient matrix is symmetric and strictly diagonally dominant for $\\Delta t>0$ and $c_{j\\pm 1/2}^2>0$, hence positive definite under standard boundary conditions. However, large contrast ratios in $\\epsilon(x)$ produce large jumps in $c_{j\\pm 1/2}^2$, which weaken uniform diagonal dominance locally and increase the spread of the eigenvalues. A rough indicator is the ratio\n$$\n\\kappa \\sim \\frac{1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left(c_{\\max,-1/2}^2+c_{\\max,+1/2}^2\\right)}{1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left(c_{\\min,-1/2}^2+c_{\\min,+1/2}^2\\right)},\n$$\nwhere $c_{\\max,\\cdot}^2$ and $c_{\\min,\\cdot}^2$ denote extreme face speeds over the domain. Since $c^2\\propto 1/\\epsilon$, a high $\\epsilon$ contrast leads to a larger condition number, implying more iterations for Krylov solvers or greater sensitivity in direct solvers.\n\nFor local truncation error, away from the interface the face speeds are smooth (constant) and the central differences yield $\\mathcal{O}(\\Delta x^2)$ spatial error with $\\mathcal{O}(\\Delta t^2)$ temporal error. At the discontinuity, the continuous solution has a kink in $\\partial E/\\partial x$ induced by the jump in $\\epsilon$. The flux-form discretization with harmonic averaging consistently captures the weak solution, suppressing spurious oscillations and enforcing the correct jump condition for the flux. Nevertheless, the local spatial truncation error near the interface degrades to $\\mathcal{O}(\\Delta x)$ due to the distributional derivative of $c^2(x)$ concentrated at the interface. This is the expected behavior for second-order schemes in the presence of coefficient discontinuities: second-order accuracy is retained globally in smooth regions, while locally near the jump the order reduces unless special interface reconstruction is employed.\n\nIn summary, starting from Maxwell’s equations and employing a trapezoidal implicit time integrator with face-weighted flux discretization in space, the modified tridiagonal coefficients that incorporate the effect of piecewise constant $\\epsilon(x)$ through interface-aware face speeds are given by the expressions above. These guarantee a symmetric positive definite system with robust behavior across discontinuities, albeit with conditioning and local truncation error impacted by the magnitude of the permittivity jump.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{\\Delta t^{2}}{4\\,\\Delta x^{2}}\\,\\dfrac{2}{\\mu\\left(\\epsilon_{j-1}+\\epsilon_{j}\\right)} &\n1+\\dfrac{\\Delta t^{2}}{4\\,\\Delta x^{2}}\\!\\left(\\dfrac{2}{\\mu\\left(\\epsilon_{j-1}+\\epsilon_{j}\\right)}+\\dfrac{2}{\\mu\\left(\\epsilon_{j}+\\epsilon_{j+1}\\right)}\\right) &\n-\\dfrac{\\Delta t^{2}}{4\\,\\Delta x^{2}}\\,\\dfrac{2}{\\mu\\left(\\epsilon_{j}+\\epsilon_{j+1}\\right)}\n\\end{pmatrix}}$$"
        }
    ]
}