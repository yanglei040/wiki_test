{
    "hands_on_practices": [
        {
            "introduction": "在分析积分方程求解器的复杂性时，第一步是将其分解为不同部分。我们从分析矩量法 (MoM) 矩阵的“近场”汇编开始。本练习将引导你从第一性原理出发，证明由于近场相互作用的局部性，这部分的计算成本与未知数数量 $N$ 呈线性关系，而非二次关系，这是理解快速算法为何能成功的关键第一步。",
            "id": "3293963",
            "problem": "考虑一个用于完美导电表面时谐电磁散射问题的边界积分方程公式，该公式通过矩量法 (MoM) 进行离散化。稠密的系统矩阵源于离散化面元（单元）之间通过格林函数核产生的成对相互作用。为加速计算，该矩阵被划分为近场块和远场块。近场块由网格图邻域定义：对于每个面元 $i$，其近场相互作用仅限于一环邻接集 $\\mathcal{N}(i)$，该集合包含与面元 $i$ 共享至少一个网格边或顶点的面元。假设网格是形状规则和准均匀的，因此存在一个与 $N$ 无关的常数 $C$，使得对于所有面元 $i$，都有 $|\\mathcal{N}(i)| \\leq C$，其中 $N$ 是面元的总数。\n\n每个对应于面元对 $(i,j)$（其中 $j \\in \\mathcal{N}(i)$）的近场块矩阵元是通过评估一个固定的求积法则来组装的，该法则在每个面元上具有有界数量的点和有界数量的基函数/测试函数操作；因此，每个组装对 $(i,j)$ 的计算成本是一个不依赖于 $N$ 的常数 $a$。假设对所有有序的面元-邻居对 $(i,j)$（其中 $j \\in \\mathcal{N}(i)$）都进行组装，并且在组装过程中不利用对称性。\n\n仅使用上述假设和运算计数的首要原则，计算组装所有近场块的渐近成本，作为 $N$ 的函数。将最终答案表示为关于 $N$ 的单个渐近表达式（使用标准的大$\\Theta$表示法）。不需要进行数值四舍五入，也不涉及物理单位。",
            "solution": "问题要求计算组装矩量法 (MoM) 矩阵近场块的渐近计算成本。总成本是组装每个单独的近场矩阵元成本的总和。\n\n设 $N$ 是表面上离散化面元的总数。\n设 $T$ 表示近场块的总组装成本。\n问题陈述，面元 $i$ 的近场相互作用由其一环邻接集 $\\mathcal{N}(i)$ 定义。组装过程对所有有序的面元-邻居对 $(i, j)$ 执行，其中 $i$ 的范围从 $1$ 到 $N$，且 $j \\in \\mathcal{N}(i)$。\n组装单个面元对 $(i, j)$ 相互作用的成本是一个与 $N$ 无关的常数 $a$。\n\n总成本 $T$ 可以表示为所有面元 $i$ 的成本之和，其中每个面元的成本是其与所有邻居 $j \\in \\mathcal{N}(i)$ 相互作用的成本之和。\n在数学上，这表示为：\n$$ T = \\sum_{i=1}^{N} \\left( \\sum_{j \\in \\mathcal{N}(i)} (\\text{对 } (i, j) \\text{ 的成本}) \\right) $$\n将每个对的给定常数成本 $a$ 代入：\n$$ T = \\sum_{i=1}^{N} \\left( \\sum_{j \\in \\mathcal{N}(i)} a \\right) $$\n由于 $a$ 是一个常数，可以从内层求和中提出。内层求和随后变为集合 $\\mathcal{N}(i)$ 中元素的数量，即其基数，表示为 $|\\mathcal{N}(i)|$。\n$$ \\sum_{j \\in \\mathcal{N}(i)} a = a \\sum_{j \\in \\mathcal{N}(i)} 1 = a \\cdot |\\mathcal{N}(i)| $$\n将此代回到总成本 $T$ 的表达式中：\n$$ T = \\sum_{i=1}^{N} a \\cdot |\\mathcal{N}(i)| $$\n由于 $a$ 是一个相对于求和指数 $i$ 的常数，我们也可以将其从总和中提出：\n$$ T = a \\sum_{i=1}^{N} |\\mathcal{N}(i)| $$\n为了确定渐近成本，我们需要找出和 $\\sum_{i=1}^{N} |\\mathcal{N}(i)|$ 作为 $N$ 的函数的渐近行为。这个和代表了需要计算的近场相互作用的总数。\n\n我们已知网格是形状规则和准均匀的。由此得出的一个关键推论是，存在一个与 $N$ 无关的常数 $C$，使得任何面元 $i$ 的邻域大小都有上界：\n$$ |\\mathcal{N}(i)| \\leq C \\quad \\text{对于所有 } i = 1, \\dots, N $$\n使用这个不等式，我们可以建立总成本 $T$ 的一个上界：\n$$ T = a \\sum_{i=1}^{N} |\\mathcal{N}(i)| \\leq a \\sum_{i=1}^{N} C = a \\cdot C \\cdot N $$\n由于 $a$ 和 $C$ 是常数，总成本 $T$ 的上界是一个 $N$ 的线性函数。用渐近表示法，这意味着：\n$$ T = O(N) $$\n\n为了用大$\\Theta$表示法确定渐近行为，我们还必须找到一个下界。“形状规则”和“准均匀”网格的性质也意味着局部连通性在整个网格上是相当均匀的。对于任何不在开放曲面网格物理边界上的面元，其邻居数量的下界是一个正常数，例如 $C_{\\min} > 0$。让我们考虑所有面元的集合。一小部分面元可能位于开放曲面的边界上，邻居数量较少。对于一个用 $N$ 个面元离散化的二维曲面，这类边界上的面元数量 $N_{\\text{bnd}}$ 通常比 $N$ 的阶数低，例如 $N_{\\text{bnd}} = O(\\sqrt{N})$。内部面元的数量是 $N_{\\text{int}} = N - N_{\\text{bnd}}$。\n\n对于 $N_{\\text{int}}$ 个内部面元中的每一个，我们可以假设 $|\\mathcal{N}(i)| \\geq C_{\\min}$，其中 $C_{\\min}$ 是某个正常数。对于边界上的面元，邻居的数量至少是 $1$（除非网格不连通，这将是病态的情况）。\n因此，我们可以建立该和的一个下界：\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| = \\sum_{i \\in \\text{内部}} |\\mathcal{N}(i)| + \\sum_{i \\in \\text{边界}} |\\mathcal{N}(i)| \\geq \\sum_{i \\in \\text{内部}} C_{\\min} + \\sum_{i \\in \\text{边界}} 1 $$\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| \\geq N_{\\text{int}} \\cdot C_{\\min} + N_{\\text{bnd}} \\cdot 1 = (N - N_{\\text{bnd}}) C_{\\min} + N_{\\text{bnd}} $$\n对于大的 $N$，$N_{\\text{bnd}}$ 是 $N$ 的次线性函数（例如，$O(\\sqrt{N})$），所以 $N_{\\text{int}}$ 与 $N$ 渐近相等。下界中的主导项是 $N \\cdot C_{\\min}$。因此，存在一个常数 $C' > 0$，使得对于足够大的 $N$：\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| \\geq C' N $$\n这表明该和的下界是一个 $N$ 的线性函数。用渐近表示法：\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| = \\Omega(N) $$\n由于总成本 $T = a \\sum_{i=1}^{N} |\\mathcal{N}(i)|$ 且 $a$ 是一个正常数，我们有：\n$$ T = \\Omega(N) $$\n\n结合上界和下界，我们有 $T = O(N)$ 和 $T = \\Omega(N)$。根据大$\\Theta$表示法的定义，这意味着：\n$$ T = \\Theta(N) $$\n组装所有近场块的总成本随面元数量 $N$ 线性增长。",
            "answer": "$$\\boxed{\\Theta(N)}$$"
        },
        {
            "introduction": "在上一节分析的基础上，我们现在探讨一个更精细的问题：我们对精度的要求如何影响计算成本？本练习引入“弹性”这一概念，以形式化地量化计算时间对所选误差容限 $\\epsilon$ 的敏感度。通过将数值积分的误差公式与成本模型联系起来，你将推导出一个支配精度与效率之间权衡的基本关系，这是实用算法设计中的一个核心考量。",
            "id": "3294023",
            "problem": "考虑在频域计算电磁学中，对于一个由矩量法 (MoM) 离散化的边界积分方程，组装其稠密系统矩阵。该几何体是一个面积固定的光滑闭合曲面，被离散为 $N$ 个特征尺寸为 $h \\sim N^{-1/2}$ 的形状规则的三角剖分片。矩阵的组装根据几何邻近性分为近场贡献和远场贡献。我们只关注近场贡献，其定义为来自一个固定的、与 $N$ 无关的模板中剖分片对的贡献，这些剖分片对在几何上与每个剖分片相邻或几乎相邻。假设每个剖分片的这种近邻剖分片对的数量由一个不依赖于 $N$ 的网格正则性常数 $c_{\\mathrm{near}}$ 为界。\n\n每个近场矩阵元素是通过在一对剖分片上对一个弱奇异核进行数值积分来计算的。在进行奇点消除的变量代换（例如 Duffy 变换）后，假设所得的被积函数具有有限的光滑性，其特征为一个不依赖于 $N$ 的整数 $s \\geq 1$。记 $q \\in \\mathbb{N}$ 为在变换后积分的局部坐标系中应用的张量积高斯求积的求积阶参数，并假设一个近场对的求积误差满足正则性限制的代数界\n$$\nE(q) \\leq C\\, q^{-\\nu},\n$$\n其中常数 $C>0$ 和 $\\nu>0$ 仅依赖于几何正则性、积分变换以及基函数/阶数，而不依赖于 $q$、$N$ 或剖分片对。\n\n假设用阶数 $q$ 计算一个近场剖分片对积分的计算成本（以浮点运算为单位）的缩放关系为\n$$\n\\Theta\\!\\left(q^{\\alpha}\\right),\n$$\n其中 $\\alpha>0$ 是一个固定的、与方法相关的指数，反映了求积法则的有效维度和任何局部正则化开销，并且除了这个幂次关系外，不依赖于 $N$ 和 $q$。因此，总的近场组装时间的缩放关系为\n$$\nT_{\\mathrm{near}}(N,\\epsilon) \\asymp K\\, N\\, q(\\epsilon)^{\\alpha},\n$$\n其中 $K>0$ 是一个不依赖于 $N$ 和 $\\epsilon$ 的常数，$q(\\epsilon)$ 是为满足每个剖分片对的误差容限 $\\epsilon \\in (0,1)$ 所需的最小求积阶数，即满足 $E(q) \\leq \\epsilon$ 的最小 $q$。\n\n仅使用上述正则性限制的求积误差模型和给定的成本模型，推导近场组装时间对容限参数 $\\epsilon$ 的灵敏度的显式渐近表达式，该灵敏度定义为弹性\n$$\n\\mathcal{S}(\\epsilon) \\equiv \\frac{\\mathrm{d}\\,\\ln T_{\\mathrm{near}}(N,\\epsilon)}{\\mathrm{d}\\,\\ln\\!\\left(1/\\epsilon\\right)}.\n$$\n将 $N$ 和所有其他常数视为与 $\\epsilon$ 无关，并假设 $\\epsilon$ 足够小以使渐近区域有效。你的最终答案必须是仅包含 $\\alpha$ 和 $\\nu$ 的单一闭式表达式。不要包含在灵敏度计算中会抵消掉的任何常数。将最终答案表示为单一的解析表达式。不需要进行数值舍入。",
            "solution": "目标是推导近场组装时间 $T_{\\mathrm{near}}$ 相对于误差容限 $\\epsilon$ 的灵敏度（或弹性）的表达式。该弹性定义为\n$$\n\\mathcal{S}(\\epsilon) \\equiv \\frac{\\mathrm{d}\\,\\ln T_{\\mathrm{near}}(N,\\epsilon)}{\\mathrm{d}\\,\\ln\\!\\left(1/\\epsilon\\right)}\n$$\n为了简化微分，我们定义一个新变量 $u = \\ln(1/\\epsilon)$。弹性的定义可以写为\n$$\n\\mathcal{S}(\\epsilon) = \\frac{\\mathrm{d}\\,\\ln T_{\\mathrm{near}}}{\\mathrm{d}u}\n$$\n问题陈述，总的近场组装时间 $T_{\\mathrm{near}}(N,\\epsilon)$ 具有如下的渐近缩放关系\n$$\nT_{\\mathrm{near}}(N,\\epsilon) \\asymp K\\, N\\, q(\\epsilon)^{\\alpha}\n$$\n其中 $K > 0$ 是一个常数，$N$ 是剖分片数量，$\\alpha > 0$ 是一个成本指数，$q(\\epsilon)$ 是依赖于容限的求积阶数。渐近关系 $f(x) \\asymp g(x)$ 意味着在所关心的极限下，比率 $f(x)/g(x)$ 被正的常数从上下界定。对于对数导数而言，任何这样的乘法常数都将消失。因此，我们可以写成 $T_{\\mathrm{near}}(N,\\epsilon) = K'\\, N\\, q(\\epsilon)^{\\alpha}$，其中 $K'$ 是某个有效常数，这样做不会失最终结果的一般性。\n\n对 $T_{\\mathrm{near}}$ 的表达式取自然对数，得到：\n$$\n\\ln T_{\\mathrm{near}}(N,\\epsilon) = \\ln\\left(K'\\, N\\, q(\\epsilon)^{\\alpha}\\right) = \\ln(K'N) + \\alpha \\ln(q(\\epsilon))\n$$\n现在，我们将此表达式对 $u = \\ln(1/\\epsilon)$ 求导。项 $\\ln(K'N)$ 相对于 $\\epsilon$（因此也相对于 $u$）是一个常数，所以它的导数为零。\n$$\n\\mathcal{S}(\\epsilon) = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\ln(K'N) + \\alpha \\ln(q(\\epsilon)) \\right] = \\alpha \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\ln(q(\\epsilon)) \\right]\n$$\n为了继续，我们必须找到 $q(\\epsilon)$ 和 $\\epsilon$ 之间的关系。求积阶数 $q(\\epsilon)$ 定义为使得求积误差 $E(q)$ 受容限 $\\epsilon$ 限制的最小整数 $q$。误差由以下代数界给出：\n$$\nE(q) \\leq C q^{-\\nu}\n$$\n其中常数 $C>0$ 且 $\\nu>0$。为了找到给定容限 $\\epsilon$ 所需的最小阶数，我们将误差界设为等于容限。虽然 $q$ 是一个整数，但对于这种 $\\epsilon$ 很小（因此 $q$ 很大）的渐近分析，我们可以将 $q$ 视为一个连续变量。\n$$\nC \\, q(\\epsilon)^{-\\nu} = \\epsilon\n$$\n我们现在求解此方程以得到 $q(\\epsilon)$：\n$$\nq(\\epsilon)^{-\\nu} = \\frac{\\epsilon}{C} \\implies q(\\epsilon)^{\\nu} = \\frac{C}{\\epsilon} \\implies q(\\epsilon) = \\left(\\frac{C}{\\epsilon}\\right)^{1/\\nu}\n$$\n这个表达式显示了所需的求积阶数如何随容限 $\\epsilon$ 缩放。现在我们可以找到 $\\ln(q(\\epsilon))$ 的表达式：\n$$\n\\ln(q(\\epsilon)) = \\ln\\left[ \\left(\\frac{C}{\\epsilon}\\right)^{1/\\nu} \\right] = \\frac{1}{\\nu} \\ln\\left(\\frac{C}{\\epsilon}\\right)\n$$\n利用对数的性质，我们可以分离各项：\n$$\n\\ln(q(\\epsilon)) = \\frac{1}{\\nu} \\left[ \\ln(C) + \\ln\\left(\\frac{1}{\\epsilon}\\right) \\right]\n$$\n回想我们的变量代换 $u = \\ln(1/\\epsilon)$，我们将其代入 $\\ln(q(\\epsilon))$ 的表达式中：\n$$\n\\ln(q(\\epsilon)) = \\frac{1}{\\nu} \\left( \\ln(C) + u \\right) = \\frac{\\ln(C)}{\\nu} + \\frac{u}{\\nu}\n$$\n我们现在得到了 $\\ln(q(\\epsilon))$ 作为 $u$ 的线性函数的表达式。我们可以计算弹性所需的导数：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\ln(q(\\epsilon)) \\right] = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\frac{\\ln(C)}{\\nu} + \\frac{u}{\\nu} \\right]\n$$\n由于 $\\ln(C)/\\nu$ 是一个常数，其导数为零。$u/\\nu$ 对 $u$ 的导数是 $1/\\nu$。\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\ln(q(\\epsilon)) \\right] = \\frac{1}{\\nu}\n$$\n最后，我们将这个结果代回到弹性 $\\mathcal{S}(\\epsilon)$ 的表达式中：\n$$\n\\mathcal{S}(\\epsilon) = \\alpha \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\ln(q(\\epsilon)) \\right] = \\alpha \\left(\\frac{1}{\\nu}\\right) = \\frac{\\alpha}{\\nu}\n$$\n弹性是一个常数值，与 $N$ 和 $\\epsilon$ 无关，仅由求积法则的成本指数 $\\alpha$ 和求积的收敛速率 $\\nu$ 决定。这就是最终结果。",
            "answer": "$$\\boxed{\\frac{\\alpha}{\\nu}}$$"
        },
        {
            "introduction": "在研究了近场部分后，我们现在将视角扩展到整个求解器系统。本练习旨在解决经典矩量法的两个主要瓶颈：稠密矩阵向量乘积的巨大计算量和系统的病态性。你将分析一个采用快速多极子方法 (FMM) 和 Calderón 预处理器的现代求解器，并推导构建和应用这些强大工具的计算成本。这项实践揭示了在最先进的求解器中，是如何实现接近线性的 $O(N \\ln N)$ 复杂度的。",
            "id": "3294009",
            "problem": "考虑一个理想电导体散射体，其边界为 $\\Gamma$。其电场积分方程 (EFIE) 由频域麦克斯韦方程组和边界 $\\Gamma$ 上的切向边界条件 $\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{tot}} = \\mathbf{0}$ 导出。设 EFIE 算子表示为 $\\mathcal{T}_{k}$，它由波数为 $k$ 的电磁格林函数构建。设采用 Rao–Wilton–Glisson (RWG) 基函数的 Galerkin 离散化方法，为未知的表面电流展开系数生成一个稠密系统矩阵 $Z \\in \\mathbb{C}^{N \\times N}$。关于边界 $\\Gamma$ 上的边界积分算子，经典的 Calderón 恒等式指出，边界积分算子的适当复合可产生第二类投影算子。这启发了一种乘法形式的 Calderón 预条件子，该预条件子能够平衡 EFIE 的谱特性。在一种常用的离散构造中，可以构建如下的乘法预条件子\n$$\nM \\;=\\; G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}},\n$$\n其中 $T_{\\tilde{k}}$ 是一个在辅助波数 $\\tilde{k}$（选择此波数以避免内部谐振）下的离散 EFIE 算子，$G$ 是一个稀疏 Gram 矩阵，用于在相容的试探空间和检验空间（例如，RWG 和 Buffa–Christiansen 空间）之间进行映射，$T_{\\tilde{k}}^{\\dagger}$ 表示关于由 $G$ 导出的离散 $L^{2}$ 配对的伴随算子。假设由于局部支集以及在 $\\Gamma$ 的形状正则三角剖分上顶点的度有界，矩阵 $G$ 具有 $\\mathcal{O}(N)$ 个非零元。\n\n为明确复杂度模型，对用于所有稠密算子应用和近场组装的三维快速多极子方法 (FMM) 采用以下假设：\n- 使用 FMM 与一个离散化的稠密边界积分算子（例如 $T_{\\tilde{k}}$ 或 $T_{\\tilde{k}}^{\\dagger}$）进行一次矩阵-向量乘法的成本为 $c_{m}\\, N\\, \\ln(N)$ 次浮点运算，其中 $c_{m} > 0$ 是一个包含核函数平移成本和展开阶数的常数，且树结构具有 $\\mathcal{O}(\\ln(N))$ 层和 $\\mathcal{O}(N)$ 次总盒子交互。\n- 为一个算子构建 FMM 数据结构（树、交互列表、多极/局域展开）的成本为 $c_{b}\\, N\\, \\ln(N)$ 次浮点运算，为一个算子组装近场块的成本为 $c_{n}\\, N$ 次浮点运算，其中 $c_{b}, c_{n} > 0$ 为常数。\n- 将稀疏 Gram 矩阵 $G$ 应用于一个向量的成本为 $c_{g}\\, N$ 次浮点运算，应用一次预计算的 $G$ 的稀疏近似逆（例如，通过不完全 Cholesky 分解后进行三角求解）的成本为 $c_{L}\\, N$ 次浮点运算，其中 $c_{g}, c_{L} > 0$ 为常数。\n- 构建 $G$ 的稀疏近似逆（包括组装 $G$ 本身）的成本为 $c_{g}\\, N + c_{s}\\, N$ 次浮点运算，其中 $c_{s} > 0$ 包含了分解/预条件子构建成本，并与有界填充产生的非零元数量成正比。\n\n从 Calderón 恒等式及其推论——即 EFIE 与相容的边界算子复合会产生一个第二类算子——出发，解释为什么乘法形式 $M = G^{-1} T_{\\tilde{k}}^{\\dagger} G T_{\\tilde{k}}$ 在对 $Z$ 进行预处理时具有谱优势。然后，仅使用所述的复杂度假设和 $M$ 的结构，推导出以下两项的闭式表达式：\n1. 构建 $M$ 的总成本（包括构建 $T_{\\tilde{k}}$ 和 $T_{\\tilde{k}}^{\\dagger}$ 的 FMM 结构及其近场块，以及组装 $G$ 和构建其稀疏近似逆）。\n2. 将 $M$ 应用于一个向量一次的总成本（即在迭代求解器内应用一次预条件子）。\n\n将两项结果表示为关于 $N$、$\\ln(N)$ 以及常数 $c_{m}$、$c_{b}$、$c_{n}$、$c_{g}$、$c_{L}$ 和 $c_{s}$ 的符号表达式。将 $T_{\\tilde{k}}$ 和 $T_{\\tilde{k}}^{\\dagger}$ 视为需要独立的 FMM 数据结构，其构建和应用成本相同。你的最终答案必须是闭式解析表达式。以浮点运算次数表示最终成本。不要包含任何物理单位。如果引入任何新符号，请明确定义它们。最终答案必须使用 $\\mathrm{pmatrix}$ 环境以单行矩阵形式提供，第一个条目为构建成本，第二个条目为应用成本。",
            "solution": "该问题要求提供两个主要部分：首先，解释所给出的乘法形式 Calderón 预条件子的谱优势；其次，基于一组明确的复杂度模型，推导构建和应用此预条件子的计算成本。\n\n**第一部分：Calderón 预条件子的谱特性**\n\n电场积分方程 (EFIE) 是从第一类 Fredholm 积分方程导出的。对此类方程进行离散化，例如使用带有 Rao–Wilton–Glisson (RWG) 基函数的矩量法 (MoM)，通常会得到一个线性系统 $Z \\mathbf{x} = \\mathbf{b}$，其中矩阵 $Z \\in \\mathbb{C}^{N \\times N}$ 是稠密的、非厄米的且严重病态的。连续 EFIE 算子的奇异值在零和无穷大处聚集，这种不良的谱行为被离散矩阵 $Z$ 继承。因此，当应用于原始系统矩阵 $Z$ 时，像 GMRES 这样的标准迭代求解器收敛非常缓慢，甚至不收敛。\n\n预处理旨在将系统转换为一个具有更有利谱特性的等价系统。对于系统 $Z \\mathbf{x} = \\mathbf{b}$，一个好的预条件子 $M$ 会产生一个预处理后的矩阵，例如 $M^{-1}Z$（左预处理）或 $ZM^{-1}$（右预处理），其谱理想地聚集在 $1$ 附近。这确保了迭代求解器的快速收敛。\n\nCalderón 恒等式是与偏微分方程（如 Helmholtz 方程，它控制时谐电磁学）相关的边界积分算子的基本性质。这些恒等式指出，基本边界积分算子（单层、双层、伴随双层和超奇异算子）的特定复合会产生单位算子的紧扰动。此类算子属于第二类 Fredholm 算子，其谱非常适合迭代方法。\n\nEFIE 算子，记为 $\\mathcal{T}_k$，是一个病态的第一类算子的例子。乘法预条件子 $M = G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}}$ 是一个旨在模拟连续 Calderón 恒等式的离散代数构造。其各组成部分的作用如下：\n1.  $T_{\\tilde{k}}$: 这是在非谐振的辅助波数 $\\tilde{k}$ 下的 EFIE 算子 $\\mathcal{T}_{\\tilde{k}}$ 的离散化。使用 $\\tilde{k} \\neq k$ 可确保预条件子本身不会因散射体的内部谐振而出现病态。\n2.  $T_{\\tilde{k}}^{\\dagger}$: 这代表了一个“对偶”算子的离散版本。在 Calderón 预处理的背景下，这通常与磁场积分方程 (MFIE) 算子有关，后者天然是第二类的。EFIE 和 MFIE 算子的复合会产生一个良态算子。\n3.  $G$ 和 $G^{-1}$: 矩阵 $G$ 是一个稀疏 Gram 矩阵，代表两组不同基函数（如 RWG 试探函数和 Buffa–Christiansen (BC) 检验函数）之间的内积。这些矩阵充当离散的“基变换”算子，将系数从一个函数空间表示映射到另一个，这对于正确形成与连续 Calderón 恒等式对应的算子离散复合至关重要。\n\n本质上，算子 $M$ 被构造成一个良态的第二类算子的离散近似。因此，预处理后的系统矩阵（例如 $M^{-1}Z$）预期是单位算子加上一个紧算子项的离散近似，从而导致谱聚集在一个单点周围，并因此确保迭代求解器的快速收敛。\n\n**第二部分：计算成本的推导**\n\n总成本是通过将问题假设中指定的各个步骤的成本相加得出的。\n\n**1. 构建预条件子 $M$ 的总成本**\n\n构建阶段涉及为应用算子 $M = G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}}$ 而构建所有必需的数据结构。我们不需要组装完整的矩阵 $M$。所需的组件是 $T_{\\tilde{k}}$ 和 $T_{\\tilde{k}}^{\\dagger}$ 的 FMM 结构，以及 $G$ 的稀疏近似逆。\n\n-   **$T_{\\tilde{k}}$ 的构建成本**：这包括构建 FMM 数据结构和组装近场交互块。\n    $$\n    C_{\\text{build}}(T_{\\tilde{k}}) = (\\text{FMM build cost}) + (\\text{Near-field assembly cost}) = c_{b}\\, N\\, \\ln(N) + c_{n}\\, N\n    $$\n-   **$T_{\\tilde{k}}^{\\dagger}$ 的构建成本**：问题指出 $T_{\\tilde{k}}^{\\dagger}$ 需要一个独立的 FMM 结构，其成本与 $T_{\\tilde{k}}$ 相同。\n    $$\n    C_{\\text{build}}(T_{\\tilde{k}}^{\\dagger}) = c_{b}\\, N\\, \\ln(N) + c_{n}\\, N\n    $$\n-   **$G$ 的逆的构建成本**：问题直接给出了组装稀疏矩阵 $G$ 和构建其稀疏近似逆（例如，通过不完全分解）的成本。\n    $$\n    C_{\\text{build}}(G^{-1}) = c_{g}\\, N + c_{s}\\, N\n    $$\n总构建成本 $C_{\\text{build}}(M)$ 是这些单独成本的总和。\n$$\nC_{\\text{build}}(M) = C_{\\text{build}}(T_{\\tilde{k}}) + C_{\\text{build}}(T_{\\tilde{k}}^{\\dagger}) + C_{\\text{build}}(G^{-1})\n$$\n$$\nC_{\\text{build}}(M) = \\left( c_{b}\\, N\\, \\ln(N) + c_{n}\\, N \\right) + \\left( c_{b}\\, N\\, \\ln(N) + c_{n}\\, N \\right) + \\left( c_{g}\\, N + c_{s}\\, N \\right)\n$$\n合并各项，我们得到总构建成本的最终表达式：\n$$\nC_{\\text{build}}(M) = 2\\, c_{b}\\, N\\, \\ln(N) + (2\\, c_{n} + c_{g} + c_{s})\\, N\n$$\n\n**2. 将预条件子 $M$ 应用于一个向量的总成本**\n\n应用预条件子涉及为给定向量 $\\mathbf{x}$ 计算矩阵-向量积 $\\mathbf{y} = M\\mathbf{x} = G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}}\\, \\mathbf{x}$。这是通过从右到左的一系列运算来执行的。\n\n-   **步骤 1：计算 $\\mathbf{v}_1 = T_{\\tilde{k}}\\, \\mathbf{x}$**：这是使用 FMM 进行的矩阵-向量乘法。\n    $$\n    C_{\\text{apply}}(T_{\\tilde{k}}) = c_{m}\\, N\\, \\ln(N)\n    $$\n-   **步骤 2：计算 $\\mathbf{v}_2 = G\\, \\mathbf{v}_1$**：这是一个稀疏矩阵-向量乘法。\n    $$\n    C_{\\text{apply}}(G) = c_{g}\\, N\n    $$\n-   **步骤 3：计算 $\\mathbf{v}_3 = T_{\\tilde{k}}^{\\dagger}\\, \\mathbf{v}_2$**：这是另一次 FMM 矩阵-向量乘法。其成本与应用 $T_{\\tilde{k}}$ 相同。\n    $$\n    C_{\\text{apply}}(T_{\\tilde{k}}^{\\dagger}) = c_{m}\\, N\\, \\ln(N)\n    $$\n-   **步骤 4：计算 $\\mathbf{y} = G^{-1}\\, \\mathbf{v}_3$**：这涉及应用预先计算的 $G$ 的稀疏近似逆（例如，使用不完全因子进行前向和后向替换）。\n    $$\n    C_{\\text{apply}}(G^{-1}) = c_{L}\\, N\n    $$\n应用 $M$ 一次的总成本 $C_{\\text{apply}}(M)$ 是这四个顺序步骤的成本之和。\n$$\nC_{\\text{apply}}(M) = C_{\\text{apply}}(T_{\\tilde{k}}) + C_{\\text{apply}}(G) + C_{\\text{apply}}(T_{\\tilde{k}}^{\\dagger}) + C_{\\text{apply}}(G^{-1})\n$$\n$$\nC_{\\text{apply}}(M) = c_{m}\\, N\\, \\ln(N) + c_{g}\\, N + c_{m}\\, N\\, \\ln(N) + c_{L}\\, N\n$$\n合并各项，我们得到总应用成本的最终表达式：\n$$\nC_{\\text{apply}}(M) = 2\\, c_{m}\\, N\\, \\ln(N) + (c_{g} + c_{L})\\, N\n$$\n这两个结果提供了构建成本和应用成本关于给定参数的闭式表达式。两者的主阶复杂度均为 $\\mathcal{O}(N \\ln N)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2 c_{b} N \\ln(N) + (2 c_{n} + c_{g} + c_{s}) N & 2 c_{m} N \\ln(N) + (c_{g} + c_{L}) N \\end{pmatrix}}\n$$"
        }
    ]
}