{
    "hands_on_practices": [
        {
            "introduction": "Before any calculations in the Multilevel Fast Multipole Algorithm (MLFMA) can begin, the computational domain must be organized into a hierarchical tree structure. The depth of this tree, or the number of levels $L$, is not arbitrary; it must be carefully chosen to ensure that the smallest boxes are both electrically small enough for efficient multipole expansions and sufficiently separated for the far-field approximation to hold. This exercise  provides hands-on practice in determining this crucial parameter, bridging the gap between the physical problem setup (frequency, domain size) and the algorithmic data structure of the MLFMA.",
            "id": "3332630",
            "problem": "Consider a three-dimensional time-harmonic scattering problem in free space, modeled by the scalar Helmholtz equation for the Green's function $G(\\mathbf{r})$ associated with the electric field integral equation. A Multilevel Fast Multipole Algorithm (MLFMA) is to be constructed over a uniform octree that encloses all sources and observers in a cubic bounding box of side length $D = 1.2\\,\\mathrm{m}$. The operating frequency is $f = 2.0\\,\\mathrm{GHz}$, and the speed of light is $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$, so that the free-space wavenumber is $k = 2\\pi f/c$.\n\nAt tree level $\\ell$, each cubic box has side length $h_{\\ell} = D/2^{\\ell}$, and we bound each box by its circumscribed sphere with radius $a_{\\ell} = \\sqrt{3}\\,h_{\\ell}/2$. The near-field of a box at level $\\ell$ is defined as the $3\\times 3 \\times 3$ block of boxes that share a face, edge, or corner with it; boxes outside this block form its far-field interaction list. Consequently, at the lowest level $L$, the minimum center-to-center separation among far-field boxes is $s_{\\min} = 2\\,h_{L}$.\n\nFor Multipole-to-Local (M2L) translations of the Helmholtz kernel within MLFMA to be stable and accurate at the lowest level, the following separation conditions must be met:\n- Non-overlap of bounding spheres: $s_{\\min} \\ge a_{L} + a_{L}$.\n- Group-size constraint: $k\\,a_{L} \\le \\kappa_{\\max}$ with $\\kappa_{\\max} = 0.7$.\n\nCompute the smallest integer number of levels $L$ such that both conditions are satisfied at the lowest level. Express your final answer as a dimensionless integer.",
            "solution": "The problem statement is critically evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n- Domain: Three-dimensional, uniform octree in a cubic bounding box.\n- Bounding box side length: $D = 1.2\\,\\mathrm{m}$.\n- Operating frequency: $f = 2.0\\,\\mathrm{GHz} = 2.0 \\times 10^9\\,\\mathrm{Hz}$.\n- Speed of light: $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$.\n- Free-space wavenumber: $k = 2\\pi f/c$.\n- Side length of a cubic box at level $\\ell$: $h_{\\ell} = D/2^{\\ell}$.\n- Radius of the circumscribed sphere for a box at level $\\ell$: $a_{\\ell} = \\sqrt{3}\\,h_{\\ell}/2$.\n- Near-field definition: $3\\times 3 \\times 3$ block of adjacent boxes.\n- Minimum center-to-center separation for far-field boxes at the lowest level $L$: $s_{\\min} = 2\\,h_{L}$.\n- First stability condition (non-overlap of bounding spheres): $s_{\\min} \\ge a_{L} + a_{L}$.\n- Second stability condition (group-size constraint): $k\\,a_{L} \\le \\kappa_{\\max}$, with $\\kappa_{\\max} = 0.7$.\n- Objective: Compute the smallest integer number of levels, $L$, that satisfies both conditions.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is firmly based on the principles of computational electromagnetics, specifically the Multilevel Fast Multipole Algorithm (MLFMA) applied to the Helmholtz equation. The concepts used, such as octree decomposition, bounding spheres, near-field/far-field separation, and stability conditions for multipole translations, are standard and well-established in the field. The provided physical constants and parameters are realistic.\n- **Well-Posed**: The problem provides all necessary information and defines two clear mathematical inequalities. The objective is to find the minimum integer $L$ that satisfies both, which is a well-defined mathematical task expected to have a unique solution.\n- **Objective**: The problem is stated using precise, unambiguous technical language, free of subjective or opinion-based claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, self-contained, and well-posed problem in computational science. A solution will be derived.\n\nThe task is to find the smallest integer $L$ that simultaneously satisfies two inequalities. We will analyze each condition separately.\n\n**Condition 1: Non-overlap of bounding spheres**\n\nThe first condition is $s_{\\min} \\ge a_{L} + a_{L}$.\nWe are given the expressions for the minimum separation $s_{\\min}$ and the bounding sphere radius $a_L$ at the lowest level $L$:\n$$s_{\\min} = 2\\,h_{L}$$\n$$a_{L} = \\frac{\\sqrt{3}}{2}\\,h_{L}$$\nSubstituting these into the inequality gives:\n$$2\\,h_{L} \\ge 2\\left(\\frac{\\sqrt{3}}{2}\\,h_{L}\\right)$$\n$$2\\,h_{L} \\ge \\sqrt{3}\\,h_{L}$$\nSince $h_{L} = D/2^{L}$ is a physical length, it is positive. We can divide both sides by $h_L$ without changing the inequality's direction:\n$$2 \\ge \\sqrt{3}$$\nSquaring both sides, we get $4 \\ge 3$, which is a true statement. This means that the first condition, concerning the non-overlap of bounding spheres for far-field boxes, is satisfied for any choice of level $L \\ge 0$, based on the given standard definition of the near-field and far-field. Therefore, this condition does not impose a constraint on the value of $L$.\n\n**Condition 2: Group-size constraint**\n\nThe second condition is $k\\,a_{L} \\le \\kappa_{\\max}$.\nThis condition limits the electrical size of the smallest boxes in the hierarchy to ensure the accuracy of the multipole expansions. We will use this inequality to find the constraint on $L$.\n\nFirst, we calculate the free-space wavenumber $k$:\n$$k = \\frac{2\\pi f}{c} = \\frac{2\\pi (2.0 \\times 10^9\\,\\mathrm{s}^{-1})}{2.99792458 \\times 10^{8}\\,\\mathrm{m/s}} = \\frac{40\\pi}{2.99792458}\\,\\mathrm{m}^{-1}$$\n\nNext, we express $a_L$ in terms of $L$ and the given parameters:\n$$a_{L} = \\frac{\\sqrt{3}}{2}\\,h_{L} = \\frac{\\sqrt{3}}{2} \\frac{D}{2^{L}}$$\n\nNow, we substitute these expressions into the inequality:\n$$k \\left(\\frac{\\sqrt{3}\\,D}{2 \\cdot 2^{L}}\\right) \\le \\kappa_{\\max}$$\n\nWe need to solve for $L$. Rearranging the inequality to isolate $2^{L}$:\n$$2^{L} \\ge \\frac{k\\sqrt{3}\\,D}{2\\,\\kappa_{\\max}}$$\n\nWe substitute the numerical values for the parameters:\n- $k = \\frac{40\\pi}{2.99792458}\\,\\mathrm{m}^{-1} \\approx 41.914486\\,\\mathrm{m}^{-1}$\n- $D = 1.2\\,\\mathrm{m}$\n- $\\kappa_{\\max} = 0.7$\n- $\\sqrt{3} \\approx 1.732051$\n\nPlugging these values into the right-hand side of the inequality:\n$$2^{L} \\ge \\frac{\\left(\\frac{40\\pi}{2.99792458}\\right) \\sqrt{3} (1.2)}{2 (0.7)}$$\n$$2^{L} \\ge \\frac{(41.914486) (1.732051) (1.2)}{1.4}$$\n$$2^{L} \\ge \\frac{87.12683}{1.4}$$\n$$2^{L} \\ge 62.23345$$\n\nTo find the smallest integer $L$ that satisfies this condition, we can take the base-$2$ logarithm of both sides:\n$$L \\ge \\log_{2}(62.23345)$$\n$$L \\ge \\frac{\\ln(62.23345)}{\\ln(2)}$$\n$$L \\ge \\frac{4.13093}{0.69315}$$\n$$L \\ge 5.9599...$$\n\nSince the number of levels $L$ must be an integer, the smallest integer value for $L$ that satisfies $L \\ge 5.9599...$ is $L=6$.\n\nThus, the smallest integer number of levels required to satisfy both stability conditions is $6$.",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "The remarkable efficiency of the MLFMA hinges on its \"Multipole-to-Local\" (M2L) translation operator, which approximates interactions between distant groups. A common and powerful technique for implementing this operator involves sampling the aggregated radiation pattern with a finite number of plane waves. The accuracy of this process depends critically on using a sufficient number of plane-wave directions, $Q$, to capture the angular complexity of the field, which is dictated by the multipole expansion order, $p$. This practice problem  guides you through the essential process of linking a desired accuracy tolerance, $\\epsilon$, to the required expansion order, $p$, and subsequently to the number of sampling points, $Q$, illuminating a key trade-off between accuracy and computational cost.",
            "id": "3332655",
            "problem": "In three-dimensional computational electromagnetics, the Multilevel Fast Multipole Algorithm (MLFMA) approximates the translation of aggregated radiation patterns between well-separated clusters by plane-wave sampling over the unit sphere. Consider a single MLFMA level with cubic cluster boxes of side length $b$ in free space. Let the circumscribing sphere radius be $a = \\frac{\\sqrt{3}}{2}\\,b$. The wavenumber is $k = \\frac{2\\pi f}{c}$, where $f$ is the frequency and $c$ is the speed of light in vacuum. The scalar free-space Green’s function solves the Helmholtz equation and admits both spherical-harmonic and plane-wave representations; the truncation of the former at degree $p$ induces an angular bandwidth that must be supported by the plane-wave sampling. Assume a tensor-product angular quadrature: Gauss–Legendre in polar angle and uniform trapezoidal in azimuth.\n\nStarting from the spherical-harmonic representation of the Helmholtz Green’s function and well-tested asymptotics for spherical Bessel functions, derive a conservative inequality that determines the minimal spherical-harmonic degree $p$ needed so that the truncation beyond degree $p$ yields a relative error no greater than a prescribed tolerance $\\epsilon$ in the directional translation for sources confined to the box (you may use any standard bound on the tail of the spherical Bessel series valid for $n \\geq k a$). Then, using angular bandwidth considerations and the exactness properties of the chosen quadrature rules, relate the number of plane-wave directions $Q$ to $p$.\n\nFinally, evaluate $Q$ for the following parameters:\n- Frequency $f = 3.0 \\times 10^{9}\\,\\text{s}^{-1}$,\n- Speed of light $c = 3.0 \\times 10^{8}\\,\\text{m/s}$,\n- Box side length $b = 1.0 \\times 10^{-1}\\,\\text{m}$,\n- Target relative error $\\epsilon = 1.0 \\times 10^{-4}$.\n\nReturn $Q$ as the smallest integer that satisfies your bound. The final answer must be a single integer. No units are required in the final answer. If any intermediate numerical approximations are needed, they must be carried out to a precision sufficient to determine this integer unambiguously.",
            "solution": "The problem requires the determination of the number of plane-wave sampling directions, $Q$, for a specific application of the Multilevel Fast Multipole Algorithm (MLFMA). The solution is a three-step process: first, we derive an inequality for the spherical-harmonic truncation degree $p$ based on the prescribed relative error $\\epsilon$; second, we relate the number of sampling directions $Q$ to $p$ based on the chosen quadrature scheme; and third, we compute the numerical value of $Q$ using the provided parameters.\n\n**Step 1: Derivation of the Truncation Degree $p$**\n\nThe core of the MLFMA translation operator involves plane-wave expansions. The plane wave $\\exp(i\\mathbf{k} \\cdot \\mathbf{r})$ can be expanded in terms of spherical harmonics and spherical Bessel functions:\n$$ \\exp(i\\mathbf{k} \\cdot \\mathbf{r}) = \\sum_{n=0}^{\\infty} (2n+1) i^n j_n(kr) P_n(\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{r}}) $$\nwhere $k=|\\mathbf{k}|$, $r=|\\mathbf{r}|$, $j_n$ is the spherical Bessel function of the first kind, and $P_n$ is the Legendre polynomial of degree $n$. In the MLFMA, this series is truncated at a degree $p$. The sources are confined within a cubic box of side length $b$, which is enclosed by a circumscribing sphere of radius $a = \\frac{\\sqrt{3}}{2}b$. Therefore, the argument of the Bessel function is bounded by $kr \\le ka$.\n\nThe truncation error is determined by the tail of this series, for $n > p$. The problem asks for a conservative inequality. For this, we can rely on standard bounds on the tail of the series, which are derived from the asymptotic behavior of spherical Bessel functions $j_n(x)$ for large order $n$ compared to the argument $x$. A widely used conservative bound on the relative error $\\epsilon$ due to truncation at degree $p$ is given by the inequality:\n$$ \\left( \\frac{eka}{2p} \\right)^p < \\epsilon $$\nThis inequality is valid for $p > ka$, where $e$ is Euler's number. It is derived under the assumption that the tail of the series is dominated by the first few neglected terms and employs an asymptotic bound for $j_n(x)$. We must find the smallest integer $p$ that satisfies both $p>ka$ and this inequality. This can be rewritten by taking the natural logarithm of both sides:\n$$ p \\ln\\left( \\frac{eka}{2p} \\right) < \\ln(\\epsilon) $$\n$$ p \\left( 1 + \\ln\\left(\\frac{ka}{2}\\right) - \\ln(p) \\right) < \\ln(\\epsilon) $$\nThis transcendental inequality will be solved numerically for $p$.\n\n**Step 2: Relation between Sampling Directions $Q$ and Truncation Degree $p$**\n\nThe problem specifies a tensor-product quadrature grid for sampling the plane-wave directions over the unit sphere. The directions are parameterized by a polar angle $\\theta \\in [0, \\pi]$ and an azimuthal angle $\\phi \\in [0, 2\\pi]$.\nThe total number of sampling points is $Q = N_\\theta N_\\phi$, where $N_\\theta$ is the number of points for the polar angle and $N_\\phi$ for the azimuthal angle.\n\nThe choice of $N_\\theta$ and $N_\\phi$ is governed by the need to accurately integrate products of spherical harmonics up to degree $p$. The spherical harmonic $Y_n^m(\\theta, \\phi)$ has a $\\phi$-dependence of $e^{im\\phi}$. The integrands in the MLFMA formulation involve products of two radiation patterns, leading to terms with up to $e^{i2p\\phi}$ dependence. The uniform trapezoidal rule with $N_\\phi$ points is exact for trigonometric polynomials of degree up to $N_\\phi - 1$. To ensure accuracy for the highest frequency component $2p$, we must have:\n$$ N_\\phi - 1 \\ge 2p \\implies N_\\phi \\ge 2p + 1 $$\nThe minimal choice is $N_\\phi = 2p+1$.\n\nThe $\\theta$-dependence involves associated Legendre polynomials $P_n^m(\\cos\\theta)$. The product of two such functions, each of degree up to $p$ in $\\cos\\theta$, results in a polynomial in $\\cos\\theta$ of degree up to $2p$. An $N_\\theta$-point Gauss-Legendre quadrature rule on $[-1, 1]$ is exact for polynomials of degree up to $2N_\\theta - 1$. To exactly integrate polynomials of degree $2p$, we need:\n$$ 2N_\\theta - 1 \\ge 2p \\implies N_\\theta \\ge p + \\frac{1}{2} $$\nSince $N_\\theta$ must be an integer, the minimal choice is $N_\\theta = p+1$.\n\nCombining these, the total number of plane-wave directions $Q$ is:\n$$ Q = N_\\theta N_\\phi = (p+1)(2p+1) $$\n\n**Step 3: Numerical Evaluation**\n\nWe are given the following parameters:\n-   Frequency: $f = 3.0 \\times 10^{9}\\,\\text{s}^{-1}$\n-   Speed of light: $c = 3.0 \\times 10^{8}\\,\\text{m/s}$\n-   Box side length: $b = 1.0 \\times 10^{-1}\\,\\text{m}$\n-   Target relative error: $\\epsilon = 1.0 \\times 10^{-4}$\n\nFirst, we calculate the wavenumber $k$:\n$$ k = \\frac{2\\pi f}{c} = \\frac{2\\pi (3.0 \\times 10^9\\,\\text{s}^{-1})}{3.0 \\times 10^8\\,\\text{m/s}} = 20\\pi\\,\\text{m}^{-1} $$\nNext, we calculate the radius $a$ of the circumscribing sphere:\n$$ a = \\frac{\\sqrt{3}}{2}b = \\frac{\\sqrt{3}}{2} (1.0 \\times 10^{-1}\\,\\text{m}) = \\frac{\\sqrt{3}}{20}\\,\\text{m} $$\nThe dimensionless parameter $ka$ is:\n$$ ka = (20\\pi) \\left(\\frac{\\sqrt{3}}{20}\\right) = \\pi\\sqrt{3} \\approx 5.4414 $$\nThe natural logarithm of the error tolerance is:\n$$ \\ln(\\epsilon) = \\ln(1.0 \\times 10^{-4}) = -4\\ln(10) \\approx -9.2103 $$\nNow we solve the transcendental inequality numerically for the smallest integer $p$ that satisfies $p > 5.4414$. We test integer values for $p$ starting from $6$:\n- For $p=14$:\n  $14 \\left( 1 + \\ln\\left(\\frac{ka}{2}\\right) - \\ln(14) \\right) = 14 \\left( 1 + \\ln\\left(\\frac{5.4414}{2}\\right) - \\ln(14) \\right) \\approx 14(1 + 1.0008 - 2.639) = -8.9348$.\n  Since $-8.9348 \\not -9.2103$, $p=14$ is insufficient.\n- For $p=15$:\n  $15 \\left( 1 + \\ln\\left(\\frac{ka}{2}\\right) - \\ln(15) \\right) = 15 \\left( 1 + \\ln\\left(\\frac{5.4414}{2}\\right) - \\ln(15) \\right) \\approx 15(1 + 1.0008 - 2.708) = -10.608$.\n  Since $-10.608  -9.2103$, $p=15$ is sufficient.\n\nThe smallest integer satisfying the conditions is $p=15$.\n\nFinally, we calculate the number of sampling directions $Q$ using the formula derived in Step 2:\n$$ Q = (p+1)(2p+1) = (15+1)(2 \\times 15 + 1) = (16)(31) = 496 $$\nThe minimal number of plane-wave directions is $496$.",
            "answer": "$$\\boxed{496}$$"
        },
        {
            "introduction": "Theoretical descriptions of algorithms often assume ideal conditions, such as perfectly centered boxes with all source geometry contained neatly within their bounding spheres. In practice, however, complex geometries can lead to partitioning imperfections where parts of the model \"leak\" outside their designated bounding volumes. Such flaws can violate the convergence criteria of the underlying mathematical formulations, such as the addition theorem, potentially leading to a severe loss of accuracy. This thought experiment  challenges you to think like an algorithm designer, evaluating various strategies to restore accuracy and robustness when faced with these common practical issues and thereby deepening your understanding of the algorithm's fundamental limits and strengths.",
            "id": "3332605",
            "problem": "Consider the Multilevel Fast Multipole Algorithm (MLFMA) for the three-dimensional scalar Helmholtz equation with free-space Green’s function $g(\\mathbf{r}) = \\dfrac{e^{ik\\|\\mathbf{r}\\|}}{\\|\\mathbf{r}\\|}$, where $k$ is the wavenumber and $\\mathbf{r} \\in \\mathbb{R}^{3}$. At a given level of the hierarchy, sources inside a spatial box are aggregated and represented by a multipole expansion about the box center $\\mathbf{c}$, and the box is associated with a bounding sphere of radius $a$ that is supposed to contain all source geometry in that box. For well-separated boxes, multipole-to-local translations rely on the addition theorem for spherical waves, which converges when the observer distance $r$ from $\\mathbf{c}$ satisfies $r  r'$, where $r'$ is the maximum distance from $\\mathbf{c}$ to any source point represented by the multipole expansion.\n\nSuppose that due to imperfect partitioning:\n- The box center is miscentered by an offset vector $\\boldsymbol{\\delta}$, so the maximum source radius relative to $\\mathbf{c}$ increases by $\\|\\boldsymbol{\\delta}\\|$.\n- Some geometry leaks outside the nominal bounding sphere by an amount $\\epsilon$, so the effective source radius becomes $a_{\\text{eff}} = a + \\|\\boldsymbol{\\delta}\\| + \\epsilon$.\n\nAssume that the observer box has a bounding sphere of radius $b$ and that the center-to-center separation is $R$. For translation based on the addition theorem to converge uniformly and for truncation at order $p$ to be accurate, a sufficient condition is that $R  a_{\\text{eff}} + b$, and the truncation error decays roughly as a geometric factor in the ratio $\\rho = \\dfrac{a_{\\text{eff}}}{R - b}$, i.e., the error behaves like $\\mathcal{O}(\\rho^{p})$ for $\\rho  1$.\n\nConsider the following concrete design and perturbations:\n- Initially, $R - b = 2a$, with perfect centering and no leakage, so $a_{\\text{eff}} = a$ and $\\rho_{0} = \\dfrac{a}{R - b} = \\dfrac{1}{2}$.\n- The truncation order $p$ was chosen so that the relative error is at most $\\eta = 10^{-6}$.\n- After miscentering and leakage, $\\|\\boldsymbol{\\delta}\\| = 0.2a$ and $\\epsilon = 0.1a$, so $a_{\\text{eff}} = 1.3a$ and $\\rho_{1} = \\dfrac{a_{\\text{eff}}}{R - b} = \\dfrac{1.3a}{2a} = 0.65$.\n\nBased on first principles (the addition theorem convergence condition $r  r'$ and the geometric decay of truncation error with $\\rho$), evaluate the following corrective strategies for accuracy and theoretical soundness, and select all that are correct:\n\nA. Recenter each box to the true geometric centroid to reduce $\\|\\boldsymbol{\\delta}\\|$ to $0$, enlarge the bounding sphere only to cover the leaked geometry so $a_{\\text{eff}}$ becomes $a + \\epsilon$, update the interaction lists to enforce $R  a_{\\text{eff}} + b$, and, if needed, recompute the truncation order $p$ from the target $\\eta$ using the new ratio $\\rho' = \\dfrac{a + \\epsilon}{R - b}$.\n\nB. Leave the miscentering and leakage as is, and simply increase the truncation order from $p$ to $p'$ so that $(\\rho_{1})^{p'} \\le \\eta$ holds globally at the affected level.\n\nC. Keep $p$, $a$, and $\\mathbf{c}$ unchanged, and relax the well-separatedness criterion so that interactions with $R \\le a_{\\text{eff}} + b$ are still treated by multipole-to-local translation, relying on the plane-wave representation to compensate for lack of separation.\n\nD. Subdivide the offending box into smaller child boxes at that level so that each child box has a smaller radius $a_{\\text{child}}$ and no leakage, choose new centers $\\mathbf{c}_{\\text{child}}$ to eliminate miscentering, and revalidate $R  a_{\\text{eff,child}} + b$ for interactions; keep the original truncation order $p$ if $\\rho_{\\text{child}} = \\dfrac{a_{\\text{eff,child}}}{R - b}$ remains below the original design ratio.\n\nE. Shrink the bounding sphere back to $a$ by discarding contributions from geometry outside radius $a$ and keep the original $p$ and interaction lists, relying on the near-field correction to compensate the omitted sources.\n\nSelect all correct options.",
            "solution": "The problem statement describes a scenario in the Multilevel Fast Multipole Algorithm (MLFMA) where imperfect spatial partitioning has led to a degradation in the accuracy of the far-field calculations. We must evaluate several proposed corrective strategies based on the fundamental principles of the algorithm.\n\n### Step 1: Extract Givens\n- **Algorithm**: Multilevel Fast Multipole Algorithm (MLFMA) for the 3D scalar Helmholtz equation.\n- **Green's Function**: $g(\\mathbf{r}) = \\dfrac{e^{ik\\|\\mathbf{r}\\|}}{\\|\\mathbf{r}\\|}$.\n- **Core Principle 1 (Convergence)**: The addition theorem for spherical waves, used for multipole-to-local (M2L) translations, converges for an observer at distance $r$ from a source box center $\\mathbf{c}$ if $r  r'$, where $r'$ is the maximum distance of any source from $\\mathbf{c}$. For an entire observer box, a sufficient condition for uniform convergence and accuracy is stated as $R  a_{\\text{eff}} + b$, where $R$ is the center-to-center distance, $a_{\\text{eff}}$ is the effective radius of the source box's bounding sphere, and $b$ is the radius of the observer box's bounding sphere.\n- **Core Principle 2 (Truncation Error)**: The truncation error for an expansion of order $p$ behaves like $\\mathcal{O}(\\rho^{p})$, where $\\rho = \\dfrac{a_{\\text{eff}}}{R - b}$. Accuracy requires $\\rho  1$.\n- **Initial (Ideal) State**:\n  - Center-to-observer-box-surface distance: $R - b = 2a$.\n  - No miscentering or leakage: $\\|\\boldsymbol{\\delta}\\| = 0$, $\\epsilon = 0$.\n  - Effective source radius: $a_{\\text{eff}} = a$.\n  - Geometric ratio: $\\rho_{0} = \\dfrac{a}{R - b} = \\dfrac{a}{2a} = \\dfrac{1}{2}$.\n  - Target relative error: $\\eta = 10^{-6}$, achieved with truncation order $p$. This implies $(\\rho_{0})^p = (0.5)^p \\le 10^{-6}$.\n- **Perturbed State**:\n  - Miscentering: $\\|\\boldsymbol{\\delta}\\| = 0.2a$.\n  - Leakage: $\\epsilon = 0.1a$.\n  - New effective source radius: $a_{\\text{eff}} = a + \\|\\boldsymbol{\\delta}\\| + \\epsilon = a + 0.2a + 0.1a = 1.3a$.\n  - New geometric ratio: $\\rho_{1} = \\dfrac{a_{\\text{eff}}}{R - b} = \\dfrac{1.3a}{2a} = 0.65$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is well-founded in the principles of computational electromagnetics and the theory of the Fast Multipole Method. The definitions of bounding spheres, well-separatedness, the addition theorem's convergence requirements, and the model for truncation error are all standard in the field. The provided scenario of imperfect partitioning is a practical and realistic challenge in MLFMA implementations. The numerical values are consistent and the problem is logically structured. The problem is therefore valid.\n\n### Step 3: Derivation and Option-by-Option Analysis\n\nThe core of the problem is that the geometric ratio has increased from $\\rho_{0} = 0.5$ to $\\rho_{1} = 0.65$. Since the truncation error behaves as $\\mathcal{O}(\\rho^p)$, and $p$ was chosen such that $(0.5)^p \\le 10^{-6}$, the new error with the same $p$ will be proportional to $(0.65)^p$, which is significantly larger than $(0.5)^p$ and will likely exceed the target error $\\eta$.\n\nFurthermore, we must check the fundamental validity condition for M2L translations: $R - b  a_{\\text{eff}}$. In the perturbed state, we have $R - b = 2a$ and $a_{\\text{eff}} = 1.3a$. The condition $2a  1.3a$ is satisfied. This means the M2L translation series still converges, but its rate of convergence is slower, leading to reduced accuracy for a fixed truncation order $p$.\n\nWe now evaluate each corrective strategy.\n\n**A. Recenter each box to the true geometric centroid to reduce $\\|\\boldsymbol{\\delta}\\|$ to $0$, enlarge the bounding sphere only to cover the leaked geometry so $a_{\\text{eff}}$ becomes $a + \\epsilon$, update the interaction lists to enforce $R  a_{\\text{eff}} + b$, and, if needed, recompute the truncation order $p$ from the target $\\eta$ using the new ratio $\\rho' = \\dfrac{a + \\epsilon}{R - b}$.**\n\nThis strategy consists of several sound actions:\n1.  **Recentering**: Setting the expansion center $\\mathbf{c}$ to the geometric centroid of the sources is optimal as it minimizes the radius of the required bounding sphere. This correctly eliminates the $\\|\\boldsymbol{\\delta}\\|$ term from the effective radius calculation.\n2.  **Enlarging Sphere**: The bounding sphere for the multipole expansion *must* contain all sources it represents. Enlarging the sphere to account for leakage $\\epsilon$ is necessary for the theoretical validity of the expansion. The new effective radius becomes $a_{\\text{eff}}' = a + \\epsilon = a + 0.1a = 1.1a$.\n3.  **Updating Interaction Lists**: The well-separatedness criterion $R  a_{\\text{eff}} + b$ is fundamental. Since $a_{\\text{eff}}$ has changed to $1.1a$, the interaction list must be rebuilt based on this stricter condition. Any pair of boxes that no longer satisfies this condition must be moved from the far-field list to the near-field list for direct computation.\n4.  **Recomputing Truncation Order**: For the remaining far-field interactions (assuming $R-b=2a$ for some), the new ratio is $\\rho' = \\dfrac{1.1a}{2a} = 0.55$. Since $\\rho'  \\rho_0$, the original truncation order $p$ is likely insufficient to meet the error tolerance $\\eta$. Recomputing $p$ based on the new ratio $\\rho'$ and the target $\\eta$ is the correct way to restore accuracy.\n\nThis option systematically addresses all ramifications of the initial partitioning flaw in a theoretically rigorous manner. It is a complete and correct procedure.\n\nVerdict: **Correct**.\n\n**B. Leave the miscentering and leakage as is, and simply increase the truncation order from $p$ to $p'$ so that $(\\rho_{1})^{p'} \\le \\eta$ holds globally at the affected level.**\n\nThis strategy accepts the new geometric configuration and its corresponding ratio $\\rho_1 = 0.65$. As established, the convergence condition $R - b  a_{\\text{eff}}$ (i.e., $2a  1.3a$) still holds. The issue is a loss of accuracy, not a breakdown of convergence. The truncation error is a direct function of $p$ and $\\rho$. By increasing the truncation order from $p$ to a new value $p'$ such that $(\\rho_1)^{p'} = (0.65)^{p'} \\le 10^{-6}$, the desired accuracy can be restored. This is a valid trade-off: instead of modifying the data structures (box centers, radii, interaction lists), one increases the computational cost of the translation step, which typically scales as a polynomial in $p$ (e.g., $\\mathcal{O}(p^2)$ or higher). While potentially inefficient, the approach is theoretically sound.\n\nVerdict: **Correct**.\n\n**C. Keep $p$, $a$, and $\\mathbf{c}$ unchanged, and relax the well-separatedness criterion so that interactions with $R \\le a_{\\text{eff}} + b$ are still treated by multipole-to-local translation, relying on the plane-wave representation to compensate for lack of separation.**\n\nThis strategy is fundamentally flawed. The condition $R  a_{\\text{eff}} + b$ (or more precisely, $R-b  a_{\\text{eff}}$) ensures that the spherical wave expansion, on which the addition theorem is based, converges for all observer points. If this condition is violated (i.e., $R-b \\le a_{\\text{eff}}$), the expansion series diverges, leading to uncontrolled, catastrophic errors, not just reduced accuracy. The \"plane-wave representation\" is a technique to efficiently compute the translation operator, often using FFTs. It does not alter the fundamental mathematical properties of the underlying spherical wave addition theorem. Using the M2L translation for non-well-separated boxes is a violation of the algorithm's core principles.\n\nVerdict: **Incorrect**.\n\n**D. Subdivide the offending box into smaller child boxes at that level so that each child box has a smaller radius $a_{\\text{child}}$ and no leakage, choose new centers $\\mathbf{c}_{\\text{child}}$ to eliminate miscentering, and revalidate $R  a_{\\text{eff,child}} + b$ for interactions; keep the original truncation order $p$ if $\\rho_{\\text{child}} = \\dfrac{a_{\\text{eff,child}}}{R - b}$ remains below the original design ratio.**\n\nThis strategy leverages the hierarchical nature of the MLFMA. Instead of fixing the problematic large box, it replaces it with several smaller child boxes. This is a form of adaptive mesh refinement.\n1.  **Subdivision**: By partitioning the sources into smaller boxes, one can create new bounding spheres that are well-centered ($\\|\\boldsymbol{\\delta}_{\\text{child}}\\| = 0$) and contain all their respective geometry ($\\epsilon_{\\text{child}} = 0$). This gives an effective radius $a_{\\text{eff,child}} = a_{\\text{child}}$ for each child, where $a_{\\text{child}}$ is typically much smaller than the original $a$.\n2.  **Revalidation**: Interactions must be re-evaluated for each new child box. Some interactions that were far-field for the parent box might become near-field for a specific child, requiring a change in the interaction list. This is a necessary step.\n3.  **Accuracy check**: For the interactions that remain in the far field, the new geometric ratio is $\\rho_{\\text{child}} = \\dfrac{a_{\\text{child}}}{R_{\\text{child}} - b}$. Since $a_{\\text{child}}$ is smaller and $R_{\\text{child}}-b$ is often comparable to the original $R-b$, it is very likely that $\\rho_{\\text{child}} \\le \\rho_0 = 0.5$. If this condition is met, the original truncation order $p$ is sufficient to guarantee the target accuracy. This is a robust and theoretically sound method for handling geometric irregularities.\n\nVerdict: **Correct**.\n\n**E. Shrink the bounding sphere back to $a$ by discarding contributions from geometry outside radius $a$ and keep the original $p$ and interaction lists, relying on the near-field correction to compensate the omitted sources.**\n\nThis strategy introduces a fundamental modeling error. The multipole expansion of a box serves as a proxy for *all* sources within that box's partitioning. By discarding contributions from sources outside radius $a$, the expansion becomes an incorrect representation of the physical reality. This omission directly violates Gauss's law analogue for the Helmholtz equation. The \"near-field correction\" refers to the direct computation of interactions between boxes on the near-field list. A box B in the far-field of box A is, by definition, not on A's near-field list. Therefore, there is no mechanism by which the contribution of sources omitted from A's multipole expansion would be accounted for in the interaction with B. This strategy results in a loss of source information and an uncontrolled error in the final solution.\n\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}