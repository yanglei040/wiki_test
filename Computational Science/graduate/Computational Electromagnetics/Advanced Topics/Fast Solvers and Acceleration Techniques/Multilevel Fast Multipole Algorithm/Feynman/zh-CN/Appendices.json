{
    "hands_on_practices": [
        {
            "introduction": "多级快速多极子算法 (MLFMA) 的第一步是将计算域分解为分层的立方体结构，通常是八叉树。本练习将提供确定该层次结构所需层数的实践经验，这是平衡计算成本和算法稳定性的关键步骤。通过应用关于立方体尺寸和分离的明确标准，您将学会如何为给定的电磁问题建立一个有效且稳健的 MLFMA 结构。",
            "id": "3332630",
            "problem": "考虑一个自由空间中的三维时谐散射问题，该问题由与电场积分方程相关的格林函数 $G(\\mathbf{r})$ 的标量亥姆霍兹方程建模。将在一个均匀八叉树上构建一个多层快速多极子算法 (MLFMA)，该八叉树将所有源和观察点包围在一个边长为 $D = 1.2\\,\\mathrm{m}$ 的立方体包围盒内。工作频率为 $f = 2.0\\,\\mathrm{GHz}$，光速为 $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$，因此自由空间波数为 $k = 2\\pi f/c$。\n\n在树的第 $\\ell$ 层，每个立方体盒子的边长为 $h_{\\ell} = D/2^{\\ell}$，我们用半径为 $a_{\\ell} = \\sqrt{3}\\,h_{\\ell}/2$ 的外接球来界定每个盒子。第 $\\ell$ 层盒子的近场定义为与其共享一个面、边或角的 $3\\times 3 \\times 3$ 的盒子块；此块之外的盒子构成其远场相互作用列表。因此，在最底层 $L$，远场盒子之间的最小中心间距为 $s_{\\min} = 2\\,h_{L}$。\n\n为确保 MLFMA 中亥姆霍兹核的多极子到局部 (M2L) 转换在最底层是稳定和准确的，必须满足以下分离条件：\n- 包围球不重叠：$s_{\\min} \\ge a_{L} + a_{L}$。\n- 组尺寸约束：$k\\,a_{L} \\le \\kappa_{\\max}$，其中 $\\kappa_{\\max} = 0.7$。\n\n计算满足最底层两个条件的最小整数层数 $L$。将最终答案表示为一个无量纲整数。",
            "solution": "在进行求解之前，对问题陈述的有效性进行严格评估。\n\n### 第1步：提取已知条件\n- 域：三维，立方体包围盒内的均匀八叉树。\n- 包围盒边长：$D = 1.2\\,\\mathrm{m}$。\n- 工作频率：$f = 2.0\\,\\mathrm{GHz} = 2.0 \\times 10^9\\,\\mathrm{Hz}$。\n- 光速：$c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$。\n- 自由空间波数：$k = 2\\pi f/c$。\n- 第 $\\ell$ 层立方体盒子的边长：$h_{\\ell} = D/2^{\\ell}$。\n- 第 $\\ell$ 层盒子的外接球半径：$a_{\\ell} = \\sqrt{3}\\,h_{\\ell}/2$。\n- 近场定义：$3\\times 3 \\times 3$ 的相邻盒子块。\n- 最底层 $L$ 远场盒子的最小中心间距：$s_{\\min} = 2\\,h_{L}$。\n- 第一个稳定性条件（包围球不重叠）：$s_{\\min} \\ge a_{L} + a_{L}$。\n- 第二个稳定性条件（组尺寸约束）：$k\\,a_{L} \\le \\kappa_{\\max}$，其中 $\\kappa_{\\max} = 0.7$。\n- 目标：计算满足这两个条件的最小整数层数 $L$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题牢固地建立在计算电磁学的原理之上，特别是应用于亥姆霍兹方程的多层快速多极子算法 (MLFMA)。所使用的概念，如八叉树分解、包围球、近场/远场分离以及多极子转换的稳定性条件，都是该领域的标准且成熟的概念。所提供的物理常数和参数是现实的。\n- **适定性**：该问题提供了所有必要的信息，并定义了两个清晰的数学不等式。目标是找到满足这两个不等式的最小整数 $L$，这是一个定义明确且预期有唯一解的数学任务。\n- **客观性**：问题陈述使用了精确、无歧义的技术语言，不包含任何主观或基于意见的主张。\n\n### 第3步：结论与行动\n该问题是有效的。这是一个计算科学中的标准、自洽且适定的问题。将推导其解。\n\n任务是找到同时满足两个不等式的最小整数 $L$。我们将分别分析每个条件。\n\n**条件1：包围球不重叠**\n\n第一个条件是 $s_{\\min} \\ge a_{L} + a_{L}$。\n我们已知最底层 $L$ 的最小间距 $s_{\\min}$ 和包围球半径 $a_L$ 的表达式：\n$$s_{\\min} = 2\\,h_{L}$$\n$$a_{L} = \\frac{\\sqrt{3}}{2}\\,h_{L}$$\n将这些代入不等式，得到：\n$$2\\,h_{L} \\ge 2\\left(\\frac{\\sqrt{3}}{2}\\,h_{L}\\right)$$\n$$2\\,h_{L} \\ge \\sqrt{3}\\,h_{L}$$\n由于 $h_{L} = D/2^{L}$ 是一个物理长度，所以它是正数。我们可以在不等式两边同时除以 $h_L$ 而不改变不等号的方向：\n$$2 \\ge \\sqrt{3}$$\n两边平方，我们得到 $4 \\ge 3$，这是一个成立的陈述。这意味着，基于给定的近场和远场的标准定义，第一个关于远场盒子包围球不重叠的条件对于任何层级 $L \\ge 0$ 的选择都是满足的。因此，这个条件不对 $L$ 的值施加约束。\n\n**条件2：组尺寸约束**\n\n第二个条件是 $k\\,a_{L} \\le \\kappa_{\\max}$。\n这个条件限制了层次结构中最小盒子的电尺寸，以确保多极子展开的准确性。我们将使用这个不等式来找到对 $L$ 的约束。\n\n首先，我们计算自由空间波数 $k$：\n$$k = \\frac{2\\pi f}{c} = \\frac{2\\pi (2.0 \\times 10^9\\,\\mathrm{s}^{-1})}{2.99792458 \\times 10^{8}\\,\\mathrm{m/s}} = \\frac{40\\pi}{2.99792458}\\,\\mathrm{m}^{-1}$$\n\n接下来，我们用 $L$ 和给定的参数来表示 $a_L$：\n$$a_{L} = \\frac{\\sqrt{3}}{2}\\,h_{L} = \\frac{\\sqrt{3}}{2} \\frac{D}{2^{L}}$$\n\n现在，我们将这些表达式代入不等式：\n$$k \\left(\\frac{\\sqrt{3}\\,D}{2 \\cdot 2^{L}}\\right) \\le \\kappa_{\\max}$$\n\n我们需要求解 $L$。整理不等式以分离出 $2^{L}$：\n$$2^{L} \\ge \\frac{k\\sqrt{3}\\,D}{2\\,\\kappa_{\\max}}$$\n\n我们代入参数的数值：\n- $k = \\frac{40\\pi}{2.99792458}\\,\\mathrm{m}^{-1} \\approx 41.914486\\,\\mathrm{m}^{-1}$\n- $D = 1.2\\,\\mathrm{m}$\n- $\\kappa_{\\max} = 0.7$\n- $\\sqrt{3} \\approx 1.732051$\n\n将这些值代入不等式的右边：\n$$2^{L} \\ge \\frac{\\left(\\frac{40\\pi}{2.99792458}\\right) \\sqrt{3} (1.2)}{2 (0.7)}$$\n$$2^{L} \\ge \\frac{(41.914486) (1.732051) (1.2)}{1.4}$$\n$$2^{L} \\ge \\frac{87.12683}{1.4}$$\n$$2^{L} \\ge 62.23345$$\n\n为了找到满足此条件的最小整数 $L$，我们可以对不等式两边取以2为底的对数：\n$$L \\ge \\log_{2}(62.23345)$$\n$$L \\ge \\frac{\\ln(62.23345)}{\\ln(2)}$$\n$$L \\ge \\frac{4.13093}{0.69315}$$\n$$L \\ge 5.9599...$$\n\n由于层数 $L$ 必须是整数，满足 $L \\ge 5.9599...$ 的最小整数值是 $L=6$。\n\n因此，满足两个稳定性条件所需的最小整数层数是 $6$。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "MLFMA 的效率源于其使用有限数量的平面波来近似远场相互作用。本练习演示了如何确定达到所需精度目标所需的最少平面波数，从而将数学截断误差与关键的计算参数（如球谐函数阶数 $p$ 和采样方向数 $Q$）联系起来。解决此问题将加深您对精度、展开阶数和计算工作量之间权衡的理解。",
            "id": "3332655",
            "problem": "在三维计算电磁学中，多层快速多极子算法 (Multilevel Fast Multipole Algorithm, MLFMA) 通过在单位球面上的平面波采样，来近似远分离簇之间聚合辐射方向图的平移。考虑一个在自由空间中的 MLFMA 单层，其立方体簇盒的边长为 $b$。设其外接球半径为 $a = \\frac{\\sqrt{3}}{2}\\,b$。波数为 $k = \\frac{2\\pi f}{c}$，其中 $f$ 是频率，$c$ 是真空中的光速。标量自由空间格林函数是亥姆霍兹方程的解，并且同时具有球谐函数和平面波两种表示形式；将球谐函数表示在阶数 $p$ 处截断会产生一个角带宽，该带宽必须由平面波采样来支持。假设采用张量积形式的角向求积：极角方向采用 Gauss–Legendre 求积，方位角方向采用均匀梯形求积。\n\n从亥姆霍兹格林函数的球谐函数表示以及球贝塞尔函数经过充分检验的渐近式出发，推导一个保守不等式，该不等式用于确定所需的最小球谐函数阶数 $p$，使得对于限制在盒子内的源的方向性平移，超过阶数 $p$ 的截断所产生的相对误差不大于给定的容差 $\\epsilon$（您可以对 $n \\geq k a$ 的情况使用任何适用于球贝塞尔级数尾部的标准界）。然后，利用角带宽的考虑以及所选求积法则的精确性性质，将平面波方向数 $Q$ 与 $p$ 联系起来。\n\n最后，根据以下参数计算 $Q$ 的值：\n- 频率 $f = 3.0 \\times 10^{9}\\,\\text{s}^{-1}$，\n- 光速 $c = 3.0 \\times 10^{8}\\,\\text{m/s}$，\n- 盒边长 $b = 1.0 \\times 10^{-1}\\,\\text{m}$，\n- 目标相对误差 $\\epsilon = 1.0 \\times 10^{-4}$。\n\n返回满足您推导的界的最小整数 $Q$。最终答案必须是单个整数。最终答案中不需要单位。如果需要任何中间数值近似，其精度必须足以明确地确定这个整数。",
            "solution": "本问题要求确定在多层快速多极子算法 (MLFMA) 的一个特定应用中平面波采样方向的数量 $Q$。求解过程分为三步：首先，我们基于给定的相对误差 $\\epsilon$ 推导球谐函数截断阶数 $p$ 的不等式；其次，我们基于所选的求积方案将采样方向数 $Q$ 与 $p$ 联系起来；最后，我们使用给定的参数计算 $Q$ 的数值。\n\n**步骤 1：截断阶数 $p$ 的推导**\n\nMLFMA 平移算子的核心涉及平面波展开。平面波 $\\exp(i\\mathbf{k} \\cdot \\mathbf{r})$ 可以用球谐函数和球贝塞尔函数展开：\n$$ \\exp(i\\mathbf{k} \\cdot \\mathbf{r}) = \\sum_{n=0}^{\\infty} (2n+1) i^n j_n(kr) P_n(\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{r}}) $$\n其中 $k=|\\mathbf{k}|$，$r=|\\mathbf{r}|$，$j_n$ 是第一类球贝塞尔函数，$P_n$ 是 $n$ 阶勒让德多项式。在 MLFMA 中，此级数在阶数 $p$ 处被截断。源被限制在边长为 $b$ 的立方体盒子内，该盒子被一个半径为 $a = \\frac{\\sqrt{3}}{2}b$ 的外接球所包围。因此，贝塞尔函数的宗量有界，$kr \\le ka$。\n\n截断误差由该级数 $n > p$ 的尾部决定。问题要求一个保守不等式。为此，我们可以依赖级数尾部的标准界，这些界源于当阶数 $n$ 相对于宗量 $x$ 很大时球贝塞尔函数 $j_n(x)$ 的渐近行为。一个广泛使用的、由于在阶数 $p$ 处截断而导致的相对误差 $\\epsilon$ 的保守界由以下不等式给出：\n$$ \\left( \\frac{eka}{2p} \\right)^p \\le \\epsilon $$\n该不等式在 $p > ka$ 时有效，其中 $e$ 是 Euler 数。它的推导基于级数尾部由最初几个被忽略的项主导的假设，并采用了 $j_n(x)$ 的一个渐近界。我们必须找到同时满足 $p > ka$ 和此不等式的最小整数 $p$。这可以通过对两边取自然对数来重写：\n$$ p \\ln\\left( \\frac{eka}{2p} \\right) \\le \\ln(\\epsilon) $$\n$$ p \\left( 1 + \\ln\\left(\\frac{ka}{2}\\right) - \\ln(p) \\right) \\le \\ln(\\epsilon) $$\n这个超越不等式将通过数值方法求解 $p$。\n\n**步骤 2：采样方向数 $Q$ 和截断阶数 $p$ 之间的关系**\n\n问题指定了用于在单位球面上采样平面波方向的张量积求积网格。方向由极角 $\\theta \\in [0, \\pi]$ 和方位角 $\\phi \\in [0, 2\\pi]$ 参数化。总采样点数为 $Q = N_\\theta N_\\phi$，其中 $N_\\theta$ 是极角的点数，$N_\\phi$ 是方位角的点数。\n\n$N_\\theta$ 和 $N_\\phi$ 的选择取决于精确积分最高达 $p$ 阶的球谐函数乘积的需求。球谐函数 $Y_n^m(\\theta, \\phi)$ 具有 $e^{im\\phi}$ 的 $\\phi$ 相关性。MLFMA 公式中的被积函数涉及两个辐射方向图的乘积，从而产生高达 $e^{i2p\\phi}$ 相关性的项。具有 $N_\\phi$ 个点的均匀梯形法对于最高达 $N_\\phi - 1$ 阶的三角多项式是精确的。为确保对最高频率分量 $2p$ 的精确性，我们必须有：\n$$ N_\\phi - 1 \\ge 2p \\implies N_\\phi \\ge 2p + 1 $$\n最小的选择是 $N_\\phi = 2p+1$。\n\n$\\theta$ 相关性涉及连带勒让德多项式 $P_n^m(\\cos\\theta)$。两个这样的函数（每个在 $\\cos\\theta$ 中的阶数最高为 $p$）的乘积，结果是一个在 $\\cos\\theta$ 中阶数最高为 $2p$ 的多项式。在 $[-1, 1]$ 上的一个 $N_\\theta$ 点 Gauss-Legendre 求积法则对于最高达 $2N_\\theta - 1$ 阶的多项式是精确的。为了精确积分 $2p$ 阶多项式，我们需要：\n$$ 2N_\\theta - 1 \\ge 2p \\implies N_\\theta \\ge p + \\frac{1}{2} $$\n由于 $N_\\theta$ 必须是整数，最小的选择是 $N_\\theta = p+1$。\n\n结合这些，平面波方向的总数 $Q$ 是：\n$$ Q = N_\\theta N_\\phi = (p+1)(2p+1) $$\n\n**步骤 3：数值计算**\n\n给定以下参数：\n-   频率：$f = 3.0 \\times 10^{9}\\,\\text{s}^{-1}$\n-   光速：$c = 3.0 \\times 10^{8}\\,\\text{m/s}$\n-   盒边长：$b = 1.0 \\times 10^{-1}\\,\\text{m}$\n-   目标相对误差：$\\epsilon = 1.0 \\times 10^{-4}$\n\n首先，我们计算波数 $k$：\n$$ k = \\frac{2\\pi f}{c} = \\frac{2\\pi (3.0 \\times 10^9\\,\\text{s}^{-1})}{3.0 \\times 10^8\\,\\text{m/s}} = 20\\pi\\,\\text{m}^{-1} $$\n接下来，我们计算外接球的半径 $a$：\n$$ a = \\frac{\\sqrt{3}}{2}b = \\frac{\\sqrt{3}}{2} (1.0 \\times 10^{-1}\\,\\text{m}) = \\frac{\\sqrt{3}}{20}\\,\\text{m} $$\n无量纲参数 $ka$ 是：\n$$ ka = (20\\pi) \\left(\\frac{\\sqrt{3}}{20}\\right) = \\pi\\sqrt{3} \\approx 5.4414 $$\n误差容差的自然对数是：\n$$ \\ln(\\epsilon) = \\ln(1.0 \\times 10^{-4}) = -4\\ln(10) \\approx -9.2103 $$\n现在我们找到满足 $p > 5.4414$ 和不等式 $p \\left( 1 + \\ln\\left(\\frac{ka}{2p}\\right) \\right) \\le -9.2103$ 的最小整数 $p$。我们从 $6$ 开始测试 $p$ 的整数值：\n- 对于 $p=14$（大于 $5.4414$）：\n  $14 \\left( 1 + \\ln\\left(\\frac{\\pi\\sqrt{3}}{2 \\times 14}\\right) \\right) = 14 \\left( 1 + \\ln(0.1943) \\right) \\approx 14(1 - 1.6382) = -8.9348$。\n  由于 $-8.9348 > -9.2103$，该不等式不成立，所以 $p=14$ 不足够。\n- 对于 $p=15$：\n  $15 \\left( 1 + \\ln\\left(\\frac{\\pi\\sqrt{3}}{2 \\times 15}\\right) \\right) = 15 \\left( 1 + \\ln(0.1814) \\right) \\approx 15(1 - 1.7072) = -10.608$。\n  由于 $-10.608 \\le -9.2103$，该不等式成立，所以 $p=15$ 足够。\n\n满足条件的最小整数是 $p=15$。\n\n最后，我们使用步骤 2 中推导的公式计算采样方向数 $Q$：\n$$ Q = (p+1)(2p+1) = (15+1)(2 \\times 15 + 1) = (16)(31) = 496 $$\n最小平面波方向数为 $496$。",
            "answer": "$$\\boxed{496}$$"
        },
        {
            "introduction": "像 MLFMA 这样的复杂算法在实际应用中经常会遇到偏离理想理论的实际问题。本练习模拟了一个常见的几何划分不完美的问题，其中源的泄漏和中心偏移会危及算法的准确性。通过分析和评估不同的纠正策略，您将应用基本原理来诊断问题并确定理论上合理的解决方案，从而培养处理实际实现挑战所需的批判性思维。",
            "id": "3332605",
            "problem": "考虑用于三维标量亥姆霍兹方程的多层快速多极子算法 (MLFMA)，其自由空间格林函数为 $g(\\mathbf{r}) = \\dfrac{e^{ik\\|\\mathbf{r}\\|}}{\\|\\mathbf{r}\\|}$，其中 $k$ 是波数，$\\mathbf{r} \\in \\mathbb{R}^{3}$。在层级结构的某个给定层级，空间盒子内的源被聚合，并通过关于盒子中心 $\\mathbf{c}$ 的多极子展开来表示，该盒子关联一个半径为 $a$ 的包围球，该球应包含该盒子内所有的源几何。对于良态分离的盒子，多极子到局部转换依赖于球面波加法定理，该定理在观测点到盒子中心 $\\mathbf{c}$ 的距离 $r$ 满足 $r > r'$ 时收敛，其中 $r'$ 是由多极子展开表示的任意源点到 $\\mathbf{c}$ 的最大距离。\n\n假设由于不完美的划分：\n- 盒子中心因偏移向量 $\\boldsymbol{\\delta}$ 而发生偏移，因此相对于 $\\mathbf{c}$ 的最大源半径增加了 $\\|\\boldsymbol{\\delta}\\|$。\n- 一些几何体泄漏到标称包围球之外，量为 $\\epsilon$，因此有效源半径变为 $a_{\\text{eff}} = a + \\|\\boldsymbol{\\delta}\\| + \\epsilon$。\n\n假设观测盒子有一个半径为 $b$ 的包围球，且中心间距为 $R$。为使基于加法定理的转换一致收敛，并使 $p$ 阶截断保持准确，一个充分条件是 $R > a_{\\text{eff}} + b$，并且截断误差大致按比例 $\\rho = \\dfrac{a_{\\text{eff}}}{R - b}$ 的几何因子衰减，即当 $\\rho \\ll 1$ 时，误差表现为 $\\mathcal{O}(\\rho^{p})$。\n\n考虑以下具体设计和扰动：\n- 初始时，$R - b = 2a$，具有完美的中心定位且无泄漏，因此 $a_{\\text{eff}} = a$ 且 $\\rho_{0} = \\dfrac{a}{R - b} = \\dfrac{1}{2}$。\n- 选择的截断阶数 $p$ 使得相对误差至多为 $\\eta = 10^{-6}$。\n- 经过中心偏移和泄漏后，$\\|\\boldsymbol{\\delta}\\| = 0.2a$ 且 $\\epsilon = 0.1a$，因此 $a_{\\text{eff}} = 1.3a$ 且 $\\rho_{1} = \\dfrac{a_{\\text{eff}}}{R - b} = \\dfrac{1.3a}{2a} = 0.65$。\n\n基于基本原理（加法定理的收敛条件 $r > r'$ 和截断误差随 $\\rho$ 的几何衰减），评估以下纠正策略的准确性和理论合理性，并选择所有正确的选项：\n\nA. 将每个盒子重新定中心于其真实的几何质心，以将 $\\|\\boldsymbol{\\delta}\\|$ 减小到 $0$，仅扩大包围球以覆盖泄漏的几何体，使得 $a_{\\text{eff}}$ 变为 $a + \\epsilon$，更新交互列表以强制执行 $R > a_{\\text{eff}} + b$，并在需要时，使用新的比率 $\\rho' = \\dfrac{a + \\epsilon}{R - b}$ 从目标 $\\eta$ 重新计算截断阶数 $p$。\n\nB. 保持中心偏移和泄漏不变，仅将截断阶数从 $p$ 增加到 $p'$，使得 $(\\rho_{1})^{p'} \\le \\eta$ 在受影响的层级上全局成立。\n\nC. 保持 $p$、$a$ 和 $\\mathbf{c}$ 不变，并放宽良态分离准则，使得 $R \\le a_{\\text{eff}} + b$ 的交互仍由多极子到局部转换处理，并依赖平面波表示来补偿分离不足。\n\nD. 将有问题的盒子在该层级上细分为更小的子盒子，使得每个子盒子都有更小的半径 $a_{\\text{child}}$ 且无泄漏，选择新的中心 $\\mathbf{c}_{\\text{child}}$ 以消除中心偏移，并为交互重新验证 $R > a_{\\text{eff,child}} + b$；如果 $\\rho_{\\text{child}} = \\dfrac{a_{\\text{eff,child}}}{R - b}$ 保持在原始设计比率以下，则保留原始截断阶数 $p$。\n\nE. 通过丢弃半径 $a$ 以外几何体的贡献，将包围球缩小回 $a$，并保留原始的 $p$ 和交互列表，依赖近场校正来补偿被忽略的源。\n\n选择所有正确的选项。",
            "solution": "问题陈述描述了多层快速多极子算法 (MLFMA) 中的一个场景，其中不完美的空间划分导致了远场计算精度的下降。我们必须基于该算法的基本原理来评估几种提出的纠正策略。\n\n### 步骤 1：提取已知条件\n- **算法**：用于三维标量亥姆霍兹方程的多层快速多极子算法 (MLFMA)。\n- **格林函数**：$g(\\mathbf{r}) = \\dfrac{e^{ik\\|\\mathbf{r}\\|}}{\\|\\mathbf{r}\\|}$。\n- **核心原理1（收敛性）**：用于多极子到局部 (M2L) 转换的球面波加法定理，对于距离源盒子中心 $\\mathbf{c}$ 为 $r$ 的观测点，如果 $r > r'$，则收敛，其中 $r'$ 是任意源到 $\\mathbf{c}$ 的最大距离。对于整个观测盒子，一致收敛和准确性的一个充分条件被表述为 $R > a_{\\text{eff}} + b$，其中 $R$ 是中心间距，$a_{\\text{eff}}$ 是源盒子包围球的有效半径，$b$ 是观测盒子包围球的半径。\n- **核心原理2（截断误差）**：对于一个 $p$ 阶展开，截断误差表现为 $\\mathcal{O}(\\rho^{p})$，其中 $\\rho = \\dfrac{a_{\\text{eff}}}{R - b}$。准确性要求 $\\rho \\ll 1$。\n- **初始（理想）状态**：\n  - 中心到观测盒子表面的距离：$R - b = 2a$。\n  - 无中心偏移或泄漏：$\\|\\boldsymbol{\\delta}\\| = 0$，$\\epsilon = 0$。\n  - 有效源半径：$a_{\\text{eff}} = a$。\n  - 几何比率：$\\rho_{0} = \\dfrac{a}{R - b} = \\dfrac{a}{2a} = \\dfrac{1}{2}$。\n  - 目标相对误差：$\\eta = 10^{-6}$，通过截断阶数 $p$ 实现。这意味着 $(\\rho_{0})^p = (0.5)^p \\le 10^{-6}$。\n- **扰动后状态**：\n  - 中心偏移：$\\|\\boldsymbol{\\delta}\\| = 0.2a$。\n  - 泄漏：$\\epsilon = 0.1a$。\n  - 新的有效源半径：$a_{\\text{eff}} = a + \\|\\boldsymbol{\\delta}\\| + \\epsilon = a + 0.2a + 0.1a = 1.3a$。\n  - 新的几何比率：$\\rho_{1} = \\dfrac{a_{\\text{eff}}}{R - b} = \\dfrac{1.3a}{2a} = 0.65$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述在计算电磁学原理和快速多极子方法理论方面有充分的依据。包围球、良态分离性、加法定理的收敛要求以及截断误差模型的定义都是该领域的标准。所提供的不完美划分场景是 MLFMA 实现中的一个实际且现实的挑战。数值是一致的，问题逻辑结构清晰。因此，该问题是有效的。\n\n### 步骤 3：推导与逐项分析\n\n问题的核心是几何比率从 $\\rho_{0} = 0.5$ 增加到了 $\\rho_{1} = 0.65$。由于截断误差表现为 $\\mathcal{O}(\\rho^p)$，且 $p$ 的选择使得 $(0.5)^p \\le 10^{-6}$，使用相同的 $p$ 时，新的误差将与 $(0.65)^p$ 成正比，这显著大于 $(0.5)^p$，并很可能超过目标误差 $\\eta$。\n\n此外，我们必须检查 M2L 转换的基本有效性条件：$R - b > a_{\\text{eff}}$。在扰动状态下，我们有 $R - b = 2a$ 和 $a_{\\text{eff}} = 1.3a$。条件 $2a > 1.3a$ 是满足的。这意味着 M2L 转换级数仍然收敛，但其收敛速度变慢，导致对于固定的截断阶数 $p$，精度降低。\n\n现在我们评估每个纠正策略。\n\n**A. 将每个盒子重新定中心于其真实的几何质心，以将 $\\|\\boldsymbol{\\delta}\\|$ 减小到 $0$，仅扩大包围球以覆盖泄漏的几何体，使得 $a_{\\text{eff}}$ 变为 $a + \\epsilon$，更新交互列表以强制执行 $R > a_{\\text{eff}} + b$，并在需要时，使用新的比率 $\\rho' = \\dfrac{a + \\epsilon}{R - b}$ 从目标 $\\eta$ 重新计算截断阶数 $p$。**\n\n该策略包含几个合理的行动：\n1.  **重新定中心**：将展开中心 $\\mathbf{c}$ 设置为源的几何质心是最佳的，因为它最小化了所需包围球的半径。这正确地从有效半径计算中消除了 $\\|\\boldsymbol{\\delta}\\|$ 项。\n2.  **扩大包围球**：多极子展开的包围球*必须*包含它所代表的所有源。扩大包围球以考虑泄漏 $\\epsilon$ 对于展开的理论有效性是必要的。新的有效半径变为 $a_{\\text{eff}}' = a + \\epsilon = a + 0.1a = 1.1a$。\n3.  **更新交互列表**：良态分离准则 $R > a_{\\text{eff}} + b$ 是基础。由于 $a_{\\text{eff}}$ 已变为 $1.1a$，交互列表必须基于这个更严格的条件重建。任何不再满足此条件的盒子对必须从远场列表移至近场列表进行直接计算。\n4.  **重新计算截断阶数**：对于剩余的远场交互（假设对某些盒子 $R-b=2a$），新的比率是 $\\rho' = \\dfrac{1.1a}{2a} = 0.55$。由于 $\\rho' > \\rho_0$，原始的截断阶数 $p$ 可能不足以满足误差容限 $\\eta$。基于新比率 $\\rho'$ 和目标 $\\eta$ 重新计算 $p$ 是恢复准确性的正确方法。\n\n此选项以理论上严谨的方式系统地解决了初始划分缺陷的所有后果。这是一个完整且正确的程序。\n\n结论：**正确**。\n\n**B. 保持中心偏移和泄漏不变，仅将截断阶数从 $p$ 增加到 $p'$，使得 $(\\rho_{1})^{p'} \\le \\eta$ 在受影响的层级上全局成立。**\n\n该策略接受新的几何配置及其对应的比率 $\\rho_1 = 0.65$。如前所述，收敛条件 $R - b > a_{\\text{eff}}$（即 $2a > 1.3a$）仍然成立。问题在于精度损失，而非收敛性失效。截断误差是 $p$ 和 $\\rho$ 的直接函数。通过将截断阶数从 $p$ 增加到一个新值 $p'$，使得 $(\\rho_1)^{p'} = (0.65)^{p'} \\le 10^{-6}$，可以恢复所需的精度。这是一个有效的权衡：不修改数据结构（盒子中心、半径、交互列表），而是增加转换步骤的计算成本，该成本通常按 $p$ 的多项式（例如 $\\mathcal{O}(p^2)$ 或更高）进行缩放。虽然可能效率低下，但该方法在理论上是合理的。\n\n结论：**正确**。\n\n**C. 保持 $p$、$a$ 和 $\\mathbf{c}$ 不变，并放宽良态分离准则，使得 $R \\le a_{\\text{eff}} + b$ 的交互仍由多极子到局部转换处理，并依赖平面波表示来补偿分离不足。**\n\n这个策略有根本性的缺陷。条件 $R > a_{\\text{eff}} + b$（或更精确地说，$R-b > a_{\\text{eff}}$）确保了基于加法定理的球面波展开对所有观测点都收敛。如果这个条件被违反（即 $R-b \\le a_{\\text{eff}}$），展开级数会发散，导致不可控的灾难性错误，而不仅仅是精度降低。“平面波表示”是一种高效计算转换算子的技术，通常使用FFT。它不改变底层球面波加法定理的基本数学性质。对非良态分离的盒子使用 M2L 转换违反了算法的核心原则。\n\n结论：**不正确**。\n\n**D. 将有问题的盒子在该层级上细分为更小的子盒子，使得每个子盒子都有更小的半径 $a_{\\text{child}}$ 且无泄漏，选择新的中心 $\\mathbf{c}_{\\text{child}}$ 以消除中心偏移，并为交互重新验证 $R > a_{\\text{eff,child}} + b$；如果 $\\rho_{\\text{child}} = \\dfrac{a_{\\text{eff,child}}}{R - b}$ 保持在原始设计比率以下，则保留原始截断阶数 $p$。**\n\n该策略利用了 MLFMA 的层级特性。它不是修复有问题的大盒子，而是用几个更小的子盒子替换它。这是一种自适应网格细化的形式。\n1.  **细分**：通过将源划分到更小的盒子中，可以创建新的、中心定位良好（$\\|\\boldsymbol{\\delta}_{\\text{child}}\\| = 0$）且包含其各自所有几何体（$\\epsilon_{\\text{child}} = 0$）的包围球。这为每个子盒子提供了一个有效半径 $a_{\\text{eff,child}} = a_{\\text{child}}$，其中 $a_{\\text{child}}$ 通常远小于原始的 $a$。\n2.  **重新验证**：必须为每个新的子盒子重新评估交互。一些对于父盒子来说是远场的交互，对于某个特定的子盒子可能变成近场，这需要更改交互列表。这是一个必要的步骤。\n3.  **准确性检查**：对于仍处于远场的交互，新的几何比率是 $\\rho_{\\text{child}} = \\dfrac{a_{\\text{child}}}{R_{\\text{child}} - b}$。由于 $a_{\\text{child}}$ 更小，而 $R_{\\text{child}}-b$ 通常与原始的 $R-b$ 相当，因此很可能 $\\rho_{\\text{child}} \\le \\rho_0 = 0.5$。如果满足此条件，原始的截断阶数 $p$ 足以保证目标精度。这是一种处理几何不规则性的稳健且理论上合理的方法。\n\n结论：**正确**。\n\n**E. 通过丢弃半径 $a$ 以外几何体的贡献，将包围球缩小回 $a$，并保留原始的 $p$ 和交互列表，依赖近场校正来补偿被忽略的源。**\n\n该策略引入了一个基本的建模错误。一个盒子的多极子展开是该盒子划分内*所有*源的代理。通过丢弃半径 $a$ 以外源的贡献，该展开成为对物理现实的不正确表示。这种省略直接违反了亥姆霍兹方程的高斯定律等价形式。“近场校正”指的是对近场列表中的盒子之间交互的直接计算。根据定义，位于盒子 A 远场的盒子 B 不在 A 的近场列表中。因此，没有机制可以将在与 B 的交互中考虑从 A 的多极子展开中省略的源的贡献。该策略导致源信息的丢失和最终解中不可控的误差。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}