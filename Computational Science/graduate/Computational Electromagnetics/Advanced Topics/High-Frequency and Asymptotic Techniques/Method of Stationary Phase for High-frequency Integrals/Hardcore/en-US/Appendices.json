{
    "hands_on_practices": [
        {
            "introduction": "The following exercise provides a foundational application of the method of stationary phase to a classic problem in high-frequency electromagnetics. You will derive the leading-order contribution to the far-field radiation pattern from a smooth conducting surface. This practice is crucial for understanding how the local geometry of a scatterer, specifically its principal curvatures, directly influences the observable far-field signature, a cornerstone of physical optics and radar cross-section analysis .",
            "id": "3330744",
            "problem": "A smooth convex conducting surface is locally described in Cartesian coordinates by the graph of a function $z=f(x,y)$ with principal radii of curvature $R_x0$ and $R_y0$ at the origin, where the unit normal at the origin points along $\\hat{\\mathbf{z}}$. In a high-frequency radiation problem, the far-field directional pattern in the observation direction $\\hat{\\mathbf{r}}$ is represented (up to an overall observation-distance factor that you may ignore) by the oscillatory integral\n$$\nE(\\hat{\\mathbf{r}})=\\int_{S} J(\\mathbf{r}') \\exp\\!\\big(i k \\,\\hat{\\mathbf{r}}\\cdot \\mathbf{r}'\\big)\\, dS',\n$$\nwhere $k0$ is the free-space wavenumber, $S$ is the radiating surface, $\\mathbf{r}'=(x,y,z)$, and $J(\\mathbf{r}')$ is a slowly varying equivalent surface current density. Assume that in a neighborhood of the origin the surface has the quadratic approximation\n$$\nz=f(x,y)=\\frac{x^{2}}{2 R_x}+\\frac{y^{2}}{2 R_y},\n$$\nthat the current is constant in that neighborhood, $J(\\mathbf{r}')=J_0$ with $J_0$ a complex constant, and that the observation direction is the surface normal at the origin, $\\hat{\\mathbf{r}}=\\hat{\\mathbf{z}}$. Further assume the surface extends sufficiently so that the leading contribution for large $k$ arises from the stationary-phase point at the origin and that higher-order terms and edge contributions are negligible.\n\nUsing only first principles of the method of stationary phase, starting from a Taylor expansion of the phase and evaluating the resulting canonical oscillatory integrals, derive the leading-order asymptotic expression of $E(\\hat{\\mathbf{z}})$ as $k\\to\\infty$. Express your final answer as a single closed-form analytic expression in terms of $J_0$, $k$, $R_x$, and $R_y$. Do not include units. Do not round; an exact expression is required.",
            "solution": "The problem is evaluated as scientifically grounded, well-posed, and objective. It is a standard application of the method of stationary phase in the context of high-frequency physical optics, a foundational topic in computational electromagnetics. All necessary information is provided, and the assumptions are consistent and physically meaningful for an asymptotic analysis. The problem is therefore deemed **valid**.\n\nThe objective is to find the leading-order asymptotic expression for the integral\n$$\nE(\\hat{\\mathbf{r}})=\\int_{S} J(\\mathbf{r}') \\exp\\!\\big(i k \\,\\hat{\\mathbf{r}}\\cdot \\mathbf{r}'\\big)\\, dS'\n$$\nas the wavenumber $k \\to \\infty$.\n\nWe are given the following:\n1.  The observation direction is the surface normal at the origin, $\\hat{\\mathbf{r}}=\\hat{\\mathbf{z}}$.\n2.  The surface current density is locally constant, $J(\\mathbf{r}')=J_0$.\n3.  The surface $S$ is locally approximated by the quadratic form $z = f(x,y) = \\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}$.\n\nSubstituting $\\hat{\\mathbf{r}}=\\hat{\\mathbf{z}}$ into the integral, the phase term becomes $k\\,\\hat{\\mathbf{z}}\\cdot\\mathbf{r}'$. For a point $\\mathbf{r}'=(x,y,z)$ on the surface, this dot product is simply $k z$. The integral becomes:\n$$\nE(\\hat{\\mathbf{z}}) = \\int_{S} J_0 \\exp(i k z) \\, dS'\n$$\nTo evaluate this integral over the surface $S$, we parametrize the surface using the coordinates $(x,y)$. A point on the surface is given by the vector $\\mathbf{r}'(x,y) = x\\hat{\\mathbf{x}} + y\\hat{\\mathbf{y}} + f(x,y)\\hat{\\mathbf{z}}$. The differential surface element $dS'$ is given by the magnitude of the cross product of the tangent vectors:\n$$\ndS' = |\\frac{\\partial\\mathbf{r}'}{\\partial x} \\times \\frac{\\partial\\mathbf{r}'}{\\partial y}| \\, dx \\, dy\n$$\nThe tangent vectors are:\n$$\n\\frac{\\partial\\mathbf{r}'}{\\partial x} = \\hat{\\mathbf{x}} + \\frac{\\partial f}{\\partial x} \\hat{\\mathbf{z}} = \\hat{\\mathbf{x}} + \\frac{x}{R_x} \\hat{\\mathbf{z}}\n$$\n$$\n\\frac{\\partial\\mathbf{r}'}{\\partial y} = \\hat{\\mathbf{y}} + \\frac{\\partial f}{\\partial y} \\hat{\\mathbf{z}} = \\hat{\\mathbf{y}} + \\frac{y}{R_y} \\hat{\\mathbf{z}}\n$$\nTheir cross product is:\n$$\n\\frac{\\partial\\mathbf{r}'}{\\partial x} \\times \\frac{\\partial\\mathbf{r}'}{\\partial y} = (\\hat{\\mathbf{x}} + \\frac{x}{R_x} \\hat{\\mathbf{z}}) \\times (\\hat{\\mathbf{y}} + \\frac{y}{R_y} \\hat{\\mathbf{z}}) = -\\frac{x}{R_x}\\hat{\\mathbf{x}} - \\frac{y}{R_y}\\hat{\\mathbf{y}} + \\hat{\\mathbf{z}}\n$$\nThe magnitude of this vector gives the Jacobian for the surface element:\n$$\ndS' = \\sqrt{\\left(-\\frac{x}{R_x}\\right)^2 + \\left(-\\frac{y}{R_y}\\right)^2 + 1^2} \\, dx \\, dy = \\sqrt{1 + \\frac{x^2}{R_x^2} + \\frac{y^2}{R_y^2}} \\, dx \\, dy\n$$\nSubstituting these expressions into the integral for $E(\\hat{\\mathbf{z}})$, we get a two-dimensional integral over the $(x,y)$ plane:\n$$\nE(\\hat{\\mathbf{z}}) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} J_0 \\sqrt{1 + \\frac{x^2}{R_x^2} + \\frac{y^2}{R_y^2}} \\exp\\left(i k \\left(\\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}\\right)\\right) \\, dx \\, dy\n$$\nThe integration limits are extended to $\\pm\\infty$ because the problem assumes that the leading contribution for large $k$ comes from the stationary phase point at the origin, and contributions from regions far from the origin are rendered negligible by rapid phase oscillations.\n\nThis integral is in the canonical form for the method of stationary phase, $I = \\int \\int g(x,y) \\exp(ik\\phi(x,y)) \\, dx \\, dy$, where:\n- The amplitude function is $g(x,y) = J_0 \\sqrt{1 + \\frac{x^2}{R_x^2} + \\frac{y^2}{R_y^2}}$.\n- The phase function is $\\phi(x,y) = \\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}$.\n\nThe method of stationary phase states that for large $k$, the main contribution to the integral comes from the neighborhood of the stationary points, where the gradient of the phase is zero, i.e., $\\nabla \\phi(x,y) = 0$.\n$$\n\\frac{\\partial\\phi}{\\partial x} = \\frac{x}{R_x} = 0 \\implies x=0\n$$\n$$\n\\frac{\\partial\\phi}{\\partial y} = \\frac{y}{R_y} = 0 \\implies y=0\n$$\nThe unique stationary point is at $(x_0, y_0) = (0,0)$.\n\nThe leading-order asymptotic approximation is obtained by replacing the slowly varying amplitude function $g(x,y)$ by its value at the stationary point, $g(0,0)$, and evaluating the remaining oscillatory integral.\n$$\ng(0,0) = J_0 \\sqrt{1 + 0 + 0} = J_0\n$$\nThe integral becomes:\n$$\nE(\\hat{\\mathbf{z}}) \\sim g(0,0) \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(ik\\phi(x,y)) \\, dx \\, dy\n$$\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(i k \\left(\\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}\\right)\\right) \\, dx \\, dy\n$$\nThis integral is separable into a product of two one-dimensional integrals:\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_x} x^2\\right) dx \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_y} y^2\\right) dy \\right)\n$$\nThese are canonical oscillatory integrals of the Fresnel type. The general formula for such an integral is:\n$$\n\\int_{-\\infty}^{\\infty} \\exp(i \\alpha u^2) \\, du = \\sqrt{\\frac{\\pi}{|\\alpha|}} \\exp\\left(i \\frac{\\pi}{4} \\text{sgn}(\\alpha)\\right)\n$$\nFor the integral with respect to $x$, the coefficient is $\\alpha_x = \\frac{k}{2R_x}$. Since $k0$ and $R_x0$, we have $\\alpha_x  0$ and $\\text{sgn}(\\alpha_x)=1$. The integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_x} x^2\\right) dx = \\sqrt{\\frac{\\pi}{k/(2R_x)}} \\exp\\left(i \\frac{\\pi}{4}\\right) = \\sqrt{\\frac{2\\pi R_x}{k}} e^{i\\pi/4}\n$$\nSimilarly, for the integral with respect to $y$, the coefficient is $\\alpha_y = \\frac{k}{2R_y}$. Since $k0$ and $R_y0$, we have $\\alpha_y  0$ and $\\text{sgn}(\\alpha_y)=1$. The integral is:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_y} y^2\\right) dy = \\sqrt{\\frac{\\pi}{k/(2R_y)}} \\exp\\left(i \\frac{\\pi}{4}\\right) = \\sqrt{\\frac{2\\pi R_y}{k}} e^{i\\pi/4}\n$$\nCombining these results, the asymptotic expression for $E(\\hat{\\mathbf{z}})$ is:\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\left( \\sqrt{\\frac{2\\pi R_x}{k}} e^{i\\pi/4} \\right) \\left( \\sqrt{\\frac{2\\pi R_y}{k}} e^{i\\pi/4} \\right)\n$$\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\sqrt{\\frac{4\\pi^2 R_x R_y}{k^2}} \\exp\\left(i\\frac{\\pi}{4} + i\\frac{\\pi}{4}\\right)\n$$\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\frac{2\\pi\\sqrt{R_x R_y}}{k} \\exp\\left(i\\frac{\\pi}{2}\\right)\n$$\nUsing Euler's formula, $\\exp(i\\pi/2) = \\cos(\\pi/2) + i\\sin(\\pi/2) = i$. Therefore, the final expression is:\n$$\nE(\\hat{\\mathbf{z}}) \\sim \\frac{2\\pi i J_0 \\sqrt{R_x R_y}}{k}\n$$\nThis is the leading-order asymptotic expression for the far-field pattern in the normal direction as $k \\to \\infty$.",
            "answer": "$$\\boxed{\\frac{2 \\pi i J_0 \\sqrt{R_x R_y}}{k}}$$"
        },
        {
            "introduction": "Building upon the forward problem, this next practice explores the inverse challenge: can we deduce an object's physical properties from its measured scattering response? By inverting the relationship between far-field amplitude and surface curvature derived via stationary phase, you will construct an algorithm to estimate the local Gaussian curvature from mock high-frequency data. This exercise demonstrates the practical power of asymptotic methods in solving inverse problems, a critical skill in areas like remote sensing and non-destructive evaluation .",
            "id": "3330706",
            "problem": "A scalable inversion problem using the method of stationary phase is posed in a purely mathematical form, grounded in computational electromagnetics. Consider a smooth, perfectly conducting surface locally parameterized near a specular point by a height function $z(x,y)$ over the tangent plane. The incident field is a plane wave with direction vector $\\mathbf{s}_{\\mathrm{i}}$ and the scattered observation is in direction $\\mathbf{s}_{\\mathrm{o}}$, both of unit length, such that the origin $(x,y)=(0,0)$ is a specular point where the surface normal aligns with the bisector of $\\mathbf{s}_{\\mathrm{i}}$ and $\\mathbf{s}_{\\mathrm{o}}$. In the Physical Optics (PO) approximation (Physical Optics (PO) is an asymptotic method for high-frequency scattering), the far-field scattered amplitude in a fixed direction can be written as a two-dimensional oscillatory surface integral over local coordinates $(x,y)$ with a rapidly varying phase and a slowly varying amplitude. Under the high-frequency assumption, the leading-order contribution is governed by the method of stationary phase applied to the integral. The phase Hessian at the specular point is linked to the surface’s second fundamental form, and its determinant depends on the product of the principal curvatures. Your task is to construct a stationary phase-based inversion to recover the local Gaussian curvature (the product of principal curvatures) at the specular point from measured high-frequency amplitudes.\n\nAssume the local surface near the specular point can be modeled as $z(x,y)=\\dfrac{x^2}{2 R_1}+\\dfrac{y^2}{2 R_2}$, where $R_1$ and $R_2$ are the principal radii of curvature at $(0,0)$, and the principal curvatures are $\\kappa_1=\\dfrac{1}{R_1}$ and $\\kappa_2=\\dfrac{1}{R_2}$. For normal incidence and backscatter observation, take $\\mathbf{s}_{\\mathrm{i}}=(0,0,-1)$ and $\\mathbf{s}_{\\mathrm{o}}=(0,0,1)$, and suppose the measured scattered amplitude magnitude at wavenumber $k$ is $A(k)$, obtained experimentally for several values of $k$.\n\nStarting from the oscillatory integral representation and the general stationary phase principle, derive an inversion that expresses the local Gaussian curvature $K=\\kappa_1 \\kappa_2$ at the specular point in terms of the wavenumber-scaling of $A(k)$. Then implement it algorithmically to estimate $K$ from discrete measurements $\\{(k_j,A(k_j))\\}_{j=1}^m$. All angles are to be treated in radians. Express the final curvature values in $\\mathrm{m}^{-2}$, rounded to six decimal places.\n\nUse the following test suite of measured amplitudes at the specular point. In all cases, the wavenumbers are $k$ values $[100,200,400]$ in $\\mathrm{rad/m}$:\n\n- Case $1$ (general happy path): measured amplitudes $A(k)$ are $[0.02221441469079183,\\,0.011107207345395916,\\,0.005553603672697958]$.\n- Case $2$ (distinct curvature): measured amplitudes $A(k)$ are $[0.031415926535897934,\\,0.015707963267948967,\\,0.007853981633974483]$.\n- Case $3$ (higher curvature): measured amplitudes $A(k)$ are $[0.011107207345395915,\\,0.005553603672697957,\\,0.0027768018363489783]$.\n- Case $4$ (near-flat edge case): measured amplitudes $A(k)$ are $[31.41592653589793,\\,15.707963267948964,\\,7.853981633974482]$.\n\nYour program should produce a single line of output containing the estimated Gaussian curvatures for the four cases in a comma-separated list enclosed in square brackets, with each value rounded to six decimal places in $\\mathrm{m}^{-2}$ (e.g., $[K_1,K_2,K_3,K_4]$).",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Surface Model**: A smooth, perfectly conducting surface locally parameterized by $z(x,y)=\\dfrac{x^2}{2 R_1}+\\dfrac{y^2}{2 R_2}$.\n- **Principal Curvatures**: $\\kappa_1=\\dfrac{1}{R_1}$ and $\\kappa_2=\\dfrac{1}{R_2}$.\n- **Gaussian Curvature**: $K=\\kappa_1 \\kappa_2$.\n- **Specular Point**: The origin $(x,y)=(0,0)$.\n- **Incidence/Observation Geometry**: Normal incidence and backscatter.\n- **Incident Direction**: $\\mathbf{s}_{\\mathrm{i}}=(0,0,-1)$.\n- **Scattered Direction**: $\\mathbf{s}_{\\mathrm{o}}=(0,0,1)$.\n- **Measured Quantity**: Scattered amplitude magnitude $A(k)$ at wavenumber $k$.\n- **Approximation Methods**: Physical Optics (PO) and the method of stationary phase for high-frequency integrals.\n- **Task**: Derive an inversion formula for $K$ from the scaling of $A(k)$ with $k$ and implement it algorithmically.\n- **Test Data**:\n  - Wavenumbers for all cases: $k \\in [100, 200, 400]$ in $\\mathrm{rad/m}$.\n  - Case $1$: Amplitudes $A(k) = [0.02221441469079183, 0.011107207345395916, 0.005553603672697958]$.\n  - Case $2$: Amplitudes $A(k) = [0.031415926535897934, 0.015707963267948967, 0.007853981633974483]$.\n  - Case $3$: Amplitudes $A(k) = [0.011107207345395915, 0.005553603672697957, 0.0027768018363489783]$.\n  - Case $4$: Amplitudes $A(k) = [31.41592653589793, 15.707963267948964, 7.853981633974482]$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is anchored in established principles of high-frequency computational electromagnetics. The Physical Optics approximation and the method of stationary phase are standard, well-documented techniques for analyzing scattering from electrically large objects. The relationship between the second-order phase term and the surface curvature is a cornerstone of this analysis.\n- **Well-Posedness**: The problem is well-posed. It requests the derivation of a specific physical relationship and its inversion. Sufficient data is provided to uniquely determine the unknown parameter (Gaussian curvature $K$) within the specified model.\n- **Objectivity**: The problem is stated in precise, objective mathematical and physical terms. It is free from ambiguity, subjectivity, or non-scientific claims.\n- **Consistency and Completeness**: The problem is self-contained. The provided surface model, scattering geometry, and measured data are sufficient and consistent for deriving and applying the inversion. The data itself is constructed to be consistent with the underlying physical model, enabling the determination of an otherwise ambiguous proportionality constant.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically sound, well-posed, objective, and internally consistent. A solution will be derived and implemented.\n\n### Principle-Based Solution\nThe solution requires deriving an explicit relationship between the measured scattered amplitude $A(k)$ and the Gaussian curvature $K$ using the method of stationary phase.\n\nIn the Physical Optics (PO) approximation, the scalar scattered amplitude is given by an integral over the illuminated surface $S$. For a general surface element $\\mathbf{r}'(x,y) = (x, y, z(x,y))$, the integral takes the form:\n$$ I(k) = \\iint_S F(x,y) e^{i k (\\mathbf{s}_{\\mathrm{i}} - \\mathbf{s}_{\\mathrm{o}}) \\cdot \\mathbf{r}'(x,y)} dS $$\nwhere $F(x,y)$ is a slowly varying amplitude function that includes polarization and material properties, and $k$ is the wavenumber. The surface element $dS$ can be approximated by $dx dy$ near the specular point where the surface is tangent to the $xy$-plane.\n\nFor the specified geometry of normal incidence and backscatter, we have $\\mathbf{s}_{\\mathrm{i}} = (0,0,-1)$ and $\\mathbf{s}_{\\mathrm{o}} = (0,0,1)$. The vector difference is $\\mathbf{q} = \\mathbf{s}_{\\mathrm{i}} - \\mathbf{s}_{\\mathrm{o}} = (0,0,-2)$. The phase term in the exponent is:\n$$ \\Phi(x,y) = k \\mathbf{q} \\cdot \\mathbf{r}'(x,y) = k (0,0,-2) \\cdot (x, y, z(x,y)) = -2k z(x,y) $$\nThe integral becomes:\n$$ I(k) = \\iint F(x,y) e^{-i 2k z(x,y)} dx dy $$\nThis is a highly oscillatory integral for large $k$. According to the method of stationary phase, the dominant contribution comes from the point(s) where the gradient of the phase is zero. Let the phase function be written as $\\lambda f(x,y)$, where $\\lambda=k$ and $f(x,y)=-2z(x,y)$. The stationary point $(x_0, y_0)$ is found by solving $\\nabla f(x,y) = -2\\nabla z(x,y) = 0$. Given $z(x,y) = \\frac{x^2}{2R_1} + \\frac{y^2}{2R_2}$, the gradient components are $\\frac{\\partial z}{\\partial x} = \\frac{x}{R_1}$ and $\\frac{\\partial z}{\\partial y} = \\frac{y}{R_2}$. These are zero only at $(x,y)=(0,0)$, confirming the origin is the unique stationary point.\n\nThe leading-order asymptotic approximation of a two-dimensional integral $I(\\lambda) = \\iint g(x,y) e^{i\\lambda f(x,y)} dx dy$ at a non-degenerate stationary point $(x_0, y_0)$ is given by:\n$$ I(\\lambda) \\approx g(x_0, y_0) e^{i\\lambda f(x_0, y_0)} \\frac{2\\pi}{\\lambda \\sqrt{|\\det(H_f(x_0, y_0))|}} e^{i\\frac{\\pi}{4}\\text{sgn}(H_f)} $$\nwhere $H_f$ is the Hessian matrix of $f(x,y)$ and $\\text{sgn}(H_f)$ is its signature (number of positive eigenvalues minus number of negative eigenvalues).\n\nIn our case, $\\lambda=k$, $g(x,y)=F(x,y)$, and $f(x,y) = -2z(x,y) = -\\frac{x^2}{R_1} - \\frac{y^2}{R_2}$. At the stationary point $(0,0)$, $f(0,0)=0$.\nThe Hessian of $f(x,y)$ is:\n$$ H_f = \\begin{pmatrix} \\frac{\\partial^2 f}{\\partial x^2}  \\frac{\\partial^2 f}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 f}{\\partial y \\partial x}  \\frac{\\partial^2 f}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} -2/R_1  0 \\\\ 0  -2/R_2 \\end{pmatrix} $$\nThe determinant of the Hessian is:\n$$ \\det(H_f) = \\left(-\\frac{2}{R_1}\\right) \\left(-\\frac{2}{R_2}\\right) = \\frac{4}{R_1 R_2} = 4 \\kappa_1 \\kappa_2 = 4K $$\nAssuming the surface is convex (positive radii of curvature), the eigenvalues of $H_f$ are $-2/R_1$ and $-2/R_2$, which are both negative. The signature is $\\text{sgn}(H_f) = 0 - 2 = -2$. The phase factor becomes $e^{i\\frac{\\pi}{4}(-2)} = e^{-i\\pi/2} = -i$.\n\nSubstituting these into the asymptotic formula:\n$$ I(k) \\approx F(0,0) e^{ik \\cdot 0} \\frac{2\\pi}{k \\sqrt{|4K|}} (-i) = F(0,0) \\frac{-i \\pi}{k \\sqrt{K}} $$\nThe magnitude of this integral, which the problem defines as the measured amplitude $A(k)$, is:\n$$ A(k) = |I(k)| = \\left| F(0,0) \\frac{-i \\pi}{k \\sqrt{K}} \\right| = \\frac{|F(0,0)| \\pi}{k \\sqrt{K}} $$\nThis derivation reveals that the product $k \\cdot A(k)$ should be a constant for a given surface:\n$$ P = k \\cdot A(k) = \\frac{|F(0,0)| \\pi}{\\sqrt{K}} $$\nThis expression contains the unknown factor $|F(0,0)|$, which relates to the reflection properties at the specular point. We can determine this constant by analyzing the provided test data. For Case $2$, we have $k_1=100$ and $A(k_1) \\approx 0.0314159$. The product is $P_2 = 100 \\times 0.0314159... = 3.14159... = \\pi$.\nThis strongly implies that the problem is constructed such that the slowly varying amplitude term at the specular point is normalized to unity, i.e., $|F(0,0)|=1$. Adopting this, our model simplifies to:\n$$ P = k \\cdot A(k) = \\frac{\\pi}{\\sqrt{K}} $$\nThis provides the basis for the inversion. By calculating the product $P$ from the measured data, we can solve for the Gaussian curvature $K$:\n$$ \\sqrt{K} = \\frac{\\pi}{P} \\implies K = \\left( \\frac{\\pi}{P} \\right)^2 $$\n\nThe algorithm is therefore as follows:\n$1$. For each set of measurements $\\{(k_j, A(k_j))\\}$, compute the constant product $P = k_j A(k_j)$. Since the data is noise-free, any single pair $(k_j, A(k_j))$ is sufficient.\n$2$. Compute the Gaussian curvature using the derived inversion formula $K = (\\pi/P)^2$.\n$3$. Report the value of $K$ in $\\mathrm{m}^{-2}$ rounded to six decimal places.\n\nFor example, for Case $1$:\n$P = 100 \\times 0.02221441469079183 \\approx 2.22144147$.\n$K = (\\pi / 2.22144147)^2 = (3.14159265 / 2.22144147)^2 \\approx (1.41421356)^2 = 2$.\nThe calculations will be performed for all four cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the inversion problem to find Gaussian curvature from high-frequency\n    scattered amplitude data based on the method of stationary phase.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing the list of wavenumbers and the list of amplitudes.\n    # Wavenumbers are common for all cases a priori.\n    wavenumbers = [100.0, 200.0, 400.0]  # in rad/m\n\n    test_cases = [\n        # Case 1\n        [0.02221441469079183, 0.011107207345395916, 0.005553603672697958],\n        # Case 2\n        [0.031415926535897934, 0.015707963267948967, 0.007853981633974483],\n        # Case 3\n        [0.011107207345395915, 0.005553603672697957, 0.0027768018363489783],\n        # Case 4\n        [31.41592653589793, 15.707963267948964, 7.853981633974482],\n    ]\n\n    results = []\n    \n    # The derived relationship is A(k) = pi / (k * sqrt(K)).\n    # This implies k * A(k) = pi / sqrt(K).\n    # Let P = k * A(k). Then K = (pi / P)^2.\n    # The provided data is noise-free, so we can use any (k, A(k)) pair.\n    # We will use the first pair from each case.\n    \n    for amplitudes in test_cases:\n        # Select the first wavenumber and its corresponding amplitude\n        k = wavenumbers[0]\n        A_k = amplitudes[0]\n\n        # Calculate the constant product P = k * A(k)\n        P = k * A_k\n\n        # Use the derived inversion formula to calculate the Gaussian curvature K\n        # K = (pi / P)^2\n        K = (np.pi / P)**2\n        \n        results.append(K)\n\n    # Format the final output as a comma-separated list of rounded values\n    # enclosed in square brackets. Each value is rounded to six decimal places.\n    output_str = f\"[{','.join(f'{val:.6f}' for val in results)}]\"\n    \n    # Print the final result in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "While analytical approximations are powerful, many real-world problems require full numerical solutions, often using techniques like the Method of Moments (MoM). This final practice delves into the numerical challenges posed by high-frequency problems, where the rapid phase oscillations analyzed by the stationary phase method can lead to severe ill-conditioning. You will implement and compare a standard numerical basis with a hybrid asymptotic-numerical basis that preemptively incorporates the known phase behavior, directly demonstrating how asymptotic insights can be used to construct more stable and efficient computational solvers .",
            "id": "3330705",
            "problem": "You are asked to construct and compare Method of Moments (MoM) system matrices for a one-dimensional straight conductor segment using a high-frequency asymptotic kernel and a hybrid numerical-asymptotic basis that embeds local stationary-phase oscillations. The goal is to quantify how embedding known high-frequency oscillations $e^{i k \\hat{\\mathbf{s}}\\cdot \\mathbf{r}}$ in the basis affects the conditioning of the resulting discretized operator as the wavenumber $k$ increases.\n\nFundamental base and operator model: In two-dimensional scattering governed by the scalar Helmholtz equation, the electric field integral equation involves the free-space Green's function $G_k(\\mathbf{r}) = \\dfrac{i}{4} H_0^{(1)}(k r)$, where $H_0^{(1)}$ denotes the Hankel function of the first kind and order zero, and $r$ is the Euclidean distance. For large $k$, a widely accepted high-frequency asymptotic approximation is\n$$\nH_0^{(1)}(k r) \\approx \\sqrt{\\frac{2}{\\pi k r}}\\, e^{i\\left(k r - \\frac{\\pi}{4}\\right)} \\quad \\text{for } k r \\gg 1.\n$$\nRestrict attention to a straight conductor segment parameterized by $\\mathbf{r}(x) = (x, 0)$ for $x \\in [-L/2, L/2]$, with total length $L$ measured in meters. Consider the bilinear form that would be assembled by a Galerkin MoM with basis and testing functions supported on this segment, using the kernel\n$$\nK_k(x,x') = \\sqrt{\\frac{2}{\\pi k |x-x'|}}\\, e^{i\\left(k |x-x'| - \\frac{\\pi}{4}\\right)}.\n$$\nThis kernel arises as the leading-order high-frequency asymptotic of the two-dimensional Green's function restricted to the line and is a scientifically plausible surrogate for high-frequency operator behavior.\n\nBasis functions:\n- Standard basis: piecewise-constant functions on a uniform partition of $[-L/2, L/2]$ into $M$ equal cells of width $h = L/M$, normalized to unit $L^2$ norm on each cell, i.e.,\n$$\nb_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x), \\quad n = 0, 1, \\dots, M-1,\n$$\nwhere $I_n$ is the $n$-th cell and $\\chi_{I_n}$ is the indicator function.\n- Hybrid numerical-asymptotic basis: basis functions embedding the local stationary-phase oscillation $e^{i k \\hat{\\mathbf{s}}\\cdot \\mathbf{r}(x)}$, with $\\hat{\\mathbf{s}} = (\\cos\\theta_0,\\sin\\theta_0)$ for a fixed angle $\\theta_0$ in radians, resulting in\n$$\nb^{\\mathrm{H}}_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x) \\, e^{i k \\hat{\\mathbf{s}}\\cdot \\mathbf{r}(x)} = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x) \\, e^{i k x \\cos\\theta_0}.\n$$\n\nGalerkin matrices: Using the same functions for testing and expansion, the $M \\times M$ system matrices have entries\n$$\nA_{mn}(k) = \\int_{I_m} \\int_{I_n} K_k(x,x') \\, b_m(x) \\, b_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n= \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') \\, \\mathrm{d}x \\, \\mathrm{d}x',\n$$\nand for the hybrid basis,\n$$\nA^{\\mathrm{H}}_{mn}(k,\\theta_0) = \\int_{I_m} \\int_{I_n} K_k(x,x') \\, \\overline{b^{\\mathrm{H}}_m(x)} \\, b^{\\mathrm{H}}_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n= \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') \\, e^{i k \\cos\\theta_0 (x' - x)} \\, \\mathrm{d}x \\, \\mathrm{d}x'.\n$$\nIn both cases, treat the near-singular behavior at $x = x'$ numerically by replacing $|x - x'|$ with $\\max(|x - x'|, \\varepsilon)$ for a small regularization length $\\varepsilon$ proportional to the cell size, which preserves the integrability and approximates the principal behavior for $|x - x'| \\to 0$.\n\nNumerical implementation details:\n- Use Gauss–Legendre quadrature with $N_q$ points per cell for both integrals, resulting in a $2$-dimensional quadrature per matrix entry.\n- Use $M$ cells uniformly covering $[-L/2, L/2]$.\n- Use the regularization $\\varepsilon = 10^{-6} h$.\n- Use angle unit in radians for $\\theta_0$.\n- Wavenumber $k$ must be provided in radians per meter.\n- Length $L$ must be in meters.\n\nTask:\n1. Implement assembly of $A(k)$ and $A^{\\mathrm{H}}(k,\\theta_0)$ as defined above using numerical quadrature.\n2. For each specified test case, compute the $2$-norm condition number\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)}, \\quad \\kappa_2\\left(A^{\\mathrm{H}}\\right) = \\frac{\\sigma_{\\max}\\left(A^{\\mathrm{H}}\\right)}{\\sigma_{\\min}\\left(A^{\\mathrm{H}}\\right)},\n$$\nwhere $\\sigma_{\\max}$ and $\\sigma_{\\min}$ denote the largest and smallest singular values, respectively.\n3. Report the results in the specified output format.\n\nParameter values and test suite:\n- Segment length: $L = 1$ meter.\n- Number of cells: $M = 12$.\n- Quadrature points per cell: $N_q = 6$.\n- Hybrid phase angle: $\\theta_0 = \\pi/3$ radians.\n- Wavenumbers $k$ (radians per meter) to test:\n  - Case $1$: $k = 5$ (edge case: relatively low frequency with few oscillations across the segment).\n  - Case $2$: $k = 20$ (happy path: moderate frequency).\n  - Case $3$: $k = 100$ (edge case: high frequency).\n  - Case $4$: $k = 200$ (edge case: very high frequency).\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the condition numbers in the following order and numeric type (floats):\n$$\n[\\kappa_2(A(5)), \\kappa_2(A^{\\mathrm{H}}(5,\\theta_0)), \\kappa_2(A(20)), \\kappa_2(A^{\\mathrm{H}}(20,\\theta_0)), \\kappa_2(A(100)), \\kappa_2(A^{\\mathrm{H}}(100,\\theta_0)), \\kappa_2(A(200)), \\kappa_2(A^{\\mathrm{H}}(200,\\theta_0))].\n$$\nAll angles must be in radians, and all lengths and wavenumbers must be in meters and radians per meter, respectively. The printed floats may be in standard decimal representation.",
            "solution": "The user has provided a valid, well-posed problem in computational electromagnetics. The task is to numerically evaluate and compare the conditioning of two different Method of Moments (MoM) system matrices for a one-dimensional problem as a function of the wavenumber $k$. One matrix is generated using a standard piecewise-constant basis, while the other uses a hybrid basis that incorporates the expected high-frequency oscillatory behavior.\n\nThe core of the problem lies in the numerical approximation of the Galerkin matrix entries, which are defined by double integrals. The strategy involves the following steps:\n1.  Define the geometry, kernel, and basis functions as specified.\n2.  Formulate the integral expressions for the matrix entries for both the standard and hybrid bases.\n3.  Discretize the integrals using Gauss-Legendre quadrature.\n4.  Implement an algorithm to assemble the matrices $A(k)$ and $A^{\\mathrm{H}}(k,\\theta_0)$ for each given wavenumber $k$.\n5.  Compute the $2$-norm condition number, $\\kappa_2$, for each assembled matrix using a Singular Value Decomposition (SVD).\n\n**1. Mathematical Formulation**\n\nThe problem is set on a one-dimensional segment of length $L=1$ meter, parameterized by $x \\in [-L/2, L/2]$. The interaction between points $x$ and $x'$ on this segment is described by the high-frequency asymptotic kernel:\n$$\nK_k(x,x') = \\sqrt{\\frac{2}{\\pi k |x-x'|}}\\, e^{i\\left(k |x-x'| - \\frac{\\pi}{4}\\right)}\n$$\nThis kernel is a surrogate for the behavior of the Green's function for the Helmholtz equation at high frequencies ($k \\gg 1$).\n\nThe segment is discretized into $M$ cells, $I_n = [x_n, x_{n+1}]$ for $n=0, 1, \\dots, M-1$, each of width $h = L/M$. The cell boundaries are $x_n = -L/2 + n h$.\n\nTwo sets of basis functions are considered:\n- **Standard Basis:** Piecewise-constant functions, normalized in $L^2(I_n)$.\n$$\nb_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x)\n$$\nwhere $\\chi_{I_n}(x)$ is the indicator function for the cell $I_n$.\n- **Hybrid Basis:** Piecewise-constant functions modulated by a complex phase factor. This basis is designed to capture the dominant oscillatory behavior of the solution, which is assumed to be driven by a plane wave incident from an angle $\\theta_0$.\n$$\nb^{\\mathrm{H}}_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x) \\, e^{i k x \\cos\\theta_0}\n$$\n\nUsing a Galerkin procedure, where the test functions are the complex conjugates of the basis functions, we obtain the matrix entries.\n\nFor the standard basis, the test function $b_m(x)$ is real. The matrix entries are:\n$$\nA_{mn}(k) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} K_k(x,x') b_m(x) b_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x' = \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n$$\n\nFor the hybrid basis, the test function is $\\overline{b^{\\mathrm{H}}_m(x)} = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_m}(x) \\, e^{-i k x \\cos\\theta_0}$. The matrix entries are:\n$$\nA^{\\mathrm{H}}_{mn}(k,\\theta_0) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} K_k(x,x') \\overline{b^{\\mathrm{H}}_m(x)} b^{\\mathrm{H}}_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x' = \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') e^{i k \\cos\\theta_0 (x' - x)} \\, \\mathrm{d}x \\, \\mathrm{d}x'\n$$\nThe problem states that the singularity in the kernel at $x=x'$ is regularized by replacing $|x-x'|$ with $\\max(|x-x'|, \\varepsilon)$, where $\\varepsilon=10^{-6}h$.\n\n**2. Numerical Discretization via Quadrature**\n\nThe double integrals defining the matrix entries are computed numerically using Gauss-Legendre quadrature. For a generic double integral over cells $I_m$ and $I_n$:\n$$\nJ = \\int_{I_m} \\int_{I_n} f(x,x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n$$\nWe perform a change of variables to map each cell to the standard interval $[-1,1]$. Let $x = x_m^c + \\frac{h}{2}\\xi$ and $x' = x_n^c + \\frac{h}{2}\\eta$, where $x_m^c$ and $x_n^c$ are the centers of cells $I_m$ and $I_n$. Then $\\mathrm{d}x = \\frac{h}{2}\\mathrm{d}\\xi$ and $\\mathrm{d}x' = \\frac{h}{2}\\mathrm{d}\\eta$. The integral becomes:\n$$\nJ = \\frac{h^2}{4} \\int_{-1}^{1} \\int_{-1}^{1} f\\left(x_m^c + \\frac{h}{2}\\xi, x_n^c + \\frac{h}{2}\\eta\\right) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nApplying an $N_q$-point Gauss-Legendre quadrature rule, with points $\\xi_i$ and weights $w_i$ on $[-1,1]$, we approximate the integral as:\n$$\nJ \\approx \\frac{h^2}{4} \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i w_j f(x_m^{(i)}, x_n^{(j)})\n$$\nwhere $x_m^{(i)} = x_m^c + \\frac{h}{2}\\xi_i$ and $x_n^{(j)} = x_n^c + \\frac{h}{2}\\eta_j$ are the quadrature points within cells $I_m$ and $I_n$, respectively.\n\nApplying this to our matrix entries (and including the pre-factor $1/h$):\n$$\nA_{mn}(k) \\approx \\frac{h}{4} \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i w_j K_k(x_m^{(i)}, x_n^{(j)})\n$$\n$$\nA^{\\mathrm{H}}_{mn}(k,\\theta_0) \\approx \\frac{h}{4} \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i w_j K_k(x_m^{(i)}, x_n^{(j)}) e^{i k \\cos\\theta_0 (x_n^{(j)} - x_m^{(i)})}\n$$\nThe regularized kernel $K_k$ is used in these summations.\n\n**3. Condition Number Calculation**\n\nOnce the $M \\times M$ matrices $A(k)$ and $A^{\\mathrm{H}}(k, \\theta_0)$ are assembled, their $2$-norm condition numbers are computed. The condition number is defined as the ratio of the largest to the smallest singular value:\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)}\n$$\nStandard numerical linear algebra libraries provide efficient and stable algorithms (based on SVD) to compute this value.\n\n**4. Algorithm Summary**\n\nThe overall algorithm proceeds as follows for each test case wavenumber $k$:\n1.  Initialize constants: $L=1$, $M=12$, $N_q=6$, $\\theta_0=\\pi/3$.\n2.  Calculate derived parameters: $h=L/M$, $\\varepsilon=10^{-6}h$.\n3.  Obtain the $N_q$ Gauss-Legendre quadrature points $\\xi_i$ and weights $w_i$ on the interval $[-1,1]$.\n4.  Determine the coordinates of the center of each of the $M$ cells.\n5.  Pre-calculate the global coordinates of all quadrature points in all cells.\n6.  Initialize two $M \\times M$ complex-valued matrices, $A$ and $A^{\\mathrm{H}}$, to zero.\n7.  Iterate through each matrix entry $(m,n)$ for $m,n \\in \\{0, \\dots, M-1\\}$:\n    a. Create two-dimensional grids of quadrature points $(x, x')$ corresponding to cells $I_m$ and $I_n$.\n    b. Evaluate the integrands for $A_{mn}$ and $A^{\\mathrm{H}}_{mn}$ at all pairs of quadrature points, using the regularized kernel.\n    c. Compute the double summations weighted by the quadrature weights to approximate the integrals.\n    d. Assign the results to $A_{mn}$ and $A^{\\mathrm{H}}_{mn}$.\n8.  After the matrices are fully assembled, compute their condition numbers, $\\kappa_2(A)$ and $\\kappa_2(A^{\\mathrm{H}})$.\n9.  Store the resulting two condition numbers.\n\nThis process is repeated for all specified values of $k$, and the results are aggregated into a single list for output. The expectation is that $\\kappa_2(A)$ will grow significantly with $k$, whereas $\\kappa_2(A^{\\mathrm{H}})$ will exhibit much milder growth, demonstrating the effectiveness of the hybrid basis in stabilizing the numerical system at high frequencies.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Constructs and compares MoM system matrices for a 1D conductor,\n    quantifying the effect of a hybrid phase-embedded basis on the\n    matrix condition number as a function of wavenumber k.\n    \"\"\"\n    # Define the test cases and fixed parameters from the problem statement.\n    L = 1.0  # meters\n    M = 12\n    N_q = 6\n    theta_0 = np.pi / 3  # radians\n    k_vals = [5.0, 20.0, 100.0, 200.0]  # radians per meter\n\n    # Derived parameters\n    h = L / M\n    eps = 1e-6 * h\n    cos_theta_0 = np.cos(theta_0)\n\n    # Get Gauss-Legendre quadrature points and weights for the interval [-1, 1]\n    # Using scipy as specified in the problem environment.\n    xi, w = roots_legendre(N_q)\n\n    # Define cell center coordinates for the M uniform cells on [-L/2, L/2]\n    cell_indices = np.arange(M)\n    cell_centers = -L / 2 + (cell_indices + 0.5) * h\n\n    # Pre-calculate the global coordinates of quadrature points for each cell\n    # quad_points_per_cell[m, i] is the i-th quadrature point in cell m\n    quad_points_per_cell = cell_centers[:, np.newaxis] + (h / 2) * xi[np.newaxis, :]\n\n    results = []\n\n    # Loop over each wavenumber test case\n    for k in k_vals:\n        # Initialize the M x M system matrices with complex zeros\n        A = np.zeros((M, M), dtype=complex)\n        A_H = np.zeros((M, M), dtype=complex)\n\n        # Loop over matrix row (m) and column (n) indices to assemble entries\n        for m in range(M):\n            for n in range(M):\n                # Get the sets of quadrature points for cells m and n\n                x_vals = quad_points_per_cell[m, :]\n                xp_vals = quad_points_per_cell[n, :]\n\n                # Create 2D grids of points (x, x') for the double integral\n                # 'ij' indexing ensures X varies with the first index, XP with the second\n                X, XP = np.meshgrid(x_vals, xp_vals, indexing='ij')\n\n                # Calculate the distance |x - x'| and apply regularization\n                dist = np.abs(X - XP)\n                reg_dist = np.maximum(dist, eps)\n\n                # Evaluate the kernel K_k(x, x') at all quadrature point pairs\n                kernel_phase = 1j * (k * reg_dist - np.pi / 4)\n                kernel_mag = np.sqrt(2 / (np.pi * k * reg_dist))\n                kernel_vals = kernel_mag * np.exp(kernel_phase)\n\n                # Create a 2D grid of quadrature weights w_i * w_j\n                W_grid = np.outer(w, w)\n\n                # Calculate the matrix entry for A(k) using numerical quadrature\n                # The integral is approx. sum(weights * integrand_vals)\n                # The total prefactor is (1/h) * (h/2) * (h/2) = h/4\n                A[m, n] = (h / 4) * np.sum(W_grid * kernel_vals)\n\n                # Calculate the additional phase factor for the hybrid basis matrix A_H\n                hybrid_phase_factor = np.exp(1j * k * cos_theta_0 * (XP - X))\n                \n                # Calculate the matrix entry for A_H(k, theta_0)\n                integrand_H = kernel_vals * hybrid_phase_factor\n                A_H[m, n] = (h / 4) * np.sum(W_grid * integrand_H)\n\n        # Compute the 2-norm condition numbers of the assembled matrices\n        cond_A = np.linalg.cond(A)\n        cond_A_H = np.linalg.cond(A_H)\n        \n        # Append results for the current k\n        results.extend([cond_A, cond_A_H])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}