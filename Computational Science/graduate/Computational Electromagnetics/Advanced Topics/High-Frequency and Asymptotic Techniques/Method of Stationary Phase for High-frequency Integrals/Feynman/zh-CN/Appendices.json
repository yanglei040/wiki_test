{
    "hands_on_practices": [
        {
            "introduction": "我们从一个高频电磁学中的典型问题开始，该问题旨在计算来自曲面的远场辐射。这项练习将引导您应用稳相法，以揭示表面几何特性（如主曲率）与远场辐射渐近行为之间的基本联系。通过这个练习，您将掌握将物理光学积分转化为简洁解析表达式的核心技能。",
            "id": "3330744",
            "problem": "一个光滑的凸导电表面在局部笛卡尔坐标系中由函数 $z=f(x,y)$ 的图像描述，其在原点处的主曲率半径为 $R_x>0$ 和 $R_y>0$，原点处的单位法向量沿 $\\hat{\\mathbf{z}}$ 方向。在一个高频辐射问题中，观测方向 $\\hat{\\mathbf{r}}$ 上的远场方向图（忽略一个可以不计的总观测距离因子）由振荡积分表示\n$$\nE(\\hat{\\mathbf{r}})=\\int_{S} J(\\mathbf{r}') \\exp\\!\\big(i k \\,\\hat{\\mathbf{r}}\\cdot \\mathbf{r}'\\big)\\, dS',\n$$\n其中 $k>0$ 是自由空间波数，$S$ 是辐射表面，$\\mathbf{r}'=(x,y,z)$，而 $J(\\mathbf{r}')$ 是一个缓慢变化的等效表面电流密度。假设在原点附近，该表面具有二次近似：\n$$\nz=f(x,y)=\\frac{x^{2}}{2 R_x}+\\frac{y^{2}}{2 R_y},\n$$\n该邻域内的电流是恒定的，$J(\\mathbf{r}')=J_0$（其中 $J_0$ 是一个复常数），并且观测方向是原点处的表面法线方向，$\\hat{\\mathbf{r}}=\\hat{\\mathbf{z}}$。进一步假设表面延伸得足够远，使得对于大的 $k$，其主要贡献来自原点处的稳相点，并且高阶项和边缘贡献可以忽略不计。\n\n仅使用稳相法的第一性原理，从相位的泰勒展开开始，并计算由此产生的典范振荡积分，推导当 $k\\to\\infty$ 时 $E(\\hat{\\mathbf{z}})$ 的主阶渐近表达式。将你的最终答案表示为关于 $J_0$、$k$、$R_x$ 和 $R_y$ 的单个闭式解析表达式。不要包含单位。不要四舍五入；需要一个精确表达式。",
            "solution": "该问题被评估为具有科学依据、提法恰当且客观。这是稳相法在高频物理光学背景下的一个标准应用，而物理光学是计算电磁学中的一个基础课题。所有必要信息均已提供，且所作假设对于渐近分析是一致且具有物理意义的。因此，该问题被认为是**有效的**。\n\n目标是求出积分\n$$\nE(\\hat{\\mathbf{r}})=\\int_{S} J(\\mathbf{r}') \\exp\\!\\big(i k \\,\\hat{\\mathbf{r}}\\cdot \\mathbf{r}'\\big)\\, dS'\n$$\n当波数 $k \\to \\infty$ 时的主阶渐近表达式。\n\n我们已知以下条件：\n1.  观测方向是原点处的表面法线方向，$\\hat{\\mathbf{r}}=\\hat{\\mathbf{z}}$。\n2.  表面电流密度在局部是恒定的，$J(\\mathbf{r}')=J_0$。\n3.  表面 $S$ 在局部由二次形式 $z = f(x,y) = \\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}$ 近似。\n\n将 $\\hat{\\mathbf{r}}=\\hat{\\mathbf{z}}$ 代入积分，相位项变为 $k\\,\\hat{\\mathbf{z}}\\cdot\\mathbf{r}'$。对于表面上的一个点 $\\mathbf{r}'=(x,y,z)$，该点积就是 $k z$。积分变为：\n$$\nE(\\hat{\\mathbf{z}}) = \\int_{S} J_0 \\exp(i k z) \\, dS'\n$$\n为了计算在表面 $S$ 上的这个积分，我们使用坐标 $(x,y)$ 对表面进行参数化。表面上的一个点由向量 $\\mathbf{r}'(x,y) = x\\hat{\\mathbf{x}} + y\\hat{\\mathbf{y}} + f(x,y)\\hat{\\mathbf{z}}$ 给出。微分面元 $dS'$ 由切向量叉积的模给出：\n$$\ndS' = |\\frac{\\partial\\mathbf{r}'}{\\partial x} \\times \\frac{\\partial\\mathbf{r}'}{\\partial y}| \\, dx \\, dy\n$$\n切向量为：\n$$\n\\frac{\\partial\\mathbf{r}'}{\\partial x} = \\hat{\\mathbf{x}} + \\frac{\\partial f}{\\partial x} \\hat{\\mathbf{z}} = \\hat{\\mathbf{x}} + \\frac{x}{R_x} \\hat{\\mathbf{z}}\n$$\n$$\n\\frac{\\partial\\mathbf{r}'}{\\partial y} = \\hat{\\mathbf{y}} + \\frac{\\partial f}{\\partial y} \\hat{\\mathbf{z}} = \\hat{\\mathbf{y}} + \\frac{y}{R_y} \\hat{\\mathbf{z}}\n$$\n它们的叉积是：\n$$\n\\frac{\\partial\\mathbf{r}'}{\\partial x} \\times \\frac{\\partial\\mathbf{r}'}{\\partial y} = (\\hat{\\mathbf{x}} + \\frac{x}{R_x} \\hat{\\mathbf{z}}) \\times (\\hat{\\mathbf{y}} + \\frac{y}{R_y} \\hat{\\mathbf{z}}) = -\\frac{x}{R_x}\\hat{\\mathbf{x}} - \\frac{y}{R_y}\\hat{\\mathbf{y}} + \\hat{\\mathbf{z}}\n$$\n该向量的模给出了面元：\n$$\ndS' = \\sqrt{\\left(-\\frac{x}{R_x}\\right)^2 + \\left(-\\frac{y}{R_y}\\right)^2 + 1^2} \\, dx \\, dy = \\sqrt{1 + \\frac{x^2}{R_x^2} + \\frac{y^2}{R_y^2}} \\, dx \\, dy\n$$\n将这些表达式代入 $E(\\hat{\\mathbf{z}})$ 的积分中，我们得到一个在 $(x,y)$ 平面上的二维积分：\n$$\nE(\\hat{\\mathbf{z}}) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} J_0 \\sqrt{1 + \\frac{x^2}{R_x^2} + \\frac{y^2}{R_y^2}} \\exp\\left(i k \\left(\\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}\\right)\\right) \\, dx \\, dy\n$$\n积分限被扩展到 $\\pm\\infty$，因为问题假设对于大的 $k$，主要贡献来自原点处的稳相点，而远离原点区域的贡献由于相位的快速振荡而变得可以忽略不计。\n\n该积分是稳相法的典范形式，$I = \\int \\int g(x,y) \\exp(ik\\phi(x,y)) \\, dx \\, dy$，其中：\n- 幅度函数是 $g(x,y) = J_0 \\sqrt{1 + \\frac{x^2}{R_x^2} + \\frac{y^2}{R_y^2}}$。\n- 相位函数是 $\\phi(x,y) = \\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}$。\n\n稳相法指出，对于大的 $k$，积分的主要贡献来自稳相点附近，在这些点上相位的梯度为零，即 $\\nabla \\phi(x,y) = 0$。\n$$\n\\frac{\\partial\\phi}{\\partial x} = \\frac{x}{R_x} = 0 \\implies x=0\n$$\n$$\n\\frac{\\partial\\phi}{\\partial y} = \\frac{y}{R_y} = 0 \\implies y=0\n$$\n唯一的稳相点在 $(x_0, y_0) = (0,0)$。\n\n主阶渐近近似是通过将缓慢变化的幅度函数 $g(x,y)$ 替换为其在稳相点的值 $g(0,0)$，并计算剩余的振荡积分得到的。\n$$\ng(0,0) = J_0 \\sqrt{1 + 0 + 0} = J_0\n$$\n积分变为：\n$$\nE(\\hat{\\mathbf{z}}) \\sim g(0,0) \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(ik\\phi(x,y)) \\, dx \\, dy\n$$\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(i k \\left(\\frac{x^2}{2R_x} + \\frac{y^2}{2R_y}\\right)\\right) \\, dx \\, dy\n$$\n这个积分可以分解为两个一维积分的乘积：\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_x} x^2\\right) dx \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_y} y^2\\right) dy \\right)\n$$\n这些是菲涅耳型的典范振荡积分。这类积分的通用公式是：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(i \\alpha u^2) \\, du = \\sqrt{\\frac{\\pi}{|\\alpha|}} \\exp\\left(i \\frac{\\pi}{4} \\text{sgn}(\\alpha)\\right)\n$$\n对于关于 $x$ 的积分，系数为 $\\alpha_x = \\frac{k}{2R_x}$。因为 $k>0$ 且 $R_x>0$，所以我们有 $\\alpha_x > 0$ 且 $\\text{sgn}(\\alpha_x)=1$。该积分的计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_x} x^2\\right) dx = \\sqrt{\\frac{\\pi}{k/(2R_x)}} \\exp\\left(i \\frac{\\pi}{4}\\right) = \\sqrt{\\frac{2\\pi R_x}{k}} e^{i\\pi/4}\n$$\n类似地，对于关于 $y$ 的积分，系数为 $\\alpha_y = \\frac{k}{2R_y}$。因为 $k>0$ 且 $R_y>0$，所以我们有 $\\alpha_y > 0$ 且 $\\text{sgn}(\\alpha_y)=1$。该积分为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(i \\frac{k}{2R_y} y^2\\right) dy = \\sqrt{\\frac{\\pi}{k/(2R_y)}} \\exp\\left(i \\frac{\\pi}{4}\\right) = \\sqrt{\\frac{2\\pi R_y}{k}} e^{i\\pi/4}\n$$\n结合这些结果，$E(\\hat{\\mathbf{z}})$ 的渐近表达式为：\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\left( \\sqrt{\\frac{2\\pi R_x}{k}} e^{i\\pi/4} \\right) \\left( \\sqrt{\\frac{2\\pi R_y}{k}} e^{i\\pi/4} \\right)\n$$\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\sqrt{\\frac{4\\pi^2 R_x R_y}{k^2}} \\exp\\left(i\\frac{\\pi}{4} + i\\frac{\\pi}{4}\\right)\n$$\n$$\nE(\\hat{\\mathbf{z}}) \\sim J_0 \\frac{2\\pi\\sqrt{R_x R_y}}{k} \\exp\\left(i\\frac{\\pi}{2}\\right)\n$$\n使用欧拉公式，$\\exp(i\\pi/2) = \\cos(\\pi/2) + i\\sin(\\pi/2) = i$。因此，最终表达式为：\n$$\nE(\\hat{\\mathbf{z}}) \\sim \\frac{2\\pi i J_0 \\sqrt{R_x R_y}}{k}\n$$\n这就是当 $k \\to \\infty$ 时，法向远场方向图的主阶渐近表达式。",
            "answer": "$$\\boxed{\\frac{2 \\pi i J_0 \\sqrt{R_x R_y}}{k}}$$"
        },
        {
            "introduction": "在掌握了“正问题”（即从表面几何计算散射场）的分析方法后，我们现在转向一个更具挑战性的“反问题”。这项练习将前一个问题的洞察力颠倒过来，要求您利用远场测量数据来反演出表面的局部几何特性。这个实践将分析工具转化为一种强大的遥感或计量方法，展示了如何从渐近分析中获得实际的工程应用价值。",
            "id": "3330706",
            "problem": "一个基于计算电磁学的、使用驻相法的可扩展反演问题，以纯数学形式提出。考虑一个光滑的理想导电表面，其在镜面反射点附近可通过切平面上的一个高度函数 $z(x,y)$ 进行局部参数化。入射场为方向向量为 $\\mathbf{s}_{\\mathrm{i}}$ 的平面波，散射观测方向为 $\\mathbf{s}_{\\mathrm{o}}$，二者均为单位长度。原点 $(x,y)=(0,0)$ 是一个镜面反射点，在该点处，表面法线与 $\\mathbf{s}_{\\mathrm{i}}$ 和 $\\mathbf{s}_{\\mathrm{o}}$ 的角平分线对齐。在物理光学（PO）近似下（物理光学是一种用于高频散射的渐近方法），固定方向上的远场散射振幅可以写成一个关于局部坐标 $(x,y)$ 的二维振荡表面积分，其具有快速变化的相位和缓慢变化的振幅。在高频假设下，其主阶贡献由应用于该积分的驻相法确定。镜面反射点处的相位海森矩阵与曲面的第二基本形式相关，其行列式取决于主曲率的乘积。你的任务是构建一个基于驻相法的反演方法，从测量得到的高频振幅中恢复镜面反射点处的局部高斯曲率（主曲率的乘积）。\n\n假设镜面反射点附近的局部表面可以建模为 $z(x,y)=\\dfrac{x^2}{2 R_1}+\\dfrac{y^2}{2 R_2}$，其中 $R_1$ 和 $R_2$ 是 $(0,0)$ 处的主曲率半径，主曲率为 $\\kappa_1=\\dfrac{1}{R_1}$ 和 $\\kappa_2=\\dfrac{1}{R_2}$。对于法向入射和后向散射观测，取 $\\mathbf{s}_{\\mathrm{i}}=(0,0,-1)$ 和 $\\mathbf{s}_{\\mathrm{o}}=(0,0,1)$，并假设在波数为 $k$ 时测得的散射振幅大小为 $A(k)$，这是通过对几个 $k$ 值进行实验获得的。\n\n从振荡积分表示和一般驻相原理出发，推导出一个反演公式，该公式用 $A(k)$ 随波数的缩放关系来表示镜面反射点处的局部高斯曲率 $K=\\kappa_1 \\kappa_2$。然后用算法实现它，从离散测量值 $\\{(k_j,A(k_j))\\}_{j=1}^m$ 中估计 $K$。所有角度都以弧度处理。最终的曲率值以 $\\mathrm{m}^{-2}$ 为单位表示，四舍五入到六位小数。\n\n使用以下在镜面反射点处测得的振幅测试套件。在所有情况下，波数 $k$ 的值为 $[100,200,400]$，单位为 $\\mathrm{rad/m}$：\n\n- 案例 $1$（通用正常路径）：测量振幅 $A(k)$ 为 $[0.02221441469079183,\\,0.011107207345395916,\\,0.005553603672697958]$。\n- 案例 $2$（不同曲率）：测量振幅 $A(k)$ 为 $[0.031415926535897934,\\,0.015707963267948967,\\,0.007853981633974483]$。\n- 案例 $3$（更高曲率）：测量振幅 $A(k)$ 为 $[0.011107207345395915,\\,0.005553603672697957,\\,0.0027768018363489783]$。\n- 案例 $4$（近乎平坦的边缘情况）：测量振幅 $A(k)$ 为 $[31.41592653589793,\\,15.707963267948964,\\,7.853981633974482]$。\n\n你的程序应生成单行输出，其中包含四个案例的估计高斯曲率，以逗号分隔的列表形式包含在方括号中，每个值都四舍五入到六位小数，单位为 $\\mathrm{m}^{-2}$（例如，$[K_1,K_2,K_3,K_4]$）。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n- **表面模型**：一个光滑的理想导电表面，可通过 $z(x,y)=\\dfrac{x^2}{2 R_1}+\\dfrac{y^2}{2 R_2}$ 进行局部参数化。\n- **主曲率**：$\\kappa_1=\\dfrac{1}{R_1}$ 和 $\\kappa_2=\\dfrac{1}{R_2}$。\n- **高斯曲率**：$K=\\kappa_1 \\kappa_2$。\n- **镜面反射点**：原点 $(x,y)=(0,0)$。\n- **入射/观测几何**：法向入射和后向散射。\n- **入射方向**：$\\mathbf{s}_{\\mathrm{i}}=(0,0,-1)$。\n- **散射方向**：$\\mathbf{s}_{\\mathrm{o}}=(0,0,1)$。\n- **测量量**：波数为 $k$ 时的散射振幅大小 $A(k)$。\n- **近似方法**：物理光学（PO）和用于高频积分的驻相法。\n- **任务**：从 $A(k)$ 随 $k$ 的缩放关系推导出 $K$ 的反演公式，并用算法实现。\n- **测试数据**：\n  - 所有案例的波数：$k \\in [100, 200, 400]$，单位为 $\\mathrm{rad/m}$。\n  - 案例 1：振幅 $A(k) = [0.02221441469079183, 0.011107207345395916, 0.005553603672697958]$。\n  - 案例 2：振幅 $A(k) = [0.031415926535897934, 0.015707963267948967, 0.007853981633974483]$。\n  - 案例 3：振幅 $A(k) = [0.011107207345395915, 0.005553603672697957, 0.0027768018363489783]$。\n  - 案例 4：振幅 $A(k) = [31.41592653589793, 15.707963267948964, 7.853981633974482]$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题植根于高频计算电磁学的既定原理。物理光学近似和驻相法是分析大尺寸物体散射的标准、有据可查的技术。二阶相位项与表面曲率之间的关系是此分析的基石。\n- **适定性**：该问题是适定的。它要求推导一个特定的物理关系并进行反演。提供了足够的数据以在指定模型内唯一确定未知参数（高斯曲率 $K$）。\n- **客观性**：该问题以精确、客观的数学和物理术语陈述。它没有歧义、主观性或非科学性主张。\n- **一致性与完备性**：该问题是自洽的。提供的表面模型、散射几何和测量数据对于推导和应用反演是充分且一致的。数据本身是根据底层物理模型构建的，从而能够确定一个原本模糊的比例常数。\n\n### 第3步：结论与行动\n问题被判定为**有效**，因为它是科学合理的、适定的、客观的且内部一致的。将推导并实施解决方案。\n\n### 基于原理的求解\n求解需要使用驻相法推导测量得到的散射振幅 $A(k)$ 与高斯曲率 $K$ 之间的显式关系。\n\n在物理光学（PO）近似中，标量散射振幅由在照明表面 $S$ 上的积分给出。对于一般的表面元素 $\\mathbf{r}'(x,y) = (x, y, z(x,y))$，积分形式如下：\n$$ I(k) = \\iint_S F(x,y) e^{i k (\\mathbf{s}_{\\mathrm{i}} - \\mathbf{s}_{\\mathrm{o}}) \\cdot \\mathbf{r}'(x,y)} dS $$\n其中 $F(x,y)$ 是一个缓慢变化的振幅函数，包括极化和材料属性，而 $k$ 是波数。在表面与 $xy$ 平面相切的镜面反射点附近，表面元素 $dS$ 可近似为 $dx dy$。\n\n对于法向入射和后向散射的指定几何形状，我们有 $\\mathbf{s}_{\\mathrm{i}} = (0,0,-1)$ 和 $\\mathbf{s}_{\\mathrm{o}} = (0,0,1)$。向量差为 $\\mathbf{q} = \\mathbf{s}_{\\mathrm{i}} - \\mathbf{s}_{\\mathrm{o}} = (0,0,-2)$。指数中的相位项为：\n$$ \\Phi(x,y) = k \\mathbf{q} \\cdot \\mathbf{r}'(x,y) = k (0,0,-2) \\cdot (x, y, z(x,y)) = -2k z(x,y) $$\n积分变为：\n$$ I(k) = \\iint F(x,y) e^{-i 2k z(x,y)} dx dy $$\n对于大的 $k$ 值，这是一个高振荡积分。根据驻相法，主要贡献来自相位梯度为零的点。设相位函数为 $\\lambda f(x,y)$，其中 $\\lambda=k$ 且 $f(x,y)=-2z(x,y)$。驻点 $(x_0, y_0)$ 通过求解 $\\nabla f(x,y) = -2\\nabla z(x,y) = 0$ 来找到。给定 $z(x,y) = \\frac{x^2}{2R_1} + \\frac{y^2}{2R_2}$，梯度分量为 $\\frac{\\partial z}{\\partial x} = \\frac{x}{R_1}$ 和 $\\frac{\\partial z}{\\partial y} = \\frac{y}{R_2}$。这些仅在 $(x,y)=(0,0)$ 处为零，证实原点是唯一的驻点。\n\n二维积分 $I(\\lambda) = \\iint g(x,y) e^{i\\lambda f(x,y)} dx dy$ 在非退化驻点 $(x_0, y_0)$ 处的主阶渐近近似由以下公式给出：\n$$ I(\\lambda) \\approx g(x_0, y_0) e^{i\\lambda f(x_0, y_0)} \\frac{2\\pi}{\\lambda \\sqrt{|\\det(H_f(x_0, y_0))|}} e^{i\\frac{\\pi}{4}\\text{sgn}(H_f)} $$\n其中 $H_f$ 是 $f(x,y)$ 的海森矩阵，$\\text{sgn}(H_f)$ 是其符号差（正特征值数量减去负特征值数量）。\n\n在我们的例子中，$\\lambda=k$，$g(x,y)=F(x,y)$，且 $f(x,y) = -2z(x,y) = -\\frac{x^2}{R_1} - \\frac{y^2}{R_2}$。在驻点 $(0,0)$ 处，$f(0,0)=0$。\n$f(x,y)$ 的海森矩阵为：\n$$ H_f = \\begin{pmatrix} \\frac{\\partial^2 f}{\\partial x^2}  \\frac{\\partial^2 f}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 f}{\\partial y \\partial x}  \\frac{\\partial^2 f}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} -2/R_1  0 \\\\ 0  -2/R_2 \\end{pmatrix} $$\n海森矩阵的行列式是：\n$$ \\det(H_f) = \\left(-\\frac{2}{R_1}\\right) \\left(-\\frac{2}{R_2}\\right) = \\frac{4}{R_1 R_2} = 4 \\kappa_1 \\kappa_2 = 4K $$\n假设表面是凸的（曲率半径为正），$H_f$ 的特征值为 $-2/R_1$ 和 $-2/R_2$，二者均为负。符号差为 $\\text{sgn}(H_f) = 0 - 2 = -2$。相位因子变为 $e^{i\\frac{\\pi}{4}(-2)} = e^{-i\\pi/2} = -i$。\n\n将这些代入渐近公式：\n$$ I(k) \\approx F(0,0) e^{ik \\cdot 0} \\frac{2\\pi}{k \\sqrt{|4K|}} (-i) = F(0,0) \\frac{-i \\pi}{k \\sqrt{K}} $$\n该积分的模，即问题中定义的测量振幅 $A(k)$，为：\n$$ A(k) = |I(k)| = \\left| F(0,0) \\frac{-i \\pi}{k \\sqrt{K}} \\right| = \\frac{|F(0,0)| \\pi}{k \\sqrt{K}} $$\n此推导表明，对于给定的曲面，乘积 $k \\cdot A(k)$ 应为一个常数：\n$$ P = k \\cdot A(k) = \\frac{|F(0,0)| \\pi}{\\sqrt{K}} $$\n这个表达式包含未知因子 $|F(0,0)|$，它与镜面反射点的反射特性有关。我们可以通过分析提供的测试数据来确定这个常数。对于案例 2，我们有 $k_1=100$ 和 $A(k_1) \\approx 0.0314159$。乘积为 $P_2 = 100 \\times 0.0314159... = 3.14159... = \\pi$。\n这强烈暗示该问题的构造使得镜面反射点处的缓变振幅项被归一化为1，即 $|F(0,0)|=1$。采用此假设，我们的模型简化为：\n$$ P = k \\cdot A(k) = \\frac{\\pi}{\\sqrt{K}} $$\n这为反演提供了基础。通过从测量数据计算乘积 $P$，我们可以求解高斯曲率 $K$：\n$$ \\sqrt{K} = \\frac{\\pi}{P} \\implies K = \\left( \\frac{\\pi}{P} \\right)^2 $$\n\n因此，算法如下：\n$1$。对于每组测量值 $\\{(k_j, A(k_j))\\}$，计算常数乘积 $P = k_j A(k_j)$。由于数据无噪声，任何单一对 $(k_j, A(k_j))$ 都足够。\n$2$。使用推导出的反演公式 $K = (\\pi/P)^2$ 计算高斯曲率。\n$3$。以 $\\mathrm{m}^{-2}$ 为单位报告 $K$ 的值，四舍五入到六位小数。\n\n例如，对于案例 1：\n$P = 100 \\times 0.02221441469079183 \\approx 2.22144147$。\n$K = (\\pi / 2.22144147)^2 = (3.14159265 / 2.22144147)^2 \\approx (1.41421356)^2 = 2$。\n将对所有四个案例执行计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the inversion problem to find Gaussian curvature from high-frequency\n    scattered amplitude data based on the method of stationary phase.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing the list of wavenumbers and the list of amplitudes.\n    # Wavenumbers are common for all cases a priori.\n    wavenumbers = [100.0, 200.0, 400.0]  # in rad/m\n\n    test_cases = [\n        # Case 1\n        [0.02221441469079183, 0.011107207345395916, 0.005553603672697958],\n        # Case 2\n        [0.031415926535897934, 0.015707963267948967, 0.007853981633974483],\n        # Case 3\n        [0.011107207345395915, 0.005553603672697957, 0.0027768018363489783],\n        # Case 4\n        [31.41592653589793, 15.707963267948964, 7.853981633974482],\n    ]\n\n    results = []\n    \n    # The derived relationship is A(k) = pi / (k * sqrt(K)).\n    # This implies k * A(k) = pi / sqrt(K).\n    # Let P = k * A(k). Then K = (pi / P)^2.\n    # The provided data is noise-free, so we can use any (k, A(k)) pair.\n    # We will use the first pair from each case.\n    \n    for amplitudes in test_cases:\n        # Select the first wavenumber and its corresponding amplitude\n        k = wavenumbers[0]\n        A_k = amplitudes[0]\n\n        # Calculate the constant product P = k * A(k)\n        P = k * A_k\n\n        # Use the derived inversion formula to calculate the Gaussian curvature K\n        # K = (pi / P)^2\n        K = (np.pi / P)**2\n        \n        results.append(K)\n\n    # Format the final output as a comma-separated list of rounded values\n    # enclosed in square brackets. Each value is rounded to six decimal places.\n    output_str = f\"[{','.join(f'{val:.6f}' for val in results)}]\"\n    \n    # Print the final result in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "最后一项练习将带您进入渐近分析与数值方法交叉的前沿领域。稳相法不仅能帮助我们近似求解积分，更重要的是，它揭示了高频场的基本振荡结构。本练习旨在探索如何将这种先验知识嵌入到矩量法 (MoM) 的数值基函数中，以构建在频率增高时更为稳定和高效的计算算法，这在计算电磁学中是一个至关重要的高级课题。",
            "id": "3330705",
            "problem": "要求您构建并比较一维直导体段的矩量法(MoM)系统矩阵，该方法使用高频渐近核和嵌入了局部稳相振荡的混合数值-渐近基。目标是量化随着波数 $k$ 的增加，将已知的高频振荡 $e^{i k \\hat{\\mathbf{s}}\\cdot \\mathbf{r}}$ 嵌入基函数中如何影响所得离散算子的条件数。\n\n基本基底与算子模型：在由标量亥姆霍兹方程控制的二维散射问题中，电场积分方程涉及自由空间格林函数 $G_k(\\mathbf{r}) = \\dfrac{i}{4} H_0^{(1)}(k r)$，其中 $H_0^{(1)}$ 表示第一类零阶汉克尔函数，$r$ 是欧几里得距离。对于大的 $k$，一个被广泛接受的高频渐近近似是\n$$\nH_0^{(1)}(k r) \\approx \\sqrt{\\frac{2}{\\pi k r}}\\, e^{i\\left(k r - \\frac{\\pi}{4}\\right)} \\quad \\text{for } k r \\gg 1.\n$$\n将注意力限制在由 $\\mathbf{r}(x) = (x, 0)$ 对 $x \\in [-L/2, L/2]$ 参数化的直导体段上，其总长度 $L$ 以米为单位。考虑通过 Galerkin 矩量法组装的双线性形式，其基函数和测试函数都支撑在该导体段上，使用的核函数为\n$$\nK_k(x,x') = \\sqrt{\\frac{2}{\\pi k |x-x'|}}\\, e^{i\\left(k |x-x'| - \\frac{\\pi}{4}\\right)}.\n$$\n该核函数是二维格林函数限制在直线上时的高频渐近主阶项，是高频算子行为的一个科学上合理的替代模型。\n\n基函数：\n- 标准基：在 $[-L/2, L/2]$ 的一个均匀剖分上的分段常数函数，该剖分将区间分为 $M$ 个等宽的单元，宽度为 $h = L/M$。函数在每个单元上归一化为单位 $L^2$ 范数，即\n$$\nb_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x), \\quad n = 0, 1, \\dots, M-1,\n$$\n其中 $I_n$ 是第 $n$ 个单元，$\\chi_{I_n}$ 是其指示函数。\n- 混合数值-渐近基：嵌入了局部稳相振荡 $e^{i k \\hat{\\mathbf{s}}\\cdot \\mathbf{r}(x)}$ 的基函数，其中 $\\hat{\\mathbf{s}} = (\\cos\\theta_0,\\sin\\theta_0)$ 是一个固定角度 $\\theta_0$（以弧度为单位），得到\n$$\nb^{\\mathrm{H}}_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x) \\, e^{i k \\hat{\\mathbf{s}}\\cdot \\mathbf{r}(x)} = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x) \\, e^{i k x \\cos\\theta_0}.\n$$\n\nGalerkin 矩阵：使用相同的函数进行测试和展开，则 $M \\times M$ 系统矩阵的元素为\n$$\nA_{mn}(k) = \\int_{I_m} \\int_{I_n} K_k(x,x') \\, b_m(x) \\, b_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n= \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') \\, \\mathrm{d}x \\, \\mathrm{d}x',\n$$\n对于混合基，则为\n$$\nA^{\\mathrm{H}}_{mn}(k,\\theta_0) = \\int_{I_m} \\int_{I_n} K_k(x,x') \\, \\overline{b^{\\mathrm{H}}_m(x)} \\, b^{\\mathrm{H}}_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n= \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') \\, e^{i k \\cos\\theta_0 (x' - x)} \\, \\mathrm{d}x \\, \\mathrm{d}x'.\n$$\n在这两种情况下，通过将 $|x - x'|$ 替换为 $\\max(|x - x'|, \\varepsilon)$ 来数值处理 $x = x'$ 处的近奇异行为，其中 $\\varepsilon$ 是一个与单元尺寸成比例的小正则化长度。这保持了可积性，并近似了 $|x - x'| \\to 0$ 时的主导行为。\n\n数值实现细节：\n- 对两个积分都使用每个单元 $N_q$ 个点的高斯-勒让德求积法，从而每个矩阵元素需要进行一次二维求积。\n- 使用 $M$ 个单元均匀覆盖 $[-L/2, L/2]$。\n- 使用正则化 $\\varepsilon = 10^{-6} h$。\n- $\\theta_0$ 的角度单位为弧度。\n- 波数 $k$ 必须以弧度/米为单位提供。\n- 长度 $L$ 必须以米为单位。\n\n任务：\n1. 实现上述定义的 $A(k)$ 和 $A^{\\mathrm{H}}(k,\\theta_0)$ 的组装，使用数值求积法。\n2. 对每个指定的测试案例，计算 2-范数条件数\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)}, \\quad \\kappa_2\\left(A^{\\mathrm{H}}\\right) = \\frac{\\sigma_{\\max}\\left(A^{\\mathrm{H}}\\right)}{\\sigma_{\\min}\\left(A^{\\mathrm{H}}\\right)},\n$$\n其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别表示最大和最小奇异值。\n3. 按照指定的输出格式报告结果。\n\n参数值和测试套件：\n- 导体段长度：$L = 1$ 米。\n- 单元数量：$M = 12$。\n- 每个单元的求积点数：$N_q = 6$。\n- 混合基相位角：$\\theta_0 = \\pi/3$ 弧度。\n- 待测试的波数 $k$ (弧度/米)：\n  - 案例 1：$k = 5$ (边界情况：频率相对较低，整个导体段上振荡次数少)。\n  - 案例 2：$k = 20$ (理想情况：中等频率)。\n  - 案例 3：$k = 100$ (边界情况：高频)。\n  - 案例 4：$k = 200$ (边界情况：非常高的频率)。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。该列表必须按以下顺序包含这些条件数，数值类型为浮点数：\n$$\n[\\kappa_2(A(5)), \\kappa_2(A^{\\mathrm{H}}(5,\\theta_0)), \\kappa_2(A(20)), \\kappa_2(A^{\\mathrm{H}}(20,\\theta_0)), \\kappa_2(A(100)), \\kappa_2(A^{\\mathrm{H}}(100,\\theta_0)), \\kappa_2(A(200)), \\kappa_2(A^{\\mathrm{H}}(200,\\theta_0))].\n$$\n所有角度必须以弧度为单位，所有长度和波数必须分别以米和弧度/米为单位。打印的浮点数可以是标准十进制表示法。",
            "solution": "用户提供了一个计算电磁学领域中有效且适定的问题。任务是数值评估和比较两种不同矩量法(MoM)系统矩阵在一维问题中作为波数 $k$ 的函数的条件数。一个矩阵使用标准的分段常数基生成，而另一个矩阵使用包含预期高频振荡行为的混合基生成。\n\n问题的核心在于 Galerkin 矩阵元素的数值近似，这些元素由双重积分定义。策略包括以下步骤：\n1.  按照规定定义几何、核函数和基函数。\n2.  为标准基和混合基制定矩阵元素的积分表达式。\n3.  使用高斯-勒让德求积法离散化积分。\n4.  实现一个算法，为每个给定的波数 $k$ 组装矩阵 $A(k)$ 和 $A^{\\mathrm{H}}(k,\\theta_0)$。\n5.  使用奇异值分解(SVD)计算每个组装矩阵的 2-范数条件数 $\\kappa_2$。\n\n**1. 数学公式**\n\n问题设置在一个长度为 $L=1$ 米的一维导体段上，由 $x \\in [-L/2, L/2]$ 参数化。该导体段上点 $x$ 和 $x'$ 之间的相互作用由高频渐近核描述：\n$$\nK_k(x,x') = \\sqrt{\\frac{2}{\\pi k |x-x'|}}\\, e^{i\\left(k |x-x'| - \\frac{\\pi}{4}\\right)}\n$$\n该核函数是亥姆霍兹方程格林函数在高频($k \\gg 1$)下行为的替代模型。\n\n导体段被离散为 $M$ 个单元，$I_n = [x_n, x_{n+1}]$，其中 $n=0, 1, \\dots, M-1$，每个单元的宽度为 $h = L/M$。单元边界为 $x_n = -L/2 + n h$。\n\n考虑两组基函数：\n- **标准基：** 分段常数函数，在 $L^2(I_n)$ 上归一化。\n$$\nb_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x)\n$$\n其中 $\\chi_{I_n}(x)$ 是单元 $I_n$ 的指示函数。\n- **混合基：** 由复相位因子调制的片断常数函数。该基函数旨在捕捉解的主要振荡行为，该行为被假定为由一个从 $\\theta_0$ 角度入射的平面波驱动。\n$$\nb^{\\mathrm{H}}_n(x) = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_n}(x) \\, e^{i k x \\cos\\theta_0}\n$$\n\n使用 Galerkin 方法，其中测试函数是基函数的复共轭，我们得到矩阵元素。\n\n对于标准基，测试函数 $b_m(x)$ 是实数。矩阵元素为：\n$$\nA_{mn}(k) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} K_k(x,x') b_m(x) b_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x' = \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n$$\n\n对于混合基，测试函数是 $\\overline{b^{\\mathrm{H}}_m(x)} = \\frac{1}{\\sqrt{h}} \\, \\chi_{I_m}(x) \\, e^{-i k x \\cos\\theta_0}$。矩阵元素为：\n$$\nA^{\\mathrm{H}}_{mn}(k,\\theta_0) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} K_k(x,x') \\overline{b^{\\mathrm{H}}_m(x)} b^{\\mathrm{H}}_n(x') \\, \\mathrm{d}x \\, \\mathrm{d}x' = \\frac{1}{h} \\int_{I_m} \\int_{I_n} K_k(x,x') e^{i k \\cos\\theta_0 (x' - x)} \\, \\mathrm{d}x \\, \\mathrm{d}x'\n$$\n问题指出，通过将 $|x-x'|$ 替换为 $\\max(|x-x'|, \\varepsilon)$，对核函数在 $x=x'$ 处的奇异性进行正则化，其中 $\\varepsilon=10^{-6}h$。\n\n**2. 通过求积进行数值离散化**\n\n定义矩阵元素的双重积分通过高斯-勒让德求积法进行数值计算。对于单元 $I_m$ 和 $I_n$ 上的一个泛型双重积分：\n$$\nJ = \\int_{I_m} \\int_{I_n} f(x,x') \\, \\mathrm{d}x \\, \\mathrm{d}x'\n$$\n我们进行变量替换，将每个单元映射到标准区间 $[-1,1]$。令 $x = x_m^c + \\frac{h}{2}\\xi$ 和 $x' = x_n^c + \\frac{h}{2}\\eta$，其中 $x_m^c$ 和 $x_n^c$ 是单元 $I_m$ 和 $I_n$ 的中心。则 $\\mathrm{d}x = \\frac{h}{2}\\mathrm{d}\\xi$ 和 $\\mathrm{d}x' = \\frac{h}{2}\\mathrm{d}\\eta$。积分变为：\n$$\nJ = \\frac{h^2}{4} \\int_{-1}^{1} \\int_{-1}^{1} f\\left(x_m^c + \\frac{h}{2}\\xi, x_n^c + \\frac{h}{2}\\eta\\right) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n应用一个在 $[-1,1]$ 上有节点 $\\xi_i$ 和权重 $w_i$ 的 $N_q$ 点高斯-勒让德求积法则，我们将该积分近似为：\n$$\nJ \\approx \\frac{h^2}{4} \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i w_j f(x_m^{(i)}, x_n^{(j)})\n$$\n其中 $x_m^{(i)} = x_m^c + \\frac{h}{2}\\xi_i$ 和 $x_n^{(j)} = x_n^c + \\frac{h}{2}\\eta_j$ 分别是单元 $I_m$ 和 $I_n$ 内的求积节点。\n\n将此应用于我们的矩阵元素（并包括预因子 $1/h$）：\n$$\nA_{mn}(k) \\approx \\frac{h}{4} \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i w_j K_k(x_m^{(i)}, x_n^{(j)})\n$$\n$$\nA^{\\mathrm{H}}_{mn}(k,\\theta_0) \\approx \\frac{h}{4} \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i w_j K_k(x_m^{(i)}, x_n^{(j)}) e^{i k \\cos\\theta_0 (x_n^{(j)} - x_m^{(i)})}\n$$\n在这些求和中使用了正则化后的核函数 $K_k$。\n\n**3. 条件数计算**\n\n一旦 $M \\times M$ 矩阵 $A(k)$ 和 $A^{\\mathrm{H}}(k, \\theta_0)$ 组装完毕，就计算它们的 2-范数条件数。条件数定义为最大奇异值与最小奇异值的比值：\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)}\n$$\n标准数值线性代数库提供高效且稳定的算法（基于 SVD）来计算此值。\n\n**4. 算法摘要**\n\n对于每个测试案例的波数 $k$，总算法流程如下：\n1.  初始化常数：$L=1$, $M=12$, $N_q=6$, $\\theta_0=\\pi/3$。\n2.  计算派生参数：$h=L/M$, $\\varepsilon=10^{-6}h$。\n3.  获取区间 $[-1,1]$ 上的 $N_q$ 个高斯-勒让德求积节点 $\\xi_i$ 和权重 $w_i$。\n4.  确定 $M$ 个单元中每个单元的中心坐标。\n5.  预先计算所有单元中所有求积点的全局坐标。\n6.  初始化两个 $M \\times M$ 的复值矩阵 $A$ 和 $A^{\\mathrm{H}}$，元素为零。\n7.  对 $m,n \\in \\{0, \\dots, M-1\\}$ 遍历每个矩阵元素 $(m,n)$：\n    a. 创建对应于单元 $I_m$ 和 $I_n$ 的求积点 $(x, x')$ 的二维网格。\n    b. 在所有求积点对上，使用正则化核函数计算 $A_{mn}$ 和 $A^{\\mathrm{H}}_{mn}$ 的被积函数值。\n    c. 计算由求积权重加权的双重求和，以近似积分。\n    d. 将结果赋给 $A_{mn}$ 和 $A^{\\mathrm{H}}_{mn}$。\n8.  矩阵完全组装后，计算它们的条件数 $\\kappa_2(A)$ 和 $\\kappa_2(A^{\\mathrm{H}})$。\n9.  存储得到的两个条件数。\n\n对所有指定的 $k$ 值重复此过程，并将结果汇总到单个列表中以供输出。预期 $\\kappa_2(A)$ 将随 $k$ 显著增长，而 $\\kappa_2(A^{\\mathrm{H}})$ 将表现出更温和的增长，这证明了混合基在稳定高频数值系统方面的有效性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Constructs and compares MoM system matrices for a 1D conductor,\n    quantifying the effect of a hybrid phase-embedded basis on the\n    matrix condition number as a function of wavenumber k.\n    \"\"\"\n    # Define the test cases and fixed parameters from the problem statement.\n    L = 1.0  # meters\n    M = 12\n    N_q = 6\n    theta_0 = np.pi / 3  # radians\n    k_vals = [5.0, 20.0, 100.0, 200.0]  # radians per meter\n\n    # Derived parameters\n    h = L / M\n    eps = 1e-6 * h\n    cos_theta_0 = np.cos(theta_0)\n\n    # Get Gauss-Legendre quadrature points and weights for the interval [-1, 1]\n    # Using scipy as specified in the problem environment.\n    xi, w = roots_legendre(N_q)\n\n    # Define cell center coordinates for the M uniform cells on [-L/2, L/2]\n    cell_indices = np.arange(M)\n    cell_centers = -L / 2 + (cell_indices + 0.5) * h\n\n    # Pre-calculate the global coordinates of quadrature points for each cell\n    # quad_points_per_cell[m, i] is the i-th quadrature point in cell m\n    quad_points_per_cell = cell_centers[:, np.newaxis] + (h / 2) * xi[np.newaxis, :]\n\n    results = []\n\n    # Loop over each wavenumber test case\n    for k in k_vals:\n        # Initialize the M x M system matrices with complex zeros\n        A = np.zeros((M, M), dtype=complex)\n        A_H = np.zeros((M, M), dtype=complex)\n\n        # Loop over matrix row (m) and column (n) indices to assemble entries\n        for m in range(M):\n            for n in range(M):\n                # Get the sets of quadrature points for cells m and n\n                x_vals = quad_points_per_cell[m, :]\n                xp_vals = quad_points_per_cell[n, :]\n\n                # Create 2D grids of points (x, x') for the double integral\n                # 'ij' indexing ensures X varies with the first index, XP with the second\n                X, XP = np.meshgrid(x_vals, xp_vals, indexing='ij')\n\n                # Calculate the distance |x - x'| and apply regularization\n                dist = np.abs(X - XP)\n                reg_dist = np.maximum(dist, eps)\n\n                # Evaluate the kernel K_k(x, x') at all quadrature point pairs\n                kernel_phase = 1j * (k * reg_dist - np.pi / 4)\n                kernel_mag = np.sqrt(2 / (np.pi * k * reg_dist))\n                kernel_vals = kernel_mag * np.exp(kernel_phase)\n\n                # Create a 2D grid of quadrature weights w_i * w_j\n                W_grid = np.outer(w, w)\n\n                # Calculate the matrix entry for A(k) using numerical quadrature\n                # The integral is approx. sum(weights * integrand_vals)\n                # The total prefactor is (1/h) * (h/2) * (h/2) = h/4\n                A[m, n] = (h / 4) * np.sum(W_grid * kernel_vals)\n\n                # Calculate the additional phase factor for the hybrid basis matrix A_H\n                hybrid_phase_factor = np.exp(1j * k * cos_theta_0 * (XP - X))\n                \n                # Calculate the matrix entry for A_H(k, theta_0)\n                integrand_H = kernel_vals * hybrid_phase_factor\n                A_H[m, n] = (h / 4) * np.sum(W_grid * integrand_H)\n\n        # Compute the 2-norm condition numbers of the assembled matrices\n        cond_A = np.linalg.cond(A)\n        cond_A_H = np.linalg.cond(A_H)\n        \n        # Append results for the current k\n        results.extend([cond_A, cond_A_H])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}