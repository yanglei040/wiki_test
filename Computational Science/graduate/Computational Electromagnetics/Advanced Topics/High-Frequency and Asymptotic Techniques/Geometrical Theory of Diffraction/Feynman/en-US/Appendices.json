{
    "hands_on_practices": [
        {
            "introduction": "The Geometrical Theory of Diffraction (GTD) is built upon the concept of rays, which follow paths dictated by Fermat's principle of stationary optical path length. Before embarking on the complex task of calculating field amplitudes, a fundamental question arises: for a given configuration of sources, observers, and scatterers, how many distinct ray paths exist? This practice  introduces Morse theory, a powerful tool from differential topology, to provide a rigorous answer. By analyzing the topology of the spaces over which ray paths are defined, you will learn to predict the minimum number of diffraction paths, offering profound insight into the geometric structure of the high-frequency field.",
            "id": "3311727",
            "problem": "An infinite, perfectly electrically conducting, zero-thickness planar screen occupies the plane $z=0$ and contains two disjoint, identical circular apertures of radius $a$, with centers at $\\mathbf{c}_{1}=\\left(-\\frac{d}{2},0,0\\right)$ and $\\mathbf{c}_{2}=\\left(\\frac{d}{2},0,0\\right)$, where $a>0$ and $d>2a$. A time-harmonic point source at $\\mathbf{S}=(0,0,h)$ with $h>0$ and an observation point at $\\mathbf{R}=(0,0,-H)$ with $H>0$ are located on opposite sides of the screen. The direct geometrical-optics ray is blocked by the opaque screen. In the high-frequency limit underlying the Geometrical Theory of Diffraction (GTD), significant contributions to the field at $\\mathbf{R}$ arise from stationary points of optical path functions (Fermat’s principle) defined over families of admissible broken rays constrained to interact with the aperture rims (treated locally as canonical edge diffractors).\n\nConsider only the following admissible families of broken rays, with no specular reflections and no more than one interaction with each aperture rim:\n\n- Single-edge families: rays that leave $\\mathbf{S}$, undergo a single edge interaction at the rim of aperture $i\\in\\{1,2\\}$, and then reach $\\mathbf{R}$.\n- Double-edge families: rays that leave $\\mathbf{S}$, undergo an edge interaction at the rim of aperture $i\\in\\{1,2\\}$, then an edge interaction at the other rim $j\\neq i$, and then reach $\\mathbf{R}$.\n\nUnder the standard GTD assumption that edge interactions are localized at a point on the rim and that the optical path function $L$ for each family is the Euclidean path length of the corresponding broken ray, the parameter space of each single-edge family is the rim circle $S^{1}$ of the corresponding aperture, and the parameter space of each ordered double-edge family is the Cartesian product $S^{1}\\times S^{1}$ of the two rim circles. Assume that, for generic positions of $\\mathbf{S}$ and $\\mathbf{R}$ as specified, the restriction of $L$ to each parameter manifold is a Morse function (all stationary points are nondegenerate).\n\nStarting from Fermat’s principle (stationarity of $L$ along contributing rays) and the basic framework of Morse theory on compact manifolds (in particular, the Morse inequalities relating counts of critical points to Betti numbers), determine the minimal total number of nondegenerate stationary points of $L$ across the union of the four disjoint parameter manifolds corresponding to the two single-edge families and the two ordered double-edge families. Interpret this number as the predicted count of significant ray-diffraction paths that must exist before any explicit ray tracing. Provide your final answer as a single integer (no units).",
            "solution": "The problem requires determining the minimum total number of stationary points for the optical path length function $L$ over four distinct parameter manifolds. According to Fermat's principle, physical ray paths correspond to stationary points of the optical path length function. The problem states that the path length function $L$, when restricted to each parameter manifold, is a Morse function.\n\nFor a Morse function $f$ defined on a compact, boundaryless manifold $M$, the Morse inequalities provide a lower bound on the number of critical points. Specifically, the weak Morse inequalities state that the number of critical points of index $\\lambda$, denoted $c_\\lambda(f)$, must be at least as large as the $\\lambda$-th Betti number of the manifold, $b_\\lambda(M)$:\n$$c_\\lambda(f) \\ge b_\\lambda(M)$$\nThe total number of critical points is $C = \\sum_{\\lambda} c_\\lambda(f)$. Consequently, the minimum possible number of critical points for any Morse function on $M$ is the sum of the Betti numbers of the manifold:\n$$C_{min} = \\sum_{\\lambda} b_\\lambda(M)$$\nWe must apply this principle to each of the four specified parameter manifolds and sum the results, as the manifolds are disjoint.\n\n1.  **Single-Edge Diffraction Families**\n    There are two such families, one for each aperture. The ray path is $\\mathbf{S} \\rightarrow P_i \\rightarrow \\mathbf{R}$, where $P_i$ is a point on the rim of aperture $i \\in \\{1, 2\\}$.\n    *   **Parameter Manifold:** For each family, the point of diffraction $P_i$ can be any point on the corresponding aperture rim. The rim is a circle, which is topologically equivalent to $S^1$. Thus, the parameter manifold for each of the two single-edge families is $M_{S1} = S^1$ and $M_{S2} = S^1$.\n    *   **Betti Numbers for $S^1$:** The Betti numbers for a circle are:\n        *   $b_0(S^1) = 1$ (it is path-connected).\n        *   $b_1(S^1) = 1$ (it has one \"hole\").\n        *   $b_k(S^1) = 0$ for $k > 1$.\n    *   **Minimum Number of Stationary Points:** The minimum number of stationary points for a Morse function on $S^1$ is the sum of its Betti numbers:\n        $$N_{min}(S^1) = b_0(S^1) + b_1(S^1) = 1 + 1 = 2$$\n    This corresponds to at least one local minimum and one local maximum of the path length function on the circle.\n    Since there are two such single-edge diffraction families (one for each aperture), the total minimal contribution from these is $2 + 2 = 4$.\n\n2.  **Double-Edge Diffraction Families**\n    There are two ordered families of this type: $\\mathbf{S} \\rightarrow P_1 \\rightarrow P_2 \\rightarrow \\mathbf{R}$ (path $1 \\rightarrow 2$) and $\\mathbf{S} \\rightarrow P_2 \\rightarrow P_1 \\rightarrow \\mathbf{R}$ (path $2 \\rightarrow 1$). Here, $P_1$ is a point on the rim of aperture $1$ and $P_2$ is a point on the rim of aperture $2$.\n    *   **Parameter Manifold:** For the ordered family $1 \\rightarrow 2$, the pair of diffraction points $(P_1, P_2)$ can be chosen independently from the two rims. The parameter space is therefore the Cartesian product of the two circles, which is a $2$-torus: $M_{12} = S^1 \\times S^1 = T^2$. The same applies to the ordered family $2 \\rightarrow 1$, so $M_{21} = S^1 \\times S^1 = T^2$.\n    *   **Betti Numbers for $T^2$:** The Betti numbers for the $2$-torus can be calculated using the Künneth formula for the homology of a product space, $b_k(X \\times Y) = \\sum_{i+j=k} b_i(X)b_j(Y)$. With $X=Y=S^1$:\n        *   $b_0(T^2) = b_0(S^1)b_0(S^1) = 1 \\cdot 1 = 1$.\n        *   $b_1(T^2) = b_1(S^1)b_0(S^1) + b_0(S^1)b_1(S^1) = (1 \\cdot 1) + (1 \\cdot 1) = 2$.\n        *   $b_2(T^2) = b_1(S^1)b_1(S^1) = 1 \\cdot 1 = 1$.\n        *   $b_k(T^2) = 0$ for $k > 2$.\n    *   **Minimum Number of Stationary Points:** The minimum number of stationary points for a Morse function on $T^2$ is the sum of its Betti numbers:\n        $$N_{min}(T^2) = b_0(T^2) + b_1(T^2) + b_2(T^2) = 1 + 2 + 1 = 4$$\n    This corresponds to at least one local minimum (index $0$), two saddle points (index $1$), and one local maximum (index $2$).\n    Since there are two such double-edge diffraction families (one for the order $1 \\rightarrow 2$ and one for $2 \\rightarrow 1$), the total minimal contribution from these is $4 + 4 = 8$.\n\n3.  **Total Minimal Number of Stationary Points**\n    The total minimal number of GTD ray paths is the sum of the minimal numbers for each of the four disjoint parameter manifolds:\n    $$N_{total} = N_{min}(M_{S1}) + N_{min}(M_{S2}) + N_{min}(M_{12}) + N_{min}(M_{21})$$\n    $$N_{total} = (2) + (2) + (4) + (4)$$\n    $$N_{total} = 12$$\nThis result, derived from Morse theory, provides a powerful a priori prediction. It guarantees that for any generic placement of the source and observer, at least $12$ distinct diffraction paths of the specified types must exist, purely based on the topology of the problem's configuration space.",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "Canonical GTD formulations achieve their elegance and simplicity by modeling scatterers with idealized geometries, such as infinitely sharp edges. However, real-world objects always possess some degree of rounding, raising a critical question for any practical application: when is the sharp-edge approximation valid? This exercise  tackles this issue head-on by guiding you through a scaling analysis of the wave equation near a curved surface. You will derive a quantitative criterion based on the dimensionless product $k\\rho$, where $k$ is the wavenumber and $\\rho$ is the rounding radius, to distinguish the regime where sharp-edge diffraction dominates from the one where surface creeping waves become the essential physical mechanism.",
            "id": "3311702",
            "problem": "You will examine the high-frequency scattering from a perfectly electrically conducting object featuring a locally rounded edge with radius of curvature $\\rho$, and quantify when the sharp-edge approximation of the Geometrical Theory of Diffraction (GTD) remains valid versus when surface or creeping-wave phenomena dominate. Work in the high-frequency regime where $k\\rho$ may vary from small to large, and use a scalar high-frequency approximation as the starting point.\n\nTask A (derivation): Begin from the scalar Helmholtz equation $\\nabla^2 u + k^2 u = 0$ as the high-frequency reduction of Maxwell’s equations under a single-polarization assumption, together with a perfect conductor boundary condition at the surface. In a local orthogonal coordinate system $(s,n)$ attached to the rounded edge (with $s$ the arclength along the edge and $n$ the outward normal), use the standard high-frequency asymptotic reduction that factors out the rapid phase along the tangent and leads to a parabolic wave equation governing the boundary-layer field near a convex surface segment of curvature $\\kappa = 1/\\rho$. By performing a dominant-balance scaling analysis on that parabolic equation, derive the scaling of the boundary-layer thickness $\\delta$ normal to the surface in terms of $k$ and $\\rho$. Then construct a dimensionless figure of merit $\\eta \\equiv \\delta/\\rho$ that compares the field’s normal extent to the rounding radius. From the condition on $\\eta$ expressing that the wave cannot resolve the rounding, deduce a simple inequality involving only the combination $k\\rho$ that separates the regime where sharp-edge GTD diffraction coefficients remain asymptotically valid from the regime where creeping waves dominate. State clearly which side of that inequality corresponds to the sharp-edge-valid regime.\n\nTask B (computational evaluation): Implement a program that, for each test case listed below, computes:\n- the free-space wavenumber $k = 2\\pi f / c$, where $c = 299\\,792\\,458\\,\\text{m/s}$,\n- the boundary-layer thickness $\\delta$ in meters,\n- the dimensionless ratio $\\eta = \\delta/\\rho$,\n- the dimensionless product $k\\rho$,\n- a boolean flag `sharp_edge_valid` that is `True` if the derived inequality indicates the sharp-edge GTD coefficients are valid and `False` otherwise.\n\nAll physical quantities must be expressed in International System of Units (SI). Frequencies are in hertz, lengths in meters, and $k$ in radians per meter. No angles beyond the arclength coordinate are required, but if any appear they must be in radians. For numerical output, round $\\delta$, $\\eta$, and $k\\rho$ to 6 decimal places.\n\nTest suite (each pair is frequency $f$ in hertz and rounding radius $\\rho$ in meters):\n- Case 1: $f = 3.0\\times 10^9$, $\\rho = 1.0\\times 10^{-3}$.\n- Case 2: $f = 3.0\\times 10^9$, $\\rho = 1/k$ for that $f$ (that is, choose $\\rho$ so that $k\\rho = 1$ exactly for this case).\n- Case 3: $f = 3.0\\times 10^9$, $\\rho = 1.0\\times 10^{-1}$.\n- Case 4: $f = 3.0\\times 10^{10}$, $\\rho = 2.0\\times 10^{-3}$.\n- Case 5: $f = 3.0\\times 10^{11}$, $\\rho = 1.0\\times 10^{-5}$.\n\nFinal output format: Your program should produce a single line of output containing a list of results, one per test case, where each result is the list `[delta, eta, k*rho, sharp_edge_valid]` with the first three entries rounded to 6 decimals and the last entry a boolean. The outer list must be a comma-separated list enclosed in square brackets, and each inner list must also be comma-separated and enclosed in square brackets, for example\n`[[delta_1, eta_1, krho_1, True], [delta_2, eta_2, krho_2, False], ...]`.",
            "solution": "The problem is scientifically grounded in the principles of high-frequency wave propagation and diffraction theory, is well-posed with a clear objective, and is free from any contradictions or ambiguities. The solution is divided into the derivation (Task A) and computational implementation (Task B).\n\n### Task A: Derivation\n\nThe analysis begins with the scalar Helmholtz equation, $\\nabla^2 u + k^2 u = 0$, which describes the spatial variation of a time-harmonic scalar field $u$ in a source-free region. Here, $k$ is the free-space wavenumber. We consider the scattering of a high-frequency wave ($k \\to \\infty$) from a perfectly conducting object with a locally rounded edge characterized by a radius of curvature $\\rho$.\n\nTo analyze the field in the immediate vicinity of the curved surface, we employ a local coordinate system $(s, n)$, where $s$ is the arclength along the surface in the direction of wave propagation and $n$ is the normal distance from the surface. In the high-frequency limit, the field that grazes the surface can be represented by the ansatz $u(s, n) = V(s, n) e^{iks}$, where $V(s, n)$ is an amplitude function that varies slowly with $s$ compared to the rapid phase oscillation $e^{iks}$. Substituting this form into the Helmholtz equation expressed in these curvilinear coordinates and applying the paraxial approximation (i.e., neglecting $\\partial^2 V / \\partial s^2$ compared to $k \\partial V / \\partial s$) yields the standard parabolic wave equation (PWE), also known as the Leontovich-Fock equation. This equation governs the behavior of the field $V$ within a thin boundary layer near the surface:\n$$\ni \\frac{\\partial V}{\\partial s} + \\frac{1}{2k} \\frac{\\partial^2 V}{\\partial n^2} + k \\frac{n}{\\rho} V = 0\n$$\nHere, $\\rho$ is the local radius of curvature of the surface. This equation captures the competing effects of diffraction in the normal direction (the $\\partial^2 V / \\partial n^2$ term) and the effect of surface curvature, which tends to cause the wave to shed energy tangentially (the $k(n/\\rho)V$ term).\n\nTo determine the characteristic thickness of the boundary layer, denoted by $\\delta$, we perform a dominant-balance scaling analysis on the PWE. The thickness $\\delta$ is the length scale over which $V$ varies significantly in the $n$ direction. Thus, we can approximate the orders of magnitude of the terms in the equation. The structure of the boundary layer is determined by the balance between the normal diffusion (diffraction) term and the curvature term, as these effects dictate how the field is confined near the surface. The term involving propagation along the surface, $\\partial V / \\partial s$, describes the evolution of this layer structure but not the structure itself. Therefore, we balance the second and third terms:\n$$\n\\frac{1}{2k} \\frac{\\partial^2 V}{\\partial n^2} \\sim -k \\frac{n}{\\rho} V\n$$\nIntroducing the characteristic scale $n \\sim \\delta$, we can write the scaling relationship for the magnitudes of these terms:\n$$\n\\frac{1}{k \\delta^2} \\sim \\frac{k\\delta}{\\rho}\n$$\nSolving this relation for $\\delta^3$ gives:\n$$\n\\delta^3 \\sim \\frac{\\rho}{k^2}\n$$\nFrom this, we deduce the scaling for the boundary-layer thickness $\\delta$. We define $\\delta$ based on this scaling as:\n$$\n\\delta = \\left(\\frac{\\rho}{k^2}\\right)^{1/3}\n$$\nThis expression shows how the extent of the near-surface field depends on both the local geometry ($\\rho$) and the wavelength ($k = 2\\pi/\\lambda$).\n\nNext, we define the dimensionless figure of merit $\\eta$ as the ratio of the boundary-layer thickness to the radius of curvature:\n$$\n\\eta \\equiv \\frac{\\delta}{\\rho}\n$$\nSubstituting our expression for $\\delta$, we can express $\\eta$ in terms of the dimensionless product $k\\rho$:\n$$\n\\eta = \\frac{(\\rho/k^2)^{1/3}}{\\rho} = \\frac{\\rho^{1/3}}{k^{2/3}\\rho} = \\rho^{1/3-1} k^{-2/3} = \\rho^{-2/3} k^{-2/3} = (k\\rho)^{-2/3}\n$$\n\nThe final step is to determine the condition for the validity of the sharp-edge Geometrical Theory of Diffraction (GTD) approximation. The sharp-edge GTD model assumes an ideal edge with zero radius of curvature ($\\rho=0$). This approximation remains valid for a slightly rounded edge if the incident wave \"cannot resolve the rounding.\" This occurs when the characteristic length scale of the boundary-layer phenomenon, $\\delta$, is much larger than the length scale of the geometric feature itself, $\\rho$. If $\\delta \\gg \\rho$, the field structure is too coarse to perceive the details of the curvature, and the rounded edge effectively behaves as a singular sharp edge. The condition is therefore:\n$$\n\\delta \\gg \\rho \\implies \\frac{\\delta}{\\rho} \\gg 1 \\implies \\eta \\gg 1\n$$\nSubstituting our expression for $\\eta$:\n$$\n(k\\rho)^{-2/3} \\gg 1\n$$\nTaking both sides to the power of $-3/2$ reverses the inequality:\n$$\nk\\rho \\ll 1\n$$\nThis inequality provides the criterion to distinguish between the two diffraction regimes. The regime where the sharp-edge GTD coefficients are asymptotically valid corresponds to the case where the radius of curvature is small compared to the wavelength. For the purpose of a computational test, we can replace the \"much less than\" symbol ($\\ll$) with \"less than\" ($<$).\n\n**Regime Classification:**\n1.  **Sharp-Edge-Valid Regime:** This regime holds when $k\\rho < 1$. The rounding is small compared to the wavelength, and standard sharp-edge GTD coefficients can be used as a good approximation.\n2.  **Creeping-Wave Regime:** This regime holds when $k\\rho \\ge 1$. The rounding is comparable to or larger than the wavelength. The curvature is significant, and the field is better described by creeping waves \"attached\" to the surface, requiring a more complex analysis (e.g., using Fock functions or uniform asymptotic theories).\n\nThe algorithm for Task B will therefore compute $k$, $\\rho$, $k\\rho$, $\\delta$, and $\\eta$ for each test case and apply the criterion $k\\rho < 1$ to set the boolean flag.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of determining the diffraction regime for a rounded edge.\n\n    This function iterates through a set of test cases, each defined by a frequency 'f'\n    and a radius of curvature 'rho'. For each case, it calculates:\n    - k: The free-space wavenumber.\n    - delta: The boundary-layer thickness.\n    - eta: The dimensionless ratio of delta to rho.\n    - kp: The dimensionless product k*rho.\n    - sharp_edge_valid: A boolean flag indicating if the sharp-edge GTD\n      approximation is valid based on the derived criterion kp < 1.\n\n    The results are formatted and printed as a single-line string, which is a list\n    of lists, as specified in the problem statement.\n    \"\"\"\n    # Define the speed of light in vacuum (m/s) as per the problem statement.\n    c = 299792458.0\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (frequency in Hz, radius of curvature in m).\n    # Case 2 has a special value for rho, denoted by None.\n    test_cases = [\n        (3.0e9, 1.0e-3),\n        (3.0e9, None),  # For this case, rho is set such that k * rho = 1.\n        (3.0e9, 1.0e-1),\n        (3.0e10, 2.0e-3),\n        (3.0e11, 1.0e-5),\n    ]\n\n    # A list to store the formatted string for each case's results.\n    all_results_str = []\n\n    for f, rho_val in test_cases:\n        # Calculate the free-space wavenumber k (rad/m).\n        k = 2.0 * np.pi * f / c\n\n        # Determine the radius of curvature rho (m).\n        # Handle the special case where rho is defined by k*rho = 1.\n        if rho_val is None:\n            rho = 1.0 / k\n        else:\n            rho = rho_val\n\n        # Calculate the dimensionless product k*rho.\n        kp = k * rho\n\n        # Calculate the boundary-layer thickness delta (m).\n        # δ = (ρ / k^2)^(1/3)\n        # Using np.cbrt is numerically robust.\n        delta = np.cbrt(rho / (k**2))\n\n        # Calculate the dimensionless figure of merit eta.\n        # η = (kρ)^(-2/3)\n        # Handle the edge case kp=0 to avoid division by zero, although not present in tests.\n        eta = (kp)**(-2.0/3.0) if kp != 0 else float('inf')\n\n        # Determine the validity of the sharp-edge GTD approximation.\n        # The inequality derived is k*rho < 1.\n        sharp_edge_valid = kp < 1.0\n\n        # Format the numerical results to 6 decimal places as required.\n        delta_str = f\"{delta:.6f}\"\n        eta_str = f\"{eta:.6f}\"\n        kp_str = f\"{kp:.6f}\"\n\n        # Build the result string for the current case in the format [v1,v2,v3,Bool].\n        result_str = f\"[{delta_str},{eta_str},{kp_str},{sharp_edge_valid}]\"\n        all_results_str.append(result_str)\n\n    # Combine the results from all test cases into a single string and print.\n    # The final format is a list of lists: [[...], [...], ...].\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond the idealization of perfectly conducting surfaces is essential for modeling realistic electromagnetic scenarios, from radar-absorbing materials to natural terrains. This requires extending GTD to handle impedance boundary conditions, a task that introduces significant mathematical complexity. The exact solution for the canonical impedance wedge problem is famously expressed in terms of the Maliuzhinets function. This advanced practice  provides hands-on experience in numerically implementing a modern, FFT-based method to approximate this crucial special function for frequency-dispersive materials. Mastering this technique is a key step toward building sophisticated, broadband Uniform Theory of Diffraction (UTD) codes for real-world applications.",
            "id": "3311704",
            "problem": "Consider a two-dimensional wedge scattering problem in computational electromagnetics under the framework of the Geometrical Theory of Diffraction (GTD), extended to the Uniform Theory of Diffraction (UTD) for broadband response. The wedge has interior angle $2\\alpha$, with planar faces characterized by a Leontovich impedance boundary condition. A monochromatic plane wave of angular frequency $\\omega$ is incident onto the wedge, with incidence angle $\\varphi_i$ and observation angle $\\varphi_s$, both measured with respect to a fixed global reference axis and expressed in radians. The surface impedance is complex and frequency dependent, given by $\\zeta(\\omega)$.\n\nFundamental base:\n- The governing fields satisfy Maxwell's equations in free space. Under two-dimensional transverse electric polarization, the total scalar field $u(\\mathbf{r}, \\omega)$ satisfies the Helmholtz equation $\\nabla^2 u(\\mathbf{r}, \\omega) + k^2(\\omega) u(\\mathbf{r}, \\omega) = 0$, where $k(\\omega)$ is the free-space wavenumber, equal to $\\omega/c$ with $c$ the speed of light in vacuum. \n- The Leontovich impedance boundary condition on a locally planar face with outward unit normal $\\hat{\\mathbf{n}}$ is $\\partial u / \\partial n = i k(\\omega) \\zeta(\\omega) u$ (a scalar reduction of the vectorial condition for the considered polarization), where $\\partial / \\partial n$ is the normal derivative and $\\zeta(\\omega)$ is the normalized surface impedance (dimensionless with respect to free-space wave impedance).\n- For a plane wave interacting with a locally planar impedance boundary at an incidence angle $\\chi$ relative to the boundary normal, a frequency-dependent reflection coefficient can be modeled as $R(\\chi, \\omega) = \\dfrac{\\cos \\chi - i \\zeta(\\omega)}{\\cos \\chi + i \\zeta(\\omega)}$ (consistent with the Leontovich boundary condition under two-dimensional polarization).\n\nTask:\n1. Define the real function $u(\\theta; \\omega) = \\ln\\left| R_+(\\theta, \\omega) R_-(\\theta, \\omega) \\right|$ on the periodic angular domain $\\theta \\in [-\\pi, \\pi)$, where \n   - $R_+(\\theta, \\omega) = \\dfrac{\\cos(\\theta - \\alpha) - i \\zeta(\\omega)}{\\cos(\\theta - \\alpha) + i \\zeta(\\omega)}$ is the reflection coefficient for the wedge face whose outward normal is at angle $+\\alpha$ from the global axis,\n   - $R_-(\\theta, \\omega) = \\dfrac{\\cos(\\theta + \\alpha) - i \\zeta(\\omega)}{\\cos(\\theta + \\alpha) + i \\zeta(\\omega)}$ is the reflection coefficient for the wedge face whose outward normal is at angle $-\\alpha$ from the global axis.\n2. Construct a numerical scheme to approximate the Maliuzhinets spectral function $M(\\theta; \\omega)$ consistent with the wedge impedance response by spectral factorization through a periodic Hilbert transform. Specifically, find an approximation of $M(\\theta; \\omega)$ of the form\n   $$ M(\\theta; \\omega) \\approx \\exp\\left( u(\\theta; \\omega) + i\\, \\mathcal{H}[u](\\theta; \\omega) \\right), $$\n   where $\\mathcal{H}[\\cdot]$ denotes the periodic Hilbert transform on $2\\pi$-periodic functions. The periodic Hilbert transform must be implemented numerically by a Fast Fourier Transform-based method on an equispaced grid over $[-\\pi, \\pi)$.\n3. Using the constructed $M(\\theta; \\omega)$, define a normalized impedance wedge diffraction coefficient proxy for broadband UTD evaluation at the diffraction angle $\\theta_d = \\mathrm{wrap}_{[-\\pi,\\pi)}(\\varphi_s - \\varphi_i)$, given by the dimensionless scalar \n   $$ D_{\\mathrm{norm}}(\\omega) = \\left| M\\!\\left(\\theta_d; \\omega\\right) \\right|. $$\n   This quantity provides a frequency-dependent normalized measure of the diffraction weight attributable to the impedance wedge via the Maliuzhinets function in a broadband UTD context. Angles must be treated in radians, and $D_{\\mathrm{norm}}(\\omega)$ is dimensionless.\n\nThe surface impedance is specified by a single-pole dispersive model\n$$ \\zeta(\\omega) = \\zeta_{\\infty} + \\frac{\\zeta_0 - \\zeta_{\\infty}}{1 + i \\,\\omega/\\omega_c}, $$\nwhere $\\zeta_0, \\zeta_{\\infty}$ are real nonnegative constants and $\\omega_c$ is a positive angular cutoff frequency in radians per second. The function $\\mathrm{wrap}_{[-\\pi,\\pi)}(\\cdot)$ maps an angle to the interval $[-\\pi, \\pi)$ by adding or subtracting integer multiples of $2\\pi$.\n\nImplementation requirements:\n- Numerically implement $\\mathcal{H}[u]$ using a Fast Fourier Transform-based method with the frequency-domain multiplier $-i \\,\\mathrm{sign}(k)$, where $k$ is the integer Fourier mode index for a $2\\pi$-periodic function sampled on a uniform grid, and with the zero-frequency and Nyquist components set to zero.\n- Use a high-resolution equispaced grid in $\\theta$ over $[-\\pi, \\pi)$ to ensure numerical stability of the Hilbert transform and spectral factorization.\n- For each test case, compute $\\zeta(\\omega)$, build $u(\\theta; \\omega)$, compute $\\mathcal{H}[u](\\theta; \\omega)$, form $M(\\theta; \\omega)$, evaluate $M(\\theta_d; \\omega)$, and return $D_{\\mathrm{norm}}(\\omega)$.\n\nUnits and angle specification:\n- Angular frequency $\\omega$ must be in radians per second.\n- All angles, including $\\alpha$, $\\varphi_i$, $\\varphi_s$, and $\\theta_d$, must be in radians.\n- The output $D_{\\mathrm{norm}}(\\omega)$ is dimensionless.\n\nTest suite:\nCompute $D_{\\mathrm{norm}}(\\omega)$ for the following parameter sets, covering typical, low-frequency, high-frequency, grazing incidence, and highly lossy cases:\n- Case 1 (happy path): $\\alpha = \\pi/4$, $\\varphi_i = -0.7$, $\\varphi_s = 0.9$, $\\zeta_0 = 1.2$, $\\zeta_{\\infty} = 0.3$, $\\omega_c = 2\\pi \\times 3\\times 10^9$, $\\omega = 2\\pi \\times 5 \\times 10^9$.\n- Case 2 (low frequency edge): $\\alpha = \\pi/4$, $\\varphi_i = -0.7$, $\\varphi_s = 0.9$, $\\zeta_0 = 1.2$, $\\zeta_{\\infty} = 0.3$, $\\omega_c = 2\\pi \\times 3\\times 10^9$, $\\omega = 2\\pi \\times 1 \\times 10^6$.\n- Case 3 (high frequency edge): $\\alpha = \\pi/4$, $\\varphi_i = -0.7$, $\\varphi_s = 0.9$, $\\zeta_0 = 1.2$, $\\zeta_{\\infty} = 0.3$, $\\omega_c = 2\\pi \\times 3\\times 10^9$, $\\omega = 2\\pi \\times 50 \\times 10^9$.\n- Case 4 (grazing incidence near the $+\\alpha$ face): $\\alpha = \\pi/4$, $\\varphi_i = \\alpha - 0.01$, $\\varphi_s = 0.9$, $\\zeta_0 = 1.2$, $\\zeta_{\\infty} = 0.3$, $\\omega_c = 2\\pi \\times 3\\times 10^9$, $\\omega = 2\\pi \\times 5 \\times 10^9$.\n- Case 5 (highly lossy surface): $\\alpha = \\pi/4$, $\\varphi_i = -0.7$, $\\varphi_s = 0.9$, $\\zeta_0 = 5.0$, $\\zeta_{\\infty} = 5.0$, $\\omega_c = 2\\pi \\times 3\\times 10^9$, $\\omega = 2\\pi \\times 5 \\times 10^9$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above test cases, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_j$ is the computed dimensionless scalar $D_{\\mathrm{norm}}(\\omega)$ for case $j$.",
            "solution": "The problem is scientifically grounded in the principles of computational electromagnetics, is mathematically well-posed, and all necessary parameters and definitions are provided for a unique numerical solution. The task requires the computation of a normalized diffraction coefficient proxy for an impedance wedge, based on an approximate spectral factorization of the Maliuzhinets function.\n\nThe solution is implemented by following a sequence of steps derived from the problem description, rooted in established physical and numerical principles.\n\n1.  **Dispersive Impedance Calculation**: The first step is to calculate the complex, frequency-dependent normalized surface impedance $\\zeta(\\omega)$. The problem specifies a single-pole dispersive model, which is a common representation for materials in electromagnetics:\n    $$ \\zeta(\\omega) = \\zeta_{\\infty} + \\frac{\\zeta_0 - \\zeta_{\\infty}}{1 + i \\,\\omega/\\omega_c} $$\n    Here, $\\zeta_0$ and $\\zeta_{\\infty}$ represent the impedance at zero and infinite frequencies, respectively, and $\\omega_c$ is a characteristic cutoff frequency. For each test case, we compute the specific complex value of $\\zeta(\\omega)$ corresponding to the given angular frequency $\\omega$.\n\n2.  **Angular Domain Discretization**: To perform numerical Fourier analysis, the continuous angular domain $\\theta \\in [-\\pi, \\pi)$ is discretized into a high-resolution, equispaced grid. A power-of-two number of points, such as $N=4096$, is chosen to facilitate efficient computation using the Fast Fourier Transform (FFT) algorithm. The grid points are defined as $\\theta_j = -\\pi + j \\frac{2\\pi}{N}$ for $j=0, 1, \\dots, N-1$.\n\n3.  **Reflection Coefficient and Function Construction**: The problem defines a real-valued, $2\\pi$-periodic function $u(\\theta; \\omega)$. This function is constructed from the product of two reflection coefficients, $R_+(\\theta, \\omega)$ and $R_-(\\theta, \\omega)$, which model the interaction of a plane wave from direction $\\theta$ with each face of the wedge. The wedge faces have outward normals oriented at angles $+\\alpha$ and $-\\alpha$, respectively. The reflection coefficients are given by the standard formula for an impedance boundary:\n    $$ R_+(\\theta, \\omega) = \\dfrac{\\cos(\\theta - \\alpha) - i \\zeta(\\omega)}{\\cos(\\theta - \\alpha) + i \\zeta(\\omega)} $$\n    $$ R_-(\\theta, \\omega) = \\dfrac{\\cos(\\theta + \\alpha) - i \\zeta(\\omega)}{\\cos(\\theta + \\alpha) + i \\zeta(\\omega)} $$\n    The function $u(\\theta; \\omega)$ is then computed on the discrete angular grid:\n    $$ u(\\theta_j; \\omega) = \\ln\\left| R_+(\\theta_j, \\omega) R_-(\\theta_j, \\omega) \\right| $$\n    This function's magnitude is related to the energy reflected from the two faces and serves as the real part of a complex function to be reconstructed.\n\n4.  **Periodic Hilbert Transform for Spectral Factorization**: The core of the task is to approximate the Maliuzhinets spectral function, $M(\\theta; \\omega)$, using spectral factorization. This technique is based on the principle that for a function analytic in a strip containing the real axis, its real and imaginary parts are related by the Hilbert transform. The problem defines an approximation for $M(\\theta; \\omega)$ as:\n    $$ M(\\theta; \\omega) \\approx \\exp\\left( u(\\theta; \\omega) + i\\, \\mathcal{H}[u](\\theta; \\omega) \\right) $$\n    where $\\mathcal{H}[u]$ is the periodic Hilbert transform of $u$. This transform is numerically computed via the FFT. The convolution operation of the Hilbert transform becomes a multiplication in the Fourier domain. The procedure is as follows:\n    a. Compute the Discrete Fourier Transform (DFT) of the sampled function $u(\\theta_j)$: $U_k = \\mathrm{FFT}[u_j]$.\n    b. Multiply $U_k$ by the frequency-domain representation of the Hilbert transform operator, which is specified as $-i\\,\\mathrm{sign}(k)$, where $k$ is the integer Fourier mode index. The multiplier is set to zero for the DC ($k=0$) and Nyquist ($k=N/2$ for even $N$) components as instructed.\n    c. Compute the Inverse DFT of the result to obtain the Hilbert transform on the grid: $\\mathcal{H}[u]_j = \\mathrm{real}(\\mathrm{IFFT}[ U_k \\cdot (-i\\,\\mathrm{sign}(k)) ])$. Taking the real part discards negligible imaginary components arising from numerical floating-point inaccuracies.\n\n5.  **Evaluation of the Diffraction Coefficient Proxy**: With the approximation for $M(\\theta; \\omega)$ constructed on the angular grid, the final step is to evaluate it at the specific diffraction angle $\\theta_d$. This angle is determined by the source and observer locations, $\\varphi_i$ and $\\varphi_s$:\n    $$ \\theta_d = \\mathrm{wrap}_{[-\\pi,\\pi)}(\\varphi_s - \\varphi_i) $$\n    The $\\mathrm{wrap}_{[-\\pi,\\pi)}(\\cdot)$ function maps the angle into the principal interval $[-\\pi, \\pi)$ by adding or subtracting integer multiples of $2\\pi$. Since $\\theta_d$ will generally not coincide with a grid point, linear interpolation is used to find the value of $M(\\theta_d; \\omega)$ from the computed grid values. The real and imaginary parts of $M(\\theta_j; \\omega)$ are interpolated separately. Finally, the dimensionless normalized diffraction coefficient proxy, $D_{\\mathrm{norm}}(\\omega)$, is calculated as the magnitude of this interpolated complex value:\n    $$ D_{\\mathrm{norm}}(\\omega) = \\left| M(\\theta_d; \\omega) \\right| $$\nThis procedure is systematically applied to each of the five test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the impedance wedge diffraction problem for all test cases.\n    \"\"\"\n\n    def calculate_d_norm(alpha, phi_i, phi_s, zeta_0, zeta_inf, omega_c, omega):\n        \"\"\"\n        Calculates the normalized diffraction coefficient proxy for a single parameter set.\n\n        Args:\n            alpha (float): Half of the wedge interior angle in radians.\n            phi_i (float): Incidence angle in radians.\n            phi_s (float): Observation angle in radians.\n            zeta_0 (float): DC surface impedance component.\n            zeta_inf (float): Infinite-frequency surface impedance component.\n            omega_c (float): Cutoff angular frequency for impedance model in rad/s.\n            omega (float): Angular frequency of the incident wave in rad/s.\n\n        Returns:\n            float: The dimensionless scalar D_norm(omega).\n        \"\"\"\n        # Number of points for the angular grid. A power of 2 for FFT efficiency.\n        N = 4096\n\n        # Step 1: Calculate the complex surface impedance zeta(omega).\n        zeta = zeta_inf + (zeta_0 - zeta_inf) / (1.0 + 1j * omega / omega_c)\n\n        # Step 2: Define a high-resolution, equispaced grid in theta over [-pi, pi).\n        theta = np.linspace(-np.pi, np.pi, N, endpoint=False)\n\n        # Step 3: Calculate the reflection coefficients R+ and R- on the grid.\n        # The denominators are non-zero since the real part of zeta is non-negative.\n        cos_theta_minus_alpha = np.cos(theta - alpha)\n        cos_theta_plus_alpha = np.cos(theta + alpha)\n        \n        R_plus = (cos_theta_minus_alpha - 1j * zeta) / (cos_theta_minus_alpha + 1j * zeta)\n        R_minus = (cos_theta_plus_alpha - 1j * zeta) / (cos_theta_plus_alpha + 1j * zeta)\n\n        # Step 4: Construct the real function u(theta; omega).\n        # We add a small epsilon to the argument of log to avoid log(0) in edge cases,\n        # though it's not expected here given the physics.\n        u_theta = np.log(np.abs(R_plus * R_minus))\n\n        # Step 5: Compute the periodic Hilbert transform of u(theta) using FFT.\n        # a. FFT of the input signal\n        U_k = np.fft.fft(u_theta)\n\n        # b. Define the frequency-domain multiplier (-i * sign(k)).\n        # np.fft.fftfreq provides the correct frequency bins for the multiplier.\n        freqs = np.fft.fftfreq(N)\n        multiplier = -1j * np.sign(freqs)\n        \n        # c. Set the Nyquist component to zero for even N as per problem specification.\n        if N % 2 == 0:\n            multiplier[N // 2] = 0\n\n        # d. Apply the multiplier and perform inverse FFT. The result should be real.\n        H_u_theta = np.real(np.fft.ifft(U_k * multiplier))\n\n        # Step 6: Construct the Maliuzhinets function proxy M(theta; omega).\n        M_theta = np.exp(u_theta + 1j * H_u_theta)\n\n        # Step 7: Evaluate M at the diffraction angle theta_d.\n        # a. Calculate theta_d and wrap it to the interval [-pi, pi).\n        diffraction_angle = (phi_s - phi_i + np.pi) % (2 * np.pi) - np.pi\n        \n        # b. Interpolate the complex value M(theta) at theta_d.\n        # np.interp requires periodic boundary points for seamless wrapping. We append them.\n        theta_periodic = np.append(theta, np.pi)\n        M_real_periodic = np.append(np.real(M_theta), np.real(M_theta[0]))\n        M_imag_periodic = np.append(np.imag(M_theta), np.imag(M_theta[0]))\n\n        M_re_at_d = np.interp(diffraction_angle, theta_periodic, M_real_periodic)\n        M_im_at_d = np.interp(diffraction_angle, theta_periodic, M_imag_periodic)\n        M_at_diffraction_angle = M_re_at_d + 1j * M_im_at_d\n\n        # Step 8: Compute the final result, D_norm(omega).\n        d_norm = np.abs(M_at_diffraction_angle)\n        \n        return d_norm\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        {'alpha': np.pi/4, 'phi_i': -0.7, 'phi_s': 0.9, 'zeta_0': 1.2, 'zeta_inf': 0.3, 'omega_c': 2*np.pi*3e9, 'omega': 2*np.pi*5e9},\n        # Case 2 (low frequency edge)\n        {'alpha': np.pi/4, 'phi_i': -0.7, 'phi_s': 0.9, 'zeta_0': 1.2, 'zeta_inf': 0.3, 'omega_c': 2*np.pi*3e9, 'omega': 2*np.pi*1e6},\n        # Case 3 (high frequency edge)\n        {'alpha': np.pi/4, 'phi_i': -0.7, 'phi_s': 0.9, 'zeta_0': 1.2, 'zeta_inf': 0.3, 'omega_c': 2*np.pi*3e9, 'omega': 2*np.pi*50e9},\n        # Case 4 (grazing incidence near the +alpha face)\n        {'alpha': np.pi/4, 'phi_i': np.pi/4 - 0.01, 'phi_s': 0.9, 'zeta_0': 1.2, 'zeta_inf': 0.3, 'omega_c': 2*np.pi*3e9, 'omega': 2*np.pi*5e9},\n        # Case 5 (highly lossy surface)\n        {'alpha': np.pi/4, 'phi_i': -0.7, 'phi_s': 0.9, 'zeta_0': 5.0, 'zeta_inf': 5.0, 'omega_c': 2*np.pi*3e9, 'omega': 2*np.pi*5e9},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_d_norm(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}