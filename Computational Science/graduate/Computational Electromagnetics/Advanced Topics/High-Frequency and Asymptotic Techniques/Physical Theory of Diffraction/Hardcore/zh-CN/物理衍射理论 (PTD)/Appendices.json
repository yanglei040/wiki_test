{
    "hands_on_practices": [
        {
            "introduction": "物理衍射理论 (PTD) 的一个核心简化在于，它通常使用远场表达式来处理由物体边缘产生的辐射场。这个练习将通过一个基础的推导，帮助你亲手量化这种远场近似所引入的内在误差。通过分析一个直边缘段，你将推导出误差如何依赖于观察距离和几何/电气尺寸，这是理解 PTD 模型精度的关键一步，也是计算电磁学研究者必备的基本功。",
            "id": "3340614",
            "problem": "在物理衍射理论 (PTD) 中，一个被时谐平面波照射的完美导电楔会沿长度为 $L$ 的直边段产生等效边缘电流。考虑一个这样的直边段，其沿 $z$ 轴方向，从 $z=-L/2$ 延伸到 $z=L/2$。在自由空间中，频率为 $f$，波数为 $k=2\\pi f/c$（其中 $c$ 是光速），假设沿该边缘的等效边缘电流密度是均匀的，因此其未知的振幅因子在任何相对误差度量中都会被抵消。一个观测点位于 $x$ 轴上的 $(R,0,0)$ 处，其中 $R>0$。极化方式使得标量格林函数描述足以表示边缘的贡献。\n\n观测点处的场的精确标量边缘辐射积分可以写成自由空间格林函数沿边缘长度的积分。远场PTD表达式将格林函数中的精确距离因子替换为其远区近似，具体来说，对于这种正交观测几何结构，振幅中的 $\\left| \\mathbf{r} - \\mathbf{r}' \\right|$ 替换为 $R$，相位中的 $\\exp\\!\\left(-j k \\left| \\mathbf{r}-\\mathbf{r}' \\right|\\right)$ 替换为 $\\exp(-j k R)$。定义使用远场PTD表达式而非精确近场积分所产生的复分数误差为\n$$\n\\varepsilon \\equiv \\frac{E_{\\text{exact}} - E_{\\text{ff}}}{E_{\\text{ff}}},\n$$\n其中 $E_{\\text{exact}}$ 是由精确近场积分计算出的场，$E_{\\text{ff}}$ 是由远场PTD近似计算出的场，两者都是在相同的均匀边缘电流振幅下计算的，因此该振幅在 $\\varepsilon$ 中被抵消。\n\n从基于自由空间格林函数的辐射积分出发，仅使用在 $k R \\gg 1$ 和 $L/R \\ll 1$ 条件下有效的、经过充分检验的展开式，推导 $\\varepsilon$ 的一个主阶渐近估计，该估计保留所有项直到并包括 $L^{2}/R^{2}$ 阶和 $k L^{2}/R$ 阶。将你的最终结果表示为关于 $L$、$R$ 和 $k$ 的单个简化解析表达式。不需要进行数值计算。明确写出你关于 $\\varepsilon$ 的最终表达式。答案必须以无单位的闭式解析表达式给出。",
            "solution": "本问题要求计算使用远场近似来处理均匀线源辐射时所产生的复分数误差 $\\varepsilon$ 的主阶渐近估计。源是一个长度为 $L$、沿 $z$ 轴、以原点为中心的等效边缘电流。观测点位于 $x$ 轴上的 $(R, 0, 0)$ 处。\n\n首先，我们构建精确场 $E_{\\text{exact}}$ 和远场近似场 $E_{\\text{ff}}$ 的表达式。该问题使用标量格林函数处理。源位于 $\\mathbf{r}' = (0, 0, z')$，其中 $z' \\in [-L/2, L/2]$。观测点为 $\\mathbf{r} = (R, 0, 0)$。源点与观测点之间的距离为 $|\\mathbf{r} - \\mathbf{r}'| = \\sqrt{R^2 + z'^2}$。\n\n场正比于源密度乘以自由空间格林函数 $G(\\mathbf{r}, \\mathbf{r}') = \\frac{\\exp(-j k |\\mathbf{r}-\\mathbf{r}'|)}{4\\pi |\\mathbf{r}-\\mathbf{r}'|}$ 的积分。由于假定边缘电流密度是均匀的，其常数振幅因子 $I_0$ 可以并入一个比例常数 $C$ 中，该常数将在最终的比率中被抵消。\n\n精确场由以下辐射积分给出：\n$$\nE_{\\text{exact}} = C \\int_{-L/2}^{L/2} \\frac{\\exp(-j k \\sqrt{R^2 + z'^2})}{\\sqrt{R^2 + z'^2}} dz'\n$$\n\n问题指出，远场表达式 $E_{\\text{ff}}$ 是通过将格林函数中的振幅和相位项中的距离因子 $|\\mathbf{r} - \\mathbf{r}'|$ 都替换为 $R$ 得到的。这意味着被积函数相对于积分变量 $z'$ 成为一个常数。\n$$\nE_{\\text{ff}} = C \\int_{-L/2}^{L/2} \\frac{\\exp(-j k R)}{R} dz' = C \\frac{\\exp(-j k R)}{R} \\left[ z' \\right]_{-L/2}^{L/2} = C \\frac{L \\exp(-j k R)}{R}\n$$\n\n复分数误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon = \\frac{E_{\\text{exact}} - E_{\\text{ff}}}{E_{\\text{ff}}} = \\frac{E_{\\text{exact}}}{E_{\\text{ff}}} - 1\n$$\n代入场的表达式，常数 $C$ 被抵消：\n$$\n\\varepsilon = \\frac{R}{L \\exp(-j k R)} \\int_{-L/2}^{L/2} \\frac{\\exp(-j k \\sqrt{R^2 + z'^2})}{\\sqrt{R^2 + z'^2}} dz' - 1\n$$\n为了计算该式，我们需要找到积分的渐近近似。给定条件为 $k R \\gg 1$ 和 $L/R \\ll 1$。后一个条件意味着对于积分域中的任何 $z'$，都有 $|z'/R| \\le L/(2R) \\ll 1$。这允许我们对被积函数针对小的 $z'/R$ 进行泰勒级数展开。\n\n我们来展开被积函数中的各项。距离为 $d(z') = \\sqrt{R^2 + z'^2} = R\\sqrt{1 + (z'/R)^2}$。\n使用二项式展开 $(1+x)^a \\approx 1 + ax + \\dots$，我们展开 $d(z')$ 和 $1/d(z')$。\n$$\nd(z') = R \\left(1 + \\frac{z'^2}{R^2}\\right)^{1/2} \\approx R \\left(1 + \\frac{1}{2} \\frac{z'^2}{R^2}\\right) = R + \\frac{z'^2}{2R}\n$$\n这个近似用于相位项。对于振幅项，我们有：\n$$\n\\frac{1}{d(z')} = \\frac{1}{R} \\left(1 + \\frac{z'^2}{R^2}\\right)^{-1/2} \\approx \\frac{1}{R} \\left(1 - \\frac{1}{2} \\frac{z'^2}{R^2}\\right) = \\frac{1}{R} - \\frac{z'^2}{2R^3}\n$$\n相位因子为 $\\exp(-j k d(z')) \\approx \\exp\\left(-j k \\left(R + \\frac{z'^2}{2R}\\right)\\right) = \\exp(-j k R) \\exp\\left(-j k \\frac{z'^2}{2R}\\right)$。\n对于小宗量，$\\exp(x) \\approx 1+x$。在给定条件下，第二个指数的宗量 $-j k z'^2/(2R)$ 很小。因此，我们展开它：\n$$\n\\exp\\left(-j k \\frac{z'^2}{2R}\\right) \\approx 1 - j k \\frac{z'^2}{2R}\n$$\n问题要求保留直到 $L^2/R^2$ 阶和 $k L^2/R$ 阶的项。积分后，被积函数中 $(z')^n$ 阶的项将产生一个 $L^{n+1}$ 阶的项。误差 $\\varepsilon$ 涉及除以 $L$，所以被积函数中 $(z')^n$ 阶的项对 $\\varepsilon$ 的贡献是 $L^n$ 阶。因此，我们需要保留被积函数中直到 $(z')^2$ 阶的项。\n\n让我们合并被积函数的展开式：\n$$\n\\frac{\\exp(-j k \\sqrt{R^2 + z'^2})}{\\sqrt{R^2 + z'^2}} \\approx \\left(\\frac{1}{R} - \\frac{z'^2}{2R^3}\\right) \\exp(-j k R) \\left(1 - j k \\frac{z'^2}{2R}\\right)\n$$\n$$\n\\approx \\frac{\\exp(-j k R)}{R} \\left(1 - \\frac{z'^2}{2R^2}\\right) \\left(1 - j k \\frac{z'^2}{2R}\\right)\n$$\n展开乘积并保留到 $(z')^2$ 阶的项：\n$$\n\\approx \\frac{\\exp(-j k R)}{R} \\left(1 - j k \\frac{z'^2}{2R} - \\frac{z'^2}{2R^2} + O\\left(\\frac{z'^4}{R^4}\\right)\\right)\n$$\n$$\n\\approx \\frac{\\exp(-j k R)}{R} \\left(1 - z'^2 \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right)\n$$\n现在，我们将这个近似的被积函数从 $z'=-L/2$ 积分到 $z'=L/2$：\n$$\n\\int_{-L/2}^{L/2} \\dots dz' \\approx \\int_{-L/2}^{L/2} \\frac{\\exp(-j k R)}{R} \\left(1 - z'^2 \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right) dz'\n$$\n$$\n= \\frac{\\exp(-j k R)}{R} \\left[ \\int_{-L/2}^{L/2} dz' - \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right) \\int_{-L/2}^{L/2} z'^2 dz' \\right]\n$$\n这些积分是初等的：\n$$\n\\int_{-L/2}^{L/2} dz' = L\n$$\n$$\n\\int_{-L/2}^{L/2} z'^2 dz' = \\left[\\frac{z'^3}{3}\\right]_{-L/2}^{L/2} = \\frac{1}{3} \\left(\\left(\\frac{L}{2}\\right)^3 - \\left(-\\frac{L}{2}\\right)^3\\right) = \\frac{1}{3} \\left(\\frac{L^3}{8} + \\frac{L^3}{8}\\right) = \\frac{L^3}{12}\n$$\n将这些结果代回，积分的近似值为：\n$$\n\\int_{-L/2}^{L/2} \\dots dz' \\approx \\frac{\\exp(-j k R)}{R} \\left(L - \\frac{L^3}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right)\n$$\n现在我们可以计算比率 $E_{\\text{exact}}/E_{\\text{ff}}$：\n$$\n\\frac{E_{\\text{exact}}}{E_{\\text{ff}}} \\approx \\frac{C \\frac{\\exp(-j k R)}{R} \\left(L - \\frac{L^3}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right)}{C \\frac{L \\exp(-j k R)}{R}} = 1 - \\frac{L^2}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\n$$\n最后，我们求出误差 $\\varepsilon$：\n$$\n\\varepsilon = \\frac{E_{\\text{exact}}}{E_{\\text{ff}}} - 1 \\approx - \\frac{L^2}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\n$$\n展开各项，我们得到：\n$$\n\\varepsilon \\approx - \\frac{j k L^2}{24R} - \\frac{L^2}{24R^2}\n$$\n该表达式按要求包含了 $kL^2/R$ 阶和 $L^2/R^2$ 阶的项。可以通过提取公因式使其更紧凑：\n$$\n\\varepsilon \\approx -\\frac{L^2}{24R^2} (1 + j k R)\n$$\n这就是所求的分数误差的主阶渐近估计。",
            "answer": "$$\n\\boxed{-\\frac{L^2}{24R^2} - j\\frac{kL^2}{24R}}\n$$"
        },
        {
            "introduction": "物理光学 (PO) 方法为大尺寸光滑物体的散射提供了一个良好的高频一阶近似，但它在处理边缘效应时存在不足。本实践旨在通过一个典型的有限尺寸导体板散射问题，展示 PTD 如何作为 PO 的重要补充，引入关键的边缘衍射修正。更重要的是，你将通过编程实践，验证和理解 PO 贡献与 PTD 边缘贡献之间的量级关系如何随频率和尺寸变化，从而建立起对高频近似方法渐近特性的深刻直觉。",
            "id": "3340678",
            "problem": "考虑一个理想电导体（PEC）矩形板，其位于 $z=0$ 平面，边长分别为 $L_x$ 和 $L_y$，中心在原点。单位法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$。一列角频率为 $\\omega$、自由空间波数为 $k$ 的时谐平面波以入射方向 $\\hat{\\mathbf{k}}_i$ 照射该板，入射方向由极角 $\\theta_i$ 和方位角 $\\phi_i$（单位为弧度）指定，其中 $\\hat{\\mathbf{k}}_i = [\\sin\\theta_i\\cos\\phi_i,\\sin\\theta_i\\sin\\phi_i,\\cos\\theta_i]$。入射电场为线偏振，表示为 $\\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r})=\\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}}$，其恒定矢量振幅为 $\\mathbf{E}_0$，单位为伏特/米（$\\mathrm{V/m}$）。相应的入射磁场为 $\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r})=\\frac{1}{\\eta_0} \\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}}$，其中 $\\eta_0=\\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间本征阻抗，$\\mu_0$ 是真空磁导率，$\\epsilon_0$ 是真空介电常数。假设 $0 \\le \\theta_i < \\pi/2$，因此板被完全照亮。\n\n从 Maxwell 方程组、板上总切向电场为零的 PEC 边界条件以及 Stratton–Chu 辐射积分的远场形式出发，推导在镜面反射方向 $\\hat{\\mathbf{r}}_s$ 上散射远场的主阶物理光学（PO）近似，其中 $\\hat{\\mathbf{r}}_s$ 是 $\\hat{\\mathbf{k}}_i$ 关于 $z=0$ 平面的镜面反射，定义为 $\\hat{\\mathbf{r}}_s = \\hat{\\mathbf{k}}_i - 2(\\hat{\\mathbf{k}}_i\\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$。在 PO 中，照亮区域上的等效表面电流密度为 $\\mathbf{J}_{\\mathrm{PO}} = 2 \\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}$，该电流限制在板上，远场是通过辐射此电流分布得到的。证明在镜面反射方向上，振荡相位因子在整个板上相互抵消，主阶贡献与板面积 $A=L_x L_y$ 成正比。\n\n使用物理衍射理论（PTD）论证 PO 的下一阶修正是来自于板边界附近厚度为 $O(1/k)$ 的边界层内的边缘衍射电流。解释为什么在镜面反射方向上，这些边缘贡献产生的散射场幅度修正，其相对于内部 PO 项的主阶标度关系与周长面积比成正比，与 $k$ 成反比，即形式为 $O\\!\\left(\\frac{P}{k A}\\right)$，其中 $P=2(L_x+L_y)$ 是板的周长， $A=L_x L_y$ 是面积。将此 PTD 修正视为精确的矩量法（MoM）解在高频时趋近的渐近行为，并在镜面反射方向上将 PO 相对于精确场的相对误差定义为 $\\varepsilon=\\frac{\\left|E_{\\mathrm{exact}}-E_{\\mathrm{PO}}\\right|}{\\left|E_{\\mathrm{exact}}\\right|}$。在 PTD 标度假设下，量化 $\\varepsilon$ 对无量纲尺寸参数 $k a$ 的依赖性，其中 $a=L_x/2$ 是沿 $x$ 方向的特征半长度。\n\n你的程序必须：\n- 计算在给定几何形状和参数下，镜面反射方向上的 PO 远区散射场幅度 $|E_{\\mathrm{PO}}|$，使用 Stratton–Chu 远场表示法计算等效电流辐射的场。以伏特/米（$\\mathrm{V/m}$）为单位报告 $|E_{\\mathrm{PO}}|$。\n- 通过添加一阶边缘修正来模拟镜面反射方向上的 PTD 校正场幅度 $|E_{\\mathrm{PTD}}|$，该修正的相对幅度与 PO 项的标度关系为 $\\frac{P}{k A}$，并用此计算镜面反射方向上的 PO 相对误差 $\\varepsilon$。\n- 通过计算每个测试用例在一小组 $k$ 值上 $\\log \\varepsilon$ 对 $\\log(k a)$ 的最佳拟合线的斜率 $s$，来量化 $\\varepsilon$ 随 $k a$ 的标度关系。\n\n所有角度必须使用弧度，所有长度必须使用国际单位制（SI）。常数 $k$ 必须以逆米（$\\mathrm{rad/m}$）为单位指定。远区观察距离 $R$ 可设为 $1$ 米，以便直接比较绝对幅度，但误差 $\\varepsilon$ 是无量纲的且与 $R$ 无关。\n\n将解决方案实现为一个完整的、可运行的程序，为以下测试套件计算结果：\n\n- 测试用例 1 (正常路径)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=L_x/2=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.7$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{20.0,40.0,80.0\\}$ 弧度/米。\n- 测试用例 2 (较小的 $ka$)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.7$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{6.0,10.0,14.0\\}$ 弧度/米。\n- 测试用例 3 (近掠射入射)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=1.2$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{40.0,80.0,160.0\\}$ 弧度/米。\n- 测试用例 4 (矩形纵横比)：$L_x=1.5$ 米，$L_y=0.75$ 米，$a=L_x/2=0.75$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.6$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{20.0,50.0,100.0\\}$ 弧度/米。\n- 测试用例 5 (垂直入射)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.0$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{20.0,40.0,80.0\\}$ 弧度/米。\n\n对于每个测试用例，你的程序必须计算给定 $k$ 值下 $\\log \\varepsilon$ 对 $\\log(k a)$ 的斜率 $s$。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的斜率列表，例如 $[s_1,s_2,s_3,s_4,s_5]$。每个 $s_j$ 都必须是浮点数。",
            "solution": "此问题经评估为有效。所有给定的数据、定义和条件都具有科学依据、一致且适定，构成了高频计算电磁学中的一个标准问题。\n\n### 1. 物理光学（PO）近似\n\n出发点是 Stratton-Chu 积分表达式，用于表示由承载等效表面电流密度 $\\mathbf{J}_s$ 的表面 $S'$ 产生的散射电场 $\\mathbf{E}^s$：\n$$ \\mathbf{E}^s(\\mathbf{r}) = \\frac{-i k \\eta_0}{4\\pi} \\frac{e^{-ikR}}{R} \\int_{S'} \\left[ \\hat{\\mathbf{r}} \\times (\\hat{\\mathbf{r}} \\times \\mathbf{J}_s(\\mathbf{r}')) \\right] e^{i k \\hat{\\mathbf{r}} \\cdot \\mathbf{r}'} dS' $$\n其中 $\\mathbf{r}$ 是远距离 $R=|\\mathbf{r}|$ 处的观察点，$\\hat{\\mathbf{r}}=\\mathbf{r}/R$ 是观察方向，$\\mathbf{r}'$ 是表面 $S'$ 上的源点，$k$ 是自由空间波数，$\\eta_0$ 是自由空间的本征阻抗。\n\n对于理想电导体（PEC）物体，物理光学（PO）近似假定在表面的被照亮部分 $S_{\\mathrm{il}}$ 上存在等效表面电流，由 $\\mathbf{J}_{\\mathrm{PO}} = 2 \\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}$ 给出，其中 $\\hat{\\mathbf{n}}$ 是指向导体外部并进入无源区域的单位法向量。在阴影部分，电流为零。\n\n入射磁场为 $\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r}')=\\frac{1}{\\eta_0} \\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}'}$。问题指定板位于 $z=0$ 平面，单位法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}=[0,0,1]$，入射波矢量为 $\\hat{\\mathbf{k}}_i = [\\sin\\theta_i\\cos\\phi_i, \\sin\\theta_i\\sin\\phi_i, \\cos\\theta_i]$ 且 $0 \\le \\theta_i < \\pi/2$。$\\hat{\\mathbf{k}}_i$ 的 $z$ 分量为正，这意味着波从 $z<0$ 区域照射板。因此，整个板表面都被照亮，即 $S'=S_{\\mathrm{il}}$。法向量 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$ 正确地从导体（占据 $z=0$）指向无源（阴影）区域 $z>0$。\n\n板上的 PO 电流为：\n$$ \\mathbf{J}_{\\mathrm{PO}}(\\mathbf{r}') = 2\\hat{\\mathbf{z}} \\times \\left( \\frac{1}{\\eta_0} \\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}'} \\right) $$\n将此代入辐射积分，散射场为：\n$$ \\mathbf{E}^s_{\\mathrm{PO}}(\\mathbf{r}) = \\frac{-i k}{2\\pi R} e^{-ikR} \\int_{S'} \\left[ \\hat{\\mathbf{r}} \\times (\\hat{\\mathbf{r}} \\times (\\hat{\\mathbf{z}} \\times (\\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0))) \\right] e^{-i k \\hat{\\mathbf{k}}_i \\cdot \\mathbf{r}'} e^{i k \\hat{\\mathbf{r}} \\cdot \\mathbf{r}'} dS' $$\n积分中的总相位项为 $e^{i k (\\hat{\\mathbf{r}} - \\hat{\\mathbf{k}}_i) \\cdot \\mathbf{r}'}$。\n\n我们在镜面反射方向 $\\hat{\\mathbf{r}}_s = \\hat{\\mathbf{k}}_i - 2(\\hat{\\mathbf{k}}_i \\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$ 上进行计算。当 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$ 且 $\\hat{\\mathbf{k}}_i \\cdot \\hat{\\mathbf{z}} = \\cos\\theta_i$ 时，我们有：\n$$ \\hat{\\mathbf{r}}_s - \\hat{\\mathbf{k}}_i = -2 (\\hat{\\mathbf{k}}_i \\cdot \\hat{\\mathbf{z}}) \\hat{\\mathbf{z}} = -2 \\cos\\theta_i \\hat{\\mathbf{z}} $$\n对于板上 $z=0$ 处的一个源点 $\\mathbf{r}' = x'\\hat{\\mathbf{x}} + y'\\hat{\\mathbf{y}}$，点积为 $(\\hat{\\mathbf{r}}_s - \\hat{\\mathbf{k}}_i) \\cdot \\mathbf{r}' = (-2 \\cos\\theta_i \\hat{\\mathbf{z}}) \\cdot (x'\\hat{\\mathbf{x}} + y'\\hat{\\mathbf{y}}) = 0$。\n因此，在镜面反射方向上，振荡相位因子在板上各处都变为 $e^0=1$。被积函数相对于 $\\mathbf{r}'$ 变为常数。对 $dS'$ 的积分仅得到板的面积 $A=L_x L_y$。\n\n因此，镜面反射方向上的 PO 散射场与面积 $A$ 成正比：\n$$ \\mathbf{E}^s_{\\mathrm{PO}}(\\mathbf{r}_s) = \\frac{-i k A}{2\\pi R} e^{-ikR} \\left[ \\hat{\\mathbf{r}}_s \\times (\\hat{\\mathbf{r}}_s \\times (\\hat{\\mathbf{z}} \\times (\\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0))) \\right] $$\n一个更方便的表达式，源于镜像理论，将 PO 散射场与从无限大 PEC 平面反射的场 $\\mathbf{E}^{\\mathrm{ref}}$ 联系起来。散射远场幅度为：\n$$ |E_{\\mathrm{PO}}| = \\frac{k A \\cos\\theta_i}{2\\pi R} |\\mathbf{E}_0| $$\n这表明主阶 PO 贡献与板面积 $A$ 和波数 $k$ 成正比。\n\n### 2. 物理衍射理论（PTD）修正\n\nPO 近似对于大的、平滑的散射体是准确的，但未能考虑边缘效应。物理衍射理论（PTD）通过增加一个修正场 $\\mathbf{E}_{\\mathrm{edge}}$ 来改进 PO，该修正场由位于散射体边缘的虚构“边缘流”辐射产生。\nPO 场 $\\mathbf{E}_{\\mathrm{PO}}$ 与 $k$ 和面积 $A$ 成正比。已知边缘流 $\\mathbf{J}_{\\mathrm{edge}}$ 相对于 PO 电流 $\\mathbf{J}_{\\mathrm{PO}}$ 的幅度标度为 $O(1/k)$。由这些沿板周长 $P$ 积分的边缘流辐射的场，可以证明其幅度标度为 $O(k^0)$。\n$$ |\\mathbf{E}_{\\mathrm{PO}}| \\propto k A |\\mathbf{J}_{\\mathrm{PO}}| \\quad , \\quad |\\mathbf{E}_{\\mathrm{edge}}| \\propto k P |\\mathbf{J}_{\\mathrm{edge}}| \\propto k P \\frac{|\\mathbf{J}_{\\mathrm{PO}}|}{k} \\propto P |\\mathbf{J}_{\\mathrm{PO}}| $$\n因此，边缘衍射场相对于 PO 场的相对幅度为：\n$$ \\frac{|\\mathbf{E}_{\\mathrm{edge}}|}{|\\mathbf{E}_{\\mathrm{PO}}|} \\propto \\frac{P}{kA} $$\n这证实了问题陈述中提供的标度关系。该标度关系描述了边缘效应的相对重要性如何随着高频（大 $k$）而减小。\n\n### 3. 相对误差的计算模型\n\n问题要求量化相对误差 $\\varepsilon = \\frac{|E_{\\mathrm{exact}}-E_{\\mathrm{PO}}|}{|E_{\\mathrm{exact}}|}$ 相对于无量纲参数 $ka$ 的标度关系。我们被指示将 PTD 场视为精确场，因此 $E_{\\mathrm{exact}} \\approx E_{\\mathrm{PTD}} = E_{\\mathrm{PO}} + E_{\\mathrm{edge}}$。\n问题陈述提供了边缘修正*幅度*的标度关系，但没有指定其相对于 PO 场的复相位，也没有指定确切的比例常数。这些参数以复杂的方式依赖于几何形状、入射角和偏振。指示“模拟”PTD 场意味着我们应该基于给定信息构建一个简单、合理的模型。\n\n我们采用与问题前提一致的最简单模型：\n1.  边缘修正场的相对幅度设为 $\\delta = \\frac{|\\mathbf{E}_{\\mathrm{edge}}|}{|\\mathbf{E}_{\\mathrm{PO}}|} = C \\frac{P}{kA}$。我们假设最简单的比例常数 $C=1$。\n2.  $\\mathbf{E}_{\\mathrm{edge}}$ 和 $\\mathbf{E}_{\\mathrm{PO}}$ 之间的复相位是未知的。我们假设最简单的情况，即相长干涉，此时它们同相。\n\n在这些假设下，幅度相加，因此 $|E_{\\mathrm{PTD}}| = |E_{\\mathrm{PO}}| + |E_{\\mathrm{edge}}| = |E_{\\mathrm{PO}}|(1+\\delta)$。相对误差 $\\varepsilon$ 则为：\n$$ \\varepsilon = \\frac{|(E_{\\mathrm{PO}} + E_{\\mathrm{edge}}) - E_{\\mathrm{PO}}|}{|E_{\\mathrm{PO}} + E_{\\mathrm{edge}}|} = \\frac{|E_{\\mathrm{edge}}|}{|E_{\\mathrm{PTD}}|} = \\frac{\\delta|E_{\\mathrm{PO}}|}{(1+\\delta)|E_{\\mathrm{PO}}|} = \\frac{\\delta}{1+\\delta} $$\n代入 $\\delta = \\frac{P}{kA}$：\n$$ \\varepsilon(k) = \\frac{\\frac{P}{kA}}{1 + \\frac{P}{kA}} $$\n我们关心的是随 $ka$ 的标度关系，其中 $a=L_x/2$。令 $X = ka$。则 $k=X/a$。\n$$ \\varepsilon(X) = \\frac{\\frac{P a}{A X}}{1 + \\frac{P a}{A X}} = \\frac{P a}{A X + P a} = \\frac{\\alpha}{X + \\alpha} $$\n其中 $\\alpha = \\frac{Pa}{A} = \\frac{2(L_x+L_y)(L_x/2)}{L_x L_y} = 1 + \\frac{L_x}{L_y}$。\n\n### 4. 斜率计算\n\n任务是计算 $\\log \\varepsilon$ 对 $\\log(ka)$ 的最佳拟合线的斜率 $s$。对于大的 $ka$（即 $X \\gg \\alpha$），$\\varepsilon(X) \\approx \\alpha/X$，这意味着 $\\log \\varepsilon \\approx \\log \\alpha - \\log X$。渐近斜率为 $-1$。对于给定的有限 $k$ 值，斜率将偏离这个理想值。\n算法如下：\n对于每个测试用例：\n1.  计算几何常数 $\\alpha = 1 + L_x/L_y$。\n2.  对于每个给定的 $k$ 值，计算相应的 $X = ka$。\n3.  计算模型误差 $\\varepsilon = \\alpha / (X + \\alpha)$。\n4.  构成两个向量：一个包含 $\\log(ka)$ 的值，另一个包含 $\\log(\\varepsilon)$ 的值。\n5.  对这两个向量执行一阶多项式（线性）回归。这条线的斜率就是所求的量 $s$。\n\n此过程与入射角 $\\theta_i$ 和场振幅 $E_0$ 无关，因为这些参数并未出现在我们仅基于指定标度定律的 $\\varepsilon$ 模型中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the slope of the log-log plot of\n    PO relative error vs. the dimensionless size parameter ka.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (Lx, Ly, a, E0, theta_i, phi_i, list_of_k)\n    # Note: E0, theta_i, phi_i are not used in the final calculation\n    # as the error model depends only on geometric scaling.\n    test_cases = [\n        # Test Case 1 (happy path)\n        (1.0, 1.0, 0.5, 1.0, 0.7, 0.0, [20.0, 40.0, 80.0]),\n        # Test Case 2 (smaller ka)\n        (1.0, 1.0, 0.5, 1.0, 0.7, 0.0, [6.0, 10.0, 14.0]),\n        # Test Case 3 (near-grazing incidence)\n        (1.0, 1.0, 0.5, 1.0, 1.2, 0.0, [40.0, 80.0, 160.0]),\n        # Test Case 4 (rectangular aspect ratio)\n        (1.5, 0.75, 0.75, 1.0, 0.6, 0.0, [20.0, 50.0, 100.0]),\n        # Test Case 5 (normal incidence)\n        (1.0, 1.0, 0.5, 1.0, 0.0, 0.0, [20.0, 40.0, 80.0]),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Lx, Ly, a, _, _, _, k_values = case\n        \n        # Calculate the geometric parameter alpha from the derived model.\n        # This parameter depends on the plate's aspect ratio.\n        # alpha = Pa/A = (1 + Lx/Ly)\n        alpha = 1.0 + Lx / Ly\n        \n        log_ka_values = []\n        log_epsilon_values = []\n        \n        for k in k_values:\n            # Dimensionless size parameter\n            ka = k * a\n            \n            # Based on the problem description, we model the PTD correction.\n            # The relative magnitude of the edge correction to the PO term is\n            # delta = P / (k * A), where P is perimeter and A is area.\n            # We use a simple model where epsilon = delta / (1 + delta).\n            # This simplifies to epsilon = alpha / (ka + alpha).\n            epsilon = alpha / (ka + alpha)\n\n            log_ka_values.append(np.log(ka))\n            log_epsilon_values.append(np.log(epsilon))\n\n        # Convert lists to numpy arrays for polyfit\n        x_data = np.array(log_ka_values)\n        y_data = np.array(log_epsilon_values)\n\n        # Perform a linear regression (1st-degree polynomial fit)\n        # The slope is the first element of the returned coefficients.\n        slope, _ = np.polyfit(x_data, y_data, 1)\n        \n        results.append(slope)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{s:.12f}' for s in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "本节的高级实践将展示 PTD 在现代工程设计中的强大应用，其价值远不止于简单的散射分析。由于 PTD 能够提供散射场的半解析模型，我们可以高效地计算场量对几何形状参数的导数，即“形状导数”。这个练习将指导你利用一个简化的 PTD 模型，构建一个基于梯度的边缘形状优化流程，这正是当前雷达散射截面缩减、天线和超表面设计等前沿领域中的核心技术之一。",
            "id": "3340641",
            "problem": "考虑单色平面波被一个理想电导体 (PEC) 有限长直边段的高频散射问题。物理衍射理论 (PTD) 通过引入等效边缘电流来模拟衍射场，这些电流是通过对满足 PEC 边界条件的麦克斯韦方程组进行渐近分析，并结合 Huygens–Fresnel 原理和几何光学 (GO) 得到的。在远场中，直边段对固定观测方向上散射场的主要贡献，可以通过对该边段切向坐标的一维边缘积分来表示。在本问题中，在边段中心施加一个微倒角，移除了一个对称段，其半长取决于倒角半径和倒角角度这两个参数。你将需要推导衍射场关于微倒角参数的形状导数，并将其嵌入到一个基于梯度的边段形状优化过程中。\n\n设置如下。一个有限长度的 PEC 边段与对应于切向坐标的笛卡尔坐标轴对齐，该坐标由标量变量 $s$ 表示。边段占据 $s \\in [-L,L]$ 的范围，单位为米。一个波数为 $k$（单位为米分之一）的平面波沿着一个单位方向向量传播，其 z 分量表示为 $u_{i,z}$。观测（远场）方向的单位向量的 z 分量为 $u_{o,z}$，两者均为无量纲。在对直边段的标准 PTD 远场简化中，边缘被积函数的相位对切向坐标的主要依赖关系可以用一个指数因子来建模，该因子由标量 $\\alpha = u_{i,z} + u_{o,z}$ 控制。该微倒角通过移除中心段 $|s| < c$ 来表示，其中有效半长 $c$ 由倒角半径 $r$（单位为米）和倒角角度 $\\beta$（单位为弧度）通过 $c(r,\\beta) = r \\beta$ 进行参数化。这种表示方法是一个工程上的微倒角替代模型，与沿边段中心线的小角度、小半径偏移相符。在这些假设下，远场衍射场由以下形式的边缘积分建模\n$$\nE(c) = \\int_{-L}^{-c} f(s)\\,\\mathrm{d}s + \\int_{c}^{L} f(s)\\,\\mathrm{d}s,\n$$\n其中 $f(s)$ 捕捉了平面波入射下远场中局部等效边缘电流的相位变化。在本问题中，你将采用规范的远场相位模型\n$$\nf(s) = \\exp\\!\\left(-j\\,k\\,\\alpha\\,s\\right),\n$$\n其中 $j^2 = -1$，$k = \\frac{2\\pi}{\\lambda}$，波长 $\\lambda$ 的单位为米。当 $\\alpha = 0$ 时，相位因子为常数且 $f(s) = 1$。\n\n你的任务是：\n- 从麦克斯韦方程组、PEC 边界条件、Huygens–Fresnel 原理和几何光学 (GO) 出发，论证简化为具有给定远场相位依赖性的上述一维边缘积分模型的合理性，并使用莱布尼茨积分法则求得关于倒角半长 $c$ 的形状导数。\n- 使用链式法则，根据 $c(r,\\beta) = r \\beta$ 表达关于倒角参数 $r$ 和 $\\beta$ 的形状导数。\n- 定义标量目标函数 $J(c) = |E(c)|^2$，其中 $|\\cdot|$ 表示复数模，并推导其关于 $r$ 和 $\\beta$ 的梯度分量。\n- 实现一个单步梯度下降，使用无量纲单位的学习率 $\\eta$ 更新 $r$ 和 $\\beta$，并满足约束条件 $r \\ge 0$，$0 \\le \\beta \\le \\frac{\\pi}{2}$ 和 $c(r,\\beta) \\le L$。使用裁剪方法来强制执行这些约束。\n\n重要的建模和单位说明：\n- 所有长度，包括 $L$ 和 $r$，必须以米为单位表示。\n- 所有角度，包括 $\\beta$、$\\chi_i$ 和 $\\chi_o$，必须以弧度为单位表示。入射和观测的z方向余弦分别为 $u_{i,z} = \\cos(\\chi_i)$ 和 $u_{o,z} = \\cos(\\chi_o)$。\n- 波数 $k = \\frac{2\\pi}{\\lambda}$ 的单位为米分之一。\n- 在需要时，对 $\\alpha = 0$ 的情况使用极限形式，以避免在闭式积分中出现除以零的错误。\n\n测试套件：\n你必须实现并评估以下三个测试用例，它们分别涵盖一般情况、近简并相位情况和近边界几何情况。对于每个用例，计算并返回：\n- $E(c)$ 的实部和虚部，\n- $\\frac{\\partial E}{\\partial r}$ 和 $\\frac{\\partial E}{\\partial \\beta}$ 的实部和虚部，\n- 实值梯度 $\\frac{\\partial J}{\\partial r}$ 和 $\\frac{\\partial J}{\\partial \\beta}$，\n- 经过一步梯度下降后更新的参数 $r_{\\text{new}}$ 和 $\\beta_{\\text{new}}$。\n\n为每个用例使用以下参数：\n1. 用例 1（一般情况）：$\\lambda = 0.3\\ \\mathrm{m}$, $L = 1.0\\ \\mathrm{m}$, $r = 0.01\\ \\mathrm{m}$, $\\beta = 0.2\\ \\mathrm{rad}$, $\\chi_i = 0.3\\ \\mathrm{rad}$, $\\chi_o = 1.0\\ \\mathrm{rad}$, $\\eta = 0.05$。\n2. 用例 2（$\\alpha \\approx 0$ 的近简并情况）：$\\lambda = 0.5\\ \\mathrm{m}$, $L = 0.5\\ \\mathrm{m}$, $r = 0.02\\ \\mathrm{m}$, $\\beta = 0.1\\ \\mathrm{rad}$, $\\chi_i = 0.8\\ \\mathrm{rad}$, $\\chi_o = (\\pi - 0.8)\\ \\mathrm{rad}$, $\\eta = 0.1$。\n3. 用例 3（$c \\to L$ 的近边界情况）：$\\lambda = 0.25\\ \\mathrm{m}$, $L = 0.4\\ \\mathrm{m}$, $r = 0.39\\ \\mathrm{m}$, $\\beta = 0.99\\ \\mathrm{rad}$, $\\chi_i = 0.5\\ \\mathrm{rad}$, $\\chi_o = 0.6\\ \\mathrm{rad}$, $\\eta = 0.02$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含所有三个测试用例的结果，形式为一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个列表，按以下顺序包含十个浮点数\n$$\n[\\Re\\{E\\},\\Im\\{E\\},\\Re\\{\\partial E/\\partial r\\},\\Im\\{\\partial E/\\partial r\\},\\Re\\{\\partial E/\\partial \\beta\\},\\Im\\{\\partial E/\\partial \\beta\\},\\partial J/\\partial r,\\partial J/\\partial \\beta,r_{\\text{new}},\\beta_{\\text{new}}].\n$$\n因此，程序会打印一个包含三个列表的列表，每个用例一个，例如\n$$\n\\big[ [\\dots],[\\dots],[\\dots] \\big].\n$$",
            "solution": "本问题要求我们推导衍射场对倒角参数的形状导数，并实现一步梯度下降来更新这些参数以最小化衍射场强度的平方。我们将按步骤进行推导。\n\n**1. 衍射场 $E(c)$ 的解析表达式**\n\n首先，我们计算由模型给出的衍射场积分 $E(c)$。\n$$\nE(c) = \\int_{-L}^{-c} e^{-j k \\alpha s} ds + \\int_{c}^{L} e^{-j k \\alpha s} ds\n$$\n当 $\\alpha \\neq 0$ 时，积分结果为：\n$$\n\\int e^{-j k \\alpha s} ds = \\frac{e^{-j k \\alpha s}}{-j k \\alpha}\n$$\n因此，\n$$\n\\begin{aligned}\nE(c) &= \\left[ \\frac{e^{-j k \\alpha s}}{-j k \\alpha} \\right]_{-L}^{-c} + \\left[ \\frac{e^{-j k \\alpha s}}{-j k \\alpha} \\right]_{c}^{L} \\\\\n&= \\frac{1}{-j k \\alpha} \\left( (e^{j k \\alpha c} - e^{j k \\alpha L}) + (e^{-j k \\alpha L} - e^{-j k \\alpha c}) \\right) \\\\\n&= \\frac{1}{-j k \\alpha} \\left( (e^{j k \\alpha c} - e^{-j k \\alpha c}) - (e^{j k \\alpha L} - e^{-j k \\alpha L}) \\right) \\\\\n&= \\frac{1}{-j k \\alpha} \\left( 2j \\sin(k \\alpha c) - 2j \\sin(k \\alpha L) \\right) \\\\\n&= \\frac{2}{k \\alpha} \\left( \\sin(k \\alpha L) - \\sin(k \\alpha c) \\right)\n\\end{aligned}\n$$\n注意到结果是纯实数。\n\n当 $\\alpha = 0$ 时，被积函数 $f(s) = 1$。积分变为：\n$$\nE(c) = \\int_{-L}^{-c} 1 ds + \\int_{c}^{L} 1 ds = (-c - (-L)) + (L - c) = 2(L - c)\n$$\n\n**2. 形状导数**\n\n我们使用莱布尼茨积分法则来求 $E(c)$ 对 $c$ 的导数：\n$$\n\\frac{dE}{dc} = \\frac{d}{dc} \\left( \\int_{c}^{L} f(s) ds + \\int_{-L}^{-c} f(s) ds \\right) = -f(c) - f(-c)\n$$\n代入 $f(s) = e^{-j k \\alpha s}$：\n$$\n\\frac{dE}{dc} = - (e^{-j k \\alpha c} + e^{j k \\alpha c}) = -2 \\cos(k \\alpha c)\n$$\n当 $\\alpha = 0$ 时，$\\frac{dE}{dc} = -2 \\cos(0) = -2$，这与对 $2(L-c)$ 求导的结果一致。\n\n接下来，使用链式法则求对倒角参数 $r$ 和 $\\beta$ 的导数，其中 $c(r, \\beta) = r\\beta$。\n$$\n\\frac{\\partial E}{\\partial r} = \\frac{dE}{dc} \\frac{\\partial c}{\\partial r} = (-2 \\cos(k \\alpha c)) \\cdot \\beta\n$$\n$$\n\\frac{\\partial E}{\\partial \\beta} = \\frac{dE}{dc} \\frac{\\partial c}{\\partial \\beta} = (-2 \\cos(k \\alpha c)) \\cdot r\n$$\n由于 $E(c)$ 和 $\\frac{dE}{dc}$ 都是实数，这些导数也是纯实数。\n\n**3. 目标函数梯度**\n\n目标函数为 $J(c) = |E(c)|^2$。由于 $E(c)$ 是实数，这简化为 $J(c) = (E(c))^2$。\n其梯度分量为：\n$$\n\\frac{\\partial J}{\\partial r} = \\frac{dJ}{dE} \\frac{\\partial E}{\\partial r} = 2 E(c) \\frac{\\partial E}{\\partial r}\n$$\n$$\n\\frac{\\partial J}{\\partial \\beta} = \\frac{dJ}{dE} \\frac{\\partial E}{\\partial \\beta} = 2 E(c) \\frac{\\partial E}{\\partial \\beta}\n$$\n\n**4. 梯度下降与约束**\n\n单步梯度下降更新规则为：\n$$\nr_{\\text{new}}' = r - \\eta \\frac{\\partial J}{\\partial r}\n$$\n$$\n\\beta_{\\text{new}}' = \\beta - \\eta \\frac{\\partial J}{\\partial \\beta}\n$$\n更新后的值必须通过裁剪来满足约束条件：\n1. $r_{\\text{new}} = \\max(0, r_{\\text{new}}')$\n2. $\\beta_{\\text{new}} = \\max(0, \\min(\\pi/2, \\beta_{\\text{new}}'))$\n3. 最后，强制满足 $c(r_{\\text{new}}, \\beta_{\\text{new}}) \\le L$。如果 $r_{\\text{new}} > 0$ 且 $r_{\\text{new}} \\beta_{\\text{new}} > L$，则裁剪 $\\beta_{\\text{new}} = L / r_{\\text{new}}$。\n\n这些推导步骤为 `answer` 中的 Python 代码实现提供了完整的数学基础。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PTD shape optimization problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general)\n        {'lambda_': 0.3, 'L': 1.0, 'r': 0.01, 'beta': 0.2, 'chi_i': 0.3, 'chi_o': 1.0, 'eta': 0.05},\n        # Case 2 (near alpha = 0)\n        {'lambda_': 0.5, 'L': 0.5, 'r': 0.02, 'beta': 0.1, 'chi_i': 0.8, 'chi_o': np.pi - 0.8, 'eta': 0.1},\n        # Case 3 (near c -> L)\n        {'lambda_': 0.25, 'L': 0.4, 'r': 0.39, 'beta': 0.99, 'chi_i': 0.5, 'chi_o': 0.6, 'eta': 0.02}\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        # Unpack parameters\n        lambda_ = params['lambda_']\n        L = params['L']\n        r = params['r']\n        beta = params['beta']\n        chi_i = params['chi_i']\n        chi_o = params['chi_o']\n        eta = params['eta']\n\n        # 1. Calculate constants\n        k = 2 * np.pi / lambda_\n        u_i_z = np.cos(chi_i)\n        u_o_z = np.cos(chi_o)\n        alpha = u_i_z + u_o_z\n        c = r * beta\n\n        # 2. Calculate E(c)\n        # Handle the case alpha = 0 numerically safely\n        if np.abs(alpha)  1e-9:\n            E_re = 2 * (L - c)\n        else:\n            E_re = (2 / (k * alpha)) * (np.sin(k * alpha * L) - np.sin(k * alpha * c))\n        E_im = 0.0\n\n        # 3. Calculate derivatives of E\n        # Handle the case alpha = 0 numerically safely\n        if np.abs(alpha)  1e-9:\n            dE_dc = -2.0\n        else:\n            dE_dc = -2 * np.cos(k * alpha * c)\n            \n        dE_dr_re = dE_dc * beta\n        dE_dr_im = 0.0\n        \n        dE_dbeta_re = dE_dc * r\n        dE_dbeta_im = 0.0\n\n        # 4. Calculate gradient of J\n        # Since E is real, J = E^2, so grad_J = 2*E*grad_E\n        # Note: E is complex in Numpy, so we use E.real\n        dJ_dr = 2 * E_re * dE_dr_re\n        dJ_dbeta = 2 * E_re * dE_dbeta_re\n\n        # 5. Perform gradient descent step\n        r_new_prime = r - eta * dJ_dr\n        beta_new_prime = beta - eta * dJ_dbeta\n\n        # 6. Apply clipping for constraints\n        # r >= 0\n        r_new = max(0.0, r_new_prime)\n        \n        # 0 = beta = pi/2\n        beta_new = max(0.0, min(np.pi / 2, beta_new_prime))\n        \n        # c(r, beta) = L\n        # This is enforced by further clipping one of the parameters.\n        # We clip beta based on the new r.\n        # This handles the case r_new=0 correctly (c_new=0 = L).\n        if r_new > 0 and r_new * beta_new > L:\n            beta_new = L / r_new\n\n        # 7. Collect and store results\n        case_result = [\n            E_re, E_im,\n            dE_dr_re, dE_dr_im,\n            dE_dbeta_re, dE_dbeta_im,\n            dJ_dr, dJ_dbeta,\n            r_new, beta_new\n        ]\n        results.append(case_result)\n\n    # Format the final output as a string representing a list of lists.\n    # Ex: [[v1, v2,...], [v1, v2,...]]\n    outer_list = []\n    for res_list in results:\n        inner_list = \",\".join(f\"{v:.15g}\" for v in res_list)\n        outer_list.append(f\"[{inner_list}]\")\n    final_output = f\"[{','.join(outer_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}