{
    "hands_on_practices": [
        {
            "introduction": "物理衍射理论与许多高频方法一样，依赖于远场近似来简化计算。本练习将通过推导主阶误差项，来探索这种近似在数学上的影响。通过完成这个解析推导，您将对远场表达式的精度极限以及决定该近似有效性的物理参数有基本的理解。",
            "id": "3340614",
            "problem": "一个被时谐平面波照射的理想导电楔，在物理衍射理论（PTD）中，沿长度为 $L$ 的直边段产生等效边缘电流。考虑这样一段沿 $z$ 轴方向的直边段，从 $z=-L/2$ 延伸到 $z=L/2$。在自由空间中，频率为 $f$，波数为 $k=2\\pi f/c$（其中 $c$ 为光速），假设沿边缘的等效边缘电流密度是均匀的，因此其未知振幅因子在任何相对误差测量中都会被抵消。一个观测点位于 $x$ 轴上的 $(R,0,0)$ 处，其中 $R>0$，且极化方式使得标量格林函数描述足以表示边缘的贡献。\n\n观测点处的场的精确标量边缘辐射积分可以写成自由空间格林函数在边缘长度上的积分。远场 PTD 表达式将格林函数中的精确距离因子替换为其远区近似，具体来说，对于这种宽边观测几何，振幅中的 $\\left| \\mathbf{r} - \\mathbf{r}' \\right| \\mapsto R$ 和相位中的 $\\exp\\!\\left(-j k \\left| \\mathbf{r}-\\mathbf{r}' \\right|\\right) \\mapsto \\exp(-j k R)$。定义使用远场 PTD 表达式而非精确近场积分所产生的复分数误差为\n$$\n\\varepsilon \\equiv \\frac{E_{\\text{exact}} - E_{\\text{ff}}}{E_{\\text{ff}}},\n$$\n其中 $E_{\\text{exact}}$ 是由精确近场积分得到的场，$E_{\\text{ff}}$ 是由远场 PTD 近似得到的场，两者均在相同的均匀边缘电流振幅下计算，因此该振幅在 $\\varepsilon$ 中被抵消。\n\n从基于自由空间格林函数的辐射积分出发，仅使用在 $k R \\gg 1$ 和 $L/R \\ll 1$ 区域内有效的、经过充分检验的展开式，推导 $\\varepsilon$ 的一个主阶渐近估计，该估计保留所有直至并包括 $L^{2}/R^{2}$ 和 $k L^{2}/R$ 阶的项。用 $L$、$R$ 和 $k$ 将你的最终结果表示为单个简化的解析表达式。不需要进行数值计算。明确写出你对 $\\varepsilon$ 的最终表达式。答案必须以无单位的闭式解析表达式给出。",
            "solution": "问题要求计算使用远场近似来处理均匀线源辐射时所产生的复分数误差 $\\varepsilon$ 的主阶渐近估计。源是一个沿 $z$ 轴、以原点为中心、长度为 $L$ 的等效边缘电流。观测点位于 $x$ 轴上的 $(R, 0, 0)$。\n\n首先，我们构建精确场 $E_{\\text{exact}}$ 和远场近似场 $E_{\\text{ff}}$ 的表达式。该问题使用标量格林函数处理。源点位于 $\\mathbf{r}' = (0, 0, z')$，其中 $z' \\in [-L/2, L/2]$。观测点位于 $\\mathbf{r} = (R, 0, 0)$。源点和观测点之间的距离是 $|\\mathbf{r} - \\mathbf{r}'| = \\sqrt{R^2 + z'^2}$。\n\n场正比于源密度乘以自由空间格林函数 $G(\\mathbf{r}, \\mathbf{r}') = \\frac{\\exp(-j k |\\mathbf{r}-\\mathbf{r}'|)}{4\\pi |\\mathbf{r}-\\mathbf{r}'|}$ 的积分。由于假设边缘电流密度是均匀的，其恒定的振幅因子 $I_0$ 可以并入一个比例常数 $C$ 中，该常数将在最终的比率中被抵消。\n\n精确场由辐射积分给出：\n$$\nE_{\\text{exact}} = C \\int_{-L/2}^{L/2} \\frac{\\exp(-j k \\sqrt{R^2 + z'^2})}{\\sqrt{R^2 + z'^2}} dz'\n$$\n\n根据问题陈述，远场表达式 $E_{\\text{ff}}$ 是通过将格林函数的振幅和相位项中的距离因子 $|\\mathbf{r} - \\mathbf{r}'|$ 都替换为 $R$ 来获得的。这意味着被积函数相对于积分变量 $z'$ 变成了一个常数。\n$$\nE_{\\text{ff}} = C \\int_{-L/2}^{L/2} \\frac{\\exp(-j k R)}{R} dz' = C \\frac{\\exp(-j k R)}{R} \\left[ z' \\right]_{-L/2}^{L/2} = C \\frac{L \\exp(-j k R)}{R}\n$$\n\n复分数误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon = \\frac{E_{\\text{exact}} - E_{\\text{ff}}}{E_{\\text{ff}}} = \\frac{E_{\\text{exact}}}{E_{\\text{ff}}} - 1\n$$\n代入场的表达式，常数 $C$ 被抵消：\n$$\n\\varepsilon = \\frac{R}{L \\exp(-j k R)} \\int_{-L/2}^{L/2} \\frac{\\exp(-j k \\sqrt{R^2 + z'^2})}{\\sqrt{R^2 + z'^2}} dz' - 1\n$$\n为了计算这个值，我们需要找到该积分的一个渐近近似。给定的条件是 $k R \\gg 1$ 和 $L/R \\ll 1$。后一个条件意味着对于积分域中的任何 $z'$，都有 $|z'/R| \\le L/(2R) \\ll 1$。这允许我们对被积函数针对小的 $z'/R$ 进行泰勒级数展开。\n\n让我们展开被积函数中的各项。距离为 $d(z') = \\sqrt{R^2 + z'^2} = R\\sqrt{1 + (z'/R)^2}$。\n使用二项式展开 $(1+x)^a \\approx 1 + ax + \\dots$，我们展开 $d(z')$ 和 $1/d(z')$。\n$$\nd(z') = R \\left(1 + \\frac{z'^2}{R^2}\\right)^{1/2} \\approx R \\left(1 + \\frac{1}{2} \\frac{z'^2}{R^2}\\right) = R + \\frac{z'^2}{2R}\n$$\n这个近似是用于相位项的。对于振幅项，我们有：\n$$\n\\frac{1}{d(z')} = \\frac{1}{R} \\left(1 + \\frac{z'^2}{R^2}\\right)^{-1/2} \\approx \\frac{1}{R} \\left(1 - \\frac{1}{2} \\frac{z'^2}{R^2}\\right) = \\frac{1}{R} - \\frac{z'^2}{2R^3}\n$$\n相位因子是 $\\exp(-j k d(z')) \\approx \\exp\\left(-j k \\left(R + \\frac{z'^2}{2R}\\right)\\right) = \\exp(-j k R) \\exp\\left(-j k \\frac{z'^2}{2R}\\right)$。\n对于小宗量，$\\exp(x) \\approx 1+x$。第二个指数的宗量 $-j k z'^2/(2R)$ 在给定条件下是小的。因此，我们展开它：\n$$\n\\exp\\left(-j k \\frac{z'^2}{2R}\\right) \\approx 1 - j k \\frac{z'^2}{2R}\n$$\n问题要求保留到 $L^2/R^2$ 和 $k L^2/R$ 阶的项。积分后，被积函数中 $(z')^n$ 阶的项将产生一个 $L^{n+1}$ 阶的项。误差 $\\varepsilon$ 涉及除以 $L$，因此 $(z')^n$ 阶的被积函数项对 $\\varepsilon$ 的贡献是 $L^n$ 阶。因此，我们需要保留被积函数中直到 $(z')^2$ 阶的项。\n\n让我们将被积函数的展开式组合起来：\n$$\n\\frac{\\exp(-j k \\sqrt{R^2 + z'^2})}{\\sqrt{R^2 + z'^2}} \\approx \\left(\\frac{1}{R} - \\frac{z'^2}{2R^3}\\right) \\exp(-j k R) \\left(1 - j k \\frac{z'^2}{2R}\\right)\n$$\n$$\n\\approx \\frac{\\exp(-j k R)}{R} \\left(1 - \\frac{z'^2}{2R^2}\\right) \\left(1 - j k \\frac{z'^2}{2R}\\right)\n$$\n展开乘积并保留到 $(z')^2$ 阶的项：\n$$\n\\approx \\frac{\\exp(-j k R)}{R} \\left(1 - j k \\frac{z'^2}{2R} - \\frac{z'^2}{2R^2} + O\\left(\\frac{z'^4}{R^4}\\right)\\right)\n$$\n$$\n\\approx \\frac{\\exp(-j k R)}{R} \\left(1 - z'^2 \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right)\n$$\n现在，我们将这个近似的被积函数从 $z'=-L/2$ 积分到 $z'=L/2$：\n$$\n\\int_{-L/2}^{L/2} \\dots dz' \\approx \\int_{-L/2}^{L/2} \\frac{\\exp(-j k R)}{R} \\left(1 - z'^2 \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right) dz'\n$$\n$$\n= \\frac{\\exp(-j k R)}{R} \\left[ \\int_{-L/2}^{L/2} dz' - \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right) \\int_{-L/2}^{L/2} z'^2 dz' \\right]\n$$\n这些积分是初等的：\n$$\n\\int_{-L/2}^{L/2} dz' = L\n$$\n$$\n\\int_{-L/2}^{L/2} z'^2 dz' = \\left[\\frac{z'^3}{3}\\right]_{-L/2}^{L/2} = \\frac{1}{3} \\left(\\left(\\frac{L}{2}\\right)^3 - \\left(-\\frac{L}{2}\\right)^3\\right) = \\frac{1}{3} \\left(\\frac{L^3}{8} + \\frac{L^3}{8}\\right) = \\frac{L^3}{12}\n$$\n将这些结果代回，积分的近似值为：\n$$\n\\int_{-L/2}^{L/2} \\dots dz' \\approx \\frac{\\exp(-j k R)}{R} \\left(L - \\frac{L^3}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right)\n$$\n现在我们可以计算比率 $E_{\\text{exact}}/E_{\\text{ff}}$：\n$$\n\\frac{E_{\\text{exact}}}{E_{\\text{ff}}} \\approx \\frac{C \\frac{\\exp(-j k R)}{R} \\left(L - \\frac{L^3}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\\right)}{C \\frac{L \\exp(-j k R)}{R}} = 1 - \\frac{L^2}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\n$$\n最后，我们求出误差 $\\varepsilon$：\n$$\n\\varepsilon = \\frac{E_{\\text{exact}}}{E_{\\text{ff}}} - 1 \\approx - \\frac{L^2}{12} \\left(\\frac{j k}{2R} + \\frac{1}{2R^2}\\right)\n$$\n展开各项，我们得到：\n$$\n\\varepsilon \\approx - \\frac{j k L^2}{24R} - \\frac{L^2}{24R^2}\n$$\n该表达式包含了所要求的 $kL^2/R$ 和 $L^2/R^2$ 阶的项。通过提取公因式，它可以被写得更紧凑：\n$$\n\\varepsilon \\approx -\\frac{L^2}{24R^2} (1 + j k R)\n$$\n这就是所求的分数误差的主阶渐近估计。",
            "answer": "$$\n\\boxed{-\\frac{L^2}{24R^2} - j\\frac{kL^2}{24R}}\n$$"
        },
        {
            "introduction": "物理光学（PO）为大尺寸物体的散射提供了良好的初步近似，但它未能准确捕捉边缘效应。物理衍射理论（PTD）通过增加由边缘衍射场引起的校正项，改进了物理光学。这项实践要求您通过计算来模拟物理光学近似的误差，并验证其高频渐近标度特性，从而定量地证明为何PTD校正对于精确的散射预测至关重要。",
            "id": "3340678",
            "problem": "考虑一个理想电导体 (PEC) 矩形板，其位于 $z=0$ 平面内，边长分别为 $L_x$ 和 $L_y$，且中心位于原点。其单位法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$。一束角频率为 $\\omega$、自由空间波数为 $k$ 的时谐平面波照射该板，其入射方向 $\\hat{\\mathbf{k}}_i$ 由极角 $\\theta_i$ 和方位角 $\\phi_i$（单位为弧度）指定，其中 $\\hat{\\mathbf{k}}_i = [\\sin\\theta_i\\cos\\phi_i,\\sin\\theta_i\\sin\\phi_i,\\cos\\theta_i]$。入射电场呈线性极化，表达式为 $\\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r})=\\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}}$，其中 $\\mathbf{E}_0$ 为恒定矢量振幅，单位为伏特/米 ($\\mathrm{V/m}$)。相应的入射磁场为 $\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r})=\\frac{1}{\\eta_0} \\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}}$，其中 $\\eta_0=\\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间本征阻抗，$\\mu_0$ 是真空磁导率，$\\epsilon_0$ 是真空介电常数。假设 $0 \\le \\theta_i  \\pi/2$，因此板被完全照亮。\n\n从 Maxwell's equations、板上总切向电场为零的 PEC 边界条件以及 Stratton–Chu 辐射积分的远场形式出发，推导在镜面反射方向 $\\hat{\\mathbf{r}}_s$ 上远区散射场的主阶 Physical Optics (PO) 近似。其中，$\\hat{\\mathbf{r}}_s$ 是 $\\hat{\\mathbf{k}}_i$ 关于 $z=0$ 平面的镜像反射，定义为 $\\hat{\\mathbf{r}}_s = \\hat{\\mathbf{k}}_i - 2(\\hat{\\mathbf{k}}_i\\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$。在 PO 中，受照区域上的等效表面电流密度为 $\\mathbf{J}_{\\mathrm{PO}} = 2 \\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}$（限制在板上），远场通过该电流分布的辐射获得。证明在镜面反射方向上，板上的振荡相位因子相互抵消，且主阶贡献与板的面积 $A=L_x L_y$ 成正比。\n\n使用 Physical Theory of Diffraction (PTD) 论证对 PO 的下一阶修正来自边缘衍射电流，该电流被限制在板边界附近厚度为 $O(1/k)$ 的边界层内。解释为何在镜面反射方向上，这些边缘贡献产生的散射场幅值修正，其相对于内部 PO 项的主阶标度关系与周长面积比成正比，与 $k$ 成反比，即形式为 $O\\!\\left(\\frac{P}{k A}\\right)$，其中 $P=2(L_x+L_y)$ 是板的周长，$A=L_x L_y$ 是面积。将此 PTD 修正视为精确的矩量法 (MoM) 解在高频时趋近的渐近行为，并在镜面反射方向上将 PO 相对于精确场的相对误差定义为 $\\varepsilon=\\frac{\\left|E_{\\mathrm{exact}}-E_{\\mathrm{PO}}\\right|}{\\left|E_{\\mathrm{exact}}\\right|}$。在 PTD 标度假设下，量化 $\\varepsilon$ 对无量纲尺寸参数 $k a$ 的依赖关系，其中 $a=L_x/2$ 是沿 $x$ 方向的特征半长。\n\n您的程序必须：\n- 使用等效电流辐射场的 Stratton–Chu 远场表示法，计算给定几何形状和参数下，镜面反射方向上的 PO 远区散射场幅值 $|E_{\\mathrm{PO}}|$。以伏特/米 ($\\mathrm{V/m}$) 为单位报告 $|E_{\\mathrm{PO}}|$。\n- 通过添加一个一阶边缘修正来对镜面反射方向上的 PTD 校正场幅值 $|E_{\\mathrm{PTD}}|$ 进行建模，该修正的相对幅值与 PO 项之比按 $\\frac{P}{k A}$ 标度变化，并用此模型计算镜面反射方向上的 PO 相对误差 $\\varepsilon$。\n- 通过计算每个测试用例在一小组 $k$ 值上 $\\log \\varepsilon$ 与 $\\log(k a)$ 的最佳拟合线的斜率 $s$，来量化 $\\varepsilon$ 随 $k a$ 变化的标度关系。\n\n所有角度必须使用弧度，所有长度必须使用标准国际单位制 (SI)。常数 $k$ 必须以米分之一 ($\\mathrm{rad/m}$) 为单位指定。远区观测距离 $R$ 可以设置为 $R=1$ 米，以便绝对幅值可以直接比较，但误差 $\\varepsilon$ 是无量纲的，且与 $R$ 无关。\n\n将解决方案实现为一个完整的、可运行的程序，该程序为以下测试套件计算结果：\n\n- 测试用例 1 (正常路径)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=L_x/2=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.7$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{20.0,40.0,80.0\\}$ 弧度/米。\n- 测试用例 2 (较小的 $k a$)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.7$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{6.0,10.0,14.0\\}$ 弧度/米。\n- 测试用例 3 (近掠入射)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=1.2$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{40.0,80.0,160.0\\}$ 弧度/米。\n- 测试用例 4 (矩形长宽比)：$L_x=1.5$ 米，$L_y=0.75$ 米，$a=L_x/2=0.75$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.6$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{20.0,50.0,100.0\\}$ 弧度/米。\n- 测试用例 5 (法向入射)：$L_x=1.0$ 米，$L_y=1.0$ 米，$a=0.5$ 米，$E_0=1.0$ 伏特/米，$\\theta_i=0.0$ 弧度，$\\phi_i=0.0$ 弧度，以及 $k \\in \\{20.0,40.0,80.0\\}$ 弧度/米。\n\n对于每个测试用例，您的程序必须计算给定 $k$ 值下 $\\log \\varepsilon$ 与 $\\log(k a)$ 的斜率 $s$。您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的斜率列表，例如 $[s_1,s_2,s_3,s_4,s_5]$。每个 $s_j$ 必须是浮点数。",
            "solution": "该问题被评估为有效。所有给定的数据、定义和条件都具有科学依据、一致且适定，构成了高频计算电磁学中的一个标准问题。\n\n### 1. Physical Optics (PO) 近似\n\n出发点是来自承载等效表面电流密度 $\\mathbf{J}_s$ 的表面 $S'$ 的散射电场 $\\mathbf{E}^s$ 的 Stratton-Chu 积分表示：\n$$ \\mathbf{E}^s(\\mathbf{r}) = \\frac{-i k \\eta_0}{4\\pi} \\frac{e^{-ikR}}{R} \\int_{S'} \\left[ \\hat{\\mathbf{r}} \\times (\\hat{\\mathbf{r}} \\times \\mathbf{J}_s(\\mathbf{r}')) \\right] e^{i k \\hat{\\mathbf{r}} \\cdot \\mathbf{r}'} dS' $$\n其中 $\\mathbf{r}$ 是位于远距离 $R=|\\mathbf{r}|$ 处的观测点，$\\hat{\\mathbf{r}}=\\mathbf{r}/R$ 是观测方向，$\\mathbf{r}'$ 是表面 $S'$ 上的源点，$k$ 是自由空间波数，$\\eta_0$ 是自由空间的本征阻抗。\n\n对于理想电导体 (PEC) 物体，Physical Optics (PO) 近似假定在表面的受照部分 $S_{\\mathrm{il}}$ 上存在一个等效表面电流，由 $\\mathbf{J}_{\\mathrm{PO}} = 2 \\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}$ 给出，其中 $\\hat{\\mathbf{n}}$ 是从导体指向无源区的单位法向量。在阴影部分，电流为零。\n\n入射磁场为 $\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r}')=\\frac{1}{\\eta_0} \\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}'}$。问题指定板位于 $z=0$ 平面，单位法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}=[0,0,1]$，入射波矢量为 $\\hat{\\mathbf{k}}_i = [\\sin\\theta_i\\cos\\phi_i, \\sin\\theta_i\\sin\\phi_i, \\cos\\theta_i]$ 且 $0 \\le \\theta_i  \\pi/2$。$\\hat{\\mathbf{k}}_i$ 的 z 分量为正，意味着波从 $z0$ 区域照射该板。因此，整个板表面都被照亮，$S'=S_{\\mathrm{il}}$。法向量 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$ 正确地从导体（占据 $z=0$）指向无源（阴影）区域 $z>0$。\n\n板上的 PO 电流为：\n$$ \\mathbf{J}_{\\mathrm{PO}}(\\mathbf{r}') = 2\\hat{\\mathbf{z}} \\times \\left( \\frac{1}{\\eta_0} \\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0 e^{-i k \\hat{\\mathbf{k}}_i\\cdot \\mathbf{r}'} \\right) $$\n将此代入辐射积分，散射场为：\n$$ \\mathbf{E}^s_{\\mathrm{PO}}(\\mathbf{r}) = \\frac{-i k}{2\\pi R} e^{-ikR} \\int_{S'} \\left[ \\hat{\\mathbf{r}} \\times (\\hat{\\mathbf{r}} \\times (\\hat{\\mathbf{z}} \\times (\\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0))) \\right] e^{-i k \\hat{\\mathbf{k}}_i \\cdot \\mathbf{r}'} e^{i k \\hat{\\mathbf{r}} \\cdot \\mathbf{r}'} dS' $$\n积分中的总相位项为 $e^{i k (\\hat{\\mathbf{r}} - \\hat{\\mathbf{k}}_i) \\cdot \\mathbf{r}'}$。\n\n我们在镜面反射方向 $\\hat{\\mathbf{r}}_s = \\hat{\\mathbf{k}}_i - 2(\\hat{\\mathbf{k}}_i \\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$ 上计算该式。当 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$ 且 $\\hat{\\mathbf{k}}_i \\cdot \\hat{\\mathbf{z}} = \\cos\\theta_i$ 时，我们有：\n$$ \\hat{\\mathbf{r}}_s - \\hat{\\mathbf{k}}_i = -2 (\\hat{\\mathbf{k}}_i \\cdot \\hat{\\mathbf{z}}) \\hat{\\mathbf{z}} = -2 \\cos\\theta_i \\hat{\\mathbf{z}} $$\n对于位于 $z=0$ 平面上的源点 $\\mathbf{r}' = x'\\hat{\\mathbf{x}} + y'\\hat{\\mathbf{y}}$，其点积为 $(\\hat{\\mathbf{r}}_s - \\hat{\\mathbf{k}}_i) \\cdot \\mathbf{r}' = (-2 \\cos\\theta_i \\hat{\\mathbf{z}}) \\cdot (x'\\hat{\\mathbf{x}} + y'\\hat{\\mathbf{y}}) = 0$。\n因此，在镜面反射方向上，振荡相位因子在板上各处都变为 $e^0=1$。被积函数相对于 $\\mathbf{r}'$ 变为常数。对 $dS'$ 的积分就只得到板的面积 $A=L_x L_y$。\n\n得到的镜面反射方向上的 PO 散射场与面积 $A$ 成正比：\n$$ \\mathbf{E}^s_{\\mathrm{PO}}(\\mathbf{r}_s) = \\frac{-i k A}{2\\pi R} e^{-ikR} \\left[ \\hat{\\mathbf{r}}_s \\times (\\hat{\\mathbf{r}}_s \\times (\\hat{\\mathbf{z}} \\times (\\hat{\\mathbf{k}}_i \\times \\mathbf{E}_0))) \\right] $$\n一个更方便的表达式，源自镜像理论，将 PO 散射场与从无限大 PEC 平面反射的场 $\\mathbf{E}^{\\mathrm{ref}}$ 联系起来。远区散射场幅值为：\n$$ |E_{\\mathrm{PO}}| = \\frac{k A \\cos\\theta_i}{2\\pi R} |\\mathbf{E}_0| $$\n这表明主阶 PO 贡献与板面积 $A$ 和波数 $k$ 成正比。\n\n### 2. Physical Theory of Diffraction (PTD) 修正\n\nPO 近似对于大的、光滑的散射体是准确的，但未能考虑边缘效应。Physical Theory of Diffraction (PTD) 通过增加一个修正场 $\\mathbf{E}_{\\mathrm{edge}}$ 来改进 PO，该修正场由定域在散射体边缘的虚拟“边缘流”辐射产生。\nPO 场 $\\mathbf{E}_{\\mathrm{PO}}$ 与 $k$ 和面积 $A$ 成正比。已知边缘流 $\\mathbf{J}_{\\mathrm{edge}}$ 相对于 PO 电流 $\\mathbf{J}_{\\mathrm{PO}}$ 的幅值标度关系为 $O(1/k)$。由这些沿板周长 $P$ 积分的边缘流所辐射的场，可以证明其幅值标度关系为 $O(k^0)$。\n$$ |\\mathbf{E}_{\\mathrm{PO}}| \\propto k A |\\mathbf{J}_{\\mathrm{PO}}| \\quad , \\quad |\\mathbf{E}_{\\mathrm{edge}}| \\propto k P |\\mathbf{J}_{\\mathrm{edge}}| \\propto k P \\frac{|\\mathbf{J}_{\\mathrm{PO}}|}{k} \\propto P |\\mathbf{J}_{\\mathrm{PO}}| $$\n因此，边缘衍射场相对于 PO 场的相对幅值为：\n$$ \\frac{|\\mathbf{E}_{\\mathrm{edge}}|}{|\\mathbf{E}_{\\mathrm{PO}}|} \\propto \\frac{P}{kA} $$\n这证实了问题陈述中提供的标度关系。该标度关系描述了在高频（大 $k$）下边缘效应的相对重要性如何减弱。\n\n### 3. 相对误差的计算模型\n\n问题要求量化相对误差 $\\varepsilon = \\frac{|E_{\\mathrm{exact}}-E_{\\mathrm{PO}}|}{|E_{\\mathrm{exact}}|}$ 随无量纲参数 $ka$ 变化的标度关系。我们被要求将 PTD 场视为精确场，因此 $E_{\\mathrm{exact}} \\approx E_{\\mathrm{PTD}} = E_{\\mathrm{PO}} + E_{\\mathrm{edge}}$。\n问题陈述提供了边缘修正*幅值*的标度关系，但没有指定其相对于 PO 场的复相位，也没有指定确切的比例常数。这些参数以复杂的方式依赖于几何形状、入射角和极化。要求“建模” PTD 场的指令意味着我们应该基于给定信息构建一个简单的、合理的模型。\n\n我们采用与问题前提一致的最简单的模型：\n1.  边缘修正场的相对幅值设为 $\\delta = \\frac{|\\mathbf{E}_{\\mathrm{edge}}|}{|\\mathbf{E}_{\\mathrm{PO}}|} = C \\frac{P}{kA}$。我们假设最简单的比例常数，即 $C=1$。\n2.  $\\mathbf{E}_{\\mathrm{edge}}$ 和 $\\mathbf{E}_{\\mathrm{PO}}$ 之间的复相位是未知的。我们假设最简单的相长干涉情况，即它们同相。\n\n在这些假设下，幅值相加，因此 $|E_{\\mathrm{PTD}}| = |E_{\\mathrm{PO}}| + |E_{\\mathrm{edge}}| = |E_{\\mathrm{PO}}|(1+\\delta)$。那么相对误差 $\\varepsilon$ 为：\n$$ \\varepsilon = \\frac{|(E_{\\mathrm{PO}} + E_{\\mathrm{edge}}) - E_{\\mathrm{PO}}|}{|E_{\\mathrm{PO}} + E_{\\mathrm{edge}}|} = \\frac{|E_{\\mathrm{edge}}|}{|E_{\\mathrm{PTD}}|} = \\frac{\\delta|E_{\\mathrm{PO}}|}{(1+\\delta)|E_{\\mathrm{PO}}|} = \\frac{\\delta}{1+\\delta} $$\n代入 $\\delta = \\frac{P}{kA}$：\n$$ \\varepsilon(k) = \\frac{\\frac{P}{kA}}{1 + \\frac{P}{kA}} $$\n我们关心的是随 $ka$ 变化的标度关系，其中 $a=L_x/2$。令 $X = ka$。则 $k=X/a$。\n$$ \\varepsilon(X) = \\frac{\\frac{P a}{A X}}{1 + \\frac{P a}{A X}} = \\frac{P a}{A X + P a} = \\frac{\\alpha}{X + \\alpha} $$\n其中 $\\alpha = \\frac{Pa}{A} = \\frac{2(L_x+L_y)(L_x/2)}{L_x L_y} = 1 + \\frac{L_x}{L_y}$。\n\n### 4. 斜率计算\n\n任务是计算 $\\log \\varepsilon$ 与 $\\log(ka)$ 的最佳拟合线的斜率 $s$。对于大的 $ka$（即 $X \\gg \\alpha$），$\\varepsilon(X) \\approx \\alpha/X$，这意味着 $\\log \\varepsilon \\approx \\log \\alpha - \\log X$。渐近斜率为 $-1$。对于给定的有限 $k$ 值，斜率将偏离这个理想值。\n算法如下：\n对于每个测试用例：\n1.  计算几何常数 $\\alpha = 1 + L_x/L_y$。\n2.  对于每个给定的 $k$ 值，计算相应的 $X = ka$。\n3.  计算模型误差 $\\varepsilon = \\alpha / (X + \\alpha)$。\n4.  构建两个向量：一个包含 $\\log(ka)$ 的值，另一个包含 $\\log(\\varepsilon)$ 的值。\n5.  对这两个向量执行一阶多项式（线性）回归。这条线的斜率就是所求的量 $s$。\n\n此过程与入射角 $\\theta_i$ 和场振幅 $E_0$ 无关，因为这些参数没有出现在我们的 $\\varepsilon$ 模型中，该模型仅基于指定的标度定律。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the slope of the log-log plot of\n    PO relative error vs. the dimensionless size parameter ka.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (Lx, Ly, a, E0, theta_i, phi_i, list_of_k)\n    # Note: E0, theta_i, phi_i are not used in the final calculation\n    # as the error model depends only on geometric scaling.\n    test_cases = [\n        # Test Case 1 (happy path)\n        (1.0, 1.0, 0.5, 1.0, 0.7, 0.0, [20.0, 40.0, 80.0]),\n        # Test Case 2 (smaller ka)\n        (1.0, 1.0, 0.5, 1.0, 0.7, 0.0, [6.0, 10.0, 14.0]),\n        # Test Case 3 (near-grazing incidence)\n        (1.0, 1.0, 0.5, 1.0, 1.2, 0.0, [40.0, 80.0, 160.0]),\n        # Test Case 4 (rectangular aspect ratio)\n        (1.5, 0.75, 0.75, 1.0, 0.6, 0.0, [20.0, 50.0, 100.0]),\n        # Test Case 5 (normal incidence)\n        (1.0, 1.0, 0.5, 1.0, 0.0, 0.0, [20.0, 40.0, 80.0]),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Lx, Ly, a, _, _, _, k_values = case\n        \n        # Calculate the geometric parameter alpha from the derived model.\n        # This parameter depends on the plate's aspect ratio.\n        # alpha = Pa/A = (1 + Lx/Ly)\n        alpha = 1.0 + Lx / Ly\n        \n        log_ka_values = []\n        log_epsilon_values = []\n        \n        for k in k_values:\n            # Dimensionless size parameter\n            ka = k * a\n            \n            # Based on the problem description, we model the PTD correction.\n            # The relative magnitude of the edge correction to the PO term is\n            # delta = P / (k * A), where P is perimeter and A is area.\n            # We use a simple model where epsilon = delta / (1 + delta).\n            # This simplifies to epsilon = alpha / (ka + alpha).\n            epsilon = alpha / (ka + alpha)\n\n            log_ka_values.append(np.log(ka))\n            log_epsilon_values.append(np.log(epsilon))\n\n        # Convert lists to numpy arrays for polyfit\n        x_data = np.array(log_ka_values)\n        y_data = np.array(log_epsilon_values)\n\n        # Perform a linear regression (1st-degree polynomial fit)\n        # The slope is the first element of the returned coefficients.\n        slope, _ = np.polyfit(x_data, y_data, 1)\n        \n        results.append(slope)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{s:.12f}' for s in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "尽管物理衍射理论（PTD）是一个强大的工具，但其简化形式常常忽略了散射体不同部分之间的复杂相互作用。本练习旨在探究单次相互作用PTD模型在一个具有挑战性的场景——障碍物后方深阴影区——的准确性。通过将简化的PTD模型与更严格的基准解进行比较，您将量化因忽略多重衍射效应而引入的误差，从而对模型的局限性和阴影形成的物理机制获得关键的洞察。",
            "id": "3340625",
            "problem": "您需要实现一个程序，用于在高频下定量比较物理衍射理论 (PTD) 和矩量法 (MoM) 对理想电导体 (PEC) 有限尺寸平板后方深阴影区中场的预测。该比较必须基于一个与计算电磁学中的物理衍射理论一致的标量高频替代模型。在此问题中，PEC 板是一个尺寸为 $2a \\times 2b$ 的薄矩形平板障碍物，位于 $z=0$ 平面的原点中心，受到一个波数为 $k$、沿 $z$ 轴正方向传播的单位振幅时谐平面波 $u^{\\text{inc}}(\\mathbf{r}) = e^{-j k Z}$ 的照射。任务是计算在深阴影区（$Z>0$ 且 $|X|",
            "solution": "该问题要求对两种用于描述理想电导体 (PEC) 矩形板高频标量衍射的模型进行定量比较。第一个模型是基于 Fresnel 近似的 Rayleigh-Sommerfeld 衍射积分和 Babinet 原理的数值精确参考解（作为矩量法 MoM 的替代）。第二个是简化的物理衍射理论 (PTD) 模型，它只考虑来自最近边缘的单次相互作用效应。目标是计算这两个模型在板后深阴影区预测的场之间的相对差异 $\\delta$。\n\n物理设置包括一个尺寸为 $2a \\times 2b$ 的方形板，其中 $a=b=1.0$ 米，位于 $z=0$ 平面的原点中心。它被一个沿 $z$ 轴正向传播的单位振幅平面波 $u^{\\text{inc}}(\\mathbf{r}) = e^{-j k Z}$ 照射。波数为 $k=200 \\text{ m}^{-1}$，这设定了高频参数 $ka=200$ 和波长 $\\lambda = 2\\pi/k = \\pi/100$ 米。虚数单位用 $j$ 表示。\n\n求解过程是通过计算两个模型在指定观测点 $\\mathbf{r}=(X,Y,Z)$ 的总场，然后计算它们的相对差异。\n\n首先，我们按照规定定义 Fresnel 积分的复变函数 $F(u)$：\n$$ F(u) = C(u) + j S(u) $$\n其中 $C(u) = \\int_{0}^{u}\\cos(\\frac{\\pi t^{2}}{2})\\, dt$ 和 $S(u) = \\int_{0}^{u}\\sin(\\frac{\\pi t^{2}}{2})\\, dt$ 是标准的 Fresnel 余弦和正弦积分。这些是使用 `scipy.special.fresnel` 库函数实现的。\n\n**1. 参考解 ($u^{\\text{ref}}$)**\n\n参考解通过引用 Babinet 原理来模拟不透明板后的场：该场等于入射场减去由相同尺寸的互补孔径衍射出的场。\n$$ u^{\\text{ref}}(X,Y,Z) = u^{\\text{inc}}(X,Y,Z) - u^{\\text{ap}}(X,Y,Z) $$\n在 Fresnel 近似下，孔径场 $u^{\\text{ap}}$ 由一个可分离积分给出，其计算结果为：\n$$ u^{\\text{ap}}(X,Y,Z) = \\frac{e^{-j k Z}}{j 2}\\,\\big[ F(u_{x}^{+}) - F(u_{x}^{-}) \\big]\\;\\big[ F(u_{y}^{+}) - F(u_{y}^{-}) \\big] $$\nFresnel 积分的参数通过归一化因子 $\\alpha = \\sqrt{2/(\\lambda Z)}$ 依赖于观测点 $(X,Y,Z)$ 和板的尺寸 ($a, b$)：\n$$ u_{x}^{\\pm} = \\alpha(\\pm a - X) $$\n$$ u_{y}^{\\pm} = \\alpha(\\pm b - Y) $$\n对于每个测试用例，我们计算 $\\alpha$，然后计算 $u_{x}^{\\pm}$ 和 $u_{y}^{\\pm}$。随后，我们评估这些参数对应的 $F(u)$ 的复数值，组装出 $u^{\\text{ap}}$，最后得到 $u^{\\text{ref}}$。\n\n**2. PTD 单次相互作用模型 ($u^{\\text{PTD}}$)**\n\nPTD 模型通过只考虑每个维度上最近边缘的衍射贡献，从而忽略了与更远边缘的相互作用，提供了孔径场 $u^{\\text{ap}}_{\\text{PTD}}$ 的一个近似。这被表述为两个独立的半平面透射因子的乘积。\n$$ u^{\\text{PTD}}(X,Y,Z) = u^{\\text{inc}}(X,Y,Z) - u^{\\text{ap}}_{\\text{PTD}}(X,Y,Z) $$\nPTD 孔径场模型为：\n$$ u^{\\text{ap}}_{\\text{PTD}}(X,Y,Z) = \\frac{e^{-j k Z}}{j 2}\\, T(u_{x}^{\\text{near}})\\, T(u_{y}^{\\text{near}}) $$\n单个半平面的透射因子 $T(u)$ 由 Fresnel 积分定义：\n$$ T(u) = \\tfrac{1}{2} + C(u) + j\\big(\\tfrac{1}{2} + S(u)\\big) $$\n参数 $u_{x}^{\\text{near}}$ 和 $u_{y}^{\\text{near}}$ 分别从对 $\\{u_{x}^{+}, u_{x}^{-}\\}$ 和 $\\{u_{y}^{+}, u_{y}^{-}\\}$ 中选择绝对值最小的一个。这对应于离观测点投影最近的边缘。\n$$ u_{x}^{\\text{near}} = \\arg\\min_{u \\in \\{u_{x}^{+},\\,u_{x}^{-}\\}} |u| $$\n$$ u_{y}^{\\text{near}} = \\arg\\min_{u \\in \\{u_{y}^{+},\\,u_{y}^{-}\\}} |u| $$\n对于给定的观测点，我们确定 $u_{x}^{\\text{near}}$ 和 $u_{y}^{\\text{near}}$，计算相应的透射因子 $T(u_{x}^{\\text{near}})$ 和 $T(u_{y}^{\\text{near}})$，然后计算 $u^{\\text{ap}}_{\\text{PTD}}$ 和 $u^{\\text{PTD}}$。\n\n**3. 差异计算 ($\\delta$)**\n\n最后，对于每个测试用例，两个模型之间的相对差异 $\\delta$ 计算为其差值的模，并用参考解的模进行归一化：\n$$ \\delta = \\frac{|u^{\\text{ref}} - u^{\\text{PTD}}|}{|u^{\\text{ref}}|} = \\frac{|u^{\\text{ap}}_{\\text{PTD}} - u^{\\text{ap}}|}{|u^{\\text{inc}} - u^{\\text{ap}}|} $$\n这个无量纲量衡量了 PTD 近似相对于更精确的参考模型的分数误差。对所有四个指定的测试用例执行该计算，并将结果格式化为六位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import fresnel\n\ndef solve():\n    \"\"\"\n    Computes the discrepancy between a reference diffraction model and a PTD model\n    for a PEC plate, as specified in the problem statement.\n    \"\"\"\n    # Define the constants from the problem statement.\n    a = 1.0  # meters\n    b = 1.0  # meters\n    k = 200.0  # rad/m\n    lambda_ = 2 * np.pi / k\n    j = 1j\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0, 30.0),  # Case 1: Z=30a, (X,Y)=(0,0)\n        (0.8, 0.0, 30.0),  # Case 2: Z=30a, (X,Y)=(0.8a,0)\n        (0.8, 0.8, 30.0),  # Case 3: Z=30a, (X,Y)=(0.8a,0.8a)\n        (0.5, 0.5, 10.0),  # Case 4: Z=10a, (X,Y)=(0.5a,0.5a)\n    ]\n\n    results = []\n\n    # Helper function for the complex Fresnel integral F(u)\n    def F(u):\n        \"\"\"Computes F(u) = C(u) + j*S(u).\"\"\"\n        S_u, C_u = fresnel(u)\n        return C_u + j * S_u\n\n    # Helper function for the half-plane transmission factor T(u)\n    def T(u):\n        \"\"\"Computes T(u) = 1/2 + C(u) + j*(1/2 + S(u)).\"\"\"\n        S_u, C_u = fresnel(u)\n        return (0.5 + C_u) + j * (0.5 + S_u)\n\n    for X, Y, Z in test_cases:\n        # Calculate intermediate parameters for the current case\n        alpha = np.sqrt(2 / (lambda_ * Z))\n        # Corrected incident wave propagating in +z direction\n        u_inc = np.exp(-j * k * Z)\n        # Corrected propagator for aperture fields\n        propagator = np.exp(-j * k * Z)\n\n        # Arguments for Fresnel integrals\n        ux_p = alpha * (a - X)\n        ux_n = alpha * (-a - X)\n        uy_p = alpha * (b - Y)\n        uy_n = alpha * (-b - Y)\n\n        # 1. Calculate the Reference Solution (u_ref)\n        F_diff_x = F(ux_p) - F(ux_n)\n        F_diff_y = F(uy_p) - F(uy_n)\n        u_ap = (propagator / (2 * j)) * F_diff_x * F_diff_y\n        u_ref = u_inc - u_ap\n\n        # 2. Calculate the PTD Solution (u_ptd)\n        # Determine nearest edge arguments\n        u_vals_x = [ux_p, ux_n]\n        idx_min_x = np.argmin(np.abs(u_vals_x))\n        ux_near = u_vals_x[idx_min_x]\n\n        u_vals_y = [uy_p, uy_n]\n        idx_min_y = np.argmin(np.abs(u_vals_y))\n        uy_near = u_vals_y[idx_min_y]\n\n        # Calculate PTD aperture field\n        Tx = T(ux_near)\n        Ty = T(uy_near)\n        u_ap_ptd = (propagator / (2 * j)) * Tx * Ty\n        u_ptd = u_inc - u_ap_ptd\n\n        # 3. Calculate the Discrepancy (delta)\n        # np.abs(u_ref) can be very small in the deep shadow, but should not be zero\n        # for the given non-pathological points.\n        delta = np.abs(u_ref - u_ptd) / np.abs(u_ref)\n        results.append(delta)\n\n    # Format results to six significant figures and print\n    formatted_results = [f\"{res:.6g}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}