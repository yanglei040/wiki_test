{
    "hands_on_practices": [
        {
            "introduction": "在将物理世界中的非线性现象转化为计算模型时，首要步骤是正确地进行无量纲化。本练习将指导您完成一个关键过程：将以SI单位表示的物理三阶电极化率 $\\chi^{(3)}$ 转换为FDTD代码中使用的无量纲系数。通过这个实践，您将掌握连接理论物理常数与数值模拟参数的基本技能，这是确保仿真结果物理意义正确的必要前提。",
            "id": "3334794",
            "problem": "考虑一个使用时域有限差分 (FDTD) 方法模拟的瞬时各向同性克尔介质。其宏观本构关系基于麦克斯韦方程组和三阶（立方）介质的非线性极化定义：电通量密度为 $D = \\epsilon_0 E + P$，其中非线性极化为 $P_{\\text{NL}} = \\epsilon_0 \\chi^{(3)} |E|^{2} E$。此处，$\\epsilon_0$ 是真空介电常数，$\\chi^{(3)}$ 是国际单位制 (SI) 中的（标量）三阶电极化率，单位为 $\\mathrm{m}^{2}/\\mathrm{V}^{2}$。\n\n在您的 FDTD 代码中，您使用分别为电场、时间和长度选择的尺度对场和坐标进行无量纲化：$\\tilde{E} = E / E_{s}$，$\\tilde{t} = t / t_{s}$，$\\tilde{x} = x / x_{s}$。为了使麦克斯韦旋度方程在这些代码单位下无系数，您选择的时间和长度尺度需满足 $t_{s} = x_{s} / c$，其中 $c = 1/\\sqrt{\\mu_0 \\epsilon_0}$ 是真空中的光速，$\\mu_0$ 是真空磁导率。假设介质是线性各向同性的非磁性介质，其相对磁导率等于1。\n\n仅从麦克斯韦方程组和上述本构定义出发，推导一个表达式，用于将国际单位制 (SI) 中的物理三阶电极化率 $\\chi^{(3)}$ 转换为在 FDTD 更新中以代码单位计算克尔极化时所使用的无量纲系数。然后，使用您的结果，计算当所选场尺度为 $E_{s} = 5.0 \\times 10^{8}~\\mathrm{V}/\\mathrm{m}$ 时，材料 $\\chi^{(3)} = 2.7 \\times 10^{-22}~\\mathrm{m}^{2}/\\mathrm{V}^{2}$ 的无量纲系数的数值。设 $x_{s}$ 和 $t_{s}$ 满足 $t_{s} = x_{s}/c$。\n\n将最终的无量纲系数四舍五入到四位有效数字。最终数值答案中不包含单位。",
            "solution": "用户希望找到在时域有限差分 (FDTD) 模拟中克尔非线性的无量纲系数，并针对给定的材料和场尺度计算其值。\n\n### 步骤 1：无量纲系数的推导\n\n起点是瞬时各向同性克尔介质中电通量密度 $D$ 的本构关系。问题中给出如下：\n$$D = \\epsilon_0 E + P$$\n其中 $P$ 是材料极化。问题进一步指定非线性极化为：\n$$P_{\\text{NL}} = \\epsilon_0 \\chi^{(3)} |E|^{2} E$$\n问题设定意味着极化的线性部分为零（即线性相对介电常数 $\\epsilon_r = 1$），因此总极化就是非线性部分，$P = P_{\\text{NL}}$。所以，完整的本构关系是：\n$$D = \\epsilon_0 E + \\epsilon_0 \\chi^{(3)} |E|^{2} E$$\n这可以因式分解为：\n$$D = \\epsilon_0 \\left(1 + \\chi^{(3)} |E|^2 \\right) E$$\n此处，$D$、$E$、$\\epsilon_0$ 和 $\\chi^{(3)}$ 均采用国际单位制 (SI) 单位。\n\n接下来，我们引入 FDTD 模拟中使用的无量纲变量（也称为代码单位）。它们通过对物理量进行尺度变换来定义：\n$$E = E_{s} \\tilde{E}$$\n$$t = t_{s} \\tilde{t}$$\n$$\\nabla = \\frac{1}{x_{s}} \\tilde{\\nabla}$$\n其中 $E_s$、$t_s$ 和 $x_s$ 分别是电场、时间和长度的尺度常数。波浪号（~）表示无量纲量。\n\n为了恰当地归一化本构关系，我们还必须定义一个无量纲的电通量密度 $\\tilde{D}$。$D$ 的一致尺度变换可从要求麦克斯韦旋度方程在新单位下无系数推导得出。安培定律为 $\\nabla \\times H = \\frac{\\partial D}{\\partial t}$。为使无量纲形式 $\\tilde{\\nabla} \\times \\tilde{H} = \\frac{\\partial \\tilde{D}}{\\partial \\tilde{t}}$ 成立，并给定磁场的标准尺度变换 $H_s = E_s / Z_0$（其中 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间阻抗）和条件 $t_s = x_s/c$，$D$ 的尺度因子必须是：\n$$D_s = \\frac{t_s}{x_s} H_s = \\frac{1}{c} \\frac{E_s}{Z_0} = \\frac{1}{c} E_s \\left(c \\epsilon_0\\right) = \\epsilon_0 E_s$$\n因此，无量纲电通量密度为：\n$$\\tilde{D} = \\frac{D}{D_s} = \\frac{D}{\\epsilon_0 E_s}$$\n\n现在我们可以将尺度变换后的变量代入物理本构关系，以找到相应的无量纲关系。\n$$\\tilde{D} = \\frac{\\epsilon_0 \\left(1 + \\chi^{(3)} |E|^2 \\right) E}{\\epsilon_0 E_s}$$\n消去 $\\epsilon_0$：\n$$\\tilde{D} = \\frac{\\left(1 + \\chi^{(3)} |E|^2 \\right) E}{E_s}$$\n代入 $E = E_s \\tilde{E}$：\n$$\\tilde{D} = \\frac{\\left(1 + \\chi^{(3)} |E_s \\tilde{E}|^2 \\right) (E_s \\tilde{E})}{E_s}$$\n通过消去 $E_s$ 来简化：\n$$\\tilde{D} = \\left(1 + \\chi^{(3)} E_s^2 |\\tilde{E}|^2 \\right) \\tilde{E}$$\n展开此表达式可得：\n$$\\tilde{D} = \\tilde{E} + \\left( \\chi^{(3)} E_s^2 \\right) |\\tilde{E}|^2 \\tilde{E}$$\n该方程是本构关系的无量纲形式。在 FDTD 更新中，项 $\\tilde{P}_{\\text{NL}} = (\\chi^{(3)} E_s^2) |\\tilde{E}|^2 \\tilde{E}$ 表示以代码单位计的克尔极化。因此，乘以非线性项 $|\\tilde{E}|^2 \\tilde{E}$ 的无量纲系数是 $\\chi^{(3)} E_s^2$。\n\n我们将这个无量纲系数称为 $\\gamma$。将物理极化率转换为无量纲系数的表达式是：\n$$\\gamma = \\chi^{(3)} E_s^2$$\n作为检验，我们可以验证其单位。$\\chi^{(3)}$ 的单位为 $\\mathrm{m}^2/\\mathrm{V}^2$，$E_s$ 的单位为 $\\mathrm{V}/\\mathrm{m}$。\n$$[\\gamma] = [\\chi^{(3)}] [E_s^2] = \\left(\\frac{\\mathrm{m}^2}{\\mathrm{V}^2}\\right) \\left(\\frac{\\mathrm{V}}{\\mathrm{m}}\\right)^2 = \\frac{\\mathrm{m}^2}{\\mathrm{V}^2} \\frac{\\mathrm{V}^2}{\\mathrm{m}^2} = 1$$\n所得系数 $\\gamma$ 确实是无量纲的，符合要求。\n\n### 步骤 2：数值计算\n\n问题要求计算此无量纲系数 $\\gamma$ 的数值，给定以下物理值：\n- 三阶电极化率：$\\chi^{(3)} = 2.7 \\times 10^{-22}~\\mathrm{m}^{2}/\\mathrm{V}^{2}$\n- 电场尺度：$E_{s} = 5.0 \\times 10^{8}~\\mathrm{V}/\\mathrm{m}$\n\n使用推导出的公式：\n$$\\gamma = \\chi^{(3)} E_s^2$$\n代入给定值：\n$$\\gamma = (2.7 \\times 10^{-22}) \\times (5.0 \\times 10^{8})^2$$\n$$\\gamma = (2.7 \\times 10^{-22}) \\times (25.0 \\times 10^{16})$$\n$$\\gamma = (2.7 \\times 25.0) \\times 10^{-22+16}$$\n$$\\gamma = 67.5 \\times 10^{-6}$$\n$$\\gamma = 6.75 \\times 10^{-5}$$\n问题要求答案四舍五入到四位有效数字。为了用四位有效数字表示 $6.75 \\times 10^{-5}$，我们在末尾追加一个零。\n$$\\gamma = 6.750 \\times 10^{-5}$$",
            "answer": "$$\\boxed{6.750 \\times 10^{-5}}$$"
        },
        {
            "introduction": "在FDTD中处理瞬时非线性（如克尔效应）时，我们常常会遇到一个需要在每个时间步求解的非线性代数方程。本练习探讨了一种常见的求解方法——不动点迭代法，并要求您分析其收敛性。通过计算迭代映射的利普希茨常数（Lipschitz constant），您将学会如何预判和保证数值解法的稳定性和效率，这对于处理强非线性问题至关重要。",
            "id": "3334803",
            "problem": "考虑各向同性瞬时克尔介质中时域有限差分 (FDTD) 方法的逐点材料更新。电磁场的演化由麦克斯韦方程组和本构关系决定，该本构关系通过克尔介质的非线性极化将电通量密度 $D$ 和电场 $E$ 联系起来。从安培-麦克斯韦定律 $\\partial D/\\partial t=\\nabla\\times H - J$ 和瞬时克尔本构关系 $D=\\epsilon_{0}\\epsilon_{r} E+\\epsilon_{0}\\chi^{(3)}|E|^{2}E$ 出发，推导在给定时间步下，为了从已知的 $D^{n+1}$ 获得 $E^{n+1}$ 所必须求解的逐点非线性方程。提出一个不动点迭代 $E^{(m+1)}=F(E^{(m)})$，该迭代与对线性项进行隐式处理、对三次克尔项进行显式处理的方式一致。\n\n然后，假设迭代应用于折射率为 $n_0$ 的无损耗介质中的实标量平面偏振场，确定迭代映射 $F$ 在满足 $|E|\\leq E_{\\max}$ 的物理容许场集合上的利普希茨常数 $L$。其中 $E_{\\max}$ 由强度界限 $I\\leq I_{\\max}$ 和经过充分检验的平面波关系 $I=\\tfrac{1}{2}n_{0}\\epsilon_{0}c\\,E^{2}$ 确定。用 $\\epsilon_{0}$、$\\epsilon_{r}$、$\\chi^{(3)}$、$n_{0}$、$c$ 和 $I_{\\max}$ 符号化地表示 $L$。\n\n最后，对于熔融石英，使用典型参数值 $n_{0}=1.45$，$\\epsilon_{r}=n_{0}^{2}$，以及 $\\chi^{(3)}=2.7\\times 10^{-22}\\,\\mathrm{m}^{2}\\!/\\mathrm{V}^{2}$，并假设容许的峰值强度为 $I_{\\max}=5.0\\times 10^{12}\\,\\mathrm{W}/\\mathrm{m}^{2}$，数值计算 $L$。使用 $\\epsilon_{0}=8.854\\,187\\,817\\times 10^{-12}\\,\\mathrm{F}/\\mathrm{m}$ 和 $c=2.997\\,924\\,58\\times 10^{8}\\,\\mathrm{m}/\\mathrm{s}$。将最终的利普希茨常数数值四舍五入至四位有效数字。将最终答案表示为无量纲量。",
            "solution": "该问题要求在时域有限差分 (FDTD) 框架内，推导克尔介质中电场 $E$ 的逐点更新方程，构建相应的不动点迭代，并通过利普希茨常数分析其收敛性。\n\n首先，我们陈述基本方程。电磁场的时间演化由麦克斯韦方程组控制。与电场更新相关的方程是安培-麦克斯韦定律，在没有自由电流 ($J=0$) 的情况下为：\n$$\n\\frac{\\partial D}{\\partial t} = \\nabla \\times H\n$$\n在 FDTD 方法中，此方程在时间上被离散化。标准的蛙跳格式在整数时间步 $n$ 更新电通量密度 $D$，在半整数时间步 $n+1/2$ 更新磁场 $H$。在特定网格点， $D$ 从时间 $n$ 到 $n+1$ 的更新由下式给出：\n$$\nD^{n+1} = D^n + \\Delta t (\\nabla \\times H^{n+1/2})\n$$\n其中 $\\Delta t$ 是时间步长，旋度算子也在空间上被离散化。在每个网格点，计算出 $D^{n+1}$ 后，必须找到相应的电场 $E^{n+1}$。这一步需要连接 $D$ 和 $E$ 的本构关系。\n\n问题给出了各向同性瞬时克尔介质的本构关系：\n$$\nD = \\epsilon_{0}\\epsilon_{r} E + \\epsilon_{0}\\chi^{(3)}|E|^{2}E\n$$\n这里，$\\epsilon_{0}$ 是真空介电常数，$\\epsilon_{r}$ 是线性相对介电常数，$\\chi^{(3)}$ 是三阶非线性极化率。\n\n在时间步 $t^{n+1}$， $D^{n+1}$ 和 $E^{n+1}$ 之间的关系是：\n$$\nD^{n+1} = \\epsilon_{0}\\epsilon_{r} E^{n+1} + \\epsilon_{0}\\chi^{(3)}|E^{n+1}|^{2}E^{n+1}\n$$\n这就是在每个空间网格点上，给定由 FDTD 更新得到的 $D^{n+1}$ 值，必须求解 $E^{n+1}$ 的逐点非线性矢量方程。\n\n问题要求提出一个不动点迭代来求解这个方程，具体指令是对线性项进行隐式处理，对三次克尔项进行显式处理。设 $E^{(m)}$ 表示解 $E^{n+1}$ 的第 $m$ 次猜测值。对线性项的“隐式”处理意味着用下一个迭代值 $E^{(m+1)}$ 来计算它，而对非线性项的“显式”处理意味着用当前迭代值 $E^{(m)}$ 来计算它。这导致以下迭代格式：\n$$\nD^{n+1} = \\epsilon_{0}\\epsilon_{r} E^{(m+1)} + \\epsilon_{0}\\chi^{(3)}|E^{(m)}|^{2}E^{(m)}\n$$\n我们可以对此方程求解 $E^{(m+1)}$，以获得不动点迭代映射 $E^{(m+1)} = F(E^{(m)})$：\n$$\nE^{(m+1)} = \\frac{1}{\\epsilon_{0}\\epsilon_{r}} \\left( D^{n+1} - \\epsilon_{0}\\chi^{(3)}|E^{(m)}|^{2}E^{(m)} \\right)\n$$\n这定义了迭代函数 $F$。\n\n接下来，我们对实标量平面偏振场分析此迭代。在这种情况下，矢量场 $E$ 可以被视为标量 $E$，项 $|E|^2 E$ 简化为 $E^3$。迭代变为：\n$$\nE^{(m+1)} = \\frac{D^{n+1}}{\\epsilon_{0}\\epsilon_{r}} - \\frac{\\chi^{(3)}}{\\epsilon_{r}}(E^{(m)})^3\n$$\n迭代函数为 $F(E) = \\frac{D^{n+1}}{\\epsilon_{0}\\epsilon_{r}} - \\frac{\\chi^{(3)}}{\\epsilon_{r}}E^3$，其中 $E$ 是迭代变量。\n\n映射 $F(E)$ 在集合 $S$ 上的利普希茨常数 $L$ 定义为 $L = \\sup_{E \\in S} |F'(E)|$。$F(E)$ 关于 $E$ 的导数是：\n$$\nF'(E) = \\frac{d}{dE} \\left( \\frac{D^{n+1}}{\\epsilon_{0}\\epsilon_{r}} - \\frac{\\chi^{(3)}}{\\epsilon_{r}}E^3 \\right) = - \\frac{3\\chi^{(3)}}{\\epsilon_{r}}E^2\n$$\n容许场集由 $|E| \\le E_{\\max}$ 给出。我们必须在此集合上找到 $|F'(E)|$ 的上确界。\n$$\n|F'(E)| = \\left| - \\frac{3\\chi^{(3)}}{\\epsilon_{r}}E^2 \\right| = \\frac{3|\\chi^{(3)}|}{\\epsilon_{r}}E^2\n$$\n考虑到像熔融石英这样的常见材料的 $\\chi^{(3)}$ 是正的，我们有 $|\\chi^{(3)}| = \\chi^{(3)}$。表达式 $|F'(E)|$ 是 $|E|$ 的增函数。因此，它在区间 $E \\in [-E_{\\max}, E_{\\max}]$ 上的最大值在边界处达到，即在 $E = \\pm E_{\\max}$ 处。\n$$\nL = \\sup_{|E| \\le E_{\\max}} |F'(E)| = \\frac{3\\chi^{(3)}}{\\epsilon_{r}}E_{\\max}^2\n$$\n问题提供了一个关系，用于从峰值强度界限 $I_{\\max}$ 确定 $E_{\\max}$：\n$$\nI = \\frac{1}{2}n_{0}\\epsilon_{0}c\\,E^{2}\n$$\n其中 $E$ 是场振幅。因此，最大场振幅 $E_{\\max}$ 对应于最大强度 $I_{\\max}$：\n$$\nI_{\\max} = \\frac{1}{2}n_{0}\\epsilon_{0}c\\,E_{\\max}^{2}\n$$\n解出 $E_{\\max}^2$：\n$$\nE_{\\max}^2 = \\frac{2I_{\\max}}{n_{0}\\epsilon_{0}c}\n$$\n将 $E_{\\max}^2$ 的这个表达式代入 $L$ 的方程：\n$$\nL = \\frac{3\\chi^{(3)}}{\\epsilon_{r}} \\left( \\frac{2I_{\\max}}{n_{0}\\epsilon_{0}c} \\right) = \\frac{6\\chi^{(3)}I_{\\max}}{\\epsilon_{r}n_{0}\\epsilon_{0}c}\n$$\n问题还指出，对于无损耗介质，$\\epsilon_{r} = n_{0}^2$。代入此式得到利普希茨常数的最终符号表达式：\n$$\nL = \\frac{6\\chi^{(3)}I_{\\max}}{n_{0}^2 n_{0}\\epsilon_{0}c} = \\frac{6\\chi^{(3)}I_{\\max}}{n_{0}^3 \\epsilon_{0}c}\n$$\n该表达式的单位是 $(\\mathrm{m}^2/\\mathrm{V}^2)(\\mathrm{W}/\\mathrm{m}^2) / ((\\mathrm{F}/\\mathrm{m})(\\mathrm{m}/\\mathrm{s})) = (\\mathrm{W}/\\mathrm{V}^2)/(\\mathrm{F}/\\mathrm{s})$。由于 $\\mathrm{W} = \\mathrm{J}/\\mathrm{s}$ 和 $\\mathrm{F} = \\mathrm{C}/\\mathrm{V}$，以及 $\\mathrm{J} = \\mathrm{V} \\cdot \\mathrm{C}$，这简化为 $((\\mathrm{J}/\\mathrm{s})/\\mathrm{V}^2) / ((\\mathrm{C}/\\mathrm{V})/\\mathrm{s}) = (\\mathrm{J}/\\mathrm{V}^2)/(\\mathrm{C}/\\mathrm{V}) = \\mathrm{J}/(\\mathrm{V} \\cdot \\mathrm{C}) = 1$。利普希茨常数 $L$ 是一个无量纲量，正如预期的那样。\n\n最后，我们使用为熔融石英提供的参数值来数值计算 $L$：\n$n_{0} = 1.45$\n$\\chi^{(3)} = 2.7 \\times 10^{-22}\\,\\mathrm{m}^{2}\\!/\\mathrm{V}^{2}$\n$I_{\\max} = 5.0 \\times 10^{12}\\,\\mathrm{W}/\\mathrm{m}^{2}$\n$\\epsilon_{0} = 8.854187817 \\times 10^{-12}\\,\\mathrm{F}/\\mathrm{m}$\n$c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}/\\mathrm{s}$\n\n我们分别计算分子和分母。\n分子：\n$$\n6 \\times (2.7 \\times 10^{-22}) \\times (5.0 \\times 10^{12}) = 8.1 \\times 10^{-9}\n$$\n分母：\n$$\nn_{0}^3 \\epsilon_{0} c = (1.45)^3 \\times (8.854187817 \\times 10^{-12}) \\times (2.99792458 \\times 10^{8})\n$$\n$$\n(1.45)^3 = 3.048625\n$$\n$$\n\\epsilon_{0} c \\approx (8.854187817 \\times 10^{-12}) \\times (2.99792458 \\times 10^{8}) \\approx 2.65441873 \\times 10^{-3} \\, \\mathrm{S}\n$$\n$$\n\\text{分母} \\approx 3.048625 \\times (2.65441873 \\times 10^{-3}) \\approx 8.092493 \\times 10^{-3}\n$$\n现在我们计算比率：\n$$\nL = \\frac{8.1 \\times 10^{-9}}{8.092493 \\times 10^{-3}} \\approx 1.0009275 \\times 10^{-6}\n$$\n将此结果四舍五入到四位有效数字，得到：\n$$\nL \\approx 1.001 \\times 10^{-6}\n$$\n$L \\ll 1$ 的小值表明，在此条件下，该不动点迭代是压缩映射，并将快速收敛。",
            "answer": "$$\\boxed{1.001 \\times 10^{-6}}$$"
        },
        {
            "introduction": "超越简单的瞬时模型，许多非线性材料还表现出记忆效应，这通常通过辅助微分方程（ADE）来建模。本练习的核心在于确保这些ADE的数值离散化方案不会损害整个FDTD算法的二阶时间精度。您将通过泰勒级数分析，确定一个能保持精度的时间中心化参数，从而深入理解在复杂多物理场耦合仿真中维持数值保真度的重要性。",
            "id": "3334760",
            "problem": "考虑一个在一维各向同性非磁性介质中，使用时域有限差分 (FDTD) 方法的 Yee 网格进行建模。电场 $E(x,t)$ 配置在整数时间索引处，磁场 $H(x,t)$ 配置在半整数时间索引处。位移场为 $D = \\varepsilon_{0} E + P$，其中 $P(x,t)$ 是一个非线性极化项，通过一个辅助微分方程 (ADE) 来捕捉弱克尔型非线性。假设非线性极化遵循一阶弛豫定律\n$$\n\\frac{\\partial P(x,t)}{\\partial t} = F\\big(E(x,t),P(x,t)\\big), \\quad F(E,P) = -\\gamma P + \\sigma |E|^{2} E,\n$$\n其中 $\\gamma > 0$ 和 $\\sigma \\ge 0$ 是恒定的材料参数。电场通过标准的蛙跳格式进行更新，在没有材料色散和非线性的情况下，该格式在时间上是二阶精确的。非线性极化变量 $P$ 在时间上与 $E$ 配置在相同的电场节点上。\n\n给定 ADE 通过一个通用的单参数、两层隐式格式进行离散化\n$$\nP^{n+1} = P^{n} + \\Delta t \\left[(1-\\theta) F\\!\\left(E^{n},P^{n}\\right) + \\theta F\\!\\left(E^{n+1},P^{n+1}\\right)\\right],\n$$\n其中 $\\Delta t$ 是时间步长，$n$ 是时间索引，$\\theta \\in \\mathbb{R}$ 是一个时间中心化参数。假设耦合的麦克斯韦-ADE系统足够光滑，以至于所有需要的时间导数都存在且有界，并且当 $P$ 在相同的整数时间层上已知时，对 $E$ 的麦克斯韦更新方程的 Yee 离散化在时间上是二阶精确的。\n\n从上述麦克斯韦方程组和 ADE 出发，利用局部截断误差的泰勒级数一致性分析，确定时间中心化参数 $\\theta$ 的唯一值，该值是使得当 $P$ 在 Yee 网格上与 $E$ 配置在同一点时，ADE 的整体时间积分在电场节点上保持时间二阶精度，并因此保持包含非线性极化的耦合 FDTD 对 $E$ 更新的二阶精度的充分必要条件。\n\n请以单个实数的形式给出最终答案。无需四舍五入，并且该参数没有需要报告的物理单位。",
            "solution": "该问题要求在一个用于非线性辅助微分方程 (ADE) 的数值格式中，找到时间中心化参数 $\\theta$ 的唯一值，以保持整个时域有限差分 (FDTD) 方法的二阶精度。\n\n给定的 ADE 描述了非线性极化 $P(x,t)$ 的演化，其形式如下：\n$$\n\\frac{\\partial P}{\\partial t} = F(E,P) = -\\gamma P + \\sigma |E|^{2} E\n$$\n对于每个空间位置 $x$ 上的 $P$ 而言，这是一个关于时间的一阶常微分方程。电场 $E(x,t)$ 充当一个随时间变化的强迫项。\n\n提出的用于在时间步长 $\\Delta t$ 内，从时间 $t^n = n\\Delta t$ 到 $t^{n+1} = (n+1)\\Delta t$ 对该 ADE 进行积分的数值格式为：\n$$\nP^{n+1} = P^{n} + \\Delta t \\left[(1-\\theta) F(E^{n},P^{n}) + \\theta F(E^{n+1},P^{n+1})\\right]\n$$\n这是一个通用的单参数、两层隐式格式，其中 $P^n$ 表示 $P(t^n)$ 的数值近似。当 $\\theta=0$ 时，它是显式欧拉法；当 $\\theta=1$ 时，它是隐式欧拉法；当 $\\theta=1/2$ 时，它是梯形法则（或 Crank-Nicolson 方法）。\n\n为确保耦合的 FDTD 系统在时间上保持二阶精度，ADE 的数值积分也必须是二阶精确的。这意味着该方法对 $P$ 的全局误差必须是 $O(\\Delta t^2)$ 阶。对于单步法，这要求局部截断误差 (LTE) 是 $O(\\Delta t^3)$ 阶。\n\n让我们进行泰勒级数一致性分析来确定 LTE。LTE 记为 $T^{n+1}$，是将精确解 $P(t)$ 代入数值公式后得到的残差。\n$$\nP(t^{n+1}) - P(t^n) - \\Delta t \\left[(1-\\theta) F(E(t^n), P(t^n)) + \\theta F(E(t^{n+1}), P(t^{n+1}))\\right] = T^{n+1}\n$$\n我们将所有随时间变化的项在时间 $t^n$ 附近进行展开。令 $\\dot{f}$ 表示全时间导数 $df/dt$。\n精确解 $P(t^{n+1})$ 的泰勒级数为：\n$$\nP(t^{n+1}) = P(t^n) + \\Delta t \\dot{P}(t^n) + \\frac{\\Delta t^2}{2} \\ddot{P}(t^n) + O(\\Delta t^3)\n$$\n从控制 ADE，我们有 $\\dot{P}(t) = F(E(t), P(t))$。我们将其记为 $\\dot{P} = F$。对时间求导得到 $\\ddot{P} = \\dot{F}$。将这些代入 $P(t^{n+1})$ 的展开式，得到：\n$$\nP(t^{n+1}) = P(t^n) + \\Delta t F(t^n) + \\frac{\\Delta t^2}{2} \\dot{F}(t^n) + O(\\Delta t^3)\n$$\n这里，$F(t^n)$ 是 $F(E(t^n), P(t^n))$ 的简写。\n\n接下来，我们将项 $F(E(t^{n+1}), P(t^{n+1})) \\equiv F(t^{n+1})$ 在 $t^n$ 附近展开：\n$$\nF(t^{n+1}) = F(t^n) + \\Delta t \\dot{F}(t^n) + O(\\Delta t^2)\n$$\n现在，我们将这些展开式代回局部截断误差 $T^{n+1}$ 的方程中：\n$$\nT^{n+1} = \\left( P(t^n) + \\Delta t F(t^n) + \\frac{\\Delta t^2}{2} \\dot{F}(t^n) \\right) - P(t^n) - \\Delta t \\left[ (1-\\theta) F(t^n) + \\theta \\left( F(t^n) + \\Delta t \\dot{F}(t^n) \\right) \\right] + O(\\Delta t^3)\n$$\n化简各项：\n$$\nT^{n+1} = \\Delta t F(t^n) + \\frac{\\Delta t^2}{2} \\dot{F}(t^n) - \\Delta t \\left[ (1-\\theta+\\theta) F(t^n) + \\theta \\Delta t \\dot{F}(t^n) \\right] + O(\\Delta t^3)\n$$\n$$\nT^{n+1} = \\Delta t F(t^n) + \\frac{\\Delta t^2}{2} \\dot{F}(t^n) - \\Delta t F(t^n) - \\theta \\Delta t^2 \\dot{F}(t^n) + O(\\Delta t^3)\n$$\n如一个相容格式所预期的那样，$\\Delta t$ 阶的项相互抵消。我们剩下 $\\Delta t^2$ 阶和更高阶的项：\n$$\nT^{n+1} = \\left(\\frac{1}{2} - \\theta\\right) \\Delta t^2 \\dot{F}(t^n) + O(\\Delta t^3)\n$$\n为使该方法达到二阶精度，局部截断误差必须是 $O(\\Delta t^3)$ 阶。这要求 $\\Delta t^2$ 项的系数为零。\n$$\n\\left(\\frac{1}{2} - \\theta\\right) \\dot{F}(t^n) = 0\n$$\n由于该问题具有物理意义且模拟了非线性动力学，我们不能假设 $\\dot{F}(t) = dF/dt$ 在所有时间以及对所有可能的场 $E(t)$ 都恒等于零。因此，为了使该条件普遍成立，其系数必须为零：\n$$\n\\frac{1}{2} - \\theta = 0\n$$\n这得出了时间中心化参数的唯一值：\n$$\n\\theta = \\frac{1}{2}\n$$\n$\\theta = 1/2$ 这个选择对应于梯形法则，也称为 Crank-Nicolson 方法。已知该方法（对于线性问题）是无条件稳定的并且是二阶精确的。该分析证实了在这类格式中，这是实现二阶精度的唯一选择。\n\n这个结果是充分且必要的。如果 $\\theta \\neq 1/2$，LTE 是 $O(\\Delta t^2)$，这将导致一阶精确的全局解 ($O(\\Delta t)$)。如果 $\\theta=1/2$，LTE 是 $O(\\Delta t^3)$，这保证了二阶精确的全局解 ($O(\\Delta t^2)$)。这保持了 FDTD 格式的整体二阶精度，因为极化项的更新精度阶数与 Yee 网格上麦克斯韦方程组中其他项的精度阶数相同。\n另一种理解方式是，标准的 FDTD 方法是二阶精确的，因为它使用在半整数时间步（例如 $t^{n+1/2}$）上中心化的中心差分。电场 $E$ 的更新涉及项 $\\partial P / \\partial t$，该项需要在 $t^{n+1/2}$ 处以二阶精度进行近似。该格式通过 $(P^{n+1}-P^n)/\\Delta t$ 来近似此导数，其值等于 $(1-\\theta)F^n + \\theta F^{n+1}$。为了使其成为 $F^{n+1/2} = (\\partial P/\\partial t)^{n+1/2}$ 的二阶近似，加权平均必须在时间上是中心化的，这要求权重相等，即 $1-\\theta = \\theta$，这再次导向 $\\theta = 1/2$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        }
    ]
}