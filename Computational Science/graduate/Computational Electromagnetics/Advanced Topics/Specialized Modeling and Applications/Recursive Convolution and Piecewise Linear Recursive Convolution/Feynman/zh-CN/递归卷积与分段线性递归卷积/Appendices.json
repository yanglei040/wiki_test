{
    "hands_on_practices": [
        {
            "introduction": "任何时域仿真的准确性都取决于正确的初始条件。本练习将指导您从第一性原理出发，推导在静态过去（即 $t < 0$ 时系统处于静止状态）的因果假设下，Debye 介质中极化的初始值。这项实践强调了将连续物理定律（）转化为离散数值模拟的起点的重要性，确保仿真从一个物理上一致的状态开始。",
            "id": "3344915",
            "problem": "考虑一种线性各向同性德拜介电材料，其本构关系为 $D(t) = \\epsilon_0 \\epsilon_{\\infty} E(t) + P(t)$，其中 $D(t)$ 是电位移场，$E(t)$ 是电场，$P(t)$ 是电极化密度，$\\epsilon_0$ 是真空介电常数，$\\epsilon_{\\infty}$ 是无限频率下的相对介电常数。德拜极化遵循一阶弛豫定律 $\\tau \\,\\frac{dP}{dt} + P = \\epsilon_0 \\left(\\epsilon_{s} - \\epsilon_{\\infty}\\right) E(t)$，其弛豫时间为 $\\tau$，静态相对介电常数为 $\\epsilon_s$。在时域有限差分（FDTD）方法中，在离散时间 $t^{n} = n\\,\\Delta t$ 上进行时间步进，并使用递归卷积（RC）或分段线性递归卷积（PLRC）来包含材料色散。\n\n假设系统在过去处于静止状态，即对于 $t  0$ 有 $E(t) = 0$，并假设模拟在 $t^{0} = 0$ 时刻初始化，此时已知 $E^{0} = E(0)$。推导在德拜弛豫条件下，与因果性和静止历史一致的初始值 $P^{0}$，并用给定的数据和材料参数明确表示 $P^{0}$。你的推导必须从所述的德拜定律和由静止历史所蕴含的因果卷积出发，并且必须证明在 $t \\to 0^{+}$ 时的极限值是合理的。\n\n然后，定性地讨论（讨论中无需计算）在RC和PLRC启动的背景下，如果激励在 $t=0$ 时包含一个冲激分量（建模为狄拉克δ函数 $\\delta(t)$），情况会发生什么变化。不要使用特定于RC或PLRC的任何中间快捷公式；将你的推理建立在基本的德拜定律和因果性之上。\n\n请以单个闭式表达式的形式提供 $P^{0}$ 的最终答案。无需四舍五入，最终表达式中不应包含单位。",
            "solution": "该问题要求在计算电磁学背景下，为处于静止历史条件下的德拜介电材料推导初始极化值 $P^{0} = P(t=0)$。问题还要求对冲激激励的影响进行定性讨论。\n\n首先，我们对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 本构关系: $D(t) = \\epsilon_0 \\epsilon_{\\infty} E(t) + P(t)$\n- 德拜弛豫定律: $\\tau \\,\\frac{dP}{dt} + P = \\epsilon_0 \\left(\\epsilon_{s} - \\epsilon_{\\infty}\\right) E(t)$\n- 材料参数: 弛豫时间 $\\tau$、真空介电常数 $\\epsilon_0$、静态相对介电常数 $\\epsilon_s$、无限频率下的相对介电常数 $\\epsilon_{\\infty}$\n- 时间离散化背景: $t^{n} = n\\,\\Delta t$\n- 初始和边界条件: 静止过去（当 $t  0$ 时 $E(t) = 0$），模拟从 $t^{0}=0$ 开始，已知有限值 $E^{0} = E(0)$。\n- 任务1: 推导初始值 $P^{0} = P(0)$。\n- 任务2: 定性讨论如果激励包含狄拉克δ函数 $\\delta(t)$ 会发生什么变化。\n- 约束: 推导必须基于基本的德拜定律和因果性，而非特定的数值方案公式（如RC或PLRC）。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为德拜模型是介电弛豫的典型表示。所有方程和概念都是物理学和计算电磁学中的标准内容。该问题是适定的、客观的，并包含足够的信息来确定在指定条件下 $P^0$ 的唯一解。它不违反任何无效性标准。\n\n**结论**\n该问题有效。\n\n我们现在开始求解。根据要求，我们的推导将基于连续时间公式，因为初始值 $P^{0}$ 必须对应于物理值 $P(t=0)$，以确保数值模拟从物理上一致的状态开始。\n\n德拜极化 $P(t)$ 的动力学由以下一阶线性常微分方程决定：\n$$\n\\tau \\frac{dP(t)}{dt} + P(t) = \\epsilon_0 \\left(\\epsilon_s - \\epsilon_{\\infty}\\right) E(t)\n$$\n该方程可以使用积分因子 $\\mu(t) = \\exp(t/\\tau)$ 求解。将方程两边乘以 $\\mu(t)$ 可得：\n$$\n\\exp\\left(\\frac{t}{\\tau}\\right) \\left( \\tau \\frac{dP(t)}{dt} + P(t) \\right) = \\exp\\left(\\frac{t}{\\tau}\\right) \\epsilon_0 \\left(\\epsilon_s - \\epsilon_{\\infty}\\right) E(t)\n$$\n左侧可以看作一个乘积的导数：\n$$\n\\tau \\frac{d}{dt} \\left( P(t) \\exp\\left(\\frac{t}{\\tau}\\right) \\right) = \\exp\\left(\\frac{t}{\\tau}\\right) \\epsilon_0 \\left(\\epsilon_s - \\epsilon_{\\infty}\\right) E(t)\n$$\n为了求得 $P(t)$，我们将此方程对时间从起点 $t_0$ 积分到 $t$。问题指明了“静止过去”，意味着系统在施加任何激励之前都处于静止状态。这表明对于任何时间 $t'  0$，电场和极化均为零：$E(t') = 0$ 且 $P(t') = 0$。这个因果条件允许我们将积分下限设为 $-\\infty$。\n$$\n\\int_{-\\infty}^{t} \\tau \\frac{d}{dt'} \\left( P(t') \\exp\\left(\\frac{t'}{\\tau}\\right) \\right) dt' = \\int_{-\\infty}^{t} \\exp\\left(\\frac{t'}{\\tau}\\right) \\epsilon_0 \\left(\\epsilon_s - \\epsilon_{\\infty}\\right) E(t') dt'\n$$\n计算左侧的积分得到：\n$$\n\\tau \\left[ P(t') \\exp\\left(\\frac{t'}{\\tau}\\right) \\right]_{-\\infty}^{t} = \\tau P(t) \\exp\\left(\\frac{t}{\\tau}\\right) - \\tau \\lim_{t' \\to -\\infty} P(t') \\exp\\left(\\frac{t'}{\\tau}\\right)\n$$\n鉴于静止过去，$P(t')=0$ 对所有 $t'  0$ 成立，因此极限项为零。我们剩下：\n$$\n\\tau P(t) \\exp\\left(\\frac{t}{\\tau}\\right) = \\epsilon_0 \\left(\\epsilon_s - \\epsilon_{\\infty}\\right) \\int_{-\\infty}^{t} \\exp\\left(\\frac{t'}{\\tau}\\right) E(t') dt'\n$$\n由于当 $t'  0$ 时 $E(t') = 0$，右侧积分的下限可以改为 $0$：\n$$\n\\tau P(t) \\exp\\left(\\frac{t}{\\tau}\\right) = \\epsilon_0 \\left(\\epsilon_s - \\epsilon_{\\infty}\\right) \\int_{0}^{t} \\exp\\left(\\frac{t'}{\\tau}\\right) E(t') dt'\n$$\n求解 $P(t)$，我们得到极化的因果卷积积分形式：\n$$\nP(t) = \\frac{\\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty})}{\\tau} \\int_{0}^{t} \\exp\\left(-\\frac{t-t'}{\\tau}\\right) E(t') dt'\n$$\n我们需要求解的是初始值 $P^{0}$，即 $P(t)$ 在 $t=0$ 时的值。更准确地说，我们关心的是当 $t$ 从正方向趋近于 $0$ 时的极限，即 $P(0^+) = P^0$。\n$$\nP^{0} = \\lim_{t \\to 0^+} \\frac{\\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty})}{\\tau} \\int_{0}^{t} \\exp\\left(-\\frac{t-t'}{\\tau}\\right) E(t') dt'\n$$\n对于问题的第一部分，假定电场 $E(t)$ 是非冲激的，意味着它在 $t=0$ 时取有限值 $E(0) = E^0$。被积函数是两个有界函数 $\\exp(-\\frac{t-t'}{\\tau})$ 和 $E(t')$ 的乘积，因此在积分区间 $[0, t]$ 上是有界的。当 $t \\to 0^+$ 时，积分区间的长度缩减为零。一个有界函数在测度为零的区间上的积分等于零。\n因此，\n$$\nP^{0} = 0\n$$\n这个结果非常重要：对于任何非冲激激励，极化的弛豫部分必须从零开始。这是因果性和有限弛豫时间 $\\tau$ 的直接结果。极化代表了分子偶极子的物理取向，这个过程需要有限的时间，不能在响应一个有限电场时瞬时发生。\n\n另一种物理解释使用了高频极限。频域介电常数为 $\\epsilon(\\omega) = \\epsilon_\\infty + \\frac{\\epsilon_s - \\epsilon_\\infty}{1 + i\\omega\\tau}$。时域中 $t \\to 0^+$ 的行为对应于频域中 $\\omega \\to \\infty$ 的行为。在此极限下，$\\epsilon(\\omega) \\to \\epsilon_\\infty$。这意味着在施加电场的瞬间，材料仅通过其瞬时极化机制进行响应，该机制由 $\\epsilon_\\infty$ 表征。因此，总的电位移为 $D(0^+) = \\epsilon_0 \\epsilon_\\infty E(0^+)$。根据基本本构关系，我们也有 $D(0^+) = \\epsilon_0 \\epsilon_\\infty E(0^+) + P(0^+)$。直接比较这两个表达式可以得出 $P(0^+) = 0$。\n\n现在，进行关于冲激激励的定性讨论：\n如果激励 $E(t)$ 在原点包含一个冲激分量，建模为狄拉克δ函数，例如 $E(t) = E_{impulse} \\delta(t)$，情况将发生巨大变化。δ函数不是有界函数，其积分非零。让我们回到控制常微分方程：\n$$\n\\tau \\frac{dP}{dt} + P = \\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty}) E_{impulse} \\delta(t)\n$$\n将此方程在无穷小区间 $t=0^-$ 到 $t=0^+$ 上积分：\n$$\n\\int_{0^-}^{0^+} \\left( \\tau \\frac{dP}{dt} + P(t) \\right) dt = \\int_{0^-}^{0^+} \\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty}) E_{impulse} \\delta(t) dt\n$$\n由于δ函数的筛选性质，右侧积分结果为 $\\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty}) E_{impulse}$。左侧变为：\n$$\n\\tau \\int_{0^-}^{0^+} \\frac{dP}{dt} dt + \\int_{0^-}^{0^+} P(t) dt = \\tau [P(0^+) - P(0^-)] + \\int_{0^-}^{0^+} P(t) dt\n$$\n根据因果性，$P(0^-) = 0$。如果 $P(t)$ 在 $t=0$ 处最多表现为有限的跳跃间断，那么它在无穷小区间上的积分为零。因此，方程简化为：\n$$\n\\tau P(0^+) = \\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty}) E_{impulse}\n$$\n这导致在冲激之后存在一个非零的初始极化：\n$$\nP(0^+) = \\frac{\\epsilon_0 (\\epsilon_s - \\epsilon_{\\infty})}{\\tau} E_{impulse}\n$$\n冲激电场会导致极化的瞬时跳变。对于像RC和PLRC这样的数值方法，这一点至关重要。这些算法通常假设场在一个时间步长 $\\Delta t$ 内是分段常数（RC）或分段线性（PLRC）的。狄拉克δ函数违反了这一假设。标准的实现将无法捕捉其效应。因此，对于冲激激励，初始值 $P^0$ 不能设置为零，而必须设置为解析推导出的值 $P(0^+)$。这些方案中使用的递归累加器也需要进行特殊的非零初始化，该初始化值由极化率与δ函数的解析卷积导出。若不这样做，将导致模拟与底层物理不一致。\n\n总之，对于主问题中指定的非冲激情况，初始值为 $P^0=0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "像分段线性递归卷积（PLRC）这样的高阶数值方案，在计算第一个时间步时通常需要前一个时间步的数据。本练习探讨了如何为 PLRC 方法设计一个一致的启动程序（），即如何确定在 $t=0$ 之前的虚拟时间点 $t = -\\Delta t$ 的场值。通过确保这些“历史”值与控制方程和 PLRC 的线性假设相容，我们可以避免引入虚假的数值瞬态，从而提高仿真的整体保真度。",
            "id": "3344849",
            "problem": "在一个时域有限差分 (FDTD) 代码中，使用分段线性递推卷积 (PLRC) 来模拟一个色散、各向同性的 Debye 介质。电通量密度为 $D = \\epsilon_{0}\\epsilon_{\\infty} E + P$，其中 $E$ 是电场，$P$ 是极化密度，$\\epsilon_{0}$ 是真空介电常数，$\\epsilon_{\\infty}$ 是无穷大频率下的相对介电常数。Debye 材料本构关系由以下常微分方程给出：\n$$\\frac{dP}{dt} + \\frac{1}{\\tau} P = \\epsilon_{0}\\frac{\\Delta \\epsilon}{\\tau} E,$$\n其中 $\\Delta \\epsilon = \\epsilon_{s} - \\epsilon_{\\infty}$，$\\epsilon_{s}$ 是静态相对介电常数，$\\tau$ 是弛豫时间。麦克斯韦-安培定律（无磁化）为\n$$\\nabla \\times H = \\frac{\\partial D}{\\partial t} + J,$$\n其中 $H$ 是磁场，$J$ 是给定的电流密度源。\n\n在 PLRC 中，$E(t)$ 在每个时间间隔 $[t^{n-1}, t^{n}]$（其中 $t^{n} = n\\,\\Delta t$）上被近似为线性，因此 $P^{n}$ 的递推更新需要 $E^{n-1}$ 和 $P^{n-1}$ 的值。在初始步骤 $n = 0$ 时，向后的值 $E^{-1}$ 和 $P^{-1}$ 尚未定义。你需要设计一个启动过程来初始化 $E^{-1}$ 和 $P^{-1}$，以避免伪瞬态，并且该过程要与 PLRC 在 $t = 0$ 附近的时间线性假设相一致。\n\n假设在 $t = 0$ 时，初始场 $E^{0}$、$P^{0}$、磁场的旋度 $(\\nabla \\times H)^{0}$ 和源 $J^{0}$ 是已知的。时间步长为 $\\Delta t  0$。下列哪种启动过程能够达到与 PLRC 中隐含的线性近似的一阶一致性，从而在一般情况下避免伪瞬态？\n\nA. 使用与控制方程一致的向后线性外推：根据 Debye 定律计算 $\\dot{P}(0)$，\n$$\\dot{P}(0) = \\epsilon_{0}\\frac{\\Delta \\epsilon}{\\tau} E^{0} - \\frac{1}{\\tau} P^{0},$$\n然后根据麦克斯韦-安培定律计算 $\\dot{E}(0)$，\n$$\\epsilon_{0}\\epsilon_{\\infty}\\,\\dot{E}(0) + \\dot{P}(0) = (\\nabla \\times H)^{0} - J^{0},$$\n并设置\n$$E^{-1} = E^{0} - \\Delta t\\,\\dot{E}(0), \\quad P^{-1} = P^{0} - \\Delta t\\,\\dot{P}(0)。$$\n\nB. 假设过去状态是静止的，不考虑初始斜率：设置\n$$E^{-1} = E^{0}, \\quad P^{-1} = P^{0}。$$\n\nC. 在分段常数场的假设下强制执行精确的 Debye 回溯步，同时保持 $E$ 连续：设置\n$$E^{-1} = E^{0}, \\quad P^{-1} = e^{\\Delta t/\\tau}\\,P^{0} - \\epsilon_{0}\\,\\Delta \\epsilon\\,\\big(e^{\\Delta t/\\tau} - 1\\big)\\,E^{0}。$$\n\nD. 对于之前的值，在 $t = 0$ 时强制瞬时静态平衡：设置\n$$E^{-1} = E^{0}, \\quad P^{-1} = \\epsilon_{0}\\,\\Delta \\epsilon\\,E^{0}。$$\n\nE. 在启动时忽略极化率来估计 $E$ 的初始斜率：设置 $\\dot{P}(0) = 0$，从\n$$\\epsilon_{0}\\epsilon_{\\infty}\\,\\dot{E}(0) = (\\nabla \\times H)^{0} - J^{0},$$\n计算 $\\dot{E}(0)$，并设置\n$$E^{-1} = E^{0} - \\Delta t\\,\\dot{E}(0), \\quad P^{-1} = P^{0}。$$",
            "solution": "问题陈述在科学上是合理的、适定的，并包含了为指定数值方法确定一个一致启动过程所需的所有必要信息。控制方程是 Debye 介质中电磁学的标准模型。这个问题是实现时域计算方案时一个实际且不平凡的方面。因此，该问题是成立的。\n\n分段线性递推卷积 (PLRC) 方法的核心是假设电场 $E(t)$ 在每个时间步长区间 $[t^{n-1}, t^{n}]$ 上线性变化。对于初始步骤（即从 $t^{0} = 0$ 的状态计算 $t^{1} = \\Delta t$ 时的场），该方法需要知道 $t^{-1} = -\\Delta t$ 时的场。启动过程必须以一种与此潜在线性假设一致的方式定义 $E^{-1}$ 和 $P^{-1}$，以避免引入非物理的、虚假的瞬态。\n\n最一致的方法是断言，由 $t=0$ 时的控制物理学决定的场的线性行为，也描述了紧邻之前历史中的场，特别是在区间 $[-\\Delta t, 0]$ 上。这可以通过一阶向后泰勒展开（线性外推）来实现：\n$$E^{-1} = E(-\\Delta t) \\approx E(0) - \\Delta t \\left. \\frac{dE}{dt} \\right|_{t=0} = E^{0} - \\Delta t \\dot{E}(0)$$\n$$P^{-1} = P(-\\Delta t) \\approx P(0) - \\Delta t \\left. \\frac{dP}{dt} \\right|_{t=0} = P^{0} - \\Delta t \\dot{P}(0)$$\n为了使用这些关系，我们必须根据控制方程和 $t=0$ 时的已知初始状态：$E^{0}$、$P^{0}$、$(\\nabla \\times H)^{0}$ 和 $J^{0}$ 来确定时间导数 $\\dot{E}(0)$ 和 $\\dot{P}(0)$。\n\n首先，我们使用 Debye 材料本构关系来求 $\\dot{P}(0)$：\n$$\\frac{dP}{dt} + \\frac{1}{\\tau} P = \\epsilon_{0}\\frac{\\Delta \\epsilon}{\\tau} E$$\n在 $t=0$ 处求值并求解导数可得：\n$$\\dot{P}(0) = \\epsilon_{0}\\frac{\\Delta \\epsilon}{\\tau} E^{0} - \\frac{1}{\\tau} P^{0}$$\n\n接下来，我们使用麦克斯韦-安培定律来求 $\\dot{E}(0)$。该定律为：\n$$\\nabla \\times H = \\frac{\\partial D}{\\partial t} + J$$\n电通量密度为 $D = \\epsilon_{0}\\epsilon_{\\infty} E + P$，所以其时间导数为 $\\frac{\\partial D}{\\partial t} = \\epsilon_{0}\\epsilon_{\\infty} \\frac{\\partial E}{\\partial t} + \\frac{\\partial P}{\\partial t}$。将此代入安培定律，我们得到：\n$$\\nabla \\times H = \\epsilon_{0}\\epsilon_{\\infty} \\frac{\\partial E}{\\partial t} + \\frac{\\partial P}{\\partial t} + J$$\n在 $t=0$ 处计算此方程：\n$$(\\nabla \\times H)^{0} = \\epsilon_{0}\\epsilon_{\\infty} \\dot{E}(0) + \\dot{P}(0) + J^{0}$$\n求解 $\\epsilon_{0}\\epsilon_{\\infty} \\dot{E}(0)$：\n$$\\epsilon_{0}\\epsilon_{\\infty} \\dot{E}(0) = (\\nabla \\times H)^{0} - J^{0} - \\dot{P}(0)$$\n这个方程可以用来求 $\\dot{E}(0)$，因为在 $t=0$ 时右边的所有项都是已知的，包括刚刚确定的 $\\dot{P}(0)$。\n\n在求出 $\\dot{E}(0)$ 和 $\\dot{P}(0)$ 后，我们可以计算前一个时间步所需的值：\n$$E^{-1} = E^{0} - \\Delta t\\,\\dot{E}(0)$$\n$$P^{-1} = P^{0} - \\Delta t\\,\\dot{P}(0)$$\n这个过程确立了 $E^{-1}$ 和 $P^{-1}$ 的值，这些值在 $t=0$ 时与控制物理学以及 PLRC 的时间线性假设在 $\\Delta t$ 上达到一阶一致。\n\n现在，我们评估每个选项：\n\nA. 这个选项提议先计算 $\\dot{P}(0)$，然后计算 $\\dot{E}(0)$，最后使用向后线性外推来设置 $E^{-1}$ 和 $P^{-1}$。这个计算序列与上面的推导完全相同。这是确保一阶一致性并避免启动引起的数值伪影的正确方法。\n**结论：正确**\n\nB. 这个选项建议设置 $E^{-1} = E^{0}$ 和 $P^{-1} = P^{0}$。这意味着 $\\dot{E}(0)=0$ 和 $\\dot{P}(0)=0$，这是一个零阶保持假设。这通常是错误的，并且违反了控制方程，除非系统恰好处于静态、无源的状态。这种突然施加零导数的做法会导致 $t=0$ 时场的变化率出现不连续，从而产生伪瞬态。\n**结论：不正确**\n\nC. 这个选项建议设置 $E^{-1} = E^{0}$ 并使用一个公式计算 $P^{-1}$，该公式是在假设 $t \\in [-\\Delta t, 0]$ 区间内 $E(t)$ 是常数且等于 $E^{0}$ 的前提下，从 Debye 常微分方程的精确解推导出来的。这里有两个根本性的缺陷。首先，PLRC 方法假设 $E(t)$ 是分段*线性*的，而不是分段*常数*的，因此这个启动过程与它旨在初始化的数值方案的核心假设不一致。其次，它通过设置 $E^{-1} = E^0$ 任意地假设了 $\\dot{E}(0)=0$，这通常是不正确的。\n**结论：不正确**\n\nD. 这个选项建议设置 $E^{-1} = E^{0}$ 和 $P^{-1} = \\epsilon_{0}\\,\\Delta \\epsilon\\,E^{0}$。第二部分将 $P^{-1}$ 设置为与场 $E^{0}$ 对应的静态平衡值。这个过程忽略了实际的初始极化 $P^{0}$，并假设系统在 $t=0$ 之前处于静态平衡状态，这完全是任意的，并且通常不成立。它还错误地假设了 $\\dot{E}(0)=0$。\n**结论：不正确**\n\nE. 这个选项建议设置 $\\dot{P}(0) = 0$ 和 $P^{-1} = P^{0}$。这意味着对 $P$ 进行零阶保持，这通常是不正确的，因为它未能在 $t=0$ 时满足 Debye 方程。然后，它使用 $\\dot{P}(0)=0$ 这个不正确的假设，从麦克斯韦方程组中计算 $\\dot{E}(0)$ 的估计值。整个过程都基于一个任意且在物理上不合理的简化，即忽略了初始时刻的极化动力学。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了正确设置初始条件的理论基础后，我们可以进一步通过编码实践来比较不同卷积方法的性能。本练习要求您实现标准的递归卷积（RC）和分段线性递归卷积（PLRC）方法，并量化它们在面对具有显著步内曲率的驱动场时的精度差异（）。通过将数值结果与高精度参考解进行比较，您将直观地理解 PLRC 在提高含时模拟精度方面的优势，尤其是在处理快速变化的场时。",
            "id": "3344913",
            "problem": "您需要实现并比较在线性德拜介电介质中，由具有显著步内曲率的给定入射电场驱动时，电极化的两种时域更新方案。介质遵循德拜本构定律，在时域中可表示为关于电极化的常微分方程。您的程序必须使用标准的递归卷积 (RC) 方法和分段线性递归卷积 (PLRC) 方法计算数值极化历史，然后根据离散线性化残差，量化它们相对于高精度参考解的误差。\n\n从以下基本基础开始：\n- 频率相关介电常数的德拜本构模型：\n$$\\epsilon(\\omega) = \\epsilon_\\infty + \\frac{\\Delta \\epsilon}{1 + j \\omega \\tau},$$ \n其中 $\\epsilon_\\infty$ 是无限频率下的介电常数，$\\Delta \\epsilon$ 是静态增量，$\\tau$ 是弛豫时间常数。\n- 时域德拜极化关系，形式为一阶线性常微分方程：\n$$\\tau \\frac{d P(t)}{dt} + P(t) = \\epsilon_0 \\Delta \\epsilon\\, E(t),$$\n其中 $P(t)$ 是电极化密度，$E(t)$ 是外加电场。此处 $\\epsilon_0$ 是真空介电常数。\n\n您必须仅使用以下建模假设，从这些基本原理推导出两种方法的离散时间更新方程：\n- 对于标准的递归卷积 (RC) 方法，假设电场在每个时间步内为常数。\n- 对于分段线性递归卷积 (PLRC) 方法，假设电场在每个时间步内为线性。\n\n不得假定任何其他快捷公式或预先推导的更新系数；所有更新关系都必须使用上述常微分方程、陈述的近似以及积分因子法或等效的严谨方法推导得出。\n\n将入射电场定义为啁啾高斯窗载波：\n$$E(t) = E_0 \\exp\\!\\left(-\\frac{(t - t_0)^2}{2 \\sigma^2}\\right)\\,\\cos\\!\\left( 2 \\pi f_0 (t - t_0) + \\beta (t - t_0)^2 \\right),$$\n参数为\n- $E_0 = 1$ (单位 $\\mathrm{V/m}$)，\n- $t_0 = 4 \\sigma$，\n- $\\sigma = 20 \\times 10^{-12}$ (单位 $\\mathrm{s}$)，\n- $f_0 = 15 \\times 10^{9}$ (单位 $\\mathrm{Hz}$)，\n- $\\beta = 4 \\times 10^{20}$ (单位 $\\mathrm{rad/s^2}$)。\n\n使用德拜材料参数\n- $\\epsilon_0 = 8.854\\,187\\,8128 \\times 10^{-12}$ (单位 $\\mathrm{F/m}$)，\n- $\\epsilon_\\infty = 1.5$ (无量纲)，\n- $\\Delta \\epsilon = 3.0$ (无量纲)，\n- $\\tau = 15 \\times 10^{-12}$ (单位 $\\mathrm{s}$)。\n\n假设 $P(0) = 0$，$E(0)$ 由上述定义给出。在区间 $t \\in [0, T]$ 上进行仿真，其中 $T = 6 \\sigma$。\n\n参考解要求：\n- 在离散时间 $t_n = n \\Delta t$ 处构建一个高精度的参考解 $P_{\\mathrm{ref}}(t_n)$，方法是在每个步骤上应用极化的精确积分因子更新，并对给定的 $E(t)$ 使用足够精确的数值积分来评估步内积分。由积分因子解产生的积分必须使用足够精细的步内数值积分进行评估，以使参考误差相对于 RC 和 PLRC 的离散化误差可以忽略不计。确保数值积分对于平滑的被积函数至少达到与机器精度一致的准确度。\n\n误差量化：\n- 对于离散样本 $E^n = E(t_n)$，通过二阶差分定义时间索引 $n$ 处的线性化残差\n$$r^n = \\left\\| E^{n+1} - 2 E^{n} + E^{n-1} \\right\\|,$$\n其中范数是绝对值，因为场是标量。此残差是步内曲率的离散代理。\n- 对于每种方法 $M \\in \\{\\mathrm{RC}, \\mathrm{PLRC}\\}$，在 $r^n$ 有定义的索引上计算逐点极化误差 $e_M^n = \\left| P_M^n - P_{\\mathrm{ref}}^n \\right|$。\n- 对于每种方法，计算：\n  1. 在 $r^n$ 有定义的时间索引上的均方根 (RMS) 误差：\n  $$\\mathrm{RMS}_M = \\sqrt{\\frac{1}{N'} \\sum_{n} \\left( e_M^n \\right)^2}.$$\n  2. RMS 残差：\n  $$\\mathrm{RMS}_r = \\sqrt{\\frac{1}{N'} \\sum_{n} \\left( r^n \\right)^2}.$$\n  3. 一个最小二乘比例系数（零截距），用于量化误差如何随残差缩放：\n  $$s_M = \\frac{\\sum_n r^n e_M^n}{\\sum_n (r^n)^2}.$$\n所有误差必须以 $\\mathrm{C/m^2}$ 表示，残差以 $\\mathrm{V/m}$ 表示，比例系数以 $\\mathrm{F/m}$ 表示。\n\n测试套件：\n在相同的场和参数下，为以下三个时间步长运行您的实现：\n- 测试 A：$\\Delta t = 2.0 \\times 10^{-12}$ (单位 $\\mathrm{s}$)。\n- 测试 B：$\\Delta t = 1.0 \\times 10^{-12}$ (单位 $\\mathrm{s}$)。\n- 测试 C：$\\Delta t = 0.5 \\times 10^{-12}$ (单位 $\\mathrm{s}$)。\n\n对于每个测试，报告包含五个浮点数的元组\n$$\\left[ \\mathrm{RMS}_{\\mathrm{RC}},\\ \\mathrm{RMS}_{\\mathrm{PLRC}},\\ s_{\\mathrm{RC}},\\ s_{\\mathrm{PLRC}},\\ \\mathrm{RMS}_r \\right].$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由三个列表组成的列表，每个测试一个，按测试 A、B、C 的顺序排列，每个内部列表包含上述指定的五个值，全部使用 SI 单位。例如，打印输出必须如下所示\n$$\\left[ [x_{A1}, x_{A2}, x_{A3}, x_{A4}, x_{A5}],\\ [x_{B1}, x_{B2}, x_{B3}, x_{B4}, x_{B5}],\\ [x_{C1}, x_{C2}, x_{C3}, x_{C4}, x_{C5}] \\right],$$\n不含任何额外文本。\n\n角度单位：\n- 场相位定义中的所有角度必须以弧度为单位。\n\n百分比：\n- 不适用。\n\n科学真实性：\n- 按原样使用给定的物理常数和参数，不做修改。\n- 确保参考解的每个时间步内的数值积分足够精细，对于平滑函数而言，其误差可以合理地忽略不计。\n\n您的实现必须是完全自包含的，并且不得读取任何输入。所有输出必须如上所述，使用 SI 单位，并按照您所用语言的浮点数到字符串转换的默认行为进行四舍五入。",
            "solution": "问题陈述已经过仔细验证，并被确定为有效。其科学基础是计算电磁学原理，特别是介电材料的时域建模。该问题是适定的、客观的、自包含的且计算上可行的。它提出了该领域一个核心的、非平凡的数值分析任务。\n\n问题的核心是求解控制德拜介质中极化 $P(t)$ 的一阶线性常微分方程 (ODE)，该介质由电场 $E(t)$ 驱动：\n$$ \\tau \\frac{d P(t)}{dt} + P(t) = \\epsilon_0 \\Delta \\epsilon\\, E(t) $$\n这里，$\\tau$ 是弛豫时间，$\\epsilon_0$ 是真空介电常数，$\\Delta \\epsilon$ 是静态介电常数增量。为方便表示，令 $C_1 = \\epsilon_0 \\Delta \\epsilon$。\n\n为了推导数值更新方案，我们首先找到 ODE 在从 $t_n = n \\Delta t$ 到 $t_{n+1} = (n+1) \\Delta t$ 的单个时间步上的形式解。将 ODE 重排为标准线性形式并使用积分因子 $e^{t/\\tau}$，我们从 $t_n$ 积分到 $t_{n+1}$：\n$$ \\frac{d}{dt} \\left[ P(t) e^{t/\\tau} \\right] = \\frac{C_1}{\\tau} E(t) e^{t/\\tau} $$\n$$ \\left[ P(t) e^{t/\\tau} \\right]_{t_n}^{t_{n+1}} = \\int_{t_n}^{t_{n+1}} \\frac{C_1}{\\tau} E(t) e^{t/\\tau} dt $$\n求解以 $P(t_n)$（表示为 $P^n$）表示的 $P(t_{n+1})$（表示为 $P^{n+1}$），得到精确的更新关系：\n$$ P^{n+1} = P^n e^{-\\Delta t/\\tau} + \\frac{C_1}{\\tau} \\int_{t_n}^{t_{n+1}} e^{-(t_{n+1}-t)/\\tau} E(t) dt $$\n标准的递归卷积 (RC) 和分段线性递归卷积 (PLRC) 方法是通过在积分内对电场 $E(t)$ 应用不同的近似来推导的。\n\n**标准递归卷积 (RC)**\nRC 方法假设电场在每个时间步内是恒定的，即对于 $t \\in [t_n, t_{n+1}]$，$E(t) \\approx E(t_n) \\equiv E^n$。积分变为：\n$$ \\int_{t_n}^{t_{n+1}} e^{-(t_{n+1}-t)/\\tau} E^n dt = E^n \\int_{t_n}^{t_{n+1}} e^{-(t_{n+1}-t)/\\tau} dt $$\n计算这个初等积分得到：\n$$ E^n \\left[ \\tau e^{-(t_{n+1}-t)/\\tau} \\right]_{t_n}^{t_{n+1}} = E^n (\\tau - \\tau e^{-\\Delta t/\\tau}) = E^n \\tau (1 - e^{-\\Delta t/\\tau}) $$\n将此结果代回形式解，得到 RC 更新方程：\n$$ P^{n+1}_{\\mathrm{RC}} = P^n_{\\mathrm{RC}} e^{-\\Delta t/\\tau} + C_1 (1 - e^{-\\Delta t/\\tau}) E^n $$\n这是一种一阶精度方法。我们定义更新系数 $c_a = e^{-\\Delta t/\\tau}$ 和 $c_b = C_1(1-c_a)$ 以实现高效计算：$P^{n+1}_{\\mathrm{RC}} = c_a P^n_{\\mathrm{RC}} + c_b E^n$。\n\n**分段线性递归卷积 (PLRC)**\nPLRC 方法假设电场在每个时间步内是线性的。对于 $t \\in [t_n, t_{n+1}]$，我们将 $E(t)$ 近似为：\n$$ E(t) \\approx E^n + \\frac{E^{n+1} - E^n}{\\Delta t} (t - t_n) $$\n将此线性近似代入形式解的积分中并执行积分（例如，通过分部积分法），得到以下更新方程，该方程可以用 $P^n$、$E^n$ 和 $E^{n+1}$ 表示：\n$$ P^{n+1}_{\\mathrm{PLRC}} = P^n_{\\mathrm{PLRC}} e^{-\\Delta t/\\tau} + C_1 \\left( \\frac{\\tau}{\\Delta t}(1 - e^{-\\Delta t/\\tau}) - e^{-\\Delta t/\\tau} \\right) E^n + C_1 \\left( 1 - \\frac{\\tau}{\\Delta t}(1 - e^{-\\Delta t/\\tau}) \\right) E^{n+1} $$\n这对应于一个二阶精度（梯形/Crank-Nicolson）格式。为了实现，我们预先计算三个系数：$c_a = e^{-\\Delta t/\\tau}$、$c_{b0} = C_1 \\left( \\frac{\\tau}{\\Delta t}(1-c_a) - c_a \\right)$ 和 $c_{b1} = C_1 \\left( 1 - \\frac{\\tau}{\\Delta t}(1-c_a) \\right)$，得到更新式 $P^{n+1}_{\\mathrm{PLRC}} = c_a P^n_{\\mathrm{PLRC}} + c_{b0} E^n + c_{b1} E^{n+1}$。\n\n**参考解和误差分析**\n通过使用 `scipy` 库中的高阶自适应求积例程，在每个时间步数值计算精确更新关系中的积分，从而计算出高精度参考解 $P_{\\mathrm{ref}}$。这确保了参考解的误差相对于 RC 和 PLRC 方案的离散化误差可以忽略不计。\n\n数值方法的误差是相对于该参考解进行量化的。分析将极化误差与驱动场的局部曲率联系起来。该曲率通过线性化残差 $r^n$ 来测量，定义为电场的未缩放二阶有限差分：\n$$ r^n = | E^{n+1} - 2 E^{n} + E^{n-1} | $$\n每种方法 $M \\in \\{\\mathrm{RC}, \\mathrm{PLRC}\\}$ 的逐点误差是 $e_M^n = | P_M^n - P_{\\mathrm{ref}}^n |$。$r^n$ 和 $e_M^n$ 都是在残差有明确定义的时间索引（$n \\in [1, N-1]$，其中 $N$ 是总时间步数）上计算的。所需的度量指标是误差和残差的均方根 (RMS)，以及通过对模型 $e_M^n \\approx s_M r^n$ 进行最小二乘拟合找到的比例系数 $s_M$。\n\n实现将首先定义入射场，然后对于每个指定的时间步长 $\\Delta t$，生成场样本并使用三种方法（RC、PLRC、参考）求解极化历史。最后，计算并报告指定的误差和残差度量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Implements and compares RC and PLRC methods for Debye polarization, \n    quantifying their errors against a high-accuracy reference solution.\n    \"\"\"\n\n    # Define physical and simulation constants\n    E0 = 1.0  # V/m\n    sigma = 20e-12  # s\n    t0 = 4 * sigma  # s\n    f0 = 15e9  # Hz\n    beta = 4e20  # rad/s^2\n    eps0 = 8.8541878128e-12  # F/m\n    Delta_eps = 3.0  # dimensionless\n    tau = 15e-12  # s\n    \n    C1 = eps0 * Delta_eps # F/m\n\n    # Simulation time\n    T_end = 6 * sigma # s\n\n    # Test suite of time steps\n    test_cases_dt = [2.0e-12, 1.0e-12, 0.5e-12]\n\n    def E_field(t: float) - float:\n        \"\"\"Computes the incident electric field at time t.\"\"\"\n        term_t = t - t0\n        gauss_term = np.exp(-(term_t**2) / (2 * sigma**2))\n        cos_term = np.cos(2 * np.pi * f0 * term_t + beta * term_t**2)\n        return E0 * gauss_term * cos_term\n\n    def solve_rc(E_series, dt, tau_val, C1_val):\n        \"\"\"Computes polarization using the standard RC method.\"\"\"\n        num_pts = len(E_series)\n        P = np.zeros(num_pts, dtype=np.float64)\n        c_a = np.exp(-dt / tau_val)\n        c_b = C1_val * (1 - c_a)\n        for n in range(num_pts - 1):\n            P[n+1] = c_a * P[n] + c_b * E_series[n]\n        return P\n\n    def solve_plrc(E_series, dt, tau_val, C1_val):\n        \"\"\"Computes polarization using the PLRC method.\"\"\"\n        num_pts = len(E_series)\n        P = np.zeros(num_pts, dtype=np.float64)\n        c_a = np.exp(-dt / tau_val)\n        term = tau_val / dt * (1 - c_a)\n        c_b0 = C1_val * (term - c_a)\n        c_b1 = C1_val * (1 - term)\n        for n in range(num_pts - 1):\n            P[n+1] = c_a * P[n] + c_b0 * E_series[n] + c_b1 * E_series[n+1]\n        return P\n\n    def solve_ref(t_grid, dt, tau_val, C1_val):\n        \"\"\"Computes the high-accuracy reference polarization.\"\"\"\n        num_pts = len(t_grid)\n        P = np.zeros(num_pts, dtype=np.float64)\n        c_a = np.exp(-dt / tau_val)\n        \n        for n in range(num_pts - 1):\n            t_n, t_np1 = t_grid[n], t_grid[n+1]\n            \n            def integrand(t_prime):\n                return np.exp(-(t_np1 - t_prime) / tau_val) * E_field(t_prime)\n            \n            # Use high-accuracy quadrature for the integral\n            integral_val, _ = quad(integrand, t_n, t_np1, epsabs=1e-15, epsrel=1e-15)\n            \n            P[n+1] = c_a * P[n] + (C1_val / tau_val) * integral_val\n        return P\n\n    all_results = []\n    for dt in test_cases_dt:\n        # Create time grid\n        num_steps = int(round(T_end / dt))\n        t_grid = np.linspace(0, T_end, num_steps + 1)\n        \n        # Pre-compute E-field on the grid\n        E_series = E_field(t_grid)\n        \n        # Solve for polarization with all three methods\n        P_ref = solve_ref(t_grid, dt, tau, C1)\n        P_rc = solve_rc(E_series, dt, tau, C1)\n        P_plrc = solve_plrc(E_series, dt, tau, C1)\n\n        # Indices for analysis (where r^n is defined)\n        # r^n uses E^{n+1}, E^n, E^{n-1}, so n = 1, ..., num_steps-1\n        # Python indices for these n are 1 to num_steps-1 inclusive\n        analysis_slice = slice(1, num_steps)\n\n        # Calculate linearization residual r^n\n        r = np.abs(E_series[2:] - 2 * E_series[1:-1] + E_series[:-2])\n        \n        # Calculate pointwise errors e_M^n over the analysis range\n        e_rc = np.abs(P_rc[analysis_slice] - P_ref[analysis_slice])\n        e_plrc = np.abs(P_plrc[analysis_slice] - P_ref[analysis_slice])\n        \n        # Number of points for RMS calculations\n        N_prime = len(r)\n\n        # Compute RMS values\n        rms_r = np.sqrt(np.sum(r**2) / N_prime)\n        rms_rc = np.sqrt(np.sum(e_rc**2) / N_prime)\n        rms_plrc = np.sqrt(np.sum(e_plrc**2) / N_prime)\n\n        # Compute scaling coefficients s_M\n        sum_r_sq = np.sum(r**2)\n        s_rc = np.sum(r * e_rc) / sum_r_sq\n        s_plrc = np.sum(r * e_plrc) / sum_r_sq\n        \n        case_results = [rms_rc, rms_plrc, s_rc, s_plrc, rms_r]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified\n    formatted_inner_lists = []\n    for inner_list in all_results:\n        s_inner = ', '.join(map(str, inner_list))\n        formatted_inner_lists.append(f\"[{s_inner}]\")\n    final_output_str = f\"[{', '.join(formatted_inner_lists)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}