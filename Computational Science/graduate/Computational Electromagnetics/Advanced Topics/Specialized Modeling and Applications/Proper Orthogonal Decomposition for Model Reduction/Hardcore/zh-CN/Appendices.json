{
    "hands_on_practices": [
        {
            "introduction": "本练习是掌握恰当正交分解（POD）与伽辽金投影方法的基础。我们将通过一个理想化的数值实验来验证该方法的核心思想。在这个被称为“人造解”的场景中，我们构建一个偏微分方程的解，使其精确地存在于一个已知的低维子空间中。通过这个练习，你将亲手实现从快照收集、POD基生成到降阶模型（ROM）构建与验证的全过程，并验证当降阶模型的阶数足够高时，它能够零误差地复现全阶模型的动态行为。",
            "id": "3435994",
            "problem": "考虑在开区间 $\\left(0,1\\right)$ 上的一个一维扩散偏微分方程 (PDE)，其具有齐次狄利克雷 (Dirichlet) 边界条件和恒定扩散系数。我们使用标准二阶中心有限差分半离散化方法对 $n$ 个内部网格点进行处理。将得到的半离散状态向量表示为 $u\\left(t\\right) \\in \\mathbb{R}^{n}$。该半离散模型是一个线性时不变系统\n$$\n\\frac{d}{dt} u\\left(t\\right) \\;=\\; A\\,u\\left(t\\right), \\quad A \\;=\\; \\nu\\,L_{h},\n$$\n其中 $\\nu \\in \\mathbb{R}_{+}$ 是扩散系数，$L_{h} \\in \\mathbb{R}^{n \\times n}$ 是三对角离散拉普拉斯算子，其元素为\n$$\n\\left(L_{h}\\right)_{i,i} \\;=\\; -\\frac{2}{h^{2}}, \\quad \\left(L_{h}\\right)_{i,i+1} \\;=\\; \\left(L_{h}\\right)_{i+1,i} \\;=\\; \\frac{1}{h^{2}}, \\quad h \\;=\\; \\frac{1}{n+1}, \\quad i \\;=\\; 1,\\dots,n-1.\n$$\n矩阵 $A$ 是实对称负定的，因此可以进行特征分解 $A \\;=\\; V \\Lambda V^{\\top}$，其中 $V \\in \\mathbb{R}^{n \\times n}$ 是标准正交矩阵，$\\Lambda \\in \\mathbb{R}^{n \\times n}$ 是对角矩阵，其对角元严格为负。对于任意初始条件 $u\\left(0\\right)$，其精确解为\n$$\nu\\left(t\\right) \\;=\\; V\\,e^{\\Lambda t}\\,V^{\\top} u\\left(0\\right).\n$$\n\n你需要设计一个人工解实验，使得全阶模型解精确地位于少数选定特征模态所张成的空间中，然后通过计算验证：当 POD 秩至少与活跃模态数量一样大时，适当正交分解 (Proper Orthogonal Decomposition, POD) 与到 POD 子空间的伽辽金 (Galerkin) 投影相结合，能够恢复相同的生成空间，并产生零投影误差。请遵循以下基于原理的步骤。\n\n1) 子空间不变性与人工解。选择一个小的模态指数集 $\\mathcal{K} \\subset \\left\\{1,\\dots,n\\right\\}$，其大小为 $r_{\\mathrm{true}}$（活跃模态的数量）。令 $V_{\\mathcal{K}} \\in \\mathbb{R}^{n \\times r_{\\mathrm{true}}}$ 表示一个矩阵，其列是 $A$ 的相应特征向量，按相关特征值的绝对值升序排列。选择一个非零系数向量 $a \\in \\mathbb{R}^{r_{\\mathrm{true}}}$ 并设置\n$$\nu\\left(0\\right) \\;=\\; V_{\\mathcal{K}}\\,a, \\qquad u\\left(t\\right) \\;=\\; V_{\\mathcal{K}}\\,\\exp\\!\\left(\\Lambda_{\\mathcal{K}} t\\right) a,\n$$\n其中 $\\Lambda_{\\mathcal{K}} \\in \\mathbb{R}^{r_{\\mathrm{true}} \\times r_{\\mathrm{true}}}$ 是对角特征值子矩阵。根据构造，对于每个 $t \\ge 0$，$u\\left(t\\right)$ 均位于 $\\mathrm{span}\\!\\left(V_{\\mathcal{K}}\\right)$ 中，这是一个 A-不变子空间。\n\n2) 快照采集与 POD。在 $m$ 个不同时刻 $0 = t_{1}  t_{2}  \\dots  t_{m} = T$ 采集快照，形成快照矩阵 $X \\in \\mathbb{R}^{n \\times m}$，其列为 $u\\left(t_{j}\\right)$。计算奇异值分解 (singular value decomposition, SVD) $X \\;=\\; U \\Sigma W^{\\top}$，其中 $U \\in \\mathbb{R}^{n \\times n}$ 是标准正交矩阵，$\\Sigma \\in \\mathbb{R}^{n \\times m}$ 是对角非负矩阵，$W \\in \\mathbb{R}^{m \\times m}$ 是标准正交矩阵。对于指定的 POD 秩 $r_{\\mathrm{pod}}$，将 POD 基定义为 $U$ 的前 $r_{\\mathrm{pod}}$ 列，记为 $\\Phi \\in \\mathbb{R}^{n \\times r_{\\mathrm{pod}}}$。\n\n3) POD 投影误差。到 POD 子空间的正交投影算子是 $P \\;=\\; \\Phi \\Phi^{\\top}$。快照的归一化投影误差是\n$$\n\\mathcal{E}_{\\mathrm{proj}} \\;=\\; \\frac{\\left\\| X \\;-\\; P X \\right\\|_{F}}{\\left\\| X \\right\\|_{F}},\n$$\n其中 $\\left\\|\\cdot\\right\\|_{F}$ 表示弗罗贝尼乌斯 (Frobenius) 范数。若 $r_{\\mathrm{pod}} \\ge r_{\\mathrm{true}}$ 且 $\\mathrm{rank}\\left(X\\right) = r_{\\mathrm{true}}$，则在精确计算中 $\\mathcal{E}_{\\mathrm{proj}}$ 必须为零。\n\n4) POD–伽辽金降阶模型。构建伽辽金投影降阶算子\n$$\nA_{r} \\;=\\; \\Phi^{\\top} A \\Phi \\;\\in\\; \\mathbb{R}^{r_{\\mathrm{pod}} \\times r_{\\mathrm{pod}}},\n$$\n以及降阶初始状态 $c\\left(0\\right) \\;=\\; \\Phi^{\\top} u\\left(0\\right)$。演化降阶模型\n$$\n\\frac{d}{dt} c\\left(t\\right) \\;=\\; A_{r}\\,c\\left(t\\right), \\qquad c\\left(t\\right) \\;=\\; e^{A_{r} t} c\\left(0\\right),\n$$\n并重构降阶状态 $u_{r}\\left(t\\right) \\;=\\; \\Phi\\,c\\left(t\\right)$。计算终端时刻相对误差\n$$\n\\mathcal{E}_{\\mathrm{final}} \\;=\\; \\frac{\\left\\| u\\left(T\\right) - u_{r}\\left(T\\right) \\right\\|_{2}}{\\left\\| u\\left(T\\right) \\right\\|_{2}}.\n$$\n若 $r_{\\mathrm{pod}} \\ge r_{\\mathrm{true}}$，则不变性意味着在精确计算中 $u_{r}\\left(t\\right) \\equiv u\\left(t\\right)$，因此 $\\mathcal{E}_{\\mathrm{final}} = 0$。\n\n实现一个程序，该程序从 $\\nu$ 和 $n$ 构建 $A$，计算其特征分解，从选定的模态和系数构造 $u\\left(t\\right)$，建立 POD 基，计算 $\\mathcal{E}_{\\mathrm{proj}}$ 和 $\\mathcal{E}_{\\mathrm{final}}$，并为以下每个测试用例输出这两个误差。在所有情况下，POD 内积是 $\\mathbb{R}^{n}$ 上的欧几里得内积，所有时间值都使用相同的任意单位，并且不需要物理单位。\n\n测试套件（每个用例是一个元组 $\\left(n, \\nu, T, \\mathcal{K}, a, m, r_{\\mathrm{pod}}\\right)$）：\n- 用例 1：$\\left(n=80, \\nu=0.5, T=0.7, \\mathcal{K}=\\left[1,3\\right], a=\\left[1.0,-0.4\\right], m=6, r_{\\mathrm{pod}}=2\\right)$。\n- 用例 2：$\\left(n=60, \\nu=0.2, T=1.3, \\mathcal{K}=\\left[2,5,7\\right], a=\\left[0.7,-1.0,0.5\\right], m=9, r_{\\mathrm{pod}}=3\\right)$。\n- 用例 3：$\\left(n=64, \\nu=1.0, T=0.3, \\mathcal{K}=\\left[4\\right], a=\\left[1.0\\right], m=4, r_{\\mathrm{pod}}=5\\right)$。\n- 用例 4：$\\left(n=60, \\nu=0.2, T=0.8, \\mathcal{K}=\\left[1,4,6\\right], a=\\left[1.0,-0.5,0.3\\right], m=8, r_{\\mathrm{pod}}=2\\right)$。\n\n重要实现细节：\n- 构建 $A$ 时，使用上面定义的三对角矩阵 $L_{h}$ 并乘以扩散系数 $\\nu$。\n- 计算 $A$ 的特征分解为 $A \\;=\\; V \\Lambda V^{\\top}$，并按 $\\left|\\lambda\\right|$ 递增的顺序对特征对进行排序，使得模态指数 $k$ 表示具有第 $k$ 小 $\\left|\\lambda\\right|$ 的特征对。\n- 仅使用 $\\mathcal{K}$ 中选定的特征对和公式 $u\\left(t\\right) \\;=\\; \\sum_{j} a_{j}\\,e^{\\lambda_{k_{j}} t}\\,v_{k_{j}}$ 来构造快照，以确保精确的子空间不变性。\n- 对于每个测试用例，将对 $\\left(\\mathcal{E}_{\\mathrm{proj}}, \\mathcal{E}_{\\mathrm{final}}\\right)$ 作为两个浮点数输出，并附加到单个扁平输出列表中。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个列表，每个测试用例包含 2 个浮点数，按上述用例顺序排列，即\n$$\n\\left[\\mathcal{E}_{\\mathrm{proj}}^{(1)}, \\mathcal{E}_{\\mathrm{final}}^{(1)}, \\mathcal{E}_{\\mathrm{proj}}^{(2)}, \\mathcal{E}_{\\mathrm{final}}^{(2)}, \\mathcal{E}_{\\mathrm{proj}}^{(3)}, \\mathcal{E}_{\\mathrm{final}}^{(3)}, \\mathcal{E}_{\\mathrm{proj}}^{(4)}, \\mathcal{E}_{\\mathrm{final}}^{(4)}\\right],\n$$\n并严格以方括号括起来的逗号分隔列表形式打印。不应打印任何其他文本。所有角度度量、百分比和物理单位均不适用；所有数值输出必须是实数。",
            "solution": "问题陈述构成了一个有效且适定的数值验证实验。它基于偏微分方程数值解、线性代数以及通过适当正交分解 (Proper Orthogonal Decomposition, POD) 和伽辽金 (Galerkin) 投影进行模型降阶的既定原理。所有必需的参数和过程都得到了明确且无矛盾的规定，从而能够得到唯一且有意义的计算结果。我们将着手求解。\n\n问题的核心是验证 POD-伽辽金降阶模型 (reduced-order models, ROMs) 的一个基本性质：如果全阶模型 (full-order model, FOM) 的解在一个低维子空间内演化，那么一个足够秩的 POD-伽辽金 ROM 能够精确表示该解及其动力学，从而产生零误差。\n\n解决方案是通过遵循问题描述中概述的四个基于原理的步骤来实现的。\n\n**1. 系统与人工解的构建**\n\n首先，我们构建半离散线性时不变系统 $\\frac{d}{dt} u(t) = A u(t)$，该系统近似于一维扩散方程。对于长度为 $L=1$、用 $n$ 个内部点离散化的空间域，网格间距为 $h = \\frac{1}{n+1}$。系统矩阵为 $A = \\nu L_h$，其中 $\\nu \\in \\mathbb{R}_{+}$ 是扩散系数，$L_h \\in \\mathbb{R}^{n \\times n}$ 是带有齐次狄利克雷边界条件的拉普拉斯算子的二阶有限差分近似。$L_h$ 是一个实对称三对角矩阵，定义如下：\n$$\n(L_h)_{ij} = \\frac{1}{h^2} \\begin{cases} -2  i=j \\\\ 1  |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n矩阵 $A$ 是对称负定的。其特征分解 $A = V \\Lambda V^{\\top}$ 提供了一组标准正交特征向量基 $V \\in \\mathbb{R}^{n \\times n}$ 和一个对角矩阵 $\\Lambda \\in \\mathbb{R}^{n \\times n}$，其中包含对应的实数负特征值。问题要求特征对 $(\\lambda_k, v_k)$ 按特征值绝对值的升序排列，即 $|\\lambda_1| \\le |\\lambda_2| \\le \\dots \\le |\\lambda_n|$。\n\n然后构造一个人工解，使其精确地位于一个预定的 $A$ 的不变子空间内。我们选择一个包含 $r_{\\mathrm{true}}$ 个模态指数的集合 $\\mathcal{K} \\subset \\{1, \\dots, n\\}$。设 $V_{\\mathcal{K}} \\in \\mathbb{R}^{n \\times r_{\\mathrm{true}}}$ 是以所选特征向量为列的矩阵，$\\Lambda_{\\mathcal{K}} \\in \\mathbb{R}^{r_{\\mathrm{true}} \\times r_{\\mathrm{true}}}$ 是包含相应特征值的对角矩阵。对于给定的系数向量 $a \\in \\mathbb{R}^{r_{\\mathrm{true}}}$，初始条件设置为 $u(0) = V_{\\mathcal{K}} a$。那么，精确的时间演化解由下式给出：\n$$\nu(t) = V e^{\\Lambda t} V^{\\top} u(0) = V e^{\\Lambda t} V^{\\top} V_{\\mathcal{K}} a\n$$\n由于 $V$ 的列是标准正交的，$V^{\\top} V_{\\mathcal{K}}$ 除了对应于 $\\mathcal{K}$ 中索引的行外，均为零。这可将解简化为：\n$$\nu(t) = V_{\\mathcal{K}} e^{\\Lambda_{\\mathcal{K}} t} a\n$$\n根据构造，对于所有 $t \\ge 0$，状态向量 $u(t)$ 始终保持在子空间 $\\mathrm{span}(V_{\\mathcal{K}})$ 中。\n\n**2. 快照采集与 POD 基**\n\n我们在区间 $[0, T]$ 内的不同时间点 $t_j$（其中 $0 = t_1  t_2  \\dots  t_m = T$）采集系统状态 $u(t_j)$ 的 $m$ 个“快照”。这些快照构成了快照矩阵 $X = [u(t_1), u(t_2), \\dots, u(t_m)] \\in \\mathbb{R}^{n \\times m}$ 的列。\n\nPOD 基是一组标准正交向量，能够最优地捕获快照的能量。它是通过对快照矩阵进行奇异值分解 (SVD) $X = U \\Sigma W^{\\top}$ 得到的。这里，$U \\in \\mathbb{R}^{n \\times n}$ 包含左奇异向量（即 POD 模态），$\\Sigma \\in \\mathbb{R}^{n \\times m}$ 是一个包含奇异值 $\\sigma_i \\ge 0$ 的对角矩阵，$W \\in \\mathbb{R}^{m \\times m}$ 包含右奇异向量。秩为 $r_{\\mathrm{pod}}$ 的 POD 基是由 $U$ 的前 $r_{\\mathrm{pod}}$ 列构成的矩阵 $\\Phi \\in \\mathbb{R}^{n \\times r_{\\mathrm{pod}}}$。\n\n**3. POD 投影误差**\n\n到 POD 子空间 $\\mathrm{span}(\\Phi)$ 的正交投影算子是 $P = \\Phi \\Phi^{\\top}$。将快照投影到该子空间所产生的误差，通过残差的归一化弗罗贝尼乌斯范数来量化：\n$$\n\\mathcal{E}_{\\mathrm{proj}} = \\frac{\\| X - P X \\|_{F}}{\\| X \\|_{F}}\n$$\n利用 SVD 的性质，可以从奇异值计算此误差，而无需显式地构造矩阵：\n$$\n\\mathcal{E}_{\\mathrm{proj}} = \\sqrt{\\frac{\\sum_{i=r_{\\mathrm{pod}}+1}^{k} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2}}\n$$\n其中 $k = \\mathrm{rank}(X)$。如果数据位于一个 $r_{\\mathrm{true}}$ 维子空间中，则 $\\mathrm{rank}(X) = r_{\\mathrm{true}}$（假设有足够的快照）。如果 $r_{\\mathrm{pod}} \\ge r_{\\mathrm{true}}$，所有非零奇异值都被捕获，分子变为零，因此在精确计算中 $\\mathcal{E}_{\\mathrm{proj}}$ 必须为零。\n\n**4. POD-伽辽金降阶模型与终端时刻误差**\n\nPOD-伽辽金方法将控制方程投影到 POD 基 $\\Phi$ 上。寻求 $u_r(t) = \\Phi c(t)$ 形式的近似解，其中 $c(t) \\in \\mathbb{R}^{r_{\\mathrm{pod}}}$ 是降阶坐标。将其代入 FOM 并左乘 $\\Phi^{\\top}$，得到降阶模型：\n$$\n\\frac{d}{dt} c(t) = A_r c(t), \\quad \\text{其中} \\quad A_r = \\Phi^{\\top} A \\Phi \\in \\mathbb{R}^{r_{\\mathrm{pod}} \\times r_{\\mathrm{pod}}}\n$$\n初始条件也被投影：$c(0) = \\Phi^{\\top} u(0)$。使用矩阵指数对降阶系统进行时间演化：$c(t) = e^{A_r t} c(0)$。然后将 FOM 解重构为 $u_r(t) = \\Phi c(t)$。\n\n通过在终端时刻 $t=T$ 将其解与人工 FOM 解进行比较，来评估 ROM 的准确性：\n$$\n\\mathcal{E}_{\\mathrm{final}} = \\frac{\\| u(T) - u_r(T) \\|_{2}}{\\| u(T) \\|_{2}}\n$$\n当 $r_{\\mathrm{pod}} \\ge r_{\\mathrm{true}}$ 时，POD 子空间 $\\mathrm{span}(\\Phi)$ 包含不变子空间 $\\mathrm{span}(V_{\\mathcal{K}})$。因此，投影是精确的，$u_r(t)$ 将与 $u(t)$ 完全相同，在精确计算中 $\\mathcal{E}_{\\mathrm{final}}$ 将为零。对于 $r_{\\mathrm{pod}}  r_{\\mathrm{true}}$ 的情况，预计 $\\mathcal{E}_{\\mathrm{proj}}$ 和 $\\mathcal{E}_{\\mathrm{final}}$ 均为非零。以下程序为指定的测试用例计算这两个误差指标。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Implements the POD-Galerkin model reduction experiment for the 1D diffusion equation.\n    \"\"\"\n    test_cases = [\n        # (n, nu, T, K, a, m, r_pod)\n        (80, 0.5, 0.7, [1, 3], [1.0, -0.4], 6, 2),\n        (60, 0.2, 1.3, [2, 5, 7], [0.7, -1.0, 0.5], 9, 3),\n        (64, 1.0, 0.3, [4], [1.0], 4, 5),\n        (60, 0.2, 0.8, [1, 4, 6], [1.0, -0.5, 0.3], 8, 2),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n, nu, T, K, a, m, r_pod = case\n        a_vec = np.array(a)\n\n        # 1. System construction and manufactured solution\n        # Construct the system matrix A\n        h = 1.0 / (n + 1.0)\n        diag_val = -2.0 / (h**2)\n        offdiag_val = 1.0 / (h**2)\n        main_diag = np.full(n, diag_val)\n        off_diag = np.full(n - 1, offdiag_val)\n        L_h = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        A = nu * L_h\n\n        # Compute eigendecomposition and sort by increasing absolute eigenvalue\n        lambdas, V = np.linalg.eigh(A)\n        sort_indices = np.argsort(np.abs(lambdas))\n        lambdas_sorted = lambdas[sort_indices]\n        V_sorted = V[:, sort_indices]\n\n        # Select modes for manufactured solution (convert 1-based K to 0-based indices)\n        mode_indices = [k - 1 for k in K]\n        V_K = V_sorted[:, mode_indices]\n        lambdas_K = lambdas_sorted[mode_indices]\n        \n        # Define initial condition\n        u0 = V_K @ a_vec\n\n        # 2. Snapshot collection and POD basis\n        # Generate snapshots\n        t_space = np.linspace(0.0, T, m)\n        X = np.zeros((n, m))\n        for j, t_j in enumerate(t_space):\n            # u(t) = V_K @ diag(exp(lambda_k * t)) @ a\n            X[:, j] = V_K @ (np.exp(lambdas_K * t_j) * a_vec)\n        \n        # Compute POD basis via SVD. U must be n x n as per problem description.\n        U, s, _ = np.linalg.svd(X, full_matrices=True)\n        Phi = U[:, :r_pod]\n\n        # 3. POD projection error\n        norm_X_sq = np.sum(s**2)\n        if norm_X_sq  1e-15:\n            # Handle trivial case of zero snapshots\n            E_proj = 0.0\n        else:\n            # Sum of squares of truncated singular values\n            norm_err_sq = np.sum(s[r_pod:]**2)\n            E_proj = np.sqrt(norm_err_sq / norm_X_sq)\n\n        # 4. POD-Galerkin reduced model and final-time error\n        # Full (manufactured) solution at the final time T\n        u_T = V_K @ (np.exp(lambdas_K * T) * a_vec)\n        \n        # If r_pod is 0, reduced solution is identically zero\n        if r_pod == 0:\n            u_r_T = np.zeros(n)\n        else:\n            # Construct and evolve the reduced-order model\n            A_r = Phi.T @ A @ Phi\n            c0 = Phi.T @ u0\n            c_T = expm(A_r * T) @ c0\n            \n            # Reconstruct the FOM-space solution from the ROM\n            u_r_T = Phi @ c_T\n\n        # Compute final-time relative error\n        norm_u_T = np.linalg.norm(u_T)\n        if norm_u_T  1e-15:\n            E_final = 0.0\n        else:\n            E_final = np.linalg.norm(u_T - u_r_T) / norm_u_T\n            \n        all_results.extend([E_proj, E_final])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理想情况下验证了POD的有效性之后，我们转向一个更具挑战性的场景，以揭示其内在局限性。本练习旨在通过解析推导，深入探究为何标准POD方法在处理以平流为主导的问题（例如移动的间断或激波）时效率低下。我们将以一个平移的阶跃函数为例，它代表了对流方程的典型解。通过直接构建其协方差算子并求解相应的特征值问题，你将能够推导出POD奇异值的精确表达式，从而从第一性原理上理解为何线性降维方法难以有效捕捉平移不变的特征。",
            "id": "3410810",
            "problem": "考虑单位区间上向右输运的线性平流方程 $\\partial_{t} u + a \\, \\partial_{x} u = 0$，其中 $x \\in (0,1)$，$t \\in [0, a^{-1}]$，速度 $a > 0$ 为常数。初始数据为不连续阶跃函数 $u(x,0) = \\mathbf{1}_{[0,1)}(x)$，边界条件的选择使得对于所有 $t \\in [0,a^{-1}]$，解都保持为初始剖面的向右平移。对于足够大的多项式次数，高阶间断Galerkin (DG) 方法或谱Galerkin方法可以解析此解，且数值扩散可忽略不计；假设快照是精确平移 $u(\\cdot,t) = u_{s}$，平移参数为 $s = a t \\in [0,1]$，其中 $u_{s}(x) = H(x - s)$，$H$ 是亥维赛函数。\n\n在希尔伯特空间 $L^{2}(0,1)$ 中进行研究，其内积为 $\\langle f,g \\rangle = \\int_{0}^{1} f(x) g(x) \\, dx$。令 $\\mathcal{M} = \\{ u_{s} : s \\in [0,1] \\}$ 为参数化解流形。将 Kolmogorov n-维宽度 $d_{n}(\\mathcal{M}; L^{2}(0,1))$ 定义为在 $L^{2}(0,1)$ 的所有n维子空间 $V$ 上，最坏情况 $L^{2}$ 误差 $\\sup_{s \\in [0,1]} \\inf_{v \\in V} \\| u_{s} - v \\|_{L^{2}(0,1)}$ 的下确界。同时定义均值 $m(x) = \\int_{0}^{1} u_{s}(x) \\, ds$ 和中心化快照 $v_{s}(x) = u_{s}(x) - m(x)$。\n\n仅使用上述基本定义和 $L^{2}(0,1)$ 上紧自伴积分算子的标准性质：\n- 构造相关核 $K(x,y) = \\int_{0}^{1} v_{s}(x) v_{s}(y) \\, ds$ 和相应的积分算子 $(\\mathcal{T} \\varphi)(x) = \\int_{0}^{1} K(x,y) \\varphi(y) \\, dy$。\n- 将 $\\mathcal{T}$ 的特征值问题推导为一个带边界条件的常微分方程，并求解它以获得完整的特征对谱。\n- 使用这些特征对来证明一个显式代数上界 $d_{n}(\\mathcal{M}; L^{2}(0,1)) \\leq C \\, n^{-1/2}$，其中 $C$ 是一个与 $n$ 无关的可计算常数。\n- 最后，确定由 $[0,1]$ 上的均匀参数测度所诱导的快照算子的固有正交分解 (POD)（也称为Karhunen–Loève）奇异值 $\\{ \\sigma_{k} \\}_{k \\geq 1}$。\n\n给出第 $k$ 个POD奇异值 $\\sigma_{k}$ 关于 $k$ 的单一闭式表达式作为最终答案。不需要进行数值舍入。将最终答案表示为无单位的符号表达式。",
            "solution": "该问题经评估是有效的，因为它在科学上基于偏微分方程和模型降阶理论，在数学上是适定的、客观的且内部一致。给出了严谨求解所需的所有数据和定义。我们可以开始求解。\n\n该问题要求进行一个多部分的推导，该推导与由平移间断产生的一组函数（或“快照”）的固有正交分解 (POD) 相关。快照定义在空间域 $x \\in (0,1)$ 上，并由 $s \\in [0,1]$ 参数化。它们由 $u_s(x) = H(x-s)$ 给出，其中 $H$ 是亥维赛阶跃函数。这意味着对于给定的 $s$，当 $x > s$ 时，$u_s(x)=1$；当 $x  s$ 时，$u_s(x)=0$。\n\n1.  **构造相关核 (Covariance Kernel)**\n    首先计算快照集的均值函数 $m(x)$：\n    $$m(x) = \\int_0^1 u_s(x) \\, ds = \\int_0^1 H(x-s) \\, ds$$\n    对于固定的 $x$，被积函数 $H(x-s)$ 在 $s  x$ 时为 1，在 $s > x$ 时为 0。因此，积分区间为 $[0, x]$：\n    $$m(x) = \\int_0^x 1 \\, ds = x$$\n    中心化快照 $v_s(x)$ 定义为 $v_s(x) = u_s(x) - m(x) = H(x-s) - x$。\n    相关核 $K(x,y)$ 是中心化快照的内积在参数空间上的积分：\n    $$K(x,y) = \\int_0^1 v_s(x) v_s(y) \\, ds = \\int_0^1 (H(x-s) - x)(H(y-s) - y) \\, ds$$\n    展开得：\n    $$K(x,y) = \\int_0^1 H(x-s)H(y-s) \\, ds - y\\int_0^1 H(x-s) \\, ds - x\\int_0^1 H(y-s) \\, ds + \\int_0^1 xy \\, ds$$\n    我们逐项计算积分：\n    -   $\\int_0^1 H(x-s)H(y-s) \\, ds = \\int_0^1 H(\\min(x,y) - s) \\, ds = \\int_0^{\\min(x,y)} 1 \\, ds = \\min(x,y)$\n    -   $\\int_0^1 H(x-s) \\, ds = m(x) = x$\n    -   $\\int_0^1 H(y-s) \\, ds = m(y) = y$\n    -   $\\int_0^1 xy \\, ds = xy$\n    将各项代回，得到相关核：\n    $$K(x,y) = \\min(x,y) - yx - xy + xy = \\min(x,y) - xy$$\n\n2.  **求解特征值问题**\n    积分算子 $\\mathcal{T}$ 的特征值问题是 $(\\mathcal{T}\\varphi)(x) = \\lambda \\varphi(x)$，即：\n    $$\\int_0^1 (\\min(x,y) - xy) \\varphi(y) \\, dy = \\lambda \\varphi(x)$$\n    这是一个 Fredholm 积分方程。我们可以通过微分将其转化为一个常微分方程 (ODE)。对上式关于 $x$ 求导两次，可得：\n    $$\\frac{d^2}{dx^2} \\left( \\lambda \\varphi(x) \\right) = -\\varphi(x)$$\n    即 $\\varphi''(x) + \\frac{1}{\\lambda} \\varphi(x) = 0$。\n    边界条件可以通过在 $x=0$ 和 $x=1$ 处计算原始积分方程得到。在 $x=0$ 处，$\\int_0^1 (0 - 0) \\varphi(y) dy = \\lambda \\varphi(0)$，所以 $\\varphi(0)=0$。在 $x=1$ 处，$\\int_0^1 (y-y)\\varphi(y)dy = \\lambda \\varphi(1)$，所以 $\\varphi(1)=0$。\n    因此，我们需求解带齐次狄利克雷边界条件的 ODE：\n    $$\\varphi''(x) + \\frac{1}{\\lambda} \\varphi(x) = 0, \\quad \\varphi(0)=0, \\quad \\varphi(1)=0$$\n    该边值问题的非平凡解为：\n    -   特征函数 (POD 模态)：$\\varphi_k(x) = \\sqrt{2} \\sin(k\\pi x)$\n    -   以及对应的 $\\frac{1}{\\lambda_k} = (k\\pi)^2$\n    由此得到特征值 $\\lambda_k = \\frac{1}{(k\\pi)^2}$，对于 $k=1, 2, 3, \\dots$。\n\n3.  **确定 POD 奇异值**\n    POD 奇异值 $\\sigma_k$ 是相关算子 $\\mathcal{T}$ 的特征值 $\\lambda_k$ 的平方根：\n    $$\\sigma_k = \\sqrt{\\lambda_k} = \\sqrt{\\frac{1}{(k\\pi)^2}} = \\frac{1}{k\\pi}$$\n    这个结果表明奇异值以 $O(k^{-1})$ 的速率缓慢衰减，解释了为什么基于线性子空间的 POD 方法在逼近具有移动间断的解时效率不高。较慢的衰减意味着需要非常多的模态才能捕获大部分能量，与具有快速衰减谱（如指数衰减）的扩散主导问题形成鲜明对比。",
            "answer": "$$\\boxed{\\frac{1}{k\\pi}}$$"
        },
        {
            "introduction": "本练习将我们带入一个更贴近实际应用的领域：参数化降阶建模。在许多工程问题中，我们希望构建一个能够快速预测不同物理参数（如扩散系数 $\\mu$ 或对流速度 $a$）下系统行为的降阶模型。这个练习的核心是探究一个在特定“训练”参数 $\\mu_{\\text{train}}$ 下生成的POD基，在应用于不同“测试”参数 $\\mu_{\\text{test}}$ 时的性能表现。通过亲手实现并量化模型误差随参数变化的规律，你将深刻理解参数化ROM的鲁棒性问题，并体会到评估单个基在参数空间中表征能力的至关重要性。",
            "id": "3265932",
            "problem": "考虑在空间区间 $x \\in (0,1)$ 上具有齐次 Dirichlet 边界条件的一维线性平流-扩散初边值问题，该问题由以下偏微分方程控制：\n$$\n\\frac{\\partial u}{\\partial t}(x,t;\\mu) \\;=\\; \\mu \\,\\frac{\\partial^2 u}{\\partial x^2}(x,t;\\mu) \\;-\\; a \\,\\frac{\\partial u}{\\partial x}(x,t;\\mu), \\quad u(0,t;\\mu) = 0,\\quad u(1,t;\\mu) = 0,\\quad u(x,0;\\mu) = u_0(x),\n$$\n其中 $\\mu  0$ 是扩散参数，$a \\ge 0$ 是平流速度。将使用在训练参数 $\\mu_{\\text{train}}$ 下生成的快照，通过本征正交分解 (POD) 获得一组基，然后通过 Galerkin 投影到这组基上构建降阶模型 (ROM)，并将其应用于同一偏微分方程的测试参数 $\\mu_{\\text{test}}$。\n\n从基本定义开始：\n- 使用方法线法，在 $N$ 个内部网格点上对空间导数进行半离散化，网格间距均匀为 $h$，其中 $h = \\frac{1}{N+1}$，内部节点为 $x_i = i h$，$i = 1,2,\\dots,N$。使用标准的二阶中心有限差分近似 $\\frac{\\partial^2 u}{\\partial x^2}$，并使用与 $a \\ge 0$ 一致的一阶迎风有限差分近似 $\\frac{\\partial u}{\\partial x}$。这将得到一个半离散常微分方程\n$$\n\\frac{d \\mathbf{u}}{dt}(t;\\mu) \\;=\\; A(\\mu)\\,\\mathbf{u}(t;\\mu),\n$$\n其中 $\\mathbf{u}(t;\\mu) \\in \\mathbb{R}^N$，$A(\\mu) \\in \\mathbb{R}^{N \\times N}$ 是由离散化形成的依赖于参数的空间算子。\n- 使用隐式欧拉方法对半离散系统进行时间推进。设时间步长为 $\\Delta t$，$t_k = k\\,\\Delta t$，则更新满足\n$$\n\\left(I - \\Delta t\\,A(\\mu)\\right)\\,\\mathbf{u}^{k+1} \\;=\\; \\mathbf{u}^{k},\n$$\n其中 $\\mathbf{u}^k \\approx \\mathbf{u}(t_k;\\mu)$。\n- 在训练参数 $\\mu_{\\text{train}}$ 下，通过拼接最终时间 $T = K\\,\\Delta t$ 内 $k = 0,1,\\dots,K$ 的所有状态向量 $\\mathbf{u}^k$，生成快照矩阵 $X \\in \\mathbb{R}^{N \\times (K+1)}$。使用奇异值分解 (SVD) $X = U\\,\\Sigma\\,V^\\top$ 计算秩为 $r$ 的本征正交分解 (POD) 基，并取 $U$ 的前 $r$ 列作为标准正交基 $V_{\\text{basis}} \\in \\mathbb{R}^{N \\times r}$。此处的本征正交分解 (POD) 定义为通过奇异值分解 (SVD) 从快照集合中计算一个能够最大化捕获能量（在欧几里得内积意义下）的标准正交基。\n- 对于测试参数 $\\mu_{\\text{test}}$，通过将全阶算子投影到 POD 基上，形成 Galerkin 投影降阶模型 (ROM)，得到\n$$\nA_r(\\mu_{\\text{test}}) \\;=\\; V_{\\text{basis}}^\\top A(\\mu_{\\text{test}}) V_{\\text{basis}} \\in \\mathbb{R}^{r \\times r},\n$$\n并使用隐式欧拉方法对降阶系统进行演化：\n$$\n\\left(I_r - \\Delta t\\,A_r(\\mu_{\\text{test}})\\right)\\,\\mathbf{y}^{k+1} \\;=\\; \\mathbf{y}^{k}, \\quad \\text{其中} \\quad \\mathbf{y}^0 \\;=\\; V_{\\text{basis}}^\\top \\mathbf{u}^0, \\quad \\mathbf{u}_{\\text{ROM}}^{k} \\;=\\; V_{\\text{basis}}\\,\\mathbf{y}^{k}。\n$$\n\n您的程序必须使用以下科学上一致且自包含的测试套件和参数来实现上述过程：\n- 空间离散化：\n  - $N = 64$ 个内部点。\n  - 域长度 $L = 1$，网格间距 $h = \\frac{L}{N+1}$，内部节点 $x_i = i\\,h$，$i=1,\\dots,N$。\n  - 齐次 Dirichlet 边界通过内部未知量的模板结构来施加。\n- 时间离散化：\n  - 隐式欧拉方法，$\\Delta t = 10^{-3}$。\n  - 最终时间 $T = 0.2$，因此有 $K = \\frac{T}{\\Delta t} = 200$ 个时间步。\n- PDE 参数：\n  - 平流速度 $a = 1.0$。\n  - 训练扩散参数 $\\mu_{\\text{train}} = 0.01$。\n- 初始条件：\n  - $u_0(x) = \\sin(\\pi x) + \\tfrac{1}{2}\\,\\sin(2\\pi x)$，在内部节点上离散化以形成 $\\mathbf{u}^0 \\in \\mathbb{R}^N$。\n- POD 基：\n  - 如上所述，使用在 $\\mu_{\\text{train}}$ 处的快照矩阵的奇异值分解 (SVD) 构建秩 $r = 6$ 的基。\n\n在以下四个测试参数下评估 ROM，以分析从不同参数区域生成基的影响：\n- 情况 1：$\\mu_{\\text{test}} = \\mu_{\\text{train}}$。\n- 情况 2：$\\mu_{\\text{test}} = 1.2\\,\\mu_{\\text{train}}$。\n- 情况 3：$\\mu_{\\text{test}} = 5\\,\\mu_{\\text{train}}$。\n- 情况 4：$\\mu_{\\text{test}} = 10^{-4}$。\n\n对于每种情况，计算全阶模型 (FOM) 和 ROM 解之间的最终时刻相对误差，\n$$\ne_{\\text{final}} \\;=\\; \\frac{\\left\\|\\mathbf{u}^{K} - \\mathbf{u}_{\\text{ROM}}^{K}\\right\\|_2}{\\left\\|\\mathbf{u}^{K}\\right\\|_2},\n$$\n其中 $\\|\\cdot\\|_2$ 是欧几里得范数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按四种情况的顺序 $[\\text{情况 1}, \\text{情况 2}, \\text{情况 3}, \\text{情况 4}]$ 排列。每个值都应以小数点后八位的小数形式打印（例如 $[0.00123456,0.00234567,0.01234567,0.12345678]$）。不涉及任何物理单位，所有角度（如果有的话）均默认为弧度，尽管此处并未使用。答案是十进制形式的纯实数。",
            "solution": "用户提供的问题是一个定义明确且科学合理的关于偏微分方程数值方法的练习，特别侧重于使用本征正交分解 (POD) 进行降阶建模。该问题的有效性验证如下：\n\n- **科学依据**：该问题基于一维线性平流-扩散方程，这是流体动力学和输运现象中的一个经典模型。所指定的数值方法——方法线法、有限差分（扩散项使用中心差分，平流项使用迎风差分）、隐式欧拉时间积分以及通过奇异值分解 (SVD) 实现的 POD——都是科学计算中标准且经过严格建立的技术。该问题没有任何科学或事实上的不合理之处。\n- **适定性和完整性**：问题陈述提供了构建和解决该问题所需的所有信息。这包括偏微分方程、域、边界和初始条件、所有数值参数（$N, L, a, \\Delta t, T, r$）、离散化模板的精确定义、时间积分方案、POD 基生成过程以及具体的测试案例。隐式欧拉方法保证了数值稳定性。迎风格式适用于平流项。整个问题是适定的和自包含的。\n- **客观性和清晰性**：该问题以精确、无歧义的数学语言陈述。没有主观或基于意见的内容。在最初的提问中，对基矩阵符号的使用存在一个小的歧义（称之为 $V$ 但从 $U$ 构造），但通过明确的指令“取 $U$ 的前 $r$ 列作为标准正交基 $V_{\\text{basis}}$”进行了澄清，这与对状态轨迹进行 POD 的标准惯例相符。这不会妨碍唯一且正确的实现。\n\n鉴于该问题是有效的，我们制定了分步解决方案。\n\n### 1. 全阶模型 (FOM) 离散化\n\n偏微分方程为：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\mu \\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; a \\,\\frac{\\partial u}{\\partial x}\n$$\n我们将空间域 $x \\in (0,1)$ 离散化为 $N=64$ 个内部点 $x_i = i h$（$i=1,\\dots,N$），网格间距为 $h = 1/(N+1)$。系统状态由向量 $\\mathbf{u}(t) \\in \\mathbb{R}^N$ 表示，其中 $(\\mathbf{u})_i = u(x_i, t)$。\n\n空间导数按规定使用有限差分进行近似：\n- **扩散项（二阶中心差分）**：\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{u(x_{i+1},t) - 2u(x_i,t) + u(x_{i-1},t)}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n- **平流项（$a \\ge 0$ 的一阶迎风格式）**：\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{x_i} \\approx \\frac{u(x_i,t) - u(x_{i-1},t)}{h} = \\frac{u_i - u_{i-1}}{h}\n$$\n\n将这些近似值代入每个内部节点 $x_i$ 的偏微分方程中，得到一个常微分方程组 (ODEs)，$\\frac{d\\mathbf{u}}{dt} = A(\\mu)\\mathbf{u}$。第 $i$ 个方程为：\n$$\n\\frac{du_i}{dt} = \\mu \\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} \\right) - a \\left( \\frac{u_i - u_{i-1}}{h} \\right)\n$$\n齐次 Dirichlet 边界条件 $u(0,t)=u_0=0$ 和 $u(1,t)=u_{N+1}=0$ 被整合到边界处（$i=1$ 和 $i=N$）的模板中。重新排列关于 $u_{i-1}$, $u_i$, 和 $u_{i+1}$ 的项，可以揭示系统矩阵 $A(\\mu)$ 的结构：\n$$\n\\frac{du_i}{dt} = \\left(\\frac{\\mu}{h^2} + \\frac{a}{h}\\right) u_{i-1} + \\left(-\\frac{2\\mu}{h^2} - \\frac{a}{h}\\right) u_i + \\left(\\frac{\\mu}{h^2}\\right) u_{i+1}\n$$\n这定义了一个三对角矩阵 $A(\\mu) \\in \\mathbb{R}^{N \\times N}$，其对角线元素如下：\n- **主对角线**：$-\\frac{2\\mu}{h^2} - \\frac{a}{h}$\n- **次对角线（下）**：$\\frac{\\mu}{h^2} + \\frac{a}{h}$\n- **超对角线（上）**：$\\frac{\\mu}{h^2}$\n\n### 2. 时间积分和快照生成\n\n半离散系统使用隐式欧拉方法进行时间推进，时间步长为 $\\Delta t = 10^{-3}$：\n$$\n\\frac{\\mathbf{u}^{k+1} - \\mathbf{u}^{k}}{\\Delta t} = A(\\mu) \\mathbf{u}^{k+1} \\implies \\left(I - \\Delta t\\,A(\\mu)\\right)\\,\\mathbf{u}^{k+1} = \\mathbf{u}^{k}\n$$\n为了获得第 $k+1$ 步的解，我们在每个时间步求解一个线性系统。\n\n通过求解训练参数 $\\mu_{\\text{train}} = 0.01$ 下的 FOM 来生成快照。初始条件为 $\\mathbf{u}^0$，通过在网格点 $x_i$ 上计算 $u_0(x) = \\sin(\\pi x) + \\frac{1}{2}\\sin(2\\pi x)$ 得到。模拟运行至时间 $T=0.2$，对应 $K = T/\\Delta t = 200$ 个时间步。通过收集状态向量形成快照矩阵 $X \\in \\mathbb{R}^{N \\times (K+1)}$：\n$$\nX = \\begin{bmatrix} |  |   | \\\\ \\mathbf{u}^0  \\mathbf{u}^1  \\dots  \\mathbf{u}^K \\\\ |  |   | \\end{bmatrix}\n$$\n\n### 3. POD 基的构建\n\nPOD 基由快照矩阵 $X$ 的奇异值分解 (SVD) 计算得出：\n$$\nX = U \\Sigma V^\\top\n$$\n矩阵 $U$ 的列是左奇异向量，它们是标准正交的，并代表了系统动力学的空间模态。在捕获最多能量的意义上，最优的秩-$r$ 基由 $U$ 的前 $r$ 列构成。我们使用 $r=6$ 构建基矩阵 $V_{\\text{basis}} \\in \\mathbb{R}^{N \\times r}$：\n$$\nV_{\\text{basis}} = U[:, 0:r]\n$$\n\n### 4. 降阶模型 (ROM) 的构建与仿真\n\nROM 是通过将控制 FOM 方程投影到由 $V_{\\text{basis}}$ 张成的低维子空间上构建的。寻求形式为 $\\mathbf{u}_{\\text{ROM}}(t) = V_{\\text{basis}}\\mathbf{y}(t)$ 的近似解，其中 $\\mathbf{y}(t) \\in \\mathbb{R}^r$ 是降阶坐标。\n将此代入半离散系统并应用 Galerkin 投影（即左乘 $V_{\\text{basis}}^\\top$），可得到给定测试参数 $\\mu_{\\text{test}}$ 的 ROM：\n$$\nV_{\\text{basis}}^\\top V_{\\text{basis}} \\frac{d\\mathbf{y}}{dt} = V_{\\text{basis}}^\\top A(\\mu_{\\text{test}}) V_{\\text{basis}} \\mathbf{y}\n$$\n由于 $V_{\\text{basis}}$ 是标准正交的（$V_{\\text{basis}}^\\top V_{\\text{basis}} = I_r$），方程可简化为：\n$$\n\\frac{d\\mathbf{y}}{dt} = A_r(\\mu_{\\text{test}}) \\mathbf{y}, \\quad \\text{其中} \\quad A_r(\\mu_{\\text{test}}) = V_{\\text{basis}}^\\top A(\\mu_{\\text{test}}) V_{\\text{basis}}\n$$\n降阶算子 $A_r \\in \\mathbb{R}^{r \\times r}$。ROM 的初始条件是全阶初始条件的投影：$\\mathbf{y}^0 = V_{\\text{basis}}^\\top \\mathbf{u}^0$。\nROM 使用隐式欧拉方法进行时间步进，与 FOM 类似：\n$$\n\\left(I_r - \\Delta t\\,A_r(\\mu_{\\text{test}})\\right)\\,\\mathbf{y}^{k+1} = \\mathbf{y}^{k}\n$$\n在仿真到最终时间 $T$ 找到 $\\mathbf{y}^K$ 后，将解重建回全状态空间：$\\mathbf{u}_{\\text{ROM}}^K = V_{\\text{basis}}\\mathbf{y}^K$。\n\n### 5. 误差评估\n\n对于每个测试案例 $\\mu_{\\text{test}}$，我们计算在最终时间 $T=0.2$ 的 FOM 解 $\\mathbf{u}^K$ 和 ROM 解 $\\mathbf{u}_{\\text{ROM}}^K$。相对误差计算如下：\n$$\ne_{\\text{final}} = \\frac{\\|\\mathbf{u}^K - \\mathbf{u}_{\\text{ROM}}^K\\|_2}{\\|\\mathbf{u}^K\\|_2}\n$$\n对所有四个指定的 $\\mu_{\\text{test}}$ 值重复此过程，并报告所得误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a POD-Galerkin Reduced-Order Model for a 1D advection-diffusion\n    equation and evaluates its accuracy for several test parameters.\n    \"\"\"\n    # --------------------------------------------------------------------------\n    # 1. Define problem parameters and grid\n    # --------------------------------------------------------------------------\n    N = 64                  # Number of interior spatial points\n    L = 1.0                 # Domain length\n    a = 1.0                 # Advection speed\n    dt = 1.0e-3             # Time step\n    T = 0.2                 # Final time\n    r = 6                   # Rank of POD basis\n    mu_train = 0.01         # Training diffusion parameter\n\n    test_cases_mu = [\n        mu_train,\n        1.2 * mu_train,\n        5.0 * mu_train,\n        1.0e-4\n    ]\n\n    h = L / (N + 1)         # Grid spacing\n    K = int(T / dt)         # Number of time steps\n    x_grid = np.arange(1, N + 1) * h\n\n    # Initial condition\n    u0 = np.sin(np.pi * x_grid) + 0.5 * np.sin(2 * np.pi * x_grid)\n\n    # Memoization caches for efficiency\n    memo_A = {}\n    memo_fom_final_state = {}\n\n    # --------------------------------------------------------------------------\n    # 2. Helper functions for FOM and ROM\n    # --------------------------------------------------------------------------\n    def build_A(mu):\n        \"\"\"Constructs the FOM spatial discretization matrix A(mu).\"\"\"\n        if mu in memo_A:\n            return memo_A[mu]\n\n        h2 = h * h\n        diag_main = -2.0 * mu / h2 - a / h\n        diag_upper = mu / h2\n        diag_lower = mu / h2 + a / h\n        \n        A = np.zeros((N, N))\n        np.fill_diagonal(A, diag_main)\n        np.fill_diagonal(A[1:, :-1], diag_lower)\n        np.fill_diagonal(A[:-1, 1:], diag_upper)\n        \n        memo_A[mu] = A\n        return A\n\n    def run_fom(mu, collect_snapshots=False):\n        \"\"\"Simulates the Full-Order Model (FOM).\"\"\"\n        if not collect_snapshots and mu in memo_fom_final_state:\n            return memo_fom_final_state[mu], None\n\n        A = build_A(mu)\n        # Implicit Euler matrix: M * u^{k+1} = u^k\n        M = np.eye(N) - dt * A\n        u = u0.copy()\n\n        if collect_snapshots:\n            snapshots = np.zeros((N, K + 1))\n            snapshots[:, 0] = u\n            for k in range(K):\n                u = np.linalg.solve(M, u)\n                snapshots[:, k + 1] = u\n            return u, snapshots\n        else:\n            for k in range(K):\n                u = np.linalg.solve(M, u)\n            memo_fom_final_state[mu] = u\n            return u, None\n    \n    # --------------------------------------------------------------------------\n    # 3. Generate POD basis from training data\n    # --------------------------------------------------------------------------\n    _, X_train = run_fom(mu_train, collect_snapshots=True)\n    \n    # Compute SVD: X = U * S * Vh. The POD basis are the left singular vectors (columns of U).\n    # The problem description calls the basis 'V_basis', constructed from U.\n    U, _, _ = np.linalg.svd(X_train, full_matrices=False)\n    V_basis = U[:, :r]\n\n    # --------------------------------------------------------------------------\n    # 4. Evaluate ROM for each test case\n    # --------------------------------------------------------------------------\n    results = []\n    \n    # Project initial condition onto the POD basis\n    y0 = V_basis.T @ u0\n    \n    for mu_test in test_cases_mu:\n        # Get the true FOM solution at the final time for comparison\n        u_fom_final, _ = run_fom(mu_test, collect_snapshots=False)\n\n        # Build and run the ROM\n        A_test = build_A(mu_test)\n        \n        # Project the FOM operator to get the ROM operator\n        A_r = V_basis.T @ A_test @ V_basis\n        \n        # Implicit Euler matrix for the ROM\n        M_r = np.eye(r) - dt * A_r\n        \n        y = y0.copy()\n        for _ in range(K):\n            y = np.linalg.solve(M_r, y)\n        \n        # Reconstruct the full-order solution from the ROM state\n        u_rom_final = V_basis @ y\n        \n        # Calculate final-time relative error\n        error_norm = np.linalg.norm(u_fom_final - u_rom_final)\n        fom_norm = np.linalg.norm(u_fom_final)\n        \n        if fom_norm == 0:\n            # Avoid division by zero, though unlikely for this problem\n            relative_error = 0.0\n        else:\n            relative_error = error_norm / fom_norm\n            \n        results.append(relative_error)\n        \n    # --------------------------------------------------------------------------\n    # 5. Format and print the final output\n    # --------------------------------------------------------------------------\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}