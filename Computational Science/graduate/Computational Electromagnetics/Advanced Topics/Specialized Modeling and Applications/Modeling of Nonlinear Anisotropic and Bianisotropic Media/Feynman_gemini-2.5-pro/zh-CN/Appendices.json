{
    "hands_on_practices": [
        {
            "introduction": "任何精确的计算模型都始于对材料物理特性的深刻理解。对于非线性各向异性介质，其电磁响应由高阶张量描述，而这些张量的具体形式则由材料的内在晶体对称性严格决定。本练习将引导你通过群论和张量分析，从第一性原理出发，为一类特定的非线性晶体（$3m$ 点群）推导出其二阶电极化率张量 $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ 的非零分量，这是掌握复杂介质建模的基础分析技能 。",
            "id": "3331971",
            "problem": "一个属于三方点群的单轴晶体，具有三重旋转对称和镜面对称，记作 $3m$（也称为 $C_{3v}$），被用于倍频（二次谐波产生）。设晶体学（光学）轴与笛卡尔坐标系的 $z$ 轴重合，$(x,y)$ 张成基面。在频域中，二阶非线性极化强度 $\\mathbf{P}^{(2)}(2\\omega)$ 由二阶电极化率张量 $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ 通过本构关系定义\n$$\nP^{(2)}_{i}(2\\omega) \\;=\\; \\varepsilon_{0}\\,\\chi^{(2)}_{ijk}(-2\\omega;\\omega,\\omega)\\,E_{j}(\\omega)\\,E_{k}(\\omega),\n$$\n其中 $i,j,k\\in\\{x,y,z\\}$ 且使用了爱因斯坦求和约定。假设非共振的 Kleinman 对称性成立，因此有 $\\chi^{(2)}_{ijk}=\\chi^{(2)}_{ikj}$。\n\n1) 从 Neumann 原理（“晶体任何物理性质的对称元素必须包括该晶体点群的对称元素”）出发，对 $3m$ 群的生成元施加 $\\chi^{(2)}_{ijk}$ 的不变性要求：绕 $z$ 轴旋转 $120^{\\circ}$ 和通过一个包含 $z$ 轴的竖直平面的镜面反射。对每个生成元，使用带有正交矩阵 $\\bar{\\bar{R}}$ 的张量变换法则\n$$\n\\chi^{(2)}_{ijk} \\;=\\; R_{ii'}\\,R_{jj'}\\,R_{kk'}\\,\\chi^{(2)}_{i'j'k'}\n$$\n以及最后两个指标的内在置换对称性，来确定哪些笛卡尔分量 $\\chi^{(2)}_{ijk}$ 可以非零，并找出独立的最小系数集及其间的相等关系。不要参考列表结果；通过对称性论证每一次的消去或相等关系。\n\n2) 引入缩并记法，其中二次场组合被集合为\n$$\nS \\;=\\; \\big(E_{x}^{2},\\,E_{y}^{2},\\,E_{z}^{2},\\,2E_{y}E_{z},\\,2E_{x}E_{z},\\,2E_{x}E_{y}\\big),\n$$\n并且 $3\\times 6$ 矩阵 $\\bar{\\bar{d}}$ 定义为\n$$\nP^{(2)}_{i}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,\\sum_{\\ell=1}^{6} d_{i\\ell}\\,S_{\\ell}.\n$$\n使用 $3m$ 类的常规晶体学取向，将 $3m$ 晶体的 $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ 表示为这种缩并的 $d$ 张量形式，明确写出 $3\\times 6$ 矩阵 $\\bar{\\bar{d}}$ 并用其独立系数表示。\n\n3) 现在考虑一个频率为 $\\omega$ 的单色平面波，沿 $+z$ 轴传播，其电场为\n$$\n\\mathbf{E}(\\omega) \\;=\\; E_{0}\\,\\big(\\cos\\phi\\,\\hat{\\mathbf{x}} \\;+\\; \\sin\\phi\\,\\hat{\\mathbf{y}}\\big),\n$$\n其中 $E_{0}>0$，角度 $\\phi\\in[0,2\\pi)$ 是在基面内从 $x$ 轴测量的。使用第 2 部分的结果，计算归一化的纵向二次谐波极化强度\n$$\n\\frac{P^{(2)}_{z}(2\\omega)}{\\varepsilon_{0}\\,E_{0}^{2}}\n$$\n以 $\\bar{\\bar{d}}$ 的独立系数和角度 $\\phi$ 表示为一个单一的闭式解析表达式，并完全化简。将这个归一化的标量作为你的最终答案。不需要数值计算，最终答案中也不应包含单位。",
            "solution": "该问题提法得当，有科学依据，且内部一致。这是一个非线性光学中的标准问题，涉及应用晶体对称性来确定二阶电极化率张量的形式。\n\n按照题目要求，解答分为三个部分。\n\n### 第 1 部分：确定 $3m$ 群的 $\\chi^{(2)}$ 张量形式\n\n点群 $3m$ ($C_{3v}$) 的特征是一个三重旋转轴和一个与该轴平行的镜面。我们将笛卡尔坐标系的 $z$ 轴与三重旋转轴对齐。对于镜面，我们选择 $xz$ 平面，这是一个常规选择。因此，该群的生成元是绕 $z$ 轴旋转 $\\theta = 2\\pi/3$ 的旋转 $C_3$ 和跨 $xz$ 平面的反射 $\\sigma_v$。\n\n根据 Neumann 原理，电极化率张量 $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ 在这些对称操作下必须保持不变。张量变换法则由 $\\chi^{(2)}_{ijk} = R_{ii'}R_{jj'}R_{kk'}\\chi^{(2)}_{i'j'k'}$ 给出，其中 $\\bar{\\bar{R}}$ 是表示对称操作的矩阵。\n\n**A. 在反射 $\\sigma_v$（在 $xz$ 平面内）下的不变性**\n\n反射操作将坐标变换为 $(x, y, z) \\to (x, -y, z)$。相应的变换矩阵是：\n$$\n\\bar{\\bar{R}}_{\\sigma_v} = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n不变性条件是 $\\chi^{(2)}_{ijk} = (R_{\\sigma_v})_{ii'}(R_{\\sigma_v})_{jj'}(R_{\\sigma_v})_{kk'}\\chi^{(2)}_{i'j'k'}$。由于 $\\bar{\\bar{R}}_{\\sigma_v}$ 是对角矩阵，这可以简化为 $\\chi^{(2)}_{ijk} = (R_{\\sigma_v})_{ii}(R_{\\sigma_v})_{jj}(R_{\\sigma_v})_{kk}\\chi^{(2)}_{ijk}$（无求和）。要使分量 $\\chi^{(2)}_{ijk}$ 非零，我们必须有 $(R_{\\sigma_v})_{ii}(R_{\\sigma_v})_{jj}(R_{\\sigma_v})_{kk} = 1$。\n该乘积等于 $(-1)^{N_y}$，其中 $N_y$ 是指标 $y$ 在 $(i,j,k)$ 中出现的次数。因此，要使 $\\chi^{(2)}_{ijk}$ 非零，$N_y$ 必须是偶数（$0$ 或 $2$）。\n\n这就消除了所有具有奇数个 $y$ 指标的分量。例如：\n- $N_y=1$：$\\chi_{yxx}$、$\\chi_{xxy}$、$\\chi_{xyz}$ 等都必须为零。\n- $N_y=3$：$\\chi_{yyy}$ 必须为零。\n\n（在应用 $C_3$ 对称性并考虑 Kleinman 对称性 $\\chi^{(2)}_{ijk}=\\chi^{(2)}_{ikj}$ 之前）幸存的分量是那些 $N_y=0$ 或 $N_y=2$ 的分量。\n- $N_y=0$：所有指标都来自 $\\{x, z\\}$，例如 $\\chi_{xxx}, \\chi_{xxz}, \\chi_{zxz}, \\chi_{zzz}$。\n- $N_y=2$：两个指标是 $y$，一个来自 $\\{x, z\\}$，例如 $\\chi_{xyy}, \\chi_{yxy}, \\chi_{yyx}, \\chi_{zyy}$。\n\n**B. 在旋转 $C_3$（绕 $z$ 轴旋转 $120^\\circ$）下的不变性**\n\n一个被动变换（坐标系旋转）角度为 $\\theta = 2\\pi/3$ 的旋转矩阵指定为：\n$$\n\\bar{\\bar{R}}_{C_3} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta  0 \\\\ -\\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} -1/2  \\sqrt{3}/2  0 \\\\ -\\sqrt{3}/2  -1/2  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n令 $c = \\cos\\theta = -1/2$ 和 $s = \\sin\\theta = \\sqrt{3}/2$。我们将不变性条件 $\\chi^{(2)}_{ijk} = R_{ii'}R_{jj'}R_{kk'}\\chi^{(2)}_{i'j'k'}$ 应用于在 $\\sigma_v$ 反射对称性下幸存的分量。\n\n1.  **仅涉及 $z$ 的分量：**\n    $\\chi'_{zzz} = R_{zz}R_{zz}R_{zz}\\chi_{zzz} = (1)^3 \\chi_{zzz} = \\chi_{zzz}$。所以 $\\chi_{zzz}$ 是一个独立的非零分量。\n\n2.  **将 $\\{x,y\\}$ 与 $z$ 相关联的分量：**\n    考虑 $\\chi_{zxx}$。变换后的分量为 $\\chi'_{zxx} = R_{zi'} R_{xj'} R_{xk'} \\chi_{i'j'k'}$。由于 $R_{zi'}=\\delta_{zi'}$，这变为 $\\chi'_{zxx} = R_{xj'} R_{xk'} \\chi_{zj'k'}$。在 $j', k' \\in \\{x,y\\}$ 上展开（因为在此旋转下 $z$ 分量不与 $xy$ 混合）：\n    $\\chi'_{zxx} = R_{xx}^2 \\chi_{zxx} + R_{xy}^2 \\chi_{zyy} + R_{xx}R_{xy}(\\chi_{zxy}+\\chi_{zyx})$。\n    根据 $\\sigma_v$ 对称性，$\\chi_{zxy}$ 和 $\\chi_{zyx}$ 为零 ($N_y=1$)。\n    $\\chi'_{zxx} = c^2 \\chi_{zxx} + s^2 \\chi_{zyy}$。不变性要求 $\\chi_{zxx} = c^2 \\chi_{zxx} + s^2 \\chi_{zyy}$，这给出 $\\chi_{zxx}(1-c^2) = s^2 \\chi_{zyy}$。由于 $s^2=1-c^2$，这简化为 $\\chi_{zxx} = \\chi_{zyy}$。\n    对 $\\chi'_{zyy}$ 进行类似的计算证实了这一关系。\n\n    考虑 $\\chi_{xxz}$。由于 Kleinman 对称性，$\\chi_{xxz} = \\chi_{xzx}$。\n    $\\chi'_{xxz} = R_{xi'}R_{xj'}R_{zk'} \\chi_{i'j'k'} = R_{xi'}R_{xj'} \\chi_{i'j'z}$。\n    $\\chi'_{xxz} = R_{xx}^2 \\chi_{xxz} + R_{xy}^2 \\chi_{yyz} + R_{xx}R_{xy}(\\chi_{xyz}+\\chi_{yxz})$。含有一个 $y$ 的分量为零，所以 $\\chi'_{xxz} = c^2 \\chi_{xxz} + s^2 \\chi_{yyz}$。不变性给出 $\\chi_{xxz} = \\chi_{yyz}$。\n\n    考虑 $\\chi_{xzz}$。$\\chi'_{xzz} = R_{xi'}R_{zj'}R_{zk'} \\chi_{i'zz} = R_{xi'} \\chi_{i'zz} = c\\chi_{xzz} + s\\chi_{yzz}$。根据 $\\sigma_v$，$\\chi_{yzz}=0$ ($N_y=1$)。所以 $\\chi'_{xzz} = c\\chi_{xzz}$。由于 $c \\ne 1$，这要求 $\\chi_{xzz}=0$。\n\n    考虑 $\\chi_{zxz}$。$\\chi'_{zxz} = R_{zi'}R_{xj'}R_{zk'} \\chi_{i'j'k'} = R_{xj'} \\chi_{zj'z} = c\\chi_{zxz} + s\\chi_{zyz}$。根据 $\\sigma_v$，$\\chi_{zyz}=0$ ($N_y=1$)。所以 $\\chi'_{zxz} = c\\chi_{zxz}$，这意味着 $\\chi_{zxz}=0$。\n\n3.  **仅涉及 $x, y$ 的分量：**\n    考虑 $\\chi_{xxx}, \\chi_{xyy}, \\chi_{yyx}$ 的系统（注意根据 Kleinman 对称性 $\\chi_{yxy}=\\chi_{yyx}$，而其他分量如 $\\chi_{xxy}$ 根据 $\\sigma_v$ 为零）。\n    $\\chi'_{xxx} = c^3 \\chi_{xxx} + cs^2(\\chi_{xyy} + 2\\chi_{yyx})$。不变性给出 $\\chi_{xxx}(1-c^3) = cs^2(\\chi_{xyy} + 2\\chi_{yyx})$。当 $c=-1/2, s^2=3/4$ 时，这变为 $3\\chi_{xxx} = -(\\chi_{xyy} + 2\\chi_{yyx})$。\n    $\\chi'_{xyy} = cs^2\\chi_{xxx} + c^3\\chi_{xyy} - 2cs^2\\chi_{yyx}$。不变性给出 $\\chi_{xyy}(1-c^3) = cs^2\\chi_{xxx} - 2cs^2\\chi_{yyx}$，这变为 $3\\chi_{xyy} = -\\chi_{xxx} + 2\\chi_{yyx}$。\n    解这个二元线性方程组：\n    从第二个方程，$\\chi_{xxx} = 2\\chi_{yyx} - 3\\chi_{xyy}$。代入第一个方程：\n    $3(2\\chi_{yyx} - 3\\chi_{xyy}) = -\\chi_{xyy} - 2\\chi_{yyx} \\implies 6\\chi_{yyx} - 9\\chi_{xyy} = -\\chi_{xyy} - 2\\chi_{yyx}$。\n    $8\\chi_{yyx} = 8\\chi_{xyy} \\implies \\chi_{yyx} = \\chi_{xyy}$。\n    将此结果代回：$\\chi_{xxx} = 2\\chi_{xyy} - 3\\chi_{xyy} = -\\chi_{xyy}$。\n\n**$\\chi^{(2)}$ 的独立非零分量总结：**\n我们选择独立系数集为 $\\chi_{xxx}$、$\\chi_{xxz}$、$\\chi_{zxx}$ 和 $\\chi_{zzz}$。所有其他非零分量都与这些分量相关：\n- $\\chi_{xyy} = -\\chi_{xxx}$\n- $\\chi_{yyx} = \\chi_{yxy} = \\chi_{xyy} = -\\chi_{xxx}$\n- $\\chi_{yyz} = \\chi_{yzy} = \\chi_{xxz}$\n- $\\chi_{zyy} = \\chi_{zxx}$\n- 所有其他分量均为零，包括 $\\chi_{xzz}=0$, $\\chi_{zxz}=0$。\n\n### 第 2 部分：缩并的 $d$ 张量形式\n\n$\\chi^{(2)}_{ijk}$ 张量与 $d_{i\\ell}$ 矩阵之间的关系是通过比较两种形式的本构关系，并遵守 Kleinman 对称性给出的。\n$P_i = \\varepsilon_{0} \\sum_{j,k} \\chi_{ijk} E_j E_k = \\varepsilon_0 (\\chi_{ixx}E_x^2 + \\chi_{iyy}E_y^2 + \\chi_{izz}E_z^2 + 2\\chi_{iyz}E_yE_z + 2\\chi_{ixz}E_xE_z + 2\\chi_{ixy}E_xE_y)$\n$P_i = 2\\varepsilon_{0} \\sum_{\\ell} d_{i\\ell} S_{\\ell} = 2\\varepsilon_0 (d_{i1}E_x^2 + d_{i2}E_y^2 + d_{i3}E_z^2 + 2d_{i4}E_yE_z + 2d_{i5}E_xE_z + 2d_{i6}E_xE_y)$\n比较系数可得映射关系：\n$\\chi_{ixx}=2d_{i1}$, $\\chi_{iyy}=2d_{i2}$, $\\chi_{izz}=2d_{i3}$\n$\\chi_{iyz}=2d_{i4}$, $\\chi_{ixz}=2d_{i5}$, $\\chi_{ixy}=2d_{i6}$\n\n使用第 1 部分中为 $\\chi^{(2)}_{ijk}$ 推导出的关系：\n- $\\chi_{xxx} = 2d_{11}$\n- $\\chi_{xyy} = 2d_{12} \\implies 2d_{12} = -\\chi_{xxx} = -2d_{11} \\implies d_{12}=-d_{11}$。\n- $\\chi_{xzz} = 2d_{13} \\implies 2d_{13} = 0 \\implies d_{13}=0$。\n- $\\chi_{yyz} = 2d_{24}$ 和 $\\chi_{xxz} = 2d_{15}$。关系 $\\chi_{xxz}=\\chi_{yyz}$ 意味着 $d_{15}=d_{24}$。\n- $\\chi_{yxy} = 2d_{26}$。我们有 $\\chi_{yxy} = -\\chi_{xxx}$，所以 $2d_{26} = -2d_{11} \\implies d_{26}=-d_{11}$。\n- $\\chi_{zxx} = 2d_{31}$ 和 $\\chi_{zyy} = 2d_{32}$。关系 $\\chi_{zxx}=\\chi_{zyy}$ 意味着 $d_{31}=d_{32}$。\n- $\\chi_{zxz} = 2d_{35}$ (通过 Kleinman 对称性 $\\chi_{zxz}=\\chi_{zzx}$)。我们发现 $\\chi_{zxz}=0$，所以 $d_{35}=0$。\n- $\\chi_{zzz}=2d_{33}$ 是一个独立系数。\n- 所有其他系数都基于 $\\sigma_v$ 对称性的零值而为零。例如，$d_{14} \\propto \\chi_{xyz}=0$，$d_{21} \\propto \\chi_{yxx}=0$，$d_{22} \\propto \\chi_{yyy}=0$。\n\n将这些结果组合成 $3 \\times 6$ 矩阵 $\\bar{\\bar{d}}$：\n$$\n\\bar{\\bar{d}} = \\begin{pmatrix} d_{11}  d_{12}  d_{13}  d_{14}  d_{15}  d_{16} \\\\ d_{21}  d_{22}  d_{23}  d_{24}  d_{25}  d_{26} \\\\ d_{31}  d_{32}  d_{33}  d_{34}  d_{35}  d_{36} \\end{pmatrix} = \\begin{pmatrix} d_{11}  -d_{11}  0  0  d_{15}  0 \\\\ 0  0  0  d_{15}  0  -d_{11} \\\\ d_{31}  d_{31}  d_{33}  0  0  0 \\end{pmatrix}\n$$\n最小独立系数集可以表示为 $d_{11}$、$d_{15}$、$d_{31}$ 和 $d_{33}$。\n\n### 第 3 部分：归一化纵向极化强度的计算\n\n入射电场给定为 $\\mathbf{E}(\\omega) = E_{0}(\\cos\\phi\\,\\hat{\\mathbf{x}} + \\sin\\phi\\,\\hat{\\mathbf{y}})$。场分量为：\n$E_x=E_0\\cos\\phi$, $E_y=E_0\\sin\\phi$, $E_z=0$。\n\n二次场组合矢量 $S$ 是：\n$S_1 = E_x^2 = E_0^2 \\cos^2\\phi$\n$S_2 = E_y^2 = E_0^2 \\sin^2\\phi$\n$S_3 = E_z^2 = 0$\n$S_4 = 2E_yE_z = 0$\n$S_5 = 2E_xE_z = 0$\n$S_6 = 2E_xE_y = 2E_0^2\\cos\\phi\\sin\\phi = E_0^2\\sin(2\\phi)$\n\n我们需要计算纵向二次谐波极化强度 $P^{(2)}_z(2\\omega)$。公式是：\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,\\sum_{\\ell=1}^{6} d_{3\\ell}\\,S_{\\ell}\n$$\n使用推导出的 $\\bar{\\bar{d}}$ 矩阵的第三行，即 $(d_{31}, d_{31}, d_{33}, 0, 0, 0)$：\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,(d_{31}S_1 + d_{31}S_2 + d_{33}S_3 + 0\\cdot S_4 + 0\\cdot S_5 + 0\\cdot S_6)\n$$\n代入 $S_\\ell$ 的表达式：\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,\\left(d_{31}(E_0^2 \\cos^2\\phi) + d_{31}(E_0^2 \\sin^2\\phi) + d_{33}(0)\\right)\n$$\n提出公因子：\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,d_{31}E_0^2 (\\cos^2\\phi + \\sin^2\\phi)\n$$\n使用三角恒等式 $\\cos^2\\phi+\\sin^2\\phi=1$：\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,d_{31}E_0^2\n$$\n结果与极化角 $\\phi$ 无关。这是绕 $z$ 轴的三重对称性的直接结果，该对称性要求在产生 $P_z^{(2)}$ 时，$E_x^2$ 的系数 ($d_{31}$) 和 $E_y^2$ 的系数 ($d_{32}$) 相等。\n\n最后，我们计算所需的归一化量：\n$$\n\\frac{P^{(2)}_{z}(2\\omega)}{\\varepsilon_{0}\\,E_{0}^{2}} = \\frac{2\\,\\varepsilon_{0}\\,d_{31}E_0^2}{\\varepsilon_{0}\\,E_{0}^{2}} = 2d_{31}\n$$",
            "answer": "$$\n\\boxed{2d_{31}}\n$$"
        },
        {
            "introduction": "将连续介质的张量本构关系离散化到数值网格上是计算电磁学的核心挑战之一，尤其是在处理各向异性介质时。标准的Yee网格在空间上交错存储电场和磁场分量，导致无法直接应用张量乘法。本练习探讨了几种在有限差分时域（FDTD）方法中实现旋转各向异性介电常数张量的策略，并要求你辨别出唯一能够保证数值稳定性和物理互易性的方案，从而深刻理解离散化过程中保持物理守恒律的重要性 。",
            "id": "3331985",
            "problem": "在一个具有均匀间距 $\\,\\Delta x\\,$, $\\,\\Delta y\\,$ 和 $\\,\\Delta z\\,$ 的标准 Yee 网格上，使用三维时域有限差分 (FDTD) 方案对一种无损耗、空间变化、旋转各向异性的电介质进行建模。在每个网格单元中，本构关系为 $\\,\\mathbf{D}(\\mathbf{r},t)=\\boldsymbol{\\varepsilon}(\\mathbf{r})\\,\\mathbf{E}(\\mathbf{r},t)\\,$，其中 $\\,\\boldsymbol{\\varepsilon}(\\mathbf{r})\\,$ 是对称正定的。材料主轴相对于网格发生旋转，具有一个以单元为中心的正交旋转矩阵 $\\,\\mathbf{R}(\\mathbf{r})\\,$ 和主介电常数 $\\,\\varepsilon_1(\\mathbf{r}),\\varepsilon_2(\\mathbf{r}),\\varepsilon_3(\\mathbf{r})\\,$，因此在每个单元中心处有 $\\,\\boldsymbol{\\varepsilon}(\\mathbf{r})=\\mathbf{R}(\\mathbf{r})\\,\\mathrm{diag}(\\varepsilon_1,\\varepsilon_2,\\varepsilon_3)\\,\\mathbf{R}(\\mathbf{r})^{\\mathsf{T}}\\,$。电通量密度 $\\,\\mathbf{D}\\,$ 和电场 $\\,\\mathbf{E}\\,$ 存储在 Yee 网格的边上，与磁场 $\\,\\mathbf{H}\\,$ 在空间上交错分布。\n\n从麦克斯韦旋度方程和本构关系出发，结合电磁能量密度 $\\,u(\\mathbf{r},t)=\\tfrac{1}{2}\\big(\\mathbf{E}\\cdot\\mathbf{D}+\\mathbf{H}\\cdot\\mathbf{B}\\big)\\,$，并假设没有外加源和电导率，推导将边交错的 $\\,\\mathbf{D}\\,$ 映射到边交错的 $\\,\\mathbf{E}\\,$ 的离散本构更新应满足的结构性要求，以确保：\n- 离散电本构算子是对称正定的 (SPD)，从而确保在没有源的情况下离散总能量不增加；\n- 在网格旋转下，离散互易性得以保持；\n- 旋转各向异性被正确地捕捉，而不会产生场分量的伪解耦。\n\n您需要选择以下哪种实现策略能满足在 Yee 网格上处理一般旋转各向异性的这些要求。\n\nA. 预先计算以单元为中心的 $\\,\\boldsymbol{\\varepsilon}\\,$，并将其分量插值到每个边的位置。在每个边上，通过将插值后的张量与局部边场相乘来计算 $\\,\\mathbf{D}=\\boldsymbol{\\varepsilon}\\,\\mathbf{E}\\,$，但为了避免非共址问题，仅计算匹配的分量，即在 $\\,x$-边上计算 $\\,D_x=\\varepsilon_{xx}E_x\\,$，在 $\\,y$-边上计算 $\\,D_y=\\varepsilon_{yy}E_y\\,$，在 $\\,z$-边上计算 $\\,D_z=\\varepsilon_{zz}E_z\\,$。\n\nB. 在每个单元中心，预先计算逆介电常数张量 $\\,\\boldsymbol{\\alpha}=\\boldsymbol{\\varepsilon}^{-1}=\\mathbf{R}\\,\\mathrm{diag}(\\varepsilon_1^{-1},\\varepsilon_2^{-1},\\varepsilon_3^{-1})\\,\\mathbf{R}^{\\mathsf{T}}\\,$。定义一个线性收集算子 $\\,\\mathbf{S}\\,$，通过对单元周围每个分量的四个边样本进行平均（每个分量，每条边使用 $\\,\\tfrac{1}{4}\\,$ 的均匀权重），形成一个以单元为中心的 $\\,\\mathbf{D}\\,$ 向量。在单元中心应用本构映射以获得单元中心的 $\\,\\mathbf{E}\\,$，然后使用收集算子的伴随算子 $\\,\\mathbf{S}^{\\mathsf{T}}\\,$ 将其散布回边上（将每个以单元为中心的分量均等地分配到其对应的四个边上）。在每一步中使用这些预先计算的 $\\,\\boldsymbol{\\alpha}\\,$ 和伴随对 $\\,\\mathbf{S},\\mathbf{S}^{\\mathsf{T}}\\,$ 来构建边到边的本构更新。\n\nC. 预先计算以单元为中心的 $\\,\\boldsymbol{\\varepsilon}\\,$ 及其旋转。在每个边上，通过将 $\\,\\mathbf{R}^{\\mathsf{T}}\\,$ 应用于单个存储的分量来旋转局部边场分量以获得一个伪主分量，然后用相应的主介电常数对其进行缩放，再通过 $\\,\\mathbf{R}\\,$ 旋转回来，所有这些操作都对 $\\,x$-、$\\,y$- 和 $\\,z$-边独立执行，而不形成共址向量。\n\nD. 预先计算以单元为中心的 $\\,\\boldsymbol{\\alpha}=\\boldsymbol{\\varepsilon}^{-1}\\,$。对于每个边，通过对相邻单元进行算术平均，仅将 $\\,\\boldsymbol{\\alpha}\\,$ 的相应行插值到该边。在该边上，通过对每个分量最近的四个边进行简单算术平均，从其原生边插值两个非共址分量，从而组装一个局部的 $\\,\\mathbf{D}\\,$ 向量。然后通过行向量缩并计算边场分量，例如，在 $\\,x$-边上计算 $\\,E_x=\\boldsymbol{\\alpha}_{x:}\\cdot\\mathbf{D}\\,$。在每个边上，通过用其对称化形式 $\\,\\tfrac{1}{2}\\big(\\tilde{\\boldsymbol{\\alpha}}+\\tilde{\\boldsymbol{\\alpha}}^{\\mathsf{T}}\\big)\\,$ 替换插值后的边张量来强制对称性。\n\nE. 在每个单元的 $\\,6\\,$ 个面上预先计算以面为中心的 $\\,\\boldsymbol{\\alpha}\\,$。对于每个面，通过平均将 $\\,\\mathbf{D}\\,$ 的两个切向分量共址到面中心，应用 $\\,\\boldsymbol{\\alpha}\\,$ 的一个 $\\,2\\times 2\\,$ 切向块以获得以面为中心的切向 $\\,\\mathbf{E}\\,$，然后将两个切向分量分配回周围的四个边。忽略与法向分量的耦合以避免非共址问题。\n\n选择满足在 Yee 网格上处理一般旋转各向异性介质的所有规定要求的选项。并根据麦克斯韦方程、离散能量恒等式以及在离散本构映射中保持对称性和正定性的必要性来证明您的选择。",
            "solution": "问题陈述经评估有效。它在计算电磁学领域有科学依据，问题提出得很好，并使用了精确、客观的语言。该设置描述了该领域一个标准的、非平凡的问题：在时域有限差分 (FDTD) 框架内对一般各向异性材料进行稳定和准确的建模。所有必要的信息都已提供。\n\n问题的核心在于在 Yee 网格上离散化本构关系 $\\mathbf{D} = \\boldsymbol{\\varepsilon} \\mathbf{E}$。在连续空间中，这是一个点对点的关系。在 Yee 网格上，$\\mathbf{E}$ 和 $\\mathbf{D}$ 的笛卡尔分量位于网格边的中心，因此它们不是共址的。例如，在定义了 $E_x$ 和 $D_x$ 的 $x$ 向边的位置，无法获得 $E_y$ 和 $E_z$ 分量。一个普遍的各向异性介电常数张量 $\\boldsymbol{\\varepsilon}$ 会耦合所有分量，例如 $D_x = \\varepsilon_{xx} E_x + \\varepsilon_{xy} E_y + \\varepsilon_{xz} E_z$。因此，朴素的更新是不可能的。任何有效的数值方案都必须采用一致的插值或平均程序来处理这种非共址问题。\n\n该问题要求从 $\\mathbf{D}$ 到 $\\mathbf{E}$ 的离散更新，这对应于逆本构关系 $\\mathbf{E} = \\boldsymbol{\\varepsilon}^{-1} \\mathbf{D} = \\boldsymbol{\\alpha} \\mathbf{D}$。设包含 $\\mathbf{E}$ 和 $\\mathbf{D}$ 所有离散边分量的全局向量分别表示为 $\\mathbb{E}$ 和 $\\mathbb{D}$。FDTD 更新需要一个离散算子 $\\mathbf{A}$，使得 $\\mathbb{E} = \\mathbf{A} \\mathbb{D}$。对该算子的要求如下：\n\n1.  **对称正定 (SPD)：** 电场中的离散能量由二次型 $\\mathcal{E}_e = \\tfrac{1}{2} \\mathbb{D}^{\\mathsf{T}} \\mathbb{E} = \\tfrac{1}{2} \\mathbb{D}^{\\mathsf{T}} \\mathbf{A} \\mathbb{D}$ 给出。为使系统的总离散能量在无源、无损耗介质中不增加（这是数值稳定性的一个条件），算子 $\\mathbf{A}$ 必须是对称正定的 (SPD)。算子的对称性也确保了离散系统遵守从对称连续张量 $\\boldsymbol{\\varepsilon}$ 继承而来的互易性原理。\n2.  **在网格旋转下保持互易性：** 这意味着方案的结构不应以破坏互易性这一物理原理的方式从根本上与网格轴绑定，而对称离散算子可以保证这一性质。\n3.  **正确捕捉旋转各向异性：** 该方案必须考虑张量 $\\boldsymbol{\\alpha}$ (或 $\\boldsymbol{\\varepsilon}$) 的所有分量，包括对于一般旋转各向异性材料非零的非对角项。忽略这些项的方案将产生物理上不正确的结果。\n\n在确立了这些原则之后，我们来评估每个选项。\n\n**选项 A 评估**\n该选项建议在 $x$-边上计算 $D_x = \\varepsilon_{xx} E_x$，在 $y$-边上计算 $D_y = \\varepsilon_{yy} E_y$，在 $z$-边上计算 $D_z = \\varepsilon_{zz} E_z$。这构成了一个纯对角的更新方案。它完全忽略了介电常数张量的非对角元素，例如 $\\varepsilon_{xy}$，这些元素负责旋转各向异性介质中不同场分量之间的耦合。该方案仅在材料主轴与网格轴对齐时才能正确工作，这是“一般旋转各向异性”未涵盖的特殊情况。通过忽略耦合项，它会导致“场分量的伪解耦”。\n**结论：不正确。** 该方法未能满足要求 #3。\n\n**选项 B 评估**\n该选项描述了一个收集-散布过程，也称为体平均或材料平均方案。步骤如下：\n1.  **收集：** 线性算子 $\\mathbf{S}$ 对边交错的 $\\mathbf{D}$ 分量进行平均，以生成一个共址的、以单元为中心的 $\\mathbf{D}_{cc}$ 向量。以矩阵形式表示为 $\\mathbb{D}_{cc} = \\mathbf{S} \\mathbb{D}$。\n2.  **应用本构律：** 在单元中心，所有分量都是共址的。直接应用逆介电常数张量 $\\boldsymbol{\\alpha}(\\mathbf{r})$：$\\mathbf{E}_{cc}(\\mathbf{r}) = \\boldsymbol{\\alpha}(\\mathbf{r}) \\mathbf{D}_{cc}(\\mathbf{r})$。设 $\\mathbf{A}_{cc}$ 是包含每个单元的局部 $3 \\times 3$ 张量 $\\boldsymbol{\\alpha}(\\mathbf{r})$ 的块对角矩阵。由于 $\\boldsymbol{\\varepsilon}$ 是 SPD 的，其逆 $\\boldsymbol{\\alpha}$ 也是 SPD 的，因此 $\\mathbf{A}_{cc}$ 是一个 SPD 矩阵。更新关系为 $\\mathbb{E}_{cc} = \\mathbf{A}_{cc} \\mathbb{D}_{cc}$。\n3.  **散布：** 使用伴随算子 $\\mathbf{S}^{\\mathsf{T}}$ 将得到的以单元为中心的场 $\\mathbf{E}_{cc}$ 分配回网格边上。最终的边场向量为 $\\mathbb{E} = \\mathbf{S}^{\\mathsf{T}} \\mathbb{E}_{cc}$。\n\n结合这些步骤，完整的边到边更新算子 $\\mathbf{A}$ 由 $\\mathbb{E} = (\\mathbf{S}^{\\mathsf{T}} \\mathbf{A}_{cc} \\mathbf{S}) \\mathbb{D}$ 给出，因此 $\\mathbf{A} = \\mathbf{S}^{\\mathsf{T}} \\mathbf{A}_{cc} \\mathbf{S}$。\n让我们检查各项要求：\n1.  **SPD：** 这种构造在数学上保证了全局算子 $\\mathbf{A}$ 是对称半正定的，因为 $\\mathbf{A}^{\\mathsf{T}} = (\\mathbf{S}^{\\mathsf{T}} \\mathbf{A}_{cc} \\mathbf{S})^{\\mathsf{T}} = \\mathbf{S}^{\\mathsf{T}} \\mathbf{A}_{cc}^{\\mathsf{T}} (\\mathbf{S}^{\\mathsf{T}})^{\\mathsf{T}} = \\mathbf{S}^{\\mathsf{T}} \\mathbf{A}_{cc} \\mathbf{S} = \\mathbf{A}$（因为 $\\mathbf{A}_{cc}$ 是对称的）。如果 $\\mathbf{S}$ 的零空间是平凡的（对于所提出的平均法这是成立的），那么它就是正定的。这种结构确保了一个稳定的、能量守恒的方案。\n2.  **互易性：** $\\mathbf{A}$ 的对称性保证了离散互易性。\n3.  **各向异性：** 在单元中心使用了完整的张量 $\\boldsymbol{\\alpha}$，正确地考虑了场分量之间的所有耦合。\n该方法正确且稳健地对物理现象进行建模。\n**结论：正确。**\n\n**选项 C 评估**\n该选项描述了在每个边上独立执行的过程。对于一个 $x$-边，它建议将旋转 $\\mathbf{R}^{\\mathsf{T}}$ 应用于“单个存储的分量”。将一个 $3 \\times 3$ 矩阵应用于一个标量是没有明确定义的。一种合理的解释是，构造一个向量 $(E_x, 0, 0)$，对其进行旋转，用主介电常数缩放其分量，然后再旋转回来。这将得到 $\\mathbf{D} = \\mathbf{R} \\, \\mathrm{diag}(\\varepsilon_1, \\varepsilon_2, \\varepsilon_3) \\, \\mathbf{R}^{\\mathsf{T}} (E_x, 0, 0)^{\\mathsf{T}} = \\boldsymbol{\\varepsilon} (E_x, 0, 0)^{\\mathsf{T}}$。那么 $x$-分量将是 $D_x = \\varepsilon_{xx} E_x$。这简化为了选项 A 中有缺陷的对角方案。任何为每个边方向“独立”计算更新的方案都无法按非对角张量元素的要求正确地耦合场分量。\n**结论：不正确。** 该方法要么没有明确定义，要么在合理解释下等同于选项 A，未能满足要求 #3。\n\n**选项 D 评估**\n该选项描述了一种常见但有问题的、基于在边位置直接插值张量和场分量的方法。为了求得 $E_x$，首先需要将必要的张量行分量 $(\\alpha_{xx}, \\alpha_{xy}, \\alpha_{xz})$ 插值到 $E_x$ 的位置，同时也将非共址的场分量 $D_y$ 和 $D_z$ 插值到同一位置。虽然这确实包含了非对角张量项，但全局算子 $\\mathbf{A}$ 的构造是缺乏系统性的。用于将 $D_y$ 带到 $x$-边位置和将 $D_x$ 带到 $y$-边位置的平均模板通常彼此不是伴随的。这导致全局算子 $\\mathbf{A}$ 不对称。通过 $\\tfrac{1}{2}(\\tilde{\\boldsymbol{\\alpha}}+\\tilde{\\boldsymbol{\\alpha}}^{\\mathsf{T}})$ 在局部强制对称性的提议并不能修正由插值模板引起的全局算子 $\\mathbf{A}$ 的不对称性。非对称算子不保证能量守恒，并可能导致后期不稳定性。\n**结论：不正确。** 该方法未能满足要求 #1，因为它不能产生一个可证明为 SPD 的算子。\n\n**选项 E 评估**\n该方法建议在每个单元面上进行 $2 \\times 2$ 更新，仅考虑切向场分量。例如，在一个法向为 $z$ 轴的面上，它会使用切向通量 $(D_x, D_y)$ 和 $\\boldsymbol{\\alpha}$ 的左上角 $2 \\times 2$ 块来更新切向场 $(E_x, E_y)$。关键是，它声明要“忽略与法向分量的耦合”。这意味着对于一般的旋转材料，更新 $E_x$ 和 $E_y$ 时的项（如 $\\alpha_{xz}$ 和 $\\alpha_{yz}$）被忽略了。这是一种物理上的简化，只有当张量相对于网格平面是块对角时才有效，而这对于旋转各向异性并非普遍情况。\n**结论：不正确。** 该方法错误地解耦了切向和法向分量，未能满足要求 #3。\n\n总之，只有选项 B 中描述的收集-散布方法系统地构建了一个离散本构算子，该算子在正确地包含了各向异性材料的全部物理特性的同时，保证了对称正定性。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "掌握了线性和非线性张量的描述以及各向异性介质的稳定离散化方法后，我们将两者结合，构建一个完整的非线性现象时域仿真。本练习要求你为一个具有克尔（Kerr）非线性的各向异性介质设计并实现一个一维有限差分时域（FDTD）模拟程序。你将需要实现一个牛顿法预测-校正器来求解非线性本构关系，并分析该方案的数值稳定性，最终通过运行一系列测试案例来验证你的理论分析和代码实现 。",
            "id": "3331925",
            "problem": "在计算电磁学中，考虑一个具有周期性边界条件的一维横电配置，其中电场分量 $E_y(x,t)$ 与磁场分量 $H_z(x,t)$ 耦合。该材料是克尔型各向异性的，其电位移 $\\mathbf{D}$ 通过一个张量值介电常数 $\\boldsymbol{\\epsilon}(\\mathbf{E})=\\boldsymbol{\\epsilon}_0+\\alpha\\,\\mathrm{diag}(E_x^2,E_y^2,E_z^2)$ 非线性地、分量地依赖于 $\\mathbf{E}$。在当前的一维横电配置中，假设 $E_x=0$ 和 $E_z=0$，因此唯一的非零位移分量是 $D_y(x,t)$，其本构关系为 $D_y=\\epsilon_y(E_y)\\,E_y$ 且\n$$\n\\epsilon_y(E_y)=\\epsilon_y+\\alpha E_y^2,\n$$\n其中 $\\epsilon_y$ 是沿 $y$ 轴的恒定基线介电常数（各向异性基线张量 $\\boldsymbol{\\epsilon}_0$ 的一个分量），$\\alpha$ 是克尔非线性系数。磁响应是线性和各向同性的，即 $B_z=\\mu_0 H_z$，其中 $\\mu_0$ 是真空磁导率。\n\n从麦克斯韦方程组的微分形式出发，\n$$\n\\nabla \\times \\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t},\\qquad \\nabla \\times \\mathbf{H}=\\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\n在长度为 $L$、具有周期性边界条件的域上，为一个包含 $N_x$ 个点的均匀网格，推导一个针对 $(E_y,H_z)$ 对的类Yee时域有限差分格式。在时间上使用蛙跳式交错，使得 $H_z$ 在半时间步更新，$D_y$ 在整数时间步更新。具体来说：\n\n- 用空间有限差分（间距 $\\Delta x=L/N_x$）和时间步长 $\\Delta t$ 来表示 $H_z$ 和 $D_y$ 的离散更新，确保与一维空间中的旋度关系一致。\n\n- 由于本构关系 $D_y=\\epsilon_y(E_y) E_y=\\epsilon_y E_y + \\alpha E_y^3$ 在 $E_y$ 中是非线性的，为从更新后的 $D_y^{n+1}$ 计算 $E_y^{n+1}$，在每个网格点上构建并实现一个牛顿预测-校正步骤。也就是说，对每个节点，求解标量非线性方程\n$$\nf(E)=\\alpha E^3+\\epsilon_y E - D_y^{n+1}=0\n$$\n使用：\n  1. 从上一个电场迭代值 $E_y^n$ 开始，通过一次牛顿迭代获得的预测值，以及\n  2. 通过继续牛顿迭代直至达到指定容差而获得的校正值。\n\n通过将本构关系在一个非零工作场振幅 $E_0$ 附近线性化，以定义一个有效介电常数\n$$\n\\epsilon_{\\mathrm{eff}}(E_0)=\\epsilon_y+3\\alpha E_0^2,\n$$\n对此带有非线性更新的类Yee格式进行稳定性分析，然后推导出一个关于 $\\Delta t$ 的Courant–Friedrichs–Lewy (CFL) 界限，使得离散能量\n$$\n\\mathcal{E}^n=\\sum_{i=0}^{N_x-1}\\frac{1}{2}\\left(E_{y,i}^n D_{y,i}^n+\\mu_0 H_{z,i}^{n+\\frac{1}{2}} H_{z,i}^{n+\\frac{1}{2}}\\right)\\Delta x\n$$\n保持有界。根据麦克斯韦方程组和离散更新结构提供推理，论证关于 $\\Delta x$、$\\mu_0$ 和 $\\epsilon_{\\mathrm{eff}}$ 的容许界限的适当时间步长限制。\n\n将上述格式实现为一个可运行程序，为一组测试用例执行以下数值实验。对于每个测试用例，将 $E_y(x,0)$ 初始化为一个中心在 $x=L/2$、振幅为 $A$、宽度为 $w=L/10$ 的高斯脉冲，即\n$$\nE_y(x,0)=A\\exp\\left(-\\frac{(x-L/2)^2}{w^2}\\right),\n$$\n并设置 $H_z(x,-\\Delta t/2)=0$。初始化 $D_y(x,0)=\\epsilon_y E_y(x,0)+\\alpha E_y(x,0)^3$。使用带有牛顿预测-校正规则的类Yee更新，将解推进 $N_{\\mathrm{steps}}$ 步。对每次运行的稳定性定义如下：如果所有场值保持有限，并且所有时间步中的最大离散能量小于初始能量的 $1.5$ 倍，则该次运行是稳定的，否则是不稳定的。\n\n使用国际单位制，其中 $\\Delta x$ 以米表示，$\\Delta t$ 以秒表示，场振幅以伏特/米表示，介电常数以法拉/米表示，磁导率以亨利/米表示。真空常数为 $\\epsilon_0=8.854187817\\times10^{-12}\\,\\mathrm{F/m}$ 和 $\\mu_0=4\\pi\\times10^{-7}\\,\\mathrm{H/m}$。基线各向异性介电常数分量 $\\epsilon_y$ 由 $\\epsilon_y=\\epsilon_0 \\epsilon_{r,y}$ 给出，其中 $\\epsilon_{r,y}$ 是沿 $y$ 轴的无量纲相对介电常数。\n\n测试套件：\n对于每个测试用例，程序必须根据基于 $\\epsilon_y$ 的线性CFL界限，通过一个指定的缩放因子 $s$ 来构造 $\\Delta t$，即\n$$\n\\Delta t = s\\frac{\\Delta x}{v_{\\mathrm{base}}},\\qquad v_{\\mathrm{base}}=\\frac{1}{\\sqrt{\\mu_0 \\epsilon_y}}.\n$$\n对每个用例运行指定的步数 $N_{\\mathrm{steps}}$ 并报告其稳定性。\n\n- 用例 1 (理想情况): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=+1.0\\times 10^{-24}\\,\\mathrm{F\\cdot m/V^2}$, $A=1.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=0.90$, $N_{\\mathrm{steps}}=800$。\n\n- 用例 2 (违反CFL，预期不稳定): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=+1.0\\times 10^{-24}\\,\\mathrm{F\\cdot m/V^2}$, $A=1.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=1.10$, $N_{\\mathrm{steps}}=600$。\n\n- 用例 3 (负非线性，保守步长): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=-5.0\\times 10^{-25}\\,\\mathrm{F\\cdot m/V^2}$, $A=4.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=0.50$, $N_{\\mathrm{steps}}=800$。\n\n- 用例 4 (负非线性，激进步长，预期不稳定): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=-5.0\\times 10^{-25}\\,\\mathrm{F\\cdot m/V^2}$, $A=4.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=0.95$, $N_{\\mathrm{steps}}=800$。\n\n您的程序应生成单行输出，其中包含四个测试用例的稳定性结果，形式为方括号括起来的逗号分隔列表（例如，“[True,False,True,False]”）。",
            "solution": "该问题具有科学依据，提法恰当且客观。它指定了一个计算电磁学中的标准数值实验，涉及使用时域有限差分 (FDTD) 方法模拟非线性各向异性介质。所有参数、方程和条件都已明确定义。我将提供一个完整的解决方案。\n\n解决方案分三部分呈现：首先，从麦克斯韦方程组推导 FDTD 更新方程；其次，对所得格式进行稳定性分析；第三，解释数值实现。\n\n### 1. FDTD 格式的推导\n\n我们从无源介质中的麦克斯韦旋度方程开始：\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n问题指定了一维横电 (TE) 配置，其中场仅在 $x$ 方向上变化。非零场分量为 $E_y(x,t)$ 和 $H_z(x,t)$，因此 $\\mathbf{E} = E_y \\hat{\\mathbf{y}}$ 和 $\\mathbf{H} = H_z \\hat{\\mathbf{z}}$。本构关系给出为 $B_z = \\mu_0 H_z$ 和 $D_y = (\\epsilon_y + \\alpha E_y^2) E_y$。\n\n在这些条件下，旋度算符得以简化。\n对于第一个方程（法拉第定律）：\n$$\n\\nabla \\times \\mathbf{E} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\\n\\partial_x  \\partial_y  \\partial_z \\\\\n0  E_y  0\n\\end{vmatrix}\n= -\\frac{\\partial E_y}{\\partial x} \\hat{\\mathbf{z}}\n$$\n令 $\\hat{\\mathbf{z}}$ 分量相等并代入 $B_z = \\mu_0 H_z$，我们得到：\n$$\n-\\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t} \\implies \\mu_0 \\frac{\\partial H_z}{\\partial t} = \\frac{\\partial E_y}{\\partial x}\n$$\n对于第二个方程（安培定律）：\n$$\n\\nabla \\times \\mathbf{H} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\\n\\partial_x  \\partial_y  \\partial_z \\\\\n0  0  H_z\n\\end{vmatrix}\n= -\\frac{\\partial H_z}{\\partial x} \\hat{\\mathbf{y}}\n$$\n令 $\\hat{\\mathbf{y}}$ 分量相等，我们得到：\n$$\n\\frac{\\partial D_y}{\\partial t} = -\\frac{\\partial H_z}{\\partial x}\n$$\n现在我们在均匀网格上离散化这两个耦合的偏微分方程。遵循类Yee蛙跳格式，我们在整数空间网格点 $i$ 和整数时间步 $n$ 处计算 $E_y$ 和 $D_y$，表示为 $E_{y,i}^n$ 和 $D_{y,i}^n$。磁场 $H_z$ 在半整数空间点 $i+1/2$ 和半整数时间步 $n+1/2$ 处计算，表示为 $H_{z,i+1/2}^{n+1/2}$。网格间距为 $\\Delta x=L/N_x$，时间步长为 $\\Delta t$。\n\n使用中心差分近似：\n$H_z$ 更新方程通过在 $(i+1/2, n)$ 处计算法拉第定律来导出：\n$$\n\\mu_0 \\frac{H_{z,i+1/2}^{n+1/2} - H_{z,i+1/2}^{n-1/2}}{\\Delta t} = \\frac{E_{y,i+1}^n - E_{y,i}^n}{\\Delta x}\n$$\n这给出了 $H_z$ 的更新规则：\n$$\nH_{z,i+1/2}^{n+1/2} = H_{z,i+1/2}^{n-1/2} + \\frac{\\Delta t}{\\mu_0 \\Delta x} (E_{y,i+1}^n - E_{y,i}^n)\n$$\n$D_y$ 更新方程通过在 $(i, n+1/2)$ 处计算安培定律来导出：\n$$\n\\frac{D_{y,i}^{n+1} - D_{y,i}^n}{\\Delta t} = - \\frac{H_{z,i+1/2}^{n+1/2} - H_{z,i-1/2}^{n+1/2}}{\\Delta x}\n$$\n这给出了 $D_y$ 的更新规则：\n$$\nD_{y,i}^{n+1} = D_{y,i}^n - \\frac{\\Delta t}{\\Delta x} (H_{z,i+1/2}^{n+1/2} - H_{z,i-1/2}^{n+1/2})\n$$\n在获得 $D_{y,i}^{n+1}$ 后，我们必须通过求解非线性标量三次方程来找到相应的 $E_{y,i}^{n+1}$：\n$$\nf(E) = \\alpha E^3 + \\epsilon_y E - D_{y,i}^{n+1} = 0\n$$\n这通过牛顿法完成，该方法迭代地改进对根的猜测 $E_k$：\n$$\nE_{k+1} = E_k - \\frac{f(E_k)}{f'(E_k)} = E_k - \\frac{\\alpha E_k^3 + \\epsilon_y E_k - D_{y,i}^{n+1}}{3\\alpha E_k^2 + \\epsilon_y}\n$$\n按要求，该格式使用预测-校正方法。预测器是第一次迭代，从 $E_k = E_{y,i}^n$ 开始。校正器包括后续迭代，直到变化量 $|E_{k+1} - E_k|$ 低于指定容差为止。\n\n### 2. 稳定性分析\n\n为推导Courant–Friedrichs–Lewy (CFL) 条件，我们将系统响应在恒定工作场振幅 $E_0$ 周围线性化。本构关系为 $D_y = \\epsilon_y E_y + \\alpha E_y^3$。小信号（微分）介电常数为：\n$$\n\\epsilon_{\\mathrm{eff}} = \\frac{dD_y}{dE_y} \\bigg|_{E_0} = \\epsilon_y + 3\\alpha E_0^2\n$$\n这个 $\\epsilon_{\\mathrm{eff}}$ 控制着小扰动的传播速度，$v_{\\mathrm{eff}} = 1/\\sqrt{\\mu_0 \\epsilon_{\\mathrm{eff}}}$。\n为了使 FDTD 格式稳定，数值传播速度 $\\Delta x / \\Delta t$ 必须至少与系统中任何波的物理传播速度一样大。稳定性由可能的最大波速决定，这对应于 $\\epsilon_{\\mathrm{eff}}$ 的最小正值。\n$$\n\\frac{\\Delta x}{\\Delta t} \\ge \\max(v_{\\mathrm{eff}}) = \\frac{1}{\\sqrt{\\mu_0 \\min(\\epsilon_{\\mathrm{eff}})}}\n$$\n这意味着对时间步长的 CFL 条件是：\n$$\n\\Delta t \\le \\Delta x \\sqrt{\\mu_0 \\min(\\epsilon_{\\mathrm{eff}})}\n$$\n$\\min(\\epsilon_{\\mathrm{eff}})$ 的值取决于非线性系数 $\\alpha$ 的符号：\n- 如果 $\\alpha > 0$，则 $\\epsilon_{\\mathrm{eff}}(E_y) = \\epsilon_y + 3\\alpha E_y^2$ 总是大于或等于 $\\epsilon_y$。最小值为 $\\epsilon_{\\mathrm{eff}}(0) = \\epsilon_y$。CFL 条件变为 $\\Delta t \\le \\Delta x \\sqrt{\\mu_0 \\epsilon_y}$。时间步长被给出为 $\\Delta t = s \\Delta x \\sqrt{\\mu_0 \\epsilon_y}$，因此稳定性要求 $s \\le 1$。\n- 如果 $\\alpha < 0$，则随着 $|E_y|$ 增加，$\\epsilon_{\\mathrm{eff}}(E_y)$ 减小。$\\epsilon_{\\mathrm{eff}}$ 的最小值将出现在峰值场振幅 $E_{\\max}$ 处。稳定性条件是 $\\Delta t \\le \\Delta x \\sqrt{\\mu_0 (\\epsilon_y + 3\\alpha E_{\\max}^2)}$。这可以用缩放因子 $s$ 重写为：\n$$\ns \\le \\sqrt{1 + \\frac{3\\alpha E_{\\max}^2}{\\epsilon_y}}\n$$\n一个关键的后果是，如果场振幅 $E_y$ 足够大，以至于 $\\epsilon_y + 3\\alpha E_y^2 \\le 0$，有效介电常数将变为非正数。这对应于调制不稳定性的物理现象，此时介质本身变得不稳定。在此机制下，对于任何实数 $\\Delta t$，线性化的CFL条件都无法满足，我们预计无论时间步长如何，模拟都会变得不稳定。\n\n离散能量 $\\mathcal{E}^n = \\sum_i \\frac{1}{2} (E_{y,i}^n D_{y,i}^n + \\mu_0 H_{z,i}^{n+1/2} H_{z,i}^{n+1/2}) \\Delta x$ 在非线性格式中并非严格守恒。然而，该能量的有界性是数值稳定性的一个实用指标。上面推导的 CFL 条件确保误差不会指数级增长，这反过来又使离散能量保持有界。违反此条件会导致数值不稳定性，其中场值无界增长，导致能量发散。\n\n### 3. 实现细节\n\nFDTD 格式在一个 Python 程序中实现，使用 `numpy` 库进行高效的数组操作。主模拟循环遍历测试用例。对于每个用例：\n1.  根据给定输入计算模拟参数（$\\Delta x, \\epsilon_y, \\Delta t$ 等）。\n2.  初始化 $E_y$、$H_z$ 和 $D_y$ 的数组。$H_z$ 的初始条件是 $H_z(x, -\\Delta t/2)=0$。\n3.  根据问题的公式计算初始能量 $\\mathcal{E}^0$，这需要从 $E_y(x,0)$ 预先计算 $H_z(x, \\Delta t/2)$。该值存储为 `E_initial`，并初始化一个运行中的最大值 `E_max`。\n4.  主 FDTD 循环执行 $N_{\\mathrm{steps}}$ 次。在每次迭代 $n$ 中：\n    -   使用时刻 $n$ 的 $E_y$ 将 $H_z$ 从时刻 $n-1/2$ 更新到 $n+1/2$。周期性边界条件通过 `numpy.roll` 处理。\n    -   计算离散能量 $\\mathcal{E}^n$ 并更新 `E_max`。根据 $1.5 \\times \\mathcal{E}^0$ 的准则进行稳定性检查。\n    -   使用时刻 $n+1/2$ 的 $H_z$ 将 $D_y$ 从时刻 $n$ 更新到 $n+1$。\n    -   通过对每个网格点使用矢量化的牛顿法数值求解非线性三次方程，将 $E_y$ 从时刻 $n$ 更新到 $n+1$。值 $E_y^n$ 用作初始猜测。\n    -   每次更新后检查是否存在 `NaN` 或 `inf` 值，以检测灾难性发散。\n5.  如果循环完成而能量未超过阈值或发生数值溢出，则认为运行是稳定的 (`True`)；否则，它是不稳定的 (`False`)。\n6.  收集所有测试用例的稳定性结果，并以指定的列表格式打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the FDTD simulations for a suite of test cases.\n    \"\"\"\n    # Physical Constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n    MU_0 = 4 * np.pi * 1e-7      # H/m\n    \n    # Test cases from the problem statement\n    test_cases = [\n        # (Nx, L, eps_r_y, alpha, A, s, N_steps)\n        (400, 1.0, 2.25, 1.0e-24, 1.0e6, 0.90, 800), # Case 1\n        (400, 1.0, 2.25, 1.0e-24, 1.0e6, 1.10, 600), # Case 2\n        (400, 1.0, 2.25, -5.0e-25, 4.0e6, 0.50, 800), # Case 3\n        (400, 1.0, 2.25, -5.0e-25, 4.0e6, 0.95, 800), # Case 4\n    ]\n\n    results = []\n    for params in test_cases:\n        is_stable = run_simulation(params, EPSILON_0, MU_0)\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_newton(Dy, Ey_guess, epsilon_y, alpha, tol=1e-9, max_iter=10):\n    \"\"\"\n    Solves for Ey from Dy using Newton's method.\n    The equation to solve is f(Ey) = alpha * Ey^3 + epsilon_y * Ey - Dy = 0.\n    This is performed element-wise for all grid points.\n    \n    Args:\n        Dy (np.ndarray): Array of electric displacement values D_y^{n+1}.\n        Ey_guess (np.ndarray): Initial guess for E_y^{n+1}, typically E_y^n.\n        epsilon_y (float): Linear permittivity.\n        alpha (float): Kerr nonlinearity coefficient.\n        tol (float): Convergence tolerance.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        np.ndarray: The solved electric field E_y^{n+1}.\n    \"\"\"\n    Ey = Ey_guess.copy()\n    for _ in range(max_iter):\n        f = alpha * Ey**3 + epsilon_y * Ey - Dy\n        f_prime = 3 * alpha * Ey**2 + epsilon_y\n        \n        # Add a small stabilization term to prevent division by zero,\n        # although this is extremely unlikely to be exactly zero.\n        # If f_prime is negative, it's a sign of potential physical instability,\n        # but Newton's method can still converge.\n        update = f / (f_prime + 1e-99)\n        Ey -= update\n        \n        if np.max(np.abs(update))  tol:\n            break\n            \n    return Ey\n\ndef run_simulation(params, epsilon_0, mu_0):\n    \"\"\"\n    Runs a single FDTD simulation case and determines its stability.\n    \n    Args:\n        params (tuple): A tuple containing simulation parameters\n                        (Nx, L, eps_r_y, alpha, A, s, N_steps).\n        epsilon_0 (float): Vacuum permittivity.\n        mu_0 (float): Vacuum permeability.\n\n    Returns:\n        bool: True if the simulation is stable, False otherwise.\n    \"\"\"\n    Nx, L, eps_r_y, alpha, A, s, N_steps = params\n    \n    # Derived parameters\n    dx = L / Nx\n    epsilon_y = eps_r_y * epsilon_0\n    v_base = 1.0 / np.sqrt(mu_0 * epsilon_y)\n    dt = s * dx / v_base\n\n    # Spatial grid\n    # x = np.linspace(0, L, Nx, endpoint=False)\n    # The explicit x-grid is not strictly needed for the updates, but for ICs\n    x_coords = dx * np.arange(Nx)\n\n    # Initial conditions\n    Ey = A * np.exp(-((x_coords - L / 2)**2) / (L / 10)**2)  # Ey at t=0\n    Hz = np.zeros(Nx)                                     # Hz at t=-dt/2\n    Dy = epsilon_y * Ey + alpha * Ey**3                   # Dy at t=0\n\n    # For the energy calculation at n=0, we need H at t=dt/2.\n    # Perform the first half-step update for H.\n    Hz_half = Hz + (dt / (mu_0 * dx)) * (np.roll(Ey, -1) - Ey)\n    \n    # Initial energy calculation as per problem statement: E^n uses E^n, D^n, H^{n+1/2}\n    # For n=0, we use E_0, D_0, H_{1/2}\n    E_initial = 0.5 * np.sum(Ey * Dy + mu_0 * Hz_half**2) * dx\n    if E_initial == 0: E_initial = 1e-30 # Avoid division by zero if initial energy is zero\n    E_max = E_initial\n    \n    # Set the state for the main FDTD loop. The H-field is a half-step behind.\n    H = Hz \n    \n    for _ in range(N_steps):\n        # State at loop start: Ey is E^n, Dy is D^n, H is H^{n-1/2}\n        \n        # --- Update H-field to H^{n+1/2} ---\n        H = H + (dt / (mu_0 * dx)) * (np.roll(Ey, -1) - Ey)\n\n        # Check for immediate numerical instability\n        if not np.all(np.isfinite(H)):\n            return False\n\n        # --- Energy check and stability criterion ---\n        # Calculate energy at step n, using E^n, D^n, and the newly computed H^{n+1/2}\n        current_energy = 0.5 * np.sum(Ey * Dy + mu_0 * H**2) * dx\n        E_max = max(E_max, current_energy)\n\n        if E_max > 1.5 * E_initial:\n            return False\n        \n        # --- Update D-field to D^{n+1} ---\n        Dy = Dy - (dt / dx) * (H - np.roll(H, 1))\n\n        # --- Update E-field to E^{n+1} ---\n        Ey = solve_newton(Dy, Ey, epsilon_y, alpha)\n\n        # Check for numerical instability from the nonlinear solve\n        if not np.all(np.isfinite(Ey)):\n            return False\n            \n    return True\n\nsolve()\n\n```"
        }
    ]
}