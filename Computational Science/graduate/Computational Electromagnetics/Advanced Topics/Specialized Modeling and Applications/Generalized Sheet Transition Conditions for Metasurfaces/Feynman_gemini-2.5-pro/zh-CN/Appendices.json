{
    "hands_on_practices": [
        {
            "introduction": "在设计或使用超构表面之前，我们必须能够确定其电磁特性。本练习将引导你解决一个被称为“逆问题”的关键任务。你将利用广义边界条件（GSTCs）来推导，需要进行哪些最少的测量才能唯一地确定一个未知超构表面的完整磁电磁化率张量 $\\bar{\\bar{\\chi}}_{em}$，这是验证新设计和进行制造质量控制的核心环节。",
            "id": "3311113",
            "problem": "考虑一个位于自由空间中 $z=0$ 处的零厚度平面超构表面，其通过广义边界条件 (GSTCs) 进行建模。假设场为时谐场，相量约定为 $\\exp(j \\omega t)$，且该超构表面是各向异性的，并可能非互易，但其唯一非零的面极化率是切向磁电交叉极化率张量 $\\bar{\\bar{\\chi}}_{em}$（即 $\\bar{\\bar{\\chi}}_{ee}=\\bar{\\bar{\\chi}}_{mm}=\\bar{\\bar{\\chi}}_{me}=\\bar{\\bar{0}}$）。张量 $\\bar{\\bar{\\chi}}_{em}$ 是一个作用于切向场分量的 $2 \\times 2$ 复值矩阵。\n\n您可以从 $z0$ 处用任意入射角和偏振的时谐平面波照射该超构表面，并且可以测量紧邻该表面上方 ($z=0^{+}$) 和下方 ($z=0^{-}$) 的复数值切向电磁场。定义切向场的跳变矢量和平均矢量为\n$$\n\\Delta \\mathbf{H}_{t} \\triangleq \\mathbf{H}_{t}(0^{+}) - \\mathbf{H}_{t}(0^{-}), \\qquad \\mathbf{H}_{\\text{avg},t} \\triangleq \\frac{\\mathbf{H}_{t}(0^{+}) + \\mathbf{H}_{t}(0^{-})}{2},\n$$\n切向电场也采用类似的定义。令单位法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$。\n\n从麦克斯韦方程组和标准电磁边界关系出发，将GSTCs特殊化到这种仅有磁电效应的超构表面上，并推导 $\\Delta \\mathbf{H}_{t}$、$\\mathbf{H}_{\\text{avg},t}$ 和 $\\bar{\\bar{\\chi}}_{em}$ 之间的线性关系。利用此关系建立一个反演问题，用于从平面波入射中反演出 $\\bar{\\bar{\\chi}}_{em}$ 的所有四个复数值元素。将每个不同的偏振态视为一次“激励”，每个不同的入射方向（角度和侧面）视为一次“入射”。您可以假设所有测量量（包括复数相位）都是无误差地已知的。\n\n确定唯一地反演出各向异性、可能非互易的超构表面的完整 $\\bar{\\bar{\\chi}}_{em}$ 所需的最少入射次数和最少偏振激励次数，并严格推导所选激励需满足的、保证唯一解的可辨识性条件。将您的最终数值答案表示为一个行矩阵 $\\begin{pmatrix}N_{\\text{illum}}  N_{\\text{pol}}\\end{pmatrix}$，其中 $N_{\\text{illum}}$ 是最少入射次数，$N_{\\text{pol}}$ 是最少偏振激励次数。最终数值答案无需四舍五入，也无需单位。",
            "solution": "该问题要求计算唯一确定一个零厚度平面超构表面的切向磁电极化率张量 $\\bar{\\bar{\\chi}}_{em}$ 的四个复数值元素所需的最少平面波入射次数和偏振激励次数。\n\n首先，我们通过将广义边界条件 (GSTCs) 特殊化来建立相关的边界条件。GSTCs 将跨越一个表面的切向场不连续性与在该表面上感应出的等效面极化密度 ($\\mathbf{P}_s$) 和等效面磁化密度 ($\\mathbf{M}_s$) 联系起来。这些密度又与平均切向场相关。从麦克斯韦方程组的积分形式推导出的边界条件为：\n$$\n\\hat{\\mathbf{n}} \\times (\\mathbf{E}(0^+) - \\mathbf{E}(0^-)) = -\\mathbf{J}_m\n$$\n$$\n\\hat{\\mathbf{n}} \\times (\\mathbf{H}(0^+) - \\mathbf{H}(0^-)) = \\mathbf{J}_e\n$$\n其中 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$ 是 $z=0$ 处表面的单位法向量，$\\mathbf{J}_e$ 和 $\\mathbf{J}_m$ 分别是等效面电流密度和等效面磁流密度。场跳变定义为 $\\Delta \\mathbf{F} \\triangleq \\mathbf{F}(0^+) - \\mathbf{F}(0^-)$。对于时谐场 $\\exp(j \\omega t)$，面电流与面极化和磁化密度相关，关系为 $\\mathbf{J}_e = j\\omega \\mathbf{P}_s$ 和 $\\mathbf{J}_m = j\\omega \\mathbf{M}_s$。\n\n面密度通过本构关系与平均切向场 $\\mathbf{E}_{\\text{avg},t} \\triangleq (\\mathbf{E}_t(0^+) + \\mathbf{E}_t(0^-))/2$ 和 $\\mathbf{H}_{\\text{avg},t} \\triangleq (\\mathbf{H}_t(0^+) + \\mathbf{H}_t(0^-))/2$ 相关联，其关系通过极化率张量给出：\n$$\n\\mathbf{P}_s = \\epsilon_0 \\left( \\bar{\\bar{\\chi}}_{ee} \\cdot \\mathbf{E}_{\\text{avg},t} + \\bar{\\bar{\\chi}}_{em} \\cdot \\mathbf{H}_{\\text{avg},t} \\right)\n$$\n$$\n\\mathbf{M}_s = \\mu_0 \\left( \\bar{\\bar{\\chi}}_{me} \\cdot \\mathbf{E}_{\\text{avg},t} + \\bar{\\bar{\\chi}}_{mm} \\cdot \\mathbf{H}_{\\text{avg},t} \\right)\n$$\n问题陈述只有切向磁电极化率 $\\bar{\\bar{\\chi}}_{em}$ 非零，即 $\\bar{\\bar{\\chi}}_{ee} = \\bar{\\bar{\\chi}}_{mm} = \\bar{\\bar{\\chi}}_{me} = \\bar{\\bar{0}}$。将这些代入本构关系中得到：\n$$\n\\mathbf{P}_s = \\epsilon_0 \\bar{\\bar{\\chi}}_{em} \\cdot \\mathbf{H}_{\\text{avg},t} \\implies \\mathbf{J}_e = j\\omega\\epsilon_0 \\bar{\\bar{\\chi}}_{em} \\cdot \\mathbf{H}_{\\text{avg},t}\n$$\n$$\n\\mathbf{M}_s = \\bar{\\bar{0}} \\implies \\mathbf{J}_m = \\bar{\\bar{0}}\n$$\n将这些特殊化的电流代入边界条件得到：\n1. 对于电场：$\\hat{\\mathbf{z}} \\times \\Delta \\mathbf{E}_t = -\\mathbf{J}_m = \\mathbf{0}$。由于 $\\Delta \\mathbf{E}_t$ 是一个切向矢量，这意味着 $\\Delta \\mathbf{E}_t = \\mathbf{0}$。切向电场在超构表面两侧是连续的。\n2. 对于磁场：$\\hat{\\mathbf{z}} \\times \\Delta \\mathbf{H}_t = \\mathbf{J}_e$。代入 $\\mathbf{J}_e$ 的表达式，我们得到：\n$$\n\\hat{\\mathbf{z}} \\times \\Delta \\mathbf{H}_t = j\\omega\\epsilon_0 \\bar{\\bar{\\chi}}_{em} \\cdot \\mathbf{H}_{\\text{avg},t}\n$$\n这个矢量方程表示了可测量的量 $\\Delta \\mathbf{H}_t$ 和 $\\mathbf{H}_{\\text{avg},t}$ 与未知张量 $\\bar{\\bar{\\chi}}_{em}$ 之间所需的线性关系。\n\n为了建立反演问题，我们将此关系表示为矩阵形式。设切向矢量在 $(\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}})$ 基中由 $2 \\times 1$ 的列向量表示。\n$\\Delta \\mathbf{H}_t = \\Delta H_x \\hat{\\mathbf{x}} + \\Delta H_y \\hat{\\mathbf{y}}$。\n与 $\\hat{\\mathbf{z}}$ 的叉积是 $\\hat{\\mathbf{z}} \\times \\Delta \\mathbf{H}_t = \\Delta H_y \\hat{\\mathbf{x}} - \\Delta H_x \\hat{\\mathbf{y}}$。\n设未知的 $2 \\times 2$ 复值张量为 $\\bar{\\bar{\\chi}}_{em} = \\begin{pmatrix} \\chi_{xx}  \\chi_{xy} \\\\ \\chi_{yx}  \\chi_{yy} \\end{pmatrix}$。\n矢量方程变为：\n$$\n\\begin{pmatrix} \\Delta H_y \\\\ -\\Delta H_x \\end{pmatrix} = j\\omega\\epsilon_0 \\begin{pmatrix} \\chi_{xx}  \\chi_{xy} \\\\ \\chi_{yx}  \\chi_{yy} \\end{pmatrix} \\begin{pmatrix} H_{\\text{avg},x} \\\\ H_{\\text{avg},y} \\end{pmatrix}\n$$\n该系统为 $\\bar{\\bar{\\chi}}_{em}$ 的四个复数未知数提供了两个复线性方程。\n$$\n\\Delta H_y = j\\omega\\epsilon_0 (\\chi_{xx} H_{\\text{avg},x} + \\chi_{xy} H_{\\text{avg},y})\n$$\n$$\n-\\Delta H_x = j\\omega\\epsilon_0 (\\chi_{yx} H_{\\text{avg},x} + \\chi_{yy} H_{\\text{avg},y})\n$$\n该系统解耦为两个独立的问题：一个用于 $\\bar{\\bar{\\chi}}_{em}$ 的第一行 $(\\chi_{xx}, \\chi_{xy})$，另一个用于第二行 $(\\chi_{yx}, \\chi_{yy})$。我们来分析第一个问题：\n$$\n\\frac{\\Delta H_y}{j\\omega\\epsilon_0} = \\chi_{xx} H_{\\text{avg},x} + \\chi_{xy} H_{\\text{avg},y}\n$$\n这是一个含两个未知数的线性方程。为了求解 $\\chi_{xx}$ 和 $\\chi_{xy}$，我们需要第二个线性无关的方程。这需要进行第二次测量，用上标 $(2)$ 表示，该测量从不同的激励中获得。\n$$\nH_{\\text{avg},x}^{(1)} \\chi_{xx} + H_{\\text{avg},y}^{(1)} \\chi_{xy} = \\frac{\\Delta H_y^{(1)}}{j\\omega\\epsilon_0}\n$$\n$$\nH_{\\text{avg},x}^{(2)} \\chi_{xx} + H_{\\text{avg},y}^{(2)} \\chi_{xy} = \\frac{\\Delta H_y^{(2)}}{j\\omega\\epsilon_0}\n$$\n这个系统可以写成矩阵形式：\n$$\n\\begin{pmatrix} H_{\\text{avg},x}^{(1)}  H_{\\text{avg},y}^{(1)} \\\\ H_{\\text{avg},x}^{(2)}  H_{\\text{avg},y}^{(2)} \\end{pmatrix} \\begin{pmatrix} \\chi_{xx} \\\\ \\chi_{xy} \\end{pmatrix} = \\frac{1}{j\\omega\\epsilon_0} \\begin{pmatrix} \\Delta H_y^{(1)} \\\\ \\Delta H_y^{(2)} \\end{pmatrix}\n$$\n当且仅当系数矩阵可逆时，$(\\chi_{xx}, \\chi_{xy})$ 存在唯一解。这要求其行列式非零：$H_{\\text{avg},x}^{(1)} H_{\\text{avg},y}^{(2)} - H_{\\text{avg},y}^{(1)} H_{\\text{avg},x}^{(2)} \\neq 0$。这个条件意味着两个切向矢量 $\\mathbf{H}_{\\text{avg},t}^{(1)}$ 和 $\\mathbf{H}_{\\text{avg},t}^{(2)}$ 是线性无关的。在相同条件下，同样的两次测量也将允许从第二个解耦的系统中唯一地确定 $(\\chi_{yx}, \\chi_{yy})$。\n因此，反演完整张量 $\\bar{\\bar{\\chi}}_{em}$ 的可辨识性条件是，我们必须执行至少两次测量，以产生两个线性无关的平均切向磁场矢量。\n\n现在我们将 $\\mathbf{H}_{\\text{avg},t}$ 与入射平面波联系起来。对于从 $z0$ 入射的平面波，在 $z=0^-$ 处的总切向场是入射 (i) 和反射 (r) 分量的和，$\\mathbf{H}_t(0^-) = \\mathbf{H}_{i,t} + \\mathbf{H}_{r,t}$。在 $z=0^+$ 处，场是透射 (t) 分量，$\\mathbf{H}_t(0^+) = \\mathbf{H}_{t,t}$。波导纳张量 $\\overleftrightarrow{Y}$ 关联了切向磁场和电场，$\\mathbf{H}_t = \\overleftrightarrow{Y} \\cdot \\mathbf{E}_t$。对于沿 $+z$ 方向传播的波，$\\mathbf{H}_t = \\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_t$；对于沿 $-z$ 方向传播的波，$\\mathbf{H}_t = -\\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_t$。\n因此，我们有 $\\mathbf{H}_{i,t} = \\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{i,t}$，$\\mathbf{H}_{r,t} = -\\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{r,t}$，以及 $\\mathbf{H}_{t,t} = \\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{t,t}$。\n平均切向磁场为：\n$$\n\\mathbf{H}_{\\text{avg},t} = \\frac{1}{2}\\left(\\mathbf{H}_t(0^+) + \\mathbf{H}_t(0^-)\\right) = \\frac{1}{2}\\left(\\mathbf{H}_{t,t} + \\mathbf{H}_{i,t} + \\mathbf{H}_{r,t}\\right)\n$$\n使用导纳关系：\n$$\n\\mathbf{H}_{\\text{avg},t} = \\frac{1}{2}\\left(\\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{t,t} + \\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{i,t} - \\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{r,t}\\right) = \\frac{1}{2} \\overleftrightarrow{Y}_i \\cdot (\\mathbf{E}_{t,t} + \\mathbf{E}_{i,t} - \\mathbf{E}_{r,t})\n$$\n切向电场的连续性，$\\Delta \\mathbf{E}_t = \\mathbf{0}$，意味着 $\\mathbf{E}_t(0^+) = \\mathbf{E}_t(0^-)$，这表明 $\\mathbf{E}_{t,t} = \\mathbf{E}_{i,t} + \\mathbf{E}_{r,t}$。将 $\\mathbf{E}_{r,t} = \\mathbf{E}_{t,t} - \\mathbf{E}_{i,t}$ 代入 $\\mathbf{H}_{\\text{avg},t}$ 的表达式中：\n$$\n\\mathbf{H}_{\\text{avg},t} = \\frac{1}{2} \\overleftrightarrow{Y}_i \\cdot (\\mathbf{E}_{t,t} + \\mathbf{E}_{i,t} - (\\mathbf{E}_{t,t} - \\mathbf{E}_{i,t})) = \\frac{1}{2} \\overleftrightarrow{Y}_i \\cdot (2\\mathbf{E}_{i,t}) = \\overleftrightarrow{Y}_i \\cdot \\mathbf{E}_{i,t} = \\mathbf{H}_{i,t}\n$$\n这个关键结果表明，平均切向磁场等于入射切向磁场。因此，可辨识性条件简化为：要反演 $\\bar{\\bar{\\chi}}_{em}$，我们必须用两种激励照射超构表面，这两种激励产生两个线性无关的入射切向磁场矢量 $\\mathbf{H}_{i,t}^{(1)}$ 和 $\\mathbf{H}_{i,t}^{(2)}$。\n\n单次入射由一个固定的入射波矢 $\\mathbf{k}_i$ 定义。对于任何这样的入射（无论是正入射还是斜入射），我们可以选择两个正交的偏振态。例如，对于在 $xz$-平面内的斜入射，可以使用TE偏振波（s-偏振, $\\mathbf{E}_i \\propto \\hat{\\mathbf{y}}$）和TM偏振波（p-偏振, $\\mathbf{H}_i \\propto \\hat{\\mathbf{y}}$）。\n- 对于TE情况，$\\mathbf{H}_{i,t}$ 将有沿 $\\hat{\\mathbf{x}}$ 的分量。\n- 对于TM情况，$\\mathbf{H}_{i,t}$ 将沿 $\\hat{\\mathbf{y}}$ 方向。\n这两个矢量 $\\mathbf{H}_{i,t}^{(TE)}$ 和 $\\mathbf{H}_{i,t}^{(TM)}$ 是正交的，因此是线性无关的。对于使用两种正交线偏振（例如，x偏振和y偏振）的正入射，同样的结论也成立。因此，所需的两次测量可以通过使用单一入射方向和两种不同的偏振激励来实现。\n\n因此，最少的入射次数为 $N_{\\text{illum}} = 1$。\n该次入射所需的最少偏振激励次数为 $N_{\\text{pol}} = 2$。\n这构成了总共两次测量的最小集合。\n\n最终的可辨识性条件是，所选的激励集合必须产生一组入射切向磁场矢量 $\\{\\mathbf{H}_{i,t}^{(k)}\\}$，它们能张成二维切向平面。对于两次激励的最小情况，这意味着矢量 $\\mathbf{H}_{i,t}^{(1)}$ 和 $\\mathbf{H}_{i,t}^{(2)}$ 必须是线性无关的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了如何表征超构表面后，下一步便是设计它以实现特定的波控功能。本练习将探讨一个典型应用：波束偏转。你将运用GSTCs分析一个相位梯度超构表面，不仅推导其材料属性与出射波角度之间的关系，更重要的是，评估该器件对制造误差的敏感性，这对于理解超构表面设计的实用性和鲁棒性至关重要。",
            "id": "3311086",
            "problem": "考虑一个位于自由空间中 $z=0$ 平面上的单各向异性、空间变化的惠更斯超表面，其设计用于偏转一个垂直入射的横电磁平面波。该超表面的特征由切向电表面极化率张量 $\\boldsymbol{\\chi}_{ee}(x)$ 和磁表面磁化率张量 $\\boldsymbol{\\chi}_{mm}(x)$ 描述，且没有磁电耦合。入射波沿 $+\\hat{z}$ 方向传播，其电场沿 $\\hat{x}$ 方向极化，磁场沿 $\\hat{y}$ 方向极化。假设采用 $\\exp(j \\omega t)$ 形式的时谐场，自由空间波数为 $k_{0} = \\omega \\sqrt{\\mu_{0} \\varepsilon_{0}}$，自由空间阻抗为 $\\eta_{0} = \\sqrt{\\mu_{0}/\\varepsilon_{0}}$。\n\n从麦克斯韦方程组和广义片层过渡条件 (GSTCs) 出发，推导空间均匀片层的透射系数。然后，在标准的缓变近似（局部均匀超表面）下使用该局部均匀片层结果，并引用具有相位不连续性的切向波矢守恒，得到联系局部透射相位梯度与透射角 $\\theta_{t}$ 的广义折射关系。假设通过与入射场对齐的切向响应的局域平衡来实现无反射设计，即 $\\chi_{ee}^{xx}(x) = \\chi_{mm}^{yy}(x) \\equiv \\chi(x)$，且所有其他张量元为零。\n\n通过在平衡设计点评估的、透射角对于与极化方向对齐和不对齐的极化率张量元的雅可比矩阵，来定义波束偏转对制造误差的灵敏度。计算雅可比矩阵的各个元素\n- $\\partial \\theta_{t}/\\partial \\chi_{ee}^{xx}$,\n- $\\partial \\theta_{t}/\\partial \\chi_{mm}^{yy}$,\n- $\\partial \\theta_{t}/\\partial \\chi_{ee}^{yy}$,\n- $\\partial \\theta_{t}/\\partial \\chi_{mm}^{xx}$,\n以 $k_{0}$、局部极化率 $\\chi(x)$ 及其空间导数 $\\partial \\chi/\\partial x$ 的解析表达式表示。将 $\\chi$ 视为具有长度物理单位的标量函数，并假设梯度足够小以排除多级衍射。仅使用符号变量将最终的雅可比矩阵表示为单个行向量。角度 $\\theta_{t}$ 必须以弧度表示。不需要进行数值四舍五入。",
            "solution": "该问题要求对惠更斯超表面的行为进行多步推导。我们从基本方程开始。\n\n位于 $z=0$ 平面的超表面的行为由广义片层过渡条件 (GSTCs) 描述。对于一个没有磁电耦合的单各向异性片层，这些条件是：\n$$\n\\hat{z} \\times (\\mathbf{E}_{z=0^+} - \\mathbf{E}_{z=0^-}) = -j\\omega \\mu_0 \\boldsymbol{\\chi}_{mm} \\cdot \\mathbf{H}_{\\text{avg}}\n$$\n$$\n\\hat{z} \\times (\\mathbf{H}_{z=0^+} - \\mathbf{H}_{z=0^-}) = j\\omega \\varepsilon_0 \\boldsymbol{\\chi}_{ee} \\cdot \\mathbf{E}_{\\text{avg}}\n$$\n其中 $\\mathbf{E}_{\\text{avg}} = \\frac{1}{2}(\\mathbf{E}_{z=0^+} + \\mathbf{E}_{z=0^-})$ 和 $\\mathbf{H}_{\\text{avg}} = \\frac{1}{2}(\\mathbf{H}_{z=0^+} + \\mathbf{H}_{z=0^-})$ 是跨越片层的平均场。\n\n入射波是一个垂直入射的横电磁（TEM）平面波：\n$$\n\\mathbf{E}_i = E_0 \\hat{x} \\exp(-jk_0 z) \\quad, \\quad \\mathbf{H}_i = \\frac{E_0}{\\eta_0} \\hat{y} \\exp(-jk_0 z)\n$$\n在区域 $z0$ 的总场是入射波和反射波之和，而在 $z > 0$ 的场是透射波。对于一个在垂直入射下的空间均匀片层，反射波和透射波也将是极化方向与极化率张量主轴对齐的 TEM 波。\n$$\n\\mathbf{E}_r = R E_0 \\hat{x} \\exp(jk_0 z) \\quad, \\quad \\mathbf{H}_r = -R \\frac{E_0}{\\eta_0} \\hat{y} \\exp(jk_0 z)\n$$\n$$\n\\mathbf{E}_t = T E_0 \\hat{x} \\exp(-jk_0 z) \\quad, \\quad \\mathbf{H}_t = T \\frac{E_0}{\\eta_0} \\hat{y} \\exp(-jk_0 z)\n$$\n在界面 $z=0$ 处：\n$\\mathbf{E}_{z=0^-} = (1+R)E_0\\hat{x}$, $\\mathbf{H}_{z=0^-} = (1-R)\\frac{E_0}{\\eta_0}\\hat{y}$\n$\\mathbf{E}_{z=0^+} = T E_0\\hat{x}$, $\\mathbf{H}_{z=0^+} = T \\frac{E_0}{\\eta_0}\\hat{y}$\n\n在 $z=0$ 处的平均场是：\n$$\n\\mathbf{E}_{\\text{avg}} = \\frac{1}{2}(T+1+R)E_0\\hat{x}\n$$\n$$\n\\mathbf{H}_{\\text{avg}} = \\frac{1}{2}(T+1-R)\\frac{E_0}{\\eta_0}\\hat{y}\n$$\n将这些代入 GSTCs，我们得到一个关于反射系数 $R$ 和透射系数 $T$ 的两个线性方程组。\n在问题指定的无反射条件 $R=0$ 和 $\\chi_{ee}^{xx}(x) = \\chi_{mm}^{yy}(x) \\equiv \\chi(x)$ 下，尽管这些条件与基于平均场的GSTC框架存在内在矛盾，但为了解决该问题，我们采用文献中常用于理想惠更斯超表面的有效透射系数：\n$$\nT = \\frac{1-j\\frac{k_0\\chi}{2}}{1+j\\frac{k_0\\chi}{2}}\n$$\n这是一个纯相位项。透射相位 $\\phi_t$ 是其辐角：\n$$\n\\phi_t(x) = \\arg(T(x)) = -2 \\arctan\\left(\\frac{k_0 \\chi(x)}{2}\\right)\n$$\n在缓变近似下，这种局部相位响应决定了透射波的弯曲。对于垂直入射，切向波矢守恒（广义斯涅尔定律）为：\n$$\nk_0 \\sin(\\theta_t) = \\frac{d\\phi_t}{dx}\n$$\n其中 $\\theta_t$ 是透射角。这将角度与相位梯度联系起来。\n\n为了计算雅可比矩阵，我们必须找到在平衡设计点附近，$\\theta_t$ 对极化率张量元微扰的灵敏度。我们有 $\\theta_t = \\arcsin\\left(\\frac{1}{k_0}\\frac{d\\phi_t}{dx}\\right)$。相位 $\\phi_t$ 是局部极化率值的函数。\n$$\n\\frac{\\partial \\theta_t}{\\partial \\chi_{ee}^{xx}} = \\frac{\\partial}{\\partial \\chi_{ee}^{xx}} \\left[ \\arcsin\\left(\\frac{1}{k_0}\\frac{d\\phi_t}{dx}\\right) \\right] = \\frac{1}{\\sqrt{1-\\sin^2\\theta_t}} \\frac{1}{k_0} \\frac{\\partial}{\\partial \\chi_{ee}^{xx}}\\left(\\frac{d\\phi_t}{dx}\\right)\n$$\n假设可以交换导数的顺序：\n$$\n\\frac{\\partial \\theta_t}{\\partial \\chi_{ee}^{xx}} = \\frac{1}{k_0 \\cos\\theta_t} \\frac{d}{dx}\\left(\\frac{\\partial \\phi_t}{\\partial \\chi_{ee}^{xx}}\\right)\n$$\n为了计算偏导数，我们需要一个更通用的透射相位表达式。在 $R=0$ 的近似下，透射相位主要由电纳和磁纳之和决定。一个更通用的表达式为 $\\phi_t \\approx \\arctan\\left(\\frac{-k_0(\\chi_{ee}^{xx}+\\chi_{mm}^{yy})}{2}\\right)$。在平衡点 $\\chi_{ee}^{xx}=\\chi_{mm}^{yy}=\\chi(x)$ 附近，我们可以得到 $\\phi_t$ 对每个分量的依赖关系。\n然而，遵循问题中使用的模型，$\\phi_t$ 仅依赖于 $\\chi_{ee}^{xx}$ 和 $\\chi_{mm}^{yy}$ 的组合 $\\chi$。\n$\\frac{\\partial \\phi_t}{\\partial \\chi_{ee}^{xx}}\\bigg|_{\\text{bal}}$ 和 $\\frac{\\partial \\phi_t}{\\partial \\chi_{mm}^{yy}}\\bigg|_{\\text{bal}}$ 都可以通过对 $\\phi_t(\\chi)$ 关于 $\\chi$ 求导，然后乘以 $\\partial\\chi/\\partial\\chi_{ee}^{xx}=1$ 来近似。\n$$\n\\frac{\\partial \\phi_t}{\\partial \\chi} = -2 \\frac{\\partial}{\\partial \\chi} \\arctan\\left(\\frac{k_0 \\chi}{2}\\right) = -2 \\frac{k_0/2}{1+(k_0\\chi/2)^2} = \\frac{-2k_0}{4+k_0^2\\chi^2}\n$$\n因此，在平衡点处：\n$$\n\\frac{\\partial \\phi_t}{\\partial \\chi_{ee}^{xx}}\\bigg|_{\\text{bal}} \\approx \\frac{\\partial \\phi_t}{\\partial \\chi_{mm}^{yy}}\\bigg|_{\\text{bal}} \\approx \\frac{-2k_0}{4+k_0^2\\chi^2}\n$$\n现在，我们取空间导数：\n$$\n\\frac{d}{dx}\\left(\\frac{\\partial \\phi_t}{\\partial \\chi_{ee}^{xx}}\\right) = \\frac{d}{dx}\\left(\\frac{-2k_0}{4+k_0^2\\chi(x)^2}\\right) = -2k_0 (-1) (4+k_0^2\\chi^2)^{-2} (2k_0^2\\chi) \\frac{\\partial\\chi}{\\partial x} = \\frac{4k_0^3 \\chi \\frac{\\partial\\chi}{\\partial x}}{(4+k_0^2\\chi^2)^2}\n$$\n前因子需要 $\\cos\\theta_t$。在平衡点：\n$\\frac{d\\phi_t}{dx} = \\frac{d}{dx}\\left(-2\\arctan\\left(\\frac{k_0\\chi}{2}\\right)\\right) = \\frac{-4k_0\\frac{\\partial\\chi}{\\partial x}}{4+k_0^2\\chi^2}$。\n$\\sin\\theta_t = \\frac{1}{k_0}\\frac{d\\phi_t}{dx} = \\frac{-4\\frac{\\partial\\chi}{\\partial x}}{4+k_0^2\\chi^2}$。\n$\\cos\\theta_t = \\sqrt{1-\\sin^2\\theta_t} = \\frac{\\sqrt{(4+k_0^2\\chi^2)^2 - 16\\left(\\frac{\\partial\\chi}{\\partial x}\\right)^2}}{4+k_0^2\\chi^2}$。\n组合导数 $\\partial \\theta_t / \\partial \\chi_{ee}^{xx}$：\n$$\n\\frac{\\partial \\theta_t}{\\partial \\chi_{ee}^{xx}} = \\frac{1}{k_0} \\frac{4+k_0^2\\chi^2}{\\sqrt{(4+k_0^2\\chi^2)^2 - 16(\\frac{\\partial\\chi}{\\partial x})^2}} \\frac{4k_0^3 \\chi \\frac{\\partial\\chi}{\\partial x}}{(4+k_0^2\\chi^2)^2} = \\frac{4k_0^2 \\chi \\frac{\\partial\\chi}{\\partial x}}{(4+k_0^2\\chi^2)\\sqrt{(4+k_0^2\\chi^2)^2 - 16(\\frac{\\partial\\chi}{\\partial x})^2}}\n$$\n$\\partial \\theta_t / \\partial \\chi_{mm}^{yy}$ 的结果是相同的。\n\n对于非对齐分量 $\\chi_{ee}^{yy}$ 和 $\\chi_{mm}^{xx}$，我们分析它们的影响。入射电场纯粹在 $\\hat{x}$ 方向，磁场在 $\\hat{y}$ 方向。对于对角极化率张量（设计点的情况），场的 $y$ 分量不会被激发。表面电流的 $xx$ 分量取决于 $E_x$ 和 $\\chi_{ee}^{xx}$，而表面磁流的 $yy$ 分量取决于 $H_y$ 和 $\\chi_{mm}^{yy}$。分量 $\\chi_{ee}^{yy}$ 和 $\\chi_{mm}^{xx}$ 分别只与 $E_y$ 和 $H_x$ 耦合，而对于入射波，这些分量为零，并且在平衡设计点也保持为零。因此，对于 $\\hat{x}$ 极化波的透射系数 $T$ 与 $\\chi_{ee}^{yy}$ 和 $\\chi_{mm}^{xx}$ 无关。\n$$\n\\frac{\\partial \\phi_t}{\\partial \\chi_{ee}^{yy}} = 0 \\quad \\text{和} \\quad \\frac{\\partial \\phi_t}{\\partial \\chi_{mm}^{xx}} = 0\n$$\n因此，它们对雅可比矩阵的贡献为零。\n$$\n\\frac{\\partial \\theta_t}{\\partial \\chi_{ee}^{yy}} = 0 \\quad, \\quad \\frac{\\partial \\theta_t}{\\partial \\chi_{mm}^{xx}} = 0\n$$\n雅可比矩阵是由这四个偏导数组成的行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4k_{0}^{2} \\chi(x) \\frac{\\partial \\chi}{\\partial x}}{\\left(4+k_{0}^{2}\\chi(x)^{2}\\right)\\sqrt{\\left(4+k_{0}^{2}\\chi(x)^{2}\\right)^{2} - 16\\left(\\frac{\\partial \\chi}{\\partial x}\\right)^{2}}}  \\frac{4k_{0}^{2} \\chi(x) \\frac{\\partial \\chi}{\\partial x}}{\\left(4+k_{0}^{2}\\chi(x)^{2}\\right)\\sqrt{\\left(4+k_{0}^{2}\\chi(x)^{2}\\right)^{2} - 16\\left(\\frac{\\partial \\chi}{\\partial x}\\right)^{2}}}  0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "解析模型虽然强大，但面对复杂结构或动态效应时，全波数值模拟便不可或缺。本动手编程练习将带你深入超构表面的时域建模，并聚焦于一个核心挑战：当材料具有增益（即有源）时，如何保证数值模拟的稳定性。通过比较显式和隐式时间步进方案，你将洞悉超构表面的物理特性（如增益）如何直接影响数值算法的选择与成败。",
            "id": "3311070",
            "problem": "考虑一个一维时域有限差分 (FDTD) 更新，该更新位于一个由广义薄层传输条件 (GSTCs) 描述的零厚度超表面上。该超表面被建模为一个电性薄层，其极化由单共振洛伦兹振子模型描述。在傅里叶约定下工作，时间依赖性为 $e^{-j\\omega t}$，因此无源性对应于非负阻尼，而有源性（增益）对应于负阻尼。电磁和材料动力学由以下基本关系控制：\n- 微分形式的麦克斯韦-安培定律：$\\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$，其中 $\\epsilon_0$ 是真空介电常数，单位为 $\\mathrm{F/m}$。\n- 纯电性薄层的广义薄层传输条件 (GSTCs)：$\\Delta \\mathbf{H}_t = \\frac{\\partial \\mathbf{P}_s}{\\partial t}$，其中 $\\Delta \\mathbf{H}_t$ 是穿过薄层的切向磁场跳变，$\\mathbf{P}_s$ 是表面极化密度。\n- 薄层极化的洛伦兹振子模型：$\\frac{\\partial^2 \\mathbf{P}_s}{\\partial t^2} + \\Gamma \\frac{\\partial \\mathbf{P}_s}{\\partial t} + \\omega_0^2 \\mathbf{P}_s = \\epsilon_0 F \\mathbf{E}_{\\mathrm{av}}$，其中共振角频率 $\\omega_0$ 单位为 $\\mathrm{s}^{-1}$，阻尼率 $\\Gamma$ 单位为 $\\mathrm{s}^{-1}$，振子强度 $F$ 单位为 $\\mathrm{s}^{-2}$，由薄层上的平均切向电场 $\\mathbf{E}_{\\mathrm{av}}$ 驱动。\n\n假设薄层近邻区域存在一个局部均匀化辐射模型，该模型通过对薄层场的线性辐射阻尼来近似离散的旋度项。具体来说，定义一个标量辐射率 $\\beta$ (单位为 $\\mathrm{s}^{-1}$)，使得薄层上的局部安培更新可以写为 $\\epsilon_0 \\frac{\\partial E}{\\partial t} = -\\epsilon_0 \\beta E - \\frac{\\partial P}{\\partial t}$，其中 $E$ 是薄层上的切向电场，$P$ 是标量表面极化。该闭合模型对与网格的能量交换进行建模，是分析薄层耦合更新的局部稳定性的标准均匀化近似。\n\n定义状态变量 $E(t)$、$P(t)$ 和 $V(t) \\equiv \\frac{\\partial P}{\\partial t}(t)$，并写出耦合一阶系统：\n$$\n\\epsilon_0 \\frac{\\partial E}{\\partial t} = -\\epsilon_0 \\beta E - V, \\quad\n\\frac{\\partial P}{\\partial t} = V, \\quad\n\\frac{\\partial V}{\\partial t} = -\\Gamma V - \\omega_0^2 P + \\epsilon_0 F E.\n$$\n\n任务：\n1. 从上述基本关系出发，推导时间步长为 $\\Delta t$ (单位为秒) 的显式前向欧拉离散化：\n$$\nE^{n+1} = E^n + \\Delta t\\left( -\\beta E^n - \\frac{1}{\\epsilon_0} V^n \\right), \\quad\nP^{n+1} = P^n + \\Delta t \\, V^n, \\quad\nV^{n+1} = V^n + \\Delta t\\left( -\\Gamma V^n - \\omega_0^2 P^n + \\epsilon_0 F E^n \\right),\n$$\n并将其写成一个线性放大 $3 \\times 3$ 矩阵 $M_{\\text{exp}}$ 的形式，使得 $\\begin{bmatrix} E^{n+1} \\\\ P^{n+1} \\\\ V^{n+1} \\end{bmatrix} = M_{\\text{exp}} \\begin{bmatrix} E^n \\\\ P^n \\\\ V^n \\end{bmatrix}$。\n\n2. 推导全隐式后向欧拉离散化：\n$$\nE^{n+1} = E^n + \\Delta t\\left( -\\beta E^{n+1} - \\frac{1}{\\epsilon_0} V^{n+1} \\right), \\quad\nP^{n+1} = P^n + \\Delta t \\, V^{n+1}, \\quad\nV^{n+1} = V^n + \\Delta t\\left( -\\Gamma V^{n+1} - \\omega_0^2 P^{n+1} + \\epsilon_0 F E^{n+1} \\right),\n$$\n并将其写成一个线性系统 $A \\begin{bmatrix} E^{n+1} \\\\ P^{n+1} \\\\ V^{n+1} \\end{bmatrix} = \\begin{bmatrix} E^n \\\\ P^n \\\\ V^n \\end{bmatrix}$ 的形式，其中 $A$ 是一个 $3 \\times 3$ 矩阵，然后定义放大矩阵 $M_{\\text{imp}} \\equiv A^{-1}$。\n\n3. 在频域中，使用洛伦兹模型证明薄层的电极化率为\n$$\n\\chi(\\omega) = \\frac{F}{\\omega_0^2 - \\omega^2 - j \\Gamma \\omega},\n$$\n并证明 $\\operatorname{Im}\\{\\chi(\\omega)\\}$ 与 $\\Gamma$ 的符号相同。得出结论，在所选的傅里叶约定下，$\\operatorname{Im}\\{\\chi(\\omega)\\}  0$ 对应于 $\\Gamma  0$（增益）。\n\n4. 将时间步进格式的数值稳定性定义为放大矩阵 $M$ 的谱半径 $\\rho(M)$ 满足 $\\rho(M) \\leq 1$，其中 $\\rho(M)$ 是 $M$ 的特征值的最大模。对于显式前向欧拉更新，通过计算 $\\rho(M_{\\text{exp}})$ 并解释不等式 $\\rho(M_{\\text{exp}}) \\leq 1$，推导用参数 $(\\epsilon_0, \\beta, \\Gamma, \\omega_0, F, \\Delta t)$ 表示的稳定性条件。强调增益（$\\Gamma  0$ 从而 $\\operatorname{Im}\\{\\chi\\}  0$）的存在如何能使 $\\rho(M_{\\text{exp}}) > 1$（无论 $\\Delta t$ 如何），除非存在足够大的辐射率 $\\beta$。对于隐式后向欧拉更新，计算 $\\rho(M_{\\text{imp}})$ 并解释当辐射 $\\beta$ 占主导时，薄层极化与场之间的隐式耦合如何在更宽的 $\\Delta t$ 和增益值范围内恢复数值稳定性（即强制 $\\rho(M_{\\text{imp}}) \\leq 1$），否则在连续系统不稳定时忠实地再现物理增长。\n\n5. 实现一个程序，对于给定的测试角频率 $\\omega_{\\text{test}}$（单位为弧度/秒），评估 $\\operatorname{Im}\\{\\chi(\\omega_{\\text{test}})\\}$ 的符号，并计算 $M_{\\text{exp}}$ 和 $M_{\\text{imp}}$ 的谱半径，以返回指示每种格式数值稳定性的布尔值。将最终的布尔值表示为 Python 值。\n\n所有有量纲的参数均使用国际单位制（SI）：$\\epsilon_0$ 单位为 $\\mathrm{F/m}$，$\\omega_0$、$\\Gamma$ 和 $\\beta$ 单位为 $\\mathrm{s^{-1}}$，$F$ 单位为 $\\mathrm{s^{-2}}$，$\\Delta t$ 单位为 $\\mathrm{s}$，$\\omega_{\\text{test}}$ 单位为 $\\mathrm{rad/s}$。\n\n测试套件：\n提供以下测试用例，形式为元组 $(\\epsilon_0, \\omega_0, \\Gamma, F, \\beta, \\Delta t, \\omega_{\\text{test}})$：\n- 情况 1（无源，标称稳定）：$(8.854 \\times 10^{-12}, 1.0 \\times 10^{10}, 1.0 \\times 10^{9}, 1.0 \\times 10^{12}, 3.0 \\times 10^{9}, 5.0 \\times 10^{-12}, 2\\pi \\times 1.0 \\times 10^{10})$。\n- 情况 2（无源，大时间步长，边界行为）：$(8.854 \\times 10^{-12}, 1.0 \\times 10^{10}, 1.0 \\times 10^{9}, 1.0 \\times 10^{12}, 3.0 \\times 10^{9}, 5.0 \\times 10^{-11}, 2\\pi \\times 1.0 \\times 10^{10})$。\n- 情况 3（弱增益，辐射主导）：$(8.854 \\times 10^{-12}, 1.0 \\times 10^{10}, -5.0 \\times 10^{8}, 1.0 \\times 10^{12}, 1.0 \\times 10^{9}, 5.0 \\times 10^{-12}, 2\\pi \\times 1.0 \\times 10^{10})$。\n- 情况 4（强增益，辐射不足）：$(8.854 \\times 10^{-12}, 1.0 \\times 10^{10}, -2.0 \\times 10^{9}, 1.0 \\times 10^{12}, 5.0 \\times 10^{8}, 5.0 \\times 10^{-12}, 2\\pi \\times 1.0 \\times 10^{10})$。\n\n对于每种情况，计算并输出一个包含三个布尔值的列表：$[\\text{is\\_gain}, \\text{explicit\\_stable}, \\text{implicit\\_stable}]$，其中当且仅当 $\\operatorname{Im}\\{\\chi(\\omega_{\\text{test}})\\}  0$ 时 $\\text{is\\_gain}$ 为真，当且仅当 $\\rho(M_{\\text{exp}}) \\leq 1$ 时 $\\text{explicit\\_stable}$ 为真，当且仅当 $\\rho(M_{\\text{imp}}) \\leq 1$ 时 $\\text{implicit\\_stable}$ 为真。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有给定测试用例的结果，形式为一个逗号分隔的列表，并用方括号括起来，其中每个元素是对应一种情况的列表 $[\\text{is\\_gain}, \\text{explicit\\_stable}, \\text{implicit\\_stable}]$，顺序与上面相同。例如，输出应类似于 $[[\\text{True},\\text{False},\\text{True}],[\\dots],[\\dots],[\\dots]]$。",
            "solution": "该问题要求分析两种时间步进格式，即前向（显式）欧拉法和后向（隐式）欧拉法，并将它们应用于一个模拟洛伦兹共振超表面的常微分方程（ODEs）系统。分析内容包括推导每种格式的放大矩阵，在频域中分析物理模型，以及在各种条件下（包括存在材料增益时）评估离散化系统的数值稳定性。\n\n系统的状态由向量 $\\mathbf{x}(t) = [E(t), P(t), V(t)]^T$ 描述，其中 $E$ 是切向电场，$P$ 是表面极化密度，$V$ 是 $P$ 的时间导数。控制连续时间系统为：\n$$\n\\frac{d}{dt} \\begin{bmatrix} E \\\\ P \\\\ V \\end{bmatrix} = \\begin{bmatrix} -\\beta E - \\frac{1}{\\epsilon_0} V \\\\ V \\\\ \\epsilon_0 F E - \\omega_0^2 P - \\Gamma V \\end{bmatrix}\n= \\begin{bmatrix} -\\beta  0  -1/\\epsilon_0 \\\\ 0  0  1 \\\\ \\epsilon_0 F  -\\omega_0^2  -\\Gamma \\end{bmatrix} \\begin{bmatrix} E \\\\ P \\\\ V \\end{bmatrix}\n$$\n\n### 1. 显式前向欧拉离散化\n\n前向欧拉法将时间步 $n$ 处的导数 $\\frac{d\\mathbf{x}}{dt}$ 近似为 $\\frac{\\mathbf{x}^{n+1} - \\mathbf{x}^n}{\\Delta t}$。因此，更新规则为 $\\mathbf{x}^{n+1} = \\mathbf{x}^n + \\Delta t \\cdot J \\mathbf{x}^n = (I + \\Delta t J)\\mathbf{x}^n$，其中 $J$ 是系统的雅可比矩阵。问题给出了离散化方程：\n$$\nE^{n+1} = E^n + \\Delta t\\left( -\\beta E^n - \\frac{1}{\\epsilon_0} V^n \\right)\n$$\n$$\nP^{n+1} = P^n + \\Delta t \\, V^n\n$$\n$$\nV^{n+1} = V^n + \\Delta t\\left( -\\Gamma V^n - \\omega_0^2 P^n + \\epsilon_0 F E^n \\right)\n$$\n为了将其写成矩阵形式 $\\mathbf{x}^{n+1} = M_{\\text{exp}} \\mathbf{x}^n$，我们收集右侧项的系数：\n- 对于 $E^{n+1}$：$(1 - \\Delta t \\beta) E^n + (0) P^n + (-\\frac{\\Delta t}{\\epsilon_0}) V^n$\n- 对于 $P^{n+1}$：$(0) E^n + (1) P^n + (\\Delta t) V^n$\n- 对于 $V^{n+1}$：$(\\Delta t \\epsilon_0 F) E^n + (-\\Delta t \\omega_0^2) P^n + (1 - \\Delta t \\Gamma) V^n$\n\n将这些系数组合成一个矩阵，即可得到显式放大矩阵 $M_{\\text{exp}}$：\n$$\nM_{\\text{exp}} = \\begin{bmatrix}\n1 - \\Delta t \\beta  0  -\\frac{\\Delta t}{\\epsilon_0} \\\\\n0  1  \\Delta t \\\\\n\\Delta t \\epsilon_0 F  -\\Delta t \\omega_0^2  1 - \\Delta t \\Gamma\n\\end{bmatrix}\n$$\n\n### 2. 隐式后向欧拉离散化\n\n后向欧拉法使用时间步 $n+1$ 处的状态来近似导数：$\\frac{\\mathbf{x}^{n+1} - \\mathbf{x}^n}{\\Delta t} = J \\mathbf{x}^{n+1}$。这导出了线性系统 $(I - \\Delta t J)\\mathbf{x}^{n+1} = \\mathbf{x}^n$。问题给出了离散化方程：\n$$\nE^{n+1} = E^n + \\Delta t\\left( -\\beta E^{n+1} - \\frac{1}{\\epsilon_0} V^{n+1} \\right)\n$$\n$$\nP^{n+1} = P^n + \\Delta t \\, V^{n+1}\n$$\n$$\nV^{n+1} = V^n + \\Delta t\\left( -\\Gamma V^{n+1} - \\omega_0^2 P^{n+1} + \\epsilon_0 F E^{n+1} \\right)\n$$\n为了在线性系统 $A \\mathbf{x}^{n+1} = \\mathbf{x}^n$ 中找到矩阵 $A$，我们重新排列方程，将所有在 $n+1$ 步的项分组到左侧：\n- 对于 $E$：$E^{n+1} + \\Delta t \\beta E^{n+1} + \\frac{\\Delta t}{\\epsilon_0} V^{n+1} = E^n \\implies (1 + \\Delta t \\beta)E^{n+1} + (0)P^{n+1} + (\\frac{\\Delta t}{\\epsilon_0})V^{n+1} = E^n$\n- 对于 $P$：$P^{n+1} - \\Delta t V^{n+1} = P^n \\implies (0)E^{n+1} + (1)P^{n+1} + (-\\Delta t)V^{n+1} = P^n$\n- 对于 $V$：$V^{n+1} + \\Delta t \\Gamma V^{n+1} + \\Delta t \\omega_0^2 P^{n+1} - \\Delta t \\epsilon_0 F E^{n+1} = V^n \\implies (-\\Delta t \\epsilon_0 F)E^{n+1} + (\\Delta t \\omega_0^2)P^{n+1} + (1 + \\Delta t \\Gamma)V^{n+1} = V^n$\n\n将左侧项的系数组合起来，得到矩阵 $A$：\n$$\nA = \\begin{bmatrix}\n1 + \\Delta t \\beta  0  \\frac{\\Delta t}{\\epsilon_0} \\\\\n0  1  -\\Delta t \\\\\n-\\Delta t \\epsilon_0 F  \\Delta t \\omega_0^2  1 + \\Delta t \\Gamma\n\\end{bmatrix}\n$$\n隐式放大矩阵定义为 $M_{\\text{imp}} = A^{-1}$，因为 $\\mathbf{x}^{n+1} = A^{-1} \\mathbf{x}^n$。\n\n### 3. 薄层极化率\n\n时域中的洛伦兹振子模型为 $\\frac{\\partial^2 \\mathbf{P}_s}{\\partial t^2} + \\Gamma \\frac{\\partial \\mathbf{P}_s}{\\partial t} + \\omega_0^2 \\mathbf{P}_s = \\epsilon_0 F \\mathbf{E}_{\\mathrm{av}}$。对于此一维分析，我们假设标量 $P$ 和 $E$。在频域中，采用时谐约定 $e^{-j\\omega t}$，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为 $-j\\omega$。应用此变换，我们得到：\n$$\n(-j\\omega)^2 \\tilde{P}(\\omega) + \\Gamma(-j\\omega)\\tilde{P}(\\omega) + \\omega_0^2 \\tilde{P}(\\omega) = \\epsilon_0 F \\tilde{E}(\\omega)\n$$\n$$\n(-\\omega^2 - j\\omega\\Gamma + \\omega_0^2) \\tilde{P}(\\omega) = \\epsilon_0 F \\tilde{E}(\\omega)\n$$\n电极化率 $\\chi(\\omega)$ 由本构关系 $\\tilde{P}(\\omega) = \\epsilon_0 \\chi(\\omega) \\tilde{E}(\\omega)$ 定义。将其代入变换后的洛伦兹方程，得到：\n$$\n(\\omega_0^2 - \\omega^2 - j\\Gamma\\omega) \\epsilon_0 \\chi(\\omega) \\tilde{E}(\\omega) = \\epsilon_0 F \\tilde{E}(\\omega)\n$$\n求解 $\\chi(\\omega)$ 即可得到所需的表达式：\n$$\n\\chi(\\omega) = \\frac{F}{\\omega_0^2 - \\omega^2 - j\\Gamma\\omega}\n$$\n为了求 $\\chi(\\omega)$ 的虚部，我们将分子和分母同乘以分母的复共轭：\n$$\n\\chi(\\omega) = \\frac{F}{(\\omega_0^2 - \\omega^2) - j\\Gamma\\omega} \\cdot \\frac{(\\omega_0^2 - \\omega^2) + j\\Gamma\\omega}{(\\omega_0^2 - \\omega^2) + j\\Gamma\\omega} = \\frac{F\\left( (\\omega_0^2 - \\omega^2) + j\\Gamma\\omega \\right)}{(\\omega_0^2 - \\omega^2)^2 + (\\Gamma\\omega)^2}\n$$\n因此，虚部为：\n$$\n\\operatorname{Im}\\{\\chi(\\omega)\\} = \\frac{F \\Gamma \\omega}{(\\omega_0^2 - \\omega^2)^2 + (\\Gamma\\omega)^2}\n$$\n鉴于振子强度 $F$ 是一个正常数，角频率 $\\omega$ 是非负的，分母总是非负的。因此，$\\operatorname{Im}\\{\\chi(\\omega)\\}$ 的符号与阻尼率 $\\Gamma$ 的符号相同。对于无源系统，能量被耗散，对应于 $\\Gamma > 0$ 和 $\\operatorname{Im}\\{\\chi(\\omega)\\} > 0$。对于有源系统（增益），能量被注入，对应于 $\\Gamma  0$ 和 $\\operatorname{Im}\\{\\chi(\\omega)\\}  0$。这证实了问题的假设。\n\n### 4. 数值稳定性分析\n\n对于由 $\\mathbf{x}^{n+1} = M \\mathbf{x}^n$ 描述的时间步进格式，其数值稳定性要求放大矩阵 $M$ 的所有特征值 $\\lambda_i$ 的模都小于或等于 $1$。这个条件可以简洁地表述为谱半径 $\\rho(M) = \\max_i |\\lambda_i|$ 必须满足 $\\rho(M) \\leq 1$。\n\n**显式格式 ($M_{\\text{exp}}$):** 前向欧拉法的稳定性是条件性的。它在复平面上的稳定域并不包含整个左半平面。这意味着即使底层的连续系统在物理上是稳定的（其所有特征值的实部都为非正），如果时间步长 $\\Delta t$ 过大，数值格式也可能变得不稳定。如果连续系统在物理上是不稳定的（拥有至少一个实部为正的特征值），例如在有增益（$\\Gamma  0$）的情况下，那么对于任何 $\\Delta t > 0$，前向欧拉格式都保证是不稳定的，因为 $\\rho(M_{\\text{exp}})$ 将大于 $1$。辐射阻尼 $\\beta$ 的存在可以抵消增益。如果 $\\beta$ 足够大，它可以通过确保其所有特征值都具有非正实部来稳定连续系统。然而，即使在这种增益被补偿但物理上稳定的情况下，如果 $\\Delta t$ 过大，显式格式仍然可能由于系统是刚性的而数值上不稳定。\n\n**隐式格式 ($M_{\\text{imp}}$):** 后向欧拉法是 A-稳定的，这意味着它的稳定域包括复平面的整个左半部分。因此，对于任何物理上稳定的连续系统（包括刚性系统），后向欧拉格式对于任何时间步长 $\\Delta t > 0$ 都是数值稳定的（$\\rho(M_{\\text{imp}}) \\leq 1$）。这就是“恢复数值稳定性”的含义：它消除了困扰显式方法的、针对刚性问题的伪数值不稳定性。如果连续系统在物理上是不稳定的（由于强增益未被阻尼补偿，即 $\\Gamma  0$ 且 $\\beta$ 较小），隐式格式将产生一个随时间在幅度上增长的解，从而正确地反映了物理不稳定性。在这种情况下，$\\rho(M_{\\text{imp}}) > 1$。因此，该方法在应该稳定时是数值稳定的，在存在物理不稳定性时也能正确地捕捉到它。\n\n### 5. 实现与测试用例评估\n\n根据上述分析，程序被实现来计算每个测试用例的布尔值。计算将精确地遵循推导出的矩阵和稳定性条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the metasurface FDTD stability problem for a given set of test cases.\n    \"\"\"\n    \n    # Test cases as tuples of (epsilon_0, w0, Gamma, F, beta, dt, w_test)\n    test_cases = [\n        # Case 1 (Passive, nominally stable)\n        (8.854e-12, 1.0e10, 1.0e9, 1.0e12, 3.0e9, 5.0e-12, 2 * np.pi * 1.0e10),\n        # Case 2 (Passive with large time-step, boundary behavior)\n        (8.854e-12, 1.0e10, 1.0e9, 1.0e12, 3.0e9, 5.0e-11, 2 * np.pi * 1.0e10),\n        # Case 3 (Weak gain, radiation-dominated)\n        (8.854e-12, 1.0e10, -5.0e8, 1.0e12, 1.0e9, 5.0e-12, 2 * np.pi * 1.0e10),\n        # Case 4 (Strong gain, radiation-insufficient)\n        (8.854e-12, 1.0e10, -2.0e9, 1.0e12, 5.0e8, 5.0e-12, 2 * np.pi * 1.0e10),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        epsilon_0, w0, Gamma, F, beta, dt, w_test = case\n\n        # 1. Determine if the metasurface has gain at the test frequency\n        # Im{chi} = (F * Gamma * w) / ( (w0^2 - w^2)^2 + (Gamma*w)^2 )\n        # The sign of Im{chi} is determined by the sign of Gamma, since F and w are positive.\n        # Im{chi}  0 implies gain.\n        is_gain = Gamma  0\n\n        # 2. Analyze Explicit (Forward Euler) Stability\n        # Build the explicit amplification matrix M_exp\n        M_exp = np.array([\n            [1 - dt * beta, 0, -dt / epsilon_0],\n            [0, 1, dt],\n            [dt * epsilon_0 * F, -dt * w0**2, 1 - dt * Gamma]\n        ], dtype=np.complex128)\n        \n        # Calculate eigenvalues and spectral radius\n        eigenvalues_exp = np.linalg.eigvals(M_exp)\n        rho_exp = np.max(np.abs(eigenvalues_exp))\n        \n        # Check stability condition\n        explicit_stable = rho_exp = 1.0\n\n        # 3. Analyze Implicit (Backward Euler) Stability\n        # Build the matrix A for the implicit system A * x^{n+1} = x^n\n        A = np.array([\n            [1 + dt * beta, 0, dt / epsilon_0],\n            [0, 1, -dt],\n            [-dt * epsilon_0 * F, dt * w0**2, 1 + dt * Gamma]\n        ], dtype=np.complex128)\n\n        # The implicit amplification matrix is M_imp = inv(A)\n        # Its eigenvalues are the reciprocal of A's eigenvalues.\n        # The stability condition rho(M_imp) = 1 is equivalent to\n        # all eigenvalues of A having magnitude >= 1.\n        eigenvalues_A = np.linalg.eigvals(A)\n        min_mag_A_eig = np.min(np.abs(eigenvalues_A))\n        \n        # Check stability condition\n        implicit_stable = min_mag_A_eig >= 1.0\n\n        results.append([is_gain, explicit_stable, implicit_stable])\n\n    # Format the final output string precisely as requested.\n    result_strings = [str(res).replace(\" \", \"\") for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n\n```"
        }
    ]
}