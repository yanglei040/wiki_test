{
    "hands_on_practices": [
        {
            "introduction": "理论联系实际是掌握尾场计算的关键。本节将通过一系列动手实践，加深您对核心概念的理解。首先，我们将探讨一个基本但至重要的问题：能量耗散与阻抗的虚部和实部之间的关系。通过计算一个理想电感结构中的束流能量损失因子 $k$ ，您将亲自验证，纯电抗性组件虽然与束流相互作用，但不会造成不可逆的能量损失。这个练习旨在阐明耦合阻抗实部的物理意义，并为后续更复杂的分析奠定基础。",
            "id": "3360476",
            "problem": "考虑一个刚性的超相对论单束团，穿过一个线性时不变的加速器结构。设束团的时间电流由一个归一化的高斯分布 $i(t)$ 描述，其均方根时长为 $\\sigma_{t}$，总束团电荷为 $q$，因此有 $I(t)=q\\,i(t)$ 且 $\\int_{-\\infty}^{\\infty} i(t)\\,\\mathrm{d}t = 1$。空间中的均方根束团长度为 $\\sigma_{z}=c\\,\\sigma_{t}$，其中 $c$ 是真空中的光速。结构的纵向束流耦合阻抗 $Z_{\\parallel}(\\omega)$ 在频域中由束流频谱 $I(\\omega)$ 和感应电压谱 $V(\\omega)$ 之间的标准线性响应关系定义，即 $V(\\omega)=Z_{\\parallel}(\\omega)\\,I(\\omega)$。束团单次通过结构时耗散的能量是瞬时功率 $P(t)=I(t)\\,V(t)$ 对时间的积分。损耗因子 $k$ 定义为单位电荷平方的耗散能量，即 $k \\equiv W_{\\mathrm{diss}}/q^{2}$，它用作衡量束团因结构的电阻性响应而经历的不可逆能量损失的指标。从这些定义、Poynting 定理以及在线性无源系统中只有阻抗的电阻（实）部分对净能量耗散有贡献这一性质出发，推导出一个用束团谱和阻抗表示的 $k$ 的表达式。然后，对于一个具有纯感性纵向阻抗 $Z_{\\parallel}(\\omega)=i\\,L\\,\\omega$ 的结构（其中 $L$ 是一个实的正电感参数，$\\omega$ 是角频率），计算 $k$ 如何随束团均方根长度 $\\sigma_{z}$ 变化。你的最终答案必须是 $k$ 作为 $\\sigma_{z}$ 函数的单个闭合形式表达式，并且必须以无单位的形式表示。不需要进行数值计算。此外，请解释你所得到的标度关系的物理来源。如果需要进行任何舍入，请保留四位有效数字；否则，请提供精确表达式。用 LaTeX 表示所有数学实体。",
            "solution": "题目要求推导损耗因子 $k$ 及其在纯感性纵向阻抗特定情况下随束团长度 $\\sigma_z$ 的标度关系。解答将分三步进行：首先，从给定的定义中推导出损耗因子 $k$ 的通用表达式；其次，对给定的阻抗模型评估此表达式；第三，解释结果的物理意义及其标度关系。\n\n首先，我们推导损耗因子 $k$ 的通用表达式。结构中耗散的总能量 $W_{\\mathrm{diss}}$ 由瞬时功率 $P(t)=I(t)V(t)$ 的时间积分给出：\n$$\nW_{\\mathrm{diss}} = \\int_{-\\infty}^{\\infty} P(t) \\, \\mathrm{d}t = \\int_{-\\infty}^{\\infty} I(t) V(t) \\, \\mathrm{d}t\n$$\n此处，$I(t)$ 是束团电流，$V(t)$ 是由此电流感应的纵向电压。$I(t)$ 和 $V(t)$ 都是实值物理量。为了在频域中分析此问题，我们使用 Parseval 定理。设 $I(\\omega)$ 和 $V(\\omega)$ 分别是 $I(t)$ 和 $V(t)$ 的傅里叶变换，使用约定 $F(\\omega) = \\int_{-\\infty}^{\\infty} f(t) \\exp(-i\\omega t) \\, \\mathrm{d}t$。相应的逆变换为 $f(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} F(\\omega) \\exp(i\\omega t) \\, \\mathrm{d}\\omega$。\n使用此约定，Parseval 定理给出：\n$$\n\\int_{-\\infty}^{\\infty} I(t) V(t) \\, \\mathrm{d}t = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I(-\\omega) V(\\omega) \\, \\mathrm{d}\\omega\n$$\n由于 $I(t)$ 是一个实函数，其傅里叶变换满足性质 $I(-\\omega) = I^*(\\omega)$，其中星号表示复共轭。因此，耗散能量的表达式变为：\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I^*(\\omega) V(\\omega) \\, \\mathrm{d}\\omega\n$$\n题目给出了频域中的线性响应关系：$V(\\omega) = Z_{\\parallel}(\\omega) I(\\omega)$。将其代入 $W_{\\mathrm{diss}}$ 的表达式中，得到：\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I^*(\\omega) Z_{\\parallel}(\\omega) I(\\omega) \\, \\mathrm{d}\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega) |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n题目正确地指出，只有阻抗的电阻（实）部分对净能量耗散有贡献。我们可以从数学上证明这一点。对于一个实值尾场函数，阻抗必须满足 $Z_{\\parallel}(\\omega) = Z_{\\parallel}^*(-\\omega)$。这意味着其实部 $\\text{Re}[Z_{\\parallel}(\\omega)]$ 是 $\\omega$ 的偶函数，其虚部 $\\text{Im}[Z_{\\parallel}(\\omega)]$ 是 $\\omega$ 的奇函数。$|I(\\omega)|^2$ 项必然是实数且是偶函数。\n我们可以将 $W_{\\mathrm{diss}}$ 的积分拆分：\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left( \\text{Re}[Z_{\\parallel}(\\omega)] + i \\, \\text{Im}[Z_{\\parallel}(\\omega)] \\right) |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega + \\frac{i}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Im}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n在第二项中，被积函数是一个奇函数 $\\text{Im}[Z_{\\parallel}(\\omega)]$ 和一个偶函数 $|I(\\omega)|^2$ 的乘积。得到的被积函数是奇函数，其在对称区间 $(-\\infty, \\infty)$ 上的积分为零。因此，耗散的能量仅由阻抗的实部决定：\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n损耗因子 $k$ 定义为 $k \\equiv W_{\\mathrm{diss}}/q^2$。束团电流谱为 $I(\\omega) = q \\, i(\\omega)$，其中 $i(\\omega)$ 是归一化电流分布 $i(t)$ 的傅里叶变换。因此，有 $|I(\\omega)|^2 = q^2 |i(\\omega)|^2$。将此代入 $W_{\\mathrm{diss}}$ 的表达式并除以 $q^2$：\n$$\nk = \\frac{1}{q^2} \\left( \\frac{q^2}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |i(\\omega)|^2 \\, \\mathrm{d}\\omega \\right) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |i(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n这就是所要求的、用束团谱和阻抗表示的损耗因子的通用表达式。\n\n接下来，我们将此结果应用于纯感性纵向阻抗的特定情况，$Z_{\\parallel}(\\omega) = i L \\omega$，其中 $L$ 是一个实的正常量。该阻抗的实部为：\n$$\n\\text{Re}[Z_{\\parallel}(\\omega)] = \\text{Re}[i L \\omega] = 0 \\quad \\text{for all } \\omega\n$$\n将此代入我们推导出的损耗因子 $k$ 的表达式中：\n$$\nk = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (0) \\cdot |i(\\omega)|^2 \\, \\mathrm{d}\\omega = 0\n$$\n对于纯感性阻抗，损耗因子恒为零。\n\n最后，我们来讨论 $k$ 如何随束团均方根长度 $\\sigma_z$ 变化。由于 $k=0$，它是一个常数，不依赖于任何束团参数，包括 $\\sigma_z$。$k$ 作为 $\\sigma_z$ 的函数表达式就是 $k(\\sigma_z) = 0$。\n\n这一结果的物理根源在于阻抗和能量耗散的定义。损耗因子 $k$ 量化了束团的不可逆能量损失，即在加速器结构中以热量形式耗散的能量。在一个线性时不变系统中，这种耗散完全与阻抗的电阻（实）部分相关。给定的阻抗 $Z_{\\parallel}(\\omega) = i L \\omega$ 是纯虚数，代表一个理想电感器。理想电感器是一个电抗性而非电阻性元件。它在电流变化时将能量存储在其磁场中，并能完美地将此能量返还给系统。虽然束团与场之间存在能量交换，但没有净能量耗散。束团头部在建立场时损失的能量，会随着场的坍缩被束团尾部完全回收。因此，总耗散能量 $W_{\\mathrm{diss}}$ 为零，所以损耗因子 $k$ 也为零，这与束团的形状或时长 $\\sigma_t$（及其长度 $\\sigma_z$）无关。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在理解了总能量损失之后，我们转向另一个关键参数：束团内部的能量散布。即使没有净能量损失，尾场仍然可以重新分配束团内的能量，从而影响束流品质。本练习  将指导您分析两种典型阻抗模型——纯电感模型和电阻壁模型——所引起的峰值能量散布与束团长度 $\\sigma_z$ 的标度关系。通过这种对比，您将学会如何运用解析标度律分析方法，深刻理解不同物理来源的尾场对束团动力学有何不同的影响。",
            "id": "3360475",
            "problem": "一个总电荷为 $Q$ 的超相对论性带电束团穿过一个长度为 $L$ 的柱对称、方位角光滑的加速器结构。由束团感应的尾场在频域中由纵向耦合阻抗 $Z_{\\parallel}(\\omega)$ 表征。束团内纵向位置 $z$ 处的尾场感应能量偏差可以用尾场电压 $V_{\\text{wake}}(z)$ 表示为 $\\Delta \\mathcal{E}(z) = - e\\, V_{\\text{wake}}(z)$，其中 $e$ 是元电荷。对于超相对论性运动，尾场电压与阻抗通过卷积关联，在频域中可表示为 $V_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega)\\, \\tilde{I}(\\omega)\\, \\exp\\!\\left(i \\frac{\\omega z}{c}\\right)\\, d\\omega$，其中 $c$ 是光速，$\\tilde{I}(\\omega)$ 是束团电流分布 $I(z) = Q c\\, \\lambda(z)$ 的傅里叶变换，而 $\\lambda(z)$ 是归一化为 $\\int \\lambda(z)\\, dz = 1$ 的线密度分布。\n\n假设线密度为高斯分布 $\\lambda(z) = \\frac{1}{\\sqrt{2\\pi}\\, \\sigma_{z}} \\exp\\!\\left(-\\frac{z^{2}}{2\\sigma_{z}^{2}}\\right)$，其均方根长度为 $\\sigma_{z}$，并使用标准傅里叶变换 $\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\lambda(z)\\, \\exp\\!\\left(- i \\frac{\\omega z}{c}\\right)\\, dz$。在对束团频谱有主要贡献的频率范围内，考虑两种渐近阻抗模型：\n\n1.  纯感性阻抗 $Z_{\\parallel}(\\omega) = i L_{k}\\, \\omega$，其中 $L_{k}$ 是一个不依赖于 $\\omega$ 或 $\\sigma_{z}$ 的实常数。\n\n2.  具有高频标度的电阻壁阻抗 $Z_{\\parallel}(\\omega) = A\\, \\omega^{-1/2}$，其中 $A$ 是一个不依赖于 $\\omega$ 和 $\\sigma_{z}$ 的实正常数。\n\n从以上定义出发，不引入任何经验性简化公式，对于每种阻抗模型，确定束团内的峰值尾场感应能量散布 $\\Delta \\mathcal{E}_{\\text{peak}} = \\max_{z} |\\Delta \\mathcal{E}(z) - \\langle \\Delta \\mathcal{E} \\rangle|$ 相对于 $\\sigma_{z}$ 的标度关系。你可以将不依赖于 $\\sigma_{z}$ 的乘法常数（如 $Q$、$L$、$L_{k}$、$A$ 和 $c$）视为总体前置因子，并专注于其对 $\\sigma_{z}$ 的渐近幂律依赖关系。给出两个标度指数 $a_{\\text{ind}}$ 和 $a_{\\text{rw}}$，使得感性情况下 $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{ind}}}$，电阻壁情况下 $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{rw}}}$。将你的最终答案表示为包含这两个指数的行矩阵。无需四舍五入，最终答案中不应包含单位。",
            "solution": "问题要求解在两种不同阻抗模型下，峰值尾场感应能量散布相对于束团长度 $\\sigma_{z}$ 的标度指数。\n\n### 第一步：提取已知条件\n- 总束团电荷：$Q$\n- 加速器结构长度：$L$\n- 纵向耦合阻抗：$Z_{\\parallel}(\\omega)$\n- 尾场感应能量偏差：$\\Delta \\mathcal{E}(z) = -e V_{\\text{wake}}(z)$，其中 $e$ 是元电荷。\n- 尾场电压：$V_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega) \\tilde{I}(\\omega) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega$，其中 $c$ 是光速。\n- 束团电流傅里叶变换：$\\tilde{I}(\\omega)$\n- 束团电流分布：$I(z) = Q c \\lambda(z)$\n- 归一化线密度分布：$\\lambda(z)$，满足 $\\int \\lambda(z) dz = 1$。\n- 具体线密度：高斯分布，$\\lambda(z) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z^2}{2\\sigma_{z}^2}\\right)$，其均方根长度为 $\\sigma_{z}$。\n- 线密度的傅里叶变换定义：$\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\lambda(z) \\exp\\left(-i \\frac{\\omega z}{c}\\right) dz$。\n- 阻抗模型1（感性）：$Z_{\\parallel}(\\omega) = i L_k \\omega$，其中 $L_k$ 是一个实常数。\n- 阻抗模型2（电阻壁）：$Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$，其中 $A$ 是一个实正常数。\n- 待求量：峰值尾场感应能量散布，$\\Delta \\mathcal{E}_{\\text{peak}} = \\max_{z} |\\Delta \\mathcal{E}(z) - \\langle \\Delta \\mathcal{E} \\rangle|$，其中 $\\langle \\Delta \\mathcal{E} \\rangle$ 是在束团分布上的平均值。\n- 目标：求出标度关系 $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{ind}}}$ 和 $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{rw}}}$ 中的指数 $a_{\\text{ind}}$ 和 $a_{\\text{rw}}$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题在加速器物理和计算电磁学的背景下是明确定义的。它使用了尾场电压、阻抗和束团分布的标准定义。高斯束团分布以及感性和电阻壁阻抗模型是该领域使用的典型例子。所提供的公式是内部一致的。傅里叶变换的定义已明确给出，消除了歧义。电阻壁阻抗的定义 $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$ 是其完整形式的简化，特别是在其于 $\\omega > 0$ 时的行为方面。然而，这被描述为一种高频标度，并且该问题可以通过关注标度性质而非确切的函数形式来解决，这使得该简化对于预期目的而言是可接受的。因此，该问题是科学上合理的、适定的和客观的。\n\n### 第三步：结论与行动\n该问题有效。将推导一个完整的解。\n\n### 解题推导\n\n首先，我们确定束团电流的傅里叶变换 $\\tilde{I}(\\omega)$。电流为 $I(z) = Q c \\lambda(z)$，所以其傅里叶变换为 $\\tilde{I}(\\omega) = Q c \\tilde{\\lambda}(\\omega)$。\n我们计算给定高斯分布的 $\\tilde{\\lambda}(\\omega)$：\n$$\n\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z'^2}{2\\sigma_{z}^2}\\right) \\exp\\left(-i \\frac{\\omega z'}{c}\\right) dz'\n$$\n这是一个高斯函数的标准傅里叶变换。$\\exp(-ax^2)$ 的积分是 $\\sqrt{\\pi/a}$。对指数部分进行配方，可得：\n$$\n-\\frac{z'^2}{2\\sigma_{z}^2} - i \\frac{\\omega z'}{c} = -\\frac{1}{2\\sigma_{z}^2}\\left(z'^2 + 2i \\frac{\\omega \\sigma_{z}^2}{c} z'\\right) = -\\frac{1}{2\\sigma_{z}^2}\\left(z' + i \\frac{\\omega \\sigma_{z}^2}{c}\\right)^2 - \\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\n$$\n积分为：\n$$\n\\tilde{\\lambda}(\\omega) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2\\sigma_{z}^2}\\left(z' + i \\frac{\\omega \\sigma_{z}^2}{c}\\right)^2\\right) dz'\n$$\n该积分是在复平面上对一个平移变量进行的，但对于高斯函数，其值是不变的，等于 $\\sqrt{2\\pi \\sigma_{z}^2} = \\sqrt{2\\pi}\\sigma_{z}$。\n$$\n\\tilde{\\lambda}(\\omega) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) (\\sqrt{2\\pi} \\sigma_{z}) = \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\n$$\n因此，电流的傅里叶变换为：\n$$\n\\tilde{I}(\\omega) = Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\n$$\n\n现在我们可以为每种情况计算尾场电压和能量散布。\n\n#### 情况1：感性阻抗，$Z_{\\parallel}(\\omega) = i L_{k} \\omega$\n\n尾场电压为：\n$$\nV_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (i L_{k} \\omega) \\left(Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{i Q c L_{k}}{2\\pi} \\int_{-\\infty}^{\\infty} \\omega \\exp\\left(-\\frac{\\sigma_{z}^2}{2c^2}\\omega^2 + i \\frac{z}{c}\\omega \\right) d\\omega\n$$\n我们可以通过注意傅里叶变换和导数之间的关系来计算这个积分。傅里叶逆变换定义为 $f(x) = \\frac{1}{2\\pi} \\int \\tilde{f}(k) e^{ikx} dk$。导数的变换是 $\\mathcal{F}\\{f'(x)\\} = ik\\tilde{f}(k)$。这里，$k \\leftrightarrow \\omega$ 且 $x \\leftrightarrow z/c$。\n$$\n\\omega \\exp\\left(i \\frac{\\omega z}{c}\\right) = -ic \\frac{\\partial}{\\partial z} \\exp\\left(i \\frac{\\omega z}{c}\\right)\n$$\n将此代入 $V_{\\text{wake}}(z)$ 的积分中：\n$$\nV_{\\text{wake}}(z) = \\frac{i Q c L_{k}}{2\\pi} \\int_{-\\infty}^{\\infty} \\left(-ic \\frac{\\partial}{\\partial z}\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) d\\omega\n$$\n我们可以将导数提到积分外面：\n$$\nV_{\\text{wake}}(z) = \\frac{Q c^2 L_{k}}{2\\pi} \\frac{\\partial}{\\partial z} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\n该积分是 $\\tilde{I}(\\omega)/(Qc)$ 的傅里叶逆变换，它会得到原始的电荷分布 $I(z)/(Qc) = \\lambda(z)$，并乘以一个标度因子 $2\\pi/c$。直接计算该积分得到 $\\frac{\\sqrt{2\\pi}c}{\\sigma_z}\\exp(-\\frac{z^2}{2\\sigma_z^2})$。\n所以，导数内的表达式是 $\\frac{c}{Qc} \\cdot I(z) = \\lambda(z)$。不，这不完全对。\n积分 $\\frac{1}{2\\pi}\\int \\tilde{\\lambda}(\\omega) e^{i\\omega z/c} d\\omega$ 并不是 $\\lambda(z)$。让我们直接计算这个积分。\n积分为 $\\frac{\\sqrt{2\\pi} c}{\\sigma_z} \\exp(-\\frac{z^2}{2\\sigma_z^2})$。\n$$\nV_{\\text{wake}}(z) = \\frac{Q c^2 L_{k}}{2\\pi} \\frac{\\partial}{\\partial z} \\left( \\frac{\\sqrt{2\\pi} c}{\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\right)\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z} \\frac{\\partial}{\\partial z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = \\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z} \\left(-\\frac{z}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right)\n$$\n$$\nV_{\\text{wake}}(z) = -\\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z^3} z \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right)\n$$\n能量偏差为 $\\Delta\\mathcal{E}(z) = -e V_{\\text{wake}}(z)$。\n为了找到 $\\Delta\\mathcal{E}_{\\text{peak}}$，我们首先需要 $\\langle \\Delta\\mathcal{E} \\rangle = \\int_{-\\infty}^{\\infty} \\Delta\\mathcal{E}(z) \\lambda(z) dz$。\n$$\n\\langle \\Delta\\mathcal{E} \\rangle \\propto \\int_{-\\infty}^{\\infty} z \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\frac{1}{\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) dz \\propto \\int_{-\\infty}^{\\infty} z \\exp\\left(-\\frac{z^2}{\\sigma_z^2}\\right) dz\n$$\n被积函数是 $z$ 的奇函数，所以在对称区间上的积分为零。因此，$\\langle \\Delta\\mathcal{E} \\rangle = 0$。\n那么 $\\Delta\\mathcal{E}_{\\text{peak}} = \\max_z |\\Delta\\mathcal{E}(z)|$。我们必须找到 $|z \\exp(-\\frac{z^2}{2\\sigma_z^2})|$ 的最大值。\n设 $f(z) = z \\exp(-\\frac{z^2}{2\\sigma_z^2})$。对 $z$ 求导并令其为零：\n$$\n\\frac{df}{dz} = \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) + z \\left(-\\frac{z}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = \\left(1 - \\frac{z^2}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = 0\n$$\n这给出 $z_{max} = \\pm \\sigma_z$。$|f(z)|$ 的峰值为 $|\\pm \\sigma_z \\exp(-(\\pm \\sigma_z)^2 / (2\\sigma_z^2))| = \\sigma_z \\exp(-1/2)$。\n将此代入 $|\\Delta\\mathcal{E}(z)|$ 的表达式中：\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} = \\left| -e \\left(-\\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z^3}\\right) (\\sigma_z \\exp(-1/2)) \\right| \\propto \\frac{\\sigma_z}{\\sigma_z^3} = \\frac{1}{\\sigma_z^2}\n$$\n所以，$\\Delta\\mathcal{E}_{\\text{peak}} \\sim \\sigma_z^{-2}$。这意味着 $a_{\\text{ind}} = -2$。\n\n#### 情况2：电阻壁阻抗，$Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$\n\n为了使尾场函数是时间/位置的实值函数，频域中的阻抗必须满足 $Z_{\\parallel}(-\\omega) = Z_{\\parallel}^*(\\omega)$。所给出的形式 $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$ 在 $\\omega>0$ 时为实数。为了满足厄米共轭条件，$Z_{\\parallel}(\\omega)$ 必须是偶函数，即 $Z_{\\parallel}(\\omega) = A|\\omega|^{-1/2}$。这个形式在 $\\omega = 0$ 处是奇异的，但由于束团的高斯谱在 $\\omega = 0$ 处为零，该积分被正则化了。\n尾场电压为：\n$$\nV_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} A |\\omega|^{-1/2} \\left(Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\n为了找到与 $\\sigma_z$ 的标度关系，我们在积分中进行变量替换。令 $u = \\omega \\sigma_z / c$。那么 $\\omega = u c / \\sigma_z$ 并且 $d\\omega = (c/\\sigma_z) du$。\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} \\int_{-\\infty}^{\\infty} \\left|\\frac{uc}{\\sigma_z}\\right|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) \\frac{c}{\\sigma_z} du\n$$\n我们将依赖于 $\\sigma_z$ 的项归并在一起：\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} \\left(\\frac{c}{\\sigma_z}\\right)^{-1/2} \\left(\\frac{c}{\\sigma_z}\\right) \\int_{-\\infty}^{\\infty} |u|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) du\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} c^{1/2} \\sigma_z^{-1/2} \\int_{-\\infty}^{\\infty} |u|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) du\n$$\n该积分是无量纲变量 $\\zeta = z/\\sigma_z$ 的函数。我们称之为 $G(\\zeta)$。\n所以，$V_{\\text{wake}}(z)$ 的形式为 $V_{\\text{wake}}(z) = C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z)$，其中 $C_{\\text{rw}}$ 是一个不依赖于 $\\sigma_z$ 的常数。\n能量偏差为 $\\Delta\\mathcal{E}(z) = -e C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z)$。\n接下来，我们计算平均能量偏差 $\\langle\\Delta\\mathcal{E}\\rangle$：\n$$\n\\langle\\Delta\\mathcal{E}\\rangle = \\int_{-\\infty}^{\\infty} \\Delta\\mathcal{E}(z) \\lambda(z) dz = \\int_{-\\infty}^{\\infty} \\left(-e C_{\\text{rw}} \\sigma_z^{-1/2} G\\left(\\frac{z}{\\sigma_z}\\right)\\right) \\frac{1}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) dz\n$$\n令 $y = z/\\sigma_z$，则 $dz = \\sigma_z dy$。\n$$\n\\langle\\Delta\\mathcal{E}\\rangle = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\int_{-\\infty}^{\\infty} G(y) \\frac{1}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{y^2}{2}\\right) \\sigma_z dy = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\left( \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} G(y) e^{-y^2/2} dy \\right)\n$$\n括号中的积分是一个常数，我们称之为 $\\langle G \\rangle$。所以，$\\langle\\Delta\\mathcal{E}\\rangle \\propto \\sigma_z^{-1/2}$。\n峰值能量散布是 $\\Delta\\mathcal{E}_{\\text{peak}} = \\max_z |\\Delta\\mathcal{E}(z) - \\langle\\Delta\\mathcal{E}\\rangle|$。\n$$\n\\Delta\\mathcal{E}(z) - \\langle\\Delta\\mathcal{E}\\rangle = -e C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z) - (-e C_{\\text{rw}} \\sigma_z^{-1/2} \\langle G \\rangle) = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\left[ G(z/\\sigma_z) - \\langle G \\rangle \\right]\n$$\n峰值通过对表达式关于 $z$ 最大化来找到：\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} = \\left|-e C_{\\text{rw}} \\sigma_z^{-1/2}\\right| \\max_z \\left| G(z/\\sigma_z) - \\langle G \\rangle \\right|\n$$\n最大化是针对无量纲变量 $\\zeta = z/\\sigma_z$ 进行的，所以结果 $\\max_\\zeta|G(\\zeta) - \\langle G \\rangle|$ 是一个不依赖于 $\\sigma_z$ 的常数。\n因此，标度关系完全由前置因子决定：\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} \\sim \\sigma_z^{-1/2}\n$$\n这给出了第二个指数 $a_{\\text{rw}} = -1/2$。\n\n这两个标度指数是 $a_{\\text{ind}} = -2$ 和 $a_{\\text{rw}} = -1/2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-2  -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "前面的练习主要关注纵向尾场效应。然而，在实际加速器中，由束流偏离中心引起的横向尾场往往是限制机器性能的更主要因素。这个综合性练习  将引导您进入横向尾场的世界。您将通过对一个简化的本征模式模型进行一阶展开，来分析束流的微小偏移和倾斜是如何产生横向尾场的，并通过数值计算来验证您的解析结果。最终，您将把这些物理洞察转化为实际的工程应用，即根据允许的最大尾场效应来设定加速器组件的准直容差。",
            "id": "3360436",
            "problem": "考虑一个用于加速器结构中横向尾场计算的简化但物理上一致的本征模式模型，该模型以归一化的无量纲单位表示。一个半径为 $a$、长度为 $L$ 的理想导电、圆柱对称的pillbox（药盒）结构支持方位角指数为 $m$、径向指数为 $n$、轴向指数为 $p$ 的横磁（TM）模式。我们在由偶极子族 $m=1$ 构成的截断本征模式基中进行计算，其径向波数为 $k_{r,n} = j_{1,n}/a$，其中 $j_{1,n}$ 表示第一类贝塞尔函数 $J_1(\\cdot)$ 的第 $n$ 个正根；轴向波数为 $k_{z,p} = p \\pi / L$，其中整数 $p \\ge 0$。相应的模式角频率为 $\\omega_{n,p} = \\sqrt{k_{r,n}^2 + k_{z,p}^2}$。假设光速归一化为 $c=1$，结构半径为 $a=1$，并使用一个总的指数衰减因子 $\\mathrm{e}^{-\\gamma s}$（其中 $\\gamma0$）来模拟沿纵向间距 $s \\ge 0$ 的有效模式损耗。\n\n一个超相对论性点电荷 $q$ 在结构内沿直线传播，其在 $x$ 方向有微小的横向失准，由一个偏移量 $x_0$ 和一个微小倾斜角 $\\theta$（以弧度为单位）参数化，因此其轨迹为 $x(z) = x_0 + \\theta \\,(z - L/2)$，适用于 $z \\in [0,L]$。归一化的无量纲横向尾场函数 $W_{\\perp}(s;x_0,\\theta)$ 在此定义为，在纵向间距 $s$ 处，一个跟随的超相对论性测试粒子在结构轴线上所受到的单位电荷的线性横向踢。在此本征模式模型中，取 $W_{\\perp}$ 的精确、模式截断合成为\n$$\nW_{\\perp}(s;x_0,\\theta) \\;=\\; \\sum_{n=1}^{N_r} \\sum_{p=0}^{N_z-1} \\; k_{r,n} \\,\\Bigg[ \\int_{0}^{L} J_1\\!\\big(k_{r,n}\\,x(z)\\big)\\,\\cos\\!\\big(k_{z,p}\\,z\\big)\\,dz \\Bigg] \\,\\cos\\!\\big(\\omega_{n,p}\\,s\\big)\\,\\mathrm{e}^{-\\gamma s},\n$$\n为方便起见，归一化系数被选为1，因为重点是验证相对于 $x_0$ 和 $\\theta$ 的一阶线性，而非绝对校准。此定义足以测试解析一阶展开及其数值验证。所有量均为无量纲；角度以弧度为单位。\n\n任务 1（从基本原理进行一阶展开）：从麦克斯韦方程组的线性以及通过模式正交性定义的尾场出发，利用 $J_1(\\cdot)$ 的小宗量展开和 Panofsky–Wenzel 关系 $\\partial W_{\\perp}/\\partial s = \\nabla_{\\perp} W_{\\parallel}$ 作为物理基础，论证对于足够小的 $x_0$ 和 $\\theta$，横向尾场可进行一阶展开\n$$\nW_{\\perp}(s;x_0,\\theta) \\;\\approx\\; x_0\\,K_0(s;L) \\;+\\; \\theta\\,K_1(s;L),\n$$\n其中 $K_0(s;L)$ 和 $K_1(s;L)$ 是线性响应系数，它们依赖于几何参数 $L$、截断参数 $N_r$ 和 $N_z$ 以及 $s$。\n\n任务 2（推导闭式模式求和表达式）：明确推导 $K_0(s;L)$ 和 $K_1(s;L)$ 的表达式，用模式求和以及在对 $J_1(k_{r,n} x(z))$（其中 $x(z)=x_0+\\theta\\,(z-L/2)$）进行一阶展开时出现的 $\\cos(k_{z,p} z)$ 和 $(z - L/2)\\cos(k_{z,p} z)$ 的 $z$ 向积分来表示。说明轴向积分如何简化为 $k_{z,p}$ 和 $L$ 的函数，并指出哪些轴向指数 $p$ 对每个系数有贡献。\n\n任务 3（通过微扰进行线性的数值验证）：实现一个数值程序，使用上述精确表达式（即，在被积函数内部不使用小宗量近似）计算 $W_{\\perp}(s;x_0,\\theta)$，其中 $z$ 向积分以高精度进行数值计算。使用关于 $(x_0,\\theta)=(0,0)$ 的中心有限差分来近似 $\\partial W_{\\perp}/\\partial x_0$ 和 $\\partial W_{\\perp}/\\partial \\theta$，并验证它们在指定的相对容差范围内分别与 $K_0(s;L)$ 和 $K_1(s;L)$ 相匹配。\n\n任务 4（与对准容差建立联系）：给定在选定间距 $s$ 处归一化横向尾场的最大允许量值 $W_{\\max}$，通过反转一阶模型计算对准容差：当 $\\theta=0$ 时，计算使 $|W_{\\perp}(s;x_0,0)| \\le W_{\\max}$ 成立的最大 $|x_0|$；当 $x_0=0$ 时，计算使 $|W_{\\perp}(s;0,\\theta)| \\le W_{\\max}$ 成立的最大 $|\\theta|$。将两种容差均表示为无量纲数（偏移量使用与 $x_0$ 相同的归一化单位，倾斜角以弧度为单位）。\n\n数值规格和测试套件：\n- 使用归一化参数 $a=1, c=1$，衰减 $\\gamma = 0.05$，径向模式数 $N_r=6$，轴向模式数 $N_z=5$（即 $p=0,1,2,3,4$）。\n- 使用中心差分微扰 $\\delta_x = 10^{-4}$ 和 $\\delta_{\\theta} = 10^{-4}$（弧度）在 $(x_0,\\theta)=(0,0)$ 处数值近似导数。\n- 对每种情况，按如下方式评估相对误差\n$$\n\\varepsilon_x \\;=\\; \\frac{\\big|K_0(s;L) - \\big(\\partial W_{\\perp}/\\partial x_0\\big)_{\\text{num}}\\big|}{\\max\\{10^{-14},\\,|K_0(s;L)|\\}},\\quad\n\\varepsilon_{\\theta} \\;=\\; \\frac{\\big|K_1(s;L) - \\big(\\partial W_{\\perp}/\\partial \\theta\\big)_{\\text{num}}\\big|}{\\max\\{10^{-14},\\,|K_1(s;L)|\\}}.\n$$\n- 如果 $\\varepsilon_x$ 和 $\\varepsilon_{\\theta}$ 均严格小于 $10^{-4}$，则宣布该情况的线性检验“通过”。\n- 使用以下 $(L,s)$ 对的测试套件：\n  1. $(L,s)=(1,\\,0.2)$\n  2. $(L,s)=(1,\\,1)$\n  3. $(L,s)=(2,\\,1)$\n  4. $(L,s)=(1,\\,5)$\n- 对于容差计算，设置 $W_{\\max} = 0.05$ 并在 $(L,s)=(1,\\,1)$ 处评估容差。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，结果按以下顺序排列：\n  - 四个布尔值（每个测试用例一个），表示线性检验是否通过。\n  - 在 $(L,s)=(1,\\,1)$ 处的两个对准容差：首先是当 $\\theta=0$ 时的最大 $|x_0|$，然后是当 $x_0=0$ 时的最大 $|\\theta|$。\n- 例如，输出应类似于 $[{\\tt True},{\\tt True},{\\tt True},{\\tt True},x_{\\text{tol}},\\theta_{\\text{tol}}]$，其中 $x_{\\text{tol}}$ 和 $\\theta_{\\text{tol}}$ 是十进制数。角度以弧度为单位；所有其他量均为上述定义的归一化单位下的无量纲量。",
            "solution": "问题陈述经过严格审查，被认定为有效。它在科学上基于计算电磁学和加速器物理学的原理，自洽地提供了所有必要的参数，并且是适定问题，可导出一个唯一且可验证的解。所列出的任务从理论推导到数值验证和实际应用，构成了一个逻辑递进的过程。\n\n将按顺序解决这四个任务。\n\n### 任务 1：一阶展开的论证\n\n横向尾场函数 $W_{\\perp}(s;x_0,\\theta)$ 量化了测试粒子因源电荷产生的场而受到的横向踢。这些电磁场由线性的麦克斯韦方程组控制。这些场的源是沿轨迹 $x(z) = x_0 + \\theta \\,(z - L/2)$ 移动的电荷的电流分布。对于微小的横向偏移 $x_0$ 和微小的倾斜角 $\\theta$，源电流可以围绕中心轴 $x=0$ 展开为泰勒级数。由于场方程的线性，所产生的场以及尾场函数也必须能够相应地对源坐标 $x_0$ 和 $\\theta$ 进行泰勒级数展开。\n\n对于一个圆柱对称的结构，一个完全沿轴线（$x_0=0, \\theta=0$）运动的电荷由于对称性不能激发偶极（$m=1$）模式。因此，对于轴上的源，偶极尾场函数必须为零：$W_{\\perp}(s;0,0) = 0$。$W_{\\perp}$ 在 $(x_0, \\theta)=(0,0)$ 附近的泰勒展开因此给出：\n$$\nW_{\\perp}(s;x_0,\\theta) = W_{\\perp}(s;0,0) + x_0 \\frac{\\partial W_{\\perp}}{\\partial x_0}\\bigg|_{(0,0)} + \\theta \\frac{\\partial W_{\\perp}}{\\partial \\theta}\\bigg|_{(0,0)} + \\mathcal{O}(x_0^2, \\theta^2, x_0\\theta)\n$$\n由于 $W_{\\perp}(s;0,0)=0$，对于足够小的 $x_0$ 和 $\\theta$，尾场可以很好地由一阶项近似：\n$$\nW_{\\perp}(s;x_0,\\theta) \\approx x_0\\,K_0(s;L) + \\theta\\,K_1(s;L)\n$$\n其中线性响应系数是在原点处求值的偏导数：\n$$\nK_0(s;L) = \\frac{\\partial W_{\\perp}}{\\partial x_0}\\bigg|_{(0,0)} \\quad \\text{和} \\quad K_1(s;L) = \\frac{\\partial W_{\\perp}}{\\partial \\theta}\\bigg|_{(0,0)}\n$$\n这种线性是线性场论所体现的物理原理的直接结果，并由 Panofsky-Wenzel 定理进一步支持，该定理将横向尾场与纵向尾场的梯度联系起来。\n\n这个结论也可以直接从为 $W_{\\perp}$ 提供的模式求和表达式中得出。对轨迹 $x(z)$ 的依赖完全包含在贝塞尔函数 $J_1(k_{r,n}x(z))$ 的宗量中。对于小宗量 $u$，贝塞尔函数 $J_1(u)$ 的主导阶展开为 $J_1(u) \\approx u/2$。给定小的 $x_0$ 和 $\\theta$，宗量 $k_{r,n}x(z)$ 很小，我们可以近似为：\n$$\nJ_1\\big(k_{r,n}\\,x(z)\\big) \\approx \\frac{1}{2} k_{r,n}\\,x(z) = \\frac{1}{2}k_{r,n}\\big(x_0 + \\theta(z-L/2)\\big)\n$$\n将此线性近似代入 $W_{\\perp}$ 的积分中，直接产生一个在 $x_0$ 和 $\\theta$ 上线性的表达式，从而证实了 $x_0\\,K_0(s;L) + \\theta\\,K_1(s;L)$ 的结构。\n\n### 任务 2：推导 $K_0$ 和 $K_1$ 的闭式模式求和表达式\n\n使用一阶近似 $J_1(u) \\approx u/2$，我们将其代入 $W_{\\perp}(s;x_0,\\theta)$ 的定义中：\n$$\nW_{\\perp} \\approx \\sum_{n=1}^{N_r} \\sum_{p=0}^{N_z-1} k_{r,n} \\left[ \\int_{0}^{L} \\frac{1}{2}k_{r,n}\\big(x_0 + \\theta(z-L/2)\\big) \\cos(k_{z,p}z) dz \\right] \\cos(\\omega_{n,p}s)e^{-\\gamma s}\n$$\n我们可以分离与 $x_0$ 和 $\\theta$ 成比例的项：\n$$\nW_{\\perp} \\approx x_0 \\left( \\frac{e^{-\\gamma s}}{2} \\sum_{n,p} k_{r,n}^2 \\cos(\\omega_{n,p}s) \\int_0^L \\cos(k_{z,p}z) dz \\right) + \\theta \\left( \\frac{e^{-\\gamma s}}{2} \\sum_{n,p} k_{r,n}^2 \\cos(\\omega_{n,p}s) \\int_0^L (z-L/2)\\cos(k_{z,p}z) dz \\right)\n$$\n由此，我们通过计算两个轴向积分来确定 $K_0(s;L)$ 和 $K_1(s;L)$ 的表达式。\n\n**$K_0(s;L)$ 的积分：**\n积分为 $I_0(p,L) = \\int_0^L \\cos(k_{z,p}z)dz$，其中 $k_{z,p} = p\\pi/L$。\n- 对于 $p=0$，$k_{z,0}=0$。被积函数为 $\\cos(0)=1$，所以 $I_0(0,L) = \\int_0^L 1\\,dz = L$。\n- 对于 $p > 0$，积分为 $\\left[\\frac{\\sin(k_{z,p}z)}{k_{z,p}}\\right]_0^L = \\frac{\\sin(p\\pi)}{p\\pi/L} = 0$。\n因此，只有 $p=0$ 的模式对 $K_0$ 有贡献。对于 $p=0$，频率为 $\\omega_{n,0} = \\sqrt{k_{r,n}^2 + 0} = k_{r,n}$。\n将此代入 $x_0$ 的系数表达式中：\n$$\nK_0(s;L) = \\frac{e^{-\\gamma s}}{2} \\sum_{n=1}^{N_r} k_{r,n}^2 \\cos(k_{r,n}s) \\cdot L = \\frac{L}{2}e^{-\\gamma s} \\sum_{n=1}^{N_r} k_{r,n}^2 \\cos(k_{r,n}s)\n$$\n\n**$K_1(s;L)$ 的积分：**\n积分为 $I_1(p,L) = \\int_0^L (z-L/2)\\cos(k_{z,p}z)dz$。\n- 对于 $p=0$，$k_{z,0}=0$。被积函数为 $(z-L/2)$，所以 $I_1(0,L) = \\int_0^L (z-L/2)dz = \\left[\\frac{z^2}{2} - \\frac{Lz}{2}\\right]_0^L = (\\frac{L^2}{2} - \\frac{L^2}{2}) - 0 = 0$。\n- 对于 $p > 0$，我们使用分部积分法，令 $u=z-L/2$ 和 $dv=\\cos(k_{z,p}z)dz$：\n$$\nI_1(p,L) = \\left[(z-L/2)\\frac{\\sin(k_{z,p}z)}{k_{z,p}}\\right]_0^L - \\int_0^L \\frac{\\sin(k_{z,p}z)}{k_{z,p}}dz\n$$\n边界项在 $z=0$ 和 $z=L$ 处均为零（因为 $\\sin(0)=0$ 和 $\\sin(p\\pi)=0$）。剩余积分为：\n$$\n- \\frac{1}{k_{z,p}} \\left[-\\frac{\\cos(k_{z,p}z)}{k_{z,p}}\\right]_0^L = \\frac{1}{k_{z,p}^2} \\big(\\cos(p\\pi) - \\cos(0)\\big) = \\frac{(-1)^p - 1}{k_{z,p}^2}\n$$\n此表达式对于偶数 $p > 0$ 为零，对于奇数 $p$ 等于 $-2/k_{z,p}^2$。\n因此，只有奇数轴向模式（$p=1,3,5,...$）对 $K_1$ 有贡献。\n将此结果代入 $\\theta$ 的系数表达式中：\n$$\nK_1(s;L) = \\frac{e^{-\\gamma s}}{2} \\sum_{n=1}^{N_r} \\sum_{p=1,3,...}^{N_z-1} k_{r,n}^2 \\cos(\\omega_{n,p}s) \\left(\\frac{-2}{k_{z,p}^2}\\right)\n$$\n$$\nK_1(s;L) = -e^{-\\gamma s} \\sum_{n=1}^{N_r} \\sum_{p=1,3,...}^{N_z-1} \\frac{k_{r,n}^2}{k_{z,p}^2} \\cos(\\omega_{n,p}s)\n$$\n\n### 任务 3：线性的数值验证\n\n为了验证推导出的 $K_0$ 和 $K_1$ 的解析表达式，我们将它们与完整的、未经近似的尾场函数 $W_{\\perp}(s;x_0,\\theta)$ 的数值导数进行比较。数值导数使用围绕点 $(x_0,\\theta)=(0,0)$ 的二阶中心有限差分格式计算：\n$$\n\\left(\\frac{\\partial W_{\\perp}}{\\partial x_0}\\right)_{\\text{num}} = \\frac{W_{\\perp}(s; \\delta_x, 0) - W_{\\perp}(s; -\\delta_x, 0)}{2\\delta_x}\n$$\n$$\n\\left(\\frac{\\partial W_{\\perp}}{\\partial \\theta}\\right)_{\\text{num}} = \\frac{W_{\\perp}(s; 0, \\delta_\\theta) - W_{\\perp}(s; 0, -\\delta_\\theta)}{2\\delta_\\theta}\n$$\n这里，$\\delta_x = 10^{-4}$ 和 $\\delta_\\theta = 10^{-4}$ 是小微扰。函数 $W_{\\perp}(s;x_0,\\theta)$ 通过对问题陈述中提供的精确表达式对每个模式 $(n,p)$ 进行数值积分并求和贡献来计算。对空间积分 $z$ 使用高精度数值求积（例如 `scipy.integrate.quad`）。\n\n然后，通过计算指定的相对误差 $\\varepsilon_x$ 和 $\\varepsilon_{\\theta}$，将数值导数与解析结果 $K_0(s;L)$ 和 $K_1(s;L)$ 进行比较。如果两个相对误差都小于 $10^{-4}$ 的容差，则线性检验成功（通过）。\n\n### 任务 4：对准容差计算\n\n经过验证的一阶模型 $W_{\\perp}(s;x_0,\\theta) \\approx x_0\\,K_0(s;L) + \\theta\\,K_1(s;L)$ 可以被反转以确定对准容差。给定一个最大可容忍的尾场量值 $W_{\\max}$，我们可以找到最大允许的偏移量 $|x_0|$（假设零倾斜，$\\theta=0$）和最大允许的倾斜角 $|\\theta|$（假设零偏移，$x_0=0$）。\n\n对于偏移容差（$\\theta=0$）：\n$$\n|W_{\\perp}(s;x_0,0)| \\le W_{\\max} \\implies |x_0 K_0(s;L)| \\le W_{\\max} \\implies |x_0| \\le \\frac{W_{\\max}}{|K_0(s;L)|}\n$$\n偏移容差为 $x_{\\text{tol}} = W_{\\max} / |K_0(s;L)|$。\n\n对于倾斜容差（$x_0=0$）：\n$$\n|W_{\\perp}(s;0,\\theta)| \\le W_{\\max} \\implies |\\theta K_1(s;L)| \\le W_{\\max} \\implies |\\theta| \\le \\frac{W_{\\max}}{|K_1(s;L)|}\n$$\n倾斜容差为 $\\theta_{\\text{tol}} = W_{\\max} / |K_1(s;L)|$。\n\n这些计算是针对特定情况 $(L,s)=(1,1)$ 和 $W_{\\max}=0.05$ 进行的。所需的值 $K_0(1,1)$ 和 $K_1(1,1)$ 使用在任务 2 中推导的解析公式计算。\n\n所有数值计算的实现细节在最终答案代码中提供。这包括贝塞尔根的预计算、模式参数（$k_{r,n}, k_{z,p}, \\omega_{n,p}$）的计算、$W_\\perp$ 的数值评估、解析系数的计算以及最终的容差计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jn_zeros, j1\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the multi-part wakefield computation problem.\n    Task 1  2 are analytical derivations, implemented here.\n    Task 3 is numerical verification.\n    Task 4 is tolerance calculation.\n    \"\"\"\n\n    # Numerical specifications from the problem statement\n    a = 1.0\n    c = 1.0\n    gamma = 0.05\n    Nr = 6\n    Nz = 5\n    delta_x = 1e-4\n    delta_theta = 1e-4\n    rel_tol_threshold = 1e-4\n    W_max = 0.05\n\n    # Pre-compute Bessel roots and radial wavenumbers, which are geometry-independent\n    try:\n        # scipy.special.jn_zeros is the standard function for Bessel function roots\n        j1n_roots = jn_zeros(1, Nr)\n    except Exception as e:\n        # Fallback in case of environment issues, though unlikely.\n        # These are standard book values for J1(x)=0.\n        j1n_roots = np.array([3.83170597, 7.01558667, 10.17346814, 13.32369194, 16.47063005, 19.61585851])\n    \n    krn = j1n_roots / a\n    \n    # Use a class to manage L-dependent parameters to avoid recalculation\n    class PhysicsParameters:\n        def __init__(self, L):\n            self.L = L\n            self.p_indices = np.arange(Nz)\n            self.kzp = self.p_indices * np.pi / L\n            \n            # OMEGA_NP is a matrix of size (Nr, Nz)\n            self.omeganp = np.sqrt(np.add.outer(krn**2, self.kzp**2))\n\n    def compute_K0_analytical(s, L, params):\n        \"\"\"Computes the analytical coefficient K0 using the derived formula.\"\"\"\n        # Only p=0 mode contributes. For p=0, omeganp = krn.\n        omegan0 = params.omeganp[:, 0]\n        sum_terms = np.sum(krn**2 * np.cos(omegan0 * s))\n        K0 = (L / 2.0) * np.exp(-gamma * s) * sum_terms\n        return K0\n\n    def compute_K1_analytical(s, L, params):\n        \"\"\"Computes the analytical coefficient K1 using the derived formula.\"\"\"\n        K1 = 0.0\n        # Only odd p > 0 modes contribute. For Nz=5, p can be 0,1,2,3,4.\n        p_odd_indices = [p for p in range(1, Nz) if p % 2 != 0] # p = 1, 3\n        \n        for p in p_odd_indices:\n            kzp_val = params.kzp[p]\n            omeganp_p_col = params.omeganp[:, p]\n            # Sum over n for the current odd p\n            sum_n = np.sum(krn**2 * np.cos(omeganp_p_col * s))\n            K1 += sum_n / kzp_val**2\n            \n        K1 *= -np.exp(-gamma * s)\n        return K1\n\n    def compute_W_perp(s, L, x0, theta, params):\n        \"\"\"Computes the full wake function W_perp via numerical integration.\"\"\"\n        total_wake = 0.0\n        \n        for n_idx in range(Nr):\n            for p_idx in range(Nz):\n                current_krn = krn[n_idx]\n                current_kzp = params.kzp[p_idx]\n                current_omeganp = params.omeganp[n_idx, p_idx]\n                \n                # Define the integrand for numerical quadrature\n                def integrand(z):\n                    x_of_z = x0 + theta * (z - L / 2.0)\n                    return j1(current_krn * x_of_z) * np.cos(current_kzp * z)\n                \n                integral_val, _ = quad(integrand, 0, L, epsabs=1e-12, epsrel=1e-12)\n                \n                mode_contribution = current_krn * integral_val * np.cos(current_omeganp * s)\n                total_wake += mode_contribution\n                \n        return total_wake * np.exp(-gamma * s)\n\n    # Main logic starts here\n    test_cases = [\n        (1.0, 0.2), # Case 1\n        (1.0, 1.0), # Case 2\n        (2.0, 1.0), # Case 3\n        (1.0, 5.0), # Case 4\n    ]\n    results = []\n    \n    # Task 3: Perform linearity check for all test cases\n    for L, s in test_cases:\n        params = PhysicsParameters(L)\n        \n        # Calculate analytical coefficients\n        K0_an = compute_K0_analytical(s, L, params)\n        K1_an = compute_K1_analytical(s, L, params)\n        \n        # Calculate numerical derivatives using central differences\n        W_plus_x = compute_W_perp(s, L, delta_x, 0.0, params)\n        W_minus_x = compute_W_perp(s, L, -delta_x, 0.0, params)\n        K0_num = (W_plus_x - W_minus_x) / (2 * delta_x)\n        \n        W_plus_theta = compute_W_perp(s, L, 0.0, delta_theta, params)\n        W_minus_theta = compute_W_perp(s, L, 0.0, -delta_theta, params)\n        K1_num = (W_plus_theta - W_minus_theta) / (2 * delta_theta)\n        \n        # Calculate relative errors as specified\n        err_x = abs(K0_an - K0_num) / max(1e-14, abs(K0_an))\n        err_theta = abs(K1_an - K1_num) / max(1e-14, abs(K1_an))\n        \n        # Check if both errors are below the threshold\n        passed = (err_x  rel_tol_threshold) and (err_theta  rel_tol_threshold)\n        results.append(passed)\n\n    # Task 4: Compute alignment tolerances at (L,s)=(1,1)\n    L_tol, s_tol = 1.0, 1.0\n    params_tol = PhysicsParameters(L_tol)\n    \n    # Calculate K0 and K1 at the specified point\n    K0_tol = compute_K0_analytical(s_tol, L_tol, params_tol)\n    K1_tol = compute_K1_analytical(s_tol, L_tol, params_tol)\n    \n    # Invert the linear model to find tolerances\n    x_tol = W_max / abs(K0_tol)\n    theta_tol = W_max / abs(K1_tol)\n    \n    results.append(x_tol)\n    results.append(theta_tol)\n\n    # Final print statement in the exact required format.\n    # str() converts booleans to 'True'/'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}