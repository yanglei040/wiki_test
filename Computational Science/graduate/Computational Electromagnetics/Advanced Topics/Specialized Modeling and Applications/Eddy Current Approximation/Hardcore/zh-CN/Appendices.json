{
    "hands_on_practices": [
        {
            "introduction": "在深入研究计算方法之前，首先掌握其背后的物理原理和解析解是至关重要的。解析解不仅能提供深刻的物理洞察力，也是验证数值模拟准确性的黄金标准。本练习将引导你从麦克斯韦方程组出发，亲手推导涡流理论中的一个核心现象——趋肤效应，从而计算电磁场在导体内部的指数衰减规律以及表面功率损耗。",
            "id": "3303401",
            "problem": "一个均匀、各向同性、非磁化但导磁的导电半空间占据 $z>0$ 的区域，其电导率为 $\\sigma0$，磁导率为 $\\mu0$。$z0$ 的区域对导体内部的场没有影响，只是在平面 $z=0$ 处施加一个时谐的、空间均匀的切向磁场。具体而言，在时间依赖关系为 $\\exp(i \\omega t)$、角频率为 $\\omega0$ 的相量域中， $z=0$ 处的切向磁场被规定为 $\\mathbf{H}(x,y,0)=H_0 \\,\\hat{\\mathbf{x}}$，其中 $H_00$ 是一个实常数。在 $z>0$ 区域内没有外加源。假设在导体中涡流近似成立，即 $\\sigma \\gg \\omega \\epsilon$，因此在 $z>0$ 区域可以忽略位移电流。\n\n仅从麦克斯韦方程组和线性本构关系 $\\mathbf{B}=\\mu \\mathbf{H}$ 及 $\\mathbf{J}=\\sigma \\mathbf{E}$ 出发，并施加 $z=0$ 处的边界条件以及当 $z \\to +\\infty$ 时场保持有限的要求，完成以下任务：\n\n- 推导在 $z>0$ 区域内场的一维边值问题的控制方程，并求出深度剖面 $\\mathbf{H}(z)$ 的闭式表达式。\n- 使用第一性原理（坡印廷定理或直接焦耳热计算），计算由于导体内部的涡流而在 $z=0$ 表面单位面积上耗散的时间平均功率。\n\n用 $H_0$、$\\omega$、$\\mu$ 和 $\\sigma$ 表示你的最终答案。对于功率量，结果以 W/m$^2$ 为单位表示。在你的最终答案中，按顺序提供以下有序对：\n$[\\,H(z)\\text{ 作为乘以 } \\hat{\\mathbf{x}} \\text{ 的标量剖面},\\ \\text{单位面积上的时间平均耗散功率}\\,]$,\n不要进行任何数值代换或四舍五入；需要一个闭式解析表达式。",
            "solution": "该问题已经过验证，被认为是电磁学中一个适定且具有科学依据的问题。\n\n分析从一个无源区域（$J_{\\text{impressed}} = 0$, $\\rho_v = 0$）中，时间依赖关系为 $\\exp(i\\omega t)$ 的时谐场在相量域中的麦克斯韦方程组开始：\n$$ \\nabla \\times \\mathbf{E} = -i\\omega\\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + i\\omega\\mathbf{D} $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n$$ \\nabla \\cdot \\mathbf{D} = 0 $$\n在 $z>0$ 的均匀、各向同性介质中的线性本构关系是 $\\mathbf{B}=\\mu \\mathbf{H}$ 和 $\\mathbf{J}=\\sigma \\mathbf{E}$。问题陈述涡流近似成立，这意味着传导电流 $\\mathbf{J}$ 的幅值远大于位移电流 $i\\omega\\mathbf{D}$。这使我们能够忽略安培定律中的位移电流项，从而简化为：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} = \\sigma \\mathbf{E} $$\n为了推导磁场 $\\mathbf{H}$ 的控制方程，我们对简化后的安培定律取旋度：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{H}) = \\sigma (\\nabla \\times \\mathbf{E}) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{H}) = \\nabla(\\nabla \\cdot \\mathbf{H}) - \\nabla^2 \\mathbf{H}$ 并代入法拉第定律 $\\nabla \\times \\mathbf{E} = -i\\omega\\mathbf{B} = -i\\omega\\mu\\mathbf{H}$，方程变为：\n$$ \\nabla(\\nabla \\cdot \\mathbf{H}) - \\nabla^2 \\mathbf{H} = \\sigma(-i\\omega\\mu\\mathbf{H}) $$\n由 $\\nabla \\cdot \\mathbf{B} = 0$ 和均匀介质（$\\mu$ 是常数）中的本构关系 $\\mathbf{B}=\\mu\\mathbf{H}$ 可得 $\\nabla \\cdot \\mathbf{H}=0$。因此，$\\mathbf{H}$ 的方程简化为矢量亥姆霍兹方程：\n$$ \\nabla^2 \\mathbf{H} - i\\omega\\mu\\sigma \\mathbf{H} = 0 $$\n在平面 $z=0$ 处的边界条件为 $\\mathbf{H}(x,y,0) = H_0 \\hat{\\mathbf{x}}$。由于边界条件在 $x$ 和 $y$ 方向上是均匀的，且半空间是均匀的并在 $x-y$ 平面上无限延伸，因此场本身必须与 $x$ 和 $y$ 无关。因此，关于 $x$ 和 $y$ 的偏导数为零：$\\frac{\\partial}{\\partial x} = 0$ 和 $\\frac{\\partial}{\\partial y} = 0$。场仅是 $z$ 的函数。\n\n在这种一维变化下，$\\nabla^2 \\mathbf{H}$ 变为 $\\frac{d^2 \\mathbf{H}}{dz^2}$。条件 $\\nabla \\cdot \\mathbf{H} = 0$ 变为 $\\frac{dH_z}{dz} = 0$，这意味着 $H_z$ 是一个常数。为使场在 $z \\to \\infty$ 时保持有限，该常数必须为 $0$，所以 $H_z(z)=0$。矢量亥姆霍兹方程解耦为分量形式：\n$$ \\frac{d^2 H_x}{dz^2} - i\\omega\\mu\\sigma H_x = 0 $$\n$$ \\frac{d^2 H_y}{dz^2} - i\\omega\\mu\\sigma H_y = 0 $$\n我们定义一个复传播常数 $\\gamma$，使得 $\\gamma^2 = i\\omega\\mu\\sigma$。那么 $\\gamma = \\sqrt{i\\omega\\mu\\sigma}$。我们可以写出 $\\sqrt{i} = \\exp(i\\pi/4) = \\cos(\\pi/4) + i\\sin(\\pi/4) = \\frac{1+i}{\\sqrt{2}}$。因此，\n$$ \\gamma = \\sqrt{\\omega\\mu\\sigma} \\frac{1+i}{\\sqrt{2}} = (1+i)\\sqrt{\\frac{\\omega\\mu\\sigma}{2}} $$\n$\\gamma$ 的实部 $\\text{Re}\\{\\gamma\\} = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}$ 是正的。控制常微分方程(ODE)为 $\\frac{d^2 H_x}{dz^2} - \\gamma^2 H_x = 0$ 和 $\\frac{d^2 H_y}{dz^2} - \\gamma^2 H_y = 0$。通解为：\n$$ H_x(z) = C_1 \\exp(-\\gamma z) + C_2 \\exp(\\gamma z) $$\n$$ H_y(z) = C_3 \\exp(-\\gamma z) + C_4 \\exp(\\gamma z) $$\n当 $z \\to \\infty$ 时场必须保持有限的边界条件要求随 $z$ 指数增长的项的系数必须为零。由于 $\\text{Re}\\{\\gamma\\}  0$，项 $\\exp(\\gamma z)$ 无界增长。因此，我们必须有 $C_2=0$ 和 $C_4=0$。\n解必须具有 $H_x(z) = C_1 \\exp(-\\gamma z)$ 和 $H_y(z) = C_3 \\exp(-\\gamma z)$ 的形式。\n应用 $z=0$ 处的边界条件 $\\mathbf{H}(0) = H_0 \\hat{\\mathbf{x}}$，我们得到 $H_x(0) = H_0$ 和 $H_y(0) = 0$。\n$$ H_x(0) = C_1 = H_0 $$\n$$ H_y(0) = C_3 = 0 $$\n所以，在导体中处处有 $H_y(z)=0$。磁场纯粹在 $\\hat{\\mathbf{x}}$ 方向上：\n$$ \\mathbf{H}(z) = H_0 \\exp(-\\gamma z) \\hat{\\mathbf{x}} = H_0 \\exp\\left(-(1+i)\\sqrt{\\frac{\\omega\\mu\\sigma}{2}} z\\right) \\hat{\\mathbf{x}} $$\n乘以 $\\hat{\\mathbf{x}}$ 的标量剖面是 $H_x(z) = H_0 \\exp\\left(-(1+i)\\sqrt{\\frac{\\omega\\mu\\sigma}{2}} z\\right)$。\n\n接下来，我们计算单位表面积上的时间平均耗散功率。这等于在 $z=0$ 表面单位面积流入导体的功率。这由在 $z=0$ 处计算的时间平均坡印廷矢量 $\\langle \\mathbf{S} \\rangle = \\frac{1}{2}\\text{Re}\\{\\mathbf{E} \\times \\mathbf{H}^*\\}$ 的法向分量给出。\n首先，我们从 $\\mathbf{E} = \\frac{1}{\\sigma}\\nabla\\times\\mathbf{H}$ 求出电场 $\\mathbf{E}$：\n$$ \\mathbf{E}(z) = \\frac{1}{\\sigma} \\nabla \\times \\left( H_x(z) \\hat{\\mathbf{x}} \\right) = \\frac{1}{\\sigma} \\left( \\hat{\\mathbf{y}} \\frac{d H_x}{dz} \\right) = \\frac{1}{\\sigma} \\frac{d}{dz} \\left( H_0 \\exp(-\\gamma z) \\right) \\hat{\\mathbf{y}} $$\n$$ \\mathbf{E}(z) = -\\frac{\\gamma H_0}{\\sigma} \\exp(-\\gamma z) \\hat{\\mathbf{y}} = -\\frac{\\gamma}{\\sigma} H_x(z) \\hat{\\mathbf{y}} $$\n复坡印廷矢量为：\n$$ \\mathbf{S}(z) = \\frac{1}{2} \\mathbf{E}(z) \\times \\mathbf{H}^*(z) = \\frac{1}{2} \\left(-\\frac{\\gamma}{\\sigma} H_x(z) \\hat{\\mathbf{y}}\\right) \\times \\left(H_x^*(z) \\hat{\\mathbf{x}}\\right) $$\n其中 $H_x^*(z)$ 是 $H_x(z)$ 的复共轭。\n$$ \\mathbf{S}(z) = \\frac{1}{2}\\left(-\\frac{\\gamma}{\\sigma}\\right)|H_x(z)|^2 (\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{x}}) = \\frac{1}{2}\\left(-\\frac{\\gamma}{\\sigma}\\right)|H_x(z)|^2 (-\\hat{\\mathbf{z}}) = \\frac{\\gamma}{2\\sigma}|H_x(z)|^2 \\hat{\\mathbf{z}} $$\n时间平均功率流是 $\\langle \\mathbf{S}(z) \\rangle = \\text{Re}\\{\\mathbf{S}(z)\\}$。\n$$ \\langle \\mathbf{S}(z) \\rangle = \\text{Re}\\left\\{\\frac{\\gamma}{2\\sigma}|H_x(z)|^2 \\hat{\\mathbf{z}}\\right\\} = \\frac{1}{2\\sigma} |H_x(z)|^2 \\text{Re}\\{\\gamma\\} \\hat{\\mathbf{z}} $$\n单位面积耗散的功率 $P_{\\text{diss}}$ 是该矢量在 $z=0$ 处 z 分量的幅值：\n$$ P_{\\text{diss}} = \\langle S_z \\rangle|_{z=0} = \\frac{1}{2\\sigma} |H_x(0)|^2 \\text{Re}\\{\\gamma\\} $$\n由于 $H_x(0) = H_0$ 且 $\\text{Re}\\{\\gamma\\} = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}$，我们有：\n$$ P_{\\text{diss}} = \\frac{H_0^2}{2\\sigma} \\sqrt{\\frac{\\omega\\mu\\sigma}{2}} = \\frac{H_0^2}{2} \\sqrt{\\frac{\\omega\\mu\\sigma}{2\\sigma^2}} = \\frac{H_0^2}{2} \\sqrt{\\frac{\\omega\\mu}{2\\sigma}} $$\n答案的有序对是标量磁场剖面和单位面积上的时间平均耗散功率。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} H_0 \\exp\\left(-(1+i)\\sqrt{\\frac{\\omega\\mu\\sigma}{2}} z\\right)  \\frac{H_0^2}{2} \\sqrt{\\frac{\\omega\\mu}{2\\sigma}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了趋肤效应的解析解之后，下一步便是将其与数值解进行对比，这是计算电磁学中的一项基本技能。本练习旨在将理论付诸实践，要求你使用有限差分法（FDM）编写一个程序来求解一维涡流问题，并与先前推导的解析解进行比较。通过计算误差和分析收敛阶，你将学会如何系统地验证数值模型的正确性。",
            "id": "3303377",
            "problem": "考虑一个占据半空间 $z \\ge 0$ 的平面、均匀、各向同性的线性导体，其空间坐标 $z$ 的单位为米。假设场为时谐场，角频率为 $\\omega$（单位为弧度/秒），使得电场 $\\mathbf{E}(\\mathbf{r},t)$ 和磁场 $\\mathbf{H}(\\mathbf{r},t)$ 的形式为 $\\mathbf{E}(\\mathbf{r},t) = \\Re\\{\\mathbf{E}(\\mathbf{r}) e^{i \\omega t}\\}$ 和 $\\mathbf{H}(\\mathbf{r},t) = \\Re\\{\\mathbf{H}(\\mathbf{r}) e^{i \\omega t}\\}$。在涡流近似下，位移电流被忽略，因此传导电流占主导地位，本构关系为 $\\mathbf{J} = \\sigma \\mathbf{E}$ 和 $\\mathbf{B} = \\mu \\mathbf{H}$，其中 $\\sigma$ 是电导率（单位为西门子/米），$\\mu$ 是磁导率（单位为亨利/米）。从麦克斯韦旋度方程 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$ 和 $\\nabla \\times \\mathbf{E} = - i \\omega \\mathbf{B}$ 出发，推导一个仅在 $z$ 方向上变化的切向磁场的控制方程，其中 $\\mathbf{H}(z) = H_x(z) \\hat{\\mathbf{x}}$ 和 $\\mathbf{E}(z) = E_y(z) \\hat{\\mathbf{y}}$，并且参数 $\\sigma$ 和 $\\mu$ 是均匀的。\n\n对于旨在近似半空间的有限计算域 $z \\in [0,L]$，施加边界条件 $H_x(0) = H_s$ 和 $H_x(L) = 0$。量 $H_s$ 是一个实值的表面磁场振幅（单位为安培/米），$L$ 是截断深度（单位为米）。在 $z \\in [0,L]$ 上使用均匀网格间距，对推导出的常微分方程实施二阶有限差分法（FDM）离散化，强制执行指定的狄利克雷边界条件，并求解得到的线性系统，以获得内部节点上 $H_x(z)$ 的复值离散近似解。\n\n定义对应于半空间趋肤效应的解析参考解，该解是通过求解连续控制方程得到的，其边界条件为 $H_x(z) \\to 0$ 当 $z \\to +\\infty$，而不是有限域截断。使用此解析解为在内部节点上评估的数值解定义以下误差范数：\n$$\n\\varepsilon_{L^2} = \\frac{\\left( \\int_{0}^{L} \\left| H_x^{\\mathrm{num}}(z) - H_x^{\\mathrm{ref}}(z) \\right|^2 \\, dz \\right)^{1/2}}{\\left( \\int_{0}^{L} \\left| H_x^{\\mathrm{ref}}(z) \\right|^2 \\, dz \\right)^{1/2}},\n$$\n并使用均匀网格的矩形法来近似积分。使用具有 $N$ 个内部节点的三个级别的网格细化，计算误差 $\\varepsilon_{L^2}(N)$ 并估计观察到的收敛阶\n$$\np(N \\to 2N) = \\frac{\\log\\left(\\varepsilon_{L^2}(N) / \\varepsilon_{L^2}(2N)\\right)}{\\log(2)}.\n$$\n\n您的程序必须实现上述数值过程，并与半空间趋肤效应的解析解进行比较。所有量都应使用国际单位制表示。最终输出是无量纲的实数。程序必须评估以下测试套件并产生指定的输出：\n\n- 测试用例 1（理想路径，适中的趋肤深度和足够的截断）：$\\sigma = 5.8 \\times 10^{7} \\, \\mathrm{S/m}$，$\\mu = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$，$\\omega = 2\\pi \\times 60 \\, \\mathrm{rad/s}$， $L = 5.0 \\times 10^{-2} \\, \\mathrm{m}$，$H_s = 1.0 \\, \\mathrm{A/m}$，以及内部节点数 $N \\in \\{64, 128, 256\\}$。\n- 测试用例 2（边界条件主导区域，相对于 $L$ 的趋肤深度非常大）：$\\sigma = 1.0 \\times 10^{4} \\, \\mathrm{S/m}$，$\\mu = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$，$\\omega = 2\\pi \\times 60 \\, \\mathrm{rad/s}$， $L = 2.0 \\times 10^{-1} \\, \\mathrm{m}$，$H_s = 1.0 \\, \\mathrm{A/m}$，以及内部节点数 $N \\in \\{64, 128, 256\\}$。\n- 测试用例 3（趋肤深度很薄，需要高分辨率）：$\\sigma = 5.8 \\times 10^{7} \\, \\mathrm{S/m}$，$\\mu = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$，$\\omega = 2\\pi \\times 10^{5} \\, \\mathrm{rad/s}$， $L = 1.0 \\times 10^{-2} \\, \\mathrm{m}$，$H_s = 1.0 \\, \\mathrm{A/m}$，以及内部节点数 $N \\in \\{64, 128, 256\\}$。\n\n对于每个测试用例，计算列表 $[\\varepsilon_{L^2}(64), \\varepsilon_{L^2}(128), \\varepsilon_{L^2}(256), p(128 \\to 256)]$。您的程序应生成单行输出，其中包含所有三个测试用例的汇总结果，格式为一个用方括号括起来的逗号分隔列表，其中每个元素本身是一个没有空格的逗号分隔列表，例如，$[[e_1^{(64)},e_1^{(128)},e_1^{(256)},p_1],[e_2^{(64)},e_2^{(128)},e_2^{(256)},p_2],[e_3^{(64)},e_3^{(128)},e_3^{(256)},p_3]]$。输出必须是十进制数。不应打印任何额外文本。",
            "solution": "根据既定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **物理系统**：位于半空间 $z \\ge 0$ 的平面、均匀、各向同性的线性导体。\n- **场**：时谐形式，$\\mathbf{F}(\\mathbf{r},t) = \\Re\\{\\mathbf{F}(\\mathbf{r}) e^{i \\omega t}\\}$，其中 $\\mathbf{F}$ 是 $\\mathbf{E}$ 或 $\\mathbf{H}$。\n- **近似**：涡流近似（忽略位移电流）。\n- **本构关系**：$\\mathbf{J} = \\sigma \\mathbf{E}$，$\\mathbf{B} = \\mu \\mathbf{H}$。\n- **参数**：$\\sigma$（电导率），$\\mu$（磁导率），$\\omega$（角频率）。\n- **控制方程**：$\\nabla \\times \\mathbf{H} = \\mathbf{J}$，$\\nabla \\times \\mathbf{E} = - i \\omega \\mathbf{B}$。\n- **场结构**：$\\mathbf{H}(z) = H_x(z) \\hat{\\mathbf{x}}$，$\\mathbf{E}(z) = E_y(z) \\hat{\\mathbf{y}}$。\n- **计算域**：$z \\in [0,L]$，用于近似半空间。\n- **边界条件（数值问题）**：$H_x(0) = H_s$，$H_x(L) = 0$。$H_s$ 是一个实值振幅。\n- **数值方法**：在具有 $N$ 个内部节点的均匀网格上使用二阶有限差分法（FDM）。\n- **参考解**：半空间问题的解析解，其边界条件为当 $z \\to +\\infty$ 时 $H_x(z) \\to 0$。\n- **误差度量**：相对 $L^2$ 范数，$\\varepsilon_{L^2} = \\frac{\\left( \\int_{0}^{L} \\left| H_x^{\\mathrm{num}}(z) - H_x^{\\mathrm{ref}}(z) \\right|^2 \\, dz \\right)^{1/2}}{\\left( \\int_{0}^{L} \\left| H_x^{\\mathrm{ref}}(z) \\right|^2 \\, dz \\right)^{1/2}}$，其中积分通过均匀网格的矩形法近似。\n- **收敛性分析**：观察到的收敛阶为 $p(N \\to 2N) = \\frac{\\log\\left(\\varepsilon_{L^2}(N) / \\varepsilon_{L^2}(2N)\\right)}{\\log(2)}$。\n- **测试用例**：\n  1. $\\sigma = 5.8 \\times 10^{7} \\, \\mathrm{S/m}$，$\\mu = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$，$\\omega = 2\\pi \\times 60 \\, \\mathrm{rad/s}$，$L = 5.0 \\times 10^{-2} \\, \\mathrm{m}$，$H_s = 1.0 \\, \\mathrm{A/m}$，$N \\in \\{64, 128, 256\\}$。\n  2. $\\sigma = 1.0 \\times 10^{4} \\, \\mathrm{S/m}$，$\\mu = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$，$\\omega = 2\\pi \\times 60 \\, \\mathrm{rad/s}$，$L = 2.0 \\times 10^{-1} \\, \\mathrm{m}$，$H_s = 1.0 \\, \\mathrm{A/m}$，$N \\in \\{64, 128, 256\\}$。\n  3. $\\sigma = 5.8 \\times 10^{7} \\, \\mathrm{S/m}$，$\\mu = 4\\pi \\times 10^{-7} \\, \\mathrm{H/m}$，$\\omega = 2\\pi \\times 10^{5} \\, \\mathrm{rad/s}$，$L = 1.0 \\times 10^{-2} \\, \\mathrm{m}$，$H_s = 1.0 \\, \\mathrm{A/m}$，$N \\in \\{64, 128, 256\\}$。\n- **输出**：对于每个测试用例，计算 $[\\varepsilon_{L^2}(64), \\varepsilon_{L^2}(128), \\varepsilon_{L^2}(256), p(128 \\to 256)]$。将结果汇总为单个逗号分隔的列表之列表。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学基础**：该问题基于麦克斯韦方程组和公认的涡流近似，这是电磁学中的一个标准课题。物理设置、本构关系和边界条件是分析趋肤效应的标准方法。\n- **适定性**：该问题需要求解一个带有两个狄利克雷边界条件的二阶常微分方程，这构成了一个适定的边值问题。后续的数值分析，包括 FDM 离散化和误差收敛性研究，都是标准且定义明确的程序。\n- **客观性**：问题使用精确、无歧义的数学和物理术语陈述。所有参数和要求都已定量指定。\n- **完整性和一致性**：为每个测试用例提供了所有必要的数据（$\\sigma, \\mu, \\omega, L, H_s, N$）。定义、方程和条件是自洽的，没有矛盾。该问题没有表现出验证标准中列出的任何缺陷。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将制定一个合理的解决方案。\n\n解决过程包括四个主要阶段：1) 推导控制微分方程，2) 推导解析参考解，3) 构建有限差分数值格式，以及 4) 定义误差分析程序。\n\n**1. 控制方程推导**\n我们从涡流近似下的时谐麦克斯韦旋度方程开始：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} $$\n$$ \\nabla \\times \\mathbf{E} = -i \\omega \\mathbf{B} $$\n使用线性、各向同性、均匀的本构关系 $\\mathbf{J} = \\sigma \\mathbf{E}$ 和 $\\mathbf{B} = \\mu \\mathbf{H}$，其中 $\\sigma$ 和 $\\mu$ 是常数，方程变为：\n$$ \\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} $$\n$$ \\nabla \\times \\mathbf{E} = -i \\omega \\mu \\mathbf{H} $$\n为了得到一个仅关于 $\\mathbf{H}$ 的方程，我们对第一个方程取旋度，并代入第二个方程：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{H}) = \\nabla \\times (\\sigma \\mathbf{E}) = \\sigma (\\nabla \\times \\mathbf{E}) = \\sigma (-i \\omega \\mu \\mathbf{H}) = -i \\omega \\mu \\sigma \\mathbf{H} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{H}) = \\nabla(\\nabla \\cdot \\mathbf{H}) - \\nabla^2 \\mathbf{H}$ 和磁场高斯定律 $\\nabla \\cdot \\mathbf{B} = 0$，对于均匀的 $\\mu$ 这意味着 $\\nabla \\cdot \\mathbf{H} = 0$，我们得到矢量亥姆霍兹方程：\n$$ \\nabla^2 \\mathbf{H} = i \\omega \\mu \\sigma \\mathbf{H} $$\n问题指明磁场形式为 $\\mathbf{H}(z) = H_x(z) \\hat{\\mathbf{x}}$，仅在 $z$ 方向上变化。在笛卡尔坐标系中，拉普拉斯算子 $\\nabla^2$ 简化为 $\\frac{d^2}{dz^2}$。因此，矢量方程简化为关于复振幅 $H_x(z)$ 的标量常微分方程（ODE）：\n$$ \\frac{d^2 H_x(z)}{dz^2} = i \\omega \\mu \\sigma H_x(z) $$\n这可以写成 $\\frac{d^2 H_x}{dz^2} - k^2 H_x = 0$，其中 $k^2 = i \\omega \\mu \\sigma$。\n\n**2. 解析参考解**\n对于半无限导体（$z \\ge 0$），物理边界条件是 $H_x(0) = H_s$ 以及场在无穷远处衰减为零的要求，$H_x(z) \\to 0$ 当 $z \\to \\infty$。该 ODE 的通解为 $H_x(z) = C_1 e^{kz} + C_2 e^{-kz}$。复波数为 $k = \\sqrt{i \\omega \\mu \\sigma}$。将 $i$ 写为 $e^{i\\pi/2}$，其主平方根为 $\\sqrt{i} = e^{i\\pi/4} = \\frac{1+i}{\\sqrt{2}}$。因此，$k$ 具有正实部：\n$$ k = \\sqrt{\\omega \\mu \\sigma} \\frac{1+i}{\\sqrt{2}} = \\frac{1+i}{\\delta} $$\n其中 $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$ 是经典趋肤深度。为了满足无穷远处的条件，必须消除随 $z$ 增长的项 $e^{kz}$，因此 $C_1=0$。在表面 $z=0$ 处应用边界条件，我们得到 $C_2 = H_s$。因此，解析参考解为：\n$$ H_x^{\\mathrm{ref}}(z) = H_s e^{-kz} = H_s e^{-(1+i)z/\\delta} $$\n\n**3. 有限差分法（FDM）离散化**\n我们在有限域 $z \\in [0,L]$ 上求解 ODE $\\frac{d^2 H_x}{dz^2} - k^2 H_x = 0$，其狄利克雷边界条件为 $H_x(0) = H_s$ 和 $H_x(L) = 0$。将该域离散为 $N+1$ 个宽度为 $\\Delta z = L / (N+1)$ 的均匀区间，得到 $N+2$ 个节点 $z_j = j \\Delta z$，其中 $j=0, 1, \\dots, N+1$。未知数是在 $N$ 个内部节点 $j=1, \\dots, N$ 处的复数值场值 $H_j \\approx H_x(z_j)$。\n二阶导数使用二阶中心差分格式进行近似：\n$$ \\frac{d^2 H_x}{dz^2} \\bigg|_{z_j} \\approx \\frac{H_{j-1} - 2H_j + H_{j+1}}{(\\Delta z)^2} $$\n将此式代入每个内部节点 $j=1, \\dots, N$ 的 ODE，得到一个包含 $N$ 个线性代数方程的系统：\n$$ \\frac{H_{j-1} - 2H_j + H_{j+1}}{(\\Delta z)^2} - k^2 H_j = 0 $$\n$$ H_{j-1} - (2 + k^2 (\\Delta z)^2) H_j + H_{j+1} = 0 $$\n对于 $j=1$，我们使用边界条件 $H_0 = H_s$：\n$$ -(2 + k^2 (\\Delta z)^2) H_1 + H_2 = -H_s $$\n对于 $j=N$，我们使用边界条件 $H_{N+1} = 0$：\n$$ H_{N-1} - (2 + k^2 (\\Delta z)^2) H_N = 0 $$\n这构成一个三对角线性系统 $\\mathbf{A}\\mathbf{H}^{\\mathrm{num}} = \\mathbf{b}$，其中 $\\mathbf{H}^{\\mathrm{num}} = [H_1, H_2, \\dots, H_N]^T$ 是内部节点处未知场值的向量。$N \\times N$ 矩阵 $\\mathbf{A}$ 和 $N \\times 1$ 向量 $\\mathbf{b}$ 为：\n$$\n\\mathbf{A} = \\begin{pmatrix}\nd   1      \\\\\n1   d   1   \\\\\n    \\ddots   \\ddots   \\ddots  \\\\\n     1   d   1 \\\\\n         1   d\n\\end{pmatrix},\n\\quad \\mathbf{b} = \\begin{pmatrix}\n-H_s \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n其中对角线元素为 $d = -(2 + k^2 (\\Delta z)^2)$。求解该系统以获得复数值向量 $\\mathbf{H}^{\\mathrm{num}}$。\n\n**4. 误差与收敛性分析**\n数值解的误差通过与解析参考解进行比较来量化。问题指定了 $L^2$ 误差范数 $\\varepsilon_{L^2}$，通过矩形法进行近似。“在内部节点上评估”这一短语表示比较应在 $N$ 个内部解点集上进行。这对应于计算解向量的离散相对 $l^2$-范数：\n$$ \\varepsilon_{L^2} \\approx \\frac{\\|\\mathbf{H}^{\\mathrm{num}} - \\mathbf{H}^{\\mathrm{ref}}_{\\text{interior}}\\|_2}{\\|\\mathbf{H}^{\\mathrm{ref}}_{\\text{interior}}\\|_2} = \\frac{\\left( \\sum_{j=1}^{N} |H_j - H_x^{\\mathrm{ref}}(z_j)|^2 \\right)^{1/2}}{\\left( \\sum_{j=1}^{N} |H_x^{\\mathrm{ref}}(z_j)|^2 \\right)^{1/2}} $$\n其中 $\\mathbf{H}^{\\mathrm{ref}}_{\\text{interior}}$ 是内部节点 $z_j, j=1, \\dots, N$ 处解析解值的向量。误差随网格细化而减小的速率，通过观察到的收敛阶 $p$ 来估计，该收敛阶使用两次连续网格细化（$N$ 和 $2N$）的误差计算得出：\n$$ p(N \\to 2N) = \\frac{\\log(\\varepsilon_{L^2}(N) / \\varepsilon_{L^2}(2N))}{\\log(2)} $$\n对于一个二阶 FDM 格式，我们期望 $p \\approx 2$，前提是离散化误差主导了将域从 $z \\in [0, \\infty)$ 截断到 $z \\in [0, L]$ 所引入的建模误差。\n\n实现将包含一个函数，该函数针对每个测试用例，遍历指定的 $N$ 值，构建并求解线性系统，计算与解析解的误差范数，并最终计算收敛阶。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print the results.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: Happy path, moderate skin depth\n        {'sigma': 5.8e7, 'mu': 4 * np.pi * 1e-7, 'omega': 2 * np.pi * 60, \n         'L': 5.0e-2, 'Hs': 1.0, 'N_values': [64, 128, 256]},\n        # Case 2: Boundary-condition-dominated, large skin depth\n        {'sigma': 1.0e4, 'mu': 4 * np.pi * 1e-7, 'omega': 2 * np.pi * 60, \n         'L': 2.0e-1, 'Hs': 1.0, 'N_values': [64, 128, 256]},\n        # Case 3: Thin skin depth, resolution challenge\n        {'sigma': 5.8e7, 'mu': 4 * np.pi * 1e-7, 'omega': 2 * np.pi * 1e5, \n         'L': 1.0e-2, 'Hs': 1.0, 'N_values': [64, 128, 256]},\n    ]\n    \n    all_results = []\n    for case in test_cases:\n        result_list = solve_one_case(\n            case['sigma'], case['mu'], case['omega'],\n            case['L'], case['Hs'], case['N_values']\n        )\n        all_results.append(result_list)\n    \n    # Format the final output string as specified\n    formatted_results = []\n    for res_list in all_results:\n        # Use a format specifier for consistent output\n        formatted_list = [f\"{x:.6f}\" if i  3 else f\"{x:.4f}\" for i, x in enumerate(res_list)]\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    final_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_string)\n\ndef solve_one_case(sigma, mu, omega, L, Hs, N_values):\n    \"\"\"\n    Solves the FDM problem for a single test case with multiple mesh refinements.\n    \n    Args:\n        sigma (float): Electrical conductivity in S/m.\n        mu (float): Magnetic permeability in H/m.\n        omega (float): Angular frequency in rad/s.\n        L (float): Truncation depth of the computational domain in m.\n        Hs (float): Surface magnetic field amplitude in A/m.\n        N_values (list of int): List of interior node counts for mesh refinement.\n        \n    Returns:\n        list: A list containing L2 errors for each N and the final order of convergence.\n              Format: [error_N1, error_N2, error_N3, p]\n    \"\"\"\n    \n    errors = []\n    k_squared = 1j * omega * mu * sigma\n    k = np.sqrt(k_squared) # Principal root, has Re(k) >= 0\n\n    for N in N_values:\n        # 1. Define mesh parameters\n        # N is the number of interior nodes\n        dz = L / (N + 1)\n        \n        # 2. Set up the tridiagonal linear system A*H_num = b\n        A = np.zeros((N, N), dtype=np.complex128)\n        b = np.zeros(N, dtype=np.complex128)\n        \n        diag_val = -(2.0 + k_squared * dz**2)\n        \n        # Populate matrix A\n        np.fill_diagonal(A, diag_val)\n        if N > 1:\n            off_diag_val = 1.0\n            # A is a symmetric tridiagonal matrix\n            np.fill_diagonal(A[1:, :-1], off_diag_val)\n            np.fill_diagonal(A[:-1, 1:], off_diag_val)\n\n        # Populate vector b\n        b[0] = -Hs\n        \n        # 3. Solve for the numerical solution at interior nodes\n        H_num = np.linalg.solve(A, b)\n        \n        # 4. Compute the analytic reference solution at interior nodes\n        z_interior = np.linspace(dz, L - dz, N)\n        H_ref = Hs * np.exp(-k * z_interior)\n        \n        # 5. Compute the relative L2 error norm\n        # The norm is computed over the interior nodes, as suggested by problem statement.\n        # This is equivalent to the relative l2 vector norm.\n        norm_diff = np.linalg.norm(H_num - H_ref)\n        norm_ref = np.linalg.norm(H_ref)\n        \n        # Avoid division by zero if reference solution is zero everywhere (not for these cases)\n        if norm_ref == 0:\n            error = 0.0 if norm_diff == 0.0 else np.inf\n        else:\n            error = norm_diff / norm_ref\n\n        errors.append(error)\n        \n    # 6. Calculate the observed order of convergence p for the last two refinements\n    # p(N -> 2N) = log(error(N)/error(2N)) / log(2)\n    # Check for non-positive errors to avoid log domain error\n    if errors[-2] > 0 and errors[-1] > 0:\n        p = np.log(errors[-2] / errors[-1]) / np.log(2.0)\n    else:\n        p = 0.0 # Or np.nan, but 0.0 is fine for output\n    \n    return errors + [p]\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "从一维模型到现实世界中复杂的三维问题，我们通常依赖于有限元法（FEM）。然而，FEM离散化会产生大规模的复数线性方程组 $(K + i \\omega M) \\boldsymbol{x} = \\boldsymbol{b}$，其求解往往成为计算的瓶颈。本练习聚焦于解决这一核心挑战，探讨如何为涡流问题的频域方程设计一个高效的预条件子，并通过分析算子的谱特性来论证其在不同网格尺寸和频率下的鲁棒性。",
            "id": "3303358",
            "problem": "考虑在有界、单连通的 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$ 上，具有齐次切向边界条件的频域涡流近似麦克斯韦方程组。假设介质为导体，其磁导率 $\\mu(\\boldsymbol{x})$ 和电导率 $\\sigma(\\boldsymbol{x})$ 为分片常数，并在 $\\Omega$ 中几乎处处满足 $0  \\mu_{\\min} \\leq \\mu(\\boldsymbol{x}) \\leq \\mu_{\\max}$ 和 $0  \\sigma_{\\min} \\leq \\sigma(\\boldsymbol{x}) \\leq \\sigma_{\\max}$。在使用矢量势公式和 $H(\\mathrm{curl})$协调有限元进行离散化时，对于角频率 $\\omega  0$ 下的复值未知向量 $\\boldsymbol{x} \\in \\mathbb{C}^n$，其离散线性系统为\n$$\n\\left( K + i \\,\\omega \\, M \\right) \\boldsymbol{x} = \\boldsymbol{b},\n$$\n其中 $K \\in \\mathbb{R}^{n \\times n}$ 是由双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v}) = \\int_{\\Omega} \\mu^{-1} \\, \\mathrm{curl}\\,\\boldsymbol{u} \\cdot \\mathrm{curl}\\,\\boldsymbol{v} \\, \\mathrm{d}\\boldsymbol{x}$ 导出的 curl–curl 刚度矩阵，而 $M \\in \\mathbb{R}^{n \\times n}$ 是由 $m(\\boldsymbol{u},\\boldsymbol{v}) = \\int_{\\Omega} \\sigma \\, \\boldsymbol{u} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\boldsymbol{x}$ 导出的质量矩阵。在 $H(\\mathrm{curl})$ 上，矩阵 $K$ 是对称半正定的，并具有与梯度场相关的非平凡核，而在所述假设下，矩阵 $M$ 是对称正定的。\n\n您计划使用一种适用于非埃尔米特矩阵的 Krylov 子空间方法（例如广义最小残差法 GMRES）来求解该系统，并且您必须选择一个右预条件子 $P$，该预条件子在计算上可以近似求逆（例如，通过多层方法），并且能够确保收敛性对于网格尺寸、频率和材料参数对比度具有稳健性。这种稳健性需要通过预处理算子的谱性质来证明，并使用植根于麦克斯韦方程组和所导出的双线性形式的基本原理进行论证。\n\n在所述假设下，以下哪种预处理策略在谱上是合理的，能够使得右预处理算子 $\\left( K + i \\,\\omega \\, M \\right) P^{-1}$ 的谱聚集在远离原点的区域，且这种聚集与网格无关、对频率稳健？\n\nA. 选择 $P = K + \\omega \\, M$，这是一个实数、对称正定的算子，并使用在 $H(\\mathrm{curl})$ 和 $L^2$ 中稳定的多层方法来近似 $P^{-1}$，理由是 $\\left( K + i \\,\\omega \\, M \\right) P^{-1}$ 的谱聚集在一个与网格尺寸和材料参数对比度无关的有界楔形区域内。\n\nB. 选择 $P = K$，理由是 curl–curl 的主导性确保了 $\\left( K + i \\,\\omega \\, M \\right) K^{-1}$ 的谱对所有 $\\omega$ 都是一致有界的，即使在 $\\sigma_{\\min}  0$ 固定且网格细化的情况下也是如此。\n\nC. 选择 $P = M$，理由是质量矩阵控制着低频行为，因此 $\\left( K + i \\,\\omega \\, M \\right) M^{-1}$ 的谱具有独立于 $\\omega$ 和网格尺寸的一致有界性。\n\nD. 选择 $P = K + i \\,\\alpha \\, M$，其中 $\\alpha \\neq \\omega$ 是一个固定值，声称右预处理算子是埃尔米特正定的，因此可以应用共轭梯度法，并且谱对于所有 $\\omega$ 和网格都是一致聚集的。",
            "solution": "用户请求对一个计算电磁学问题进行分析。我将首先根据指定流程验证问题陈述，如果问题有效，则继续进行全面解答和选项评估。\n\n### 第 1 步：提取已知信息\n\n-   **物理问题**：频域涡流近似麦克斯韦方程组。\n-   **域**：有界、单连通的 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$。\n-   **边界条件**：齐次切向边界条件。\n-   **材料属性**：介质为导体，具有分片常数磁导率 $\\mu(\\boldsymbol{x})$ 和电导率 $\\sigma(\\boldsymbol{x})$。\n-   **参数界**：在 $\\Omega$ 中几乎处处满足 $0  \\mu_{\\min} \\leq \\mu(\\boldsymbol{x}) \\leq \\mu_{\\max}$ 和 $0  \\sigma_{\\min} \\leq \\sigma(\\boldsymbol{x}) \\leq \\sigma_{\\max}$。\n-   **角频率**：$\\omega  0$。\n-   **数值公式**：使用 $H(\\mathrm{curl})$协调有限元的矢量势公式。\n-   **离散线性系统**：$\\left( K + i \\,\\omega \\, M \\right) \\boldsymbol{x} = \\boldsymbol{b}$，其中未知向量为复值向量 $\\boldsymbol{x} \\in \\mathbb{C}^n$。\n-   **刚度矩阵 $K$**：$K \\in \\mathbb{R}^{n \\times n}$ 由双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v}) = \\int_{\\Omega} \\mu^{-1} \\, \\mathrm{curl}\\,\\boldsymbol{u} \\cdot \\mathrm{curl}\\,\\boldsymbol{v} \\, \\mathrm{d}\\boldsymbol{x}$ 导出。它是对称半正定的，其非平凡核对应于梯度场。\n-   **质量矩阵 $M$**：$M \\in \\mathbb{R}^{n \\times n}$ 由双线性形式 $m(\\boldsymbol{u},\\boldsymbol{v}) = \\int_{\\Omega} \\sigma \\, \\boldsymbol{u} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\boldsymbol{x}$ 导出。它是对称正定的。\n-   **目标**：寻找一个用于 Krylov 方法（如 GMRES）的右预条件子 $P$，该预条件子在计算上可以近似求逆，并能确保稳健的收敛性。\n-   **稳健性准则**：右预处理算子 $\\left( K + i \\,\\omega \\, M \\right) P^{-1}$ 的谱聚集在一个远离原点的有界区域内，且该区域独立于网格尺寸、频率 $\\omega$ 和材料参数对比度。\n\n### 第 2 步：使用提取的已知信息进行验证\n\n-   **科学依据**：问题陈述牢固地植根于计算电磁学和数值线性代数的理论。涡流近似、其使用矢量势的弱形式、使用 $H(\\mathrm{curl})$协调单元的离散化，以及最终得到的线性系统，都是标准且科学上合理的。刚度矩阵 ($K$) 和质量矩阵 ($M$) 的性质描述正确。为这类系统寻找稳健的预条件子是该领域的一个核心课题。\n-   **适定性**：问题是适定的。它要求在一组给定选项中确定一个在谱上合理的预处理策略。底层的连续和离散问题都是适定的（当 $\\omega  0$ 时，算子 $K + i\\omega M$ 是可逆的）。稳健性的标准（谱聚集独立于参数）是预条件子分析中的标准准则。\n-   **客观性**：问题以精确、客观和技术性的语言陈述，没有主观或模糊的术语。\n-   **完整性与一致性**：问题提供了对所提出的预处理算子进行谱分析所需的所有必要信息。矩阵的性质和预处理的目标都已明确说明。已知信息中没有矛盾之处。\n-   **现实性与可行性**：问题非常现实。它代表了开发用于时谐电磁学的有限元法（FEM）求解器时的一个常见挑战。所讨论的预处理策略代表了实践中和学术文献中考虑的那些策略。\n\n### 第 3 步：结论与行动\n\n问题陈述完全有效。它在科学上是合理的、适定的，并且是评估对偏微分方程高级数值方法理解的绝佳问题。我现在将着手解答。\n\n### 推导与选项分析\n\n目标是找到一个右预条件子 $P$，使得预处理算子 $A_P = \\left( K + i \\,\\omega \\, M \\right) P^{-1}$ 的谱聚集在复平面上一个远离原点的有界集合中，并且这种聚集独立于网格尺寸 $h$、频率 $\\omega$ 以及材料参数 $\\mu$ 和 $\\sigma$ 的对比度。\n\n$A_P$ 的谱是满足广义特征值问题的一组特征值 $\\lambda$：\n$$\n\\left( K + i \\,\\omega \\, M \\right) \\boldsymbol{v} = \\lambda P \\boldsymbol{v}\n$$\n对于某个非零特征向量 $\\boldsymbol{v} \\in \\mathbb{C}^n$。通过左乘共轭转置 $\\boldsymbol{v}^*$，我们可以将特征值表示为瑞利商：\n$$\n\\lambda = \\frac{\\boldsymbol{v}^* \\left( K + i \\,\\omega \\, M \\right) \\boldsymbol{v}}{\\boldsymbol{v}^* P \\boldsymbol{v}}\n$$\n由于 $K$ 和 $M$ 是实对称矩阵，如果 $\\boldsymbol{v}$ 是实数，则 $\\boldsymbol{v}^* K \\boldsymbol{v} = \\boldsymbol{v}^T K \\boldsymbol{v}$，但通常 $\\boldsymbol{v}$ 是复数。设 $\\boldsymbol{v} = \\boldsymbol{v}_R + i \\boldsymbol{v}_I$。那么 $\\boldsymbol{v}^* K \\boldsymbol{v} = (\\boldsymbol{v}_R^T K \\boldsymbol{v}_R + \\boldsymbol{v}_I^T K \\boldsymbol{v}_I) + i(\\boldsymbol{v}_R^T K \\boldsymbol{v}_I - \\boldsymbol{v}_I^T K \\boldsymbol{v}_R)$。因为 $K$ 是对称的，所以 $\\boldsymbol{v}_R^T K \\boldsymbol{v}_I = \\boldsymbol{v}_I^T K \\boldsymbol{v}_R$，因此 $\\boldsymbol{v}^* K \\boldsymbol{v}$ 是实数。类似地，$\\boldsymbol{v}^* M \\boldsymbol{v}$ 也是实数。\n我们定义非负二次型 $k(\\boldsymbol{v}) = \\boldsymbol{v}^* K \\boldsymbol{v} \\geq 0$ 和正常数二次型 $m(\\boldsymbol{v}) = \\boldsymbol{v}^* M \\boldsymbol{v}  0$。特征值表达式则为：\n$$\n\\lambda = \\frac{k(\\boldsymbol{v}) + i \\,\\omega \\, m(\\boldsymbol{v})}{\\boldsymbol{v}^* P \\boldsymbol{v}}\n$$\n我们现在将使用这个框架来分析每个选项。\n\n---\n**选项 A 的分析**\n\n提出的预条件子是 $P = K + \\omega \\, M$。由于 $K$ 是对称半正定的，$M$ 是对称正定的，且 $\\omega  0$，矩阵 $P$ 是对称正定的。它是一个实值算子。瑞利商中的分母是 $\\boldsymbol{v}^* P \\boldsymbol{v} = \\boldsymbol{v}^* (K + \\omega M) \\boldsymbol{v} = k(\\boldsymbol{v}) + \\omega \\, m(\\boldsymbol{v})$。\n特征值 $\\lambda$ 由下式给出：\n$$\n\\lambda = \\frac{k(\\boldsymbol{v}) + i \\,\\omega \\, m(\\boldsymbol{v})}{k(\\boldsymbol{v}) + \\omega \\, m(\\boldsymbol{v})}\n$$\n让我们分析这些特征值在复平面中的位置。设 $k = k(\\boldsymbol{v}) \\geq 0$ 和 $m = m(\\boldsymbol{v})  0$。\n$\\lambda$ 的实部和虚部分别是：\n$$\n\\mathrm{Re}(\\lambda) = \\frac{k}{k + \\omega \\, m}\n$$\n$$\n\\mathrm{Im}(\\lambda) = \\frac{\\omega \\, m}{k + \\omega \\, m}\n$$\n从这些表达式中，我们可以立即观察到几个性质：\n1.  由于 $k \\geq 0$ 和 $\\omega \\, m  0$，我们有 $0 \\leq \\mathrm{Re}(\\lambda) \\leq 1$ 和 $0  \\mathrm{Im}(\\lambda) \\leq 1$。\n2.  将实部和虚部相加得到：\n    $$\n    \\mathrm{Re}(\\lambda) + \\mathrm{Im}(\\lambda) = \\frac{k}{k + \\omega \\, m} + \\frac{\\omega \\, m}{k + \\omega \\, m} = \\frac{k + \\omega \\, m}{k + \\omega \\, m} = 1\n    $$\n这意味着所有特征值都位于复平面上连接点 $(1,0)$（当 $\\omega m / k \\to 0$ 时趋近）和点 $(0,1)$（当 $k / (\\omega m) \\to 0$ 时趋近）的线段上。具体来说，由于 $m  0$，我们有 $\\mathrm{Im}(\\lambda)  0$。对于 $K$ 的核中的向量，$k=0$，这给出 $\\lambda = i$。对于 $k \\gg \\omega m$ 的向量，$\\lambda \\approx 1$。\n因此，预处理算子的谱包含在连接 $1$ 和 $i$ 的线段内。这是一个紧集，远离原点（距离原点最近的点是 $i$，距离为 $1$，或者更一般地是点 $(\\frac{1}{2}, \\frac{1}{2})$，距离为 $\\frac{1}{\\sqrt{2}}$），并且这个位置完全独立于 $k$ 和 $m$ 的具体值，而 $k$ 和 $m$ 的值取决于特征向量、网格尺寸、频率和材料参数。因此，谱是完美聚集的。“有界楔形区域”这一短语是对这条线段的正确但略显笼统的描述。\n预条件子 $P = K + \\omega M$ 是一个实对称正定算子，存在稳健且高效的求解器（例如，专门的多重网格方法，如 AMS）。因此，它在计算上是可行的。\n\n**结论**：此选项中的推理是合理的，并能得到期望的稳健性。这是涡流方程的一个众所周知的稳健预处理策略。**正确**。\n\n---\n**选项 B 的分析**\n\n提出的预条件子是 $P = K$。算子 $K$ 是奇异的，这使其求逆是不适定的。通常必须使用伪逆或在商空间 $H(\\mathrm{curl})/\\nabla H^1$ 中进行操作。假设我们可以形式上继续，预处理算子是 $(K + i\\omega M)K^{-1} = I + i\\omega M K^{-1}$。\n特征值为 $\\lambda = 1 + i\\omega\\eta$，其中 $\\eta$ 是广义特征问题 $M\\boldsymbol{v} = \\eta K\\boldsymbol{v}$ 的特征值。\n特征值 $\\eta$ 不是一致有界的。特别是，用 $K$ 进行预处理解决了刚度项的问题，但没有正确地缩放质量项。项 $i\\omega M K^{-1}$ 代表了感应效应与电阻效应之比。对于高频，该项变得主导且数值巨大。特征值 $\\lambda$ 的虚部将与 $\\omega$ 成比例增长。因此，谱并非独立于频率 $\\omega$ 有界。此策略仅在低频极限（$\\omega \\to 0$）下有效，此时系统由 $K$ 主导。\n\n**结论**：断言谱对所有 $\\omega$ 都是一致有界的，这是错误的。**不正确**。\n\n---\n**选项 C 的分析**\n\n提出的预条件子是 $P = M$。质量矩阵 $M$ 是对称正定且良态的，因此其逆很容易近似。预处理算子是 $(K + i\\omega M)M^{-1} = K M^{-1} + i\\omega I$。\n特征值为 $\\lambda = \\xi + i\\omega$，其中 $\\xi$ 是广义特征问题 $K\\boldsymbol{v} = \\xi M\\boldsymbol{v}$ 的特征值。\n特征值 $\\xi$ 代表了 curl-curl 算子相对于 $L^2$ 内积的共振频率的平方。根据 $H(\\mathrm{curl})$ 单元的标准有限元理论，$K M^{-1}$ 的最大特征值 $\\xi_{\\max}$ 相对于网格细化是无界的；它通常按 $\\xi_{\\max} \\sim O(h^{-2})$ 的尺度变化，其中 $h$ 是网格尺寸参数。\n因此，特征值 $\\lambda$ 的实部散布在一个区间 $[0, \\xi_{\\max}]$ 上，该区间随着 $h \\to 0$ 无界增长。谱并非独立于网格尺寸有界。此策略仅在高频极限下有效，此时 $i\\omega I$ 项占主导地位。\n\n**结论**：断言谱独立于网格尺寸一致有界，这是错误的。**不正确**。\n\n---\n**选项 D 的分析**\n\n提出的预条件子是 $P = K + i \\,\\alpha \\, M$，其中 $\\alpha \\neq \\omega$ 是一个固定值。第一个论断是右预处理算子 $A_P = (K + i\\omega M)(K + i\\alpha M)^{-1}$ 是埃尔米特正定的。一个矩阵 $X$ 是埃尔米特矩阵，如果 $X = X^*$。我们来检查一下：\n$$\nA_P^* = \\left((K + i\\alpha M)^{-1}\\right)^* (K + i\\omega M)^* = (K^* - i\\alpha M^*)^{-1} (K^* - i\\omega M^*)\n$$\n因为 $K$ 和 $M$ 是实对称的，所以 $K^*=K^T=K$ 且 $M^*=M^T=M$。\n$$\nA_P^* = (K - i\\alpha M)^{-1} (K - i\\omega M)\n$$\n这显然通常不等于 $A_P = (K + i\\omega M)(K + i\\alpha M)^{-1}$。这些矩阵不可交换，所以顺序不能改变。算子是埃尔米特的论断是错误的。因此，仅限于埃尔米特正定系统的标准共轭梯度法不能应用。此选项中提出的整个理由都建立在一个数学上不正确的前提之上。\n\n**结论**：预处理算子是埃尔米特正定的论断是错误的。**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}