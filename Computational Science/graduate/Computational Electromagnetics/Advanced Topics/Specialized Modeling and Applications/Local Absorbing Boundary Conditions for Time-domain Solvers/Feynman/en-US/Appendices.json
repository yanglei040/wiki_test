{
    "hands_on_practices": [
        {
            "introduction": "The fundamental goal of an absorbing boundary condition (ABC) is to emulate an infinitely large, open region, thereby preventing non-physical reflections from the computational domain's edge. This is achieved by matching the impedance of the outgoing wave. This exercise () provides a quantitative foundation for ABC performance by tasking you with the derivation of the reflection coefficient at a boundary defined by a local impedance. Mastering this analysis is key to understanding and evaluating the effectiveness of any ABC implementation.",
            "id": "3324491",
            "problem": "Consider time-domain Maxwell equations in a homogeneous, isotropic, and non-dispersive medium with permittivity $\\varepsilon$ and permeability $\\mu$,\n$$\n\\nabla \\times \\mathbf{E}(\\mathbf{r},t) = - \\mu \\, \\frac{\\partial \\mathbf{H}(\\mathbf{r},t)}{\\partial t}, \\qquad\n\\nabla \\times \\mathbf{H}(\\mathbf{r},t) = \\varepsilon \\, \\frac{\\partial \\mathbf{E}(\\mathbf{r},t)}{\\partial t},\n$$\nwhere $\\mathbf{E}$ and $\\mathbf{H}$ are the electric and magnetic fields, respectively. The medium has intrinsic impedance $\\eta = \\sqrt{\\mu/\\varepsilon}$ and wave speed $c = 1/\\sqrt{\\mu \\varepsilon}$. A computational domain is truncated by a planar boundary at $z = 0$ with outward unit normal $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$. On this boundary, a local Silver–Müller-based absorbing boundary condition (ABC) is applied in the time domain, written as\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\, \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0,\n$$\nwhere $\\eta_{b}>0$ is a prescribed boundary impedance parameter, and the subscript ${t}$ denotes the tangential component of the field to the boundary.\n\nA linearly polarized plane wave of angular frequency $\\omega$ is normally incident on the boundary from within the computational domain, propagating in the $+\\hat{\\mathbf{z}}$ direction. Its electric field is\n$$\n\\mathbf{E}_{\\text{i}}(\\mathbf{r},t) = \\Re\\!\\left\\{\\mathbf{E}_{0} \\exp\\!\\big(-\\mathrm{i}\\omega t + \\mathrm{i} k z\\big)\\right\\}, \\quad \\mathbf{E}_{0} = E_{0}\\,\\hat{\\mathbf{x}}, \\quad k = \\frac{\\omega}{c},\n$$\nand the corresponding magnetic field satisfies the plane-wave relation $\\mathbf{H}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\mathbf{E}_{\\text{i}}$, where $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ is the unit propagation direction.\n\nAssuming a specular reflected plane wave is generated by the boundary, let $\\Gamma$ denote the complex reflection coefficient (ratio of the reflected to incident electric-field phasor amplitudes at $z=0$). Using only the governing equations and the boundary condition above, derive a closed-form expression for $\\Gamma$ in terms of $\\eta$ and $\\eta_{b}$. Express the final reflection coefficient as a dimensionless complex amplitude. No numerical rounding is required, and no physical units should be included in the final answer.",
            "solution": "The problem is well-posed and scientifically sound, based on fundamental principles of electromagnetism and standard practices in computational electromagnetics. We may proceed with the solution.\n\nThe problem asks for the complex reflection coefficient $\\Gamma$ for a normally incident plane wave on a boundary defined by a Silver-Müller-type absorbing boundary condition (ABC). The analysis is best performed in the frequency domain using complex phasors.\n\nFirst, we represent the incident and reflected waves in phasor form. The time-domain fields are related to their phasor counterparts $\\tilde{\\mathbf{E}}(\\mathbf{r})$ and $\\tilde{\\mathbf{H}}(\\mathbf{r})$ by $\\mathbf{E}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{E}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$ and $\\mathbf{H}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{H}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$, where $\\mathrm{i}$ is the imaginary unit.\n\nThe incident electric field phasor, propagating in the $+\\hat{\\mathbf{z}}$ direction, is given by\n$$\n\\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) = \\mathbf{E}_{0} \\exp(\\mathrm{i} k z) = E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\nwhere $k = \\omega/c$ is the wavenumber. The corresponding incident magnetic field phasor is found using the plane-wave relationship $\\tilde{\\mathbf{H}}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\tilde{\\mathbf{E}}_{\\text{i}}$, where $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ is the direction of propagation and $\\eta = \\sqrt{\\mu/\\varepsilon}$ is the intrinsic impedance of the medium.\n$$\n\\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) = \\frac{1}{\\eta} \\hat{\\mathbf{z}} \\times \\big( E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\nNext, we define the reflected wave, which is assumed to be a specular plane wave. For normal incidence on a planar boundary at $z=0$, the reflected wave propagates in the $-\\hat{\\mathbf{z}}$ direction. The reflection coefficient $\\Gamma$ is the ratio of the reflected electric field phasor amplitude to the incident electric field phasor amplitude at the boundary $z=0$. The reflected electric field phasor is thus\n$$\n\\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\nWe have assumed the polarization of the reflected electric field is the same as the incident one, which is expected for this isotropic boundary condition. The corresponding reflected magnetic field phasor is found using the plane-wave relationship for a wave propagating in the $\\hat{\\mathbf{k}}_\\text{r} = -\\hat{\\mathbf{z}}$ direction: $\\tilde{\\mathbf{H}}_{\\text{r}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}}_\\text{r} \\times \\tilde{\\mathbf{E}}_{\\text{r}}$.\n$$\n\\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{1}{\\eta} (-\\hat{\\mathbf{z}}) \\times \\big( \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\nThe total electric and magnetic fields are the superposition of the incident and reflected fields:\n$$\n\\tilde{\\mathbf{E}}(\\mathbf{r}) = \\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = E_{0} \\big( \\exp(\\mathrm{i} k z) + \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(\\mathbf{r}) = \\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{E_{0}}{\\eta} \\big( \\exp(\\mathrm{i} k z) - \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{y}}\n$$\n\nNow, we apply the absorbing boundary condition at the plane $z=0$. The ABC is given in the time domain as\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0\n$$\nwhere the subscript $t$ denotes components tangential to the boundary. For a harmonic time dependence $\\exp(-\\mathrm{i}\\omega t)$, this ABC transforms directly to the frequency domain as\n$$\n\\tilde{\\mathbf{E}}_{t}(\\mathbf{r}) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\tilde{\\mathbf{H}}_{t}(\\mathbf{r}) \\quad \\text{for} \\quad z=0\n$$\nThe outward unit normal is $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$. At the boundary $z=0$, the total fields are\n$$\n\\tilde{\\mathbf{E}}(z=0) = E_{0} (1+\\Gamma) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(z=0) = \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}}\n$$\nSince both $\\tilde{\\mathbf{E}}(z=0)$ and $\\tilde{\\mathbf{H}}(z=0)$ are entirely in the $xy$-plane, they are equal to their tangential components, $\\tilde{\\mathbf{E}}_{t}(z=0)$ and $\\tilde{\\mathbf{H}}_{t}(z=0)$, respectively.\n\nSubstituting these into the phasor-domain ABC:\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\, \\hat{\\mathbf{z}} \\times \\left( \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}} \\right)\n$$\nWe evaluate the cross product: $\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{y}} = -\\hat{\\mathbf{x}}$.\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\frac{E_{0}}{\\eta} (1-\\Gamma) (-\\hat{\\mathbf{x}})\n$$\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = \\frac{\\eta_{b}}{\\eta} E_{0} (1-\\Gamma) \\hat{\\mathbf{x}}\n$$\nSince $E_{0}$ is non-zero, we can cancel the vector term $E_{0}\\hat{\\mathbf{x}}$ from both sides, yielding a scalar equation for $\\Gamma$:\n$$\n1+\\Gamma = \\frac{\\eta_{b}}{\\eta} (1-\\Gamma)\n$$\nWe now solve for $\\Gamma$. Multiplying by $\\eta$:\n$$\n\\eta(1+\\Gamma) = \\eta_{b}(1-\\Gamma)\n$$\n$$\n\\eta + \\eta\\Gamma = \\eta_{b} - \\eta_{b}\\Gamma\n$$\nRearranging the terms to group those with $\\Gamma$:\n$$\n\\eta\\Gamma + \\eta_{b}\\Gamma = \\eta_{b} - \\eta\n$$\n$$\n\\Gamma (\\eta + \\eta_{b}) = \\eta_{b} - \\eta\n$$\nFinally, dividing by $(\\eta + \\eta_{b})$ gives the closed-form expression for the reflection coefficient:\n$$\n\\Gamma = \\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}\n$$\nThis expression is dimensionless and given in terms of the specified parameters $\\eta$ and $\\eta_{b}$. This is the well-known formula for reflection at a boundary with surface impedance $\\eta_b$. The ideal Silver-Müller ABC for perfect absorption of normally incident waves would set $\\eta_b = \\eta$, resulting in $\\Gamma=0$.",
            "answer": "$$\\boxed{\\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}}$$"
        },
        {
            "introduction": "While the simplest local ABCs can be designed to perfectly absorb waves arriving at a normal angle, their performance often deteriorates for waves incident obliquely. This practice explores this critical limitation by analyzing the reflection from a basic one-way wave operator. By deriving the reflection coefficient as an explicit function of the incidence angle (), you will quantitatively see how and why these operators fail at grazing angles, motivating the development of higher-order ABCs.",
            "id": "3324557",
            "problem": "Consider a two-dimensional, homogeneous, isotropic, source-free electromagnetic medium with permittivity $\\varepsilon$ and permeability $\\mu$, so that the wave speed is $c = (\\varepsilon \\mu)^{-1/2}$. In such a medium, each Cartesian component of the electric field obeys the scalar wave equation $u_{tt} = c^{2}(u_{xx} + u_{yy})$, where $u(x,y,t)$ denotes a single component of the electric field. Let the computational domain be the half-space $x \\ge 0$ with a planar artificial boundary at $x = 0$, and consider implementing a local Absorbing Boundary Condition (ABC) that enforces the one-way operator on the boundary,\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\nAssume a time-harmonic plane wave of angular frequency $\\omega$ propagates in the interior toward the boundary, with phasor representation and time dependence $\\exp(-\\mathrm{i}\\,\\omega t)$, so that the incident field is\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\nwhere the dispersion relation holds, $k^{2} = k_{x}^{2} + k_{y}^{2} = (\\omega/c)^{2}$. Let the incidence angle $\\theta \\in [0,\\pi/2)$ be measured in radians with respect to the boundary normal (the $+x$ axis), so that $k_{x} = -k\\cos\\theta$ and $k_{y} = k\\sin\\theta$ with $k = \\omega/c$. The total field near the boundary is the superposition $u_{t} = u_{i} + R\\,u_{r}$ of the incident field and a specularly reflected field $u_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big)$, with reflection coefficient $R(\\theta)$.\n\nStarting from the wave equation and the plane-wave dispersion relation, and using only the boundary operator $(\\partial_{t} - c\\,\\partial_{x})$ at $x=0$, derive the exact closed-form expression for the induced reflection coefficient $R(\\theta)$ solely in terms of $\\sin\\theta$. Then, by asymptotic analysis of your result, determine the leading-order scaling of the reflection magnitude in the grazing-incidence limit $\\theta \\to \\pi/2$ and explain why this behavior exposes a limitation of the one-way operator for local ABCs at grazing incidence.\n\nProvide your final answer as a single closed-form analytic expression for $R(\\theta)$ depending only on $\\sin\\theta$. No numerical approximation is required. Angles must be treated in radians.",
            "solution": "The electromagnetic field components in a homogeneous isotropic medium satisfy Maxwell's equations. In the absence of sources and with constant material parameters, each Cartesian component of the electric field obeys the scalar wave equation\n$$\nu_{tt} = c^{2}(u_{xx} + u_{yy}),\n$$\nwhere $c = (\\varepsilon \\mu)^{-1/2}$ is the wave speed. A time-harmonic plane wave solution has the form\n$$\nu(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\nwith the dispersion relation\n$$\nk^{2} = k_{x}^{2} + k_{y}^{2} = \\left(\\frac{\\omega}{c}\\right)^{2}.\n$$\nLet the planar artificial boundary be at $x=0$ and the computational domain $x \\ge 0$. A local Absorbing Boundary Condition (ABC) derived via one-way operator factorization of the wave operator enforces\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\nThis operator annihilates waves that propagate toward decreasing $x$ (left-moving waves) and is first-order accurate for waves normal to the boundary. To examine reflection for oblique incidence, consider an incident plane wave approaching the boundary from within the domain. The incidence angle $\\theta \\in [0,\\pi/2)$ is defined with respect to the boundary normal ($+x$ axis), and the wavenumber components are\n$$\nk_{x} = -k\\cos\\theta,\\quad k_{y} = k\\sin\\theta,\\quad k = \\frac{\\omega}{c}.\n$$\nThe incident field is\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(-k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big),\n$$\nand the reflected field, by specular symmetry, is\n$$\nu_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big).\n$$\nThe total field near the boundary is $u_{t} = u_{i} + R\\,u_{r}$, where $R(\\theta)$ is the complex reflection coefficient we aim to compute. Applying the boundary operator to the total field at $x=0$ yields\n$$\n\\left[(\\partial_{t} - c\\,\\partial_{x})(u_{i} + R\\,u_{r})\\right]_{x=0} = 0.\n$$\nWe compute the derivatives. For the time derivative,\n$$\n\\partial_{t} u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i},\\qquad \\partial_{t} u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r}.\n$$\nFor the spatial derivative along $x$,\n$$\n\\partial_{x} u_{i} = \\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i},\\qquad \\partial_{x} u_{r} = \\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r}.\n$$\nTherefore,\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} - c\\,\\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} + \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{i}.\n$$\nSimilarly,\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - c\\,\\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{r}.\n$$\nUsing $c\\,k = \\omega$, these simplify to\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,u_{i},\\qquad\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,u_{r}.\n$$\nAt $x=0$, the incident and reflected fields share the same phase factor in $y$ and $t$ and have unit amplitude in $x$ since $\\exp(\\mathrm{i}\\,(\\pm k\\cos\\theta\\,x))\\big|_{x=0} = 1$. Denoting $U_{0} = \\exp\\!\\big(\\mathrm{i}\\,(k\\sin\\theta\\,y - \\omega t)\\big)$, we have $u_{i}\\big|_{x=0} = U_{0}$ and $u_{r}\\big|_{x=0} = U_{0}$. The boundary condition becomes\n$$\n-\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,U_{0} + R\\,\\big(-\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,U_{0}\\big) = 0.\n$$\nDividing by $-\\mathrm{i}\\,\\omega\\,U_{0}$ yields\n$$\n(1 - \\cos\\theta) + R\\,(1 + \\cos\\theta) = 0,\n$$\nso the reflection coefficient is\n$$\nR(\\theta) = -\\,\\frac{1 - \\cos\\theta}{1 + \\cos\\theta}.\n$$\nTo express $R(\\theta)$ solely in terms of $\\sin\\theta$, note that for $\\theta \\in [0,\\pi/2)$, $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$. Substituting this identity gives\n$$\nR(\\theta) = -\\,\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}.\n$$\nThis is the requested closed-form analytic expression depending only on $\\sin\\theta$.\n\nFor grazing incidence, $\\theta \\to \\pi/2$, so $\\sin\\theta \\to 1$ and hence $\\cos\\theta \\to 0$. From the exact formula,\n$$\nR(\\theta) \\xrightarrow[\\theta \\to \\pi/2]{} -\\,\\frac{1 - 0}{1 + 0} = -1,\n$$\nindicating total reflection in the limit. The leading-order deviation from $-1$ can be obtained by expanding the numerator and denominator for small $\\cos\\theta$,\n$$\n1 + R(\\theta) = \\frac{2\\,\\cos\\theta}{1 + \\cos\\theta} \\sim 2\\,\\cos\\theta \\quad \\text{as} \\quad \\cos\\theta \\to 0.\n$$\nIn terms of $\\sin\\theta$, using $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$ yields\n$$\n1 + R(\\theta) \\sim 2\\,\\sqrt{1 - \\sin^{2}\\theta} \\quad \\text{as} \\quad \\sin\\theta \\to 1.\n$$\nThus the induced reflection approaches unity for grazing incidence, with the departure from $-1$ scaling like the square root of $1 - \\sin^{2}\\theta$. This exposes a limitation of the local one-way operator ABC: it is exact for normal incidence ($\\theta = 0$ yields $R = 0$), but it becomes highly reflective as the incidence becomes grazing, which is a known deficiency of low-order local ABCs for waves with large tangential wavenumber.",
            "answer": "$$\\boxed{-\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}}$$"
        },
        {
            "introduction": "Beyond physical accuracy, a crucial requirement for any numerical boundary condition is that it maintains the stability of the overall simulation. A poorly designed ABC can introduce non-physical, exponentially growing modes that render the solution meaningless. This exercise () introduces the rigorous method of von Neumann stability analysis to investigate the interaction between an interior FDTD scheme and a boundary condition. Completing this analysis reveals the subtle but vital stability constraints imposed by the ABC, a critical consideration for any practical time-domain simulation.",
            "id": "3324494",
            "problem": "Consider one-dimensional transverse electromagnetic wave propagation in a homogeneous, lossless medium with permittivity $\\varepsilon$, permeability $\\mu$, and wave speed $c = 1/\\sqrt{\\mu \\varepsilon}$. The computational domain is $x \\in [0,L]$. A Finite-Difference Time-Domain (FDTD) scheme on a staggered Yee grid updates the electric field $E_{z}$ at integer spatial indices $i \\in \\{0,1,\\dots,N\\}$ and integer time levels $n$, and the magnetic field $H_{y}$ at half-integer spatial indices and half-integer time levels. Let the spatial step be $\\Delta x$, the temporal step be $\\Delta t$, and define the Courant number $S = c \\Delta t/\\Delta x$.\n\nAt the right boundary $x=L$ (node $i=N$), impose a first-order local absorbing boundary condition of Mur type, derived from the one-way wave equation that describes an outgoing right-going wave. Assume a standard second-order accurate leapfrog Yee update in the interior. Perform a von Neumann normal-mode stability analysis that treats both the interior scheme and the boundary update consistently:\n\n- Start from Maxwell’s equations in one spatial dimension.\n- Derive the interior discrete dispersion relation for the Yee scheme and its stability restriction in terms of $S$.\n- Derive a two-time-level, two-point discrete formula for the first-order Mur absorbing boundary condition at $i=N$ by discretizing the one-way wave equation appropriate for a right-going wave.\n- For a discrete plane-wave ansatz compatible with the staggered grid, derive the boundary amplification factor $G$ implied by the Mur boundary update at $i=N$ and show the condition on $S$ for which $|G| \\le 1$ for all real wavenumbers in the propagating band supported by the interior scheme.\n- Combine the interior and boundary conditions to determine the tight stability constraint on $S$ that guarantees no boundary mode amplification.\n\nWhat is the maximum allowable Courant number $S_{\\max}$ that guarantees no boundary mode amplification for the coupled interior-plus-boundary scheme? Give your answer as an exact number without units.",
            "solution": "The problem asks for the maximum allowable Courant number $S_{\\max}$ for a one-dimensional Finite-Difference Time-Domain (FDTD) scheme that is guaranteed to be stable when coupled with a first-order Mur absorbing boundary condition (ABC). The analysis requires examining the stability of\nthe interior Yee scheme and the stability of the coupled interior-boundary system.\n\nThe one-dimensional transverse electromagnetic (TEM) wave propagation is governed by Maxwell's curl equations, which in a homogeneous, lossless medium specialize to:\n$$\n\\frac{\\partial E_z}{\\partial t} = -\\frac{1}{\\varepsilon} \\frac{\\partial H_y}{\\partial x}\n$$\n$$\n\\frac{\\partial H_y}{\\partial t} = -\\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial x}\n$$\nwhere $E_z$ is the electric field, $H_y$ is the magnetic field, $\\varepsilon$ is the permittivity, and $\\mu$ is the permeability.\n\nThe FDTD method discretizes these equations on a staggered Yee grid. With spatial step $\\Delta x$ and temporal step $\\Delta t$, the second-order accurate leapfrog update equations are:\n$$\n\\frac{E_z|_i^{n+1} - E_z|_i^n}{\\Delta t} = -\\frac{1}{\\varepsilon} \\frac{H_y|_{i+1/2}^{n+1/2} - H_y|_{i-1/2}^{n+1/2}}{\\Delta x}\n$$\n$$\n\\frac{H_y|_{i-1/2}^{n+1/2} - H_y|_{i-1/2}^{n-1/2}}{\\Delta t} = -\\frac{1}{\\mu} \\frac{E_z|_i^n - E_z|_{i-1}^n}{\\Delta x}\n$$\n\nFirst, we perform a von Neumann stability analysis of the interior scheme. We assume a normal-mode (plane wave) solution of the form:\n$$\nE_z|_i^n = \\hat{E} \\exp[j(\\omega n \\Delta t - k i \\Delta x)]\n$$\n$$\nH_y|_{i-1/2}^{n-1/2} = \\hat{H} \\exp[j(\\omega (n-1/2) \\Delta t - k (i-1/2) \\Delta x)]\n$$\nwhere $\\omega$ is the angular frequency and $k$ is the wavenumber. Substituting these into the FDTD update equations and simplifying yields two algebraic equations:\n$$\n\\hat{E} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\hat{H} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{H} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\frac{\\Delta t}{\\mu \\Delta x} \\hat{E} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nFor a non-trivial solution $(\\hat{E}, \\hat{H})$, we multiply these two equations to eliminate the amplitudes:\n$$\n\\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\frac{1}{\\mu \\varepsilon} \\left(\\frac{\\Delta t}{\\Delta x}\\right)^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nUsing the definitions of wave speed $c = 1/\\sqrt{\\mu\\varepsilon}$ and Courant number $S = c\\Delta t/\\Delta x$, we obtain the numerical dispersion relation for the interior Yee scheme:\n$$\n\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\pm S \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nFor the scheme to be stable, the numerical frequency $\\omega$ must be real for any real wavenumber $k$. This requires the left-hand side, $\\sin(\\omega \\Delta t / 2)$, to be real. This is only possible if its magnitude is less than or equal to $1$. The right-hand side is maximized when $|\\sin(k\\Delta x / 2)| = 1$. Therefore, stability of the interior scheme requires:\n$$\n|S \\cdot 1| \\le 1 \\implies S \\le 1\n$$\n\nNext, we derive the first-order Mur ABC at the right boundary $x=L$ (node $i=N$). The ABC is derived from the one-way wave equation for a right-propagating wave:\n$$\n\\left(\\frac{\\partial}{\\partial t} + c \\frac{\\partial}{\\partial x}\\right) E_z = 0\n$$\nWe discretize this equation at grid point $(i,t) = (N, n)$ using a forward difference in time and a backward difference in space to create a simple, explicit, two-time-level, two-point update rule:\n$$\n\\frac{E_z|_N^{n+1} - E_z|_N^n}{\\Delta t} + c \\frac{E_z|_N^n - E_z|_{N-1}^n}{\\Delta x} = 0\n$$\nRearranging for $E_z|_N^{n+1}$ and using $S=c\\Delta t/\\Delta x$, we get the ABC update formula:\n$$\nE_z|_N^{n+1} = E_z|_N^n - S (E_z|_N^n - E_z|_{N-1}^n) = (1-S) E_z|_N^n + S E_z|_{N-1}^n\n$$\n\nNow, we perform a stability analysis of the coupled system. A boundary-induced instability corresponds to a \"parasitic\" solution that grows exponentially in time while decaying spatially away from the boundary. Such a mode can be represented by the ansatz:\n$$\nE_z|_i^n = G^n \\lambda^{i-N}\n$$\nwhere $G$ is the amplification factor per time step and $\\lambda$ is a spatial factor. For an unstable mode at the right boundary $i=N$, we must have $|G|>1$. For the mode to be localized at the boundary and decay into the domain (i.e., for $i<N$), we must have $|\\lambda|<1$.\n\nThis ansatz must satisfy both the interior scheme's dispersion relation and the boundary condition.\n1.  From the boundary condition: Substituting the ansatz into the ABC formula gives\n    $$\n    G^{n+1} \\lambda^0 = (1-S) G^n \\lambda^0 + S G^n \\lambda^{-1}\n    $$\n    $$\n    G = 1-S + \\frac{S}{\\lambda} \\implies \\lambda = \\frac{S}{G-(1-S)}\n    $$\n2.  From the interior scheme: The ansatz $E_z|_i^n = (G)^n (\\lambda)^i$ can be written as $E_z|_i^n = \\exp(n \\ln G) \\exp(i \\ln \\lambda)$. This is a normal mode with $j\\omega\\Delta t = \\ln G$ and $-jk\\Delta x = \\ln \\lambda$. The dispersion relation $\\sin(\\omega \\Delta t / 2) = \\pm S \\sin(k\\Delta x/2)$ becomes:\n    $$\n    \\frac{G^{1/2} - G^{-1/2}}{2j} = \\pm S \\left(\\frac{\\lambda^{-1/2} - \\lambda^{1/2}}{2j}\\right)\n    $$\n    $$\n    G^{1/2} - G^{-1/2} = \\pm S (\\lambda^{-1/2} - \\lambda^{1/2})\n    $$\n    This can be rewritten as:\n    $$\n    \\frac{G-1}{G^{1/2}} = \\pm S \\frac{1-\\lambda}{\\lambda^{1/2}}\n    $$\n    Squaring both sides gives a relation independent of the sign choice:\n    $$\n    \\frac{(G-1)^2}{G} = S^2 \\frac{(1-\\lambda)^2}{\\lambda} \\implies (G-1)^2 \\lambda = S^2 G (1-\\lambda)^2\n    $$\n\nNow we seek a simultaneous solution to the two derived equations for a mode with $|G|>1$. We substitute the expression for $\\lambda$ from the boundary condition into the equation from the interior scheme:\n$$\n(G-1)^2 \\left(\\frac{S}{G-1+S}\\right) = S^2 G \\left(1 - \\frac{S}{G-1+S}\\right)^2\n$$\nAssume $G \\neq 1-S$.\n$$\n\\frac{S(G-1)^2}{G-1+S} = S^2 G \\left(\\frac{G-1+S-S}{G-1+S}\\right)^2 = \\frac{S^2 G (G-1)^2}{(G-1+S)^2}\n$$\nAssuming $G \\neq 1$, we can divide both sides by $S(G-1)^2$:\n$$\n\\frac{1}{G-1+S} = \\frac{S G}{(G-1+S)^2}\n$$\nThis simplifies to $G-1+S = SG$, which can be rearranged as:\n$$\nG(1-S) = 1-S \\implies (G-1)(1-S) = 0\n$$\nThis final equation reveals the stability properties of the coupled system.\n- If $S \\ne 1$, the only possible solution is $G=1$. This means there are no modes with an amplification factor $|G|>1$. Thus, for $S<1$, the coupled scheme is stable and has no boundary mode amplification.\n- If $S=1$, the equation becomes $0=0$. This is an identity, meaning it is true for any value of $G$. In this case, the interior and boundary relations are compatible for any $G$. We can therefore construct an unstable mode. For example, if we choose an unstable amplification factor $G=2$, the boundary condition $\\lambda = S/(G-(1-S))$ gives $\\lambda = 1/(2-(1-1)) = 1/2$. This mode, with $(G, \\lambda) = (2, 1/2)$, satisfies $|G|>1$ and $|\\lambda|<1$, and is a valid solution of the coupled system. This signifies an instability.\n\nTherefore, the condition to guarantee no boundary mode amplification is $S < 1$. The interior scheme itself is unstable for $S > 1$. The boundary coupling introduces a new instability precisely at $S=1$.\nThe problem asks for the maximum allowable Courant number, $S_{\\max}$. The set of Courant numbers that guarantee stability is $S \\in [0, 1)$. The supremum of this set is $1$. In the context of numerical stability limits, the maximum allowable value is this supremum.\n\nFinal value: $S_{\\max} = 1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}