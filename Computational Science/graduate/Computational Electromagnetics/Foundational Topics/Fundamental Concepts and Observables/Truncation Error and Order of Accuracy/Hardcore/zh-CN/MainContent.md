## 引言
在计算科学与工程的广阔领域中，数值仿真是连接理论物理与实际应用的关键桥梁。然而，当我们将描述物理世界的连续[偏微分方程](@entry_id:141332)转化为计算机可以处理的离散[代数方程](@entry_id:272665)时，一个根本性的挑战随之产生：近似过程必然引入误差。这些误差的来源与行为，直接决定了仿真结果的可信度与精确性。其中，**截断误差**（truncation error）与**[精度阶](@entry_id:145189)数**（order of accuracy）是描述这一离散化过程内在数学缺陷的核心概念，但其理论定义、实际影响及与其他误差源的复杂关系常常构成知识上的壁垒。

本文旨在系统性地剖析这两个概念，填补理论与实践之间的鸿沟。通过深入浅出的讲解，读者将掌握评估和[控制数值误差](@entry_id:747829)的根本方法。在第一部分“**原理与机制**”中，我们将从基本定义出发，辨析[局部截断误差](@entry_id:147703)与全局误差，阐明[Lax等价定理](@entry_id:139112)在连接精度、稳定性与收敛性中的核心作用，并通过[泰勒级数分析](@entry_id:171242)揭示误差的来源。接下来，在“**应用与交叉学科联系**”部分，我们将展示这些理论如何应用于[代码验证](@entry_id:146541)、算法改进（如[理查森外推法](@entry_id:137237)），以及解决天体物理学、[材料科学](@entry_id:152226)等领域的实际问题。最后，通过“**动手实践**”环节，读者将有机会亲手推导和[测量误差](@entry_id:270998)，将理论知识转化为实践技能。

现在，让我们首先进入第一章，深入探讨[截断误差](@entry_id:140949)与精度阶数的“**原理与机制**”，为我们接下来的探索之旅奠定坚实的理论基础。

## 原理与机制

在数值计算中，我们用离散的[代数方程](@entry_id:272665)组来近似替代连续的[偏微分方程](@entry_id:141332)。这一近似过程不可避免地会引入误差。理解这些误差的来源、性质和行为，对于评估和提升计算[电磁仿真](@entry_id:748890)的准确性至关重要。本章旨在深入剖析[离散化误差](@entry_id:748522)的核心概念——**[截断误差](@entry_id:140949)**（truncation error）与**[精度阶](@entry_id:145189)数**（order of accuracy），并阐明它们如何决定数值解的收敛特性。我们将从基本定义出发，逐步探讨其量化分析方法、在实践中的多种表现形式，以及与其他误差源的复杂相互作用。

### [离散化误差](@entry_id:748522)的基本概念

任何数值仿真的总误差都可归结为三个主要来源：**[建模误差](@entry_id:167549)**（modeling error）、**[离散化误差](@entry_id:748522)**（discretization error）和**[舍入误差](@entry_id:162651)**（round-off error）。

- **[建模误差](@entry_id:167549)**源于描述物理现象的数学模型与真实物理世界之间的差异。例如，用[完美电导体](@entry_id:753331)（PEC）边界来模拟良导体，或使用[完美匹配层](@entry_id:753330)（PML）来截断一个开放的无界区域，这些都是建模上的简化。

- **[舍入误差](@entry_id:162651)**则是由计算机使用有限精度[浮点数](@entry_id:173316)（如 [IEEE 754](@entry_id:138908) [双精度](@entry_id:636927)）进行算术运算而产生的。每一次计算都可能引入微小的误差，在经历数百万次迭代后，这些误差可能累积到显著的程度。

- **[离散化误差](@entry_id:748522)**，也即本章的[焦点](@entry_id:174388)——**[截断误差](@entry_id:140949)**，是由于我们将连续的微分算子（如偏导数）替换为离散的差分算子（如[有限差分](@entry_id:167874)）而引入的。它是连续方程与离散方程之间的内在数学差异。

为了精确地讨论[截断误差](@entry_id:140949)，我们必须区分几个密切相关但截然不同的概念。

#### [局部截断误差](@entry_id:147703)、全局误差与残差

考虑一个一般的[偏微分方程](@entry_id:141332)，可以抽象地写作 $\mathcal{L}u = s$，其中 $\mathcal{L}$ 是一个微分算子， $u$ 是精确解， $s$ 是源项。其离散形式可写作 $\mathcal{L}_h u_h = s_h$，其中 $h$ 代表离散化步长（如网格尺寸 $\Delta x$）， $u_h$ 是数值解。

**[局部截断误差](@entry_id:147703)（Local Truncation Error, LTE）** 是衡量**精确解** $u$ 在多大程度上不满足**离散方程**的指标。其定义方式是将连续方程的精确解 $u$ 代入离散算子 $\mathcal{L}_h$ 中，然后计算其与真实源项（在网格[上采样](@entry_id:275608)）$s_h$ 的差异。对于一个单步[时间演化](@entry_id:153943)格式 $\nu_h^{n+1}=\Psi_{\Delta t,h}(\nu_h^{n})$，其单位时间步长的[局部截断误差](@entry_id:147703) $\tau_{h,\Delta t}^{n+1}$ 定义为：
$$
\tau_{h,\Delta t}^{n+1}=\frac{R_h u(t^{n+1})-\Psi_{\Delta t,h}\big(R_h u(t^n)\big)}{\Delta t}
$$
其中 $R_h$ 是将[连续函数](@entry_id:137361)投影或采样到离散网格上的[限制算子](@entry_id:754316)。本质上，LTE 回答了这样一个问题：“如果我们的解是完美的，那么我们的离散方程有多不准确？”

**[全局误差](@entry_id:147874)（Global Error）** 是我们最终关心的量，它直接衡量数值解 $u_h$ 与精确解 $u$ 的投影 $R_h u$ 之间的差异。在时间步 $n$，[全局误差](@entry_id:147874) $e^n$ 定义为：
$$
e^n=R_h u(t^n)-u_h^n
$$
[全局误差](@entry_id:147874)是所有时间步中[局部截断误差](@entry_id:147703)[累积和](@entry_id:748124)传播的结果。

**残差（Residual）** 是衡量任意一个网格函数 $v_h$ 在多大程度上不满足离散方程的量。对于上述单步格式，残差定义为 $\mathrm{res}^{n+1}(v_h)=v_h^{n+1}-\Psi_{\Delta t,h}(v_h^{n})$。一个常见的误区是将[局部截断误差](@entry_id:147703)与残差混淆。特别注意，当我们计算**数值解** $u_h$ 本身的残差时，即 $\mathrm{res}^{n+1}(u_h) = u_h^{n+1} - \Psi_{\Delta t,h}(u_h^n)$，其结果（在不考虑[浮点舍入](@entry_id:749455)误差的情况下）**恒等于零**。这是因为数值解 $u_h$ 正是根据这个更新规则被定义和计算出来的。一个恒为零的量无法用来描述方法的精度。

同样，在[半离散化](@entry_id:163562)（或称线方法）中，我们将[偏微分方程](@entry_id:141332) $\partial_t u = \mathcal{L}u + s$ 转化为一个[常微分方程组](@entry_id:266774) $\frac{d}{dt}u_h(t)=\mathcal{L}_h u_h(t)+s_h(t)$。其半离散[局部截断误差](@entry_id:147703) $\tau_{\mathrm{sd}}(t)$ 是将精确解代入该[常微分方程组](@entry_id:266774)后产生的缺陷：
$$
\tau_{\mathrm{sd}}(t) = \frac{d}{dt}\big(R_h u(t)\big)-\mathcal{L}_h\big(R_h u(t)\big) - s_h(t)
$$
这个量衡量了空间离散算子 $\mathcal{L}_h$ 对精确解作用的结果与精确算子作用结果的投影之间的差异。

### 精度阶数与收敛性

**精度阶数（Order of Accuracy）** 是对[局部截断误差](@entry_id:147703)如何随着离散步长（如空间步长 $\Delta x$ 和时间步长 $\Delta t$）趋于零而减小的数学刻画。如果一个数值格式的[局部截断误差](@entry_id:147703) $\tau$ 满足如下关系：
$$
\|\tau\| \le C(\Delta x^p + \Delta t^q)
$$
其中 $p$ 和 $q$ 是正整数，$C$ 是一个不依赖于 $\Delta x$ 和 $\Delta t$ 的常数（但可能依赖于精确解的高阶导数），我们就称该格式在空间上是 **$p$ 阶**精确的，在时间上是 **$q$ 阶**精确的。 这一性质是衡量一个[数值格式](@entry_id:752822)“好坏”的核心内在属性。

一个自然的问题是：[局部截断误差](@entry_id:147703)的精度阶数与我们最终关心的全局误差的[收敛速度](@entry_id:636873)之间有什么关系？答案由著名的 **Lax 等价定理（Lax Equivalence Theorem）** 给出。该定理指出，对于一个适定的线性初值问题，一个**相容的（consistent）**数值格式是**收敛的（convergent）**，当且仅当它是**稳定的（stable）**。

- **相容性（Consistency）** 意味着当离散步长趋于零时，[局部截断误差](@entry_id:147703)也趋于零。换言之，离散方程在极限情况下确实收敛于原始的连续方程。对于阶数为 $(p,q)$ 且 $p,q>0$ 的格式，相容性自然成立。 

- **稳定性（Stability）** 指的是数值格式不会放大在计算过程中产生的误差（包括[截断误差](@entry_id:140949)和[舍入误差](@entry_id:162651)）。对于一个线性更新算子 $\mathbf{S}$，稳定性要求其任意次幂的范数都是有界的，即 $\|\mathbf{S}^m\| \le K$，其中 $K$ 是一个常数。对于FDTD等显式格式，这通常要求满足一个 Courant–Friedrichs–Lewy (CFL) 条件。

- **收敛性（Convergence）** 指的是当离散步长趋于零时，数值解确实趋近于精确解。

Lax 等价定理的精髓在于“**相容性 + 稳定性 $\iff$ 收敛性**”。更重要的是，它告诉我们，对于一个稳定且相容的格式，[全局误差](@entry_id:147874)的[收敛阶](@entry_id:146394)数与[局部截断误差](@entry_id:147703)的阶数相同。也就是说，如果一个稳定格式的[局部截断误差](@entry_id:147703)是 $O(\Delta x^p + \Delta t^q)$，那么其全局误差也将以 $O(\Delta x^p + \Delta t^q)$ 的速度收敛。稳定性是连接局部精度和[全局收敛性](@entry_id:635436)的关键桥梁。没有稳定性，即使[局部截断误差](@entry_id:147703)很小，全局误差也可能在迭代中爆炸式增长，导致数值解毫无意义。 

### 截断误差的量化与分析

理解了截断误差的定义后，我们如何实际计算它呢？最基本和强大的工具是**泰勒级数展开**。

#### [泰勒级数分析](@entry_id:171242)法

让我们以一个经典的一维标量波方程 $E_{tt} = c^2 E_{xx}$ 为例，它由标准的蛙跳 FDTD 格式离散化。该格式等效于一个在时间和空间上均为[中心差分](@entry_id:173198)的格式。我们将精确解 $E(x,t)$ 代入这个离散格式，得到的[局部截断误差](@entry_id:147703) $\tau$ 为：
$$
\tau = \frac{E(x, t+\Delta t) - 2E(x, t) + E(x, t-\Delta t)}{(\Delta t)^2} - c^2 \frac{E(x+\Delta x, t) - 2E(x, t) + E(x-\Delta x, t)}{(\Delta x)^2}
$$
通过对 $E(x, t\pm\Delta t)$ 和 $E(x\pm\Delta x, t)$ 在点 $(x,t)$ 进行[泰勒展开](@entry_id:145057)，我们得到：
$$
\frac{E(t+\Delta t) - 2E(t) + E(t-\Delta t)}{(\Delta t)^2} = E_{tt} + \frac{(\Delta t)^2}{12} E_{tttt} + O((\Delta t)^4)
$$
$$
\frac{E(x+\Delta x) - 2E(x) + E(x-\Delta x)}{(\Delta x)^2} = E_{xx} + \frac{(\Delta x)^2}{12} E_{xxxx} + O((\Delta x)^4)
$$
将这些代入 $\tau$ 的表达式，并利用精确解满足 $E_{tt} - c^2 E_{xx} = 0$ 这一事实，我们得到[截断误差](@entry_id:140949)的主导项：
$$
\tau = \frac{(\Delta t)^2}{12} E_{tttt} - \frac{c^2 (\Delta x)^2}{12} E_{xxxx} + \text{H.O.T.}
$$
这表明该格式在时间和空间上都是二阶精确的，即 $p=2, q=2$。通过对[波动方程](@entry_id:139839)求导，我们可以得到 $E_{tttt} = c^4 E_{xxxx}$。于是，主导项的时间部分 $\tau_T$ 与空间部分 $\tau_S$ 的幅度之比为：
$$
\frac{|\tau_T|}{|\tau_S|} = \frac{|(\Delta t)^2 E_{tttt}/12|}{|-c^2(\Delta x)^2 E_{xxxx}/12|} = \frac{c^4 (\Delta t)^2}{c^2 (\Delta x)^2} = c^2 \left(\frac{\Delta t}{\Delta x}\right)^2
$$
若令 $\Delta t = \lambda \Delta x$（其中 $\lambda$ 是一个常数），则此比值为 $c^2 \lambda^2$。这个结果清晰地展示了[截断误差](@entry_id:140949)的大小如何依赖于物理参数（波速 $c$）和数值参数（$\lambda$）。 更有趣的是，当 $c\lambda=1$ 时，这个比值为1，实际上在这种特殊情况下，两个误差项可以相互抵消，使得格式的精度阶数更高。

#### [截断误差](@entry_id:140949)的表现：数值色散

截断误差并非仅仅是一个抽象的数学量，它会在仿真结果中以各种非物理效应的形式表现出来。对于[波动方程](@entry_id:139839)，最主要的表现形式是**[数值色散](@entry_id:145368)（numerical dispersion）**。在连续介质中，[平面波](@entry_id:189798)的相速度 $c$ 是恒定的。然而，在离散网格上，数值格式引入的[截断误差](@entry_id:140949)使得等效的相速度 $v_p^{\mathrm{num}}$ 依赖于波的频率、传播方向和网格尺寸。

通过对 Yee-FDTD 格式进行[冯·诺依曼分析](@entry_id:153661)，可以推导出其三维离散色散关系。对于一个沿单位矢量 $\hat{\mathbf{n}} = (\alpha_x, \alpha_y, \alpha_z)$ 传播的[平面波](@entry_id:189798)，其数值相速度 $v_p^{\mathrm{num}}$ 与真实相速度 $c$ 之比，在低频（$k\Delta \to 0$）时可以展开为：
$$
\frac{v_p^{\mathrm{num}}}{c} \approx 1 + \frac{(k \Delta)^2}{24} \left( S^2 - (\alpha_x^4 + \alpha_y^4 + \alpha_z^4) \right)
$$
其中 $k=|\mathbf{k}|$ 是[波数](@entry_id:172452)，$\Delta$ 是网格尺寸，$S = c\Delta t/\Delta$ 是 Courant 数。

这个公式揭示了二阶截断误差如何转化为相速度误差。误差项与 $(k\Delta)^2$ 成正比，这说明网格分辨率（即每个波长内的网格点数）越低，[色散](@entry_id:263750)越严重。此外，误差还依赖于 Courant 数 $S$ 和传播方向 $\alpha_i$，后者导致了**[数值各向异性](@entry_id:752775)（numerical anisotropy）**——即使在物理上各向同性的介质中，波在网格上的传播速度也因方向而异。这会导致波前变形、[信号失真](@entry_id:269932)等一系列问题。

#### [渐近误差常数](@entry_id:165889)

对于一个 $r$ 阶收敛的格式，其全局误差 $e$ 在网格足够细时可以近似表示为 $\|e(\Delta)\| \approx C \Delta^r$，其中 $\Delta$ 是特征网格尺寸。这里的常数 $C$ 被称为**[渐近误差常数](@entry_id:165889)**。尽管在极限情况下误差由阶数 $r$ 主导，但在实际的、有限的网格分辨率下，$C$ 的大小决定了误差的[绝对值](@entry_id:147688)。

这个常数 $C$ 的值由截断误差的[主导项](@entry_id:167418)决定，因此它依赖于几个因素：
1.  **解的[光滑性](@entry_id:634843)**：[截断误差](@entry_id:140949)的推导基于[泰勒展开](@entry_id:145057)，其系数包含解的[高阶导数](@entry_id:140882)。例如，对于一个二阶格式，[误差常数](@entry_id:168754) $C$ 将依赖于解的三阶或四阶导数的界。解越“崎岖不平”（[高阶导数](@entry_id:140882)越大），[误差常数](@entry_id:168754) $C$ 就越大。对于[时谐场](@entry_id:755985)，这意味着频率越高（波数 $k$ 越大），$C$ 通常以 $k$ 的多项式形式增长，仿真难度也随之增加。
2.  **物理参数**：介质的材料参数如 $\varepsilon$ 和 $\mu$ 会出现在[微分方程](@entry_id:264184)和离散格式中，因此它们会影响[截断误差](@entry_id:140949)的系数，进而影响 $C$。
3.  **数值参数**：如 Courant 数 $\lambda = c\Delta t / \Delta$，它会直接影响时间截断误差项的大小，从而改变 $C$ 的值。

### 实践中的误差相互作用

在真实的仿真场景中，多种误差源并存且相互作用，使得最终观测到的收敛行为比理论分析更为复杂。

#### “最弱一环”原则

一个数值模拟的整体精度受限于其所有环节中最不精确的那个部分。这通常发生在内部离散格式与边界处理具有不同[精度阶](@entry_id:145189)数时。假设我们使用了一个内部为 $p$ 阶精度的[有限差分格式](@entry_id:749361)，但用于截断计算区域的[吸收边界条件](@entry_id:164672)（ABC）或 PML 的离散化只有 $q$ 阶精度。如果 $q  p$，那么来自边界的 $O(h^q)$ 误差会污染整个计算域。由于[亥姆霍兹方程](@entry_id:149977)这类问题的椭圆性质，边界上的误差会传播到内部。因此，即使在远离边界的区域进行测量，观测到的[全局收敛](@entry_id:635436)阶数也将是 $\min\{p, q\}$，即由阶数较低的边界处理所决定。例如，将一个四阶（$p=4$）的内部格式与一个一阶（$q=1$）的 ABC 结合使用，通常只会得到一阶的[全局收敛](@entry_id:635436)。

#### [截断误差](@entry_id:140949)与[建模误差](@entry_id:167549)：[阶梯近似](@entry_id:755343)的影响

在 FDTD 等使用笛卡尔网格的方法中，对[曲面](@entry_id:267450)边界的**[阶梯近似](@entry_id:755343)（staircasing）**是一种常见的[建模误差](@entry_id:167549)。这种近似用与坐标轴对齐的网格边来表示光滑的曲[线或](@entry_id:170208)[曲面](@entry_id:267450)，必然会引入几何形状上的偏差。研究表明，这种几何误差通常是**一阶**的，即 $O(h)$。

当一个二阶（$p=2$）的 FDTD 格式与[阶梯近似](@entry_id:755343)结合使用时，会发生什么？来自内部格式的[截断误差](@entry_id:140949)是 $O(h^2)$，而来自边界几何表示的[建模误差](@entry_id:167549)是 $O(h)$。根据“最弱一环”原则，当 $h$ 足够小时，$O(h)$ 项将主导总误差。因此，整个仿真的[全局收敛](@entry_id:635436)阶数会被降低到一阶。

我们可以通过量化这两种误差来找到它们势均力敌的[临界点](@entry_id:144653)。对于一个曲率为 $\kappa$ 的边界，[阶梯近似](@entry_id:755343)引入的等效波数相对误差约为 $(\Delta k/k)_{\text{geom}} \approx \kappa h / (2\pi)$。而内部二阶格式的截断误差（[数值色散](@entry_id:145368)）引入的[波数](@entry_id:172452)[相对误差](@entry_id:147538)约为 $(\Delta k/k)_{\text{int}} \approx -k^2 h^2 / 24$。令两者大小相等，我们可以解出临界网格尺寸 $h_{\text{crit}}$：
$$
h_{\mathrm{crit}} = \frac{12\kappa}{\pi k^2}
$$
当网格尺寸 $h > h_{\text{crit}}$ 时，几何误差占主导；当 $h  h_{\text{crit}}$ 时，内部截断误差占主导。这个分析为在实践中平衡几何保真度与计算成本提供了理论指导。

#### 典型的收敛曲线

综合考虑所有误差源，一次典型的网格加密收敛性研究中，误差曲线通常呈现三个阶段：
1.  **预渐近区（Pre-asymptotic Regime）**：在网格非常粗糙时，总误差可能由与网格无关或弱相关的[建模误差](@entry_id:167549)主导，例如固定的 PML 参数导致的固有反射。此时加密网格，误差下降缓慢甚至停滞。
2.  **渐近区（Asymptotic Regime）**：当网格足够细化，[离散化误差](@entry_id:748522)（[截断误差](@entry_id:140949)或阶梯误差）成为主导。误差曲线在对数-对数坐标下呈现一条直线，其斜率即为系统的收敛阶数（如由[阶梯近似](@entry_id:755343)决定的-1，或在保角网格下的-2）。
3.  **舍入误差平台（Round-off Floor）**：当网格极度精细时，[离散化误差](@entry_id:748522)已经变得非常小，此时累积的舍入误差开始显现。由于总计算量随网格加密而增加（例如在2D中为 $O(h^{-3})$），舍入误差会随之增长。最终，误差曲线会偏离直线，趋于一个平台，甚至可能因为舍入误差的增长而略微上翘。

### 更广阔的视角

截断误差和精度阶数的概念不仅限于[有限差分法](@entry_id:147158)，它们在其他数值方法中也有对应物，并启发了对“好”的离散化的更深层次的思考。

#### 有限元法中的[截断误差](@entry_id:140949)

在**[有限元法](@entry_id:749389)（Finite Element Method, FEM）**中，我们不在离散点上近似导数，而是在一个函数[子空间](@entry_id:150286)（由**[基函数](@entry_id:170178)**张成）中寻找[变分问题](@entry_id:756445)的近似解。这里的[误差分析](@entry_id:142477)不直接使用泰勒展开，而是依赖于[泛函分析](@entry_id:146220)的工具。**Céa 引理（Céa's Lemma）** 指出，Galerkin 解的误差[上界](@entry_id:274738)由精确解在有限元[子空间](@entry_id:150286)中的**最佳逼近误差**决定。这个最佳逼近误差又可以通过**[插值误差](@entry_id:139425)**来估计。

对于使用 $p$ 阶多项式 Nédélec 边元的有限元空间，其对一个光滑矢量场 $E$ 的[插值误差](@entry_id:139425)在 $H(\mathrm{curl})$ 范数下满足：
$$
\|E - \Pi_h E\|_{H(\mathrm{curl};\Omega)} \le C h^p M(E)
$$
其中 $M(E)$ 依赖于 $E$ 的高阶 Sobolev 范数。这表明，只要解足够光滑，有限元解的[收敛阶](@entry_id:146394)数由[基函数](@entry_id:170178)的多项式阶数 $p$ 决定。这里的[插值误差](@entry_id:139425) $O(h^p)$ 扮演了类似于 FDM 中[局部截断误差](@entry_id:147703)的角色，决定了方法的精度阶数。

#### 结构保持与相容性

一个更深刻的相容性概念是**结构保持（structure-preserving）**或**仿拟（mimetic）**离散化。其思想是离散算子不仅要逐点逼近[连续算子](@entry_id:143297)，还应该在离散层面严格满足连续世界中的关键矢量恒等式和守恒律。例如，矢量恒等式 $\nabla \cdot (\nabla \times \mathbf{A}) = 0$ 是[电荷守恒](@entry_id:264158)的数学基础。

然而，如果随意选择离散算子，这个恒等式可能在离散层面被破坏。例如，若在一个[同位网格](@entry_id:175200)上，同时使用[中心差分近似](@entry_id:177025)旋度 $\nabla \times_h$ 和[前向差分](@entry_id:173829)近似散度 $\nabla \cdot_h$，那么离散“[交换子](@entry_id:158878)” $\nabla \cdot_h (\nabla \times_h \mathbf{A})$ 通常不为零。对于特定场，这个误差可能是一个 $O(h)$ 的非零项。

这个非零的 $\nabla \cdot_h (\nabla \times_h \mathbf{H})$ 在离散的安培环路定律 $\partial_t \mathbf{D} = \nabla \times_h \mathbf{H}$ 中，表现为一个**虚假的数值源项**。对该方程两边取散度，我们得到 $\partial_t(\nabla \cdot_h \mathbf{D}) = \nabla \cdot_h (\nabla \times_h \mathbf{H}) \neq 0$。这意味着即使在没有物理[电荷](@entry_id:275494)源的情况下，数值[电荷](@entry_id:275494)也会凭空产生或消失，并在长时间仿真中累积，导致非物理的结果。Yee 格式的成功正在于其交错网格结构能够精确地满足这个散度-旋度恒等式，从而在离散层面保证了电荷守恒，这是其长期稳定性的一个重要原因。这表明，一个高质量的[数值格式](@entry_id:752822)不仅需要低的截断误差，还需要保持底层物理方程的内在结构。