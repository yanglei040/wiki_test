{
    "hands_on_practices": [
        {
            "introduction": "The foundation of analyzing any numerical scheme is understanding its local truncation error. This first practice provides a quintessential exercise, using Taylor series expansions to rigorously derive the order of accuracy and leading error term for the standard central difference operator . Completing this derivation is a crucial first step in quantifying how well a discrete operator approximates a continuous one.",
            "id": "3593417",
            "problem": "In one-dimensional numerical modeling of seismic wave propagation, spatial gradients of a smooth scalar wavefield $f(x)$ along a survey line are frequently approximated on a uniform grid with spacing $h$ using symmetric finite-difference stencils. Consider the central difference approximation\n$$\n\\frac{f_{i+1}-f_{i-1}}{2h}\n$$\nto the spatial derivative $f'(x_i)$, where $f_i \\equiv f(x_i)$ and $x_{i\\pm 1} = x_i \\pm h$. Assume $f$ is sufficiently smooth near $x_i$ to admit a Taylor series expansion.\n\nStarting from the Taylor series of $f$ about $x_i$, derive the order of accuracy and the leading truncation error term when the above central difference is used to approximate $f'(x_i)$. Your derivation must begin from the Taylor series definition and proceed by systematic cancellation of terms implied by the stencil symmetry; do not invoke any formula for the error term without derivation.\n\nProvide, as your final answer, the leading-order truncation error term as a single closed-form analytic expression in terms of $h$ and derivatives of $f$ evaluated at $x_i$. No numerical rounding is required, and no units are needed. The order of accuracy should be justified in your reasoning but should not be part of the final boxed answer.",
            "solution": "The problem requires the derivation of the order of accuracy and the leading truncation error term for the central difference approximation of the first derivative, $f'(x_i)$. The approximation is given by the formula $\\frac{f_{i+1}-f_{i-1}}{2h}$, where $f_j \\equiv f(x_j)$ and $x_{i \\pm 1} = x_i \\pm h$. The derivation must be founded on the Taylor series expansion of the function $f(x)$ about the point $x_i$.\n\nThe local truncation error, which we denote as $\\tau(x_i, h)$, is formally defined as the difference between the finite difference approximation applied to the exact function and the exact derivative it is intended to approximate. Thus, we have:\n$$\n\\tau(x_i, h) = \\frac{f(x_i+h) - f(x_i-h)}{2h} - f'(x_i)\n$$\nTo analyze this expression, we invoke the Taylor series for $f(x)$ expanded about the point $x_i$. The problem premise of $f(x)$ being \"sufficiently smooth\" ensures the validity of this expansion. We expand $f(x_i+h)$ and $f(x_i-h)$ and denote the $n$-th derivative of $f(x)$ evaluated at $x_i$ as $f^{(n)}(x_i)$. For clarity, we also use the notation $f_i \\equiv f(x_i)$.\n\nThe Taylor series expansion for $f(x_i+h)$ is:\n$$\nf_{i+1} = f(x_i+h) = f(x_i) + h f'(x_i) + \\frac{h^2}{2!} f''(x_i) + \\frac{h^3}{3!} f^{(3)}(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + \\frac{h^5}{5!} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nSubstituting the numerical values for the factorials:\n$$\nf_{i+1} = f_i + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + \\frac{h^5}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nSimilarly, the Taylor series expansion for $f(x_i-h)$ is:\n$$\nf_{i-1} = f(x_i-h) = f(x_i) + (-h) f'(x_i) + \\frac{(-h)^2}{2!} f''(x_i) + \\frac{(-h)^3}{3!} f^{(3)}(x_i) + \\frac{(-h)^4}{4!} f^{(4)}(x_i) + \\frac{(-h)^5}{5!} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nf_{i-1} = f_i - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) - \\frac{h^5}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nAs mandated by the problem, we now systematically demonstrate the cancellation of terms. We compute the difference $f_{i+1} - f_{i-1}$ which forms the numerator of the central difference formula.\n\\begin{align*}\nf_{i+1} - f_{i-1} =  \\left( f_i + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + \\dots \\right) \\\\\n - \\left( f_i - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) - \\dots \\right)\n\\end{align*}\nGrouping terms by the order of the derivative of $f(x)$:\n\\begin{align*}\n\\text{Zeroth-order:} \\quad  f_i - f_i = 0 \\\\\n\\text{First-order:} \\quad  h f'(x_i) - (-h f'(x_i)) = 2h f'(x_i) \\\\\n\\text{Second-order:} \\quad  \\frac{h^2}{2} f''(x_i) - \\frac{h^2}{2} f''(x_i) = 0 \\\\\n\\text{Third-order:} \\quad  \\frac{h^3}{6} f^{(3)}(x_i) - \\left(-\\frac{h^3}{6} f^{(3)}(x_i)\\right) = 2 \\frac{h^3}{6} f^{(3)}(x_i) = \\frac{h^3}{3} f^{(3)}(x_i) \\\\\n\\text{Fourth-order:} \\quad  \\frac{h^4}{24} f^{(4)}(x_i) - \\frac{h^4}{24} f^{(4)}(x_i) = 0 \\\\\n\\text{Fifth-order:} \\quad  \\frac{h^5}{120} f^{(5)}(x_i) - \\left(-\\frac{h^5}{120} f^{(5)}(x_i)\\right) = 2 \\frac{h^5}{120} f^{(5)}(x_i) = \\frac{h^5}{60} f^{(5)}(x_i)\n\\end{align*}\nThis calculation illustrates a key property of symmetric stencils: all terms corresponding to even-order derivatives ($f_i$, $f''(x_i)$, $f^{(4)}(x_i)$, etc.) cancel, while terms corresponding to odd-order derivatives ($f'(x_i)$, $f^{(3)}(x_i)$, $f^{(5)}(x_i)$, etc.) are additive.\n\nSumming the non-zero terms, the difference $f_{i+1} - f_{i-1}$ is:\n$$\nf_{i+1} - f_{i-1} = 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\nNow, we divide by $2h$ to construct the full central difference approximation:\n$$\n\\frac{f_{i+1} - f_{i-1}}{2h} = \\frac{1}{2h} \\left( 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + \\mathcal{O}(h^7) \\right)\n$$\n$$\n\\frac{f_{i+1} - f_{i-1}}{2h} = f'(x_i) + \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nBy subtracting $f'(x_i)$ from both sides, we isolate the truncation error $\\tau(x_i, h)$:\n$$\n\\tau(x_i, h) = \\frac{f_{i+1} - f_{i-1}}{2h} - f'(x_i) = \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nThe order of accuracy of a numerical scheme is determined by the lowest power of the grid spacing $h$ in the series expansion of the local truncation error. As $h \\to 0$, the term $\\frac{h^2}{6} f^{(3)}(x_i)$ is the dominant part of the error, assuming $f^{(3)}(x_i) \\neq 0$. The error is therefore proportional to $h^2$, which is written as $\\mathcal{O}(h^2)$. This means the central difference approximation is second-order accurate.\n\nThe leading-order truncation error term is the first non-zero term in the error series. From our derived expression, this term is:\n$$\n\\frac{h^2}{6} f^{(3)}(x_i)\n$$\nThis completes the required derivation.",
            "answer": "$$\n\\boxed{\\frac{h^2}{6} f^{(3)}(x_i)}\n$$"
        },
        {
            "introduction": "Building on fundamental analysis, we now move to the design of superior numerical schemes. This problem challenges you to derive the coefficients of a high-order accurate finite difference operator by enforcing the cancellation of low-order error terms . You will then connect this abstract design to a critical physical consequence in computational electromagnetics by analyzing how higher accuracy drastically reduces numerical dispersion for simulated waves.",
            "id": "3358119",
            "problem": "A one-dimensional lossless, homogeneous medium with permittivity $\\epsilon$ and permeability $\\mu$ supports transverse electromagnetic waves governed by Maxwell's equations, which imply the wave equation $\\partial_{tt} u = c^{2}\\,\\partial_{xx} u$ with $c = 1/\\sqrt{\\epsilon \\mu}$ for any field component $u(x,t)$ that is a solution. In computational electromagnetics, central finite differences on a uniform grid $x_{i} = x_{0} + i h$ with spacing $h$ are used to approximate spatial derivatives. Consider a symmetric $2m+1$-point central difference approximation of $\\partial_{x}$ on the stencil $\\{x_{i-m},\\dots,x_{i+m}\\}$:\n$$\nD_{h} u(x_{i}) \\coloneqq \\frac{1}{h} \\sum_{j=-m}^{m} a_{j}\\,u(x_{i}+j h),\n$$\nwith unknown real coefficients $a_{j}$ constrained by antisymmetry $a_{-j} = -a_{j}$ and $a_{0}=0$ to target odd-derivative accuracy. The design goal is order $2m$ accuracy, meaning the truncation error is $O(h^{2m})$.\n\nStarting from the Taylor series expansion of $u(x_{i} + j h)$ and moment-matching conditions implied by consistency with $\\partial_{x}$, construct the coefficients $\\{a_{j}\\}_{j=-m}^{m}$ for the case $m=3$. Then, for a Fourier mode $u(x) = \\exp(i k x)$, define the dimensionless wavenumber $\\xi \\coloneqq k h$ and derive the discrete wavenumber mapping $k_{d}(\\xi)$, defined by the symbol of $D_{h}$ via $D_{h} \\exp(i k x_{i}) = i\\,k_{d}(\\xi)\\,\\exp(i k x_{i})$. Use this to elucidate the discrete dispersion relation $\\omega = c\\,k_{d}(\\xi)$ for the semi-discrete wave equation with exact time derivatives and spatial discretization by $D_{h}$.\n\nTasks:\n1. Derive and solve the moment-matching conditions to obtain exact rational values for the positive-side stencil coefficients $a_{1}$, $a_{2}$, and $a_{3}$ ensuring order $6$ accuracy.\n2. Using these coefficients, derive the exact closed-form analytic expression for $k_{d}(\\xi)$.\n3. Briefly explain how the order $6$ spatial discretization influences discrete dispersion (phase and group velocities) for small $\\xi$ by extracting the leading-order term in the Taylor expansion of $k_{d}(\\xi)$ about $\\xi=0$.\n\nExpress the final discrete wavenumber mapping $k_{d}(\\xi)$ as a single exact analytic expression; do not round. No units are required in the final expression.",
            "solution": "### Solution Derivation\n\n**Task 1: Derivation of Stencil Coefficients**\n\nTo achieve an accuracy of order $2m=6$, the finite difference operator $D_h u(x)$ must match the Taylor series expansion of the exact derivative $\\partial_x u(x)$ up to terms of order $h^5$. The first non-vanishing error term should be of order $h^6$.\n\nFirst, we expand the operator $D_h$. Using the antisymmetry constraint $a_{-j} = -a_j$ and $a_0=0$:\n$$ D_h u(x) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\left[ u(x+jh) - u(x-jh) \\right] $$\nWe use the Taylor series expansion for $u(x+jh) - u(x-jh)$ around $x$:\n$$ u(x+jh) - u(x-jh) = \\sum_{n=0}^{\\infty} \\frac{u^{(n)}(x)}{n!} (jh)^n - \\sum_{n=0}^{\\infty} \\frac{u^{(n)}(x)}{n!} (-jh)^n = 2 \\sum_{k=0}^{\\infty} \\frac{u^{(2k+1)}(x)}{(2k+1)!} (jh)^{2k+1} $$\nSubstituting this into the expression for $D_h u(x)$:\n$$ D_h u(x) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\left[ 2(jh)u'(x) + \\frac{2(jh)^3}{3!}u'''(x) + \\frac{2(jh)^5}{5!}u^{(5)}(x) + \\frac{2(jh)^7}{7!}u^{(7)}(x) + O(h^9) \\right] $$\nGrouping terms by derivative order:\n$$ D_h u(x) = u'(x) \\left[ 2 \\sum_{j=1}^{m} j a_j \\right] + u'''(x) \\left[ \\frac{h^2}{3} \\sum_{j=1}^{m} j^3 a_j \\right] + u^{(5)}(x) \\left[ \\frac{h^4}{60} \\sum_{j=1}^{m} j^5 a_j \\right] + u^{(7)}(x) \\left[ \\frac{h^6}{2520} \\sum_{j=1}^{m} j^7 a_j \\right] + \\dots $$\nFor $D_h u(x)$ to approximate $\\partial_x u(x)$ with an error of $O(h^6)$, we must match the coefficient of $u'(x)$ to $1$ and set the coefficients of $u'''(x)$ and $u^{(5)}(x)$ to zero. For $m=3$, this yields a system of three linear equations for the coefficients $a_1, a_2, a_3$:\n1. $2 \\sum_{j=1}^{3} j a_j = 1 \\implies a_1 + 2a_2 + 3a_3 = \\frac{1}{2}$\n2. $\\sum_{j=1}^{3} j^3 a_j = 0 \\implies a_1 + 8a_2 + 27a_3 = 0$\n3. $\\sum_{j=1}^{3} j^5 a_j = 0 \\implies a_1 + 32a_2 + 243a_3 = 0$\n\nWe solve this system. Subtracting equation (2) from (3):\n$$ (32-8)a_2 + (243-27)a_3 = 0 \\implies 24a_2 + 216a_3 = 0 \\implies a_2 = -9a_3 $$\nSubtracting equation (1) from (2):\n$$ (8-2)a_2 + (27-3)a_3 = -\\frac{1}{2} \\implies 6a_2 + 24a_3 = -\\frac{1}{2} $$\nSubstituting $a_2 = -9a_3$ into this new equation:\n$$ 6(-9a_3) + 24a_3 = -\\frac{1}{2} \\implies -54a_3 + 24a_3 = -\\frac{1}{2} \\implies -30a_3 = -\\frac{1}{2} \\implies a_3 = \\frac{1}{60} $$\nBack-substituting to find $a_2$ and $a_1$:\n$$ a_2 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20} $$\n$$ a_1 = \\frac{1}{2} - 2a_2 - 3a_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right) = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{30}{60} + \\frac{18}{60} - \\frac{3}{60} = \\frac{45}{60} = \\frac{3}{4} $$\nThe coefficients are $a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, and $a_3 = \\frac{1}{60}$.\n\n**Task 2: Derivation of the Discrete Wavenumber $k_d(\\xi)$**\n\nWe apply the operator $D_h$ to the Fourier mode $u(x_i) = \\exp(i k x_i)$:\n$$ D_h \\exp(i k x_i) = \\frac{1}{h} \\sum_{j=-m}^{m} a_j \\exp(i k(x_i+jh)) = \\frac{\\exp(i k x_i)}{h} \\sum_{j=-m}^{m} a_j \\exp(i kjh) $$\nUsing $a_{-j}=-a_j$ and $a_0=0$, the sum becomes:\n$$ \\sum_{j=-m}^{m} a_j \\exp(i kjh) = \\sum_{j=1}^{m} \\left( a_j \\exp(i kjh) + a_{-j} \\exp(-i kjh) \\right) = \\sum_{j=1}^{m} a_j \\left( \\exp(i kjh) - \\exp(-i kjh) \\right) $$\nUsing Euler's identity, $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, and the definition $\\xi = kh$:\n$$ \\sum_{j=1}^{m} a_j (2i\\sin(kjh)) = 2i \\sum_{j=1}^{m} a_j \\sin(j\\xi) $$\nSubstituting this back into the expression for $D_h$:\n$$ D_h \\exp(i k x_i) = \\frac{\\exp(i k x_i)}{h} \\left( 2i \\sum_{j=1}^{m} a_j \\sin(j\\xi) \\right) = i \\left( \\frac{2}{h} \\sum_{j=1}^{m} a_j \\sin(j\\xi) \\right) \\exp(i k x_i) $$\nBy comparing this with the definition $D_{h} \\exp(i k x_{i}) = i k_{d}(\\xi) \\exp(i k x_{i})$, we identify the discrete wavenumber mapping:\n$$ k_d(\\xi) = \\frac{2}{h} \\sum_{j=1}^{m} a_j \\sin(j\\xi) $$\nFor $m=3$, using the coefficients found in Task 1:\n$$ k_d(\\xi) = \\frac{2}{h} \\left( a_1 \\sin(\\xi) + a_2 \\sin(2\\xi) + a_3 \\sin(3\\xi) \\right) $$\n$$ k_d(\\xi) = \\frac{2}{h} \\left( \\frac{3}{4} \\sin(\\xi) - \\frac{3}{20} \\sin(2\\xi) + \\frac{1}{60} \\sin(3\\xi) \\right) $$\n$$ k_d(\\xi) = \\frac{1}{h} \\left( \\frac{3}{2} \\sin(\\xi) - \\frac{3}{10} \\sin(2\\xi) + \\frac{1}{30} \\sin(3\\xi) \\right) $$\nTo obtain a more compact form, we can place all terms over a common denominator of $30$:\n$$ k_d(\\xi) = \\frac{1}{30h} \\left( 45 \\sin(\\xi) - 9 \\sin(2\\xi) + \\sin(3\\xi) \\right) $$\n\n**Task 3: Analysis of Discrete Dispersion**\n\nThe influence of discretization is understood by comparing the discrete wavenumber $k_d$ to the exact wavenumber $k = \\xi/h$. We expand $k_d(\\xi)$ in a Taylor series for small $\\xi$.\n$$ \\sin(x) = x - \\frac{x^3}{6} + \\frac{x^5}{120} - \\frac{x^7}{5040} + O(x^9) $$\nExpanding each term in the expression for $h k_d(\\xi)$:\n$$ h k_d(\\xi) = \\frac{3}{2}\\left(\\xi - \\frac{\\xi^3}{6} + \\frac{\\xi^5}{120} - \\frac{\\xi^7}{5040} + \\dots\\right) - \\frac{3}{10}\\left(2\\xi - \\frac{(2\\xi)^3}{6} + \\frac{(2\\xi)^5}{120} - \\frac{(2\\xi)^7}{5040} + \\dots\\right) + \\frac{1}{30}\\left(3\\xi - \\frac{(3\\xi)^3}{6} + \\frac{(3\\xi)^5}{120} - \\frac{(3\\xi)^7}{5040} + \\dots\\right) $$\nCollecting coefficients of powers of $\\xi$:\nThe coefficients of $\\xi^1, \\xi^3, \\xi^5$ are $1, 0, 0$ respectively, as designed by the moment-matching conditions. The first non-zero error term is for $\\xi^7$.\nThe expansion is:\n$$ h k_d(\\xi) = \\xi - \\frac{1}{140}\\xi^7 + O(\\xi^9) $$\n$$ k_d(\\xi) = \\frac{\\xi}{h} - \\frac{\\xi^7}{140h} + O\\left(\\frac{\\xi^9}{h}\\right) $$\nSince $k = \\xi/h$, we can write this as $k_d(k) = k - \\frac{(kh)^6}{140}k + O(h^8)$. The error in wavenumber, $k_d-k$, is of order $h^6$, consistent with the scheme's design.\n\nThis error leads to numerical dispersion. The discrete phase velocity is $v_{p,d} = \\frac{\\omega}{k} = \\frac{c k_d}{k} = c \\frac{k_d(\\xi)}{\\xi/h} = c \\frac{h k_d(\\xi)}{\\xi}$.\n$$ v_{p,d} = c \\left( 1 - \\frac{1}{140}\\xi^6 + O(\\xi^8) \\right) = c \\left( 1 - \\frac{1}{140}(kh)^6 + O((kh)^8) \\right) $$\nThe numerical phase velocity is less than $c$ (lagging phase error) and depends on the wavenumber $k$, causing different Fourier components to travel at different speeds, which is the essence of numerical dispersion. The error's dependence on the sixth power of $kh$ indicates that the dispersion is very small for well-resolved waves (small $kh$).",
            "answer": "$$\\boxed{\\frac{1}{30h} \\left( 45 \\sin(\\xi) - 9 \\sin(2\\xi) + \\sin(3\\xi) \\right)}$$"
        },
        {
            "introduction": "Numerical schemes are often modified in practice to handle issues like instability or artifacts, but these modifications can have hidden theoretical costs. This exercise examines the popular Finite-Difference Time-Domain (FDTD) method, augmented with a spatial filter to reduce numerical noise . Using modified equation analysis, you will discover that this seemingly helpful addition introduces artificial dissipation and degrades the scheme's formal order of accuracy, illustrating a common trade-off between practical performance and theoretical precision.",
            "id": "3358120",
            "problem": "Consider one-dimensional source-free Maxwell equations in a homogeneous vacuum, written in normalized units so that the speed of light is $c$ and permittivity and permeability are unity:\n$$\n\\partial_{t} E(x,t) \\,=\\, -\\,\\partial_{x} H(x,t),\\qquad\n\\partial_{t} H(x,t) \\,=\\, -\\,\\partial_{x} E(x,t).\n$$\nDiscretize these equations on a uniform grid of spacing $h$ using the canonical staggered-grid leapfrog scheme of the Finite-Difference Time-Domain (FDTD) method, in which electric field samples $E^{n}_{i}$ are located at integer grid points $x_{i}=i\\,h$ at times $t^{n}=n\\,\\Delta t$, and magnetic field samples $H^{n+\\frac{1}{2}}_{i+\\frac{1}{2}}$ are located at half-grid points $x_{i+\\frac{1}{2}}=(i+\\frac{1}{2})h$ at half-integer times $t^{n+\\frac{1}{2}}=\\left(n+\\frac{1}{2}\\right)\\Delta t$. Assume periodic boundary conditions and a Courant–Friedrichs–Lewy number $\\lambda$ defined by $\\lambda = c\\,\\Delta t / h \\in (0,1)$ held fixed as $h\\to 0$.\n\nTo suppress high-wavenumber staircasing artifacts originating from geometric discretization, augment the scheme with an explicit post-update spatial filter applied at every full time step to both field components on their respective grids. Specifically, after the standard FDTD updates that advance $(E^{n}_{i},H^{n+\\frac{1}{2}}_{i+\\frac{1}{2}})$ to $(E^{n+1}_{i},H^{n+\\frac{3}{2}}_{i+\\frac{1}{2}})$, apply the three-point smoothing\n$$\n\\widetilde{u}^{n+1}_{j} \\,=\\, (1-\\beta)\\,u^{n+1}_{j} \\,+\\, \\frac{\\beta}{2}\\left(u^{n+1}_{j+1} + u^{n+1}_{j-1}\\right),\n$$\nwith $u$ denoting either $E$ at integer indices $j=i$ or $H$ at half-integer indices $j=i+\\frac{1}{2}$, and with a constant filter strength $\\beta\\in(0,1)$ independent of $h$ and $\\Delta t$.\n\nUsing a modified-equation analysis grounded in Taylor expansions for smooth solutions, derive the leading-order continuum equation perturbed by the filtering step and identify the effective artificial dissipation term it introduces. From this, determine the formal order of accuracy $p$ of the filtered scheme under mesh refinement with fixed $\\lambda$ and constant $\\beta$. Express the effective artificial dissipation coefficient as a closed-form analytic expression in terms of $\\beta$, $c$, $h$, and $\\lambda$, and provide the integer $p$.\n\nYour final answer must consist of these two quantities together. No numerical evaluation or rounding is required. The final answer must be given as a single row matrix.",
            "solution": "### Solution\n\nThe analysis aims to find the modified partial differential equation that the specified numerical scheme approximates. This is achieved by performing a Taylor series expansion of the discrete operators.\n\nFirst, we clarify the governing equations. The problem provides a normalized form where the wave speed is $1$. However, it defines the CFL number $\\lambda$ with a symbolic speed $c$. To provide a general result, we consider the 1D Maxwell's equations for a medium with unit impedance, where $c$ is the wave speed:\n$$ \n\\partial_t E = -c \\partial_x H \\\\\n\\partial_t H = -c \\partial_x E \n$$\nThese equations reduce to the form given in the problem for $c=1$. The standard leapfrog FDTD discretization for this system is:\n$$ \n\\frac{E^{n+1}_i - E^{n}_i}{\\Delta t} = -c \\frac{H^{n+1/2}_{i+1/2} - H^{n+1/2}_{i-1/2}}{h} \\\\\n\\frac{H^{n+1/2}_{i+1/2} - H^{n-1/2}_{i+1/2}}{\\Delta t} = -c \\frac{E^{n}_{i+1} - E^{n}_{i}}{h} \n$$\nThis scheme is known to be second-order accurate, with a truncation error of $O(\\Delta t^2, h^2)$.\n\nThe problem introduces an explicit post-update spatial filter. Let $u$ represent either field, $E$ or $H$. After a standard FDTD update calculates a new field value, which we denote $u^{n+1, *}$, a filtering step is applied to obtain the final value $u^{n+1}$:\n$$ u^{n+1}_j = \\widetilde{u}^{n+1, *}_j = (1-\\beta)u^{n+1, *}_j + \\frac{\\beta}{2}\\left(u^{n+1, *}_{j+1} + u^{n+1, *}_{j-1}\\right) $$\nThis can be rewritten as:\n$$ u^{n+1}_j = u^{n+1, *}_j + \\frac{\\beta}{2}\\left(u^{n+1, *}_{j+1} - 2u^{n+1, *}_j + u^{n+1, *}_{j-1}\\right) $$\nThe term in the parenthesis is a discrete approximation of $h^2 \\partial_{xx}u$. The effect of the filter is to add a term to the solution at each step.\n\nTo find the modified equation, we analyze how this filtering step alters the time evolution. The evolution over a single time step $\\Delta t$ is modified from $u^{n+1,*} - u^n$ to $u^{n+1} - u^n$. The change to the finite difference equation for the time derivative is:\n$$ \\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{u^{n+1,*} - u^n}{\\Delta t} + \\frac{u^{n+1} - u^{n+1,*}}{\\Delta t} $$\nThe first term on the right-hand side represents the standard FDTD update. The second term is the contribution from the filter:\n$$ \\frac{u^{n+1} - u^{n+1,*}}{\\Delta t} = \\frac{1}{\\Delta t} \\left[ \\frac{\\beta}{2}\\left(u^{n+1, *}_{j+1} - 2u^{n+1, *}_j + u^{n+1, *}_{j-1}\\right) \\right] = \\frac{\\beta h^2}{2\\Delta t} \\left( \\frac{u^{n+1, *}_{j+1} - 2u^{n+1, *}_j + u^{n+1, *}_{j-1}}{h^2} \\right) $$\nLet $\\delta_{xx}$ denote the standard second-order accurate centered finite-difference operator for the second spatial derivative. The term added to the update equation is $\\frac{\\beta h^2}{2\\Delta t} \\delta_{xx} u^{n+1, *}$.\n\nIn a modified-equation analysis, we substitute smooth functions into the discrete equation and expand in Taylor series. As the grid parameters $h$ and $\\Delta t$ approach zero, the unfiltered field $u^{n+1,*}$ approaches the exact solution $u(x, t+\\Delta t)$, which in turn approaches $u(x,t)$. Thus, to find the leading-order modification to the PDE, we can approximate $\\delta_{xx} u^{n+1, *}$ by $\\partial_{xx} u$. The error in this approximation affects only higher-order terms in the modified equation.\n\nThe original FDTD scheme approximates the PDE $\\partial_t u = -c \\partial_x v$ with an error of $O(h^2, \\Delta t^2)$. The filtering process introduces an additional term to the PDE:\n$$ (\\text{Added Term}) = \\frac{\\beta h^2}{2\\Delta t} \\partial_{xx} u $$\nThis is an artificial dissipation (or diffusion) term. Its coefficient, the effective artificial dissipation coefficient, is:\n$$ D = \\frac{\\beta h^2}{2\\Delta t} $$\nThe problem specifies that the CFL number $\\lambda = c \\Delta t / h$ is held constant. We can express $\\Delta t$ in terms of $h$: $\\Delta t = \\lambda h / c$. Substituting this into the expression for $D$:\n$$ D = \\frac{\\beta h^2}{2 (\\lambda h / c)} = \\frac{\\beta c h}{2\\lambda} $$\nThe modified equations for the system, including the leading-order error term from filtering, are:\n$$ \\partial_t E = -c \\partial_x H + D \\partial_{xx} E + O(h^2) $$\n$$ \\partial_t H = -c \\partial_x E + D \\partial_{xx} H + O(h^2) $$\nThe truncation error of the standard FDTD scheme is $O(h^2, \\Delta t^2)$, which is $O(h^2)$ since $\\lambda$ is fixed. The leading error term introduced by the filter is $D \\partial_{xx} u$. The magnitude of this term is determined by the coefficient $D$:\n$$ D = \\frac{\\beta c h}{2\\lambda} = O(h) $$\nSince this newly introduced error term is $O(h)$, it is of lower order than the $O(h^2)$ truncation error of the underlying FDTD scheme. Therefore, the dissipation term dominates the total truncation error of the filtered scheme. The formal order of accuracy $p$ of the scheme is determined by the lowest power of $h$ in the truncation error, which is $1$.\n\nThus, the effective artificial dissipation coefficient is $D = \\frac{\\beta c h}{2\\lambda}$, and the formal order of accuracy is $p=1$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\beta c h}{2\\lambda}  1 \\end{pmatrix} } $$"
        }
    ]
}