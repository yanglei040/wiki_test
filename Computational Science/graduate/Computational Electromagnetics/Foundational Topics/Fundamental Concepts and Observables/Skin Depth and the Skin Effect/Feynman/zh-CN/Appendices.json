{
    "hands_on_practices": [
        {
            "introduction": "掌握趋肤效应的第一步是量化其特征长度——趋肤深度 $\\delta$。这个练习将我们置于音频工程的实际场景中，以接地气的方式巩固良导体中趋肤深度的计算，并揭示其与频率的依赖关系。通过这个基础计算，我们可以为更复杂的分析建立一个直观的认识。",
            "id": "1820232",
            "problem": "一位音响工程师正在设计一个高保真音响系统，他关心的是“趋肤效应”（skin effect），这是一种高频交流电倾向于主要在导体表面附近流动的现象。这种效应会增加导线的有效电阻，从而降低音频信号的质量，特别是对于高音频率。该工程师考虑使用一根标准的扬声器电缆，它可以被建模为一根由铜制成的长实心圆柱形导线。一个常见的工程经验法则是，当趋肤深度 $\\delta$ 等于导体的半径时，趋肤效应变得显著。\n\n已知铜线的半径为 $r = 1.00 \\text{ mm}$，请确定满足此条件的临界频率。假设铜是一种非磁性材料，其电导率为 $\\sigma = 5.96 \\times 10^7 \\text{ S/m}$。铜的磁导率可以取为自由空间的磁导率，即 $\\mu_0 = 4\\pi \\times 10^{-7} \\text{ H/m}$。\n\n计算这个临界频率，并以千赫兹 (kHz) 为单位表示。将你的最终答案四舍五入到三位有效数字。",
            "solution": "在良导体中，对于角频率为 $\\omega$ 的正弦电流，趋肤深度由下式给出\n$$\\delta=\\sqrt{\\frac{2}{\\mu \\sigma \\omega}},$$\n其中 $\\omega=2\\pi f$。显著趋肤效应的开始被认为是在 $\\delta=r$ 时，所以令 $\\delta=r$ 并求解 $f$：\n$$r=\\sqrt{\\frac{2}{\\mu \\sigma (2\\pi f)}} \\implies r^{2}=\\frac{1}{\\mu \\sigma \\pi f} \\implies f=\\frac{1}{\\pi \\mu \\sigma r^{2}}.$$\n对于铜，$\\mu=\\mu_{0}=4\\pi \\times 10^{-7}\\ \\text{H/m}$，$\\sigma=5.96 \\times 10^{7}\\ \\text{S/m}$ 且 $r=1.00 \\times 10^{-3}\\ \\text{m}$。代入：\n$$f=\\frac{1}{\\pi (4\\pi \\times 10^{-7})(5.96 \\times 10^{7})(1.00 \\times 10^{-3})^{2}}=\\frac{1}{(4\\pi^{2} \\times 10^{-7})(5.96 \\times 10^{7})(1.00 \\times 10^{-6})}.$$\n合并因子：\n$$(4\\pi^{2} \\times 10^{-7})(5.96 \\times 10^{7})(1.00 \\times 10^{-6})=23.84\\,\\pi^{2} \\times 10^{-6} \\approx 2.352913689 \\times 10^{-4},$$\n所以\n$$f \\approx \\frac{1}{2.352913689 \\times 10^{-4}}\\ \\text{Hz} \\approx 4.25005 \\times 10^{3}\\ \\text{Hz}.$$\n以千赫兹表示，\n$$f \\approx 4.25005\\ \\text{kHz},$$\n保留三位有效数字为 $4.25\\ \\text{kHz}$。",
            "answer": "$$\\boxed{4.25}$$"
        },
        {
            "introduction": "仅仅计算趋肤深度是不够的，我们还必须理解其物理后果。本练习引导我们从一个简单的公式走向第一性原理推导，展示电磁场如何指数衰减，并最终导致焦耳热集中在导体表面。这对于准确预测功率损耗和热效应至关重要。",
            "id": "3348529",
            "problem": "一均匀、各向同性、线性的半无限导电介质占据了半空间 $z \\ge 0$。该介质的电导率为 $\\sigma$，磁导率为 $\\mu$，介电常数为 $\\varepsilon$。在边界 $z=0$ 处施加一个角频率为 $\\omega$ 的外加、空间均匀、时谐切向磁场，使得在导体内部 $z=0^{+}$ 处，切向磁场的相量振幅在 $\\hat{x}$ 方向上为 $H_{0}$。假设所有场量均不依赖于 $x$ 和 $y$，仅随深度 $z$ 变化，并对时谐场采用相量约定 $\\exp(j \\omega t)$。\n\n在良导体的扩散极限下进行分析，此极限下传导电流远大于位移电流，即 $\\omega \\varepsilon \\ll \\sigma$。从麦克斯韦方程组和上述假设出发，推导在此极限下电场与磁场空间变化之间的关系，并用此关系求出导体内部时间平均的体积焦耳热密度 $q(z)$ 对深度的依赖关系。施加物理上允许的辐射条件，即场在 $z \\to +\\infty$ 时衰减，并使用边界条件 $H_{x}(0)=H_{0}$。\n\n提供一个 $q(z)$ 的单一闭式解析表达式，该表达式仅用 $\\mu$、$\\sigma$、$\\omega$、$H_{0}$ 和 $z$ 表示。答案需用国际单位制（SI）的基本单位表示。无需四舍五入，也不应进行数值代入。",
            "solution": "该问题要求解在表面受到切向磁场作用的良导体内部的时间平均体积焦耳热密度 $q(z)$。我们从无源区的麦克斯韦方程组出发，使用时谐相量约定 $\\exp(j \\omega t)$。相关方程为安培定律和法拉第定律：\n$$ \\nabla \\times \\vec{H} = \\vec{J}_{total} $$\n$$ \\nabla \\times \\vec{E} = -j \\omega \\vec{B} $$\n在线性导电介质中，总电流密度 $\\vec{J}_{total}$ 由传导电流 $\\vec{J} = \\sigma \\vec{E}$ 和位移电流 $j \\omega \\vec{D}$ 组成。对于均匀、各向同性、线性介质，其本构关系为 $\\vec{D} = \\varepsilon \\vec{E}$ 和 $\\vec{B} = \\mu \\vec{H}$。将这些关系代入麦克斯韦方程组，得到：\n$$ \\nabla \\times \\vec{H} = \\sigma \\vec{E} + j \\omega \\varepsilon \\vec{E} = (\\sigma + j \\omega \\varepsilon) \\vec{E} $$\n$$ \\nabla \\times \\vec{E} = -j \\omega \\mu \\vec{H} $$\n问题设定在良导体的扩散极限下，此时传导电流远大于位移电流。这由条件 $\\sigma \\gg \\omega \\varepsilon$ 指定。在此近似下，项 $\\sigma + j \\omega \\varepsilon$ 简化为 $\\sigma$。安培定律变为：\n$$ \\nabla \\times \\vec{H} \\approx \\sigma \\vec{E} $$\n该方程给出了第一个所要求的关系，即电场 $\\vec{E}$ 和磁场 $\\vec{H}$ 的空间变化之间的关系：\n$$ \\vec{E} = \\frac{1}{\\sigma} \\nabla \\times \\vec{H} $$\n为求场的空间依赖性，我们推导 $\\vec{H}$ 的波动方程。我们对法拉第定律取旋度：\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla \\times (-j \\omega \\mu \\vec{H}) = -j \\omega \\mu (\\nabla \\times \\vec{H}) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{V}) = \\nabla(\\nabla \\cdot \\vec{V}) - \\nabla^2 \\vec{V}$，并代入 $\\nabla \\times \\vec{H} = \\sigma \\vec{E}$，我们得到：\n$$ \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E} = -j \\omega \\mu \\sigma \\vec{E} $$\n从 $\\nabla \\times \\vec{H} = \\sigma \\vec{E}$ 出发，对其取散度得到 $\\nabla \\cdot (\\nabla \\times \\vec{H}) = \\nabla \\cdot (\\sigma \\vec{E})$。旋度的散度恒为零，因此 $\\sigma (\\nabla \\cdot \\vec{E}) = 0$。对于非零电导率 $\\sigma$，这意味着 $\\nabla \\cdot \\vec{E} = 0$。因此，$\\vec{E}$ 的波动方程简化为矢量亥姆霍兹方程：\n$$ \\nabla^2 \\vec{E} = j \\omega \\mu \\sigma \\vec{E} $$\n可以为 $\\vec{H}$ 推导出类似的方程：\n$$ \\nabla \\times (\\nabla \\times \\vec{H}) = \\nabla \\times (\\sigma \\vec{E}) = \\sigma (\\nabla \\times \\vec{E}) = \\sigma (-j \\omega \\mu \\vec{H}) = -j \\omega \\mu \\sigma \\vec{H} $$\n使用矢量恒等式以及 $\\nabla \\cdot \\vec{B} = \\mu \\nabla \\cdot \\vec{H} = 0$（这意味着 $\\nabla \\cdot \\vec{H} = 0$），我们得到：\n$$ \\nabla^2 \\vec{H} = j \\omega \\mu \\sigma \\vec{H} $$\n问题陈述所有场量均不依赖于 $x$ 和 $y$，因此 $\\partial/\\partial x = 0$ 且 $\\partial/\\partial y = 0$。算符 $\\nabla^2$ 简化为 $d^2/dz^2$。边界条件为 $\\vec{H}(z=0) = H_0 \\hat{x}$，这意味着磁场在 $\\hat{x}$ 方向上极化。没有源来产生其他分量，因此我们可以写出 $\\vec{H}(z) = H_x(z) \\hat{x}$。$H_x(z)$ 的亥姆霍兹方程为：\n$$ \\frac{d^2 H_x(z)}{dz^2} = j \\omega \\mu \\sigma H_x(z) $$\n这是一个形式为 $d^2f/dz^2 - \\gamma^2 f = 0$ 的二阶常微分方程，其中传播常数 $\\gamma$ 由 $\\gamma^2 = j \\omega \\mu \\sigma$ 给出。其通解为 $H_x(z) = A e^{-\\gamma z} + B e^{\\gamma z}$。\n\n为了求出 $\\gamma$ 的具体值，我们计算 $j$ 的平方根：\n$$ j = \\exp(j\\pi/2) \\implies \\sqrt{j} = \\exp(j\\pi/4) = \\cos(\\pi/4) + j\\sin(\\pi/4) = \\frac{1+j}{\\sqrt{2}} $$\n我们选择实部为正的根，以满足场在 $z \\to \\infty$ 时衰减的辐射条件。因此：\n$$ \\gamma = \\sqrt{j \\omega \\mu \\sigma} = \\sqrt{\\omega \\mu \\sigma} \\left( \\frac{1+j}{\\sqrt{2}} \\right) = \\sqrt{\\frac{\\omega \\mu \\sigma}{2}} (1+j) $$\n$\\gamma$ 的实部 $\\alpha = \\sqrt{\\omega \\mu \\sigma / 2}$ 是衰减常数。虚部 $\\beta = \\sqrt{\\omega \\mu \\sigma / 2}$ 是相位常数。趋肤深度 $\\delta$ 定义为衰减常数的倒数，$\\delta = 1/\\alpha = \\sqrt{2/(\\omega \\mu \\sigma)}$。因此，$\\gamma$ 可以写为 $\\gamma = \\frac{1}{\\delta} + j\\frac{1}{\\delta}$。\n\n辐射条件 $\\lim_{z \\to \\infty} H_x(z) = 0$ 要求增长指数项的系数 $B$ 必须为零。解的形式为 $H_x(z) = A e^{-\\gamma z}$。\n在 $z=0$ 处应用边界条件 $H_x(0) = H_0$，我们得到 $A=H_0$。因此，导体内部的磁场为：\n$$ \\vec{H}(z) = H_0 e^{-\\gamma z} \\hat{x} = H_0 \\exp\\left(-z \\sqrt{\\frac{\\omega \\mu \\sigma}{2}}\\right) \\exp\\left(-j z \\sqrt{\\frac{\\omega \\mu \\sigma}{2}}\\right) \\hat{x} $$\n接下来，我们使用关系式 $\\vec{E} = \\frac{1}{\\sigma} \\nabla \\times \\vec{H}$ 来求电场：\n$$ \\nabla \\times \\vec{H} = \\nabla \\times (H_x(z) \\hat{x}) = \\frac{d H_x}{dz} \\hat{y} = (-\\gamma H_x(z)) \\hat{y} $$\n$$ \\vec{E}(z) = \\frac{1}{\\sigma} (-\\gamma H_x(z)) \\hat{y} = -\\frac{\\gamma}{\\sigma} H_0 e^{-\\gamma z} \\hat{y} $$\n时间平均的体积焦耳热密度 $q(z)$ 由 $q(z) = \\frac{1}{2}\\text{Re}\\{\\vec{J} \\cdot \\vec{E}^*\\}$ 给出，其中 $\\vec{E}^*$ 是 $\\vec{E}$ 的复共轭。使用欧姆定律 $\\vec{J} = \\sigma \\vec{E}$，上式简化为：\n$$ q(z) = \\frac{1}{2}\\text{Re}\\{\\sigma \\vec{E} \\cdot \\vec{E}^*\\} = \\frac{\\sigma}{2} |\\vec{E}(z)|^2 $$\n我们现在计算 $|\\vec{E}(z)|^2$：\n$$ |\\vec{E}(z)|^2 = \\left| -\\frac{\\gamma}{\\sigma} H_0 e^{-\\gamma z} \\right|^2 = \\frac{|\\gamma|^2}{\\sigma^2} |H_0|^2 |e^{-\\gamma z}|^2 $$\n这里，$H_0$ 是边界处的相量振幅，我们假设其为实数，代表场的峰值，因此 $|H_0|^2 = H_0^2$。\n项 $|\\gamma|^2 = |\\gamma^2| = |j \\omega \\mu \\sigma| = \\omega \\mu \\sigma$。\n项 $|e^{-\\gamma z}|^2$ 是 $|e^{-(\\alpha+j\\beta)z}|^2 = |e^{-\\alpha z} e^{-j\\beta z}|^2 = (e^{-\\alpha z})^2 = e^{-2\\alpha z}$。\n代入 $\\alpha = \\sqrt{\\omega \\mu \\sigma / 2}$：\n$$ e^{-2\\alpha z} = \\exp\\left(-2z \\sqrt{\\frac{\\omega \\mu \\sigma}{2}}\\right) = \\exp(-z \\sqrt{2 \\omega \\mu \\sigma}) $$\n结合这些结果求 $q(z)$：\n$$ q(z) = \\frac{\\sigma}{2} \\left( \\frac{\\omega \\mu \\sigma}{\\sigma^2} H_0^2 \\right) \\exp(-z \\sqrt{2 \\omega \\mu \\sigma}) $$\n$$ q(z) = \\frac{\\sigma}{2} \\frac{\\omega \\mu}{\\sigma} H_0^2 \\exp(-z \\sqrt{2 \\omega \\mu \\sigma}) $$\n$$ q(z) = \\frac{\\omega \\mu H_0^2}{2} \\exp(-z \\sqrt{2 \\omega \\mu \\sigma}) $$\n这个 $q(z)$ 的表达式是用所要求的参数 $\\mu$、$\\sigma$、$\\omega$、$H_0$ 和 $z$ 表示的。它表明焦耳热在表面 ($z=0$) 处达到最大值，并以特征长度 $\\delta/2 = 1/\\sqrt{2\\omega\\mu\\sigma}$ 指数衰减进入导体内部。",
            "answer": "$$\\boxed{\\frac{\\omega \\mu H_{0}^{2}}{2} \\exp(-z \\sqrt{2 \\omega \\mu \\sigma})}$$"
        },
        {
            "introduction": "解析解虽然深刻，但通常仅限于简单的几何结构，而计算方法则为解决复杂问题提供了通用框架。最后的这个练习旨在架起理论与计算现实之间的桥梁，指导你为一维亥姆霍兹方程构建一个数值求解器。通过这个实践，你不仅能通过离散化过程加深对底层物理的理解，还能掌握对照解析解验证数值模型的基本方法。",
            "id": "3348496",
            "problem": "您的任务是为位于半空间 $z \\ge 0$ 中的均匀、各向同性、线性导体内的趋肤效应，构建并实现一种数值方法及误差分析。在表面 $z=0$ 处施加一个角频率为 $\\omega$、振幅为 $E_0$ 的时谐切向电场，该电场产生的场会在导体内部衰减。您的目标是从基本电磁定律出发，推导导体内部切向电场振幅一维分布的控制方程，在有限区间上离散化该方程，并将数值估计的趋肤深度与从第一性原理推导出的精确解析趋肤深度进行比较。\n\n您的推导应基于麦克斯韦-法拉第方程和麦克斯韦-安培方程在时谐场（时间依赖关系为 $\\mathrm{e}^{j \\omega t}$）下的相量形式，以及在均匀、各向同性、线性介质假设下，电导率为 $\\sigma$、磁导率为 $\\mu$、介电常数为 $\\epsilon$ 的导体的标准本构关系。使用法向入射的均匀平面波，其切向电场仅依赖于导体内部的深度坐标 $z$ 的情况。请对您使用的所有变量进行引入和定义。对于缩写词，在首次使用时需进行定义，例如常微分方程 (Ordinary Differential Equation, ODE) 和偏微分方程 (Partial Differential Equation, PDE)。\n\n您的程序必须为每个测试用例执行以下步骤：\n- 从麦克斯韦方程组出发，推导导体中切向电场振幅 $E(z)$ 作为深度 $z$ 的函数的一维控制常微分方程。推导过程不得假设任何关于趋肤深度或传播常数的已知公式。\n- 根据您的推导，为给定频率范围内的良导体获得趋肤深度 $\\delta$ 的闭式解析表达式。该公式必须物理上正确且量纲一致，并且必须从推导出的常微分方程和边界条件逻辑推导得出。\n- 使用二阶中心差分格式，在具有 $N$ 个等长子区间（$N+1$ 个节点）的均匀网格上，将得到的常微分方程在有限区间 $z \\in [0,L]$ 上进行离散化，并采用狄利克雷边界条件 $E(0) = E_0$ 和 $E(L) = 0$。此处 $E_0$ 是施加在表面的实数振幅；在数值计算中取 $E_0 = 1$ 伏特/米（该单位对于算法的数值部分并非必需）。\n- 求解得到的线性系统，以获得内部节点处的复相量场样本 $E(z_i)$，其中 $z_i = i \\Delta z$，$\\Delta z = L/N$， $i \\in \\{1,2,\\dots,N-1\\}$。\n- 通过定位场强幅值衰减到 $E_0/\\mathrm{e}$ 的深度，来计算趋肤深度的数值估计值 $\\delta_{\\mathrm{num}}$。在第一个跨越该阈值的连续网格点之间使用对数插值；即，如果 $|E(z_k)| \\ge E_0/\\mathrm{e}$ 且 $|E(z_{k+1})|  E_0/\\mathrm{e}$，则定义\n  $$ \\delta_{\\mathrm{num}} = z_k + \\frac{\\ln\\left(\\frac{E_0}{\\mathrm{e}}\\right) - \\ln|E(z_k)|}{\\ln|E(z_{k+1})| - \\ln|E(z_k)|} \\, \\Delta z. $$\n- 使用您推导出的精确趋肤深度 $\\delta$ 的解析表达式，计算相对误差\n  $$ \\varepsilon = \\left|\\frac{\\delta_{\\mathrm{num}} - \\delta}{\\delta}\\right|. $$\n- 将 $\\delta$ 和 $\\delta_{\\mathrm{num}}$ 以米为单位表示。将 $\\varepsilon$ 报告为小数（而非百分比）。程序必须仅输出下述测试套件的 $\\varepsilon$ 值列表。\n\n测试套件：\n每个测试用例是一个元组 $(\\sigma,\\mu,f,L,N)$，其中 $\\sigma$ 的单位是西门子/米，$\\mu$ 的单位是亨利/米， $f$ 的单位是赫兹， $L$ 的单位是米， $N$ 是一个正整数。在指定情况下，使用真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}$ 亨利/米。对于所有情况，取 $E_0 = 1$。\n- 用例 A（理想情况，良好分辨率）：$(\\sigma,\\mu,f,L,N) = (5.8\\times 10^{7}, \\mu_0, 60, 0.05, 400)$。\n- 用例 B（较高频率，中等分辨率）：$(\\sigma,\\mu,f,L,N) = (5.8\\times 10^{7}, \\mu_0, 10^{6}, 0.005, 200)$。\n- 用例 C（高磁导率，尚可的分辨率）：$(\\sigma,\\mu,f,L,N) = (10^{6}, 100\\,\\mu_0, 10^{3}, 0.05, 400)$。\n- 用例 D（物理参数与用例 C 相同，采用粗糙网格以暴露离散化误差）：$(\\sigma,\\mu,f,L,N) = (10^{6}, 100\\,\\mu_0, 10^{3}, 0.05, 40)$。\n\n覆盖范围基本原理：\n- 用例 A 验证了计算域包含多个趋肤深度且空间分辨率精细的标称场景。\n- 用例 B 在较高频率下强调了更小的趋肤深度，并检查了中等空间分辨率的影响。\n- 用例 C 测试了在保持足够分辨率的情况下，磁导率增加对衰减的影响。\n- 用例 D 通过在保持用例 C 的物理参数不变的情况下粗化网格，来分离出离散化误差。\n\n最终输出规范：\n- 您的程序应生成一行输出，其中包含四个用例的相对误差结果，形式为一个用方括号括起来的逗号分隔列表，顺序为 $[\\varepsilon_A,\\varepsilon_B,\\varepsilon_C,\\varepsilon_D]$。每个 $\\varepsilon$ 必须是保留八位有效数字的浮点数，采用标准或科学记数法。例如，输出可能看起来像 $[1.2345679e-04,2.3456789e-03,1.1111111e-05,4.4444444e-02]$。",
            "solution": "该问题经评估为有效，因为它具有科学依据、提法明确且客观。它提出了一个计算电磁学中的标准问题，可以通过推导、离散化和数值计算的逻辑序列来解决。\n\n### 1. 控制偏微分方程(PDE)的推导\n我们从线性、各向同性、均匀的导电介质中麦克斯韦方程组的时谐形式开始，假设时间依赖关系为 $\\mathrm{e}^{j \\omega t}$，其中 $j = \\sqrt{-1}$ 是虚数单位，$\\omega$ 是角频率。相关方程为法拉第定律和安培定律：\n$$ \\nabla \\times \\mathbf{E} = -j \\omega \\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + j \\omega \\mathbf{D} $$\n这里，$\\mathbf{E}$ 是电场相量，$\\mathbf{B}$ 是磁通密度相量，$\\mathbf{H}$ 是磁场强度相量，$\\mathbf{D}$ 是电位移场相量，$\\mathbf{J}$ 是电流密度相量。\n\n介质的本构关系为 $\\mathbf{D} = \\epsilon \\mathbf{E}$，$\\mathbf{B} = \\mu \\mathbf{H}$ 和 $\\mathbf{J} = \\sigma \\mathbf{E}$，其中 $\\epsilon$ 是介电常数，$\\mu$ 是磁导率，$\\sigma$ 是材料的电导率。将这些关系代入安培定律得到：\n$$ \\nabla \\times \\mathbf{H} = \\nabla \\times (\\frac{1}{\\mu}\\mathbf{B}) = \\sigma \\mathbf{E} + j \\omega \\epsilon \\mathbf{E} = (\\sigma + j \\omega \\epsilon) \\mathbf{E} $$\n假设磁导率 $\\mu$ 均匀，上式简化为：\n$$ \\nabla \\times \\mathbf{B} = \\mu (\\sigma + j \\omega \\epsilon) \\mathbf{E} $$\n接下来，我们对法拉第定律取旋度：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -j \\omega (\\nabla \\times \\mathbf{B}) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$，我们可以重写左侧。在无源区（电荷密度 $\\rho=0$）中，高斯定律为 $\\nabla \\cdot \\mathbf{D} = 0$，这意味着 $\\nabla \\cdot (\\epsilon\\mathbf{E}) = \\epsilon(\\nabla \\cdot \\mathbf{E}) = 0$，所以 $\\nabla \\cdot \\mathbf{E} = 0$。因此，矢量恒等式简化为 $-\\nabla^2 \\mathbf{E}$。\n将此结果和 $\\nabla \\times \\mathbf{B}$ 的表达式代入取了旋度的法拉第方程，我们得到：\n$$ -\\nabla^2 \\mathbf{E} = -j \\omega [\\mu (\\sigma + j \\omega \\epsilon) \\mathbf{E}] $$\n$$ \\nabla^2 \\mathbf{E} = (j \\omega \\mu \\sigma - \\omega^2 \\mu \\epsilon) \\mathbf{E} $$\n这是矢量亥姆霍兹方程。我们定义复传播常数 $\\gamma$，使得 $\\gamma^2 = j \\omega \\mu \\sigma - \\omega^2 \\mu \\epsilon$。方程变为：\n$$ \\nabla^2 \\mathbf{E} - \\gamma^2 \\mathbf{E} = 0 $$\n问题指定了一个切向电场，例如 $\\mathbf{E} = E(z) \\hat{\\mathbf{x}}$，它只依赖于进入导体的深度 $z$。对于这种一维情况，拉普拉斯算子简化为 $\\nabla^2 \\mathbf{E} = \\frac{d^2 E(z)}{dz^2} \\hat{\\mathbf{x}}$。因此，矢量偏微分方程简化为标量常微分方程(ODE)：\n$$ \\frac{d^2 E(z)}{dz^2} - \\gamma^2 E(z) = 0 $$\n\n### 2. 解析趋肤深度的推导\n所推导的常微分方程的通解是 $E(z) = C_1 \\mathrm{e}^{\\gamma z} + C_2 \\mathrm{e}^{-\\gamma z}$。对于在半空间 $z \\ge 0$ 中传播的场，解必须在 $z \\to \\infty$ 时保持有界。这要求选择 $\\gamma^2$ 的实部为正的根，并将增长指数项的系数($C_1$)设为零。\n我们考虑良导体的情况，其中传导电流远大于位移电流，即 $\\sigma \\gg \\omega \\epsilon$。在此近似下，$\\gamma^2$ 中的 $\\omega^2 \\mu \\epsilon$ 项可以忽略不计：\n$$ \\gamma^2 \\approx j \\omega \\mu \\sigma $$\n为了求 $\\gamma$，我们取平方根。使用虚数单位的极坐标形式，$j = \\mathrm{e}^{j\\pi/2}$，其主平方根是 $\\sqrt{j} = \\mathrm{e}^{j\\pi/4} = \\cos(\\pi/4) + j\\sin(\\pi/4) = \\frac{1+j}{\\sqrt{2}}$。因此，\n$$ \\gamma = \\sqrt{\\omega \\mu \\sigma} \\left(\\frac{1+j}{\\sqrt{2}}\\right) = \\sqrt{\\frac{\\omega \\mu \\sigma}{2}} (1+j) $$\n$\\gamma$ 的实部，即衰减常数 $\\alpha$，是正数，符合要求：$\\alpha = \\sqrt{\\frac{\\omega \\mu \\sigma}{2}}$。衰减解为 $E(z) = C_2 \\mathrm{e}^{-\\gamma z}$。根据边界条件 $E(0) = E_0$，我们得到 $C_2 = E_0$，因此 $E(z) = E_0 \\mathrm{e}^{-\\gamma z}$。\n电场的幅值为 $|E(z)| = |E_0||\\mathrm{e}^{-(\\alpha+j\\beta)z}| = |E_0| \\mathrm{e}^{-\\alpha z}$。趋肤深度 $\\delta$ 定义为场振幅衰减到其表面值的 $1/\\mathrm{e}$ 时的深度。这发生在 $\\alpha \\delta = 1$ 时。\n$$ \\delta = \\frac{1}{\\alpha} = \\frac{1}{\\sqrt{\\frac{\\omega \\mu \\sigma}{2}}} = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}} $$\n代入 $\\omega = 2\\pi f$，趋肤深度的解析表达式为：\n$$ \\delta = \\sqrt{\\frac{1}{\\pi f \\mu \\sigma}} $$\n\n### 3. 数值离散化\n我们在有限域 $z \\in [0, L]$ 上求解常微分方程 $\\frac{d^2 E}{dz^2} - \\gamma^2 E = 0$，边界条件为 $E(0) = E_0$ 和 $E(L)=0$。该域被离散化为一个包含 $N+1$ 个点的均匀网格 $z_i = i \\Delta z$，$i=0, 1, ..., N$，步长为 $\\Delta z = L/N$。\n我们在每个内部网格点 $z_i$ ($i=1, ..., N-1$) 应用二阶中心差分近似来表示二阶导数：\n$$ \\frac{d^2 E}{dz^2}\\bigg|_{z_i} \\approx \\frac{E(z_{i+1}) - 2E(z_i) + E(z_{i-1})}{(\\Delta z)^2} = \\frac{E_{i+1} - 2E_i + E_{i-1}}{(\\Delta z)^2} $$\n将此式代入常微分方程，得到一个代数方程组：\n$$ \\frac{E_{i+1} - 2E_i + E_{i-1}}{(\\Delta z)^2} - \\gamma^2 E_i = 0 \\quad \\text{for } i=1, ..., N-1 $$\n重新整理各项，我们得到：\n$$ E_{i-1} - (2 + \\gamma^2 (\\Delta z)^2) E_i + E_{i+1} = 0 $$\n这是一个关于 $N-1$ 个未知场值 $E_1, E_2, ..., E_{N-1}$ 的 $N-1$ 个线性方程组成的方程组。边界值是已知的：$E_0=E_0=1$ 和 $E_N=0$。\n对于 $i=1$：$E_0 - (2 + \\gamma^2 (\\Delta z)^2) E_1 + E_2 = 0 \\implies -(2 + \\gamma^2 (\\Delta z)^2) E_1 + E_2 = -E_0$。\n对于 $i=N-1$：$E_{N-2} - (2 + \\gamma^2 (\\Delta z)^2) E_{N-1} + E_N = 0 \\implies E_{N-2} - (2 + \\gamma^2 (\\Delta z)^2) E_{N-1} = 0$。\n该系统可以写成矩阵形式 $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$，其中 $\\mathbf{x} = [E_1, E_2, ..., E_{N-1}]^T$ 是未知数向量，$\\mathbf{A}$ 是一个复值三对角矩阵，$\\mathbf{b}$ 是源向量。\n$\\mathbf{A}$ 的对角元素是 $a_{ii} = -(2 + \\gamma^2 (\\Delta z)^2)$，上对角和下对角元素是 $a_{i,i+1} = a_{i,i-1} = 1$，所有其他元素均为零。对于数值计算，我们使用良导体近似 $\\gamma^2 = j\\omega\\mu\\sigma$。\n源向量是 $\\mathbf{b} = [-E_0, 0, ..., 0]^T$。求解这个线性系统，可以得到内部网格点上电场的复相量值。\n\n### 4. 数值趋肤深度估计与误差计算\n求解线性系统得到 $\\{E_i\\}_{i=1}^{N-1}$ 后，我们构建完整的数值解向量，包括边界：$[E_0, E_1, ..., E_{N-1}, E_N]$。然后我们计算每个节点处的幅值 $|E_i|$。\n数值趋肤深度 $\\delta_{\\mathrm{num}}$ 是 $|E(z)|$ 等于 $E_0/\\mathrm{e}$ 的深度 $z$。我们找到第一个网格索引 $k$，使得 $|E_k| \\ge E_0/\\mathrm{e}$ 且 $|E_{k+1}|  E_0/\\mathrm{e}$。\n由于解析解的对数 $\\ln|E(z)|$ 是 $z$ 的线性函数，因此对数值数据的对数进行线性插值非常准确。我们使用提供的对数插值公式：\n$$ \\delta_{\\mathrm{num}} = z_k + \\frac{\\ln\\left(\\frac{E_0}{\\mathrm{e}}\\right) - \\ln|E(z_k)|}{\\ln|E(z_{k+1})| - \\ln|E(z_k)|} \\, \\Delta z $$\n当 $E_0=1$ 时，这变为 $\\delta_{\\mathrm{num}} = z_k + \\frac{-1 - \\ln|E(z_k)|}{\\ln|E(z_{k+1})| - \\ln|E(z_k)|} \\, \\Delta z$。\n最后，我们计算数值估计值 $\\delta_{\\mathrm{num}}$ 与解析值 $\\delta$ 之间的相对误差 $\\varepsilon$：\n$$ \\varepsilon = \\left|\\frac{\\delta_{\\mathrm{num}} - \\delta}{\\delta}\\right| $$\n对每个指定的测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Solves the 1D Helmholtz equation for the skin effect problem,\n    calculates numerical and analytical skin depths, and computes the\n    relative error for a series of test cases.\n    \"\"\"\n    \n    # Define physical constants and test cases\n    MU_0 = 4.0 * np.pi * 1e-7  # Vacuum permeability in H/m\n    E0 = 1.0                     # Surface electric field amplitude in V/m\n\n    test_cases = [\n        # Case A (happy path, good resolution)\n        {'label': 'A', 'sigma': 5.8e7, 'mu': MU_0, 'f': 60, 'L': 0.05, 'N': 400},\n        # Case B (higher frequency, moderate resolution)\n        {'label': 'B', 'sigma': 5.8e7, 'mu': MU_0, 'f': 1e6, 'L': 0.005, 'N': 200},\n        # Case C (high permeability, decent resolution)\n        {'label': 'C', 'sigma': 1.0e6, 'mu': 100 * MU_0, 'f': 1e3, 'L': 0.05, 'N': 400},\n        # Case D (same physics as Case C, coarse grid)\n        {'label': 'D', 'sigma': 1.0e6, 'mu': 100 * MU_0, 'f': 1e3, 'L': 0.05, 'N': 40},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters\n        sigma = case['sigma']\n        mu = case['mu']\n        f = case['f']\n        L = case['L']\n        N = case['N']\n\n        # 1. Calculate problem-specific parameters\n        omega = 2.0 * np.pi * f  # Angular frequency\n        dz = L / N               # Grid spacing\n        \n        # In a good conductor, gamma^2 = j*omega*mu*sigma\n        gamma_sq = 1j * omega * mu * sigma\n        \n        # 2. Set up the linear system Ax = b for the finite difference scheme\n        # for interior nodes 1, ..., N-1.\n        num_unknowns = N - 1\n        \n        # Main diagonal of the tridiagonal matrix A\n        diag_val = -(2.0 + gamma_sq * dz**2)\n        d = np.full(num_unknowns, diag_val, dtype=np.complex128)\n        \n        # Off-diagonals (value is 1)\n        ud = np.ones(num_unknowns - 1, dtype=np.complex128)\n        ld = np.ones(num_unknowns - 1, dtype=np.complex128)\n        \n        # Construct the matrix A using a banded format\n        # The matrix A has ld on the first lower diagonal, d on the main diagonal,\n        # and ud on the first upper diagonal.\n        A_banded = np.zeros((3, num_unknowns), dtype=np.complex128)\n        A_banded[0, 1:] = ud  # Superdiagonal\n        A_banded[1, :] = d    # Main diagonal\n        A_banded[2, :-1] = ld # Subdiagonal\n        \n        # Construct the right-hand side vector b\n        b = np.zeros(num_unknowns, dtype=np.complex128)\n        b[0] = -E0 # From boundary condition E(0) = E0\n        \n        # 3. Solve the linear system\n        E_internal = scipy.linalg.solve_banded((1, 1), A_banded, b)\n        \n        # 4. Construct the full solution vector including boundaries\n        E_full = np.concatenate(([E0], E_internal, [0]))\n        z_grid = np.linspace(0, L, N + 1)\n        \n        # 5. Compute the numerical skin depth\n        E_mag = np.abs(E_full)\n        target_mag = E0 / np.e\n        \n        # Find the first index k where the magnitude drops below the target\n        # np.where returns a tuple of arrays; we need the first element of the first array.\n        try:\n            k_plus_1 = np.where(E_mag  target_mag)[0][0]\n            k = k_plus_1 - 1\n        except IndexError:\n            # This would happen if the field does not decay enough within the domain L.\n            # The problem setup ensures this should not occur.\n            # Set error to a sentinel value if it happens.\n            results.append(np.nan)\n            continue\n\n        z_k = z_grid[k]\n        z_k_plus_1 = z_grid[k_plus_1]\n        \n        log_mag_k = np.log(E_mag[k])\n        log_mag_k_plus_1 = np.log(E_mag[k_plus_1])\n        \n        # Use provided logarithmic interpolation formula. log(E0/e) = log(1/e) = -1.\n        delta_num = z_k + ((-1.0 - log_mag_k) / (log_mag_k_plus_1 - log_mag_k)) * dz\n        \n        # 6. Compute analytical skin depth\n        delta_analytical = np.sqrt(2.0 / (omega * mu * sigma))\n        \n        # 7. Compute relative error\n        relative_error = np.abs((delta_num - delta_analytical) / delta_analytical)\n        results.append(relative_error)\n\n    # Format output to 8 significant digits\n    formatted_results = [f\"{r:.8g}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}