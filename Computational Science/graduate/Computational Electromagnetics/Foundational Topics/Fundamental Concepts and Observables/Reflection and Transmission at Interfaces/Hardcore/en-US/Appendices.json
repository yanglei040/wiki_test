{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex computational models, it is essential to master the analytical foundations of wave reflection and transmission. This first practice focuses on the classic problem of impedance matching using a quarter-wave transformer. By deriving the reflection coefficient from first principles and analyzing its frequency dependence , you will build a solid understanding of how constructive and destructive interference can be engineered to control wave propagation. This exercise serves not only to reinforce core wave mechanics but also provides an invaluable analytical benchmark for validating more sophisticated numerical simulations.",
            "id": "3345586",
            "problem": "A time-harmonic plane wave of angular frequency $\\omega$ is normally incident from a semi-infinite, lossless, nondispersive medium $\\mathsf{1}$ of intrinsic impedance $\\eta_{1}$ onto a semi-infinite, lossless, nondispersive medium $\\mathsf{2}$ of intrinsic impedance $\\eta_{2}$. To reduce reflection, a single homogeneous, lossless, nondispersive matching layer is placed between the two media. The matching layer has intrinsic impedance $\\eta_{m}$ and thickness $d$, and it is designed such that at a design angular frequency $\\omega_{0}$ the electrical thickness satisfies $\\beta_{m}(\\omega_{0})\\,d = \\pi/2$, where $\\beta_{m}(\\omega)$ is the phase constant in the matching layer, and the impedance is chosen as $\\eta_{m} = \\sqrt{\\eta_{1}\\eta_{2}}$. Assume all materials are nondispersive so that the phase velocity in the matching layer is independent of frequency, implying $\\beta_{m}(\\omega) = (\\omega/\\omega_{0})\\,\\beta_{m}(\\omega_{0})$.\n\nStarting from Maxwell’s equations and the continuity of tangential electric and magnetic fields at planar interfaces, model the three-region stack using the plane-wave transmission-line analogy at normal incidence and derive the exact reflection coefficient $\\Gamma(\\omega)$ seen by medium $\\mathsf{1}$. Then, for small fractional detuning $\\varepsilon = (\\omega - \\omega_{0})/\\omega_{0}$, derive the leading-order asymptotic expression of the power reflection coefficient $|\\Gamma(\\omega)|^{2}$ as $\\varepsilon \\to 0$ in terms of $\\eta_{1}$ and $\\eta_{2}$.\n\nExpress the final answer for the leading-order $|\\Gamma(\\omega)|^{2}$ as a single closed-form analytic expression. No numerical evaluation is required, and no units should be included.",
            "solution": "The problem is subjected to validation and is deemed valid. It is a well-posed, scientifically grounded problem in computational electromagnetics concerning the analysis of a quarter-wave impedance matching transformer. All provided information is consistent, complete, and physically meaningful.\n\nWe begin by establishing the transmission-line analogy for a time-harmonic plane wave at normal incidence, as requested. For a plane wave propagating along the $z$-axis with electric field $\\vec{E} = E_x(z)\\hat{x}$ and magnetic field $\\vec{H} = H_y(z)\\hat{y}$, Maxwell's curl equations in a source-free, linear, isotropic, and homogeneous medium reduce to a pair of coupled ordinary differential equations:\n$$ \\frac{dE_x(z)}{dz} = -j\\omega\\mu H_y(z) $$\n$$ \\frac{dH_y(z)}{dz} = -j\\omega\\epsilon E_x(z) $$\nThese are mathematically identical to the Telegrapher's equations for a lossless transmission line:\n$$ \\frac{dV(z)}{dz} = -j\\omega L' I(z) $$\n$$ \\frac{dI(z)}{dz} = -j\\omega C' V(z) $$\nBy making the associations $V(z) \\leftrightarrow E_x(z)$, $I(z) \\leftrightarrow H_y(z)$, $L' \\leftrightarrow \\mu$, and $C' \\leftrightarrow \\epsilon$, we can model the electromagnetic problem as a transmission-line problem. The intrinsic impedance of the medium, $\\eta = \\sqrt{\\mu/\\epsilon}$, corresponds to the characteristic impedance of the transmission line, $Z_0 = \\sqrt{L'/C'}$. The continuity of tangential components of $\\vec{E}$ and $\\vec{H}$ at an interface corresponds to the continuity of voltage and current at a junction. This analogy allows us to model the three-region stack as a transmission line (medium $\\mathsf{1}$) connected to a second transmission line section (the matching layer) of length $d$, which is in turn terminated by a semi-infinite transmission line (the load, medium $\\mathsf{2}$).\n\nThe load impedance presented by the semi-infinite medium $\\mathsf{2}$ is its intrinsic impedance, $Z_L = \\eta_2$. The matching layer is a transmission line of length $d$ and characteristic impedance $\\eta_m$. The input impedance $\\eta_{in}$ looking into the matching layer from medium $\\mathsf{1}$ is given by the standard transmission line impedance transformation formula:\n$$ \\eta_{in}(\\omega) = \\eta_m \\frac{\\eta_2 + j\\eta_m \\tan(\\beta_m(\\omega) d)}{\\eta_m + j\\eta_2 \\tan(\\beta_m(\\omega) d)} $$\nwhere $\\beta_m(\\omega)$ is the phase constant in the matching layer. The reflection coefficient $\\Gamma(\\omega)$ at the interface between medium $\\mathsf{1}$ and the matching layer is:\n$$ \\Gamma(\\omega) = \\frac{\\eta_{in}(\\omega) - \\eta_1}{\\eta_{in}(\\omega) + \\eta_1} $$\nSubstituting the expression for $\\eta_{in}(\\omega)$ and simplifying yields:\n$$ \\Gamma(\\omega) = \\frac{\\eta_m(\\eta_2 + j\\eta_m \\tan(\\beta_m d)) - \\eta_1(\\eta_m + j\\eta_2 \\tan(\\beta_m d))}{\\eta_m(\\eta_2 + j\\eta_m \\tan(\\beta_m d)) + \\eta_1(\\eta_m + j\\eta_2 \\tan(\\beta_m d))} = \\frac{\\eta_m(\\eta_2 - \\eta_1) + j(\\eta_m^2 - \\eta_1\\eta_2)\\tan(\\beta_m d)}{\\eta_m(\\eta_2 + \\eta_1) + j(\\eta_m^2 + \\eta_1\\eta_2)\\tan(\\beta_m d)} $$\nThe problem specifies the quarter-wave matching condition at the design frequency $\\omega_0$, where $\\eta_m = \\sqrt{\\eta_1\\eta_2}$. Substituting $\\eta_m^2 = \\eta_1\\eta_2$ into the expression for $\\Gamma(\\omega)$ simplifies the numerator's imaginary part to zero. This yields the exact reflection coefficient for the matched structure:\n$$ \\Gamma(\\omega) = \\frac{\\eta_m(\\eta_2 - \\eta_1)}{\\eta_m(\\eta_2 + \\eta_1) + j2\\eta_1\\eta_2 \\tan(\\beta_m(\\omega) d)} $$\nThis completes the first part of the task.\n\nFor the second part, we derive the leading-order asymptotic expression for the power reflection coefficient $|\\Gamma(\\omega)|^2$ for small fractional detuning, $\\varepsilon = (\\omega - \\omega_0)/\\omega_0 \\ll 1$. The phase constant in the nondispersive matching layer is given as $\\beta_m(\\omega) = (\\omega/\\omega_0)\\beta_m(\\omega_0)$. The electrical thickness at frequency $\\omega$ is therefore:\n$$ \\beta_m(\\omega) d = \\frac{\\omega}{\\omega_0} \\beta_m(\\omega_0) d $$\nUsing the design condition $\\beta_m(\\omega_0) d = \\pi/2$ and the definition of $\\varepsilon$ (which implies $\\omega/\\omega_0 = 1+\\varepsilon$):\n$$ \\beta_m(\\omega) d = (1+\\varepsilon)\\frac{\\pi}{2} = \\frac{\\pi}{2} + \\frac{\\varepsilon\\pi}{2} $$\nWe now analyze the tangent term for small $\\varepsilon$:\n$$ \\tan(\\beta_m(\\omega) d) = \\tan\\left(\\frac{\\pi}{2} + \\frac{\\varepsilon\\pi}{2}\\right) = -\\cot\\left(\\frac{\\varepsilon\\pi}{2}\\right) $$\nFor a small argument $x$, the cotangent function has the leading-order Taylor expansion $\\cot(x) \\approx 1/x$. Thus, for $\\varepsilon \\to 0$:\n$$ \\tan(\\beta_m(\\omega) d) \\approx -\\frac{1}{\\frac{\\varepsilon\\pi}{2}} = -\\frac{2}{\\varepsilon\\pi} $$\nSubstituting this approximation into the expression for $\\Gamma(\\omega)$:\n$$ \\Gamma(\\omega) \\approx \\frac{\\eta_m(\\eta_2 - \\eta_1)}{\\eta_m(\\eta_2 + \\eta_1) + j2\\eta_1\\eta_2 \\left(-\\frac{2}{\\varepsilon\\pi}\\right)} = \\frac{\\eta_m(\\eta_2 - \\eta_1)}{\\eta_m(\\eta_2 + \\eta_1) - j\\frac{4\\eta_1\\eta_2}{\\varepsilon\\pi}} $$\nAs $\\varepsilon \\to 0$, the imaginary term in the denominator becomes dominant. Therefore, we can neglect the real term $\\eta_m(\\eta_2 + \\eta_1)$ to find the leading-order behavior:\n$$ \\Gamma(\\omega) \\approx \\frac{\\eta_m(\\eta_2 - \\eta_1)}{-j\\frac{4\\eta_1\\eta_2}{\\varepsilon\\pi}} = j\\frac{\\varepsilon\\pi\\eta_m(\\eta_2 - \\eta_1)}{4\\eta_1\\eta_2} $$\nSubstituting $\\eta_m = \\sqrt{\\eta_1\\eta_2}$:\n$$ \\Gamma(\\omega) \\approx j\\frac{\\varepsilon\\pi\\sqrt{\\eta_1\\eta_2}(\\eta_2 - \\eta_1)}{4\\eta_1\\eta_2} = j\\frac{\\varepsilon\\pi(\\eta_2 - \\eta_1)}{4\\sqrt{\\eta_1\\eta_2}} $$\nThe power reflection coefficient is $|\\Gamma(\\omega)|^2 = \\Gamma(\\omega)\\Gamma^*(\\omega)$. Since $\\eta_1$ and $\\eta_2$ are real for lossless media:\n$$ |\\Gamma(\\omega)|^2 \\approx \\left| j\\frac{\\varepsilon\\pi(\\eta_2 - \\eta_1)}{4\\sqrt{\\eta_1\\eta_2}} \\right|^2 = |j|^2 \\left(\\frac{\\varepsilon\\pi(\\eta_2 - \\eta_1)}{4\\sqrt{\\eta_1\\eta_2}}\\right)^2 $$\n$$ |\\Gamma(\\omega)|^2 \\approx \\frac{\\pi^2 (\\eta_2 - \\eta_1)^2}{16\\eta_1\\eta_2} \\varepsilon^2 $$\nThis is the leading-order asymptotic expression for the power reflection coefficient as $\\varepsilon \\to 0$.",
            "answer": "$$ \\boxed{\\frac{\\pi^2 (\\eta_2 - \\eta_1)^2}{16 \\eta_1 \\eta_2} \\varepsilon^2} $$"
        },
        {
            "introduction": "Building upon the single-layer case, we now turn our attention to multilayer structures, which form the basis of advanced optical components like dielectric mirrors and filters. This practice introduces two powerful approaches: the exact Transfer-Matrix Method (TMM) and the approximate Effective Medium Theory (EMT). While TMM provides a rigorous solution for any 1D stack, EMT offers a simplified, homogenized model that is valid when the wavelength is much larger than the individual layer thicknesses . Implementing both and comparing their predictions will provide critical insight into the power and limitations of homogenization, a cornerstone concept in the physics of metamaterials.",
            "id": "3345660",
            "problem": "A time-harmonic plane wave with angular frequency $\\omega$ and vacuum wavelength $\\lambda_0$ is normally incident from a lossless ambient medium into a one-dimensional periodic multilayer stack composed of two isotropic, non-magnetic dielectrics with scalar relative permittivities $\\epsilon_1$ and $\\epsilon_2$. Each period of the stack consists of two layers of thicknesses $d_1$ and $d_2$, repeated $N$ times, and the stack is terminated by a lossless substrate medium. Assume permeability $\\mu=\\mu_0$ in all media, so that the refractive index is $n=\\sqrt{\\epsilon_r}$, and the wave admittance for normal incidence is proportional to $n$. Your task is to derive, implement, and compare two models for reflection and transmission at the stack: (i) an exact transfer-matrix model for the discrete multilayer, and (ii) a homogenized effective medium model that replaces the periodic stack by a single uniform slab of thickness $L=N(d_1+d_2)$ and an effective permittivity $\\epsilon_{\\mathrm{eff}}$. You must start your derivation from Maxwell’s equations in the frequency domain and the continuity of tangential fields at planar interfaces (no shortcuts or pre-quoted multilayer formulas are allowed in the derivation).\n\nUsing the fundamental laws and core definitions only, do the following:\n- From the boundary conditions implied by Maxwell’s equations, derive a $2\\times 2$ linear relation between forward and backward traveling wave amplitudes across a single homogeneous layer at normal incidence, expressed in terms of its refractive index $n_\\ell$ and thickness $d_\\ell$. Then derive how such relations compose for a sequence of layers to produce a total transfer relation for the stack. From this, obtain expressions for the complex reflection coefficient $r$ and transmission coefficient $t$ of the entire stack, in terms of the ambient and substrate wave admittances and the elements of the total transfer matrix.\n- For the homogenized effective medium model, justify the choice of $\\epsilon_{\\mathrm{eff}}$ for normal incidence when the electric field is tangential to the layers. Use the appropriate volume-average for $\\epsilon_{\\mathrm{eff}}$ in this case, and model the stack as a single uniform slab of thickness $L=N(d_1+d_2)$.\n- Define the power reflectance $R$ and transmittance $T$ in terms of the complex amplitudes $r$ and $t$ and the ambient/substrate admittances, and define the transmission phase $\\phi_t=\\arg(t)$. Explain how to compute the smallest absolute phase difference between two phases modulo $2\\pi$.\n\nThen, implement a program that:\n- Computes the exact complex reflection $r_{\\mathrm{exact}}$ and transmission $t_{\\mathrm{exact}}$ using the transfer-matrix model for the discrete stack.\n- Computes the homogenized complex reflection $r_{\\mathrm{eff}}$ and transmission $t_{\\mathrm{eff}}$ using a single effective slab with $\\epsilon_{\\mathrm{eff}}$ and thickness $L$.\n- Reports three quantitative comparison metrics:\n  1. The absolute error in power reflectance $|R_{\\mathrm{exact}}-R_{\\mathrm{eff}}|$.\n  2. The absolute error in power transmittance $|T_{\\mathrm{exact}}-T_{\\mathrm{eff}}|$.\n  3. The absolute smallest difference in transmission phase $|\\Delta \\phi_t|$ in radians.\n- Declares a homogenization-validity boolean for each case that is true if and only if all three conditions hold: $|R_{\\mathrm{exact}}-R_{\\mathrm{eff}}|0.02$, $|T_{\\mathrm{exact}}-T_{\\mathrm{eff}}|0.02$, and $|\\Delta \\phi_t|0.1$.\n\nAll answers that involve physical units must be in the International System of Units (SI). Angles must be in radians. The outputs $R$, $T$, and the errors are dimensionless. The transmission phase is in radians.\n\nTest suite. Your program must evaluate exactly the following four test cases, representing a typical, a marginal, a breakdown, and a low-contrast case:\n- Case $1$: $\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$, ambient index $n_0=1.0$, substrate index $n_s=1.0$, $\\epsilon_1=2.25$, $\\epsilon_2=12.25$, volume fraction of layer $1$ in one period $f=0.4$, normalized period $p=(d_1+d_2)/\\lambda_0=0.05$, number of periods $N=20$. Set $d_1=f\\,p\\,\\lambda_0$ and $d_2=(1-f)\\,p\\,\\lambda_0$.\n- Case $2$: $\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$, $n_0=1.0$, $n_s=1.0$, $\\epsilon_1=2.25$, $\\epsilon_2=12.25$, $f=0.4$, $p=0.2$, $N=5$.\n- Case $3$: $\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$, $n_0=1.0$, $n_s=1.0$, $\\epsilon_1=2.25$, $\\epsilon_2=12.25$, $f=0.4$, $p=0.5$, $N=2$.\n- Case $4$: $\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$, $n_0=1.0$, $n_s=1.0$, $\\epsilon_1=2.25$, $\\epsilon_2=2.89$, $f=0.5$, $p=0.2$, $N=5$.\n\nNumerical implementation notes:\n- Use $k_0=2\\pi/\\lambda_0$.\n- For the exact stack, build the discrete two-layer period with $d_1$ and $d_2$ and repeat it $N$ times. The total thickness is $L=N(d_1+d_2)$.\n- For the effective medium, use $\\epsilon_{\\parallel}=f\\,\\epsilon_1+(1-f)\\,\\epsilon_2$ for normal incidence (electric field tangential to interfaces), and $n_{\\mathrm{eff}}=\\sqrt{\\epsilon_{\\parallel}}$. Model a single layer of thickness $L$ and index $n_{\\mathrm{eff}}$ between ambient and substrate.\n- Compute power transmittance as $T=(\\Re\\{Y_s\\}/\\Re\\{Y_0\\})\\,|t|^2$, where $Y_0$ and $Y_s$ are the ambient and substrate wave admittances at normal incidence. For non-magnetic, lossless media at normal incidence, $Y\\propto n$, so you may take $Y=n$ up to a common factor that cancels out in $T$.\n\nFinal output format. Your program should produce a single line of output containing a list of results, one sublist per test case, in the following order and format for each sublist:\n- $[\\text{case\\_index}, p, |R_{\\mathrm{exact}}-R_{\\mathrm{eff}}|, |T_{\\mathrm{exact}}-T_{\\mathrm{eff}}|, |\\Delta \\phi_t|, \\text{homogenization\\_valid}]$,\nwhere $\\text{case\\_index}$ is an integer in $\\{1,2,3,4\\}$, $p$ is the normalized period $(d_1+d_2)/\\lambda_0$, the next three fields are floats, and the last field is a boolean. For example, the entire output should look like a Python-style list of lists on a single line, such as $[[\\dots],[\\dots],[\\dots],[\\dots]]$ with comma-separated entries.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in classical electromagnetism, well-posed, and provides a complete and consistent set of parameters for a verifiable computational task.\n\nThe analysis proceeds by deriving the transfer-matrix model for a multilayer stack from first principles, justifying the effective medium approximation, and defining the required performance metrics.\n\n**1. Derivation from Maxwell's Equations**\n\nWe begin with the time-harmonic Maxwell's equations in a source-free, linear, isotropic medium, assuming a time-dependence of $e^{j\\omega t}$:\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon \\mathbf{E} $$\nFor a plane wave propagating normally along the $z$-axis in a non-magnetic medium ($\\mu = \\mu_0$), with electric field polarized along the $x$-axis, the fields are $\\mathbf{E} = E_x(z) \\hat{\\mathbf{x}}$ and $\\mathbf{H} = H_y(z) \\hat{\\mathbf{y}}$. The curl equations reduce to a system of ordinary differential equations:\n$$ \\frac{dE_x}{dz} = -j\\omega\\mu_0 H_y $$\n$$ \\frac{dH_y}{dz} = -j\\omega\\epsilon_0\\epsilon_r E_x $$\nCombining these yields the one-dimensional Helmholtz equation for $E_x(z)$:\n$$ \\frac{d^2 E_x}{dz^2} + k^2 E_x = 0 $$\nwhere $k = \\omega\\sqrt{\\mu_0\\epsilon} = \\omega\\sqrt{\\mu_0\\epsilon_0\\epsilon_r} = k_0 \\sqrt{\\epsilon_r} = k_0 n$ is the wavenumber in the medium. Here, $k_0 = 2\\pi/\\lambda_0$ is the vacuum wavenumber and $n=\\sqrt{\\epsilon_r}$ is the refractive index.\n\nThe general solution for $E_x(z)$ in a homogeneous layer is a superposition of forward and backward propagating waves:\n$$ E_x(z) = E^+ e^{-jkz} + E^- e^{+jkz} $$\nFrom the first Maxwell ODE, we find the corresponding magnetic field:\n$$ H_y(z) = \\frac{1}{-j\\omega\\mu_0} \\frac{dE_x}{dz} = \\frac{k}{\\omega\\mu_0} (E^+ e^{-jkz} - E^- e^{+jkz}) = Y (E^+ e^{-jkz} - E^- e^{+jkz}) $$\nwhere $Y = k/(\\omega\\mu_0) = n k_0 / (\\omega\\mu_0) = n \\sqrt{\\epsilon_0/\\mu_0}$. The quantity $Y$ is the wave admittance of the medium. For the lossless, non-magnetic media considered, $Y$ is proportional to the refractive index $n$. We can define a normalized admittance $Y_i = n_i$.\n\n**2. Transfer-Matrix Model for a Multilayer Stack**\n\nAt any interface between two media, the tangential components of the electric and magnetic fields ($E_x$ and $H_y$) must be continuous. The transfer-matrix method formalizes this by relating the total fields at one plane to another.\n\nConsider a single homogeneous layer of thickness $d_\\ell$ and refractive index $n_\\ell$ (hence wavenumber $k_\\ell$ and admittance $Y_\\ell$), located between planes $z=z_1$ and $z=z_2=z_1+d_\\ell$. The total fields $(E(z), H(z))$ at any point $z$ within the layer can be expressed in terms of the fields at the layer's exit plane, $z_2$.\n$$ E(z) = E(z_2) \\cos[k_\\ell(z_2-z)] + H(z_2) \\frac{j}{Y_\\ell} \\sin[k_\\ell(z_2-z)] $$\n$$ H(z) = E(z_2) (j Y_\\ell) \\sin[k_\\ell(z_2-z)] + H(z_2) \\cos[k_\\ell(z_2-z)] $$\nBy setting $z=z_1$, we obtain a matrix relation for the layer:\n$$ \\begin{pmatrix} E(z_1) \\\\ H(z_1) \\end{pmatrix} = \\begin{pmatrix} \\cos(k_\\ell d_\\ell)  \\frac{j}{Y_\\ell}\\sin(k_\\ell d_\\ell) \\\\ j Y_\\ell \\sin(k_\\ell d_\\ell)  \\cos(k_\\ell d_\\ell) \\end{pmatrix} \\begin{pmatrix} E(z_2) \\\\ H(z_2) \\end{pmatrix} $$\nThis matrix, which we denote $M_\\ell$, is the characteristic matrix of the layer. Its determinant is $\\det(M_\\ell)=1$.\n\nFor a cascade of layers, the total characteristic matrix is the product of the individual matrices. For the specified stack of $N$ periods, where each period consists of a layer of thickness $d_1$ and index $n_1$, followed by a layer of thickness $d_2$ and index $n_2$, the total matrix $M_{stack}$ is:\n$$ M_{stack} = (M_1 M_2)^N = \\begin{pmatrix} A  B \\\\ C  D \\end{pmatrix} $$\nwhere $M_1$ and $M_2$ are the characteristic matrices for layer $1$ and layer $2$, respectively.\n\n**3. Reflection and Transmission Coefficients**\n\nThe multilayer stack is situated between an ambient medium (for $z0$) with admittance $Y_0=n_0$ and a substrate medium (for $zL$) with admittance $Y_s=n_s$. The stack occupies the region $0 \\le z \\le L$.\nAt the input ($z=0$), the fields are a superposition of an incident wave (amplitude $1$) and a reflected wave (amplitude $r$):\n$$ E(0) = 1 + r $$\n$$ H(0) = Y_0(1-r) $$\nAt the output ($z=L$), there is only a transmitted wave (amplitude $t$):\n$$ E(L) = t $$\n$$ H(L) = Y_s t $$\nSubstituting these boundary conditions into the total matrix relation $\\begin{pmatrix}E(0) \\\\ H(0)\\end{pmatrix} = M_{stack} \\begin{pmatrix}E(L) \\\\ H(L)\\end{pmatrix}$ gives:\n$$ 1+r = A t + B (Y_s t) = (A + B Y_s)t $$\n$$ Y_0(1-r) = C t + D (Y_s t) = (C + D Y_s)t $$\nThis is a linear system for the complex reflection coefficient $r$ and transmission coefficient $t$. Solving for $r$ and $t$ yields:\n$$ r = \\frac{(A Y_0 - D Y_s) + B Y_0 Y_s - C}{(A Y_0 + D Y_s) + B Y_0 Y_s + C} $$\n$$ t = \\frac{2 Y_0}{(A Y_0 + D Y_s) + B Y_0 Y_s + C} $$\nIn the implementation, we use the normalized admittances $Y_i=n_i$.\n\n**4. Homogenized Effective Medium Model**\n\nIn the long-wavelength limit, where the layer thicknesses are much smaller than the wavelength ($d_1, d_2 \\ll \\lambda$), the periodic stack can be approximated by a single homogeneous slab. For normal incidence, the electric field $\\mathbf{E} = E_x \\hat{\\mathbf{x}}$ is tangential to the layer interfaces. Due to the boundary conditions, $E_x$ is continuous across the interfaces. The average electric displacement field $\\langle D_x \\rangle = \\epsilon_{\\mathrm{eff}} \\langle E_x \\rangle$. Approximating the field as constant within a period, $\\langle E_x \\rangle \\approx E_x$, the average displacement is the volume-weighted average of the local displacements:\n$$ \\langle D_x \\rangle = \\frac{d_1 D_1 + d_2 D_2}{d_1+d_2} = \\frac{d_1 \\epsilon_1 E_x + d_2 \\epsilon_2 E_x}{d_1+d_2} = \\left(\\frac{d_1}{d_1+d_2}\\epsilon_1 + \\frac{d_2}{d_1+d_2}\\epsilon_2\\right) E_x $$\nThis defines the effective relative permittivity for the electric field parallel to the layers:\n$$ \\epsilon_{\\mathrm{eff}} = f\\epsilon_1 + (1-f)\\epsilon_2 $$\nwhere $f = d_1/(d_1+d_2)$ is the volume fraction of layer $1$.\nThe homogenized model thus consists of a single layer with thickness $L=N(d_1+d_2)$ and effective refractive index $n_{\\mathrm{eff}}=\\sqrt{\\epsilon_{\\mathrm{eff}}}$. The reflection and transmission coefficients ($r_{\\mathrm{eff}}, t_{\\mathrm{eff}}$) are calculated using the single-layer transfer matrix $M_{\\mathrm{eff}}$ with these parameters.\n\n**5. Power, Transmittance, and Phase**\nThe power reflectance $R$ is the ratio of reflected to incident power flux. Since the incident and reflected waves are in the same medium, this is simply $R=|r|^2$.\nThe power transmittance $T$ is the ratio of transmitted to incident power flux. These fluxes are in different media ($n_s$ and $n_0$), so the admittances must be considered:\n$$ T = \\frac{\\text{Power transmitted}}{\\text{Power incident}} = \\frac{\\frac{1}{2}\\Re\\{Y_s\\}|t E_i|^2}{\\frac{1}{2}\\Re\\{Y_0\\}|E_i|^2} = \\frac{\\Re\\{Y_s\\}}{\\Re\\{Y_0\\}} |t|^2 $$\nFor the given lossless media, $Y_i=n_i$ are real, so $T = (n_s/n_0)|t|^2$.\n\nThe transmission phase is the argument of the complex transmission coefficient, $\\phi_t = \\arg(t)$.\nThe smallest absolute phase difference $|\\Delta\\phi_t|$ between two phases $\\phi_a$ and $\\phi_b$ is found by first calculating the difference $\\Delta\\phi = \\phi_a - \\phi_b$, and then wrapping this difference to the interval $(-\\pi, \\pi]$ before taking the absolute value. This can be computed as $|\\text{mod}(\\Delta\\phi+\\pi, 2\\pi) - \\pi|$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational electromagnetics problem for four test cases.\n    It computes reflection and transmission for a multilayer stack using both an\n    exact transfer-matrix model and a homogenized effective medium model, and\n    then compares the results.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Typical case, small period (p=0.05)\n        {\n            \"case_index\": 1, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 12.25, \"f\": 0.4, \"p\": 0.05, \"N\": 20\n        },\n        # Case 2: Marginal case, larger period (p=0.2)\n        {\n            \"case_index\": 2, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 12.25, \"f\": 0.4, \"p\": 0.2, \"N\": 5\n        },\n        # Case 3: Breakdown case, Bragg-like period (p=0.5)\n        {\n            \"case_index\": 3, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 12.25, \"f\": 0.4, \"p\": 0.5, \"N\": 2\n        },\n        # Case 4: Low-contrast case (p=0.2)\n        {\n            \"case_index\": 4, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 2.89, \"f\": 0.5, \"p\": 0.2, \"N\": 5\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lambda0 = case[\"lambda0\"]\n        n0 = case[\"n0\"]\n        ns = case[\"ns\"]\n        eps1 = case[\"eps1\"]\n        eps2 = case[\"eps2\"]\n        f = case[\"f\"]\n        p = case[\"p\"]\n        N = case[\"N\"]\n\n        # Derived parameters\n        k0 = 2.0 * np.pi / lambda0\n        n1 = np.sqrt(eps1)\n        n2 = np.sqrt(eps2)\n        d_period = p * lambda0\n        d1 = f * d_period\n        d2 = (1.0 - f) * d_period\n\n        # (i) Exact Transfer-Matrix Model\n        layer_stack_exact = [(n1, d1), (n2, d2)] * N\n        r_exact, t_exact = calculate_rt(layer_stack_exact, n0, ns, k0)\n\n        # (ii) Homogenized Effective Medium Model\n        eps_eff = f * eps1 + (1.0 - f) * eps2\n        n_eff = np.sqrt(eps_eff)\n        L = N * d_period\n        layer_stack_eff = [(n_eff, L)]\n        r_eff, t_eff = calculate_rt(layer_stack_eff, n0, ns, k0)\n\n        # (iii) Quantitative Comparison Metrics\n        # Power reflectance and transmittance\n        R_exact = np.abs(r_exact)**2\n        T_exact = (ns / n0) * np.abs(t_exact)**2\n        R_eff = np.abs(r_eff)**2\n        T_eff = (ns / n0) * np.abs(t_eff)**2\n\n        # Absolute errors\n        abs_R_err = np.abs(R_exact - R_eff)\n        abs_T_err = np.abs(T_exact - T_eff)\n\n        # Transmission phase difference\n        phi_t_exact = np.angle(t_exact)\n        phi_t_eff = np.angle(t_eff)\n        delta_phi_t = phi_t_exact - phi_t_eff\n        # Wrap phase difference to (-pi, pi]\n        abs_delta_phi_t = np.abs(np.mod(delta_phi_t + np.pi, 2 * np.pi) - np.pi)\n\n        # Homogenization validity check\n        is_homogenization_valid = (abs_R_err  0.02) and \\\n                                  (abs_T_err  0.02) and \\\n                                  (abs_delta_phi_t  0.1)\n\n        results.append(\n            f\"[{case['case_index']},{p},{abs_R_err:.6f},\"\n            f\"{abs_T_err:.6f},{abs_delta_phi_t:.6f},{str(is_homogenization_valid).lower()}]\"\n        )\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rt(layer_stack, n0, ns, k0):\n    \"\"\"\n    Calculates complex reflection (r) and transmission (t) coefficients\n    for a given stack of layers using the transfer-matrix method.\n\n    Args:\n        layer_stack (list of tuples): Each tuple is (refractive_index, thickness).\n        n0 (float): Refractive index of the ambient medium.\n        ns (float): Refractive index of the substrate medium.\n        k0 (float): Vacuum wavenumber (2*pi/lambda0).\n\n    Returns:\n        tuple: (r, t) complex coefficients.\n    \"\"\"\n    # Admittances are normalized to the vacuum admittance\n    Y0 = n0\n    Ys = ns\n\n    # Initialize total matrix as identity\n    M_total = np.identity(2, dtype=np.cdouble)\n\n    for n_layer, d_layer in layer_stack:\n        Y_layer = n_layer\n        k_layer = n_layer * k0\n        phi = k_layer * d_layer\n        \n        cos_phi = np.cos(phi)\n        sin_phi = np.sin(phi)\n\n        # Characteristic matrix for a single layer\n        M_layer = np.array([\n            [cos_phi, (1j / Y_layer) * sin_phi],\n            [1j * Y_layer * sin_phi, cos_phi]\n        ], dtype=np.cdouble)\n\n        # Chain matrix multiplication\n        M_total = M_total @ M_layer\n\n    A, B = M_total[0, :]\n    C, D = M_total[1, :]\n\n    # Calculate r and t from total matrix elements and surrounding admittances\n    denominator = (A * Y0 + D * Ys) + B * Y0 * Ys + C\n    \n    r = ((A * Y0 - D * Ys) + B * Y0 * Ys - C) / denominator\n    t = (2 * Y0) / denominator\n    \n    return r, t\n\nsolve()\n```"
        },
        {
            "introduction": "Having explored analytical and semi-analytical methods, we now confront a fundamental challenge in direct numerical simulation: the discrepancy between continuous physics and its discrete representation. This practice explores numerical dispersion in the widely used Finite-Difference Time-Domain (FDTD) method. Because space and time are discretized on a grid, the simulated speed of light becomes dependent on the wave's frequency and direction relative to the grid axes, an artifact absent in reality . By deriving the dispersion-modified reflection coefficient and quantifying its phase error, you will gain a crucial, practical understanding of how computational parameters impact the accuracy and fidelity of your simulations.",
            "id": "3345589",
            "problem": "Consider a two-dimensional, lossless, source-free electromagnetic problem with a planar interface at $z=0$ separating two nonmagnetic dielectrics, medium $1$ for $z0$ with relative permittivity $\\varepsilon_{r1}$ and medium $2$ for $z0$ with relative permittivity $\\varepsilon_{r2}$. A time-harmonic, transversely electric (TE, also called s-polarized) plane wave of angular frequency $\\omega$ is incident from medium $1$ onto the interface with incidence angle $\\theta$ measured from the interface normal (the $+z$ axis). Adopt the phasor convention $\\exp(j\\omega t)$.\n\nThe goal is to quantify, explain, and correct the phase error in the TE reflection coefficient due to numerical dispersion on the staggered Yee grid used in the Finite-Difference Time-Domain (FDTD) method, and to validate the correction across different Courant numbers.\n\nFundamental base for derivations:\n- Maxwell–Faraday law: $\\nabla \\times \\mathbf{E} = -\\mu \\dfrac{\\partial \\mathbf{H}}{\\partial t}$.\n- Maxwell–Ampère law in a lossless dielectric: $\\nabla \\times \\mathbf{H} = \\varepsilon \\dfrac{\\partial \\mathbf{E}}{\\partial t}$.\n- Plane-wave field relations in homogeneous media derived from the above.\n- Yee-grid central differencing yields a discrete-time, discrete-space dispersion relation relating numerical temporal and spatial frequencies.\n\nTasks:\n1) From Maxwell’s equations for a TE plane wave with phasor dependence $\\exp\\!\\left(j(k_x x + k_z z - \\omega t)\\right)$ in a homogeneous, isotropic medium with permittivity $\\varepsilon$ and permeability $\\mu$, derive the continuous-wavevector form of the TE reflection coefficient $r_{\\mathrm{TE}}(\\theta,\\omega)$ at a planar interface using only field continuity and the plane-wave relations. Your derivation must arrive at the form that depends on longitudinal wave numbers,\n$$\nr_{\\mathrm{TE,cont}} = \\frac{\\dfrac{k_{z1}}{\\mu_1}-\\dfrac{k_{z2}}{\\mu_2}}{\\dfrac{k_{z1}}{\\mu_1}+\\dfrac{k_{z2}}{\\mu_2}},\n$$\nwith $k_{zi} = \\sqrt{k_i^2 - k_x^2}$, $k_i = \\omega \\sqrt{\\mu_i \\varepsilon_i}$, and $k_x = k_1 \\sin\\theta$. This expression remains valid when $k_{z2}$ is purely imaginary (total internal reflection), leading to a complex-valued $r_{\\mathrm{TE,cont}}$ with a nontrivial phase.\n\n2) For the two-dimensional Yee grid with spatial steps $\\Delta x=\\Delta z=\\Delta$ and time step $\\Delta t$, perform a discrete-space–time Fourier analysis of the staggered update equations to obtain the numerical dispersion relation for a homogeneous medium $i$,\n$$\n\\hat{\\omega}^2 = c_i^2 \\left(\\hat{k}_x^2 + \\hat{k}_z^2\\right),\n$$\nwhere $c_i = 1/\\sqrt{\\mu_i \\varepsilon_i}$ is the physical speed of light in medium $i$ and the “hat” operators are the Yee-grid mappings\n$$\n\\hat{\\omega} = \\frac{2}{\\Delta t}\\sin\\!\\left(\\frac{\\omega \\Delta t}{2}\\right),\\quad\n\\hat{k}_x = \\frac{2}{\\Delta}\\sin\\!\\left(\\frac{k_x \\Delta}{2}\\right),\\quad\n\\hat{k}_z = \\frac{2}{\\Delta}\\sin\\!\\left(\\frac{k_z \\Delta}{2}\\right).\n$$\nUsing the same plane-wave ansatz applied to the discrete update equations, show that the discrete analog of the TE plane-wave field relations implies $H_x = \\dfrac{\\hat{k}_z}{\\hat{\\omega}\\mu} E_y$. Use continuity of $E_y$ and $H_x$ at $z=0$ (and continuity of $k_x$ across the interface) to derive the FDTD-compatible, dispersion-corrected reflection coefficient,\n$$\nr_{\\mathrm{TE,num}} = \\frac{\\dfrac{\\hat{k}_{z1}}{\\mu_1}-\\dfrac{\\hat{k}_{z2}}{\\mu_2}}{\\dfrac{\\hat{k}_{z1}}{\\mu_1}+\\dfrac{\\hat{k}_{z2}}{\\mu_2}},\n$$\nwhere $\\hat{k}_{zi}$ is obtained by solving the numerical dispersion relation for each medium,\n$$\n\\hat{k}_{zi} = \\sqrt{\\left(\\frac{\\hat{\\omega}}{c_i}\\right)^2 - \\hat{k}_x^2}.\n$$\nWhen the argument of the square root is negative, take the principal square root to obtain a purely imaginary $\\hat{k}_{zi}$, corresponding to evanescence.\n\n3) Define the numerical Courant number for the two-dimensional square Yee grid as $S = \\dfrac{c\\Delta t}{\\Delta}$, where $c$ is the speed of light in vacuum. For fixed $\\Delta$ and $\\omega$, numerical dispersion varies with $S$. Quantify the phase error induced by numerical dispersion by comparing the phases of $r_{\\mathrm{TE,cont}}$ and $r_{\\mathrm{TE,num}}$ for a set of incidence angles that includes both propagating and total-internal-reflection regimes. For a given $(\\theta,\\omega,\\Delta,S)$, define the phase error as the principal value of the phase difference,\n$$\n\\Delta \\phi(\\theta; S) = \\mathrm{Arg}\\!\\left(r_{\\mathrm{TE,cont}}(\\theta)\\, r_{\\mathrm{TE,num}}(\\theta; S)^{\\ast}\\right),\n$$\nwith $\\mathrm{Arg}(\\cdot)\\in(-\\pi,\\pi]$ and $(\\cdot)^{\\ast}$ denoting complex conjugation. For each $S$ in the test suite, compute the root-mean-square (RMS) phase error over the specified angles,\n$$\n\\mathrm{RMS}(S) = \\sqrt{\\frac{1}{N_\\theta}\\sum_{m=1}^{N_\\theta} \\left[\\Delta \\phi(\\theta_m; S)\\right]^2 }.\n$$\n\nPhysical and numerical parameters to use for evaluation:\n- Vacuum speed of light $c = 299{,}792{,}458\\ \\mathrm{m/s}$.\n- Vacuum permeability $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$ and vacuum permittivity $\\varepsilon_0 = 1/(\\mu_0 c^2)\\ \\mathrm{F/m}$.\n- Nonmagnetic media: $\\mu_{r1}=\\mu_{r2}=1$, with $\\mu_i = \\mu_0 \\mu_{ri}$.\n- Dielectric permittivities: $\\varepsilon_{r1} = 4$ (incident medium), $\\varepsilon_{r2} = 1$ (transmission medium).\n- Spatial steps: $\\Delta x = \\Delta z = \\Delta = 10^{-3}\\ \\mathrm{m}$.\n- The angular frequency is chosen such that the wavelength in medium $1$ is sampled by $N_\\lambda = 10$ cells, i.e., $\\lambda_1 = N_\\lambda \\Delta$, so $f = c_1/\\lambda_1$ with $c_1 = c/\\sqrt{\\varepsilon_{r1}}$, and $\\omega = 2\\pi f$.\n- Incidence angles in radians: $\\theta \\in \\{0, 20\\pi/180, 40\\pi/180, 60\\pi/180, 80\\pi/180\\}$, i.e., $N_\\theta = 5$.\n- Courant numbers: $S \\in \\{0.2, 0.4, 0.6, 0.7\\}$, where the two-dimensional square-grid stability limit is $S \\le 1/\\sqrt{2}$.\n\nComputation and output requirements:\n- For each $S$ in the set above, compute $\\mathrm{RMS}(S)$ in radians using the definitions in items $1$–$3$.\n- Your program must produce a single line of output containing the four RMS phase errors in radians, in the same order as the Courant numbers are listed, as a comma-separated list enclosed in square brackets (e.g., $\"[x_1,x_2,x_3,x_4]\"$).\n- Express all angles in radians. The final numerical outputs must be rounded to six digits after the decimal point.\n- No user input is allowed; all constants and parameters must be defined in the program exactly as specified here.\n\nTest suite summary to be implemented verbatim:\n- $\\varepsilon_{r1} = 4$, $\\varepsilon_{r2} = 1$, $\\mu_{r1} = \\mu_{r2} = 1$.\n- $\\Delta = 10^{-3}\\ \\mathrm{m}$, $N_\\lambda = 10$, $c = 299{,}792{,}458\\ \\mathrm{m/s}$, $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$, $\\varepsilon_0 = 1/(\\mu_0 c^2)\\ \\mathrm{F/m}$.\n- $\\theta \\in \\{0, 20\\pi/180, 40\\pi/180, 60\\pi/180, 80\\pi/180\\}$.\n- $S \\in \\{0.2, 0.4, 0.6, 0.7\\}$.\n- Output format: a single line with $\"[r_1,r_2,r_3,r_4]\"$, where each $r_i$ is $\\mathrm{RMS}(S_i)$ in radians, rounded to six decimals.",
            "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in Maxwell's equations and the Finite-Difference Time-Domain (FDTD) method, is well-posed with all necessary parameters provided, and is expressed objectively. The tasks are a standard, albeit comprehensive, exercise in analyzing the numerical dispersion of the FDTD method. We proceed with a complete solution.\n\nThe solution is structured into three parts, following the tasks outlined in the problem statement. First, we derive the continuous reflection coefficient. Second, we derive its numerical counterpart based on the FDTD Yee grid. Third, we detail the computational procedure to quantify the phase error between the two.\n\n**1. Continuous TE Reflection Coefficient ($r_{\\mathrm{TE,cont}}$)**\n\nWe consider a time-harmonic, transversely electric (TE) plane wave incident on the interface at $z=0$. The electric field is polarized along the y-axis, $\\mathbf{E} = E_y \\hat{\\mathbf{y}}$. Using the phasor convention $\\exp(j\\omega t)$, Maxwell's equations in a source-free, lossless, isotropic medium are:\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mu\\mathbf{H}\n$$\n$$\n\\nabla \\times \\mathbf{H} = j\\omega\\varepsilon\\mathbf{E}\n$$\nFor a TE wave propagating in the $xz$-plane with a wave vector $\\mathbf{k} = k_x \\hat{\\mathbf{x}} + k_z \\hat{\\mathbf{z}}$, the electric field phasor is $\\mathbf{E}(x,z) = \\hat{\\mathbf{y}} E_y(x,z)$. The spatial dependence is given by $\\exp(-j(k_x x + k_z z))$. From the first curl equation:\n$$\n\\nabla \\times \\mathbf{E} = \\frac{\\partial E_y}{\\partial z}\\hat{\\mathbf{x}} - \\frac{\\partial E_y}{\\partial x}\\hat{\\mathbf{z}} = (-jk_z E_y)\\hat{\\mathbf{x}} - (-jk_x E_y)\\hat{\\mathbf{z}}\n$$\nEquating this to $-j\\omega\\mu\\mathbf{H} = -j\\omega\\mu(H_x\\hat{\\mathbf{x}} + H_z\\hat{\\mathbf{z}})$, we find the magnetic field components:\n$$\nH_x = \\frac{k_z}{\\omega\\mu}E_y, \\quad H_z = -\\frac{k_x}{\\omega\\mu}E_y\n$$\nThe tangential components of the fields are $E_y$ and $H_x$. At the interface $z=0$, we have an incident wave (i), a reflected wave (r) in medium 1 ($z0$), and a transmitted wave (t) in medium 2 ($z0$). The fields in each medium are:\n\nIn medium 1 ($z  0$), with parameters $\\varepsilon_1, \\mu_1$:\n$$\nE_{y1}(x,z) = \\left[ E_{i0} e^{-jk_{z1}z} + E_{r0} e^{+jk_{z1}z} \\right] e^{-jk_x x}\n$$\n$$\nH_{x1}(x,z) = \\frac{k_{z1}}{\\omega\\mu_1} \\left[ E_{i0} e^{-jk_{z1}z} - E_{r0} e^{+jk_{z1}z} \\right] e^{-jk_x x}\n$$\nThe sign change in the $H_x$ term for the reflected wave is due to its propagation direction having a component in the $-z$ direction (i.e., its wavevector is $k_x\\hat{\\mathbf{x}} - k_{z1}\\hat{\\mathbf{z}}$).\n\nIn medium 2 ($z  0$), with parameters $\\varepsilon_2, \\mu_2$:\n$$\nE_{y2}(x,z) = E_{t0} e^{-jk_{z2}z} e^{-jk_x x}\n$$\n$$\nH_{x2}(x,z) = \\frac{k_{z2}}{\\omega\\mu_2} E_{t0} e^{-jk_{z2}z} e^{-jk_x x}\n$$\nPhase-matching requires continuity of the tangential wave vector component $k_x$ across the interface. Thus, $k_x = k_1 \\sin\\theta = k_2 \\sin\\theta_t$, where $\\theta$ is the incidence angle and $\\theta_t$ is the transmission angle. The longitudinal wave numbers are $k_{zi} = \\sqrt{k_i^2 - k_x^2}$, with $k_i = \\omega\\sqrt{\\mu_i\\varepsilon_i}$.\n\nBoundary conditions at $z=0$ require continuity of tangential electric and magnetic fields:\n1.  $E_{y1}(x,0) = E_{y2}(x,0) \\implies E_{i0} + E_{r0} = E_{t0}$\n2.  $H_{x1}(x,0) = H_{x2}(x,0) \\implies \\frac{k_{z1}}{\\omega\\mu_1}(E_{i0} - E_{r0}) = \\frac{k_{z2}}{\\omega\\mu_2}E_{t0}$\n\nThe reflection coefficient is $r_{\\mathrm{TE,cont}} = E_{r0}/E_{i0}$. From the first boundary condition, $E_{t0} = E_{i0}(1+r_{\\mathrm{TE,cont}})$. Substituting this into the second condition and dividing by $E_{i0}$ gives:\n$$\n\\frac{k_{z1}}{\\mu_1}(1 - r_{\\mathrm{TE,cont}}) = \\frac{k_{z2}}{\\mu_2}(1 + r_{\\mathrm{TE,cont}})\n$$\nRearranging to solve for $r_{\\mathrm{TE,cont}}$:\n$$\n\\frac{k_{z1}}{\\mu_1} - \\frac{k_{z2}}{\\mu_2} = r_{\\mathrm{TE,cont}} \\left(\\frac{k_{z1}}{\\mu_1} + \\frac{k_{z2}}{\\mu_2}\\right)\n$$\nThis yields the desired expression:\n$$\nr_{\\mathrm{TE,cont}} = \\frac{\\dfrac{k_{z1}}{\\mu_1}-\\dfrac{k_{z2}}{\\mu_2}}{\\dfrac{k_{z1}}{\\mu_1}+\\dfrac{k_{z2}}{\\mu_2}}\n$$\n\n**2. Numerical TE Reflection Coefficient ($r_{\\mathrm{TE,num}}$)**\n\nThe FDTD method discretizes Maxwell's equations on a staggered Yee grid. A discrete-space-time Fourier analysis of the update equations reveals that the numerical solution no longer satisfies the continuous dispersion relation $k^2 = \\omega^2\\mu\\varepsilon$. Instead, it obeys a numerical dispersion relation. For a 2D Yee grid with $\\Delta x=\\Delta z=\\Delta$, this relation is given as:\n$$\n\\left( \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = c_i^2 \\left[ \\left( \\frac{2}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) \\right)^2 + \\left( \\frac{2}{\\Delta}\\sin\\left(\\frac{k_z \\Delta}{2}\\right) \\right)^2 \\right]\n$$\nUsing the \"hat\" operator notation provided:\n$$\n\\hat{\\omega}^2 = c_i^2 (\\hat{k}_x^2 + \\hat{k}_z^2)\n$$\nThis is the numerical analogue of $\\omega^2 = c_i^2(k_x^2+k_z^2)$. The derivation of the numerical reflection coefficient follows the same logic as the continuous case, but with all wave parameters replaced by their numerical counterparts. The key assertion, given in the problem, is that the discrete field relationship corresponding to $H_x = (k_z/\\omega\\mu)E_y$ is:\n$$\nH_x = \\frac{\\hat{k}_z}{\\hat{\\omega}\\mu} E_y\n$$\nThis defines a numerical wave impedance for TE waves. Applying the same boundary conditions of tangential field continuity at the interface, but now for the numerical fields, we arrive at an identical form for the reflection coefficient, but in terms of the numerical wave numbers:\n$$\nr_{\\mathrm{TE,num}} = \\frac{\\dfrac{\\hat{k}_{z1}}{\\mu_1}-\\dfrac{\\hat{k}_{z2}}{\\mu_2}}{\\dfrac{\\hat{k}_{z1}}{\\mu_1}+\\dfrac{\\hat{k}_{z2}}{\\mu_2}}\n$$\nThe numerical longitudinal wave numbers, $\\hat{k}_{zi}$, are found by solving the numerical dispersion relation for $\\hat{k}_z$:\n$$\n\\hat{k}_{zi} = \\sqrt{\\left(\\frac{\\hat{\\omega}}{c_i}\\right)^2 - \\hat{k}_x^2}\n$$\nHere, $\\hat{k}_x$ is obtained from the continuous $k_x$ through the sine mapping, as phase matching across the interface still imposes a single value of $k_x$, which is set by the incident wave. If the argument of the square root becomes negative (numerical total internal reflection), $\\hat{k}_{zi}$ becomes purely imaginary, leading to a complex $r_{\\mathrm{TE,num}}$ with unit magnitude.\n\n**3. Phase Error Calculation**\n\nThe final task is to compute the RMS phase error between the continuous and numerical reflection coefficients for a given set of parameters.\n\nFirst, we establish all physical and numerical parameters.\n-   Constants: $c = 299792458\\ \\mathrm{m/s}$, $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$, $\\varepsilon_0 = 1/(\\mu_0 c^2)\\ \\mathrm{F/m}$.\n-   Media properties: $\\varepsilon_{r1} = 4$, $\\varepsilon_{r2} = 1$, $\\mu_{r1} = \\mu_{r2} = 1$. This implies $\\mu_1 = \\mu_2 = \\mu_0$. The reflection coefficient formulas simplify by cancelling $\\mu$.\n-   Derived speeds: $c_1 = c/\\sqrt{\\varepsilon_{r1}} = c/2$, $c_2 = c/\\sqrt{\\varepsilon_{r2}} = c$.\n-   Grid and frequency: $\\Delta = 10^{-3}\\ \\mathrm{m}$, $N_\\lambda = 10$. The wavelength in medium 1 is $\\lambda_1 = N_\\lambda \\Delta = 10 \\times 10^{-3} = 0.01\\ \\mathrm{m}$.\n-   The wave frequency is $f = c_1/\\lambda_1 = (c/2)/0.01 = 50c$. The angular frequency is $\\omega = 2\\pi f = 100\\pi c$.\n-   Continuous wavenumbers: $k_1 = \\omega/c_1 = 200\\pi\\ \\mathrm{rad/m}$, $k_2 = \\omega/c_2 = 100\\pi\\ \\mathrm{rad/m}$.\n\nThe computation proceeds as follows:\nFor each Courant number $S \\in \\{0.2, 0.4, 0.6, 0.7\\}$:\n1.  Initialize a list to store the squared phase errors.\n2.  For each incidence angle $\\theta_m$ in $\\{0, 20, 40, 60, 80\\}$ degrees:\n    a. Calculate $r_{\\mathrm{TE,cont}}(\\theta_m)$:\n        i.  $k_x = k_1 \\sin\\theta_m$.\n        ii. $k_{z1} = \\sqrt{k_1^2 - k_x^2} = k_1\\cos\\theta_m$.\n        iii. $k_{z2} = \\sqrt{k_2^2 - k_x^2}$ (using complex arithmetic).\n        iv. $r_{\\mathrm{TE,cont}} = (k_{z1} - k_{z2})/(k_{z1} + k_{z2})$.\n    b. Calculate $r_{\\mathrm{TE,num}}(\\theta_m; S)$:\n        i.  $\\Delta t = S \\Delta/c$.\n        ii. $\\hat{\\omega} = \\frac{2}{\\Delta t}\\sin(\\frac{\\omega \\Delta t}{2})$.\n        iii. $\\hat{k}_x = \\frac{2}{\\Delta}\\sin(\\frac{k_x \\Delta}{2})$.\n        iv. $\\hat{k}_{z1} = \\sqrt{(\\hat{\\omega}/c_1)^2 - \\hat{k}_x^2}$ (using complex arithmetic).\n        v.  $\\hat{k}_{z2} = \\sqrt{(\\hat{\\omega}/c_2)^2 - \\hat{k}_x^2}$ (using complex arithmetic).\n        vi. $r_{\\mathrm{TE,num}} = (\\hat{k}_{z1} - \\hat{k}_{z2})/(\\hat{k}_{z1} + \\hat{k}_{z2})$.\n    c. Calculate the phase error: $\\Delta \\phi(\\theta_m; S) = \\mathrm{Arg}(r_{\\mathrm{TE,cont}} \\cdot r_{\\mathrm{TE,num}}^*)$.\n    d. Store $(\\Delta \\phi)^2$.\n3.  Compute the RMS error for the current $S$: $\\mathrm{RMS}(S) = \\sqrt{\\frac{1}{N_\\theta} \\sum_m (\\Delta \\phi_m)^2}$.\n\nThis process is repeated for all specified Courant numbers, and the final results are collected and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMS phase error in the TE reflection coefficient due to FDTD\n    numerical dispersion for various Courant numbers.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement\n    C0 = 299792458.0\n    MU0 = 4.0 * np.pi * 1e-7\n    EPS0 = 1.0 / (MU0 * C0**2)\n    \n    # Define physical and numerical parameters from the problem\n    EPS_R1 = 4.0\n    EPS_R2 = 1.0\n    MU_R1 = 1.0\n    MU_R2 = 1.0\n    \n    DELTA = 1e-3  # Spatial step [m]\n    N_LAMBDA = 10.0 # Wavelength sampling resolution\n    \n    thetas_deg = [0.0, 20.0, 40.0, 60.0, 80.0]\n    thetas_rad = [t * np.pi / 180.0 for t in thetas_deg]\n    n_theta = len(thetas_rad)\n    \n    courant_numbers = [0.2, 0.4, 0.6, 0.7]\n\n    # --- Derived Physical Quantities ---\n    \n    # Permittivity and permeability in each medium\n    eps1 = EPS_R1 * EPS0\n    eps2 = EPS_R2 * EPS0\n    mu1 = MU_R1 * MU0\n    mu2 = MU_R2 * MU0\n    \n    # Speed of light in each medium\n    c1 = 1.0 / np.sqrt(mu1 * eps1)\n    c2 = 1.0 / np.sqrt(mu2 * eps2)\n    \n    # Wave properties based on discretization\n    lambda1 = N_LAMBDA * DELTA\n    freq = c1 / lambda1\n    omega = 2.0 * np.pi * freq\n    \n    # Continuous wavenumbers in each medium\n    k1 = omega / c1\n    k2 = omega / c2\n    \n    rms_errors = []\n    \n    # Loop over Courant numbers\n    for S in courant_numbers:\n        \n        phase_errors_sq = []\n        \n        # Loop over incidence angles\n        for theta in thetas_rad:\n            \n            # --- 1. Continuous Case Calculation ---\n            \n            # Tangential wavenumber (conserved across interface)\n            kx = k1 * np.sin(theta)\n            \n            # Longitudinal wavenumbers\n            kz1_cont = np.sqrt(k1**2 - kx**2) # Should be real for theta in [0, pi/2]\n            # Use np.emath.sqrt for automatic complex number handling\n            kz2_cont = np.emath.sqrt(k2**2 - kx**2)\n            \n            # Since mu1=mu2=mu0, they cancel from the reflection coefficient formula\n            r_cont = (kz1_cont - kz2_cont) / (kz1_cont + kz2_cont)\n            \n            # --- 2. Numerical Case Calculation ---\n            \n            # FDTD time step\n            delta_t = S * DELTA / C0\n            \n            # Numerical frequency and tangential wavenumber (\"hat\" quantities)\n            omega_hat = (2.0 / delta_t) * np.sin(omega * delta_t / 2.0)\n            kx_hat = (2.0 / DELTA) * np.sin(kx * DELTA / 2.0)\n            \n            # Squared arguments for numerical longitudinal wavenumbers\n            kz1_num_sq_arg = (omega_hat / c1)**2 - kx_hat**2\n            kz2_num_sq_arg = (omega_hat / c2)**2 - kx_hat**2\n            \n            # Numerical longitudinal wavenumbers (using complex-safe sqrt)\n            kz1_num = np.emath.sqrt(kz1_num_sq_arg)\n            kz2_num = np.emath.sqrt(kz2_num_sq_arg)\n            \n            # Numerical reflection coefficient (mu terms cancel)\n            r_num = (kz1_num - kz2_num) / (kz1_num + kz2_num)\n            \n            # --- 3. Phase Error Calculation ---\n            \n            # Phase difference as Arg(r_cont * conj(r_num))\n            delta_phi = np.angle(r_cont * np.conj(r_num))\n            phase_errors_sq.append(delta_phi**2)\n            \n        # --- 4. RMS Error Calculation ---\n        \n        # Calculate RMS error for the current Courant number S\n        rms_error = np.sqrt(np.mean(phase_errors_sq))\n        rms_errors.append(rms_error)\n        \n    # --- Final Output Formatting ---\n    \n    # Format results to six decimal places as specified\n    formatted_results = [f\"{r:.6f}\" for r in rms_errors]\n    \n    # Print the final result in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}