{
    "hands_on_practices": [
        {
            "introduction": "阻抗匹配是波工程（从微波电路到光学涂层）中的一个基石概念，旨在最大化能量传输并最小化不必要的反射。本练习将指导您完成单层匹配层的分析设计，这是一个经典的电磁学问题。通过推导其在设计频率下的完美匹配条件以及在偏离设计频率时的反射特性，您将对阻抗匹配的原理及其带宽限制有深刻的物理理解。",
            "id": "3345586",
            "problem": "角频率为 $\\omega$ 的时谐平面波从一个本征阻抗为 $\\eta_{1}$ 的半无限、无损、非色散介质 $\\mathsf{1}$ 垂直入射到一个本征阻抗为 $\\eta_{2}$ 的半无限、无损、非色散介质 $\\mathsf{2}$ 上。为了减少反射，在两种介质之间放置一个均匀、无损、非色散的匹配层。该匹配层的本征阻抗为 $\\eta_{m}$，厚度为 $d$。其设计使得在设计角频率 $\\omega_{0}$ 处，电厚度满足 $\\beta_{m}(\\omega_{0})\\,d = \\pi/2$，其中 $\\beta_{m}(\\omega)$ 是匹配层中的相位常数，并且阻抗选择为 $\\eta_{m} = \\sqrt{\\eta_{1}\\eta_{2}}$。假设所有材料都是非色散的，因此匹配层中的相速度与频率无关，这意味着 $\\beta_{m}(\\omega) = (\\omega/\\omega_{0})\\,\\beta_{m}(\\omega_{0})$。\n\n从麦克斯韦方程组以及平面分界面上切向电场和磁场的连续性出发，使用垂直入射下的平面波传输线类比法对该三层区域堆栈进行建模，并推导从介质 $\\mathsf{1}$ 看进去的精确反射系数 $\\Gamma(\\omega)$。然后，对于小的分数失谐 $\\varepsilon = (\\omega - \\omega_{0})/\\omega_{0}$，当 $\\varepsilon \\to 0$ 时，推导功率反射系数 $|\\Gamma(\\omega)|^{2}$ 关于 $\\eta_{1}$ 和 $\\eta_{2}$ 的前导阶渐近表达式。\n\n将 $|\\Gamma(\\omega)|^{2}$ 前导阶的最终答案表示为单一的闭式解析表达式。无需进行数值计算，也不应包含单位。",
            "solution": "该问题已经过验证，被认为是有效的。这是一个关于四分之一波长阻抗匹配变换器分析的适定的、有科学依据的计算电磁学问题。所有提供的信息都是一致、完整且具有物理意义的。\n\n我们首先按要求建立垂直入射下时谐平面波的传输线类比。对于一个沿 $z$ 轴传播的平面波，其电场为 $\\vec{E} = E_x(z)\\hat{x}$，磁场为 $\\vec{H} = H_y(z)\\hat{y}$，在无源、线性、各向同性、均匀介质中，麦克斯韦旋度方程简化为一对耦合的常微分方程：\n$$ \\frac{dE_x(z)}{dz} = -j\\omega\\mu H_y(z) $$\n$$ \\frac{dH_y(z)}{dz} = -j\\omega\\epsilon E_x(z) $$\n这些方程在数学上等同于无损传输线的电报方程：\n$$ \\frac{dV(z)}{dz} = -j\\omega L' I(z) $$\n$$ \\frac{dI(z)}{dz} = -j\\omega C' V(z) $$\n通过建立 $V(z) \\leftrightarrow E_x(z)$、$I(z) \\leftrightarrow H_y(z)$、$L' \\leftrightarrow \\mu$ 和 $C' \\leftrightarrow \\epsilon$ 的对应关系，我们可以将电磁问题建模为传输线问题。介质的本征阻抗 $\\eta = \\sqrt{\\mu/\\epsilon}$ 对应于传输线的特性阻抗 $Z_0 = \\sqrt{L'/C'}$。分界面上 $\\vec{E}$ 和 $\\vec{H}$ 切向分量的连续性对应于连接点处电压和电流的连续性。这种类比使我们能够将三层区域堆栈建模为一条传输线（介质 $\\mathsf{1}$）连接到长度为 $d$ 的第二段传输线（匹配层），而后者又由一条半无限传输线（负载，即介质 $\\mathsf{2}$）端接。\n\n半无限介质 $\\mathsf{2}$ 所呈现的负载阻抗是其本征阻抗，即 $Z_L = \\eta_2$。匹配层是一段长度为 $d$、特性阻抗为 $\\eta_m$ 的传输线。从介质 $\\mathsf{1}$ 看向匹配层的输入阻抗 $\\eta_{in}$ 由标准传输线阻抗变换公式给出：\n$$ \\eta_{in}(\\omega) = \\eta_m \\frac{\\eta_2 + j\\eta_m \\tan(\\beta_m(\\omega) d)}{\\eta_m + j\\eta_2 \\tan(\\beta_m(\\omega) d)} $$\n其中 $\\beta_m(\\omega)$ 是匹配层中的相位常数。介质 $\\mathsf{1}$ 与匹配层之间分界面处的反射系数 $\\Gamma(\\omega)$ 为：\n$$ \\Gamma(\\omega) = \\frac{\\eta_{in}(\\omega) - \\eta_1}{\\eta_{in}(\\omega) + \\eta_1} $$\n代入 $\\eta_{in}(\\omega)$ 的表达式并化简可得：\n$$ \\Gamma(\\omega) = \\frac{\\eta_m(\\eta_2 + j\\eta_m \\tan(\\beta_m d)) - \\eta_1(\\eta_m + j\\eta_2 \\tan(\\beta_m d))}{\\eta_m(\\eta_2 + j\\eta_m \\tan(\\beta_m d)) + \\eta_1(\\eta_m + j\\eta_2 \\tan(\\beta_m d))} = \\frac{\\eta_m(\\eta_2 - \\eta_1) + j(\\eta_m^2 - \\eta_1\\eta_2)\\tan(\\beta_m d)}{\\eta_m(\\eta_2 + \\eta_1) + j(\\eta_m^2 + \\eta_1\\eta_2)\\tan(\\beta_m d)} $$\n问题指明了在设计频率 $\\omega_0$ 处的四分之一波长匹配条件，即 $\\eta_m = \\sqrt{\\eta_1\\eta_2}$。将 $\\eta_m^2 = \\eta_1\\eta_2$ 代入 $\\Gamma(\\omega)$ 的表达式，可使分子的虚部简化为零。由此得出匹配结构的精确反射系数：\n$$ \\Gamma(\\omega) = \\frac{\\eta_m(\\eta_2 - \\eta_1)}{\\eta_m(\\eta_2 + \\eta_1) + j2\\eta_1\\eta_2 \\tan(\\beta_m(\\omega) d)} $$\n这就完成了任务的第一部分。\n\n对于第二部分，我们推导在小分数失谐 $\\varepsilon = (\\omega - \\omega_0)/\\omega_0 \\ll 1$ 条件下，功率反射系数 $|\\Gamma(\\omega)|^2$ 的前导阶渐近表达式。非色散匹配层中的相位常数由 $\\beta_m(\\omega) = (\\omega/\\omega_0)\\beta_m(\\omega_0)$ 给出。因此，频率 $\\omega$ 处的电厚度为：\n$$ \\beta_m(\\omega) d = \\frac{\\omega}{\\omega_0} \\beta_m(\\omega_0) d $$\n使用设计条件 $\\beta_m(\\omega_0) d = \\pi/2$ 以及 $\\varepsilon$ 的定义（这意味着 $\\omega/\\omega_0 = 1+\\varepsilon$）：\n$$ \\beta_m(\\omega) d = (1+\\varepsilon)\\frac{\\pi}{2} = \\frac{\\pi}{2} + \\frac{\\varepsilon\\pi}{2} $$\n现在我们分析当 $\\varepsilon$ 很小时的正切项：\n$$ \\tan(\\beta_m(\\omega) d) = \\tan\\left(\\frac{\\pi}{2} + \\frac{\\varepsilon\\pi}{2}\\right) = -\\cot\\left(\\frac{\\varepsilon\\pi}{2}\\right) $$\n对于小自变量 $x$，余切函数的前导阶泰勒展开为 $\\cot(x) \\approx 1/x$。因此，当 $\\varepsilon \\to 0$ 时：\n$$ \\tan(\\beta_m(\\omega) d) \\approx -\\frac{1}{\\frac{\\varepsilon\\pi}{2}} = -\\frac{2}{\\varepsilon\\pi} $$\n将此近似值代入 $\\Gamma(\\omega)$ 的表达式中：\n$$ \\Gamma(\\omega) \\approx \\frac{\\eta_m(\\eta_2 - \\eta_1)}{\\eta_m(\\eta_2 + \\eta_1) + j2\\eta_1\\eta_2 \\left(-\\frac{2}{\\varepsilon\\pi}\\right)} = \\frac{\\eta_m(\\eta_2 - \\eta_1)}{\\eta_m(\\eta_2 + \\eta_1) - j\\frac{4\\eta_1\\eta_2}{\\varepsilon\\pi}} $$\n当 $\\varepsilon \\to 0$ 时，分母中的虚部项成为主导项。因此，我们可以忽略实部项 $\\eta_m(\\eta_2 + \\eta_1)$ 来找到其前导阶行为：\n$$ \\Gamma(\\omega) \\approx \\frac{\\eta_m(\\eta_2 - \\eta_1)}{-j\\frac{4\\eta_1\\eta_2}{\\varepsilon\\pi}} = j\\frac{\\varepsilon\\pi\\eta_m(\\eta_2 - \\eta_1)}{4\\eta_1\\eta_2} $$\n代入 $\\eta_m = \\sqrt{\\eta_1\\eta_2}$：\n$$ \\Gamma(\\omega) \\approx j\\frac{\\varepsilon\\pi\\sqrt{\\eta_1\\eta_2}(\\eta_2 - \\eta_1)}{4\\eta_1\\eta_2} = j\\frac{\\varepsilon\\pi(\\eta_2 - \\eta_1)}{4\\sqrt{\\eta_1\\eta_2}} $$\n功率反射系数为 $|\\Gamma(\\omega)|^2 = \\Gamma(\\omega)\\Gamma^*(\\omega)$。由于对于无损介质 $\\eta_1$ 和 $\\eta_2$ 都是实数：\n$$ |\\Gamma(\\omega)|^2 \\approx \\left| j\\frac{\\varepsilon\\pi(\\eta_2 - \\eta_1)}{4\\sqrt{\\eta_1\\eta_2}} \\right|^2 = |j|^2 \\left(\\frac{\\varepsilon\\pi(\\eta_2 - \\eta_1)}{4\\sqrt{\\eta_1\\eta_2}}\\right)^2 $$\n$$ |\\Gamma(\\omega)|^2 \\approx \\frac{\\pi^2 (\\eta_2 - \\eta_1)^2}{16\\eta_1\\eta_2} \\varepsilon^2 $$\n这就是当 $\\varepsilon \\to 0$ 时功率反射系数的前导阶渐近表达式。",
            "answer": "$$ \\boxed{\\frac{\\pi^2 (\\eta_2 - \\eta_1)^2}{16 \\eta_1 \\eta_2} \\varepsilon^2} $$"
        },
        {
            "introduction": "在单层分析的基础上，许多先进的光学和微波器件依赖于由多层薄膜构成的复杂结构。本实践将向您介绍一种强大且通用的计算工具——传输矩阵法（TMM），用于精确分析任意多层介质堆栈的响应。此外，您还将实现一种广泛使用的近似方法，即等效介质理论，并将两种模型的结果进行比较，从而亲身体验均质化方法在亚波长尺度下的有效性及其失效的临界条件。",
            "id": "3345660",
            "problem": "一个角频率为 $\\omega$、真空波长为 $\\lambda_0$ 的时谐平面波，从一种无损耗的环境介质正入射到一个一维周期性多层堆叠结构中。该结构由两种各向同性、非磁性的电介质组成，其标量相对介电常数分别为 $\\epsilon_1$ 和 $\\epsilon_2$。该堆叠结构的每个周期由两层厚度分别为 $d_1$ 和 $d_2$ 的介质层构成，重复 $N$ 次，且该堆叠结构终止于一个无损耗的衬底介质。假设所有介质的磁导率均为 $\\mu=\\mu_0$，因此折射率为 $n=\\sqrt{\\epsilon_r}$，且正入射时的波导纳与 $n$ 成正比。您的任务是推导、实现并比较用于该堆叠结构反射和透射的两种模型：(i) 针对分立多层结构的精确传输矩阵模型，以及 (ii) 将周期性堆叠结构替换为一个厚度为 $L=N(d_1+d_2)$、等效介电常数为 $\\epsilon_{\\mathrm{eff}}$ 的单一均匀平板的均匀化等效介质模型。您必须从频域中的麦克斯韦方程组以及平面界面处切向场的连续性出发进行推导（推导过程中不允许使用任何捷径或直接引用多层膜公式）。\n\n仅使用基本定律和核心定义，完成以下任务：\n- 从麦克斯韦方程组所蕴含的边界条件出发，推导在正入射情况下，穿过单个均匀介质层的正向和反向行波振幅之间的 $2\\times 2$ 线性关系，该关系用其折射率 $n_\\ell$ 和厚度 $d_\\ell$ 表示。然后推导这些关系如何为一系列介质层进行组合，从而得出整个堆叠结构的总传输关系。由此，根据环境介质和衬底的波导纳以及总传输矩阵的元素，求出整个堆叠结构的复反射系数 $r$ 和复透射系数 $t$ 的表达式。\n- 对于均匀化等效介质模型，当电场与介质层相切时，论证正入射情况下 $\\epsilon_{\\mathrm{eff}}$ 的选择依据。在此情况下，使用合适的体积平均值计算 $\\epsilon_{\\mathrm{eff}}$，并将堆叠结构建模为厚度为 $L=N(d_1+d_2)$ 的单一均匀平板。\n- 根据复振幅 $r$ 和 $t$ 以及环境/衬底导纳，定义功率反射率 $R$ 和功率透射率 $T$，并定义透射相位 $\\phi_t=\\arg(t)$。解释如何计算两个相位在模 $2\\pi$ 意义下的最小绝对相位差。\n\n然后，实现一个程序，该程序能够：\n- 使用分立堆叠结构的传输矩阵模型计算精确的复反射系数 $r_{\\mathrm{exact}}$ 和复透射系数 $t_{\\mathrm{exact}}$。\n- 使用具有 $\\epsilon_{\\mathrm{eff}}$ 和厚度 $L$ 的单个等效平板计算均匀化后的复反射系数 $r_{\\mathrm{eff}}$ 和复透射系数 $t_{\\mathrm{eff}}$。\n- 报告三个定量比较指标：\n  1. 功率反射率的绝对误差 $|R_{\\mathrm{exact}}-R_{\\mathrm{eff}}|$。\n  2. 功率透射率的绝对误差 $|T_{\\mathrm{exact}}-T_{\\mathrm{eff}}|$。\n  3. 透射相位的最小绝对差 $|\\Delta \\phi_t|$（单位为弧度）。\n- 为每种情况声明一个均匀化有效性的布尔值，该值当且仅当以下三个条件全部满足时为真：$|R_{\\mathrm{exact}}-R_{\\mathrm{eff}}|  0.02$，$|T_{\\mathrm{exact}}-T_{\\mathrm{eff}}|  0.02$，以及 $|\\Delta \\phi_t|  0.1$。\n\n所有涉及物理单位的答案必须使用国际单位制（SI）。角度必须以弧度为单位。输出的 $R$、$T$ 和误差是无量纲的。透射相位以弧度为单位。\n\n测试套件。您的程序必须精确评估以下四个测试案例，它们分别代表一个典型案例、一个临界案例、一个失效案例和一个低对比度案例：\n- 案例 1：$\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$，环境折射率 $n_0=1.0$，衬底折射率 $n_s=1.0$，$\\epsilon_1=2.25$，$\\epsilon_2=12.25$，一个周期中层1的体积分数 $f=0.4$，归一化周期 $p=(d_1+d_2)/\\lambda_0=0.05$，周期数 $N=20$。设置 $d_1=f\\,p\\,\\lambda_0$ 和 $d_2=(1-f)\\,p\\,\\lambda_0$。\n- 案例 2：$\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$，$n_0=1.0$，$n_s=1.0$，$\\epsilon_1=2.25$，$\\epsilon_2=12.25$，$f=0.4$，$p=0.2$，$N=5$。\n- 案例 3：$\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$，$n_0=1.0$，$n_s=1.0$，$\\epsilon_1=2.25$，$\\epsilon_2=12.25$，$f=0.4$，$p=0.5$，$N=2$。\n- 案例 4：$\\lambda_0=1.55\\times 10^{-6}\\ \\mathrm{m}$，$n_0=1.0$，$n_s=1.0$，$\\epsilon_1=2.25$，$\\epsilon_2=2.89$，$f=0.5$，$p=0.2$，$N=5$。\n\n数值实现说明：\n- 使用 $k_0=2\\pi/\\lambda_0$。\n- 对于精确堆叠结构，构建包含 $d_1$ 和 $d_2$ 的分立双层周期，并将其重复 $N$ 次。总厚度为 $L=N(d_1+d_2)$。\n- 对于等效介质，在正入射（电场与界面相切）情况下，使用 $\\epsilon_{\\parallel}=f\\,\\epsilon_1+(1-f)\\,\\epsilon_2$，且 $n_{\\mathrm{eff}}=\\sqrt{\\epsilon_{\\parallel}}$。将环境介质和衬底之间建模为一个厚度为 $L$、折射率为 $n_{\\mathrm{eff}}$ 的单层。\n- 计算功率透射率 $T=(\\Re\\{Y_s\\}/\\Re\\{Y_0\\})\\,|t|^2$，其中 $Y_0$ 和 $Y_s$ 是正入射时环境介质和衬底的波导纳。对于正入射下的非磁性、无损耗介质，有 $Y\\propto n$，因此在计算 $T$ 时，你可以取 $Y=n$，省去一个会在比例中被抵消的公因子。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个结果列表，每个测试案例对应一个子列表，每个子列表中的顺序和格式如下：\n- $[\\text{case\\_index}, p, |R_{\\mathrm{exact}}-R_{\\mathrm{eff}}|, |T_{\\mathrm{exact}}-T_{\\mathrm{eff}}|, |\\Delta \\phi_t|, \\text{homogenization\\_valid}]$,\n其中 $\\text{case\\_index}$ 是 $\\{1,2,3,4\\}$ 中的一个整数，$p$ 是归一化周期 $(d_1+d_2)/\\lambda_0$，接下来的三个字段是浮点数，最后一个字段是布尔值。例如，整个输出应类似于 Python 风格的列表的列表，显示在单行上，例如 $[[\\dots],[\\dots],[\\dots],[\\dots]]$，条目之间用逗号分隔。",
            "solution": "该问题被评估为有效。它在科学上基于经典电磁学，问题是适定的，并为一项可验证的计算任务提供了一套完整且一致的参数。\n\n分析过程如下：从第一性原理推导多层堆叠结构的传输矩阵模型，论证等效介质近似的合理性，并定义所需的性能指标。\n\n**1. 从麦克斯韦方程组推导**\n\n我们从无源、线性、各向同性介质中的时谐麦克斯韦方程组开始，假设时间依赖关系为 $e^{j\\omega t}$：\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon \\mathbf{E} $$\n对于在非磁性介质（$\\mu = \\mu_0$）中沿 z 轴正向传播的平面波，其电场沿 x 轴极化，场可以表示为 $\\mathbf{E} = E_x(z) \\hat{\\mathbf{x}}$ 和 $\\mathbf{H} = H_y(z) \\hat{\\mathbf{y}}$。旋度方程简化为一组常微分方程组：\n$$ \\frac{dE_x}{dz} = -j\\omega\\mu_0 H_y $$\n$$ \\frac{dH_y}{dz} = -j\\omega\\epsilon_0\\epsilon_r E_x $$\n将它们结合起来，得到关于 $E_x(z)$ 的一维亥姆霍兹方程：\n$$ \\frac{d^2 E_x}{dz^2} + k^2 E_x = 0 $$\n其中 $k = \\omega\\sqrt{\\mu_0\\epsilon} = \\omega\\sqrt{\\mu_0\\epsilon_0\\epsilon_r} = k_0 \\sqrt{\\epsilon_r} = k_0 n$ 是介质中的波数。这里，$k_0 = 2\\pi/\\lambda_0$ 是真空波数，$n=\\sqrt{\\epsilon_r}$ 是折射率。\n\n在均匀介质层中，$E_x(z)$ 的通解是前向传播波和后向传播波的叠加：\n$$ E_x(z) = E^+ e^{-jkz} + E^- e^{+jkz} $$\n从第一个麦克斯韦常微分方程，我们求出对应的磁场：\n$$ H_y(z) = \\frac{1}{-j\\omega\\mu_0} \\frac{dE_x}{dz} = \\frac{k}{\\omega\\mu_0} (E^+ e^{-jkz} - E^- e^{+jkz}) = Y (E^+ e^{-jkz} - E^- e^{+jkz}) $$\n其中 $Y = k/(\\omega\\mu_0) = n k_0 / (\\omega\\mu_0) = n \\sqrt{\\epsilon_0/\\mu_0}$。量 $Y$ 是介质的波导纳。对于所考虑的无损耗、非磁性介质，$Y$ 与折射率 $n$ 成正比。我们可以定义一个归一化导纳 $Y_i = n_i$。\n\n**2. 多层堆叠结构的传输矩阵模型**\n\n在两种介质之间的任何界面上，电场和磁场的切向分量（$E_x$ 和 $H_y$）必须是连续的。传输矩阵法通过将一个平面上的总场与另一个平面上的总场关联起来，将这一特性形式化。\n\n考虑一个厚度为 $d_\\ell$、折射率为 $n_\\ell$（因此波数为 $k_\\ell$，导纳为 $Y_\\ell$）的单一均匀介质层，它位于平面 $z=z_1$ 和 $z=z_2=z_1+d_\\ell$ 之间。该层内任意点 $z$ 的总场 $(E(z), H(z))$ 可以用该层出射平面 $z_2$ 处的场来表示。\n$$ E(z) = E(z_2) \\cos[k_\\ell(z_2-z)] + H(z_2) \\frac{j}{Y_\\ell} \\sin[k_\\ell(z_2-z)] $$\n$$ H(z) = E(z_2) (j Y_\\ell) \\sin[k_\\ell(z_2-z)] + H(z_2) \\cos[k_\\ell(z_2-z)] $$\n令 $z=z_1$，我们得到该层的矩阵关系：\n$$ \\begin{pmatrix} E(z_1) \\\\ H(z_1) \\end{pmatrix} = \\begin{pmatrix} \\cos(k_\\ell d_\\ell)  \\frac{j}{Y_\\ell}\\sin(k_\\ell d_\\ell) \\\\ j Y_\\ell \\sin(k_\\ell d_\\ell)  \\cos(k_\\ell d_\\ell) \\end{pmatrix} \\begin{pmatrix} E(z_2) \\\\ H(z_2) \\end{pmatrix} $$\n这个我们记为 $M_\\ell$ 的矩阵是该层的特征矩阵。其行列式为 $\\det(M_\\ell)=1$。\n\n对于级联的介质层，总特征矩阵是各个矩阵的乘积。对于指定的由 $N$ 个周期组成的堆叠结构，其中每个周期由一个厚度为 $d_1$、折射率为 $n_1$ 的层，后跟一个厚度为 $d_2$、折射率为 $n_2$ 的层组成，总矩阵 $M_{stack}$ 为：\n$$ M_{stack} = (M_1 M_2)^N = \\begin{pmatrix} A  B \\\\ C  D \\end{pmatrix} $$\n其中 $M_1$ 和 $M_2$ 分别是层1和层2的特征矩阵。\n\n**3. 反射系数和透射系数**\n\n多层堆叠结构位于导纳为 $Y_0=n_0$ 的环境介质（$z0$）和导纳为 $Y_s=n_s$ 的衬底介质（$zL$）之间。堆叠结构占据区域 $0 \\le z \\le L$。\n在输入端（$z=0$），场是入射波（振幅为 1）和反射波（振幅为 $r$）的叠加：\n$$ E(0) = 1 + r $$\n$$ H(0) = Y_0(1-r) $$\n在输出端（$z=L$），只有透射波（振幅为 $t$）：\n$$ E(L) = t $$\n$$ H(L) = Y_s t $$\n将这些边界条件代入总矩阵关系 $\\begin{pmatrix}E(0) \\\\ H(0)\\end{pmatrix} = M_{stack} \\begin{pmatrix}E(L) \\\\ H(L)\\end{pmatrix}$ 中，得到：\n$$ 1+r = A t + B (Y_s t) = (A + B Y_s)t $$\n$$ Y_0(1-r) = C t + D (Y_s t) = (C + D Y_s)t $$\n这是一个关于复反射系数 $r$ 和复透射系数 $t$ 的线性系统。解出 $r$ 和 $t$ 得到：\n$$ r = \\frac{(A Y_0 - D Y_s) + B Y_0 Y_s - C}{(A Y_0 + D Y_s) + B Y_0 Y_s + C} $$\n$$ t = \\frac{2 Y_0}{(A Y_0 + D Y_s) + B Y_0 Y_s + C} $$\n在实现中，我们使用归一化导纳 $Y_i=n_i$。\n\n**4. 均匀化等效介质模型**\n\n在长波极限下，即层厚度远小于波长（$d_1, d_2 \\ll \\lambda$）时，周期性堆叠结构可以近似为一个单一的均匀平板。对于正入射，电场 $\\mathbf{E} = E_x \\hat{\\mathbf{x}}$ 与层界面相切。根据边界条件，$E_x$ 在界面上是连续的。平均电位移场 $\\langle D_x \\rangle = \\epsilon_{\\mathrm{eff}} \\langle E_x \\rangle$。将一个周期内的电场近似为常数，$\\langle E_x \\rangle \\approx E_x$，则平均位移是局部电位移的体积加权平均值：\n$$ \\langle D_x \\rangle = \\frac{d_1 D_1 + d_2 D_2}{d_1+d_2} = \\frac{d_1 \\epsilon_1 E_x + d_2 \\epsilon_2 E_x}{d_1+d_2} = \\left(\\frac{d_1}{d_1+d_2}\\epsilon_1 + \\frac{d_2}{d_1+d_2}\\epsilon_2\\right) E_x $$\n这就定义了电场平行于各层时的有效相对介电常数：\n$$ \\epsilon_{\\mathrm{eff}} = f\\epsilon_1 + (1-f)\\epsilon_2 $$\n其中 $f = d_1/(d_1+d_2)$ 是层1的体积分数。\n因此，均匀化模型由一个厚度为 $L=N(d_1+d_2)$、有效折射率为 $n_{\\mathrm{eff}}=\\sqrt{\\epsilon_{\\mathrm{eff}}}$ 的单层构成。反射和透射系数（$r_{\\mathrm{eff}}, t_{\\mathrm{eff}}$）使用具有这些参数的单层传输矩阵 $M_{\\mathrm{eff}}$ 计算得出。\n\n**5. 功率、透射率和相位**\n功率反射率 $R$ 是反射功率通量与入射功率通量之比。由于入射波和反射波在同一介质中，因此可以简单地表示为 $R=|r|^2$。\n功率透射率 $T$ 是透射功率通量与入射功率通量之比。这些通量位于不同的介质中（$n_s$ 和 $n_0$），因此必须考虑导纳：\n$$ T = \\frac{\\text{Power transmitted}}{\\text{Power incident}} = \\frac{\\frac{1}{2}\\Re\\{Y_s\\}|t E_i|^2}{\\frac{1}{2}\\Re\\{Y_0\\}|E_i|^2} = \\frac{\\Re\\{Y_s\\}}{\\Re\\{Y_0\\}} |t|^2 $$\n对于给定的无损耗介质，$Y_i=n_i$ 是实数，所以 $T = (n_s/n_0)|t|^2$。\n\n透射相位是复透射系数的辐角，$\\phi_t = \\arg(t)$。\n两个相位 $\\phi_a$ 和 $\\phi_b$ 之间的最小绝对相位差 $|\\Delta\\phi_t|$ 的计算方法是：首先计算差值 $\\Delta\\phi = \\phi_a - \\phi_b$，然后将该差值规整到区间 $(-\\pi, \\pi]$ 内，最后取绝对值。这可以计算为 $|\\text{mod}(\\Delta\\phi+\\pi, 2\\pi) - \\pi|$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational electromagnetics problem for four test cases.\n    It computes reflection and transmission for a multilayer stack using both an\n    exact transfer-matrix model and a homogenized effective medium model, and\n    then compares the results.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Typical case, small period (p=0.05)\n        {\n            \"case_index\": 1, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 12.25, \"f\": 0.4, \"p\": 0.05, \"N\": 20\n        },\n        # Case 2: Marginal case, larger period (p=0.2)\n        {\n            \"case_index\": 2, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 12.25, \"f\": 0.4, \"p\": 0.2, \"N\": 5\n        },\n        # Case 3: Breakdown case, Bragg-like period (p=0.5)\n        {\n            \"case_index\": 3, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 12.25, \"f\": 0.4, \"p\": 0.5, \"N\": 2\n        },\n        # Case 4: Low-contrast case (p=0.2)\n        {\n            \"case_index\": 4, \"lambda0\": 1.55e-6, \"n0\": 1.0, \"ns\": 1.0,\n            \"eps1\": 2.25, \"eps2\": 2.89, \"f\": 0.5, \"p\": 0.2, \"N\": 5\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lambda0 = case[\"lambda0\"]\n        n0 = case[\"n0\"]\n        ns = case[\"ns\"]\n        eps1 = case[\"eps1\"]\n        eps2 = case[\"eps2\"]\n        f = case[\"f\"]\n        p = case[\"p\"]\n        N = case[\"N\"]\n\n        # Derived parameters\n        k0 = 2.0 * np.pi / lambda0\n        n1 = np.sqrt(eps1)\n        n2 = np.sqrt(eps2)\n        d_period = p * lambda0\n        d1 = f * d_period\n        d2 = (1.0 - f) * d_period\n\n        # (i) Exact Transfer-Matrix Model\n        layer_stack_exact = [(n1, d1), (n2, d2)] * N\n        r_exact, t_exact = calculate_rt(layer_stack_exact, n0, ns, k0)\n\n        # (ii) Homogenized Effective Medium Model\n        eps_eff = f * eps1 + (1.0 - f) * eps2\n        n_eff = np.sqrt(eps_eff)\n        L = N * d_period\n        layer_stack_eff = [(n_eff, L)]\n        r_eff, t_eff = calculate_rt(layer_stack_eff, n0, ns, k0)\n\n        # (iii) Quantitative Comparison Metrics\n        # Power reflectance and transmittance\n        R_exact = np.abs(r_exact)**2\n        T_exact = (ns / n0) * np.abs(t_exact)**2\n        R_eff = np.abs(r_eff)**2\n        T_eff = (ns / n0) * np.abs(t_eff)**2\n\n        # Absolute errors\n        abs_R_err = np.abs(R_exact - R_eff)\n        abs_T_err = np.abs(T_exact - T_eff)\n\n        # Transmission phase difference\n        phi_t_exact = np.angle(t_exact)\n        phi_t_eff = np.angle(t_eff)\n        delta_phi_t = phi_t_exact - phi_t_eff\n        # Wrap phase difference to (-pi, pi]\n        abs_delta_phi_t = np.abs(np.mod(delta_phi_t + np.pi, 2 * np.pi) - np.pi)\n\n        # Homogenization validity check\n        is_homogenization_valid = (abs_R_err  0.02) and \\\n                                  (abs_T_err  0.02) and \\\n                                  (abs_delta_phi_t  0.1)\n\n        results.append(\n            f\"[{case['case_index']},{p},{abs_R_err:.6f},\"\n            f\"{abs_T_err:.6f},{abs_delta_phi_t:.6f},{str(is_homogenization_valid).lower()}]\"\n        )\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rt(layer_stack, n0, ns, k0):\n    \"\"\"\n    Calculates complex reflection (r) and transmission (t) coefficients\n    for a given stack of layers using the transfer-matrix method.\n\n    Args:\n        layer_stack (list of tuples): Each tuple is (refractive_index, thickness).\n        n0 (float): Refractive index of the ambient medium.\n        ns (float): Refractive index of the substrate medium.\n        k0 (float): Vacuum wavenumber (2*pi/lambda0).\n\n    Returns:\n        tuple: (r, t) complex coefficients.\n    \"\"\"\n    # Admittances are normalized to the vacuum admittance\n    Y0 = n0\n    Ys = ns\n\n    # Initialize total matrix as identity\n    M_total = np.identity(2, dtype=np.cdouble)\n\n    for n_layer, d_layer in layer_stack:\n        Y_layer = n_layer\n        k_layer = n_layer * k0\n        phi = k_layer * d_layer\n        \n        cos_phi = np.cos(phi)\n        sin_phi = np.sin(phi)\n\n        # Characteristic matrix for a single layer\n        M_layer = np.array([\n            [cos_phi, (1j / Y_layer) * sin_phi],\n            [1j * Y_layer * sin_phi, cos_phi]\n        ], dtype=np.cdouble)\n\n        # Chain matrix multiplication\n        M_total = M_total @ M_layer\n\n    A, B = M_total[0, :]\n    C, D = M_total[1, :]\n\n    # Calculate r and t from total matrix elements and surrounding admittances\n    denominator = (A * Y0 + D * Ys) + B * Y0 * Ys + C\n    \n    r = ((A * Y0 - D * Ys) + B * Y0 * Ys - C) / denominator\n    t = (2 * Y0) / denominator\n    \n    return r, t\n\nsolve()\n```"
        },
        {
            "introduction": "现代计算电磁学的一个前沿方向是模拟新型材料（如二维材料）与电磁波的相互作用。本练习将引导您将基本的反射和透射理论扩展到更复杂的情况：一个带有石墨烯单层的界面。您将学习如何通过引入表面电导率来修正边界条件，并实现基于Kubo公式的石墨烯电导率模型，最终探索如何通过改变化学势来主动调控界面的反射特性，从而将电磁理论与前沿材料物理紧密联系起来。",
            "id": "3345583",
            "problem": "一角频率为 $\\omega$ 的单色平面波，从标记为介质 $1$ 的各向同性、均匀、无源半空间，入射到位于 $z=0$ 的平面界面上。该界面分隔了介质 $1$ 与另一个标记为介质 $2$ 的各向同性、均匀、无源半空间。一层单层石墨烯片精确地位于 $z=0$ 的界面上，并被建模为一个具有复表面电导率 $\\sigma(\\omega)$ 的无限薄片，产生表面电流密度 $\\mathbf{J}_s = \\sigma(\\omega)\\,\\mathbf{E}_t$，其中 $\\mathbf{E}_t$ 是石墨烯片上的切向电场。入射由一个入射面和一个在介质 $1$ 中测量的入射角 $\\theta$（以弧度为单位）来表征。考虑横电（TE）和横磁（TM）两种偏振。两种介质的介电常数分别为 $\\epsilon_1$、$\\epsilon_2$，磁导率分别为 $\\mu_1$、$\\mu_2$。假设除了石墨烯的欧姆表面电流外，没有其他磁性或电性表面极化。\n\n从频域麦克斯韦方程组和导电薄片处的电磁边界条件出发，推导谱域中的复反射系数 $r_{\\mathrm{TE}}$ 和 $r_{\\mathrm{TM}}$，并用横向波数、各介质中的纵向波数、材料参数 $(\\epsilon_1,\\mu_1)$、$(\\epsilon_2,\\mu_2)$、角频率 $\\omega$ 以及表面电导率 $\\sigma(\\omega)$ 来表示。然后，实现一个程序来计算这些系数，方法如下：\n- 为 TE 和 TM 偏振构建连接每种介质中切向电场和磁场的谱域关系，\n- 应用边界条件求解 $r_{\\mathrm{TE}}$ 和 $r_{\\mathrm{TM}}$，\n- 使用一个依赖于角频率 $\\omega$、化学势 $\\mu_c$、唯象散射率 $\\Gamma$ 和温度 $T$ 的有限温度带内类 Drude 的 Kubo 模型计算石墨烯表面电导率 $\\sigma(\\omega)$。\n\n您的程序必须：\n- 以弧度处理角度，\n- 以赫兹（$\\mathrm{Hz}$）处理频率，\n- 内部使用以下物理常数：元电荷 $e$、约化普朗克常数 $\\hbar$、真空介电常数 $\\epsilon_0$、真空磁导率 $\\mu_0$、玻尔兹曼常数 $k_B$ 和光速 $c$，\n- 根据由 $\\theta$ 设置的横向波数以及介质波数 $k_1$ 和 $k_2$ 计算谱域纵向波数 $k_{z,1}$ 和 $k_{z,2}$，\n- 计算每种介质中的 TE 和 TM 波导纳，\n- 构建导电薄片处的反射系数 $r_{\\mathrm{TE}}$ 和 $r_{\\mathrm{TM}}$，\n- 输出功率反射系数 $R_{\\mathrm{TE}} = |r_{\\mathrm{TE}}|^2$ 和 $R_{\\mathrm{TM}} = |r_{\\mathrm{TM}}|^2$，以不带单位的小数形式表示。\n\n使用以下测试套件。每个案例由 $(f,\\theta,\\epsilon_1,\\mu_1,\\epsilon_2,\\mu_2,\\mu_c,\\Gamma,T)$ 指定，其中 $f$ 是频率，$\\theta$ 是入射角，$\\epsilon_1,\\mu_1,\\epsilon_2,\\mu_2$ 是介质参数，$\\mu_c$ 是化学势，$\\Gamma$ 是散射率， $T$ 是温度。化学势以电子伏特为单位指定，在计算中必须转换为焦耳。对于通过相对参数指定的介质，使用 $\\epsilon = \\epsilon_r\\,\\epsilon_0$ 和 $\\mu = \\mu_r\\,\\mu_0$。\n\n- 案例 1：$f = 1.0\\times 10^{12}\\ \\mathrm{Hz}$，$\\theta = 0.0\\ \\mathrm{rad}$，$\\epsilon_1 = \\epsilon_0$，$\\mu_1 = \\mu_0$，$\\epsilon_2 = \\epsilon_0$，$\\mu_2 = \\mu_0$，$\\mu_c = 0.1\\ \\mathrm{eV}$，$\\Gamma = 1.0\\times 10^{13}\\ \\mathrm{s}^{-1}$，$T = 300\\ \\mathrm{K}$。\n- 案例 2：$f = 1.0\\times 10^{12}\\ \\mathrm{Hz}$，$\\theta = 0.0\\ \\mathrm{rad}$，$\\epsilon_1 = \\epsilon_0$，$\\mu_1 = \\mu_0$，$\\epsilon_2 = \\epsilon_0$，$\\mu_2 = \\mu_0$，$\\mu_c = 0.5\\ \\mathrm{eV}$，$\\Gamma = 1.0\\times 10^{13}\\ \\mathrm{s}^{-1}$，$T = 300\\ \\mathrm{K}$。\n- 案例 3：$f = 2.0\\times 10^{12}\\ \\mathrm{Hz}$，$\\theta = 0.6\\ \\mathrm{rad}$，$\\epsilon_1 = \\epsilon_0$，$\\mu_1 = \\mu_0$，$\\epsilon_2 = 4.0\\,\\epsilon_0$，$\\mu_2 = \\mu_0$，$\\mu_c = 0.3\\ \\mathrm{eV}$，$\\Gamma = 5.0\\times 10^{12}\\ \\mathrm{s}^{-1}$，$T = 300\\ \\mathrm{K}$。\n- 案例 4：$f = 3.0\\times 10^{12}\\ \\mathrm{Hz}$，$\\theta = 1.0471975512\\ \\mathrm{rad}$，$\\epsilon_1 = 12.25\\,\\epsilon_0$，$\\mu_1 = \\mu_0$，$\\epsilon_2 = \\epsilon_0$，$\\mu_2 = \\mu_0$，$\\mu_c = 0.2\\ \\mathrm{eV}$，$\\Gamma = 1.0\\times 10^{13}\\ \\mathrm{s}^{-1}$，$T = 300\\ \\mathrm{K}$。\n- 案例 5：$f = 1.0\\times 10^{12}\\ \\mathrm{Hz}$，$\\theta = 1.5533430343\\ \\mathrm{rad}$，$\\epsilon_1 = \\epsilon_0$，$\\mu_1 = \\mu_0$，$\\epsilon_2 = \\epsilon_0$，$\\mu_2 = \\mu_0$，$\\mu_c = 0.3\\ \\mathrm{eV}$，$\\Gamma = 1.0\\times 10^{13}\\ \\mathrm{s}^{-1}$，$T = 300\\ \\mathrm{K}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序为 $[R_{\\mathrm{TE},1},R_{\\mathrm{TM},1},R_{\\mathrm{TE},2},R_{\\mathrm{TM},2},R_{\\mathrm{TE},3},R_{\\mathrm{TM},3},R_{\\mathrm{TE},4},R_{\\mathrm{TM},4},R_{\\mathrm{TE},5},R_{\\mathrm{TM},5}]$，其中下标表示案例索引。所有值都必须是无量纲的小数。",
            "solution": "问题是要求解入射到两种介质平面界面上的单色平面波的功率反射系数，该界面上附有一层单层石墨烯。这是一个经典的电磁边界值问题，可以通过对界面两侧的场应用适当的边界条件来求解。\n\n**1. 理论框架**\n\n我们从时谐麦克斯韦方程组开始，假设时间依赖关系为 $e^{-i\\omega t}$：\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mu\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = -i\\omega\\epsilon\\mathbf{E} $$\n该系统由两个各向同性、均匀且无源的半空间组成。介质 $1$ ($z0$) 的参数为 $(\\epsilon_1, \\mu_1)$，介质 $2$ ($z0$) 的参数为 $(\\epsilon_2, \\mu_2)$。一束平面波从介质 $1$ 入射，与法线（$\\hat{z}$ 轴）成 $\\theta$ 角。入射面为 $xz$ 平面。\n\n界面 $z=0$ 处的石墨烯片被建模为一个二维导电表面，其复表面电导率为 $\\sigma(\\omega)$。该薄片支持表面电流密度 $\\mathbf{J}_s = \\sigma \\mathbf{E}_t$，其中 $\\mathbf{E}_t$ 是界面处电场的切向分量。\n\n$z=0$ 处的边界条件是：\n1. 切向电场连续性：$\\hat{z} \\times (\\mathbf{E}_2 - \\mathbf{E}_1) = 0 \\implies \\mathbf{E}_{t,1} = \\mathbf{E}_{t,2}$。\n2. 由表面电流引起的切向磁场不连续性：$\\hat{z} \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{J}_s = \\sigma \\mathbf{E}_t$。\n\n解决此问题的一个便捷方法是使用传输线理论中的波阻抗/波导纳类比。界面处的反射系数 $r$ 由下式给出：\n$$ r = \\frac{Y_1 - Y_{load}}{Y_1 + Y_{load}} $$\n这里，$Y_1$ 是入射介质的特征波导纳，$Y_{load}$ 是入射波在界面上看到的等效导纳。石墨烯片作为导电层，其作用相当于一个导纳 $\\sigma$ 与传输介质（介质 $2$）的导纳并联。因此，总负载导纳为 $Y_{load} = Y_{2} + \\sigma$，其中 $Y_2$ 是介质 $2$ 的波导纳。\n\n因此，反射系数为：\n$$ r = \\frac{Y_1 - (Y_2 + \\sigma)}{Y_1 + (Y_2 + \\sigma)} = \\frac{Y_1 - Y_2 - \\sigma}{Y_1 + Y_2 + \\sigma} $$\n这个通用公式适用于横电（TE）和横磁（TM）两种偏振，前提是使用正确的波导纳定义。\n\n**2. 波数和导纳**\n\n平面波的相位以 $e^{i(k_x x + k_z z)}$ 的形式变化。边界处的相位匹配要求波矢量的切向分量 $k_x$ 在界面两侧保持不变。\n- 介质 $i$ 中的波数：$k_i = \\omega \\sqrt{\\epsilon_i \\mu_i}$。\n- 切向波数：$k_x = k_1 \\sin\\theta$。\n- 介质 $1$ 中的纵向波数：$k_{z,1} = \\sqrt{k_1^2 - k_x^2} = k_1 \\cos\\theta$。\n- 介质 $2$ 中的纵向波数：$k_{z,2} = \\sqrt{k_2^2 - k_x^2}$。为确保波在 $z0$ 区域中传播或衰减远离界面，我们必须选择使 $\\text{Re}(k_{z,2}) \\ge 0$ 和 $\\text{Im}(k_{z,2}) \\ge 0$ 的根。\n\nTE 和 TM 偏振的波导纳定义如下：\n- **TE 偏振（电场垂直于入射面，$E_y$）：**\n  $$ Y_{\\mathrm{TE},i} = \\frac{k_{z,i}}{\\omega \\mu_i} $$\n- **TM 偏振（磁场垂直于入射面，$H_y$）：**\n  $$ Y_{\\mathrm{TM},i} = \\frac{\\omega \\epsilon_i}{k_{z,i}} $$\n\n**3. 石墨烯表面电导率**\n\n问题指定使用有限温度带内类 Drude 的 Kubo 模型来计算石墨烯表面电导率 $\\sigma(\\omega)$。此模型的一个标准且被广泛接受的公式是：\n$$ \\sigma(\\omega) = \\frac{2ie^2k_B T}{\\pi\\hbar^2(\\omega + i\\Gamma)} \\ln\\left[2\\cosh\\left(\\frac{\\mu_c}{2k_B T}\\right)\\right] $$\n其中：\n- $e$ 是元电荷。\n- $k_B$ 是玻尔兹曼常数。\n- $T$ 是温度，单位为开尔文。\n- $\\hbar$ 是约化普朗克常数。\n- $\\omega = 2\\pi f$ 是角频率。\n- $\\Gamma$ 是唯象散射率。\n- $\\mu_c$ 是化学势。\n\n**4. 最终算法**\n\n计算流程如下：\n1.  对于每个测试案例，获取输入参数：频率 $f$、入射角 $\\theta$、介质属性 $(\\epsilon_1, \\mu_1, \\epsilon_2, \\mu_2)$ 和石墨烯属性 $(\\mu_c, \\Gamma, T)$。\n2.  计算角频率 $\\omega = 2\\pi f$。将化学势从 eV 转换为焦耳：$\\mu_c[\\text{J}] = \\mu_c[\\text{eV}] \\times e$。\n3.  使用 Kubo 公式计算复表面电导率 $\\sigma(\\omega)$。\n4.  计算材料属性 $\\epsilon_i = \\epsilon_{ri}\\epsilon_0$ 和 $\\mu_i = \\mu_{ri}\\mu_0$。\n5.  确定波数：$k_1, k_2, k_x, k_{z,1}, k_{z,2}$。确保为 $k_{z,2}$ 选择正确的分支切割。\n6.  计算波导纳 $Y_{\\mathrm{TE},1}$、$Y_{\\mathrm{TE},2}$、$Y_{\\mathrm{TM},1}$ 和 $Y_{\\mathrm{TM},2}$。\n7.  将这些导纳和 $\\sigma$ 代入通用反射系数公式，求得复系数 $r_{\\mathrm{TE}}$ 和 $r_{\\mathrm{TM}}$：\n    $$ r_{\\mathrm{TE}} = \\frac{Y_{\\mathrm{TE},1} - Y_{\\mathrm{TE},2} - \\sigma}{Y_{\\mathrm{TE},1} + Y_{\\mathrm{TE},2} + \\sigma} $$\n    $$ r_{\\mathrm{TM}} = \\frac{Y_{\\mathrm{TM},1} - Y_{\\mathrm{TM},2} - \\sigma}{Y_{\\mathrm{TM},1} + Y_{\\mathrm{TM},2} + \\sigma} $$\n8.  计算功率反射系数（反射率）为复系数的模平方：\n    $$ R_{\\mathrm{TE}} = |r_{\\mathrm{TE}}|^2 $$\n    $$ R_{\\mathrm{TM}} = |r_{\\mathrm{TM}}|^2 $$\n此过程产生所需的无量纲功率反射系数，适用于两种偏振。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the power reflection coefficients at a graphene-loaded interface.\n    \"\"\"\n    # Physical Constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    HBAR = 1.054571817e-34      # Reduced Planck constant in J*s\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    MU_0 = 4 * np.pi * 1e-7       # Vacuum permeability in H/m\n    K_B = 1.380649e-23           # Boltzmann constant in J/K\n\n    test_cases = [\n        # (f, theta, er1, mr1, er2, mr2, mu_c, Gamma, T)\n        (1.0e12, 0.0, 1.0, 1.0, 1.0, 1.0, 0.1, 1.0e13, 300),\n        (1.0e12, 0.0, 1.0, 1.0, 1.0, 1.0, 0.5, 1.0e13, 300),\n        (2.0e12, 0.6, 1.0, 1.0, 4.0, 1.0, 0.3, 5.0e12, 300),\n        (3.0e12, 1.0471975512, 12.25, 1.0, 1.0, 1.0, 0.2, 1.0e13, 300),\n        (1.0e12, 1.5533430343, 1.0, 1.0, 1.0, 1.0, 0.3, 1.0e13, 300),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        f, theta, er1, mr1, er2, mr2, mu_c_eV, Gamma, T = case\n\n        # 1. Calculate problem-specific parameters\n        omega = 2 * np.pi * f\n        mu_c_J = mu_c_eV * E_CHARGE\n        \n        # 2. Compute Graphene Conductivity (Kubo Model)\n        # sigma = (2ie^2 k_B T / (pi hbar^2 (omega + i*Gamma))) * ln(2cosh(mu_c / (2 k_B T)))\n        # Note: In Python, 1j is the imaginary unit.\n        conductivity_prefactor = (2 * 1j * E_CHARGE**2 * K_B * T) / (np.pi * HBAR**2 * (omega + 1j * Gamma))\n        log_term = np.log(2 * np.cosh(mu_c_J / (2 * K_B * T)))\n        sigma = conductivity_prefactor * log_term\n\n        # 3. Material and Wave parameters\n        e1 = er1 * EPSILON_0\n        m1 = mr1 * MU_0\n        e2 = er2 * EPSILON_0\n        m2 = mr2 * MU_0\n        \n        # Wavenumbers\n        k1 = omega * np.sqrt(e1 * m1)\n        k2 = omega * np.sqrt(e2 * m2)\n        \n        k_x = k1 * np.sin(theta)\n        \n        # Handle k_z1 for theta=pi/2 case to avoid floating point issues if cos(pi/2) is not exactly 0\n        if np.isclose(theta, np.pi/2):\n            k_z1 = 0.0\n        else:\n            k_z1 = k1 * np.cos(theta)\n        \n        # Use complex arithmetic for k_z2 to handle Total Internal Reflection correctly.\n        # The numpy.sqrt of a complex number correctly chooses the principal root (Re>=0),\n        # which corresponds to decay or propagation in +z for e^(i*k_z*z) wave form.\n        k_z2_sq = k2**2 - k_x**2\n        k_z2 = np.sqrt(k_z2_sq + 0j)\n        \n        # 4. Calculate Wave Admittances\n        # TE polarization\n        if np.isclose(omega * m1, 0) or np.isclose(omega * m2, 0): # Should not happen\n            raise ValueError(\"omega * mu is zero.\")\n        Y_TE1 = k_z1 / (omega * m1)\n        Y_TE2 = k_z2 / (omega * m2)\n\n        # TM polarization\n        # Handle grazing incidence for TM, where k_z1 -> 0 and Y_TM1 -> infinity\n        if np.isclose(k_z1, 0):\n            # At perfect grazing incidence, Y_TM1 is infinite. r_TM -> 1.\n            r_TM = 1.0 + 0j\n        else:\n            Y_TM1 = (omega * e1) / k_z1\n            # Check for k_z2 = 0 which makes Y_TM2 infinite.\n            # This happens at the critical angle for medium 2, not a typical scenario to guard.\n            if np.isclose(k_z2, 0):\n                # If Y_TM2 is infinite R_TM will be 1\n                 r_TM = -1.0 + 0j\n            else:\n                 Y_TM2 = (omega * e2) / k_z2\n                 # 5. Calculate Reflection Coefficients for TM\n                 r_TM_num = Y_TM1 - Y_TM2 - sigma\n                 r_TM_den = Y_TM1 + Y_TM2 + sigma\n                 r_TM = r_TM_num / r_TM_den\n\n        # 5. Calculate Reflection Coefficients for TE\n        r_TE_num = Y_TE1 - Y_TE2 - sigma\n        r_TE_den = Y_TE1 + Y_TE2 + sigma\n        if np.isclose(r_TE_den, 0):\n            # This can happen if a surface plasmon is excited. Assign a large reflection.\n            r_TE = 1e6 + 0j # Should be handled based on context, but for power it's large.\n        else:\n            r_TE = r_TE_num / r_TE_den\n\n\n        # 6. Calculate Power Reflection Coefficients\n        R_TE = np.abs(r_TE)**2\n        R_TM = np.abs(r_TM)**2\n        \n        results.extend([R_TE, R_TM])\n\n    # Format output\n    output_str = \",\".join([f\"{res:.8f}\" for res in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n\n```"
        }
    ]
}