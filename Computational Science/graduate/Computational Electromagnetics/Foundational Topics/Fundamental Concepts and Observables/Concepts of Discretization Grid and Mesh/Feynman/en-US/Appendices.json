{
    "hands_on_practices": [
        {
            "introduction": "The Finite Element Method (FEM) builds solutions to complex problems by breaking them down into a mesh of simpler geometric elements. This practice takes you to the very heart of vector FEM for electromagnetics: the assembly of an element stiffness matrix. You will work with first-order Nedelec edge basis functions on a single tetrahedron, deriving a key component of the discrete system that emerges from the weak formulation of Maxwell's equations . By grounding these advanced concepts in a concrete calculation involving barycentric coordinates, this exercise demystifies the construction of the matrices used in large-scale FEM simulations.",
            "id": "3294432",
            "problem": "Consider the curl-curl bilinear form arising in the weak formulation of the time-harmonic Maxwell equations in a simply connected domain, which at the element level yields the element stiffness matrix with entries $a_{ij,kl} = \\int_{K} (\\nabla \\times \\mathbf{w}_{ij}) \\cdot (\\nabla \\times \\mathbf{w}_{kl}) \\, dV$, where $\\{\\mathbf{w}_{ij}\\}$ are the first-order Nedelec (first kind) edge basis functions on a tetrahedral element $K$. Let $K$ be the tetrahedron with vertices $\\mathbf{v}_1 = (0,0,0)$, $\\mathbf{v}_2 = (1,0,0)$, $\\mathbf{v}_3 = (0,1,0)$, and $\\mathbf{v}_4 = (0,0,1)$. Use the standard first-order Nedelec basis on $K$ associated with the oriented edges $(1,2)$, $(1,3)$, $(1,4)$, $(2,3)$, $(2,4)$, and $(3,4)$, where each basis function associated with edge $(i,j)$ is defined by $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$ in terms of the barycentric coordinates $\\{\\lambda_i\\}_{i=1}^{4}$ of $K$.\n\nStarting from the definitions of barycentric coordinates on $K$, the edge basis definition above, and vector calculus identities, derive the exact expression for the element stiffness entries. Then, using exact quadrature, compute the exact value of the trace of the resulting $6 \\times 6$ element stiffness matrix\n$$\n\\mathrm{tr}(\\mathbf{K}) = \\sum_{\\text{edges }(i,j)} \\int_{K} \\left|\\nabla \\times \\mathbf{w}_{ij}\\right|^{2} \\, dV,\n$$\nwhere the sum is over the six oriented edges listed above. Provide your final answer as a single real number. Express the final answer as a dimensionless quantity. No rounding is required.",
            "solution": "The problem asks for the computation of the trace of the element stiffness matrix $\\mathbf{K}$ for a specific tetrahedral element $K$ using first-order Nedelec edge basis functions. The trace is given by the sum of the diagonal entries of the stiffness matrix:\n$$\n\\mathrm{tr}(\\mathbf{K}) = \\sum_{\\text{edges }(i,j)} \\int_{K} \\left|\\nabla \\times \\mathbf{w}_{ij}\\right|^{2} \\, dV\n$$\nwhere the sum is over the six oriented edges of the tetrahedron. The basis function for an edge connecting vertices $\\mathbf{v}_i$ and $\\mathbf{v}_j$ is defined as $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$, where $\\lambda_k$ are the barycentric coordinates.\n\nOur procedure will be as follows:\n1.  Define the barycentric coordinates for the specified tetrahedron and compute their gradients.\n2.  Derive a simplified expression for the curl of the basis functions, $\\nabla \\times \\mathbf{w}_{ij}$.\n3.  Use this expression to find the integrand $|\\nabla \\times \\mathbf{w}_{ij}|^2$.\n4.  Compute the volume of the tetrahedron to evaluate the integral.\n5.  Calculate the integral for each of the six edges and sum the results to obtain the trace.\n\n_Step 1: Barycentric Coordinates and Their Gradients_\n\nThe tetrahedron $K$ has vertices $\\mathbf{v}_1 = (0,0,0)$, $\\mathbf{v}_2 = (1,0,0)$, $\\mathbf{v}_3 = (0,1,0)$, and $\\mathbf{v}_4 = (0,0,1)$. Any point $\\mathbf{x} = (x,y,z)$ inside $K$ can be expressed as a linear combination of the vertices:\n$$\n\\mathbf{x} = \\sum_{k=1}^{4} \\lambda_k(\\mathbf{x}) \\mathbf{v}_k\n$$\nwith the constraints $\\sum_{k=1}^{4} \\lambda_k = 1$ and $\\lambda_k \\ge 0$.\nSubstituting the vertex coordinates, we have:\n$$\n(x,y,z) = \\lambda_1(0,0,0) + \\lambda_2(1,0,0) + \\lambda_3(0,1,0) + \\lambda_4(0,0,1) = (\\lambda_2, \\lambda_3, \\lambda_4)\n$$\nThis directly gives us $\\lambda_2 = x$, $\\lambda_3 = y$, and $\\lambda_4 = z$. From the sum constraint, we find $\\lambda_1$:\n$$\n\\lambda_1 = 1 - \\lambda_2 - \\lambda_3 - \\lambda_4 = 1 - x - y - z\n$$\nThe barycentric coordinates are linear functions of the Cartesian coordinates $(x,y,z)$. Their gradients are constant vectors:\n$$\n\\nabla \\lambda_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla \\lambda_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\lambda_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\lambda_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n\n_Step 2: Curl of the Basis Functions_\n\nWe compute the curl of the basis function $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$. We use the vector calculus identity $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + \\nabla f \\times \\mathbf{A}$. Since the gradients $\\nabla \\lambda_k$ are constant vectors, their curl is zero: $\\nabla \\times (\\nabla \\lambda_k) = \\mathbf{0}$.\nApplying this to the two terms in $\\mathbf{w}_{ij}$:\n$$\n\\nabla \\times (\\lambda_i \\nabla \\lambda_j) = \\lambda_i (\\nabla \\times \\nabla \\lambda_j) + \\nabla \\lambda_i \\times \\nabla \\lambda_j = \\mathbf{0} + \\nabla \\lambda_i \\times \\nabla \\lambda_j = \\nabla \\lambda_i \\times \\nabla \\lambda_j\n$$\n$$\n\\nabla \\times (\\lambda_j \\nabla \\lambda_i) = \\lambda_j (\\nabla \\times \\nabla \\lambda_i) + \\nabla \\lambda_j \\times \\nabla \\lambda_i = \\mathbf{0} + \\nabla \\lambda_j \\times \\nabla \\lambda_i = \\nabla \\lambda_j \\times \\nabla \\lambda_i\n$$\nTherefore, the curl of $\\mathbf{w}_{ij}$ is:\n$$\n\\nabla \\times \\mathbf{w}_{ij} = \\nabla \\times (\\lambda_i \\nabla \\lambda_j) - \\nabla \\times (\\lambda_j \\nabla \\lambda_i) = (\\nabla \\lambda_i \\times \\nabla \\lambda_j) - (\\nabla \\lambda_j \\times \\nabla \\lambda_i)\n$$\nUsing the anti-commutative property of the cross product, $\\mathbf{A} \\times \\mathbf{B} = -\\mathbf{B} \\times \\mathbf{A}$, we get:\n$$\n\\nabla \\times \\mathbf{w}_{ij} = (\\nabla \\lambda_i \\times \\nabla \\lambda_j) + (\\nabla \\lambda_i \\times \\nabla \\lambda_j) = 2(\\nabla \\lambda_i \\times \\nabla \\lambda_j)\n$$\nSince $\\nabla \\lambda_i$ and $\\nabla \\lambda_j$ are constant vectors, their cross product is also a constant vector.\n\n_Step 3: Calculating the Integrand_\n\nThe integrand in the trace calculation is the squared magnitude of this curl:\n$$\n|\\nabla \\times \\mathbf{w}_{ij}|^2 = |2(\\nabla \\lambda_i \\times \\nabla \\lambda_j)|^2 = 4|\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2\n$$\nThis is a constant value for each edge $(i,j)$.\n\n_Step 4: Integral Evaluation_\n\nThe integral of a constant over the volume of the tetrahedron $K$ is simply the constant multiplied by the volume $|K|$:\n$$\n\\int_K |\\nabla \\times \\mathbf{w}_{ij}|^2 \\, dV = 4|\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2 \\int_K dV = 4|K||\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2\n$$\nThe volume of a tetrahedron with one vertex at the origin and others at $\\mathbf{a}, \\mathbf{b}, \\mathbf{c}$ is $|K| = \\frac{1}{6}|\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c})|$. For our tetrahedron, the vectors from vertex $\\mathbf{v}_1$ are $\\mathbf{v}_2-\\mathbf{v}_1 = (1,0,0)$, $\\mathbf{v}_3-\\mathbf{v}_1 = (0,1,0)$, and $\\mathbf{v}_4-\\mathbf{v}_1 = (0,0,1)$.\n$$\n|K| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right| = \\frac{1}{6}\n$$\n\n_Step 5: Summation of Diagonal Terms_\n\nWe now compute $|\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2$ for each of the six edges specified: $(1,2)$, $(1,3)$, $(1,4)$, $(2,3)$, $(2,4)$, and $(3,4)$.\n\nFor edge $(1,2)$:\n$\\nabla \\lambda_1 \\times \\nabla \\lambda_2 = (-1,-1,-1) \\times (1,0,0) = (0,-1,1)$.\n$|\\nabla \\lambda_1 \\times \\nabla \\lambda_2|^2 = 0^2 + (-1)^2 + 1^2 = 2$.\n\nFor edge $(1,3)$:\n$\\nabla \\lambda_1 \\times \\nabla \\lambda_3 = (-1,-1,-1) \\times (0,1,0) = (1,0,-1)$.\n$|\\nabla \\lambda_1 \\times \\nabla \\lambda_3|^2 = 1^2 + 0^2 + (-1)^2 = 2$.\n\nFor edge $(1,4)$:\n$\\nabla \\lambda_1 \\times \\nabla \\lambda_4 = (-1,-1,-1) \\times (0,0,1) = (-1,1,0)$.\n$|\\nabla \\lambda_1 \\times \\nabla \\lambda_4|^2 = (-1)^2 + 1^2 + 0^2 = 2$.\n\nFor edge $(2,3)$:\n$\\nabla \\lambda_2 \\times \\nabla \\lambda_3 = (1,0,0) \\times (0,1,0) = (0,0,1)$.\n$|\\nabla \\lambda_2 \\times \\nabla \\lambda_3|^2 = 0^2 + 0^2 + 1^2 = 1$.\n\nFor edge $(2,4)$:\n$\\nabla \\lambda_2 \\times \\nabla \\lambda_4 = (1,0,0) \\times (0,0,1) = (0,-1,0)$.\n$|\\nabla \\lambda_2 \\times \\nabla \\lambda_4|^2 = 0^2 + (-1)^2 + 0^2 = 1$.\n\nFor edge $(3,4)$:\n$\\nabla \\lambda_3 \\times \\nabla \\lambda_4 = (0,1,0) \\times (0,0,1) = (1,0,0)$.\n$|\\nabla \\lambda_3 \\times \\nabla \\lambda_4|^2 = 1^2 + 0^2 + 0^2 = 1$.\n\nThe trace is the sum of the diagonal entries $K_{ij,ij} = \\int_{K} |\\nabla \\times \\mathbf{w}_{ij}|^2 \\, dV$:\n$$\n\\mathrm{tr}(\\mathbf{K}) = \\sum_{(i,j)} 4|K||\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2 = 4|K| \\sum_{(i,j)} |\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2\n$$\nSubstituting the computed values:\n$$\n\\sum_{(i,j)} |\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2 = 2 + 2 + 2 + 1 + 1 + 1 = 9\n$$\nNow, we calculate the trace using $|K| = 1/6$:\n$$\n\\mathrm{tr}(\\mathbf{K}) = 4 \\left(\\frac{1}{6}\\right) (9) = \\frac{36}{6} = 6\n$$\nThe trace of the element stiffness matrix is exactly $6$.",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "In contrast to the implicit, space-centric nature of FEM, the Finite-Difference Time-Domain (FDTD) method marches fields forward in time on a staggered grid. A critical constraint in any explicit time-stepping scheme is numerical stability; without it, the simulation will produce non-physical, exponentially growing results. This exercise guides you through the classic von Neumann stability analysis to derive the famous Courant-Friedrichs-Lewy (CFL) condition for the 3D Yee FDTD scheme . This fundamental derivation reveals the deep connection between the grid spacings ($\\Delta x$, $\\Delta y$, $\\Delta z$), the time step $\\Delta t$, and the physical speed of light, ensuring that the numerical domain of dependence contains the physical one.",
            "id": "3294391",
            "problem": "Consider electromagnetic wave propagation in vacuum governed by Maxwell’s equations,\n$$\n\\frac{\\partial \\mathbf{E}}{\\partial t}=\\frac{1}{\\varepsilon_{0}}\\nabla\\times\\mathbf{H},\\qquad \\frac{\\partial \\mathbf{H}}{\\partial t}=-\\frac{1}{\\mu_{0}}\\nabla\\times\\mathbf{E},\n$$\nwith the speed of light given by $c=\\frac{1}{\\sqrt{\\varepsilon_{0}\\mu_{0}}}$. Discretize these equations using the standard three-dimensional staggered grid of the Yee finite-difference time-domain (FDTD) method on a rectilinear mesh with uniform spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, and leapfrog time stepping with time step $\\Delta t$. Assume an unbounded periodic lattice so that a von Neumann plane-wave analysis is applicable.\n\nStarting from first principles and the definition of the Yee staggered grid and central-difference discretization of the curl operators, perform a von Neumann (Fourier) stability analysis of the discrete update equations. Require that the amplification factor be of unit magnitude for all spatial wavenumbers that can be represented on the mesh, and deduce the Courant-Friedrichs-Lewy (CFL) stability condition that constrains $\\Delta t$ in terms of $c$, $\\Delta x$, $\\Delta y$, and $\\Delta z$.\n\nExpress your final result as a single closed-form analytic expression for the maximum allowable time step $\\Delta t_{\\text{max}}$ as a function of $c$, $\\Delta x$, $\\Delta y$, and $\\Delta z$. State $\\Delta t_{\\text{max}}$ in seconds. No rounding is required.",
            "solution": "The starting point is Maxwell’s curl equations in vacuum,\n$$\n\\frac{\\partial \\mathbf{E}}{\\partial t}=\\frac{1}{\\varepsilon_{0}}\\nabla\\times\\mathbf{H},\\qquad \\frac{\\partial \\mathbf{H}}{\\partial t}=-\\frac{1}{\\mu_{0}}\\nabla\\times\\mathbf{E},\n$$\nwith $c=\\frac{1}{\\sqrt{\\varepsilon_{0}\\mu_{0}}}$. The Yee finite-difference time-domain (FDTD) method places components of $\\mathbf{E}$ and $\\mathbf{H}$ on a staggered rectangular grid: for example, $E_{x}$ at $(i+\\tfrac{1}{2},j,k)$, $E_{y}$ at $(i,j+\\tfrac{1}{2},k)$, $E_{z}$ at $(i,j,k+\\tfrac{1}{2})$, and similarly for $\\mathbf{H}$, while time is staggered so that $\\mathbf{E}$ is known at integer time indices $n\\Delta t$ and $\\mathbf{H}$ at half-integer time indices $(n+\\tfrac{1}{2})\\Delta t$. The semi-discrete (in space and time) Yee update reads componentwise, e.g.,\n$$\nH_{x}^{n+\\tfrac{1}{2}}=H_{x}^{n-\\tfrac{1}{2}}-\\frac{\\Delta t}{\\mu_{0}}\\left(\\frac{E_{z}^{n}(i,j+1,k)-E_{z}^{n}(i,j,k)}{\\Delta y}-\\frac{E_{y}^{n}(i,j,k+1)-E_{y}^{n}(i,j,k)}{\\Delta z}\\right),\n$$\n$$\nE_{x}^{n+1}=E_{x}^{n}+\\frac{\\Delta t}{\\varepsilon_{0}}\\left(\\frac{H_{z}^{n+\\tfrac{1}{2}}(i,j,k)-H_{z}^{n+\\tfrac{1}{2}}(i,j-1,k)}{\\Delta y}-\\frac{H_{y}^{n+\\tfrac{1}{2}}(i,j,k)-H_{y}^{n+\\tfrac{1}{2}}(i,j,k-1)}{\\Delta z}\\right),\n$$\nand cyclic permutations for $x,y,z$. These are central differences in space consistent with the staggered placement.\n\nTo analyze stability via von Neumann (Fourier) analysis, suppose solutions are discrete plane waves. For each component, adopt the ansatz\n$$\nE_{m}^{n}(\\mathbf{r}_{E_{m}})=\\widehat{E}_{m}\\,g^{n}\\exp\\!\\big(i(k_{x}i\\Delta x+k_{y}j\\Delta y+k_{z}k\\Delta z)\\big)\\,\\exp\\!\\big(i\\phi_{E_{m}}\\big),\n$$\n$$\nH_{m}^{n+\\tfrac{1}{2}}(\\mathbf{r}_{H_{m}})=\\widehat{H}_{m}\\,g^{n+\\tfrac{1}{2}}\\exp\\!\\big(i(k_{x}i\\Delta x+k_{y}j\\Delta y+k_{z}k\\Delta z)\\big)\\,\\exp\\!\\big(i\\phi_{H_{m}}\\big),\n$$\nwhere $m\\in\\{x,y,z\\}$, $g$ is the amplification factor per full time step, and $\\phi_{E_{m}}$, $\\phi_{H_{m}}$ account for half-cell spatial staggering: for example, for $E_{x}$ at $(i+\\tfrac{1}{2},j,k)$, $\\phi_{E_{x}}=\\tfrac{1}{2}k_{x}\\Delta x$, for $E_{y}$ at $(i,j+\\tfrac{1}{2},k)$, $\\phi_{E_{y}}=\\tfrac{1}{2}k_{y}\\Delta y$, etc., and similarly for $\\mathbf{H}$.\n\nApplying the discrete differences to these plane waves produces trigonometric factors. For instance,\n$$\n\\frac{E_{z}(i,j+1,k)-E_{z}(i,j,k)}{\\Delta y}=\\frac{\\exp\\!\\big(i k_{y}\\Delta y\\big)-1}{\\Delta y}\\,E_{z}(i,j,k)=\\frac{2i}{\\Delta y}\\sin\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right)\\exp\\!\\left(i\\frac{k_{y}\\Delta y}{2}\\right)E_{z}(i,j,k),\n$$\nand similarly along $x$ and $z$. The common magnitude of the discrete derivative symbols in each direction is\n$$\nS_{x}=\\frac{1}{\\Delta x}\\sin\\!\\left(\\frac{k_{x}\\Delta x}{2}\\right),\\quad S_{y}=\\frac{1}{\\Delta y}\\sin\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right),\\quad S_{z}=\\frac{1}{\\Delta z}\\sin\\!\\left(\\frac{k_{z}\\Delta z}{2}\\right).\n$$\nBecause of the consistent staggering of Yee’s grid, the phase factors associated with $\\exp(i\\phi)$ cancel appropriately in the discrete curl composition, yielding a closed system for $(\\widehat{\\mathbf{E}},\\widehat{\\mathbf{H}})$ with $g$ as the eigenvalue parameter.\n\nA standard elimination proceeds by forming a second-order difference equation for $\\mathbf{E}^{n}$. Subtracting the $E$-update at time $n$ from that at time $n+1$ and inserting the $H$-update difference gives\n$$\n\\mathbf{E}^{n+1}-2\\mathbf{E}^{n}+\\mathbf{E}^{n-1}=\\frac{\\Delta t}{\\varepsilon_{0}}\\nabla_{d}\\times\\left(\\mathbf{H}^{n+\\tfrac{1}{2}}-\\mathbf{H}^{n-\\tfrac{1}{2}}\\right)=-\\frac{\\Delta t^{2}}{\\varepsilon_{0}\\mu_{0}}\\nabla_{d}\\times\\left(\\nabla_{d}\\times\\mathbf{E}^{n}\\right),\n$$\nwhere $\\nabla_{d}\\times$ denotes the discrete curl operator. On a plane wave that is discretely divergence-free, the discrete curl-curl operator acts diagonally on the polarization and yields\n$$\n\\nabla_{d}\\times\\left(\\nabla_{d}\\times\\mathbf{E}^{n}\\right)=4\\left(S_{x}^{2}+S_{y}^{2}+S_{z}^{2}\\right)\\mathbf{E}^{n}.\n$$\nThus the scalar amplification relation for each component reduces to\n$$\n\\mathbf{E}^{n+1}-2\\mathbf{E}^{n}+\\mathbf{E}^{n-1}=-c^{2}\\Delta t^{2}\\cdot 4\\left(S_{x}^{2}+S_{y}^{2}+S_{z}^{2}\\right)\\mathbf{E}^{n}.\n$$\nLet $g$ be the amplification factor such that $\\mathbf{E}^{n+1}=g\\,\\mathbf{E}^{n}$ and $\\mathbf{E}^{n-1}=g^{-1}\\mathbf{E}^{n}$. The left-hand side becomes $(g-2+g^{-1})\\mathbf{E}^{n}$. Writing $g=\\exp(i\\omega\\Delta t)$, we have $g+g^{-1}=2\\cos(\\omega\\Delta t)$ and\n$$\ng-2+g^{-1}=-4\\sin^{2}\\!\\left(\\frac{\\omega\\Delta t}{2}\\right).\n$$\nTherefore the discrete dispersion relation is\n$$\n\\sin^{2}\\!\\left(\\frac{\\omega\\Delta t}{2}\\right)=c^{2}\\Delta t^{2}\\left(S_{x}^{2}+S_{y}^{2}+S_{z}^{2}\\right)=c^{2}\\Delta t^{2}\\left[\\frac{\\sin^{2}\\!\\left(\\frac{k_{x}\\Delta x}{2}\\right)}{(\\Delta x)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right)}{(\\Delta y)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{z}\\Delta z}{2}\\right)}{(\\Delta z)^{2}}\\right].\n$$\nFor stability, the amplification factor must have unit magnitude, which corresponds to a real $\\omega$ for all resolvable wavenumbers $(k_{x},k_{y},k_{z})$. Since the left-hand side satisfies $0\\leq \\sin^{2}(\\cdot)\\leq 1$, we require that for all $(k_{x},k_{y},k_{z})$ in the first Brillouin zone,\n$$\nc^{2}\\Delta t^{2}\\left[\\frac{\\sin^{2}\\!\\left(\\frac{k_{x}\\Delta x}{2}\\right)}{(\\Delta x)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right)}{(\\Delta y)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{z}\\Delta z}{2}\\right)}{(\\Delta z)^{2}}\\right]\\leq 1.\n$$\nThe right-hand side is maximized when each $\\sin^{2}\\!\\left(\\frac{k_{m}\\Delta m}{2}\\right)=1$, i.e., at the Nyquist edge $k_{m}\\Delta m=\\pi$. Hence the strongest stability restriction is\n$$\nc^{2}\\Delta t^{2}\\left[\\frac{1}{(\\Delta x)^{2}}+\\frac{1}{(\\Delta y)^{2}}+\\frac{1}{(\\Delta z)^{2}}\\right]\\leq 1,\n$$\nwhich yields the Courant-Friedrichs-Lewy time step bound\n$$\n\\Delta t_{\\text{max}}=\\frac{1}{c}\\left[\\frac{1}{(\\Delta x)^{2}}+\\frac{1}{(\\Delta y)^{2}}+\\frac{1}{(\\Delta z)^{2}}\\right]^{-\\frac{1}{2}}.\n$$\nThis expression gives the maximum allowable time step in seconds when $c$ is expressed in meters per second and $\\Delta x$, $\\Delta y$, $\\Delta z$ in meters.",
            "answer": "$$\\boxed{\\frac{1}{c}\\left(\\frac{1}{(\\Delta x)^{2}}+\\frac{1}{(\\Delta y)^{2}}+\\frac{1}{(\\Delta z)^{2}}\\right)^{-\\frac{1}{2}}}$$"
        },
        {
            "introduction": "A high-quality discretization does more than just approximate a solution; it should, as closely as possible, replicate the fundamental laws and structures of the underlying physics. This practice explores this core idea of \"mimetic\" or \"structure-preserving\" methods by focusing on the law of charge conservation. You will construct a numerical experiment to demonstrate a crucial concept from Discrete Exterior Calculus (DEC): for charge to be exactly conserved, the discrete operators and any projections must satisfy a \"commuting diagram\" property . By observing how a non-commuting projection leads to a numerical violation of the continuity equation, you will gain a practical appreciation for why the algebraic structure of discretization schemes is as important as their approximation accuracy.",
            "id": "3294451",
            "problem": "Let a two-dimensional time-domain simulation of electromagnetics be formulated on an unstructured triangular mesh using the framework of Discrete Exterior Calculus (DEC). The fundamental base is the continuity equation, which is the local statement of charge conservation: $ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0 $, where $ \\rho $ is charge density and $ \\mathbf{J} $ is current density. In a discrete setting on a simplicial complex, represent nodal charges as discrete $0$-forms and edge currents as discrete $1$-forms. Let $ D \\in \\mathbb{R}^{N_0 \\times N_1} $ denote the node-edge incidence matrix (the discrete divergence operator mapping edge quantities to nodal quantities). A forward-Euler time update that exactly preserves the discrete continuity equation is $ \\rho^{n+1} = \\rho^{n} - \\Delta t \\, D \\, J^{n} $, provided no further transformations are applied.\n\nIn many algorithms, projections between incompatible function spaces are introduced. Let $ P_1 \\in \\mathbb{R}^{N_1 \\times N_1} $ be a projection applied to edge currents (for example, an $L^2$ projection onto a reduced subspace) and let $ P_0 \\in \\mathbb{R}^{N_0 \\times N_0} $ be a projection applied to nodal charges. A sufficient condition for exact discrete charge conservation under such projections is that the diagram commutes, namely $ D \\, P_1 = P_0 \\, D $. If $ D \\, P_1 \\neq P_0 \\, D $, the discrete continuity can be violated.\n\nConstruct a concrete counterexample on a minimal unstructured mesh. Consider three vertices at coordinates $ (0,0) $, $ (1,0) $, and $ (0.2,0.9) $, forming a single triangle. Orient the edges as $ e_0 : (0,0) \\to (1,0) $, $ e_1 : (1,0) \\to (0.2,0.9) $, and $ e_2 : (0.2,0.9) \\to (0,0) $. The corresponding node-edge incidence matrix $ D \\in \\mathbb{R}^{3 \\times 3} $ is defined by $ D_{i,j} = -1 $ if node $ i $ is the source of edge $ j $, $ D_{i,j} = +1 $ if node $ i $ is the target of edge $ j $, and $ D_{i,j} = 0 $ otherwise. Define a diagonal edge mass matrix $ M_e \\in \\mathbb{R}^{3 \\times 3} $ with entries equal to edge lengths, i.e., $ M_e = \\mathrm{diag}(\\ell_0, \\ell_1, \\ell_2) $, where $ \\ell_0 $, $ \\ell_1 $, and $ \\ell_2 $ are the Euclidean lengths of edges $ e_0 $, $ e_1 $, and $ e_2 $, respectively. Define a weighted $L^2$ projection onto an edge subspace spanned by columns of $ S \\in \\mathbb{R}^{3 \\times k} $ by\n$$\nP_1 = S \\left( S^\\top M_e \\, S \\right)^{-1} S^\\top M_e,\n$$\nand take $ P_0 = I $ (the identity on nodal charges) unless otherwise specified. A single-step projected update then reads $ \\rho^{n+1} = P_0 \\left( \\rho^{n} - \\Delta t \\, D \\, P_1 \\, J^{n} \\right) $. The discrete continuity residual for one step is\n$$\nr = \\rho^{n+1} - \\rho^{n} + \\Delta t \\, D \\, J^{n} = \\Delta t \\left( D \\, J^{n} - P_0 \\, D \\, P_1 \\, J^{n} \\right),\n$$\nwhich vanishes for all $ J^{n} $ if and only if $ D \\, P_1 = P_0 \\, D $. A nonzero residual demonstrates loss of exact charge conservation.\n\nImplement a program that computes the Euclidean norm $ \\| r \\|_2 $ of the residual for the following test suite. In all cases, the mesh and orientation are as described above. For projections, use the weighted definition with $ M_e $ derived from edge lengths. Unless otherwise stated, use $ P_0 = I $.\n\nTest suite:\n- Case $1$ (counterexample on unstructured mesh): $ S = [1, 0, 0]^\\top $, $ \\Delta t = 0.5 $, and $ J^{n} = [0, 1, 0]^\\top $.\n- Case $2$ (commuting via identity): $ P_1 = I $, $ \\Delta t = 1.0 $, and $ J^{n} = [0.3, -0.3, 0.0]^\\top $.\n- Case $3$ (current in the projected subspace): $ S = [1, 0, 0]^\\top $, $ \\Delta t = 0.75 $, and $ J^{n} = [2.0, 0.0, 0.0]^\\top $.\n- Case $4$ (zero current): $ S = [1, 0, 0]^\\top $, $ \\Delta t = 2.0 $, and $ J^{n} = [0.0, 0.0, 0.0]^\\top $.\n- Case $5$ (nontrivial mixture on non-commuting projection): $ S = [1, 0, 0]^\\top $, $ \\Delta t = 1.25 $, and $ J^{n} = [1.0, 1.0, -2.0]^\\top $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $ r_i $ is the floating-point value of $ \\| r \\|_2 $ for the corresponding case. No physical units are required; report raw dimensionless values.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of discrete exterior calculus applied to electromagnetics, well-posed with all necessary information provided, and objective in its formulation. The task is to compute a numerical measure of the violation of discrete charge conservation for different scenarios on a specified triangular mesh.\n\nThe core of the problem lies in the discrete continuity equation and how it is affected by projection operators. The discrete continuity equation is given by $\\frac{\\partial \\rho}{\\partial t} + D J = 0$, where $\\rho$ is a vector of nodal charges ($0$-form), $J$ is a vector of edge currents ($1$-form), and $D$ is the node-edge incidence matrix representing the discrete divergence operator. A forward Euler time update is $\\rho^{n+1} = \\rho^n - \\Delta t D J^n$.\n\nWhen projections $P_0$ (on nodes) and $P_1$ (on edges) are introduced, the update rule becomes $\\rho^{n+1} = P_0 ( \\rho^n - \\Delta t D P_1 J^n )$. The residual, which quantifies the charge conservation error in a single step, is $r = \\rho^{n+1} - \\rho^n + \\Delta t D J^n$. For this problem, we are given $P_0 = I$ (the identity matrix), so the update simplifies to $\\rho^{n+1} = \\rho^n - \\Delta t D P_1 J^n$. The residual is then $r = (\\rho^n - \\Delta t D P_1 J^n) - \\rho^n + \\Delta t D J^n = \\Delta t (D J^n - D P_1 J^n)$. The problem requires computing the Euclidean norm $\\|r\\|_2$ for several test cases.\n\nFirst, we establish the geometric and algebraic setup for the single triangular element.\n\nThe three vertices are at coordinates $v_0 = (0,0)$, $v_1 = (1,0)$, and $v_2 = (0.2, 0.9)$. The edges are oriented as $e_0: v_0 \\to v_1$, $e_1: v_1 \\to v_2$, and $e_2: v_2 \\to v_0$.\n\nThe node-edge incidence matrix $D \\in \\mathbb{R}^{3 \\times 3}$ is constructed based on these orientations. The rows correspond to nodes $(v_0, v_1, v_2)$ and columns to edges $(e_0, e_1, e_2)$.\n$D_{i,j} = -1$ if node $i$ is the source of edge $j$, $D_{i,j} = +1$ if node $i$ is the target, and $0$ otherwise.\nFor $e_0 (v_0 \\to v_1)$: column $0$ is $[-1, 1, 0]^\\top$.\nFor $e_1 (v_1 \\to v_2)$: column $1$ is $[0, -1, 1]^\\top$.\nFor $e_2 (v_2 \\to v_0)$: column $2$ is $[1, 0, -1]^\\top$.\nThus, the incidence matrix is:\n$$\nD = \\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix}\n$$\n\nThe edge lengths $\\ell_i$ are calculated using the Euclidean distance formula:\n$\\ell_0 = \\|v_1 - v_0\\|_2 = \\|(1,0) - (0,0)\\|_2 = 1$.\n$\\ell_1 = \\|v_2 - v_1\\|_2 = \\|(0.2-1, 0.9-0)\\|_2 = \\|(-0.8, 0.9)\\|_2 = \\sqrt{(-0.8)^2 + 0.9^2} = \\sqrt{0.64 + 0.81} = \\sqrt{1.45}$.\n$\\ell_2 = \\|v_0 - v_2\\|_2 = \\|(0-0.2, 0-0.9)\\|_2 = \\|(-0.2, -0.9)\\|_2 = \\sqrt{(-0.2)^2 + (-0.9)^2} = \\sqrt{0.04 + 0.81} = \\sqrt{0.85}$.\n\nThe edge mass matrix $M_e = \\mathrm{diag}(\\ell_0, \\ell_1, \\ell_2)$ is:\n$$\nM_e = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\sqrt{1.45} & 0 \\\\ 0 & 0 & \\sqrt{0.85} \\end{pmatrix}\n$$\n\nThe projection onto the nodal space is the identity, $P_0 = I \\in \\mathbb{R}^{3 \\times 3}$. For cases involving a non-trivial edge projection $P_1$, it is defined as $P_1 = S ( S^\\top M_e S )^{-1} S^\\top M_e$. In the relevant cases, the subspace is spanned by $S = [1, 0, 0]^\\top$.\nWe compute the components of $P_1$ for this $S$:\n$S^\\top M_e S = [1, 0, 0] \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\sqrt{1.45} & 0 \\\\ 0 & 0 & \\sqrt{0.85} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1$.\n$(S^\\top M_e S)^{-1} = 1^{-1} = 1$.\n$S^\\top M_e = [1, 0, 0] \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\sqrt{1.45} & 0 \\\\ 0 & 0 & \\sqrt{0.85} \\end{pmatrix} = [1, 0, 0]$.\n$P_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} (1) [1, 0, 0] = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$.\nThis $P_1$ projects any edge current vector onto the subspace of edge $e_0$.\n\nWith all matrices defined, we now evaluate each test case.\n\n**Case 1:** $S = [1, 0, 0]^\\top$, $\\Delta t = 0.5$, $J^{n} = [0, 1, 0]^\\top$.\n$P_1$ is the projection matrix derived above.\n$r = \\Delta t (D J^n - D P_1 J^n)$.\n$J^n = [0, 1, 0]^\\top$.\n$D J^n = \\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$.\n$P_1 J^n = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n$D P_1 J^n = D [0, 0, 0]^\\top = [0, 0, 0]^\\top$.\n$r = 0.5 \\left( \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0 \\\\ -0.5 \\\\ 0.5 \\end{pmatrix}$.\n$\\|r\\|_2 = \\sqrt{0^2 + (-0.5)^2 + 0.5^2} = \\sqrt{0.25 + 0.25} = \\sqrt{0.5}$.\n\n**Case 2:** $P_1 = I$, $\\Delta t = 1.0$, $J^{n} = [0.3, -0.3, 0.0]^\\top$.\nHere, $P_1$ is the identity matrix, so the commutativity condition $D P_1 = P_0 D$ is satisfied as $D I = I D$, or $D=D$.\nThe residual must be zero:\n$r = \\Delta t (D J^n - D I J^n) = \\Delta t (D J^n - D J^n) = 0$.\n$\\|r\\|_2 = 0$.\n\n**Case 3:** $S = [1, 0, 0]^\\top$, $\\Delta t = 0.75$, $J^{n} = [2.0, 0.0, 0.0]^\\top$.\n$P_1$ is the same as in Case 1. The current vector $J^n$ lies entirely within the subspace onto which $P_1$ projects.\nTherefore, $P_1 J^n = J^n$.\nThe residual is:\n$r = \\Delta t (D J^n - D P_1 J^n) = \\Delta t (D J^n - D J^n) = 0$.\n$\\|r\\|_2 = 0$.\n\n**Case 4:** $S = [1, 0, 0]^\\top$, $\\Delta t = 2.0$, $J^{n} = [0.0, 0.0, 0.0]^\\top$.\nThe current is zero, so $J^n = 0$. The residual is trivially zero:\n$r = \\Delta t (D \\cdot 0 - D P_1 \\cdot 0) = 0$.\n$\\|r\\|_2 = 0$.\n\n**Case 5:** $S = [1, 0, 0]^\\top$, $\\Delta t = 1.25$, $J^{n} = [1.0, 1.0, -2.0]^\\top$.\n$P_1$ is the same as in Case 1.\n$r = \\Delta t (D J^n - D P_1 J^n)$.\n$J^n = [1.0, 1.0, -2.0]^\\top$.\n$D J^n = \\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1 - 2 \\\\ 1 - 1 \\\\ 1 - (-2) \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix}$.\n$P_1 J^n = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n$D P_1 J^n = \\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$.\n$r = 1.25 \\left( \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) = 1.25 \\begin{pmatrix} -2 \\\\ -1 \\\\ 3 \\end{pmatrix}$.\n$\\|r\\|_2 = 1.25 \\times \\sqrt{(-2)^2 + (-1)^2 + 3^2} = 1.25 \\times \\sqrt{4 + 1 + 9} = 1.25 \\sqrt{14}$.\n\nSummary of results:\nCase 1: $\\sqrt{0.5} \\approx 0.70710678$\nCase 2: $0.0$\nCase 3: $0.0$\nCase 4: $0.0$\nCase 5: $1.25\\sqrt{14} \\approx 4.67707195$\n\nThe following code implements these calculations to produce the final result.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrete continuity residual norm for a series of test cases\n    on a single triangular mesh within a Discrete Exterior Calculus framework.\n    \"\"\"\n    # Define mesh geometry and constant matrices\n    # Vertices: v0=(0,0), v1=(1,0), v2=(0.2,0.9)\n    v = np.array([\n        [0.0, 0.0],  # v0\n        [1.0, 0.0],  # v1\n        [0.2, 0.9]   # v2\n    ])\n\n    # Edge orientations: e0: v0->v1, e1: v1->v2, e2: v2->v0\n    # Node-edge incidence matrix D (discrete divergence)\n    D = np.array([\n        [-1, 0, 1],\n        [1, -1, 0],\n        [0, 1, -1]\n    ], dtype=float)\n\n    # Nodal projection matrix P0 (identity)\n    P0 = np.identity(3)\n\n    # Calculate edge lengths\n    l0 = np.linalg.norm(v[1] - v[0])  # edge e0\n    l1 = np.linalg.norm(v[2] - v[1])  # edge e1\n    l2 = np.linalg.norm(v[0] - v[2])  # edge e2\n\n    # Edge mass matrix Me\n    Me = np.diag([l0, l1, l2])\n\n    test_cases = [\n        # Case 1: counterexample on unstructured mesh\n        {'case_id': 1, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 0.5, 'Jn': np.array([0, 1, 0], dtype=float)},\n        # Case 2: commuting via identity\n        {'case_id': 2, 'S_def': None, 'P1_def': np.identity(3), 'dt': 1.0, 'Jn': np.array([0.3, -0.3, 0.0], dtype=float)},\n        # Case 3: current in the projected subspace\n        {'case_id': 3, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 0.75, 'Jn': np.array([2.0, 0.0, 0.0], dtype=float)},\n        # Case 4: zero current\n        {'case_id': 4, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 2.0, 'Jn': np.array([0.0, 0.0, 0.0], dtype=float)},\n        # Case 5: nontrivial mixture on non-commuting projection\n        {'case_id': 5, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 1.25, 'Jn': np.array([1.0, 1.0, -2.0], dtype=float)},\n    ]\n\n    results = []\n    for case in test_cases:\n        dt = case['dt']\n        Jn = case['Jn']\n\n        if case['P1_def'] is not None:\n            P1 = case['P1_def']\n        else:\n            S = case['S_def']\n            # Formula for weighted L2 projection: P1 = S * (S.T * Me * S)^-1 * S.T * Me\n            St_Me_S = S.T @ Me @ S\n            # St_Me_S is a 1x1 matrix for the given cases.\n            if np.abs(St_Me_S[0,0])  1e-15:\n                # To handle cases where the inverse might not exist, though not for these tests.\n                # In this case S.T * M_e * S is just the squared weighted norm of S.\n                # Projecting onto the zero vector results in a zero projection matrix.\n                P1 = np.zeros((3,3))\n            else:\n                St_Me_S_inv = np.linalg.inv(St_Me_S)\n                St_Me = S.T @ Me\n                P1 = S @ St_Me_S_inv @ St_Me\n        \n        # Residual formula: r = dt * (D*Jn - P0*D*P1*Jn)\n        # Since P0 is identity, r = dt * (D*Jn - D*P1*Jn)\n        r = dt * (D @ Jn - D @ P1 @ Jn)\n        \n        # Calculate the Euclidean norm of the residual\n        r_norm = np.linalg.norm(r)\n        results.append(r_norm)\n\n    # Return the final results in the required format\n    return f\"[{','.join(map(str, results))}]\"\n\n# The following line is commented out as the function's output will be placed in the answer tag.\n# print(solve())\n```",
            "answer": "[0.7071067811865476,0.0,0.0,0.0,4.67707195283204]"
        }
    ]
}