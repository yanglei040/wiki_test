{
    "hands_on_practices": [
        {
            "introduction": "理解输入阻抗在极端负载条件下的行为，是掌握传输线理论的基石。本练习要求从电报方程出发，推导无损传输线在短路和开路两种情况下的输入阻抗 。这不仅是一次理论推导，更是将波动方程与端口宏观特性联系起来的基础实践，为后续更复杂的分析和测量技术奠定基础。",
            "id": "3319452",
            "problem": "一条支持横电磁（TEM）波传播的均匀、无损耗传输线，其特性由单位长度的分布电感 $L'$ 和单位长度的分布电容 $C'$ 决定。该传输线的特性阻抗为 $Z_{0}=\\sqrt{L'/C'}$，相位常数为 $\\beta=\\omega\\sqrt{L'C'}$，其中 $\\omega$ 是角频率，而 $j$ 表示满足 $j^{2}=-1$ 的单位虚数。设空间坐标 $z$ 沿传输线分布，负载位于 $z=0$ 处，输入端口位于 $z=-l$ 处，其中 $l0$ 是传输线的物理长度。假设系统处于正弦稳态，其时间依赖关系为 $\\exp(j\\omega t)$。\n\n从导出TEM线无损耗电报方程及其对应的电压和电流波动方程的场论基础出发，推导该传输线在以下两种负载端接情况下的输入阻抗 $Z_{\\text{in}}=V(-l)/I(-l)$ 的表达式：\n- 负载处为理想短路，$Z_{L}=0$，\n- 负载处为理想开路，$Z_{L}\\to\\infty$。\n\n您的推导必须从无损耗电报方程开始，并对每种端接情况施加在 $z=0$ 处的相应边界条件。请勿使用针对任意负载预先推导出的输入阻抗恒等式；相反，应直接从电压和电流的波动解及其通过 $Z_{0}$ 的关系来获得表达式。\n\n请以包含 $Z_{0}$、$\\beta$ 和 $l$ 的精确符号表达式的形式给出您的最终结果。假设所有三角函数的参数均以弧度为单位。阻抗以欧姆为单位表示，但不要在方框内的最终答案中包含单位。无需进行数值取整。",
            "solution": "该问题陈述被认为是有效的，因为它科学地基于传输线理论的原理，问题设定完整且一致，并以客观、正式的语言表述。从无损耗电报方程推导短路和开路端接的输入阻抗是电磁学中一个基本且可解的问题。\n\n推导过程如下，从均匀传输线的无损耗电报方程开始。在时域中，这些方程为：\n$$\n\\frac{\\partial V(z,t)}{\\partial z} = -L' \\frac{\\partial I(z,t)}{\\partial t}\n$$\n$$\n\\frac{\\partial I(z,t)}{\\partial z} = -C' \\frac{\\partial V(z,t)}{\\partial t}\n$$\n其中 $V(z,t)$ 和 $I(z,t)$ 分别是瞬时电压和电流，$L'$ 是单位长度电感，$C'$ 是单位长度电容。\n\n对于正弦稳态分析，我们假设时间依赖形式为 $\\exp(j\\omega t)$。电压和电流可以表示为相量形式：$V(z,t) = \\text{Re}\\{V(z)\\exp(j\\omega t)\\}$ 和 $I(z,t) = \\text{Re}\\{I(z)\\exp(j\\omega t)\\}$。时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $j\\omega$。电报方程在频域（相量形式）中变为：\n$$\n\\frac{dV(z)}{dz} = -j\\omega L' I(z) \\quad (1)\n$$\n$$\n\\frac{dI(z)}{dz} = -j\\omega C' V(z) \\quad (2)\n$$\n\n为了获得波动方程，我们将这两个一阶微分方程解耦。将方程(1)对 $z$ 求导，并代入方程(2)，可得到电压的波动方程：\n$$\n\\frac{d^2V(z)}{dz^2} = -j\\omega L' \\frac{dI(z)}{dz} = -j\\omega L' (-j\\omega C' V(z)) = -\\omega^2 L'C' V(z)\n$$\n整理后得到电压的亥姆霍兹方程：\n$$\n\\frac{d^2V(z)}{dz^2} + \\beta^2 V(z) = 0\n$$\n其中相位常数定义为 $\\beta = \\omega\\sqrt{L'C'}$。类似的过程可以得到相同的电流波动方程：\n$$\n\\frac{d^2I(z)}{dz^2} + \\beta^2 I(z) = 0\n$$\n电压波动方程的通解是前向传播（沿 $+z$ 方向，从源到负载）和反向传播（沿 $-z$ 方向，从负载到源）波的叠加：\n$$\nV(z) = V_0^+ \\exp(-j\\beta z) + V_0^- \\exp(j\\beta z)\n$$\n其中 $V_0^+$ 和 $V_0^-$ 是复振幅。相应的电流可以从方程(1)中求出：\n$$\nI(z) = -\\frac{1}{j\\omega L'} \\frac{dV(z)}{dz} = -\\frac{1}{j\\omega L'} (-j\\beta V_0^+ \\exp(-j\\beta z) + j\\beta V_0^- \\exp(j\\beta z))\n$$\n$$\nI(z) = \\frac{\\beta}{\\omega L'} V_0^+ \\exp(-j\\beta z) - \\frac{\\beta}{\\omega L'} V_0^- \\exp(j\\beta z)\n$$\n使用定义 $\\beta = \\omega\\sqrt{L'C'}$ 和特性阻抗 $Z_0 = \\sqrt{L'/C'}$，前置因子变为：\n$$\n\\frac{\\beta}{\\omega L'} = \\frac{\\omega\\sqrt{L'C'}}{\\omega L'} = \\sqrt{\\frac{C'}{L'}} = \\frac{1}{Z_0}\n$$\n因此，电流的通解为：\n$$\nI(z) = \\frac{V_0^+}{Z_0} \\exp(-j\\beta z) - \\frac{V_0^-}{Z_0} \\exp(j\\beta z)\n$$\n\n我们现在对两种指定情况施加负载端（$z=0$）的边界条件。\n\n**情况1：短路端接 ($Z_{L}=0$)**\n\n对于理想短路，负载端的电压必须为零。边界条件是 $V(0) = 0$。\n$$\nV(0) = V_0^+ \\exp(0) + V_0^- \\exp(0) = V_0^+ + V_0^- = 0\n$$\n这意味着 $V_0^- = -V_0^+$。将此关系代入 $V(z)$ 和 $I(z)$ 的通解中：\n$$\nV_{sc}(z) = V_0^+ \\exp(-j\\beta z) - V_0^+ \\exp(j\\beta z) = V_0^+ (\\exp(-j\\beta z) - \\exp(j\\beta z)) = -2j V_0^+ \\sin(\\beta z)\n$$\n$$\nI_{sc}(z) = \\frac{V_0^+}{Z_0} \\exp(-j\\beta z) - \\frac{-V_0^+}{Z_0} \\exp(j\\beta z) = \\frac{V_0^+}{Z_0} (\\exp(-j\\beta z) + \\exp(j\\beta z)) = \\frac{2 V_0^+}{Z_0} \\cos(\\beta z)\n$$\n输入阻抗 $Z_{\\text{in}}$ 定义在输入端口 $z=-l$ 处。\n$$\nZ_{\\text{in,sc}} = \\frac{V_{sc}(-l)}{I_{sc}(-l)} = \\frac{-2j V_0^+ \\sin(-\\beta l)}{\\frac{2 V_0^+}{Z_0} \\cos(-\\beta l)}\n$$\n使用恒等式 $\\sin(-x) = -\\sin(x)$ 和 $\\cos(-x) = \\cos(x)$：\n$$\nZ_{\\text{in,sc}} = \\frac{-2j V_0^+ (-\\sin(\\beta l))}{\\frac{2 V_0^+}{Z_0} \\cos(\\beta l)} = \\frac{2j V_0^+ \\sin(\\beta l)}{\\frac{2 V_0^+}{Z_0} \\cos(\\beta l)} = j Z_0 \\frac{\\sin(\\beta l)}{\\cos(\\beta l)}\n$$\n$$\nZ_{\\text{in,sc}} = j Z_0 \\tan(\\beta l)\n$$\n\n**情况2：开路端接 ($Z_{L}\\to\\infty$)**\n\n对于理想开路，负载端的电流必须为零。边界条件是 $I(0) = 0$。\n$$\nI(0) = \\frac{V_0^+}{Z_0} \\exp(0) - \\frac{V_0^-}{Z_0} \\exp(0) = \\frac{1}{Z_0} (V_0^+ - V_0^-) = 0\n$$\n这意味着 $V_0^- = V_0^+$。将此关系代入 $V(z)$ 和 $I(z)$ 的通解中：\n$$\nV_{oc}(z) = V_0^+ \\exp(-j\\beta z) + V_0^+ \\exp(j\\beta z) = V_0^+ (\\exp(-j\\beta z) + \\exp(j\\beta z)) = 2 V_0^+ \\cos(\\beta z)\n$$\n$$\nI_{oc}(z) = \\frac{V_0^+}{Z_0} \\exp(-j\\beta z) - \\frac{V_0^+}{Z_0} \\exp(j\\beta z) = \\frac{V_0^+}{Z_0} (\\exp(-j\\beta z) - \\exp(j\\beta z)) = -\\frac{2j V_0^+}{Z_0} \\sin(\\beta z)\n$$\n在端口 $z=-l$ 处的输入阻抗 $Z_{\\text{in}}$ 为：\n$$\nZ_{\\text{in,oc}} = \\frac{V_{oc}(-l)}{I_{oc}(-l)} = \\frac{2 V_0^+ \\cos(-\\beta l)}{-\\frac{2j V_0^+}{Z_0} \\sin(-\\beta l)}\n$$\n再次使用 $\\sin(-x) = -\\sin(x)$ 和 $\\cos(-x) = \\cos(x)$：\n$$\nZ_{\\text{in,oc}} = \\frac{2 V_0^+ \\cos(\\beta l)}{-\\frac{2j V_0^+}{Z_0} (-\\sin(\\beta l))} = \\frac{2 V_0^+ \\cos(\\beta l)}{\\frac{2j V_0^+}{Z_0} \\sin(\\beta l)} = \\frac{Z_0}{j} \\frac{\\cos(\\beta l)}{\\sin(\\beta l)}\n$$\n由于 $1/j = -j$：\n$$\nZ_{\\text{in,oc}} = -j Z_0 \\cot(\\beta l)\n$$\n推导出的表达式分别给出了短路和开路无损耗传输线的输入阻抗，它们用传输线的特性阻抗 $Z_0$、相位常数 $\\beta$ 和长度 $l$ 表示。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nj Z_{0} \\tan(\\beta l)  -j Z_{0} \\cot(\\beta l)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论模型是理想的，但在实际的数值仿真或物理测量中，端口附近的边缘场等非理想效应会污染结果。本练习引入了一个关键的实用技术——去嵌入（de-embedding），旨在校正这些测量误差 。通过建立一个物理上合理的误差模型，你将通过编程实践探索如何通过将参考平面“嵌入”传输线内部来系统性地减少测量误差，这是计算电磁工程师必备的一项核心技能。",
            "id": "3319403",
            "problem": "一个均匀一维传输线使用频域中的电报员方程进行建模。该传输线由单位长度参数表征：$R^{\\prime}$（串联电阻，单位 $\\Omega/\\mathrm{m}$）、$L^{\\prime}$（串联电感，单位 $\\mathrm{H}/\\mathrm{m}$）、$G^{\\prime}$（并联电导，单位 $\\mathrm{S}/\\mathrm{m}$）和 $C^{\\prime}$（并联电容，单位 $\\mathrm{F}/\\mathrm{m}$），并在单一角频率 $\\omega = 2\\pi f$ 下驱动。传输线在 $z=0$ 处由一个复负载阻抗 $Z_{\\mathrm{L}}$（单位 $\\Omega$）端接。用于提取反射系数的参考端口平面嵌入到传输线中距离为 $d \\ge 0$ 的位置，即从负载平面算起在 $z=d$ 处。在负载附近，近场边缘效应会产生局域化的非传播场，这些场会污染在嵌入端口平面处提取的输入阻抗。我们使用以下具有物理动机的模型来表示这种污染：一个随嵌入深度指数衰减的附加串联电抗项，因此在端口平面测得的输入阻抗建模为\n$$\nZ_{\\mathrm{in,meas}}(d) \\;=\\; Z_{\\mathrm{in,ideal}}(d) \\;+\\; j X_{\\mathrm{f}} \\exp\\!\\left(-\\dfrac{2 d}{\\ell_{\\mathrm{f}}}\\right),\n$$\n其中 $X_{\\mathrm{f}}$（单位 $\\Omega$）是参数化负载平面上由边缘效应引起的串联电抗强度的参数，而 $\\ell_{\\mathrm{f}}$（单位 $\\mathrm{m}$）设定了边缘场沿传输线的特征衰减长度。\n\n从电报员方程和标准定义出发，计算以下量，并实现一个算法，以确定最小嵌入深度 $d$，使得提取的量在指定容差内收敛到其在负载平面上的真实值：\n- 由 $R^{\\prime}$、$L^{\\prime}$、$G^{\\prime}$、$C^{\\prime}$ 和 $\\omega$ 计算出的传输线的复传播常数 $ \\gamma $ 和复特性阻抗 $ Z_{0} $。\n- 对于由 $ Z_{\\mathrm{L}} $ 端接的长度为 $d$ 的均匀传输线段，在嵌入深度 $d$ 处的理想输入阻抗，记为 $ Z_{\\mathrm{in,ideal}}(d) $。\n- 对应于 $ Z_{\\mathrm{in,meas}}(d) $ 和参考阻抗 $ Z_{0} $ 的，在嵌入端口平面处的测量反射系数 $ \\Gamma_{\\mathrm{meas}}(d) $。\n- 通过将 $ \\Gamma_{\\mathrm{meas}}(d) $ 从 $ z=d $ 沿传输线平移到 $ z=0 $ 而获得的，在负载平面处的去嵌入反射系数 $ \\Gamma_{\\mathrm{ext}}(d) $。\n- 由 $ \\Gamma_{\\mathrm{ext}}(d) $ 和 $ Z_{0} $ 得到的去嵌入负载阻抗 $ Z_{\\mathrm{ext}}(d) $。\n- 参考阻抗为 $ Z_{0} $、真实负载阻抗为 $ Z_{\\mathrm{true}} = Z_{\\mathrm{L}} $ 时的真实负载平面反射系数 $ \\Gamma_{\\mathrm{true}} $。\n\n定义误差度量\n$$\n\\varepsilon_{\\Gamma}(d) \\;=\\; \\left| \\Gamma_{\\mathrm{ext}}(d) - \\Gamma_{\\mathrm{true}} \\right|\n\\quad\\text{和}\\quad\n\\varepsilon_{Z,\\mathrm{rel}}(d) \\;=\\; \\dfrac{ \\left| Z_{\\mathrm{ext}}(d) - Z_{\\mathrm{true}} \\right| }{ \\left| Z_{\\mathrm{true}} \\right| }.\n$$\n对于下方的每个测试用例，搜索一组离散的候选嵌入深度，并返回满足 $ \\varepsilon_{\\Gamma}(d) \\le \\epsilon_{\\Gamma} $ 和 $ \\varepsilon_{Z,\\mathrm{rel}}(d) \\le \\epsilon_{Z} $ 两个条件的最小 $ d $（单位 $\\mathrm{m}$）。如果没有候选深度满足这两个容差，则返回 $ -1.0 $。\n\n所有物理量必须以相干的国际单位制（SI）单位处理。最终答案以米为单位表示，并将每个报告的深度四舍五入到 $6$ 位有效数字。不需要角度。\n\n使用以下定义作为您的基本依据：\n- 频域中的电报员方程，其蕴含了复传播常数 $ \\gamma $ 和特性阻抗 $ Z_{0} $ 的存在。\n- 由 $ Z_{\\mathrm{L}} $ 端接的长度为 $ d $ 的均匀传输线段的输入阻抗变换。\n- 在给定平面上参考于 $ Z_{0} $ 的反射系数定义 $ \\Gamma = \\dfrac{Z - Z_{0}}{Z + Z_{0}} $ 及其在均匀介质中沿传输线的指数平移。\n\n实现您的程序以使用以下候选深度集\n$$\n\\mathcal{D} \\;=\\; \\left\\{ 0,\\, 2.5\\times 10^{-4},\\, 5.0\\times 10^{-4},\\, \\dots,\\, 5.0\\times 10^{-3} \\right\\}\\ \\mathrm{m},\n$$\n以及以下容差\n$$\n\\epsilon_{\\Gamma} \\;=\\; 1.0 \\times 10^{-3},\n\\qquad\n\\epsilon_{Z} \\;=\\; 1.0 \\times 10^{-3},\n$$\n和下方的测试套件。\n\n测试套件（每个元组为 $ (f, R^{\\prime}, L^{\\prime}, G^{\\prime}, C^{\\prime}, Z_{\\mathrm{L}}, X_{\\mathrm{f}}, \\ell_{\\mathrm{f}}) $）：\n- 用例 A（理想路径，中等边缘效应，中等损耗）：\n  $ f = 1.0\\times 10^{10}\\ \\mathrm{Hz},\\ R^{\\prime} = 0.1\\ \\Omega/\\mathrm{m},\\ L^{\\prime} = 4.0\\times 10^{-7}\\ \\mathrm{H}/\\mathrm{m},\\ G^{\\prime} = 1.0\\times 10^{-3}\\ \\mathrm{S}/\\mathrm{m},\\ C^{\\prime} = 1.33\\times 10^{-10}\\ \\mathrm{F}/\\mathrm{m},\\ Z_{\\mathrm{L}} = 30.0 - j\\,25.0\\ \\Omega,\\ X_{\\mathrm{f}} = 5.0\\ \\Omega,\\ \\ell_{\\mathrm{f}} = 5.0\\times 10^{-4}\\ \\mathrm{m}. $\n- 用例 B（零边缘效应边缘情况）：\n  $ f = 1.0\\times 10^{10}\\ \\mathrm{Hz},\\ R^{\\prime} = 0.1\\ \\Omega/\\mathrm{m},\\ L^{\\prime} = 4.0\\times 10^{-7}\\ \\mathrm{H}/\\mathrm{m},\\ G^{\\prime} = 1.0\\times 10^{-3}\\ \\mathrm{S}/\\mathrm{m},\\ C^{\\prime} = 1.33\\times 10^{-10}\\ \\mathrm{F}/\\mathrm{m},\\ Z_{\\mathrm{L}} = 75.0 + j\\,10.0\\ \\Omega,\\ X_{\\mathrm{f}} = 0.0\\ \\Omega,\\ \\ell_{\\mathrm{f}} = 1.0\\times 10^{-3}\\ \\mathrm{m}. $\n- 用例 C（强边缘效应，长衰减长度）：\n  $ f = 1.0\\times 10^{10}\\ \\mathrm{Hz},\\ R^{\\prime} = 0.1\\ \\Omega/\\mathrm{m},\\ L^{\\prime} = 4.0\\times 10^{-7}\\ \\mathrm{H}/\\mathrm{m},\\ G^{\\prime} = 1.0\\times 10^{-3}\\ \\mathrm{S}/\\mathrm{m},\\ C^{\\prime} = 1.33\\times 10^{-10}\\ \\mathrm{F}/\\mathrm{m},\\ Z_{\\mathrm{L}} = 20.0 + j\\,40.0\\ \\Omega,\\ X_{\\mathrm{f}} = 20.0\\ \\Omega,\\ \\ell_{\\mathrm{f}} = 2.0\\times 10^{-2}\\ \\mathrm{m}. $\n- 用例 D（高损耗，较短边缘效应）：\n  $ f = 8.0\\times 10^{9}\\ \\mathrm{Hz},\\ R^{\\prime} = 5.0\\ \\Omega/\\mathrm{m},\\ L^{\\prime} = 4.0\\times 10^{-7}\\ \\mathrm{H}/\\mathrm{m},\\ G^{\\prime} = 5.0\\times 10^{-2}\\ \\mathrm{S}/\\mathrm{m},\\ C^{\\prime} = 1.33\\times 10^{-10}\\ \\mathrm{F}/\\mathrm{m},\\ Z_{\\mathrm{L}} = 50.0 - j\\,10.0\\ \\Omega,\\ X_{\\mathrm{f}} = 3.0\\ \\Omega,\\ \\ell_{\\mathrm{f}} = 1.0\\times 10^{-3}\\ \\mathrm{m}. $\n\n您的程序必须为测试套件中的每个用例计算满足两个误差约束的最小 $ d \\in \\mathcal{D} $。如果不存在这样的 $ d $，则返回 $ -1.0 $。最终输出必须是单行文本，包含一个由方括号括起来的、逗号分隔的四个结果列表，每个值都以米表示并四舍五入到 $6$ 位有效数字，例如 $[0.0005,0,-1,0.00125]$（这只是一个示例格式，并非答案）。",
            "solution": "用户提供了一个有效的问题陈述。\n\n### 问题验证\n\n1.  **已知条件提取**：\n    *   **线路参数**：$R^{\\prime}$ ($\\Omega/\\mathrm{m}$), $L^{\\prime}$ ($\\mathrm{H}/\\mathrm{m}$), $G^{\\prime}$ ($\\mathrm{S}/\\mathrm{m}$), $C^{\\prime}$ ($\\mathrm{F}/\\mathrm{m}$)。\n    *   **激励**：角频率 $\\omega = 2\\pi f$。\n    *   **端接**：负载阻抗 $Z_{\\mathrm{L}}$ ($\\Omega$) 位于 $z=0$。\n    *   **测量**：端口平面位于 $z=d$。\n    *   **边缘效应模型**：测量的输入阻抗 $Z_{\\mathrm{in,meas}}(d) = Z_{\\mathrm{in,ideal}}(d) + j X_{\\mathrm{f}} \\exp(-2 d / \\ell_{\\mathrm{f}})$，参数为 $X_{\\mathrm{f}}$ 和 $\\ell_{\\mathrm{f}}$。\n    *   **核心定义**：$\\gamma$、$Z_0$、$Z_{\\mathrm{in,ideal}}(d)$、$\\Gamma$ 的公式以及反射系数的平移通过引用标准理论提供或暗示。\n    *   **误差度量**：$\\varepsilon_{\\Gamma}(d) = | \\Gamma_{\\mathrm{ext}}(d) - \\Gamma_{\\mathrm{true}} |$ 和 $\\varepsilon_{Z,\\mathrm{rel}}(d) = | Z_{\\mathrm{ext}}(d) - Z_{\\mathrm{true}} | / | Z_{\\mathrm{true}} |$。\n    *   **搜索空间**：$\\mathcal{D} = \\{ 0, 2.5\\times 10^{-4}, \\dots, 5.0\\times 10^{-3} \\}$ m。\n    *   **容差**：$\\epsilon_{\\Gamma} = 1.0 \\times 10^{-3}$，$\\epsilon_{Z} = 1.0 \\times 10^{-3}$。\n    *   **任务**：为四个测试用例找到满足两个容差条件的最小 $d \\in \\mathcal{D}$。如果不存在这样的 $d$，则返回 $-1.0$。\n\n2.  **验证检查**：\n    *   **科学依据**：该问题很好地基于电报员方程和经典传输线理论，这些是电磁学和电气工程中的基本原理。边缘场模型是一个具有物理动机的唯象附加项，在工程实践中很常见。\n    *   **适定性**：该问题是适定的。它要求对一个有限、离散的候选值集合进行确定性搜索以达成特定目标，从而保证一个唯一的结果（或一个已定义的失败值 $-1.0$）。\n    *   **客观性**：语言精确客观，使用了形式化的数学定义和可量化的标准。\n    *   **完整性与一致性**：该问题是自包含的，提供了所有必要的物理参数、数学模型和收敛标准。内部没有矛盾。\n    *   **其他缺陷**：该问题并非微不足道、不切实际、不适定或无法验证。它代表了计算电磁学中的一个标准分析任务。\n\n3.  **结论**：问题有效。\n\n### 解题推导\n\n目标是找到最小的嵌入深度 $d$，在该深度下，去嵌入的负载阻抗和反射系数在指定的容差内收敛到其真实值。这是为了减轻在离负载不连续点太近处进行的测量中，因建模的近场边缘效应所造成的污染。解决方案涉及对每个候选深度进行一系列计算，详述如下。\n\n1.  **基本线路属性**\n    对于给定的频率 $f$，角频率为 $\\omega = 2\\pi f$。传输线的分布串联阻抗 $Z^{\\prime}$ 和并联导纳 $Y^{\\prime}$ 由下式给出：\n    $$ Z^{\\prime} = R^{\\prime} + j\\omega L^{\\prime} $$\n    $$ Y^{\\prime} = G^{\\prime} + j\\omega C^{\\prime} $$\n    由此，我们计算线路的复传播常数 $\\gamma$ 和复特性阻抗 $Z_0$：\n    $$ \\gamma = \\sqrt{Z^{\\prime} Y^{\\prime}} = \\sqrt{(R^{\\prime} + j\\omega L^{\\prime})(G^{\\prime} + j\\omega C^{\\prime})} $$\n    $$ Z_0 = \\sqrt{\\frac{Z^{\\prime}}{Y^{\\prime}}} = \\sqrt{\\frac{R^{\\prime} + j\\omega L^{\\prime}}{G^{\\prime} + j\\omega C^{\\prime}}} $$\n    传播常数写作 $\\gamma = \\alpha + j\\beta$，其中 $\\alpha$ 是衰减常数，$\\beta$ 是相移常数。对于无源线路，物理现实要求 $\\alpha \\ge 0$，这个条件由复数平方根的主分支满足。\n\n2.  **真实（参考）值**\n    “真实”参数是指在没有任何测量伪影的情况下，在负载平面（$z=0$）处的参数。真实负载阻抗就是所提供的值：\n    $$ Z_{\\mathrm{true}} = Z_{\\mathrm{L}} $$\n    在负载平面上，参考于 $Z_0$ 的相应真实反射系数为：\n    $$ \\Gamma_{\\mathrm{true}} = \\frac{Z_{\\mathrm{true}} - Z_0}{Z_{\\mathrm{true}} + Z_0} = \\frac{Z_{\\mathrm{L}} - Z_0}{Z_{\\mathrm{L}} + Z_0} $$\n    这些值作为我们误差计算的基准真相。\n\n3.  **迭代去嵌入算法**\n    我们必须在候选嵌入深度 $\\mathcal{D}$ 的离散集合上进行搜索。对于每个深度 $d \\in \\mathcal{D}$，我们执行以下步骤来模拟测量和去嵌入过程：\n\n    **步骤 3a：计算理想输入阻抗**\n    距离负载 $Z_{\\mathrm{L}}$ 为 $d$ 处的理想输入阻抗 $Z_{\\mathrm{in,ideal}}(d)$ 由传输线阻抗变换公式给出：\n    $$ Z_{\\mathrm{in,ideal}}(d) = Z_0 \\frac{Z_{\\mathrm{L}} + Z_0 \\tanh(\\gamma d)}{Z_0 + Z_{\\mathrm{L}} \\tanh(\\gamma d)} $$\n\n    **步骤 3b：建模测量阻抗**\n    问题陈述指出，边缘场会引入一个附加误差。在 $z=d$ 处建模的“测量”输入阻抗为：\n    $$ Z_{\\mathrm{in,meas}}(d) = Z_{\\mathrm{in,ideal}}(d) + j X_{\\mathrm{f}} \\exp\\left(-\\frac{2 d}{\\ell_{\\mathrm{f}}}\\right) $$\n    该方程考虑了指数衰减的、非传播的电抗场贡献。\n\n    **步骤 3c：计算测量反射系数**\n    在测量平面 $z=d$ 处，测量反射系数 $\\Gamma_{\\mathrm{meas}}(d)$ 是根据测量阻抗 $Z_{\\mathrm{in,meas}}(d)$ 相对于线路的特性阻抗 $Z_0$ 计算得出的：\n    $$ \\Gamma_{\\mathrm{meas}}(d) = \\frac{Z_{\\mathrm{in,meas}}(d) - Z_0}{Z_{\\mathrm{in,meas}}(d) + Z_0} $$\n\n    **步骤 3d：去嵌入至负载平面**\n    为了找到可以从测量中推断出的负载平面阻抗，我们必须对 $\\Gamma_{\\mathrm{meas}}(d)$ 进行去嵌入。这涉及将反射系数从测量平面 $z=d$ 平移回负载平面 $z=0$。其关系为 $\\Gamma(d) = \\Gamma(0) e^{-2\\gamma d}$。因此，在负载平面提取的反射系数为：\n    $$ \\Gamma_{\\mathrm{ext}}(d) = \\Gamma_{\\mathrm{meas}}(d) e^{2\\gamma d} $$\n\n    **步骤 3e：计算提取的负载阻抗**\n    然后通过将 $\\Gamma_{\\mathrm{ext}}(d)$ 从反射系数转换回阻抗来找到提取的负载阻抗 $Z_{\\mathrm{ext}}(d)$：\n    $$ Z_{\\mathrm{ext}}(d) = Z_0 \\frac{1 + \\Gamma_{\\mathrm{ext}}(d)}{1 - \\Gamma_{\\mathrm{ext}}(d)} $$\n\n4.  **误差分析与收敛性检查**\n    利用提取的值，我们计算误差度量以量化与真实值的偏差：\n    $$ \\varepsilon_{\\Gamma}(d) = | \\Gamma_{\\mathrm{ext}}(d) - \\Gamma_{\\mathrm{true}} | $$\n    $$ \\varepsilon_{Z,\\mathrm{rel}}(d) = \\frac{| Z_{\\mathrm{ext}}(d) - Z_{\\mathrm{true}} |}{| Z_{\\mathrm{true}} |} $$\n    算法按升序迭代遍历候选深度 $d \\in \\mathcal{D}$。第一个同时满足 $\\varepsilon_{\\Gamma}(d) \\le \\epsilon_{\\Gamma}$ 和 $\\varepsilon_{Z,\\mathrm{rel}}(d) \\le \\epsilon_{Z}$ 两个条件的 $d$ 值，就是所需的最小嵌入深度，也是该测试用例的解。如果循环完成仍未找到合适的深度，则结果为 $-1.0$。\n\n每个结果必须四舍五入到 $6$ 位有效数字。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the transmission line de-embedding problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: (f, R', L', G', C', Z_L, X_f, l_f)\n        (1.0e10, 0.1, 4.0e-7, 1.0e-3, 1.33e-10, 30.0 - 1j*25.0, 5.0, 5.0e-4),\n        # Case B\n        (1.0e10, 0.1, 4.0e-7, 1.0e-3, 1.33e-10, 75.0 + 1j*10.0, 0.0, 1.0e-3),\n        # Case C\n        (1.0e10, 0.1, 4.0e-7, 1.0e-3, 1.33e-10, 20.0 + 1j*40.0, 20.0, 2.0e-2),\n        # Case D\n        (8.0e9, 5.0, 4.0e-7, 5.0e-2, 1.33e-10, 50.0 - 1j*10.0, 3.0, 1.0e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_minimal_depth(*case)\n        results.append(result)\n\n    def format_result(val):\n        \"\"\"Formats a result according to the problem's example format.\"\"\"\n        if val == -1.0:\n            return \"-1.0\" # Per instruction to return -1.0\n        if val == 0.0:\n            return \"0.0\"\n        \n        # Round to 6 significant figures\n        if not np.isfinite(val) or val == 0:\n            rounded_val = val\n        else:\n            n_sig_figs = 6\n            power = math.floor(math.log10(abs(val)))\n            decimals = n_sig_figs - 1 - int(power)\n            rounded_val = round(val, decimals)\n\n        # Format as a decimal string without scientific notation or trailing zeros\n        if rounded_val == 0.0: return \"0.0\"\n        \n        # Format with enough decimal places to not lose precision, then strip extras.\n        # 16 is a safe number of decimal places for typical float64 precision.\n        s = f\"{rounded_val:.16f}\".rstrip('0')\n        if s.endswith('.'):\n            s = s[:-1]\n        return s\n\n    formatted_results = [format_result(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef find_minimal_depth(f, R_p, L_p, G_p, C_p, Z_L, X_f, l_f):\n    \"\"\"\n    Calculates the minimal embedding depth d for a single test case.\n    \"\"\"\n    # Tolerances\n    epsilon_gamma_tol = 1.0e-3\n    epsilon_z_rel_tol = 1.0e-3\n\n    # Candidate depths (0 to 5mm in steps of 0.25mm)\n    candidate_depths = np.linspace(0, 5.0e-3, 21)\n\n    # --- 1. Preparatory Calculations ---\n    omega = 2 * np.pi * f\n    j = 1j\n\n    # Per-unit-length impedance and admittance\n    Z_prime = R_p + j * omega * L_p\n    Y_prime = G_p + j * omega * C_p\n\n    # Propagation constant and characteristic impedance\n    gamma = np.sqrt(Z_prime * Y_prime)\n    Z0 = np.sqrt(Z_prime / Y_prime)\n\n    # --- 2. True (Reference) Values at z=0 ---\n    Z_true = Z_L\n    Gamma_true = (Z_true - Z0) / (Z_true + Z0)\n\n    # --- 3. Iterative Search over Depths ---\n    for d in candidate_depths:\n        # Ideal input impedance at z=d\n        tanh_gd = np.tanh(gamma * d)\n        Z_in_ideal = Z0 * (Z_L + Z0 * tanh_gd) / (Z0 + Z_L * tanh_gd)\n        \n        # Measured input impedance including fringing model\n        Z_in_meas = Z_in_ideal + j * X_f * np.exp(-2.0 * d / l_f)\n\n        # Measured reflection coefficient at z=d\n        Gamma_meas = (Z_in_meas - Z0) / (Z_in_meas + Z0)\n\n        # De-embed to get extracted reflection coefficient at z=0\n        Gamma_ext = Gamma_meas * np.exp(2.0 * gamma * d)\n        \n        # Convert back to extracted impedance at z=0\n        if np.isclose(Gamma_ext, -1.0):\n            Z_ext = np.inf + 0j # Represents an open circuit\n        else:\n            Z_ext = Z0 * (1.0 + Gamma_ext) / (1.0 - Gamma_ext)\n            \n        # --- 4. Error Calculation ---\n        error_gamma = np.abs(Gamma_ext - Gamma_true)\n        \n        abs_Z_true = np.abs(Z_true)\n        if abs_Z_true == 0:\n            # This case is not in the test suite but is a necessary guard.\n            # Define relative error as absolute error if true value is zero.\n            error_z_rel = np.abs(Z_ext - Z_true)\n        else:\n            error_z_rel = np.abs(Z_ext - Z_true) / abs_Z_true\n\n        # --- 5. Convergence Check ---\n        if error_gamma = epsilon_gamma_tol and error_z_rel = epsilon_z_rel_tol:\n            return d  # Return the first depth that satisfies the criteria\n    \n    # If no suitable depth is found in the search space\n    return -1.0\n\nsolve()\n```"
        },
        {
            "introduction": "S参数（如反射系数 $\\Gamma$）不仅仅是描述网络端口行为的数字，其内部蕴含着深刻的物理信息。本练习将引导你通过解析推导和数值验证，揭示反射系数的相位斜率与单端口网络（如天线）内部存储的无功储能之间的精确关系 。掌握这种联系，能让你从测量的S参数中“读出”器件的物理特性，是进行谐振器件分析与设计的高级技能。",
            "id": "3319441",
            "problem": "您需要从计算电磁学的第一性原理出发，推导并进行数值验证一个精确关系。该关系描述了代表多谐振天线的无源单端口网络输入端的反射系数相位的角频率斜率与储存的无功电能之间的联系。在频域内使用复相量约定进行分析，并假设系统处于正弦稳态。仅可使用以下基本原理：(i) 在实数参考阻抗下的反射系数定义，(ii) 导数的链式法则，(iii) 由Foster电抗定理为无损耗电抗部分提供的、储存能量与电纳（或电抗）导数之间的关系，以及 (iv) 连接阻抗和导纳的线性网络理论恒等式。在问题陈述中不得引入任何其他快捷公式。\n\n设该单端口在其驱动点由输入导纳 $Y(\\omega) = G + j B(\\omega)$ 表征，其中 $G$ 是代表辐射和欧姆电导的实数非负常数，而 $B(\\omega)$ 是一个由并联电感和电容支路的Foster和实现的无损耗多谐振网络的纯电抗性电纳。相应的输入阻抗为 $Z(\\omega) = 1/Y(\\omega)$。该单端口参考一个实的正特性阻抗 $Z_0$，反射系数为\n$$\n\\Gamma(\\omega) = \\frac{Z(\\omega) - Z_0}{Z(\\omega) + Z_0}.\n$$\n反射相位为 $\\phi(\\omega) = \\arg \\Gamma(\\omega)$，角度单位为弧度。根据适用于并联形式的Foster电抗定理，输入端口的时均储存无功电能满足\n$$\nW(\\omega) = \\frac{1}{4} \\frac{d B(\\omega)}{d \\omega} \\, |V(\\omega)|^2,\n$$\n其中 $V(\\omega)$ 是在选定激励下输入端口电压的复相量。\n\n任务 1 (推导)。仅从上述基本原理出发，推导一个将 $d \\phi(\\omega)/d \\omega$ 与 $d B(\\omega)/d \\omega$ 进而与 $W(\\omega)$ 联系起来的精确表达式。最终表达式应直接用 $Z(\\omega)$、$Z_0$ 和 $d B(\\omega)/d \\omega$ 表示 $d \\phi(\\omega)/d \\omega$，并消除对未知 $V(\\omega)$ 的任何依赖。您的推导必须普遍适用于任何满足 $dG/d\\omega = 0$ 的无源单端口。\n\n任务 2 (数值验证)。实现一个程序，对推导出的关系进行数值验证。验证使用以下每个测试网络，这些网络通过Foster并联综合来模拟多谐振天线。每个网络由一个实数电导 $G$ 与一组理想无损耗并联 $L C$ 支路并联而成。对于一个电感为 $L_k$、电容为 $C_k$ 的支路，其电纳为 $j \\left( \\omega C_k - \\frac{1}{\\omega L_k} \\right)$，其对 $d B(\\omega)/d \\omega$ 的贡献为 $\\left( C_k + \\frac{1}{\\omega^2 L_k} \\right)$。\n\n对于每次测试，使用频率扫描，频率范围从 $f_{\\min}$ 到 $f_{\\max}$（包含两端），采用 $N$ 个均匀间隔的线性间隔点。角频率为 $\\omega = 2 \\pi f$。计算：\n- 左侧 $d \\phi(\\omega)/d \\omega$，通过对 $\\phi(\\omega) = \\arg \\Gamma(\\omega)$ 使用解卷相位，并对 $\\omega$ 进行中心差分数值求导来数值计算。\n- 右侧，由您在任务 1 中推导的表达式预测。通过指定的 $L_k$ 和 $C_k$ 解析计算 $d B(\\omega)/d \\omega$，并使用网络的精确 $Z(\\omega)$。\n\n对于每次测试，报告在扫描过程中数值微分的左侧与解析计算的右侧之间的最大绝对差异。差异以秒为单位，表示为一个实数小数值。\n\n测试套件规范：\n- 测试 1 (多谐振基准)：\n  - $Z_0 = 50 \\ \\Omega$，\n  - $G = 1/200 \\ \\text{S}$，\n  - 两个并联 $L C$ 支路，谐振频率为 $f_1 = 1.2 \\times 10^9 \\ \\text{Hz}$ 和 $f_2 = 2.2 \\times 10^9 \\ \\text{Hz}$，电容为 $C_1 = 0.8 \\times 10^{-12} \\ \\text{F}$ 和 $C_2 = 0.4 \\times 10^{-12} \\ \\text{F}$，电感选择为 $L_k = \\frac{1}{(2 \\pi f_k)^2 C_k}$，其中 $k \\in \\{1,2\\}$。\n  - 扫描：$f_{\\min} = 0.5 \\times 10^9 \\ \\text{Hz}$，$f_{\\max} = 3.0 \\times 10^9 \\ \\text{Hz}$，$N = 2001$。\n- 测试 2 (单谐振，弱耦合)：\n  - $Z_0 = 50 \\ \\Omega$，\n  - $G = 1/1000 \\ \\text{S}$，\n  - 一个并联 $L C$ 支路，其中 $f_1 = 1.5 \\times 10^9 \\ \\text{Hz}$，$C_1 = 0.6 \\times 10^{-12} \\ \\text{F}$，$L_1 = \\frac{1}{(2 \\pi f_1)^2 C_1}$。\n  - 扫描：$f_{\\min} = 0.5 \\times 10^9 \\ \\text{Hz}$，$f_{\\max} = 3.0 \\times 10^9 \\ \\text{Hz}$，$N = 2001$。\n- 测试 3 (多谐振，不同参考)：\n  - $Z_0 = 75 \\ \\Omega$，\n  - $G = 1/300 \\ \\text{S}$，\n  - 三个并联 $L C$ 支路，谐振频率为 $f_1 = 0.8 \\times 10^9 \\ \\text{Hz}$，$f_2 = 1.6 \\times 10^9 \\ \\text{Hz}$，$f_3 = 2.4 \\times 10^9 \\ \\text{Hz}$，每个支路的电容均为 $C_k = 0.5 \\times 10^{-12} \\ \\text{F}$，电感为 $L_k = \\frac{1}{(2 \\pi f_k)^2 C_k}$，其中 $k \\in \\{1,2,3\\}$。\n  - 扫描：$f_{\\min} = 0.4 \\times 10^9 \\ \\text{Hz}$，$f_{\\max} = 3.0 \\times 10^9 \\ \\text{Hz}$，$N = 2001$。\n\n角度单位：弧度。频率单位：赫兹。角频率单位：弧度/秒。差异单位：秒。为保证数值稳定性，请确保在进行数值微分之前使用解卷相位。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含测试 1–3 的三个差异，形式为方括号括起来的逗号分隔列表，例如 `\"[d_1,d_2,d_3]\"`，其中每个 $d_k$ 是测试 $k$ 在其扫描范围内的最大绝对差异（以秒为单位），表示为标准十进制浮点数。",
            "solution": "此问题要求推导并数值验证单端口网络中反射系数相位的频率导数 $d\\phi(\\omega)/d\\omega$ 与储存的无功电能之间的关系。推导过程必须基于指定的第一性原理。\n\n**任务 1：推导**\n\n推导过程分几步进行，从所提供的基本定义开始。\n\n设单端口网络的输入阻抗为 $Z(\\omega)$，实数参考阻抗为 $Z_0$。反射系数 $\\Gamma(\\omega)$ 定义为：\n$$\n\\Gamma(\\omega) = \\frac{Z(\\omega) - Z_0}{Z(\\omega) + Z_0}\n$$\n反射系数的相位为 $\\phi(\\omega) = \\arg \\Gamma(\\omega)$。对于复函数 $f(x)$ 的辐角求导，有一个通用的数学恒等式 $\\frac{d}{dx}\\arg(f(x)) = \\operatorname{Im}\\left(\\frac{1}{f(x)}\\frac{df(x)}{dx}\\right)$。将此应用于 $\\phi(\\omega)$，我们得到：\n$$\n\\frac{d\\phi(\\omega)}{d\\omega} = \\operatorname{Im}\\left( \\frac{1}{\\Gamma(\\omega)} \\frac{d\\Gamma(\\omega)}{d\\omega} \\right)\n$$\n接下来，我们使用商法则和链式法则计算 $\\Gamma(\\omega)$ 对角频率 $\\omega$ 的导数：\n$$\n\\frac{d\\Gamma(\\omega)}{d\\omega} = \\frac{d}{d\\omega}\\left( \\frac{Z(\\omega) - Z_0}{Z(\\omega) + Z_0} \\right) = \\frac{\\frac{dZ(\\omega)}{d\\omega}(Z(\\omega) + Z_0) - (Z(\\omega) - Z_0)\\frac{dZ(\\omega)}{d\\omega}}{(Z(\\omega) + Z_0)^2}\n$$\n化简分子，我们得到：\n$$\n\\frac{d\\Gamma(\\omega)}{d\\omega} = \\frac{2 Z_0 \\frac{dZ(\\omega)}{d\\omega}}{(Z(\\omega) + Z_0)^2}\n$$\n现在，将 $\\frac{d\\Gamma(\\omega)}{d\\omega}$ 的这个表达式代回到 $\\frac{d\\phi(\\omega)}{d\\omega}$ 的方程中：\n$$\n\\frac{d\\phi(\\omega)}{d\\omega} = \\operatorname{Im}\\left( \\frac{Z(\\omega) + Z_0}{Z(\\omega) - Z_0} \\cdot \\frac{2 Z_0 \\frac{dZ(\\omega)}{d\\omega}}{(Z(\\omega) + Z_0)^2} \\right) = \\operatorname{Im}\\left( \\frac{2 Z_0 \\frac{dZ(\\omega)}{d\\omega}}{(Z(\\omega) - Z_0)(Z(\\omega) + Z_0)} \\right)\n$$\n这可以简化为：\n$$\n\\frac{d\\phi(\\omega)}{d\\omega} = \\operatorname{Im}\\left( \\frac{2 Z_0 \\frac{dZ(\\omega)}{d\\omega}}{Z(\\omega)^2 - Z_0^2} \\right)\n$$\n下一步是用导纳参数表示 $\\frac{dZ(\\omega)}{d\\omega}$。该网络由其输入导纳 $Y(\\omega) = G + jB(\\omega)$ 表征，其中 $G$ 是一个常数电导，$B(\\omega)$ 是电纳。阻抗为 $Z(\\omega) = 1/Y(\\omega)$。对 $Z(\\omega)$ 关于 $\\omega$ 求导：\n$$\n\\frac{dZ(\\omega)}{d\\omega} = \\frac{d}{d\\omega}\\left( \\frac{1}{Y(\\omega)} \\right) = -\\frac{1}{Y(\\omega)^2} \\frac{dY(\\omega)}{d\\omega}\n$$\n导纳的导数为 $\\frac{dY(\\omega)}{d\\omega} = \\frac{d}{d\\omega}(G + jB(\\omega))$。由于 $G$ 是常数（$dG/d\\omega = 0$），这变为 $\\frac{dY(\\omega)}{d\\omega} = j \\frac{dB(\\omega)}{d\\omega}$。将此代入 $\\frac{dZ(\\omega)}{d\\omega}$ 的表达式中：\n$$\n\\frac{dZ(\\omega)}{d\\omega} = -\\frac{1}{Y(\\omega)^2} \\left( j \\frac{dB(\\omega)}{d\\omega} \\right) = -j Z(\\omega)^2 \\frac{dB(\\omega)}{d\\omega}\n$$\n我们现在将 $\\frac{dZ(\\omega)}{d\\omega}$ 的这个结果代入到 $\\frac{d\\phi(\\omega)}{d\\omega}$ 的表达式中：\n$$\n\\frac{d\\phi(\\omega)}{d\\omega} = \\operatorname{Im}\\left( \\frac{2 Z_0 \\left(-j Z(\\omega)^2 \\frac{dB(\\omega)}{d\\omega}\\right)}{Z(\\omega)^2 - Z_0^2} \\right)\n$$\n由于 $Z_0$ 和 $\\frac{dB(\\omega)}{d\\omega}$ 是实数值，我们可以将它们从虚部算子中提出来：\n$$\n\\frac{d\\phi(\\omega)}{d\\omega} = -2 Z_0 \\frac{dB(\\omega)}{d\\omega} \\operatorname{Im}\\left( \\frac{j Z(\\omega)^2}{Z(\\omega)^2 - Z_0^2} \\right)\n$$\n使用恒等式 $\\operatorname{Im}(j A) = \\operatorname{Re}(A)$（对于任何复数 $A$），我们得到最终表达式：\n$$\n\\frac{d\\phi(\\omega)}{d\\omega} = -2 Z_0 \\frac{dB(\\omega)}{d\\omega} \\operatorname{Re}\\left( \\frac{Z(\\omega)^2}{Z(\\omega)^2 - Z_0^2} \\right)\n$$\n这就是所求的关系。它将反射相位的导数 $\\frac{d\\phi(\\omega)}{d\\omega}$ 与电纳的导数 $\\frac{dB(\\omega)}{d\\omega}$、网络的阻抗 $Z(\\omega)$ 以及参考阻抗 $Z_0$ 联系起来。此表达式不依赖于端口电压 $V(\\omega)$。\n\n与储存能量 $W(\\omega)$ 的联系由Foster电抗定理给出：$W(\\omega) = \\frac{1}{4} \\frac{d B(\\omega)}{d \\omega} |V(\\omega)|^2$。推导出的公式包含 $\\frac{dB(\\omega)}{d\\omega}$，该项正比于储存能量与端口电压幅值平方之比。\n\n**任务 2：数值验证**\n\n为验证此推导关系，我们将对三个指定的测试案例，数值计算最终方程的左侧（LHS）和右侧（RHS），并测量它们之间的差异。\n\n对于每个测试案例，我们执行从 $f_{\\min}$ 到 $f_{\\max}$ 的频率扫描，共 $N$ 个点。在扫描中的每个角频率 $\\omega = 2 \\pi f$ 处，我们计算：\n1.  每个并联 $LC$ 支路的电纳：$B_k(\\omega) = \\omega C_k - \\frac{1}{\\omega L_k}$。\n2.  总电纳：$B(\\omega) = \\sum_k B_k(\\omega)$。\n3.  总输入导纳：$Y(\\omega) = G + jB(\\omega)$。\n4.  总输入阻抗：$Z(\\omega) = 1/Y(\\omega)$。\n5.  反射系数：$\\Gamma(\\omega) = \\frac{Z(\\omega) - Z_0}{Z(\\omega) + Z_0}$。\n\n**左侧（LHS）计算：** LHS，即 $\\frac{d\\phi(\\omega)}{d\\omega}$，通过数值方法计算。\n首先，计算扫描中所有频率的相位 $\\phi(\\omega) = \\arg \\Gamma(\\omega)$。为处理 $2\\pi$ 的相位跳变，对得到的相位数组进行解卷。然后，计算解卷相位相对于 $\\omega$ 的中心差分数值导数。这可以通过使用 `numpy.gradient` 对解卷相位和角频率数组实现。\n\n**右侧（RHS）计算：** RHS，即 $-2 Z_0 \\frac{dB(\\omega)}{d\\omega} \\operatorname{Re}\\left( \\frac{Z(\\omega)^2}{Z(\\omega)^2 - Z_0^2} \\right)$，在每个频率点上进行解析计算。\n项 $\\frac{dB(\\omega)}{d\\omega}$ 根据其对Foster网络的解析定义计算：\n$$\n\\frac{dB(\\omega)}{d\\omega} = \\sum_k \\left( C_k + \\frac{1}{\\omega^2 L_k} \\right)\n$$\n阻抗 $Z(\\omega)$ 从网络模型中已知。然后使用这些值计算整个RHS表达式。\n\n**差异：** 在整个频率扫描范围内，找到数值计算的LHS和解析计算的RHS之间的最大绝对差值。这个值以秒为单位，是衡量推导有效性和数值方法准确性的一个指标。\n\n以下程序为三个指定的测试网络实现了这一验证过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically validates a relation between the reflection coefficient phase slope\n    and stored reactive energy for passive one-port networks.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"Z0\": 50.0,\n            \"G\": 1.0 / 200.0,\n            \"branches\": [\n                {\"f\": 1.2e9, \"C\": 0.8e-12},\n                {\"f\": 2.2e9, \"C\": 0.4e-12},\n            ],\n            \"sweep\": {\"f_min\": 0.5e9, \"f_max\": 3.0e9, \"N\": 2001},\n        },\n        {\n            \"Z0\": 50.0,\n            \"G\": 1.0 / 1000.0,\n            \"branches\": [\n                {\"f\": 1.5e9, \"C\": 0.6e-12},\n            ],\n            \"sweep\": {\"f_min\": 0.5e9, \"f_max\": 3.0e9, \"N\": 2001},\n        },\n        {\n            \"Z0\": 75.0,\n            \"G\": 1.0 / 300.0,\n            \"branches\": [\n                {\"f\": 0.8e9, \"C\": 0.5e-12},\n                {\"f\": 1.6e9, \"C\": 0.5e-12},\n                {\"f\": 2.4e9, \"C\": 0.5e-12},\n            ],\n            \"sweep\": {\"f_min\": 0.4e9, \"f_max\": 3.0e9, \"N\": 2001},\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        Z0 = case[\"Z0\"]\n        G = case[\"G\"]\n        f_min = case[\"sweep\"][\"f_min\"]\n        f_max = case[\"sweep\"][\"f_max\"]\n        N = case[\"sweep\"][\"N\"]\n\n        # Calculate inductance L_k for each branch to achieve the specified resonance\n        branch_params = []\n        for branch_spec in case[\"branches\"]:\n            f_k = branch_spec[\"f\"]\n            C_k = branch_spec[\"C\"]\n            omega_k = 2 * np.pi * f_k\n            L_k = 1 / (omega_k**2 * C_k)\n            branch_params.append({\"L\": L_k, \"C\": C_k})\n\n        # Generate frequency and angular frequency sweeps\n        f_sweep = np.linspace(f_min, f_max, N, dtype=np.float64)\n        omega_sweep = 2 * np.pi * f_sweep\n\n        # Calculate network properties across the frequency sweep\n        B_sweep = np.zeros_like(omega_sweep)\n        dB_domega_sweep = np.zeros_like(omega_sweep)\n\n        for params in branch_params:\n            L_k, C_k = params[\"L\"], params[\"C\"]\n            B_sweep += omega_sweep * C_k - 1.0 / (omega_sweep * L_k)\n            dB_domega_sweep += C_k + 1.0 / (omega_sweep**2 * L_k)\n\n        Y_sweep = G + 1j * B_sweep\n        Z_sweep = 1.0 / Y_sweep\n        Gamma_sweep = (Z_sweep - Z0) / (Z_sweep + Z0)\n\n        # --- Left-Hand Side (LHS) Calculation: Numerical Derivative ---\n        phi_sweep = np.angle(Gamma_sweep)\n        phi_unwrapped = np.unwrap(phi_sweep)\n        dphi_domega_numerical = np.gradient(phi_unwrapped, omega_sweep)\n\n        # --- Right-Hand Side (RHS) Calculation: Analytical Expression ---\n        # The derived expression is: d(phi)/d(omega) = -2*Z0 * dB/d(omega) * Re[Z^2 / (Z^2 - Z0^2)]\n        real_term = np.real(Z_sweep**2 / (Z_sweep**2 - Z0**2))\n        dphi_domega_analytical = -2.0 * Z0 * dB_domega_sweep * real_term\n\n        # --- Discrepancy Calculation ---\n        # Compute the maximum absolute discrepancy between the numerical and analytical results\n        discrepancy = np.abs(dphi_domega_numerical - dphi_domega_analytical)\n        max_discrepancy = np.max(discrepancy)\n        results.append(max_discrepancy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}