{
    "hands_on_practices": [
        {
            "introduction": "将理论转化为实践的第一步是应用核心概念来解决基本问题。在时谐电磁学中，一个关键概念是位移电流，它由James Clerk Maxwell提出，是连接电场变化与磁场的桥梁。本练习将引导您使用相量法来分析导体中传导电流和位移电流的相对重要性()。通过这个计算，您将亲身体会到频率和材料属性（如电导率 $\\sigma$ 和介电常数 $\\epsilon$）如何决定哪种电流在特定情况下占主导地位，这是理解高频电路和波在有损媒质中传播行为的基础。",
            "id": "544816",
            "problem": "一个半径为 $a$ 的非常长的实心圆柱形导体，由一种非磁性欧姆材料制成，其特性由与频率无关的电导率 $\\sigma$ 和介电常数 $\\epsilon$ 决定。导体的磁导率与自由空间磁导率相同，为 $\\mu_0$。该导体被置于一个时变电磁场中，导致其表面产生一个轴向电场，由 $\\mathbf{E}(r=a, t) = E_a \\cos(\\omega t) \\hat{\\mathbf{z}}$ 给出，其中 $E_a$ 是表面处的场振幅，$\\omega$ 是角频率，$\\hat{\\mathbf{z}}$ 是沿圆柱轴线的单位向量。\n\n由于电导率和场的时变特性，导体内部同时存在传导电流密度 $\\mathbf{J}_C$ 和位移电流密度 $\\mathbf{J}_D$。总电流密度为 $\\mathbf{J} = \\mathbf{J}_C + \\mathbf{J}_D$。\n\n确定在导体内部任意径向位置 $r$（$0 \\le r \\le a$）处，位移电流密度振幅与传导电流密度振幅之比 $\\frac{|\\mathbf{J}_{D, \\text{amp}}|}{|\\mathbf{J}_{C, \\text{amp}}|}$。",
            "solution": "1. 导体内部的相关定义：\n   $$\\mathbf{J}_C=\\sigma\\,\\mathbf{E},\\qquad \n     \\mathbf{J}_D=\\frac{\\partial \\mathbf{D}}{\\partial t} \n     =\\epsilon\\,\\frac{\\partial \\mathbf{E}}{\\partial t}\\,. $$\n\n2. 将任意 $r$ 处的轴向电场写为\n   $$\\mathbf{E}(r,t)=E(r)\\cos(\\omega t)\\,\\hat{\\mathbf z}\\,. $$\n\n3. 传导电流密度：\n   $$\\mathbf{J}_C(r,t)\n     =\\sigma\\,E(r)\\cos(\\omega t)\\,\\hat{\\mathbf z},$$\n   所以其振幅为\n   $$|\\mathbf{J}_{C,\\text{amp}}|=\\sigma\\,E(r)\\,. $$\n\n4. 位移电流密度：\n   $$\\mathbf{J}_D(r,t)\n     =\\epsilon\\,\\frac{\\partial}{\\partial t}\\bigl[E(r)\\cos(\\omega t)\\bigr]\\hat{\\mathbf z}\n     =-\\epsilon\\,\\omega\\,E(r)\\sin(\\omega t)\\,\\hat{\\mathbf z},$$\n   所以其振幅为\n   $$|\\mathbf{J}_{D,\\text{amp}}|=\\omega\\,\\epsilon\\,E(r)\\,. $$\n\n5. 任意 $r$ 处的振幅比：\n   $$\\frac{|\\mathbf{J}_{D,\\text{amp}}|}{|\\mathbf{J}_{C,\\text{amp}}|}\n     =\\frac{\\omega\\,\\epsilon\\,E(r)}{\\sigma\\,E(r)}\n     =\\frac{\\omega\\,\\epsilon}{\\sigma}\\,. $$",
            "answer": "$$\\boxed{\\frac{\\omega\\,\\epsilon}{\\sigma}}$$"
        },
        {
            "introduction": "在科学计算中，数学形式的严谨性至关重要。相量表示法（无论是 $\\exp(j\\omega t)$ 还是 $\\exp(-j\\omega t)$）是一种约定，但选择一种后必须在整个分析中保持一致。这个思想实验旨在通过一个引人注目的例子，揭示混合使用不同时间约定的严重后果()。您将推导一个偶极子天线的辐射电阻，并看到一个微小的不一致——在一个步骤中错误地使用了相反约定的麦克斯韦方程——如何导致一个完全违背物理直觉的负辐射电阻的结论。这个练习是一个深刻的警示，强调了在电磁理论和建模中保持形式一致性的绝对必要性。",
            "id": "3356064",
            "problem": "计算电磁学中的一个核心困难源于对时谐相量约定的不一致使用，以及由此导致的频域 Maxwell 方程中的符号变化。考虑在磁导率为 $\\mu$、介电常数为 $\\epsilon$ 的均匀无源区域中的时域 Maxwell 方程：$\\nabla \\times \\mathbf{E}(\\mathbf{r},t) = -\\partial \\mathbf{B}(\\mathbf{r},t)/\\partial t$ 和 $\\nabla \\times \\mathbf{H}(\\mathbf{r},t) = \\partial \\mathbf{D}(\\mathbf{r},t)/\\partial t$，其中 $\\mathbf{B} = \\mu \\mathbf{H}$ 且 $\\mathbf{D} = \\epsilon \\mathbf{E}$。对于时间依赖性，使用两种标准的相量约定：$\\exp(j\\omega t)$ 和 $\\exp(-j\\omega t)$。从这些定律和相量的定义出发，确定在每种约定下旋度方程的形式，并要特别注意 $j$ 的符号。\n\n现在，设计一个思想实验来揭示误用约定的后果。考虑一个长度为 $\\ell$、沿 $z$ 轴排列的细直、中心馈电的理想电导体（PEC）偶极子，其中 $\\ell \\ll \\lambda$，$\\lambda$ 为自由空间波长。设馈电电流为振幅为 $I_0$ 的时谐相量，并沿导线段均匀分布。从 Maxwell 方程和辐射区近似出发，当使用正确的 $\\exp(j\\omega t)$约定时，推导辐射场的远场相量表达式，并用它们通过 Poynting 矢量计算时间平均辐射功率，以及在馈电点观察到的相应辐射电阻 $R_{\\mathrm{rad}}$。然后，构建误用情况：保持在 $\\exp(j\\omega t)$ 约定下获得的辐射 $\\mathbf{E}$ 场表达式，但使用由选择相反的 $\\exp(-j\\omega t)$ 约定得出的频域旋度方程来关联 $\\mathbf{H}$ 与 $\\mathbf{E}$。使用标准的时间平均功率表达式，说明这种不一致性如何导致对于相同几何结构预测出负的辐射电阻。\n\n将差异定义为 $\\Delta R = R_{\\mathrm{wrong}} - R_{\\mathrm{correct}}$，其中 $R_{\\mathrm{wrong}}$ 是在上述误用情况下预测的辐射电阻，而 $R_{\\mathrm{correct}}$ 是在一致使用 $\\exp(j\\omega t)$ 约定下推导出的辐射电阻。对于自由空间中 $f = 300\\,\\mathrm{MHz}$、$\\ell = 0.05\\,\\mathrm{m}$ 的偶极子，计算 $\\Delta R$ 的值，并以欧姆为单位表示最终结果。将您的答案四舍五入到四位有效数字。您可以取自由空间本征阻抗为 $\\eta_0 = 120\\pi$，波数为 $k = 2\\pi/\\lambda$，其中 $\\lambda = c/f$。您必须从 Maxwell 方程和相量定义出发，推导所有需要的关系，不得使用快捷公式。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是良定的且客观的。\n\n### 步骤1：提取已知条件\n- 均匀无源区域中的时域 Maxwell 方程：$\\nabla \\times \\mathbf{E}(\\mathbf{r},t) = -\\partial \\mathbf{B}(\\mathbf{r},t)/\\partial t$ 和 $\\nabla \\times \\mathbf{H}(\\mathbf{r},t) = \\partial \\mathbf{D}(\\mathbf{r},t)/\\partial t$。\n- 本构关系：$\\mathbf{B} = \\mu \\mathbf{H}$ 和 $\\mathbf{D} = \\epsilon \\mathbf{E}$。\n- 时间依赖性的相量约定：$\\exp(j\\omega t)$ 和 $\\exp(-j\\omega t)$。\n- 天线：长度为 $\\ell$、沿 $z$ 轴排列的细直、中心馈电、理想电导体（PEC）偶极子。\n- 条件：$\\ell \\ll \\lambda$，其中 $\\lambda$ 是自由空间波长。\n- 源：馈电电流是振幅为 $I_0$ 的时谐相量，沿导线均匀分布。\n- 任务1（正确）：使用 $\\exp(j\\omega t)$ 约定推导辐射场的远场相量，计算时间平均辐射功率，并求出辐射电阻 $R_{\\mathrm{correct}}$。\n- 任务2（误用）：保留任务1中的 $\\mathbf{E}$ 场，但使用来自 $\\exp(-j\\omega t)$ 约定的旋度方程来关联 $\\mathbf{H}$ 与 $\\mathbf{E}$。使用标准的时间平均功率表达式求出由此产生的辐射电阻 $R_{\\mathrm{wrong}}$。\n- 任务3（差异）：计算 $\\Delta R = R_{\\mathrm{wrong}} - R_{\\mathrm{correct}}$。\n- 数值：$f = 300\\,\\mathrm{MHz}$，$\\ell = 0.05\\,\\mathrm{m}$。\n- 常数和关系：自由空间本征阻抗 $\\eta_0 = 120\\pi$，波数 $k = 2\\pi/\\lambda$，波长 $\\lambda = c/f$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题有科学依据，基于 Maxwell 方程和天线理论。这是一个良定的思想实验，旨在说明计算电磁学中一个关于相量约定的已知关键问题。所使用的语言和要求的推导是电磁理论中的标准内容。电流“均匀分布”的假设是一种理想化，对应于 Hertzian 偶极子模型，这是对短偶极子（$\\ell \\ll \\lambda$）的一个有效且标准的近似。该问题是自洽的，推导和数值计算所需的所有数据均已提供。不存在矛盾、歧义或不科学的前提。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n\n我们首先为两种指定的时谐约定建立 Maxwell 旋度方程的频域（相量）形式。\n\n设一个一般的时谐矢量场为 $\\mathbf{F}(\\mathbf{r},t)$。\n1.  **约定1：$e^{j\\omega t}$ 时间依赖性。**\n    场表示为 $\\mathbf{F}(\\mathbf{r},t) = \\mathrm{Re}[\\tilde{\\mathbf{F}}(\\mathbf{r}) e^{j\\omega t}]$。时间导数算子变为 $\\frac{\\partial}{\\partial t} \\rightarrow j\\omega$。\n    Maxwell 方程的相量形式为：\n    $$ \\nabla \\times \\tilde{\\mathbf{E}} = -j\\omega\\tilde{\\mathbf{B}} = -j\\omega\\mu\\tilde{\\mathbf{H}} $$\n    $$ \\nabla \\times \\tilde{\\mathbf{H}} = j\\omega\\tilde{\\mathbf{D}} = j\\omega\\epsilon\\tilde{\\mathbf{E}} $$\n\n2.  **约定2：$e^{-j\\omega t}$ 时间依赖性。**\n    场表示为 $\\mathbf{F}(\\mathbf{r},t) = \\mathrm{Re}[\\tilde{\\mathbf{F}}(\\mathbf{r}) e^{-j\\omega t}]$。时间导数算子变为 $\\frac{\\partial}{\\partial t} \\rightarrow -j\\omega$。\n    Maxwell 方程的相量形式为：\n    $$ \\nabla \\times \\tilde{\\mathbf{E}} = -(-j\\omega\\tilde{\\mathbf{B}}) = j\\omega\\mu\\tilde{\\mathbf{H}} $$\n    $$ \\nabla \\times \\tilde{\\mathbf{H}} = (-j\\omega\\tilde{\\mathbf{D}}) = -j\\omega\\epsilon\\tilde{\\mathbf{E}} $$\n    一个关键后果是方程虚部的符号变化。\n\n**第一部分：$\\exp(j\\omega t)$ 约定的正确推导**\n\n我们推导一个具有均匀电流 $I_0$ 的短而细的偶极子所辐射的场。这种结构被称为 Hertzian 偶极子。电流密度相量为 $\\tilde{\\mathbf{J}}(\\mathbf{r}') = I_0 \\delta(x')\\delta(y')\\hat{\\mathbf{z}}$，其中 $z' \\in [-\\ell/2, \\ell/2]$。矢量势 $\\tilde{\\mathbf{A}}$ 可由 Helmholtz 方程求得，其在自由空间中的解是推迟势积分：\n$$ \\tilde{\\mathbf{A}}(\\mathbf{r}) = \\frac{\\mu_0}{4\\pi} \\int_V \\frac{\\tilde{\\mathbf{J}}(\\mathbf{r}') e^{-jkR}}{R} dV' $$\n其中 $R=|\\mathbf{r}-\\mathbf{r}'|$，$k = \\omega/c = \\omega\\sqrt{\\mu_0\\epsilon_0}$ 是自由空间波数。\n\n在远场区（$r \\gg \\ell, r \\gg \\lambda$），我们在分母中近似 $R \\approx r$，在指数中近似 $R \\approx r - \\mathbf{r}'\\cdot\\hat{\\mathbf{r}}$。对于一个沿 $z$ 轴排列的偶极子，$\\mathbf{r}'\\cdot\\hat{\\mathbf{r}} = z'\\cos\\theta$。\n$$ \\tilde{\\mathbf{A}}(\\mathbf{r}) \\approx \\frac{\\mu_0}{4\\pi} \\frac{e^{-jkr}}{r} \\int_{-\\ell/2}^{\\ell/2} (I_0 \\hat{\\mathbf{z}}) e^{jkz'\\cos\\theta} dz' $$\n由于 $\\ell \\ll \\lambda$，$k\\ell \\ll 1$，因此对于偶极子上的所有 $z'$，都有 $kz'\\cos\\theta \\ll 1$。我们可以近似 $e^{jkz'\\cos\\theta} \\approx 1$。\n$$ \\tilde{\\mathbf{A}}(\\mathbf{r}) \\approx \\frac{\\mu_0 I_0 \\hat{\\mathbf{z}}}{4\\pi r} e^{-jkr} \\int_{-\\ell/2}^{\\ell/2} dz' = \\frac{\\mu_0 I_0 \\ell}{4\\pi r} e^{-jkr} \\hat{\\mathbf{z}} $$\n接下来，我们使用 $\\tilde{\\mathbf{H}} = \\frac{1}{\\mu_0}\\nabla \\times \\tilde{\\mathbf{A}}$ 来求磁场相量 $\\tilde{\\mathbf{H}}_{\\mathrm{correct}}$。在球坐标系中，$\\hat{\\mathbf{z}} = \\hat{\\mathbf{r}}\\cos\\theta - \\hat{\\mathbf{\\theta}}\\sin\\theta$。\n$$ \\tilde{A}_r = \\tilde{A}_z \\cos\\theta = \\frac{\\mu_0 I_0 \\ell}{4\\pi r} e^{-jkr} \\cos\\theta $$\n$$ \\tilde{A}_\\theta = -\\tilde{A}_z \\sin\\theta = -\\frac{\\mu_0 I_0 \\ell}{4\\pi r} e^{-jkr} \\sin\\theta $$\n球坐标系中的旋度给出一个非零的 $\\phi$ 分量：$\\tilde{H}_\\phi = \\frac{1}{\\mu_0 r} (\\frac{\\partial}{\\partial r}(r\\tilde{A}_\\theta) - \\frac{\\partial \\tilde{A}_r}{\\partial\\theta})$。在远场区，我们只保留 $1/r$ 阶的项：\n$$ \\frac{\\partial}{\\partial r}(r\\tilde{A}_\\theta) = \\frac{\\partial}{\\partial r} \\left(-\\frac{\\mu_0 I_0 \\ell}{4\\pi} e^{-jkr} \\sin\\theta\\right) = \\frac{j k \\mu_0 I_0 \\ell}{4\\pi} e^{-jkr} \\sin\\theta $$\n项 $\\partial \\tilde{A}_r/\\partial\\theta$ 产生 $1/r^2$ 的依赖关系，因此被忽略。于是：\n$$ \\tilde{\\mathbf{H}}_{\\mathrm{correct}} = \\hat{\\mathbf{\\phi}} \\tilde{H}_\\phi \\approx \\hat{\\mathbf{\\phi}} \\frac{1}{\\mu_0 r} \\left( \\frac{j k \\mu_0 I_0 \\ell}{4\\pi} e^{-jkr} \\sin\\theta \\right) = \\hat{\\mathbf{\\phi}} \\frac{j k I_0 \\ell}{4\\pi r} e^{-jkr} \\sin\\theta $$\n电场相量 $\\tilde{\\mathbf{E}}_{\\mathrm{correct}}$ 可由 $\\nabla \\times \\tilde{\\mathbf{H}} = j\\omega\\epsilon_0\\tilde{\\mathbf{E}}$ 求得。在远场区，这简化为平面波关系 $\\tilde{\\mathbf{E}} = -\\eta_0 (\\hat{\\mathbf{r}} \\times \\tilde{\\mathbf{H}})$，其中 $\\eta_0 = \\sqrt{\\mu_0/\\epsilon_0}$。\n$$ \\tilde{\\mathbf{E}}_{\\mathrm{correct}} = -\\eta_0 (\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{\\phi}} \\tilde{H}_\\phi) = \\eta_0 \\tilde{H}_\\phi \\hat{\\mathbf{\\theta}} = \\hat{\\mathbf{\\theta}} \\eta_0 \\frac{j k I_0 \\ell}{4\\pi r} e^{-jkr} \\sin\\theta $$\n时间平均 Poynting 矢量为 $\\langle \\mathbf{S} \\rangle = \\frac{1}{2}\\mathrm{Re}[\\tilde{\\mathbf{E}} \\times \\tilde{\\mathbf{H}}^*]$。\n$$ \\langle \\mathbf{S} \\rangle_{\\mathrm{correct}} = \\frac{1}{2}\\mathrm{Re}[(\\hat{\\mathbf{\\theta}} \\eta_0 \\tilde{H}_\\phi) \\times (\\hat{\\mathbf{\\phi}} \\tilde{H}_\\phi^*)] = \\frac{1}{2}\\mathrm{Re}[\\hat{\\mathbf{r}} \\eta_0 |\\tilde{H}_\\phi|^2] = \\hat{\\mathbf{r}} \\frac{\\eta_0}{2} |\\tilde{H}_\\phi|^2 $$\n$$ |\\tilde{H}_\\phi|^2 = \\left| \\frac{j k I_0 \\ell}{4\\pi r} e^{-jkr} \\sin\\theta \\right|^2 = \\left( \\frac{k I_0 \\ell}{4\\pi r} \\sin\\theta \\right)^2 $$\n$$ \\langle \\mathbf{S} \\rangle_{\\mathrm{correct}} = \\hat{\\mathbf{r}} \\frac{\\eta_0}{2} \\left( \\frac{k I_0 \\ell}{4\\pi r} \\right)^2 \\sin^2\\theta $$\n总辐射功率 $P_{\\mathrm{correct}}$ 是 $\\langle \\mathbf{S} \\rangle_{\\mathrm{correct}}$ 在球面上的积分。\n$$ P_{\\mathrm{correct}} = \\oint_S \\langle \\mathbf{S} \\rangle_{\\mathrm{correct}} \\cdot d\\mathbf{S} = \\int_0^{2\\pi} \\int_0^\\pi \\left( \\frac{\\eta_0 k^2 I_0^2 \\ell^2}{32\\pi^2 r^2} \\sin^2\\theta \\right) r^2 \\sin\\theta d\\theta d\\phi $$\n$$ P_{\\mathrm{correct}} = \\frac{\\eta_0 k^2 I_0^2 \\ell^2}{32\\pi^2} (2\\pi) \\int_0^\\pi \\sin^3\\theta d\\theta $$\n积分为 $\\int_0^\\pi \\sin^3\\theta d\\theta = 4/3$。\n$$ P_{\\mathrm{correct}} = \\frac{\\eta_0 k^2 I_0^2 \\ell^2}{16\\pi} \\left(\\frac{4}{3}\\right) = \\frac{\\eta_0 k^2 I_0^2 \\ell^2}{12\\pi} $$\n辐射电阻 $R_{\\mathrm{correct}}$ 由 $P_{\\mathrm{correct}} = \\frac{1}{2}I_0^2 R_{\\mathrm{correct}}$ 定义。\n$$ R_{\\mathrm{correct}} = \\frac{2P_{\\mathrm{correct}}}{I_0^2} = \\frac{2}{I_0^2} \\left( \\frac{\\eta_0 k^2 I_0^2 \\ell^2}{12\\pi} \\right) = \\frac{\\eta_0 k^2 \\ell^2}{6\\pi} $$\n\n**第二部分：不一致的“误用”情况**\n\n根据指令，我们保持 $\\tilde{\\mathbf{E}}_{\\mathrm{wrong}} = \\tilde{\\mathbf{E}}_{\\mathrm{correct}}$，并使用来自相反的 $\\exp(-j\\omega t)$ 约定的旋度方程 $\\nabla \\times \\tilde{\\mathbf{E}} = j\\omega\\mu_0 \\tilde{\\mathbf{H}}$ 来求 $\\tilde{\\mathbf{H}}_{\\mathrm{wrong}}$。\n$$ \\tilde{\\mathbf{H}}_{\\mathrm{wrong}} = \\frac{1}{j\\omega\\mu_0} \\nabla \\times \\tilde{\\mathbf{E}}_{\\mathrm{wrong}} = \\frac{1}{j\\omega\\mu_0} \\nabla \\times \\tilde{\\mathbf{E}}_{\\mathrm{correct}} $$\n从正确的推导中，我们知道 $\\nabla \\times \\tilde{\\mathbf{E}}_{\\mathrm{correct}} = -j\\omega\\mu_0 \\tilde{\\mathbf{H}}_{\\mathrm{correct}}$。代入此式可得：\n$$ \\tilde{\\mathbf{H}}_{\\mathrm{wrong}} = \\frac{1}{j\\omega\\mu_0} (-j\\omega\\mu_0 \\tilde{\\mathbf{H}}_{\\mathrm{correct}}) = -\\tilde{\\mathbf{H}}_{\\mathrm{correct}} $$\n现在我们用这对不一致的场来计算辐射功率。\n$$ \\langle \\mathbf{S} \\rangle_{\\mathrm{wrong}} = \\frac{1}{2}\\mathrm{Re}[\\tilde{\\mathbf{E}}_{\\mathrm{wrong}} \\times \\tilde{\\mathbf{H}}_{\\mathrm{wrong}}^*] = \\frac{1}{2}\\mathrm{Re}[\\tilde{\\mathbf{E}}_{\\mathrm{correct}} \\times (-\\tilde{\\mathbf{H}}_{\\mathrm{correct}})^*] $$\n由于 $(-\\tilde{\\mathbf{H}})^* = -\\tilde{\\mathbf{H}}^*$，\n$$ \\langle \\mathbf{S} \\rangle_{\\mathrm{wrong}} = \\frac{1}{2}\\mathrm{Re}[-\\tilde{\\mathbf{E}}_{\\mathrm{correct}} \\times \\tilde{\\mathbf{H}}_{\\mathrm{correct}}^*] = -\\left( \\frac{1}{2}\\mathrm{Re}[\\tilde{\\mathbf{E}}_{\\mathrm{correct}} \\times \\tilde{\\mathbf{H}}_{\\mathrm{correct}}^*] \\right) = -\\langle \\mathbf{S} \\rangle_{\\mathrm{correct}} $$\n这意味着功率流是负的（径向向内），因此 $P_{\\mathrm{wrong}} = -P_{\\mathrm{correct}}$。由此产生的辐射电阻是：\n$$ R_{\\mathrm{wrong}} = \\frac{2P_{\\mathrm{wrong}}}{I_0^2} = \\frac{-2P_{\\mathrm{correct}}}{I_0^2} = -R_{\\mathrm{correct}} $$\n相量约定的误用导致预测出负的辐射电阻，这是一个物理上荒谬的结果，意味着天线从自由空间吸收能量。\n\n**第三部分：差异 $\\Delta R$ 的计算**\n\n差异定义为 $\\Delta R = R_{\\mathrm{wrong}} - R_{\\mathrm{correct}}$。\n$$ \\Delta R = -R_{\\mathrm{correct}} - R_{\\mathrm{correct}} = -2R_{\\mathrm{correct}} = -2 \\left( \\frac{\\eta_0 k^2 \\ell^2}{6\\pi} \\right) = -\\frac{\\eta_0 k^2 \\ell^2}{3\\pi} $$\n代入 $k = 2\\pi/\\lambda$：\n$$ \\Delta R = -\\frac{\\eta_0 (2\\pi/\\lambda)^2 \\ell^2}{3\\pi} = -\\frac{\\eta_0 (4\\pi^2/\\lambda^2) \\ell^2}{3\\pi} = -\\frac{4\\pi\\eta_0}{3} \\left(\\frac{\\ell}{\\lambda}\\right)^2 $$\n\n**数值计算**\n已知条件：\n$f = 300\\,\\mathrm{MHz} = 3 \\times 10^8\\,\\mathrm{Hz}$\n$\\ell = 0.05\\,\\mathrm{m}$\n$\\eta_0 = 120\\pi\\,\\Omega$\n真空中的光速为 $c \\approx 3 \\times 10^8\\,\\mathrm{m/s}$。\n波长为 $\\lambda = c/f = (3 \\times 10^8\\,\\mathrm{m/s}) / (3 \\times 10^8\\,\\mathrm{Hz}) = 1\\,\\mathrm{m}$。\n比值 $\\ell/\\lambda = 0.05/1 = 0.05$。\n\n现在，我们将这些值代入 $\\Delta R$ 的表达式中：\n$$ \\Delta R = -\\frac{4\\pi (120\\pi)}{3} (0.05)^2 = -160\\pi^2 (0.0025) = -0.4\\pi^2 $$\n使用计算器计算 $\\pi^2 \\approx 9.8696044$：\n$$ \\Delta R = -0.4 \\times 9.8696044 \\approx -3.94784176\\,\\Omega $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\Delta R \\approx -3.948\\,\\Omega $$",
            "answer": "$$ \\boxed{-3.948} $$"
        },
        {
            "introduction": "相量不仅简化了分析，也为强大的计算工具铺平了道路。角谱法（或称平面波谱法）就是这样一种技术，它将任意波场分解为一系列沿不同方向传播的平面波，从而模拟波的衍射和传播。这个计算练习将指导您实现一维角谱传播模型，以探索波场如何从一个亚波长孔径向外传播()。您将学习如何区分携带能量到远场的传播波和在近场中携带高分辨率信息并随距离指数衰减的倏逝波。通过数值比较包含和不包含倏逝波的重建结果，您将直观地理解为什么近场光学能够突破衍射极限，实现亚波长成像。",
            "id": "3356119",
            "problem": "要求您实现一个时谐电磁场相量在亚波长双高斯孔径后的一维角谱传播，并量化倏逝分量的影响。假设场是标量且线性偏振，因此标量表示是有效的，介质是均匀、各向同性、无损耗的，且折射率等于1。时间相关性是角频率为 $\\,\\omega\\,$ 的谐波，并使用相量约定来省略。推导必须从频域麦克斯韦方程组开始，导出标量亥姆霍兹方程和与辐射条件一致的平面波（角）谱表示。您不能假设任何预先引用的传播公式；相反，您必须通过第一性原理确定该表示，然后使用离散傅里叶变换进行数值实现。\n\n在横向维度 $\\,x\\,$ 和纵向传播方向 $\\,z \\ge 0\\,$ 上实现以下数值实验：\n\n- 物理常数和单位：\n  - 使用光速 $\\,c = 2.99792458\\times 10^{8}\\,\\mathrm{m/s}\\,$。\n  - 所有长度单位必须是米，空间频率单位是弧度/米，频率单位是赫兹。没有需要报告的角度；所有内部计算均使用弧度。\n- $\\,z=0\\,$ 处的孔径场：\n  - 入射标量相量场是一个对称双高斯函数，\n    $$E(x,0) \\equiv E_0(x) = \\exp\\!\\left(-\\frac{(x - d/2)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x + d/2)^2}{2\\sigma^2}\\right)。$$\n  - 在所提供的测试中，间距 $\\,d\\,$ 严格为亚波长。\n- 角谱传播任务：\n  - 从波数为 $\\,k = 2\\pi/\\lambda\\,$ 的均匀介质的标量亥姆霍兹方程出发，推导与辐射条件一致的唯一平面波谱表示，并用它将 $\\,E_0(x)\\,$ 传播到距离 $\\,z>0\\,$ 的观察平面，产生包含传播分量和倏逝分量的 $\\,E_{\\mathrm{full}}(x,z)\\,$。\n  - 通过抑制所有倏逝分量同时保留所有传播分量，构建一个截断谱近似 $\\,E_{\\mathrm{trunc}}(x,z)\\,$。\n- 离散化要求：\n  - 在宽度为 $\\,L_x = 20\\times 10^{-6}\\,\\mathrm{m}\\,$、中心位于 $\\,x=0\\,$ 的窗口上使用 $\\,N_x = 4096\\,$ 个样本的均匀网格。令 $\\,\\Delta x = L_x/N_x\\,$，并在 $\\,n=0,1,\\dots,N_x-1\\,$ 上对 $\\,x_n = -L_x/2 + n\\,\\Delta x\\,$ 进行采样。\n  - 使用与 $\\,x\\,$ 和 $\\,k_x\\,$ 一致的离散傅里叶变换对，以便在相应的 $\\,k_x\\,$ 样本上应用离散角谱乘子。确保复数平方根的选择强制场向外辐射，并且倏逝分量随 $\\,z\\,$ 的增加而衰减。\n- 在观察平面上为进行定量比较需计算的度量：\n  - 定义感兴趣区域 $\\,\\mathrm{ROI} = \\{x: |x|\\le 2\\times 10^{-6}\\,\\mathrm{m}\\}\\,$。以下所有度量都必须仅在该区域内，使用落入此区间的离散样本进行计算。\n  - 截断重构与完整重构之间的归一化均方根误差 (NRMSE)：\n    $$\\mathrm{NRMSE}(z) = \\frac{\\left\\|E_{\\mathrm{full}}(\\cdot,z) - E_{\\mathrm{trunc}}(\\cdot,z)\\right\\|_{2,\\mathrm{ROI}}}{\\left\\|E_{\\mathrm{full}}(\\cdot,z)\\right\\|_{2,\\mathrm{ROI}}},$$\n    其中 $\\,\\|\\cdot\\|_{2,\\mathrm{ROI}}\\,$ 表示感兴趣区域内样本的离散 $\\,\\ell_2\\,$ 范数。\n  - 基于光强 $\\,I(x,z)=|E(x,z)|^2\\,$ 的分辨能力对比度度量：\n    - 令 $\\,I_{\\mathrm{left}}\\,$ 和 $\\,I_{\\mathrm{right}}\\,$ 分别为以 $\\,x=-d/2\\,$ 和 $\\,x=+d/2\\,$ 为中心的窗口内的最大光强，每个窗口的半宽为 $\\,\\max\\{3\\sigma,\\, d/2\\}\\,$，并与感兴趣区域相交。\n    - 令 $\\,I_{\\mathrm{valley}}\\,$ 为最接近 $\\,x=0\\,$ 的样本处的光强。\n    - 定义对比度 $\\,C(z) = 1 - \\dfrac{I_{\\mathrm{valley}}}{\\tfrac{1}{2}(I_{\\mathrm{left}}+I_{\\mathrm{right}})}\\,$，并将其裁剪到区间 $[0,1]$ 内。\n    - 将由倏逝分量引起的对比度提升报告为 $\\,\\Delta C(z) = C_{\\mathrm{full}}(z) - C_{\\mathrm{trunc}}(z)\\,$。\n- 测试套件：\n  - 使用以下三个测试用例，每个用例由波长 $\\,\\lambda\\,$、间距 $\\,d\\,$、高斯宽度 $\\,\\sigma\\,$ 和传播距离 $\\,z\\,$ 指定：\n    1. 用例A（深近场，亚波长特征）：$\\,\\lambda = 1.0\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,d = 0.4\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,\\sigma = 0.10\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,z = 0.10\\times 10^{-6}\\,\\mathrm{m}\\,$。\n    2. 用例B（孔径平面边界）：$\\,\\lambda = 1.0\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,d = 0.4\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,\\sigma = 0.10\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,z = 0\\,\\mathrm{m}\\,$。\n    3. 用例C（中等距离传播，多个波长）：$\\,\\lambda = 1.0\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,d = 0.4\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,\\sigma = 0.10\\times 10^{-6}\\,\\mathrm{m}\\,$, $\\,z = 5.0\\times 10^{-6}\\,\\mathrm{m}\\,$。\n- 程序输出规范：\n  - 对于每个测试用例，计算如上定义的 $\\,\\mathrm{NRMSE}(z)\\,$ 和 $\\,\\Delta C(z)\\,$。将每个值四舍五入到六位小数。\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序为\n    $$[\\mathrm{NRMSE}_A,\\,\\Delta C_A,\\,\\mathrm{NRMSE}_B,\\,\\Delta C_B,\\,\\mathrm{NRMSE}_C,\\,\\Delta C_C]。$$\n\n所有计算必须以双精度进行。所有量均以上述单位表示，并确保传播模型满足辐射条件。您的算法必须是自包含的，且不应要求用户输入。最终列表元素必须是按规定格式化的浮点数。",
            "solution": "### **1. 角谱传播算子的理论推导**\n\n在无源、均匀、各向同性、无损耗的介质中，与 $e^{j\\omega t}$ 时间相关性的时谐电磁场由麦克斯韦方程组的相量形式控制：\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon\\mathbf{E} $$\n其中 $\\mathbf{E}$ 和 $\\mathbf{H}$ 是复数电场和磁场相量，$\\omega$ 是角频率，$\\mu$ 和 $\\epsilon$ 分别是介质的磁导率和介电常数。\n\n对第一个方程取旋度并代入第二个方程，得到：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega\\mu (\\nabla \\times \\mathbf{H}) = -j\\omega\\mu (j\\omega\\epsilon\\mathbf{E}) = \\omega^2\\mu\\epsilon\\mathbf{E} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$ 以及在均匀 $\\epsilon$ 的无源区域中 $\\nabla \\cdot \\mathbf{E} = 0$ 的事实，我们得到矢量亥姆霍兹方程：\n$$ \\nabla^2 \\mathbf{E} + k^2 \\mathbf{E} = 0 $$\n波数 $k$ 定义为 $k = \\omega\\sqrt{\\mu\\epsilon} = \\omega/v_p$。问题指定介质的折射率为1，因此相速度 $v_p$ 是真空中的光速 $c$。于是，$k = \\omega/c = 2\\pi/\\lambda$，其中 $\\lambda$ 是波长。\n\n对于线性偏振的标量场 $E(x,z)$，亥姆霍兹方程简化为：\n$$ \\left( \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial z^2} \\right) E(x,z) + k^2 E(x,z) = 0 $$\n\n为了求解这个偏微分方程，我们对横向坐标 $x$ 使用傅里叶变换。令 $\\tilde{E}(k_x, z)$ 为 $E(x,z)$ 的空间傅里叶变换。将傅里叶变换应用于亥姆霍兹方程，算子 $\\frac{\\partial^2}{\\partial x^2}$ 变为乘以 $(-j k_x)^2 = -k_x^2$。这将偏微分方程转换为一个关于 $z$ 的常微分方程：\n$$ \\frac{d^2 \\tilde{E}(k_x, z)}{dz^2} + (k^2 - k_x^2) \\tilde{E}(k_x, z) = 0 $$\n令 $k_z^2 = k^2 - k_x^2$。该方程的通解为 $\\tilde{E}(k_x, z) = A(k_x) e^{j k_z z} + B(k_x) e^{-j k_z z}$。\n对于 $e^{j\\omega t}$ 约定，沿 $+z$ 方向传播的平面波的形式为 $e^{j(\\omega t - k_z z)} = e^{-j k_z z} e^{j\\omega t}$。因此，项 $e^{-j k_z z}$ 代表前向传播波，而 $e^{j k_z z}$ 代表后向传播波。由于源位于 $z=0$ 并向 $z>0$ 辐射，我们必须设 $A(k_x) = 0$。\n\n解变为 $\\tilde{E}(k_x, z) = \\tilde{E}(k_x, 0) e^{-j k_z z}$，其中传播算子为 $e^{-j k_z z}$。我们需要正确定义 $k_z = \\sqrt{k^2 - k_x^2}$ 以满足辐射条件。\n1.  **传播分量**：对于 $|k_x| \\le k$，$k_z$ 是实数。$e^{-j k_z z}$ 是一个纯相位项。\n2.  **倏逝分量**：对于 $|k_x| > k$，$k_z^2$ 是负数。$k_z$ 是纯虚数。为了确保场在 $z \\to \\infty$ 时衰减，传播算子 $e^{-j k_z z}$ 中的指数必须有一个负实部。若令 $k_z = j\\alpha$（$\\alpha$ 为正实数），则 $e^{-j(j\\alpha)z} = e^{\\alpha z}$，这是增长的，不符合物理。因此，必须选择 $k_z = -j\\alpha$，这样 $e^{-j(-j\\alpha)z} = e^{-\\alpha z}$，表示衰减。\n这要求我们选择 $k_z = \\sqrt{k^2 - k_x^2}$ 的根，使其虚部小于或等于零。这可以通过取标准主根（虚部非负）的复共轭来实现。\n\n因此，完整的传播算法是：\n$$ E(x,z) = \\mathcal{F}_x^{-1}\\left\\{ \\mathcal{F}_x\\{E(x,0)\\} \\cdot \\exp\\left(-j z \\cdot \\mathrm{conj}\\left(\\sqrt{k^2 - k_x^2}\\right)\\right) \\right\\} $$\n\n### **2. 数值实现策略**\n\n该算法使用快速傅里叶变换（FFT）实现。\n1.  在离散空间网格上定义初始场 $E_0(x)$。\n2.  使用FFT计算其角谱 $\\tilde{E}_0(k_x)$。\n3.  对每个离散的 $k_x$ 值，计算 $k_z^2 = k^2 - k_x^2$。\n4.  计算 $k_z = \\mathrm{conj}(\\sqrt{k_z^2})$ 以确保物理上正确的衰减。\n5.  构造完整的传播算子 $H_{\\mathrm{full}}(k_x, z) = e^{-j z k_z}$。\n6.  构造截断的传播算子 $H_{\\mathrm{trunc}}$，方法是将所有倏逝分量（$|k_x| > k$）的算子设为零。\n7.  将谱与算子相乘，得到传播后的谱 $\\tilde{E}_{\\mathrm{full}}(k_x, z)$ 和 $\\tilde{E}_{\\mathrm{trunc}}(k_x, z)$。\n8.  使用逆FFT变换回空间域，得到 $E_{\\mathrm{full}}(x,z)$ 和 $E_{\\mathrm{trunc}}(x,z)$。\n9.  在指定的感兴趣区域（ROI）内计算NRMSE和对比度提升 $\\Delta C$。\n\n该实现将针对每个测试用例遵循这些步骤。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a one-dimensional angular spectrum propagation of a time-harmonic\n    electromagnetic field, computes specified metrics, and prints the results.\n    This implementation is consistent with the e^(j*omega*t) convention.\n    \"\"\"\n\n    # Physical constants\n    c = 2.99792458e8  # Speed of light in m/s\n\n    # Discretization parameters\n    Nx = 4096\n    Lx = 20e-6  # m\n\n    # Spatial grid\n    dx = Lx / Nx\n    x = np.linspace(-Lx / 2, Lx / 2 - dx, Nx)\n\n    # Spatial frequency grid for numpy's FFT\n    kx = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n\n    # Region of Interest (ROI)\n    roi_boundary = 2e-6\n    roi_mask = np.abs(x) = roi_boundary\n\n    def calculate_contrast(E, x_grid, d, sigma, roi_mask_):\n        \"\"\"\n        Calculates the resolving-power contrast metric C(z).\n        \"\"\"\n        I = np.abs(E)**2\n        \n        # Find intensity at the valley (center)\n        idx_zero = np.argmin(np.abs(x_grid))\n        I_valley = I[idx_zero]\n\n        # Define peak search windows\n        w = max(3 * sigma, d / 2)\n        \n        # Left peak search window\n        left_peak_window_mask = (x_grid >= -d/2 - w)  (x_grid = -d/2 + w)  roi_mask_\n        \n        # Right peak search window\n        right_peak_window_mask = (x_grid >= d/2 - w)  (x_grid = d/2 + w)  roi_mask_\n\n        I_left = np.max(I[left_peak_window_mask]) if np.any(left_peak_window_mask) else 0.0\n        I_right = np.max(I[right_peak_window_mask]) if np.any(right_peak_window_mask) else 0.0\n        \n        I_peaks_avg = 0.5 * (I_left + I_right)\n\n        if I_peaks_avg == 0:\n            return 0.0\n        \n        contrast_raw = 1 - I_valley / I_peaks_avg\n        contrast = np.clip(contrast_raw, 0, 1)\n        \n        return contrast\n\n    test_cases = [\n        # Case A: deep near-field, subwavelength features\n        {'lambda_': 1.0e-6, 'd': 0.4e-6, 'sigma': 0.10e-6, 'z': 0.10e-6},\n        # Case B: aperture plane boundary\n        {'lambda_': 1.0e-6, 'd': 0.4e-6, 'sigma': 0.10e-6, 'z': 0.0},\n        # Case C: moderate propagation, many wavelengths\n        {'lambda_': 1.0e-6, 'd': 0.4e-6, 'sigma': 0.10e-6, 'z': 5.0e-6},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        lambda_ = case['lambda_']\n        d = case['d']\n        sigma = case['sigma']\n        z = case['z']\n\n        # Wavenumber\n        k = 2 * np.pi / lambda_\n\n        # 1. Define initial field at z=0\n        E0 = np.exp(-(x - d/2)**2 / (2 * sigma**2)) + \\\n             np.exp(-(x + d/2)**2 / (2 * sigma**2))\n\n        # 2. Compute angular spectrum via FFT\n        E0_tilde = np.fft.fft(E0)\n\n        # 3. Construct propagator consistent with e^(j*omega*t) convention\n        kz_sq = (k**2 - kx**2).astype(np.complex128)\n        # We need the root with Im(kz) = 0 to ensure decay for the e^(-j*kz*z) propagator\n        # This is equivalent to taking the conjugate of the principal root (which has Im(kz) >= 0)\n        kz = np.conj(np.sqrt(kz_sq))\n\n        # Full propagator (propagating + evanescent)\n        propagator_full = np.exp(-1j * kz * z)\n        \n        # Truncated propagator (propagating only)\n        propagating_mask = kx**2 = k**2\n        propagator_trunc = np.zeros_like(propagator_full)\n        propagator_trunc[propagating_mask] = propagator_full[propagating_mask]\n        \n        # 4. Propagate in spectral domain\n        E_full_tilde = E0_tilde * propagator_full\n        E_trunc_tilde = E0_tilde * propagator_trunc\n\n        # 5. Transform back to spatial domain via IFFT\n        E_full = np.fft.ifft(E_full_tilde)\n        E_trunc = np.fft.ifft(E_trunc_tilde)\n\n        # 6. Compute metrics\n        \n        # NRMSE\n        E_full_roi = E_full[roi_mask]\n        E_trunc_roi = E_trunc[roi_mask]\n        \n        norm_full_roi = np.linalg.norm(E_full_roi)\n        norm_diff_roi = np.linalg.norm(E_full_roi - E_trunc_roi)\n\n        nrmse = norm_diff_roi / norm_full_roi if norm_full_roi > 0 else 0.0\n        \n        # Contrast Improvement\n        C_full = calculate_contrast(E_full, x, d, sigma, roi_mask)\n        C_trunc = calculate_contrast(E_trunc, x, d, sigma, roi_mask)\n        delta_C = C_full - C_trunc\n        \n        results.extend([nrmse, delta_C])\n\n    # Format output as specified\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}