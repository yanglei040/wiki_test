{
    "hands_on_practices": [
        {
            "introduction": "理论的基石始于从第一性原理推导物理定律。本练习将引导你从积分形式的麦克斯韦方程出发，严格推导理想电导体（PEC）表面的磁场边界条件，并将其应用于一个经典问题——平面波的反射。通过这个过程，你将深刻理解宏观电磁场与导体表面感应电流之间的内在联系，这是分析散射和天线问题的基础。",
            "id": "3290423",
            "problem": "一个隐去时间因子 $\\exp(\\mathrm{j}\\omega t)$ 的时谐电磁场入射到一个平面分界面上，该分界面分隔了占据 $z>0$ 区域的均匀、各向同性、无损耗的外部介质和占据 $z<0$ 区域的理想电导体 (PEC)。外部介质的介电常数为 $\\epsilon_{1}$，磁导率为 $\\mu_{1}$，本征阻抗为 $\\eta_{1}=\\sqrt{\\mu_{1}/\\epsilon_{1}}$。单位法向量 $\\hat{n}$ 从 PEC 指向外部介质，因此在 $z=0$ 处 $\\hat{n}=\\hat{z}$。\n\n第一部分：从麦克斯韦方程组的积分形式出发，并引用针对一个跨越分界面的无限薄矩形安培环路的物理合理极限论证，推导出将界面处磁场的切向分量与 PEC 上感应的表面电流密度联系起来的边界关系。您的推导必须从基本定律开始，即包含自由电流密度和位移电流的安培-麦克斯韦定律的积分形式，并随着环路垂直于界面的厚度趋于零，一致地计算环路积分和通量项。\n\n第二部分：考虑一个横电 (TE) 平面波从外部介质入射到位于 $z=0$ 的 PEC 上。入射电场为\n$$\\mathbf{E}_{\\mathrm{i}}(\\mathbf{r})=E_{0}\\,\\hat{y}\\,\\exp\\!\\big(\\mathrm{j}\\,k_{1}(\\sin\\theta\\,x-\\cos\\theta\\,z)\\big),$$\n其中 $E_{0}>0$ 是实值振幅，$k_{1}=\\omega\\sqrt{\\mu_{1}\\epsilon_{1}}$ 是外部介质中的波数，$\\theta\\in(0,\\pi/2)$ 是从正 $z$ 轴朝向正 $x$ 轴测量的入射角。令 $\\mathbf{k}_{\\mathrm{i}}=k_{1}(\\sin\\theta\\,\\hat{x}-\\cos\\theta\\,\\hat{z})$ 表示入射传播矢量，并假设在均匀介质中电场和磁场之间遵循标准平面波关系。PEC 反射该波，使得在 $z=0$ 处的总切向电场为零。利用第一部分建立的边界关系，并强制在 $z=0$ 处的切向电场为零，求出在 $z=0$ 处感应的表面电流密度 $\\mathbf{K}_{s}$，用 $E_{0}$、$\\eta_{1}$ 和 $\\theta$ 表示。\n\n答案规格：以行向量 $(K_{sx},K_{sy},K_{sz})$ 的形式，为 $\\mathbf{K}_{s}$ 的笛卡尔分量提供一个单一的闭式解析表达式。无需进行数值计算或四舍五入，最终表达式中不应包含任何单位。",
            "solution": "该问题经验证为自洽、有科学依据且良定的问题。这是经典电磁学中的一个标准问题。\n\n第一部分：PEC 界面处切向磁场边界条件的推导。\n\n我们从时谐场的安培-麦克斯韦定律积分形式开始，其中时间相关性由 $\\exp(\\mathrm{j}\\omega t)$ 给出，因此时间导数 $\\frac{\\partial}{\\partial t}$ 被替换为 $\\mathrm{j}\\omega$：\n$$ \\oint_C \\mathbf{H} \\cdot d\\mathbf{l} = \\int_S (\\mathbf{J}_f + \\mathrm{j}\\omega\\mathbf{D}) \\cdot d\\mathbf{S} $$\n此处，$C$ 是闭合路径，$S$ 是以 $C$ 为边界的任意曲面，$\\mathbf{H}$ 是磁场强度，$\\mathbf{J}_f$ 是自由体电流密度，$\\mathbf{D}$ 是电位移场。\n\n我们考虑一个位于 $z=0$ 的平面分界面，它分隔了一个一般介质（区域1，$z>0$）和一个理想电导体 (PEC)（区域2，$z<0$）。从区域2指向区域1的单位法向量是 $\\hat{n}=\\hat{z}$。为推导边界条件，我们构造一个跨越分界面的微小矩形安培环路 $C$。该环路平行于分界面的宽度为 $\\Delta w$，垂直于分界面的高度为 $\\Delta h$，中心位于 $z=0$。设其方向使得长度为 $\\Delta w$ 的边平行于任意切向方向 $\\hat{\\tau}$，长度为 $\\Delta h$ 的边平行于法向 $\\hat{n}$。\n\n我们在环路高度趋于零的极限下，即 $\\Delta h \\to 0$ 时，计算线积分 $\\oint_C \\mathbf{H} \\cdot d\\mathbf{l}$。该积分由矩形四条边的贡献组成。两条长度为 $\\Delta h$ 的竖直边的贡献与 $\\Delta h$ 成正比，在 $\\Delta h \\to 0$ 时消失（假设场 $\\mathbf{H}$ 是有限的）。顶部和底部水平边的贡献保留下来。顶边位于区域1中的 $z=+\\Delta h/2$ 处，底边位于区域2中的 $z=-\\Delta h/2$ 处。\n$$ \\lim_{\\Delta h \\to 0} \\oint_C \\mathbf{H} \\cdot d\\mathbf{l} = \\mathbf{H}_1 \\cdot (\\Delta w \\hat{\\tau}) + \\mathbf{H}_2 \\cdot (-\\Delta w \\hat{\\tau}) = (\\mathbf{H}_{1,t} - \\mathbf{H}_{2,t}) \\cdot \\hat{\\tau} \\Delta w $$\n此处，$\\mathbf{H}_1$ 和 $\\mathbf{H}_2$ 分别是区域1和区域2中界面处的磁场，$\\mathbf{H}_{1,t}$ 和 $\\mathbf{H}_{2,t}$ 是它们平行于表面的切向分量。\n\n接下来，我们计算右侧的面积分。以环路为边界的曲面 $S$ 的面积为 $\\Delta w \\Delta h$。位移电流项的通量 $\\int_S \\mathrm{j}\\omega\\mathbf{D} \\cdot d\\mathbf{S}$ 与面积 $\\Delta w \\Delta h$ 成正比。当 $\\Delta h \\to 0$ 时，此项消失（假设 $\\mathbf{D}$ 是有限的）。自由电流项 $\\int_S \\mathbf{J}_f \\cdot d\\mathbf{S}$ 代表穿过环路的总自由电流。如果界面上存在表面电流密度 $\\mathbf{K}_s$，则体电流密度 $\\mathbf{J}_f$ 在 $z=0$ 处变得奇异。该积分给出总电流，在 $\\Delta h \\to 0$ 的极限下，它是 $\\mathbf{K}_s$ 垂直于边 $\\Delta w$ 的分量与长度 $\\Delta w$ 的乘积。设环路曲面的法向量为 $\\hat{t} = \\hat{\\tau} \\times \\hat{n}$。穿过环路的电流为 $(\\mathbf{K}_s \\cdot \\hat{t}) \\Delta w$。\n\n令线积分和面积分相等，我们有：\n$$ (\\mathbf{H}_{1,t} - \\mathbf{H}_{2,t}) \\cdot \\hat{\\tau} \\Delta w = (\\mathbf{K}_s \\cdot (\\hat{\\tau} \\times \\hat{n})) \\Delta w $$\n使用标量三重积恒等式 $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C}) = -(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C}$，我们得到：\n$$ (\\mathbf{H}_{1,t} - \\mathbf{H}_{2,t}) \\cdot \\hat{\\tau} = -(\\mathbf{K}_s \\times \\hat{\\tau}) \\cdot \\hat{n} $$\n一个更直接和标准的推导以矢量形式陈述了该关系。分量关系必须对切平面中环路的任何方向都成立。这导出了普适的矢量边界条件：\n$$ \\hat{n} \\times (\\mathbf{H}_1 - \\mathbf{H}_2) = \\mathbf{K}_s $$\n在 PEC 内部（区域2），电磁场恒为零，因此 $\\mathbf{H}_2 = \\mathbf{0}$。因此，PEC 表面的边界条件简化为：\n$$ \\mathbf{K}_s = \\hat{n} \\times \\mathbf{H}_1 $$\n其中 $\\mathbf{H}_1$ 是紧靠导体外侧的磁场。\n\n第二部分：表面电流密度的计算。\n\n给定在外部介质（$z>0$）中有一个 TE 极化的入射平面波：\n$$ \\mathbf{E}_{\\mathrm{i}}(\\mathbf{r})=E_{0}\\,\\hat{y}\\,\\exp(\\mathrm{j}(k_{1}x\\sin\\theta - k_{1}z\\cos\\theta)) $$\n入射波矢量为 $\\mathbf{k}_{\\mathrm{i}} = k_{1}(\\sin\\theta\\,\\hat{x}-\\cos\\theta\\,\\hat{z})$。相应的入射磁场 $\\mathbf{H}_{\\mathrm{i}}$ 可用平面波关系式 $\\mathbf{H} = (\\eta^{-1}) \\hat{k} \\times \\mathbf{E}$ 求得：\n$$ \\mathbf{H}_{\\mathrm{i}} = \\frac{1}{\\eta_{1}} \\frac{\\mathbf{k}_{\\mathrm{i}}}{k_{1}} \\times \\mathbf{E}_{\\mathrm{i}} = \\frac{1}{\\eta_{1}} (\\sin\\theta\\,\\hat{x}-\\cos\\theta\\,\\hat{z}) \\times \\big(E_{0}\\,\\hat{y}\\,\\exp(\\mathrm{j}\\mathbf{k}_{\\mathrm{i}}\\cdot\\mathbf{r})\\big) $$\n$$ \\mathbf{H}_{\\mathrm{i}} = \\frac{E_{0}}{\\eta_{1}} \\big(\\sin\\theta(\\hat{x}\\times\\hat{y}) - \\cos\\theta(\\hat{z}\\times\\hat{y})\\big) \\exp(\\mathrm{j}\\mathbf{k}_{\\mathrm{i}}\\cdot\\mathbf{r}) $$\n使用 $\\hat{x}\\times\\hat{y}=\\hat{z}$ 和 $\\hat{z}\\times\\hat{y}=-\\hat{x}$，我们得到：\n$$ \\mathbf{H}_{\\mathrm{i}} = \\frac{E_{0}}{\\eta_{1}} (\\cos\\theta\\,\\hat{x} + \\sin\\theta\\,\\hat{z}) \\exp(\\mathrm{j}(k_{1}x\\sin\\theta - k_{1}z\\cos\\theta)) $$\n在 PEC 边界（$z=0$）处，总切向电场必须为零。总场是入射场和反射场的和，$\\mathbf{E} = \\mathbf{E}_{\\mathrm{i}} + \\mathbf{E}_{\\mathrm{r}}$。\n$$ \\mathbf{E}_{\\mathrm{tan}}(x,y,0) = \\mathbf{E}_{\\mathrm{i,tan}}(x,y,0) + \\mathbf{E}_{\\mathrm{r,tan}}(x,y,0) = \\mathbf{0} $$\n入射电场 $\\mathbf{E}_{\\mathrm{i}}$ 完全是切向的（在 $\\hat{y}$ 方向）。在 $z=0$ 处：\n$$ \\mathbf{E}_{\\mathrm{i}}(x,y,0) = E_{0}\\,\\hat{y}\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta) $$\n因此，边界处的反射电场必须是：\n$$ \\mathbf{E}_{\\mathrm{r}}(x,y,0) = -E_{0}\\,\\hat{y}\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta) $$\n反射波从分界面传播到区域1。根据相位匹配条件，其波矢量的切向分量与入射波相同，而法向分量反向：$\\mathbf{k}_{\\mathrm{r}} = k_{1}(\\sin\\theta\\,\\hat{x}+\\cos\\theta\\,\\hat{z})$。因此，反射电场为：\n$$ \\mathbf{E}_{\\mathrm{r}}(\\mathbf{r}) = -E_{0}\\,\\hat{y}\\,\\exp(\\mathrm{j}(k_{1}x\\sin\\theta + k_{1}z\\cos\\theta)) $$\n反射磁场 $\\mathbf{H}_{\\mathrm{r}}$ 为：\n$$ \\mathbf{H}_{\\mathrm{r}} = \\frac{1}{\\eta_{1}} \\frac{\\mathbf{k}_{\\mathrm{r}}}{k_{1}} \\times \\mathbf{E}_{\\mathrm{r}} = \\frac{1}{\\eta_{1}} (\\sin\\theta\\,\\hat{x}+\\cos\\theta\\,\\hat{z}) \\times \\big(-E_{0}\\,\\hat{y}\\,\\exp(\\mathrm{j}\\mathbf{k}_{\\mathrm{r}}\\cdot\\mathbf{r})\\big) $$\n$$ \\mathbf{H}_{\\mathrm{r}} = -\\frac{E_{0}}{\\eta_{1}} \\big(\\sin\\theta(\\hat{x}\\times\\hat{y}) + \\cos\\theta(\\hat{z}\\times\\hat{y})\\big) \\exp(\\mathrm{j}\\mathbf{k}_{\\mathrm{r}}\\cdot\\mathbf{r}) $$\n$$ \\mathbf{H}_{\\mathrm{r}} = \\frac{E_{0}}{\\eta_{1}} (\\cos\\theta\\,\\hat{x} - \\sin\\theta\\,\\hat{z}) \\exp(\\mathrm{j}(k_{1}x\\sin\\theta + k_{1}z\\cos\\theta)) $$\n在分界面 $z=0$ 处计算总磁场 $\\mathbf{H} = \\mathbf{H}_{\\mathrm{i}} + \\mathbf{H}_{\\mathrm{r}}$：\n$$ \\mathbf{H}(x,y,0) = \\mathbf{H}_{\\mathrm{i}}(x,y,0) + \\mathbf{H}_{\\mathrm{r}}(x,y,0) $$\n$$ \\mathbf{H}(x,y,0) = \\frac{E_{0}}{\\eta_{1}} (\\cos\\theta\\,\\hat{x} + \\sin\\theta\\,\\hat{z})\\exp(\\mathrm{j}k_{1}x\\sin\\theta) + \\frac{E_{0}}{\\eta_{1}} (\\cos\\theta\\,\\hat{x} - \\sin\\theta\\,\\hat{z})\\exp(\\mathrm{j}k_{1}x\\sin\\theta) $$\n$$ \\mathbf{H}(x,y,0) = \\frac{E_{0}}{\\eta_{1}} (2\\cos\\theta\\,\\hat{x})\\exp(\\mathrm{j}k_{1}x\\sin\\theta) = \\frac{2E_{0}}{\\eta_{1}}\\cos\\theta\\,\\hat{x}\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta) $$\n现在我们使用第一部分的边界关系来求感应表面电流密度 $\\mathbf{K}_s$。当 $\\hat{n}=\\hat{z}$ 且 $\\mathbf{H}_1=\\mathbf{H}(x,y,0)$ 时：\n$$ \\mathbf{K}_s = \\hat{n} \\times \\mathbf{H}_1 = \\hat{z} \\times \\left(\\frac{2E_{0}}{\\eta_{1}}\\cos\\theta\\,\\hat{x}\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta)\\right) $$\n使用 $\\hat{z}\\times\\hat{x} = \\hat{y}$，我们得到：\n$$ \\mathbf{K}_s = \\frac{2E_{0}}{\\eta_{1}}\\cos\\theta\\,\\hat{y}\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta) $$\n题目要求表面电流密度的笛卡尔分量。从上面的表达式，我们有：\n$K_{sx} = 0$\n$K_{sy} = \\frac{2E_{0}}{\\eta_{1}}\\cos\\theta\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta)$\n$K_{sz} = 0$\n这些分量可以写成行向量 $(K_{sx}, K_{sy}, K_{sz})$。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0 & \\frac{2E_{0}}{\\eta_{1}}\\cos\\theta\\,\\exp(\\mathrm{j}k_{1}x\\sin\\theta) & 0\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "将物理定律转化为可靠的计算代码，需要对数学形式主义有一丝不苟的关注。本练习聚焦于一个常见但至关重要的细节：界面法向量 $\\hat{n}$ 方向的定义如何影响边界条件的代数形式 。通过辨析不同的“跳变”算子定义，你将学会如何建立一个在任何坐标和几何结构下都保持一致和正确的数值模型，这是开发稳健的有限元或有限体积求解器的关键一步。",
            "id": "3290459",
            "problem": "考虑一个光滑材料界面 $\\Sigma$，它在一个时变电磁场中分隔介质 $1$ 和介质 $2$。令 $\\hat{n}$ 表示 $\\Sigma$ 上选定的单位法向量，从介质 $1$ 指向介质 $2$。假设在 $\\Sigma$ 上存在表面电荷密度 $\\rho_s$ 和表面电流密度 $\\mathbf{K}_s$。在通过面局部积分关系（例如，有限体积法或间断Galerkin公式）施加边界条件的计算电磁学离散化中，符号约定源于 $\\hat{n}$ 的方向以及跳变的定义方式。\n\n仅从麦克斯韦方程组的积分形式出发：\n- 高斯电通定律：$$\\oint_{\\partial V} \\mathbf{D}\\cdot d\\mathbf{S}=\\int_V \\rho\\, dV,$$\n- 安培–麦克斯韦定律：$$\\oint_{\\partial S} \\mathbf{H}\\cdot d\\boldsymbol{\\ell}=\\int_S \\mathbf{J}\\cdot \\hat{n}\\, dS+\\frac{\\partial}{\\partial t}\\int_S \\mathbf{D}\\cdot \\hat{n}\\, dS,$$\n使用极限“药盒”（pillbox）和“回路”（loop）论证，来推断 $\\rho_s$ 和 $\\mathbf{K}_s$ 的代数符号对 $\\hat{n}$ 的方向以及跳变算子中所用排序的依赖关系。特别地，区分以下两种情况：\n- 一个“固定标签”跳变，无论 $\\hat{n}$ 如何，它总是使用 $(\\cdot)_2-(\\cdot)_1$，以及\n- 一个“定向”跳变，定义为“正侧减去负侧”，其中正侧是 $\\hat{n}$ 所指向的一侧。\n\n在这些约定下，下列哪个陈述必须为真？\n\nA. 如果将 $\\hat{n}$ 翻转为 $-\\hat{n}$，而跳变保持为 $(\\cdot)_2-(\\cdot)_1$，那么跳变关系式右侧的 $\\rho_s$ 和 $\\mathbf{K}_s$ 的代数符号都会反转。\n\nB. 如果将 $\\hat{n}$ 翻转为 $-\\hat{n}$，而跳变保持为 $(\\cdot)_2-(\\cdot)_1$，那么 $\\rho_s$ 的代数符号会反转，但 $\\mathbf{K}_s$ 的代数符号不变，因为 $\\mathbf{K}_s$ 是切向的。\n\nC. 如果跳变以定向方式定义为“正侧减去负侧”，且正侧选择在 $\\hat{n}$ 的方向，那么翻转 $\\hat{n}$ 并相应地重新指定哪一侧为正侧，将使涉及 $\\rho_s$ 和 $\\mathbf{K}_s$ 的右侧保持不变（没有符号反转）。\n\nD. 磁场切向分量跳变的叉积表示是内在地与方向无关的，因此翻转 $\\hat{n}$ 不能改变与 $\\mathbf{K}_s$ 相关的符号。\n\nE. 在没有磁单极子的情况下，并且无论跳变顺序如何，磁通量密度的法向分量的跳变等于表面电荷密度，因此翻转 $\\hat{n}$ 不会影响与 $\\rho_s$ 相关的符号。\n\n选择所有适用的选项。提供植根于积分定律以及Stokes定理和散度定理的方向规则的论证。",
            "solution": "问题陈述要求分析从麦克斯韦方程组的积分形式推导出的电磁边界条件中的符号约定。该分析必须考虑在两种不同的跳变算子定义下，翻转界面法向量 $\\hat{n}$ 的效果。\n\n### 步骤 1：提取已知条件\n-   **界面与法向量：** 一个光滑材料界面 $\\Sigma$ 分隔介质 $1$ 和介质 $2$。单位法向量 $\\hat{n}$ 从介质 $1$ 指向介质 $2$。\n-   **表面源：** 在 $\\Sigma$ 上存在表面电荷密度 $\\rho_s$ 和表面电流密度 $\\mathbf{K}_s$。\n-   **控制方程（积分形式）：**\n    -   高斯电通定律：$\\oint_{\\partial V} \\mathbf{D}\\cdot d\\mathbf{S}=\\int_V \\rho\\, dV$\n    -   安培–麦克斯韦定律：$\\oint_{\\partial S} \\mathbf{H}\\cdot d\\boldsymbol{\\ell}=\\int_S \\mathbf{J}\\cdot \\hat{n}\\, dS+\\frac{\\partial}{\\partial t}\\int_S \\mathbf{D}\\cdot \\hat{n}\\, dS$\n-   **方法论：** 使用极限“药盒”和“回路”论证。\n-   **跳变算子定义：**\n    1.  **固定标签跳变：** 总是定义为 $(\\cdot)_2 - (\\cdot)_1$。\n    2.  **定向跳变：** 定义为 $(\\cdot)_{\\text{正侧}} - (\\cdot)_{\\text{负侧}}$，其中正侧是 $\\hat{n}$ 所指向的一侧。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它提出了电磁理论中一个标准的、有深度的问题，涉及边界条件的推导和解释，这是解析和计算电磁学的基石。包括麦克斯韦方程组的积分形式和跳变算子的定义在内的前提条件清晰、正确且自洽。该问题没有违反任何基本原理，不基于错误的前提，并包含了进行严格推导所需的所有信息。这是一个可形式化的问题，基于矢量微积分和物理学，有唯一且有意义的解。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。我们可以继续进行求解。\n\n### 边界条件的推导\n\n我们通过将所提供的积分定律应用于跨越界面 $\\Sigma$ 的无穷小几何体，来推导边界条件。我们将始终使用初始约定，即 $\\hat{n}$ 从介质 $1$ 指向介质 $2$。\n\n**1. $\\mathbf{D}$ 的法向分量（源自高斯定律）**\n\n考虑一个以 $\\Sigma$ 为中心、顶/底面积为 $\\Delta A$、高度为 $h$ 的小型圆柱状“药盒”（pillbox）。顶面在介质 $2$ 中，底面在介质 $1$ 中。顶面的向外法向量是 $\\hat{n}$，底面的向外法向量是 $-\\hat{n}$。我们应用散度定理（高斯定律的基础）。\n\n通量积分为 $\\oint_{\\partial V} \\mathbf{D}\\cdot d\\mathbf{S} = \\int_{\\text{顶}} \\mathbf{D}\\cdot d\\mathbf{S} + \\int_{\\text{底}} \\mathbf{D}\\cdot d\\mathbf{S} + \\int_{\\text{侧}} \\mathbf{D}\\cdot d\\mathbf{S}$。\n\n在 $h \\to 0$ 的极限下：\n-   $\\int_{\\text{顶}} \\mathbf{D}\\cdot d\\mathbf{S} \\approx (\\mathbf{D}_2 \\cdot \\hat{n}) \\Delta A$。\n-   $\\int_{\\text{底}} \\mathbf{D}\\cdot d\\mathbf{S} \\approx (\\mathbf{D}_1 \\cdot (-\\hat{n})) \\Delta A = -(\\mathbf{D}_1 \\cdot \\hat{n}) \\Delta A$。\n-   通过侧壁的通量与 $h$ 成正比，并趋于零。\n\n包围的总电荷为 $\\int_V \\rho\\, dV \\to \\rho_s \\Delta A$。\n\n将通量与包围的电荷相等，然后除以 $\\Delta A$：\n$(\\mathbf{D}_2 \\cdot \\hat{n}) - (\\mathbf{D}_1 \\cdot \\hat{n}) = \\rho_s$\n$\\hat{n} \\cdot (\\mathbf{D}_2 - \\mathbf{D}_1) = \\rho_s$\n\n**2. $\\mathbf{H}$ 的切向分量（源自安培-麦克斯韦定律）**\n\n考虑一个跨越界面、高为 $h$、长为 $\\Delta l$ 的小型矩形回路。让长度为 $\\Delta l$ 的边平行于界面，回路平面垂直于 $\\Sigma$。令 $\\hat{t}$ 为沿回路顶边（在介质 $2$ 中）的单位向量。相应的底边（在介质 $1$ 中）方向沿 $-\\hat{t}$。根据右手定则，回路表面的法向量 $\\hat{m}$ 为 $\\hat{m} = \\hat{t} \\times \\hat{n}$。\n\n线积分为 $\\oint_{\\partial S} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = \\int_{\\text{顶}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} + \\int_{\\text{底}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} + \\int_{\\text{侧}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell}$。\n\n在 $h \\to 0$ 的极限下：\n-   $\\int_{\\text{顶}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} \\approx (\\mathbf{H}_2 \\cdot \\hat{t}) \\Delta l$。\n-   $\\int_{\\text{底}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} \\approx (\\mathbf{H}_1 \\cdot (-\\hat{t})) \\Delta l = -(\\mathbf{H}_1 \\cdot \\hat{t}) \\Delta l$。\n-   来自短边的贡献与 $h$ 成正比，并趋于零。\n\n安培定律的右侧涉及电流密度 $\\mathbf{J}$ 和位移电流密度 $\\partial \\mathbf{D} / \\partial t$ 的通量。当回路面积 $h \\Delta l \\to 0$ 时，任何有限体密度的通量贡献都消失。然而，表面电流 $\\mathbf{K}_s$ 提供了一个有限的贡献：\n$\\int_S \\mathbf{J}\\cdot \\hat{m}\\, dS \\to \\int (\\mathbf{K}_s \\cdot \\hat{m}) dl = (\\mathbf{K}_s \\cdot \\hat{m}) \\Delta l$。\n\n将线积分与包围的电流相等，然后除以 $\\Delta l$：\n$(\\mathbf{H}_2 \\cdot \\hat{t}) - (\\mathbf{H}_1 \\cdot \\hat{t}) = \\mathbf{K}_s \\cdot \\hat{m} = \\mathbf{K}_s \\cdot (\\hat{t} \\times \\hat{n})$。\n$(\\mathbf{H}_2 - \\mathbf{H}_1) \\cdot \\hat{t} = (\\mathbf{K}_s \\times \\hat{t}) \\cdot (-\\hat{n})$。这看起来很复杂。让我们使用另一个标量三重积恒等式：$A \\cdot (B \\times C) = B \\cdot (C \\times A)$。\n$(\\mathbf{H}_2 - \\mathbf{H}_1) \\cdot \\hat{t} = \\hat{t} \\cdot (\\hat{n} \\times \\mathbf{K}_s)$。\n因为这必须对任意切向向量 $\\hat{t}$ 都成立，所以点积内部向量的切向分量必须相等。由于 $\\hat{n} \\times \\mathbf{K}_s$ 已经是切向的，我们有：\n$(\\mathbf{H}_2 - \\mathbf{H}_1)_{\\text{切向}} = \\hat{n} \\times \\mathbf{K}_s$。\n这可以用向量恒等式 $\\mathbf{v}_{\\text{切向}} = - \\hat{n} \\times (\\hat{n} \\times \\mathbf{v})$ 更紧凑地写出。\n一个更直接和标准的结果是通过巧妙地选择 $\\hat{t}$ 或通过与 $\\hat{n}$ 的叉积来表述关系。标准形式是 $\\hat{n} \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{K}_s$，这与上面推导的分量关系（对于 $\\hat{n}=\\hat{z}$，有 $H_{2x}-H_{1x}=K_{sy}$ 和 $H_{2y}-H_{1y}=-K_{sx}$）是一致的。\n\n**基准关系总结：**\n当 $\\hat{n}$ 从 $1 \\to 2$ 且跳变定义为 $(\\cdot)_2 - (\\cdot)_1$ 时：\n1.  $\\hat{n} \\cdot (\\mathbf{D}_2 - \\mathbf{D}_1) = \\rho_s$\n2.  $\\hat{n} \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{K}_s$\n\n### 逐项分析\n\n**A. 如果将 $\\hat{n}$ 翻转为 $-\\hat{n}$，而跳变保持为 $(\\cdot)_2-(\\cdot)_1$，那么跳变关系式右侧的 $\\rho_s$ 和 $\\mathbf{K}_s$ 的代数符号都会反转。**\n\n令新的法向量为 $\\hat{n}' = -\\hat{n}$。跳变算子不变：$\\jump{(\\cdot)} = (\\cdot)_2 - (\\cdot)_1$。我们用 $\\hat{n}'$ 重写基准关系：\n1.  从 $\\hat{n} \\cdot (\\mathbf{D}_2 - \\mathbf{D}_1) = \\rho_s$ 出发，代入 $\\hat{n} = -\\hat{n}'$。\n    $(-\\hat{n}') \\cdot (\\mathbf{D}_2 - \\mathbf{D}_1) = \\rho_s \\implies \\hat{n}' \\cdot (\\mathbf{D}_2 - \\mathbf{D}_1) = -\\rho_s$。\n2.  从 $\\hat{n} \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{K}_s$ 出发，代入 $\\hat{n} = -\\hat{n}'$。\n    $(-\\hat{n}') \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{K}_s \\implies \\hat{n}' \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = -\\mathbf{K}_s$。\n\n在这两种情况下，为了在左侧用 $\\hat{n}'$ 替换 $\\hat{n}$ 的同时保持方程的物理真实性，右侧的源项 $\\rho_s$ 和 $\\mathbf{K}_s$ 必须加上一个负号。这意味着它们的代数符号反转了。\n**结论：正确**\n\n**B. 如果将 $\\hat{n}$ 翻转为 $-\\hat{n}$，而跳变保持为 $(\\cdot)_2-(\\cdot)_1$，那么 $\\rho_s$ 的代数符号会反转，但 $\\mathbf{K}_s$ 的代数符号不变，因为 $\\mathbf{K}_s$ 是切向的。**\n\n对选项 A 的分析表明，$\\mathbf{K}_s$ 项的符号也反转了。叉积明确地依赖于法向量的方向。$\\mathbf{K}_s$ 是切向的这一事实并不能使关系 $\\hat{n} \\times \\jump{\\mathbf{H}} = \\mathbf{K}_s$ 对 $\\hat{n}$ 的方向不敏感。\n**结论：错误**\n\n**C. 如果跳变以定向方式定义为“正侧减去负侧”，且正侧选择在 $\\hat{n}$ 的方向，那么翻转 $\\hat{n}$ 并相应地重新指定哪一侧为正侧，将使涉及 $\\rho_s$ 和 $\\mathbf{K}_s$ 的右侧保持不变（没有符号反转）。**\n\n让我们检验这个约定。\n-   **初始状态：** $\\hat{n}$ 从 $1 \\to 2$。正侧是 $2$，负侧是 $1$。\n    -   定向跳变：$\\jump{(\\cdot)}_{orient} = (\\cdot)_2 - (\\cdot)_1$。\n    -   方程：$\\hat{n} \\cdot \\jump{\\mathbf{D}}_{orient} = \\rho_s$ 和 $\\hat{n} \\times \\jump{\\mathbf{H}}_{orient} = \\mathbf{K}_s$。\n\n-   **翻转状态：** $\\hat{n}' = -\\hat{n}$。现在 $\\hat{n}'$ 从 $2 \\to 1$。正侧是 $1$，负侧是 $2$。\n    -   新的定向跳变：$\\jump{(\\cdot)}'_{orient} = (\\cdot)_1 - (\\cdot)_2 = - ((\\cdot)_2 - (\\cdot)_1) = -\\jump{(\\cdot)}_{orient}$。\n    -   我们来检查方程形式是否不变，即 $\\hat{n}' \\cdot \\jump{\\mathbf{D}}'_{orient} = \\rho_s$ 和 $\\hat{n}' \\times \\jump{\\mathbf{H}}'_{orient} = \\mathbf{K}_s$ 是否成立。\n    -   对于 $\\mathbf{D}$-场：\n        $\\hat{n}' \\cdot \\jump{\\mathbf{D}}'_{orient} = (-\\hat{n}) \\cdot (- \\jump{\\mathbf{D}}_{orient}) = \\hat{n} \\cdot \\jump{\\mathbf{D}}_{orient} = \\rho_s$。方程成立，右侧不变。\n    -   对于 $\\mathbf{H}$-场：\n        $\\hat{n}' \\times \\jump{\\mathbf{H}}'_{orient} = (-\\hat{n}) \\times (- \\jump{\\mathbf{H}}_{orient}) = \\hat{n} \\times \\jump{\\mathbf{H}}_{orient} = \\mathbf{K}_s$。这个方程也成立，右侧不变。\n\n“定向”约定正是为了在选择法线方向时保持不变而构建的，因为法向量的翻转被跳变算子定义的翻转所抵消。源项 $\\rho_s$ 和 $\\mathbf{K}_s$ 在右侧保持不变。\n**结论：正确**\n\n**D. 磁场切向分量跳变的叉积表示是内在地与方向无关的，因此翻转 $\\hat{n}$ 不能改变与 $\\mathbf{K}_s$ 相关的符号。**\n\n这个前提是错误的。表达式 $\\hat{n} \\times (\\mathbf{H}_2 - \\mathbf{H}_1)$ 从根本上依赖于 $\\hat{n}$ 的方向。如果 $\\hat{n}$ 被 $-\\hat{n}$ 替换，叉积的值会反号。正如对选项 A 的分析所示，这要求在固定跳变定义下改变右侧项 $\\mathbf{K}_s$ 的符号以维持等式。叉积与“方向无关”恰恰相反。\n**结论：错误**\n\n**E. 在没有磁单极子的情况下，并且无论跳变顺序如何，磁通量密度的法向分量的跳变等于表面电荷密度，因此翻转 $\\hat{n}$ 不会影响与 $\\rho_s$ 相关的符号。**\n\n这个陈述包含基本的科学错误。\n1.  由高斯磁定律（$\\oint \\mathbf{B} \\cdot d\\mathbf{S} = 0$）推导出的磁通量密度 $\\mathbf{B}$ 的边界条件是 $\\hat{n} \\cdot (\\mathbf{B}_2 - \\mathbf{B}_1) = 0$。$\\mathbf{B}$ 的法向分量的跳变为零。\n2.  等于表面电荷密度 $\\rho_s$ 的量是**电位移场** $\\mathbf{D}$ 法向分量的跳变，而不是磁通量密度 $\\mathbf{B}$。\n前提在事实上是不正确的，因此结论无效。\n**结论：错误**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "理论与实践的鸿沟常常体现在数值离散化的过程中。本练习提供了一个具体的计算案例，揭示了当朴素地离散化一个包含突变材料参数（如磁导率 $\\mu$）的物理方程时，如何会引入违反基本守恒律（如 $\\nabla \\cdot \\mathbf{B} = 0$）的“伪磁荷”。通过亲手编写代码来诊断并使用散度清理（divergence-cleaning）技术修正这一问题，你将掌握一种重要的数值“调试”技巧，并对混合公式在保持物理守恒性方面的强大功能有更深入的认识。",
            "id": "3290469",
            "problem": "考虑一个单位正方形域上的二维无源静磁构型，其笛卡尔坐标为 $(x,y) \\in [0,1] \\times [0,1]$。磁通量密度 $\\mathbf{B}$ 和磁场强度 $\\mathbf{H}$ 遵循静磁学的麦克斯韦方程组：$\\nabla \\cdot \\mathbf{B} = 0$ 和 $\\nabla \\times \\mathbf{H} = \\mathbf{0}$，其本构关系为 $\\mathbf{B} = \\mu(x,y)\\,\\mathbf{H}$。在无源区域，磁场强度是无旋的，并且可以用标量势 $\\phi$ 表示为 $\\mathbf{H} = -\\nabla \\phi$。因此，该标量势满足一个变系数椭圆守恒律 $\\nabla \\cdot (\\mu(x,y)\\,\\nabla \\phi) = 0$，该定律强制要求 $\\mathbf{B}$ 的法向分量在材料界面上是连续的。\n\n我们研究一个在 $x = 0.5$ 处有突变界面的分段常数磁导率场 $\\mu(x,y)$：\n- 对于 $x  0.5$，令 $\\mu(x,y) = \\mu_1$。\n- 对于 $x \\ge 0.5$，令 $\\mu(x,y) = \\mu_2$。\n\n磁导率值使用真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}$ 亨利每米来定义，即 $\\mu_1 = \\mu_0$ 和 $\\mu_2 = \\mu_r\\,\\mu_0$，其中 $\\mu_r$ 是一个无量纲的相对磁导率对比度参数。对 $\\phi$ 施加狄利克雷边界条件，使得 $\\phi(0, y) = 0$ 安培，$\\phi(1, y) = 1$ 安培，$\\phi(x, 0) = 0$ 安培，以及 $\\phi(x, 1) = 0$ 安培。\n\n目标是量化一个忽略 $\\mu$ 空间变化的离散格式如何在界面附近产生伪磁荷，并提出一种能够减轻这些磁荷的混合格式。具体来说，您必须：\n\n1. 从上述基本定律出发，使用常系数拉普拉斯方程 $\\nabla^2 \\phi = 0$ 和给定的狄利克雷边界条件，在均匀笛卡尔网格上离散化并求解标量势 $\\phi$。然后在同一网格上计算离散磁通量密度 $\\mathbf{B}_{\\text{naive}} = -\\mu(x,y)\\,\\nabla \\phi$。接下来，在区域内部使用中心差分计算 $\\mathbf{B}_{\\text{naive}}$ 的离散散度。报告内部网格点上散度的最大绝对值，该值代表了这种朴素格式引入的伪磁荷密度 $\\rho_m = \\nabla \\cdot \\mathbf{B}$ 的大小。\n\n2. 提出并实现一种混合格式，通过拉格朗日乘子场以弱形式施加 $\\nabla \\cdot \\mathbf{B} = 0$ 来减轻伪磁荷。一个实际的实现是散度清洗投影：找到一个标量场 $u$，使得在域内 $\\Delta u = \\nabla \\cdot \\mathbf{B}_{\\text{naive}}$，在边界 $\\partial \\Omega$ 上具有齐次狄利克雷边界条件 $u=0$，并定义修正场 $\\mathbf{B}_{\\text{mixed}} = \\mathbf{B}_{\\text{naive}} - \\nabla u$。计算 $\\mathbf{B}_{\\text{mixed}}$ 的离散散度，并报告内部网格点上的最大绝对值。\n\n您的程序必须在 $[0,1]^2$ 上使用一个 $N_x = 64$ 和 $N_y = 64$ 个节点的均匀网格，间距为 $\\Delta x = 1/(N_x-1)$ 和 $\\Delta y = 1/(N_y-1)$。离散梯度和散度应在内部节点上使用中心差分，仅在边界处为计算梯度而使用单边差分（散度统计量在内部节点上评估）。所有量必须在以下物理单位中进行一致计算：\n- $\\mu$ 单位为亨利每米 (H/m)，\n- $\\phi$ 单位为安培 (A)，\n- $\\mathbf{H}$ 单位为安培每米 (A/m)，\n- $\\mathbf{B}$ 单位为特斯拉 (T)，\n- $\\nabla \\cdot \\mathbf{B}$ 单位为特斯拉每米 (T/m)。\n\n测试套件：\n评估该格式在三种相对磁导率对比度下的表现：\n- 情况 1（基准，无对比度）：$\\mu_r = 1$，\n- 情况 2（中等对比度）：$\\mu_r = 10$，\n- 情况 3（高对比度）：$\\mu_r = 1000$。\n\n对于每种情况，计算两个浮点数结果：\n- $\\mathbf{B}_{\\text{naive}}$ 在内部的最大绝对散度，单位为 T/m。\n- $\\mathbf{B}_{\\text{mixed}}$ 在内部的最大绝对散度，单位为 T/m。\n\n您的程序应生成单行输出，包含一个方括号括起来的、由逗号分隔的六个结果列表，顺序为 [naive_case1, naive_case2, naive_case3, mixed_case1, mixed_case2, mixed_case3]。例如，确切的输出格式必须匹配：\"[r1,r2,r3,r4,r5,r6]\"。所有六个条目都必须是浮点数，单位为特斯拉每米 (T/m)。",
            "solution": "用户提供的问题是计算电磁学中一个有效且适定的练习。它要求演示当朴素地离散化一个带材料界面的静磁问题时伪磁荷的产生，然后减轻这种影响。该问题在科学上是合理的，包含了所有必要信息，其目标明确且可形式化。\n\n对于每个指定的材料对比度参数 $\\mu_r$，解题过程遵循问题描述，分为两个主要部分。所有计算都在一个均匀的 $N_x \\times N_y$ 网格上进行，其中 $N_x=N_y=64$。\n\n### 第 1 部分：朴素格式与伪磁荷\n\n对于具有可变磁导率 $\\mu(x,y)$ 的无源区域，磁标势 $\\phi$ 的正确控制方程是守恒律 $\\nabla \\cdot (\\mu \\nabla\\phi) = 0$。此方程确保了磁通量密度 $\\mathbf{B}$ 的法向分量在材料界面上是连续的。\n\n问题中定义的“朴素”格式将其简化为常系数拉普拉斯方程 $\\nabla^2 \\phi = 0$。这种简化忽略了在位于 $x=0.5$ 的材料界面上磁导率的跳变。\n\n1.  **$\\phi$ 的离散化与求解**：我们在网格的内部节点上离散化拉普拉斯方程 $\\nabla^2 \\phi = 0$。使用中心五点有限差分模板，在内部网格点 $(i,j)$ 处的方程变为：\n    $$\n    \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{(\\Delta x)^2} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{(\\Delta y)^2} = 0\n    $$\n    由于 $\\Delta x = \\Delta y = h$，这简化为：\n    $$\n    \\phi_{i+1,j} + \\phi_{i-1,j} + \\phi_{i,j+1} + \\phi_{i,j-1} - 4\\phi_{i,j} = 0\n    $$\n    为所有 $(N_x-2) \\times (N_y-2)$ 个内部点建立这组线性方程。给定的狄利克雷边界条件——$\\phi(0,y)=0$、$\\phi(x,0)=0$、$\\phi(x,1)=0$ 和 $\\phi(1,y)=1$——被并入线性系统的右侧。求解得到的稀疏线性系统 $\\mathbf{A}\\vec{\\phi}_{int} = \\vec{b}$，以获得内部势值向量 $\\vec{\\phi}_{int}$。然后，通过将解出的内部值与已知的边界值相结合，组装完整的势场 $\\phi$。\n\n2.  **计算 $\\mathbf{B}_{\\text{naive}}$**：朴素磁通量密度计算为 $\\mathbf{B}_{\\text{naive}} = -\\mu(x,y)\\,\\nabla\\phi$。\n    - 分段常数磁导率场 $\\mu(x,y)$ 在网格上定义，其中对于 $x  0.5$，$\\mu=\\mu_1$；对于 $x \\ge 0.5$，$\\mu=\\mu_2$。\n    - 梯度 $\\nabla\\phi$ 使用中心差分计算内部点，并在边界处使用单边差分进行数值计算。\n\n3.  **计算伪磁荷密度 $\\rho_m$**：伪磁荷密度是计算场的散度，即 $\\rho_m = \\nabla\\cdot\\mathbf{B}_{\\text{naive}}$。该散度在内部网格点上使用中心差分格式计算：\n    $$\n    (\\nabla \\cdot \\mathbf{B})_{i,j} \\approx \\frac{(B_x)_{i+1,j} - (B_x)_{i-1,j}}{2\\Delta x} + \\frac{(B_y)_{i,j+1} - (B_y)_{i,j-1}}{2\\Delta y}\n    $$\n    在区域内部，这个离散散度的最大绝对值 $\\max|\\nabla \\cdot \\mathbf{B}_{\\text{naive}}|$ 量化了数值误差的严重程度。此误差的产生是因为朴素的 $\\phi$ 解在界面上具有连续的导数，因此当乘以不连续的 $\\mu$ 时，得到的 $\\mathbf{B}_{\\text{naive}}$ 的法向分量不连续，从而违反了 $\\nabla \\cdot \\mathbf{B} = 0$。\n\n### 第 2 部分：用于散度清洗的混合格式\n\n为了修正这个误差，采用了一种散度清洗程序。这是一种弱形式施加散度约束的投影方法。\n\n1.  **求解修正泊松方程**：通过求解泊松方程 $\\Delta u = \\nabla \\cdot \\mathbf{B}_{\\text{naive}}$ 来找到一个修正势 $u$，其中源项是在上一步中计算的伪磁荷密度。此方程受齐次狄利克雷边界条件（即在所有边界上 $u=0$）的约束。我们使用与求解 $\\phi$ 相同的基于有限差分的线性系统求解器来求解此方程。\n\n2.  **计算修正场 $\\mathbf{B}_{\\text{mixed}}$**：计算修正势的梯度 $\\nabla u$。然后将修正后的磁通量密度定义为：\n    $$\n    \\mathbf{B}_{\\text{mixed}} = \\mathbf{B}_{\\text{naive}} - \\nabla u\n    $$\n\n3.  **验证修正效果**：计算修正场的散度。根据构造：\n    $$\n    \\nabla \\cdot \\mathbf{B}_{\\text{mixed}} = \\nabla \\cdot (\\mathbf{B}_{\\text{naive}} - \\nabla u) = \\nabla \\cdot \\mathbf{B}_{\\text{naive}} - \\nabla^2 u\n    $$\n    由于我们求解了 $\\nabla^2 u = \\nabla \\cdot \\mathbf{B}_{\\text{naive}}$，修正场的散度应在数值精度范围内为零。我们在内部网格上计算 $\\max|\\nabla \\cdot \\mathbf{B}_{\\text{mixed}}|$ 来验证清洗程序的有效性。\n\n下面的程序为三个指定的相对磁导率对比度 $\\mu_r$ 值实现了这整个过程。它为离散拉普拉斯算子组装稀疏矩阵，求解 $\\phi$ 和 $u$ 的线性系统，并计算所需的散度统计量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef _solve_for_contrast(mu_r, Nx, Ny):\n    \"\"\"\n    Solves the magnetostatics problem for a given permeability contrast,\n    calculating the max divergence for both naive and mixed formulations.\n    \n    Args:\n        mu_r (float): The relative permeability contrast.\n        Nx (int): Number of grid points in the x-direction.\n        Ny (int): Number of grid points in the y-direction.\n\n    Returns:\n        tuple: A tuple containing:\n            - max_div_naive (float): Max absolute divergence of B_naive.\n            - max_div_mixed (float): Max absolute divergence of B_mixed.\n    \"\"\"\n    # 1. SETUP: Constants, Grid, and Operators\n    \n    # Physical constants and material properties in SI units\n    MU0 = 4.0 * np.pi * 1e-7  # Vacuum permeability (H/m)\n    mu1 = MU0\n    mu2 = mu_r * MU0\n    \n    # Grid parameters\n    Lx, Ly = 1.0, 1.0\n    dx = Lx / (Nx - 1)\n    dy = Ly / (Ny - 1)\n    h = dx  # Grid spacing is uniform\n\n    # Interior grid dimensions\n    Mx, My = Nx - 2, Ny - 2\n    \n    # Construct the 2D discrete Laplacian operator, L_2D, for interior nodes\n    # such that (L_2D @ u_flat) approximates (nabla^2 u) without the h^2 scaling.\n    L_1D = sparse.diags([1, -2, 1], [-1, 0, 1], shape=(Mx, Mx), format='csr')\n    I_M = sparse.identity(Mx, format='csr')\n    # Operator built for row-major (C-style) flattening of the 2D grid\n    L_2D = sparse.kron(I_M, L_1D) + sparse.kron(L_1D, I_M)\n\n    # 2. NAIVE SCHEME: Solve Laplace's equation for phi\n    \n    # Set up the Right-Hand Side (RHS) vector for the potential phi.\n    # The non-zero boundary condition phi(1, y) = 1 affects the last column of interior nodes.\n    b_phi_matrix = np.zeros((My, Mx))\n    b_phi_matrix[:, -1] = -1.0  # Contribution from phi_{i+1,j} where phi_{i+1,j}=1\n    b_phi_flat = b_phi_matrix.ravel()\n\n    # Solve the linear system L_2D * phi = b for interior phi values\n    phi_int_flat = spsolve(L_2D, b_phi_flat)\n    phi_int = phi_int_flat.reshape((My, Mx))\n\n    # Assemble the full potential field, including boundaries\n    phi = np.zeros((Ny, Nx))\n    phi[1:-1, 1:-1] = phi_int\n    phi[:, -1] = 1.0  # Set phi(1, y) = 1 A\n\n    # Compute the naive magnetic flux density B_naive = -mu(x,y) * grad(phi)\n    mu = np.full((Ny, Nx), mu1)\n    # The interface is at x = 0.5. Grid points i where x[i] = 0.5 get mu2.\n    interface_idx = int(np.ceil(0.5 / dx))\n    mu[:, interface_idx:] = mu2\n    \n    # Compute the gradient of phi using centered differences in the interior\n    grad_phi_y, grad_phi_x = np.gradient(phi, dy, dx)\n\n    B_naive_x = -mu * grad_phi_x\n    B_naive_y = -mu * grad_phi_y\n\n    # Compute the divergence of B_naive on the interior grid\n    div_B_naive_x = (B_naive_x[1:-1, 2:] - B_naive_x[1:-1, :-2]) / (2 * dx)\n    div_B_naive_y = (B_naive_y[2:, 1:-1] - B_naive_y[:-2, 1:-1]) / (2 * dy)\n    div_B_naive = div_B_naive_x + div_B_naive_y\n    max_div_naive = np.max(np.abs(div_B_naive))\n\n    # 3. MIXED FORMULATION: Divergence cleaning\n    \n    # Solve the Poisson equation: Delta u = div(B_naive) with homogeneous Dirichlet BCs\n    # The RHS is scaled by h^2 to match the unscaled L_2D operator.\n    b_u_flat = (h**2) * div_B_naive.ravel()\n    \n    u_int_flat = spsolve(L_2D, b_u_flat)\n    u_int = u_int_flat.reshape((My, Mx))\n\n    # Assemble the full correction potential field with zero boundaries\n    u = np.zeros((Ny, Nx))\n    u[1:-1, 1:-1] = u_int\n\n    # Compute the corrected field B_mixed = B_naive - grad(u)\n    grad_u_y, grad_u_x = np.gradient(u, dy, dx)\n    B_mixed_x = B_naive_x - grad_u_x\n    B_mixed_y = B_naive_y - grad_u_y\n\n    # Compute the divergence of B_mixed on the interior grid\n    div_B_mixed_x = (B_mixed_x[1:-1, 2:] - B_mixed_x[1:-1, :-2]) / (2 * dx)\n    div_B_mixed_y = (B_mixed_y[2:, 1:-1] - B_mixed_y[:-2, 1:-1]) / (2 * dy)\n    div_B_mixed = div_B_mixed_x + div_B_mixed_y\n    max_div_mixed = np.max(np.abs(div_B_mixed))\n\n    return max_div_naive, max_div_mixed\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        1.0,      # Case 1: no contrast\n        10.0,     # Case 2: moderate contrast\n        1000.0,   # Case 3: high contrast\n    ]\n    Nx, Ny = 64, 64\n\n    results_naive = []\n    results_mixed = []\n    \n    for mu_r in test_cases:\n        naive_div, mixed_div = _solve_for_contrast(mu_r, Nx, Ny)\n        results_naive.append(naive_div)\n        results_mixed.append(mixed_div)\n\n    # Combine results in the required order: [naive_all_cases, mixed_all_cases]\n    final_results = results_naive + results_mixed\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6e}' for r in final_results)}]\")\n\nsolve()\n```"
        }
    ]
}