{
    "hands_on_practices": [
        {
            "introduction": "In computational electromagnetics, complex field distributions are often decomposed into a basis of simpler, orthogonal modes. This practice explores this principle in the context of a cylindrical waveguide, where an arbitrary surface current excites a spectrum of guided modes. The exercise requires you to calculate the Fourier series coefficients of a given current distribution, which directly represent the coupling efficiency to each orthogonal waveguide mode . This problem builds a crucial bridge between the abstract theory of Fourier series and the physical concept of modal excitation, a fundamental technique in analyzing and designing waveguide components.",
            "id": "3309343",
            "problem": "A perfectly electrically conducting (PEC) cylindrical waveguide of radius $R$ is filled with a homogeneous, isotropic, lossless medium characterized by permittivity $\\epsilon$ and permeability $\\mu$. The waveguide axis is the $z$-axis in cylindrical coordinates $(r,\\phi,z)$. At the inner wall $r=R$, an impressed nonuniform azimuthal surface current density flows along $\\hat{\\mathbf{z}}$, given by\n$$\nK_{z}(\\phi) = K_{0}\\,\\exp\\!\\big(\\alpha \\cos\\phi\\big)\\,\\cos(3\\phi),\n$$\nwhere $K_{0}$ and $\\alpha$ are real constants with $K_{0}\\neq 0$ and $\\alpha\\neq 0$. The waveguide supports sets of orthogonal transverse electric (TE$_{z}$) and transverse magnetic (TM$_{z}$) modes with separable azimuthal dependence $\\exp(i m \\phi)$ for integer $m\\in\\mathbb{Z}$.\n\nStarting from the boundary condition of Maxwell’s equations at a PEC, the modal orthogonality over the azimuthal coordinate $\\phi\\in[0,2\\pi)$, and the completeness of the $\\exp(i m\\phi)$ basis on $[0,2\\pi)$, derive the Fourier series representation of the impressed current $K_{z}(\\phi)$ and the corresponding dimensionless coupling coefficient $a_{m}$ to a mode with azimuthal index $m$, defined by\n$$\na_{m} \\equiv \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} K_{z}(\\phi)\\,\\exp(-i m\\phi)\\,d\\phi.\n$$\nThen, determine the closed-form analytic expression for the specific coupling coefficient $a_{2}$ associated with azimuthal index $m=2$.\n\nExpress your final answer as a single closed-form analytic expression in terms of standard special functions. Do not perform any numerical approximation or rounding. No physical units are required for $a_{2}$ because it is dimensionless by definition.",
            "solution": "The problem requires the derivation of the dimensionless coupling coefficient $a_{2}$ for an impressed surface current density $K_{z}(\\phi)$ in a cylindrical waveguide. The analysis begins with validating the problem statement.\n\n### Problem Validation\n**1. Extracted Givens:**\n- A perfectly electrically conducting (PEC) cylindrical waveguide of radius $R$.\n- The medium filling the waveguide is homogeneous, isotropic, and lossless with permittivity $\\epsilon$ and permeability $\\mu$.\n- The system is described in cylindrical coordinates $(r, \\phi, z)$, with the waveguide axis along the $z$-axis.\n- An impressed surface current density is present at the inner wall $r=R$, given by $K_{z}(\\phi) = K_{0}\\,\\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)$, where $K_{0}$ and $\\alpha$ are real, non-zero constants.\n- The waveguide supports transverse electric (TE$_{z}$) and transverse magnetic (TM$_{z}$) modes with azimuthal dependence $\\exp(i m \\phi)$ for integers $m \\in \\mathbb{Z}$.\n- The definition of the dimensionless coupling coefficient $a_{m}$ is provided as $a_{m} \\equiv \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} K_{z}(\\phi)\\,\\exp(-i m\\phi)\\,d\\phi$.\n\n**2. Validation Verdict:**\nThe problem is scientifically grounded in the principles of classical electromagnetism, specifically waveguide theory and modal analysis. The use of a Fourier series to represent an excitation source is a standard technique in computational electromagnetics. The problem is well-posed, as it asks for the calculation of a uniquely defined mathematical quantity (a Fourier coefficient) from a well-behaved function. All necessary information is provided, and there are no internal contradictions or scientifically unsound premises. The problem is objective and requires a rigorous mathematical derivation. Therefore, the problem is deemed **valid**.\n\n### Solution Derivation\nThe primary objective is to calculate the coupling coefficient $a_{m}$ for a general integer mode index $m$, and then specialize the result for $m=2$. The coefficient $a_{m}$ is defined as the normalized complex Fourier series coefficient of the current distribution $K_{z}(\\phi)$.\n\nThe definition of $a_{m}$ is:\n$$\na_{m} = \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} K_{z}(\\phi)\\,\\exp(-i m\\phi)\\,d\\phi\n$$\nSubstituting the given expression for $K_{z}(\\phi) = K_{0}\\,\\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)$:\n$$\na_{m} = \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} \\left[K_{0}\\,\\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)\\right]\\,\\exp(-i m\\phi)\\,d\\phi\n$$\nThe constant $K_{0}$ cancels, as expected for a dimensionless coefficient:\n$$\na_{m} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)\\,\\exp(-i m\\phi)\\,d\\phi\n$$\nTo evaluate this integral, we express the cosine term using Euler's formula, $\\cos(x) = \\frac{1}{2}(\\exp(ix) + \\exp(-ix))$:\n$$\n\\cos(3\\phi) = \\frac{\\exp(i 3\\phi) + \\exp(-i 3\\phi)}{2}\n$$\nSubstituting this into the integral for $a_{m}$:\n$$\na_{m} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\left(\\frac{\\exp(i 3\\phi) + \\exp(-i 3\\phi)}{2}\\right) \\exp(-i m\\phi)\\,d\\phi\n$$\nWe can distribute the terms and split the integral into two parts:\n$$\na_{m} = \\frac{1}{4\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\left[ \\exp(i 3\\phi)\\exp(-i m\\phi) + \\exp(-i 3\\phi)\\exp(-i m\\phi) \\right]\\,d\\phi\n$$\n$$\na_{m} = \\frac{1}{4\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m-3)\\phi)\\,d\\phi + \\frac{1}{4\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m+3)\\phi)\\,d\\phi\n$$\nThese integrals are related to the integral representation of the modified Bessel function of the first kind, $I_{n}(z)$, which is defined as the $n$-th coefficient in the Fourier series expansion of $\\exp(z \\cos\\theta)$:\n$$\nI_{n}(z) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(z \\cos\\theta)\\,\\exp(-i n\\theta)\\,d\\theta\n$$\nBy comparing this definition with the terms in our expression for $a_{m}$, we can identify each integral. The first integral corresponds to $n=m-3$ and $z=\\alpha$. The second integral corresponds to $n=m+3$ and $z=\\alpha$.\nThus, we can write $a_{m}$ in terms of modified Bessel functions:\n$$\na_{m} = \\frac{1}{2} \\left[ \\left(\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m-3)\\phi)\\,d\\phi\\right) + \\left(\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m+3)\\phi)\\,d\\phi\\right) \\right]\n$$\n$$\na_{m} = \\frac{1}{2} \\left[ I_{m-3}(\\alpha) + I_{m+3}(\\alpha) \\right]\n$$\nThis is the general expression for the dimensionless coupling coefficient for any azimuthal mode index $m$. The problem asks for the specific coefficient $a_{2}$, which is found by setting $m=2$:\n$$\na_{2} = \\frac{1}{2} \\left[ I_{2-3}(\\alpha) + I_{2+3}(\\alpha) \\right] = \\frac{1}{2} \\left[ I_{-1}(\\alpha) + I_{5}(\\alpha) \\right]\n$$\nThe modified Bessel functions of the first kind possess the symmetry property $I_{-n}(z) = I_{n}(z)$ for integer $n$. Applying this property for $n=1$:\n$$\nI_{-1}(\\alpha) = I_{1}(\\alpha)\n$$\nSubstituting this back into the expression for $a_{2}$ yields the final closed-form analytic expression:\n$$\na_{2} = \\frac{1}{2} \\left( I_{1}(\\alpha) + I_{5}(\\alpha) \\right)\n$$\nThis expression is in terms of standard special functions, as required.",
            "answer": "$$\n\\boxed{\\frac{1}{2} \\left( I_{1}(\\alpha) + I_{5}(\\alpha) \\right)}\n$$"
        },
        {
            "introduction": "While analytical Fourier transforms are powerful, practical computational electromagnetics relies on their discrete counterpart, the Discrete Fourier Transform (DFT), often implemented as the Fast Fourier Transform (FFT). This exercise delves into a critical and frequently misunderstood aspect of practical spectral analysis: the effect of zero-padding a time-domain signal before applying the DFT . By distinguishing between fundamental spectral resolution (set by observation time) and the computational grid of the DFT, you will develop the correct intuition for interpreting numerical spectra and using zero-padding as a tool for interpolation, not for creating new information.",
            "id": "3309397",
            "problem": "A computational electromagnetics team uses a Finite-Difference Time-Domain (FDTD) simulation to compute a time-domain response of the electric field at a fixed spatial location in a lossless waveguide. The discrete sequence is denoted by $x[n]$, acquired at uniform sampling interval $\\Delta t$, yielding sampling frequency $f_{s} = 1/\\Delta t$. The acquisition length is $N$ samples, providing a total observation time $T = N \\Delta t$. The team computes the Discrete Fourier Transform (DFT) for spectral modal analysis to identify resonant peaks corresponding to guided modes.\n\nAs a fundamental base, they use the following definitions. The Discrete-Time Fourier Transform (DTFT) of the windowed sequence $x[n]$ of length $N$ is\n$$\nX\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n} \\, ,\n$$\nwhere $\\omega$ is the normalized radian frequency per sample. The $N$-point Discrete Fourier Transform (DFT) is\n$$\nX_{N}[k] = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\frac{2\\pi}{N} k n} \\quad \\text{for} \\quad k \\in \\{0,1,\\dots,N-1\\} \\, .\n$$\nThe team sometimes zero-pads the time sequence by forming $x_{p}[n]$, where $x_{p}[n] = x[n]$ for $0 \\le n \\le N-1$ and $x_{p}[n] = 0$ for $N \\le n \\le M-1$, and then computes the $M$-point DFT\n$$\nX_{M}[k] = \\sum_{n=0}^{M-1} x_{p}[n]\\, e^{-j \\frac{2\\pi}{M} k n} \\quad \\text{for} \\quad k \\in \\{0,1,\\dots,M-1\\} \\, .\n$$\nAssume $M = L N$ with integer $L \\ge 2$.\n\nFrom these definitions and first principles of Fourier analysis, derive how zero-padding affects the discrete spectrum sampled by the DFT, and determine whether it changes the underlying spectral resolution of the windowed signal. Use your reasoning to assess the suitability of zero-padding for peak localization in modal analysis of the simulated waveguide. In particular, leverage the fact that the spectrum of a finite-length sequence is the DTFT of the true underlying infinite-length sequence multiplied by a finite window, and that the spectral resolution is governed by the observation time $T$ rather than the number of frequency grid points.\n\nSelect all statements that are necessarily true under the assumptions above:\n\nA. Zero-padding from length $N$ to length $M$ changes the Rayleigh resolution in hertz from $f_{s}/N$ to $f_{s}/M$.\n\nB. Zero-padding a finite sequence corresponds to sampling the same DTFT $X\\!\\left(e^{j\\omega}\\right)$ at a finer frequency grid, without altering the continuous spectrum of the windowed signal.\n\nC. Zero-padding reduces spectral leakage by shrinking the mainlobe of the window’s spectral response.\n\nD. Zero-padding can improve peak localization of a narrowband mode in the DFT magnitude by increasing the number of DFT bins spanning the mainlobe, enabling smoother interpolation of the maximum.\n\nE. Zero-padding changes the peak amplitude of an isolated modal component in the DFT magnitude because energy is conserved but distributed over more bins.",
            "solution": "The problem statement is a valid application of Fourier analysis principles to a common signal processing task in computational science. All definitions are standard, and the question is well-posed and scientifically grounded.\n\nThe core of the problem lies in understanding the relationship between the Discrete-Time Fourier Transform (DTFT), the Discrete Fourier Transform (DFT), and the effect of zero-padding.\n\nThe finite acquisition of $N$ samples, $x[n]$, means the signal is implicitly multiplied by a rectangular window of length $N$. The continuous spectrum of this finite-length signal is given by its DTFT:\n$$\nX\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n}\n$$\nThis expression defines the spectrum for any continuous normalized radian frequency $\\omega$. The shape of $X(e^{j\\omega})$ is fixed by the $N$ samples of $x[n]$. Specifically, it is the convolution of the true underlying signal's spectrum with the Fourier transform of the rectangular window. The ability to distinguish two closely spaced spectral features, known as **spectral resolution**, is fundamentally limited by the mainlobe width of this window's transform, which is inversely proportional to the window's time duration, $T = N\\Delta t$. The resolution in Hertz is approximately $\\Delta f_{res} \\approx 1/T = f_s/N$.\n\nThe $N$-point DFT, $X_N[k]$, does not compute the entire continuous spectrum $X(e^{j\\omega})$. Instead, it provides samples of this spectrum at $N$ discrete frequencies:\n$$\nX_{N}[k] = X(e^{j\\omega}) \\Big|_{\\omega = \\frac{2\\pi k}{N}} = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\frac{2\\pi}{N} k n}\n$$\nThe spacing between these frequency samples (the bin spacing) is $\\Delta f_{bin} = f_s / N$.\n\nNow, let's consider zero-padding. The sequence $x[n]$ is extended to length $M  N$ by appending $M-N$ zeros, creating $x_p[n]$. The DTFT of this new, longer sequence is:\n$$\nX_p\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{M-1} x_{p}[n]\\, e^{-j \\omega n}\n$$\nSince $x_p[n] = x[n]$ for $0 \\le n \\le N-1$ and $x_p[n] = 0$ for $n \\ge N$, the sum is identical to the original DTFT:\n$$\nX_p\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n} = X\\!\\left(e^{j\\omega}\\right)\n$$\nThis is a critical insight: **zero-padding does not alter the underlying continuous spectrum of the windowed signal**.\n\nWhen an $M$-point DFT is computed on the zero-padded sequence, we are again sampling this same continuous spectrum, but now at $M$ points:\n$$\nX_{M}[k] = X_p(e^{j\\omega}) \\Big|_{\\omega = \\frac{2\\pi k}{M}} = X(e^{j\\omega}) \\Big|_{\\omega = \\frac{2\\pi k}{M}}\n$$\nSince $M  N$, the frequency grid is now finer. The new bin spacing is $\\Delta f'_{bin} = f_s / M$, which is smaller than the original $f_s / N$. Zero-padding is thus a method of interpolating the DFT, providing more points to better visualize the shape of the underlying continuous spectrum $X(e^{j\\omega})$. It does not add any new information and therefore cannot improve the fundamental spectral resolution.\n\nWith these principles established, we evaluate each statement.\n\n**A. Zero-padding from length $N$ to length $M$ changes the Rayleigh resolution in hertz from $f_{s}/N$ to $f_{s}/M$.**\nThe Rayleigh resolution, or more generally, the spectral resolution, is determined by the length of the observation window, $N$ (or total time $T = N\\Delta t$). The resolution is approximately $\\Delta f_{res} \\approx f_s/N$. Zero-padding does not change the original number of non-zero data samples $N$, nor the observation time $T$. Therefore, it does not change the spectral resolution. The quantity $f_s/M$ represents the new, finer frequency bin spacing of the DFT, which is a computational parameter, not a measure of physical resolvability. Conflating bin spacing with resolution is a common but fundamental error.\n**Verdict: Incorrect.**\n\n**B. Zero-padding a finite sequence corresponds to sampling the same DTFT $X\\!\\left(e^{j\\omega}\\right)$ at a finer frequency grid, without altering the continuous spectrum of the windowed signal.**\nAs derived above, zero-padding does not change the DTFT of the windowed sequence ($X_p(e^{j\\omega}) = X(e^{j\\omega})$). The $M$-point DFT of the padded sequence calculates samples of this DTFT at frequencies $\\omega_k = 2\\pi k/M$, while the original $N$-point DFT used frequencies $\\omega_k = 2\\pi k/N$. Since $M  N$, the spacing $2\\pi/M$ is smaller than $2\\pi/N$, meaning the sampling grid is finer. This statement is a precise and accurate description of the effect of zero-padding.\n**Verdict: Correct.**\n\n**C. Zero-padding reduces spectral leakage by shrinking the mainlobe of the window’s spectral response.**\nSpectral leakage is a consequence of windowing, specifically the convolution of the signal spectrum with the window's spectrum. The properties of leakage (e.g., mainlobe width, sidelobe height) are determined entirely by the shape and length of the window function. In this case, the implicit window is a rectangular window of length $N$. Zero-padding does not change this window. To reduce the mainlobe width (and thus improve resolution), one must increase the observation time $T$ (i.e., increase $N$ with actual signal data, not zeros). To reduce sidelobe levels (leakage), one could apply a different window function (e.g., Hann, Hamming) to the $N$ samples before the DFT. Zero-padding does neither.\n**Verdict: Incorrect.**\n\n**D. Zero-padding can improve peak localization of a narrowband mode in the DFT magnitude by increasing the number of DFT bins spanning the mainlobe, enabling smoother interpolation of the maximum.**\nA resonant mode will appear as a peak (a mainlobe from the windowing effect) in the continuous spectrum $X(e^{j\\omega})$. The $N$-point DFT provides only a sparse sampling of this peak, and it is likely that no DFT bin falls exactly at the true maximum. This \"picket-fence effect\" can lead to significant underestimation of the peak's amplitude and an error in its frequency location. By zero-padding to length $M$, we compute more DFT bins. These additional bins fall between the original bins, providing a denser sampling of the spectral peak's shape. This denser set of points creates a 'smoother' looking spectrum and allows the maximum value among the $M$ bins to be a better approximation of the true peak's amplitude and frequency. This is precisely what is meant by improving peak localization.\n**Verdict: Correct.**\n\n**E. Zero-padding changes the peak amplitude of an isolated modal component in the DFT magnitude because energy is conserved but distributed over more bins.**\nThis statement contains two parts: a claim and a reason. The claim that the peak amplitude *changes* is not necessarily true. If a signal frequency component happens to fall exactly on one of the original $N$ DFT bins, and also on one of the $M$ bins (which occurs if $M/N$ is an integer and the original bin is a multiple of $N/(\\text{common divisors})$), the calculated DFT magnitude at that peak can be identical. For example, for a DC signal $x[n]=A$, the peak at $k=0$ is $X_N[0]=AN$ and $X_M[0]=AN$, which are identical. Therefore, the amplitude does not necessarily change.\nMore importantly, the reasoning provided is flawed. The DFT coefficients' magnitudes are not energy values. Parseval's theorem relates the signal's energy to the sum of squared DFT magnitudes: $\\sum |x[n]|^2 = \\frac{1}{N}\\sum |X_N[k]|^2$. For the zero-padded case, $\\sum |x[n]|^2 = \\frac{1}{M}\\sum |X_M[k]|^2$. This implies $\\sum |X_M[k]|^2 = (M/N) \\sum |X_N[k]|^2$. The sum of squared magnitudes (a proxy for total energy in the spectrum) *increases* by a factor of $M/N$, it is not conserved. The idea of energy being \"distributed\" is a misapplication of concepts from Power Spectral Density (PSD) estimation (where normalization by frequency bin width is key) to the standard DFT.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "Many electromagnetic systems, from antennas to nanoparticles, exhibit sharp resonant behaviors that are critical to their function. Accurately characterizing these high-$Q$ resonances from sampled time-domain data requires tools that go beyond the standard FFT. This practice introduces the Chirp-Z Transform (CZT) as a flexible \"zoom lens\" for performing high-resolution spectral analysis over a specific frequency band of interest . Furthermore, it reinforces the fundamental connection between a system's frequency response and its poles in the complex frequency plane by having you verify the results using an independent method based on numerical contour integration, providing a powerful workflow for modern resonance analysis.",
            "id": "3309368",
            "problem": "You are given a linear, time-invariant model for the frequency-domain transfer function of electromagnetic scattering by a homogeneous spherical particle whose resonant response is dominated by Lorenz-Mie resonances. In a quasinormal-mode approximation, the transfer function is modeled as a superposition of simple poles in angular frequency. The computational task is to resolve very sharp resonant peaks from a numerically sampled impulse response using the Chirp-Z Transform (CZT) and to independently estimate the pole locations by contour integration in complex angular frequency. From these pole locations, estimate quality factors. Then compare the quality factors obtained by the CZT-based spectral width with those obtained from complex-frequency contour integration.\n\nFundamental base and definitions:\n\n- Maxwell’s equations in the frequency domain for material systems imply a Green’s function with poles corresponding to resonant (quasinormal) modes. For a spherical scatterer, Lorenz-Mie theory predicts sharp resonances that can be approximated as isolated simple poles in angular frequency.\n- The Fourier transform of a causal impulse response $h(t)$ is defined by $H(\\omega) = \\int_{0}^{\\infty} h(t) e^{-i \\omega t} \\, dt$, where $\\omega$ is angular frequency in radians per second. This convention produces a rational form for exponentially decaying oscillatory responses.\n- For each mode $k$, we model the impulse response as $h_k(t) = b_k e^{-\\gamma_k t} e^{i \\omega_{0,k} t} u(t)$, where $u(t)$ is the unit step function, $b_k$ is a complex residue-like amplitude, $\\gamma_k  0$ is the modal decay rate in radians per second, and $\\omega_{0,k}  0$ is the modal center angular frequency in radians per second. The corresponding Fourier transform term has the algebraic form $H_k(\\omega) = \\dfrac{b_k}{\\gamma_k + i (\\omega - \\omega_{0,k})} = \\dfrac{-i b_k}{\\omega - (\\omega_{0,k} - i \\gamma_k)}$, a simple pole at $\\omega_{p,k} = \\omega_{0,k} - i \\gamma_k$.\n- The total transfer function is $H(\\omega) = \\sum_{k} H_k(\\omega)$, a sum over modes.\n- The Quality factor (Q-factor) of a single isolated resonance is defined by $Q = \\dfrac{\\omega_0}{\\Delta \\omega}$, where $\\omega_0$ is the resonant angular frequency and $\\Delta \\omega$ is the full width at half maximum (FWHM) of the power spectrum. For a single pole $H_k(\\omega)$ with $|H_k(\\omega)|^2$ being a Lorentzian, the half-power width is $\\Delta \\omega = 2 \\gamma_k$, giving $Q = \\dfrac{\\omega_0}{2 \\gamma_k}$.\n- The Chirp-Z Transform (CZT) evaluates the discrete-time Fourier transform along a general logarithmic spiral in the complex plane. Given uniformly sampled $h[n] = h(n \\Delta t)$ with time step $\\Delta t$, the CZT evaluates the $Z$-transform $X(z) = \\sum_{n=0}^{N-1} h[n] z^{-n}$ along points $z_k = a w^{-k}$, where $a$ and $w$ lie on the unit circle so that $z_k = e^{i \\omega_k \\Delta t}$ parametrizes a frequency arc with $\\omega_k = \\omega_{\\text{start}} + k \\Delta \\omega$.\n- Complex contour integration around an isolated simple pole at $\\omega_p$ yields $\\displaystyle \\oint_{C} H(\\omega) \\, d\\omega = 2 \\pi i \\, \\text{Res}\\!\\left(H,\\omega_p\\right)$ and $\\displaystyle \\oint_{C} \\omega H(\\omega) \\, d\\omega = 2 \\pi i \\, \\omega_p \\, \\text{Res}\\!\\left(H,\\omega_p\\right)$. For an isolated simple pole and a contour $C$ enclosing only that pole, the ratio $\\left( \\oint_C \\omega H(\\omega) \\, d\\omega \\right) \\Big/ \\left( \\oint_C H(\\omega) \\, d\\omega \\right)$ returns the pole location $\\omega_p$. The Q-factor is then $Q = \\dfrac{\\Re(\\omega_p)}{-2 \\Im(\\omega_p)}$.\n\nYour task:\n\n- Construct the impulse response $h(t) = \\sum_{k=1}^{K} b_k e^{-\\gamma_k t} e^{i \\omega_{0,k} t} u(t)$, sample it uniformly with time step $\\Delta t$ and finite duration $T$, and compute a high-resolution local spectrum around a selected target resonance using the Chirp-Z Transform. From the spectral peak shape, estimate the Q-factor as $Q_{\\text{CZT}} = \\dfrac{\\omega_{\\text{peak}}}{\\Delta \\omega_{\\text{FWHM}}}$, where $\\omega_{\\text{peak}}$ is the frequency at which $|H(\\omega)|^2$ is maximal within the zoom window and $\\Delta \\omega_{\\text{FWHM}}$ is the full width at half maximum within that window. All angular frequencies must be in radians per second, and time in seconds.\n- Independently, evaluate $H(\\omega)$ for complex $\\omega$ directly from the pole model via $H(\\omega) = \\sum_{k=1}^{K} \\dfrac{-i b_k}{\\omega - (\\omega_{0,k} - i \\gamma_k)}$, and estimate the target pole location by numerically approximating the contour integrals $\\oint_{C} H(\\omega) \\, d\\omega$ and $\\oint_{C} \\omega H(\\omega) \\, d\\omega$ along a circular contour $C(\\theta)$ defined by $\\omega(\\theta) = \\omega_c + r e^{i \\theta}$, with $\\theta \\in [0, 2 \\pi)$, center $\\omega_c$ near the target, and radius $r$ small enough to enclose only the target pole. Use a uniform quadrature in $\\theta$ to approximate the integrals. Compute $Q_{\\text{contour}} = \\dfrac{\\Re(\\omega_p)}{-2 \\Im(\\omega_p)}$ from the estimated $\\omega_p$.\n- Compare $Q_{\\text{CZT}}$ with $Q_{\\text{contour}}$ for each test case by computing the relative difference $\\delta = \\left| Q_{\\text{CZT}} - Q_{\\text{contour}} \\right| / Q_{\\text{contour}}$.\n\nAngle unit specification:\n\n- All angular frequencies and widths must be in radians per second.\n- All time quantities must be in seconds.\n\nTest suite:\n\nImplement three test cases. For each case $j$, define the list of modes $\\{(\\omega_{0,k}, \\gamma_k, b_k)\\}_{k=1}^{K}$, the sampling parameters $(\\Delta t, T)$, the CZT zoom window parameters $(\\omega_{\\text{center}}, B, M)$ where the window is $[\\omega_{\\text{center}} - B, \\, \\omega_{\\text{center}} + B]$ and $M$ is the number of frequency points, and the contour parameters $(\\omega_c, r, N_\\theta)$ where $N_\\theta$ is the number of quadrature samples.\n\n- Case $1$:\n    - Modes: target $(\\omega_{0,1}, \\gamma_1, b_1) = (\\, 20.0 \\,,\\, 0.2 \\,,\\, 1.0 \\,)$, neighbor $(\\, 23.5 \\,,\\, 0.3 \\,,\\, 0.3 \\,)$, far $(\\, 50.0 \\,,\\, 0.5 \\,,\\, 0.5 \\,)$.\n    - Sampling: $(\\Delta t, T) = (\\, 10^{-3} \\,,\\, 100.0 \\,)$.\n    - CZT zoom: $(\\omega_{\\text{center}}, B, M) = (\\, 20.0 \\,,\\, 0.8 \\,,\\, 4096 \\,)$.\n    - Contour: $(\\omega_c, r, N_\\theta) = (\\, 20.0 \\,,\\, 0.4 \\,,\\, 2048 \\,)$.\n- Case $2$:\n    - Modes: target $(\\, 50.0 \\,,\\, 0.05 \\,,\\, 1.0 \\,)$, neighbor $(\\, 51.0 \\,,\\, 0.10 \\,,\\, 0.2 \\,)$, far $(\\, 30.0 \\,,\\, 0.20 \\,,\\, 0.4 \\,)$.\n    - Sampling: $(\\, 10^{-3} \\,,\\, 120.0 \\,)$.\n    - CZT zoom: $(\\, 50.0 \\,,\\, 0.30 \\,,\\, 8192 \\,)$.\n    - Contour: $(\\, 50.0 \\,,\\, 0.10 \\,,\\, 4096 \\,)$.\n- Case $3$:\n    - Modes: target $(\\, 35.0 \\,,\\, 0.02 \\,,\\, 1.0 \\,)$, neighbor $(\\, 36.0 \\,,\\, 0.04 \\,,\\, 0.2 \\,)$, far $(\\, 70.0 \\,,\\, 0.50 \\,,\\, 0.5 \\,)$.\n    - Sampling: $(\\, 10^{-3} \\,,\\, 150.0 \\,)$.\n    - CZT zoom: $(\\, 35.0 \\,,\\, 0.15 \\,,\\, 16384 \\,)$.\n    - Contour: $(\\, 35.0 \\,,\\, 0.07 \\,,\\, 8192 \\,)$.\n\nProgram requirements:\n\n- Implement generation of $h(t)$, CZT-based local spectrum evaluation and half-power width extraction, and complex-frequency contour integration for pole estimation.\n- For each case, compute the relative difference $\\delta$ as $\\delta = \\left| Q_{\\text{CZT}} - Q_{\\text{contour}} \\right| / Q_{\\text{contour}}$ and a boolean $b$ indicating whether $\\delta  0.02$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be ordered as $[ \\delta_1, \\delta_2, \\delta_3, b_1, b_2, b_3 ]$. All $\\delta_j$ are floats, and all $b_j$ are booleans. There must be no additional text printed.",
            "solution": "The problem is valid. It is a well-defined computational task grounded in the principles of electromagnetics, complex analysis, and digital signal processing. All parameters and definitions are provided, scientifically sound, and internally consistent.\n\nThe objective is to determine the quality factor ($Q$-factor) of a specific electromagnetic resonance using two distinct numerical methods and to compare their results. The underlying physical model is a linear system whose impulse response is a superposition of exponentially decaying sinusoids, each corresponding to a quasinormal mode. The system's transfer function in the frequency domain, $H(\\omega)$, is accordingly a sum of simple poles in the complex frequency plane.\n\nThe transfer function $H(\\omega)$ is the Fourier transform of the causal impulse response $h(t)$:\n$$H(\\omega) = \\int_{0}^{\\infty} h(t) e^{-i \\omega t} \\, dt$$\nThe impulse response is given as a sum over $K$ modes:\n$$h(t) = \\sum_{k=1}^{K} h_k(t) = \\sum_{k=1}^{K} b_k e^{-\\gamma_k t} e^{i \\omega_{0,k} t} u(t)$$\nwhere for each mode $k$, $b_k$ is a complex amplitude, $\\omega_{0,k}  0$ is the resonant angular frequency, $\\gamma_k  0$ is the decay rate, and $u(t)$ is the Heaviside step function. The Fourier transform of a single mode term $h_k(t)$ yields a simple pole in the complex $\\omega$-plane:\n$$H_k(\\omega) = \\int_{0}^{\\infty} b_k e^{-(\\gamma_k - i\\omega_{0,k})t} e^{-i\\omega t} \\, dt = \\frac{b_k}{(\\gamma_k - i\\omega_{0,k}) + i\\omega} = \\frac{-i b_k}{\\omega - (\\omega_{0,k} - i\\gamma_k)}$$\nThe pole is located at $\\omega_{p,k} = \\omega_{0,k} - i\\gamma_k$. The total transfer function is the sum over all modes: $H(\\omega) = \\sum_{k=1}^{K} H_k(\\omega)$.\n\nThe quality factor, $Q$, characterizes the sharpness of a resonance. For an isolated resonance with power spectrum $|H_k(\\omega)|^2$ following a Lorentzian profile, it is defined as the ratio of the resonant frequency to the full width at half maximum (FWHM) of the power spectrum, $\\Delta \\omega$. This gives $Q = \\dfrac{\\omega_{0,k}}{\\Delta \\omega} = \\dfrac{\\omega_{0,k}}{2\\gamma_k}$. This can also be expressed in terms of the complex pole location $\\omega_p = \\omega_0 - i\\gamma$ as:\n$$Q = \\frac{\\Re(\\omega_p)}{-2 \\Im(\\omega_p)}$$\n\nWe will now detail the two methods for estimating this quantity.\n\n**Method 1: Spectral Analysis via Chirp-Z Transform (CZT)**\n\nThis method operates on a numerically sampled version of the time-domain impulse response, $h(t)$.\n1.  **Signal Synthesis and Sampling**: The continuous-time signal $h(t)$ is generated according to the given modal sum. It is then uniformly sampled with a time step $\\Delta t$ over a total duration $T$, producing a discrete sequence $h[n] = h(n \\Delta t)$ for $n = 0, 1, \\dots, N-1$, where $N = \\lfloor T/\\Delta t \\rfloor$.\n2.  **High-Resolution Spectrum**: To accurately resolve the narrow spectral features of the resonance, a standard Fast Fourier Transform (FFT) may not provide sufficient frequency resolution. The Chirp-Z Transform (CZT) is employed to compute the Z-transform of $h[n]$ along a specific arc on the unit circle in the z-plane. This is equivalent to computing the Discrete-Time Fourier Transform (DTFT), $H(e^{i\\omega \\Delta t})$, over a finely-spaced grid of angular frequencies $\\omega_j$ within a \"zoom\" window $[\\omega_{\\text{center}} - B, \\omega_{\\text{center}} + B]$. The CZT is configured by selecting parameters $a = e^{i(\\omega_{\\text{center}}-B)\\Delta t}$ and $w = e^{-i\\frac{2B}{M-1}\\Delta t}$ to evaluate the spectrum at $M$ points.\n3.  **Q-Factor Estimation**: From the computed high-resolution power spectrum, $|H(\\omega_j)|^2$, we first identify the peak frequency, $\\omega_{\\text{peak}}$, corresponding to the maximum power. Next, we find the Full Width at Half Maximum, $\\Delta\\omega_{\\text{FWHM}}$, which is the width of the peak at $50\\%$ of its maximum power. This typically requires linear interpolation between the discrete frequency points to accurately locate the half-power frequencies. The Q-factor is then estimated as $Q_{\\text{CZT}} = \\dfrac{\\omega_{\\text{peak}}}{\\Delta\\omega_{\\text{FWHM}}}$. This method is subject to numerical artifacts such as spectral leakage due to the finite signal duration $T$.\n\n**Method 2: Complex Contour Integration**\n\nThis method leverages complex analysis and the analytical form of the transfer function $H(\\omega)$.\n1.  **Pole Estimation Principle**: According to Cauchy's residue theorem, for a function $f(z)$ with an isolated simple pole at $z_p$, the ratio of two contour integrals around a contour $C$ enclosing only that pole can determine the pole's location:\n    $$\\frac{\\oint_C z f(z) \\, dz}{\\oint_C f(z) \\, dz} = \\frac{2\\pi i \\, \\text{Res}(z f(z), z_p)}{2\\pi i \\, \\text{Res}(f(z), z_p)} = \\frac{z_p \\text{Res}(f(z), z_p)}{\\text{Res}(f(z), z_p)} = z_p$$\n    We apply this to our transfer function $H(\\omega)$ to find the pole location $\\omega_p$.\n2.  **Numerical Integration**: We define a circular contour in the complex $\\omega$-plane, $\\omega(\\theta) = \\omega_c + r e^{i\\theta}$ for $\\theta \\in [0, 2\\pi)$. The center $\\omega_c$ is chosen near the expected real part of the pole, and the radius $r$ is chosen small enough to isolate the target pole from its neighbors. The contour integrals are approximated numerically using a simple quadrature rule, such as the rectangular rule, by summing the integrand over $N_\\theta$ discrete points along the contour:\n    $$I_1 = \\oint_C H(\\omega) \\, d\\omega \\approx \\sum_{j=0}^{N_\\theta-1} H(\\omega(\\theta_j)) \\cdot \\omega'(\\theta_j) \\Delta\\theta$$\n    $$I_2 = \\oint_C \\omega H(\\omega) \\, d\\omega \\approx \\sum_{j=0}^{N_\\theta-1} \\omega(\\theta_j) H(\\omega(\\theta_j)) \\cdot \\omega'(\\theta_j) \\Delta\\theta$$\n    where $\\omega'(\\theta) = i r e^{i\\theta}$ and $\\Delta\\theta = 2\\pi/N_\\theta$.\n3.  **Q-Factor Calculation**: The pole is estimated as $\\omega_p \\approx I_2 / I_1$. The Q-factor is then calculated directly from the real and imaginary parts of the estimated pole: $Q_{\\text{contour}} = \\dfrac{\\Re(\\omega_p)}{-2\\Im(\\omega_p)}$. This method provides a semi-analytical reference value, with its accuracy primarily limited by the numerical quadrature precision and the influence of other poles if the contour is not sufficiently isolating.\n\nFinally, the results from both methods are compared for each test case by computing the relative difference, $\\delta = \\left| Q_{\\text{CZT}} - Q_{\\text{contour}} \\right| / Q_{\\text{contour}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import czt\n\ndef solve():\n    \"\"\"\n    Main function to execute the test cases and print results.\n    \"\"\"\n\n    def analytical_H(omega, modes):\n        \"\"\"\n        Computes the analytical transfer function H(omega) for a complex omega.\n        \"\"\"\n        H_val = np.zeros_like(omega, dtype=np.complex128)\n        for w0k, gamma_k, b_k in modes:\n            pole = w0k - 1j * gamma_k\n            H_val += (-1j * b_k) / (omega - pole)\n        return H_val\n\n    def find_fwhm(omega_axis, power_spectrum):\n        \"\"\"\n        Finds the peak frequency and FWHM of a spectral peak.\n        \"\"\"\n        idx_max = np.argmax(power_spectrum)\n        p_max = power_spectrum[idx_max]\n        omega_peak = omega_axis[idx_max]\n\n        if p_max == 0:\n            return omega_peak, np.nan\n\n        p_half = p_max / 2.0\n\n        # Find left crossing (omega_1)\n        try:\n            # First index from left where power > p_half\n            idx_start = np.where(power_spectrum[:idx_max] > p_half)[0][0]\n            idx_l1 = idx_start - 1\n            idx_l2 = idx_start\n            \n            p_pts = power_spectrum[idx_l1:idx_l2+1]\n            w_pts = omega_axis[idx_l1:idx_l2+1]\n            omega_1 = np.interp(p_half, p_pts, w_pts)\n        except (IndexError, ValueError):\n            return omega_peak, np.nan\n\n        # Find right crossing (omega_2)\n        try:\n            # Last index from right where power > p_half\n            idx_end = np.where(power_spectrum[idx_max:] > p_half)[0][-1] + idx_max\n            idx_r1 = idx_end\n            idx_r2 = idx_end + 1\n            \n            p_pts = power_spectrum[idx_r1:idx_r2+1][::-1] # monotonic for interp\n            w_pts = omega_axis[idx_r1:idx_r2+1][::-1]\n            omega_2 = np.interp(p_half, p_pts, w_pts)\n        except (IndexError, ValueError):\n            return omega_peak, np.nan\n        \n        fwhm = omega_2 - omega_1\n        return omega_peak, fwhm\n\n    def calculate_q_czt(modes, dt, T, omega_center, B, M):\n        \"\"\"\n        Calculates Q-factor using CZT on the sampled impulse response.\n        \"\"\"\n        N = int(T / dt)\n        t = np.arange(N) * dt\n        h_t = np.zeros(N, dtype=np.complex128)\n        for w0k, gamma_k, b_k in modes:\n            h_t += b_k * np.exp(-gamma_k * t) * np.exp(1j * w0k * t)\n\n        omega_start = omega_center - B\n        omega_end = omega_center + B\n        delta_omega = (omega_end - omega_start) / (M - 1)\n\n        a = np.exp(1j * omega_start * dt)\n        w = np.exp(-1j * delta_omega * dt)\n\n        H_czt_vals = czt(h_t, m=M, w=w, a=a)\n        omega_axis = np.linspace(omega_start, omega_end, M)\n        power_spectrum = np.abs(H_czt_vals)**2\n\n        omega_peak, fwhm = find_fwhm(omega_axis, power_spectrum)\n\n        if np.isnan(fwhm) or fwhm = 0:\n            return np.nan\n        \n        Q = omega_peak / fwhm\n        return Q\n\n    def calculate_q_contour(modes, omega_c, r, N_theta):\n        \"\"\"\n        Calculates Q-factor by finding the pole via numerical contour integration.\n        \"\"\"\n        d_theta = 2 * np.pi / N_theta\n        theta = np.arange(0, 2 * np.pi, d_theta)\n\n        omega_contour = omega_c + r * np.exp(1j * theta)\n        d_omega = 1j * r * np.exp(1j * theta) * d_theta\n\n        H_vals = analytical_H(omega_contour, modes)\n\n        I1 = np.sum(H_vals * d_omega)\n        I2 = np.sum(omega_contour * H_vals * d_omega)\n\n        if np.abs(I1)  1e-15: # Avoid division by zero\n            return np.nan\n\n        omega_p = I2 / I1\n        \n        if np.imag(omega_p) >= 0: # Physically invalid pole\n            return np.nan\n\n        Q = np.real(omega_p) / (-2 * np.imag(omega_p))\n        return Q\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"modes\": [(20.0, 0.2, 1.0), (23.5, 0.3, 0.3), (50.0, 0.5, 0.5)],\n            \"sampling\": (1e-3, 100.0),\n            \"czt_zoom\": (20.0, 0.8, 4096),\n            \"contour\": (20.0, 0.4, 2048),\n        },\n        {\n            \"modes\": [(50.0, 0.05, 1.0), (51.0, 0.10, 0.2), (30.0, 0.20, 0.4)],\n            \"sampling\": (1e-3, 120.0),\n            \"czt_zoom\": (50.0, 0.30, 8192),\n            \"contour\": (50.0, 0.10, 4096),\n        },\n        {\n            \"modes\": [(35.0, 0.02, 1.0), (36.0, 0.04, 0.2), (70.0, 0.50, 0.5)],\n            \"sampling\": (1e-3, 150.0),\n            \"czt_zoom\": (35.0, 0.15, 16384),\n            \"contour\": (35.0, 0.07, 8192),\n        },\n    ]\n\n    results_delta = []\n    results_bool = []\n    for case in test_cases:\n        dt, T = case[\"sampling\"]\n        omega_center, B, M = case[\"czt_zoom\"]\n        omega_c, r, N_theta = case[\"contour\"]\n        \n        q_czt = calculate_q_czt(case[\"modes\"], dt, T, omega_center, B, M)\n        q_contour = calculate_q_contour(case[\"modes\"], omega_c, r, N_theta)\n        \n        delta = np.abs(q_czt - q_contour) / q_contour\n        b = delta  0.02\n        \n        results_delta.append(delta)\n        results_bool.append(b)\n        \n    final_results = results_delta + results_bool\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}