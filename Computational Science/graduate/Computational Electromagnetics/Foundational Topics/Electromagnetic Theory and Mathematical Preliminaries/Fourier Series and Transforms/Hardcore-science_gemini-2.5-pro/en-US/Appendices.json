{
    "hands_on_practices": [
        {
            "introduction": "The ability to control which electromagnetic modes are excited within a structure like a waveguide is a cornerstone of microwave engineering. This practice delves into the fundamental principle of modal decomposition, where an arbitrary source current is represented as a Fourier series in terms of the waveguide's orthogonal modes. By calculating the Fourier coefficients, you will directly quantify the coupling efficiency between a complex current source and a specific waveguide mode, a crucial skill for designing and analyzing waveguide components. ",
            "id": "3309343",
            "problem": "A perfectly electrically conducting (PEC) cylindrical waveguide of radius $R$ is filled with a homogeneous, isotropic, lossless medium characterized by permittivity $\\epsilon$ and permeability $\\mu$. The waveguide axis is the $z$-axis in cylindrical coordinates $(r,\\phi,z)$. At the inner wall $r=R$, an impressed nonuniform azimuthal surface current density flows along $\\hat{\\mathbf{z}}$, given by\n$$\nK_{z}(\\phi) = K_{0}\\,\\exp\\!\\big(\\alpha \\cos\\phi\\big)\\,\\cos(3\\phi),\n$$\nwhere $K_{0}$ and $\\alpha$ are real constants with $K_{0}\\neq 0$ and $\\alpha\\neq 0$. The waveguide supports sets of orthogonal transverse electric (TE$_{z}$) and transverse magnetic (TM$_{z}$) modes with separable azimuthal dependence $\\exp(i m \\phi)$ for integer $m\\in\\mathbb{Z}$.\n\nStarting from the boundary condition of Maxwell’s equations at a PEC, the modal orthogonality over the azimuthal coordinate $\\phi\\in[0,2\\pi)$, and the completeness of the $\\exp(i m\\phi)$ basis on $[0,2\\pi)$, derive the Fourier series representation of the impressed current $K_{z}(\\phi)$ and the corresponding dimensionless coupling coefficient $a_{m}$ to a mode with azimuthal index $m$, defined by\n$$\na_{m} \\equiv \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} K_{z}(\\phi)\\,\\exp(-i m\\phi)\\,d\\phi.\n$$\nThen, determine the closed-form analytic expression for the specific coupling coefficient $a_{2}$ associated with azimuthal index $m=2$.\n\nExpress your final answer as a single closed-form analytic expression in terms of standard special functions. Do not perform any numerical approximation or rounding. No physical units are required for $a_{2}$ because it is dimensionless by definition.",
            "solution": "The problem requires the derivation of the dimensionless coupling coefficient $a_{2}$ for an impressed surface current density $K_{z}(\\phi)$ in a cylindrical waveguide. The analysis begins with validating the problem statement.\n\n### Problem Validation\n**1. Extracted Givens:**\n- A perfectly electrically conducting (PEC) cylindrical waveguide of radius $R$.\n- The medium filling the waveguide is homogeneous, isotropic, and lossless with permittivity $\\epsilon$ and permeability $\\mu$.\n- The system is described in cylindrical coordinates $(r, \\phi, z)$, with the waveguide axis along the $z$-axis.\n- An impressed surface current density is present at the inner wall $r=R$, given by $K_{z}(\\phi) = K_{0}\\,\\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)$, where $K_{0}$ and $\\alpha$ are real, non-zero constants.\n- The waveguide supports transverse electric (TE$_{z}$) and transverse magnetic (TM$_{z}$) modes with azimuthal dependence $\\exp(i m \\phi)$ for integers $m \\in \\mathbb{Z}$.\n- The definition of the dimensionless coupling coefficient $a_{m}$ is provided as $a_{m} \\equiv \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} K_{z}(\\phi)\\,\\exp(-i m\\phi)\\,d\\phi$.\n\n**2. Validation Verdict:**\nThe problem is scientifically grounded in the principles of classical electromagnetism, specifically waveguide theory and modal analysis. The use of a Fourier series to represent an excitation source is a standard technique in computational electromagnetics. The problem is well-posed, as it asks for the calculation of a uniquely defined mathematical quantity (a Fourier coefficient) from a well-behaved function. All necessary information is provided, and there are no internal contradictions or scientifically unsound premises. The problem is objective and requires a rigorous mathematical derivation. Therefore, the problem is deemed **valid**.\n\n### Solution Derivation\nThe primary objective is to calculate the coupling coefficient $a_{m}$ for a general integer mode index $m$, and then specialize the result for $m=2$. The coefficient $a_{m}$ is defined as the normalized complex Fourier series coefficient of the current distribution $K_{z}(\\phi)$.\n\nThe definition of $a_{m}$ is:\n$$\na_{m} = \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} K_{z}(\\phi)\\,\\exp(-i m\\phi)\\,d\\phi\n$$\nSubstituting the given expression for $K_{z}(\\phi) = K_{0}\\,\\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)$:\n$$\na_{m} = \\frac{1}{2\\pi\\,K_{0}}\\int_{0}^{2\\pi} \\left[K_{0}\\,\\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)\\right]\\,\\exp(-i m\\phi)\\,d\\phi\n$$\nThe constant $K_{0}$ cancels, as expected for a dimensionless coefficient:\n$$\na_{m} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi)\\,\\cos(3\\phi)\\,\\exp(-i m\\phi)\\,d\\phi\n$$\nTo evaluate this integral, we express the cosine term using Euler's formula, $\\cos(x) = \\frac{1}{2}(\\exp(ix) + \\exp(-ix))$:\n$$\n\\cos(3\\phi) = \\frac{\\exp(i 3\\phi) + \\exp(-i 3\\phi)}{2}\n$$\nSubstituting this into the integral for $a_{m}$:\n$$\na_{m} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\left(\\frac{\\exp(i 3\\phi) + \\exp(-i 3\\phi)}{2}\\right) \\exp(-i m\\phi)\\,d\\phi\n$$\nWe can distribute the terms and split the integral into two parts:\n$$\na_{m} = \\frac{1}{4\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\left[ \\exp(i 3\\phi)\\exp(-i m\\phi) + \\exp(-i 3\\phi)\\exp(-i m\\phi) \\right]\\,d\\phi\n$$\n$$\na_{m} = \\frac{1}{4\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m-3)\\phi)\\,d\\phi + \\frac{1}{4\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m+3)\\phi)\\,d\\phi\n$$\nThese integrals are related to the integral representation of the modified Bessel function of the first kind, $I_{n}(z)$, which is defined as the $n$-th coefficient in the Fourier series expansion of $\\exp(z \\cos\\theta)$:\n$$\nI_{n}(z) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(z \\cos\\theta)\\,\\exp(-i n\\theta)\\,d\\theta\n$$\nBy comparing this definition with the terms in our expression for $a_{m}$, we can identify each integral. The first integral corresponds to $n=m-3$ and $z=\\alpha$. The second integral corresponds to $n=m+3$ and $z=\\alpha$.\nThus, we can write $a_{m}$ in terms of modified Bessel functions:\n$$\na_{m} = \\frac{1}{2} \\left[ \\left(\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m-3)\\phi)\\,d\\phi\\right) + \\left(\\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\exp(\\alpha \\cos\\phi) \\exp(-i(m+3)\\phi)\\,d\\phi\\right) \\right]\n$$\n$$\na_{m} = \\frac{1}{2} \\left[ I_{m-3}(\\alpha) + I_{m+3}(\\alpha) \\right]\n$$\nThis is the general expression for the dimensionless coupling coefficient for any azimuthal mode index $m$. The problem asks for the specific coefficient $a_{2}$, which is found by setting $m=2$:\n$$\na_{2} = \\frac{1}{2} \\left[ I_{2-3}(\\alpha) + I_{2+3}(\\alpha) \\right] = \\frac{1}{2} \\left[ I_{-1}(\\alpha) + I_{5}(\\alpha) \\right]\n$$\nThe modified Bessel functions of the first kind possess the symmetry property $I_{-n}(z) = I_{n}(z)$ for integer $n$. Applying this property for $n=1$:\n$$\nI_{-1}(\\alpha) = I_{1}(\\alpha)\n$$\nSubstituting this back into the expression for $a_{2}$ yields the final closed-form analytic expression:\n$$\na_{2} = \\frac{1}{2} \\left( I_{1}(\\alpha) + I_{5}(\\alpha) \\right)\n$$\nThis expression is in terms of standard special functions, as required.",
            "answer": "$$\n\\boxed{\\frac{1}{2} \\left( I_{1}(\\alpha) + I_{5}(\\alpha) \\right)}\n$$"
        },
        {
            "introduction": "When we move from analytical theory to computational practice, continuous signals become discrete data streams, and the continuous Fourier transform is replaced by the Discrete Fourier Transform (DFT). A common technique in spectral analysis is zero-padding, but its effects are often misunderstood. This exercise challenges you to clarify the relationship between observation time, spectral resolution, and DFT bin spacing, ensuring you can accurately interpret the modal content from simulated time-domain responses. ",
            "id": "3309397",
            "problem": "A computational electromagnetics team uses a Finite-Difference Time-Domain (FDTD) simulation to compute a time-domain response of the electric field at a fixed spatial location in a lossless waveguide. The discrete sequence is denoted by $x[n]$, acquired at uniform sampling interval $\\Delta t$, yielding sampling frequency $f_{s} = 1/\\Delta t$. The acquisition length is $N$ samples, providing a total observation time $T = N \\Delta t$. The team computes the Discrete Fourier Transform (DFT) for spectral modal analysis to identify resonant peaks corresponding to guided modes.\n\nAs a fundamental base, they use the following definitions. The Discrete-Time Fourier Transform (DTFT) of the windowed sequence $x[n]$ of length $N$ is\n$$\nX\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n} \\, ,\n$$\nwhere $\\omega$ is the normalized radian frequency per sample. The $N$-point Discrete Fourier Transform (DFT) is\n$$\nX_{N}[k] = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\frac{2\\pi}{N} k n} \\quad \\text{for} \\quad k \\in \\{0,1,\\dots,N-1\\} \\, .\n$$\nThe team sometimes zero-pads the time sequence by forming $x_{p}[n]$, where $x_{p}[n] = x[n]$ for $0 \\le n \\le N-1$ and $x_{p}[n] = 0$ for $N \\le n \\le M-1$, and then computes the $M$-point DFT\n$$\nX_{M}[k] = \\sum_{n=0}^{M-1} x_{p}[n]\\, e^{-j \\frac{2\\pi}{M} k n} \\quad \\text{for} \\quad k \\in \\{0,1,\\dots,M-1\\} \\, .\n$$\nAssume $M = L N$ with integer $L \\ge 2$.\n\nFrom these definitions and first principles of Fourier analysis, derive how zero-padding affects the discrete spectrum sampled by the DFT, and determine whether it changes the underlying spectral resolution of the windowed signal. Use your reasoning to assess the suitability of zero-padding for peak localization in modal analysis of the simulated waveguide. In particular, leverage the fact that the spectrum of a finite-length sequence is the DTFT of the true underlying infinite-length sequence multiplied by a finite window, and that the spectral resolution is governed by the observation time $T$ rather than the number of frequency grid points.\n\nSelect all statements that are necessarily true under the assumptions above:\n\nA. Zero-padding from length $N$ to length $M$ changes the Rayleigh resolution in hertz from $f_{s}/N$ to $f_{s}/M$.\n\nB. Zero-padding a finite sequence corresponds to sampling the same DTFT $X\\!\\left(e^{j\\omega}\\right)$ at a finer frequency grid, without altering the continuous spectrum of the windowed signal.\n\nC. Zero-padding reduces spectral leakage by shrinking the mainlobe of the window’s spectral response.\n\nD. Zero-padding can improve peak localization of a narrowband mode in the DFT magnitude by increasing the number of DFT bins spanning the mainlobe, enabling smoother interpolation of the maximum.\n\nE. Zero-padding changes the peak amplitude of an isolated modal component in the DFT magnitude because energy is conserved but distributed over more bins.",
            "solution": "The problem statement is a valid application of Fourier analysis principles to a common signal processing task in computational science. All definitions are standard, and the question is well-posed and scientifically grounded.\n\nThe core of the problem lies in understanding the relationship between the Discrete-Time Fourier Transform (DTFT), the Discrete Fourier Transform (DFT), and the effect of zero-padding.\n\nThe finite acquisition of $N$ samples, $x[n]$, means the signal is implicitly multiplied by a rectangular window of length $N$. The continuous spectrum of this finite-length signal is given by its DTFT:\n$$\nX\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n}\n$$\nThis expression defines the spectrum for any continuous normalized radian frequency $\\omega$. The shape of $X(e^{j\\omega})$ is fixed by the $N$ samples of $x[n]$. Specifically, it is the convolution of the true underlying signal's spectrum with the Fourier transform of the rectangular window. The ability to distinguish two closely spaced spectral features, known as **spectral resolution**, is fundamentally limited by the mainlobe width of this window's transform, which is inversely proportional to the window's time duration, $T = N\\Delta t$. The resolution in Hertz is approximately $\\Delta f_{res} \\approx 1/T = f_s/N$.\n\nThe $N$-point DFT, $X_N[k]$, does not compute the entire continuous spectrum $X(e^{j\\omega})$. Instead, it provides samples of this spectrum at $N$ discrete frequencies:\n$$\nX_{N}[k] = X(e^{j\\omega}) \\Big|_{\\omega = \\frac{2\\pi k}{N}} = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\frac{2\\pi}{N} k n}\n$$\nThe spacing between these frequency samples (the bin spacing) is $\\Delta f_{bin} = f_s / N$.\n\nNow, let's consider zero-padding. The sequence $x[n]$ is extended to length $M > N$ by appending $M-N$ zeros, creating $x_p[n]$. The DTFT of this new, longer sequence is:\n$$\nX_p\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{M-1} x_{p}[n]\\, e^{-j \\omega n}\n$$\nSince $x_p[n] = x[n]$ for $0 \\le n \\le N-1$ and $x_p[n] = 0$ for $n \\ge N$, the sum is identical to the original DTFT:\n$$\nX_p\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n} = X\\!\\left(e^{j\\omega}\\right)\n$$\nThis is a critical insight: **zero-padding does not alter the underlying continuous spectrum of the windowed signal**.\n\nWhen an $M$-point DFT is computed on the zero-padded sequence, we are again sampling this same continuous spectrum, but now at $M$ points:\n$$\nX_{M}[k] = X_p(e^{j\\omega}) \\Big|_{\\omega = \\frac{2\\pi k}{M}} = X(e^{j\\omega}) \\Big|_{\\omega = \\frac{2\\pi k}{M}}\n$$\nSince $M > N$, the frequency grid is now finer. The new bin spacing is $\\Delta f'_{bin} = f_s / M$, which is smaller than the original $f_s / N$. Zero-padding is thus a method of interpolating the DFT, providing more points to better visualize the shape of the underlying continuous spectrum $X(e^{j\\omega})$. It does not add any new information and therefore cannot improve the fundamental spectral resolution.\n\nWith these principles established, we evaluate each statement.\n\n**A. Zero-padding from length $N$ to length $M$ changes the Rayleigh resolution in hertz from $f_{s}/N$ to $f_{s}/M$.**\nThe Rayleigh resolution, or more generally, the spectral resolution, is determined by the length of the observation window, $N$ (or total time $T = N\\Delta t$). The resolution is approximately $\\Delta f_{res} \\approx f_s/N$. Zero-padding does not change the original number of non-zero data samples $N$, nor the observation time $T$. Therefore, it does not change the spectral resolution. The quantity $f_s/M$ represents the new, finer frequency bin spacing of the DFT, which is a computational parameter, not a measure of physical resolvability. Conflating bin spacing with resolution is a common but fundamental error.\n**Verdict: Incorrect.**\n\n**B. Zero-padding a finite sequence corresponds to sampling the same DTFT $X\\!\\left(e^{j\\omega}\\right)$ at a finer frequency grid, without altering the continuous spectrum of the windowed signal.**\nAs derived above, zero-padding does not change the DTFT of the windowed sequence ($X_p(e^{j\\omega}) = X(e^{j\\omega})$). The $M$-point DFT of the padded sequence calculates samples of this DTFT at frequencies $\\omega_k = 2\\pi k/M$, while the original $N$-point DFT used frequencies $\\omega_k = 2\\pi k/N$. Since $M > N$, the spacing $2\\pi/M$ is smaller than $2\\pi/N$, meaning the sampling grid is finer. This statement is a precise and accurate description of the effect of zero-padding.\n**Verdict: Correct.**\n\n**C. Zero-padding reduces spectral leakage by shrinking the mainlobe of the window’s spectral response.**\nSpectral leakage is a consequence of windowing, specifically the convolution of the signal spectrum with the window's spectrum. The properties of leakage (e.g., mainlobe width, sidelobe height) are determined entirely by the shape and length of the window function. In this case, the implicit window is a rectangular window of length $N$. Zero-padding does not change this window. To reduce the mainlobe width (and thus improve resolution), one must increase the observation time $T$ (i.e., increase $N$ with actual signal data, not zeros). To reduce sidelobe levels (leakage), one could apply a different window function (e.g., Hann, Hamming) to the $N$ samples before the DFT. Zero-padding does neither.\n**Verdict: Incorrect.**\n\n**D. Zero-padding can improve peak localization of a narrowband mode in the DFT magnitude by increasing the number of DFT bins spanning the mainlobe, enabling smoother interpolation of the maximum.**\nA resonant mode will appear as a peak (a mainlobe from the windowing effect) in the continuous spectrum $X(e^{j\\omega})$. The $N$-point DFT provides only a sparse sampling of this peak, and it is likely that no DFT bin falls exactly at the true maximum. This \"picket-fence effect\" can lead to significant underestimation of the peak's amplitude and an error in its frequency location. By zero-padding to length $M$, we compute more DFT bins. These additional bins fall between the original bins, providing a denser sampling of the spectral peak's shape. This denser set of points creates a 'smoother' looking spectrum and allows the maximum value among the $M$ bins to be a better approximation of the true peak's amplitude and frequency. This is precisely what is meant by improving peak localization.\n**Verdict: Correct.**\n\n**E. Zero-padding changes the peak amplitude of an isolated modal component in the DFT magnitude because energy is conserved but distributed over more bins.**\nThis statement contains two parts: a claim and a reason. The claim that the peak amplitude *changes* is not necessarily true. If a signal frequency component happens to fall exactly on one of the original $N$ DFT bins, and also on one of the $M$ bins (which occurs if $M/N$ is an integer and the original bin is a multiple of $N/(\\text{common divisors})$), the calculated DFT magnitude at that peak can be identical. For example, for a DC signal $x[n]=A$, the peak at $k=0$ is $X_N[0]=AN$ and $X_M[0]=AN$, which are identical. Therefore, the amplitude does not necessarily change.\nMore importantly, the reasoning provided is flawed. The DFT coefficients' magnitudes are not energy values. Parseval's theorem relates the signal's energy to the sum of squared DFT magnitudes: $\\sum |x[n]|^2 = \\frac{1}{N}\\sum |X_N[k]|^2$. For the zero-padded case, $\\sum |x[n]|^2 = \\frac{1}{M}\\sum |X_M[k]|^2$. This implies $\\sum |X_M[k]|^2 = (M/N) \\sum |X_N[k]|^2$. The sum of squared magnitudes (a proxy for total energy in the spectrum) *increases* by a factor of $M/N$, it is not conserved. The idea of energy being \"distributed\" is a misapplication of concepts from Power Spectral Density (PSD) estimation (where normalization by frequency bin width is key) to the standard DFT.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "Fourier analysis is not only a tool for processing simulation outputs; it is a powerful lens for analyzing the numerical operators at the heart of the simulation itself. This advanced practice explores the concept of the Fourier symbol of a discrete curl operator, revealing how choices in grid discretization lead to numerical artifacts like artificial dispersion and anisotropy. You will learn to quantify these effects and even design a spectral filter to mitigate them, gaining a deeper understanding of the fidelity of computational wave solvers. ",
            "id": "3309428",
            "problem": "Consider homogeneous, source-free Maxwell's equations in a non-dispersive, isotropic medium with permittivity $\\epsilon$ and permeability $\\mu$, written in the spatially continuous, temporally continuous form as $\\nabla \\times \\mathbf{E} = - \\mu \\frac{\\partial \\mathbf{H}}{\\partial t}$ and $\\nabla \\times \\mathbf{H} = \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}$, together with the constitutive relations $\\mathbf{D} = \\epsilon \\mathbf{E}$ and $\\mathbf{B} = \\mu \\mathbf{H}$. Introducing a spatial semi-discretization of the curl operator yields a discrete $\\mathrm{H}(\\mathrm{curl})$ operator acting on grid-based fields. The spectral (Fourier) symbol of a linear, translation-invariant discrete operator is obtained by applying the operator to a Fourier mode $\\mathbf{u}(\\mathbf{x}) = \\mathbf{u}_0 e^{i \\mathbf{k} \\cdot \\mathbf{x}}$, which converts spatial differences into algebraic multiplication by a symbol that depends on the wave vector $\\mathbf{k}$.\n\nYou will derive and compare the Fourier symbols of the discrete $\\mathrm{H}(\\mathrm{curl})$ operator on two grid layouts: the staggered Yee grid and the fully collocated grid, and then quantify how symbol anisotropy relates to numerical birefringence in the dispersion of transverse electromagnetic waves. Finally, you will propose and evaluate a corrective spectral filter that reduces anisotropy.\n\nThe derivations must start from the fundamental base consisting of the spectral representation of spatial differences on uniform grids and the plane-wave ansatz. Specifically, when a first-order central difference operator of grid step $h$ acts on $e^{i k_\\alpha x_\\alpha}$ along direction $\\alpha \\in \\{x,y,z\\}$, the discrete derivative is represented by a Fourier symbol that multiplies the mode. For collocated grids with second-order central differences, the symbol is $i \\frac{\\sin(k_\\alpha h)}{h}$. For staggered differences as in the Yee layout, the symbol exhibits half-step sampling and, up to a constant phase shift that cancels in energy operators, has magnitude represented by $\\frac{2}{h} \\sin\\!\\left(\\frac{k_\\alpha h}{2}\\right)$.\n\nTasks:\n- Derive the $3 \\times 3$ matrix Fourier symbol of the discrete curl operator $\\nabla_h \\times$ for the collocated grid using second-order central differences. Show that, under the plane-wave ansatz $\\mathbf{E}(\\mathbf{x}) = \\mathbf{E}_0 e^{i \\mathbf{k} \\cdot \\mathbf{x}}$, the symbol can be written as $C_{\\mathrm{col}}(\\mathbf{k}) = i \\begin{pmatrix} 0 & -\\tilde{k}_z^{\\mathrm{col}} & \\tilde{k}_y^{\\mathrm{col}} \\\\ \\tilde{k}_z^{\\mathrm{col}} & 0 & -\\tilde{k}_x^{\\mathrm{col}} \\\\ -\\tilde{k}_y^{\\mathrm{col}} & \\tilde{k}_x^{\\mathrm{col}} & 0 \\end{pmatrix}$ with $\\tilde{k}_\\alpha^{\\mathrm{col}} = \\frac{\\sin(k_\\alpha h)}{h}$.\n- Derive the corresponding symbol for the Yee grid, in which field components are staggered. Show that a consistent choice of discrete symbols yields $C_{\\mathrm{Yee}}(\\mathbf{k}) = i \\begin{pmatrix} 0 & -\\tilde{k}_z^{\\mathrm{Yee}} & \\tilde{k}_y^{\\mathrm{Yee}} \\\\ \\tilde{k}_z^{\\mathrm{Yee}} & 0 & -\\tilde{k}_x^{\\mathrm{Yee}} \\\\ -\\tilde{k}_y^{\\mathrm{Yee}} & \\tilde{k}_x^{\\mathrm{Yee}} & 0 \\end{pmatrix}$ with $\\tilde{k}_\\alpha^{\\mathrm{Yee}} = \\frac{2}{h} \\sin\\!\\left(\\frac{k_\\alpha h}{2}\\right)$.\n- Use the identity for skew-symmetric matrices $C(\\mathbf{q})^2 = -\\left(\\|\\mathbf{q}\\|^2 I - \\mathbf{q} \\mathbf{q}^{\\top}\\right)$, valid for $C(\\mathbf{q}) = i \\begin{pmatrix} 0 & -q_z & q_y \\\\ q_z & 0 & -q_x \\\\ -q_y & q_x & 0 \\end{pmatrix}$, to obtain the discrete $\\mathrm{H}(\\mathrm{curl})$ (curl-curl) symbol for each grid, namely $\\mathcal{L}_{\\mathrm{grid}}(\\mathbf{k}) = C_{\\mathrm{grid}}(\\mathbf{k})^2$. Show that the transverse eigenvalues on the subspace orthogonal to $\\tilde{\\mathbf{k}}$ are $\\lambda_{\\mathrm{grid}}(\\mathbf{k}) = \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2$.\n- Define the phase speed ratio for transverse plane waves, normalized by the continuous reference, as $v_{\\mathrm{grid}}(\\hat{\\mathbf{k}}; k h) = \\frac{\\sqrt{\\lambda_{\\mathrm{grid}}(\\mathbf{k})}}{|\\mathbf{k}|}$ with $\\mathbf{k} = k \\hat{\\mathbf{k}}$, $|\\hat{\\mathbf{k}}| = 1$. Define the anisotropy index at fixed $k h$ as $A_{\\mathrm{grid}}(k h) = \\frac{\\max_{\\hat{\\mathbf{k}}} v_{\\mathrm{grid}}(\\hat{\\mathbf{k}}; k h) - \\min_{\\hat{\\mathbf{k}}} v_{\\mathrm{grid}}(\\hat{\\mathbf{k}}; k h)}{\\operatorname{mean}_{\\hat{\\mathbf{k}}} v_{\\mathrm{grid}}(\\hat{\\mathbf{k}}; k h)}$. Interpret $A_{\\mathrm{grid}}$ as a quantitative surrogate of numerical birefringence caused by symbol anisotropy.\n- Propose a corrective spectral filter that reduces anisotropy while preserving a radial dependence on $|\\mathbf{k}|$. One choice is to construct a scalar filter $W_{\\mathrm{grid}}(\\mathbf{k}) = \\frac{\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)}{\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|}$, where $\\phi_{\\mathrm{grid}}(r)$ is the angular average $\\phi_{\\mathrm{grid}}(r) = \\mathbb{E}_{\\hat{\\mathbf{k}}}\\left[\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|\\right]$ taken over all unit directions $\\hat{\\mathbf{k}}$ satisfying $|\\mathbf{k}| = r$. Using this filter to rescale the output of the discrete $\\mathrm{H}(\\mathrm{curl})$ operator yields a corrected phase speed ratio $v_{\\mathrm{grid,\\,filt}}(\\hat{\\mathbf{k}}; k h) = \\frac{\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)}{|\\mathbf{k}|}$ that is, by construction, independent of direction $\\hat{\\mathbf{k}}$, thereby reducing anisotropy at fixed $k h$.\n\nNumerical implementation requirements:\n- Implement the above in two spatial dimensions ($x$ and $y$), where the nonzero field component of the electric field is $E_z$ and the relevant discrete $\\mathrm{H}(\\mathrm{curl})$ symbol reduces to $\\lambda_{\\mathrm{grid}}(k_x, k_y) = \\left(\\tilde{k}_x^{\\mathrm{grid}}\\right)^2 + \\left(\\tilde{k}_y^{\\mathrm{grid}}\\right)^2$. Use $h = 1$ to make $k h$ dimensionless (no physical units are required in the output).\n- For each prescribed $k h$ value, sample directions uniformly by setting $\\hat{\\mathbf{k}}(\\theta) = (\\cos\\theta, \\sin\\theta)$ for $\\theta$ in $[0, 2\\pi)$ discretized into $N_\\theta$ equally spaced points, and compute $A_{\\mathrm{grid}}(k h)$ by aggregating $v_{\\mathrm{grid}}(\\hat{\\mathbf{k}}; k h)$ across all sampled directions.\n- Implement the filter $W_{\\mathrm{grid}}(\\mathbf{k})$ numerically by computing $\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)$ as the average of $\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|$ over the same angular sample, and then compute the corrected $v_{\\mathrm{grid,\\,filt}}(\\hat{\\mathbf{k}}; k h)$ and its anisotropy index $A_{\\mathrm{grid,\\,filt}}(k h)$.\n- Define the improvement ratio at fixed $k h$ as $R_{\\mathrm{grid}}(k h) = \\frac{A_{\\mathrm{grid}}(k h) - A_{\\mathrm{grid,\\,filt}}(k h)}{A_{\\mathrm{grid}}(k h)}$.\n\nTest suite:\n- Use $N_\\theta = 360$.\n- Evaluate the collocated grid and the Yee grid at $k h = 0.2$ and $k h = 1.2$.\n- Evaluate the filter improvement ratio for the collocated grid at $k h = 1.2$ and assert whether $R_{\\mathrm{col}}(1.2) > 0.9$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the following results as a comma-separated list enclosed in square brackets: $\\left[A_{\\mathrm{col}}(0.2), A_{\\mathrm{Yee}}(0.2), A_{\\mathrm{col}}(1.2), A_{\\mathrm{Yee}}(1.2), R_{\\mathrm{col}}(1.2), \\text{boolean}\\right]$, where the boolean is $\\text{True}$ if $R_{\\mathrm{col}}(1.2) > 0.9$ and $\\text{False}$ otherwise. All numeric values must be reported as dimensionless decimals.",
            "solution": "The problem requires the derivation and analysis of Fourier symbols for discrete curl operators on collocated and Yee grids, quantification of their numerical anisotropy, and the design and evaluation of a corrective spectral filter. The analysis will be performed in accordance with the principles of Fourier analysis of finite-difference operators for Maxwell's equations.\n\n### Step 1: Derivation of the Discrete Curl Operator Symbol (Collocated Grid)\n\nThe continuous curl operator is $\\nabla \\times$. Given a vector field $\\mathbf{E}(\\mathbf{x})$, its curl is $(\\nabla \\times \\mathbf{E}) = (\\partial_y E_z - \\partial_z E_y, \\partial_z E_x - \\partial_x E_z, \\partial_x E_y - \\partial_y E_x)$. On a collocated grid with uniform spacing $h$, a second-order central difference approximation for a partial derivative, e.g., $\\partial_x$, is given by:\n$$\n\\partial_x f(x, y, z) \\approx \\frac{f(x+h, y, z) - f(x-h, y, z)}{2h} \\equiv D_x^{\\mathrm{col}} f(x, y, z)\n$$\nTo find the Fourier symbol of this discrete operator, we apply it to a single Fourier mode $\\mathbf{E}(\\mathbf{x}) = \\mathbf{E}_0 e^{i \\mathbf{k} \\cdot \\mathbf{x}} = \\mathbf{E}_0 e^{i(k_x x + k_y y + k_z z)}$.\nApplying the discrete derivative $D_x^{\\mathrm{col}}$ to the $j$-th component $E_j(\\mathbf{x}) = E_{j0} e^{i \\mathbf{k} \\cdot \\mathbf{x}}$ yields:\n$$\nD_x^{\\mathrm{col}} E_j(\\mathbf{x}) = \\frac{E_{j0} e^{i(k_x(x+h) + k_y y + k_z z)} - E_{j0} e^{i(k_x(x-h) + k_y y + k_z z)}}{2h} = E_j(\\mathbf{x}) \\frac{e^{ik_x h} - e^{-ik_x h}}{2h} = E_j(\\mathbf{x}) \\frac{2i \\sin(k_x h)}{2h} = i \\frac{\\sin(k_x h)}{h} E_j(\\mathbf{x})\n$$\nThus, in Fourier space, the discrete derivative operators correspond to multiplication by $i \\tilde{k}_\\alpha^{\\mathrm{col}}$, where $\\tilde{k}_\\alpha^{\\mathrm{col}} = \\frac{\\sin(k_\\alpha h)}{h}$ for $\\alpha \\in \\{x, y, z\\}$. This quantity is often called the modified wavenumber.\n\nWe now construct the symbol for the discrete curl operator, $\\nabla_h \\times$.\nThe $x$-component of the discrete curl is $(D_y^{\\mathrm{col}} E_z - D_z^{\\mathrm{col}} E_y)$. In Fourier space, this becomes $(i \\tilde{k}_y^{\\mathrm{col}} E_z - i \\tilde{k}_z^{\\mathrm{col}} E_y)$.\nRepeating this for all components, we obtain the vector:\n$$\n\\nabla_h \\times \\mathbf{E} \\xrightarrow{\\mathcal{F}} i\n\\begin{pmatrix}\n\\tilde{k}_y^{\\mathrm{col}} E_z - \\tilde{k}_z^{\\mathrm{col}} E_y \\\\\n\\tilde{k}_z^{\\mathrm{col}} E_x - \\tilde{k}_x^{\\mathrm{col}} E_z \\\\\n\\tilde{k}_x^{\\mathrm{col}} E_y - \\tilde{k}_y^{\\mathrm{col}} E_x\n\\end{pmatrix}\n$$\nThis linear transformation on the components of $\\mathbf{E}_0$ can be written in matrix form:\n$$\nC_{\\mathrm{col}}(\\mathbf{k}) \\mathbf{E}_0 = i \\begin{pmatrix} 0 & -\\tilde{k}_z^{\\mathrm{col}} & \\tilde{k}_y^{\\mathrm{col}} \\\\ \\tilde{k}_z^{\\mathrm{col}} & 0 & -\\tilde{k}_x^{\\mathrm{col}} \\\\ -\\tilde{k}_y^{\\mathrm{col}} & \\tilde{k}_x^{\\mathrm{col}} & 0 \\end{pmatrix} \\mathbf{E}_0\n$$\nThis confirms the structure of the Fourier symbol $C_{\\mathrm{col}}(\\mathbf{k})$ for the collocated grid.\n\n### Step 2: Derivation of the Discrete Curl Operator Symbol (Yee Grid)\n\nIn the Yee grid, field components are staggered. A first-order central difference is applied over a distance $h$, but between points shifted by $\\pm h/2$ from the evaluation point. For instance, $\\partial_x f(x) \\approx \\frac{f(x+h/2) - f(x-h/2)}{h}$. Applying this to $e^{ik_x x}$:\n$$\n\\frac{e^{ik_x(x+h/2)} - e^{ik_x(x-h/2)}}{h} = e^{ik_x x} \\frac{e^{ik_x h/2} - e^{-ik_x h/2}}{h} = e^{ik_x x} \\frac{2i\\sin(k_x h/2)}{h}\n$$\nThe problem statement gives the magnitude part of the symbol as $\\frac{2}{h} \\sin(k_\\alpha h/2)$. The full symbol is $i \\frac{2}{h} \\sin(k_\\alpha h/2)$, where phase factors due to the relative positions of the field components on the grid are ignored, as they will cancel out in the second-order curl-curl operator. Thus, we can define the modified wavenumber for the Yee scheme as $\\tilde{k}_\\alpha^{\\mathrm{Yee}} = \\frac{2}{h} \\sin(k_\\alpha h/2)$.\n\nDespite the staggering, the cross-product structure of the curl operator is preserved. The discrete curl operator will still map the Fourier mode $\\mathbf{E}_0 e^{i\\mathbf{k}\\cdot\\mathbf{x}}$ to a vector whose components are linear combinations of $E_{x0}, E_{y0}, E_{z0}$. By replacing the collocated modified wavenumbers with those of the Yee scheme, we obtain the symbol for the Yee grid:\n$$\nC_{\\mathrm{Yee}}(\\mathbf{k}) = i \\begin{pmatrix} 0 & -\\tilde{k}_z^{\\mathrm{Yee}} & \\tilde{k}_y^{\\mathrm{Yee}} \\\\ \\tilde{k}_z^{\\mathrm{Yee}} & 0 & -\\tilde{k}_x^{\\mathrm{Yee}} \\\\ -\\tilde{k}_y^{\\mathrm{Yee}} & \\tilde{k}_x^{\\mathrm{Yee}} & 0 \\end{pmatrix} \\quad \\text{with} \\quad \\tilde{k}_\\alpha^{\\mathrm{Yee}} = \\frac{2}{h} \\sin\\left(\\frac{k_\\alpha h}{2}\\right)\n$$\n\n### Step 3: The Curl-Curl Operator Symbol and its Eigenvalues\n\nThe source-free Maxwell's curl equations can be combined to form the wave equation: $\\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2}$. Assuming a time-harmonic dependence $e^{-i\\omega t}$, this becomes $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\omega^2\\mu\\epsilon \\mathbf{E}$.\nIn the discrete Fourier domain, the operator $\\nabla_h \\times (\\nabla_h \\times \\cdot)$ has the symbol $\\mathcal{L}_{\\mathrm{grid}}(\\mathbf{k}) = C_{\\mathrm{grid}}(\\mathbf{k})^2$.\nThe symbol $C_{\\mathrm{grid}}(\\mathbf{k})$ can be expressed as $i C(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})$, where $C(\\mathbf{q})$ is the real skew-symmetric matrix given in the problem.\nTherefore, $\\mathcal{L}_{\\mathrm{grid}}(\\mathbf{k}) = \\left(i C(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})\\right)^2 = -C(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^2$.\nUsing the provided identity, $C(\\mathbf{q})^2 = -(\\|\\mathbf{q}\\|^2 I - \\mathbf{q}\\mathbf{q}^\\top)$:\n$$\n\\mathcal{L}_{\\mathrm{grid}}(\\mathbf{k}) = -(-(\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 I - \\tilde{\\mathbf{k}}^{\\mathrm{grid}}(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^\\top)) = \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 I - \\tilde{\\mathbf{k}}^{\\mathrm{grid}}(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^\\top\n$$\nThis is the symbol for the discrete curl-curl operator. To find its eigenvalues, let $\\mathbf{v}$ be an eigenvector.\n1.  If $\\mathbf{v}$ is parallel to $\\tilde{\\mathbf{k}}^{\\mathrm{grid}}$, i.e., $\\mathbf{v} = c \\tilde{\\mathbf{k}}^{\\mathrm{grid}}$, this represents a longitudinal mode.\n$$\n\\mathcal{L}_{\\mathrm{grid}} \\mathbf{v} = (\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 I - \\tilde{\\mathbf{k}}^{\\mathrm{grid}}(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^\\top) (c \\tilde{\\mathbf{k}}^{\\mathrm{grid}}) = c (\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 \\tilde{\\mathbf{k}}^{\\mathrm{grid}} - \\tilde{\\mathbf{k}}^{\\mathrm{grid}} (\\tilde{\\mathbf{k}}^{\\mathrm{grid}\\top} \\tilde{\\mathbf{k}}^{\\mathrm{grid}})) = c (\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 \\tilde{\\mathbf{k}}^{\\mathrm{grid}} - \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 \\tilde{\\mathbf{k}}^{\\mathrm{grid}}) = \\mathbf{0}\n$$\nThe eigenvalue for the longitudinal mode is $0$. This reflects the discrete equivalent of $\\nabla \\cdot \\mathbf{E} = 0$.\n\n2.  If $\\mathbf{v}$ is orthogonal to $\\tilde{\\mathbf{k}}^{\\mathrm{grid}}$, i.e., $(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^\\top \\mathbf{v} = 0$, this represents a transverse mode.\n$$\n\\mathcal{L}_{\\mathrm{grid}} \\mathbf{v} = (\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 I - \\tilde{\\mathbf{k}}^{\\mathrm{grid}}(\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^\\top) \\mathbf{v} = \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 \\mathbf{v} - \\tilde{\\mathbf{k}}^{\\mathrm{grid}}((\\tilde{\\mathbf{k}}^{\\mathrm{grid}})^\\top \\mathbf{v}) = \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 \\mathbf{v}\n$$\nThe eigenvalue for any vector in the two-dimensional subspace orthogonal to $\\tilde{\\mathbf{k}}^{\\mathrm{grid}}$ is $\\lambda_{\\mathrm{grid}}(\\mathbf{k}) = \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2$. This is the eigenvalue for transverse electromagnetic waves.\n\n### Step 4: Phase Speed Ratio and Anisotropy Index\n\nThe discrete dispersion relation for transverse waves is $\\omega^2 \\mu\\epsilon = \\lambda_{\\mathrm{grid}}(\\mathbf{k}) = \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2$. The continuous dispersion relation is $\\omega^2 \\mu\\epsilon = |\\mathbf{k}|^2$.\nThe numerical phase speed is $v_{p, \\mathrm{grid}} = \\omega/|\\mathbf{k}| = \\sqrt{\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 / (\\mu\\epsilon)} / |\\mathbf{k}|$.\nThe continuous phase speed is $v_{p, \\mathrm{cont}} = 1/\\sqrt{\\mu\\epsilon}$.\nThe normalized phase speed ratio is the ratio of these two:\n$$\nv_{\\mathrm{grid}}(\\hat{\\mathbf{k}}; k h) = \\frac{v_{p, \\mathrm{grid}}}{v_{p, \\mathrm{cont}}} = \\frac{\\sqrt{\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2}}{|\\mathbf{k}|}\n$$\nwhere $\\mathbf{k} = k \\hat{\\mathbf{k}}$. Due to the grid, $\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|$ depends on the direction $\\hat{\\mathbf{k}}$, so $v_{\\mathrm{grid}}$ is anisotropic. The anisotropy index $A_{\\mathrm{grid}}(kh)$ quantifies this directional dependence as the normalized range of speeds for a fixed wavenumber magnitude $k$.\n\n### Step 5: Corrective Spectral Filter\n\nThe filter $W_{\\mathrm{grid}}(\\mathbf{k}) = \\frac{\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)}{\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|}$ is designed to counteract the anisotropy. $\\phi_{\\mathrm{grid}}(r)$ is the average of $\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|$ over all directions for $|\\mathbf{k}|=r$.\nThe filtered curl-curl operator symbol would have its eigenvalues scaled by $W_{\\mathrm{grid}}^2$. The new transverse eigenvalue is:\n$$\n\\lambda_{\\mathrm{grid,\\,filt}}(\\mathbf{k}) = W_{\\mathrm{grid}}(\\mathbf{k})^2 \\lambda_{\\mathrm{grid}}(\\mathbf{k}) = \\left(\\frac{\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)}{\\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|}\\right)^2 \\|\\tilde{\\mathbf{k}}^{\\mathrm{grid}}\\|^2 = (\\phi_{\\mathrm{grid}}(|\\mathbf{k}|))^2\n$$\nThe corrected phase speed ratio is:\n$$\nv_{\\mathrm{grid,\\,filt}}(\\hat{\\mathbf{k}}; k h) = \\frac{\\sqrt{\\lambda_{\\mathrm{grid,\\,filt}}(\\mathbf{k})}}{|\\mathbf{k}|} = \\frac{\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)}{|\\mathbf{k}|}\n$$\nBy construction, $\\phi_{\\mathrm{grid}}(|\\mathbf{k}|)$ depends only on the magnitude $|\\mathbf{k}| = k$, not its direction $\\hat{\\mathbf{k}}$. Therefore, $v_{\\mathrm{grid,\\,filt}}$ is isotropic. This means that $\\max_{\\hat{\\mathbf{k}}} v_{\\mathrm{grid,\\,filt}} = \\min_{\\hat{\\mathbf{k}}} v_{\\mathrm{grid,\\,filt}}$, leading to an anisotropy index $A_{\\mathrm{grid,\\,filt}}(k h) = 0$. Consequently, the improvement ratio $R_{\\mathrm{grid}}(k h) = (A_{\\mathrm{grid}} - A_{\\mathrm{grid,\\,filt}})/A_{\\mathrm{grid}}$ becomes $1$ (or very close to $1$ in numerical practice due to finite precision).\n\n### Numerical Implementation\n\nThe provided problem asks for a 2D implementation where only $E_z$ is non-zero (a TEz wave). The discrete curl-curl operator on $E_z$ reduces to the 2D discrete Laplacian, whose symbol is $- ((\\tilde{k}_x^{\\mathrm{grid}})^2 + (\\tilde{k}_y^{\\mathrm{grid}})^2)$. The relevant eigenvalue is thus $\\lambda_{\\mathrm{grid}}(k_x, k_y) = (\\tilde{k}_x^{\\mathrm{grid}})^2 + (\\tilde{k}_y^{\\mathrm{grid}})^2$. The following program calculates the requested quantities based on these 2D formulas.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing and correcting numerical anisotropy\n    in discrete curl operators for computational electromagnetics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    kh_vals = [0.2, 1.2]\n    N_theta = 360\n    h = 1.0\n\n    # Test suite parameters\n    # [A_col(0.2), A_Yee(0.2), A_col(1.2), A_Yee(1.2), R_col(1.2), boolean]\n    results = []\n\n    # Angular discretization\n    thetas = np.linspace(0, 2 * np.pi, N_theta, endpoint=False)\n\n    # --- Part 1: Calculate Anisotropy Indices ---\n    A_col_vals = {}\n    A_Yee_vals = {}\n    \n    for kh in kh_vals:\n        k = kh / h\n        k_x = k * np.cos(thetas)\n        k_y = k * np.sin(thetas)\n\n        # Collocated grid calculations\n        tilde_k_x_col = np.sin(k_x * h) / h\n        tilde_k_y_col = np.sin(k_y * h) / h\n        norm_tilde_k_col = np.sqrt(tilde_k_x_col**2 + tilde_k_y_col**2)\n        v_col = norm_tilde_k_col / k\n        \n        # Anisotropy Index for Collocated Grid\n        if np.mean(v_col) != 0:\n            A_col = (np.max(v_col) - np.min(v_col)) / np.mean(v_col)\n        else:\n            A_col = 0.0\n        A_col_vals[kh] = A_col\n\n        # Yee grid calculations\n        tilde_k_x_Yee = (2 / h) * np.sin(k_x * h / 2)\n        tilde_k_y_Yee = (2 / h) * np.sin(k_y * h / 2)\n        norm_tilde_k_Yee = np.sqrt(tilde_k_x_Yee**2 + tilde_k_y_Yee**2)\n        v_Yee = norm_tilde_k_Yee / k\n        \n        # Anisotropy Index for Yee Grid\n        if np.mean(v_Yee) != 0:\n            A_Yee = (np.max(v_Yee) - np.min(v_Yee)) / np.mean(v_Yee)\n        else:\n            A_Yee = 0.0\n        A_Yee_vals[kh] = A_Yee\n\n    # Append results for A(0.2) and A(1.2)\n    results.append(A_col_vals[0.2])\n    results.append(A_Yee_vals[0.2])\n    results.append(A_col_vals[1.2])\n    results.append(A_Yee_vals[1.2])\n\n    # --- Part 2: Evaluate Filter Improvement ---\n    kh_filter = 1.2\n    k_filter = kh_filter / h\n    k_x_filter = k_filter * np.cos(thetas)\n    k_y_filter = k_filter * np.sin(thetas)\n\n    # Calculate values needed for the filter (collocated grid)\n    tilde_k_x_col_filter = np.sin(k_x_filter * h) / h\n    tilde_k_y_col_filter = np.sin(k_y_filter * h) / h\n    norm_tilde_k_col_filter = np.sqrt(tilde_k_x_col_filter**2 + tilde_k_y_col_filter**2)\n    \n    # Angular average to get phi\n    phi_col_filter = np.mean(norm_tilde_k_col_filter)\n    \n    # Corrected phase speed (constant across all angles)\n    v_col_filt = phi_col_filter / k_filter\n    \n    # Anisotropy of the filtered scheme\n    # Numerically, max(v)-min(v) will be very close to 0.\n    A_col_filt = (v_col_filt - v_col_filt) / v_col_filt if v_col_filt != 0 else 0.0\n\n    # Anisotropy for the unfiltered collocated grid at kh=1.2\n    A_col_unfilt = A_col_vals[1.2]\n\n    # Improvement ratio\n    if A_col_unfilt > 0:\n        R_col = (A_col_unfilt - A_col_filt) / A_col_unfilt\n    else:\n        # If original anisotropy is zero, improvement is not well-defined.\n        # Can be considered 100% if filtered is also zero.\n        R_col = 1.0 if A_col_filt == 0 else 0.0\n        \n    results.append(R_col)\n\n    # Assertion\n    boolean_result = R_col > 0.9\n    results.append(boolean_result)\n    \n    # Final print statement in the exact required format.\n    # Convert boolean to string \"True\" or \"False\" as required for printing\n    str_results = []\n    for r in results:\n        if isinstance(r, bool):\n            str_results.append(str(r))\n        else:\n            str_results.append(f\"{r:.15f}\")\n    \n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        }
    ]
}